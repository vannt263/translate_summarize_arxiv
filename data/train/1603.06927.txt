{
  "article_text": [
    "a fundamental problem affecting many application areas is the processing of signals on graphs  @xcite .",
    "in addition to representing networks , graphs provide an underlying structure for data in which connectivity and proximity affect processing .",
    "distances as measured along graph edges induce notions of continuity and displacement , allowing for the adaptation of ideas from continuous geometry to sampled or fundamentally discrete data .",
    "in particular , we focus on probability distributions _ over _ graphs , whereby each vertex of a graph is associated with some amount of probabilistic mass .",
    "given that countless algorithms and models in machine learning rely upon a notion of distance / divergence between probability distributions , it is desirable to design efficiently - computable and well - behaved distances taking into account the connectivity of the underlying graph .    a well - known notion of distance from information theory is provided by the kl divergence and its variants .",
    "the crucial drawback of these divergences in our context , however , is that they are agnostic to graph connectivity . that is , displacing probability from one node to another has the same cost regardless of the distance it travels along the edges .",
    "one alternative taking connectivity into account is provided by _ optimal transportation _ distances , also known as _ earth mover s distances _ ( emds ) . these measure the work needed to transform one probability distribution into another by transporting mass over the graph edges  @xcite .",
    "setting the cost of moving a unit of mass between graph nodes @xmath1 and @xmath2 to @xmath3 yields the @xmath4-wasserstein transportation distance , where @xmath5 denotes shortest - path graph distance .",
    "transportation distances are the topic of a well - developed mathematical theory establishing geometric properties for the @xmath6-wasserstein distance desirable for applications .",
    "unfortunately , the basic optimization for this distance involves a linear program scaling quadratically with the number of nodes , rendering the computation prohibitively expensive even for moderately - sized graphs .",
    "this has led to approximations using wavelets  @xcite , smoothing  @xcite , sketching  @xcite , and so on .",
    "these approximations impose strict requirements on the graph and can become noisy or discontinuous thanks to aggressive approximation .",
    "others resort to the @xmath7-wasserstein distance , which is easier computationally but has weak stability and geometric structure .    here",
    ", we introduce a novel transportation distance between distributions over graphs .",
    "our approach is inspired by a riemannian framework for wasserstein distance in @xmath8 based on fluid flow  @xcite .",
    "we consider the set of distributions on a graph as a manifold and define appropriate analogs of tangent spaces and inner products ; our transportation distances are geodesics in this abstract space .",
    "although it does not come from the usual transportation linear program , our alternative definition still satisfies the triangle inequality and so on while benefiting from the new infinitesimal construction .",
    "our approach has several advantages .",
    "it scales linearly with the number of edges , enabling larger - scale computation especially on sparse graphs . even with this favorable scaling , it has properties in common with @xmath6-wasserstein distances .",
    "the riemannian structure , not known to accompany the quadratically - scaling linear programming formulation , gives our distances additional properties in common with wasserstein distances over @xmath8 , such as `` displacement interpolation '' paths explaining the motion of mass from one distribution to another .",
    "we also provide a suitable discretization and experiments suggesting our distance s structure and applicability to learning tasks .",
    "suppose @xmath9 is a manifold with geodesic distance @xmath10 we will use @xmath11 to denote the space of probability measures over @xmath9 .",
    "then , the @xmath4-_wasserstein _ distance between @xmath12 is : @xmath13 measures @xmath14 are _ transportation plans _ satisfying @xmath15 and @xmath16 for @xmath17 .",
    "we can think of @xmath18 as a matching of probabilistic mass from @xmath19 to @xmath20 ; then , @xmath21 is the minimum cost matching , assuming the cost of moving mass from @xmath22 to @xmath23 is @xmath24 .",
    "we refer the reader to  @xcite for additional discussion .    in vision and learning ,",
    "@xmath25 is known as the `` earth mover s distance ''  @xcite , used on histograms and binned descriptors .",
    "theoretically , however , the quadratic distance @xmath26 admits stronger smoothness and uniqueness properties akin to the difference between @xmath27 and @xmath28 regularization .",
    "regardless , algorithms optimizing   directly deal with distributions over the cross product @xmath29 ; discretizing @xmath9 using @xmath30 points produces a linear program over @xmath31 variables , which can be prohibitively expensive .",
    "more recent methods establish a connection between   and eulerian fluid mechanics .",
    "most prominently , benamou and brenier show that @xmath26 can be computed on @xmath9 as follows  @xcite : @xmath32 ^ 2= \\left\\ { \\begin{aligned } \\inf_{\\rho(t , x),v(t , x ) } & \\int_m\\int_0 ^ 1 \\rho(t , x ) \\|v(t , x)\\|^2\\,dx\\,dt\\\\[1ex ] \\mbox{such that } \\ ; & \\rho(0,x)=\\rho_0(x),\\ \\rho(1,x ) = \\rho_1(x)\\\\ & \\frac{\\partial \\rho}{\\partial t } + \\nabla\\cdot(\\rho v ) = 0,\\ \\rho(t , x)\\geq0 \\end{aligned } \\right.\\ ] ] we assume measures @xmath33 can be expressed using distributions @xmath34 such that @xmath35 .",
    "the variable @xmath36 is a time - varying set of distributions advecting from @xmath37 to @xmath38 along vector field @xmath39 with minimal kinetic energy @xmath40 .",
    "discretizations of this problem scale well , since @xmath41 $ ] typically can be subdivided into far fewer than @xmath30 subintervals .",
    "similar formulations exist for @xmath25  @xcite , but we focus on @xmath26 for its structure and computational challenges on graphs .    using  , @xmath26 can be viewed as a geodesic distance on @xmath11  @xcite .",
    "first - order optimality of   shows @xmath42 for some @xmath43 .",
    "this is interpreted to mean that the set of gradients @xmath44 forms a  tangent space \" for @xmath11 at @xmath33 equipped with an inner product defined by @xmath45 given a time - varying set of distributions @xmath36 , there exists a unique potential field @xmath46 with @xmath47 , so if we write a `` curve '' @xmath48\\rightarrow{\\textrm{prob}}(m)$ ] corresponding to @xmath36 , then we can define @xmath49 then ,  @xcite proves : @xmath50 that is , quadratic wasserstein distance satisfies the geodesic equation under this inner product .",
    "now , we transition from manifold domains @xmath9 to undirected connected graphs @xmath51 recall that our goal is to construct a transportation distance on discrete distributions using the structure of @xmath52 with the structure of @xmath6-wasserstein distances in euclidean space .    define @xmath53 to be the shortest - path distance between @xmath54 , and define @xmath55^{|v|}:\\mathbbm1^\\top p=1\\}.$ ] to mimic the construction of @xmath26 , we might attempt to compute the following quadratic transportation distance on @xmath56 : @xmath57 ^ 2\\equiv\\left\\ { \\begin{aligned } \\inf_{t(v , w)\\geq0 } & \\sum_{v , w\\in v } d(v , w)^2t(v , w)\\\\ \\mbox{such that } \\ ; & \\sum_{w\\in v } t(v ,",
    "w)=p_0(v)\\ \\forall v\\in v\\\\ & \\sum_{v\\in v } t(v , w)=p_1(w)\\ \\forall w\\in v \\end{aligned}\\right.\\ ] ] while this distance has some properties in common with @xmath26 , the linear program requires @xmath58 variables @xmath59 and precomputation of a dense matrix of pairwise distances @xmath60    to alleviate these scaling problems , we might hope to find an eulerian formulation of @xmath61 in the style of  .",
    "such a distance is challenging to derive starting from   for several reasons .",
    "first , graphs are discrete with no perfect analog of the advection equation @xmath62 .",
    "furthermore , flows on graphs are per - edge and distributions are per - vertex , so the objective @xmath63 must be approximated .",
    "hence , rather than expecting to find a new formulation of @xmath64 we will introduce a _ new _",
    "transportation distance constructed by working backward from  .",
    "the main ingredients defining transportation distances starting from   are :    1 .   a model of advection for moving probabilistic mass between adjacent vertices of a graph over time using a per - edge flow .",
    "a probability - based inner product on per - edge flows similar to  .    to simplify notation ,",
    "define @xmath65 a set of directed edges where each edge in @xmath66 is doubled with forward and backward orientation .",
    "following  @xcite , given a nonnegative oriented flow @xmath67\\times\\overline e\\rightarrow { \\mathbb{r}}^+$ ] and distribution @xmath68 , we define advection of @xmath69 along @xmath70 as the solution of the system of ordinary differential equations @xmath71 the time variable @xmath72 aside , this model of advection is defined discretely in terms of the structure of the graph but still preserves mass in that @xmath73 for all @xmath74 .    to define an inner product on flows ,",
    "take @xmath75 and @xmath76 with @xmath77 .",
    "then , we define the _ advective inner product _ between @xmath70 and @xmath78 at @xmath4 as : @xmath79 this is an @xmath27 inner product on @xmath80 weighted by a function of the distribution @xmath4 .",
    "the asymmetry between @xmath81 and @xmath82 accounts for the structure of graph advection   and makes our transportation distance symmetric via proposition  [ prop : momentum ] .",
    "we also define the _ advective norm _",
    "@xmath83 now , we can define the _ continuous - flow transportation distance _ on @xmath56 by imitating  :    equation[eq : graph_geodesic ] ( p_0,p_1)\\ {    _ & _ 0 ^ 1 u(t,)_p(t,)dt + & p(0,v)=p_0(v ) , p(1,v)=p_1(v ) + &    .",
    "we state several properties of our new distance @xmath84 to provide intuition for its behavior and to motivate how we will compute it numerically .",
    "we begin by providing an alternative convex formulation :    @xmath84 can be computed as follows:[prop : momentum ] @xmath85 ^ 2=\\left\\ { \\begin{aligned } \\inf_{\\substack{j(t , e)\\geq0\\\\p(t , v)\\geq0 } } & \\int_0 ^ 1\\sum_{e=(v\\rightarrow w ) } \\frac{j(t , e)^2}{2}\\left(\\frac{1}{p(t , v ) } + \\frac{1}{p(t , w)}\\right)\\,dt\\\\ \\mbox{such that } \\ ; & p(0,v)=p_0(v ) , \\ , p(1,v)=p_1(v)\\ \\forall v\\in v\\\\ & \\frac{d}{dt } p(t,\\cdot ) = d^\\top j(t,\\cdot)\\end{aligned } \\right.\\ ] ] here , @xmath86 is the operator computing @xmath87 for each oriented edge @xmath88",
    "first , substitute @xmath89 to  , for @xmath90 then , @xmath91 an identical substitution into the advection equation shows that @xmath92 satisfies @xmath93    define a new inner product @xmath94 replacing the weights in   with @xmath95 . in this notation",
    ", we must show that minimizing  , whose energy functional now can be written as @xmath96 , is equivalent to squaring the result of minimizing the non - squared functional @xmath97 with the same constraints .",
    "we follow an analogous proof for manifold geodesics in theorem 2.1 of  @xcite .",
    "first , take any @xmath92 and @xmath4 satisfying the constraints . as a consequence of hlder s inequality ,",
    "we know @xmath98 this establishes   as an upper bound for  .    now , suppose @xmath99 are minimizers of   after substitution .",
    "define the `` arc length '' function @xmath100 and take @xmath101 reparameterizing @xmath4 with respect to @xmath102 yields @xmath103 hence , @xmath104 and @xmath105 satisfy the constraints with @xmath106 .",
    "the advective norm of @xmath107 , however , is a constant function of @xmath102 with @xmath108 thus we know @xmath109 establishing   as an upper bound for  .    with this alternative formulation in hand",
    ", we verify that @xmath84 truly satisfies the properties of a distance metric on @xmath56 :    @xmath84 is a distance on @xmath56 .",
    "non - negativity follows directly from the form of @xmath84 .",
    "symmetry follows from   since @xmath110 contains all forward _ and _ backward edges ; any forward - flowing @xmath111 can be replaced by a backward flow @xmath112 with the same integrated advective norm by placing @xmath92 on flipped edges .",
    "finally , the triangle inequality follows from   identically to the proof of triangle inequality for geodesic curves by concatenating paths in @xmath56 .",
    "finally , we relate @xmath84 to the geometry of the underlying graph . for simplicity , we restrict our theoretical result to a weak but easily - proved bound and",
    "show experimentally in ",
    "[ sec : experiments ] that our bound is conservative :    suppose @xmath113 are the indicator functions of @xmath54",
    ". then , there exists @xmath114 not dependent on @xmath52 with @xmath115[prop : bound ]    for a two - node graph with @xmath116 and @xmath117 , define @xmath118 ; using the discretization in ",
    "[ sec : discretization ] with a large number of time steps , @xmath119 .",
    "then , for @xmath54 in a general graph @xmath120 , define @xmath121 .",
    "we construct a time - varying set of distributions @xmath111 by dividing @xmath41 $ ] into @xmath122 subintervals of length @xmath123 and use two - node solution to transport mass along each edge of the shortest path from @xmath1 to @xmath2 one - at - a - time . compressing the two - node integral into an interval of length @xmath123 scales the integral for @xmath124 by @xmath122 , and there are @xmath122 such subintervals .",
    "thus , this feasible point for   shows @xmath125 ^ 2\\leq c^2\\ell^2\\implies \\overline{\\mathcal{w}}(\\delta_v,\\delta_w)\\leq c\\ell.$ ]      while @xmath84 is a distance on @xmath56 , a subset of the finite - dimensional set @xmath41^{|v|}$ ] , its computation involves solving variational problems   or   containing a continuous time variable @xmath72 .",
    "for this reason , we propose a discrete approximation of @xmath84 by sampling @xmath72 before the minimization .",
    "this approximation can be evaluated using standard convex optimization machinery .",
    "since the functional @xmath126 is convex so long as @xmath127 , we use   as the starting point for our discretization ; this objective term can be included in second - order cone programs  @xcite .",
    "we divide the time span @xmath41 $ ] into @xmath128 subintervals , with improving approximation quality as @xmath129 .",
    "similar to  @xcite , we propose using a _ staggered _ discretization in which @xmath92 is sampled at subinterval midpoints and @xmath4 is sampled at subinterval endpoints ; for this reason , our optimization variables are distributions @xmath130 with flows @xmath131 so that @xmath132 is the flow from @xmath133 to @xmath134 .",
    "our discretized version of the optimization   is : @xmath135 ^ 2\\equiv \\left\\ { \\begin{aligned } \\min_{\\substack{j^i(e)\\geq0\\\\q^i(v)\\geq0}}\\ ; & k\\sum_{i=1}^k \\sum_{e=(v\\rightarrow w ) } \\frac{j^i(e)^2}{2}\\left(\\frac{1}{q^{i-1}(v)}+\\frac{1}{q^i(w)}\\right)\\,,\\\\ \\mbox{such that } \\ ; & q^0 = p_0 , \\ , q^k = p_1 , \\ ,   d^\\top j^i = q^i - q^{i-1}\\,.\\end{aligned } \\right.\\ ] ]",
    "this discretization is convex . taking @xmath136 along the shortest path from @xmath1 to @xmath2",
    ", one can show @xmath137 when @xmath138 suggesting that the bound in proposition  [ prop : bound ] is conservative .",
    "one feature of our discretization is the mix of @xmath139 and @xmath140 in the optimization objective .",
    "this construction ensures that when @xmath141 , both denominators are nonzero since mass is transported from vertex @xmath1 at time @xmath142 to vertex @xmath2 at time @xmath143 .",
    "this slight asymmetry allows the boundary distributions to contain zero values and vanishes for large @xmath128 .",
    "if symmetry is desired , the forward and backward discretizations can be averaged .",
    "this optimization problem has @xmath144 variables .",
    "one advantage of such a formulation over the @xmath145 linear programming approach is that additional edge - based pruning strategies can be applied to reducing the number of variables when we are confident certain edges will not figure into the computation .",
    "for instance , we can first compute the one - wasserstein distance using network flow techniques and prune those edges that are not used by the resulting flow .",
    "this enhances efficiency when distributions are concentrated in the same region of the graph or have low entropy .",
    "cc    ; table figures / deltaconvergence / k10.dat ; table figures / deltaconvergence / k25.dat ; table figures / deltaconvergence / k50.dat ; table figures / deltaconvergence / k100.dat ;    &    ; table figures / entropyconvergence / entropy0.dat ; table figures / entropyconvergence / entropy1.11986.dat ; table figures / entropyconvergence / entropy2.25171.dat ; table figures / entropyconvergence / entropy3.15293.dat ;    figure  [ fig : convergence ] illustrates the convergence of our approximation @xmath146 for increasing @xmath128 . on the left",
    ", we measure @xmath146 between the indicators of two vertices @xmath54 as in proposition  [ prop : bound ] .",
    "we plot the relationship between graph distance and @xmath146 for various @xmath128 . as @xmath128 increases , @xmath147 better approximates @xmath53 .",
    "this suggests a commonality with traditional transportation distances , which satisfy the diagonal relationship exactly and shows that our bound in proposition  [ prop : bound ] likely could be tightened . on the right , we plot @xmath146 as @xmath128 increases for assorted pairs @xmath148 . in this experiment , we measure distances after perturbing the indicators of the two farthest vertices of a thirty - vertex line graph with uniform noise .",
    "we plot convergence for distances for different levels of entropy in @xmath69 and @xmath149 ; our approximation succeeds even with low @xmath128 when the entropies of the distributions is high .",
    "this observation reflects the fact that transportation between high - entropy distributions is less likely to move mass large distances , since mass exists all over @xmath52 .",
    "one well - understood phenomenon associated with the continuous two - wasserstein distance @xmath26 is _ displacement interpolation _ , introduced by mccann in  @xcite .",
    "displacement interpolation can be thought of as the characterization of the `` path '' of distributions @xmath150 from @xmath37 to @xmath38 suggested in the flow - based formulation  .",
    "this path is well - understood and isotropic in the @xmath26 case , whereas for @xmath25 the corresponding path is the trivial construction @xmath151  @xcite .",
    "displacement interpolation largely is understood as a continuous phenomenon on connected rather than discrete domains . even in the quadratic case",
    ", there does not appear to be a well - characterized flow of probability over time explaining the optimal matching @xmath152 contrastingly , our distance @xmath84 exhibits displacement interpolation phenomena by construction .    [ cols=\">,^,^,^,^,^ \" , ]     when the ground distance is the length of the shortest path between vertices , earth mover s distances on a graph are easily computed using multi - commodity network flow ; see  @xcite for an early reference .",
    "in particular , for @xmath153 , @xmath154 is the minimum of @xmath155 such that @xmath156 hence , we should justify the expense of minimizing  , even if it is cheaper than the nave quadratic distance @xmath61 in  . as evidence beyond that in  [ sec : displacement_interpolation ] , we provide an additional experiment here .    figure  [ fig : w1 ] shows an example constructed to compare @xmath84 to @xmath25 ( @xmath157 ) .",
    "suppose we wish to approximate a distribution @xmath76 with the indicator @xmath158 of a single vertex @xmath159 by minimizing a probabilistic distance . here , @xmath52 consists of a line of vertices connecting two radial fans , and @xmath4 is uniform on the fans with zero probability along the line .",
    "@xmath160 can not distinguish between the vertices @xmath1 on the line , and the resulting minimizer @xmath1 is unstable to perturbations of @xmath4 .",
    "the @xmath28 distance @xmath161 is nearly minimized by any @xmath1 with mass on it .",
    "@xmath84 , however , stably chooses @xmath1 to be the center of the line even in the presence of noise , and the distance function @xmath162 clearly distinguishes between the vertices of @xmath52 .",
    "intuition for this test comes from comparing the least squares problem @xmath163 to the geometric median problem @xmath164 on @xmath8 .",
    "the former is differentiable with minimizer @xmath165 , while the latter is minimized by _ any _ @xmath166 on the segment from @xmath167 to @xmath168 .",
    "r.47     & @xmath169 & @xmath170 + 10 & 64.4% & 64.1% + 20 & 73.5% & 75.7% + 30 & 79.4% & 84.0% + 40 & 86.5% & 89.4% + 50 & 89.9% & 91.9% +    [ fig : bow ]      one application of distributions with ground distances is the processing of `` bag - of - words '' models .",
    "suppose we have a collection of objects with local descriptors , e.g.  images with per - pixel features .",
    "we can cluster all descriptors from all the domains to yield a sampling of descriptor space ; then , each object in the collection can be described as the distribution of how many of its local descriptors have each cluster center as its closest point .",
    "this strategy provides an effective , simple approach to clustering , search , and other problems  @xcite .",
    "an underlying issue with this model , however , is that the histogram bins are related , especially if the number of clusters is large .",
    "that is , local features may have multiple near - closest cluster centers and could be assigned to different bins equally well .",
    "@xmath171 distances between bag - of - words neglect this structure and hence _ degrade _ as the number of cluster centers  and correspondingly the sampling of descriptor space",
    " increases beyond a certain point .",
    "thus , transportation distances may have better performance for such tasks , as proposed in  @xcite .    using extrinsic distance in descriptor space as the transportation ground distance , however , neglects the fact that the set of descriptors may exhibit manifold structure along which distances should be measured intrinsically .",
    "for this reason , rather than measuring euclidean distance between the cluster centers for the ground distance , we propose using transportation along a graph in which the clusters are linked locally .",
    "table  [ fig : bow ] illustrates an experiment for three - dimensional shape retrieval on a database of 109 organic three - dimensional shapes from  @xcite classified into 10 categories .",
    "we describe each shape using the bag - of - words method above on wave kernel signature ( wks ) descriptors  @xcite grouped into 1000 clusters ; we connect the cluster centers into a connected graph by augmenting the euclidean minimum spanning tree in wks space with each center s two nearest neighbors ( @xmath172 ) .",
    "compared to using the @xmath28 norm @xmath173 to compare @xmath153 , @xmath84 consistently achieves better within - class retrieval results using identical descriptors , beyond an initial set of shape matches well - distinguished by any distance .",
    "our transportation distance @xmath84 bridges the gap between continuous and discrete transportation .",
    "computational techniques on discrete domains like graphs largely are limited to the _ one_-wasserstein distance @xmath25 , which relates to maximum flow problems , but the use of non - squared ground distances creates non - uniqueness and other undesirable properties .",
    "contrastingly , theoretical understanding of wasserstein distances largely is limited to the _",
    "two_-wasserstein distance @xmath26 . our distance @xmath84 , however , has properties in common with @xmath26 without a construction scaling quadratically in @xmath174 .",
    "the construction of @xmath84 provides a new avenue of research into the theory and practice of transportation distances on graphs .",
    "most immediately , replacing our use of generic optimization tools with admm  @xcite or another specialized technique may help scale @xmath84 to graphs like social networks and websites with millions of nodes . alternatively , since @xmath175 is the laplacian matrix of @xmath52 , it may be possible to apply spectral techniques to approximate minima of   e.g.  by decomposing @xmath176 where @xmath177  @xcite .",
    "more generally , our variational construction of @xmath84 by introducing a continuous time variable @xmath72 still led to a distance function over the finite - dimensional space @xmath56 ; this pattern may reveal a more general strategy for problems on graphs with more easily - understood continuous analogs .",
    "while our discussion has circulated largely around the construction of @xmath84 and some motivating examples , we foresee many practical applications of our machinery and larger optimizations in which it can play a key role . for instance , the distribution minimizing the sum of squared two - wasserstein distances yields an effective strategy for computing a _",
    "barycenter _ summarizing a set of distributions  @xcite ; networks of such pairwise distances create effective strategies for semi - supervised learning  @xcite .",
    "similar strategies have been applied to construct techniques for clustering  @xcite and matrix factorization  @xcite .",
    "optimal transportation also has had considerable influence on methods in vision  @xcite , imaging  @xcite , graphics  @xcite , shape processing  @xcite , road networks  @xcite , and other application areas . with our graph - based treatment",
    "we hope to extend these benefits to other domains like documents with geometric embedding structure  @xcite ."
  ],
  "abstract_text": [
    "<S> optimal transportation distances are valuable for comparing and analyzing probability distributions , but larger - scale computational techniques for the theoretically favorable quadratic case are limited to smooth domains or regularized approximations . motivated by fluid flow - based transportation on @xmath0 , however , this paper introduces an alternative definition of optimal transportation between distributions over graph vertices . </S>",
    "<S> this new distance still satisfies the triangle inequality but has better scaling and a connection to continuous theories of transportation . </S>",
    "<S> it is constructed by adapting a riemannian structure over probability distributions to the graph case , providing transportation distances as shortest - paths in probability space . after defining and analyzing theoretical properties of our new distance </S>",
    "<S> , we provide a time discretization as well as experiments verifying its effectiveness . </S>"
  ]
}