{
  "article_text": [
    "the magic telescope belongs to the latest generation of imaging atmospheric cherenkov telescopes ( iacts ) characterized by a high sensitivity .",
    "the magic telescope is also the iact with the lowest energy threshold , 60  gev , thanks to the large mirror diameter ( 17  m ) and the high quantum efficiency photomultipliers .",
    "the low energy threshold of the telescope can be further reduced when the so - called _ sum trigger _  @xcite is used .",
    "thanks to this trigger , the magic telescope has been able to reach an energy threshold of only 25  gev and has detected for the first time the vhe pulsed emission from the crab nebula pulsar  @xcite above 30 gev .",
    "the magic low energy threshold results in high event rates that impose demanding requirements on both the data acquisition system ( daq ) and the data storage devices .",
    "the daq of the magic telescope stores the complete waveform from all the 577 pixels in the camera .",
    "the sampling is done using 10  bits and a sampling rate of 2  ghz  @xcite .",
    "a total of 50 samples per event and pixel are stored .",
    "the total size of an event is 60.7  kbyte and the average trigger rate is around 350  hz .",
    "the average raw data volume is around 21  mbyte / s .",
    "sum trigger observations can increase the trigger rate above @xmath01  khz .",
    "in that case , the raw data volume reaches 60  mbyte / s and one night of observation can easily exceed 1  tbyte of data .",
    "the daq is only one of the processes with high demanding requirements in terms of storage .",
    "other processes executed at the telescope site need access to the written data and also have important i / o requirements . during observation ,",
    "the on - line analysis program produces a fast analysis using the data just being taken . to do so",
    ", the on - line analysis software accesses the raw data a few seconds after they have been written to the disks .",
    "events are processed at a speed similar to that of the daq , thus requiring a reading performance comparable to the writing performance needed by the daq .",
    "the high data volumes generated by the magic telescopes can not be transferred directly through network to the datacenter  @xcite , but have to be processed first .",
    "data are first compressed to reduce their volume in disk ( factor @xmath03.1 reduction ) and later taped .",
    "several cpu cores are used in parallel to perform the compression of the data , so the speed of the compression process is usually limited by the i / o speed of the disks where the raw data are stored .",
    "taping is done to have a backup copy of the data and to transfer the data to the datacenter .",
    "the taping process requires a speed up to 60  mbyte / s ( lto3 tapes used for magic - i ) .    in order to make data available as soon as possible , the on site analysis software performs the calibration of the data also at the telescope site . calibrated data ( factor @xmath1 reduced in comparison to raw data ) can hence be easily transferred to the datacenter using a fast network connection .",
    "typically , calibrated data is available at the datacenter less than 24 hours after the data taking is finished .",
    "calibration and data transfer are two of the most demanding processes in terms of i / o performance .",
    "the read and write disk speed must be as high as possible in order not to be limited by the disk access .",
    "these processes are also quite demanding in terms of cpu and typically several instances of the on - site analysis and the data transfers must be executed in several cpu cores .    the second magic telescope  @xcite ( currently under commissioning ) is equipped with 1039 pixels and the daq works also with a sampling rate of 2  gsamples / s . as a result , the event size increases to @xmath0110  kbyte , doubling the expected data volumes .",
    "similar processes as those described for the first magic telescope have to be executed for the data coming from the second magic telescope , the difference being the data flow and the cpu needed to process the double amount of data . although the storage systems for magic - i and magic - ii data can be completely independent , a system where both telescopes are integrated would allow us to dynamically choose which resources ( cpus or storage ) are to be used in each telescope .",
    "many of the magic requirements can be provided by a storage area network ( san ) solution .",
    "a san is an architecture to attach remote computer storage devices to servers , such that the devices appear as locally attached to the operating system .",
    "this can provide the required high i / o performance but does not solve the problem of offering a consistent view of the file system to all computers directly attached to the storage devices . in addition , the required solution should also be flexible and scalable in order to accept the changes that will be introduced when the second telescope starts its operation .",
    "when two or more computers work together to perform the same task they form a cluster .",
    "clusters of computers are built to provide storage , high availability , load balance or high performance . in the case of magic",
    ", a cluster of computers is used to provide a consistent file system image across the servers in the cluster .",
    "all members of the clusters ( nodes ) have simultaneous read and write access to a shared file system .",
    "the storage cluster solution used in magic uses the red hat cluster suite ( rhcs )  @xcite and the red hat global file system ( gfs )  @xcite .",
    "the rhcs is an integrated set of software that can be configured to suit the needs of each cluster system .",
    "rhcs provides the basic functionality for the nodes to work together : configuration - file management , membership management , lock management and fencing .",
    "this functionality is provided by the different daemon process executing in all nodes : ccsd , cman , lockd and fenced .",
    "* ccsd manages the cluster configuration , making sure that all cluster members have the same cluster configuration .",
    "changes in the cluster configuration can be propagated to all nodes by the ccsd .",
    "* cman manages cluster quorum an cluster membership .",
    "cman keeps track of cluster quorum by monitoring the number of cluster nodes . when more than half of the nodes are active the cluster reaches quorum . when the cluster does not have quorum all cluster activity is blocked , preventing the cluster fragmentation that could lead in a storage cluster to data corruption in the file system .",
    "membership is tracked by monitoring the messages that the nodes exchange .",
    "these messages are communicated between nodes via ethernet .",
    "* lock is a service that provides the mechanism to synchronize access to shared resources . in the rhcs the distributed lock manager ( dlm )",
    "is the lock manager .",
    "it runs in each cluster node , distributing the lock management across all nodes in the cluster .",
    "* fenced manages the disconnection of a node from a cluster shared storage , cutting i / o from shared storage and ensuring data integrity .",
    "when a cman process determines that a node has failed this information is communicated to all nodes . when notified , the fenced daemon fences the failed node .",
    "different fencing methods exist to guarantee that the fenced node does not have access to the shared storage .",
    "two of the most widely used fencing methods are _ power fencing _ ( power off the failed device ) , _ fibre channel switch fencing _ ( close the fibre channel switch port of the failed node ) .    on top of the cluster services the red hat global file system ( gfs )",
    "can be installed ( see figure  [ fig : software - stack ] ) .",
    "gfs is a native file system that interfaces directly with the linux kernel file system interface .",
    "although gfs can work in a stand alone node , it shows all its capabilities when implemented as a cluster file system .",
    "gfs provides data sharing among gfs nodes in a cluster , providing a single , consistent view of the file system . with gfs",
    ", applications running on different nodes can share files in the shared storage in the same way as applications running in the same machine can share files in a local file system ( figure  [ fig : software - stack ] ) .",
    "finally , gfs can be deployed in a variety of configurations that can fit any user needs .",
    "this is an open source solution supported by different widely used linux distributions like rhel or scientific linux .",
    "in addition , this solution is also highly flexible and can be easily scaled as new needs appear .",
    "magic has implemented at the telescope site a san solution with fibre channel technology that uses rhcs cluster suite and the gfs file system . at present seven nodes",
    "running red hat enterprise linux ( rhel ) 4.3 and scientific linux ( sl ) 4.4 are members of the cluster . at a low level , the connection between the cluster nodes and the storage devices is done using fibre channel technology .    at the moment magic",
    "has installed 4 raid ( redundant array of independent disks ) systems with capacities between 7 and 21  tbytes .",
    "the raid units consist of several physical sata disks configured in raid5 ( redundancy based on parity data distributed across all member disks ) , which offers redundancy without sacrificing much of the i / o performance .",
    "maximum read / write ( r / w ) speed of the raid systems is between 250 and 300 mbyte / s .",
    "the raid systems are equipped with two fibre channel interfaces each .",
    "the speed of the fibre channel connection is 2 or 4  gbps ( 250 and 500 mbyte / s ) for the different raid systems and nodes .",
    "the connection between nodes and raid systems is not direct .",
    "all devices in the storage network are connected to fibre channel switches that are configured to work in a fabric topology .",
    "a total of three switches are used in our current configuration to guarantee the access to the storage devices in case of a switch failure .",
    "the switches can be cascaded if a special license is purchased .",
    "currently only two of the switches are connected ( see figure  [ fig : gfs - topology ] ) .",
    "the rhcs - gfs suite has been installed in all nodes as well as the tools and drivers needed for the fibre channel connections .",
    "currently the system is running using the same rhcs and gfs versions installed in two different linux distributions and different kernel versions .",
    "the software structure is organized as follows . at the lowest level",
    "the fibre channel driver connects the nodes to the switches and the storage devices . on top of that",
    ", the operating system can access the devices as scsi devices directly attached to the node .",
    "the multipath service combines all different routes to the same device under a common device . on top of this ,",
    "the cluster services of the rhcs run on each node providing all services needed for the gfs layer .",
    "the gfs provides the consistent view of the file system to all nodes in the cluster , mounting the device provided by multipath and formatted with the gfs file system . on top of the gfs",
    "the different applications are executed in each node .",
    "the storage cluster is currently composed of seven nodes . due to gfs layer the maximum r / w speed in the raid systems",
    "is limited to only @xmath0200  mbyte / s for a single raid system .",
    "different nodes can have access at the highest rates to different raid systems simultaneously .",
    "the raid systems with higher capacities are subdivided in partitions with the same size as the smallest raid systems ( @xmath2  tbytes / partition ) .",
    "this size was limited by the first gfs version installed in the system .",
    "the seven currently installed nodes contain 42 cores that have direct access to storage devices and share the same consistent view of the file system .",
    "all messages exchanged by the cman daemon are transmitted through a dedicated 1  gbps ethernet network and a dedicated ethernet adaptor in each node .",
    "additional aspects that were considered when adapting this solution include the reliability , the flexibility and the scalability of the system .",
    "the gfs solution implemented in magic offered excellent characteristics in all these aspects .      at the lowest level ,",
    "the raid units are configured in raid5 which guarantees that no data is lost when one of the disks in the raid units fails .",
    "in addition , the control software of the raids automatically uses the units configured as spares in the raid when a disk failure occurs .    at the fibre channel level",
    ", a failure in one of the connections or in a full switch can be handled by the multipath daemon .",
    "when a node or a storage device has more than one fibre channel interface , different routes exist to access the same device .",
    "the multipath daemon unifies all possible paths to a storage device as one unique device . in case of a failure",
    ", multipath automatically routes the traffic using the working paths without any action required . at present three fibre channel switches are used also to provide higher reliability .",
    "node failures are handled by the cman service , part of the rhcs .",
    "when a node failure happens the fence service blocks all nodes access to the shared storage units until the non - responding node is blocked .",
    "this is done to prevent data corruption in the file system .",
    "the fencing of a node is done in our implementation by closing the ports in the fibre channel switches where that node is connected .",
    "this guarantees that the non - responding node can not access the raid disks .",
    "after the node is fenced , the access to the raids system is enabled again for all members of the cluster .",
    "the time needed for this operation is of only a few seconds and it is automatically handled by the cman and fence services .",
    "cluster configuration is contained in a single file that is identical in all nodes belonging to the cluster .",
    "any change in the cluster configuration ( like adding a new node ) can be easily propagated to all nodes in the cluster with the ccsd daemon .",
    "since all nodes have direct r / w access to the gfs file systems , applications running in any node can choose where to read or write data .",
    "this allows for the dynamical choice regarding how many applications are needed for each task and where they have to be executed , and provides a high flexibility that could not be reached with other solutions .",
    "this system can be easily extended by adding either more nodes or more storage devices . at present , less than 30% of the fibre channel switch ports are used .",
    "the fibre channel devices use the fabric topology making it possible to add more nodes or storage devices just by plugging them to a new port in the switch .",
    "adding more nodes to the storage cluster is also not a problem . at present seven nodes",
    "are connected and we have plans for adding at least five more new nodes to the cluster . the only limitation when adding more nodes is that the gfs file system must have a number of journals equal or larger than the number of nodes connected .",
    "that number is configured when the gfs partition is formatted .",
    "gfs supports over 100 nodes .",
    "the high demands that the data taking and the data process impose on the on site storage systems used in the magic telescopes have been addressed using the rhcs and the distributed filesystem gfs .",
    "this linux open source solution offers a consistent view of the file system and high i / o performance since all nodes in the cluster have direct access to the storage devices .",
    "it also provides high reliability and high flexibility that allows us to allocate resources dynamically where they are more needed or to change the configuration if a failure in a node or a storage device occurs . the system is also designed to provide easy scalability in the midterm future when new needs appear in the magic - ii phase of the experiment ."
  ],
  "abstract_text": [
    "<S> magic is currently the imaging cherenkov telescope with the worldwide largest reflector currently in operation . </S>",
    "<S> the initially achieved low trigger threshold of 60 gev has been further reduced by means of a novel trigger that allows the telescope to record gamma ray showers down to 25 gev . the high trigger rate combined with the 2 ghz signal sampling rate results in large data volumes that can reach 1 tbyte per night for magic - i and even more with the second magic telescope coming soon into operation . to deal with the large storage requirements of magic - i and magic - ii , we have installed the distributed file system gfs and a cluster of computers with concurrent access to the same shared storage units . </S>",
    "<S> the system can not only handle a sustained daq write rate above 1.2 khz for magic - i , but also allows other nodes to perform simultaneous concurrent access to the data on the shared storage units . </S>",
    "<S> various simultaneous tasks can be used at any time , in parallel with data taking , including data compression , taping , on - line analysis , calibration and analysis of the data . </S>",
    "<S> the system is designed to quickly recover after the failure of one node in the cluster and to be easily extended as more nodes or storage units are required in the future .    </S>",
    "<S> storage , nas , cluster , gfs </S>"
  ]
}