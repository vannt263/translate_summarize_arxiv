{
  "article_text": [
    "the promising field of organic electronics deals with large molecules of several tens or even hundreds of atoms  @xcite .",
    "for instance , fullerene c@xmath3 is a frequently used subunit in organic electronics and it alone consist of 60 atoms ( see figure [ f : fullerene_geometry ] ) .",
    "c4.5 cm     each individual molecule may be used in a device in many different ways and there is an astronomically large number of different promising molecules . as in many cases",
    "there is a limited knowledge of the relevant physical parameters , and it might be also interesting to explore the potential of candidate molecules theoretically , before these molecules has been actually synthesised .",
    "the geometry of large organic molecules can be reliably predicted by density - functional theory ( dft)@xcite .",
    "however , the properties of their excited states such as the energy of the highest occupied ( homo ) and lowest unoccupied molecular orbitals ( lumo ) , corresponding to adding and subtracting one electron from the system respectively , require a description of electronic correlations better than that provided by current functionals of dft and its time - dependent counterpart , tddft .    such effects can be efficiently incorporated with the help of hedin s method that is based on green s function .",
    "@xmath0 approximation for one - electron green s function is computationally cheaper than wavefunction - based methods , although it remains computationally more expensive than dft and tddft within linear response .",
    "the goal of our work is to develop a practical algorithm for hedin s @xmath0 approximation which is suitable for large organic molecules , allowing to access the excited states of such molecules .",
    "c6.5 cm     electronic green s function ( propagators ) are useful in condensed matter physics because many simple observables can be computed in terms of them . at the same time",
    ", such green s functions remain simpler than many - body wavefunction .",
    "hedin s @xmath0 is a useful approximation for the so - called self - energy @xmath4 that enters dyson s equation for an interacting electronic propagator @xmath5    @xmath6    here , the inversions must be understood in operator sense @xmath7 and @xmath8 stands for green s function where electron - electron interactions have been switched off . it is obtained from an effective one - particle hamiltonian @xmath9    in this work we use a kohn - sham hamiltonian  @xcite , although hartree - fock hamiltonian also proves to be useful at this point  @xcite .",
    "@xmath0 approximation for the self - energy @xmath10 reads @xmath11    c5.5 cm     it involves the non interacting electronic green s function @xmath12 and a screened coulomb interaction @xmath13 .",
    "this approximation is a solution of a truncated version hedin s equations @xcite .",
    "the name of this approximation is taken from the simple form of the electronic self - energy @xmath14 .",
    "the screened coulomb interaction @xmath15 can be easily calculated in frequency domain using the so - called rpa approximation  @xcite @xmath16^{-1 } v(\\bm{r}''',\\bm{r } ' ) , \\label{scr_inter}\\ ] ]    c9.0 cm     where @xmath17 is the bare coulomb interaction . here and",
    "in the following we assume integration over repeated spatial coordinates ( @xmath18 and @xmath19 in equation ( [ scr_inter ] ) ) on the right hand side of an equation if they do not appear on its left hand side .",
    "the screened interaction ( [ scr_inter ] ) is the sum of the bare coulomb interaction created by a point charge at @xmath20 , plus a correction due to the redistribution of charge induced in response to the total field @xcite .",
    "the non - interacting response function @xmath21 is related to the non - interacting green s function @xmath22where a factor @xmath23 arises because of the summation over spin variable .",
    "as we mentioned already , we construct the non - interacting green s function using an effective kohn - sham hamiltonian  @xcite @xmath24@xmath25 is a functional of the electronic density that includes the effects of exchange and correlation in an effective way .",
    "its functional derivative @xmath26 is the so - called exchange - correlation potential and it must be subtracted from @xmath27 to avoid including the exchange - correlation interaction twice in equation ( [ self_energy ] ) .",
    "this is accomplished with the substitution @xmath28 in dyson s equation ( [ dyson_for_gf ] ) .",
    "having the equations ( [ dyson_for_gf],[self_energy],[scr_inter],[noninter_response ] ) at hand we introduce a basis set of localized functions and rewrite the system of equations in the basis .",
    "we start with linear combinations of atom orbitals ( lcao ) to represent the non - interacting green s function @xmath29 @xmath30 where @xmath31 are atom centered orbitals .",
    "the frequency ( and time ) dependence has been factorized in the last equation .",
    "the treatment of the frequency ( and time ) dependence by spectral functions will be explained in section [ s : frequency - dependence ] . inserting equation ( [ g0_basis ] ) into the equation ( noninter_response )",
    ", we obtain @xmath32 products of localized orbitals such as @xmath33 appear in the last equation .",
    "although a product of localized orbitals is also a localized function , such products do not form a suitable basis because they contain many collinear functions .",
    "several methods have been proposed to construct more efficient basis to span the products of localized orbitals @xcite .",
    "here we use a basis of dominant products @xcite that is constructed individually for each atom pair .",
    "the dominant products are identified as certain linear combinations of the original orbital products and they are free of any collinearity within a given atom pair ( with respect to a given metric , here we have used the coulomb metric ) . moreover , the original orbital products can be expressed as linear combinations of dominant products @xmath34the three - index coefficient @xmath35 will be referred to as the _ product vertex_. the product vertex is local or sparse by construction and indeed the _ locality _ of our construction is its main characteristic .    considering dyson s equation ( [ dyson_for_gf ] ) , we arrive at its tensor counterpart @xmath36where matrix elements of the self - energy @xmath37",
    "must be used @xmath38    calculating the matrix elements of the self - energy by equation ( self_energy ) and using ( [ g0_basis ] ) for the non interacting green s function , we arrive at @xmath39 using the identity ( [ vertex_definition ] ) , we rewrite the latter equation as @xmath40where the matrix elements of the screened coulomb interaction appear @xmath41 finally , the equation ( [ scr_inter ] ) gives rise to the corresponding tensor expression @xmath42    the last expression can be elucidated by developing the operator @xmath43 ^{-1}$ ] in a geometric series @xmath44^{-1 } = 1+v\\chi_0+v\\chi_0v\\chi_0+v\\chi_0v\\chi_0v\\chi_0 \\ldots$ ] the expressions ( [ response_tensor ] ) , ( [ dyson_tensor ] ) , ( self_energy_tensor ) and ( [ scr_inter_tensor ] ) are tensor counterparts of hedin s equations in coordinate space ( [ noninter_response ] ) , ( dyson_for_gf ) , ( [ self_energy ] ) and ( [ scr_inter ] ) , correspondingly . in the next section , we will present our method for treating the frequency ( and time ) dependence of these tensor equations .",
    "because of the discontinuities of the electronic green s functions , a direct , straightforward and accurate computation of the response function ( [ response_tensor ] ) is practically impossible both in the time domain and in the frequency domain",
    ". however , one can use an imaginary time technique @xcite or spectral function representations to recover a computationally feasible approach . in this work ,",
    "we use spectral function techniques and rewrite the time ordered operators as follows @xmath45 where `` positive '' and `` negative '' spectral functions define the whole spectral function by means of heaviside functions @xmath46 . for instance",
    ", the spectral function of the electronic green s function reads @xmath47 transforming the first of equations ( [ spectral_1 ] ) to the frequency domain , we obtain the familiar expression for the spectral representation of a green s function @xmath48here @xmath49 is a small line - broadening constant . in practice , the choice of @xmath49 is related to the spectral resolution @xmath50 of the numerical treatment .    as first application of representations ( [ spectral_1 ] )",
    ", we derive the spectral function of the non interacting response @xmath51 using equation ( [ noninter_response ] ) as a starting point @xmath52here , the convolution can be computed with fast fourier methods and the ( time - ordered ) response function @xmath53 can be obtained with a cauchy transformation @xmath54    the calculation of the screened interaction @xmath55 must be done with functions , rather than with spectral functions , because of the inversion in equation ( [ scr_inter_tensor ] ) .",
    "the spectral function of the screened interaction @xmath56 can be easily recovered from the screened interaction itself @xcite . since @xmath57 is a representation of dirac @xmath58-function when @xmath59 goes to zero , then @xmath60 .",
    "deriving the spectral function @xmath61 of the self - energy , we arrive at @xmath62these expressions show that the spectral function of a convolution is given by a convolution of the corresponding spectral functions .",
    "the spectral functions in equation ( [ sf_response_tensor ] ) are merely a set of poles at ( eigen)energies @xmath63 @xmath64here the eigenvectors @xmath65 diagonalize the corresponding kohn - sham hamiltonian @xmath66 where the hamiltonian and the overlap matrices of atomic orbitals @xmath31 enter @xmath67 in practice , we use the siesta package @xcite that gives the orbitals @xmath31 , eigenvectors @xmath65 and eigenvalues @xmath63 for a given molecule as the output of a dft calculation .",
    "the use of fast fourier techniques for convolution , for instance in equation ( [ sf_response_tensor ] ) , requires that the spectral functions @xmath68 , @xmath69 be known at equidistant grid points @xmath70 , rather than at a set of energies resulting from a diagonalization procedure .",
    "the solution for this problem ( discretization of spike - like functions ) is known and well tested shishkin - kresse:2006 .",
    "we define a grid of points that covers the whole range of eigen energies @xmath63 .",
    "going through the poles @xmath63 , we assign their spectral weight @xmath71 to the neighboring grid points @xmath72 and @xmath73 such that @xmath74 according to the distance between the pole and the grid points @xmath75 such a discretization keeps both the spectral weight and the center of mass of a pole .",
    "it also reduces the number of operations that are needed to calculate the non interacting response function @xmath76 .",
    "this is so because the number of frequencies @xmath77 can be kept small ( typically a few hundred points ) even for large molecules while the number of states @xmath78 grows linearly with the size of the system .",
    "the discretization of spectral weight helps to control the computational complexity for large molecules .",
    "however , we are actually interested in the properties of low lying levels ( homo and lumo and several levels below and above ) . at first sight",
    "one might think that one could neglect the contributions of high energy spectral weights in the cauchy transformation .",
    "however , neglecting the high energy spectral weight actually results in a wrong real part of the functions .",
    "fortunately , the high energy spectral weight tolerates a coarser grid @xcite .",
    "therefore , we calculate each spectral function twice : once with a higher resolution in a low frequency range , and a second time with a lower resolution but in the whole range .",
    "the cauchy transformation for such a two - window representation must be modified as follows    @xmath79 _ { \\text{truncated spectral function}}. \\label{win2-for - response}\\end{gathered}\\ ] ]    after the calculation of spectral functions in both windows , we truncate the spectral function in the second window in the range @xmath80 , do cauchy transform of both spectral functions and update ( by a linear interpolating procedure ) the function in the first window with the truncated function from the second window .",
    "we use the second window technique both for the non interacting response function @xmath53 and for the self - energy @xmath81 .",
    "the basis of dominant products is optimal within a given atom pair , but unfortunately , there is still a lot of collinearity between dominant products belonging to different pairs .",
    "this collinearity is an indication that the size of the product basis can be strongly reduced . even for the molecules of modest size considered in section  [ ss : hydrocarbons ] the basis set of dominant product becomes so large that hampers the storage of the ( non - interacting ) response function ( sf2response ) and slows down the inversion in the calculation of the screened interaction ( [ scr_inter_tensor ] ) . in order to improve the situation we perform a non - local ( global ) contraction of the basis of dominant product .",
    "we start by considering a sum - over - states expression for the non - interacting response function in the basis of dominant products    @xmath82    the response @xmath53 is built up from vectors @xmath83 that represent electron - hole pair excitations .",
    "one can use these vectors to identify important directions in the space of dominant products .",
    "the number of electron  hole pairs @xmath84 grows as @xmath85 with the molecular size while the dimension of dominant product basis is @xmath86 by construction ( due to the localization of the basis orbitals ) .",
    "therefore , one has to limit the set of electron - hole pairs @xmath84 from the beginning to keep the efficiency of the algorithm , particularly if one uses a diagonalization - based procedure for generating the ( globally ) optimal basis . because of the inherent limitations of lcao to represent high energy features , and the fact that we are mainly interested in the lowest lying excitations , we choose @xmath86 low - energy electron - hole pairs @xmath87after the initial selection according to the energy criterion @xmath88 , we define a metric @xmath89 @xmath90after diagonalizing the metric @xmath91 , we can identify important directions ( like in the construction of the basis of dominant products @xcite ) by building linear combinations of the original vectors @xmath92 and by choosing only eigenvectors with eigenvalues above a suitable threshold value @xmath93these linear combinations can be used to expand the original response function @xmath53 in terms of fewer functions @xmath94 in order to express @xmath95 in terms of @xmath96 we multiply equation ( [ expand_in_the_basis ] ) with @xmath97 from both sides and notice that @xmath98 . therefore , the response function can be `` compressed '' by using basis vectors @xmath99 @xmath100    the particular choice of the coulomb metric @xmath101 in equation ( [ projector0 ] ) simplifies the computation of the coulomb screened interaction ( [ scr_inter_tensor ] ) .",
    "we can rewrite the equation ( [ scr_inter_tensor ] ) in terms of a taylor series @xmath102inserting here the response function @xmath103 according to equation ( [ expand_in_the_basis ] ) and recalling the identity @xmath104 , one arrives at @xmath105 z_{n}^{\\nu } =   \\label{chi_rpa } \\\\ & = v^{\\mu \\nu } + z_{m}^{\\mu } \\chi _ { mn}^{\\mathrm{rpa}}z_{n}^{\\nu } , \\text { where } \\chi _ { mn}^{\\mathrm{rpa}}\\equiv \\left ( \\delta _ { mk}-\\chi _ { mk}^{0}\\right ) ^{-1}\\chi _ { kn}^{0}.   \\notag\\end{aligned}\\ ] ]    at this point it should be also be noted that the self - energy @xmath106 that corresponds to the instantaneous part of the screened interaction @xmath101 is computed separately friedrich , df - pk - dsp:2011 without any non local compression .",
    "the number of mathematical operations spent in different parts of the approach presented above can be estimated if the dimensions of the corresponding matrices are known .",
    "the numbers that determine the complexity of the algorithm are the number of atomic orbitals @xmath78 , the number of dominant functions @xmath107 and the number of frequencies @xmath77 .",
    "the number of orbitals and the number of dominant products are proportional to the number of atoms @xmath2 by construction .",
    "the number of frequencies affects the run time linearly , but it is independent of the number of atoms . the non - local basis of section [ s : non_local ] , can be constructed in @xmath108 operations because @xmath109 in equation ( [ subsetof_vef ] ) can be kept proportional to number of orbitals . in practical calculations",
    "we have found that converged results are achieved with @xmath110 . for large molecules , the number of important eigenvectors @xmath111 after dropping small eigenvalues @xmath112 in equation ( [ orthogonal ] ) is approximately @xmath113 .",
    "no part of the algorithm scales worse than @xmath108 @xcite .",
    "there are several portions of the code where @xmath108 operations are needed .",
    "however , only two of them have an appreciable impact on the run time : the computation of the response function and the computation of the self - energy .",
    "both of them scale as @xmath114 and give rise to an overall @xmath108 scaling of the run time .",
    "the methods described in the previous sections were carefully tested on several molecules . in this paper , we present two examples : calculations of homo and lumo levels of three aromatic hydrocarbons ( benzene , naphthalene and anthracene ) and a calculation of the homo and lumo levels of fullerene c@xmath115 .      from the interacting green",
    "s function @xmath116 we calculate the density of states ( dos ) @xmath117 and we then determine the positions of the homo and lumo levels from the dos .",
    "c6.8 cm    [ cols=\"<,<,<\",options=\"header \" , ]     the fullerene c@xmath3 and its derivatives are very popular ingredients in organic semiconductors and extensive experimental data and theoretical computations are available for the basic fullerene .",
    "we found that our lda+@xmath118 results are in very good agreement with experimental data ( see table [ t_c60 ] ) .",
    "the computational parameters of this calculation are the same as in subsection [ ss : hydrocarbons ] , while the energy shift parameter is chosen to be 15  mev .",
    "the number of frequency points was chosen rather large @xmath119 and the calculation has been done with 8 cores of a nehalem machine ( intele5520 2.27ghz , cache 8m / ddr3 ram 24 gb ) .",
    "the current version of the code consumed 26 hours of wall clock time .",
    "a comparison of dos calculated with dft lda hamiltonian and with our lda+@xmath118 approach is shown in figure [ f : fullerene_dos ] .",
    "such a result is a typical when hedin s @xmath0 approach is applied on top of a lda calculation .",
    "@xmath0 homo has lower energy than dft homo .",
    "therefore , the change density @xmath120 will be more localized in the @xmath0 calculation .",
    "@xmath0 lumo has higher energy than dft lumo .",
    "therefore , the change density @xmath120 will be more delocalized in the @xmath0 calculation .",
    "we have described our approach to hedin s @xmath0 approximation for finite systems .",
    "this approach allows to compute the interacting green s function on a frequency grid .",
    "the density of states is our output and it provides homo and lumo levels in reasonable agreement with experiment .",
    "the complexity of the approach scales with the third power of the number of atoms , while the needed memory scales with the second power of the number of atoms .",
    "these features make our approach suitable for treating the large molecules that are used in organic semiconductors .",
    "we thank james talman for inspiring discussions , correspondence and essential algorithms and computer codes @xcite , that are used in our implementation .",
    "we are indebted to the organizers of the etsf2010 meeting at berlin for feedback and perspective on the ideas of this paper .",
    "arno schindlmayr , xavier blase and michael rohlfing helped with extensive correspondence on various aspects of the @xmath0 method .",
    "dsp and pk acknowledge financial support from the consejo superior de investigaciones cientficas ( csic ) , the basque departamento de educacin , upv / ehu ( grant no .",
    "it-366 - 07 ) , the spanish ministerio de ciencia e innovacin ( grants no . fis2010 - 19609-c02 - 02 ) and , the etortek program funded by the basque departamento de industria and the diputacin foral de guipuzcoa .",
    "j.  m.  soler , e.  artacho , j.  d.  gale , a.  garca , j.  junquera , p.  ordejn and d.  snchez - portal , j. phys .",
    ": condens .",
    "matter * 14 * , 2745 ( 2002 ) ; e.  artacho , e.  anglada , o.  dieguez , j.  d.  gale , a.  garca , j.  junquera , r.  m.  martin , p.  ordejn , j.  m.  pruneda , d.  snchez - portal and j.  m.  soler , j. phys . :",
    "matter * 20 * , 064208 ( 2008 ) .        for hydrocarbons : http://cccbdb.nist.gov/ and j.  c.  rienstra - kiracofe , ch .",
    "j.  barden , sh .",
    "t.  brown , and h.  f.  schaefer , j. phys .",
    "a * 105 * , 524 ( 2001 ) ; for fullerene c@xmath3 at http://sesres.com/physicalproperties.asp ."
  ],
  "abstract_text": [
    "<S> organic electronics is a rapidly developing technology . typically , the molecules involved in organic electronics are made up of hundreds of atoms , prohibiting a theoretical description by wavefunction - based ab - initio methods . </S>",
    "<S> density - functional and green s function type of methods scale less steeply with the number of atoms . </S>",
    "<S> therefore , they provide a suitable framework for the theory of such large systems .    in this contribution , we describe an implementation , for molecules , of hedin s @xmath0 approximation . </S>",
    "<S> the latter is the lowest order solution of a set of coupled integral equations for electronic green s and vertex functions that was found by lars hedin half a century ago .    </S>",
    "<S> our implementation of hedin s @xmath0 approximation has two distinctive features : i ) it uses sets of localized functions to describe the spatial dependence of correlation functions , and ii ) it uses spectral functions to treat their frequency dependence . using these features </S>",
    "<S> , we were able to achieve a favorable computational complexity of this approximation . in our implementation </S>",
    "<S> , the number of operations grows as @xmath1 with the number of atoms @xmath2 .    </S>",
    "<S> peter koval , dietrich foerster , daniel snchez - portal    koval.peter@gmail.com1    d.foerster@cpmoh.u-bordeaux1.fr3    sqbsapod@sq.ehu.es1 </S>"
  ]
}