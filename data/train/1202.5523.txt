{
  "article_text": [
    "the fundamental theorem of arithmetic is arguably the most important result in the field of number theory @xcite .",
    "it establishes the central role played by the prime numbers and has many profound consequences on the properties of integers .",
    "of particular importance is the _ uniqueness _ of the prime factorization , a fact that was fully recognized during the @xmath2th century with the first examples of number fields where uniqueness does not hold .",
    "this observation gave rise to the notion of ideal , a concept of paramount importance in ring theory and abstract algebra @xcite .",
    "more recently , the study of unique factorization and ideals was extended to rings with zero divisors @xcite , noncommutative rings @xcite and nonassociative rings and algebras @xcite .    in this article",
    "we demonstrate that an equivalent to the fundamental theorem of arithmetic holds at the element level on the ensemble of walks on any finite quiver equipped with a product operation we introduce , the nesting product .",
    "thanks to this result , we obtain a continued fraction formulation for characteristic series of walks on such quivers .",
    "this extends results of @xcite and @xcite .",
    "we give examples of applications of our results in combinatorics and language theory .",
    "usually , the ensemble of all the walks on a quiver @xmath0 is made into a @xmath1-algebra , known as the quiver algebra or path algebra @xmath3 @xcite , by adjoining the operations of addition and concatenation to it .",
    "concatenation is a very liberal operation : the concatenation @xmath4 of two walks is non - zero whenever the final vertex of @xmath5 is the same as the initial vertex of @xmath6 .",
    "this implies that both the irreducible and the prime elements of the quiver algebra are the walks of length 1 , i.e.  the edges of @xmath0 .",
    "consequently , the factorization of a walk @xmath7 on @xmath0 into concatenations of prime walks is somewhat trivial .",
    "for this reason , we abandon the operation of concatenation and introduce instead the nesting product as the product operation between walks on @xmath0 . nesting is a much more restrictive operation than concatenation , in that the nesting of two walks is non - zero only if the walks satisfy certain constraints . as a result of these constraints , the irreducible and prime elements of the near - algebra obtained upon replacing the concatenation with the nesting product are the simple paths and simple cycles of @xmath0 , rather than its edges .",
    "furthermore we prove that the factorization of any walk into these prime elements always exists and is unique .",
    "thanks to this result we obtain a novel representation for the ensemble of walks on @xmath0 and derive a compact expression for the sum of all the walks between any two vertices of @xmath0 as a continued fraction involving only the simple paths and simple cycles of @xmath0 .",
    "this article is organized as follows . in  [ concepts ] , we present the notation and terminology used throughout the article . in [ nestingdef ]",
    "we define the nesting product and establish its properties . in [ algebradef ]",
    "we define the quiver near - algebra @xmath8 , the equivalent of the quiver algebra @xmath3 with the concatenation replaced by the nesting product . in  [ sec : walkfactor ] we give the main results of the present article : ( i ) existence and uniqueness of the factorization of any walk into nesting products of simple paths and simple cycles ; ( ii ) an algorithm performing the factorization ; ( ii ) factorization of walk ensembles as nested ensembles of simple paths and simple cycles ; and ( iv ) factorization of sums of walks and sums of weighted walks as finite continued fractions over the simple paths and simple cycles .",
    "the results of this section are proven in appendices [ existsproof ] , [ algoval ] and [ sumproof ] . in  [ examplesection ] we present examples of the application of our results . finally , in  [ starheightsection ]",
    "we discuss the complexity of the prime factorization of walks .",
    "throughout this article , we let @xmath9 be a finite quiver which may contain self - loops , but not multiple edges ( i.e.  we restrict ourselves to at most one directed edge from @xmath10 to @xmath11 ) .",
    "the latter restriction is solely for the purpose of notational clarity , and all of our results can be straightforwardly extended to cases where @xmath12 contains multiple edges .",
    "we denote the vertices of @xmath0 by numbers or greek letters @xmath13 . the quiver obtained by deleting vertices @xmath13 and all edges incident on these vertices from @xmath0",
    "is written @xmath14 .",
    "@xmath7 of length @xmath15 from @xmath16 to @xmath17 on @xmath0 is a left - to - right sequence @xmath18 of @xmath19 contiguous edges .",
    "we describe @xmath7 by its vertex string @xmath20 or by its vertex - edge sequence @xmath21 .",
    "if @xmath22 , @xmath7 is termed a cycle ; otherwise , @xmath7 is an open walk .",
    "when necessary , the initial vertex of @xmath7 will be denoted by @xmath23 , and the final vertex by @xmath24 .",
    "the set of all walks on @xmath0 is denoted by @xmath25 , and the set of all walks from vertex @xmath16 to vertex @xmath26 on @xmath0 is denoted by @xmath27 .",
    "a _ simple path _ is a open walk whose vertices are all distinct .",
    "the set of all the simple paths on @xmath0 is denoted by @xmath28 .",
    "the set of simple paths from @xmath29 to @xmath30 is denoted by @xmath31 .",
    "these sets are finite .",
    "a _ simple cycle _ is a cycle whose internal vertices are all distinct and different from the initial vertex .",
    "the set of all the simple cycles on @xmath0 is denoted by @xmath32 , while the set of simple cycles off a specific vertex @xmath29 is denoted by @xmath33 .",
    "these sets are finite .",
    "a _ trivial walk _ is a walk of length 0 off any vertex @xmath34 , denoted by @xmath35 .",
    "a trivial walk is both a simple path and a simple cycle .",
    "let @xmath36 and let @xmath37 .",
    "set @xmath38 and @xmath39 for @xmath40 .",
    "then the kleene star of @xmath41 , denoted @xmath42 , is the set of walks formed by concatenating any number of elements of @xmath41 , that is @xmath43 .",
    "we now turn to the definition and properties of the nesting product .",
    "nesting is more restrictive than concatenation ; in particular , the nesting of two walks will be non - zero only if they obey the following property :    [ candef ] consider @xmath44 with @xmath45 a cycle off @xmath46 , and @xmath47 a walk that visits @xmath46 at least once .",
    "let @xmath48 be the last appearance of @xmath46 in @xmath5 .",
    "then the couple @xmath49 is canonical if and only if one of the following conditions holds :    * @xmath5 and @xmath6 are cycles off the same vertex @xmath46 ; or * @xmath50 ; that is , no vertex other than @xmath46 that is visited by @xmath5 before @xmath51 is also visited by @xmath6 .",
    "[ def : nesting ] let @xmath52 be a walk of length @xmath53 and @xmath54 be a cycle of length @xmath55 off @xmath46 such that the couple @xmath56 is canonical .",
    "then the operation of nesting is defined by    @xmath57    the walk @xmath58 of length @xmath59 is said to consist of @xmath60 nested into @xmath61 . the vertex sequence of @xmath58 is formed by replacing the _ last _ appearance of @xmath46 in @xmath61 by the entire vertex sequence of @xmath60 .",
    "the nesting of two walks @xmath62 that do not fulfill the requirements given above for @xmath61 and @xmath60 is defined to be @xmath63 .",
    "@xmath64 nesting is non - commutative and non - associative : for example , @xmath65 , while @xmath66 , and @xmath67 , while @xmath68 .",
    "@xmath69 nesting coincides with concatenation for cycles off the same vertex , let @xmath70 , then @xmath71 .",
    "consequently nesting is associative over the cycles , @xmath72 where @xmath73 .",
    "this in turn implies power - associativity over the cycles and we simply write @xmath74 for the nesting of a cycle @xmath75 with itself @xmath76 times , e.g. @xmath77 .",
    "we interpret @xmath78 as the trivial walk off @xmath79 .",
    "@xmath69 let @xmath80 .",
    "consider the trivial walk @xmath35 and observe that for any walk @xmath81 visiting @xmath82 we have @xmath83 .",
    "therefore we say that a trivial walk is a local identity element associated with the nesting product .",
    "let @xmath84 and @xmath85 . the nesting kleene star @xmath86 is the equivalent of the kleene star with the concatenation replaced by the nesting product : @xmath87 where @xmath88 and @xmath89 for @xmath90 .",
    "since nesting coincides with concatenation for cycles off the same vertex , the nesting kleene star coincide with the usual kleene star @xmath91 .",
    "then , from now on we do not distinguish between the two .    finally , with the nesting product comes a notion of divisibility which plays a fundamental role in the identification of irreducible and prime walks :    let @xmath92 .",
    "we say that @xmath93 divides @xmath7 , and write @xmath94 , if and only if @xmath95 such that either @xmath96 or @xmath97 .      in the spirit of the quiver algebra @xmath3 @xcite , we want to construct a @xmath1-algebra with the ensemble of walks @xmath98 as basis but equipped with the nesting product instead of the concatenation .",
    "however left - distributivity of the nesting product with respect to addition does not hold ( appendix [ nonbilinear ] ) .",
    "we therefore define a near @xmath1-algebra equipped with the nesting product :    from now on , we fix @xmath1 an algebraically closed field .",
    "the quiver near - algebra @xmath99 is the near @xmath1-algebra with basis the walks in @xmath0 and with the product of two walks @xmath7 , @xmath93 given by the nesting product @xmath100 .",
    "the addition of two walks @xmath7 , @xmath93 is non - zero if and only if @xmath101 and @xmath102 .    the identity element with respect to addition in @xmath8 is denoted @xmath103 and is not to be confused with a trivial walk .",
    "this element is absorbing with respect to nesting , @xmath104 .    the quiver near - algebra provides the algebraic structure necessary for an equivalent to the fundamental theorem of arithmetic to hold on quivers .",
    "to progress , we now identify the irreducible and prime elements of @xmath8 induced by the nesting product .",
    "we recall that a walk @xmath105 is irreducible if , whenever @xmath106 with @xmath107 , then either @xmath5 is trivial , or @xmath108 up to nesting with trivial walks ( i.e. local identities ) .",
    "a walk @xmath105 is prime if and only if @xmath109 or @xmath110 .",
    "[ irreducible ] the ensemble of irreducible walks is exactly @xmath111 .",
    "the irreducible walks are the prime elements of @xmath8 .    the simple paths and simple cycles of the quiver @xmath0 can be systematically obtained via the powers of its nilpotent adjacency matrix , see @xcite .",
    "we defer the proof of proposition [ irreducible ] to appendix [ existsproof ] .",
    "having established the definition and properties of the nesting product as well as the irreducible and prime elements it induces in @xmath8 , we turn to the factorization of walks .",
    "in this section , we present the main results of this article .",
    "first , we present the equivalent to the fundamental theorem of arithmetic on quivers and we give an algorithm factoring walks into nesting products of primes .",
    "second , we give a formula for factoring the ensemble of walks @xmath112 between any two vertices of @xmath0 into nesting products of ensembles of simple paths and simple cycles .",
    "third , we present factorized forms for the sum of all walks between any two vertices of finite quivers and weighted quivers .",
    "as we will see , these take on the form of finite continued fractions over the simple paths and simple cycles of the quiver .",
    "the results of this section are proven in appendices [ existsproof][sumproof ] and examples illustrating their use are provided in  [ examplesection ] .",
    "we begin by stating the conditions under which two factorizations of a walk into nesting products of shorter walks are equivalent .",
    "[ eqfacdef ] let @xmath81 .",
    "we say that two factorizations @xmath113 and @xmath114 of a walk @xmath7 equivalent , denoted @xmath115 , if and only if one can be obtained from the other through reordering parentheses and factors , and up to nesting with trivial walks , without modifying @xmath7 .",
    "[ canfac ] a canonical factorization @xmath116 of a walk @xmath81 is a factorization of @xmath7 into nesting products of simple paths and simple cycles .",
    "the relation @xmath117 between factorizations of definition [ eqfacdef ] is clearly an equivalence relation .",
    "thus , for each walk @xmath7 on @xmath0 , it defines an equivalence class on the set of all canonical factorizations of this walk @xmath118 .",
    "it is a central result of the present article that all canonical factorizations of @xmath7 belong to the same equivalence class @xmath119=\\{\\hat{\\mathfrak{f}}(w)\\in\\mathcal{f}_w,\\ , \\hat{\\mathfrak{f}}(w)\\equiv f(w)\\}$ ] and the set of irreducible factors of @xmath7 is uniquely determined by @xmath7 :    [ fundamentalthmquiver ] any walk on @xmath0 factorizes uniquely into nesting products of primes , the simple paths and simple cycles on @xmath0 .",
    "then @xmath8 is a noncommutative nonassociative unique factorization near - algebra with zero - divisors .",
    "@xmath69 theorem [ fundamentalthmquiver ] is proven in appendix [ existsproof ] .    from now on we shall thus speak of _ the _ canonical factorization @xmath120 of a walk @xmath7 . below we give an algorithm that produces @xmath120 for an arbitrary walk .",
    "later on , we will use the same algorithm to obtain a general formula giving the canonical factorization of walk ensembles into nesting products of prime walk ensembles . + * an algorithm to factorize walks *   + let @xmath81 and @xmath121 be the set of _ non - irreducible _ factors appearing in a factorization @xmath122 of @xmath7 .",
    "algorithm [ algocanfac ] picks an arbitrary non - irreducible factor of @xmath123 ( initially @xmath124 ) and factorizes @xmath5 into nesting products of strictly shorter walks , yielding @xmath125 .",
    "the algorithm then updates @xmath122 , replacing @xmath5 with its factorization in @xmath122 , denoted @xmath126 .",
    "at this point , the above procedure starts again , with the algorithm picking an arbitrary non - irreducible factor appearing in the updated factorization @xmath122 . at each round",
    ", non - irreducible factors are decomposed into nesting products of shorter walks .",
    "the algorithm stops when @xmath121 is the empty set @xmath127 , at which point @xmath122 is the canonical factorization @xmath120 of @xmath7 .",
    "we demonstrate the validity of the algorithm in appendix [ algoval ] .",
    "@xmath128 @xmath129    @xmath69 a detailed example of the use of algorithm [ algocanfac ] is provided in  [ shortexmp ] .      in this section we present the canonical factorization of walk ensembles .",
    "more precisely , we obtain the ensemble of walks between any two vertices of @xmath0 from nested ensembles of simple paths and simple cycles .",
    "let @xmath130 and @xmath131 be two ensembles of walks on @xmath0 . in the following we write @xmath132 for the set obtained by nesting every element of @xmath131 into every element of @xmath130 .",
    "[ factorbasis ] the canonical factorization of @xmath98 , which is the basis of the quiver near - algebra @xmath8 , is achieved by the following recursive relations :    @xmath133    with @xmath134 .",
    "note that if @xmath135 , then @xmath136 and @xmath137 with @xmath138 given by eq .",
    "( [ ag ] ) .",
    "this gives the factorization for ensembles of cycles on @xmath0 .",
    "@xmath69 the ensemble @xmath139 is defined recursively through eq .",
    "( [ ag ] ) . indeed @xmath139 is expressed in terms of @xmath140 which is in turn defined through eq .",
    "( [ ag ] ) but on the subgraph @xmath141 of @xmath0 .",
    "the recursion stops when vertex @xmath142 has no neighbour on this subgraph , in which case @xmath143 if the loop @xmath144 exists and @xmath145 otherwise .",
    "the maximum depth at which this recursion stops is discussed in  [ starheightsection ] .",
    "it characterizes the structural complexity of the quiver .",
    "@xmath69 theorem [ factorbasis ] is proven in appendix [ sumproof ] and examples of its use are given in  [ shortexmp ] .",
    "an essential consequence of theorem [ fundamentalthmquiver ] is that additive arithmetic functions of walks are completely determined by their values on the primes , i.e. the simple paths and simple cycles of @xmath0 .",
    "here we exploit this property to express the sum @xmath146 of all the walks @xmath147 solely in terms of prime walks . specifically , by using the fact that every open walk can be factorized into a simple path and a collection of nested simple cycles , we rewrite the sum of the elements of the walk set @xmath112 as a sum over simple paths by modifying each path in the sum to include all possible collections of nested simple cycles off the vertices it visits .",
    "we implement this modification by replacing each vertex @xmath148 in a simple path by a ` dressed vertex ' @xmath149 that accounts for all possible nested simple cycles off @xmath148 on @xmath0 . in turn , the vertices visited by these simple cycles are dressed by all the simple cycles off them that live on the appropriate subgraphs of @xmath0 , thereby implementing the recursive formulation of eqs .",
    "( [ wg ] , [ ag ] ) . finally , by formally resumming each of the sums of simple cycles into a closed form , we obtain a compact expression for the sum of all walks from @xmath29 to @xmath30 on @xmath0 .",
    "[ factorsum ] let @xmath146 denote the sum of all walks from @xmath29 to @xmath30 on @xmath0 .",
    "then @xmath146 is the walk given in vertex - edge notation by    @xmath150    where @xmath76 is the length of the simple path @xmath151 , and @xmath152 denotes the dressed vertex @xmath29 on @xmath0 , defined by @xmath153^{-1},\\label{eqn : dressedvertexclosedform2b}\\end{aligned}\\ ] ]    where @xmath154 is the length of the simple cycle @xmath155 .",
    "@xmath69 similarly to @xmath139 , the dressed vertex @xmath156 is defined recursively through eq .",
    "( [ eqn : dressedvertexclosedform2b ] ) since it is expressed in terms of dressed vertices @xmath157 .",
    "these are in turn defined through eq .",
    "( [ eqn : dressedvertexclosedform2b ] ) but on the subgraph @xmath158 of @xmath0 .",
    "the recursion stops when vertex @xmath142 has no neighbour on this subgraph , in which case @xmath159^{-1}$ ] if the loop @xmath144 exists and @xmath160 otherwise .",
    "@xmath69 the recursive definition of dressed vertices implies that the formula of corollary [ factorsum ] for @xmath146 yields a continued fraction .",
    "since @xmath0 is finite , the depth of this continued fraction is finite .",
    "@xmath69 corollary [ factorsum ] is proven in appendix [ sumproof ] .",
    "examples of factorized sums of walks are provided in  [ shortexmp ] .",
    "the formal factorization of @xmath146 achieved by corollary [ factorsum ] leads directly to a factorized form for the sum over the walks on _ weighted _ quivers .",
    "as we discuss in remarks [ contfrac ] , [ quasideterminants ] and [ matfunc ] , this leads to applications in the field of matrix computations .",
    "we begin by defining a weighted quiver :    a weighted quiver @xmath161 is a quiver @xmath0 paired with a weight function @xmath162 that assigns a weight @xmath163 $ ] to each edge @xmath164 of @xmath0 .",
    "we let the weight of an edge from @xmath82 to @xmath148 , denoted @xmath165 $ ] , be a @xmath166-by-@xmath167 complex matrix representing a linear mapping from a complex vector space @xmath168 of dimension @xmath167 to a complex vector space @xmath169 of dimension @xmath166 .",
    "we extend the domain of @xmath162 from the edge set @xmath170 to the quiver near - algebra @xmath8 by setting @xmath171=0 $ ] and @xmath172 = \\mathrm{id}_\\mu$ ] , the identity matrix of dimension @xmath167 . for @xmath173",
    "such that @xmath174 , we let    [ eqn : weightproperties ] @xmath175 & = f\\big[w_1\\big]f\\big[w'\\big]f[w_2 ] , \\shortintertext{where $ w_1 $ and $ w_2 $ are uniquely defined by $ w\\odot w'=w_1{\\circ}w'{\\circ}w_2 $ , and }    f\\big[w+w'\\big ] & = f\\big[w\\big]+f\\big[w'\\big],\\end{aligned}\\ ] ]    for walks @xmath176 satisfying @xmath177 and @xmath178 . note that the ordering of the weights when two walks are nested is suitable for the multiplication of their weights to be carried out .",
    "we now give the weighted equivalent of corollary [ factorsum ] .",
    "[ factorsumofweights ] let @xmath179 be an invertible matrix defined through @xmath180 .",
    "then as long as all of the required inverses exist , the weight of the sum of all walks from @xmath29 to @xmath30 on the weighted quiver @xmath161 is given by    [ weightedsum ] @xmath181&=\\sum_{\\pi_{{\\mathcal{g}};\\,\\alpha\\omega } } \\mathsf{f}_{{\\mathcal{g}}\\backslash\\{\\alpha,\\ldots,\\nu_p\\};\\,\\omega}\\ , \\mathsf{w}_{\\omega\\nu_p}\\cdots \\mathsf{f}_{{\\mathcal{g}}\\backslash\\{\\alpha\\};\\,\\nu_2}\\,\\mathsf{w}_{\\nu_2\\alpha}\\,\\mathsf{f}_{{\\mathcal{g}};\\alpha}\\,,\\label{weightedsumpath } \\shortintertext{where $ p$ is the length of the simple path , $ \\mathsf{w}_{\\nu\\mu } = f[(\\mu\\nu)]$ is the weight of the edge $ ( \\mu\\nu)$ , and } \\mathsf{f}_{{\\mathcal{g}};\\,\\alpha } \\equiv f\\big[(\\alpha)'_{\\mathcal{g}}\\big ] & = \\bigg[\\mathrm{id}_\\mu-\\sum_{\\gamma_{{\\mathcal{g}};\\,\\alpha}}\\,\\mathsf{w}_{\\alpha\\mu_m}\\,\\mathsf{f}_{{\\mathcal{g}}\\backslash\\{\\alpha,\\ldots,\\mu_{m-1}\\};\\,\\mu_m}\\,\\mathsf{w}_{\\mu_m\\mu_{m-1}}\\cdots \\mathsf{f}_{{\\mathcal{g}}\\backslash\\{\\alpha\\};\\,\\mu_2}\\,\\mathsf{w}_{\\mu_2\\alpha}\\bigg]^{-1},\\label{fweights}\\end{aligned}\\ ] ]    with @xmath154 the length of the simple cycle .",
    "@xmath182 is the effective weight of the vertex @xmath29 on @xmath0 once it is dressed by all the cycles off it .",
    "@xmath69 corollary [ factorsumofweights ] is illustrated by examples provided in  [ longexmp ] .",
    "[ contfrac ] the expression of @xmath183 $ ] is a continued fraction of finite depth , which results from the recursive definition of the @xmath182 .",
    "corollary [ factorsumofweights ] thus expresses the sum of the weights of all walks from @xmath29 to @xmath30 on any finite quiver as a _",
    "finite matrix - valued continued fraction _ over the simple paths and simple cycles of @xmath0 .",
    "we have recently used this approach to develop a new method for evaluating functions of matrices @xcite . in turn , we employed this method to compute the dynamics of many - body quantum systems @xcite .",
    "[ quasideterminants ] we emphasize that corollary [ factorsumofweights ] holds for arbitrary edge weights that need not commute with one another .",
    "for example , as we will show elsewhere , corollary [ factorsumofweights ] yields a generalized heredity principle for quasideterminants @xcite .",
    "the historical heredity principle found by gelfand and coworkers then follows from the application of the generalized heredity principle on the complete undirected graph on two vertices and with self loops @xmath184 .",
    "[ matfunc ] it is possible to generalize the definition of a weighted quiver to the case where the weight of an edge from @xmath82 to @xmath148 is any morphism @xmath185 in an additive category @xmath186 from an object @xmath187 , associated with the vertex @xmath82 , to an object @xmath188 , associated with the vertex @xmath148 .",
    "then theorem [ factorsumofweights ] holds upon requiring that the matrix of morphisms @xmath189 be invertible .",
    "this remark is based on an observation of @xcite .",
    "in this section we present examples of applications of the canonical factorization of walks on quivers . in the first section we provide simple examples illustrating algorithm [ algocanfac ] , theorem [ factorbasis ] and corollary [ factorsum ] . in the second part ,",
    "we provide exact results for the walk generating functions of any bethe lattice and any cycle graph .",
    "let @xmath0 be the complete undirected graph on @xmath190 vertices with vertex labels \\{1,2,3,4 } , and consider the walk @xmath191 .",
    "we use algorithm [ algocanfac ] to obtain @xmath120 .    initially , @xmath124 and @xmath192 .",
    "since @xmath7 is the only factor in @xmath122 , we let @xmath108 .",
    "the algorithm runs as follows :    * walk @xmath5 is open , define @xmath193 and @xmath194 . traversing @xmath195 from its first vertex onwards , vertex 1 is the earliest vertex visited at least twice by @xmath195 .",
    "then @xmath196 , @xmath197 and @xmath198 .",
    "* @xmath199 and @xmath61 is open .",
    "traversing @xmath61 from its first vertex onwards , vertex 2 is the earliest vertex visited at least twice by @xmath61 .",
    "then @xmath200 , @xmath201 and @xmath202 .",
    "* @xmath203 and @xmath60 is open .",
    "traversing @xmath60 from its first vertex onwards , vertex 3 is the earliest vertex visited at least twice by @xmath60 .",
    "then @xmath204 , @xmath205 and @xmath206 .",
    "* @xmath207 , we exit the while loop , and update @xmath122 , replacing @xmath5 by @xmath208 .",
    "we obtain , @xmath209 * now @xmath210 .",
    "we choose @xmath211 .",
    "this walk is a cycle off 3 and visits vertex 3 one further time .",
    "define @xmath212 , @xmath213 and update @xmath122 , replacing @xmath214 by @xmath215 , that is , @xmath216 * @xmath217 .",
    "we choose @xmath218 , @xmath5 is a cycle off 1 and visits vertex 1 one further time .",
    "define @xmath219 and @xmath220 , and update @xmath122 , replacing @xmath5 with @xmath221 , @xmath222 * @xmath223 . choosing @xmath224 , @xmath5 is a cycle but off 1 but does not have 1 as internal vertex .",
    "then @xmath225 , @xmath226 and @xmath198 .",
    "* @xmath227 , we exit the while loop , and update @xmath122 , replacing @xmath5 with @xmath228 . we obtain @xmath229 * @xmath230 , then @xmath231 .",
    "walk @xmath5 is a cycle off 2 but does not have 2 as internal vertex . then @xmath232 , @xmath233 and @xmath198 . *",
    "@xmath234 , @xmath61 is a cycle off 2 but does not have 2 as internal vertex .",
    "then @xmath235 , @xmath236 and @xmath202 .",
    "* @xmath237 , we exit the while loop and update @xmath122 , replacing @xmath5 with @xmath238 .",
    "we obtain @xmath239    at this point @xmath240 .",
    "( [ eq : walkfactored ] ) is therefore the canonical factorization @xmath120 of @xmath7 into nesting products of prime walks .",
    "a pictorial representation of the operations performed by the algorithm is given below :    for illustrative purposes , we show on the right a tree @xmath241 representing the canonical factorization of @xmath7 .",
    "each node corresponds to a nesting product , the leaves are the irreducible factors of @xmath7 , and the root is the walk @xmath7 itself .",
    "[ examplek3 ] we consider the complete bidirectional . ]",
    "quiver on three vertices @xmath242 , @xmath243 and @xmath244 with a loop on each vertex , denoted by @xmath245 .",
    "we factorize @xmath246 .",
    "firstly , we note that @xmath247 , so that eq .",
    "( [ ag ] ) yields @xmath248 then since @xmath249 and @xmath250 , we have @xmath251 and the analogous expressions produced by exchanging the labels @xmath243 and @xmath244 . inserting these expressions into eq .",
    "( [ factorw11k3step1 ] ) , we arrive at @xmath252 this set contains the canonical factorization of any cycle off @xmath242 on @xmath253 .    . ]    [ exmauto ] the ensemble @xmath112 can be interpreted as a local language recognized by the finite non - deterministic automaton @xmath254 , where the set of states of @xmath255 is @xmath256 , the alphabet @xmath257 is arbitrary provided there exists a map @xmath258 assigning labels to edges , the transition function is @xmath259 , and the initial state @xmath260 and final state @xmath261 are respectively @xmath29 and @xmath30 . in this",
    "context , theorem [ factorbasis ] generates all the languages recognizable by such an automaton .    for example , consider the automata @xmath262 of fig .",
    "[ fig : automata ] and let @xmath263 be the underlying quiver . theorem [ factorbasis ] yields @xmath264 as @xmath265 evaluating the nesting products yields , in edge notation , @xmath266 any language that can be recognized by an automaton based on @xmath0 is obtain upon replacing the edges @xmath267 in the expression above with their labels @xmath268 .",
    "in the case of fig .  [",
    "fig : automata ] , the language @xmath269 recognized by the automaton is    [ language ] @xmath270    where we used @xmath271 with @xmath272 . since the edge ordering for any walk @xmath273",
    "is preserved by eq .",
    "( [ edgenote ] ) , eq .",
    "( [ language ] ) remains valid for non - commuting letters .",
    "to illustrate corollary [ factorsum ] , consider the sum @xmath274 of all the walks from vertex 1 to itself on the complete bidirectional quiver on three vertices with no self - loops , denoted by @xmath275 . since the only simple path from a vertex to itself is the trivial path , eq .",
    "( [ eqn : sumofallwalks ] ) simply gives @xmath276 . according to eq .",
    "( [ eqn : dressedvertexclosedform2b ] ) the dressed vertex is given by @xmath277^{-1},\\label{eq : dressdepth1}\\end{aligned}\\ ] ] which follows from the observation that the only non - trivial simple cycles off vertex 1 on @xmath275 are the two back - tracks @xmath278 and @xmath279 and the two triangles @xmath280 and @xmath281 .",
    "now we use eq .",
    "( [ eqn : dressedvertexclosedform2b ] ) again to evaluate the required dressed vertices .",
    "we observe there are no non - trivial simple cycles off vertex 2 on @xmath282 , and no non - trivial simple cycles off vertex 3 on @xmath283 .",
    "thus @xmath284 is just the trivial walk @xmath285 , and @xmath286 .",
    "furthermore , since the only non - trivial simple cycle off vertex 2 on @xmath287 is @xmath288 , we obtain @xmath289^{-1}=\\big[(2)-(232)\\big]^{-1}.\\ ] ] similarly we have @xmath290^{-1}$ ] . inserting these results in eq .",
    "( [ eq : dressdepth1 ] ) yields @xmath291^{-1}(21)-(13)\\big[(3)-(323)\\big]^{-1}(31)\\nonumber\\\\ & \\hspace{15mm}-(12)\\big[(2)-(232)\\big]^{-1}(231)-(13)\\big[(3)-(323)\\big]^{-1}(321)\\big]^{-1}.\\end{aligned}\\ ] ] this result may alternatively be obtained from the canonical factorization of @xmath292 @xmath293 by following the procedure described in the proof of corollary [ factorsum ] : we sum the elements of the factorized form of @xmath292 , with the sums over the kleene stars yielding inverses .",
    "[ factorexample]consider the quiver @xmath0 illustrated on fig .",
    "[ fig : gref ] , and let @xmath294 be its adjacency matrix . let @xmath295 be the walk generating function for all the walks on @xmath0 from vertex 1 back to itself .",
    "this can be computed by noting that @xmath296 is the sum of the weights of all the walks @xmath297 on a weighted version of @xmath0 , which has an edge weight of @xmath298 assigned to every edge .     of example",
    "[ factorexample ] . ]",
    "corollary [ factorsum ] yields @xmath299 , the sum of all walks on the unweighted quiver @xmath0 , as    [ sumnonweigthed ] @xmath300^{-1},\\\\ ( 2)'_{{\\mathcal{g}}\\backslash\\{1\\}}&=\\big[(2)-(24)(4)'_{{\\mathcal{g}}\\backslash\\{1,2\\}}(42)\\big]^{-1},\\quad(4)'_{{\\mathcal{g}}\\backslash\\{1,2\\}}=\\big[(4)-(44)-(4564)\\big]^{-1},\\end{aligned}\\ ] ]    which corresponds to summing over the factorized form @xmath301 the sum over the walks of the weighted quiver is then obtained upon replacing each edge by its weight in eq .",
    "( [ sumnonweigthed ] ) .",
    "this yields @xmath302=\\frac{1}{1-z - z\\frac{1}{1-z\\frac{1}{1-z - z^3}z}z^2}=-\\frac{z^3+z^2+z-1}{z^6 + 2 z^4-z^3 - 2 z+1},\\ ] ] alternatively , the continued fraction form of this result may be directly obtained from corollary [ factorsumofweights ] . as expected , @xmath303 $ ] is equal to @xmath304^{-1})_{11}$ ] , where @xmath305 is the @xmath306 identity matrix @xcite .",
    "this shows that all the walks off @xmath242 on @xmath0 are indeed present in the factorized form of the walk ensemble eq .",
    "( [ wg11exfact ] ) .      the main application of corollary [ factorsumofweights ] is a novel approach for the computation of matrix functions @xcite .",
    "here we give two examples of its use in combinatorics .",
    "[ cyclegraph ] let @xmath307 be the @xmath19-vertices undirected cycle graph .",
    "we are interested in its walk generating functions . for convenience , we label the vertices of @xmath307 clockwise from @xmath242 to @xmath19 .",
    "we begin with the walk generating function @xmath308 for all the cycles off vertex @xmath242 .",
    "this is the sum of all cycle weights on a weighted version of @xmath307 where all edges have weight @xmath298 . since the only simple cycles off @xmath242 are the two backtrack to its neighbours , with weight @xmath309 , and the two long cycles of length @xmath19 ( the two directions count as different simple cycles ) , with weight @xmath310 , eq .",
    "( [ fweights ] ) yields @xmath311 in eq .",
    "( [ circleaa ] ) , we use the symmetry of @xmath307 , noting that @xmath312 etc .",
    "now remark that @xmath313 is the path graph on @xmath314 vertices , denoted @xmath315 .",
    "similarly , @xmath316 , @xmath317 .",
    "consequently , @xmath318 is the walk generating function of the leftmost ( or rightmost ) vertex of @xmath319 , which we denote @xmath320 . according to corollary [ factorsumofweights ] , @xmath321 is the continued fraction of depth @xmath322 : @xmath323 where @xmath324 is the gauss hypergeometric function .",
    "thus eq .",
    "( [ circleaa ] ) reads    @xmath325",
    "now we turn to the walk generating function for all walks from 1 to a vertex located at distance @xmath326 , @xmath327 , denoted @xmath328 . according to eq .",
    "( [ weightedsumpath ] ) , this is given by a sum over the simple paths from @xmath242 to @xmath326 .",
    "there are two such simple paths : one of length @xmath326 and one of length @xmath329 .",
    "dressing their vertices with eq .",
    "( [ fweights ] ) , we get    @xmath330    where we used again @xmath331 . for example , on the pentagon graph @xmath332 , eq .  ( [ contfrac ] ) together with eq .",
    "( [ wgfpn ] ) generates the continued fraction @xmath333 where @xmath29 is any vertex of @xmath332 .",
    "this is indeed equal to eq .",
    "( [ hyperanswer ] ) when setting @xmath334 and can be verified numerically .",
    "[ factorexamplebethe ] the bethe lattice @xmath335 is an infinite undirected tree where every vertex is connected to @xmath19 other vertices , see fig .",
    "[ bethe ] .",
    "we are interested in the walk generating functions of the bethe lattice @xmath335 between any two of its vertices and for any @xmath336 .",
    "this is given by the sum over all the walks between any two vertices of a weighted bethe lattice , where all edges have a weight of @xmath298 .",
    "let @xmath337 and let @xmath338 designate any vertex located at a distance @xmath339 from @xmath29 .",
    "first we obtain @xmath340 .",
    "since the only simple cycles off @xmath29 on @xmath335 are the @xmath19 edges cycles @xmath341 through the @xmath19 neighbours of @xmath29 , corollary [ factorsumofweights ] gives @xmath342 where @xmath343 is the walk generating function for all cycles off any neighbour @xmath344 of @xmath29 on @xmath335 with vertex @xmath29 removed .",
    "corollary [ factorsumofweights ] indicates that this is    , @xmath345 and @xmath346 .",
    "the exact bethe lattices are infinite in the radial direction . ]",
    "@xmath347    since the only simple cycles off @xmath344 on @xmath348 are the @xmath349 back - tracks @xmath350 . in eq .",
    "( [ genbeth2 ] ) we have used the symmetry of @xmath335 , noting that @xmath351 . solving eq .",
    "( [ genbeth2 ] ) for @xmath343 and inserting the result in eq .",
    "( [ genbeth1 ] ) we obtain @xmath352 now the walk generating functions for walks between any two vertices separated by a distance @xmath353 on @xmath335 follows from eq .",
    "( [ weightedsumpath ] ) upon noting that there is only one simple path from @xmath29 to any @xmath354 and that @xmath355 for all @xmath356 .",
    "then @xmath357 , yielding @xmath358 which can be verified numerically .",
    "if one adds a self - loop on every vertex of @xmath335 , the walk generating function becomes @xmath359 where @xmath360 designates the bethe lattice with self - loops .",
    "we obtain this result upon adding the loop weight @xmath298 to eq .",
    "( [ genbeth1 ] ) and eq .",
    "( [ genbeth2 ] ) ) becomes @xmath361 .",
    "] . with the formalism presented in @xcite",
    ", one can similarly obtain the resolvent and any other primary matrix function of the adjacency matrix of any bethe lattice using corollary [ factorsumofweights ] .",
    "the canonical factorization of a walk ensemble @xmath112 reduces this ensemble to nested ensembles of prime walks .",
    "since these primes  the simple cycles and simple paths of @xmath0  are difficult to identify , we expect the factorized form of @xmath362 to be difficult to construct",
    ". for example , if the quiver is hamiltonian , the hamiltonian cycle or path must appear in the factorization of at least one walk ensemble .",
    "consequently , factoring _ all _ the walk ensembles requires determining the existence of such a cycle or path , a problem which is known to be np - complete .    in order to formalize this observation",
    ", we study in this section the star - height of the canonical factorization , as given by theorem [ factorbasis ] , of any ensemble @xmath112 .",
    "the star - height @xmath363 of a regular expression @xmath364 was introduced by eggan @xcite as the number of nested kleene stars in @xmath364 .",
    "this quantity characterizes the structural complexity of formal expressions . as we can see from the examples given in ",
    "[ examplesection ] , canonical factorizations of walk ensembles typically have a non - zero star - height .",
    "the value of the star - height is a signature of the complexity of the quiver .",
    "the following theorem shows that the problem of determining @xmath365 is itself np - complete .",
    "[ starheighgraph ] let @xmath0 be a finite ordinary connected graph .",
    "let @xmath366 and let @xmath367 be the ensemble of longest simple paths starting on @xmath29 , with @xmath368 their length . then @xmath369 the problem of determining @xmath365 and @xmath370 is equivalent to determining the existence of an hamiltonian path starting on @xmath29 .",
    "it is therefore np - complete .",
    "@xmath69 in appendix [ starheightproof ] we obtain an exact recursive expression for @xmath365 with @xmath0 an arbitrary quiver and demonstrate theorem [ starheighgraph ] .",
    "theorem [ starheighgraph ] means that just determining the complexity of prime factorizations on ordinary graphs is already quite hard .",
    "this result may be considered unsurprising in view of the fact that prime factorizations are known to be difficult to obtain , e.g. in the case of integers . here",
    ", however , the origin of the difficulty is different to that in the case of integer factorization : it resides in factoring _ all _ the ensembles of _ all _ the walks between any two vertices of a connected graph or in computing the star - heights of the factorized forms . at the opposite ,",
    "factoring a given walk using algorithm [ algocanfac ] is surprisingly easy : numerical experiments suggest that the algorithm is efficient , i.e. it runs in a number of operations that scales polynomially with the length @xmath371 of the walk .",
    "in this article we established that any walk on a finite quiver @xmath0 factorizes uniquely into nesting products of prime walks , which are the simple paths and simple cycles on @xmath0 .",
    "we used this result to factorize ensembles of walks , as well as the sum of all walks between any two vertices of weighted and unweighted finite quivers , thereby obtaining continued fraction expressions for these quantities .",
    "as mentioned in the text , our results can be recast so as to hold for quivers with multiple directed edges .",
    "less evident , and more interesting , is the extension of the results presented here to other species of graphs , such as hypergraphs and continuous ( weighted ) graphs . in the latter case",
    ", we have already obtained preliminary results which can be used to calculate functions of continuous operators .",
    "we believe that research in this direction will find applications in solving fractional differential equations and might prove useful for quantum field theories , where the evolution of quantum systems can be described as the integral of all the walks on a continuous graph .",
    "the factorization of walks into primes described in this article is certainly not the only possible construction of this type on quivers .",
    "in particular , the important point in obtaining compact factorized expressions for the sum @xmath146 is the uniqueness of the factorization .",
    "thus , as long as one verifies that uniqueness holds , one is free to construct different factorizations based on different definitions for the canonical property and the nesting product . in this way",
    ", different factorized forms of the sum @xmath146 may be obtained , which may present advantages in certain applications as compared to the factorization presented here .",
    "for example , we have found a different set of definitions such that the factorized form for @xmath112 and @xmath146 are given as the solution of a system of self - consistency equations . in the context of language theory",
    "( see example [ exmauto ] ) , these equations appear as the language equations fulfilled by the different walk ensembles @xmath112 .",
    "these equations involve nesting ( i.e. two - sided concatenation ) , union and kleene stars ; and their solutions are systematically provided by theorem [ factorbasis ] .",
    "another possibility consists of choosing an entirely different product between walks , so as to induce different prime walks",
    ". this will affect the complexity of the factorization : e.g.  with the operation of concatenation , the induced prime walks are the quiver edges , and the factorization is trivial .",
    "it is an interesting open question to determine which factorization is the best compromise between computational complexity and structural richness of the factorized forms .",
    "p - l giscard is supported by scatcherd european and epsrc scholarships .",
    "s. j. thwaite acknowledges support from balliol college and a clarendon scholarship .",
    "@xmath69 _ compatibility with the scalars : _ let @xmath372 , @xmath373 and @xmath374 .",
    "we show that @xmath375 . if @xmath376 the property is trivially true . otherwise , according to definition [ def : nesting ] , @xmath377 , @xmath378 with @xmath379 . then @xmath380 .",
    "since concatenation is bilinear , @xmath381 and nesting is compatible with the scalars .",
    "@xmath69 _ right - distributivity : _ let @xmath382 and @xmath383 .",
    "we show that @xmath384 .",
    "walks @xmath5 and @xmath6 being cycles off the same vertex @xmath82 ( otherwise @xmath385 and the property is trivially true ) , it follows that @xmath386 and the property is true as soon as @xmath387 or @xmath388",
    ". otherwise , definition [ def : nesting ] implies that @xmath389 and @xmath390 such that @xmath391 and @xmath392 . since concatenation is bilinear we have @xmath393 and nesting is right distributive .",
    "@xmath69 _ failure of left - distributivity : _ let @xmath394 and @xmath395 .",
    "we show that @xmath396 .",
    "suppose that both @xmath5 and @xmath6 visit @xmath82 .",
    "then by definition [ def : nesting ] , @xmath377 and @xmath397 with @xmath398 .",
    "similarly , @xmath399 and @xmath400 with @xmath401 . now @xmath402 .",
    "the nesting product is therefore compatible with the scalars and right - distributive with respect to @xmath403 but not left - distributive .",
    "this is because it is a type of two - sided concatenation .",
    "in this appendix we prove theorem [ fundamentalthmquiver ] and proposition [ irreducible ] . we begin by showing that the factorization of a walk into nesting products of simple paths and simple cycles always exists and is unique in the sense of definition [ eqfacdef ] .",
    "we then demonstrate proposition [ irreducible ] , i.e. that the simple paths and simple cycles are the prime elements of @xmath8 , thereby establishing theorem [ fundamentalthmquiver ] as an equivalent to the fundamental theorem of arithmetic .",
    "let @xmath404 be the following proposition : _ @xmath405 such that @xmath406 , @xmath407 . _    we demonstrate that @xmath404 holds for all @xmath408 by induction on the walk length @xmath19 .",
    "@xmath69 firstly , we demonstrate that @xmath409 is true .",
    "consider @xmath81 such that @xmath410 .",
    "then @xmath7 is either a simple path or a simple cycle ( in this case , a loop ) and , by proposition [ irreducible ] , is irreducible .",
    "the factorized form of @xmath7 is @xmath7 itself and is clearly unique in the sense of definition [ eqfacdef ] , so @xmath409 holds .",
    "@xmath69 secondly , we show that @xmath411 holds @xmath412 holds .",
    "+ consider @xmath81 such that @xmath413 . if @xmath7 is irreducible , then its canonical factorization exists and is unique @xmath414 .",
    "if @xmath7 is not irreducible , then @xmath415 non - trivial such that @xmath416 .",
    "necessarily @xmath417 and , supposing @xmath418 holds , @xmath419 and @xmath420 .",
    "then @xmath421 is a valid canonical factorization of @xmath7 .",
    "now suppose that there exists a second canonical factorization @xmath114 of @xmath7 , with @xmath422 .",
    "since @xmath114 exists , @xmath423 a couple of non - trivial walks with @xmath424 , @xmath425 , and @xmath426 .    if @xmath427 and @xmath428 then by the induction hypothesis @xmath429 and @xmath430 .",
    "thus @xmath115 and @xmath431 holds .",
    "now consider the case @xmath432 .",
    "since @xmath433 , the position of the cycle @xmath326 in the vertex sequence of @xmath7 must fall into one of the following three cases :    * .",
    "let @xmath434 be the vertex sequence common to @xmath5 and @xmath75 , see schematic representation below .",
    "note that @xmath49 canonical @xmath435 canonical , and @xmath436 canonical @xmath437 canonical and @xmath438 and @xmath439 .",
    "it follows that @xmath440 and @xmath441 .",
    "now since @xmath442 and since @xmath443 holds @xmath444 , @xmath445 , @xmath446 , and @xmath420 . consequently @xmath447 holds .",
    "+   in the case @xmath448 . ]",
    "let @xmath449 . by construction , @xmath164 is a cycle , @xmath49 canonical @xmath450 canonical and @xmath436 canonical @xmath451 canonical .",
    "thus @xmath452 and @xmath453 and then @xmath454 and @xmath455 .",
    "now since @xmath456 and since @xmath443 holds @xmath444 , @xmath445 , @xmath446 , and @xmath457 . consequently @xmath447 holds .",
    "+ . ] * . given that @xmath458 and @xmath459 by assumption , @xmath326 and @xmath6 must be cycles off vertices @xmath460 and @xmath46 , respectively . since @xmath326 straddles over @xmath5 and @xmath6 , then @xmath460 is visited by both @xmath5 and @xmath6 , and @xmath46 is visited by both @xmath75 and @xmath326 .",
    "+   straddles over @xmath5 and @xmath6 . ]",
    "we first examine the situation @xmath461 , distinguishing two cases : 1 ) @xmath462 .",
    "then @xmath75 visits @xmath46 before @xmath460 , but @xmath46 is also visited by @xmath326 . thus the couple @xmath436 is non - canonical , which is a contradiction .",
    "2 ) @xmath463 , or @xmath46 appears only as an internal vertex of @xmath5 . in either situation , @xmath5 visits @xmath460 before the final appearance of @xmath46 , but @xmath460 is also visited by @xmath6 .",
    "then the couple @xmath49 is non - canonical , which is a contradiction .",
    "+ secondly , consider the case of @xmath464 .",
    "then the last appearance of @xmath46 in @xmath75 must be the last vertex of @xmath6 ( since @xmath465 nests @xmath6 into @xmath5 off the final appearance of @xmath46 ) .",
    "however , @xmath326 straddles @xmath5 and @xmath6 , which implies that i ) @xmath75 visits @xmath46 after the last vertex of @xmath326 , and ii ) @xmath326 is not nested into @xmath75 off the last appearance of @xmath46 .",
    "this is a contradiction .",
    "+ therefore , in any of the above cases , we found it to be impossible that @xmath433 with @xmath326 straddling @xmath5 and @xmath6 .",
    "we have demonstrated that @xmath409 is true , and upon supposing that @xmath443 holds for all @xmath466 , we have shown that @xmath431 holds .",
    "consequently @xmath404 holds @xmath467 .",
    "the canonical factorization of a walk thus always exists and is unique in the sense of definition [ eqfacdef ] .",
    "we now establish proposition [ irreducible ] in two steps .",
    "first we determine the irreducible walks and then the prime walks    [ irreducibleproof ] let @xmath468",
    ". then @xmath7 is irreducible if and only if @xmath469    clearly @xmath470 irreducible . now consider an irreducible walk @xmath7 , and suppose that @xmath471 .",
    "since @xmath7 is neither a simple path nor a simple cycle , there exists an earliest vertex @xmath82 visited at least twice by @xmath7 ( if @xmath7 is a cycle , then consider the earliest internal vertex visited at least twice by @xmath7 ) .",
    "now let @xmath472 be the vertex sequence joining the first appearance of @xmath82 to its final appearance in @xmath7 , and let @xmath473 be the vertex sequence obtained from @xmath7 by replacing @xmath474 by @xmath35 in @xmath7 . then @xmath475 is a canonical couple of non - trivial walks and @xmath476 , which is a contradiction .",
    "[ primeproof ] let @xmath468 .",
    "then @xmath7 is prime if and only if @xmath469    firstly , we demonstrate @xmath477 prime .",
    "consider @xmath44 such that @xmath478 . since @xmath469 then @xmath7 is an irreducible factor appearing in the canonical factorization @xmath479 . by uniqueness of this factorization",
    ", @xmath7 must either be an irreducible factor of @xmath480 , implying @xmath481 ; or an irreducible factor of @xmath482 , implying @xmath110 ; or both .",
    "it follows that @xmath7 is prime .",
    "secondly , we show that @xmath7 prime @xmath483 .",
    "suppose that @xmath484 prime with @xmath485 . then observe that since @xmath485 , @xmath7 is not irreducible , and there exists at least one canonical couple of non - trivial walks @xmath44 such that @xmath416 .",
    "clearly @xmath486 , and @xmath5 and @xmath6 are strictly shorter than @xmath7 .",
    "therefore @xmath7 does not divide @xmath5 , @xmath487 and similarly @xmath488 , which is a contradiction .",
    "propositions [ irreducibleproof ] and [ primeproof ] yield proposition [ irreducible ] .",
    "together with the proof of existence and uniqueness of the canonical factorization , this establishes theorem [ fundamentalthmquiver ] .",
    "we demonstrate the validity of the algorithm , first by verifying the correctness of the factorizations it performs and second by showing that for any finite - length walk , the algorithm stops and yields the canonical factorization .",
    "let @xmath122 be a non - canonical factorization of a walk @xmath81 of finite length @xmath371 and let @xmath123 .",
    "+ @xmath69 * if * @xmath489 and @xmath82 appears @xmath490 times as internal vertex of @xmath5 , then the algorithm splits the vertex string of @xmath5 at each internal appearance of @xmath82 , thus producing @xmath491 cycles @xmath492 off @xmath82 . clearly , by construction , @xmath493 . since nesting coincides with concatenation over the cycles , we have @xmath494 and @xmath495 as claimed in the algorithm .",
    "note that the @xmath492 cycles are strictly shorter that @xmath5 and , by construction , do not have @xmath82 as internal vertex .",
    "@xmath69 * else * , let @xmath496 be the vertex sequence of @xmath5 .",
    "consider the earliest vertex @xmath497 of @xmath5 visited at least twice by @xmath5 ( the earliest internal vertex , if @xmath5 is a cycle ) .",
    "let @xmath260 be the position of the earliest occurrence of @xmath497 in @xmath5 ( thus @xmath498 ) and let @xmath499 be the associated sequence , as per the algorithm .",
    "let @xmath61 be the walk obtained from @xmath5 by deleting @xmath499 from @xmath5 .",
    "then the couple @xmath500 is canonical , since all vertices @xmath501 are visited precisely once by @xmath7 and therefore can not be visited by @xmath499 .",
    "then , by construction of @xmath499 and @xmath61 , we have @xmath502 . by applying the same reasoning as above for the earliest vertex @xmath503 visited at least twice by @xmath61 ( the earliest internal vertex , if @xmath61 is a cycle )",
    ", we construct a canonical couple @xmath504 with @xmath505 and thus @xmath506 . proceeding similarly with @xmath60 and all the subsequent non - irreducible walks @xmath507",
    "thus yields @xmath508 where and @xmath509 is irreducible , as claimed in the algorithm .    in both cases @xmath5 is factorized into nesting products of strictly shorter walks .",
    "these are either irreducible , or they will in turn be factorized into nesting products of strictly shorter walks by the algorithm . thus ,",
    "if the initial length of the walk is @xmath371 , after at most @xmath510 recursive factorizations , all factors obtained are either irreducible or of length @xmath242 .",
    "since all walks of length 1 are irreducible , it follows that the algorithm factors finite - length walks into nesting products of irreducible walks ( i.e. it produces @xmath120 ) in a finite number of steps .",
    "@xmath69 theorem [ factorbasis ] .",
    "let @xmath511 , and consider @xmath512 . for convenience ,",
    "we define @xmath513 where @xmath514 is the ensembles of cycles off @xmath515 on @xmath516 that do not have @xmath515 as internal vertex .",
    "we demonstrate that @xmath517 by showing that @xmath518 and @xmath519 . in a second time , we show that @xmath520 identifies to the ensemble @xmath139 defined in the theorem .    by eq .",
    "( [ eq : factorw ] ) , @xmath7 can be expressed as a simple path @xmath521 with cycles @xmath522 nested into it , that is @xmath523 . by construction ,",
    "the @xmath524 are non - trivial cycles nested off different vertices of the simple path @xmath525 .",
    "for all the vertices @xmath526 of @xmath525 , we define @xmath527 if no @xmath524 is nested off @xmath526 and @xmath528 if @xmath529 .",
    "then let @xmath530 and note that @xmath531 . by the canonical property , @xmath532 can not visit any of the @xmath533 vertices and must therefore belong to @xmath534 . by eq .",
    "( [ cyclesplit ] ) , any cycle of @xmath534 can be decomposed into nesting products of shorter cycles @xmath535 off @xmath515 that do not have @xmath515 as internal vertex . therefore @xmath536 and consequently @xmath537",
    "furthermore , any element of @xmath538 is a walk on @xmath0 from @xmath539 to @xmath540 and @xmath541 .",
    "it remains to show that @xmath520 is the ensemble @xmath139 of the theorem .",
    "let @xmath542 .",
    "applying the same reasoning as above , @xmath75 factorizes as in eq .",
    "( [ factoridemo ] ) but with @xmath543 .",
    "then @xmath75 is an element of the ensemble : @xmath544 furthermore any element of the above ensemble is a cycle off @xmath545 that does not have @xmath545 as internal vertex .",
    "therefore @xmath520 identifies with the ensemble of eq .",
    "( [ ensemright ] ) . clearly if @xmath545 has no neighbour on @xmath0 , @xmath546 if the loop @xmath547 exists and @xmath548 otherwise .",
    "it follows that @xmath549 since both fulfill the same recursive relation and value on vertices with no neighbour .",
    "this establishes eq .",
    "( [ ag ] ) and , together with @xmath550 , eq .",
    ".    we may obtain theorem [ factorbasis ] as a direct implementation of algorithm [ algocanfac ] to ensembles of walks . since the canonical factorization of @xmath7 is obtained via the recursive use of eqs .",
    "( [ cyclesplit ] ) and ( [ eq : factorw ] ) and since this factorization is unique , the ensemble of walks @xmath551 is uniquely factorized through the recursive use of eqs .",
    "( [ wg ] ) and ( [ ag ] ) .",
    "we omit the details of this alternative approach",
    ".    @xmath69 corollary [ factorsum ] .",
    "the corollary follows from theorem [ factorbasis ] .",
    "let @xmath112 be the ensemble of walks from @xmath29 to @xmath30 .",
    "we first decompose @xmath112 using eq .",
    "( [ wg ] ) , identifying @xmath29 with @xmath539 and @xmath30 with @xmath540 for convenience , then sum over the elements of the ensembles on both sides of the equality .",
    "this yields , in vertex - edge notation , @xmath552 which we obtain upon nesting the ensembles @xmath553 into the simple paths of @xmath31 at the appropriate positions . equation ( [ sumstep0 ] ) shows that the sums over these ensembles can be seen as effective vertices produced by dressing each vertex of the simple paths by all the cycles that visit these vertices on progressively smaller quivers @xmath554 .",
    "for example , we can defined a dressed vertex @xmath555 representing the sum of all the cycles off @xmath29 on @xmath0 as @xmath556 it follows that eq .",
    "( [ sumstep0 ] ) yields eq .  , with dressed vertices representing the sum over the kleene stars .",
    "these sums have trivial walks for constant term , e.g. @xmath557 in eq .",
    "( [ dress ] ) , these being different from 0 the sums formally evaluate to inverses , e.g. @xmath558^{-1}$ ] . by combining this result with eq .",
    "( [ ag ] ) , the dressed vertices are seen to be of the form @xmath559^{-1},\\label{sumoverkleenestars}\\end{aligned}\\ ] ] where @xmath154 is the length of the simple cycle @xmath560 and @xmath557 is the local identity common to all walks of @xmath561 , in particular @xmath562 , we have @xmath563 . in this expression ,",
    "the dressed vertices again represent sums over the kleene stars that appear when @xmath564 is decomposed using eq .",
    "( [ ag ] ) .",
    "this establishes eq .",
    "( [ eqn : dressedvertexclosedform2b ] ) .    @xmath69 corollary [ factorsumofweights ] .",
    "this corollary follows from corollary [ factorsum ] together with the properties of the weight function defined in eq .  .",
    "we begin by establishing an exact recursive relation yielding the star - height of factorized forms .",
    "this relation will be necessary to prove theorem [ starheighgraph ] .",
    "[ starheight ] let @xmath565 .",
    "then , the star - height @xmath566 of the factorized expression for the ensemble of cycles @xmath567 is given by the recursive relation @xmath568 where @xmath569 .",
    "the star - height @xmath570 of the factorized expression for the ensemble of open walks @xmath551 is @xmath571 where @xmath572 .",
    "these results follow from eqs .",
    "( [ wg ] , [ ag ] ) .",
    "we have @xmath573 and thus if @xmath574 is trivial , then @xmath575 . otherwise , @xmath576 .",
    "now by eq .",
    "( [ ag ] ) we have @xmath577 and since @xmath578 , eq .",
    "( [ hcycles ] ) follows . by similar reasoning ,",
    "( [ hopen ] ) is obtained from eq .",
    "( [ wg ] ) ; we omit the details .",
    "the cycle rank @xmath579 of a graph @xmath0 @xcite quantifies the minimum number of vertices that must be removed from @xmath0 in order for its largest strongly connected component to be acyclic .",
    "contrary to what one might expect , the star - heights @xmath580 and @xmath581 are not equal to the cycle rank @xmath579 .",
    "this is because of an essential difference between proposition [ starheight ] and the definition of @xmath579 : when calculating the star - height of a canonical factorization , the removal of vertices takes place along simple paths and simple cycles of @xmath0 .",
    "conversely , the definition of @xmath579 allows for the removal of non - neighbouring vertices throughout the graph . by this argument",
    "we see that the cycle rank is only a lower bound on the star - height of factorized forms of walk ensembles : @xmath582 and @xmath583 .",
    "we begin by proving the result for @xmath370 .",
    "let @xmath584 .",
    "consider the cycle @xmath585 off @xmath29 produced by traversing @xmath586 from start to finish , then traversing the loop @xmath587 if it exists , then returning to @xmath29 along @xmath586 .",
    "the proof consists of showing that @xmath585 comprises the longest possible chain of recursively nested simple cycles on @xmath0 .    to this end , consider the factorization of @xmath585 .",
    "let @xmath588 be equal to @xmath587 , if this loop exists , or @xmath589 , otherwise . then observe that @xmath590 where @xmath591 is the back - track @xmath592 , where we have identified @xmath29 with @xmath539 for convenience .",
    "equation ( [ wafactor ] ) shows that @xmath585 is a chain of @xmath368 ( or @xmath593 , if the loop @xmath587 exists ) recursively nested non - trivial simple cycles , and @xmath594 must involve at least this many nested kleene stars .    to see that this chain is the longest",
    ", suppose that there exists a walk @xmath93 involving @xmath595 ( or @xmath596 , if the loop @xmath587 exists ) non - trivial recursively nested simple cycles @xmath597 ; that is , @xmath598 .",
    "then , by the canonical property , the vertex sequence @xmath599 joining the first vertex of @xmath600 to the last internal vertex of @xmath601 defines a simple path @xmath602 of length @xmath603 .",
    "this is in contradiction to the definition of @xmath368 , and thus @xmath93 does not exist .",
    "consequently , @xmath604 if the loop @xmath587 exists , or @xmath368 , if there is no self - loop on @xmath605 .",
    "we now turn to determining @xmath365 . combining eq .",
    "( [ hopen ] ) with the result for @xmath370 obtained above yields @xmath606 where @xmath607 is the length of the longest simple path @xmath608 off vertex @xmath609 on @xmath610 , and @xmath611 is the last vertex of @xmath608 .",
    "finally , we note that @xmath586 is the longest of all the simple paths @xmath608 : since @xmath0 is bidirectional and connected , it is strongly connected , and since @xmath610 is a subgraph of @xmath0 strictly smaller than @xmath0 , then @xmath608 must be shorter than @xmath612 . therefore eq .  ( [ eq : hstepdemo ] ) yields @xmath613 .",
    "it follows from these results that in order to determine the star - height of the factorized form of any walk ensemble on a bidirectional quiver @xmath0 , one must determine the existence of an hamiltonian path on @xmath0 .",
    "consequently , the problem of determining @xmath614 and @xmath615 is np - complete ."
  ],
  "abstract_text": [
    "<S> we show that characteristic series of walks ( paths ) on _ any _ finite quiver @xmath0 are given by continued fractions of finite depth over the simple paths and simple cycles of @xmath0 . </S>",
    "<S> we obtain an explicit formula giving these continued fractions . </S>",
    "<S> this result is based on an equivalent to the fundamental theorem of arithmetic : we demonstrate that arbitrary walks on @xmath0 _ uniquely _ factorize into nesting products of simple paths and simple cycles , which we show are the prime elements of a near @xmath1-algebra associated to the quiver . the nesting product between walks consists of inserting one walk into another . </S>",
    "<S> we obtain the ensemble of all walks on @xmath0 in terms of nested ensembles of simple paths and simple cycles . </S>",
    "<S> we then factorize the sum of all the walks between any two vertices of @xmath0 thereby obtaining a continued fraction . finally , we give an equivalent relation that holds for weighted quivers . </S>",
    "<S> this relation remains valid with non - commuting edge weights . </S>",
    "<S> this last result has already found applications in the field of matrix computations @xcite . </S>",
    "<S> we give further examples of applications of our results . </S>"
  ]
}