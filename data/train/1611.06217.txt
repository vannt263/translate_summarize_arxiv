{
  "article_text": [
    "the propensity score , which is defined as the conditional probability of receiving treatment given covariates , is one of the most widely used tools in causal inference .",
    "part of its popularity can be credited to the seminal result of @xcite : if the treatment assignment is independent of the potential outcomes conditional on a vector of covariates , then one can obtain unbiased and consistent estimators of different treatment effect measures by adjusting for the propensity score alone , greatly reducing the dimensionality of the underlying problem . several methods that exploits this important insight are now an essential part of the applied researcher s toolkit . examples",
    "includes matching , see e.g. @xcite , heckman1997 , and @xcite ; inverse probability weighting ( ipw ) , see e.g. @xcite , @xcite and donald2013 ; regression methods , see e.g. @xcite , @xcite ; and many others . for a review , see @xcite and @xcite .    despite their popularity ,",
    "a main concern of these methods is that the propensity score is usually unknown , and therefore has to be estimated . given the high dimensionality of available covariates , researchers are usually coerced to adopt a parametric model for the propensity score since nonparametric estimation methods suffer from the `` curse of dimensionality '' , implying that the resulting treatment effects estimator can have considerably poor properties , even for large sample sizes .",
    "such a common practice raises the important issue of model misspecification . indeed , as shown by @xcite , @xcite , @xcite and @xcite",
    ", propensity score misspecifications can lead to misleading treatment effects estimates .    in this paper",
    "we propose new specification tests for parametric propensity score models .",
    "in contrast to existing proposals , our tests are fully data - driven , do not require user - chosen tuning parameters such as bandwidths , and are able to detect a broad class of local alternatives converging to the null at the parametric rate @xmath0 , with @xmath1 the sample size .",
    "furthermore , by exploiting the balancing property of the propensity score - i.e. that conditioning on the true ( unknown ) propensity score , the treatment assignment is independent of the covariates ( @xcite ) our tests do not suffer from the curse of dimensionality  when the vector of covariates is of high - dimensionality , and have dramatically greater power than competing tests for many alternatives .",
    "of course , such power gains do not come without a cost : there exist some classes of alternative hypotheses in which our tests have trivial power . nonetheless , we believe that such a compromise is reasonable since , as pointed out by @xcite and escanciano2009a , achieving reasonable power over all possible directions seems hopeless .",
    "the proposal closest to ours is @xcite , who also exploits the balancing property of the propensity score . despite using a similar characterization of @xmath2 as @xcite ,",
    "our proposal greatly differ from theirs . whereas @xcite adopts the local smoothing approach ,",
    "see e.g. @xcite , @xcite , @xcite and @xcite , we adopt the integrated conditional moment ( icm ) approach , see e.g. @xcite , @xcite , stute1997 , and @xcite . as a consequence",
    ", our approach inherits some advantages when compared to @xcite .",
    "first , our tests do not require delicate bandwidth choices , unlike @xcite test whose performance can be very sensitive to it .",
    "second , in contrast with @xcite , our approach has power against local alternatives converging to null at the parametric rate .",
    "another popular procedure to assess misspecification of the propensity score model is to use balancing score  tests .",
    "initially proposed by @xcite , these tests consist of assessing if each covariate is independent of the treatment assignment , conditional on the propensity score .",
    "this is often implemented examining whether moments ( usually just the mean ) of the observable characteristics between the two matched  or weighted  groups are the same ; see e.g. @xcite and @xcite .",
    "one should bare in mind that because `` balancing score '' tests are usually based on a finite number of orthogonality conditions , there are uncountably many misspecification that can not be detected with these tests .",
    "furthermore , as shown by @xcite , balancing score tests tend to have severe size distortions due to the multiple testing problem , and the failure to account for the estimation effect of the propensity score .",
    "such drawbacks put at stake the reliability of many of these procedures . our proposal ,",
    "on the other hand , does not suffer from these .",
    "our paper also contribute to the literature on icm tests .",
    "what appears distinctive to our approach is that @xmath3 we exploit the dimension - reduction coming from balancing property of the propensity score , and @xmath4 we acknowledge our lack of knowledge of the true  correct specification of the propensity score , by means of an orthogonal projection of certain weight - functions into the tangent space of nuisance parameters .",
    "the result of @xmath3 and @xmath5 is a test with improved power properties .",
    "the power improvement due to the dimension reduction has been noticed by @xcite , escanciano2006b and @xcite , whereas the power improvement due to the use of orthogonal projections has been noticed in different contexts , see e.g. @xcite , and more recently , @xcite and escanciano2014a . to the best of our knowledge ,",
    "our proposal is the first to incorporate both procedures .",
    "the rest of the paper is organized as follows . in section [ framework ]",
    "we present the testing framework . the asymptotic properties of our tests are established in section [ asythe ] .",
    "we next examine the finite sample properties of our tests by means of a monte carlo study in section [ mc ] .",
    "we provide an empirical illustration of our procedures in section application .",
    "section [ conclusion ] concludes .",
    "mathematical proofs are gathered in an appendix at the end of the article .",
    "finally , all proposed tests discussed in this article can be implemented via open - source r package _ pstest , _ which is freely available from github ( https://github.com/pedrohcgs/pstest ) .",
    "let @xmath6 be a binary random variable that indicates participation in the program , i.e. @xmath7 if the individual participates in the treatment and @xmath8 otherwise , and let @xmath9 * *  * * be an observable @xmath10 vector of pre - treatment covariates",
    ".  denote the support of @xmath9 by @xmath11 define the propensity score @xmath12 .",
    "we have a random sample @xmath13 from @xmath14 . throughout the rest of this paper ,",
    "all random variables are defined on a common probability space @xmath15    in this paper , we are interested in testing whether a parametric putative model for @xmath16 is correctly specified . formally , we want to test @xmath17 = 0~a.s . ,   \\label{h0classical}\\ ] ] where @xmath18 , and @xmath19 @xmath20 $ ] is a family of parametric functions known up to the finite dimensional parameter @xmath21 .",
    "common specifications for @xmath22 are the probit , @xmath23 and the logit , @xmath24 , where @xmath25 and @xmath26 are the normal and logistic link - function , respectively .    in order to assess the validity of ( [ h0classical ] )",
    ", one can use standard nonparametric goodness - of - fit tests for regression models ; see gonzalez - manteiga2013 for a review .",
    "for instance , one can adopt the local smoothing approach and use @xcite test .",
    "alternatively , one can adopt the icm approach and use @xcite test .",
    "although both procedures would provide asymptotic valid tests under weak regularity conditions , their finite sample performance are likely to be poor when the dimensionality of @xmath9 is large , as is often the case in policy evaluation applications .",
    "this problem is often referred as the curse of dimensionality .",
    "to circumvent such a problem , we build on @xcite and shaikh2009 , and exploit the  balancing property of the propensity score , i.e. , that conditional on the propensity score @xmath16 , the treatment assignment @xmath6 is independent of the covariates @xmath9 , @xmath27 see @xcite .",
    "such important result implies that ( h0classical )  can be rewritten as @xmath28 = 0~a.s .",
    "\\label{h0}\\ ] ]    it is important to observe that the characterization of the null hypothesis in ( [ h0 ] ) only involves a one - dimensional conditional expectation , which is in sharp contrast to ( [ h0classical ] ) . as a consequence , tests based on this characterization do not suffer from the curse of dimensionality ,  and therefore enjoy better size and power properties against many alternatives .",
    "however , one must also bear in mind the conditioning variable  in ( h0 ) is not observed , implying that tests based on this characterization must handle the generated regressorproblem .    @xcite adapts the test proposed by @xcite to assess ( [ h0 ] ) . more precisely , @xcite consider a tests statistic based on@xmath29where @xmath30 , @xmath31 is a @xmath32 consistent estimator of @xmath33 under @xmath2 , @xmath34 is a bandwidth , @xmath35 is a kernel .",
    "note that , in addition to the estimation of @xmath33 under the @xmath2 , @xcite procedure requires smoothing of the data , implying that its finite - sample properties relies on the adequate choice of the smoothing parameter @xmath36 , a task that is far from trivial in testing problems .    to provide a smoothing parameter freetesting procedure for ( [ h0 ] )",
    ", we adopt the icm instead of the local smoothing approach .",
    "we exploit that the conditional moment restriction in ( [ h0 ] ) can be expressed as a continuum number of unconditional moment restrictions , i.e. , we can re - write ( [ h0 ] ) as @xmath37 = 0,\\quad\\forall u\\in \\pi ,   \\label{equiv}\\]]where @xmath38 is a properly chosen space and the parametric family @xmath39 is such that the equivalence between ( [ h0 ] ) and ( [ equiv ] ) holds ; see e.g. @xcite and @xcite for primitive conditions on the family @xmath40 to satisfy this equivalence .",
    "the two most popular weighting functions are the exponential function , @xmath41 , as in @xcite , where @xmath42 denotes the imaginary number ; and the indicator function , @xmath43 , as in @xcite , stute1998b , @xcite , @xcite , among many others .",
    "other possible weight functions include @xmath44 , @xmath45 , @xmath46 , and @xmath47 , see @xcite and @xcite .",
    "our tests have two main differences with respect to the standard icm tests .",
    "first , the weight functions @xmath48 depends on @xmath9 only through the propensity score model under @xmath2 , a one - dimensional ( unknown ) function . as a consequence , the icm in ( [ equiv ] )",
    "is insensitive to the dimension of the explanatory variables @xmath9 .",
    "second , we explicitly acknowledge that @xmath49 is a nuisance parameter in testing for ( [ equiv ] ) by proposing to use weight functions @xmath48 that leads to test statistics whose limiting distributions do not depend on the estimator used . to achieve such desirable feature",
    ", we make use of orthogonal projections on the tangent space of nuisance parameters .",
    "the result of these two features is a test with higher power properties , as is shown in section [ mc ] .    in the next subsection",
    "we describe how we construct our new projection - based tests , highlighting the role played by the orthogonal projection .",
    "it is worth stressing that our projection - based tests cover a large class of weighting functions @xmath50",
    ".      denote @xmath51 $ ] the unit interval . given a random sample @xmath52 , it seems natural to construct test statistics for ( [ equiv ] ) based on the sample analogue@xmath53 where @xmath31 is a @xmath54-consistent estimator for @xmath55 under @xmath2 .",
    "for instance , when the propensity score is assumed to be a member of the logistic ( or gaussian ) family , one can estimate @xmath56 by maximum likelihood ( ml ) , non - linear least squares ( nlls ) , or generalized method of moments ( gmm ) .",
    "tests for ( [ equiv ] ) can be constructed by comparing how close  in an appropriate sense ( [ r1 ] ) is to zero . in the appendix",
    ", we show that under @xmath2 and some weak regularity conditions provided below , the process @xmath57 can be decomposed as@xmath58 + o_{p}\\left ( 1\\right )   \\label{linrepr}\\end{gathered}\\]]uniformly in @xmath59 , where @xmath60 .",
    "the representation in ( [ linrepr ] ) has a very important implication : whenever standard weights @xmath48 such as the indicator and exponential functions are used , the asymptotic distributions of tests based on ( [ r1 ] ) are sensitive to the estimator @xmath31 used . as a consequence , for a given parametric specification @xmath61 , the asymptotic null distributions of tests based on ( linrepr ) will depend on whether one estimates @xmath33 using ml , nlls or gmm , even though the underlying specification for the propensity score is the same across these methods .    to avoid the aforementioned drawback , we consider a convenient class of @xmath62 such that @xmath63 \\equiv 0 .",
    "\\label{mort}\\]]in particular , we consider a projection - based transformation of @xmath64 , @xmath65 , where @xmath66with@xmath67,\\]]and @xmath68.\\ ] ]    the intuition behind ( [ projection ] ) is very simple .",
    "first , note that @xmath69 is the vector of linear projection coefficients of regressing @xmath70 on @xmath71 .",
    "thus , it follows that @xmath72 is the best linear predictor of @xmath73 given @xmath71 , and that ( [ projection ] ) is nothing more than the associated projection error .",
    "it then follows that @xmath74 & = \\mathbb{e}\\left [ g(x,\\theta ) \\left(w\\left ( q\\left ( x,\\theta \\right ) , u\\right ) -g^{\\prime } ( x,\\theta ) \\delta^{-1 } \\left ( \\theta \\right ) g_{w}\\left ( u,\\theta \\right ) \\right)\\right ] \\\\ & = g_{w}(u,\\theta ) -\\delta \\left ( \\theta \\right ) \\delta^{-1 } \\left ( \\theta \\right ) g_{w}\\left ( u,\\theta \\right ) \\\\ & = 0.\\end{aligned}\\ ] ]    based on the aforementioned properties , our tests are based on proper continuous functionals of the ( feasible ) projection - based empirical process @xmath75 , given by @xmath76where @xmath31 is a @xmath54-consistent estimator for @xmath49 under @xmath2 , and @xmath77 is the sample analogue of projection in ( [ projection]),@xmath78with@xmath79and @xmath80two examples that we use in the simulations and the empirical example towards the end of this paper are the following cramr - von mises - type and kolmogorov - smirnov - type functionals , @xmath81 ^{2 } ,   \\label{cvm } \\\\",
    "ks_{n } & = \\sup_{u\\in \\pi } \\left\\vert \\hat{r}_{1,n}^{p}(u)\\right\\vert , \\label{ks}\\end{aligned}\\]]respectively , where @xmath82 is the empirical distribution function ( edf ) of @xmath83 , @xmath84 , and where @xmath85 is defined as in ( [ emp - process ] ) with @xmath86 .",
    "the test statistics @xmath87 and @xmath88 should be small if the null hypothesis ( [ h0 ] ) is true , while large  values of @xmath87 or @xmath88 imply the rejection of @xmath2 . obviously , different test statistics could be developed by applying other distances , or choosing alternative weighting functions .",
    "for ease of exposition , we concentrate on @xmath87 and @xmath88 .",
    "in this section , we establish the asymptotic distribution of the projection - based empirical process @xmath75 under the null hypothesis @xmath2 , under the fixed alternative hypothesis @xmath89 , which is the negation of ( [ equiv ] ) , and under a sequence of local alternatives that converges to @xmath2 at the parametric rate @xmath0 , @xmath1 being the sample size .",
    "in addition , we show that critical values can be computed with the assistance of a multiplier - type bootstrap that is easy to implement .",
    "the asymptotic distributions of our tests are the limiting distributions of continuous functionals of @xmath90 under @xmath2 . to derive the asymptotic results , we adopt the following notation . for a generic set @xmath91 ,",
    "let @xmath92 be the banach space of all uniformly bounded real functions on @xmath91 equipped with the uniform metric @xmath93 .",
    "we study the weak convergence of @xmath90 and related processes as elements of @xmath94 , where @xmath95 $ ] .",
    "let @xmath96 denote weak convergence on @xmath97 in the sense of j. hoffmann - j@xmath98rgensen , where @xmath99 denotes the corresponding borel @xmath100-algebra - see e.g. definition 1.3.3 in vandervaart1996 .",
    "we assume the following regularity conditions .",
    "[ ass1]@xmath3 the parameter space @xmath101 is a compact subset of @xmath102 @xmath103 the true parameter @xmath33 belongs to the interior of @xmath104 ; and @xmath105 @xmath106    [ ass2]@xmath3 @xmath107 is twice continuously differentiable at each @xmath21 in a neighborhood of @xmath56 .",
    "denote @xmath108    @xmath103 for all @xmath109 , there exists an integrable function @xmath110 such that @xmath111 ; and @xmath112 the matrix @xmath113 $ ] is non - singular at each @xmath114 in a neighborhood of @xmath33 .",
    "[ ass3 ] the parametric family of weight functions @xmath115 is such that the equivalence between ( [ h0 ] ) and ( [ equiv ] ) holds .",
    "furthermore , @xmath116 is a donsker class of functions .",
    "assumption [ ass1 ] is a standard one . under some standard moment conditions , it is satisfied for ml , nlls and gmm estimators , for example .",
    "assumption [ ass2 ] is a condition concerning the degree of smoothness of the propensity score @xmath117 , and is satisfied for standard parametric models such as the probit and the logit specifications .",
    "assumption [ ass3 ] imposes some additional regularity conditions on the family of weights @xmath48 and allows for the use of the most popular weight functions , including in particular the indicator and the exponential weights , @xmath118 , and @xmath119 , respectively .",
    "next , we derive the asymptotic distribution of the projection - based empirical process @xmath120 under @xmath2 .",
    "we do this in two steps .",
    "first , we show that , under @xmath2 , @xmath121 is asymptotically equivalent , with respect to the supremum norm on @xmath122 , to the process @xmath123 where @xmath124 is as defined in ( [ projection ] ) . from this result",
    "it follows that the weak convergence under @xmath2 of the process @xmath75 can be conveniently established from that of @xmath125 given in ( [ rn0 ] ) .",
    "more importantly , the limiting behavior of @xmath126 does not depend on @xmath31 .",
    "[ thh0]let assumptions [ ass1]-[ass3 ] hold .",
    "then , under @xmath2 , we have that @xmath127 and @xmath128 where @xmath129 denotes a gaussian process with mean zero and covariance structure given by@xmath130    theorem [ thh0 ] and the continuous mapping theorem(cmt ) , see e.g. theorem 1.3.6 in @xcite , yield the asymptotic null distributions of continuous functionals of @xmath131 including the test statistics @xmath87 and @xmath88 given in ( [ cvm ] ) and ( [ ks ] ) , respectively .",
    "[ corho]under the assumptions of theorem [ thh0 ] and @xmath2 , for any continuous functional @xmath132 , we have @xmath133furthermore , @xmath134 where @xmath135 denotes the distribution function of @xmath136 , and @xmath137    note that the integrating measure in @xmath87 is a random measure , but corollary [ corho ] shows that the asymptotic theory is not affected by this fact .",
    "further details can be found in the appendix .",
    "now , we investigate the power properties of tests based on continuous functionals @xmath138 , like @xmath87 and @xmath88 in ( cvm ) and ( [ ks ] ) , respectively .",
    "we consider both fixed and local alternatives that converge to @xmath2 at the parametric rate @xmath0 .",
    "next theorem analyses the asymptotic properties of our tests under the fixed alternative@xmath139 = 0\\right ) < 1\\text { } , \\quad \\forall\\theta \\in\\theta .",
    "\\label{h1}\\ ] ] note that @xmath89 is simply the negation of @xmath2 ( [ h0 ] ) .    [ thh1 ]",
    "suppose assumptions [ ass1]-[ass3 ] hold .",
    "then , under the fixed alternative hypothesis @xmath89 in ( [ h1 ] ) , we have that @xmath140 \\right\\vert = o_{p}\\left ( 1\\right).\\ ] ]    theorem 2 implies that the test statistic @xmath141 will diverge to infinity under the alternative hypothesis @xmath89 , because , under @xmath142 @xmath143 \\neq 0 $ ] for a set with positive lebesgue measure . nonetheless , it is important to observe that , since ours tests are based on ( [ h0 ] ) , there are certain alternative hypotheses other than ( [ h1 ] ) in which our tests will have trivial power .",
    "these type of alternatives only arises when @xmath144 \\not=0 $ ] for some @xmath145 yet @xmath146 = 0~a.s.$ ] . as pointed out by @xcite , the only case this happens",
    "is when the conditional expectation of @xmath6 given a subset of available covariates is correctly specified , but the omitted regressors have non - zero effect on the true propensity score , e.g. when @xmath147 , and @xmath148 = q(x,\\theta _ { 0})\\not = p\\left ( x\\right ) = e\\left [ d|x_{1},x_{2}\\right ] $ ] .",
    "as one can see , such class of alternative hypotheses is rather exceptional .",
    "furthermore , such cases can be circumvented by including all available covariates into the specification of @xmath149 .",
    "next , we study the performance of our projection - based tests under certain types of local alternatives . in particular",
    ", we derive the asymptotic distribution of @xmath150 under a sequence of alternative hypotheses converging to the null at the parametric rate @xmath0 given by @xmath151 = \\frac{r\\left ( q(x,\\theta _ { 0})\\right ) } { \\sqrt{n}}\\quad a.s .",
    "\\label{h1n}\\]]for some @xmath152 .",
    "the function @xmath153 \\rightarrow \\mathbb{r}$ ] is required to satisfy the following assumption .",
    "[ ass4 ] the function @xmath154 is continuous in @xmath155 @xmath156 and satisfies @xmath157 .",
    "[ thh1n ] suppose assumptions [ ass1 ] -[ass4 ] hold .",
    "then , under the local alternatives @xmath158 given by ( [ h1n ] ) , we have @xmath159 where @xmath129 is the same gaussian process as defined in theorem [ thh0 ] , and @xmath160 is a deterministic shift function given by @xmath161.\\ ] ]    note that , in general , the deterministic shift function @xmath162 for some @xmath59 , implying that tests based on continuous even functionals of @xmath121 will have non - trivial power against local alternatives of the form in ( [ h1n ] ) . a situation in which our tests will have trivial power against such alternatives",
    "is when directions @xmath163 are a linear combination of @xmath164 , that is , when @xmath165 for some @xmath166 .      from the above theorems",
    ", we see that the asymptotic distribution of continuous functionals @xmath167 depend on the underlying data generating process , on the class of weight functions @xmath62 used , and of course on @xmath168 itself .",
    "furthermore , the complicated structure of @xmath169 given in ( kw ) does not allow for a simple representation of @xmath170 in terms of well - known distribution - free process for which critical values are readily available . to overcome this problem , we propose to compute critical values with the assistance of a multiplier bootstrap .",
    "the proposed procedure has good theoretical and empirical properties , is straightforward to verify its asymptotic validity , computationally easy to implement , and does not require computing new parameter estimates at each bootstrap replication .",
    "more precisely , in order to estimate the critical values , we propose to approximate the asymptotic null distribution of @xmath75 by that of @xmath171where @xmath172 is a sequence of @xmath173 random variables with zero mean , unit variance and bounded support , independent of the original sample @xmath174 .",
    "a popular example involves @xmath173 bernoulli variates @xmath175 with @xmath176 and @xmath177 , where @xmath178 as suggested by @xcite .",
    "with @xmath179 at hands , the bootstrapped version of our test statistics @xmath180 is simply given by @xmath181 .",
    "for instance , the bootstrapped versions of @xmath87 and @xmath88 in ( [ cvm ] ) and ( [ ks ] ) , respectively , are given by@xmath182 ^{2 } , \\\\",
    "ks_{n}^{\\ast } & = \\sup_{u\\in\\pi}\\left\\vert \\hat{r}_{1,n}^{p\\ast } ( u)\\right\\vert .\\end{aligned}\\ ] ] the asymptotic critical values are then estimated by@xmath183 where @xmath184 means bootstrap probability , i.e. conditional on the original sample @xmath185 . in practice ,",
    "@xmath186 is approximated as accurately as desired by @xmath187 , the @xmath188 order statistic from @xmath189 replicates @xmath190 of @xmath181 .",
    "the next theorem establishes the asymptotic validity of the multiplier bootstrap procedure proposed above .    [ bootstrap ]",
    "assume assumptions [ ass1]-[ass3 ]",
    ". then @xmath191 where @xmath129 is the gaussian process defined in theorem 1 , and @xmath192 denotes the weak convergence under the bootstrap law , i.e. conditional on the original sample @xmath185 .",
    "additionally , for any continuous functional @xmath193 , we have @xmath194 a.s . under the bootstrap law .",
    "in this section , we conduct a series of monte carlo experiments in order to study the finite sample properties of our proposed projection - based tests . in particular , the performance of our cramr - von mises and kolmogorov - smirnov tests @xmath87 and @xmath88 given in ( [ cvm ] ) and ( [ ks ] ) is compared to the @xcite test,@xmath195 where @xmath196 is given in ( [ shaikh ] ) , and @xmath197critical values for @xmath87 and @xmath88 are obtained using the multiplier - bootstrap procedure described in section [ boots ] .",
    "fort @xmath198 we use the critical values from the standard normal distribution .    as in @xcite",
    ", we consider samples sizes @xmath1 equal to @xmath199 , @xmath200 , @xmath201 , @xmath202 , @xmath203 and @xmath204 . for each design ,",
    "we consider @xmath205 monte carlo experiments .",
    "the @xmath206 used in the bootstrap implementations are independently generated as @xmath207 with @xmath176 and @xmath177 , where @xmath208 , as proposed by @xcite .",
    "the bootstrap critical values are approximated using @xmath204 replications . to compute @xcite test",
    ", we use the normal kernel@xmath209the bandwidth @xmath34 is chosen to be equal to @xmath210 for @xmath211 equal to 0.01 , 0.05 , 0.10 , 0.15 and 0.50 . note",
    "that our selection of @xmath211 goes beyond those considered by @xcite simulations ( @xmath212 @xmath213 and @xmath214 .",
    "we do this to assess how sensitive @xcite test may be with respect to the bandwidth @xmath36 .",
    "we first consider the following data - generating processes ( dgp):@xmath215for each of these dgp , @xmath216 , where @xmath217 , @xmath218 , and @xmath219 and @xmath220 are independent standard normal random variables .",
    "all the dgps considered are taken from @xcite .    for dgp1-dgp5 , the @xmath2 considered is @xmath221 = \\phi \\left ( \\beta _ { 0}+\\beta _ { 1}x_{1}+\\beta _ { 2}x_{2}\\right ) ~a.s.,\\]]where @xmath222 is the cumulative distribution function ( cdf ) of the standard normal distribution .",
    "we estimate @xmath33 using the probit ml , i.e. @xmath223dgp1 falls under @xmath2 , whereas dgp2-dgp5 fall under @xmath89 .",
    "the simulation results are presented in table [ tab : sim1 ] .",
    "we report empirical rejections at the @xmath224 significance level .",
    "results for 10% and 1% significance levels are similar and available upon request .",
    "we first analyze the size of our test . from the result of dgp1",
    ", we find that the actual finite sample size of both @xmath88 and @xmath87 tests is very close to their nominal size , even when the sample size is as small as 100 . on the other hand , we find that @xcite s test are , in general , conservative , and sensitive to the choice of bandwidth .",
    "for instance , when @xmath225 , the empirical size is very close to zero even with @xmath226 . on the other hand , with @xmath227 ,",
    "the empirical size of @xcite test is closer to the nominal value .",
    "width=0.9    .proportion of rejections at 5% level .",
    "[ cols=\"<,<,>,>,>,>,>,>,>\",options=\"header \" , ]      +",
    "in this article , we have proposed new nonparametric projection - based tests for the correct specification of the propensity scores .",
    "we have shown that , in contrast to other proposals , our tests are asymptotically not sensitive to the estimation method used to estimate the propensity score under the null , and do not rely on the potentially ad hoc choice of bandwidths .",
    "we have derived the asymptotic properties of the proposed tests , and have proved that they are able to detect local alternatives converging to the null at the parametric rate , and that critical values can be easily computed via a simple multiplier bootstrap procedure .",
    "our monte carlo simulation study illustrates that , for a large class of alternatives , our projection - based tests perform better in finite samples than existing tests , though there are some rather exceptional classes of alternatives in which our tests have trivial power .",
    "all these finite sample findings are in line with our asymptotic results .",
    "finally , our empirical application concerning the effect of napster on recorded music sales showed the feasibility and appeal of our tests in relevant scenarios .",
    "given that the validity of many policy evaluation procedures rely on the correct specification of the propensity score , we argue that the tests proposed in this article are important additions to the applied researcher s toolkit .",
    "we would like to emphasize that our proposed specification tests can also be useful in contexts other than treatment effects , in which `` selectivity '' plays an important role .",
    "a leading example is in estimation with missing data when missingness is random conditional on a set of covariates , see e.g. @xcite",
    ". a common approach to overcome the missing data problem is to model the missingness probability with a parametric specification , and then rely on inverse probability weighted estimators .",
    "our specification tests could then be straightforwardly applied to assess the reliability of the resulting estimator .",
    "we provide the proofs of the main theoretical results in this appendix .",
    "several elementary lemmas are first established .",
    "define an auxiliary process @xmath228      * lemma 1 : * _ under assumptions 1 - 3 and under the null hypothesis @xmath229 , we have @xmath231 _ * proof of lemma 1 : * we write uniformly in @xmath232 @xmath233 where the second to last equality follows by the first order taylor expansion and assumptions 1 and 2 .",
    "define the process @xmath234 since under @xmath2 the @xmath235 s are centered conditionally on @xmath9 s , @xmath236 has @xmath173 centered summands .",
    "clearly , the first term @xmath237 can be expressed as @xmath238 . under assumption 3",
    ", @xmath239 is asymptotically equicontinuous , see e.g. @xcite . since @xmath240 by assumptions 1(iii ) , @xmath241 in probability uniformly in @xmath232 .",
    "for the second term @xmath242 , since by assumption 1(iii ) , @xmath243 , it remains to show that , uniformly in @xmath232 , @xmath244 however , this follows straightforwardly from the uniform convergence of @xmath245 in @xmath232 and @xmath21 together with the continuity of its limits .",
    "@xmath246        * proof of lemma 2 : * from lemma 1 , we have uniformly in @xmath232 @xmath249by the mean value theorem ( mvt ) and assumption 1 , the second term in the previous expression is @xmath250+o_{p}(1),\\end{aligned}\\]]with @xmath251 between @xmath31 and @xmath33 , where the latter equality follows by the uniform law of large numbers ( ulln ) of @xcite , lemma 2.4 .",
    "this finishes the proof of lemma 2 .",
    "@xmath252          we first show @xmath257 . note that @xmath258\\sqrt{n}(\\hat{\\theta}_{n}-\\theta _ { 0})+o_{p}(1),\\end{aligned}\\]]with @xmath251 between @xmath31 and @xmath33 , where the second to last equality follows by the mvt , and the last quality follows from the ulln of @xcite ) , lemma 2.4 .",
    "it remains to show that both @xmath259 and @xmath260 are asymptotically negligible .",
    "note that @xmath261 + o_{p}(1 ) \\\\",
    "= & o_{p}(1),\\end{aligned}\\]]where the first equality follows by mvt , the second equality by ulln of newey1994c , and the last equation by assumptions 1 and 2 as well as the law of iterated expectations under @xmath2 .    on the other hand , for the term @xmath260 , we get @xmath262\\sqrt{n}(\\hat{\\theta}_{n}-\\theta_{0})+o_p(1 ) \\\\ = & o_p(1),\\end{aligned}\\ ] ] following similar arguments in proving the negligibility of @xmath259 .",
    "hence @xmath263 .",
    "this ends the proof of lemma 3 .",
    "@xmath246          * proof of theorem 1 : * by straightforward decomposition , we have @xmath270 by lemmas 2 - 5 , we have that @xmath271 + o_{p}(1 ) \\\\",
    "= & \\frac{1}{\\sqrt{n}}\\sum_{i=1}^{n}\\varepsilon_{i}(\\theta_{0})\\left ( w(q(x_{i},\\theta_{0}),u)-g_w^{\\prime}(u,\\theta_0)\\delta^{-1}(\\theta_0)g(x_{i},\\theta_{0})\\right ) + o_{p}(1 ) \\\\",
    "= & r_{w , n0}^{p}(u)+o_{p}(1)\\end{aligned}\\ ] ] uniformly in @xmath59 .",
    "this ends the proof of theorem 1 .",
    "@xmath246    * proof of corollary 1 : * the weak convergence of the empirical process @xmath75 and the continuous mapping theorem ensure the convergence of @xmath138 to @xmath272 for any continuous functional @xmath193 and in particular that of @xmath273 to @xmath274 .    for the test statistic @xmath87",
    ", we will prove that @xmath275the weak convergence of the processes @xmath85 and @xmath276 and the skorohod construction ( see @xcite ) , yield @xmath277and @xmath278now write @xmath279the first term of the right - hand side of the above inequality is @xmath280 a.s . due to",
    "( [ sk1 ] ) .",
    "the trajectories of the limit process @xmath281 are bounded and continuous almost surely .",
    "then , by applying helly - bray theorem ( see p.97 in @xcite ) to each of these trajectories and taking into account ( [ sk2 ] ) , we obtain @xmath282 .",
    "this concludes the proof of corollary 1 .",
    "@xmath252    * proof of theorem 2 : * under assumptions 1 - 3 , uniformly in @xmath283 , @xmath284 \\right\\ } \\right\\vert   \\\\ = & \\sup_{u\\in \\pi } \\left\\vert \\frac{1}{\\sqrt{n}}\\hat{r}_{w , n}^{p}(u)-\\mathbb{e}\\left [ \\left ( p\\left ( x\\right ) -q\\left ( x,\\theta _ { 0}\\right ) \\right )   \\mathcal{p}w(q(x,\\theta _ { 0}),u)\\right ] \\right\\vert   \\\\ = & o_{p}(1)\\end{aligned}\\]]by ulln of @xcite and similar arguments in proving lemmas 1 , 4 and 5 . @xmath252    * proof of theorem 3 : * note that under the local alternatives @xmath158 in ( [ h1n ] ) , we have that uniformly in @xmath59 : @xmath285+o_p(1 ) \\\\ : = & r_{w , n1}^p(u)+\\delta_{r , w}(u)+o_p(1 ) \\\\",
    "\\rightarrow & r_{w,\\infty}^{p}+\\delta_{r , w},\\end{aligned}\\ ] ] where the second equality follows by same similar arguments in proving theorem 1 and by ulln .",
    "since that @xmath286 is a zero mean martingale difference in this local alternative framework , we can apply the functional central limit theorem to @xmath287 , just as we applied it to @xmath288 defined in ( [ rn0 ] ) , leading to @xmath289 .",
    "the last step follows and we finish the proof of theorem 3 .",
    "@xmath246    * proof of theorem 4 : * as in theorem 1 , we have the following decomposition : @xmath290 by assumption 3 , it follows from a stochastic equicontinuity argument and the consistency of @xmath291 that , uniformly in @xmath59 , @xmath292 and @xmath293 thus , uniformly in @xmath232 , @xmath294 leading to the bootstrapped version of @xmath288 in ( [ rn0 ] ) .",
    "the rest of the proof follows from the multiplier central limit theorem applied to @xmath295 ; see van der vaart and wellner ( 1996 , theorem 2.9.2 , p.179 ) , and the continuous mapping theorem ."
  ],
  "abstract_text": [
    "<S> this paper introduces new nonparametric diagnostic tools for detecting propensity score misspecification . </S>",
    "<S> these tests may be applied to assess the validity of different treatment effects estimators that rely on the correct specification of the propensity score . </S>",
    "<S> our tests do not suffer from the curse of dimensionality  when the vector of covariates is of high - dimensionality , are fully data - driven , do not require tuning parameters such as bandwidths , and are able to detect a broad class of local alternatives converging to the null at the parametric rate @xmath0 , with @xmath1 the sample size . </S>",
    "<S> we show that the use of an orthogonal projection on the tangent space of nuisance parameters both improves power and facilitates the simulation of critical values by means of a multiplier bootstrap procedure . </S>",
    "<S> the finite sample performance of the tests are examined by means of a monte carlo experiment and an empirical application . </S>",
    "<S> open - source software is available for implementing the proposed tests . </S>",
    "<S> * jel : * c12 , c31 , c35 , c52 . * keywords : * goodness - of - fit ; integrated moments ; empirical processes ; multiplier bootstrap ; treatment effects . </S>"
  ]
}