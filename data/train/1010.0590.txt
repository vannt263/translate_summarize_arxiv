{
  "article_text": [
    "the goal of this paper is to contribute to the understanding of the geometry of wasserstein spaces . given a metric space @xmath0 , the theory of optimal transport ( with quadratic cost ) gives birth to a new metric space , made of probability measures on @xmath0 , often called its wasserstein space and denoted here by @xmath1 ( precise definitions are recalled in the first part of this paper ) .",
    "one can use this theory to study @xmath0 , for example by defining lower ricci curvature bounds as in the celebrated works of lott - villani @xcite and sturm @xcite .",
    "conversely , here we assume some understanding of @xmath0 and try to use it to study geometric properties of @xmath1 .",
    "a similar philosophy underlines the works of lott in @xcite and takatsu and yokota in @xcite .",
    "in a previous paper @xcite , the second author studied the case when @xmath0 is a euclidean space .",
    "here we are interested in the far broader class of _ hadamard spaces _ which are roughly the globally non - positively curved spaces .",
    "the first part of the paper is devoted to recalls on optimal transport and hadamard spaces ; in particular the precise hypotheses under which we shall work are given there ( definition [ defi : hadamard ] , see also examples [ exem : hadamard ] ) .",
    "let us stress that we allow @xmath0 to be branching ; trees , product involving trees , some buildings are in particular treated in the same framework than , for example , symmetric spaces of non - compact type .",
    "while non - negative curvature is an assumption that is inherited by wasserstein spaces , it is well - known that non - positive curvature is not ( an argument is recalled in section [ sec : interpolation ] ) . we shall however show that some features of hadamard spaces still hold in their wasserstein spaces .",
    "let us now describe the main results of the article .",
    "a hadamard space admits a well - known geometric compactification , obtained by adding a boundary at infinity made of asymptote classes of geodesic rays . in part",
    "[ part : rays ] , we study the geodesic rays of @xmath1 . using a displacement interpolation procedure ( proposition [ prop : displacement ] ) , we associate to each ray its _ asymptotic measure _ which lies in a subset @xmath4 of probability measures on the cone @xmath5 over the boundary of @xmath0 ( definition [ defi : asymptotic ] ) .",
    "it encodes the asymptotic distribution of the direction and speed of a measure running along the ray .",
    "our first main result is the _",
    "asymptotic formula _",
    "( theorem [ theo : asymptotic ] ) which enables one to compute the asymptotic behavior of the distance between two rays in terms of the wasserstein distance of the asymptotic measures , with respect to the angular cone distance on @xmath5 .",
    "this asymptotic distance is either bounded or asymptotically linear , so that the boundary @xmath6 of the wasserstein space , defined as the set of asymptote classes of unit geodesic rays , inherits an angular metric , just like @xmath0 does .",
    "a striking consequence of the asymptotic formula concerns the rank of @xmath1 , and partially answers a question raised in the previous paper cited above .",
    "[ theo : intro : rank ] if @xmath0 is a visibility space ( e.g. if it has curvature bounded from above by a negative constant ) , then it is not possible to embed the euclidean plane isometrically in @xmath1 .    in other words ,",
    "when @xmath0 is strongly negatively curved which implies that its has rank @xmath3 , then although @xmath1 is not negatively curved it has rank @xmath3 too .",
    "note that our large - scale method in fact implies more general non - embedding results , see proposition [ prop : snowflaked ] and the discussion below .",
    "it is easy to see that any element of @xmath4 is the asymptotic measure of some ray in @xmath1 .",
    "however , asymptotic measures of complete geodesic must be concentrated on the set of _ unit _ geodesics ( proposition [ prop : completegeodesics ] ) and this is an easy but important step in the proof of theorem [ theo : intro : rank ] .",
    "a complete geodesic in @xmath1 defines two asymptotic measures , also called its ends : one for @xmath7 , the other for @xmath8 .",
    "one can therefore ask which pairs of boundary measures are the ends of some complete geodesic .",
    "we give in section [ sec : pairs ] a necessary condition that follows easily from the asymptotic formula , and a complete answer when @xmath0 is a tree ( theorem [ theo : endsrealizability ] ) .",
    "in fact we give two characterizations of realizable pairs of asymptotic measure , one of them involving a optimal transportation problem related to the gromov product .",
    "this criterion might generalize to arbitrary gromov hyperbolic spaces , but the case of a general hadamard space may be challenging .    part [ part : boundary ] is devoted to the definition of a so - called _ cone topology _ on @xmath6 and @xmath9 , see proposition [ prop : conetop ] .",
    "note that the angular metric alluded to above , however useful and meaningful , does not define a satisfactory topology ( just as in @xmath10 , where the angular metric is usually not separable and can even be discrete ) .",
    "the point is that many monotony properties used in the case of hadamard spaces hold when one restricts to angles based at a dirac mass .",
    "this enables us to carry out the construction of this topology despite the presence of positive curvature .",
    "the main result of this part is the following , restated as theorem [ theo : homeobound ] .",
    "the asymptotic measure map defined from @xmath11 to @xmath4 is a homeomorphism .",
    "note that the two natural topologies on @xmath6 , namely the cone topology and the quotient topology of the topology of uniform convergence on compact sets , coincide .",
    "the set @xmath4 is simply endowed with the weak topology ( where the topology on @xmath5 is induced by the cone topology of @xmath10 ) .",
    "the possibility to identify @xmath11 to @xmath4 should be thought of as an interversion result , similar to displacement interpolation .",
    "the latter says that `` a geodesic in the set of measures is a measure on the set of geodesics '' , while the former can be roughly restated as `` a boundary point of the set of measures is a measure on the ( cone over the ) set of boundary points '' .",
    "note that @xmath12 is not compact ; this is quite inevitable since @xmath1 is not locally compact .",
    "last , part [ part : isometries ] adresses the isometry group of @xmath1 . in @xcite",
    "it was proved that the isometry group of @xmath13 is strictly larger than that of @xmath14 itself , the case @xmath15 being the most striking : some isometries of @xmath16 are exotic in the sense that they do not preserve the shape of measures .",
    "this property seems pretty uncommon , and we shall show the following rigidity result .",
    "[ theo : intro : isometry ] if @xmath0 is a negatively curved hadamard manifold or a tree not reduced to a line and without leaf , then @xmath1 is isometrically rigid in the sense that its only isometries those induced by the isometries of @xmath0 itself .",
    "note that in the case of trees , the assumption that @xmath0 has no leaf could probably be released but comes out naturally in the proof .",
    "we are in fact able to treat more space than enclosed in the previous statement , see theorem [ theo : isometry ] .",
    "in particular the @xmath17 buildings have isometrically rigid wasserstein spaces .    in the process",
    "of proving [ theo : intro : isometry ] , we also get the following result ( corollary [ coro : isometry ] ) that seems interesting by itself .    let @xmath18 be geodesic polish spaces and assume that @xmath19 is geodesically complete and locally compact",
    ". then @xmath20 is isometric to @xmath21 if and only if @xmath19 is isometric to @xmath22 .",
    "note that theorem [ theo : intro : isometry ] involves the inversion of some kind of radon transform , that seems to be new ( for trees it is in particular different from the horocycle radon transform ) and could be of interest for other problems .",
    "as its title indicates , this part contains nothing new .",
    "we chose to give quite a lot of recalls , so that the reader familiar with non - positively curved spaces can get a crash - course on wasserstein spaces , and the reader familiar with optimal transport can be introduced to hadamard spaces .",
    "we start with some definitions and properties of metric spaces , especially the non - positively curved ones .",
    "most properties of hadamard space that we need are proved in @xcite .",
    "another more extensive reference is @xcite .",
    "let us first fix some conventions for any metric space @xmath19 ( this letter shall be used to design arbitrary spaces , while @xmath0 shall be reserved to the ( hadamard ) space under study )",
    ".    given a continuous curve @xmath23 , one defines its length by @xmath24\\ ] ] where the supremum is over sequences of arbitrary size of @xmath25 .",
    "the curve is said to be _",
    "rectifiable _ if it has finite length .",
    "a _ geodesic _ in @xmath19 is a curve @xmath26 defined on some interval @xmath27 , such that there is a constant @xmath28 that makes the following hold for all times @xmath29 : @xmath30 in particular , all geodesics are assumed to be _ globally _ minimizing and to have constant , non necessarily unitary speed .",
    "of course , any geodesic defined over a segment is rectifiable , and has length equal to the distance between its endpoints .",
    "when @xmath31 we say that the geodesic is constant and it will be necessary to consider this case .",
    "we denote by @xmath32 the set of geodesics defined on the interval @xmath33 $ ] .",
    "a _ geodesic ray _ ( or _ ray _ , or _",
    "complete ray _ ) is a geodesic defined on the interval @xmath34 .",
    "complete geodesic _ is a geodesic defined on @xmath35 .",
    "the set of rays is denoted by @xmath36 , the set of unit speed rays by @xmath37 and the set of non - constant rays by @xmath38 .",
    "we shall also denote by @xmath39 the set of complete geodesics , and by @xmath40 the set of unit - speed complete geodesics .",
    "a metric space is _ geodesic _ if any pair of points can be linked by a geodesic .",
    "a triangle in a geodesic space @xmath19 is the data of three points @xmath41 together with three geodesics parametrized on @xmath42 $ ] linking @xmath43 to @xmath44 , @xmath44 to @xmath45 and @xmath45 to @xmath43 .",
    "given a triangle , one defines its _ comparison triangle _ @xmath46 as any triangle of the euclidean plane @xmath47 that has the same side lengths : @xmath48 , @xmath49 and @xmath50 .",
    "the comparison triangle is defined up to congruence .",
    "a triangle with vertices @xmath41 is said to satisfy the @xmath51 inequality along its @xmath52 $ ] side ( parametrized by a geodesic @xmath53 ) if for all @xmath54 $ ] , the following inequality holds : @xmath55 see figure [ fig : comparison ] .",
    "a geodesic space is said to be locally @xmath51 if every point admits a neighborhood where all triangles satisfy the @xmath51 inequality ( along all there sides ) .",
    "when @xmath19 is a riemannian manifold , this is equivalent to ask that @xmath19 has non - positive sectional curvature .",
    "a geodesic space is said to be globally @xmath51 if all its triangles satisfy the @xmath51 inequality .",
    "globally @xmath51 is equivalent to simply connected plus locally @xmath51 .",
    "we shall simply say @xmath51 for `` globally @xmath51 '' , but this is not a universal convention .",
    "the @xmath51 condition can be translated in terms of angles as follows .",
    "given any geodesic triangle , choose any of its vertices , say @xmath43 , and assume that the sides containing @xmath43 are parametrized by two geodesics @xmath56 . if @xmath19 is @xmath51 , then the euclidean angle @xmath57 at @xmath58 is a nondecreasing function of @xmath59 and @xmath60 .",
    "one then defines in @xmath19 the angle @xmath61 at @xmath43 as the limit , when @xmath59 and @xmath60 go to zero , of @xmath62 . as a consequence",
    ", one gets that for any geodesic triangle with vertices @xmath41 in a @xmath51 space , angle and comparison angle satisfy @xmath63      in a @xmath51 space , given two geodesics @xmath64 and @xmath65 , the distance function @xmath66 is convex .",
    "this important property shall be kept in mind since it will be used very often in the sequel .",
    "we can now introduce the class of spaces we are interested in .",
    "[ defi : hadamard ] a metric space is a _ hadamard space _ if it is :    * polish ( i.e. complete and separable ) , * locally compact , * geodesic , * @xmath51 , implying that it is simply connected .",
    "in all what follows , we consider a hadamard space @xmath0 .",
    "the hadamard assumption may not always be made explicit , but the use of the letter @xmath0 shall always implicitely imply it .",
    "[ exem : hadamard ] there are many important examples of hadamard spaces .",
    "let us give some of them :    * the euclidean space @xmath14 , * the real hyperbolic space @xmath67 , * the other hyperbolic spaces @xmath68 , @xmath69 , @xmath70 , * more generally the symmetric spaces of non - compact type , like the quotient @xmath71 endowed with the metric induced by the killing form of @xmath72 , * more generally any simply connected riemannian manifold whose sectional curvature is non - positive , * trees , * any product of hadamard spaces , * some buildings , like product of trees having unit edges and no leaf or @xmath73 buildings ( see @xcite ) , * the gluing of any two hadamard spaces along isometric , convex subsets ; for example any hadamard space with an additional geodesic ray glued at some point , or three hyperbolic half - planes glued along their limiting geodesic , etc",
    ".      the construction of the geodesic boundary that we will shortly describe seems to date back to @xcite , but note that @xcite is at the origin of many related ideas .",
    "two rays of @xmath0 are _ asymptotic _ if they stay at bounded distance when @xmath8 , and this relation is denoted by @xmath74 . the asymptote class of a ray @xmath64 is often denoted by @xmath75 or @xmath76 , and is called the _ endpoint _ or _ boundary point _ of @xmath64 .",
    "the _ geodesic _ ( or _ hadamard _ ) _ boundary _ of @xmath0 is defined as the set @xmath77 using the convexity of distance along geodesics , one can for example prove that , given points @xmath78 and @xmath79 , there is a unique unit ray starting at @xmath43 and ending at @xmath80 .",
    "the union @xmath81 can be endowed with its so - called cone topology , which makes @xmath82 and @xmath10 compact . without entering into the details ,",
    "let us say that this topology induces the original topology on @xmath0 , and that given a base point @xmath83 a basic neighborhood of a point @xmath84 ( where @xmath64 starts at @xmath83 ) is the union , over all rays @xmath85 such that @xmath86 for all @xmath87 , of @xmath88)$ ] ( see figure [ fig : conetopology ] ) .",
    "consistently whith the cone topology , all previously defined sets of geodesics , as well as the larger sets @xmath89 of continuous curves defined on an interval @xmath27 with values in @xmath0 , are endowed with the topology of uniform convergence on compact sets . with this topology ,",
    "since @xmath0 is hadamard , a geodesic segment is uniquely and continuously defined by its endpoints and a geodesic ray is uniquely and continuously defined by its starting point , its endpoint in the boundary and its speed . as a consequence ,",
    "there are natural homeomorphisms @xmath90 where @xmath5 is the cone over @xmath10 , that is the quotient of @xmath91 by the relation @xmath92 for all @xmath93 .",
    "we usually use the same notation @xmath94 for a couple and its equivalence class under this relation ; here @xmath59 shall be considered as a speed . in particular",
    "one has @xmath95 .",
    "note that in view of our assumptions on @xmath0 , all these spaces are locally compact polish topological spaces ( that is , metrizable by a metric that is separable and complete ) .",
    "it ensures that all finite measures on these spaces are radon .      at some points",
    ", we shall make explicitely additional hypotheses on @xmath0 .",
    "one says that a space is :    * _ geodesically complete _ if every geodesic can be extended to a complete geodesic , * _ non - branching _ if two geodesics that coincide on an open set of parameters coincide everywhere on their common definition interval , * @xmath96 fo some @xmath97 if its triangles satisfy the inequality when the comparison triangle is taken in @xmath98 , the hyperbolic plane of curvature @xmath99 , instead of @xmath47 . * a _ visibility space _ if for all pairs of distinct points @xmath100 there is a complete geodesic @xmath64 such that @xmath101 and @xmath102 .    note that for all @xmath97 , the condition @xmath96 implies that @xmath0 is a visibility space .",
    "geodesic completeness is quite mild ( avoiding examples as trees with leafs ) , while the other are strong assumptions ( for example non - branching rules out trees and visibility rules out products ) . another possible assumption , that we shall not use directly , is for @xmath0 to have _",
    "rank one _ , meaning that it admits no isometric embedding of the euclidean plane .",
    "it is a weaker condition than visibility .",
    "more generally the rank of a space @xmath19 is the maximal dimension of an embedded eulidean space , and it has been proved a very important invariant in the study of symmetric spaces .",
    "for example the hyperbolic spaces @xmath67 ,",
    "@xmath68 , @xmath69 and @xmath70 are the only rank one symmetric spaces of non - compact type .      given two rays @xmath103 , one defines their _ asymptotic distance _ by @xmath104 this limit always exists because of the convexity of the distance function along geodesics .",
    "moreover @xmath105 defines a metric on @xmath5 and , by restriction , on @xmath10 ( in particular two rays whose distance grows sub - linearly must be asymptotic ) .",
    "it can be proved that @xmath106 is the cone metric over @xmath10 endowed with the angular metric .",
    "namely , for any @xmath107 , @xmath108 where @xmath109 is the supremum of angles between rays issuing from @xmath43 and asympotic to @xmath110 and @xmath111 respectively ( we refer to ( * ? ? ?",
    "* section ii.9 ) for more details and proof ) .",
    "it is most important to keep in mind that the metric @xmath105 _ does not induce the cone topology _ , but a much more finer topology .",
    "the most extreme case is that of visibility spaces , where @xmath112 is @xmath113 if @xmath114 and the sum of the speeds of @xmath64 and @xmath85 otherwise : the topology induced on @xmath10 is discrete .",
    "however , the function @xmath105 is lower semi - continuous with respect to the cone topology ( * ? ? ?",
    "* proposition ii.9.5 ) , so that it is a mesurable function ( see the next paragraph for a reference ) .    in higher rank spaces",
    ", it can be useful to turn @xmath105 into a length metric , called the tits metric , but we shall not use it so we refer the interested reader to the books cited above .",
    "let us just note that @xmath105 resembles in some aspects the chordal metric on a sphere . in particular",
    ", it is naturally isometric to this metric when @xmath0 is a euclidean space .",
    "in this section , we recall the definition of wassertein space and some of its main properties . for more details , we refer to the books @xcite and @xcite .",
    "let us start with the concept of optimal transport which is the theory aimed at studying the _ monge - kantorovich _ problem .",
    "standard data for this problem are the following .",
    "we are given a polish metric space @xmath115 , a lower semicontinuous and nonnegative function @xmath116 called the cost function and two borel probability measures @xmath117 defined on @xmath19 .",
    "a _ transport plan _ between @xmath118 and @xmath119 is a measure on @xmath120 whose marginals are @xmath118 and @xmath119 .",
    "one should think of a transport plan as a specification of how the mass in @xmath19 , distributed according to @xmath118 , is moved so as to be distributed according to @xmath119 .",
    "we denote by @xmath121 the set of transport plans which is never empty ( it contains @xmath122 ) and most of the time not reduced to one element .",
    "the monge - kantorovich problem is now @xmath123 where a minimizer is called an _",
    "optimal transport plan_. the set of optimal transport plans is denoted by @xmath124 .",
    "let us make a few comments on this problem .",
    "first , note that under these assumptions , the cost function is measurable ( see , for instance , @xcite ) .",
    "now , existence of minimizers follows readily from the lower semicontinuity of the cost function together with the following compactness result which will be used throughout this paper .",
    "we refer to @xcite for a proof .    given a polish space @xmath19 , a set @xmath125 is totally bounded ( that is , has compact closure ) for the weak topology if and only if it is tight , namely for any @xmath126 , there exists a compact set @xmath127 such that @xmath128 for any @xmath129 .",
    "for example , the set @xmath121 is always compact .",
    "we also mention that , compared to the existence problem , the issue of the _ uniqueness _ of minimizers is considerably harder and requires , in general , additional assumptions . to conclude this introduction , we state a useful criterium to detect optimal transport plan among other plans , named cyclical monotonicity .    [ defi : cyclical ] given a cost function @xmath130 , a set @xmath131 is called @xmath132-cyclically monotone if for any finite family of pairs @xmath133 in @xmath134 , the following inequality holds @xmath135 where @xmath136 .    in other words ,",
    "a @xmath132-cyclically monotone set does not contain cycles of pairs ( starting point , ending point ) along which a shift in the ending points would reduce the total cost .",
    "let @xmath115 be a polish space and @xmath130 be a lower semi - continuous cost function .",
    "then , a transport plan is optimal relatively to @xmath132 if and only if it is concentrated on a @xmath132-cyclically monotone set .",
    "if @xmath132 is continuous , this is equivalent to its support being @xmath132-cyclically monotone .    under these assumptions ,",
    "this result is due to schachermayer and teichmann @xcite ; see also @xcite for a proof .",
    "wasserstein spaces arise in a particular variant of the setting above .    given a polish metric space @xmath19 , its ( quadratic ) wassertein space",
    "@xmath20 is the set of borel probability measures @xmath118 on @xmath19 with finite second moment , that is such that @xmath137 endowed with the wasserstein metric defined by @xmath138    from now on , the cost @xmath132 will therefore be @xmath139 .",
    "the fact that @xmath140 is indeed a metric follows from the so - called `` gluing lemma '' which enables one to propagate the triangular inequality , see e.g. @xcite .    in this paper",
    ", we will also consider the wassertein space over the cone @xmath141 relative to the cost @xmath142 .",
    "since @xmath105 is lower semi - continuous , this is indeed a metric space .",
    "note that we shall denote by @xmath143 the wasserstein metric derived from @xmath105 .",
    "the wasserstein space has several nice properties : it is polish ; it is compact as soon as @xmath19 is , in which case the wasserstein metric metrizes the weak topology ; but if @xmath19 is not compact , then @xmath20 is not even locally compact and the wasserstein metric induces a topology stronger than the weak one ( more precisely , convergence in wasserstein distance is equivalent to weak convergence plus convergence of the second moment ) .",
    "a very important property is that @xmath20 is geodesic as soon as @xmath19 is ; let us give some details .",
    "the proof of what we explain now can be found for example in chapter 7 of @xcite , see in particular corollary 7.22 and theorem 7.30 .",
    "note that the concept of displacement interpolation has been introduced by mccann in @xcite .",
    "we write this section in the case of @xmath0 , but most of it stays true for any polish geodesic space .",
    "dynamical transport plan _ between two measures @xmath144 as a probability measure @xmath118 on @xmath145;x)$ ] such that for @xmath146 the law at time @xmath147 of a random curve drawn with law @xmath118 is @xmath148 .",
    "in other words we ask @xmath149 where @xmath150 is the map @xmath145;x)\\to x$ ] defined by @xmath151 .",
    "the _ cost _ of @xmath118 is then @xmath152 where @xmath153 is the length of the curve @xmath64 ( possibly @xmath154 ) .",
    "a dynamical transport plan is _ optimal _ if it minimizes the cost over all dynamical transport plans , and it is known that a dynamical transport plan exists .",
    "morevover , if @xmath118 is an optimal dynamical transport plan then :    1 .   the law @xmath155 of the couple @xmath156 where @xmath64 is a random curve drawn with law @xmath118 , is an optimal transport plan between @xmath157 and @xmath158 , 2 .",
    "@xmath118-almost all @xmath159;x)$ ] are geodesics .",
    "conversely , if @xmath160 is a ( non - dynamical ) optimal transport plan , then one can construct for any @xmath161 an optimal dynamical transport plan by the following construction .",
    "let @xmath162;x)$ ] be the map that sends a couple @xmath163 of points to the unique geodesic parametrized on @xmath164 $ ] that starts at @xmath43 and ends at @xmath44 . then @xmath165 is an optimal dynamical transport plan , whose associated optimal transport plan is obviously @xmath160 .",
    "given a dynamical plan @xmath166 where @xmath27 is an arbitrary interval , @xmath118 is said to be _",
    "@xmath132-cyclically monotone _ if for any @xmath167 , the support of the plan @xmath168 is @xmath132-cyclically monotone ( note that here the cost is continuous ) .",
    "as soon as @xmath169 have finite second moments , this is equivalent to @xmath118 being optimal , but cyclical monotonicity has the advantage of being well - defined without any integrability assumption .",
    "the main use of optimal dynamical transport plans is that they define geodesic segments .",
    "indeed , let as before @xmath150 be the map @xmath170 defined on the set of continuous curves .",
    "if @xmath118 is an optimal dynamical transport plan , consider the law @xmath171 at time @xmath60 of a random geodesic drawn with law @xmath118 : then @xmath172 is a geodesic of @xmath1 .",
    "displacement interpolation is the converse to this principle .",
    "given any geodesic segment @xmath172 in @xmath1 , there is a probability measure @xmath118 on @xmath173 such that for all @xmath60 @xmath171 .    if @xmath118 is a dynamical transport plan on @xmath27 , for all @xmath174 define the _ time restriction _ of @xmath118 to @xmath164 $ ] as @xmath175 where @xmath176 is the restriction of the curve @xmath64 to the interval @xmath164 $ ] .",
    "let @xmath118 be an optimal dynamical transport plan on @xmath42 $ ] .",
    "for all @xmath177 $ ] the following hold ( see ( * ? ? ?",
    "* theorem 7.30 ) ) :    1 .",
    "@xmath178 is an optimal dynamical transport plan , 2",
    ".   if @xmath0 is non - branching and @xmath179 , then @xmath178 is the _ unique _ ( up to parametrization ) optimal dynamical transport plan between @xmath180 and @xmath181 .",
    "it is well known that the non - positive curvature assumption on @xmath0 is not inherited by @xmath1 except if @xmath0 is the real line or a subset of it .",
    "let us use displacement interpolation to show it in the most simple way .",
    "first , the wasserstein space is contractible thanks to the affine structure on the set of probablity measures ( the convex combination of @xmath118 and @xmath119 with weights @xmath60 and @xmath182 being @xmath183 ) .",
    "if it were locally @xmath51 , it would be globally @xmath51 and , in particular , uniquely geodesic .",
    "but as soon as @xmath0 is not reduced to a geodesic , there exists four distinct points @xmath184 such that @xmath185 and @xmath186 ( see figure [ fig : tripod ] for the case of a tree ) . between the measures @xmath187 ( where @xmath188 s are dirac masses ) and @xmath189 ,",
    "all transport plans are optimal ( and there are several of them , in fact an uncountable number , for example parametrized by the quantity of mass taken from @xmath43 to @xmath44 ) .",
    "as we have seen above , each optimal transport plan defines a geodesic in @xmath20 from @xmath118 to @xmath119 .",
    "therefore @xmath20 is very far from being uniquely geodesic , and is in particular not non - positively curved .",
    "[ part : rays ] in this part , we study the geodesic rays of @xmath1 , which shall in particular be used to define its geodesic boundary , to be endowed with a topology in the next part .",
    "the _ geodesic boundary _ of @xmath1 is defined as the set of asymptote classes of unitary geodesic rays : @xmath190    the core result of this part is the asymptotic formula ( theorem [ theo : asymptotic ] ) which gives precise indication on the speed at which the distance between two rays goes to infinity . in particular , we shall show that this distance is either bounded or linear , so that there is a well - defined asymptotic distance in @xmath6 .",
    "the asymptotic formula shows that it can be identified with the wasserstein metric derived from the asymptotic distance of @xmath0 .    to do this",
    ", we need to extend the displacement interpolation principle to rays ( section [ sec : displacement ] ) , so that we can define the asymptotic measure of a ray that yields the identification alluded to above ( section [ sec : asymptotic ] ) .",
    "then we use the asymptotic formula to study the rank of @xmath1 ( section [ sec : rank ] ) , and last we discuss the possibility to prescribe the asymptotic behavior of a complete geodesic for @xmath8 and @xmath7 at the same time ( section [ sec : pairs ] ) .",
    "to start the description of @xmath6 , we need _ displacement interpolation _ for rays .",
    "there is not much , but a little work needed to extend from the case of geodesic segment , the crucial point being to handle the branching case .",
    "note that the case of complete geodesic is not different than that of the rays .",
    "[ prop : displacement_nb ] if @xmath0 is non - branching , any geodesic ray @xmath191 of @xmath1 admits a unique displacement interpolation , that is a probability measure @xmath118 on @xmath192 such that @xmath169 is the law of the time @xmath60 of a random ray having law @xmath118 ( in other words , such that @xmath193 ) .    note that since @xmath191 is a geodesic , the time restriction of @xmath118 to any segment is an optimal dynamical transport plan .",
    "since @xmath0 is non - branching and @xmath191 is defined for all positive times , we know that there is a unique optimal dynamical transport plan @xmath194 from @xmath157 to @xmath195 , and that @xmath196 whenever @xmath197 . the fact that @xmath0 is non - branching also implies that for any two points @xmath198 there is a unique maximal geodesic ray @xmath199 starting at @xmath43 and passing at @xmath44 at time @xmath3 .",
    "moreover this ray depends continuously and therefore measurably on @xmath163 .",
    "it follows that all @xmath194 are uniquely defined by @xmath200 and that the probability measure @xmath201 , where @xmath160 is the optimal transport plan associated to @xmath200 , has the requiered property .",
    "when @xmath0 is branching , the previous proof fails for two reasons .",
    "the first one is that we can not determine @xmath194 and define @xmath118 from @xmath200 alone ; although a theorem of prokhorov will do the trick .",
    "the second problem is that there may exist several optimal dynamical transport plans corresponding to the same geodesic ; but the set of these transports is always compact and a diagonal process will solve the problem .",
    "however , we lose unicity in the process and it would be interesting to single out one of the dynamical transport plan obtained .    [",
    "prop : displacement ] any geodesic ray of @xmath1 admits a displacement interpolation .    let @xmath202 be a geodesic ray in @xmath1 and for all @xmath203 , let @xmath204 be the set of all optimal dynamical transport plans parametrized on @xmath205 $ ] that induce the geodesic segment @xmath206 .",
    "it is a compact set according to @xcite , corollary 7.22 . for all @xmath207 ,",
    "choose @xmath194 in @xmath204 and for all integer @xmath208 define @xmath209 as the restriction @xmath210 .    by a diagonal process",
    ", one can extract an increasing sequence @xmath211 of integers such that for all @xmath212 , @xmath213 has a limit @xmath214 when @xmath215 .",
    "since for all @xmath216 the restriction maps @xmath217 are continuous , we get that @xmath218 .",
    "we therefore have a projective system of measures ; the projection map @xmath219 commutes with the @xmath220 thus , according to a theorem of prokhorov ( see @xcite ) , if we prove tightness , _",
    "i.e. _ that for all @xmath221 there is a compact @xmath222 such that for all @xmath223 , @xmath224 , then we can conclude that there is a unique measure @xmath118 on @xmath192 such that @xmath225 for all @xmath223 .",
    "this measure will have the requiered property since @xmath226 .",
    "fix any @xmath221 .",
    "let @xmath227 be compact subsets of @xmath0 such that @xmath228 for @xmath146 .",
    "let @xmath229 be the compact subset of @xmath192 consisting in all geodesic rays starting in @xmath230 and whose time @xmath3 is in @xmath231 .",
    "then for all @xmath232 , @xmath233 , as needed .",
    "the following result shall make displacement interpolation particularly useful .",
    "let @xmath118 , @xmath85 be probability measures on @xmath192 ( or similarly @xmath234 , ... ) and denote by @xmath193 and @xmath235 their time @xmath60 .",
    "any transport plan @xmath236 admits a _ lift _ , that is a transport plan @xmath237 such that @xmath238 .",
    "disintegrate @xmath118 along @xmath169 : there is a family @xmath239 of probability measures on @xmath192 , each one supported on the set @xmath240 of geodesic rays passing at @xmath43 at time @xmath60 , such that @xmath241 in the sense that @xmath242 for all measurable @xmath243 .",
    "similarly , write @xmath244 the disintegration of @xmath85 along @xmath245 .",
    "define then @xmath246 it is a probability measure on @xmath247 , and for any measurable sets @xmath248 in @xmath0 we have @xmath249 because @xmath250 is @xmath3 if @xmath251 , @xmath113 otherwise ( and similarly for @xmath252 ) .",
    "a similar computation gives that @xmath160 has marginals @xmath118 and @xmath85 .",
    "note that we gave the proof for the sake of completness , but one could simply apply twice the gluing lemma , after noticing that the projection @xmath150 from @xmath192 to @xmath0 gives deterministic transport plans in @xmath253 and @xmath254 .",
    "the lift of @xmath255 need not be unique ; the one constructed in the proof is very peculiar , and can be called the _ most independent lift _ of @xmath255 .",
    "it is well defined since other disintegration families @xmath256 and @xmath257 must coincide with @xmath258 and @xmath259 for @xmath169-almost all @xmath43 and @xmath245-almost all @xmath44 respectively .",
    "the lifting lemma shall be used to translate the optimal transport problems between @xmath169 and @xmath245 , where these measures move ( usually along geodesics ) to transport problems between the fixed @xmath118 and @xmath85 , where it is the cost that moves . in other words",
    ", we have just shown that minimizing @xmath260 over the @xmath236 is the same than minimizing @xmath261 over the @xmath237 .",
    "let us denote by @xmath262 the map defined by the formula @xmath263,s(\\gamma ) )          \\end{array}\\ ] ] where @xmath264 is the unitary reparametrization of @xmath64 , @xmath265 $ ] is its asymptote class and @xmath266 is the speed of @xmath64 .",
    "it is to be understood that whenever @xmath267 , @xmath268 $ ] can be taken arbitrarily in @xmath10 and this choice does not matter .",
    "[ defi : asymptotic ] let @xmath269 be a geodesic ray in @xmath1 and @xmath118 be a displacement interpolation ( so that @xmath270 ) .",
    "we define the _ asymptotic measure _ of the ray by @xmath271    we denote by @xmath4 the set of probability measures @xmath119 on @xmath5 such that @xmath272 .    in the branching case , the dynamical optimal transport plan is not unique in general",
    ". therefore , the asymptotic measure depends _ a priori _ on the choice of the dynamical optimal transport plan .",
    "we will see soon that it is not the case .",
    "note that the speed of the geodesic @xmath191 is @xmath273 and we denote it by @xmath274 . in particular , @xmath4 is the set of measures that correspond to unit speed geodesics .",
    "we shall use that the speed function @xmath59 defined in @xmath192 is in @xmath275 several times .",
    "the main result of this section is the following .",
    "[ theo : asymptotic ] consider two geodesic rays @xmath269 and @xmath276 , let @xmath118 and @xmath85 be any of their displacement interpolations and @xmath277 , @xmath278 be the corresponding asymptotic measures",
    ". then @xmath191 and @xmath279 are asymptotic if and only if @xmath280 , and we have @xmath281    therefore : as in @xmath0 itself , the distance between two rays is either bounded or of linear growth , and two displacement interpolations of the same ray define the same asymptotic measure .",
    "the rle of the asymptotic formula goes far beyond justifying definition [ defi : asymptotic ] in the branching case : it gives us a very good control on geodesic rays of @xmath1 on which several of our results rely .",
    "to cite one , the asymptotic formula is the main ingredient of theorem [ theo : intro : rank ] on the rank of @xmath1 .    for every @xmath282 ,",
    "let @xmath283 be the function defined on @xmath284 by @xmath285 .",
    "we start with an implementation of a classical principle .",
    "the function @xmath283 is in @xmath286 , by which we mean that there is a constant @xmath287 such that for all @xmath237 , @xmath288 .    in the following",
    ", it will be of primary importance that @xmath289 does not depend on @xmath160 .    denoting by @xmath43 any base point in @xmath0 we have @xmath290    we shall use several time the following translation of the convexity of the distance function : given any geodesic rays @xmath291 of @xmath0 , the function @xmath292 is nondecreasing in @xmath60 and has limit @xmath293 .",
    "assume first that @xmath280 , and let us prove that @xmath294 is bounded .",
    "the lifting lemma gives us a transport plan @xmath237 such that for all @xmath295 in its support , @xmath296 ( simply lift the trivial transport @xmath297 ) .",
    "if @xmath298 is positive for some @xmath60 , then @xmath299 .",
    "it follows that on @xmath300 , @xmath301 .",
    "therefore : @xmath302 which is bounded by the previous lemma .",
    "let now @xmath303 be a transport plan from @xmath277 to @xmath278 that is optimal with respect to @xmath106 .",
    "such a minimizer exists since @xmath106 is non - negative and lower - semicontinuous with respect to the cone topology of @xmath5 ; note that taking an almost minimizer would be sufficient anyway .",
    "denote by @xmath304 a lift of @xmath303 to @xmath305 ; then @xmath306 we have @xmath307 for all @xmath308 , so that @xmath309 is bounded by @xmath310 and @xmath311 .",
    "we can thus apply the dominated convergence theorem , which gives @xmath312    to prove the other inequality , we introduce @xmath313 .",
    "it is a nondecreasing , nonnegative function with @xmath105 as limit , and it satisfies @xmath314 .",
    "let @xmath255 be an optimal transport plan between @xmath191 and @xmath279 and @xmath315 be a lift to @xmath305 , which by prokhorov theorem is compact in the weak topology .",
    "let @xmath316 be an increasing sequence such that @xmath317 and @xmath318 weakly converges to some @xmath319 .    for all @xmath320 , we have @xmath321 letting @xmath322 and using that the @xmath323 are continuous , we obtain @xmath324 for all @xmath325 . but @xmath326 and the dominated convergence theorem enables us to let @xmath327 : @xmath328 this ends the proof of the asymptotic formula , and shows that if @xmath191 and @xmath279 stay at bounded distance then @xmath280 .",
    "the end of this part consists in the investigation of two questions where the asymptotic formula finds applications , but from which the sequel is independent .",
    "the reader interested in the topology of @xmath1 can go directly to part [ part : boundary ] .",
    "in this section we study complete geodesics in @xmath1 , in particular to understand its rank . recall that the _ rank _ of a metric space is the highest dimension of a euclidean space that embeds isometrically in it .    the main result of this section is the following .",
    "[ theo : rank ] if @xmath0 is a visibility space , in particular if it is @xmath96 with @xmath97 , then @xmath1 has rank @xmath3 .",
    "we expect more generally that for all hadamard space @xmath0 , the rank of @xmath1 is equal to the rank of @xmath0 , or at least bounded above by some weak rank of @xmath0 .",
    "theorem [ theo : rank ] is a first step in this direction .",
    "note that the fact that we ask the embedding to be nothing weaker than an isometry and to be global is important : it is easy to prove that as soon as @xmath0 contains a complete geodesic , it admits bi - lipschitz embedding of euclidean spaces of arbitrary dimension , and isometric embeddings of euclidean balls of arbitrary radius and dimension .",
    "both these facts come from an isometric embeeding of open euclidean half - cone of arbitrary dimension into @xmath16 , see @xcite .",
    "first , let us see that the asymptotic measure of a complete geodesic is much more constraint than that of a mere ray .",
    "[ prop : completegeodesics ] let @xmath329 be a complete unit speed geodesic of @xmath1 , and @xmath118 be one of its displacement interpolations . then @xmath118 is concentrated on the set of _ unit speed _ geodesics of @xmath0 .    note that here we do not use any assumption on @xmath0 ( besides the existence of displacement interpolations ) .",
    "let @xmath291 be two geodesics in the support of @xmath118 and let @xmath330 and @xmath331 .",
    "fix some point @xmath78 .",
    "then we have the equivalents @xmath332 and @xmath333 when @xmath334 .",
    "in particular , we get that @xmath335 and similarly @xmath336 .",
    "we also have @xmath337 and @xmath338 .",
    "but , since @xmath118 is the displacement interpolation of a geodesic , the transport plan @xmath339 it induces from @xmath169 to @xmath340 must respect the cyclical monotonicity .",
    "in particular we have @xmath341 from this and letting @xmath342 we get @xmath343 , which is only possible when @xmath344 .",
    "we proved that the speed of geodesics in the support of @xmath118 is constant , and since their square integrates ( with respect to @xmath118 ) to @xmath3 we get the desired conclusion .    as a consequence ,",
    "the assymptotic measure of a ray that can be extended to a complete geodesic lies in the subset @xmath345 of @xmath4 ( where we identify a space @xmath19 with the level @xmath346 in its cone ) .",
    "[ prop : snowflaked ] if @xmath0 is a visibility space , the space @xmath345 endowed with the metric @xmath143 ( where a ray is identified with its asymptotic measure ) contains no non - constant rectifiable curve .",
    "first , the visibility assumption implies that whenever @xmath64 and @xmath65 are non asymptotic , unit speed geodesic rays of @xmath0 , we have @xmath347 .",
    "it follows that for all displacement interpolation @xmath348 of rays in @xmath1 , assumed to be concentrated on @xmath349 , we have @xmath350 where @xmath351 is the total variation norm .",
    "the proposition now results from the more general following lemma , which is well - known at least in the case of euclidean space .",
    "let @xmath115 be any metric space and @xmath352 be a positive number .",
    "then @xmath353 is a metric space not containing any non - constant rectifiable curve .",
    "the fact that @xmath354 is a metric comes from the inequality @xmath355 for positive @xmath356 .",
    "let @xmath23 be a non - constant curve .",
    "up to restriction and reparametrization , we can assume that @xmath357 $ ] and @xmath358 .",
    "take any positive integer @xmath359 ; since @xmath360 is continuous , by the intermediate value theorem there are numbers @xmath361 such that @xmath362 and @xmath363 . denoting by @xmath364 the length according to the `` snowflaked '' metric @xmath354",
    ", we get that @xmath365 since this holds for all @xmath359 , @xmath366 and @xmath132 is not rectifiable .",
    "assume that there is an isometric embedding @xmath367 .",
    "let @xmath368 be the ray starting at the origin and making an angle @xmath369 with some fixed direction .",
    "then , since @xmath368 extends to a complete geodesic , so does @xmath370 .",
    "the displacement interpolation @xmath371 of this ray of @xmath1 must be concentrated on @xmath349 by proposition [ prop : completegeodesics ] , so that @xmath372 . but @xmath373 being isometric , the map @xmath374 should be an isometric embedding from the boundary of @xmath47 ( that is , the unit circle endowed with the chordal metric ) to @xmath375 .",
    "in particular its image would be a non - constant rectifiable curve , in contradiction with proposition [ prop : snowflaked ] .    to prove theorem [ theo : rank ]",
    ", one could also simply consider the three euclidean geodesics depicted in figure [ fig : flat ] and check that their relative distances can not be realized in @xmath345 endowed with @xmath143 .",
    "however , our method yields easily more general results : to give two simple examples , proposition [ prop : snowflaked ] rules out the isometric embedding of minkowski planes ( @xmath47 endowed with any norm ) , and their cones of the form @xmath376 for any @xmath221 .",
    "this contrast with above - mentionned fact that even when @xmath0 is reduced to a line , some euclidean _ half _ cones of arbitrary dimension embeds isometrically in @xmath1 .",
    "a complete geodesic @xmath191 in @xmath1 defines two rays ( for @xmath377 and @xmath282 ) , and one therefore gets two asymptotic measures , denoted by @xmath378 and @xmath379 , also called the _ ends _ of the geodesic . by proposition [ prop : completegeodesics ] ,",
    "these measures are concentrated on @xmath10 viewed as a subset of @xmath5 . in particular",
    ", @xmath1 is already far from being a visibility space .",
    "one can ask how far precisely :    [ ques : ends ] which pairs of probability measures on @xmath10 are the ends of some complete geodesic ?    note that we shall need to consider measures @xmath118 on the set of unit complete geodesics @xmath380 that satisfy the cyclical monotonicity , but such that @xmath381 need not have finite second moment .",
    "we still call such maps dynamical transport plan and we say that @xmath382 are its ends .",
    "such a measure defines a complete unit geodesic in @xmath1 if and only if @xmath383 for some , hence all @xmath384 . note that in this section , we only consider _ unit _ geodesics even if it is not stated explicitely",
    ".      the asymptotic formula shall give us a first necessary condition .",
    "two points @xmath385 are said to be _ antipodal _ if they are linked by a geodesic , that is if @xmath386 .",
    "two sets @xmath387 are _ antipodal _ if all pairs @xmath388 are antipodal .",
    "two measures @xmath389 on @xmath10 are _ antipodal _ when they are concentrated on antipodal sets .",
    "they are said to be _ uniformly antipodal _ if their supports are antipodal .",
    "note that @xmath10 is compact when endowed with the cone topology , so that the supports of @xmath390 are compact .",
    "if @xmath0 is a visibility space , then antipodality is equivalent to disjointness ; in particular two measures are then uniformly antipodal if and only if they have disjoint supports .    given a complete unit geodesic @xmath118 , the asymptotic formula implies that @xmath391 , so that _ the ends of any complete unit geodesic of @xmath1 must be antipodal_.    we shall now give a complete answer to question [ ques : ends ] in the case when @xmath0 is a tree .",
    "in particular , we will see that all pairs of uniformly antipodal measures , but not all pairs of merely antipodal ones , are the ends of a complete geodesic .",
    "we shall in fact give two characterizations of ends of complete geodesics , but this will need a fair amount of definitions .      from now on , @xmath0 is assumed to be a tree , described as a graph by a couple @xmath392 where : @xmath393 is the set of vertices ; @xmath394 is the set of edges , each endowed with one or two endpoints in @xmath393 and a positive length .",
    "since @xmath0 is assumed to be complete , the edges with only one endpoint are exactly those that have infinite length . since @xmath0 is locally compact , as a graph it is locally finite .",
    "it is assumed that vertices are incident to @xmath3 or at least @xmath395 edges , so that the combinatorial description of @xmath0 is uniquely determined by its metric structure .",
    "we also fix a base point @xmath396 .",
    "the following definition is the key to characterize cyclically monotone dynamical transport plans .",
    "we say that two geodesics are _ antagonist _ if there are two distinct points @xmath397 such that one of the geodesics goes through @xmath43 and @xmath44 in this order , and the other goes through the same points in the other order .",
    "this amounts to say that there is an edge followed by both geodesics , but in opposite directions .",
    "the point is that for a dynamical transport plan @xmath118 , not having pairs of antagonist geodesic in its support will prove both a very restrictive condition and a characterization of cyclical monotonicity .",
    "we add to each infinite end a formal endpoint at infinity to unify notations .",
    "each edge @xmath398 has two orientations @xmath399 and @xmath400 where @xmath397 are its endpoints .",
    "the complement in @xmath82 of the interior of an edge @xmath398 of endpoints @xmath397 has two components @xmath401 and @xmath402 .",
    "an orientation , @xmath399 say , of an edge has a _ future _ @xmath403 and a _ past _ @xmath404 . in other words ,",
    "the future of @xmath399 is the set of all possible endpoints of a complete ray passing through @xmath43 and @xmath44 in this order .",
    "assume @xmath405 and @xmath406 are antipodal measures on @xmath10 .",
    "define a signed measure by @xmath407 .",
    "the _ flow _ ( defined by @xmath408 ) through an oriented edge @xmath399 is @xmath409 .",
    "the flow gives a natural orientation of edges : an oriented edge is _ positive _ if its flow is positive , _",
    "neutral _ if its flow is zero , and _ negative _ otherwise , see figure [ fig : tree ]",
    ".    given a vertex @xmath43 , let @xmath410 be the neighbors of @xmath43 such that @xmath411 is positive , and @xmath412 be the neighbors of @xmath43 such that @xmath413 is negative . then @xmath414 is called the flow through @xmath43 and is denoted by @xmath415 .",
    "if @xmath416 , then there is a unique edge starting at @xmath43 along which the distance to @xmath83 is decreasing .",
    "if this edge is a positive one , @xmath417 say , then define the _ specific flow _ through @xmath43 as @xmath418 .",
    "if this edge is a negative one , @xmath419 , then let @xmath420 . if this edge is neutral or if @xmath421 , then let @xmath422 .",
    "note that since @xmath423 is a partition of @xmath10 and @xmath119 has zero total mass , we have @xmath424 the flow through an edge vanishes if one of the connected component of its complement is finite ( but this is not a necessary condition ) .",
    "the next result shows the meaning of flows with regard to our problem .",
    "given a dynamical transport plan @xmath118 , we denote by @xmath425 the @xmath118-measure of the set of geodesics that go through an edge @xmath399 in this orientation , by @xmath426 the @xmath118-measure of the set of geodesics that pass at @xmath43 , and by @xmath427 the @xmath118-measure of those that are moreover closest to @xmath83 at this time .",
    "[ lemm : flows ] if @xmath118 is any dynamical transport plan with ends @xmath390 , then :    1 .   for all edge",
    "@xmath399 we have @xmath428 , 2 .   for all vertex",
    "@xmath43 we have @xmath429 .    and",
    "each of these inequality is an equality for all @xmath399 , respectively @xmath43 , if and only if @xmath118 contains no pair of antagonist geodesics in its support . in this case",
    ", we moreover have @xmath430 for all @xmath43 .",
    "note that the set of geodesics that go through an edge @xmath399 in this orientation is open in @xmath431 , so that @xmath118 contains no pair of antagonist geodesics in its support if and only if @xmath432-almost no pair of geodesics are antagonist .",
    "we only prove the first point , the other ones being similar .",
    "denote by @xmath433 the measure of the set of geodesic that lie entrirely in @xmath434 .",
    "we have @xmath435 and @xmath436 it follows that @xmath437 so that @xmath438 . moreover",
    "the case of equality @xmath439 implies that @xmath440 whenever @xmath441 , and we get the conclusion .    from this",
    "we deduce in particular a characterization of cyclical monotonicity .",
    "[ lemm : antagonism ] a dynamical transport plan @xmath118 is @xmath442-cyclically monotone if and only if @xmath432-almost no pairs of geodesics are antagonist .",
    "assume that the support of @xmath118 contains two antagonist geodesics @xmath291 and let @xmath397 be points such that @xmath443 where @xmath444 and @xmath445 where @xmath446 .",
    "let @xmath447 and @xmath448",
    ". then ( see figure [ fig : nonoptimal ] ) @xmath449 so that the transport plan @xmath450 between @xmath451 and @xmath452 would not be cyclically monotone .",
    "assume now that @xmath432-almost no pairs of geodesics are antagonist .",
    "let @xmath453 be a function that is continuous , increasing isometric on each positive edge and constant on neutral edges .",
    "such a function can be defined locally around any point , and we can design it globally since @xmath0 has no cycle . by lemma [ lemm :",
    "flows ] , we see that @xmath454 is isometric when restricted to any geodesic in the support of @xmath118 ( such a geodesic must go through positive edges only ) . given times @xmath455 , the only @xmath456-cyclically monotone transport plan in @xmath35 from @xmath457 to @xmath458 is known to be the increasing rearrangement by convexity of the cost . here",
    "@xmath458 is the @xmath459 translate of @xmath457 , so that this transport plan has cost @xmath460 .",
    "but @xmath454 is @xmath3-lipschitz , so that any transport plan from @xmath451 to @xmath452 has cost at least @xmath460 .",
    "this proves the cyclical monotonicity of @xmath118 .",
    "note that here for example , @xmath451 and @xmath452 need not have finite second moment ; however @xmath118 induces a transport plan with finite cost between them , and that peculiarity has therefore no incidence on the proof .",
    "before we state the main result of this section , let us turn to a different point of view that might generalize to a wider class of spaces .",
    "given @xmath461 in @xmath10 , we denote by @xmath462 the locus of a geodesic whose ends are @xmath463 and @xmath464 .",
    "then we write @xmath465 the distance between the base point @xmath83 and the geodesic @xmath466 . since @xmath0 is a tree ,",
    "this quantity is equal to what is usually called the _ gromov product _ @xmath467 , see e.g. @xcite ; however the present definition is adapted to our needs . set @xmath468 and denote by @xmath469 the parametrized unit complete geodesic whose ends are @xmath470 at @xmath471 , and such that its time @xmath113 realizes @xmath472 :",
    "@xmath473    an important property of the gromov product is that for any @xmath221 , @xmath474 metrizes the cone topology on @xmath10 .",
    "in particular , @xmath475 if and only if @xmath476 .",
    "moreover , by compactness of @xmath10 , if @xmath477 then there are increasing indices @xmath478 such that @xmath479 and @xmath480 converge to a common point .",
    "another obvious consequence is that @xmath472 is continuous , and one can even check that it is locally constant outside the diagonal .",
    "a motivation for using gromov product here is that it generalizes ( with some differences though ) to a much more general class of spaces , called gromov - hyperbolic , including all @xmath481 hadamard spaces .",
    "one could hope to extend part of theorem [ theo : endsrealizability ] below to this class of spaces .",
    "[ lemm : d0proper ] the map @xmath482 is continuous .    recall that @xmath380 is endowed with the topology of uniform convergence on compact subsets .",
    "since we are dealing with metrizable topologies , we only have to check sequential continuity .",
    "assume @xmath483 and @xmath484 are two converging sequences in @xmath10 and set @xmath485 , @xmath486 .",
    "for any @xmath487 , for any large enough @xmath359 , we have that the rays from @xmath488 to @xmath489 and to @xmath110 coincide on @xmath490 $ ] .",
    "the same property holds true with @xmath80 s .",
    "the union of @xmath491 , @xmath492 and @xmath493 is therefore a geodesic , thus must be the locus of @xmath494 . now @xmath495 is uniformly bounded by @xmath496 for @xmath359 large enough .",
    "it follows that @xmath497 lies on @xmath64 , so that by definition @xmath498 and finally @xmath64 and @xmath499 coincide on @xmath500 $ ] for @xmath359 large enough .    since @xmath501 is a right inverse to @xmath502 , a transport plan @xmath503",
    "can always be written @xmath504 by taking @xmath165 .",
    "we shall denote also by @xmath472 the map @xmath505 where @xmath64 is any parametrized or unparametrized complete geodesic .",
    "[ lemm : antagonism2 ] a transport plan @xmath506 such that @xmath507 is @xmath508-cyclically monotone if and only if @xmath509 contains no pair of antagonist geodesics in its support . in this case",
    ", @xmath510 is a solution to the optimal transport problem @xmath511    note that the first statement can be recast in the following terms : a dynamical transport plan @xmath118 with ends @xmath390 and such that @xmath512 is @xmath508-cyclically monotone if and only if it contains no pair of antagonist geodesics in its support .",
    "consider @xmath506 and let @xmath513 .",
    "assume first that there are antagonist geodesics @xmath291 in the support of @xmath118 .",
    "then permuting @xmath514 and @xmath515 contradicts the @xmath508-cyclical monotonicity .    to prove the other implication ,",
    "assume that @xmath516 contains no pair of antagonist geodesics but that @xmath510 does not achieve the infimum in .",
    "this happens notably when @xmath510 is not cyclically monotone .",
    "then there is some @xmath517 such that @xmath518 if @xmath519 has couples of antagonist geodesics in its support , then we can still improve @xmath520 .",
    "choosing any numbering @xmath521 of the non - oriented edges of @xmath0 , we inductively construct transport plans @xmath522 in @xmath523 such that @xmath524 has no antagonist geodesics through the edges @xmath525 in its support , and @xmath526 is stochastically dominated by @xmath527 ( for all @xmath528 going through @xmath529 in the negative direction , replace @xmath110 by some @xmath111 in the future of @xmath529 and corresponding to a @xmath530 , and replace @xmath531 by @xmath532 ; there are many choices to do but they can be made in a arbitrary manner ) .",
    "then we get @xmath533 where some , or even all of this integrals can be negative infinite .",
    "we shall use a weak convergence , but @xmath508 is not bounded ; we therefore introduce the functions @xmath534 for all @xmath535 .",
    "the transport plans @xmath536 also satisfy @xmath537 for all @xmath223 .    since @xmath10 is compact , so is @xmath523 and we can extract a subsequence of @xmath538 that weakly converges to some @xmath304 , and @xmath539 has no pair of antagonist geodesics in its support .",
    "the montone convergence theorem implies that for @xmath223 large enough , we have @xmath540 , and by weak convergence we get @xmath541 . since @xmath542 , we get @xmath543 but then by lemma [ lemm : flows ] we get that @xmath544 for all @xmath545 , and since @xmath546 it follows that @xmath547 and @xmath548 must be equal , a contradiction .",
    "note that the lemma stays true if @xmath508 is replaced with any decreasing function of @xmath472 , but that we shall need precisely @xmath508 later .    in this proof",
    "we can not use theorem 4.1 of @xcite since we do not have the suitable lower bounds on the cost .",
    "we can now state and prove the answer to question [ ques : ends ] in the case of trees .",
    "[ theo : endsrealizability ] assume that @xmath0 is a tree and let @xmath405 , @xmath406 be two antagonist measures on @xmath10 .",
    "the following are equivalent :    * there is a complete geodesic in @xmath1 with @xmath390 as ends ; * the optimal transport problem is finite : @xmath549 * the specific flow defined by @xmath390 satisfies @xmath550    when these conditions are satisfied , then the optimal transport problem has a minimizer @xmath510 and @xmath551 define a geodesic of @xmath1 with the prescribed ends .",
    "moreover , the above conditions are satisfied as soon as @xmath390 are uniformly antipodal .",
    "first assume that there is a complete geodesic in @xmath1 with @xmath390 as ends and denote by @xmath118 one of its displacement interpolations ; by lemma [ lemm : antagonism ] , the support of @xmath118 does not contain any pair of antagonist geodesics",
    ". from lemma [ lemm : flows ] it follows that @xmath552 since by hypothesis @xmath553 .",
    "we have also @xmath554 so that lemma [ lemm : antagonism2 ] implies that @xmath555 is a solution to problem [ eq : d02problem ] .",
    "now consider the case when @xmath390 are uniformly antipodal .",
    "since the supports of @xmath556 and @xmath557 are disjoint , the map @xmath472 , when restricted to @xmath558 , is bounded .",
    "therefore , since it is a continuous map , the optimal mass transport problem is well - posed and admits minimisers .",
    "more generally when the infimum in problem is finite , by using the regularity of borel probability measures on @xmath10 we can approximate @xmath556 and @xmath557 by probability measures whose supports are disjoint sets .",
    "then , the previous paragraph gives us a sequence of plans which are @xmath508-cyclically monotone .",
    "since @xmath472 is a continuous map , prokhorov s theorem allows us to extract a converging subsequence whose limit @xmath510 is @xmath508-cyclically monotone . by the finitness assumption , @xmath559 and @xmath510 is a @xmath508-optimal transport plan .",
    "as soon as a minimizer @xmath510 to exists , by lemma [ lemm : antagonism2 ] @xmath560 is a dynamical transport plan that has no antagonist pair of geodesics in its support . by lemma [ lemm : antagonism ]",
    "@xmath118 is cyclically monotone . by its definition @xmath561 so that @xmath118 defines a geodesic of @xmath1 .",
    "it has the prescribed ends since @xmath506 .",
    "we have only left to consider the case when @xmath562 . for this , let us construct a suitable complete geodesic by hand .",
    "let @xmath454 be the time function such that @xmath563 , as in the proof of lemma [ lemm : antagonism ] .",
    "the levels of the time function are finite unions of isolated points and of subtrees of @xmath0 all of whose edges are neutral .",
    "indeed , consider a point @xmath564 : if it lies inside a neutral edge , then all the edge has time @xmath565 .",
    "otherwise , let @xmath399 be the orientation of this edge that is positive : points on @xmath566 have time lesser than @xmath565 , while points on @xmath567 $ ] have time greater than @xmath565 .",
    "if @xmath564 is a vertex , then similarly one sees that nearby @xmath564 , only the points lying on an incident neutral edge can have time equal to @xmath565 .",
    "let @xmath568 be the union of the isolated points of the level @xmath569 and of the points that lie ( in @xmath0 ) on the boundary of the neutral subtrees of the same level .",
    "in other words , @xmath568 is the level @xmath60 of the map induced by @xmath454 on the subforest of @xmath0 where all neutral edges have been removed .",
    "define now @xmath570 where @xmath571 if @xmath564 lies inside a positive edge @xmath399 . note that @xmath572 is a probability measure thanks to the antipodality of @xmath405 and @xmath406 : without it , it would have mass less than @xmath3 .",
    "it is a good first candidate to be the geodesic we are looking for , except the second moment of @xmath169 need not be finite ! to remedy this problem , proceed as follows .",
    "first , there is a displacement interpolation @xmath573 of @xmath574 , which is a probability measure on @xmath380 .",
    "now , construct a random geodesic @xmath64 as follows : draw @xmath575 with law @xmath573 , and let @xmath64 be the geodesic that has the same geometric locus and the same orientation as @xmath575 , and such that @xmath64 is nearest to @xmath83 at time @xmath113 .",
    "the condition @xmath562 ensures that the law of @xmath488 has finite second moment .",
    "the example shown in figure [ fig : notends ] shows that antipodality is not sufficient for @xmath390 to be the ends of a geodesic .",
    "[ part : boundary ] in this part , we adapt to @xmath1 the classical construction of the cone topology on hadamard space , see for instance @xcite .",
    "we introduce this topology on @xmath9 .",
    "we shall prove in proposition [ prop : conetop ] that the cone topology turns @xmath12 into a first - countable hausdorff space and that the topology induced on @xmath1 coincides with the topology derived from the wassertein metric .    in the second part",
    ", we shall show in theorem [ theo : homeobound ] that @xmath6 is homeomorphic to @xmath576 endowed with the weak topology . in corollary [ coro : homeo ] , we rewrite the above result in terms of wassertein space over @xmath141 .    throughout this part",
    ", we will use the following notations .",
    "let @xmath115 be a geodesic space and @xmath577 .",
    "we set @xmath578 ( respectively @xmath579 ) the set of geodesic rays in @xmath19 starting at @xmath44 ( respectively the set of unitary geodesic rays starting at @xmath44 ) .",
    "these sets are closed subsets of @xmath36 endowed with the topology of uniform convergence on compact subsets .",
    "the cone topology on @xmath9 is defined by using as a basis the open sets of @xmath1 together with @xmath580 where @xmath581 is a fixed point , @xmath110 runs over @xmath6 , @xmath582 and @xmath583 run over @xmath584 and @xmath585 is the unitary geodesic between @xmath586 and @xmath369 ( existence and uniqueness follow from lemma [ lemm : existray ] ) .",
    "the main properties of the cone topology on @xmath12 are gathered together in the following proposition .",
    "[ prop : conetop ] the cone topology on @xmath12 is well - defined and is independent of the choice of the basepoint @xmath586 .",
    "moreover , endowed with this topology , @xmath12 is a first - countable hausdorff space . by definition , the topology induced on @xmath1 coincides with the topology derived from the wassertein metric .",
    "[ rema : firstc ] we emphasize that the topology induced on @xmath587 by the cone topology coincides with the quotient topology induced by the topology of uniform convergence on compact subsets on the set of unitary rays in @xmath1 .",
    "moreover , since @xmath587 endowed with the cone topology is first - countable , continuity and sequential continuity are equivalent in this topological space .",
    "the scheme of proof is the same as in the nonpositively curved case .",
    "however , to get the result , we first need to generalize to our setting some properties related to nonpositive curvature .",
    "[ lemm : existray ] given @xmath581 , the set of unitary rays in @xmath1 starting at @xmath586 is in one - to - one correspondence with the set @xmath588 .",
    "moreover , for any @xmath589 , there exists a unique unitary ray starting at @xmath586 and belonging to @xmath110 .",
    "recall that there exists a unique transport plan between a dirac mass and any measure in @xmath1 .",
    "since there is a unique geodesic between two given points in @xmath0 , the same property remains true for dynamical transportation plans .",
    "using the previous remarks , we get that any @xmath590 such that @xmath591 induces a ray starting at @xmath586 .",
    "moreover , since displacement interpolation always exists ( see proposition [ prop : displacement ] ) , the set @xmath592 is in one - to - one correspondence with the unitary dynamical transportation plans starting at @xmath586 , namely the measures @xmath593 such that @xmath594 .",
    "now , since @xmath0 is a hadamard space , we recall that @xmath192 is homeomorphic to @xmath595 ( where the left coordinate is the initial location of the ray ) . therefore , for any @xmath581",
    ", the previous map induces a homeomorphism @xmath596 this gives us a one - to - one correspondence between the set of unitary dynamical transportation plans starting at @xmath586 and the set @xmath588 .",
    "given @xmath597 , consider a unit ray @xmath191 in @xmath1 belonging to @xmath110 and @xmath598 its asymptotic measure .",
    "we claim that @xmath599 is the unique ray starting at @xmath586 and belonging to @xmath110 .",
    "indeed , @xmath599 and @xmath191 have the same asymptotic measure , thus they are asymptotic thanks to the asymptotic formula ( theorem [ theo : asymptotic ] ) .",
    "the asymptotic formula also implies that two asymptotic rays ( starting at @xmath586 ) have the same asymptotic measure , thus they are equal by the first part of the lemma .",
    "[ lemm : triangle ] let @xmath600 be two unitary geodesics ( possibly rays ) in @xmath1 starting at @xmath586 .",
    "then , for any nonnegative s , t , the comparison angle @xmath601 at @xmath586 of the triangle @xmath602 is a nondecreasing function of @xmath59 and @xmath60 .",
    "consequently , the map @xmath603 is a nondecreasing function as well .",
    "we set @xmath604 the length of @xmath191 and @xmath279 respectively and @xmath118 , @xmath85 the corresponding optimal dynamical plans .",
    "thanks to the lifting lemma , we set @xmath605 a dynamical plan such that , for given @xmath606 and @xmath607 , @xmath608 is an optimal plan .",
    "by definition of the wassertein distance , we get , for any @xmath609 and @xmath610 , the following estimate @xmath611 now , the fact that @xmath0 is nonpositively curved yields @xmath612 where @xmath613 is the comparison angle at @xmath43 ( here , we use the fact that the initial measure is a dirac mass ) . by integrating this inequality against @xmath614 , we get @xmath615 we conclude by noticing that the inequality above is an equality when @xmath616 and @xmath617 , so we get @xmath618 which is equivalent to the property @xmath619 .",
    "the remaining statement follows readily .",
    "[ lemm : suppi ] let @xmath191 be a unitary geodesic , possibly a ray , starting at @xmath620 and @xmath621 . for any @xmath622 such that @xmath623 , the comparison angle at @xmath369 satisfies @xmath624 moreover , given two nonnegative numbers @xmath625 , the following inequality holds for @xmath626 @xmath627    for any @xmath628 , the following equality holds @xmath629 by integrating this inequality against @xmath369 , we get the first statement by definition of the comparison angle .",
    "let @xmath118 be the unique optimal dynamical coupling that induces @xmath191 .",
    "the first step of the proof is to get the equality below : @xmath630 for @xmath631 , the following equality holds @xmath632 by integrating this equality against @xmath118 , we get ( [ equa : angleint ] ) .",
    "now , using that @xmath0 is nonpositively curved , we have @xmath633 .",
    "this gives @xmath634 where the last inequality follows from the first statement and the result is proved .    as a consequence ,",
    "we get the following result .    [ prop : convray ] given @xmath126 , @xmath635 , and @xmath487 , there exists a constant @xmath636 such that the followings holds : for any @xmath637 such that @xmath638 and a unitary geodesic ( possibly a ray ) @xmath191 of length greater than @xmath223 and starting at @xmath620 , if @xmath639 is the unitary geodesic from @xmath586 to @xmath452 then @xmath640 for any @xmath641 .",
    "in particular , if @xmath191 is a ray and @xmath59 goes to infinity , @xmath642 converges uniformly on compact subsets to the unitary ray @xmath643 where @xmath110 is the asymptote class of @xmath191 .    under these assumptions ,",
    "the comparison angle @xmath644 is arbitrary small provided @xmath59 is sufficiently large .",
    "consequently , thanks to lemma [ lemm : suppi ] , @xmath645 is close to @xmath646 ; therefore the comparison angle @xmath647 is small .",
    "this gives the first part of the result since @xmath648 thanks to lemma [ lemm : triangle ] .",
    "using lemma [ lemm : triangle ] again , it only remains to prove the pointwise convergence of @xmath642 to @xmath649 .",
    "thanks to the asymptotic formula , there exists @xmath650 such that @xmath651 for any nonnegative number @xmath60 . finally , we conclude by using @xmath652 sufficiently large and the bound @xmath653 where the same reasoning as above and ( [ equa : bound ] ) show that the first term on the right - hand side is small provided @xmath652 is large .",
    "now , we can prove that the topology above is well - defined and does not depend on the choice of the base point @xmath586 .",
    "this the content of the lemma below .    given two positive numbers @xmath654 and @xmath655 , @xmath656 , there exists @xmath657 such that @xmath658    we set @xmath659 .",
    "let @xmath660 and @xmath614 ( respectively @xmath661 ) be the unitary geodesic @xmath662 ( respectively the unitary ray @xmath663 ) .",
    "we have    @xmath664    the first and the third term on the right - hand side are smaller than @xmath665 for large @xmath666 thanks to proposition [ prop : convray ] while the second term is smaller than @xmath665 for large @xmath666 and small @xmath667 thanks to lemma [ lemm : triangle ] .",
    "to state the main result of this part , we first need to introduce a definition .",
    "we set @xmath668 the map that send a unitary ray starting at @xmath586 to its asymptotic measure .",
    "the main result of this part is the following theorem .",
    "[ theo : homeobound ] the map @xmath669 induces a homeomorphism from @xmath11 onto @xmath588 .    note that a straightforward consequence of the result above is    [ coro : homeo ] let @xmath360 be a metric on @xmath10 that induces the cone topology on @xmath10 and @xmath670 the cone metric induced by @xmath360 on @xmath5 ( see ( [ equa : conemetric ] ) for a definition ) .",
    "let us denote by @xmath671 the quadratic wassertein space over the polish space @xmath672 .",
    "then , @xmath11 is homeomorphic to the subset of probability measures with unitary speed in @xmath671 .",
    "in particular we get the more symmetric result that @xmath673 is homeomorphic to @xmath671 .",
    "the rest of this part is devoted to the proof of the theorem above .",
    "recall that we have proved in lemma [ lemm : existray ] that both @xmath674 and the map @xmath675 it induces are bijective .",
    "the proof of theorem [ theo : homeobound ] is in two steps .",
    "first , we prove that the map @xmath676 is a homeomorphism .",
    "then , we use this fact to prove that @xmath677 is a homeomorphism as well .    we start the proof with a definition .",
    "let @xmath581 .",
    "we denote by @xmath678 the set of unitary dynamical transport plans endowed with the weak topology .",
    "we also set @xmath679 and @xmath680 where @xmath681 is defined in ( [ equa : phix ] ) .    thanks to lemma [ lemm : existray ] ,",
    "we have the following commutative diagram where all the maps are one - to - one .",
    "@xmath682    we first prove that    the map @xmath683 is a homeomorphism onto @xmath588 .",
    "the map @xmath684 is a homeomorphism .",
    "therefore it induces a homeomorphism between @xmath685 and @xmath588 when endowed with the weak topology .",
    "[ lemm : odt ] the map @xmath686 is a continuous map .    since the spaces we consider are metrizable",
    ", we just have to prove the sequential continuity .",
    "consequently , we are given a sequence @xmath687 such that @xmath688 in @xmath685 .",
    "now , since @xmath689 is a continuous map , we get that @xmath690 in @xmath691 . by definition of @xmath685 ,",
    "we have @xmath692 since @xmath693 , the equality above implies the convergence of the second moment .",
    "namely , we have @xmath694 this implies the convergence of @xmath695 to @xmath696 with respect to the wassertein distance ( see for instance @xcite ) .",
    "thus , we have proved the pointwise convergence of rays .",
    "now , since @xmath697 is nondecreasing as proved in lemma [ lemm : triangle ] , we get the result .",
    "we end the first part of the proof with the following lemma .",
    "[ lemm : odt2 ] the map @xmath686 is a homeomorphism .    since the topology of both @xmath592 and @xmath685 is induced by a metric , it is sufficient to prove that @xmath698 is a proper map .",
    "moreover , we just have to prove sequential compactness .",
    "we set @xmath699 a compact subset of @xmath700 .",
    "let @xmath701 .",
    "we first notice that @xmath687 is tight .",
    "indeed , by assumption on @xmath229 , the sequence @xmath702 is tight in @xmath703 .",
    "therefore , by arguing as in the end of the proof of proposition [ prop : displacement ] , we obtain the claim . consequently ,",
    "since @xmath704 is a polish space , we can apply prokhorov s theorem to get a converging subsequence @xmath705 to @xmath706 .",
    "it remains to prove that @xmath707 , namely that @xmath708 .",
    "since @xmath229 is compact , we can also assume without loss of generality that @xmath709 in @xmath710 .",
    "moreover , since @xmath711 for any @xmath60 , we get @xmath712 .",
    "therefore , @xmath713 in @xmath1 .",
    "this implies the convergence of the second moment @xmath714 ( see for instance @xcite ) and the result is proved .",
    "we are now in position to prove theorem [ theo : homeobound ] .",
    "we set @xmath715 the canonical projection on @xmath716 .",
    "we have the following commutative diagram .",
    "@xmath717 we have seen at the beginning of the proof that all the maps above are one - to - one . to conclude , it remains to prove that @xmath718 is a continuous map . since @xmath6 is first - countable ( see remark [ rema : firstc ] ) , it is sufficient to prove sequential continuity .",
    "to this aim , let @xmath719 in @xmath6 and @xmath720 such that @xmath721 and @xmath722 . recall that under these assumptions , the map @xmath723 is nondecreasing ( see lemma [ lemm : triangle ] ) , thus we just have to show the pointwise convergence of @xmath724 .",
    "this pointwise convergence follows readily from the definition of the cone topology on @xmath12 .",
    "[ part : isometries ]",
    "in this part we study the isometry group of @xmath1 . we have a natural morphism @xmath725 an isometry @xmath726 of @xmath1",
    "is said to be _ trivial _ if it is in the image of @xmath727 , to _ preserve shape _ if for all @xmath728 there is an isometry @xmath373 ( depending on @xmath118 ) of @xmath0 such that @xmath729 , and to be _",
    "exotic _ otherwise .",
    "when all isometries of @xmath1 are trivial , that is when @xmath727 is an isomorphism , we say that @xmath1 is _ isometrically rigid_.    the main result of this part is the following .",
    "[ theo : isometry ] let @xmath0 be a geodesically complete , negatively curved hadamard space . if    1 .",
    "@xmath0 is a tree , or 2 .",
    "[ enumi : isom2 ] @xmath0 is a riemannian manifold , or more generally 3 .",
    "[ enumi : isom3 ] there is a dense subset of @xmath0 all of whose points admit a neighborhood isometric to an open subset of a riemannian manifold of dimension at least @xmath730 ,    then @xmath1 is isometrically rigid .    by `` negatively curved '' we mean that @xmath0 is not a line and the @xmath51 inequality is strict except for triangles all of whose vertices are aligned .",
    "note that when @xmath0 is euclidean , @xmath1 is not isometrically rigid as proved in @xcite .",
    "the @xmath17 building , as well as many polyhedral complexes whose faces are endowed with hyperbolic metrics , provide examples of isometric rigidity covered by the third case of the theorem .",
    "the strategy of proof is as follows : we show first that an isometry must map dirac masses to dirac masses .",
    "the method is similar to that used in the euclidean case , and is valid for geodesically complete locally compact spaces without curvature assumption .",
    "it already yields corollary [ coro : isometry ] , answering positively in a wide setting the following question : if @xmath20 and @xmath21 are isometric , can one conclude that @xmath19 and @xmath22 are ?",
    "the second step is to prove that an isometry that fixes all dirac masses must map a measure supported on a geodesic to a measure supported on the same geodesic .",
    "here we use that @xmath0 has negative curvature : this property is known to be false in the euclidean case .    then as in @xcite we are reduced to prove the injectivity of a specific radon transform .",
    "the point is that this injectivity is known for @xmath731 and is easy to prove for trees , but seems not to be known for other spaces .",
    "we give a partial but sufficient injectivity argument for manifolds .",
    "this argument can be generalized to spaces with a dense set of higher - dimensional manifold - type points .",
    "the characterization of dirac masses follows from two lemmas , and can be carried out without any assumption on the curvature .",
    "note that when we ask a space to be geodesically complete , we of course imply that it is geodesic .",
    "[ lem : extension ] let @xmath19 be a locally compact , geodesically complete polish space .",
    "any geodesic segment in @xmath20 issued from a dirac mass can be extended to a complete geodesic ray .",
    "let us recall the measurable selection theorem ( see for example @xcite , corollary of theorem 17 ) : any surjective measurable map between polish spaces admits a measurable right inverse provided its fibers are compact .",
    "consider the restriction map @xmath732 the fiber of a geodesic segment @xmath64 is closed in the set @xmath733 of geodesic rays of speed @xmath734 starting at @xmath488 .",
    "this set is compact by arzela - ascoli theorem ( equicontinuity follows from the speed being fixed , while the pointwise relative compactness is a consequence of @xmath19 being locally compact and geodesic , hence proper ) .",
    "moreover the geodesic completeness implies the surjectivity of @xmath735 .",
    "there is therefore a measurable right inverse @xmath736 of @xmath735 : it maps a geodesic segment @xmath64 to a complete ray whose restriction to @xmath205 $ ] is @xmath64 .",
    "let @xmath737}$ ] be a geodesic segment of @xmath20 , of speed @xmath59 , with @xmath738 and let @xmath739 : it is a probability measure on @xmath36 whose restriction @xmath740 is the displacement interpolation of @xmath191 . for all @xmath741",
    "we therefore denote by @xmath169 the measure @xmath742 on @xmath0 .",
    "it is easy to see that it defines a geodesic ray : since there is only one transport plan from a dirac mass to any fixed measure , @xmath743 .",
    "moreover the transport plan from @xmath169 to @xmath744 deduced from @xmath118 gives @xmath745 .",
    "but the triangular inequality applied to @xmath157 , @xmath169 and @xmath744 implies @xmath746 and we are done .    if @xmath19 is a geodesic polish space , given @xmath747 not a dirac mass and @xmath748 , the geodesic segment from @xmath157 to @xmath749 can not be geodesically extended for any time @xmath750 .",
    "note that at least in the branching case the assumption @xmath748 is needed .",
    "assume that there is a geodesic segment @xmath751}$ ] and let @xmath118 be an optimal dynamical transport plan from @xmath157 to @xmath752 .",
    "since @xmath748 , @xmath516 contains a geodesic segment of @xmath0 that is at @xmath44 at times @xmath113 and @xmath3 , and must therefore be constant .    since @xmath157 is not a dirac mass",
    ", there is a @xmath753 in @xmath754 .",
    "let @xmath64 be a geodesic segment in @xmath516 such that @xmath755 .",
    "then @xmath756 lies between @xmath757 and @xmath758 on @xmath64 , and the transport plan @xmath759 contains in its support the couples @xmath760 and @xmath761 .",
    "but then cyclical monotonicity shows that @xmath160 is not optimal : it costs less to move @xmath762 to @xmath44 and @xmath44 to @xmath757 by convexity of the cost ( see figure [ fig : aligned ] ) .",
    "the dynamical transport @xmath118 can not be optimal either , a contradiction .",
    "we can now easily draw the consequences of these lemmas .",
    "let @xmath18 be geodesic polish spaces and assume that @xmath19 is geodesically complete and locally compact .",
    "any isometry from @xmath20 to @xmath21 must map all dirac masses to dirac masses .",
    "except in the next corollary , we shall use this result with @xmath763 .",
    "note that we will need to ask that @xmath0 be geodesically complete in addition to the hadamard hypothesis .",
    "denote by @xmath373 an isometry @xmath764 and consider any @xmath765 .",
    "if @xmath766 were not a dirac mass , there would exist a geodesic segment @xmath767}$ ] from @xmath766 to a dirac mass ( at a point @xmath768 ) that can not be extended for times @xmath750 .",
    "but @xmath769 gives a geodesic segment issued from @xmath586 , that can therefore be extended .",
    "this is a contradiction since @xmath373 is an isometry .",
    "[ coro : isometry ] let @xmath18 be geodesic polish spaces and assume that @xmath19 is geodesically complete and locally compact .",
    "then @xmath20 is isometric to @xmath21 if and only if @xmath19 is isometric to @xmath22 .",
    "let @xmath373 be an isometry @xmath770 . then @xmath373 maps dirac masses to dirac masses , and since the set of dirac masses of a space is canonically isometric to the space , @xmath373 induces an isometry @xmath771 .",
    "the converse implication is obvious .",
    "note that we do not know whether this result holds for general metric spaces . also",
    ", we do not know if there is a space @xmath19 and an isometry of @xmath20 that maps some dirac mass to a measure that is not a dirac mass .",
    "the characterization of measures supported on a geodesic relies on the following argument : when dilated from a point of the geodesic , such a measure has euclidean expansion .",
    "assume that @xmath0 is negatively curved , and let @xmath64 be a maximal geodesic of @xmath0 , @xmath118 be in @xmath1 .",
    "given a point @xmath772 , denote by @xmath773}$ ] the geodesic segment from @xmath586 to @xmath118 . if @xmath44 is any point of @xmath0 , @xmath774 denotes the midpoint of @xmath43 and @xmath44 .",
    "the measure @xmath118 is supported on @xmath64 if and only if for all @xmath775 @xmath776    the `` only if '' part is obvious since the transport problem on a convex subset of @xmath0 only involves the induced metric on this subset , which here is isometric to an interval .    to prove the `` if '' part , first notice that the cat(0 ) inequality in a triangle @xmath777 yields the thales inequality @xmath778 , so that by direct integration @xmath779 note also that @xmath780 .",
    "assume now that @xmath118 is not supported on @xmath64 and let @xmath781 , and @xmath775 such that @xmath782 are not aligned .",
    "since @xmath64 is maximal , this is possible , for example by taking @xmath783 in the branching case ( any choice of @xmath784 would do in the non - branching case ) .",
    "since @xmath0 is negatively curved , we get that @xmath785 so that is strict ( see figure [ fig : geodsupported ] ) .",
    "if @xmath0 is a negatively curved hadamard space and @xmath64 is a maximal geodesic of @xmath0 , any isometry of @xmath1 that fixes dirac masses must preserve the subset @xmath786 of measures supported on @xmath64 , and therefore induces an isometry on this set .",
    "let @xmath373 be an isometry of @xmath1 that fixes dirac masses .",
    "let @xmath64 be a maximal geodesic of @xmath0 and @xmath787 be supported on @xmath64 .",
    "if @xmath788 where not supported in @xmath64 , there would exist @xmath775 such that @xmath789 .",
    "but @xmath373 is an isometry and @xmath790 , @xmath791 , @xmath792 so that also @xmath793 . as a consequence , would be a strict inequality too , a contradiction .",
    "we want to deduce from the previous section that an isometry that fixes all dirac masses must also fix every geodesically - supported measure . to this end",
    ", we have to show that the isometry induced on the measures supported in a given geodesic is trivial , in other terms to rule out the other possibilities exhibited in @xcite at which it is recommanded to take a look before reading the proof below .",
    "[ prop : geod_supported ] assume that @xmath0 is a geodesically complete , negatively curved hadamard space and let @xmath373 be an isometry of @xmath1 that fixes all dirac masses .",
    "for all complete geodesics @xmath64 of @xmath0 , the isometry induced by @xmath373 on @xmath786 is the identity .",
    "we only adress the geodesically complete case for simplicity , but the same probably holds in more generality .",
    "let @xmath43 be a point not lying on @xmath64 .",
    "such a points exists since @xmath0 is negatively curved , hence not a line .",
    "first assume that @xmath373 induces on @xmath786 an exotic isometry .",
    "let @xmath794 be two points of @xmath64 and define @xmath795 .",
    "then @xmath796 has the form @xmath797 where @xmath798 , @xmath799 , @xmath800 .",
    "let now @xmath801 be a complete geodesic that contains @xmath802 and @xmath803 ( see figure [ fig : exotic ] ) .",
    "since the midpoint of @xmath157 and @xmath586 is supported on @xmath801 , so is the midpoint of @xmath804 and @xmath586 .",
    "this means that @xmath805 and @xmath806 lie on @xmath801 , and the former goes to infinity .",
    "this shows that @xmath373 also induces an exotic isometry on @xmath807 , thus that @xmath806 goes to the midpoint @xmath808 of @xmath757 and @xmath809 .",
    "but we already know that @xmath806 tends to the midpoint of @xmath43 and @xmath810 , which must therefore be @xmath808 .",
    "since this holds for all choices of @xmath44 and @xmath45 , we see that the map @xmath811 maps affinely @xmath64 to @xmath801 .",
    "but the geodesic segment @xmath812 $ ] converges when @xmath334 to geodesic segments asymptotic to @xmath64 and @xmath813 respectively .",
    "it follows that @xmath801 is parallel to @xmath64 , so that they must bound a flat strip ( see @xcite ) .",
    "but this is forbidden by the negative curvature assumption .",
    "a similar argument can be worked out in the case when @xmath373 induces an involution : given @xmath814 and their midpoint @xmath810 , one can find measures @xmath804 supported on @xmath44 and @xmath815 , where @xmath816 and @xmath804 has more mass on @xmath815 than on @xmath44 , such that @xmath817 is supported on @xmath45 and a point @xmath818 of @xmath64 , with more mass on @xmath818 .",
    "it follows that the midpoints @xmath819 with @xmath43 are on a line , and we get the same contradiction as before .",
    "the classification of isometries of @xmath16 shows that if @xmath373 fixes dirac masses and is neither an exotic isometry nor an involution , then it is the identity .",
    "now we are able to link the isometric rigidity of @xmath1 to the injectivity of a radon transform .",
    "the following definition relies on the following observation : since a geodesic is convex and @xmath0 is hadamard , given a point @xmath44 and a geodesic @xmath64 there is a unique point @xmath820 closest to @xmath44 , called the projection of @xmath44 to @xmath64 .",
    "when @xmath0 is geodesically complete , we define the _ perpendicular radon transform _",
    "@xmath821 of a measure @xmath728 as the following map defined over complete geodesics @xmath64 of @xmath0 : @xmath822 in other words , this radon transform recalls all the projections of a measure on geodesics .",
    "the following is now a direct consequence of proposition [ prop : geod_supported ] .",
    "[ coro : inversion ] assume that @xmath0 is geodesically complete and negatively curved . if there is a dense subset @xmath823 such that for all @xmath728 and all @xmath824 , we have @xmath825 then @xmath1 is isometrically rigid .",
    "let @xmath373 be an isometry of @xmath1 .",
    "up to composing with an element of the image of @xmath727 , we can assume that @xmath373 acts trivially on dirac masses .",
    "then it acts trivially on geodesically supported measures . for all @xmath824 ,",
    "since @xmath826 is the measure supported on @xmath64 closest to @xmath119 , one has @xmath827 , hence @xmath828 .",
    "we just proved that @xmath373 acts trivially on a dense set , so that it must be the identity .",
    "the proof of theorem [ theo : isometry ] shall be complete as soon as we get the injectivity required in corollary [ coro : inversion ] . note that in the case of the real hyperbolic space @xmath731 , we could use the usual radon transform on the set of compactly supported measures with smooth density to get it ( see @xcite ) .",
    "let us first give an argument that does the job for all manifolds .",
    "we shall give a more general , but somewhat more involved argument afterward , and the next subsection shall deal with the case of trees .",
    "first , we prove under the assumption @xmath829 that @xmath118 must be supported on the @xmath833 .",
    "let @xmath43 be any other point , and consider a geodesic @xmath64 such that @xmath834 and @xmath835 is not orthogonal to any of the geodesics @xmath836 .",
    "then for all @xmath837 , @xmath838 and there is an @xmath221 such that the neighborhood of size @xmath583 around @xmath43 on @xmath64 does not contain any of these projections .",
    "it follows that @xmath839 is supported outside this neighborhood , and so does @xmath840 .",
    "but the projection on @xmath64 is @xmath3-lipschitz , so that @xmath118 must be supported outside the @xmath583 neighborhood of @xmath43 in @xmath0 .",
    "in particular , @xmath841 .",
    "now , if @xmath64 is a geodesic containing @xmath833 , then @xmath839 is finitely supported with a mass at least @xmath842 at @xmath833 . for a generic @xmath64 ,",
    "the mass at @xmath833 is exactly @xmath842 .",
    "it follows immediately , since @xmath118 is supported on the @xmath833 , that its mass at @xmath833 is @xmath842 .",
    "the above proof mainly uses the fact that given a point @xmath43 and a finite number of other points @xmath833 , there is a geodesic @xmath843 such that @xmath838 for all @xmath837 .",
    "it follows that the proof can be adjusted to get the case [ enumi : isom3 ] of theorem [ theo : isometry ] . to this end , let us define the _ regular set _ of @xmath0 as the set of points having a neighborhood isometric to an open set in a riemannian manifold of dimension at least @xmath730 .",
    "assume that @xmath0 is a hadamard , geodesically complete space .",
    "let @xmath243 be the set of measures supported on finite set of points all located in the regular set of @xmath0 . for all @xmath728 and all @xmath824 , if @xmath829 then @xmath830 .      since by hypothesis , @xmath833 has a neighborhood @xmath846 isometric to an open set in a riemannian manifold of dimension at least @xmath730 , as before there is a geodesic @xmath847 such that @xmath848 for all @xmath849 .",
    "it follows that for some @xmath221 , the measure @xmath850 is concentrated outside @xmath851 . by taking @xmath583 small enough so that @xmath852 is contained in @xmath846 , it follows also that @xmath118 is concentrated outside @xmath851 .",
    "let @xmath853 denote the set of points @xmath43 such that the geodesic segment @xmath854 $ ] is orthogonal to @xmath64 at @xmath833 .",
    "then @xmath855 is the exponential image of the orthogonal of the tangent line of @xmath64 at @xmath833 . by definition of the radon transform , @xmath856 and for all @xmath857 , we have @xmath858",
    ".    choose a second geodesic @xmath859 , close enough to @xmath64 to ensure that for all @xmath857 , we still have @xmath860 ( up to schrinking @xmath583 a bit if necessary ) .",
    "we can moreover assume that @xmath861 enjoys the same properties we asked to @xmath64 , so that @xmath862    let @xmath359 be the dimension of @xmath846 .",
    "we can construct inductively a family @xmath863 of geodesics chosen as above , and such that their velocity vectors at @xmath833 span its tangent space .",
    "for all point @xmath43 in @xmath864 we get @xmath865 . but",
    "@xmath866 , and considering @xmath867 we get @xmath868 . since @xmath118 is a probability measure and @xmath832 , we deduce @xmath830 .",
    "now if @xmath0 fits in case [ enumi : isom3 ] of theorem [ theo : isometry ] , then the regular set of @xmath0 is dense , thus @xmath243 is dense in @xmath1 .",
    "we can therefore conclude by corollary [ coro : inversion ] .",
    "let @xmath0 be a locally finite tree that is not a line .",
    "recall the notations already used in section [ sec : rank ] .",
    "we describe @xmath0 by a couple @xmath392 where @xmath393 is the set of vertices ; @xmath394 is the set of edges , each endowed with one or two endpoints in @xmath393 and a length .    for all @xmath545 , let @xmath869 be the valency of @xmath43 , that is the number of edges incident to @xmath43 .",
    "we assume that no vertex has valency @xmath730 , since otherwise we could describe the same metric space by a simpler graph .",
    "note also that edges with only one endpoint have infinite length since @xmath0 is assumed to be complete .    in this",
    "setting , @xmath0 is geodesically complete if and only if it has no leaf ( vertex of valency @xmath3 ) .",
    "assume this , and let @xmath64 be a complete geodesic .",
    "if @xmath43 is a vertex lying on @xmath64 and @xmath870 are the connected components of @xmath871 , let @xmath872 be the union of @xmath43 and of the @xmath873 not meeting @xmath64 ( see figure [ fig : perpendicular ] ) .",
    "it inherits a tree structure from @xmath0 .",
    "in fact , @xmath872 depends only upon the two edges @xmath874 of @xmath64 that are incident to @xmath43 .",
    "we therefore let @xmath875 .",
    "a measure @xmath728 can be decomposed into a part supported outside vertices , which is obviously determined by the projections of @xmath118 on the various geodesics of @xmath0 , and an atomic part supported on vertices .",
    "therefore , we are reduced to study the perpendicular radon transform reformulated as follows for functions defined on @xmath393 instead of measures on @xmath0 .",
    "a _ flag _ of @xmath0 is defined as a triple @xmath878 where @xmath43 is a vertex , @xmath879 are edges incident to @xmath43 and @xmath880 denotes an unordered pair .",
    "let us denote the set of flags by @xmath501 ; we write @xmath881 to say that @xmath882 .",
    "two maps @xmath886 such that @xmath887 and @xmath888 are equal .",
    "more precisely , we can recover @xmath883 from @xmath889 by the following inversion formula : @xmath890 where the first sum is over the set of pairs of edges incident to @xmath43 .",
    "the formula relies on a simple double counting argument : @xmath891 where @xmath892 is the number of flags @xmath878 such that @xmath893 .",
    "if @xmath894 , let @xmath895 be the edge incident to @xmath43 starting the geodesic segment from @xmath43 to @xmath44 . then @xmath893",
    "if and only if @xmath896 . therefore , @xmath897 .",
    "but @xmath898 , so that @xmath899                       harmonic analysis on trees , harmonic analysis on homogeneous spaces ( proc . sympos .",
    "pure math .",
    "xxvi , williams coll . ,",
    "williamstown , mass . , 1972 ) ,",
    "soc . , providence , r.i .",
    ", 1973 , p.  419424 .      ",
    "ensembles analytiques .",
    "thormes de sparation et applications , sminaire de probabilits , ix ( seconde partie , univ .",
    "strasbourg , strasbourg , annes universitaires",
    "1973/1974 et 1974/1975 ) , springer , berlin , 1975 , p.  336372 .",
    "lecture notes in math .",
    ", vol . 465 ."
  ],
  "abstract_text": [
    "<S> optimal transport enables one to construct a metric on the set of ( sufficiently small at infinity ) probability measures on any ( not too wild ) metric space @xmath0 . </S>",
    "<S> it is called its wasserstein space @xmath1 ( note that there are variant of this space depending on an exponent , but here we use only the most common , namely the _ quadratic cost _ ) .    in this paper </S>",
    "<S> we investigate the geometry of @xmath1 when @xmath0 has globally non - positive sectional curvature ( what we call a _ hadamard space _ ) . although it is known that except in the case of the line @xmath1 is not non - positively curved , </S>",
    "<S> our results show that @xmath1 have large - scale properties reminiscent of that of @xmath0 .    </S>",
    "<S> first , we are able to define a geodesic boundary in a very similar way than one does for @xmath0 itself , notably thanks to an _ asymptotic formula _ that gives good control on the distance between two geodesic rays .    </S>",
    "<S> this understanding of the geodesic rays enables us to prove that if @xmath0 is a visibility space ( which for example includes all @xmath2 spaces , in particular all simply connected manifolds with uniformly negative sectional curvature ) , then @xmath1 does not contain any isometrically embedded euclidean plane : one says that it has rank @xmath3 .    </S>",
    "<S> we also show that in many cases ( including trees and manifolds ) , if @xmath0 is negatively curved then the isometry group of @xmath1 is as trivial as it can be . </S>",
    "<S> this contrasts with previous results in the euclidean case .    while optimal transport has commonly been studied under lower curvature bounds ( or to define such bounds ) , we hope that this paper will show that it is of interest in a non - positively curved setting . </S>",
    "<S> notably , an uncommon feature of our work is that we allow @xmath0 to be branching , and some emphasis is indeed given to trees . </S>"
  ]
}