{
  "article_text": [
    "anisotropies in the cosmic microwave background ( cmb ) provide a powerful tool to probe the cosmological parameters ( hu , sugiyama & silk 1997 ) . the results of four - year work of the cobe satellite ( bennett et al .",
    "1996 ) allow us to determine the power spectrum of the cmb anisotropies to an accuracy of 7% , but with relatively poor angular resolution , @xmath2 .",
    "new planned satellite missions , map ( bennett et al . 1997 ) and planck ( bersanelli et al . 1997 ) , will achieve an accuracy of better than 1% in the power spectrum with the sub - degree resolution ( bond , efstathiou & tegmark 1997 ; zaldarriaga , spergel & seljak 1997 ) . in turn , we need to bring the theoretical models to the same level of accuracy .    in the standard cosmological model , after the epoch of the big bang nucleosynthesis the relativistic particles include photons and the three species of neutrinos ( kolb & turner 1990 ; peebles 1993 ) . while the abundance of photons is directly measured from the cmb observations , the abundance of primordial neutrinos can only be assessed theoretically . the standard way to perform such",
    "a calculation is to use the so called freeze - out approximation , which assumes that neutrinos decouple instantaneously from the rest of the universe at temperature of about @xmath3 .",
    "then the distribution function of all three neutrino species retains the fermi - dirac form with the only parameter , the neutrino temperature , uniquely tied to the observed cmb temperature .",
    "however , even after decoupling the high - energy neutrinos still interact , albeit slowly , with the electron - positron plasma , contrary to the basic assumption of the freeze - out approximation .",
    "this interaction leads to some of the photon energy being transferred into neutrinos .",
    "but because it is the photon energy density that is directly measured , the total energy density of the universe in the relativistic species _ relative _ to the energy density in photons ( which is measured observationally to about 0.3% accuracy ) will be somewhat higher than the one predicted by the freeze - out approximation .",
    "several previous attempts have been made to compute cosmological neutrino decoupling in greater detail , though still assuming that neutrino distribution functions have maxwellian form ( dicus et al .",
    "1982 ; herrera & hacyan 1989 ; raha & mitra 1991 ; dolgov & fukugita 1992 ) , with the most comprehensive study given by dodelson & turner ( 1992 ) .",
    "recently , two more papers have addressed this problem with the full account for the fermi - dirac form of the neutrino distribution functions ( hannestad & madsen 1995 ; dolgov , hansen , & semikoz 1997 ) .",
    "both of these studies , however , have not achieved the desired level of accuracy of the numerical calculation ( about @xmath4 , which is equivalent to a 1% accuracy in a 1% correction to the freeze - out approximation ) .",
    "the problem is complex : solution of the full boltzmann equation in three dimensions is at the very edge of modern computing capabilities . as a result ,",
    "the previous calculations have only been able to cover slightly more that two decades in the neutrino momentum , which is insufficient to compute an asymptotic behavior of the neutrino distribution function .    in this paper",
    "we complete the calculation of cosmological neutrino decoupling using an extensive calculation on a parallel supercomputer , placing special emphasis on achieving complete numerical convergence , and covering over seven decades in the neutrino momentum .    the paper is composed in the following way . we derive and solve the boltzmann equations for all three neutrino species in  [ sec :",
    "be ] . in ",
    "[ sec : ni ] , we briefly touch upon the relevant numerical issues , relegating the details of our numerical method to appendix . finally in ",
    "[ sec : results ] , we present our results for the neutrino energy density and compare them to the freeze - out approximation . we also obtain accurate distribution functions for the cosmological neutrinos .",
    "the boltzmann equation for neutrinos in the expanding universe is ( kolb & turner 1990 ) : @xmath5 ,      \\label{boleq}\\ ] ] where @xmath6 is the neutrino distribution function , @xmath7 is the neutrino energy ( @xmath8 since the neutrino mass , even if it exists , is assumed to be much smaller than our characteristic energy scale , @xmath9 mev ) , and @xmath10 $ ] is the collisional integral .",
    "hereafter we use units in which @xmath11 . in the case of neutrinos interacting with the electron - positron pairs and other neutrino species via annihilation and scattering reactions ,",
    "the collisional integral is ( hannestad & madsen 1995 ) @xmath12 = \\sum      { 1\\over2(2\\pi)^5 } \\int       { d^3 p_2\\over 2e_2 }      { d^3 p_3\\over 2e_3 }      { d^3 p_4\\over 2e_4 }      \\lambda(f_1,f_2,f_3,f_4 ) m^2\\delta^4(\\bar p_1+\\bar p_2-\\bar p_3-\\bar p_4 ) ,      \\label{eq : collint}\\ ] ] where @xmath13 , @xmath14 , @xmath15 @xmath16 is the matrix element squared and summed over initial and final spin states , @xmath17 are four - momenta of the incoming ( 1,2 ) and outgoing ( 3,4 ) particles , and the sum is taken over all of the reactions involving @xmath18 .",
    "the list of all neutrino reactions is presented in table [ tabone ] , along with the respective matrix elements ( hannestad & madsen 1995 ) .",
    "indecies @xmath19 , @xmath20 , @xmath21 run over electron , muon , and tau neutrino , with the exception that @xmath22 .",
    "the factor @xmath23 is the fermi coupling constant , and coefficients @xmath24 and @xmath25 for different types of neutrinos are given by the following equations ( for example , kaminker et al .",
    "1992 ) : @xmath26 where @xmath27 is the weinberg angle , and we adopt @xmath28 .",
    "quantities @xmath29 are defined as follows : @xmath30 where @xmath31 is the electron mass . as has been shown by hannestad & madsen ( 1995 ) , integrals over @xmath32 and over angles in @xmath33 and @xmath34 can be computed analytically , yielding @xmath12 = \\sum      { 1\\over2(2\\pi)^5 } \\int       { p_2 ^ 2 dp_2\\over 2e_2 }      { p_3 ^ 2 dp_3\\over 2e_3 }      \\lambda(f_1,f_2,f_3,f_4 )       f(p_1,p_2,p_3 ) .",
    "\\label{eq : collfin}\\ ] ] in order to minimize the possibility of an error in the complicated factors @xmath35 , we have used _ mathematica _ software package to perform the calculations .",
    "the resultant expressions are too large to be presented here , but the original _ mathematica _ script and the fortran source code are available upon request .    in order to calculate the evolution of the neutrino distribution functions , @xmath36 , we need to include the equations describing the evolution of the scale factor and the energy density of the universe : @xmath37 and @xmath38 where @xmath39 and @xmath40 are the energy density and the pressure , respectively : @xmath41 + \\rho_\\nu,\\ ] ] @xmath42 + { \\rho_\\nu\\over3},\\ ] ] where @xmath43 and the functions @xmath44 are defined as @xmath45 here @xmath46 is the energy density in the three neutrino species , @xmath47 dq.\\ ] ] we also note that since the coefficients @xmath24 and @xmath25 are the same for muon and tau neutrino , their distribution functions are equal .",
    "equation ( [ boleq ] ) , along with equations ( [ adot ] ) and ( [ rhodot ] ) , can now be integrated numerically for each of the neutrino species . in order to eliminate the derivative with respect to the neutrino momentum in equation ( [ boleq ] ) , we employ the comoving momentum @xmath48 .",
    "we lay out the neutrino distribution function on a logarithmically spaced mesh in the range @xmath49 with 40 points per decade ( 289 points altogether ) . by appropriately changing the limits and sampling of the momentum mesh",
    ", we have verified that such a discretization offers a fully convergent solution to an accuracy of better than @xmath4 .",
    "after this procedure , equation ( [ boleq ] ) becomes a system of coupled ordinary differential equations .",
    "we begin the integration at @xmath50 and carry it out to @xmath51 , at which point the desired precision is achieved .",
    "the relative accuracy of the integration at each time step is set to @xmath52 .",
    "the resultant ordinary differential equations are stiff and present a considerable computational challenge .",
    "standard methods require computing the full jacobian , which is virtually impossible for our fairly complicated system of equations . for the purpose of this calculation",
    ", we develop a special numerical scheme , presented in the appendix , which can handle stiff equations of the bolztmann type and does not require computing the full jacobian .",
    "our scheme is more efficient by a factor of 20 to 60 than the standard fifth order adaptive runge - kutta method .",
    "finally , we note that the most time consuming part , calculating the collisional integral , can be done very efficiently in parallel .",
    "our final computation has been performed on the ncsa power challenge array with 12 r10000 processors and has consumed about 200 processor - hours .",
    "the main outcome of our calculations is the number density and the energy density of all three neutrino species at the current epoch relative to those of photons .",
    "the results are presented in table [ tabonea ] . for comparison",
    ", we also give the respective numbers computed in the freeze - out approximation .",
    "all values are accurate to the last decimal place shown .",
    "the most important quantity , the total radiation energy density in the universe , differs from the freeze - out approximation by only 0.3% .",
    "another way of presenting this difference is the effective number of neutrino species , @xmath53 .",
    "we can rewrite the expression for the energy density of the universe as @xmath54      a_r t_{0,\\gamma}^4 ,      \\label{eq : raden}\\ ] ] where in the freeze - out approximation @xmath55 . from table",
    "[ tabonea ] we obtain : @xmath56 this number does not , of course , mean that there are more than 3 species of neutrinos ; it is simply a number that should be used in the freeze - out approximation to reproduce the exact result .",
    "since most of the previously obtained results and existing numerical codes are based on the freeze - out approximation , it is convenient to use @xmath53 : one simply has to use 3.022 instead of 3.0 in every place in the code where the neutrino energy density is computed .",
    "we note here that we find a somewhat larger effect than both hannestad & madsen ( 1995 ) and dolgov et al .",
    "( 1997 ) , who found @xmath57 and @xmath53 from 3.013 to 3.019 ( depending on the method of calculation ) respectively .",
    "we attribute this difference to the higher accuracy of our calculation and the lack of numerical convergence in the previous work . in particular , when we adopt a momentum range from @xmath58 to @xmath59 , as in dolgov et al .",
    "( 1997 ) , we obtain @xmath60 , in agreement with the authors .",
    "if we further reduce the momentum range from @xmath61 to @xmath62 , as in hannestad & madsen ( 1995 ) , we recover their result , @xmath57 .",
    "we can also characterize the final neutrino distribution function .",
    "let us introduce the effective neutrino temperature , @xmath63 , as @xmath64 since the neutrino distribution function is not of the fermi - dirac form any more , @xmath63 is a function of the neutrino momentum @xmath65 .",
    "figure 1 shows the deviation of the effective temperature at the current epoch , @xmath66 , from the freeze - out approximation value , @xmath67 , as a function of @xmath68 ( this ratio is independent of time after electron - positron annihilation ) . for the high neutrino momenta ,",
    "the effective neutrino temperature asymptotically approaches the photon temperature , because the high - energy neutrinos can efficiently interact with the electrons via pair creation even after annihilation , @xmath69 for the low momenta , @xmath70 , neutrino interactions with electrons and positrons are suppressed by a factor @xmath71 and do not affect the evolution of the distribution function .",
    "however , the rate of the neutrino - neutrino interactions is proportional to the first power of the momentum @xmath65 .",
    "thus , in the limit of small momenta , @xmath72 and we find that @xmath73 the value of the constant is 0.99950 @xmath74 for the electron neutrinos and 0.99918 @xmath74 for the muon and tau neutrinos .",
    "our results have several immediate cosmological implications .",
    "first , the change of the radiation energy density of the universe will affect the spectrum of cmb anisotropies at about 0.3% level just behind the first acoustic peak , @xmath75 , and at about 0.5% level at the damping scale , @xmath76 ( hu et al .",
    "1995 ) . if more than 0.5% accuracy is required in calculating the cmb anisotropies , equation ( [ eq : raden ] ) should be used .",
    "second , the change of the radiation energy density of the universe affects the evolution of linear density fluctuations on galactic and subgalactic scales .",
    "we have computed the matter transfer function using _ cosmics _ package ( bertschinger 1995 ) and we find that for a cosmological model with @xmath77 , @xmath78 , and @xmath79 , the rms density fluctuation at @xmath80 scale , @xmath81 , decreases by about 0.2% , and the rms density fluctuation on @xmath82 scale decreases by about 0.3% .",
    "these latter changes , however , are too small to be of any interest in the foreseeable future .    in addition , neutrino decoupling affects primordial helium production .",
    "however , dodelson & turner ( 1992 ) showed that the net change in the primordial helium abundance is virtually unobservable due to cancellation of two competing effects : one is the higher expansion rate , which leads to a higher helium abundance , and the other is the faster neutron decay rate , which leads to a lower helium abundance .",
    "a small change in the neutrino number density will produce a small change in the massive neutrino mass density ( hannestad & madsen 1995 ) , but this change is again too small to be of any practical interest .",
    "thus , we conclude that only in computing the cmb anisotropies should one need to worry about the accurate calculation of neutrino decoupling ; otherwise , the effect is negligibly small .",
    "overall , our calculations confirm the validity of the freeze - out approximation . if the accuracy of a few percent is sufficient , one can safely use the freeze - out approximation to compute any property of cosmological neutrinos .",
    "we are grateful to d.  yakovlev , j.  ostriker , d.  spergel , j.  madsen , b.  fields , s.  hannestad , and a.  dolgov for valuable comments .",
    "we thank the anonymous referee for pointing us to an error in the original manuscript .",
    "n.  g.  was supported by the uc berkeley grant 1 - 443839 - 07427 .",
    "calculations were performed on the ncsa power challenge array under the grant ast-960015n .",
    "in this paper we are dealing with a particular kind of an ordinary differential equation that can be presented in the following form : @xmath83 where both @xmath84 and @xmath21 are slow functions of @xmath85 , but not of @xmath86 , and @xmath21 is positive .",
    "this equation is stiff , and a numerical method which does not handle stiff equations requires a time step @xmath87 such that @xmath88 numerical methods that can deal with stiff equations usually have a much less stringent restriction on the time step , @xmath89 and , because @xmath84 is a slow function of @xmath85 , we assume that @xmath90 however , standard techniques for stiff equations require computing the full jacobian , @xmath91 in our case this quantity is very difficult to compute , because @xmath84 is an integral over @xmath85 and numerical evaluation of the integral involves nontrivial interpolation .",
    "we therefore proceed differently and design a numerical scheme which involves only a partial jacobian , @xmath92 which can be computed simultaneously with the r.h.s .  of equation ( [ difeq ] ) at no extra cost .",
    "additional advantage of using the partial jacobian @xmath93 instead of the full jacobian @xmath94 is that for a system of equations , the partial jacobian is a diagonal matrix , which can be inverted much faster than the full jacobian , which is usually a general matrix .",
    "however , we can not simply take a standard numerical scheme and replace the full jacobian with the partial one , because the different orders of the numerical error will not cancel out in this case .",
    "thus , we need to design a special scheme which will assure the proper cancellation of the numerical error up to a given order .",
    "the numerical scheme to update @xmath85 from @xmath95 to @xmath96 in a time interval @xmath97 is constructed as follows : @xmath98 where @xmath99 , @xmath100 , @xmath101 , and @xmath102 are constants .",
    "the values for @xmath99 , @xmath103 , @xmath104 , @xmath105 , and @xmath106 are given in table [ tabtwo ] .    by varying the remaining constants , we construct two numerical schemes : the third order and the second order , respectively ( table [ tabthr ] ) .",
    "thus , the difference between the values of @xmath107 computed with the two schemes can serve as an estimate of numerical errors . again , _ mathematica _ was used to compute the values of the constants that give the cancellation of numerical errors to the required order ."
  ],
  "abstract_text": [
    "<S> we solve the boltzmann equation for cosmological neutrinos around the epoch of the electron - positron annihilation in order to verify the freeze - out approximation and to compute accurately the cosmological neutrino distribution function . </S>",
    "<S> we find the radiation energy density to be about 0.3% higher than predicted by the freeze - out approximation . as a result , </S>",
    "<S> the spectrum of the cosmic microwave background anisotropies changes by @xmath0 , depending on the angular scale , and the amplitude of the mass fluctuations on scales below about 100 @xmath1 decreases by about 0.2 - 0.3% .    </S>",
    "<S> # 1#1 9.0 in -0.25 in    # 1 </S>"
  ]
}