{
  "article_text": [
    "understanding thermodynamic properties of materials , especially nanomaterials such as nanowires , is essential for designing and manufacturing new devices.@xcite one of the most accurate and reliable methods to understand such materials at the atomistic level is the use of molecular dynamics ( md ) simulations based on density functional theory ( dft ) .",
    "unfortunately , the length and time scales needed for the prediction of thermodynamic and kinetic properties using _ ab initio _ md methods are often beyond the reach of present - day computer power .",
    "examples include the evaluation of dynamical activation energy@xcite or thermal conductivity,@xcite where a number of simulations on large , realistic models at different temperatures on the time scale of hundreds of picoseconds are required , which makes _ ab initio _ md studies of these properties practically prohibitive .",
    "many classical force - field simulations have therefore been applied to larger systems for longer time scales@xcite ; however , a major drawback is that empirical potentials often suffer from the transferability to chemically complex environments and to higher temperatures.@xcite    recently , machine - learning ( ml ) approaches have been applied to predicting a variety of properties of molecules and solids : atomization energies,@xcite nuclear chemical shifts,@xcite interatomic potentials,@xcite and force constants.@xcite ml methods employed in these efforts include artificial neural networks,@xcite gaussian process regression,@xcite compressive sensing,@xcite and kernel ridge regression ( krr).@xcite interestingly , ml approaches have been successful in _ direct _ predictions of atomic forces for one- and two - component solid - state systems,@xcite with a small fraction of the computational cost needed for quantum mechanical ( qm ) evaluation . moreover ,",
    "their predictive power is often on par with that of dft@xcite ; hence , recent progress in data - driven , ml force fields@xcite is quite encouraging . with this perspective , constructing ml force fields that can be transferable across a broad range of temperatures is an essential ingredient in the development of fast and reliable ml - based md methods . to our knowledge , however , the information about assessing the quality of ml force fields in terms of temperature has been elusive ; yet , it is not _ a priori _ obvious how well a trained ml model can predict atomic forces at different temperatures .    to address the above topic , herein we provide a simple , intuitive prescription for generating a versatile data set for training a robust ml force field that can be applicable to a range of temperatures . our idea is based on two premises : ( i ) md trajectories of a solid system will revisit similar regions in the phase space ; and ( ii ) with the help of a proper atomic representation and a nonlinear ml technique , atomic forces in a crystalline solid at _ different _ temperatures can be accurately predicted , using a data set obtained from the canonical ensemble at a _ much higher _ temperature . in this paper , we argue that our ml force field , once carefully trained by a qm data set chosen from a high - temperature simulation in the canonical ensemble , can predict atomic forces in a crystalline solid across a range of temperatures .    this paper is organized as follows . in the methodology section , first we briefly describe the krr method , followed by a cross - validation scheme , which assesses the quality of our ml model and determines the optimal values for hyperparameters .",
    "second , we give a brief overview of a descriptor that can simply and efficiently represent local atomic environments , called _ atomic fingerprint _ , which has been recently introduced by botu and ramprasad.@xcite third , we present the computational details for generating qm data sets and provide a definition for evaluating the force error . in the results and discussion section , after verifying a merit of using a training data set taken from the md trajectory at the upper bound of the temperature range , we investigate how the training data set size and the fingerprint complexity affect the prediction error .",
    "then , we show how accurately our ml model on crystalline silicon ( trained only by a qm data set at 1650 k ) can predict the atomic forces at different temperatures for the same system size and for a larger one .",
    "finally , we summarize the conclusions .",
    "krr is a kernelized version of linear ridge regression , where the nonlinearity is embedded by mapping the data into a high - dimensional hilbert space , called _",
    "feature space_.@xcite the key idea of kernel - based ml , known as _ kernel trick _ , is to implicitly express the inner product in feature space via a chosen kernel without explicitly carrying out the transformation to feature space . for an introduction to krr in the context of predicting qm properties ,",
    "see a tutorial review by rupp.@xcite krr has been successfully applied to materials and chemical sciences.@xcite with krr , a prediction @xmath0 is given by@xcite @xmath1 with @xmath2 where @xmath3 is a hyperparameter that determines the strength of regularization , @xmath4 is the number of training data @xmath5 , @xmath6 denotes the @xmath7 identity matrix , and @xmath8  is the kernel .",
    "note that , with krr , the computational cost of interpolation scales linearly with the number of training data,@xcite once the training phase is properly conducted . while different kernel functions can be used,@xcite in this work , we used one of the most popular kernels , namely the gaussian kernel : @xmath9 where @xmath10 is a length - scale parameter .",
    "the optimal values for the hyperparameters @xmath3 and @xmath10 need to be carefully chosen , which will be explained in the next subsection .",
    "to obtain a good ml model with krr , one should carefully determine the optimal values for the hyperparameters @xmath3 and @xmath10 .",
    "in the present study , cross - validation schemes were used.@xcite in @xmath11-fold cross - validation ( in this work , @xmath12 ) , the data set @xmath13 is randomly split into equally sized @xmath11 groups ( or bins ) : @xmath14 with @xmath15 .",
    "one group is used as a test data set whereas the remaining @xmath16 groups are regarded as a training data set ; as a consequence , the number of the test data and the number of the training data are @xmath17 and @xmath18 , respectively .    for each data subset @xmath19 consisting of @xmath20 samples ( where @xmath21 denotes the relative complement of a in b ) ,",
    "we train a model using the krr method and predict @xmath22 that can depend on the hyperparameters @xmath3 and @xmath10 .",
    "for each data subset @xmath14 , the prediction error @xmath23 is estimated as the mean square error : @xmath24 ^ 2 .",
    "\\label{delta_l}\\end{aligned}\\ ] ] the cross - validation error can be obtained by averaging @xmath11 different prediction errors . by minimizing the cross - validation error with respect to @xmath3 and @xmath10",
    ", one can find the optimal values of the hyperparameters , @xmath25 and @xmath26 . now that the final model is the one that gives the smallest @xmath27 among @xmath11 training data sets .",
    "a number of descriptors have been developed to represent atomic environments : coulomb matrix,@xcite , bispectrum@xcite and symmetry functions,@xcite to name but a few .",
    "recently , an atomic fingerprint function suggested by botu and ramprasad has been shown to be a good descriptor in predicting atomic forces of solid systems@xcite ; a similar descriptor has been independently proposed by li , kermode , and de vita.@xcite in the following , we consider a system made up of single atom species ( an extension to multi - component systems has also been discussed in the literature@xcite ) . to efficiently represent the force acting on atom @xmath28 with the position @xmath29 at the configuration @xmath30 , @xmath31",
    ", one may use an atom - centered fingerprint function for each cartesian component@xcite : @xmath32 f \\left(r_{ij}^u \\right ) , \\ \\ \\ \\ \\\\ y_i^u",
    "\\left(\\eta \\right ) & = & \\sum_{j \\neq i } \\frac{y_j^u - y_i^u}{r_{ij}^u } \\exp \\left[- \\left(r_{ij}^u/\\eta \\right)^2 \\right ] f \\left(r_{ij}^u",
    "\\right ) , \\ \\ \\ \\ \\\\ z_i^u \\left(\\eta \\right ) & = & \\sum_{j \\neq i } \\frac{z_j^u - z_i^u}{r_{ij}^u } \\exp \\left[- \\left(r_{ij}^u/\\eta \\right)^2 \\right ] f \\left(r_{ij}^u \\right ) , \\ \\ \\ \\ \\end{aligned}\\ ] ] where the distance @xmath33 is the euclidian norm between atoms @xmath28 and @xmath34 at the configuration @xmath30 , and @xmath35 determines the decay rate .",
    "the function @xmath36 is a damping function that smoothly vanishes at a certain cutoff radius . in this work , @xmath36 is given by@xcite @xmath37 \\end{aligned}\\ ] ] for @xmath38 and zero otherwise , where @xmath39 is a cutoff radius .",
    "different values for @xmath39 will be investigated in the results and discussion section . in practice ,",
    "the atomic fingerprint for each cartesian component is given by a @xmath40-dimensional vector : @xmath41 for the @xmath42-component , with similar definitions for @xmath43 and @xmath44 ; and a set of different values for @xmath35 , @xmath45 , efficiently captures the local atomic configurations centered on a reference atom .",
    "when interpolating atomic forces from local atomic configurations , one needs to define the distance between two local environments , since the krr method is based on the principle of similarity . to this end , one may use the euclidean distance between two atomic fingerprint vectors,@xcite although other metrics for the distance can also be applied.@xcite the distance between two local atomic configurations for the @xmath42-component may be defined by @xmath46 ^ 2 } , \\label{distance_x}\\end{aligned}\\ ] ] with similar definitions for the @xmath47- and @xmath48-components .",
    "the distances among the atomic configurations are necessary for evaluating the kernel matrix between training data , and an interpolative prediction of each component of the atomic force can be obtained by a sum of weighted kernel functions , which can be computed using all the distances between a new atomic fingerprint vector and all the training ones .",
    "to generate a variety of data sets for krr , we performed dft - based md simulations on crystalline silicon at different temperatures : 300 , 450 , 600 , 750 , 900 , 1200 , 1500 , and 1650k for a 64-atom system ; 300 , 900 , and 1650k for a 512-sytem .",
    "the electronic structure calculations were carried out using a non - self - consistent tight - binding method , in which the total energy was evaluated by the harris ",
    "foulkes functional@xcite within the local - density approximation to the kohn ",
    "sham density functional theory.@xcite we used a norm - conserving pseudopotential@xcite for si to treat valence - core interactions and a single-@xmath49 basis set with an energy grid cutoff of 108hartree . only the @xmath50 point was used to sample the brillouin zone .",
    "we used a cubic supercell of length @xmath51 ( the density @xmath52g@xmath53 ) for a 64-atom system and a cubic supercell of length @xmath54 for a 512-atom system , with periodic boundary conditions .",
    "we performed each simulation for 10 ps with a time step of 0.5 fs . to generate the canonical ensemble , we employed the nos  hoover chain method,@xcite in which a chain of 5 thermostats with a thermostat frequency of 500@xmath55 was coupled to the ionic motions . the 15th - order yoshida ",
    "suzuki integrator was used to propagate the thermostat part of the time - reversible liouville operator.@xcite the relative errors with respect to target temperatures were below 0.5% for all the temperatures .",
    "all the simulations were performed using the conquest code.@xcite    to obtain an ml model with krr , we created a training data set from the md trajectory at 1650k because of its most expanded configuration space among all the simulations : we selected @xmath4 force data @xmath56 from the time region between 2,001 and 10,000 steps ( i.e. , 15ps ) , where the integers @xmath28 and @xmath30 were randomly chosen .",
    "next , we created test data sets consisting of 10,000 atomic configurations taken from 10,001 to 20,000 steps ( i.e. , 510ps ) at each temperature . after obtaining the optimal model using the krr method together with the cross - validation scheme",
    ", we evaluated the prediction error for the atomic forces as the mean absolute error ( mae ) : @xmath57,\\end{aligned}\\ ] ] where the first sum runs over all the atoms in the supercell and the second sum all the atomic configurations during 510ps ; the integer @xmath58 is the number of atoms and the integer @xmath59 the total number of the atomic configurations .",
    "the function @xmath60 is the predicted value for the @xmath42-component of the atomic force with the fingerprint vector @xmath61 and similar definitions apply to @xmath62 and @xmath63 .",
    "the force error @xmath64 was obtained by averaging over @xmath65 different choices for training data sets .",
    "ml is a purely data - driven , interpolative method ; in other words , it is not guaranteed that extrapolation can predict properties as reliably as interpolation can do . for example , an ml model trained by a data set taken from the md trajectory at 300k may not faithfully predict atomic forces at higher temperatures , since such a training data set does not contain highly distorted local atomic configurations or strong atomic forces caused by elevated thermal fluctuations . on the other hand ,",
    "generating a number of qm data sets at different temperatures is computationally demanding .",
    "to circumvent such extrapolation issues as well as computational burden , we present a simple , intuitive prescription : to use a data set taken from the md trajectory at a higher temperature , because such a data set is likely to be a physically relevant one , in which possible atomic displacements associated with normal modes as well as anharmonic effects are implicitly included .    motivated by this picture , we investigated the histograms of the atomic forces in terms of temperature ( fig .",
    "[ fig : distribution_f]a ) .",
    "we varied the temperature from 300 to 1650k ( which is lower than the experimental melting point@xcite ) .",
    "for all the temperatures , the histograms showed gaussian - like distributions centered on the origin ; and the atomic forces at 1650k were most broadly distributed than those at lower temperatures , meaning that the upper and lower values for the atomic forces were bounded by those at the highest temperature .",
    "this can be quantitatively confirmed by the standard deviation @xmath66 of the atomic forces as a function of temperature ( fig .",
    "[ fig : distribution_f]b ) .",
    "we also checked the atomic forces of a 512-atom system and found that the distributions for the larger system were very similar to those for a 64-atom system ( not shown ) , ensuring the transferability to larger systems .",
    "for the sake of later discussions , it is convenient to define _ force range _ as @xmath67 $ ] , in which about 99% of entries lie,@xcite if the normal distribution is assumed .",
    "for instance , the force range at 300k can be calculated as @xmath68 $ ] in ev /  .    to validate the atomic fingerprints as an adequate descriptor for interpolation in terms of temperature",
    ", we also investigated the histograms of the atomic fingerprints at various temperatures ( fig .",
    "[ fig : distribution_v]a ) .",
    "the distributions of the atomic fingerprints were qualitatively similar to those observed for the atomic forces ; and as was the case for the atomic forces , the upper and lower values for the atomic fingerprints were bounded by those at 1650k .",
    "this was true for all the @xmath35 values examined , where the standard deviations of the atomic fingerprints for lower temperatures were bounded by the one at the highest temperature ( fig .",
    "[ fig : distribution_v]b ) . note that the standard deviation of the atomic fingerprints was more sensitive to smaller @xmath35 values than to larger ones .",
    "our observations suggest a merit of using a training data set taken from the md trajectory at an upper bound of the temperature range ; in this study , we therefore trained our ml model using a data set generated at 1650k , the details of which will be described in the next subsection .",
    "to accurately predict the atomic forces using the atomic fingerprints and krr , we have to carefully choose two key parameters : the fingerprint complexity ( a proper set of @xmath69 ) and the training data set size @xmath4 .",
    "we started by addressing the fingerprint complexity with a fixed training size of @xmath70 . to our knowledge , detailed information about determining an optimal set of @xmath69 values has not been well reported .",
    "here we used a set of equally spaced @xmath35 values within a given cutoff radius @xmath39 : @xmath71 .",
    "this means that the task of finding a proper set of @xmath69 can be reduced to determining a fingerprint vector size @xmath40 within an appropriate cutoff radius .",
    "accordingly , we investigated the force error @xmath64 by changing @xmath39 from @xmath72 up to the size of the supercell , @xmath73 . with a cutoff of @xmath72 ,",
    "the force error was about @xmath74 or 5.3% error with respect to the corresponding force range , resulting in the worst performance among all the cases ( fig .",
    "[ fig : vec_dep_1650 ] ) .",
    "this is because the atomic fingerprint with such a short cutoff could not properly capture the essential information about the nearest atoms . with @xmath39",
    "larger than about @xmath75 ( which roughly corresponds to the first minimum in the radial distribution function ; data not shown ) , the prediction errors were about @xmath76 , or 2% error . obviously , we needed to increase the fingerprint vector size @xmath40 as we increased @xmath39 , in order to achieve similar performance ( fig .",
    "[ fig : vec_dep_1650 ] ) .",
    "using relatively large @xmath39 did not improve the prediction accuracy ( figure  [ fig : vec_dep_1650 ] ) ; for this reason , we chose @xmath77 with a cutoff of @xmath78 in the present study .",
    "while this value for the cutoff radius is shorter than the previously used value ( @xmath79),@xcite our ml model succeeded in predicting the qm forces with good performance .",
    "in general , the proper value for the cutoff radius may depend on materials or chemical species ( e.g. , long - range correlations may be more important for multi - component systems with polarization ) ; nevertheless , our results may imply that accurate description of the nearest atoms plays a primal role in mapping atomic fingerprints to atomic forces of crystalline compounds .",
    "having determined an optimal set of @xmath69 , we then plotted the force error as a function of the number of training data ( fig .",
    "[ fig : num_dep_1650 ] ) .",
    "the prediction error @xmath64 asymptotically decreased with increasing the size @xmath4 of the training data set . even with a training size of @xmath80 , the force error was about 0.16ev /  , or 2.1% error , indicating the efficiency of our ml model as well as our data - selection scheme .",
    "the error is substantially smaller than an estimated force error for the stillinger ",
    "weber potential at 1000k ( about 0.5ev / ).@xcite in the case of @xmath70 , the force error at 1650k was about 0.15ev /  , or 2.0% error with respect to the force range .",
    "we note that about 1000 configurations are sufficient to capture the essential information about local atomic environments for predicting atomic forces.@xcite this is also important because the computational cost required for the training phase in krr scales cubically with respect to the number of training data.@xcite to balance computational effort with prediction accuracy , we trained an ml model using a training size of @xmath70 , with a fingerprint vector size of @xmath81 and @xmath82 .",
    "in this subsection , we address the performance and transferability of our ml model in predicting atomic forces at a wide range of temperatures . to this end",
    ", we applied the ml model ( which was trained in the procedure described earlier ) to a number of data sets taken from the canonical - ensemble md trajectories at various temperatures .",
    "not surprisingly , as temperature increased , so did the force range and the force error .",
    "the force error increased from 0.059 to 0.154ev /   as the temperature was changed from 300 to 1650k ( table 1 ) . here",
    ", we compare the force errors as a percentage of the corresponding force range .",
    "the force errors were below 2% at 3001200k and remained about 2% at 1500 and 1650k ( table 1 ) .",
    "the results suggest the robustness of our ml model at a wide range of temperatures .",
    "our approach presented here is based on the premise that atomic forces should depend only on the local atomic environments , which indicates the transferability to larger system sizes . to verify this view",
    "numerically , we also applied the same ml model to a 512-atom system at three different temperatures : 300 , 900 , and 1650k ( table 2 ) .",
    "the force errors for a 512-atom system were quantitatively similar to those for a 64-atom system ( see tables  1 and 2 ) , demonstrating that the prediction accuracy of atomic forces is independent of the global frame of reference .",
    "our results agree with a recent ml study on qm properties of atoms in molecules.@xcite note that the computational effort of the ml evaluation of atomic forces scales linearly in system size .",
    "figure  [ fig : time_dep_force ] demonstrates the performance and transferability of our ml model along md trajectories for the two system sizes : ( i ) @xmath83k and @xmath84 ; ( ii ) @xmath85k and @xmath84 ; ( iii ) @xmath83k and @xmath86 ; and ( iv ) @xmath85k and @xmath86 . in all the cases , the predictions of the atomic forces were excellent , showing the transferability with respect to temperature as well as system size .",
    "our results indicate that useful and practical ml models could be trained by data sets taken from dft - based md simulations on smaller systems at a higher temperature and that ml models of this kind may be useful for performing md simulations on large , realistic systems at various temperatures and for calculating their thermodynamic and kinetic properties .",
    "by using the krr method together with the atomic fingerprints , we trained an ml model on crystalline silicon system to directly predict the atomic forces in an interpolative manner . from a physical standpoint",
    ", we gave a simple , intuitive prescription to generate a versatile training data set for interpolation : the idea is that interpolation can be made by using merely a qm data set generated at a higher temperature , or an upper bound of the temperature range of interest .",
    "to verify this , we trained an ml model on a 64-atom system using a data set taken from the md trajectory at 1650k and applied the ml model to predict the atomic forces in the temperature range from 300 to 1650k .",
    "the force errors between ml and qm evaluations were about 2% or smaller , demonstrating the accuracy and robustness of our ml model .",
    "we also confirmed the applicability of our ml model to a larger system ( a 512-atom system ) , showing that the prediction accuracy is independent of the global frame of reference .",
    "our results suggest that , once the ml of qm forces at a higher temperature is conducted with a careful cross - validation scheme , interpolation of atomic forces can be made with adequate accuracy for various temperatures and system sizes .",
    "our results imply that practical ml models could be trained by qm data sets obtained from md simulations at a higher temperature and that ml models of this kind may be useful for performing md simulations on large , realistic systems and for calculating their thermodynamic and kinetic properties .",
    "t. s. and r. t. thank masato sumita for helpful discussions . t.",
    "s. and t. m. were partly supported by jsps kakenhi project ( grants no .",
    "26610120 and no .",
    "26246021 ) .",
    "r. t. was partially supported by nippon sheet glass foundation for materials science and engineering .",
    "the md simulations in this study were performed on numerical materials simulator at national institute for materials science .",
    "the calculations for machine learning were performed on the supercomputer at supercomputer center , institute for solid state physics , the university of tokyo .",
    "this work was supported by the `` materials research by information integration '' initiative of the support program for starting up innovation hub , japan science and technology agency and by the wpi initiative on materials nanoarchitectonics , ministry of education , culture , sports , science and technology of japan .",
    ".[tab:64 ] force ranges and the force errors @xmath64 for a 64-atom system .",
    "also presented is the ratio of the force error with respect to the corresponding force range .",
    "each force range was defined by @xmath87 , with @xmath66 being the standard deviation of the atomic forces at each temperature .",
    "see also figure  [ fig : distribution_f]b . [ cols=\"^,^,^,^\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> recently , machine learning has emerged as an alternative , powerful approach for predicting quantum - mechanical properties of molecules and solids . here , using kernel ridge regression and atomic fingerprints representing local environments of atoms , we trained a machine - learning model on a crystalline silicon system in order to directly predict the atomic forces at a wide range of temperatures . </S>",
    "<S> our idea is to construct a machine - learning model using a quantum - mechanical data set taken from canonical - ensemble simulations at a higher temperature , or an upper bound of the temperature range . with our model , the force prediction errors were about 2% or smaller with respect to the corresponding force ranges , in the temperature region between 300 and 1650 k. we also verified the applicability to a larger system , ensuring the transferability with respect to system size .    </S>",
    "<S> biblabel[1]#1 . </S>"
  ]
}