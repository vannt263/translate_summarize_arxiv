{
  "article_text": [
    "pileup , the superposition of many soft proton ",
    "proton collisions over interesting hard - scattering events , is a significant issue at cern s large hadron collider ( lhc ) and also at possible future hadron colliders .",
    "it affects many observables , including lepton and photon isolation , missing - energy determination and especially jet observables .",
    "one main technique currently in use to remove pileup from jet observables  @xcite is known as the area ",
    "median approach  @xcite .",
    "it makes an event - wide estimate of the pileup level , @xmath0 , and then subtracts an appropriate 4-momentum from each jet based on its area , i.e.  its extent in rapidity and azimuth .",
    "detector - level information can also help mitigate the effect of pileup : for example , with methods such as particle flow  @xcite reconstruction , it is to some extent possible to eliminate the charged component of pileup , through the subtraction of contributions from individual charged pileup hadrons .",
    "however , even with such charged hadron subtraction ( chs ) , there is always a substantial remaining ( largely ) neutral pileup contribution , which remains to be removed .",
    "currently , when chs is used , area ",
    "median subtraction is then applied to remove the remaining neutral pileup .",
    "another approach is to use the information about charged pileup hadrons in a specific jet to estimate and subtract the remaining neutral component , without any reference to a jet area or a global event energy density @xmath0 .",
    "its key assumption is that the neutral energy flow is proportional to the charged energy flow and so we dub it neutral - proportional - to - charged ( npc ) subtraction .",
    "an advantage that one might imagine for npc subtraction is that , by using _ local _ information about the charged pileup , it might be better able to account for variations of the pileup from point - to - point within the event than methods that rely on event - wide pileup estimates .",
    "we understand that there has been awareness of this kind of approach in the atlas and cms collaborations for some time now , and we ourselves also investigated it some years ago  @xcite .",
    "our main finding was that at particle level it performed marginally worse than area subtraction combined with chs . from discussions with colleagues in the experimental collaborations",
    ", we had the expectation that there might be further degradation at detector level .",
    "accordingly we left our results unpublished .",
    "recently ref .",
    "@xcite ( klsw ) made a proposal for an approach to pileup removal named jet cleansing .",
    "one of the key ideas that it uses is precisely the npc method , applied to subjets , much in the way that area ",
    "median subtraction has in the past  @xcite been used with filtering  @xcite and trimming  @xcite .",
    "klsw found that cleansing brought large improvements over area ",
    "median subtraction .    given our earlier findings , klsw s",
    "result surprised us .",
    "the purpose of this article is therefore to revisit our study of the npc method and also carry out independent tests of cleansing , both to examine whether we reproduce the large improvements that they observed and to identify possible sources of differences . as part of our study , we will investigate what properties of events can provide insight into the performance of the npc method .",
    "we will also be led to discuss the possible value of charged tracks from the leading vertex in deciding whether to keep or reject individual subjets ( as in charged - track based trimming of ref .",
    "finally we shall also examine how one might optimally combine npc and area ",
    "median subtraction .",
    "npc subtraction relies on the experiments ability to identify whether a given charged track is from a pileup vertex , in order to measure the charged pileup entering a particular jet . to a good extent",
    "this charged component can be removed , for example as in cms s charged - hadron subtraction ( chs ) procedure in the context of particle flow  @xcite .",
    "the npc method then further estimates and subtracts the neutral pileup component by assuming it to be proportional to the charged pileup component .",
    "at least two variants can be conceived of .",
    "if the charged pileup particles are kept as part of the jet during clustering , then the corrected jet momentum is  @xcite @xmath1 where @xmath2 is the four - momentum of the charged - pileup particles in the jet and @xmath3 is the average fraction of pileup transverse momentum that is carried by charged particles .",
    "specifically , one can define @xmath4 where the sums run over particles in a given event ( possibly limited to some central region with tracking ) , and the average is carried out across minimum - bias events .",
    "if the charged pileup particles are not directly included in the clustering ( i.e.  it is the chs event that is provided to the clustering ) , then one does not have any information on which charged particles should be used to estimate the neutral pileup in a given jet .",
    "this problem can be circumvented by a clustering an `` emulated '' chs event , in which the charged - pileup particles are kept , but with their momenta rescaled by an infinitesimal factor @xmath5 . in this case",
    "the correction becomes @xmath6 where @xmath7 is the momentum of the jet as obtained from the emulated chs event , while @xmath8 is the summed momentum of the rescaled charged - pileup particles that are in the jet .",
    "when carrying out npc - style subtraction , this is our preferred approach because it eliminates any backreaction associated with the charged pileup ( this is useful also for area - based subtraction ) , while retaining the information about charged pileup tracks .",
    "there are multiple issues that may be of concern for the npc method .",
    "for example , calorimeter fluctuations can limit the experiments ability to accurately remove the charged pileup component as measured with tracks .",
    "for out - of - time pileup , which contributes to calorimetric energy deposits , charged - track information may not be available at all . in any case",
    ", charged - track information covers only a limited range of detector pseudorapidities .",
    "additionally there are subtleties with hadron masses : in effect , @xmath3 is different for transverse components and for longitudinal components . in this work",
    "we will avoid this problem by treating all particles as massless . , rapidity and azimuth . ]",
    "the importance of the above limitations can only be fully evaluated in an experimental context .",
    "we will be comparing npc to the area ",
    "median method .",
    "the latter makes a global estimate of pileup transverse - momentum flow per unit area , @xmath0 , by dividing an event into similarly sized patches and taking the median of the transverse - momentum per unit area across all the patches .",
    "it then corrects each jet using the globally estimated @xmath0 and the individual jet s area , @xmath9 , @xmath10 like npc , the area ",
    "median method has potential experimental limitations .",
    "they include include questions of non - trivial rapidity dependence and detector non - linearities ( the latter are relevant also for npc ) .",
    "these have , to a reasonable extent , been successfully overcome by the experiments  @xcite .",
    "one respect in which npc may have advantages over the area ",
    "median method is that the latter fails to correctly account for the fact that pileup fluctuates from point to point within the event , a feature that can not be encoded within the global pileup estimate @xmath0 .",
    "determination can be adapted to use just the jet s neighbourhood ( e.g.  as discussed in the context of heavy - ion collisions  @xcite ) , however it can never be restricted to just the jet . ]",
    "furthermore npc does not need a separate estimation of the background density @xmath0 , which can have systematics related to the event structure ( e.g.  @xmath11 events v.  dijet events ) ; and there is no need to include large numbers of ghosts for determining jet areas , a procedure that has a non - negligible computational cost .",
    "let us now proceed with an investigation of npc s performance , focusing our attention on particle - level events for simplicity .",
    "the key question is the potential performance gain due to npc s use of local information . to study this quantitatively",
    ", we consider a circular patch of radius @xmath12 centred at @xmath13 and examine the correlation coefficient of the actual neutral energy flow in the patch with two estimates : ( a ) one based on the charged energy flow in the same patch and ( b ) the other based on a global energy flow determination from the neutral particles , @xmath14 . fig .",
    "[ fig : correl - central ] ( left ) shows these two correlation coefficients , `` ntr v.  chg '' and `` ntr v.  @xmath15 '' , as a function of @xmath12 , for two average pileup multiplicities , @xmath16 and @xmath17 .",
    "one sees that the local neutral - charged correlation is slightly _ lower _ , i.e.  slightly worse , than the neutral-@xmath14 correlation .",
    "both correlations decrease for small patch radii , as is to be expected , and the difference between them is larger at small patch radii .",
    "the correlation is largely independent of the number of pileup events being considered , which is consistent with our expectations , since all individual terms in the determination of the correlation coefficient should have the same scaling with @xmath18 .    .",
    "right : the standard deviation of the difference between neutral transverse momentum in a central patch and either the rescaled charged transverse momentum in that patch or the prediction using the area ",
    "median method , i.e.  @xmath15 .",
    "the events are composed of superposed zero - bias collisions simulated with pythia  8 , tune 4c , and the number of collisions per event is poisson distributed with average @xmath19.,title=\"fig:\",scaledwidth=48.0% ] .",
    "right : the standard deviation of the difference between neutral transverse momentum in a central patch and either the rescaled charged transverse momentum in that patch or the prediction using the area ",
    "median method , i.e.  @xmath15 .",
    "the events are composed of superposed zero - bias collisions simulated with pythia  8 , tune 4c , and the number of collisions per event is poisson distributed with average @xmath19.,title=\"fig:\",scaledwidth=48.0% ]    quantitative interpretations of correlation coefficients can sometimes be delicate , as we discuss in appendix  [ sec : correlation - coefs ] , essentially because they combine the covariance of two observables with the two observables individual variances .",
    "we find that it can be more robust to investigate a quantity @xmath20 , the standard deviation of @xmath21 where the estimate of neutral energy flow , @xmath22 , may be either from the rescaled charged flow or from @xmath23 .",
    "the right - hand plot of fig .",
    "[ fig : correl - central ] shows @xmath20 for the two methods , again as a function of @xmath12 , for two levels of pileup .",
    "it is normalised to @xmath24 , to factor out the expected dependence on both the patch radius and the level of pileup .",
    "a lower value of @xmath20 implies better performance , and as with the correlation we reach the conclusion that a global estimate of @xmath25 appears to be slightly more effective at predicting local neutral energy flow than does the local charged energy flow . if one hoped to use npc to improve on the performance of area ",
    "median subtraction , then figure  [ fig : correl - central ] suggests that one will be disappointed .    in striving for an understanding of this finding",
    ", one should recall that the ratio of charged - to - neutral energy flow is almost entirely driven by non - perturbative effects . inside an energetic jet , the non - perturbative effects are at scales @xmath26 that are tiny compared to the jet transverse momentum @xmath27 .",
    "there are fluctuations in the relative energy carried by charged and neutral particles , for example because a leading @xmath28-quark might pick up a @xmath29 or a @xmath30 from the vacuum .",
    "however , because @xmath31 , the charged and neutral energy flow mostly tend to go in the same direction .",
    "the case that we have just seen of an energetic jet gives an intuition that fluctuations in charged and neutral energy flow are going to be locally correlated .",
    "it is this intuition that motivates the study of npc .",
    "we should however examine if this intuition is actually valid for pileup .",
    "we will examine one step of hadronisation , namely the production of short - lived hadronic resonances , for example a @xmath32 . the opening angle between the @xmath33 decay products of the @xmath32 is of order @xmath34 . given that pileup hadrons",
    "are produced mostly at low @xmath27 , say @xmath35 , and that @xmath36 , the angle between the charged and neutral pions ends up being of order @xmath37 or even larger . as a result , the correlation in direction between charged and neutral energy flow is lost , at least in part .",
    "thus , at low @xmath27 , non - perturbative effects specifically tend to wash out the charged - neutral angular correlation .    , of the transverse momentum in a central circular patch of radius @xmath38 that is due to charged particles .",
    "it is separated into components according to the multiplicity of particles in the patch .",
    "the dashed and dotted histograms show the corresponding charged - fraction distributions for each of the two hardest anti-@xmath39 , @xmath38 jets in simulated dijet events , with two choices for the hard generation cut @xmath40 . ]",
    "this point is illustrated in fig .",
    "[ fig : why - npc - bad ] . we consider zero - bias events and examine a circular patch of radius @xmath38 centred at @xmath13 .",
    "the figure shows the distribution of the charged @xmath27 fraction , @xmath41 , @xmath42 in the patch ( filled histogram , broken into contributions where the patch contains @xmath37 , @xmath43 or more particles ) .",
    "the same plot also shows the distribution of the charged @xmath27 fraction in each of the two leading anti-@xmath39 , @xmath38 jets in dijet events ( dashed and dotted histograms ) . whereas the charged - to - total ratio for a jet has a distribution peaked around @xmath44 , as one would expect , albeit with a broad distribution ,",
    "the result for zero - bias events is striking : in about 60% of events the patch is either just charged or just neutral , quite often consisting of just a single particle ( weighting by the @xmath27 flow in the patch , the figure goes down to 30% ) .",
    "this is probably part of the reason why charged information provides only limited local information about neutral energy flow in pileup events .",
    "these considerations are confirmed by an analysis of the actual performance of npc and area ",
    "median subtraction .",
    "we reconstruct jets using the anti-@xmath39 algorithm  @xcite , as implemented in fastjet  @xcite , with a jet radius parameter of @xmath38 .",
    "we study dijet and pileup events generated with pythia  8.176  @xcite , in tune 4c ; we assume idealised chs , treating the charged pileup particles as ghosts . in the dijet ( `` hard '' ) event alone , i.e.  without pileup , we run the jet algorithm and identify jets with absolute rapidity @xmath45 and transverse momentum @xmath46 .",
    "then in the event with superposed pileup ( the `` full '' event ) we rerun the jet algorithm and identify the jets that match those selected in the hard event for the matching , we introduce a quantity @xmath47 , the scalar sum of the @xmath27 s of the constituents that are common to a given pair @xmath48 of hard and full jets . for a hard jet @xmath49 ,",
    "the matched jet in the full event is the one that has the largest @xmath50 . in principle , one full jet can match two hard jets , e.g.  if two nearby hard jets end up merged into a single full jet due to back - reaction effects .",
    "however this is exceedingly rare . ] and subtract them using either npc , eq .",
    "( [ eq : npc - chs ] ) , or the area  median method , eq .",
    "( [ eq : rho - subtraction ] ) , with @xmath0 estimated from the chs event .",
    "the hard events are generated with the underlying event turned off , which enables us to avoid subtleties related to the simultaneous subtraction of the underlying event .    , the average difference in @xmath27 between a jet after pileup addition and subtraction and the corresponding matched jet in the hard sample , @xmath51 .",
    "the right - hand plot shows the standard deviation of @xmath52 ( lower values are better ) .",
    "npc is shown only for chs events , while area ",
    "median subtraction is shown both for events with chs and for events without it ( `` full '' ) .",
    ", title=\"fig:\",scaledwidth=48.0% ] , the average difference in @xmath27 between a jet after pileup addition and subtraction and the corresponding matched jet in the hard sample , @xmath51 .",
    "the right - hand plot shows the standard deviation of @xmath52 ( lower values are better ) .",
    "npc is shown only for chs events , while area ",
    "median subtraction is shown both for events with chs and for events without it ( `` full '' ) .",
    ", title=\"fig:\",scaledwidth=48.0% ]    figure  [ fig : npc - performance ] provides the resulting comparison of the performance of the npc and area ",
    "median subtraction methods ( the latter in chs and in full events ) .",
    "the left - hand plot shows the average difference between the subtracted jet @xmath27 and the @xmath27 of the corresponding matched hard jet , as a function of the number of pileup interactions .",
    "both methods clearly perform well here , with the average difference systematically well below @xmath53 even for very high pileup levels .",
    "the right - hand plot shows the standard deviation of the difference between the hard and subtracted full jet @xmath27 .",
    "a lower value indicates better performance , and one sees that in chs events the area ",
    "median method indeed appears to have a small , but consistent advantage over npc . comparing area ",
    "median subtraction in chs and full events , one observes a significant degradation in resolution when one fails to use the available information about charged particles in correcting the charged component of pileup , as is to be expected for a particle - level study .",
    "the conclusion of this section is that the npc method fails to give a superior performance to the area ",
    "median method in chs events .",
    "this is because the local correlations of neutral and charged energy flow are no greater than the correlations between local neutral energy flow and the global energy flow .",
    "we believe that part of the reason for this is that the hadronisation process for low @xmath27 particles intrinsically tends to produce hadrons separated by large angles , as illustrated concretely in the case of @xmath54 resonance decay .",
    "part of the original motivation for our work here was to cross check a method recently introduced by krohn , low , schwartz and wang ( klsw ) and called jet cleansing  @xcite .",
    "cleansing comes in several variants .",
    "we will concentrate on linear cleansing , which was seen to perform well across a variety of observables by klsw . , the ratio of the charged @xmath27 from the leading vertex to the total charged @xmath27 ( including pileup ) in the subjet .",
    "gaussian is particularly interesting in that it effectively carries out a @xmath55 minimisation across different hypotheses for the ratio of charged to neutral energy flow , separately for the pileup and the hard event .",
    "however in klsw s results its performance was usually only marginally better than the much simpler linear cleansing .",
    "accordingly we concentrate on the latter . ]",
    "it involves several elements : it breaks a jet into multiple subjets , as done for grooming methods like filtering and trimming  @xcite ( cf .",
    "also the early work by seymour  @xcite ) . in its `` linear '' variant ,",
    "it then corrects individual subjets for pileup by a method that is essentially the same as the npc approach described in the previous section .",
    "cleansing may also be used in conjunction with trimming - style cuts to the subtracted subjets , specifically it can remove those whose corrected transverse momentum is less than some fraction @xmath56 of the overall jet s transverse momentum ( as evaluated before pileup removal ) . for cleansing , reflecting our understanding of the choices made in v1 of ref .",
    "@xcite , which stated `` [ we ] supplement cleansing by applying a cut on the ratio @xmath57 of the subjet @xmath58 ( after cleansing ) to the total jet @xmath58 .",
    "subjets with @xmath59 are discarded .",
    "[ ... ] where we do trim / cleanse we employ @xmath60 subjets and take @xmath61 . ''",
    "subsequent to the appearance of v1 of our article , the authors of ref .",
    "@xcite clarified that the results in their fig .",
    "4 had used @xmath62 .",
    "this is the choice that we adopt throughout most of this version , and it has an impact notably on the conclusions for the jet - mass performance . ]    .",
    "upper right plot : similarly for the single jet mass .",
    "both plots are for a hadronically decaying @xmath63 sample with @xmath64 .",
    "decays are included to all flavours except @xmath11 and @xmath65-hadrons are taken stable .",
    "lower - left plot : the correlation coefficient for the dijet - mass , as in the upper - left plot , but with a sample of @xmath63 bosons that decay only to @xmath28 , @xmath66 and @xmath67 quarks .",
    "jets are reconstructed , as in ref .",
    "@xcite , with the anti-@xmath39 algorithm with @xmath68 . for both trimming and cleansing ,",
    "subjets are reconstructed with the @xmath39 algorithm with @xmath60 and the @xmath69 value that is applied is @xmath62 .",
    "[ fig : f00 ] ]    .",
    "upper right plot : similarly for the single jet mass .",
    "both plots are for a hadronically decaying @xmath63 sample with @xmath64 .",
    "decays are included to all flavours except @xmath11 and @xmath65-hadrons are taken stable .",
    "lower - left plot : the correlation coefficient for the dijet - mass , as in the upper - left plot , but with a sample of @xmath63 bosons that decay only to @xmath28 , @xmath66 and @xmath67 quarks .",
    "jets are reconstructed , as in ref .",
    "@xcite , with the anti-@xmath39 algorithm with @xmath68 . for both trimming and cleansing",
    ", subjets are reconstructed with the @xmath39 algorithm with @xmath60 and the @xmath69 value that is applied is @xmath62 .",
    "[ fig : f00 ] ]     +    .",
    "upper right plot : similarly for the single jet mass .",
    "both plots are for a hadronically decaying @xmath63 sample with @xmath64 .",
    "decays are included to all flavours except @xmath11 and @xmath65-hadrons are taken stable .",
    "lower - left plot : the correlation coefficient for the dijet - mass , as in the upper - left plot , but with a sample of @xmath63 bosons that decay only to @xmath28 , @xmath66 and @xmath67 quarks .",
    "jets are reconstructed , as in ref .",
    "@xcite , with the anti-@xmath39 algorithm with @xmath68 . for both trimming and cleansing ,",
    "subjets are reconstructed with the @xmath39 algorithm with @xmath60 and the @xmath69 value that is applied is @xmath62 . [",
    "fig : f00 ] ]    the top left - hand plot of fig .",
    "[ fig : f00 ] shows the correlation coefficient between the dijet mass in a hard event and the dijet mass after addition of pileup and application of each of several pileup mitigation methods .",
    "the results are shown as a function of @xmath18 .",
    "the pileup mitigation methods include two forms of cleansing ( with @xmath62 ) , area  median subtraction , chs+area subtraction , and chs+area subtraction in conjunction with trimming ( also with @xmath62 ) .",
    "the top right - hand plots shows the corresponding results for the jet mass . for the dijet mass",
    "we see that linear ( and gaussian ) cleansing performs worse than area subtraction , while in the right - hand plot , for the jet mass , we see linear ( and gaussian ) cleansing performing better than area subtraction , albeit not to the extent found in ref .",
    "these ( and , unless explicitly stated , our other @xmath63 results ) have been generated with the @xmath63 decaying to all flavours except @xmath11 , and @xmath65-hadrons have been kept stable .- tagging studies .",
    "experimentally , in the future , one might even imagine an `` idealised '' form of particle flow that attempts to reconstruct @xmath65-hadrons ( or at least their charged part ) from displaced tracks before jet clustering . ]",
    "the lower plot shows the dijet mass for a different @xmath63 sample , one that decays only to @xmath28 , @xmath66 and @xmath67 quarks , but not @xmath70 and @xmath71 quarks .",
    "most of the results are essentially unchanged .",
    "the exception is cleansing , which turns out to be very sensitive to the sample choice . without stable @xmath65-hadrons in the sample ,",
    "its performance improves noticeably and at high pileup becomes comparable to that of area - subtraction . both of the left - hand plots in our fig .",
    "[ fig : f00 ] differ noticeably from fig .  4 ( left ) of ref .",
    "@xcite and in particular they are not consistent with klsw s observation of much improved correlation coefficients for the dijet mass with cleansing relative to area+chs subtraction .    given our results on npc in section  [ sec : npc ] ,",
    "we were puzzled by the difference between the performance of area - subtraction plus trimming versus that of cleansing : our expectation is that their performances should be very similar .",
    "decrease with increasing @xmath18 and suggest ( see also @xcite , pp .",
    "16 and 17 ) that this will improve the determination of this fraction and therefore the effectiveness of a method like cleansing , based on a neutral - proportional - to - charged approach . however , this does not happen because , while relative fluctuations around @xmath72 do indeed decrease proportionally to @xmath73 ( a result of the incoherent addition of many pileup events and of the central limit theorem ) , the absolute uncertainty that they induce on a pileup - subtracted quantity involves an additional factor @xmath18 .",
    "the product of the two terms is therefore proportional to @xmath74 , i.e. the same scaling as the area - median method .",
    "this is consistent with our observations .",
    "note that for area subtraction , the switch from full events to chs events has the effect of reducing the coefficient in front of @xmath74 . ]",
    "the strong sample - dependence of the cleansing performance also calls for an explanation .",
    "we thus continued our study of the question .    according to the description in ref .",
    "@xcite , one additional characteristic of linear cleansing relative to area - subtraction is that it switches to jet - vertex - fraction ( jvf ) cleansing when the npc - style rescaling would give a negative answer .",
    "in contrast , area - subtraction plus trimming simply sets the ( sub)jet momentum to zero .",
    "we explicitly tried turning the switch to jvf - cleansing on and off and found it had a small effect and did not explain the differences .",
    "study of the public code for jet cleansing reveals an additional condition being applied to subjets : if a subjet contains no charged particles from the leading vertex ( lv ) , then its momentum is set to zero .",
    "this step appears not to have been mentioned in ref .",
    "since we will be discussing it extensively , we find it useful to give it a name , `` _ _ zeroing _ _ '' .",
    "zeroing can be thought of as an extreme limit of the charged - track based trimming procedure introduced by atlas  @xcite , whereby a jvf - style cut is applied to reject subjets whose charged - momentum fraction from the leading vertex is too low .",
    "zeroing turns out to be crucial : if we use it in conjunction with chs area - subtraction ( or with npc subtraction ) and @xmath62 trimming , we obtain results that are very similar to those from cleansing .",
    "conversely , if we turn this step off in linear - cleansing , its results come into accord with those from ( chs ) area - subtraction or npc - subtraction with @xmath62 trimming .    to help illustrate this , fig .",
    "[ fig : shifts - dispersions - r1 ] shows a `` fingerprint '' for each of several pileup - removal methods , for both the jet @xmath27 ( left ) and mass ( right ) .",
    "the fingerprint includes the average shift ( @xmath75 or @xmath76 ) of the observable after pileup removal , shown in black .",
    "it also includes two measures of the width of the @xmath52 and @xmath77 distributions : the dispersion ( i.e. standard deviation ) in red and an alternative peak - width measure in blue .",
    "the latter is defined as follows : one determines the width of the smallest window that contains @xmath78 of entries and then scales this width by a factor @xmath79 . for a gaussian distribution",
    ", the rescaling ensures that the resulting peak - width measure is equal to the dispersion . for a non - gaussian distribution",
    "the two measures usually differ and the orange shaded region quantifies the extent of this difference .",
    "the solid black , blue and red lines have been obtained from samples in which the @xmath63 decays just to light quarks ; the dotted lines are for a sample including @xmath80 and @xmath81 decays ( with stable @xmath65-hadrons ) , providing an indication of the sample dependence ; in many cases they are indistinguishable from the solid lines .    comparing @xmath62 grooming for npc , area ( without zeroing ) and cleansing with zeroing manually disabled , all have very similar fingerprints . turning on",
    "zeroing in the different methods leads to a significant change in the fingerprints , but again npc , area and cleansing are very similar .",
    "case with zeroing , suggesting that there may be an advantage from combinations of different constraints on subjet momenta . ]    ) in the jet @xmath27 after addition of pileup and removal by a range of methods .",
    "it shows the average shift @xmath82 ( in black ) and the peak width ( in blue ) and dispersion ( in red ) of the @xmath52 distribution .",
    "the peak width is defined as the smallest window of @xmath52 that contains 90% of the @xmath52 distribution , scaled by a factor @xmath83 such that in the case of a gaussian distribution the result agrees with the dispersion .",
    "the right - hand plot shows the same set of results for the jet mass .",
    "the results are obtained in a sample of events with the number of pileup vertices distributed uniformly between @xmath84 and @xmath85 .",
    "the hard events consist of hadronic @xmath63 decays : for the solid vertical lines the sample is @xmath86 , while for the dotted lines ( sometimes not visible because directly over the solid lines ) , the sample additionally includes @xmath87 with @xmath65 hadrons kept stable .",
    "the @xmath63 mass is @xmath88 and jets are reconstructed with the anti-@xmath39 algorithm with @xmath68 .",
    "all results in this figure include charged - hadron subtraction by default .",
    "the default form of cleansing , as used e.g.  in fig .",
    "[ fig : f00 ] , is `` @xmath62 zeroing '' .",
    ", title=\"fig:\",scaledwidth=48.0% ] ) in the jet @xmath27 after addition of pileup and removal by a range of methods .",
    "it shows the average shift @xmath82 ( in black ) and the peak width ( in blue ) and dispersion ( in red ) of the @xmath52 distribution .",
    "the peak width is defined as the smallest window of @xmath52 that contains 90% of the @xmath52 distribution , scaled by a factor @xmath83 such that in the case of a gaussian distribution the result agrees with the dispersion .",
    "the right - hand plot shows the same set of results for the jet mass .",
    "the results are obtained in a sample of events with the number of pileup vertices distributed uniformly between @xmath84 and @xmath85 .",
    "the hard events consist of hadronic @xmath63 decays : for the solid vertical lines the sample is @xmath86 , while for the dotted lines ( sometimes not visible because directly over the solid lines ) , the sample additionally includes @xmath87 with @xmath65 hadrons kept stable .",
    "the @xmath63 mass is @xmath88 and jets are reconstructed with the anti-@xmath39 algorithm with @xmath68 .",
    "all results in this figure include charged - hadron subtraction by default .",
    "the default form of cleansing , as used e.g.  in fig .",
    "[ fig : f00 ] , is `` @xmath62 zeroing '' .",
    ", title=\"fig:\",scaledwidth=48.0% ]    when used with @xmath62 trimming , and when examining quality measures such as the dispersion ( in red , or the closely related correlation coefficient , cf .",
    "appendix  [ sec : correlation - coefs ] ) , subjet zeroing appears to be advantageous for the jet mass , but potentially problematic for the jet @xmath27 and the dijet mass .",
    "however , the dispersion quality measure does not tell the full story regarding the impact of zeroing .",
    "examining simultaneously the peak - width measure ( in blue ) makes it easier to disentangle two different effects of zeroing .",
    "on one hand we find that zeroing correctly rejects subjets that are entirely due to fluctuations of the pileup .",
    "this narrows the peak of the @xmath52 or @xmath77 distribution , substantially reducing the ( blue ) peak - width measures in fig .",
    "[ fig : shifts - dispersions - r1 ] . on the other hand ,",
    "zeroing sometimes incorrectly rejects subjets that have no charged tracks from the lv but do have significant neutral energy flow from the lv .",
    "this can lead to long tails for the @xmath52 or @xmath77 distributions , adversely affecting the dispersion .",
    "it is the interplay between the narrower peak and the longer tails that affects whether overall the dispersion goes up or down with zeroing .",
    "in particular the tails appear to matter more for the jet @xmath27 and dijet mass than they do for the single - jet mass .",
    "note that accurate monte carlo simulation of such tails may be quite challenging : they appear to be associated with configurations where a subjet contains an unusually small number of energetic neutral particles .",
    "such configurations are similar to those that give rise to fake isolated photons or leptons and that are widely known to be difficult to simulate correctly .",
    "we commented earlier that the cleansing performance has a significant sample dependence .",
    "this is directly related to the zeroing : indeed fig .",
    "[ fig : shifts - dispersions - r1 ] shows that for cleansing without zeroing , the sample dependence ( dashed versus solid lines ) vanishes , while it is substantial with zeroing .",
    "our understanding of this feature is that the lower multiplicity of jets with undecayed @xmath65-hadrons ( and related hard fragmentation of the @xmath65-hadron ) results in a higher likelihood that a subjet will contain neutral but no charged particles from the lv , thus enhancing the impact of zeroing on the tail of the @xmath52 or @xmath89 sample .",
    "the long tails produced by the zeroing are not necessarily unavoidable .",
    "in particular , they can correspond to the loss of subjets with tens of gev , yet it is very unlikely that a subjet from a pileup collision will be responsible for such a large energy .",
    "therefore we introduce a modified procedure that we call `` _ _ protected zeroing _ _ '' : one rejects any subjet without lv tracks _ unless _ its @xmath27 after subtraction is @xmath90 times larger than the largest charged @xmath27 in the subjet from any single pileup vertex ( or , more simply , just above some threshold @xmath91 ; however , using @xmath90 times the largest charged subjet @xmath27 could arguably be better both in cases where one explores a wide range of @xmath18 and for situations involving a hard subjet from a pileup collision ) . taking @xmath92 ( or a fixed @xmath93 ) we have found reduced tails and , consequently , noticeable improvements in the jet @xmath27 and dijet mass dispersion ( with little effect for the jet mass ) .",
    "this is visible for area and npc subtraction in fig .",
    "[ fig : shifts - dispersions - r1 ] . protected zeroing also eliminates the sample dependence .. we thank david miller for exchanges on this point . ]",
    "several additional comments can be made about @xmath62 trimming combined with zeroing .",
    "firstly , @xmath62 trimming alone introduces a bias in the jet @xmath27 , which is clearly visible in the @xmath62 no - zeroing shifts in fig .",
    "[ fig : shifts - dispersions - r1 ] .",
    "this is because the trimming removes negative fluctuations of the pileup , but keeps the positive fluctuations .",
    "zeroing then counteracts that bias by removing some of the positive fluctuations , those that happened not to have any charged tracks from the lv .",
    "it also introduces further negative fluctuations for subjets that happened to have some neutral energy flow but no charged tracks .",
    "overall , one sees that the final net bias comes out to be relatively small .",
    "this kind of cancellation between different biases is common in noise - reducing pileup - reduction approaches  @xcite .",
    "( left ) for a jet radius of @xmath38 , subjet radius ( where relevant ) of @xmath94 and a qcd continuum dijet sample generated with pythia  8 .",
    "the underlying event is turned off in the sample and @xmath65 hadrons decay .",
    "we consider only jets that in the hard sample have @xmath95 and @xmath96 .",
    "right : the dispersions for a subset of the methods , shown as a function of the number of pileup events .",
    "[ fig : shifts - dispersions - dijet - r0.4 ] ]     ( left ) for a jet radius of @xmath38 , subjet radius ( where relevant ) of @xmath94 and a qcd continuum dijet sample generated with pythia  8 .",
    "the underlying event is turned off in the sample and @xmath65 hadrons decay .",
    "we consider only jets that in the hard sample have @xmath95 and @xmath96 .",
    "right : the dispersions for a subset of the methods , shown as a function of the number of pileup events .",
    "[ fig : shifts - dispersions - dijet - r0.4 ] ]     ( right ) , showing the performance for the jet mass , but now with @xmath97 applied to both trimming and cleansing and in a sample of hadronically - decaying boosted @xmath98 bosons ( @xmath99 ) .",
    "the jets reconstructed after addition and subtraction of pileup are compared to trimmed hard jets .",
    "jets are reconstructed with a jet radius of @xmath68 and a subjet radius of @xmath100 . only hard jets with @xmath101 and @xmath102 ( before trimming ) are considered and we let @xmath65 hadrons decay . [",
    "fig : shifts - dispersions - ww500-r10 ] ]    most of the studies so far in this section have been carried out with a setup that is similar to that of ref .",
    "@xcite , i.e.  @xmath68 jets in a @xmath63 sample with @xmath62 trimming .",
    "this is not a common setup for most practical applications . for most uses of jets",
    ", @xmath38 is a standard choice and pileup is at its most severe at low to moderate @xmath27 .",
    "accordingly , in fig .",
    "[ fig : shifts - dispersions - dijet - r0.4 ] ( left ) we show the analogue of fig .",
    "[ fig : shifts - dispersions - r1 ] s summary for the jet @xmath27 , but now for @xmath38 , with @xmath94 in a qcd dijet sample , considering jets that in the hard event had @xmath95 .",
    "we see that qualitatively the pattern is quite similar to that in fig .",
    "[ fig : shifts - dispersions - r1 ] .",
    "s , the difference between zeroing and protected zeroing might be expected to disappear .",
    "this is because the long negative tails are suppressed by the low jet @xmath27 itself . ]",
    "quantitatively , the difference between the various choices is much smaller , with about a @xmath103 reduction in dispersion ( or width ) in going from ungroomed chs area - subtraction to the @xmath62 protected subjet - zeroing case .",
    "one should be aware that this study is only for a single @xmath27 , across a broad range of pileup .",
    "the dispersions for a subset of the methods are shown as a function of the number of pileup vertices in the right - hand plot of fig .",
    "[ fig : shifts - dispersions - dijet - r0.4 ] .",
    "that plot also includes results from the softkiller method  @xcite and illustrates that the benefit from protected zeroing ( comparing the solid and dashed blue curves ) is about half of the benefit that is brought from softkiller ( comparing solid blue and black curves ) .",
    "these plots show that protected zeroing is potentially of interest for jet @xmath27 determinations in realistic conditions .",
    "thus it would probably benefit from further study : one should , for example , check its behaviour across a range of transverse momenta , determine optimal choices for the protection of the zeroing and investigate also how best to combine it with particle - level subtraction methods such as softkiller .",
    "pattern that is observed for area and npc subtraction alone . ]    turning now to jet masses , the use of @xmath68 is a not uncommon choice , however most applications use a groomed jet mass with a non - zero @xmath69 ( or its equivalent ) : this improves mass resolution in the hard event even without pileup , and it also reduces backgrounds , changing the perturbative structure of the jet  @xcite even in the absence of pileup .",
    "trimming , the jet structure is unchanced in the absence of pileup . ] accordingly in fig .",
    "[ fig : shifts - dispersions - ww500-r10 ] we show @xmath97 results ( with shifts and widths computed relative to @xmath97 trimmed hard jets ) for a hard @xmath104 sample where the hard fat jets are required to have @xmath101 . zeroing , whether protected or not , appears to have little impact . one potential explanation for this fact is as follows : zeroing s benefit comes primarily because it rejects fairly low-@xmath27 pileup subjets that happen to have no charged particles from the leading vertex .",
    "however for a pileup subjet to pass the @xmath97 filtering criterion in our sample , it would have to have @xmath105 .",
    "this is quite rare .",
    "thus filtering is already removing the pileup subjets , with little further to be gained from the charged - based zeroing . as in the plain jet - mass summary plot , protection of zeroing appears to have little impact for the trimmed jet mass .",
    "cleansing appears to perform slightly worse than trimming with npc or area subtraction .",
    "one difference in behaviour that might explain this is that the @xmath27 threshold for cleansing s trimming step is @xmath106 ( even in the chs - like ` input_nc_separate ` mode that we use ) .",
    "in contrast , for the area and npc - based results , it is @xmath107 . in both cases",
    "the threshold , which is applied to subtracted subjets , is increased in the presence of pileup , but this increase is more substantial in the cleansing case .",
    "this could conceivably worsen the correspondence between trimming in the hard and full samples .",
    "for the area and npc cases , we investigated the option of using @xmath108 or @xmath109 and found that this brings a small additional benefit . ]",
    "does that mean that ( protected ) zeroing has no scope for improving the trimmed - jet mass ?",
    "the answer is `` not necessarily '' : one could for example imagine first applying protected zeroing to subjets on some angular scale @xmath110 in order to eliminate low-@xmath27 contamination ; then reclustering the remaining constituents on a scale @xmath111 , subtracting according to the area or npc methods , and finally applying the trimming momentum cut ( while also keeping in mind the considerations of footnote [ footnote : trimming - ref ] ) .",
    "we close this section with a summary of our findings . based on its description in ref .",
    "@xcite and our findings about npc v.  area subtraction , cleansing with @xmath62 would be expected to have a performance very similar to that of chs+area subtraction with @xmath62 trimming .",
    "@xcite however reported large improvements for the correlation coefficients of the dijet mass and the single jet mass using @xmath68 jets . in the case of the dijet mass",
    "we do not see these improvements , though they do appear to be there for the jet mass .",
    "the differences in behaviour between cleansing and trimmed chs+area - subtraction call for an explanation , and appear to be due to a step in the cleansing code that was undocumented in ref .",
    "@xcite and that we dubbed `` zeroing '' : if a subjet contains no charged tracks from the leading vertex it is discarded .",
    "zeroing is an extreme form of a procedure described in ref .",
    "in can be used also with area or npc subtraction , and we find that it brings a benefit for the peak of the @xmath52 and @xmath77 distributions , but appears to introduce long tails in @xmath52 . a variant , `` protected zeroing '' , can avoid the long tails by still accepting subjets without leading - vertex tracks , if their @xmath27 is above some threshold , which may be chosen dynamically based on the properties of the pileup . in our opinion , a phenomenologicaly realistic estimate of the benefit of zeroing ( protected or not ) requires study not of @xmath68 plain jets , but instead of @xmath38 jets ( for the jet @xmath27 ) or larger-@xmath12 trimmed jets with a non - zero @xmath69 ( for the jet mass ) . in a first investigation , there appear to be some phenomenological benefits from protected zeroing for the @xmath38 jet @xmath27 , whereas to obtain benefits for large-@xmath12 trimmed jets would probably require further adaptation of the procedure . in any case , additional study is required for a full evaluation of protected zeroing and related procedures .",
    "it is interesting to further probe the relation between npc and the area  median method , to establish whether there might be a benefit from combining them : the area ",
    "median method makes a mistake in predicting local energy flow mainly because local energy flow fluctuates from region to region .",
    "npc makes a mistake because charged and neutral energy flow are not @xmath112 locally correlated .",
    "the key question is whether , for a given jet , npc and the area ",
    "median method generally make the same mistake , or if instead they are making uncorrelated mistakes . in the latter case it should be possible to combine the information from the two methods to obtain an improvement in subtraction performance .",
    "let @xmath113 be the actual neutral pileup component flowing into a jet , while @xmath114 are , respectively , the estimates for the neutral pileup based on the local charged @xmath27 flow and on @xmath115 .",
    "we assume the use of chs events and , in particular , that @xmath0 is as determined from the chs event .",
    "concentrating on the transverse components , the extent to which the two estimates provide complementary information can be quantified in terms of ( one minus ) the correlation coefficient , @xmath41 , between @xmath116 and @xmath117 .",
    "that correlation is shown as a function of @xmath12 in fig .",
    "[ fig : correl - mistakes ] ( left ) , and it is quite high , in the range @xmath44@xmath118 for commonly used @xmath12 choices . it is largely independent of the number of pileup vertices .",
    "let us now quantify the gain to be had from a linear combination of the two prediction methods , i.e.  using an estimate @xmath119 where @xmath57 is to be chosen to as to minimise the dispersion of @xmath120 .",
    "given dispersions @xmath121 and @xmath122 respectively for @xmath116 and @xmath123 , the optimal @xmath57 is @xmath124 which is plotted as a function of @xmath12 in fig .",
    "[ fig : correl - mistakes ] ( right ) , and the resulting squared dispersion for @xmath120 is @xmath125 reading @xmath126 from fig .",
    "[ fig : correl - mistakes ] ( left ) for @xmath38 , and @xmath127 from fig .",
    "[ fig : correl - central ] ( right ) , one finds @xmath128 . because of the substantial correlation between the two methods , ones expects only a modest gain from their linear combination .     and",
    "@xmath129 , shown as a function of @xmath12 .",
    "right : optimal weight @xmath57 for combining npc and area pileup subtraction , eq .",
    "( [ eq : best f ] ) , as a function of @xmath12 . , title=\"fig:\",scaledwidth=48.0% ]   and @xmath129 , shown as a function of @xmath12 .",
    "right : optimal weight @xmath57 for combining npc and area pileup subtraction , eq .",
    "( [ eq : best f ] ) , as a function of @xmath12 . ,",
    "title=\"fig:\",scaledwidth=48.0% ]     and the right - hand one for the jet mass.,title=\"fig:\",scaledwidth=48.0% ]   and the right - hand one for the jet mass.,title=\"fig:\",scaledwidth=48.0% ]    in fig .",
    "[ fig : chg+rhoa - improvement ] we compare the performance of pileup subtraction from the combination of the npc and the area  median methods , using the optimal value @xmath130 that can be read from fig .",
    "[ fig : correl - mistakes ] ( right ) for @xmath38 , both for the jet @xmath27 and the jet mass .",
    "the expected small gain is indeed observed for the jet @xmath27 , and it is slightly larger for the jet mass .",
    ": we found that the true optimum value of @xmath57 in the monte carlo studies is slightly different from that predicted by eq .",
    "( [ eq : best f ] ) .",
    "however the dependence on @xmath57 around its minimum is very weak , rendering the details of its exact choice somewhat immaterial . ]",
    "given the modest size of the gain , one may wonder how phenomenologically relevant it is likely to be .",
    "nevertheless , one might still consider investigating whether the gain carries over also to a realistic experimental environment with full detector effects .",
    "one natural approach to pileup removal is to use the charged pileup particles in a given jet to estimate the amount of neutral pileup that needs to be removed from that same jet . in this article , with the help of particle - level simulations , we have studied such a method ( npc ) and found that it has a performance that is similar to , though slightly worse than the existing , widely used area ",
    "median method .",
    "this can be related to the observation that the correlations between local charged and neutral energy flow are no larger than those between global and local energy flow .",
    "tentatively , we believe that this is in part because the non - perturbative effects that characterise typical inelastic proton - proton collisions act to destroy local charged - neutral correlation .    the absence of benefit that we found from the npc method led us to question the substantial performance gains quoted for the method of cleansing in ref .",
    "@xcite , one of whose key differences with respect to earlier work is the replacement of the area  median method with npc . for the dijet mass , we are unable to reproduce the large improvement observed in ref .",
    "@xcite , in the correlation coefficient performance measure , for cleansing relative to area subtraction .",
    "we do however see an improvement for the jet mass .",
    "we trace a key difference in the behaviour of cleansing and area subtraction to the use in the cleansing code of a step that was not documented in ref .",
    "@xcite and that discards subjets that contain no tracks from the leading vertex .",
    "this `` zeroing '' step , similar to the charged - track based trimming introduced by atlas  @xcite , can indeed be of benefit .",
    "it has a drawback of introducing tails in some distributions due to subjets with a substantial neutral @xmath27 from the leading vertex , but no charged tracks . as a result ,",
    "different quality measures lead to different conclusions as to the benefits of zeroing .",
    "the tails can be alleviated by a variant of zeroing that we introduce here , `` protected zeroing '' , whereby subjets without lv charged tracks are rejected only if their @xmath27 is below some ( possibly pileup - dependent ) threshold .",
    "protected zeroing does in some cases appear to have phenomenological benefits , which are observed across all quality measures .    given two different methods for pileup removal , npc and area ",
    "median subtraction , it is natural to ask how independent they are and what benefit might be had by combining them .",
    "this was the question investigated in section  [ sec : combination ] , where we provided a formula for an optimal linear combination of the two methods , as a function of their degree of correlation .",
    "ultimately we found that npc and area ",
    "median subtraction are quite highly correlated , which limits the gains from their combination to about a @xmath131 percent reduction in dispersion . while modest , this might still be sufficient to warrant experimental investigation , as are other methods , currently being developed , that exploit constituent - level subtraction  @xcite .",
    "a study of the integration of those methods with protected zeroing would also be of interest .",
    "code for our implementation of area subtraction with positive - definite mass is available as part of fastjet versions 3.1.0 and higher .",
    "public code and samples for carrying out a subset of the comparisons with cleansing described in section  [ sec : appraisal ] , including also the npc subtraction tools , are available from ref .  @xcite .",
    "our understanding of pileup effects in the lhc experiments has benefited extensively from discussions with peter loch , david miller , filip moortgat , sal rappoccio , ariel schwartzman and numerous others .",
    "we are grateful to david krohn , matthew low , matthew schwartz and liantao wang for exchanges about their results .",
    "this work was supported by erc advanced grant higgs@lhc , by the french agence nationale de la recherche , under grant anr-10-cexc-009 - 01 , by the eu itn grant lhcphenonet , pitn - ga-2010 - 264564 and by the ilp labex ( anr-10-labx-63 ) supported by french state funds managed by the anr within the investissements davenir programme under reference anr-11-idex-0004 - 02 .",
    "gps wishes to thank princeton university for hospitality while this work was being carried out .",
    "gs wishes to thank cern for hospitality while this work was being finalised .",
    "let us first fully specify what we have done in our study and then comment on ( possible ) differences relative to klsw .",
    "our hard event sample consists of dijet events from @xmath132 collisions at @xmath133 , simulated with pythia  8.176  @xcite , tune 4c , with a minimum @xmath27 in the @xmath134 scattering of @xmath135 and with the underlying event turned off , except for the plots presented in figs .",
    "[ fig : f00 ] and [ fig : shifts - dispersions - r1 ] , where we use @xmath63 events with @xmath88 .",
    "jets are reconstructed with the anti-@xmath39 algorithm  @xcite after making all particles massless ( preserving their rapidity ) and keeping only particles with @xmath136 .",
    "we have @xmath38 , except for the some of the results presented in section  [ sec : appraisal ] and appendix  [ sec : correlation - coefs ] , where we use @xmath68 as in ref .",
    "@xcite .",
    "given a hard event , we select all the jets with @xmath137 and absolute rapidity @xmath102 .",
    "we then add pileup and cluster the resulting full event , i.e.  including both the hard event and the pileup particles , without imposing any @xmath27 or rapidity cut on the resulting jets . for each jet selected in the hard event",
    "as described above , we find the jet in the full event that overlaps the most with it . here",
    ", the overlap is defined as the scalar @xmath27 sum of all the common jet constituents , as described in footnote  [ footnote : matching ] on p.  .",
    "given a pair of jets , one in the hard event and the matching one in the full event , we can apply subtraction / grooming / cleansing to the latter and study the quality of the jet @xmath27 or jet mass reconstruction . for studies involving the dijet mass ( cf .",
    "[ fig : f00 ] ) we require that at least two jets pass the jet selection in the hard event and use those two hardest jets , and the corresponding matched ones in the full event , to reconstruct the dijet mass .",
    "events used for fig .",
    "[ fig : f00 ] , this does not exactly reflect how we would have chosen to perform a dijet ( resonance ) study ourselves .",
    "one crucial aspect is that searches for dijet resonances always impose a rapidity cut between the two leading jets , such as @xmath138  @xcite .",
    "this ensures that high dijet - mass events are not dominated by low @xmath27 forward - backward jet pairs , which are usually enhanced in qcd v.  resonance production .",
    "those forward - backward pairs can affect conclusions about pileup , because for a given dijet mass the jet @xmath27 s in a forward - backward pair are lower than in a central - central pair , and so relatively more sensitive to pileup .",
    "also the experiments do not use @xmath68 for their dijet studies : atlas uses @xmath139  @xcite , while cms uses @xmath140 with a form of radiation recovery based on the inclusion of any additional jets with @xmath141 and within @xmath142 of either of the two leading jets ( `` wide jets '' )  @xcite .",
    "this too can affect conclusions about pileup .",
    "] this approach avoids having to additionally consider the impact of pileup on the efficiency for jet selection , which can not straightforwardly be folded into our quality measures .",
    "most of the studies shown in this paper use idealised particle - level chs events . in these events , we scale all charged pileup hadrons by a factor @xmath143 before clustering , to ensure that they do not induce any backreaction  @xcite .",
    "the jet selection and matching procedures are independent of the use of chs or full events .",
    "when we plot results as a function of the quantity @xmath144 , this corresponds to the actual ( fixed ) number of zero - bias events superimposed onto the hard collision . for results shown as a function of @xmath19 , the average number of zero - bias events , the actual number of zero - bias events has a poisson distribution .",
    "clustering and area determination are performed with a development version of fastjet 3.1 ( which for the features used here behaves identically to the 3.0.x series ) and with fastjet 3.1.0 and 3.1.1 for the results in section  [ sec : appraisal ] .",
    "details of how the area - median subtraction is performed could conceivably matter .",
    "jet areas are obtained using active area with explicit ghosts placed up to @xmath145 and with a default ghost area of 0.01 .",
    "we use fastjet s ` gridmedianbackgroundestimator ` with a grid spacing of 0.55 to estimate the event background density @xmath0 .",
    "the @xmath0 estimation is performed using the particles ( up to @xmath146 ) from the full or the chs event as appropriate .",
    "when subtracting pileup from jets , we account for the rapidity dependence of @xmath0 , based on the rapidity dependence in a pure pileup sample ( as discussed in refs .",
    "we carry out 4-vector subtraction @xmath147 .",
    "a few obviously unphysical situations need special care . for jets obtained from the full event ,",
    "if @xmath148 , we set @xmath149 to a vector with zero transverse momentum , zero mass , and the rapidity and azimuth of the original unsubtracted jet ; and if @xmath150 is negative , an unphysical situation since it would lead to an imaginary mass , we replace @xmath149 with a vector with the same transverse components , zero mass , and the rapidity of the original unsubtracted jet .",
    "this is essentially equivalent to replacing negative squared masses with zero .",
    "the case of chs events is a bit more delicate .",
    "let @xmath151 denote the 4-momentum of the charged component of the jet . then ,",
    "if @xmath152 , we set @xmath153 , and when @xmath154 , we replace @xmath149 with a vector with the same transverse components , and the mass and rapidity of @xmath155 . for jets with no charged component , whenever the resulting 4-vector has an ill - defined rapidity or azimuthal angle , we use those of the original jet .",
    "corresponding tests that the subtracted transverse momentum and mass are non - negative are also applied in our npc subtraction .",
    "these safety requirements have little impact on the single - jet @xmath27 , limited impact on the dijet mass , and for the single - jet mass improve the dispersion of the subtraction relative to the choice ( widespread in computer codes ) of taking @xmath156 when @xmath157 .",
    "one difference between our study and klsw s is that we carry out a particle - level study , whereas they project their event onto a toy detector with a @xmath158 tower granularity , removing charged particles with @xmath159 and placing a @xmath53 threshold on towers . in our original ( v1 ) studies with @xmath97 we tried including a simple detector simulation along these lines and did not find any significant modification to the pattern of our results , though chs+area subtraction is marginally closer to the cleansing curves in this case .",
    "cleansing has two options : one can give it jets clustered from the full event , and then it uses an analogue of eq .",
    "( [ eq : npc - full ] ) : this effectively subtracts the exact charged part and the npc estimate of the neutrals . or one can give it jets clustered from chs events , and it then applies the analogue of eq .",
    "( [ eq : npc - chs ] ) , which assumes that there is no charged pileup left in the jet and uses just the knowledge of the actual charged pileup to estimate ( and subtract ) the neutral pileup .",
    "these two approaches differ by contributions related to back - reaction .",
    "our understanding is that klsw took the former approach , while we used the latter .",
    "specifically , our charged - pileup hadrons , which are scaled down in the chs event , are scaled back up to their original @xmath27 before passing them to the cleansing code , in its ` input_nc_separate ` mode .",
    "if we use cleansing with full events , we find that its performance worsens , as is to be expected given the additional backreaction induced when clustering the full event . were it not for backreaction , cleansing applied to full or chs events should essentially be identical .",
    "regarding the npc and cleansing parameters , our value of @xmath160 differs slightly from that of klsw s @xmath161 , and corresponds to the actual fraction of charged pileup in our simulated events . in our tests with a detector simulation like that of klsw",
    ", we adjusted @xmath3 to its appropriate ( slightly lower ) value .    finally , for trimming we use @xmath162 and the reference @xmath27 is taken unsubtracted , while the subjets are subtracted before performing the trimming cut , which removes subjets with @xmath27 below a fraction @xmath56 times the reference @xmath27 . compared to using the subtracted @xmath27 as the reference for trimming , this effectively places a somewhat harder cut as pileup is increased",
    ". will be the subtracted one . ] for comparisons with cleansing we generally use @xmath163 unless explicitly indicated otherwise .",
    "in this appendix , we discuss some characteristics of correlation coefficients that affect their appropriateness as generic quality measures for pileup studies .",
    "suppose we have an observable @xmath164 .",
    "define @xmath165 to be the difference , in a given event , between the pileup subtracted observable and the original `` hard '' value without pileup .",
    "two widely used quality measures for the performance of pileup subtraction are the average offset of @xmath164 , @xmath166 and the standard deviation of @xmath167 , which we write as @xmath168 .",
    "one might think there is a drawback in keeping track of two measures , in part because it is not clear which of the two is more important .",
    "it is our view that the two measures provide complementary information : if one aims to reduce systematic errors in a precision measurement then a near - zero average offset may be the most important requirement , so as not to be plagued by issues related to the systematic error on the offset . in a search for a resonance peak ,",
    "then one aims for the narrowest peak , and so the smallest possible standard deviation . distribution .",
    "for some methods the long tails can affect the relevance of the standard - deviation quality measure . ]",
    "the quality measure advocated in @xcite is instead the correlation coefficient between @xmath169 and @xmath170 .",
    "this has the apparent simplifying advantage of providing just a single quality measure .",
    "however , it comes at the expense of masking potentially important information : for example , a method with a large offset and one with no offset will give identical correlation coefficients , because the correlation coefficient is simply insensitive to ( constant ) offsets .",
    "pileup events and area  median subtraction ( in chs events ) versus the dijet mass in the original hard event . the hard dijet sample and the analysis",
    "are as described in appendix  [ sec : details ] , with a jet radius of @xmath68 .",
    "the right - hand plot is identical except for the following additional condition on the hard event : @xmath171 .",
    "note the lower correlation coefficient , even though the lower @xmath172 suggests better typical subtraction in this specific mass bin . ,",
    "title=\"fig:\",scaledwidth=48.0% ]   pileup events and area  median subtraction ( in chs events ) versus the dijet mass in the original hard event . the hard dijet sample and the analysis",
    "are as described in appendix  [ sec : details ] , with a jet radius of @xmath68 .",
    "the right - hand plot is identical except for the following additional condition on the hard event : @xmath171 .",
    "note the lower correlation coefficient , even though the lower @xmath172 suggests better typical subtraction in this specific mass bin .",
    ", title=\"fig:\",scaledwidth=48.0% ]    the correlation coefficient has a second , more fundamental flaw , as illustrated in fig .",
    "[ fig : correls - are - bad ] . on the left ,",
    "one has a scatter plot of the dijet mass in pu - subtracted events versus the dijet mass in the corresponding hard events , as obtained in an inclusive jet sample .",
    "there is a broad spread of dijet masses , much wider than the standard deviation of @xmath89 , and so the correlation coefficient comes out very high , @xmath173 .",
    "now suppose we are interested in reconstructing resonances with a mass near @xmath174 , and so consider only hard events in which @xmath175 ( right - hand plot ) .",
    "now the correlation coefficient is @xmath176 , i.e.  much worse .",
    "this does not reflect a much worse subtraction : actually , @xmath172 is better ( lower ) in the sample with a limited @xmath177 window , @xmath178 , than in the full sample , @xmath179 .",
    "the reason for the puzzling decrease in the correlation coefficient is that the dispersion of @xmath177 is much smaller than before , and so the dispersion of @xmath89 is now comparable to that of @xmath177 : it is this , and not an actual degradation of performance , that leads to a small correlation .",
    "this can be understood quantitatively in a simple model with two variables : let @xmath170 have a standard deviation of @xmath180 , and for a given @xmath170 let @xmath169 be distributed with a mean value equal to @xmath170 ( plus an optional constant offset ) and a standard deviation of @xmath168 ( independent of @xmath170 )",
    ". then the correlation coefficient of @xmath170 and @xmath169 is @xmath181 i.e.  it tends to zero for @xmath182 and to @xmath37 for large @xmath183 , in accord with the qualitative behaviour seen in fig .",
    "[ fig : correls - are - bad ] .",
    "the discussion becomes more involved if @xmath184 has a more complicated dependence on @xmath170 or if @xmath168 itself depends on @xmath170 , for example as is actually the case for the dijet mass with the analysis of appendix  [ sec : details ] .",
    "the main conclusion from this appendix is that correlation coefficients mix together information about the quality of pileup mitigation and information about the hard event sample being studied .",
    "it is then highly non - trivial to extract just the information about the pileup subtraction .",
    "this can lead to considerable confusion , for example , when evaluating the robustness of a method against the choice of hard sample .",
    "overall therefore , it is our recommendation that one consider direct measures of the dispersion introduced by the pileup and subtraction and not correlation coefficients . in cases with severely non - gaussian tails in the @xmath167 distributions it can additionally be useful to consider quality measures more directly related to the peak structure of the @xmath167 distribution .      the atlas collaboration , `` pile - up subtraction and suppression for jets in atlas , '' http://inspirehep.net/record/1260963/files/atlas-conf-2013-083.pdf[atlas-conf-2013-083 ] .",
    "cms collaboration , `` jet energy scale performance in 2011 , '' http://inspirehep.net/record/1230033/files/dp2012_006.pdf[cms-dp-2012-006 ] .",
    "m.  cacciari and g.  p.  salam , phys .",
    "b * 659 * ( 2008 ) 119 [ arxiv:0707.1378 [ hep - ph ] ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , jhep * 0804 * ( 2008 ) 005 [ arxiv:0802.1188 [ hep - ph ] ] .",
    "cms collaboration , `` particle - flow event reconstruction in cms and performance for jets , taus , and met , '' cms - pas - pft-09 - 001 .",
    "g.  aad _ et al . _ [ atlas collaboration ] , phys .",
    "b * 716 * ( 2012 ) 1 [ arxiv:1207.7214 [ hep - ex ] ] .",
    "j.  colas _ et al . _",
    "[ atlas liquid argon calorimeter collaboration ] , nucl .",
    "instrum .",
    "a * 550 * ( 2005 ) 96 [ physics/0505127 ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , unpublished , presented at cms week , cern , geneva , switzerland , march 2011 , available publicly since then at http://www.lpthe.jussieu.fr/~salam/talks/repo/2011-cms-week.pdf .",
    "d.  krohn , m.  d.  schwartz , m.  low and l.  t.  wang , phys .",
    "d * 90 * ( 2014 ) 6 , 065020 [ arxiv:1309.4777 [ hep - ph ] ] .",
    "cms collaboration , `` pileup jet identification , '' http://cds.cern.ch/record/1581583?ln=en[cms-pas-jme-13-005 ] .",
    "atlas collaboration , `` tagging and suppression of pileup jets , '' https://cds.cern.ch/record/1643929?ln=en[atl-phys-pub-2014-001 ] .",
    "m.  cacciari , j.  rojo , g.  p.  salam and g.  soyez , jhep * 0812 * ( 2008 ) 032 [ arxiv:0810.1304 [ hep - ph ] ] .",
    "a.  altheimer , a.  arce , l.  asquith , j.  backus mayes , e.  bergeaas kuutmann , j.  berger , d.  bjergaard and l.  bryngemark _ et al .",
    "_ , arxiv:1311.2708 [ hep - ex ] . j.  m.  butterworth , a.  r.  davison , m.  rubin and g.  p.  salam , phys .",
    "* 100 * ( 2008 ) 242001 [ arxiv:0802.2470 [ hep - ph ] ] .",
    "d.  krohn , j.  thaler and l.  -t .",
    "wang , jhep * 1002 * ( 2010 ) 084 [ arxiv:0912.1342 [ hep - ph ] ] .",
    "m.  cacciari , j.  rojo , g.  p.  salam and g.  soyez , eur .",
    "j.  c * 71 * ( 2011 ) 1539 [ arxiv:1010.1759 [ hep - ph ] ] .",
    "g.  soyez , g.  p.  salam , j.  kim , s.  dutta and m.  cacciari , phys .",
    "lett .   * 110 * ( 2013 ) 16 , 162001 [ arxiv:1211.2811 [ hep - ph ] ] .",
    "m.  cacciari , p.  quiroga - arias , g.  p.  salam and g.  soyez , eur .",
    "j.  c * 73 * ( 2013 ) 2319 [ arxiv:1209.6086 [ hep - ph ] ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , jhep * 0804 * ( 2008 ) 063 [ arxiv:0802.1189 [ hep - ph ] ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , eur .",
    "j.  c * 72 * ( 2012 ) 1896 [ arxiv:1111.6097 [ hep - ph ] ] .",
    "t.  sjostrand , s.  mrenna and p.  z.  skands , comput .  phys .",
    "commun .",
    "* 178 * ( 2008 ) 852 [ arxiv:0710.3820 [ hep - ph ] ] .",
    "m.  h.  seymour , z.  phys .",
    "c * 62 * ( 1994 ) 127 .",
    "et al _ , `` study of @xmath185+jet channel in heavy ion collisions with cms , '' cms - note-1998 - 063 ; + v.  gavrilov , a.  oulianov , o.  kodolova and i.  vardanian , `` jet reconstruction with pileup subtraction , '' cms - rn-2003 - 004 ; + o.  kodolova , i.  vardanian , a.  nikitenko and a.  oulianov , eur .",
    "j.  c * 50 * ( 2007 ) 117 .",
    "m.  cacciari , g.  p.  salam and g.  soyez , eur .",
    "j.  c * 75 * ( 2015 ) 2 , 59 [ arxiv:1407.0408 [ hep - ph ] ] .",
    "d.  bertolini , p.  harris , m.  low and n.  tran , jhep * 1410 * ( 2014 ) 59 [ arxiv:1407.6013 [ hep - ph ] ] .",
    "m.  dasgupta , a.  fregoso , s.  marzani and g.  p.  salam , jhep * 1309 * ( 2013 ) 029 [ arxiv:1307.0007 [ hep - ph ] ] . m.  dasgupta , a.  fregoso , s.  marzani and a.  powling , eur .  phys .",
    "j.  c * 73 * ( 2013 ) 11 , 2623 [ arxiv:1307.0013 [ hep - ph ] ] .",
    "p.  berta , m.  spousta , d.  w.  miller and r.  leitner , jhep * 1406 * ( 2014 ) 092 [ arxiv:1403.3108 [ hep - ex ] ] .",
    "atlas collaboration , `` search for new phenomena in the dijet mass distribution updated using 13@xmath186 of pp collisions at @xmath187 collected by the atlas detector , '' atlas - conf-2012 - 148 .",
    "j.  alcaraz maestre _",
    "et al . _ [ sm and nlo multileg and sm mc working groups collaboration ] , arxiv:1203.6803 [ hep - ph ] .",
    "m.  cacciari , g.  p.  salam and g.  soyez , public code for validation of a subset of the results in this paper , https://github.com/npctests/1404.7353-validation ."
  ],
  "abstract_text": [
    "<S> the use of charged pileup tracks in a jet to predict the neutral pileup component in that same jet could potentially lead to improved pileup removal techniques , provided there is a strong local correlation between charged and neutral pileup . in monte carlo simulation </S>",
    "<S> we find that the correlation is however moderate , a feature that we attribute to characteristics of the underlying non - perturbative dynamics . consequently , </S>",
    "<S> ` neutral - proportional - to - charge ' ( npc ) pileup mitigation approaches do not outperform existing , area - based , pileup removal methods . </S>",
    "<S> this finding contrasts with the arguments made in favour of a new method , `` jet cleansing '' , in part based on the npc approach . </S>",
    "<S> we identify the critical differences between the performances of linear cleansing and trimmed npc as being due to the former s rejection of subjets that have no charged tracks from the leading vertex , a procedure that we name `` zeroing '' . zeroing , an extreme version of the `` charged - track trimming '' proposed by atlas , can be combined with a range of pileup - mitigation methods , and appears to have both benefits and drawbacks . </S>",
    "<S> we show how the latter can be straightforwardly alleviated . </S>",
    "<S> we also discuss the limited potential for improvement that can be obtained by linear combinations of the npc and area - subtraction methods .    </S>",
    "<S> cern - ph - th/2014 - 052 + april 2014 + revised february 2015 </S>"
  ]
}