{
  "article_text": [
    "it is customary that physical information about astrophysical objects can not be obtained directly from the observables .",
    "in such a case , astrophysicists propose a plausible scenario described by a physical model and the procedure is to compare the observables with the predictions of the model with the aim of inferring the physical parameters of the model .",
    "the presence of degeneracies ( either induced by the presence of noise or intrinsic to the model ) introduce complexity in the analysis and they need to be taken into account . this is the subject of bayesian data analysis that , although it is rooted on ideas developed in the 19th century , it has become practical only in the last decades .",
    "the fundamental idea behind bayesian data analysis is to take into account that all parameters of a model can be understood as random variables with associated probability distribution functions .",
    "the standard problem of model fitting is usually seen as finding the set of model parameters that better reproduce the observables .",
    "however , the bayesian approach is far more informative and transforms the problem into finding the probability distribution function associated with the parameters of the model once the data set is taken into account . in the presence of noise and/or degeneracies , these probability distribution functions represent the complete solution to the problem and automatically include all the statistical information about the parameters that can be inferred from the observables .",
    "we have witnessed an enormous interest in bayesian inference in astrophysics in the last decade .",
    "the reason for this resides in two facts .",
    "first , the quality and amount of observed data is usually deficient and one has to rely on methods that exploit to the limit the reduced amount of information .",
    "second , the applied physical models are sometimes too complex as compared with the data available to constrain them . to mention a few recent works , we find applications in cosmological analyses ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , gravitational wave analyses ( e.g. , * ? ? ?",
    "* ) , gravitational lensing ( e.g. , * ? ? ?",
    "* ) , oscillation of solar - like stars ( e.g. , * ? ? ?",
    "* ) , analysis of spectropolarimetric data @xcite , analysis of extreme ultraviolet spectral line fluxes @xcite , and more .",
    "as we review in appendix [ sec : bayesian_inference ] , bayesian inference techniques can be essentially reduced to the calculation of multi - dimensional integrals ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "in very simple models , these integrals can be carried out analytically .",
    "however , more realistic problems can not be analytically treated .",
    "the explosion of bayesian analysis methods in the last decades has to be associated with the set of efficient sampling techniques today known as markov chain monte carlo methods ( mcmc ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in spite of their success",
    ", these methods also present the drawback of being computationally intensive because the proposed model has to be evaluated many times . as a consequence ,",
    "the execution time of these techniques is quite high if the evaluation time of the model is non - negligible .",
    "for this reason , there have been some efforts in recent years towards reducing the evaluation time of the models at the expense of a small lost in accuracy .",
    "they are based on the development of approximate methods that are able to `` learn '' a database of models for many combinations of the model parameters .",
    "for instance , @xcite developed a method based on polynomial interpolation for the rapid cosmological parameter estimation problems .",
    "later , @xcite used a neural network approach for the calculation of cosmic microwave background power spectra ( only for models in a small hypercube around the commonly accepted region of most probable values for the cosmological parameters ) leading to a very fast bayesian cosmological parameter estimation code .",
    "our main aim in this paper is to present bayesclumpy , a computer program that allows us to efficiently carry out bayesian analysis of observed spectral energy distributions coming from the inner region of active galactic nuclei ( agn ) . to this aim , we use the recently developed clumpy dusty torus model of @xcite , known as clumpy models , and develop a mcmc code whose output is the probability distribution function for all the parameters of the clumpy models once the observations are taken into account . as a consequence ,",
    "the code yields statistically significant estimations of the parameters and , more important , statistically relevant confidence intervals .",
    "this facilitates the investigation of degeneracies and can be also used to suggest future observations that can help us introduce stronger constraints in the inference .",
    "the code is based on a recently released on - line database of clumpy models .",
    "we apply an interpolation method like that presented by @xcite that greatly accelerates the evaluation of models . in our case",
    ", we manage to make the approximation method work correctly for the whole database and not only for a small hypercube , thus allowing us to efficiently explore the full space of parameters .",
    "finally , the bayesian character of the approach allows the user to include any a - priori knowledge about any parameter .",
    "according to the unified model for seyfert galaxies @xcite , type-2 agn are the edge - on counterparts of the face - on type-1 agn . this way , in type-1 agn the broad - line region ( blr ) , that is surrounded by a dusty torus of a few parsecs @xcite , is observed directly , together with the narrow - line region ( nlr ) emission , whereas in the case of type-2 agn , only the nlr emission is seen directly .",
    "however , the unification model is not universally applicable , since there are several galaxies that do not reveal the broad lines in polarized light .",
    "regardless , it is clear that there is dust surrounding the central region of agn distributed in a toroidal shape .",
    "the dust grains in the torus absorb the ultraviolet photons from the central engine and , after reprocessing the radiation , are re - emitted in the infrared range .",
    "since many of the predictions of the first compact - torus models @xcite have not been confirmed by the observations , the search for a more distributed or complex geometry of the absorbing material around the agn have been promoted @xcite .",
    "the clumpy dusty torus models @xcite propose that the dust is distributed in clumps , instead of homogeneously filling the torus volume .",
    "as an example of the success of these models , they permit to explain , for example , the observed mutations between type-1 and type-2 objects detected in the spectra of a few agn @xcite .",
    "since the reprocessed radiation from the torus is emitted in the infrared , this range is key to put constrains to the clumpy dusty torus models .",
    "high - resolution observations at these wavelengths are mandatory , due to the small size of the torus @xcite . this way , it is possible to separate the nuclear emission from that of the surrounding galaxy .",
    "important observational constraints for the torus models come then from the shape of the infrared spectral energy distributions ( seds ) .",
    "accuracy in the photometry , a filter set spanning a broad wavelength range , and well - sampled seds are required to restrict the model parameters .",
    "the clumpy models that we use in this work ( described in * ? ? ?",
    "* ; * ? ? ?",
    "* ) consist of a clumpy distribution of matter with a radial extent characterized by @xmath2 , that is the ratio of the outer to the inner radii of the toroidal distribution . the inner radius ( @xmath3 ) is defined by the dust sublimation temperature .",
    "each clump is specified by its optical depth ( @xmath4 ) , and all clumps are assumed to have the same optical depth .",
    "the dust extinction profile corresponds to a standard cold / oxygen - rich ism dust @xcite .",
    "these clumps , of a given dust composition , are heated by an agn with a given spectral shape and luminosity .",
    "thus , the inner radius ( @xmath3 ) is determined uniquely by the luminosity and the chosen dust sublimation temperature .",
    "the number of clouds along a radial equatorial path is defined as @xmath5 .",
    "the radial density profile is a power law ( @xmath6 ) , with an angular distribution characterized by a width parameter , @xmath7 .",
    "every clumpy model requires several seconds to be calculated . for the typical lengths of converged markov chains",
    ", this would amount to something between 1 and 6 days per markov chain for only one run of the inference problem .",
    "obviously , this is something that is absolutely unacceptable if one wants to carry out inference for many agn .",
    "the computational efforts carried out by the clumpy group has allowed them to calculate and distribute for public access around 2@xmath810@xmath9 models ( now increasing to more than 10@xmath10 models ) .",
    "they have been calculated for a quite fine grid of model parameters .",
    "this database can be used to overcome the difficulty of evaluating the clumpy models by using it for interpolation .",
    "the reason for interpolation is that the mcmc code will propose models that are not present in the original grid , so that an efficient interpolation method has to be applied .",
    "if the interpolation method is fast enough , it will allows us to carry out systematic studies of the compatibility of model parameters with different observations in a completely bayesian framework .",
    "studies like analyzing the amount of information added by a given filter and which parameters can be confidently recovered from the data are possible under this framework .    in the following sections we describe our approach for interpolation .",
    "it is based on the application of two different machine learning techniques : principal component analysis ( pca ) for dimensionality reduction and artificial neural networks ( ann ) for the interpolation .",
    "such a method has been already applied by @xcite for approximate bayesian inference of cosmological parameter in a small hypercube around the commonly accepted values of the cosmological parameters .",
    "a similar approach has also been employed by @xcite for the fast synthesis of stokes profiles in magnetic atmospheres and the quick solution of zeeman - doppler imaging problems .",
    "each sed in the database is sampled at @xmath11 wavelength points . clearly , some correlations exist between different wavelength points , so that when the flux at a given wavelength is modified , the surrounding wavelength points are also modified in a very similar way ( continuity of the sed ) . as a consequence ,",
    "the dimension of the non - linear manifold in which the seds `` live '' is much smaller than 124 ( see * ? ? ?",
    "this fact can be harnessed to apply dimensionality reduction techniques and efficiently compress the database .",
    "although many complex technique exist , we apply here a very basic linear dimensionality reduction technique based on the principal component analysis ( pca ; see * ? ? ?",
    "* ) also known as karhunen - love transformation .",
    "briefly , the idea is to obtain a self - consistent basis ( principal components ) in which the data can be efficiently developed .",
    "this basis has the property that the largest amount of variance is explained with the least number of basis functions .",
    "it is useful to reduce the dimensionality of data sets because most part of the variability of the signal is carried by the first @xmath12 eigenvectors .",
    "note that , since pca performs a linear analysis , it is not possible to reduce the dimensionality of the transformed manifold to the real dimensionality of the non - linear manifold and the number of necessary eigenvectors is larger than the number of physical parameters of the model @xcite . see appendix [ sec : appendix_pca ] for more technical details on pca .",
    "the first 16 pca eigenvectors obtained from the clumpy database are shown in fig .",
    "[ fig : pca_evecs ] .",
    "this figure shows that low - order eigenvectors are very smooth and take into account large - scale variations that are seen in the majority of the seds . on the contrary ,",
    "high - order eigenvectors contain high - frequency details that produce small - scale details in a small amount of seds .",
    "choosing only the first @xmath13 eigenvectors results in a very good representation of the whole database .",
    "in other words , this allows us to reduce the size of the database because we only need to give 13 numbers for each sed ( the projection of each sed along each pca eigenvector ) and their associated eigenvectors .",
    "note that , for very large number of models @xmath14 , the reduction in size of the database tends to @xmath15 , which is close to 1/10 in our case .",
    "although the pca eigenvectors can be usually associated to different physical mechanisms ( e.g. , * ? ? ?",
    "* ) , our aim here is not to analyze them .",
    "we treat the pca eigenvectors as a basis set of purely mathematical character that allows us to efficiently develop the database .",
    "efficiency in our case means that the number of eigenvectors needed to reproduce the database with a given error bar is the smallest possible . in any case , it is possible to see some well - known signatures like the 10  one produced by dust emission / absorption in some eigenvectors of fig .",
    "[ fig : pca_evecs ] .",
    "although the pca dimensionality reduction step has reduced the size of the database , it is still complex and time consuming to obtain the sed for values of the parameters not present in the original grid . for this reason , we have developed an interpolation method based on an artificial feed - forward neural network ( ann ; see e.g. , * ? ? ?",
    "* ) , a widespread machine learning technique that usually presents very good behavior .",
    "we have developed @xmath16 simple neural networks whose topology is shown in fig .",
    "[ fig : neural_network ] .",
    "the ann consists of an input layer formed by 6 neurons that accept the physical parameters of the clumpy models .",
    "the output layer is formed by one neuron whose value is the projection of the sed corresponding to the physical parameters of the input layer along each pca eigenvector calculated before .",
    "both layers are fully connected by an intermediate hidden layer .",
    "the approximation properties of three - layered neural networks is something known after the universal approximation theorem ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "this theorem states that such a neural network , with a sufficiently large number of neurons in the hidden layer , can approximate any continuous function .",
    "we have verified that , in order to get a compromise between the approximation abilities of the neural network and the speed of evaluation , values of @xmath17 between 30 and 50 give very good results .",
    "this method is not optimal because the values of @xmath17 are set empirically .",
    "more refined methods probably based on bayesian model selection ( or the approximate minimum description length method used by * ? ? ?",
    "* ) can be used to infer the optimal number of hidden neurons based on objective measurements .",
    "however , for the purpose of our work , the employed method is enough to ensure good approximation properties while maintaining a fast execution speed .",
    "the ann uses the hyperbolic tangent activation function . prior to utilizing the neural network ,",
    "all the input and output values are normalized to the interval @xmath18 $ ] to improve the interpolation abilities of the network .",
    "the training of the ann is done by modifying the weights until the minimizing the quadratic difference between the output of the neural network and the correct values of the database ( see appendix [ sec : appendix_ann ] for more details ) .",
    "it is important to note that over - fitting has been avoided using two data - sets chosen randomly from the database : one for training and one for validation purposes .",
    "the training process is stopped when the quadratic error decreases for the training set but starts to increase for the validation set .",
    "we have verified that it is possible to carry out the training of the neural networks using only a subset of the full database , which greatly accelerates the process .",
    "this is a consequence of the smooth variation of the seds with the physical parameters . picking randomly from the database a training set with @xmath19% of the total number of models , the trained neural network does a very good job with the validation set and with the whole database .",
    "in order to analyze the ability of the pca+ann combination to reproduce the database , we show in fig .",
    "[ fig : error ] the standard deviation ( left panel ) and the 99% percentile ( right panel ) of the distribution of differences in @xmath20 between the exact seds of the full database and the reconstructed seds .",
    "the 99% percentile has been also represented in order to test the possibly poor generalization properties of neural networks in regions close to the boundaries of the space of parameters .",
    "the dashed lines present the results when the pca reconstruction is done using the original database .",
    "in such a case , the reconstruction error is monotonically decreasing with the number of included pca eigenvectors .",
    "if all the eigenvectors are used , the reconstruction error turns out to be identically zero . with the first 13 eigenvectors , the reconstruction errors are below 5@xmath810@xmath21 ( @xmath22 ) and",
    "10@xmath23 ( 99 % percentile ) in all the wavelength range of interest .",
    "the solid lines are the reconstruction errors when the projections along the pca eigenvectors are calculated by evaluating the artificial neural networks . obviously , due to the approximate character of the neural networks interpolation , the reconstruction errors are larger than in the exact case .",
    "the approximation abilities of the neural networks worsen when the order of the eigenvector increases .",
    "the reason is that these eigenvectors contain high - frequency or less abundant signatures whose variation with the parameters are less smooth .",
    "however , standard deviations of the reconstruction error are below 2@xmath810@xmath23 in the whole spectral domain of interest , with errors going down to 10@xmath21 in some spectral windows . concerning the 99% percentile , errors are always below 10@xmath24 , with wavelength regions close to 10@xmath21 .",
    "an example of the ability of the ann to approximate the database is shown in fig .",
    "[ fig : sed_reconstruction ] , where the black line is the exact sed obtained from the database ( note that although only part of the database was used in the training , these seds are obtained randomly from the full database ) .",
    "the red line is the sed reconstructed using only the first 13 eigenvectors but using the correct sed for the projections along the eigenvectors .",
    "the blue line is the sed reconstructed using the neural networks .",
    "note that differences are hardly noticeable and are well below any possible observational error or indeterminacy in the physical properties of the agn .    lcc filter & central wavelength ( ) & flux density ( mjy ) + naco j & 1.28 & 1.3@xmath250.1 + naco h & 1.67 & 4.5@xmath250.3 + naco ks & 2.15 & 33.7@xmath252.0 +",
    "naco l & 3.80 & 200@xmath2540 + t - recs si2 & 8.74 & 710@xmath2540 + t - recs qa & 18.3 & 2630@xmath25650 +      there are two main advantages of the approach followed in this paper .",
    "on the one hand , it opens the possibility to interpolate in the database , so that it is now possible to calculate seds for combinations of parameters that were not present in the original grid . in principle , if the seds depend smoothly on the parameters , the neural networks should have captured all the variability and there is no necessity to improve the griding of the original database . on the other hand ,",
    "the synthesis of the sed is extremely simple and fast because all the details of the calculations inherent to the clumpy model are approximated by the neural networks .",
    "one has to calculate the 13 projections of the sed onto the pca eigenvectors by evaluating the 13 neural networks given by eq .",
    "( [ eq : neural_network ] ) .",
    "then , the reconstruction of the sed is obtained by adding the first 13 pca eigenvectors weighted by these 13 projections . in terms of computational time , this makes it possible to synthesize @xmath26 seds in just a minute , so that we obtain a gain in time of a factor 10@xmath27 or larger .",
    "the ann+pca approach can be essentially considered as a huge compression of the database . instead of saving the whole database ,",
    "one only needs to save the weights of the neural networks and the pca eigenvectors . in our case ,",
    "the complete database amounts to @xmath28430 mb , while the ann+pca approach amounts to @xmath2840 kb , with a reduction factor that is close to 10@xmath29 , with the added benefit of being able to easily interpolate .",
    "of course , this improvement in the calculation speed is compensated by small differences as compared with the correct seds .      for the cases in which the observations are of filter photometry kind ,",
    "once the sed is obtained with the previous formalism , it remains to simulate the effect of the filters on the simulated sed .",
    "given that @xmath30 is a filter normalized to unit area used to obtain a point in the observations , the synthetic value is obtained by just evaluating : @xmath31 where @xmath32 is the central wavelength of the filter , obtained as : @xmath33 both integrals are approximated in bayesclumpy  with a very simple trapezoidal quadrature : @xmath34 with @xmath35 the weights of the trapezoidal quadrature .",
    "we have implemented this forward modeling code into a markov chain monte carlo sampling algorithm that is used to evaluate the posterior distribution function for the physical parameters once an observation is provided ( see appendix [ sec : bayesian_inference ] for details ) .",
    "the filters at which the information is available are fully configurable from a database of filters belonging to different instruments .",
    "one only needs to select the filter and give the the observed flux , @xmath36 , and its corresponding error . for the moment ,",
    "gaussian errors with standard deviation @xmath37 and upper limits within a certain ( user - selectable ) confidence level are possible .",
    "the simplest version of the code uses uniform priors for all the parameters and admit to give the upper and lower limits for every parameter .",
    "it is also possible to choose a gaussian prior in case any parameter is known a - priori to be around a given value with a certain dispersion .",
    "the central position and the width of the gaussian are the only adjustable hyper - parameters in this case .",
    "more complex prior distributions are straightforward to include in the code and can be fully configurable .",
    "apart from the 6-dimensional vector of parameters of the clumpy model given by @xmath38 , we add other parameters like a vertical shift in logarithmic scale that accounts for the normalization in luminosity of the sed or the amount of interstellar extinction characterized by an extinction law and the absorption at visible wavelengths .",
    "we neglect the presence of extinction in this work , but the effect of the normalization in luminosity is treated as a _ nuisance _ parameter and all the results are presented with this parameter integrated out ( marginalized ) .",
    "since the marginal posterior distributions of the vertical shift are already an output of bayesclumpy , one can carry out inference over the total luminosity of the agn .",
    "high resolution infrared data have been compiled from the literature for the seyfert 2 galaxy centaurus a ( ngc  5128 ) in order to construct a purely - nuclear sed .",
    "centaurus a is the closest active galaxy , with its core heavily obscured by a dust lane , and consequently only visible at wavelengths longwards of 0.8  @xcite .",
    "near - infrared data obtained with naos - conica ( naco ) at ut4 have been compiled from @xcite .",
    "conica is a high spatial resolution near - infrared imager and spectrograph @xcite , that works together with naos , the nasmyth adaptive optics system @xcite , providing adaptive - optics corrected observations in the range 1 - 5 .",
    "@xcite found the nucleus unresolved at all wavelengths with a fwhm of 0.10  in the j band , 0.088  in the h band , 0.059 in the ks band , and 0.090 in the l band .",
    "the fluxes corresponding to this unresolved component have been compiled and reported in table [ tab : fluxes ] .",
    "high spatial resolution mid - infrared data of the nucleus of centaurus a are also compiled from @xcite .",
    "the observations were taken in the si2 filter ( 8.8 ) and in the qa band ( 18.3 ) using the mid - infrared imager / spectrometer t - recs on gemini south @xcite .",
    "the core is also unresolved in this range , surrounded by a diffuse extended emission . in these bands ,",
    "the upper limits to the size of the unresolved nucleus are 0.19  at 8.8  and 0.21  at 18.3  at the fwhm level .    with these high spatial resolution density measurements of the unresolved component of centaurus",
    "a , we can construct a purely - nuclear sed of this galaxy , to be fitted with the clumpy models , as an example of the use of our tool .",
    "the parameter estimation results presented in this section have been carried out with a markov chain of length @xmath39 , of which we take out the initial 40% as a burn - in ( transitory initial portion of the markov chain in which the algorithm is not correctly sampling the distribution ; see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "our experiments have shown that the transitory phase is quite short and that the burn - in can be safely reduced to just the first @xmath19% of the chain without much problem , thus increasing the quality of the sampling .",
    "although a 40% burn - in is surely excessive , the fact that the mcmc scheme works very fast ( less than half a minute for a @xmath39 chain ) , we prefer to run a longer chain and maintain the large burn - in .",
    "this way we make sure that the mcmc algorithm is well mixed and we are sampling correctly the posterior distribution .",
    "the one - dimensional marginalized posterior distributions are shown in fig .",
    "[ fig : marginal1d_cena ] for all the free model parameters .",
    "these distributions are obtained as histograms of the markov chain for each parameter due to the automatic marginalization properties of the mcmc technique .",
    "this information encodes , for every parameter , the effect of ambiguities and degeneracies ( the marginalization of the posterior takes into account all the possible values of the rest of parameters weighted by their probabilities ) and summarizes the statistical properties of the estimation for each parameter .",
    "uniform priors have been employed , leaving for a later publication the analysis of agn in which a - priori knowledge might be present ( ramos almeida et al . , 2009 , in preparation ) .",
    "therefore , these posterior distributions have to be compared with uniform distributions giving equal probability to all combinations of parameters . when the observed data introduces enough information into the problem , the posterior distributions clearly differ from the uniform distribution .",
    "the uniform distributions are truncated to the following intervals : @xmath40 $ ] , @xmath41 $ ] , @xmath42 $ ] , @xmath43 $ ] , @xmath44 $ ] and @xmath45 $ ] .",
    "these values are based on physically reasonable assumptions that avoid non - realistic solutions .",
    "figure [ fig : marginal1d_cena ] clearly indicates that all the parameters are nicely constrained for centaurus a. the marginal distribution of @xmath46 , with its asymmetric shape , is showing us that the observations are able to put an upper limit to its value .",
    "the calculation of the confidence intervals in this histogram gives us that the upper limit to @xmath46 is 11.2 at 68% ( @xmath22 level ) confidence and 13.0 at 95% confidence ( @xmath47 level ) .",
    "concerning @xmath5 , there is a tail towards large values that produce slightly asymmetric error bars .",
    "if we summarize the histogram using the median , we find that @xmath48 at 68% confidence and @xmath49 at 95% confidence .",
    "it is also possible to use different quantities to summarize the statistical information , like the posterior mean or the posterior mode ( maximum - a - posteriori or map ) , although the relevant information is provided by the full marginal posterior distribution .",
    "the marginal posterior for @xmath50 also indicates that it is a nicely constrained parameter , again with asymmetric error bars due to the enhanced tail .",
    "we obtain @xmath51 at 68% confidence and @xmath52 at 95% confidence .",
    "a different behavior is found for @xmath7 , @xmath53 and @xmath54 . in the three cases , there is a region of the space of parameters that is favored with respect to others .",
    "for instance , the bayesian analysis gives a larger probability to inclinations close to 90@xmath55 ( the map value is @xmath56 ) , practically discarding angles close to 0@xmath55 .",
    "the same happens for @xmath53 , in which data favor values close to zero .",
    "summarizing , we get @xmath57 , @xmath58 and @xmath59 with 68% confidence .",
    "correlations between the parameters can be understood at the light of the two - dimensional marginal distributions of fig .",
    "[ fig : marginal2d_cena ] , where the contours mark the 68% and 95% confidence regions . instead of plotting all possible combinations of parameters ,",
    "we only show six cases that are representative of the general behavior .",
    "it can be seen that the observed data discard large values of @xmath5 , @xmath50 , @xmath46 and @xmath53 .",
    "the plot @xmath60 presents weakly constrained parameters , although it is clear from this figure that large values of @xmath54 are favored ( in accordance with the type-2 classification of cen a ) .",
    "small values of @xmath54 are not preferred and become slightly more likely as @xmath7 increases ( i.e. , as the probability that the central engine is blocked from view ) .",
    "in other words , the results show that type-1 orientations ( small @xmath54 simultaneous with small @xmath7 ) are not favored by the data .",
    "we present the physical interpretation of these results in ramos almeida et al .",
    "( 2009 , in preparation ) .",
    "it turns out interesting that there is not much ambiguity in the parameters so that the available data is able to constrain the large variability of the clumpy torus models .",
    "one should expect to obtain even more constrained marginal posterior distributions when increasing the number of filters .    although the solution to the bayesian inference problem are the posterior distributions shown in fig . [",
    "fig : marginal1d_cena ] , one can try to represent the models corresponding to the median or the maximum - a - posteriori values of the parameters ( within the confidence intervals ) to visually compare them with the observations .",
    "the maximum - a - posteriori model is displayed in solid line in fig .",
    "[ fig : sed ] .",
    "this is obtained using the combinations of parameters that maximize the posterior distribution .",
    "the dashed line shows the model obtained using the medians of the marginal posterior distribution for each parameter .",
    "finally , the dashed line tries to give an idea of the range of variability of the compatible models .",
    "it is built by synthesizing seds for all combinations of parameters taking into account their confidence intervals around the median value .",
    "this paper presents a computer code for the bayesian analysis of nuclear seds of agn using clumpy models .",
    "this approach allows us to obtain the full solution to the inference problem in terms of posterior probability distributions of the model parameters .",
    "these probability distributions take into account the a - priori information about the parameters and the information introduced by the observations .",
    "presently , the prior distribution can be selected to be uniform in an interval , gaussian or dirac delta . according to the observations",
    ", the code admits observations corrupted with gaussian noise and/or upper limit detections .",
    "the machine learning technique based on the combination of the pca decomposition and the application of artificial neural networks for the approximation of the database leads to a gain of a factor @xmath61 in disk storage and @xmath62 in execution time . as a sub - product",
    ", it provides the possibility to interpolate in the database , thus it becomes feasible to generate seds for combinations of parameters not present in the original grid .",
    "this characteristic will be of great importance for the analysis of the response function of the sed in certain spectral ranges of interest to the model parameters ( derivatives of the sed with respect to the model parameters ) .    .",
    "the solid line presents the maximum - a - posteriori estimation of the sed while the dashed line is the one calculated with the median of the marginal posterior distributions of the parameters .",
    "the shaded region is the range of seds compatible within the 68% confidence interval for each parameter . ]",
    "although the space of parameters is very large , the approximation properties of the method are very good , giving differences between the exact and the approximate sed with a standard deviation below 0.1 dex in the spectral window of interest .",
    "these errors are clearly below any uncertainty in the observations , so that the final results will not be dominated by the approximation step .",
    "this good behavior is possible because of two reasons .",
    "first , the variation of the seds is notably smooth when the physical parameters are varied .",
    "this greatly facilitates the interpolation properties of the artificial neural networks .",
    "second , the precision needed in the approximation is not specially significant and one only needs to train the neural networks until the differences between the exact seds and the reconstructed seds are below the observational errors .    in order to demonstrate the output of the code ,",
    "we have shown an example with centaurus a. the analysis of the marginal posterior distributions shows that some parameters are nicely determined by the data , while other parameters remain less constrained . although one can summarize the marginal posteriors using modes , medians and/or means , together with confidence intervals , the true solution to the problem from the bayesian point of view are the histograms shown in fig .",
    "[ fig : marginal1d_cena ] .",
    "although bayesclumpy  is focused towards the analysis of nuclear seds of agn using clumpy models , the core of the method remains completely general and can be applied to a myriad of problems for which one is interested in fitting an already built database of models to observations .",
    "cases like the database of synthetic spectra computed for the gaia project ( e.g. , * ? ? ?",
    "* ) or the analysis of the spectral energy distributions of protostars ( e.g. , * ? ? ?",
    "* ) are examples of potential applications . apart from the gain in speed in the analysis",
    ", one would be able to carry out a fully bayesian analysis of the observations , thus opening the possibility of including prior information and/or carrying out marginalization of nuisance parameters .",
    "furthermore , bayesian model selection techniques would facilitate the objective selection of several competing models for explaining the observables .",
    "bayesclumpy  is coded in fortran 90 with a graphical front - end developed in idl .",
    "we offer bayesclumpy  to the astrophysical community with the hope that it will help researchers to take advantage of the clumpy models for analyzing observed seds . to get a copy",
    ", it suffices with making an e - mail request to the authors of this paper .",
    "we thank nancy levenson , moshe elitzur , and ana prez garca for useful comments .",
    "financial support by the spanish ministry of education and science through projects aya2007 - 63881 and aya2007 - 67965-c03 - 01 , the european commission through the solaire network ( mtrn - ct-2006 - 035484 ) and the spanish mec under the consolider - ingenio 2010 program grant csd2006 - 00070 : first science with the gtc ( http://www.iac.es/consolider-ingenio-gtc/ ) is gratefully acknowledged .",
    "we also acknowledge `` los piratas '' for inspiring the development of this work .",
    "bayesclumpy  is a computer code that is focused towards analyzing observed seds using theoretical models and carrying out inference over the parameters of the theoretical models .",
    "it is built under the framework of the bayesian approach for the inference ( see e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , of which we briefly summarize the main ideas .",
    "let @xmath63 be a model that is proposed to explain an observed data set @xmath64 . in our case",
    ", @xmath64 is usually the set of points observed using filter photometry , but more information can be introduced if the observation is of spectroscopic type .",
    "additionally , @xmath63 is the clumpy model described by @xcite that we have briefly described in  [ sec : clumpy_models ] .",
    "let @xmath65 be a set of sensible background a - priori knowledge about the problem ( for instance , the filters used for the observations ) .",
    "in general , the model @xmath63 is described by a set of equations or algorithms that depend on a vector of parameters , @xmath66 .",
    "these parameters usually have a physical meaning and our aim is to obtain information about these parameters from the observations . inside the bayesian framework for inference , our approach is the one of parameter estimation . in the case at hand ,",
    "the vector of parameters contains the six free parameters of the clumpy model already described in  [ sec : clumpy_models ] .    in general , due to the presence of noise in the observations ,",
    "any inversion procedure is not complete by just giving the values of the model parameters that better fit the observations .",
    "the full inference problem has to provide the posterior probability distribution function ( pdf ) @xmath67 that describe the probability that a given set of parameters @xmath66 is compatible with the observables @xmath64 given the set of background a - priori assumptions @xmath65 . as a consequence",
    ", statistically relevant information can be obtained from this pdf by marginalization ( integration ) of unimportant parameters .",
    "specifically , the marginalization of all the parameters except the one in which we are interested will give the probability distribution function of the parameter taking into account all possible compatible values of the rest of parameters .",
    "therefore , ambiguities and degeneracies in the parameters are translated into marginal posterior distributions with heavy tails .",
    "the cornerstone of the bayesian approach to inference is the bayes theorem , that relates the posterior distribution @xmath67 with any a - priori knowledge and the information introduced by the data : @xmath68 where @xmath69 is the so - called _ evidence _ , @xmath70 is denominated the _",
    "prior _ distribution and @xmath71 is the so - called _",
    "likelihood_.    the evidence , equal to the integral of the posterior distribution over the parameter space , plays no role in the context of parameter estimation because it is a constant that does not depend on the model parameters @xmath66 .",
    "however , it turns out to be crucial in the context of model selection . strictly speaking ,",
    "when one carries out parameter estimation in the bayesian context , one should indicate the estimation of the parameters , the error bars and the value of the evidence . this way",
    ", other researchers can compare their results with already published ones .",
    "the main difficulty is that the evidence is very difficult to calculate and specifically designed algorithms are needed @xcite .",
    "the prior distribution , @xmath70 , contains all relevant _ a - priori _ information about the parameters of the model .",
    "usually , unless some information is available about the value of some parameters , it is common to use uninformative priors like bounded uniform distributions or jeffreys priors ( e.g. , * ? ? ?",
    "* ) . in case",
    "our a - priori knowledge of a parameter is sufficient to better constrain the value of a parameter , the bayesian approach can easily introduce the information into the inference process by appropriately setting the prior distribution @xmath70 . among the options , one can select exponential distributions if large values of the parameters are less probable , gaussian distributions around a given value with a certain width if there is a region of the space of parameters with more probability , etc .    finally , the likelihood @xmath71 is a distribution that gives the probability that the observed data set has been obtained using the set of parameters @xmath66 . assuming that the observables are represented by the vector @xmath72 of length @xmath5 and that the model @xmath63 evaluates to the vector @xmath73 of the same length contaminated by a noise component @xmath74 , we can write : @xmath75",
    "when the chosen model parameters exactly correspond to those of the observed data set , the distribution of differences @xmath76 has to follow the distribution of the noise . assuming that the noise is gaussian distributed with a variance described by the vector @xmath77 , the likelihood function is given by : @xmath78 , \\label{eq : likelihood}\\ ] ] although other distributions can be used .",
    "for instance , in cases where only the upper of lower limit is known with a given confidence , it is possible to use skewed likelihood functions that appropriately take this into account . for simplicity , we assume one - sided gaussian likelihoods centered at zero in which @xmath37 is adjusted so that the ratio of the integral of the likelihood between 0 and @xmath36 and its total area equals the confidence level of the observation .    summarizing , eq .",
    "( [ eq : bayes_theorem ] ) states that the probability that a model @xmath63 becomes plausible after the data @xmath64 has been taken into account ( posterior ) depends on how plausible the model was before presenting the data ( prior ) and how well the model fits the data ( likelihood ) .      in order to calculate the posterior probability distribution function for one parameter and give estimations and confidence intervals",
    ", we have to marginalize ( integrate out ) the rest of parameters from the full posterior distribution : @xmath79 to this end , bayesclumpy  utilizes a markov chain monte carlo ( mcmc ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) scheme based on the metropolis algorithm .",
    "the output of the mcmc method is a chain of models whose probability distribution follows the posterior distribution function .",
    "the mcmc technique can be also considered as an integration method that returns marginal probability distribution for each parameter in the model . as a consequence ,",
    "the converged final markov chain obtained for each parameter automatically gives , after making histograms , its marginal posterior distribution ( integrating out the rest of model parameters ) .",
    "technically , our mcmc method works by proposing models using a multivariate gaussian proposal distribution and accepting or rejecting the proposed models based on a standard metropolis acceptance rule .",
    "the proposal density distribution used in the first steps of the chain is a multivariate gaussian with diagonal covariance matrix that is set to 10% of the allowed range of variation of the parameters . after a configurable initial period ,",
    "the proposal density is changed to a multivariate gaussian with a covariance matrix that is estimated from the previous steps of the chain . in order to improve convergence ,",
    "the covariance matrix is modified by a parameter that assures that the acceptance rate of proposed models is close to 25% , a value that is close to the theoretical optimal value for simple problems @xcite .",
    "although mcmc methods represent a huge step forward in the practical application of bayesian methods to the inference , one of the most important drawbacks is the necessity to sample the whole posterior probability distribution , something that can be very time consuming .",
    "typical mcmc runs require markov chains of the order of 10@xmath29 - 10@xmath9 steps in order to end up with correctly converged chains . in case",
    "the evaluation of the forward model is not negligible , the total time can be quite large and the systematic analysis of different observations remains completely unpractical .",
    "let us define @xmath80 as the @xmath81 matrix containing the wavelength variation of all the theoretical seds of the database where the mean sed has been substracted .",
    "the principal components can be found as the eigenvectors of this matrix of observations , so that they can be obtained by just diagonalizing the matrix @xmath80 .",
    "since we have @xmath82 , this matrix is not square by definition and the dimension of the matrix can be so large that computational problems can arise .",
    "however , it can be demonstrated that the right singular vectors of the matrix @xmath80 are equal to the singular vectors of the covariance matrix : @xmath83 that can be calculating with the singular value decomposition algorithm ( svd ; see , e.g. , * ? ? ?",
    "the matrix @xmath84 is the @xmath85 covariance matrix and the superindex @xmath86 represents the transposition operator .",
    "the same applies to the left singular vectors , which are also eigenvectors of the covariance matrix @xmath87 .",
    "the matrix @xmath88 has dimensions @xmath89 and is typically much larger than the matrix @xmath84 .",
    "however , both descriptions are completely equivalent .",
    "the @xmath54-th principal components , @xmath90 , fulfills : @xmath91 with @xmath92 its associated eigenvalue .",
    "writing all the eigenvectors as column vectors in the unitary matrix @xmath93 of dimensions @xmath85 , since this represents a complete basis of the database , the observations can be written as a linear combination of them as follows : @xmath94 being @xmath95 the @xmath81 matrix of coefficients , whose @xmath96 element represents the projection of the observation @xmath54 on the eigenvector @xmath97 : @xmath98    the dimensionality reduction is carried out by using the matrix @xmath99 that contains only the first @xmath100 eigenvectors that have been retained as containing the majority of signatures , so that , we end up with the matrix of approximate seds : @xmath101",
    "the function that the ann whose topology corresponds to that shown in fig .",
    "[ fig : neural_network ] proposes depends on the six - dimensional vector of parameters @xmath102 and can be represented as : @xmath103 where @xmath104 are highly non - linear functions whose functional form is given explicitly below in eq .",
    "( [ eq : ann_function ] ) .",
    "the subindex @xmath105 labels all clumpy models while the subindex @xmath106 labels all the artificial neural networks built for approximating the projection of the seds on each pca eigenvector .",
    "using eqs .",
    "( [ eq : ann_functional ] ) and ( [ eq : reconstruction_approx ] ) , the likelihood function given by eq .",
    "( [ eq : likelihood ] ) can be written as : @xmath107,\\ ] ] where @xmath108 is the @xmath54-th wavelength points of the @xmath97-th pca eigenvector .",
    "the output of each neural network can be expanded to read : @xmath109 , \\label{eq : neural_network}\\ ] ] where the weights @xmath110 , @xmath111 and the bias @xmath112 represent free parameters that are optimized during the training process .",
    "the symbol @xmath17 stands for the number of neurons in the hidden layer and this essentially determines the number of weights and biases or , in other words , the complexity of the network .",
    "the training of the ann is done by modifying , for fixed @xmath113 , the weights and biases until minimizing the the quadratic difference between the true value of @xmath114 and the values returned by the artificial neural network for all the models included in the training : @xmath115 ^ 2,\\ ] ] where @xmath116 is the number of models included in the training .",
    "it is important to point out that neural networks suffer from the well - known problem of over - fitting if the number of weights is too large .",
    "when a neural network is over - fitting the training set , it looses generality and starts to `` mimick '' the fine details of each sample ( similar to what happens when a set of noisy points is fitted with a very high - degree polynomial ) .",
    "although over - fitting can be overcome with the aid of bayesian techniques @xcite , we prefer to use the less refined method of having a validation set as explained in the main text .                                                    ,",
    "r. , hofmann , r. , bizenberger , p. , & tusche , a. 1998 , in presented at the society of photo - optical instrumentation engineers ( spie ) conference , vol .",
    "3354 , proc .",
    "3354 , p. 606 - 614 , infrared astronomical instrumentation , albert m. fowler ; ed . , ed .",
    "a.  m. fowler , 606                                  , r. , battye , r.  a. , carreira , p. , cleary , k. , davies , r.  d. , davis , r.  j. , dickinson , c. , genova - santos , r. , grainge , k. , gutirrez , c.  m. , hafez , y.  a. , hobson , m.  p. , jones , m.  e. , kneissl , r. , lancaster , k. , lasenby , a. , leahy , j.  p. , maisinger , k. , pooley , g.  g. , rajguru , n. , rubio - martin , j.  a. , saunders , r.  d.  e. , savage , r.  s. , scaife , a. , scott , p.  f. , slosar , a. , sosa molina , p. , taylor , a.  c. , titterington , d. , waldram , e. , watson , r.  a. , & wilkinson , a. 2004 , , 353 , 747      , g. , lacombe , f. , puget , p. , hubin , n.  n. , gendron , e. , conan , j .- m . , kern , p.  y. , madec , p .- y .",
    ", rabaud , d. , mouillet , d. , lagrange , a .- m . , & rigaut , f.  j. 1998 , in presented at the society of photo - optical instrumentation engineers ( spie ) conference , vol .",
    "3353 , proc .",
    "3353 , p. 508 - 516 , adaptive optical system technologies , domenico bonaccini ; robert k. tyson ; eds . , ed .",
    "d.  bonaccini & r.  k. tyson , 508516    , j.  a. , rebolo , r. , carreira , p. , cleary , k. , davies , r.  d. , davis , r.  j. , dickinson , c. , grainge , k. , gutirrez , c.  m. , hobson , m.  p. , jones , m.  e. , kneissl , r. , lasenby , a. , maisinger , k. , dman , c. , pooley , g.  g. , sosa molina , p.  j. , rusholme , b. , saunders , r.  d.  e. , savage , r. , scott , p.  f. , slosar , a. , taylor , a.  c. , titterington , d. , waldram , e. , watson , r.  a. , & wilkinson , a. 2003 , , 341 , 1084            , c.  m. , pina , r.  k. , hanna , k.  t. , julian , j.  a. , hon , d.  b. , & kisko , t.  m. 1998 , in presented at the society of photo - optical instrumentation engineers ( spie ) conference , vol . 3354 , proc .",
    "3354 , p. 534 - 544 , infrared astronomical instrumentation , albert m. fowler ; ed . , ed .",
    "a.  m. fowler , 534544      , k.  r.  w. , meisenheimer , k. , jaffe , w. , schartmann , m. , rix , h .- w .",
    ", leinert , c. , morel , s. , wittkowski , m. , rttgering , h. , perrin , g. , lopez , b. , raban , d. , cotton , w.  d. , graser , u. , paresce , f. , & henning , t. 2007 , a&a , 474 , 837"
  ],
  "abstract_text": [
    "<S> our aim is to present a fast and general bayesian inference framework based on the synergy between machine learning techniques and standard sampling methods and apply it to infer the physical properties of clumpy dusty torus using infrared photometric high spatial resolution observations of active galactic nuclei . </S>",
    "<S> we make use of the metropolis - hastings markov chain monte carlo algorithm for sampling the posterior distribution function . such distribution results from combining all a - priori knowledge about the parameters of the model and the information introduced by the observations . </S>",
    "<S> the main difficulty resides in the fact that the model used to explain the observations is computationally demanding and the sampling is very time consuming . for this reason , </S>",
    "<S> we apply a set of artificial neural networks that are used to approximate and interpolate a database of models . as a consequence , </S>",
    "<S> models not present in the original database can be computed ensuring continuity . </S>",
    "<S> we focus on the application of this solution scheme to the recently developed public database of clumpy dusty torus models . </S>",
    "<S> the machine learning scheme used in this paper allows us to generate any model from the database using only a factor @xmath0 of the original size of the database and a factor @xmath1 in computing time . </S>",
    "<S> the posterior distribution obtained for each model parameter allows us to investigate how the observations constrain the parameters and which ones remain partially or completely undetermined , providing statistically relevant confidence intervals . </S>",
    "<S> as an example , the application to the nuclear region of centaurus a shows that the optical depth of the clouds , the total number of clouds and the radial extent of the cloud distribution zone are well constrained using only 6 filters . </S>",
    "<S> the code is freely available from the authors . </S>"
  ]
}