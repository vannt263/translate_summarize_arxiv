{
  "article_text": [
    "since the first works of j. monod @xcite and novik and szilar @xcite , @xcite ( see also @xcite ) , biologists have developed procedures which allow to maintain a bacterial population at a stationary finite size while , at the same time , the bacteria have a positive individual growth rate .",
    "the procedure is based on a chemostat : bacteria live in a growth container of constant volume in which liquid is injected continuously",
    ". this liquid contains nutrients which are consumed by the bacteria .",
    "we assume that the chemostat is well stirred , so that the distribution of bacteria and nutrients are spatially uniform .",
    "moreover , since the container has a finite volume and fresh liquid enters permanently , an equal amount of liquid pours out containing both unconsumed nutrients and bacteria .",
    "this pouring out helps regulating the bacteria population size .",
    "these chemostats are extremely useful to make bacteria adapt to the nutrients environment in such a way that they will increase their growth rate .",
    "this experimental device is for example used ( on large scales ) in water treatment stations . in this paper",
    "we study a chemostat model where different nutrients arrive continuously and are simultaneously consumed by bacteria which reproduce and die in a stochastic time scale .",
    "bacteria are characterized by genetic parameters which are inherited during reproduction except when a mutation occurs .",
    "these parameters as well as the concentrations of each resource , influence the demographics of the bacteria population .",
    "usually , chemostat models are essentially deterministic where both nutrients and bacteria population dynamics are described by coupled deterministic continuous process .",
    "this point of view is based on the fact that reproduction of bacteria happens at the same time scale than nutrient dilution . in this work",
    ", we consider that the bacteria population is not so large that deterministic approximation of its size can be justified .",
    "we develop stochastic chemostat models based on the previous work of crump and o young @xcite ( see also  @xcite ) , where bacteria dynamics is modeled by a birth and death process whose demographic parameters depend on the concentration of a unique resource , the later evolving continuously in time .",
    "this model has been rigorously studied in collet - mlard - martinez @xcite    the literature on multi - resource chemostats is extensive but mostly specialized to very precise models . in a more general framework",
    "as we consider here , we refer for example to @xcite , @xcite .",
    "our goal is to study the darwinian evolution of the genetic parameters of the bacteria in the chemostat .",
    "we will study how mutations and competition for nutrients lead to their progressive adaptation .",
    "the study of adaptive dynamics has been developed in the last two decades , in particular by metz , geritz and coauthors  @xcite , and dieckmann and law  @xcite .",
    "this theory emphasizes the connections between ecology and evolution : competition for resources strongly influences the selection of advantaged bacteria .",
    "the theory was put on a rigorous mathematical footing by champagnat and mlard and coworkers  @xcite with a probabilistic approach ( see also  @xcite for a pde approach ) .",
    "these results are based on the combination of large population and rare mutation scalings , allowing to describe evolution as a succession of mutant invasions . in all these works ,",
    "all the models are either lotka - volterra models or models of competition for resources assumed to be at a quasi - stable equilibrium .",
    "this amounts in all cases to assume direct competition between individuals .",
    "our model is more realistic and takes explicit dynamics for several resources into account .",
    "this leads to competitive interactions between bacteria , driving selection , with a more complicated nonlinearity than the lotka - volterra direct competition ( although links exist under specific parameter scalings , see @xcite ) .",
    "the modeling of adaptation for multi - resources chemostat has never been studied from a probabilistic point of view and only recently with a pde s approach ( see @xcite ) .",
    "our goal is to study adaptive dynamics in these models using the approach of  @xcite combining large populations , rare and small mutations .",
    "let us emphasize that adding resources dynamics makes the mathematical analysis more complicated and difficult than for the lotka - volterra model .",
    "we first introduce the model in section  [ sec : model ] .",
    "we construct a stochastic multi - resource chemostat model which couples deterministic and stochastic dynamics .",
    "the bacteria dynamics follows a birth and death process with reproduction due to resources consumption and mutation .",
    "the resource process is deterministic between birth or death events in the bacteria population , with coefficients depending on the composition of the population .",
    "then we introduce multi - resources chemostat deterministic systems as large size approximations of these probabilistic models .    the core ingredient in our proofs is a stability result on deterministic chemostat systems , seeing the stochastic process as a sort of perturbation . in section  [ sec : asympt - chemostat ] , we thus study the long time behavior of such deterministic nonlinear systems and prove the convergence to a unique equilibrium as soon as some non - degeneracy assumptions hold true . the proof is based on several lyapunov functionals which considerably extend the usual lyapunov functional for chemostat systems ( see @xcite ) .    in section  [ sec : gd ]",
    ", we study the long time stability of the stochastic process , viewed as an approximation of the deterministic chemostat system .",
    "we prove that all traits with zero density at equilibrium actually go extinct after a time of the order the logarithm of the population size .",
    "we also prove that the time of exit from a neighborhood of the equilibrium grows exponentially in the population size .",
    "this kind of result follows classically from large deviation estimates , which we prove here in the non standard situation of perturbed resources dynamics , using the lyapunov functionals of section  [ sec : asympt - chemostat ] .",
    "we finally study in section  [ sec : pes ] the individual - based process on the evolutionary time scale in three steps : first in subsection  [ sec : cv - pes ] we consider a large population and rare mutation scaling but we do not let the size of each mutation go to @xmath0 .",
    "this ensures that the stochastic model on the mutation time scale ( evolutionary time scale ) converges to a pure jump process describing the successive invasions of advantageous mutants .",
    "this process , called polymorphic evolution sequence ( pes ) , generalizes the tss introduced in @xcite and the pes for lotka - volterra models whose existence has been proved in @xcite .",
    "the difficulty consists in extending these results to our more complicated model , which is done in appendix  [ sec : pf - pes ] .",
    "second , we introduce a scaling of small mutations in the pes , letting the size of each mutation go to @xmath0 .",
    "we prove in section  [ sec : small - mut ] that , in this limit , the dynamics of co - existing traits is governed by a system of odes extending the canonical equation of adaptive dynamics ( see @xcite ) . finally , from this canonical equation and still assuming small mutation steps",
    ", we prove a rigorous characterization of the evolutionary branching points .",
    "the only result which needs a different approach from the lotka - volterra case  @xcite is the branching criterion , where we use the results of section  [ sec : asympt - chemostat ] to prove that coexistence is maintained after evolutionary branching and that the distance between the two branches increases .",
    "the details of the proof are given in appendix  [ app : br ] , after giving useful results on the sign of the fitness function ( appendix  [ sec : sign - fitness ] ) , which governs the possibility of invasion of a mutant trait in a resident population at equilibrium .",
    "we consider an asexual population and a hereditary phenotypic trait .",
    "each individual @xmath1 is characterized by its phenotypic trait value @xmath2 , hereafter referred to as its phenotype , or simply trait .",
    "the trait space @xmath3 is assumed to be a compact subset of @xmath4 .",
    "the individual - based microscopic model from which we start is a stochastic birth and death process , with density - dependence through a reproduction depending on the resources in the chemostat .",
    "there are @xmath5 different resources .",
    "resources are injected in the fluid at the constant rate @xmath6 .",
    "their concentrations decrease first because of the linear pouring out of the fluid from the chemostat and second by their consumption by the bacteria .",
    "we assume that the population s size scales with an integer parameter @xmath7 tending to infinity while the effect of the individual resources consumption scales with @xmath8 .",
    "this allows taking limits in which individuals are weighted with @xmath8 . in section  [ sec : small - mut ] , another crucial scale will be the mutation amplitude @xmath9 .",
    "we consider , at any time @xmath10 , a finite number @xmath11 of individuals , each of them holding trait values in @xmath3 .",
    "let us denote by @xmath12 the trait values of these individuals .",
    "the state of the population at time @xmath10 , rescaled by @xmath7 , is described by the finite point measure on @xmath3 @xmath13 where @xmath14 is the dirac measure at @xmath15 .",
    "this measure belongs to the set of finite point measures on @xmath16 with mass @xmath17 @xmath18 let @xmath19 denote the integral of the measurable function @xmath20 with respect to the measure @xmath21 and @xmath22 denotes its support",
    ". then @xmath23 and for any @xmath24 , the positive number @xmath25 is called the density at time @xmath26 of trait @xmath15 .",
    "the concentrations of the @xmath5 resources at time @xmath26 are described by a @xmath5-dimensional vector @xmath27    we introduce the following demographic parameters .    *",
    "an individual with trait @xmath15 reproduces with birth rate given by @xmath28 where @xmath29 represents the ability of a bacteria with trait @xmath15 to use resource @xmath30 for its reproduction . *",
    "reproduction produces a single offspring . with probability @xmath31",
    ", the newborn holds the trait value @xmath15 of the parent . *",
    "a mutation occurs with probability @xmath32 with @xmath33 and affect the trait of the descendant involved in the reproduction event .",
    "the trait of the descendant is @xmath34 with @xmath35 chosen according to @xmath36 , where @xmath37 $ ] scales the mutation amplitude .",
    "+ for any @xmath15 the probability measure scales as @xmath38 , where @xmath39 is a probability measure with support @xmath40 and such that @xmath41 for all @xmath35 in the support of @xmath42 and for all @xmath43 ( this last point is for example true when @xmath3 is a convex subset of @xmath4 ) . in other words ,",
    "the support of @xmath44 has a diameter smaller than @xmath45 .",
    "* small @xmath46 means rare mutations and we assume in the sequel that @xmath47 * each individual with trait @xmath15 disappears from the chemostat at rate @xmath48 either from natural death or pouring out with the liquid .",
    "since the fluid pours out of the chemostat at rate 1 , one could assume @xmath49 , although this is not necessary for our study .",
    "* the concentrations of resources in the liquid are solutions of the piecewise deterministic equations : for any @xmath50 , @xmath51 where @xmath52 represents the @xmath53-th resource injection in the chemostat .",
    "the term @xmath54 represents the pouring out of the @xmath53-th resource and the term @xmath55 describes the resource consumption by bacteria .",
    "note that any solution to such an equation satisfies for any @xmath56 the inequality @xmath57 .",
    "the process @xmath58 is a @xmath59-valued markov process with infinitesimal generator defined for any bounded measurable functions @xmath60 from @xmath61 to @xmath62 and @xmath63 and @xmath64 by    @xmath65    the first term describes the births without mutation , the second term the births with mutation , the third term the deaths and the fourth term the dynamics of resources .",
    "we consider a case with two resources and one - dimensional traits having opposite effects on the two resources consumption .",
    "more precisely let us define the following parameters :    @xmath66 $ ] , @xmath67 , @xmath68 ( conditioned on @xmath69 ) , @xmath70 ( 2 resources ) , @xmath71 , @xmath72 with @xmath73 ( minimum at @xmath0 ) , @xmath74 , @xmath75 .",
    "the parameter @xmath76 measures the impact of trait on mortality .",
    "high @xmath76 means strong effect of traits away from 0 on mortality .",
    "simulations are given in figure [ sim1 ] , where initially @xmath7 individuals have the same trait @xmath77 , for three different mortality parameters , @xmath78 , @xmath79 and @xmath80 .",
    "the upper panels represent the time evolution of the density of traits in the population , and the lower panels the resources concentrations .",
    "we observe two different behaviors . in the four pictures ,",
    "the support of the population process first approaches @xmath0 , where mortality is the smallest , but next , for @xmath79 and @xmath80 , the support of the population process stays close to 0 for a long time , while for the two simulations with @xmath78 , the population divides into two subpopulations with distinct trait values , but still interacting for the same resources .",
    "this phenomenon is known as _",
    "evolutionary branching_.    the two different simulations of evolutionary branching for @xmath78 ( fig .",
    "[ sim1 ]  ( a ) and  ( b ) ) illustrate two slightly different ways of branching . in the first one ,",
    "evolutionary branching occurs when the traits in the population are distributed around a value not exactly equal to 0 , contrary to the second simulation .",
    "as will appear in this paper , this explains why , in the first picture , the two branches are of very different size at the beginning of evolutionary branching , while they are of similar size in the second picture .",
    "[ sim1 ]  ( c ) does not show evolutionary branching , but the width of the trait distribution around 0 is wider than in the fourth picture , where @xmath76 is bigger .",
    "as will appear below , the third picture actually corresponds to a critical case with respect to evolutionary branching . finally , in fig .",
    "[ sim1 ]  ( d ) , we also observe an interesting situation in the first phase of evolution , where the trait distribution in the populations is approaching to 0 .",
    "there is a jump in the support of the trait distribution around time @xmath81 , which can be understood as follows : at this time , a mutant just appeared by chance , with a much bigger trait than the largest trait in the population just before .",
    "this mutant survived and produced a large descendence with a significantly smaller death rate than the rest of the population , which was therefore competitively disadvantaged , and went extinct fast due to this competitive pressure .",
    "[ sim1 ]    .",
    "upper panels : time evolution of the trait density in the population .",
    "lower panels : time evolution of the resources concentrations.,title=\"fig:\",width=226 ] + ( a ) @xmath82    . upper panels : time evolution of the trait density in the population .",
    "lower panels : time evolution of the resources concentrations.,title=\"fig:\",width=226 ] + ( b ) @xmath82    . upper panels : time evolution of the trait density in the population .",
    "lower panels : time evolution of the resources concentrations.,title=\"fig:\",width=226 ] + ( c ) @xmath83    .",
    "upper panels : time evolution of the trait density in the population .",
    "lower panels : time evolution of the resources concentrations.,title=\"fig:\",width=226 ] + ( d ) @xmath84     +    our goal in this paper is to give a description of these pictures under a specific scaling of the parameters of the individual - based model , and to give some conditions under which evolutionary branching appears . the evolution of the population results from an instantaneous trade - off between death rate minimization and the birth rate maximization ( through a better consumption of resources ) of the individuals .",
    "the ecological time scale is the birth and death time scale in which the process is defined .",
    "the evolution takes place on the longer time scale of mutations .",
    "the following properties will be assumed in the sequel .",
    "@xmath85 , \\hbox{\\it\\ there exists a function\\ }      \\bar{m}_{\\sigma}:\\mathbb{r}^{\\ell}\\rightarrow\\mathbb{r}_+ \\text{\\it\\ such        that\\ } \\\\ &   m_{\\sigma}(x , h)\\leq \\bar{m}_{\\sigma}(h ) \\text{\\it\\ for any\\ } x\\in{\\cal x } \\text{\\it\\ and\\ } h\\in\\mathbb{r}^{\\ell }      \\text{\\it\\ and\\ } \\int_{\\mathbb{r}^\\ell }      \\bar{m}_{\\sigma}(h)dh<+\\infty .",
    "\\end{aligned }    \\label{a2 }     \\\\    & \\notag \\\\ & \\text{\\it the initial conditions satisfy } \\quad   \\sup_k\\mathbb{e}(\\langle\\nu^k_0,1\\rangle)<\\infty\\quad ; \\quad \\sup_{k , k\\in\\{1,\\ldots , r\\}}\\,r^k_k(0)<\\infty .",
    "\\label{a2bis } \\end{aligned}\\ ] ]    for fixed @xmath7 , under   , the existence and uniqueness in law of a process on @xmath86 with infinitesimal generator @xmath87 can be adapted from the one in fournier - mlard @xcite or @xcite .",
    "the process is constructed as solution of a stochastic differential equation driven by point poisson measures describing each jump event plus a drift term describing the resource dynamics and assumptions   and   prevent the population from exploding since resources concentrations are bounded .",
    "let us recall the construction .",
    "let @xmath88 , @xmath89 and @xmath90 be independent poisson point measures on @xmath91 , @xmath92 and @xmath91 respectively , and with intensity measures @xmath93 , @xmath94 and @xmath95 respectively , where @xmath96 and @xmath97    for all @xmath98 , we define @xmath99 for all @xmath100 such that @xmath101 and @xmath102 where @xmath103 and @xmath104 is an arbitrary total order on @xmath105 ( e.g.  the lexicographic order .",
    "now , let us consider the equation @xmath106 coupled with the equations  ( [ eq : edo - r ] ) for resources with @xmath107 .",
    "this system of equations admits a unique solution , up to a time of accumulation of jumps .",
    "the next proposition shows that this time is infinite and gives uniform moment estimates .",
    "[ prop : moments - nu ] assume  ",
    ", then the process does not explode in finite time almost surely and for all @xmath10 , @xmath108<\\infty.\\ ] ]    since @xmath109 for all @xmath10 , the individual birth rate in the population is always smaller than @xmath110 , where @xmath111 .",
    "therefore , for all @xmath112 , @xmath113 is stochastically dominated by a pure birth ( yule ) process in @xmath114 with transition rate @xmath115 from @xmath53 to @xmath116 ( this process can be easily explicitly constructed from the point processes @xmath117 , @xmath118 and @xmath119 ) .",
    "the yule process is a.s .",
    "finite for any @xmath26 , so that the process is well defined for all times . in addition , we get that @xmath120 with @xmath121 where @xmath122 , @xmath123 , are the compensated poisson processes . the process",
    "@xmath124 is a martingale and thus @xmath125 = \\mathbb{e}\\left[\\langle\\nu^k_0,1\\rangle+\\sum_{k=1}^r    r^k_k(0)\\right]+\\int_0^t\\left(-\\langle\\nu^k_s , d\\rangle+\\sum_k(g_k - r^k_k(s))\\right)ds.\\ ] ] then follows from the fact that @xmath126 by assumption   and gronwall s lemma .",
    "in addition , because of the shift invariance of the poisson point measures @xmath117 , @xmath118 and @xmath119 , the process @xmath127 is strong markov .",
    "the next result shows that mutations can not occur on bounded time intervals , since the mutation time scale @xmath128 tends to infinity by .",
    "we define @xmath129 as the first mutation time of the population process @xmath130 .",
    "[ lemma : not - too - many - mutation ] assume  . then for all @xmath131 , there exists @xmath132 such that for all @xmath10 @xmath133\\right)\\leq\\eta.\\ ] ]    the proof is based on a coupling inspired by the previous proposition . by the markov property , it is sufficient to prove the result for @xmath134",
    ". let @xmath135 be the solution of @xmath136 coupled with the equation @xmath137 comparing with  ( [ eq : constr - nu ] ) we see that @xmath138 and @xmath139 for all @xmath140 .",
    "now , let us define the @xmath114-valued process @xmath141 where @xmath142 and @xmath143 .",
    "then @xmath144 , where @xmath145 is the first jump time of @xmath146 . since @xmath118 is independent of @xmath147 , we have @xmath148 \\\\      & \\geq",
    "g\\int_0^{\\varepsilon / k\\mu_k}\\mathbb{e}\\langle\\tilde\\nu^k_s,1\\rangle\\ , ds ,    \\end{aligned}\\ ] ] and lemma  [ lemma : not - too - many - mutation ] follows from the boundedness of the moments ( cf .",
    "proposition [ prop : moments - nu ] ) .",
    "in this section we study the large population and rare mutation approximation of the process described above when the initial measure has the finite support @xmath150 .",
    "the limit is deterministic and continuous and the mutation events disappear .",
    "the next result is a simple but useful first step to characterize the dynamics between mutation events .",
    "we introduce the following chemostat ( coupled ) system , denoted by @xmath151 , solved by @xmath152 : for @xmath153 , for @xmath154 , @xmath155    [ largepop ] let @xmath156 be distinct points in @xmath3 .",
    "assume that @xmath157 such that @xmath158 and @xmath159 in probability , where @xmath160 and @xmath161 are deterministic , nonnegative numbers .",
    "then , for all @xmath162 , @xmath163 and @xmath164 in probability as @xmath149 , where @xmath165 is the solution of the chemostat system @xmath166 with initial condition @xmath167 and @xmath168 .    since @xmath169 , the fact that @xmath170 follows trivially from corollary  [ lemma : not - too - many - mutation ]",
    ". therefore , in order to prove the second part of the result , it suffices to prove it for the population dynamics obtained by setting to zero the birth rates with mutation . in this case",
    ", the model reduces to a birth and death markov chain in @xmath171 for @xmath172 , coupled with piecewise deterministic dynamics for the resources .",
    "then the second part of the result can be proved using standard techniques from  ( * ? ? ?",
    "the only difficulty comes from the fact that the birth and death rates and the vector fields of the resources dynamics are only _ locally _ lipschitz functions of the state of the process .",
    "since the limit function @xmath173 takes values in a compact set , the difficulty can be easily solved by regularizing the transition rates out of a sufficiently large compact set .",
    "in order to study the long time behavior of the system , we need some additional assumptions .",
    "assumption means that when resources are maximal the population process is supercritical .",
    "thus , prevents the individual - based model to become extinct too fast .",
    "it also ensures that the trivial equilibrium @xmath175 of the deterministic system   is unstable .    since",
    "the equilibria @xmath176 of the chemostat system @xmath166 are given by canceling the right hand side of , they must satisfy @xmath177 and for all @xmath1 either @xmath178 or @xmath179    therefore assumption implies that , for all @xmath180 there is at most one equilibrium @xmath181 of  ( [ system ] ) such that @xmath182 for all @xmath183 and @xmath184 for all @xmath185 .",
    "in particular , we will make use of the following consequence of  : if @xmath186 is an equilibrium of  ( [ system ] ) and @xmath187 is a vector of @xmath188 such that @xmath189 implies @xmath182 for all @xmath190 and for any @xmath53 @xmath191 then @xmath192 .",
    "[ prop : a4 ]    : :    assumption   is satisfied as soon as : for all distinct    @xmath193 , the vectors    @xmath194    are linearly independent , and for all distinct    @xmath195 , the vectors    @xmath196    are also linearly independent . : :    conversely , assumption   implies that , for all distinct    @xmath156 such that   admits a solution with all    positive coordinates , the vectors @xmath197    are linearly independent . in particular ,   admits no solution in    @xmath198 if @xmath199 .",
    "let us first assume that @xmath200 and fix @xmath156 distinct .",
    "in view of , the system of equations @xmath201 has no solution @xmath202 .",
    "hence the system  ( [ eq : hypa4 ] ) has no solution .    if @xmath203 , consider two solutions @xmath204 and @xmath205 of ( [ eq : hypa4 ] ) and define the vector @xmath206 by @xmath207 and the vector @xmath208 similarly in function of @xmath205 .",
    "then @xmath209 where we have used for @xmath210 and @xmath211 .",
    "since @xmath212 for all @xmath1 , the previous quantity is 0 .",
    "therefore , @xmath213 since @xmath203 , the vectors @xmath214 are linearly independent under condition  ( [ eq : cond - a4 ] ) , which ends the proof of by implying that @xmath215 .",
    "assuming that point  ( ii ) does not hold , and letting @xmath156 be distinct traits and @xmath216 be a solution to  ( [ eq : hypa4 ] ) such that @xmath217 for all @xmath218 and for some @xmath219 . then , for @xmath220 close enough to 0 , the vector @xmath221 belongs to @xmath222 and is another solution of  ( [ eq : hypa4 ] ) , where @xmath223 .    the two assumptions ",
    "imply our main result on the large time behavior of the chemostat systems of odes .",
    "[ equilibrium ] assume and .",
    "for all @xmath224 and all distinct @xmath225 , there exists @xmath226 in @xmath227 such that any solution @xmath228 of the system with @xmath229 for any @xmath230 , converges to @xmath226 .",
    "in addition , @xmath226 is the unique equilibrium of the system satisfying , for all @xmath1 such that @xmath231 , the ( weak ) stability condition @xmath232    before giving the proof , we define two notions of great importance in the sequel . writing @xmath233 , we denote by @xmath234 the vector of equilibrium densities of the previous theorem and by @xmath235 the corresponding equilibrium resources concentrations .",
    "[ def : coex - fitn ] we say that the traits @xmath236 coexist if the quantities @xmath237 are all positive , where @xmath233 . for all @xmath224 , we denote by @xmath238 the domain of coexistence of @xmath239 traits : @xmath240 note that @xmath241 .",
    "+ for distinct traits @xmath156 , we also define the invasion fitness of a new trait @xmath242 as the function @xmath243    [ rem : comment - a4 ] we can interpret assumption   and proposition  [ prop : a4 ] with this vocabulary :   implies that there exists at most a single vector of population densities where @xmath156 coexist for all distinct @xmath244 , and proposition   means that when @xmath156 coexist , we must have @xmath203 .",
    "in particular , @xmath245 if @xmath199 .",
    "if the trait @xmath242 is interpreted as a mutant trait trying to invade the resident populations of coexisting traits @xmath156 , the terminology of fitness refers to the possibility of invasion of the mutant trait .",
    "indeed , it follows from theorem  [ equilibrium ] that @xmath246 iff @xmath247 , and that if @xmath248 , the last equilibrium is locally unstable , since the jacobian matrix of the system at this point obviously admits @xmath249 as eigenvalue .",
    "the proof of this results was sketched in  @xcite .",
    "we shall give here a complete and detailed proof .",
    "the idea is to construct a lyapunov functional for the system  ( [ system ] ) in three steps .    [",
    "[ step-1.-lyapunov - functional - and - stable - equilibrium - for - a - reduced - system ] ] step 1 .",
    "lyapunov functional and stable equilibrium for a reduced system : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we consider the quasi - stable approximation of the system  ( [ system ] ) obtained by putting at each time @xmath26 the resources at the equilibrium associated with the population densities at time @xmath26 .",
    "@xmath250 this system admits the lyapunov functional @xmath251 one easily checks that @xmath252 this is a strict lyapunov functional since @xmath253 , and @xmath254 if and only if @xmath255 is an equilibrium of the system  ( [ eq : system2 ] ) . clearly , @xmath256 since @xmath257 for all @xmath258 .",
    "therefore , for any initial condition @xmath259 , the solution @xmath255 of   converges to an equilibrium when @xmath260 .",
    "in addition , @xmath261 is a convex function as @xmath262 hence @xmath263 thus the convexity .",
    "in general @xmath261 is not strictly convex as  ( [ eq : convexite - f ] ) can vanish for nonzero @xmath264 if @xmath199 .",
    "however we can still prove that there is a unique local minimum .",
    "indeed , consider any critical point @xmath265 of @xmath261 .",
    "define @xmath266 the set of indices @xmath1 s.t . @xmath267 .",
    "then for any @xmath185 one has that @xmath268 we denote @xmath269 the subspace of @xmath270 defined by @xmath271 iff @xmath272 for any @xmath183 . at the point @xmath265 , @xmath261 is strictly convex in @xmath269 . indeed",
    "if not , one could find @xmath271 s.t .",
    "@xmath273 for any @xmath53 .    on the other hand for @xmath220 small enough @xmath274 also belongs to @xmath275 and one also has that @xmath276 which would violate the assumptions and .",
    "this shows that if @xmath265 is a local minimum of @xmath261 then no other local minima may exist on @xmath269 , as @xmath261 is convex over @xmath269 and strictly convex at @xmath265 .    since @xmath277",
    "when @xmath278 with @xmath279 , @xmath261 has at least one global minimum .",
    "choose a global minimum @xmath265 such that @xmath280 is the largest and assume that there exists another one @xmath281 , defining another set @xmath282 . since @xmath261 is strictly convex in @xmath283 , one necessarily has that @xmath284 .",
    "in addition by the convexity of @xmath261 any @xmath285 is also a global minimum .",
    "however for @xmath286 , one has that @xmath287 for any @xmath288 which is strictly larger than @xmath266 .",
    "hence we obtain a contradiction and @xmath261 has a unique global minimum .",
    "therefore , @xmath261 admits a unique global minimizer in the closed , convex set @xmath289 , denoted @xmath290 .",
    "let us denote by @xmath291 the vector with coordinates @xmath292 then , the vector @xmath186 is an equilibrium of  ( [ system ] ) . since @xmath290 is a global minimum of @xmath261 on @xmath289 , for any @xmath1 such that @xmath182 , one must have @xmath293 . this yields  ( [ stable ] ) .",
    "let us check that @xmath186 is the only equilibrium of  ( [ system ] ) satisfying this property .",
    "this is equivalent to checking that @xmath290 is the only equilibrium of  ( [ eq : system2 ] ) such that @xmath294 for all @xmath1 such that @xmath182 . since @xmath290 is an equilibrium of  ( [ eq : system2 ] ) , note also that @xmath295 for all @xmath1 such that @xmath184 .",
    "let us consider two such equilibria , @xmath296 . then , adapting the computation for the convexity of @xmath261 @xmath297 this can not hold unless @xmath298 but this would imply that @xmath299 ( with obvious notations ) . defining @xmath300 ,",
    "since @xmath301 and @xmath302 are equilibria of  ( [ eq : system2 ] ) , we would then have @xmath303 for all @xmath304 , and we would obtain a contradiction with assumption   applied to @xmath305 . hence @xmath186 is the only equilibrium of  ( [ system ] ) satisfying  ( [ stable ] ) .",
    "[ [ step-2.-a - degenerate - lyapunov - functional - for - the - systemsystem ] ] step 2 .",
    "a degenerate lyapunov functional for the system  ( [ system ] ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us fix @xmath306 and consider the solution @xmath307 of  ( [ system ] ) .",
    "we define @xmath308 then , for any solution of  ( [ system ] ) with @xmath309 , one has @xmath310 or @xmath311 equation  ( [ stable ] ) implies that the second term in the r.h.s .",
    "is non - positive .",
    "therefore , @xmath312 since the second term of the r.h.s . is zero . therefore , @xmath313 is a lyapunov functional for the system  ( [ system ] ) , degenerate in the sense that , in view of  ( [ eq : calcul - calcul ] ) , its derivative could vanish when @xmath314 but @xmath315 for some @xmath1 .",
    "note that @xmath313 is convex ( strictly in the @xmath316 and in the @xmath317 for which @xmath318 ) and @xmath319 when @xmath320 in @xmath321 . as a consequence ,",
    "the function @xmath255 is bounded , say by @xmath322 .    since @xmath323 , @xmath324",
    "is uniformly bounded in time , and by lyapunov s theorem , @xmath325 when @xmath260 and thus @xmath326 now , let us define @xmath327 note that if @xmath184 then @xmath185 but that @xmath266 could be larger .",
    "since @xmath186 satisfies  ( [ stable ] ) , @xmath328 for all @xmath183 , i.e. @xmath329 then , using , one can find a more precise expression than @xmath330    [ [ step-3.-second - lyapunov - functional - for - the - systemsystem ] ] step 3 .",
    "second lyapunov functional for the system  ( [ system ] ) : + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we can partly correct the problem that @xmath313 is a `` degenerate '' lyapunov functional by slightly modifying it : let @xmath331 be a small positive number and define @xmath332 where @xmath333 then @xmath334 since @xmath176 is an equilibrium of  ( [ system ] ) , the first term in the r.h.s .",
    "is equal to @xmath335.\\ ] ] it follows from the definition of the set @xmath266 that the third term of the r.h.s .  of  ( [ eq : calcul ] )",
    "is equal to @xmath336 where the constant @xmath337 depends only on uniform upper bound for the functions @xmath324 , @xmath338 and @xmath339 . finally , using cauchy - schwartz inequality and the boundedness of @xmath204 , the last term of the r.h.s .",
    "of  ( [ eq : calcul ] ) is bounded by @xmath340 where the constant @xmath341 depends only on @xmath322 and uniform upper bounds for @xmath324 and @xmath338 .    combining all these inequalities with  ( [ eq : calcul3 ] ) , we obtain @xmath342 if @xmath331 is small enough .",
    "lyapunov s theorem then entails that the set of accumulation points of @xmath307 when @xmath260 is contained in the sub - manifold @xmath343 of @xmath321 defined as the set of @xmath344 satisfying @xmath345 since @xmath182 for all @xmath183 , this sub - manifold @xmath343 contains the point @xmath186 . since @xmath186 is an equilibrium , the second system of equations above is equivalent to @xmath346 therefore assumption   applied to the vector of traits @xmath347 implies that @xmath348 for all @xmath185 .",
    "hence @xmath343 is reduced to the point @xmath186 and the proof of theorem  [ equilibrium ] is completed .        in case @xmath349",
    ", we consider a unique trait @xmath15 .",
    "the equilibrium @xmath350 defined in theorem [ equilibrium ] satisfies @xmath351 remark that the left hand side is a decreasing function of @xmath350 , and so there is a unique solution to this equation .",
    "therefore by the implicit function theorem and assumption , the function @xmath350 is a @xmath352-function .    the resources at equilibrium are thus given by @xmath353      in case where @xmath354 , we consider two distinct traits @xmath355 and @xmath356 .",
    "then the fitness function defined in is given by @xmath357 it is immediate to observe that @xmath20 is @xmath352 with respect to @xmath358 .",
    "the system @xmath359 has two obvious equilibria : @xmath360 and @xmath361 . in view of",
    ", @xmath362 is the equilibrium given by theorem [ equilibrium ] if and only if @xmath363 and a similar condition for @xmath364 ( and we can not have both @xmath365 and @xmath366 ) .",
    "if we have @xmath367 and @xmath368 , the equilibrium of theorem [ equilibrium ] must have positive density coordinates @xmath369 .",
    "therefore , we have the following result .    [ prop : dimorph ] for any @xmath370 in @xmath3 , the traits @xmath371 and @xmath372 coexist if and only if @xmath373 and @xmath374 .",
    "moreover the vector @xmath369 is solution of the system @xmath375      when the population is composed of @xmath239 distinct traits @xmath156 , the case of coexistence can be characterized by induction over @xmath239 by negating the stability condition  ( [ stable ] ) of theorem  [ equilibrium ] for each trivial equilibrium of the system @xmath166 . by trivial equilibrium ,",
    "we mean any equilibrium with at least one null coordinate for population densities .    in the case where @xmath233 coexist ,",
    "the equilibrium densities satisfy @xmath376 and the resources concentrations at equilibrium are given by @xmath377    we have the following regularity result for the function @xmath378 on @xmath238 .",
    "[ lem : bar - u - continue ] for all @xmath224 , the function @xmath378 is @xmath352 and bounded on @xmath238 .",
    "in addition , @xmath238 is an open subset of @xmath379 .",
    "let us first prove that @xmath378 is @xmath352 on @xmath380 . for @xmath381 ,",
    "the equilibrium population densities @xmath382 are the ( unique , by assumption  ) solutions of  ( [ eq : n - morph - eq ] ) . defining the function @xmath383 from @xmath384 to @xmath270 by",
    "@xmath385 we see that @xmath386 is characterized by the equation @xmath387 .",
    "the jacobian matrix of @xmath261 with respect to @xmath388 at @xmath389 is given by @xmath390 for all vector @xmath391 ,",
    "@xmath392 ^ 2.\\ ] ] hence the matrix @xmath393 is invertible if and only if the orthogonal vector space of the family of vectors @xmath394 in @xmath270 is @xmath395 , where @xmath396 .",
    "this is equivalent to the fact that the vector space spanned by @xmath397 is @xmath270 .",
    "this is implied by  ( [ eq : cond - a4-ii ] ) , which is itself a consequence of assumption   by proposition  [ prop : a4 ] .",
    "hence the fact that @xmath378 is @xmath352 on @xmath380 follows from the implicit functions theorem , as well as the fact that @xmath380 is open .",
    "let us now prove that @xmath378 is bounded on @xmath380 .",
    "this property for all @xmath224 is equivalent to the fact that the function @xmath378 is bounded on @xmath398 for all @xmath224 .",
    "we shall prove this last point . in the proof of theorem  [ equilibrium ] , the equilibrium @xmath399 is characterized as the unique global minimizer on @xmath400 of the function @xmath401 now @xmath402 for all @xmath403 and @xmath404 where @xmath405 , @xmath406 and @xmath407 . therefore , the function @xmath399 is uniformly bounded on @xmath408 , and lemma  [ lem : bar - u - continue ] is proved .",
    "the coexistence criterion of proposition  [ prop : dimorph ] extends as follows to the @xmath239-morphic case .",
    "[ prop : n - morph ] for any @xmath409 and @xmath410 such that for some @xmath411 , + @xmath412 ( this holds for example if @xmath242 is close enough to @xmath413 )",
    ". then @xmath414 if and only if @xmath415 and @xmath416    in the first step of the proof of theorem  [ equilibrium ] , @xmath417 was characterized as the unique global minimizer of the functional @xmath261 defined in  ( [ lyapounov ] ) . by theorem  [ equilibrium ] , we also know that the unique global minimizer of @xmath261 on @xmath418 is @xmath419 and the unique global minimizer of @xmath261 on @xmath420 is @xmath421 where @xmath422 . now , since the derivative of @xmath261 with respect to the @xmath423-th coordinate at @xmath424 is @xmath425 and the derivative of @xmath261 with respect to the @xmath1-th coordinate at @xmath426 is @xmath427 the unique global minimizer of @xmath261 must have positive coordinates , which is the definition of @xmath428 .",
    "theorem  [ equilibrium ] gives the asymptotic behavior of the deterministic chemostat systems .",
    "when @xmath7 is large , one can see the individual - based model as a stochastic perturbation of the deterministic chemostat system .",
    "one may then wonder to what extent this perturbation modifies the long time stability of the system .",
    "the next result answers this question and is going to be useful in section  [ sec : pes ] .",
    "let @xmath156 be distinct points in @xmath3 and @xmath429 and denote by @xmath430 the set of finite measures on @xmath3 .",
    "we define @xmath431    [ thm : gd ] let @xmath156 be distinct points in @xmath3 .",
    "assume that @xmath157 such that @xmath432 a.s .",
    "belongs for @xmath7 large enough to a compact subset @xmath433 of @xmath434 .",
    ": :    for all @xmath429 , there exist    @xmath435 such that    @xmath436 , \\ ; ( \\nu^k_{t},\\mathbf{r}^k(t))\\in b_{\\varepsilon}(\\mathbf{x})\\big ) = 1.\\ ] ] : :    define @xmath437 and    @xmath438 .",
    "assume that for all @xmath185 ,    @xmath439 .",
    "then for all    @xmath440 ,    @xmath441    where @xmath442 .    results as theorem [ thm : gd]-(i ) are often called `` problem of exit from an attracting domain '' and can be solved using classical large deviation tools  @xcite . in the next section , we will need a stronger ( and non standard ) large deviation result for a ( small enough ) perturbed version of the piecewise deterministic process @xmath443 .",
    "therefore we provide a specific proof of the next result based on the lyapunov functionals used in theorem  [ equilibrium ] .    [",
    "prop : fw ] let @xmath156 be distinct traits and assume that the support of @xmath444 is a subset of @xmath445 . consider the population process @xmath446 with perturbed resource dynamics : @xmath447 where @xmath448 is a @xmath449-predictable random process bounded by a constant @xmath450 .",
    "then for any @xmath132 small enough , there exists @xmath451 , @xmath452 and @xmath453 such that , if @xmath454 and @xmath455 , the time of exit @xmath456 of @xmath457 from @xmath458 is bigger than @xmath459 with probability converging to 1 .",
    "[ [ proof - of - theoremthmgd ] ] proof of theorem  [ thm : gd ] + + + + + + + + + + + + + + + + + + + + + + + + +    by theorem  [ equilibrium ] and the continuity of the flow of solutions to the chemostat system , for all @xmath460 , @xmath461 where @xmath462 is the last entrance time in @xmath463 of the solution of @xmath464 with initial condition @xmath465 .",
    "then , applying theorem  [ largepop ] on the time interval @xmath466 $ ] , we obtain that @xmath467 when @xmath149 , where @xmath468 then , choosing @xmath469 as in proposition  [ prop : fw ] and setting @xmath470 , point  ( i ) follows from the markov property and proposition  [ prop : fw ] ( with @xmath471 ) .    for all @xmath185 , on the event @xmath472 , during all the time interval",
    "@xmath473 $ ] , the birth rate of each individual of trait @xmath413 is bounded from above by @xmath474 for some constant @xmath337 .",
    "therefore , the number @xmath475 of individuals with trait @xmath413 at time @xmath476 is dominated on the event @xmath472 by a continuous time binary branching process @xmath477 with birth rate @xmath474 , death rate @xmath478 and initial condition @xmath479 .",
    "it is well - known ( cf .",
    "e.g.  @xcite ) that @xmath480 choosing @xmath220 small enough for @xmath481 and using the fact that @xmath482 , it is immediate to check that , taking @xmath483 , @xmath484 if @xmath220 is small enough .",
    "point  ( ii ) then easily follows.@xmath485    [ [ proof - of - propositionpropfw ] ] proof of proposition  [ prop : fw ] + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in all the proof , we shall denote by @xmath290 and @xmath291 the vectors @xmath386 and @xmath486 .",
    "let us first observe that , because all the events involved in proposition  [ prop : fw ] are @xmath487 measurable , it is sufficient to prove proposition  [ prop : fw ] for the population process where all birth rates with mutations are set to 0 .",
    "let us still denote this process by @xmath127 .",
    "then , at each time @xmath26 , the set of living traits in the process is a subset of @xmath445 and the model reduces to a birth and death markov chain in @xmath488 for @xmath489 , coupled with  ( [ eq : pert - ress ] ) .",
    "recall the definition of the lyapunov functional @xmath490 for the chemostat system in the proof of theorem  [ equilibrium ] : @xmath491 where @xmath313 is defined in  ( [ eq : def - g ] ) and @xmath492 in  ( [ eq : def - tilde - g ] ) , and @xmath493 can be arbitrary provided it is small enough .",
    "set @xmath494 and @xmath495 .",
    "note that @xmath496 but in general , @xmath497 .",
    "note that @xmath313 is linear in the variables @xmath498 and clearly a strictly convex function of the variables @xmath499 and @xmath500 with diagonal hessian matrix .",
    "hence , since @xmath501 is a quadratic form , making @xmath331 smaller if necessary , @xmath502\\leq c_1 ^ 2\\big (      \\sum_{i\\not\\in i}|u_i-\\bar u_i|^2+\\sum_{i\\in i}u_i+\\|r-\\bar r\\|^2\\big),\\end{gathered}\\ ] ] for some constant @xmath503 and for all @xmath465 close enough to @xmath186 . by  ( [ eq : last - eq ] ) , if @xmath307 is any solution of @xmath464 , @xmath504 for a positive constant @xmath505 if @xmath465 close enough to @xmath186 . due to assumption  , as seen in the end of the proof of theorem  [ equilibrium ] ,",
    "the second term of the right hand side is zero iff @xmath506 .",
    "therefore , introducing @xmath507 one deduces that @xmath508\\ ] ] for some positive constant @xmath509 .    in order to keep notations simple",
    ", we shall denote by @xmath510 the function @xmath511 then , it follows from  ( [ eq : constr - nu ] ) that @xmath512 let @xmath513 denote the first exit time of @xmath514 from @xmath515 .",
    "assuming @xmath516 , one can make a second order expansion of the quantities of the form @xmath517 appearing in the previous equation .",
    "introducing the compensated poisson point measures @xmath518 for @xmath123 , we obtain , for all @xmath516 , @xmath519 where @xmath520 is the local martingale @xmath521 assuming @xmath220 small enough , combining  ( [ eq : gronwall-1 ] ) ,  ( [ eq : gronwall-2 ] ) and  ( [ eq : gronwall-3 ] ) , we obtain for all @xmath522 $ ] and for @xmath523 @xmath524}|m^k_t|   \\\\    -c_4\\int_0^t\\left(\\|n^k(s)-\\bar u\\|^2+\\|r^k(s)-\\bar r\\|^2-c_5\\eta\\right)ds\\big ] \\label{eq : last}\\end{gathered}\\ ] ] for some constant @xmath525 .",
    "therefore , before @xmath526 , @xmath527 can not stay larger than @xmath528 on a time interval larger than @xmath529}|m^k_t|}{c_4c_5\\eta}.\\ ] ] this implies the following lemma .",
    "[ lem : interm ]    : :    fix @xmath530 , define @xmath531 as    in  ( [ eq : def - t - eta ] ) and let @xmath532 denote the first    hitting time of the @xmath533-neighborhood of    @xmath186 by @xmath534 .",
    "then ,    on the event @xmath535    we have    @xmath536}(\\|n^k(t)-\\bar u\\|^2+\\|r^k(t)-\\bar r\\|^2)\\leq c_1c_4c_5\\eta        t_\\eta\\leq\\frac{\\varepsilon}{2}\\ ] ] and    @xmath537 a.s . : :    in addition , on the same event , we also have    @xmath538}(\\|n^k(t)-\\bar u\\|^2+\\|r^k(t)-\\bar r\\|^2)\\leq        c_1c_4c_5\\eta ( t_\\eta+t)\\leq\\frac{\\varepsilon}{2}+c_1c_4c_5\\eta t.\\ ] ]    therefore , under the additional condition that    @xmath539 we have    @xmath540 .",
    "we are also going to use exponential moment estimates on the martingale @xmath520 .",
    "[ lem : expo - moment ] for all @xmath541 and @xmath162 , there exists a constant @xmath542 such that for all @xmath7 large enough @xmath543}|m^k_t|>\\alpha\\big)\\leq     \\exp(-kv_{\\alpha , t}).\\ ] ]    since we are only dealing with events occurring before @xmath544 , we can assume without loss of generality that the martingale @xmath520 has all its jumps bounded by a constant times @xmath17 , and that all its jump times are ( some of the ) jump times of poisson point measures which occur at a rate bounded by a constant times @xmath7 ( i.e.  the poisson point measures @xmath545 , @xmath546 and @xmath547 , where @xmath548 ) .",
    "therefore , the previous result is a quite standard consequence of properties of exponential martingales for pure jump processes .",
    "for example , this is a consequence of the proof of proposition  4.1 in  @xcite , where it is proved that there exists a constant @xmath549 independent of @xmath550 and @xmath220 such that for all @xmath73 @xmath551}|m^k_t|>\\varepsilon\\big)\\leq 2\\exp(-ka\\varepsilon+ckt\\tau(ca)),\\ ] ] where @xmath552 . since @xmath553 when @xmath554 , lemma  [ lem : expo - moment ] then follows by choosing @xmath73 small enough .",
    "let us now introduce two parameters @xmath555 and @xmath469 such that @xmath556 , to be determined later .",
    "let @xmath557 . for all @xmath558 such that @xmath559 , we define the stopping times @xmath560 then , combining the strong markov property with lemmata  [ lem : interm ]  ( 1 ) and  [ lem : expo - moment ] , it is not difficult to prove ( cf .",
    "@xcite ) that , for convenient choices of @xmath555 and @xmath469 , setting @xmath561 , @xmath562 and @xmath563 , these exists a constant @xmath564 such that @xmath565 and thus , for all @xmath558 , @xmath566 therefore , if @xmath567 denotes the unique integer @xmath53 such that @xmath568 , then @xmath567 is larger or equal to a geometric random variable of parameter @xmath569 .",
    "hence @xmath570 with a probability converging to 1 .",
    "therefore , in order to complete the proof , it only remains to check that for all @xmath53 , @xmath571 with positive probability for some @xmath572 .",
    "thanks to the strong markov property , this is implied by @xmath573 which is a consequence of lemmata  [ lem : interm ]  ( 2 ) and  [ lem : expo - moment ] , replacing @xmath220 by @xmath574 and choosing @xmath575 and @xmath576 ( in view of the choice of @xmath450 above , this can impose to reduce @xmath469 so that @xmath577 , but this only changes the constant @xmath578 above ) , and the proof of proposition  [ prop : fw ] is completed.@xmath485",
    "we now go back to the stochastic model of section  [ sec : model ] .",
    "our goal is to describe the effect of the random mutations on the population under a scaling of large population and rare and small mutations .",
    "we give three convergence results corresponding to three evolutionary time scales .",
    "these results are similar to the ones obtained the lotka - volterra competition case  ( cf . @xcite ) and the new ingredients needed in the proofs have been already obtained in the previous sections . therefore this section is devoted to the statement of the results and their application to the example introduced in the section  [ sec : example-1 ] and the rigorous modifications of the proofs are moved to appendix .",
    "as shown in theorem  [ largepop ] , mutations have no influence in the limit of large @xmath7 and small @xmath46 on the original time - scale of the population process .",
    "we show that evolution proceeds on the longer time - scale of mutations @xmath579 , for which the population process converges to a pure jump process describing successive mutant invasions . after each mutation ,",
    "disadvantaged traits are driven to extinction due to the competition induced by the deterministic chemostat systems .",
    "this convergence to a pure jump process is illustrated by figure  [ fig : sim - mut - rares ] .",
    "[ fig : sim - mut - rares ]    .",
    "upper panels : time evolution of the trait density in the population .",
    "lower panels : time evolution of the resources concentrations.,title=\"fig:\",width=226 ] + @xmath580    . upper panels : time evolution of the trait density in the population .",
    "lower panels : time evolution of the resources concentrations.,title=\"fig:\",width=226 ] + @xmath581    the limit process takes values in the set of coupled equilibria of population measures and resources , defined by @xmath582 where @xmath583 were defined in theorem  [ equilibrium ] .",
    "evolution proceeds by jumps of the support of the population measure .",
    "we introduce the following assumption : @xmath584    in particular , this assumption means that , with the previous notations , defining @xmath585 , the traits @xmath586 coexist .",
    "this assumption implies that we will always be in a clear - cut , non degenerate situation : at equilibrium after the invasion of a new mutant trait @xmath587 in a population with traits @xmath156 , for all of these traits , either it survives or the corresponding growth rate ( and eigenvalue of the jacobian ) is strictly negative .",
    "this allows to use theorem [ thm : gd]-(ii ) .",
    "[ thm : pes - fdd ] assume , , , , .",
    "take coexisting @xmath588 and assume that @xmath589 with @xmath590 in probability for all @xmath190 .",
    "assume also that @xmath591 in probability when @xmath149 for all @xmath218 .",
    "assume finally that @xmath592 then , @xmath593 converges to the @xmath594-valued markov pure jump process @xmath595 defined as follows : @xmath596 , @xmath597 where @xmath598 is the support of @xmath599 , and the process @xmath600 jumps for all @xmath601 @xmath602 with jump measure @xmath603_+ }      { \\sum_{k=1}^r\\eta_k(x_j+h)\\bar r_k(\\mathbf{x})}m_\\sigma(x_j , h)dh.\\ ] ] the convergence holds in the sense of finite dimensional distributions on @xmath604 , the set of finite positive measures on @xmath16 equipped with the topology of the total variation norm .",
    "following  @xcite , we call this process _ polymorphic evolution sequence _ ( pes )",
    ". the main steps of the proof are recalled in appendix  [ sec : pf - pes ] .",
    "note that the assumption is quite natural in view of theorem [ thm : gd ] and ensures that mutation occur after competition eliminates disadvantageous traits ( theorem [ thm : gd]-(ii ) ) and before the population densities drift away from equilibrium ( theorem [ thm : gd]-(i ) ) .    as will appear in the proof",
    ", we may interpret the transition rates of the pes as follows : starting from an equilibrium population @xmath605 , the process waits an exponential time of parameter @xmath606 interpreted as a mutation time .",
    "the trait of the parent is selected in the population as @xmath607 , where @xmath266 is a random variable in @xmath608 with distribution @xmath609 this distribution favors the traits with higher resource consumption .",
    "then , the mutant trait is given by @xmath610 , where @xmath611 is distributed as @xmath612 .",
    "an actual jump occurs if the mutant population , initially composed of a single individual , does not go extinct and invades .",
    "a comparison argument between the mutant population size and branching processes allows to compute the invasion probability as the survival probability of a branching process , given by @xmath613_+ } { \\sum_{k=1}^r\\eta_k(x_i+h)\\bar r_k(\\mathbf{x})}.\\ ] ] after the invasion , the new support of the process @xmath614 is given by the set of traits with nonzero densities in the vector of densities @xmath615 .",
    "until the end of the paper , we assume by simplicity that the trait space is one - dimensional , i.e.  @xmath616 .",
    "[ sec : can - eq ]    our goal is to study the pes under an additional biological assumption of small mutations ( @xmath617 ) , which is standard in this context  @xcite .",
    "we prove that when @xmath9 tends to zero , the pes converges on the time scale @xmath618 , to the solution of a ( deterministic ) ode , called _ canonical equation of adaptive dynamics _ , or simply _ canonical equation_.    by theorem  [ thm : pes - fdd ] , we get @xmath619 as long as there is no coexistence of two traits in the population .",
    "since @xmath620 , the pure jump markov process @xmath621 has the infinitesimal generator@xmath622_+ m(x , h)dh,\\ ] ] where @xmath623 the jump process @xmath621 is often called `` trait substitution sequence '' , or tss  @xcite .    by proposition  [ prop : dimorph ] , the first time of coexistence of two traits in the pes is given by @xmath624 by corollary  [ cor : coex ] , coexistence may only occur in the neighborhood of points @xmath625 such that @xmath626 .",
    "this leads to the following definition .",
    "we call a trait @xmath627 an evolutionary singularity if @xmath626 .    since @xmath628 , the form of the generator  ( [ eq : gene - tss ] ) suggests to scale time as @xmath629 in order to obtain a non - trivial limit generator when @xmath630 .",
    "[ thm : can - eq ] assume   , , , , and that @xmath631 where @xmath632 is _ not _ and evolutionary singularity . let @xmath633 be the solution of @xmath634_+\\ m(x(t),h)dh.\\ ] ] such that @xmath635 . then",
    ",    : :    for any @xmath162 ,    @xmath636    and there exists @xmath637 such that for all    @xmath638 , the process    @xmath639)$ ] is a.s .",
    ": :    for any @xmath162 , the process    @xmath640)$ ] converges as    @xmath630 to the deterministic process    @xmath641)$ ] for the skorohod    topology on @xmath642,{\\cal m}_0)$ ] , where    @xmath643 is equipped with the weak topology .",
    "equation  ( [ eq : can - eq ] ) is known as the _ canonical equation of adaptive dynamics _",
    "@xcite .",
    "this result follows from the convergence of the tss process @xmath644 to @xmath633 when @xmath645  ( * ? ? ?",
    "4.1 ) , from the fact that mutation jumps in the trait space are bounded by @xmath646 ( by the definition of the jump measure @xmath647 ) which converges to 0 when @xmath648 and from a careful study of the solutions of equation .",
    "[ rem : sym - cead ] in the case when @xmath42 is a symmetrical measure on @xmath62 for all @xmath258 , equation   gets the classical form , heuristically introduced in  , @xmath649 where @xmath650 is the variance of @xmath39",
    ".      we will now introduce the last tools to predict the different behaviors observed in figure  [ sim1 ] and in particular to characterize the diversification phenomenon of evolutionary branching .",
    "since it is not captured by the canonical equation , evolutionary branching can only occur on a longer time scale and in the neighborhood of equilibria of the canonical equation .",
    "let @xmath651 ( well - defined since @xmath3 is compact ) .",
    "we make the additional assumption _ [ c ] x^ * , _ _ -m(x^*,h)dh>0 _ _ + m(x^*,h)dh>0 . _",
    "this assumption means that mutations are always possible from @xmath625 .",
    "then in view of the canonical equation , @xmath652 , i.e.  @xmath625 is an evolutionary singularity .",
    "the linear stability condition for the equilibrium @xmath625 implies that @xmath653 differentiating twice the equation @xmath654 implies that @xmath655 and so @xmath656 we shall leave the degenerate case @xmath657 for further studies , and assume below that @xmath658    let us recall the definition of evolutionary branching introduced in @xcite .",
    "[ def : br ] fix @xmath659 and @xmath625 an evolutionary singularity . for all @xmath131",
    ", we say that there is @xmath450-branching at @xmath625 for the pes @xmath600 if    * there exists @xmath660 such that the support of the pes at time @xmath661 is composed of a single point belonging to @xmath662 $ ] ; * there exists @xmath663 such that the support of the pes at time @xmath664 is composed of exactly @xmath665 points separated by a distance of more than @xmath666 ; * between @xmath661 and @xmath664 , the support of the pes is always a subset of @xmath662 $ ] , and is always composed of at most @xmath665 traits , and has nondecreasing ( in time ) diameter .",
    "this definition only considers _ binary _ evolutionary branching .",
    "the next theorem proves that , in the neighborhood of an evolutionary singularity , evolutionary branching of a monomorphic population into a @xmath239-morphic population with @xmath667 is impossible ( at least when the trait space is one - dimensional ) . note that the notion of evolutionary branching requires the coexistence of two traits , but also that these two traits diverge from one another .",
    "[ thm : br ] assume  , , , , and  . assume also that @xmath668 and that the canonical equation  ( [ eq : can - eq ] ) with initial condition @xmath632 converges to an evolutionary singularity @xmath625 in the interior of @xmath3 .",
    "assume finally that @xmath625 satisfies  ( [ eq : hyp - evol - br ] ) and @xmath669 then , for all sufficiently small @xmath450 , there exists @xmath670 such that for all @xmath638 ,    : :    if @xmath671 ,    @xmath672 .",
    ": :    if @xmath673 ,    @xmath674 .    moreover ,    @xmath675 where    @xmath676    this criterion appeared for the first time in  ( * ? ? ?",
    "* section 3.2.5 ) with an heuristic justification .",
    "locally around @xmath625 , one of the two following events can occur almost surely : either there is binary evolutionary branching or not .",
    "coexistence can occur in both cases , but our proof shows that , after coexistence , the diameter of the support of the pes is a.s .",
    "non - decreasing ( resp .",
    "non - increasing ) in the first ( resp .",
    "second ) case .",
    "[ prop : coex ] it can be proved using proposition  [ prop : sign - fitn-2 ]  ( i ) that    * if @xmath677 , then for all neighborhood @xmath678 of @xmath625 in @xmath16 , there exist @xmath679 that coexist and * if @xmath680 , then there exists a neighborhood @xmath678 of @xmath625 in @xmath16 such that any @xmath679 do not coexist .    comparing this result with the criterion of theorem  [ thm : br ] ,",
    "one has of course that evolutionary branching implies coexistence , but the converse is not true .    as in  @xcite , the proof of theorem  [ thm : br ]",
    "is based on local expansions of the fitness functions @xmath681 and @xmath682 in the neighborhood of @xmath625 , given in our case in propositions  [ prop : sign - fitn-1 ] and  [ prop : sign - fitn-2 ] in the appendix .",
    "the main steps of the proof of theorem [ thm : br ] are given in appendix [ app : br ] .",
    "let us come back to the example developed in subsection  [ sec : example-1 ] .",
    "the death rate of an individual with trait @xmath15 has the form @xmath683 with @xmath73 .",
    "let us compute in this case the quantities we are interested in . by symmetry considerations",
    ", we have that @xmath684 is an evolutionary singularity .",
    "it then follows from  ( [ eq : eq - mono ] ) that @xmath685 and from  ( [ fitness ] ) that @xmath686 for symmetry reasons again , we also have @xmath687 , from which we deduce that @xmath688 differentiating twice the relation @xmath689 we obtain @xmath690 , which give @xmath691 .    therefore , the inequality @xmath692 is always satisfied , and there is evolutionary branching ( resp .  no evolutionary branching ) at @xmath684 if @xmath693 ( resp .",
    "@xmath694 ) . in the case",
    "where @xmath693 , the death rate does not increase too much as the trait @xmath15 deviates from @xmath0 .",
    "so the population is better off dividing into two specialized populations , each consuming better either resource @xmath6 or resource @xmath665 .",
    "in addition , since @xmath695 , coexistence is always possible in the neighborhood of @xmath684 .",
    "therefore , the simulations of figures  [ sim1 ] and  [ fig : sim - mut - rares ] are consistent with theorem  [ thm : br ] and proposition  [ prop : coex ] .",
    "this work benefited from the support of the anr manege ( anr-09-blan-0215 ) and from the chair `` modlisation mathmatique et biodiversit '' of veolia environnement - ecole polytechnique - musum national dhistoire naturelle - fondation x.",
    "we now give the general idea of the proof of theorem  [ thm : pes - fdd ] , extending the biological heuristics of  @xcite , rigorously proved in  @xcite in the case of lotka - volterra competition .",
    "let us roughly describe the successive steps of mutation , invasion and competition .",
    "the two steps of the invasion of a mutant in a given population are firstly the stabilization of the resident population before the mutation and secondly the invasion of the mutant population after the mutation .",
    "fix @xmath131 . in the first step , assuming that @xmath239 traits @xmath156 coexist , assumption @xmath696 and theorem [ thm : gd ] ensure that the population densities @xmath697 and the vector of resources @xmath698 belong to the @xmath450-neighborhood of @xmath699 with high probability for large @xmath7 until the next mutant @xmath242 appears .",
    "therefore , until @xmath700 , the population densities are roughly constant and the rate of mutation is approximated by @xmath701 .",
    "more precisely , the next lemma can be proved with the same arguments as in lemma  2  ( b ) and  ( c ) in  @xcite .",
    "[ lem : bef - mut ] let @xmath702 that coexist .",
    "there exists @xmath703 such that , if @xmath704 , then , for any @xmath705 , @xmath706 \\,,\\ , (      \\nu_t^{k } , \\mathbf{r}^k(t ) ) \\in b_{\\varepsilon}(\\mathbf{x})\\big)=1 ,      \\\\",
    "k\\mu_k t^k_{\\text{mut}}\\ \\overset{{\\cal l}}{\\underset{k\\rightarrow \\infty}{\\longrightarrow}}\\      \\mbox{\\textup{exp}}\\big(\\sum_{j=1}^n p(x_j)\\sum_{k=1}^r\\eta_k(x_j)\\bar r_k(\\mathbf{x})\\big )    \\end{gathered}\\ ] ] and @xmath707 for all @xmath411 , where @xmath708 stands for the convergence in distribution of real random variables and @xmath709 denotes the exponential distribution with parameter @xmath76 .",
    "in the second step , we divide the invasion of a given mutant trait @xmath242 into 2 phases shown in fig .",
    "[ fig : inv - fix ] .",
    "( 350,180)(-20,-10 ) ( 0,0)(1,0)320 ( 0,0)(0,1)150 ( -11,-12)0 ( -11,15)@xmath450 ( 0,18)(60,18 ) ( -24,97)@xmath710 ( -24,127)@xmath711 ( 0,100)(300,100 ) ( 0,130)(60,130 ) ( -20,156)population size ( 57,-12)@xmath661 ( 267,-12)@xmath664 ( 320,-12)@xmath26 ( 60,0)(60,130 ) ( 60,130)(100,125)(130,70 ) ( 130,70)(150,28)(200,18 ) ( 60,18)(105,26)(130,55 ) ( 130,55)(155,95)(200,100 ) ( 0,1)(3,6)(5,3)(8,4)(10,2)(12,6)(13,7)(15,4)(17,7)(20,3)(24,5)(26,4)(29,8)(33,6)(35,9)(38,4)(40,7)(43,6)(45,10)(47,8)(48,8)(50,12)(52,9)(55,13)(56,15)(57,14)(58,17)(59,15)(60,18)(61,19)(64,15)(66,16)(69,20)(71,20)(72,19)(75,23)(77,24)(80,28)(81,26)(83,29)(86,28)(88,29)(90,27)(91,24)(93,24)(95,27)(98,25)(100,29)(101,29)(103,28)(106,33)(107,31)(109,34)(110,34)(112,32)(113,36)(115,37)(118,40)(120,39)(123,44)(125,43)(126,46)(128,50)(129,49)(132,54)(134,54)(136,61)(138,59)(141,66)(143,68)(145,68)(148,75)(149,73)(151,79)(153,81)(154,84)(156,83)(158,89)(160,93)(161,92)(164,94)(166,95)(167,92)(170,97)(173,93)(175,95)(177,97)(181,93)(182,91)(184,96)(186,96)(189,98)(191,103)(193,104)(196,101)(199,103)(202,105)(203,102)(205,104)(208,101)(210,102)(213,99)(215,97)(217,98)(220,96)(222,101)(224,101)(226,99)(229,103)(231,104)(233,101)(236,102)(239,99)(240,97)(242,98)(244,98)(247,101)(249,99)(252,102)(254,102)(255,103)(257,101)(258,101)(261,98)(262,96)(264,99)(267,97)(270,102)(272,102)(273,104)(275,101)(278,100)(279,98)(281,99)(283,97)(288,102)(290,102 ) ( 255,115)@xmath712 ( 0,130)(3,126)(6,130)(8,132)(9,132)(11,134)(13,130)(15,128)(17,127)(20,133)(24,130)(26,132)(29,129)(30,131)(33,128)(35,129)(38,126)(40,131)(43,132)(45,129)(47,134)(48,133)(50,131)(52,132)(55,128)(56,130)(57,127)(58,125)(59,128)(60,129)(61,123)(64,125)(66,121)(69,124)(71,120)(72,119)(75,123)(77,123)(80,118)(81,119)(83,115)(84,116)(86,113)(88,115)(90,116)(91,113)(93,116)(95,115)(97,116)(98,112)(100,108)(101,106)(103,109)(106,106)(107,102)(109,103)(111,98)(113,100)(116,97)(118,94)(119,95)(121,88)(123,90)(124,86)(126,80)(128,82)(130,77)(131,71)(132,73)(135,66)(137,68)(139,62)(140,57)(141,58)(143,52)(145,54)(148,48)(149,48)(151,43)(153,42)(154,43)(156,39)(157,39)(159,32)(160,33)(162,28)(164,30)(166,25)(167,23)(170,26)(172,24)(174,23)(175,25)(177,24)(181,27)(182,26)(184,23)(186,24)(189,20)(191,22)(193,24)(194,21)(196,19)(198,20)(200,18)(202,15)(203,17)(205,20)(208,18)(210,21)(213,17)(215,14)(217,16)(220,12)(222,11)(224,13)(226,9)(227,10)(229,7)(231,5)(233,7)(234,5)(236,8)(239,6)(240,9)(242,10)(244,7)(247,10)(249,6)(250,7)(252,5)(254,8)(255,4)(257,6)(258,4)(261,2)(262,4)(264,3)(267,1)(269,2)(270,0 ) ( 205,32)@xmath713    the first phase stops either when the mutant population gets extinct or reaches a fixed small density @xmath131 ( at time @xmath661 in fig .",
    "[ fig : inv - fix ] ) . during all this phase ,",
    "the mutant density is small , and so , using the perturbed version of the large deviation result ( proposition  [ prop : fw ] ) , we can prove that the resident population stays close to its equilibrium density @xmath386 and the resource concentrations stay close to @xmath486 .",
    "therefore , similarly as in the proof of theorem  [ thm : gd]-(ii ) , the number of mutant individuals can be compared with branching processes with birth rate @xmath714 and death rate @xmath715 .",
    "the growth rate of this branching process is close to the fitness @xmath716 , which hence describes the ability of the initially rare mutant trait @xmath242 to invade the equilibrium resident population with traits @xmath156 . if this fitness is positive ( i.e.  if the branching processes are super - critical ) , the probability that the mutant population reaches density @xmath131 at some time @xmath661 is close to the probability that the branching process reaches @xmath717 , which is itself close to its survival probability , i.e. close to @xmath718_+/\\left(\\sum_k\\eta_k(y)\\bar r_k(\\mathbf{x})\\right))$ ] when @xmath7 is large .",
    "in addition , the comparison with branching processes shows that this first phase ends before a time of order @xmath719 similarly as in the proof of theorem  [ thm : gd]-(ii ) ( see the proof of lemma  3 in  @xcite ) , and so the assumption @xmath720 ensures that no new mutation occurs during this first phase with high probability .",
    "if the mutant population invades ( i.e. reaches the density @xmath450 ) , the second phase stops when the population densities and the resource concentrations reach @xmath721 , where @xmath722 , and when the traits @xmath1 such that @xmath723 go extinct in the population ( at time @xmath664 in fig .",
    "[ fig : inv - fix ] ) .",
    "theorem  [ thm : gd]-(i ) and-(ii ) ensure that this phase is completed with a probability converging to one after a time of order @xmath719 . note that assumption  ( [ b ] ) is required to be able to apply theorem  [ thm : gd]-(i ) for almost all mutant trait @xmath242 born in a population with traits @xmath156 .",
    "again , the assumption  ( [ eq : hyp - log - k ] ) ensures that no new mutation occurs during this second phase with high probability .",
    "these two phases are summarized in the following lemma , which can be proved as lemma  a.4 in  @xcite .",
    "[ lem : aft - mut ] let @xmath724 where @xmath156 coexist and @xmath242 is a mutant trait that satisfy assumption  .",
    "we shall denote @xmath725 and @xmath726 for convenience .",
    "we define @xmath727 assume that @xmath728 ( a single initial mutant ) .",
    "then , there exists @xmath729 such that for all @xmath705 and if @xmath730 , @xmath731_+}{\\sum_k \\eta_k(y)\\bar r_k(\\mathbf{x})},\\quad      \\lim_{k\\rightarrow+\\infty}{\\mathbb{p}}(\\tau^k_2<\\tau^k_1 )      = 1-\\frac{[f(y;\\mathbf{x})]_+}{\\sum_k \\eta_k(y)\\bar r_k(\\mathbf{x } ) } \\\\",
    "\\mbox{and}\\quad\\forall \\eta>0,\\quad      \\lim_{k\\rightarrow+\\infty}{\\mathbb{p}}\\left(\\tau^k_1\\wedge\\tau^k_2<\\frac{\\eta}{k        u_k}\\wedge t^k_\\text{mut}\\right)=1 .",
    "\\end{gathered}\\ ] ]    combining all the previous results , we can prove as in @xcite that for all @xmath132 , @xmath732 and @xmath733 measurable , @xmath734 where the event @xmath735 and @xmath736 is the pes defined in theorem  [ thm : pes - fdd ] .",
    "the proof ends as in @xcite .",
    "in the pes of theorem  [ thm : pes - fdd ] , the success of a mutant invasion is governed by the sign of its fitness .",
    "our goal in this section is to study the fitness of mutant traits in the neighborhood of coexisting traits .",
    "these results are used in section  [ sec : small - mut ] to study the local direction of evolution in the pes , and the phenomenon of evolutionary branching .",
    "we will assume in all what follows that the traits are one - dimensional , i.e.  @xmath737 .",
    "[ prop : sign - fitn-1 ] for all @xmath738 , we have for all @xmath190 , when @xmath739 and @xmath740 , @xmath741    using the relation @xmath742 , we have @xmath743 proposition  [ prop : sign - fitn-1 ] then easily follows from lemma  [ lem : bar - u - continue ] .    if we think of @xmath242 as a mutant trait born from the resident trait @xmath744 in the resident population of traits @xmath745 , this result gives the sign of the fitness function when mutations are small , i.e.  when @xmath746 small , except when the first - order term is zero .",
    "note that this first - order term is given by the derivative of the fitness function with respect to the first variable at @xmath747 : @xmath748 observe also that , for all @xmath190 , @xmath742 for all @xmath156 which coexist .",
    "hence , if @xmath749 is in @xmath238 , we have @xmath750    the differentiability of the fitness function at a point @xmath751 is ensured by lemma  [ lem : bar - u - continue ] .",
    "the following result shows that coexistence of @xmath423 traits @xmath752 with @xmath753 close to @xmath754 and @xmath242 close to one of the coordinates @xmath744 of @xmath755 is only possible if @xmath756 .",
    "[ cor : coex ] if @xmath754 and @xmath757 , then there exists a neighborhood @xmath758 of @xmath759 such that @xmath760 .",
    "assume that for all neighborhood @xmath758 of @xmath761 , @xmath762 .",
    "since @xmath763 is an open subset of @xmath408 , there exists @xmath753 close enough to @xmath755 and @xmath242 close enough to @xmath744 such that @xmath409 , @xmath412 , @xmath764 and , by proposition  [ prop : sign - fitn-1 ] , @xmath415 and @xmath765 . by theorem  [ equilibrium ] , this means that @xmath766 , which contradicts the fact that @xmath428 .    in the neighborhood of points @xmath754 such that @xmath767 , we have more precise results on the sign of the fitness .    [",
    "prop : sign - fitn-2 ] fix @xmath768 and @xmath190 such that @xmath769    : :    when @xmath770 and    @xmath740 ,    @xmath771    where @xmath772 ^ 2 } ,        \\end{gathered}\\ ] ] and for @xmath773 ,    @xmath774 ^ 2}.\\ ] ] : :    assume that for all neighborhood @xmath758 of    @xmath761 in @xmath775 ,    @xmath776 .",
    "then , when    @xmath777 and    @xmath740 such that    @xmath428 ,    @xmath778 : :    assume that for all neighborhood @xmath758 of    @xmath761 in @xmath775 ,    @xmath776 . then , when    @xmath777 ,    @xmath740 and @xmath779 ,    @xmath780    if one thinks of @xmath242 as a mutant born from trait @xmath413 in a coexisting population of traits @xmath753 , point  ( i ) allows to characterize the cases where @xmath428 thanks to proposition  [ prop : n - morph ] .",
    "point  ( ii ) shows that , in this case , the sum of the densities of traits @xmath242 and @xmath413 is close to @xmath781 .",
    "point  ( iii ) shows that if a second mutant @xmath782 is born from either @xmath242 or @xmath413 , then its fitness is positive or negative , depending on the sign of @xmath76 and on the position of @xmath782 with respect to @xmath413 and @xmath242 .",
    "if @xmath782 is a mutant trait born from another resident trait @xmath783 with @xmath773 , then the sign of the fitness function can be determined using proposition  [ prop : sign - fitn-1 ] and point  ( i ) of proposition  [ prop : sign - fitn-2 ] .    since @xmath784",
    ", we have @xmath785 and therefore @xmath786du \\\\    & \\qquad+(y - x_i)\\sum_{k=1}^r\\frac{g_k\\int_0 ^ 1[\\eta'_k(x_i+(y - x_i)u)-\\eta'_k(x^*_i)]du } { 1+\\sum_j\\eta_k(x_j)\\bar u_j(\\mathbf{x } ) } \\\\    & \\qquad+(y - x_i)\\sum_{k=1}^rg_k\\eta'_k(x^*_i ) \\left(\\frac{1}{1+\\sum_j\\eta_k(x_j)\\bar        u_j(\\mathbf{x})}-\\frac{1}{1+\\sum_j\\eta_k(x^*_j)\\bar        u_j(\\mathbf{x}^*)}\\right ) \\\\    & = -(y - x_i)(d''(x^*_i)+o(1))\\int_0 ^ 1(x_i+(y - x_i)u - x^*_i)du \\\\ & \\qquad + ( y - x_i)\\sum_{k=1}^r\\frac{g_k      ( \\eta''_k(x^*_i)+o(1))\\int_0 ^ 1(x_i+(y - x_i)u - x^*_i)du } { 1+\\sum_j\\eta_k(x^*_j)\\bar u_j(\\mathbf{x}^ * ) } \\\\ &    \\qquad+(y - x_i)\\sum_{k=1}^r\\frac{g_k\\eta'_k(x^*_i)}{(1+\\sum_j\\eta_k(x^*_j)\\bar u_j(x^*_j))^2}(\\mathbf{x}^*-\\mathbf{x})^ *    \\left(\\sum_{j=1}^n\\nabla(\\eta_k(x_j)\\bar u_j(\\mathbf{x}))(x^*)+o(1)\\right),\\end{aligned}\\ ] ] where the differentiability of @xmath787 comes from lemma  [ lem : bar - u - continue ] . point ( i )",
    "easily follows .",
    "point ( ii ) can be proved as follows .",
    "recall that , by lemma  [ lem : bar - u - continue ] , @xmath378 is a bounded function on @xmath788 .",
    "let @xmath789 be any accumulation point @xmath790 when @xmath777 and @xmath740 such that @xmath428 .",
    "after extracting a subsequence , we may also assume that for all @xmath773 , @xmath791 .",
    "passing to the limit in  ( [ eq : n - morph - eq ] ) , we get for all @xmath601 , @xmath792 by assumption , the unique solution of this system of equations is @xmath793 and the convergence follows .    point ( iii ) can be proved with a similar computation as for proposition  [ prop : sign - fitn-1 ] : using  ( [ eq : n - morph - eq ] ) and the fact that @xmath794 , we have @xmath795    then , using the relation @xmath796 we obtain @xmath797du \\\\ & \\qquad    + ( z - x_i)\\sum_{k=1}^r\\frac{g_k\\int_0 ^ 1[\\eta'_k(x_i+(z - x_i)u)-\\eta'_k(x_i+(y - x_i)u)]du }    { 1+\\sum_{j=1}^n\\eta_k(x_j)\\bar u_j\\mathbf{\\mathbf{x},y}+\\eta_k(y)\\bar u_{n+1}(\\mathbf{x},y ) } \\\\    & = -(z - x_i)(z - y)\\int_0 ^ 1 u\\int_0 ^ 1 d''(x_i+(y - x_i)u+(z - y)uv)dv\\:du \\\\ & \\qquad + ( z - x_i)(z - y)\\sum_{k=1}^r\\frac{g_k\\int_0 ^ 1      u\\int_0 ^ 1\\eta''_k(x_i+(y - x_i)u+(z - y)uv)dv\\:du } { 1+\\sum_{j=1}^n\\eta_k(x_j)\\bar u_j\\mathbf{\\mathbf{x},y}+\\eta_k(y)\\bar      u_{n+1}(\\mathbf{x},y)},\\end{aligned}\\ ] ] and the result follows from point  ( ii ) .",
    "we recall the main steps of the proof of the branching criterion in @xcite .    1 .",
    "before the first coexistence time , the support of the pes , given by the tss , reaches @xmath798 in finite time almost surely ( at time @xmath799 ) .",
    "2 .   after time @xmath799 , the ( support of the ) pes can not exit @xmath798 while being monomorphic .",
    "3 .   if @xmath673 , either there is never coexistence , and then the result is proved , or there is coexistence of two traits after a finite time , and then , if two traits @xmath800 ( say ) in @xmath798 coexist , 1 .   by proposition",
    "[ prop : sign - fitn-2 ]  ( iii ) , the only mutants traits @xmath782 that can invade the dimorphic population of traits @xmath15 and @xmath242 are such that @xmath801 ; 2 .",
    "the three traits @xmath15 , @xmath242 and @xmath782 can not coexist , and at least one of the resident traits @xmath15 and @xmath242 goes extinct , i.e. @xmath802 or @xmath803 . +",
    "this shows that , after any coexistence time , the distance between the two branches can only decrease , until one of the branches goes extinct .",
    "4 .   if @xmath671 , 1 .",
    "there is almost surely coexistence of two traits in finite time ; 2 .   by proposition  [ prop : sign - fitn-2 ]  ( iii ) , if two traits @xmath800 ( say ) in @xmath798 coexist , the only mutant traits @xmath782 that can invade the population of traits @xmath15 and @xmath242 are such that @xmath804 $ ] ; 3 .",
    "once such a mutant trait invades , @xmath15 , @xmath242 and @xmath782 can not coexist , and the intermediate trait only goes extinct , i.e. @xmath805 if @xmath806 , or @xmath807 if @xmath808 . +",
    "this shows that the two branches survive until one of them exits of @xmath798 , and the last point of the proof consists in proving that the distance between the two branches becomes bigger than @xmath666 in finite time almost surely .    the only steps that require a different proof from theorem  4.9 of  @xcite are steps  3.(b ) and 4.(c ) .",
    "indeed , in  @xcite , these steps were proved using general results on the long time behavior of 3-dimensional competitive lotka - volterra systems  @xcite . here",
    ", we do not have such general results , but we have theorem  [ equilibrium ] .",
    "let us assume that @xmath673 , and let @xmath809 coexist , i.e.  by corollary  [ cor : coex ] @xmath810 and @xmath811 .",
    "let also @xmath782 be a mutant trait in @xmath798 that can invade the resident population of traits @xmath15 and @xmath242 , i.e.  @xmath801 and @xmath812 by proposition  [ prop : sign - fitn-2 ]  ( iii ) .",
    "using the relation @xmath813 , we have @xmath814 since @xmath673 , this is positive if @xmath15 and @xmath242 are sufficiently close to @xmath625 .",
    "hence , since @xmath815 , we have @xmath816 , and thus @xmath817 .",
    "similarly , @xmath817 .",
    "in addition , by proposition  [ prop : sign - fitn-2 ]  ( iii ) , if @xmath15 and @xmath782 coexist ( i.e.  if @xmath818 ) , then @xmath819 and if @xmath242 and @xmath782 coexist ( i.e.  if @xmath820 ) , then @xmath821 . therefore , by the characterization of @xmath822 of theorem  [ equilibrium ] , if @xmath818 , then @xmath823 and if @xmath820 , then @xmath824 conversely , in the case when @xmath825 and @xmath826 , then by theorem  [ equilibrium ] again @xmath827 .    finally , we see that @xmath15 , @xmath242 and @xmath782 never coexist , and that at least one of the traits @xmath15 or @xmath242 goes extinct in @xmath822 . therefore , once two traits in @xmath798 coexist in the pes , then the next jump in the pes reaches a position where either only one trait survives in @xmath798 , or two traits survive in @xmath798 , closer to each other than before the jump.@xmath485      let us assume that @xmath671 , and let @xmath809 coexist , i.e.  by corollary  [ cor : coex ] @xmath810 and @xmath811 .",
    "let also @xmath782 be a mutant trait in @xmath798 that can invade the resident population of traits @xmath15 and @xmath242 , i.e.  @xmath828 and @xmath812 by proposition  [ prop : sign - fitn-2 ]  ( iii ) .",
    "let us assume for example that @xmath808 .",
    "then , it follows from  ( [ eq : pf - br ] ) that @xmath817 .",
    "similarly , since by assumption  ( [ eq : hyp - evol - br ] ) @xmath829 , @xmath830 for all @xmath15 and @xmath242 close enough to @xmath625 .",
    "therefore , @xmath811 implies that @xmath820 .",
    "hence @xmath242 and @xmath782 coexist and by proposition  [ prop : sign - fitn-2 ]  ( iii ) @xmath821 .",
    "all these conditions imply by theorem  [ equilibrium ] that @xmath824 similarly , if @xmath806 , then @xmath831 in all cases , @xmath15 , @xmath242 and @xmath782 can not coexist , and once two traits in @xmath798 coexist in the pes , then the next jump in the pes reaches a position where two traits survive , farther from each other than before the jump.@xmath485        barles g. , perthame , b. : concentrations and constrained hamilton - jacobi equations arising in adaptive dynamics , recent developments in nonlinear partial differential equations , 5768 , contemp .",
    ", 439 , amer .",
    "soc . , providence , ri , ( 2007 ) .",
    "metz j.a.j . ,",
    "geritz s.a.h . ,",
    "meszna g. , jacobs f.a.j .",
    ", van heerwaarden j.s . :",
    "adaptive dynamics , a geometrical study of the consequences of nearly faithful reproduction .",
    "stochastic and spatial structures of dynamical systems , 183231 ( s.j .",
    "van strien , s.m .",
    "verduyn lunel , editors ) .",
    "north holland , amsterdam , ( 1996 ) ."
  ],
  "abstract_text": [
    "<S> we are interested in modeling the darwinian evolution resulting from the interplay of phenotypic variation and natural selection through ecological interactions , in the specific scales of the biological framework of adaptive dynamics . </S>",
    "<S> adaptive dynamics so far has been put on a rigorous footing only for direct competition models ( lotka - volterra models ) involving a competition kernel which describes the competition pressure from one individual to another one . </S>",
    "<S> we extend this to a multi - resources chemostat model , where the competition between individuals results from the sharing of several resources which have their own dynamics . starting from a stochastic birth and death process model </S>",
    "<S> , we prove that , when advantageous mutations are rare , the population behaves on the mutational time scale as a jump process moving between equilibrium states ( the polymorphic evolution sequence of the adaptive dynamics literature ) . </S>",
    "<S> an essential technical ingredient is the study of the long time behavior of a chemostat multi - resources dynamical system . in the small mutational steps </S>",
    "<S> limit this process in turn gives rise to a differential equation in phenotype space called canonical equation of adaptive dynamics . from this canonical equation and still assuming small mutation steps , we prove a rigorous characterization of the evolutionary branching points .    _ msc 2000 subject classification : _ </S>",
    "<S> 92d25 , 60j80 , 37n25 , 92d15 , 60j75    _ key - words : _ mutation - selection individual - based model ; fitness of invasion ; adaptive dynamics ; long time behavior of dynamical systems ; polymorphic evolution sequence ; multi - resources chemostat systems ; evolutionary branching ; piecewise - deterministic markov processes . </S>"
  ]
}