{
  "article_text": [
    "the finite element ( fe ) method provides a powerful framework to discretize partial differential equations ( pdes ) and includes methods to prove the discrete models convergence , stability , and accuracy properties ( see e.g. @xcite ) . by offering flexibility in",
    "the choice of computational ( unstructured , h / p - adapted ) meshes ( cf .",
    "@xcite ) while providing an approximation of the continuous pdes with the required order of accuracy , fe discretizations are nowadays appreciated in all research areas that apply numerical modeling .",
    "discretization using finite element methods provides one important advantage over other methods : starting from a variational formulation the discretization follows simply by substituting the continuous by discrete function spaces ( galerkin methods ) while the differential operators remain unchanged .",
    "there exist a large variety of different suitable fe spaces to choose from .",
    "however , not all choices lead to well - behaving schemes . in particular mixed fe schemes suffer from this problem , where different variables of the pde system are represented by different fe spaces .",
    "in such schemes , certain combinations of fe spaces lead to instabilities that exhibit spurious modes , rendering the solutions useless , in particular when studying nonlinear phenomena . a famous example for an unstable scheme is given by an approximation of both velocity and height fields of the 1d shallow - water equations by piecewise linear functions ( cf .",
    "@xcite and sect .",
    "[ sec_standard ] ) , while it is well known that equal order fe pairs are always unstable @xcite .    in order to avoid unsuitable choices , the finite element exterior calculus ( feec )",
    "method @xcite provides means for choosing a suitable pair of fe spaces that is guaranteed to lead to a stable mixed discretization .",
    "in particular , feec puts geometrical constraints on the fe spaces such that geometric properties , like the helmholtz decomposition of vector - fields , are preserved in the discrete case . as a result",
    ", feec pairs of spaces always satisfy the inf - sup condition @xcite while combinations of fe spaces that are _ not _ stable are ruled out . for the above mentioned 1d wave equations , approximating the velocity with piecewise linear and the height field with piecewise constant spaces",
    "satisfies the requirements of feec and gives indeed a stable scheme ( cf .",
    "again @xcite and sect .",
    "[ sec_standard ] ) .    although providing a very general mathematical framework , naturally there are issues for which feec yields no satisfying answers .",
    "let us consider , for instance , problems in geophysical fluid dynamics ( gfd ) , in which an additional coriolis term in the equations considers effects caused by the earth s rotation @xcite . for an atmosphere in rest ,",
    "the coriolis force that depends on the velocity and the gradient of the pressure ( or height ) are in _",
    "geostrophic balance_. to maintain this balance in the discretization , the pressure ( or height ) field should be represented discretely at one order of consistency higher than that of the velocity field .",
    "unfortunately , this contradicts the requirement imposed by feec on this fe pair . in @xcite ,",
    "this issue could be resolved by applying a combination of fe and discontinuous galerkin ( dg ) spaces .",
    "moreover , in order to meet the regularity requirement of the chosen fe pairs , feec requires the pdes to be written in weak variational form , in which partial integration has been performed .",
    "as pointed out recently in @xcite , the conventional mixed ( weak ) form of the equations causes certain operators , such as the co - derivative , to be non - local ( global ) operators . as a consequence ,",
    "such feec methods are not locally volume preserving , which reduces the quality of the local representation of the quantities of interest ( cf .",
    "@xcite ) .    in this manuscript",
    "our main goal is to introduce a fe discretization framework that provides an alternative methodology to avoid mentioned unsuitable fe choices with gfd in mind .",
    "more specifically , we develop a framework that applies two feec pairs instead of one , therefore providing a larger variety of different combinations of fe spaces , in which both derivatives and co - derivatives are local operators .",
    "this framework is based on formulating the pdes in split form , as introduced in @xcite for the gfd equations .",
    "the split equations consist of a topological and metric part while employing straight and twisted differential forms to adequately model the physical quantities of interest .",
    "the fe discretization framework translates this geometrical structure from the continuous to similarly structured discrete equations ( cf .",
    "[ sec_structure_waveeq ] ) .",
    "our approach shares some basic ideas with other discretization techniques , in particular _",
    "mimetic discretizations _",
    "( see e.g. @xcite , and @xcite for a historical overview ) .",
    "there , the pdes are also formulated by differential forms and a clear distinction between purely topological and metric terms is achieved .",
    "applying algebraic topology as discrete counterpart to differential geometry , the discrete equations mimic the underlying geometrical structure and are therefore denoted as structure - preserving ( cf .",
    "similar ideas of distinguishing between metric - dependent and metric - free terms in a gfd related context can also be found in @xcite introducing feec discretizations of the nonlinear rotating shallow - water equations . in spite of these similarities ,",
    "none of the schemes associate a proper fe space to each variable , as suggested by our framework .    for the sake of a clear exposition , we focus on a simple example , the split 1d linear shallow - water set of equations . extending our framework to treat also more practically relevant equations , such as the nonlinear rotating shallow - water equations , is subject of ongoing and future work . by investigating structure - preserving methods that apply lowest order ( piecewise linear and constant ) fe spaces to keep computational costs low",
    ", we address the requirements of gfd in developing schemes that satisfy first principle conservation laws ( i.e mass and momentum conservation ) and that are suited for simulations with integration times in the order of years and longer .",
    "we structure the manuscript as follows . in sect .",
    "[ sec_structure_waveeq ] , we introduce the split set of 1d wave equations and motivate the use of the split form of equations as principle formulation for their discretization . recalling in sect .",
    "[ sec_standard ] two low - order mixed fe schemes , namely the unstable p1-p1 and the stable p1-p0 pairs , we introduce in sect .",
    "[ sec_split ] the new discretization framework , referred to as _ split fe method_. we suggest a solving algorithm and present the schemes discrete dispersion relations . comparing them if possible with the conventional mixed schemes , we perform in sect .",
    "[ sec_num_analysis ] numerical simulations to investigate conservation behavior , convergence rates , and accuracy of all schemes . finally in sect .",
    "[ sec_summary ] , we draw conclusions and provide an outlook for ongoing and future work .",
    "in order to convey the basic ideas to the reader most clearly and comprehensively , we develop our fe discretization framework on a simple example , the set of 1d wave equations . as the split form of the equations ( cf .",
    "@xcite ) is an essential ingredient of our approach , we first introduce the corresponding split 1d wave equations and compare them with conventional formulations .    [ [ a - hierarchical - structuring - of - the - wave - equation . ] ] a hierarchical structuring of the wave equation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    compared to conventional formulations , the linear split 1d wave equations arrange themselves in the following hierarchy of linear wave equations :    1 .",
    "* one * @xmath0-order equation : @xmath1 with phase velocity @xmath2 for wave frequency @xmath3 and wave number @xmath4 and with boundary condition ( bc ) @xmath5 ; 2 .   * two * @xmath6-order equations : @xmath7 with phase velocity @xmath8 and bcs @xmath9 ; 3 .   * two * @xmath6-order equations and * two * closure equations : @xmath10 with phase velocity @xmath8 and bcs @xmath11 ;    for a periodic domain @xmath12 $ ] .",
    "the smooth function @xmath13 denotes the height elevation over some background state @xmath14 and the smooth function @xmath15 denotes the velocity of some fluid parcel in direction of @xmath16 at time @xmath17 \\subset \\mathbbm r$ ] .",
    "@xmath18 is the gravitational acceleration . describing the momentum and height of a shallow water column , eqns",
    "are usually referred to as shallow - water equations . throughout this manuscript",
    "however , we will refer to the preceding formulations as wave equations .",
    "the splitting of eqns .   into topological (",
    "first line ) and metric parts ( second line ) is based on their formulation in terms of differential forms : @xmath19 denotes a time - dependent straight 1-form and @xmath20 a time - dependent straight 0-form ( straight function ) ",
    "straight forms do not change their signs when the orientation of the manifold changes ; @xmath21 denotes a time - dependent twisted 0-form and @xmath22 a time - dependent twisted 1-form  twisted forms compensate the change in signs which would result from a change in orientation .",
    "the latter property is shared by the twisted hodge - star operator @xmath23 ( resp .",
    "@xmath24 ) mapping from straight",
    "( resp . twisted ) @xmath4-forms to twisted ( resp .",
    "straight ) @xmath25-forms , here for @xmath26 as we are in one dimension .",
    "the index @xmath27 denotes the degree , and @xmath28 the space of all @xmath4-forms .",
    "the exterior derivative is defined as the map @xmath29 ( or @xmath30 for twisted forms , cf .",
    "diagram  ) .",
    "it reduces in one dimension to the total derivative of a smooth function @xmath31 , i.e. for @xmath32 .",
    "the map of @xmath33 on twisted forms is defined analogously .",
    "we refer the reader to sec .",
    "[ sec_varform_spliteq ] for an explicit representation of the split wave equations   in the local coordinate @xmath12 $ ] , and to @xcite for an elaborated discussion about straight and twisted forms , the twisted hodge - star operators , and the derivation of @xmath34-dimensional split equations of gfd .",
    "[ [ the - split - wave - equations ] ] the split wave equations : + + + + + + + + + + + + + + + + + + + + + + + + +    we argued in detail in @xcite why it is favorable to represent the equations of gfd in terms of differential forms rather than vector - calculus notation , and we discussed advantages of the split form in particular . here",
    ", the split representation of the wave equations fits naturally into the arrangement of wave equations presented above , in which the saddle point ( mixed ) form   results from a splitting of the standard form  , and the split form   from a further splitting of the saddle point form  .",
    "this somehow suggests to study in more detail possible benefits of a discretization based on the split form rather than on the mixed form , just as there exist cases in which discretizations based on eqns .",
    ", usually discretized by _ mixed _ fe methods , perform better than schemes resulting from _ standard _ fe approaches that rely on formulation  .",
    "let us first elaborate on the latter point , for which we present two examples where standard fe schemes even fail to provide correct solutions . as pointed out in @xcite , the standard fe solution to the vector poisson equation on non - convex polyhedral domains will converge to a false solution of the problem for almost all forcing functions @xmath35 .",
    "the same happens when calculating standard fe solutions for the vector laplacian on an annulus .",
    "however , correct solutions can be obtained when using mixed formulations , in particular those based on feec @xcite .",
    "in addition , mixed formulations , in which two or even more fe spaces are used to approximate separate variables , are well suited for saddle point problems .",
    "these arise , for instance , in constrained minimization problems ( stokes equations or darcy flow ) , in which the elimination of one of the variables is not possible ( cf .",
    "@xcite , chapter 36 ) . in this latter case ,",
    "equations in form   do even not exist .",
    "there are also some physical and numerical reasons in favor of mixed fe methods . according to @xcite ,",
    "it is the first - order system , such as eqns .  , that follows from physics ( i.e. from first conservation principles of mass and momentum ) and not the second - order equation , such as eqns .  .",
    "in particular , efficient numerical schemes can be derived more easily from the first - order system .    following in particular the latter line of argumentation",
    ", the split form more accurately models the physical properties than the first - order system , because system   provides for each variable the adequate ( straight or twisted ) differential form that suits in dimension and orientation the corresponding property of a real fluid ( cf .",
    "@xcite , section 7 ) .",
    "it seems appropriate during the discretization process to provide for each variable a suitable fe space too . as a proof of concept , one aim of this manuscript is to exploit this additional freedom in the choice of fe spaces and study , in terms of convergence , accuracy , stability and dispersion relation , possible advantages , but also drawbacks , that come along with this generalized fe method .",
    "more precisely , by using the split form of the equations , we approximate each variable by a fe space such that the discrete version of the exterior derivative @xmath33 satisfies the mappings @xmath36 and @xmath37 .",
    "@xmath38 , are fe spaces that approximate the corresponding continuous spaces . as pointed out later in more detail , this approach guarantees correct discrete topological equations up to projection error caused by projecting the continuous equations into the fe spaces .",
    "any additional errors are caused by the metric - dependent closure equations that are realized by nontrivial projections between straight and twisted spaces ( cf .",
    "[ sec_split ] ) .",
    "such a clear separation between projection and additional errors , the latter caused by partial integrations in the weak form , is not obvious in mixed fe methods .",
    "part of future work will be to study how these different error sources relate .",
    "$ ] by @xmath39 subintervals ( elements ) and @xmath39 independent nodes ; the former are denoted by @xmath40 , the latter by @xmath41 for @xmath42 .",
    "@xmath43 are the basis functions of @xmath44 and @xmath45 of @xmath46 ( cf .",
    "appendix  [ append_int_values ] for their definition ) . ]    in this section , we briefly review two examples of the general idea behind mixed fe methods and we introduce notations and definitions required for the remainder of the paper .",
    "first , we observe that there are two equations for two prognostic variables in equation  . in order to discretize them",
    "one has the choice of mixing the corresponding fe spaces , which gives rise to the naming convention .",
    "here we consider ( i ) similar @xmath47 or ( ii ) mixed fe spaces @xmath48 , where @xmath44 refers to a linear and @xmath46 to a constant fe space .    in more detail",
    ", we subdivide the domain @xmath49 $ ] into @xmath39 subintervals @xmath50 $ ] , for @xmath51 as shown in figure  [ fig_mesh ] .",
    "we denote the points @xmath52 as nodes @xmath41 and the subintervals as elements @xmath40 with centers @xmath53 and element sizes @xmath54 , for @xmath55 .",
    "basis functions and coefficients at nodes carry the subindices @xmath41 and @xmath56 and those at element centers the subindices @xmath40 and @xmath57 .",
    "to impose periodic boundary conditions , we identify the nodes at @xmath58 and at @xmath59 with each other and consider only 1 degree of freedom ( dof ) associated to this node .",
    "we have thus @xmath39 independent dof for both nodes and elements .    throughout this manuscript",
    "we will use the lagrange functions @xmath60 as basis for the piecewise linear fe space @xmath44 and the step functions @xmath61 as basis for the piecewise constant fe space @xmath46 ( cf .",
    "appendix  [ append_int_values ] for their definitions ) .      in order to find approximate solutions of the wave equations  ,",
    "we apply galerkin s method . to this end",
    ", we formulate the wave equations in variational form and approximate @xmath15 and @xmath13 by suitable discrete functions .",
    "being aware of the problems of spurious modes ( discussed below ) , we start with a naive choice of a pair of fe spaces approximating both @xmath15 and @xmath13 by piecewise linear ( p1 ) functions @xmath62 and @xmath63 .",
    "we refer to this scheme as _",
    "p1-p1 _ scheme .",
    "the discrete variational form of the wave equations is then given by : find @xmath64 , such that @xmath65 for any test function @xmath66 in the test space @xmath67 . expanding the variables in terms of the basis of the trial space @xmath44 , @xmath68 with time dependent coefficients @xmath69 and @xmath70 , and varying the test functions @xmath66 over the basis functions @xmath71 of the test space @xmath67",
    ", we obtain @xmath72    this discrete system can analogously be written in matrix - vector formulation . defining the coefficient vectors @xmath73 and @xmath74 , with subindex @xmath34 for nodes , we obtain the following linear system of algebraic equations : @xmath75",
    "in which @xmath76 is a @xmath77 mass - matrix with metric - dependent coefficient @xmath78 and @xmath79 a @xmath77 stiffness - matrix with metric - independent coefficients @xmath80 in appendix  [ append_int_values ] , we provide explicit representations of these matrices for the mesh of figure  [ fig_mesh ] subject to the periodic boundary condition .    [",
    "[ time - discretization . ] ] time discretization .",
    "+ + + + + + + + + + + + + + + + + + + +    to discretize the semi - discrete equations   in time , we use the crank - nicolson ( cn ) scheme , a symmetric , implicit time discretization method .",
    "then , for the time @xmath81 $ ] and a time step size of @xmath82 , the full discretized matrix - vector equations read @xmath83 we will solve these equations by fixed point iteration , even though they could be solved directly due to the linearity . the motivation for this inefficient algorithmic choice lies in future work on non - linear equations and the possibility to treat possible kernels for the discrete hodge - star operators in the split schemes ( cf .",
    "eqn .  ) . for more details on the solver",
    ", we refer to sect .",
    "[ sec_split_cn ] in which we introduce a corresponding algorithm for the split finite element schemes .",
    "the choice of using an iterative algorithm does not alter the results discussed in this paper .",
    "only the time step size has to be restricted , in spite of the unconditional stability of the cn scheme .",
    "similarly to the cfl number in explicit schemes , @xmath82 must not exceed a certain threshold @xmath84 in order to guarantee that even the fastest waves are sufficiently well resolved and that the iterative solver converges . defining the cfl number for the 1d wave equations by @xmath85 we restrict @xmath82 for a given @xmath86 such that @xmath84 is smaller that some constant .",
    "this constant , determined empirically for all test cases and mesh resolutions applied in this manuscript , is given for the unstable scheme by @xmath87 ( see sect .  [ sec_split_cn ] for more details ) .",
    "[ [ discussion - about - spacial - stability . ] ] discussion about spacial stability .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    throughout this paper , we study the stability properties of each discrete scheme by investigating whether it supports _ spurious modes_. such spurious modes are free modes , i.e. unphysical , very oscillatory small - scale waves on the grid scale that are not constrained by the discrete equations . in case of nonlinear equations ,",
    "these modes get coupled to the smooth solution and grow fast , making the scheme unusable .",
    "besides studying the inf - sup condition ( see , e.g. @xcite ) , one way of investigating the occurrence of such spurious modes is to determine the dispersion relation of the discrete scheme .    for the unstable p1-p1 fe scheme , we associate spurious modes with those modes that show zero group velocity @xmath3 , for some wave numbers @xmath4 .",
    "these modes are trapped to the grid scale and may lead to the just described instabilities .",
    "more precisely , the angular frequency @xmath88 satisfies the dispersion relation ( see appendix  [ app_disc_disp_rel ] ) @xmath89.\\ ] ] for small @xmath90 , the discrete dispersion relation converges to the continuous one @xmath91 .",
    "however , besides the correct zero frequency at @xmath92 , this dispersion relation has at the shortest wave length @xmath93 a second zero solution ( spurious mode ) with zero wave speed leading to an unphysical standing wave .",
    "the instability demonstrated in the previous subsection , caused by a choice of similar fe spaces for both variables , is a general feature of methods with same fe spaces for approximating @xmath94 and @xmath95 ( c.f .",
    "@xcite ) . to avoid this problem ,",
    "we present a stable mixed fe method using different fe spaces to approximate velocity and height .",
    "as proposed by other authors ( e.g.  @xcite ) , we approximate @xmath15 by the piecewise linear ( p1 ) function @xmath62 and @xmath13 by the piecewise constant ( p0 ) function @xmath96 and we apply galerkin s method to find these approximations . we refer to this scheme as _",
    "p1-p0 _ scheme .",
    "the formulation of the wave equations   in variational form implies multiplication of the momentum equation by a test function @xmath97 and of the continuity equation by a test function @xmath98 .",
    "because the derivative of @xmath99 is not well - defined globally , the corresponding term in the momentum equation requires integration by parts , whereas for the remaining terms trivial projections into the corresponding spaces are suitable .",
    "the discrete variational / weak form of the wave equations is thus given by : find @xmath100 , such that @xmath101 the momentum equation is given in _",
    "weak _ form , due to the integration by parts , while the continuity equations remains in variational form .",
    "the boundary terms from integration by parts in the weak momentum equation vanishe because of the periodic boundary condition and continuity conditions at cell interfaces .",
    "this special treatment is a source of additional error , while the trivially projected terms do not introduce further errors beyond those caused by the approximation of the initial conditions by the fe spaces @xcite .",
    "expanding the variables in terms of the corresponding bases yields @xmath102 substituting these expansions into equations   gives @xmath103    analogously to equation  ( [ equ_stnd_1 ] ) this discrete system can be written in matrix - vector formulation .",
    "for the coefficient vectors @xmath73 with subindex @xmath34 for nodes and @xmath104 with subindex @xmath105 for elements , we obtain the following linear system @xmath106 @xmath76 is the mass - matrix from above with metric - dependent coefficients  , @xmath107 is a @xmath77 mass - matrix with metric - dependent coefficients @xmath108 and @xmath109 and @xmath110 are @xmath77 stiffness - matrices .",
    "the metric - independent coefficients of @xmath110 are defined by @xmath111 and those of @xmath109 via the property @xmath112 , in which @xmath113 denotes the transpose of a matrix .",
    "we refer to appendix  [ append_int_values ] to see the full matrices for the example given in figure  [ fig_mesh ] .",
    "[ [ time - discretization.-1 ] ] time discretization .",
    "+ + + + + + + + + + + + + + + + + + + +    to discretize the semi - discrete equations   in time , we use the crank - nicolson scheme again . for the time",
    "@xmath81 $ ] and a time step size of @xmath82 , the fully discretized matrix - vector equations read @xmath114 we solve this implicit system of equations iteratively by fixed point iteration ( cf . sect .",
    "[ sec_split_cn ] for more details ) .    here , we restrict the time step size such that for all meshes and test cases studied the cfl number   satisfies @xmath115 .",
    "this is only half the value compared to the unstable p1-p1 scheme , since the lower order representation of the height field leads effectively to a coarsened spacial resolution .",
    "[ [ discussion - about - spacial - stability.-1 ] ] discussion about spacial stability .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we briefly discuss the stability of the method by studying it s discrete dispersion relation .",
    "as shown in appendix  [ app_disc_disp_rel ] , @xmath88 satisfies the dispersion relation @xmath116^{1/2 } \\ , .\\ ] ] we can directly deduce from this relation that the discrete wave speed @xmath117 converges to the analytical wave speed @xmath118 for small @xmath4 , i.e. for @xmath119 .",
    "in addition , this relation has only one root for @xmath3 at @xmath120 , while it shows a good approximation to the continuous dispersion relation at the shortest wave length @xmath93 , in contrast to the unstable p1-p1 scheme ( cf .",
    "[ fig_disp_relation ] ) .",
    "hence , this scheme exhibits no spurious modes and is therefore stable .",
    "in this section , we introduce a new finite element discretization method that uses the split formulation of the wave equations   ( cf .",
    "@xcite for a more general formulation of such split equations ) .",
    "it is referred to in the following as _ split finite element ( fe ) method_.    the split fe method is based on the following general ideas ; it    * discretizes the split form of the equations and keeps the splitting into topological and metric equations preserved during the discretization process ; * treats straight and twisted variables independently and provides for each of them suitable fe spaces such that the topological momentum and continuity equations can be written in variational form without partial integration ; * provides spaces such that the straight and twisted fe spaces form cohomology chains , in which @xmath121 maps between these spaces according to diagram   independently from each other ; * represents the metric closure equations ( hodge - star operators @xmath122 ) as projections between the straight and twisted fe spaces ( cf . diagram  )",
    "following these algorithmic ideas , the discretization of the topological equations is a trivial projection into the corresponding fe spaces with only the projection error occurring .",
    "additional errors are introduced by metric - dependent closure equations , in which the discretization of the continuous hodge - star operators is performed by non - trivial projections between straight and twisted spaces .",
    "starting from the split wave equations  , we seek a discretization by standard fe techniques .",
    "in particular , we want to apply galerkin s method , which implies to formulate the split wave equations in variational form .    employing the notation of differential forms",
    ", we notice that the time - dependent differential forms in can be represented in the local coordinate @xmath12 $ ] with time parameter @xmath81 $ ] . denoting with @xmath123 the dual basis to the tangential basis @xmath124",
    ", the 1-forms are given by @xmath125 and @xmath126 .",
    "the 0-forms can be written as @xmath127 and @xmath128 . to distinguish the coordinate functions from the respective forms , the former carry the notation @xmath129 .",
    "the exterior derivative @xmath130 and @xmath131 maps the corresponding 0-forms to the 1-forms @xmath132 and @xmath133 .",
    "furthermore , this coordinate representation allows us to describe the action of @xmath134 more precisely .",
    "it is defined via its action on the dual basis @xmath123 and the constant function @xmath135 describing the unit volume . in other words , denoting a choice of orientation as direct frame or and it s opposite orientation as skew frame -or , then @xmath134 maps the straight 1-form @xmath136 to the twisted 0-from @xmath137 or the straight function @xmath138 to the twisted 1-form @xmath139 . for both the straight and the twisted hodge - star operators a self - adjoint property holds ( e.g.  @xmath140 .",
    "@xcite for more details ) .    the idea behind the definition of twisted forms and the twisted hodge - star is to guarantee that the equations remain the same in both direct and skew frames .",
    "to enhance readability , we will therefore assume for the remainder of the manuscript to be in the direct frame or in which @xmath134 maps to the positive valued forms and skip an analogous derivation for the case of -or. however , we will keep the notation @xmath141 to distinguish between the various spaces . using this local representation , the metric closure equations in read : @xmath142  and   @xmath143 .",
    "[ [ split - variational - form - of - the - split-1d - wave - equations . ] ] split variational form of the split 1d wave equations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    using these local representations in and multiplying the resulting equations by a test function @xmath144 , we obtain the variational form for the topological equations : find @xmath145 such that @xmath146 subject to the variational metric equations @xmath147 the latter equations follow by multiplying the local representation of the metric equations in with the test functions @xmath148 that can be elements of either @xmath149 or @xmath150 .    having four equations for four unknowns ( the two straight and two twisted ones ) , the system is closed .",
    "we will refer to this set of equations as _ split variational form _ of the split 1d wave equations .",
    "to discretize the split variational form and with galerkin s method , we approximate the variables @xmath151 by suitable discrete @xmath4-forms @xmath152 , respectively . following the above general ideas of the split fe method , the discrete @xmath4-forms with their straight and twisted fe spaces that approximate the corresponding continuous spaces should satisfy the following diagram : @xmath153 for @xmath154 . in the following we will provide definitions for these spaces and mappings .    the preceding diagram is satisfied by the following set of fe spaces :    * @xmath155 and @xmath156 ; * @xmath157 ; * @xmath158 ;    with fe spaces @xmath44 and @xmath46 from sect .  [ sec_standard ] with piecewise linear basis @xmath60 and piecewise constant basis @xmath61 , respectively . choosing other , higher order fe spaces",
    "is also possible as long as the relationship between these spaces satisfy diagram  . for this manuscript",
    "however , we use the lowest order fe spaces possible . to establish time - dependent @xmath4-forms ,",
    "we proceed as above for the mixed fe methods",
    ".    approximating the continuous by discrete @xmath4-forms taken from the above fe spaces and substituting into and give the _ discrete split variational form _ of the split 1d wave equations : find @xmath159 such that @xmath160 for any test function @xmath161 of the test space @xmath162 subject to the discrete variational metric equations @xmath163 for any test function @xmath164 of the test space @xmath165 .",
    "are in fact trivial projections of the topological equations into the test space @xmath166 of piecewise constant test functions .",
    "the discrete exterior derivative @xmath33 is a surjective map from piecewise linear to piecewise constant functions and can be represented by the metric - free coincidence matrix @xmath110 ( see below ) .",
    "the discrete topological equations are therefore exact up to the errors that occur by the projections into the piecewise constant spaces .    eqns .   and",
    "are nontrivial galerkin projections between different spaces and provide approximations of the hodge - star operator . for solving the system , the discrete hodge - star operator ",
    "unlike @xmath33  has to be inverted , which requires special treatment in case @xmath167 has a non - trivial kernel ( cf .",
    "sect .  ) .",
    "consequently , the discrete metric closure equations introduce additional errors into the systems , similarly to those occurring by partial integrations when formulating the wave equations weakly .",
    "note that a projection of the topological equations into the twisted test space @xmath168 would result in the same variational form because all minus signs carried by the twisted forms would compensate .",
    "however , a projection into a combination of straight and twisted spaces is not allowed as it would change the sign of the original wave equations .",
    "this statement holds also for the projection of the metric equations .    in the next section",
    "we will derive suitable matrix - vector representations of the split schemes .",
    "following our ideas of treating topological and metric equations separately , let us first consider the discrete topological equations in sect .",
    "[ sec_disc_top ] and then the discrete metric equations in sect .",
    "[ sec_disc_metr ] that close the system of equations .",
    "we expand the four variables by means of the above introduced fe spaces :    * momentum pair ( straight forms ) :   @xmath169 ,   @xmath170 ; * continuity pair ( twisted forms ) : @xmath171 ,   @xmath172 ;    and substitute them into eqn .  .",
    "varying the test functions @xmath161 over the basis @xmath173 of @xmath166 , we obtain @xmath174    the preceding equations are similar in form to the second equation of .",
    "they can therefore be written in matrix - vector form analogously to the continuity equation in   by using the matrices @xmath107 with metric - dependent coefficients   and @xmath110 with metric - free coefficients  . defining the vector @xmath175 containing metric information of the mesh",
    ", we note that @xmath176 .",
    "the metric coefficients combined with the coefficients for velocity and height constitute the discrete 1-forms @xmath177 and @xmath178 that approximate the respective continuous 1-forms .",
    "the discrete topological ( metric - free ) equations then read @xmath179 using the following definitions :    * @xmath180 approximates the 1-form @xmath181 ; * @xmath182 approximates the 1-form @xmath22 ; * @xmath183 approximates the 0-form @xmath184 ; * @xmath185 approximates the 0-form @xmath186 .    because the stiffness matrix @xmath110 is a metric - free approximation of the exterior derivative @xmath33 applied in both straight and twisted sequences of fe spaces , the discrete topological momentum and continuity equations   provide metric - free approximations of the corresponding continuous topological equations in .      for the given choice of fe spaces",
    ", there exist * four * realizations of the discrete metric equations and .",
    "we will classify these realizations into three groups depending on how accurately they approximate the continuous metric closure equations : ( i ) _ high accuracy closure _ using the pair @xmath187 , ( ii ) _ low accuracy closure _ using the pair @xmath188 , and ( iii ) _ medium accuracy closure _ using either @xmath189 or @xmath190 .",
    "as the discrete hodge - star operators are realized by nontrivial galerkin projections ( gp ) onto either the piecewise constant ( @xmath191 ) or piecewise linear ( @xmath192 ) space , we denote these schemes also by : ( i ) @xmath193 , ( ii ) @xmath194 , and ( iii ) @xmath195 or @xmath196 , respectively , in analogy to the conventional notation for mixed p1-p1 and p1-p0 schemes .",
    "[ [ high - accuracy - closure - colorblackrm - gp1_ucolorblack - colorblackrm - gp1_hcolorblack . ] ] high accuracy closure ( @xmath193 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the most accurate approximation of the metric closure equations and is achieved by using the discrete hodge - stars @xmath197 and @xmath198 , respectively .",
    "hence , @xmath199    to write equations   in matrix - vector form , we note that the terms on the left hand side are simply the metric - dependent coefficients   of @xmath76 , while those on the right form the @xmath77 mass - matrix @xmath200 with metric - dependent coefficients @xmath201 this matrix can equivalently be written as @xmath202 , where @xmath203 is a metric - free @xmath77 matrix representing a projection operator @xmath204 and @xmath205 .",
    "the explicit representation of this projection corresponds to determining node values from averaging the neighboring area - weighted cell values ( cf .",
    "appendix  [ append_int_values ] ) .",
    "we obtain the metric - dependent equations @xmath206 in which we have combined the elements of @xmath207 describing the area weights of each element with the coefficients for velocity and height to the discrete 1-forms @xmath208 and @xmath178 , respectively .",
    "[ [ low - accuracy - closure - colorblackrm - gp0_ucolorblack - colorblackrm - gp0_h - colorblack . ] ] low accuracy closure ( @xmath194 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the most inaccurate approximation of the metric closure equations results from using the discrete metric operators @xmath209 and @xmath210 , respectively , for and : @xmath211 in terms of matrix - vector formulation , these discrete metric - dependent equations read @xmath212 in which the metric - dependent @xmath77 mass - matrix @xmath213 can be easily computed by @xmath214 . for the terms on the right hand side , we exploit the fact that @xmath215 , which again allows us to combine the area weights of @xmath207 with the corresponding coefficients for velocity or height to the 1-forms @xmath208 resp .",
    "@xmath216 for each element .",
    "[ [ medium - accuracy - closure - colorblackrm - gp1_ucolorblack - colorblackrm - gp0_h - colorblackcolorblackrm - gp0_ucolorblack - colorblackrm - gp1_hcolorblack . ] ] medium accuracy closure ( @xmath217 ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    an approximation to the metric closure equations at an intermediate accuracy results from applying the approximations @xmath197 and @xmath210 to and , respectively : @xmath218 using the matrices defined above , these discrete metric - dependent equations in matrix - vector formulation read @xmath219    a similarly accurate approximation of the metric closure equations follows from applying the approximations @xmath209 and @xmath198 to and , respectively : @xmath220 or in matrix - vector form : @xmath221    equations  , , and / provide discrete metric - dependent approximations to the metric equations in . more precisely",
    ", we can determine the discrete hodge - star operator with respect to the two possible accuracy levels by @xmath222 which allows us to write diagram   in terms of matrix - vector formulation as @xmath223 using the matrix representations of @xmath224 .",
    "together with each of these realizations of the metric equations forms a closed system of semi - discrete matrix - vector equations that approximate the split wave equations . in the next section",
    ", we will discuss the time - discretization of these equations and introduce a solution method for these systems of algebraic equations .",
    "as for the mixed fe schemes , we use the symmetric , implicit crank - nicolson time discretization . for a time",
    "@xmath81 $ ] with time step size @xmath82 , each fully discretized split fe scheme reads @xmath225 subject to one of the projection pairs , / , or . these metric equations do not depend on time , hence they need no special time discretization . for better readability , we skipped the subindices @xmath226 .",
    "[ [ solving - algorithm . ] ] solving algorithm .",
    "+ + + + + + + + + + + + + + + + + +    the algorithm to solve the implicit equations is given by the _",
    "fixed point iteration _ :    1 .",
    "start loop over @xmath4 with initial guess ( @xmath120 ) from values of previous timestep @xmath227 : @xmath228 and @xmath229 ; 2 .",
    "project @xmath230 onto @xmath231 by @xmath232 for the appropriate test space @xmath233 ; 3 .",
    "calculate height @xmath234 : @xmath235 4 .",
    "project @xmath234 onto @xmath236 by @xmath237 for the appropriate test space @xmath233 ; 5 .",
    "calculate velocity @xmath238 : @xmath239 6 .",
    "set @xmath240 and stop loop over @xmath4 if @xmath241 for a small positive @xmath242 . set @xmath240 and stop loop over @xmath4 if @xmath243 for a small positive @xmath242 .",
    "please note that in case of convergence , i.e. @xmath244 and @xmath245 , this algorithm indeed solves equations  .",
    "note that @xmath238 could also be computed before @xmath234 . as described in sect .",
    ", we have to restrict the time step size to guarantee that the fastest waves are well resolved and that the iterative solver converges .",
    "the corresponding cfl numbers , given by eqn .  , are determined numerically for all meshes and test cases studied .",
    "we use    * @xmath246 for the split @xmath247 scheme ; * @xmath248 for the the split @xmath249 schemes ( similar to the mixed p1-p0 scheme ) ; * @xmath250 for the @xmath251 scheme .    note that in case of the @xmath251 scheme the cfl condition scales with the grid resolution ( see explanation below ) .",
    "[ [ treatment - of - possible - non - trivial - kernels - of - the - discrete - hodge - stars . ] ] treatment of possible non - trivial kernels of the discrete hodge - stars .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    within each time step of the fixed point iteration algorithm , we compute an increment to the time update of @xmath208 and map it to @xmath252 in order to compute an increment to the time update of @xmath178 ; then we map the latter to @xmath253 to determine the next more accurate increment to @xmath208 , until the required accuracy is achieved .",
    "this procedure corresponds to the mappings in diagram  , where the directions of mappings are indicated correctly by the arrows , except for the mappings between height fields .",
    "as indicated in step 4 ) of the algorithm above , the inverse @xmath254 is required to map @xmath178 to @xmath253 .",
    "moreover , since we want to study all possible combinations of metric closure equations , we have to invert all matrices present in .",
    "in general it is not clear if the inverse matrices exist nor if they are computable , and their general treatment is an object of current research but not in the scope of this manuscript . here",
    ", we only consider the periodic 1d mesh of fig .",
    "[ fig_mesh ] with @xmath39 elements . in this case",
    "@xmath76 has full rank and is always invertible . in case @xmath39",
    "is odd , also @xmath203 and @xmath213 have full rank and are invertible , which allows us to calculate @xmath232 and @xmath167 and their inverse for the different levels of accuracy .",
    "however , in case @xmath39 is even , @xmath203 and @xmath213 have one - dimensional kernels ( null - vectors ) .    in order to fix this deficiency for even @xmath39 , we consider the map @xmath255 with null - vector @xmath256 of length @xmath39",
    ". then we solve the augmented problem : given @xmath257 , find @xmath258 such that @xmath259 analogously , we treat all other cases in which we have to use the inverse of a matrix that has a non - trivial kernel .    for the projection",
    "steps 2 ) and 4 ) of the algorithm , we can choose different spaces .",
    "in the following paragraph and in sect .",
    "[ sec_num_analysis ] , we will study how this choice influences the performance of the resulting numerical scheme , in particular regarding it s accuracy , stability , and convergence properties .",
    "analogously to the mixed fe cases , we study the stability properties of the split fe schemes by investigating the discrete dispersion relations . in particular , we investigate the impact of the choice of projection accuracy of the metric closure equations and on the dispersion relations .",
    "we present the results of an analytic derivation of the discrete dispersion relations for each scheme ( for details see appendix  [ app_disc_disp_rel ] ) .    for the split @xmath247 scheme , consisting of the topological momentum and continuity equations   and the metric closure equations , the angular frequency @xmath260 ( the subscripts will indicate the order of the hodge - star operators , in this case @xmath197 and @xmath198 ) satisfies the discrete dispersion relation @xmath261 one realizes that @xmath91 for @xmath262 .",
    "this can be seen by expanding @xmath263 in a taylor series around zero .",
    "because of the double angle formula ( i.e. @xmath264 ) , this dispersion relation equals the one in eqn .   for the p1-p1 scheme ; hence , it has a zero solution at @xmath265 ( cf .",
    "[ fig_disp_relation ] ) and it is therefore unstable .    for the split @xmath266 and @xmath267 schemes which consist of the topological momentum and continuity equations   and metric closure equations or ,",
    "the discrete dispersion relation for the angular frequency @xmath268 for both combinations of metric closure equations reads @xmath269^{\\frac{1}{2}},\\ ] ] with @xmath91 for @xmath262 .",
    "the preceding equation provides exactly the same dispersion relation as in eqn .   for the stable p1-p0 fe scheme .",
    "hence , both intermediate accuracy split schemes are stable as they expose no spurious mode at @xmath265 .    for the split @xmath251 scheme , which consists of the topological momentum and continuity equations   and metric closure equations",
    ", the angular frequency @xmath270 satisfies the discrete dispersion relation @xmath271 with @xmath91 for @xmath262 .",
    "this dispersion relation has no second root .",
    "however , with increasing @xmath4 the wave speeds exceed the analytical solution significantly and grow infinitely for the smallest wave @xmath265 .",
    "we identify these fast traveling small scale waves as spurious modes , since they cause small scale noise on the entire mesh after some short simulation time .",
    "in fact , the occurrence of these spurious modes are the reason why the cfl number @xmath250 of the iterative solver ( cf .",
    "[ sec_split_cn ] ) is very small and even decreases proportionally to the element size of the mesh . with @xmath272 and considering the short wave @xmath273",
    "we have that @xmath274 and hence the discrete wave speed @xmath275 in .",
    "so , with increasing mesh resolution the wave speed increases and the cfl condition becomes more restrictive .",
    "the suggested @xmath250 for the split @xmath251 scheme provides an upper bound for the cfl number and assures convergence of the iterative solver for all meshes used and all test cases studied .",
    "[ fig_disp_relation ] shows the dispersion relations plotted for the three different choices of hodge - star projections : in green the high accuracy ( split @xmath247 ) , in blue the intermediate accuracy ( split @xmath266/@xmath267 ) , and in red the low accuracy ( split @xmath251 ) scheme , while the analytic dispersion relation is shown in black .",
    ", @xmath276 in green for the hodge - star pair @xmath187 , @xmath277 in blue for @xmath189 or @xmath278 ) , and @xmath279 in red for @xmath280 ) . ]",
    "the objective of this section is threefold .",
    "first , we study if the mixed and split fe discrete schemes are structure - preserving in the sense that they preserve the first principles of mass and momentum conservation .",
    "second , we study the convergence behavior with respect to analytical solutions of the 1d wave equations .",
    "third , we investigate if the schemes represent the corresponding discrete dispersion relations correctly .",
    "as discussed in sections [ sec_standard ] and [ sec_discuss_stability ] , the discrete dispersion relations differ from the analytical ones , in particular for small wave numbers . in order to avoid these error sources",
    "when investigating the convergence properties , we perform simulations with a single sine wave ( corresponding to wave number @xmath281 ) in test case ( tc ) 1 .",
    "limiting the convergence tests to long waves will keep the errors introduced by the discrete dispersion relation small .",
    "this will allow us to test convergence of the schemes for integration times up to 5 cycles , despite of the influence of the wave dispersion on the shape of the wave package .    in a second test case ( tc 2 ) , we use a gauss distribution function with intermediate width , which consists of a superposition of all possible wave numbers . here",
    ", the errors in the discrete dispersion relations will lead to a separation of the gauss wave package into its single wave components .",
    "as this effect grows in time , we will study the convergence properties of the schemes only for short integration times ( less than 1 cycle ) .",
    "finally in tc 3 , we use the gauss distribution function with very small width such that the high frequency waves have large magnitude .",
    "this allows us to study the dispersion behavior of each scheme numerically and to compare it with the analytic results of sect .",
    "[ sec_discuss_stability ] .",
    "[ [ test - cases - and - initialization . ] ] test cases and initialization .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for all numerical simulations , we use a uniform mesh with periodic boundaries , as shown in fig .",
    "[ fig_mesh ] , for a domain of length @xmath282 m .",
    "simulation times are measured in full periods ( cycles ) with time @xmath283 for 1 cycle , with respect to the wave speed @xmath8 . to keep the temporal error for all mesh resolutions in the same order , we use in all simulations the same fixed time step size of @xmath284s for the high and medium accuracy , and @xmath285s for the low accuracy schemes .",
    "these values follow from the cfl number presented in sect .   and from the grid spacing of the",
    "highest resolved mesh applied .",
    "we use the following analytical solutions of the 1d wave equations with @xmath12 $ ] and @xmath286 as initializations at time @xmath287 and to determine the convergence rates :    analytical solution for tc 1 ; _ single sine wave _ : @xmath288 with parameters : @xmath8 , @xmath289 m , @xmath290 , and gravitational acceleration @xmath291 .    analytical solution for tc 2/tc 3 ; _ gauss distribution with intermediate / small width _ : @xmath292 with parameters : @xmath293 , @xmath294 . for tc 3 , we use the preceding analytical solution with very small width by setting @xmath295 .",
    "a direct calculation shows that both analytical expressions are indeed solutions of the 1d wave equations   or . to initialize the discrete schemes",
    ", we project the functions @xmath296 and @xmath297 onto either the piecewise constant or piecewise linear fe spaces ( analogously to sect .",
    "[ sec_standard ] and [ sec_split ] ) .",
    "[ [ structure - preserving - nature - of - the - split - schemes . ] ] structure - preserving nature of the split schemes .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as shown in sect .",
    "[ sec_splitfe_derivate ] , the split fe schemes are structure - preserving in the sense that the corresponding discrete sets of equations preserve the splitting into topological and metric parts . here ,",
    "we illustrate that these discrete equations also fulfill the first principles of mass and momentum conservation .    in the continuous case with solutions of the wave equations for velocity @xmath15 and height @xmath13",
    ", we define the mass @xmath298 of the water column and it s momentum @xmath299 by @xmath300 in fact , the first principles of mass and momentum conservation allow for the derivation of momentum and continuity equations ( see e.g.  @xcite ) . therefore , we require our structure preserving schemes to conserve these principles discretely . in fig .",
    "[ fig_conserve ] , we present relative errors for mass and momentum with respect to the corresponding initial values for all schemes .",
    "the results are determined using tc 2 for an integration time of @xmath301 on a mesh with @xmath302 elements for the time step sizes mentioned above . for other mesh resolutions and time step sizes ,",
    "these values remain conserved at the same order of accuracy . more precisely , all schemes expose a mass conservation error ( left block ) at the order of @xmath303 with the unstable p1-p1 fe scheme being the only exception with an error of approx . @xmath304 .",
    "the error in the momentum ( right block ) is of the order of @xmath303 for all schemes .",
    "[ cols=\"^,^ \" , ]     [ [ results - of - tc-3 ] ] results of tc 3 + + + + + + + + + + + + + + +    applying the gauss distribution   with very small width ( tc 3 ) , we illustrate the schemes representation of waves and their dispersions . to this end , we let the simulations run up to @xmath305 and study how the gauss - shaped wave packages change their forms during simulations .",
    "these changes are a consequence of the different discrete dispersion relations for the schemes studied in this manuscript .",
    "note that the short simulation time is justified by the design of tc 3 such that the numerical behavior in the short wave regime ( right side in figure [ fig_disp_relation ] ) is exposed .",
    "considering first the unstable mixed p1-p1 and split @xmath247 schemes in figure  [ fig_disprel_spltv0h0 ] , we notice that the piecewise linear solutions of both mixed and split schemes are very similar . at time @xmath305 , the left wave package travels to the left , the right one to the right . the front position on both sides",
    "agree well with the analytical solution and there are no forerunning fast waves .",
    "however , trailing oscillations develop , which change the shape of the gauss - distribution , rendering it lower and wider .",
    "small scale oscillations occupy the entire region between the two fronts .    as predicted by the discrete dispersion relation   ( or by ) , the wave with shortest wave length @xmath93 has zero phase speed .",
    "this spurious mode that is not transported away from the center of the domain but oscillates on the grid scale level , is visible in figure  [ fig_disprel_spltv0h0 ] .",
    "in general , as derived theoretically , our simulations show that the phase speeds of all waves are bounded from above by @xmath306 , and with increasing wave numbers @xmath4 , the wave speeds get slower and slower up to the shortest wave with zero phase speed ( cf . fig .",
    "[ fig_disp_relation ] ) .",
    "looking at the split @xmath251 scheme , the wave packages show a similar general behavior as in the previous case .",
    "however , the differing discrete dispersion relation   leads to differently deformed gauss - shaped wave packages compared to the previous unstable schemes ( shown in figure  [ fig_disprel_spltv1h1 ] ) . as above ,",
    "the peaks become smaller and wider . however , in the @xmath251 scheme the central part between the packages is free from high frequency modes , which indicates that the scheme does not support a standing spurious mode . on the other hand the high frequency spurious waves occur outside the central part , hence the scheme supports a fast traveling spurious mode .",
    "in fact , all waves travel with speeds equal to or larger than @xmath118 , the analytically correct wave speed , and increase with wave number @xmath4 up to very large wave speeds .",
    "this is why we find waves occupying the entire outer region , and why our time step size is so much smaller when compared to the other schemes ( cf .",
    "[ sec_discuss_stability ] ) .",
    "this observation agrees very well with the discrete dispersion relation for the split @xmath251 scheme shown in fig .",
    "[ fig_disp_relation ] .",
    "let us finally study simulations of tc 3 performed with the mixed p1-p0 , the split @xmath266 , and the split @xmath267 schemes .",
    "first of all we note that the solutions of the p1-p0 and of both split schemes agree very well .",
    "this can be inferred from figures  [ fig_disprel_spltv1h0 ] and [ fig_disprel_spltv0h1 ] , in which the solutions of the p1-p0 scheme ( green lines ) and those of the split schemes ( blue and red lines ) show only tiny differences .",
    "again , propagation directions are correct , while the peaks become smaller and wider . in between the peaks ,",
    "no high frequency waves occupy the central region , similarly to the split @xmath251 scheme .",
    "in contrast to the latter however , the high frequency waves do not occupy the entire outer region but only some parts directly in front of the traveling wave packages ( cf",
    ". figures  [ fig_disprel_spltv1h0 ] and [ fig_disprel_spltv0h1 ] ) .",
    "this reflects very well the theoretical findings described by the discrete dispersion relation  , which states that all waves travel equal to , or faster then @xmath118 , but not faster than about @xmath307 ( cf .",
    "[ fig_disp_relation ] ) .",
    "ccc    13afig_disprel_h_gpu1gph1zoom.pdf ( 40.2,27.8 ) schemes on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    14afig_disprel_u_gpu1gph1zoom.pdf ( 34.2,7.2 ) schemes on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    ccc    15afig_disprel_h_gpu0gph0zoom.pdf ( 33,26.2 ) scheme on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    16afig_disprel_u_gpu0gph0zoom.pdf ( 9.9,6.3 ) scheme on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    ccc    17afig_disprel_h_gpu1gph0zoom.pdf ( 33,26.2 ) schemes on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    18afig_disprel_u_gpu1gph0zoom.pdf ( 14.2,6.6 ) schemes on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    ccc    19afig_disprel_h_gpu0gph1zoom.pdf ( 33,26.2 ) schemes on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]    20afig_disprel_u_gpu0gph1zoom.pdf ( 14.2,6.6 ) schemes on gauss - shaped height and velocity peaks after a simulation time of @xmath308.,title=\"fig : \" ]",
    "we developed a new finite element ( fe ) discretization framework based on the split 1d wave equations   with the long term objective to apply this framework to derive structure - preserving discretizations for geophysical fluid dynamics ( gfd ) @xcite .",
    "the splitting of these covariant equations into topological momentum / continuity equations and metric - dependent closure equations relies on the introduction of additional differential forms ( df ) .",
    "these establish pairs with the original dfs , which are connected by the hodge - star operator . by providing proper fe spaces for all dfs such that the differential operators ( here gradient and divergence ) hold in strong form",
    ", our split fe framework provides discretizations that preserve geometrical structure .",
    "in particular , the discrete momentum and continuity equations are metric - free and hold in strong form ( no partial integration is required ) .",
    "they are therefore exact up to the errors introduced by the trivial projections into the correspond fe spaces .",
    "additional errors are however introduced by the discrete metric - dependent closure equations that provide approximations to the hodge - star operator by nontrivial galerkin projections ( gp ) .",
    "requirements from structure preservation together with our objective to develop a lowest - order scheme for the split 1d wave equations impose certain conditions on the choice of fe spaces that approximate the corresponding dfs . in detail , both topological equations are projected onto piecewise constant spaces , whereas each of the two metric equations is projected onto both piecewise constant _ and _ piecewise linear spaces .",
    "although this gives four possible realizations , we find in principle three classes of schemes : a _ high accuracy scheme _",
    "( @xmath309 ) , in which the galerkin projections map onto piecewise linear ( gp1 ) spaces , a _ low accuracy scheme _ ( @xmath310 ) , in which the galerkin projections map onto piecewise constant ( gpo ) spaces , and two _ medium accuracy schemes _ ( @xmath311 ) , in which one galerkin projection maps onto piecewise linear , the other to piecewise constant space .    a comparison to conventional methods , the unstable p1-p1 scheme that applies piecewise linear ( p1 ) spaces to approximate both velocity and height fields , and the stable p1-p0 scheme that approximates the velocity by a piecewise linear and the height by a piecewise constant ( p0 ) field , was performed with respect to conservation of mass and momentum , dispersion relation , and convergence behavior .",
    "analytical derivations showed that the discrete dispersion relations of the unstable p1-p1 and @xmath309 schemes as well as of the stable p1-p0 and both @xmath311 schemes coincide , in spite of the differences in how they are derived .",
    "in particular , the @xmath309 scheme and the p1-p1 scheme share the problem of permitting spurious modes , whereas the stable p1-p0 scheme and the two @xmath311 schemes are free of such modes .",
    "the piecewise linear fields of p1-p1 and @xmath309 schemes show more or less the same convergence rates of second order . applying four instead of only two fe spaces",
    ", we illustrated that the piecewise constant fields , present only in the split schemes , showed the expected first order convergence rate .",
    "similarly , the corresponding fields of the p1-p0 and both @xmath311 schemes agree in their convergence behavior . both piecewise constant height fields show first order and both piecewise linear velocity fields second order convergence rates . utilizing a piecewise linear approximation to the height field ,",
    "the split @xmath311 schemes give for both velocity _ and _ height fields second order convergence rates .",
    "this combination of projections can therefore be interpreted as stable version of the conventional unstable p1-p1 scheme .",
    "we further verified the structure - preserving nature of the split schemes fulfilling the first principles of mass and momentum conservation discretely . in more detail ,",
    "the corresponding relative errors show fluctuations on the order of about @xmath303 without indicating a trend .",
    "when compared to the conventional schemes , this conservation behavior is only shared by the stable p1-p0 scheme , whereas the unstable p1-p1 scheme shows a tendency to lose mass , for the given simulation time on the order of @xmath304 .",
    "besides the @xmath309 and @xmath311 schemes that have a counterpart with the @xmath312 and @xmath313 schemes in literature , we found a split @xmath310 scheme , for which we are not aware of a corresponding standard formulation .",
    "this low accuracy scheme preserves the first principles of mass and momentum conservation in the same way as the other split schemes .",
    "however , it does not provide a very accurate approximation to the dispersion relation , exposing very fast traveling short waves .",
    "despite of the latter drawback , the finding of this new scheme illustrates the general character of our split fe discretization framework . by allowing a larger variety of combinations of different fe spaces compared to conventional mixed fe methods , this framework provides a toolbox to find and study new combinations of finite element spaces . in this vein , it is subject to current and future work to investigate various low- and higher - order fe space combinations to find new structure - preserving discretizations of the nonlinear rotating shallow - water equations , and of the equations of gfd in general .",
    "this project has received funding from the european union s horizon 2020 research and innovation programme under the marie skodowska - curie grant agreement no 657016 .",
    "additionally , the second author acknowledges support by the dfg excellence cluster clisap .",
    "here , we explicitly represent the mass and stiffness matrices used in sect .",
    "[ sec_standard ] and sect .",
    "[ sec_split ] .",
    "in particular , we show the coefficients which follow by evaluating the integrals of the variational formulations . imposing periodic boundary conditions ,",
    "the presented matrices correspond to a mesh with @xmath39 independent dofs for nodes and elements , as illustrated in figure  [ fig_mesh ] .",
    "the basis functions for the piecewise linear fe space are given by the lagrange functions @xmath314 ; those for the piecewise constant fe space by the step functions @xmath315 ( cf .",
    "figure  [ fig_mesh ] ) .",
    "they are defined by @xmath316 , \\\\",
    "\\frac { x - x_{l-1 } } { \\delta x_{m - 1 } } &     \\text{if } \\ x \\in [ x_{l-1 } , x_{l }   ] , \\\\                    0                       &   \\text{else } ,                   \\end{cases }     \\qquad      { \\color{black }",
    "\\chi_{m}(x )      \\color{black}}= \\begin{cases }                    1     &   \\text{if } \\   x \\in [ x_l     , x_{l+1 } ] , \\\\                    0     &   \\text{else}.                   \\end{cases}\\ ] ]    noting that for all @xmath317 , @xmath318 , @xmath319 , @xmath320 , and zero else , the evaluation of coefficients   gives the metric - dependent mass matrix    @xmath321    here and throughout the entire manuscript , we associate @xmath322 with @xmath323 and @xmath324 with @xmath325 because of the periodic boundary . moreover , for all @xmath317 , @xmath326 , and zero else , the evaluation of coefficients   gives the metric - free stiffness matrix @xmath327    given the values @xmath328 , zero else , to evaluate coefficients   and the values @xmath329 , zero else , to calculate coefficients  , the metric - dependent mass - matrix @xmath107 and the metric - free stiffness matrix @xmath110 are given by @xmath330 with @xmath112 .",
    "finally , we note that @xmath331 such that the evaluation of coefficients   gives the metric - dependent mass matrix @xmath200 with corresponding metric - free projection matrix @xmath203 : @xmath332",
    "in this section we present in detail how the discrete dispersion relations , presented in sect .  [ sec_standard ] for the mixed , and in sect .",
    "[ sec_split ] for the split schemes , can be calculated . for the former schemes",
    ", we mainly follow the exposition of @xcite while for the latter ones we adapt this method to investigate also the split wave equations .      to understand how the discrete dispersion relations are derived , we first discuss the analytical case . as above",
    ", we consider the domain @xmath333 with coordinates @xmath12 \\subset \\mathbbm r$ ] and time variable @xmath334 .",
    "we assume that the solutions can be formulated as periodic in space and time . in detail , we seek periodic solutions of the equations  , i.e. we decompose the solutions in the form @xmath335 in which @xmath336 are constants .",
    "@xmath3 is the angular frequency and @xmath4 is the wave number .",
    "applying the first decomposition of with respect to time to evaluate the time derivative of , we obtain equations in _ harmonic form _ @xmath337 using further the second decomposition of in wave vector space with wave vector @xmath4 , we find @xmath338 for nontrivial solutions to exist , the determinate of the coefficient matrix in must vanish .",
    "then , the analytic dispersion relation for shallow - water waves reads @xmath339 in which @xmath118 describes the phase speed .",
    "the positive and negative solutions stand for right and left traveling waves , respectively .",
    "the preceding equation also describes the analytical dispersion relation of the split wave equations  .",
    "this fact follows directly be substituting in the metric into the topological equations , which leads to eqn .  .",
    "an explicit treatment of the split equations avoiding such substitution , as presented for the discrete case in sect .",
    "[ sec_der_dspsplit ] , would result in the dispersion relation   too .",
    "the discrete dispersion relations of the schemes derived in this manuscript can be calculated analogously to the continuous case .",
    "in particular , we begin our derivations from equations in harmonic form ( as in ) , in which the equations are continuous in time and only discretized in space .",
    "representing the variables in terms of fourier expansions on nodal and elemental unknowns , this approach results in discrete dispersion relations in which the magnitude of the temporal frequency is expressed as a function of the wave number @xmath4 , cf .",
    "@xcite .    to simplify calculations , we assume for all the following cases that the domain with length @xmath333 is discretized by a uniform mesh whose @xmath39 elements have equilateral size @xmath340 for all @xmath341 , ( cf . fig .",
    "[ fig_mesh ] ) .",
    "the semi - discrete harmonic equations for the unstable p1-p1 scheme are given by eqns .   in sect .",
    "[ sec_standard00 ] , in which the partial time derivatives @xmath342 and @xmath343 are replaced by @xmath344 and @xmath345 , respectively .",
    "expanding further for all nodes the nodal values @xmath346 in wave vector form , i.e. @xmath347 for constants @xmath348 and @xmath349 , we obtain @xmath350 dividing the preceding equations by @xmath351 and noting that @xmath352 , we find @xmath353 in which we used the integral values of appendix  [ append_int_values ] .",
    "these equations can equivalently be written in matrix vector form : @xmath354 setting the determinate of this coefficient matrix to zero gives the discrete dispersion relation @xmath355 for @xmath262 , there follows @xmath356 , which can be verified by expanding @xmath357 in a taylor series around zero . at the shortest wave length @xmath93 , eqn .   has a second root ( spurious mode ) .      in case of the stable p1-p0 scheme introduced in sect .",
    "[ sec_standard01 ] , the semi - discrete harmonic equations are given by eqn .  , with @xmath342 and @xmath358 replaced by @xmath344 and @xmath359 , respectively . here , we expand the variables for all nodes as @xmath360 and for all elements as @xmath361 .",
    "the discrete momentum equation then reads @xmath362 and the continuity equation reads @xmath363 dividing the former equation by @xmath351 and the latter by @xmath364 , noting that on a uniform mesh @xmath365 , and using the integral values of appendix  [ append_int_values ] , the momentum equation becomes @xmath366 and the continuity equation becomes @xmath367 the preceding set of discrete equations reads in matrix - vector formulation as @xmath368 setting the determinate of this coefficient matrix to zero results in the discrete dispersion relation @xmath369^{1/2 } \\ , .\\ ] ] also here , @xmath356 for @xmath262 .",
    "however , in contrast to the unstable p1-p1 scheme , there is no second root at shortest wave length @xmath93 , instead the discrete dispersion relation approximates well the analytical one .",
    "this scheme is therefore stable .      for the split schemes derived in sect .",
    "[ sec_split ] , the semi - discrete harmonic topological equations are given by eqn .",
    ", with @xmath370 and @xmath371 replaced by @xmath372 and @xmath373 , respectively . here , we expand the coefficient of velocity and height in wave vector form as follows : at nodal values as @xmath374 , and at element values as @xmath375 , with constants @xmath376 and @xmath348 .",
    "we obtain @xmath377 dividing the preceding equations by @xmath364 and using @xmath365 and the integral values of appendix  [ append_int_values ] , there follows @xmath378    eqns .",
    "stay valid for all four possible choices of metric closure equations for which we derived and discussed in sect .",
    "[ sec_disc_metr ] the corresponding discrete equations . here",
    ", we proceed similarly and derive those equations that close the harmonic equations  . also here",
    ", we distinguish between high , medium , and low accuracy closures .",
    "the discrete metric closure equations for the high accuracy case are given by eqns .  .",
    "expanding the variables in wave vector form at nodal and elemental values as done for the topological equations , we obtain @xmath379 dividing the preceding equation by @xmath351 , using @xmath365 , and applying the integral values of appendix  [ append_int_values ] , we find @xmath380 the combination of these latter with the discrete topological equations   gives the matrix vector equations : @xmath381 to find nontrivial solutions of this equation , we set the determinate of this coefficient matrix to zero .",
    "for the _ high accuracy scheme _ , there follows the discrete dispersion relation @xmath382 for @xmath262 , there follows @xmath91 . because of the double angle formula ( i.e. @xmath264 ) , this dispersion relation equals the one in eqn .   for the unstable p1-p1 scheme ; hence , it has a root solution at @xmath265 and is therefore unstable .      in the low accuracy case ,",
    "the discrete metric equations are given by eqn .",
    ", in which we substitute the expansions of the variables at nodal and elemental values as done for the high accuracy case . then , @xmath383 dividing the latter equations by @xmath364 , applying @xmath365 , and using the integral values of appendix  [ append_int_values ] , there follows @xmath384 combining the preceding ones with equations   gives the matrix - vector equations @xmath385 to find nontrivial solutions of this system , we set the determinate of this coefficient matrix to zero , which gives for the _ low accuracy scheme _ the discrete dispersion relation @xmath386 with the property that for @xmath262 , @xmath91 . here ,",
    "at the wave number @xmath265 , there is no second root but a singularity , i.e. with increasing wave number @xmath273 the phase speed tends to infinity .      for the medium accuracy case with discrete metric equations   that correspond to using the discrete hodge - star pair @xmath189 ,",
    "we expand the variables in terms of nodal and elemental values as above .",
    "the resulting closure equation that maps between the velocity fields equals the one in eqn .",
    ", while the closure equation that maps between the height fields equals the one in eqn .  .      in turn ,",
    "using the discrete metric equations   that corresponds to the discrete hodge - star pair @xmath190 , the resulting closure equation for the velocity mapping is given by , whereas the one for the height mapping by .",
    "when combining these latter ones with the discrete topological equations , we obtain @xmath388    setting these coefficient matrices to zero , there follows for both cases the same discrete dispersion relation @xmath389^{\\frac{1}{2}},\\ ] ] with @xmath91 for @xmath262 as in all other cases . for the wave number @xmath265 , there is no second root as well as no singularity .",
    "we note that the preceding equation gives for both @xmath189 as well as @xmath190 exactly the same dispersion relation as presented in eqn .   for the stable p1-p0 scheme .",
    "considering the matrix equations for all four cases , we realize that the first two lines remain unchanged while the second to lines , which incorporate how the straight and twisted forms are connected , change with the choice of discrete metric closure equations .",
    "these differences in the latter two lines are also responsible for the differences in the dispersion relations .",
    "behrens , j. [ 2006 ] , adaptive atmospheric modeling - key techniques in grid generation , data structures , and numerical operations with applications .",
    "_ lecture notes in computational science and engineering , 54 , springer verlag , berlin , heidelberg _",
    ", doi:10.1007/3 - 540 - 33383 - 5 .",
    "bochev , p. and hyman , j. [ 2006 ] , principles of mimetic discretizations of differential operators .",
    "compatible spatial discretizations , the i m a volumes in mathematics and its applications _ , * 142 * , 89119 .",
    "cotter , c.j . and ham , d.a . and pain , c.c . and reich , s. [ 2009 ] , lbb stability of a mixed galerkin finite element pair for fluid flow simulations , _ journal of computational physics_. cotter , c.j . and mcrae , a.t.t . [ 2014 ] , compatible finite elements for numerical weather prediction , _ arxiv:1401.0616 _ , https://arxiv.org/abs/1401.0616 .",
    "kreeft , j. j. and palha , a. and gerritsma , m. i. [ 2010 ] , mimetic spectral element method for generalized convection - diffusion problems . _ in proceedings of the european conference on computational fluid dynamics ( eccomas cfd)_.      le roux , d. y. and rostand , v. and benoit , p. [ 2007",
    "] , analysis of numerically induced oscillations in 2d finite - element shallow - water models part i : inertia - gravity waves _",
    "siam j. sci .",
    "_ , * 29(1 ) * , 331360 .",
    "le roux , d. y. and pouliot , b. [ 2008 ] , analysis of numerically induced oscillations in two - dimensional finite - element shallow - water models part ii : free planetary waves , _ siam j. sci .",
    "_ , * 30(4 ) * , 19711991 .",
    "palha , a. and rebelo , p. p. and hiemstra , r. and kreeft , j. and gerritsma , m. [ 2014 ] , physics - compatible discretization techniques on single and dual grids , with application to the poisson equation of volume forms , _ journal of computational physics _ , * 257(b ) * , 1394  1422 ."
  ],
  "abstract_text": [
    "<S> we introduce a new finite element ( fe ) discretization framework applicable for covariant _ split _ equations @xcite . the introduction of additional differential forms ( df ) that form pairs with the original ones permits the splitting of covariant equations into topological momentum and continuity equations and metric - dependent closure equations that apply the hodge - star operator . </S>",
    "<S> our discretization framework conserves this geometrical structure , in particular it provides for all dfs proper fe spaces such that the differential operators ( here gradient and divergence ) hold in strong form . </S>",
    "<S> we introduce lowest possible order discretizations of the split 1d wave equations , in which the discrete momentum and continuity equations follow by trivial projections onto piecewise constant fe spaces , omitting partial integrations . approximating the hodge - star by nontrivial galerkin projections ( gp ) , </S>",
    "<S> the two discrete metric equations follow by projections onto either the piecewise constant ( gp0 ) or piecewise linear ( gp1 ) space .    out of the four possible realizations , </S>",
    "<S> our framework gives us in fact three different schemes with significantly different behavior . </S>",
    "<S> the split scheme using twice gp1 is unstable and shares the same discrete dispersion relation ( shown analytically ) and similar second - order convergence rates ( shown numerically ) as the unstable p1-p1 fe scheme that approximates both variables by piecewise linear spaces ( p1 ) . </S>",
    "<S> the two split schemes that apply a mixture of gp1 and gp0 have the same discrete dispersion relation as the stable p1-p0 fe scheme that applies piecewise linear and piecewise constant ( p0 ) spaces with corresponding second- and first - order convergence rates . however , the split scheme exhibits second order convergence for the quantities of interest , which suggests that these split schemes are stable versions of the standard ( unstable ) p1-p1 scheme . for the split scheme applying twice gp0 </S>",
    "<S> , we are not aware of a corresponding standard formulation to compare with . </S>",
    "<S> though exhibiting larger absolute error values , it shows similar convergence rates as the other split schemes , but does not provide a satisfactory approximation of the dispersion relation as short waves are propagated much to fast . despite this deficiency , the discovery of the new scheme illustrates the potential of our discretization framework as a toolbox to study and find fe schemes by new combinations of fe spaces . </S>"
  ]
}