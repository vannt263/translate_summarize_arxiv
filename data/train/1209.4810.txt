{
  "article_text": [
    "gaussian quantum information is that area of quantum information which deals with continuous variable systems ( e.g. , bosonic systems ) prepared in gaussian states , evolving by gaussian unitaries or channels , and finally measured by gaussian detectors  @xcite .",
    "gaussian states are easy to generate experimentally and very easy to manipulate theoretically .",
    "their description can be reduced to their first two statistical moments , which are the mean value ( or displacement vector ) and the covariance matrix ( cm ) . in particular",
    ", the cm contains the most relevant information about the gaussian state , providing its entropy , purity properties and separability properties  @xcite .",
    "one of the most important gaussian measurements is the bell detection  @xcite ( also known as continuous variable bell detection ) .",
    "this consists of combining two bosonic modes into a balanced - beam splitter ( i.e. , with transmissivity @xmath1 ) .",
    "the output modes are then measured by two homodyne detectors in such a way that one mode is detected in the position quadrature @xmath2 and the other mode in the momentum quadrature @xmath3 .",
    "this measurement is typical of a series of protocols with continuous variable systems , including quantum teleportation  @xcite and entanglement swapping  @xcite .",
    "another important measurement is heterodyne detection , where a single bosonic mode is taken as input of a balanced - beam splitter ( with the other input being the vacuum ) and the two outputs are homodyned in @xmath2 and @xmath3 , respectively .",
    "this is also a fundamental detection in many continuous variable protocols , for instance in coherent - state quantum key distribution  @xcite and two - way quantum cryptography  @xcite .    in this paper",
    ", we consider a generalized form of bell measurement that we call bell - like detection . here",
    "we have two bosonic modes which are combined into a beam splitter of _ arbitrary _ transmissivity @xmath4 and then homodyned in the two quadratures ( one mode in @xmath2 and the other in @xmath3 ) .",
    "standard bell detection and heterodyne detection are specific instances of this more general measurement . in our derivation",
    ", we consider the general scenario where a set of @xmath5 bosonic modes is given in a gaussian state with arbitrary cm . by applying the bell - like detection to the last two modes of the set , we compute the conditional reduced cm of the first @xmath6 modes surviving the measurement .",
    "this is expressed in terms of the input cm  and the beam splitter s transmissivity @xmath4 adopted in the measurement .",
    "we derive this input - output formula both in the ideal case of perfect detection , i.e. , unit quantum efficiency for the homodyne detectors , and the realistic case where detection is not necessarily perfect , i.e. , the homodyne detectors have arbitrary quantum efficiency @xmath7 ( a scenario which can be modelled by inserting additional beam splitters in front of the detectors  @xcite ) .",
    "our algebraic derivation is relatively easy starting from the well - known transformation rules for cms under partial homodyne detections  @xcite , which are here suitably generalized to the case of arbitrary quantum efficiency @xmath8 . despite its easy derivation ,",
    "our main formula for bell - like detections can be usefully applied in several contexts .",
    "for instance , it can be exploited to extend the protocols of quantum teleportation and entanglement swapping to considering unbalanced beam splitters ( asymmetric setups ) .",
    "similarly , it can be used to perturb the ideal model of heterodyne detection which is used in many protocols of quantum key distribution .",
    "the paper is organized as follows . in sec .",
    "[ sec1 ] we provide a brief introduction to bosonic gaussian states and cms . in sec .",
    "[ sec2 ] we review the transformation rules for cms under homodyne detections , generalizing these well - known rules to the case of arbitrary quantum efficiency .",
    "then , in sec",
    ".  [ sec3 ] , we derive the main result of the paper , i.e. , the formula for the transformation of cms under general bell - like detections , which is first given in the ideal case of unit efficiency and , then , in the general scenario of arbitrary quantum efficiency for the homodyne detectors . finally , sec .",
    "[ sec4 ] is for conclusions , with appendix  [ appendix ] showing specific examples of application of our results to the cases of standard bell detection and heterodyne detection .",
    "a system of @xmath6 bosonic modes is a described by a vector of @xmath9 quadrature operators@xmath10 satisfying the commutation relations @xmath11=2i\\omega _ { ij}^{(n)}$ ] , where @xmath12 is the generic element of the @xmath6-mode symplectic form@xmath13{cc}% 0 & 1\\\\ -1 & 0 \\end{array } \\right )   ~. \\label{symplectic_form}%\\ ] ] by definition , a quantum state @xmath14 of @xmath6 bosonic modes is said to be gaussian  when its phase - space wigner function is gaussian  @xcite .",
    "for this reason , a gaussian state is fully characterized by its first and second - order statistical moments .",
    "these are the displacement vector@xmath15 and the cm @xmath16 , with generic element@xmath17 where @xmath18 denotes the anticommutator . by definition ,",
    "the cm  is a @xmath19 real and symmetric matrix . in order to be a quantum cm",
    ", it must also satisfy the uncertainty principle  @xcite@xmath20 or an equivalent set of bona - fide conditions ( for instance , see ref",
    ".  @xcite  for the case of two - mode cms ) .",
    "in particular , eq .",
    "( [ unc_princ ] ) implies the positivity definiteness @xmath21 the simplest gaussian state is the vacuum state , which corresponds to @xmath22  and @xmath23 .",
    "once that a state is prepared in a gaussian states , its evolution can be such to preserve its gaussian statistics .",
    "this is the case of gaussian unitaries , which are defined as those unitaries transforming gaussian states into gaussian states . at the level of the second - order moments",
    ", the action of a gaussian unitary @xmath24  corresponds to the congruence transformation @xmath25 where @xmath26 is a symplectic matrix , i.e. , a matrix preserving the symplectic form @xmath27 .",
    "a simple example is the beam splitter transformation .",
    "this is defined by the single - parameter symplectic matrix @xmath28{cc}% \\sqrt{t}\\mathbf{i } & \\sqrt{1-t}\\mathbf{i}\\\\ -\\sqrt{1-t}\\mathbf{i } & \\sqrt{t}\\mathbf{i}% \\end{array } \\right )   ~ , \\label{bstrans}%\\ ] ] where @xmath29 is the @xmath30 identity matrix and @xmath31 is the transmissivity of the beam splitter . in the heisenberg picture",
    ", the beam splitter corresponds to the following bogoliubov transformation of the quadrature operators @xmath32{c}% \\hat{q}_{+}\\\\ \\hat{p}_{+}\\\\ \\hat{q}_{-}\\\\ \\hat{p}_{-}% \\end{array } \\right )   = \\mathbf{k}(t)\\left ( \\begin{array } [ c]{c}% \\hat{q}_{1}\\\\ \\hat{p}_{1}\\\\ \\hat{q}_{2}\\\\ \\hat{p}_{2}% \\end{array } \\right )   = \\left ( \\begin{array } [ c]{c}% \\sqrt{t}\\hat{q}_{1}+\\sqrt{1-t}\\hat{q}_{2}\\\\ \\sqrt{t}\\hat{p}_{1}+\\sqrt{1-t}\\hat{p}_{2}\\\\ -\\sqrt{1-t}\\hat{q}_{1}+\\sqrt{t}\\hat{q}_{2}\\\\ -\\sqrt{1-t}\\hat{p}_{1}+\\sqrt{t}\\hat{p}_{2}% \\end{array } \\right )   .\\ ] ]    finally , gaussian measurements can be defined as those quantum measurements whose application to gaussian states provides outcomes which are gaussian distributed  @xcite .",
    "when a gaussian measurement is perfomed on a subset of modes of a bosonic system prepared in a gaussian state , then the reduced state of the surviving ( non - measured ) modes is a gaussian state . at the level of the second - order moments",
    ", the cm of the final state is connected to the cm of the initial state . as an example , when we homodyne one mode of a set of @xmath6 bosonic modes in a gaussian state , the formula of the final cm has a remarkably easy formula  @xcite .",
    "this is reviewed in the next section .",
    "let us consider @xmath33 bosonic modes in a gaussian state .",
    "this @xmath34-mode gaussian state @xmath35 has a cm that can be written in the blockform@xmath36{cc}% \\mathbf{a } & \\mathbf{c}\\\\ \\mathbf{c}^{t } & \\mathbf{b}% \\end{array } \\right )   ~,\\ ] ] where @xmath37 is the cm of the first @xmath6 modes , @xmath38 is the cm of the last mode , and @xmath39 is a rectangular @xmath40 real matrix accounting for the cross correlations .     of @xmath33 modes",
    "is homodyned in its last mode .",
    "the resulting output state @xmath41 of the first @xmath6 modes is gaussian .",
    "the input and output cms are related by eq .",
    "( [ hom_law ] ) for @xmath2-detection , and by eq .",
    "( [ hom_law2 ] ) for @xmath3-detection.,scaledwidth=50.0% ]    now , let us homodyne the @xmath42 mode as shown in fig .  [ cmpic ] , performing the detection of the @xmath2 quadrature .",
    "the output state @xmath41 of the remaining @xmath6 modes is still gaussian . in particular , this @xmath6-mode gaussian state is described by the following cm  @xcite@xmath43 where@xmath44{cc}% 1 & 0\\\\ 0 & 0 \\end{array } \\right )   ~.\\ ] ] if we detect the @xmath3  quadrature , we have to consider the replacement@xmath45{cc}% 0 & 0\\\\ 0 & 1 \\end{array } \\right )   ~ , \\label{replac_p}%\\ ] ] so that the conditional output cm  is given by@xmath46 it is important to note that , in eqs .",
    "( [ hom_law ] ) and  ( [ hom_law2 ] ) , the matrices @xmath47 and @xmath48 are singular , so that @xmath49 and @xmath50 must be interpreted as pseudoinverses . in general , for a singular matrix @xmath51 , the pseudoinverse @xmath52 ( also known as moore - penrose inverse )  is a matrix @xmath53 which minimizes the quantity @xmath54 where @xmath55 are the entries of @xmath56 , with @xmath29 being the identity matrix .    in the present problem ,",
    "the pseudoinverses are easy to compute .",
    "in fact , let us set @xmath57{cc}% b_{1 } & b_{3}\\\\ b_{3 } & b_{2}% \\end{array } \\right )   ~ , \\label{bform}%\\ ] ] where @xmath58 and @xmath59 , since @xmath60 ( being a reduced cm ) .",
    "then , we have @xmath61 , and we can easily compute@xmath62 this is a consequence of the fact we have @xmath63 for any @xmath64  @xcite . thus , for the @xmath65-detection , we can write@xmath66 similarly , for the detection of the other quadrature , we have @xmath67 , so that@xmath68 thus , the formula for the @xmath3-detection is simply given by@xmath69      here we consider the case where the homodyne detector is not necessarily perfect , i.e. , it has a quantum efficiency @xmath7 .",
    "this is modelled by considering a beam - splitter with transmissivity @xmath8 in front of the detector , where one port is accessed by the signal mode ( the last mode of the bosonic input set ) and the other port is accessed by an environmental vacuum mode .",
    "this scenario is depicted in fig .",
    "[ small2 ]     of @xmath33 modes is homodyned in its last mode , with quantum efficiency @xmath7 ( modelled as a beam splitter of transmissivity @xmath8 which mixes the input signal mode with an environmental vacuum mode ) .",
    "the resulting output state @xmath41 of the first @xmath6 modes is gaussian .",
    "the input and output cms are related by eq .",
    "( [ qsimpleeff ] ) for @xmath2-detection , and by eq .",
    "( [ psimpleeff ] ) for @xmath3-detection.,scaledwidth=50.0% ]    the generalization of the previous formulas is quite easy .",
    "the input cm is first dilated to include the vacuum , i.e. , @xmath70 .",
    "then , we apply the beam splitter matrix to the last two modes , i.e. , @xmath71\\mathbf{v}^{\\prime}[\\mathbf{i}^{(n)}\\oplus \\mathbf{k}]^{t}~,\\ ] ] where @xmath72 is given in eq .",
    "( [ bstrans ] ) , and @xmath73 is the @xmath6-mode identity matrix ( @xmath19 ) .",
    "the next step is to trace out the transmission of the vacuum ( i.e. , the last output mode ) , which corresponds to delete the last two rows and columns of the cm  @xmath74 .",
    "thus , we have the following output cm for the @xmath33 bosonic modes before detection@xmath75{cc}% \\mathbf{a } & \\sqrt{\\eta}\\mathbf{c}\\\\ \\sqrt{\\eta}\\mathbf{c}^{t } & \\eta\\mathbf{b}+(1-\\eta)\\mathbf{i}% \\end{array } \\right )   ~. \\label{vterza}%\\ ] ] note that the block @xmath76 is positive - definite since it is the reduced cm of the last signal mode after the beam - splitter . by expressing @xmath38  in the form of eq .",
    "( [ bform ] ) , the diagonal terms of @xmath77 can be written as @xmath78 and @xmath79 .",
    "now , for @xmath2-detection , we apply the formula of eq .",
    "( [ qsimple ] ) to the cm of eq .",
    "( [ vterza ] ) .",
    "this is equivalent to make the replacements @xmath80 and @xmath81 in eq .",
    "( [ qsimple ] ) . as a result",
    ", we get the final formula@xmath82 for any quantum efficiency @xmath7 . on the other hand ,",
    "if we consider the @xmath3-detection , we apply the formula of eq .",
    "( [ psimple ] ) with @xmath83 and @xmath81 .",
    "thus , we find the other general formula@xmath84 for any quantum efficiency @xmath7 .      as a simple example of application , we consider the remote state preparation which is typical in continuous variable quantum cryptography  @xcite .",
    "alice has an einstein - podolsky - rosen ( epr ) state  @xcite , which is a gaussian state with zero mean and cm equal to @xmath85{cc}% \\mu\\mathbf{i } & \\sqrt{\\mu^{2}-1}\\mathbf{z}\\\\ \\sqrt{\\mu^{2}-1}\\mathbf{z } & \\mu\\mathbf{i}% \\end{array } \\right )   ~,\\ ] ] with parameter @xmath86 and@xmath87{cc}% 1 & \\\\ & -1 \\end{array } \\right )   ~. \\label{reflectionmat}%\\ ] ] suppose that alice measures the @xmath2-quadrature of one mode with homodyne efficiency @xmath7 .",
    "then , the other mode is projected into a gaussian state with cm @xmath88{cc}% \\frac{\\eta+(1-\\eta)\\mu}{\\eta\\mu+1-\\eta } & \\\\ & \\mu \\end{array } \\right )   ~.\\ ] ] in particular , for @xmath89 , we have @xmath90{cc}% 1 & \\\\ & \\mu \\end{array } \\right )   ~ , \\label{asyq}%\\ ] ] which is an asymmetric gaussian state , with vacuum fluctuations in the @xmath2-quadrature and thermal in the @xmath3-quadrature . in the case of ideal detection @xmath91 , we have@xmath92{cc}% \\mu^{-1 } & \\\\ & \\mu \\end{array } \\right )   ~,\\ ] ] which is the cm of a position - squeezed pure state .",
    "similarly , if alice detects the @xmath3-quadrature , we have@xmath93{cc}% \\mu & \\\\ & \\frac{\\eta+(1-\\eta)\\mu}{\\eta\\mu+1-\\eta}% \\end{array } \\right )   ~.\\ ] ] for @xmath89 , alice remotely prepares the other asymmetric gaussian state@xmath94{cc}% \\mu & \\\\ & 1 \\end{array } \\right )   , \\ ] ] while for ideal detection @xmath91 , she remotely prepares a momentum - squeezed pure state@xmath95{cc}% \\mu & \\\\ & \\mu^{-1}% \\end{array } \\right )   ~.\\ ] ]",
    "in this section we derive the transformation rule for the cm  under generalized bell - like detections , first assuming the condition of unit quantum efficiency for the homodyne detectors ( sec .",
    "[ idealbell ] ) and , then , the general case of arbitrary quantum efficiencies  ( sec .  [ realbell ] ) .      as depicted in fig .",
    "[ cmpic2 ] , let us consider @xmath5 bosonic modes in a gaussian state @xmath35 . its cm can always be written in the blockform@xmath36{cc}% \\mathbf{a } & \\mathbf{c}\\\\ \\mathbf{c}^{t } & \\mathbf{b}^{(2)}% \\end{array } \\right )   ~ , \\label{vin1}%\\ ] ] where @xmath37 is the reduced cm of the first @xmath6 modes,@xmath96{cc}% \\mathbf{b}_{1 } & \\mathbf{d}\\\\ \\mathbf{d}^{t } & \\mathbf{b}_{2}% \\end{array } \\right )   \\label{vin2}%\\ ] ] is the reduced cm of the last two modes ( labelled by @xmath97 and @xmath98 ) , and@xmath99{cc}% \\mathbf{c}_{1 } & \\mathbf{c}_{2}% \\end{array } \\right )   = \\left ( \\begin{array } [ c]{cc}% \\vdots & \\vdots\\\\ \\mathbf{c}_{1}^{k } & \\mathbf{c}_{2}^{k}\\\\ \\vdots & \\vdots \\end{array } \\right )   _ { k=1,n } \\label{vin3}%\\ ] ] is a rectangular @xmath100 real matrix , describing the correlations between the first @xmath6 modes and the last two modes",
    ".     of @xmath5 modes is subject to an ideal bell - like detection ( with arbitrary transmissivity @xmath101 ) in the last two modes ( labelled by @xmath97 and @xmath98 ) .",
    "the output state @xmath41 of the surviving @xmath6 modes is gaussian .",
    "the output cm @xmath102 is related to the input cm @xmath103 by eq .",
    "( [ output_formula]).,scaledwidth=49.0% ]    here , we consider an ideal bell - like detection applied to the last two modes @xmath97 and @xmath98 .",
    "this detection consists in applying a beam splitter of transmissivity @xmath4 , which transforms the input modes @xmath97 and @xmath98  into the output modes @xmath104  and @xmath105 , followed by two conjugate ( @xmath106- and @xmath107- ) homodyne detections as shown in fig .",
    "[ cmpic2 ] .",
    "thus , as a first step , let us apply the beam - splitter symplectic matrix .",
    "the @xmath0-mode gaussian state @xmath108 at the output of the beam splitter has cm@xmath109\\mathbf{v}_{in}% [ \\mathbf{i}^{(n)}\\oplus\\mathbf{k}]^{t}~,\\ ] ] where @xmath110 is the @xmath6-mode identity matrix , and @xmath111  is the beam - splitter matrix of eq .",
    "( [ bstrans ] ) applied to the last two modes .",
    "this cm takes the blockform@xmath112{cc}% \\mathbf{a } & \\mathbf{\\tilde{c}}\\\\ \\mathbf{\\tilde{c}}^{t } & \\mathbf{\\tilde{b}}^{(2)}% \\end{array } \\right )   ~ , \\label{vtilde1}%\\ ] ] where@xmath113 and@xmath114 more explicitly , the various blocks of the previous cm have the following expressions@xmath115{cc}% \\mathbf{\\tilde{c}}_{1 } & \\mathbf{\\tilde{c}}_{2}% \\end{array } \\right )   = \\left ( \\begin{array } [ c]{cc}% \\vdots & \\vdots\\\\ \\mathbf{\\tilde{c}}_{1}^{k } & \\mathbf{\\tilde{c}}_{2}^{k}\\\\ \\vdots & \\vdots \\end{array } \\right )   _ { k=1,n}~,\\ ] ] with@xmath116 and@xmath117{cc}% \\mathbf{\\tilde{b}}_{1 } & \\mathbf{\\tilde{d}}\\\\ \\mathbf{\\tilde{d}}^{t } & \\mathbf{\\tilde{b}}_{2}% \\end{array } \\right )   ~,\\ ] ] with@xmath118 in terms of the previous blocks , the cm  of eq .",
    "( [ vtilde1 ] ) takes the more explicit form@xmath112{ccc}% \\mathbf{a } & \\mathbf{\\tilde{c}}_{1 } & \\mathbf{\\tilde{c}}_{2}\\\\ \\mathbf{\\tilde{c}}_{1}^{t } & \\mathbf{\\tilde{b}}_{1 } & \\mathbf{\\tilde{d}}\\\\ \\mathbf{\\tilde{c}}_{2}^{t } & \\mathbf{\\tilde{d}}^{t } & \\mathbf{\\tilde{b}}_{2}% \\end{array } \\right )   ~. \\label{vtilde2}%\\ ] ] as already said , this cm  describes the gaussian state after the action of the beam splitter which transforms the last two modes @xmath97 and @xmath98 into the output modes @xmath104  and @xmath105 .",
    "now , we apply the @xmath2-detection on the last mode @xmath105 , and the @xmath3-detection on the next - to - last mode @xmath104 .",
    "the detection of @xmath119 implies the transformation of eq .",
    "( [ hom_law ] ) , which here reads@xmath120{cc}% \\mathbf{a } & \\mathbf{\\tilde{c}}_{1}\\\\ \\mathbf{\\tilde{c}}_{1}^{t } & \\mathbf{\\tilde{b}}_{1}% \\end{array } \\right )   -\\left ( \\begin{array } [ c]{c}% \\mathbf{\\tilde{c}}_{2}\\\\ \\mathbf{\\tilde{d}}% \\end{array } \\right )   \\boldsymbol{\\gamma}\\left ( \\begin{array } [ c]{cc}% \\mathbf{\\tilde{c}}_{2}^{t } & \\mathbf{\\tilde{d}}^{t}% \\end{array } \\right )   , \\label{vcmtra}%\\end{gathered}\\ ] ] where@xmath121 in other words , after the detection of @xmath105 , the @xmath34-mode cm describing the first @xmath6 modes and mode @xmath104  is given by@xmath122{cc}% \\mathbf{a}^{\\prime } & \\mathbf{c}^{\\prime}\\\\ \\mathbf{c}^{\\prime t } & \\mathbf{b}^{\\prime}% \\end{array } \\right )   ~ , \\label{vprimop}%\\ ] ] where@xmath123 and@xmath124 now , let us apply the @xmath3-detection on mode @xmath104 . by using eq .",
    "( [ hom_law2 ] ) , we get the final cm for the first @xmath6 modes after the measurement , which is given by@xmath125",
    "where@xmath126      here we simplify the formula for the output cm  given in eq .",
    "( [ outputcm ] ) .",
    "let us explicitly write the reduced cm  @xmath127 of the detected modes by setting@xmath128{cc}% \\beta_{1 } & \\beta_{3}\\\\ \\beta_{3 } & \\beta_{2}% \\end{array } \\right )   ~,~\\mathbf{b}_{2}:=\\left ( \\begin{array } [ c]{cc}% \\beta_{1}^{\\prime } & \\beta_{3}^{\\prime}\\\\ \\beta_{3}^{\\prime } & \\beta_{2}^{\\prime}% \\end{array } \\right )   ~,\\label{para1}\\\\ \\mathbf{d}:=\\left ( \\begin{array } [ c]{cc}% \\delta_{1 } & \\delta_{3}\\\\ \\delta_{4 } & \\delta_{2}% \\end{array } \\right )   ~.\\label{para2}%\\end{gathered}\\ ] ] from these matrices , we can construct the following real symmetric matrix@xmath129{cc}% \\gamma_{1 } & \\gamma_{3}\\\\ \\gamma_{3 } & \\gamma_{2}% \\end{array } \\right )   ~,\\label{gmatrix}%\\ ] ] where@xmath130 and@xmath131 then , after simple algebra we get@xmath132 and@xmath133 note that previous eqs .  (",
    "[ gammafor ] ) and  ( [ gammafor2 ] ) are well - defined , since @xmath134 and @xmath135 , i.e. , the matrix @xmath136  is positive definite . using eqs .",
    "( [ gammafor ] ) and  ( [ gammafor2 ] ) , we can simplify the previous eq .",
    "( [ outputcm ] ) .",
    "after some algebra , we get the first main result of our paper , i.e. , the input - output formula for the cm  under ideal bell - like detection@xmath137 where@xmath138{cc}% ( 1-t)\\gamma_{2 } & \\sqrt{t(1-t)}\\gamma_{3}\\\\ \\sqrt{t(1-t)}\\gamma_{3 } & t\\gamma_{1}% \\end{array } \\right )   , \\label{kappa11}\\\\ \\mathbf{k}_{22 } &   = \\left ( \\begin{array } [ c]{cc}% t\\gamma_{2 } & -\\sqrt{t(1-t)}\\gamma_{3}\\\\ -\\sqrt{t(1-t)}\\gamma_{3 } & ( 1-t)\\gamma_{1}% \\end{array } \\right )   , \\label{kappa22}\\\\ \\mathbf{k}_{12 } &   = \\mathbf{k}_{21}^{t}=\\left ( \\begin{array } [ c]{cc}% -\\sqrt{t(1-t)}\\gamma_{2 } & ( 1-t)\\gamma_{3}\\\\ -t\\gamma_{3 } & \\sqrt{t(1-t)}\\gamma_{1}% \\end{array } \\right )   .\\label{kappa12}%\\end{aligned}\\ ] ] thus , the output cm  @xmath102 of the surviving @xmath6 modes after the ideal bell - like detection is related to the input cm @xmath103 of the initial @xmath5 modes of eqs .",
    "( [ vin1])-([vin3 ] ) by means of the input - output relation of eq .",
    "( [ output_formula ] ) , where the matrices @xmath139  and @xmath136  are completely characterized by the reduced cm  @xmath127 of the detected modes and the transmission @xmath31 which is used in the bell - like detection .",
    "note that , in eq .",
    "( [ output_formula ] ) , the terms @xmath140 generate @xmath19 matrices , i.e. , with the same dimensions of @xmath37 .",
    "for instance , we have@xmath141{c}% \\vdots\\\\ \\mathbf{c}_{1}^{k}\\\\ \\vdots \\end{array } \\right )   \\mathbf{k}_{11}\\left ( \\begin{array } [ c]{ccc}% \\cdots & ( \\mathbf{c}_{1}^{k})^{t } & \\cdots \\end{array } \\right ) \\nonumber\\\\ = \\left ( \\begin{array } [ c]{ccc}% \\mathbf{c}_{1}^{1}\\mathbf{k}_{11}(\\mathbf{c}_{1}^{1})^{t } & \\cdots & \\mathbf{c}_{1}^{1}\\mathbf{k}_{11}(\\mathbf{c}_{1}^{n})^{t}\\\\ \\vdots & \\ddots & \\vdots\\\\ \\mathbf{c}_{1}^{n}\\mathbf{k}_{11}(\\mathbf{c}_{1}^{1})^{t } & \\cdots & \\mathbf{c}_{1}^{n}\\mathbf{k}_{11}(\\mathbf{c}_{1}^{n})^{t}% \\end{array } \\right )   ~.\\end{gathered}\\ ] ] as an exercise , we specify our ideal input - output formula of eq .  ( [ output_formula ] ) to the cases of standard bell measurement and heterodyne detection in appendix  [ appendix ] .      in this subsection",
    ", we generalize the previous input - output formula for the cm given in eq .",
    "( [ output_formula ] ) to realistic detectors . as depicted in fig .",
    "[ largepic ] , we consider two homodyne detectors with quantum efficiencies @xmath7 and @xmath142 , modelled by inserting two beam - splitters with transmissivities @xmath8 and @xmath143 , which mix the last two signal modes with environmental vacua",
    ".     of @xmath5 modes is subject to a realistic bell - like detection in its last two modes ( labelled by @xmath97 and @xmath98 ) .",
    "homodyne detectors have arbitrary quantum efficiencies @xmath7 and @xmath142 ( modelled by beam - splitters with transmissivities @xmath8 and @xmath143 , which mix the last two signal modes with two environmental vacua ) .",
    "the output state @xmath41 of the surviving @xmath6 modes is gaussian and its cm is related to the input cm by the formula of eq .",
    "( [ newinout]).,scaledwidth=50.0% ]    as before we start from the input cm @xmath103  of eq .",
    "( [ vin1 ] ) , whose blocks are specified in eqs .",
    "( [ vin2 ] ) and  ( [ vin3 ] ) , and their parametrization is given in eqs .",
    "( [ para1 ] ) and  ( [ para2 ] ) . from this parametrization",
    ", we construct the @xmath136-matrix of eq .",
    "( [ gmatrix ] )  as before , i.e. , using eqs .",
    "( [ gamma1 ] ) , ( [ gamma2 ] ) and  ( [ gamma3 ] ) . in order to compute the new input - output formula , note that the derivation is the same as before up to eq .",
    "( [ vtilde2 ] ) , which represents the cm  of the state after the action of the bell s beam - splitter with transmissivity @xmath4 .",
    "the difference is that we now apply an imperfect @xmath2-detection on the last mode @xmath105  with efficiency @xmath8 , and an imperfect @xmath144-detection on the next - to - last mode @xmath104  with efficiency @xmath143 .",
    "this means that the steps from eq .",
    "( [ vcmtra ] ) to eq .",
    "( [ gammapdef ] ) are still valid , proviso that we suitably replace the two matrices @xmath145 and @xmath146 .    the inefficient @xmath2-detection on the last mode @xmath105  corresponds to apply the transformation of eq .  ( [ qsimpleeff ] ) to eq .  ( [ vtilde2 ] ) .",
    "as a result , we get eq .",
    "( [ vcmtra ] ) with@xmath147 where @xmath148 this expression clearly coincides with that of eq .",
    "( [ gammafor ] ) for unit efficiency ( @xmath91 ) .",
    "thus , the @xmath34-mode cm describing the first @xmath6 modes and mode @xmath104  is now given by eqs .",
    "( [ vprimop]-[cprimoblock ] ) with @xmath145 defined in eq .",
    "( [ newgm ] ) .",
    "we now apply the inefficient @xmath3-detection on mode @xmath104 , which corresponds to apply the transformation of eq .",
    "( [ psimpleeff ] ) to eq .",
    "( [ vprimop ] ) . as a result",
    "we get the final cm @xmath102 for the first @xmath6 modes after the inefficient bell - like measurement , which is given by eq .",
    "( [ outputcm ] ) where the matrix @xmath146 is now equal to@xmath149",
    "where@xmath150{cc}% \\gamma_{1}(\\eta ) & \\gamma_{3}\\\\ \\gamma_{3 } & \\gamma_{2}(\\eta^{\\prime } ) \\end{array } \\right )   ~,\\label{gammapmatrix}%\\ ] ] with @xmath151 defined in eq .",
    "( [ gamma1primo ] ) and@xmath152 in other words , we can write @xmath153 where @xmath154{cc}% \\frac{1-\\eta}{\\eta } & \\\\ & \\frac{1-\\eta^{\\prime}}{\\eta^{\\prime}}% \\end{array } \\right )   ~.\\label{figrande}%\\ ] ] the new matrix @xmath155 is essentially the old matrix @xmath136 plus the effect @xmath156 of the quantum efficiencies @xmath8 and @xmath143 . again",
    ", for ideal detection ( @xmath157 ) we have @xmath158 which means that eq .",
    "( [ newgm2 ] ) becomes identical to the previous eq .",
    "( [ gammafor2 ] ) .    using eqs .",
    "( [ newgm ] ) and  ( [ newgm2 ] ) in eq .",
    "( [ outputcm ] ) , we derive the explicit expression of @xmath102 .",
    "after some algebra , we get the second main result of our paper , i.e. , the general input - output formula for the cm under bell - like detection with arbitrary quantum efficiencies @xmath8 and @xmath143 .",
    "this is given by@xmath159 where the matrices @xmath160 are equal to those given in eqs .  ( [ kappa11]-[kappa12 ] ) up to the replacements @xmath161    note that the only difference between the general formula of eq .",
    "( [ newinout ] ) and the ideal formula of eq .",
    "( [ output_formula ] ) is in the replacements of eq .",
    "( [ replaces ] ) . in other words , to compute the output cm , we perform exactly the same procedure as before for the ideal case , proviso that we now use @xmath151 and @xmath162 in the @xmath136-matrix and the @xmath163-matrices .",
    "as an exercise , we specify our general input - output formula of eq .",
    "( [ newinout ] ) to the cases of standard bell measurement and heterodyne detection in appendix  [ appendix ] .",
    "in conclusion , we have derived a simple formula for the transformation of cms under generalized bell - like detections , where two modes of a bosonic system are subject to an arbitrary beam - splitter transformation , followed by homodyne detections .",
    "we have consider first the case of ideal detection and , then , the general case of homodyne detectors with arbitrary quantum efficiencies . our formula can be applied to study quantum information protocols in various contexts , including protocols of teleportation , entanglement swapping and quantum key distribution . in particular",
    ", it can be adopted to generalize the analysis of these protocols to the presence of experimental imperfections and asymmetric setups , for instance , deriving from the use of unbalanced beam splitters .",
    "this work has been supported by epsrc under the research grant hipercom ( ep / j00796x/1 ) .",
    "in this appendix we specify our formulas to the cases of standard bell detection ( balanced beam - splitter ) and heterodyne detection ( balanced beam - splitter with a vacuum at one of the input ports ) .",
    "first we consider the ideal case of unit quantum efficiencies for the detectors , i.e. , we specify the formula of eq .",
    "( [ output_formula ] ) .",
    "then , we extend the results to the case of arbitrary quantum efficiencies , which corresponds to applying the formula of eq .",
    "( [ newinout ] ) .",
    "we achieve the formula for standard bell detection by setting @xmath164 ( balanced beam splitter ) . in this case",
    ", we have@xmath165 and @xmath166 .",
    "compactly , the @xmath136-matrix takes the form@xmath167 where @xmath168 is given in eq .",
    "( [ reflectionmat ] ) .",
    "the @xmath169-matrices can be simplified too .",
    "in fact , we get@xmath170{cc}% \\gamma_{2 } & \\gamma_{3}\\\\ \\gamma_{3 } & \\gamma_{1}% \\end{array } \\right )   = \\frac{1}{2}\\mathbf{x}_{1}^{t}\\boldsymbol{\\gamma}\\mathbf{x}% _ { 1},\\label{k11}\\\\ \\mathbf{k}_{22 } &   = \\frac{1}{2}\\left ( \\begin{array } [ c]{cc}% \\gamma_{2 } & -\\gamma_{3}\\\\ -\\gamma_{3 } & \\gamma_{1}% \\end{array } \\right )   = \\frac{1}{2}\\mathbf{x}_{2}^{t}\\boldsymbol{\\gamma}\\mathbf{x}_{2}\\\\ \\mathbf{k}_{12 } &   = \\mathbf{k}_{21}^{t}=\\frac{1}{2}\\left ( \\begin{array } [ c]{cc}% -\\gamma_{2 } & \\gamma_{3}\\\\ -\\gamma_{3 } & \\gamma_{1}% \\end{array } \\right )   = \\frac{1}{2}\\mathbf{x}_{1}^{t}\\boldsymbol{\\gamma}\\mathbf{x}_{2}~,\\end{aligned}\\ ] ] where@xmath171{cc } & 1\\\\ 1 & \\end{array } \\right )   , ~\\mathbf{x}_{2}:=\\left ( \\begin{array } [ c]{cc } & 1\\\\ -1 & \\end{array } \\right )   = \\boldsymbol{\\omega}~.\\label{xeom}%\\ ] ] since @xmath172 , the formula of eq .",
    "( [ output_formula ] ) becomes@xmath173 where the @xmath136-matrix is given by eq .",
    "( [ stgamma ] ) .",
    "it is straightforward to generalize the formula of eq .",
    "( [ stbell ] ) to the case of arbitrary quantum efficiencies @xmath8 and @xmath143 for the homodyne detectors .",
    "in fact , it is sufficient to replace @xmath174 with @xmath136 given in eq .",
    "( [ stgamma ] ) and @xmath175 given in eq .",
    "( [ figrande ] ) .",
    "we achieve the heterodyne detection of the @xmath176  mode by setting @xmath164 ( balanced beam splitter ) and considering the last mode in a vacuum state . as a matter of fact , this is equivalent to a standard bell detection where the last mode is in a vacuum .",
    "thus , we have@xmath96{cc}% \\mathbf{b}_{1 } & \\mathbf{0}\\\\ \\mathbf{0 } & \\mathbf{i}% \\end{array } \\right )   ~,~\\mathbf{c}_{2}=\\mathbf{0~,}%\\ ] ] so that the global input cm is equal to@xmath36{cc}% \\mathbf{a } & \\mathbf{c}_{1}\\\\ \\mathbf{c}_{1}^{t } & \\mathbf{b}_{1}% \\end{array } \\right )   \\oplus\\mathbf{i~.}%\\ ] ] by setting @xmath177 and @xmath178 in eq .",
    "( [ stgamma ] ) , we derive the expression of the @xmath179-matrix , which is given by@xmath180{cc}% \\beta_{1}+1 & -\\beta_{3}\\\\ -\\beta_{3 } & \\beta_{2}+1 \\end{array } \\right )   ~.\\label{gammahet}%\\ ] ] this matrix has determinant@xmath181 since @xmath182 , the sum in eq .",
    "( [ stbell ] ) contains only the term with @xmath183 , i.e.,@xmath184 now , we can easily check that@xmath185 by using eqs .",
    "( [ detghet ] ) and  ( [ xgx ] ) into eq .",
    "( [ vfinh ] ) , we get@xmath186 similarly , if we heterodyne the @xmath187 mode with the @xmath176 mode being the ancillary vacuum mode , we get@xmath188 with @xmath189 this formula for the heterodyne detection coincides with that given in ref .",
    "@xcite ( without an explicit proof ) .    in this case",
    "too , we can easily extend the results to non - unit quantum efficiencies , @xmath8 and @xmath143 , for the homodyne detectors .",
    "we need to perform the replacement @xmath190 in eq .",
    "( [ vfinh ] ) .",
    "first note that @xmath191~.\\label{eq1fi}%\\ ] ] then , for the determinant we can write @xmath192 which is an equality valid in general for any symmetric matrix @xmath136 and diagonal matrix @xmath193 . now using eq .",
    "( [ detghet ] ) in eq .",
    "( [ detsvil ] ) , we get@xmath194 finally , using eqs .",
    "( [ eq1fi ] ) and  ( [ theta1app ] ) , we get@xmath195\\mathbf{c}_{1}^{t}~,\\ ] ] which is the generalization of eq .",
    "( [ hetformu1 ] ) to arbitrary quantum efficiencies .",
    "proof is trivial . set @xmath196 and @xmath197{cc}% a & c\\\\ d & b \\end{array } \\right )   $ ] .",
    "then , @xmath198{cc}% ax-1 & cx\\\\ 0 & -1 \\end{array } \\right )   $ ] and @xmath199 .",
    "the gradient of @xmath200 is given by @xmath201 and @xmath202 which is zero for @xmath203 and @xmath204 ( since @xmath64 ) .",
    "finally , we can freely choose @xmath205 , so that @xmath206 ."
  ],
  "abstract_text": [
    "<S> we derive a simple formula for the transformation of an arbitrary covariance matrix of @xmath0 bosonic modes under general bell - like detections , where the last two modes are combined in an arbitrary beam splitter ( i.e. , with arbitrary transmissivity ) and then homodyned . </S>",
    "<S> in particular , we consider the realistic condition of non - unit quantum efficiency for the homodyne detectors . this formula can easily be specialized to describe the standard bell measurement and the heterodyne detection , which are exploited in many contexts , including protocols of quantum teleportation , entanglement swapping and quantum cryptography . in its general form </S>",
    "<S> , our formula can be adopted to study quantum information protocols in the presence of experimental imperfections and asymmetric setups , e.g. , deriving from the use of unbalanced beam splitters . </S>"
  ]
}