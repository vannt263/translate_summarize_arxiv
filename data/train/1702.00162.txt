{
  "article_text": [
    "quantum key distribution ( qkd ) holds promise for realizing information - theoretically secure communication between two distant parties ( alice and bob ) against any eavesdropper ( eve ) . since the first invention of the bb84 protocol  @xcite",
    ", many qkd protocols have been proposed  @xcite . among them",
    ", the differential - phase - shift ( dps ) qkd  @xcite can be rather simply implemented with a passive detection unit .",
    "a field demonstration of the dps protocol  @xcite has been already been conducted , and the information - theoretical security proof of the dps protocol has been established by tamaki _",
    "et al _  @xcite .",
    "unfortunately , however , this proof shows that the dps protocol can tolerate only a small bit error rate regime ( less than @xmath6 with a typical block length of @xmath7 light pulses , say @xmath8 ) .",
    "recently , in order to solve this problem , a new type of protocol called the round - robin differential - phase - shift ( rrdps ) qkd protocol  @xcite was proposed .",
    "this is a modified protocol from the original dps protocol in that bob s measurement has a freedom to randomly choose which pair of the incoming pulses to be interfered .",
    "this modification brings a distinct feature to the rrdps protocol that the security can be guaranteed without monitoring any disturbance between alice and bob .",
    "moreover , when the number of random delays ( we denote it by @xmath1 ) is large , the rrdps protocol has a strong tolerance to the bit error rate , and surprisingly it can tolerate the bit error rate of even @xmath0 when @xmath9 .",
    "thanks to these features , the rrdps protocol has attracted theoretical works  @xcite , and proof - of - principle experiments have been demonstrated  @xcite .",
    "unfortunately , however , an experimental implementation of the rrdps protocol is not as simple as the one of the original dps protocol .",
    "one of the main technological challenges for its realization is to switch the delay at random for each block of the pulses at bob s measurement . according to the number of the random delays , some passive interferometers  @xcite or a variable - delay interferometer  @xcite or some optical switches  @xcite",
    "are needed for bob s measurement . obviously , when the number of the random delays increases , an implementation of bob s measurement will be complicated .",
    "hence , from a practical viewpoint , it is preferable to implement the rrdps protocol with small @xmath1 , for instance , @xmath10 as demonstrated in  @xcite .    in this paper",
    ", we consider to improve the bit error tolerance of the dps protocol without significantly increasing the difficulties of its implementation .",
    "for this , we consider to add only a small amount of randomness , say @xmath2 , to the dps protocol .",
    "this modification can also be seen as the modification from the rrdps protocol in that the new protocol exploits more pulses than that of the rrdps protocol for a given @xmath1 .",
    "importantly , this modification does not increase any experimental difficulty at bob s side .",
    "we call the new protocol the small - number - random dps ( snrdps ) protocol",
    ". we present the information - theoretical security of our protocol , in which we have made some assumptions on the devices .",
    "in particular , we assume perfect phase modulations ( namely , alice s phase modulation is exactly 0 or @xmath11 ) and block - wise phase randomization ( the state of the @xmath7 pulses is a classical mixture of photon number states ) . with these assumptions ,",
    "we prove the security based on the shor - preskill s security proof  @xcite . by using the result of the security proof ,",
    "we compare the performance of the snrdps protocol and the one of the original dps protocol . as a result",
    ", we found that the key generation rate is significantly improved only with a few additional delays , say @xmath3 .",
    "for instance , if the bit error rate @xmath12 is @xmath13 , the key generation rate of the snrdps protocol with @xmath3 scales as @xmath14 with a channel transmittance @xmath15 in a longer distance regime while the original dps protocol scales as @xmath16 . also , when @xmath17 , the snrdps protocol with @xmath3 gives a positive key generation rate while the original dps protocol can not give a positive one .",
    "therefore , the small number of random delays provides a significant improvement in the resulting key generation rate compared to the one of the dps protocol .",
    "moreover , we compare the key generation rates of the snrdps protocol and the ones of the rrdps protocol without monitoring the disturbance when the same number of the random delays @xmath1 is employed between two protocols .",
    "consequently , we found that the snrdps protocol gives a better key generation rate than the one of the rrdps protocol without monitoring the bit error rate when @xmath1 is less than 10 and the bit error rate is small such as less than @xmath4 .",
    "this paper is organized as follows .",
    "first , in sec .  [ sec : dps - type - qkd ] we explain the dps - type qkd protocol including the assumptions on alice and bob s devices .",
    "next , in sec .",
    "[ sec : security - proof ] we prove the security of the dps - type protocol , where our security proof is based on the shor - preskill s security proof  @xcite .",
    "after that , in sec .  [",
    "sec : key - generation - rates ] we show the simulation results for the snrdps protocol , and compare the key generation rates with the various numbers of the random delays @xmath18 . finally , we summarize the paper in sec .  [",
    "sec : conclusion ] .",
    "in this section , before providing the description of the actual protocol , we first list up the assumptions on alice and bob s devices . see fig .  [",
    "fig : actual_scheme ] for the actual setup .",
    "first , we describe the assumptions on alice s source .",
    "we assume that it emits a single - mode coherent light pulse , and alice splits its pulse into a block of @xmath7 pulses .",
    "the @xmath7 pulses are block - wise phase randomized , namely , the quantum state of the @xmath7 pulses is described as a classical mixture of photon number states .",
    "the relative phase between the adjacent pulses is modulated by 0 or @xmath11 according to her randomly chosen bit 0 or 1 , respectively .",
    "next , as for bob s device , it is equipped with two photon - number - resolving ( pnr ) detectors that can discriminate among 0 , 1 , and more than 1 photon .",
    "he first splits @xmath7 incoming pulses into two blocks of @xmath7 pulses by using a @xmath19 beam splitter ( bs ) , shifts backward only one of the @xmath7-pulse blocks by @xmath20 that is chosen randomly from the set @xmath21 .",
    "then , the first @xmath22 pulses in the shifted block will be interfered with the last @xmath22 pulses in the other block with another @xmath19 bs , and then bob performs a photon measurement with the pnr detectors .",
    "each of the detectors corresponds to the bit value of 0 and 1 , respectively ( see fig .  [",
    "fig : actual_scheme ] ) .",
    "finally , we assume that there is no side - channel .",
    "we describe  dps - type \" qkd protocol , which is the generalization of the dps qkd protocol in that it employs the arbitrary number of random delays , and therefore dps - type protocol includes both the original dps protocol and the rrdps protocol .",
    "the protocol of the dps - type qkd runs as follows .    1 .",
    "alice generates a random @xmath7-bit string @xmath23 , a random number @xmath24 , and then she prepares a block of @xmath7 coherent pulses in the following state @xmath25 where @xmath26 represents the coherent state of the @xmath27 pulse .",
    "she sends @xmath28 to bob through a quantum channel .",
    "bob splits the incoming @xmath7 pulses into two @xmath7-pulse blocks by using the @xmath19 bs .",
    "he applies a delay @xmath29 to one of the paths in the mach - zehnder interferometer , where @xmath30 denotes the interval between two adjacent pulses in the block and @xmath20 is chosen uniformly at random from the set @xmath21 .",
    "after that , bob makes interference between two @xmath7-pulse blocks by using the other @xmath19 bs and performs the photon detection with the photon number resolving detectors .",
    "let us call the event _ detected _ if he detects exactly one photon in the pair of ( @xmath27 , @xmath31 ) ( @xmath32 ) interfering pulses and detects the vacuum in all of the other pulses ( including @xmath33 half pulses that do not interfere with any other half pulses ) .",
    "if the event is not _ detected _ , alice and bob skip steps ( a3 ) and ( a4 ) .",
    "3 .   bob takes note of the detected bit value @xmath34 and announces the pair of numbers @xmath35 over an authenticated public channel .",
    "4 .   alice takes note of the bit value @xmath36 .",
    "alice and bob repeat steps ( a1 ) through ( a4 ) @xmath37 times , and let @xmath38 be the number of the _ detected _ events .",
    "alice and bob randomly select a small portion @xmath39 of @xmath38 _ detected _ events , and compare the bit values over an authenticated public channel .",
    "this gives the estimate of the bit error rate .",
    "alice and bob discuss over an authenticated public channel to perform error correction and privacy amplification on the remaining portion to share a final key of length @xmath40 .",
    "note that the dps - type protocol includes the original dps and the rrdps protocols by choosing @xmath41 in step ( a2 ) as @xmath42 and @xmath43 , respectively .",
    "also , we define the snrdps protocol by setting @xmath44 with @xmath45 .",
    "in this section , we prove the security of the snrdps protocol with @xmath44 for @xmath45 . our security proof can be summarized as follows . first , in sec .",
    "[ subsec : dial - measurement ] we convert the actual protocol to an _ alternative _ protocol for simplicity of the analysis , where bob performs the alternative measurement ( we call it the dial measurement ) instead of the actual one .",
    "note that , by switching bob s actual measurement with the delays @xmath20 and @xmath22 uniformly at random , we show that he can simulate the dial measurement characterized by the delay @xmath20 with a @xmath0 of additional detection loss ( see lemma  [ fact : dial - actual - relation ] below ) .",
    "therefore , by introducing the additional loss in the alternative measurement , the dial measurement is equivalent to the actual measurement , and therefore we can employ the alternative measurement in the security proof .",
    "next , in sec .",
    "[ subsec : virtual - protocol ] we introduce an entanglement distillation protocol as a _ virtual _ protocol to prove the security of the protocol with the alternative measurement .",
    "after that , we construct the povm elements corresponding to the bit and phase error rates in sec .",
    "[ subsec : povm - elements ] , and derive a relation between the bit and phase errors by employing some constraint on alice s sending state in the virtual protocol in sec .",
    "[ subsec : relation - bit - phase - errors ] , and obtain an upper bound on the phase error rate as the function of the bit error rate in sec .",
    "[ subsec : evaluation - omega ] .",
    "c     + ( a ) bob s alternative ( dial ) measurement     + ( b ) bob s actual measurement      in this subsection , we introduce bob s alternative measurement , which we will employ in the security proof . in step ( a2 ) , bob extracts the _ detected _ events , in which only one photon is contained in the incoming @xmath7 pulses . here",
    ", @xmath46 denotes the set of basis vectors of the hilbert space @xmath47 , and @xmath48 represents that the @xmath27 pulse sent is in a single - photon state .",
    "let @xmath49 be the povm for the bit value @xmath50 detected at the pair of ( @xmath27 , @xmath31)-interfering pulses under the condition that the delay @xmath20 is chosen .",
    "considering the effect of the 50:50 bs , @xmath51 is written as @xmath52 for @xmath32 . here , we define @xmath53 . from eq .  , the probability of obtaining the bit value @xmath50 and the pair of interfering pulses @xmath54 in his measurement with the delay @xmath20 is given by @xmath55 for an arbitrary state @xmath56 given that exactly one photon is contained in the @xmath7 pulses .",
    "next , for simplicity of the security analysis , we convert bob s actual measurement into the alternative one .",
    "we call it the dial measurement , which gives the relative phase of an arbitrary pair of @xmath57 @xmath58 interfering pulses such that @xmath59 for given @xmath20 ( see fig .  [",
    "fig : dial_measurement](a ) ) .",
    "this measurement has more symmetry than the actual measurement , which makes our analysis much simpler , and importantly it is equivalent to the actual measurement except for @xmath0 of losses as we explain in lemma  [ fact : dial - actual - relation ] below .",
    "the povm @xmath60 of the dial measurement with the delay @xmath20 is defined by @xmath61 for @xmath62 . here",
    ", @xmath63 denotes the summation in modulo @xmath7 , namely , for integers @xmath64 with @xmath65 and @xmath66 , @xmath67 if bob performs the dial measurement with the delay @xmath20 , the probability of obtaining the bit value @xmath50 and the pair of interfering pulses @xmath68 is given by @xmath69 .",
    "note that the following relation holds for @xmath70 : @xmath71 next , we introduce the following lemma  @xcite that relates the dial and actual measurements .",
    "see appendix  [ append : dial - measurement ] for its proof .",
    "we define two conditional probabilities @xmath72}_\\mathrm{dial}$ ] and @xmath73}_\\mathrm{actual}$ ] .",
    "@xmath72}_\\mathrm{dial}$ ] represents the probability that bob obtains the bit value @xmath50 from @xmath74 interfering pulses given that he performs the dial measurement with the delay @xmath75 .",
    "@xmath73}_\\mathrm{actual}$ ] represents the probability that bob obtains @xmath50 from @xmath76 interfering pulses given that he performs the actual measurement with the delays @xmath77 or @xmath78 chosen uniformly at random .",
    "then , for an arbitrary fixed @xmath79 and for any input state @xmath56 , @xmath80}_\\mathrm{dial}=2{\\mathrm{pr}\\left[s\\wedge(i , j)\\middle|r\\in\\{r ' , l - r'\\}\\right]}_\\mathrm{actual}\\label{eq : dial - actual}\\end{aligned}\\ ] ] holds .",
    "[ fact : dial - actual - relation ]    lemma  [ fact : dial - actual - relation ] means that , the dial measurement with the delay @xmath81 after performing a half transmittance filter has the same probability distribution of @xmath50 and @xmath82 as the one of the actual measurement when bob switches delays @xmath81 and @xmath83 uniformly at random ( see fig .",
    "[ fig : dial_measurement](b ) ) .",
    "in other words , eve can not distinguish which of the measurement was actually employed from the classical information announced by bob . thanks to eq .",
    ", we are allowed to use the dial measurement for proving the security of the actual protocol .",
    "we call the protocol where bob performs the dial measurement instead of the actual one the _ alternative protocol_. the alternative protocol runs the same as the actual protocol except for steps ( a2 ) and ( a3 ) , which are replaced with the following steps ( a2 ) and ( a3 ) , respectively .    1 .",
    "bob receives the incoming @xmath7 pulses and splits them into two @xmath7-pulse blocks by using the @xmath19 bs .",
    "he selects a delay @xmath20 uniformly at random from the set @xmath21 .",
    "after that , bob performs the dial measurement .",
    "let us call the event _ detected _ if he detects exactly one photon in the pair of interfering pulses @xmath84 ( @xmath62 ) , and detects the vacuum in all the other pairs of interfering pulses . if the event is not _ detected _ , alice and bob skip steps ( a3 ) and ( a4 ) .",
    "2 .   bob takes note of the detected bit value and announces the pair of numbers @xmath85 over an authenticated public channel .      in this subsection",
    ", we introduce the entanglement distillation protocol to prove the security of the alternative protocol .",
    "our analysis is based on the shor - preskill s security proof  @xcite , where we follow similar arguments of the security proof of the original dps protocol  @xcite . to show alice and bob virtually extract a maximally",
    "entangled state , we need to introduce ancilla systems on alice s side and decompose bob s measurement , which we explain below .",
    "first , we explain alice s sending state in the virtual protocol .",
    "suppose alice has a quantum register of @xmath7-qubit system and let @xmath86 be the hilbert space of these systems .",
    "then , alice s state preparation is equivalent to the preparation of the following state over the quantum register system and @xmath7 pulses as @xmath87 where @xmath88 denotes the hadamard operator .",
    "note that @xmath24 is chosen uniformly at random for each preparation of the state @xmath89 .",
    "as shown in step ( a4 ) , the information that alice needs to obtain is @xmath90 . to obtain this information",
    ", she applies the following quantum circuit ( see fig .  [",
    "fig : quantum_circuit ] ) to the qubits @xmath91 and @xmath92 upon receiving from bob , and measures the qubit aq in the computational basis @xmath93 .",
    "the set of measurement operators that alice performs can be represented by @xmath94 note that alice s state preparation of @xmath89 with a random and uniform @xmath95 followed by the measurement @xmath96 is equivalent to the step ( a1 ) .",
    "moreover , in the virtual protocol , instead of @xmath89 , alice prepares the following state for simplicity of analysis .",
    "@xmath97 here , c is the system that stores the number of photons contained in the @xmath7 pulses whose hilbert space is spanned by an orthogonal basis @xmath98 . also , @xmath99 is the projection onto the subspace that the total photon number in the @xmath7 pulses is @xmath100 . from eve",
    "s perspective , accessible quantum information of eqs .   and   are the same since the following equation holds .",
    "@xmath101     and @xmath102 qubits , where the pair of integers @xmath103 is announced by bob . she applies a c - not gate ( defined on the z basis @xmath104 ) to these qubits , and the @xmath102 qubit is subjected to a hadamard gate ( denoted by @xmath105 ) while the @xmath106 qubit is measured on @xmath107-basis ( denoted by @xmath108 ) .",
    "if the outcome of the @xmath107 measurement is @xmath109 , she applies a phase flip gate to the @xmath102 qubit with probability @xmath110 , which is denoted by @xmath111 .",
    "otherwise , she applies the identity operation to the @xmath102 qubit .",
    "after that , we name the quantum system of the @xmath102 qubit aq.,width=302 ]    next , we explain bob s measurement procedure in the virtual protocol . in principle , he is able to determine whether the event is _ detected _ or not before he determines the pair of interfering pulses and the bit value by performing the quantum nondemolition ( qnd ) measurement of the total photon number in the incoming @xmath7 pulses .",
    "the event is called _ detected _ if and only if the measurement outcome of the qnd measurement is exactly one photon in the block of @xmath7 pulses . in the _ detected _ events ,",
    "the dial measurement is decomposed into two measurements , namely , the povm in eq .",
    "is decomposed into @xmath112 here , the set of measurement operators @xmath113 represents a filtering operation that gives the outcome @xmath114 and leaves a qubit system @xmath115 , which is defined by @xmath116    by using alice s quantum circuit represented by fig .  3 and bob s filtering operation described by @xmath117 , we introduce the following entanglement distillation protocol ( edp ) .    1 .",
    "alice prepares @xmath118 and sends a block of @xmath7 pulses to bob through a quantum channel .",
    "2 .   bob receives the incoming @xmath7 pulses and performs the qnd measurement of the total photon number in the @xmath7 pulses .",
    "let us call the event _ detected _ if he detects exactly one photon in the block of @xmath7 pulses .",
    "if the event is not _ detected _ , alice and bob skip steps ( v3 ) and ( v4 ) below .",
    "3 .   bob chooses @xmath20 uniformly at random from the set @xmath119 , and performs the filtering operation @xmath120 .",
    "he obtains the pair of pulses @xmath68 where exactly one photon is contained , and obtains the output qubit bq .",
    "he sends the pair of integers @xmath121 to alice over an authenticated public channel .",
    "alice applies the quantum circuit in fig .",
    "[ fig : quantum_circuit ] on her @xmath106 and @xmath102 qubits , and outputs the qubit aq . also , she measures system c and learns the total photon number @xmath100 in the block of @xmath7 pulses .",
    "alice and bob repeat steps ( v1 ) through ( v4 ) for @xmath37 times .",
    "let @xmath38 be the number of the _ detected _ events .",
    "at this point , alice and bob share @xmath38 pairs of qubits .",
    "alice and bob randomly select a small portion @xmath39 of the @xmath38 _ detected _ events , measure the qubits in the computational basis @xmath122 , and compare the bit values over the public channel .",
    "this gives the estimate of the bit error rate @xmath12 and hence of the number @xmath123 of bit errors in the remaining portion .",
    "alice and bob discuss over the public channel to perform entanglement distillation on the remaining pairs of qubits . finally , they measure all the remaining pairs of qubits on the computational basis to obtain a final key of length @xmath40 .    in this protocol",
    ", the key generation rate per sending pulse is written as  @xcite @xmath124/l,\\label{eq : keyrate}\\end{aligned}\\ ] ] where @xmath125 , and @xmath126 expresses the number of privacy amplification .",
    "the explicit formula of @xmath126 is described by @xmath127 where @xmath128 denotes the function of _ detected _ events when alice emits @xmath100 photons satisfying @xmath129 , and @xmath130 denotes the phase error rate when alice emits @xmath100 photons .",
    "note that the equivalence between steps ( a7 ) and ( v7 ) is guaranteed by the discussion in  @xcite . since the phase error rate @xmath130 can not be obtained directly in the actual protocol",
    ", we need to estimate @xmath130 with some statistics such as the disturbance information during alice and bob s quantum communication .      in this subsection , we construct povms for the bit and phase errors to estimate the upper bound on the phase error rate . to derive the relation between the bit and the phase error rates , we consider a measurement on alice and bob s quantum registers a and b just after the event is _ detected _ at step ( v2 ) , and regard an outcome as the occurrence of a bit error or a phase error . in this subsection , we explain only the definition and the resulting forms of povms for the bit and phase errors .",
    "the detailed derivations are referred to appendix  [ append : bit - phase - error - povms ] .",
    "the povm element corresponding to the bit error in the pair of pulses @xmath131 for @xmath132 is defined as @xmath133 \\end{split}\\nonumber\\\\ = & \\frac{2}{{\\lvert\\mathcal{r}\\rvert}}\\sum_{s_i , s_j\\in\\{0 , 1\\}}\\hat{p}\\left(\\hat{h}\\ket{s_i}_{\\textrm{a } , i}\\right)\\hat{p}\\left(\\hat{h}\\ket{s_j}_{\\textrm{a } , j}\\right)\\otimes\\hat{e}_{i , s_i\\oplus s_j\\oplus1}^{(j - i)}. \\label{defi : ebitpovm_ij}\\end{aligned}\\ ] ] here , @xmath1 denotes the cardinality of the set @xmath41 , and we use eq .   in the last equality .",
    "note that we omit identity operators on the subsystems .",
    "next , the povm element for a phase error is defined by the instances where alice and bob measure their qubits with the hadamard basis @xmath134 and their outcomes disagree . the povm element corresponding to the occurrence of the phase error in the pair of pulses @xmath131 for @xmath132",
    "is given by @xmath135 \\end{split}\\nonumber\\\\ \\begin{split } = & \\frac{1}{{\\lvert\\mathcal{r}\\rvert}}\\left[\\hat{p}\\left(\\ket{0}_{\\textrm{a } , i}\\ket{1}_{\\textrm{a } , j}\\right)\\otimes\\hat{p}\\left(\\ket{i}_\\textrm{b}\\right)\\right.\\\\ & \\left.+\\hat{p}\\left(\\ket{1}_{\\textrm{a } , i}\\ket{0}_{\\textrm{a } , j}\\right)\\otimes\\hat{p}\\left(\\ket{j}_\\textrm{b}\\right)\\right ] \\end{split}\\nonumber\\\\ & + \\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{t=0}^1\\hat{p}\\left(\\ket{t}_{\\textrm{a } , i}\\ket{t}_{\\textrm{a } , j}\\right)\\otimes\\left[\\hat{p}\\left(\\ket{i}_\\textrm{b}\\right)+\\hat{p}\\left(\\ket{j}_\\textrm{b}\\right)\\right ] , \\label{defi : ephpovm_ij}\\end{aligned}\\ ] ] where @xmath136 .",
    "for simplicity of analysis , we introduce a unitary operator @xmath137 acting on @xmath138 defined by @xmath139 by using @xmath137 and eq .  , it is straightforward to show that @xmath140 since @xmath137 also satisfies @xmath141 we have @xmath142\\nonumber\\\\ & \\otimes\\left[\\hat{p}(\\ket{i}_\\textrm{b})+\\hat{p}(\\ket{j}_\\textrm{b})\\right].\\label{eq : unitary - eph_ij}\\end{aligned}\\ ] ]    for the state @xmath56 of a _ detected _ event , the probability of having a bit error in the extracted qubit pair @xmath143 and @xmath144 is expressed by @xmath145 , while a phase error is given by @xmath146 , where @xmath147 and @xmath148 are respectively given by @xmath149 by applying @xmath137 to @xmath147 in eq .   and using eq .  , we have @xmath150 where the matrix elements of @xmath151 are @xmath152 by applying @xmath137 to @xmath148 , using eq .   and @xmath153 with @xmath154 and @xmath155 , @xmath156 results in the following form .",
    "@xmath157      in this subsection , we derive the upper bound on @xmath126 in eq .   by using the bit error rate . for this",
    ", we first derive the range where alice s sending state can be contained . in the virtual protocol ,",
    "if the initial state @xmath118 satisfies @xmath158 for a state @xmath159 , the density operator @xmath56 of aq and bq originating from @xmath118 also satisfies @xmath160 .",
    "moreover , we have the following relations between @xmath161 and @xmath100 such that @xmath158 is satisfied  @xcite , @xmath162 where @xmath163 denotes the number of 1 s in the bit string @xmath161 .    by using eqs .   and  , @xmath56 after alice obtains @xmath100 by measuring the system c",
    "is contained in the range of a projection operator @xmath164 , which is defined by @xmath165    next , to derive the relation between the bit and phase error rates , we consider the quantity @xmath166 defined as the largest eigenvalue of the operator @xmath167 in the range of @xmath164 with @xmath168 . by using @xmath166 , the phase error rate @xmath130 when alice emits @xmath100 photons",
    "is bounded by the bit error rate @xmath169 when alice emits @xmath100 photons as  @xcite @xmath170 since eq .",
    "for various @xmath168 determines a convex achievable region of @xmath171 and @xmath172 is monotonically increasing , we obtain the convex achievable region of @xmath173 specified by @xmath174 for various @xmath175 . here",
    ", @xmath176 is the quantity depending on @xmath177 and @xmath166 .    in order to derive an upper bound on the leaked information @xmath126 in eq .",
    ", we consider the optimization of @xmath128 such that eve s information is maximal .",
    "since @xmath178 is the number of qubits extracted in the step ( v5 ) from the _ detected _ events when alice emits @xmath100 photons , @xmath128 needs to satisfy the following physical requirement regarding the number of total events when alice emits @xmath100 photons @xmath179 where @xmath180 denotes the poisson distribution with mean @xmath181 , @xmath182 let @xmath183 be a fraction of _ detected _ events when alice emits @xmath100 photons among all the detection , @xmath184 here , @xmath183 is chosen by eve under the constraint of eq .  .",
    "as long as @xmath185 holds for all @xmath168 , eve can maximize the amount of leaked information by using the events with a larger value of @xmath100 .",
    "therefore , the optimal strategy for eve is the following choice : @xmath186 where @xmath187 is the integer satisfying @xmath188 by using @xmath189 and eq .",
    ", the upper bound on @xmath126 in eq .   is written as @xmath190 where @xmath191 is the bit error rate in the actual protocol .",
    "the task left to obtain the upper bound on @xmath126 is to evaluate the quantities @xmath166 for @xmath192 . in our analysis , we consider the upper bounds on @xmath166 for @xmath193 , and for @xmath194 we make a pessimistic assumption that all the information is leaked to eve , that is , @xmath195 . with this consideration , eq .",
    "is upper bounded by @xmath196 with @xmath197 .      to evaluate @xmath166",
    ", we apply the unitary operation @xmath137 in eq .   to eq .  , and we obtain  @xcite @xmath198 here , we use the following equation @xmath199 where @xmath200 since @xmath201 for @xmath202 such that @xmath203 for all @xmath91 , we can neglect the operators with @xmath161 satisfying @xmath204 . therefore , we have only to consider @xmath205 defined as the largest eigenvalue of the operators @xmath206 and @xmath207 defined as the largest eigenvalue of the operators @xmath208 let @xmath209 be the upper bound on the phase error rate when we employ @xmath210 , respectively .",
    "@xmath209 is given by @xmath211 regarding @xmath212 , we have an analytical formula that is given in the following lemma ( see appendix  [ append : lemma2 ] for its proof ) .    if @xmath213 , @xmath214 holds for arbitrary @xmath168 .",
    "[ lem : omegaplus - estimated ]    by applying this lemma to eq .",
    ", we obtain the analytical solution for the upper bound on @xmath215 .",
    "@xmath216 where eq .   is independent of the length @xmath7 of one block .",
    "note that if @xmath217 , lemma  [ lem : omegaplus - estimated ] can not be applied , however , @xmath212 for this case is also easily derived by following the same discussion of the derivation of eq .",
    "( the discussion in appendix  [ append : lemma2 ] covers this situation , for example @xmath218 ) . on the other hand , to derive the upper bound @xmath219 in eq .",
    ", we need to solve the largest eigenvalue of @xmath220 , which is written as @xmath221 to discuss the eigenvalues of eq .",
    ", we recall the fact that the translation operation @xmath222 defined for @xmath202 such that @xmath223 is satisfied for any @xmath224 with specific @xmath225 , @xmath226 does not change the eigenvalues .",
    "hence , the eigenvalues of eq .   with @xmath161 and @xmath227",
    "are the same if there exists @xmath228 ( @xmath229 ) such that @xmath223 is satisfied for any @xmath224 . by using this , for @xmath230 ,",
    "it is enough to consider the case @xmath231 , where the matrix representation of eq .",
    "is written as @xmath232 here , @xmath233 is an @xmath234 matrix satisfying @xmath235    in order to obtain the largest eigenvalue of eq .   for large @xmath7",
    ", we take a numerical approach . for @xmath236 , however , the upper bound on @xmath219 can be easily derived , and we obtain the following theorem for the upper bound on @xmath237 ( see appendix  [ append : theorem1 ] for its proof ) .    for @xmath238 , @xmath239 holds .",
    "also , for @xmath240 , we have @xmath241 [ theo : phase_error_nu=1 ]    for @xmath242 , the upper bound on @xmath130 is derived as the maximum value of the convex combination of the one on @xmath243 and @xmath244 as @xmath245 where @xmath246 is defined by @xmath247    [ cols=\"^ \" , ]     next , we discuss the transmittance dependency of the key generation rates for the snrdps protocol . for this , we assume a fibre - based qkd system , and the detection efficiency @xmath248 is assumed to be @xmath249 . here , @xmath250 denotes the mean photon number of per sending pulse , and @xmath251 denotes channel transmittance with the fibre length @xmath252 as @xmath253 with @xmath254 denoting bob s detection efficiency .",
    "if @xmath255 is small ( @xmath256 ) , @xmath248 and @xmath180 are approximated to @xmath257 and @xmath258 , respectively .",
    "suppose that alice and bob generate the secret key from the @xmath100-photon emissions . in this case , by considering eve s attack , the total detection efficiency @xmath257 minus the probability of emitting more than @xmath259 photons ( approximated to @xmath260 ) has to be positive , resulting in @xmath261 . from this",
    ", we obtain the dependency of @xmath255 over the transmittance as @xmath262 and hence the key generation rate @xmath263 behaves as @xmath264    in fig .",
    "[ fig : keyrate ]  ( a ) , all the lines of the snrdps protocol except for the one with @xmath265 and the one of the rrdps protocol with @xmath266 result in the transmittance dependency as @xmath267 , which means that the secret key is extracted from the two - photon emission events in addition to the single - photon emission events . on the other hand , the line of the original dps protocol and the ones of the rrdps protocol with @xmath268 result in the transmittance dependency as @xmath269 since the upper bound on the phase error rate of the two - photon emission events is too high to extract the secret key .",
    "moreover , the snrdps protocol with @xmath265 and the rrdps protocol with @xmath270 provide the key generation rate of the form @xmath271 for shorter distance and @xmath267 for longer distance .",
    "the implication of this is that when the loss increases , the two - photon contribution becomes larger , and moreover the bit error rate of @xmath13 is still small enough to generate the key from the two - photon emission event . also , in fig .",
    "[ fig : keyrate ]  ( b ) , all the lines of the snrdps protocol except the one with @xmath272 and @xmath273 result in the transmittance dependency as @xmath271 for shorter distance and @xmath267 for longer distance , while all the remaining lines result in the transmittance dependency as @xmath269 .",
    "even when the bit error rate is @xmath4 , the properties of transmittance dependency of the key generation rates including the change of the scaling from the short and the long distance regimes can be explained with the same reason as the ones in fig 5 ( a ) .    finally , fig .",
    "[ fig : light_intensity ]  ( a ) and ( b ) show the optimal mean photon number @xmath274 to realize the key generation rates in fig .  [",
    "fig : keyrate ]  ( a ) and ( b ) , respectively .",
    "for all the protocols , it can be found that the optimal mean photon number scales as @xmath275 for @xmath100-photon emission event , which is the same scaling as eq .  .",
    "also , the discontinuous point of the lines in fig .",
    "[ fig : light_intensity ]  ( a ) and ( b ) , which represents the boundary of the presence or absence of the two - photon contribution , corresponds to the changing point of the scaling of the key generation rates in fig .",
    "[ fig : keyrate ]  ( a ) and ( b ) , respectively .",
    "in conclusion , in this paper , we have proposed a new dps - type qkd protocol with a small random delays at bob s measurement and analyzed its information - theoretical security . for this protocol",
    ", we have estimated an upper bound on the phase error rate for alice s single and two - photon emission events by using the bit error rate information . besides",
    ", we have simulated and compared the key generation rates for the snrdps protocol with @xmath276 , the one for the original dps protocol , and the ones for the rrdps protocol with @xmath277 . as a result",
    ", we found that the performance of the snrdps protocol is significantly enhanced from the original dps protocol even when bob employs only a few number of delays such as @xmath3 .",
    "moreover , we found that if @xmath278 , the key generation rate of the snrdps protocol based on our analysis outperforms the rrdps protocol without monitoring the disturbance  @xcite when the same number of random delays is employed .",
    "the snrdps protocol is an intermediate protocol between the original dps and the rrdps protocols in terms of the practicality and bit error tolerance , and this protocol increases the variety of future implementation for the dps - type qkd protocol .",
    "we thank toshihiko sasaki , hoi - kwong lo , koji azuma , rikizo ikuta , and yuki takeuchi for helpful discussions .",
    "ni acknowledges support from the mext / jsps kakenhi grant number 16h02214 .",
    "this work is in part funded by impact program of council for science , technology and innovation ( cabinet office , government of japan ) .",
    "here , we prove lemma  [ fact : dial - actual - relation ] in the main text .",
    "first , we have that @xmath279 satisfies the following relation @xmath280 this is so because @xmath279 is written as @xmath281 for @xmath32 and @xmath282 for @xmath283 . by using eq .   and regarding @xmath284 if @xmath285 or @xmath286 , we have the following equation .",
    "@xmath287 if we fix the delay of the dial measurement as @xmath81 , the probability that bob obtains the bit value @xmath50 and announces the pair of integers @xmath288 is given by @xmath80}_\\textrm{dial}=&{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{e}_{i , s}^{(r')}\\right)}\\delta_{j - i , r'}\\nonumber\\\\ & + { \\mathrm{tr}\\left(\\hat{\\rho}\\hat{e}_{j , s}^{(r')}\\right)}\\delta_{j - i , l - r'}.\\label{eq : cpr - dial}\\end{aligned}\\ ] ] to simulate the dial measurement with the delay @xmath81 by using bob s actual measurement , he randomly switches the delays of the actual measurement @xmath81 and @xmath83 .",
    "the probability that bob obtains the outcome @xmath50 and announces @xmath131 when he performs the actual measurement is written as @xmath289 if the delay is @xmath81 and @xmath290 if the delay is @xmath83 .",
    "let us define @xmath73}_\\textrm{actual}$ ] as the probability that bob obtains @xmath50 and announces @xmath131 when he performs the actual measurement with the delay @xmath77 or @xmath78 uniformly at random .",
    "@xmath291}_\\textrm{actual}$ ] is written as @xmath292}_\\textrm{actual}\\nonumber\\\\ = & \\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{b}_{i , s}^{(r')}\\right)}\\delta_{j - i , r'}+\\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{b}_{i , s}^{(l - r')}\\right)}\\delta_{j - i , l - r'}\\nonumber\\\\ = & \\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{b}_{i , s}^{(r')}\\right)}\\delta_{j - i , r'}+\\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{b}_{j - l+r ' , s}^{(l - r')}\\right)}\\delta_{j - i , l - r'}\\nonumber\\\\ \\begin{split } = & \\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\left[\\hat{e}_{i , s}^{(r')}-\\hat{b}_{i - l+r ' , s}^{(l - r')}\\right]\\right)}\\delta_{j - i , r'}\\\\ & + \\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\left[\\hat{e}_{j , s}^{(r')}-\\hat{b}_{j , s}^{(r')}\\right]\\right)}\\delta_{j - i , l - r ' } \\end{split}\\nonumber\\\\ \\begin{split } = & \\frac{1}{2}\\left[{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{e}_{i , s}^{(r')}\\right)}\\delta_{j - i , r'}+{\\mathrm{tr}\\left(\\hat{\\rho}\\hat{e}_{j , s}^{(r')}\\right)}\\delta_{j - i , l - r'}\\right]\\\\ & -\\frac{1}{2}{\\mathrm{tr}\\left(\\hat{\\rho}\\left[\\hat{b}_{i - l+r ' , s}^{(l - r')}\\delta_{j - i , r'}+\\hat{b}_{j , s}^{(r')}\\delta_{j - i , l - r'}\\right]\\right ) } \\end{split}\\nonumber\\\\ = & \\frac{1}{2}{\\mathrm{pr}\\left[s\\wedge(i , j)\\middle|r'\\right]}_\\textrm{dial},\\end{aligned}\\ ] ] where we have used eqs .   and   in the third and fifth equalities , respectively .",
    "also , we have used @xmath293 in the fifth equality , which is satisfied since @xmath284 for @xmath294 or @xmath286 , and @xmath131 satisfies @xmath295 .",
    "here , we detail the calculation of the equations of bit and phase error povms .",
    "first , eq .   is derived as follows .",
    "@xmath296\\nonumber\\\\ = & \\frac{1}{{\\lvert\\mathcal{r}\\rvert}}\\sum_{s=0}^1\\sum_{k=1}^3\\hat{m}_k^{(i , j)\\dagger}\\hat{p}\\left(\\hat{h}\\ket{s}_\\textrm{aq}\\right)\\hat{m}_k^{(i , j)}\\otimes\\left[\\hat{f}_i^{(j - i)\\dagger}\\hat{p}\\left(\\hat{h}\\ket{\\bar{s}}_\\textrm{b}\\right)\\hat{f}_i^{(j - i)}+\\hat{f}_j^{(l-(j - i))\\dagger}\\hat{p}\\left(\\hat{h}\\ket{\\bar{s}}_\\textrm{b}\\right)\\hat{f}_j^{(l-(j - i))}\\right]\\nonumber\\\\ = & \\frac{2}{{\\lvert\\mathcal{r}\\rvert}}\\sum_{s=0}^1\\sum_{k=1}^3\\hat{m}_k^{(i , j)\\dagger}\\hat{p}\\left(\\hat{h}\\ket{s}_\\textrm{aq}\\right)\\hat{m}_k^{(i , j)}\\otimes\\hat{\\mathcal{f}}_{i , j}^{\\dagger}\\hat{p}\\left(\\hat{h}\\ket{\\bar{s}}_\\textrm{b}\\right)\\hat{\\mathcal{f}}_{i , j}\\nonumber\\\\ = & \\frac{1}{{\\lvert\\mathcal{r}\\rvert}}\\sum_{s=0}^1\\left[\\hat{p}\\left(\\ket{s}_{\\textrm{a } , i}\\ket{\\bar{s}}_{\\textrm{a } , j}\\right)+\\frac{1}{2}\\sum_{t=0}^1\\hat{p}\\left(\\ket{t}_{\\textrm{a } , i}\\ket{t}_{\\textrm{a } , j}\\right)\\right]\\otimes\\hat{p}\\left(\\delta_{\\bar{s},1}\\ket{i}_\\textrm{b}+\\delta_{\\bar{s } , 0}\\ket{j}_\\textrm{b}\\right)\\nonumber\\\\ = & \\frac{1}{{\\lvert\\mathcal{r}\\rvert}}\\left[\\hat{p}\\left(\\ket{0}_{\\textrm{a } , i}\\ket{1}_{\\textrm{a } , j}\\right)\\otimes\\hat{p}\\left(\\ket{i}_\\textrm{b}\\right)+\\hat{p}\\left(\\ket{1}_{\\textrm{a } , i}\\ket{0}_{\\textrm{a } , j}\\right)\\otimes\\hat{p}\\left(\\ket{j}_\\textrm{b}\\right)\\right]+\\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{t=0}^1\\hat{p}\\left(\\ket{t}_{\\textrm{a } , i}\\ket{t}_{\\textrm{a } , j}\\right)\\otimes\\left[\\hat{p}\\left(\\ket{i}_\\textrm{b}\\right)+\\hat{p}\\left(\\ket{j}_\\textrm{b}\\right)\\right].\\end{aligned}\\ ] ]    here , we define @xmath297 and @xmath298 .",
    "next , we detail the derivation of eq .   as follows .",
    "@xmath151 in eq .",
    "is written as @xmath299 \\end{split}\\nonumber\\\\ = & \\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{(m , n):{\\lvertm - n\\rvert}\\in\\mathcal{r}}\\left[\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)-\\ket{m}_\\textrm{b}{}_\\textrm{b}\\bra{n}\\right]\\nonumber\\\\ = & \\frac{1}{2}\\hat{1}_\\textrm{b}-\\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{(m , n):{\\lvertm - n\\rvert}\\in\\mathcal{r}}\\ket{m}_\\textrm{b}{}_\\textrm{b}\\bra{n},\\end{aligned}\\ ] ] which concludes eq .  .    finally , we detail transformation in eq .   as follows .",
    "@xmath300\\\\ & \\otimes\\left[\\hat{p}(\\ket{i}_\\textrm{b})+\\hat{p}(\\ket{j}_\\textrm{b})\\right ] \\end{split}\\nonumber\\\\ = & \\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{(m , n):{\\lvertm - n\\rvert}\\in\\mathcal{r}}\\left[\\hat{p}(\\ket{1}_{\\textrm{a } , m})+\\hat{p}(\\ket{1}_{\\textrm{a } , n})\\right]\\otimes\\hat{p}(\\ket{m}_\\textrm{b})\\nonumber\\\\ = & \\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{(m , n):{\\lvertm - n\\rvert}\\in\\mathcal{r}}\\sum_{\\vec{a}}\\hat{p}\\left(\\ket{\\vec{a}}_\\textrm{a}\\right)\\left(\\delta_{a_m , 1}+\\delta_{a_n , 1}\\right)\\otimes\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)\\nonumber\\\\ \\begin{split } = & \\sum_{\\vec{a}}\\hat{p}\\left(\\ket{\\vec{a}}_\\textrm{a}\\right)\\\\ & \\otimes\\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{m=1}^l\\sum_{n:{\\lvertm - n\\rvert}\\in\\mathcal{r}}\\left(\\delta_{a_m , 1}+\\delta_{a_n , 1}\\right)\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right ) \\end{split}\\nonumber\\\\ \\begin{split } = & \\sum_{\\vec{a}}\\hat{p}\\left(\\ket{\\vec{a}}_\\textrm{a}\\right)\\\\ & \\otimes\\sum_{m=1}^l\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)\\left(\\frac{1}{2}\\delta_{a_m , 1}+\\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\sum_{n:{\\lvertm - n\\rvert}\\in\\mathcal{r}}\\delta_{a_n , 1}\\right ) \\end{split}\\nonumber\\\\ = : & \\sum_{\\vec{a}}\\hat{p}\\left(\\ket{\\vec{a}}_\\textrm{a}\\right)\\otimes\\hat{\\pi}_{\\vec{a}}^{(\\textrm{ph})}.\\end{aligned}\\ ] ]",
    "here , we prove lemma  [ lem : omegaplus - estimated ] in the main text .",
    "we consider the maximization of the largest eigenvalue of @xmath301 in eq .   over @xmath161 with @xmath302 .",
    "by using eq .",
    ", @xmath301 is written as @xmath303 \\end{split}\\nonumber\\\\ \\begin{split } = & \\sum_{m : a_m=1}\\left\\{\\frac{1-\\lambda}{2}\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)\\right.\\\\ & \\left.+\\sum_{n:{\\lvertm - n\\rvert}\\in\\mathcal{r}\\wedge a_n=1}\\left[\\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)+\\frac{\\lambda}{2{\\lvert\\mathcal{r}\\rvert}}\\ket{m}_\\textrm{b}{}_\\textrm{b}\\bra{n}\\right]\\right\\ } \\end{split}\\nonumber\\\\ = & \\sum_{m : a_m=1}\\frac{1-\\lambda}{2}\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)\\nonumber\\\\ & + \\sum_{\\substack{(m , n):\\\\{\\lvertm - n\\rvert}\\in\\mathcal{r}\\wedge(a_m , a_n)=(1 , 1)}}\\left[\\frac{1}{2{\\lvert\\mathcal{r}\\rvert}}\\hat{p}\\left(\\ket{m}_\\textrm{b}\\right)+\\frac{\\lambda}{2{\\lvert\\mathcal{r}\\rvert}}\\ket{m}_\\textrm{b}{}_\\textrm{b}\\bra{n}\\right ] .",
    "\\label{eq : operator - omegaplus}\\end{aligned}\\ ] ] since @xmath119 , the coefficient of @xmath304 for @xmath305 such that @xmath306 in eq .",
    "is written as @xmath307 here , @xmath308 denotes the number of @xmath309 satisfying the condition @xmath310 , and @xmath311 denotes subtraction modulo @xmath7 , namely , for integers @xmath64 with @xmath65 and @xmath66 , @xmath312 also , the coefficient of @xmath313 for @xmath314 such that @xmath315 in eq .   is written as @xmath316 next , we classify @xmath161 in terms of the resulting eigenvalues of eq .  .",
    "in so doing , note that the translation operation ( as this is a unitary operator ) defined by eq .   does not change the eigenvalues of eq .  .",
    "hence , the eigenvalues of eq .   with @xmath161 and @xmath227",
    "are the same if there exists @xmath228 ( @xmath229 ) such that @xmath223 is satisfied for any @xmath224 and hence it is suffice to consider @xmath317=\\{\\vec{a}'\\mid\\exists\\kappa\\in\\{1,\\dots , l\\}\\textrm { s.t . }",
    "a'_{k+_l\\kappa}=a_k\\textrm { for } \\forall k\\in\\{1,\\dots , l\\}\\}$ ] to derive the eigenvalues of eq .  .",
    "in order to characterize @xmath161 , we introduce an @xmath318-length vector @xmath319 that satisfies @xmath320 by using @xmath321 , we can convert the problem of deriving the largest eigenvalue of eq .   to the maximization problem of the largest eigenvalue of the following matrix .",
    "@xmath322 here , @xmath323 denotes the @xmath324 identity matrix and @xmath325 denotes the @xmath324 matrix whose diagonal element @xmath326 is given by @xmath327 and its off - diagonal element @xmath328 ( @xmath329 ) is given by @xmath330 among @xmath331 $ ] , we need to find @xmath161 that achieves the largest eigenvalue of eq .  . for this",
    ", we use the following fact .    for any real matrix with non - negative off - diagonal elements ,",
    "the largest eigenvalue is maximized when all the matrix elements are maximized .",
    "[ fact : maximized - matrix - form ]    _ proof .",
    "_ we consider two @xmath234 real matrices @xmath332 and @xmath333 such that @xmath334 holds for any @xmath335 and @xmath336 holds if @xmath337 .",
    "suppose that @xmath338 and @xmath339 are normalized eigenvectors of @xmath340 and @xmath341 that give the largest eigenvalue of @xmath340 and @xmath341 , respectively .",
    "since both @xmath340 and @xmath341 are real and all the off - diagonal elements of @xmath340 and @xmath341 are non - negative , we can choose @xmath342 and @xmath343 such that all the elements of @xmath342 and @xmath343 are real and non - negative . by using @xmath342 and @xmath343 , the largest eigenvalue of @xmath340 and @xmath341",
    "are respectively given by @xmath344 since @xmath334 holds for any @xmath335 and @xmath342 gives the largest eigenvalue of @xmath340 , we have @xmath345 which ends the proof .    by using fact  [",
    "fact : maximized - matrix - form ] , the largest eigenvalue of eq .",
    "is obtained when @xmath346 for all @xmath347 , namely , @xmath348 in eq .  .",
    "for example , if @xmath230 and @xmath3 , eq .   with @xmath349",
    "is rewritten as @xmath350 and this results in the largest eigenvalue of eq .  , which corresponds to @xmath351 for @xmath352 .",
    "moreover , if @xmath353 , eq .   with @xmath348 is rewritten as @xmath354 where @xmath355 denotes the @xmath324 matrix whose elements are given by @xmath356 eq .",
    "has only two eigenvalues : @xmath357 and @xmath358 . since @xmath168",
    ", we have @xmath359 which concludes eq .  .",
    "here , we prove theorem  [ theo : phase_error_nu=1 ] in the main text . in order to maximize @xmath360",
    ", we derive an upper bound on @xmath361 . for this",
    ", we consider the largest eigenvalue of @xmath220 for @xmath362 , namely , @xmath363 .",
    "since @xmath364 , @xmath365 is given by the largest eigenvalue of @xmath366 , which is non - positive .",
    "hence , @xmath360 is upper bounded by @xmath367 . for @xmath368 , from eq .  , we obtain @xmath369 for @xmath370 . also , for @xmath371 , @xmath237 is upper bounded by @xmath372 by choosing @xmath373 in eq .   as @xmath374 .",
    "therefore , by combining eqs .   and  , we conclude eq .  ."
  ],
  "abstract_text": [
    "<S> the differential - phase - shift ( dps ) quantum key distribution ( qkd ) protocol was proposed aiming at simple implementation , but it can tolerate only a small disturbance in a quantum channel . </S>",
    "<S> the round - robin dps ( rrdps ) protocol could be a good solution for this problem , which in fact can tolerate even up to @xmath0 of a bit error rate . </S>",
    "<S> unfortunately , however , such a high tolerance can be achieved only when we compromise the simplicity , _ i.e. _ , bob s measurement must involve a large number of random delays ( @xmath1 denotes its number ) , and in a practical regime of @xmath1 being small , the tolerance is low . in this paper , we propose a new dps protocol to achieve a higher tolerance than the one in the original dps protocol , in which the measurement setup is less demanding than the one of the rrdps protocol for the high tolerance regime . </S>",
    "<S> we call the new protocol the small - number - random dps ( snrdps ) protocol , and in this protocol , we add only a small amount of randomness to the original dps protocol , _ </S>",
    "<S> i.e. _ , @xmath2 . </S>",
    "<S> in fact , we found that the performance of the snrdps protocol is significantly enhanced over the original dps protocol only by employing a few additional delays such as @xmath3 . </S>",
    "<S> also , we found that the key generation rate of the snrdps protocol outperforms the rrdps protocol without monitoring the bit error rate when it is less than @xmath4 and @xmath5 . </S>",
    "<S> our protocol is an intermediate protocol between the original dps protocol and the rrdps protocol , and it increases the variety of the dps - type protocols with quantified security . </S>"
  ]
}