{
  "article_text": [
    "type ia supernovae ( sne  ia ) have been used as `` standard candles '' to estimate the distance to galaxies in cosmology .",
    "@xcite found a significant correlation between their absolute magnitude at maximum , @xmath0 , and decay rate , and proposed that a better distance indicator can be obtained by calibrating it . as well as the decay rate , the observed color also exhibits a clear correlation with @xmath0 .",
    "this is mainly due to the interstellar extinction in both their host and our galaxies , while it is proposed that there is a variation in the intrinsic color of sne  ia at maximum ( @xcite ) .",
    "in addition to these two , a number of variables have been proposed as explanatory variables of @xmath0 .",
    "they are , for example , the equivalent widths , velocities , or depths of absorption lines , or their ratios ( for a review , see @xcite ) .",
    "the search for a good set of variables , in other words , the `` model , '' have recently been intensified including arbitrary ratios of the fluxes in spectra . using the 58 objects observed by nearby supernova factory , @xcite report that the model with a single ratio of the flux at 642  nm to that at 443  nm , hereafter @xmath1 , has a smaller residual of @xmath0 than the classical model with the color and decay rate ( , or light - curve width ) . using 26 objects observed by the cfa supernova program ,",
    "@xcite confirm the conclusion in @xcite with a slightly different ratio , @xmath2 , although the improvement of the model has low significance .",
    "in addition , they propose another model with the color and the color - corrected flux ratio , @xmath3 at @xmath4 from maximum light .",
    "@xcite , using 62 object observed by the berkeley supernova  ia program , report that the best set of variables is the light - curve width , color , and @xmath5 . on the other hand",
    ", their analysis did not confirm the results in @xcite and @xcite .",
    "thus , the resulting models of each work are not completely consistent , and the model for the prediction of @xmath0 has not been established .    in previous studies , a linear regression model of @xmath0 has been assumed : @xmath6 where @xmath7 is the absolute magnitude in the @xmath8-band , which has been conventionally used in past studies .",
    "@xmath9 is a constant .",
    "the vector , @xmath10 is a set of explanatory variables of @xmath7 .",
    "the elements in @xmath11 are , for example , the color , decay rate ( , or light - curve width ) , and variables about the lines .",
    "@xmath12 is the vector of their coefficients .",
    "suppose that @xmath13 samples of sne  ia are available , and the observations are summarized as @xmath14 , where @xmath15 and @xmath16 .",
    "the goal of the study is to find an appropriate set of variables in @xmath11 for the prediction of @xmath17 .",
    "we prefer the model to have a small generalization error for the prediction of @xmath17 .",
    "if @xmath18 , it is possible to estimate the values of all elements in @xmath19 with the least - square method .",
    "however , the risk of over - fitting increases as @xmath20 becomes smaller .",
    "furthermore , the least - square method can not determine a unique model when @xmath21 .",
    "such a situation can appear when arbitrary flux ratios in spectra are included into @xmath22 .",
    "hence , previous studies included only one or two flux ratios in a model , and search for the best set of the variables for the observations .    finding an appropriate set of variables to describe @xmath7 of sne",
    "ia is a variable selection problem , which has been studied in the field of statistics and machine learning . in this paper , we report a result of variable selection approach applied for @xmath7 .",
    "we controlled the generalization error with a regularization term , whose size is chosen via cross - validation , and a subset of the variables are selected from @xmath23 components by least absolute shrinkage and selection operator , or the so - called , lasso method ( @xcite ) .",
    "this method can find the unique solution even in the case of @xmath21 . in section  2 ,",
    "we describe the method . in section  3",
    ", we report on the results of our experiments .",
    "we apply our method to the data provided by the berkeley supernova database . in section  4",
    ", we discuss the implication of our results , and summarize our findings .",
    "here , we consider a linear regression model , @xmath24 , where @xmath22 is a given real @xmath25 matrix and @xmath26 is a gaussian noise with @xmath27=\\bm{0}$ ] and @xmath28=\\sigma^2i_n$ ] . our goal is to find an appropriate set of variables from @xmath23 variables and @xmath13 samples and compute the corresponding coefficients of @xmath19 .",
    "for this sort of estimation problems , @xcite proposed a method , least absolute shrinkage and selection operator , or the so - called , lasso , for selecting the best set of explanatory variables .",
    "lasso provides a solution @xmath29 by minimizing the following function which includes the @xmath30-norm of @xmath19 as a regularization term @xmath31 where @xmath32 is the @xmath30-norm , defined as @xmath33 , and @xmath34 is a tunable constant .",
    "the estimate @xmath29 includes @xmath35 components , that is , variables selection is realized with lasso - type estimation .",
    "the number of @xmath35 components increases as @xmath34 becomes larger .",
    "we apply the lasso - type estimation in order to select an appropriate model to predict @xmath7 of sne  ia . the data , @xmath17 , is @xmath7 and each column of @xmath22 corresponds to an observed variables , such as , the color , light - curve width , and variables about spectra .",
    "recent projects have provided high - quality and uniform samples of sne  ia in both photometric and spectroscopic data .",
    "the number of available samples , @xmath13 , is now @xmath36 .",
    "the number of candidate explanatory variables can be @xmath37 if arbitrary flux ratios are included .",
    "however , we can expect that the number of effective variables is small .",
    "in other words , our interest focuses on a model in which @xmath7 is explained not with @xmath38 , but with only a few variables of @xmath11 .",
    "exhaustive search for every subset of candidate variables is not tractable , and the lasso - type estimation gives us a data - driven approach to select the best subset of variables for the data - set .",
    "the cost function for the estimation expressed in equation  ( 2 ) contains a tunable parameter , @xmath34 .",
    "this parameter controls the weight of the regularization term , which has an influence on the generalization error .",
    "we choose the best @xmath34 by the cross - validation method . in the @xmath39-fold cross - validation ,",
    "the data is divided into @xmath39 roughly equal sub - samples , @xmath40 ( @xmath41 ) . for each @xmath42 ,",
    "the training data is defined as all the @xmath43 sub - samples except for the validation data , @xmath40 .",
    "the optimization of the model to the training data gives @xmath44 at a certain @xmath34 .",
    "the generalization error of the model is evaluated with the mean of weighted mean square errors ( wmse ; @xmath45 ) of the @xmath39 sub - samples ; @xmath46 where @xmath47 is the number of the validation data , @xmath40 , and @xmath48 is the measurement error of the @xmath49-th element in @xmath40 .    in a very large @xmath34 regime ,",
    "the least - square term is large , and thereby @xmath45 also becomes large . in a very small @xmath34 regime ,",
    "on the other hand , the model can reproduce the noise in the data ( over - fitting ) , and thereby have a large generalization error , and eventually lead to a large @xmath45 .",
    "thus , we can find the minimum value of @xmath45 at a certain @xmath34 .",
    "the best model can be considered as the simplest model whose @xmath45 is within one standard error of the minimal @xmath45 .",
    "this is the so - called `` one standard error rule '' .",
    "models having @xmath34 smaller than the best one are statistically indistinguishable from the over - fitting situation . in this paper",
    ", we use this rule to select @xmath34 , and set @xmath50 .",
    "another common variable selection scheme is to use an information criterion , such as akaike information criterion ( aic ) or bayesian information criterion ( bic ) .",
    "we employed the regularization term and the cross - validation because we expect not only the observation noise @xmath26 but also the measurement errors in @xmath22 , and we do not have a good model selection criterion for this situation .",
    "the measurement error of @xmath7 is occasionally quite small , an order of 0.01  mag . on the other hand",
    ", the error of the elements in @xmath22 can be large .",
    "for example , a ratio between low fluxes can have a large error .",
    "we performed simple simulations of the lasso - type estimation for the current problem .",
    "the vector , @xmath19 , was set to be a sparse vector , containing only three non - zero values in @xmath23 elements .",
    "we set three cases : @xmath51 , @xmath52 , and @xmath53 .",
    "the matrix , @xmath22 , was set to be a @xmath25 matrix whose elements were random values generated by @xmath54 , a normal distribution with a mean of @xmath35 and variance of @xmath55 .",
    "we set @xmath56 in all cases .",
    "then , we calculated the data vector , @xmath57 , and added noise , @xmath58 , @xmath59 , where @xmath60 represents the standard deviation of observation noise . here , we assumed a small error in @xmath17 because @xmath7 is occasionally determined with such a high precision .",
    "we also added noise in the elements of @xmath22 , @xmath61 , @xmath62 , and generated @xmath63 .",
    "we assumed small and large errors in @xmath22 , that is , @xmath64 and @xmath65 .",
    "we estimated @xmath19 from @xmath17 and @xmath63 using the @xmath30-norm minimization .",
    "the best model and its @xmath34 were determined by cross - validation .",
    "the results are shown in figure  [ fig : demo ] . in the case of the small @xmath66 , the assumed @xmath19 , indicated by the red points ,",
    "are successfully reconstructed in all @xmath23 cases , albeit with a @xmath67@xmath68% systematic bias . in the case of the large @xmath66 ,",
    "all non - zero elements in @xmath19 are detected in the cases of @xmath51 and @xmath52 , while their coefficients are significantly underestimated and weak false signals are also seen . in the case of @xmath69 ,",
    "the assumed weak signal is lost in the reconstruction , and false signals have large coefficients .",
    "this experiment demonstrated two important points about the proposed method .",
    "first , it can reconstruct the original vector even with the case of @xmath21 .",
    "second , even with this method , we can not avoid detecting false signals which are coincidentally fit the data in the case of a large @xmath23 .",
    "the latter point could have a significant implication for using the arbitrary flux ratios in the current problem .",
    "the number of the flux ratios is more than 17000 , while the number of samples is @xmath70 .",
    "hence , we should reduce the number of columns in @xmath22 in order to avoid detecting the false signals . in this paper , as described in the next subsection , we use two kinds of spectra normalized by the continuum level and by the total flux .",
    "lasso tends to underestimate the coefficients if the measurement error of the target variable is not negligible , as can be seen in figure  [ fig : demo ] .",
    "hence , it should be used to select the best set of variables .",
    "then , the model of @xmath7 can be obtained by a refit to the data with the selected variables . in this paper",
    ", we focus on variable selection .",
    "we used the data from supernova database provided by berkeley supernova ia programhttp://hercules.berkeley.edu / database / index_public.html@xmath71 .",
    "our sample selection was based on the criteria in @xcite : the redshift of the sample ranged from 0.01 to 0.1 .",
    "we used the spectral data from 3500 to 8500  . the rest - frame days relative to the maximum",
    "is ranged from @xmath72 to @xmath73 .",
    "we used the spectrum having the smallest value of the rest - frame days relative to the maximum for each object in the case that multiple spectra were available .",
    "we only used samples having the color parameter , @xmath74 , less than 0.5 .",
    "we found two type  iax objects , sn  2003gq and 2005hk in the sample , and excluded them ( @xcite ) . as a result",
    ", we found 78 objects in the database .",
    "the available data contains , for example , the redshift , @xmath75 , light - curve width , @xmath76 , color , @xmath74 , apparent magnitude , @xmath77 , and spectra .",
    "as mentioned in section  1 , it is believed that @xmath76 and @xmath74 are important explanatory variables for @xmath7 .",
    "we calculated @xmath7 from @xmath77 and @xmath75 by adopting the standard @xmath78 cold dark matter cosmology with @xmath79 , @xmath80 , and @xmath81 .",
    "the calibration of the spectral data was performed in the standard manner : the flux was corrected for the reddening in our galaxy using @xmath82 .",
    "we used the @xmath82 values obtained from the supernova database , which refers to @xcite and @xcite .",
    "the red - shift correction was performed on the wavelength .",
    "then , the spectra were divided into 134  bins which were equally spaced in the logarithmic velocity scale between 3500 and 8500   , as in @xcite .",
    "we calculated the arbitrary flux ratios using the binned spectra .",
    "the number of the ratios is then @xmath83 .    including arbitrary flux ratios",
    "may provide an exhaustive search for an appropriate set of explanatory variables of @xmath7 . however , the number of candidate variables is so large that false signals can be detected , as demonstrated in the last subsection .",
    "hence , we need to consider other sets of candidate variables which are related to the flux ratios , but have much smaller dimension . in this paper",
    ", we use two kinds of normalized spectra .",
    "first , the variables of the most interest are the flux ratios of the line areas to the continuum level .",
    "indeed , most of previously proposed ratios are such variables : @xmath84 feii / continuum ( @xcite ) , @xmath85 feii / continuum , @xmath86 continuum / sii , and @xmath87 continuum / feii ( @xcite ) . they can be substituted by the spectra normalized by the continuum level .",
    "the continuum level was approximated by a cubic smoothing spline fitted to masked spectra .",
    "the mask is depicted in figure  [ fig : cont ] with the binned spectra of a typical sample , sn  2006et .",
    "the data points indicated by the filled circles were used to calculate the continuum curve .",
    "in addition , the points with the maximum flux in each shaded area were also used .",
    "the several examples of the continuum - normalized spectra are shown in the lower panel of figure  [ fig : sample ] .",
    "we call the set of the continuum - normalized spectra as @xmath88 .",
    "second , the local colors in the continuum which may have independent information of the broadband colors are also variables of interest .",
    "they can be substituted by the spectra normalized by the total flux between 3500 and 8500   .",
    "we call the set of this total flux normalized spectra as @xmath89 .",
    "the intrinsic color can be bluer than the observed one because of the interstellar reddening effect in the host galaxy .",
    "in previous studies , the color correction for this effect has been performed by assuming that all sne  ia have the same intrinsic color .",
    "we also performed this correction using the sne  ia color - law for the salt2 data ( @xcite ) .",
    "the color - corrected spectra is , then normalized by the total flux , and named @xmath90 .",
    "we include those two kinds of normalized spectra , @xmath91 or @xmath92 as the candidates , instead of the arbitrary flux ratios .",
    "in addition , we use the flux in the logarithmic scale in order to include the information of arbitrary flux ratios .",
    "we can identify a good flux - ratio parameter by searching for the two fluxes having the similar coefficients with the opposite sign : @xmath93 .",
    "figure  [ fig : sample ] shows examples of the spectra that are normalized by the total flux ( @xmath89 , the upper panel ) and by the continuum ( @xmath88 , the lower panel ) .        as well as @xmath76 , @xmath74 , @xmath88 , @xmath89 , and @xmath90 , we include previously proposed flux - ratios , @xmath94 into the model as candidate explanatory variables for @xmath7 .",
    "we consider six flux - ratios proposed in @xcite , @xcite , and @xcite , that is , @xmath95 @xmath96 .",
    "the flux ratios which are calculated from the color - corrected spectra , @xmath90 , are called as @xmath97 .",
    "@xcite presents tables of measured values of the lines : caii h&k and near - infrared triplet , siii 4000 , 5972 , and 6355   , mgii , feii , sii `` w , '' and oi triplet .",
    "we can use pew , delta pew ( i.e. , the measured pew subtracted by the template evolution ) , velocity ( @xmath98 ) , line depth ( @xmath99 ) , and fwhm for the explanatory variables .",
    "we note that those line variables are incomplete for our sample .",
    "hence , the number of samples reduces when those line variables are used as the candidate variables , and we used them element by element .",
    "we represent a set of the line values as @xmath100 .",
    "for example , @xmath101 means those variables of siii 4000 .    for the optimization of the model to the data , we used the ` glmnet ` package for ` r`.http://www.r - project.org/@xmath71 the selection of @xmath34 was performed using the function for the cross - validation , ` cv.glmnet ` , adopting the one - standard error rule .",
    "the cross - validation is based on random sub - sampling and the selected variables might be influenced by it .",
    "we performed @xmath53 experiments for each model , and calculated the selection probability , @xmath102 , of each variable . in this paper , we discuss selected variables only with @xmath103 .",
    "each column in @xmath22 was normalized to have zero mean and unit variance , by a linear scaling , @xmath104 , where @xmath105 and @xmath106 are the mean and standard deviation of the @xmath107-th column .",
    "we need this normalization to compare the coefficients , @xmath19 , of variables having different units . *",
    "the list of objects and explanatory variables used in this paper is available as an online supplement material . *",
    "[ cols= \" < , > , > , > , > , > \" , ]     , g. , adam , g. , antilogus , p. , astier , p. , bacon , r. , bongard , s. , bonnaud , c. , copin , y. , et  al .",
    "2002 , in survey and other telescope technologies and discoveries , ed .",
    "j.  a. tyson , & s. wolff vol .",
    "4836 of society of photo - optical instrumentation engineers ( spie ) conference series , pp 6172"
  ],
  "abstract_text": [
    "<S> we discuss what is an appropriate set of explanatory variables in order to predict the absolute magnitude at the maximum of type  ia supernovae . in order to have a good prediction , </S>",
    "<S> the error for future data , which is called the `` generalization error , '' should be small . </S>",
    "<S> we use cross - validation in order to control the generalization error and lasso - type estimator in order to choose the set of variables . </S>",
    "<S> this approach can be used even in the case that the number of samples is smaller than the number of candidate variables . </S>",
    "<S> we studied the berkeley supernova database with our approach . </S>",
    "<S> candidates of the explanatory variables include normalized spectral data , variables about lines , and previously proposed flux - ratios , as well as the color and light - curve widths . as a result , we confirmed the past understanding about type  ia supernova : i )  the absolute magnitude at maximum depends on the color and light - curve width . </S>",
    "<S> ii )  the light - curve width depends on the strength of siii . </S>",
    "<S> recent studies have suggested to add more variables in order to explain the absolute magnitude . </S>",
    "<S> however , our analysis does not support to add any other variables in order to have a better generalization error . </S>"
  ]
}