{
  "article_text": [
    "starting from the breakthrough article of andersen  @xcite many schemes have been proposed to modify the newton equations of motion so as to perform molecular dynamics ( md ) in the isothermal - isobaric ensemble , where the number of particles , the external pressure and the external temperature ( @xmath0 ) are fixed .",
    "most of these schemes are based on an extended - lagrangian formulation . before proceeding to overview the details of the extended system method ,",
    "it is better to separate two issues : pressure and temperature control . within andersen s framework the control of pressure",
    "was achieved by adding to the hamiltonian auxiliary dynamical variables , which represented the volume @xmath1 and its conjugate momentum .",
    "the resulting configurations were sampled from the @xmath2 ensemble , where the enthalpy @xmath3 was constant .",
    "this approach has been further extended to allow anisotropic variation of the cell shape and size.@xcite several almost - equivalent schemes have been proposed , with similar performance and similar parameters , often in combination with different thermostats ( see e.g.  refs .  ) .    in the andersen work ,",
    "the temperature was regulated by additional stochastic collisions , leading to a sampling of the @xmath0 ensemble .",
    "the idea underlying the andersen s thermostat was thus similar to the use of monte carlo , and inherited from monte carlo the characteristic weak points such as discontinuity of the trajectories , lack of a conserved quantity , at least in the original formulation , and artifacts in the computation of dynamical properties .",
    "another intrinsic disadvantage of the algorithm due to its stochastic nature was the not - reproducibility of the trajectory , unless the same random number generator was employed .    in subsequent refinements ,",
    "the nos - hoover deterministic thermostat  @xcite replaced the stochastic one .",
    "for this purpose , a new auxiliary variable was introduced , playing the role of a friction on the particles and/or on the cell dynamics and controlling the temperature .",
    "this method allowed for the definition of a conserved quantity , crucial to check the integration accuracy .",
    "however , a weak point was that the time - evolution of the kinetic energy was described by a second - order differential equation , resulting in an algorithm which is inefficient for equilibration .",
    "even worst , the lack of ergodicity provided a poor control on the temperature in difficult cases such as harmonic solids and , in general , systems with normal modes.@xcite thermostat chains suggested in ref .   partially solved these problems , however at the price of a more complex formulation and a larger number of parameters .",
    "a possible alternative to the deterministic thermostat is stochastic langevin dynamics.@xcite its combination with extended - system control of the pressure , the so - called langevin piston scheme,@xcite was proven to be efficient and ergodic even in difficult cases .",
    "the lack of a conserved quantity has been a traditional drawback of stochastic md , which was however recently solved.@xcite however , it is worth noting that the choice of the friction drastically influences the dynamics and , indirectly , the sampling efficiency .",
    "on the one hand , a too small friction coefficient may cause a very long equilibration time . on the other hand ,",
    "a too large friction coefficient may induce strong perturbations of the system dynamics hindering the exploration of the phase space .",
    "a further possibility for temperature and pressure control is the deterministic scheme suggested by berendsen _",
    "et al_.@xcite this scheme is not based on an extended lagrangian , and the volume of the simulation box is driven by the difference between the internal pressure and the target one .",
    "similarly , the kinetic energy is driven by its deviation from the target one .",
    "the algorithm is intuitive , easy to implement and efficient in the equilibration phase .",
    "unfortunately it can not be used when the correct distribution is required ( e.g.  when fluctuations have to be calculated ) , since it does not sample the @xmath0 ensemble .",
    "moreover , in difficult cases the berendsen scheme systematically transfers energy to the slowest degrees of freedom and can lead to wrong results.@xcite hence the `` common wisdom '' suggests that the initial equilibration should be carried out with the berendsen scheme , while the ensemble averages should be calculated from the subsequent runs performed with an extended - system method .    in a recent paper@xcite we proposed a thermostat which can be regarded as a stochastic version of the berendsen scheme .",
    "similarly to the nos - hoover scheme,@xcite it is a global thermostat , in the sense that it acts only on the total kinetic energy of the system , and produces configurations in the canonical ensemble .",
    "in addition , this scheme allows defining a conserved quantity , does not suffer of ergodicity problems in solids  @xcite and has been used successfully in practical applications for equilibration purposes@xcite or to perform ensemble averages.@xcite finally , it has a minimal impact on the system dynamics , thus being an optimal choice for the computation of dynamical properties.@xcite    the object of the present article is to combine the global stochastic thermostat introduced in ref .   with a standard barostat  @xcite to sample the isothermal - isobaric ensemble .",
    "the properties of the resulting algorithm are discussed in details and illustrated on lennard - jones ( lj ) liquid and solid systems . a special attention is dedicated to the parameterization of the thermostat and barostat relaxation times . in particular , we provide a framework for the choice of the barostat relaxation time which is based on the conservation of the total effective enthalpy , thus on the accuracy of the resulting sampling .",
    "for the thermostat relaxation time , we discuss its impact on the sampling efficiency by measuring the autocorrelation times of several relevant physical quantities . in this sense , we compare the new scheme with the nos - hoover@xcite and with the langevin piston barostats.@xcite    this paper is organized as follows : in section ii we formulate the most important aspects of the theoretical framework linking statistical theory to equations of motion .",
    "in particular , we demonstrate that the stochastic rescaling algorithm samples the isothermic - isobaric distribution .",
    "section iii contains several applications of our scheme to lj fluid and solid systems .",
    "some comments on the practical implementation of the barostat and a reliable discretization scheme are collected in the appendix .",
    "we consider a system of @xmath4 particles , described by coordinates @xmath5 , momenta @xmath6 , masses @xmath7 , contained in a box of variable volume @xmath1 subject to an external pressure @xmath8 . with @xmath9 and @xmath10",
    "we indicate the set of coordinates @xmath5 and @xmath6 , respectively . in the isotropic @xmath0 ensemble",
    "the probability distribution is usually defined as@xcite @xmath11},\\ ] ] where @xmath12 is the kinetic energy , @xmath13 is the potential energy and @xmath14 , with @xmath15 the boltzmann constant and @xmath16 the temperature . the expression for @xmath17 has been addressed in the literature and is not unique .",
    "for instance , attard@xcite proposed to use the logarithm of the volume as the integration variable , or , equivalently , an extra @xmath18 term in the probability distribution .",
    "nevertheless we will adopt the more standard definition in eq .  .",
    "when md simulations are performed in absence of external forces ( i.e.  @xmath19 ) the momentum of the center of mass of the system is conserved .",
    "thus , it is convenient to adopt as dynamical variables the center - of - mass coordinate @xmath20 and momentum @xmath21 , and the coordinates @xmath22 and momenta @xmath23 relative to the center of mass    [ eq - center - of - mass ] @xmath24    after the change of variables , the @xmath0 ensemble reads @xmath25 } \\\\",
    "\\times\\delta\\left(\\sum_im_i\\bm{r}_i\\right ) \\delta\\left(\\sum_i\\bm{\\pi}_i\\right),\\end{gathered}\\ ] ] where @xmath26 is the kinetic energy relative to the center of mass and @xmath27 is the kinetic energy of the center of mass .",
    "the delta - functions in eq .   are related to the conservation of total momenta and inertia in eqs .   and to the fact that , in the center - of - mass framework , @xmath28 and @xmath29 .",
    "as a further simplification , the redundant variables @xmath20 and @xmath21 and can be integrated out , resulting in the distribution @xmath30 } \\\\ \\times \\delta\\left(\\sum_im_i\\bm{r}_i\\right ) \\delta\\left(\\sum_i\\bm{\\pi}_i\\right).\\end{gathered}\\ ] ] here the additional @xmath1 term comes from the fact that the size of the domain on which @xmath20 is integrated is proportional to @xmath1 .",
    "the contribution of the extra @xmath1 factor is almost negligible for systems with more than a few tens of particles , though we will include it to have a formally correct ensemble .    the distribution in eq .",
    "provides ensemble averages which are equivalent to those from eq .  , and should be used as a target ensemble for any md simulation in the @xmath0 ensemble when external forces are not present . in the next two subsections we provide an algorithm to sample this distribution .",
    "we first consider the problem of fixing the pressure , adopting a solution similar to that of refs .  .",
    "since we work in the reference frame of the center of mass , we choose an initial configuration satisfying @xmath31 and @xmath32 .",
    "then we evolve it according to the following equations of motion    [ eq - nph - motion ] @xmath33}{w } \\\\",
    "\\label{eq - nph - motion - v } \\dot{v}=&3v\\eta.\\end{aligned}\\ ] ]    here @xmath34 are the forces , @xmath35 is proportional to the relative change rate of the volume and @xmath36 is the inertia of the piston , which determines the typical time scale for volume changes . the instantaneous internal pressure @xmath37 is given by @xmath38 where the derivative @xmath39 is performed at fixed scaled coordinates , as discussed in more detail in the appendix .",
    "equations   are similar to those introduced by hoover,@xcite but for an additional term in eq .  .",
    "the original hoover formulation , as observed by the author himself , gives a slightly wrong ensemble . with our correction ,",
    "when the dynamics is combined with a thermostat as shown in the next subsection , the exact @xmath0 distribution is sampled .",
    "an alternative solution to this problem have been proposed by martyna _",
    "et al_.@xcite .",
    "it can be easily shown that the following quantities are conserved during the dynamics :    [ eq - constant - of - motion - nph ] @xmath40    the first two conservation laws come from the absence of external forces .",
    "the last quantity @xmath3 is close to the enthalpy of the system ( @xmath41 ) , and its initial value @xmath42 depends on the initial configuration and velocities .    when an ensemble of systems is evolved according to eqs .",
    ", their distribution evolves according to a corresponding liouville - like equation . defining the @xmath43-dimensional vector @xmath44 , eqs .",
    "can be written in compact form as @xmath45 , and the liouville - like equation on the density as @xmath46 , where @xmath47 is the liouville operator .",
    "written explicitly in terms of the phase - space variables @xmath48 , @xmath49 , @xmath1 and @xmath35 , the liouville operator reads @xmath50}{w}\\frac{\\partial}{\\partial\\eta } + 3\\eta + 3v\\frac{\\partial}{\\partial v}.\\end{gathered}\\ ] ] the long time distribution for the ensemble can be found solving the equation @xmath51 .",
    "as it can be verified by direct substitution , the following class of functions solves @xmath52 @xmath53 the delta functions here come from the conservation laws in eqs .  .",
    "assuming that the system is ergodic an md simulation based on eqs .",
    "will produce configurations according to this distribution .",
    "an alternative derivation of eq .   can be done introducing the phase - space compressibility as it is done for instance in ref .  .",
    "rigorously speaking , eq .",
    "is not the standard @xmath2 distribution .",
    "indeed , here the constant of motion is @xmath3 , which , as discussed above , slightly deviates from the enthalpy .",
    "moreover , there is an additional @xmath18 prefactor .",
    "however , since we are interested in @xmath0 sampling , we ignore these discrepancies and proceed in the combination of the @xmath2 scheme with a thermostat .",
    "we now combine the presented constant - enthalpy scheme with a thermostat .",
    "we first extend the @xmath0 ensemble of eq .   so as to include @xmath35 as a dynamical variable . since @xmath35 is a velocity , we associate to it a kinetic energy and define the extended @xmath0 ensemble as @xmath54},\\end{gathered}\\ ] ] where @xmath55 is the total kinetic energy , which includes also the barostat kinetic energy .",
    "when the @xmath35 variable is integrated out , this distribution is identical to the target one in eq .  .",
    "thus , we will use this distribution as a target ensemble for the @xmath0 algorithm .",
    "it is easy to verify that this distribution is stationary with respect to the liouville - like operator in eq .",
    ", i.e.  @xmath56 .",
    "the only reason why a time average performed with eqs .   will not give results consistent with the @xmath0 ensemble is that eqs .",
    "have an extra constant of motion ( namely @xmath3 ) . to sample the @xmath0 ensemble one has to introduce a thermostat , which changes at every step the value of @xmath3 in such a way that the @xmath0 ensemble is stationary .",
    "since @xmath17 is the product of a term depending on the potential energy and a term depending on kinetic energy , the thermostat can be designed to act only on the latter one , whose distribution in the gibbs ensemble is known _ a priori _ and is @xmath57 . here",
    "@xmath58 is the number of degrees of freedom , including the volume ( @xmath59 ) and excluding the center of mass ( @xmath60 ) . in the following ,",
    "we describe how this task is accomplished by the stochastic velocity rescaling.@xcite    in the stochastic velocity rescaling , the application of the thermostat consists of a rescaling of the velocities of the system .",
    "we here rescale not only the momenta @xmath49 but also the barostat velocity @xmath35 , by a factor @xmath61 :    @xmath62    this change affects the total kinetic energy @xmath63 , which includes also the barostat kinetic energy .",
    "following ref .  , we calculate at each step the rescaling factor by propagating the total kinetic energy according to the equation @xmath64 the propagation is done for a half timestep @xmath65 as described in the appendix , so that @xmath66 . here",
    "@xmath67 is the relaxation time of the thermostat , @xmath68 is the average kinetic energy , and @xmath69 is a wiener noise.@xcite at variance with the scheme in ref .  , here",
    "the cell degree of freedom needs to be counted , and the rescaling procedure affects both the velocities of the particle and the velocity of the piston @xmath35 .    as it has been shown previously,@xcite the stationary distribution associated with the stochastic dynamics in eq .",
    "is the canonical one , i.e.  @xmath70 .",
    "it immediately follows that , when the equation is combined with the constant - enthalpy dynamics , one obtains configurations distributed according to the @xmath0 ensemble in eq .  .",
    "our algorithm consists of an alternation of constant - enthalpy steps [ eq .  ] and a thermostat step [ eq .  ] , as discussed in details in the appendix .",
    "it is worthwhile noting that other schemes can be implemented in the same fashion , simply by changing the thermostat step . in particular , the langevin piston algorithm@xcite",
    "is easily implemented using the thermostat step as discussed in refs .",
    ", applying the friction and noise to the particles and the cell velocities , and removing the velocity of the center of mass afterwards so as to eliminate the total force on the center of mass and obtain the same ensemble . similarly , a standard nos - hoover scheme may be coupled with the constant - enthalpy integrator .      in the practical implementation of md one",
    "integrates eqs .   using a finite timestep .",
    "this invariably introduces small systematic errors in the sampled distribution .",
    "the traditional way to control this error is to perform a microcanonical simulation and to verify the conservation of the total energy .",
    "this approach is easily extended to variable cell simulations in the @xmath2 ensemble , where the conservation of the enthalpy is used .",
    "an equivalent conserved quantity can also be defined for simulations performed with the nos - hoover scheme in the @xmath0 ensemble . in a recent paper",
    "we have introduced a formalism which allows to define a conserved quantity , called effective enthalpy , also for stochastic dynamics .",
    "this has been done for our stochastic velocity rescaling,@xcite and has been later extended to langevin dynamics.@xcite here we discuss how this concept is generalized to an effective enthalpy in variable cell simulations . to this aim , we first repeat some of the ideas introduced in the previous papers , then we show how the compressibility is taken into account for our variable cell algorithm .",
    "we consider the @xmath43-dimensional vector @xmath71 in the phase space . in principle",
    "md equations would produce a continuous trajectory @xmath72 .",
    "however , in the practical implementation the time is discretized so that only a discrete sequence of snapshots of the system is available , @xmath73 , which is then used to evaluate ensemble averages . in our scheme ,",
    "each point @xmath74 is obtained from the previous one @xmath75 applying alternatively eq .   and the thermostat .",
    "we now consider the move from @xmath74 to @xmath76 as a proposal for a monte carlo move . even if in an md simulation all the moves are accepted , it is instructive to calculate the acceptance rate for that move . to enforce detailed balance relative to the target distribution @xmath77",
    ", the acceptance rate in the metropolis scheme should be set equal to @xmath78 the transition matrix @xmath79 is the probability of generating @xmath80 as the next point in the sequence given that the present point is @xmath81 .",
    "the star denotes time reversal of velocities , i.e.  if @xmath71 then @xmath82 .",
    "clearly , @xmath83 .",
    "the detailed balance enforced by eq .",
    "is not the standard one but its generalization for odd and even variables discussed in ref .  .",
    "we then associate an effective enthalpy @xmath84 to each point in the sequence in such a way that the acceptance rate in eq .",
    "is equal to @xmath85 . by simple substitution ,",
    "the change of effective enthalpy between subsequent points is defined as @xmath86    we now proceed to an explicit evaluation of the increment of effective enthalpy at each md step .",
    "our scheme is a sequence of two different operations : the thermostat and the time evolution of eq .  .",
    "when the thermostat is applied , either stochastic rescaling or langevin , its propagation is done analytically , so that detailed balance is exactly satisfied .",
    "this gives an acceptance equal to 1 and a vanishing change in the effective enthalpy.@xcite    on the other hand , when eqs .",
    "are propagated , the change in effective enthalpy is not trivial and has to be evaluated explicitly . the change in effective enthalpy is decomposed in two terms as @xmath87 the first term , substituting the ensemble probability in eq .   and the definition of enthalpy in eq .  , is @xmath88 where @xmath89 is the volume at step @xmath90 .",
    "the second term of eq .   is calculated reminding that the rate between the backward transition matrix and the forward transition matrix is equal to the jacobian of the transform which , as shown in the appendix , is @xmath91 . thus @xmath92 combining eqs .  , and one obtains : @xmath93 so that the increment in effective enthalpy is exactly equal to the increment in the enthalpy .    in conclusion ,",
    "the calculation of the effective enthalpy is very similar to the calculation of the effective energy in ref .  .",
    "the effective enthalpy is obtained as a cumulated sum of all the increments of @xmath3 in the constant - enthalpy dynamics .",
    "alternatively , one can obtain the effective enthalpy as the total enthalpy @xmath3 minus the sum of all the contributions to the kinetic energy given to the thermostat . in the limit of zero time step ,",
    "the effective enthalpy is exactly conserved . in real applications",
    ", the effective enthalpy is expected to exhibit random fluctuations and a small systematic drift . in principle , if exact sampling is required , the change in effective enthalpy can be used to perform hybrid monte carlo simulations,@xcite or to reweight properly the obtained configurations.@xcite in practice , one can just monitor its systematic drift and use it to quantify the sampling errors .",
    "if the drift is too large , one should decrease the integration time step .",
    "we now test the discussed algorithm on a couple of model systems .",
    "we consider a system of 256 particles interacting through lj potential in a cubic box with periodic boundary conditions .",
    "simulations are carried out both in the solid fcc phase and in the liquid one at temperature @xmath94 and pressure @xmath95 , close to the triple point .",
    "we use everywhere lj reduced units .",
    "the interactions are truncated at 2.5 , and the force is smoothed between 2.25 and 2.5 .",
    "long - range corrections which take into account the difference between the true lj potential and our truncated approximation are added to the total energy of the system . to this aim , a constant radial - distribution - function",
    "is assumed for distances larger than 2.25,@xcite and the corrections to the internal pressure are evaluated as derivatives of the energy correction with respect to the cell volume .",
    "the dynamics is computed using an in - house code .    for convenience ,",
    "the piston mass @xmath36 is defined as @xmath96 , where @xmath97 is a time describing the time - scale of the volume fluctuations.@xcite for the nos - hoover scheme discussed in section [ exam ] , the thermostat mass is chosen as @xmath98 , where the thermostat relaxation time @xmath67 measures the thermostat strength .    in the following , three kinds of thermostats are considered : ( a ) our scaling procedure ( stochastic rescaling ) , which is stochastic and global ; ( b ) langevin piston , which is stochastic and local ; ( c ) nos - hoover , which is deterministic and global .",
    "this choice allows us to investigate separately which is the effect of a global thermostat versus a local one and how the stochastic nature of the algorithm affects its performance .",
    "we investigate the role played by the relevant simulation parameters , namely the timestep @xmath99 , thermostat relaxation time @xmath67 , the barostat relaxation time @xmath97 . for the langevin scheme ,",
    "we choose a friction @xmath100 , for the reasons discussed in ref .  .",
    "the presented averages are obtained from @xmath101 steps simulations for each possible choice of the simulation parameters .",
    "we consider here the choice of the timestep @xmath99 and of the barostat relaxation time @xmath97 . as it will become clear later ,",
    "the rationale behind the choice of these two parameters is the same , thus we discuss them at the same time .     plotted as a function of the timestep @xmath99 for the lennard - jones liquid ( a ) and solid ( b ) systems at the triple point , for stochastic velocity rescaling ( filled circles ) , nos - hoover ( open circles ) and langevin ( diamonds ) algorithms .",
    "the thermostat relaxation time is @xmath102 and the barostat relaxation time is @xmath103 .",
    "all quantities are in lennard - jones reduced units.,scaledwidth=48.0% ]    in fig .  [ flux_dt ]",
    "we show the dependence of the effective - enthalpy drift @xmath104 on @xmath99 , fixing the other parameters at @xmath103 and @xmath102 .",
    "the customary procedure in md simulations is to choose a @xmath99 which is as large as possible , with the constraint that the drift of the total energy is smaller than a given threshold . in our case",
    ", an equivalent check can be done on the effective enthalpy introduced in subsection  [ sec - sampling - errors ] or , for the nos - hoover , on its conserved quantity .",
    "the exact value of the threshold is rather arbitrary , but still it gives a quantitative estimate of the sampling errors given by the finite timestep , and still can be used to compare the relative accuracy of two different simulations .",
    "the two global schemes ( nos - hoover and stochastic rescaling ) exhibit a similar drift , which grows with @xmath99 . also for the langevin scheme the drift increases with the timestep , but faster than in the global schemes .",
    "for further calculations , we choose a standard value @xmath105 , even if a slightly smaller timestep should be used in order to achieve the same accuracy with langevin dynamics .",
    "plotted as a function of the barostat relaxation time @xmath97 for the lennard - jones liquid ( a ) and solid ( b ) systems at the triple point , for stochastic velocity rescaling ( filled circles ) , nos - hoover ( open circles ) and langevin ( diamonds ) algorithms .",
    "the thermostat relaxation time is @xmath102 and the timestep is @xmath105 .",
    "all quantities are in lennard - jones reduced units.,scaledwidth=48.0% ]    we now consider the choice of @xmath97 .",
    "we recall that there is a relationship between the mass of the particles ( and of the barostat ) and the time - step . as an example ,",
    "a four - fold decrease of all the masses produces exactly the same trajectory as a two - fold increase of the time - step , thus giving a two times faster exploration . in the same way , for a fixed value of the particles mass",
    ", a lower barostat mass will provide a faster volume evolution at the price of a lower accuracy .",
    "thus , the choice of the barostat mass , @xmath106 , is based on a compromise between a small mass and a reasonable effective - enthalpy drift , and is very similar to the choice of @xmath99 . in fig .",
    "[ flux_tp ] we show the dependence of the effective - enthalpy drift on @xmath97 . since the drift induced by a too small @xmath97 is due to sampling errors of a single degree of freedom ( the volume ) , it is partially hidden by the larger drift due to the inexact integration of the particles degrees of freedom .",
    "however , it is clear that for @xmath107 the drift due to the volume is negligible .",
    "we notice that in none of the presented simulations we have observed an appreciable decoupling between the barostat and the internal degrees of freedom in the case of small @xmath97 .",
    "we also computed the autocorrelation time of a few relevant quantities , and we noticed that the sampling efficiency always increases as @xmath97 is decreased .",
    "thus , the final rule turns out to be a @xmath97 which is as small as possible , but with a reasonable effective - enthalpy conservation .",
    "we thus choose @xmath103 to continue our tests .",
    "plotted as a function of the thermostat relaxation time @xmath67 for the lennard - jones liquid ( a ) and solid ( b ) systems at the triple point , for stochastic velocity rescaling ( filled circles ) , nos - hoover ( open circles ) and langevin ( diamonds ) algorithms .",
    "the timestep is @xmath105 and the barostat relaxation time is @xmath103 .",
    "all quantities are in lennard - jones reduced units.,scaledwidth=48.0% ]    we now proceed to a systematic study of the effects of the other relevant simulation parameter , namely the thermostat relaxation time @xmath67 . to this aim",
    ", we fix a timestep @xmath105 and a barostat relaxation time @xmath103 , and perform simulations for a wide range of @xmath67 . as it is seen in fig .",
    "[ flux_tt ] , the effect of @xmath67 on the effective - enthalpy drift is rather weak , at least for the two global schemes .",
    "indeed , for these choices of the parameters , the origin of the drift is not in the thermostat but in the constant - enthalpy step .",
    "the drift in langevin is larger than that of the other schemes .",
    "for @xmath67 we can not use the same criterion that we used to optimize @xmath97 .",
    "indeed the two stochastic schemes ( rescaling and langevin ) are stable for any possible choice of @xmath67 .",
    "this is due to the fact that , in these two cases , the thermostat equations are linear and can be integrated in an analytic fashion ( see appendix ) .",
    "this is not true for the nh scheme , which turns out to be be unstable for @xmath108 , at least using the present integration scheme .",
    "moreover , it is not obvious that a smaller @xmath67 should lead to faster sampling , as it will be seen in the following .",
    "we thus proceed in an analysis of the statistical efficiency as a function of the thermostat parameter , similar to what has been done for the @xmath109 ensemble.@xcite a quantitative measure of the time needed for performing ensemble averages of a given quantity @xmath110 is given by its autocorrelation time @xmath111 ( see e.g.  ref .  ) . since a common goal of @xmath0 simulation is the calculation of averages of quantities like the enthalpy and the volume of the system , we consider here the cases where @xmath112 and @xmath113 .",
    "the autocorrelation time of the total enthalpy also provides a rough estimate of the time needed for the equilibration procedure .",
    "however , it must be noticed that to achieve a fast equilibration also the autocorrelation time of the _ fluctuations _ of the enthalpy should be short .",
    "thus , we also calculate the correlation time for the fluctuations of these quantities , obtained with @xmath114 and @xmath115 respectively . the first one is related to the bulk modulus and the second to the heat capacity at constant pressure .",
    "thus , these autocorrelation times provide the statistical efficiency in the calculation of these important physical observables .",
    ", of the enthalpy fluctuations @xmath116 , of the volume @xmath117 and of the volume fluctuations @xmath118 , plotted against thermostat relaxation time @xmath67 , for the lennard - jones liquid at the triple point , for stochastic velocity rescaling ( filled circles ) , nos - hoover ( open circles ) and langevin ( diamonds ) algorithms .",
    "the timestep is @xmath105 and the barostat relaxation time is @xmath103 .",
    "all quantities are in lennard - jones reduced units .",
    "[ fig - auto - liquid ] , scaledwidth=48.0% ]    , of the enthalpy fluctuations @xmath116 , of the volume @xmath117 and of the volume fluctuations @xmath118 , plotted against thermostat relaxation time @xmath67 , for the lennard - jones solid at the triple point , for stochastic velocity rescaling ( filled circles ) , nos - hoover ( open circles ) and langevin ( diamonds ) algorithms .",
    "the timestep is @xmath105 and the barostat relaxation time is @xmath103 .",
    "all quantities are in lennard - jones reduced units .",
    "[ fig - auto - solid ] , scaledwidth=48.0% ]    the simulation results for a number of runs are summarized in fig .",
    "[ fig - auto - liquid ] and fig .",
    "[ fig - auto - solid ] for the liquid and the solid respectively . in all cases , the performance of stochastic rescaling is equal or better than that of the local langevin thermostat . for large @xmath67 ,",
    "the two stochastic schemes have the same behavior . for small @xmath67 ,",
    "the performance of the local langevin scheme is worse .",
    "this happens for both the solid and liquid systems , and indicates that tuning the performance of langevin thermostat is very difficult since it is efficient only for a limited friction range .",
    "these problems in langevin thermostat are related to the fact that it is local , thus it disturbs considerably the trajectory , hindering diffusion ( in the liquid ) or thermalization of the slow modes ( in the solid ) .",
    "this is in agreement to what has been observed in ref .   for a liquid in the @xmath109 ensemble .    on the other hand ,",
    "the nos - hoover thermostat is global and , similarly to the velocity rescaling , has a very small impact on the trajectory . in the present calculations , performed at the triple point",
    ", we do nt expect the solid to be harmonic enough to introduce ergodicity problems .",
    "its performances are excellent when looking at the autocorrelation time of enthalpy ( @xmath119 ) and volume ( @xmath120 ) , for both the solid and the liquid . for the solid",
    ", a resonance effect leads to a peak in these autocorrelation times for @xmath121 .",
    "however , fluctuations of the enthalpy ( @xmath116 ) are well thermalized only for a limited range of choices for @xmath67 .",
    "this is related to the fact that the thermostat is optimally coupled only to the modes with a given frequency , and is not able to thermalize the others .",
    "the fact that the average enthalpy has a short autocorrelation time is due to cancellations in the autocorrelation function , and is a signature of the enthalpy oscillations around the correct value .",
    "the damping of these oscillations can be rather slow if @xmath67 is not chosen properly .",
    "the stochastic rescaling scheme combines the stability of the stochastic langevin with the efficiency of the global nos - hoover .",
    "the coupling parameter @xmath67 in the stochastic rescaling scheme has the meaning of thermostat - strength , and a smaller @xmath67 always guarantees a better efficiency . on the contrary",
    ", in the nos - hoover scheme @xmath67 also determines which modes are optimally coupled with the thermostat , and it is more difficult to tune . finally , the stochastic rescaling is comparable with the nos - hoover in computation of averages for small @xmath67 , surpassing it in computation of fluctuations .",
    "it is also interesting to check if the rescaling scheme preserves the dynamics .",
    "to investigate this point , we consider the calculation of dynamical properties .",
    ", for the lennard - jones liquid at the triple point , for stochastic velocity rescaling ( filled circles ) , nos - hoover ( open circles ) and langevin ( diamonds ) algorithms .",
    "the diffusion coefficient computed from the corresponding @xmath122 run is 0.03 .",
    "the timestep is @xmath105 and the barostat relaxation time is @xmath103 .",
    "all quantities are in lennard - jones reduced units .",
    "[ diffusion ] , scaledwidth=50.0% ]    for the lj liquid , we calculate the self - diffusion coefficient @xmath123 from the mean square displacement . in order to overcome the practical problem of computing the mean square displacement in a variable cell ,",
    "first we calculate it using the scaled coordinates @xmath124 , then we scale the obtained diffusion coefficient of a factor @xmath125 to recover the correct value .",
    "the diffusion coefficient as a function of the thermostat relaxation time @xmath67 is shown on fig .",
    "[ diffusion ] .",
    "it is evident that both global schemes ( velocity rescaling and nose - hoover ) do not affect the diffusion . in particular , the calculated value ( @xmath126 ) is in agreement with that obtained in microcanonical simulations in similar conditions . on the other hand , when the local langevin scheme is used with a too high friction the diffusion",
    "is hindered .",
    "remarkably , the choices of @xmath67 which lead to a slower diffusion correspond to the choices that lead to a worse sampling ( see the previous subsection ) .",
    "these time can also be compared with the typical collision time , defined as the velocity autocorrelation time @xmath127 .",
    "it is easy to show that @xmath127 is related to @xmath123 by @xmath128 . in the limit of large @xmath67 ( small friction )",
    ", it turns out to be @xmath129 .",
    "when the collisions with the thermal bath have the same frequency that the natural interparticle collisions , the thermostat turns out to be the bottleneck for diffusion .     for the lennard - jones solid at the triple point .",
    "the three overlapping solid lines , which are almost indistinguishable , are obtained using stochastic velocity rescaling , nos - hoover and microcanonical dynamics .",
    "the dashed line is obtained using the langevin thermostat .",
    "all the thermostats are used with a thermostat relaxation time @xmath130 ( for langevin @xmath131 ) .",
    "the timestep is @xmath105 and the barostat relaxation time is @xmath103 .",
    "all quantities are in lennard - jones reduced units .",
    "[ velocity ] , scaledwidth=50.0% ]    in the solid , where the diffusion coefficient is vanishing , we opt for the calculation of the full velocity - velocity autocorrelation function .",
    "the results are shown in fig .",
    "[ velocity ] , where the autocorrelation function is plotted for all the considered thermostats , using a reasonable thermostat relaxation time @xmath130 , and for a reference microcanonical simulation at similar conditions . from the plot it is clear that the global schemes do not affect significantly the dynamical properties . even if these simulations are performed in the @xmath0 ensemble , they can be used to calculate correct dynamical properties .",
    "this is not true for the local langevin scheme , where the autocorrelation function is strongly affected by the thermostat .",
    "this is an additional confirmation that the impact on the dynamical properties is not due to the stochastic nature but to the locality of the langevin thermostat .",
    "a new method has been introduced to perform md simulations at constant temperature and pressure .",
    "the method is stochastic but does not affect the dynamical properties .",
    "the concept of effective energy , which provides a constant of motion for stochastic algorithms and which was already introduced in previous papers,@xcite has been extended in the present scheme to an effective enthalpy . a systematic analysis of the role played by the control parameter has been shown , focused on the choice of the thermostat and barostat relaxation times .",
    "moreover , a comparison of the new scheme with standard nos - hover and langevin barostats has been shown .",
    "the new scheme appear to be simpler to use and easier to control .",
    "further work is required to apply the presented algorithm to the case of nonequilibrium md , where the gibbs ensemble does not hold.@xcite",
    "at variance with ref .  , we follow here a time - reversible scheme which is consistent with the trotter decomposition scheme.@xcite the trotter decomposition is usually adopted to decompose the liouville ( or fokker - planck ) operator which describes the dynamics of an ensemble of realizations .",
    "for instance , if the exact solution of the liouville equation for a finite time increment @xmath99 is @xmath132 , its approximated solution is @xmath133 .",
    "equivalently , one can state that if the equations of motion are in the form @xmath134 an approximate propagator can be obtained applying in the proper order the analytical solutions of the equations @xmath135 , @xmath136 and @xmath137 .",
    "a necessary condition is that the three decoupled equations can be solved exactly .",
    "we here decompose the equations of motion as a sum of three parts : the first is the propagation of the thermostat , and the others are two equations of motion whose sum is equivalent to the @xmath2 dynamics .",
    "the flow of the integration scheme is as follows :    1 .",
    "propagate the thermostat for a time @xmath65 .",
    "2 .   propagate velocities for a time @xmath65 , according to + [ eq - trotter - v ] @xmath138}{w}\\end{aligned}\\ ] ] 3 .",
    "propagate positions and velocities for a time @xmath99 , according to + [ eq - trotter - r ] @xmath139 4 .",
    "propagate again velocities for a time @xmath65 , as in step 2 .",
    "propagate again the thermostat for a time @xmath65 , as in step 1 .",
    "the sum of eqs .   and   is equivalent to the original equations of motion  .",
    "this choice for the splitting is arbitrary , but it is motivated by the fact that eqs .   and   can be solved analytically also for finite time .",
    "[ eq - propagation - p ] @xmath140}{w } \\frac{\\delta t}{2 } \\\\            + \\sum_i\\frac{{\\bm",
    "f}_i(t ) \\cdot { \\bm p}_i(t)}{wm_i }                                 \\left(\\frac{\\delta t}{2}\\right)^2            + \\sum_i\\frac{|{\\bm f}_i(t)|^2}{wm_i }                 \\frac{1}{3 }      \\left(\\frac{\\delta t}{2}\\right)^3\\end{gathered}\\ ] ] @xmath141    the instantaneous pressure here is calculated as @xmath142-\\frac{\\partial u}{\\partial v}\\end{gathered}\\ ] ] where @xmath143 is the force between particles @xmath90 and @xmath144 and @xmath145 is their distance , evaluated by taking into account the periodic boundary conditions within the minimum - image convention.@xcite the last term @xmath146 takes into account any explicit dependence of the potential energy on the volume , such as the long range corrections.@xcite        it is also useful to evaluate the compressibility associated to this propagators , defined as the jacobian of the corresponding transforms .",
    "the transforms in eqs .   and   are linear , with jacobian equal to respectively 1 and @xmath150 .",
    "thus , when a volume element in the phase space is transformed by eqs .   and   its measure is changed by a a factor @xmath151 .",
    "this contribution is crucial for a proper evaluation of detailed - balance violations as it is done in subsection  [ sec - sampling - errors ] .",
    "we now describe the propagation of the thermostat stages ( 1 and 5 )",
    ". the thermostat can be either velocity rescaling , langevin or nos - hoover .",
    "we here simply state explicitly the integration schemes for the stochastic ones , without including any derivation .",
    "the complete derivations can be found in the original papers .",
    "here @xmath156 , @xmath157 is a gaussian number with unitary variance and @xmath158 is the sum of @xmath159 independent , squared , gaussian numbers .",
    "@xmath160 does not include the center of mass but includes the volume degree of freedom .",
    "where @xmath163 .",
    "here the @xmath164 are @xmath4 independent vectors of normalized gaussian numbers . after the application of the thermostat we remove the center - of - mass velocity , so as to have an ensemble exactly equivalent to that obtained with velocity rescaling ."
  ],
  "abstract_text": [
    "<S> the authors present a new molecular dynamics algorithm for sampling the isothermal - isobaric ensemble . in this approach </S>",
    "<S> the velocities of all particles and volume degrees of freedom are rescaled by a properly chosen random factor . </S>",
    "<S> the technical aspects concerning the derivation of the integration scheme and the conservation laws are discussed in detail . </S>",
    "<S> the efficiency of the barostat is examined in lennard - jones solid and liquid near the triple point and compared with the deterministic nos - hoover and the stochastic langevin methods . in particular , </S>",
    "<S> the dependence of the sampling efficiency on the choice of the thermostat and barostat relaxation times is systematically analyzed . </S>"
  ]
}