{
  "article_text": [
    "in the last years , some methods mapping time series to network representations have been proposed ( see for instance [ xu _ et al . _ 2008 , zhang & small 2006 , lacasa _ et al .",
    "_ 2008 , luque _ et al .",
    "_ 2009 ] and a recent review on this topic [ donner _ et al .",
    "_ 2011 ] ) .",
    "the general purpose is to investigate on the properties of the series through graph theoretical tools recently developed in the core of the celebrated complex network theory , opening the possibility of building bridges between time series analysis , nonlinear dynamics , and graph theory . along this line , the family of visibility algorithms [ lacasa _ et al .",
    "_ 2008 , luque _ et al .",
    "_ 2009 , gutin _ et al .",
    "_ 2011 ] has been introduced recently .",
    "it has been shown that several degrees of correlations ( including periodicity [ lacasa _ et al .",
    "_ 2008 ] , fractality [ lacasa _ et al .",
    "_ 2009 ] or chaoticity [ luque _ et al .",
    "_ 2009 , lacasa & toral 2010 ] ) can be captured by the algorithm and translated in the associated visibility graph .",
    "accordingly , several works applying such algorithm in several contexts ranging from geophysics [ elsner _ et al .",
    "_ 2009 ] or turbulence [ liu _ et al .",
    "_ 2010 ] to physiology [ shao 2010 ] or finance [ yang _ et al .",
    "_ 2010 ] have started to appear . here",
    "we focus on a specific algorithm within this family called the _ horizontal _ visibility graph [ luque _ et al .",
    "_ 2009 ] , which has been recently considered for the task of discriminating chaotic from correlated stochastic processes [ lacasa & toral 2010 ] .",
    "while the first steps for a rigorous mathematical grounding have been reported recently [ gutin _ et al .",
    "_ 2011 ] , this method is currently largely unexplored , both from a purely theoretical or from an applied point of view . to partially solve such issues , in this work we address the task of filtering a noisy signal with a hidden periodic component within the horizontal visibility formalism , that is , we explore the possibility of using the method for noise filtering purposes .",
    "periodicity detection algorithms ( see for instance [ parthasarathy _ et al .",
    "_ 2006 ] ) can be classified in essentially two categories , namely the time domain ( autocorrelation based ) and frequency domain ( spectral ) methods . here",
    "we make use of the horizontal visibility algorithm to propose a third category , namely graph theoretical methods .",
    "+ the rest of the paper goes as follows : in section 2 we present the method , and provide some theorems regarding several topological properties of horizontal visibility graphs . in section 3",
    "we introduce the concept of a graph - theoretical noise filter , and provide some examples of noisy periodic series , comparing in each case the performance of the proposed method with an autocorrelation function analysis . a pathological case that yields misleading results from the autocorrelation function",
    "is also considered .",
    "we finally provide a discussion on the the potentials and limitations of this approach .",
    "the horizontal visibility algorithm has been recently introduced [ luque _ et al .",
    "_ 2009 ] as a map between a time series and a graph and it is defined as follows .",
    "let @xmath0 be a time series of @xmath1 real data .",
    "the algorithm assigns each datum of the series to a node in the _ horizontal visibility graph _ ( hvg ) .",
    "accordingly , a series of @xmath1 data map to an hvg with @xmath1 nodes .",
    "two nodes @xmath2 and @xmath3 in the graph are connected if one can draw a horizontal line in the time series joining @xmath4 and @xmath5 that does not intersect any intermediate data height .",
    "that is , @xmath2 and @xmath3 are two connected nodes if the following geometrical criterion is fulfilled within the time series : @xmath6 basic properties of this graphs can be found in [ luque _ et al .",
    "_ 2009 ] , and the first steps for a rigorous mathematical characterization can be found in[gutin _ et al .",
    ". among possible applications of the method for time series analysis purposes , discrimination between chaotic and stochastic signals has been recently addressed [ lacasa & toral , 2010 ] .",
    "+ in this section we provide some theorems regarding some specific topological properties of the horizontal visibility graphs , and in the following sections we will rely on these theorems to define a noise filtering technique .",
    "+    [ kmedia ] ( mean degree of periodic series ) + the mean degree of an horizontal visibility graph associated to an infinite periodic series of period t ( with no repeated values within a period ) is @xmath7    without lack of generality , represent the series as @xmath8 , where @xmath9 corresponds to the largest value of the series . by construction , the associated hvg is composed as a concatenation of identical motifs , each of these motifs being itself an hvg of @xmath10 nodes associated to the subseries @xmath11 , and the mean degree of the hvg @xmath12 corresponds to the mean degree of the motif constructed with @xmath13 nodes ( the nodes associated to @xmath14 and @xmath15 only introduce half of their actual degree in the motif , what is equivalent to effectively reducing one node ) .",
    "suppose that the motif is a graph with @xmath16 edges , and let @xmath4 be the smallest datum of the subseries ( since no repetitions are allowed in the motif , @xmath4 will always be well defined ) . by construction ,",
    "the associated node @xmath2 will have degree @xmath17 .",
    "extract now from the motif this node and its two edges .",
    "the resulting motif will have @xmath18 edges and @xmath13 nodes .",
    "iterate this operation @xmath19 times ( see figure [ ejemplo_eli ] for a graphical illustration of this process ) .",
    "the resulting graph will have only two nodes , associated to @xmath14 and @xmath15 , linked by a single edge , and the total number of deleted edges will be @xmath20 . hence , @xmath21",
    "< 1.5em - 1.5em plus0em minus0.5em height0.75em width0.5em depth0.25em    , considering a motif extracted from a periodic series of period @xmath22.,scaledwidth=85.0% ]    an interesting consequence of the previous result is that every time series extracted from a dynamical system has an associated hvg with a mean degree @xmath23 , where the lower bound is reached for constant series , whereas the upper bound is reached for aperiodic series ( random , chaotic @xcite ) .",
    "[ p_k ] ( degree distribution associated to uncorrelated random series ) + let @xmath24 be a bi - infinite sequence of independent and identically distributed random variables extracted from a continous probability density @xmath25 .",
    "then , the degree distribution of its associated horizontal visibility graph is @xmath26    a lengthy constructive proof can be found in [ luque _ et al .",
    "_ 2009 ] . here",
    "we propose two alternative , shorter proofs for this theorem .",
    "let @xmath27 be an arbitrary datum of the aforementioned series .",
    "the probability of its horizontal visibility being interrupted by a datum @xmath28 on its right and other datum @xmath29 on its left is , independently of @xmath25 ,    @xmath30 ^ 2dx=\\frac{1}{3 } \\label{phi}\\ ] ]    the probability @xmath31 of the datum seeing exactly @xmath32 data may be expressed as    @xmath33    where @xmath34 is the probability of @xmath27 seeing at least @xmath32 data .",
    "@xmath34 may be recurrently calculated as    @xmath35    from which the following expression can be deduced :    @xmath36     < 1.5em - 1.5em plus0em minus0.5em height0.75em width0.5em depth0.25em    \\(2 ) the same result for the distribution @xmath31 can be deduced by means of expression @xmath37 along with combinatoric arguments : if the arbitrary datum @xmath27 is connected to exactly @xmath32 data , there exist two data @xmath38 and @xmath39 that close the left and right visibility of @xmath27 . as we have proven , this happens with a probability @xmath40 .",
    "the @xmath41 remaining data will therefore be smaller than @xmath27 and will be distributed in a monotonically decreasing sequence on its left and a monotonically increasing sequence on its right respectively .",
    "the number of possible distributions with @xmath2 data on its left and @xmath42 on its right is @xmath43 , where @xmath44 .",
    "all these configurations can all be decomposed in @xmath41 groups of three data with the central datum being closed by the two others , therefore , all of them are equiprobable with a probability @xmath45 , then    @xmath46     < 1.5em - 1.5em plus0em minus0.5em height0.75em width0.5em depth0.25em    observe that the mean degree @xmath12 of the horizontal visibility graph associated to an uncorrelated random process is then : @xmath47 in good agreement with the prediction of the previous theorem for aperiodic series .",
    "deviations from @xmath48 are , according to previous theorem , univoquely associated to series which are not generated by a purely uncorrelated process .",
    "several possibilities arise : first , the process can still be of a stochastic nature , while some correlations can be present . as a matter of fact , in [ lacasa & toral , 2010 ] it has been shown that such kind of correlated stochastic series map into hvgs with a degree distribution which is also exponentially decaying , albeit with a larger slope than equation [ pk ] .",
    "a second situation involves a deterministic process .",
    "two opposite possibilities arise : the process can be either regular , what yields a periodic series of a given period @xmath13 , or chaotic , what yields an aperiodic series .",
    "periodic series have an associated hvg with a degree distribution formed by a finite number of peaks , these peaks being related to the series period , what is reminiscent of the discrete fourier spectrum of a periodic series [ lacasa _ et al .",
    "_ 2008 , luque _ et al .",
    "the reason is straightforward : a periodic series maps into an hvg which , by construction , is a repetition of a root motif .",
    "the second possibility has been addressed in [ luque _ et al .",
    "_ 2009 , lacasa & toral , 2010 ] , the conclusion being that chaotic processes have an hvg whose degree distribution has an exponential tail with smaller slope than equation [ pk ] , and evidences a net deviation from the exponential shape for small values of the degree , this deviation being associated to short - range memory effects .",
    "last , an interesting situation takes place when a given regular process ( periodic series ) is polluted with a given amount of noise .",
    "data generated through the logistic map @xmath49 for @xmath50 ( where the map shows periodic behavior with period @xmath51 ) polluted with extrinsic white gaussian noise extracted from a gaussian distribution @xmath52 .",
    "_ right _ : dots represent the degree distribution of the associated hvg , whereas the straight line is equation [ teoriaperi ] ( the plot is in semi - log ) .",
    "note that @xmath53 , also as theory predicts , and that @xmath54 is not exactly zero due to boundary effects in the time series .",
    "the algorithm efficiently detects both signals and therefore easily distinguishes extrinsic noise.,scaledwidth=70.0% ]    indeed , if we superpose a small amount of noise to a periodic series ( a so - called _ extrinsic _ noise ) , while the degree of the nodes with associated small values will remain rather similar , the nodes associated to higher values will eventually increase their visibility and hence reach larger degrees .",
    "accordingly , the delta - like structure of the degree distribution ( associated with the periodic component of the series ) will be perturbed , and an exponential tail will arise due to the presence of such noise [ luque _ et al . _ 2009 , lacasa & toral , 2010 ] .",
    "can the algorithm characterize such kind of series ?",
    "the answer is positive , since the degree distribution can be analytically calculated as it follows : + consider for simplicity a period-2 time series polluted with white noise ( see the left part of figure [ ejemplo ] for a graphical illustration ) .",
    "the hvg is formed by two kind of nodes : those associated to high data with values @xmath55 in the figure and those associated to data with small values @xmath56 .",
    "these latter nodes will have , by construction , degree @xmath17 .",
    "on the other hand , the subgraph formed by the odd nodes associated to data @xmath55 will essentially reduce to the one associated to an uncorrelated series , _",
    "i.e. _ its degree distribution will follow equation [ pk ] .",
    "now , considering the whole graph , the resulting degree distribution will be such that @xmath57 that is to say , introducing a small amount of extrinsic uncorrelated noise in a periodic signal introduces an exponential tail in the hvg s degree distribution with the same slope as the one associated to a purely uncorrelated process .",
    "the mean degree @xmath12 reads @xmath58 which , according to equation [ kmedia ] , suggests aperiodicity , as expected . in the left part of figure [ ejemplo ] we plot in semi -",
    "log the degree distribution of a periodic-2 series of @xmath59 data polluted with an extrinsic white gaussian noise extracted from a gaussian distribution @xmath52 .",
    "numerical results confirm the validity of equation [ teoriaperi ] .",
    "note that this methodology can be extended to every integrable deterministic system , and therefore we conclude that extrinsic noise in a mixed time series is , in principle , well captured by the algorithm .",
    "based on the previous theorems , in the next section we introduce a method to calculate the hidden periodicity in a noisy periodic signal .",
    "let @xmath60 be a periodic series of period @xmath13 ( where @xmath61 ) polluted by a certain amount of extrinsic noise ( without loss of generality , suppose a white noise extracted from a uniform distribution @xmath62 $ ] ) , and define the filter @xmath63 as a real valued scalar such that @xmath64 $ ] .",
    "the so called filtered horizontal visibility graph ( f - hvg ) associated to @xmath65 is constructed as it follows : + ( i ) each datum @xmath4 in the time series is mapped to a node @xmath2 in the f - hvg , ( ii ) two nodes @xmath2 and @xmath3 are connected in the fhvg if the associated data fulfill @xmath66 the procedure of filtering the noise from a noisy periodic signal goes as follows : one generates the f - hvg associated to @xmath65 for increasing values of @xmath63 , and in each case proceeds to calculate the mean degree @xmath12 . for the proper interval @xmath67 , the f - hvg of the noisy periodic series @xmath65 will be equivalent to the noise free hvg of the pure ( periodic ) signal , which has a well defined mean degree as a function of the series period . in this interval , the mean degree will therefore remain constant , and from equation [ kmedia ] the period can be inferred . + as an example , we have artificially generated a noisy periodic series of hidden period @xmath68 , that we plot in the left panel of figure [ t2 ] .",
    "the results of the graph filtering technique are shown in the middle panel of this figure , where we plot the values of @xmath12 as a function of @xmath63 .",
    "notice that the graph filtering yields a net decreases of the mean degree , which has an initial value of @xmath69 ( as expected for the hvg ( @xmath70 ) of an aperiodic series such as a noisy periodic signal ) and an asymptotic value of @xmath51 ( lower bound of the mean degree ) .",
    "the plateau is clearly found at @xmath71 , which according to equation [ kmedia ] yields a period @xmath72 as expected . for comparison , the autocorrelation function @xmath73 of the series",
    "is also calculated , according to the following definition @xmath74 such that @xmath75 is not bounded in @xmath76 $ ] since it is not normalized .",
    "this expression has a periodic shape of period @xmath13 when the series is itself periodic with period @xmath13 , whereas aperiodic structures yield an autocorrelation function that lacks any structure . in the right panel of figure [ t2 ]",
    "we plot the values of the autocorrelation , showing a period-2 structure as expected .",
    "+ at this point we conclude that the noise filtering is yet another feature of standard time series analysis that can be recovered in the visibility theory .",
    "an example with a noisy periodic series of period @xmath22 is plotted in figure [ t5 ] .",
    "polluted with extrinsic noise extracted from a uniform distribution @xmath62 $ ] of amplitude @xmath77 .",
    "_ middle _ : values of the hvg s mean degree @xmath12 as a function of the amplitude of the graph theoretical filter . the first plateau is found for @xmath71 , which renders a hidden period @xmath78 .",
    "the second plateau corresponding to @xmath79 is found when the filter is large enough to screen each datum with its first neighbors , such that the mean degree reaches its lowest bound .",
    "_ right _ : autocorrelation function of the noisy periodic series , which is itsef an almost periodic series with period @xmath68 , as it should.,scaledwidth=100.0% ]     polluted with extrinsic noise extracted from a uniform distribution @xmath62 $ ] of amplitude @xmath80 .",
    "_ middle _ : values of the hvg s mean degree @xmath12 as a function of the amplitude of the graph theoretical filter . the first plateau is found for @xmath81 , which renders a hidden period @xmath82 .",
    "_ right _ : autocorrelation function of the noisy periodic series , which is itsef an almost periodic series with period @xmath22 , as it should.,scaledwidth=100.0% ]      , where the map is chaotic and the attractor is partitioned in two disconnected chaotic bands .",
    "_ right _ : same plot as the left panel , for the first @xmath83 values of the series.,scaledwidth=100.0% ]    , which suggests that the series has a periodic component .",
    "this misleading result is consequence of the orbit within the attractor , more specifically to the alternated visit to the disconnected bands in the chaotic attractor . _",
    "middle _ : values of the hvg s mean degree @xmath12 associated to the same chaotic series , as a function of the amplitude of the graph theoretical filter .",
    "no plateau is found , what suggests that the series lacks any periodic structure , as it should._right _ : degree distribution @xmath31 of the hvg associated to the chaotic series , in semi - log scale .",
    "@xmath53 , what is reminiscent of the attractor structure and the order of visits to chaotic bands ( half of the nodes correspond to data located in the bottom chaotic band , that by construction has degree @xmath17 ) .",
    "the tail of the distribution is exponential with a slope that deviates from the distribution associated to a purely uncorrelated process , what is an indication of a chaotic process , according to a previous study on hvgs @xcite.,scaledwidth=100.0% ]    the autocorrelation function is an extremely useful tool to unveil periodic structures in noisy data , in this sense the aforementioned filter is not meant to be used _ instead _ an autocorrelation analysis , but rather as a complementary study . as a matter of fact",
    ", in specific situations it may happen that an autocorrelation analysis may provide misleading results .",
    "this is for instance the case of chaotic maps with disconnected attractors .",
    "consider the well known logistic map @xmath84 with @xmath85 $ ] and @xmath86 $ ] .",
    "this map generates periodic series for @xmath87 , while for @xmath88 the map generates chaotic ( deterministic and aperiodic ) series ( besides regions where the orbit turns regular again , called islands of stability [ peitgen _ et al .",
    "_ 1992 ] ) . in the chaotic region ,",
    "the chaotic attractor is the whole interval @xmath89 $ ] only for @xmath90 .",
    "concretely , for @xmath91 $ ] the attractor is partitioned in two disconnected chaotic bands , and the chaotic orbit makes an alternating journey between both bands . in figure [ t2_caos ]",
    "we have plotted a time series of @xmath92 data generated through the logistic map at @xmath93 .",
    "note that the map is ergodic , but the attractor is not the whole interval , as there is a gap between both chaotic bands .",
    "in this situation , the chaotic series is by definition not periodic , however , an autocorrelation function analysis indeed suggests the presence of periodicity ( see the left panel of figure [ t2_caos_todas ] ) , what is reminiscent of the disconnected two - band structure of the attractor .",
    "interestingly enough , applying the aforementioned noise filter technique , at odds with the autocorrelation function , the results suggests that the method does not find any periodic structure , as it should ( middle panel of figure [ t2_caos_todas ] ) .",
    "furthermore , information of both the phase space structure and the chaotic nature of the map becomes accesible from an analysis of the hvgs degree distribution ( plotted in semi - log scale in the right panel of figure [ t2_caos_todas ] ) : first , we find @xmath53 , that indicates that half of the data are located in the bottom chaotic band , in agreement with the alternating nature of the chaotic orbit .",
    "this is reminiscent of the misleading result obtained from the autocorrelation function .",
    "second , the tail of the degree distribution is exponential , with an asymptotic slope smaller than the one obtained rigorously ( theorem [ p_k ] and @xcite ) for a purely uncorrelated process .",
    "this is , according to a recent study on hvgs [ lacasa & toral , 2010 ] , characteristic of an underlying chaotic process .",
    "in this work we have outlined some properties of the hvgs associated to time series extracted from dynamical systems , and have accordingly proposed a method to detect periodicity in signals polluted with noise .",
    "the results suggest that the hvg correctly inherits the hidden periodicity of noisy signals , and can be retrieved by making use of the aforementioned filter in situations where the noise level is not very large ( indeed , the maximum power of the noise is of order @xmath94 , where @xmath95 ) .",
    "+ also , we have found that specific pathological cases where a classical time series analysis yields misleading results , such as in chaotic ( aperiodic ) series generated from chaotic maps with a disconnected attractor , can be efficiently analyzed within this network - based tool .",
    "this approach is radically different from traditional methods for time series analysis since it is based on graph theoretical properties , and therefore can be used as a complementary tool in practical situations .",
    "we have deliberately not tackled the task of systematically comparing the goodness of such graph theoretical method with other standard tools of time series analysis , and have restricted this comparison to checking that an autocorrelation function analysis provides equivalent results for the cases addressed here . in this sense , we must emphasize that the goal of this work is to push forward the state of the art in the visibility theory providing mathematically sound properties , rather than putting the practical usefulness of both methods in direct competence .",
    "+   + * _ acknowledgments _ * the authors acknowledge financial support by the mec ( spain ) through project fis2009 - 13690 and comunidad de madrid through research program modelico ( s2009/esp-1691 ) .",
    "donner r.v . ,",
    "small m. , donges j.f . , marwan n. , zou y. , xiang r. , and kurths j. [ 2011 ] recurrence - based time series analysis by means of complex network methods , _ international journal of bifurcation and chaos _ , in press .",
    "xu x. , zhang j. , and small m. [ 2008 ] superfamily phenomena and motifs of networks induced from time series .",
    "_ * 105 * , 50 .",
    "yang y. , wang j. , yang h. , mang j. [ 2009 ] visibility graph approach to exchange rate series .",
    "_ physica a _ 388 , 20 , 4431 - 4437 .",
    "zhang j. and small m. [ 2006 ] complex network from pseudoperiodic time series : topology versus dynamics .",
    "_ 96 , 238701 ."
  ],
  "abstract_text": [
    "<S> the _ horizontal visibility algorithm _ has been recently introduced as a mapping between time series and networks . </S>",
    "<S> the challenge lies in characterizing the structure of time series ( and the processes that generated those series ) using the powerful tools of graph theory . </S>",
    "<S> recent works have shown that the visibility graphs inherit several degrees of correlations from their associated series , and therefore such graph theoretical characterization is in principle possible . however , both the mathematical grounding of this promising theory and its applications are on its infancy . following this line , here we address the question of detecting hidden periodicity in series polluted with a certain amount of noise . </S>",
    "<S> we first put forward some generic properties of horizontal visibility graphs which allow us to define a ( graph theoretical ) noise reduction filter . </S>",
    "<S> accordingly , we evaluate its performance for the task of calculating the period of noisy periodic signals , and compare our results with standard time domain ( autocorrelation ) methods . finally , potentials , limitations and applications are discussed . </S>"
  ]
}