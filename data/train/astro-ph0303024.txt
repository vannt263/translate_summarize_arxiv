{
  "article_text": [
    "the first - order fermi acceleration in shock waves is a widely known mechanism which generates non - thermal energetic particles in space .",
    "one of the most notable features of this mechanism is the power - law energy distribution of accelerated particles in steady state .",
    "the mechanism works in various shock waves ranging from the earth s bow - shock to ultrarelativistic shocks associated with gamma - ray bursts .",
    "near by the earth , satellites and space - crafts have directly observed energetic particles accelerated by this mechanism .",
    "recent x - ray observations also discovered synchrotron x - rays from energetic electrons in several supernova remnants ( e.g. sn1006 ; see @xcite ) .",
    "these electrons are considered to be accelerated in shock waves by this mechanism and have a power - law distribution .",
    "these observations are believed to be evidence that cosmic - rays with energies below @xmath0 ev ( namely , ` knee ' ) originate from supernova remnants in our galaxy .",
    "since the basic theory was proposed in the late 1970 s , this mechanism has been investigated by numerous authors ( for review see * ? ? ?",
    "* ; * ? ? ?",
    "* ) . while some of recent theoretical interests are focused on the non - linear problems @xcite , some of the linear problems , under the test particle approximation , still remain to be clarified and need more close examinations , especially on the time development of the particle distribution and the acceleration in relativistic shocks . for",
    "non - relativistic shocks , this mechanism is described well by the diffusion - convection equation . solving this equation for steady state , the power - law solution",
    "is derived @xcite .",
    "time - dependent solutions can also be examined based on this equation , usually with the aid of the laplace transformation .",
    "however , to invert the transform in analytical form is generally difficult and analytical solutions were derived only for several mathematically simple cases ( e.g. * ? ? ?",
    "@xcite proposed an approximation for more general situations by re - normalizing one of the analytical solutions using the first two cumulants of the particle distribution , which can be obtained in analytical form .",
    "@xcite investigated the effects of the synchrotron losses on the time - dependent solution for momentum - independent diffusion coefficients and calculated solutions by numerical inversion of the laplace transforms .",
    "recently , the particle acceleration in relativistic shocks has attracted some attention in relation to agn jets , grbs or ultra - high energy cosmic rays . in this situation ,",
    "the problem becomes more difficult because the anisotropy in the particle distribution is not negligible and , as a result , the diffusion - convection equation is no longer valid . returning to the boltzmann equation , @xcite derived the steady - state solution by means of a semi - analytical approach , performing the eigenfunction expansion .",
    "this approach was recently extended to ultrarelativistic shocks @xcite .",
    "however , the time development still has not been treated in this way .",
    "there is an alternative approach established by @xcite which is based on the acceleration process of individual particles . from this approach",
    ", the acceleration process is described as _ a stochastic process _ of individual particles ; particles are accelerated whenever they repeat the cycle of crossing and re - crossing of the shock front , where the energy gain per one - cycle and the cycle - time are both regarded as stochastic variables .",
    "the description needs not introduce the assumption of the isotropy on the particle distribution .",
    "it can therefore be naturally extended to the acceleration in relativistic shocks @xcite . in our previous paper @xcite",
    ", we investigated the acceleration process in relativistic shocks from this approach utilizing random walk theory .",
    "however , because the previous studies dealt only with the energy gain per one - cycle and not with the cycle - time , they are restricted within the steady problems and can not treat the time development of the distribution of particles , even for non - relativistic shocks .",
    "furthermore , the derivation of the distribution function of particles from this approach and that of the power - law index are still not satisfactorily established .",
    "monte carlo simulations , the third approach , can make a direct estimation of the distribution function even for relativistic and ultrarelativistic shocks @xcite .",
    "however , it needs a large - scale simulation to obtain sufficiently accurate results , and physical interpretations of the results in terms of analytical models are also desirable .    in this paper , we reanalyse the acceleration process based on a stochastic , single - particle approach . by treating the cycle - time as a stochastic variable explicitly",
    ", our method can describe the time development of the particle distribution function .",
    "the method is also applicable to relativistic and ultrarelativistic shocks as well as non - relativistic shocks .",
    "the paper is organized as follows . in section [ sec : description ] , we formulate the mechanism as a stochastic process . in section [ sec : solution ] , for a case where the property of the one - cycle of the shock crossings has a scaling law in momentum , we investigate steady and time - dependent solutions of the distribution function of particles by an analytical way . in section [ sec : application ] , as a check , we apply this theory to non - relativistic shocks and compare the results with conventional results . in section [ sec : discussion ] , we consider relations between the one - cycle properties and the resulting particle distribution function for both steady and time - dependent case .",
    "conclusions are given in section [ sec : conclusions ] .",
    "in this section , we formulate the acceleration process of a particle as a stochastic process , and then relate it with the distribution function of particles .",
    "we also give numerical methods for obtaining the solution .      from the single particle point of view",
    ", the basic mechanism of the particle acceleration is explained as follows .",
    "first , because of scattering caused by magnetic irregularity existing in the plasma in both sides of the shock front , particles move like random walk and , as a result , a fraction of the particles can repeat crossing and re - crossing of the shock front many times ; this can be modelled by that in each cycle of the shock crossing , a particle in the downstream region returns to the shock front at a returning probability @xmath1 , and otherwise escapes from the acceleration region .",
    "second , since the electric field approximately vanishes in the respective plasma ( or ` fluid ' ) rest frames in both regions , the energy of a particle measured in the respective rest frames is unchanged while the particle stays in one of the regions . consequently , in a fixed reference frame , particles gain energy whenever they repeat the crossing cycle , owing to the difference between the fluid speeds ; in particular for sufficiently relativistic particles , letting the relative fluid speed between the upstream and downstream region be @xmath2 and its lorentz factor be @xmath3 , we can calculate the energy gain of a particle for one - cycle of the shock crossings , that is , a downstream to upstream to downstream cycle , by performing two successive lorentz transforms together with the above condition : @xmath4 where @xmath5 and @xmath6 are the magnitudes of momentum of the particle before and after the cycle , respectively . @xmath7 and @xmath8 are the angles at the shock crossing from the downstream to upstream region measured in the downstream rest frame and from the upstream to downstream region measured in the upstream rest frame , respectively . considering the possible ranges of these angles to cross the shock front",
    ", it is straightforwardly shown that the energy always increases at every shock crossing cycle ( here , energy loss mechanisms are not taken into account ) .",
    "because these angles are regarded as stochastic variables on account of the scattering process , the energy gain is also regarded as a stochastic variable .",
    "owing to the diffusive motion of the particles , the cycle - time is also regarded as a stochastic variable .",
    "this is a basic picture of the acceleration mechanism from the single particle point of view .",
    "[ fig : shock_accel ] illustrates the one - cycle of the acceleration process of a particle in a non - relativistic , parallel shock .        from a theoretical viewpoint ,",
    "the problem of the acceleration process consists of two parts .",
    "one is how particles are accelerated for _ one - cycle _ of the shock crossings .",
    "the other is how the distribution function of the particles evolves when the one - cycle properties are given .",
    "the former is determined by details of the scattering process and is quite a difficult problem unless the diffusion approximation is applicable ; the properties of both turbulent magnetic field in the vicinity of the shock front and transport of particles in such turbulent fields themselves remain long - standing problems . on the other hand ,",
    "it is possible to establish a well - defined theory formally for the latter problem . in the present paper",
    ", we therefore construct that theory from the point of view of the single particle approach .      in this paper",
    ", we investigate the acceleration process _ at the shock front _ ; our primary aim is to solve the steady state and time - dependent solution of the distribution function of particles at the shock front .",
    "therefore , we concentrate only on the state of particles , @xmath9 , at the crossing of the shock front , where @xmath10 is the momentum of a particle and @xmath11 is the time respectively ; we measure @xmath10 in the downstream frame and @xmath11 in the shock rest frame , respectively .",
    "the history of acceleration process of a particle observed at the shock front can be described by a sequence of the state of the particle at each end of _ the acceleration cycle _ , that is , at each shock crossing from the upstream to downstream region : @xmath12 such a sequence is terminated when the particle escapes from the acceleration region , usually from the downstream region .",
    "we consider this process in the @xmath13 space where each state of the sequence defines a point , which is called ` state point ' in the following . if the changes in @xmath10 and @xmath11 at each cycle , @xmath14 , are stochastic variables as already mentioned , the acceleration process can be regarded as a stochastic process in the @xmath13 space .",
    "usually , this is a markov process because the changes @xmath14 mostly depend only on the momentum at the last cycle .",
    "although the history of @xmath9 provides complete information of the acceleration process at the shock front , we consider only the history of @xmath15 in this paper , where @xmath16 is the magnitude of the momentum , because only @xmath16 concerns most practical purposes . in order to treat the history of @xmath15 solely as a markov process",
    ", we also assume that the probability density of the changes in @xmath16 and @xmath11 at one - cycle does not depend on the direction of the momentum at the last cycle , at least approximately .",
    "( if this assumption is not appropriate , we must deal with the state of a particle by @xmath17 or @xmath18 , where @xmath19 is the cosine of the angle between the shock normal and the momentum of the particle . ) for considering the acceleration of relativistic particles , it is better to describe this process in a logarithmic momentum space , because the changes in @xmath16 at each cycle are usually multiplicative rather than additive as shown in equation ( [ eq : energy gain ] ) . furthermore , since we consider only mono - energetic injection with a certain momentum of @xmath20 measured in the downstream rest frame in the fundamental part of the following description , we use a new quantity @xmath21 instead of @xmath16 to simplify the description .    thus , the acceleration process of a particle can be considered as a two - dimensional markov process on the @xmath22 plane .",
    "this stochastic process is described by a probability density function which describes the transition on the @xmath22 plane for one cycle of the acceleration , @xmath23 , where @xmath24 and @xmath25 are respectively the changes in @xmath26 and @xmath11 at one - cycle ; @xmath26 in this notation denotes the logarithmic momentum _ at the last cycle _ representing the markov property of this process .",
    "( we also use the term ` step ' instead of ` cycle ' for the point of view of markov process in the following . )",
    "since a particle can be lost from the acceleration region at each cycle at a probability of @xmath27 , this density is a _ defective _ one ; the integration of it over all area is _ not _ normalized to unity , but to the return probability , @xmath28 , as follows : @xmath29 in the present paper , for simplicity , we assume @xmath30 , that is , any energy loss mechanisms are not efficient .",
    "( however , to generalize the following description to include the possibility of @xmath31 is not difficult . )",
    "the correlation between the energy gain @xmath24 and the cycle - time @xmath25 , which can be considerable for relativistic shocks ( see * ? ? ?",
    "* ) , can be included in the functional form of @xmath32 . for later convenience ,",
    "we define here the moments of @xmath24 and @xmath25 as follows : @xmath33 @xmath34 @xmath35 @xmath36 these quantities are generally dependent on @xmath26 at the last cycle .",
    "as already mentioned , although the functional form of @xmath23 is determined by microscopic physics , we do not specify it and discuss the process formally in this paper ( we adopt only an approximate model of @xmath32 in section [ sec : application ] and simple toy - models in section [ sec : discussion ] ) .    defining the probability density function of the state points at @xmath37th step , @xmath38 , the progress from @xmath39th step to @xmath37th step",
    "is expressed by @xmath40 again , the integrals of these @xmath38 s over all area are not normalized to unity , but to the probability at which a particle continues the acceleration cycle _ at least _",
    "@xmath37 times , @xmath41 : @xmath42 since we consider now the case where particles are all injected at the same state of @xmath43 , we have @xmath44    the integral in equation ( [ eq : rho_n ] ) includes a plain convolution with respect to @xmath11 .",
    "it is better to represent such equations in the form of the laplace transform with respect to @xmath11 . introducing the following notation @xmath45 where @xmath46 is a function of @xmath11 , equation ( [ eq : rho_n ] ) is transformed to @xmath47    in a mathematical sense",
    ", the above stochastic process can be regarded as a terminating renewal process in the probability theory ( cf .",
    "* ; * ? ? ?",
    "however , since the present process is two - dimensional and also has a markov property , it is a more complex problem .",
    "furthermore , the stochastic process defined by equation ( [ eq : rho_n s ] ) for a fixed @xmath48 can be regarded as the random walk process dealt with in the previous paper @xcite , except that the present process is _ in @xmath26-space _ with the markov property , always increases the value of @xmath26 and has no absorbing barriers .",
    "a history of acceleration process of a particle can be represented by plotting the state points on the @xmath22 plane .",
    "when such plots are made for many particles and superposed as shown in fig .",
    "[ fig : sequence ] , we can define the density of the state points : @xmath49 where the density is normalized by the number of the particles .",
    "this is a key concept to treat the present problem .     for details ) .",
    "the unit of time is taken the mean cycle - time for @xmath50 .",
    "the density of these points defines @xmath51 in equation ( [ eq : psi_sum ] ) . ]",
    "the physical meaning of the product @xmath52 is the expectation value of number of particles which are initially injected at @xmath53 and then cross the shock front from the upstream to downstream side within ranges @xmath54 $ ] and @xmath55 $ ] , per unit injection .",
    "we can therefore relate this density with the flux and distribution function of the particles at the shock front ( see the following subsection ) .",
    "combining equations ( [ eq : rho_n ] ) and ( [ eq : psi_sum ] ) , we obtain the following integral equation : @xmath56 this equation determines @xmath57 from only @xmath32 , and is a fundamental equation to our description . taking the laplace transform of this integral equation with respect to @xmath11 ,",
    "we obtain @xmath58 for a fixed @xmath48 , this integral equation is regarded as a volterra equation of the second kind . since it is generally difficult to solve this equation in analytical form , we will give numerical methods in section [ sec : numerical solution ] . in the following , we will use the following relation @xmath59 where @xmath60 .",
    "some quantities related with the acceleration process are described in terms of @xmath57 as follows . from equations ( [ eq : rho_n normalization ] ) and ( [ eq : psi_sum ] ) , we obtain @xmath61 where @xmath62 is the expectation value of the number of cycles in an acceleration process .",
    "( the probability at which a particle continues the cycle _ just _ @xmath37 times before escaping is given by @xmath63 . )",
    "the probability at which a particle escapes from the acceleration region before attaining to @xmath26 for @xmath64 is given by @xmath65 because a state point at @xmath26 does not make the next state point at the probability @xmath27 .",
    "we can show @xmath66 as @xmath67 .",
    "the probability at which a particle attains to @xmath26 for @xmath64 is of course given by @xmath68 , and we obtain from equation ( [ eq : pe ] ) @xmath69 note that @xmath70 does not approach unity as @xmath71 but to @xmath72 because @xmath57 includes no contribution from the state points of the particles just injected at @xmath73 , by its definition .",
    "the mean acceleration time for attaining to @xmath26 is defined by @xmath74    from the point of view of the renewal process , the density of state points @xmath57 and the integral equation ( [ eq : integral eq ] ) correspond to the renewal density and the renewal equation , respectively . a concept similar to @xmath57",
    "was also introduced in the previous paper @xcite to deal with the random walk of particles .      here",
    ", we relate the density of state points introduced in the previous subsection with the particle distribution function at the shock front .",
    "we consider the acceleration of relativistic particles in a plane shock , where the velocity of the particles can be approximated by the speed of light @xmath75 in the shock rest frame and in both fluid frames .",
    "consider first an impulsive injection of unit particles with @xmath50 at @xmath76 at the shock front .",
    "letting @xmath19 be the cosine of the angle between the shock normal and the direction of particle momentum measured in the shock rest frame , we can define the distribution function of particles at the shock front for this injection , @xmath77 , where @xmath26 is measured in the downstream rest frame ; @xmath19 and @xmath11 are measured in the shock rest frame . in terms of this function ,",
    "the one - sided flux of particles with logarithmic momentum @xmath26 at the shock front from the upstream to the downstream is represented by @xmath78 where we introduce the following notations : @xmath79 @xmath80 where @xmath81 is , in general , dependent on @xmath26 . on the other hand , as already mentioned , because @xmath82 for the present situation , we obtain the following relation @xmath83 because this @xmath84 can be regarded as a green s function of the time - dependent solution of the distribution function at the shock front , the solution for more general injection rate @xmath85 , @xmath86 , is constructed as @xmath87 where @xmath88 is defined from @xmath89 like @xmath90 , or in the form of the laplace transform @xmath91    in the following , we deal with only the steady injection , that is , @xmath92 for @xmath93 and @xmath94 for @xmath95 . for the case , the steady state solution @xmath96 is given by @xmath97 using the relation ( [ eq : psi_t_inf - psi0 ] ) . in the following , to simplify the notations , we also express the time - dependent solution in terms of the ` cut - off function ' defined by @xmath98 resulting in @xmath99 the laplace transform of this function with respect to @xmath11 is written by @xmath100 because @xmath51 always takes non - negative value , we can see that @xmath101 for any values of @xmath102 for the steady injection ; the time - dependent solution always lies under the envelope of the steady state solution .",
    "this function is identical to the function @xmath103 of @xcite at the shock front @xmath104 [ see equation ( 9 ) of his paper ] , which was used in the analysis of time - dependent solutions of the diffusion - convection equation .",
    "it should be noted that , in some cases , the steady state solution @xmath105 can be evaluated without introducing the density function @xmath57 . substituting equation ( [ eq : dpdp ] ) into equation ( [ eq : f0 + ] ) , we obtain @xmath106 therefore ,",
    "if @xmath70 is estimated by another way , the steady state solution is obtained immediately ; conventional single - particle approaches can estimate @xmath70 approximately ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) and therefore can obtain the steady state solution .",
    "although , to treat the time development of the distribution function , we must treat the function @xmath57 explicitly .      by numerical methods , the integral equation ( [ eq : integral eq s ] )",
    "can be solved straightforwardly ( see chapter 18.2 of @xcite ) . for a given range @xmath107 , dividing the range into @xmath108 meshes with uniform intervals of @xmath109 and adopting the trapezoidal rule to the integral in the equation , and introducing notations @xmath110 , @xmath111 and @xmath112 for @xmath113 ( we omit the dependence on @xmath48 for simplicity here ) , equation ( [ eq : integral eq s ] ) is discretized as follows : @xmath114 @xmath115 where @xmath116 .",
    "thus , @xmath117 s are trivially solved by forward substitution .",
    "note that the interval @xmath118 must be fine enough to resolve the kernel @xmath119 .",
    "once @xmath120 is obtained by this way for each @xmath48 , we can then make a numerical inversion of laplace transform described in appendix [ sec : inversion ] to obtain @xmath51 .",
    "we can also obtain @xmath86 for general injection or @xmath121 for steady injection numerically by inverting equation ( [ eq : fs ] ) or ( [ eq : tiltheta ] ) , respectively .",
    "one of the most well - known features of the first - order fermi acceleration is the power - law distribution function of accelerated particles in steady state . theoretically , it is just a consequent of some scaling laws , or similarities , in the one - cycle probability density function @xmath32 ; in theoretical studies on the first - order fermi acceleration , such a scaling law is usually assumed implicitly or explicitly .",
    "the scaling - law may realize when , for example , the power spectrum of the turbulent magnetic field has a power - law feature .",
    "the fact that the power - law distribution is really observed in various shocks may indicate such a scaling law often realizes well . in the following ,",
    "we also examine such a case in an analytical way .",
    "we consider here the case in which the transition of each step @xmath122 satisfies the following scaling law ; for normalized variables @xmath24 and @xmath123 , where @xmath124 is a constant parameter , the probability distribution function defined for these variables is independent of @xmath26 at the last step or , in other words , common for all @xmath26 .",
    "this means that the one - step probability density @xmath23 can be represented by a single function @xmath125 as @xmath126 and @xmath127 the similarity of this function is clear . note that @xmath128 , @xmath27 and the moments of @xmath24 are all independent of @xmath26 : @xmath129 and @xmath130 where @xmath131 .",
    "the integral equation ( [ eq : integral eq s ] ) is reduced to @xmath132        we first consider the steady state solution here . setting @xmath133 in equation ( [ eq : integral eq2 ] )",
    ", we have @xmath134 again , denoting the laplace transform with respect to @xmath26 by @xmath135 where @xmath136 is a function of @xmath26 , we can write the exact solution of equation ( [ eq : integral eq s0 ] ) in the form of the laplace transform as follows @xmath137 as well known , the inversion of this transform is given through the bromwich integral on the complex @xmath138-plane : @xmath139 where @xmath140 is a real constant taken so that the vertical line @xmath141 lies on the right of the all poles of @xmath142 $ ] . while the numerical solution can be obtained directly ( see appendix [ sec : inversion ] ) , we investigate the asymptotic behaviour of equation ( [ eq : bromwich ] ) here .    assuming that @xmath143 as @xmath144 ( we expect this condition usually holds ) , the contour of the integral in the last equation is closed through the left of the @xmath138-plane .",
    "the integrand obviously has poles at the points where the condition @xmath145 is satisfied . because @xmath146 and @xmath147 the equation @xmath145 has the unique negative root on the real axis of the complex @xmath138-plane .",
    "we write this root as @xmath148 . as @xmath26 becomes sufficiently large , because only the pole at @xmath148 dominantly contributes to the integral ( [ eq : bromwich ] ) , we obtain the asymptotic solution @xmath149 @xmath150 where @xmath151 ( @xmath152 ) and @xmath153 the index @xmath154 is , by definition of @xmath148 , determined as the unique positive root of @xmath155 recalling @xmath156 , the steady state solution ( [ eq : f0 + ] ) for large @xmath26 is written by @xmath157 where @xmath158 .",
    "this is the power - law solution whose index is given by @xmath159 .      if the dispersion of @xmath24 , @xmath160 , is negligible in equations ( [ eq : lambda determine ] ) and ( [ eq : a ] ) , namely @xmath161 , we can approximate @xmath162 there , resulting in @xmath163 this expression is equivalent to equation ( 5 ) of @xcite .",
    "we will mention the validity of this formula again in section  [ sec : discussion ] .",
    "the condition to use this approximation can be rewritten as @xmath164 furthermore , if @xmath165 , we have @xmath166 on the other hand , if @xmath167 and @xmath161 , expanding @xmath168 to the first - order of @xmath169 in both equations ( [ eq : lambda determine ] ) and ( [ eq : a ] ) , we obtain @xmath170 as shown in section [ sec : application ] , this approximation is applicable to the acceleration in non - relativistic shocks .        here , we show that the time - dependent solution of equation ( [ eq : integral eq2 ] ) has a self - similarity for @xmath171 .",
    "firstly , for @xmath171 , we have approximately @xmath172 this equation must be regarded as a _ relation _ for large @xmath26 , _ not _ as an integral equation defined over all region of @xmath26 ; such an integral equation would have only a trivial zero solution . for a positive constant @xmath173",
    ", it is seen that the function defined by @xmath174 also satisfies the above relation instead of @xmath175 ; in other word , the relation does not change its form under the transformation @xmath176 and @xmath177 simultaneously .",
    "secondly , the steady state solution ( [ eq : psi0 asymptotic ] ) , which is regarded as a ` boundary condition ' at @xmath133 , is only multiplied by the constant @xmath178 under this transformation . finally , because the relation ( [ eq : relation asym ] ) is linear , we obtain the following _ self - similarity _ of the density of state points for @xmath171 : @xmath179 @xmath180 for the cut - off function , we obtain @xmath181 defining functions for @xmath16 instead of @xmath26 , @xmath182 and @xmath183 , we obtain @xmath184 @xmath185    for later convenience , we derive a relation between the steady state solution and the time - dependent solution here . because @xmath186 is usually a concentrated function of @xmath11 , the laplace transform of it , @xmath187 , has a characteristic value of @xmath188 so that @xmath187 can be approximated by @xmath189 for @xmath190 .",
    "therefore , in the region of @xmath191 plane where the condition @xmath192 is satisfied , the integral equation ( [ eq : integral eq2 ] ) is approximated by @xmath193 resulting in @xmath194 in that region .",
    "thus , we can define @xmath195 so that we have @xmath194 for @xmath196 and @xmath197 .      when @xmath175 varies with @xmath26 much more slowly than @xmath198 , we can approximate in the integrand of equation ( [ eq : integral eq2 ] ) as @xmath199 a rough criterion to use this approximation may be given by @xmath167 and @xmath161 , since the typical variation scale of @xmath57 is given by @xmath200 for the steady state solution ( [ eq : psi0 asymptotic ] ) .",
    "thus , for @xmath171 , the integral equation ( [ eq : integral eq2 ] ) is reduced to @xmath201 where @xmath202 for a fixed @xmath48 , equation ( [ eq : b_differential ] ) can be regarded as an ordinary differential equation for @xmath203 , and the solution is given by @xmath204 ,      \\label{eq : tilpsi_solution_1}\\ ] ] where @xmath205 and @xmath206 are functions of @xmath48 ; we can choose the function @xmath206 arbitrarily here . if we choose @xmath207 , which was defined in equation ( [ eq : q_ast ] ) , we can determine @xmath208 , because @xmath209 for @xmath210 .",
    "thus , the solution is written by @xmath211.\\ ] ] it is easily seen that the above expression satisfies the similarity ( [ eq : self - similar_tilpsi ] ) , because @xmath212 , @xmath213 and @xmath214 .",
    "for @xmath197 , because @xmath215 and @xmath216 , we obtain @xmath217 which is consistent with the steady state solution ( [ eq : psi0 asymptotic ] ) with @xmath154 of equation ( [ eq : lambda a approx2 ] ) . for @xmath171 , where the asymptotic solution ( [ eq : psi0 asymptotic ] ) is applicable for steady state",
    ", we finally obtain the following asymptotic expression @xmath218 where @xmath219 we will use this approximation in the following section .",
    "although it is usually difficult to invert the above expressions analytically , it is able to do it numerically ( see appendix [ sec : inversion ] ) . under the above approximation , the mean acceleration time defined by ( [ eq : accel time ] ) is represented by @xmath220 where @xmath221 denotes the mean cycle - time @xmath222 for @xmath50 .",
    "in order to confirm that our method surely reproduces the well - known results , we apply the method to the acceleration in non - relativistic shocks in this section .",
    "we consider a simple one - dimensional parallel shock as in fig .",
    "[ fig : shock_accel ] with shock speed @xmath223(@xmath224 ) .",
    "the fluid speeds in the upstream and downstream region measured in the shock rest frame are denoted by @xmath225 and @xmath226 , respectively , and are assumed uniform in each region .",
    "the compression ratio is given by @xmath227 .",
    "when we apply our method to a specific case , we must first specify the one - step probability density @xmath32 .",
    "assuming that @xmath32 obeys the scaling law ( [ eq : rho_sym ] ) discussed in the previous section , we derive here an approximate expression of @xmath228 applicable to non - relativistic shocks , by a practical way .",
    "first , because the changes in @xmath26 and @xmath11 at one - cycle are expected to be mutually independent , the dependences of @xmath228 on @xmath24 and @xmath25 can be separable as @xmath229 .",
    "since the particle distribution function at the shock front is approximately isotropic , we have @xmath230 [ cf .",
    "equation ( [ eq : energy gain ] ) , or equation ( 7 ) of @xcite ] .",
    "these two quantities are expected to be small enough , compared with @xmath200 , to use the approximations described in sections [ sec : approximation steady ] and [ sec : approximation time dep ] .",
    "therefore , using these approximations , we can proceed without specifying the functional form of @xmath231 here .",
    "the time dependent part @xmath232 can be approximated as follows with the aid of a solution of the diffusion - convection equation and results of monte carlo simulations . in a one - dimensional diffusion process with a diffusion coefficient @xmath233 in a moving medium with speed @xmath234 , the time distribution function for returning from a distant point at @xmath235 ( @xmath236 ) to a barrier located at @xmath237 is given by @xmath238 }      \\label{eq : gt}\\ ] ] or in the form of the laplace transform @xmath239 } \\right\\}\\ ] ] ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ) , where @xmath234 can be positive or negative and , for the present problem , @xmath240 for the upstream region and @xmath241 for the downstream region . since this function already includes the influence of the escape of particles , the return probability is given by @xmath242 first two moments of the return time @xmath11",
    "are given by @xmath243    however , the above results are not applicable directly to calculate the cycle - time ; in order to do this , we need the distribution of the residence time , that is , the time between entering one of the fluid regions and leaving the region through the shock front , in each region . here , we employ monte carlo simulations to obtain an approximate expression for the residence time distribution .",
    "it is known that , in non - relativistic shocks , the properties of particle motion have little dependence on the details of the scattering process .",
    "thus , we can utilize the large - angle scattering model , which was dealt with the previous paper @xcite , in the simulation to estimate the residence time for isotropic injection of particles at the shock front . performing the monte carlo simulations",
    ", we found that the distribution of the residence time for isotropic injection at the boundary _ is approximated well _ by @xmath244 in equation ( [ eq : gt ] ) if we set the parameters for the diffusion process as follows : @xmath245 where @xmath246 is the mean free time of the particles , defined for the large - angle scattering model , measured in the fluid rest frame .",
    "thus , we can use @xmath244 with @xmath247 as an approximation of the residence time distribution for each region . taking the convolution between the residence time distributions for the upstream and downstream region ,",
    "we finally obtain the distribution of the cycle - time in the form of laplace transform @xmath248 \\bigr\\ } ,          \\label{eq : tilg}\\end{aligned}\\ ] ] where @xmath249 and @xmath250 ; the diffusion coefficients in the upstream and downstream region are denoted by @xmath251 and @xmath252 , respectively .",
    "[ fig : cycle_time_dist ] shows the cycle - time distribution calculated for @xmath253 and @xmath254 , where we take @xmath255 .",
    "the solid curve represents the result obtained by inverting equation ( [ eq : tilg ] ) numerically and the dots are the results from the monte carlo simulation .",
    "we see that the approximation fits the simulation results quite well .",
    "note that , this distribution is very skew and peaks at @xmath256 , which are prominent features of the diffusion process owing to the random walk motion of the particles .",
    ", @xmath254 .",
    "the solid curve is the approximate solution , @xmath257 , obtained by inverting equation ( [ eq : tilg ] ) numerically .",
    "the dots are results from a monte carlo simulation . ]",
    "thus , we can write an approximated form of @xmath198 : @xmath258 with the quantities in ( [ eq : dq_sgmdq_approx ] ) .",
    "obviously , the return probability at one - cycle is given by @xmath259 which is essentially in agreement with the previous results ( e.g. * ? ? ?",
    "the first two moments of the cycle - time are given by @xmath260 the former result coincides with the previous result derived from the diffusion - convection equation @xcite .",
    "the state points shown in fig .",
    "[ fig : sequence ] were also obtained by the monte carlo simulations performed above with the same parameter as in fig .",
    "[ fig : cycle_time_dist ] .",
    "because of the isotropy of the particle distribution at the shock front , we have @xmath261 because @xmath262 and @xmath263 , using the approximations in ( [ eq : lambda a approx2 ] ) , we obtain @xmath264 substituting the above results into equation ( [ eq : fzp asymptotic ] ) , the steady state solution for large @xmath16 is given by @xmath265 with @xmath266 , where @xmath267 . in terms of the isotropic part of the usual phase - space distribution function @xmath268 ,",
    "where @xmath269 is distance from the shock front , we have the following relation : @xmath270 we therefore obtain @xmath271 where @xmath272 is the mono - energetic , isotropic injection rate defined for @xmath273 , with which @xmath274 at the shock front .",
    "note that , @xmath272 has the following relation with @xmath275 : @xmath276 the above result ( [ eq : phase - space steady solution ] ) is equivalent to the previous results [ e.g. equation ( 3.24 ) of @xcite was however missing there . ] ] .",
    "the time - dependent solution is obtained as follows .",
    "adopting the approximation ( [ eq : approx_tilpsi ] ) , we can obtain the solution of @xmath120 with @xmath277 @xmath278 then , @xmath279 is given by equation ( [ eq : tiltheta ] ) .",
    "inverting these results numerically , we finally obtain @xmath51 and @xmath121 . fig .",
    "[ fig : psi ] represents the time development of @xmath51 calculated for @xmath280 , @xmath254 , @xmath281 , @xmath255 and @xmath282 in the unit of @xmath221 . the self - similarity given by equation ( [ eq : self - similar_psi ] ) is evident .",
    "[ fig : theta ] represents the time development of @xmath121 calculated for the same parameters as in fig .",
    "[ fig : psi ] except that @xmath283 .",
    "the solutions given by the present method ( solid curves ) fit the results from monte carlo simulations ( dots ) quite well .",
    "it is interesting to make a comparison between the cut - off function by our method and that by the approximation of @xcite .",
    "the first two cumulants @xmath284 in his approximation [ see equations ( 25 ) and ( 26 ) in his paper ] are determined as follows .",
    "in the present situation , the diffusion coefficients are expressed as @xmath285 , where @xmath286 is the diffusion coefficient for particles with the injection momentum @xmath20 . from equation ( [ eq : t_cyc_mean ] )",
    "we can determine @xmath286 in terms of @xmath221 as @xmath287 using this relation , we determine for the present situation @xmath288 @xmath289 { { { \\langle { \\delta t}\\rangle}}_0}^2.\\ ] ] substituting these results into equation ( 22 ) of @xcite , we obtain the approximated cut - off function represented in fig .  [",
    "fig : theta ] by dotted curves . as",
    "mentioned in his paper , this approximation do not provide satisfactory fits for high energy tail of the distributions , while it provides fairly good fits for lower energies [ see also fig .  4 of his paper ] .",
    "for a non - relativistic shock with @xmath280 and @xmath254 .",
    "we take @xmath281 , @xmath290 and @xmath282 , where the unit of time is the mean cycle - time for @xmath50 .",
    "the self - similarity given by equation ( [ eq : self - similar_psi ] ) is evident for large @xmath26 . ]    .",
    "the parameters are the same as in fig .",
    "[ fig : psi ] , except that t=100 , 500 , 2500 .",
    "the solid curves are numerically inverted solutions by the present method , and the dots are results from monte carlo simulations .",
    "the dotted curves are the approximate solution of drury ( 1991 ) . ]",
    "recently , the acceleration of particles in ultrarelativistic shocks has attracted some attention in relation to the ultrahigh - energy cosmic rays or high - energy particles at the external shocks associated with gamma - ray bursts .",
    "many works on this issue ( theories and simulations ) showed that in such shocks the energy gain at one - cycle is approximately given by @xmath291 , owing to the characteristics of the trajectory of particles in the upstream region , and the power - law index is typically given by @xmath292 ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the deviation of @xmath24 , @xmath160 , becomes the same order of @xmath293 .",
    "although peacock s formula ( [ eq : lambda approx1 ] ) has been often used in the literature to calculate the power - law index ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , it can deviate from the true value because the criterion ( [ eq : approx_criterion ] ) may not hold in this situation .",
    "in addition , it has been shown that the cycle - time can be dominated by the upstream residence time @xcite . because the distribution of the upstream residence time in ultrarelativistic shocks can be much different from that of non - relativistic shocks ( cf .",
    "[ fig : cycle_time_dist ] and fig.10 of @xcite ) , the feature of the cut - off function can be also different from that of non - relativistic shocks considerably .    to give some insights into these issues",
    ", we briefly investigate here how the properties of the one - step probability density function , that is , the stochastic properties of @xmath24 and @xmath25 , affect the shape of the resulting particle distribution , for several toy models .",
    "we assume the scaling law ( [ eq : rho_sym ] ) discussed in section [ sec : solution ] and the following separable form @xmath294 for the following all models , we adopt @xmath295 , @xmath296 , @xmath297 and @xmath281 .",
    "first , in order to investigate the influence of the dispersion of @xmath24 , we consider the following two simple models : @xmath298 ( model 1 ) , and @xmath299 ( model 2 ) , where @xmath300 is the unit step function : @xmath301 for @xmath302 , @xmath303 for @xmath304 and @xmath305 for @xmath237 .",
    "the standard deviation of @xmath24 for model 2 is a half of that for model 1 . for both models ,",
    "we adopt @xmath306 these models may represent typical features of the energy - gain and cycle - time in ultrarelativistic shocks which were examined by @xcite by monte carlo simulations . for model 1 ,",
    "solving equation ( [ eq : lambda determine ] ) numerically , we obtain the power - law index of @xmath307 , while model 2 gives @xmath308 .",
    "this result explicitly shows that the power - law index @xmath154 is generally dependent not only on @xmath293 but also on the dispersion @xmath160 , although this fact is rather evident from equation ( [ eq : lambda determine ] ) . because the criterion ( [ eq : approx_criterion ] ) is not satisfied for both models , especially for model 1 , peacock s formula ( [ eq : lambda approx1 ] ) , which gives @xmath309 for both models , deviates from the true value .",
    "[ the dispersion of @xmath24 is neglected in the derivation of equation ( [ eq : lambda approx1 ] ) and that of @xcite .",
    "] this fact may also be responsible for the small discrepancy in the power - law indices in fig.14 of the previous paper @xcite between our results , which utilized the formula ( [ eq : lambda approx1 ] ) , and those of @xcite , which were determined by fitting results from monte carlo simulations .",
    "[ fig : model1_2 ] ( a ) shows the steady state and time - dependent solutions of the distribution function of particles ( in an arbitrary unit ) and fig .",
    "[ fig : model1_2 ] ( b ) shows the cut - off functions , for both models .",
    "these solutions are obtained by the numerical method given in section [ sec : numerical solution ] .",
    "the time - dependent solutions are calculated at @xmath310 .",
    "it is seen that model 2 ( dotted curve ) has a sharper cut - off than model 1 ( solid curve ) , owing to the smaller dispersion of @xmath24 than that of model 1 .    .",
    "the solid curves denote model 1 and the dotted curves denote model 2 . ]",
    "then , we investigate the influence of the dispersion of @xmath25 on the distribution function .",
    "we define model 3 , which has a ` diffusive ' nature on the cycle - time , by @xmath311 where @xmath244 was defined in equation ( [ eq : gt ] ) .",
    "although @xmath244 was derived from the diffusion - convection equation for the return - time distribution function , not for the cycle - time , it may partly represent essential behaviour of the cycle - time distribution for the present situation when the motion of particles is mainly diffusive . in this equation",
    ", we use the _ normalized _ distribution @xmath312 , where @xmath313 , @xmath314 and @xmath315 so that @xmath316 [ cf . equations ( [ eq : pret_diffusion])([eq : a and d ] ) ] , and take the return probability @xmath295 independently .",
    "@xmath317 is taken the same as in model 1 ; the spectral index @xmath154 of model 3 therefore equals to that of model 1 .",
    "[ fig : model1_3 ] ( a ) shows the distribution function of particles and ( b ) the cut - off function , for model 1 ( solid curve ) and model 3 ( dotted curve ) as in fig .",
    "[ fig : model1_2 ] .",
    "although both models have the same mean cycle - time @xmath222 , the shapes of high - energy tails are considerably different .",
    "this is attributed to the large dispersion of @xmath25 in model 3 .     except that the dotted curves denote model 3 .",
    "although both models have the same mean cycle - time , the shape of the high energy tails are considerably different from each other . ]",
    "these features may be observed from the densities of state points shown for the three models in fig .  [",
    "fig : psi_123 ] .",
    "note that all models have the same mean cycle - time @xmath222 and these densities are proportional to the distribution functions of particles at the shock front for an impulsive injection .",
    "in particular for the diffusive model ( model 3 ) , on account of its large dispersion of @xmath25 , there are particles which are accelerated effectively compared with the other models while inefficiently accelerated particles also exist .    .",
    "in this paper , we have given a new description of the first - order fermi acceleration in shock waves based on a stochastic , single - particle approach .",
    "the method can treat the time development of the particle distribution and determine the power - law index exactly , even for relativistic shocks .    in section [ sec : description ]",
    ", we have formulated the mechanism from the point of view of stochastic process . representing the properties of the one - cycle of shock crossings of particles by a probability density function @xmath32",
    ", we have formulated the acceleration process as a two - dimensional markov process on the @xmath22 plane . introducing the density of state points in equation ( [ eq : psi_sum ] ) ,",
    "we have derived a fundamental integral equation ( [ eq : integral eq ] ) for describing this stochastic process .",
    "then we have related the density of state points with the distribution function of particles at the shock front .",
    "we have also given numerical methods to solve the integral equation .",
    "in section [ sec : solution ] , we have investigated the case where the one - step probability density function satisfies the scaling law given by equation ( [ eq : rho_sym ] ) .",
    "investigating the asymptotic behaviour of the steady state solution , we have confirmed that these are characterized by the power - law distribution in momentum space , and derived the equation ( [ eq : lambda determine ] ) which determines the power - law index exactly for general cases .",
    "we have also shown that the time - dependent solutions satisfy the similarity law given by equation ( [ eq : self - similar_psi ] ) except for momentum near the injection .",
    "then we have derived an approximate solution which is applicable to the acceleration in non - relativistic shocks .    in section [ sec : application ] , we have applied the theory to non - relativistic shocks as a check of our method .",
    "we have confirmed that the steady state solution obtained by our method coincides with the well - known previous results obtained by various methods and that the time - dependent solution essentially coincides with the results of monte carlo simulations .",
    "finally , we have examined the relation between the property of the one - step probability density function and the steady and time - dependent solution , in section [ sec : discussion ] .",
    "we have explicitly shown that the power - law index @xmath154 generally depends not only on the mean energy gain @xmath293 but also on the dispersion of @xmath24 , @xmath160 .",
    "this can be important for relativistic shocks .",
    "we have shown that the distribution of @xmath25 for the diffusion process results in a quite broad high - energy tail in the distribution function of particles and the cut - off function compared with the uniform distribution such as ( [ eq : vphi_t_1 ] ) even for the same mean cycle - time , because of its large dispersion @xmath318 .",
    "this work is supported in part by act - jst ( t.n.k . ) and in part by a grant - in - aid for scientific research from the ministry of education and science of japan ( no.13440061 , f.t . ) .",
    "here , we briefly explain the numerical method for inversion of laplace transforms used in this paper . the method is based on @xcite ( see also * ? ? ?",
    "first , the inversion formula of laplace transform is given by @xmath319 \\cos(yt ) dy,\\end{aligned}\\ ] ] where @xmath140 is a real constant taken so that the vertical line @xmath320 lies on the right of the all poles of @xmath321 .",
    "applying the trapezoidal rule to calculate the above integral with the step size @xmath322 , we obtain @xmath323 ,      \\label{eq : inversion formula}\\ ] ] where @xmath324 relates to the numerical precision ( @xmath325 for the precision of @xmath326 ) , and @xmath327\\ ] ] with @xmath328 and @xmath329 .",
    "the number of terms to be summed , @xmath37 , should be chosen carefully for each problem .",
    "( in this paper , we choose @xmath330 . ) in order to calculate the sum in equation ( [ eq : inversion formula ] ) , which is an alternating series if @xmath331 does not change the sign , we apply euler s transformation with van wijgaarden s algorithm ( see chapter 5.1 of @xcite ) .",
    "the essence of our code implemented in c++ is as follows :          // euler summation ( van wijngaarden 's algorithm )    double sum , sgn , wk[nmax+1 ] ;    int k = 0 ;    sgn = -1.0 ;    sum = 0.5*(wk[0]=0.5*real(fs(cplxd(x,0 ) ) ) ) ;    for ( int m=1 ; m < n ; m++ , sgn =- sgn ) {      double nxt , cur ;      nxt = sgn*real(fs(cplxd(x , m*h ) ) ) ;      for ( int j=0 ; j<=k ; j++ ) {        cur = wk[j ] ; wk[j ] = nxt ;        nxt = 0.5*(cur+nxt ) ;      }      sum + = ( fabs(nxt)>fabs(cur ) ) ?",
    "nxt : 0.5*(wk[++k]=nxt ) ;    }    return exp(0.5*a)/t * sum ; } ....    here , we use the template class ` complex ` included in the c++ standard library . in the arguments of the function , ` fs(const cplxd & s ) ` is a user - supplied , complex - valued function @xmath321 to be inverted , ` t ` is the time @xmath11 for evaluation , ` n ` is the number of terms to be summed in ( [ eq : inversion formula ] ) @xmath37 , and ` a ` is @xmath324 mentioned above .",
    "abate j. , whitt w. , 1995 , orsa journal on computing , 7 , 36 achterberg a. , gallant y. a. , kirk j. g. , guthmann a. w. , 2001 , mnras , 328 , 393 axford w. i. , leer e. , skadron g. , 1977 , proc.15th int .",
    "cosmic ray conf.(plovdiv ) , 11 , 132 bednarz j. , ostrowski m. , 1996 , mnras , 283 , 447 bednarz j. , ostrowski m. , 1998 , phys .",
    "lett . , 80 , 3911 bell a. r. , 1978 , mnras , 182 , 147 berezhko e. g. , ellison d. c. , 1999 , apj , 526 , 385 blandford r. d. , ostriker j. p. , 1978",
    ", apj , 221 , l29 blandford r. d. , eichler d. , 1987 , phys . rep .",
    ", 154 , 1 cox d. r. , miller h. d. , 1965 , the theory of stochastic processes .",
    "methuen , london drury l. oc .",
    ", vlk h. j. , 1981 , apj , 248 , 344 drury l. oc . , 1983 , rep .",
    "phys , 46 , 973 drury l. oc . , 1991 , mnras , 251 , 340 ellison d. c. , jones f. c. , reynolds s. p. , 1990 ,",
    "apj , 360 , 702 ellison d. c. , baring m. g. , jones f. c. , 1996 , apj , 473 , 1029 feller w. , 1971 , an introduction to probability theory and its applications vol.ii ( 2nd ed . ) , john wiley & sons , new york fritz k. d. , webb g. m. , 1990 , apj , 360 , 387 gallant y. a. , achterberg a. , 1999 , mnras , 305 , l6 hosono t. , 1984 , fast inversion of laplace transform by basic .",
    "kyouritsu publishers , japan , ( in japanese ) kato t. n. , takahara f. , 2001 , mnras , 321 , 642 kirk j. g. , schneider p. , 1987a",
    ", apj , 315 , 425 kirk j. g. , schneider p. , 1987b",
    ", apj , 322 , 256 kirk j. g. , guthmann a. w. , gallant y. a. , achterberg a. , 2000 , apj , 542 , 235 koyama k. , petre r. , gotthelf e. v. , hwang u. , matsuura m. , ozaki m. , holt s. s. , 1995 , nat , 378 , 255 krymsky g. f. , 1977 , soviet phys .",
    "dokl . , 22 , 327 lagage p. o. , cesarsky c. j. , 1983 , a&a , 118 , 223 ostrowski m. , 1991 , mnras , 249 , 551 peacock j. a. , 1981 , mnras , 196 , 135 press w. h. , teukolsky s. a. , vetterling w. t. , flannery b. p. , 2002",
    ", numerical recipes in c++ ( 2nd ed . ) , cambridge univ .",
    "press , cambridge toptyghin i. n. , 1980 , space sci ."
  ],
  "abstract_text": [
    "<S> we give a new coherent description of the first - order fermi acceleration of particles in shock waves from the point of view of stochastic process of the individual particles , under the test particle approximation . </S>",
    "<S> the time development of the particle distribution function can be dealt with by this description , especially for relativistic shocks . </S>",
    "<S> we formulate the acceleration process of a particle as a two - dimensional markov process in a logarithmic momentum - time space , and relate the solution of the markov process with the particle distribution function at the shock front , for both steady and time - dependent case . for the case where the probability density function of the energy gain and cycle - time at each shock crossing of the particles obeys a scaling law in momentum , which is usually assumed in the literature , </S>",
    "<S> it is confirmed in more general form that the energy distribution of particles has the power - law feature in steady state . </S>",
    "<S> the equation to determine the exact power - law index which is applicable for any shock speed is derived and it is shown that the power - law index , in general , depends on the shape of the probability density function of the energy gain at each shock crossing ; in particular for relativistic shocks , the dispersion of the energy gain can influence the power - law index . </S>",
    "<S> it is also shown that the time - dependent solution has a self - similarity for the same case .    </S>",
    "<S> acceleration of particles  </S>",
    "<S> shock waves  methods : analytical  methods : numerical  cosmic rays . </S>"
  ]
}