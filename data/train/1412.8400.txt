{
  "article_text": [
    "graph reconstruction is an old and extensive research topic .",
    "it dates back to the _ reconstruction conjecture _ raised by kelly and ulam in 1941 ( see  @xcite ) , which asserts that every graph on at least three vertices is uniquely determined by its collection of vertex deleted subgraphs .    as a natural extension of the reconstruction conjecture ,",
    "numerous papers considered either reconstruction of structures other then graphs ( a research topic proposed by ulam in 1960 ) , or reconstructions of graphs from other information . in the first direction , reconstructed objects include colored graphs , hypergraphs , matroids , relations , and other classes . in the second direction ,",
    "the `` information '' may be @xmath8-vertex deleted subgraphs , edge - deleted subgraphs , elementary contractions , spanning trees , etc . in addition , various papers considered reconstruction of _ parameters of the graph _ instead of its full structure .",
    "such parameters include the order , the degree sequence , planarity , the types of spanning trees , and many others ( see the surveys  @xcite for references ) .    in this paper , we study the problem of reconstructing the geometric structure of a set of points in the plane from its geometric tree graph .    _",
    "tree graphs _ were defined in 1966 by cummins  @xcite in the context of listing all spanning trees of a given connected graph effectively .",
    "the _ tree graph _ @xmath9 of a graph @xmath10 has the spanning trees of @xmath10 as its vertices , and two spanning trees are adjacent if one can be obtained from the other by deleting an edge and adding another edge .",
    "these graphs were studied in a number of papers and were shown to be hamiltonian and to have the maximal possible connectivity ( see , e.g. ,  @xcite ) .    in 1996 ,",
    "avis and fukuda  @xcite defined the _ geometric tree graph _ , as the counterpart of tree graphs in the geometric graph setting .",
    "let @xmath0 be a finite point set in general position in the plane .",
    "the _ geometric tree graph _",
    "@xmath3 is defined as follows .",
    "the vertices of @xmath3 are the simple ( i.e. , non - crossing ) spanning trees ( ssts ) of @xmath1 .",
    "two such vertices are adjacent in @xmath3 if they differ in exactly two edges , i.e. , if one can be obtained from the other by deleting an edge and adding another edge .",
    "geometric tree graphs were shown to be connected  @xcite , and upper and lower bounds on their diameter were established  @xcite .",
    "we study a reconstruction problem for geometric graphs : is the geometric tree graph @xmath3 sufficient for `` reconstructing '' the structure of @xmath1 ? in a sense , this question is a geometric counterpart of the work of sedlek  @xcite , who studied the question whether a graph can be reconstructed from its spanning trees .",
    "as we deal with a geometric setting , we seek to reconstruct the _ geometric structure _ of the graph .",
    "let @xmath0 be a finite set of points in general position in the plane .",
    "the _ geometric structure _ of the complete graph @xmath1 as a geometric graph includes , for any pair @xmath2,[c , d]$ ] of vertex - disjoint edges , the information whether they cross or not .",
    "our main result is the following :    [ thm : main ] for any finite set @xmath0 of points in general position in the plane , the geometric structure of @xmath1 can be reconstructed from the geometric tree graph @xmath3 .    while the proof of the theorem is elementary , it is rather complex , and consists of several stages :    1 .   * maximal cliques in @xmath3 .",
    "* we study thoroughly the structure of maximal cliques in @xmath3 .",
    "we divide these cliques into two types , called `` union max - cliques '' and `` intersection max - cliques '' , and show that given a maximal clique in @xmath3 , one can determine its type .",
    "this study spans section  [ sec : max - cliques ] .",
    "* stars and brushes in @xmath3 . *",
    "we show how to identify the vertices of @xmath3 that correspond to spanning stars and spanning brushes ( i.e. , spanning trees of diameter 3 with a single internal edge ) , by examining the max - cliques to which they belong .",
    "the stars are determined only up to an automorphism of @xmath1 ( obviously , one can not do better ) , and once they are fixed , the brushes are determined uniquely .",
    "this part of the proof is presented in section  [ sec : stars - and - brushes ] .",
    "* the geometric structure of @xmath1 .",
    "* we show how the geometric structure of @xmath1 can be derived from information on the brushes in @xmath3 .",
    "this part is presented in section  [ sec : geom - structure ] .    in the last part of the paper , section  [ sec : general ]",
    ", we consider abstract ( i.e. , non - geometric ) graphs , and show that a variant of the argument developed in sections  [ sec : max - cliques ] and  [ sec : stars - and - brushes ] can be used to prove the following result :    [ thm : main - general ] for any @xmath11 , the automorphism group of the tree graph of @xmath12 is isomorphic to @xmath13 .",
    "our treatment of the geometric reconstruction problem ( i.e. , @xmath1 from @xmath3 ) falls short of this .",
    "it leaves open the ( quite implausible ) possibility that the geometric tree graph @xmath3 has an automorphism @xmath14 , other than the identity , that fixes each star and each brush .",
    "this leaves open , for further research , the following question .",
    "is this true that for any finite set @xmath0 of points in general position in the plane , we have @xmath15 , where @xmath3 is treated as an abstract graph , whereas @xmath1 is treated as a geometric graph ?",
    "in this section we study the structure of maximal ( with respect to inclusion ) cliques in the geometric tree graph @xmath3 .",
    "we divide the maximal cliques into two types , called u - cliques and i - cliques , and our ultimate goal is to determine , given a maximal clique in @xmath3 , what is its type .",
    "we start in section  [ sec : sub : notations ] with a few definitions and notations , to be used throughout the paper . in sections",
    "[ sec : sub : max - cliques - basics ] and  [ sec : sub : geom - meaning ] we describe a classification of the maximal cliques into two types , presented originally in  @xcite , and discuss basic properties of both types .",
    "in order to distinguish between general combinatorial considerations and geometric arguments specific to ssts , we start in section  [ sec : sub : max - cliques - basics ] with a general combinatorial framework , and leave the geometric arguments to section  [ sec : sub : geom - meaning ] .    in sections  [ sec : sub : char - degenerate ] and  [ sec : sub : identify - degenerate ] we study _ degenerate _ maximal cliques , i.e. , maximal cliques of size 2 . in section  [ sec : sub : char - degenerate ] we give a geometric characterization of the situation when a maximal clique is degenerate , and in section  [ sec : sub : identify - degenerate ] we show how to identify whether a given degenerate maximal clique is a u - clique or an i - clique . finally , in section  [",
    "sec : sub : identify - non - degenerate ] we show how to determine whether a given _ non - degenerate _",
    "maximal clique is a u - clique or an i - clique .",
    "the following notations and conventions are used throughout the paper . the straight line that passes through points @xmath16",
    "is denoted by @xmath17 .",
    "the vertex and edge sets of a graph @xmath10 are denoted by @xmath18 and @xmath19 , respectively .",
    "since the set @xmath0 is fixed , we shall always identify a spanning subgraph of @xmath1 ( and , in particular , a spanning subtree ) with its set of edges .",
    "in our study we shall extensively use _ maximal cliques _ of @xmath3 .",
    "these are defined as follows :    a _ max - clique _ in a graph @xmath10 is a maximal ( with respect to inclusion ) clique included in @xmath10 . since any max - clique is a complete graph on its vertex set , we shall identify a max - clique with its set of vertices .",
    "we shall use the following observation on the structure of @xmath3 , proved by avis and fukuda  @xcite .",
    "[ claim : g(p)-connected ] for any set @xmath0 of points in general position in the plane , @xmath3 is connected and its diameter is @xmath20 .      a generic combinatorial way to treat a tree graph is to consider a base set @xmath21 and a graph @xmath10 whose vertices are @xmath22-subsets of @xmath21 ( not necessarily all the @xmath22-subsets ) , such that two vertices @xmath23 are adjacent if and only if @xmath24 .",
    "( in the case of the ( geometric ) tree graph of a point set @xmath0 , we have @xmath25 , @xmath26 , and the vertices of @xmath10 are the sets of edges of ( simple ) spanning trees of @xmath1 . )",
    "let @xmath27 be two adjacent vertices of @xmath10 .",
    "denote @xmath28 a third vertex @xmath29 is a common neighbor of @xmath30 and @xmath31 if and only if :    1 .",
    "@xmath32 and @xmath33 . in this case",
    ", @xmath34 is obtained from @xmath35 by adding a single element .",
    "2 .   @xmath36 and @xmath37 . in this case",
    ", @xmath34 is obtained from @xmath38 by removing a single element .",
    "( it is easy to see that in any other case , either @xmath39 or @xmath40 . )    if @xmath41 are both common neighbors of @xmath30 and @xmath31 , such that @xmath34 satisfies ( 1 ) and @xmath42 satisfies ( 2 ) , then clearly , @xmath43 .",
    "hence , if two common neighbors of @xmath30 and @xmath31 are themselves neighbors , then either both satisfy ( 1 ) or both satisfy ( 2 ) . on the other hand ,",
    "it is clear that any two common neighbors satisfying ( 1 ) are themselves neighbors , and the same holds for ( 2 ) .",
    "thus , any pair @xmath44 of adjacent vertices of @xmath10 is included in at most two max - cliques :    1 .",
    "@xmath45 , and 2 .",
    "@xmath46 .",
    "for any two elements @xmath47 , the union @xmath48 is constant ( and equal to @xmath38 ) .",
    "likewise , for any two elements @xmath49 , the intersection @xmath50 is constant ( and equal to @xmath35 ) .",
    "this is the motivation behind the following definition .",
    "a max - clique of the first type will be called a union max - clique , or a _ u - clique _ , and a max - clique of the second type will be called an intersection max - clique or an _ i - clique_.    [ remark : three - determine ] it is clear that given two vertices @xmath44 of a max - clique @xmath34 , we can not determine whether @xmath34 is a u - clique or an i - clique .",
    "however , if we are given a third vertex @xmath51 , we can determine the type , according to which one of the equalities @xmath52 , @xmath53 holds .",
    "moreover , once we determine that @xmath34 is , say , an i - clique , we know that @xmath54 as this is the unique i - clique that includes @xmath30 and @xmath31 . hence , three vertices of a max - clique determine it uniquely .",
    "if @xmath55 , we say that @xmath56 is a _ degenerate u - clique_. similarly , if @xmath57 , we say that @xmath56 is a _ degenerate i - clique_.    for a pair of adjacent vertices @xmath44 , there are four possible situations :    1 .",
    "@xmath58 and @xmath59 . in this case , there are exactly two max - cliques that contain @xmath30 and @xmath31 .",
    "2 .   @xmath58 and @xmath60 . in this case",
    ", there is a unique max - clique that contains @xmath30 and @xmath31 , namely @xmath61 .",
    "( the i - clique that contains @xmath30 and @xmath31 is degenerate . ) 3 .   the same as ( 2 ) , with the roles of @xmath61 and @xmath62 interchanged .",
    "4 .   @xmath63 . in this case , the set @xmath56 itself is a max - clique ( that is , both a u - clique and an i - clique ) . as we shall see in the sequel , this situation can not occur in our geometric setting .",
    "now we turn to the geometric graph @xmath3 and show additional properties of max - cliques that follow from its geometric structure . in order to make our notation suggestive",
    ", we denote now the two adjacent vertices of @xmath3 by @xmath64 , and the edges in their symmetric difference by @xmath65 and @xmath66 .",
    "in @xmath3 , u - cliques and i - cliques have a geometric meaning",
    ".    1 .   * @xmath67 . *",
    "consider the graph @xmath68 .",
    "obviously , it is a connected graph with a unique cycle .",
    "this cycle contains @xmath69 and @xmath70 , and is simple if and only if @xmath69 and @xmath70 do not cross .",
    "( note that @xmath70 can not cross another edge of @xmath71 , as both these edges belong to the sst @xmath72 . ) as shown above , @xmath61 consists of all vertices of @xmath3 that are obtained from @xmath73 by removing a single edge .",
    "since the vertices of @xmath3 are the edge sets of ssts , we can say that removing an edge ( other than @xmath74 ) from @xmath73 results in an element of @xmath67 if and only if the unique cycle of @xmath73 is simple , and the removed edge belongs to that cycle .",
    "note that if @xmath74 cross , then removal of any edge other than @xmath74 from @xmath73 results in a non - simple graph , and thus , the only elements of @xmath67 are @xmath71 and @xmath72 .",
    "* @xmath75 . *",
    "consider the graph @xmath76 .",
    "obviously , it is a simple forest with two connected components . as shown above , @xmath62 consists of all vertices of @xmath3 that are obtained from @xmath77 by adding a single edge .",
    "since the vertices of @xmath3 are the edge sets of ssts , we can say that adding an edge to @xmath77 results in an element of @xmath62 if and only if that edge makes the forest @xmath77 into a simple spanning tree of @xmath1 .",
    "the geometric interpretation allows us to characterize the cases when u - cliques and i - cliques are degenerate .",
    "[ claim : deg - u - clique ] let @xmath64 be ssts such that @xmath78 and @xmath79 .",
    "the u - clique @xmath67 is degenerate if and only if @xmath69 and @xmath70 cross .    by the geometric interpretation ,",
    "if @xmath69 and @xmath70 cross then the only vertices of @xmath67 are @xmath71 and @xmath72 , and thus , it is degenerate .",
    "if @xmath69 and @xmath70 do not cross , then @xmath73 is a _ simple _ connected graph on @xmath80 vertices with @xmath80 edges .",
    "( note that @xmath73 is simple since as @xmath64 are ssts , the only edges in @xmath73 that may cross each other are @xmath74 . )",
    "thus , @xmath73 has a cycle of order at least 3 .",
    "removal of any edge from this cycle gives rise to a vertex in @xmath67 .",
    "therefore , in this case @xmath67 is non - degenerate .    [",
    "prop : deg - i - clique ] let @xmath0 be a finite set of points in the plane , no three on a line , @xmath81 .",
    "let @xmath64 be ssts of @xmath1 such that @xmath78 and @xmath79 .",
    "the i - clique @xmath75 is degenerate only in the following case :    the convex polygon @xmath82 has three consecutive vertices @xmath83 ( i.e. , @xmath84 $ ] and @xmath85 $ ] are edges of @xmath82 ) , such that :    1 .",
    "the triangle @xmath86 contains no other points of @xmath0 .",
    "2 .   @xmath87 $ ] and @xmath88 $ ] .",
    "@xmath89 \\in t_1",
    "\\cap t_2 $ ] .    assume that  ( 1)(3 ) hold , and let @xmath90 .",
    "@xmath91 is connected , and thus , has an edge @xmath92 that emanates from @xmath93 .",
    "note that as @xmath83 are consecutive vertices of @xmath82 and the triangle @xmath86 contains no other points of @xmath0 , any edge of @xmath1 that emanates from @xmath93 ( other than @xmath69 and @xmath70 ) must cross @xmath89 $ ] .",
    "thus , either @xmath94 , @xmath95 , or @xmath92 crosses @xmath89 $ ] .",
    "the latter is impossible , since @xmath89 \\in t_1",
    "\\cap t_2 $ ] , and as shown above , @xmath96 is included in any element of @xmath75 . if @xmath94 , then @xmath97 , which implies @xmath98 ( as both have the same number of edges ) .",
    "similarly , if @xmath95 then @xmath99",
    ". therefore , the only elements of @xmath75 are @xmath71 and @xmath72 , i.e. , @xmath75 is degenerate .    in the other direction ,",
    "assume that @xmath75 is degenerate .",
    "as mentioned above , the graph @xmath100 is a simple forest with two connected components .",
    "color the vertices of one component white and the vertices of the other component black , and call an edge _ colorful _ if its endpoints are of different colors .",
    "since @xmath77 is planar , it can be extended to a triangulation @xmath101 of @xmath82 with vertex set @xmath0 . as @xmath101 is connected , it contains a colorful edge @xmath92 .",
    "a triangle in @xmath101 to which @xmath92 belongs clearly contains another colorful edge @xmath102 .",
    "addition of either @xmath92 or @xmath102 to @xmath77 results in a simple tree , and thus , gives rise to a vertex of @xmath75 .",
    "( note that @xmath92 and @xmath102 can not cross edges of @xmath77 since they belong to a triangulation that extends @xmath77 . )",
    "since @xmath75 is degenerate , this implies that all other edges of @xmath101 are not colorful .",
    "we claim that this can happen only in the case described in the statement of the proposition .",
    "consider the edges @xmath103 .",
    "if @xmath92 is not a boundary edge of @xmath82 then it belongs to another triangle in @xmath101 .",
    "the other triangle must contain an additional colorful edge , contradicting the assumption that only @xmath92 and @xmath102 are colorful .",
    "the same holds for @xmath102 , and thus , both @xmath92 and @xmath102 are boundary edges of @xmath82 .",
    "denote their common vertex by @xmath93 and their other endpoints by @xmath16 , respectively .",
    "it is clear that condition  ( 1 ) above holds for @xmath83 , since @xmath101 is a triangulation of @xmath0 and @xmath104 is one of its triangles . to see that condition  ( 2 ) holds , note that @xmath105 and @xmath106 are the only vertices of @xmath75 , and thus , are equal to @xmath71 and @xmath72 .",
    "as @xmath107 for @xmath108 , the edges @xmath103 must coincide with @xmath69 and @xmath70 .",
    "finally , since @xmath81 , @xmath89 $ ] is a diagonal of @xmath82 , and thus , in the triangulation @xmath101 it belongs to another triangle @xmath109 ( see figure  [ fig8 ] ) .",
    "this triangle is monochromatic ( as otherwise , there are at least four colorful edges in @xmath101 ) , hence @xmath110 are of different colors .",
    "we apply a flip to the triangulation @xmath101 , replacing the triangles @xmath111 by @xmath112 .",
    "the resulting triangulation includes an additional colorful edge @xmath113 $ ] that does not cross any edge of @xmath77 , except possibly for @xmath89 $ ] .",
    "since by assumption , there are only two colorful edges that do not cross edges of @xmath77 , we must have @xmath89 \\in \\tilde{t}$ ] , which means that condition  ( 3 ) holds .",
    "[ cor : at - least - one - non - degenerate ] each edge of @xmath3 is contained in at least one non - degenerate max - clique .",
    "let @xmath114 \\in g(p)$]$ ] for edges of @xmath3 , like is commonly used for geometric graphs , although @xmath3 is treated as an abstract graph . ] and denote @xmath78 and @xmath79 .",
    "if @xmath74 do not cross then @xmath67 is non - degenerate by claim  [ claim : deg - u - clique ] .",
    "if @xmath74 cross then @xmath75 is non - degenerate , since by the proof of proposition  [ prop : deg - i - clique ] , if @xmath75 is degenerate , then the only edges that can be added to @xmath96 to form a simple tree share a vertex , which is not the case for @xmath74 that cross in an interior point .",
    "[ lemma : i - clique - not - leaf ] let @xmath115 be a sst of @xmath3 , and let @xmath116 be an i - clique that contains @xmath115 .",
    "denote the common intersection of pairs of elements of @xmath116 by @xmath77 , and let @xmath117 . if @xmath92 is not a leaf edge of @xmath115 , then @xmath118 .",
    "we begin the proof with the argument used in the proof of proposition  [ prop : deg - i - clique ] .",
    "namely , we consider the graph @xmath77 , which is a simple forest with two components .",
    "we color its components black and white , and extend it to a triangulation @xmath101 of @xmath0 .",
    "the triangulation contains a colorful edge @xmath2 $ ] , and consequently , another colorful edge @xmath119 $ ] in the same triangle .",
    "assume w.l.o.g . that @xmath120 is black , @xmath121 and @xmath122 are white",
    "now we would like to use the assumption that @xmath92 is not a leaf edge of @xmath115 .",
    "this assumption implies that each connected component of @xmath77 has at least two vertices .",
    "consequently , any vertex @xmath123 is an endpoint of at least one monochromatic edge of @xmath101 ( as otherwise , @xmath93 would be isolated in @xmath77 ) .    if both @xmath2 $ ] and @xmath119 $ ] are boundary edges of @xmath82 , then ( since @xmath124 is a triangle in @xmath101 ) these are the only edges of @xmath101 that emanate from @xmath120 .",
    "this is impossible , as they are both colorful .",
    "hence , we can assume w.l.o.g .",
    "that @xmath2 $ ] is a diagonal of @xmath82 , and thus , belongs to two triangles , @xmath125 and @xmath126 .",
    "( note that either @xmath127 or @xmath128 is equal to the vertex @xmath122 mentioned above . )",
    "we consider several cases , according to the colors of @xmath127 and @xmath128 :    1 .   * case 1 : @xmath127 and @xmath128 are white . * ( this case is illustrated in figure  [ fig2p2 ] . )",
    "consider the neighbors of @xmath120 in @xmath101 . since @xmath101 is a triangulation",
    ", all these vertices lie on a path in @xmath101 . as stated before",
    ", since @xmath120 is black , at least one of its neighbors must be black .",
    "on the other hand , some of its neighbors ( including @xmath129 ) are white .",
    "hence , at least one of the edges in the path connecting the neighbors of @xmath120 is colorful ( see figure  [ fig2p2 ] ) .",
    "in addition , the edges @xmath2,[a , c],[a , d]$ ] are colorful .",
    "thus , @xmath101 contains at least four colorful edges , and each of them gives rise to a vertex of @xmath116 . therefore ,",
    "* case 2 : @xmath127 and @xmath128 are black .",
    "* since the black vertices @xmath130 are all neighbors of the white vertex @xmath121 , the argument of case 1 applies , with the roles of @xmath120 with @xmath121 , black and white , interchanged .",
    "* case 3 : @xmath127 and @xmath128 have different colors .",
    "* assume w.l.o.g .",
    "that @xmath127 is white and @xmath128 is black . in this case , the edges @xmath2,[a , c],$ ] and @xmath131 $ ] are colorful .",
    "we further divide this case into three subcases , according to whether @xmath132 $ ] and @xmath131 $ ] are diagonals of @xmath82 or not , and show that in each case , @xmath101 contains at least one additional colorful edge . 1 .",
    "* case 3a : @xmath131 $ ] is a diagonal of @xmath82 . * in this case , @xmath131 $ ] belongs to an additional triangle of @xmath101 ( i.e. , other than @xmath126 ) .",
    "if this triangle is @xmath133 , then the edge @xmath134 $ ] is colorful , implying @xmath118 ( see left part of figure  [ fig3p2 ] ) .",
    "if this triangle is @xmath135 for some @xmath136 , then , as @xmath121 and @xmath128 have different colors , one of the edges @xmath137 $ ] and @xmath138 $ ] is colorful , again implying @xmath118 ( see right part of figure  [ fig3p2 ] ) .",
    "* case 3b : @xmath132 $ ] is a diagonal of @xmath82 . *",
    "the argument of case 3a applies , with the roles of @xmath120 and @xmath121 , @xmath127 and @xmath128 , black and white , interchanged .",
    "* case 3c : both @xmath132 $ ] and @xmath131 $ ] are boundary edges of @xmath82 . * in this case , @xmath139 is a convex quadrilateral , and thus , its diagonal @xmath134 $ ] lies inside it ( see figure  [ fig5p2 ] ) . as both @xmath125 and @xmath126 are triangles in @xmath101 , they do not contain points of @xmath0 , hence @xmath134 $ ] does not cross any edge of @xmath77 .",
    "( note that @xmath2 $ ] is not an edge of @xmath77 , since it is colorful . ) since @xmath134 $ ] is colorful , the graph @xmath140\\}$ ] is an sst , hence belongs to @xmath116 .",
    "therefore , @xmath118 , which completes the proof of the lemma .    using the lemma , we can identify whether a given degenerate clique is a u - clique or an i - clique .",
    "[ prop : identify - degenerate ] let @xmath141 $ ] be an edge in @xmath3 that constitutes a degenerate clique .",
    "( this actually means that there is only one max - clique that includes @xmath142 . )",
    "if @xmath141 $ ] is included in a max - clique of 3 vertices , then the degenerate clique @xmath141 $ ] is an i - clique .",
    "if @xmath141 $ ] is included in a max - clique of at least 4 vertices , then the degenerate clique @xmath141 $ ] is a u - clique .    by corollary  [ cor : at - least - one - non - degenerate",
    "] , each edge is included in at least one non - degenerate max - clique .",
    "hence , @xmath141 $ ] is included in a max - clique of size at least 3 .",
    "if the degenerate clique @xmath141 $ ] is an i - clique , then , by proposition  [ prop : deg - i - clique ] , @xmath143 is a forest with two connected components .",
    "one of them is an isolated vertex @xmath93 that lies on the boundary of @xmath82 , and the two neighbors of @xmath93 on the boundary of @xmath82 , @xmath16 , are adjacent in @xmath143 . in such a case ,",
    "the unique cycle in the graph @xmath144 is the triangle @xmath145 . by the geometric characterization of section  [ sec : sub : geom - meaning ]",
    ", this implies that the size of the u - clique that includes @xmath141 $ ] is 3 .",
    "if the degenerate clique @xmath141 $ ] is a u - clique , then , by claim  [ claim : deg - u - clique ] , the unique cycle of @xmath144 includes the edges @xmath146 and @xmath147 , and these edges cross .",
    "this implies that @xmath148 is not a leaf edge of @xmath149 , and thus , by lemma  [ lemma : i - clique - not - leaf ] , the size of the i - clique that includes @xmath141 $ ] is at least 4 .",
    "our next goal is to identify whether a given non - degenerate max - clique is a u - clique or an i - clique .",
    "this identification is somewhat more complex , and requires some preparations .    for any sst @xmath150 ,",
    "define a graph @xmath151 as follows : @xmath152 is the set of max - cliques that contain @xmath115 ( including degenerate cliques ) .",
    "two max - cliques are adjacent in @xmath151 if and only if their intersection is a single edge ( that obviously has @xmath115 as one of its endpoints ) .",
    "note that by remark  [ remark : three - determine ] , two non - identical max - cliques may intersect in at most two vertices ( since three mutually adjacent vertices determine a max - clique uniquely ) . as all vertices of @xmath151 include @xmath115 , it follows that any two non - adjacent vertices of @xmath151 intersect in @xmath115 only .",
    "[ thm : d_t ] assume that @xmath153 .",
    "for any @xmath150 , the graph @xmath151 is connected .    before we present the proof of the theorem",
    ", we show how it can be used ( along with several of the previous lemmas ) to identify the types of max - cliques in @xmath3 .    by the discussion in section  [ sec : sub : max - cliques - basics ] , each edge of @xmath3 belongs to exactly one u - clique and exactly one i - clique ( one of them possibly degenerate ) .",
    "this implies that @xmath151 is 2-colorable .",
    "indeed , we can color all its vertices that are u - cliques white and all its vertices that are i - cliques black .",
    "if two vertices are adjacent , both include the same edge @xmath141 \\in g(p)$ ] , and thus , one is a u - clique and the other is an i - clique , so they have different colors . using theorem  [ thm : d_t ]",
    ", we can conclude that @xmath151 is connected and 2-colorable , which implies that the 2-coloring is unique , in the sense that fixing the color of any vertex determines the colors of all other vertices .",
    "this will allow us to determine the types of all max - cliques , by the following four - step process :    1 .",
    "pick an sst @xmath115 that belongs to a degenerate clique @xmath142 .",
    "( it is easy to show that such a @xmath115 always exists .",
    "we show this in lemma  [ lemma : exist - degenerate ] below . ) using proposition  [ prop : identify - degenerate ] , identify whether @xmath142 is a u - clique or an i - clique .",
    "2 .   consider the vertices of @xmath151 and determine for each of them whether it is a u - clique or an i - clique .",
    "( this is possible by the explanation above . since we know the `` color '' of the vertex @xmath142 of @xmath151 , we can determine the colors of all other vertices . )",
    "3 .   consider a neighbor @xmath154 of @xmath115 .",
    "note that the edge @xmath155 \\in g(p)$ ] belongs to a max - clique @xmath34 that is a vertex of both @xmath151 and @xmath156 .",
    "determine whether @xmath34 is a u - clique or an i - clique .",
    "( this is possible , as by the previous step we can determine the type for all max - cliques that are vertices of @xmath151 . ) using this information about @xmath157 , determine for each vertex of @xmath156 whether it is a u - clique or an i - clique .",
    "4 .   repeat step  3 with a `` new '' vertex of @xmath3 every time until the types of all max - cliques are determined .",
    "( since @xmath3 is connected by claim  [ claim : g(p)-connected ] , we indeed reach all vertices of @xmath3 in this way . )    therefore , in order to determine the types of all max - cliques we have to prove a simple lemma on the existence of degenerate max - cliques , and to prove theorem  [ thm : d_t ] .",
    "we provide these two items now .",
    "[ lemma : exist - degenerate ] for any set @xmath0 , @xmath153 , of points in general position in the plane , there exists an sst that belongs to a degenerate u - clique in @xmath3 .    by the erds - szekeres theorem",
    "@xcite , there exist four points in @xmath0 in convex position .",
    "denote these points @xmath158 , such that @xmath159 $ ] is a convex quadrilateral ( in this order ) .",
    "consider the tree @xmath115 that includes the edges @xmath2,[b , d],[d , c]$ ] , all edges that connect @xmath120 to each @xmath160 that lies above the straight line @xmath161 and all edges that connect @xmath127 to each @xmath160 that lies below @xmath161 , as shown in figure  [ fig6p4 ] .",
    "clearly , @xmath115 is an sst of @xmath1 .",
    "addition of the edge @xmath132 $ ] to @xmath115 creates a self - crossing cycle , and thus , by the discussion in section  [ sec : sub : geom - meaning ] , @xmath162 belongs to a degenerate u - clique .",
    "suppose @xmath163 .",
    "choose edges @xmath164 \\in c$ ] , @xmath165 \\in c'$ ] . in order to prove that @xmath34 is connected to @xmath42 by a path in @xmath151",
    ", it suffices to find a sequence @xmath166 of sst s , such that @xmath167 , @xmath168 , and for each @xmath169 , there is a max - clique @xmath170 of @xmath3 that includes both @xmath171 $ ] and @xmath172 $ ] .",
    "this will be done in four steps",
    ".    1 .   * step 1 .",
    "* extend the sst @xmath115 to a triangulation @xmath101 of @xmath82 . recall that @xmath101 is a 2-connected graph .",
    "* step 2 . *",
    "if @xmath173 , leave @xmath149 as it is . if not , @xmath101 contains the graph @xmath174 .",
    "since @xmath101 is 2-connected , there is another edge @xmath175 in @xmath101 that connects the two components of @xmath77 .",
    "define @xmath176 .",
    "@xmath177 is an sst of @xmath1 .",
    "note that @xmath177 is included in the i - clique @xmath178 ( since @xmath179 ) .",
    "+ do the same for @xmath180 : leave it , if @xmath181 , or replace it by some @xmath182 , such that @xmath183 .",
    "+ step  2 allows us to restrict our attention to the case where both @xmath149 and @xmath180 are included in @xmath101 ( and all intermediate sst s will be included in @xmath101 , as well ) .",
    "* step 3 . *",
    "assume @xmath184 , @xmath185 .",
    "if @xmath186 , then @xmath164 $ ] and @xmath165 $ ] belong to the same i - clique .",
    "suppose @xmath187 . since @xmath115 is a simple tree , there is a unique simple path in @xmath115 whose edges are ( in this order ) @xmath188 , with @xmath189 and @xmath190 . for @xmath191",
    ", choose an edge @xmath192 of @xmath101 other than @xmath193 that connects the two components of @xmath194 , and define @xmath195 .",
    "in addition , let @xmath196 and @xmath197 .",
    "now we only have to connect @xmath198 with @xmath199 for @xmath200 .",
    "( note that the desired sequence @xmath166 will be the concatenation of the sequences connecting @xmath201 to @xmath202 , @xmath202 to @xmath203 etc .",
    ", and @xmath204 will be the sum of their lengths . )",
    "* step 4 . *",
    "suppose @xmath101 is a triangulation of @xmath82 with vertex set @xmath0 .",
    "let @xmath205 be sst s of @xmath1 that are included in @xmath101 .",
    "assume that both @xmath149 and @xmath180 are adjacent to @xmath115 in @xmath3 , @xmath206 , @xmath207 , @xmath187 , and @xmath103 share a vertex .",
    "suppose @xmath208 , e'=[x',y]$ ] , and let @xmath209 .",
    "denote the edges of @xmath115 that emanate from @xmath210 by @xmath211 .",
    "removal of all edges that emanate from @xmath210 divides @xmath115 into @xmath212 connected components : @xmath116 that includes @xmath213 , @xmath214 that includes @xmath215 , @xmath216 ( @xmath217 ) that includes the second endpoint of @xmath218 , and @xmath219 that consists of the isolated vertex @xmath210 .",
    "since @xmath101 is 2-connected , we can extend the forest @xmath220 into an sst of @xmath221 by adding @xmath222 edges of @xmath101 .",
    "+ let @xmath223 be such an extension .",
    "@xmath223 includes a unique simple path @xmath224 from @xmath213 to @xmath215 .",
    "this path starts in the component @xmath116 of @xmath31 , and ends in @xmath214 .",
    "it visits some of the intermediate components @xmath225 in a particular order ( see figure  [ fig8p6 ] ) . by appropriately labelling these components",
    ", we may assume that @xmath224 visits @xmath226 in this order ( @xmath227 ) .",
    "let @xmath228 be the edge of @xmath224 that passes from @xmath116 to @xmath229 , @xmath230 ( @xmath231 ) the edge that passes from @xmath225 to @xmath232 , and @xmath233 be the edge that passes from @xmath234 to @xmath214 .",
    "( if @xmath235 , then there is only one edge @xmath236 that passes directly from @xmath116 to @xmath214 . )",
    "+ now we can describe the passage from @xmath164 $ ] to @xmath165 $ ] .",
    "let us start with the simple case @xmath235 .",
    "put @xmath237 , @xmath238 . then @xmath239 , @xmath240 , and @xmath241 .",
    "thus , @xmath242 and @xmath243 are included in i - cliques , while @xmath244 is included in a u - clique .",
    "hence , @xmath245 is the required sequence .",
    "+ when @xmath246 , define @xmath247 then each of the triples @xmath248 ( for @xmath249 ) , and @xmath250 is included in an i - clique , and each of the triples @xmath251 ( for @xmath252 ) is included in a u - clique .",
    "therefore , @xmath253 is the required sequence .",
    "this completes the proof of the theorem .    as explained after the statement of theorem  [ thm : d_t ]",
    ", the theorem and lemma  [ lemma : exist - degenerate ] imply the following corollary .",
    "assume @xmath153 . given @xmath3",
    ", we can determine for each max - clique in it whether it is a u - clique or an i - clique .",
    "in this section we use the results of section  [ sec : max - cliques ] to identify the vertices of @xmath3 that represent stars ( i.e. , ssts of diameter 2 ) and brushes ( i.e. , ssts of diameter 3 ) .",
    "the stars , considered in section  [ sec : sub : stars ] , are determined only up to an automorphism of @xmath1 as a geometric graph .",
    "the brushes , considered in section  [ sec : sub : brushes ] , are determined uniquely given a determination of the stars .",
    "a _ star _ is a tree of diameter 2 .    for @xmath254 , we call the spanning star whose center is @xmath213 an _ @xmath213-star _ , and denote it by @xmath255 .",
    "[ thm : stars ] a vertex @xmath150 is a star if and only if all u - cliques that include @xmath115 are of size 3",
    ".    recall that by the geometric interpretation of max - cliques presented in section  [ sec : sub : geom - meaning ] , if @xmath256 is a non - degenerate u - clique then all its elements are obtained from the graph @xmath144 by removing an edge from its unique cycle . in particular , @xmath257 is the length of the unique cycle of @xmath144 .",
    "if the unique cycle of @xmath144 is self - crossing ( which can occur only if its length is @xmath258 ) then @xmath256 is degenerate .",
    "assume that @xmath150 is an @xmath213-star , and let @xmath256 be a u - clique that includes @xmath115 . since @xmath115 is a star , @xmath144 is obtained from @xmath115 by adding an edge that connects two leaves @xmath259 of @xmath115 .",
    "hence , the unique cycle of @xmath144 , @xmath260,[v , w],[w , x])$ ] , is of length 3 .",
    "thus , @xmath261 , as asserted .",
    "on the other hand , we show that if @xmath150 is an sst of diameter @xmath262 , then @xmath115 belongs to a u - clique of size @xmath263 .",
    "since @xmath264 , @xmath115 contains an internal edge @xmath2 $ ] ( i.e. , both @xmath120 and @xmath121 are not leaves of @xmath115 ) . consider the graph @xmath265\\}$ ] , that is obviously a forest with two connected components .",
    "color the vertices of the connected component that includes @xmath120 black and the vertices of the component that includes @xmath121 white .",
    "we would like to show that there exists a colorful edge @xmath92 that uses neither @xmath120 nor @xmath121 and does not cross any edge of @xmath265\\}$ ] ( see figure  [ fig9p7 ] ) .",
    "this will conclude the proof , since in such a case , denoting @xmath266\\}$ ] , we find that @xmath149 is an sst , @xmath141 \\in g(p)$ ] , and the unique cycle of the graph @xmath267 is of length @xmath258 .",
    "then , by the geometric interpretation above , if @xmath92 crosses @xmath2 $ ] then @xmath256 is a degenerate u - clique , and otherwise , @xmath257 is equal to the length of the unique cycle of @xmath144 , that is @xmath258 .",
    "hence , in any case , @xmath115 lies in a u - clique of size @xmath263 .",
    "we extend @xmath115 to a triangulation @xmath101 of @xmath82 , and consider three cases :    1 .",
    "* case 1 : @xmath2 $ ] is a boundary edge of @xmath82 .",
    "* the edge @xmath2 $ ] , being colorful , is contained in a colorful triangle @xmath268 .",
    "the other colorful edge of @xmath125 is not a boundary edge of @xmath82 , as otherwise , one of the two connected components of @xmath265\\}$ ] consists of a single vertex , which contradicts the assumption that @xmath2 $ ] is an internal edge of @xmath115 . denote that colorful edge @xmath132 $ ] .",
    "the neighbors of @xmath120 in @xmath101 constitute a path @xmath269 $ ] .",
    "since the connected component of @xmath120 in the graph @xmath265\\}$ ] ( i.e. , the `` black '' component ) includes more than one vertex , at least one of the @xmath270 s is black .",
    "thus , the path contains a colorful edge @xmath92 that uses neither @xmath120 nor @xmath121 ( see figure  [ fig10p8 ] ) .",
    "furthermore , as @xmath92 belongs to @xmath101 , it does not cross any edge of @xmath115 .",
    "hence , @xmath92 is the edge whose existence was claimed .",
    "* case 2 : @xmath121 is an internal vertex of @xmath82 . * in this case , @xmath2 $ ] is an internal edge of @xmath101 , and thus , it is contained in two triangles @xmath271 .",
    "we further divide this case into two sub - cases : 1 .",
    "* case 2a : either @xmath127 or @xmath128 ( or both ) are black . *",
    "assume w.l.o.g .",
    "that @xmath127 is black .",
    "since @xmath121 is an internal vertex of @xmath82 , the neighbors of @xmath121 in @xmath101 constitute a cycle @xmath272 $ ] .",
    "since the connected component of @xmath121 in the graph @xmath265\\}$ ] contains more than one vertex , at least one of the @xmath270 s or @xmath128 is white . since @xmath273 are black , this implies that the cycle includes at least two colorful edges , and at least one of them uses neither @xmath120 nor @xmath121 ( see left part of figure  [ fig11p8 ] ) .",
    "as in case 1 , this is the desired edge @xmath92 .",
    "* case 2b : both @xmath127 and @xmath128 are white .",
    "* by the same argument as above , @xmath120 has a black neighbor in @xmath101 .",
    "as the neighbors of @xmath120 in @xmath101 form a ( possibly closed ) path , at least one edge of this path is colorful ( see right part of figure  [ fig11p8 ] ) .",
    "this edge uses neither @xmath120 nor @xmath121 ( as both edges that use @xmath121 in this path , @xmath274 $ ] and @xmath131 $ ] , are not colorful ) . as in the previous cases ,",
    "this is the desired edge @xmath92 .",
    "* case 3 : both @xmath120 and @xmath121 are boundary vertices of @xmath82 , and @xmath2 $ ] is a diagonal of @xmath82 . * as in case 2 , @xmath2 $ ] lies in two triangles @xmath271 .",
    "we further divide this case to two sub - cases : 1 .",
    "* case 3a : @xmath127 and @xmath128 are of the same color .",
    "* w.l.o.g .",
    ", @xmath127 and @xmath128 are white . by the same arguments as above",
    ", @xmath120 has a black neighbor , and thus , the path of @xmath120 s neighbors includes a colorful edge ( see left part of figure  [ fig13p9 ] ) .",
    "this edge does not use @xmath121 , as both edges that use @xmath121 ( that are @xmath274,[b , d]$ ] ) are not colorful , and it clearly does not use @xmath120 .",
    "* case 3b : @xmath127 and @xmath128 are of different colors .",
    "* in this case , the edge @xmath134 $ ] is as desired , since it is colorful , does not use @xmath275 , and does not cross edges of @xmath265\\}$ ] ( see right part of figure  [ fig13p9 ] ) .",
    "note that since @xmath134 $ ] crosses @xmath2 $ ] , the u - clique that includes @xmath115 in this case is degenerate .",
    "this completes the proof of the theorem .",
    "it may happen that @xmath150 is not a star , but all u - cliques that contain @xmath115 are either degenerate or of size 3 .",
    "let @xmath0 be a set of points in general position in the plane , and let @xmath276 .",
    "@xmath277-brush _ is an sst of diameter 3 whose only internal edge is @xmath278 $ ] .",
    "figure  [ fig15p9 ] shows an example of a @xmath277-brush .",
    "in this subsection we aim at identifying the vertices of @xmath3 that represent brushes .",
    "the identification uses distances in the graph @xmath3 , defined ( as usual ) as the length of the shortest path between two vertices , and denoted by @xmath279 .",
    "note that by the structure of @xmath3 , it is clear that for any pair of vertices @xmath280 , we have @xmath281 where @xmath282 is the symmetric difference between the edge sets of the graphs @xmath149 and @xmath115 .",
    "[ thm : brush ] an sst @xmath150 is a @xmath277-brush if and only if it is not a star and @xmath283    for sake of convenience , we divide the theorem into two propositions .",
    "[ prop : brush1 ] assume that @xmath150 satisfies @xmath284 then @xmath115 is a @xmath277-brush , or @xmath285 , or @xmath286 .",
    "first , we note that @xmath287 and thus , by the triangle inequality , @xmath288 for any @xmath150 .",
    "assume that @xmath115 satisfies  ( [ eq : brush1 ] ) .",
    "let @xmath289 be the numbers of edges of @xmath115 that emanate from @xmath290 ( respectively ) , and let @xmath291 be the number of edges of @xmath115 that use neither @xmath292 nor @xmath22 .",
    "we consider two cases :    1 .   * @xmath278 \\not \\in t$ ] . * in this case , we have @xmath293 hence , @xmath294 2 .",
    "* @xmath278 \\in t$ ] .",
    "* in this case , @xmath295 hence , @xmath296 and equality can hold only if @xmath297 , which means that all edges of @xmath115 emanate either from @xmath292 or from @xmath22 and @xmath278 \\in t$ ] , i.e. , @xmath115 is a @xmath277-brush , or @xmath285 or @xmath286 .    [",
    "prop : brush2 ] let @xmath150 be a @xmath277-brush . then @xmath284    in order to prove proposition  [ prop : brush2 ] , we need a lemma .",
    "let @xmath115 be a @xmath277-brush ( or @xmath285 or @xmath286 ) .",
    "we say that @xmath115 is _ of type @xmath298 _ if @xmath299 and @xmath300 ( i.e. , the numbers of edges of @xmath115 that emanate from @xmath301 are @xmath302 , respectively ) .    [ lemma : brush1 ] if @xmath115 is a @xmath277-brush ( or a star ) of type @xmath298 , @xmath303 , then it is adjacent in @xmath3 to some @xmath277-brush ( or star ) @xmath154 of type @xmath304 .",
    "( by symmetry , if @xmath305 then @xmath115 is adjacent in @xmath3 to some @xmath277-brush ( or star ) @xmath306 of type @xmath307 . )",
    "assume w.l.o.g .",
    "that @xmath278 $ ] is placed horizontally , and consider the half - plane above it .",
    "let @xmath308 $ ] be an edge such that the angle @xmath309 between @xmath278 $ ] and @xmath308 $ ] is minimal amongst all edges of @xmath115 that emanate from @xmath292 ( see figure  [ fig16p10 ] ) .",
    "let @xmath310\\ } ) \\cup \\{[q , x]\\}$ ] .",
    "due to the minimality of the angle @xmath309 , @xmath311 $ ] does not cross any of the edges of @xmath115 that emanate from @xmath292 .",
    "thus , @xmath154 is a @xmath277-brush of type @xmath304 ( or @xmath312 , if @xmath313 ) , and @xmath155 \\in g(p)$ ] since @xmath314 .",
    "let @xmath150 be a @xmath277-brush .",
    "assume w.l.o.g .",
    "that @xmath115 is of type @xmath298 . repeated use of lemma  [ lemma : brush1 ] enables us to construct a path @xmath315 in @xmath3 such that @xmath316 , @xmath317 , and @xmath318",
    "this implies @xmath319 and @xmath320 , hence , @xmath321 .",
    "since we have shown above that @xmath322 for any @xmath115 , this completes the proof .",
    "in this section we achieve a complete reconstruction of the geometric structure of @xmath1 , based on the identification of stars and brushes presented in section  [ sec : stars - and - brushes ] . most of the effort is devoted to obtaining a complete identification of the brushes , in the sense that given a @xmath277-brush @xmath115 and a vertex @xmath323 , we determine whether @xmath324 \\in t$ ] or @xmath325 \\in t$ ] .",
    "this step is presented in section  [ sec : sub : brushes - further ] .",
    "the finalization of the proof of theorem  [ thm : main ] , presented in section  [ sec : sub : completion ] , is easy .",
    "so far , we know which vertices of @xmath3 are brushes . furthermore ,",
    "if we identify the points of @xmath0 with the stars in @xmath3 ( an identification that is determined only up to an automorphism of @xmath1 ) , we can say for each brush @xmath115 , what are the vertices @xmath301 that are its `` centers '' , and how many edges of @xmath115 emanate from each of the central vertices @xmath301 .",
    "our goal now is to gain full information on the brushes .",
    "namely , for a @xmath277-brush @xmath115 and a vertex @xmath323 , we would like to determine whether @xmath308 \\in t$ ] or @xmath311 \\in t$ ] .    as an intermediate step",
    ", we would like to determine , for given @xmath326 , whether both @xmath213 and @xmath210 are connected in @xmath115 to the same vertex ( either @xmath292 or @xmath22 ) , or one of them is connected to @xmath292 and the other to @xmath22 .",
    "[ prop : brush3 ] let @xmath115 be a @xmath277-brush , and let @xmath327 be different from each other and from @xmath292 and @xmath22 .",
    "the leaf edges of @xmath115 whose endpoints are @xmath213 and @xmath210 emanate from the same internal vertex of @xmath115 if and only if for any @xmath328-brush @xmath149 , we have @xmath329 .    one direction of the proposition is immediate . if the leaf edges emanate from the same vertex , e.g. , @xmath308,[p , y]$ ] , then at most one ( and actually , exactly one ) of these edges can belong to an @xmath328-brush ( as @xmath330,[y , p],[p , x])$ ] form a cycle ) .",
    "since every edge of an @xmath328-brush @xmath149 emanates from either @xmath213 or @xmath210 , we have @xmath331 ( as these trees have exactly one edge in common ) .",
    "hence , @xmath332 for any @xmath328-brush @xmath149 .",
    "on the other hand , if the leaf edges emanate from different vertices , e.g. , @xmath308,[q , y]$ ] , it is possible that an @xmath328-brush @xmath149 include both these edges , and then @xmath333 .",
    "we will construct an @xmath328-brush that satisfies this condition , and furthermore , satisfies the stronger condition @xmath334 .",
    "before we show this construction , we need a few preparations .",
    "let @xmath10 be a geometric graph , and let @xmath335 be a point in the plane .",
    "we say that @xmath335 _ sees _ a point @xmath0 if the open segment @xmath336 does not meet any edge or vertex of @xmath10 .",
    "we say that @xmath335 sees an edge @xmath337 if it sees every point @xmath338 , including the endpoints .",
    "[ lemma : sees ] let @xmath339 be a crossing - free geometric graph , with no isolated vertices .",
    "suppose @xmath340 is a disjoint union @xmath341 , where @xmath342 ( say , @xmath343 ) , and each edge of @xmath10 connects a vertex of @xmath344 with a vertex of @xmath345 .",
    "suppose @xmath346 .",
    "then @xmath335 sees some vertex @xmath347 .",
    "we note that a similar lemma was proved in  @xcite .",
    "the assumption on @xmath335 in  @xcite is @xmath348 , and the assertion is the same as in our lemma .",
    "draw a ray @xmath349 that emanates from @xmath335 , crosses some edge of @xmath10 , and does not meet any vertex of @xmath10 .",
    "( it is clear that such rays exist . )",
    "denote by @xmath34 the first crossing point of @xmath349 with an edge of @xmath10 .",
    "then @xmath34 is an interior point of an edge , say @xmath350 $ ] , of @xmath10 , and @xmath335 sees @xmath34 .",
    "now rotate @xmath349 around @xmath335 towards @xmath351 , until it hits @xmath351 .",
    "if the triangle @xmath352 does not contain any vertex of @xmath10 , except @xmath351 , then @xmath335 sees @xmath351 .",
    "otherwise , there is a first position @xmath353 of the rotated ray that meets @xmath340 .",
    "let @xmath93 be the point of @xmath354 closest to @xmath335 .",
    "then @xmath335 sees @xmath93 . if @xmath355 , we are done .",
    "assume , therefore , that @xmath356 .",
    "clearly , @xmath357 since @xmath358 . hence , @xmath359 .    among the edges that emanate from @xmath22 ,",
    "let @xmath360 $ ] be the edge such that @xmath361 is minimal .",
    "as before , rotate @xmath353 around @xmath335 towards @xmath362 , until it hits @xmath362 .",
    "if the triangle @xmath363 does not contain any vertex of @xmath10 , except @xmath22 and @xmath362 , then @xmath335 sees @xmath362 .",
    "otherwise , there is a first position @xmath364 of the rotated ray that meets @xmath340 .",
    "let @xmath365 be the point of @xmath366 closest to @xmath335 .",
    "then @xmath335 sees @xmath365 .",
    "now , we observe that @xmath367 .",
    "indeed , @xmath368 since @xmath369 , and @xmath370 since @xmath371 .",
    "therefore , @xmath372 , which completes the proof .",
    "now we are ready to prove proposition  [ prop : brush3 ] .",
    "we already proved above that if the two leaf edges of @xmath115 whose endpoints are @xmath16 emanate from the same vertex , then for any @xmath328-brush @xmath149 , @xmath329 .",
    "assume now that these leaf edges emanate from different vertices .",
    ", these edges are @xmath308,[q , y]$ ] .",
    "we consider two cases , according to the placement of @xmath373 in the plane . in each case , we show that we can pass from @xmath115 to a suitable @xmath328-brush @xmath149 in @xmath374 steps , where in each step we remove one edge and add another edge , while maintaining the simplicity .",
    "this will show that @xmath375 , and thus complete the proof of the proposition .",
    "note that in all the steps of the path connecting @xmath115 to @xmath149 , the edges @xmath308,[q , y]$ ] remain untouched .",
    "* case 1 : @xmath16 are on the same side of @xmath376 .",
    "*    in this case , at least one of the edges @xmath308,[q , y]$ ] is included in a line that supports the set @xmath377 ( which means that all points in the set are on the same side of the line ) .",
    "we assume w.l.o.g .",
    "that @xmath308 $ ] has this property .",
    "the passage from @xmath115 to an appropriate @xmath149 is performed by a 4-phase procedure , illustrated in figure  [ fig18p12new ] . in each phase",
    "( except for phase  3 that will be described below ) , we consider one of the regions of the plane denoted in the figure : @xmath378 , and deal with all points of @xmath0 that belong to that region .    1",
    ".   * region 1 ( reg1 ) .",
    "* this region is the open half - plane to the left of the line @xmath379 .",
    "assume that @xmath380 .",
    "we are going to perform @xmath381 steps : in each step , we take one of these points , remove the edge that connects it to either @xmath292 or @xmath22 , and add an edge that connects it to @xmath213 .",
    "of course , we must maintain the simplicity during all steps , and this is achieved using lemma  [ lemma : sees ] .",
    "+ let @xmath382 be the geometric graph whose edges are all edges of @xmath115 of the form @xmath350 $ ] or @xmath383 $ ] , where @xmath351 lies in @xmath384 .",
    "the graph @xmath382 and the point @xmath385 satisfy the assumptions of lemma  [ lemma : sees ] , and thus , by the lemma , @xmath213 sees one of its vertices @xmath386 , say @xmath387 .",
    "assume , for example , that @xmath388 \\in e(g_0)$ ] .",
    "define @xmath389\\ } \\cup \\{[x , w_1]\\}$ ] .",
    "since @xmath213 sees @xmath387 , the edge @xmath390 $ ] does not cross any other edge of @xmath115 .",
    "thus , @xmath71 is an sst and @xmath391 , which implies that @xmath392 \\in g(p)$ ] .",
    "+ now , we repeat the first step with the sst @xmath71 in place of @xmath115 .",
    "that is , we define @xmath393 whose edges are all edges of @xmath115 of the form @xmath350 $ ] or @xmath383 $ ] where @xmath351 lies in @xmath384 , except for @xmath388 $ ] . as before",
    ", we apply lemma  [ lemma : sees ] with @xmath393 and @xmath385 and obtain a vertex @xmath394 that is seen from @xmath213 .",
    "then , we define @xmath72 by removing from @xmath71 the edge that connects @xmath394 to either @xmath292 or @xmath22 and adding the edge @xmath395 $ ] .",
    "note that the edge @xmath390 $ ] that was not included in @xmath396 can not cross @xmath395 $ ] , as they both emanate from @xmath213 .",
    "+ by continuing in the same fashion , we obtain a sequence @xmath397 such that @xmath398 , @xmath399 \\in g(p)$ ] for all @xmath400 , and in @xmath401 , all points in @xmath402 are connected to @xmath213 .",
    "+ it should be noted that the parts of @xmath403 that are not included in the auxiliary graph @xmath404 , i.e. , the edge @xmath278 $ ] and the edges @xmath350,[q , w]$ ] , @xmath405 , are all disjoint from the convex set @xmath384 , and thus can not cross the new edge @xmath406 $ ] ( as @xmath407 ) .",
    "* region 2 ( reg2 ) .",
    "* this region contains all points that lie above @xmath376 and on the right side of @xmath379 .",
    "assume that @xmath408 .",
    "we start with @xmath401 and perform @xmath409 steps : in each step , we consider one of these points , remove the edge that connects it to either @xmath292 or @xmath22 , and add an edge that connects it to @xmath210 .",
    "as before , the simplicity is maintained during all steps , by using lemma  [ lemma : sees ] .",
    "+ let @xmath410 be the geometric graph whose edges are all edges of @xmath401 of the form @xmath350 $ ] or @xmath383 $ ] , where @xmath351 lies in @xmath411 .",
    "the graph @xmath410 and the point @xmath412 satisfy the assumptions of lemma  [ lemma : sees ] , and thus , by the lemma , @xmath210 sees one of the vertices @xmath413 , call it @xmath414 . without loss of generality , @xmath415 \\in g_{k_1}$ ] .",
    "define @xmath416\\ } \\cup \\{[y , w_{k_1 + 1}]\\}$ ] .",
    "since @xmath210 sees @xmath414 , the edge @xmath417 $ ] does not cross any other edge of @xmath401 .",
    "thus , @xmath418 \\in g(p)$ ] . + by continuing in the same fashion ,",
    "we obtain a sequence @xmath419 such that @xmath399 \\in g(p)$ ] for all @xmath400 , and in @xmath420 , all points in @xmath402 are connected to @xmath213 and all points in @xmath421 are connected to @xmath210 .",
    "* phase 3 . * in this phase , we add the edge @xmath89 $ ] and remove the edge @xmath278 $ ] ( that otherwise closes a cycle @xmath330,[y , q],[q , p],[p , x])$ ] ) . formally , we define @xmath422\\ } \\cup \\{[x , y]\\}$ ] .",
    "note that the edge @xmath89 $ ] does not cross any edge of @xmath420 , as in @xmath420 , all points of @xmath421 are connected to @xmath210 .",
    "* region 4 ( reg4 ) .",
    "* this region contains all points that lie below @xmath376 and on the right of @xmath379 .",
    "assume @xmath423 .",
    "as all points of @xmath0 except for @xmath373 belong to one of the regions : @xmath424 , we have @xmath425 .",
    "we construct a sequence of ssts @xmath426 such that in @xmath427 , all points in @xmath402 are connected to @xmath213 and all points in @xmath428 are connected to @xmath210 .",
    "hence , @xmath429 is an @xmath328-brush that satisfies @xmath430 , as desired .",
    "+ let @xmath431 be the geometric graph whose edges are all edges of @xmath432 of the form @xmath350 $ ] or @xmath383 $ ] , where @xmath351 lies in @xmath433 .",
    "the graph @xmath431 and the point @xmath412 satisfy the assumptions of lemma  [ lemma : sees ] , and thus , by the lemma , @xmath210 sees one of the vertices @xmath434 , say @xmath435 . without loss of generality ,",
    "@xmath436 \\in g_{k_1+k_2 + 1}$ ] .",
    "define @xmath437\\ } \\cup \\{[y , w_{k_1+k_2 + 1}]\\}$ ] .",
    "since @xmath210 sees @xmath435 , the edge @xmath438 $ ] does not cross any other edge of @xmath401 .",
    "( it should be noted that the fact that @xmath210 lies outside @xmath433 does not disturb us , as all points in region  2 ( that is the region @xmath210 sees @xmath433 through ) are already connected to @xmath210 , and @xmath0 is in general position . )",
    "thus , @xmath439 \\in g(p)$ ] . + by continuing in the same fashion",
    ", we obtain a sequence @xmath440 such that @xmath399 \\in g(p)$ ] and @xmath429 is the desired @xmath328-brush .",
    "* case 2 : @xmath16 are on different sides of @xmath376 . *",
    "this case is treated in a fashion similar to case  1 .",
    "we divide all points of @xmath441 into two regions , where region 1 ( reg1 ) consists of the points above @xmath376 and region 2 ( reg2 ) consists of the points below @xmath376 ( see figure  [ fig21p14new ] ) . in the first phase",
    ", we consider the points of @xmath384 ( excluding @xmath213 ) , disconnect them from @xmath292 or @xmath22 and connect them to @xmath213 instead .",
    "the procedure is identical to the procedure of the first phase of case  1 . in the second phase ,",
    "we consider the points of @xmath411 ( excluding @xmath210 ) , disconnect them from @xmath292 or @xmath22 and connect them to @xmath210 instead .",
    "the procedure is , again , similar .",
    "finally , in the third phase we remove the edge @xmath278 $ ] and insert the edge @xmath89 $ ] instead .",
    "( as at this stage , all points in @xmath442 are connected to either @xmath213 or @xmath210 , this step does not create crossings . ) as a result , we obtain a sequence @xmath443 , such that @xmath399 \\in g(p)$ ] for all @xmath400 and @xmath444 is an @xmath328-brush , as desired .    as cases",
    "1,2 include all possible placements of @xmath445 , the proof is complete .",
    "now we are ready to identify every brush completely .",
    "[ cor : brush ] let @xmath446 be a @xmath277-brush and let @xmath254 , @xmath323 .",
    "given @xmath3 , we can determine whether @xmath308 \\in t$ ] or @xmath311 \\in t$ ] .",
    "it follows from the proof of proposition  [ prop : brush2 ] that @xmath115 belongs to a path @xmath447 in @xmath3 such that in @xmath403 , @xmath448 and @xmath449 .",
    "consider @xmath71 . since it has only one vertex @xmath450 that is connected to @xmath22 , we can use proposition  [ prop : brush3 ] to determine it .",
    "( here we use the assumption that @xmath451 . )",
    "we can then move to @xmath72 and use proposition  [ prop : brush3 ] again to determine the additional vertex @xmath452 connected to @xmath22 in @xmath72 .",
    "( note that @xmath453 \\in e(t_2)$ ] , and thus , @xmath452 is identified as the unique vertex @xmath213 such that the leaf edge of @xmath72 that emanates from it has the same second endpoint as the leaf edge that emanates from @xmath454 . ) we can continue in the same fashion and get a complete identification of @xmath455 , including @xmath115 .",
    "our last step toward the identification of the geometric structure of @xmath1 is the following easy proposition .",
    "[ prop : brush4 ] let @xmath373 be four different points in @xmath0 . the segments @xmath308 $ ] and @xmath456 $ ] do not cross if and only if there exists a @xmath277-brush that includes the edges @xmath308 $ ] and @xmath456 $ ] .",
    "it is clear that if @xmath308 $ ] and @xmath456 $ ] cross then no @xmath277-brush can contain both edges @xmath308 $ ] and @xmath456 $ ] , as a brush is a _ simple _ tree . if @xmath308 $ ] and @xmath456 $ ] do not cross , then they are strictly separated by some line @xmath204 . in such a case , we can define a @xmath277-brush in which all vertices that lie on the same side of @xmath204 as @xmath292 are connected to @xmath292 , and all other vertices are connected to @xmath22 ( see figure  [ fig22p14 ] ) .",
    "this @xmath277-brush includes both @xmath308 $ ] and @xmath456 $ ] .",
    "now we are ready to prove our main theorem .",
    "consider the geometric tree graph @xmath3 .",
    "the vertices @xmath445 are identified with the stars @xmath457 . by theorem  [ thm :",
    "brush ] , we can identify all @xmath277-brushes in @xmath3 . by corollary  [ cor :",
    "brush ] , we can check for each of them whether it includes both @xmath308 $ ] and @xmath456 $ ] or not . by proposition  [ prop : brush4 ] , if none of the @xmath277-brushes contains both @xmath308 $ ] and @xmath456 $ ] , then these segments cross , and otherwise , they do not cross .",
    "this completes the proof of the theorem .",
    "in this section we consider the abstract ( i.e. , non - geometric ) graph @xmath12 .",
    "recall that , as defined in the introduction , the vertices of the tree graph @xmath458 are all the spanning trees of @xmath12 , and two spanning trees are adjacent if they differ in exactly two edges .",
    "we prove theorem  [ thm : main - general ] , stating that the automorphism group of @xmath458 is isomorphic to @xmath459 .",
    "it turns out that the theorem can be proved by roughly the same methodology as the proof of theorem  [ thm : main ] , as shown below .",
    "altogether , the proof in the abstract setting turns out considerably simpler than its geometric counterpart .",
    "* identification of stars in @xmath458 . * denote @xmath460 , and let @xmath461 . as in the geometric case , our first step is identification of the vertices of @xmath10 that represent stars .",
    "unlike the geometric case , here the identification is immediate .          on the other hand ,",
    "if @xmath115 is not a star then it is easy to see that the graph @xmath468 is connected , and thus , there exists @xmath462 that does not share an edge with @xmath115 .",
    "hence , @xmath469 .",
    "we note that since the distance in @xmath10 between any pair of stars in @xmath470 , it follows that the quantity @xmath471 equals @xmath470 if @xmath115 represents a star and @xmath472 otherwise .",
    "consequently , the set of vertices that represent stars is exactly the _ center _ of the graph @xmath10 .",
    "these vertices can be identified with the vertices of @xmath12 in an arbitrary way ( as any automorphism of @xmath12 clearly induces an automorphism of @xmath10 ) .",
    "so , we call the @xmath80 vertices in @xmath10 that represent stars @xmath473 ( in some arbitrary order ) .",
    "* valences of vertices in @xmath458 . *",
    "the next simple step is identifying , for any @xmath162 and any vertex @xmath93 , what is the valence of @xmath93 in @xmath115 .",
    "note that we were not able to obtain such an identification in the geometric setting .        * max - cliques in @xmath458 .",
    "* our next step is examination of max - cliques in @xmath10 . as in the geometric case",
    ", we would like to determine whether a given max - clique is a @xmath38-clique or an @xmath35-clique .      as the discussion in section  [ sec :",
    "sub : max - cliques - basics ] is purely combinatorial , it applies without change to the abstract setting . in particular , all vertices in a @xmath38-clique @xmath256 are obtained from @xmath144 by removing an edge from its unique cycle , and all vertices in an @xmath35-clique @xmath481 are obtained from the two - component forest @xmath143 by adding an edge that connects its two components . as there are no geometric restrictions in our case",
    ", it follows that @xmath257 is equal to the size of the unique cycle in @xmath144 ( and , in particular , is between @xmath482 and @xmath80 ) , and @xmath483 , where @xmath8 is the number of vertices in one of the connected components of @xmath143 .",
    "hence , determination whether @xmath480 is a @xmath38-clique or an @xmath35-clique is non - trivial only if @xmath484 .",
    "a @xmath38-clique @xmath256 is of size @xmath472 if the unique cycle @xmath34 of @xmath144 is of size @xmath472 , which means that @xmath144 consists of @xmath34 plus a single additional edge .",
    "each element of @xmath256 is obtained from @xmath144 by removing one edge from @xmath34 .",
    "assume w.l.o.g . that @xmath485 , and the additional edge is @xmath486 $ ] .",
    "it is clear that @xmath487 is never a leaf in a tree of @xmath256 , @xmath488 is a leaf in all @xmath472 trees of @xmath256 , and each of the vertices @xmath489 is a leaf in exactly two trees of @xmath256 . in addition , @xmath256 has two trees that are paths .",
    "( these are the trees obtained by removing @xmath490 $ ] and @xmath491 $ ] . )",
    "these two trees can be recognized by checking that their sequence of valences is @xmath492 .",
    "an @xmath35-clique @xmath481 is of size @xmath472 if in the two - component forest @xmath143 , one component consists of a single vertex @xmath213 .",
    "assume , in addition , that @xmath481 has two elements that are paths .",
    "( otherwise , we can determine that @xmath481 is an @xmath35-clique by the previous paragraph . )",
    "this is possible only if the second component of @xmath143 is a path @xmath0 .",
    "in such a case , each endpoint of @xmath0 is a leaf in @xmath470 ( of the @xmath472 ) trees of @xmath481 .",
    "as in @xmath256 , all vertices except one are leaves in at most two trees of @xmath256 , this property allows to determine that @xmath481 is indeed an @xmath35-clique .    * the automorphism group of @xmath458 . *",
    "our last step is to show that the information on @xmath10 obtained so far is sufficient for determining uniquely the spanning tree represented by each vertex of @xmath10 .",
    "namely , given @xmath162 and two vertices @xmath493 , we would like to determine whether @xmath278 \\in e(t)$ ] or not .",
    "if this is possible , it implies that @xmath494 , since our determination is unique up to the arbitrary identification of the vertices of @xmath10 that represent stars with the vertices of @xmath12 .",
    "hence , this will complete the proof of theorem  [ thm : main - general ] .",
    "let @xmath162 and suppose @xmath493 , @xmath495 , @xmath496",
    ". then @xmath278 \\in e(t)$ ] if and only if @xmath115 has a neighbor @xmath154 in @xmath10 in which the valences of both @xmath292 and @xmath22 are smaller by @xmath497 than in @xmath115 .",
    "if @xmath278 \\not \\in e(t)$ ] then no removal of an edge from @xmath498 can reduce the valences of both @xmath292 and @xmath22 , and thus , @xmath154 as described in the claim does not exist . on the other hand , if @xmath278 \\in e(t)$ ] then the graph @xmath499\\}$ ] is a two - component forest in which both components are of size @xmath500 .",
    "hence , there exists an edge @xmath501 $ ] that connects the two components of @xmath77 and uses neither @xmath292 nor @xmath22 .",
    "the tree @xmath502\\ } \\cup \\{[p',q']\\}$ ] is a neighbor of @xmath115 as described in the claim .      1 .",
    "find a leaf @xmath503 of @xmath115 such that @xmath504 .",
    "2 .   find a neighbor @xmath154 of @xmath115 in @xmath458 such that @xmath505 .",
    "3 .   consider the @xmath38-clique @xmath506 , and find a tree @xmath507 such that @xmath508 and @xmath509 .",
    "we find a vertex @xmath510 such that @xmath511 .",
    "we claim that if @xmath512 then @xmath278 \\in e(t)$ ] , and otherwise , @xmath278 \\not \\in e(t)$ ] .",
    "* step 1 . *",
    "first , we note that if @xmath513 for all leaves @xmath503 of @xmath115 , then @xmath115 is a star , and thus , @xmath278 \\in e(t)$ ] for the unique @xmath22 whose valence in @xmath115 is greater than @xmath497 and @xmath278 \\not \\in e(t)$ ] for any other @xmath22 .",
    "hence , we may assume that there exists a leaf @xmath503 such that @xmath514 , and we only have to detect it .",
    "consider the set of leaves of @xmath115 other than @xmath292 : @xmath515 .",
    "( note that we can recognize this set , as we are able to determine valences of vertices . )",
    "we claim that @xmath516 if and only if there exists a neighbor @xmath154 of @xmath115 in @xmath458 such that @xmath517 .",
    "this allows to detect the desired @xmath503 by going over the elements of @xmath30 , and for each of them , going over the neighbors of @xmath115 in @xmath458 and checking whether the claimed neighbor exists .    to see that the claim holds , note that a neighbor @xmath154 of @xmath115 satisfies @xmath517 , if and only if it is of the form @xmath518\\ } \\setminus \\{e\\}$ ] , for an edge @xmath92 that belongs to the unique cycle @xmath34 of @xmath519\\}$ ] and uses neither @xmath292 nor @xmath503 .",
    "if @xmath520 , then @xmath34 is of length @xmath482 , and thus , it has no edges that use neither @xmath292 nor @xmath503 .",
    "thus , no such neighbor @xmath154 exists . if @xmath521 , then @xmath34 is of length @xmath522 , and thus , it includes an edge @xmath92 that uses neither @xmath292 nor @xmath503 .",
    "the tree @xmath523\\}$ ] is the desired neighbor of @xmath115 .",
    "* the required neighbor @xmath149 is the tree obtained from @xmath519\\}$ ] by removing the unique edge of the cycle @xmath34 that uses @xmath292 but not @xmath503 ( call it @xmath524 $ ] ) .",
    "the @xmath38-clique @xmath506 can be recognized using proposition  [ lemma : ui - cliques ] , since there exist only two max - cliques of @xmath458 that include both @xmath115 and @xmath154  a @xmath38-clique and an @xmath35-clique  and proposition  [ lemma : ui - cliques ] allows us to determine , which of them is the @xmath38-clique .",
    "then , @xmath149 can be recognized as the unique element of @xmath506 in which the valences of @xmath525 are @xmath497 and @xmath526 , respectively .",
    "* step 4 . *",
    "it is clear that the unique vertex whose valence in @xmath149 is smaller by one than its valence in @xmath115 is @xmath510 , as defined in step  3 . by the construction of @xmath34 ,",
    "@xmath524 $ ] is the unique edge of @xmath498 that emanates from @xmath292 , i.e. , @xmath510 is the unique neighbor of @xmath292 in @xmath115 . hence ,",
    "@xmath278 \\in e(t)$ ] if and only if @xmath527 , as asserted .",
    "the vertex @xmath510 is detected by comparing the valences of the vertices in @xmath149 with their respective valences in @xmath115 .",
    "m. c. hernando , complejidad de estructuras geom@xmath529tricas y combinatorias , ph.d .",
    "thesis , universitat polit@xmath529ctnica de catalunya , 1999 ( in spanish ) .",
    "available online at : http://www.tdx.cat/tdx-0402108-120036/"
  ],
  "abstract_text": [
    "<S> let @xmath0 be a finite set of points in general position in the plane . </S>",
    "<S> the structure of the complete graph @xmath1 as a geometric graph includes , for any pair @xmath2,[c , d]$ ] of vertex - disjoint edges , the information whether they cross or not .    </S>",
    "<S> the simple ( i.e. , non - crossing ) spanning trees ( ssts ) of @xmath1 are the vertices of the so - called geometric tree graph of @xmath0 , @xmath3 . </S>",
    "<S> two such vertices are adjacent in @xmath3 if they differ in exactly two edges , i.e. , if one can be obtained from the other by deleting an edge and adding another edge .    in this paper </S>",
    "<S> we show how to reconstruct from @xmath3 ( regarded as an abstract graph ) the structure of @xmath1 as a geometric graph . </S>",
    "<S> we first identify within @xmath3 the vertices that correspond to spanning stars . </S>",
    "<S> then we regard each star @xmath4 with center @xmath5 as the representative in @xmath3 of the vertex @xmath5 of @xmath1 . </S>",
    "<S> ( this correspondence is determined only up to an automorphism of @xmath1 as a geometric graph . ) </S>",
    "<S> finally we determine for any four distinct stars @xmath6 and @xmath7 , by looking at their relative positions in @xmath3 , whether the corresponding segments cross . </S>"
  ]
}