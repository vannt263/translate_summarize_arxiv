{
  "article_text": [
    "quantum annealing ( qa ) , the quantum counterpart of simulated annealing , is an approach for harnessing quantum mechanical effects in searching the energy landscapes of classical np - hard optimization problems @xcite .",
    "the development of a quantum annealer by _ d - wave systems _",
    "@xcite has initiated a great deal of theoretical and experimental research into the usefulness of the qa approach and its potential supremacy over classical algorithms  @xcite .    in recent years",
    ", the research community has focused mainly on searching for a useful area of application where qa demonstrates a scaling advantage over classical algorithms .",
    "although there is evidence that the d - wave quantum annealer exhibits quantum means of energy landscape exploration such as tunnelling @xcite and entanglement @xcite , the efforts to identify an application for which the device is able to outperform classical optimization have not yet been conclusive .",
    "the highlight of the search for potential quantum supremacy is the recent study by google @xcite on an artificially crafted weak  strong cluster problem showing that quantum approaches using either the d - wave 2x ( dw2x ) quantum annealer or quantum monte carlo simulation scale significantly better than simulated annealing .",
    "the primary difficulty in demonstrating a quantum scaling advantage on useful optimization problems can be attributed to the architecture of the quantum annealer .",
    "the quantum annealer is designed to find the ground state of ising hamiltonians with pair - wise interactions on a fixed sparse graph called `` chimera '' .",
    "although the majority of optimization problems across various disciplines can be translated into ising problems , their formulations usually have connectivity different from that specified by the chimera s structure .",
    "minor embedding ( me ) is a technique for mapping such _ non - native _ problems to the hardware , where several physical qubits encode one logical qubit @xcite .    due to the me",
    "overhead , embedded problems are suboptimal for determining a scaling advantage @xcite . however , the analysis of the quantum annealer s performance on these problems is critical for the design of future hardware architectures and the setting of various programming parameters .",
    "examples of studies on parametrized families of hard embedded problems include the sherrington  kirkpatrick model with random @xmath0 couplings , which is directly related to the graph partitioning problem @xcite , operational navigation and scheduling problems @xcite , the job - shop scheduling problem @xcite , the multi - period portfolio optimization problem @xcite , and the graph isomorphism problem @xcite . in this paper , we report on the performance of the dw2x and discuss efficient programming guidelines for the problem of measuring similarity among small molecules that are modelled as labelled graphs . to determine the similarity between two molecular graphs while accounting for noise , a relaxation of the maximum weighted independent set problem , known as maximum weighted co-@xmath1-plex problem ,",
    "is formulated such that it is consistent with the hardware s architecture .",
    "previous studies of non - native problems were conducted using randomly generated instances .",
    "to the best of our knowledge , our work is the first to examine the performance of a quantum annealer on real instances of problems in the context of molecular similarity .",
    "encoding and decoding are challenges specific to solving non - native problems on a quantum annealer .",
    "encoding includes two problems : topological embedding and parameter setting . in the former ,",
    "the mapping between each logical qubit and a set of connected physical qubits is determined . in the latter ,",
    "the strength of internal couplings ( among physical qubits corresponding to the same logical qubit ) is set , and the logical local fields and coupling values are distributed among the physical qubits and couplers . it is well known that both topological embedding and parameter setting problems have a significant impact on the efficiency of a quantum annealer @xcite .",
    "decoding refers to the process of inferring the solution of each logical qubit from the retrieved solutions of the corresponding physical qubits",
    ". an important consequence of the limited available precision @xcite and the existence of errors @xcite of the quantum annealer is that the physical qubits representing a logical qubit might be assign to different values .",
    "classical post - processing techniques are often used to assign the right value to the logical qubit . in this paper , we review current approaches for encoding and decoding non - native problems and provide alternatives to the current suboptimal practices , which require substantial computational time .",
    "the rest of the paper is organized as follows . in section  [ sec : molecular_similarity ] , we define the molecular similarity problem . in section  [ sec : quantum_annealing ] , a background on qa is presented and a novel formulation of the molecular similarity problem amenable to qa is developed .",
    "different challenges of solving an embedded problem on the hardware architecture are then discussed .",
    "detailed experimental results are presented in section  [ sec : experimental_results ] .",
    "we conclude and discuss future work in section  [ sec : conclusion ] .",
    "supplementary information is presented in the appendix .",
    "the measurement of structural similarity among molecules plays an important role in chemical and pharmaceutical research in areas such as drug discovery .",
    "the similarity measures proposed in the literature can be categorized into two classes .",
    "the first class uses a vector - based representation called a fingerprint in which the molecules are compared using distance metrics such as euclidean distance @xcite .",
    "although fingerprints are simple and computationally efficient , they can not provide accurate information on the common substructures of molecules .",
    "thus , in this paper , we use the other class , which was developed based on graph theoretical concepts .",
    "the second class of similarity measures uses the intuitive graph representation of the labelled molecular atom  bond structure .",
    "formally , a labelled graph of a molecule can be written as @xmath2 , where @xmath3 is the set of vertices , @xmath4 is the set of edges , @xmath5 is the set of labels assigned to each vertex , and @xmath6 is the set of edge labels .",
    "graph representations of molecules are often compared based on the property of isomorphism .",
    "two graphs @xmath7 and @xmath8 are called isomorphic if there is a bijection between their vertex sets such that there exists a mapping between the adjacent pairs of vertices of @xmath7 and @xmath8 .",
    "a more practical variation of isomorphism is the maximum weighted common subgraph ( mwcs ) , which identifies the largest weighted subgraph of @xmath7 that is isomorphic to a subgraph of @xmath8 .",
    "there is a correspondence between the mwcs problem and another well - known problem  the maximum weighted independent set ( mwis ) of a third graph , which can be induced from the graphs being compared @xcite .",
    "the vertices and edges of the third graph , called a _ conflict graph _ , represent possible mappings and the conflicts between them , respectively .",
    "the goal of the mwis problem is to find the largest weighted set of vertices such that there is no edge between all selected pairs , forming the largest conflict - free mapping .    since molecular data are subject to regular errors , representing the mwcs problem as the mwis problem makes it easier to relax the definition of similarity to account for the effect of noise in the data by considering as similar substructures with conflicts up to a certain threshold .",
    "there are different relaxations of the similarity requirement in the literature @xcite .",
    "one of the relaxations is known as the maximum weighted co-@xmath1-plex problem , in which the goal is to find the largest weighted set of vertices in the graph such that each vertex has at most @xmath9 edges connecting it to the other vertices .",
    "it is clear that the maximum weighted co-@xmath10-plex problem is the mwis problem @xcite .",
    "the majority of the similarity methods discussed above , including the mwis and maximum weighted co-@xmath1-plex problems , are in general np - hard , having exponentially increasing computational complexity due to the combinatorial nature of the graphs involved @xcite .",
    "an illustration of the molecular similarity problem and its co-@xmath1-plex formulation is shown in figure [ fig : cokplex_example ] .",
    "the maximum weighted co-@xmath1-plex solution is shown for two cases , @xmath11 and @xmath12 . ]",
    "the details of reducing molecules to graphs and building the corresponding conflict graph are discussed in our previous work @xcite . in the next section",
    ", we present an overview on qa and discuss how the problem of measuring molecular similarity can be solved by a quantum annealer .",
    "quantum annealing is a heuristic technique that was introduced to solve hard optimization problems by exploiting quantum mechanical effects such as quantum tunnelling .",
    "the solution to a combinatorial optimization problem is encoded into the ground state of a classical ising hamiltonian @xmath13 where the local fields and couplers are represented by @xmath14 and @xmath15 , respectively .",
    "the variables @xmath16 denote classical ising spin variables and the sums run over the weighted vertices @xmath3 and edges @xmath17 of a graph @xmath18 . specifically , the task is to find the spin configuration @xmath19 which minimizes @xmath20 .",
    "a quantum annealing solver attempts to minimize @xmath20 by implementing a time - dependent ising hamiltonian @xmath21,\\ ] ] where @xmath22 is the pauli spin operator on qubit @xmath23 and @xmath24 , with @xmath25 referred to as the annealing time . the functions @xmath26 and @xmath27 specify the annealing schedules where typically @xmath26 and @xmath27 are monotonically decreasing and increasing functions , respectively .",
    "the d - wave devices accept problems in terms of the hamiltonian described in equation  [ eq : ising ] .",
    "however , in conventional optimization formulations , binary variables @xmath28 commonly take values from @xmath29 instead of @xmath30 .",
    "this mathematical form is usually referred to as a quadratic unconstrained binary optimization ( qubo ) problem .",
    "fortunately , the qubo and ising formulations can be related by taking @xmath31 .",
    "thus , to solve any optimization problem on a quantum annealer , it is sufficient to reformulate it as an instance of qubo . in the sections to follow ,",
    "we describe how to formulate the maximum weighted co-@xmath1-plex problem in qubo form , how to map a qubo problem to the quantum hardware , and how to retrieve the logical answers from the physical solutions provided by the quantum annealer .",
    "a co-@xmath1-plex of a graph @xmath32 is a subgraph of @xmath32 in which each vertex has a degree of at most @xmath9 .",
    "formally , let @xmath33 be the conflict graph of two molecular graphs @xmath7 and @xmath8 , where @xmath34 , and @xmath35 represents both the bijection and the user - defined requirements . the latter allows the enforcement of customized structure restrictions , for example , adding an edge to @xmath35 if there is a mismatch between the edge labels of two molecular graphs .",
    "the maximum weighted co-@xmath1-plex of the conflict graph @xmath36 corresponds to the mwcs of @xmath7 and @xmath8 , where each possible pairing can violate at most @xmath9 constraints . before presenting the qubo formulation ,",
    "let us first define a star graph .",
    "+    [ stardef ] a graph @xmath37 is a star graph of size @xmath1 if it is a tree with @xmath38 vertices and one vertex of degree @xmath1 .",
    "based on the co-@xmath1-plex formulation , we do not penalize the conflict edges .",
    "each vertex in the conflict graph can have up to @xmath9 edges .",
    "therefore , we only penalize in situations where a subset of the vertices induces a subgraph in which there is one vertex with degree greater than @xmath9 .",
    "in other words , we penalize all subsets of vertices whose induced subgraph forms a star graph of size @xmath1 .",
    "further , let us define the binary parameter @xmath39 as @xmath40 where @xmath41 are the vertices of the conflict graph @xmath36 .",
    "the maximum weighted co-@xmath1-plex problem is formulated as    @xmath42 , \\end{aligned}\\ ] ]    where @xmath43 is a binary variable equal to 1 if the vertex @xmath44 is included in the maximum independent set or 0 otherwise , @xmath45 is the weight of vertex @xmath44 , and @xmath46 .",
    "the tunable parameter @xmath1 should be determined by the user .",
    "the objective function of formulation is a higher - order polynomial .",
    "there are several algorithms in the literature that map higher - order polynomials to quadratic polynomials ( * ? ? ?",
    "* and references therein ) .",
    "the hardware architecture of the d - wave devices consists of a fixed sparse graph called a chimera graph , in which each vertex is a physical flux qubit and each edge is a physical coupler between two qubits .",
    "each generation of devices has shown significant progress , including an increase in the number of qubits and reduction of noise . however , implementing a practical problem remains a challenge , mainly because of the physical constraints of the hardware .",
    "one of the fundamental limitations of these devices is their sparse connectivity .",
    "typically , a real - world problem formulation might require a different connectivity from that defined by the hardware graph .",
    "this is true of the molecular similarity problem , which involves finding the maximum weighted co-@xmath1-plex in a conflict graph @xmath36 .",
    "therefore , we need to encode the problem into the device s architecture .",
    "there are two aspects to this encoding process : the embedding problem and the parameter - setting problem .",
    "the embedding problem is commonly addressed by me techniques where each vertex of @xmath36 is replaced by a connected subgraph of the hardware graph , denoted by @xmath47 .",
    "each connected subgraph is ferromagnetically coupled and is referred to as a chain in the literature , though it does not necessarily have a linear , acyclic structure .",
    "an example of me is illustrated in figure [ fig : embedding_example ] , and more details about me can be found elsewhere @xcite .",
    "after embedding , the logical local field @xmath48 and the couplings @xmath49 are respectively distributed among the vertices and edges of the subgraph @xmath50 such that    @xmath51    the parameter - setting problem consists of determining the qubit biases @xmath52 and coupler strengths @xmath53 of the embedded problem .",
    "the encoding process is of particular importance since the performance of the quantum processor is highly sensitive to the choice of embedding and its corresponding parameters . in what follows ,",
    "we discuss both aspects of the encoding process , presenting the current approaches and describing the methods used in this work .     into the hardware graph .",
    "the logical variable @xmath10 is replaced by a connected subgraph with physical vertices @xmath54 which are ferromagnetically coupled . ]",
    "the problem of finding an me is in general np - hard . in this work ,",
    "we use the embedding software provided by d - wave systems .",
    "an me found by this algorithm is not necessarily unique or optimal .",
    "in fact , different mes representing the same qubo problem might result in different hardware performance .",
    "hence , a criterion or method to select an embedding which maximizes the hardware s performance is needed .",
    "we refer to this problem as the _ embedding selection problem_.    various embedding properties have been suggested as contributing factors affecting the hardware s performance .",
    "for instance , cai et al .",
    "@xcite advise that it is preferable to select an embedding which minimizes either the total number of physical qubits used or the maximum number of physical qubits representing a logical qubit ( i.e. , it minimizes the length of the longest chain ) .",
    "also , pudenz et al .",
    "@xcite show that for the problem of antiferromagnetic chains , the performance of the hardware decreases with chain size .",
    "however , for some problems with a more complex topology , such as operational planning problems @xcite , the chain length in the embedding did not contribute significantly to the hardware s performance .",
    "further evidence that these embedding properties do not necessarily affect the performance of the device has been presented by bian et al .",
    "they introduce a locally structured embedding algorithm which considers the local structure of the hardware , in contrast to an me approach which is referred to as a global embedding .",
    "in particular , they show that the local embedding , which requires more qubits and longer chains in general , yields better performance compared with the me approach . another embedding property has been considered in ref .",
    "@xcite , in which the authors suggest that it is preferable to use embeddings with chains of equal length . considering these embedding properties as criteria in selecting an embedding",
    "has been sufficient for some specific problems .",
    "however , for general problems , a more sophisticated embedding selection strategy is still lacking .    given that none of the current embedding selection criteria seem to predict or optimize the performance of the hardware for general problems , we implement an empirical approach to select an embedding .",
    "we refer to the embedding selected by this method as _",
    "empirical embedding_. our empirical selection method consists of generating @xmath55 distinct embeddings for each problem instance and setting their parameters according to the method described in section  [ subsubsec : parameter_setting ] .",
    "we run @xmath56 anneals at @xmath57 @xmath58 and use majority vote decoding as described in section  [ sec : decoding ] for each embedded instance . from this pool of embeddings ,",
    "we select the @xmath59 embeddings , which results in a higher success probability .",
    "the experiment is repeated on the reduced pool of embeddings .",
    "we then select the embedding that maximizes the success probability .",
    "a similar approach has been used by king et al .",
    "@xcite . to empirically select the embedding",
    ", we use a priori knowledge of the optimal value . in general , a different approach , which selects the solutions with minimum energy , could be considered instead . for example , perdomo - ortiz et al .",
    "@xcite introduce a performance estimator based on minimum - energy solutions to guide the selection of the best programming specifications .",
    "we use the optimal known solution to better demonstrate that the current embedding selection criteria do not necessarily optimize the performance of the hardware .",
    "a problem graph describing the structure of an optimization problem , such as the conflict graph @xmath36 , has been reduced accurately to its minor - embedding @xmath60 as long as there is a one - to - one correspondence between the ground states of the optimization problems defined on both graphs .",
    "it is well known that regardless of how the logical parameters , including local fields and couplers , are distributed among the physical qubits , a large negative value of the ferromagnetic couplers , @xmath61 , ensures the correspondence between the ground states such that there is no broken connected subgraphs ( i.e. , the physical qubits encoding one logical qubit result in an identical state ) . however , since a quantum annealer is an analogue machine with finite available precision , it is important to find a sufficiently small value for these ferromagnetic couplers . in this case",
    ", the values of the ferromagnetic couplers are also dependent on how the logical parameters are distributed .",
    "an additional restriction of the dw2x architecture is the limited range of the @xmath62 and @xmath63 parameters , i.e. , @xmath64 $ ] and @xmath65 $ ] , respectively .",
    "the values of @xmath62 and @xmath63 can be scaled so that they lie within their respective ranges by multiplying them with a positive constant factor @xmath66 .",
    "this parameter is called the `` scaling factor '' in the rest of the paper .",
    "the literature on setting the parameters of an embedded graph can be divided , in general , into empirical and theoretical schemes .",
    "the former are the most widely used approaches , and include the work of venturelli et al .",
    "@xcite , vinci et al .",
    "@xcite , and perdomo - ortiz et al .",
    "@xcite . in the empirical approaches , the logical field and coupler values",
    "are evenly distributed among the physical qubits . to determine the strengths of the ferromagnetic couplers ,",
    "the sample data from the device is used to experimentally find the optimal strength of the ferromagnetic couplers such that the probability of observing the ground state is maximized .",
    "the drawbacks of empirical approaches are twofold .",
    "first , inferring the strength of the ferromagnetic couplers based on the samples from a device that is subject to various types of errors does not guarantee that the ground state of the input graph @xmath36 is the same as the ground state of the embedded graph @xmath60 .",
    "second , the empirical approaches are essentially trial - and - error approaches requiring significant computation time that increases as the size of the input graph increases .    to the best of our knowledge , there is only one paper that discusses a theoretical approach to setting the parameters of an embedded graph @xcite . in the approach proposed by choi @xcite ,",
    "the distribution of the logical coupler values is similar to the empirical approaches , though the logical local field values are differently distributed .",
    "furthermore , it is assumed that the subgraphs representing each logical qubit are subtrees of the hardware graph .",
    "however , this assumption does not necessarily hold for all embedded real - world problems , including some molecular similarity problems .    in this work ,",
    "we use a generalization of choi s theoretical method and compare it with an empirical approach to investigate the potential benefit of a theoretical parameter - setting approach .",
    "it is worth mentioning that the empirical approach used in this paper is different from the approaches used in the literature . both are explained below and the results of their performance are discussed in section  [ subsection : emp_theo_parameter_setting ] .",
    "* empirical parameter - setting * we empirically set the strengths of ferromagnetic couplers using the hamze ",
    "de freitas  selby ( hfs ) algorithm @xcite .",
    "initially , we set @xmath67 , where @xmath68 refers to the strength of all ferromagnetic couplers tying together the physical qubits representing the logical qubit @xmath23 . we distribute the logical local field @xmath48 and couplings @xmath49 evenly among the corresponding physical qubits and couplers , and scale their values to be in the available range .",
    "we then solve the scaled problem with the hfs algorithm @xmath69 times .",
    "if there is no broken connected subgraph in at least one of the solutions , we stop and set the ferromagnetic coupler strengths to @xmath70 .",
    "otherwise , we decrease @xmath68 by @xmath71 and repeat the above procedure .",
    "the empirical strength of ferromagnetic couplers used is the first value found for which none of the connected subgraphs are broken .",
    "we use @xmath72 and @xmath73 in our experiment .    *",
    "theoretical parameter - setting * to theoretically set the @xmath68 values , we generalize the approach proposed by choi  @xcite , where the logical couplings are distributed evenly among the physical couplers and the logical local fields are distributed following the procedure in algorithm  [ parameter ] . in our generalization , there is no need to reduce the subgraphs to trees .",
    "the details of our generalization are explained in appendix [ subsec : appendix_theoretical_parameter_setting ] .",
    "a decoding strategy refers to the process of inferring the value of each logical qubit given the values of the physical qubits obtained from the quantum annealer .",
    "if the values of the physical qubits encoding one logical qubit agree , the common value of the physical qubits is assigned to the logical qubit . otherwise , the logical qubits are considered broken and should be repaired .",
    "there are two general decoding strategies known as local and global @xcite .",
    "the former approach decodes the broken logical qubits individually .",
    "examples of local algorithms include heuristic algorithms with polynomial time complexity such as majority vote , coin tossing , and greedy descent .",
    "the latter approach decodes the broken qubits simultaneously .",
    "this process involves solving an optimization problem induced by the broken logical qubits , which is referred to as a `` decoding '' hamiltonian .",
    "the disadvantage of a global decoding technique is that it requires solving an ising problem belonging to the class of np - complete problems .",
    "examples of such algorithms are exhaustive search and simulated annealing .",
    "majority vote ( mv ) , which assigns the most repeated value within an encoded subgraph to its corresponding logical qubit , is the simplest and most widely used approach in the literature @xcite .",
    "however , vinci et al . @xcite point out that mv is not appropriate for the minor - embedded problems since physical excitations are more likely to occur during the evolution of embedded problems and the probability that physical qubits break independently ( the required criterion for the success of mv ) can not be considered valid .",
    "furthermore , they mention that mv can not be more effective than coin tossing in cases where the breakage of an encoded subgraph in various ways results in the same energy . instead",
    ", they use simulated annealing to globally minimize the energy of the broken qubits .",
    "the main drawback of the global decoding strategies is that minimizing the energy of the decoding hamiltonian can be as hard as solving the original hamiltonian . to justify the computational cost , vinci et al .",
    "@xcite use the critical probability , @xmath74 , as a decoding threshold .",
    "the critical probability is the probability of an infinite cluster appearing for the first time in an infinite lattice .",
    "if the probability for an encoded ( logical ) qubit to be broken , @xmath75 , is greater than @xmath74 , global approaches can not be performed efficiently since the probability of having infinitely large broken clusters approaches 1 as the total number of logical qubits goes to infinity ( @xmath76 ) . however , if @xmath77 , the probability of having infinitely large broken clusters approaches 0 if the largest size of the decodable connected logical qubits is close to @xmath78 .",
    "vinci et al .",
    "@xcite show that the percolation threshold of their encoded logical graph is well beyond the experimental probability that a logical qubit breaks @xcite .    in this paper",
    ", we use mv to decode the broken hardware answer , map it back to the logical space , and then apply a greedy descent method to the logical answer as a post - processing technique to further refine the retrieved solution .",
    "justification for the selection of mv as a local decoding strategy can be found in section  [ subsec : greedy_descent ] .",
    "the quantum annealer used in this work is a dw2x processor located at nasa s ames research center .",
    "it consists of 1097 working flux qubits and 3060 working couplers arranged in a chimera graph architecture and operates at 15 mk . to empirically evaluate the performance of a stochastic solver such as the dw2x ,",
    "the standard metric is time - to - solution ( tts ) , the total time required by the solver to find the ground state at least once with a probability of @xmath79 . defining @xmath80 as the number of runs required by the solver to find the ground state at least once with a probability of @xmath79",
    ", we have @xmath81 , where @xmath82 is the duration of each annealing run .",
    "the calculation of tts is explained in detail in appendix [ subsec : appendix_tts ] .    in this section ,",
    "we first discuss the experimental setup .",
    "we then present the tts results and investigate the effect of different embedding criteria , parameter setting approaches , and annealing times on the performance of the dw2x .",
    "finally , we justify the use of mv as a decoding strategy and report on the improvement made on the performance of the dw2x using a simple post - processing technique .",
    "we generate a parametrized family of the molecular similarity problems by using molecules from an available data set that consists of @xmath83 small molecules @xcite .",
    "the molecular similarity problem corresponds to finding the maximum weighted co-@xmath1-plex in a conflict graph @xmath36 as defined in section [ sec : molecular_similarity ] .",
    "the vertices @xmath3 and edges @xmath17 of @xmath36 represent the matchings and conflicts between the molecules being compared , respectively .",
    "the size of @xmath36 , defined in terms of its number of vertices @xmath84 , depends on the size of the molecules and the similarity conditions considered .",
    "it is worth mentioning that the number of logical variables in the molecular similarity problem corresponds to the size of @xmath36 , not the size of the molecules being compared .",
    "the size of @xmath36 grows as the value of @xmath1 in formulation increases .",
    "for example , the maximum size of @xmath36 that we can successfully embed into a dw2x processor is @xmath85 and @xmath86 for @xmath11 and @xmath87 , respectively . in this paper , we consider @xmath11 in order to study the performance of the dw2x on larger non - native problems .",
    "the conflict graphs are then parametrized by @xmath88 , where the number of vertices @xmath84 is selected from the set @xmath89 , and the density @xmath90 is selected from the range in the set @xmath91",
    "| k=0 , \\ldots , 2 \\ } $ ] . for each combination of @xmath84 and @xmath90 ,",
    "100 different instances are generated .",
    "0.5 , @xmath92 , and @xmath93 for @xmath94 $ ] , @xmath95 $ ] , and @xmath96 $ ] , respectively.,title=\"fig : \" ]    0.5 , @xmath92 , and @xmath93 for @xmath94 $ ] , @xmath95 $ ] , and @xmath96 $ ] , respectively.,title=\"fig : \" ]    * embeddability * to study the embeddability of the molecular similarity instances , we use the ` find_embedding ( ) ` function from sapi 2.2 @xcite with default parameter values , but with the number of trials per function call set to @xmath97 .",
    "figure [ fig : phy_qubits_estimation : a ] shows the mean success rate of the embeddability across 100 instances .",
    "the embeddability success rate is defined as the fraction of the number of embeddings found over the total number of trials . as shown in figure [ fig : phy_qubits_estimation : a ]",
    ", embeddings are found for all instances up to size @xmath98 , regardless of their densities .",
    "the number of embeddings generated decreases for size @xmath85 and eventually reaches 0 for size @xmath99 .",
    "we also estimate the mean number of physical qubits required to embed the given instances .",
    "as illustrated in figure [ fig : phy_qubits_estimation : b ] , the mean number of physical qubits scales similarly across different densities .",
    "the scaling is @xmath100 , @xmath101 , and @xmath102 for density @xmath94 $ ] , @xmath95 $ ] , and @xmath96 $ ] , respectively .",
    "figure [ fig : tts_main ] shows the 25th , 50th , 75th , and 99th percentiles of the tts for three different densities over 100 instances for each problem size . for every instance",
    ", the true ground state is found using the gurobi solver ( version 6.5.1 ) , the best empirical embedding is selected , the parameters are theoretically set , the annealing time is set at @xmath103 @xmath104 ( see section  [ subsec : annealing_time ] ) , the retrieved solution from the hardware is decoded using mv . a common strategy to average out systematic errors is to perform gauge transformations between each call to the quantum annealer @xcite .",
    "since we are plotting the tts for a class of instances of similar size , not an individual instance , and the tts has a higher variance over different instances than different gauges , the timing data is not averaged over multiple gauges @xcite .",
    "the 99th percentile of the tts is not shown in figure [ fig : tts_main ] if all 100 instances are not solved given 5 calls to the dw2x and 10,000 anneals per call .",
    "the lower limit of the standard deviation of the 99th percentile is also not shown for several sizes in case it is bigger than the mean of the 99th percentile . as illustrated ,",
    "the tts is higher for problems with lower densities .",
    "as the density of the qubo graph reaches the extreme values of 0 and 100 , we intuitively expect that the problem of identifying the maximum independent set becomes easier",
    ". furthermore , the large differences between the median and 99th percentiles of the tts for several sizes and densities are indications of heavy tails in the distributions of the tts .",
    "in other words , this result conveys that the hardness of our problems does not depend solely on the number of logical variables .",
    "it significantly differs across instances with a similar number of logical variables .",
    "[ .4][c ] $ ] , ( b ) @xmath95 $ ] , and ( c ) @xmath96 $ ] .",
    "the number of calls to the dw2x and the number of anneals per call are 5 and 10,000 , respectively.,title=\"fig : \" ] [ .4][c ] $ ] , ( b ) @xmath95 $ ] , and ( c ) @xmath96 $ ] .",
    "the number of calls to the dw2x and the number of anneals per call are 5 and 10,000 , respectively.,title=\"fig : \" ] [ .4][c ] $ ] , ( b ) @xmath95 $ ] , and ( c ) @xmath96 $ ] .",
    "the number of calls to the dw2x and the number of anneals per call are 5 and 10,000 , respectively.,title=\"fig : \" ]      following the discussion in section  [ subsec : embedding_selection ] , different embedding representations of the same ising hamiltonian might result in different performance of the qa hardware . in the literature",
    ", it has been suggested that optimizing some embedding properties could be an important factor that affects the performance of the hardware , for example , minimizing the total number of qubits used in an embedding .",
    "figure [ fig : emb_motivation ] depicts a counterexample to this argument for an instance of the molecular similarity problem .",
    "in particular , we do not observe any type of correlation between the mean success probability and the number of physical qubits used in the embedding .",
    "additionally , we note that if the embedding yielding a low success probability is selected , such an instance will be misclassified as a hard instance and might mask a heavy tail in the final tts results .",
    "these observations motivate us to perform a more comprehensive study to address the embedding selection problem .",
    "and density @xmath95 $ ] .",
    "the results are shown for @xmath55 different embedding representations of the same instance . ]    to test the overall impact of the embedding selection problem on the quantum hardware s performance , we experimentally compare three criteria previously proposed in the literature .",
    "we generated @xmath97 instances for each problem size and @xmath55 embeddings for each instance , and selected @xmath10 embedding according to each of the criteria .",
    "specifically , we consider the following criteria :    1 .   selecting the embedding with the smallest number of physical qubits ( pq ) ; 2 .   selecting the embedding with the shortest longest chain ( lch ) ; 3 .   selecting the embedding with chains of equal length ( std )",
    "whereas the first two criteria are straightforward , heuristic me algorithms do not necessarily return embeddings with chains of equal length as required for the third criterion . to account for the selection of an embedding with chains of equal size , we calculate the standard deviation of the chain size for each embedding and select the embedding with the minimum standard deviation .",
    "further , we consider the empirical selection criteria for which we select the embedding that yield the highest success probability .",
    "each point indicates the mean across @xmath97 instances of each problem size .",
    "a ) shows the comparison in terms of the mean success probability for the dw2x device performing @xmath56 annealing runs .",
    "additional results show comparison in terms of ( b ) the mean number of physical qubits , ( c ) the mean size of the largest chain , and ( d ) the mean std of chain size.,title=\"fig : \" ]    0.5 $ ] .",
    "each point indicates the mean across @xmath97 instances of each problem size .",
    "a ) shows the comparison in terms of the mean success probability for the dw2x device performing @xmath56 annealing runs .",
    "additional results show comparison in terms of ( b ) the mean number of physical qubits , ( c ) the mean size of the largest chain , and ( d ) the mean std of chain size.,title=\"fig : \" ]    0.5 $ ] .",
    "each point indicates the mean across @xmath97 instances of each problem size .",
    "a ) shows the comparison in terms of the mean success probability for the dw2x device performing @xmath56 annealing runs .",
    "additional results show comparison in terms of ( b ) the mean number of physical qubits , ( c ) the mean size of the largest chain , and ( d ) the mean std of chain size.,title=\"fig : \" ]    0.5 $ ] .",
    "each point indicates the mean across @xmath97 instances of each problem size .",
    "a ) shows the comparison in terms of the mean success probability for the dw2x device performing @xmath56 annealing runs .",
    "additional results show comparison in terms of ( b ) the mean number of physical qubits , ( c ) the mean size of the largest chain , and ( d ) the mean std of chain size.,title=\"fig : \" ]    figure  [ fig : emb_selec : a ] shows the embedding selection comparison for the three criteria and the empirical embedding in terms of the mean success probability .",
    "we observe that these three selection criteria perform similarly poorly against the best embedding found empirically .",
    "further , the empirical embedding uses on average more physical qubits , its longest chain is longer , and its chains have higher std as shown in figures [ fig : emb_selec : b ] , [ fig : emb_selec : c ] , and [ fig : emb_selec : d ] , respectively .",
    "therefore , the use of these criteria has no effect on the success probability .",
    "an additional observation can be made from figure  [ fig : emb_selec : a ] .",
    "as the logical problem size increases , the difference between the embedding selection methods decreases . a possible reason could be that for larger problems , most of the embeddings found with the heuristic algorithm reach the limit size of the chip .",
    "thus , we have less freedom to generate different embeddings .",
    "this observation is in agreement with the argument provided by cai et al .",
    "@xcite for the success of a heuristic me algorithm .",
    "specifically , they state that if the problem to be embedded is significantly smaller than the hardware graph s size , there are probably more  distinct embeddings .    to generate the results shown in figures [ fig : emb_motivation ] and [ fig : emb_selec ] ,",
    "we perform @xmath56 annealing runs for each problem instance . in order to verify",
    "if performing gauge averaging or a larger number of anneals will affect our conclusions regarding the embedding selection problem , we perform additional experiments . specifically , we repeat the test shown in figure  [ fig : emb_motivation ] for two cases : @xmath56 anneals and @xmath59 random gauges ; and 50,000 anneals and the default gauge .",
    "we also repeat the test for the first criterion presented in figure  [ fig : emb_selec : a ] using @xmath56 anneals and 5 random gauges . in all cases ,",
    "the new results verify that there is no correlation between the number of physical qubits used and the success probability .",
    "these results suggest that further investigation is needed in order to understand which properties of embeddings have an influence on the hardware s performance when solving problems with a complex topology , such as the conflict graphs in the molecular similarity problems",
    ". meanwhile , an empirical method like the one performed here can be applied .",
    "figure [ fig : theor_empirical ] shows the comparison of the performance of the dw2x using two different parameter - setting schemes with respect to four measures : success probability , size of the biggest broken cluster , residual energy , and computation time .",
    "the second measure represents the largest size of a decodable domain in which all broken logical qubits are connected .",
    "the third measure is the relative energy difference between the quantum annealer s lowest - energy solution and the actual ground state found by the gurobi solver .    0.5 $ ] .",
    "( a ) shows the success probability ( log ) when the parameters of the embedded graphs are set theoretically or empirically .",
    "( b ) shows the size of the biggest broken cluster size for theoretical and empirical parameter settings .",
    "( c ) illustrates the residual energy for theoretical and empirical parameter settings .",
    "( d ) illustrates the computation time ( seconds ) to set the parameters theoretically and empirically .",
    "all four measures represent the average value over 100 instances .",
    "these figures are generated by setting @xmath105 @xmath104 , and the number of calls and anneals per call are set to 5 and 10,000 , respectively.,title=\"fig : \" ]    0.5 $ ] .",
    "( a ) shows the success probability ( log ) when the parameters of the embedded graphs are set theoretically or empirically .",
    "( b ) shows the size of the biggest broken cluster size for theoretical and empirical parameter settings .",
    "( c ) illustrates the residual energy for theoretical and empirical parameter settings .",
    "( d ) illustrates the computation time ( seconds ) to set the parameters theoretically and empirically .",
    "all four measures represent the average value over 100 instances .",
    "these figures are generated by setting @xmath105 @xmath104 , and the number of calls and anneals per call are set to 5 and 10,000 , respectively.,title=\"fig : \" ]    0.5 $ ] .",
    "( a ) shows the success probability ( log ) when the parameters of the embedded graphs are set theoretically or empirically .",
    "( b ) shows the size of the biggest broken cluster size for theoretical and empirical parameter settings .",
    "( c ) illustrates the residual energy for theoretical and empirical parameter settings .",
    "( d ) illustrates the computation time ( seconds ) to set the parameters theoretically and empirically .",
    "all four measures represent the average value over 100 instances .",
    "these figures are generated by setting @xmath105 @xmath104 , and the number of calls and anneals per call are set to 5 and 10,000 , respectively.,title=\"fig : \" ]    0.5 $ ] .",
    "( a ) shows the success probability ( log ) when the parameters of the embedded graphs are set theoretically or empirically .",
    "( b ) shows the size of the biggest broken cluster size for theoretical and empirical parameter settings .",
    "( c ) illustrates the residual energy for theoretical and empirical parameter settings .",
    "( d ) illustrates the computation time ( seconds ) to set the parameters theoretically and empirically .",
    "all four measures represent the average value over 100 instances .",
    "these figures are generated by setting @xmath105 @xmath104 , and the number of calls and anneals per call are set to 5 and 10,000 , respectively.,title=\"fig : \" ]    as illustrated , the theoretical approach is overall superior to the empirical approach .",
    "it results in a higher probability of success ( especially as the size of the problem increases ) , smaller broken clusters , lower residual energy , and lower computation time .",
    "these results indicate that the theoretical approach can be a strong alternative to replace current empirical practices in the literature .",
    "the theoretical approach reduces the pre - processing computation time to set the problem parameters and boosts the performance of the quantum annealer .",
    "it is worth mentioning that the reported performance for the empirical approach in this paper is most likely an upper bound on the performance of the typical empirical approaches in the literature for two main reasons .",
    "first , the value of the ferromagnetic couplers is optimized per instance in our empirical approach , whereas it is usually optimized per class of instances with the same size in the literature .",
    "second , in our approach , the analogue , noisy quantum solver is replaced by a classical solver with higher precision , thereby decreasing the probability that the qubits representing one logical qubit resolve into different states .     @xmath104 . ]    to gain more insight into the nature of the superiority of the theoretical parameter - setting approach , the difference between the theoretical scaling factor and the empirical scaling factor for each instance was found .",
    "figure [ fig : theor_empirical_scalefactor ] shows the @xmath106th , @xmath55th , and @xmath107th percentiles of the scaling difference over 100 instances for each problem size . as illustrated , the theoretical approach yields a larger scaling factor as the number of logical variables increases ( the difference is positive ) , which explains its better performance over the empirical approach .",
    "solving classical optimization problems by exploiting quantum effects is of central interest in the field of experimental quantum annealing .",
    "although the presence of entanglement @xcite and multiqubit tunnelling @xcite in d - wave processors have been experimentally demonstrated , any scaling advantage over classical algorithms remains elusive .",
    "when studying scaling , it is important to determine an optimal implementation . in the case of non - native problems , optimality refers to determining an effective encoding , as has been addressed in the previous sections .",
    "once an encoding has been determined , it is necessary to find the optimal annealing time .    in ref .",
    "@xcite , it was suggested that the annealing time must be optimized for each problem size . in this context , various studies have tried to determine an optimal annealing time for different random instances and have arrived at the conclusion that the minimum possible @xmath108 @xmath58 of d - wave processors is longer than the optimal annealing time @xcite . alternatively , hen et al .",
    "@xcite have found instances whose optimal annealing time on the same processor is greater than @xmath109 @xmath58 .",
    "although it is outside of the scope of this paper to probe for quantum speedup , we are interested in studying the dw2x s performance dependance on the annealing time for our molecular similarity problem instances . a recent upgrade to the dw2x processor introduced a faster minimum annealing time of @xmath110 @xmath58 , allowing us to test the quantum annealer s performance dependency on @xmath25 for shorter annealing times .",
    "@xmath58 and @xmath108 @xmath58 .",
    "results are shown for different numbers of logical variables , varying from @xmath111 to @xmath112 and coloured accordingly , and density @xmath113 $ ] . ]    from the correlation plot in figure [ fig : sp_correlation ] , it seems that a longer annealing time increases the success probability . in order to gain better insights",
    ", we performed a _",
    "t_-test to determine whether the difference between these samples is statistically significant .",
    "we obtained a @xmath114-value close to @xmath115 , which implies that the higher mean success probability at @xmath116 @xmath58 has not occurred only by chance .",
    "this result provided enough evidence to accept the hypothesis that the difference between the mean success probabilities at @xmath117 @xmath58 and @xmath57 @xmath58 is statistically greater than @xmath115 , which can be understood in two different ways .",
    "firstly , it has been suggested that the success probability is a monotonically increasing function of @xmath25 @xcite . in this sense , we should expect that longer annealing times will increase the success probability until the asymptotic regime is reached .",
    "a counterexample to this assumption has been presented by amin @xcite , who presented a nonmonotonic success probability function of @xmath25 . according to his findings ,",
    "our results for the success probability at @xmath110 @xmath58 and @xmath108 @xmath58 indicate that our system is in a quasistatic regime and that those annealing times are still too long .",
    "figure [ fig : percolation_prob_all_sizes ] shows the mean experimental probability of there being broken qubits ( @xmath118 ) for different sizes of the molecular similarity instances with @xmath119 $ ] , as well as their corresponding mean percolation thresholds ( @xmath74 ) .",
    "the calculation of the percolation threshold is explained in detail in appendix [ subsec : appendix_percolation ] . as illustrated , the values of @xmath118 approach @xmath74 as the number of logical variables increases .",
    "the trend of the @xmath118 and @xmath74 values shows the experimental probability of there being broken qubits would eventually be larger than the percolation threshold for larger graph similarity instances .",
    "therefore , the global decoding schemes will be inefficient for large instances of our graph similarity problem",
    ". the probability of having large broken clusters would be high , and solving the remaining problem would be as hard as solving the original .",
    "the average is taken over 100 instances . ]    to locally decode the physical solutions , we apply mv since it requires the least possible effort to retrieve a solution from the physical space .",
    "it also gives a clear picture of the efficiency of the quantum annealer , with minimal contribution from a classical computer .",
    "the decoded logical solutions obtained by mv might be local optima . to further improve the quality of the decoded solutions , we use the greedy descent method .",
    "figure [ fig : r99_mv_gd ] shows the effect of applying greedy descent on the decoded logical solutions obtained by mv . as shown , there is a noticeable difference between the median @xmath80 before and after applying greedy descent , implying that refining the quantum solutions via classical post - processing techniques would be necessary to efficiently solve non - native problems using a quantum annealer .     for three different densities using mv and greedy descent , where the number of calls and anneals per call are set to 5 and 10,000 , respectively . ]",
    "in this work , we have studied the performance of a quantum annealer in solving instances of the molecular similarity problem utilizing a real data set .",
    "the effective use of a quantum annealer presents many challenges . here , we focused on challenges derived from encoding and decoding real - world problems .",
    "we addressed the challenges present in both aspects of encoding , that is , embedding and parameter setting , and demonstrated how a careful encoding strategy helps to improve the performance of the dw2x device .",
    "in particular , our results emphasized the importance of the embedding selection problem .",
    "for some instances , we observed that two different embedding representations of the same original problem yield very different success probabilities .",
    "commonly , this difference is attributed to various properties of embedding , for example , the number of qubits used .",
    "however , we have shown that none of the commonly observed embedding properties correlate with the hardware s performance . in this work ,",
    "we have incorporated an empirical method that selects the embedding that maximizes the success probability . we have also observed that the performance of the quantum annealer is less sensitive to the choice of embedding when increasing the size of the original problem .",
    "this result is expected since a minor - embedding heuristic will successfully find a larger number of distinct embeddings if the size of the problem to be embedded is significantly smaller than the size of the chip .",
    "thus , we expect that the poor performance of embedded problems with a size as large as the size of the current chip should improve in a next - generation quantum annealer .",
    "we have also shown that using a theoretical , rather than empirical , approach to select the parameters in the embedding can have significant advantages .",
    "besides eliminating the impractical experimental penalty optimization , a theoretical parameter - setting approach ensures an accurate representation of the logical ising hamiltonian , and as a consequence reduces the probability of broken qubits .",
    "of particular importance is the overall boosting of the hardware s performance , which benefits from an improved scaling factor over the empirical approach .",
    "another important question we have addressed is the selection of a decoding technique . for our problem",
    "set , we have found that a simple local decoding technique is effective .",
    "this is mainly a consequence of the reduced connectivity of broken logical qubits .",
    "specifically , we have shown that fufrther improvement in the hardware performance can be achieved if we use majority vote to fix the broken solutions and subsequently apply a greedy descent post - processing technique .    whereas our experimental conclusions are restricted to the specific type of problem studied here , the results provide useful insight for future non - native benchmarking studies .    in future work",
    ", we will address some of the questions still open regarding the effective implementation of a problem embedded into a quantum annealer .",
    "of practical importance is gaining a better understanding of which properties correlate to the performance of the quantum annealer .",
    "one possible research direction could be to study the quality of the physical qubits and couplers in the chip .",
    "an alternative direction could be to study whether the properties defining the hardness of spin glass problems have an impact on the hardware s performance .",
    "after having determined an optimal encoding , we will address the problem of determining the optimal annealing time .",
    "10    e.s .",
    "giuseppe , t.  erio , j. phys .",
    "gen . * 39 * , r393 ( 2006 )    e.  farhi , j.  goldstone , s.  gutmann , j.  lapan , a.  lundgren , d.  preda , science * 292 * , 472 ( 2001 )    m.w .",
    "johnson , m.h.s .",
    "amin , s.  gildert , t.  lanting , f.  hamze , n.  dickson , r.  harris , a.j .",
    "berkley , j.  johansson , p.  bunyk , e.m .",
    "chapple , c.  enderud , j.p .",
    "hilton , k.  karimi , e.  ladizinsky , n.  ladizinsky , t.  oh , i.  perminov , c.  rich , m.c .",
    "thom , e.  tolkacheva , c.j.s .",
    "truncik , s.  uchaikin , j.  wang , b.  wilson , g.  rose , nature * 473 * , 194 ( 2011 )    v.s .",
    "denchev , s.  boixo , s.v .",
    "isakov , n.  ding , r.  babbush , v.  smelyanskiy , j.  martinis , h.  neven , phys .",
    "x * 6 * , 031015 ( 2016 )    i.  hen , j.  job , t.  albash , t.f .",
    "rnnow , m.  troyer , d.a .",
    "lidar , phys .",
    "a * 92 * , 042325 ( 2015 )    d.  venturelli , s.  mandr , s.  knysh , b.  ogorman , r.  biswas , v.  smelyanskiy , phys .",
    "x * 5 * , 031040 ( 2015 )    w.  vinci , t.  albash , g.  paz - silva , i.  hen , d.a .",
    "lidar , phys .",
    "a * 92 * , 042310 ( 2015 )    h.g .",
    "katzgraber , f.  hamze , z.  zhu , a.j .",
    "ochoa , h.  munoz - bauza , phys .",
    "x * 5 * , 031026 ( 2015 )    z.  zhu , a.j .",
    "ochoa , s.  schnabel , f.  hamze , h.g .",
    "katzgraber , phys .",
    "a * 93 * , 012317 ( 2016 )    a.  perdomo - ortiz , b.  ogorman , j.  fluegemann , r.  biswas , v.n .",
    "smelyanskiy , sci . rep .",
    "* 6 * ( 2016 ) . :",
    "10.1038/srep18628    s.  boixo , v.n .",
    "smelyanskiy , a.  shabani , s.v .",
    "isakov , m.  dykman , v.s .",
    "denchev , m.h .",
    "amin , a.y .",
    "smirnov , m.  mohseni , h.  neven , nat . commun .",
    "* 7 * ( 2016 ) . :",
    "10.1038/ncomms10327    t.  lanting , a.j .",
    "przybysz , a.y .",
    "smirnov , f.m .",
    "spedalieri , m.h .",
    "amin , a.j .",
    "berkley , r.  harris , f.  altomare , s.  boixo , p.  bunyk , n.  dickson , c.  enderud , j.p .",
    "hilton , e.  hoskinson , m.w .",
    "johnson , e.  ladizinsky , n.  ladizinsky , r.  neufeld , t.  oh , i.  perminov , c.  rich , m.c .",
    "thom , e.  tolkacheva , s.  uchaikin , a.b .",
    "wilson , g.  rose , phys .",
    "x * 4 * , 021041 ( 2014 )    j.  cai , w.g .",
    "macready , a.  roy , arxiv preprint arxiv:1406.2741 ( 2014 )    v.  choi , quantum .",
    "inf . process .",
    "* 10 * , 343 ( 2011 )    s.  mandr , z.  zhu , w.  wang , a.  perdomo - ortiz , h.g .",
    "katzgraber , arxiv preprint arxiv:1604.01746 ( 2016 )    e.g. rieffel , d.  venturelli , b.  ogorman , m.b .",
    "prystay , v.n .",
    "smelyanskiy , quantum .",
    "inf . process .",
    "* 14 * , 1 ( 2015 )    d.  venturelli , d.j.j .",
    "marchand , g.  rojo , arxiv preprint arxiv:1506.08479 ( 2015 )    g.  rosenberg , p.  haghnegahdar , p.  goddard , p.  carr , j.  wu , m.  de  prado , ieee journal of selected topics in signal processing * 10 * , 1053 ( 2016 )    k.m .",
    "zick , o.  shehab , m.  french , sci .",
    "* 5 * ( 2015 ) . :",
    "10.1038/srep11168    v.  choi , quantum .",
    "inf . process .",
    "* 7 * , 193 ( 2008 )    d.  baum , a point - based algorithm for multiple 3d surface alignment of drug - sized molecules . ph.d .",
    "thesis , free university of berlin ( 2007 )    f.n .",
    "abu - khzam , n.f .",
    "samatova , m.a .",
    "rizk , m.a .",
    "langston , in _ ieee / acs international conference on computer systems and applications _ ( 2007 ) , pp .",
    "367373    b.  balasundaram , f.  mahdavi  pajouh , in _ handbook of combinatorial optimization _ , ed . by p.m. pardalos ,",
    "graham ( springer new york , 2013 ) , pp .",
    "15591598    b.  balasundaram , s.  butenko , i.v .",
    "hicks , oper .",
    "59 * , 133 ( 2011 )    m.r .",
    "garey , d.s .",
    "johnson , _ computers and intractability : a guide to the theory of np - completeness _",
    "( w. h. freeman and company , new york , 1979 )    r.g .",
    "downey , m.r .",
    "fellows , theor .",
    "sci * 141 * , 109 ( 1995 )    m.  hernandez , a.  zaribafiyan , m.  aramon , m.  naghibi , arxiv preprint arxiv:1601.06693 ( 2016 )    e.  boros , a.  gruber , in _ international symposium on artificial intelligence and mathematics _ ( 2012 )    k.l .",
    "pudenz , t.  albash , d.a .",
    "lidar , nat . commun . * 5 * ( 2014 ) .",
    ": 10.1038/ncomms4243    z.  bian , f.  chudak , r.  israel , b.  lackey , w.g .",
    "macready , a.  roy , arxiv preprint arxiv:1603.03111 ( 2016 )    t.  boothby , a.d .",
    "king , a.  roy , quantum .",
    "process * 15 * , 495 ( 2016 )    a.d .",
    "king , c.c .",
    "mcgeoch , arxiv preprint arxiv:1410.2628 ( 2014 )    a.  perdomo - ortiz , j.  fluegemann , r.  biswas , v.n .",
    "smelyanskiy , arxiv preprint arxiv:1503.01083 ( 2015 )    f.  hamze , n.d .",
    "freitas , in _ proceedings of the 20th conference on uncertainty in artificial intelligence _ ( 2004 ) , pp .",
    "243250    a.  selby , arxiv preprint arxiv:1409.3934 ( 2014 )    c.  xu , f.  cheng , l.  chen , z.  du , w.  li , g.  liu , p.w .",
    "lee , y.  tang , j. chem .",
    "model . * 52 * , 2840 ( 2012 )    s.  boixo , t.f .",
    "ronnow , s.v .",
    "isakov , z.  wang , d.  wecker , d.a .",
    "lidar , j.m .",
    "martinis , m.  troyer , nat .",
    "* 10 * , 218 ( 2014 )    t.f .",
    "rnnow , z.  wang , j.  job , s.  boixo , s.v .",
    "isakov , d.  wecker , j.m .",
    "martinis , d.a .",
    "lidar , m.  troyer , science * 345 * , 420 ( 2014 )    m.h .",
    "amin , phys .",
    "a * 92 * , 052323 ( 2015 )    b.s .",
    "clarke , a.r .",
    "barron , j. stat . plan .",
    "inference * 41 * , 37 ( 1994 )    m.e.j .",
    "newman , s.h .",
    "strogatz , d.j .",
    "watts , phys .",
    "e. * 64 * , 026118 ( 2001 )    d.s .",
    "callaway , m.e.j .",
    "newman , s.h .",
    "strogatz , d.j .",
    "watts , phys .",
    "rev . lett . * 85 * , 5468 ( 2000 )",
    "as mentioned in section [ subsubsec : parameter_setting ] , we generalize the approach presented by choi @xcite to theoretically set the parameters of the embedded graph , in which the connected subgraphs representing the logical qubits are not necessarily subtrees of the hardware graph .",
    "the procedure used in this paper is explained in algorithm [ parameter ] .",
    "it is worth mentioning that we do not discuss the proof for the validity of the theoretical approach .",
    "the key idea as presented by choi @xcite is to ensure that the ground state of the input graph before and after embedding matches .",
    "let us consider a conflict graph @xmath120 with logical local fields and couplings denoted by @xmath62 and @xmath63 , respectively .",
    "assume that logical qubit @xmath121 is represented by @xmath122 physical qubits forming the physical subgraph @xmath123 .",
    "further assume that @xmath124 is the set of neighbouring vertices of the logical qubit @xmath23 in the logical graph @xmath36 and @xmath125 is the set of neighbouring vertices of the physical qubit @xmath126 , @xmath127 , excluding the vertices representing the same logical qubit .",
    "the theoretical approach detailed below has an iterative pre - processing step in which several logical qubits might be removed from the logical graph , since their optimal values can be inferred in advance .",
    "the parameters are then set on the reduced logical graph .",
    "find the scaling factor to bring the distributed @xmath128 to the range specified by the user ( we use the range @xmath129 for both @xmath62 and @xmath63 in this paper ) multiply the distributed @xmath130 by the scaling factor set all ferromagnetic coupler values ( @xmath61 ) to @xmath70      since the quantum annealer is a stochastic solver , we consider the successive annealing runs as a sequence of binary experiments that might succeed in returning the ground state with some probability .",
    "let us formally define @xmath131 as a sequence of random independent outcomes of @xmath132 annealing runs , where @xmath133 denotes the probability of observing the ground state at the @xmath23-th anneal .",
    "defining @xmath134 as the number of successes observed in @xmath132 anneals ( @xmath135 ) , we have @xmath136 ( @xmath137 ) .",
    "that is , @xmath138 has a binomial distribution with parameters @xmath132 and @xmath139 .",
    "the @xmath80 then equals @xmath132 such that @xmath140 .",
    "it is easy to verify that @xmath141 .",
    "since the probability of success @xmath139 is unknown , the challenge is to estimate @xmath139 .",
    "we follow the bayesian inference technique to estimate the probability of success for each instance @xmath23 @xcite . in the bayesian inference framework , we start with a guess on the distribution of @xmath139 known as prior and update it based on the observations from the device in order to get the posterior . since the observations from the device have a binomial distribution ,",
    "the proper choice of prior is a beta distribution which is the conjugate prior of the binomial distribution .",
    "this choice guarantees that the posterior also has a beta distribution .",
    "the beta distribution with parameters @xmath142 and @xmath143 ( the jeffery prior ) is chosen as prior since it is invariant under reparameterization of the space and it learns the most from the data @xcite .    updating the jeffery prior based on the data from the device , the posterior distribution denoted by @xmath144 is then @xmath145 where @xmath146 is the number of calls to the quantum annealer , @xmath147 is the number of anneals in each call , and @xmath148 is the number of times that the ground state of instance @xmath23 is observed at the @xmath149-th call .    to estimate the tts ( or @xmath150 ) for the entire population of instances with similar parameters , let us assume that there are @xmath151 instances with similar properties , for example , with the same number of variables .",
    "we are interested in using the data on these @xmath151 instances to estimate the tts for the entire population of instances with the same number of variables . after finding the posterior distribution @xmath144 for all instances in set @xmath152",
    ", we use the bootstrap methodology to estimate the distribution of the @xmath153-th percentile of the tts .",
    "the procedure is described in algorithm  [ tts ] .",
    "fix the number of bootstrap re - samples @xmath154 ( we set it at @xmath56 ) consider the empirical distribution of @xmath155 as an approximation of the true @xmath156 distribution ( we have plotted the mean and the standard deviation of this empirical distribution in figure [ fig : tts_main ] )      the qubo graphs of molecular similarity problem instances can be considered random graphs .",
    "a random graph is a collection of vertices with edges connecting pairs of them randomly .",
    "newman et al .",
    "@xcite and callaway et al .",
    "@xcite developed an approach based on generating functions to determine the statistical properties of random graphs with arbitrary degree distribution .",
    "here we review their approach to determine the percolation threshold .",
    "let us denote the probability that a randomly chosen vertex has degree @xmath1 by @xmath157 .",
    "let us further define @xmath158 where @xmath159 and @xmath160 are the generating functions for the probability distribution of vertex degrees and outgoing edges , respectively , and @xmath161 is the average vertex degree .",
    "callaway et al .",
    "@xcite have shown that the percolation threshold , or critical probability , can be calculated as follows : @xmath162 the details of the derivation can be found in @xcite .",
    "the key idea is that the critical probability is the point at which the mean cluster size goes to infinity .",
    "the context in which we apply this criterion is on random graphs whose degree distribution is known .",
    "it is known because the degree distribution can be measured directly @xcite .",
    "below , we provide an example with a known degree distribution for which we calculate the critical probability .",
    "* example  * consider a graph similarity problem instance with 18 vertices and @xmath94 $ ] .",
    "the number of vertices with degree 11 , 12 , and 13 are , in respective terms , 8 , 8 , and 2 .",
    "the distribution of vertex degrees can be generated by @xmath163 applying the formula above , the critical probability is @xmath164 ."
  ],
  "abstract_text": [
    "<S> quantum annealing is a promising technique which leverages quantum mechanics to solve hard optimization problems . </S>",
    "<S> considerable progress has been made in the development of a physical quantum annealer , motivating the study of methods to enhance the efficiency of such a solver . in this work , we present a quantum annealing approach to measure similarity among molecular structures . </S>",
    "<S> implementing real - world problems on a quantum annealer is challenging due to hardware limitations such as sparse connectivity , intrinsic control error , and limited precision . in order to overcome the limited connectivity , </S>",
    "<S> a problem must be reformulated using minor - embedding techniques . using a real data set , </S>",
    "<S> we investigate the performance of a quantum annealer in solving the molecular similarity problem . </S>",
    "<S> we provide experimental evidence that common practices for embedding can be replaced by new alternatives which mitigate some of the hardware limitations and enhance its performance . </S>",
    "<S> common practices for embedding include minimizing either the number of qubits or the chain length , and determining the strength of ferromagnetic couplers empirically . </S>",
    "<S> we show that current criteria for selecting an embedding do not improve the hardware s performance for the molecular similarity problem . </S>",
    "<S> furthermore , we use a theoretical approach to determine the strength of ferromagnetic couplers . </S>",
    "<S> such an approach removes the computational burden of the current empirical approaches , and also results in hardware solutions that can benefit from simple local classical improvement . </S>",
    "<S> although our results are limited to the problems considered here , they can be generalized to guide future benchmarking studies .    </S>",
    "<S> this research was supported by 1qbit . </S>",
    "<S> the authors would like to thank clemens adolphs , hamed karimi , anna levit , dominic marchand , and arman zaribafiyan for useful discussions , robyn foerster for valuable support , and marko bucyk for editorial help . </S>",
    "<S> we thank helmut katzgraber for reviewing the manuscript . </S>",
    "<S> we also acknowledge the support of the universities space research association ( usra ) quantum artificial intelligence laboratory research opportunity program . </S>"
  ]
}