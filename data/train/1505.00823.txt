{
  "article_text": [
    "throughout this paper , @xmath0 is always a coprime pair of positive integers , unless specified otherwise .",
    "rational @xmath0-dyck paths are lattice paths in the @xmath1 rectangle that never go below the diagonal line @xmath14 .",
    "denote by @xmath15 the set of such paths .",
    "many works have been done on rational dyck paths , we are particularly interested with the sweep map @xmath16 that we are going to define .    an @xmath0-dyck path @xmath2 is encoded as a @xmath17 ( stand for going  north \" and  east \" respectively ) sequence @xmath18 of @xmath12 @xmath19 s and @xmath11 @xmath9 s . each @xmath20 is associated with a rank @xmath21 that is recursively defined by @xmath22 , and for @xmath23 , @xmath24 if @xmath25 and @xmath26 if @xmath27 .",
    "then the sweep map @xmath3 is obtained by sorting the @xmath20 s according to their ranks increasingly .",
    "it is true but not obvious that @xmath3 is still in @xmath15 .",
    "see @xcite for a proof .",
    "[ exa - d - rd ] let @xmath28 .",
    "a dyck path @xmath2 and the associated rank are displayed below as a two line array .",
    "\\left [ \\begin { array}{cccccccccccccccc } u & d & u & d & d & u & d & d & d & u & d&u   & d & d & d&d \\\\0 & 11 & 6 & 17 & 12 & 7 & 18 & 13 & 8 & 3 & 14&9 & 20 & 15 & 10&5\\end { array }   \\right].\\ ] ] sorting the above two line array according to the second row gives @xmath30= \\left [ \\begin { array}{cccccccccccccccc } u&u&d&u&u&d & u&d&d&d&d&d&d&d & d & d \\\\0 & 3 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13&14 & 15 & 17 & 18&20\\end { array }   \\right].\\ ] ] then the top row is @xmath3 .",
    "sweep map has become an active subject in the recent 15 years .",
    "variations and extensions have been found , and some classical bijections turn out to be disguised sweep map .",
    "it first appears as the @xmath31 map on standard dyck paths in haiman s study of diagonal harmonics and @xmath32-catalan numbers @xcite .",
    "haglund @xcite discovered the @xmath33 statistic for @xmath32-catalan numbers , and haiman come up with the @xmath34 statistic .",
    "only @xmath35 has a simple description : it is the number of lattice squares to the right of @xmath2 and to the left of the diagonal .",
    "sweep map provides a unified framework for the complex combinatorial structure related to @xmath32-catalan numbers , because it takes the statistic @xmath36 to @xmath37 to @xmath38 .",
    "however a simple description of @xmath38 is only known in the fuss case @xmath7 by loehr @xcite .",
    "see @xcite for a detailed history .",
    "one major open problem is the invertibility of the sweep map .",
    "see ( * ? ? ?",
    "* conjecture 3,3 ) for an extended version .",
    "the sweep map @xmath6 is a bijective transformation on @xmath15 .",
    "the conjecture has only been proved for the fuss cases in @xcite and @xcite .",
    "[ t - fuss ] the sweep map @xmath6 is a bijection in the fuss case @xmath7 .",
    "the known inverse bijections for the fuss case are by no means simple .",
    "they rely on the @xmath38 statistic .",
    "the major contribution of this paper is the reciphi algorithm , which is an efficient search algorithm for inverting the @xmath6 map . roughly speaking , given @xmath8 , by searching through a @xmath9-array tree of certain depth",
    ", we can output all @xmath2 such that @xmath10 , where @xmath9 is the remainder of @xmath11 when divided by @xmath12 .",
    "in particular , we show that @xmath6 is invertible for the fuss case by giving a simple recursive algorithm fussiphi .",
    "the discovery of the reciphi algorithm relies on theorems [ t - rank - set ] and [ t - en - sequence ] , which state that deciphering @xmath2 for given @xmath39 is equivalent to deciphering either the rank sequence @xmath40 , or the en - sequence @xmath41 , where @xmath42 is the transpose of @xmath2 .",
    "theorem [ t - en - sequence ] was discovered a bit earlier by ceballos - denton - hanusa in @xcite .",
    "indeed , their paper overlaps a lot of the author s work : sections 5,6 , and 9 overlaps this draft , and section 4 overlaps an earlier draft of the author @xcite on @xmath0-cores , which is in bijection with @xmath0-dyck paths by anderson s map @xcite .",
    "thus it is necessary to explain what is new in this paper .",
    "the paper is organized as follows .",
    "section 1 is this introduction .",
    "section [ sec : notation ] introduces some basic notations and establishes proposition [ p - rank - set ] , which gives the fundamental characterization of the rank sets of @xmath0-dyck paths .",
    "this allows rank sets to play a leading role in our development .",
    "note that rank also appear as level ( see , e.g. , @xcite and @xcite ) , but was never used as the basic tool for inverting the @xmath6 map .",
    "section [ sec : two ] includes theorems [ t - rank - set ] and [ t - en - sequence ] on inverting the @xmath6 map using rank sets and en - sequences .",
    "the former seems new while the latter was known by ceballos - denton - hanusa as we have explained .",
    "combining the two theorems allows us to extract some partial information that are essential to sharply narrow down the search in the reciphi algorithm .",
    "section [ sec : left ] introduces the left and right operations on rank sequences .",
    "ceballos - denton - hanusa also found these operations in @xcite and used them to invert the @xmath6 map .",
    "they were only able to search for @xmath43 through a much larger tree .",
    "in lemma [ l - rec - left ] we give more explicit formulas than that in @xcite for the sw - sequences and rank sequences under left operations .",
    "section [ sec : reciphi ] includes two algorithms : the fussiphi algorithm for inverting the @xmath6 map in the fuss case , and the reciphi algorithm for inverting the @xmath6 map by searching .",
    "a path @xmath44 is a @xmath17-sequence depicted in the plane as a sequence of lattice points @xmath45 such that @xmath46 and @xmath47 equals @xmath48 if @xmath49 and @xmath50 if @xmath51 . a @xmath19 step will also appears as an @xmath52 or @xmath53 , standing for south or north end ; similarly a @xmath9 step will appear as an @xmath54 or @xmath55 , standing for east or west end .",
    "we denote by @xmath56 the set of all ( free ) paths from @xmath57 to @xmath0 .",
    "thus @xmath58 consists of @xmath12 up steps and @xmath11 down steps .",
    "an @xmath0-dyck path @xmath2 is a path in @xmath56 that never goes below the diagonal line @xmath59 .",
    "we denote by @xmath15 the set of all @xmath0-dyck paths .",
    "we define the rank of a lattice point @xmath4 by @xmath60 .",
    "then all the lattice points @xmath61 in the @xmath11 by @xmath12 rectangle are in bijection with their ranks except for @xmath62 .",
    "thus we can encode a path @xmath63 by its rank set @xmath64 of @xmath65 distinct ranks .",
    "we call the sequence @xmath66 the rank walk of @xmath67 . denote by @xmath68 and @xmath69 the set of rank sets of @xmath0-paths and @xmath0-dyck paths , respectively . the rank set of @xmath0-dyck paths",
    "has only nonnegative ranks .",
    "the following result completely characterizes elements of @xmath70 .",
    "[ p - rank - set ] suppose @xmath0 is a coprime pair .",
    "let @xmath71 be a set of ranks with @xmath72 .",
    "then the following statements are equivalent .",
    "1 .   @xmath73 , i.e. , @xmath74 is the rank set of an @xmath0-path @xmath67 .",
    "if @xmath75 belongs to @xmath76 then at least one of @xmath77 and @xmath78 belongs to @xmath74 .",
    "3 .   if @xmath79 then exactly one of @xmath77 and @xmath78 belongs to @xmath74 .",
    "if @xmath75 belongs to @xmath76 then at least one of @xmath80 and @xmath81 belongs to @xmath74 .",
    "if @xmath79 then exactly one of @xmath80 and @xmath81 belongs to @xmath74 .",
    "statement ( 1 ) clearly implies statement @xmath82 for @xmath83 .",
    "we prove the converse implication by constructing a walk @xmath84 on @xmath74 starting with @xmath85 , and simultaneously obtain the path @xmath67 with @xmath86 .",
    "we only consider the @xmath87 case , the others are similar . for @xmath88 , set @xmath89 if it belongs to @xmath74 , and set @xmath25 ; otherwise set @xmath90 , which must belongs to @xmath74 by condition 2 or 3 , and set @xmath27 .",
    "since we are walking in the finite set @xmath74 , we must have @xmath91 for some @xmath92 .",
    "assume that we walk from @xmath93 to @xmath94 by @xmath95 @xmath19 steps and @xmath96 @xmath9 steps .",
    "then @xmath97 .",
    "the coprimality of @xmath11 and @xmath12 forces @xmath98 for some @xmath99 .",
    "then the natural bound @xmath100 implies that @xmath101 and @xmath102 .",
    "hence we obtain a closed walk of length @xmath65 from @xmath85 to @xmath103 .",
    "consequently , @xmath104 is the desired path with @xmath86 .    to see that we can not have both @xmath77 and @xmath78 belongs to @xmath74 ,",
    "suppose the walk from @xmath78 to @xmath77 takes @xmath95 @xmath19 steps and @xmath96 @xmath9 steps with @xmath105 .",
    "then @xmath106 , i.e. , @xmath107 .",
    "this implies that @xmath108 and @xmath109 for some @xmath99 , which is clearly impossible .",
    "a direct consequence of proposition [ p - rank - set ] is the following .",
    "let @xmath74 be a rank set .",
    "then i ) @xmath110 if and only if @xmath111 ; ii ) @xmath110 if and only if the rank complement @xmath112 is in @xmath69 .",
    "we use @xmath113 to indicate that we switch the roles of @xmath11 and @xmath12 , i.e , , @xmath114 is a rank set in @xmath115 .",
    "this corresponds to the transpose of dyck paths .",
    "see @xcite for geometric meaning of rank complement .    from now on , we shall identify a dyck path @xmath2 with its rank set @xmath116 .",
    "so a dyck path @xmath74 means the dyck path @xmath2 with rank set @xmath117 , and a rank set @xmath2 means @xmath118 .",
    "the reason for making this convention is that many operations are easy to perform on rank sets .",
    "denote by @xmath119 the set of south ends of @xmath2 , i.e , starting points of a @xmath19 step of @xmath2 . in our convention , @xmath119 is identified with @xmath120 , which is the set of the ranks of the south ends of @xmath2 . in example",
    "[ exa - d - rd ] , @xmath121 .",
    "an easy exercise is @xmath122 .",
    "we can similarly define @xmath123 to be the ranks of the east ends , north ends , and west ends of @xmath2 respectively .",
    "we have the following equalities : @xmath124 where @xmath125 means disjoint union .",
    "equations in follow from the fact that each node of @xmath2 is either a south end or a west end , and similarly is either an east end or a north end .",
    "note that @xmath126 is a south end as the node @xmath57 and an east end as the node @xmath0 .",
    "denote the sorted increasing sequence of @xmath116 by @xmath127 the sw - sequence of @xmath2 is defined by @xmath128 where @xmath129 is @xmath52 if @xmath130 and is @xmath55 if @xmath131 .",
    "then the sweep map @xmath3 is just @xmath132 .",
    "we use the notation @xmath8 for @xmath133 .",
    "similarly , the en - sequence of @xmath2 is defined by @xmath134 where @xmath135 is @xmath54 if @xmath136 and is @xmath53 if @xmath137 .",
    "see figure [ fig : dyckpath ] .",
    "@xmath138    the sw - sequence and en - sequence are closely related by @xmath139 , since transpose keeps the rank set , but takes south ends to east ends , and west ends to north ends .",
    "a nicer description is the following .",
    "[ l - chi ] for @xmath110 , we have @xmath140    let @xmath141 and @xmath142 .",
    "then @xmath143 since rank complement takes south ends to north ends , and west ends to east ends , and vice vasa , the lemma follows .",
    "for an sw - sequence @xmath144 , it is convenient to label , from left to right , the @xmath145-th @xmath52 by @xmath146 for @xmath147 and the @xmath148-th @xmath55 by @xmath149 for @xmath150 .",
    "the rank @xmath151 refers to the @xmath145-th largest element in @xmath152 . in formula",
    ", we have @xmath153 , where @xmath154 is the position @xmath155 of @xmath146 , i.e. , @xmath156 .",
    "similar notations apply for @xmath149 , and @xmath157 for the en - sequence .    for the dyck path in figure",
    "[ fig : dyckpath ] , we have @xmath158\\ ] ]    given an sw - sequence @xmath159 , a nonnegative rank set @xmath160 or @xmath161 is said to be compatible with @xmath144 if @xmath162 for @xmath163 and @xmath164 for @xmath165 .",
    "[ t - rank - set ] an sw - sequence @xmath159 is equal to @xmath166 for some @xmath0-dyck path @xmath2 if and only if there is a nonnegative rank set @xmath74 compatible with @xmath144 .",
    "the sufficiency is by equations and . for the necessity ,",
    "if @xmath161 is compatible with @xmath144 , then each rank @xmath167 is either @xmath168 then @xmath169 or @xmath170 then @xmath171 .",
    "thus by proposition [ p - rank - set ] , @xmath172 and @xmath173 for some dyck path @xmath2 .",
    "the lemma then holds since @xmath174 .",
    "[ exa - r0 ] the rank set @xmath175 corresponds to the unique dyck path of area @xmath126 . since @xmath176 for @xmath177 , @xmath178 , i.e. , @xmath12 @xmath52 s followed by @xmath11 @xmath55 s .",
    "conversely , if we are given @xmath179 , we can deduce that @xmath180 . now @xmath181 for all @xmath145 and they are distinct .",
    "thus @xmath182 for all @xmath145 , in particular @xmath183 is @xmath184 .",
    "it follows that @xmath185 .    for an sw - sequence @xmath186 and an en - sequence @xmath187 .",
    "define @xmath188 to be the directed graph on the vertices @xmath189 , with edges @xmath190 and @xmath191 .",
    "if @xmath188 is a directed cycle of length @xmath65 , and produces an increasing rank sequence @xmath192 by the three rules i ) @xmath193 , ii ) @xmath194 , for @xmath163 ; iii ) @xmath195 for @xmath165 , then @xmath196 is said to be compatible with @xmath144 .",
    "[ t - en - sequence ] an sw - sequence @xmath159 is equal to @xmath166 for some @xmath0-dyck path @xmath2 if and only if there is an en - sequence @xmath196 compatible with @xmath144 .",
    "the prove is similar to that of theorem [ t - rank - set ] .",
    "though either @xmath192 or @xmath196 are sufficient to invert the @xmath6 map , a better strategy is combining theorems [ t - rank - set ] and [ t - en - sequence ] .",
    "this is better illustrated by an example .",
    "[ exa - two ] let @xmath28 and @xmath144 give as follows .",
    "assume lemma [ l - position - kn ] below gives the underlined ranks .",
    "\\left [ \\begin { array}{cccccccccccccccc } s_{{1}}&s_{{2}}&w_{{1}}&s_{{3}}&s_{{4}}&w_{{2 } } & s_{{5}}&w_{{3}}&w_{{4}}&w_{{5}}&w_{{6}}&w_{{7}}&w_{{8}}&w_{{9 } } & w_{10 } & w_{11 } \\\\ \\underline{0}&3 & \\underline{5 } & \\mathbf{6 } & \\mathbf{7 } & \\mathbf{8 } & \\mathbf{9}&\\underline{10 } & 11 & 12 & 13 & 14&\\underline{15 } & 17 & 18 & 20\\end { array }   \\right],\\ ] ] since there are 4 ranks between @xmath198 and @xmath199 and @xmath192 is increasing , the boldfaced ranks can be filled in .",
    "similar reasons for the ranks between @xmath199 and @xmath200 .",
    "the rank @xmath201 implies @xmath202 , which has to be @xmath203 .",
    "finally @xmath204 , and similarly @xmath205 and @xmath206 must appear as the final three ranks .",
    "this rank sequence appears in example [ exa - d - rd ] .    in general",
    "we can deduce some partial information of the en - sequence and extract some ranks .",
    "these information are crucial for the reciphi algorithm .",
    "[ l - position - kn ] let @xmath207 be coprime to @xmath12 with @xmath208 and @xmath209 .",
    "given an sw - sequence @xmath8 , if there is a rank set @xmath74 with @xmath161 compatible with @xmath144 , then @xmath210 are in @xmath74 and @xmath211 for @xmath212 , where @xmath213 is determined by : @xmath214    suppose the sw - sequence of @xmath74 is @xmath215 . since @xmath216 , we have @xmath217 .",
    "it follows that @xmath218 and @xmath219 .",
    "the position of @xmath220 can be read from @xmath144 but the position of @xmath221 is unknown .    observe that all the ranks smaller than @xmath222 must belong to @xmath223 .",
    "assume inductively that for @xmath224 , @xmath225 has rank @xmath226 .",
    "then it is also @xmath227 and thus @xmath228 as desired .",
    "let @xmath229 .",
    "we illustrate lemma [ l - position - kn ] by the following example . @xmath230.\\ ] ] from @xmath231 we deduce that @xmath232",
    ". then we can label up to @xmath233 and have @xmath234 .",
    "it follows that @xmath235 .",
    "thus we can label up to @xmath236 and have @xmath237 . in a similar manner , we have @xmath238 , which must be @xmath239 ; and @xmath240 .",
    "[ rem - kn - pm ] observe that @xmath241 is the number of @xmath52 s up to position @xmath213 , so we need not write down the en - sequence and the position sequence . in the running example , we start with @xmath193 , @xmath242 , the next is @xmath243 , since there are two @xmath52 before @xmath220 ; the next one is @xmath244 with rank @xmath245 ; the final one is @xmath246 with rank @xmath247 .    in this example",
    ", we can actually determine the position of @xmath248 : @xmath249 , since @xmath250 and @xmath192 is increasing .",
    "indeed we have the following result , which is sufficient for inverting @xmath6 in the next section .",
    "[ t - kn - pm ] follow notations in lemma [ l - position - kn ] . if @xmath251 , then @xmath252 and @xmath253 ; if @xmath254 , where @xmath255 is allowed to be @xmath126 , then @xmath256 , and @xmath257    by lemma [ l - position - kn ] and the fact that @xmath192 is increasing , the case @xmath251 is obvious and the first part of the case @xmath254 is also obvious .",
    "now we show the second equality when @xmath254 .",
    "we have @xmath258 .",
    "there will be no difficulty if @xmath259 with rank @xmath260 is also @xmath261 , since then @xmath262 , which forces @xmath263 as desired .",
    "the situation is similar if there are several @xmath53 labels before @xmath261 .",
    "note that is independent of the number of these @xmath53 labels .",
    "claim : if @xmath264 are positions of @xmath265 in @xmath266 for some @xmath267 , then @xmath268 for @xmath269 .",
    "we prove the claim by induction on @xmath270 .",
    "the case @xmath271 is trivial .",
    "assume the claim holds for @xmath272 .",
    "then @xmath273 for @xmath274 .",
    "it follows that @xmath275 . a similar argument as in the proof of lemma [ l - position - kn ] shows that @xmath276 for @xmath277 and @xmath278 .",
    "in particular @xmath279 .    now suppose @xmath280 is followed by @xmath261 . by the claim @xmath281",
    ", we have @xmath282 . now for @xmath283 , @xmath284 implies that @xmath285 , so by proposition [ p - rank - set ] part ( 4 ) , @xmath286 .",
    "therefore @xmath287 is the smallest rank larger than @xmath65 .",
    "equation [ e - kn-1 ] then follows .",
    "for @xmath288 , we can perform two operations on @xmath74 by : @xmath289    the following result is an easy exercise .    for @xmath290 , @xmath291 and @xmath292 are both in @xmath293 .",
    "the geometric meaning of the dyck path @xmath292 is obtained by changing the highest rank point @xmath4 of @xmath2 to @xmath294 .",
    "this corresponds to removing a square from the corresponding dyck path @xmath2 , so @xmath295 repeatedly applying the @xmath296 operation to @xmath74 will finally give @xmath297 .",
    "so we can obtain by induction that @xmath298    the geometric meaning of @xmath299 is similar to @xmath300 , but work on the rank complement of @xmath2 .",
    "they are related by @xmath301 it follows that @xmath302 iterating this formula gives @xmath303    the position @xmath304 was used in @xcite .",
    "we also use @xmath305 but we find it better to use the key position defined by @xmath306 by observing that @xmath305 is between the @xmath307-th @xmath52 and the @xmath308-st @xmath52 .",
    "we have the following result .",
    "[ l - rec - left ] suppose @xmath144 is the sw - sequence of @xmath309 and @xmath310 is the sw - sequence of @xmath291 .",
    "let @xmath311 and @xmath312",
    ". then    1 .",
    "@xmath74 can be recovered from the pair @xmath313 by @xmath314 , where @xmath315 is equal to the @xmath272-st smallest element of @xmath291 .",
    "@xmath310 is obtained from @xmath144 by inserting a @xmath55 after @xmath316 , same as after @xmath317 , and then removing @xmath318 .",
    "@xmath144 is obtained from @xmath310 by removing @xmath319 and and then inserting a @xmath55 after @xmath320 .",
    "let @xmath321 , @xmath322 .",
    "by assumption , @xmath323 and @xmath324 , then @xmath325 clearly , we have @xmath326 .",
    "\\i ) @xmath192 can be reconstructed from the triple @xmath327 by the formula : @xmath328 but with @xmath329 , we have : @xmath330 and @xmath305 is the position of @xmath331 in @xmath332 .",
    "\\ii ) we discuss by cases : a ) if @xmath333 and @xmath334 then @xmath335 for some @xmath336 .",
    "it follows that @xmath337 , so that @xmath338 ; b ) if @xmath339 and @xmath340 then @xmath341 for some @xmath342 .",
    "it follows that @xmath343 , so that @xmath344 ; c ) @xmath345 since @xmath346 ; d ) @xmath347 since @xmath348 .",
    "therefore , the sw - sequence @xmath310 is obtained from @xmath144 by inserting a @xmath55 after @xmath317 , changing @xmath318 to @xmath52 , and finally removing @xmath349 .",
    "this is equivalent to the description in the lemma , since @xmath350 for @xmath351 .",
    "\\iii ) follows directly from part ii ) .",
    "[ c - phi - invert ] if for every @xmath352 , the number @xmath353 can be uniquely determined by @xmath166 , then the @xmath6 map is invertible .",
    "we prove the injectivity of @xmath6 by induction on @xmath354 .",
    "the bijectivity then follows since @xmath6 is a map from @xmath15 to itself .",
    "the base case is @xmath178 , as discussed in example [ exa - r0 ] . if there is a @xmath2 such that @xmath355 , then @xmath356 . by induction @xmath332",
    "can be constructed from @xmath310 , which can be constructed from @xmath144 and @xmath353 by lemma [ l - rec - left ] .",
    "then @xmath74 can be constructed from @xmath357 , again by lemma [ l - rec - left ] .    from the above proof",
    ", we see a possible approach for inverting the sweep map by searching all possible values of @xmath305 .",
    "the correct @xmath305 will gives rise the desired rank set @xmath74 .",
    "because we need to guess in each of the @xmath358 recursive steps , we are indeed searching ( roughly ) through an @xmath359-ary tree of depth @xmath358 . using @xmath353 is better , since there are only @xmath12 possible value of @xmath353 , corresponding to the @xmath12 @xmath52 s . searching through an @xmath12-ary tree",
    "is still not a good strategy .",
    "using lemma [ l - position - kn ] may sharply narrow down the searchs .",
    "we start by combining corollary [ c - phi - invert ] and theorem [ t - kn - pm ] to recover theorem [ t - fuss ] for the fuss case @xmath360 .",
    "indeed , we have a simple recursive algorithm as follows .    the fussiphi algorithm .",
    "input : a coprime pair @xmath0 with @xmath361 ; an sw - sequence @xmath8 .",
    "output : a rank sequence @xmath192 compatible with @xmath144 .    1 .   if @xmath362 , then output @xmath363 .",
    "2 .   find by lemma [ l - position - kn ] the position @xmath270 of @xmath12 and position @xmath305 of @xmath65 , i.e. , @xmath364 .",
    "3 .   let @xmath310 be obtained from @xmath365 by inserting a @xmath55 after @xmath317 and then removing @xmath318 .",
    "recursively construct @xmath366 .",
    "output @xmath192 using lemma [ l - rec - left ] for @xmath357 .",
    "we illustrate the fussiphi algorithm by redoing example [ exa - two ] .",
    "recall that @xmath28 .",
    "@xmath367= \\left [ \\begin { array}{cccccccccccccccc } s_{{1}}&s_{{2}}&w_{{1}}&s_{{3}}&s_{{4}}&w_{{2 } } & s_{{5}}&w_{{3}}&w_{{4}}&w_{{5}}&w_{{6}}&w_{{7}}&w_{{8}}&w_{{9 } } & w_{10 } & w_{11 } \\\\ 0 & & 5 & & & & & 10 & & & & & 15 & & & \\end { array }   \\right],\\ ] ] where the partial ranks are computed by remark [ rem - kn - pm ] .",
    "thus @xmath368 , @xmath369 , so @xmath370= \\left [ \\begin { array}{cccccccccccccccc } s_{{1}}&s_{{2}}&s_{{3}}&s_{{4}}&w_{{1 } } & s_{{5}}&w_{{2}}&w_{{3}}&w_{{4}}&w_{{5}}&w_{{6}}&w_{{7}}&w_{{8}}&w_{{9 } } & w_{10 } & w_{11 } \\\\ 0 & & & & 5 & & & & & 10 & & & & & 15 & \\end { array }   \\right].\\ ] ] similarly @xmath371 , and @xmath372 .",
    "\\left [ \\begin { array}{cccccccccccccccc } s_{{1}}&s_{{2}}&s_{{3}}&s_{{4 } } & s_{{5}}&w_{{1}}&w_{{2}}&w_{{3}}&w_{{4}}&w_{{5}}&w_{{6}}&w_{{7}}&w_{{8}}&w_{{9 } } & w_{10 } & w_{11 } \\\\ 0&1 & 2 & \\underline{3 } & 4 & 5 & 6 & 7 & 8&9 & 10 & 11 & 12 & 13&\\underline{14 } & 15\\end { array }   \\right].\\ ] ] now adding all the ranks by @xmath374 , removing @xmath65 and adding @xmath126 gives back @xmath370= \\left [ \\begin { array}{cccccccccccccccc } s_{{1}}&s_{{2}}&s_{{3}}&s_{{4}}&w_{{1 } } & s_{{5}}&w_{{2}}&w_{{3}}&w_{{4}}&w_{{5}}&w_{{6}}&w_{{7}}&w_{{8}}&w_{{9 } } & w_{10 } & w_{11 }   \\\\0 & \\underline{2 } & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10&11 & 12 & \\underline{13 } & 14 & 15&17\\end { array }   \\right].\\ ] ] now adding all the ranks by @xmath375 , removing @xmath65 and adding @xmath126 gives back @xmath376= \\left [ \\begin { array}{cccccccccccccccc } s_{{1}}&s_{{2}}&w_{{1}}&s_{{3}}&s_{{4}}&w_{{2 } } & s_{{5}}&w_{{3}}&w_{{4}}&w_{{5}}&w_{{6}}&w_{{7}}&w_{{8}}&w_{{9 } } & w_{10 } & w_{11 } \\\\0 & 3 & \\underline{5 } & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13&14 & 15 & 17 & 18&20\\end { array }   \\right].\\ ] ]    now we are ready to give :    the reciphi algorithm for @xmath377 .",
    "input : a coprime pair @xmath0 as above ; an sw - sequence @xmath8 .",
    "output : determine the existence of the rank sequence @xmath192 compatible with @xmath144 .",
    "output @xmath192 if exists .    1 .   if @xmath362 , then output @xmath363 .",
    "2 .   find by lemma [ l - position - kn ] the position @xmath270 of @xmath12 and position @xmath96 of @xmath378 , i.e. , @xmath379 .",
    "let @xmath380 , where we set @xmath381 .",
    "3 .   for each @xmath382 as a candidate of @xmath383 , define the interval @xmath384 to be @xmath385 $ ] .",
    "let @xmath386 be obtained from @xmath365 by inserting a @xmath55 after @xmath387 and then removing @xmath318 .",
    "if @xmath388 then recursively construct @xmath389 .",
    "find the position @xmath305 so that @xmath390 . if @xmath391 and @xmath392 then @xmath386 is the desired @xmath310 .",
    "output @xmath192 using lemma [ l - rec - left ] .",
    "if no @xmath192 can be found in step 3 , then there is no @xmath393 compatible with @xmath144 .",
    "assume the existence of @xmath192 .",
    "step 1 is trivial .",
    "step 2 is to determine the possible position @xmath305 of @xmath65 , i.e. , @xmath394 . since @xmath395 and @xmath192 is a strictly increasing sequence , @xmath396 , where the equality can not hold since @xmath397 .",
    "it follows that the @xmath305 must satisfy the condition @xmath398 .",
    "that is , @xmath392 for some @xmath382 .    in step 3 , for each candidate @xmath382 of @xmath383 , we try to construct @xmath192 using @xmath392 .",
    "the @xmath386 is just the @xmath310 constructed by lemma [ l - rec - left ] from @xmath399 , which are same for all @xmath392 .",
    "lemma [ l - rec - left ] also applies to give the position of @xmath400 by @xmath401 . if this @xmath400 matches the condition @xmath392 , then lemma [ l - rec - left ] says that the @xmath192 constructed from @xmath402 is compatible with @xmath144 .    in step 4 , since all candidates fail , there is no @xmath192 compatible with @xmath144 .    the complexity of the reciphi algorithm :    if @xmath355 , then the search tree has depth @xmath403 .",
    "each node has at most @xmath9 children corresponding to the choices of @xmath305 . in the worst case",
    ", we need to search a @xmath9-array tree of depth @xmath403 . in practice",
    ", the algorithm uses @xmath353 instead of @xmath305 , which may significantly reduce the number of children .",
    "the maple implementation of this algorithm is pretty fast when @xmath9 is small .",
    "examples for illustrating the reciphi algorithm is too lengthy to be presented here , so we omit it .",
    "the @xmath6 map only takes @xmath404 time , mostly for sorting .",
    "it is hard to believe that inverting it is so hard .",
    "can we find a polynomial time algorithm for inverting @xmath6 ?",
    "at least we have presented a polynomial time algorithm for the fuss cases .",
    "the author believes that the rank set should play the leading role for inverting the sweep map .",
    "the walk on the rank set @xmath74 for coprime @xmath0 is simply a closed circle of length @xmath65 .",
    "if @xmath11 and @xmath12 are not coprime , then the walk will be a eulerian tour , as described in @xcite in the study of many statistics on partitions .",
    "the eulerian tour was used to study the @xmath82-statistic , which is just the @xmath36 statistic when restricted to @xmath0-dyck paths .",
    "finding the en - sequence @xmath196 is a good strategy for inverting @xmath6 .",
    "since @xmath405 , it is natural to define the @xmath406 map on @xmath15 by @xmath407 .",
    "lemma [ l - chi ] is equivalent to saying that @xmath408 when assuming @xmath6 is invertible . since @xmath409 is an involution ,",
    "so is the @xmath406 map .",
    "indeed @xmath406 is an area preserving involution ( * ? ? ?",
    "* proposition 6.9 ) .",
    "the en - sequence for the @xmath410 case is particularly nice : removing the final @xmath55 in @xmath144 , and removing the first @xmath54 in @xmath196 , one will see the similarity of the resulting sequence . for example : if @xmath411 and @xmath412 , then the shifted sw- and en - sequence is given by @xmath413.\\ ] ] this pattern is always true",
    ". see ( * ? ? ?",
    "* theorem 7.2 ) .",
    "it is natural to hope for a similar result for the fuss case .",
    "we discovered the @xmath406 map independently , and found a desired solution for the fuss case .",
    "this will appear in an upcoming paper @xcite .",
    "the main objective of this paper is to introduce the reciphi algorithm , which seems to be the first efficient algorithm inverting the @xmath6 map .",
    "however , the algorithm does not perform well when @xmath9 is large , so different technique should be developed for large @xmath9 .",
    "a similar argument as for @xmath414 might work when @xmath415 is small .",
    "* acknowledgements : * this work was done during the author s visiting at ucsd .",
    "the author is very grateful to professor adriano garsia for inspirations and encouraging conversations .",
    "this work was partially supported by the national natural science foundation of china ( 11171231 ) ."
  ],
  "abstract_text": [
    "<S> given a coprime pair @xmath0 of positive integers , rational @xmath0-dyck paths are lattice paths in the @xmath1 rectangle that never go below the diagonal . </S>",
    "<S> the sweep map of a rational @xmath0-dyck paths @xmath2 is the rational dyck path @xmath3 obtained by sorting the steps of @xmath2 according to the ranks of their starting points , where the rank of @xmath4 is @xmath5 . </S>",
    "<S> it is conjectured to be a bijection , but to this date , @xmath6 is only known to be bijective for the fuss case ( @xmath7 ) . in this paper </S>",
    "<S> we give an efficient search algorithm for inverting the @xmath6 map . </S>",
    "<S> roughly speaking , given @xmath8 , by searching through a @xmath9-array tree of certain depth , we can output all @xmath2 such that @xmath10 , where @xmath9 is the remainder of @xmath11 when divided by @xmath12 . </S>",
    "<S> in particular , we show that @xmath6 is invertible for the fuss case by giving a simple recursive construction for @xmath13 .    </S>",
    "<S> * keywords * : rational dyck paths ; sweep map ; partitions . </S>"
  ]
}