{
  "article_text": [
    "states of finite dimensional quantum systems are described by trace one , positive semidefinite matrices called _ density matrices_. their evolution is given by completely positive trace preserving maps ( cptp ) , also called _ quantum channels_. for _ closed _ systems ,",
    "the quantum channel consists in the left and right multiplication by a unitary matrix and its hermitian conjugate respectively .",
    "quantum channels describing the evolution of a system in contact with an environment , the so  called _ open _ quantum systems , are given by more general cptp maps .",
    "the famous stinespring dilation theorem @xcite connects the mathematical definition of open system evolution quantum channels with their physical interpretation : the evolution of an open quantum system can be seen as the closed evolution of a [ system + environment ] bipartite system , followed by the discarding ( or partial tracing ) of the environment : @xmath0(u(\\rho \\otimes \\beta ) u^*).\\ ] ] hence , the quantum evolution depends on two physical relevant parameters : the global evolution operator @xmath1 and the state of the environment subsystem @xmath2 .",
    "we would like to identify the part played by the unitary interaction @xmath1 in the properties of the quantum channel @xmath3 .",
    "namely , we would like to characterize families of bipartite unitary matrices @xmath1 such that the quantum channels @xmath3 they generate have some prescribed properties , independently of the environment state @xmath2 . in this work",
    ", we answer this question for channels preserving some special sub ",
    "algebras of states / observables .",
    "different channel properties were studied under the same framework in @xcite ( see also @xcite ) .",
    "part of the initial motivation of our study originates in the characterization of quantum channels preserving a set of _ pointer _ states .",
    "these cptp maps appear in the context of quantum non demolition measurements @xcite .",
    "the following proposition is a discrete time version of ( * ? ? ?",
    "* theorem 3 ) .",
    "it is obtained through the repeated application of theorem [ thm : zero_bloc_unitary ] .",
    "[ prop : preserves - basis ] let @xmath4 be a fixed orthonormal basis of @xmath5 , and @xmath6 a bipartite unitary operator .",
    "the following statements are equivalent :    1 .",
    "there exists a set of quantum states @xmath7 which spans @xmath8 such that , for any state @xmath9 , the quantum channel @xmath10 leaves invariant the basis states @xmath11 : @xmath12 , \\qquad t_{u,\\beta}(e_ie_i^ * ) = e_ie_i^*;\\ ] ] 2",
    ".   the operator @xmath1 is block  diagonal , i.e. there exists unitary operators @xmath13 such that @xmath14    the implication ( 1)@xmath15(2 ) holds also if ( 1 ) is replaced by @xmath16 , \\qquad t_{u,\\beta}(e_ie_i^*)=e_ie_i^*.\\ ] ]    the main goal of the current paper is to obtain similar characterization of the set of bipartite unitary operators giving quantum operations which preserve some structure on the input state or observable , such as diagonal matrices , tensor products , or other block - structures .",
    "one of our main results is a characterization of quantum channels creating no coherences between states of a prescribed basis .",
    "they therefore act essentially classically .",
    "more precisely we characterize bipartite unitary matrices generating cptp maps preserving quantum states which are diagonal in the computation basis ( see theorem [ thm : diagonal - schrodinger ] for a precise statement ) :    a bipartite unitary operator @xmath1 acting on @xmath17 generates quantum channels @xmath3 which , independently of the environment state @xmath2 , leave invariant the diagonal subalgebra @xmath18 if and only if its blocks @xmath19 are partial isometries with initial and final spaces @xmath20 and @xmath21 respectively satisfying the following conditions :    * for all rows @xmath22 , the collection of final spaces @xmath23 forms an orthogonal partition of @xmath24 * for all columns @xmath25 , both collections of initial spaces @xmath26 and of final spaces @xmath27 form orthogonal partitions of @xmath24 .    in the result above , the collection of final spaces of the partial isometries @xmath28 , is required to partition the total space @xmath24 simultaneously on every row and column . in the case where each space @xmath21 is of dimension one",
    ", this is precisely the definition of _ quantum latin squares _ from @xcite .",
    "we analyze further these objects and we propose an algorithm to randomly sample such objects . we analyze numerically this algorithm ( inspired by the classical sinkhorn algorithm ) and prove the convergence of a relaxed version of it .    the paper is organized as follows . in section [ sec : channels - and - subalgebras ] we set up the problem we are studying , giving the necessary definitions . in section [ sec : partial - isometries ] we gather some useful facts about partial isometries which shall be necessary later on . the next four sections represent the core of the paper and contain the results about , respectively , diagonal , block  diagonal , tensor product , and zero algebras .",
    "the proofs for the preservation of diagonal or block diagonal algebra and tensor product algebra use incompatible techniques , we thus do not provide a characterization of bipartite unitary matrices generating quantum channels preserving direct sum of tensor product sub  algebras .",
    "section [ sec : algorithms ] contains some numerical recipes to sample from the sets of unitary operators considered in this paper .",
    "finally , the appendix contains the proof of the non  commutative sinkhorn algorithm in the case where the blocks of the matrix are invertible .    _ acknowledgments .",
    "_ i.n .  would like to thank teo banica and martin idel for inspiring discussions around sinkhorn s algorithm and its different generalizations .",
    "the authors research has been supported by the anr projects rmtqit anr-12-is01 - 0001 - 01 and stoq anr-14-ce25 - 0003 - 01 .",
    "both authors acknowledge the hospitality of the mathematical physics chair of the technische universitt mnchen , where this research was initiated .",
    "in this paper , we are interested in the structure of bipartite unitary operators @xmath6 , and of the quantum operations they generate via dilation results . to any such bipartite unitary operator and any trace one positive semidefinite matrix @xmath29 , we associate two maps : @xmath30(u^*(x \\otimes i_k)u(i_n \\otimes \\beta))\\end{aligned}\\ ] ] and @xmath31(u(x \\otimes \\beta)u^*)\\end{aligned}\\ ] ]",
    "if the matrix @xmath2 is a quantum state , i.e. @xmath32 , the map @xmath33 is unital and completely positive ( ucp ) , while the map @xmath10 is trace preserving and completely positive ( tpcp ) .",
    "moreover , a direct calculation shows that the maps above are dual with respect to the hilbert ",
    "schmidt scalar product : @xmath34 we refer the reader to ( * ? ? ? * chapter 6 ) for a mathematical introduction to cp maps , and to ( * ? ? ?",
    "* chapter 8) or @xcite for a quantum information theory perspective .",
    "our ultimate goal will be to characterize bipartite unitary operators @xmath1 with the property that _ all _ the ucp maps @xmath33 ( respectively all quantum channels @xmath10 ) preserve a @xmath35algebra @xmath36 note that the above expression is , up to a global unitary rotation , the most general form of a @xmath35subalgebra of @xmath37 , see ( * ? ? ?",
    "* theorem i.10.8 ) .",
    "the diagonal subalgebra corresponds to the case @xmath38 , @xmath39 , for @xmath40 $ ] ( for an integer @xmath41 , we write @xmath42:=\\{1 , 2 , \\ldots , n\\}$ ] ) .",
    "more precisely , we shall be interested in the sets @xmath43 of bipartite unitary operators leaving the subalgebra @xmath44 invariant in the heisenberg , respectively the schrdinger picture .",
    "we shall also be interested in comparing the sets above corresponding to two subalgebras @xmath45 .",
    "in general , we have the following inclusion diagram    [ cols=\"^,^,^ \" , ]     similar relations hold for channels in the schrdinger picture . note that the above diagram does not imply any obvious relations between the sets @xmath46 and @xmath47 ; some special cases of algebra inclusions will be investigated in sections [ sec : comparing - sum ] and [ sec : comparing - tensor ] , to show that these sets are , in general , not comparable .",
    "recall that a _ partial isometry _ between two hilbert spaces is a map such that its restriction to the orthogonal of its kernel is an isometry .",
    "more precisely , a matrix @xmath48 is a partial isometry if there exists two subspaces @xmath49 and @xmath50 , called respectively the _ initial _ and the _ final subspace _ of @xmath51 , such that    1 .   @xmath52 ; 2 .",
    "@xmath53 is an isometry .",
    "partial isometries are characterized by the relation @xmath54 ( or , equivalently , by the relation @xmath55 ) .",
    "let us remark right away that two important classes of operators , orthogonal projections and unitary operators , are partial isometries .",
    "a family of vector subspaces @xmath56 is said to form a _ partition _ of @xmath24 if    1 .   for all @xmath57 , we have @xmath58 ; 2 .   @xmath59 .",
    "[ def : bistochastic - pi ] an operator @xmath60 is called a _ matrix of partial isometries _ if its blocks @xmath61 defined by @xmath62 are partial isometries .",
    "let @xmath20 ( resp .",
    "@xmath21 ) be the initial ( resp .",
    "final ) spaces of the partial isometries @xmath63 .",
    "the matrix of partial isometries @xmath51 is said to be of _ type @xmath64 _ if , in addition , the subspaces @xmath65 satisfy the orthogonality conditions @xmath66 from the list below :    1 .   for all @xmath67 $ ] , the subspaces @xmath68}$ ] form a partition of @xmath24 ; 2 .   for all @xmath67 $ ] , the subspaces @xmath69}$ ] form a partition of @xmath24 ; 3 .   for all @xmath70 $ ] , the subspaces @xmath71}$ ] form a partition of @xmath24 ; 4 .   for all @xmath70 $ ] , the subspaces @xmath72}$ ] form a partition of @xmath24 .",
    "[ lem : unitary - and - pi ] a matrix of partial isometries is unitary iff it is of type [ it : row - final],[it : col - initial ] .",
    "let @xmath51 be a matrix of partial isometries of type [ it : row - final],[it : col - initial ] , with blocks @xmath63 .",
    "we have @xmath73 consider now a general term @xmath74 in the sum above .",
    "the map @xmath75 is also a partial isometry , having initial space @xmath76 and final space @xmath77 . since , for all @xmath78 , the spaces @xmath79}$ ] form a partition of @xmath24 , we obtain @xmath80 ( @xmath81 denotes the orthogonal projection onto some subspace @xmath82 ) .",
    "hence @xmath83 where we have used again the direct sum hypothesis for the partition @xmath84}$ ] .",
    "reciprocally , consider now a unitary operator @xmath1 and represent it by blocks ( which are partial isometries ) @xmath85 from the unitarity condition @xmath86 , we get that , for all @xmath67 $ ] , @xmath87 but a sum of selfadjoint projections is equal to the identity iff the subspaces of the projections form a partition of the total space .",
    "hence , we obtain that , for all @xmath22 , the subspaces @xmath69}$ ] form a partition of @xmath24 , which is condition [ it : row - final ] from definition [ def : bistochastic - pi ] . starting from the relation @xmath88 , a similar reasoning produces condition [ it : col - initial ] from the statement .",
    "the proofs of the upcoming sections are based on the following lemma , due to cochran @xcite .",
    "[ lem : cochran ] let @xmath89 be operators satisfying @xmath90 then , @xmath91 with equality iff the @xmath92 are partial isometries with initial spaces @xmath93 forming a partition of @xmath24 .",
    "the rank sum inequality is a consequence of the rank subadditivity and the equality @xmath94 for any matrix @xmath95 .",
    "the fact that if the @xmath92 s are partial isometries with initial spaces forming a partition of @xmath24 then @xmath96 and @xmath97 follows directly from @xmath98 and @xmath99 by the rank  nullity theorem .",
    "let us prove that @xmath96 and @xmath97 imply that the @xmath92 s are partial isometries with the initial spaces @xmath93 forming a partition of @xmath24 .    for general matrices the spaces @xmath93 are defined as the orthogonal complement of @xmath100 in @xmath24 .",
    "let @xmath49 be the direct sum of the @xmath93 s : @xmath101 .",
    "assume @xmath102 with a strict inclusion .",
    "then @xmath103 different from @xmath104 such that @xmath105 , a_i x=0 $ ] . from",
    ", it follows that @xmath106 that contradicts the condition @xmath107 thus @xmath108 .",
    "from again , we have that for every @xmath109 $ ] , @xmath110 , hence @xmath111 since @xmath112 is @xmath104 on the orthogonal of @xmath93 .",
    "it follows that @xmath113 by summing over @xmath22 .",
    "assume this last inequality is strict .",
    "from the rank inequality , @xmath114 since @xmath99 by the rank  nullity theorem . since we assumed that @xmath96 from the contradiction we obtain @xmath115 . multiplying on the left and right by a specific @xmath116 we obtain @xmath117 .",
    "since this sum is a sum of positive matrices equal to @xmath104 , all the terms must be @xmath104 .",
    "hence , the mutual orthogonality of the @xmath93 s follows .",
    "we proved that the family @xmath118}$ ] is a partition of @xmath24 .",
    "it remains to prove that the @xmath92 s are partial isometries .    from the mutual orthogonality of the @xmath93 s and the equality , for any @xmath119",
    "$ ] , @xmath120 hence the @xmath92 s are partial isometries .",
    "we prove next a more specialized version of cochran s lemma .",
    "[ lem : partial - isometries ] let @xmath89 such that @xmath121 then , the matrices @xmath92 are partial isometries with the family of initial vector spaces @xmath122 and the family of final vector spaces @xmath123 forming partitions of @xmath24 .",
    "the final vector subspaces @xmath124 are the image of @xmath24 by the respective @xmath92 : @xmath125 .",
    "the rank of @xmath92 is equal by definition to the dimension of @xmath124 . from the definition of the vector spaces",
    "@xmath124 , for any @xmath126 and @xmath127 , there exists @xmath128 such that @xmath129 and @xmath130 . from , if @xmath131 , @xmath132 it follows that the @xmath124 s are mutually orthogonal .",
    "since the @xmath124 s are mutually orthogonal , the dimension of the direct sum @xmath133 is equal to the sum of the dimensions of the @xmath124 s : @xmath134 . since @xmath50 is a vector subspace of @xmath24 , @xmath135 .",
    "the equality and then the conclusion follow from lemma [ lem : cochran ] and .",
    "we start with the most simple case , that of the diagonal subalgebra @xmath136    from a physical perspective , this case is probably the most interesting one , and it is also very illuminating from a mathematical point of view .",
    "we shall treat separately the cases of cp maps which are unital ( the heisenberg picture ) and trace preserving ( quantum channels , the schrdinger picture ) .",
    "although the results in this section are special cases of the ones in section [ sec : block - diagonal ] , we state and prove them separately , in order to showcase the different ideas and techniques involved in the proof , which are more transparent in this case .",
    "we are interested physical transformations of observables , that is in unital completely positive maps ( ucp ) .",
    "more precisely , such maps can be written as @xmath137(u^*(x \\otimes i_k)u(i_n \\otimes \\beta)),\\ ] ] where @xmath6 is a unitary operator , @xmath32 is a density matrix , and @xmath138 is the observable ( hermitian matrix ) on which the map acts .",
    "[ thm : diagonal - heisenberg ] let @xmath4 be a fixed basis of @xmath5 , @xmath18 the commutative algebra of matrices which are diagonal in the basis @xmath139 , and @xmath6 a bipartite unitary operator .",
    "the following statements are equivalent :    1 .",
    "there exists a set of quantum states @xmath7 which spans @xmath8 such that , for any state @xmath9 , the ucp map @xmath33 leaves invariant diagonal matrices : @xmath140 2 .",
    "in the basis @xmath139 , the operator @xmath1 is a matrix of partial isometries ( and thus it is of type [ it : row - final],[it : col - initial ] ) .    the easy implication , @xmath141 , is proved by direct calculation . by our assumption , the blocks of @xmath1 are partial isometries , with initial and final spaces satisfying conditions [ it : row - final],[it : col - initial ] from definition [ def : bistochastic - pi ] @xmath142    for each basis element @xmath143 , we have @xmath144(e_{j_1}e_{i_1}^ * \\otimes u_{i_1j_1}^ * \\cdot e_s e_s^ * \\otimes i_k \\cdot e_{i_2}e_{j_2}^ * \\otimes u_{i_2 j_2 } \\cdot i_n \\otimes \\beta ) \\\\ & = \\sum_{j_1,j_2 = 1}^n e_{j_1}e_{j_2}^ * \\operatorname{tr}(u_{sj_1}^ * u_{sj_2 } \\beta).\\end{aligned}\\ ] ] since the blocks @xmath145 satisfy condition [ it : row - final ] from definition [ def : bistochastic - pi ] , the operator @xmath146 is null , unless @xmath147 .",
    "hence , the output @xmath148 is a diagonal operator , proving the claim .",
    "let us now show @xmath149 .",
    "going through the computations above , without assuming anything about the blocks of @xmath1 , we see that the condition that @xmath33 preserves the diagonal implies that for all @xmath150 $ ] such that @xmath151 and for all @xmath9 , @xmath152 since @xmath7 spans the whole matrix algebra @xmath8 , we obtain @xmath153 . in turn , this implies @xmath154 for all @xmath155 $ ] such that @xmath156 . hence @xmath157 is a direct sum of orthogonal subspaces of @xmath24",
    ". in particular , @xmath158 .",
    "since @xmath1 is unitary , we moreover have , for all @xmath159 $ ] , @xmath160 . from cochran s lemma [ lem : cochran ]",
    "( with @xmath161 ) we deduce @xmath162 .",
    "hence @xmath163 and the @xmath164 s are partial isometries of type [ it : row - final ] .    again using the unitarity of @xmath1",
    ", we get @xmath165 for all @xmath119 $ ] .",
    "since the @xmath145 s are partial isometries , the previous equality reads @xmath166 for all @xmath119 $ ] .",
    "it follows that , at fixed @xmath25 , the initial spaces @xmath71}$ ] form a partition of @xmath24 , which is property [ it : col - initial ] from definition [ def : bistochastic - pi ] .",
    "we conclude that the @xmath145 s are partial isometries of type [ it : row - final],[it : col - initial ] , proving the claim .",
    "let us consider the simplest case , where @xmath167 , and the partial isometries appearing as the blocks of @xmath1 have unit rank .",
    "the @xmath168 unitary operators which satisfy the conditions of the result above are of the form @xmath169 for some vectors @xmath170 satisfying the indicated orthogonality relations ( we denote by @xmath171 a fixed unit vector which is orthogonal to @xmath172 ) . the ucp map @xmath33 acts as follows on diagonal operators : @xmath173    [ ex : id - flip ] the identity and the flip operator @xmath174 satisfy the conditions in theorem [ thm : diagonal - heisenberg ] , since @xmath175      let @xmath176 the set of diagonal @xmath177 matrices , in some basis @xmath4 of @xmath5 , which we assume fixed .    the main result of this section is the following theorem , which characterizes unitary matrices preserving , independently of the ancilla state , the diagonal subalgebra of the system space .    [ thm : diagonal - schrodinger ] let @xmath4 be a fixed basis of @xmath5 , @xmath18 the commutative algebra of matrices which are diagonal in the basis @xmath139 and @xmath6 a bipartite unitary operator .",
    "the following statements are equivalent :    1 .",
    "there exists a set of quantum states @xmath7 which spans @xmath8 such that , for any state @xmath9 , the quantum channel @xmath10 leaves invariant diagonal matrices : @xmath178",
    "2 .   in the basis @xmath139",
    ", the operator @xmath1 is a matrix of partial isometries of type [ it : row - final],[it : col - initial],[it : col - final ] .",
    "when this is the case , for all quantum states @xmath32 , the quantum channel @xmath10 acts on diagonal matrices as a markov chain with transition probabilities @xmath179}$ ] given by @xmath180 where @xmath181 is the initial space of the partial isometry corresponding to the block @xmath182 of @xmath1 .",
    "the proof follows more or less the same steps as the proof of theorem [ thm : diagonal - heisenberg ] .",
    "let us start with the easier implication ( 2 ) @xmath15 ( 1 ) .",
    "consider a basis element @xmath143 and compute @xmath183 where @xmath184 are the blocks of @xmath1 : @xmath185 since @xmath1 is of type [ it : col - initial ] , we have @xmath186 , and thus @xmath187 proving the claim .",
    "we prove now the second implication , ( 1 ) @xmath15 ( 2 ) . using equation",
    ", we obtain that @xmath188 is a diagonal element iff @xmath189 , \\qquad \\operatorname{tr}(u_{is } \\beta u_{js}^ * ) = 0.\\ ] ] since the above relation holds for a set of matrices @xmath2 which spans the full matrix algebra , we conclude that @xmath190 , \\ , \\forall i \\neq j \\in [ n ] , \\qquad u_{js}^*u_{is}=0.\\ ] ] using the unitarity condition @xmath6 , we also have @xmath191 we now apply , for every @xmath78 , lemma [ lem : partial - isometries ] to conclude that all the blocks @xmath145 of @xmath1 are partial isometries having the property that , for each column , both the initial and the final spaces of the partial isometries form a partition of @xmath24 ( these are the conditions [ it : col - initial ] and [ it : col - final ] in definition [ def : bistochastic - pi ] ) . condition [ it : row - final ] follows from lemma [ lem : unitary - and - pi ] .",
    "the condition [ it : row - initial ] from definition [ def : bistochastic - pi ] is not needed for the result above to hold , as the following example shows .",
    "consider three unit vectors @xmath192 with the property that @xmath193 , and let @xmath194 by direct calculation , one can show that @xmath1 is a unitary matrix .",
    "notice that @xmath1 is a matrix of partial isometries satisfying conditions [ it : row - final],[it : col - initial],[it : col - final ] from definition [ def : bistochastic - pi ] , but failing condition [ it : row - initial ] .",
    "moreover , for a given qubit density matrix @xmath195 , the channel @xmath10 acts on diagonal operators as follows : @xmath196 giving rise to the following markov transition matrix @xmath197 note that the matrix above has the general form of a @xmath198 stochastic matrix .",
    "if moreover [ it : row - initial ] holds , the matrix @xmath199 is bistochastic .",
    "let @xmath200 be a subalgebra of @xmath37 and @xmath201 the associated direct sum of orthogonal subspaces decomposition . in the above expression , the integers @xmath202 form a partition of @xmath41",
    ", while the subspaces @xmath203 form a partition of @xmath5 .",
    "our goal is to characterize ucp maps as in ( resp .",
    "tpcp as in ) which leave the algebra @xmath44 invariant , irrespective of the ancilla state @xmath2 .",
    "let us consider a basis @xmath204 of @xmath5 which is compatible with the decomposition , that is there exists a partition @xmath42 = \\sqcup_{a=1}^n { \\bf a}$ ] such that @xmath205 for all @xmath206 $ ] .",
    "we define an equivalence relation @xmath207 for a unique @xmath208 $ ] .",
    "we shall consider two different block decompositions of the unitary interaction matrix @xmath6 : the usual one @xmath209 with @xmath210 , and the decomposition corresponding to the coarser partition @xmath211 where @xmath212 accordingly , let @xmath213}$ ] ( resp .",
    "@xmath214}$ ] ) be the initial ( resp .",
    "final ) spaces of the matrices @xmath215 : @xmath216 and @xmath217 .      as before , we start with the heisenberg picture of ucp maps , since the statement and the proof of the main result are easier .",
    "note that the theorem below generalizes theorem [ thm : diagonal - heisenberg ] , which corresponds to the particular case @xmath218 for all @xmath206 $ ] .",
    "[ thm : block - diagonal - heisenberg ] let @xmath219 and @xmath44 the above defined subalgebra of @xmath37 .",
    "the following two statements are equivalent :    1 .",
    "there exists a set of quantum states @xmath7 which spans @xmath8 such that for any @xmath220 , the subalgebra @xmath44 is stable by the ucp map",
    "@xmath221 : @xmath222 2 .",
    "the matrices @xmath223}$ ] are partial isometries from @xmath224 to @xmath225 such that 1 .   for any @xmath226 $ ] , @xmath227 and for each @xmath228 $ ] , the family @xmath229}$ ] is a partition of @xmath24 ; 2 .   for each @xmath230 $ ]",
    ", the family @xmath231}$ ] is a partition of @xmath232    let us show @xmath149 .",
    "we initially follow the same path as for theorem [ thm : diagonal - heisenberg ] . by direct computation ,",
    "it is easy to see that the hypothesis from ( 1 ) is equivalent to @xmath233 it remains to prove the equivalence of ( 2 ) with this statement .",
    "we can reformulate in terms of matrices : @xmath234 , b\\neq c , \\forall x\\in m_{d_a}(\\mathbb c),\\quad u_{ab}^*(x\\otimes i_k ) u_{ac}=0.\\ ] ] the proof of this equivalence amounts to taking specific matrices @xmath235 and multiplying on the left and right by @xmath236 and @xmath237 respectively .",
    "we leave the details to the reader .",
    "let us prove that implies    1 .   for all @xmath208 $ ] , the family @xmath238}$ ] is a partition of @xmath239 ; 2 .   for all @xmath240 $ ] ,",
    "the family @xmath231}$ ] is a partition of @xmath241 .",
    "on the one hand , taking @xmath242 in , we deduce that for each @xmath208 $ ] and @xmath243 , @xmath244 .",
    "it follows that @xmath245 is a subspace of @xmath225 and is a direct sum of orthogonal subspaces thus @xmath246}\\dim f_{ab}\\leq d_ak$ ] .    on the other hand , since @xmath1 is unitary , @xmath247 . hence from cochran s lemma [ lem : cochran ] , @xmath248 .",
    "thus @xmath249 and the matrices @xmath250 are partial isometries with @xmath251 a partition of @xmath252 .",
    "again , since @xmath1 is unitary @xmath253 .",
    "hence @xmath231}$ ] is a partition of @xmath224 .",
    "we now show that implies a finer structure for the final spaces .",
    "let @xmath254 $ ] such that @xmath243 .",
    "let @xmath255 and @xmath256 .",
    "assuming , we have that for all @xmath257 , @xmath258 .",
    "let the families @xmath259 and @xmath260 be such that @xmath261 and @xmath262 .",
    "set @xmath257 such that in the basis @xmath263 , @xmath264 then @xmath258 implies @xmath265 hence for all @xmath266 .",
    "let @xmath267 and @xmath268 .",
    "we have @xmath269 and @xmath270 for all @xmath240 $ ] .",
    "we shall prove the converse inclusion .",
    "let @xmath271 and @xmath272 .",
    "then @xmath273 hence @xmath274 for any @xmath275 .",
    "since @xmath238}$ ] is a partition of @xmath225 , @xmath276 .",
    "hence @xmath277 and @xmath227 .",
    "since @xmath238}$ ] is a partition of @xmath225 , @xmath229}$ ] is a partition of @xmath24 .    for the converse implication @xmath141 , assume ( a ) and let us prove",
    "let @xmath278 , for some blocks @xmath279 . then @xmath280 and @xmath281 .",
    "then for any @xmath257 , @xmath282 we deduce and thus ( 1 ) .    at the level of examples , the identity and the flip operators from example [ ex : id - flip ]",
    "satisfy also the conditions in theorem [ thm : block - diagonal - heisenberg ] .",
    "we move now to the schrdinger case .",
    "since the proof follows closely what has been done in the previous sections , we only sketch the main ideas , leaving the details to the reader .",
    "[ thm : block - diagonal - schrodinger ] let @xmath219 and @xmath44 the above defined subalgebra of @xmath37 .",
    "the following two statements are equivalent :    1 .",
    "there exists a set of quantum states @xmath7 which spans @xmath8 such that for any @xmath220 , the subalgebra @xmath44 is stable by the quantum channel @xmath283 : @xmath284 2 .",
    "the matrices @xmath285}$ ] are partial isometries from @xmath224 to @xmath225 such that , 1 .   for any @xmath226 $ ] , @xmath227 and for each @xmath208 $ ] , the family @xmath229}$ ] is a partition of @xmath24 ; 2 .   for each @xmath240 $ ]",
    ", the family @xmath286}$ ] is a partition of @xmath224 ; 3 .   for each @xmath240 $ ] , the family @xmath231}$ ] is a partition of @xmath224 .    from direct computation , ( 1 )",
    "is equivalent to @xmath287 the implication @xmath288 proof is then identical to the one of theorem [ thm : block - diagonal - heisenberg ] . we thus only show the implication , @xmath149 .    in terms of matrices ,",
    "is equivalent to , @xmath289 , b\\neq c , \\forall x\\in m_{d_b\\times d_c } , \\quad u_{ba}^\\ast ( x\\otimes i_k)u_{ca}=0.\\ ] ] let us prove that ,    1 .",
    "[ it : blocs - schrodinger - final - spaces - on - second - index ] for each @xmath208 $ ] , the family @xmath238}$ ] is a partition of @xmath225 ; 2 .",
    "[ it : blocs - schrodinger - final - spaces - on - first - index ] for each @xmath240 $ ] , the family @xmath286}$ ] is a partition of @xmath224 ; 3 .",
    "[ it : blocs - schrodinger - initial - spaces - on - first - index ] for each @xmath240 $ ] , the family @xmath231}$ ] is a partition of @xmath224 .",
    "fix @xmath290 $ ] , @xmath243 such that @xmath291 .",
    "let , @xmath292 with @xmath1 a unitary @xmath293 matrix .",
    "spanning over all possible @xmath1 , equation implies @xmath294 .",
    "it follows that for every @xmath228 $ ] , @xmath295}\\operatorname{rk}(u_{ba})\\leq d_a\\,k$ ] .",
    "since @xmath296 } u_{ba}^*u_{ba}=i_{d_a}\\otimes i_k$ ] , from cochran lemma [ lem : cochran ] , @xmath296 } \\operatorname{rk}(u_{ba})\\geq k$ ] and for any @xmath226 $ ] , @xmath250 is a partial isometry such that for any @xmath208 $ ] the family @xmath297}$ ] is a partition of @xmath225 and ( [ it : blocs - schrodinger - final - spaces - on - second - index ] ) holds .    since for any @xmath240 $ ] , @xmath298 } u_{ba}u_{ba}^*=i_{d_b}\\otimes i_k$ ] and for any @xmath208 $ ] , @xmath296 } u_{ba}^*u_{ba}=i_{d_a}\\otimes i_k$ ] , the fact that the matrices @xmath250 are partial isometries implies ( [ it : blocs - schrodinger - final - spaces - on - first - index ] ) and ( [ it : blocs - schrodinger - initial - spaces - on - first - index ] ) hold .",
    "we now show that implies a finer structure for the final spaces .",
    "let @xmath254 $ ] such that @xmath243 .",
    "let @xmath299 and @xmath300 .",
    "assuming , we have that for all @xmath301 , @xmath258 .",
    "let the families @xmath302 and @xmath303 be such that @xmath304 and @xmath305 .",
    "set @xmath301 such that in the orthonormal bases @xmath306 and @xmath307 of respectively @xmath308 and @xmath309 , @xmath264 then @xmath258 implies @xmath310 hence for all @xmath311 .",
    "let @xmath312 and @xmath313 .",
    "we have @xmath314 and @xmath315 for all @xmath240 $ ] .",
    "we shall prove the converse inclusion .",
    "let @xmath316 and @xmath317 .",
    "then @xmath318 hence @xmath319 for any @xmath275 . since @xmath297}$ ] is a partition of @xmath225 , @xmath320 .",
    "hence @xmath321 and @xmath322 . since @xmath323}$ ] is a partition of @xmath224 , @xmath324}$ ]",
    "is a partition of @xmath24 .      in this section",
    ", we would like to investigate the relation between the sets @xmath325 for the subalgebras @xmath326 with the property that @xmath327 , focusing on the heisenberg picture .",
    "note that the two trivial extremal cases , @xmath328 and @xmath329 lead both to the set of all unitary operators .",
    "in a situation where both algebras are non - trivial , we claim that the two sets of unitary operators leaving them invariant are not comparable .",
    "we shall consider the simplest example , and leave the extension to the general case to the reader .",
    "let @xmath330 and consider @xmath331    to show that @xmath332 , consider the following operator @xmath333    obviously , the operator @xmath1 above satisfies the conditions [ it : row - final ] , [ it : col - initial ] from definition [ def : bistochastic - pi ] , so @xmath334 .",
    "however , for the equivalence relation @xmath335 induced by the subalgebra @xmath336 , and the choice of indices @xmath337 , equation from the proof of theorem [ thm : block - diagonal - heisenberg ] is not satisfied : @xmath338 hence @xmath339 .    to show that the reversed inclusion also fails to hold , consider a unitary matrix @xmath340 partitioned in @xmath198 blocks @xmath341 : @xmath342 we construct the following unitary matrix @xmath343 : @xmath344    one can check by direct computation that @xmath345 .",
    "however if one chooses @xmath346 in such a way that one of the blocks @xmath341 is _ not _ a partial isometry , then @xmath347 .",
    "this is always possible , since one can simply choose any small enough matrix @xmath348 and complete it to a full unitary matrix @xmath340 .",
    "we now analyze the case where there is just one term in the direct sum in , that is @xmath349 in particular , the system hilbert space decomposes as @xmath350 , with @xmath351 .",
    "we shall denote by @xmath352 the ( un - normalized ) _ maximally entangled state _",
    "@xmath353 for some fixed orthonormal basis @xmath354 of @xmath24 .",
    "[ thm : tensor - product - h ] let @xmath6 be a bipartite unitary operator .",
    "the following are equivalent :    1 .",
    "[ it : tensor - product - h - i ] there exists a set of quantum states @xmath7 which spans @xmath8 such that for any @xmath220 , the subalgebra @xmath44 is stable by the ucp map",
    "@xmath221 : @xmath222 2 .   [",
    "it : tensor - product - h - ii ] there exist unitary operators @xmath355 and @xmath356 such that @xmath357    we first show @xmath358 . for an interaction unitary operator @xmath1 as in",
    ", we have @xmath359 \\\\   & = ( \\operatorname{id}_d \\otimes \\operatorname{id}_r \\otimes \\operatorname{tr}_k ) \\left [ ( w^ * \\otimes i_r )    ( x \\otimes i_r \\otimes i_k )   ( w \\otimes i_r ) ( i_{dr } \\otimes \\beta ) \\right ] \\\\    & = ( \\operatorname{id}_d   \\otimes \\operatorname{tr}_k ) \\left [ w^ *    ( x   \\otimes i_k )   w ( i_{d } \\otimes \\beta ) \\right ] \\otimes i_r \\\\ & = s_{w,\\beta}(x ) \\otimes i_r \\in \\mathcal a,\\end{aligned}\\ ] ] proving the claim ; a graphical representation of the computation above can be found in figure [ fig : u - tensor - product - h ] .    -preserving ucp maps .",
    "round , diamond , and respectively square decorations correspond to the hilbert spaces @xmath360 , @xmath361 , and respectively @xmath24.,title=\"fig : \" ] + -preserving ucp maps .",
    "round , diamond , and respectively square decorations correspond to the hilbert spaces @xmath360 , @xmath361 , and respectively @xmath24.,title=\"fig : \" ]    for the reverse implication , using linearity and the hypothesis , we find that there is a bi - linear function @xmath362 such that @xmath363 we rewrite the last equation as @xmath364 = f_u(x , \\beta ) \\otimes i_r,\\ ] ] where @xmath365 is the partial transpose of the unitary operator @xmath1 with respect to the @xmath24 tensor factor : @xmath366 . from the universal property of the tensor product @xmath367",
    ", we find that there exists a linear function @xmath368 such that @xmath364 = g_u(x \\otimes \\beta^\\top ) \\otimes i_r.\\ ] ] moreover , since the left hand side above is a completely positive function of the input @xmath369 , the same must hold for @xmath370 . hence , from the kraus form of cp maps , we can find , for some @xmath371 , a linear operator @xmath372 such that @xmath373 $ ] ; note that we have dropped the transposition operation on @xmath2 , using the fact that a family @xmath7 spans @xmath8 iff @xmath374 does .",
    "we have thus , for all @xmath375 and @xmath2 , @xmath376 = ( \\operatorname{id}_d \\otimes \\operatorname{id}_r \\otimes \\operatorname{tr}_s ) \\left [ a^ *   ( x \\otimes i_r \\otimes \\beta ) a \\right],\\ ] ] where we recognize two different dilations of a cp map . on the level of the choi matrices",
    ", the equality above translates to @xmath377 = \\\\",
    "( \\operatorname{id}_d \\otimes \\operatorname{id}_d \\otimes \\operatorname{tr}_s \\otimes \\operatorname{id}_k ) \\left[(i_d \\otimes a^ * \\otimes i_k ) ( \\omega_d\\omega_d^ * \\otimes \\omega_k\\omega_k^ * ) ( i_d \\otimes a \\otimes i_k )   \\right ] \\otimes i_r \\iff \\\\ ( i_d \\otimes u^ * ) ( \\omega_d\\omega_d^ * \\otimes i_r",
    "\\otimes i_k ) ( i_d \\otimes u ) = \\left[(i_d \\otimes ( a^\\gamma)^ * ) ( \\omega_d\\omega_d^ * \\otimes i_s ) ( i_d \\otimes a^\\gamma ) \\right]\\otimes i_r,\\end{aligned}\\ ] ] where @xmath378 is the partial transposition of the operator @xmath379 with respect to the second subsystems .",
    "the two square roots of the last equation above are related by a partial isometry @xmath380 as follows @xmath381 \\iff u = ( i_d \\otimes v)(a^\\gamma \\otimes i_r).\\end{aligned}\\ ] ] let us set @xmath382 . since @xmath1 is an unitary operator , we have @xmath383 and thus @xmath384 must have full rank , i.e.  @xmath82 is an isometry ; in particular , @xmath385 .",
    "but then , @xmath386 , hence @xmath346 is also an isometry , implying @xmath387 .",
    "we have thus @xmath388 , and @xmath389 are unitary operators , as claimed .",
    "let us consider some special cases of the result above . in the @xmath390 or @xmath391 case",
    ", requiring that the algebra @xmath44 should be preserved does not impose additional constraints , so we recover the set of all unitary matrices @xmath392 . if @xmath393 , the ancilla space is trivial , and the ucp map acts by unitary conjugation .",
    "it is clear then that the unitary operator @xmath1 must be a tensor product , @xmath394 , with @xmath395 and @xmath396 .      before stating our main result",
    ", we introduce the set of bipartite unitary operators with the property that their partial transpose is also unitary @xmath397    this set has been studied in @xcite , and we refer the reader to that paper for additional properties of such unitary operators .    [ thm : tensor - product - s ] let @xmath6 be a bipartite unitary operator .",
    "the following are equivalent :    1 .",
    "[ it : tensor - product - s - i ] there exists a set of quantum states @xmath7 which spans @xmath8 such that for any @xmath220 , the subalgebra @xmath44 is stable by the quantum channel @xmath283 : @xmath284 2 .   [",
    "it : tensor - product - s - ii ] there exist unitary operators @xmath398 and @xmath399 such that @xmath400    let us first show @xmath358 .",
    "consider a bipartite unitary @xmath1 as in ; for any @xmath401 and @xmath402 , we have @xmath403 \\\\ & = ( i_d \\otimes i_r \\otimes \\omega_k^ * )   ( v \\otimes w^\\gamma )   ( a \\otimes \\beta \\otimes i_r \\otimes i_r )   ( v^ * \\otimes w^{\\gamma * } )   ( i_d \\otimes i_r \\otimes \\omega_k)\\\\ & = ( \\operatorname{id}_d \\otimes \\operatorname{tr}_k)\\left [ v   ( a \\otimes \\beta )   v^ * \\right ] \\otimes i_r \\in \\mathcal a,\\end{aligned}\\ ] ] where @xmath404 is the maximally entangled state .",
    "the computation above is represented graphically in figure [ fig : u - tensor - product - s ] .",
    "-preserving channels.,title=\"fig : \" ] + -preserving channels.,title=\"fig : \" ]    let us now prove @xmath405 .",
    "we follows the steps in the proof of theorem [ thm : tensor - product - h ] . using linearity , the universal property of the tensor product and complete positivity",
    ", we find that there are operators @xmath406 and @xmath407 , for some @xmath371 , such that @xmath408 see figure [ fig : uvw - tensor - product - s ] , left panel .",
    "moreover , the application @xmath409 is an isometry , so @xmath385 . denoting by @xmath410 the partial transposition of @xmath346 with respect to the spaces @xmath24 and @xmath411 , that is @xmath412 we have @xmath413 as claimed ; see figure [ fig : uvw - tensor - product - s ] , right panel . from the trace preservation condition",
    ", we get that @xmath82 is an isometry , and thus @xmath414 .",
    "we conclude that @xmath415 , and thus both @xmath82 and @xmath346 are unitary operators . asking that @xmath416 yields @xmath417 unitary , proving the final claim and finishing the proof .    .",
    "triangle shaped labels correspond to the space @xmath411 ; in the proof , it is shown that @xmath388 . ]    as in the heisenberg case , we discuss next some special cases of theorem [ thm : tensor - product - s ] . in the case where @xmath391 , @xmath44 is the full input matrix algebra , so we recover the set of all unitary matrices @xmath392 . if @xmath393 , the ancilla space is trivial , and the quantum channel acts by unitary conjugation ; hence , @xmath1 must be a tensor product , @xmath418 , with @xmath419 and @xmath420 . finally , if @xmath390 , we just require of the quantum channels @xmath10 to be unital , independently of the value of @xmath2 ; but this is precisely theorem ( * ? ? ? * theorem 3.1 )",
    ": the unitary operator @xmath1 must be such that its partial transpose is also unitary @xmath421 .",
    "we would like to address here the same question as the one in section [ sec : comparing - sum ] , but with the following choice of subalgebras : @xmath422 where @xmath423 are two arbitrary integers , and @xmath351 .",
    "it is clear that @xmath327 . as in the previous case , we show that the two sets of unitary operators that leave invariant the above subalgebras can not be compared .",
    "let us start by considering a general element from @xmath424 , of the form @xmath425 , see theorem [ thm : tensor - product - h ] .",
    "in order to check the conditions in theorem [ thm : block - diagonal - heisenberg ] , we decompose @xmath426 and obtain the following expression for the blocks of @xmath1 : @xmath427 since @xmath346 is unitary , an operator as above is a partial isometry iff @xmath428 is one ; but one can easily construct a unitary matrix @xmath82 having at least one block which is not a partial isometry ( one can pick any small enough matrix @xmath429 which is not a partial isometry and extend it to a unitary matrix ) .",
    "this shows that @xmath332 .    to show that the reversed inclusion also fails to hold , consider the case @xmath430 and choose two families @xmath431 , @xmath432 of @xmath433 vectors , such that the conditions corresponding to conditions [ it : row - final ] , [ it : col - initial ] of definition [ def : bistochastic - pi ] are satisfied : @xmath434 define @xmath435 where @xmath436 is another orthonormal basis of @xmath437 and @xmath438 is an arbitrary family of unitary operators acting on @xmath360 .",
    "the operator defined above leaves invariant the algebra @xmath336 , since its blocks @xmath439 are partial isometries satisfying the hypotheses of theorem [ thm : block - diagonal - heisenberg ] with initial and final spaces given by @xmath440 let us assume now that the unitary @xmath1 described above also leaves the algebra @xmath336 invariant ; from theorem [ thm : tensor - product - h ] , we find unitary operators @xmath441 and @xmath442 such that @xmath443 .",
    "in particular , the blocks of @xmath1 read @xmath444 where @xmath428 are the @xmath445 blocks of the unitary operator @xmath82 . muliplying the equation above with the adjoint of the same expression for another index pair @xmath446",
    ", we get @xmath447 a contradiction occurs in the relation above if there is a quadruple @xmath448 such that @xmath449 and @xmath450",
    "let @xmath451 be a subalgebra of @xmath37 and @xmath452 the associated direct sum of orthogonal subspaces decomposition",
    ". in this decomposition , @xmath453 and @xmath454 is a partition of @xmath5 . in this section",
    "we want to characterize the bipartite unitary matrices generating ucp maps as in ( resp .",
    "tpcp maps as in ) preserving @xmath44 irrespective of the ancilla state @xmath2 .",
    "it turns out that imposing the stability of @xmath44 for a given positive definite @xmath2 is enough .",
    "we consider the block decomposition of the bipartite matrices corresponding to the partition of @xmath5 associated to @xmath44 .",
    "namely for any @xmath455 , there exists four matrices , @xmath456 and @xmath457 such that @xmath458 the stability of @xmath44 algebras in either the schrdinger or heisenberg pictures imposes the same constraints on the bipartite unitary matrices .",
    "[ thm : zero_bloc_unitary ] let @xmath459 and @xmath44 be the above subalgebra of @xmath37 .",
    "then the following statements are equivalent :    1 .",
    "there exists a set of quantum states @xmath7 spanning @xmath8 such that for any @xmath460 , the subalgebra @xmath44 is stable under the ucp map @xmath33 : @xmath461 2 .",
    "there exists a set of quantum states @xmath7 spanning @xmath8 such that for any @xmath460 , the subalgebra @xmath44 is stable under the tpcp map @xmath10 : @xmath462 3 .",
    "it holds that @xmath463 with @xmath464 and @xmath465 unitary matrices .",
    "the implications ( 1)@xmath15(3 ) and ( 2)@xmath15(3 ) hold if the stability of the algebra @xmath44 holds for a positive definite state @xmath2 .",
    "in other words if @xmath7 is replaced in respectively ( 1 ) and ( 2 ) by a singlet @xmath466 with @xmath467 .",
    "we start with the implication ( 1)@xmath15(3 ) .",
    "statement ( 1 ) is equivalent to @xmath468 for any @xmath469 positive semidefinite such that @xmath470 and @xmath471 positive semidefinite such that @xmath472 . from the definition of @xmath33 in",
    ", we get @xmath473 since @xmath467 and , @xmath375 and @xmath474 are positive semidefinite , there exists a constant @xmath475 such that , @xmath476 thus , ( 1 ) implies , @xmath477 for any @xmath469 positive semidefinite such that @xmath470 and @xmath471 positive semidefinite such that @xmath472 . choosing @xmath478 and @xmath479 with @xmath480 the orthogonal projector on @xmath481 , @xmath482 hence @xmath483 where @xmath484 is the hilbert  schmidt norm .",
    "since @xmath1 is a unitary matrix , @xmath485 implies @xmath486 and @xmath487 .",
    "hence both @xmath464 and @xmath465 are full rank and thus unitary matrices by cochran s lemma [ lem : cochran ] . using again the fact that @xmath1 is unitary , @xmath488 yields statement ( 3 ) .",
    "the proof of ( 2)@xmath15(3 ) is similar .",
    "statement ( 2 ) is equivalent to @xmath489 for any @xmath469 positive semi definite such that @xmath470 and @xmath471 positive semi definite such that @xmath472 . from the definition of @xmath10 in , @xmath490 since @xmath467 , taking @xmath491 and @xmath479 we deduce , @xmath492 . using again the fact that @xmath1 is unitary , statement ( 3 ) follows .",
    "the proof of the implications ( 3)@xmath15(1 ) and ( 3)@xmath15(2 ) are straightforward once one remarks that ( 3 ) implies that @xmath493 .    imposing a finer subalgebra structure to @xmath44",
    "amounts to apply one of the appropriate theorems from previous sections to the unitary bloc @xmath465 .",
    "we discuss in this section the natural probability measure one can consider on the sets of bipartite unitary operators appearing in theorems [ thm : diagonal - heisenberg],[thm : diagonal - schrodinger],[thm : block - diagonal - heisenberg],[thm : block - diagonal - schrodinger],[thm : tensor - product - h],[thm : tensor - product - s ] .",
    "we shall discuss each problem separately , in the order of increasing difficulty .",
    "let us start with the set of unitary operators described in theorem [ thm : diagonal - heisenberg ] ; these are bipartite operators @xmath494 with the property that the blocks @xmath184 are partial isometries satisfying conditions [ it : row - final],[it : col - initial ] from definition [ def : bistochastic - pi ] .",
    "let us denote by @xmath495 . from condition",
    "[ it : col - initial ] , we deduce that @xmath496 , \\qquad \\sum_{i=1}^n \\delta_{ij } = k.\\ ] ] since @xmath145 is a partial isometry , we also have @xmath497 , and thus , from condition [ it : row - final ] , we get @xmath498 , \\qquad \\sum_{j=1}^n \\delta_{ij } = k.\\ ] ] we conclude that the non - negative integer matrix @xmath499 has the property that each of its rows and columns forms a partition of @xmath500 . for each such _ pattern matrix _ @xmath501",
    ", we construct the following probability measure on the set of unitary matrices @xmath1 .",
    "* random bipartite unitary operators satisfying [ it : row - final],[it : col - initial ] with a given pattern *    1 .",
    "* input : * a pattern matrix @xmath501 .",
    "2 .   consider @xmath502 i.i.d .",
    ", haar distributed unitary random matrices @xmath503 .",
    "denote by @xmath504 the @xmath25-th column of the matrix @xmath505 ; similarly for @xmath506 .",
    "3 .   define the input spaces @xmath20 as follows : @xmath507 , \\qquad e_{ij } : = \\operatorname{span } \\left\\{c_j\\left(\\sum_{t < i}\\delta_{tj } + s\\right)\\right\\}_{s=1}^{\\delta_{ij}},\\ ] ] and the output spaces @xmath21 as @xmath507 , \\qquad f_{ij } : = \\operatorname{span } \\left\\{r_i\\left(\\sum_{t < j}\\delta_{it } + s\\right)\\right\\}_{s=1}^{\\delta_{ij}}.\\ ] ] 4 .   for all @xmath508 $ ]",
    ", the partial isometry @xmath145 is defined by its action on @xmath20 , the orthogonal of its kernel : @xmath509 , \\qquad u_{ij }",
    "c_j\\left(\\sum_{t < i}\\delta_{tj } + s\\right ) = r_i\\left(\\sum_{t < j}\\delta_{it } + s\\right).\\ ] ] 5 .   *",
    "output : * @xmath510 , a random unitary matrix satisfying the conditions from theorem [ thm : block - diagonal - heisenberg ] .",
    "note that the choice of the pattern matrix @xmath501 in the algorithm above is arbitrary .",
    "a canonical choice only appears when @xmath511 , in which case one can choose @xmath512 , for all @xmath508 $ ] .",
    "the case of unitary operators appearing in theorem [ thm : block - diagonal - heisenberg ] is dealt with in a similar manner , we leave the details to the reader .",
    "let us now consider bipartite unitary operators that satisfy the conditions from theorem [ thm : tensor - product - h ] .",
    "such operators admit a decomposition @xmath513 for other unitary matrices @xmath355 and @xmath356 , and it is natural to choose @xmath82 and @xmath346 to be independent , haar distributed in their respective group .",
    "note that this probability measure does not give the full haar measure on the group @xmath514 , since the operators @xmath82 and @xmath346 `` interact '' only on the space @xmath24 .",
    "counting parameters , we find that the real dimension of the set of @xmath1 s is @xmath515 .",
    "regarding operators which give quantum channels preserving tensor product algebras ( theorem [ thm : tensor - product - s ] ) , the situation is more complicated , since there is not an obvious way to sample uniformly from the set @xmath516 from , see also ( * ? ? ?",
    "* section 3 ) .",
    "we conjecture that the following algorithm will converge to an element of @xmath516 .",
    "* sampling from @xmath516 *    1 .",
    "* input : * integers @xmath517 and an error parameter @xmath518 .",
    "2 .   start with a haar distributed unitary random unitary operator @xmath6 .",
    "3 .   while @xmath519 , repeat the next step : 4 .",
    "@xmath520 , where @xmath521 is the unitary operator @xmath82 appearing in the polar decomposition of @xmath375 : @xmath522 with @xmath523 .",
    "* output : * @xmath1 , an operator at distance at most @xmath524 from @xmath516 .    in figure",
    "[ fig : uunital - numerics ] , we present numerical evidence supporting our conjecture that the algorithm above converges .",
    "note than an obstruction to the convergence of the algorithm would be an example of a matrix @xmath6 such that @xmath525 on such an input , the loop would be stuck on @xmath526 .",
    "we do not know whether such matrices exist or not .",
    "an implementation of the algorithm above can be found at @xcite .",
    "converges . on the left panel , a histogram of the logarithm of the number of iterations that the algorithm needs to terminate for @xmath167 and @xmath527 , ran on @xmath528 random input data . on the right panel , for the same size parameters , the average number of steps the algorithm needs to converge , for different values of @xmath524.,title=\"fig:\",scaledwidth=40.0% ]   converges . on the left panel , a histogram of the logarithm of the number of iterations that the algorithm needs to terminate for @xmath167 and @xmath527 , ran on @xmath528 random input data . on the right panel , for the same size parameters , the average number of steps the algorithm needs to converge , for different values of @xmath524.,title=\"fig:\",scaledwidth=40.0% ]    finally , let us discuss the case of unitary operators producing quantum channels which preserve diagonal subalgebras , see theorem [ thm : diagonal - schrodinger ] .",
    "generating such a matrix of partial isometries is very similar to what we have done in the heisenberg case , with just one exception : the output subspaces need to partition @xmath24 both row - wise and column - wise .",
    "let us assume , for the sake of simplicity , that @xmath529 and @xmath530 , for all @xmath508 $ ] ; we denote by @xmath531 the unit vector ( up to a phase ) which spans @xmath21 .",
    "we recover the following definition from @xcite .",
    "[ def : qls ] a _ quantum latin square _ ( qls ) of order @xmath41 is a matrix @xmath532 , where @xmath533 are such that the vectors on each row ( resp .",
    "column ) of @xmath375 form an orthonormal basis of @xmath5 .",
    "we present next a conjectural algorithm for generating qls .",
    "the main idea is to look at the projections on the vectors @xmath531 : @xmath534 .",
    "then , for some fixed column @xmath25 , the fact that the vectors @xmath535 form an orthonormal basis of @xmath5 is equivalent to the following equality ( a similar relation holds for the rows ) : @xmath536 .",
    "since this relation is similar to some probabilities summing up to one , we draw a parallel between qls and bistochastic matrices .",
    "our algorithm is thus an adaptation of the classical sinkhorn - knopp algorithm for generating bistochastic matrices @xcite .",
    "although the procedure resembles gurvits algorithm @xcite called `` operator scaling '' , we have not been able to reduce it to operator scaling .",
    "note also that the algorithm below also appears in the representation theory of the quantum symmetric group @xmath537 , see @xcite . for a @xmath538-tensor @xmath375 ,",
    "define the following @xmath502 matrices , which have the vectors @xmath531 as columns : @xmath539 , \\qquad r_i & = \\sum_{j=1}^n x_{ij}e_j^*\\\\ \\forall j \\in [ n ] , \\qquad c_j & = \\sum_{i=1}^n x_{ij}e_i^*.\\end{aligned}\\ ] ] we say that @xmath375 is an @xmath524-qls if it is close to being a qls , in the following sense : @xmath540    * non - commutative sinkhorn algorithm for sampling qls *    1 .",
    "* input : * the dimension @xmath41 and an error parameter @xmath518 2 .",
    "start with @xmath531 independent uniform points on the unit sphere of @xmath5 .",
    "3 .   while @xmath375 is not an @xmath524-qls , do the steps ( [ it : rows]-[it : swap ] ) 4 .",
    "[ it : rows]@xmath541 define the matrix @xmath474 by making the rows of @xmath375 unitary : @xmath498 , \\qquad y_{ij } = \\operatorname{pol}\\left ( \\sum_{s=1}^n x_{is}e_s^ *   \\right ) \\cdot e_j.\\ ] ] 5 .",
    "[ it : cols]@xmath541 define the matrix @xmath542 by making the rows of @xmath474 unitary : @xmath496 , \\qquad z_{ij } = \\operatorname{pol}\\left ( \\sum_{s=1}^n y_{sj}e_s^ *   \\right ) \\cdot e_i.\\ ] ] 6 .",
    "[ it : swap]@xmath541 @xmath543 .",
    "* output : * @xmath375 , an @xmath524-qls .",
    "we conjecture that the algorithm above converges almost surely ( for a computer implementation , see @xcite ) .",
    "again , the proof of this important result is elusive at this time , but we have numerical evidence ( see figure [ fig : qls - numerics ] ) , as well as a proof of a relaxed version , where we replace the rank-1 projectors @xmath544 with positive definite operators , see appendix [ sec : app - sinkhorn - positive ] .     and",
    "@xmath527 , ran on @xmath528 random input data . on the right panel , for the same size parameter , the average number of steps the algorithm needs to converge , for different values of @xmath524.,title=\"fig:\",scaledwidth=40.0% ]   and @xmath527 , ran on @xmath528 random input data . on the right panel , for the same size parameter , the average number of steps the algorithm needs to converge , for different values of @xmath524.,title=\"fig:\",scaledwidth=40.0% ]",
    "we present in this section a non - commutative version of the classical sinkhorn algorithm @xcite .",
    "the goal of the algorithm is to produce , starting from a matrix @xmath545 of positive definite blocks @xmath546 another block matrix @xmath547 having the following two properties : @xmath539 , \\quad & \\sum_{j=1}^n y_{ij } = i_k\\\\ \\forall j \\in [ n ] , \\quad & \\sum_{i=1}^n y_{ij } = i_k.\\end{aligned}\\ ] ] a block matrix having the two properties above will be called a _",
    "block - bistochastic _ matrix . as in the classical case , we shall need to define an approximate notion of block - bistochasticity : given some positive @xmath548 , we call @xmath474 @xmath524-block - bistochastic if @xmath539 , \\quad & \\|i_k - \\sum_{j=1}^n y_{ij } \\| \\leq \\varepsilon\\\\ \\forall j \\in [ n ] , \\quad & \\|i_k - \\sum_{i=1}^n y_{ij } \\| \\leq \\varepsilon.\\end{aligned}\\ ] ]        1 .",
    "* input : * a block matrix @xmath549 with positive definite blocks @xmath550 and some positive precision parameter @xmath518 2 .",
    "let @xmath551 3 .",
    "while @xmath474 is not @xmath524-block - bistochastic , do the steps ( [ it : step - rows]-[it : step - swap ] ) 4 .",
    "[ it : step - rows]@xmath541 define the block matrix @xmath552 by normalizing the rows of @xmath474 : @xmath553 5 .",
    "[ it : step - cols]@xmath541 define the block matrix @xmath554 by normalizing the columns of @xmath552 : @xmath555 6 .",
    "[ it : step - swap]@xmath541 let @xmath556 7 .",
    "* output : * @xmath474 , a @xmath524-block - bistochastic matrix .    before proving that the algorithm above finishes after a finite number of steps ,",
    "let us note that the inverses used in steps ( [ it : step - rows ] ) and ( [ it : step - cols ] ) are well - defined .",
    "indeed , it is easy to check that at each step , the matrices @xmath557 have positive definite blocks ( we assume that the input @xmath375 has this property ) , and thus their row - sums and column - sums are also positive definite ( and thus invertible ) @xmath445 matrices .      our proof is a natural extension of the proof in @xcite . on the set @xmath559 of @xmath177 block matrices with strictly positive @xmath445 blocks @xmath560",
    ", we introduce the function @xmath561 given by @xmath562    let us now consider a matrix @xmath563 with the property that the columns of @xmath474 are normalized , i.e. @xmath564 $ ] , @xmath565 .",
    "we claim that @xmath566 .",
    "indeed , this is a consequence of the arithmetic - geometric ( ag ) mean inequality , as follows : @xmath567    so , if we denote by @xmath568 the matrices @xmath474 which enter the algorithm at step ( [ it : step - rows ] ) , then we have @xmath569 , for all @xmath570 .",
    "we show now that , along the `` trajectory '' @xmath568 , the functional @xmath50 is increasing .",
    "we shall assume that @xmath570 ( @xmath474 entering step ( [ it : step - rows ] ) has normalized columns ) and we shall prove that @xmath571 .",
    "the inequality @xmath572 can be proved in a similar manner .",
    "we have @xmath573 and thus it is enough to show that @xmath574 we have thus shown that the function @xmath575 is increasing and bounded along a run @xmath568 of the algorithm , so it must converge to some value @xmath576 $ ] . in particular , the quantity appearing on the left hand side of converges to 1 , as @xmath577 . as a consequence ,",
    "the ag mean inequalities which were used in were almost equalities : given @xmath524 , there is some @xmath578 such that , for all @xmath579 and all @xmath67 $ ] , @xmath580 it is a classical fact ( see , e.g.  @xcite ) that this implies that that the numbers appearing in the ag inequality should be , up to some constants depending on @xmath41 , @xmath524-close to their mean ; in our case this translates to the matrices @xmath581 being close to a multiple of the identity , which is our @xmath524-block - bistochastic condition ."
  ],
  "abstract_text": [
    "<S> we study the structure of bipartite unitary operators which generate via the stinespring dilation theorem , quantum operations preserving some given matrix algebra , independently of the ancilla state . </S>",
    "<S> we characterize completely the unitary operators preserving diagonal , block - diagonal , and tensor product algebras . some unexpected connections with the theory of quantum latin squares </S>",
    "<S> are explored , and we introduce and study a sinkhorn  like algorithm used to randomly generate quantum latin squares . </S>"
  ]
}