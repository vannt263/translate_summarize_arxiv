{
  "article_text": [
    "complex network has been one of the most active research topics in statistical physics and many other disciplines @xcite .",
    "it describes not only the pattern discovered ubiquitously in real world but also a unified theoretical framework to understand the inherent complexity in nature .",
    "however , the investigation of large networks , such as human brain that composes of about @xmath0 neurons and @xmath1 synapses @xcite , requires tremendous time - demanding efforts .",
    "the phenomenological description may capture certain properties of system , but always neglects microscopic information .",
    "a promising alternative is to develop coarse - grained ( cg ) methods , aiming at significant reducing the degree of freedom while proper preserving the microscopic information of interest .",
    "several cg schemes have been proposed .",
    "renormalization transformation has been used to simplify self ",
    "similar networks , and the reduced networks often preserve some topological properties of the original ones @xcite . spectral coarse graining technique has been proposed , in which the eigenvalues of laplace matrix of network are almost unchanged , such that the dynamics of random walk and synchronization are preserved @xcite . equation ",
    "free multiscale computational framework has been developed to accelerate simulation using a coarse time stepper @xcite .",
    "this approach has been applied to study the cg dynamics of oscillators network @xcite , gene regulatory network @xcite , and adaptive epidemic network @xcite . however , to our best knowledge , no attempt has been made for developing cg simulation method to study critical phenomena ( usually described by stochastic models ) on complex networks .",
    "the size  dependent and scaling behaviors in these systems are studied so far mainly by such as monte carlo ( mc ) and kinetic mc ( kmc ) simulations @xcite .",
    "apparently , these microscopic approaches are often too expensive .",
    "it is noticed that the cg stochastic models have been proposed to study reaction ",
    "diffusion processes on regular lattices @xcite .",
    "however , the existing methods are largely inapplicable to critical phenomena on complex networks with diversified heterogeneity .",
    "moreover , the crucial issue concerning the methodology development as to what criteria should be met to make the cg model statistically consistent with the microscopic one is yet to be addressed .    in this paper , we propose the degree - based cg ( @xmath2-cg  for short hereafter ) be a statistically consistent scheme , within the annealed network approximation ( ana ) @xcite .",
    "it may therefore be an efficient and reliable cg method for evaluating the stationary properties of phase transitions and studying size effect on complex networks .",
    "we put forward the conditions of statistical consistency ( csc ) on both equilibrium and nonequilibrium properties , exemplified with the ising model and susceptible  infected  susceptible ( sis ) model , respectively .",
    "we show that the @xmath2-cg  approach that merges together the nodes of similar degrees does warrant the csc within ana .",
    "the stochastic ising spin  flip and epidemic spreading dynamics can therefore be evaluated faithfully and efficiently with the @xmath2-cg  networks .",
    "the calculated phase diagrams , fluctuation dynamics , and system size  scaling behaviors are all shown in excellent agreements with the corresponding microscopic mc and kmc results .",
    "the rest of this paper is organized as follows . in sec.[sec2 ] , we present a general scheme for coarse graining network and @xmath2-cg  approach , and further prove that this approach satisfies statistical consistency .",
    "extensive numerical demonstrations of the cg approach are performed on diverse networks in sec.[sec3 ] . at last",
    ", main conclusions and discussion are addressed in sec.[sec4 ] .",
    "let us start with the basic ingredients of network coarse graining . consider a network consisted of @xmath3 nodes whose connectivity is given by the adjacency matrix @xmath4 , in which @xmath5 if nodes @xmath6 and @xmath7 are connected and @xmath8 otherwise . merging @xmath9 nodes together into a cg - node ( denoted by @xmath10 ) leads to a cg  network with @xmath11 cg - nodes .",
    "we adopt the mean  field definition of the cg connectivity between @xmath10 and @xmath12 , as the average number of links connecting any two nodes inside @xmath10 and @xmath12 .",
    "the adjacency matrix @xmath13 of the cg network is then @xmath14 for illustration , fig.[fig1 ] depicts an example of coarse graining a network with six nodes into a weighted cg network with three cg - nodes .     of cg network by eq.([eq1 ] ) .",
    "note that the cg network may include self  connections ; for example , the cg - node iii where the connected nodes are merged .",
    "[ fig1 ] ]      we address the issue on the statistical consistency of a cg scheme with the microscopic network , in terms of both the equilibrium distribution and the nonequilibrium flow .",
    "we exploit the ising model and the sis model as the paradigmatic examples for equilibrium and nonequilibrium systems , respectively .    for the ising model defined on a network ,",
    "the hamiltonian is given by @xmath15 , with the spin variable @xmath16 , and the ferromagnetic interaction parameter @xmath17 .",
    "the probability of a given microscopic spin configuration @xmath18 is given by canonical distribution @xmath19 , where @xmath20 is the inverse temperature and @xmath21 is the partition function .",
    "the corresponding cg hamiltonian assumes the sum of pairwise interactions inside and between the cg - nodes , i.e.  @xmath22 , @xmath23 \\nonumber \\\\ & = -\\frac{j}{2}\\sum\\limits_\\mu { a_{\\mu\\mu}^c }     \\big(\\eta^2_\\mu - q_\\mu \\big ) , \\label{eq2 } \\\\   h_2^c & = -j\\sum\\limits_{\\mu<\\nu } a^c_{\\mu\\nu }     \\big(n^+_\\mu n^+_\\nu + n^-_\\mu n^-_\\nu - n^+_\\mu n^-_\\nu - n^-_\\mu n^+_\\nu\\big ) \\nonumber \\\\ & = - j\\sum\\limits_{\\mu<\\nu } a^c_{\\mu\\nu } \\eta_\\mu \\eta_\\nu .",
    "\\label{eq3}\\end{aligned}\\ ] ] here , @xmath24 is the cg spin variable , and @xmath25 is the number of up / down spins inside @xmath10 . note that @xmath26 above is a closure expression at the cg level that depends only on @xmath13 and @xmath27 . to make the cg model consistent with the microscopic one , it demands that the probability of any given cg configuration @xmath27 in equilibrium be the sum of the probabilities of all microscopic configurations that contribute to it .",
    "that is @xmath28 where @xmath29 is the number of microscopic configurations corresponding to @xmath27 .",
    "we now consider the nonequilibrium scenario , exemplified by the sis network for epidemic spreading dynamics . at the microscopic level ,",
    "the sis network nodes represent individuals being either susceptible ( @xmath30 ) or infected ( @xmath31 )",
    ". a susceptible individual @xmath7 can get infected at rate @xmath32 , where @xmath33 is the spreading flow from an infected individual @xmath6 to @xmath7 .",
    "on the other hand , an infected node can recover to susceptible state at rate @xmath34 .",
    "without loss of generality , we set @xmath35 hereafter to scale the infection parameter @xmath36 .",
    "the sis model exhibits a nonequilibrium dynamical phase transition at @xmath37 from an absorbing state ( all recovered ) to an active state ( disease spreading persistently ) @xcite . for the cg ",
    "sis network , we define the cg variables as the number of infected individuals inside a cg - node @xmath10 by @xmath38 . written in a closure form , the cg recovery rate is @xmath39 , and the cg spreading flow between two cg - nodes is @xmath40 . for this nonequilibrium system ,",
    "the cg model is consistent with the microscopic one if the cg flow matches the microscopic flows : @xmath41 note that the cg recovery rate of @xmath42 holds trivially .      in our approach",
    ", we merge the nodes with similar degrees together .",
    "we shall show the resulting @xmath2-cg  scheme does satisfy the csc , as defined by eq.([eq4 ] ) for the ising model and eq.([eq5 ] ) for the sis model , within the ana for the ensemble averaged dynamics @xcite .",
    "in many previous studies @xcite , ana has been extensively confirmed to be a useful tool for describing quenched networks , as in case of the present paper .",
    "although ana is just an approximation , it still gives a reasonable description of the average behavior of nodes of the same degree .",
    "moreover , one can consider that the ana is a statistical characterization of large number of quenched networks with the same degree distributions .",
    "nevertheless , in ref.@xcite it has been pointed out that there exists some discrepancies between considering annealed approximation for quenched networks and considering annealed network models by themselves . according to the ana , one can replace the dynamics on a given network of @xmath3 nodes by that on a weighted graph of the full connectivity @xmath43 , where @xmath44 and @xmath45 are the degrees of nodes @xmath6 and @xmath7 , respectively , and @xmath46 is the mean degree . in an ideal @xmath2-cg",
    "scheme , the microscopic nodes in a single cg - node are of the same degree : @xmath47 .",
    "the cg connectivity is then @xmath48 , for the cg ",
    "network dynamics treated at the ana level . as results , eqs.([eq2 ] ) and ( [ eq3 ] ) become , respectively ( noting that @xmath49 ) @xmath50 \\nonumber \\\\ &",
    "=   -\\frac{j}{n \\langle k \\rangle }   \\sum_\\mu { k_\\mu^2 } \\sum_{i , j \\in c_\\mu ; i < j } s_i s_j , \\label{eq6}\\\\   h_2^c & = - \\frac{j}{n \\langle k \\rangle }     \\sum_{\\mu<\\nu } k_\\mu k_\\nu     \\sum_{i\\in c_\\mu , j\\in c_\\nu } s_i s_j .",
    "\\label{eq7}\\end{aligned}\\ ] ] their sum can be written as @xmath51 it is identical to the microscopic hamiltonian at the ana level .",
    "in other words , the hamiltonian of any @xmath2-cg  configuration equals to the collection of its contributing microscopic configurations .",
    "the pre - exponential terms in two sides of eq.([eq4 ] ) are both the degeneracy of cg configuration , as well as the identical energy factors ( @xmath52 ) .",
    "we have thus proved that the ideal @xmath2-cg  approach to the ising model obeys the csc of eq.([eq4 ] ) exactly .",
    "it is also easy to prove that the nonequilibrium csc of eq.([eq5 ] ) is true for the sis model in consideration ; both sides there equal to @xmath53 .",
    "therefore , the @xmath2-cg  approach satisfies the csc for both equilibrium probability distributions and nonequilibrium dynamical flows .",
    "certainly it is anticipated that the csc holds approximately if merged together are the nodes of similar degrees rather than the exactly same ones .",
    "the mc simulation with the metropolis dynamics @xcite and the kmc simulation @xcite are applied to the ising model and sis model , respectively , at both the microscopic and the cg levels . in the cg - mc simulation ,",
    "a cg - node @xmath10 is randomly chosen , followed by the metropolis try for spin - flip process .",
    "the probabilities of flipping a up / down  spin is @xmath54 , where @xmath55 , and @xmath56 is the change of cg hamiltonian resulting from the flip of a up / down spin .",
    "it is easy to confirm that the cg - mc simulation obeys the detailed balance condition . in the cg - kmc simulation ,",
    "following the gillespie algorithm @xcite , a cg process to be executed is randomly selected based on the transition rates of all processes .",
    "the configuration and transition rates are updated for executing the next cg process .     in ising model at @xmath57 ( in unit of @xmath58 ) and the density of infected nodes @xmath59 in sis model at @xmath60 for both microscopic and cg levels .",
    "other parameters are @xmath61 and @xmath62 . [ fig2 ] ]      we first consider the barabsi  albert ( ba ) scale - free network @xcite , with the degree distribution follows a power - law @xmath63 with scaling exponent @xmath64 .",
    "figure [ fig2 ] plots typical time evolutions of the magnetization @xmath65 in ising model at @xmath57 ( in unit of @xmath58 ) and the density of infected nodes @xmath66 in sis model at @xmath60 , where @xmath61 and @xmath62 are used .",
    "for both the microscopic and cg simulations , the systems attain the steady states associated with fluctuating noise after transient time .",
    "it is clear that there are in good agreement in the steady - state values of @xmath67 and @xmath59 , as well as their fluctuating amplitudes for both simulations cases .     and",
    "@xmath68 as a function of @xmath69 .",
    "symbols and lines correspond to results by simulating the cg model and by direct microscopic mc simulation , respectively .",
    "( c ) @xmath70 as a function of @xmath71 obtained by the cg model with @xmath72 .",
    "all dotted lines are the results of randomly merging models with @xmath73 and @xmath72 .",
    "all the networks have fixed mean degree @xmath74 the error bars ( not shown ) are smaller than the symbol size .",
    "[ fig3 ] ]     and and @xmath75 as a function of @xmath36 .",
    "symbols and lines correspond to results by simulating the cg model and by direct microscopic kmc simulation , respectively .",
    "( c ) @xmath76 as a function of @xmath77 obtained by the cg model with @xmath72 .",
    "all dotted line are the results of randomly merging models with @xmath73 and @xmath72 .",
    "all networks have fixed mean degree @xmath78 .",
    "the error bars ( not shown ) are smaller than the symbol size .",
    "[ fig4 ] ]    for the ising model , we construct initial configurations by preparing each node with a random spin value @xmath79 or @xmath80 with an equal probability .",
    "as the simulation proceeds , the system quickly relaxes to an equilibrium state . with the same temperature @xmath69",
    "we run at least @xmath81 times of simulations corresponding to different initial configurations and network realizations . in each simulation ,",
    "@xmath82 mc steps ( mcs : each spin is attempted to flip once on average during each mcs ) are performed and the last @xmath83 mcs are used to investigate the system s behavior . as @xmath69 decreases the value of the magnetization @xmath67 undergoes a transition from zero to nonzero at the critical temperature @xmath70 . below @xmath70 we notice that due to finite - size effects the system can switch between two stable states via a nucleation mechanism , resulting in the oscillations of @xmath67 @xcite . above @xmath70 , @xmath67 fluctuates around zero , and the susceptibility @xmath68 per node has a maximum at phase transition , which can be used to determine @xmath70 as we shall show in fig.[fig3](b ) .",
    "the susceptibility is related to the magnetization fluctuation via the fluctuation  dissipation theorem . to avoid the offset of @xmath67 due to its oscillations in simulations",
    ", we will use instead the absolute value of @xmath67 in the following .",
    "@xmath84 and @xmath68 are shown in fig.[fig3](a ) and ( b ) , respectively , as a function of the temperature @xmath69 for different @xmath3 and @xmath11 .",
    "apparently , the @xmath2-cg  results ( reported by symbols ) are in excellent agreements with the microscopic  level counterparts ( by solid and dashed lines ) .",
    "as contrast , we also report the results of random - merging ( rm ) cg scheme ( by dotted lines ) in fig.[fig3](a ) and ( b ) , where each cg  node includes @xmath85 ( @xmath61 , @xmath72 ) nodes selected randomly from the whole network .",
    "evidently the random scheme fails badly in reproducing the microscopic behaviors .",
    "we also used the same @xmath9 in the random scheme as in the case of @xmath2-cg  scheme , and found that the two random schemes produce the same results .",
    "it is important to merge nodes with similar degrees together , as already shown both analytically and numerically .",
    "strikingly , even when the original network is reduced to one with only @xmath86 cg - nodes , the @xmath2-cg  scheme still faithfully reproduces the phase transition curves and fluctuations properties .",
    "since @xmath11 is largely reduced compared to @xmath3 , a considerable speed  up of cpu time , about a factor of 40 , is realized for @xmath73 .",
    "a significantly higher gain can be expected as the network gets larger , allowing the computational study of network size effect very affordable .    using the @xmath2-cg  approach with a fixed size of cg ",
    "networks @xmath72 , we calculate the dependence of phase  transition critical @xmath70 on the network size @xmath3 , as reported in fig.[fig3](c ) .",
    "it had been well established that the ising model with ferromagnetic interactions on ba scale - free network undergoes a phase transition from ferromagnetism to paramagnetism at a critical temperature @xmath70 that increases as the logarithm of network size @xcite .",
    "our result is consistent with the theoretical expression @xcite that @xmath87 , where @xmath88 for the present case of study .",
    "note that the critical phenomenon disappears when @xmath89 .    for the sis model",
    "there is an epidemic threshold @xmath90 on a finite size ba scale - free network network @xcite .",
    "our numerical simulation starts from a random configuration with about half nodes being infected .",
    "after an initial transient regime , the system will evolve into a steady state with a constant average density of infected nodes .",
    "the steady density of infected nodes @xmath59 is computed by averaging over at least @xmath91 different initial configurations and at least @xmath92 different network realizations with the same parameter @xmath36 .",
    "the epidemic threshold @xmath90 occurs at @xmath93 ( absorbing state ) if @xmath94 and @xmath95 ( active state ) if @xmath96 @xcite . due to finite size effects",
    ", the fluctuation can drive the system to the absorbing state , especially in the vicinity of @xmath76 .",
    "once the absorbing state is arrived , the system will never leave it .",
    "based on the consideration , we use , in practice , a nonzero tolerance in @xmath59 ( with the order of @xmath97 ) as the boundary of the phase transition point .",
    "reported in fig.[fig4](a ) and ( b ) are the calculated results of @xmath59 and its fluctuation @xmath98 , respectively , as a function of @xmath36 , obtained by the cg model and the microscopic model .",
    "again , while the rm scheme fails when the relative infection rate parameter @xmath99 , the agreement between the @xmath2-cg  and the microscopic results remains excellent .",
    "fixing @xmath72 in the @xmath2-cg  approach , the resulting @xmath76 shown in fig.[fig4](c ) is proportional to @xmath77 , also consistent with the theoretical prediction @xcite .",
    "figure [ fig5 ] show that the simulation results of the microscopic and cg levels on scale - free networks with other two scaling exponents , @xmath100 and @xmath101 . for larger @xmath102 ,",
    "@xmath70 becomes lower , while @xmath76 gets larger .",
    "it is clearly observed that our @xmath2-cg  approach is still applicable .",
    "in addition , many other types of networks such as random network and small - world network are also tested , and all results show that the validity of our @xmath2-cg  approach does not depend on network topology .     and @xmath101 . left panel : @xmath84 and @xmath68 as a function of @xmath69 for ising model .",
    "right panel : @xmath59 and and @xmath75 as a function of @xmath36 for sis model .",
    "all networks have fixed size of @xmath61 and mean degree of @xmath78 .",
    "[ fig5 ] ]      it is worthy noting that the above numerical demonstrations are carried out on degree uncorrelated networks . we will show that our @xmath2-cg  approach is valid to reproduce critical behaviors on degree  degree correlated networks as well . it has been witnessed that many real networks display different degree  mixing patterns @xcite . to measure the degree of the correlation , in ref.@xcite newman introduced a degree - mixing coefficient : @xmath103 , where @xmath44 and @xmath45 are the remaining degrees at the two ends of a link and",
    "@xmath104 means the average over all links .",
    "@xmath105 indicates that there is no degree correlation , while @xmath106 ( @xmath107 ) indicates that a network is assortatively ( disassortatively ) mixed by degree .",
    "previous studies have revealed that degree  mixing pattern plays an important role in dynamical behaviors on networks , such as percolation @xcite , epidemic spreading @xcite , synchronization @xcite . to generate different degree  mixing networks , we employ a algorithm proposed in @xcite . at each elementary step ,",
    "two links in a given network with four different nodes are randomly selected . to get an assortative network , the links are rewired in such a way that one link connects the two nodes with the smaller degrees and the other connects the two nodes with the larger degrees .",
    "multiple connections are forbidden in this process .",
    "repeat this operation until an assortative network is generated without changing the node degrees of the original network . similarly",
    ", a disassortative network can be produced with the rewiring operation in the mirror method .",
    "we start from ba scale - free networks with a neutrally degree - mixing pattern , and produce some groups of degree - mixing networks by performing the above algorithm .",
    "figure [ fig6 ] displays the results of ising model and sis model for three different values of @xmath108 . for each @xmath108 ,",
    "the simulation results of cg models agree well with those of microscopic ones . in ising model , @xmath70 shifts to right and @xmath68 at @xmath70 becomes smaller as @xmath108 increases . in sis model , both @xmath76 and the fluctuation of @xmath59 at @xmath76 decrease with @xmath108 .    .",
    "left panel : @xmath84 and @xmath68 as a function of @xmath69 for ising model .",
    "right panel : @xmath59 and and @xmath75 as a function of @xmath36 for sis model .",
    "all networks have power - law degree distributions with the scaling exponent @xmath64 , and fixed size of @xmath61 and mean degree of @xmath78 .",
    "in summary , we propose an approach for coarse graining the phase transition dynamics on complex networks described by stochastic models for both equilibrium and nonequilibrium systems .",
    "the @xmath2-cg  approaches via degree - based merging scheme are feasible since the reliable microscopic information such as phase transition behaviors and fluctuations are preserved .",
    "we have verified that our @xmath2-cg  approach supports , in consistent with the microscopic models , the equilibrium distributions for ising model and the nonequilibrium dynamical flows for sis model .",
    "stochastic description , as exemplified here , is ubiquitously important in the study of phase transition dynamics and complex networks for a wide range of realistic systems .",
    "moreover , this work also suggests the development of other promising cg statistical models satisfying csc .",
    "it is interesting to compare our @xmath2-cg  approach with heterogeneous mean - field theory ( hmft ) that successfully predicts @xmath70 and @xmath76 on heterogeneous scale - free networks @xcite .",
    "based on the ansatz that nodes with the same degree share the same dynamical properties , hmft derives a series of coupled mean - field equations for degree - dependent quantities .",
    "recently , langevin approach together with the hmft has been developed in refs.@xcite , which have confirmed that such an approach is responsible for the effect of fluctuations in a finite - size network that often play important roles in the vicinity of phase transitions . with regard to the present study",
    ", we develop a reliable cg simulation approach , that not only can correctly predict the critical phenomena and fluctuations information , but also can be applied to diverse networks .",
    "especially , it is shown that the validity of our @xmath2-cg  approach on the application of correlated networks ; however , in this case the hmft becomes , in general , very difficult to deal with .",
    "this is because that specific formulation of degree  degree correlation are unknown for most of correlated networks , such as @xmath109 , that is the conditional probability of a node of degree @xmath110 being connected to a node of degree @xmath111 . on the other hand ,",
    "the csc discussed in this work may provide a solid understanding of the physical mechanism behind the basic assumption of hmft .",
    "our analysis here may lead to the advancement in efficient and consistent cg approaches for dynamics on surfaces and soft lattices .",
    "note that the present study is limited to the case of quenched networks , that is , the connectivity of networks is frozen in time .",
    "while for the case of annealed networks , i.e. the networks themselves are dynamical objects , our cg approach will encounter some difficulties in application . in this case , since the network connections are frequently reshuffled , the adjacency matrix of the resulting cg  network and cg variables should be accordingly updated .",
    "this will lead to the very inefficiency of our cg approach in simulations .",
    "however , an important advancement in studying critical phenomena on annealed networks has been made in refs.@xcite by means of finite - size scaling theory .",
    "developing coarse - grained simulation methods on annealed networks and adaptive networks @xcite deserve further investigations ."
  ],
  "abstract_text": [
    "<S> we propose a degree  based coarse graining approach that not just accelerates the evaluation of dynamics on complex networks , but also satisfies the consistency conditions for both equilibrium statistical distributions and nonequilibrium dynamical flows . </S>",
    "<S> for the ising model and susceptible - infected - susceptible epidemic model , we introduce these required conditions explicitly and further prove that they are satisfied by our coarse - grained network construction within the annealed network approximation . </S>",
    "<S> finally , we numerically show that the phase transitions and fluctuations on the coarse - grained network are all in good agreements with those on the original one . </S>"
  ]
}