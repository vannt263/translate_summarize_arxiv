{
  "article_text": [
    "in the last several decades , phylodynamic inference has demonstrated its usefulness in ecology and epidemiology @xcite .",
    "the key inferential insight of phylodynamics is that population dynamics leave their mark in the shape of gene genealogies and thereby the sequence data sampled .",
    "kingman s coalescent models the relationship between effective population size @xmath0 and the likelihood of observing a particular genealogy @xcite . in order to be computationally feasible , early coalescent - based models required strong parametric assumptions on the effective population size trajectory @xcite .",
    "more recently , nonparametric models have allowed a much more diverse class of effective population size trajectories to be inferred , at the cost of estimating many more parameters .",
    "methods have emerged that compromise between the two extremes , maintaining a tractable number of parameters while allowing for a diverse class of estimable trajectories @xcite .",
    "see the review by @xcite for a detailed comparison .    here",
    "we unify user interfaces for three different but related bayesian nonparametric methods .",
    "these methods assume a log gaussian process prior on @xmath0 .",
    "the first comes from the work by @xcite .",
    "they implement a number of markov chain monte carlo ( mcmc ) algorithms for inferring effective population size trajectories from a fixed genealogy .",
    "they compare different algorithms computational efficiency and mcmc diagnostics .",
    "the second methodology comes from the work by @xcite and @xcite .",
    "they target the same posterior as in @xcite , but implement an integrated nested laplace approximation ( inla ) based approach . utilizing inla allows for a significant computational speedup at the cost of only having access to the latent parameters approximate marginal distributions ( as opposed to mcmc algorithms which approximate the full joint distribution ) . @xcite",
    "have an additional focus of accounting for potential preferential sampling , which incorporates a likelihood relating the sampling times of the genealogy to the effective population size trajectory .",
    "the last methodology comes from the work by @xcite .",
    "they implement an mcmc algorithm for inferring effective population size trajectories from a sequence of local genealogies . here , genealogies are correlated and are assumed to be a realization of the sequentially markov coalescent ( smc@xmath1 ) @xcite .    an r package ` phylodyn ` encapsulates all the above work .",
    "we integrated all of the above methods in a unified user - friendly format , added detailed tutorials , included more features such as simulation of genealogies from the coalescent model that accepts arbitrary but positive effective population size function @xcite , and added features for data manipulation and interaction with other data formats such as beast - xml @xcite .",
    "these features greatly expand available phylodynamics methods in ` r ` .",
    "for example , the ` r ` package ` ape ` @xcite has a function ` skyline ` that implements the generalized skyline method for isochronous genealogies . to the best of our knowledge ,",
    "no other ` r ` package infers effective population size trajectories from heterochronous genealogies .",
    "other ` r ` packages for simulation of genealogical data exist ( e.g.  ` phyclust ` @xcite and ` ape ` ) but they are limited to very specific demographic scenarios such as piece - wise constant and exponential growth functions .",
    "our addition of inference from a sequence of local genealogies expands ` phylodyn ` to a broader class of models that have not been implemented in the previous versions of the package .",
    "a genealogy is a rooted bifurcating tree with labeled tips . branching events",
    "are called coalescent events which occur at coalescent times , and tips are located at sampling times . given a vector of sampling times @xmath2 and an effective population size function @xmath3 , kingman s coalescent provides the following likelihood of observing a particular genealogy @xmath4 with coalescent times @xmath5 : @xmath6 \\propto \\prod_{k=2}^{n } { \\frac{c_{0,k}}{n_e(t_{k-1 } ) } } \\exp\\left [ -\\sum_{i=0}^{m_k } { \\int_{i_{i , k } } { \\frac{c_{i , k}}{n_e(t ) } dt } } \\right],\\ ] ] where @xmath7 , @xmath8 is the number of lineages present during time interval @xmath9 , and @xmath9 is a time interval defined by coalescent times and sampling times and @xmath10 is a time interval that ends at coalescent time @xmath11 .",
    "see @xcite for notational details .",
    "the ` coalsim ` function simulates coalescent times according to this distribution , given a vector of sampling times and an arbitrary effective population size function ` traj(t ) ` .",
    "the function gives the option of using a time - transformation method or a thinning method for simulating the coalescent times .",
    "the time - transformation method scales better but involves numerical integration , while the thinning method is faster with few samples and is an exact method .",
    "the ` generate_newick ` function takes the output generated with ` coalsim ` and returns the corresponding genealogy in ` ape ` s phylo format @xcite .",
    "we are not aware of another r package that allows for simulating the coalescent process while allowing for arbitrary sampling times as well as arbitrary positive effective population size trajectories . `",
    "phylodyn ` also provides functionality for easily simulating sampling times under preferential sampling according to an arbitrary positive function @xmath12 . the `",
    "pref_sample ` function simulates sampling times according to an inhomogeneous poisson process with intensity @xmath13 , where parameters @xmath14 and @xmath15 control the expected number of sampled sequences and the strength of preferential sampling , respectively .",
    "currently the function only allows a thinning method , but a time - transformation method is forthcoming .      following the approach of @xcite and @xcite , @xcite approximate @xmath0 by a piece - wise linear function @xmath16}}$ ] , defined over a regular grid with end points @xmath17 , where @xmath18 equals the most recent sampling time , and @xmath19 , the time when the last two lineages coalesce .",
    "hence , we seek to estimate the posterior @xmath20 \\propto \\pr[\\mathbf{g } \\mid \\mathbf{f } ] \\pr[\\mathbf{f } \\mid \\tau ] \\pr(\\tau ) , \\label{posterior}\\ ] ] where @xmath21 $ ] is the coalescent likelihood , @xmath22 $ ] is a gaussian process prior on @xmath23 with precision @xmath24 , and @xmath25 is a gamma hyperprior on @xmath24 .",
    "our implementation assumes a gaussian process prior on @xmath26 with inverse covariance function @xmath27 , where @xmath28 corresponds to a modified inverse covariance matrix of brownian motion ( see @xcite for details ) .",
    "the ` mcmc_sampling ` function implements a variety of mcmc algorithms for estimating the posterior , given the sufficient statistics for a genealogy ( sampling times and coalescent times ) .",
    "available methods are hamiltonian monte carlo ( hmc ) @xcite , split hmc @xcite , metropolis - adjusted langevin algorithm ( mala ) @xcite , adaptive mala @xcite , and elliptical slice sampler ( ess ) @xcite . for a comparison of the computational efficiency of the different methods",
    "see @xcite .",
    "we illustrate ` phylodyn ` s capabilities with a simulation example .",
    "we let @xmath3 have a seasonal boom - and - bust trajectory ( provided by the ` logistic_traj ` function ) , and we simulate a sequence of sampling times according to an inhomogeneous poisson process with intensity proportional to @xmath3 using the ` pref_sample ` function . we simulate a genealogy from the coalescent using the ` coalsim ` function , and",
    "supply it to the different sampling algorithms of the ` mcmc_sampling ` function .",
    "we summarize the results in figure [ fig : mcmc ] .",
    "@xcite infer @xmath0 from a sequence of @xmath29 local genealogies under the smc model @xcite .",
    "the smc process is an approximation to the ancestral recombination graph ( arg ) which models the set of ancestral relationships and recombination events of multilocus sequences @xcite . in our implementation",
    ", we assume that our data consist of a sequence of genealogies that represent the ancestral relationships at consecutive loci separated by recombination events .",
    "these consecutive genealogies are modeled as a continuous - time markov chain along a chromosomal segment . here , we also approximate @xmath0 by the piece - wise linear function @xmath30 and rely on split hmc @xcite to sample from the posterior : @xmath31 \\propto \\text{pr}[\\mathbf{g}_{0}\\mid \\mathbf{f } ] \\times \\left\\lbrace \\prod^{m-2}_{i=0}\\text{pr}[\\mathbf{g}_{i+1 } \\mid \\mathbf{g}_{i } , \\mathbf{f } ] \\right\\rbrace \\text{pr}[\\mathbf{f } \\mid \\tau ] \\text{pr}(\\tau),\\ ] ] where @xmath32 $ ] is the sequentially markov coalescent likelihood @xcite .",
    "our ` mcmc_smc ` function samples from the posterior distribution ( [ eq : poster ] ) .",
    "figure [ fig : smc ] shows our estimate of @xmath0 from 100 and 1000 local genealogies of @xmath33 individuals simulated under a bottleneck demographic scenario .",
    "@xcite show that our method recovers the bottleneck best when increasing the number of local genealogies .     from @xmath34 and",
    "@xmath35 simulated local genealogies of @xmath33 individuals .",
    "the dashed black line represents the true population size trajectory , the solid black line represents the posterior median estimates , and the shaded regions represent the 95% credible regions .",
    "estimation improves with larger number of genealogies.,scaledwidth=90.0% ]      we implement the inla - based methods of @xcite and @xcite , using the same log - gaussian prior on @xmath0 as in the mcmc methods .",
    "the ` bnpr ` function implements the inla approximation to obtain posterior medians and 95% bayesian credible intervals ( bcis ) of @xmath30 .",
    "being a numerical approximation , this method runs extremely quickly .",
    "however , the method only estimates the marginals of the posterior of the effective population size and hyperparameters , rather than the full joint posterior distribution of mcmc - based methods .",
    "this is frequently sufficient for most purposes involving phylodynamic inference , but offers significant improvement in computational efficiency .",
    "we also implement the bnpr - ps method of @xcite . in cases",
    "where the frequency of sampling times is related to effective population size , including a sampling time model provides additional accuracy and precision .",
    "we model the sampling times as an inhomogeneous poisson process with intensity proportional to a power of the effective population size , with the following log - likelihood : @xmath36 = c + n \\beta_0 + \\sum_{i=1}^{n}{\\beta_1 \\log[n_{f}(s_i ) ] - \\int_{s_m}^{s_0}{\\exp(\\beta_0 ) [ n_f(r)]^{\\beta_1 } dr}}.\\ ] ] this leads to the posterior that conditions on both coalescent and sampling times : @xmath37 \\propto \\pr[\\mathbf{g } \\mid \\mathbf{s } , \\mathbf{f } ] \\pr[\\mathbf{s } \\mid \\mathbf{f } , \\boldsymbol{\\beta } ] \\pr[\\mathbf{f } \\mid \\tau ] \\pr(\\tau ) \\pr(\\beta_0 , \\beta_1 ) .",
    "\\label{posterior2}\\ ] ]    to illustrate , we use the same genealogy under seasonal boom - and - bust population size trajectory as in figure 1 .",
    "we apply bnpr and bnpr - ps to this genealogy , and summarize the results in figure [ fig : bnpr ] .",
    "since our sampling times and genealogy were simulated with preferential sampling , we notice improved performance from bnpr - ps , which correctly models the sampling times .",
    "( @xmath38 ) .",
    "the plot on the left is generated by bayesian nonparametric phylodynamic reconstruction ( bnpr ) that does not account for preferential sampling , while the plot on the right is generated by bayesian nonparametric phylodynamic reconstruction with preferential sampling ( bnpr - ps ) and incorporates our sampling time model .",
    "time is in months.,scaledwidth=80.0% ]",
    "phylodynamic inference aims to enhance our understanding of infectious disease dynamics that involves a combination of evolutionary , epidemiological , and immunological processes @xcite .",
    "although phylodynamic methods have been developed and successfully employed over the last 15 years , there are still many challenges in extending these methods to incorporate different types of information and evolutionary complexities of certain pathogens @xcite .",
    "the tools developed in ` phylodyn ` currently concentrate on estimation of population dynamics from genealogical and sampling information  a subset of phylodynamics problems .",
    "phylodynamic inference from sequence data alone is challenging because the state spaces of genealogies @xmath4 and effective population size trajectories @xmath0 are large .",
    "the mcmc tools implemented in ` phylodyn ` allow for an efficient exploration of the state space of effective population size trajectories @xmath0 when either a single genealogy is available or multiple local sequential genealogies are available .",
    "future implementation in ` phylodyn ` will involve the exploration of the joint space of genealogies , population size trajectories and other epidemiological processes .",
    "we envision that the increasing popularity of ` r ` will allow researchers to integrate different packages with ` phylodyn ` .",
    "for instance , ` phylodyn ` can be used in combination with the ` r ` package ` coalescentmcmc ` to account for genealogical uncertainty .",
    "in addition , our coalescent simulation functions should be of interest to a wide range of users of the coalescent .    28 [ 1]#1 [ 1]`#1 ` urlstyle [ 1]doi : # 1    w.c",
    "_ overlapping codon model , phylogenetic clustering , and alternative partial expectation conditional maximization algorithm _ , 2011 .",
    "url http://gradworks.umi.com/34/73/3473002.html .",
    "a.  j. drummond , g.  k. nicholls , a.  g. rodrigo , and w.  solomon .",
    "estimating mutation parameters , population history and genealogy simultaneously from temporally spaced sequence data .",
    "_ genetics _ , 1610 ( 3):0 13071320 , 2002 .",
    "a.  j. drummond , a.  rambaut , b.  shapiro , and o.  g. pybus .",
    "bayesian coalescent inference of past population dynamics from molecular sequences .",
    "_ molecular biology and evolution _ , 220 ( 5):0 11851192 , 2005 .    a.  j. drummond , m.  a. suchard , d.  xie , and a.  rambaut .",
    "ayesian phylogenetics with beauti and the beast 1.7 .",
    "_ molecular biology and evolution _ , 29:0 19691973 , 2012 .",
    "s.  duane , a.  d. kennedy , b.  j. pendleton , and d.  roweth .",
    "hybrid monte carlo .",
    "_ physics letters b _ , 1950 ( 2):0 216222 , 1987 .",
    "simon d  w frost , oliver  g pybus , julia  r gog , cecile viboud , sebastian bonhoeffer , and trevor bedford . .",
    "_ epidemics _ , 10:0 8892 , march 2015 .",
    "m.  s. gill , p.  lemey , n.  r. faria , a.  rambaut , b.  shapiro , and m.  a. suchard . improving bayesian population dynamics inference : a coalescent - based model for multiple loci . _ molecular biology and evolution _",
    ", 300 ( 3):0 713724 , 2013 .",
    "b.  t. grenfell , o.  g. pybus , j.  r. gog , j.  l.  n. wood , j.  m. daly , j.  a. mumford , and e.  c. holmes .",
    "unifying the epidemiological and evolutionary dynamics of pathogens . _",
    "science _ , 3030 ( 5656):0 327332 , 2004 .",
    "r.  c. griffiths and s.  tavar .",
    "sampling theory for neutral alleles in a varying environment .",
    "_ philosophical transactions of the royal society of london .",
    "series b : biological sciences _ ,",
    "3440 ( 1310):0 403410 , 1994 .    r.c .",
    "griffiths and p.  marjoram . an ancestral recombination graph . in peter donnelly and simon tavar , editors , _ progress in population genetics and human evolution _ , volume  87 of _ i m a volumes in mathematics and its applications _ , pages 257270 .",
    "springer verlag , new york , 1997 .",
    "s.  y.  w. ho and b.  shapiro .",
    "skyline - plot methods for estimating demographic history from nucleotide sequences .",
    "_ molecular ecology resources _ , 110 ( 3):0 423434 , 2011 .",
    "e.  c. holmes and b.  t. grenfell . discovering the phylodynamics of rna viruses .",
    "_ plos computational biology _ , 50 ( 10):0 e1000505 , 2009 .",
    "m.  d. karcher , j.  a. palacios , t.  bedford , m.  a. suchard , and v.  n. minin . quantifying and mitigating the effect of preferential sampling on phylodynamic inference .",
    "_ plos computational biology _",
    ", 12:0 e1004789 , 2016 .",
    "j.  f.  c. kingman .",
    "the coalescent . _ stochastic processes and their applications _ , 130 ( 3):0 235248 , 1982 .",
    "ll  knorr - held and h.  rue . on",
    "block updating in markov random field models for disease mapping . _",
    "scandinavian journal of statistics _ , 290 ( 4):0 597614 , 2002 .",
    "m.  k. kuhner , j.  yamato , and j.  felsenstein . maximum likelihood estimation of population growth rates based on the coalescent . _ genetics _ , 1490 ( 1):0 429434 , 1998 .",
    "s.  lan , j.  a. palacios , m.  d. karcher , v.  n. minin , and b.  shahbaba . an efficient bayesian inference framework for coalescent - based nonparametric phylodynamics .",
    "_ bioinformatics _ , 31:0 32823289 , 2015 .",
    "b.  leimkuhler and s.  reich .",
    "_ simulating hamiltonian dynamics _ ,",
    "volume  14 .",
    "cambridge university press , 2004 .",
    "p.  marjoram and j.  wall .",
    "fast `` coalescent '' simulation . _ bmc genetics _ , 70 ( 1 ) , 2006 .",
    "v.  n. minin , e.  w. bloomquist , and m.  a. suchard .",
    "smooth skyride through a rough skyline : bayesian coalescent - based inference of population dynamics . _ molecular biology and evolution _ , 250 ( 7):0 14591471 , 2008 .",
    "i.  murray , r.p .",
    "adams , and d.  mackay .",
    "elliptical slice sampling . in _",
    "international conference on artificial intelligence and statistics _ , pages 541548 , 2010 .",
    "r.  m. neal .",
    "using hamiltonian dynamics . in s.  brooks , a.  gelman , g.  jones , and x.l .",
    "meng , editors , _ handbook of markov chain monte carlo _ , pages 113162 .",
    "crc press , 2011 .",
    "j.  a. palacios and v.  n. minin .",
    "integrated nested laplace approximation for bayesian nonparametric phylodynamics . in",
    "_ proceedings of the twenty - eighth international conference on uncertainty in artificial intelligence _ , pages 726735 , 2012 .",
    "j.  a. palacios and v.  n. minin .",
    "gaussian process - based bayesian nonparametric inference of population size trajectories from gene genealogies .",
    "_ biometrics _ , 690 ( 1):0 818 , 2013 .",
    "j.  a. palacios , j.  wakeley , and s.  ramachandran .",
    "bayesian nonparametric inference of population size changes from sequential genealogies .",
    "_ genetics _",
    ", page 115 , 2015 .",
    "e.  paradis , j.  claude , and k.  strimmer .",
    "ape : analyses of phylogenetics and evolution in r language . _ bioinformatics _ , 20:0 289290 , 2004 .",
    "g.  o. roberts and r.  l. tweedie . exponential convergence of langevin distributions and their discrete approximations .",
    "_ bernoulli _ , pages 341363 , 1996 .",
    "b.  shahbaba , s.  lan , w.  o. johnson , and r.  m. neal . split hamiltonian monte carlo . _",
    "statistics and computing _ , 240 ( 3):0 339349 , 2014 .",
    "` phylodyn ` is available at https://github.com/mdkarcher/phylodyn .",
    "installation instructions are provided in the readme file .",
    "several vignettes have been included to walk users through the standard workflow , as well as a number of example datasets from the papers that introduced the methods included in the r package ."
  ],
  "abstract_text": [
    "<S> we introduce ` phylodyn ` , an r package for phylodynamic analysis based on gene genealogies . the package main functionality is bayesian nonparametric estimation of effective population size fluctuations over time . </S>",
    "<S> our implementation includes several markov chain monte carlo - based methods and an integrated nested laplace approximation - based approach for phylodynamic inference that have been developed in recent years . </S>",
    "<S> genealogical data describe the timed ancestral relationships of individuals sampled from a population of interest . here , individuals are assumed to be sampled at the same point in time ( isochronous sampling ) or at different points in time ( heterochronous sampling ) ; in addition , sampling events can be modeled with preferential sampling , which means that the intensity of sampling events is allowed to depend on the effective population size trajectory . </S>",
    "<S> we assume the coalescent and the sequentially markov coalescent processes as generative models of genealogies . </S>",
    "<S> we include several coalescent simulation functions that are useful for testing our phylodynamics methods via simulation studies . </S>",
    "<S> we compare the performance and outputs of various methods implemented in ` phylodyn ` and outline their strengths and weaknesses . </S>",
    "<S> r package ` phylodyn ` is available at https://github.com/mdkarcher/phylodyn .    ` </S>",
    "<S> phylodyn ` : an r package for phylodynamic simulation and inference +   +   michael d. karcher^1*^ , julia a. palacios^2,3^ , shiwei lan^4^ , vladimir n. minin^1,5^ + ^1^department of statistics , university of washington , seattle , wa , usa + ^2^department of statistics , stanford university , stanford , ca , usa + ^3^department of biomedical data science , stanford university , stanford , ca , usa + ^4^department of statistics , university of warwick , coventry , uk + ^5^department of biology , university of washington , seattle , wa , usa + </S>"
  ]
}