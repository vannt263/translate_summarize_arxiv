{
  "article_text": [
    "we thank b.  kuhlmey for helpful discussions and t.  mcrae for help with imaging .",
    "we acknowledge support by the arc discovery and federation fellow programs and an iarpa - funded aro contract .",
    "for type - ii up- or down - conversion , the evolution inside the crystal is governed by the operator @xmath39 where @xmath40 is the time - ordering operator and @xmath41 is the multimode hamiltonian @xcite , where @xmath42 , @xmath37 is the length of the crystal , @xmath43 is a constant proportional to the nonlinearity and @xmath44 is the phase mismatch .",
    "typically , the nonlinearity does not vary over the length of the crystal and we can rewrite the spatial integral @xmath45 as the fourier transform ( ft ) of a rectangular function @xmath46 , where @xmath47 and @xmath48 is the heaviside step function . evaluating the spatial integral yields",
    "the result @xmath49 where @xmath50 , giving rise to the following form for the hamiltonian @xmath51 where @xmath52 is the phase - matching function .",
    "note that by picking the spatial integration to be centered around @xmath53 , it is possible to eliminate a phase term which would normally be present in equation ( [ eq : ham ] ) .",
    "for a periodically poled crystal the phase mismatch , @xmath54 , includes the effect of the periodic domain inversion in qpm .",
    "the purpose of this domain inversion is to undo the @xmath55where @xmath2 is an odd integer ",
    "phase error accumulated by the pump and downconverted fields , by introducing an additional @xmath56 phase shift to @xmath11 at the point of inversion . for successful qpm",
    ", the poling period therefore has to fulfil the condition @xmath57 , where @xmath2 is the qpm order .",
    "taking the first order term of the taylor series expansion of @xmath58 and evaluating the time and pump frequency integrals yields the two - photon state @xmath59 where @xmath60 and @xmath61 .",
    "to tailor the crystal nonlinearity , we treat each crystal section @xmath62 as a rectangular function with a nonlinearity inversely proportional to the poling order @xmath63 . the nonlinearity profile for the custom - poled crystal",
    "is then given by @xmath64 where @xmath48 is the heaviside step function , @xmath65 is the poling order of the @xmath66th section , @xmath67 is the number of domains within the @xmath66th section and @xmath68 m , for type - ii , first - order qpm of @xmath69  nm@xmath70  nm@xmath71  nm . the profile @xmath16 is plotted in fig .",
    "[ fig : prob2ext]a ) .",
    "the design of the nonlinearity profile is subject to two constraints .",
    "first , the nonlinearity of each section is limited to discrete values proportional to @xmath72 .",
    "larger values of @xmath2 provide smoother transitions between successive nonlinearites , however this leads to a greatly reduced photon creation rate .",
    "second , the width of each section must be an integer number of @xmath73 and a minimum of @xmath74 , therefore , larger values of @xmath2 may demand prohibitively long sections .",
    "the ratio between positively and negatively poled regions  known as the duty cycle @xmath75 where @xmath76 is the length over which the sign of the nonlinear coefficient remains constant  was chosen to be @xmath77 for odd values of @xmath2 and as close as possible to @xmath77 for even values , as is shown in fig . [",
    "fig : experiment]c ) .    while the model presented here",
    "is not strictly valid due to the small number of domains within each section of @xmath16 , modeling at the domain level , appendix [ sec : detailed_model ] , shows good agreement with the basic model in the frequency range over which the detectors are sensitive .",
    "the edges of the spectral response function of the detectors used in this experiment lie in the region of negligible amplitude and , as opposed to spectral filters , will not give rise to the photon - number mixing described in @xcite .",
    "to determine the exact shape of the target gaussian function for the nonlinearity profile , we match the width of the desired gaussian pmf with the sinc pmf of the form , @xmath78 , that would be generated by a standard crystal .",
    "the appropriate function is @xmath79 where the parameter @xmath80 is derived from matching the fwhm of the two functions .",
    "we refer to @xmath81 as the _ effective _ length , as it does not correspond to the actual length of the final gaussian shaped crystal , but rather the length of the hypothetical standard crystal .",
    "we modeled each section of the crystal as having a nonlinearity inversely proportional to the poling order @xmath2 .",
    "this approximation is only valid for a large number of domains in each section .",
    "here we calculate the pmf by explicitly considering the contribution from each domain .",
    "the nonlinearity profile @xmath82 will consist of domains of nonlinear coefficients @xmath83 , with sign changes occurring at positions corresponding to the poling order and duty cycle ( this is the case for the entire length of a typical periodically poled crystal ) .",
    "for example , in the section corresponding to @xmath84 , where the duty cycle is @xmath77 , the sign changes every @xmath85 , while for @xmath86 , where the duty cycle is @xmath87 , the sign changes from `` @xmath88 '' to `` @xmath89 '' after @xmath90 and back again after @xmath91 .",
    "the resulting pmf takes the form @xmath92 where @xmath93 is the sign of the @xmath94th domain and @xmath95 is the width of each domain .",
    "figure  [ fig : comp_zoom ] shows that as @xmath96 departs from @xmath97 , the two models begin to deviate .",
    "however , as we discuss in the main text , there is very good agreement between the basic and detailed models in the region of interest , i.e. around @xmath98 .",
    "downconverted single - photons have strong spectral correlations which result in the degraded purity of a heralded state .",
    "a growing effort in engineering pulsed downconversion sources to produce spectrally decorrelated photons includes manipulating the crystal length , material , bandwidth and central frequency @xcite as well as filtering the pump field , prior to down - conversion , using an optical cavity @xcite .",
    "another method imposes group - velocity matching to limit these unwanted correlations @xcite .",
    "however , the presence of side lobes  which arise from the sinc shape of the pmf  still calls for some level of filtering in order to achieve high - purity single photons .",
    "spectral filtering is undesirable because it lowers the overall single - photon production rate as well as introducing photon - number mixedness which limits the allowable pump intensity @xcite .",
    "we show that , in combination with our method of modulating the crystal nonlinearity , group velocity matching can be used to create high - purity single photon states without the use of spectral filtering . setting the relationship between the group velocities of the three interacting fields such that @xmath99 and picking the length of the crystal to be @xmath100 ( where @xmath101 is the pump width in s@xmath102 and @xmath103 is defined below ) generates a joint spectral amplitude ( jsa ) , where both signal and idler modes have equal bandwidths . for a type - ii ppktp crystal",
    ", this corresponds to a crystal length @xmath104 mm and a periodicity of @xmath105 , pumped with a @xmath31 nm laser with a 0.7 nm fwhm which down converts to @xmath106 nm in the signal and idler modes .",
    "however , for a standard crystal of constant nonlinearity , this will not result in completely pure states being generated , due to the side lobes in the sinc function .",
    "to eliminate the side lobes , we want to generate a gaussian pmf , @xmath107 , whose fwhm matches that of the pmf generated by a standard crystal , @xmath108 . substituting @xmath109 as the pmf , we can now write the jsa as @xmath110 which , due to the rotational symmetry of the two - dimensional gaussian function , is separable , i.e. @xmath111",
    "we numerically compare two designs for cpktp crystals , fig .",
    "[ fig : pure_photons ] , with a standard ppktp crystal following @xcite .",
    "the results are summarised in table i in the main text .",
    "the method introduced in this paper can be applied to the generation of almost arbitrarily shaped pmfs . as described above",
    ", the nonlinearity profile of the crystal should be tailored to the fourier transform of the desired pmf .",
    "figure [ fig : shapes ] show examples of triangular and square shaped phase matching functions , as well as the required nonlinearity profile .",
    "negative values of the nonlinearity , which are required to generate the square shape , can be implemented by inverting the relevant domain ."
  ],
  "abstract_text": [
    "<S> many applications in optical quantum information processing benefit from careful spectral shaping of single - photon wave - packets . in this paper </S>",
    "<S> we tailor the joint spectral wave - function of photons created in parametric downconversion by engineering the nonlinearity profile of a poled crystal . </S>",
    "<S> we design a crystal with an approximately gaussian nonlinearity profile and confirm successful wave - packet shaping by two - photon interference experiments . </S>",
    "<S> we numerically show how our method can be applied for attaining one of the currently most important goals of single - photon quantum optics , the creation of pure single photons without spectral correlations .    </S>",
    "<S> spontaneous parametric downconversion is a nonlinear optical process in which a photon from a pump laser , incident on a nonlinear birefringent crystal , converts into two single photons under conservation of energy and momentum . </S>",
    "<S> photon sources based on this phenomenon are an ubiquitous tool for quantum computation @xcite , quantum communication @xcite and quantum metrology @xcite . </S>",
    "<S> they are also becoming increasingly important in more specialised applications such as quantum imaging @xcite , quantum lithography @xcite or optical coherence tomography @xcite . </S>",
    "<S> as these experiments evolve , more stringent requirements are placed on the characteristics of the quantum state of emitted light . in particular , to produce high - purity heralded , or even near deterministic single photons , the spectral shape and correlations of the created photon pairs must be carefully engineered .    the most common method for spectral engineering is filtering , however , this can lead to loss and mixing . </S>",
    "<S> a more sophisticated method involves shaping the spectrum at the source . </S>",
    "<S> consider downconversion in a quasi - phasematched ( qpm ) crystal with a poling period @xmath0 @xcite , where the crystal domain is inverted whenever the pump and downconversion fields acquire a phase mismatch @xmath1where @xmath2 is an odd integer  allowing phase - matching of a wide range of wavelengths in different nonlinear materials . </S>",
    "<S> there are several methods to control the joint spectral amplitudes of photons created in downconversion in a qpm crystal @xcite . </S>",
    "<S> for example , imposing a linear chirp on the poling period @xmath0 has been used for the generation of ultra - broad - spectrum , top - hat shaped photons @xcite for optical coherence tomography . </S>",
    "<S> however , the currently known methods involve changing @xmath0 , which may be incompatible with stringent phasematching conditions .    in this paper </S>",
    "<S> , we consider type - ii downconversion in a qpm crystal with a longitudinally non - uniform grating . </S>",
    "<S> we can synthesise photon pairs with arbitrary spectral amplitudes by modulating the nonlinearity profile @xmath3 of a crystal through different - order poling _ without _ changing the phase - matching conditions . </S>",
    "<S> we tailor a spectral photon - pair amplitude with an approximately gaussian profile , which is critical for high purity photon generation , as we will discuss later . </S>",
    "<S> in addition , gaussian spectra are known to be optimal for temporal mode matching @xcite  a critical consideration in any experiment involving single photons .    </S>",
    "<S> theoretically , the two - photon component of the optical state is described by @xcite @xmath4 where @xmath5 is the joint spectral amplitude of the created photons in the _ idler _ and _ signal _ modes respectively ( for details , refer to appendix [ sec : hamiltonian ] ) . </S>",
    "<S> the spectral properties of downconverted photons can be manipulated via the pump envelope function @xmath6 @xcite , or as we show here , the phase matching function ( pmf ) @xmath7 . </S>",
    "<S> we use a monochromatic pump @xmath8 where @xmath9 is the pump frequency , and directly tailor @xmath10 which is the fourier transform of @xmath3 and @xmath11 is the phase mismatch .    according to equation [ eq : phi ] , </S>",
    "<S> the phase matching function of a standard crystal with a uniform nonlinearity profile is @xmath12 . </S>",
    "<S> however , to generate a gaussian phase matching function , we require a crystal with a gaussian nonlinearity . while it is non - trivial to directly change the material properties , we can make use of higher - order poling to realise a variety of nonlinearity strengths . in a poled structure , </S>",
    "<S> the _ effective _ nonlinearity scales with the poling order @xmath2 as @xmath13 . for odd @xmath2 , </S>",
    "<S> @xmath2th order qpm can be achieved by reversing the direction of the poling every @xmath2 coherence lengths , defined as @xmath14 . </S>",
    "<S> even - order qpm can be achieved by combining two odd orders .        </S>",
    "<S> we exploited this feature to design a crystal consisting of a number of discrete sections , each with a different @xmath15 , discretely approximating the desired gaussian shape , and custom - poled a 10 mm long potassium titanyl phosphate ( cpktp ) crystal accordingly . </S>",
    "<S> details on the actual design of our tailored crystal can be found in appendix [ sec : tailoring ] . </S>",
    "<S> our technique decreases the overall nonlinearity and reduces the _ effective _ length of the structure , appendix [ sec : gauss_approx ] . </S>",
    "<S> we therefore expect less photon - pair yield and broader bandwidths when compared to a standard periodically poled ktp ( ppktp ) with the same length and phase - matching .    </S>",
    "<S> fig . </S>",
    "<S> [ fig : prob2ext]a ) shows the tailored nonlinearity profile @xmath16 , defined in eq . </S>",
    "<S> ( [ eq : chi_m ] ) in appendix [ sec : tailoring ] , together with the target gaussian profile @xmath17 . </S>",
    "<S> the corresponding pmf , obtained from the inverse fourier transform of @xmath16 , is very similar to a gaussian function , as shown in fig .  </S>",
    "<S> [ fig : prob2ext]b ) . compared to the sinc - shaped phase matching function of a ppktp of the same </S>",
    "<S> _ effective _ length as the cpktp ( 5.67 mm ) , the side lobes on either side of the central peak are significantly suppressed . </S>",
    "<S> this becomes even more evident when considering the spectral intensity ( see inset ) .    a microscopic image of part of the custom - poled ktp ( cpktp ) crystal is shown in fig .  </S>",
    "<S> [ fig : prob2ext]c ) . </S>",
    "<S> one can clearly see the individual sections with different poling orders , which line up with the theoretical design almost perfectly . </S>",
    "<S> fig .  </S>",
    "<S> [ fig : prob2ext]d ) shows a magnified view of a transition between poling - order sections @xmath18 and @xmath19 .    </S>",
    "<S> we tested our custom - poled crystal in a typical downconversion setup , see fig .  </S>",
    "<S> [ fig : experiment]a ) , comparing it to a @xmath20  mm long ppktp crystal ( @xmath21 m ) . due to the reduced overall effective nonlinearity </S>",
    "<S> , we expect a relative photon pair rate of @xmath22 . </S>",
    "<S> the measured rate ( detected without a beam - splitter ) was @xmath23  kpairs / s for the custom - poled and @xmath24  kpairs / s for the standard crystal , respectively . </S>",
    "<S> this corresponds to a relative yield of @xmath25 ; we attribute the small reduction in efficiency to the fact that the custom - poled crystal , in contrast to our standard crystal , was not anti - reflection coated .        </S>",
    "<S> we verified the spectral amplitude of bi - photons created in the cpktp in a two - photon interference experiment . </S>",
    "<S> when two indistinguishable photons mix on a symmetric beamsplitter , they will always be found in the same output port . </S>",
    "<S> this phenomenon was first reported in the landmark experiment by hong , ou and mandel @xcite , who observed a dip in the photon - pair detection probability as a function of the temporal delay between the input photons . </S>",
    "<S> theoretically , the shape of this coincidence dip assumes the inverted fourier transform of the absolute square of the pmf , which can be readily calculated from the two - photon state in eq . </S>",
    "<S> ( [ eq : spdc - state ] ) , see @xcite .    </S>",
    "<S> the recorded interference patterns for the cpktp , and the standard ppktp are shown in fig . </S>",
    "<S> [ fig : experiment]b ) , along with the theoretical interference patterns calculated straight from the pmfs in fig .  </S>",
    "<S> [ fig : prob2ext]b ) . </S>",
    "<S> the bandwidth difference results from the different _ effective _ lengths of the two crystals . the interference pattern for the standard crystal is triangular , just as expected for the sinc - shaped pmf @xcite . </S>",
    "<S> the pattern for the custom - poled crystal departs from the triangular shape and indeed approximates a gaussian . </S>",
    "<S> the interference visibility was @xmath26 for both crystals , confirming that the indistinguishability of the downconverted photons was not compromised by the crystal modulation .    to further explore the underlying spectral correlations in the pmf , we measured spatial quantum beating patterns . </S>",
    "<S> we detuned the center frequencies of the downconversion photons via a change in crystal temperature away from its optimal value for collinear , degenerate quasi - phasematching and again observed two - photon interference @xcite . </S>",
    "<S> the results in fig .  </S>",
    "<S> [ fig : experiment]c ) show that the custom - poled crystal exhibits less distinct beating , in particular , less anti - bunching , i.e. coincidence probability values above the random level of @xmath27 . </S>",
    "<S> the maximum value for the cpktp was @xmath28 compared to @xmath29 for the standard crystal , a significant reduction relative to the base - line of @xmath27 . </S>",
    "<S> the theory values for the ppktp were adopted from @xcite directly . for the cpktp we repeated the calculation in @xcite using the respective custom pmf shown fig . </S>",
    "<S> [ fig : prob2ext]b ) .    </S>",
    "<S> the observed anti - bunching occurs when the frequency - detuned spectral wavefunction ( i.e. the joint spectral amplitude ) of the two - photon state is partially anti - symmetric , which in turn reveals the frequency entanglement intrinsic to downconversion @xcite . </S>",
    "<S> a gaussian spectral amplitude is always positive and therefore does not have anti - symmetric components , which explains the significantly reduced beating in the interference patterns of the custom - poled crystal . </S>",
    "<S> all measured interference patterns for our custom crystal agree exceedingly well with the patterns calculated from the theoretic pmf .    </S>",
    "<S> one situation in which this method will be useful is the generation of pure heralded single photons . </S>",
    "<S> even in a group - velocity - matched configuration with a symmetric joint spectral amplitude , the maximum purity of the heralded single photon state is , due to the pmf sinc profile @xcite , limited to @xmath30 ( for ppktp with a @xmath31 nm pump @xcite without spectral filtering ) . </S>",
    "<S> this purity affects the two - photon interference visibility between heralded single photons and thus ultimately the quality of optical quantum gates or multi - photon states generated in post - selection . </S>",
    "<S> we numerically compare two designs for cpktp crystals ( see appendix [ sec : crystal_design ] ) , characterised by their maximum poling order ( @xmath18 and @xmath19 ) , with a standard ppktp crystal following @xcite . </S>",
    "<S> table [ tab : compare crystals ] shows the calculated purities for our two designs compared with a standard crystal . </S>",
    "<S> taking @xmath32 yields a coarse approximation to the gaussian function , but the purity @xmath33 improves substantially to @xmath34 . </S>",
    "<S> a better approximation to the gaussian is achieved if @xmath35 , then @xmath36 . for further detail , refer to appendix [ sec : crystal_design ] .    </S>",
    "<S> .numerical comparison of the purity @xmath33 of heralded single - photons of a standard crystal and two cpktp crystals of length @xmath37 , in a group - velocity - matched scenario . </S>",
    "<S> the effective length of both cpktp crystals is @xmath38 mm . </S>",
    "<S> [ cols=\"^,^,^,^,^\",options=\"header \" , ]     [ tab : compare crystals ]    in conclusion , we demonstrated longitudinal shaping of single - photon wave - packets via indirect modulation of the nonlinearity of a crystal . </S>",
    "<S> our method can be used to generate other spectral profiles of interest , such as a triangle or a top - hat , see appendix [ sec : other_pmf ] . </S>",
    "<S> a comb - like nonlinearity structure , for example , would allow the direct , lossless generation of frequency - bin qubits @xcite . </S>",
    "<S> in addition , the custom - poled crystals can be used in single - crystal sources for polarization entanglement , such as the sagnac - type confgurations reported in @xcite , or even in a single - pass scheme , combined with the related technique of using two interlaced first - order poling periods for concurrent type - ii downconversion of frequency non - degenerate photons @xcite . </S>",
    "<S> furthermore , we expect this technique to have applications in classical nonlinear optics , e.g. , in second harmonic generation , similar to the spectral shaping techniques previously demonstrated for this regime @xcite .    </S>",
    "<S> since our technique allows manipulation of the phasematching profile , it complements group - velocity matching , which is commonly achieved by controlling the orientation and width of the phasematching function . </S>",
    "<S> a gaussian shape vastly improves the purity of heralded photons from spdc . </S>",
    "<S> the inevitable reduction in the effective nonlinearity is an acceptable tradeoff given that modern crystals have drastically reduced pump power requirements . </S>",
    "<S> in addition , compared to the alternative of spectral filtering , one can actually pump at a much higher power without introducing photon number mixedness . </S>",
    "<S> this allows the creation of purer multi - photon states for quantum information processing , e.g. fock states with high photon number @xcite </S>",
    "<S> .    it will be worthwhile to consider nonlinearity engineering for four - wave - mixing photon - pair sources in photonic - crystal fibres , where the sinc - shaped phase - matching function has been identified as a major problem @xcite . </S>",
    "<S> however , group - velocity matching in these materials is already a non - trivial task which will inevitably be further complicated by modulation of the non - linearity . </S>"
  ]
}