{
  "article_text": [
    "in molecular dynamics simulations the force evaluation consumes by far the most computational resources . for relatively short - ranged interactions like van der waals interaction  @xcite it is common to introduce a cutoff radius @xmath0 such that if the distance between a particle pair exceeds @xmath0 , the particles do not interact  @xcite .",
    "this truncation allows for different optimization methods like inclusion of cell and neighbor lists  @xcite , which increase computational performance considerably .",
    "traditionally , the pair potential is simply truncated and shifted such that it is zero at @xmath0 @xcite .",
    "this does not affect the force acting between particles at distances below @xmath0 , and if @xmath0 is sufficiently large , the fluid properties are virtually unaffected by this approximation .",
    "in fact , it has been shown  @xcite that keeping merely the short - ranged , purely repulsive part of the van der waals interaction can account for the fluid structure even near the critical point where correlations are long ranged .",
    "the truncated and shifted potential approximation ensures continuity of the potential energy , but introduces a discontinuity in the force at @xmath0 , leading to energy drift for long simulation times  @xcite . to overcome this one",
    "can instead apply a truncated and shifted force ( sf ) approximation  @xcite , which has superior numerical stability  @xcite . beside the numerical stability ,",
    "it was recently shown by toxvaerd and dyre  @xcite that for highly dense fluids the sf method allows for very small cut - off radius of @xmath1 ( where @xmath2 is the atomic diameter ) and corresponds approximately to the first local minimum in the radial distribution function .",
    "applying such low cutoff to the truncated and shifted potential will lead to wrong physics and large energy drift  @xcite .",
    "the sf method therefore decreases the number of interactions significantly and thus the computational time .",
    "the potential corresponding to the sf interaction does however not match the original potential for @xmath3 from which the sf interaction was derived .",
    "therefore , the thermodynamical properties can not be compared directly , but can be derived from perturbation theory  @xcite .    for long - ranged interactions , like the coulomb interaction",
    ", one can not simply introduce a standard cut and shifted potential .",
    "for example , simply truncating and shifting the coulomb potential produces spurious fluid structure and wrong dynamics  @xcite .",
    "numerous attempts have been made to overcome this problem .",
    "for example it has been suggested to use smoothing functions , but this leads in general to poor results , see refs .  .",
    "et al . _",
    "@xcite cleverly showed that using a simple truncated and shifted coulomb potential corresponds in practice to summing over interactions in a non - neutral sphere . to compensate for this",
    "these authors introduced a neutralizing term into the coulomb potential ; they further showed that faster convergence to the true energy is achieved by applying a damping factor @xmath4 .",
    "the wolf method is computationally much faster than the classical ewald summation technique and is today widely used within the scientific simulation community .",
    "the choice of the damping factor , @xmath4 , is , like the ewald damping parameter  @xcite , somewhat arbitrary , and the optimal value must be found by comparison with either experimental data or results from , e.g. , the ewald method  @xcite .",
    "if the wolf damping parameter @xmath4 is zero , the wolf method reduces to the sf approximation  @xcite , see also denesyuk and weeks  @xcite for a discussion .",
    "we note that an sf method for the coulomb interactions was used as a clever trick in the biochemical simulation community  @xcite before the work by wolf _",
    "et al._.    in this paper we apply the wolf method in molecular dynamics simulations of a simple model of a molten salt and liquid water .",
    "in order to find the optimal value of the wolf damping parameter @xmath4 we compare the simulated thermodynamical , dynamical , and structural properties with previously published results  @xcite based on the ewald method .",
    "we show that the optimal value of @xmath4 depends on the property one wishes to calculate and the cutoff distance used .",
    "this sets the stage for documenting the main conclusion of this paper : for the systems studied here the sf approximation works as well as the wolf method , confirming similar findings of fennell and gezelter  @xcite .",
    "besides being conceptual simpler than the wolf method , the sf method allows for more than a doubling of the computational speed .",
    "if @xmath5 is the distance between two particles , the force acting on one particle from the other is @xmath6 , where @xmath7 is for simplicity denoted the `` force '' and is minus the derivative of the corresponding potential function with respect to @xmath5 . for the wolf method  @xcite the force",
    "is given by @xmath8 \\ , \\",
    ",      \\label{eq : wolf}\\end{aligned}\\ ] ] for @xmath3 and where @xmath9 is the complementary error function . here",
    "@xmath10 and @xmath11 are the charges of the two particles in question , @xmath0 is the cutoff ( i.e. , @xmath12 for @xmath13 ) , and @xmath4 is the wolf damping parameter . in the paper by wolf _",
    "_ it is implicitly understood that @xmath14 such that the cutoff only takes effect beyond range of damping .",
    "the damping parameter was introduced in order to ensure faster convergence to the limiting madelung energy  @xcite .",
    "unfortunately , there is no theoretical prediction for the optimal value of @xmath4 , which must be found by comparison with other well - established methods like the ewald summation method  @xcite .",
    "et al . _",
    "@xcite and demontis _ et al . _",
    "@xcite have shown via molecular dynamics simulations that the wolf method reproduces the results obtained by the ewald summation method for @xmath15 , where @xmath16 is the distance between oppositely charged particles in the first coordinate shell .",
    "et al . _",
    "@xcite also suggested that the optimal damping parameter is given by @xmath17 for sufficiently large systems .    from eq .",
    "( [ eq : wolf ] ) it follows that for @xmath18 one has @xmath19 , and that for @xmath20 the force reduces to @xmath21 this is the truncated and shifted force ( sf ) cutoff @xcite .    in fig .",
    "[ fig:0](a ) we plot the difference between the wolf force , @xmath22 , and the corresponding coulomb force , @xmath23 , for different damping parameters .",
    "[ color online ] ( a ) : difference between the wolf force , @xmath24 , and the coulomb force , @xmath25 , for @xmath26 and 1.0 . in all graphs",
    "the cutoff is given by @xmath27 .",
    "( b ) : the measure of the difference between the true coulomb force and the wolf force , @xmath28 , defined in eq .",
    "( [ eq : minerr ] ) plotted as a function of @xmath4 for three different cutoffs .",
    "the inset shows the optimal value of @xmath4 plotted as a function of @xmath0 .",
    ", title=\"fig : \" ] +   [ color online ] ( a ) : difference between the wolf force , @xmath24 , and the coulomb force , @xmath25 , for @xmath26 and 1.0 .",
    "in all graphs the cutoff is given by @xmath27 .",
    "( b ) : the measure of the difference between the true coulomb force and the wolf force , @xmath28 , defined in eq .",
    "( [ eq : minerr ] ) plotted as a function of @xmath4 for three different cutoffs .",
    "the inset shows the optimal value of @xmath4 plotted as a function of @xmath0 .",
    ", title=\"fig : \" ]    clearly the damping parameter has a non - trivial effect on the force . for @xmath29",
    "the difference is small compared to large values of @xmath4 , suggesting that the sf cutoff , eq .",
    "( [ eq : sf ] ) , gives a good approximation to the coulomb interaction . from fig .",
    "[ fig:0](a ) it is seen that an optimal value of @xmath4 exists that minimizes the difference . one way to identify this optimal value",
    "is by minimizing the function @xmath30 which measures the total relative difference between @xmath31 and @xmath32 such that @xmath33 ( since @xmath34 for all @xmath5 ) . in fig .",
    "[ fig:0](b ) @xmath28 is plotted for three different cutoff distances .",
    "the optimal wolf damping parameter converges to zero as @xmath0 increases , which reflects the simple fact that @xmath35 for @xmath36 and @xmath20 .",
    "more interestingly , the quantity @xmath28 does exhibit very little difference between the optimal value of @xmath4 and @xmath29 .",
    "the inset in fig .",
    "[ fig:0](b ) shows that the optimal wolf parameter determined by the minimum of eq .",
    "( [ eq : minerr ] ) is given roughly by @xmath37 .",
    "this simple analysis is consistent with the @xmath0 dependence suggested by demontis _",
    "et al . _",
    "@xcite based of molecular dynamics simulations ( but they predict a smaller estimate of @xmath4 by a factor of 3/8 ) .",
    "the conclusion from fig .",
    "[ fig:0 ] is that setting @xmath29 , i.e. , adopting the sf approximation , gives results that are close to those obtained by carefully optimizing @xmath4 .",
    "this and the recent work by toxvaerd and dyre  @xcite motivate the below reported molecular dynamics simulations , which compare the wolf method to the sf cutoff for other quantities and realistic systems .",
    "as `` truth '' we take the well - established , but computationally expensive , ewald summation method .",
    "a series of molecular dynamics simulations was performed of a model molten salt proposed by hansen and mcdonald  @xcite .",
    "briefly , in this two - component model the ions are simple spherical particles that interact via a coulomb potential and a van der waals type potential given by the inverse power law @xmath38 , where @xmath39 , @xmath40 defines the energy scale and @xmath2 is the usual lennard - jones length scale parameter  @xcite .",
    "we refer the reader to the reference for the full details . in the simulations we applied the wolf method and varied the cutoff between 2.5 and 8.0 @xmath2 .",
    "the simulation box used was twice the size of the cutoff whenever @xmath41 ; for smaller cutoffs the box length was fixed to 8.36 @xmath2 .",
    "the number density for all systems were @xmath42 , thus , the number of ions varied from 216 to 1508 .",
    "the results presented below were found to be independent of system size .",
    "the temperature @xmath43 is controlled using a nos - hoover thermostat  @xcite with @xmath44 .",
    "the results are compared to previously published data where the ewald summation method was used  @xcite , which represent the `` true '' coulomb interaction .",
    "first , in fig .",
    "[ fig:1 ] ( a ) we compare the total potential energy obtained from the wolf method @xmath45 for three different cutoff radii and varying damping parameters with the potential energy @xmath46 from the ewald summation method .",
    "we note that @xmath45 is obtained directly from the wolf potential function@xcite corresponding to the force given in eq .",
    "( [ eq : wolf ] ) .",
    "[ color online ] ( a ) : comparison of the potential energy of the hansen - mcdonald molten salt model for varying damping parameter .",
    "error bars represent the standard error of ten independent runs .",
    "@xmath46 is found in ref .  .",
    "( b ) : radial distribution functions for unlike charged particles ( lines ) for @xmath47 ( the sf approximation ) and @xmath48 and for @xmath49 and @xmath50 .",
    "the filled black squares are data points taken from ref .  .",
    ", title=\"fig : \" ] +   [ color online ] ( a ) : comparison of the potential energy of the hansen - mcdonald molten salt model for varying damping parameter .",
    "error bars represent the standard error of ten independent runs .",
    "@xmath46 is found in ref .  .",
    "( b ) : radial distribution functions for unlike charged particles ( lines ) for @xmath47 ( the sf approximation ) and @xmath48 and for @xmath49 and @xmath50 .",
    "the filled black squares are data points taken from ref .  .",
    ", title=\"fig : \" ]    it is observed that @xmath45 is within the statistical uncertainty equal to @xmath46 for sufficiently small damping parameters , even for quite small cutoffs .",
    "this could lead to the conclusion that the wolf method accounts correctly for electrostatic interactions for small cutoff distances .",
    "however , if one plots the radial distribution function @xmath51 , fig .",
    "[ fig:1](b ) , we see that for @xmath52 the structure differs significantly from the result obtained using the ewald summation method .",
    "this is true for all values of the damping parameter . from fig .",
    "[ fig:1](b ) we also notice that the sf approximation captures the structural properties correctly for @xmath53 , which is the smallest cutoff distance meeting the wolf _ et al .",
    "_  @xcite and demontis _ et al . _",
    "@xcite criterion @xmath54 .",
    "we study the radial distribution function dependence of @xmath0 and @xmath4 by defining the error parameter @xmath55 via @xmath56 where @xmath57 is the radial distribution function for unlike charged particles of the wolf method and @xmath58 the radial distribution function produced by the ewald summation method .",
    "similarly , the following error parameter @xmath59 quantifies the difference in diffusion constant @xmath60 where @xmath61 and @xmath62 are the diffusion constants obtained from the wolf and ewald methods , respectively .",
    "note that @xmath63 , whereas @xmath59 can be negative .",
    "the `` correct '' radial distribution function , @xmath58 , and diffusion constant , @xmath62 , were taken from ref .  .",
    "figure [ fig:2 ] shows the two error parameters for different cutoff radii and damping .",
    "the damping parameter @xmath64 was chosen because @xmath55 exhibits a minimum for this value for a large range of cutoffs .",
    "this is not the case for @xmath59 , however , which features a minimum for lower values of the damping parameter , depending on the cutoff ( as expected from fig .",
    "[ fig:0 ] ( b ) ) .",
    "this inconsistency is illustrated in the inset in which the error parameters are shown for @xmath65 as functions of @xmath4 .",
    "obviously , any @xmath66 may be chosen to minimize @xmath59 , whereas @xmath55 features a minimum for @xmath67 .",
    "we note that @xmath68 and the cutoff radius fulfills the criterion defined by wolf _",
    "et al . _ and demontis _",
    "et al._.     [ color online ] error parameters as a function of cutoff for different damping parameter for the hansen and mcdonald molten salt system .",
    "the inset shows the error parameters for @xmath65 as functions of @xmath4 . ]    from fig .",
    "[ fig:2 ] it is seen that @xmath55 is relatively large for small cutoffs ( as expected ) , but that it for non - zero damping parameters quickly decreases and reaches almost zero for @xmath69 . for the sf approximation one needs @xmath70 in order to obtain the same accuracy in the radial distribution function . for large cutoffs the sf approximation results in better diffusion constants than the wolf method with @xmath71 .",
    "we could , of course , have optimized @xmath4 with respect to the diffusion constant ( giving @xmath72 for a large range of cutoffs ) .",
    "this , however , would decrease the agreement for the radial distribution function .",
    "this fact is highlighted in table i , where the error parameters are listed for values of @xmath4 optimized , respectively , with respect to the diffusion constant and the radial distribution function ( @xmath73 ) .",
    "for comparison we also give the error parameters for the sf approximation .",
    ".[table:1 ] error parameters , @xmath59 and @xmath55 , for different values of the damping parameter .",
    "@xmath74 and @xmath71 correspond to the optimized values with respect to diffusion and radial distribution function , respectively .",
    "@xmath75 corresponds to the sf approximation . [",
    "cols=\"<,^,^,^,^\",options=\"header \" , ]     within the statistical uncertainty there is no difference between the wolf method using @xmath76 and the sf approximation .",
    "up to this point we have only discussed the structural and diffusive properties in the long time limit . to compare the short - time dynamics of the two methods we plot the velocity autocorrelation function @xmath77 and the intermediate scattering function in fig .",
    "[ fig:3 ] .",
    "[ color online ] ( a ) : normalized velocity autocorrelation function for the wolf and the sf methods .",
    "only the short time data are shown .",
    "the error bars are comparable to the size of symbols .",
    "( b ) : coherent intermediate scattering function for wave - length @xmath78 and @xmath79 .",
    "the horizontal line is the interpolated value of the static structure factor @xmath80 taken from ref .  .",
    "the time @xmath81 is given in standard reduced molecular dynamics units .",
    ", title=\"fig : \" ] +   [ color online ] ( a ) : normalized velocity autocorrelation function for the wolf and the sf methods . only the short time data are shown .",
    "the error bars are comparable to the size of symbols .",
    "( b ) : coherent intermediate scattering function for wave - length @xmath78 and @xmath79 .",
    "the horizontal line is the interpolated value of the static structure factor @xmath80 taken from ref .  .",
    "the time @xmath81 is given in standard reduced molecular dynamics units .",
    ", title=\"fig : \" ]    from figs .",
    "[ fig:1 ] and [ fig:2 ] it was concluded that for small @xmath0 ( @xmath82 ) and large @xmath4 ( @xmath83 ) both the potential energy and the radial distribution function are in excellent agreement with the ewald summation method , but in fig .",
    "[ fig:3 ] we clearly observe the short - time dynamics is not correct for this set of parameter values .",
    "this shows that the cutoff must be sufficiently large for the wolf method to correctly account for all the fluid properties  but at such large cutoff the sf approximation may be applied instead since it results in the same accuracy .",
    "we also tested the sf approximation for liquid water at the state point @xmath84 = ( 300 k , 998 kg m@xmath85 ) using the flexible single point charge ( spc / fw ) water model  @xcite . in this model the chemical bond and the bending angle are allowed to vibrate around their zero - force values .",
    "the model is easy to implement and has been shown to predict many bulk properties better than for example the spc , spc / e and tip3p models  @xcite . in fig .",
    "[ fig:4](a ) we plot the oxygen - oxygen radial distribution function @xmath86 for the wolf and sf methods . for comparison , data from ref . are shown ( filled squares ) , where the coulomb interactions were evaluated using the particle - mesh ewald ( pme ) method  @xcite .",
    "[ color online ] ( a ) : oxygen - oxygen radial distribution function for the spc / fw water model using sf and wolf methods .",
    "the squares represent data taken from ref .  .",
    "( b ) : normalized center - of - mass velocity autocorrelation functions .",
    "the inset shows a zoom of the time interval 0.065 to 0.32 ps . in both ( a ) and ( b ) @xmath87  .",
    ", title=\"fig : \" ] +   [ color online ] ( a ) : oxygen - oxygen radial distribution function for the spc / fw water model using sf and wolf methods .",
    "the squares represent data taken from ref .  .",
    "( b ) : normalized center - of - mass velocity autocorrelation functions .",
    "the inset shows a zoom of the time interval 0.065 to 0.32 ps . in both ( a ) and ( b ) @xmath87  .",
    ", title=\"fig : \" ]    the radial distribution function is reproduced reasonably well by both methods .",
    "the sf approximation captures the liquid structure at least as well as the wolf method , except at the first peak which is slightly underestimated .",
    "the radial distribution functions for both the sf and the wolf methods are independent of the cutoff for radii larger than 9  , the value used by zahn _ et al . _  @xcite",
    "; this corresponds to @xmath88 since the oxygen - hydrogen distance is around 1.8  . in fig .",
    "[ fig:4](b ) the center - of - mass velocity autocorrelation function is plotted for two different cutoffs for both methods .",
    "this dynamic property is largely independent of method and cutoff , as is the case for the liquid structure .",
    "the same conclusion was reached by fennell and gezelter  @xcite . for the sf approximation",
    "we obtain a diffusion constant of 2.4 @xmath89 m@xmath90 s@xmath91 and a shear viscosity of 0.78 @xmath92 pa s. this can be compared with the experimental values 2.3 @xmath89 m@xmath90 s@xmath91 and 0.85 @xmath92 pa s. it is also worth mentioning that zahn _",
    "et al . _",
    "@xcite used @xmath93 in their simulations of ( rigid ) spc / e water , but found that the potential energy was in better agreement with the ewald method for even lower damping parameters .",
    "for @xmath93 we observe no difference to the sf approximation .",
    "in conclusion , for simple molten salts and liquid water the sf approximation reproduces various properties as well as the wolf method .",
    "the wolf method has one more parameter than sf , and consequently this method may be optimized to give slightly better agreement with the ewald summation method .",
    "such an optimization , however , must be carried separately out for each property in focus and for each different system . beside its simplicity ( and thus easy - to - code feature ) , we found that the sf approximation leads to a simulation speed - up of 2 - 3 compared to the wolf method .",
    "of course , the actual speed - up depends on the specific problem and the use of optimization techniques , but the calculation of the four terms in eq .",
    "( [ eq : wolf ] ) involves complicated mathematical functions and is deemed to consume considerably more computational resources than the simple sf approximation .",
    "we wish to stress here that the paper of wolf _",
    "_ was the first to correctly analyze why the sf approximation for coulomb forces is superior to the standard truncated and shifted potential interaction model .",
    "fennell and gezelter  @xcite carefully analyzed an impressive number of different systems including simple crystals showing a good agreement between the sf method and the ewald technique . in their conclusion",
    "the authors suggested that the sf approximation can also be used for confined geometries , thereby overcoming the enforced periodicity in the unmodified ewald method .",
    "we agree that the ewald method can be problematic ( even for periodic systems  @xcite ) , but , the sf approach ( as well as the wolf method ) is an approximation that suppresses the intrinsic long - ranged nature of the coulomb interactions leading to an artificially molecular orientation  @xcite in confinements . for confined fluids alternative methods",
    "have recently been adviced , see refs .  .",
    "jsh wishes to acknowledge lunbeckfonden for supporting this work as part of grant no .",
    "the centre for viscous liquid dynamics `` glass and time '' is sponsored by the danish national research foundation ( dnrf ) ."
  ],
  "abstract_text": [
    "<S> this paper compares the wolf method to the shifted forces ( sf ) method for efficient computer simulation of isotropic systems interacting via coulomb forces , taking results from the ewald summation method as representing the true behavior . </S>",
    "<S> we find that for the hansen - mcdonald molten salt model the sf approximation overall reproduces the structural and dynamical properties as accurately as does the wolf method . </S>",
    "<S> it is shown that the optimal wolf damping parameter depends on the property in focus , and that neither the potential energy nor the radial distribution function are useful measures for the convergence of the wolf method to the ewald summation method . </S>",
    "<S> the sf approximation is also tested for the spc / fw model of liquid water at room temperature , showing good agreement with both the wolf and the particle mesh ewald methods ; this confirms previous findings [ fennell & gezelter , j. chem . </S>",
    "<S> phys . </S>",
    "<S> * 124 * , 234104 ( 2006 ) ] . beside its conceptual simplicity </S>",
    "<S> the sf approximation implies a speed - up of a factor 2 to 3 compared to the wolf method ( which is in turn much faster than the ewald method ) . </S>"
  ]
}