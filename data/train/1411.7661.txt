{
  "article_text": [
    "let @xmath0 be a number field , @xmath1 a finite set of finite places of @xmath0 containing all those above a fixed rational prime @xmath2 , and let @xmath3 be the maximal extension of @xmath0 unramified outside of @xmath1 and the archimedean places . given a @xmath2-adic representation @xmath4 of @xmath5 , bloch and kato @xcite defined certain subspaces @xmath6 of the galois cohomology group @xmath7 , known as the _ bloch  kato selmer group _ and _ geometric bloch  kato selmer group _ , respectively .",
    "if @xmath4 is , resp .",
    "crystalline , then @xmath8 , resp .",
    "@xmath9 , is the subspace of @xmath10}^1({\\mathbb{q}}_p , v)$ ] of extensions of the trivial representation by @xmath4 that are , resp .",
    "when @xmath4 is absolutely irreducible and , the fontaine ",
    "mazur conjecture together with the philosophy of motives predict that @xmath4 should be the @xmath2-adic realization of some pure motive .",
    "inputting this into the conjectures of beilinson  bloch and bloch  kato ,",
    "one obtains a conjectural relation between the dimension of @xmath9 and the order of vanishing of the @xmath11-function of the dual representation of @xmath4 at the point @xmath12 @xcite*ii ,  3.4.5 . one prediction of this conjecture is that if the representation @xmath4 is pure of motivic weight zero , then @xmath13 this is in accordance with a philosophy of grothendieck that in a conjectural category of mixed motives , there should be no nontrivial extensions of pure motives of the same weight .",
    "let @xmath14 be a finite extension of @xmath15 .",
    "given any absolutely irreducible pure de rham representation @xmath16 one naturally obtains a pure weight zero representation called the adjoint representation : @xmath17 , the lie algebra of @xmath18 , with @xmath5-action given by composing @xmath19 with the adjoint action of @xmath18 .",
    "then the bloch ",
    "kato conjecture predicts @xmath20 in the case where @xmath19 is the representation arising from an elliptic curve over @xmath21 , this prediction was first proved by flach @xcite by a method using euler systems , assuming that the elliptic curve has good reduction at @xmath2 , that @xmath22 , and that the associated residual representation surjects onto @xmath23 . a corollary of the breakthrough work of wiles and taylor ",
    "wiles is this vanishing in the case that @xmath19 is the representation coming certain modular forms .",
    "this results from their so - called @xmath24 theorem that equates a certain universal deformation ring of @xmath25 to a hecke algebra . on way to think about this is that the tangent space of the deformation ring they consider at the characteristic zero point corresponding to the modular form is equal to its adjoint bloch ",
    "kato selmer group , while the tangent space of the hecke algebra at that point is trivial , since the hecke algebra is reduced .",
    "their work also had assumptions on the level of the modular form and on the residual representation . in @xcite",
    ", kisin showed the vanishing of @xmath26 for modular forms of weight @xmath27 and arbitrary level , assuming only a mild condition on the residual representation , and his proof uses some of the ideas of taylor  wiles .",
    "we mention also the result of weston @xcite which applies to non - cm forms with certain hypotheses on the level , but has no restriction on the residual representation . for general totally real , resp .",
    "cm fields , but still in dimension two , one can deduce results of this form from the @xmath28 = \\mathbb{t}[1/p]$ ] theorems @xcite*theorem  3.4.11 and @xcite*propositions  9.2 and 9.3 , resp .",
    "@xcite*corollary  3.4.3 , whenever the assumptions of those theorems are satisfied .    in higher dimensions ,",
    "one is naturally led to consider the galois representations associated to regular algebraic polarized cuspidal automorphic representations of @xmath29 over cm fields .",
    "these adjoint representations have a natural extension to a representation of the galois group of the maximal totally real subfield , and this adjoint selmer group has a natural interpretation as the tangent space of a polarized deformation ring .",
    "although there has been great progress in modularity lifting in this context , almost all of the results prove only @xmath30 and do not imply vanishing of the adjoint selmer groups , although some cases can be deduced using the @xmath31 theorem of clozel  haris ",
    "taylor @xcite*theorem  3.5.1 . using a completely different method , namely the theory of eigenvarieties , chenevier @xcite*theorem  f proved that the vanishing of this adjoint selmer group is equivalent to the vanishing of the @xmath32 of this adjoint representation under some local hypotheses .",
    "this is applicable , in particular , when the deformation problem is unobstructed ( for example , see @xcite*appendix ) .",
    "the main observation used in this paper is that one can still use the taylor",
    "kisin patching method to deduce vanishing of the corresponding adjoint selmer groups for automorphic galois representations provided one knows that the induced points on local deformation rings are smooth .",
    "indeed , the method yields a ring @xmath33 , an @xmath33-module @xmath34 , and a control theorem that relates them to our deformation ring and a space of automorphic forms .",
    "the most subtle point in proving modularity lifting theorems is to understand the components of @xmath33 and how they relate to congruences between automorphic forms .",
    "but if we are only interested in the infinitesimal deformation theory of the characteristic zero point coming from our automorphic galois representation @xmath19 , we can localize and complete at this point , and if we know that @xmath19 determines a smooth point on the local deformation rings , it also determines a smooth point on @xmath33 .",
    "then we can apply the auslander ",
    "buchsbaum formula to the completion and deduce that the localized and completed deformation ring acts freely on a finite dimensional vector space of cusp forms , from which we can deduce vanishing of the adjoint selmer group . before stating the main theorems , we set up some notation .",
    "let @xmath14 be a finite extension of @xmath15 with ring of integers @xmath35 and residue field @xmath36 .",
    "let @xmath0 be a cm field with maximal totally real subfield @xmath37 .",
    "let @xmath38 be some fixed algebraic closure of @xmath0 , and let @xmath39 be a choice of complex conjugation .",
    "let @xmath1 be a finite set of finite places of @xmath37 containing all places above @xmath2 .",
    "let @xmath3 be the maximal extension of @xmath0 unramified outside of the places in @xmath0 above those in @xmath1 .",
    "note that @xmath3 is galois over @xmath37 .",
    "let @xmath40 be a continuous , absolutely irreducible representation , and let @xmath41 denote the lie algebra @xmath42 of @xmath18 with the adjoint action @xmath43 of @xmath5 .",
    "we assume there is a continuous totally odd character @xmath44 and an invertible symmetric matrix @xmath45 such that the pairing @xmath46 on @xmath47 is perfect and satisfies @xmath48 for all @xmath49 . since @xmath19 is absolutely irreducible",
    ", @xmath45 is unique up to scalar .",
    "we can then extend the action of @xmath5 on @xmath41 to an action of @xmath50 by letting @xmath51 act by @xmath52 , and this is independent of the choice of @xmath51 and of @xmath45 .",
    "finally , we recall that we can choose a @xmath5-stable @xmath35-lattice in the representation space of @xmath19 , so after conjugation we may assume that @xmath19 takes values in @xmath53 .",
    "the semisimplification of its reduction modulo the maximal ideal of @xmath35 does not depend on the choice of lattice , and we denote it by @xmath54 .",
    "[ thm : bka ] assume @xmath55 .",
    "assume there is a finite extension @xmath56 of cm fields , a regular algebraic polarizable cuspidal automorphic representation @xmath57 of @xmath58 , and an isomorphism @xmath59 such that the following hold :    1 .",
    "[ bka : aut ] @xmath60 , where @xmath61 is the galois representation attached to @xmath57 and @xmath62 ; 2 .",
    "[ bka : adequate ] @xmath63 and @xmath64 is adequate",
    ".    then    1 .",
    "[ bka : bk ] the geometric bloch ",
    "kato selmer group @xmath65 is trivial .    moreover ,    1 .",
    "[ bka : h2 ] @xmath66 ; 2 .",
    "[ bka : h1 ] letting @xmath67 for each @xmath68 in @xmath37 , the natural map @xmath69 is an isomorphism .",
    "we refer the reader to the notation section below for any of the notation with which the reader is not familiar , to  [ sec : autgalrep ] for a discussion of regular algebraic polarizable cuspidal automorphic representations and their associated galois representations , and to [ def : gladequate ] for the definition of an adequate subgroup of @xmath70 .",
    "if @xmath71 , then any subgroup of @xmath70 acting absolutely irreducibly on @xmath72 is adequate by a theorem of guralnick  herzig  taylor  thorne @xcite*theorem",
    "a,9 , and the assumption of potential automorphy is satisfied in many cases by work of barnet - lamb  gee  geraghty ",
    "taylor @xcite*theorem  4.5.1 . as an example , in ",
    "[ sec : sympow ] we apply this to certain twists of even symmetric powers of galois representations associated to elliptic modular forms .",
    "parts  [ bka : h2 ] and  [ bka : h1 ] of theorem  [ thm : bka ] follow from part  [ bka : bk ] , using an argument of kisin ( see  [ thm : cohom ] ) , and this relies on the  numerical coincidence \" discussed in @xcite*1 .",
    "it seems likely that the assumption that @xmath55 can be removed using recent work of thorne @xcite , but we have not checked the details . theorem  [ thm : bka ] will follow ( see [ sec : cmthm ] ) from a slight variant ( [ thm : bk ] ) .    a similar result ( as well as a result similar to theorem  [ thm : thmc ] below )",
    "was independently obtained by breuil ",
    "schraen @xcite*corollaires  4.12 and 4.13 .",
    "our results on the bloch ",
    "kato selmer group ( and on universal deformation rings , c.f .",
    "theorem  [ thm : thmc ] ) are more general , as we make no assumption on the local factors @xmath73 of the automorphic representation at places @xmath68 , whereas they assume @xmath73 is unramified when @xmath68 . on the other hand , they deduce their results as an application of the construction and study of an interesting object they call a _ patched eigenvariety _ , and this construction has other applications ; for example , to a conjecture of breuil on locally analytic vectors in completed cohomology @xcite*corollaire  4.4 .    for @xmath19 as in the statement of the theorem , @xmath74 for any @xmath68 in @xmath37 , where @xmath75 is the more common local bloch",
    " kato selmer group ( see [ rmk : gfsame ] ) , so theorem  [ thm : bka ] remains unchanged replacing @xmath76 with @xmath77 everywhere . with this in mind , the reader should compare theorem  [ thm : bka ] with the results of @xcite*6 . in particular , note that we make no assumption on the restriction of @xmath19 to decomposition groups above @xmath2 ( besides what is naturally implied by assumption [ bka : aut ] ) .    in  [ sec :",
    "mainthm ] , using cyclic base change we deduce from theorem  [ thm : bka ] a similar theorem for totally real fields . to state it , we set up some notation .",
    "let @xmath78 be the maximal extension of @xmath37 unramified outside @xmath1 and all places above @xmath79 .",
    "let @xmath80 be a continuous , absolutely irreducible representation .",
    "we assume that @xmath19 satisfies one of the following :    1 .",
    "[ b : orthogonal ] @xmath19 factors through a map @xmath81 , that we again denote by @xmath19 , with totally even multiplier character ; 2 .",
    "[ b : symplectic ] @xmath82 is even and @xmath19 factors through a map @xmath83 , that we again denote by @xmath19 , with totally odd multiplier character .",
    "we will refer to the first as the go - case , and the second as the gsp - case .",
    "if we are in the go - case , then we let @xmath41 and @xmath84 denote the lie algebra @xmath85 of @xmath86 and sub - lie algebra @xmath87 , respectively , with the adjoint @xmath88-action @xmath43 .",
    "if we are in the gsp - case , then we let @xmath41 and @xmath84 denote the lie algebra @xmath89 of @xmath90 and sub - lie algebra @xmath91 , respectively , with the adjoint @xmath88-action @xmath43 .",
    "[ thm : thmb ] assume @xmath55 .",
    "assume there is a finite extension @xmath92 of totally real fields , a regular algebraic polarizable cuspidal automorphic representation @xmath93 of @xmath94 , and an isomorphism @xmath59 such that :    1 .",
    "@xmath95 , where @xmath96 is the galois representation attached to @xmath93 and @xmath62 ; 2 .",
    "@xmath97 is adequate .    then    1 .",
    "[ thmb : bk ] the geometric bloch ",
    "kato selmer group @xmath98 is trivial .",
    "moreover ,    1 .   [ thmb : h2 ] @xmath99 ; 2 .",
    "[ thmb : h1 ] letting @xmath100 for each @xmath68 in @xmath37 , the natural map @xmath101 is an isomorphism .    as in @xcite*8",
    ", we use vanishing of the geometric bloch  kato adjoint selmer group to deduce smoothness of a certain universal deformation ring at automorphic points , something we now explain .",
    "let @xmath102 denote the group scheme over @xmath103 that is the semidirect product @xmath104 where @xmath105 .",
    "there is a character @xmath106 defined by by @xmath107 and @xmath108 .",
    "fix a continuous homomorphism @xmath109 inducing an isomorphism @xmath110 , as well as a totally odd character @xmath111 such that @xmath112 .",
    "let @xmath54 be the composite of @xmath113 with the projection @xmath114 , and assume @xmath25 is absolutely irreducible .",
    "if @xmath55 , then with this data @xmath115 , there is a complete noetherian local commutative @xmath35-algebra @xmath116 with residue field @xmath36 , such that @xmath116 represents the set - valued functor on the category of complete noetherian local commutative @xmath35-algebras @xmath117 with residue field @xmath36 , that sends @xmath117 to the set deformations of @xmath118 to @xmath117 with multiplier @xmath119 , i.e. the set of @xmath120-conjugacy classes of homomorphisms @xmath121 satisfying @xmath122 and @xmath123 ( see  [ sec : global ] ) .",
    "[ thm : thmc ] assume @xmath55 .",
    "let @xmath124 be a closed point of @xmath125 $ ] with residue field @xmath126 , and let @xmath127 be the pushforward of ( some homomorphism representing ) the universal deformation of @xmath118 via @xmath128 \\xrightarrow{x } k$ ] .",
    "let @xmath19 denote the composite of @xmath129 with the projection @xmath130 .",
    "assume there is a finite extension @xmath56 of cm fields , a regular algebraic polarizable cuspidal automorphic representation @xmath57 of @xmath58 , and an isomorphism @xmath59 such that the following hold :    1 .",
    "[ smooth : aut ] @xmath131 ; 2 .",
    "[ smooth : adequate ] @xmath63 and @xmath64 is adequate .",
    "then the localization and completion @xmath132 is formally smooth over @xmath126 of dimension @xmath133 $ ] .",
    "theorem  [ thm : thmc ] is deduced in [ sec : smooth ] as an immediate consequence of [ thm : bk ] and [ thm : globalsmooth ] .",
    "a related application of theorem  [ thm : bka ] is to the geometry of unitary eigenvarieties .",
    "bellache and chenevier showed that at certain classical automorphic points on a unitary eigenvariety ( see @xcite*7.6.2 ) , the weight map is tale and that a  refined deformation ring \" ( see @xcite*definition  7.6.2 and proposition 7.6.3 ) is isomorphic to the completed local ring of the structure sheaf of the eigenvariety at these points @xcite*corollary  7.6.11 , provided that @xcite*conjecture  7.6.5  ( c1 ) holds .",
    "theorem  [ thm : bka ] implies @xcite*conjecture  7.5.6  ( c1 ) if the representation denoted @xmath4 there further satisfies the assumptions of theorem  [ thm : bka ] .",
    "thus , theorem  [ thm : bka ] establishes the conjectures of @xcite*7.6 at points satisfying the assumptions of theorem  [ thm : bka ] .",
    "we refer the reader to @xcite*7.6 for more details and for precise statements .",
    "these conjectures of bellache  chenevier were also proved by breuil ",
    "schraen @xcite*corollaire  4.11 , under essentially the same hypotheses .",
    "we also note that many cases of this were proved by completely different methods by chenevier @xcite*theorems  4.8 and  4.10 .",
    "an important step in the proofs of our main theorems is the fact that the points coming from regular algebraic polarizable cuspidal automorphic representations on certain local deformation rings are smooth . by local - global compatibility , the weil ",
    "deligne representations attached to their local factors satisfy the property that they do not admit any nontrivial morphisms to their tate twist .",
    "we say below ( [ def : genericwd ] ) that such weil  deligne representations are _",
    "generic_. we show ( see [ thm : smoothlp ] ) that this property characterizes smooth points on local potentially semistable deformation rings .",
    "as this may be of independent interest , we state it here .",
    "[ thm : thmd ] let @xmath134 be a finite extension of @xmath15 , let @xmath135 be a continuous homomorphism , and let @xmath136 be the universal framed deformation ring for @xmath25 . fix a galois type @xmath137 and a @xmath2-adic hodge type @xmath138 .",
    "let @xmath139 denote kisin s @xmath35-flat potentially semistable framed deformation ring with fixed galois type @xmath137 and @xmath2-adic hodge type @xmath138 .",
    "let @xmath124 be a closed point of @xmath140 $ ] with residue field @xmath126 .",
    "let @xmath141 be the pushforward of the universal lift via @xmath142 \\rightarrow r_{{\\overline{\\rho}}}^\\square(\\tau,\\mathbf{v})[1/p ] \\xrightarrow{x } k$ ] , and let @xmath143 be its associated weil ",
    "deligne representation .",
    "then @xmath144 $ ] is smooth at @xmath124 if and only if there is no nonzero map @xmath145 of weil  deligne representations .",
    "we refer the reader to   [ sec : wd ] and  [ sec : local ] for the definitions of any of the terms or object in the statement of theorem  [ thm : thmd ] with which the reader is not familiar . the idea of the proof of theorem  [ thm : thmd ] is quite simple : mimic the @xmath146 case .",
    "if @xmath134 is a finite extension of @xmath147 with @xmath146 , then the smooth closed points in the generic fibre of the universal framed deformation ring are precisely the ones whose weil  deligne representation satisfy this genericity hypothesis ( as observed in @xcite*lemma  1.3.2 , see also [ thm : localdefl ] below ) .",
    "indeed , a result of gee @xcite*theorem  2.1.6 gives the dimension of the generic fibre of this framed deformation ring , so it suffices to check when the tangent space , which is related to an @xmath148 , has strictly larger dimension , and this can be related to our genericity condition using local euler characteristic and local tate duality .",
    "the proof of theorem  [ thm : thmd ] is similar , replacing gee s dimension result with kisin s @xcite*theorem  3.3.4 , the @xmath148 with the local geometric bloch ",
    "kato selmer group @xmath76 , and local euler characteristic and local tate duality with bloch and kato s local dimension formulae and local duality results @xcite*3 .",
    "in fact , for the proofs of theorems  [ thm : bka ] , [ thm : thmb ] , and  [ thm : thmc ] , we will only need the direction  generic implies smooth \" , but the author has decided to include the converse here because he finds it interesting in its own right : the criterion is the same as in the @xmath146 case , exhibiting a sort of  independence of @xmath2 \" phenomena for the geometry of potentially semistable deformation rings .",
    "the paper is organized as follows .    in  [ sec : deftheory ] , we recall and prove the relevant facts regarding the deformation theory of galois representations .",
    "we first recall some properties of weil ",
    "deligne representations in [ sec : wd ] ; namely the construction of weil  deligne representations attached to local galois representations and their connection with smooth admissible representations of @xmath29 . in ",
    "[ sec : local ] , we treat the local theory of galois deformations with an emphasis on describing the smooth points in the generic fibre of local deformation rings ; in particular , we prove theorem  [ thm : thmd ] ( [ thm : smoothlp ] ) . the global theory",
    "is then discussed in ",
    "[ sec : global ] , the main point being to use kisin s technique of analyzing the generic fibre of deformation rings to connect them to the bloch  kato selmer group ( [ thm : smallglobalcomplete ] ) , and to prove some dimension and smoothness results that are necessary for the proof of theorem  [ thm : thmc ] ( [ thm : globalsmooth ] ) .",
    "we discuss the automorphic theory necessary in  [ sec : auttheory ] ; everything here is standard .",
    "we first recall the properties of galois representations associated to regular algebraic polarized cuspidal automorphic representations of cm and totally real fields in  [ sec : autgalrep ] .",
    "we then describe their connection to automorphic forms on definite unitary groups in  [ sec : unitary ] , the main point being to show how one can construct a certain module of automorphic forms with an action of a certain galois deformation ring , and that the vanishing of the bloch  kato selmer group in question is implied by a freeness property ( [ thm : heckedef ] ) .",
    "we conclude our efforts in  [ sec : mainsec ] , proving the main theorem ( [ thm : bk ] ) in  [ sec : mainthm ] , and deducing theorems  [ thm : bka ] , [ thm : thmb ] , and  [ thm : thmc ] from the introduction in ",
    "[ sec : introthms ] .",
    "finally , in  [ sec : sympow ] we given an application to certain twists of symmetric powers of modular galois representations .",
    "i would like to thank mark kisin for helpful conversations and for helpful comments on an earlier version of this paper .",
    "i would like thank rebecca bellovin and frank calegari for helpful conversations , and florian herzig for helpful comments on an earlier draft of this paper .",
    "i would like to thank john bergdall for pointing out the application to the work of bellache and chenevier , chandrashekhar khare for pointing out that i could deduce the vanishing of the @xmath32 , and david hansen for pointing out the application to certain twists of symmetric powers of modular galois representations .",
    "i would like to thank matthew emerton for bringing my attention to the article @xcite , which started my interest in this project .",
    "finally , i would like to thank the referee for their helpful comments and corrections .",
    "if @xmath0 is a number field and @xmath149 is a place of @xmath0 , we denote by @xmath150 the completion of @xmath0 at @xmath149 , and if @xmath149 is non - archimedean we denote the ring of integers by @xmath151 .",
    "we let @xmath152 denote the ring of adeles of @xmath0 , and @xmath153 the ring of finite adeles .",
    "if @xmath134 is any field with a fixed algebraic closure @xmath154 , we denote by @xmath155 the absolute galois group @xmath156 .",
    "if @xmath134 is a non - archimedean local field , we denote by @xmath157 the inertia subgroup , by @xmath158 the weil group , and by @xmath159 the geometric frobenius in @xmath160 . in the case that @xmath134 is the completion of a number field @xmath0 at a finite place @xmath149 , we write @xmath161 , @xmath162 , and @xmath163 for @xmath164 , @xmath165 , and @xmath166 , respectively .",
    "if @xmath56 is a galois extension of number fields inside some fixed algebraic closure @xmath38 of @xmath0 , and @xmath1 is a finite set of finite places of @xmath0 , we let @xmath167 denote the maximal extension of @xmath11 that is unramified outside of any of the places in @xmath11 above those in @xmath1 and the archimedean places . a cm extension of a totally real field is always assumed to be imaginary . given a cm field @xmath0 with maximal totally real subfield @xmath37 , we denote by @xmath168 the nontrivial @xmath169-valued character of @xmath170 . given a finite separable extension of fields @xmath56 , we write @xmath171 for the norm from @xmath11 to @xmath0 .",
    "if @xmath134 is a non - archimedean local field , we let @xmath172 be the artin reciprocity map normalized so that uniformizers are sent to geometric frobenius elements . for a number field @xmath0 , we let @xmath173 be @xmath174 . for any @xmath175 , we let @xmath176 be the local langlands reciprocity map that takes irreducible admissible representations of @xmath177 to frobenius semi - simple weil  deligne representations , normalized as in @xcite and @xcite .",
    "we then let @xmath178 be given by @xmath179 .",
    "if we are given an isomorphism @xmath180 of fields , and @xmath181 is an embedding of fields , we write @xmath182 for @xmath183 . if @xmath184 is a tuple of field embeddings @xmath185 , then we write @xmath182 for the tuple @xmath186 .",
    "if @xmath187 is a representation of a group @xmath188 on a @xmath134-vector space @xmath4 , then we will denote by @xmath189 the representation of @xmath188 on the @xmath11-vector space @xmath190 .",
    "if @xmath188 is a group , @xmath117 is a commutative ring , and @xmath191 is a homomorphism , then we will let @xmath192 denote the representation space of @xmath19 , i.e. @xmath193 with the @xmath194$]-module structure coming from @xmath19 .",
    "we denote by @xmath195 the @xmath2-adic cyclotomic character .",
    "we let @xmath196 , @xmath197 , and @xmath198 denote fontaine s rings of crystalline , semistable , and periods , respectively .",
    "we will frequently use the berger ",
    "andr  kedlaya ",
    "mebkhout theorem @xcite*thorme  0.7 , that representation are potentially semistable , without comment .",
    "we use covariant @xmath2-adic hodge theory , and normalize our hodge ",
    "tate weights so that the hodge  tate weight of @xmath195 is @xmath199 .",
    "if @xmath134 and @xmath14 are two algebraic extensions of @xmath15 with @xmath200 finite , @xmath201 is a continuous embedding , and @xmath202 is a representation , we will write @xmath203 for the multiset of @xmath82 hodge  tate weights with respect to @xmath137 . specifically , an integer @xmath204 appears in @xmath203 with multiplicity equal to the @xmath14-dimension of the @xmath204th graded piece of the @xmath82-dimensional filtered @xmath14-vector space @xmath205 , where @xmath206 and we view @xmath14 as a @xmath207-algebra via @xmath208 .",
    "we will say a continuous representation @xmath209 of the galois group of a number field @xmath0 is , resp .",
    "semistable , resp .",
    "crystalline , if @xmath210 is so for every @xmath68 in @xmath0 .",
    "if @xmath117 is a commutative local ring , we will denote by @xmath211 its maximal ideal . if @xmath117 is a commutative ring and @xmath212 is a homomorphism with @xmath213 a domain , then we denote by @xmath214 the localization of @xmath117 at @xmath215 , and @xmath216 the localization and completion of @xmath117 at @xmath215 .",
    "if @xmath117 is a commutative ring and @xmath217 has residue field @xmath218 , we again denote by @xmath124 the map @xmath219 .",
    "if @xmath126 is a characteristic @xmath220 field and @xmath221 is a commutative @xmath126-algebra , we will say @xmath222 is formally smooth if @xmath223 is formally smooth .",
    "this is equivalent to @xmath224 being formally smooth , which is equivalent to @xmath225 being isomorphic to a power series ring over it s residue field , since @xmath126 has characteristic @xmath220 .",
    "we will use these equivalences without further comment .",
    "if @xmath226 is a local commutative noetherian ring , we let @xmath227 be the category of complete local commutative noetherian @xmath226-algebras @xmath117 such that the structure map @xmath228 induces an isomorphism @xmath229 , and whose morphisms are local @xmath226-algebra morphisms . we will refer to an object , resp .",
    "a morphism , in @xmath227 as a @xmath227-algebra , resp .",
    "a @xmath227-morphism .",
    "the full subcategory of artinian objects is denoted @xmath230 .",
    "if @xmath188 is a topological group , and @xmath231 is a topological @xmath188-module , the cohomology groups @xmath232 are always assumed to be the continuous cohomology groups , i.e. the cohomology groups computed with continuous cochains . if @xmath233 is a galois extension , and @xmath231 is a topological @xmath234-module , we write @xmath235 for @xmath236 . if @xmath237 is an algebraic closure of @xmath11 , we write @xmath238 for @xmath239 .",
    "if @xmath134 is a finite extension of @xmath15 , and @xmath231 is a finite dimensional @xmath15-vector space with a continuous @xmath15-linear @xmath155-action , we set @xmath240 if @xmath0 is a number field , @xmath241 is galois extension of @xmath0 , and @xmath231 is a finite dimensional @xmath15-vector space with a continuous @xmath15-linear @xmath242-action , we set @xmath243",
    "throughout this section @xmath14 will denote a finite extension of @xmath15 with ring of integers @xmath35 and residue field @xmath36 .",
    "let @xmath244 be a rational prime , and let @xmath134 be a finite extension of @xmath245 with ring of integers @xmath246 and uniformizer @xmath247 .",
    "let @xmath248 denote the cardinality of the residue field of @xmath134 , let @xmath249 denote the absolute value on @xmath134 normalized so that @xmath250 .",
    "for @xmath251 , we will write @xmath252 for @xmath253 .",
    "if @xmath126 is a field , and @xmath254 is a homomorphism , we let @xmath41 denote @xmath255 with the adjoint action @xmath43 of @xmath155 . note that @xmath256 and @xmath257 as @xmath258$]-modules .",
    "[ [ sec : genericwd ] ]    we recall some basics of weil  deligne representations ( see @xcite*4 ) . given a characteristic @xmath220 field @xmath259 , a _",
    "deligne representation over _ @xmath259 is a pair @xmath260 , where @xmath261 is a representation of @xmath158 on a finite dimensional @xmath259-vector space @xmath4 with open kernel , and @xmath262 is nilpotent , such that @xmath263 for all @xmath264 .",
    "a morphism of weil ",
    "deligne representations @xmath265 is a an @xmath259-linear morphism that intertwines the @xmath266 and the @xmath267 .",
    "a weil  deligne representation @xmath260 is called _ frobenius - semisimple _ if @xmath268 is semisimple ( equivalently , if @xmath269 is semisimple for @xmath270 a lift of the frobenius ) .",
    "given a weil  deligne representation @xmath260 , we will denote by @xmath271 its frobenius - semisimplification , i.e. @xmath272 .",
    "given a weil  deligne representation @xmath260 , we let @xmath273 be the weil ",
    "deligne representation with @xmath274 . if @xmath275 , we let @xmath276 denote the weil deligne representation obtained by change of scalars via @xmath277 ( this is again a weil  deligne representation since @xmath278 for all @xmath264 ) .",
    "[ def : genericwd ] we say a weil  deligne representation @xmath260 is _ generic _ if there is no nontrivial morphism @xmath279 .    if @xmath93 is an irreducible admissible representation of @xmath177 over @xmath280 and @xmath281 , then @xmath282 ( this is explained when @xmath283 in @xcite*35 and the argument there generalizes using @xcite*theorem  3.2 and the converse theorems of @xcite ) .",
    "if @xmath259 is field isomorphic to @xmath280 ( as abstract fields ) , we get a bijection , again denoted by @xmath178 , between isomorphism classes of irreducible admissible representations of @xmath177 over @xmath259 and isomorphism classes of @xmath82-dimensional frobenius semi - simple weil ",
    "deligne representations over @xmath259 by fixing any isomorphism @xmath284 and setting @xmath285 , and this is independent of the choice of @xmath62 .",
    "[ thm : automorphicwd ] let @xmath93 be an irreducible smooth admissible representation of @xmath177 on an @xmath259-vector space , with @xmath259 a field ( abstractly ) isomorphic to @xmath280 . then @xmath286 is generic if and only if @xmath93 is generic .",
    "this is essentially identical to @xcite*lemma  1.3.2(1 ) .",
    "we give the details .",
    "it suffices to consider the case @xmath287 . since @xmath93 is generic if and only if @xmath288 is generic , it is equivalent to show that @xmath93 is generic if and only if @xmath289 is generic .",
    "note that if @xmath290 , then @xmath291 .",
    "we will use the notation and terminology of  @xcite*1.3 .",
    "there are positive integers @xmath292 for @xmath293 with @xmath294 and irreducible supercuspidal representations @xmath295 of @xmath296 such that @xmath297 and the multiset @xmath298 is uniquely determined by @xmath93 . by abuse of notation",
    ", we also denote by @xmath299 the @xmath300-dimensional weil  deligne representation @xmath260 on a complex vector space with basis @xmath301 , where @xmath302 for each @xmath303 , and @xmath304 for each @xmath305 and @xmath306 .",
    "then ( see @xcite*theorem  vii.2.20 and the discussion preceding it ) @xmath307 and @xmath289 is nongeneric if and only if @xmath308 for some @xmath309 . since @xmath310 is absolutely irreducible ( as @xmath295 is supercuspidal ) , it is easy to check that holds if and only if @xmath311 with @xmath312 . in the notation and terminology of @xcite ( see @xcite*3.1 and  4.1 ) , this happens if and only if the segments @xmath313 $ ] and @xmath314 $ ] are linked , which happens if and only if @xmath93 is non - generic by @xcite*theorem  9.7 ( note _ generic _ is called _ non - degenerate _ in @xcite ) .    [ [ sec : lnotpwd ] ]    assume that @xmath146 , and let @xmath315 be a continuous representation . following @xcite*4.2 , we can attach a weil  deligne representation to our fixed @xmath19 , that we will denote @xmath316 , as follows .",
    "fix @xmath317 mapping to the geometric frobenius in @xmath318 .",
    "fix a surjection @xmath319 , and let @xmath320 be such that @xmath321 .",
    "the homomorphism @xmath322 necessarily factors through tame inertia .",
    "write @xmath323 with @xmath324 semisimple and @xmath325 unipotent",
    ". set @xmath326 .",
    "then the map @xmath327 given by @xmath328 for @xmath329 and @xmath330 , is well - defined with open kernel , and @xmath260 is a weil  deligne representation .",
    "the isomorphism class does not depend on the choices made , and we denote any element in this isomorphism class by @xmath316 .",
    "moreover , this assignment ( which depends on @xmath331 and @xmath322 ) gives an equivalence of categories from the category of continuous representations @xmath332 to the full subcategory of weil ",
    "deligne representations @xmath260 on @xmath47 such that @xmath268 has bounded image .",
    "from this we deduce the following lemma .",
    "[ thm : lnotpgeneric ] let @xmath333 be a continuous representation .",
    "deligne representation @xmath316 is generic if and only if @xmath334}(v_\\rho , v_\\rho(1 ) ) = 0 $ ] .    [",
    "[ sec : pwd ] ]    assume @xmath335 , and let @xmath315 be a continuous potentially semistable representation .",
    "following fontaine , @xcite*1.3 and  2.3 , we can also associate a weil  deligne representation to @xmath19 , again denoted @xmath316 , as follows .",
    "let @xmath336 be a finite extension , let @xmath337 , and let @xmath338 be the maximal subfield of @xmath11 unramified over @xmath15 .",
    "we assume that @xmath14 contains all embeddings of @xmath338 into an algebraic closure of @xmath14 .",
    "a @xmath339-_module _ @xmath213 over @xmath14 is a finite free @xmath340-module together with operators @xmath341 and @xmath342 , and an action of @xmath343 , satisfying the following :    * @xmath342 is @xmath340-linear ; * @xmath341 is @xmath14-linear and satisfies @xmath344 for any @xmath345 and @xmath346 , where @xmath347 is the absolute arithmetic frobenius ; * @xmath348 ; * the @xmath343-action is @xmath14-linear and @xmath338-semilinear , and commutes with @xmath341 and @xmath342 .",
    "extend the action of @xmath343 to @xmath158 by letting @xmath349 act trivially . for @xmath264 ,",
    "we let @xmath350 be such that the image of @xmath351 in @xmath352 is @xmath353 .",
    "we then define an @xmath354-linear action , that we denote @xmath355 , of @xmath158 on @xmath213 by @xmath356 .",
    "writing @xmath357 , we get a decomposition @xmath358 and an induced @xmath82-dimensional weil  deligne representation @xmath359 over @xmath14 on each factor @xmath360 .",
    "the isomorphism class of @xmath361 is independent of @xmath362 ( see @xcite*2.2.1 ) , and we denote any element in its isomorphism class by @xmath363 .",
    "moreover , by @xcite*proposition  4.1 , this assignment induces an equivalence of categories from @xmath339-modules over @xmath14 to weil ",
    "deligne representations over @xmath14 on which @xmath349 acts trivially . given a @xmath339-module @xmath213 over @xmath14 ,",
    "we let @xmath364 be the @xmath365-module with the same underlying @xmath366-module , operator @xmath342 , and @xmath367-action , but with @xmath368 .",
    "note that @xmath369 .    now choose @xmath336 such that @xmath370 is semistable and such that @xmath14 contains all embeddings of @xmath11 into an algebraic closure of @xmath14 ( enlarging @xmath14 if necessary ) .",
    "we get a @xmath365-module @xmath371 the isomorphism class of @xmath372 does not depend on the choice of @xmath11 ( see @xcite*2.2.1 ) , and we set @xmath373 .",
    "[ thm : lpgeneric ] let @xmath333 be a potentially semistable representation .",
    "let @xmath336 be a finite extension such that @xmath374 is semistable .    1 .",
    "[ lpgeneric : phin ] the weil ",
    "deligne representation @xmath316 is generic if and only if there are no nonzero morphisms @xmath375 of @xmath365-modules over @xmath14 .",
    "[ lpgeneric : crys ] let @xmath376 with its induced crystalline frobenius @xmath341 .",
    "then @xmath316 is generic if and only if @xmath377 .    part [ lpgeneric : phin ] follows from @xcite*proposition  4.1 .",
    "we use this to derive part  [ lpgeneric : crys ] . by @xcite*5.6 , the @xmath339-module @xmath378 over @xmath15",
    "is identified with the @xmath339-module over @xmath15 consisting of the @xmath338-vector space of morphisms @xmath379 with @xmath365-module structure by    * @xmath380 , * @xmath381 , * @xmath382 , for @xmath383 .",
    "this identification takes the subspace of elements that commute with @xmath14 to the subspace of elements that commute with @xmath14 , and we have an isomorphism @xmath384 with the space of @xmath366-morphisms @xmath379 with the @xmath365-module structure as above .",
    "this together with part [ lpgeneric : phin ] implies that @xmath316 is generic if and only if @xmath385 the left hand side of this expression is exactly the subspace of @xmath386 on which @xmath387 .",
    "we note that one may have @xmath334}(v_\\rho , v_\\rho(1 ) ) = 0 $ ] , but @xmath316 nongeneric , for example if @xmath19 is a nonsplit crystalline extension of the trivial character by the cyclotomic character .",
    "we keep the notation and terminology of the previous subsection .",
    "fix a continuous representation @xmath388 a _ lift _ of @xmath25 to a @xmath389-algebra @xmath117 is a continuous homomorphism @xmath390 such that @xmath391 .",
    "the set valued functor that sends a @xmath389-algebra to its set of lifts is representable ( see @xcite*proposition  1.3 ) .",
    "we call the representing object the _ universal lifting ring _ for @xmath25 and denote it by @xmath136 .",
    "we let @xmath392 denote the universal lift .    in",
    "what follows , if @xmath221 is a quotient of @xmath136 , and @xmath393 $ ] has residue field @xmath126 , we let @xmath394 denote the specialization of @xmath395 via @xmath396 \\rightarrow r[1/p ] \\xrightarrow{x } k$ ] .",
    "we then define a _ lift _ of @xmath397 to a @xmath398-algebra @xmath117 to be a homomorphism @xmath390 such that @xmath399 and such that the induced map @xmath400 is continuous for all @xmath401 , where we give @xmath402 the topology as a finite dimensional @xmath126-vector space .",
    "the proof of our main theorems will rely crucially on kisin s method for analyzing the generic fibre of universal deformation rings , the linchpin of which is the following result .",
    "[ thm : defcomplete ] let @xmath124 be a closed point of @xmath142 $ ] with residue field @xmath126 .    1 .   [ defcomplete : rep ] the set valued functor that sends a @xmath398-algebra to the set of lifts of @xmath397 is represented by the the localization and completion @xmath403 of @xmath404 at @xmath124 .",
    "[ defcomplete : tangent ] the tangent space of @xmath405 $ ] at @xmath124 is canonically isomorphic to the space of @xmath406-cocyles @xmath407 of @xmath155 with coefficients in @xmath408 .",
    "part [ defcomplete : rep ] is @xcite*lemma  2.3.3 and proposition  2.3.5 .",
    "in fact , @xcite*proposition  2.3.5 goes further by identifying certain groupoids , which implies what we want ( see @xcite*a.5 ) .    using part  [ defcomplete : rep ] , it is straightforward to check that the map @xmath409)$ ] given by @xmath410 is an isomorphism of @xmath126-vector spaces .",
    "[ thm : localdefl ] assume @xmath146 .    1 .",
    "[ localdefl : dim ] @xmath405 $ ] is equidimensional of dimension @xmath411 .",
    "[ localdefl : smooth ] a closed point @xmath124 of @xmath412 $ ] is smooth if and only if @xmath143 is generic .",
    "the fact that @xmath405 $ ] is equidimensional of dimension @xmath411 is a result of gee @xcite*theorem  2.1.6 ( see also the discussion preceding proposition  2.1.4 of @xcite ) .",
    "let @xmath126 denote the residue field of @xmath124 .",
    "then [ thm : defcomplete ] implies that @xmath124 is a smooth point if and only if @xmath413 . by the local euler characteristic formula ,",
    "@xmath414 so @xmath403 is formally smooth over @xmath126 if and only if @xmath415 .",
    "the trace pairing on @xmath408 is perfect , so tate local duality implies that @xmath415 if and only if @xmath416 .",
    "this is equivalent to @xmath417}(v_{\\rho_x},v_{\\rho_x}(1 ) ) = 0 $ ] , which is equivalent to @xmath143 being generic by [ thm : lnotpgeneric ] .",
    "[ [ sec : types ] ]    assume that @xmath335 .",
    "a @xmath82-dimensional _ galois type _ over @xmath14 is a representation @xmath418 of @xmath157 on a @xmath82-dimensional @xmath14-vector space @xmath4 with open kernel that extends to a representation of @xmath158 .",
    "an @xmath82-dimensional @xmath2-_adic hodge type _ over @xmath14 is a pair @xmath419 , where @xmath213 is a free @xmath420-module of rank @xmath82 , and @xmath421 is a decreasing , separated , exhaustive filtration on @xmath213 by @xmath420-submodules .",
    "we set @xmath422 and @xmath423 .",
    "we will say that a @xmath2-adic hodge type @xmath424 over @xmath14 is _ regular _ if , writing @xmath425 as a product of fields , the @xmath82-dimensional filtered @xmath426-vector space @xmath427 has graded pieces of dimension at most @xmath406 .",
    "it is straightforward to check that if @xmath138 is regular , then @xmath428 $ ] , and this is maximal .",
    "let @xmath429 and @xmath430 be a @xmath82-dimensional galois type and @xmath2-adic hodge type , respectively , over @xmath14 .",
    "let @xmath117 be a finite @xmath14-algebra and let @xmath431 be a free @xmath117-module of rank @xmath82 with a continuous @xmath117-linear @xmath155-action such that @xmath431 is a potentially semistable representation .",
    "let @xmath432 be the weil ",
    "deligne representation attached to @xmath431 ( viewed as a representation of @xmath155 on a @xmath433-dimensional @xmath14-vector space ) .",
    "we say that @xmath431 has _ galois type _",
    "@xmath137 if @xmath434 .",
    "let @xmath435 together with its natural filtration induced from the filtration on @xmath198 .",
    "we say that @xmath431 has @xmath2-_adic hodge type _",
    "@xmath138 if for each @xmath436 , there is an isomorphism of @xmath437-modules @xmath438 we can now state the following fundamental result of kisin , @xcite*theorem  3.3.4 .    [ thm : pdefring ] fix a @xmath82-dimensional galois type @xmath137 , and a @xmath82-dimensional @xmath2-adic hodge type @xmath424 over @xmath14 .",
    "there is an @xmath35-flat quotient @xmath439 of @xmath440 such that if @xmath117 is any finite @xmath14-algebra , an @xmath14-algebra morphism @xmath441 \\rightarrow a$ ] factors through @xmath442 $ ] if and only if @xmath397 is potentially semistable with galois type @xmath137 and @xmath2-adic hodge type @xmath138 .",
    "moreover , if nonzero , then @xmath140 $ ] is equidimensional of dimension @xmath443 , and admits a open dense formally smooth subscheme .",
    "we now wish to show the analogue of part [ localdefl : smooth ] of [ thm : localdefl ] for the rings @xmath139 . for global applications",
    ", we will actually only need the fact that @xmath143 generic implies @xmath444 is formally smooth , but for completeness we include the converse .",
    "our proof will rely on the following standard lemma , which we will also need for other purposes later .",
    "[ thm : localbk ] let @xmath124 be a closed point of @xmath445 $ ] .",
    "the tangent space of @xmath446 $ ] at @xmath124 is canonically isomorphic to @xmath447    let @xmath126 denote the residue field of @xmath124 . using [ thm : defcomplete ] , the tangent space of @xmath403 is canonically isomorphic to @xmath407 .",
    "take @xmath448 , and let @xmath449)$ ] be the corresponding lift .",
    "the cocycle @xmath450 dies in @xmath451 if and only if there is a @xmath155-equivariant isomorphism @xmath452 ) \\cong      ( b_{{\\mathrm{dr } } } \\otimes_{{\\mathbb{q}}_p } v_{\\rho_x } ) \\otimes_k k[\\varepsilon],\\ ] ] and this happens if and only if @xmath453 is potentially semistable with @xmath2-adic hodge type @xmath138 .",
    "choosing an extension @xmath336 for which @xmath453 is semistable and using the exactness of @xmath454 ( see @xcite*thorm  5.1 ) , we see that the galois type of @xmath453 is an extension of @xmath137 by itself . since @xmath137 is a representation of a finite group in characteristic @xmath220 , it necessarily splits and @xmath453 has galois type @xmath137 .",
    "hence , @xmath450 lies in the kernel of @xmath455 if and only if the lift @xmath453 is potentially semistable of galois type @xmath137 and @xmath2-adic hodge type @xmath138 . by [ thm : pdefring ] , the subspace of such elements is the tangent space of @xmath456 .",
    "[ thm : adlem ] let @xmath126 be a finite extension of @xmath15 and let @xmath254 be a representation .",
    "there is an isomorphism @xmath457 of filtered @xmath458-modules .    indeed , from @xmath459 and",
    "the fact that @xmath19 and @xmath41 are , we have isomorphisms of filtered @xmath460-modules @xmath461    [ thm : smoothlp ] a closed point @xmath124 of @xmath462 $ ] is formally smooth if and only if @xmath143 is generic .",
    "let @xmath126 denote the residue field of @xmath124 . by [ thm : pdefring ]",
    ", @xmath444 has dimension @xmath463 since @xmath397 has @xmath2-adic hodge type @xmath138 , this is equal to @xmath464 , which equals @xmath465 by [ thm : adlem ] .",
    "we now analyze the dimension of the tangent space of @xmath444 . by [ thm : localbk ]",
    ", the tangent space of @xmath444 has dimension @xmath466 so , @xmath444 is smooth if and only if @xmath467 equivalently , @xmath468 before proceeding , we introduce some notation . if @xmath231 is a finite dimensional @xmath15-vector space with a continuous @xmath15-linear @xmath155-action , define the @xmath15-vector spaces as in @xcite*3 : @xmath469 the pairing @xmath470 is perfect on @xmath408 , so induces an isomorphism @xmath471 then , by @xcite*proposition  3.8 , @xmath472 using @xcite*corollary  3.8.4 , this last expression equals @xmath473 plugging this into , we see that @xmath444 is formally smooth if and only if @xmath474 .",
    "this happens if and only if @xmath143 is generic by part [ lpgeneric : crys ] of [ thm : lpgeneric ] .",
    "more thorough investigations of the smooth and singular loci in the case @xmath283 and the case @xmath475 and @xmath476 are carried out in @xcite*(a.1 ) and @xcite*7 . in particular , when @xmath283 kisin shows in @xcite*(a.1 ) that @xmath140 $ ] is reduced , and is either smooth or is the union of @xmath477 smooth closed subspaces . when @xmath478 and @xmath476 , bellovin shows in @xcite*7.3 that @xmath479 $ ] is the union of @xmath480 closed subspaces , two of which are smooth , and one of which is singular .    in practice",
    "it is often important to know that given a representation @xmath19 of @xmath155 , the restriction @xmath374 defines a smooth point for any finite extension @xmath336 .",
    "for example , @xmath481 with @xmath482 a nontrivial finite order character defines a smooth point on the corresponding potentially semistable deformation ring , but the restriction @xmath374 to any @xmath483 that trivializes @xmath482 will not .",
    "it is not hard to see that any ( mixed ) pure galois representation ( i.e. one that satisfies the conclusion of the weight  monodromy conjecture ) will define a smooth point after any finite base change .",
    "a similar sufficient condition was noticed by calegari @xcite*lemma  2.6 .",
    "however , as the following example illustrates , the condition that @xmath484 is generic for any finite extension @xmath336 is strictly weaker than either of these .",
    "[ eg ] choose a cocycle @xmath450 of @xmath485 valued in @xmath486 such that the cohomology class of @xmath450 does not lie in @xmath487 .",
    "then the representation @xmath488 is semistable noncrystalline , and if @xmath489 is any finite extension , the weil ",
    "deligne representation @xmath490 is given by @xmath491 where @xmath492 denotes the residue degree of @xmath11 .",
    "a straightforward check shows that @xmath484 is generic , so letting @xmath138 denote the @xmath2-adic hodge type of @xmath19 , the restriction @xmath374 defines a smooth point on @xmath493 $ ] for any finite extension @xmath489 ( where @xmath494 ) .",
    "some related and more detailed computations are carried out in @xcite*7.3 .",
    "[ rmk : gfsame ] let @xmath333 a potentially semistable representation .",
    "we saw in the proof of [ thm : smoothlp ] that @xcite*proposition  3.8 and @xcite*corollary  3.8.4 imply @xmath495 so part  [ lpgeneric : crys ] of [ thm : lpgeneric ] shows @xmath496 if and only if @xmath316 is generic .",
    "we can generalize one direction of this slightly .",
    "let @xmath231 be a representation of @xmath155 on a @xmath411-dimensional @xmath14-vector space such that it s restriction to @xmath483 , for some @xmath336 finite , is isomorphic to @xmath41 with @xmath497 a potentially semistable representation .",
    "then @xmath498 if @xmath316 is generic . indeed , the commutative diagram @xmath499 has injective vertical arrows by restriction - corestriction .",
    "it easily follows that @xmath498 if @xmath500 .",
    "we mention this slight generalization because in our global applications we do not wish to restrict ourselves to cm extensions @xmath501 such that every @xmath68 in @xmath37 splits in @xmath0 .      throughout this subsection",
    "we assume @xmath55 .",
    "we recall the clozel  harris ",
    "taylor group scheme @xmath502 , which is the group scheme over @xmath103 defined as the semidirect product @xmath503 where @xmath105 , and the homomorphism @xmath106 given by @xmath107 and @xmath108 .",
    "we let @xmath504 , and let @xmath505 denote the adjoint action of @xmath102 on @xmath506 , i.e @xmath507 if @xmath508 is a group , @xmath117 is a commutative ring and @xmath509 is a homomorphism , we write @xmath510 for @xmath511 with the adjoint action @xmath512 of @xmath508 .    the following is ( part of ) @xcite*lemma  2.1.1 .",
    "[ thm : gdhoms ] let @xmath508 be a topological group with an open subgroup @xmath513 of index @xmath477 .",
    "fix some @xmath514 .",
    "let @xmath117 be a topological ring .",
    "there is a natural bijection between the following two sets .    1",
    ".   continuous homomorphisms @xmath515 inducing an isomorphism @xmath516 .",
    "triples @xmath517 , where @xmath518 and @xmath519 are continuous homomorphisms and @xmath520 is a perfect @xmath117-linear pairing on @xmath521 satisfying @xmath522 for all @xmath523 and @xmath524 .    under this bijection , @xmath525 for all @xmath526 , and @xmath527 for @xmath528 .",
    "if @xmath508 is a group , @xmath117 is a commutative ring , @xmath515 is a homomorphism , and @xmath226 is an @xmath117-algebra , we will write @xmath529 for the composite of @xmath268 with the map @xmath530 .",
    "if @xmath531 $ ] is a @xmath120-conjugacy class of such homomorphisms , we will write @xmath531\\otimes_a b$ ] for the @xmath532-conjugacy class @xmath533 $ ] .",
    "if @xmath508 is a group , @xmath117 is a commutative ring , @xmath515 is a homomorphism , and @xmath513 is a subgroup of @xmath508 such that @xmath534 ,",
    "we will write @xmath535 for the composite of the restriction of @xmath268 to @xmath513 with the projection @xmath536 . in particular , we view @xmath521 as an @xmath537$]-module via @xmath538 .",
    "we recall @xcite*definition  2.1.6 :    [ def : schur ]",
    "let @xmath508 be a group with index two subgroup @xmath513 .",
    "fix @xmath539 .",
    "let @xmath126 be a field and let @xmath540 be a homomorphism with @xmath541 .",
    "we say that @xmath268 is _ schur _",
    "if all @xmath513-irreducible subquotients of @xmath542 are absolutely irreducible and for all @xmath513-invariant subspaces @xmath543 such that @xmath544 and @xmath545 are irreducible , we have @xmath546 .",
    "note that if @xmath535 is absolutely irreducible , then @xmath268 is schur .",
    "[ [ sec : globalh ] ]    before proceeding with deformation theory , we prove some results on the cohomology of the adjoint representation valued in a finite extension of @xmath15 .",
    "let @xmath0 be a cm field with maximal totally real subfield @xmath37 .",
    "let @xmath1 be a finite set of finite places of @xmath37 containing all those above @xmath2 .",
    "let @xmath126 be a finite extension of @xmath15 , let @xmath547 be a continuous homomorphism inducing an isomorphism @xmath548 , and let @xmath549 .",
    "for each @xmath550 in @xmath0 , let @xmath551 be a choice of complex conjugation .",
    "recall we have assumed @xmath55 .",
    "[ thm : epchar ] let the notation and assumptions be as in [ sec : globalh ] above .",
    "then @xmath552 + \\sum_{v|\\infty } \\frac{d(d+\\mu(c_v))}{2}.\\ ] ]    an easy computation ( see @xcite*lemma  2.1.3 ) shows @xmath553 for each @xmath550 . using @xcite*lemma  2.1.5",
    ", we may assume @xmath268 takes values in @xmath554 , where @xmath555 is the ring of integers of @xmath126 .",
    "the lemma now follows from @xcite*lemma  2.3.3 by an argument as in @xcite*lemma  9.7 .",
    "[ thm : cohom ] let the assumptions and notation be as in [ sec : globalh ] above .",
    "assume further that @xmath556 is with regular @xmath2-adic hodge type for every @xmath557 in @xmath0 , that @xmath558 for every @xmath550 , and that @xmath559 .",
    "if @xmath560 , then the following hold .    1 .",
    "[ cohom : h1dim ] @xmath561 $ ] .",
    "[ cohom : h2 ] @xmath562 .",
    "[ cohom : h1iso ] the natural map @xmath563 is an isomorphism .    the argument is exactly as in the proof of @xcite*theorem  8.2 .",
    "we give the details .",
    "using our assumption that @xmath558 for every @xmath550 , and that @xmath559 , [ thm : epchar ] implies @xmath564,\\ ] ] so parts  [ cohom : h1dim ] and [ cohom : h2 ] are equivalent . using the assumption @xmath560 , there is an injection @xmath565 and all three parts of the lemma will follow from showing @xmath566\\ ] ] for each @xmath68 in @xmath37 .",
    "equivalently , it suffices to show that for each @xmath68 in @xmath37 , the image of @xmath567 has @xmath126-dimension @xmath568 $ ] .",
    "the @xmath126-vector space @xmath569 has a filtration induced by the filtration on @xmath198 , and the image of @xmath570 is contained in the @xmath571 .",
    "it thus suffices to show that for each @xmath68 in @xmath37 , @xmath572.\\ ] ] from the filtered @xmath161-equivariant isomorphism @xmath573 , and the fact that @xmath574 ( see @xcite*3 ) , we have filtered isomorphisms @xmath575 so , we are reduced to showing that @xmath576 $ ] for each @xmath68 in @xmath37 . for any @xmath557 in @xmath0 , since @xmath556 is , there is an isomorphism of filtered @xmath577-modules ( see [ thm : adlem ] ) @xmath578 and since @xmath556 has regular @xmath2-adic hodge type , @xmath579.\\ ] ] if @xmath149 splits in @xmath0 as @xmath580 , then the choice of @xmath351 induces an isomorphism @xmath581 , and @xmath582.\\ ] ] if @xmath149 does not split in @xmath0 , then letting @xmath351 denote the unique place dividing @xmath149 in @xmath0 , we have @xmath583 = 2 $ ] , and there is a filtered isomorphism @xmath584 and we have @xmath585 .",
    "\\qedhere\\ ] ]    we now recall the @xmath102-valued deformation theory of @xcite .    [",
    "def : lift ] let @xmath126 be either a finite extension of @xmath586 or of @xmath15 .",
    "let @xmath508 be a topological group and let @xmath587 be a continuous homomorphism .",
    "let @xmath117 be a pro - artinian local ring with a fixed isomorphism @xmath588 .",
    "a _ lift _ of @xmath118 to @xmath117 is a homomorphism @xmath589 such that @xmath590 and such that for any artinian quotient @xmath591 , the homomorphism @xmath592 is continuous , where we give @xmath593 the discrete topology if @xmath126 is a finite extension of @xmath586 , and the topology as a finite dimensional @xmath126-vector space if @xmath126 is a finite extension of @xmath15 .",
    "a _ deformation _ of @xmath118 to @xmath117 is a @xmath120-conjugacy class of lifts .    for a finite set @xmath594 ,",
    "a @xmath594-_framed lift _ of @xmath118 to @xmath117 is a tuple @xmath595 where @xmath268 is a lift of @xmath118 to @xmath117 and @xmath596 .",
    "we say two @xmath594-framed lifts @xmath597 and @xmath598 to @xmath117 are equivalent if there is @xmath599 such that @xmath600 and @xmath601 for each @xmath602 .",
    "a @xmath594-_framed deformation _ of @xmath118 to @xmath117 is an equivalence class of @xmath594-framed lifts .    if @xmath268 is a lift , we will write @xmath531 $ ] for the corresponding deformation .",
    "if @xmath603 is a @xmath594-framed lift , we will write @xmath604 $ ] for the corresponding @xmath594-framed deformation .",
    "we will introduce a slight variation of the global deformation problem of @xcite*2.3 .",
    "[ def : globaldatum ] a _ global deformation datum _ is a tuple @xmath605 where    * @xmath0 is a cm field with maximal totally real subfield @xmath37 ; * @xmath1 is a finite set of finite places of @xmath37 ; * @xmath606 is a finite set of finite places of @xmath0 such that every @xmath607 is split over some @xmath608 , and @xmath606 contains at most one place above any @xmath608 ; * @xmath35 is the ring of integers of some finite extension of @xmath15 with residue field @xmath36 ; * @xmath609 is a continuous homomorphism ; * @xmath610 is a continuous character with @xmath611 ; * for each @xmath607 , @xmath612 is a quotient of @xmath613 satisfying the following property : if @xmath614 is a lift of @xmath615 to @xmath117 and @xmath616 , then the map @xmath617 induced by @xmath19 factors through @xmath612 if and only if the map @xmath617 induced by @xmath618 factors through @xmath612 .",
    "this differs from the definition in @xcite*2.3 in that our ramification set @xmath1 may contain places that do not split in @xmath501 , and @xmath606 is not required to contain a place above every @xmath608 .",
    "when proving modularity of galois representations , one can use base change and descent to reduce to the case that the ramification set splits in @xmath501 , and for the proof of [ thm : bk ] , which implies theorems  [ thm : bka ] , [ thm : thmb ] , and [ thm : thmc ] from the introduction , it would also suffice to consider this situation because we may also use base change in its proof .",
    "but we wish to have the statement of theorem  [ thm : thmc ] in the above level of generality for other applications where it is not obvious ( at least not to the author ) how to apply base change and descent .",
    "one such application is to the density of automorphic points in deformation rings .",
    "strategy @xcite for proving density of modular points in universal deformation rings is to show that every irreducible component of the universal deformation ring contains a smooth modular point , and then to use the infinite fern of gouva and mazur starting at such a smooth point to  fill out \" the irreducible component .",
    "chenevier @xcite has constructed an infinite fern in the @xmath480-dimensional conjugate self - dual case , assuming @xmath2 is totally split in the cm field @xmath0 . if one knows a priori that automorphic points always define smooth points on the universal deformation ring , then to prove new cases of the density of automorphic points in @xmath480-dimensional conjugate self - dual deformation rings , one now just has to show that every irreducible component contains an automorphic point .",
    "these ideas will be developed further in forthcoming work of the author , and as the results in @xcite make no assumption on the splitting behaviour in @xmath0 of the places in @xmath619 , we also wish to make no such assumption .",
    "[ def : globaldef ] let @xmath620 be a global deformation datum , and let @xmath117 be a @xmath389-algebra .",
    "we say a lift @xmath621 of @xmath118 to @xmath117 is _ type _",
    "@xmath622 if    * @xmath268 factors through @xmath50 ; * @xmath623 ; * for each @xmath607 , the @xmath389-morphism @xmath617 induced by the lift @xmath556 of @xmath615 , factors through @xmath612 .",
    "we say a deformation of @xmath118 to @xmath117 is _ type _",
    "@xmath622 if one ( equivalently any ) lift in its deformation class is type @xmath622 .",
    "we let @xmath624 be the set valued functor on @xmath389 that takes a @xmath389-algebra @xmath117 to the set of deformations of type @xmath622 .",
    "if @xmath624 is representable , we call the representing object the _ universal type _ @xmath622 _ deformation ring _ and denote it by @xmath116 .    for any @xmath625 , we say a @xmath594-framed deformation @xmath626 $ ] of @xmath118 to @xmath117 is _ type _",
    "@xmath622 if @xmath531 $ ] is a type @xmath622 deformation of @xmath118 .",
    "we let @xmath627 be the set valued functor on @xmath389 that takes a @xmath389-algebra @xmath117 to the set of @xmath594-framed deformations of type @xmath622 . if @xmath627 is representable , we call the representing object the _ universal type _ @xmath622 @xmath594-_framed deformation ring _ and denote it by @xmath628 . if @xmath629 , then we will write @xmath630 and @xmath631 for @xmath627 and @xmath628 , respectively , and call @xmath631 the _ universal type _ @xmath622 _ framed deformation ring_.    if @xmath632 is a global deformation datum and @xmath625 , we set @xmath633 note that @xmath634 is naturally a quotient of @xmath635 . if @xmath629 , then we will write @xmath636 for @xmath634 .",
    "the following proposition follows from @xcite*proposition  2.2.9 .",
    "[ thm : globalrep ] let @xmath632 be a global deformation datum , and let @xmath625 .",
    "assume @xmath118 is schur .",
    "the functors @xmath627 and @xmath624 are representable .",
    "there is a canonical @xmath389-morphism @xmath637 .",
    "there is a canonical @xmath389-morphism @xmath638 , and a choice of lift @xmath639 for the universal type @xmath622 deformation @xmath640 $ ] determines an extension of this @xmath389-morphism to an isomorphism @xmath641 \\stackrel{\\sim}{{\\longrightarrow } } r_{{\\mathcal{s}}}^{\\square_t}$ ] .",
    "[ [ sec : globalcomplete ] ]    for the remainder of this section , we fix a global deformation datum @xmath642 with @xmath118 schur , where we will specify the rings @xmath612 in the statements of the following propositions .",
    "let @xmath116 be the universal type @xmath622 deformation ring and let @xmath124 be a closed point of @xmath125 $ ] with residue field @xmath126 .",
    "let @xmath555 be the ring of integers of @xmath126 , and let @xmath268 be a type @xmath622 lift of @xmath118 to @xmath555 such that the map @xmath643 induced by @xmath531 $ ] induces @xmath644 \\rightarrow k$ ] .",
    "set @xmath645 .",
    "[ thm : bigglobalcomplete ] let the notation and assumptions be as in [ sec : globalcomplete ] above , with @xmath646 for every @xmath607 .    1 .",
    "[ bigglobalcomplete : rep ] let @xmath647 be the functor on @xmath648 that sends an @xmath648-algebra @xmath226 to the set of deformations @xmath649 $ ] of @xmath650 to @xmath226 that factor through @xmath50 and satisfy @xmath651 .",
    "the functor @xmath647 is prorepresented by @xmath132 .",
    "[ bigglobalcomplete : tangent ] the tangent space of @xmath128 $ ] at @xmath124 is canonically isomorphic to @xmath652 .",
    "[ bigglobalcomplete : dim ] let @xmath653 be the set of infinite places in @xmath37 , and for every @xmath654 , let @xmath655 be a choice of complex conjugation at @xmath149",
    ". then @xmath132 is isomorphic to a power series over @xmath126 in @xmath656 variables modulo @xmath268 relations with @xmath657 , and @xmath658 - \\sum_{v \\in s_\\infty } \\frac{d(d+\\mu(c_v))}{2}.\\ ] ]    the proof of [ bigglobalcomplete : rep ] is almost identical to that of @xcite*proposition  2.3.5 .",
    "we sketch the details .",
    "we will not use the language of groupoids here , but the results we will reference from @xcite stated in terms of groupoids imply our results stated in terms of functors by @xcite*a.5 .    since @xmath659 , for @xmath607 ,",
    "imposes no condition on our lifts , it is easy to see that if @xmath660 is the deformation datum @xmath661 then there is a canonical isomorphism @xmath662 . for the remainder of the proof , we assume @xmath663 .    for any @xmath648-algebra @xmath226 ,",
    "we let @xmath664 be the set of all finite @xmath35-subalgebras @xmath665 such that @xmath666 = b$ ] .",
    "note that any @xmath667 comes equipped with a canonical @xmath35-algebra map @xmath668 via @xmath669 .",
    "also note that @xmath664 is naturally filtered .",
    "we let @xmath670 be the set valued functor on @xmath648 defined by @xmath671 \\text { is a type } { \\mathcal{s}}\\text { deformation of } { \\overline{r}}\\text { such that } [ r_a]\\otimes_a { \\mathcal{o}}_k = [ r ] \\}.\\ ] ] by @xcite*lemma  2.3.3 , the functor @xmath670 is prorepresented by @xmath132 .",
    "there is a natural morphism of functors @xmath672 that we wish to show is an isomorphism .",
    "for any @xmath648-algebra @xmath226 , and continuous homomorphism @xmath673 , an argument as in @xcite*proposition  9.5 shows that there is some @xmath674 and a continuous homomorphism @xmath675 such that @xmath676 .",
    "if @xmath677 , then such an @xmath678 must by type @xmath622 , so @xmath679 is surjective . to see that it is injective ,",
    "note that for any @xmath648-algebra @xmath226 and any @xmath680 , the @xmath35-algebra generated by the entries of @xmath681 is finite over @xmath35 .",
    "thus , any two lifts of @xmath650 to an @xmath648-algebra @xmath226 defining the same deformation arise from lifts to some @xmath674 that define the same deformation to @xmath117 .",
    "this finishes the proof of part  [ bigglobalcomplete : rep ] .",
    "for part  [ bigglobalcomplete : tangent ] , letting @xmath682 be the space of continuous @xmath406-cocycles of @xmath50 with values in @xmath683 , the map @xmath684 defines an isomorphism from @xmath682 to the @xmath126-vector space of lifts @xmath685 of @xmath650 to the dual numbers @xmath686 $ ] that factor through @xmath50 and satisfy @xmath687 .",
    "two such cocycles @xmath450 and @xmath688 are cohomologous if and only if @xmath689 and @xmath690 are conjugate by an element of @xmath691 , so this map induces a canonical isomorphism from @xmath652 to the @xmath126-vector space of deformations @xmath692 $ ] of @xmath693 to @xmath686 $ ] with @xmath687 , which is isomorphic to the tangent space of @xmath128 $ ] at @xmath124 by part  [ bigglobalcomplete : rep ] .",
    "we now show part  [ bigglobalcomplete : dim ] .",
    "by part  [ bigglobalcomplete : tangent ] , we can fix a surjection @xmath694 \\rightarrow ( r_{{\\mathcal{s}}})_x^\\wedge$ ] with @xmath656 that induces an isomorphism on tangent spaces .",
    "let @xmath695 denote its kernel .",
    "choose a lift @xmath696 of @xmath650 in the universal @xmath132-valued deformation .",
    "we view @xmath697 and @xmath132 as topological rings with the topology as inverse limits of finite dimensional @xmath126-vector spaces .",
    "we can choose a continuous set - theoretic section @xmath698 of the surjection @xmath699 with the property that @xmath700 for any @xmath701 .",
    "then @xmath702 is a continuous set - theoretic lift @xmath703 of @xmath704 with the property that @xmath705 for all @xmath706 .",
    "we can then define a @xmath477-cocycle @xmath450 of @xmath50 valued in @xmath707 by @xmath708 the cohomology class @xmath709 \\in h^2(f(s)/f^+,{\\mathrm{ad}}(r_x)\\otimes_k j/{\\mathfrak{m}}_a",
    "j ) \\cong h^2(f(s)/f^+,{\\mathrm{ad}}(r_x ) ) \\otimes_k j/{\\mathfrak{m}}_a j\\ ] ] does not depend on our choices .",
    "the argument of @xcite*1.6 shows that the map @xmath710 given by @xmath711)$ ] is injective .",
    "hence , @xmath132 is isomorphic to a power series over @xmath126 in @xmath681 variables modulo @xmath268 relations with @xmath657 . since @xmath118 is schur , @xmath712 ( see @xcite*lemma  2.1.7 ) , which implies @xmath713 .",
    "the final claim now follows from [ thm : epchar ] .",
    "[ thm : smallglobalcomplete ] let the assumptions and notation be as in [ sec : globalcomplete ] .",
    "assume that @xmath119 is .",
    "assume that for every @xmath68 in @xmath37 , @xmath149 splits in @xmath0 and @xmath714 contains a place above @xmath149 , which we will denote by @xmath715 .",
    "for each @xmath716 , we fix a galois type @xmath717 and a @xmath2-adic hodge type @xmath718 over @xmath14 ( see [ sec : types ] ) .",
    "take @xmath719 ( see [ thm : pdefring ] ) for @xmath720 , and @xmath646 for each @xmath721 .    1 .",
    "[ smallglobalcomplete : rep ] let @xmath647 be the functor on @xmath648 that sends an @xmath648-algebra @xmath226 to the set of deformations @xmath649 $ ] of @xmath650 to @xmath226 that factor through @xmath50 , satisfy @xmath651 , and are such that @xmath722 is potentially semistable with galois type @xmath717 and @xmath2-adic hodge type @xmath718 for each @xmath723 .",
    "the functor @xmath647 is prorepresented by @xmath132 .",
    "[ smallglobalcomplete : tangent ] the tangent space of @xmath128 $ ] at @xmath124 is canonically isomorphic to @xmath724 .",
    "since @xmath659 , for @xmath725 , imposes no condition on our lifts , it is easy to see that if @xmath660 is the deformation datum @xmath726 there is a canonical isomorphism @xmath662 , and we may assume @xmath727 . let @xmath728 , and let @xmath729 be the universal type @xmath730 deformation ring .",
    "note @xmath731 . by [ thm : globalrep ] ,",
    "choosing a lift @xmath732 in the universal type @xmath730 deformation yields a morphism @xmath733 .",
    "it is easy to see that @xmath734 , with @xmath735 the natural surjection . using this and part  [ bigglobalcomplete : rep ] of [ thm : bigglobalcomplete ]",
    ", we see that @xmath132 prorepresents the functor on @xmath648 that sends an @xmath648-algebra @xmath226 to the set of deformations @xmath649 $ ] of @xmath650 to @xmath226 that factor through @xmath50 , satisfy @xmath651 , and are such that the induced map @xmath736 factors through @xmath737 for each @xmath716 , which happens if and only if @xmath722 is potentially semistable with galois type @xmath717 and @xmath2-adic hodge type @xmath718 by [ thm : pdefring ] .",
    "this shows part  [ smallglobalcomplete : rep ] .",
    "we now show part  [ smallglobalcomplete : tangent ] .",
    "part  [ smallglobalcomplete : rep ] together with part  [ bigglobalcomplete : tangent ] of [ thm : bigglobalcomplete ] , implies that the tangent space of @xmath128 $ ] at @xmath124 is canonically isomorphic to the subspace of @xmath652 consisting of cohomology classes @xmath738 $ ] such that for any cocycle @xmath450 in the class @xmath738 $ ] , the local lift @xmath739 lies in the tangent space of @xmath740 $ ] at @xmath124 , for each @xmath716 . by [ thm : localbk ]",
    ", this happens if and only if @xmath738 $ ] lies in the kernel of @xmath741 since @xmath119 is , @xmath742 is for each @xmath723 .",
    "thus , the tangent space of @xmath128 $ ] at @xmath124 is canonically isomorphic to @xmath743    we note that in [ thm : smallglobalcomplete ] above , the existence of @xmath744 $ ] implicitly assumes that @xmath128 \\ne 0 $ ] , which ( at the very least ) implies a certain compatibility between @xmath119 and the local @xmath2-adic hodge theory data @xmath717 and @xmath718 . in our applications",
    ", we will be given a potentially semistable @xmath2-adic representation @xmath19 and we will define @xmath622 using @xmath19 . the existence of this @xmath19 will then imply @xmath128 \\ne 0 $ ] .",
    "[ thm : globalsmooth ] let the notation and assumptions be as in [ sec : globalcomplete ] , with @xmath646 for every @xmath607 .",
    "assume also that @xmath745 for every choice of complex conjugation @xmath746 , and that @xmath747 is with regular @xmath2-adic hodge type ( see [ sec : types ] ) for every @xmath557 in @xmath0 .    if @xmath748 , then @xmath132 is formally smooth of dimension @xmath133 $ ] .    using our assumption that @xmath745 for every complex conjugation @xmath746 , part  [ bigglobalcomplete : dim ] of [ thm : bigglobalcomplete ] implies @xmath749.\\ ] ] thus",
    ", it suffices to show the tangent space of @xmath132 , which is isomorphic to @xmath652 by part  [ bigglobalcomplete : tangent ] of [ thm : bigglobalcomplete ] , has @xmath126-dimension @xmath133 $ ] .",
    "this follows from part  [ cohom : h1dim ] of [ thm : cohom ] .",
    "this section reviews the automorphic theory that we will use to prove our main theorems .",
    "we first introduce some notation and assumptions that will be used throughout this section .",
    "let @xmath750 be the set of tuples of integers @xmath751 such that @xmath752 .",
    "if @xmath0 is a cm field with maximal totally real subfield @xmath37 , and @xmath259 is any characteristic @xmath220 field containing all embeddings of @xmath0 into an algebraic closure of @xmath259 , then we let @xmath753 denote the subset of @xmath754 of tuples @xmath755 such that @xmath756 , where @xmath51 is the nontrivial element of @xmath757 .    if @xmath0 is a number field , @xmath758 is a continuous character whose restriction to the connected component of @xmath759 is given by @xmath760 for some integers @xmath761 , and @xmath762 is an isomorphism , we let @xmath763 be the continuous character given by @xmath764      let @xmath0 be either a cm or totally real number field with maximal totally real subfield @xmath37 .",
    "let @xmath746 be a choice of complex conjugation .",
    "[ [ sec : pol ] ]    following @xcite*2.1 , we say that a pair @xmath765 is a _ polarized automorphic representation _ of @xmath766 if    * @xmath57 is an automorphic representation of @xmath766 ; * @xmath767 is a continuous character such that for all @xmath550 , the value @xmath768 is independent of @xmath149 , and equals @xmath769 if @xmath0 is cm ; * @xmath770 .",
    "we say that an automorphic representation @xmath57 of @xmath766 is _ polarizable _ if there is a character @xmath482 such that @xmath765 is a polarized automorphic representation .",
    "if @xmath0 is a totally real field and @xmath771 is polarized , then we say that @xmath57 is _ self - dual_. if @xmath0 is cm and @xmath772 is polarized , then we say that @xmath57 is _ conjugate self - dual_. recall that an automorphic representation @xmath57 of @xmath766 is called _ regular algebraic _ if @xmath773 has the same infinitesimal character as an irreducible algebraic representation of @xmath774 . if @xmath775 , then we let @xmath776 denote the irreducible algebraic representation of @xmath777 which is the tensor product over @xmath778 of the irreducible algebraic representations with highest weight @xmath761 .",
    "we say a regular algebraic automorphic representation @xmath57 of @xmath766 has _ weight _",
    "@xmath779 if @xmath773 has the same infinitesimal character as @xmath780 .",
    "we will say a polarized automorphic representation @xmath765 of @xmath766 is cuspidal if @xmath57 is .",
    "we will say a polarized automorphic representation @xmath765 of @xmath766 is regular algebraic if @xmath57 is . in this case",
    "@xmath482 is necessarily an algebraic character .",
    "we have the following theorem , due to the work of many people .",
    "we refer the reader to @xcite*theorem  2.1.1 and the references contained there ( noting that the assumption of an iwahori fixed vector in part ( 4 ) of @xcite*theorem  2.1.1 can be removed by the main result of @xcite ) .",
    "[ thm : autgalrep ] let @xmath0 be either a cm or totally real number field with maximal totally real subfield @xmath37 .",
    "let @xmath765 be a regular algebraic , polarized , cuspidal automorphic representation of @xmath766 , of weight @xmath779 .",
    "fix a rational prime @xmath2 and an isomorphism @xmath762 .",
    "then there is a continuous semisimple representation @xmath781 satisfying the following properties .    1 .",
    "[ autgalrep : pol ] there is a perfect symmetric pairing @xmath520 on @xmath782 such that for any @xmath783 and @xmath784 , @xmath785 2 .",
    "[ autgalrep : pss ] for all @xmath557 , @xmath786 is potentially semistable , and for any continuous embedding @xmath787 , @xmath788 3 .",
    "[ autgalrep : locglob ] for any finite place @xmath351 , @xmath789    we note that an argument using the baire category theorem and the compactness of @xmath790 shows that we can assume @xmath61 takes values in @xmath53 with @xmath35 the ring of integers of some finite extension of @xmath15 , and that the perfect pairing @xmath520 descends to a perfect pairing on @xmath791 .      in this subsection , we assume that @xmath2 is odd .",
    "we recall some constructions from @xcite*3.3 and @xcite*2 ( see also @xcite*6 ) . before doing so",
    ", we note that in @xcite*3.3 there are running assumptions that a certain ramification set denoted @xmath792 there is nonempty , that ( in our notation ) @xmath793 , and that @xmath0 is the composite of a quadratic imaginary field and @xmath37 .",
    "none of these assumptions are necessary for what we need .",
    "let @xmath0 be a cm field with maximal totally real subfield @xmath37 .",
    "let @xmath51 denote the nontrivial element of @xmath170 .",
    "we assume that @xmath501 is unramified at all finite places and that every place above @xmath2 in @xmath37 splits in @xmath0 .",
    "we assume that @xmath794 and that if @xmath82 is even , then @xmath795 \\equiv 0 \\pmod 4.\\ ] ] we also fix a finite extension @xmath14 of @xmath15 with ring of integers @xmath35 and residue field @xmath36 .",
    "we assume @xmath14 contains all embeddings of @xmath0 into an algebraic closure of @xmath14 .",
    "[ [ sec : invol ] ]    let @xmath796 , and let @xmath797 be an involution of the second kind on @xmath226 . then the pair @xmath798 defines a reductive @xmath37-group @xmath188 by @xmath799 for any @xmath37-algebra @xmath221 . since @xmath800 \\equiv 0 \\pmod 4 $ ] if @xmath82 is even , we can choose the involution @xmath797 on @xmath226 such that    1 .",
    "@xmath801 is quasi - split for every finite place @xmath149 of @xmath37 ; 2 .",
    "@xmath802 , the totally definite unitary group , for every infinite place @xmath149 of @xmath37 .",
    "since @xmath796 , the data of @xmath803 is equivalent to a hermitian form @xmath804 on @xmath805 , and a choice of lattice @xmath806 in @xmath805 such that @xmath807 yields a maximal order @xmath808 of @xmath226 such that @xmath809 .",
    "this maximal order defines a model of @xmath188 over @xmath810 , that we again denote by @xmath188 . for a finite place @xmath149 of @xmath37 that splits in @xmath0",
    ", we can find an isomorphism @xmath811 such that @xmath812 .",
    "writing @xmath813 , the choice of @xmath351 gives an isomorphism @xmath814 by @xmath815 .",
    "this extends to an isomorphism @xmath816 , and @xmath817 .",
    "let @xmath818 denote the set of places of @xmath37 above @xmath2 .",
    "for each @xmath819 , fix a choice @xmath820 of place of @xmath0 dividing @xmath149 , and let @xmath821 .",
    "let @xmath822 be the set of embeddings @xmath823 , and let @xmath824 be the set of embeddings @xmath825 that give rise to a place in @xmath826 .",
    "thus , restriction to @xmath37 gives a bijection @xmath827 .",
    "given @xmath828 , we let @xmath829 denote the irreducible algebraic representation defined over @xmath21 with highest weight @xmath830 we choose a @xmath53-stable lattice @xmath831 in @xmath832 . then for any @xmath833 , we define a representation @xmath834 where we have written @xmath835 for @xmath836 if @xmath137 gives rise to the place @xmath351 .",
    "the @xmath35-lattice @xmath837 in the @xmath14-vector space @xmath838 is stable under @xmath839 .",
    "if @xmath117 is any @xmath35-algebra and @xmath840 is an open compact subgroup of @xmath841 such that @xmath842 , then we define a space of automorphic forms @xmath843 to be the space of functions @xmath844 such that @xmath845 for all @xmath846 and @xmath847 . if @xmath4 is any compact subgroup of @xmath841 such that @xmath848 , then we define @xmath849 with the limit over all open compact subgroups @xmath840 containing @xmath4 such that @xmath842 .",
    "note that if @xmath117 is flat over @xmath35 , then @xmath850 .",
    "[ thm : unitaryaut ] fix an embedding @xmath851 , and view @xmath280 as an @xmath35-algebra via @xmath62 .    1 .",
    "[ unitaryaut : adm ] @xmath852 is a semisimple admissible representation of @xmath841 .",
    "[ unitaryaut : bc ] let @xmath57 be an regular algebraic conjugate self - dual representation of @xmath766 of weight @xmath182 . then there is an irreducible subrepresentation @xmath853 of @xmath852 such that the following hold . *",
    "if @xmath149 is a finite place of @xmath37 that splits as @xmath813 in @xmath0 , then @xmath854 . * if @xmath149 is a finite place of @xmath37 inert in @xmath0 , and @xmath855 is unramified , then @xmath73 has a fixed vector for some hyperspecial maximal compact subgroup of @xmath856 .",
    "for part  [ unitaryaut : adm ] , see @xcite*part  1 of proposition  3.3.2 . for part",
    "[ unitaryaut : bc ] , @xcite*thorme  5.4 implies that there is an irreducible subrepresentation @xmath853 of @xmath852 such that @xmath57 is a weak base change ( see @xcite*4.10 ) of @xmath93 .",
    "then applying @xcite*corollaire  5.3 and strong multiplicity one for @xmath29 gives the result .",
    "[ [ sec : heckeops ] ]    now fix an open compact subgroup @xmath840 of @xmath841 such that @xmath842 . fix a set of finite places @xmath1 of @xmath37 containing @xmath818 and all finite places at which @xmath840 is not hyperspecial maximal compact . for each finite place @xmath351 of @xmath0 split over @xmath857 of @xmath37 , the hecke operators @xmath858 \\big)\\ ] ] for @xmath859 , as well as @xmath860 , act on @xmath843 . here",
    "@xmath861 denotes a choice of uniformizer of @xmath862 , and the operators @xmath863 do not depend in the choice of @xmath861 .",
    "we let @xmath864 be the @xmath117-subalgebra of @xmath865 generated by the @xmath866 , for all @xmath351 as above . if @xmath867 , then we write @xmath868 for @xmath869 .",
    "[ thm : galrepunit ] let @xmath870 be finite extension , and @xmath871 \\rightarrow l$ ] be an @xmath14-algebra morphism . there is a continuous absolutely semisimple representation @xmath872 such that the following hold .    1 .",
    "[ galrepunit : pol ] there is a perfect symmetric paring @xmath520 on @xmath873 such that for any @xmath874 and @xmath784 , @xmath875 2 .",
    "[ galrepunit : trace ] for any finite place @xmath351 in @xmath0 split over @xmath857 in @xmath37 , the characteristic polynomial of @xmath876 is @xmath877 3 .",
    "[ galrepunit : pss ] for all @xmath557 in @xmath0 , @xmath878 is potentially semistable , and is semistable if @xmath879 contains the iwahori subgroup , where @xmath149 denotes the place of @xmath37 below @xmath351 . for any @xmath880 ,",
    "@xmath881 in particular , @xmath878 has regular @xmath2-adic hodge type .",
    "the finite flat @xmath35-algebra @xmath868 acts faithfully on @xmath882 with the direct sum taken over irreducible subrepresentations of @xmath883 , and @xmath884 acts on each @xmath885 by some @xmath14-algebra morphism @xmath886 \\rightarrow { \\overline{\\mathbb{q}}}_p$ ] .",
    "thus , @xmath887 for some irreducible subrepresentation @xmath93 of @xmath883 .",
    "we now apply @xcite*theorem  2.3 , letting @xmath397 be the representation denoted @xmath888 in @xcite*theorem  2.3 , noting that :    * we may assume that @xmath397 takes values in @xmath11 by chebotarev density , since @xmath889 for all @xmath351 of @xmath0 split over @xmath890 in @xmath37 and @xmath859 .",
    "* we may assume that the pairing is symmetric by applying @xcite*theorem  1.2 to the construction in the proof of @xcite*theorem  2.3 .",
    "more specifically , the construction in @xcite*theorem  2.3 shows there is a partition @xmath891 and factorizations @xmath892 , such that @xmath893 where @xmath894 is the galois representation associated to a regular algebraic conjugate self - dual cuspidal automorphic representation of @xmath895 , and @xmath896 is a character satisfying @xmath897 .",
    "there is a symmetric perfect pairing for @xmath894 with multiplier @xmath898 by part  [ autgalrep : pol ] of [ thm : autgalrep ] ( which uses @xcite*theorem  1.2 ) .",
    "this defines a symmetric perfect pairing for @xmath899 with multiplier @xmath900 . defining the obvious symmetric pairing on @xmath901 with multiplier @xmath902 , tensoring these two , and taking the direct sum over @xmath204 yields a symmetric perfect pairing for @xmath397 with multiplier @xmath903 .",
    "recall the group scheme @xmath102 and its canonical character @xmath904 of  [ sec : global ] .",
    "the following is a standard application of [ thm : galrepunit ] and [ thm : gdhoms ] .",
    "[ thm : residrep ] let @xmath905 be a maximal ideal of @xmath868 .",
    "there is a continuous homomorphism @xmath906 with @xmath907 , satisfying the following :    1 .",
    "if @xmath351 is a finite place of @xmath0 split over @xmath857 of @xmath37 , then @xmath908 has characteristic polynomial @xmath909 2 .",
    "@xmath910 .",
    "we now fix a maximal ideal @xmath905 of @xmath868 , and let @xmath911 be as in [ thm : residrep ] . enlarging @xmath14 if necessary , we may assume that @xmath912 . arguing exactly as in the proof of @xcite*proposition  3.4.4",
    ", we have the following lemma .",
    "[ thm : galrephecke ] assume that @xmath913 is absolutely irreducible .",
    "then there is a continuous lift @xmath914 of @xmath915 , unique up to conjugacy , satisfying the following :    1 .",
    "[ galrephecke : frob ] if @xmath351 is a finite place of @xmath0 split over @xmath857 of @xmath37 , then @xmath908 has characteristic polynomial @xmath916 2 .   @xmath917 .    for the remainder of this subsection",
    "we assume that @xmath913 is absolutely irreducible .",
    "fix an @xmath14-algebra morphism @xmath918 \\rightarrow e$ ] .",
    "the representation @xmath397 of [ thm : galrepunit ] is , and for each @xmath557 , we let @xmath919 be its @xmath2-adic hodge type .",
    "let @xmath606 be a finite set of places in @xmath0 each of which is split over some @xmath920 , containing @xmath826 , and such that @xmath921 .",
    "we consider the global deformation datum @xmath922 and let @xmath116 be the universal type @xmath622 deformation ring ( see  [ thm : globalrep ] ) .",
    "[ thm : heckedef ] assume that @xmath923 contains the iwahori subgroup for each @xmath924 .    1 .",
    "[ heckedef : types ] the lift @xmath914 of @xmath118 from [ thm : galrephecke ] is of type @xmath622 , and the induced @xmath389-morphism @xmath925 is surjective .",
    "[ heckedef : free ] denote again by @xmath124 the composite @xmath128 \\rightarrow { \\mathbb{t}}_\\lambda^s(u)_{{\\mathfrak{m}}}[1/p ] \\xrightarrow{x } e$ ] .",
    "the localization and completion @xmath132 acts faithfully on @xmath926 if and only if @xmath927 .",
    "the fact that @xmath928 factors through @xmath50 and has @xmath929 is contained in [ thm : galrephecke ] . to show that @xmath928 is of type @xmath622",
    ", it remains to show that for every @xmath607 , the local lift @xmath930 factors through the given local lifting ring @xmath612 .",
    "for @xmath931 , this is automatic , so we only need to show it for @xmath932 .",
    "since @xmath933 is reduced and finite flat over @xmath35 , it suffices to show that for any finite extension @xmath870 , and any @xmath14-algebra morphism @xmath934 \\rightarrow l$ ] , that the representation @xmath935 induces an @xmath14-algebra morphism @xmath936 \\rightarrow l$ ] that factors through @xmath937 $ ] for every @xmath932 .",
    "this happens if and only if for every @xmath932 , the local representation @xmath938 is semistable with @xmath2-adic hodge type @xmath718 .",
    "this follows from part  [ galrepunit : pss ] of [ thm : galrepunit ] , since @xmath923 contains the iwahori subgroup for each @xmath819 , and the @xmath2-adic hodge type of @xmath938 depends only on its associated graded , which in turns depends only on @xmath939 .",
    "this shows that @xmath928 is of type @xmath622 . that the induced @xmath389-algebra map is surjective follows from part  [ galrephecke : frob ] of [ thm : galrephecke ] and chebotarev density . for part",
    "[ heckedef : free ] , first note that since @xmath1 contains all places at which @xmath840 is not hyperspecial maximal compact , the finite dimensional @xmath14-vector space @xmath940 $ ] is a faithful and semisimple @xmath941$]-module .",
    "then @xmath942 is a finite dimensional @xmath14-vector space spanned by the eigenforms with @xmath941$]-eigensytem @xmath124 , and @xmath943 .",
    "it follows that @xmath132 acts on the @xmath14-vector space @xmath944 through the surjection to its residue field @xmath14 .",
    "throughout this section @xmath2 will be an odd prime and @xmath14 will be a finite extension of @xmath15 with ring of integers @xmath35 and residue field @xmath36 .",
    "let @xmath0 be a cm field with maximal totally real subfield @xmath37 .",
    "let @xmath746 be a fixed choice of complex conjugation .",
    "let @xmath1 be a finite set of places of @xmath37 containing all places above @xmath2 .      in this subsection",
    "we prove our main theorem on adjoint selmer groups . before doing so , we first recall the definition of an adequate subgroup of @xmath70 .",
    "let @xmath508 be a subgroup of @xmath70 , and assume that @xmath36 contains all eigenvalues of all elements of @xmath508 .",
    "let @xmath945 be the lie algebra of @xmath70 with the adjoint @xmath508-action .",
    "let @xmath946 be the centre of @xmath506 ; note @xmath947 .",
    "the following is @xcite*definition  2.20 ( using @xcite*lemma  a.1 ) .",
    "let @xmath952 be a continuous homomorphism .",
    "we recall that @xmath510 denotes @xmath42 with the adjoint @xmath50-action @xmath512 .",
    "after conjugating , we can assume that @xmath268 takes values in @xmath953 , and we let @xmath954 .",
    "[ thm : bk ] assume there is a finite extension @xmath56 of cm fields , a regular algebraic polarizable cuspidal automorphic representation @xmath57 of @xmath58 , and an isomorphism @xmath762 such that the following hold :          using [ thm : cohom ] , parts  [ bk : h2 ] and  [ bk : h1 ] are implied by [ bk : bk ] . to prove @xmath958",
    ", we first note that we are free to enlarge @xmath1 , so we can ( and do ) assume that @xmath1 contains at least one finite place not above @xmath2 .",
    "we are also free to replace @xmath0 with any finite extension @xmath56 of cm fields indeed , let @xmath959 denote the maximal totally real subfield of @xmath11 and @xmath960 the set of places of @xmath959 above @xmath1 .",
    "then @xmath961 is galois over @xmath959 and @xmath962 canonically isomorphic to an open subgroup @xmath963 of @xmath50 .",
    "the restriction on cohomology to @xmath963 is injective by considering restriction - corestriction , then via the isomorphism @xmath964 and inflation to @xmath965 , we have an injection @xmath966 such that the following diagram commutes @xmath967 thus @xmath968 injects into @xmath969 , so the former is trivial if the latter is . in particular",
    ", we may assume @xmath970 in the statement of the theorem .",
    "note that if @xmath971 is any continuous character , then by [ thm : gdhoms ] there is a continuous homomorphism @xmath972 such that @xmath973 and @xmath974 .",
    "there is an isomorphism @xmath975 of @xmath50-modules , so using @xcite*lemma  4.1.4 , we can twist @xmath268 and @xmath57 , and assume @xmath57 is conjugate self - dual .    let @xmath818 be the set of places above @xmath2 in @xmath37 , and for each @xmath924 , choose some @xmath976 in @xmath0 .",
    "let @xmath977 .",
    "using cyclic base change @xcite*theorem  4.2 of chapter  3 , further replacing @xmath0 by a solvable extension , we may assume that @xmath501 , @xmath268 , @xmath118 , and @xmath57 satisfy :    1 .",
    "@xmath501 is unramified at all finite places , and every @xmath608 splits in @xmath0 ; 2 .   if @xmath82 is even , then @xmath800 \\equiv 0 \\pmod 4 $ ] ; 3 .",
    "[ lotsofass : galrepaut ] @xmath978 , and @xmath57 is conjugate self - dual ; 4 .   @xmath979 and @xmath980 is adequate ; 5 .",
    "@xmath981 has iwahori fixed vectors for every @xmath932 .    enlarging @xmath14 if necessary , we assume that @xmath14 contains all embedding of @xmath0 into @xmath982 , and that @xmath36 contains the eigenvalues of all elements in the image of @xmath983 .",
    "let @xmath984 be such that @xmath182 is the weight of @xmath57 .",
    "let @xmath188 be the @xmath810-group scheme of [ sec : invol ] .",
    "recall that for any finite place @xmath351 of @xmath0 split over @xmath37 , we have an isomorphism @xmath814 . for any @xmath35-algebra @xmath117 , and compact subgroup @xmath4 of @xmath841 with @xmath848",
    ", we let @xmath985 be the @xmath117-module of automorphic forms of [ sec : invol ] . viewing @xmath280 as an @xmath35-algebra via @xmath62 , by [ thm :",
    "unitaryaut ] there is an irreducible subrepresentation @xmath93 of @xmath852 such that    1 .",
    "if @xmath149 is a finite place of @xmath37 that splits as @xmath813 in @xmath0 , then @xmath854 ; 2 .",
    "[ lotsofass : basechange ] if @xmath149 is a finite place of @xmath37 inert in @xmath0 , and @xmath855 is unramified , then @xmath73 has a fixed vector for some hyperspecial maximal compact subgroup of @xmath856 .      1 .",
    "[ lotsofass : iw ] @xmath923 is the iwahori subgroup of @xmath987 for each @xmath819 ; 2 .",
    "[ lotsofass : ufixed ] @xmath988 ; 3 .",
    "[ lotsofass : hyper ] @xmath989 is a hyperspecial maximal compact subgroup for every @xmath890 ; 4 .",
    "[ lotsofass : small ] for all @xmath990 , the group @xmath991 contains no element of order @xmath2 .    since we have assumed that @xmath1 contains at least one finite place not above @xmath2 , assumptions [ lotsofass : iw ] , [ lotsofass : hyper ] , and [ lotsofass : small ] can be satisfied simultaneously by letting @xmath992 be sufficiently small for some @xmath993 .",
    "let @xmath868 be the hecke algebra in [ sec : heckeops ] .",
    "since @xmath994 , there is an action of @xmath868 on @xmath885 and it acts via an @xmath14-algebra morphism @xmath995 .",
    "indeed , @xmath868 acts on @xmath885 via a homomorphism @xmath871 \\rightarrow { \\mathbb{c}}$ ] that factors through @xmath14 by assumptions [ lotsofass : galrepaut ] and [ lotsofass : basechange ] , local - global compatibility ( i.e. part  [ autgalrep : locglob ] of  [ thm : autgalrep ] ) , and that @xmath996 takes values in @xmath18 .",
    "moreover , the galois representation @xmath997 of [ thm : galrepunit ] is isomorphic to @xmath998 .",
    "let @xmath905 be the maximal ideal of @xmath868 containing @xmath215 .",
    "we can choose a continuous homomorphism @xmath999 as in [ thm : residrep ] , such that @xmath1000 .",
    "in particular , @xmath913 is absolutely irreducible .",
    "then [ thm : galrephecke ] gives a lift @xmath914 of @xmath1001 , and letting @xmath650 be the composite @xmath1002 the lifts @xmath650 and @xmath268 of @xmath118 define the same deformation .",
    "for each @xmath1003 , let @xmath715 be a choice of place in @xmath0 dividing @xmath149 , and let @xmath1004 . for each @xmath932 ,",
    "let @xmath1005 be the @xmath2-adic hodge type of @xmath19 at @xmath715 .",
    "we consider the global deformation datum ( see  [ def : globaldatum ] ) @xmath1006 where      we let @xmath116 be the universal type @xmath622 deformation ring ( see  [ def : globaldef ] and  [ thm : globalrep ] ) , and let @xmath1010 . by part  [ heckedef : types ] of [ thm : heckedef ] ,",
    "the deformation @xmath1011 $ ] of @xmath1001 is of type @xmath622 , and there is a surjective @xmath389-algebra morphism @xmath1012 . again",
    "denote by @xmath124 the @xmath14-algebra morphism @xmath128 \\rightarrow { \\mathbb{t}}_\\lambda(u)_{{\\mathfrak{m}}}[1/p ] \\xrightarrow{x } e$ ] .",
    "make a choice of lift for the universal type @xmath622 deformation so that the specialization @xmath650 of this lift via @xmath1013 \\rightarrow e$ ] is equal to @xmath268 .",
    "then , by [ thm : smallglobalcomplete ] , @xmath1014 if and only if @xmath927 , and this happens if and only if @xmath132 acts faithfully on @xmath926 by part  [ heckedef : free ] of  [ thm : heckedef ] .",
    "our choice of lift for the universal type @xmath622 deformation gives a @xmath389-morphism @xmath1015 .",
    "we denote again by @xmath124 the induced @xmath389-morphisms @xmath1016 \\rightarrow r_{{\\mathcal{s}}}[1/p ] \\xrightarrow{x } e \\quad \\text{and } \\quad      x : r_{\\tilde{v}}[1/p ] \\rightarrow r_{{\\mathcal{s}}}[1/p ] \\xrightarrow{x } e \\quad \\text{for each } \\tilde{v } \\in { \\widetilde{s}}.\\ ] ] note that for each @xmath1017 , the morphism @xmath1018 \\rightarrow e$ ] corresponds to the local representation @xmath1019 . since @xmath57 is a cuspidal representation of @xmath766 , it is generic , and its local factors @xmath1020 at all finite places are generic",
    ". then [ thm : automorphicwd ] implies that @xmath1021 is generic for all finite places @xmath351 .",
    "then , by [ thm : localdefl ] , [ thm : pdefring ] , and [ thm : smoothlp ] ,    * if @xmath1022 , then @xmath1023 is formally smooth over @xmath14 of dimension @xmath411 ; * if @xmath1024 , then @xmath1023 is formally smooth over @xmath14 of dimension @xmath1025 $ ] ( here we used that the @xmath2-adic hodge type of @xmath1026 is regular by part  [ galrepunit : pss ] of [ thm : galrepunit ] ) .",
    "we now use the argument of @xcite*theorem  6.8 .",
    "there are assumptions there that the local deformation rings at places @xmath932 are crystalline deformation rings , and that @xmath1029 for @xmath819 , but these assumptions are not used in what we need here . since @xmath979 and @xmath1030 has adequate image , the proof of @xcite*theorem  6.8 using @xcite*proposition  7.1 in place of @xcite*proposition  4.4 , c.f .",
    "@xcite*proposition  7.2 , shows there are nonnegative integers integers @xmath681 and @xmath248 , such that letting        1 .",
    "[ ass : rinfty ] there is a local @xmath35-algebra morphism @xmath1034 and a surjection @xmath1035 of @xmath636-algebras with @xmath1036 in its kernel .",
    "2 .   there is a surjection @xmath1037 of @xmath33 modules with kernel @xmath1038 , where the @xmath33-module structure of @xmath1039 is via the surjection @xmath1035 of [ ass : rinfty ] .",
    "3 .   @xmath34 is a finite free @xmath653-module .",
    "[ ass : num ] @xmath1040 $ ] .",
    "we note that @xcite*theorem  6.8 does not state [ ass : rinfty ] , but only that the action of @xmath653 on @xmath34 ( denoted @xmath1041 there ) factors through the action of @xmath33 on @xmath34 .",
    "however , the patching patching part of the argument in @xcite*theorem  6.8 is quoted ( in @xcite*lemma  6.10 ) from @xcite*theorem  3.6.1 , where [ ass : rinfty ] is shown ( in particular , see @xcite*sublemma in the proof of theorem  3.6.1 ) . also , in [ ass : num ] we have used that the @xmath1042 in @xcite*theorem  6.8 is @xmath82 in our case .",
    "denote again by @xmath124 the @xmath14-algebra morphism @xmath1043 \\rightarrow r_{{\\mathcal{s}}}[1/p ] \\xrightarrow{x } e$ ] and let @xmath1044 .",
    "note that @xmath1045 .",
    "this together with the fact that @xmath34 is finite free over @xmath653 implies we can find an @xmath34-regular sequence of length @xmath1046 in @xmath1047 and @xmath1048 where the first equality follows from @xcite*theorem  23.3 and the middle inequality is @xcite*exercise  16.5 .",
    "on the other hand , using [ ass : locsmooth ] , [ ass : rinfty ] , and [ ass : num ] above , we deduce that @xmath1049 $ ] is formally smooth over @xmath14 of dimension @xmath1050 + g = d^2{\\lvert s \\rvert } + q.\\ ] ] since @xmath1051 is regular , a theorem of serre @xcite*theorem  19.2 and the auslander ",
    "buchsbaum formula @xcite*theorem  19.1 imply that @xmath1052 is a finite free @xmath1051-module .",
    "then @xmath1053 is a finite free @xmath1054-module . but",
    "@xmath1055 and the action of @xmath1054 on it factors through @xmath132 .",
    "this shows @xmath132 acts faithfully on @xmath926 , which completes the proof of the theorem .",
    "we recall the setup .",
    "we have a cm field @xmath0 with maximal totally real subfield @xmath37 and a finite set of finite places @xmath1 of @xmath0 containing all places above @xmath2 .",
    "we fix a choice of complex conjugation @xmath746 .",
    "we are given a continuous absolutely irreducible representation @xmath1056 we assume there is a continuous totally odd character @xmath44 and an invertible symmetric matrix @xmath45 such that the pairing @xmath527 on @xmath47 is perfect and satisfies @xmath1057 since @xmath19 is absolutely irreducible , @xmath45 is unique up to scalar .",
    "the adjoint representation of @xmath5 on @xmath1058 extends to an action of @xmath50 by letting @xmath51 act by @xmath1059 , and this is independent of the choice of @xmath51 and of @xmath45 .    by choosing a @xmath5-stable @xmath35-lattice in @xmath1060",
    ", we may assume that @xmath19 takes values in @xmath53 .",
    "the semisimplification of its reduction modulo the maximal ideal of @xmath35 does not depend on the choice of lattice , and we denote it by @xmath54 .",
    "assuming there is a finite extension @xmath56 of cm fields , a regular algebraic polarizable cuspidal automorphic representation @xmath57 of @xmath58 , and an isomorphism @xmath762 such that :        by [ thm : gdhoms ] , we can define a continuous homomorphism @xmath1062 such that @xmath1063 and @xmath123 , and there is an isomorphism @xmath1064 of @xmath50-representations .",
    "we may also assume @xmath268 takes values in @xmath953 and letting @xmath954 , that @xmath1065 .",
    "theorem  [ thm : bka ] then follows from [ thm : bk ] .",
    "we have a totally real field @xmath37 and a finite set of finite places @xmath1 of @xmath37 containing all places above @xmath2 .",
    "let @xmath78 be the maximal extension of @xmath37 unramified outside @xmath1 and all places above @xmath79 .",
    "let @xmath80 be a continuous , absolutely irreducible representation , and let @xmath192 denote the representation space of @xmath19 .",
    "we assume that @xmath19 satisfies one of the following :    1 .",
    "[ bagain : orthogonal ] @xmath19 factors through a map @xmath81 , that we again denote by @xmath19 , with totally even multiplier character @xmath119 ; 2 .",
    "[ bagain : symplectic ] @xmath82 is even and @xmath19 factors through a map @xmath83 , that we again denote by @xmath19 , with totally odd multiplier character @xmath119 .",
    "if we are in the go - case , then we let @xmath41 and @xmath84 denote the lie algebra @xmath85 of @xmath86 and sub - lie algebra @xmath87 , respectively , with the adjoint action @xmath1066 of @xmath88 .",
    "if we are in the gsp - case , then we let @xmath41 and @xmath84 denote the lie algebra @xmath89 of @xmath90 and sub - lie algebra @xmath91 , respectively , with the adjoint action @xmath43 of @xmath88 .",
    "there is a splitting @xmath1067 , resp .",
    "@xmath1068 , with @xmath14 the lie algebra of the centre of @xmath86 , resp .",
    "@xmath90 , that is stable under the adjoint action .",
    "we thus get a @xmath88-equivariant splitting @xmath1069 , where @xmath14 has the trivial @xmath88-action .",
    "this gives a decomposition @xmath1070 for each @xmath68 in @xmath37 , the local group @xmath1071 is the one dimensional @xmath14-subspace of @xmath1072 corresponding to the unramified extension @xcite*example  3.9 . by class field theory , @xmath1073",
    "so , we want to show      the adjoint action of @xmath1076 on @xmath1077 decomposes as @xmath1078 under this decomposition , @xmath84 is identified with @xmath1079 in the go - case , and with @xmath1080 in the gsp - case .",
    "theorem  [ thm : thmb ] then follows from theorem  [ thm : symext ] below , noting that we may choose @xmath0 in the statement of theorem  [ thm : symext ] to be any quadratic cm extension of @xmath37 not contained in the subfield of @xmath38 fixed by @xmath1081 .    [ thm : symext ] let @xmath501 be a quadratic cm extension , and let @xmath92 be a finite totally real extension .",
    "assume there is a regular algebraic polarizable cuspidal automorphic representation @xmath93 of @xmath94 , and an isomorphism @xmath59 such that            the closed subgroup @xmath1089 of @xmath50 is either trivial or has order @xmath477 , hence @xmath1090 .",
    "inflation - restriction then gives @xmath1091 for all @xmath204 , and we can replace @xmath1092 with @xmath1093 in each of [ symext : bk ] , [ symext : h2 ] , and [ symext : h1 ] above .",
    "let @xmath57 be the base change , using @xcite*theorem  4.2 of chapter  3 , of @xmath93 to @xmath1094 . the automorphic representation @xmath57 is regular algebraic and polarizable , and the fact that @xmath374 is absolutely irreducible implies that it is cuspidal .",
    "thus , @xmath1095 satisfies the assumptions of theorem  [ thm : bka ] .",
    "fix a choice @xmath51 of complex conjugation .",
    "if we are in the go - case , set @xmath1096 . if we are in the gsp - case , set @xmath1097 , where @xmath695 is the matrix defining the symplectic pairing on @xmath47 .",
    "then @xmath45 is an invertible symmetric matrix such that the pairing @xmath1098 on @xmath47 given by @xmath1099 satisfies @xmath48 for all @xmath1100 .",
    "as in [ sec : cmthm ] , we can extend the adjoint action of @xmath790 on @xmath1101 to an action of @xmath1076 by letting @xmath51 act as @xmath1102 , and we let @xmath1103 denote @xmath1101 with this @xmath1076-action .      * in the go - case , @xmath1080 is identified with the symmetric matrices , and @xmath1079 with the antisymmetric matrices . * in the gsp - case , @xmath1080 is identified with the matrices @xmath1105 such that @xmath1106 , and @xmath1079 with the matrices @xmath1105 such that @xmath1107 ;    calculating the action of @xmath51 on both sides of , we find @xmath1108 as @xmath1076-representations in the go - case , and @xmath1109 as @xmath1076-representations in the gsp - case .",
    "the theorem now follows from theorem  [ thm : bka ] .",
    "we recall the setup .",
    "fix a continuous homomorphism @xmath109 inducing an isomorphism @xmath110 , as well as a totally odd character @xmath111 with @xmath112 .",
    "we assume @xmath983 is absolutely irreducible .",
    "the ring @xmath116 in the statement of theorem  [ thm : thmc ] is the universal type @xmath622 deformation ring for the global deformation datum @xmath1110 theorem  [ thm : thmc ] then follows immediately from [ thm : bk ] and [ thm : globalsmooth ] .",
    "let @xmath492 be an elliptic modular newform of weight @xmath1111 and level @xmath1112 .",
    "fix a prime @xmath2 , a sufficiently large finite extension @xmath1113 , and an embedding of the coefficient field of @xmath492 into @xmath14 .",
    "let @xmath1 be a finite set of primes of @xmath21 containing all primes dividing @xmath1114 , and let @xmath1115 be the associated @xmath2-adic galois representation .",
    "we let @xmath36 be the residue field of @xmath14 , and let @xmath1116 denote the ( semisimple ) residual representation of @xmath1117 . for any @xmath1118 ,",
    "let @xmath1119 be the representation on the @xmath1120th symmetric power @xmath1121 of @xmath1122 . .",
    "let @xmath1129 , and let @xmath1130 be the ( semisimple ) residual representation .",
    "note that @xmath25 is isomorphic to the semisimplification of @xmath1131 .",
    "set @xmath1132 there is a natural symmetric bilinear map @xmath1133 , which induces a surjection @xmath1134 this map is @xmath1135-equivariant and has a @xmath1135-equivariant splitting .",
    "thus , @xmath1136 is a @xmath1137-equivariant direct summand of @xmath231 , so it suffices to show @xmath1138 . to do this , we apply theorem  [ thm : symext ] .",
    "if @xmath1120 is even , then @xmath19 is conjugate to a representation valued in @xmath1139 , and if @xmath1120 is odd , to one valued in @xmath1140 , and in either case the multiplier character is @xmath1141 .",
    "assumption [ symmodass : im ] implies that @xmath492 does not have complex multiplication , so @xcite*theorem  b implies there is a totally real galois extension @xmath1142 , a regular algebraic polarizable cuspidal automorphic representation @xmath93 of @xmath1143 , and an isomorphism @xmath59 such that @xmath1144 .",
    "moreover , we may assume that @xmath959 is disjoint from the subfield of @xmath1145 fixed by @xmath1146 ( for example , see @xcite*theorem  5.4.1 ) .",
    "note that assumption [ symmodass : p ] implies @xmath1147 .",
    "so @xmath979 , and the image of the restriction @xmath1146 still contains @xmath1128 . by choice of @xmath959 , we have @xmath1148 and @xmath1149 contains @xmath1128 .",
    "this implies , in particular , that the image of @xmath1150 under @xmath1151 acts absolutely irreducibly and @xmath1152 . under assumption",
    "[ symmodass : p ] , @xcite*corollary  1.5 implies @xmath64 is adequate .",
    "we ve verified the assumptions of theorem  [ thm : symext ] for @xmath19 , so @xmath1138 ."
  ],
  "abstract_text": [
    "<S> we prove the vanishing of the geometric bloch  kato selmer group for the adjoint representation of a galois representation associated to regular algebraic polarized cuspidal automorphic representations under an assumption on the residual image . using this </S>",
    "<S> , we deduce that the localization and completion of a certain universal deformation ring for the residual representation at the characteristic zero point induced from the automorphic representation is formally smooth of the correct dimension . </S>",
    "<S> we do this by employing the taylor  wiles  </S>",
    "<S> kisin patching method together with kisin s technique of analyzing the generic fibre of universal deformation rings . along </S>",
    "<S> the way we give a characterization of smooth closed points on the generic fibre of kisin s potentially semistable local deformation rings in terms of their weil  deligne representations . </S>"
  ]
}