{
  "article_text": [
    "in a paper from 2001 @xcite , prokofev and svistunov proposed the worm algorithm as an alternative to cluster algorithms @xcite to overcome critical slowing - down in the simulation of classical spin models like the ising or the 3 state potts model , but also of the complex @xmath0 model .",
    "+ critical slowing - down usually occurs at a second order phase transition where the typical length - scale over which the degrees of freedom ( e.g. the spins of an ising system ) are correlated , diverges and the system develops long - range order .",
    "local update algorithms then usually become very inefficient due to the high energy barrier that has to be overcome to flip individual spins against the field of its nearest neighbors and to the corresponding low acceptance rate of such updates .",
    "cluster algorithms overcome this problem by being non - local : typical structures of correlated sites , the so called clusters , are grown and then flipped as a whole . because the typical size of these clusters grows like the correlation length , critical slowing - down is averted . unfortunately , the typical cluster size usually grows even further when leaving the critical region and going deeper into the ordered phase , resulting in a loss of efficiency of the cluster updates which becomes particularly dramatic when the typical cluster size approaches the size of the whole system .",
    "the more relevant problem with cluster algorithms is however that they are in general not useful if the system couples to an external field , as the large energy barrier that has to be overcome to flip a whole cluster _ against _",
    "the external field quickly leads to very low acceptance rates even for moderate cluster sizes .",
    "+ worm algorithms on the other hand are based on local updates and remain relatively efficient even in the ordered phase and in the presence of external fields . for bosonic systems , worm algorithms",
    "emerge quite naturally when expressing the partition function in terms of a particular kind of integer - valued `` dual '' variables , the so - called _ flux - variables _ ( see @xcite and sec .",
    "[ ssec : phi4partf ] ) .",
    "the working principle behind this dualization process is as follows : consider the simple system described by the following partition function : @xmath5 if we wanted to use monte carlo to compute for example expectation value and variance of the field @xmath6 , i.e. @xmath7 the standard way to do this would be to interpret @xmath8 as probability weight for doing importance sampling with respect to @xmath6 . to obtain the dual formulation , we instead write the integrand of in a power series in @xmath6 , carry out the integral for each monomial ( which can usually be done analytically ) , @xmath9 such that @xmath10 and then use the @xmath11 as probability weights for doing importance sampling with respect to the monomial order @xmath12 , which is our new , integer - valued configuration variable , in terms of which the above observables read @xmath13 this change of variables from @xmath14 to @xmath15 is of course only meaningful if the @xmath11 are real and non - negative for all @xmath12 . in",
    "the above mentioned dual representation of bosonic systems , the _ flux variables _ , which can be interpreted as representing the hopping of particles / excitations between neighboring sites , play a similar role as @xmath12 .",
    "however if the excitations carry a conserved charge , these _ flux variables _ are in general subject to a so - called _ closed loop constraint _ , which makes it impossible to update them with ordinary local metropolis . the worm algorithm deals with this problem by temporarily violating the constraint on two sites , referred to as head and tail of the worm , and updates the flux variables while the head is moved around from site to neighboring site using importance sampling .",
    "the constraint is restored as soon as head and tail meet each other again .",
    "this reformulation of the partition function in terms of flux variables also avoids the sign problem in many significant cases , notably in those where the sign problem is related to the introduction of a non - zero chemical potential ( see @xcite and sec .",
    "[ ssec : phi4partf ] below ) . +",
    "as pointed out for example in @xcite , the sampling of the location of the head of the worm ( relative to its tail ) during the worm update corresponds to the sampling of the correlator for the particle to whose hopping the updated flux variables correspond , and provides therefore an easy and very efficient way to estimate this correlator by recording a histogram for the head - tail distances realized during the worm updates .",
    "+ in the present paper we show , using the complex @xmath0-model as a prototype for systems which can be simulated by worm algorithms , that not only the correlator @xmath1 of the charged fields @xmath6 and @xmath16 ( which are the excitations to whose hopping the flux variables correspond ) , but also more general correlators such as @xmath2 and @xmath3 as well as condensates like @xmath4 can be measured at every step of the monte carlo evolution of a worm .",
    "however , as the @xmath6 field is integrated out exactly ( and with it the @xmath17 symmetry ) , the direct measurement of such one and two - point functions requires in general the introduction of non - vanishing source terms model discussed in this paper , one would change variables @xmath18 where @xmath19 is the background field which would be set to the vacuum expectation value . ] to the action , to which , as suggested in @xcite , correspond additional dual variables representing so - called _ monomers _ ( see sec . [",
    "ssec : phi4partf ] ) .",
    "note that the necessity of a source term in order to obtain a non - vanishing result for the condensate is not a flaw of the dual formulation but a consequence of the definition of the partition function in terms of an euclidean path - integral , which explicitly sums over all possible field configurations .",
    "this means that even in the ordered phase where the minimum of the free energy develops a @xmath17 degeneracy and one usually assumes ( motivated by the fact that in an infinite system , vacua that correspond to different minima of the free energy do not interact ) that the system undergoes spontaneous symmetry breaking and picks just one of the corresponding degenerate vacua , the partition function explicitly always sums homogeneously over all of these vacua , unless one specifies a source term in the action that gives dominant weight to just one of them .",
    "this will be discussed in more detail in sec .",
    "[ ssec : measurecond ] and [ ssec : effectofsource ] .",
    "+ the paper is organized as follows : in the remainder of this section , we first define in part  [ ssec : phi4partf ] our lattice @xmath0 action and the corresponding partition function , then we derive , following @xcite , the flux - variable representation of the latter . in part",
    "[ ssec : chargedcorr ] we then discuss the relation between the charged correlator and the worm algorithm . sec .",
    "[ sec : generalcorr ] is intended to demonstrate how some simple modifications of the worm algorithm allow one to measure also more general correlators as well as condensates during the worm evolution , provided a non - vanishing source term is added to the action .",
    "the section also contains a short discussion on why such a source term is necessary .",
    "a short summary follows in sec .",
    "[ sec : summary ] .",
    "a detailed description of our simulation algorithm is given in appendix  [ sec : wormupdate ] .",
    "the euclidean lattice action for a complex @xmath0 field , coupled to a chemical potential @xmath20 and a ( complex ) source term @xmath21 ( which could be thought of as an external magnetic field ) , reads in @xmath22 dimensions : @xmath23}\\,=\\,\\sum\\limits_{x}{\\biggl\\{\\bigg.-\\kappa\\,\\sum\\limits_{\\nu=1}^{d}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.{\\operatorname{e}}^{2\\,\\mu\\delta_{\\nu , d}}\\,\\phi^{*}_{x}\\,\\phi_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}+{\\operatorname{e}}^{-2\\,\\mu\\delta_{\\nu , d}}\\,\\phi^{*}_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\,\\phi_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}+2\\,{{\\mathopen{}\\mathclose\\bgroup\\originalleft}| \\phi_{x}{\\aftergroup\\egroup\\originalright}|}^2+\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.2\\,{{\\mathopen{}\\mathclose\\bgroup\\originalleft}| \\phi_{x}{\\aftergroup\\egroup\\originalright}|}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}-{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.s^{*}\\,\\phi_{x}+s\\,\\phi^{*}_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\bigg.\\biggr\\}},\\label{eq : phifouraction}\\ ] ] where @xmath24 and @xmath25 are dimensionless lattice parameters , @xmath26 , which is convenient when generalizing the action to the @xmath27 case .",
    "note also that our @xmath24 is four times the `` standard @xmath24 '' used in other lattice formulations of @xmath0 theory . ] .",
    "as is in general complex for non - zero values of the chemical potential @xmath20 , the corresponding partition function , @xmath28}\\,{\\operatorname{e}}^{-s{{\\mathopen{}\\mathclose\\bgroup\\originalleft}[{\\aftergroup\\egroup\\originalright}.\\phi{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright}]}},\\label{eq : phifourpartf}\\ ] ] has a so - called _ sign problem _ , as a complex @xmath29}{\\operatorname{e}}^{-s{{\\mathopen{}\\mathclose\\bgroup\\originalleft}[{\\aftergroup\\egroup\\originalright}.\\phi{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright}]}}$ ] has no probabilistic meaning and can therefore not be used for importance sampling of configurations within a monte carlo simulation .",
    "+ to overcome this problem we follow @xcite and first write @xmath30}}$ ] in as a product of individual exponentials , @xmath31}\\prod\\limits_{x}{\\biggl\\{\\bigg.{\\biggl(\\bigg.\\prod\\limits_{\\nu=1}^{d}\\exp{\\bigl(\\big.\\kappa\\,{\\operatorname{e}}^{2\\,\\mu\\delta_{\\nu , d}}\\,\\phi^{*}_{x}\\,\\phi_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\big.\\bigr)}\\exp{\\bigl(\\big.\\kappa\\,{\\operatorname{e}}^{-2\\,\\mu\\delta_{\\nu , d}}\\,\\phi^{*}_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\,\\phi_{x}\\big.\\bigr)}\\bigg.\\biggr)}\\\\ \\exp{\\bigl(\\big.-2\\,{{\\mathopen{}\\mathclose\\bgroup\\originalleft}| \\phi_{x}{\\aftergroup\\egroup\\originalright}|}^2-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.2\\,{{\\mathopen{}\\mathclose\\bgroup\\originalleft}| \\phi_{x}{\\aftergroup\\egroup\\originalright}|}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}\\big.\\bigr)}\\exp{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.s^{*}\\,\\phi_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\exp{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.s\\,\\phi^{*}_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\bigg.\\biggr\\}},\\label{eq : phifourfluxrepd1}\\end{gathered}\\ ] ] and then write these exponentials , except the ones that correspond to the potential part , in terms of their power - series , @xmath32 @xmath33 and @xmath34 @xmath35 after writing @xmath36 in polar form @xmath37 , the partition function can then be written as @xmath38 the non - negative intergers @xmath39 , @xmath40 and @xmath41 , @xmath42 are called _ flux _ and _ monomer variables _ , respectively : @xmath39 counts the number of hoppings of particles from site @xmath43 to site @xmath44 and of antiparticles from site @xmath44 to @xmath43 , while @xmath40 counts the corresponding inverse moves .",
    "it is therefore convenient @xcite to introduce new variables @xmath45 and @xmath46 , such that @xmath47 where @xmath45 counts the net charge flowing from site @xmath43 to site @xmath44 and @xmath48 counts the total number of particles and antiparticles hopping around between @xmath43 and @xmath49 . similarly @xmath41 and @xmath42 count the particle and anti - particle content of site @xmath43 , and we define @xmath50 and @xmath51 as follows , @xmath52 so that @xmath50 counts the total charge content of site @xmath43 and @xmath53 its total particle content .",
    "integrating now over the @xmath54 in and using and yields the final form of the @xmath55 partition function ( up to an irrelevant constant pre - factor ) : @xmath56 where @xmath57 at first sight it seems that the source terms in give rise to a complex phase . by writing them in the form @xmath58 with the radial , @xmath59 , and the polar source , @xmath60 , we see that locally this is indeed the case . but due to the delta - function constraint in , we have @xmath61 .",
    "furthermore we have @xmath62 , as each @xmath63-variable appears twice in this sum with opposite sign , and therefore @xmath64 . ]",
    ", which implies @xmath65 , and there is therefore no net complex phase and @xmath66 were treated as independent variables , would not be true and the overall complex phase would not vanish in general . ] .",
    "all other terms in are manifestly real and non - negative , and thus the _ flux representation _ of the partition function is sign - problem free and can be sampled by monte carlo .      due to the delta function constraints , configurations contributing to can not be sampled directly by a local metropolis algorithm : the transition probabilities for local updates of the @xmath67 and @xmath63 variables would always vanish . for a non - zero source @xmath68 , one could sample the @xmath63 and @xmath67 variables simultaneously , such that the delta function constraint is always satisfied , but if @xmath69 is small , this would be highly inefficient due to low acceptance rates .",
    "for @xmath70 , in order to satisfy the delta function constraint , one would have to update randomly chosen closed chains of @xmath63 variables , which is in general also very inefficient .",
    "the alternative is to use a worm algorithm , which , roughly speaking , is based on the idea @xcite to update the @xmath63 variables while sampling configurations that contribute to the charged correlator @xmath71 instead of configurations that contribute to itself , as will be explained in what follows .",
    "+      in order to define correlation functions , we consider from now on the source @xmath21 in as a local quantity @xmath72 , keeping in mind , that the partition function ( or any observable ) will actually only be evaluated when @xmath73 .",
    "the charged two - point function is then given by the following expression : @xmath74 carrying out the formal derivative of @xmath75 with respect to @xmath76 in , leads to ( highlighting in red the changes from ):",
    "@xmath77 which , after dividing by @xmath75 , can be interpreted as , @xmath78 analogously the formal derivative of @xmath75 with respect to @xmath79 yields @xmath80 and for the mixed second derivative we find : @xmath81 where , we have set @xmath82 as stated above .",
    "although equations , and are correct , they are only well defined if @xmath83 .",
    "also these expressions so far do not affect in any way the delta function constraint in and will therefore not help in finding an efficient updating algorithm for the @xmath63-variables .",
    "+ to bring into a more useful form , we can absorb the factor of @xmath84 into a shift of the @xmath50 and @xmath51 summation variables :    * terms in for which @xmath85 , such that @xmath86 can , for @xmath87 , be written as @xmath88 by introducing new variables @xmath89 and @xmath90 , such that @xmath91 we have @xmath92 and obtain from : @xmath93 note that for terms with @xmath94 , the right hand side of would require @xmath95 , which is not valid as , according to , all @xmath96-variables have to be non - negative . but",
    "these terms are anyway zero in and it is therefore completely fine that they can not be expressed in terms of valid primed variables @xmath97 , @xmath98 .",
    "* terms in with @xmath99 , for which @xmath100 , can be written as @xmath101 and by choosing @xmath89 and @xmath90 in order to satisfy @xmath102 such that this time @xmath103 , we obtain from again @xmath104    dropping again the primes from the @xmath67 and @xmath96 variables , eq . can therefore be written as @xmath105 and in a similar way we find @xmath106 and finally : @xmath107    equations , and are now well defined even if @xmath70 and we can deduce that in the flux representation formulation of the @xmath0 partition function , the right way to implement observables like @xmath108 @xmath109 and @xmath110 is@xcite , to think of @xmath111 and @xmath112 as external source and sink , respectively , where the effect of adding @xmath111 to the system is a change in the local constraint at @xmath43 , @xmath113 and in the local weight at @xmath43 , @xmath114 similarly we have for the insertion of @xmath112 : @xmath115 and , @xmath114      the idea behind the worm algorithm is now as follows ( cf .",
    "@xcite ) : first propose to insert at some site @xmath116 an external source / sink pair @xmath117 , @xmath118 .",
    "the @xmath119 in the delta function constraint at @xmath116 , coming from the @xmath117 insertion and the @xmath120 from the insertion of @xmath118 cancel each other and the insertion of the external source / sink pair changes therefore only the argument of @xmath121 at @xmath116 : @xmath122 if this insertion is rejected , the proposal counts as an attempted worm update .",
    "if the insertion is accepted , the next step could either consist of proposing to remove the source / sink pair again from the system , or to move @xmath16 from @xmath116 to a randomly chosen neighboring site , e.g. @xmath123 .",
    "the latter update would change the product of local weights for the sites @xmath116 and @xmath43 as follows : @xmath124 and in order to get a non - zero result on the right hand side of the arrow in , this update has to be combined with a simultaneous shift of the corresponding flux variable , @xmath125 ( assuming for the moment that the @xmath67 variables are kept fixed ) as depicted in fig .",
    "[ fig : worm1 ] .",
    "if this move of @xmath16 from @xmath116 to @xmath43 and the simultaneous shift @xmath125 are accepted , one can propose to move @xmath16 further to a random nearest - neighboring site of @xmath43 , and so on .",
    "in this way , one can update the @xmath63-variables while sampling the charged correlator @xmath126 .",
    "whenever , during this procedure , the head of the worm hits the site @xmath116 where also the worm s tail is located , one can in addition to the head - shift also propose to remove the external source / sink pair again .",
    "if this latter proposal is accepted , the worm terminates : we have completed a whole _ worm - update _ and are left with a new closed - worm configuration which contributes to the partition function .",
    "+    ;    iin 0, ... ,3 ( i,0 )  ( i,4 ) node[below ] at ( i,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0,i )  ( 4,i ) node[left ] at ( -0.2,i ) @xmath127 ; ( 1.05,1 )  ( 1.95,1 ) ; at ( 0.9,1 ) ; at ( 2.1,1 ) ; at ( 2.1,1 ) ; at ( 0.9,0.6 ) @xmath128 ; at ( 2.2,0.6 ) @xmath129 ;    iin 0, ... ,3 ( i+7,0 )  ( i+7,4 )",
    "node[below ] at ( i+7,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0 + 7,i )  ( 4 + 7,i )",
    "node[left ] at ( 7 - 0.2,i ) @xmath127 ; ( 7 + 1.05,1 )  ( 7 + 2,1 )  ( 7 + 2,1.95 ) ; at ( 7 + 0.9,1 ) ; at ( 7 + 2,2.1 ) ; at ( 7 + 2,2.1 ) ; at ( 7 + 0.9,0.6 ) @xmath128 ; at ( 7 + 2.2,2.1 ) @xmath130 ;    if @xmath69 is non - zero , one also has to include the update of the @xmath67-variables into the worm algorithm in order to correctly sample the charged correlator .",
    "this can in principle be done by adding a new move to the worm - update algorithm , in which one replaces the shift in the @xmath63-variable , @xmath125 , required to compensate for the @xmath131 in the delta functions in , by the two shifts @xmath132 and @xmath133 , which could be interpreted as compensating for the displacement from @xmath43 to @xmath134 of the external charge @xmath16 , by inserting a pair of oppositely charged ( dynamical ) monomers at @xmath43 and @xmath134 .",
    "however , in this case , there is no need to restrict the set of possible locations to which the head , @xmath16 , of the worm can be shifted to the nearest - neighboring sites of @xmath43 , and one can instead choose a random site @xmath135 as the target location ( see fig .",
    "[ fig : worm2 ] ) .",
    "if such a move is accepted , the worm just continues from the new location as before proposing either to move the head to a nearest - neighboring site by changing a @xmath63-variable , or to move the head to a random new site by changing two @xmath67-variables .",
    "but still , the worm can only be terminated if the head hits again the site where its tail is located and the removal of the external source / sink pair is accepted .",
    "+ the measurement of the two - point functions , e.g. of the component @xmath136 , happens by measuring the fractional monte carlo time during which the external source / sink pair is present in the system and located at sites @xmath43 and @xmath135 respectively . +    ;    iin 0, ... ,3 ( i,0 )  ( i,4 )",
    "node[below ] at ( i,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0,i ) ",
    "( 4,i ) node[left ] at ( -0.2,i ) @xmath127 ; ( 1.05,1 ) ",
    "( 1.95,1 ) ; at ( 0.9,1 ) ; at ( 2.1,1 ) ; at ( 2.1,1 ) ; at ( 0.9,0.6 ) @xmath128 ; at ( 2.2,0.6 ) @xmath129 ;    iin 0, ... ,3 ( i+7,0 )  ( i+7,4 )",
    "node[below ] at ( i+7,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0 + 7,i ) ",
    "( 4 + 7,i ) node[left ] at ( 7 - 0.2,i ) @xmath127 ; ( 7 + 1.05,1 ) ",
    "( 7 + 1.95,1 ) ; at ( 7 + 0.9,1 ) ; at ( 7 + 2.1,1 ) ; at ( 7 + 2.1,1 ) ;    at ( 7 + 2.9,3 ) ; at ( 7 + 3.1,3 ) ; at ( 7 + 3.1,3 ) ; at ( 7 + 0.9,0.6 ) @xmath128 ; at ( 7 + 3.5,2.6 ) @xmath137 ;    so far , the algorithm is analogous to the _ closed - worm _ algorithm described in @xcite for the case of a potts model in the presence of a chemical potential and an external magnetic field . in the next section we supplement this algorithm with additional moves which allow for the sampling of more two - point functions as well as of one - point functions . for the latter",
    "the moves will be analogous to the _ open - worm _ moves of @xcite , but unlike @xcite , where simulations are performed using closed - worm or open - worm a priori , here the choice between closed - worm and open - worm will be performed stochastically .",
    "in the previous section we have seen that the worm algorithm can be interpreted as sampling the two - point function @xmath138 .",
    "the latter can therefore be measured in a very efficient way during the worm - update by keeping track of the fractional monte carlo time the external source / sink pair is present in the system and source and sink are located at @xmath43 and @xmath135 respectively .",
    "+ other observables on the other hand , can only be measured on `` closed - worm '' configurations , obtained in between successive _ _ worm updates__. the auto - correlation times of such observables do not depend on the number of _ worm updates _",
    "but on the number of `` micro - steps''@xcite done during these _ worm updates _ ( i.e. the number of _ local updates _ of the flux variables ) .",
    "it therefore makes sense to choose the number of _ worm updates _ between successive measurements ( on closed - worm configurations ) so that the average number of _ local updates _ is of the order of the number of degrees of freedom in the system , which corresponds to the usual definition of a _ sweep _ used in ordinary non - worm based monte carlo simulations . as the average _ _ worm length _",
    "_ varies as a function of the simulation parameters ( @xmath24 , @xmath25 , @xmath21 ) , so does the optimal number of _ worm updates _ which are necessary to obtain a certain average number of _ local updates _ between successive measurements .",
    "+    , with couplings @xmath139 , @xmath140 and source @xmath141 , the integrated auto - correlation time @xmath142 for the average energy as a function of @xmath20 for three different values of @xmath143 . in the left - hand figure",
    ", @xmath142 is measured in units of @xmath144 _ _ worms__^[fn : prefact]^. with increasing @xmath20 , the average worm - length increases , such that the average number of worms required to de - correlate two configurations decreases . in the right - hand figure , @xmath142 is measured in units of sweeps , where a sweep is defined as the number of _ worm updates _",
    ", such that the total number of _ local updates _ during the _ worm updates _ is of the order of the number of degrees of freedom in the system . in these units , the integrated auto - correlation time seems to depend only weakly on the volume , even at the pseudo critical points around @xmath145 . ]    , with couplings @xmath139 , @xmath140 and source @xmath141 , the integrated auto - correlation time @xmath142 for the average energy as a function of @xmath20 for three different values of @xmath143 . in the left - hand figure , @xmath142 is measured in units of @xmath144 _ _ worms__^[fn : prefact]^. with increasing @xmath20 , the average worm - length increases , such that the average number of worms required to de - correlate two configurations decreases . in the right - hand figure , @xmath142 is measured in units of sweeps , where a sweep is defined as the number of _ worm updates _ , such that the total number of _ local updates _ during the _ worm updates _ is of the order of the number of degrees of freedom in the system . in these units",
    ", the integrated auto - correlation time seems to depend only weakly on the volume , even at the pseudo critical points around @xmath145 . ]    in fig .",
    "[ fig : tauintsweeps ] we show the integrated auto - correlation time for the average `` energy '' the `` energy '' just for simplicity : it is only one part of the full energy of the system . ] , @xmath146 as a function of @xmath20 , once in units of @xmath144 wormsthe pre - factor @xmath144 is just a normalization : @xmath147 is the number of space - time dimensions , while @xmath148 is the number of independent components of @xmath6 , i.e. in the present case , we have @xmath149 , as a complex scalar field can be understood as an @xmath150 field .",
    "the factor @xmath148 reflects the fact that the worm can start with @xmath148 different choices for the head and @xmath151 reflects the number of different directions in which the worm can start on each site . ]",
    "( left ) and once in units of _ sweeps _ ( right ) , where we now define a _ sweep _ , as suggested above , as the number @xmath152 of worms which are necessary on average to proceed as many local updates as there are degrees of freedom in the system .",
    "in the first case , where the auto - correlation time is given in units of _ worm - updates _",
    ", it can be seen that the number of such worms required to de - correlate two configurations decreases with increasing @xmath20 , and that in the disordered phase , @xmath142 is proportional to the system size , while in the ordered phase no volume - dependency is visible .",
    "this has of course to do with the fact that the average number of _ local updates _ required to complete a worm , increases with @xmath20 and becomes proportional to the system volume in the ordered phase ( see fig .",
    "[ fig : wormlength ] ) . in the second case , where @xmath142 is measured in terms of sweeps , no volume dependency is visible , except at the pseudo - critical point .",
    "and even there , the volume dependency seems to be rather mild .",
    "+    , with couplings @xmath139 , @xmath140 and source @xmath141 , the average worm length divided by the system volume as a function of @xmath20 for four different values of @xmath153 . as can be seen , for @xmath154 , when the system is in the ordered phase ( broken symmetry ) , the different curves almost coincide , which means that the worm length is proportional to the volume .",
    "the latter is not true in the symmetric phase ( unbroken symmetry ) , but as the worms are much shorter in this phase , the different curves can not be distinguished on the given scale . ]",
    "it is highly convenient to use the above definition of a sweep as measure for the time between successive measurements , because the computational cost for such sweeps is almost independent of @xmath20 ( at least for a reasonably broad interval of @xmath20 values ) and it can therefore also efficiently be used in combination with parallel tempering @xcite , where it avoids long waiting times among the replicas before swap moves can take place .",
    "+ note that although we tune the number of worms per sweep so that the average number of local updates or micro - steps per sweep is of the order of the system size , the sweep itself is defined in terms of a fixed number of worm updates and not in terms of a fixed number of micro - steps . by allowing the insertion and removal of external sources / sinks",
    ", we have extended the configuration space explored by the markov process , so that it generates both , configurations that contribute to the usual partition function @xmath75 , as well as configurations that contribute to partition functions of the form @xmath155 , which describe the behavior of the system in the presence of an external source @xmath6 at @xmath43 and an external sink @xmath16 at @xmath135 for all possible @xmath156 .",
    "so the markov process in fact samples configurations that contribute to the generalized partition function @xmath157 but we want for example , @xmath158 and not @xmath159 and therefore , only if we define a sweep in terms of a fixed number of worm updates ( which , since worm updates always start and end on closed - worm configurations , equals the number of configurations that contribute to @xmath75 ) instead of a fixed number of micro - steps , we get the correct result without having to determine the correction factor @xmath160 . for observables which depend on configurations in @xmath75 only , this correction factor is irrelevant .",
    "also the masses obtained from fits to and would of course be identical .",
    "but for example the magnetic susceptibility obtained from , i.e. @xmath161 would in general be wrong .",
    "+ the introduction of @xmath162 looks like an unnecessary complication .",
    "indeed , in the standard worm algorithm ( see e.g. @xcite ) , one simply uses reweighting of @xmath163 to estimate @xmath75 . here",
    "we need @xmath162 because , in the remainder of this section , we will further generalize to @xmath164 where @xmath165 and @xmath166 this will allow us to measure also more general correlators like @xmath167 or @xmath168 , as well as the corresponding condensates @xmath169 and @xmath170 _ during _ the worm updates , instead of on closed - worm configurations only .",
    "+      to demonstrate how one can measure general correlators during the worm updates ( without the use of reweighting ) , we use to write the source terms in the partition function in polar form : @xmath171 we can then for example define the correlator for _ radial excitations _ by @xmath172 where @xmath173 the meaning of this correlator becomes clear",
    "when writing the original action in terms of spherical coordinates @xmath174 : @xmath175}\\,=\\,\\sum\\limits_{x}{\\biggl\\{\\bigg.-\\kappa\\,\\sum\\limits_{\\nu=1}^{d}\\,r_{x}r_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}-2\\,{\\mathrm{i}}\\,\\mu\\,\\delta_{\\nu , d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\\\ + \\,r_{x}^{2}\\,+\\,\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}\\,-\\,r_{s , x}r_{x}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{s , x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\bigg.\\biggr\\}}.\\label{eq : phifouractionsph}\\end{gathered}\\ ] ] taking the derivative of the partition function with respect to @xmath176 brings therefore down a factor @xmath177 under the integral , which for all @xmath178 measures the magnitude of the projection of the field on the direction specified by @xmath179 .",
    "analogously , taking the derivative of the partition function with respect @xmath179 would bring down a factor @xmath180 which , after dividing by @xmath176 , yields for all @xmath178 the magnitude of the projection of the field on the direction perpendicular to the direction specified by @xmath179 .",
    "+ if we write @xmath181 we recognize , that by using again shifts of the form , , we can write as @xmath182 proceeding in the same way with the second derivative , we find : @xmath183 of course , could have been obtained in a simpler way by using that @xmath184 and therefore @xmath185 and so on , but it is instructive to repeat the argument with the shifts of the @xmath67- and @xmath96-variables which give rise to the kronecker deltas in the local constraints and local weights on the second and third line of . + in a similar way , one finds the correlator for _ tangential _ or _ angular excitations _ : @xmath186    the first two pieces inside the bracket on the last line of and on the right hand side of can directly be measured during the worm update described above , no matter whether @xmath187 is zero or not .",
    "the other two pieces are non - zero only if @xmath188 and in order to measure them during the worm update , we have to extend the worm algorithm by an additional type of move which allows the worm to change the external source / sink at its head .",
    "this can be done by modifying the disconnected worm update described above in fig .",
    "[ fig : worm2 ] in such a way , that instead of moving the external source @xmath16 from @xmath43 to some other site @xmath135 and shifting @xmath132 and @xmath189 , one can remove @xmath112 completely from the system , still compensate the absence of its charge at @xmath43 by shifting @xmath132 , but now , instead of inserting at @xmath135 again a @xmath16 and compensating for its charge by shifting @xmath189 , we insert a @xmath6 and shift @xmath190 ( see fig .",
    "[ fig : worm3 ] ) . if this move is accepted , the worm samples from now on the last instead of the first piece from inside the brackets on the last lines of and .",
    "the move which changes the external charge at the head of the worm back from @xmath6 to @xmath16 works completely analogously , except that the @xmath67-variables have to be shifted in the opposite direction .",
    "the complex phases appearing in these expressions get always canceled by the complex phases coming from the shifts of the @xmath67-variables during the head - changing moves .",
    "note also that with these additional head - changing moves , the worm can still be terminated only if its head and tail are located on the same site , and in addition , if the head s external charge is again the same as at the beginning of the worm .",
    "+ the head - changing moves are completely general : if we had chosen for example the @xmath191 principal chiral model instead of complex @xmath0 , we could also have introduced moves that would allow us to sample correlators like @xmath192 , @xmath193 , etc . during the worm @xcite .",
    "in @xcite we used this method to verify the existence of oscillatory two - point functions in the three - state potts model if the real and imaginary parts of the field are coupled to different external fields .    ;",
    "iin 0, ... ,3 ( i,0 )  ( i,4 )",
    "node[below ] at ( i,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0,i )  ( 4,i ) node[left ] at ( -0.2,i ) @xmath127 ; ( 1.05,1 )  ( 1.95,1 ) ; at ( 0.9,1 ) ; at ( 2.1,1 ) ; at ( 2.1,1 ) ; at ( 0.9,0.6 ) @xmath128 ; at ( 2.2,0.6 ) @xmath129 ;    iin 0, ... ,3 ( i+7,0 )  ( i+7,4 )",
    "node[below ] at ( i+7,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0 + 7,i )  ( 4 + 7,i ) node[left ] at ( 7 - 0.2,i ) @xmath127 ; ( 7 + 1.05,1 )  ( 7 + 1.95,1 ) ; at ( 7 + 0.9,1 ) ; at ( 7 + 2.1,1 ) ; at ( 7 + 2.1,1 ) ;    at ( 7 + 2.9,3 ) ; at ( 7 + 2.9,3 ) ; at ( 7 + 3.1,3 ) ; at ( 7 + 0.9,0.6 ) @xmath128 ; at ( 7 + 3.5,2.6 ) @xmath194 ;      the partition function for our complex @xmath0 model is defined in terms of an euclidean path integral which explicitly sums over all possible field configurations .",
    "this means that without an explicit breaking of the global @xmath17 symmetry ( e.g. by a source term in the action ) , the condensates @xmath169 and @xmath170 have to vanish identically even in the ordered phase , as the sum of all the condensates corresponding to different @xmath17-degenerate vacua , is zero . in the context of `` ordinary '' monte carlo simulations , based on local metropolis or heat - bath updates of the original field variables , @xmath36",
    ", this might not always be so obvious , as in such simulations , with increasing system size , the markov chain usually has more and more problems to tunnel between different degenerate vacua .",
    "the reason for this is of course the local update strategy and the fact , that the different vacua should indeed become non - interacting in the thermodynamic limit .",
    "this means that any intermediate configuration required for the tunneling from one vacuum into another , becomes energetically more and more expensive with increasing system size and therefore more and more unlikely to be realized , so that the markov chain tends to remain for a long time in the same vacuum , leading to apparently non - zero condensates .",
    "this is of course an illusion : it just reflects the fact that the algorithm is non - ergodic and therefore fails to generate a representative subset of configurations that contribute to the path integral .",
    "+ in the flux - representation the situation is qualitatively different : a non - zero source term is mandatory for a non - zero condensate , even for very large systems !",
    "the reason for this is the following : as we have integrated out the complex phases of the @xmath6-field analytically in order to obtain the weights for the dual configurations in terms of flux variables , we also integrated out the global @xmath17 symmetry . therefore every admissible flux - variable configuration , which could be understood to describe a configuration of particle world - lines , stands in fact for the superposition of the simultaneous realizations of these particle world - line configurations in each of the degenerate vacua .",
    "so , without adding source terms to the system , a spontaneous breaking of the global @xmath17 symmetry can only be observed in quantities which look the same in all degenerate vacua , or which are non - local in the sense that they depend on at least two sites : field to arrive at the partition function , we can not even break the global @xmath17 symmetry by setting the source @xmath21 to a non - zero value .",
    "one manifestation of this is the fact that does not depend on the phase @xmath60 of the external source but only on its magnitude @xmath68 , as shown at the end of sec .",
    "[ ssec : phi4partf ] .",
    "another manifestation is that @xmath195 which can be seen from and , together with the fact that @xmath196 for all valid configurations contributing to .",
    "however , by specifying a non - zero value for @xmath187 we can measure the @xmath17 invariant @xmath195 in polar coordinates ( see also @xcite ) . ] for example the value of the @xmath63-variable between two sites , which measures how well the fields on these two sites are `` in phase '' , i.e. how dominant the `` in phase '' contribution to the integral over the individual phases of the fields on the two sites is . if the average value of the @xmath63-variables increases , this indicates that the system gets more and more ordered .",
    "+ by looking at equations and , we can see that if @xmath70 ( which implies @xmath197 ) , there is no way to satisfy the local delta function constraints in or simultaneously for all sites : one can move the defect ( introduced by the @xmath131 in the delta function at @xmath43 ) around by changing a sequence of @xmath63-variables , but without the insertion of a second external source or sink at which this sequence of changed @xmath63-variables could terminate ( which would then correspond to measuring a two - point function instead of a condensate ) , there will always be a vanishing delta function factor somewhere in the weight of the configuration .",
    "so there exist no configurations which could support a non - zero measurement of a condensate if the source is set to zero .",
    "+ however , if @xmath69 is non - zero , a second external source or sink is not required , as then the defect can be compensated by a shift of one of the @xmath67-variables in the system .",
    "it is precisely this property which we can use to efficiently measure condensates ( and therefore also the disconnected piece of correlators ) even in the case of small sources ( see fig .",
    "[ fig : worm4 ] ) : we propose for example to insert at some site @xmath43 a single external source or sink , @xmath6 or @xmath16 , and to compensate the corresponding @xmath131 appearing in the delta function at @xmath43 by an appropriate shift @xmath198 .",
    "if this insertion is accepted , we can either continue by proposing to remove the external source / sink again and to shift @xmath50 back to its original value , or we can propose to move the external source / sink to one of the neighboring sites of @xmath43 , say @xmath134 and to update @xmath45 in order to compensate for the resulting charge - displacement ( completely analogous to the `` connected move '' in the `` charged worm '' described in the previous section ) .",
    "this procedure is repeated until the update which removes the external source / sink is accepted . here",
    ", our algorithm is analogous to the _ open - worm _ algorithm from @xcite .",
    "the expectation values @xmath170 and @xmath169 are then obtained by measuring the fraction of the monte carlo time , for which the external source / sink is present in the system . +    ;    iin 0, ... ,3 ( i,0 )  ( i,4 )",
    "node[below ] at ( i,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0,i )  ( 4,i ) node[left ] at ( -0.2,i ) @xmath127 ; at ( 0.9,1 ) ; at ( 1.1,1 ) ; at ( 1.1,1 ) ; at ( 1.3,0.6 ) @xmath129 ;    iin 0, ... ,3 ( i+6,0 )  ( i+6,4 )",
    "node[below ] at ( i+6,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0 + 6,i )  ( 4 + 6,i )",
    "node[left ] at ( 6 - 0.2,i ) @xmath127 ; ( 6 + 1.05,1 ) ",
    "( 6 + 1.95,1 ) ; at ( 6 + 0.9,1 ) ; at ( 6 + 2.1,1 ) ; at ( 6 + 2.1,1 ) ; at ( 6 + 2.3,0.6 ) @xmath130 ;    iin 0, ... ,3 ( i+12,0 )  ( i+12,4 )",
    "node[below ] at ( i+12,-0.3 ) @xmath127 ; iin 0, ... ,3 ( 0 + 12,i ) ",
    "( 4 + 12,i ) node[left ] at ( 12 - 0.2,i ) @xmath127 ; ( 12 + 1.05,1 )  ( 12 + 1.95,1 ) ; at ( 12 + 0.9,1 ) ; at ( 12 + 2.1,1 ) ; at ( 12 + 2.1,1 ) ;    yet another advantage of this method for measuring condensates is , that it provides a simple means of variance reduction .",
    "one can absorb the summation over the @xmath96-variables into the weight - function instead of sampling their values , i.e. one uses @xmath199 in the worm algorithm instead of @xmath200 itself , where @xmath201 contains the sum over the @xmath63 and @xmath202-variables , and the @xmath203 are modified bessel functions of the first kind .",
    "the values of can be pre - computed for a set of positive integers @xmath201 and @xmath67 and stored in a two - dimensional array and @xmath204 . ] .",
    "this speeds up the simulation and reduces the noise in the correlator and condensate measurements further .",
    "+ in appendix [ sec : wormupdate ] , we provide pseudo - code describing our implementation of the concepts introduced in this and the previous sections , together with some comments and a derivation of the transition probabilities required to ensure detailed balance during the monte carlo simulation .",
    "+      in figures [ fig : corr ] and [ fig : corr2 ] we compare results for the connected zero - momentum pieces of three different correlators , the charged one , @xmath205 the one for radial , @xmath206 and the one for angular excitations , @xmath207 obtained with two different measurement techniques : once with the naive approach , based on measuring , and on _ closed - worm configurations _ , and once with the improved method , by measuring the correlators and condensates during the worm - updates according to , and , as well as and . the results from both methods",
    "were obtained during the same simulation and thus are directly comparable . for the naive approach , measurements were taken after every sweep ( with a sweep defined as below eq . ) .",
    "for the improved method , every @xmath208 sweeps , the histograms for the correlators and the condensates , accumulated during the worm - updates , were normalized by @xmath209 ( which is the monte carlo time over which the histograms were accumulated ) , stored and reset .",
    "the simulations had a length of @xmath210 sweeps ( plus thermalization ) .",
    "the errors were then obtained with the jack - knife method . as can be seen ,",
    "the correlators obtained with the improved method provide a much cleaner and less noisy signal than the ones obtained with the naive procedure ( based on the values of the @xmath67 and @xmath96-variables in _ closed worm configurations _ ) .",
    "the large relative errors in the correlators shown in fig .",
    "[ fig : corr2 ] , are due to the subtraction of the disconnected piece in and , which is large in the ordered phase .",
    "overall , the new method yields smaller errors on the fitted mass , by a factor @xmath211 .",
    "+ in fig .",
    "[ fig : correrror ] we show , for the two measurement methods , as a function of @xmath20 , the _ errors _ in the smallest component of the zero momentum piece of ( i.e. for @xmath212 ) , before the disconnected piece is subtracted . in the disordered phase ( @xmath213 )",
    ", the improved measurement reduces the error in this observable by about an order of magnitude . in the ordered phase on the other hand ( @xmath154 )",
    ", the two methods seem to yield similar errors .",
    "the same is true for other components of the zero - momentum correlator , away from @xmath212 .",
    "+ if one is just interested in extracting a mass from , the disconnected piece is irrelevant as it can be taken into account by simply adding a constant @xmath214 to the fitting function : @xmath215 still , in fig .",
    "[ fig : massvsfitrange ] we show how the reduced errors in the correlation functions , shown in fig .",
    "[ fig : correrror ] , affect such a mass - fit : more precisely , fig .",
    "[ fig : massvsfitrange ] shows how the fitted mass depends on the fitting range .",
    "the zero - momentum correlation functions measured during a simulation contain contributions from several states which have different masses .",
    "they all decay exponentially like @xmath216 , which on a periodic lattice ( and for neutral states ) leads to terms like @xmath217 . in order to extract the correct ground - state mass by fitting to the measured correlation function ,",
    "one therefore either has to include additional @xmath218-terms to take the excited states into account ( which is usually difficult ) or one has to restrict the fitting range to some interval @xmath219}$ ] in which the excited states have already died away sufficiently .",
    "[ fig : massvsfitrange ] now shows how the mass @xmath220 , obtained by fitting ( without excited states ) to the correlation function , changes as function of @xmath221 . for the improved correlator ( black )",
    ", it can be seen that the fitted mass approaches a clearly visible plateau with increasing @xmath221 . for the non - improved correlator ( red ) ,",
    "the plateau would of course also be there , but due to the bigger noise in this correlator measurement , the ground state signal gets quickly lost with increasing @xmath221 , sometimes even before the excited states become negligible , such that the plateau can not be observed .",
    "+    @xmath222 + , @xmath223 , @xmath139 , @xmath140 , @xmath224 and @xmath225 , the zero - momentum pieces of the indicated two - point functions , obtained with two different measurement methods : the correlators in the upper row are obtained with the naive approach , by making use of eqns . , and ( and analogous ones ) , i.e. by measuring the @xmath67 and @xmath96 content of closed - worm configurations , while the ones in the bottom row are obtained by measuring the correlators and condensates during the worm , making use of eqns . , and ( and similar ones ) .",
    "both data sets were obtained from the same simulation .",
    "for the top row correlators , measurements were taken after every sweep and for the bottom row correlators the histograms were stored and reset after every 1000 sweeps .",
    "the error bars were then obtained with the jack - knife procedure ( note that the correlators are displayed on a log - scale , whereas each error - bar is on a linear scale , which is set by the log - re - scaling factor of the corresponding data point ) .",
    "the dotted lines correspond to exponential fits which lead to the mass - values displayed in the upper right corner of each plot .",
    "note the reduction in the error promoted by the new method.,title=\"fig : \" ]    @xmath226 + , @xmath223 , @xmath139 , @xmath140 , @xmath224 and @xmath225 , the zero - momentum pieces of the indicated two - point functions , obtained with two different measurement methods : the correlators in the upper row are obtained with the naive approach , by making use of eqns . , and ( and analogous ones ) , i.e. by measuring the @xmath67 and @xmath96 content of closed - worm configurations , while the ones in the bottom row are obtained by measuring the correlators and condensates during the worm , making use of eqns . , and ( and similar ones ) .",
    "both data sets were obtained from the same simulation . for the top row correlators , measurements were taken after every sweep and for the bottom row correlators the histograms were stored and reset after every 1000 sweeps .",
    "the error bars were then obtained with the jack - knife procedure ( note that the correlators are displayed on a log - scale , whereas each error - bar is on a linear scale , which is set by the log - re - scaling factor of the corresponding data point ) .",
    "the dotted lines correspond to exponential fits which lead to the mass - values displayed in the upper right corner of each plot .",
    "note the reduction in the error promoted by the new method.,title=\"fig : \" ]    @xmath227 + , @xmath223 , @xmath139 , @xmath140 , @xmath224 and @xmath225 , the zero - momentum pieces of the indicated two - point functions , obtained with two different measurement methods : the correlators in the upper row are obtained with the naive approach , by making use of eqns . , and ( and analogous ones ) , i.e. by measuring the @xmath67 and @xmath96 content of closed - worm configurations , while the ones in the bottom row are obtained by measuring the correlators and condensates during the worm , making use of eqns . , and ( and similar ones ) .",
    "both data sets were obtained from the same simulation . for the top row correlators , measurements were taken after every sweep and for the bottom row correlators the histograms were stored and reset after every 1000 sweeps .",
    "the error bars were then obtained with the jack - knife procedure ( note that the correlators are displayed on a log - scale , whereas each error - bar is on a linear scale , which is set by the log - re - scaling factor of the corresponding data point ) .",
    "the dotted lines correspond to exponential fits which lead to the mass - values displayed in the upper right corner of each plot .",
    "note the reduction in the error promoted by the new method.,title=\"fig : \" ]     +    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and @xmath225 , the zero - momentum pieces of the indicated two - point functions , obtained with two different measurement methods : the correlators in the upper row are obtained with the naive approach , by making use of eqns . , and ( and analogous ones ) , i.e. by measuring the @xmath67 and @xmath96 content of closed - worm configurations , while the ones in the bottom row are obtained by measuring the correlators and condensates during the worm , making use of eqns . , and ( and similar ones ) .",
    "both data sets were obtained from the same simulation . for the top row correlators , measurements were taken after every sweep and for the bottom row correlators the histograms were stored and reset after every 1000 sweeps .",
    "the error bars were then obtained with the jack - knife procedure ( note that the correlators are displayed on a log - scale , whereas each error - bar is on a linear scale , which is set by the log - re - scaling factor of the corresponding data point ) .",
    "the dotted lines correspond to exponential fits which lead to the mass - values displayed in the upper right corner of each plot .",
    "note the reduction in the error promoted by the new method . ]    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and @xmath225 , the zero - momentum pieces of the indicated two - point functions , obtained with two different measurement methods : the correlators in the upper row are obtained with the naive approach , by making use of eqns . , and ( and analogous ones ) , i.e. by measuring the @xmath67 and @xmath96 content of closed - worm configurations , while the ones in the bottom row are obtained by measuring the correlators and condensates during the worm , making use of eqns . , and ( and similar ones ) .",
    "both data sets were obtained from the same simulation . for the top row correlators , measurements were taken after every sweep and for the bottom row correlators the histograms were stored and reset after every 1000 sweeps .",
    "the error bars were then obtained with the jack - knife procedure ( note that the correlators are displayed on a log - scale , whereas each error - bar is on a linear scale , which is set by the log - re - scaling factor of the corresponding data point ) .",
    "the dotted lines correspond to exponential fits which lead to the mass - values displayed in the upper right corner of each plot .",
    "note the reduction in the error promoted by the new method . ]    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and @xmath225 , the zero - momentum pieces of the indicated two - point functions , obtained with two different measurement methods : the correlators in the upper row are obtained with the naive approach , by making use of eqns . , and ( and analogous ones ) , i.e. by measuring the @xmath67 and @xmath96 content of closed - worm configurations , while the ones in the bottom row are obtained by measuring the correlators and condensates during the worm , making use of eqns . , and ( and similar ones ) .",
    "both data sets were obtained from the same simulation . for the top row correlators ,",
    "measurements were taken after every sweep and for the bottom row correlators the histograms were stored and reset after every 1000 sweeps .",
    "the error bars were then obtained with the jack - knife procedure ( note that the correlators are displayed on a log - scale , whereas each error - bar is on a linear scale , which is set by the log - re - scaling factor of the corresponding data point ) .",
    "the dotted lines correspond to exponential fits which lead to the mass - values displayed in the upper right corner of each plot .",
    "note the reduction in the error promoted by the new method . ]    , @xmath139 , @xmath140 , @xmath224 and @xmath223 ( left ) or @xmath228 ( right ) the _ error _ in the zero - momentum piece of the correlator @xmath229 at distance @xmath230 as a function of @xmath20 .",
    "the black data corresponds to the error in the measurements obtained with the non - improved method while the red data shows the error in the measurements obtained with the improved method . ]    , @xmath139 , @xmath140 , @xmath224 and @xmath223 ( left ) or @xmath228 ( right ) the _ error _ in the zero - momentum piece of the correlator @xmath229 at distance @xmath230 as a function of @xmath20 .",
    "the black data corresponds to the error in the measurements obtained with the non - improved method while the red data shows the error in the measurements obtained with the improved method . ]",
    "@xmath222 + , but for @xmath231 , which is already in the symmetry broken phase .",
    "the correlators in the upper three plots were obtained with the standard measurement method on closed - worm configurations while the lower three figures were obtained with the improved method during the worm updates . again",
    "the dotted lines correspond to exponential fits from which the mass - values are obtained which are displayed in the upper right corner of each plot .",
    "the relatively large , but homogeneous ( note the log scale ) errors visible in the two plots in the middle are mainly due to the subtraction of the large disconnected piece .",
    "note the reduction in the error promoted by the new method.,title=\"fig : \" ]    @xmath226 + , but for @xmath231 , which is already in the symmetry broken phase .",
    "the correlators in the upper three plots were obtained with the standard measurement method on closed - worm configurations while the lower three figures were obtained with the improved method during the worm updates . again",
    "the dotted lines correspond to exponential fits from which the mass - values are obtained which are displayed in the upper right corner of each plot .",
    "the relatively large , but homogeneous ( note the log scale ) errors visible in the two plots in the middle are mainly due to the subtraction of the large disconnected piece .",
    "note the reduction in the error promoted by the new method.,title=\"fig : \" ]    @xmath227 + , but for @xmath231 , which is already in the symmetry broken phase .",
    "the correlators in the upper three plots were obtained with the standard measurement method on closed - worm configurations while the lower three figures were obtained with the improved method during the worm updates . again",
    "the dotted lines correspond to exponential fits from which the mass - values are obtained which are displayed in the upper right corner of each plot .",
    "the relatively large , but homogeneous ( note the log scale ) errors visible in the two plots in the middle are mainly due to the subtraction of the large disconnected piece . note the reduction in the error promoted by the new method.,title=\"fig : \" ]     +    , but for @xmath231 , which is already in the symmetry broken phase .",
    "the correlators in the upper three plots were obtained with the standard measurement method on closed - worm configurations while the lower three figures were obtained with the improved method during the worm updates . again",
    "the dotted lines correspond to exponential fits from which the mass - values are obtained which are displayed in the upper right corner of each plot .",
    "the relatively large , but homogeneous ( note the log scale ) errors visible in the two plots in the middle are mainly due to the subtraction of the large disconnected piece .",
    "note the reduction in the error promoted by the new method . ]    , but for @xmath231 , which is already in the symmetry broken phase .",
    "the correlators in the upper three plots were obtained with the standard measurement method on closed - worm configurations while the lower three figures were obtained with the improved method during the worm updates . again",
    "the dotted lines correspond to exponential fits from which the mass - values are obtained which are displayed in the upper right corner of each plot .",
    "the relatively large , but homogeneous ( note the log scale ) errors visible in the two plots in the middle are mainly due to the subtraction of the large disconnected piece .",
    "note the reduction in the error promoted by the new method . ]    , but for @xmath231 , which is already in the symmetry broken phase .",
    "the correlators in the upper three plots were obtained with the standard measurement method on closed - worm configurations while the lower three figures were obtained with the improved method during the worm updates . again",
    "the dotted lines correspond to exponential fits from which the mass - values are obtained which are displayed in the upper right corner of each plot .",
    "the relatively large , but homogeneous ( note the log scale ) errors visible in the two plots in the middle are mainly due to the subtraction of the large disconnected piece .",
    "note the reduction in the error promoted by the new method . ]    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and for different values of @xmath20 , the dependency of the mass @xmath220 , obtained by fitting to the zero - momentum piece of the radial correlator @xmath229 , on the fitting range @xmath232}$ ] .",
    "the red data results from fits to the correlation functions obtained with the improved method while the black data was obtained from fits to the naively measured correlators .",
    "a clear mass plateau ( indicated by the dotted horizontal line ) is visible with the improved method , and only with it .",
    "note that the critical value of @xmath20 is @xmath233 . ]    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and for different values of @xmath20 , the dependency of the mass @xmath220 , obtained by fitting to the zero - momentum piece of the radial correlator @xmath229 , on the fitting range @xmath232}$ ] .",
    "the red data results from fits to the correlation functions obtained with the improved method while the black data was obtained from fits to the naively measured correlators .",
    "a clear mass plateau ( indicated by the dotted horizontal line ) is visible with the improved method , and only with it .",
    "note that the critical value of @xmath20 is @xmath233 . ]",
    "+    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and for different values of @xmath20 , the dependency of the mass @xmath220 , obtained by fitting to the zero - momentum piece of the radial correlator @xmath229 , on the fitting range @xmath232}$ ] . the red data results from fits to the correlation functions obtained with the improved method while the black data was obtained from fits to the naively measured correlators .",
    "a clear mass plateau ( indicated by the dotted horizontal line ) is visible with the improved method , and only with it .",
    "note that the critical value of @xmath20 is @xmath233 . ]    , @xmath223 , @xmath139 , @xmath140 , @xmath224 and for different values of @xmath20 , the dependency of the mass @xmath220 , obtained by fitting to the zero - momentum piece of the radial correlator @xmath229 , on the fitting range @xmath232}$ ] .",
    "the red data results from fits to the correlation functions obtained with the improved method while the black data was obtained from fits to the naively measured correlators .",
    "a clear mass plateau ( indicated by the dotted horizontal line ) is visible with the improved method , and only with it .",
    "note that the critical value of @xmath20 is @xmath233 . ]      despite the obvious improvement in the signal - to - noise ratio provided by the method described above in sec .",
    "[ ssec : gencorr ] for measuring different channels of general two - point functions during different stages of a generalized worm - algorithm , this measuring at different stages of the algorithm has the potential draw - back that the different channels of the two - point function are not necessarily determined with the same accuracy : with the current algorithm , the statistics in the measurement of any component of the two - point function is proportional to its expectation value .",
    "this is fine as long as there are not too many channels in the two - point functions or if one is only interested in the dominant propagating modes .",
    "however , if one is for example interested in the full mass spectrum of the theory , including sub - dominant modes / channels , this can be problematic .",
    "a naive attempt to deal with this problem would be to use reweighting to obtain always measurements for all channels during all stages of the worm - algorithm : if the worm is for example currently sampling @xmath1 , then measurements for @xmath168 , @xmath167 and @xmath136 can be obtained by appropriate reweighting factors , virtually replacing the external sources at head and tail of the worm ( and appropriately shifting some @xmath67-variables ) and vice versa .",
    "it is however clear that there will in general be a big overlap problem between the different channels of the correlator .",
    "+ the proportionality between statistics and true expectation value for the components of two - point functions which are sampled during the evolution of the worm , already leads to problems when dealing with just the standard two - point function , @xmath1 , if one is interested in very low temperatures or if the masses are all large , such that the correlator decays very quickly . to overcome this problem it was proposed in @xcite to use an additional weight @xmath234 in the sampling of the two - point function @xmath1 , where @xmath234 can be thought of as an initial guess for @xmath1 , such that the algorithm has to sample only the ratio @xmath235 which , for a good choice of @xmath234 , should vary much less as function of @xmath236 than @xmath1 itself , leading to an exponential improvement in the signal - to - noise ratio",
    "this @xmath234 could of course be generalized to a set of functions @xmath237 , where @xmath238 and @xmath239 label the different possible choices for the external charges at head and tail of the worm .",
    "furthermore , one could then use a method similar to the wang - landau sampling @xcite in order to find the optimal @xmath237 , leading to equal statistics for all components and channels of the two - point function .      as already mentioned in sec .",
    "[ ssec : measurecond ] , the euclidean path integral that defines the partition function for our theory sums over all possible field configurations and thereby integrates out the global @xmath17 symmetry . in the dual formulation in terms of flux variables this feature of the partition function",
    "is manifest as during the dualization process , the integration over the field @xmath36 has been carried out exactly .",
    "spontaneous symmetry breaking can therefore only be observed in our simulations either when looking at non - local observables as for example two - point functions or the charge density , @xmath240 , or after the introduction of a non - vanishing source and the choice of an appropriate coordinate system for the internal space , in which one can then observe spontaneous symmetry breaking also in condensates .",
    "+ in this section we now address the question of how big the source has to be chosen and how one can extract results for the theory at zero source from simulations carried out in the presence of a non - zero source . for this discussion , we will use the partition function in terms of the original field variables in polar form : @xmath241}{\\operatorname{e}}^{\\sum\\limits_{x}{\\bigl\\{\\big.\\kappa\\,\\sum\\limits_{\\nu=1}^{d}\\,r_{x}r_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}-2\\,{\\mathrm{i}}\\,\\mu\\,\\delta_{\\nu , d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}+r_{s}r_{x}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{s}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\big.\\bigr\\}}}\\ .\\label{eq : origpartfsph}\\ ] ] in these variables the condensate for radial excitations then reads @xmath242}{\\bigl(\\big.{\\color{fhl}\\sum\\limits_{x}r_{x}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{s}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}\\big.\\bigr)}\\\\ \\cdot{\\operatorname{e}}^{\\sum\\limits_{x}{\\bigl\\{\\big.\\kappa\\,\\sum\\limits_{\\nu=1}^{d}\\,r_{x}r_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}-2\\,{\\mathrm{i}}\\,\\mu\\,\\delta_{\\nu , d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}+r_{s}r_{x}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{s}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\big.\\bigr\\}}}\\ , \\label{eq : origcondrad}\\end{gathered}\\ ] ] and the cosine in the observable under the integral makes it clear that this will only yield the expected result in the ordered phase if @xmath187 is sufficiently large in order to give dominant weight to the @xmath6-configurations where @xmath243 when integrating over the phases @xmath54 . on the other hand , we would like @xmath187 to be as small as possible in order to reduce the associated bias . to get an approximate answer on how large @xmath187 should be chosen , we can proceed as follows : we know that in the ordered phase , the exponential of the interaction term ( `` interaction '' in the sense of coupling fields on neighboring sites ) , @xmath244 dominates over the entropy in the configuration space of the @xmath54 variables and the dominant contribution to the integral over these variables will come from configurations where all @xmath54 are parallel or , as we called it earlier , `` in phase '' , i.e. we can assume that in the ordered phase , the partition function behaves like @xmath245}\\int{\\mathrm{d}^{}\\,\\theta}{\\operatorname{e}}^{\\sum\\limits_{x}{\\bigl\\{\\big.\\kappa\\,\\sum\\limits_{\\nu=1}^{d}\\,r_{x}r_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\cosh{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.2\\,\\mu\\,\\delta_{\\nu , d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}+r_{s}r_{x}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta-\\theta_{s}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\big.\\bigr\\}}}\\\\ = \\int{\\mathcal{d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}[r{\\aftergroup\\egroup\\originalright}]}{\\operatorname{e}}^{\\sum\\limits_{x}{\\bigl\\{\\big.\\kappa\\,\\sum\\limits_{\\nu=1}^{d}\\,r_{x}r_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\cosh{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.2\\,\\mu\\,\\delta_{\\nu , d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}\\big.\\bigr\\}}}i_{0}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}\\sum_{x}r_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\ , \\label{eq : approxorderedpartf}\\end{gathered}\\ ] ] with @xmath203 being the modified bessel functions of the first kind .",
    "if we now evaluate by using , we find @xmath246}\\frac{{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\sum_{x}r_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}{v}\\frac{i_{1}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}\\sum_{x}r_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}{i_{0}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}\\sum_{x}r_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}\\\\ \\cdot{\\operatorname{e}}^{\\sum\\limits_{x}{\\bigl\\{\\big.\\kappa\\,\\sum\\limits_{\\nu=1}^{d}\\,r_{x}r_{x+{\\thisstyle{\\smash{\\savedstyle\\oldhat{\\savedstyle\\nu}}\\vphantom{\\savedstyle\\nu}}}}\\cosh{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.2\\,\\mu\\,\\delta_{\\nu , d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}\\big.\\bigr\\}}}i_{0}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}\\sum\\limits_{x}r_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\approx { \\thisstyle{\\savedstyle {     \\sbox{\\myboxa}{$\\m@th\\savedstyle r$ }     \\setbox\\myboxb\\null     \\ht\\myboxb=\\ht\\myboxa     \\dp\\myboxb=\\dp\\myboxa     \\wd\\myboxb=0.75\\wd\\myboxa     \\sbox\\myboxb{$\\m@th\\overline{\\copy\\myboxb}$ }     \\setlength\\mylena{\\the\\wd\\myboxa }     \\addtolength\\mylena{-\\the\\wd\\myboxb }     \\ifdim\\wd\\myboxb<\\wd\\myboxa        \\rlap{\\hskip 0.5\\mylena\\usebox\\myboxb}{\\usebox\\myboxa }     \\else           \\hskip -0.5\\mylena\\rlap{\\usebox\\myboxa}{\\hskip 0.5\\mylena\\usebox\\myboxb }     \\fi}}}\\,\\frac{i_{1}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}\\,v\\,{\\thisstyle{\\savedstyle {     \\sbox{\\myboxa}{$\\m@th\\savedstyle r$ }     \\setbox\\myboxb\\null     \\ht\\myboxb=\\ht\\myboxa     \\dp\\myboxb=\\dp\\myboxa     \\wd\\myboxb=0.75\\wd\\myboxa     \\sbox\\myboxb{$\\m@th\\overline{\\copy\\myboxb}$ }     \\setlength\\mylena{\\the\\wd\\myboxa }     \\addtolength\\mylena{-\\the\\wd\\myboxb }     \\ifdim\\wd\\myboxb<\\wd\\myboxa        \\rlap{\\hskip 0.5\\mylena\\usebox\\myboxb}{\\usebox\\myboxa }     \\else           \\hskip -0.5\\mylena\\rlap{\\usebox\\myboxa}{\\hskip 0.5\\mylena\\usebox\\myboxb }     \\fi}}}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}{i_{0}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}\\,v\\,{\\thisstyle{\\savedstyle {     \\sbox{\\myboxa}{$\\m@th\\savedstyle r$ }     \\setbox\\myboxb\\null     \\ht\\myboxb=\\ht\\myboxa     \\dp\\myboxb=\\dp\\myboxa     \\wd\\myboxb=0.75\\wd\\myboxa     \\sbox\\myboxb{$\\m@th\\overline{\\copy\\myboxb}$ }     \\setlength\\mylena{\\the\\wd\\myboxa }     \\addtolength\\mylena{-\\the\\wd\\myboxb }     \\ifdim\\wd\\myboxb<\\wd\\myboxa        \\rlap{\\hskip 0.5\\mylena\\usebox\\myboxb}{\\usebox\\myboxa }     \\else           \\hskip -0.5\\mylena\\rlap{\\usebox\\myboxa}{\\hskip 0.5\\mylena\\usebox\\myboxb }     \\fi}}}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}\\ , \\label{eq : approxordradex}\\end{gathered}\\ ] ] where @xmath247 is the mean field solution to and @xmath248 is the system volume . the ratio of bessel functions in vanishes if @xmath249 is zero and asymptotically approaches @xmath250 for @xmath251 as shown in the left panel of fig .",
    "[ fig : besselfuncratio ] as a function of @xmath187 .     for four different volumes @xmath252 , where we have set @xmath253 and in the axes labels",
    "we have used the abbreviation @xmath254 .",
    "the peaks in the curves on the right - hand side mark the value of @xmath187 where @xmath255 stops to be proportional to @xmath187 , and are obtained when @xmath256 . ]     for four different volumes @xmath252 , where we have set @xmath253 and in the axes labels we have used the abbreviation @xmath254 .",
    "the peaks in the curves on the right - hand side mark the value of @xmath187 where @xmath255 stops to be proportional to @xmath187 , and are obtained when @xmath256 . ]    in the thermodynamic limit @xmath257 , a non - zero value of @xmath187 leads to @xmath258 no matter how small @xmath187 is .",
    "however , in practice we can simulate only finite systems and the thermodynamic limit has to be obtained by extrapolation ( finite volume scaling ) .",
    "if we are interested in results for @xmath259 in an infinite system at @xmath260 , reminds us that one first has to take the infinite volume limit before sending @xmath261 ; otherwise the result will always be zero , since for every finite volume there is a minimal value for @xmath187 below which @xmath262 will be in the region where @xmath263 is proportional to @xmath187 .",
    "the value of @xmath187 at which this change of behavior of @xmath263 happens is given by the peak in the quantity @xmath264 when plotted as a function of @xmath187 and we can define the volume dependent lower bound for @xmath187 : @xmath265 which scales like @xmath266 as could have been expected since @xmath187 couples to an extensive quantity in the action . in the full theory @xmath267",
    "would be determined by the maximum in the susceptibility @xmath268 as a function of @xmath187 .",
    "the values of @xmath187 used for simulations that should yield results to be used in a scaling analysis to extract information on an infinite system at zero source , should therefore be chosen such that @xmath269 , where @xmath270 is the volume of the smallest system involved in the analysis .",
    "+ deep in the disordered phase on the other hand , entropy dominates over the exponential of the interaction term and we can approximate the partition function as follows : @xmath271}\\prod\\limits_{x}{\\biggl(\\bigg.\\int{\\mathrm{d}^{}\\,\\theta_{x}}{\\operatorname{e}}^{-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}+r_{s}r_{x}\\cos{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.\\theta_{x}-\\theta_{s}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}}\\bigg.\\biggr)}\\\\ = \\int{\\mathcal{d}{\\mathopen{}\\mathclose\\bgroup\\originalleft}[r{\\aftergroup\\egroup\\originalright}]}\\prod\\limits_{x}{\\biggl(\\bigg.{\\operatorname{e}}^{-r_{x}^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{x}^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}}i_{0}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}r_{x}{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\bigg.\\biggr)}={\\biggl(\\bigg.\\int{\\mathrm{d}^{}\\,r}{\\operatorname{e}}^{-r^{2}-\\lambda{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r^{2}-1{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}^{2}}i_{0}{{\\mathopen{}\\mathclose\\bgroup\\originalleft}({\\aftergroup\\egroup\\originalright}.r_{s}r{\\mathopen{}\\mathclose\\bgroup\\originalleft}.{\\aftergroup\\egroup\\originalright})}\\bigg.\\biggr)}^{v}\\ .\\label{eq : approxdisorderedpartf}\\end{gathered}\\ ] ] for the condensate we then find @xmath272 in the disordered phase the condensate is therefore expected to behave always like @xmath273 unless @xmath274 as there is now no volume factor in the argument of the bessel functions . due to this direct proportionality between condensate and source",
    ", it also follows that the susceptibility @xmath275 defined in eq . should ( to lowest order in @xmath187 ) be identical to the condensate .",
    "+ in fig .",
    "[ fig : condvssource ] we show for a ( 2 + 1)-dimensional system with @xmath139 , @xmath140 , @xmath276 , @xmath277 and for three different values of the chemical potential @xmath20 the condensate @xmath259 ( left ) and the corresponding susceptibility @xmath275 ( right ) as a function of the source @xmath187 .",
    "the top figures correspond to @xmath278 , which is in the disordered phase , where condensate and susceptibility are both proportional to the source @xmath187 and independent of the system size .",
    "the other figures correspond to @xmath279 ( middle ) and @xmath231 ( bottom ) which are both in the ordered phase ( since @xmath233 ) where the condensate develops a plateau as soon as @xmath187 reaches a volume - dependent minimal value .",
    "+    , @xmath139 and @xmath140 the condensate @xmath259 ( left ) and the corresponding susceptibility ( right ) as a function of the magnitude of the source @xmath187 for @xmath280 in the disordered phase at @xmath278 ( top ) , just in the ordered phase at @xmath279 ( middle ) and deep in the ordered phase at @xmath231 ( bottom ) .",
    "the continuous curves were obtained by multi - histogram reweighting . ]    , @xmath139 and @xmath140 the condensate @xmath259 ( left ) and the corresponding susceptibility ( right ) as a function of the magnitude of the source @xmath187 for @xmath280 in the disordered phase at @xmath278 ( top ) , just in the ordered phase at @xmath279 ( middle ) and deep in the ordered phase at @xmath231 ( bottom ) .",
    "the continuous curves were obtained by multi - histogram reweighting . ]",
    "+    , @xmath139 and @xmath140 the condensate @xmath259 ( left ) and the corresponding susceptibility ( right ) as a function of the magnitude of the source @xmath187 for @xmath280 in the disordered phase at @xmath278 ( top ) , just in the ordered phase at @xmath279 ( middle ) and deep in the ordered phase at @xmath231 ( bottom ) .",
    "the continuous curves were obtained by multi - histogram reweighting . ]    , @xmath139 and @xmath140 the condensate @xmath259 ( left ) and the corresponding susceptibility ( right ) as a function of the magnitude of the source @xmath187 for @xmath280 in the disordered phase at @xmath278 ( top ) , just in the ordered phase at @xmath279 ( middle ) and deep in the ordered phase at @xmath231 ( bottom ) .",
    "the continuous curves were obtained by multi - histogram reweighting . ]",
    "+    , @xmath139 and @xmath140 the condensate @xmath259 ( left ) and the corresponding susceptibility ( right ) as a function of the magnitude of the source @xmath187 for @xmath280 in the disordered phase at @xmath278 ( top ) , just in the ordered phase at @xmath279 ( middle ) and deep in the ordered phase at @xmath231 ( bottom ) .",
    "the continuous curves were obtained by multi - histogram reweighting . ]    , @xmath139 and @xmath140 the condensate @xmath259 ( left ) and the corresponding susceptibility ( right ) as a function of the magnitude of the source @xmath187 for @xmath280 in the disordered phase at @xmath278 ( top ) , just in the ordered phase at @xmath279 ( middle ) and deep in the ordered phase at @xmath231 ( bottom ) .",
    "the continuous curves were obtained by multi - histogram reweighting . ]",
    "it should be mentioned at this point that if one is only interested in the magnitude of the condensate , an alternative to the introduction of a source for measuring it would be to use that @xmath281 the same equation also holds for the correlator of radial excitations ( where for @xmath70 only the first two terms in are non - zero ) : @xmath282 the latter is particularly convenient : as we are usually simulating periodic finite systems , zero - momentum correlation functions always have a minimum , which is the point where the deviation of the value of the correlation function from the square of the corresponding condensate is minimal .",
    "for the zero - momentum piece of the minimum is always located at @xmath283 , while for the zero - momentum piece of , its location can change as function of @xmath20 .",
    "however , since for vanishing source @xmath284 only the first two terms of can be measured , while the other two terms ( the ones that can not be measured ) would contribute similarly to the constant piece of the zero - momentum correlator , one has to keep in mind that the measured background should be multiplied by a factor @xmath285 in order to get the correct value for the squared condensate @xmath286 .",
    "+ another possibility would be to extract @xmath4 or @xmath259 from a fit of the form @xmath287 or @xmath288 to the zero - momentum pieces of the correlators in and , respectively , so that @xmath289 and @xmath290 , where the factor @xmath291 in front of the first term in is again due to the fact that for @xmath260 only the first two terms of can be measured . in fig .",
    "[ fig : condfromcorr ] , we show an example of such measurements and compare them to results obtained by measuring the condensate directly , as described in sec .  [ ssec : measurecond ] , for four different , non - zero values of the source @xmath187 .",
    "note that the slight oscillations in the data coming from the systems with vanishing source are not just due to systematic errors in the fitting process , but are a manifestation of the phenomenon described in @xcite , which is due to the quantization of the charge , visible in a finite system at low temperature ( i.e. large @xmath292 ) ( see also fig .",
    "[ fig : condcomp2 ] , right ) . in fig .",
    "[ fig : condcomp2 ] , we compare for two systems with different temporal extents , the result for the condensate @xmath259 obtained with the fitting method with the one obtained by extracting the condensate from the minimum ( at @xmath212 ) of the zero - momentum piece of . the fitting method is more involved but works better for not too large @xmath292 , while for sufficiently large @xmath292 the two methods seem to work equally well .    , @xmath228 , @xmath139 and @xmath140 the condensate @xmath259 measured in three different ways :",
    "the data points which are joined by different lines correspond to direct measurements of the condensate for different values of the source @xmath293 , the blue and red dots were obtained by fitting to the correlators for charged and radial excitations respectively for @xmath294 . ]    , @xmath139 , @xmath140 and @xmath294 and @xmath228 ( left ) and @xmath295 ( right ) the condensate @xmath259 as a function of @xmath20 , determined once by identifying @xmath296 with twice ( see explanation in text below eq . )",
    "the value of the zero - momentum piece of the measured ( black ) , and once by fitting to the same correlator the function ( red ) . as can be seen , for @xmath228 ( left )",
    ", the black and the red curve do not agree very well : the black curve shows too large values as the temperature is still too large and the zero - momentum correlator at @xmath283 deviates too much from the constant background .",
    "the red curve from the fit shows however already an oscillatory signal . for @xmath295 ( right ) , the agreement between the two curves is much better and the oscillations as a function of @xmath20 are very pronounced .",
    "we have increased the number of sampling points between @xmath297 and @xmath298 in order to resolve also some of the fast oscillations ( see inset ) . between @xmath297 and @xmath231 , the charge density increases from zero to slightly above one , which happens in @xmath299 small steps .",
    "each valley in the condensate corresponds to one of these small steps . ]    , @xmath139 , @xmath140 and @xmath294 and @xmath228 ( left ) and @xmath295 ( right ) the condensate @xmath259 as a function of @xmath20 , determined once by identifying @xmath296 with twice ( see explanation in text below eq . )",
    "the value of the zero - momentum piece of the measured ( black ) , and once by fitting to the same correlator the function ( red ) . as can be seen , for @xmath228 ( left )",
    ", the black and the red curve do not agree very well : the black curve shows too large values as the temperature is still too large and the zero - momentum correlator at @xmath283 deviates too much from the constant background .",
    "the red curve from the fit shows however already an oscillatory signal . for @xmath295 ( right ) , the agreement between the two curves is much better and the oscillations as a function of @xmath20 are very pronounced .",
    "we have increased the number of sampling points between @xmath297 and @xmath298 in order to resolve also some of the fast oscillations ( see inset ) . between @xmath297 and @xmath231 , the charge density increases from zero to slightly above one , which happens in @xmath299 small steps .",
    "each valley in the condensate corresponds to one of these small steps . ]",
    "using the complex @xmath0 model as an example , we first reviewed the relation between the worm - algorithm and the charged correlator , how the former can be derived from the latter and how the standard worm can be thought of as sampling the charged correlator .",
    "+ we then showed how the worm - algorithm can be generalized in order to sample also more general correlators and condensates and explained why this requires the inclusion of a non - vanishing source term in the action . in general , all correlators probing different internal space components of the field can be sampled during the worm monte carlo evolution by generalizing the standard worm - algorithm along the lines we presented .",
    "+ in the appendix we explain in some detail how our algorithm works and how the transition probabilities are computed in order to satisfy detailed balance .",
    "in this appendix we describe our implementation of the generalized worm - algorithm introduced in the text . we explain why the code is organized in this particular way and show how the transition probabilities are obtained as to satisfy detailed balance .",
    "+        * a routine `` worm_update(x0 , ... ) '' , which updates the @xmath63 and @xmath202 ( and if the source is non - zero , also the @xmath67 and @xmath96 ) variables while sampling the full two - point function , starting and ending at `` x0 '' , * a routine `` cond_worm_update(x0 , ... ) '' , which , if the source is non - zero , also updates the @xmath63 , @xmath202 , @xmath67 and @xmath96 variables while sampling the @xmath6 and @xmath16 condensates , starting at `` x0 '' and ending at some other site ( which will then be used as new value for `` x0 '' ) , * and the routine `` sweep ( ) '' , which , for a fixed number of times , randomly executes either `` worm _ update(x0 , ... ) '' or `` cond_worm_update(x0 , ... ) '' ( provided the source is non - zero ) , or picks a new random location for `` x0 '' .    in `` sweep ( ) '' , the probability for choosing next a new random location for `` x0 '' is always 1/2 . if @xmath69 ( or equivalently @xmath187 ) is set to zero , the probability for executing next `` worm_update(x0 , ... ) '' is also 1/2 . if @xmath69 is non - zero , `` worm_update(x0 , ... ) '' and `` cond_worm_update(x0 , ... ) '' share the 1/2 probability for being executed next and are therefore executed with probability 1/4 each .",
    "the two worms can always start in two different ways : for `` worm_update(x0 , ... ) '' we can either have @xmath6 as the head and @xmath16 as the tail of the worm or vice versa , and similarly for `` cond_worm _ update(x0 , ... ) '' , we can either attempt to start by inserting a @xmath6 or a @xmath16 ( together with an appropriate shift of a @xmath67-variable , i.e. the insertion of an appropriate dynamical monomer of opposite charge ) .",
    "+ the @xmath202 and @xmath96 variables are updated along with the @xmath63 and @xmath67 variables in `` worm_up - date(x0 , ... ) '' and `` cond_worm_update(x0 , ... ) '' : at every step of the worm the type of variable ( @xmath63 , @xmath202 , @xmath67 or @xmath96 variable ) to be updated next is selected at random , in such a way that the probability of selecting an @xmath202 variable ( @xmath96 variable ) is the same as the probability of selecting a @xmath63 variable ( @xmath67 variable ) . in for example",
    "@xcite another updating strategy was used , where only the @xmath63 variables were updated during the worm evolution while the @xmath202 variables were updated in separate sweeps , executed periodically after a fixed number of worms .",
    "this can become problematic as soon as the system develops long - range order and the average worm - length becomes of the order of the system size : the worm then evolves for a long time in a fixed @xmath202-background , which slows down de - correlation and gives rise to larger errors in the two - point functions measured during the worm evolution .",
    "furthermore , alternating between different types of updates in a fixed order strictly speaking breaks detailed balance ( although this is usually harmless ) .",
    "our updating scheme avoids both of these problems : the @xmath202 and @xmath96 variables do not form a fixed background while the worm evolves and detailed balance is satisfied at every step of the simulation . + note that if one is interested in two - point functions only , one could in principle avoid the removal and re - insertion of the external source / sink pair ( and the uniform sampling of @xmath300 ) whenever the worm closes , and instead just do importance sampling with respect to the location of the pair , which would be slightly more efficient as it would require less calls to the random - number generator .",
    "measurements of observables which have to be obtained on closed - worm configurations would then have to be corrected by a reweighting factor , compensating for the presence of the external source / sink pair at @xmath300 .",
    "+ note also that `` worm_update(x0 , ... ) '' and `` cond_worm_update(x0 , ... ) '' could in principle be combined into a single worm , which , provided @xmath69 is non - zero , would not only sample the location and type of the head of the worm , but also sample the state of the worms tail : whether it should consist of an external source or sink as in `` worm_update(x0 , ... ) '' or if it should be replaced by an appropriate shift of the @xmath67-variable ( i.e. by a dynamical monomer ) at the location of the tail as is the case in `` cond_worm_update(x0 , ... ) '' .",
    "the reason why we decided to use separate worms is that our full simulation program is implemented to work for arbitrary linear and non - linear @xmath27 sigma models ( complex @xmath0 corresponds to the linear @xmath150-case and the also mentioned @xmath191 chiral - effective model to the non - linear @xmath301-case ) with arbitrary source terms , in which case the implementation with two different worms for sampling two- and one - point functions turned out to be simpler .      in order to ensure that our markov chain really samples the partition , one- and two - point function , we have to ensure detailed balance between each pair of successive configurations @xmath214 and @xmath302 , i.e. configurations contributing to the partition , one- or two - point function , which can be turned into each other by a single update .",
    "the detailed balance equation takes the general form @xmath303 where @xmath304 is the weight of the configuration @xmath214 and @xmath305 is the transition probability for going from configuration @xmath214 to @xmath302 .",
    "however , as during different stages of our simulation , the number of possible moves changes , it can happen , that the move @xmath306 is chosen with a different probability than the inverse move @xmath307 . we must then factor out from the transition probabilities the different _ move - choice probabilities _",
    ", @xmath67 , and write @xmath308 and similarly @xmath309 and then use only the _ reduced transition probabilities _ , @xmath310 , for the metropolis acceptance test , i.e. @xmath311 and @xmath312 the reason for this is , that in order for the metropolis test to take place , the corresponding move has to be chosen already and the probability for this to happen should therefore not be taken into account a second time for the final decision whether the transition to the new configuration should take place or not .",
    "this is of course always the case , but if the move choice probabilities are the same for all the moves that are possible during the simulation , in particular for all pairs of move and inverse move , the move choice probabilities just cancel out in and .",
    "+ the diagram in figure [ fig : mcprobabs ] illustrates the different move - choice probabilities which occur at different stages of the simulation and in order to demonstrate how the corresponding reduced transition probabilities are determined , we show the derivation of these probabilities for the moves occurring in `` worm_update ( ... ) '' . in what follows we use the abbreviation @xmath313 , and for the variable @xmath314 we have that @xmath315",
    "if @xmath284 , and @xmath316 otherwise is different for @xmath284 and @xmath317 because `` worm_update(x0 , ... ) '' is executed with different probabilities within `` sweep ( ) '' in these two cases , as explained at the beginning of sec .",
    "[ ssec : progorg ] . ] .",
    "* the detailed balance equation for starting the worm at site @xmath116 , i.e. inserting an external source / sink pair at this point , reads : + @xmath318 from which it follows that : @xmath319 * if the head of the worm consists of a @xmath16 , we define @xmath320 , and if the head is a @xmath6 , we set @xmath321 instead . *",
    "* for moving the head from site @xmath43 to its nearest - neighbor in positive direction , say to @xmath322 , and changing @xmath323 , the detailed balance equation reads : + @xmath324 from which it follows that if @xmath325 : @xmath326 and if @xmath327 : @xmath328 * * when moving the head from site @xmath43 to a nearest - neighbor in a negative direction , e.g. @xmath329 and shifting @xmath330 , the corresponding detailed balance equation becomes : + @xmath331 such that for @xmath332 : @xmath333 and if @xmath334 : @xmath335 * * moving the head from site @xmath43 to another random site @xmath336 and shifting @xmath337 , @xmath338 leads to the detailed balance equation , @xmath339 such that @xmath340 where @xmath341 and @xmath342 * * removing the head from site @xmath43 and inserting it again at @xmath336 with opposite external charge leads again to , , and , but this time with @xmath337 and @xmath343 . * finally , if head and tail are again located both on site @xmath116 and consist of opposite external charges , one can propose to terminate the worm , for which the detailed balance equation is given by + @xmath344 and therefore : @xmath345                                                          ( -3.5,6.3 ) to[out=330,in=320,looseness=1 ] ( 7.5,12 ) to[out=140,in=150,looseness=1 ] node[pos=0.1,fill = white]cond_worm_update ( ) ( -3.5,6.3 ) ; ( 2,-2.5 ) to[out=330,in=340,looseness=1 ] ( 13.5,7.5 ) to[out=160,in=150,looseness=1 ] node[pos=0.1,fill = white]worm_update ( ) ( 2,-2.5 ) ;      worm_update(x0 , sites , bonds , xnbr , wh , h , mu , sr , ns , nt , ni , corrs , corrt ) ; cond_worm_update(x0 , sites , bonds , xnbr , wh , h , mu , sr , ns , nt , ni , cond ) ; + c0=randi(2 ) ; x = x0 ; c = c0 ; rho=2*nc*0.25*wh[sites[x][0 ] ] ;        tnu = nu%d ; xn = xnbr[x][nu ] ; tdk=1 - 2*floor(nu /",
    "d ) ; k = bonds[x][nu][0 ] ; l = bonds[x][nu][1 ] ; kn = k+tdk*del ; ch = abs(k)-l ; chn = abs(kn)-l ; dak = chn - ch ; rho=0.5*h*wh[sites[xn][0]]/chn ; rho = ch/(0.5*h*wh[sites[x][0]-2 ] ) ; rho*=exp(2*mu ) ; rho*=exp(-2*mu ) ; bonds[x][nu][0]=kn ; sites[xn][0]+=2*dak ; sites[xn][1]+=2*dak ; sites[x][0]+=2*dak ; sites[x][1]+=2*dak ; cx[tnu]+=tdk ;    ni+=tdk*del ; cx[tnu]=cx[tnu]%nt ; cx[tnu]=cx[tnu]%ns ; x = xn ; cn = nu-2*d ; xn = randi(v-1 ) ; + + xn ; p1=sites[x][2 ] ; q1=sites[x][3 ] ; p1n = p1+del ; dap1=abs(p1n)-abs(p1 ) ; rho = sr/(abs(p1n)+q1 ) ; rho=(abs(p1)+q1)/(0.25*sr*wh[sites[x][0]-2 ] ) ; deln=1 ; deln=-1 ; p2=sites[xn][2 ] ; q2=sites[xn][3 ] ; p2n = p2-deln ; dap2=abs(p2n)-abs(p2 ) ; rho*=0.25*sr*wh[sites[xn][0]]/(abs(p2n)+q2 ) ; rho*=(abs(p2)+q2)/sr ; sites[x][2]=p1n ; sites[x][0]-=2 ; sites[x][1]-=2 ; sites[xn][2]=p2n ; sites[xn][0]+=2 ; sites[xn][1]+=2 ;    xi = x ; xin = xn ; cx[tnu]+=((xin%ns)-(xi%ns ) ) ; cx[tnu]=cx[tnu]%ns ; xin = floor(xin / ns ) ; xi = floor(xi / ns ) ; cx[d-1]+=((xin%nt)-(xi%nt ) ) ; cx[d-1]=cx[d-1]%nt ; x = xn ; c = cn ; del = deln ; ; + c = randi(2 ) ; x = x0 ; del=1 ; del=-1 ; p1=sites[x][2 ] ; q1=sites[x][3 ] ; p1n = p1-del ; dap1=abs(p1n)-abs(p1 ) ; rho=2 . ;",
    "rho*=0.25*sr*wh[sites[x][0]]/(abs(p1n)+q1 ) ; rho*=(abs(p1)+q1)/sr ; sites[x][2]=p2n ; sites[x][0]+=2 ; sites[x][1]+=2 ; ; tc=(c+1)%2 ; mnu=2*d ;    cond[tc]+=1 ; nu = randi(4*mnu ) ; tnu = nu%d ; xn = xnbr[x][nu ] ; tdk=1 - 2*floor(nu /",
    "d ) ; k = bonds[x][nu][0 ] ; l = bonds[x][nu][1 ] ; kn = k+tdk*del ; ch = abs(k)+l ; chn = abs(kn)+l ; dak = chn - ch ; rho=0.5*h*wh[sites[xn][0]]/chn ; rho = ch/(0.5*h*wh[sites[x][0]-2 ] ) ;    rho*=exp(2*mu ) ; rho*=exp(-2*mu ) ; ni+=tdk*del ; sites[xn][0]+=2*dak ; sites[xn][1]+=2*dak ; sites[x][0]+=2*dak ; sites[x][1]+=2*dak ; bonds[x][nu][0]=kn ; x = xn ; l_update(sites , bonds , xnbr , wh , v , d ) ; p1=sites[x][2 ] ; q1=sites[x][3 ] ; p1n = p1+del ; dap1=abs(p1n)-abs(p1 ) ; rho=1/(2*nc ) ;    rho*=sr/(abs(p1n)+q1 ) ; rho*=(abs(p1)+q1)/(0.25*sr*wh[sites[x][0]-2 ] ) ; sites[x][2]=p1n ; sites[x][0]-=2 ; sites[x][1]-=2 ; x0=x ; break ; q_update(sites , wh , v ) ; ; + x = randi(v ) ; nu = randi(d ) ; del=1 - 2*randi(2 ) ; l = bonds[x][nu][1 ] ; ln = l+del ; xn = xnbr[x][nu ] ; ak = abs(sites[x][nu][0 ] ) ; rho=0.25*wh[sites[x][0]]*wh[sites[xn][0]]*h*h/(ln*(ak+ln ) ) ; rho = l*(ak+l)/(h*h*0.25*wh[sites[x][0]-2]*wh[sites[xn][0]-2 ] ) ; bonds[x][nu][1]=ln ; sites[x][0]+=2*del ; sites[x][1]+=2*del ; sites[xn][0]+=2*del ; sites[xn][1]+=2*del ; ; +    x = randi(v ) ; del=1 - 2*randi(2 ) ; q = sites[x][3 ] ; qn = q+del ; ap = abs(sites[x][2 ] ) ; rho=0.25*wh[sites[x][0]]*sr*sr/(qn*(ap+qn ) ) ; rho = q*(ap+q)/(sr*sr*0.25*wh[sites[x][0]-2 ] ) ; sites[x][0]+=2*del ; sites[x][1]+=2*del ; sites[x][3]=qn ; ;    00 n. prokofev , b. svistunov , _ worm algorithm for classical statistical models _",
    "87 ( 2001 ) 160601 , _ arxiv : cond - mat/0103146 _",
    "r. h. swendsen , j .- s .",
    "wang , _ nonuniversal critical dynamics in monte carlo simulations _ , phys",
    ". lett . 58",
    "( 1987 ) 86 m. g. endres , _ avoiding the boson sign problem at finite chemical potential _ , pos ( lattice 2006 ) 133 , _ arxiv : hep - lat/0609037 _ m. g. endres , _ method for simulating o(n ) lattice models at finite density _ , phys .",
    "d 75 ( 2007 ) 065012 , _ arxiv : hep - lat/0610029 _ u. wolff , _ simulating the all - order strong coupling expansion i : ising model demo _ , nucl .",
    "b 810 ( 2009 ) 491 - 502 , _ arxiv:0808.3934 [ hep - lat ] _",
    "u. wolff , _ simulating the all - order strong coupling expansion iii : o(n ) sigma / loop models _ , nucl .",
    "b 824 ( 2010 ) 254 - 272 , _ arxiv:0908.0284 [ hep - lat ]",
    "_ t. korzec , i. vierhaus , u. wolff , _ performance of a worm algorithm in @xmath0 theory at finite quartic coupling _ , comp .",
    "( 2011 ) 1477 , _",
    "arxiv:1101.3452 [ hep - lat ] _ c. gattringer , t. kloiber , _ spectroscopy in finite density lattice field theory : an exploratory study in the relativistic bose gas _ , phys .",
    "b 720 ( 2013 ) 210214 , _ arxiv:1212.3770 [ hep - lat ] _ c. gattringer , t. kloiber , _ lattice study of the silver blaze phenomenon for a charged scalar @xmath0 field _ ,",
    "b869 ( 2013 ) 56 _ arxiv:1206.2954 [ hep - lat ] _ f. bruckmann , c. gattringer , t. kloiber , t. sulejmanpasic , _ dual lattice representation for @xmath27 and @xmath355 models with a chemical potential _ ,",
    "b 749 ( 2015 ) 495 - 501 , _",
    "arxiv:1507.04253 [ hep - lat]_. y. delgado , h. g. evertz , c. gattringer , _ worm algorithms for the 3-state potts model with magnetic field and chemical potential _",
    "phys . commun . 183",
    "( 2012 ) 1920 - 1927 , _",
    "arxiv:1202.4293 [ hep - lat ] _",
    "d. banerjee , s. chandrasekharan , _ finite size effects in the presence of a chemical potential : a study in the classical non - linear o(2 ) sigma - model _ , phys .",
    "d 81 ( 2010 ) 125007 , _ arxiv:1001.3648 [ hep - lat ] _ c. j. geyer , _ markov chain monte carlo maximum likelihood _ ,",
    "computing science and statistics : proc . 23rd symp . interface ( 1991 ) 156 - 163 a. g. cunha - netto , a. a. caparica , s. tsai , r. dickman , d. p. landau , _ improving wang - landau sampling with adaptive windows _",
    "e 78 ( 2008 ) 055701 , _",
    "arxiv:0808.1210 [ cond-mat.statmech ] _ t. rindlisbacher , p. de forcrand , _ lattice simulation of the @xmath191 chiral model at zero and non - zero pion density _ , pos ( lattice 2015 ) 171 , _ arxiv:1512.05684 [ hep - lat ] _ o. akerlund , p. de forcrand , t. rindlisbacher , _ oscillating propagators in heavy - dense qcd _ , arxiv:1602.02925 [ hep - lat ]"
  ],
  "abstract_text": [
    "<S> using the complex @xmath0-model as a prototype for a system which is simulated by a worm algorithm , we show that not only the charged correlator @xmath1 , but also more general correlators such as @xmath2 or @xmath3 , as well as condensates like @xmath4 , can be measured at every step of the monte carlo evolution of the worm instead of on closed - worm configurations only . </S>",
    "<S> the method generalizes straightforwardly to other systems simulated by worms , such as spin or sigma models .    </S>",
    "<S> monte carlo ; worm algorithm ; dual variables ; flux - representation ; general correlators . </S>"
  ]
}