{
  "article_text": [
    "the recent wilkinson microwave anisotropy probe ( _ wmap _ ) first - year data release has shown that , despite advances in our ability to compute the power spectrum of microwave background anisotropies and increases in computer power , cosmological parameter estimation is still relatively slow and computationally expensive . for example , for the simplest parameter space of flat , lambda cold dark matter ( lcdm ) models , the _ wmap _ team needed about a week of supercomputer time ( 32 cpus on an sgi origin ) to determine the two parameters joint 2-@xmath0 confidence contours in the parameter space @xcite . allowing a non - flat geometry",
    "slows down the analysis significantly and more than quadruples the time required to draw the 2-@xmath0 contours .",
    "the main bottleneck in the parameter estimation process is the theoretical computation of the power spectrum anisotropy for a very large number of models , scattered throughout the parameter space .",
    "this is mostly done using publicly available codes such as cmbfast ( @xcite ) or camb ( @xcite ) . to accelerate the calculations , ( dash)@xcite introduced a shortcut in the calculation of the angular power spectra , based on analytical and semi - analytical approximations .",
    "rigorous analysis of future microwave background and other complementary data sets require recomputing the likelihood contours for cosmological parameters each time new data becomes available .",
    "additionally for each new experiment , not one but many likelihood analyses are required to explore the impacts of potential systematic errors . not every researcher has access to months of supercomputer time for these computations ; a fast and reasonably accurate method to compute confidence regions for cosmological parameters is needed .",
    "motivated by the enormous computational burden that a proper 3 to 4-@xmath0 exploration of the likelihood hypersurface represents and by the related need to understand more clearly the physical parameters that control the shape of the power spectrum , kosowsky , milosavljevic and jimenez ( kmj ) @xcite presented a new set of `` physical '' parameters formed from the usual cosmological parameters which have nearly - orthogonal effects on the microwave background temperature power spectrum .",
    "thus , with this set of parameters , the efficiency of monte carlo techniques for evaluating the likelihood region increases significantly ; these parameters have been used in the wmap analysis @xcite and then incorporated into lewis suite of microwave background analysis codes @xcite .",
    "subsequent work in a similar vein constructed a set of normal parameters that locally transformed the likelihood in parameter space into gaussian form@xcite .    in the new kjm `` basis '' , it is also possible to obtain an efficient approximation of the temperature power spectrum in a region around the fiducial model as a simple linear extrapolation from a fiducial model power spectrum .",
    "this new technique makes possible to compute approximate power spectra , several orders of magnitude faster than any previous methods , and was extensively used by the _ wmap _",
    "collaboration @xcite in the preliminary analysis of the data .",
    "despite a significant increase in computational speed and physical insight afforded by the kmj parameters , some remaining technical issues prevented a direct application of the kmj power spectrum fits to real data .",
    "in particular : ( a ) the parameters and the linear fits were only computed for the temperature power spectrum and not for the polarization ; ( b ) the fiducial model used by kmj had an optical depth to the last scattering surface which was too small ( @xmath2 ) compared with the _ wmap _ best - fit model ( @xmath3 ) ; ( c ) for a fiducial model with higher @xmath4 some covariance remained between the slope of the power spectrum @xmath5 , the amplitude of the fluctuations @xmath6 and the optical depth parameter @xmath7 which suggested that the kmj parameters @xmath8 , @xmath9 and @xmath5 were not completely orthogonal ; ( d ) errors in the power spectrum estimation became larger than 1% in some relevant regions of the parameter space .    here",
    "we present a refined version of the kmj algorithm , cmbwarp , that solves these problems .",
    "we extend the method to include polarization spectra , make all parameters nearly orthogonal , use a fiducial model given by the best fit model to _ wmapext _ data@xcite , and obtain the power spectra using polynomial fits for improved accuracy over linear extrapolations . throughout the region of parameter space within _ wmap",
    "_ s first - year data 3-@xmath0 confidence region for each parameter , marginalized over the other n-1 parameters . ] , the accuracy is now comparable to the difference between cmbfast and other independent boltzmann codes .",
    "we make cmbwarp publicly available from http:/www.physics.upenn.edu/@xmath1raulj / cmbwarp ; in addition , we also release accompanying markov chain code that can be used to perform parameter estimation .",
    "we first review the kmj choice of physical parameters and describe the slightly modified set of parameters presented here which yield an orthogonal basis for temperature and polarization spectra .",
    "our model space is the standard class of inflation - like cosmological models , specified by five parameters determining the background homogeneous spacetime ( matter density @xmath10 , radiation density @xmath11 , vacuum energy density @xmath12 , baryon density @xmath13 , and hubble parameter @xmath14 ) , two parameters determining the spectrum of primordial scalar perturbations ( scalar amplitude @xmath9 and power law index @xmath5 ) , and a single parameter @xmath4 describing the total optical depth since reionization . for the present",
    "we postpone additional complications such as tensors , massive neutrinos or a varying vacuum equation of state . throughout this paper",
    ", we use a fiducial cosmological model corresponding to wmap s best fit lcdm model with parameters : @xmath15 , @xmath16 , @xmath17 , @xmath18 , @xmath19 , @xmath20 , @xmath21 . as it will be clear below",
    ", the choice for @xmath9 is convention - dependent . in our convention @xmath22 which corresponds to @xmath23 in the fiducial model .",
    "we will construct fast and accurate approximations to the microwave background power spectra in some region of parameter space surrounding this fiducial model .",
    "the five parameters describing the background cosmology induce complex dependencies in the microwave background power spectra through multiple physical effects ; therefore their effects on the power spectra are not orthogonal .",
    "a characteristic scale in the power spectrum is the angular scale of the first acoustic peak .",
    "it is advantageous to choose this angular scale as a parameter which can be varied independently of any other parameters .",
    "this angular scale is in turn determined by the ratio of the sound horizon at last scattering ( which determines the physical wavelength of the acoustic waves ) to the angular diameter distance to the surface of last scattering ( which determines the apparent angular size of this yardstick ) .",
    "kmj used this quantity as the first of the following set of orthogonal _ physical _ parameters . the analytic theory underlying any such choice of physical parameters",
    "has been worked out in detail ( see @xcite , and also @xcite ) .",
    "the characteristic angular scale is    @xmath24    where @xmath25 is the scale factor at recombination , the sound horizon is given by    @xmath26 \\nonumber \\\\",
    "\\!\\!\\!\\!\\!\\!\\int_0^a \\!\\!{dx \\over \\left\\{\\!\\left(1\\ ! + \\ ! { 3\\omega_b\\over 4\\omega_{\\rm rad}}x\\right)\\ !",
    "\\left[(1-\\omega)x^2 + \\omega_\\lambda x^4 \\!+\\ ! \\omega_{\\rm m } x\\ ! + \\ !",
    "\\omega_{\\rm rad}\\right]\\right\\ } ^{1/2 } } \\label{rsa - integral}\\end{aligned}\\ ] ]    and the angular diameter distance in a standard frw spacetime by @xmath27 with @xmath28    see , e.g. , @xcite .",
    "the other physical parameters employed by kmj are :    @xmath29    @xmath30 is the physical baryon density determining the baryon driving effect on the acoustic oscillations @xcite ( which modifies the relative odd and even acoustic peak heights ) ; @xmath31 is the matter - radiation density ratio at recombination ; @xmath32 determines the late - time integrated sachs - wolfe effect arising from a late vacuum - dominated phase , but otherwise varying @xmath33 while holding the other parameters fixed represents a nearly exact degeneracy ( sometimes called the `` geometrical degeneracy '' ) ; @xmath34 couples only to other small physical effects and is an approximate degeneracy direction .",
    "this choice of parameters is not unique , but this specific set is particularly useful and easy to interpret .    given values for @xmath35 , @xmath30 , @xmath32 , @xmath31 , and @xmath34 , they can be inverted to the corresponding cosmological parameters by rewriting the definition of @xmath35 in terms of @xmath30 , @xmath32 , @xmath31 , @xmath34 , and @xmath14 , then searching in @xmath14 until the desired value for @xmath35 is obtained ; @xmath13 and @xmath12 then follow immediately , while @xmath10 and @xmath11 can be obtained with a few iterations to determine a precise value for @xmath25 .",
    "the other cosmological parameters which affect the microwave background power spectrum are the optical depth to reionization and the amplitude and power law index of the scalar perturbation power spectrum .",
    "these turn out to be crucial parameters in order to make an approximate method like the one described here to work . for reionization",
    ", kmj used the physical parameter @xmath36 the factor by which the microwave background anisotropies on small scales are damped due to compton scattering by free electrons after the universe is reionized .",
    "this damping occurs for all scales smaller than the horizon size at reionization .",
    "the primordial power spectrum of density perturbations is generally taken to be a power law , @xmath37 , with @xmath38 corresponding to the scale - invariant harrison - zeldovich spectrum . making the approximation that @xmath39 and @xmath40 have a direct correspondence , the effect of @xmath5 on the microwave background power spectrum can be modeled as @xmath41 which is a good approximation for power law power spectra . a first - order deviation from a power law , characterized by @xmath42 @xcite ,",
    "can be represented in a similar way .",
    "note that since the dependence is exponential , a linear extrapolation is never a good approximation over the entire interesting range @xmath43 .",
    "the choice of @xmath44 is somewhat arbitrary : changing @xmath44 simply gives a different overall normalization . in this work",
    "we choose @xmath45 as the best pivot point to reproduce the cmbfast power spectra .",
    "these parameters have nearly orthogonal effects on the power spectra , so the effect of varying a particular parameter can be considered independently from the other parameters , within a reasonably large region of parameter space .",
    "this property can be exploited to create simple and efficient approximations to the microwave background power spectra , based on a few computed power spectra .",
    "the kmj paper chose a fiducial cosmological model described by a set of parameters @xmath46 and computed its power spectrum @xmath47 using available codes .",
    "the effects of parameter @xmath48 were modeled as a simple rescaling of the angular multipole @xmath49 and the effects of @xmath50 as a overall normalization factor , the effects of @xmath5 as in equation [ n_effect ] above .",
    "then for each of the remaining parameters @xmath51 , a linear fit was used to describe the variation of @xmath52 as @xmath51 moved away from its value in the fiducial model .",
    "this set of numerical fits gives approximations to the power spectrum which are remarkably good in some region of parameter space surrounding the fiducial model .",
    "however , the linear extrapolations are not good enough to compute the power spectrum to the accuracy of the cmbfast code used to compute the fiducial model and the dependencies on the individual parameters . here",
    "we improve on a simple linear extrapolation by performing polynomial fits ( to the 4th order ) to the computed power spectra dependencies .",
    "models extracted randomly from a mcmc for _ wmap _ first year data .",
    "the solid line is for flat models while the dashed line is for universes with arbitrary geometry .",
    "the top panel shows the percent mean difference averaged from @xmath53 to @xmath54 , while the bottom panel shows the percent rms difference . note that the agreement is at the 0.5% level or better . ]",
    "but for the te power spectrum .",
    "since te crosses zero at several points , the vertical axis is plotted in @xmath55 .",
    "the dotted line in the bottom panel shows the cosmic variance error for the fiducial model . ]            unfortunately , the kmj choice of physical parameters for @xmath56 and @xmath5 does not work if the fiducial model has a high @xmath4 .",
    "even small deviations from the fiducial model result in strong covariances between the two parameters ( see further discussion in sec .",
    "fortunately , a simple technique breaks the degeneracy between these two parameters : we use @xmath56 as a multiplicative factor to the whole power spectrum parameter for @xmath57 . for @xmath58 the shape of the spectrum does not depend on @xmath59 but only on @xmath5 as follows :    @xmath60    where the @xmath61 subscript denotes the fiducial value .",
    "we then fix the normalization for @xmath62 by imposing the condition that the spectrum must be continuous at @xmath63 . for the amplitude @xmath6 we use the same definition as in kmj .    in the rest of the paper",
    ", we refer to the parameters @xmath35 , @xmath64 , @xmath32 , @xmath31 , @xmath34 , @xmath6 , and @xmath56 as `` physical parameters '' , as opposed to the usual `` cosmological parameters ''",
    "@xmath13 , @xmath65 , @xmath11 , @xmath66 , @xmath14 , @xmath67 , and a quadrupole - based normalization .",
    "the set of approximation techniques for the physical parameters , comprising polynomial fits for @xmath48 , @xmath68 , @xmath33 , @xmath69 , and @xmath70 , a multiplicative @xmath8 dependence , and an approximate @xmath5 dependence given by eqs .",
    "( [ n_effect ] ) and ( [ n_corr ] ) provide an extremely simple , fast , and accurate method of computing the temperature power spectrum of the microwave background .",
    "slight additional modifications at low @xmath49 values described below provide excellent fits to the e - polarization and the te cross - power .",
    "all of these approximations taken as a whole comprise the cmbwarp algorithm .",
    "for the cross power spectrum between the temperature and the e - mode polarization , no modification is done for @xmath71 and the whole spectrum is modeled using the the same prescription for the temperature for @xmath72 but instead of the multiplicative factor @xmath8 we use the corresponding polynomial fit for @xmath8 .",
    "this models accurately the te power spectrum neglecting secondary effects",
    ". however , reionization of the neutral intergalactic medium by the first generation of stars re - scatters the cmb photons , producing the so called `` reionization bump '' at large angular scales .",
    "we model this effect using the following fitting formula for @xmath73 , inspired by @xcite :    @xmath74    where @xmath75 is the te @xmath76 value of the fiducial model for each @xmath77 , evaluated at @xmath78.\\ ] ]    the subscript @xmath61 denotes the fiducial model and @xmath79 denotes the integer part of @xmath80 ; we smoothly interpolate in the transition region .",
    "this approximation is accurate to a few percent .        for the e - polarization power spectra",
    ", the power spectrum for all @xmath81 s is modeled using the same prescription as for the temperature power spectrum for @xmath72 but instead of the multiplicative factor @xmath8 we use the corresponding polynomial fit for @xmath8 .",
    "the perturbative approach of cmbwarp greatly speeds up the calculation of cmb power spectra since it requires only a few floating point operations per multipole moment calculated .",
    "computation time for a single non - flat lcdm model is on the order of _ 0.005 seconds _ for cmbwarp ; about 100 seconds for cmbfast on an athlon 2400 + workstation . in other words",
    ", cmbwarp is about 20 thousand times faster than cmbfast .",
    "we have computed our numerical fits up to @xmath81 of 1500 and tested thoroughly the performance of the fit in the same @xmath81 range .",
    "we have checked that the same type of approximation also holds up to @xmath81 of 3500 . here",
    "we present a direct application to data using _ wmap _ first year data and finer angular scale experiments which probe scales up to @xmath81 of 1500 .    for cmbwarp to be useful in the analysis of present and forthcoming high - precision data sets",
    ", it must be not only fast but also accurate .",
    "two key questions are : ( a ) can the approximate approach reproduce , with reasonable accuracy , cmbfast power spectra ? and ( b ) can it recover unbiased and accurate cosmological parameters and confidence regions in a likelihood analysis for a realistic data set ? we demonstrate below that the answer is yes .",
    "the first test we perform is to compare power spectra from cmbfast and cmbwarp for a large set of models . for the comparison set , we select models from converged markov chain monte carlos for the _ wmap _ one - year data for both flat and non - flat lcdm models .",
    "the chains are run using cmbfast ( version 4.4 using the high precision option ) and the @xmath82 are saved ; we select models with parameters within ( roughly ) the @xmath83 marginalized confidence level region for each parameter .",
    "we then calculate power spectra for cmbwarp and compare the two sets of @xmath82 . for tt , te and ee power spectra we present both the mean difference and the root - mean - square between cmbfast and cmbwarp , as a function of multipole @xmath49 .",
    "the first quantity is an estimate of the possible bias introduced by the perturbative approximation , while the latter is an estimate of the scatter .",
    "a comparison between cmbfast and boltzmann codes @xcite for one cosmological model ( the standard lcdm model ) reveals differences at the 0.1% level in the temperature power spectrum and the 1% level in the polarization power spectrum .",
    "figure  [ fig : ttrms ] shows this comparison for @xmath84 flat ( solid line ) and @xmath84 open ( dashed line ) models for the temperature power spectrum .",
    "the average difference is typically 0.3% : of the same order of magnitude of the difference between cmbfast and boltzmann codes .",
    "the rms plot shows not only that cmbwarp is unbiased , but that the rms scatter is only at the 0.5% level .",
    "as we demonstrate below , this level of accuracy is sufficient for accurate recovery of cosmological parameters from current and future cmb temperature experiments",
    ".    the te power spectrum crosses zero at several values of @xmath49 , so a fractional comparison is not possible .",
    "instead we compute the residual difference in @xmath85k@xmath86 between the two models . to be more specific we compute @xmath87 ( rms ) and @xmath88 ( bias ) .",
    "figure  [ fig : terms ] shows the results .",
    "the discrepancy is largest at large @xmath40 , and is of the order of a 1 - 2% percent .",
    "these discrepancies are always small compared to the cosmic variance @xmath89 , as shown in the figure .     and @xmath4 using _ wmap _ tt + te",
    ". the dashed line is for cmbfast while the solid line is for cmbwarp . ]    finally , fig .",
    "[ fig : eerms ] shows the comparison between cmbfast and cmbwarp for the ee power spectrum . for @xmath90",
    "the ee power spectrum is very close to zero , thus for @xmath91 we do a residual comparison as for te .",
    "the discrepancy with cmbfast is only few % of a @xmath92 and significantly below cosmic variance . for @xmath93",
    "the ee power spectrum is not close to zero and we show a fractional comparison .",
    "the agreement with cmbfast is at the 1 - 2% level , similar to that between cmbfast and boltzmann codes .",
    "we now turn our attention to the determination of cosmological parameters and their errors . given the satisfactory comparison between our approximate power spectra and those from cmbfast",
    ", we need to demonstrate that when we determine cosmological parameters from real measurements , cmbwarp yields the same parameter values and confidence intervals as cmbfast .    for this purpose",
    "we have calculated likelihood regions for two data sets : first the _ wmap _ one - year temperature power spectrum data @xcite , second the _ wmap _ one - year temperature and te power spectra @xcite complemented by the acbar data points @xcite extending to @xmath94 .",
    "the above tests are performed for flat and open cosmologies . in the likelihood analysis we use the full covariance matrix @xcite and we explore the likelihood surface with a markov chain ( see @xcite for more details ) .",
    "the procedure is effectively equivalent to that illustrated in @xcite , but with cmbwarp replacing cmbfast .",
    "a markov chain with @xmath95 models is now computed in 1.5 hours on a single intel 3.2 ghz cpu , the computational bottleneck in the calculation now being the evaluation of the likelihoods and not the computation of the power spectra .",
    "figure  [ fig : wmaptt1d ] shows the marginalized one - dimensional likelihoods obtained from chains computed with cmbfast ( dashed line ) and cmbwarp ( solid line ) , for _ wmap _ 1yr tt data only and for a flat model .",
    "the recovered best - fit parameters display no significant bias ( the parameter shift is always less that @xmath96 ) , the 1-@xmath0 error is recovered to within @xmath97 accuracy or better , and the 2-@xmath0 error is recovered to 20% .",
    "note that despite the fact that @xmath4 is effectively unconstrained when only temperature data are used , cmbwarp still recovers the same shape of the likelihood for @xmath4 .",
    "in the second test including the small - scale temperature measurements and the _ wmap _ one - year te data , the extra polarization data help to greatly constrain the integrated optical depth to reionization .",
    "once again , chains of flat models generated with cmbfast and cmbwarp return virtually the same cosmological parameters as can be seen in fig .",
    "[ fig : wmapttte1d ] . finally , fig .",
    "[ fig : wmapopen ] compares the recovered values of @xmath4 and @xmath14 when the model is not constrained to be flat .",
    "the set of approximations described here , cmbwarp , comprise a highly accurate and extremely fast method of approximating the microwave background temperature and polarization power spectra in standard inflation - like cosmological models for the range of cosmological parameters which encompass the likelihood regions allowed by the _ wmap _ first - year data . for 8 parameters , cmbwarp computes each multipole moment with @xmath1 50 floating - point operations ; it is unlikely that any significantly more efficient computational scheme can be constructed .",
    "note that the computational effort is the same for all multipole moments independent of @xmath49 ; conventional codes require large increases in computational cost as larger-@xmath49 multipoles are computed .",
    "this fact will become more important in the coming years as experiments such as planck , act @xcite and the south pole telescope map the microwave background at high resolution .",
    "cmbwarp is particularly well - suited to explorations of cosmological parameter space using markov chain techniques . as cosmological data continues to improve , joint analysis combining",
    "many different data sets will continue .",
    "the technique allows easy incorporation of the true microwave background constraints into joint analysis with a minimum of computational expense . a useful extension of cmbwarp would be a comparably fast and accurate computation of the transfer function and matter power spectrum .",
    "the optimal set of `` physical '' parameters for describing the matter power spectrum will not necessarily be the same as for the microwave background ; the crucial property of a set of parameters is that they must have orthogonal effects on the matter power spectrum .",
    "this will be addressed elsewhere .",
    "the speed and flexibility of cmbwarp make possible analysis with many more parameters which are not computationally feasible using standard techniques : one example is estimation of the primordial power spectrum using a number of parameters to describe it ( see , e.g. , @xcite ) , taking into account the effects of the standard cosmological parameters .",
    "markov chain monte carlo explorations of cosmological parameter space have now become common .",
    "the need for very fast , accurate , and portable microwave background power spectrum computations in this context is readily apparent .",
    "we hope cmbwarp proves to be a useful tool for these analyses .",
    "the work of rj is partially supported by nsf grant ast-0206031 .",
    "we thank p.  g.  castro and andy taylor for useful discussions .",
    "rj and lv thank the `` centro de investigaciones de astronomia '' ( cida ) and the university of edinburgh for hospitality while part of this work was carried out .",
    "ak is a cottrell scholar of the research corporation .",
    "we acknowledge the use of the legacy archive for microwave background data analysis ( lambda ) .",
    "support for lambda is provided by the nasa office of space science ."
  ],
  "abstract_text": [
    "<S> we improve the algorithm of kosowsky , milosavljevic , and jimenez ( 2002 ) for computing power spectra of the cosmic microwave background . </S>",
    "<S> the present algorithm computes not only the temperature power spectrum but also the e - mode polarization and the temperature - polarization cross power spectra , providing the accuracy required for current cosmological parameter estimation . </S>",
    "<S> we refine the optimum set of cosmological parameters for computing the power spectra as perturbations around a fiducial model , leading to an accuracy better than 0.5% for the temperature power spectrum throughout the region of parameter space within _ wmap _ s first - year 3@xmath0 confidence region . </S>",
    "<S> this accuracy is comparable to the difference between the widely - used cmbfast code ( seljak and zaldarriaga 1996 ) and boltzmann codes . </S>",
    "<S> our algorithm ( cmbwarp ) makes possible a full exploration of the likelihood region for eight cosmological parameters _ in about one hour on a laptop computer_. we provide the code to compute power spectra as well as the markov chain monte carlo algorithm for cosmological parameters estimation at http://www.physics.upenn.edu/@xmath1raulj/cmbwarp . </S>"
  ]
}