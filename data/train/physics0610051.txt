{
  "article_text": [
    "networks or graphs provide a useful mathematical representation of a broad variety of complex systems , from the world wide web and the internet to social , biochemical , and ecological systems .",
    "the last decade has seen a surge of interest across the sciences in the study of networks , including both empirical studies of particular networked systems and the development of new techniques and models for their analysis and interpretation  @xcite .    within the mathematical sciences ,",
    "researchers have focused on the statistical characterization of network structure , and , at times , on producing descriptive generative mechanisms of simple structures .",
    "this approach , in which scientists have focused on statistical summaries of network structure , such as path lengths  @xcite , degree distributions  @xcite , and correlation coefficients  @xcite , stands in contrast with , for example , the work on networks in the social and biological sciences , where the focus is instead on the properties of individual vertices or groups .",
    "more recently , researchers in both areas have become more interested in the global organization of networks  @xcite .",
    "one property of real - world networks that has received comparatively little attention is that of _ hierarchy _ , i.e. , the observation that networks often have a fractal - like structure in which vertices cluster together into groups that then join to form groups of groups , and so forth , from the lowest levels of organization up to the level of the entire network . in this paper , we offer a precise definition of the notion of hierarchy in networks and give a generic model for generating networks with arbitrary hierarchical structure .",
    "we then describe an approach for learning such models from real network data , based on maximum likelihood methods and markov chain monte carlo sampling .",
    "in addition to inferring global structure from graph data , our method allows the researcher to annotate a graph with community structure , edge strength , and vertex affiliation information .",
    "at its heart , our method works by sampling hierarchical structures with probability proportional to the likelihood with which they produce the input graph .",
    "this allows us to contemplate the ensemble of random graphs that are statistically similar to the original graph , and , through it , to measure various average network properties in manner reminiscent of bayesian model averaging .",
    "in particular , we can    1 .",
    "search for the maximum likelihood hierarchical model of a particular graph , which can then be used as a _",
    "null model _ for further hypothesis testing , 2 .",
    "derive a consensus hierarchical structure from the ensemble of sampled models , where hierarchical features are weighted by their likelihood , and 3 .",
    "annotate an edge , or the absence of an edge , as `` surprising '' to the extent that it occurs with low probability in the ensemble .    to our knowledge , this method is the only one that offers such information about a network .",
    "moreover , this information can easily be represented in a human - readable format , providing a compact visualization of important organizational features of the network , which will be a useful tool for practitioners in generating new hypotheses about the organization of networks .",
    "the idea of hierarchical structure in networks is not new ; sociologists , among others , have considered the idea since the 1970s . for instance , the method known as _ hierarchical clustering _",
    "groups vertices in networks by aggregating them iteratively in a hierarchical fashion  @xcite . however , it is not clear that the hierarchical structures produced by these and other popular methods are unbiased , as is also the case for the hierarchical clustering algorithms of machine learning  @xcite .",
    "that is , it is not clear to what degree these structures reflect the true structure of the network , and to what degree they are artifacts of the algorithm itself .",
    "this conflation of intrinsic network properties with features of the algorithms used to infer them is unfortunate , and we specifically seek to address this problem here .",
    "a hierarchical network , as considered here , is one that divides naturally into groups _ and _ these groups themselves divide into subgroups , and so on until we reach the level of individual vertices .",
    "such structure is most often represented as a tree or _",
    ", as shown , for example , in figure  [ fig : example ] .",
    "we formalize this notion precisely in the following way .",
    "let @xmath0 be a graph with @xmath1 vertices .",
    "a hierarchical organization of @xmath0 is a rooted binary tree whose leaves are the graph vertices and whose internal ( i.e. ,  non - leaf ) nodes indicate the hierarchical relationships among the leaves .",
    "we denote such an organization by , where each @xmath2 is an internal node , and every node - pair @xmath3 is associated with a unique  @xmath2 , their lowest common ancestor in the tree . in this way , @xmath4 partitions the edges of  @xmath0 .    , showing a hierarchy among seven graph nodes and the bernoulli trial parameter @xmath5 ( shown as a gray - scale value ) for each group of edges  @xmath2 . ]",
    "we now give a simple model @xmath6 of the hierarchical organization of a network .",
    "our primary assumption is that the edges of @xmath0 exist independently but with a probability that is not identically distributed .",
    "one may think of this model as a variation on the classical erds - rnyi random graph , where now the probability that an edge @xmath3 exists is given by a parameter @xmath5 associated with  @xmath2 , the lowest common ancestor of @xmath7 in  @xmath4 .",
    "figure  [ fig : dendro ] shows an example model on seven graph vertices . in this manner",
    ", a particular @xmath6 represents an ensemble of inhomogeneous random graphs , where the inhomogeneities are exactly specified by the topological structure of the dendrogram @xmath4 and the corresponding bernoulli trial parameters  @xmath8 .",
    "certainly , one could write down a more complicated model of graph hierarchy .",
    "the model described here , however , is a relatively generic one that is sufficiently powerful to enrich considerably our ability to learn from graph data .",
    "now we turn to the question of finding the parametrizations of @xmath6 that most accurately , or rather _ most plausibly _ , represent the structure that we observe in our real - world graph  @xmath0 .",
    "that is , we want to choose @xmath4 and @xmath8 such that a graph instance drawn from the ensemble of random graphs represented by @xmath6 will be statistically similar to  @xmath0 . if we already have a dendrogram  @xmath4 , then we may use the method of maximum likelihood  @xcite to estimate the parameters @xmath8 that achieve this goal .",
    "let @xmath9 be the number of edges in @xmath0 that have lowest common ancestor @xmath10 in  @xmath4 , and let @xmath11 ( @xmath12 ) be the number of leaves in the left- ( right- ) subtree rooted at  @xmath10 .",
    "then , the maximum likelihood estimator for the corresponding parameter is @xmath13 , the fraction of potential edges between the two subtrees of @xmath10 that actually appear in our data  @xmath0 .",
    "the posterior probability , or likelihood of the model given the data , is then given by @xmath14 while it is easy to find values of @xmath5 by maximum likelihood for each dendrogram , it is not easy to maximize the resulting likelihood function analytically over the space of all dendrograms . instead ,",
    "therefore , we employ a markov chain monte carlo ( mcmc ) method to estimate the posterior distribution by sampling from the set of dendrograms with probability proportional to their likelihood .",
    "we note that the number of possible dendrograms with @xmath1 leaves is super - exponential , growing like where @xmath15 denotes the double factorial .",
    "we find , however , that in practice our mcmc process mixes relatively quickly for networks of up to a few thousand vertices . finally , to keep our notation concise , we will use @xmath16 to denote the likelihood of a particular dendrogram  @xmath17 , when calculated as above .",
    "our monte carlo method uses the standard metropolis - hastings  @xcite sampling scheme ; we now briefly discuss the ergodicity and detailed balance issues for our particular application .",
    "let @xmath18 denote the current state of the markov chain , which is a dendrogram  @xmath4 .",
    "each internal node @xmath10 of the dendrogram is associated with three subtrees @xmath19 , @xmath20 , and @xmath21 , where two are its children and one is its sibling  see figure  [ fig : ergo ] . as the figure shows , these subtrees can be in one of the three hierarchical configurations . to select a candidate state transition @xmath22 for our markov chain ,",
    "we first choose an internal node uniformly at random and then choose one of its two alternate configurations uniformly at random .",
    "it is then straightforward to show that the ergodicity requirement is satisfied .",
    "( circle ) has three associated subtrees @xmath19 , @xmath20 , and @xmath21 ( triangles ) , which together can be in any of three configurations ( up to a permutation of the left - right order of subtrees ) . ]",
    "detailed balance is ensured by making the standard metropolis choice of acceptance probability for our candidate transition : we always accept a transition that yields an increase in likelihood or no change , i.e. ,  for which ; otherwise , we accept a transition that decreases the likelihood with probability equal to the ratio of the respective state likelihoods @xmath23 .",
    "this markov chain then generates dendrograms @xmath17 at equilibrium with probabilities proportional to  @xmath16 .",
    "with the formal framework of our method established , we now demonstrate its application to two small , canonical networks : zachary s karate club  @xcite , a social network of @xmath24 nodes and @xmath25 edges representing friendship ties among students at a university karate club ; and the year 2000 schedule of ncaa college ( american ) football games , where nodes represent college football teams and edges connect teams if they played during the 2000 season , where @xmath26 and @xmath27 . both of these networks have found use as standard tests of clustering algorithms for complex networks  @xcite and serve as a useful comparative basis for our methodology .",
    ", showing rapid convergence to equilibrium . ]",
    "figure  [ fig : converge ] shows the convergence of the mcmc sampling algorithm to the equilibrium region of model space for both networks , where we measure the number of steps normalized by @xmath28 .",
    "we see that the markov chain mixes quickly for both networks , and in practice we find that the method works well on networks with up to a few thousands of vertices .",
    "improving the mixing time , so as to apply our method to larger graphs , may be possible by considering state transitions that more dramatically alter the structure of the dendrogram , but we do not consider them here .",
    "additionally , we find that the equilibrium region contains many roughly competitive local maxima , suggesting that any particular maximum likelihood point estimate of the posterior probability is likely to be an overfit of the data . however , formulating an appropriate penalty function for a more bayesian approach to the calculation of the posterior probability appears tricky given that it is not clear to how characterize such an overfit .",
    "instead , we here compute average features of the dendrogram over the equilibrium distribution of models to infer the most general hierarchical organization of the network .",
    "this process is described in the following section .    to give the reader an idea of the kind of dendrograms our method produces ,",
    "we show instances that correspond to local maxima found during equilibrium sampling for each of our example networks in figures  [ fig : karate ] ( top ) and  [ fig : ncaa ] ( top ) . for both networks",
    ", we can validate the algorithm s output using known metadata for the nodes . during zachary s study of the karate network , for instance ,",
    "the club split into two groups , centered on the club s instructor and owner ( nodes @xmath29 and @xmath30 respectively ) , while in the college football schedule teams are divided into `` conferences '' of 812 teams each , with a majority of games being played within conferences . both networks have previously been shown to exhibit strong community structure  @xcite , and our dendrograms reflect this finding , almost always placing leaves with a common label in the same subtree . in the case of the karate club , in particular , the dendrogram bipartitions the network perfectly according to the known groups .",
    "many other methods for clustering nodes in graphs have difficulty correctly classifying vertices that lie at the boundary of the clusters ; in contrast , our method has no trouble correctly placing these peripheral nodes .    [",
    "cols=\"^,^ \" , ]",
    "we can also assign majority - weight properties to nodes and edges .",
    "we first describe the former , where we assign a group affiliation to each node .    given a vertex , we may ask with what likelihood it is placed in a subtree composed primarily of other members of its group ( with group membership determined by metadata as in the examples considered here ) . in a dendrogram",
    "@xmath4 , we say that a subtree rooted at some node @xmath10 encompasses a group  @xmath31 if both the majority of the descendants of @xmath10 are members of group  @xmath31 _ and _ the majority of members of group @xmath31 are descendants of  @xmath10 .",
    "we then assign every leaf below @xmath10 the label of  @xmath31 .",
    "we note that there may be some leaves that belong to no group , i.e. ,  none of their ancestors simultaneously satisfy both the above requirements , and vertices of this kind get a special no - group label . again , by weighting the group - affiliation vote of each dendrogram by its likelihood , we may measure exactly the average probability that a node belongs to its native group s subtree .",
    "second , we can measure the average probability that an edge exists , by taking the likelihood - weighted average over the sequence of parameters @xmath5 associated with that edge at equilibrium .",
    "estimating these vertex and edge characteristics allows us to annotate the network , highlighting the most plausible features , or the most surprising .",
    "figures  [ fig : karate : anno ] and  [ fig : ncaa : anno ] show such annotations for the two example networks , where edge thickness is proportional to average probability , and nodes are shaded proportional to the sampled weight of their native group affiliation ( lightest corresponds to highest probability ) .    for the karate network ,",
    "the dendrogram sampling both confirms our previous understanding of the network as being composed of two loosely connected groups , and adds additional information .",
    "for instance , node @xmath32 and the pair @xmath33 are found to be more loosely bound to their respective groups than other vertices  a feature that is supported by the average hierarchical structure shown in figure  [ fig : karate ] ( bottom ) .",
    "this looseness apparently arises because none of these vertices has a direct connection to the central players @xmath29 and  @xmath30 , and they are thus connected only secondarily to the cores of their clusters .",
    "also , our method correctly places vertex @xmath34 in the cluster surrounding  @xmath29 , a placement with which many other methods have difficulty .",
    "the ncaa network shows similarly suggestive results , with the majority of heavily weighted edges falling within conferences .",
    "most nodes are strongly placed within their native groups , with a few notable exceptions , such as the independent colleges , vertices  82 , 80 , 42 , 90 , and 36 , which belong to none of the major conferences .",
    "these teams are typically placed by our method in the conference in which they played the most games .",
    "although these annotations illustrate interesting aspects of the ncaa network s structure , we leave a thorough analysis of the data for future work .",
    "as mentioned in the introduction , we are not the first to study hierarchy in networks . in addition to persistent interest in the sociology community , a number of authors in physics have recently discussed aspects of hierarchical structure  @xcite , although generally via indirect or heuristic means . a closely related , and much studied , concept is that of community structure in networks  @xcite . in community structure calculations",
    "one attempts to find a natural partition of the network that yields densely connected subgraphs or communities .",
    "many algorithms for detecting community structure iteratively divide ( or agglomerate ) groups of vertices to produce a reasonable partition ; the sequence of such divisions ( or agglomerations ) can then be represented as a dendrogram that is often considered to encode some structure of the graph itself .",
    "( notably , a very recent exception among these community detection heuristics is a method based on maximum likelihood and survey propagation  @xcite . )    unfortunately , while these algorithms often produce reasonable looking dendrograms , they have the same fundamental problems as traditional hierarchical clustering algorithms for numeric data  @xcite .",
    "that is , it is not clear to what extent the derived hierarchical structures depend on the details of the algorithms used to extract them .",
    "it is also unclear how sensitive they are to small perturbations in the graph , such as the addition or removal of a few edges .",
    "further , these algorithms typically produce only a single dendrogram and provide no estimate of the form or number of plausible alternative structures .",
    "in contrast to this previous work , our method directly addresses these problems by explicitly fitting a hierarchical structure to the topology of the graph .",
    "we precisely define a general notion of hierarchical structure that is algorithm - independent and we use this definition to develop a random graph model of a hierarchically structured network that we use in a statistical inference context . by sampling via mcmc the set of dendrogram models that are most likely to generate the observed data",
    ", we estimate the posterior distribution over models and , through a scheme akin to bayesian model averaging , infer a set of features that represent the general organization of the network .",
    "this approach provides a mathematically principled way to learning about hierarchical organization in real - world graphs .",
    "compared to the previous methods , our approach yields considerable advantages , although at the expense of being more computationally intensive . for smaller graphs , however , for which the calculations described here are tractable , we believe that the insight provided by our methods makes the extra computational effort very worthwhile . in future work , we will explore the extension of our methods to larger networks and characterize the errors the technique can produce .    in closing",
    ", we note that the method of dendrogram sampling is quite general and could , in principle , be used to annotate any number of other graph features with information gained by model averaging .",
    "we believe that the ability to show which network features are surprising under our model and which are common is genuinely novel and may lead to a better understanding of the inherently stochastic processes that generate much of the network data currently being analyzed by the research community .",
    "ac thanks cosma shalizi and terran lane for many stimulating discussions about statistical inference , and mason porter for discussions about hierarchy .",
    "mejn thanks michael gastner for work on an early version of the model .",
    "this work was funded in part by the national science foundation under grants phy0200909 ( ac and cm ) and dms0405348 ( mejn ) and by a grant from the james s. mcdonnell foundation ( mejn ) .",
    "wasserman , s. , & robins , g.  l. ( 2005 ) .",
    "an introduction to random graphs , dependence graphs , and @xmath35 . in p.",
    "carrington , j.  scott and s.  wasserman ( eds . ) , _ models and methods in social network analysis_. cambridge university press ."
  ],
  "abstract_text": [
    "<S> one property of networks that has received comparatively little attention is hierarchy , i.e. , the property of having vertices that cluster together in groups , which then join to form groups of groups , and so forth , up through all levels of organization in the network . here , we give a precise definition of hierarchical structure , give a generic model for generating arbitrary hierarchical structure in a random graph , and describe a statistically principled way to learn the set of hierarchical features that most plausibly explain a particular real - world network . by applying this approach to two example networks </S>",
    "<S> , we demonstrate its advantages for the interpretation of network data , the annotation of graphs with edge , vertex and community properties , and the generation of generic null models for further hypothesis testing . </S>"
  ]
}