{
  "article_text": [
    "collisionless magnetized plasmas are described by the kinetic ( vlasov - maxwell ) equations and are characterized by high dimensionality , anisotropy and a wide variety of spatial and temporal scales @xcite , thus requiring the use of sophisticated numerical techniques to capture accurately their rich non - linear behavior .    in general terms , there are three broad classes of methods devoted to the numerical solution of the kinetic equations .",
    "dimensional phase space via macro - particles that evolve according to newton s equations in the self - consistent electromagnetic field @xcite .",
    "pic is the most widely used method in the plasma physics community because of its robustness and relative simplicity .",
    "the well known statistical noise associated with the macro - particles implies that pic is really effective for problems where a low signal - to - noise ratio is acceptable .",
    "the eulerian - vlasov methods discretize the phase space with a six dimensional computational mesh . as such they are immune to statistical noise but they require significant computational resources and this is perhaps why their application has been mostly limited to problems with reduced dimensionality .",
    "for reference , storing a field in double precision on a mesh with @xmath1 cells requires about @xmath2 terabytes of memory .",
    "a third class of methods , called transform methods , is spectral and is based on an expansion of the velocity part of the distribution function in basis functions ( typically fourier or hermite ) , leading to a truncated set of moment equations for the expansion coefficients @xcite . similarly to eulerian - vlasov methods , transform methods might be resource - intensive if the convergence of the expansion series is slow .",
    "in recent years there seems to be a renewed interest in hermite - based spectral methods .",
    "some reasons for this can be attributed to the advances in high performance computing and to the importance of simpler , reduced kinetic models in elucidating aspects of the complex dynamics of magnetized plasmas @xcite .",
    "another reason is that ( some form of ) the hermite basis can unify fluid ( macroscopic ) and kinetic ( microscopic ) behavior into one framework @xcite .",
    "thus , it naturally enables the fluid / kinetic coupling that might be the ( inevitable ) solution to the multiscale problem of computational plasma physics and is a very active area of research @xcite .",
    "the hermite basis is defined by the hermite polynomials with a maxwellian weight and is therefore closely linked to maxwellian distribution functions .",
    "two kinds of basis have been proposed in the literature ( differing in regard to the details of the maxwellian weight ) : symmetrically- and asymmetrically - weighted @xcite .",
    "the former features @xmath0-stability but conservation laws for total mass , momentum and energy are achieved only in limited cases ( i.e. , they depend on the parity of the total number of hermite modes , on the presence of a velocity shift in the hermite basis , ... ) .",
    "the latter features exact conservation laws in the discrete and the connection between the low - order moments and typical fluid moments , but @xmath0-stability is not guaranteed @xcite .",
    "earlier works pointed out that a proper choice of the velocity shift and the scaling of the maxwellian weight ( free parameters of the method ) is important to improve the convergence properties of the series @xcite .",
    "indeed , the optimization of the hermite basis is a crucial aspect of the method , which however at this point does not yet have a definitive solution .",
    "one could of course envision a different spectral approach which considers a full polynomial expansion without any weight or free parameter . while any connection with maxwellians is lost , such expansion could be of interest in presence of strong non - maxwellian behavior and eliminates the optimization problem .",
    "the legendre polynomials are a natural candidate in this case , because of their orthogonality properties .",
    "they are normally applied in some preferred coordinate system ( for instance spherical geometry ) to expose quantities like angles that are defined on a bounded domain .",
    "indeed , legendre expansions are very popular in neutron transport @xcite and some application in kinetic plasma physics can be found for electron transport described by the boltzmann equation @xcite .",
    "surprisingly , however , we have not found any example in the context of collisionless kinetic theory and in particular for the vlasov - poisson system .",
    "the main contribution of the present paper is the formulation , development and successful testing of a spectral method for the one dimensional vlasov - poisson model of a plasma based on a legendre polynomial expansion of the velocity part of the plasma distribution function .",
    "the expansion is applied directly in the velocity domain , which is assumed to be finite .",
    "it is shown that the legendre expansion features many of the properties of the asymmetrically - weighted hermite expansion : the structure of the equations is similar , the low - order moments correspond to the typical moments of a fluid , and conservation laws for the total mass , momentum and energy ( in weak form , as defined in sec .",
    "4 ) can be proven .",
    "it also features properties of the symmetrically - weighted hermite expansion : @xmath0-stability is also achieved by introducing a penalty on the boundary conditions in weak form .",
    "this strategy is inspired by the simultaneous approximation strategy ( sat ) technique  @xcite .",
    "the paper is organized as follows . in sec .",
    "[ sec : vlasov ] the vlasov - poisson equations for a plasma are introduced together with the spectral discretization : the velocity part of the distribution function is expanded in legendre polynomials while the spatial part is expressed in terms of a fourier series .",
    "the time discretization is handled via a second - order accurate crank - nicolson scheme . in sec .",
    "[ sec : l2:stability ] the sat technique is used to enforce the @xmath0-stability of the numerical scheme . in sec .",
    "[ sec : conservation : laws ] conservation laws for the total mass , momentum and energy are derived theoretically .",
    "numerical experiments on standard benchmark tests ( i.e. , landau damping , two - stream instabilities and ion acoustic wave ) are performed in sec .",
    "[ sec : numerical ] , proving numerically the stability of the method and the validity of the conservation laws .",
    "conclusions are drawn in sec .",
    "[ sec : conclusions ] .",
    "we consider the vlasov - poisson model for a collisionless plasma of electrons ( labeled `` @xmath3 '' ) and singly charged ions ( `` @xmath4 '' ) evolving under the action of the self - consistent electric field @xmath5 .",
    "the behavior of each particle species @xmath6 with mass @xmath7 and charge @xmath8 is described at any time @xmath9 in the phase space domain @xmath10\\times[{{v}_a},{{v}_b}]$ ] by the distribution function @xmath11 , which evolves according to the _ vlasov equation _ : @xmath12 we assume the physical space to be periodic in @xmath13 , so that no boundary condition for @xmath14 is necessary at @xmath15 and @xmath16 , and that suitable boundary conditions , e.g. , @xmath17 , are provided for @xmath14 at the velocity boundaries @xmath18 and @xmath19 for any time @xmath9 and any spatial position @xmath20 $ ] .",
    "we also assume that an initial solution @xmath21 is given at the initial time @xmath22 .    [",
    "remark : zero : velocity : bcs ] if the initial solution @xmath23 has a compact support in the phase space domain @xmath10\\times[{{v}_a},{{v}_b}]$ ] , then @xmath14 has also a compact support at any time @xmath24 .",
    "moreover , the size of the support may increase in time in a controlled way , cf .  @xcite .",
    "in such a case , it holds that @xmath17 until the size of the support equals the size of the velocity domain . this condition can be used to determine the final time at which a plasma simulation based on this numerical model is valid .    in the vlasov - poisson system ,",
    "the electric field @xmath25 is the solution of the _ poisson equation _ :",
    "@xmath26 where @xmath27 is the dielectric constant and @xmath28 is the _ total charge density _ of the plasma . by taking the time derivative of the poisson equation and using the continuity equation @xmath29 where @xmath30 is the _ total current density _ defined as @xmath31",
    "we obtain the _ ampere equation _",
    "@xmath32 where @xmath33 is a suitable constant factor .",
    "the ampere equation can be used with the vlasov equation instead of the poisson equation to obtain the vlasov - ampere formulation . in the continuum setting , the two formulations are equivalent in the one - dimensional electrostatic case without any external electric field as the one considered in this work .      consider the infinite set of _ legendre polynomials _",
    "@xmath34 , which are recursively defined for @xmath35 $ ] by  ( * ? ? ?",
    "* chapters 8 , 22 ) : @xmath36 and normalized as follows @xmath37 we remap the legendre polynomials onto the velocity range @xmath38 $ ] through the linear transformation @xmath39 .",
    "let @xmath40 be the inverse mapping from @xmath38 $ ] to @xmath41 $ ] .",
    "the @xmath42-th legendre polynomial is given by @xmath43 , where the scaling factor in front of @xmath44 is chosen to satisfy the orthogonality relation : @xmath45 the first derivative of the legendre polynomials is given by @xmath46,\\end{aligned}\\ ] ] where @xmath47 is a switch that takes value @xmath48 if @xmath49 is even , and @xmath50 if @xmath49 is odd . using the chain rule and adjusting the normalization factor , we obtain the first derivative of the translated and rescaled legendre polynomials : @xmath51 the recursion relations that are used to expand the vlasov equation on the legendre basis are reported in appendix a for completeness .",
    "consider the spectral decomposition of the distribution function @xmath14 on the basis of legendre polynomials given by @xmath52 in the vlasov equation  .",
    "the boundary conditions @xmath17 are not exactly satisfied since they are imposed in weak form and the polynomials @xmath53 are not zero at the velocity boundaries .    a possible way to circumvent this issue is to consider the modified basis functions given by @xmath54 for @xmath55 . from the properties of the legendre polynomials",
    ", it readily follows that @xmath56 for each @xmath42 and the expansion of @xmath14 on this set of functions will automatically satisfied the homogeneous conditions at the boundary of the velocity range .",
    "nonetheless , we verified numerically in the first stages of this work that this approach may yield an unstable method and the numerical instability can not be fixed as there is no mechanism that allows us to control the growth of the absolute value of the legendre coefficients @xmath57 .",
    "another possible choice is to consider @xmath58 for even @xmath59 and @xmath60 for odd @xmath61 .",
    "although we have not implemented this second basis , a common characteristic of these choices is the loss of orthogonality , which we suspect may influence negatively the stability properties of the method .",
    "the alternative approach that we consider hereafter is to integrate by parts the velocity term in the vlasov equations .",
    "this strategy allows us to set the boundary conditions in weak form , and , then , to introduce a penalty term to enforce the @xmath0 stability of the method through the boundary conditions ( see section  [ sec : l2:stability ] ) . to this end , we substitute   into  , we multiply the resulting equation by @xmath62 and integrate over @xmath38 $ ] .",
    "then , we use the recursion formulas  - and the orthogonality relation   and we obtain the following system of partial differential equations for the legendre coefficients @xmath63 : @xmath64}_{{{v}_a}}^{{{v}_b } }    \\right )     = 0     \\quad\\textrm{for~}n\\geq 0 ,    \\label{eq : legendre : system}\\end{aligned}\\ ] ] where conventionally @xmath65 , @xmath66    \\displaystyle\\frac{{{v}_b}-{{v}_a}}{2}\\,\\frac{n}{\\sqrt{(2n+1)(2n-1 ) } }    & \\textrm{for~}n\\geq 1 ,    \\end{cases }    \\label{eq : legendre : sigma : def}\\end{aligned}\\ ] ] and @xmath67}_{{{v}_a}}^{{{v}_b } } =     \\frac{{f^s}(x,{{v}_b},t)\\phi_n({{v}_b})-{f^s}(x,{{v}_a},t)\\phi_n({{v}_a})}{{{v}_b}-{{v}_a } } ,    \\label{eq : delta_v : def}\\end{aligned}\\ ] ] is the boundary term resulting from an integration by parts of the integral term that involves the velocity derivative . the derivation of the coefficients @xmath68 and @xmath69 can be found in appendix a. if the distribution @xmath11 has compact support in @xmath70 , the homogeneous boundary conditions at @xmath18 and @xmath19 are imposed in weak form by assuming that @xmath71}_{{{v}_a}}^{{{v}_b}}$ ] in   is zero .",
    "however , since this term plays a major role in establishing the conservation laws and ensuring the @xmath0 stability of the discretization method , we will consider it in all the further developments and in the analysis of the next sections .",
    "we truncate the spectral expansion of @xmath14 after the first @xmath72 _ legendre modes _ by assuming that @xmath73 for @xmath74 and we approximate the distribution function by the finite summation : @xmath75 the evolution of each coefficient @xmath57 with @xmath76 is still given by  . to ease the notation",
    ", we will drop the subindex @xmath77 in @xmath78 by tacitly assuming that all the quantities containing @xmath14 are indeed numerical approximations dependent on the first @xmath72 modes of the truncated series .",
    "let @xmath79 be the vector that contains all the coefficients @xmath57 for @xmath80 $ ] , i.e. , @xmath81 , and @xmath82 the vector containing the values of the legendre shape functions evaluated at @xmath83 .",
    "it holds that @xmath84 .",
    "system   can be rewritten in the non - conservative vector form : @xmath85}_{{{v}_a}}^{{{v}_b } }    \\right )     = 0 ,    \\label{eq : vlasov : legendre : non - conservation}\\end{aligned}\\ ] ] where @xmath86    ( { \\mathbbm{b}}{\\mathbf{c}^s})_{n } & = \\sum_{i=0}^{n-1}\\sigma_{n , i}{{c}^s}_{i } ,    \\label{eq : legendre : matb : def}\\end{aligned}\\ ] ] and @xmath87}_{{{v}_a}}^{{{v}_b}}\\big)_{n}={\\delta_v\\big [ { f^s}\\phi_{n } \\big]}_{{{v}_a}}^{{{v}_b}}$ ] .",
    "since @xmath88 is a constant matrix , it follows that @xmath89 therefore , system   also admits the conservative form : @xmath90}_{{{v}_a}}^{{{v}_b } }    \\right ) = 0 ,    \\label{eq : vlasov : legendre : conservation}\\end{aligned}\\ ] ] where @xmath88 is a real and symmetric matrix with real eigenvalues and eigenvectors .",
    "we expand each legendre coefficient @xmath63 on the first @xmath91 functions of the fourier basis @xmath92 ( for @xmath93 $ ] ) as follows @xmath94 where each coefficient @xmath95 is a complex function of time @xmath96 .",
    "the fourier basis functions satisfy the orthogonality relation @xmath97 substituting   in   and using  , we derive the system for the coefficients @xmath98 , which reads as : @xmath99}_{{{v}_a}}^{{{v}_b } }      \\right )    \\right]_{k } = 0 ,    \\label{eq : legendre : fourier : system}\\end{aligned}\\ ] ] for @xmath100 and @xmath101 , and where @xmath102 denotes the convolution integral and @xmath103_{k}$ ] denotes the @xmath104 mode of the fourier expansion of the argument inside the square brackets . explicit formulas for these quantities are given below .",
    "we also recall that if @xmath105 and @xmath106 are two given real functions of @xmath20 $ ] and @xmath107 and @xmath108 the coefficients of their fourier expansion on the basis functions @xmath109 , then the @xmath110-th fourier mode of the convolution product @xmath111 is given by @xmath112_k = \\sum_{k'=-{n_f}}^{{n_f}}g_{k ' } h_{k - k'}$ ] . the poisson equation for the electric field",
    "is similarly transformed by using   and the fourier expansion of the electric field @xmath113 into   to obtain @xmath114 for @xmath115 the equation above becomes @xmath116 which , according to the hypothesis of neutrality of the plasma , expresses the fact that the total charge in the system is zero .",
    "this implies that we can set the @xmath48-th fourier mode of the electric field to zero , i.e. , @xmath117    for convenience of notation , we introduce the vector @xmath118 that contains the @xmath110-th fourier coefficients @xmath119 for all the legendre modes @xmath80 $ ] , i.e. , @xmath120 .",
    "system   can be rewritten in the vector form : @xmath121}_{{{v}_a}}^{{{v}_b } }      \\right)\\right]_k     = 0 ,     \\label{eq : legendre : fourier : compact}\\end{aligned}\\ ] ] where @xmath122    ( { \\mathbbm{b}}{\\mathbf{c}^{s}_k})_{n } & = \\sum_{i=0}^{n-1}\\sigma_{n , i}{{c}^s}_{i , k }    \\label{eq : legendre : fourier : matb : def}\\\\[0.5em ]    \\big({\\delta_v\\big [ { f^s}{\\bm\\phi } \\big]}_{{{v}_a}}^{{{v}_b}}\\big)_{n }    &    = { \\delta_v\\big [ { f^s}\\phi_{n } \\big]}_{{{v}_a}}^{{{v}_b } }    = \\frac{1}{{{v}_b}-{{v}_a}}\\big({f^s}(x,{{v}_b},t)\\phi_{n}({{v}_b } ) - { f^s}(x,{{v}_a},t)\\phi_{n}({{v}_a})\\big).\\end{aligned}\\ ] ] note the vector expressions : @xmath123_{k } & = \\sum_{k'=-{n_f}}^{{n_f}}{e}_{k'}\\big[{\\mathbbm{b}}{\\mathbf{c}}\\big]_{k - k'}\\\\[0.5em ]      \\big[{e}{\\star}{\\delta_v\\big [ { f^s}{\\bm\\phi } \\big]}_{{{v}_a}}^{{{v}_b}}\\big]_{k } & =     \\sum_{k'=-{n_f}}^{{n_f}}{e}_{k ' }    \\sum_{n'=0}^{{n_l}-1}{{c}^s}_{n',k - k'}(t)\\big(\\phi_{n'}({{v}_b}){\\bm\\phi({{v}_b})}-\\phi_{n'}({{v}_a}){\\bm\\phi({{v}_a})}\\big)\\end{aligned}\\ ] ] and for the @xmath42-th legendre components : @xmath123_{n , k } & = \\sum_{k'=-{n_f}}^{{n_f}}{e}_{k'}\\sum_{i=0}^{n-1}\\sigma_{n , i}{{c}^s}_{i , k - k'}(t)\\\\[0.5em ]      \\big[{e}{\\star}{\\delta_v\\big [ { f^s}{\\bm\\phi } \\big]}_{{{v}_a}}^{{{v}_b}}\\big]_{n , k } & =     \\sum_{k'=-{n_f}}^{{n_f}}{e}_{k ' }    \\sum_{n'=0}^{{n_l}-1}{{c}^s}_{n',k - k'}(t)\\big(\\phi_{n'}({{v}_b})\\phi_n({{v}_b})-\\phi_{n'}({{v}_a})\\phi_n({{v}_a})\\big).\\end{aligned}\\ ] ]    consider the current density of species @xmath124 given by  .",
    "we apply the legendre decomposition  , the fourier decomposition   and we use   to obtain the legendre - fourier representation of the total current density : @xmath125 taking the derivative in time of   and using   with @xmath126 , we obtain the fourier representation of ampere s equation : @xmath127    & = -({{v}_b}-{{v}_a})l\\,\\sum_{s\\in\\{e , i\\}}{q^s}\\left (      \\left(\\frac{2\\pi{i}}{l}k\\right)\\big(\\sigma_1{{c}^s}_{1,k}+\\overline{\\sigma}{{c}^s}_{0,k}\\big )      + \\frac{{q^s}}{{m^s}}\\left[{e}{\\star}{\\delta_v\\big [ { f^s}\\phi_0 \\big]}_{{{v}_a}}^{{{v}_b}}\\right]_{k }    \\right ) .",
    "\\label{eq : legendre : fourier : ampere:00}\\end{aligned}\\ ] ] for @xmath128 and using definition   we reformulate ampere s equation as @xmath129 where @xmath130}_{{{v}_a}}^{{{v}_b}}\\right]_k .",
    "\\label{eq : legendre : fouriere : ampere : boundary : condition}\\end{aligned}\\ ] ] for @xmath115 , the fourier decomposition of ampere s equation   gives the consistency condition @xmath131 , the zero - th fourier mode of the total current density @xmath132 .      to control the filamentation effect , we modify system   by introducing the artificial collisional operator @xmath133 in the right - hand side @xcite : @xmath121}_{{{v}_a}}^{{{v}_b } }      \\right)\\right]_k    = \\mathcal{c}({\\mathbf{c}^{s}_k } ) .",
    "\\label{eq : legendre : fourier : compact : collisional}\\end{aligned}\\ ] ] consider the diagonal matrix @xmath134 whose @xmath42-th diagonal entry is given by : @xmath135 and where @xmath136 is an artificial diffusion coefficient whose value can be different from species to species .",
    "then , the collisional term is given by @xmath137 .",
    "the effect of this operator is to damp the highest - modes of the legendre expansion , thus reducing the filamentation and avoiding recurrence effects .",
    "this operator is designed to be zero for @xmath138 , in order not to have any influence on the conservation properties of the method .",
    "let @xmath139 be the time step , @xmath140 the time index , and each quantity superscripted by @xmath140 as taken at time @xmath141 , e.g. , @xmath142 , @xmath143 @xmath144 , etc .",
    "we advance the legendre - fourier coefficients @xmath95 in time by the crank - nicolson time marching scheme @xcite . omitting the superscript `` @xmath124 '' in @xmath145 and @xmath146 to ease the notation , vlasov equation   for each species and",
    "any legendre - fourier coefficient becomes : @xmath147    & \\qquad    -\\frac{{q^s}}{4{m^s } }    \\left [      \\big({e^{\\tau+1}}+{e^{\\tau}}\\big){\\star}\\left (        \\sum_{i=0}^{n-1}\\sigma_{n , i}\\big({c^{\\tau+1}}_{i}+{c^{\\tau}}_{i}\\big )        -\\gamma^s{\\delta_v\\big [   \\big({f^{\\tau+1}}+{f^{\\tau}}\\big)\\phi_n   \\big]}_{{{v}_a}}^{{{v}_b } }      \\right )    \\right]_{k } = \\mathcal{c}\\left(\\frac{1}{2}{c^{\\tau+1}}_{n , k } + \\frac{1}{2}{c^{\\tau}}_{n , k}\\right ) .",
    "\\label{eq : legendre : fourier : system : time}\\end{aligned}\\ ] ] equation   provides an implicit and non - linear system for the legendre - fourier coefficients @xmath95 as each electric field mode @xmath148 for @xmath149 depends on the unknown coefficient @xmath150 that must be evaluated at the same time @xmath151 . in practice",
    ", we apply a jacobian - free newton - krylov solver  @xcite to search for the minimizer of the residual given by  .    consider the difference of the fourier representation of poisson s equation   at times @xmath152 and @xmath151 @xmath153 by setting @xmath126 in  , recalling that @xmath154 and noting that the collisional term does not give any contribution",
    ", we find that @xmath155    & -\\frac{{q^s}}{4{m^s } }    \\left [      \\big({e^{\\tau+1}}+{e^{\\tau}}\\big){\\star}\\gamma^s{\\delta_v\\big [   \\big({f^{\\tau+1}}+{f^{\\tau}}\\big )   \\big]}_{{{v}_a}}^{{{v}_b } }    \\right]_{k}=0 .",
    "\\label{eq : ampere : discrete:05}\\end{aligned}\\ ] ] using   in   yields the discrete analog of ampere s equation that is consistent with the full crank - nicolson based discretization of the vlasov - poisson system : @xmath156 where we have introduced the explicit symbol @xmath157}_{{{v}_a}}^{{{v}_b } }    \\right]_{k }    \\qquad \\textrm{for~}k\\neq 0    \\label{eq : full : discrete : ampere : bc}\\end{aligned}\\ ] ] to denote the boundary terms related to the behavior of all the distribution functions of the plasma species at the boundaries of the velocity domain . in section  [ sec : conservation : laws ] we make use of   and   to characterize the conservation of the total energy .",
    "the distribution function @xmath14 solving the vlasov equation satisfies the so - called @xmath158-stability property for @xmath159 . to see this , just multiply equation   by @xmath160 and integrate over the phase space domain @xmath10\\times[{{v}_a},{{v}_b}]$ ] . assuming that the velocity range is sufficiently large for having @xmath17",
    ", a simple calculation shows that @xmath161 .",
    "this property is particularly useful for @xmath162 , which implies the _",
    "@xmath0 stability _ of the method ( sometimes called also `` energy stability '' in the literature ) . to derive a relation for the @xmath0 stability of the legendre - fourier method",
    ", we need the result stated by the following lemma .",
    "the proof of the lemma requires a few lengthy calculations and is reported , for the sake of completeness , in appendix c.    [ lemma : l2stab : useful ] let @xmath118 be the vector containing the legendre coefficients of the @xmath110-th fourier mode of the distribution function @xmath14 , @xmath163 the electric field and @xmath164 the matrix of coefficients defined in  .",
    "then , it holds that : @xmath165_k       = \\left[{e}{\\star}{\\delta_v\\big [ ( { f^s})^2 \\big]}_{{{v}_a}}^{{{v}_b}}\\right]_{0 }      = \\sum_{k=-{n_f}}^{{n_f}}({\\mathbf{c}^{s}_k})^{\\dagger}\\big[{e}{\\star}{\\delta_v\\big [ { f^s}\\bm\\phi \\big]}_{{{v}_a}}^{{{v}_b}}\\big]_k ,      \\label{eq : legendre : fourier : l2stab : useful }    \\end{aligned}\\ ] ] where @xmath166_{0}$ ] denotes the zero - th fourier mode of the argument inside the brackets , and @xmath167 denotes the conjugate transpose .",
    "all terms in   are real numbers .",
    "the @xmath0 stability of the legendre - fourier method depends on the behavior of the distribution function @xmath14 at the boundaries @xmath18 and @xmath19 .",
    "this result is stated by the following theorem .",
    "[ theo : l2stab ] the coefficients of the legendre - fourier decomposition have the property that : @xmath168}_{{{v}_a}}^{{{v}_b}}\\right]_{0 }      -2\\sum_{n=0}^{{n_l}-1}{\\left|d^{s}_{n}\\right|}\\sum_{k=-{n_f}}^{{n_f}}{\\left|{{c}^s}_{n , k}(t)\\right|}^2 .",
    "\\label{eq : l2stab }    \\end{aligned}\\ ] ]    _ proof_.  multiply   from the left by @xmath169 , the conjugate transpose of @xmath118 , to obtain : @xmath170}_{{{v}_a}}^{{{v}_b } }      \\right)\\right]_k",
    "= ( { \\mathbf{c}^{s}_k})^{\\dagger}{\\mathbbm{d}}^{s}_{\\nu}{\\mathbf{c}^{s}_k}.    \\ ] ] add to this equation its conjugate transpose .",
    "matrix @xmath88 is real and symmetric , @xmath171 is real and the spatial term cancels out from the equation . summing over the fourier index",
    "@xmath110 we end up with : @xmath172}_{{{v}_a}}^{{{v}_b } }      \\right)\\ ,    \\right]_{k }    + 2\\textsf{re}\\big(({\\mathbf{c}^{s}_k})^{\\dagger}{\\mathbbm{d}}^{s}_{\\nu}{\\mathbf{c}^{s}_k}\\big ) .",
    "\\label{eq : legendre : fourier : l2stab : thm:10}\\end{aligned}\\ ] ] since @xmath173 is a diagonal matrix with negative real entries @xmath174 and @xmath175 is a real quantity it holds that @xmath176 the assertion of the theorem follows by applying the result of lemma  [ lemma : l2stab : useful ] .    if @xmath17 at the velocity boundaries ( see remark  [ remark : zero : velocity : bcs ] ) , then at any instant @xmath24 the time derivative in   is negative due to the collisional term and we have that @xmath177 note that in absence of the collisional term ( take @xmath178 in  ) the time derivative is exactly zero and @xmath179 is constant . we refer to this property as _ the @xmath0 stability _ because the orthogonality of the legendre and fourier basis functions implies that @xmath180 ( see appendix b ) , from which we immediately find the @xmath0 stability of the distribution function @xmath11 .",
    "however , @xmath181 and @xmath182 can be different than zero and in general they are non zero since the legendre polynomials are globally defined on the whole domain and are non zero at the velocity boundaries .",
    "if the right - hand side of   becomes positive , the collisional term may be not enough to control the other term in the right - hand side of  .",
    "therefore , the method may become unstable and the time integration of @xmath14 is arrested .    according to  @xcite we can enforce the stability of the method by introducing the boundary conditions @xmath17 in weak form in the right - hand side of system   through the penalty coefficient @xmath183 . to this end , we modify system   as follows : @xmath184}_{{{v}_a}}^{{{v}_b } }      \\right)\\right]_k    = { \\mathbbm{d}}_{\\nu}{\\mathbf{c}^{s}_k}.    \\label{eq : legendre : fourier : modified}\\end{aligned}\\ ] ] by suitably choosing the value of the penalty we minimize or set equal to zero the term in the right - hand side of   that may cause the numerical instability .",
    "this result is presented in the following theorem .",
    "[ theo : l2-stab : modified ] the modified form   of the legendre - fourier method for solving the vlasov - poisson system is @xmath0-stable for @xmath185 and any @xmath186 .",
    "the coefficients of the legendre - fourier decomposition have the property that : @xmath187    _",
    "proof_.  repeating the proof of theorem  [ theo : l2stab ] yields : @xmath188}_{{{v}_a}}^{{{v}_b } }      \\right)\\ ,    \\right]_{k}\\nonumber\\\\[0.5em ]    & \\ ,    -2\\sum_{n=0}^{{n_l}-1}{\\left|d^{s}_{n}\\right|}\\sum_{k=-{n_f}}^{{n_f}}{\\left|{{c}^s}_{n , k}(t)\\right|}^2 .",
    "\\label{eq : stability : time : variation}\\end{aligned}\\ ] ] due to  , the first term of the right - hand side of   is zero ( when the coefficient that multiplies @xmath183 is non zero ) by setting @xmath189_{k } }     { \\sum_{k=-{n_f}}^{{n_f}}({\\mathbf{c}^{s}_k})^{\\dagger}\\left[\\,e{\\star}{\\delta_v\\big [ { f^s}{\\bm\\phi } \\big]}_{{{v}_a}}^{{{v}_b}}\\right]_{k } }    = \\frac{1}{2}.\\end{aligned}\\ ] ] the assertion of the theorem is then proved by noting that any choice of @xmath186 in the collisional term makes the time derivative non - positive .",
    "the coefficient @xmath183 in   affects also the first three moment equations and eventually perturbs the conservation properties of the vlasov - poisson system .",
    "we may overcome this issue by considering the modified system @xmath190}_{{{v}_a}}^{{{v}_b } }        \\right)\\right]_k      = { \\mathbbm{d}}_{\\nu}{\\mathbf{c}^{s}_k } ,      \\label{eq : legendre : fourier : modified : b }    \\end{aligned}\\ ] ] where the penalty @xmath183 is introduced through the diagonal matrix @xmath191 and does not change the conservation properties of the method .",
    "the penalty @xmath183 can be determined at any time cycle by the formula : @xmath192_{k } }       { \\sum_{n=3}^{{n_l}-1}\\sum_{k=-{n_f}}^{{n_f}}\\overline{c}^{s}_{nk}\\left[\\,e{\\star}{\\delta_v\\big [ { f^s}{\\bm\\phi } \\big]}_{{{v}_a}}^{{{v}_b}}\\right]_{n , k } } ,    \\end{aligned}\\ ] ] where @xmath193 is the conjugate of @xmath119 , and the result of theorem  [ theo : l2-stab : modified ] still holds .",
    "alternatively , we can apply @xmath194 to all the legendre modes except the first three , i.e. , for @xmath138 .",
    "this option is simpler to implement and computationally less expensive , but may not fix the stability issue of the method completely . instead of equation  , it holds that @xmath195}_{{{v}_a}}^{{{v}_b}}\\right]_{n , k }      -2\\sum_{n=0}^{{n_l}-1}{\\left|d^{s}_{n}\\right|}\\sum_{k=-{n_f}}^{{n_f}}{\\left|{{c}^s}_{n , k}(t)\\right|}^2 ,      \\label{eq : stability : time : variation : gr2 }    \\end{aligned}\\ ] ] and the first term in the right - hand side may still be a source of instability if it has the wrong sign . nonetheless ,",
    "if the dissipative effect of the collisional term in   is strong enough the scheme will remain stable .",
    "we investigated the effectiveness of this latter strategy in the numerical experiments of section  [ sec : numerical ] .",
    "the vlasov - poisson model in the continuum setting is characterized by the exact conservation of mass , momentum and energy .",
    "the spectral discretization that is proposed in the previous section reproduces these conservation laws in the discrete setting .",
    "it turns out that the discrete analogs of the conservation of mass , momentum and energy depends on the variation in time of the legendre - fourier coefficients @xmath98 for @xmath138 and @xmath115 , i.e. , @xmath196 , @xmath197 , and @xmath198 .",
    "the contribution of the second term in   is zero when @xmath115 and the transformed equation for the coefficients @xmath199 ( including the stabilization factor @xmath183 of section  [ sec : l2:stability ] ) becomes : @xmath200}_{{{v}_a}}^{{{v}_b}}\\right)\\right]_{0}.    \\label{eq : legendre : fourier : reduced}\\end{aligned}\\ ] ] in particular , we have : @xmath201}_{{{v}_a}}^{{{v}_b}}\\right]_{0 } ,    \\label{eq : legendre : fourier : dert_c00}\\\\[1.em ]    \\textrm{for~}n=1 , k=0:\\qquad &     \\frac{d{{c}^s}_{1,0}}{{dt } } =   \\frac{{q^s}}{{m^s}}\\left[{e}{\\star}\\big(\\sigma_{1,0}{{c}^s}_{0}-\\gamma^s{\\delta_v\\big [ { f^s}\\phi_1 \\big]}_{{{v}_a}}^{{{v}_b}}\\big)\\right]_{0 } ,    \\label{eq : legendre : fourier : dert_c10}\\\\[1.em ]    \\textrm{for~}n=2 , k=0:\\qquad &     \\frac{d{{c}^s}_{2,0}}{{dt } } =   \\frac{{q^s}}{{m^s}}\\left[{e}{\\star}\\big(\\sigma_{2,1}{{c}^s}_{1}-\\gamma^s{\\delta_v\\big [ { f^s}\\phi_2 \\big]}_{{{v}_a}}^{{{v}_b}}\\big)\\right]_{0}.    \\label{eq : legendre : fourier : dert_c20}\\end{aligned}\\ ] ] to derive the conservation laws for mass , momentum and energy for the fully discrete approximation , we note that the analog of equation   for @xmath115 becomes : @xmath202    & -\\gamma^s{\\delta_v\\big [ \\big({f^s}(\\cdot,{v},t^{\\tau+1})+{f^s}(\\cdot,{v},t^{\\tau})\\big)\\phi_n \\big]}_{{{v}_a}}^{{{v}_b } }    \\bigg)\\bigg]_{0 }    \\label{eq : legendre : fourier : reduced : full}\\end{aligned}\\ ] ] as the collisional term is zero , and where @xmath203 and @xmath204 are the electric field and the distribution function , respectively , as functions of @xmath13 for a given value of @xmath70 and @xmath96 .",
    "by setting @xmath138 in   we can also derive the analog of equations  - for the fully discrete approximation , which we omit . in the following developments we consider the boundary term : @xmath205}_{{{v}_a}}^{{{v}_b } }    \\right]_{0}.\\end{aligned}\\ ] ] note that @xmath206 when @xmath207 for @xmath208 .      using the legendre - fourier expansion of @xmath14 and the orthogonality relations   and  , the total mass of the species @xmath124",
    "is given by @xmath209 by taking the time derivative of eq   and using   it follows that @xmath210}_{{{v}_a}}^{{{v}_b}}\\right]_{0}.   \\label{eq : legendre : fourier : m3}\\end{aligned}\\ ] ] the conservation of the total mass per species includes a boundary term that is zero if @xmath17 ( see remark  [ remark : zero : velocity : bcs ] ) .    from   and using   with @xmath126 , we derive the conservation of the total mass per species in the full discrete model : @xmath211 equation   states that the mass variation between times @xmath151 and @xmath152 is balanced by the boundary term in the right - hand side .",
    "the total momentum of the plasma is defined as @xmath212 where @xmath213 is the total momentum of the species @xmath124 . introducing the legendre - fourier expansion of @xmath14 , using the integrated recursive formula  , orthogonality relations   and  , and mass equation   yield @xmath214",
    "taking the time derivative of equation   and using   it follows that @xmath215    & =     \\sum_{s\\in\\{e , i\\ } }    { q^s}({{v}_b}-{{v}_a})l\\,\\left (      \\sigma_{1}\\sigma_{1,0}\\,\\big[{e}{\\star}{{c}^s}_0\\big]_{0 } -      \\gamma^s      \\left[\\,{e}{\\star}\\left (           \\overline{\\sigma}{\\delta_v\\big [ { f^s}\\phi_0 \\big]}_{{{v}_a}}^{{{v}_b } } +           \\sigma_{1}{\\delta_v\\big [ { f^s}\\phi_1 \\big]}_{{{v}_a}}^{{{v}_b}}\\right)\\,\\right]_{0 }    \\right ) .",
    "\\label{eq : legendre : fourier : p3}\\end{aligned}\\ ] ] using the poisson equation the first term in the last right - hand side is zero because the summation on the convolution index is on a symmetric range of indices and the argument of the summation is anti - symmetric : @xmath216_{0 }     & = ( { { v}_b}-{{v}_a})l\\,\\sum_{k=-{n_f}}^{{n_f}}{e}_{k}(t)\\,\\sum_{s\\in\\{e , i\\}}{q^s}{{c}^s}_{0,-k}(t )   \\nonumber\\\\[0.5em ]    & = -2\\pi{i}\\epsilon_0\\,\\sum_{k=-{n_f}}^{{n_f}}k{e}_{k}(t){e}_{-k}(t )    = 0.\\end{aligned}\\ ] ] consequently , equation   becomes : @xmath217}_{{{v}_a}}^{{{v}_b}}+\\sigma_{1}{\\delta_v\\big [ { f^s}\\phi_1 \\big]}_{{{v}_a}}^{{{v}_b } }      \\right )      \\ ,    \\right]_{0}.    \\label{eq : legendre : fourier : p4}\\end{aligned}\\ ] ] the conservation of the total momentum includes a boundary term that is zero if @xmath17 ( see remark  [ remark : zero : velocity : bcs ] ) . from   and using   with @xmath218 , we derive the variation of momentum per species @xmath124 between times @xmath152 and @xmath151 : @xmath219    & = \\frac{{q^s}}{4}({{v}_b}-{{v}_a})l\\,\\sigma_{1}\\delta t\\ ,    \\bigg[\\big({e}(\\cdot , t^{\\tau+1})+{e}(\\cdot , t^{\\tau})\\big){\\star}\\big(\\sigma_{1,0}\\big({{c}^s}_{0}(t^{\\tau+1})+{{c}^s}_{0}(t^{\\tau})\\big)\\big)\\bigg]_{0 }    \\nonumber\\\\[0.5em ]    & \\quad+\\delta t\\left (    \\sigma_{1}\\mathcal{b}^{s;\\tau,\\tau+1}_{1,0 }    + \\overline{\\sigma}\\mathcal{b}^{s;\\tau,\\tau+1}_{0,0 }    \\right).\\end{aligned}\\ ] ] furthermore , summing over all the species , taking the zero - th fourier mode of the convolution product , and using the poisson equation yield : @xmath220_{0 }     \\nonumber\\\\     & \\qquad\\qquad=    \\sum_{k=-{n_f}}^{{n_f}}\\big(e(\\cdot , t^{\\tau+1})+e(\\cdot , t^{\\tau})\\big)_{k }    \\sum_{s\\in\\{e , i\\}}{q^s}\\,({{v}_b}-{{v}_a})l\\,\\big({{c}^s}_{0}(t^{\\tau+1})+{{c}^s}_{0}(t^{\\tau})\\big)_{-k }    \\nonumber\\\\     & \\qquad\\qquad=    -2\\pi",
    "i\\epsilon_0    \\sum_{k=-{n_f}}^{{n_f}}k    \\big(e(\\cdot , t^{\\tau+1})+e(\\cdot , t^{\\tau})\\big)_{k }    \\big(e(\\cdot , t^{\\tau+1})+e(\\cdot , t^{\\tau})\\big)_{-k }    = 0.\\end{aligned}\\ ] ] therefore , in the full discrete model the _ conservation of the total momentum _ holds in the form : @xmath221 which states that the variation of the total momentum between times @xmath152 and @xmath151 is balanced by the boundary terms in the right - hand side of  .",
    "the total energy of the plasma is defined as @xmath222 where @xmath223 and @xmath224 are the kinetic energy of the species @xmath124 and the potential energy at time @xmath96 , respectively . introducing the legendre - fourier expansion of @xmath14 and using the orthogonality relations   and  ,",
    "the kinetic energy of species @xmath124 is reformulated as : @xmath225    we take the derivative in time of @xmath223 and use  - to obtain @xmath226    & =    \\frac{{q^s}}{2}({{v}_b}-{{v}_a})l\\,\\left[{e}{\\star}\\big (    \\sigma_{1}\\sigma_{2}\\sigma_{2,1}\\,{{c}^s}_{1 } +    2\\overline{\\sigma}\\sigma_{1}\\sigma_{1,0}\\,{{c}^s}_{0 }    \\big)\\right]_{0 }    + \\mathcal{b}^s_{kin }    \\label{eq : kinetic : energy:00}\\end{aligned}\\ ] ] where we introduced the `` kinetic '' boundary term per species @xmath124 : @xmath227}_{{{v}_a}}^{{{v}_b } } +      2\\sigma_1\\overline{\\sigma}{\\delta_v\\big [ { f^s}\\phi_1 \\big]}_{{{v}_a}}^{{{v}_b } } +      ( \\sigma_1 ^ 2+\\sigma_0 ^ 2+\\overline{\\sigma}^2){\\delta_v\\big [ { f^s}\\phi_0 \\big]}_{{{v}_a}}^{{{v}_b } }      \\,\\big)\\right]_{0}.\\end{aligned}\\ ] ] as @xmath228 , and applying   to  , we obtain : @xmath229_{0 }     + \\mathcal{b}^{s}_{kin }    = \\big[{e}{\\star}{j^s}\\big]_{0 } + \\mathcal{b}^{s}_{kin}.    \\label{eq : legendre : fourier : e3}\\end{aligned}\\ ] ] using  , the orthogonality relation   and the convolution notation , the potential energy of the electric field is given by : @xmath230_{0}.    \\label{eq : epot : fourier}\\end{aligned}\\ ] ] then , we take the time derivative of the equation above , use ampere s equation   and note that @xmath231_0=0 $ ] as the average of @xmath5 on @xmath10 $ ] is zero to obtain : @xmath232_{0 }    = -\\bigg[{e}{\\star}\\bigg (    \\sum_{s\\in\\{e , i\\}}\\big({j^s}+\\gamma^sq^s\\big )    + c_{a }    \\bigg )    \\bigg]_{0 }    = -\\bigg[{e}{\\star}\\sum_{s\\in\\{e , i\\}}{j^s}\\bigg]_{0 } + \\mathcal{b}_{pot}\\end{aligned}\\ ] ] where , after expanding the convolution product , we introduced the symbol @xmath233 for the `` potential '' boundary term , @xmath234 being the boundary term defined in ampere s equation  . adding the total kinetic energy for all species and the potential energy gives :",
    "@xmath235 the conservation of the total energy includes a boundary term that is zero if @xmath17 ( see remark  [ remark : zero : velocity : bcs ] ) .    from",
    ", the variation of the kinetic energy @xmath223 between times @xmath152 and @xmath151 reads as : @xmath236    & \\qquad    + 2\\sigma_{1}\\overline{\\sigma}\\,\\big({{c}^s}_{1,0}(t^{\\tau+1 } ) - { { c}^s}_{1,0}(t^{\\tau})\\big ) +    \\big ( \\sigma_{1}^2+\\sigma_{0}^2+\\overline{\\sigma}^2 \\big)\\,\\big({{c}^s}_{0,0}(t^{\\tau+1 } ) - { { c}^s}_{0,0}(t^{\\tau})\\big )    \\big).\\end{aligned}\\ ] ] using   with @xmath237 yields : @xmath238    &    + 2\\sigma_{10}\\sigma_{1}\\overline{\\sigma}\\big({{c}^s}_{0}(t^{\\tau+1})+{{c}^s}_{0}(t^{\\tau})\\big )    \\big )    \\bigg]_{0 } +     \\delta t\\mathcal{b}^{s;\\tau,\\tau+1}_{kin},\\end{aligned}\\ ] ] where @xmath239 noting that @xmath240 , using the definition of the convolution product @xmath102 , the fourier decomposition of the electric field and the legendre coefficients , and the definition of the fourier coefficients of the current density @xmath241 given in   yield : @xmath242 from  , the variation of the potential energy between times @xmath151 and @xmath152 is given by : @xmath243_{0 } -    \\frac{\\epsilon_0}{2 }    \\big[{e}(\\cdot , t^{\\tau}){\\star}{e}(\\cdot , t^{\\tau})\\big]_{0 }    \\nonumber\\\\[0.5em ]    & = \\frac{\\epsilon_0}{2}\\big [    \\big({e}(\\cdot , t^{\\tau+1})-{e}(\\cdot , t^{\\tau})\\big){\\star}\\big({e}(\\cdot , t^{\\tau+1})+{e}(\\cdot,\\tau)\\big )    \\big]_{0 }    \\nonumber\\\\[0.5em ]    &    = \\frac{\\epsilon_0}{2 }    \\sum_{k=-{n_f}}^{{n_f } }    \\big({e}^{\\tau+1}_{k}-{e}^{\\tau}_{k}\\big)\\ ,    \\big({e}^{\\tau+1}_{-k}+{e}^{\\tau}_{-k}\\big).\\end{aligned}\\ ] ] using the discrete analog of ampere s equation given by   and   yields : @xmath244 where @xmath245 finally , we add the kinetic energy terms for @xmath6 in   and the potential energy   to find the relation expressing the _ total energy conservation _ for the full discrete approximation : @xmath246 equation   states that the variation of the total energy between times @xmath152 and @xmath151 is balanced by the proper combination of kinetic and potential boundary terms in the right - hand side and expresses the _ conservation of the total energy _ for the full discretization of the vlasov - poisson system .",
    "in this section we assess the computational performance of the legendre - fourier method by solving the landau damping , two - stream instability and ion acoustic wave problems .",
    "these test cases are classical problems in plasma physics and are routinely used to benchmark kinetic codes . in our numerical experiments , we are mainly interested in showing the conservation properties of the method , i.e. , the discrepancy between the initial value of mass , momentum and energy , and their value at successive instants in time during the simulation .",
    "we also investigate the stability of the method , i.e. , how the @xmath0-norm of the distribution function defined as in   changes during the time evolution of the system .",
    "the penalty @xmath247 is applied to all legendre modes except the first three and the stability of the legendre - fourier method is ensured by the artificial collisional term when @xmath248 .",
    "this strategy , which is discussed at the end of section  [ sec : l2:stability ] , is very effective in providing a stable method with good conservation properties . in the two - stream instability problem",
    ", we also investigate the effect of applying penalty @xmath247 on all the moment equations on the conservation of the total energy .    in the first two test problems ,",
    "the ions constitute a fixed background with density @xmath249 .",
    "we also introduce the following normalization : time is normalized on the electron plasma frequency @xmath250 ; position @xmath13 on the electron debye length @xmath251 ; velocity @xmath83 on the electron thermal velocity @xmath252 where @xmath110 is the boltzmann constant , @xmath253 the electron temperature and @xmath254 the electron mass ; the electric field @xmath5 on @xmath255 , where @xmath3 is the elementary charge ; species densities on a reference density @xmath256 ; and the species distribution function on @xmath257 .",
    "landau damping is a classical kinetic effect in warm plasmas , due to particles in resonance with an initial wave perturbation .",
    "this interaction leads to an exponential decay of the electric field perturbation .",
    "this problem is particularly challenging for kinetic codes because of the continuous filamentation in velocity space , which is a characteristic feature of the collision - less plasma described by the vlasov equation .",
    "filamentation is controlled by the artificial collisional operator introduced in  .",
    "the initial distribution of the electrons is given by @xmath258 ,    \\label{finit}\\ ] ] with @xmath259 and @xmath260 .",
    "the legendre - fourier expansion of eq .",
    "( [ finit ] ) implies that the modes @xmath261 , @xmath262 and @xmath263 are excited at @xmath22 .    in this test case , the final simulation time is @xmath264 with time step @xmath265 , @xmath266 legendre modes and @xmath267 fourier modes .",
    "the domain of integration is set to @xmath268 , @xmath269 .",
    "figure  [ fig : ld:00 ] shows the first mode of the electric field @xmath270 versus time for two different values of the stabilization parameter ( @xmath271 ) and the collisional frequency ( @xmath272 ) . for all cases the damping rate is in good agreement with the landau damping theory , which predicts @xmath273 .",
    "one can also notice that for all cases the simulation is stable , regardless of the value of @xmath247 , and that @xmath247 does not really affect much the dynamics .",
    "as expected , when @xmath274 the system exhibits recursive behavior .",
    "the collisional operator with @xmath248 is however sufficient to remove the recurrence effect and @xmath270 stabilizes around @xmath275 for @xmath276 .",
    "figure  [ fig : ld:02 ] ( left ) shows the time evolution of @xmath277 , which is normalized to its value at time @xmath22 , for the same cases of fig .  [",
    "fig : ld:00 ] . according to ,",
    "this quantity is computed as @xmath278    when @xmath274 , the @xmath0 norm of @xmath279 is constant on the scale of the plot and the boundary term in   has a rather negligible effect . instead , when @xmath248 , the @xmath0 norm of @xmath279 decreases with an almost constant slope since the collisional term in   is dominant .",
    "figure  [ fig : ld:02 ] ( right ) shows that theorem  [ theo : l2stab ] [ equation  ] is indeed satisfied numerically . in fig .",
    "[ fig : ld:02 ] ( right ) the time derivative is computed by central finite differences .",
    "figure  [ fig : ld:04 ] shows the time evolution of the maximum value of the distribution function at the boundary of the system @xmath280 : @xmath281 , with the same format of fig .",
    "[ fig : ld:00 ] .",
    "one can notice the beneficial effect of the collisional operator : when @xmath274 there is a sharp increase of @xmath282 around @xmath283 , while for @xmath248 it holds that @xmath282 approximately @xmath284 throughout the whole simulation .",
    "finally , the legendre - fourier method presented in this work provides exact conservation laws .",
    "the relative discrepancy of the mass , defined as @xmath285 , and the discrepancy of momentum , defined as @xmath286 , are _ exactly zero _ at any discrete time step @xmath287 in our double precision implementation and are therefore not shown .",
    "the relative discrepancy of the total energy , defined as @xmath288 is shown in figure  [ fig : ld:06 ] and is smaller than @xmath289 .",
    "the two - stream instability is excited when the distribution function of a species consists of two populations of particles streaming in opposite directions with a large enough relative drift velocity .",
    "we initialize the electron distribution function with two counter - streaming maxwellians with equal temperature : @xmath290    \\,\\left[1+\\varepsilon\\cos\\big(\\frac{2\\pi}{l}kx\\big)\\right ]    \\label{eq : two - stream : init - sol}\\end{aligned}\\ ] ] where @xmath291 is the drift velocity . for this test case",
    ", we have chosen the following parameters : @xmath292 , @xmath293 , @xmath260 , @xmath259 .",
    "we integrate the vlasov - poisson system by using the time step @xmath294 , @xmath266 legendre modes , and @xmath267 fourier modes .",
    "the domain of integration in phase space is set to @xmath295 , @xmath269 for all the calculations shown in figures  [ fig:2s:00]-[fig:2s:05 ] , while in figure  [ fig : two - stream : fs : phase - space ] we show the distribution function of electrons that is computed for three different combinations of @xmath72 and velocity range @xmath38 $ ] .",
    "this example was also considered with similar input parameters as in ref .  in  @xcite , where the vlasov equation was discretized using @xmath296 hermite modes .",
    "the electron distribution function was inizialized by combining two drifting maxwellians centered at two different velocities , each expanded in the hermite basis . since the discretization was based on the asymmetrically weighted hermite basis functions  @xcite , the two maxwellians were completely described by setting only the first mode of each expansion .",
    "the remaining modes were needed to describe the non - maxwellian evolution of the solution .",
    "when using the legendre - fourier discretization proposed in this work , there is no correspondence between the first mode and the maxwellian distribution .",
    "thus , in order to have sufficient accuracy , the spectral expansion requires to consider all the polynomial modes from the beginning .    in figure  [ fig:2s:00 ]",
    "we show the first fourier mode of the electric field @xmath297 versus time for the four combinations of @xmath298 and @xmath272 .",
    "the initial part of the dynamics is the same for the four curves and one can see the development of the two - stream instability .",
    "the slope of the numerical curves matches well the theoretical slope predicted by the linear theory , which is shown as a dashed line in the plot .",
    "when @xmath299 , the two curves for @xmath300 stop at @xmath301 ( slightly prior to the end of the linear phase ) because of the development of a numerical instability .",
    "when @xmath302 and @xmath248 the scheme is numerically stable and reaches the final time of the simulation , @xmath303 , without problems .",
    "instead , the case @xmath274 stops converging at around @xmath304 because of problems related to the behavior of @xmath279 at the boundary ( as documented below ) .    figure  [ fig:2s:02 ] ( left ) shows the time evolution of the @xmath0 norm of the distribution function @xmath279 normalized with respect to initial value according to   the cases presented in fig .  [ fig:2s:00 ] .",
    "figure  [ fig:2s:02 ] ( right ) shows a zoom around @xmath50 .",
    "one can clearly see that the @xmath0 norm of @xmath279 grows unboundedly when @xmath299 , indicating that the first term on the right hand side of equation   provides a positive feedback that is not even compensated by the collisional term when @xmath248 .",
    "hence , the scheme is numerically unstable .",
    "when @xmath302 the scheme is numerically stable .",
    "indeed , by applying @xmath247 to all the moment equation , we have verified numerically that the @xmath0 norm of @xmath279 is constant in time for @xmath274 and damps for @xmath248 as predicted by theorem @xmath305 , cf .",
    "equation  .",
    "if @xmath247 is applied to all the legendre modes _ except the first three _ we obtain the behavior shown in figure  [ fig:2s:02 ] , where a slow growth of the @xmath0 norm of @xmath279 is visible for @xmath274 .",
    "figure  [ fig:2s:03 ] shows the numerical representation of equation  , where the time derivative is approximated by central finite differences for the case @xmath302 and @xmath248 . from this figure",
    ", we deduce that theorem  [ theo : l2stab ] and equation  , are verified numerically to a good degree of accuracy .    the behavior of the maximum value of the distribution function on the domain boundary , @xmath306 , is shown in fig .  [ fig:2s:04 ] .",
    "as expected , for @xmath299 the simulation is unstable and @xmath279 grows unbounded on the boundary .",
    "the stabilization provided by @xmath302 is effective and limits the value of @xmath307 there .",
    "however , when @xmath274 one can see that @xmath306 still grows sizably and becomes of order unity ( i.e. of the same order of the initial distribution function ) at around @xmath308 .",
    "clearly this signals that the simulation is not accurate anymore .",
    "when @xmath248 , on the other hand , @xmath306 remains reasonably small throughout the simulation .    in figures  [ fig:2s:05 ] and  [ fig:2s:09-all ]",
    "we show the variation in time of momentum ( left plot , @xmath286 although @xmath309 in this case ) and relative variation in time of total energy ( right plot , @xmath288 ) with respect to the initial value . as for all the previous figures ,",
    "the plots shown in figure  [ fig:2s:05 ] are obtained by applying the penalty @xmath247 to all the moment equations except the first three . in this case ,",
    "total momentum and total energy , as well as mass which is not shown , are conserved extremely well in the simulations , as predicted by the analysis of sections  [ sec : conservation : laws ] and  [ sec : time : integration ] . instead",
    ", the results of figure  [ fig:2s:09-all ] are obtained by applying penalty @xmath247 to all the moment equations . in this case , the total momentum variation that is visible is of the order of magnitude of @xmath275 and total energy variation is of the order of magnitude of @xmath310 .",
    "these results are still in accord with the analysis of sections  [ sec : conservation : laws ] because we know from sections [ subsect : momentum : conservation ] and  [ subsect : energy : conservation ] that both momentum and energy variation contain boundary terms that are not included in this diagnostics .",
    "it is worth noting that these boundary terms explicitly contain @xmath247 , and are zero if @xmath299 in their expression .",
    "also note that in the two - stream instability problem , momentum is symmetric and that these results show that the symmetry of the problem is not violated by the legendre - fourier method .    in figure",
    "[ fig : two - stream : fs : phase - space ] we show the electron distribution function in phase space that is computed by using three different combinations of @xmath72 , the number of legendre modes , and velocity range @xmath38 $ ] for @xmath311 and @xmath312 .",
    "in particular , the plots on top are obtained by using @xmath313 and integrating over the velocity range @xmath314 $ ] ; the plots in the middle are obtained by using @xmath315 and the velocity range @xmath314 $ ] ; the plots on bottom are obtained by using @xmath315 and the velocity range @xmath316 $ ] .",
    "the plots on the left show the distribution function at @xmath317 , the plots on the right at @xmath318 .",
    "the resolution of @xmath279 clearly depends on the combination that is chosen : it improves by increasing @xmath72 in a fixed velocity range and it worsen by increasing the domain size with a fixed @xmath72 .",
    "last , we consider the evolution of an ion acoustic wave .",
    "this is a truly multiscale example , occurring on the slow time scales associated with the ions but where the electron motion concurs in defining the properties of the wave .",
    "following  @xcite , we initialize a perturbation in the ion distribution function at t=0 @xmath319\\ ] ] while the electrons are maxwellian and unperturbed @xmath320 other parameters are @xmath321 , @xmath322 , @xmath323 , @xmath324 , @xmath325 , @xmath326 , @xmath302 , while @xmath139 and @xmath327 are varied parametrically .",
    "although we only present results with a smaller perturbation @xmath324 , we have also tried larger perturbations and essentially successfully reproduced the results of ref .",
    "@xcite for @xmath328 .",
    "figure [ fig : ia:00 ] shows the amplitude of the electric field for the first fourier mode initially excited at @xmath22 .",
    "four curves are plotted , corresponding to @xmath329 and @xmath330 .",
    "the initial evolution of the system is the same for all the curves and one can see some electron oscillations .",
    "however , when @xmath178 the simulations are corrupted by a large amount of unphysical oscillations ( quite irrespective of @xmath139 ) .",
    "when @xmath331 , on the other hand , the ion acoustic wave signal is recovered well : the period of @xmath270 obtained from the simulations is @xmath332 , in good agreement with the theoretical value of @xmath333 .",
    "we note that the curves obtained with @xmath331 and @xmath265 and @xmath334 are virtually indistinguishable , showing the ability of our numerical scheme to step over the faster frequency in the system , the electron plasma frequency , without any sign of numerical instability .",
    "we have also performed simulations with larger @xmath139 ( up to @xmath335 , not shown ) .",
    "the ion acoustic wave becomes progressively less accurate but , as expected , there is no sign of numerical instabilities .",
    "figure [ fig : ia:01 ] shows the time evolution of the @xmath0 norm of the distribution function normalized as in   for the four simulations of fig .",
    "[ fig : ia:00 ] . as for the landau damping case , when @xmath178 the @xmath0 norm of the distribution function is flat ( on the scale of the plot ) , indicating a minimal contribution of the boundary terms in  .",
    "when @xmath331 , the @xmath0 norm of the distribution function decreases in time due to the dominant contribution of the collisional term .",
    "figure [ fig : ia:02 ] shows the maximum of @xmath336 on the boundaries of the velocity space , with the same format of fig .",
    "[ fig : ia:00 ] .",
    "although @xmath282 remains fairly small for all the cases , once again one can see the beneficial effect of the collisional operator : for @xmath331 it holds that @xmath282 is more than an order of magnitude smaller than for @xmath178 .    finally , fig .",
    "[ fig : ia:03 ] shows the time evolution of the total momentum and the relative variation of the total energy for the simulations with @xmath331 and @xmath265 and @xmath334 ( total mass is not shown since it is conserved exactly ) . in general , as expected , both quantities are conserved well .",
    "one can notice that the error in the total momentum is controlled by the time step , while this is not the case for the total energy .",
    "in this paper a spectral method for the numerical solution of the vlasov - poisson equations of a plasma has been presented .",
    "the plasma distribution function is decomposed in legendre polynomials applied directly on a finite domain in velocity space .",
    "the resulting set of moment equations is further discretized spatially by a fourier decomposition ( periodic boundary conditions are assumed ) and in time by a fully - implicit , second order accurate crank - nicolson scheme .",
    "a collisional term is also considered in the discrete model to control the filamentation effect , but does not affect the conservation properties of the method .",
    "a jacobian - free newton - krylov method ( with the gmres solver for the inner linear iterations ) is used to solve the discrete non - linear equations .",
    "the most significant aspects of our work are three .",
    "first , the method is formulated in such a way that the boundary conditions in velocity space ( @xmath337 at the boundary of the velocity domain ) are applied in weak form .",
    "that is , they are not enforced exactly through an expansion basis obtained by a linear combination of the legendre polynomials . instead , the boundary conditions are satisfied approximately via an integration by parts once the vlasov equation is projected onto the legendre basis functions ( see sec .",
    "[ sec : vlasov ] ) .",
    "second , introducing a penalty on the weak form of the boundary conditions allows the formulation of the numerical scheme to be @xmath0-stable .",
    "third , the numerical scheme features conservation laws for total mass , momentum and energy in weak form .",
    "the numerical experiments performed in sec .",
    "[ sec : numerical ] on landau damping , two - stream instability and ion acoustic wave test cases confirm both the stability of the method and the validity of the conservation laws .",
    "lin - landau - cropped - e1_all_gr2 ( 48,-4 )    * time *    ( -5,36 )    @xmath338    lin - landau - cropped - c2_all_gr2 ( 48,-6)*time * ( -8,21 )    * @xmath0 norm of @xmath14 *    lin - landau - cropped - dc2dt_alpha05_nu1_gr2 ( 48,-6)*time * ( -8,13 )    * variation of @xmath339 *    lin - landau - cropped - maxfbc_all_gr2 ( 48,-5 )    * time *    ( -5,29 )    * max(@xmath340 ) *    lin - landau - cropped - wtot_alpha05_nu1_gr2 ( 48,-5 )    * time *    ( -5,15 )    * variation of total energy *    two - stream - cropped - e1_all_gr2_large ( 48,-6)*time * ( -5,36 )    @xmath338    two - stream - cropped - e1_all_gr2_small ( 48,-6)*time * ( -5,36 )    @xmath338    two - stream - cropped - c2_all_gr2_large ( 48,-6)*time * ( -8,21 )    * @xmath0 norm of @xmath14 *    two - stream - cropped - c2_all_gr2_small ( 48,-6)*time * ( -8,21 )    * @xmath0 norm of @xmath14 *    two - stream - cropped - dc2dt_alpha05_nu1_gr2 ( 48,-6 )    * time *    ( -8,20 )    * variation of @xmath339 *    two - stream - cropped - maxfbc_all_gr2 ( 48,-5 )    * time *    ( -5,29 )    * max(@xmath340 ) *    two - stream - cropped - mom_alpha05_nu1_gr2 ( 48,-6)*time * ( -8,0 )    * variation of total momentum *    two - stream - cropped - wtot_alpha05_nu1_gr2 ( 48,-6)*time * ( -8,6 )    * variation of total energy *    two - stream - cropped - mom_alpha05_nu1_all ( 48,-6)*time * ( -8,0 )    * variation of total momentum *    ./two - stream - cropped - wtot_alpha05_nu1_all ( 48,-6)*time * ( -8,6 )    * variation of total energy *    [ cols=\"^,^ \" , ]     ion - acoustic - cropped - e1_gr2_all.pdf ( 48,-4 )    * time *    ( -5,36 )    @xmath338    ion - acoustic - cropped - c2_gr2_all.pdf ( 48,-6 )    * time *    ( -8,24 )    * @xmath0 norm of @xmath14 *    ion - acoustic - cropped - maxfbc_gr2_all.pdf ( 48,-5 )    * time *    ( -5,29 )    * max(@xmath341 ) *    ion - acoustic - cropped - mom_gr2_nu05.pdf ( 48,-6)*time * ( -8,0 )    * variation of total momentum *    ion - acoustic - cropped - wtot_gr2_nu05.pdf ( 48,-6)*time * ( -8,6 )    * variation of total energy *    the authors gratefully acknowledge discussions with c. la cognata and j. nordstrom ( university of linkoping , sweden ) ; and l. chacn and d. moulton ( los alamos national laboratory ) ; d. funaro ( university of modena and reggio emilia , italy ) .",
    "this work was partially funded by the laboratory directed research and development program ( ldrd ) , under the auspices of the national nuclear security administration of the u.s .",
    "department of energy by los alamos national laboratory , operated by los",
    "alamos national security llc under contract de - ac52 - 06na25396 .",
    "the content of this article is also published in the journal paper of reference  @xcite .",
    "10    m.  abramowitz and i.  stegun . .",
    "dover publications , 1965 .",
    "t.  p. armstrong , r.  c. harding , g.  knorr , and d.  montgomery .",
    "solution of vlasov s equation by transform methods . in m.",
    "rotenberg b.  alder , s.  fernbach , editor , _ methods in computational physics . plasma physics _ ,",
    "volume 9:30 . academic press , new york , london , 1970 .    c.  k. birdsall and a.  b. langdon . .",
    "taylor & francis , 2004 .",
    "e.  camporeale , g.  l. delzanno , b.  k. bergen , and j.  d. moulton . on the velocity space discretization for the vlasov - poisson system",
    ": comparison between hermite spectral and particle - in - cell methods .",
    "part 2 : fully - implicit scheme .",
    ", 198:4758 , 2016 .",
    "e.  camporeale , g.  l. delzanno , g.  lapenta , and w.  daughton . new approach for the study of linear vlasov stability of inhomogeneous systems .",
    ", 13:092110 , 2006 .",
    "m.  h. carpenter , d.  gottlieb , and s.  abarbanel .",
    "time - stable boundary conditions for finite - difference schemes solving hyperbolic systems : methodology and application to high - order compact schemes .",
    ", 111(2):220236 , 1994 .",
    "m.  h. carpenter , j.  nordstrm , and d.  gottlieb . a stable and conservative interface treatment of arbitrary spatial accuracy .",
    ", 148(2):341365 , 1999 .    c.  z. cheng and g.  knorr .",
    "the integration of the vlasov equation in configuration space .",
    ", 22(3):330351 , 1976 .",
    "j.  crank and p.  nicolson . a practical method for numerical evaluation of solutions of partial differential equations of the heat - conduction type .",
    ", 43:5067 , 1947 .",
    "l.  .k .",
    "s. daldorff , g.  tth , t.  i. gombosi , g.  lapenta , j.  amaya , s.  markidis , and j.  u. brackbill .",
    "two - way coupling of a global hall magnetohydrodynamics model with a local implicit particle - in - cell model .",
    ", 268:236254 , 2014 .",
    "g.  l. delzanno .",
    "multi - dimensional , fully - implicit , spectral method for the vlasov - maxwell equations with exact conservation laws in discrete form .",
    ", 301:338  356 , 2015 .",
    "f.  engelmann , m.  feix , e.  minardi , and j.  oxenius .",
    "onlinear effects from vlasov s equation .",
    ", 6(2):266275 , 1963 .",
    "f.  filbet , e.  sonnendr \" ucker , and p.  bertrand .",
    "conservative numerical schemes for the vlasov equation . , 172(1):166187 , 2001 .",
    "r.  glassey . .",
    "society for industrial and applied mathematics , 1996 .",
    "r.  j. goldston and p.  h. rutherford . .",
    "plasma physics series .",
    "institute of physics publications , 1995 .",
    "r.  hockney and j.  eastwood . .",
    "taylor & francis , 1988 .    j.  p. holloway .",
    "spectral velocity discretizations for the vlasov - maxwell equations . , 25(1):132 , 1996 .",
    "a.  j. klimas . a numerical method based on the fourier - fourier",
    "transform approach for modeling 1-d electron plasma evolution .",
    ", 50(2):270306 , 1983 .",
    "d.  a. knoll and d.  e. keyes .",
    "jacobian - free newton - krylov methods : a survey of approaches and applications . , 193(2):357397 , 2004 .",
    "kreiss and g.  scherer .",
    "finite element and finite difference methods for hyperbolic partial differential equations . in c.  de boor , editor , _ mathematical aspects of finite elements in partial differential equations _ , pages 202212 . academic press , inc , new york , usa , 1974 .",
    "kreiss and g.  scherer . on the existence of energy estimates for difference approximations for hyperbolic systems .",
    "technical report , department of scientific computing , uppsala university , sweden , 1977 .",
    "n.  f. loureiro , a.  a. schekochihin , and a.  zocco .",
    "fast collisionless reconnection and electron heating in strongly magnetized plasmas .",
    ", 111:025002 , jul 2013 .",
    "g  manzini , gl  delzanno , j  vencels , and s  markidis . a legendre - fourier spectral method with exact conservation laws for the vlasov - poisson system .",
    ", 317:82107 , 2016 .",
    "s.  markidis , p.  henri , j.  lapenta , k.  rnnmark , m.  hamrin , z.  meliani , and e.  laure .",
    "the fluid - kinetic particle - in - cell method for plasma simulations .",
    "271:415429 , 2014 .    k.  mattsson and j.  nordstrm .",
    "summation by parts operators for finite difference approximations of second derivatives .",
    ", 199(2):503540 , september 2004 .",
    "j.  nordstrm , k.  forsberg , c.  adamsson , and p.  eliasson .",
    "finite volume methods , unstructured meshes and strict stability for hyperbolic problems .",
    ", 45(4):453473 , 2003 .",
    "j.  t. parker and p.  j. dellar .",
    "ourier - hermite spectral representation for the vlasov - poisson system in the weakly collisional limit .",
    ", 81:305810203 , 2015 .",
    "r.  sanchez and n.j .",
    "review of neutron transport approximations . , 80:481535 , 1982 .",
    "j.  w. schumer and j.  p. holloway .",
    "vlasov simulations using velocity - scaled hermite representations . , 144(2):626661 , 1998 .",
    "e.  sonnendrcker , j.  roche , p.  bertrand , and a.  ghizzo .",
    "the semi - lagrangian method for the numerical resolution of the vlasov equation .",
    ", 149(2):201220 , 1999 .",
    "y.  sosov . .",
    "phd thesis .",
    "university of toledo , spain , 2006 .",
    "b.  strand .",
    "summation by parts for finite difference approximations for d / dx .",
    ", 110(1):4767 , 1994 .",
    "m.  svrd and j.  nordstrm .",
    "review of summation - by - parts schemes for initial ",
    "boundary - value problems .",
    ", 268:1738 , 2014 .",
    "j.  vencels , g.  l. delzanno , a.  johnson , i.  bo  peng , e.  laure , and s.  markidis .",
    "spectral solver for multi - scale plasma physics simulations with dynamically adaptive number of moments .",
    ", 51:11481157 , 2015 . international conference on computational science , \\{iccs } 2015 computational science at the gates of nature .",
    "j.  vencels , g.  l. delzanno , g.  manzini , s.  markidis , i.  bo  peng , and v.  roytershteyn .",
    ": a hermite - fourier spectral code for multiscale plasma simulations . , 2016 .",
    "( submitted ) .",
    "s.  wollman . existence and uniqueness theory of the vlasov - poisson system with application to the problem with cylindrical symmetry . , 90(1):138170 , 1982 .",
    "consider the set of legendre polynomials @xmath342 that are recursively defined in @xmath41 $ ] by  .",
    "the two following recursion formulas hold :    @xmath343      { v}^2\\phi_{n}({v } )      & =       \\sigma_{n+2}\\sigma_{n+1}\\,\\phi_{n+2 } ( { v } )      + 2\\sigma_{n+1}\\overline{\\sigma}\\,\\phi_{n+1 } ( { v } )      + \\big ( \\sigma_{n+1}^2+\\sigma_{n}^2+\\overline{\\sigma}^2 \\big)\\,\\phi_{n } ( { v } )      \\nonumber\\\\[0.5em]&\\quad       + 2\\sigma_{n}\\overline{\\sigma}\\,\\phi_{n-1 } ( { v } )      + \\sigma_{n}\\sigma_{n-1}\\,\\phi_{n-2 } ( { v } ) ,      \\label{eq : recursion : formula : b }    \\end{aligned}\\ ] ]    where @xmath68 and @xmath69 are defined in  . to prove  ,",
    "note that the left - hand side term and the two right - hand side terms of the recursion formula for @xmath344 can be rewritten as @xmath345     ( n+1 ) l_{n+1}(s )    & = \\frac{n+1}{\\sqrt{2(n+1)+1 } }    \\sqrt{2(n+1)+1}\\,l_{n+1 } ( s({v } ) )    = \\frac{n+1}{\\sqrt{2(n+1)+1}}\\phi_{n+1}({v } )    \\\\[0.5em ]    n l_{n-1}(s )    & = \\frac{n}{\\sqrt{2(n-1)+1 } }    \\sqrt{2(n-1)+1}\\,l_{n-1 } ( s({v } ) )    = \\frac{n}{\\sqrt{2(n-1)+1}}\\,\\phi_{n-1 } ( { v})\\end{aligned}\\ ] ] collecting together and rearranging the three terms yields : @xmath346    + \\frac{{{v}_a}+{{v}_b}}{2}\\,\\phi_{n}({v}),\\end{aligned}\\ ] ] which has the same form as   where @xmath68 and @xmath69 can be readily determined by comparison .",
    "to prove   just consider @xmath347 and apply   twice .",
    "moreover , a straightforward calculation yields @xmath348 and in particular we have that @xmath228 .    integrating @xmath53 , @xmath349 , @xmath350 and using  - give other three useful recurrence formulas :    @xmath351      \\int_{{{v}_a}}^{{{v}_b}}{v}\\phi_{n}({v})\\d{v}&= ( { { v}_b}-{{v}_a})\\big ( \\sigma_{1}\\delta_{n,1 } + \\overline{\\sigma}\\delta_{n,0 } \\big )       \\label{eq : intg : vf}\\\\[0.5em ]      \\int_{{{v}_a}}^{{{v}_b}}{v}^2\\phi_{n}({v})\\d{v}&= ( { { v}_b}-{{v}_a})\\big (      + \\big ( \\sigma_{1}^2+\\overline{\\sigma}^2 \\big)\\,\\delta_{n,0 }      + 2\\sigma_{1}\\overline{\\sigma}\\,\\delta_{n,1 }      + \\sigma_{2}\\sigma_{1}\\,\\delta_{n,2 }      \\big ) .",
    "\\label{eq : intg : v2f }    \\end{aligned}\\ ] ]    all these three relations follows by noting that @xmath352 and applying the orthogonality property  .",
    "relation   is obvious . to derive and we also note that we can remove the terms containing @xmath353 and @xmath354 since @xmath55 .",
    "moreover , we can substitute @xmath138 in the @xmath355-coefficients of @xmath356 , @xmath357 , and @xmath358 , and note that the effect of @xmath357 and @xmath358 is respectively equivalent to @xmath359 and @xmath360 .",
    "finally , we note that @xmath361 .",
    "relation   follows from @xmath362    & = ( { { v}_b}-{{v}_a})\\big ( \\sigma_{n+1}\\delta_{n+1,0 } + \\sigma_{n}\\delta_{n-1,0 } + \\overline{\\sigma}\\delta_{n,0 } \\big).\\end{aligned}\\ ] ] relation   follows from @xmath363 @xmath364    & =     ( { { v}_b}-{{v}_a})\\big ( \\sigma_{n+2}\\sigma_{n+1}\\,\\delta_{n+2,0 }    + 2\\sigma_{n+1}\\overline{\\sigma}\\,\\delta_{n+1,0 }    + \\big ( \\sigma_{n+1}^2+\\sigma_{n}^2+\\overline{\\sigma}^2 \\big)\\,\\delta_{n,0 }    \\\\[0.5em ]    & \\qquad     + 2\\sigma_{n}\\overline{\\sigma}\\,\\delta_{n+1,0}+\\,\\delta_{n-1,0 }    + \\sigma_{n}\\sigma_{n-1}\\,\\delta_{n-2,0 } \\big).\\end{aligned}\\ ] ]",
    "the proof of equation   starts by applying expansion  , legendre orthogonality property  , expansion   and fourier orthogonality property  : @xmath365    & \\qquad= ( { { v}_b}-{{v}_a})\\sum_{m , n=0}^{{n_l}-1}\\int_{0}^{l}{{c}^s}_{m}(x , t){{{c}^s}_{n}}(x , t)\\delta_{m , n}{dx}= ( { { v}_b}-{{v}_a})\\sum_{n=0}^{{n_l}-1}\\int_{0}^{l}{\\left|{{{c}^s}_{n}}(x , t)\\right|}^2{dx}\\\\[0.5em ]    & \\qquad= ( { { v}_b}-{{v}_a})\\sum_{n=0}^{{n_l}-1}\\sum_{k , k'=-{n_f}}^{{n_f}}\\big({{c}^s}_{n , k}(t)\\big)^{\\dagger}{{c}^s}_{n , k'}(t)\\int_{0}^{l}\\psi_{-k}(x)\\psi_{k}(x){dx}\\\\[0.5em ]    & \\qquad= ( { { v}_b}-{{v}_a})l\\,\\sum_{n=0}^{{n_l}-1}\\sum_{k , k'=-{n_f}}^{{n_f}}\\big({{c}^s}_{n , k}(t)\\big)^{\\dagger}{{c}^s}_{n , k'}(t)\\delta_{-k+k',0 }        = ( { { v}_b}-{{v}_a})l\\,\\sum_{n=0}^{{n_l}-1}\\sum_{k=-{n_f}}^{{n_f}}{\\left|{{c}^s}_{n , k}(t)\\right|}^2.\\end{aligned}\\ ] ]",
    "to prove the left - most equality in  , we first note that : @xmath366_k    = l\\sum_{n=0}^{{n_l}-1}\\sum_{k=-{m_k}}^{{m_k}}({{c}^s}_{n , k})^{\\dagger}\\big[{e}{\\star}({\\mathbbm{b}}{\\mathbf{c}^s})_{n}\\big]_k    \\label{eq : lemma : proof:10:a}\\end{aligned}\\ ] ] using the definition of the discrete fourier expansion of the electric field @xmath163 , the legendre coefficients @xmath63 , and @xmath367 , we obtain : @xmath368_k     = l\\sum_{k , k'=-{m_k}}^{{m_k}}({{c}^s}_{n , k})^{\\dagger}{e}_{k'}\\big({\\mathbbm{b}}{\\mathbf{c}^s}\\big)_{n , k - k'}\\nonumber\\\\[0.5em ]    & \\qquad\\qquad= \\sum_{k , k',k''=-{m_k}}^{{m_k}}({{c}^s}_{n , k})^{\\dagger}{e}_{k'}\\big({\\mathbbm{b}}{\\mathbf{c}^s}\\big)_{n , k''}\\,l\\delta_{-k+k'+k'',0}\\nonumber\\\\[0.5em ]    & \\qquad\\qquad= \\int_{0}^{l }    \\left(\\sum_{k=-{m_k}}^{{m_k } } ( { { c}^s}_{n , k})^{\\dagger}\\psi_{-k}(x)\\right )    \\left(\\sum_{k'=-{m_k}}^{{m_k}}{e}_{k'}\\psi_{k'}(x)\\right )    \\left(\\sum_{k''=-{m_k}}^{{m_k}}\\big({\\mathbbm{b}}{\\mathbf{c}^s}\\big)_{n , k''}\\psi_{k''}(x)\\right )    \\,{dx}\\nonumber\\\\[0.5em ]    & \\qquad\\qquad= \\int_{0}^{l}{{c}^s}_{n}(x , t){e}(x , t)\\big({\\mathbbm{b}}{\\mathbf{c}^s}\\big)_{n}.    \\label{eq : lemma : proof:10}\\end{aligned}\\ ] ] then , we note that : @xmath369 }      \\qquad\\qquad\\qquad\\qquad     \\\\[1.75em ]    \\end{array}\\end{aligned}\\ ] ] @xmath370}\\\\[1.5em ]          & \\qquad\\displaystyle=\\frac{1}{{{v}_b}-{{v}_a}}\\sum_{n=0}^{{n_l}-1}\\sum_{i=0}^{n-1}\\sigma_{n , i}{{{c}^s}_{n}}(x , t)\\int_{{{v}_a}}^{{{v}_b}}{f^s}(x,{v},t)\\phi_{i}({v})\\d{v}&\\qquad\\mbox{\\big[use derivative formula~\\eqref{eq : legendre : first : derivative}\\big]}\\\\[1.5em ]          & \\qquad\\displaystyle=\\frac{1}{{{v}_b}-{{v}_a}}\\sum_{n=0}^{{n_l}-1}{{{c}^s}_{n}}(x , t)\\int_{{{v}_a}}^{{{v}_b}}{f^s}(x,{v},t)\\frac{d\\phi_{n}({v})}{d{v}}\\d{v}&\\qquad\\mbox{\\big[use again decomposition~\\eqref{eq : legendre : decomposition}\\big]}\\\\[1.5em ]          & \\qquad\\displaystyle=\\frac{1}{{{v}_b}-{{v}_a}}\\int_{{{v}_a}}^{{{v}_b}}{f^s}(x,{v},t)\\frac{\\partial{f^s}(x,{v},t)}{\\partial{v}}\\d{v}&\\qquad\\mbox{\\big[use the definition of the derivative\\big]}\\\\[1.5em ]          & \\qquad\\displaystyle      = \\frac{1}{2({{v}_b}-{{v}_a})}\\int_{{{v}_a}}^{{{v}_b}}\\frac{\\partial({f^s})^2}{\\partial{v}}\\d{v}= \\displaystyle\\frac{1}{2}{\\delta_v\\big [ ( { f^s})^2 \\big]}_{{{v}_a}}^{{{v}_b } }    \\end{array}\\end{aligned}\\ ] ] using the last relation above in   and tranforming back in fourier space yield : @xmath366_k    & = \\sum_{n=0}^{{n_l}-1}\\int_{0}^{l}{{c}^s}_{n}(x , t){e}(x , t)\\big({\\mathbbm{b}}{\\mathbf{c}^s}\\big)_{n }    = \\frac{1}{2}\\int_{0}^{l}{e}(x , t){\\delta_v\\big [ ( { f^s}(x,{v},t))^2 \\big]}_{{{v}_a}}^{{{v}_b}}\\,{dx}\\nonumber\\\\[0.5em ]    & = \\frac{1}{2}l\\left[{e}{\\star}{\\delta_v\\big [ ( { f^s}(x,{v},t))^2 \\big]}_{{{v}_a}}^{{{v}_b}}\\right]_0 ,    \\label{eq : lemma : proof:15}\\end{aligned}\\ ] ] where @xmath166_{0}$ ] denotes the zero - th fourier mode and which is the first equality in  .    applying again the definition of the discrete fourier transform , the right - most equality in   is proved as follows : @xmath371_{{{v}_a}}^{{{v}_b}}\\big]_k        = l\\sum_{k=-{m_k}}^{{m_k}}\\sum_{n=0}^{{n_l}-1}({{c}^s}_{n , k})^{\\dagger}\\big[{e}{\\star}\\delta_{{v}}\\big[{f^s}\\phi_n\\big]_{{{v}_a}}^{{{v}_b}}\\big]_k    \\nonumber\\\\[0.5em ]    & \\qquad    = l\\sum_{n=0}^{{n_l}-1}\\sum_{k , k'=-{m_k}}^{{m_k}}({{c}^s}_{n , k})^{\\dagger}{e}_{k'}\\big(\\delta_{{v}}\\big[{f^s}\\phi_n\\big]_{{{v}_a}}^{{{v}_b}}\\big)_{k - k ' }    \\nonumber\\\\[0.5em ]    & \\qquad=\\sum_{n=0}^{{n_l}-1}\\sum_{k , k',k''=-{m_k}}^{{m_k}}({{c}^s}_{n , k})^{\\dagger}{e}_{k'}\\big(\\delta_{{v}}\\big[{f^s}\\phi_n\\big]_{{{v}_a}}^{{{v}_b}}\\big)_{k '' }    \\,l\\delta_{-k+k'+k'',0}\\nonumber\\\\[0.5em ]    & \\qquad=\\sum_{n=0}^{{n_l}-1}\\int_{0}^{l }     \\left(\\sum_{k=-{m_k}}^{{m_k}}({{c}^s}_{n , k})^{\\dagger}\\psi_{-k}(x)\\right )    \\left(\\sum_{k'=-{m_k}}^{{m_k}}{e}_{k'}\\psi_{k'}(x)\\right )    \\left(\\sum_{k''=-{m_k}}^{{m_k}}\\big(\\delta_{{v}}\\big[{f^s}\\phi_n\\big]_{{{v}_a}}^{{{v}_b}}\\big)_{k''}\\psi_{k''}(x)\\right )    \\,{dx}\\nonumber\\\\[0.5em ]    & \\qquad    = \\sum_{n=0}^{{n_l}-1}\\int_{0}^{l}{{c}^s}_{n}(x , t){e}(x , t)\\delta_{{v}}\\big[{f^s}(x,{v},t)\\phi_n({v})\\big]_{{{v}_a}}^{{{v}_b}}{dx}\\nonumber\\\\[0.5em ]    & \\qquad    = \\int_{0}^{l}{e}(x , t)\\delta_{{v}}\\big[{f^s}(x,{v},t)\\,\\sum_{n=0}^{{n_l}-1}{{c}^s}_{n}(x , t)\\phi_n({v})\\big]_{{{v}_a}}^{{{v}_b}}{dx}\\nonumber\\\\[0.5em ]    & \\qquad    = \\int_{0}^{l}{e}(x , t)\\delta_{{v}}\\big[{f^s}(x,{v},t)^2\\big]_{{{v}_a}}^{{{v}_b}}{dx}=l\\left[{e}{\\star}\\delta_{{v}}\\big[({f^s})^2\\big]_{{{v}_a}}^{{{v}_b}}\\right]_{0}.    \\label{eq : lemma : proof:20}\\end{aligned}\\ ] ] the three members of   are real numbers since intermediate steps in the previous developments are formed by real quantities ."
  ],
  "abstract_text": [
    "<S> we present the design and implementation of an @xmath0-stable spectral method for the discretization of the vlasov - poisson model of a collisionless plasma in one space and velocity dimension . </S>",
    "<S> the velocity and space dependence of the vlasov equation are resolved through a truncated spectral expansion based on legendre and fourier basis functions , respectively . </S>",
    "<S> the poisson equation , which is coupled to the vlasov equation , is also resolved through a fourier expansion . </S>",
    "<S> the resulting system of ordinary differential equation is discretized by the implicit second - order accurate crank - nicolson time discretization . the non - linear dependence between the vlasov and poisson equations is iteratively solved at any time cycle by a jacobian - free newton - krylov method . </S>",
    "<S> in this work we analyze the structure of the main conservation laws of the resulting legendre - fourier model , e.g. , mass , momentum , and energy , and prove that they are exactly satisfied in the semi - discrete and discrete setting . </S>",
    "<S> the @xmath0-stability of the method is ensured by discretizing the boundary conditions of the distribution function at the boundaries of the velocity domain by a suitable penalty term . </S>",
    "<S> the impact of the penalty term on the conservation properties is investigated theoretically and numerically . </S>",
    "<S> an implementation of the penalty term that does not affect the conservation of mass , momentum and energy , is also proposed and studied . </S>",
    "<S> a collisional term is introduced in the discrete model to control the filamentation effect , but does not affect the conservation properties of the system . </S>",
    "<S> numerical results on a set of standard test problems illustrate the performance of the method .    </S>",
    "<S> vlasov - poisson , legendre - fourier discretization , conservation laws stability </S>"
  ]
}