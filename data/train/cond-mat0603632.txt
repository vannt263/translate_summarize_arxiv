{
  "article_text": [
    "in recent years exact exchange ( exx ) kohn - sham ( ks ) methods for solids became increasingly popular@xcite as alternative to conventional ks procedures based on the local density approximation@xcite ( lda ) or generalised gradient approximations ( ggas).@xcite exx - ks methods treat both the exchange energy as well as the local ks exchange potential , not to be confused with the non - local hartree - fock exchange potential , exactly .",
    "this means they constitute a systematic improvement over lda and gga methods in the sense that only the correlation energy and potential , i.e. , contributions of higher order in the electron - electron interaction , need to be approximated whereas the terms of first order in the square @xmath0 of the electron charge , i.e. , the coulomb and exchange energy and potential , are treated exactly.@xcite because exchange and coulomb potential and energy are treated exactly unphysical self - interactions contained in the coulomb energy and potential are completely cancelled by the exchange energy and potential .",
    "exx methods therefore are free of coulomb self - interactions . as a result exx band structures and in particular band gaps",
    "are strongly improved compared to those from lda or gga methods . indeed for medium gap semiconductors exx methods yield band gaps@xcite which are very close to the experimental ones@xcite despite the fact that the correlation potential needs to be neglected or approximated by conventional lda or gga functionals , and despite the fact that the ks band gap does not account for the derivative discontinuity@xcite of the band gap at integer electron numbers .    a second first - principles approach besides the family of density - functional methods is the hartree - fock ( hf ) method.@xcite recently , there has been an increasing interest in hf methods for solids as basis for higher level approaches like , e.g. , mller - plesset,@xcite coupled cluster@xcite or multireference configuration interaction@xcite methods .",
    "both in the exx and in the hf formalism the exchange energy contains divergent terms.@xcite in the limit of an infinite system , i.e. , the limit of an infinite number of @xmath1 points , the divergencies are integrable . in this limit",
    "the exchange energy is therefore well - defined .",
    "moreover , corresponding divergencies also occur in the matrix elements of the non - local exchange operator which is required in the hf self - consistency process and can be used in the construction of the local ks exchange potential.@xcite also here the divergencies are integrable in the limit of an infinite number of @xmath1 points .",
    "the question arises how to treat these divergencies in practical calculations which necessarily take into account only a finite number of @xmath1 points .",
    "indeed , in order to keep the computational effort as low as possible , it is preferable to keep the number of @xmath1 points as low as possible .",
    "this , however , is possible only if an adequate treatment of the singularities is available .",
    "moreover , such a treatment of the singularities should be computationally efficient and ideally its implementation should not require much programming effort .",
    "gygi and baldereschi @xcite presented such a method for the case of zincblende ( fcc ) structures .",
    "wenzien et al.@xcite further generalised the method to simple cubic , bcc , hexagonal , and orthorhombic structures . for other crystal structures",
    "such simple and straightforward method , to our knowledge , is still lacking and alternative approaches @xcite are more involved . in refs .",
    "[ ] , e.g. , a general treatment of the singularities is presented .",
    "this method , however , is somewhat laborious because it requires a quadrature over reciprocal lattice vectors at each * k * points .",
    "this quadrature formally has to run over an infinite number of reciprocal lattice vectors which in practice needs to be approximated by a finite summation .",
    "thus there is demand for a simple , efficient treatment of the singularities , that is applicable to _ arbitrary _ crystal structures .    in this article",
    "we present a _ simple , efficient , and general _ treatment of the singularities in hartree - fock and exact - exchange kohn - sham methods for periodic systems , which extends the approach of gygi and baldereschi@xcite to systems with arbitrary lattice parameters .",
    "the derivation of this treatment of the singularities is accompanied by an analysis of the singularities and demonstrates the simplicity of the suggested method for handling these singularities . in order to demonstrate the applicability of the approach we present results for the symmetric diamond ( fcc ) structure ( 2 carbon atoms ) as well as for _ trans_-polyacetylene ( 4 carbons and 4 hydrogens in its crystalline unit cell )",
    "polyacetylene has monoclinic symmetry @xmath2 , i.e. , non - orthogonal lattices,@xcite and constitutes a simple example of an organic polymer .",
    "the article is organized as follows . in section [ formexx ] the general treatment of the divergent terms in exx and hf methods",
    "is derived and discussed .",
    "section [ results ] unwraps the results for diamond and _ trans_-polyacetylene .",
    "section [ conclude ] concludes .",
    "we start by considering the expressions for the total electronic energy @xmath3 within the kohn - sham ( ks ) and the hartree - fock ( hf ) schemes . within the ks formalism",
    "the total ground state energy is decomposed into the non - interacting kinetic energy @xmath4 , the coulomb energy @xmath5 , the exchange energy @xmath6 , the correlation energy @xmath7 , and the interaction energy with the external potential , @xmath8:@xcite @xmath9 the non - interacting kinetic energy @xmath4 is evaluated exactly via the ks orbitals .",
    "the contributions @xmath5 and @xmath10 also can be calculated exactly for a given electron density and thus also for the ground state electron density @xmath11 .",
    "the correlation energy @xmath7 in almost all ks schemes is evaluated approximately within the lda@xcite or the gga.@xcite the exchange energy @xmath6 can either be evaluated via the lda or the gga within a conventional ks scheme , or exactly within the exx - ks scheme.@xcite    the hf total energy , on the other hand , is decomposed into @xmath12 within hf schemes all contributions of the energy are usually treated exactly : the kinetic energy @xmath13 and the exchange energy @xmath6 via the hf orbitals , and @xmath5 and @xmath14 via the hf electron density @xmath15 .",
    "the exact - exchange energy @xmath6 per unit cell for a crystalline solid , either for the ks or hf formalisms , is given by : @xmath16 where both summations run through all occupied single - particle wave functions , i.e. , orbitals @xmath17 and @xmath18 for each * k * point in the brillouin zone ( bz ) .",
    "all orbitals are assumed to be normalised with respect to the crystal volume @xmath19 where @xmath20 designates the volume of the unit cell , and @xmath21 denotes the number of * k * points .",
    "we implicitely treat the spin via appropriate prefactors in summations and consider for simplicity non - spin polarised calculations . the coulomb interaction term , @xmath22 in eq .",
    "( [ exsigma ] ) , has to be treated taking into account periodic boundary conditions .",
    "note that , despite the fact that the expression for the exchange energy in terms of one - particle functions is identical in the ks and hf case , the ks and hf exchange energies remain different because their respective one - particle functions are constructed using two different scheme : ks uses a _",
    "exchange operator while hf uses a _",
    "non - local _ exchange operator .    after expressing the _ product _ of one - particle functions as @xmath23 with",
    "@xmath24 one obtains the following expression for the exchange energy per unit cell @xmath25 if the following relation is taken into account @xmath26 which holds due to translational symmetry .",
    "expression ( [ ex1 ] ) contains singular terms , namely those with @xmath27 , @xmath28 , and @xmath29 .",
    "note that when @xmath30 no singularities occur for _ any _ value of @xmath31 and @xmath1 .",
    "this is due to the relation @xmath32 which holds because eq .",
    "( [ ywv ] ) that defines @xmath33 in the case where @xmath27 and @xmath28 just turns into the orthonormality condition for the one - particle functions .",
    "thus , contributions with @xmath27 , @xmath28 , and @xmath34 vanish because the plane wave representations of the products @xmath35 with @xmath34 do not contain contributions from a plane wave with @xmath27 .",
    "[ this means that for @xmath30 no singularities are present in eq .",
    "( [ ex1 ] ) . therefore , stricktly speaking , eq .",
    "( [ ex1 ] ) needs to be modified in a way that for @xmath34 singular terms are no longer present ] .    due to",
    "the presence of the singularities described above the exchange energy is well - defined only in the limit of an infinite number of unit cells , i.e. , for @xmath36 . in this case , the summations over @xmath1 and @xmath37 turn into integrals over the bz and eq .",
    "( [ ex1 ] ) for the exchange energy assumes the form @xmath38 the singularities in integral ( [ ex2 ] ) are integrable .",
    "therefore , the exchange energy is now well - defined .",
    "adopting an idea of gygi and baldereschi@xcite we now manipulate the contributions on the right hand side of eq .",
    "( [ ex2 ] ) with @xmath27 and @xmath29 , i.e. , those contributions which contain the integrable singularities , by adding and subtracting a function @xmath39 which shall obey the three following conditions : ( i ) @xmath39 is periodic within the reciprocal lattice , ( ii ) @xmath39 diverges as @xmath40 for @xmath41 and is smooth elsewhere , and ( iii ) @xmath42 .",
    "this leads to @xmath43   \\nonumber \\\\ & & -\\frac{4\\pi}{n_k\\omega } \\frac{\\omega^2}{(2\\pi)^6 } \\sum_{v } \\int_{bz } \\ ! d\\textbf{k } \\",
    ",   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{k}-\\textbf{q } ) \\nonumber \\\\ & \\approx & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\bigg [ \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } - f(\\textbf{k}-\\textbf{q } ) \\bigg ] \\nonumber \\\\ & & -\\frac{4\\pi}{n_k\\omega } \\frac{\\omega^2}{(2\\pi)^6 } \\sum_{v } \\int_{bz } \\ !",
    "d\\textbf{k } \\",
    ",   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\nonumber \\\\ & = & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } }   \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\",
    ",   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } \\nonumber \\\\ & & + \\frac{4\\pi n_v}{n_k\\omega } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } } f(\\textbf{k}-\\textbf{q } )   \\;-\\ ;   n_v \\frac{4\\pi}{(2\\pi)^3 } \\ ,   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\nonumber \\\\ & = & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } }   \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } + n_v [ \\tilde{f } - f ] , \\label{singularterms2}\\end{aligned}\\ ] ] where @xmath44 \\label{fsum}\\ ] ] and @xmath45 the function @xmath46 in eq .",
    "( [ fsum ] ) is given by @xmath47    in eq .",
    "( [ singularterms2 ] ) @xmath48 designates the number of valence bands , which comes from the summation over the valence bands in the two terms containing the function @xmath49 .",
    "we also used condition ( ii ) for the function @xmath49 and eq .",
    "( [ nully ] ) that require @xmath50 for any given @xmath1 to be a smooth function of @xmath37 that equals zero at @xmath51 . therefore ,",
    "the first integral over @xmath37 and @xmath1 after the first equality sign of eq .",
    "( [ singularterms2 ] ) can be evaluated by summations over the finite grid of @xmath1 points omitting the terms with @xmath51 . due to the periodicity and inversion symmetry of @xmath39 [ condition ( i ) and ( iii ) for @xmath49 ] the integrals of @xmath49(*k*-*q * ) over the bz",
    "can be replaced by bz integrals of @xmath39 .",
    "furthermore , for the case of a uniform grid of @xmath1 points the function @xmath53 of eq .",
    "( [ fsum ] ) simplifies to @xmath54    the evaluation of the exchange energy can now be done according to @xmath55 \\ , .",
    "\\label{ex3}\\end{aligned}\\ ] ] this implies that for the evaluation of the exchange energy the singular terms in the original expression ( [ ex1 ] ) can first simply be omitted and then be taken into account by @xmath56 $ ] , i.e. , by adding @xmath56 $ ] to the exchange energy obtained if the singular terms are simply omitted .",
    "the correction is calculated only once before the self - consistency procedure .",
    "in fact , the correction @xmath56 $ ] depends only on the unit cell lattice vectors , and thus in particular on the unit cell volume @xmath20 , and on the number @xmath21 and the positions of the * k * points .",
    "it does not depend on the number , type , or positions of the atoms within the unit cell , and does not depend on the one - particle wave functions .",
    "this has obvious advantages for atomic relaxations at fixed unit cell volumes and fixed lattices .    the whole scheme ,",
    "of course , hinges on the availability of a suitable function @xmath39 . for fcc systems",
    "such a function was given by gygi and baldereschi.@xcite for sc , bcc , hexagonal , and orthorhombic systems wenzien@xcite presented such functions .",
    "here we suggest the following function @xmath49 for _ arbitrary _ crystal structures : @xmath57 \\cdot [ \\textbf{b}_j        \\sin(\\textbf{a}_j \\cdot \\textbf{q}/2)]\\right .",
    "\\nonumber \\\\         & + & \\left .",
    "2\\sum_{j=1}^{3 } [ \\textbf{b}_j \\sin(\\textbf{a}_j \\cdot \\textbf{q } ) ]   \\cdot [ \\textbf{b}_{j+1 } \\sin(\\textbf{a}_{j+1 } \\cdot \\textbf{q } ) ] \\right\\}^{-1}.    \\label{funcf}\\end{aligned}\\ ] ] the @xmath58 ( with @xmath59 for a compact formulation accounting for cyclic permutations ) are the reciprocal lattice vectors , and the @xmath60 ( with @xmath61 ) are the corresponding lattice vectors spanning the unit cell .",
    "the coefficient @xmath62 arises from the factor @xmath63 contained in the taylor expansion of the trigonometric functions , because @xmath64 implicitely contains @xmath65 if @xmath37 is expressed as @xmath66 , with @xmath67 describing the components of @xmath37 with respect to reciprocal lattice vectors .",
    "the function ( [ funcf ] ) by construction has the required periodicity of the reciprocal unit cell .",
    "expansion into a taylor series with respect to the cartesian components @xmath68 , @xmath69 , and @xmath70 , or equivalently with respect to @xmath71 , @xmath72 , and @xmath73 , the components of @xmath37 referring to the reciprocal lattice , furthermore shows that it diverges as @xmath40 for @xmath41 .",
    "therefore , @xmath39 satisfies requirements ( i)(iii ) for any type of ( linearly independent ) lattice parameters : @xmath74 , @xmath75 , and @xmath76 .    the integration over the bz of the function ( [ funcf ] ) required for obtaining the correction @xmath77 in eq .",
    "( [ finteg ] ) can easily be carried out numerically on an adaptive grid using an iterative algorithm . to this end",
    ", we place the reciprocal lattice centered symmetrically around @xmath78 . in the first iteration",
    "we generate a regular @xmath79-grid with the number @xmath80 being a multiple of 3 , typically @xmath81.@xcite the grid points shall be labeled @xmath82 with @xmath83 , @xmath84 , and @xmath85 , with the point @xmath86 located at the origin of the reciprocal lattice .",
    "we then divide the unit cell into an inner part given by a cell in reciprocal space which again is centered symmetrically around @xmath87 , and which is defined by lattice vectors being one third of the original reciprocal unit cell vectors . in the first iteration numerical integration is carried out only in the outer region .",
    "then in the inner region , where the singularity is located , the number of points is tripled and a second iteration proceeds as the first one , working now on the outer part of the inner region of the first iteration . by moving on in this fashion the algorithm triples the mesh size around the singularity in each iteration step .",
    "therefore , the integration result is more accurate than with any regular mesh . we observe that less than 10 steps , depending on the lattice vectors considered , are sufficient to get the integral converged .",
    "the implementation of the described numerical integration is straightforward leading to about 200 lines of fortran instructions .",
    "the computational time for carrying out the integration is negligible .",
    "having considered in detail the treatment of the singularities in the exchange energy we now briefly present the corresponding treatment of singularities in the evaluation of the matrix elements of the non - local exchange potential , which is required in the hf self - consistency process , or can be used in the construction of the local ks exchange potential@xcite during the self - consistency process of a ks calculation .",
    "the matrix elements of the non - local exchange potential , @xmath88 , are given by @xmath89 with @xmath90 and @xmath91 denoting the basis functions for the representation of the one - particle functions @xmath92 .",
    "the basis functions @xmath90 are products of a periodic part and a bloch factor @xmath93 . the most common choice for the basis functions @xmath90 are plane waves @xmath94 .",
    "like in the treatment of the exchange energy , we now express the products @xmath95 as @xmath96 and obtain @xmath97 expression ( [ vx1 ] ) contains singular terms , again those with @xmath27 and @xmath28 . in the limit of an infinite number of unit cells the summation over @xmath37 again turns into an integral , namely @xmath98 with an integrable singularity .",
    "we can now treat the singular terms in the right hand side of ( [ vx2insulator ] ) exactly analogously to the singular terms occuring in the exchange energy : @xmath99   \\nonumber \\\\ & & - \\ , \\left [ \\sum_{w }   y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\right ] \\,\\frac{4\\pi}{\\omega } \\frac{\\omega}{(2\\pi)^3 }    \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{k}-\\textbf{q } ) \\nonumber \\\\ & \\approx & -\\frac{4\\pi}{\\omega } \\sum_{w } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\bigg [ \\frac{y^{*}_{w\\textbf{q},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{q},\\nu\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } - \\ , y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\",
    ", f(\\textbf{k}-\\textbf{q } ) \\bigg ] \\nonumber \\\\ & & - \\ , \\left [ \\sum_{w } y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\right ] \\,\\frac{4\\pi}{\\omega } \\frac{\\omega}{(2\\pi)^3 }    \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\nonumber \\\\ & = & -\\frac{4\\pi}{\\omega } \\sum_{w }   \\sum_{\\textbf{q } \\ne \\textbf{k } }   \\frac{y^{*}_{w\\textbf{q},\\mu\\textbf{k}}(\\textbf{0 } ) \\",
    ",   y_{w\\textbf{q},\\nu\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } \\ , + \\ , \\left [ \\sum_{w } y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\right ] \\ , [ \\tilde{f}_\\textbf{k } - f ] , \\label{singularterms3}\\end{aligned}\\ ] ] with @xmath100 and @xmath101 .",
    "thus , the matrix elements @xmath102 of the non - local exchange potential can be evaluated by first omitting the singular terms in eq .",
    "( [ vx1 ] ) and by then adding the following correction term @xmath103 \\bigg ( \\tilde{f}_{\\textbf{k } } - f\\bigg ) .",
    "\\label{corrhfinsulator}\\ ] ] the required sums @xmath46 and the integral @xmath77 have to be calculated only _ once _ at the beginning of the self - consistency procedure and then are multiplied by @xmath104 in each hf self - consistency cycle , because the @xmath105 change _ during _ the self - consistency cycle . in case of a uniform grid of @xmath1",
    "points the @xmath46 reduce to @xmath53 given in eq .",
    "( [ uniform ] ) .",
    "the most widely used basis set for the one - particle functions of periodic systems are plane waves .",
    "if basis sets of plane waves are employed then the one - particle functions @xmath106 are given by @xmath107 the elements ( [ vx1 ] ) of the non - local exchange potential turn into @xmath108 and the correction term ( [ corrhfinsulator ] ) turns into @xmath109 \\bigg ( \\tilde{f}_{\\textbf{k } } - f\\bigg ) .",
    "\\label{corrhf2insulator}\\ ] ] again the matrix elements @xmath110 can be calculated by first omitting the singular terms in eq .",
    "( [ vx1insulator ] ) and by then adding the correction term ( [ corrhf2insulator ] ) .",
    "so far we have considered only systems with bands that are either fully occupied or fully unoccupied .",
    ", i.e. we have considered isolating systems at zero temperature . in the appendix we sketch how the formulas of this section change for systems with partially filled bands and how the singularities can be treated in this case .",
    "the applicability of the presented approach for treating the divergencies is now demonstrated by applying it to two cases , diamond and _ trans_-polyacetylene , using different approximations for the exchange - correlation functionals : the slater - dirac ( exchange - only lda ) referred to as dirac exchange in the following , the complete exchange - correlation lda in the parametrisation of vosko , wilk , and nusair ( vwn),@xcite the combination of dirac exchange plus perdew86@xcite ( p86 ) correlation ( p86 being vwn correlation plus a gradient correction ) , the exx ( exact - exchange only ) , and finally the combination of exx with p86 correlation .",
    "the pseudopotentials were generated using the pseudopotential generation code of engel,@xcite which is based on the troullier - martins norm - conserving scheme.@xcite in all cases the pseudopotentials were generated using consistently the same functionals for exchange and correlation as for the plane wave calculations .",
    "relativistic effect are not included .",
    "the pseudopotentials of c are all constructed using a cutoff radius of 1.3 a.u .  for both @xmath111 and @xmath112 levels .",
    "we constructed for the calculations of _ trans_-polyacetylene chains hydrogen pseudopotentials with a cutoff radius of 0.9 a.u .. for diamond , the energy cutoff of the plane - wave basis is 60 ry for the one - particle functions , and 20 ry for the exchange potential and the response function @xcite . for _",
    "trans_-polyacetylene,@xcite we reduced the energy cutoffs to 32 ry for the one - particle functions and 12 ry for the exchange potential and the response function , because we are interested to determine the effect of the singularity function in terms of several possible * k * points meshes , and study meshes with a large number of * k * points .",
    "the lattice constants for diamond were varied from 3.1 to 4.1  . for comparison ,",
    "the experimental lattice constant of diamond is 3.5668.@xcite figure [ fig1 ] shows the variation of the singularity correction of the exx exchange energy as a function of the * k * point mesh for diamond .",
    "[ fig2 ] shows the singularity correction for diamond for a fixed number of * k * points but for different volumes . choosing 5 @xmath113 5 @xmath113 5 *",
    "k * points ensures convergence of the total energy within 0.2 ev , while 8 @xmath113 8 @xmath113 8 * k * points ensure total energy convergence within 0.05 ev . from fig .",
    "[ fig1 ] we notice that the singularity correction @xmath114 and the exchange energy without the singularity correction vary oppositely with increasing number of * k * points .",
    "the complete exchange energy including the singularity correction turns out to be quite stable with the number of * k * points . fig .",
    "[ fig1 ] also shows that for small and medium numbers of * k * points a more symmetric mesh division reduces the deviation of the complete exchange energy from its converged value at high numbers of * k * points ( compare dashed with continuous exx line ) .",
    "figure [ fig2 ] also shows an aspect important for volume optimisations : the singularity correction changes dramatically with the volume and thus strongly modifies the position of the energy minimum as well as the bulk modulus .",
    "the energy minimum is reduced because the correction function is monotonically increasing with the volume .",
    "the bulk modulus is also modified because the variation of the correction is obviously not linear .",
    "the bulk modulus of diamond without the singularity correction is much smaller ( 25% smaller ) than with it .",
    "therefore , accurate integration of the singularity in the exchange energy is essential for evaluating bulk properties within exx or hf methods .",
    "[ fig3 ] shows volume optimisation results for diamond using the various combinations of exchange and correlation functionals .",
    "we observe that a removal of coulomb self - interactions ( see exx versus dirac exchange ) induces a significant reduction of the total energy ( @xmath1152 ev ) .",
    "it also leads to a reduction of the lattice constant minimum [ compare vertical lines in fig .",
    "[ fig3 ] ] .",
    "the values of both exchange - only energy curves , i.e. , of the exx and dirac - slater curves , are much higher than the curves that contain a correlation potential , i.e. , the lda , dirac+p86 , and exx+p86 curves , which reflects that correlation affects the total energy .",
    "the reduction of the total energy from exx to exx - p86 is of the same order as the reduction from dirac - exchange only to the dirac exchange plus p86 correlation .",
    "however , the lattice constant minimum of the exx - p86 is shifted to a much lower value than any other of the combinations of functionals .",
    "the reason for this maybe the reintroduction of self - interations , through the p86 correlation function . in any case , the poor performance of the combination exx - p86 is not surprising because the p86 correlation is not meant to be used with the exx , but rather with the lda or gga exchange in order to exploit error cancelations between exchange and correlation .",
    "therefore , development of correlation functionals that do not depend on such error cancelations and thus are well - suited for combination with the exx is highly desirable .",
    "the exx energy optimised lattice equals 3.555   [ see fig .",
    "[ fig3 ] ] .",
    "it becomes natural now to evaluate the band structure at the exx energy minimum .",
    "figure [ fig4 ] shows the band structure at this exx energy minimum .",
    "the indirect exx bandgap is 4.838  , a value comparable to previous published data,@xcite and much closer to the experimental band gap of 5.50 ev@xcite than the lda value of 3.90 ev.@xcite the experimental lattice constant of diamond@xcite ( 3.5668  ) is slightly larger ( + 0.011  ) than the exx energy optimised lattice .",
    "going from the exx lattice minimum to the experimental value , i.e. , addition of 0.011   to the exx lattice constant , leads to minute reduction of the band gap .",
    "however , we want to emphasize that the singularity correction to the exchange energy is obviously essential for determining the right correspondence between the exx energy lattice minimum [ fig .",
    "[ fig3 ] ] and the band structure or its band gap [ fig .",
    "[ fig4 ] ] .",
    "for instance , without the singularity correction the exx lattice energy minimum would be incorrectly overestimated ( 3.730   instead of 3.555   as illustrated in fig .",
    "[ fig3 ] ) , and the exx band gap correspondingly would be largely underestimated ( because the band gap variation is roughly inversely proportional to the lattice constant ) . in summary",
    ", we find that for diamond the exx band gap is somewhat smaller than in the experiments ( 0.66 ev lower than experiment ) , but exx improves significantly the lda value ( @xmath1151.6 ev lower than experiment ) . as mentioned in the introduction , the exx calculation does not account for the derivative discontinuity@xcite of the band gap at integer electron numbers and , of course , also not for the correlation potential .",
    "we now consider a more general crystal structure : _",
    "the unit cell is constituted of 4 carbons and 4 hydrogens .",
    "more data on the band structure of _ trans_-polyacetylene can be found elsewhere.@xcite _",
    "trans_-polyacetylene constitutes a monoclinic lattice structure ( group @xmath2 ) with the following lattice parameters expressed in cartesian coordinates ( and in  ) : @xmath116 the angle between @xmath74 and @xmath75 is 91.46@xmath117 .",
    "the angle between any two dimerised chains is 55@xmath117 .",
    "the coordinates of the structurally optimised hydrogen atoms come from hartree - fock calculations and the lattice parameters and c  c bond distances and angles come from experimental values.@xcite this structure constitutes a general and realistic case to test our singularity correction for several * k * points meshes . a graph equivalent to fig .  [ fig1 ]",
    "is displayed in fig .",
    "[ fig5 ] for this molecular crystal .",
    "figure [ fig5 ] shows for _ trans_-polyacetylene a similar trend as shown in fig .",
    "[ fig1 ] for diamond .",
    "that is , the singularity correction and the exchange energy excluding the singularity vary in opposite matter , for any chosen * k * points division .",
    "the complete exchange energy is a rather monotonic function of the _ total _ number of * k * points in the unit cell .",
    "the results , both for diamond and _ trans_-polyacetylene , show that the approach presented here to treat the integrable singularities in the ks and hf methods constitutes a stable and general scheme .",
    "we have presented a general scheme for treating the integrable singularities of the exchange energy within the exx or the hf formalisms .",
    "we have shown that the divergent terms in the exchange energy depend only on the number and positions of * k * points and on the unit cell vectors and thus on the unit cell volume , but not on the single particle wave functions or on the particular atomic positions within the unit cell .",
    "a similar correction procedure is proposed for matrix elements of the non - local exchange operator which occurs in the hartree - fock methods and can be used to construct the exact local kohn - sham exchange potential .",
    "we applied the singularity correction to a typical symmetric structure , diamond , and to a more general structure , _",
    "trans_-polyacetylene , and discussed the effect of the singularity function on volume optimisation and * k * points convergence .",
    "the singularity function depends strongly on the total number of * k * points and more weakly on the choice of the specific division of the * k * points mesh . the complete ,",
    "i.e. , singularity corrected exchange energy , converges well with the number of * k * points .",
    "the method proposed here constitutes a stable , simple to implement , and general scheme that can be applied to systems with any lattice parameters within either the exx kohn - sham or the hartree - fock formalism .",
    "this work was supported by the _ alexander von - humboldt stiftung _ ( p.  carrier ) and by the _ deutsche forschungsgemeinschaft _ ( dfg ) .",
    "in this appendix we briefly consider the treatment of singularities for systems with partially filled bands . in this case expression ( [ exsigma ] ) for the exchange energy turns into @xmath118 with the occupation factor @xmath119 .",
    "the occupation factor shall not include the spin multiplicity , i.e. , @xmath120 .",
    "analogously to eq .",
    "( [ ex1 ] ) the exchange energy can be expressed by @xmath121 the singular terms in expression ( [ ex1partial ] ) , namely those with @xmath27 , @xmath28 , and @xmath29 , can be treated in analogy to eq .",
    "( [ singularterms2 ] ) according to @xmath122   \\nonumber \\\\ & & -\\frac{4\\pi}{n_k\\omega } \\frac{\\omega^2}{(2\\pi)^6 } \\sum_{v } \\int_{bz } \\ !",
    "d\\textbf{k } \\ ,   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; \\eta_{v\\textbf{k}}^2 \\ , f(\\textbf{k}-\\textbf{q } ) \\nonumber \\\\ & \\approx & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\bigg [ \\eta_{v\\textbf{q } } \\ , \\eta_{v\\textbf{k } } \\ , \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } - \\eta_{v\\textbf{k}}^2 \\ , f(\\textbf{k}-\\textbf{q } ) \\bigg ] \\nonumber \\\\ & & -\\frac{4\\pi}{n_k\\omega } \\frac{\\omega^2}{(2\\pi)^6 } \\sum_{v } \\int_{bz } \\ !",
    "d\\textbf{k } \\ , \\eta_{v\\textbf{k}}^2 \\ ,   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\nonumber \\\\ & = & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\eta_{v\\textbf{q } } \\ , \\eta_{v\\textbf{k } } \\ , \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } \\nonumber \\\\ & & + \\frac{1}{n_k } \\sum_{\\textbf{k } }   \\sum_{v } \\eta_{v\\textbf{k}}^2 \\ , \\frac{4\\pi } { \\omega } \\sum_{\\textbf{q } \\ne \\textbf{k } } f(\\textbf{k}-\\textbf{q } )   \\;-\\ ; \\left [ \\frac{\\omega}{(2\\pi)^3 n_k } \\sum_{v } \\int_{bz } \\",
    "! d\\textbf{k } \\ , \\eta_{v\\textbf{k}}^2 \\right ] \\left [ \\frac{4\\pi}{(2\\pi)^3 } \\ ,   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\right ] \\nonumber \\\\ & \\approx & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\eta_{v\\textbf{q } } \\ , \\eta_{v\\textbf{k } } \\ , \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } \\nonumber \\\\ & & + \\frac{1}{n_k }   \\sum_{v } \\sum_{\\textbf{k } } \\eta_{v\\textbf{k}}^2 \\ ,   \\tilde{f}_{\\textbf{k } } \\;-\\ ; \\left [ \\frac{1}{n_k } \\sum_{v } \\sum_{\\textbf{k } } \\ , \\eta_{v\\textbf{k}}^2 \\right ] \\left [ \\frac{4\\pi}{(2\\pi)^3 } \\ ,   \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\right ] \\nonumber \\\\ & = & -\\frac{4\\pi}{n_k\\omega } \\sum_{v } \\sum_{\\textbf{k } } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\eta_{v\\textbf{q } } \\ , \\eta_{v\\textbf{k } } \\ , \\frac{y^{*}_{v\\textbf{q},v\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{v\\textbf{q},v\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } \\nonumber \\\\ & & + \\frac{1}{n_k } \\sum_{v } \\sum_{\\textbf{k } }   \\eta_{v\\textbf{k}}^2 \\ ,   \\tilde{f}_{\\textbf{k } } \\;-\\ ; \\left [ \\frac{1}{n_k } \\sum_{v } \\sum_{\\textbf{k } } \\ , \\eta_{v\\textbf{k}}^2 \\right ] f , \\label{singularterms2partial}\\end{aligned}\\ ] ] with @xmath123 and @xmath124 . in eq .",
    "( [ singularterms2partial ] ) we have used that the integral @xmath125 does not contain any singularities and therefore can be evaluated via summation over the @xmath1 points .",
    "the energy again can be evaluated by first omitting the singular terms in eq .",
    "( [ ex1partial ] ) and by then adding the correction term @xmath126 f. \\label{correctionpartial}\\end{aligned}\\ ] ] for the particular case of a uniform grid of @xmath1 points the functions @xmath46 all equal the function @xmath53 of eq.([finteg ] ) and the correction term turns into @xmath127 [ \\tilde{f } - f ] \\ , .",
    "\\label{correction partial1}\\end{aligned}\\ ] ]    in a similar way as the treatment of the singularities in the exchange energy was generalized for the case of partially occupied bands also the treatment of the singularities in the exchange potential can be generalized to the case of partially occupied bands .",
    "the matrix elements of the non - local exchange potential , @xmath88 , then are given by @xmath128 expression ( [ vx1partial ] ) contains singular terms , i.e. , those with @xmath27 and @xmath28 . in the limit of an infinite number of unit cells the summation over @xmath37 again turns into an integral , namely @xmath129 with an integrable singularity .",
    "we can now treat the singular terms in the right hand side of ( [ vx2 ] ) exactly analogously to the singular terms occuring in the exchange energy : @xmath130   \\nonumber \\\\ & & - \\ , \\left [ \\sum_{w }   \\eta_{w\\textbf{k } } \\ , y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\right ] \\,\\frac{4\\pi}{\\omega } \\frac{\\omega}{(2\\pi)^3 }    \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{k}-\\textbf{q } ) \\nonumber \\\\ & \\approx & -\\frac{4\\pi}{\\omega } \\sum_{w } \\sum_{\\textbf{q } \\ne \\textbf{k } } \\bigg [ \\eta_{w\\textbf{q } } \\ , \\frac{y^{*}_{w\\textbf{q},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{q},\\nu\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } - \\ , \\eta_{w\\textbf{k } } \\ , y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\ , f(\\textbf{k}-\\textbf{q } ) \\bigg ] \\nonumber \\\\ & & - \\ , \\left [ \\sum_{w } \\eta_{w\\textbf{k } } \\ , y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\right ] \\,\\frac{4\\pi}{\\omega } \\frac{\\omega}{(2\\pi)^3 }    \\int_{bz } \\ !",
    "d\\textbf{q } \\ ; f(\\textbf{q } ) \\nonumber \\\\ & = & -\\frac{4\\pi}{\\omega } \\sum_{w }   \\sum_{\\textbf{q } \\ne \\textbf{k } }   \\eta_{w\\textbf{q } } \\ , \\frac{y^{*}_{w\\textbf{q},\\mu\\textbf{k}}(\\textbf{0 } ) \\",
    ",   y_{w\\textbf{q},\\nu\\textbf{k}}(\\textbf{0})}{|\\textbf{k}-\\textbf{q}|^2 } \\ , + \\ , \\left [ \\sum_{w } \\eta_{w\\textbf{k } } \\ , y^{*}_{w\\textbf{k},\\mu\\textbf{k}}(\\textbf{0 } ) \\ ,   y_{w\\textbf{k},\\nu\\textbf{k}}(\\textbf{0 } ) \\right ] \\ , [ \\tilde{f}_\\textbf{k } - f ] . \\label{singularterms3partial}\\end{aligned}\\ ] ]    thus , the matrix elements @xmath102 of the non - local exchange potential can be evaluated by first omitting the singular terms in eq .",
    "( [ vx1partial ] ) and by then adding the following correction term @xmath131 \\bigg ( \\tilde{f}_{\\textbf{k } } - f\\bigg ) .",
    "\\label{corrhf}\\ ] ] the required sums @xmath46 and the integral @xmath77 have to be calculated only _ once _ at the beginning of the self - consistency procedure and then multiplied by @xmath132 in each hf self - consistency cycle , because the @xmath105 and the occupation numbers @xmath133 change _ during _ the self - consistency cycle . in case of a uniform grid of @xmath1",
    "points the @xmath46 reduce to @xmath53 given in eq .",
    "( [ uniform ] ) , as for fully occupied bands ( since the singularity function @xmath49(*q * ) does not depend on the occupation numbers @xmath133 ) .",
    "if basis sets of plane waves are employed then the elements ( [ vx1partial ] ) of the non - local exchange potential turn into @xmath134 and the correction term ( [ corrhf ] ) turns into @xmath135 \\bigg ( \\tilde{f}_{\\textbf{k } } - f\\bigg ) .",
    "\\label{corrhf2}\\ ] ] again the matrix elements @xmath110 can be calculated by first omitting the singular terms in eq .",
    "( [ vx1 ] ) and by then adding the correction term ( [ corrhf2 ] ) .",
    ", leads to a significant shift of the energy - volume minimum for exx , corresponding to a reduction of the lattice constant of -0.175  .",
    "( compare curves with stars and open - diamonds ) . for",
    "a discussion of correlation effects with exx+p86 and dirac+p86 , see text .",
    "the experimental lattice constant of diamond is 3.5668   ( volume = 11.3443 @xmath136 ) .",
    ", width=548 ]    ] .",
    "the band gap of diamond is indirect , towards the @xmath137@xmath138 direction of the bz .",
    "the exx direct transition at @xmath137 equals 6.253 ev .",
    "the exx band gap equals 4.738 ev and is located at 72% of the @xmath138 point away from @xmath137 .",
    "the experimental lattice constant and band gap of diamond are respectively 3.5668   and 5.50 ev.@xcite , width=548 ]     for symbols description .",
    "the number of * k * points along axes of the reciprocal lattice are indicated by the numbers in parenthesis .",
    "the second entry refers to the number of * k * points along the _ trans_-polyacetylene chain . ,"
  ],
  "abstract_text": [
    "<S> we present a general scheme for treating the integrable singular terms within exact exchange ( exx ) kohn - sham or hartree - fock ( hf ) methods for periodic solids . </S>",
    "<S> we show that the singularity corrections for treating these divergencies depend only on the total number and the positions of * k * points and on the lattice vectors , in particular the unit cell volume , but not on the particular positions of atoms within the unit cell . </S>",
    "<S> the method proposed here to treat the singularities constitutes a stable , simple to implement , and general scheme that can be applied to systems with arbitrary lattice parameters within either the exx kohn - sham or the hf formalism . </S>",
    "<S> we apply the singularity correction to a typical symmetric structure , diamond , and to a more general structure , _ </S>",
    "<S> trans_-polyacetylene . </S>",
    "<S> we consider the effect of the singularity corrections on volume optimisations and * k * point convergence . </S>",
    "<S> while the singularity corrections clearly depends on the total number of * k * points , it exhibits a remarkably small dependence upon the choice of the specific arrangement of the * k * points . </S>"
  ]
}