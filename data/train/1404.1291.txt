{
  "article_text": [
    "progress in material science , nanofabrication and related technologies expands the range of physical systems in which scattering by surface and interface roughness is the dominant scattering channel .",
    "such systems are studied by different theoretical , experimental , and computational techniques , all of which , in principle , should use a more or less common language and converge to identical results .",
    "below we try to answer the question how to bridge the gap between these techniques .",
    "our applied goal is to find ways to prepare a random rough surface with desirable physical properties .",
    "we are interested in surfaces with slight random roughness for which the observables are quadratic in roughness .",
    "theoretical expressions for the physical observables , such as , for example , transport coefficients , should explicitly contain the geometrical and statistical parameters of surface roughness .",
    "these parameters are routinely introduced ( see , _",
    "e.g. , _ ref . @xcite and references therein ) by the binary roughness ( auto-)correlation function @xmath0 which is usually characterized by an average amplitude of inhomogeneities @xmath1 and a single correlation radius of inhomogeneities @xmath2 , @xmath3an equivalent description uses the roughness structure function , @xmath4 .",
    "a brief review of alternative approaches to roughness can be found in ref .",
    "bernasek1 . for applications ,",
    "the fourier image of the correlation function @xmath5 ( the so - called power spectrum of surface roughness),@xmath6is often more important than the correlation function itself ( here @xmath7 is an appropriate conjugate for @xmath8 in there could be an extra coefficient @xmath9 , in - just @xmath10 )",
    ". the use of multiparameter descriptors instead of eqs .",
    "@xmath11 could provide additional fitting parameters , but usually does not clarify the physics .",
    "the form of the roughness correlation function for real surfaces can not be predicted theoretically except for a few exactly solvable models of surface interaction which may or may not correspond to reality .",
    "even the simplest models rarely lead to simple explicit expressions for the correlation functions .",
    "one can also try to establish classes of universality for roughening and to find the roughening or fractal exponents ( for recent examples see refs .",
    "@xcite and references therein ) . in theoretical calculations the correlation function",
    "is usually assumed to be known leaving its determination to experiment or numerical modeling .",
    "these sources are often inconclusive and the theoretical evaluation of observables is performed using some correlation function .",
    "the variety of gaussian , exponential , or power law correlators are used almost at will despite the evidence that the choice of the correlation functions with similar correlation parameters but of different functional forms can lead to very different physical results ( see , _",
    "e.g. , _ refs .",
    "all this degrades the application of theoretical results to real surfaces .",
    "thus the questions are whether it is possible to extract an accurate correlation function from experiment and whether it is possible to create a random rough surface with a predetermined roughness correlation function .",
    "we will start from the former question and later give a physical example for which the latter question is indeed crucial .",
    "there are two types of experiments which can provide information on the surface correlation function : scattering of particles or waves by the rough surface and direct measurements of the surface profile .",
    "the intensity of waves scattered from a rough surface is directly described by the power spectrum of the correlation function @xmath12 @xcite , but the accuracy of measurements is high only in limited ranges of wave vectors and angles .",
    "the second type of experiment seems more promising since one can easily extract the correlation function @xmath13 from precise scanning measurements of the surface profiles , such as , for example , stm or afm .",
    "the difficulty here lies in proper identification of the raw data on @xmath14 .",
    "this extracted discrete correlation function @xmath13 inevitably exhibits noticeable noise , especially if the scanned area is not very large , and can not be unambiguously identified with some simple functional form of @xmath15 , eq .",
    "there are two ways of dealing with these difficulties : either compare the extracted correlator @xmath13 with some preconceived fitting function @xmath16 and get the correlation parameters from the best fit or feed the the extracted raw correlation function @xmath14 directly into the theoretical equations for observables .",
    "below we analyze the limitations of both approaches .    the experimental difficulties of extracting an accurate surface correlator multiply when one deals with an atomic - scale roughness , even if one disregards the issue of the accuracy of the data on the surface profile related , for example , to the tip profile @xcite or the step size munoz4 .",
    "some requirements on accuracy of profile measurements for reliable extraction of the correlation parameters are discussed in refs .",
    "it is not even clear to what extent the theoretical methods using the correlation function of surface roughness can be applied to random inhomogeneities on atomically - smooth crystal surfaces .",
    "the potential shortcomings of the first approach are obvious : the correlation parameters which are extracted from @xmath13 in this way , depend on an choice of the fitting function .",
    "fitting of the stm data on @xmath17 to correlation functions @xmath18 of different functional forms could yield vastly different values of the correlation parameters such as the correlation radii @xmath2 ( for recent experimental examples see , e.g. , refs .",
    "@xcite ) . this can become a real problem when the step size in scanning microscopy is comparable to the correlation radius of roughness : according to the estimates @xcite , to resolve the shape of the correlation peak one needs about ten points within the peak .",
    "as we will see , even the increase in the sample size does not necessarily help . in the end , using a preconceived correlation function is especially dangerous in two limiting cases when the correlation radius @xmath2 is comparable to the scanning step or when @xmath2 and , therefore , the size of inhomogeneities , is large .",
    "however , as we will see below , the use of the raw experimental data on @xmath19 can often be more dangerous than the risk of using the wrong fitting function .    but how can one evaluate the reliability of identifying the correlation function extracted from precise scanning measurements of the surface profile ? as we will see , the statistical quality of a fit to some fitting function is not the answer .",
    "the main issue is that we can not fabricate a surface with a known correlation function to serve as a reference to check against the extracted correlator .",
    "what we can do instead is to computationally generate a surface with a given correlation function , scan this surface , and analyze the extracted correlators .",
    "the knowledge of the exact correlation function will allow us to judge the quality of identification not by statistical properties of the fits , but by how well the physical observables are reproduced .",
    "the identification issues for real and computationally generated surfaces are more or less the same @xcite and our results should provide a roadmap for dealing with experimental data .",
    "this will also allow us to accomplish our second applied goal : to design a random surface with desirable correlation properties which in the case of a reasonable physical scale can be reproduced experimentally ( see below ) .",
    "we start ( section ii ) from two computational procedures for generating random rough surfaces with known correlation functions .",
    "the first procedure produces a random rough surface with any predetermined correlation function and is suitable for larger scale roughness .",
    "the second one relies on model hamiltonians .",
    "it provides surfaces with discretized profiles , more appropriate for atomic - scale roughness , but with a limited number of correlators . which of the procedures is preferable depends on the physical circumstances .    in section",
    "iii we briefly describe physical applications which we use to test the results . for clarity , we chose the applications for which the roughness contribution to the observables collapses into a single constant .",
    "this ensures effective and unambiguous evaluation of the quality of the data and our methods .",
    "the first of these applications , namely , quantized ultracold neutrons in rough waveguides , is essentially a one dimensional ( ) application with a large spatial scale of roughness ( the typical scale is 6 @xmath20 ) .",
    "here we also have a practical goal : designing the best rough waveguide for experiments in granit installation ( ill , grenoble ) by optimizing the waveguide roughness .",
    "transferring the generated profile onto the real mirror seems to be technically feasible because of a large spatial scale of roughness and is by far preferable to the current procedure of introducing the uncontrolled roughness ( random scratching of the mirror ) .",
    "our second application is more traditional and deals with the conductivity of two dimensional ( ) ultrathin films in quantum size effect ( qse ) conditions and , more generally , with scattering of longwave particles and waves by rough surfaces .    in section",
    "iv we analyze random surface profiles generated using the methods of section ii .",
    "we extract the correlation functions from these profiles and try to identify them by fitting to different types of the fitting functions using the same procedures used in analyzing the results of the scanning microscopy measurements with a fixed step .",
    "the results of the fits are then used to calculate the observables for the applications from section iii .",
    "the purpose here is to find out what kind or errors are introduced by assumptions about the shapes of the fitting functions when analyzing experimental and numerical data on surface profiles .",
    "since in this case we know the `` true '' correlation functions , we have an excellent criterion to compare the errors .",
    "we will see that the quality of the fit , which is described by the standard deviation @xmath21 between @xmath22 and the fitting function @xmath16 does not translate into the quality of the physical results unless the fitting function @xmath23 has the right functional form which is , unfortunately , unknown in most experiments with real surfaces .",
    "in many cases the physical results turn out even worse if one tries to input the raw experimental data on @xmath13  directly into the calculations instead of risking to make a wrong guess about the functional form of the fitting function @xmath24 .",
    "the results are summarized in section v.",
    "in this section we briefly describe two numerical methods for generating random rough surfaces with predetermined correlation functions .",
    "a short review of alternative approaches is given , for example , in ref .",
    "tribology1 . some of the earlier work in this direction can be found in refs .",
    "@xcite .      in this subsection",
    "we generate random surfaces with an arbitrary predetermined correlation function of surface roughness without paying attention to discretization of the amplitudes on atomic scale .",
    "in this sense , we will be generating macroscopic or `` classical '' roughness with the only constraint that the profiles are described by the smooth functions .",
    "this is appropriate for rather thick films or waveguides and for particles / waves with relatively large wavelengths .",
    "a random rough profile @xmath25 can be generated numerically using some distribution function @xmath26 .",
    "the usual choice is the gaussian distribution,@xmath27 ( see ref . @xcite and references therein ) .",
    "the simple distribution @xmath28 of the type @xmath29 leads to an uncorrelated roughness , @xmath30 ( white noise ) . to produce meaningful desirable binary correlations",
    "@xmath31 , @xmath32 one requires a more complicated distribution @xmath33 $ ] than the straightforward distribution @xmath29 which is embedded in the generators of random numbers .",
    "the first step is discretizing the surface into a large number segments , @xmath34 and , if necessary , smoothing the resulting profile after the computations are done . one way to proceed",
    "is to generate the surface with a generalized gaussian probability distribution , @xmath35 = c\\exp\\left ( -\\frac{1}{2}\\overrightarrow { y% } \\cdot\\widehat{g}\\overrightarrow{y}\\right ) , \\,\\overrightarrow{y}=\\left ( y_{1},y_{2}, ...",
    ",y_{n}\\right ) ,   \\label{g3}\\ ] ] with some matrix @xmath36 .",
    "the choice of @xmath36 in @xmath37 should provide the desired binary correlation function of surface roughness @xmath38 d\\overrightarrow{y}.   \\label{g4}\\ ] ] here @xmath39 is the normalization constant defined by the equation@xmath40    if one rotates the vector @xmath41,@xmath42 in such a way as to diagonalize the quadratic form @xmath43,@xmath44 the probability distribution @xmath45 ( including the jacobian ) becomes@xmath35 d\\overrightarrow{y}\\rightarrow p\\left [   \\overrightarrow{g}\\right ] d\\overrightarrow{g}=\\frac{1}{\\left ( 2\\pi\\right ) ^{n/2}}\\exp\\left ( -\\frac{1}{2}\\sum_{i=1}^{n}g_{i}^{2}\\right ) d% \\overrightarrow{g }   \\label{g9}\\ ] ] meaning that all @xmath46 are statistically independent,@xmath47 d\\overrightarrow{g}=\\delta_{ik}\\text{. } \\label{g10}\\ ] ] the coefficient in eq .",
    "@xmath48 , together with the transformation jacobian , gives the normalization coefficient @xmath39 in eqs . @xmath49 .",
    "then the roughness correlation function @xmath50 acquires the form@xmath51 d% \\overrightarrow{y}=\\int a_{il}g_{l}a_{km}g_{m}p\\left [ \\overrightarrow { g}% \\right ] d\\overrightarrow{g }   \\label{g11 } \\\\ & = a_{il}a_{km}\\delta_{lm}=\\left ( g^{-1}\\right ) _",
    "{ ik}.   \\notag\\end{aligned}\\ ] ] ( the last equation is based on eq .",
    "@xmath52 ) . therefore",
    ", numerically the problem requires inverting the `` desirable '' matrix @xmath53 , @xmath54 , and computing the rotation matrix @xmath55 . for real symmetric matrices , the rotation matrix @xmath56 , according to eq .",
    "@xmath57 , is@xmath58    summarizing , generating a random rough surface with a desirable correlation function of surface roughness @xmath59 @xmath60 reduces to generating a set of random uncorrelated numbers @xmath61 for a simple gaussian distribution @xmath62 and rotating this vector using the rotation operator @xmath55 @xmath63 .",
    "computationally , this is a straightforward task .",
    "the only limitations on the surface size , as measured in terms of step sizes @xmath64 , are computational resources required to perform the operation @xmath63 for large matrices @xmath65 . obviously , this limitation is much more important for two dimensional ( @xmath66 ) surfaces than for one dimensional ( @xmath67 ) ones : in addition to a size explosion in the @xmath68 case , the matrices for the @xmath68 surfaces loose their almost diagonal structure even for very steep correlation functions .",
    "the above procedure is straightforward in @xmath67 . expanding it to @xmath66 surfaces",
    "can be done in one of two ways . in principle",
    ", one can modify the procedure by designating the raw and rotated profiles @xmath69 and @xmath70 not as vectors but as @xmath68 arrays and considering the rotation operator as a 4-component tensor .",
    "we preferred instead to make a flat file out of the @xmath68 surface profile and redefine the surface correlator using this flat file .",
    "after the rotation , the points of the newly created flat file were projected back onto the surface grid .",
    "there is a certain ambiguity in the computation of the averages @xmath71 in samples of finite size ( finite @xmath72 ) . in a @xmath67 case",
    ", one can not extend evaluation of @xmath73 beyond @xmath74 without loosing accuracy even if one introduces a periodic boundary condition .",
    "the same is true when extracting the correlation function @xmath75 from the scanning microscopy data on the surface profile .    in a @xmath76 system",
    "the loss of data points is worse .",
    "if the sample is large enough , one can limit oneself to using @xmath77 ( one quadrant of the surface ) for a straightforward calculation of the correlator up to the distances @xmath78 . if the sample size @xmath79 is an issue , which is usually the case since the required processing power is determined by @xmath72 and not @xmath80",
    ", one can extend the computation to approximately @xmath81 points but should take special care to avoid double - counting of the correlations .",
    "this technique allowed us to generate a rough surface with an arbitrary correlation function of roughness . in numerical examples below we reproduce three most popular types of the correlators , namely , the gaussian,@xmath82 exponential,@xmath83 and power law@xmath84 correlation functions .",
    "the same correlation functions will be used as fitting functions when probing the surfaces .",
    "all numerical parameters , extracted with the help of these correlators , will carry the same indices @xmath85 and @xmath86 . note that our particular power law correlator @xmath87 has an exponential power spectrum and    each physical system has its own spatial scale @xmath88 .",
    "these scales for different systems can differ from each other by orders of magnitude .",
    "it is convenient to measure length parameters of each correlator in units of its own physically meaningful scale @xmath88 leaving the definition of @xmath88 to the underlying physical systems .",
    "we have three length parameters : the average amplitude of surface roughness @xmath89 the correlation radius of roughness @xmath90 , and the step ( grid ) size @xmath91 , eq .",
    "@xmath92 since the square of the amplitude of surface inhomogeneities @xmath93 enters most of the physical results as a simple scaling parameter , in all illustrations we assume , unless mentioned otherwise , that @xmath94 and assign other values to @xmath95 only when the physical situation requires this .",
    "therefore , in graphical illustrations below the amplitude of profile inhomogeneities can be arbitrarily compressed resulting in smoother profiles and correlation functions .",
    "the values of @xmath96 and @xmath97 are not necessarily independent : for example , one can generate the correlation functions with various values of @xmath98 either by calculating the rotation matrix @xmath99 directly or calculating @xmath100 and then compressing or stretching the generated surface so that get the desired value of @xmath97 . in some situations",
    "@xmath96 is an independent physical parameter .",
    "the most obvious example is the step size in the stm - like measurements .",
    "the accuracy with which the generated surface reproduces the desirable correlator @xmath101 improves with the increase in the number of points @xmath72 .",
    "the limit of accessible values of @xmath72 depends on our ability to compute and use the @xmath102 matrix @xmath55 , eq .",
    "@xmath63 ( in our examples going to @xmath72 above five thousand was not practical with easily available resources ) .",
    "even with a fixed large number of points @xmath103 the standard deviation @xmath104 between the desirable and generated correlators is not always the right way to look at the quality of the generated rough surfaces . in general , the correlation function consists of two parts : a peak area of the size @xmath97 , which describes the short - range correlations , and a long tail of long - range correlations . under the usual circumstances ,",
    "the correlation function is expected to go to zero at large distances .",
    "however , the correlation functions for finite size samples inevitably contain long fluctuation - driven tails .",
    "the same is true for experiments on restricted scanning areas . as a result",
    ", @xmath104 is determined mostly by these tails of the correlation functions and is not very sensitive to the shape of the peak area . paradoxically , the larger the size of the sample the less sensitive can @xmath105 be to the shape of the short - range peak and the rate of decrease of the `` real '' correlation function .",
    "we will encounter this issue throughout the paper .    on the other hand ,",
    "the contributions from the peak and tail areas to physical observables for different physical applications enter with different weights : while some of the observables are more sensitive to the short - range correlations from the peak area , the others require more information and , therefore , better accuracy , in the tails . when the peak area is more important",
    ", one should have more points inside the peak .",
    "the number of such points is given by the ratio of the correlation radius @xmath97 to the step size @xmath96 , @xmath106 .",
    "however , a large increase in the number of such points leads to proportional decrease in the number of surface inhomogeneities @xmath107 ( `` clusters '' or `` domains '' ) which one can fit on the generated surface with the fixed overall number of points @xmath72 .",
    "this , in turn , suppresses accuracy of the generated correlation tails and increases the value of the overall @xmath21 which is weighted more heavily towards the tails of the correlation functions .",
    "this effect was obvious when we looked at @xmath21  as a function of @xmath106 .",
    "as a result , the computer generation of rough surfaces with large correlation radii @xmath97 requires a dramatic increase in the overall number of points which is difficult to achieve .",
    "this also means that reliable computer simulations of theoretically predicted physical effects at very large @xmath97 are not feasible .",
    "for example , we are currently not able to reproduce computationally a new type of quantum size effect in conductivity of ultrathin films , predicted in ref .",
    "@xcite , by generating a thin film with rough surface with very large @xmath97 .",
    "we will encounter this issue later on in a slightly different context .    in figure",
    "@xmath108 we present the initial part of the correlation function ( black solid line ) for the generated @xmath67 surface profile which should emulate a surface with the gaussian correlation of inhomogeneities @xmath109 ( dashed blue line ) .",
    "the total number of points is @xmath110 , the average amplitude of roughness @xmath111 , the correlation radius @xmath112 the long oscillating tail in the correlation function reflects fluctuations .",
    "[ myfigure ]    for comparison , in figure @xmath113 we plotted together correlation functions which should reproduce the gaussian @xmath114 ( curve 1 ; black ) , exponential @xmath115 ( curve 2 ; red ) , and power law @xmath116 ( curve 3 ; blue ) correlation functions with @xmath110 , @xmath117 and @xmath112 in all three cases the generation started from the same set of random numbers @xmath118 .",
    "it is clear that in the peak area ( figure @xmath119 ) the correlations are different , but in the tail area ( figure @xmath120 : the same functions @xmath121 as in figure @xmath119 extended to @xmath122 ) all three curves look the same . as a result ,",
    "the quality of reproducing the desired correlation function is the same if measured by @xmath21 which is heavily weighted towards the fluctuation - driven tail area .",
    "as expected , the value of the standard deviation @xmath21 between generated and exact correlation functions decreases with increasing surface size @xmath72 as @xmath123 ( figure 3 ) .",
    "generation of @xmath68 roughness by this method requires more computational resources .",
    "we were not able to routinely proceed for surfaces @xmath124 with size @xmath80 well above @xmath125 when the size of the rotation matrix @xmath55 exceeds @xmath126 ; computations beyond that required special efforts .",
    "an example of a correlation function for a generated @xmath68 rough surface is given in figures 4 .",
    "the roughness correlations were supposed to emulate isotropic gaussian correlations with @xmath127 , @xmath128 .",
    "figure 4@xmath129 shows the @xmath68 correlation function @xmath130  for this surface .",
    "the anisotropy of the extracted correlation function is well pronounced .",
    "similar anisotropy of the extracted correlator is quite pronounced in stm experiments as well ( see , for example , ref .",
    "@xcite ) . after averaging over the angles ,",
    "this correlation function becomes @xmath121 in figure 4@xmath96 ( blue curve ; the black curve gives the emulated gaussian correlator @xmath131 ) .",
    "the standard deviation between the two curves in figure 4@xmath96 is surprisingly small , @xmath132 , though visually the generated correlation function @xmath133 looks very volatile while the function @xmath130 is smooth .",
    "the reason for this volatility is quite obvious : the nearby points in @xmath133 correspond very different orientations in @xmath134 with increasing sample size @xmath80 the volatility actually increases because the density of data points in @xmath133 , each of which represent different directions , goes up at large @xmath97 .",
    "the volatility becomes so strong that the flattened correlation function becomes unstable and practically useless for data analysis and one should deal with the anisotropic @xmath135 directly ( see section iv ) .",
    "another difficulty , which , though common to both @xmath67 and @xmath136 surfaces , is exacerbated in the @xmath68 case , concerns surfaces with long range correlations of inhomogeneities ( large @xmath97 ) .",
    "the large value of @xmath97 means that the surface is covered by large size inhomogeneities ( domains ) . the larger the value of @xmath97 , the smaller the number of inhomogeneities for the samples of the same linear size @xmath80 .",
    "the correlations of particles within each inhomogeneity are responsible for the central peak of the radius @xmath97  in the correlation function @xmath137 . however , there are noticeable non - zero correlations between the particles from different inhomogeneities which are due not to some aligning physical forces , but simply to geometrical factors arising from the large size of inhomogeneities .",
    "these non - zero interdomain correlations manifest themselves as smaller secondary peaks of the radius @xmath97 at positions that correspond to the integer numbers of average distances between the domains .",
    "if the sample is large enough to contain a very large number of such domains , these secondary peaks are washed out .",
    "the washing out of these peaks is determined not by the total number of data points in the sample @xmath72 , which is proportional to @xmath80 or @xmath138 depending on dimensionality , but by the ratio @xmath139 where @xmath140 is the number of particles in a typical domain .",
    "if the number @xmath72 is not very big or the inhomogeneity clusters @xmath141 are large , these secondary peaks survive and @xmath142looks as if the system has an additional , larger correlation radius @xmath143 . the situation is worse in the case in which the number of particles in a domain @xmath140 grows with @xmath97 as @xmath144 .",
    "if one plots the set of correlators for the generated surface with increasing @xmath97 , one will see a widening central peak and tails with more and more distinct secondary correlation peaks . in our typical @xmath67  examples with @xmath110  one can not proceed with @xmath97 well above @xmath145 without the tails loosing any relationship to the physical forces and starting to reflect purely geometrical interdomain correlations .",
    "this explains why it is so difficult to generate rough surfaces with large @xmath97 .",
    "above we treated rough surfaces as or objects that are described by smooth functions .",
    "this can be easily justified when the natural physical scale of the system @xmath88 is much larger than the atomic size @xmath129 , @xmath146 , as in our neutron example in which @xmath147 @xmath148 ( see section iiia below ) .",
    "this is a good approximation for systems with macroscopic roughness and/or longwave particles . in the case of electrons in ultrathin metal films",
    "the amplitudes of inhomogeneities have atomic scale and the situation is different .",
    "the approach should depend on whether one deals with atomically rough or atomically smooth surfaces . in the former case , such as , for example , for amorphous films , the theoretical description via the correlation function might still work though the correlators should be discretized in order to account for discrete nature of atomic - size steps in scanning measurements or computer models . in the latter case",
    ", the rough surfaces can be understood as perfect crystal faces with roughness introduced by randomly distributed adatoms / vacancies and steps with kinks .",
    "if this is the case , then the roughness profile is described by an integer number of defects of the atomic height @xmath129 which now becomes the only scale of the problem .",
    "then the use of continuous correlators for computer modeling and stm  data should be revisited even if one ignores the obvious angular anisotropy .",
    "for example , the small value of the amplitude of the correlation function @xmath93 as in experiment @xcite might mean that either the amplitude of roughness is indeed small or that there is simply very few surface defects .",
    "in the latter case the meaning of the roughness correlation radius can itself become murky .",
    "the generation of rough surfaces with discretization of amplitudes on atomic level can not be done using a generic procedure of section ii : the rotation matrix @xmath55 , eqs .",
    "@xmath149 is determined solely by the desirable correlator @xmath150 and the generated surface profile @xmath151 does not reduce to a set of integer numbers in terms of @xmath129 even if before the rotation the starting values of @xmath152 were integer . in general , the best we can do with this procedure is to generate the set of @xmath151 and then round the values of @xmath151 to the nearest integer number @xmath153 .",
    "this , of course , changes the correlation function .",
    "the results of this approach are illustrated in figure 5 . in this figure",
    "we used the method of section iia to generate the rough surface which emulates the exponential correlator @xmath154 and then rounded the data points @xmath151 to the nearest integer number @xmath153 .",
    "the black curve in the figure is the initial theoretical correlator , the red line is the correlator @xmath155 of the generated rough surface , and the blue line is the correlator @xmath156 after the discretization of the surface profile @xmath151 to integer numbers . as one can see ,",
    "this procedure can work at best qualitatively .",
    "it might be impossible to computationally emulate a random rough surface with an integer profile @xmath153 with an _ arbitrary _ predetermined correlation function @xmath157 except , of course , for `` classical '' surfaces with very large amplitude of roughness @xmath93 , @xmath158 .",
    "however , several specific correlators can still be generated based on spin lattice models with various hamiltonians .",
    "this might help in extracting the proper correlation functions from experimental data on the surface profile based on realistic assumptions on the interaction of the surface defects .",
    "this can also help to guess which correlation functions to use in theoretical calculations .",
    "needless to say , many of the lattice models produce the correlation functions which are exponential at large distances and have complicated , often analytically unresolved structure in the peak area .    unfortunately , the universe of the correlation functions which are accessible in this way is limited by the number of known exactly solvable lattice models , mostly in , some of which may have little resemblance to real surfaces .",
    "it is even unclear whether there are any restrictions on allowed forms of the correlation functions . in even the simplest models , such as the ising model , lead to the correlation functions for which we do not have explicit analytical expressions making them virtually useless for our purposes .",
    "there are a couple of additional practical difficulties for using this approach .",
    "first , when the correlation radius @xmath2 is comparable to or smaller than the lattice constant @xmath129 , the reliable extraction of @xmath2 or the shape of the peak in the correlator from either computer generated surface or stm data still remains impossible . in the opposite case ,",
    "when @xmath2 is large , the computational requirements rapidly increase because of the large size inhomogeneities ( domains ) .",
    "the latter requires not only going to much large sample sizes but also an increase in computing time because of a slowdown in convergence .",
    "the simplest example is , of course , the ferromagnetic ising lattice @xmath159 where the correlation function is determined by the attractive coupling constant @xmath160 in the hamiltonian ( or , what is the same , by the boltzmann factors @xmath161 ) . in the case",
    "the correlation function is exponential,@xmath162the correlation function for the ising model , though known in principle , ref .",
    "@xcite , is described by a set of complicated equations involving elliptical integrals .",
    "we performed monte carlo simulations of @xmath67 and @xmath68 rough surfaces on the basis of the ising model .",
    "the @xmath67correlation function @xmath15 for the generated surface profile @xmath25 is illustrated in figure 6 . in computations we used 1000 positions @xmath163 and performed",
    "@xmath164 monte carlo cycles .",
    "the correlation function @xmath165 ( red curve in figure 6 ) should emulate function @xmath166 with @xmath167 and @xmath168 ( black curve in the figure ) as in the neutron experiments ( see below ) .",
    "the standard deviation between the desired and generated correlators is @xmath169 .",
    "figures 7 illustrate the correlation function for the the surface profile generated using the @xmath68 ising model at relatively high temperatures , @xmath170 . at this temperature the relaxation ( and computation ) times are not very long , domains are small , and the energy equilibrates . on the other hand ,",
    "the correlation radius already starts to grow and the correlation function should start exhibiting deviations from the pure exponential form .",
    "the surface area was @xmath171 and we performed @xmath164 metropolis cycles .",
    "figure 7@xmath129 shows the correlation function for this surface and figure 7@xmath96 gives the same correlation function after averaging over the angles .",
    "since the sample size is substantially larger than in section iia , the fluctuations are smaller .",
    "for the same reason , the volatility of the flattened correlation function is actually higher .",
    "a more detailed analysis is presented in section iv . at high temperatures",
    "this approach to generating rough surfaces seems to be better than the one from section iia since it allows working with larger samples without involving more computation resources .",
    "the situation inverses closer to the transition and below when the relaxation times increase .",
    "experimental observation of quantization of motion of ultracold neutrons by gravitational field @xcite was one of the most interesting recent achievements in neutron physics .",
    "this is a significant breakthrough in a field with a relatively long theoretical and experimental history going back at least into the late 1960-s ; for a review and a list of publications in the field see ref .",
    "the discrete quantum states for neutrons in the earth gravitational field have extremely low energies with the scale of 1 . though the quantization of motion by a linear field such as gravity is not new by itself @xcite and",
    "has been already encountered experimentally in a low - temperature context @xcite , the experimental access to a spectrum of discrete energy states in such a low energy range opens the way for using ultracold neutrons as a very sensitive probe for extremely weak fundamental forces @xcite .    currently , the experimental resolution of gravitational states is achieved by sending a horizontal beam of ultracold neutrons between two horizontal mirrors .",
    "the top mirror , the `` ceiling '' , is intentionally made rough , while the bottom one , the `` floor '' , is nearly ideal ( the quality of this mirror is such that it can ensure thousands of almost specular consecutive reflections @xcite ) .",
    "the mirrors are reflective only when the normal component of velocity is below a certain threshold ; neutrons with velocities above this threshold are absorbed by the mirrors material .",
    "the beam of ultracold neutrons entering this wave guide contains neutrons with a horizontal velocity noticeably higher than this threshold and a much smaller residual vertical component .",
    "the scattering of neutrons by the rough ceiling turns the velocity vector thus increasing its vertical component and leading , eventually , to absorption of the scattered neutrons .",
    "the quantization of the vertical motion of neutrons by the earth gravity field corresponds to the quantization of the amplitude of bounces of neutrons from the floor mirror . in quantum language , the turning of the velocity is equivalent to scattering - driven transitions of neutrons into the higher quantum states .",
    "only the neutrons in the lowest gravitational states with the lowest kinetic energy of vertical motion and , therefore , the lowest amplitudes of bounces , which could not reach the rough ceiling , continue bouncing unimpeded along the floor mirror and are counted by an exit neutron counter .",
    "recently we demonstrated that the results of such experiments strongly depend on the correlation properties of roughness on the ceiling mirror mauricio1 .",
    "the experiments are unique in a sense that the roughness of the ceiling mirror is created artificially . in this application ,",
    "the spatial scale @xmath172 @xmath173 is the size of the lowest quantum state in the _ infinite _ gravitational trap ( open geometry without the ceiling ) ; @xmath174 is the neutron mass . since this length scale @xmath88 is relatively large , it is possible to create the random roughness with optimized correlation properties by computationally generating the required pattern and transferring it onto the real surface . in earlier experiments",
    "the roughness was neither optimized nor properly measured .",
    "the observation of the surface profile under the microscope yielded the average distance between the nearby maxima and the height of the peaks about 1.19 and 0.119 in units of @xmath88 .",
    "these numbers were accepted as the correlation radius @xmath2 and the amplitude @xmath93 of surface roughness , @xmath167 and @xmath175 , and the roughness was assumed to be gaussian .",
    "of course , neither of these assumptions could be justified , and the comparison of the theoretical results to the experimental data required adjustments . if the planned new experiments follow the suggestions of this paper , this uncertainty could be eliminated .",
    "an additional attraction of this system is that the geometry of the beam experiment allows one to deal with a practically @xmath67 roughness application in which the motion along the waveguide surface in the direction perpendicular to the beam can be made irrelevant .    in ref .",
    "@xcite we demonstrated that , as far as the neutron exit count @xmath176 is concerned , all system parameters collapse into a single constant @xmath177 , @xmath178 where @xmath179 are the numbers of neutrons in the in the quantized states @xmath180 that enter the rough waveguide , @xmath181 is the average width of the waveguide , and @xmath182 are the values of the wave functions of neutrons in the gravitational states @xmath180 on the `` ceiling '' .",
    "therefore , the problem of computationally optimizing the exit count so that it exhibits the most pronounced step - wise dependence on the waveguide width @xmath183 reduces to increasing the value of constant @xmath177 by manipulating the computer - generated correlation functions .    the explicit expression for @xmath177 via the correlation function @xmath184 , eq .",
    "@xmath185 , is @xcite @xmath186 where the constant @xmath187 is determined by the size and the material of the waveguide ( in experiments @xcite , @xmath188 ) , and the variable @xmath70 in the argument of the power spectrum of the surface roughness @xmath189 is @xmath190 here @xmath191 , @xmath192 is the energy threshold for the neutron penetration into material of the waveguide , @xmath193 is the ratio of this threshold energy to the full kinetic energy of neutrons in the beam ( in past experiments @xmath194 ) , and @xmath195 differs from 1 only because of small variations in the time of flight through the waveguide .    as a result , the computation of @xmath177 , and , therefore , the expected neutron count , for various correlation functions @xmath184 reduces , essentially , to numerical integration in eq . @xmath196 .",
    "the most important feature here is that , because of the large value of @xmath197 ( in experiment @xmath198 ) , the main contribution to the integral comes from not the whole peak in the power spectrum @xmath189 , but from the immediate vicinity of its center at @xmath199 .",
    "this means that the tails in the computationally generated power spectrum @xmath189 are irrelevant , but also that the only issue is to correctly reproduce the vicinity of @xmath200 .",
    "however , the closer one gets to @xmath201 , the more important is the tail of the correlation function @xmath202 at large @xmath203 .",
    "our recommendation is to generate a random rough profile using the monte carlo simulations on the basis of the @xmath204 ising model as described in subsection iib . in this particular case",
    "we prefer this method to the one from section iia because it allows easier computation for a large number of points @xmath72 resulting in smaller fluctuations .",
    "another important benefit is that the transferring the generated pattern to the real mirror is also much simpler because all the inhomogeneities for the ising profile have the same constant amplitude @xmath205 ( figure @xmath206 ) . in this case , the roughness correlation function is exponential @xmath207 , eq .",
    "@xmath208 , with a simple power - law power spectrum@xmath209 which yields the following analytical expression for @xmath177:@xmath210 ( see @xcite , eq . ( 38 ) ) .",
    "improving the experimental outcome , namely observing the well - pronounced quantum steps in neutron count , requires the value of @xmath177 to be  as large as possible .",
    "one can get the desirable value of @xmath177 by simply manipulating values of the correlation radius and the amplitude of surface roughness in computer simulation .",
    "the only limitation here is that the amplitude of the mirror roughness @xmath95 should be smaller than both the correlation radius @xmath97 and the width of the waveguide @xmath181,@xmath211    when making estimates of the optimal values of @xmath95 and @xmath97 , it is convenient to rewrite eq .",
    "@xmath212 in the limit @xmath213 ,   @xmath214 this equation does not have very high accuracy and for final calculations one should still use eq .",
    "however , eq . @xmath215 highlights the dependence of @xmath216  on @xmath95 and @xmath97 in a very simple form . since the value of @xmath216 , eq .",
    "@xmath217 , is more sensitive to @xmath95 than to @xmath97 , one should increase @xmath218 as much as possible simultaneously adjusting @xmath97 .",
    "the limit is imposed by the width of the waveguide which in experiment comes down to @xmath219 .",
    "therefore , the optimal waveguide should have roughness with @xmath220 and the amplitude @xmath221 .",
    "we would not recommend to make @xmath95 much larger than @xmath222 - the ratio @xmath223 limits the accuracy of measuring the waveguide width . still , even this would allow to increase the value of @xmath177 several times in comparison to what it is assumed to be in previous experiments with an additional benefit of ensuring a perfectly controllable environment .",
    "the anticipated value of @xmath216 for these parameters is in the @xmath224  range and one should be able to see well - pronounced quantum steps in neutron count without changing anything else in experiment .",
    "one of the most important applications is ballistic conductivity of ultrathin films with rough surfaces in quantum size effect ( qse ) conditions .",
    "there are many theoretical approaches to this problem ( for a short review of earlier approaches see , for example ref .",
    "the equations relate the @xmath68 conductivity of the films @xmath104 to the fourier image ( power spectrum ) of the correlation function of surface roughness @xmath225 .",
    "though these equations are more or less transparent , the results , which involve inversion of large matrices , are not .",
    "the difficulty arises because of the qse - driven split of the @xmath226 energy spectrum @xmath227 into a large set of @xmath66 minibands @xmath228 and the corresponding slicing of the fermi surface . as a result",
    ", the transport equation becomes a large set of coupled equations in the miniband index @xmath180 .",
    "for the purpose of this paper , namely for analysis of the correlation functions extracted from a numerical or physical experiment , it is better to restrict oneself to the situations in which it is possible to solve this matrix transport equation analytically and get simple explicit expressions for @xmath104 via @xmath229 ( see , for example , ref .",
    "@xcite ) . we will not give here the details of the derivation and only present these final expressions .",
    "in the first case only the first miniband @xmath230 is occupied ( ultrathin films with very strong spatial quantization , @xmath231 ) and @xmath232 here the lower index @xmath108 indicates that everything is restricted solely to the first miniband with the fermi momentum @xmath233 and @xmath234 are the zeroth and first angular harmonics of the roughness - driven scattering probabilities @xmath235,@xmath236 over the angle between the vectors @xmath237 and @xmath238 ( this equation assumes that the correlation properties of both surfaces of the film are the same and that there are no intersurface correlations ) .",
    "the second analytical case is the case of small @xmath239 . in this limit ,",
    "the correlation function is a constant with the zero first harmonic , @xmath240 with @xmath241 and @xmath242 where @xmath243 is the total number of the occupied minibands ( the number of slices of the fermi surface by quantizing planes @xmath244 ) which is given by the equation @xmath245    eqs . @xmath246",
    "involve the power spectrum of the surface roughness @xmath247 at @xmath248 which acquires the following form after the angular integration ( see , for example , @xcite):@xmath249    the value of @xmath250 is important not only for conductivity of ultrathin films , but also for a much more general class of problems associated with scattering longwave particle ( or waves ) on rough surfaces .",
    "scattering in longwave limit @xmath251 is always described by a single constant , which here is , essentially , @xmath252 .",
    "therefore , @xmath253 is one of the most important characteristics of the surface which determines a large number of observables .",
    "note , that all our surface correlators @xmath73 in ref .",
    "pon1 are introduced in such a way that in the longwave limit @xmath254 in what follows we will evaluate @xmath255 for rough surfaces .",
    "here one has a choice : either to fit the correlation function extracted from the experimental or numerical data to one of the model correlators and to get @xmath256 from the best fit values of @xmath93 and @xmath2 , or to get @xmath257 directly from the data by , for example , direct numerical integration @xmath258 of the extracted data .",
    "the accuracy with which we will be able to evaluate the value of @xmath253  will provide a much more reliable physical evaluation of the data and techniques than the standard deviation between the extracted correlators and the fitting functions .",
    "in this section we will analyze what kind of information one can extract from the surfaces generated by methods of section ii .",
    "this will also give us an insight into difficulties facing experimentalists trying to extract the correlation function from the scanning microscopy .",
    "in this regard , the problems facing the computational physicists and experimentalists are roughly the same : limited sample sizes , noticeable fluctuations , large domains , and long relaxation times . since we know exactly how the `` true '' roughness correlation function should look like when we are using the methods of section ii , we are able to point at potential pitfalls in extracting information from experimental and computational data when one does not know the `` true '' correlation function",
    ". we will judge the quality of the surface analysis not by the standard deviation @xmath104 between the extracted data and a fitting function , but by the values of the physically important variables - @xmath177 for the neutron problem and @xmath259 for the conductivity of and scattering from films in the longwave limit as explained in section iii .",
    "our goal here is to show that the use of a fitting function of a wrong shape can invalidate both the computations and the experiments .",
    "first , the parameters of the correlation function @xmath260 obtained from the best fit to @xmath261 strongly depend on the _ assumption _ about the functional form ( shape ) of the `` real '' correlator .",
    "for example , the analysis of the same stm measurements of @xmath261 on the basis of the gaussian and exponential correlators in ref .",
    "@xcite provided vastly different values of the correlation radius @xmath2 .",
    "since the shape of the `` real '' correlator is not known , it is almost impossible to know what function should be fitted to @xmath261 and what is the reliability of the extracted parameters .",
    "note that the standard deviation @xmath104 is supposed to be the deviation between the extracted ( `` measured '' ) correlator @xmath261 and the `` true '' correlation function .",
    "when the `` true '' correlator is unknown , as in most experiments , what is presented as @xmath104 is the deviation between the extracted correlator and the models used for fitting,@xmath262 which describes the quality of the fit and tells us nothing about appropriateness of the fitting function .",
    "@xmath263 is highly weighted towards the tails of the correlator , especially when the correlation radius is comparable to the probing step .",
    "when the fitting functions rapidly go to zero at large distances , @xmath104 , eq .",
    "@xmath263 , does not even depend much on the choice of the fitting function while the physical results clearly do .",
    "when one uses the short - range fitting functions , the presence of long fluctuation - driven tails may even emulate the presence of some additional large correlation radius @xmath143 introduction of which can noticeably decrease @xmath104 . [",
    "the second , large correlation radius was observed , for example , in ref .",
    "we do not know how to verify the reliability of such conclusions without doing the same measurements on a relatively large number of other surfaces , including much larger sample sizes .",
    "this , of course , is not practical for the already difficult experiments ] .",
    "the outsize effect of these fluctuation tails often seems even more important than the difficulties in resolving the shape of the main maximum @xcite .",
    "the second intrinsic difficulty arises when dealing with surfaces with a large correlation radius @xmath97 .",
    "the large value of @xmath97 means that the surface is covered by large size inhomogeneities ( domains ) .",
    "as explained in the end of section iia , the presence of a small number of large domains gives rise to the appearance of spurious secondary peaks of the radius @xmath97 at positions that correspond to the integer numbers of average distances between the domains .",
    "these peaks reflect interdomain correlations and not physical interactions .",
    "in addition to analyzing the extracted correlators with the help of various fitting functions , we will also perform the direct fourier analysis of the correlation data sets as it is sometimes done for experimental data .",
    "this should , in principle , give us the full power spectrum of the correlations which we use for direct calculation of observables .",
    "this approach allows one to avoid the pitfall of using the fitting functions of a `` wrong '' shape .",
    "however , this approach encounters difficulties of a different type .",
    "it utilizes all the erroneous information which is contained in the fluctuations while all the fitting function of `` right '' and `` wrong '' shapes , which all rapidly go to zero at large distances , simply disregard the long fluctuation - driven tails .",
    "of course , one can always introduce the high frequency cutoff when doing the spectral analysis , but then the physical results become dependent on the guess for the cutoff .",
    "we start from the @xmath67 case in application to our neutron problem .",
    "table i contains examples of three runs based on section iia . in each run",
    "we generate a rough surface with a gaussian correlation of inhomogeneities with @xmath264 and @xmath265 which is supposed to be close the real experimental setup .",
    "the main physical parameter @xmath177 , eq .",
    "@xmath266 , which determines the neutron count behind the waveguide , for such roughness is equal to @xmath267 . after each numerical run , we fit the observed correlation function with a gaussian , @xmath268 , exponential , @xmath269 , and power law , @xmath270 ^{3/2}$ ] , correlators and extract the best fitting values @xmath271 and @xmath272 for the amplitude and the correlation radius . then we recalculate the value of @xmath177 , eq .",
    "@xmath196 , using these fitting functions .",
    "the table contains values of @xmath177 for these three types of fitting correlators , @xmath273 , the standard deviations @xmath274 for the fittings , and the fitting parameters @xmath275 which provide the best fits . to save space ,",
    "we do not present the fitting parameters @xmath276 which were all in the range @xmath277 .",
    "the table also contains the values @xmath278 and @xmath279 obtained from the fourier analysis with a large number of harmonics ( half the number of the data points ; thus a vanishingly small value of @xmath280 ) .",
    "the latter procedure is , essentially , equivalent to direct numerical integration @xmath281 of the power spectrum of the observed correlator with all its fluctuation - driven tails .    [",
    "cols=\"^,^,^,^,^,^\",options=\"header \" , ]     * table iv . * results for three rough surfaces generated using the @xmath66 ising model ( the first three rows ) and for the correlation function averaged over ten runs ( the last row ) .",
    "the monte carlo simulations have been done at @xmath282 with @xmath164 metropolis cycles as in figure 7 . the surface size is @xmath283 .",
    "the table is arranged similarly to table ii .",
    "the table contains the best fitting values of @xmath284 and the corresponding values of @xmath285  and @xmath286 .",
    "the values of @xmath287 for direct spectral analysis of the raw correlation data are given in the text .",
    "the results for the exponential fits @xmath288 for @xmath289 and @xmath290 should be the closest to the true physical parameters .    the computations are done above the phase transition , @xmath282 . at this temperature",
    "the correlation function is , probably , still close to the exponential ( figures 7@xmath96 and 7@xmath291 ) , but it is not clear how close .",
    "here we do not know exactly what should be the `` true '' value of @xmath292 , but expect that the exponential correlator provides the best estimate . at this temperature",
    "the domains are relatively small ( see figure 7@xmath129 ) and the relaxation times are manageable .",
    "the size of the surface is relatively large , @xmath293 , and each computation runs @xmath164 metropolis cycles .",
    "the table is arranged similarly to table ii . here",
    "again the values of @xmath21 for all fitting functions are close for each other while the values of @xmath292 and @xmath97 are noticeably different . the results for the exponential fit should be the closest to the true physical parameters .",
    "the first column for the exponential fitting gives results obtained from the flat ( @xmath67 ) file @xmath294 .",
    "the second column gives the results of fitting @xmath295 by the @xmath68 exponential function .",
    "for the gaussian and power law correlators , columns 3 and 4 , we used only the flat files @xmath296.what is somewhat surprising is that the results for our choice of the power law correlator , which is the fourier image of the exponential one , are again close to those using the exponential fit .",
    "what is even more surprising , the values of @xmath292 for the power law fit using @xmath297  are systematically closer to the exponential fit using @xmath298 than to the exponential fit using @xmath299 .",
    "the gaussian fit yields very different @xmath292 while the value of @xmath21 is comparable with the others .",
    "the direct spectral analysis of the raw correlator data again yields the worst physical results and changes from run to run ; there results are not even worth listing .",
    "the spectral analysis of the correlation function averaged over ten runs worked better than the gaussian fit and yielded @xmath300 for the flat files @xmath296 and @xmath301 when working with the correlation function @xmath298 .",
    "the differences between results obtained using different fitting functions once again illustrate the uncertainty in comparing computational and experimental data to theoretical results .",
    "one should have at least some information about the shape of the `` true '' correlation function .",
    "in summary , we looked at reconciling numerical and physical measurements of random rough surfaces with theoretical results using the roughness correlation function .",
    "we demonstrated that data extracted from scanning microscopy of the surface profile can be insufficient for unambiguous determination of the shape of the correlation function ( for some of the recent experimental attempts to extract the correlation function from the scanning microscopy see refs .",
    "munoz1,munoz4,shikin1,munoz2,munoz3,parpia1 ) .",
    "the same is true for computational experiments in which a random surface is generated without an effort to reproduce a known correlation function .",
    "there are two main obstacles apart from the accuracy of measurements .",
    "the first one is the presence of fluctuations which are unavoidable for finite samples .",
    "the second one is the relationship between the step size @xmath96 , correlation radius @xmath97 , and the overall number of data points @xmath72 . to properly recover the shape of the correlation maximum",
    ", one needs the step size @xmath96  to be noticeably smaller than the correlation radius @xmath97",
    ". if one decreases @xmath96 ( or , what is the same , increases @xmath97 ) while keeping the overall number of data points @xmath72 , which is determined by the technical or computational abilities , constant , the data set measured in units of @xmath97 effectively shrinks . since @xmath97 determines the size of correlated clusters ( domains ) , the full data set will cover the smaller number of domains .",
    "this , in turn , gives rise to noticeable spurious , purely geometrical interdomain correlations which have nothing to do with real physical interactions .",
    "these interdomain correlations can masquerade as the presence of an additional , larger correlation radius .",
    "the same effect makes reproducing surfaces with very large correlation radii virtually impossible .",
    "we analyzed two methods for numerical generation of surfaces with predetermined roughness correlation functions .",
    "this was done with practical physical applications in mind : beams of ultracold neutrons in a rough waveguide , resistivity of ultrathin rough films in quantum size effect conditions , and particle or wave scattering in the longwave limit .",
    "we judged the quality of the analysis of the extracted correlation functions by the accuracy of the predictions for observables for these applications .    for the neutron problem , for which the roughness of the waveguide is introduced on purpose , we suggest a practical way of preparing the rough mirror for optimization of the granit - type experiment neutron1,nesv2,mauricio1 .",
    "our recommendation is to generate a random rough profile using the monte carlo simulations on the basis of the @xmath67 ising model with the correlation radius @xmath220 and the amplitude of roughness in the @xmath222 range and to transfer this profile onto the mirror surface .",
    "this allows one to increase the value of @xmath177 to @xmath224 , _",
    "i.e. _ , several times times in comparison to what it is assumed to be in previous experiments while creating a perfectly controllable environment .",
    "this is sufficient for showing the well - developed quantum steps in the exit neutron count and produce neutrons with well - defined energies in the range .",
    "since all the lengths here are in the units of @xmath302 , this procedure seems to be feasible .",
    "there are several challenges for identifying the roughness correlator from experimental and numerical data on the surface profile even if one disregards all the issues concerning the accuracy of profile measurements .",
    "most importantly , the standard deviation @xmath104 between the measured or generated correlation function and some fitting function can not be considered a good predictor for physical results .",
    "the value of @xmath104 extracted from fitting is strongly weighted towards the tail of the correlation function .",
    "if the correlator rapidly decreases at large distances , the values of @xmath104 are more or less the same for all reasonable fitting functions and measure the fluctuations without saying anything about appropriateness of the chosen fitting functions",
    ". meanwhile , the physical observables are very sensitive to the shape of the correlator . as a result , the error in physical results can by far exceed @xmath104 .    decreasing the size of the fluctuations",
    "requires increasing the size of a sample . increasing the size of the sample , on the other hand , increases the role of the fluctuation - driven tails of the correlators at the expense of the contribution from the peak area in which one would expect to observe main differences between the physically different correlators .",
    "one option for suppressing the fluctuation - driven tails is to average the numerically or experimentally measured correlation function over several samples as it is sometimes done in experiment @xcite .",
    "however , this operation can be inherently  dangerous when , for example , the correlation function itself has longer tails of alternating sign .",
    "if one knows that there are no long range correlations , this averaging over several samples can be very helpful for roughness .",
    "such averaging has not been necessary for roughness in our numerical experiments .",
    "the same difficulty persists if one simply cuts off the long range tails assuming that they are driven only by the fluctuations .",
    "generating or measuring the correlation function with a large correlation radius @xmath2 requires a noticeable increase in the sample size @xmath72 : the important parameter is not the overall number of the data points @xmath72 , but the number of inhomogeneities @xmath139 where @xmath140 is the number of points in a typical inhomogeneity .",
    "the problem is exacerbated in the two - dimensional case when @xmath140 grows proportionally to @xmath10 .",
    "the shape of the correlation function with not very large @xmath139 could be very misleading and point , rather convincingly , at fictitious long - range correlations .    in general , it is much easier to generate a rough surface with a desired correlator in a @xmath67 rather than in a @xmath68 case .",
    "apart from the obvious difficulty that the @xmath68 sample of the same linear size @xmath80 requires the use of @xmath303 data points rather than @xmath304 as in the @xmath67 case , there is an additional difficulty associated with a greater volatility of the correlation function due to the residual anisotropy in generated or measured correlators .",
    "we also tried the alternative approach to data analysis without fitting functions by performing the spectral analysis of the raw correlation data and using the results for direct calculation of observables . in examples this approach worked somewhat , but not much , better than using a fitting function of a wrong shape , but still noticeably worse than using the `` right '' fitting function .",
    "this approach did not work for us in cases because of the fluctuation - driven anisotropy of the extracted correlators and smaller linear sizes of the samples than in .",
    "if there are no restriction on the amplitudes of inhomogeneities , as in the case of macroscopic roughness , one can easily generate a surface with any given correlation function . generating random surfaces with discretized ( atomic ) inhomogeneities , _",
    "i.e. _ , inhomogeneities with amplitudes of integer sizes , presents unique challenges . here",
    "the only reliable method is to use a solvable lattice model ( for example , the ising model ) .",
    "the universe of exactly solvable models is limited and , therefore , one can generate the surfaces with discrete amplitudes of inhomogeneities with just few types of the predetermined surface correlators which may or may not reflect the real rough surfaces .",
    "_ we are grateful to p. nightingale for helpful discussions concerning generation of random surfaces .",
    "_ one of the authors ( a.m. ) is grateful to the members of granit group at ill , and especially to v. nesvizhevsky , for the hospitality during his visits to grenoble and for the stimulating discussions .",
    "99 j. a. ogilvy , _ theory of wave scattering from random surfaces _",
    "( adam hilger , bristol ) 1991    p. dooley , and s.l .",
    "bernasek , surf . sc . * 406 * 206 ( 1998 )    b. b. mandelbrot , d. e. passoja , and a. j. paullay , nature ( london ) * 308 * , 721 ( 1984 )    l. ponson , d. bonamy , and e. bouchaud , phys .",
    "lett . * 96 * , 035506 ( 2006 )    jan oystein haavig bakke , and a. hansen , phys .",
    "e * 76 * , 031136 ( 2007 )    r. m. feenstra , d. a. collins , d. z .- y . ting , m. w. wang , and t. c. mcgill , phys .",
    "lett . * 72 * , 2749 ( 1994 )    r. c. munoz , g. vidal , g. kremer , l. moraga , c. arenas , and a. concha , j. phys . : condens .",
    ", * 12 * , 2903 ( 2000 )    a. e. meyerovich , and i. v. ponomarev , phys.rev .",
    "b * 65 * , 155413 ( 2002 ) ; y. cheng , and a. e. meyerovich , phys.rev .",
    "b * 73 , * 085404 ( 2006 )    _ scanning tunneling microscopy _ , eds . j. a. stroscio , and w. j. kaiser ( academic press , ny ) 1993 [ methods of experimental physics , v. 27 ]    r. c. munoz , g. vidal , m. mulsow , j. g. lisoni , c. arenas , a. concha , f. mora , r. espejo , g. kremer , l. moraga , r. esparza , and p. haberle , phys .",
    "b * 62 * , 4686 ( 2000 )    j a ogilvy , and j r foster , j. phys .",
    "phys , * 22 * , 1243 ( 1989 )    a. fubel , m. zech , p. leiderer , j. klier , and v. shikin , surf",
    "* 601 * , 1684 ( 2007 )    s. m. goodnick , d. k. ferry , c. w. wilmsen , z. liliental , d. fathy , and o. l. krivanek , phys .",
    "b * 32 * , 8171 ( 1985 )    g. palasantzas , phys . rev .",
    "b * 48 * , 14472 ( 1993 )    m. e. robles , c. a. gonzalez - fuentes , r. henriquez , g. kremerc , l. moragab , s. oyarzunb , m. a. suarez , m. flores , r. c. munoz , appl . surf . sc . * 258 * , 33933404 ( 2012 )    jiunn - jong wu , tribology internat .",
    "* 33 * 47 ( 2000 )    j. c. novarini , and j. w. caruthers , j. acoust .",
    "53 * , 876 ( 1973 )    j. d. johnson , s. krinsky , and b. m. mccoy , phys",
    "* a8 * , 2526 ( 1973 ) ; hung cheng and tai tsun wu , phys .",
    "* 164 * , 719 ( 1967 )    v. v. nesvizhevsky _ et al , _ nature , * 415 * , 297 ( 2002 ) ; v. v. nesvizhevsky _",
    "et al , _ phys . rev .",
    "d * 67 * , 102002 1 - 9 ( 2003 ) ; v.v.nesvizhevsky _ et al _ , european phys .",
    "journal c * 40 , * 479 ( 2005 ) [ for additional bibliography see also http://lpscwww.in2p3.fr/ucn/niveauxq_g/publications/index.html ]    v. v. nesvizhevsky , physics - uspekhi , * 53 * , 645 ( 2010 )    g. breit , phys .",
    ", * 32 * , 273 ( 1928 )    j. h. freed , ann .",
    "fr . , * 10 * , 901 ( 1985 )    h. murayama , g. g. raffelt , c. hagmann , k. van bibber , and l.j.rosenberg , in : k. hagiwara et al .",
    "( particle data group ) , _ review of particle properties _ , p. 374",
    "d * 66 * , 010001 ( 2002 )    v. v. nesvizhevsky , and k. v. protasov , class .",
    "quantum gravity , * 21 * , 4557 ( 2004 )    possible use of gravitational quantization of neutrons for measuring the fundamental forces was the main topic of the workshop http://lpsc.in2p3.fr/congres/granit06/index.php ( ill , grenoble , april 2006 )    v.v .",
    "et al , _ nuclear instruments and methods in physics research ( nim ) a * 578 * , 435 ( 2007 )    m. escobar , and a. e. meyerovich , phys . rev .",
    "a * 83 * , 033618 ( 2011 )    a. e. meyerovich , and a. stepaniants , phys .",
    "b * 60 * , 9129 ( 1999 )    r. c. munoz , g. vidal , g. kremer , l. moraga , c. arenas , j. phys .",
    ": condens .",
    "matt . * 11 * , l299 ( 1999 )    p. sharma , a. crcoles , r. g. bennett , j. m. parpia , b. cowan , a. casey , and j. saunders , phys .",
    "lett . * 107 * , 196805 ( 2011 )",
    "* figure 1 . *",
    "( color online ) an example of the correlation function ( black solid line ) for a generated @xmath67 surface which should emulate a surface with gaussian correlation of inhomogeneities @xmath305 ( blue dashed line ) .",
    "the total number of points is 2000 , the average amplitude of roughness @xmath306 , the correlation radius @xmath112    * figure 2 . *",
    "( color online ) * *  * * correlation functions for @xmath307 generated surface profiles which should emulate the gaussian ( black ; curve 1 ) , exponential ( red ; curve 2 ) , and pl ( blue ; curve 3 ) correlation functions . in the peak area",
    "( figure @xmath119 ) the differences are very pronounced , but the fluctuation - driven tails ( figure @xmath120 ) are almost identical .",
    "all three computations started from the same set of @xmath110 random numbers .",
    "* figure 3*. ( color online ) dependence of the standard deviation @xmath105 between generated and exact correlation functions on the sample size @xmath72 .",
    "the solid line is @xmath123 .",
    "the generated roughness is supposed to have gaussian correlations with @xmath220 .",
    "* figure 4 . *",
    "( color online ) an example of a @xmath68 rough surface of the size @xmath308 .",
    "the roughness emulates isotropic gaussian correlations with @xmath220 , @xmath309 ( black line 1 in figure 4@xmath96 ) .",
    "( @xmath129 ) @xmath76 correlation function @xmath135 ( @xmath96 ) the correlation function @xmath165 after averaging over the angles ( line 2 ; blue ) .",
    "* figure 5 . *",
    "( color online ) correlation function for a generated surface emulating @xmath310 ( line 1 ; black ) after rounding the profile data points @xmath151 to the nearest integer number @xmath311 .",
    "line 2 ( red ) : the generated raw correlator @xmath312 , line 3 ( blue ) : the correlator for the discretized surface @xmath313 .",
    "* figure 6 . *",
    "( color online ) an example of the correlation function for a @xmath67 rough surface @xmath25 and its correlation function @xmath165 generated using the ising model ( red line 2 ) .",
    "the parameters in the correlation function @xmath264 and @xmath314 ; black line 1 is given by eq .",
    "@xmath166 ( @xmath315 ) .",
    "* figure 7 . *",
    "( color online ) an example of a @xmath68  random rough surface generated using the ising model at @xmath282 : @xmath316 correlation function @xmath317 correlation function after averaging over the angles .",
    "* table i. * three numerical runs based on sec .",
    "iia in application to our neutron problem .",
    "rough @xmath204  surfaces emulate gaussian correlation of inhomogeneities @xmath318 with @xmath264 and @xmath314 as it was assumed in experiment . the expected value of the main physical parameter @xmath319 , eq .",
    "@xmath196 , is @xmath320 .",
    "the extracted correlators were fitted with gaussian , @xmath321 , exponential , @xmath322 , and power law , @xmath323 ^{3/2}$ ] fitting functions .",
    "the table contains the best fitting values of @xmath324 , together with @xmath325 , and the recalculated values of @xmath326 . the columns with @xmath327 and @xmath328 give the values of @xmath319 and the standard deviation when the spectral decomposition of the data was put directly into equations without fitting .",
    "* table ii .",
    "* the same as in table i for generated @xmath76 rough gaussian surfaces with @xmath220 and @xmath329 .",
    "the expected value of the main physical observable @xmath330 the table contains the extracted fitting parameters @xmath331 and @xmath332 , together with @xmath333 , and the recalculated values of @xmath252 .",
    "the gaussian fit was done independently for the correlation function @xmath334 ( index 1 ) and the correlation function @xmath290 ( index 2 ) .",
    "the fourth row gives the results for the correlation function averaged over 10 independent runs .",
    "* table iii . *",
    "five monte carlo runs for the @xmath67 ising model .",
    "the `` true '' correlation function is exponential with @xmath264 and @xmath265 and yields @xmath335 .",
    "the correlation functions extracted from the generated rough surfaces were fitted with the exponential , gaussian , and power law functions .",
    "the table contains the best fitting values of @xmath336 and the corresponding values of @xmath285  and @xmath337 . since the simulation is based on the ising model with spins @xmath338 , the best fitting values of @xmath95 differed from @xmath339 by less than 1% for all fitting functions .",
    "the values of @xmath340 were obtained by direct spectral analysis of the raw correlation data .",
    "the size of the sample was @xmath341 and we performed @xmath164 metropolis cycles .",
    "* table iv .",
    "* results for three rough surfaces generated using the @xmath66 ising model ( the first three rows ) and for the correlation function averaged over ten runs ( the last row ) .",
    "the monte carlo simulations have been done at @xmath282 with @xmath164 metropolis cycles as in figure 7 .",
    "the surface size is @xmath283 .",
    "the table is arranged similarly to table ii .",
    "the table contains the best fitting values of @xmath284 and the corresponding values of @xmath285  and @xmath286 .",
    "the values of @xmath287 for direct spectral analysis of the raw correlation data are given in the text .",
    "the results for the exponential fits @xmath288 for @xmath289 and @xmath290 should be the closest to the true physical parameters ."
  ],
  "abstract_text": [
    "<S> we compare theoretical , experimental , and computational approaches to random rough surfaces . </S>",
    "<S> the aim is to produce rough surfaces with desirable correlations and to analyze the correlation functions extracted from the surface profiles . </S>",
    "<S> physical applications include ultracold neutrons in a rough waveguide , lateral electronic transport , and scattering of longwave particles and waves . </S>",
    "<S> results provide guidance on how to deal with experimental and computational data on rough surfaces . </S>",
    "<S> a supplemental goal is to optimize the neutron waveguide for granit experiments . </S>",
    "<S> the measured correlators are identified by fitting functions or by direct spectral analysis . </S>",
    "<S> the results are used to compare the calculated observables with theoretical values . </S>",
    "<S> because of fluctuations , the fitting procedures lead to inaccurate physical results even if the quality of the fit is very good unless one guesses the right shape of the fitting function . </S>",
    "<S> reliable extraction of the correlation function from the measured surface profile seems virtually impossible without independent information on the structure of the correlation function . </S>",
    "<S> direct spectral analysis of raw data rarely works better than the use of a `` wrong '' fitting function . </S>",
    "<S> analysis of surfaces with a large correlation radius is hindered by the presence of domains and interdomain correlations . </S>"
  ]
}