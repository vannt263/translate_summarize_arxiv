{
  "article_text": [
    "physical systems that enable single photons to interact strongly with each other are extremely valuable for many emerging applications .",
    "such systems are expected to facilitate the construction of single - photon switches and transistors @xcite , networks for quantum information processing , the realization of strongly correlated quantum systems using light @xcite and the investigation of novel new many - body physics such as out of equilibrium behaviors .",
    "one potential approach involves the use of high - finesse optical microcavities containing a small number of resonant atoms that mediate the interaction between photons @xcite .",
    "their nonlinear properties are relatively straightforward to analyze or simulate because they involve very few degrees of freedom ( _ i.e. _ , a single optical mode ) @xcite .",
    "recently , an alternative approach has been suggested , involving the use of an ensemble of atoms coupled to propagating photons in one - dimensional , tightly - confining optical waveguides @xcite . here , the nonlinearities are enhanced due to the transverse confinement of photons near the diffraction limit and the subsequent increase in the atom - photon interaction strength .",
    "the propagation of an optical field inside such a nonlinear medium ( _ e.g. _ , systems obeying the quantum nonlinear schrdinger equation ) is expected to yield much richer effects than the case of an optical cavity due to the large number of spatial degrees of freedom available .",
    "simultaneously , however , these degrees of freedom make analysis much more difficult and in part cause these systems to remain relatively unexplored @xcite .",
    "we show that the multi - mode , quantum nature of the system plays an important role and results in phenomena that have no analogue in either single - mode cavities or classical nonlinear optics .",
    "it is interesting to note that similar low - dimensional , strongly interacting condensed matter systems are an active area of research , but most of this work is focused on closed systems close to the ground state or in thermal equilibrium @xcite . on the other hand , as will be seen here , the relevant regime for photons often involves open systems and driven dynamics .    in this article , we develop a technique to study the quantum transport of a few photons inside a finite - length , strongly nonlinear waveguide where the light propagation is governed by the quantum nonlinear schrdinger equation  ( nlse ) , and apply this technique to study the operation of this system as a single - photon switch",
    ". in particular , we study the transmission and reflection properties of multi - photon fields from the system as well as higher - order correlation functions of these fields .",
    "we find that these correlations not only reflect the switching behavior , but reveal some aspects of the rich structure associated with the spatial degrees of freedom inside the system , which allow photons to `` organize '' themselves . in the regime where an effectively repulsive interaction between photons is achieved , anti - bunching in the transmitted field",
    "is observed because of the switching effect , and is further reinforced by the tendency of photons to repel each other . in the attractive regime , either anti - bunching ( due to switching ) or bunching can occur .",
    "we show that the latter phenomenon is a clear signature of the creation of photonic bound states in the medium .",
    "although we focus on a particular realization involving the propagation of light , our conclusions on quantum transport properties are quite general and valid for any bosonic system obeying the nlse .",
    "this article is organized as follows . in sec .",
    "[ sec : model ] , we describe an atomic system whose interactions with an optical field can be manipulated using quantum optical techniques such that the light propagation obeys the quantum nlse .",
    "this method relies upon electromagnetically induced transparency  ( eit ) to achieve resonantly enhanced optical nonlinearities with low propagation losses and the trapping of stationary light pulses using spatially modulated control fields . before treating the nonlinear properties of the system , we first consider the linear case in sec .  [ sec : linear ] , where it is shown that the light trapping technique leads to a field build - up inside the medium and a set of discrete transmission resonances , much like an optical cavity . in sec .",
    "[ sec : semi - classical ] , we then investigate the nonlinear transport properties of the system such as reflectivity and transmittivity in the semi - classical limit , where the nlse is treated as a simple complex differential equation . here",
    "we find that the presence of the nonlinearity causes the transmission resonances to shift in an intensity - dependent way  the system behaves as a low - power , nonlinear optical switch , whose behavior does not depend on the sign of the nonlinear interaction . in sec .",
    "[ sec : quantum_formalism ] , we present a full quantum formalism to treat the nlse transport problem in the few - photon limit .",
    "[ sec : analytical ] is dedicated to analytical solutions of the nlse with open boundary conditions when the system is not driven .",
    "in particular , we generalize the bethe ansatz technique to find the resonant modes of the system , which help to elucidate the dynamics in the case of the driven system .",
    "the driven system is studied in sec .",
    "[ sec : results ] , where numerical solutions are presented along with a detailed study of the different regimes of behavior .",
    "in particular , we find that the correlation functions for the transmitted light do depend on the sign of the nonlinear interaction , in contrast to what the semi - classical calculations would suggest .",
    "we conclude in sec .",
    "[ sec : conclusion ] .",
    "in this section , we consider the propagation of light inside an finite - length atomic medium under eit conditions and with a kerr nonlinearity .",
    "we also describe a technique that allows for these pulses of light to be trapped within the medium using an effective bragg grating formed by additional counter - propagating optical control fields .",
    "we show that in the limit of large optical depth the evolution of the system can be described by a nonlinear schrdinger equation .    following ref .",
    "@xcite , we consider an ensemble of atoms with the four - level internal structure shown in fig .",
    "[ fig : four_level ] , which interact with counter - propagating quantum fields with slowly - varying envelopes @xmath0 inside an optical waveguide .",
    "these fields are coupled to a spin coherence between states @xmath1 and @xmath2 via two classical , counter - propagating control fields with rabi frequencies @xmath3 largely detuned from the @xmath4 transition .",
    "the case where the fields propagate only in one direction  ( say in the `` + '' direction ) and where the detuning is zero corresponds to the usual eit system , where the atomic medium becomes transparent to @xmath5 and the group velocity can be dramatically slowed due to coupling between the light and spin wave  ( so - called `` dark - state polaritons '' ) @xcite . on the other hand , the presence of counter - propagating control fields creates an effective bragg grating that causes the fields @xmath0 to scatter into each other .",
    "this can modify the photonic density of states and create a bandgap for the quantum fields .",
    "this photonic bandgap prevents a pulse of light from propagating and can be used to effectively trap the light inside the waveguide  @xcite .",
    "the trapping phenomenon is crucial because it increases the time over which photons can interact inside the medium .",
    "the presence of an additional , far - detuned transition @xmath6 that is coupled to @xmath0 leads to an intensity - dependent energy shift of level @xmath2 , which translates into a kerr - type optical nonlinearity @xcite .",
    "we now derive the evolution equations for the quantum fields .",
    "we assume that all atoms are initially in their ground states @xmath1 . to describe the quantum properties of the atomic polarization ,",
    "we define collective , slowly - varying atomic operators , averaged over small but macroscopic volumes containing @xmath7 particles at position @xmath8 , @xmath9 the collective atomic operators obey the following commutation relations ,    @xmath10=\\frac{l}{n}\\delta(z - z')(\\delta_{\\beta\\mu}\\hat{\\sigma}_{\\alpha\\nu}(z)-\\delta_{\\alpha\\nu}\\hat{\\sigma}_{\\mu\\beta}(z)),\\ ] ]    while the forward and backward quantized probe fields in the @xmath11 direction obey bosonic commutation relations ( at equal time ) , @xmath12=\\delta(z - z').\\ ] ] the hamiltonian for this system in the rotating frame can be written as    @xmath13\\\\    & + & g\\sqrt{2\\pi}[\\hat{\\sigma}_{ba}(z)(\\mathcal{\\hat{e}}_{+}e^{ik_{0}z}+\\mathcal{\\hat{e}}_{-}e^{-ik_{0}z})+h.c.]\\nonumber\\\\   & + & g\\sqrt{2\\pi } [ \\hat{\\sigma}_{dc}(z)(\\mathcal{\\hat{e}}_{+}e^{ik_{0}z}+\\mathcal{\\hat{e}}_{-}e^{-ik_{0}z})+h.c.]\\nonumber\\\\ & + &   \\delta_{1}\\hat{\\sigma}_{bb}(z)+\\delta_{3}\\hat{\\sigma}_{cc}(z)+(\\delta_{2}+\\delta_{3})\\hat{\\sigma}_{dd}(z ) dz\\nonumber\\end{aligned}\\ ] ]    where @xmath14 is the atom - field coupling strength , @xmath15 is the atomic dipole matrix element , and @xmath16 is the effective area of the waveguide modes . for simplicity , we have assumed that the transitions @xmath17-@xmath18 and @xmath19-@xmath20 have identical coupling strengths @xmath21 and have ignored transverse variation in the fields .",
    "the terms @xmath22 denote the light field - atomic transition detunings as shown in fig .",
    "[ fig : four_level](a ) .",
    "@xmath23 is the wavevector of the control fields , while @xmath24 characterizes the fast - varying component of the quantum field and @xmath25 is the background refractive index .",
    "we also define @xmath26 as the linear density of atoms in the @xmath27 direction , and @xmath28 as the group velocity that the quantum fields would have if they were not trapped by the bragg grating  ( we will specifically be interested in the situation where @xmath29 ) . following ref .",
    "@xcite , we can define dark - state polariton operators that describe the collective excitation of field and atomic spin wave , which in the limit of slow group velocity @xmath30 are given by @xmath31 .",
    "these operators obey bosonic commutation relations @xmath32=\\delta(z - z')$ ] .",
    "the definition of the polariton operators specifies that the photon flux entering the system at its boundary is equal to the rate that polaritons are created at the boundary inside the system  _",
    "i.e. _ , @xmath33 . in other words ,",
    "excitations enter  ( and leave ) the system as photons with velocity @xmath19 , but inside the waveguide they are immediately converted into polariton excitations with group velocity @xmath34 .",
    "field correlations will also be mapped in a similar fashion  in particular , correlation functions that we calculate for polaritons at the end of the waveguide @xmath35 will also hold for the photons transmitted from the system .",
    "the total number of polaritons in the system is given by @xmath36 .",
    "the optical fields coupled to the atomic coherences of both the @xmath37 and @xmath38 transitions are governed by maxwell - bloch evolution equations , @xmath39     transition gives rise to a kerr - type nonlinearity .",
    "( b ) the light is confined in the transverse direction due to the presence of the waveguide and experiences an effective bragg grating due to the presence of the counter - propagating light.,title=\"fig:\",scaledwidth=40.0% ]   transition gives rise to a kerr - type nonlinearity .",
    "( b ) the light is confined in the transverse direction due to the presence of the waveguide and experiences an effective bragg grating due to the presence of the counter - propagating light.,title=\"fig:\",scaledwidth=40.0% ]    similar to the photonic operators , the atomic coherences can also be written in terms of slowly - varying components , @xmath40 we note that higher spatial orders of the coherence are thus neglected . in practice ,",
    "these higher orders are destroyed due to atomic motion and collisions as atoms travel distances greater than an optical wavelength during the typical time of the experiment  @xcite .",
    "alternatively , one can use dual - v atomic systems that do not require this approximation @xcite .    in the weak excitation limit",
    "@xmath41 , the population in the excited state @xmath42 can be neglected , @xmath43 . in this limit",
    ", the evolution of the atomic coherence is given by @xmath44 where @xmath45 and @xmath46 is the total spontaneous emission rate of state @xmath18  ( for simplicity we also assume that state @xmath20 has an equal spontaneous emission rate ) .",
    "in the adiabatic limit where @xmath47 , the coherence @xmath48 can be approximated by    @xmath49    therefore , the spin wave evolution can be written as , @xmath50",
    "we now consider the situation where @xmath29 , such that the counter - propagating control fields form a standing wave . in the adiabatic limit @xcite , and keeping all terms up to third order in the quantum fields , substituting these results into eq .",
    "( [ eq : maxwellbloch ] ) and simplifying yields the following evolution equations for the dark - state polariton operators , @xmath51 \\\\ ( -c\\partial_{z}+\\partial_{t})\\hat{\\psi}_{-}&=&+\\frac{\\xi}{2}(\\hat{\\psi}_{+}-\\hat{\\psi}_{-})-\\frac{\\eta}{2}\\partial_{t}(\\hat{\\psi}_{+}+\\hat{\\psi}_{-})\\nonumber\\\\ & -&i\\delta_{n}[(\\hat{\\psi}_{+}^{\\dagger}\\hat{\\psi}_{+}+\\hat{\\psi}_{-}^{\\dagger}\\hat{\\psi}_{-})(\\hat{\\psi}_{+}+\\hat{\\psi}_{-})\\nonumber\\\\ & + & ( \\hat{\\psi}_{+}^{\\dagger}+\\hat{\\psi}_{-}^{\\dagger})(\\hat{\\psi}_{+}+\\hat{\\psi}_{-})\\hat{\\psi}_{-}],\\label{eq : coupled_mode}\\end{aligned}\\ ] ] where the linear dispersion is characterized by @xmath52 .",
    "the nonlinearity coefficient is given by the single photon ac - stark shift : @xmath53 .",
    "we note that the wave - vector mismatch @xmath54 has been compensated for by a small extra two - photon detuning equal to @xmath55 .",
    "the above equations describe the evolution of two coupled modes .",
    "it is convenient to re - write these equations in terms of the anti - symmetric and symmetric combinations @xmath56 and @xmath57 . for large optical depths",
    ", we then find that the anti - symmetric mode adiabatically follows the symmetric mode , @xmath58 . in this limit",
    ", the evolution of the whole system can be described by a single nonlinear schrdinger equation ,    @xmath59    physically , the coupling between @xmath60 induced by the bragg grating causes them to no longer behave independently , much like the two counter - propagating components of an optical cavity mode .",
    "we can write the above equation in dimensionless units by introducing a characteristic length scale @xmath61|=c(\\delta_{1}^{2}+\\gamma{}^{2}/4)/2\\pi g^{2}n_{0}|\\delta_{1}|}$ ] and time scale @xmath62|=(\\delta_{1}^{2}+\\gamma{}^{2}/4)/2\\omega^{2}|\\delta_{1}|}$ ] .",
    "@xmath63 corresponds to the length over which the field acquires a @xmath64-phase in the propagation .",
    "the dimensionless nlse then reads    @xmath65    where for @xmath66 , the effective mass is @xmath67 and the nonlinearity coefficient is @xmath68 .",
    "note that @xmath69 and @xmath70 are also in units of @xmath71 , such that @xmath72=\\delta(\\tilde{z}-\\tilde{z}')$ ] . for simplicity ,",
    "we omit tilde superscripts in the following",
    ". we can also write the nonlinear coefficient as @xmath73 , where we have identified @xmath74 as the spontaneous emission rate into the guided modes  ( @xmath75 ) .",
    "we are primarily interested in the limit @xmath76 such that @xmath77 are mostly real and the evolution is dispersive .",
    "note that in this notation , the anti - symmetric combination of forward and backward polaritons is given by @xmath78 .",
    "in this section , we investigate the linear transmission properties of the signal field as a function of its frequency .",
    "the control field leads to a bragg grating that couples the forward and backward components of the signal field together .",
    "we show that the system therefore acts as an effective cavity whose _ finesse _ is determined by the optical density of the atomic medium .    for the linear case ( @xmath79 ) , it is sufficient to treat the forward and backward field operators as two complex numbers . in the slow light regime ( @xmath80 ) , the coupled mode equations  ( eqs .",
    "[ eq : coupled_mode ] ) can be written in the fourier domain , with our dimensionless units , as @xmath81 where @xmath82 and @xmath83and @xmath84 is the dimensionless two - photon detuning @xmath85 .",
    "we specify that a classical field @xmath86 enters the system at @xmath87 with no input at the other end of the system  ( @xmath88 ) , @xmath89 , as shown in  fig .",
    "[ fig : four_level](b ) .",
    "we note that @xmath90 is the length of the system in units of the coherence length introduced earlier . for negligible losses  ( @xmath91 ) and",
    "@xmath66 , @xmath92 and the profile of forward - going polaritons inside the system will look like :    @xmath93+(1+\\delta)\\sin[(d - z)\\sqrt{\\delta}]}{2i\\sqrt{\\delta}\\cos[d\\sqrt{\\delta}]+(1+\\delta)\\sin[d\\sqrt{\\delta}]}.\\ ] ]    therefore , for a system with fixed length @xmath20 , the transmission coefficient varies with the frequency of the incident field , with transmission resonances occurring at the values @xmath94  ( @xmath95 is an integer ) . at these resonances , the system transmittance is equal to one ( @xmath96 ) and a field build - up occurs inside the medium with a bell - shaped profile , similar to a cavity mode  ( see fig .",
    "[ fig : linear ] ) .",
    "the positions of these resonances  ( quadratic in @xmath95 ) reflect the quadratic dispersion in eq .",
    "( [ eq : nlse ] ) .",
    "note that in real units , the positions of the resonances will depend on the amplitude of the control field , since @xmath97 . in the limit of a coherent optically large system ( @xmath98 ) , the intensity amplification in the middle of the system is equal to @xmath99 for the first resonance .",
    "in other words , the bragg scattering creates a cavity with an effective finesse proportional to the square of the coherent length of the system ( @xmath100 ) .",
    "we now derive the width of the first transmission resonance . for small variations",
    "@xmath101 around the resonance frequency , we can write @xmath102 therefore , the width of the resonances  ( say where it drops by half ) is given by @xmath103 we have kept terms up to second order in @xmath104 , since the first order term does not give a decreasing correction to the transmittance . while we have previously ignored absorption  ( as determined by the real part of @xmath105 ) , we can estimate that its effect is to attenuate the probe beam transmission by a factor @xmath106 . as it is shown in fig .",
    "[ fig : trans_beta_od ] , for large optical densities , @xmath107 can fully characterize the transmission coefficient on resonance @xmath108 ) .",
    "in particular , for a fixed @xmath107 , the resonant transmission is constant for any large optical density . in other words , since the optical depth of the system is given by @xmath109 , the transmittivity of the system remains constant for any @xmath110 with the choice @xmath111 . in this case",
    "the effective cavity finesse for the system becomes proportional to the optical density , _",
    "i.e. _ , @xmath112",
    ".     transition which are plotted for three different loss rates @xmath113 .",
    "( b ) when the system is tuned on a transmission resonance ( @xmath94 ) , the field inside the medium is amplified.,scaledwidth=45.0% ]    ) , only depends on @xmath114 .",
    ", scaledwidth=40.0% ]    the total number of polaritons in the system can be estimated by ,    @xmath115    this again shows that the polaritons experience many round trips inside the system before exiting .",
    "in particular , if we define the average intensity inside the medium as @xmath116 , then we readily observe that the intensity of the polariton field is amplified inside the medium by the square of the system size @xmath117  _ i.e. _ the finesse is proportional to the optical density ( od ) .",
    "the original proposal for observing an enhanced kerr nonlinearity with a four - level atomic system using eit makes use of an optical cavity to enhance the nonlinearity  @xcite .",
    "however , as pointed out in ref .",
    "@xcite , the scheme suffers from some inaccuracies in the effective hamiltonian .",
    "more specifically , in ref .",
    "@xcite , the effective hamiltonian was evaluated at the center of the eit transparency window . however , in practice , eit dramatically decreases the cavity linewidth because of the large dispersion that accompanies the vanishing absorption  @xcite ; this causes photons at frequencies slightly shifted from the central frequency to be switched out of the cavity .",
    "this leads to an extremely small allowable bandwidth for the incoming photons  @xcite and was neglected in the original analysis .",
    "we emphasize that the analysis presented here takes into account the dispersive properties of the medium , as we have included the field dynamics up to second order in the detuning from resonance  ( this accounts for the effective mass of the photons in our system ) .",
    "we verify the consistency of this derivation in appendix  [ sec : eit - bandgap ] by solving the linear system including full susceptibilities .",
    "it is shown that the results are consistent near the two - photon resonance ( _ i.e. _ , frequencies around @xmath118 ) .",
    "in this section , in contrast to the previous section , we include the nonlinear term in the evolution equations to investigate its effect in the semi - classical limit  ( where the fields are still treated as complex numbers ) . in this picture",
    ", the effect of nonlinearity causes the transmission peaks to shift in frequency in an intensity - dependent way to the left or right depending on the sign of the nonlinearity coefficient @xmath119 .",
    "we show that when @xmath120 , the magnitude of the shift is large even at intensities corresponding to that of a single photon . in this regime",
    ", we expect that the system can act as a single - photon switch and that signatures of quantum transport will become apparent  ( the quantum treatment is described in sec.[sec : quantum_formalism ] ) .    because of the self - phase modulation term in the evolution equations  ( eqs .",
    "[ eq : coupled_mode ] ) , the forward and backward fields acquire a phase shift proportional to their intensity .",
    "moreover , due to the conjugate - phase modulation terms , each field undergo an extra phase shift proportional the intensity of the other field .",
    "classically , this yields a frequency shift in the transmission spectrum when the nonlinearity is small .",
    "the shift in the transmission peak can be approximated by @xmath121 where @xmath122 is the average intensity of polaritons in the system .",
    "suppose that we want the nonlinearity to be strong enough to shift the transmission peaks at least by half of their widths , @xmath123 .",
    "then , from eq.([eq : width ] ) this condition can be written as    @xmath124    on the other hand , according to eq.([eq : number_polaritons ] ) , we can write this condition in terms of the critical number of polaritons inside the system ,    @xmath125    since the nonlinearity coefficient is given by the light shift on the @xmath6 transition , in the dispersive regime  ( @xmath126 ) , we have @xmath127 .",
    "thus , we expect to have substantial nonlinearities at the level of one polariton  ( _ i.e. _ , one incoming photon ) , @xmath128 , if    @xmath129    where @xmath130 is the rate of spontaneous emission rate into the guided modes",
    ". strictly speaking , note that a single photon can not actually have a nonlinear phase shift  ( as correctly derived later using a fully quantum picture ) ; however , we can still use the results of this semiclassical calculation to qualitatively understand the relevant physics .",
    "we can also rewrite the above condition in term of the optical density @xmath131 needed in the system . from the linear case , we know that an optimal detuning , for a transmission of 90% , should satisfy @xmath132 . then , eq .",
    "( [ eq : singlephotonnonlinearity ] ) can be written as    @xmath133    taking for example a system where @xmath134 and @xmath135 , nonlinearities at a few - photon level can be observed for an optical density @xmath136 .",
    "first , let us consider the case of positive @xmath119 . in fig .",
    "[ fig : mode_shift ] , we observe that at large enough optical density , the system can have very different transmission spectra for _ low _ and _ high _ intensities that classically correspond to having one and two polaritons ( photons ) inside the system , respectively .",
    "although we have ignored the quantization of photons in this section , we can develop some insight into the transmission properties of one- and two - photon states . loosely speaking ,",
    "if we fix the input field frequency to lie at the one - photon  ( linear ) transmission peak ( @xmath137 ) , the system would block the transmission of incident two - photon states . more realistically , suppose we drive the system with a weak classical field  ( coherent state ) , which can be well - approximated as containing only zero , one , and two - photon components .",
    "we then expect that the one - photon component will be transmitted through the system , while the two - photon component will be reflected , leading to anti - bunching of the transmitted light .",
    "we note that the general spirit of this conclusion is sound ; however , the correct description of the system is achieved by taking into account the quantization of photons which is presented in the next sections .",
    "a similar analysis holds for the case of negative @xmath119 .",
    "note that the sign of @xmath119 depends on the detuning of the photonic field from the atomic transition @xmath6 , which can easily be adjusted in an experiment .",
    "this is in contrast to conventional nonlinear optical fibers and nonlinear crystals , where the nonlinearity coefficient is fixed both in magnitude and sign .",
    "we find that a negative nonlinearity simply shifts the transmission spectrum in the opposite direction as for the positive case , as shown in fig .",
    "[ fig : negative_vs_positive ] , but all other conclusions remain the same . in particular , we would expect anti - bunching to occur for this case as well , when a weak coherent field is incident with its frequency fixed to the linear transmission resonance .",
    "surprisingly , the quantum treatment  ( sec.[sec : results ] ) , shows that the above conclusion is wrong and system behaves very differently for negative nonlinearity .",
    "we show that this difference in behavior can be attributed to the presence of additional eigenstates  ( photonic bound states ) in the medium and their excitation by the incident field .    for even larger nonlinearities or intensities , the transmission spectrum can become even more skewed and exhibit bistable behavior , as similarly found in ref .",
    "@xcite in the context of transport of bose - einstein condensates in one dimension . there",
    ", the classical nlse  ( gross - pitaevskii equation ) was solved to find the mean - field transport properties of a condensate scattering off a potential barrier .            instead of considering the switching effect as a function of number of photons inside the medium",
    ", we can also consider the number of photons that need to be sent into the system . clearly , to have a well - defined transmission amplitude without substantial pulse distortion",
    ", the incident pulse must be long enough so that it fits within the bandwidth of the system resonance , as given in eq .",
    "( [ eq : width ] ) . to be specific",
    ", we consider an input pulse whose duration is equal to the inverse of the bandwidth , @xmath138 .",
    "we can relate the number of incoming photons to an average incident intensity :    @xmath139    now , since the number of incident photons and incoming polaritons are the same , we can assign an average amplitude to any incoming photons number by eq .",
    "( [ eq : ave - intensity ] ) , and evaluate the transmission .",
    "hence , we can evaluate the number of incident photons needed to observe a significant nonlinearity and saturate the system .",
    "[ fig : transmittivity_ph_number ] shows the transmittivity of the nonlinear system as a function of number of photons in the incoming wavepacket .",
    "we observe that for high optical densities ( @xmath140 ) , the transmittivity drops as the number of incoming photons increases and the system gets saturated for even few photons .",
    "is chosen so that the system exhibit a similar transmission for one photon.,scaledwidth=45.0% ]      in this section , we investigate the system in the presence of nonlinear absorption , where @xmath119 is imaginary .",
    "the nonlinear dispersion of the previous case can simply be turned into nonlinear absorption by setting the nonlinear detuning to zero ( @xmath141 ) . in the quantum picture",
    ", this term does not affect the one - photon state , while two - photon states can be absorbed by experiencing three atomic transitions , @xmath142 , and subsequently being scattered from excited state @xmath143 @xcite .",
    "we consider the quantum treatment of absorption later and first study the semiclassical limit here .",
    "the presence of nonlinear absorption suppresses the transmission of multi - photon states through the medium by causing them to decay . this suppression becomes stronger for higher intensities as shown in fig .",
    "[ fig : transmittivity_abs ] .",
    "we have used the same optical density ( od ) and 1d confinement ( @xmath144 ) as in fig . [",
    "fig : mode_shift ] .",
    "we observe that the effects of nonlinear absorption are stronger than that of nonlinear dispersion studied in sec.[sub : semiclassical_dispersive ] , since it occurs at resonance  ( @xmath145 ) where the atomic response is strongest .",
    "it is thus possible to observe its effect at even lower intensities , corresponding to effective photon numbers two orders of magnitude smaller than the dispersive case .",
    "much like the dispersive case , the suppression of transmission of multi - photon components should yield anti - bunching in the transmitted field . in this case , however , these components are simply lost from the system  ( as opposed to showing up as a bunched reflected field ) .",
    "in this section , we describe a quantum mechanical approach that enables one to solve the problem of quantum transport of a small number of photons through the finite , nonlinear system described in sec.[sec : model ] .",
    "this few - photon number limit is of particular interest since it captures the physics of single - photon switching .",
    "we find it convenient to study the dynamics of the system of photons in the schrdinger picture , where one can explicitly solve for the few - body wave functions .",
    "this approach is made possible by truncating the hilbert space so that only subspaces with @xmath146 photons are less are present . in the following",
    ", we will consider the case where @xmath147 , although our analysis can be easily extended to cover any other value .",
    "this truncation is justified when the incident coherent field is sufficiently weak that the average photon number is much smaller than one inside the system ( @xmath148 , where @xmath149 is the amplitude of the incoming field ) .",
    "thus , we can write the general state of the system as :    @xmath150    the first , the second and the third term correspond to two - photon , one - photon and vacuum state , respectively .",
    "note that because of bosonic symmetrization , @xmath151 should be symmetric in @xmath152 and @xmath153 .",
    "this formalism allows us to capture any non - trivial spatial order between photons in our system  ( _ e.g. _ , the de - localization of two photons as represented by the off - diagonal terms in @xmath154 ) .",
    "since the nlse hamiltonian commutes with the field number operator @xmath155 , manifolds with different field quanta are decoupled from each other inside the medium .",
    "therefore , the evolution for the one - photon and two - photon manifolds under the nlse hamiltonian can be written as , + @xmath156    @xmath157    however , the system is driven with an input field at @xmath87 , which allows different manifolds to be coupled at the boundaries .",
    "this is analogous to fiber soliton experiments where a classical input field mixes quantum solitons with different photon numbers @xcite . in particular , for a classical input field , + @xmath158 which corresponds to a coherent state with  ( possibly time - dependent ) amplitude @xmath159 as an input at @xmath87 , and no input  ( _ i.e. _ , vacuum ) at @xmath88 . since we specify that the input coherent field is weak ( @xmath160 ) , the amplitude of the vacuum state is almost equal to one ( @xmath161 ) .",
    "the annihilation operator in these equations reduces the photon number on the left - hand side by one .",
    "thus , such boundary conditions relate different photon subspaces whose photon number differ by one , _",
    "e.g. _ the two - photon and one - photon wavefunctions . in the adiabatic limit where the anti - symmetric part of the field ( @xmath162 ) follows the symmetric part ( @xmath163 )",
    ", we have + @xmath164 therefore the boundary conditions at @xmath87 can be re - written as @xmath165_{z=0}s^{\\dagger}(z_{1})s^{\\dagger}(z_{2})\\phi(z_{1},z_{2},t)|0\\rangle\\nonumber\\\\ & = & \\alpha\\int dz\\theta(z , t)s^{\\dagger}|0\\rangle,\\\\ & \\frac{1}{\\sqrt{2}}&\\int dz~[s-\\frac{i}{2m}\\partial_{z}s]_{z=0}s^{\\dagger}(z)\\theta(z , t)|0\\rangle=\\alpha|0\\rangle.\\nonumber \\end{aligned}\\ ] ] using the identity @xmath166f(z')dz'=\\partial_{z}f(z)$ ] , the boundary conditions on the one - photon and two - photon wave functions can be written as : + @xmath167 where @xmath168 acts on the first parameter .",
    "this type of open boundary condition is known as a robin or mixed boundary condition , which involves a combination of both the function and its derivative . in the present case ,",
    "the open boundary conditions allow particles to freely _ enter _ and _ leave _ the system .",
    "we emphasize that this process is noise - less , in that the loss of population from the interior of our system is related by our boundary condition equations to the flow of particle current through the system boundaries .",
    "this is in contrast to an optical cavity , for instance , where photons inside the cavity leak @xmath169 into the environment @xcite .",
    "similarly the boundary condition at @xmath88 reads @xmath170 given the boundary conditions and the equations of motion in the interior , we can completely solve for the photon wavefunctions .",
    "once the wavefunctions are determined , it is possible to determine the intensity profile as well as any other correlation function for the photons .",
    "for example , the intensity of the forward - going polariton is    @xmath171    where @xmath172 denotes the component of the total wavefunction @xmath173 containing @xmath174 photons .",
    "the first and second terms on the right thus correspond to the one- and two - photon contributions to the intensity .",
    "by re - writing expressions in terms of @xmath175 instead of @xmath176 , we obtain :    @xmath177    similarly , the second - order correlation function for the forward field is @xmath178 which in our truncated space only depends on the two - photon wave function .",
    "now , we evaluate the normalized second - order correlation function @xmath179 , which characterizes the photon statistics of an arbitrary field . this function takes the form @xmath180 and physically characterizes the relative probability of detecting two consecutive photons at the same position @xmath8 . if this quantity is less ( greater ) than one , the photonic field is anti - bunched ( bunched ) . in particular , if @xmath181 , the field is perfectly anti - bunched and there is no probability for two photons to overlap in position . in our truncated hilbert space , @xmath179 of the transmitted field",
    "is given by    @xmath182    we note that this expression can be simplified , since at @xmath88 , we have @xmath183 and @xmath184 .",
    "therefore ,    @xmath185    we can also evaluate the stationary two - time correlation , which is defined in the heisenberg picture as :    @xmath186    where the denominator is simplified in the stationary steady - state regime .",
    "this correlation function characterizes the probability of detecting two photons at position @xmath8 but separated by time @xmath187",
    ". we can re - write @xmath188 in terms of wavefunctions in the schrdinger picture in the following way .",
    "we first note that the expression @xmath189 appearing in the equation above can be thought of as a new wavefunction , which describes the state of the system after a photon is initially detected at time @xmath190 and position @xmath8 .",
    "this new state naturally has one less photon than the original state , and by simplifying the expressions , it can be written as :    @xmath191    where the new one - photon and vacuum amplitudes are given by + @xmath192 here we have assumed that @xmath88 , since we are interested in the transmitted field .",
    "now , eq .  ( [ eq : g2tau ] ) can be written as @xmath193 the numerator describes the expectation value for the intensity operator @xmath194 in the heisenberg picture given an initial state @xmath195 .",
    "however , we can easily convert this to the schrdinger picture by moving the evolution from the operator to the state , _",
    "i.e. _ , by evolving @xmath195 under the same evolution equations ( eqs .",
    "[ eq : two_photon]-[eq : one_photon ] ) and boundary conditions ( eq .  [ eq : boundary_condition ] ) that we used earlier . therefore , the correlation function @xmath188 will be given by :    @xmath196",
    "in this section , we show that a nlse system with open boundary conditions yields analytical solutions in absence of an outside driving source ( @xmath197 ) . to obtain the analytical solutions",
    ", we use the bethe ansatz technique  @xcite .",
    "this ansatz specifies that the eigenstates consist of a superposition of states in which colliding particles exchange their wavenumbers @xmath198 . unlike the typical formulation",
    ", the values of @xmath199 here can be complex to reflect the _ open _ nature of our boundary conditions , which allow particles to freely enter or leave .",
    "in particular , we present the one- , two- and many - body eigenmodes of the system along with their energy spectra .",
    "finding certain eigenmodes of the system ( _ e.g. _ , bound states ) helps us understand the correlation functions and also spatial wavefunctions which are numerically calculated later in sec.[sec : results ] for a driven system .",
    "first , we calculate the fundamental modes for the one - particle states .",
    "these modes are of particular interest when we later want to construct the many - body wavefunction of the interacting system in the absence of an input field .",
    "specifically , we want to find solutions of the schrdinger equation for a single particle in a system of length @xmath20 ,    @xmath200    subject to open boundary conditions .",
    "the boundary condition for the undriven system at @xmath87 is given by    @xmath201    and similarly for @xmath88 , @xmath202 we look for stationary solutions of the form @xmath203 , where @xmath204 .",
    "for simplicity , we assume @xmath205 therefore , we recover the quadratic dispersion relation @xmath206 .",
    "the values of @xmath207 are allowed to be complex to reflect the open nature of our boundary conditions , which allows particles to freely enter or leave . by enforcing the boundary conditions we get a set of equations for the coefficients @xmath208 , @xmath209 which yields the characteristic equation for finding eigenmodes and eigen - energies of system ,    @xmath210    therefore the normalized corresponding wave function for each allowed _",
    "k _ will be :    @xmath211    we note that in the limit of large optical density @xmath98 , the lowest energy modes of the open system are very close to those of a system with closed boundary conditions , whose characteristic equation is given by @xmath212 .",
    "for example , at @xmath213 , the wave number corresponding to lowest energy is @xmath214 .",
    "we note that the many - body solutions of the system in the presence of very strong interactions  ( large @xmath119 ) can be constructed from these single - particle solutions and proper symmetrization , as we show in sec.[sec : many_body ] .      in this section ,",
    "we study the problem of two particles obeying the nlse with mixed boundary conditions .",
    "we wish to solve @xmath215 where @xmath216 is the energy of the system and can be complex .",
    "again , we assume the mass is entirely real , @xmath217",
    ".    we should note that the conventional method of separation of variables can not be applied in this case .",
    "the reason for this can be understood in the following way .",
    "on one hand , if we ignore the delta interaction term in the evolution equation of the two particles , finding the eigenfunctions is essentially equivalent to solving the laplace equation in a box with mixed boundary conditions",
    ". therefore , for this problem the natural separation of variables involves solutions given by products of functions @xmath218 and @xmath219 . on the other hand , if we neglect the boundaries , the problem of two particles interacting at short range can be solved by utilizing the center of mass and relative coordinates and invoking solutions involving products of functions @xmath220 and @xmath221 .",
    "we immediately see that the two sets of solutions are irreconcilable and thus separation of variables is not applicable when both the boundary conditions and interaction term are present .",
    "we thus take a different approach , using a method similar to the bethe ansatz method for continuous , one - dimensional systems  @xcite .",
    "specifically , we solve the schrdinger equation in the triangular region where @xmath222 , and we treat the interaction as a boundary condition at @xmath223 . in other words , when two particles collide with each other at @xmath223 , they can exchange momenta , which is manifested as a cusp in the wave function at @xmath223 . hence , for the boundary conditions in this triangular region , we have    @xmath224    we note that the last boundary condition is deduced from integrating eq .",
    "( [ eq : two_body ] ) across @xmath225 and enforcing that the wavefunction is symmetric , @xmath226 inside the triangle , the solution consists of superpositions of _ free _ particles with complex momenta .",
    "since particles can exchange momenta when they collide at @xmath225 , we should consider solutions of the following form ,",
    "@xmath227    where the summation should be performed on all sets of signs @xmath228 . given the terms containing @xmath229 , the terms @xmath230 then arise from the scattering of the particles off each other .",
    "let s first consider the portion of the wavefunction containing the terms @xmath229 , which we can write in the form : @xmath231 where the energy is equal to @xmath232 and could be complex .",
    "similar to the single - particle solutions , the presence of the imaginary part in the energy reflects the fact that the two - particle state stays a finite amount of time inside the system . applying boundary conditions at @xmath87 and @xmath88",
    "subsequently generates four equations relating @xmath233 where one of them is redundant .",
    "their solution reduces the wavefunction to @xmath234 where @xmath235 . a similar expression results for the portion of @xmath236 containing the @xmath230 terms , once the boundary conditions at @xmath87 and @xmath88 are applied : @xmath237 where @xmath238 , and @xmath239 is a coefficient to be determined from the boundary condition at @xmath225 .",
    "to find @xmath239 , it is convenient to re - write each of ther terms in @xmath240 as a product of relative coordinate  ( @xmath241 ) and center - of - mass coordinate  ( @xmath242 ) functions , @xmath243 @xmath244 where @xmath245 and @xmath246 .",
    "the boundary condition at @xmath225 leaves the center - of - mass parts of the wavefunction unaffected , but yields the following condition on the relative coordinates , @xmath247 where @xmath248 is the total wavefunction in the triangular region .",
    "we should satisfy this boundary condition separately for each of the center - of - mass momentum terms @xmath249 in the total wavefunction .",
    "this leads to three independent equations ( one out of four is redundant ) .",
    "however , we introduce a new parameter ( @xmath250 ) to simplify the equations , which turns them into four equations :    @xmath251    which can be written in the following short form :    @xmath252    where @xmath253 can be ( 1,2 ) . these are transcendental equations for ( @xmath254 ) , which generate the spectrum of two interacting particles",
    ". we can also write the wave functions ( @xmath255 ) in the region ( @xmath256 in a more compact way , by using the single particle solutions @xmath257 :    @xmath258    it is interesting to note that in the limit of strong interaction ( either for positive or negative @xmath119 ) , the solutions are very similar to the non - interacting case .",
    "the reason can be seen from the transcendental eqs .",
    "( [ eq : transcedent ] ) , in the limit @xmath259 .",
    "we then recover the same characteristic equations @xmath260 for both wavevectors as the non - interacting case , eq .",
    "( [ eq : trans_noninteracting ] ) .",
    "we should note that there are some trivial solutions to the transcendental eqs .",
    "( [ eq : transcedent ] ) , which do not have any physical significance . for example , equal wave vectors @xmath261 .",
    "although one can find such wave vectors , this solution is readily not a solution to eq.([eq : two_body ] ) , since it does not satisfy the interacting part ( this solution only contains center of mass motion ) .",
    "one can also plug back the wave vectors into wave function and arrive at a wave function equal to zero everywhere .",
    "another example is when one of the wave vectors is zero . in this case",
    ", one can also show that the wave function is zero everywhere .",
    "if @xmath262 are solutions to the transcendental equations , then @xmath263 are also solutions with equal energies . in next two sections ,",
    "we investigate non - trivial solutions to the transcendental equation for two particles and discuss the related physics .",
    "the transcendental equations allow a set of solutions with the wavevectors close to two different non - interacting modes say @xmath264 . in the non - interacting regime ,",
    "any mode can be populated by an arbitrary number of photons . however , once the interaction is present , photons can not occupy the same mode and therefore , the photons will _ reorganize _ themselves and each acquire different modes .",
    "[ fig : wavefunction_different_modes ] shows a normal mode wavefunction of a non - driven system in both non - interacting and strongly interacting regime ( @xmath265 ) .",
    "the wave function has a cusp on its diagonal and diagonal elements are depleted for both repulsive and attractive strong interaction .",
    "this is a manifestation of _ fermionization _ of bosons in one dimensional system in the presence of strong interaction @xcite .",
    "such solutions can exist both for repulsive and attractive interactions .",
    "however , we note in the case of attractive interaction such solutions are not the ground state of the system and solutions with lower energies exist which will be discussed below .",
    "we later argue that indeed on the repulsive side , the anti - bunching behavior of a driven system is due to the repulsion of the photons inside the medium .",
    "we can also estimate the energy of such modes which is always positive . in the strong interacting regime , particles avoid each other and therefore , their energy of a strongly two interacting bosons @xmath266 will be equal to the energy of a system which has two non - interacting bosons , one in state @xmath267 and the other in state @xmath95 .",
    "this is shown in fig .",
    "[ fig : energy_different_modes ] , where by increasing the interaction strength the energy of interacting particles reaches that of the non - interacting particles . as we pointed out in the previous section ( sec.[sec : one_body ] ) , the energy of modes ( @xmath268 ) in an open box has an imaginary part which represents how fast the particle leave the system .",
    "however , for large systems ( @xmath98 ) , this decay is very small compared to the energy of the mode and one can approximate the energy of an open system by that of a closed box ( i.e. @xmath269 ) .",
    "therefore , the energy of two strongly interacting photons ( @xmath265 ) , in the limit of large system ( @xmath98 ) , will be given by : @xmath270    we note that our strongly interacting system is characterized by the parameter @xmath271 which is the same @xmath272-parameter conventionally used for interacting 1d bose gas .",
    "more precisely , the @xmath272-parameter which is the ratio of the interaction to kinetic energy can be simplified in our case for two particles : @xmath273 .",
    ".,scaledwidth=45.0% ]    ) the energy of interacting particles ( red : e(1,2 ) and blue : e(1,3 ) ) reaches that of the non - interacting particles ( black ) . for large system ( in this case @xmath274 ) , the energy limit is equal to energy of particles in a closed box ( green ) .",
    "the error bars show that imaginary part of the energies . ]      for attractive interaction ( @xmath275 ) , the mode equation  ( [ eq : transcedent ] ) admits solutions which take the form of photonic bound states .",
    "specifically , in the reference frame of the center of mass , two particles experience an attractive delta function interaction @xmath276 , which allows one bound state in the relative coordinate .",
    "therefore , the part of the wavefunction describing the relative coordinate roughly takes the form @xmath277 , where the relative momentum @xmath278 is imaginary and its energy is about @xmath279 . on the other hand , the center of mass momentum can take a discrete set of values that are determined by the system boundary conditions .",
    "we find that the center of mass solutions can be approximately described by two different types .",
    "the first type is where the real part of each photon wavevector roughly takes values allowed for a single particle in a box , such that @xmath280 and @xmath281 . in this case",
    "the center of mass has wavevector @xmath282 .",
    "the corresponding energies for these states are    @xmath283    here , the first term on the right corresponds to the energy of the center of mass motion , and the second term corresponds to the bound - state energy of the relative motion .",
    "[ fig : energy_bound_state_single ] shows that the energies estimated in this way agree very well with the exact values obtained by solving the transcendental eqs .",
    "( [ eq : transcedent ] ) .    ) .",
    "blue ( dashed ) curves are estimated based on @xmath284 . in this plot @xmath285 .",
    ", scaledwidth=40.0% ]    . for this plot : @xmath286.,scaledwidth=45.0% ]    the second type of solution allowed for the center of mass motion is where its energy approximately takes a single - particle value , @xmath287 where @xmath288 .",
    "therefore , the momentum of individual particles will be given by @xmath289 , @xmath290 and the energy of this paired composite can be estimated as @xmath291 again , the estimated energies agree well with exact solutions , as shown in fig .",
    "[ fig : energy_bound_state_single ] .",
    "we note that some of the estimated allowed energies for the two types of center of mass solutions coincide ( _ e.g. _ , the lowest lying energy level in fig .",
    "[ fig : energy_bound_state_double ] and fig .",
    "[ fig : energy_bound_state_single ] ) .",
    "the energies of this series of bound states decrease with increasing strength of nonlinearity @xmath292 . now , suppose we drive the system with a coherent field of fixed frequency @xmath84 , while varying @xmath119 .",
    "the system is expected to display a set of resonances as @xmath292 is increased , each time @xmath84 is equal to some particular bound state energy @xmath293 .",
    "this effect in fact gives rise to oscillatory behavior in the correlation functions as a function of @xmath119 , as we will see later ( fig .",
    "[ fig : attractive](a ) and ( b ) ) .",
    "the wavefunction amplitude of a typical bound state is shown in fig .",
    "[ fig : wavefunction_bound_state_single ] . due to the attractive interaction , diagonal elements",
    "@xmath225 become more prominent as @xmath292 increases , indicating a stronger bunching effect for the photons , and these states become more tightly bound in the relative coordinate .",
    "the center of mass of the bound states can acquire a free momentum that is quantized due to the system boundary conditions  ( _ e.g. _ , @xmath294 ) .",
    "[ fig : wavefunction_bound_state_single ] shows the wavefunction of the third bound state ( n=3 ) .",
    "the three peaks evident for large @xmath292 reflect the quantum number of the center of mass motion .    ) .",
    "blue ( dashed ) curve are estimated based on @xmath295 . in this plot @xmath285 .",
    ", scaledwidth=40.0% ]    . for this plot : @xmath286.,scaledwidth=45.0% ]      in this section , we obtain the general solution for the many - body case . for the many - body system",
    ", the schrdinger equation takes the form    @xmath296    where @xmath297 indicates pairs of particles .",
    "the open boundary conditions for the many - body problem are given by    @xmath298_{z_{i}=0 } & = & 0\\label{eq : boundary_many_a}\\\\ \\left[\\phi(z_{1}, ... ,z_{n})+i\\frac{\\partial}{\\partial",
    "z_{i}}\\phi(z_{1}, .. ,z_{n})\\right]_{z_{i}=d } & = & 0.\\label{eq : boundary_many_b}\\end{aligned}\\ ] ]    before presenting the general many - body solution , we first study the limit of very large interaction strength for two particles . in the limit of hardcore bosons where @xmath299 ,",
    "the expressions can be simplified since @xmath300 and @xmath301 for both @xmath302 .",
    "then , the two components of the wavefunction @xmath303 and @xmath304 take very similar forms ,    @xmath305    the generalization to the many - body solution is straightforward for the hardcore boson case ( also see ref .",
    "@xcite ) : @xmath306 similar to two - body solution , we note that such solutions are present both for positive and negative @xmath119 .",
    "since the system is one dimensional , strong interaction leads to fermionization of bosons ( in this case photons)@xcite .    we can also extend the many solution for an arbitrary interaction strength , following refs.@xcite .",
    "similar to the two - body case , we can construct the general many - body wave function of the form : @xmath307 where the first sum is over forward and backward going waves @xmath3081 ) and the second sum is over different momentum permutations of the set @xmath309 , therefore there are @xmath310 terms .",
    "we can find @xmath311 coefficient by requiring @xmath312 to be solution to the schrdinger equation ( eq.[eq : many_body ] ) .",
    "we can write these coefficients in a compact way according to gaudin @xcite , @xmath313 with the total energy @xmath314 .",
    "now , we apply the boundary condition eq.([eq : boundary_many_a ] ) which relates coefficient @xmath315 . for a given momentum permutation @xmath316 , by considering the terms corresponding to different signs of @xmath317",
    ", the boundary condition requires @xmath315 to satisfy equations of the form@xmath318 the above equations can be satisfied by the following solution for @xmath315 @xmath319 therefore , the wavefunction can be written as : @xmath320}\\nonumber \\\\ & \\times & \\prod_{i < j}\\left[\\left(1-\\frac{i\\kappa}{\\epsilon_{i}k_{i}+\\epsilon_{j}k_{j}}\\right)\\left(1+\\frac{i\\kappa}{\\epsilon_{p_{i}}k_{p_{i}}-\\epsilon_{p_{j}}k_{p_{j}}}\\right)\\right]\\nonumber\\end{aligned}\\ ] ] similar to two - body case , we have to subject this solution to the boundary condition at other end ( i.e. , @xmath88 ) to determine the momenta @xmath199 s .",
    "this condition yields the transcendental equations for momenta : @xmath321 if we assume only two particles in the system , one can easily verify the the above transcendental equations reduce to two - body transcendental equation derived in the previous section ( eq.([eq : transcedent ] ) ) .",
    "in this section , we investigate transport properties of the photonic nonlinear one - dimensional system in the regimes of attractive , repulsive , and absorptive interactions between photons .",
    "we present numerical solutions for the transport of photons incident from one end of the waveguide  ( a driven system ) , while using the analytical solutions of the non - driven system ( sec .",
    "[ sec : analytical ] ) to elucidate the various behaviors that emerge in the different regimes .",
    "we first study the quantum transport properties of the system in the dispersive regime where the nonlinearity coefficient is almost real and positive @xmath322 , such that photons effectively _ repel _ each other inside the system .",
    "we assume that a weak coherent field is incident to the waveguide at one end , @xmath87 , with no input at the other end , @xmath88  [ similar to fig .",
    "[ fig : four_level](b ) ] .",
    "we fix the detuning of the input field to @xmath323 , which corresponds to the first transmission resonance in the linear regime ( sec .",
    "[ sec : linear ] ) .",
    "because we have assumed a weak input field , we can apply the techniques described in sec .",
    "[ sec : quantum_formalism ] to describe the transport .",
    "our numerical techniques for solving these equations are given in appendix  [ sec : numerics ] . while the numerical results presented in this and the following sections are evaluated for a specific set of parameters ( system size , detuning , etc . ) , the conclusions are quite general .",
    "numerically , we begin with no photons inside the medium , and evaluate quantities such as the transmission intensity and correlation functions only after the system reaches steady state in presence of the driving field . in fig .  [",
    "fig : filter_dispersive ] , the transmission of the single - photon intensity @xmath324 the transmission of the two - photon intensity @xmath325 and the transmitted correlation function @xmath326 is shown as the system evolves in time .",
    "the system reaches its steady state after a time of the order of the inverse of the system bandwidth ( sec .",
    "[ sec : linear ] ) .",
    "in fact , @xmath327 coincides with the linear transmission coefficient of the system in the absence of the nonlinearity .     reaches the steady - state after a time interval which is set by the bandwidth of the system , one - photon state ( green )",
    "is partially transmitted while the transmission of the two - photon state ( red ) is further suppressed due the nonlinear dispersion .",
    "this has been generated for a system with @xmath328 an od=160.[fig : filter_dispersive],scaledwidth=40.0% ]    first , we note that the single - photon wave function is not affected by the presence of the nonlinearity and will be perfectly transmitted in the absence of linear losses .",
    "thus , in our truncated hilbert space , the only subspace affected by @xmath119 is the two - photon wave function , which is shown in fig . [",
    "fig : quantum_repulsive ] .",
    "we clearly observe that the nonlinearity causes repulsion between two photons inside the system , as the wave function along the diagonal @xmath223 becomes suppressed while the off - diagonal amplitudes become peaked  ( indicating the de - localization of the photons ) .",
    "this behavior closely resembles that of the natural modes of the system , as calculated in sec .",
    "[ sec : analytical ] .",
    "a similar behavior involving the `` self - organization '' of photons in an nlse system in equilibrium has been discussed in ref .",
    "@xcite .     exhibiting delocalization .",
    "we have assumed no dissipation ( @xmath329 ) in this plot .",
    "@xmath285 for different values of @xmath119.[fig : quantum_repulsive],scaledwidth=45.0% ]    in the presence of linear absorption ( discussed in sec .",
    "[ sec : linear ] ) , the system will not be perfectly transmitting even on resonance , and therefore in a realistic situation the transmittivity will be less than one @xmath330 .",
    "note , however , that such absorption would result in a classical output given a classical input . significantly , in the presence of a nonlinearity , we find that the output light can acquire non - classical character .",
    "specifically , the transmitted light exhibits anti - bunching  ( @xmath331 ) , which becomes more pronounced with increasing @xmath332 ( fig .",
    "[ fig : repulsive_scaling_d ] ) .",
    "this effect partly arises from the suppression of transmission of two - photon components , due to an extra nonlinear phase shift that shifts these components out of transmission resonance .",
    "in fact , these components are more likely to get reflected , which causes the reflected field to subsequently exhibit bunching behavior .",
    "we note that this effect is similar to photon blockade in a cavity ( e.g. , see refs.@xcite ) .",
    "in addition , additional anti - bunching occurs due to the fact that two - photon components inside the system tend to get repelled from each other .",
    "this effect arises due to the spatial degrees of freedom present in the system , which is fundamentally different than switching schemes proposed in optical cavities ( e.g. , refs.@xcite ) or wave - guides coupled to a point - like emitter @xcite . in the limit where @xmath299 , the transmitted field approaches perfect anti - bunching , @xmath333 .     as a function of nonlinearity .",
    "for large system sizes @xmath98 , the anti - bunching of the system scales with @xmath334.,scaledwidth=45.0% ]    in an experimental realization , the requirement to see the photon repulsion ( @xmath335 ) for a system with @xmath328 , would be a coherent optical length of @xmath336 when @xmath337 .",
    "therefore , at least an optical density of @xmath338 is needed for @xmath339 .",
    "the anti - bunching in the transmitted light is more pronounced as the optical density increases , which increases the effective system finesse ( fig .",
    "[ fig : repulsive_scaling_od ] ) .     of the transmitted light when the frequency is set to the single - photon transmission resonance with @xmath340 and @xmath341 . ]      in this section , we study the quantum transport properties of the system in the presence of dispersive nonlinearity with negative coefficient . contrary to the semi - classical prediction , we show that the second - order correlation function of the transmitted field oscillates as function of nonlinear interaction strength and can exhibit both bunching and anti - bunching .",
    "we explain the origin of this behavior in terms of the analytical solutions obtained in sec .",
    "[ sec : two_body ] .    in fig .",
    "[ fig : attractive](a ) , we plot @xmath343 for the transmitted field versus @xmath344 .",
    "initially , the system exhibits anti - bunching behavior for small values of @xmath345 which indicates that multi - photon components tend to switch themselves out of transmission resonance .",
    "however , as we increase @xmath345 , oscillations develop in the correlation function , exhibiting strong bunching behavior at particular values of @xmath344 .",
    "thus , unlike the repulsive case , a competing behavior arises between the photon switching effect and the resonant excitation of specific bound states within the system , as we describe below .",
    "in particular , the bound state energies @xmath346 decrease quadratically with changing @xmath119 , according to eq .",
    "( [ eq : bound_energy_single ] ) or eq.([eq : bound_energy_double ] ) , which is shown in fig .",
    "[ fig : attractive](b ) . for a fixed detuning @xmath84 , the oscillation peaks  ( where @xmath347 is largest ) correspond to situations where the energy of a bound state becomes equal to the energy of two incoming photons ( @xmath348 ) .",
    "this effect is further confirmed by examining the two - photon wave function at each of these oscillation peaks  ( fig .",
    "[ fig : attractive]a ) .",
    "we clearly observe that these wave functions correspond to the bound states calculated in sec .",
    "[ sec : two_body ] .",
    "similar to fig .",
    "[ fig : wavefunction_bound_state_double ] and fig .",
    "[ fig : wavefunction_bound_state_single ] , it is readily seen that the wave functions at these peaks are localized along the diagonal , indicating a bound state in the relative coordinates and leading to the bunching effect in transmission . on the other hand ,",
    "an increasing number of nodes and anti - nodes develop along the diagonal for increasing @xmath345 , which are associated with the higher momenta of the center - of - mass motion .",
    "we note that such resonances deviate significantly from the the semiclassical picture , where anti - bunching was predicted for both positive and negative nonlinearity .",
    "we also note that in cavity qed systems this effect is not present since these systems are single - mode .     as a function of nonlinearity :",
    "when the negative nonlinear strength is changed to higher values and @xmath347 exhibits resonances at certain values of @xmath349 . in this plot the system size is @xmath285 , however , for other system size same behaviors were observed around similar values of @xmath271 .",
    "the two - photon wavefunction ( @xmath350 ) for four values of nonlinearity is shown .",
    "( b ) corresponding bound state energies ( green - solid ) which become resonant with incoming photon energy ( black - dotted ) for specific nonlinearities .",
    "we have assumed no dissipation ( @xmath329 ) in these plots .",
    ", scaledwidth=45.0% ]    the experimental requirement to see such behaviors is more stringent than the photon repulsion in the previous section .",
    "for example , if we want to observe the second photonic bound state ( @xmath351 ) for a system with @xmath352 , the coherent optical length should be at least @xmath353 when @xmath354 . to achieve a reasonable signal ( linear transmission @xmath355 ) an optical density of @xmath356",
    "is needed .",
    "importantly , however , we have shown that the presence of bound states inside the nonlinear medium can be probed with classical light , simply by examining higher - order correlation functions in the output field , rather than sending in complicated quantum inputs .      in this section ,",
    "we study the transport properties of the system in the presence of nonlinear absorption , and calculate its effect on the transmitted light and its correlation functions .",
    "a purely absorptive nonlinearity arises when the detuning @xmath358 is set to zero in our atomic system  ( see fig .",
    "[ fig : four_level](a ) ) .",
    "this nonlinear loss also leads to anti - bunching in the transmitted field , as multi - photon components become less likely to pass through the waveguide without being absorbed .",
    "linear absorption , on the other hand , affects transmission of single- and multi - photon components equally .",
    "[ fig : filter_absorption ] and fig .",
    "[ fig : filter_scaling ] show how two - photon and one - photon states are transported differently in the nonlinear absorptive system  ( realistic linear losses are included in this calculation )",
    ".     reaches the steady - state after a time interval which is set by the bandwidth of the system , one - photon state ( green ) is partially transmitted while the two - photon state ( red ) is strongly attenuated due the nonlinear absorption .",
    "this plot has been generated for a system with @xmath328 an od=70.,scaledwidth=40.0% ]    ) while the two - photon state transmission ( @xmath359 ) is suppressed due the nonlinear absorption .",
    "this suppression is more pronounced for higher optical density and cooperativity .",
    "( b ) correlation function @xmath360 of the transmitted light when the frequency is set to the single - photon transmission resonance with @xmath361 and @xmath362.,title=\"fig:\",scaledwidth=40.0% ] ) while the two - photon state transmission ( @xmath359 ) is suppressed due the nonlinear absorption .",
    "this suppression is more pronounced for higher optical density and cooperativity . (",
    "b ) correlation function @xmath360 of the transmitted light when the frequency is set to the single - photon transmission resonance with @xmath361 and @xmath362.,title=\"fig:\",scaledwidth=40.0% ]    we note that the two - photon wavefunction is attenuated due the nonlinear absorption , while it is not deformed , as shown in fig .",
    "[ fig : quantum_dissipative ] . in an experimental realization of such a system with @xmath328 ,",
    "an optical coherent length of @xmath363 is enough to yield a relatively large anti - bunching ( @xmath364 ) . in order to have high transmission ( @xmath365 ) for single photons an optical density of @xmath366",
    "is required .    ) , the two - photon wave function is strongly suppressed comparing to the absence of the nonlinear absorption ( @xmath367 ) .",
    "these plots has been generated for a system with @xmath328 , @xmath339 and od=70 . , scaledwidth=45.0% ]    all of the physics related to the photon correlation function is described again by product of the coherent optical length and the nonlinearity coefficient @xmath368 ( since the nonlinear absorption is equal to the nonlinear absorption coefficient times the length of the medium ) .",
    "however , for a fixed optical density , since the nonlinear transition is on resonance , the magnitude of the nonlinear coefficient @xmath292 is enhanced compared to the nonlinear dispersive case . we note that in the presence of nonlinear absorption , one has to also consider the effect of accompanied noise .",
    "however , the effect of noise for an ensemble of many atoms which are driven by a weak laser field , is negligible , and therefore , using the nlse with a decay term is sufficient and consistent .",
    "a rigorous demonstration of the validity of such approximation is the subject of further research .",
    "we have developed a technique to study few - photon quantum dynamics inside 1d nonlinear photonic system .",
    "this technique allows us to study the system even in regimes where nonlinearities are significant even at a few - photon level , where we find that the behavior of the system deviates significantly from estimates based on classical formalism .",
    "specifically , when the system is driven by classical light , the strong optical nonlinearity manifests itself in the correlation functions of the outgoing transmitted light .",
    "in particular , when the interaction between photons is effectively repulsive , the suppression of multi - photon components results in anti - bunching of the transmitted field and the system acts as a single - photon switch . in the case of attractive interaction , the system can exhibit either anti - bunching or bunching , associated with the resonant excitation of bound states of photons by the input field .",
    "these effects can be observed by probing statistics of photons transmitted through the nonlinear fiber .",
    "we thank anders srensen , victor gurarie , adilet imambekov , and shanhui fan for useful discussions .",
    "this work was partially supported by nsf , nsf dmr-0705472 , swiss nsf , cua , darpa , packard foundation and afosr - muri .",
    "dec acknowledges support from the gordon and betty moore foundation through caltech s center for the physics of information , and the national science foundation under grant no .",
    "phy-0803371 .",
    "43    present address : joint quantum institute , department of physics university of maryland and national institute of standards and technology , college park , md 20742 usa .",
    "natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , , , , , , * * , ( ) .    , , , , , , , * * , ( ) .    , , , ,",
    "* * , ( ) .    , , , * * , ( ) .",
    ", , , , * * , ( ) .    , , , , , ,",
    "* * , ( ) .    , , , * * , ( ) .",
    ", , , , * * , ( ) .    , , , * * , ( ) .    , , , , * * , ( ) .    , , , , * * , ( ) .    , * * , ( ) .    , , , , , , ,",
    ", * * , ( ) .    ,",
    "* * , ( ) .    , * * , ( ) .    ,",
    "_ _ ( ) .    ,",
    "* * , ( ) .",
    ", * * , ( ) .    , , , _ _ ( , ) .    , , , * * , ( ) .    , * * , ( ) .",
    ", * * , ( ) .    , * * , ( ) .    ,",
    "* * , ( ) .    , , , * * , ( ) .    , * * , ( ) .    , , , , * * , ( ) .    , , , , , * * , ( ) .    , , , , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , , , , * * , ( ) .    ,",
    "_ _ ( , ) .    ,",
    "_ _ ( , ) .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .    , *",
    "* , ( ) .    , * * , ( ) .    ,",
    "_ _ ( , , ) .    ,",
    "( ) .    , ph.d",
    ". thesis , ( ) .",
    ", _ _ ( , ) .",
    "in this appendix , we show that how in an eit system , where the control field is a standing wave , a band gap structure can be developed .",
    "in particular , we show the presence of transmission resonances at the band gap edge by taking into account the full expression for the atomic susceptibilities .",
    "we show that at the band gap edge , we recover that same resonances that we presented in the main text for small detunings .    we consider a @xmath369-level scheme , where a standing control field has coupled the forward- and backward - going probe together , similar to fig.[fig : four_level ] without the nonlinear transition ( c - d ) .",
    "following @xcite , we assume the noises to be negligible , and therefore , the atomic equations of motion to the leading order in @xmath370 are    @xmath371    and the evolution equation of the photonic fields are written as :    @xmath372    the wave - vector mismatch can be ignored by including a small shift in the two - photon detuning . by taking the fourier transform of the atomic equation of motion",
    ", one can solve for atomic polarization and obtain the self- and cross - susceptibilities .",
    "we can define a unit length based on the absorption length @xmath373 , and write the field equation as :    @xmath374    where the self- and cross susceptibilities and the detuning are given by :    @xmath375    where @xmath376 , @xmath377 and @xmath378 is the two - photon detuning of the probe from the pump field which is related to the dimensionless two - photon detuning in the main text ( @xmath379 ) .",
    "we note that in most cases , @xmath380 is very small for slow group velocities ( @xmath381 ) , and therefore the corresponding term can be neglected for simplicity .    in order to obtain transmission and reflection coefficient , one should solve the couple mode equations eq.([eq : coupled - mode_full ] ) with proper boundary conditions .",
    "therefore , we consider a system which is driven with a weak coherent field at @xmath382 . therefore , the boundary conditions can be set to ,    @xmath383    we evaluate the transmission coefficient @xmath384 , and the reflection coefficient @xmath385 by numerical methods using bvp5c in matlab .",
    "in particular , we are interested in the raman regime , in other words the detuning is very large @xmath386 and also we assume @xmath66 .",
    "first , we consider the case where the eit width is smaller than the one - photon detuning , i.e. @xmath387 .",
    "fig.[fig : vary_od ] shows the reflectivity and transmittivity of the system for different optical densities . in the regime with low optical density",
    ", the spectrum corresponds to a shifted raman transition at @xmath388 and an eit window around @xmath389 . in higher optical densities ,",
    "the system develops a band gap for @xmath390 .",
    "fig.[fig : vary_od ] shows that in media with higher optical density , the band gap becomes more prominent .    , title=\"fig:\",scaledwidth=30.0% ] , title=\"fig:\",scaledwidth=30.0% ] , title=\"fig:\",scaledwidth=30.0% ]    as we discussed in the main text , we are interested in the band gap edge where the transmission peaks are present and the system acts like an effective cavity .",
    "fig.[fig : edge_bandgap ] shows a close - up of the transmittivity and reflectivity spectrum in fig.[fig : vary_od](c ) at the band gap edge .",
    "we can observe that several resonances occur at the edge due to the finite size of the system . by positioning at the one of the transmission peaks",
    ", the system behaves as an effective cavity , where the decay rate of the cavity will be given by the width of the transmission peak .",
    "therefore , the present results , including the full susceptibilities of the system , is consistent with the model presented earlier where we had approximated the system to be around @xmath391 .",
    ", scaledwidth=40.0% ]    we add that alternatively , one can assume a strong control field so that the eit windows would be smaller than the one - photon detuning @xmath392 .",
    "similar to the previous case @xmath393 , the system develops a band gap . as shown in fig.[fig : eit_bandgap ] , the band gap is formed between @xmath394 , similar to modulated eit with ac - stark shift as discussed in ref.@xcite .    )",
    "[ fig : eit_bandgap],scaledwidth=40.0% ]",
    "in this section , we describe the numerical methods that have been used to simulate the evolution of the photonic quantum state and the related correlation functions , in the limit where we truncate the hilbert space to two photons or less .",
    "the partial differential equations for the one - photon and two - photon wave functions  ( [ eq : two_photon ] , [ eq : one_photon ] ) are turned into difference equations by discretizing space and time , and are evolved forward in time using the du fort - frankel scheme  @xcite .",
    "this algorithm is is explicit in time  _",
    "i.e. _ , the next time step function is explicitly given by the past time function  and is also unconditionally stable .",
    "we note that the system under investigation is open and it is driven out of equilibrium , therefore , conventional analytical methods for approaching the nlse such as bethe ansatz or quantum inverse scattering  @xcite are not applicable here .    the one - photon wave function can be easily integrated and solved analytically .",
    "however , we describe how to obtain the one - photon wave function numerically and then generalize this technique to obtain the two - photon wave function .",
    "first , we mesh space and time and reduce the differential equations to a difference equation .",
    "if we choose the time step @xmath207 and the space step @xmath395 , the discretized time and space will be @xmath396 and @xmath397 and the system length @xmath398 . then following the du fort - frankel scheme  @xcite , the evolution equation takes the form : @xmath399\\end{aligned}\\ ] ] where the position take all values inside the boundary ( @xmath400 ) . by rearranging the above equation ,",
    "the explicit form of the equation can be obtained @xmath401\\nonumber\\end{aligned}\\ ] ] therefore inside the boundaries , the wave function at time @xmath402 can be obtained knowing the wave function at time @xmath403 and @xmath404 .",
    "the boundary condition at @xmath87 -i.e .",
    "@xmath405 , will be given by @xmath406 or equivalently , @xmath407 and similarly for the boundary condition at @xmath88 -i.e .",
    "@xmath408 , we have @xmath409 therefore , by having the above boundary conditions and the initial condition @xmath410 , the wave function can be calculated at any time inside the boundaries ( @xmath411 ) .",
    "the order of accuracy of the du fort - frankel scheme is given by @xmath412 and it is consistent as @xmath413 tends to zero @xcite .",
    "similarly , we can write a difference equation for the two - photon wave function . the @xmath84-interaction can be approximated by a gaussian distribution .",
    "the space domain is meshed so that @xmath414 .",
    "the evolution equation for the two - photon wave function reads @xmath415\\nonumber\\\\ & ~&+ \\frac{ik}{mh^{2}}\\left[\\phi(x , y+1,s)+\\phi(x , y-1,s)\\right]\\nonumber\\\\ & ~&+ 2\\frac{ik}{mh^{2}}\\phi(x , y , s-1)+\\phi(x , y , s-1)\\nonumber\\\\ & ~&- 2 k   \\frac{2i\\kappa}{\\sigma\\sqrt{2\\pi}}{\\rm { exp}\\left(-\\frac{(x - y)^{2}}{2\\sigma^{2}}\\right)\\phi(x , y , s)}\\nonumber\\end{aligned}\\ ] ] the boundary condition at @xmath87 will be given by @xmath416 where @xmath417 is the length scale characterizing the distance of the two - photon interaction .",
    "approximating the delta - function with a gaussian is valid if @xmath418 . on the other hand , we should have @xmath419 so that the gaussian function would be smooth . or equivalently , @xmath420 and similarly for the boundary condition at @xmath88 , we have @xmath421 which gives @xmath422 once the wave function is known at any point in time and space , we can evaluate the correlation functions .",
    "in particular , the two - photon correlation function @xmath423 is given by eq.([eq : g2_0 ] ) , where the first and the second derivatives at anytime are given by the following expressions ,      note that in evaluation of @xmath425 , once the first photon is detected the two - photon wave function collapses to zero .",
    "this seems to be contradictory with the driven boundary condition eq.([eq : boundary_condition ] ) where the two - photon state at the boundaries is proportional to the one - photon wave function which is not zero .",
    "this apparent inconsistency occurs because we have neglected higher number photon states in our truncation .",
    "however , this inconsistency only leads to higher order corrections to @xmath425 in the input field amplitude @xmath426 , which is assumed to be weak  ( @xmath427 ) ."
  ],
  "abstract_text": [
    "<S> we present a theoretical technique for solving the quantum transport problem of a few photons through a one - dimensional , strongly nonlinear waveguide . </S>",
    "<S> we specifically consider the situation where the evolution of the optical field is governed by the quantum nonlinear schrdinger equation ( nlse ) . </S>",
    "<S> although this kind of nonlinearity is quite general , we focus on a realistic implementation involving cold atoms loaded in a hollow - core optical fiber , where the atomic system provides a tunable nonlinearity that can be large even at a single - photon level . </S>",
    "<S> in particular , we show that when the interaction between photons is effectively repulsive , the transmission of multi - photon components of the field is suppressed . </S>",
    "<S> this leads to anti - bunching of the transmitted light and indicates that the system acts as a single - photon switch . </S>",
    "<S> on the other hand , in the case of attractive interaction , the system can exhibit either anti - bunching or bunching , which is in stark contrast to semiclassical calculations . </S>",
    "<S> we show that the bunching behavior is related to the resonant excitation of bound states of photons inside the system . </S>"
  ]
}