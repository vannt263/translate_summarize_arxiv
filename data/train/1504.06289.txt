{
  "article_text": [
    "the problems of numerical modeling the many - particle interactions in large molecular systems , lattice structured metallic clusters and crystals , proteins and nanomaterials are the most challenging tasks in modern computational physics and chemistry .",
    "the traditional approaches for these multidimensional problems are restricted to the concepts which have well recognized limitations for computations with higher accuracy and for larger non - periodic molecular systems , as well as for efficient calculation of excited states .",
    "recent advances in numerical analysis for multidimensional problems and significant achievements in high performance computing suggest new creative approaches to these problems .",
    "the hartree - fock ( hf ) equation governed by the 3d integral - differential operator @xcite is one of the basic models for _ ab initio _ calculation of the ground state energy of molecular systems .",
    "it is a strongly nonlinear eigenvalue problem ( evp ) in a sense , that one should solve the equation in a self - consistent way when the integral part of the governing operator depends on the solution itself .",
    "multiple strong singularities in the electron density of a molecule due to nuclear cusps impose strong requirements on the accuracy of calculations .",
    "commonly used numerical methods for solution of the hartree - fock equation are based on the analytical computation of the arising two - electron integrals ( convolution type integrals in @xmath10 ) in the problem adapted naturally separable gaussian - type bases @xcite , by using _ erf_-function expansions .",
    "this rigorous approach resulted in a number of efficient implementations which are widely used in computational quantum chemistry .",
    "the success of the analytical integration methods stems from the big amount of precomputed information based on the physical insight including the construction of problem adapted atomic orbitals basis sets and elaborate nonlinear optimization for calculation of density fitting basis",
    ". the known limitations of this approach appear due to a strong dependence of the numerical efficiency on the size and quality of the chosen gaussian basis sets , that might be crucial for larger molecular clusters and heavier atoms .",
    "the intention to replace or assist the analytical calculations for the hartree - fock problem by a data - sparse grid - based numerical schemes has a long history .",
    "first success was the grid - based numerical method for the diatomic molecules in @xcite , though this approach was not feasible to compact ( 3d ) molecules .",
    "the wavelet multiresolution schemes @xcite capable for the accurate representation of nuclear cusps , have been applied to electronic structure simulations since the seminal papers @xcite , and recently this approach was further advanced due to achievements in the high performance supercomputing @xcite . however , due to extensive computational resources , the entirely wavelet - based or sparse - grid approaches @xcite are limited so far only to rather small atomic systems with few electrons @xcite .",
    "tensor hyper - contraction decompositions in density fitting schemes have been analyzed in @xcite .",
    "the newly developed tensor - structured numerical methods , both the name and the concept , appeared during the work on the grid - based tensor approach to the solution of the 3d hartree - fock problem @xcite . the central point is the representation of @xmath11-variate functions and integral / differential operators on large @xmath12 grids and their approximation in the low - rank tensor formats , which allows numerical calculations in @xmath13 complexity instead of @xmath14 by conventional methods .    in this paper",
    "we summarize the main benefits of the tensor numerical methods in electronic structure calculations , and discuss further prospects of this approach in several directions , such as    * algebraic directional density fitting and tensor factorization of the two - electron integrals and their use in the hartree - fock calculations ; * tensor decompositions in the mp2 energy correction , and in calculation of excited states based on the bethe - salpeter equation ; * fast tensor summation of electrostatic potentials on large 3d lattice for efficient calculation of the fock matrix in the case of lattice - structured systems ; * fast calculation of the interaction energy of the long - range potentials on large 3d lattices .",
    "notice that basic rank - structured tensor formats such as the canonical ( parafac ) and tucker tensor decompositions have been since long used in the computer science for the quantitative analysis of correlations in the experimental multidimensional data arrays in data processing and chemometrics , see @xcite and references therein . in 2006",
    "the exceptional properties of the tucker decomposition for the discretized multidimensional functions have been revealed in @xcite , where it was proven that for a class of function - related tensors the approximation error of the tucker decomposition",
    "_ decays exponentially _ with respect to the tucker rank .",
    "this gives the opportunity to represent the discretized multidimensional functions and integral ( convolution ) operators in an algebraically separable form and thus reduce the numerical treatment of the multidimensional transforms to 1d operations .",
    "it was shown that the number of vectors in such a representation depends only logarithmically on the size of the @xmath11-dimensional grid , @xmath14 , used for discretization of multivariate functions .",
    "the above results have led to the idea to calculate the hartree potential and the coulomb and exchange operators by numerical quadratures @xcite using gaussian - type basis functions discretized on 3d cartesian grids and the fast tensor - product convolution @xcite . in this way ,",
    "the efficient low - rank canonical tensor representation to the newton kernel was an essential contribution @xcite . to reduce the initial rank of the electron density , that is quadratically proportional to the number of gto basis functions , the canonical - to - tucker tensor transform was invented @xcite , which made computations for large tensor grids and extended molecules tractable ( even in matlab ) .",
    "the initial version of tensor - structured algorithms for solving hartree - fock equation employed the 3d grid - based calculation of the coulomb and exchange integral operators  on - the - fly ",
    ", thus avoiding precomputation and storage of the tei tensor@xcite . in particular , it was justified that tensor calculus allows to reduce the 3d convolution integrals to combinations of 1d convolutions , and 1d hadamard and scalar products .",
    "besides , these results promoted spreading of the tensor - structured methods in the community of numerical analysis @xcite , and further development of the tree - tensor formats like tensor - train @xcite and hierarchical tucker representations @xcite .",
    "further development of tensor methods in electronic structure calculations was due to the fast algorithm for the grid - based computation of the tei tensor @xcite in @xmath15 storage in the number of basis functions @xmath16 .",
    "the fourth order tei tensor is calculated in a form of the cholesky factorization by using the algebraic 1d  density fitting  scheme , which applies to the product basis functions .",
    "imposing the low - rank tensor representation of the product basis functions and the newton convolving kernel all discretized on @xmath1 cartesian grid , the 3d integral transforms are calculated in @xmath0 complexity .",
    "given the factorized tei , the update of the column and exchange parts in the fock matrix reduces to the cheap algebraic operations .",
    "other steps are tensor calculation of the core hamiltonian and the efficient mp2 energy correction scheme @xcite , which all together gave rise to the black - box hartree - fock solver @xcite . due to the grid representation of basis functions",
    "basis sets are now not restricted to gaussian - type orbitals and allowed to be any well - separable function defined on a grid .",
    "the tensor - based hartree - fock solver is competitive in computational time and accuracy with the standard packages based on analytical calculation of integrals .",
    "high accuracy is attained owing to easy calculations on large 3d grids up to @xmath17 , so that the resolution with mesh size @xmath18 of the order of atomic radii , @xmath19 , is possible .    motivated by tensor decompositions in the mp2 scheme , the new approach for calculation of the excited states in the framework of the bethe - salpeter equation",
    "was recently introduced @xcite , that employs the reduced basis method in combination with low - rank tensor approximations .",
    "further developments of the tensor methods in multi - particle simulations are focused on the large lattice structures in a box and nearly periodic systems , for which the tensor approach may reduce computational costs dramatically @xcite .",
    "one of the challenging problems in the numerical treatment of the crystalline - type molecular clusters is summation of a large number of electrostatic potentials distributed on a finite ( non - periodic ) lattice .",
    "the novel grid - based method for summation of the long - range potentials in the canonical and tucker formats @xcite works on @xmath20 lattices with the computational cost @xmath6 instead of @xmath7 by the traditional ewald - type methods @xcite .",
    "the required precision is guaranteed by employing large 3d cartesian grids for representation of potentials .",
    "the method remains efficient for lattices with non - rectangular geometries and in the presence of multiple defects @xcite .",
    "the rest of the paper is organized as follows . in section",
    "[ sec : tens_formats ] , we overview the basic tensor formats and show why the orthogonal tucker tensor decomposition , originating from computer science and data processing , became useful for the treatment of the multidimensional functions and operators in numerical analysis .",
    "in particular ,  [ ssec : mps - tt_formats ] and  [ ssec : qqtform ] discuss the matrix product states ( tensor train ) formats and the novel quantics tensor approximation method , respectively , while  [ ssec : oper_1d ] addresses the basic tensor - structured multilinear algebra operations .",
    "section [ sec : tensor_hf ] describes tensor calculus of the multidimensional convolution transform on examples of the hartree potential (  [ ssec : multi_int ] ) and the tei tensor (  [ sssec : tei_int ] ) , and recalls the main building blocks in the tensor - based black - box hartree - fock solver .",
    "section [ sec : mp2_bse ] shows benefits of the tensor approach in mp2 calculations and in calculation of the lowest part of the excitation energies in the framework of the bethe - salpeter equation .",
    "section [ sec : cryst ] describes the benefits of tensor methods in applications to lattice - type molecular systems .",
    "in particular , we present fast tensor method for the summation of the long - range interaction potentials on a 3d lattice by using the assembled vectors of their canonical and tucker tensor representations . the important application of this approach to calculation of interaction energy of the coulombic potentials on a lattice with sub - linear cost in the lattice size is described in detail .",
    "appendix discusses some computational details on the canonical - to - tucker tensor transform , the galerkin discretization scheme for the nonlinear hartree - fock equation , and the basics of the low - rank canonical tensor representation for the newton kernel .",
    "in this section we discuss shortly why the rank - structured tensors , which were traditionally used in experimental data processing , appears to be useful for the separable representation of multivariate functions and operators represented on tensor product grids .",
    "the canonical and tucker tensor decompositions have been since long used in the computer science community for the quantitative analysis of correlations in the experimental multidimensional data arrays in chemometrics and data processing , with rather weak requirements on the accuracy , see @xcite and references therein . in the recent decade",
    "the class of matrix product states type tensor formats became popular in the simulations of quantum spin systems and quantum molecular dynamics .",
    "we refer to @xcite for recent literature surveys on commonly used tensor formats .",
    "we consider a tensor of order @xmath11 , as a real multidimensional array @xmath21",
    "\\in \\mathbb{r}^{n_1 \\times \\ldots \\times n_d}$ ] numbered by a @xmath11-tuple index set$ ] can be utilized . ] , with multi - index notation @xmath22 , @xmath23 .",
    "it is an element of the linear vector space @xmath24 equipped with the euclidean scalar product , @xmath25 euclidean vectors and matrices are the special case of @xmath11th order tensors . for a general tensor ,",
    "the required storage scales exponentially in the dimension , @xmath26 , ( the so - called  curse of dimensionality  ) . to get rid of exponential scaling in the dimension , one can apply the rank - structured separable representations of multidimensional tensors .",
    "the simplest separable element is given by rank-@xmath9 canonical tensor , @xmath27 with entries @xmath28 requiring only @xmath29 numbers to store it .",
    "a tensor in the @xmath30-term canonical format is defined by @xmath31 where @xmath32 are normalized vectors , and @xmath30 is called the canonical rank of a tensor .",
    "it is convenient to introduce the so - called side matrices @xmath33 \\in \\mathbb{r}^{n_\\ell \\times r}$ ] , @xmath34 , obtained by concatenation of the canonical vectors @xmath35 , @xmath36 . now the storage cost is bounded by @xmath37 . for @xmath38 computation of the canonical rank of a tensor @xmath39 ,",
    "i.e. the minimal number @xmath30 in representation ( [ eqn : cp_form ] ) and the respective decomposition , is an @xmath40-@xmath41 hard problem . in the case @xmath42 the representation ( [ eqn : cp_form ] ) is merely a rank-@xmath30 matrix .",
    "we say that a tensor @xmath43 is represented in the rank-@xmath44 orthogonal tucker format with the rank parameter @xmath45 , if @xmath46 where @xmath47 represents the set of orthonormal vectors , and @xmath48 \\in \\mathbb{r}^{r_1\\times \\cdots \\times r_d}$ ] is the tucker core tensor .",
    "the storage cost for the tucker tensor is bounded by @xmath49 , @xmath50 . in the case",
    "@xmath42 , the orthogonal tucker decomposition is equivalent to the singular value decomposition ( svd ) of a rectangular matrix .",
    "figure [ fig : cantucker_format ] visualizes the canonical and tucker tensors in the case @xmath51 .",
    ".,title=\"fig:\",width=226 ] .,title=\"fig:\",width=151 ]    canonical tensor decomposition leads to an ill - posed problem and , up to our best knowledge , there are no robust algebraic algorithms for the canonical approximation of an arbitrary tensor . for some classes of analytic functions , the explicit low - rank approximation can be constructed in analytic form by using @xmath52-quadrature approximation to the laplace transform .",
    "the robust methods for tucker decomposition are based on the orthogonal projections using the higher order singular value decomposition@xcite ( hosvd ) that is the generalization of the singular value decomposition ( svd ) of matrices .",
    "the rank - structured decomposition ( approximation ) of multidimensional tensors provides means for the separation of variables in the discretized representation of multivariate functions and operators , and thus the possibility to substitute multidimensional algebraic transforms by univariate operations .",
    "notice that in the computer science community these possibilities were restricted to moderate - dimensional tensors of small mode size ( with rather large rank parameters ) obtained from the experimental data sets .      in 2006",
    "it was first verified numerically , see in @xcite , that the rank of the ( fixed accuracy ) tucker approximation to some function related tensors depends only logarithmically on the size of the discretization grid . for a given continuous function @xmath53 , @xmath54\\subset \\mathbb{r}^3 $ ]",
    ", we introduced the function related @xmath2rd order tensor , obtained by galerkin discretization in a volume box using @xmath55 3d cartesian grid . in particular ,",
    "the low - rank tensor approximations were calculated for functions of the slater type @xmath56 , newton kernel @xmath57 , yukawa potential @xmath58 , and the helmholtz potential @xmath59 , @xmath60 .",
    "numerical tests demonstrated that the error of the rank-@xmath61 ( with @xmath62 ) tucker approximation applied to these third order tensors decays exponentially with respect to the tucker rank @xmath63 .",
    "moreover , for fixed approximation error , the tucker rank @xmath63 scales as @xmath64 for above mentioned functions @xcite .     for a single slater function .",
    ", title=\"fig:\",width=170 ]   for a single slater function .",
    ", title=\"fig:\",width=173 ]    this application revealed a number of properties of the tucker format which were not known before .",
    "in particular , it was showed that for tensors resulting from the discretization of physically relevant multidimensional functions on the tensor grids one can find algebraically a reduced subspace in each mode of the original tensor , thus approximating the function by separated variables using a tensor product of a relatively small number of vectors .",
    "for a sum of slater potentials over the cubic @xmath65 lattice ( right ) . , title=\"fig:\",width=170 ]   for a sum of slater potentials over the cubic @xmath65 lattice ( right ) . , title=\"fig:\",width=173 ]",
    "figures [ fig : tucker_3d ] and [ fig : tucker_3dn ] ( right ) show the exponential convergence of the tucker tensor approximation in the tucker rank @xmath63 of the slater function in the relative frobenius norm , @xmath66 .",
    "figures demonstrate that the exponential decay of approximation error is nearly the same for both a single potential and for a sum of the same potentials distributed in nodes of a cubic lattice .",
    "this property of the tucker decomposition will be further gainfully applied to the fast lattice summation of interaction potentials .",
    "motivated by these observations , we invented the canonical - to - tucker ( c2 t ) decomposition for function related tensors @xcite , based on the reduced higher order singular value decomposition ( rhosvd ) ( theorem 2.5 , @xcite ) .",
    "the canonical - to - tucker algorithm ( see appendix ) combined with the tucker - to - canonical transform serves for reducing the ranks of canonical tensors with large @xmath30 .",
    ".,width=396 ]    figure [ fig : cantucker_3d ] in its als part shows the algorithmic step for @xmath67 , which is repeated for every mode @xmath68 ( see appendix ) .",
    "the computational work for the multigrid tensor decomposition c2 t algorithm introduced in @xcite exhibits linear complexity scaling with respect to all input parameters , @xmath69 .    the multigrid tucker decomposition algorithm applied to full format tensors @xcite leads to the complexity scaling @xmath70 , whereas its standard version ( commonly used hosvd algorithm in computer science ) scales as @xmath71 , becoming intractable even for moderate sizes of tensors .",
    "we conclude by notice that the optimized tucker and canonical tensor approximations can be computed by the alternating least square ( als ) iteration with initial guess obtained by hosvd / rhosvd approximations .",
    "the product - type representation of @xmath11th order tensors , which is called in the physical literature as the matrix product states ( mps ) decomposition ( or more generally , tensor network states models ) , was introduced and successfully applied in dmrg quantum computations @xcite , and , independently , in quantum molecular dynamics as the multilayer ( ml ) mctdh methods @xcite .",
    "mps type representations reduce the storage complexity to @xmath72 , where @xmath63 is the maximal rank parameter .    in the recent years",
    "the various versions of the mps - type tensor approximations were discussed and further investigated in mathematical literature including the hierarchical dimension splitting @xcite , the tensor train ( tt ) @xcite , the quantics - tt ( qtt ) @xcite , as well as the hierarchical tucker representation @xcite , which belongs to the class of tensor network states model .",
    "the tt format is the particular form of mps type factorization in the case of open boundary conditions . for a given rank parameter @xmath73",
    ", the rank-@xmath61 tt format contains all elements @xmath21 \\in\\mathbb{r}^{n_1\\times ... \\times n_d } $ ] , which can be represented as the contracted products of @xmath2-tensors , that in the index notation takes a form , @xmath74 specified by the set of column vectors , @xmath75 , ( @xmath76 ) , or equivalently by the vector - valued @xmath77 matrices , @xmath78 $ ] , ( i.e. , @xmath2-tensors ) , cf .",
    "( [ eqn : tucker_form ] ) .",
    "the latter representation is written in the _ matrix product form _",
    ", explaining the notion mps , where @xmath79 is @xmath80 matrix .",
    "th - order mps / tt tensor.,width=302 ]    figure [ fig : mps_format ] illustrates the tt representation of a @xmath81th - order tensor , where each particular entry is factorized as a product of five matrices , @xmath82 , where , for example , @xmath83 .",
    "the rank - structured tensor formats like canonical , tucker and mps / tt - type decompositions also apply to matrices . for example",
    ", the @xmath11-dimensional fft matrix over @xmath84 grid can be implemented on the rank-@xmath85 tensor with the linear - logarithmic cost @xmath86 , due to the rank-@xmath9 factorized representation @xmath87 where @xmath88 represents the univariate fft matrix along mode @xmath89 .      in the case of large mode size",
    ", the asymptotic storage cost for a class of function related @xmath40-@xmath11 tensors can be reduced to @xmath90 by using quantics - tt ( qtt ) tensor approximation method @xcite .",
    "the qtt - type approximation of an @xmath40-vector with @xmath91 , @xmath92 , is defined as the tensor decomposition ( approximation ) in the canonical , tt or more general formats applied to a tensor obtained by the dyadic folding ( reshaping ) of the target vector to an @xmath5-dimensional @xmath93 data array ( tensor ) that is thought as an element of the @xmath5-dimensional quantized tensor space .    in the vector case ,",
    "i.e. for @xmath94 , a vector @xmath95\\in \\mathbb{r}^{{n } } ,   $ ] with @xmath91 , is reshaped to its quantics ( quantized ) image in @xmath96 by dyadic folding , @xmath97\\in { \\bigotimes}_{j=1}^{l}\\mathbb{r}^{2 } , \\quad { \\bf j } = ( j_{1}, ... ,j_{l } ) ,   \\;\\ ,   j_{\\nu}\\in \\{1,2\\ } , \\ ] ] where for fixed @xmath98 , we have @xmath99 , with @xmath100 ( @xmath101 ) being defined via binary coding , i.e. the coefficients @xmath102 are found from the binary representation of @xmath103 , @xmath104 next figure visualizes the qtt approximation process .",
    "suppose that the quantics image for an @xmath40-vector , i.e. an element of @xmath5-dimensional quantized tensor space @xmath105 with @xmath106 , can be represented ( approximated ) by the low - rank canonical or tt tensor of order @xmath5 , thus introducing the qtt approximation of an @xmath40-vector . given rank parameters @xmath107 ( @xmath108 ) , the qtt approximation of an @xmath40-vector requires a number of representation parameters estimated by @xmath109 providing @xmath110-volume complexity scaling in the size of initial vector , @xmath40 .",
    "for @xmath111 the construction is similar @xcite .",
    "the power of qtt approximation method is explained by the theoretical substantiation of the qtt approximation properties discovered in @xcite and establishing the perfect rank-@xmath63 decomposition for the wide class of function - related tensors obtained by sampling continuous functions over uniform ( or properly refined ) grid :    * @xmath112 for complex exponents , * @xmath113 for trigonometric functions and plain - waves . *",
    "@xmath114 for polynomials of degree @xmath115 , * @xmath63 is a small constant for wavelet basis functions , gaussians , etc .",
    "all independently on the vector size @xmath40 .",
    "notice that the notion quantics ( or quantized ) tensor approximation ( with a shorthand qtt ) originally introduced in 2009 , see @xcite , is reminiscent of the entity `` quantum of information '' , that mimics the minimal possible mode size ( @xmath116 ) of the quantized image .    concerning the matrix case , it was first found in @xcite by numerical tests that in some cases the dyadic reshaping of an @xmath117 matrix with @xmath91 may lead to a small tt - rank of the resultant matrix rearranged to the tensor form .",
    "the efficient low - rank qtt representation for a class of discrete multidimensional elliptic operators ( matrices ) and their inverse was proven in @xcite . moreover ,",
    "based on the qtt approximation , the important algebraic matrix operations like fft , convolution and wavelet transforms can be implemented by superfast algorithms in @xmath118-complexity , see survey paper @xcite and references therein .",
    "the rank - structured tensor representation provides 1d complexity of multilinear operations with multidimensional tensors .",
    "rank - structured tensor representation provides fast multi - linear algebra with linear complexity scaling in the dimension @xmath11 .    for given canonical tensors @xmath119 and",
    "@xmath120 as in ( [ eqn : cp_form ] ) , with ranks @xmath121 and @xmath122 , respectively , their euclidean scalar product can be computed by univariate operations @xmath123 at the expense @xmath124 .    the hadamard ( entrywise ) product of tensors @xmath119 , @xmath120 is defined by @xmath125:={\\bf a}\\odot { \\bf b}$ ] , where @xmath126 .",
    "for canonical tensors @xmath119 and @xmath120 given in form ( [ eqn : cp_form ] ) , the hadamard product is calculated in @xmath127 operations by 1d entrywise products of vectors , @xmath128 summation of two tensors in the canonical format @xmath129 is performed by a simple concatenation of their factor matrices , @xmath130 $ ] and @xmath131 $ ] , @xmath132 \\in \\mathbb{r}^{n_\\ell \\times ( r_a + r_b)}.\\ ] ] the rank of the resulting canonical tensor increases up to @xmath133 .    in electronic structure calculations ,",
    "the 3d convolution transform with the newton kernel , @xmath134 , is the most computationally expensive operation .",
    "the tensor method to compute convolution over large @xmath135 cartesian grids in @xmath0 complexity was introduced in @xcite .",
    "given canonical tensors @xmath119 , @xmath120 , their convolution product is represented by the sum of tensor products of @xmath136 convolutions , @xmath137 where @xmath138 denotes the univariate convolution product of @xmath139-vectors .",
    "the cost of tensor convolution in both storage and time is estimated by @xmath140 .",
    "the resulting algorithm considerably outperforms the conventional 3d fft - based approaches of complexity @xmath141 , see numerics in @xcite .",
    "the sequences of rank - structured operations on matrices and vectors normally lead to the increase of tensor ranks , usually being multiplied or added after each operation .",
    "the necessary rank reduction in the tucker and mps type formats can be implemented by stable algorithms based on the higher order svd . in the physical community",
    "the hosvd - type algorithms are known since longer as the schmidt decomposition @xcite . in the case of canonical tensors",
    "the rank reduction can be performed by the rhosvd algorithm based on the canonical - to - tucker and then tucker - to - canonical transforms described and analyzed in @xcite ( see  [ ssec : can2tuck ] and appendix ) , which demonstrated the stable behavior for most of examples in the hartree - fock calculations we considered so far .",
    "the stability conditions for the rhosvd have been discussed in @xcite .",
    "tensor - structured calculation of the multidimensional convolution integral operators with the newton kernel have been introduced in @xcite , where on the examples of the hartree and exchange operators in the hartree - fock equation , it was shown that calculation of the 3d and 6d convolution integrals can be reduced to a combination of 1d hadamard products , 1d convolutions and 1d scalar products .",
    "the molecule is embedded in a certain fixed computational box @xmath142 ^ 3 \\in \\mathbb{r}^3 $ ] , as in fig .",
    "[ fig : gauss ] , left . for a given discretization parameter @xmath143",
    ", we use the equidistant @xmath144 tensor grid @xmath145 , @xmath146 , with the mesh - size @xmath147",
    ". then the gaussian basis functions @xmath148 , are approximated by sampling their values at the centers of discretization intervals , as in fig .",
    "[ fig : gauss ] , right , using one - dimensional piecewise constant basis functions @xmath149 , @xmath150 , yielding their rank-@xmath9 tensor representation , @xmath151 let us consider the tensor calculation of the hartree potential @xmath152 and the corresponding coulomb matrix , @xmath153 where the electron density , @xmath154 , is represented in terms of molecular orbitals @xmath155 . given the discrete tensor representation of basis functions ( [ disc_gto ] ) , the electron density is approximated using 1d hadamard products of rank-@xmath9 tensors ( instead of product of gaussians ) , @xmath156 further , the representation of the newton kernel @xmath157 by a canonical rank-@xmath158 tensor @xcite is used ( see appendix for details ) , @xmath159 since large ranks make tensor operations inefficient , the multigrid canonical - to - tucker and tucker - to - canonical algorithms should be applied to reduce the initial rank of @xmath160 by several orders of magnitude , from @xmath161 to @xmath162 .",
    "then the 3d tensor representation of the hartree potential is calculated by using the 3d tensor product convolution , which is a sum of tensor products of 1d convolutions , @xmath163 the coulomb matrix entries @xmath164 are obtained by 1d scalar products of @xmath165 with the galerkin basis consisting of rank-@xmath9 tensors , @xmath166 the cost of 3d tensor product convolution is @xmath167 instead of @xmath141 for the standard benchmark 3d convolution using the 3d fft .",
    "next table shows cpu times ( sec ) for the matlab computation of @xmath168 for h@xmath169o molecule @xcite on a sun station using 8 opteron dual - core/2600 processors ( times for 3d fft for @xmath170 are obtained by extrapolation ) .",
    "c2 t shows the time for the canonical - to - tucker rank reduction .",
    "[ c]|r|r|r|r|r|r|@xmath171 & @xmath172 & @xmath173 & @xmath174 & @xmath175 & @xmath176 + fft@xmath177 & @xmath178 & & &  & @xmath179 years + @xmath180 & @xmath181 & @xmath182 & @xmath183 & @xmath184 & @xmath185 + & @xmath186 & @xmath187 & @xmath182 & @xmath188 & @xmath189 +    [ tab : tconvsfft ]    in a similar way , the algorithm for 3d grid - based tensor - structured calculation of 6d integrals in the exchange potential operator was introduced in @xcite , @xmath190 with @xmath191 the contribution from the @xmath192-th orbital are approximated by tensor anzats , @xmath193 , \\left[{\\bf g}_m \\odot \\sum\\limits_{\\nu=1}^{n_b } c_{\\nu a }   { \\bf g}_\\nu \\right ] \\ast { \\bf p}_r   \\right\\rangle.\\ ] ] here , the tensor product convolution is first calculated for each @xmath192th orbital , and then scalar products in canonical format yield the contributions to entries of the exchange galerkin matrix from the @xmath192-th orbital .",
    "these algorithms were employed in the first tensor - structured solver using 3d grid - based evaluation of the coulomb and exchange matrices in 1d complexity at every step of scf evp iteration @xcite .",
    "a sequence of dyadically refined 3d cartesian grids was used for reducing time in first iterations , with an @xmath194 convergence criterion for switching to larger grids .",
    "this is a nonstandard computational scheme avoiding calculation of the two - electron integrals .",
    "the accuracy for small molecules like h@xmath169o and ch@xmath195 was of the order of @xmath196 hartree . though time performance of this solver was not compatible with the standard hartree - fock packages it was the first proof of concept for the tensor numerical methods .",
    "the basic tensor - structured hartree - fock solver employs the factorized 3d grid - based calculation of the two - electron integrals tensor , @xmath197 $ ] , in the form @xmath198 by using univariate tensor operations .",
    "introduce the side matrices @xmath199 representing on the grid the full set of canonical vectors composing the products of the gaussian basis functions , @xmath200 , @xmath201_{1\\leq \\mu,\\nu\\leq n_b }   \\in \\mathbb{r}^{n\\times n_b^2}\\quad \\ell=1,2,3,\\ ] ] where in most of our hartree - fock calculations grids of size @xmath202 or @xmath203 have been used .",
    "it was found that the large matrices @xmath199 of size @xmath204 ( e.g. @xmath205 for alanine amino acid ) can be approximated with high accuracy by low rank matrices with the rank parameter bounded by @xmath206 @xcite .",
    "the corresponding low - rank factorizations ( `` 1d density fitting '' ) in the form ( for @xmath207 ) @xmath208 is computed by the truncated cholesky decomposition of the symmetric , positive definite @xmath209 ( see @xcite for more details ) .",
    "based on factorization ( [ eqn:1ddensfit ] ) , the number of convolutions in ( [ eqn : tei_tens ] ) is reduced dramatically from @xmath210 to @xmath211 at most ( say from @xmath212 to @xmath213 ) .",
    "in fact , using canonical factors from the rank-@xmath30 canonical tensor @xmath214 representing the newton kernel ( [ eqn : newtcan ] ) ( see ( [ eqn : sinc_general ] ) in appendix ) we , first , precompute the set of  convolution ",
    "matrices for every space variable @xmath215 , @xmath216 which includes the convolution products with @xmath206 column vectors of the matrix @xmath217 instead of @xmath161 convolutions in the initial formulation .    given matrices @xmath218 ,",
    "then the resulting @xmath219-th order tei tensor is represented in a matrix form @xmath220 the above nonstandard factorization of the tei matrix @xmath221 allows to reduce dramatically the computational cost of the standard cholesky factorization schemes @xcite applied to the reduced - rank symmetric positive definite matrix @xmath221 .",
    "in fact , the low - rank cholesky decomposition of @xmath221 is calculated in the following sequence .",
    "first , the diagonal elements of @xmath221 are calculated as @xmath222 then the selected columns of the matrix @xmath221 , required for the rank - truncated cholesky factorization scheme , are computed by the following fast tensor operations @xmath223 leading to representation of the matrix @xmath221 in the form of rank-@xmath224 approximate decomposition @xcite @xmath225 \\approx ll^t , \\quad\\mbox { with }   \\quad l\\in \\mathbb{r}^{n_b^2 \\times r_b},\\ ; r_b\\sim n_b.\\ ] ] this algorithm is much faster than the direct cholesky decomposition of the matrix @xmath221 with on - the - fly computation of the required column vectors .",
    "[ c]|r|r|r|r|r|r|@xmath171 & @xmath176 & @xmath226 & @xmath227 & @xmath228 + mesh ( bohr ) & @xmath229 & @xmath230 & @xmath231 & @xmath232 + had .",
    "& @xmath233 & @xmath234 & @xmath235 & @xmath236 + density fit . &",
    "@xmath237 & @xmath238 & @xmath239 & @xmath240 + 3d conv .",
    "time & @xmath241 & @xmath242 & @xmath243 & @xmath244 + chol .",
    "time & @xmath245 & @xmath245 & @xmath245 & @xmath245 +    table [ tab : dirdensfit ] represents times ( sec ) for 3d grid - based calculation of the directional density fitting and the tei tensor ( electron repulsion integrals ) for h@xmath169o molecule in a box @xmath246 ^ 3 $ ] bohr@xmath247 , performed in matlab on a 2-intel xeon hexa - core/2677 .",
    "time for convolution integrals in ( [ eqn : factor_mk_conv ] ) scales almost linearly in the @xmath136 grid - size @xmath139 as expected by theory .",
    "the galerkin representation of the 3d laplace operator in the nonlocal gaussian basis @xmath248 , @xmath249 , leads to the fully populated matrix @xmath250\\in \\mathbb{r}^{n_b \\times n_b}$ ] .",
    "tensor calculation of the matrix entries @xmath251 for the discrete laplacian @xmath252 in the separable gaussian basis is reduced to 1d matrix operations @xcite involving the fem laplacian @xmath253 , defined on @xmath135 grid , @xmath254 where @xmath255 .",
    "specifically , we have @xmath256 where @xmath257 is the tensor representation of gaussian basis functions using the piecewise linear finite elements . in the case of large @xmath135 grids",
    ", this calculation can be implemented with logarithmic cost in @xmath139 by using the low - rank qtt representation of the large matrix @xmath253 , see @xcite .    for tensor calculation of the nuclear potential operator @xmath258 we apply the rank-@xmath9 windowing operator , @xmath259 , for shifting the reference newton kernel @xmath260 according to the coordinates of nuclei in a molecule ( see section 5 and appendix ) .",
    "then the resulting nuclear potential , @xmath261 , is obtained as a direct tensor sum of shifted potentials @xcite , @xmath262 @xmath263 this leads to the following representation of the galerkin matrix , @xmath264 $ ] , by tensor operations @xmath265 figure [ fig : newt ] , left , shows several vectors of the canonical representation of the coulomb kernel along one of variables .",
    "figure [ fig : newt ] , right , represents the cross - section of the resulting nuclear potential @xmath266 for c@xmath169h@xmath267oh molecule .          the tensor - structured hartree - fock solver @xcite based on factorized calculation of the two - electron integrals @xcite includes efficient tensor implementation of the mp2 energy correction @xcite scheme .",
    "though it is yet implemented in matlab , its performance in time and accuracy is compatible with the standard packages based on analytical evaluation of the two - electron integrals .",
    "due to 1d complexity of all calculations , it enables 3d grids of the size @xmath268 , yielding mesh size of the order of atomic radii , @xmath196  .",
    "that ensures high accuracy of calculations , which is controlled by the @xmath194-ranks of tensor truncation .",
    "the solver works in a black - box way : input the grid - based basis - functions and coordinates of nuclei in a molecule and start the program .",
    "calculation of tei for h@xmath169o on grids @xmath226 takes two minutes on a laptop .",
    "the time for tei with @xmath269 for alanine amino acid takes approximately one hour in matlab , including incorporated density fitting .",
    "next examples compare the results from benchmark molpro program with calculations by the tensor - based solver by using the same gaussian basis , but now discretized on 3d cartesian grid .",
    "for all molecules we use the  cc - pvdz `` gaussian basis set .",
    "the core hamiltonian part in these calculations is taken from molpro .",
    "note that since in the tensor solver the density fitting is included in ' ' blind `` calculation of tei , it is not easy to compare the cpu times of our calculations with those in ' ' ab - initio  procedure in the standard programs , because the density fitting step there is usually considered as off - line pre - computing .",
    "figure [ fig : evp_h2o ] shows convergence history of _ ab initio _",
    "iterations for h@xmath169o molecule ( cc - pvdz-41 ) , where tei is computed on the 3d grid of size @xmath228 , while figure [ fig : evp_h2o ] ( right ) presents the zoom of the left graphic at the last 20 iterations .",
    "the ground state energy from molpro is shown by the black dashed line .",
    "o ; right : convergence of the ground state energy vs. final @xmath270 iterations for h@xmath169o.,title=\"fig:\",width=226]o ; right : convergence of the ground state energy vs. final @xmath270 iterations for h@xmath169o.,title=\"fig:\",width=226 ]    figure [ fig : evp_gly ] ( left ) shows the scf evp iteration for glycine amino acid ( cc - pvdz-170 ) , where dashed line indicates convergence of the residual and the red solid line shows convergence of the error to ground state energy from molpro package with the same basis set .",
    "figure [ fig : evp_gly ] ( right ) illustrates the convergence of the ground state energy at final @xmath270 iterations for glycine , dashed line is the energy from molpro .",
    "h@xmath267no@xmath169 ) molecule .",
    "right : convergence of the ground state energy at final @xmath270 iterations for glycine molecule.,title=\"fig:\",width=226]h@xmath267no@xmath169 ) molecule .",
    "right : convergence of the ground state energy at final @xmath270 iterations for glycine molecule.,title=\"fig:\",width=226 ]    the second row in table [ tab : fh - evp_times ] represents times ( sec ) for one step of scf iteration in ab - initio solution of the hartree fock evp for h@xmath169o ( cc - pvdz-41 ) , h@xmath169o@xmath169 ( cc - pvdz-68 ) , and c@xmath169h@xmath267no@xmath169 ( cc - pvdz-170 ) molecules while the first row shows the molecular parameters , number of orbitals and basis functions .",
    "next two rows show the relative difference @xmath271 , between the grid - based ground state energy , @xmath272 and @xmath273 from molpro with the same basis sets .",
    "this numerics demonstrates that in the case of fine enough spacial @xmath144-grids the accuracy in 7 - 8 digits ( i.e. relative accuracy about @xmath274 ) can be achieved for moderate size molecules up to small amino acids .",
    "all calculations are performed in the computational box of size @xmath246 ^ 3 $ ] bohr@xmath247 .",
    "this tensor - based solver can be considered as the computational tool for trying the alternatives to gaussian - type basis sets .",
    "given the set of hartree - fock molecular orbitals @xmath275 and",
    "the corresponding energies @xmath276 , @xmath277 , where @xmath278 and @xmath279 denote the occupied and virtual orbitals , respectively . first , one has to transform the tei matrix @xmath280 $ ] , corresponding to the initial ao basis set , to those represented in the molecular orbital ( mo ) basis , @xmath281 : \\quad v_{i a j b}= \\sum\\limits_{\\mu , \\nu , \\lambda , \\sigma = 1}^{n_b }   c_{\\mu i } c_{\\nu a }   c_{\\lambda j } c_{\\sigma b } b_{\\mu \\nu ,   \\lambda \\sigma},\\ ] ] where @xmath282 , @xmath283 , and @xmath284 , @xmath285 , with @xmath286 denoting the number of occupied orbitals . in the following , we shall use the notation @xmath287 the straightforward computation of the matrix @xmath288 by above representation makes the dominating impact to the overall numerical cost of order @xmath289 .",
    "the method of complexity @xmath290 based on the low - rank tensor decomposition of the matrix @xmath291 was introduced in @xcite .",
    "indeed , it can be shown that the rank @xmath292 approximation to the tei matrix @xmath293 with the @xmath294 cholesky factor @xmath5 , allows to introduce the low - rank representation of the matrix @xmath295 , ( see @xcite and @xcite ) @xmath296 and then reduce the asymptotic complexity of calculations to @xmath290 .",
    "given the tensor @xmath297 $ ] , the second order mp2 perturbation to the hf energy is calculated by @xmath298 where the real numbers @xmath299 , @xmath300 , represent the hf eigenvalues .",
    "introducing the so - called doubles amplitude tensor @xmath301 , @xmath302 : \\ ; t_{i a j b } =   \\frac{(2   v_{i a j b } - v_{i b j a})}{\\varepsilon_a + \\varepsilon_b -\\varepsilon_i - \\varepsilon_j } , \\quad a , b\\in i_{vir};\\ ; i , j\\in i_{occ},\\ ] ] the mp2 perturbation takes the form of a simple scalar product of tensors , @xmath303 where @xmath304 denotes the rank-@xmath9 all - ones tensor . introducing the low @xmath194-rank reciprocal  energy ",
    "tensor @xmath305:=\\left[\\frac{1}{\\varepsilon_a + \\varepsilon_b -\\varepsilon_i - \\varepsilon_j}\\right],\\quad a , b\\in i_{vir};\\ ; i , j\\in i_{occ},\\ ] ] and the partly transposed tensor ( transposition in indices @xmath192 and @xmath306 ) @xmath307:=[v_{ibja}],\\ ] ] allows to decompose the doubles amplitude tensor @xmath301 as follows @xmath308 notice that the denominator in ( [ mp2-coor ] ) remains strongly positive if @xmath309 for @xmath310 and @xmath311 for @xmath312 .",
    "the latter condition ( nonzero homo lumo gap ) allows to prove the low @xmath194-rank decomposition of the tensor @xmath313 @xcite .",
    "each term in the right - hand side in ( [ eqn : t = t1+t2 ] ) can be treated separately by using ranks - structured tensor decompositions of @xmath43 and @xmath313 , possibly combined with various symmetries and data sparsity .",
    "numerical tests illustrating the tensor approach to the mp2 energy correction are presented in @xcite .",
    "one of the commonly used approaches for calculation of the excited states in molecules and solids , along with the time - dependent dft , is based on the solution of the bethe - salpeter equation ( bse ) , see for example @xcite .",
    "the bse approach leads to the challenging computational task on the solution of the eigenvalue problem for determining the excitation energies @xmath314 , governed by a large fully populated matrix of size @xmath315 , @xmath316 so that the computation of the entire spectrum is prohibitively expensive . here",
    "the large matrix blocks of size @xmath317 take a form @xmath318 where the diagonal  energy  matrix is defined by @xmath319\\in \\mathbb{r}^{n_{ov}\\times n_{ov } } :   \\quad \\delta \\varepsilon_{ia , jb}= ( \\varepsilon_a - \\varepsilon_i)\\delta_{ij}\\delta_{ab } , \\ ] ] while the matrices @xmath320 $ ] and @xmath321 $ ] are determined by permutation of the so - called static screened interaction matrix @xmath322 $ ] , via @xmath323 , and @xmath324= [ { w}_{ib , aj } ] $ ] , respectively . in turn",
    ", the forth order tensor @xmath325 $ ] is constructed by certain linear transformations of the tensor @xmath326 $ ] , see @xcite .",
    "a number of numerical methods for structured eigenvalue problems have been discussed in the literature @xcite .",
    "the tensor approach to the solution of the partial bse eigenvalue problem for equation ( [ eqn : bse - gw1 ] ) proposed in @xcite suggests to compute the reduced basis set by solving the simplified eigenvalue problem via the low - rank plus diagonal approximation to the matrix blocks @xmath327 and @xmath221 , and then solve spectral problem for the subsequent galerkin projection of the initial system ( [ eqn : bse - gw1 ] ) to this reduced basis .",
    "this procedure relies entirely on multiplication of the simplified bse matrix with vectors .",
    "it was demonstrated on the examples of moderate size molecules@xcite that a small reduced basis set , obtained by separable approximation with the rank parameters of about several tens , allows to reveal several lowest excitation energies and respective excited states with the accuracy about @xmath328ev - @xmath329ev .",
    "lower eigenvalues for the reduced and exact bse systems for nh@xmath177 molecule : @xmath330 , left ; @xmath331 , right.,title=\"fig:\",width=234 ]   lower eigenvalues for the reduced and exact bse systems for nh@xmath177 molecule : @xmath330 , left ; @xmath331 , right.,title=\"fig:\",width=234 ]    figure [ fig : bse_nh3_reduced ] illustrates the bse energy spectrum of the nh@xmath177 molecule ( based on hf calculations with cc - pdvz-48 gto basis ) for the lowest @xmath332 eigenvalues vs. the rank truncation parameter @xmath333 and @xmath328 , where the ranks of @xmath291 and the bse matrix block @xmath334 are @xmath219 , @xmath81 and @xmath335 , @xmath336 , respectively . for the choice @xmath333 and @xmath331 ,",
    "the error in the 1st ( lowest ) eigenvalue for the solution of the problem in reduced basis is about @xmath337ev and @xmath338ev , correspondingly .",
    "the cpu time in the laptop matlab implementation of each example is about @xmath81sec .",
    "in this section , we briefly discuss the generalization of the tensor - based hartree - fock solver to the case of large lattice structured and periodic systems @xcite arising in the numerical modeling of crystalline , metallic and polymer type compounds .",
    "one of the challenges in the numerical treatment of large molecular systems is the summation of long - range potentials allocated on large 3d lattices .",
    "the conventional ewald summation techniques based on a separate evaluation of contributions from the short- and long - range parts of the interaction potential exhibit @xmath7 complexity scaling for a cubic @xmath339 3d lattice .    in the contrary",
    ", the main idea of the novel tensor summation method introduced in @xcite suggests to benefit from the low - rank tensor decomposition of the generating kernel approximated on the fine @xmath135 representation grid in the 3d computational box @xmath340 .",
    "this allows to completely decouple the 3d sum into the three independent @xmath9d summations , thus reducing drastically the numerical expenses .",
    "the resultant potential sum , which now requires only @xmath341 storage and @xmath342 computational demands , is represented by a few assembled canonical / tucker @xmath139-vectors of complicated shape ( see figure [ fig : assembl_can ] ) , where @xmath139 is the univariate grid size for a cubic 3d lattice .    for ease of exposition , we consider the electrostatic potential the nuclear potential of a single hydrogen atom , @xmath343 .",
    "define the scaled unit cell , @xmath344 ^ 3 $ ] , of size @xmath345 and consider a sum of interaction potentials in a symmetric computational box @xmath346 , \\quad l=2 l_0 \\in \\mathbb{n } , \\ ] ] consisting of a union of @xmath347 unit cells @xmath348 , obtained from @xmath349 by a shift along the lattice vector @xmath350 , where @xmath351 , such that @xmath352 for @xmath207 with @xmath353 and @xmath354 . hence , we have @xmath355 .",
    "recall that @xmath356 , where @xmath357 is the fine mesh size that is the same for all spatial variables , and @xmath139 is the number of grid points for each variable .",
    "we also define the accompanying domain @xmath358 obtained by scaling of @xmath359 with the factor of @xmath360 , @xmath361 , and , similar to ( [ eqn : sinc_general ] ) , introduce the respective rank-@xmath30 reference ( master ) tensor @xmath362 approximating @xmath363 in @xmath358 on a @xmath364 representation grid with mesh size @xmath18 .",
    "let us consider a sum of single coulomb potentials on a @xmath339 lattice , @xmath365 the assembled tensor approach applies to the potentials defined on @xmath135 3d cartesian grid .",
    "it reduces the sum over a rectangular 3d lattice , @xmath366 , @xmath367 to the summation of directional vectors for the canonical decomposition of shifted single newton kernels @xcite , @xmath368 where @xmath369 is the shift - and - windowing ( onto @xmath340 ) separable transform along the @xmath370-grid .",
    "remarkably that the rank of the resulting sum is the same as for the @xmath30-term canonical reference tensor ( [ eqn : reftensor ] ) representing the single newton kernel .    - and @xmath371-axis canonical vectors for a cluster of @xmath372 hydrogen nuclei.,title=\"fig:\",width=181]- and @xmath371-axis canonical vectors for a cluster of @xmath372 hydrogen nuclei.,title=\"fig:\",width=181 ]    the numerical cost and storage size are bounded by @xmath373 and @xmath374 , respectively , where @xmath375 , and @xmath376 is the grid size in the unit cell .",
    "figures [ fig : assembl_can ] and [ fig : assembl_can2 ] represent the shape of assembled canonical vectors for the cluster of @xmath372 hydrogen nuclei .",
    "size of the computational box is @xmath377 bohr@xmath247 . here",
    "the empty interval between the lattice and the boundary of the computational box equals to @xmath378 bohr .",
    "-axis canonical vectors for a cluster of @xmath372 hydrogen nuclei . assembled canonical sum of the newton potentials for this cluster.,title=\"fig:\",width=181]-axis canonical vectors for a cluster of @xmath372 hydrogen nuclei .",
    "assembled canonical sum of the newton potentials for this cluster.,title=\"fig:\",width=181 ]    the next table represents cpu times for the lattice summation of the newton kernels over @xmath339 cubic box , with very fine @xmath135 representation grid .",
    "[ c]|r|r|r|r|r|@xmath379 & @xmath380 & @xmath381 & @xmath382 & @xmath383 + time ( sec . ) & @xmath384 & @xmath385 & @xmath386 & @xmath387 + 3d grid size , @xmath171 & @xmath388 & @xmath389 & @xmath390 & @xmath391 +    -shaped ( left ) and @xmath392-shaped ( right ) sub - lattices of a @xmath393 lattice.,title=\"fig:\",width=207]-shaped ( left ) and @xmath392-shaped ( right ) sub - lattices of a @xmath393 lattice.,title=\"fig:\",width=207 ]    the summation method in the canonical format was extended to the tucker tensors which allows the principal generalization of this techniques to the case of rather complicated lattices with defects ( theorem 3.2 , @xcite ) , so that the resulting sum takes a form @xmath394 where @xmath395 , @xmath396 , represents the tucker vectors of the rank-@xmath61 master tensor approximating the newton kernel @xmath363 in @xmath358 on a @xmath364 representation grid .    in the case of defected lattices",
    "the increasing rank of the final sum of tucker tensors can be reduced by the stable als based algorithms applicable to the tucker tensors ( see @xcite ) .",
    "the particular examples of the lattice geometries suitable for our approach are presented in figure [ fig : vacance_l_o ] , see @xcite for more detailed discussion .    for the reduced hartree - fock equation , where the fock operator is confined to the core hamiltonian , the tensor - structured block - circulant representation of the fock matrix was introduced@xcite that allows the special low - rank approximation of the matrix blocks .",
    "this opens the way for the numerical treatment of large eigenvalue problems with structured matrices arising in the solution of the hartree - fock equation for large crystalline systems with defects .",
    "given the nuclear charges @xmath397 , centered at points @xmath398 , @xmath399 , located on a @xmath339 lattice @xmath400 with the step - size @xmath306 , the interaction energy of the total electrostatic potential of these charges is defined by the lattice sum @xmath401 the fast and accurate computation of electrostatic interaction energy ( as well as the related forces and stresses ) is one of the difficult tasks in computer modeling of macromolecular structures like finite crystal , and biological systems .    the tensor summation scheme ( [ eqn : coulomblattenscan ] ) can be directly applied to this computational problem . in what follows",
    "we show that ( [ eqn : energylatsum ] ) can be treated as a particular case of the previous scheme served for calculation of ( [ eqn : coulomblattice ] ) on a fine spacial grid .",
    "for this discussion , we assume that all charges are equal , @xmath402 .",
    "first , notice that the rank-@xmath30 reference tensor @xmath403 defined in ( [ eqn : reftensor ] ) approximates with high accuracy @xmath404 the ( and its shifted version ) coulomb potential @xmath363 in @xmath358 ( for @xmath405 that is required for the energy expression ) on the fine @xmath364 representation grid with mesh size @xmath18 .",
    "likewise , the tensor @xmath406 approximates the potential sum @xmath407 on the same fine representation grid including the lattice points @xmath398 .    we propose to evaluate the energy expression ( [ eqn : energylatsum ] ) by using tensor sums as in ( [ eqn : coulomblattenscan ] ) , but now applied to a small sub - tensor of the rank-@xmath30 canonical reference tensor @xmath408 , that is @xmath409\\in \\mathbb{r}^{2l \\times 2l\\times 2l}$ ] , obtained by tracing of @xmath408 at the accompanying lattice of the double size @xmath410 , i.e. @xmath411 . here @xmath412 denotes the tensor entry corresponding to the @xmath370-th lattice point designating the atomic center @xmath413 .",
    "we are interested in the computation of the rank-@xmath30 tensor @xmath414_{{\\bf k}\\in { \\cal k}}\\in \\mathbb{r}^{l \\times l\\times l}$ ] , where @xmath415 denotes the tensor entry corresponding to the @xmath370-th lattice point on @xmath416 . the tensor @xmath417 can be computed at the expense @xmath418 by @xmath419 this leads to the representation of the energy sum ( [ eqn : energylatsum ] ) with accuracy @xmath404 in a form @xmath420 where the first term in brackets represents the full canonical tensor lattice sum restricted to the @xmath370-grid composing the lattice @xmath416 , while the second term introduces the correction at singular points @xmath421 . here",
    "@xmath422 is the all - ones tensor . by using the rank-@xmath9 tensor @xmath423",
    ", the correction term can be represented by a simple tensor operation @xmath424    finally , the interaction energy @xmath425 allows the representation @xmath426 that can be implemented in @xmath427 complexity by tensor operations with the rank-@xmath30 canonical tensors in @xmath428 .",
    "table [ tab : ewalenergten ] illustrates the performance of the algorithm described above .",
    "we compare the exact value computed by ( [ eqn : energylatsum ] ) with the approximate tensor representation in ( [ eqn : energylattice ] ) computed on the fine representation grid with @xmath429 , @xmath430 .",
    "we consider the lattices consisting of hydrogen atoms with interatomic distance @xmath360 bohr .",
    "the size of the largest 3d lattice with @xmath431 potentials is of the size @xmath432 bohr bohr is the chosen dummy distance ( space between the computational box boundary and the lattice ) . ] , which is more than @xmath270 nanometers .",
    "[ c]|r|r|r|r|r|r|@xmath379 & total & t@xmath433 & t@xmath434 & @xmath425 & err .",
    "+ @xmath435 & @xmath436 & @xmath437 & @xmath438 & @xmath439 & @xmath440 + @xmath441 & @xmath381 & @xmath442 & @xmath443 & @xmath444 & @xmath445 + @xmath446 & @xmath447 & @xmath448 & @xmath449 & @xmath450 & 0 + @xmath451 & @xmath382 & - & @xmath452 & @xmath453 & - + @xmath454 & @xmath383 & - & @xmath455 & @xmath456 & - + @xmath431 & @xmath457 & - & @xmath458 & @xmath459 & - +    the presented approach for fast calculation of the interaction energy can extended to the case of non - uniform rectangular lattices and , under certain assumptions , to the case of non - equal nuclear charges @xmath460 .",
    "moreover , it applies to many other types of spherically symmetric interaction potentials , for example , to shielded coulomb interaction or van der waals attraction sums corresponding to the distance function @xmath461 and @xmath462 , respectively .",
    "the goal of this paper is to attract interest of the specialists in computational quantum chemistry to recent results and open questions of the grid - based tensor approach in electronic structure calculations .",
    "here we focus mostly on the description of main mathematical and algorithmic aspects of the tensor decomposition schemes and demonstrate their benefits in some applications .",
    "the scope of applications which can be regarded as consistent , ranges from the hartree - fock energy for moderate size molecules , including `` blind '' calculation of tei tensor with incorporated algebraic density fitting , to calculation of the excited states for molecules , and up to a unique superfast method for calculating the lattice potential sums and the interaction energy of long range potentials on a lattice in a finite volume .",
    "tensor approach allows to treat above problems using moderate computational facilities .",
    "all numerics given in the paper presents implementations in matlab .",
    "the described numerical tools are not restricted to the applications presented here , but can be applied to various hard computational problems in ( post ) hartree - fock calculations related to accurate evaluation of multidimensional integrals , and efficient storage and manipulations with large multivariate data arrays .",
    "the presented method for summation of long - range potentials with sub - linear computational cost does not have analogues in what is used so far in computational quantum chemistry and can have a good future .",
    "for example , it can be useful in modeling of large finite molecular structures like nanostructures or quantum dots , where the periodic approach may be inconsistent .",
    "calculating a sum of several millions of lattice potentials on fine 3d grids takes only several seconds in matlab on a laptop @xcite .",
    "this method gives also the unique possibility to present the summed 3d lattice potential in the whole computational region with very high accuracy .",
    "integration and differentiation of this 3d potential can be easily performed on representation grid due to 1d computational costs .",
    "tensor approach is now being evolved for modeling the electronic structure of finite crystalline - type molecular systems @xcite .",
    "we hope that tensor numerical methods will have a good future in solving challenging multidimensional problems of computational quantum chemistry .",
    "canonical - to - tucker transform*.    the canonical - to - tucker tensor transform combined with the tucker - to - canonical scheme introduced in @xcite usually applies for the rank reduction of the function related canonical tensors with the large initial rank .",
    "here we sketch algorithm _ canonical - to - tucker _ which includes the following basic steps :    _ input data _ : side matrices @xmath33   \\in \\mathbb{r}^{n_\\ell \\times r}$ ] , @xmath34 , composed of vectors @xmath32 , @xmath36 , see ( [ eqn : cp_form ] ) ; maximal tucker - rank parameter @xmath61 ; maximal number of the alternating least square ( als ) iterations @xmath463 ( usually a small number ) .    *",
    "( a ) * compute the singular value decomposition ( svd ) of side matrices : @xmath464 discard the singular vectors in @xmath465 and the respective singular values up to given rank threshold , yielding the small orthogonal matrices @xmath466 , @xmath68 .",
    "@xmath471 for @xmath67 : construct partially projected image of the full tensor , @xmath472 here @xmath473 are in physical space for mode @xmath67 , while @xmath474 and @xmath475 , the column vectors of @xmath476 and @xmath477 , respectively , belong to the coefficients space by means of projection .",
    "@xmath471 reshape the tensor @xmath478 into a matrix @xmath479 , representing the span of the optimized subset of mode-@xmath9 columns in partially projected tensor @xmath480 .",
    "compute the svd of the matrix @xmath481 : @xmath482 and truncate the set of singular vectors in @xmath483 , according to the restriction on the mode-@xmath9 tucker rank , @xmath484 .            *",
    "( e ) * project the final iterated tensor @xmath491 in ( [ eq : alg2 ] ) using the resultant basis set in @xmath490 to obtain the core tensor , @xmath492 . _ output data _ : the tucker core tensor @xmath493 and the tucker orthogonal side matrices @xmath494 , @xmath34 .",
    "the _ canonical - to - tucker _ algorithm can be easily modified to the @xmath194-truncation stopping criteria .",
    "notice that in the case of equal tucker ranks , @xmath495 , maximal canonical rank of the core tensor @xmath493 does not exceed @xmath496 , see @xcite , which completes the tucker - to - canonical part of the total algorithm .",
    "( further optimization of the canonical rank in the small - size core tensor @xmath493 can be implemented by applying the als iterative scheme in the canonical format , see e.g. @xcite . )",
    "the @xmath497-electrons hartree - fock equation for pairwise @xmath498-orthogonal electronic orbitals , @xmath499 , @xmath500 , reads as @xmath501 where the nonlinear fock operator @xmath502 is given by @xmath503 here the nuclear potential takes the form @xmath504 , @xmath505 , @xmath506 , while the hartree potential @xmath507 and the nonlocal exchange operator @xmath508 read as @xmath509 and @xmath510 respectively .",
    "conventionally , we use the definitions @xmath511 for the density matrix @xmath512 , and electron density @xmath513 .",
    "usually , the hartree - fock equation is approximated by the standard galerkin projection of the initial problem ( [ hafo eq . ] ) by using the physically justified reduced basis sets ( say , gto type orbitals ) . for a given finite galerkin basis set @xmath514 , @xmath515 ,",
    "the occupied molecular orbitals @xmath516 are represented ( approximately ) as @xmath517 to derive an equation for the unknown coefficients matrix @xmath518 , first , we introduce the mass ( overlap ) matrix @xmath519 , given by @xmath520 and the stiffness matrix @xmath521 of the core hamiltonian @xmath522 ( the single - electron integrals ) , @xmath523 the core hamiltonian matrix @xmath524 can be precomputed in @xmath525 operations via grid - based approach .",
    "given the finite basis set @xmath514 , @xmath515 , the associated fourth order two - electron integrals ( tei ) tensor , @xmath526 $ ] , is defined entrywise by ( [ eqn : tei_tens ] ) , where @xmath527 . in computational quantum chemistry",
    "the nonlinear terms representing the galerkin approximation to the hartree and exchange operators are calculated traditionally by using the low - rank cholesky decomposition of a matrix associated with the tei tensor @xmath528 $ ] defined in ( [ eqn : tei_tens ] ) , that initially has the computational and storage complexity of order @xmath290 .",
    "introducing the @xmath529 matrices @xmath530 and @xmath531 , @xmath532 where @xmath533 is the rank-@xmath286 symmetric density matrix , one then represents the complete fock matrix @xmath534 by @xmath535 the resultant galerkin system of nonlinear equations for the coefficients matrix @xmath536 , and the respective eigenvalues @xmath537 , reads as @xmath538 where the second equation represents the orthogonality constraints @xmath539 , and @xmath540 denotes the @xmath541 identity matrix . +",
    "tensor approximation to the newton kernel in 3d .",
    "*    methods of separable approximation to multivariate spherically symmetric functions by using the gaussian sums have been addressed in the chemical and mathematical literature since @xcite and @xcite , respectively .    in this section ,",
    "we discuss for the readers convenience the grid - based method for the low - rank canonical and tucker tensor representations of a spherically symmetric functions @xmath542 , @xmath543 in the particular case of the 3d newton kernel @xmath544 , @xmath545 by its projection onto the set of piecewise constant basis functions , see @xcite for more details .",
    "in the computational domain @xmath546 ^ 3 $ ] , let us introduce the uniform @xmath547 rectangular cartesian grid @xmath548 with the mesh size @xmath549 ( usually , @xmath550 ) .",
    "let @xmath551 be a set of tensor - product piecewise constant basis functions , @xmath552 , for the @xmath2-tuple index @xmath553 , @xmath554 , @xmath555 .",
    "the kernel @xmath542 can be discretized by its projection onto the basis set @xmath551 in the form of a third order tensor of size @xmath144 , defined entrywise as @xmath556 \\in \\mathbb{r}^{n\\times n \\times",
    "n } ,   \\quad   p_{\\bf i } =   \\int_{\\mathbb{r}^3 } { \\psi_{{\\bf i}}({x})}p({\\|{x}\\| } ) \\,\\ , \\mathrm{d}{x}.     \\label{galten}\\end{aligned}\\ ] ]    given @xmath557 , the low - rank canonical decomposition of the @xmath2rd order tensor @xmath558 is based on using exponentially convergent @xmath559-quadratures for approximation of the laplace - gauss transform to the analytic function @xmath560 as follows , @xmath561 where the quadrature points and weights are given by @xmath562    under the assumption @xmath563 , @xmath564 , this quadrature can be proven to provide the exponential convergence rate in @xmath557 for a class of analytic functions , see @xcite , @xmath565 combining and , and taking into account the separability of the gaussian basis functions , we arrive at the low - rank approximation to each entry of the tensor @xmath558 , @xmath566 define the vector ( recall that @xmath567 ) @xmath568_{i_\\ell=1}^{n } \\in \\mathbb{r}^{n } \\mbox { with }    b^{(\\ell)}_{i_\\ell}(t_k)=   \\int_{\\mathbb{r } } \\psi^{(\\ell)}_{i_\\ell}(x_\\ell ) e^{- t_k^2 x^2_\\ell } \\mathrm{d}x_\\ell,\\ ] ] then the @xmath2rd order tensor @xmath558 can be approximated by the @xmath30-term canonical representation @xmath569 where @xmath570 , and the canonical vectors are renumbered by @xmath571 , @xmath572 , @xmath68 .",
    "for the given threshold @xmath573 , @xmath574 is chosen as the minimal number , such that in the max - norm we have @xmath575 the symmetric canonical tensor @xmath214 in ( [ eqn : sinc_general ] ) approximates the discretized 3d symmetric kernel function @xmath576 ( @xmath577 ) , centered at the origin , such that @xmath578 ( @xmath579 ) ."
  ],
  "abstract_text": [
    "<S> we resume the recent successes of the grid - based tensor numerical methods and discuss their prospects in real - space electronic structure calculations . </S>",
    "<S> these methods , based on the low - rank representation of the multidimensional functions and integral operators , first appeared as an accurate tensor calculus for the 3d hartree potential using 1d complexity operations , and have evolved to entirely grid - based tensor - structured 3d hartree - fock eigenvalue solver . </S>",
    "<S> it benefits from tensor calculation of the core hamiltonian and two - electron integrals ( tei ) in @xmath0 complexity using the rank - structured approximation of basis functions , electron densities and convolution integral operators all represented on 3d @xmath1 cartesian grids . </S>",
    "<S> the algorithm for calculating tei tensor in a form of the cholesky decomposition is based on multiple factorizations using algebraic 1d  density fitting  scheme , which yield an almost irreducible number of product basis functions involved in the @xmath2d convolution integrals , depending on a threshold @xmath3 . </S>",
    "<S> the basis functions are not restricted to separable gaussians , since the analytical integration is substituted by high - precision tensor - structured numerical quadratures . </S>",
    "<S> the tensor approaches to post - hartree - fock calculations for the mp2 energy correction and for the bethe - salpeter excited states , based on using low - rank factorizations and the reduced basis method , were recently introduced . </S>",
    "<S> another direction is related to the recent attempts to develop a tensor - based hartree - fock numerical scheme for finite lattice - structured systems , where one of the numerical challenges is the summation of electrostatic potentials of a large number of nuclei . </S>",
    "<S> the 3d grid - based tensor method for calculation of a potential sum on a @xmath4 lattice manifests the linear in @xmath5 computational work , @xmath6 , instead of the usual @xmath7 scaling by the ewald - type approaches . </S>",
    "<S> the accuracy of the order of atomic radii , @xmath8 , for the grid representation of electrostatic potentials is achieved due to low cost of using @xmath9d operations on large 3d grids .    _ </S>",
    "<S> key words : _ electronic structure calculations , two - electron integrals , multidimensional integrals , tensor decompositions , quantized tensor approximation , low - rank cholesky factorization , reduced higher order svd , hartree - fock equation , excited states , lattice potential sums .    </S>",
    "<S> _ ams subject classification : _ </S>",
    "<S> 65f30 , 65f50 , 65n35 , 65f10 </S>"
  ]
}