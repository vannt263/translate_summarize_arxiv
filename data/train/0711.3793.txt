{
  "article_text": [
    "while the current generation of cmb experiments have had a significant impact on cosmology by helping to establish a standard paradigm for cosmology @xcite , the upcoming generation of cmb experiments still has the potential to provide novel new insights into cosmology .",
    "planck and ground based experiments , such as the atacama cosmology telescope ( act ) , will be mapping the cmb sky with significantly higher angular resolution than ever before .",
    "secondary anisotropies on small angular scales encode important information about the late time interaction of cmb photons with structure in the universe .",
    "one of the most basic of these interactions is the gravitational effect of the large scale structure potentials deflecting the paths of the photons , an effect justifiably referred to as the gravitational lensing of the cmb .",
    "the effect of gravitational lensing can be thought of as a remapping of the unlensed cmb field by a line - of - sight averaged deflection field ( for a recent review , see * ? ? ?",
    "* ) . therefore , lensing does not change the one - point properties of the cmb .",
    "however , it does modify the two and higher - point statistics , and generates non - gaussianity @xcite .",
    "although the typical deflection suffered by a cmb photon during its cosmic journey is about three arcminutes , the deflections themselves are coherent over several degrees , which is comparable to the typical size of the acoustic features on the cmb .",
    "thus lensing causes coherent distortions of the hot and cold spots on the cmb , and thereby broadens their size distribution .",
    "this leads to redistribution of power among the acoustic scales in the cmb , and shows up in the two - point statistics as a smoothing of the acoustic peaks . at smaller scales , where the primordial cmb is well approximated by a local gradient",
    ", deflectors of small angular size produce small - scale distortions in the cmb , thereby transferring power from large scales in the cmb to the higher multipoles . also ,",
    "although the primordial cmb can be safely assumed to be a gaussian random field @xcite , and the large scale lensing potential can also be well approximated by a gaussian random field , the lensed cmb being a reprocessing of one gaussian random field by another is itself not gaussian .",
    "the effect of lensing on the power spectrum of the cmb is important enough that it should be taken into account while deriving parameter constraints with future higher resolution experiments .",
    "but what is even more interesting is that the non - gaussianity in the lensed cmb field should enable us to extract information about the projected large scale structure potential , and thereby constrain the late time evolution of the universe and dark energy properties .",
    "therein lies the main motivation of studying this effect in utmost detail .",
    "progress in this area has been slow .",
    "measurements of the cmb precise enough to enable a detection of weak lensing were not available in the pre - wmap era .",
    "also , picking out non - gaussian signatures in the measured cmb sky by itself is extremely difficult , due to confusion from systematics , foregrounds , and limited angular resolution .    rather than looking at signatures of lensing only in the cmb",
    ", one can also measure to what extent the deflection field estimated from the cmb correlates with tracers of the large scale structure which contributed to the lensing .",
    "it is easily realized that this approach is powerful @xcite because many of the systematics disappear upon cross - correlating data sets .",
    "this approach was taken in recent years by @xcite and @xcite , using wmap 1-year and 3-year data respectively .",
    "the former work looked at the cross correlation with sdss luminous red galaxies ( lrg ) , while the latter used the nrao - vla sky survey ( nvss ) radio sources as their large scale structure tracers .",
    "as the lensing efficiency for the cmb is highest between redshifts of one and four , higher redshift tracers should show greater cross correlation signal , which makes the nvss radio sources better tracers for such study ; @xcite report a @xmath1 detection .",
    "an independent analysis by @xcite looking for this effect in the wmap 3-year data in cross correlation with sdss lrg+qso and nvss sources find this signal at the @xmath2 level . with these pioneering efforts and with higher resolution cmb data from experiments such as act , planck and the south pole telescope ( spt ) on the horizon",
    ", we are entering an era where robust detection and characterization of this effect will become a reality . also , with upcoming and proposed large scale structure projects ( lsst , snap , adept , destiny , etc . )",
    "there will in future be many more datasets to cross - correlate with the cmb .",
    "one of the immediate results of such cross - correlation studies will be a measurement of the bias of the tracer population .",
    "because such cross correlations tie together early universe physics from the cmb and late time evolution from large scale structure , they will also be sensitive to dark energy parameters @xcite and neutrino properties @xcite , and can potentially break several parameter degeneracies in the primordial cmb ( m.  santolini , s.  das and d.  n.  spergel , in preparation ) .",
    "combination of galaxy or cluster lensing of the cmb with shear measurements from weak lensing of galaxies can also provide important constraints on the geometry of the universe ( s.  das and d.   n.  spergel , in prep ; * ? ? ?",
    "again , with high enough precision of cmb data , it is possible to estimate , using quadratic @xcite or maximum likelihood @xcite estimators , the deflection field that caused the lensing .",
    "such estimates can be turned into strong constraints of the power spectrum of the projected lensing potential @xcite , which is also sensitive to the details of growth of structure .",
    "the estimated potential from the lensed cmb alone , or the potential estimated from weak lensing surveys @xcite , can be also used to significantly de - lens the cmb .",
    "this is particularly important in the detection of primordial tensor modes via measurements of cmb polarization .",
    "this is because ( even though detection of the so - called b modes in cmb polarization is hailed as the definitive indicator of the presence of gravitational waves from the inflationary era ) these mode can be potentially contaminated by the conversion of e - modes into b - modes via gravitational lensing . de - lensing provides a way of cleaning these contaminating b - modes produced by lensing and thereby probing the true gravitational wave signature .    in this paper , we describe a method for simulating the gravitational lensing of the cmb temperature field on a large area of the sky using a high resolution tree - particle - mesh ( tpm ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) simulation of large scale structure to produce the lensing potential .",
    "the reason for considering a large area of the sky is twofold .",
    "first , the deflection field has most of its power on large scales ( the power spectrum of the deflection field peaks at @xmath3 in the best - fit cosmological model ) , and much of the power redistribution in the acoustic peaks of the cmb occurs via coupling of modes in the cmb with these large coherent modes in the deflection field .",
    "a large sky allows for several such modes to be realized .",
    "it is estimated that a small ( flat ) sky simulation that misses these modes would typically underestimate the lensing effect by about @xmath4 in the acoustic regime , and more in the damping tail @xcite .",
    "second , one of the major goals of simulations such as this is to produce mock observations for upcoming cmb experiments .",
    "planck is an all - sky experiment , and many of the future cmb experiments ( including act and spt ) will observe relatively large patches of the sky . therefore , simulating cmb fields on a large area of the sky is a necessity .",
    "this method fully takes into account the curvature of the sky .",
    "although presented here for a polar cap like area , it can be trivially extended to the full sky .",
    "the value of a simulation as described here is multifaceted , particularly in the development of algorithms for detection and characterization of the cmb lensing effect for a specific experiment . since each experiment has a unique scanning mode , beam pattern , area coverage , and foregrounds , operations and optimizations performed on the data to extract the lensing information will have to be tailored to the specific experiment . a large - sky lensed cmb map acting as an input for a telescope simulator provides the flexibility of exploring various observing strategies , and also allows for superposition of known foregrounds .",
    "another important aspect of this simulation is that the halos identified in the large scale structure simulation can be populated with different tracers of interest .",
    "also , other signals , such as the thermal and kinetic sunyaev zeldovich effects and weak lensing of galaxies by large scale structure , can be simulated using the same large scale structure .",
    "this opens up the possibility of studying the cross - correlation of the cmb lensing signal with various indicators of mass , and thereby predicting the level of scientific impact that a specific combination of experiments can have .",
    "as noted in @xcite , the exact simulation of the lensed cmb sky , which requires the computation of spin spherical harmonics on an irregular grid defined by the original positions of the photons on the cmb surface , is computationally expensive and requires robust parallelization .",
    "@xcite suggested an alternative in which one would resample an unlensed cmb sky , generated with finer pixelation , at these unlensed positions .",
    "this method was implemented in the publicly available lenspix code that was based on @xcite .",
    "however , producing a high resolution lensed map requires a much higher resolution unlensed map , the generation of which becomes computationally more expensive as resolution increases .",
    "here we put forward another alternative , in which we do the resampling with a combination of fast spherical harmonic transform on a regular grid followed by a high order polynomial interpolation .",
    "this interpolation scheme has been adapted from @xcite , and is called the non - isolatitude spherical harmonic transform ( nisht ) .",
    "this method is accurate as well as fast , and does not require parallelization or production of maps at a higher resolution .",
    "another added advantage of this method is that the same algorithm can be used to generate the gradient of a scalar field on an irregular grid .",
    "since the deflection field is a gradient of the lensing potential , this opens up the possibility of performing a multiple plane ray tracing simulation .",
    "this is because the rays , as they propagate from one plane to another , end up on irregular grids , so the deflection fields on the subsequent planes have to be evaluated on irregular grids . at the time of the development of this project",
    ", lenspix did not include an interpolation scheme , and used the methods as described originally in that paper .",
    "concurrently with the completing of the current work , an interpolation scheme @xcite different from the one described here has been added to that code .",
    "another notable difference of our results with lenspix , is that while the latter uses a gaussian random realization of the deflection field , we have used a large scale structure simulation to produce the same , thereby including all higher order correlations due to non - linearities .",
    "the paper is laid out as follows . in  [ algorithm ]",
    "we explain the lensing algorithm , describing the governing equations in  [ equations ] and their discretization in  [ discretization ] .",
    "then we discuss the effective lensing approach (  [ effective_lensing ] ) as well as the multiple plane ray tracing approach (  [ multiple_plane ] ) . at the heart of the lensing algorithm",
    "lies the non - isolatitude spherical harmonic transform algorithm adapted from @xcite , which is reproduced in some detail for completeness in  [ interpolation ] .",
    "as discussed earlier , we have employed a light cone @xmath5-body simulation and adopted a special polar cap like geometry for generating the lensing planes (  [ plane_generation ] ) . for comparison of the simulated fields with theoretical prediction , we compute the angular power spectra on the polar cap window ; in  [ angular_power_spectra ] we describe some of the subtleties involved in computing the power spectra .",
    "we present our results in  [ results ] and describe the tests that we have performed in  [ tests ] .",
    "conclusions are presented in  [ conclusions ] .",
    "we would like to note here that while the calculations for the simulation described here has been done for a flat universe , our approach is generalizable to non - flat geometries .",
    "the deflection angle of a light ray propagating through the space is [ deflection ] d=-2_d , where is @xmath6 is the deflection angle , @xmath7 is the newtonian potential , @xmath8 denotes the spatial gradient on a plane perpendicular to light propagation direction and @xmath9 is the radial comoving distance .",
    "the transverse shift of the light ray position at @xmath9 due to a deflection at @xmath10 is given by dx ( ) = d_a(- ) d( ) , where @xmath11 is the comoving angular diameter distance .",
    "the final angular position @xmath12 is therefore given by [ finalpos ] ( ) & = & ( 0)-_0^ d d_a(- ) _ + & = & ( 0)+@xmath13 ( ) , where @xmath14 is the total effective deflection .",
    "we will now discretize the above equations by dividing the radial interval between the observer and the source into @xmath5 concentric shells each of comoving thickness @xmath15 .",
    "we project the matter in the @xmath16-th shell onto a spherical sheet at comoving distance @xmath17 which is halfway between the the edges of the shell ( @xmath16 increases as one moves away from the observer ) .",
    "since we shall be working in spherical coordinates it is advantageous to use angular differential operators instead of spatial ones .",
    "we rewrite equation @xmath18[deflection]@xmath19 in terms of the angular gradient @xmath20 as [ deflection2 ] d=- _ d. at the @xmath21-th shell at @xmath22 , the deflection angle due to the matter in the shell can be approximated by an integral of the above : ^j&=&-__j-/2^_j+/2 _ ( ;) d + & = & - _ ^j ( ) , where we have defined the 2-d potential on the sphere as ^j()=__j-/2^_j+/2 ( ; ) d . here",
    ", the notation @xmath23 signifies that the potential is evaluated at the conformal look - back time @xmath9 , when the photon was at the position @xmath24 .",
    "the potential can be related to the mass overdensity in the shell via poisson s equation , which reads ^2_&= & , @xmath25 being the mean matter density of the universe at redshift @xmath26 . by integrating the above equation along the line of sight",
    ", one can arrive at a two dimensional version of the poisson equation @xcite , [ 2dpoisson ] ^2 _ ^j()= _ ^j ( ) where the surface mass density [ def : delta_sigma ] _",
    "^j=__j-/2^_j+/2(-| ) d. note that in going from the three dimensional to the two dimensional version , the term containing the radial derivatives of the laplacian can be neglected @xcite .",
    "one can show that this term is small by expanding the potential @xmath7 in fourier modes @xmath27 , with components @xmath28 parallel to the line of sight and @xmath29 transverse to it .",
    "then , the ratio of the components of the line of sight integral in the parallel and transverse directions will be @xmath30 .",
    "due to cancellation along the line of sight , only the modes with wavelengths comparable to the line of sight depth of each slice will survive the radial integral",
    ". these would be the modes with @xmath31 . on the other hand ,",
    "the transverse component gets most of its contribution from scales smaller than @xmath32 mpc i.e. @xmath33 mpc@xmath34 . under the effective lensing approximation ,",
    "the projection is along the entire line of sight from zero redshift to the last scattering surface , @xmath35 mpc , giving @xmath36 mpc@xmath34 .",
    "therefore , in this case the ratio of the radial and transverse components of the integral will be @xmath37 . for a multiple plane case",
    ", we would typically employ @xmath38 lensing planes for which this ratio would be @xmath39 .",
    "the approximation will break down if we employ thin shells .    defining the field",
    "@xmath40 as [ def : k ] k^j()= _ ^j ( ) , equation @xmath18[2dpoisson]@xmath19 takes the form [ phi_k ] ^2 _ ^j()=2 k^j ( ) .",
    "it is convenient to define an angular surface mass density @xmath41 as the mass per steradian , _",
    "^j ( ) = _ _ j-/2^_j+/2 ( -| ) d. the surface mass density defined in equation @xmath18[def : delta_sigma]@xmath19 is related to this through the relation [ def : sigma_theta ] _",
    "this implies the following form of equation @xmath18[def : k]@xmath19 , [ def : kth ] k^j()= _ ^j ( ) .",
    "equation ( [ def : kth ] ) is the key equation here .",
    "the quantity @xmath40 can be readily calculated once the mass density is radially projected onto the spherical sheet .",
    "expanding both sides of equation @xmath18[phi_k]@xmath19 in spherical harmonics , one has the following relation between the components : [ philm ] _",
    "it is interesting to note that the apparently divergent monopole @xmath42 modes in the lensing potential can be safely set to zero in all calculations , because a monopole term in the lensing potential does not contribute to the deflection field .",
    "being the transverse gradient of the potential , the deflection angle @xmath43 is a vector ( spin 1 ) field defined on the sphere and can be synthesized from the spherical harmonic components of the potential in terms of vector spherical harmonics , as will be described in   [ interpolation ] .",
    "geometry illustrating the point remapping used in the text ]    in weak lensing calculations , one often takes an effective approach , in which one approximates the effect of deflectors along the entire line of sight by a projected potential or a convergence which is computed along a fiducial undeflected ray ( often referred to as the born approximation ) .",
    "one therefore defines an effective lensing potential out to comoving distance @xmath44 as ^eff()=2_0^_s d ( ; ) . in terms of the projected potential , the effective deflection ( see eq .",
    "[ finalpos ] ) is given by the angular gradient , @xmath45 .",
    "an effective convergence is also defined in a similar manner : ( ) & = & _ ^2 ^eff ( ) + & = & d _",
    "^2 ( ;) . in terms of the fields @xmath46 and @xmath47 defined on the multiple planes , these quantities are immediately identified as the following sums , ^eff()_j ^j ( ) , + [ eq : kappa ] ( ) _ j k^j ( ) .",
    "once @xmath48 is obtained one can go through the analog of equation ( [ philm ] ) and take its transverse gradient to obtain the effective deflection @xmath49 . using this , one can find the source position corresponding to the observed position @xmath50 : [ eq : effective_lensing ] _ s=(0)+ . in  [ results ] , we shall use this effective or single plane approximation to lens the cmb .",
    "equation ( [ eq : effective_lensing ] ) is to be interpreted in the following manner @xcite .",
    "the effective deflection angle is a tangent vector at the undeflected position of the ray .",
    "the original position of the ray on the source , or unlensed , plane is to be found by moving along a geodesic on the sphere in the direction of the tangent vector and covering a length @xmath51 of an arc .",
    "the correct remapping equations can be easily derived from identities of spherical triangles @xcite . for completeness",
    ", we give the derivation here .    in fig .",
    "[ sphericaltriangle ] , let the initial and final position of the ray in question be the points a@xmath52 and b@xmath53 , respectively .",
    "the north pole of the sphere is indicated as c , so that the dihedral angle at a is also the angle between @xmath49 and @xmath54 , so that = -+ . now , applying the spherical cosine rule to the triangle abc , we have ^=+ , and applying the sine rule = .",
    "we use these equations to remap points on the cmb sky and on the intermediate spherical shells in the multiple plane case , as described below .",
    "geometry illustrating the multiple plane ray tracing method . ]    in the multiple plane case , we shoot ray outwards from the common center of the spherical shell ( i.e. the observer ) and follow their trajectories out to the cmb plane , thereby studying the time reversed version of the actual phenomenon .",
    "we assume all intermediate deflections are small , as is really the case . here",
    "we describe how we keep track of a ray propagating between multiple planes , as shown in fig .",
    "[ multiplane ] .",
    "we assume a flat cosmology for this purpose . at some intermediate stage of the ray propagation ,",
    "let a ray be incident on the @xmath16-th plane at the point a , where it gets deflected and reaches the @xmath16 + 1-th plane at the point d. the ray incident at a will not in general lie on the same plane as defined by the deflected ray @xmath55 and the center o of the sphere , which we also consider as the plane of the figure .",
    "assuming that we know the incidence angle @xmath56 , we can obtain the additional angle of deflection @xmath57 due to the matter on plane @xmath16 and compute the net deflection @xmath58 .",
    "let us denote by @xmath59 , the effective angle , by which a ray has to be remapped from its observed position @xmath60 to its current position @xmath61 on plane i , so that _ i = ( 0 ) + _ i .",
    "obviously , @xmath62 and @xmath63 .",
    "therefore , the effective angle @xmath64 by which the ray has to be remapped from point b to point d on the shell @xmath16 + 1 can be readily calculated from two descriptions of the arc bd , [ effective_angle_i+1 ] _",
    "i+1 ( _ i+1-_i)=(_i+1-_i ) ( _ i+_i ) . in order to repeat this process for the ( @xmath16 + 2)-th shell",
    ", one needs to know the value of the new incidence angle @xmath65 .",
    "we now equate two ways of finding the length of the arc ac , _ i ( _ i+1-_i)=(_i+1-_i ) _ i+1 . substituting @xmath64 from equation @xmath18[effective_angle_i+1]@xmath19 , [ incidence_angle_i+1 ]",
    "_ i+1= ( _ i+_i ) .",
    "since we shoot the rays radially on the first plane , @xmath66 ; therefore equations ( [ effective_angle_i+1 ] ) and ( [ incidence_angle_i+1 ] ) can be used to propagate the ray back to the cmb surface , which we take to be the @xmath67-th plane , i.e. @xmath68 . although we only discuss results obtained with the effective or single plane approximation here , the multiple plane version is straightforward to perform and will be reported elsewhere .      in practice",
    "we have used the @xcite scheme to represent fields on the sphere . at various stages of the lensing calculation , an accurate algorithm for interpolation on the sphere becomes a necessity . in the effective lensing approximation ,",
    "the original positions of the rays will in general be off pixel centers .",
    "this implies that the lensed cmb field is essentially generated by sampling the unlensed cmb surface at points which are usually not pixel centers .",
    "hence , obtaining the lensed cmb field is essentially an interpolation operation . in the case of multiple lensing planes ,",
    "it is again obvious that ( except for the first plane , on which we can shoot rays at pixel centers by way of convenience ) the deflection field itself has to be evaluated at off - center points on all subsequent planes .",
    "so , together with the interpolation of the temperature map .",
    "we need to go between spin-0 and spin-1 fields on an arbitrary grid .",
    "therefore , one needs , in general , a spherical harmonic transform algorithm that can deal with an irregular grid on the sphere .    for this purpose",
    ", we adopt the non - isolatitude spherical harmonic transform ( nisht ) algorithm proposed by @xcite ; details of the algorithm can be found in appendix a of that paper .",
    "here we have reproduced the key equations for clarity , and described the salient features of the general algorithm with special attention to aspects which are relevant for the current application .",
    "the basic operation for generating the lensed cmb maps can be broken up into two steps : + generating the deflection field on the sphere at points where the rays land from the previous plane , and + sampling the unlensed cmb surface at the source - plane positions of the rays to generate the lensed cmb field .",
    "of course , in case of the effective lensing simulation , one can conveniently generate the deflection field at the pixel centers in step  * l1 * above .",
    "as step  * l2 * is a series of operations involving scalars and therefore conceptually simpler , we shall explain the nisht algorithm in relation to this step .",
    "step   * l1 * , which involves spin-1 fields on the sphere , is conceptually similar to the spin-0 case .",
    "the problem in step  * l2 * is that we know the cmb temperature field @xmath69 on the grid @xmath70 as well as the source - plane positions of the rays @xmath71 on the polar cap , and we want to sample the cmb field at @xmath71 .",
    "suppose , by applying the steps for spherical harmonic analysis ( as will be described later ) , we have the spherical harmonic components , @xmath72 of the temperature field .",
    "now , we need to synthesize the field using these @xmath72 s at the points @xmath71 . this operation can be formally written as t( ) = _ = 0^__m = -^ t_y_( ) , where @xmath73 is the nyquist multipole and is set by the resolution of the grid as , @xmath74 ( cf . equation [ eqn : pixarea ] ) .",
    "this synthesis operation can be split into the following four steps ( eqns .",
    "[ latitude_transform ] through [ interpolation_weights ] are essentially reproduced for completeness from appendix a of @xcite ) :    1 .",
    "_ coarse grid latitude transform _ + as the first step , we perform a transform in the latitude direction on an equally spaced set of points , @xmath75 , where @xmath76 is an integer in the range @xmath77 and @xmath78 is a small integral multiple of some power of two such that @xmath79 : [ latitude_transform ] t_m(= ) =",
    "_ = ^ t_y_(= l , = 0 ) .",
    "the above calculation involves @xmath80 operations .",
    "refinement of latitude grid _ + in this step we reduce the @xmath81 grid spacing from @xmath82 to @xmath83 where @xmath84 .",
    "we take advantage of the fact the sampling theorem can be applied to a linear combination of spherical harmonics which is band limited @xmath85 in the multipole space , and hence can be written as a fourier sum , t_m ( ) = _",
    "n=-^ c_m , n e^in .",
    "we determine the coefficients @xmath86 via a fast fourier transform ( fft ) of length @xmath87 and evaluate @xmath88 using an inverse fft of length @xmath89 .",
    "this step saves us the expensive generation of associated legendre polynomials on the finer grid .",
    "each fft requires @xmath90 operations .",
    "projection onto equicylindrical grid _ + next , we perform the standard sht step of taking an fft in the longitudinal direction to generate @xmath91 , t(= , = ) = _ m = -^ m = t_m ( ) e^i m . after this step",
    "we have synthesized the map on an equicylindrical projection ( ecp ) grid .",
    "the operation count for this step is @xmath92 and the total operation count including this step is @xmath93 .",
    "interpolation onto the final grid _ + in the final step , given a required position @xmath94 , we find the nearest grid point in the ecp grid and determine the fractional offset , @xmath95 between the two points , + = l ; + = l .",
    "then we perform a two dimensional polynomial interpolation using @xmath96 points around the nearest grid point , obtaining the value at the required point as t_=-k+1^k w _ ( _ ) _ = -k+1^k w _ ( _ ) t ( , ) , with the weights computed using lagrange s interpolation formula , [ interpolation_weights ] w _ ( ) = _ = -k+1^k ( - ) .",
    "the inverse of the synthesis operation described above is the analysis operation , in which the spherical harmonic coefficients of a map defined on an irregular grid is needed .",
    "this can be thought of as the transpose of the above operations applied in reverse , and hence can be accomplished in an equal number of steps .",
    "the above algorithm can be easily extended to deal with vector and tensor fields on the sphere . for a vector ( spin 1 )",
    "field , the natural basis of expansion are the vector spherical harmonics , y_^v & = & y _ + y_^a & = & y _ , where the superscripts @xmath97 and @xmath98 represent the `` vector - like '' and the `` axial - vector - like '' components , respectively . in terms of these a vector field @xmath99 can be expanded as , v ( ) = _",
    "= 0^__m = -^ v_y_^v ( ) + a_y_^a ( ) .",
    "therefore , given the ( @xmath100 ) components one can go through the analogs of the above steps for the scalar field synthesis .",
    "in fact , to accomplish step * l1 * of the lensing algorithm , we go from the convergence field @xmath40 to the deflection field , = - & = & -_=0^__m = -^ _ y _ + & = & - _ = 0^__m = -^k_y _ + & = & - _ = 0^__m = -^ k_y_^v . therefore , we go from the @xmath40 field on the polar cap to the spherical harmonic components @xmath101 using the analysis algorithm for scalar fields ; then we divide the result by @xmath102 .",
    "this defines the vector field harmonic components as @xmath103 from which we synthesize the deflection field at the required points .",
    "the accuracy of the interpolation can be controlled by two parameters : the rate at which the finer grid oversamples the field i.e. the ratio @xmath104 , and the order of the polynomial @xmath40 used for the interpolation .",
    "increasing either of these increases the accuracy . in this paper",
    "we have used @xmath105 and @xmath106 , which yields a fractional interpolation accuracy per fourier mode of @xmath107 .",
    "an @xmath5-body dark matter simulation was performed to generate the large scale structure ; this same simulation has been discussed in @xcite and @xcite , so we refer the reader to these papers for more details .",
    "briefly , a spatially flat @xmath108cdm cosmology was used , with a total matter density parameter @xmath109 and vacuum energy density @xmath110 .",
    "the scalar spectral index of the primordial power spectrum was set to @xmath111 and the linear amplitude normalized to @xmath112 . the present day value of the hubble parameter @xmath113 .",
    "a periodic box of size @xmath114 was used with @xmath115 particles ; therefore the particle mass was @xmath116 .",
    "the cubic spline softening length was set to 16.28 @xmath117 .",
    "we create the lensing planes on - the - fly from the @xmath5-body simulation . at each large time step ( set by a courant condition such that no particle moves more than @xmath118kpc in this time ) the positions and velocities of the particles in a thin shell are saved .",
    "the mean radius of the shell is the comoving distance to the redshift at that time , and the width ( a few @xmath117 ) corresponds to the time step .",
    "each shell is centered on the origin of the simulation and covers one octant of the sky ( @xmath119 ) .",
    "note that for shells with radii greater than the simulation box size , periodic copies of the box are used .",
    "thus a given structure will appear more than once in the full light cone , albeit at different times and viewed from different angles .",
    "we then euler rotate the coordinate axes so that the new @xmath26-axis passes through the centroid of the octant .",
    "this is done to make the centroid correspond to the north pole on the sphere .",
    "we use the routine vec2pix to find the pixel that contains the particle s position on the sky .",
    "we then place the mass of the particle into that pixel by assigning to it the surface mass density @xmath120 , where is the area of a pixel in steradians ( cf .",
    "equation [ eqn : pixarea ] ) .",
    "thus , if @xmath121 particles fall inside the beam defined by a pixel , then the pixel ends up having a surface mass density of @xmath122 . to simplify the geometry ,",
    "we save only those particles which fall inside a polar cap like region defined by the disc of maximum radius that can be cut out from the octant ( see fig .",
    "[ fig : polar cap ] ) .",
    "illustration of the polar cap geometry .",
    "the figure shows a 3-d rendering of the sphere using the cmbviewsoftware , looking down towards the north pole .",
    "the lightly shaded triangular region correspond to the positions of the particles in the octant from the @xmath5-body simulation box at a typical time step .",
    "the darker dots define what we call the polar cap in the text .",
    "the surface mass density of the pixels inside this polar cap region are saved in shells out to @xmath26=4 . ]    by the end of the run , @xmath123 such planes were produced from the simulation , spanning @xmath124 to @xmath125 . as these are far too many planes for the purpose of lensing , we reduce them into @xmath126 planes by dividing up the original planes into roughly equal comoving distance bins and adding up the surface mass density pixel by pixel for all planes that fall inside a bin to yield a single plane per bin .",
    "hereafter , we shall refer to the original planes from the tpm run as the tpm - planes and the small number of planes constructed by projecting them as the lensing - planes .",
    "the angular radius of the polar cap is given by @xmath127 , and the solid angle subtended by it is @xmath128 . due to pixelation",
    ", the true total area @xmath129 of the pixels that make up the polar cap is not exactly equal to @xmath130 , but rather = .",
    "we will denote the surface mass density in pixel @xmath131 as @xmath132 which has units of mass per steradian .    in",
    ", the resolution is controlled by the parameter nside , which determines the number , @xmath133 of equal area pixels into which the entire sphere is pixelated , through the relation @xmath134 , so that the area of each pixel becomes , [ eqn : pixarea ] = .",
    "the angular resolution is often expressed through the number @xmath135 .",
    "it is also useful to define the fraction area of the sphere covered by the polar cap as , = .    for results presented in this paper the resolution parameter nside",
    "was set to , which corresponds to an angular resolution of .      to construct the quantities required for lensing , we first convert the surface mass density maps into surface over - density maps @xmath136 as defined in equation @xmath18[def : sigma_theta]@xmath19 .",
    "it is straightforward to obtain the @xmath40-maps defined in equation @xmath18[def : kth]@xmath19 from the above map .",
    "finally , equation @xmath18[eq : kappa]@xmath19 is used to obtain the effective convergence map on the polar cap .",
    "it is evident that the convergence map constructed out of the simulated lensing planes in this way will only contain the contribution from large scale structure up to the redshift of the farthest lensing plane ( @xmath137 ) . however , to accurately lens the cmb we need to add in the contribution from higher redshifts up to the last scattering surface .",
    "we do this by generating a gaussian random field from a theoretical power spectrum of the convergence between @xmath137 and @xmath138 , computed from the matter power spectrum obtained using camb , and adding it onto the convergence map from the tpm simulation .",
    "we used the ` synfast ` facility in to generate the unlensed cmb map .",
    "this takes as an input a theoretical unlensed power spectrum and synthesizes a gaussian - random realization of the unlensed cmb field . for computing the theoretical power spectrum we have used the publicly available boltzmann transfer code camb , with the same set of cosmological parameters as used for the large scale structure simulation .",
    "at several stages we compute the power spectra of the maps to compare with theory .",
    "for example , to verify that we have created the convergence map correctly , the angular power spectrum of the @xmath48 map is computed and compared to the theory . also , we do the same for the lensed map on the polar cap .",
    "we use the map2alm facility of to perform a spherical harmonic decomposition of a map @xmath69 on the polar cap .",
    "the resulting spherical harmonic components , i.e. @xmath139 s , are then combined to obtain the pseudo - power spectrum , [ cl - tilde - pix ] ^=_m = -^ ^2 .",
    "there are two effects that need to be taken into account before comparing the above result with theory , namely the finite pixel size , signified by the superscript , @xmath140 and the incomplete sky coverage , represented by the tilde .    to simplify the following discussion of pixelation effects , for the moment we shall ignore the effect of the incomplete sky coverage .",
    "also , we shall use the shorthand notation @xmath141 to denote the sum @xmath142 . due to the finite pixel size ,",
    "a field realized on the healpix sphere is a smoothed version of the true underlying field , i.e. the value of the field in pixel @xmath16 is given by t^(i ) = d^2w^(i ) ( ) t ( ) , where @xmath143 is the window function of the @xmath16-th pixel as is given by w^(i ) ( ) = expanding the true field @xmath144 in terms of spherical harmonics as t ( ) = _ t _ y _ ( ) , we have [ pixelized_field_lms ] t^(i ) = _ w^(i ) _ t _ , where [ wlm ] w^(i)_= d^2w^(i ) ( ) y _ ( ) is the spherical harmonic transform of the pixel window function . in the scheme , due to the azimuthal variation of",
    "the pixel shapes over the sky , especially in the polar cap area , a complete analysis would require the computation of these coefficients for each and every pixel .",
    "however , even for a moderate nside , this calculation becomes computationally unfeasible .",
    "therefore , it is customary to ignore the azimuthal variation and rewrite equation @xmath18[wlm]@xmath19 as [ wlm_azimuth ] w_^(i ) = w_^(i ) y_(_i ) , where one defines an azimuthally averaged window function w_^(i ) = ^1/2 . from equations ( [ wlm_azimuth ] ) and ( [ pixelized_field_lms ] )",
    "it immediately follows that the estimate of the power spectrum of the pixelated field is given by ^ = w_^2 = w_^2 where one defines the pixel averaged window function , w_= ( 1n _ _ i=0^n_-1 ( w_^(i))^2)^1/2 .",
    "this function is available for @xmath145nside in the distribution .",
    "we take out the effect of the pixel window by dividing the computed power spectrum by the square of the above function . coming back to the case at hand , where we have both pixel and incomplete sky effects , we recover the power spectrum @xmath146 after correcting for the pixel window function in this manner .",
    "the second and more important effect that one needs to take into account results from the fact that our field is defined only inside the polar cap .",
    "this is equivalent to multiplying a full sky map with a mask which has value unity inside the polar cap and zero outside .",
    "as is well known , such a mask leads to a coupling between various multipoles , leading to a power spectrum which is biased away from the true value .",
    "as this effect tends to move power across multipoles , the problem is more acute for highly colored power spectra like the cmb .",
    "let us denote the effective all - sky mask with @xmath147 , where [ eq : polcapwindow ] w ( ) = the spherical harmonic components of the masked field is therefore given by t_&= & d^2 t ( ) w ( ) y^ * _ ( ) + & = & _ m t_d^2y_ m ( ) w ( ) y^ * _ ( ) and the measured power spectrum by ( see for example * ? ? ?",
    "* ) [ pseudocl ] & = & 1(2_1 + 1)_m_1 = -_1^_1 + & = & _ m _",
    "@xmath148 is the true power spectrum and @xmath149 is the mode coupling matrix given by [ ml1l2 ] m _ = _ ( 2 + 1 ) w _ (    ccc 0 & 0 & 0 + & &    ) ^2 , with the power spectrum of the mask defined as _",
    "= 12 + 1 _ m ^2 , @xmath150 being the spherical harmonic components of the mask @xmath151 .    for a polar cap with angular radius @xmath152 ,",
    "this function is analytically known to be @xcite [ w_l_cap ] w_^ = ^2 .",
    "where @xmath153 is a legendre polynomial of order @xmath154 and @xmath155     effect of apodization of the window function .",
    "the continuous line is the unlensed cmb power spectrum and the dashed line is the lensed one .",
    "both have been scaled by @xmath156 , the effective fractional sky coverage ( see text ) .",
    "the gray filled and open circles labeled `` tophat '' , represent , respectively , the theoretical unlensed and lensed power spectra convolved with a window function that is unity inside the polar cap and zero outside .",
    "the black filled and open circles represent the same quantities , but in the case of a window which is apodized at the edge of the polar cap , as discussed in the text .",
    "aliasing of power to higher multipoles due to mode coupling is significantly reduced in the latter case .",
    "we use the apodized window to mask the polar cap maps for computing various power spectra , and use the corresponding theory power spectrum convolved with the same window for comparing our results with theory .",
    "( _ inset : _ the mode coupling matrix @xmath157 as a function of @xmath158 , for @xmath159 , showing the reduction in the power in off - diagonal elements as a result of apodization . ) ]    the window function in equation @xmath18[eq : polcapwindow]@xmath19 corresponding to the polar cap is a `` tophat '' in the sense that it abruptly falls to zero at the edge .",
    "the power spectrum ( equation @xmath18[w_l_cap]@xmath19 ) of this window has an oscillatory behavior showing a lot of power over a large range of multipoles , an effect sometimes called _",
    "ringing_. ringing causes the mode coupling matrix , @xmath160 to develop large off - diagonal terms , as illustrated in fig .",
    "[ modecoupling ] , and consequently the value of the measured power spectrum at any multipole ( equation @xmath18[pseudocl]@xmath19 ) has non - trivial contributions from many neighboring multipoles .",
    "this causes the measured power spectrum to be biased , and its effect is particularly evident for power spectra with a sharp fall - off such as the cmb . as is evident from fig .",
    "[ modecoupling ] , the effect of mode coupling due to the polar cap becomes a serious problem for the lensed and unlensed power spectra starting at moderately low multipoles ( @xmath161 ) .",
    "although in principle one could compare the measured power spectrum with a theoretical power spectrum which has been convolved with the same mode coupling matrix , the effect is so strong in this case that the lensed and unlensed spectra almost overlap each other .",
    "this problem can be mitigated in principle by inverting a binned version of the mode coupling matrix and thereby decorrelating the power spectra .",
    "however an easier and less computationally expensive solution can be achieved in the following manner .",
    "the off diagonal terms of the mode coupling matrix can be reduced significantly by apodizing the polar cap window function .",
    "parenthetically , we note that there exists a general method of generating tapers on a cut - sky map , so as to minimize the effect of mode coupling .",
    "this is referred to as the multi - taper method ( s.  das , a.  hajian and d.  n.  spergel , 2007 , in preparation ; * ? ? ? * ) . however , for our purpose , it suffices to define a simpler apodizing window as [ polcapwindow ] w ( ) = the power spectrum of this window can be easily computed using , and thus the mode coupling matrix can be readily generated using equation @xmath18[ml1l2]@xmath19 .",
    "we found that an apodization window with @xmath162 degree , corresponding to @xmath163 pixels , works extremely well without eating into too much of the map .",
    "a section of the mode coupling matrix and the corresponding convolved power spectrum are displayed in fig .",
    "[ modecoupling ] .",
    "this figure shows that the power spectrum convolved with the apodized window function has negligible mode coupling .",
    "parenthetically , it is interesting to note that simply scaling the theory power spectrum by the fraction of the sky covered , @xmath164 , seems to do a good job in mimicking the effect of the partial sky coverage , at least for the lower multipoles .",
    "in fact , this approximation is an exact result for a white power spectrum . however ,",
    "when the window is apodized , the effective area of coverage , @xmath165 , goes down a little ( by @xmath166 for our apodization ) .",
    "we use @xmath156 scaled theory power spectra only in some plots in this paper . for the analysis",
    ", we perform the full mode coupling calculation . therefore , when comparing the power spectrum of some quantity defined on the polar cap with theoretical predictions , we first multiply the map by the apodized window and compare the resulting power spectrum with the theoretical power spectrum mode - coupled through the same weighting window .",
    "we illustrate the algorithm with an effective lensing simulation at the resolution of @xmath167 . since some rays end up outside the polar cap after lensing , we have actually used an unlensed cmb realization ( using the synfast facility of ) on an area larger than our fiducial polar cap to accommodate those rays .",
    "as the gradient of the lensing potential is ill defined at the edge of the polar cap , we ignore a ring of pixels near the edge of the lensed map for all subsequent analyses .",
    "it is particularly instructive to look at the difference of the lensed and the unlensed maps , as shown in fig .",
    "[ difference_map ] , as it shows the large scale correlations imprinted on the cmb due to the large scale modes in the deflection field .",
    "we compute the angular power spectrum of the lensed and unlensed cmb maps using an apodized weighting scheme as discussed in  [ angular_power_spectra ] .",
    "the resulting power spectra are displayed in fig .",
    "[ lensedcmbcls ] for the entire range of multipoles analyzed , and are compared with the mode - coupled theoretical power spectra .",
    "the theoretical lensed cmb power spectrum used for the calculation was generated with the camb code , using the all - sky correlation function technique @xcite and including nonlinear corrections to the matter power spectrum . in fig .",
    "[ lensedcmbclszoom ] , we show a zoomed - in version of the lensed power spectrum , in the multipole range @xmath168 . from visual inspection of these plots",
    "it is evident that the simulation does a good job in reproducing the theoretically expected lensed power spectrum , at least in the range of multipoles over which the computation of the theoretical power spectrum is robust .",
    "we defer a detailed comparison of the simulation to the theory to  [ tests_for_lensed_cmb ] .     the polar cap map obtained after subtracting the unlensed cmb map from the lensed cmb map . to enhance the contrast , we have remapped the color scale to the range @xmath169 , @xmath170 being the standard deviation of the map . ]",
    "the lensed and unlensed cmb angular power spectra obtained from the simulation compared with the theoretical models .",
    "the red and orange dots represent , respectively , the lensed and unlensed angular power spectra obtained from the polar cap using the methods described in  [ angular_power_spectra ] .",
    "the solid black curve signifies the theoretical unlensed power spectrum taking into account the mode coupling due to the apodized polar cap window function .",
    "the blue solid curve represents the same for the lensed power spectrum . ]",
    "lensed cmb angular power spectrum in the multipole range @xmath168 obtained from the simulation compared with the theoretical model .",
    "the red dots represent the lensed angular power spectrum obtained from the polar cap using the methods described in  [ angular_power_spectra ] .",
    "the solid black curve signifies the theoretical lensed cmb power spectrum taking into account the mode coupling due to the apodized polar cap window function .",
    "the dotted black curve represents the same for the theoretical unlensed power spectrum and is shown here for contrast to the lensed case . ]",
    "in this section we perform some sanity checks to ensure that the projection from the simulation box onto the polar cap has been properly performed .",
    "we first test that the total mass in each slice is equal to the theoretical mass expected from the mean cosmology , the later being given by ^=|^2 where @xmath171 is the comoving thickness of the slice at a comoving distance @xmath172 .",
    "we compare this quantity with = _",
    "i=1^_iwhich is the total mass on the plane from the simulation .",
    "the percentage difference between the two is depicted in fig .",
    "[ fig : binnedmasscompare ] for the lensing - planes .",
    "notice that the agreement is good to within 0.5% for the high redshift planes , in which the solid angle @xmath130 corresponds to a large comoving area .",
    "for low redshifts there are large variations due to the fact that matter is highly clustered and @xmath130 corresponds to a small comoving area .",
    "these fluctuations at low redshift represent the chance inclusion or exclusion of large dark matter halos within the light cone .",
    "the mass in the lensing - slices compared with that expected from theory . ]    next , we make sure that the probability density function ( pdf ) of the surface mass density is well behaved for each plane , and is well modeled by analytic pdfs such as the lognormal @xcite or the model proposed by @xcite . in fig .  [",
    "fig : pdfcompare ] we show these two models over - plotted on the pdfs drawn from the forty - five lensing - planes .",
    "the model of @xcite is a better fit to the simulation than the lognormal , especially at high surface mass density .",
    "note in that paper the authors used the first year wmap parameters , whereas the present simulation is run with the wmap 3-year parameters , including a significantly different @xmath173 .",
    "the fact that the model still represents the simulation well suggests that it is quite general .     the probability density function ( pdf ) of the surface mass density in the lensing - planes ( circles ) compared with the lognormal ( dashed line ) and the @xcite model ( solid line ) . ]      as described in ",
    "[ sigma_to_kappa ] , the effective convergence plane was produced by a two step process .",
    "first , we computed the effective convergence plane by weighting the surface mass density planes from the simulation with appropriate geometrical factors .",
    "let us call it the map @xmath174 .",
    "this map , therefore , includes contribution from the large scale structure only out to the redshift of the farthest tpm plane , @xmath137 .",
    "next we added in the contribution from @xmath175 , by generating a gaussian random realization of the effective convergence from a theoretical power spectrum ( the map @xmath176 ) .",
    "therefore the final convergence map is simply @xmath177 .",
    "it is interesting to compare the power spectrum of the map @xmath174 with that expected from theoretical considerations . since cmb lensing is most sensitive to large scale modes , we should make sure that these modes were realized correctly in our simulated convergence plane .",
    "incidentally , these scales are also linear to mildly nonlinear .",
    "therefore , we should expect the power spectrum of the convergence map to be well replicated by the theoretical prediction at least in the quasi - linear range of multipoles ( @xmath178 ) where simple non - linear prescriptions suffice .",
    "power spectrum of the effective convergence map @xmath174 produced from the simulated lensing planes alone .",
    "the red line shows the power spectrum computed from the convergence map and the black solid line represents the theoretical power spectrum with non - linear corrections .",
    "the power spectrum is corrected for the shot noise contribution ( see text ) which is displayed as the dotted line .",
    "the black dashed line corresponds to the linear theory power spectrum .",
    "all theory power spectra are mode - coupled with the apodizing window . ]    in order to compute the theoretical power spectra for the maps @xmath174 and @xmath179 , we used the limber approximation to project the matter power spectrum @xmath180 computed from camb .",
    "the limber approximation simplifies the full curved - sky calculation , and is valid for @xmath181 .",
    "since for lower values of the multipole we have few realizations of the convergence modes , the power spectrum computed from the simulated map is noisy in this regime , rendering it practically useless for comparison with theory .",
    "therefore , an accurate computation of the theoretical convergence power spectrum for these lowest multipoles is unnecessary , and the limber calculation suffices . under the same approximation , the shot noise contribution to the convergence field can be computed as ^ = _ j _ j ( 32 ( 1+z_j ) ) ^2 , where @xmath182 , @xmath183 being the total number of particles in the @xmath21-th shell .",
    "power spectrum of the effective convergence map @xmath184 after adding in high redshift contribution .",
    "the red line shows the power spectrum computed from the convergence map and the black solid line represents the theoretical power spectrum with non - linear corrections .",
    "the power spectrum is corrected for the shot noise contribution ( see text ) which is displayed as the dotted line .",
    "the black dashed line corresponds to the linear theory power spectrum .",
    "all theory power spectra are mode - coupled with the apodizing window . ]",
    "we compute both a linear and a non - linear version of the convergence power spectrum , where the latter includes non - linear corrections to the matter power spectrum from a halo model based fitting formula @xcite .",
    "we plot the power spectrum computed from the simulated convergence map @xmath174 , and the corresponding theoretical power spectra , in fig .",
    "[ fig : eff_kappa_to_tpmz ] .",
    "as is evident from the figure , the simulated power spectrum is in accord with the linear theory power spectrum for @xmath185 , beyond which the effect non - linearities creep in .",
    "however , it is impressive that the non - linear corrections to the power spectrum are in good agreement with the simulation up to relatively high multipoles .",
    "the same quantities are plotted for the convergence map out to the redshift of the cmb in fig .",
    "[ fig : eff_kappa_to_cmb ] .",
    "we find in both cases that beyond multipoles of @xmath186 the simulation contains more non - linear power than predicted by the theory .",
    "since cmb lensing is essentially a remapping of points , the one - point statistics should remain unaffected by the lensing .",
    "we check for this by drawing up the one - point pdf s of the unlensed and lensed maps , and find them to be consistent to within @xmath187 .",
    "next , we compare the power spectrum of the simulated lensed map ( cf",
    ". figures  [ lensedcmbcls ] & [ lensedcmbclszoom ] ) with the theoretical predictions as computed with the camb code . for a quantitative comparison",
    ", we consider a range of multipoles @xmath188 in the acoustic regime .",
    "we do not consider the lower multipoles as they exhibit negligible lensing effect .",
    "we found that for a fixed input cosmology , the tail ( @xmath189 ) of the lensed cmb power spectrum predicted by camb depends somewhat sensitively on input parameters , specifically the combination @xmath190 , which controls the maximum value of the wavenumber for which the matter power spectrum in computed .",
    "however , the lensed power spectrum from camb is robust towards changes in the auxiliary input parameters for the range of multipoles , @xmath191 . also , the lensed cmb multipoles beyond this range couple to relatively small scale modes of the deflection field where our simulation has more power than expected from non - linear theory .",
    "in fact , beyond @xmath192 the simulated power spectrum is found to deviate systematically from the theoretical spectrum .    as the simulated power spectrum , @xmath193 ,",
    "was computed using an apodized window as described in ",
    "[ angular_power_spectra ] , the appropriate theoretical curve to compare this result with is the power spectrum from camb after it has been convolved with the coupling matrix defined by the same weighting scheme ( cf .",
    "equation [ pseudocl ] ) .",
    "we denote the latter quantity by @xmath194 . in order to facilitate the comparison we bin the raw spectrum in @xmath154 . in the multipole range",
    "considered @xmath195 , the quantity @xmath196 is flat ( see fig .",
    "[ lensedcmbclszoom ] ) and therefore a better candidate for binning .",
    "we denote the difference between the simulated and the theoretical version of this quantity by _",
    "l _ l^ - _ l^ . for each of the @xmath5 bins indexed by @xmath197 , we compute the mean , @xmath198 , and the sample variance , @xmath199 , of the observations falling inside that bin . in order to account for that fact that cosmic variance errors will be higher in our case due to incomplete sky coverage , we define an effective variance as @xmath200 .",
    "difference between the simulated and the theoretical binned power spectrum for lensed cmb . ]",
    "we quantify the goodness of fit between the simulation and the model by defining a @xmath201 statistic as ^2 = _ b=1^n .",
    "we perform the @xmath201 analysis by uniformly binning the power spectra in the range @xmath202 into @xmath203 bins with a bin width of @xmath204.the binned values along with the error bars are displayed in fig .",
    "[ fig : error_analysis ] .",
    "we find a value @xmath205 , suggesting an appreciable agreement with the theory .",
    "in this paper , we have put forward an algorithm for end - to - end simulation of the gravitational lensing of the cosmic microwave background , starting with an @xmath5-body simulation and fully taking into account the curvature of the sky .",
    "the method is applicable to maps of any geometry on the surface of the sphere , including the whole sky .",
    "our algorithm includes prescriptions for generating spherical convergence planes from an n - body light cone and subsequently ray - tracing through the planes to simulate lensing .",
    "the central feature of the algorithm is the use of a highly accurate interpolation method that enables sampling of both the deflection fields on intermediate lensing planes and the unlensed cmb map on an irregular grid .",
    "we have provided a detailed description of both a multiple plane ray tracing and an effective lensing version of the algorithm .",
    "the latter setting has been used to illustrate the algorithm , by generating an @xmath2061@xmath207 resolution lensed cmb map .",
    "we have compared the power spectra of the effective convergence map and the lensed cmb map with theoretical predictions , and have obtained good agreement .",
    "after this paper was completed , @xcite described a similar method of producing convergence maps in spherical geometry , and @xcite also described their techniques for simulating cmb lensing maps .",
    "the latter used broadly similar techniques to those described here , although they used a different method to obtain the deflection field .",
    "applications of the algorithm can be manifold .",
    "the associated large scale structure planes can be populated with tracers of mass and foreground sources , in order to simulate cross - correlation studies and to investigate the effects of contamination .",
    "this lensing portion of the algorithm can be applied to generate lensed maps in large scale structure simulations that produce spherical shells @xcite .",
    "the multiple plane algorithm can be particularly useful , after trivial modifications , in simulating weak lensing of galaxies or the 21-cm background on a large sky .",
    "the lensed cmb maps can be used as inputs to telescope simulators for projects such as act and planck , and will help in the analysis and interpretation of data .",
    "we intend to release all - sky high resolution lensed cmb maps made using this algorithm in near future .",
    "sd would sincerely like to thank his advisor , david spergel for suggesting the key ideas of the project and for his continuous guidance and encouragement throughout its development .",
    "sd is specially grateful to chris hirata for generously providing the nisht code and for numerous useful discussions .",
    "we thank joanna dunkley for careful reading of the manuscript and thoughtful suggestions .",
    "we would also like to thank the referee for his thoughtful suggestions .",
    "sd acknowledges the support from the nasa theory program nng04gk55 g and the nsf grant ast-0707731 .",
    "this research was facilitated by allocations of advanced computing resources from the pittsburgh supercomputing center and the national center for supercomputing applications .",
    "in addition , computational facilities at princeton supported by nsf grant ast-0216105 were used , as well as high performance computational facilities supported by princeton university under the auspices of the princeton institute for computational science and engineering ( picscie ) and the office of information technology ( oit ) .",
    "some of the results in this paper have been derived using the healpix @xcite package .",
    "gorski , k.  m. , hivon , e. , banday , a.  j. , wandelt , b.  d. , hansen , f.  k. , reinecke , m. , & bartelmann , m. 2005 , the astrophysical journal , 622 , 759 hirata , c.  m. , ho , s. , padmanabhan , n. , seljak , u. , & bahcall , n.  2008 , arxiv e - prints , 801 , arxiv:0801.0644 , c.  m. , padmanabhan , n. , seljak , u. , schlegel , d. , & brinkmann , j. 2004 , , 70 , 103501                    , e. , kogut , a. , nolta , m.  r. , bennett , c.  l. , halpern , m. , hinshaw , g. , jarosik , n. , limon , m. , meyer , s.  s. , page , l. , spergel , d.  n. , tucker , g.  s. , verde , l. , wollack , e. , & wright , e.  l. 2003 , , 148 , 119                            , d.  n. , bean , r. , dor , o. , nolta , m.  r. , bennett , c.  l. , dunkley , j. , hinshaw , g. , jarosik , n. , komatsu , e. , page , l. , peiris , h.  v. , verde , l. , halpern , m. , hill , r.  s. , kogut , a. , limon , m. , meyer , s.  s. , odegard , n. , tucker , g.  s. , weiland , j.  l. , wollack , e. , & wright , e.  l. 2007 , , 170 , 377    , d.  n. , verde , l. , peiris , h.  v. , komatsu , e. , nolta , m.  r. , bennett , c.  l. , halpern , m. , hinshaw , g. , jarosik , n. , kogut , a. , limon , m. , meyer , s.  s. , page , l. , tucker , g.  s. , weiland , j.  l. , wollack , e. , & wright , e.  l. 2003 , , 148 , 175"
  ],
  "abstract_text": [
    "<S> large scale structure deflects cosmic microwave background ( cmb ) photons . </S>",
    "<S> since large angular scales in the large scale structure contribute significantly to the gravitational lensing effect , a realistic simulation of cmb lensing requires a sufficiently large sky area . </S>",
    "<S> we describe simulations that include these effects , and present both effective and multiple plane ray - tracing versions of the algorithm , which employs spherical harmonic space and does not use the flat sky approximation . </S>",
    "<S> we simulate lensed cmb maps with an angular resolution of @xmath0 . </S>",
    "<S> the angular power spectrum of the simulated sky agrees well with analytical predictions . </S>",
    "<S> maps generated in this manner are a useful tool for the analysis and interpretation of upcoming cmb experiments such as planck and act . </S>"
  ]
}