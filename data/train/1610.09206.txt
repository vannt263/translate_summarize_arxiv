{
  "article_text": [
    "in this section , we list the differences of the dual - v scheme  @xcite ( fig .",
    "[ fig_setup](b ) of the main article ) from the @xmath3-type scheme ( fig .",
    "[ fig_setup](a ) of the main article ) , which was the focus of the discussion in the main article .    * there are two excited states @xmath120 instead of only one .",
    "there are also two excited states @xmath121 coupled to the state @xmath39 , instead of only one .",
    "* the two classical drives have different polarizations , @xmath122 and @xmath123 , and are therefore two independent running waves @xmath100 instead of forming a standing wave .",
    "the quantum probe fields ( single photon ) and can also have two different polarizations .",
    "the operators for right - moving and left - moving fields with @xmath122 polarization is @xmath124 , where `` @xmath125 '' in the subscript is for the right - moving field and `` @xmath126 '' is for the left - moving field .",
    "similarly , @xmath127 are the operators for the @xmath123 fields .",
    "the @xmath122 fields only couple to the transitions @xmath128 and @xmath129 , while the @xmath123 fields only couple to the transitions @xmath130 and @xmath131 . *",
    "the decay rate @xmath21 is from each of the states @xmath120 ( assumed equal ) . *",
    "two - mode transfer matrices are required to describe the scattering ( more details in sec .",
    "[ sec_scattering_coefficients ] below ) .",
    "* under eit storage , we assume that only one of the classical drives is switched on , so that one of the excited states is decoupled from the dynamics . hence , in this case , the dual - v scheme is completely equivalent to the @xmath3type scheme . after storing a photon into state @xmath38 and transferring it to state @xmath39 by a @xmath32-pulse , for the dual - v scheme , the atom behaves as an effective v - type atom with two excited states @xmath121 , instead of a two - level atom .",
    "* it is in principle possible to store the photon such that it is incident only from one side instead of symmetrically from both sides , as required for the @xmath3-type scheme . *",
    "if one - sided storage is desired , a different setup can be used , where the photons are incident on the ensemble directly ( without placing the ensemble inside a sagnac interferometer ) . to convert between conditional reflection or transmission and conditional phase shift ,",
    "a mirror behind the ensemble can be used .",
    "this setup may require less stabilization of path lengths than a sagnac interferometer .",
    "the unconditional fidelity in this setup is found to be approximately the same , but the conditional fidelity has a worse scaling .",
    "the latter is because in eqs . and of the main article",
    ", the terms linear in @xmath132 do not cancel as in the symmetric case ( also see the fidelity derivations in sec .  [ sec_analytical_fidelity ] below ) .",
    "here , we state the expressions required for evaluating the choi - jamiolkowski fidelity and success probability accounting for non - zero bandwidth of the scattered photon @xmath28 .",
    "we will also discuss , how the unconditional and conditional fidelities are related to figures of merit for quantum repeaters .",
    "a more detailed discussion can be found in refs .",
    "@xcite .",
    "the ideal evolution of the controlled - phase gate is defined by its action on the computation basis states @xmath133 to calculate the choi - jamiolkowski fidelity , we have to define the input basis states ( @xmath134 for @xmath135 ) and their ideal evolution into the output states ( @xmath136 ) .",
    "since photon  @xmath25 is stored and retrieved , while photon  @xmath28 is scattered , it is most natural to describe the former as a temporal wave packet and the latter through a frequency distribution over @xmath137 , where @xmath138 ( see figs . [ fig_setup](a ) and [ fig_setup](b ) of the main article ) is the two - photon detuning .",
    "the ideal evolution is defined such that the output frequency distribution of photon  @xmath28 is equal to the input frequency distribution , while the output wave packet of photon  @xmath25 is set to be the one obtained after storage and retrieval in the absence of scattering . in terms of the storage and retrieval kernels ,",
    "@xmath139 and @xmath140 respectively ( discussed in sec .",
    "[ eit_storage_retrieval ] below ) , the output wave packet of photon  @xmath25 is @xmath141 where @xmath67 is the input wave packet . we define @xmath142 to be unnormalized , and the absolute square of its norm @xmath143 is the eit storage and retrieval efficiency , which is , in general , less than unity due to imperfections .",
    "when defining the output basis states ( @xmath136 ) , we ensure that they are normalized by dividing them by @xmath144 . in the numerical calculations , we use the discrete definition   of @xmath142 ( and similar one for @xmath145 below ) instead of the continuum version that was stated in the main article for simplicity .",
    "the choices of @xmath142 and @xmath105 above are natural , but there may exist more optimal choices , which give better fidelities .    for the real physical evolution , we also need to calculate the output wave packet for photon  @xmath25 , when photon  @xmath28 was scattered from the ensemble . in this case , we have @xmath146 defining @xmath145 is necessary , because the reflection coefficient of the ensemble with a stored photon depends on the position of the atom , in which the photon was stored .",
    "the choi - jamiolkowski fidelity is computed by assuming a particular entangled state as the input and applying both the ideal and real evolution to it  @xcite .",
    "the fidelity between the output states is then the choi - jamiolkowski fidelity .",
    "it is given by @xmath147 if we neglect the bandwidth of photon  @xmath28 by setting @xmath105 to be a delta - function , @xmath148 , in the above expression , we obtain eq .   of the main article .",
    "the success probability for having two photons at the output is @xmath149 setting @xmath148 , this reduces to eq .   of the main article .",
    "the conditional choi - jamiolkowski fidelity is @xmath75 .",
    "the abstract choi - jamiolkowski fidelity considered above can be related to more concrete figures of merit , such as entanglement swap fidelity and success probability in the setting of quantum repeaters . in refs .  @xcite it is shown that the success probability of the entanglement swap operation is exactly the same as the success probability @xmath150 that we have defined above .",
    "furthermore , since @xmath78 measures the probability for the photons to be in the right modes with the right phase , whereas @xmath150 measures whether the photons are coming out , it holds that @xmath151 .",
    "the expressions for @xmath78 stated in the main article thus give a lower bound for @xmath150 . for our particular implementation of the controlled - phase gate ,",
    "most of the error in @xmath78 is caused by photon loss , and hence we have @xmath83 . at the same time , @xmath81 is a lower bound and an approximation for the entanglement swap fidelity  @xcite . in fig .",
    "[ fig_cphase_fidelity_f_swap ] , we illustrate the approximate equalities of @xmath78 with @xmath150 and @xmath81 with the entanglement swap fidelity @xmath152 .     for deterministic operation of the controlled - phase gate with the success probability @xmath150 for heralded operation of the gate .",
    "( b ) comparison of the conditional choi - jamiolkowski fidelity @xmath81 with the entanglement swap fidelity @xmath152 for heralded operation of the gate . both for",
    "( a ) and ( b ) , dotted green and dash - dotted black curves are calculated with @xmath76 , while the solid blue and dashed red curves are calculated with @xmath30 chosen such that the entanglement swap fidelity @xmath152 is maximal .",
    "all quantities are plotted as functions of the number of atoms @xmath12 with fixed @xmath13 . for storage and retrieval , we use the continuum theory described in sec .",
    "[ continuum_eit_storage_retrieval ] . ]",
    "to find the scattering coefficients for an ensemble of @xmath3type atoms , the single - mode transfer matrix formalism  @xcite is sufficient . for the dualv scheme ,",
    "two different polarization modes of the electric field are coupled to the atoms , and hence a generalization to a two - mode transfer matrix formalism is required .",
    "the general multi - mode transfer matrix formalism is developed in ref .",
    "@xcite . here",
    ", we briefly summarize it before applying it to calculate the scattering coefficients of atomic ensembles .    in the multi - mode transfer matrix formalism",
    ", electric fields are described by vectors of @xmath153 elements , where @xmath154 is the number of the different modes of the electric field .",
    "the fields propagating to the right and the fields propagating to the left are treated as being distinct , hence there are @xmath154 elements for each propagation direction .",
    "we can write the electric field vectors @xmath155 where @xmath156 is the part of the electric field that propagates to the right ( in the positive direction ) , @xmath157 is the part of the electric field that propagates to the left ( in the negative direction ) .",
    "atoms and free propagation between atoms are described by @xmath158 matrices , which relate the vectors of electric field at one position to vectors of electric field at a different position . in general , the transfer matrix for the whole ensemble is obtained by multiplying the transfer matrices for the atoms and free propagation .",
    "we use this approach for the dual - v atoms , for which we assume placement of the atoms , which is incommensurate with the wavelength of the classical drives ( or even completely random ) . for the @xmath3-type scheme",
    ", the atoms are regularly placed with distance @xmath159 , as shown in fig .",
    "[ fig_lambda_type_kd_pi_half_setup ] .",
    "hence , the ensemble consists of repeated unit cells , and one can instead exponentiate the transfer matrix for a single unit cell to find the transfer matrix for the whole ensemble .",
    "for @xmath3type atoms described by @xmath160 transfer matrices , closed - form expression can be obtained for the transfer matrix for the whole ensemble given in terms of the transfer matrix for the unit cell  @xcite .",
    "if the transfer matrix for the unit cell is @xmath161 then the transfer matrix for an ensemble of @xmath162 such unit cells is @xmath163 where @xmath164 is the identity matrix , @xmath165 and @xmath166 fulfills @xmath167 .",
    "physically , @xmath166 is equal to the bloch vector @xmath44 multiplied by the length occupied by the unit cell . in the case of the @xmath3type scheme with inter - atomic spacing @xmath168 below",
    ", the unit cell has length @xmath169 and hence we have @xmath170 .",
    "once the transfer matrix for the ensemble @xmath171 has been obtained , one needs to extract the scattering coefficients from it .",
    "the transfer matrix for the ensemble @xmath171 fulfills the relation @xmath172 for the dualv atoms , the parts of the electric field vector @xmath173 have two elements . to calculate the reflection coefficient of the ensemble , when the field is incident from the left",
    ", we assume input fields @xmath174 ( i.e. only a right - moving @xmath122 field incident from the left ) . then from eq .",
    "we see that @xmath175 as the transmission coefficient , we take the first ( @xmath122 ) element of @xmath176 , and as the reflection coefficient , we take the second ( @xmath123 ) element of @xmath177 . the reflection and transmission coefficients of the whole ensemble in the single - mode case",
    "simplify to @xmath178 and @xmath179 respectively .",
    "the only thing left to describe in the general case , is how the matrix @xmath180 ( and @xmath171 if it is not simply equal to @xmath181 ) is calculated .",
    "it is a product of the matrices @xmath182 describing scattering of the electric fields by the atoms and the matrices @xmath183 describing the free propagation of the electric fields .",
    "they are given by @xmath184 where @xmath164 means the @xmath185 identity matrix ( a scalar equal to unity in the single - mode case ) , @xmath16 is the wave vector , and @xmath101 is the propagation distance . each matrix @xmath182 is given in terms a @xmath185 matrix @xmath186 , which will be defined for the specific cases of @xmath3type and dualv atoms considered below .        here",
    ", we derive the scattering coefficients @xmath106 and @xmath107 given by eqs . and of the main article . for the @xmath3-type atoms , we use single - mode transfer matrices and hence the parameter @xmath186 in eq .",
    "is a scalar . we will consider a unit cell that consists of two atoms and two lengths of free propagation ( see fig .",
    "[ fig_lambda_type_kd_pi_half_setup ] ) .",
    "one of the atoms is placed on the anti - node of the standing wave of the classical drive , and the other is placed on the node .",
    "the scattering from the former will be described by a parameter  @xcite @xmath187 while the scattering for the latter ( an effective two - level atom ) is described by a parameter @xmath188 the transfer matrix for the unit cell is @xmath189 carrying out the above matrix multiplications results in @xmath190 from eq .  , we then have @xmath191 with @xmath166 given by @xmath192 . from this matrix",
    ", we obtain the reflection and transmission coefficients @xmath193    the minima of @xmath106 and maxima of @xmath107 ( see fig .",
    "[ fig_r_and_t_plot ] of the main article ) occur when @xmath194 in eq .",
    "is approximately equal to zero .",
    "however , exact equality is never satisfied , since @xmath166 is complex ( a consequence of @xmath195 ) . in the regime , where losses are small ( @xmath196\\ll 1 $ ] )",
    ", the approximate resonance condition is @xmath197/2)}}=0.\\end{gathered}\\ ] ]    in the coefficients and we can approximate @xmath198/2 ) -\\frac{i\\operatorname{im}[\\operatorname{tr}(t_\\text{cell})]/2}{\\sqrt{(1-\\operatorname{re}[\\operatorname{tr}(t_\\text{cell})]/2)(1+\\operatorname{re}[\\operatorname{tr}(t_\\text{cell})]/2)}}.\\end{gathered}\\ ] ] from eq .",
    "we have @xmath199/2)=\\pi k\\end{gathered}\\ ] ] for some integer @xmath200 .",
    "since the are interested in the first reflection minimum closest to @xmath201 , we choose @xmath202 . for large @xmath162",
    ", we have @xmath203/2=\\cos(\\pi(n-1)/n)\\approx -1+\\pi^2/(2n^2).\\end{gathered}\\ ] ] hence , eq .   can be approximated as @xmath204/(2\\pi),\\end{gathered}\\ ] ] and we also obtain the approximate expressions : @xmath205/(2\\pi)\\right),\\\\ & \\cos(n\\theta)\\approx(-1)^{n-1},\\\\ & \\sin(\\theta)\\approx \\pi / n.\\end{aligned}\\ ] ]    with these approximations and using the fact that @xmath196=-4\\operatorname{im}[\\beta_2\\beta_3]$ ] , eqs . and become @xmath206}-\\beta_2-\\beta_3},\\\\ \\label{t_t_n_approx1 } & t_0\\approx \\frac{(-1)^{n-1}}{1-\\frac{2in^3\\operatorname{im}[\\beta_2\\beta_3]}{i\\pi^2}(\\beta_2+\\beta_3)}.\\end{aligned}\\ ] ] to determine the dominant terms in eqs . and , we write the approximate expressions for eqs . and in the limit , where @xmath5 is small , and @xmath207 is big ( @xmath208 ) .",
    "we thereby get @xmath209 the second term on the right hand side of eq .",
    "is included for the sole purpose of finding an approximation for @xmath210\\approx \\operatorname{re}[\\beta_2]\\operatorname{im}[\\beta_3]$ ] . an expression for the detuning @xmath5",
    "can be found using eq .  .",
    "expanding its left hand side in @xmath5 around @xmath211 to second order results in @xmath212 under the assumption that @xmath213 , we choose the solution , where @xmath214 : @xmath215 expanding this around the limit of large @xmath162 we find @xmath216 the first term on the right hand side of eq .",
    "could also be derived from the knowledge that the dispersion relation is approximately quadratic for small @xmath5 , i.e. @xmath217 with the mass @xmath218 given in ref .",
    "@xcite , but the other two terms result from higher order corrections to this approximation .",
    "when we calculate the fidelity @xmath78 in sec .",
    "[ sec_analytical_fidelity ] below , we find that it is maximal for a detuning @xmath219 , and the second one is proportional to @xmath220 .",
    "hence , the second one is smaller for large @xmath162 and can be neglected .",
    "we keep the third term , since it depends on @xmath53 and will be important when discussing the bandwidth of the protocol .    using only the first term in eq .   and inserting it into the first term of eq .  , we find @xmath221 upon inserting into the second term of eq .",
    ", we find @xmath222\\approx \\frac{\\gamma_\\text{1d}\\gamma ' } { 4\\delta_\\text{c}^2 \\left(1-(\\pi^2|\\omega_0|^2)/(\\gamma_\\text{1d}^2n^2)\\right)^2 } \\approx \\frac{\\gamma_\\text{1d}\\gamma'}{4\\delta_\\text{c}^2 } + \\frac{|\\omega_0|^2\\pi^2\\gamma'}{2\\delta_\\text{c}^2\\gamma_\\text{1d}n^2}.\\end{gathered}\\ ] ] using the first and the third terms of eq .   and inserting them into eq .  , we find @xmath223 combining eqs . and and neglecting a term of order @xmath224 results in @xmath225\\approx\\operatorname{re}[\\beta_2]\\operatorname{im}[\\beta_3 ] \\approx \\frac{\\pi^2\\gamma'}{8\\delta_\\text{c}n^2 } + \\frac{|\\omega_0|^2\\pi^4\\gamma'}{8\\delta_\\text{c}\\gamma_\\text{1d}^2n^4}.\\end{gathered}\\ ] ] invoking eq .",
    "again and neglecting the @xmath53 dependent terms for a moment , we see that @xmath226 , @xmath227 and @xmath228\\propto n^{1/4}$ ] . hence , @xmath229 ; @xmath230)^{-1}$ ] and we can approximate eqs . and",
    "by    @xmath231 \\approx \\frac{\\gamma_\\text{1d}\\gamma'n}{8\\delta_\\text{c}^2 } + \\frac{|\\omega_0|^2\\pi^2\\gamma'}{4\\delta_\\text{c}^2\\gamma_\\text{1d}n},\\\\ \\label{t_0_sm } & t_0\\approx(-1)^{n-1}\\del{1+i\\frac{2n^3}{\\pi^2}\\beta_2\\operatorname{im}[\\beta_2\\beta_3 ] } \\approx ( -1)^{n-1}\\del{1-\\frac{\\gamma_\\text{1d}\\gamma'n}{8\\delta_\\text{c}^2 } -\\frac{|\\omega_0|^2\\pi^2\\gamma'}{4\\delta_\\text{c}^2\\gamma_\\text{1d}n}}.\\end{aligned}\\ ] ]    since the number of atoms is @xmath232 , the above expressions correspond to eqs . and of the main article , except for the removal of the overall phase factor @xmath233 for the transmission coefficient @xmath107 ( discussed in sec .",
    "[ sec_sagnac_interferometer_and_phases ] below ) . in fig .",
    "[ fig_r_and_t_plot_omega](a ) we plot @xmath1 as a function of @xmath53 and show that the analytical expression in eq .",
    "matches the full expression in eq .",
    "evaluated at the resonance frequency .    to account for the non - zero bandwidth of the scattered photon",
    ", we also need the width of the resonance . after expanding the reflection coefficient @xmath106 around @xmath109 ,",
    "we get @xmath234 where @xmath235 is given by eq .",
    "and @xmath236 is the width .",
    "since we approximately have that @xmath237 , the width of the transmission resonance is @xmath238 . in fig .",
    "[ fig_r_and_t_plot_omega](b ) we compare eq .   with the numerically computed width .     and",
    "transmittance without a stored photon @xmath1 of an ensemble of @xmath3type atoms plotted as functions of the rabi frequency of the classical drive @xmath53 and evaluated at the transmission resonance closest to @xmath201 ( see fig .",
    "[ fig_r_and_t_plot ] of the main article ) , i.e. at @xmath239 . both @xmath107 and @xmath51",
    "are calculated either directly from the transfer matrix with no approximations ( `` full '' ) , which for @xmath107 is given by eq .  , or from the approximate expressions in eqs .",
    "and respectively ( `` approximate '' ) .",
    "( b ) the width of the transmission resonance calculated either from the full expression as @xmath240{\\text{re}\\sbr{\\sqrt{4/\\partial_\\delta^2 t_0(\\delta)}}}_{\\delta=\\delta_\\text{res}}$ ] or using the approximate expression ( dash - dotted black ) .",
    "the parameters for both ( a ) and ( b ) are : number of atoms @xmath7 , @xmath13 , and @xmath9 .",
    "( the same as in fig .",
    "[ fig_r_and_t_plot ] of the main article except for @xmath53 , which is varied here . ) ]      here , we derive the scattering coefficients @xmath51 and @xmath50 given by eqs . and of the main article .",
    "the starting point is the assumption that the photon has been stored in a single atom that is placed at the anti - node of the standing wave of the classical drive ( storing in an atom that is on the node will have a negligible change in the scattering properties , unless @xmath20 is close to unity ) .",
    "the storage of a photon in the atom transfers it from state @xmath37 to state @xmath39 , such that it behaves like a resonant two - level atom ( given by the @xmath241 transition ) that is described by the transfer matrix @xmath242 with @xmath243 hence , the transfer matrix for the unit cell containing the stored photon will be given by @xmath244 instead of eq .  .",
    "if we assume that the photon is stored in the unit cell with index @xmath245 , the transfer matrix for the whole ensemble @xmath246 is given by @xmath247 from eq .",
    "we can find the scattering coefficients using @xmath248 where @xmath249 are the elements of the matrix @xmath246 similar to the definition   of the elements of the matrix @xmath171 .",
    "for the numerical calculations , eqs . and are used directly , and we set @xmath250 in eq .  .    for the analytical calculations , we can find approximate expressions for the scattering coefficients , but the procedure is rather involved .",
    "we shall therefore restrict ourselves to a brief discussion of the main steps .",
    "we do several simplifications on the ( very complicated ) expressions resulting from eqs . and .",
    "we use the fact that @xmath251 and the approximate expression @xmath252 . also , while expanding the numerator and denominator around big @xmath162 , we use that @xmath226 ( a consequence of eqs . and ) to determine which terms can be neglected .",
    "then we replace the index of the unit cell with the stored photon @xmath245 by @xmath253 , where @xmath52 is the rescaled position coordinate .",
    "after further approximating @xmath254 and @xmath255 , we get @xmath256    next , we insert the expressions for @xmath257 and @xmath258 with the approximation @xmath259 , expand around @xmath56 , and use @xmath260 to identify which terms are dominant for @xmath261 .",
    "this results in @xmath262    we see that the resulting expressions do not depend on @xmath53 .",
    "this is a consequence of approximating @xmath259 .",
    "if we use @xmath208 together with eq .  , we find corrections from the dependence on @xmath53 .",
    "we only need the first term in eq .   to find the lowest order correction due to @xmath53 . at @xmath56 , and expanding around large @xmath162 , we have @xmath263 in fig .",
    "[ fig_r_and_t_plot_omega](a ) , we plot @xmath0 as a function of @xmath53 and show that the analytical expression in eq .",
    "matches the full expression calculated using eq .",
    "( evaluated at the resonance frequency ) without doing any approximations . in eq .   of the main article",
    ", we include all error terms of eq .   and also add the @xmath53 dependent error term from eq .  . likewise , in eq",
    ".   of the main article",
    ", we include all error terms of eq .   and also add the @xmath53 dependent error term from eq .  .      for the dualv scheme , we need two - mode ( @xmath264 ) transfer matrices to describe the @xmath122 and @xmath123 polarized modes .",
    "the transfer matrices for the atoms in eq .",
    "have the form @xmath265 ( @xmath266 is the index of the atom ) , where  @xcite @xmath267 and @xmath268 in the above , we have used the same convention as in eqs .  , i.e. that the first element of @xmath269 is the @xmath122 component and the second element is the @xmath123 component .",
    "hence , in eq .  , @xmath270 for example means the reflection coefficient , such that the incident @xmath122 field is reflected also as a @xmath122 field .",
    "similarly for the other reflection coefficients .",
    "if the atom is in state @xmath37 ( without a stored photon ) , the elements of @xmath271 are given by  @xcite @xmath272\\\\ & r_{j,-+ } = -\\frac{i(\\gamma_\\text{1d}/2)|\\omega_0|^2 } { \\delta_\\gamma^2\\delta -2\\delta_\\gamma|\\omega_0|^2}e^{2ik_0 z_j},\\\\ & r_{j,+- } = -\\frac{i(\\gamma_\\text{1d}/2)|\\omega_0|^2 } { \\delta_\\gamma^2\\delta -2\\delta_\\gamma|\\omega_0|^2}e^{-2ik_0 z_j},\\end{aligned}\\ ] ] where @xmath273 .",
    "if the atom is in state @xmath39 ( with a stored photon ) , it acts as a resonant v - type atoms , and hence the elements of @xmath271 are given by @xmath274    we will only calculate the reflection and transmission of ensembles of dual - v atoms numerically .",
    "here , we calculate the result of scattering from the sagnac interferometer shown in fig .",
    "[ fig_setup](d ) of the main article .",
    "the sequential picture of the scattering is that the incident field on one of the ports is split by the 50:50 beam splitter , gets scattered by the ensemble , and then the transmitted and reflected parts will again interfere on the same beam splitter .",
    "thus the matrix that relates the outputs to the inputs can be written @xmath275 where the matrix @xmath276 describes the beam splitter , and the matrix @xmath277 describes the ensemble .",
    "we choose the phases of the beam splitter , such that it performs the hadamard operation on the field , i.e. @xmath278 the ensemble can , in general , have different transmission and reflection coefficients depending on , whether the field is incident from the left or right .",
    "therefore , we write @xmath279 where @xmath280 and @xmath281 are respectively the reflection and transmission coefficients when the field is incident from the left ( propagating in the positive direction ) , and @xmath282 and @xmath283 are respectively the reflection and transmission coefficients when the field is incident from the right ( propagating in the negative direction ) .    multiplying the matrices ,",
    "we get @xmath284 for a standard ( non - rotating ) sagnac interferometer where @xmath285 and @xmath286 , we recover the well known result , that light always leaves the port in which it is incident  @xcite .",
    "because the equality @xmath285 need not be true , the off - diagonal entries of @xmath287 are , in general , not zero and describe the leakage of the incident power to the other port of the sagnac interferometer . however , due to the sequential operation of the gate , this leakage does not introduce any logic errors .",
    "since scattering of photon  @xmath28 happens , while photon  @xmath25 is stored inside the ensemble , leakage of photon  @xmath28 into the rail that encodes state @xmath27 ( see fig .  [",
    "fig_setup](c ) of the main article ) is separated in time from the subsequent retrieval of photon  @xmath25 and hence can be either absorbed or rerouted along a different path .    even though the off - diagonal entries of @xmath287 are non - zero in general , they are strongly suppressed in the ideal limit , since e.g. both @xmath280 and @xmath282 approach the same value ( either @xmath288 or @xmath211 depending on , whether a photon was stored in the ensemble or not ) . as a concrete example , for the @xmath3type scheme , we can use eq .   and find @xmath289 where @xmath290 is the same as @xmath106 , and @xmath291 is the reflection coefficient where the field is incident from the right instead of the left . the difference between eqs . and",
    "is only in the sign of the term @xmath292 in the numerator . as discussed above eq .",
    ", this term is much smaller than @xmath257 in the limit of large number of atoms and has therefore been neglected in eq .  .",
    "hence , eq .   can serve as an approximate expression for both @xmath290 and @xmath291 .",
    "we also note that it can be shown that the transmission coefficient for any @xmath160 transfer matrix is independent of whether the field is incident from one side or the other ( given by eq .   for @xmath107 ) .",
    "however , we still account for the possible difference in the scattering coefficients in the numerical calculations ( both for @xmath160 and @xmath264 transfer matrices ) by defining the scattering coefficients @xmath103 and @xmath293 in eqs . and",
    "as @xmath294 where the scattering coefficients with `` @xmath125 '' in the subscript assume incident photon from the left of the ensemble and the scattering coefficients with `` @xmath126 '' in the subscript assume incident photon from the right of the ensemble .",
    "we also need to discuss the choice of the phases in the interferometer . in eq .",
    "there is an implicit assumption that the lengths of free propagation in the interferometer are chosen such that the distance from the beam splitter to either end of the ensemble is a multiple of the wavelength @xmath295 .",
    "hence , the phase of free propagation is equal to unity for these parts .",
    "what we call `` ensemble '' may also contain some length of free propagation to the right of the ensemble to adjust the phases of its scattering coefficients .    to illustrate the necessity of phase adjustment , note that there is an overall phase factor @xmath233 in eqs .",
    ", , and compared with eqs . and of the main article .",
    "if this phase factor is not removed , it will directly appear as a factor of @xmath103 , when @xmath296 and @xmath297 .",
    "hence , the ideal value @xmath62 can not be obtained even in the limit of many atoms .",
    "there are similar phase factor considerations for @xmath293 due the phase factor of the reflection coefficient @xmath291 , while @xmath290 is assumed to be at @xmath298 and hence does not acquire phase factors with changing ensemble length .",
    "if the overall phase of the transmission coefficients is adjusted , the correct phase of @xmath103 and @xmath293 is obtained and the controlled - phase gate operation can approach the ideal limit as the number of the atoms is increased .    for the dual - v scheme , we can choose any inter - atomic spacing @xmath101 , which is not a multiple of @xmath159 ( see fig .",
    "[ fig_cphase_fidelity_kd ] below ) .",
    "for this general case , we expect that instead of the overall phase factor @xmath233 , the transmission coefficients have the phase factor @xmath299 , which we likewise remove by adding a distance of free propagation @xmath300 to the right of the ensemble chosen such that @xmath301 . multiplying this extra matrix of free propagation",
    "modifies the scattering coefficients according to @xmath302 the physical interpretation of this mathematical result is that , since the free propagation was added on the right of the ensemble , then reflection for the field incident from the left ( @xmath290 ) is unaffected , while the reflection coefficient for fields incident from the right ( @xmath291 ) acquires twice the propagation phase . the transmission coefficients only acquire the propagation phase once .",
    "the phase adjustments above effectively force the interferometer round trip length to be equal to an odd multiple of half wavelengths ( @xmath303 ) .",
    "hence , the phase adjustment can be made independent of the number of atoms .",
    "( `` dispersion '' ) , the fully discrete theory of sec .  [ discrete_eit_storage_retrieval ] , and the storage kernel of sec .  [ continuum_eit_storage_retrieval ]",
    "( `` kernel '' ) .",
    "contrary to the fidelity calculations , here we assume eit storage from one side ( left ) only to show the influence of random placement of the atoms more clearly .",
    "the common parameters for the two subplots are @xmath13 , @xmath7 , @xmath98 , @xmath304 ( width of the stored gaussian spin wave ) .",
    "( a ) regularly placed atoms are assumed with inter - atomic distance @xmath97 .",
    "all three curves are nearly indistinguishable from each other .",
    "( b ) randomly placed atoms , where the position of each atom is chosen from a uniform distribution over the whole ensemble .",
    "the average density is the same as in ( a ) .",
    "the curve for the fully discrete storage is clearly distinct from the two others and exhibits rapid variation with position . ]",
    "we will model the eit storage and retrieval process in three different ways :    1 .   using the dispersion relation ( see for instance ref .",
    "@xcite and sec .",
    "[ dispersion_eit_storage_retrieval ] below ) .",
    "2 .   using the fully discrete theory ( see ref .",
    "@xcite and sec .",
    "[ discrete_eit_storage_retrieval ] below ) .",
    "3 .   using the storage and retrieval kernels ( see ref .",
    "@xcite and sec .",
    "[ continuum_eit_storage_retrieval ] below ) .",
    "we will consider the so - called adiabatic eit storage @xcite , where a single - photon wave packet is incident on the ensemble and is mapped onto a spin wave ( a superposition of states , where a single atom is in state @xmath38 and the rest are in state @xmath37 ) .",
    "we assume a constant rabi frequency of the classical drive @xmath305 , but choosing a co - propagating classical drive with rabi frequency @xmath306 will only change the spatially - dependent phase factor of the stored spin wave . in the limit of high storage efficiency , the temporal profile of the photon and the spatial profile of the stored spin wave will approximately have the same form .",
    "e.g. if a photon with gaussian temporal wave packet is stored , the resulting spin wave will have a gaussian spatial profile .",
    "this is a consequence of the time - independent rabi frequency of the classical drive and allows us to use the eit dispersion relation to describe the storage and retrieval .",
    "the eit dispersion relation is used to gain intuition about the storage and retrieval process and also for the analytical calculations . in the numerical calculations of the fidelities and success probability , the atoms are always modeled as being discrete . using the fully discrete eit storage and retrieval model  ( sec .",
    "[ discrete_eit_storage_retrieval ] ) becomes very costly as the number of atoms increases .",
    "therefore , to be able to calculate fidelities with a large number of atoms , we instead use the less computationally demanding storage and retrieval kernels derived in the continuum model and suitably discretized ( sec .  [ continuum_eit_storage_retrieval ] ) . in fig .",
    "[ fig_eit_storage_models_comparison ] , we show that the three models agree very well for the case of regularly placed ensembles with big optical depth @xmath307 . for randomly placed atoms ,",
    "the fully discrete theory gives noticeably different results compared to using the discretized continuum theories ( dispersion relation or storage kernel ) .",
    "since we assume regular placement for the curves in fig .",
    "[ fig_cphase_fidelity_natoms ] of the main article , the discretized storage and retrieval kernels are sufficient .",
    "we also verify this in fig .",
    "[ fig_cphase_fidelity_lambda_check_discrete ] below for the @xmath3-type scheme , and the same conclusion holds for the dual - v scheme . in fig .",
    "[ fig_cphase_fidelity_random_placement ] below , where we show fidelities for randomly placed atoms , we only use the fully discrete model for storage and retrieval , even though it limits the maximal number of atoms that can be used in the calculations .",
    "the adiabatic eit storage and retrieval can be modeled in a particularly simple way if the influence of the interface between the atomic medium and vacuum is ignored . to use the eit dispersion relation , we need to assume that the ensemble is of an infinite extent .",
    "however , to compute the the storage and retrieval efficiency , we need to assume propagation through a finite ensemble . in the calculations below ,",
    "this is reflected in infinite bounds for the integration but a finite propagation length .",
    "the only processes that happen in this model is that the stored photon wave packet broadens in space as it propagates , and its norm decays due to spontaneous emission .",
    "the eit storage and retrieval efficiency will then be the norm of the wave packet that has propagated for the full length of the ensemble @xmath45 ( with a stop at @xmath308 to allow for the second photon to be scattered off the ensemble ) .",
    "the eit dispersion relation is  @xcite @xmath309 with @xmath310    in rescaled coordinates @xmath52 and wave vectors @xmath311 the dispersion can be written @xmath312 with @xmath313    we only consider incident photons where the temporal profile is gaussian .",
    "when such a photon is mapped onto a stored excitation , this results in an approximately gaussian spatial profile of the form @xmath314 where the rescaled quantities are @xmath77 , @xmath315 , @xmath316 . by fourier transforming this wave function to get @xmath317 , multiplying the fourier transform by @xmath318 and fourier transforming back we find @xmath319    the norm squared of the wave packet at time @xmath320 is given by @xmath321 the combined storage and retrieval efficiency is given by eq . with @xmath322 , i.e. the time required to pass the whole ensemble .",
    "we thereby get @xmath323      using the intuition about eit from sec .",
    "[ dispersion_eit_storage_retrieval ] , one can implement the numerical simulations of eit storage and retrieval accounting for the discrete nature of atoms .",
    "this approach is very similar to the `` electric field elimination '' approach of ref .",
    "the main difference is that , since storage and retrieval of a single photon only requires calculating the dynamics in the atomic single - excitation manifold , we can eliminate the electric field directly in the schrdinger picture instead of the heisenberg picture like in ref .",
    "@xcite .",
    "the electric field operator can be written @xmath324 , where @xmath325 and @xmath326 are the parts of the field that respectively propagate to the right ( positive direction ) and left ( negative direction ) .",
    "the two parts are assumed to be completely separate fields , and their commutators are @xmath327 = \\delta_{\\alpha\\beta}\\delta(z - z'),\\end{gathered}\\ ] ] where @xmath328 .",
    "the hamiltonian for the ensemble of @xmath3-type atoms coupled to the electric field is @xmath329 , representing the atomic , interaction and photonic hamiltonian respectively .",
    "the three parts of the hamiltonian are given by @xmath330\\bigg\\ } , \\displaybreak[0]\\\\ & \\hat{h}_\\text{p } = -i\\hbar c\\int \\sbr{{\\hat{\\mathcal{e}}}_{+}^\\dagger(z)\\dpd{{\\hat{\\mathcal{e}}}_{+}(z)}{z } -{\\hat{\\mathcal{e}}}_{-}^\\dagger(z)\\dpd{{\\hat{\\mathcal{e}}}_{-}(z)}{z}}\\dif z,\\end{aligned}\\ ] ] where @xmath331 is the group velocity in the waveguide .",
    "we assume that the detuning @xmath332 is always set to zero during storage and retrieval ( this was also assumed in sec .",
    "[ dispersion_eit_storage_retrieval ] above ) .",
    "however , if desired , off - resonant ( @xmath333 ) eit storage and retrieval is also possible  @xcite , and hence we keep the @xmath332 term in the equations of motion below .    on the single - excitation manifold",
    ", the state can be written @xmath334 from the schrdinger equation , we get the equations of motion for the atomic coefficients @xmath335 where @xmath336 . for the electric field coefficients",
    "@xmath337 we have the equations @xmath338 these equations can be formally solved , so that we obtain @xmath339 where @xmath340 are the input fields , and @xmath166 is the heaviside theta function . inserting these solutions into eq .   and",
    "approximating @xmath341  @xcite , we find @xmath342    the fidelity calculations in sec .  [ sec_fidelity_general ] above are formulated in terms of @xmath343 and @xmath344 , which are respectively the input field to be stored and the retrieved output field .",
    "( there are two different output fields , @xmath345 and @xmath346 , but for the discussion of storage and retrieval , the difference between them is not important . ) we need to account for the beam splitter in the sagnac interferometer .",
    "hence , the relations between the fields in this section and sec .",
    "[ sec_fidelity_general ] are @xmath347 note that storage is done from two directions in order to ensure that no excitations are stored on atoms at the nodes of the standing wave of the classical drive applied during the scattering for the @xmath3-type scheme",
    ". the conditions for this may not necessarily be the same as the conditions derived for scattering from the sagnac interferometer ( see sec .",
    "[ sec_sagnac_interferometer_and_phases ] ) .",
    "if this is an issue , it can be compensated by adjusting the position of the atoms between storage and scattering , e.g. , by adjusting the phases of the trapping lasers or of the classical drives .",
    "for the dual - v scheme , there is no phase requirement during storage and this is not a concern .",
    "as the input wave function , we assume @xmath348 where the width and central time @xmath349 are defined in terms of the eit group velocity .",
    "the factor @xmath350 ( a real number , since @xmath351 is imaginary ) in the definition of @xmath352 is introduced to compensate for the spin wave becoming wider as it propagates inside the ensemble ( see eq .  ) .",
    "this particular factor is chosen such that the stored gaussian spin wave ( centered at the position @xmath308 ) has width @xmath353 . in the end , since we optimize over @xmath353 , this adjustment has no effect on the final values of the numerically calculated fidelities and success probability .",
    "however , it ensures that the optimal @xmath353 in the numerical calculations is similar to the optimal value found by neglecting broadening of the spin wave under propagation .    in the fully discrete model , we do not explicitly calculate the storage and retrieval kernels that appear in eqs . and .",
    "instead , we calculate the action of these kernels on respectively a specific @xmath343 or a spin wave given by the coefficients @xmath354 . for storage , this amounts to numerically solving eqs . and for a given @xmath343 and the initial condition @xmath355 at @xmath356 .",
    "we take the stored spin wave to be the coefficients @xmath354 at @xmath357 .",
    "this final time is the sum of the time for propagation through vacuum and ( half of ) the eit medium . for retrieval ,",
    "are solved with @xmath358 under the initial conditions that at @xmath356 the coefficients @xmath359 are set to the spin wave that is to be retrieved , and @xmath360 . at each time step , we calculate @xmath344 using eq .   with @xmath361 along with eq .",
    "we assume that the retrieval happens until @xmath362 , i.e. the time that it takes for the eit polaritons to move through the whole ensemble .      as an approximation to the fully discrete theory of sec .",
    "[ discrete_eit_storage_retrieval ] , one can use the continuum theory of ref .",
    "the continuum approximation allows the derivation of explicit expressions for the linear maps ( given in terms of integration with a particular kernel ) describing storage and retrieval .    before doing the continuum approximation , we first rewrite the hamiltonian   in terms of the collective operators @xmath363 where @xmath364 , and @xmath365",
    "is the average density .",
    "these collective operators have the equal time commutation relation @xmath366 & = \\frac{1}{n_0}\\delta(z - z ' ) ( \\delta_{\\beta,\\alpha'}\\hat{\\sigma}_{\\alpha\\beta ' } -\\delta_{\\beta',\\alpha}\\hat{\\sigma}_{\\alpha'\\beta}).\\end{aligned}\\ ] ] using the collective atomic operators , the hamiltonian   is @xmath367\\dif z\\\\ & \\hat{h}_\\text{i}=-\\hbar n_0\\int \\bigg\\{\\left[\\hat{\\sigma}_{bc}(z)\\omega_0 + \\text{h.c.}\\right ] + g\\sqrt{2\\pi}\\left[\\hat{\\sigma}_{ba}(z){\\hat{\\mathcal{e}}}(z ) + \\text{h.c.}\\right]\\bigg\\}\\dif z\\\\ & \\hat{h}_\\text{p}=-i\\hbar c\\int\\bigg[{\\hat{\\mathcal{e}}}_{+}^{\\dagger}(z)\\dpd{{\\hat{\\mathcal{e}}}_{+}(z)}{z } -{\\hat{\\mathcal{e}}}_{-}^{\\dagger}(z)\\dpd{{\\hat{\\mathcal{e}}}_{-}(z)}{z}\\bigg]\\dif z.\\end{aligned}\\ ] ] instead of the state , we use @xmath368 note that if , for example , the excitation is entirely in the metastable states at a time @xmath369 , we have @xmath370 \\dif z = \\frac{1}{l}\\int \\int |s(z , t)|^2\\dif z,\\end{gathered}\\ ] ] where we have used the continuum approximation @xmath371  @xcite together with the low excitation approximation @xmath372 to get @xmath373 and @xmath374 .",
    ".   also gives the normalization condition for @xmath277 in the continuum model ( and similarly for @xmath375 ) .",
    "the equations for the coefficients are @xmath376 as an extension to the theory of ref .",
    "@xcite , we want to consider an input field which is , in general , incident from both sides instead of only one . the approach that we use is to consider the parts of the single photon excitation incident from both sides as being stored separately from each other . when doing this we ignore the fact that the two parts have opposite spatial phases @xmath377 , which interfere inside the ensemble to produce a spatially modulated spin wave with amplitude proportional to @xmath36 .",
    "this spatial modulation of the stored spin wave is very important for the @xmath3scheme , since the part of the excitation that is stored on the nodes of the standing wave of the classical drive does not significantly change the scattering properties of the ensemble ( see sec .",
    "[ lambda_r_t_with_stored_photon ] ) . expressed in terms of the notation introduced in the fidelity calculations ( see eq .  ) we have @xmath378 for odd @xmath266 with atoms placed at positions @xmath18 ( @xmath19 ) , i.e. @xmath379 being an odd multiple of @xmath380 . with the photon incident from both sides ,",
    "we ensure that there is no amplitude on these atoms , since @xmath381 for odd @xmath266 .",
    "this is correctly reproduced by the fully discrete model of sec .",
    "[ discrete_eit_storage_retrieval ] , since it always accounts for the phases of free propagation . on the other hand , due to the removal of the rapidly varying spatial phases in the continuum theory ,",
    "this factor @xmath382 is not present in the two separate parts of the stored spin wave . to compensate for this",
    ", we set @xmath383 for odd @xmath266 . as we show in fig .",
    "[ fig_cphase_fidelity_lambda_check_discrete ] , this phenomenological adjustment of the reflection coefficient gives results that are essentially indistinguishable from the results produced by the fully discrete model of sec .",
    "[ discrete_eit_storage_retrieval ] . for the dualv scheme , no such adjustment of the reflection coefficients",
    "is needed neither in the continuum nor the discrete model , which also produce indistinguishable results .    type scheme with different models used for eit storage and retrieval plotted as functions of the number of atoms @xmath12 with fixed @xmath13 .",
    "the `` discrete '' plots use the fully discrete theory of sec .",
    "[ discrete_eit_storage_retrieval ] , and the `` kernel '' plots use the discretized storage and retrieval kernels derived in sec .",
    "[ continuum_eit_storage_retrieval ] . in both cases , the optimal @xmath42 and @xmath79 ( width of the stored gaussian spin wave )",
    "are found by doing numerical optimization using the discretized storage and retrieval kernels , since the fully discrete model is much more computationally demanding . ]",
    "the photons incident from the left and right couple to different components of the atomic coefficients , which can be written @xmath384 after inserting these definitions into eqs .",
    ", and and separating the components , we get @xmath385    to solve for @xmath386 , @xmath387 and @xmath388 , the approach in ref .",
    "@xcite can be directly used .",
    "it consists of transforming into the coordinates @xmath52 and @xmath389 , laplace transforming in space , solving the algebraic equations of the laplace transforms ( under the adiabatic approximation @xmath390 ) and then laplace transforming back . as a minor modification , we also transform back from the co - propagating time coordinate @xmath389 to the original @xmath369 ( by replacing all @xmath391 by @xmath369 in the final expressions ) . solving for @xmath392 , @xmath393 and @xmath394",
    "is simply a spatial reflection of the original problem around @xmath56 .",
    "we find that the stored spin wave is @xmath395 where the storage kernel ( in the adiabatic approximation ) is @xmath396 written in terms of @xmath397 ( related to the optical depth by @xmath398 ) and the modified bessel function of the first kind @xmath399 .",
    "the retrieved field is @xmath400 where the retrieval kernel is @xmath401    the stored spinwaves are chosen such that they are centered at @xmath56 and become narrower in space for increasing optical depth ( see the fidelity derivations in sec .",
    "[ sec_analytical_fidelity ] below ) .",
    "the input and output photon wave functions are centered around times @xmath402 . inserting these mean values into eqs .  and",
    ", we see that the argument of @xmath399 becomes very big , since @xmath403 and @xmath404 .",
    "this allows us to use the asymptotic expansion @xmath405 , which is valid for @xmath406 and @xmath407 . in this limit ,",
    "the kernels become @xmath408 these formulas have a better numerical behavior compared to eqs . and , since one does not need to multiply the value of the @xmath399 ( exponentially large ) with an exponentially small factor .",
    "hence , we always use eqs . and in the numerical calculations .    the relations between the fields in this section and sec",
    "[ sec_fidelity_general ] are @xmath409    the results of this section assume that the atoms can be modeled as a continuum , but the scattering coefficients in eq .",
    "are only given at the discrete atom positions .",
    "hence , we need to sample the resulting continuum solutions at the discrete positions of the atoms . in the numerical calculations ,",
    "the continuum solutions are always sampled as if the atoms were placed regularly independent of the actual placement . to justify regular sampling , we note that instead of the rescaled position coordinate @xmath52 , one could use @xmath410  @xcite , where @xmath411 is the local density of the atoms . for an average density @xmath365 ,",
    "this rescaled coordinate is equivalent to @xmath52 . for the local density @xmath412 ,",
    "the rescaled position becomes @xmath413 , where @xmath166 is the the heaviside theta function . with the convention @xmath414 , each @xmath415",
    "is transformed into @xmath416 regardless of the actual value of @xmath415 . as shown in fig .",
    "[ fig_eit_storage_models_comparison](b ) for random placement of the atoms , even though the continuum solutions seem to be able to reproduce the results of the fully discrete theory to some degree , there are still significant differences , which we believe to be caused by reflection of parts of the propagating excitation due to disorder , which are not accounted for in the continuum theory . hence , with randomly placed atoms ,",
    "the fully discrete model is required .",
    "having in mind both the separation of the spin waves into two independent parts and the sampling of the continuum solutions at regular intervals , we can define the storage and retrieval kernels that will be used in eqs . and .",
    "we define the vector representing the spin wave to have @xmath417 elements  for two separately stored spin waves that have fields incident either from the left or from the right as the input . using the same storage time @xmath418 as for the discrete model in sec .",
    "[ discrete_eit_storage_retrieval ] , the storage kernel is @xmath419 where we have assumed that the coefficients corresponding to @xmath388 are stored in the part of the vector with indices @xmath19 , and the coefficients corresponding to @xmath394 are stored in the part of the vector with @xmath420 .",
    "the retrieval kernel is @xmath421 as a consequence of having a spin wave vector with @xmath417 elements , in eq .",
    "we define @xmath422 for @xmath420 .",
    "here , we derive [ f_cj_1,f_cj_cond_1,f_cj_2,f_cj_cond_2 ] of the main article .",
    "we also derive the bandwidth dependent correction to eq .   of the main article , which is used in the discussion of the gate time .",
    "from [ r_ensemble_n , t_ensemble_n , r_imp_ensemble_n , t_imp_ensemble_n ] of the main article , we find the approximate reflection coefficients of the combined system of the atomic ensemble and the sagnac interferometer .",
    "they are @xmath423 note that in the symmetrized reflection coefficient @xmath424 , the linear terms proportional to @xmath425 ( which are present in eqs . and of the article ) cancel each other . using the expression for the spin wave given by eq .",
    "with @xmath426 we get @xmath427    using eq .   from the main article ,",
    "an approximation for the unconditional cj fidelity is @xmath428 where @xmath429 , and all the error terms ( including @xmath430 ) are assumed to be small .    in principle , if we want to optimize the above expression , we should optimize with respect to @xmath42 and @xmath79 simultaneously ( we do this in the numerical calculations ) . here",
    ", we use an approximate optimization procedure , which ignores the fact that one of the error terms depends on the product of @xmath42 and @xmath79 . as we will see , however , this error term is smaller than the error terms , which only depend on @xmath42 for fixed @xmath20 and large @xmath12 . therefore , we first optimize @xmath78 over @xmath42 separately and then use the optimal value of @xmath42 to optimize over @xmath79 .",
    "the optimal value of @xmath42 is determined by the condition that the third and fourth error terms on the right hand side of eq .",
    "are equal , i.e. @xmath431 this results in @xmath432 inserting this value of @xmath42 into eq .",
    "we obtain @xmath433 we use this expression to optimize over @xmath79 .",
    "the optimal @xmath79 is obtained when @xmath434 from this condition we get @xmath435 and with this value of @xmath79 , eq",
    ".   becomes @xmath436 we see that for @xmath437 , the last term in this expression approaches zero faster than the second one .",
    "hence , in eqs .",
    "and of the main article we have omitted this term .",
    "the difference between eq .",
    "and eq .   is whether we set respectively @xmath438 or @xmath439 .",
    "next we calculate the conditional fidelity @xmath81 . since it is given by @xmath75 , the expansion of the ratio will contain higher order error terms than the expansion of the unconditional fidelity @xmath78 . hence , we need an expansion of @xmath78 with more terms than in eq .  .",
    "including the second order terms and dividing out @xmath440 ( since it gets canceled in @xmath81 ) , we get @xmath441    using eq .  , we also get the success probability @xmath442 where @xmath443    using the above expressions , the conditional fidelity can be written @xmath444 where @xmath445 using the @xmath42 from eq .",
    ", we get @xmath446 if we choose @xmath438 , @xmath447 is the dominant error term with the value @xmath448 in which case @xmath449 can be neglected .",
    "if we choose @xmath450 , we get @xmath451 , and we need to keep @xmath449 .",
    "the value of @xmath449 depends on the width of the stored gaussian @xmath79 . for simplicity",
    ", we use the value of @xmath79 given by eq .  , which makes the unconditional fidelity maximal .",
    "with this choice , the conditional fidelity is given by eq .",
    "of the main article .",
    "a comparison of the analytical formulas and the numerical results for @xmath78 and @xmath81 is shown in fig .",
    "[ fig_cphase_fidelity_big_natoms ] .",
    "type scheme plotted as functions of the number of atoms @xmath12 with fixed @xmath13 .",
    "dotted green curves are the numerically calculated fidelities with @xmath76 .",
    "dash - dotted black curves are the approximate analytical results given by eq .",
    "( unconditional ) and eq .",
    "( conditional ) of the main article .",
    "solid blue curves are the numerically calculated fidelities with @xmath30 chosen such that the entanglement swap fidelity ( which is approximately equal to the conditional choi - jamiolkowski fidelity as shown in fig",
    ".  [ fig_cphase_fidelity_f_swap ] ) is maximal .",
    "the dashed red curves are the approximate analytical results given by eq .",
    "( unconditional ) and eq .",
    "( conditional ) of the main article . for storage and retrieval in the numerical calculations ,",
    "we use the discretized continuum theory described in sec .",
    "[ continuum_eit_storage_retrieval ] . ]",
    "now we derive the correction to the unconditional fidelity due to non - zero bandwidth of the scattered photon  @xmath28 .",
    "the general expression for the fidelity is given by eq .  .",
    "as discussed in the main article , we ignore the non - zero bandwidth in the last term since the variation of @xmath51 and @xmath50 with frequency around the resonance detuning @xmath109 is smaller than variation of @xmath106 and @xmath107 .",
    "hence , we approximate @xmath452 such that the expression for the fidelity becomes @xmath453 using eqs . and together with expressions @xmath237 and @xmath54 and defining the spectral width of photon  @xmath28 by @xmath454 , we get @xmath455 using the optimal @xmath42 from eq .  , this becomes @xmath456 to minimize the sum of the two last error terms in this expression , we optimize over @xmath53 and get @xmath457 for the optimal @xmath458 i.e. compared to eq .  , there is an extra error term that depends on @xmath459 .",
    "while the @xmath3-type scheme is highly sensitive to the exact placement of the atoms , the dual - v scheme is much less sensitive . to verify this",
    ", we numerically evaluate the gate performance for various placements of the atoms .",
    "first , we investigate the dependence for regularly placed dual - v atoms with different interatomic spacings @xmath101 . in fig .",
    "[ fig_cphase_fidelity_kd ] , we see that for @xmath460 different from multiples of @xmath380 , both the conditional and unconditional fidelities are approximately constant .",
    "second , we consider randomly placed dual - v atoms . in fig .",
    "[ fig_cphase_fidelity_random_placement ] , the fidelities with regular and random placement are seen to have qualitatively the same behavior , but the performance with random placement is slightly worse .",
    "times the photon wave vector @xmath16 for fixed number of atoms @xmath7 and @xmath13 .",
    "for storage and retrieval , we use the discretized storage and retrieval kernels derived in sec .",
    "[ continuum_eit_storage_retrieval ] . ]     with fixed @xmath13 .",
    "the regularly placed atoms have have positions @xmath461 for @xmath97 and @xmath462 .",
    "the positions of the randomly placed atoms are chosen from the uniform distribution over the whole ensemble and then sorted in increasing order . for random placement",
    ", we average over 1000 ensemble realizations . for storage and retrieval , the fully discrete model of sec .",
    "[ discrete_eit_storage_retrieval ] is used . for regular placement",
    ", it gives the same results as the discretized storage and retrieval kernels derived in sec .",
    "[ continuum_eit_storage_retrieval ] , but for random placement , the fully discrete model has significant deviations from the discretized storage and retrieval kernels as shown in fig .",
    "[ fig_eit_storage_models_comparison ] . the optimal @xmath42 and @xmath79 ( width of the stored gaussian spin wave )",
    "are found by doing numerical optimization using the discretized storage and retrieval kernels , since the fully discrete model is much more computationally demanding . ]",
    "11ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase    10.1103/physreva.77.063823 [ * * ,   ( ) ] @noop   @noop link:\\doibase 10.1103/physreva.71.062310 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.52.1394 [ * * ,   ( ) ] @noop   http://stacks.iop.org/0953-4075/39/i=5/a=001 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.108.103902 [ * * ,   ( ) ] http://stacks.iop.org/1367-2630/13/i=2/a=023003 [ * * ,   ( ) ] http://stacks.iop.org/1367-2630/17/i=11/a=113001 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.76.033805 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we propose a method to induce strong effective interactions between photons mediated by an atomic ensemble . to achieve this </S>",
    "<S> , we use the stationary light effect , which makes the atomic ensemble behave as an optical cavity and thereby increases the interaction strength . </S>",
    "<S> regardless of the optical depth per atom , the interaction strength between the photons can be enhanced by increasing the total number of atoms ( total optical depth ) . for sufficiently many atoms </S>",
    "<S> , the setup can be viable as a controlled - phase gate for photons . </S>",
    "<S> we derive analytical expressions for the fidelities for two modes of gate operation : deterministic and heralded conditioned on the presence of two photons at the output . </S>",
    "<S> the latter mode can be used to improve the secret key rate for quantum repeaters compared to using only linear optics .    </S>",
    "<S> optical photons are ideal carriers of quantum information over long distances , and such quantum communication may enable a wealth of applications @xcite . </S>",
    "<S> quantum information processing with photonic qubits is , however , severely limited by the lack of efficient two - qubit gates . in principle , such gates could be realized by strongly coupling photons to a single atom  @xcite . </S>",
    "<S> experiments have pushed towards realizing such strong coupling , e.g. in cavity qed structures @xcite and optical waveguides @xcite , but the realization of gates remains challenging . </S>",
    "<S> an alternative approach to strong light - matter interactions is to use atomic ensembles where a large number of atoms compensates for a small coupling efficiency of the individual atoms  @xcite , but this approach typically does not enhance the nonlinear interactions required for quantum gates . in recent years </S>",
    "<S> , experiments in e.g. tapered optical fibers  @xcite and hollow core photonic - crystal fibers  @xcite have realized an intermediate regime where the coupling of the individual atoms is sizeable , but still not sufficient to realize photonic gates based on single atoms . </S>",
    "<S> it is thus an open question to which degree such moderate couplings enable processing of quantum information .    </S>",
    "<S> , @xmath0 ) and transmittances ( @xmath1 , @xmath2 ) of an ensemble of @xmath3type atoms without ( @xmath4 , @xmath1 ) and with ( @xmath0 , @xmath2 ) a stored photon for different frequencies ( two - photon detunings )  @xmath5 in units of the total linewidth @xmath6 . </S>",
    "<S> the vertical dotted line marks the operation point . </S>",
    "<S> the parameters are : number of atoms @xmath7 , @xmath8 , @xmath9 , and @xmath10 . </S>",
    "<S> ( b )  secret key rate @xmath11 per repeater station as a function of the number of atoms @xmath12 with fixed @xmath13 for dual - v atoms and a communication distance of 1000 km . </S>",
    "<S> we compare the protocol of ref .  </S>",
    "<S> @xcite ( `` linear '' ) with a modified protocol where the entanglement swapping ( and also initial entanglement generation if it improves @xmath11 ) is performed with the proposed stationary light cp gate ( `` sl '' ) . </S>",
    "<S> we consider two different source repetition rates : 100  mhz and 1  mhz . </S>",
    "<S> we assume an attenuation length of 22 km in the fibers and an optical signal speed of @xmath14 km / s . </S>",
    "<S> the ensemble storage and retrieval efficiency increases with @xmath12 and is set to the same value in the original protocol as for the modified one . the photodetector efficiency is assumed to be 90% . </S>",
    "<S> the steps in the curves occur when the fidelity of the cp gate allows additional swap levels . ]    in this letter , we propose a method to exploit the moderate coupling regime to realize quantum gates between photons . </S>",
    "<S> we show that by using sufficiently many atoms it is possible to compensate for the limited coupling strength of the individual atoms and achieve ideal gate operation  @xcite . </S>",
    "<S> the proposed gate is based on _ stationary light _ </S>",
    "<S> @xcite where polaritons ( coupled light - matter excitations ) have very low group velocity due to counter - propagating classical drives . </S>",
    "<S> reflections from the ends of an ensemble experiencing stationary light result in a cavity - like transmission spectrum with transmission resonances whenever the polaritons form standing waves inside the ensemble @xcite . </S>",
    "<S> we show that the storage of a single photon completely changes the transmission spectra of the ensemble , see fig .  </S>",
    "<S> [ fig_r_and_t_plot](a ) , because the cavity structure created by the remaining atoms enhances the interaction with the stored excitation . </S>",
    "<S> this can be used to mediate a gate between photons , which can be either deterministic or heralded where successful operation is conditioned on subsequent detection of two photons . as a particular application </S>",
    "<S> we show that the gate can be directly used to enhance the communication rate of ensemble based quantum repeaters  @xcite ( fig .  </S>",
    "<S> [ fig_r_and_t_plot](b ) ) .    </S>",
    "<S> _ overview . </S>",
    "<S> _ we consider two different level schemes for the atoms in the ensemble : @xmath3type and dualv ( figs . </S>",
    "<S> [ fig_setup](a ) and [ fig_setup](b ) , respectively ) . </S>",
    "<S> the linear properties of these two schemes are described in detail in ref .  </S>",
    "<S> @xcite . in the @xmath3type scheme , </S>",
    "<S> the two classical drives have the same polarization , which results in a standing wave of the rabi frequency @xmath15 , where @xmath16 is the wave vector of the classical drive , assumed to be the same as the wave vector of the probe field @xmath17 ( single photon ) . for the @xmath3type scheme , we assume that the atoms are placed at positions @xmath18 with @xmath19 to achieve the lowest possible group velocity  @xcite . </S>",
    "<S> this scheme is easier to analyze , and all our analytical results are obtained for this scheme . </S>",
    "<S> the dualv scheme  @xcite is less sensitive to the exact positions of the atoms and hence easier to implement in practice . for the dualv scheme , </S>",
    "<S> we only verify numerically that the gate errors have the same scaling as for the @xmath3type scheme .    </S>",
    "<S> the coupling of the atoms to the waveguide is characterized by the parameter @xmath20 ( half of the optical depth per atom ) , where @xmath21 is the decay rate from state @xmath22 for the @xmath3type scheme into both right - moving and left - moving guided modes ( assumed to be equal ) , @xmath23 is the decay rate into all the other modes , and @xmath24 is the total decay rate . in the dual - rail encoding of photonic qubits shown in fig .  </S>",
    "<S> [ fig_setup](c ) , two identical atomic ensembles are required , where the upper one only functions as a memory . alternatively , the single - rail encoding can also be implemented with one atomic ensemble  @xcite , but the dual - rail encoding allows heralded operation , which has better fidelity . </S>",
    "<S> each ensemble is placed inside a sagnac interferometer ( fig .  </S>",
    "<S> [ fig_setup](d ) ) .    </S>",
    "<S> the operation of the cp gate is sequential . </S>",
    "<S> first , photon  @xmath25 is stored either in the upper ( @xmath26 ) or the lower ( @xmath27 ) ensemble using electromagnetically induced transparency ( eit )  @xcite </S>",
    "<S> . then photon  @xmath28 is scattered from the lower ensemble under conditions of stationary light ( @xmath29 ) or passes through a beam splitter with transmission coefficient @xmath30 ( @xmath31 ) . </S>",
    "<S> the role of this beam splitter will be explained below . </S>",
    "<S> the sagnac interferometer can be set up such that most of the incident power in each of its two input ports is reflected back through the same port , regardless of whether the ensemble is reflective or transmissive . </S>",
    "<S> reflection or transmission of the ensemble instead controls the phase of the reflected field . </S>",
    "<S> the scattering of photon  @xmath28 can be arranged such that if there is no stored photon in the lower ensemble ( photon  @xmath25 is in the state @xmath26 ) , the atomic ensemble is completely transmissive in the ideal case , and photon  @xmath28 is reflected from the sagnac interferometer with no additional phase . </S>",
    "<S> if there is a stored photon ( photon  @xmath25 is in state @xmath27 ) , photon  @xmath28 is reflected from the interferometer with a @xmath32 phase shift . </S>",
    "<S> the latter case performs the desired controlled - phase gate operation @xmath33 , while the rest of the basis states are unchanged . </S>",
    "<S> finally , photon  @xmath25 is retrieved using eit .    </S>",
    "<S> _ storage and retrieval . </S>",
    "<S> _ under eit storage and retrieval , the incident photon is resonant with the classical drive , and the classical drive is incident from one side and is assumed to be resonant with its transition for simplicity . after entering the sagnac interferometer , photon  @xmath25 will be split into two halves by the 50:50 beam - splitter ( see fig .  </S>",
    "<S> [ fig_setup](d ) ) , which upon reaching the ensemble from the opposite sides will have opposite spatial phase factors @xmath34 and @xmath35 and interfere inside the ensemble resulting in a spatially modulated @xmath36 stored spin wave . </S>",
    "<S> such storage procedure is necessary for the @xmath3-type scheme , since the part of the excitation that is stored on the nodes of the standing wave of the classical drive ( that is applied during scattering of photon  @xmath28 ) does not change the scattering properties of the ensemble . before the eit storage </S>",
    "<S> , all atoms are initialized in state @xmath37 , and after storage , the incident photon is mapped onto an atom being in state state @xmath38 . </S>",
    "<S> to produce an optical non - linearity , we assume that state @xmath38 is subsequently transferred to state @xmath39 using a @xmath32-pulse .    _ reflection and transmission . </S>",
    "<S> _ we use the ( multi - mode ) transfer matrix formalism @xcite to model the scattering process . to illustrate the scattering behavior </S>",
    "<S> , we assume that photon @xmath25 was stored in the center of the atomic ensemble at an anti - node of the classical drive . the reflectances and transmittances of an ensemble of @xmath3type atoms </S>",
    "<S> are plotted in fig .  </S>",
    "<S> [ fig_r_and_t_plot](a ) as functions of two - photon detuning @xmath40 , where @xmath41 ( @xmath42 ) is the detuning of the probe field ( classical drive ) . </S>",
    "<S> the reflectance @xmath4 ( @xmath0 ) and transmittance @xmath1 ( @xmath2 ) are for an ensemble without ( with ) a stored photon . </S>",
    "<S> the ensemble is seen to have transmittance resonances with a large transmittance and a small reflectance , similar to the transmission of a cavity . </S>",
    "<S> these resonances occur when the standing wave condition is fulfilled , i.e. @xmath43 , where @xmath44 is the bloch vector of the stationary light polaritons and @xmath45 is the length of the ensemble  @xcite . when a photon is stored in the ensemble , an atom changes from state @xmath37 to @xmath39 . in state @xmath39 , </S>",
    "<S> the atom acts as a two - level atom that is resonant with the incident photon ( see fig .  </S>",
    "<S> [ fig_setup](a ) ) . since the effective interaction is enhanced by the cavity - like behavior of the ensemble </S>",
    "<S> , this single two - level atom can have a strong effect of an incident photon , even though the atom in itself has a limited coupling .    </S>",
    "<S> we focus on the behavior at the resonance nearest @xmath46 ( vertical dotted line in fig .  [ fig_r_and_t_plot](a ) ) . in the limit of large atom number @xmath12 and for @xmath47 </S>",
    "<S> , this resonance is at a two - photon detuning @xmath48 , for which we obtain  @xcite @xmath49\\\\ \\label{t_ensemble_n } & \\begin{aligned } & t_0\\approx 1-r_0 , \\end{aligned } \\displaybreak[0]\\\\ \\label{r_imp_ensemble_n } & </S>",
    "<S> \\begin{aligned } & r_1(\\tilde{z})\\approx 1 -\\frac{4\\pi^2\\gamma'\\delta_\\text{c}^2}{\\gamma_\\text{1d}^3 n^2 } + \\frac{32\\pi^4 \\delta_\\text{c}^2 \\gamma ' |\\omega_0|^2}{\\gamma_\\text{1d}^5 n^4}\\\\ & -\\frac{4i\\pi^2\\delta_\\text{c}}{\\gamma_\\text{1d } n } \\left(\\tilde{z}-\\frac{1}{2}\\right ) </S>",
    "<S> -\\frac{4\\pi^4\\delta_\\text{c}^2(2\\gamma_\\text{1d}+\\gamma')}{\\gamma_\\text{1d}^3 n^2 } \\left(\\tilde{z}-\\frac{1}{2}\\right)^2 , \\end{aligned } \\displaybreak[0]\\\\ \\label{t_imp_ensemble_n } & \\begin{aligned } & t_1(\\tilde{z})\\approx   \\frac{4\\pi^2\\delta_\\text{c}^2\\gamma'}{\\gamma_\\text{1d}^3 n^2 } -\\frac{32\\pi^4 \\delta_\\text{c}^2 \\gamma ' |\\omega_0|^2}{\\gamma_\\text{1d}^5 n^4}\\\\ & + \\frac{8\\pi^4\\delta_\\text{c}^2\\gamma'}{\\gamma_\\text{1d}^3 n^3 } \\left(\\tilde{z}-\\frac{1}{2}\\right ) + \\frac{4\\pi^4\\delta_\\text{c}^2\\gamma'}{\\gamma_\\text{1d}^3 n^2 } \\left(\\tilde{z}-\\frac{1}{2}\\right)^2 . \\end{aligned}\\end{aligned}\\ ] ] here , @xmath50 and @xmath51 , were obtained by solving the discrete problem , where a photon is stored in a single discrete atom and then taking the continuum limit such that the index of the atom is replaced by its position inside the ensemble @xmath52 . </S>",
    "<S> the @xmath53 dependent terms are only relevant for determining the gate time and will be ignored for now . by aligning the interferometer , the reflection coefficients of the combined interferometer - ensemble system </S>",
    "<S> are given by @xmath54 and @xmath55  @xcite . </S>",
    "<S> if we take @xmath56 and a detuning @xmath57 , we have @xmath58 , @xmath59 , and @xmath60 . </S>",
    "<S> hence , regardless of the value of @xmath61 we can achieve an ideal cp gate @xmath62 , @xmath63 with sufficiently many atoms .    </S>",
    "<S> _ fidelity . </S>",
    "<S> _ to quantify the errors of the gate , we calculate the choi - jamiolkowski ( cj ) fidelity  @xcite . </S>",
    "<S> the eit storage is described using the storage @xmath64 and retrieval @xmath65 kernels derived in ref .  </S>",
    "<S> @xcite ( suitably modified to take into account storage from both directions  @xcite ) . </S>",
    "<S> when photon  @xmath25 is stored and retrieved without a scattering taking place , its wave function is @xmath66 , where @xmath67 is the wave function of the input photon  @xmath25 . the efficiency of the storage and retrieval is then @xmath68 . </S>",
    "<S> if photon  @xmath28 was reflected from the interferometer , while photon  @xmath25 was stored in the ensemble ( computational basis state @xmath69 ) , the wave function of the retrieved photon  @xmath25 is instead @xmath70 . neglecting bandwidth effects of photon  @xmath28 </S>",
    "<S> , we obtain the cj fidelity @xmath71 where @xmath72 . </S>",
    "<S> if the gate is conditioned on the presence of two photons after the gate operation  @xcite , we find that the success probability is @xmath73 with @xmath74 , and the conditional cj fidelity is @xmath75 .    to optimize the performance of the gate , we set @xmath76 and optimize @xmath42 and the width of the stored spin wave @xmath77 such that @xmath78 is maximal </S>",
    "<S> afterwards , for fixed optimal @xmath42 and @xmath79 we explore the effect of @xmath80 . </S>",
    "<S> as shown below , @xmath81 can be substantially improved by choosing a particular @xmath80 at the cost of increasing @xmath82 by a constant factor . whether this is a desirable trade off , depends on the particular application . in fig .  </S>",
    "<S> [ fig_cphase_fidelity_natoms](a ) we plot the numerically calculated @xmath83 and @xmath81 for the @xmath3-type scheme , where photon  @xmath25 was chosen to have a gaussian temporal profile , and photon  @xmath28 is centered on @xmath84 and assumed to be narrow in frequency compared to the resonance width . as seen in the figure , </S>",
    "<S> both @xmath78 and @xmath81 approach their ideal value of unity for large @xmath12 , but @xmath81 approaches it much faster .    </S>",
    "<S> for large @xmath12 , we can find analytical expressions for the curves in fig .  </S>",
    "<S> [ fig_cphase_fidelity_natoms](a ) </S>",
    "<S> . the stored spin wave will be approximately gaussian so that it has the form @xmath85 </S>",
    "<S> . consequently , @xmath86  @xcite . neglecting distortions of photon @xmath25 under storage and retrieval , but still accounting for errors due to the spatial extent of the stored excitation , we approximate @xmath87 and @xmath88 . here , @xmath89 is a symmetrized version of @xmath90 , which accounts for storage and scattering from both sides of the ensemble due to the sagnac interferometer .    for fixed @xmath21 and large @xmath12 , after choosing @xmath91 , @xmath92 , and @xmath93 , such that @xmath78 is maximal , we get @xmath94 if @xmath95 , @xmath81 is maximal , and we get @xmath96 these expressions confirm that the gate fidelity improves with @xmath12 and that the conditional fidelities have better scaling .    </S>",
    "<S> type scheme . for @xmath76 , @xmath83 and @xmath81 </S>",
    "<S> are shown by dotted green and dash - dotted black curves respectively . </S>",
    "<S> for @xmath80 chosen such that @xmath81 is maximal , @xmath83 and @xmath81 are shown by solid blue and dashed red lines respectively . </S>",
    "<S> ( b ) the same as in ( a ) , but using the dualv instead and interatomic spacing @xmath97 . </S>",
    "<S> the common parameters are @xmath8 , and @xmath98 . under eit ( storage and retrieval ) , @xmath99 . under stationary light ( scattering ) , @xmath15 and @xmath100 for @xmath3type and dualv respectively . ]    in fig .  </S>",
    "<S> [ fig_cphase_fidelity_natoms](b ) we plot the numerically calculated fidelities @xmath78 and @xmath81 for the dualv scheme . in the simulation , </S>",
    "<S> the distance between the atoms was set to be incommensurate with the wavelength of the classical drive @xmath97 . </S>",
    "<S> the results are , however , almost independent of @xmath101 , and the gate can function even with completely random placement of the atoms  @xcite . the dualv scheme is seen to have a very similar behavior to the @xmath3type scheme .    _ gate time . _ </S>",
    "<S> the gate time will be set both by the storage and retrieval time of photon  @xmath25 and the necessity of the scattered photon  @xmath28 to be narrow in frequency . </S>",
    "<S> the eit storage and retrieval time is limited by @xmath102  @xcite and decreases with larger @xmath12 . </S>",
    "<S> we therefore focus on the scattering of photon  @xmath28 .    </S>",
    "<S> due to non - zero bandwidth of photon  @xmath28 , the reflection coefficient @xmath103 ( at @xmath84 ) in eq .   should be replaced by @xmath104  @xcite , where @xmath105 is the frequency distribution of photon  @xmath28 . </S>",
    "<S> since @xmath51 and @xmath50 vary much slower than @xmath106 and @xmath107 around @xmath84 ( vertical dotted line in fig .  </S>",
    "<S> [ fig_r_and_t_plot](a ) ) , we ignore a similar modification to @xmath108 in eq .  .    </S>",
    "<S> we first expand the reflection coefficient @xmath106 around @xmath109 . </S>",
    "<S> we thereby obtain @xmath110 with @xmath111 being the resonance width . defining the spectral width of photon  @xmath28 by @xmath112 , </S>",
    "<S> we get @xmath113 . </S>",
    "<S> we now include the @xmath53 dependent terms in eqs .  and  . for optimal @xmath114 </S>",
    "<S> , we get @xmath115 . requiring the error from finite bandwidth to be proportional to the error in eq .  , we find that the required time is @xmath116 . </S>",
    "<S> hence , the gate time decreases with @xmath12 .    _ </S>",
    "<S> repeater secret key rate . </S>",
    "<S> _ as a direct application of the proposed cp gate , we consider quantum repeaters based on atomic ensembles  @xcite . </S>",
    "<S> we modify one of the fastest known repeater protocols for atomic ensembles  @xcite by implementing the proposed cp gate instead of linear optics for entanglement swapping using the setup in fig .  </S>",
    "<S> [ fig_setup](c ) . the secret key rate per repeater station </S>",
    "<S> is calculated as described in ref .  </S>",
    "<S> @xcite and compared to the results of the original protocol ( see fig .  [ fig_r_and_t_plot](b ) ) . </S>",
    "<S> this analysis is similar to the cp gate in ref .  </S>",
    "<S> @xcite with the difference that we also consider the possibility of generating the initial entanglement using the cp gate . for a fair comparison , we consider equal storage and retrieval efficiencies for both protocols . as seen in fig .  </S>",
    "<S> [ fig_r_and_t_plot](b ) for @xmath13 , the proposed gate allows improving the rate of quantum repeaters if @xmath117 .    </S>",
    "<S> _ conclusion . </S>",
    "<S> _ we have shown , how stationary light can be used to create a cp gate between photons . </S>",
    "<S> most importantly , the gate can exploit a large number of atoms  @xmath12 to compensate for a limited single - atom coupling efficiency to light . </S>",
    "<S> in particular , the gate can have a rapid convergence as @xmath118 towards unit fidelity , if it is operated in a heralded fashion . the gate is ideally suited to be employed in setups currently under development @xcite , where there is a moderate coupling efficiency to light @xmath119 . </S>",
    "<S> the gate can be directly employed to improve the communication rate of quantum repeaters based on atomic ensembles and may in general serve as a tool for photonics based quantum information processing .    </S>",
    "<S> the research leading to these results was funded by the european union seventh framework programme through siqs ( grant no . </S>",
    "<S> 600645 ) and erc grant qios ( grant no . </S>",
    "<S> 306576 ) . </S>",
    "<S> j.b . acknowledges funding from the carlsberg foundation .    </S>",
    "<S> 35ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  </S>",
    "<S> + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1038/nature07127 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.92.127902 [ * * ,   ( ) ] link:\\doibase 10.1038/nphys708 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nphoton.2013.48 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1238169 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature13188 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nature18592 [ * * ,   ( ) ] http://dx.doi.org/10.1038/nphoton.2014.253 [ * * ,   ( ) ] link:\\doibase    10.1038/nature06230 [ * * ,   ( ) ] link:\\doibase    10.1038/nphoton.2009.287 [ * * ,   ( ) ] http://dx.doi.org/10.1038/ncomms4808 [ * * ( ) ] http://dx.doi.org/10.1038/nnano.2015.159 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.82.1041 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.70.063403 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.104.203603 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.109.033603 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.113.263603 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.114.180503 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.102.203902 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.94.043833 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.77.062301 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.85.013822 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.89.143602 [ * * ,   ( ) ] link:\\doibase 10.1038/nature02176 [ * * ,   ( ) ] link:\\doibase    10.1103/physreva.77.063823 [ * * ,   ( ) ] link:\\doibase 10.1038/35106500 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.83.33 [ * * ,   ( ) ] @noop   @noop link:\\doibase    10.1103/physreva.93.040303 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.76.033805 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.52.1394 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.72.032333 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.114.110502 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.92.012307 [ * * ,   ( ) ]    * supplemental material for + `` controlled - phase gate for photons based on stationary light '' *    @subsection @subsubsection </S>"
  ]
}