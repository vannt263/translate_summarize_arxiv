{
  "article_text": [
    "in recent years , several measures of synchronization have been proposed and applied successfully to different types of data . among these studies",
    "we can distinguish two main approaches : 1 ) one based on similarities of trajectories in phase space ( constructed e.g. by time - delay embedding ) @xcite ; 2 ) one that measures phase differences between the signals , where the phases are defined either from a hilbert @xcite or from a wavelet transform @xcite ( as shown in @xcite , these two apparently different phases are indeed closely related ) .",
    "these new methods compete in popularity with standard measures such as the cross - correlation , the coherence function , mutual information , and also with simple visual inspection of the recordings .",
    "cross - correlation and coherence are clearly the measures most used so far .",
    "in contrast to them , all new measures are _ non - linear _ in the sense that they depend also on properties beyond second moments .",
    "in addition , some of them have the advantage of being asymmetric , eventually being able to show driver - response relationships @xcite .    among others ,",
    "synchronization measures have been used for the study of electroencephalogram ( eeg ) signals .",
    "applications include prediction and localization of epileptic activity @xcite , phase - locking between different recording sites upon visual stimulation @xcite , resonance between eeg and muscle activity in parkinson patients @xcite , desynchronization upon lesions in the thalamic reticular nucleus in rats @xcite , synchronization in motoneurons within the spinal cord @xcite , etc .    in the present paper we present a very simple algorithm that can be used for any time series in which we can define _",
    "events_. these can be spikes in single - neuron recordings , epileptiform spikes in eegs , heart beats , stock market crashes , etc . in principle , when dealing with signals of different character , the events could be defined differently in each time series , since their common cause might manifest itself differently in each series .",
    "this _ event synchronization _",
    "( es ) does not require the notion of phase .",
    "it can not distinguish between different forms of @xmath0 lockings @xcite , but it can tell which of the two time series leads the other . and , above all , it is very simple conceptually and easy to implement .",
    "due to that , it can be used on - line and can show rapid changes of synchronization patterns .",
    "given two simultaneously measured discrete univariate time series @xmath1 and @xmath2 , @xmath3 , we first define suitable _ events _ and event times @xmath4 and @xmath5 @xmath6 . in the signals to be analyzed in this paper , these events will be simply local maxima , subject to some further conditions .",
    "if the signals are synchronized , many events will appear more or less simultaneously . essentially , we count the fraction of event pairs matching in time , and we count how often each time series leads in these matches .",
    "similar concepts were used in @xcite .",
    "let us first assume that there is a well defined characteristic event rate in each time series .",
    "counter examples include strong chirps and onsets of epileptic seizures where event rates change rapidly .",
    "such cases will be treated below . allowing a time lag @xmath7 between two ` synchronous ' events ( which should be smaller than half the minimum inter - event distance , to avoid double counting ) ,",
    "let us denote by @xmath8 the number of times an event appears in @xmath9 shortly after it appears in @xmath10 , i.e : @xmath11 with @xmath12 and analogously for @xmath13 .",
    "next , we define the symmetrical and anti - symmetrical combinations@xmath14 which measure the synchronization of the events and their delay behavior , respectively .",
    "they are normalized to @xmath15 and @xmath16 .",
    "we have @xmath17 if and only if the events of the signals are fully synchronized .",
    "in addition , if the events in @xmath9 always precede those in @xmath10 , then @xmath18 .    in cases where we want to avoid a global time scale @xmath19",
    "since event rates change during the recording , we use a local definition @xmath20 for each event pair @xmath21 .",
    "more precisely , we define @xmath22 we then define @xmath23 as in eq.([eq : j ] ) with @xmath19 replaced by @xmath20 , and @xmath24 as in eq.([eq : cxy ] ) with @xmath25 replaced by @xmath23 .",
    "the factor @xmath26 in the definition of @xmath20 avoids double counting if , e.g. , two events in @xmath9 are close to the same event in @xmath10 . of course",
    ", one could also make other choices , e.g. by taking @xmath20 smaller than in eq.([eq : tauij ] ) or by using @xmath27 . as in the definition of events ,",
    "an optimal choice of @xmath19 depends on the problem . in the following",
    "we shall suppress the dependence on @xmath19 , understanding that all formulas apply for both variants .    to obtain time resolved variants of @xmath28 and @xmath29",
    "we simply modify eq.([eq : cxy ] ) to @xmath30 with @xmath31 and @xmath32 the step function ( i.e. @xmath33 for @xmath34 and @xmath35 for @xmath36 ) .",
    "similarly , @xmath37 is obtained by exchanging @xmath9 and @xmath10 .",
    "then , we define the time resolved anti - symmetric combination @xmath38 which can be seen as a random walk that takes one step up every time an event in @xmath9 precedes one in @xmath10 and one step down if vice versa . if an event occurs simultaneously in both signals or if it appears only in one of them , the random walker does not move . exchanging @xmath9 and @xmath10 just reverses the walk . for non - synchronized signals , we expect to obtain a random walk with the typical diffusion behavior .",
    "with delayed synchronization we will have a bias going up ( down ) if @xmath9 precedes ( follows ) @xmath10 .",
    "we should remark that such a bias clearly shows the presence of a time delay of one signal with respect to the other , but does not necessarily prove a driver - response relationship , although it might suggest it .",
    "in fact , internal delay loops of one of the systems can fool the interpretation .",
    "also , the two signals might be driven by a common hidden source and the bias just indicates different delays .",
    "the time course of the strength of es can be obtained from @xmath39 . if an event is found both in @xmath9 and @xmath10 within the window @xmath19 ( resp .",
    "@xmath20 ) , @xmath40 increases one step , otherwise it does not change . of course",
    ", @xmath40 will also not change if there are no new events at all .",
    "the synchronization level at time @xmath41 , averaged over the last @xmath42 time steps , is thus obtained as @xmath43 where @xmath44 and @xmath45 are the numbers of events in the interval @xmath46 $ ] .",
    "similarly , we can also define instantaneous delay asymmetries @xmath47 .",
    "let us now apply these concepts to two sets of intracranial eeg recordings , one from rats and the other from an epileptic patient .",
    "the five pairs of rat eeg signals were obtained from electrodes placed on the left and right frontal cortex of male adult wag / rij rats ( a genetic animal model of human epilepsy ) @xcite .",
    "they were referenced to an electrode placed in the cerebellum , filtered between 1 - 100 hz and digitized at 200 hz . in fig .",
    "[ fig : examples ] we show these signals @xcite . the first pair ( example a in fig .",
    "[ fig : examples ] ) is a normal eeg , all others contain spike discharges ( not to be confused with spikes in single neuron recordings ) which are the landmark of epileptic activity .",
    "they arise from abnormal synchronization in an epileptic brain even when there are no seizures .",
    "a localized appearance of spikes can indeed delimit a zone with abnormal activity ( though this will not necessarily be the epileptic focus ) . furthermore",
    ", time delays between them can identify the electrode closest to the epileptic focus , especially at the onset of seizures .",
    "several measures of synchronization were recently applied to the first three cases of fig .",
    "[ fig : examples ] @xcite . since spike trains lasted usually about 5 seconds , the challenge was to try the different measures in these short epochs .",
    "surprisingly , nearly all the measures gave qualitatively similar results hard to be guessed beforehand .",
    "these examples and two additional cases ( d and e ) , also containing spikes , will be further analyzed in this paper .",
    "for the example a it is difficult , due to its random - like appearance , to visually estimate its level of synchronization and any delay of one electrode with respect to the other .",
    "however , we can already observe some patterns appearing nearly simultaneously in both the left and right channels , thus showing some degree of interdependence .",
    "the spike - wave trains in the other examples in principle suggests a high level of synchronization .",
    "however , as already shown in @xcite , the spikes of example c appear with a varying time lag between right and left channels and are therefore much less synchronized than those in b. this is of course not easily seen by visual inspection of fig .  [",
    "fig : examples ] , but will be clear from the following analysis .",
    "events were defined as local maxima fulfilling the following additional conditions :    1 .",
    "@xmath48 , for @xmath49 2 .",
    "@xmath50    and the same for @xmath10 .",
    "we took @xmath51 and @xmath52 .",
    "other choices gave very similar results .",
    "since the rate of events is more or less constant , we used a fixed @xmath19 .",
    "the choice @xmath53 gave a good discrimination between the five cases .",
    "all results shown below were compared to those obtained with surrogate pairs which were defined by shifting the left channel signals 500 data points ( 2.5 sec ) to the right , with periodic boundary conditions .",
    "our test hypothesis is that without changing the individual properties of each signal , after a large enough shifting synchronization should reach a background ` zero ' level .",
    "the usefulness of such surrogates was discussed in in more detail in @xcite .    .time averaged event synchronization @xmath28 and delay @xmath29 for the five examples of fig .",
    "[ fig : examples ] .",
    "positive values of @xmath29 indicate that events in the left side lags behind the right one .",
    "surrogate values of synchronization were obtained by shifting left channel signals by 500 data points . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     for the five eeg signals of fig .",
    "[ fig : examples ] , we show the values of @xmath54 and @xmath55 in table  [ tab : q ] , both for the original signals and the ` time - shifted ' surrogates . we observe that synchronization levels rank @xmath56 .",
    "this is in agreement with the analysis of examples a , b and c done in @xcite with several other measures of synchronization .",
    "note that even example a is ranked consistently with the other measures , although it does not contain obvious events such as the spikes of the other examples .",
    "all synchronization values are clearly higher than those of their corresponding surrogates ( surrogates constructed with other delay values gave similar results ) .",
    "these surrogate values vary a lot for the different examples .",
    "this stresses the importance of keeping the individual properties of the signals when constructing surrogates .",
    "except for example a , the values of @xmath29 show that the signals from the right hemisphere lag behind the left ones ( @xmath10 ) . a closer visual inspection of fig .",
    "1 at higher resolution shows that this lag is usually 1 data point .",
    "the reason of this systematic lag is unclear ( it could be an artifact of the data acquisition or a real physiological effect ) and it is beyond the scope of this paper .    in fig .",
    "[ fig : qs ] we show the time evolution of synchronization @xmath57 for the five examples , calculated with a window of @xmath58 data points . for most of the time , they are higher than the values calculated from time - shifted surrogates ( the light blue horizontal lines indicate time averages @xmath59 standard deviation ) . in examples",
    "a , b and c we see abrupt changes of synchronization with time which seem statistically significant . in retrospect they can also be seen in fig .",
    "[ fig : examples ] on closer inspection , but they are much less obvious there and could easily be missed .",
    "compared to the first three , examples d and e are more stable in time . finally , the time resolved es shows a better resolution than all synchronization measures considered in @xcite .",
    "figure [ fig : qa ] shows the time resolved asymmetry between the right and the left channels ( upper plot ) and the results from surrogates ( lower plot ) . in all five cases ,",
    "the bias is in agreement with the @xmath29 values shown in table  [ tab : q ] .",
    "the bias in example d is not only the strongest but also the most constant , confirming that d shows the most robust and stationary es ( compare fig .  [ fig : qs ] ) .",
    "for the other examples we see regular changes with time .",
    "this is of course very difficult to see in the original recordings , and it was also not seen with any of the synchronization measures studied in @xcite . as expected , for the surrogates we obtain random walks with small and erratic displacements .      as a second example we analyzed an intracranial eeg recording from an epileptic patient containing 12 min .",
    "of pre - seizure and seizure eeg .",
    "data were recorded from 2 needle shaped depth electrodes with 10 contacts each .",
    "they were symmetrically placed in the left ( contacts tl1 to tl10 ) and right ( contacts tr1 to tr10 ) temporal lobes , in the entorhinal cortex and hippocampal formation .",
    "the eeg was sampled at 173  hz and band pass filtered between 0.53 - 40  hz . for further details on the data we refer to @xcite . as in the previous example , event times were defined as local maxima , but using @xmath60 and @xmath61 ( this large @xmath62 was needed because the data are more noisy than the rat data , and smaller values would have led to many spurious events ) . due to the varying event rate , we used a variable-@xmath19 approach . for the time resolved event synchronization @xmath57 we took a window @xmath63 .",
    "figure [ fig : matrix ] shows the time - averaged event synchronization values between all channels .",
    "a detailed analysis of synchronization patterns for similar recordings has already been described by arnhold et al .",
    "@xcite using a robust measure of non - linear synchronization . here",
    ", we just summarize the main results which are in perfect agreement with those in ref .",
    "we first note that synchronization between left and right electrodes is relatively low and that the right contacts form two clusters : tr1 - 3 and tr4 - 10 .",
    "this is just due to the fact that the first 3 contacts were located in the entorhinal cortex and the remaining ones in the hippocampus @xcite .",
    "moreover , for the right side we observe a gradual decrease of synchronization with increasing distance between contacts .",
    "the synchronization pattern for the left channels is different .",
    "there , the entorhinal cortex / hippocampus separation is overshadowed by the epileptic activity leading to a higher overall synchronization level .",
    "a visual analysis of the seizure onset revealed that contacts tl7 and tl8 showed the first signs of seizure activity .",
    "figure [ fig : tl7 ] shows the time resolved synchronization @xmath57 and delays @xmath64 between tl7 and the remaining left side channels . as expected , synchronization is largest between tl7 and its neighbors tl8 and tl6 .",
    "it is not homogeneous in time and we have several short drops before seizure starts .",
    "moreover , starting at seizure onset and during the whole seizure , synchronization of tl7 with tl8 and tl9 is high , while synchronization with tl6 and all others is decreased .",
    "the lower panel shows that all left channels lag behind channel tl7 .",
    "there is just one exception : during the first part of the seizure , channel tl7 falls back and channel tl8 leads for about half a minute ( indeed , the lead of tl7 is weakened already some 3 minutes before the seizure ) . after this",
    ", tl7 takes up its lead even more vigorously than before .",
    "this might indicate that the source of epileptic activity moves .",
    "whether these features are common to many epileptic seizures and whether they can have clinical significance for e.g. seizure anticipation or focus localization requires further study with a larger database .    in fig .",
    "[ fig : tr7 ] we show the delays of the contralateral channel ( tr7 ) with respect to the other right channels ( upper plot ) and to the left channels ( lower plot ) .",
    "channels tr4 - 6 strongly and steadily follow channel tr7 , which itself follows channels tr8 and tr10",
    ". this might reflect the source of ` normal ' synchronized activity .",
    "a detailed analysis is outside the scope of this paper and will be further addressed elsewhere . as seen from the lower panel ,",
    "synchronization between both hemispheres is weak and @xmath29 shows unbiased random walks .",
    "the complete absence of any deviant behavior during the seizure reflects the fact that the seizure does not spread to the contralateral side .",
    "in conclusion we presented a new approach to measure synchronization and time delays that is based on the relative timings of events ( in this study defined as local maxima ) .",
    "this also gives an easy visualization of time - resolved synchronization and delay patterns .",
    "the method is appealing due to its simplicity , straightforward implementation and speed .",
    "these features make very easy its on - line implementation . in the particular case of eegs ,",
    "the proposed approach is promising for the study of recordings of epileptic patients , where synchronization is important and the analysis of time delay patterns could be useful for the localization of the epileptic focus and the prediction of seizure onset .",
    "also , the method should be well suited for single - neuron recordings , where the fast dynamics of spikes makes difficult the analysis with other measures . in this paper we focussed on application to eeg signals , but the method can be easily applied to other types of data just by adjusting the definition of events .",
    "we are very thankful to ralph andrzejak , alexander kraskov , klaus lehnertz , and heinz schuster for stimulating discussions , to giles van luijtelaar and joyce welting from nici , university of nijmegen , for the rats data used in this paper and to k. lehnertz and c. elger from the department of epileptology , university of bonn , for the intracranial eeg data .",
    "is supported by the deutsche forschungsgemeinschaft , sfb tr3 ."
  ],
  "abstract_text": [
    "<S> we propose a simple method to measure synchronization and time delay patterns between signals . </S>",
    "<S> it is based on the relative timings of events in the time series , defined e.g. as local maxima . </S>",
    "<S> the degree of synchronization is obtained from the number of quasi - simultaneous appearances of events , and the delay is calculated from the precedence of events in one signal with respect to the other . </S>",
    "<S> moreover , we can easily visualize the time evolution of the delay and synchronization level with an excellent resolution .    </S>",
    "<S> we apply the algorithm to short rat eeg signals , some of them containing spikes </S>",
    "<S> . we also apply it to an intracranial human eeg recording containing an epileptic seizure , and we propose that the method might be useful for the detection of foci and for seizure prediction . it can be easily extended to other types of data and it is very simple and fast , thus being suitable for on - line implementations . </S>"
  ]
}