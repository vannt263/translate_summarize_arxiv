{
  "article_text": [
    "density functional theory ( dft ) @xcite has become popular for calculating ground - state properties of large molecules ; it replaces the interacting many - electron problem with an effective single - particle problem that is computationally inexpensive to solve .",
    "based on rigorous theorems@xcite , and a hierarchy of increasingly accurate approximations , dft calculations are common in almost all branches of chemistry .    in principle , all properties , including excitations , are functionals of the ground - state density , but accurate , general - purpose approximations to obtain these excitations have yet to be found .",
    "instead , time - dependent density functional theory ( tddft ) , based on another theorem  @xcite , provides a usefully accurate approach for many applications  @xcite .",
    "in particular , low - lying single excitations are often well - approximated , and of great interest in many applications .",
    "moreover , the computational technology for solving the necessary equations already existed , so tddft was rapidly built into existing codes and has become popular for calculating excitations .",
    "but tddft is mostly used to extract bound - bound transitions , and even then , only low - lying single excitations . in this perspective , we review our work extending tddft to higher excitations , including both rydberg states and the continuum , i.e. , @xmath3 and beyond .    we begin with a review of the theory of the quantum defect and scattering phase shift aimed primarily at our electronic - structure readers .",
    "next , we give some background on ( td)dft and how to obtain the quantum defect and scattering phase shift from a ( td)dft calculation .",
    "we prove that within tddft it is allowed to use the method of obtaining pseudo continuum states from a hard wall cavity , and thus obtain the phase shifts from a `` bound '' state calculation .",
    "we show results for the quantum defect of he and the @xmath2-he@xmath1 scattering phase shift .",
    "the theoretical ingredients needed to understand this work originate from two distinct fields , scattering theory and density functional theory .",
    "while closely related in principle , these areas are almost mutually exclusive in practice .",
    "a reader from either field might skip the familiar material .",
    "the electronic structure of atoms is understood in a rather simple way if one of the electrons is in a highly excited state . in that case",
    "we consider the system as consisting of the excited electron in a local potential , originating from the nucleus and all other ( tightly ) bound electrons .",
    "this local potential is a long - ranged coulomb potential for neutral and positively charged atoms and a shorter ranged potential for negatively charged atoms .",
    "an atom with a highly excited electron in a long - ranged atomic potential is also known as a _",
    "rydberg _ atom .",
    "such atoms are highly studied and an overview of their properties can for example be found in refs .",
    "@xcite , and references therein .",
    "since rydberg atoms can be regarded as one electron in an effective local potential , they are similar to the hydrogen atom .",
    "the difference between rydberg atoms and hydrogen atoms is expressed in terms of the quantum defect , which we introduce in the next section .    the infinite rydberg series merges into the continuum at the ionization limit of the system ; it is this boundary between the finite states and the continuum that we explore in detail in this paper .",
    "if the electron resides in a continuum state instead of a rydberg state , it scatters from the resulting ionic core .",
    "we explain this further in section  [ phase ] .      for any spherical one - electron potential that decays as @xmath4 at large distances , the bound - state transitions form a rydberg series .",
    "the high - energy levels of such a system are given by the rydberg equation , which in atomic units reads , e^i_n = i- , [ e : qd ] where @xmath5 and @xmath6 is the excitation energy to a state of principal quantum number @xmath7 and angular momentum @xmath8 , and @xmath9 is the ionization energy of the system studied .",
    "we use atomic units throughout . the quantum defect , @xmath10 ,",
    "is purely determined by that part of the potential that differs from @xmath4 .    as is shown in eq .",
    "( [ e : qd ] ) , the quantum defect behaves differently for different angular momentum states . for high angular momentum",
    "the quantum defect is generally small , since the shielding effect of the core is mostly maintained .",
    "the existence of a quantum defect requires the atomic potential to decay like @xmath4 , producing a rydberg series , but its value is determined by the interior region of the potential  @xcite .",
    "accurate quantum defects for the he atom from ref .",
    "@xcite ( exact ) and experimental data from nist  @xcite.,width=264 ]    in fig .",
    "[ fig : henistdrake ] we show the exact quantum defects from high level wave function calculations  @xcite , fitted to a smooth function as explained below , and we compare them with the experimental values  @xcite .",
    "we notice that both in the singlet and in the triplet case the quantum defect is a smooth function of energy , so we fit it to the following expansion , [ eq : fit ] ^(p)(e ) = _ i=0^p _ i e^i , e =- i . in fig .",
    "[ fig : henistdrake ] , the fits are given by @xmath11 for singlet and @xmath12 for triplet .",
    "in previous work  @xcite we showed that in ( td)dft this fit works well and we only need two or three coefficients to describe all the data accurately .",
    "the reason for fitting the quantum defect is that it is hard to calculate the higher rydberg states .",
    "if we have a way to fit the lower quantum defects accurately , we instantly have a way to obtain the values of _ all _ higher lying rydberg states , up to the continuum .",
    "the coefficients for the helium atom can be found in the references above and are not repeated in this paper .      helium atom negative energy singlet and triplet s - quantum defects from ref .  @xcite and positive",
    "energy results from ref .",
    "the phase shifts are divided by @xmath13 so they match with the quantum defects at @xmath0 .",
    "the coefficients corresponding to the fits are reported in the text.,width=264 ]    the quantum defect , discussed in the previous section , is not only an important quantity for studying bound rydberg states , but it is also relevant for scattering states . seaton s",
    "theorem  @xcite tells us that the quantum defect is a smooth function of energy as @xmath14 , and it merges continuously with the phase - shift ( relative to pure coulomb scattering ) , @xmath15 we illustrate this in fig .  [ fig : heqdposneg ] for the case of the helium atom . in this figure , and all that follow , we plot @xmath16 instead of the quantum defect itself . in this graph",
    "we also show a continuous fit of the points . since the positive energy part is more curved than the qds alone , we need more coefficients for an accurate fit .",
    "the fits are given by , @xmath17 for the singlet case and @xmath18 for the triplet case . together with these fits",
    "we also show the straight line fit of fig .",
    "[ fig : henistdrake ] .",
    "it is clear that this fit is good for negative and very small energies , but diverges for larger energies .",
    "( [ e : seaton ] ) is only relevant if there is a quantum defect to consider , i.e. if we consider an atom with a long - ranged potential .",
    "such a long - ranged atomic potential can in general be decomposed into a pure coulomb ( @xmath4 ) and a short - ranged part , @xmath19 but to understand its scattering properties , we must first review elementary scattering from a spherical potential .",
    "if a potential is short - ranged , the differential scattering cross section is given by  @xcite @xmath20 the scattering amplitude is written in terms of partial waves , @xmath21 where @xmath22 is a legendre polynomial and the partial amplitude can be expressed in terms of phase shifts : @xmath23 it follows from this equation that if we have the phase shift for all values of @xmath8 we can calculate the differential cross section . in practice the few lowest @xmath8 values will often be dominant and almost completely determine the cross section .",
    "for a long - ranged potential the equations are more complicated . in the case of atoms , we can separate the total potential into a coulomb plus a short range part .",
    "the differential cross section is then given by  @xcite @xmath24 where @xmath25 is the pure coulomb amplitude and @xmath26 is the additional scattering amplitude as a result of the short - range part of the potential .",
    "this is necessary because @xmath25 diverges as @xmath27 , making the cross - section itself divergent .",
    "thus , scattering from a long - ranged potential is qualitatively different from that of a short - ranged potential .",
    "the additional scattering amplitude of eq .",
    "( [ e : scattamp ] ) does not depend on the angle @xmath28 and can again be expanded as eq .",
    "( [ e : fexpand ] ) .",
    "the partial wave amplitudes are given by , @xmath29 where the @xmath30 denote the coulomb phase shifts and the @xmath31 the phase shifts due to the short - ranged part of the potential .",
    "if the short - range potential is small compared to the coulomb potential , the additional amplitude can be calculated using , for example , a distorted wave born approximation  @xcite . in the next section ,",
    "we explain how we obtain accurate phase shifts in practice .",
    "a useful method we recently ( re)discovered  @xcite , and which circumvents the problem of working with continuum states , is to put the system of scattering electron and target in a spherical box . in that way",
    "a finite number of `` continuum '' states is obtained exactly , namely those that have nodes at the radius where we placed the wall , @xmath32 .",
    "assuming one has the liberty to choose any wall radius , _ all _ continuum states can be obtained in this way .",
    "only for very low - energy continuum states does one need large boxes .",
    "just as in the previous section , we distinguish two kinds of potentials , short - ranged potentials that effectively vanish after some finite radius @xmath33 , and long - ranged potentials that do not .",
    "the first kind we studied in ref .",
    "@xcite where we investigated the scattering of an electron by the hydrogen atom .",
    "the @xmath34-electron system , h@xmath35 , is a negative ion with a short - ranged potential .",
    "its phase shift is obtained from knowledge of the spherical bessel functions as a function of the energies and the wall radius , explicitly , @xmath36 where @xmath37 and @xmath38 are the spherical bessel and neumann functions .",
    "the lowest three positive energy orbitals for a spherical well within a box with @xmath39 ( radius 1.2 , well - depth 3 ) .",
    "the dashed curves indicate how the continuum functions continue .",
    "the curves are offset for clarity , each zero being marked by a dashed horizontal line .",
    "color figure online.,width=264 ]    as an example , we show the lowest three of such states for a spherical well in fig .  [",
    "f : spherorbs ] , where the wall is placed at @xmath39 .",
    "the spherical well potential is given by @xmath40 where @xmath41 is the depth of the well , @xmath42 the radius , and @xmath43 the heaviside step function .",
    "the radius @xmath42 of the spherical well is 1.2 bohr and the depth @xmath44 hartree .",
    "it is clear from this graph that the orbitals are the continuum functions , except that they do not continue beyond @xmath39 and that there is only a finite number of them .",
    "in this paper we also study electron scattering from he@xmath1 .",
    "the @xmath34-electron system is the neutral helium atom , which has a long - ranged modified coulomb potential .",
    "we use the fact that this potential can be separated in a pure coulomb potential ( @xmath4 ) and a short - ranged potential , i.e. that vanished at some finite @xmath45 .",
    "all we need to know to obtain the scattering phase shifts are the coulomb functions as a function of energy and wall radius , so eq .  (",
    "[ e : srphase ] ) becomes @xmath46 where @xmath47 and @xmath48 are the regular and irregular coulomb functions .",
    "the only requirement on the location of the wall is that it is outside the short - ranged part of the potential .",
    "we can place the wall relatively close to the atom , even though we are dealing with a long - ranged potential .",
    "same as fig .",
    "[ f : spherorbs ] , but with @xmath4 added to the potential .",
    "color figure online.,width=264 ]    as an example , we show the lowest three of such states for the same spherical well as above , plus a coulomb potential , in fig .  [",
    "f : spherorbs ] .",
    "the total potential is given by , @xmath49 again the wall is placed at @xmath39 .",
    "it is again clear that the functions behave exactly like continuum functions .",
    "we now review briefly both ground - state and time - dependent density functional theory .",
    "we emphasize throughout the distinction between exact dft and the approximations invariably used in practice .",
    "density functional theory is based on the theorem by hohenberg and kohn ( hk )  @xcite .",
    "this theorem states that , for a given non - degenerate ground - state density of fermions , @xmath50 , with a given interaction , the external potential that produces the density is unique ( up to an additive constant ) .",
    "thus , if the density is known , the external potential is also known , completely defining the hamiltonian , i.e. , we can obtain all properties of the system from the density alone .",
    "the hk theorem also holds for degenerate ground - states  @xcite and there exists an analogous theorem that can be applied to spin densities  @xcite .",
    "the power of dft is in the idea of kohn and sham ( ks ) to apply the hk theorem to a system of non - interacting particles .",
    "the hk theorem states that the ks potential , which reproduces the true density of the system , is unique .",
    "ks map the fully interacting problem to a non - interacting one with the same density .",
    "the ks equations are a set of one - particle schrdinger equations , @xmath51 where the @xmath52 are the ks orbitals and @xmath53 the corresponding orbital energies .",
    "the effective ks potential is given by @xmath54 the unknown part in this equation , @xmath55 , is the exchange - correlation ( xc ) potential , that needs to be approximated in practice . when the exact xc - potential is known , the exact interacting density of the system can be obtained from the ks orbitals , @xmath56 where the sum runs over all occupied orbitals .",
    "top panel : extremely accurate radial density for the helium atom found via the qmc method  @xcite .",
    "bottom panel : the external and ks potentials for the helium atom.,width=291 ]    we illustrate the ks idea in fig .  [ f : he_potcompare ] where we show both the exact ks potential of the helium atom  @xcite and the external potential from an accurate wave function calculation .",
    "umrigar and gonze  @xcite obtained the exact ks potential from an extremely accurate quantum monte - carlo calculation for the ground - state of he , calculating the density , and finding the ks potential by inverting the ks equation for the doubly - occupied @xmath57 orbital : @xmath58 where @xmath59 .",
    "the ks potential is quite different from the external potential .",
    "this is because two non - interacting `` electrons '' in the ks potential reproduce the exact electron density of the interacting system , by definition .",
    "for example , because electron - electron repulsion pushes density outward , the ks potential is shallower than the external potential .    the energy of the highest occupied molecular orbital ( homo ) of the exact he ks - potential is @xmath60ev .",
    "this is exactly minus the ionization energy of the helium atom ; an illustration of the exactness of koopman s theorem in dft  @xcite .",
    "this exact relation is a remarkable fact , since the ks system is a fictitious system , but it follows from the exactness of @xmath61 as @xmath62 .",
    "in fact , @xmath63 as @xmath62 , for all spherical systems whose density @xmath61 decays exponentially .",
    "thus , since , @xmath64 then @xmath65 if @xmath66 , as in fig .",
    "[ f : he_potcompare ] , or more rapidly if @xmath67 .    in practice",
    ", @xmath68 is not known exactly .",
    "dft calculations use approximations to @xmath69 $ ] , whose derivative yields an approximation to @xmath55 .",
    "many approximate xc - energy functionals have been developed since the start of dft .",
    "the simplest of these , the local density approximation ( lda ) , gives remarkably good results  @xcite .",
    "it is improved by including the gradient of the density , leading to the generalized gradient approximation ( gga ) .",
    "some popular ggas are blyp ( b88  @xcite for exchange and lyp  @xcite for correlation ) and pbe  @xcite .",
    "hybrid potentials are popular among chemists because of their improved accuracy for main - group thermochemistry and transition - state barriers . these hybrid functionals mix in some fraction of exact exchange with a gga .",
    "the most widely used hybrid , b3lyp , contains 3 experimentally fitted parameters  @xcite , whereas pbe is derived from general principles of quantum mechanics  @xcite .",
    "ks potentials for the helium atom : lda , exchange only ( exx ) , and exact.,width=291 ]    a less well - known feature to users of ground - state dft is that although their favourite approximations often yield very good energies ( and therefore structures , vibrations , thermochemistry , etc . ) and rather good densities , they have badly behaved potentials , at least far from nuclei .",
    "the lda potential , for example , decays much too fast .",
    "we show this in fig .",
    "[ f : he_ldaexact ] for the helium atom .",
    "although the relative energies of low lying states might be accurate , the high lying rydberg states , in which we have particular interest , are poorly reproduced , if bound at all . in the case of the h@xmath70 anion , the lda even fails to bind this system at all .",
    "these errors are called self - interaction , because @xmath71 and @xmath72 for one electron , but not with these approximations . over the past decade",
    ", the technology for treating orbital - dependent functionals , such as the fock integral ( so - called exact exchange ) , has been developed , and such functionals help cure this problem@xcite .",
    "this is called the optimized effective potential method ( oep)@xcite . the oep method can handle any orbital - dependent functional including simple exchange , and then produces an asymptotically correct @xmath73 .      next we give a concise overview of the basics of time - dependent density functional theory ( tddft ) , focussed on obtaining excitation energies . for a more in - depth review",
    ", we refer to ref .",
    "@xcite , and references therein .",
    "ground - state dft does not produce the exact transition energies .",
    "the reason is that the ks orbital energies do not correspond to the true bound - state energies . a popular way to obtain the true transition energies is via time - dependent density - functional theory ( tddft ) .",
    "tddft is an in principle exact method based on the runge - gross theorem  @xcite .",
    "this theorem states that , for time - dependent problems , the time - dependent potential , and consequently all other properties , is a functional of the time - dependent density .",
    "armed with this theorem , time - dependent kohn - sham ( tdks ) equations are defined analogues to eq .",
    "( [ eq : ks ] ) but with @xmath74 on the right .",
    "these equations describe a system of non - interacting electrons that evolve in a time - dependent kohn - sham potential and produce the same time - dependent density as that of the interacting system of interest , thus replacing the interacting problem with a much simpler non - interacting one , as in the ground - state case .",
    "one therefore defines ( and needs to approximate ) a time - dependent xc - potential , @xmath75(\\br , t)$ ] , as that defined by eq .",
    "( [ eq : vs ] ) .",
    "most practical tddft calculations use linear response theory .",
    "within linear response theory , the tddft equations simply reduce to an eigenvalue equation  @xcite , @xmath76 where the @xmath77 are the excitation energies of the system at hand .",
    "the superscript @xmath78 means that we have one set of equations for singlet energies , and one for triplet energies .",
    "the key quantity in this equation is obviously the @xmath79 matrix , diagonalization of which , when spin - resolved for a spin - restricted system , immediately yields the transition frequencies @xmath77 : [ e : omegas ] _ ia , jb^ ( ) & = & _ ab _ ij ( _ a - _ i)^2 + & + & 2 ( k_ia , jb^ k_ia , jb^ ) where the @xmath80 are occupied kohn - sham ( ks ) orbital energies and @xmath81 are unoccupied ks orbital energies , the @xmath82 matrix elements are discussed below , @xmath83 and @xmath84 specify the spin orientation .",
    "the kohn - sham orbital energies correspond to a system of non - interacting electrons , the sum of which , in an exact dft calculation , gives the true density of the system .",
    "the first term of the @xmath85 is the _ ks transition energy_. the second term in both matrices corrects the ks result to give the true interacting result , the singlet and triplet transition energies respectively .",
    "an approximation to solving the above eigenvalue equation is the small matrix approximation ( sma ) , where we only include diagonal elements of the @xmath85-matrix  @xcite .",
    "this leads to a singlet triplet splitting but it does not allow different transitions to mix with each other .",
    "the sma is useful for understanding results , but usually is not applied to obtain the transition energies for practical systems .    the first two transitions for he",
    ". exact ks orbital energy differences , sma singlet - triplet excitation energies and full tddft ( alda ) excitation energies ( both evaluated for the exact ground - state ks potential ) , and the exact values.,width=291 ]    we illustrate how the transition energies evolve from ks to sma to full tddft in fig .  [",
    "f : helevelscompare ] , where we consider the @xmath86 and @xmath87 transitions in the helium atom . from a ground - state ks calculation",
    "we obtain just the ks orbital energy differences , which are somewhere in - between the exact values .",
    "the next step is to use the small matrix approximation ( sma ) , where we see that especially the singlet values still overestimate the exact values .",
    "the final step is to include the full matrix , allowing full mixing of all states .",
    "the full tddft results are close to the exact values , but do not match them , because we used an approximate kernel ( see below ) . of course ,",
    "all this information , and much more , is beautifully condensed into the quantum - defect plots throughout this paper .",
    "for example , the exact results in fig .  [ f : helevelscompare ] are represented by the leftmost points of fig .",
    "[ fig : henistdrake ] .      the @xmath82 matrix elements in eq .",
    "( [ e : omegas ] ) are given by , @xmath88 }   \\ , d{\\bf r}d{\\bf{r ' } } \\nonumber \\\\ + \\int \\!\\ !",
    "\\int \\phi _ { i\\sigma } ( { \\bf r } )",
    "\\phi _ { a\\sigma } ( { \\bf r } ) f_{\\rm{xc}}^{\\sigma \\tau } ( { \\bf r},{\\bf{r'}},\\omega)\\phi _ { b\\tau } ( { \\bf{r ' } } )   \\phi _ { j\\tau } ( { \\bf{r ' } } ) \\ , d{\\bf r}d{\\bf{r'}}.\\end{aligned}\\ ] ] where we used @xmath89 to indicate spins and @xmath90 indicate occupied orbitals and @xmath91 virtual orbitals .",
    "the first term in this equation is the hartree term , which is only dependent on the ground - state ks orbitals . from eq .",
    "( [ e : omegas ] ) we see that this term cancels in the triplet case ( minus combination ) .",
    "the second term contains the _ xc - kernel _",
    ", @xmath92 whose fourier transform is simply @xmath93 .",
    "the xc - kernel is the only part in this expression that needs to be approximated , after the ground - state calculation has been performed . in this paper",
    "we focus on three different kinds of xc - kernels , adiabatic lda ( alda ) , exx , and hybrid , and study how they perform for the bound and continuum states of the helium atom .",
    "all these kernels use the adiabatic approximation , i.e. , ignoring the frequency dependence of the xc - kernel .",
    "the simplest xc - kernel is the adiabatic local density approximation ( alda ) .",
    "the alda xc - kernel is given by [ fxcalda ] & & f_xc(,,t , t ) = + & & ^(3)(- ) ( t - t ) |_n= n_0 ( * , r * ) , where @xmath94 is the xc - density of the uniform electron gas .",
    "the time fourier - transform of this kernel has no frequency - dependence and via a kramers - kronig relation , this implies that it is purely real  @xcite .",
    "even though finite systems like atoms and molecules are far from representing the homogeneous electron gas , the alda is a good approximation in practice .",
    "there are systems , though , where the alda fails completely .",
    "for example the polarizability of long chain molecules is strongly overestimated by the alda  @xcite .",
    "a solution to this problem is to use orbital dependent functionals  @xcite , or to solve the time - dependent _ current _ dft equations with the current dependent vignale - kohn functional  @xcite .    in this paper",
    "we study the helium atom , in the special case of a two - electron system we can make some other simple choices for the xc - kernel . for two - electrons",
    "we can treat exchange exactly , the kernel is simply minus half of the hartree kernel , [ eq : fexx ] f_x^exx=- .",
    "this kernel can be improved by combining with the correlation part of alda .",
    "this results in the so - called hybrid xc - kernel , [ eq : fhyb ] f_xc^hyb=-+f_c^alda , which improves on exx for the helium atom  @xcite .",
    "in this section we treat potentials of finite range in one dimension , i.e. , @xmath95 beyond some @xmath42 .",
    "we restrict ourselves to symmetric potentials ( @xmath96 ) , where the analogy to 3d scattering theory is most plain .",
    "these examples are not meant as models of real atoms or molecules , but simply illustrate the general principles .",
    "we divide the illustrations into two cases , to make as clear as possible the distinct physical principles involved .",
    "we first treat potential scattering , i.e. , a single - particle scattering from a potential , and show how box calculations yield the exact result .",
    "thus @xmath97 , where @xmath98 is the number of particles in the target . in the next section ,",
    "we treat the more complex interacting case , analogous to electron scattering from h , where @xmath99 .      for a symmetric 1d potential ,",
    "parity plays a role analogous to the partial waves in 3d .",
    "thus , there are only two channels , symmetric and antisymmetric .",
    "careful analysis allows definition of two phase shifts@xcite : @xmath100 the + sign corresponds to an even continuum solution and the - sign to an odd solution .",
    "the amplitudes @xmath101 and @xmath45 are defined for scattering boundary conditions , i.e. , the asymptotic wave functions are , @xmath102 the amplitudes @xmath45 and @xmath101 are related to the reflection and transmission coefficients , @xmath103 and @xmath104 , @xmath105 a useful result from this analysis is t = e^i(^++^- ) , [ e : tdelta1 ] where @xmath106 , showing that resonances occur when @xmath107 is an integer .",
    "an example of a short - ranged central potential is the delta well potential , @xmath108 .",
    "the free space example can be easily calculated , and the amplitudes @xmath101 and @xmath45 are given by @xmath109 from this it follows that @xmath110 and we find for the phase shift @xmath111 the odd phase shift @xmath112 .",
    "( this is special to the delta potential , but is not true in general . )",
    "now consider putting the potential inside an infinite well , with walls located at @xmath113 .",
    "since the potential is placed in a box , the states are discrete and there is only a discrete set of allowed values for the eigen - energies @xmath114 , @xmath115 . by comparing wavefunctions beyond the range of the potential ,",
    "one finds the phase shifts corresponding to the even and odd solutions are given by @xmath116 with @xmath117 .",
    "the even solution to the schrdinger equation in a box with boundaries at @xmath113 is @xmath118 with normalization constant @xmath119 the discrete allowed @xmath120 values satisfy @xmath121 ( for the derivation , see for example ref .",
    "@xcite . ) taking the tangent of eqs .",
    "( [ e : evenphase ] ) , we obtain for the phase shift , @xmath122     solid line : even continuum state for a delta function with strength @xmath123 at @xmath124 , corresponding to the first state of positive energy when walls with @xmath125 are imposed .",
    "symbols : bound state for the same potential at the same energy in a box with walls at @xmath126.,width=264 ]    eqs .",
    "( [ e : freephase ] ) and  ( [ e : boxphase ] ) are identical , but eq .  ( [ e : boxphase ] ) can only be evaluated at a finite number of energies @xmath120 . in fig .",
    "[ f : deltaorb ] we show both a continuum scattering state and a box state for the delta well potential at the same energy . from the figure it is clear that they are identical within the box , and",
    "therefore have the same phase shift .",
    "the odd solution is @xmath127 these are simply the particle - in - a - box wave functions ; the delta potential has no effect on the odd states .",
    "the corresponding energies are the particle in a box energies , @xmath128 where @xmath129 .",
    "this corresponds to a phase shift @xmath112 .",
    "it is now instructive to see how this one - electron example should be treated with ( td)dft .",
    "the first step in any linear - response tddft calculation is to find the ks ground - state potential of the @xmath130-electron system .",
    "the ground - state ks potential is given by @xmath131 for one electron ( @xmath132 ) , @xmath133 and @xmath134 , and the ks potential is just the external potential .",
    "the ks orbitals for positive energies are equal to the scattering states we obtained above in the exact case ( with or without the box ) .",
    "next one usually calculates the tddft correction corresponding to the excitation of the electron into one of the positive energy states .",
    "again , for a one - electron system , @xmath135 , and thus @xmath136 . from eqs .",
    "( [ e : omegas ] ) and  ( [ e : kmat ] ) it follows that the true excitation energies are equal to the ks orbital energy differences .",
    "the tddft scattering phase shift is therefore equal to the exact phase shift in this trivial case .",
    "this also tells us the condition needed for any tddft treatment to recover the exact results for this case : both the ground - state potential and the tddft kernel must be self - interaction free for one electron .",
    "the case in the previous section was a trivial one for ( td)dft , but checked that our methodology worked in that limit .",
    "now we study a case that is not trivial .",
    "we consider two fermions , one of which resides in the bound state of the delta potential well and the other scatters from this target .",
    "the two electrons interact through a delta potential repulsion .",
    "we show in this section that , with exact functionals , the tddft results reproduce the exact results .",
    "the hamiltonian of this problem is given by  @xcite @xmath137+\\lambda\\delta(x_1-x_2)\\ ] ] the two electrons interact via a delta - function repulsion potential , scaled by @xmath138 . in ref",
    ".  @xcite the scattering amplitudes for both the exact and ( td)dft case were derived to first - order in @xmath138 .",
    "they found the transmission amplitude for the exact case  @xcite .",
    "for triplet scattering , the bound electron has no effect , and @xmath139 identical to eq .",
    "( [ e : tdelta ] ) .",
    "but the singlet has a correction due to the interaction : @xmath140 our methods should be able to reproduce this leading correction .",
    "real and imaginary parts of the exact ( solid lines ) and ks ( dashed lines ) transmission amplitude for the delta potential well with contact interacting electrons . in this plot @xmath123 and @xmath141.,width=264 ]    to reproduce this result with tddft , first the ground - state ks problem must be solved . the ground - state ks potential of the @xmath130-electron system",
    "is given by @xmath142 to first - order in @xmath138 .",
    "it is possible to solve the corresponding self - consistent schrdinger equation exactly , finding @xmath143\\ ] ] to first order in @xmath138 , the ks potential is therefore @xmath144 transmission through this potential can easily be calculated using the distorted - wave born approximation , which is exact to leading order in @xmath138 , producing the ks transmission amplitude  @xcite , @xmath145 the transmission through the ks potential is exactly midway between singlet and triplet scattering . in fig .",
    "[ f : transmiss_nobox ] , we plot both the exact and ks transmission functions for @xmath123 and @xmath146 to first order in @xmath138 .",
    "the next step in a tddft calculation is to correct the ks transmission for both singlet and triplet scattering , using the hartree - exchange ( hx ) kernel as correlation effects are higher order in @xmath138 .",
    "because we are treating both singlet and triplet scattering , we must use spin - tddft .",
    "this has no effect on the closed shell ground - state , but the exact spin - dependent kernel is , to first order in @xmath138 ,  @xcite @xmath147 where @xmath148 indicates the spin .    using this kernel the following amplitudes are obtained , by applying a distorted - wave born approximation directly to the dyson - like equation relating the true and ks response functions  @xcite : @xmath149 @xmath150 these equations are identical to the exact equations  [ e : tsingexact ] and  [ e : ttripexact ] .",
    "this illustrates that tddft reproduces the exact answer .",
    "we are finally ready to perform the most important test of our methodology .",
    "we use tddft with exact ground - state and time - dependent functionals and with box boundary conditions to reproduce the exact interacting scattering results above .      to begin ,",
    "we need first solve the ground - state ks problem in the box .",
    "now , the ks potential , eq .",
    "( [ e : scattkspot ] ) , is not zero beyond some radius @xmath103 , but extends out to @xmath151 .",
    "but since it is exponentially decaying , we can choose @xmath152 , and have only exponentially small corrections to the free results .",
    "then the ks potential inside the box is simply given by eq .",
    "( [ e : scattkspot ] ) . for the even states",
    ", we can use the eigenstates eq .",
    "[ e : phibox ] to zero - order in @xmath138 , and then apply first - order perturbation theory .",
    "the zeroth - order eigenstates simplify to , @xmath153 i.e. , the normalization constant of eq .",
    "[ e : abox ] simplifies , by using the allowed values of @xmath154 and the condition @xmath155 .",
    "note there is no assumption concerning the relation between @xmath154 and @xmath156 .",
    "we next treat the interaction potential as a perturbation .",
    "the energies of the scattering states in the box can be expressed as , @xmath157 where @xmath158 are the energies of the delta potential well without interaction .",
    "the perturbed energy is given by @xmath159 an elementary integration yields : _",
    "n = for either odd or even states , using eq .",
    "( [ e : abox ] ) and @xmath155 .",
    "now , since @xmath160 , @xmath161 finally , inserting these into eqs .",
    "( [ e : evenphase ] ) for the corrections to the phase shifts , and then calculating the corresponding transmission amplitude from eq .",
    "( [ e : tdelta1 ] ) , we obtain for the ks transmission amplitude for two contact interacting electrons in a delta well potential , @xmath162 agreeing with the exact result , eq .",
    "( [ e : dwbats ] ) .       real and imaginary parts of the ks transmission amplitude and of the interacting singlet and triplet amplitudes for the delta potential well with contact interacting electrons . in this plot @xmath123 and @xmath141",
    "for the results from the box ( symbols ) we used @xmath163.,width=264 ]    last , we need to show that the tddft corrections for the box yield the exact results .",
    "we start from the @xmath164-matrix of eqs .",
    "( [ e : omegas ] ) and  ( [ e : kmat ] ) .",
    "we first make the small matrix approximation ( sma ) that assumes that only diagonal elements of this matrix contribute to the excitation energies .",
    "for the singlet excitations , we can then write the @xmath164-matrix in short - hand notation , ^+_q = _ q + q",
    "| f| q , where @xmath165 indicating that we only consider transitions from the ground - state . writing @xmath166 , where @xmath9 is the ionization potential , we find : _",
    "n = 2q | f| q , where & = & 2z_0^l/2e^-2z|x||_n(x)|^2dx , i.e. , the same as @xmath167 from eq .",
    "( [ e : kspertener ] ) .",
    "we then immediately obtain for the transmission coefficient , t_sing= t^0(1- ) .",
    "the same as in the continuum case eq .",
    "( [ e : tddftconts ] ) . in the triplet case @xmath168 and the equations we obtain are identical to the continuum case ,",
    "i.e. @xmath169 .    thus exact tddft in the box precisely reproduces both the tddft results without the box , and the exact results from wavefunction theory , as shown in fig .",
    "[ f : transmiss ] .",
    "here we describe the details of the numerical calculations for real atoms and ions .",
    "we obtain the positive ks orbital energies ( necessary to evaluate the phase shift in eq .",
    "( [ e : lrphase ] ) ) from a well - established fully numerical spherical dft code  @xcite .",
    "this code includes many approximate xc - potentials , including the standard lda and ggas , and also the optimized effective potential method ( oep ) for exact exchange calculations .",
    "the program does not use a basis set like most quantum chemistry codes , but instead works with a radial logarithmic grid .",
    "both the ks orbital energies and the potentials are optimized in a self - consistent way .",
    "the code is supplemented by the option to insert a hard - wall at a distance @xmath170 from the origin .",
    "we always use a large number of grid points , @xmath171 , to ensure convergence with the number of grid points .",
    "the tddft excitation energies are calculated with our own code that solves the radial tddft equations .",
    "since we are dealing with small systems , we can exactly diagonalize the @xmath172-matrix of eq .",
    "( [ e : omegas ] ) without regard to computational cost .",
    "the tddft code reads in the grid points , ground - state orbitals , and ground - state orbital energies from the dft calculation . the number of states included in the @xmath172-matrix are always chosen large enough for the transition energies to have reached convergence .",
    "since we want to asses the performance of tddft kernels , we use a highly accurate ground - state xc - potential for the helium atom , obtained from very accurate wave functions , by umrigar _",
    "_  @xcite .",
    "we regard this as the essentially exact xc - potential .",
    "this potential is spline - fitted onto the grid points and imported into the code .",
    "in this section we show our results for e - he@xmath1 and e - h scattering . in case of he",
    "we also study the quantum defect .",
    "we study in detail the effect of different xc - potentials and xc - kernels .",
    "we also study the effect of the location of the potential wall .",
    "s - wave phase shift for the he atom .",
    "accurate data from refs .",
    "all data below the ks result corresponds to singlet values , all data above to triplet values . for @xmath173 , we plot @xmath13 times the qd , so it merges smoothly with the phase shift.,width=264 ]    in fig .",
    "[ f : heksref ] we show highly accurate s - qd values ( multiplied by @xmath13 in this and all following figures ) , @xmath174 , and s - wave phase shifts , @xmath175 obtained from the literature  @xcite .",
    "we note , for our dft readers , how smooth these curves are , demonstrating the continuity of eigenstates through @xmath0 .",
    "all eigenenergies of the infinite rydberg series can therefore be captured by a single smooth curve , as was already indicated in eq .",
    "( [ eq : fit ] ) .",
    "the fit coefficients corresponding to the continuous curves in this and all following figures are available as supplementary material . comparing our ks results to the literature data",
    ", we see that the ks qd and phase shifts are in - between the accurate wave function results .",
    "the ks results also mimic the correct shape of the accurate curves .",
    "we note for our non - dft readers how much information is contained in the exact ground - state ks potential of the @xmath34-electron system ( in this case he ) .",
    "all we need tddft to do is to shift the curve down in case of the singlet and upward in case of the triplet .",
    "thus , an important message of this review for non - dft readers is just how good a starting point the accurate ks potential is .      to see how , and",
    "if , tddft corrects the ks results , we study the effect of the @xmath176 kernel that appears in eq .",
    "( [ e : kmat ] ) by using a sequence of approximations that include more and more physics . while there is as yet no explicit reverse - calculation for the exact kernel , we know that , if we had that exact kernel , it would reproduce the reference curves of fig .",
    "[ f : heksref ]",
    ".     error of calculated singlet s - wave phase shifts with respect to the reference data from refs .  @xcite . for @xmath173 , we plot @xmath13 times the qd error , so it merges smoothly with the phase shift error .",
    "color figure online.,width=264 ]     same as fig .",
    "[ f : errorsskernels ] , but for triplet .",
    "color figure online.,width=264 ]    in figs .",
    "[ f : errorsskernels ] and  [ f : errorstkernels ] we show the difference of the tddft results with the exact results for the s - wave quantum defect and phase shift of singlet and triplet respectively .",
    "the difference is calculated by fitting the results to a polynomial of order 2 or higher , and subtracting the exact values from the tddft values for the quantum defect and phase shift . in case of the quantum defect",
    "we indicate with circles the locations of the finite rydberg states .",
    "we note again that for fitting just the qd , i.e. obtaining the @xmath10 coefficients , a polynomial of order 2 is enough , while we generally need a higher order polynomial to fit the qd and phase shifts together .",
    "we now analyze our results in much detail .",
    "the first step in our analysis is to set the xc - kernel to zero . in case of the triplet ,",
    "( [ e : kmat ] ) tells us that we are left with just the ks orbital energy differences , i.e. there is no correction . for the singlet excitations",
    "there is a correction .",
    "the approximation of setting the xc - kernel to zero is called the hartree approximation and is also known as the random phase approximation ( rpa ) in physics and does not involve any tddft . fig .  [",
    "f : errorsskernels ] shows that the coulomb kernel corrects the ks result in the right direction , but overcorrects by about as much as the original error .",
    "we observe that even without an xc - kernel this methodology splits the bare ks results into separate singlet and triplet curves .",
    "the next step is to include exchange , which usually dominates over correlation .",
    "since we are considering a two - electron system , the exact exchange kernel ( exx ) is also known ; it is given by eq .",
    "( [ eq : fexx ] ) .",
    "we see in figs  [ f : errorsskernels ] and  [ f : errorstkernels ] that the hartree results are considerably corrected by inclusion of the exchange kernels . in the triplet case",
    "the exx correction is in the right direction , but it overcorrects .",
    "correlation is included by considering the full alda kernel .",
    "the alda kernel performs slightly worse than the exx kernel in case of the singlet results . in case of",
    "the triplet results the alda performs better than exx , especially at lower energies .",
    "the size of the error in the singlet and triplet full alda curves compared to the reference data is very similar .    for completeness",
    "we also show aldax results , which includes only the exchange part of the alda kernel . in the singlet case ,",
    "the full alda results merge with aldax for higher energies , the full alda improving on aldax for lower energies . in the triplet case",
    "the aldax results are better than full alda for all energies .",
    "the good results of the exx kernel and the correlation correction of alda , suggests to combine the two .",
    "this leads to the hybrid kernel  @xcite of eq .",
    "( [ eq : fhyb ] ) . in the singlet case",
    "the hybrid kernel clearly improves the exx and alda kernels over the entire energy range .",
    "one of the conclusions of ref .",
    "@xcite was that the hybrid kernel improves the ( bound - bound ) excitation energies of he in almost all cases . on the continuum side , we see that the hybrid kernel performs the best of all these kernels in case of the singlet , and for the triplet it improves on exx , but only improves the alda for large energies .",
    "another conclusion of ref .",
    "@xcite is that the hybrid kernel improves the bound - bound triplet @xmath177 excitation energies of he .",
    "our finding that the alda performs better instead is most probably because the tddft calculation of ref .",
    "@xcite only includes the lowest 34 unoccupied states of @xmath177 and @xmath178 symmetry in the calculation of the @xmath164-matrix , whereas we included over 350 states including the continuum in all cases , notably improving the numerical accuracy of the tddft results .      until now we have always used the exact ground - state potential for our calculations .",
    "it is interesting to study the influence of the ground - state potential on the tddft results as , in practice , only approximate potentials are available .",
    "there is a wealth of such potentials and we can not cover all of them in this paper .    for illustrative purposes we therefore limit ourselves to two potentials : the most simple potential of all , the local density approximation ( lda ) , and the orbital - dependent exact exchange potential implemented within the optimized effective potential scheme ( oep ) .",
    "we expect little qualitative change moving from lda to gga , or adding gga correlation to exx .",
    "we showed these potentials together with the exact potential in fig .",
    "[ f : he_ldaexact ] . from the figure we see that the lda is very different from the exact potential .",
    "the potential is too narrow in the interior region , resulting in a bound state of too high energy , and it is short - ranged , completely missing the @xmath4 tail . but the shape of the lda in the interior region is typically very good .",
    "it is almost equal to the exact potential , shifted upward by a constant , therefore occupied lda orbitals yield a remarkably accurate density , except in the tail region .",
    "this feature can be used to extract a highly accurate qd from the lda potential  @xcite .",
    "on the other hand , the exx potential is almost indistinguishable from the exact potential ; it is very similar in the interior region and has the correct asymptotic behavior .",
    "the exact potential is slightly deeper than the oep potential near the nucleus ( see the inset in fig .  [",
    "f : he_ldaexact ] ) .",
    "we expect the results from the oep potential to be very close to the exact results .     the error in the s - wave phase shifts obtained from the exx potential , relative to those from the exact ks potential .",
    "color figure online.,width=264 ]    we show the error in the phase shift obtained using the exx ground - state potential in fig .",
    "[ f : erroroepexact ] ( using the alda kernel ) .",
    "the lda results diverge completely and there is no quantum defect because of the missing rydberg series , therefore we do not show these results in the figure .",
    "the exx results are shifted a little bit upwards compared to the exact results , but this error is an order of magnitude smaller than those due to approximate kernels .    we conclude that using exx potentials is clearly sufficient for these calculations . on the other hand , the lda results diverge .",
    "thus , without the special handling of ref .",
    "@xcite , standard approximations ( lda , ggas , hybrids ) are useless here .",
    "exact ks ( middle ) and tddft - corrected ( alda ) results as a function of the wall radius .",
    "the singlet is above , and the triplet below , the ks curve .. ,width=264 ]    in this section , we demonstrate our claim that the infinite wall can be placed quite close to the atom , as long as the part of the potential that differs from @xmath4 is essentially zero beyond the wall ( eq .  ( [ eq : coulsr ] ) ) . in fig .  [ f : hewalls ] , we show the singlet and triplet @xmath177-wave phase shifts for wall distances between 5 and 8 bohr , and compare the results with @xmath179 a.u .",
    "the smallest distance is determined by the requirement that the box does not significantly distort the self - consistent potential in the region of significant density , i.e. , occupied orbitals must be unaffected .",
    "the results for the small wall distances indeed correspond to the correct phase shifts . by varying the wall distance at small",
    "@xmath180 we can fill out the complete curve , giving an alternative to performing a single calculation with a very large @xmath170 .",
    "this is an important conclusion if one wants to use finite basis - set methods instead of a grid based code  @xcite , because the range of finite basis - sets , even if they include very diffuse functions , is limited to much shorter radii .",
    "same as fig .",
    "[ f : errorsskernels ] , for @xmath178-wave .",
    "color figure online.,width=264 ]     same as fig .",
    "[ f : errorstkernels ] , for @xmath178-wave .",
    "color figure online , width=264 ]    until now we focussed on @xmath177-wave scattering and @xmath177-qds . of course we can also study higher @xmath8-values , using the @xmath8-dependent eq .",
    "( [ e : lrphase ] ) for the phase shift .",
    "we show the difference between our @xmath178-qd and phase shift ( i.e. @xmath181 ) and the reference values for he in figs .",
    "[ f : errorpskernels ] and  [ f : errorptkernels ] . in ref .",
    "@xcite , we also showed results for @xmath182-wave scattering .",
    "adding xc - kernels notably improves the hartree results just as in case of the @xmath177-qd and @xmath177-wave phase shift . for negative and low energies",
    ", the hybrid performs the best of the three kernels , but for larger energies alda performs better , being very close to the reference results .",
    "the bare exx kernel does not perform as well in this case , unlike for @xmath177-wave phase shifts .",
    "thus alda is better overall , and can easily be applied to any system tractable with ground - state dft .",
    "s - qd and s - wave phase shift for hartree and alda compared to accurate data  @xcite .",
    "the bottom three curves correspond to singlet , the top three to triplet.,width=264 ]    when we scatter from a positive ion like he@xmath1 as we did throughout this paper , the @xmath34-electron system is a neutral atom with a long - ranged ks potential . in ref .",
    "@xcite we studied another two - electron system , namely electron scattering from the hydrogen atom . in this case",
    "the @xmath34-electron system , h@xmath183 , is a negative ion with a short - ranged ks potential . because of this",
    ", there is no rydberg series or qd and only one bound state .",
    "we now calculate the phase shift using eq .",
    "( [ e : srphase ] ) , i.e. relative to free potentials .",
    "we show our results in fig .",
    "[ f : eh ] .",
    "we see that , just as for @xmath2-he@xmath184 scattering , the ks result , which is equal to triplet hartree , lies in between both the accurate singlet and triplet values .",
    "alda corrects this and the alda results are again very close to the reference data .",
    "so tddft works well for electron scattering from both cations and neutral atoms . for more details on this particular system",
    "we refer to ref .",
    "electron scattering from h ( as shown in fig .",
    "[ f : eh ] ) and electron scattering from he@xmath1 ( as outlined in this paper ) are two - electron systems .",
    "but our tddft methods can also be applied to elastic electron - scattering for systems with more than two electrons .",
    "results for electron scattering from li can be found in ref .",
    "the @xmath34-electron system is li@xmath35 and has a short - ranged potential .",
    "the singlet tddft p - wave phase shift in this system suffers from an artifact that appears very close to zero energy ( energies smaller than 1 ev ) .",
    "but for higher energies the tddft values correspond very well to the available reference data , as do the triplet p - wave and s - wave phase shifts .",
    "a many - electron system with a long - ranged potential is be , corresponding to electron scattering from be@xmath1 .",
    "scattering phase shifts of @xmath2-be@xmath1 can be found in ref .",
    "@xcite . in this system",
    "there are a number of low - energy resonances of double excitation character , not captured by our tddft method .",
    "such effects require going beyond the adiabatic approximation of tddft and using a frequency dependent kernel  @xcite .",
    "but apart from missing these resonances tddft again performs well  @xcite .",
    "so in general this method is expected to work well for low - energy electron - atom scattering problems , without resonances due to multiple excitations , where the @xmath130-electron system is bound .",
    "we have not yet addressed the complications of non - spherical systems or of open - shells .",
    "another point we have not addressed are the oscillator strengths that correspond to the tddft excitation energies and how they behave when moving across the continuum .",
    "this situation is studied in ref .",
    "it is found that the ks oscillator strength corresponding to the ionization energy ( exactly given by minus the energy of the ks homo ) does not correspond to the exact oscillator strength .",
    "but the exact and ks oscillator strengths do merge at higher energies and several results for 2-electron systems are given in the reference .    in this paper we reviewed our theory and calculations for obtaining both the quantum defect and electron - atom scattering phase shifts using tddft .",
    "we have shown that our method of putting the system in a finite hard wall cavity in order to extract the continuum states and phase shifts works within tddft . in our previous work",
    "we showed that the method works well for the short - ranged potential system @xmath2-h@xmath35 . in this paper",
    "we first illustrated our box method on a ( relatively ) simple toy problem , in which the answer was known exactly .",
    "next , we showed that the method works equally well for the long - ranged helium atom and @xmath2-he@xmath1 scattering .",
    "we also showed that the tddft quantum defect and phase shifts transition smoothly across the zero energy boundary , in accordance with seaton s theorem .",
    "mvf acknowledges the netherlands organization for scientific research ( nwo ) for support through a veni grant .",
    "kb thanks nsf for grant no .",
    "che-0809859 and doe de - fg02 - 08er46496 .",
    "we thank neepa maitra for many useful discussions .",
    "we also acknowledge the exact h@xmath185 and he ks potentials from cyrus umrigar ."
  ],
  "abstract_text": [
    "<S> we review the theoretical background for obtaining both quantum defects and scattering phase shifts from time - dependent density functional theory . </S>",
    "<S> the quantum defect on the negative energy side of the spectrum and the phase shift on the positive energy side merge continuously at @xmath0 , allowing both to be found by the same method . </S>",
    "<S> we illustrate with simple one - dimensional examples : the spherical well and the delta well potential . as an example of a real system </S>",
    "<S> , we study in detail elastic electron scattering from the he@xmath1 ion . </S>",
    "<S> we show how the results are influenced by different approximations to the unknown components in ( time - dependent ) density functional theory : the ground state exchange - correlation potential and time - dependent kernel . </S>",
    "<S> we also revisit our previously obtained results for @xmath2-h scattering . </S>",
    "<S> our results are remarkably accurate in many cases , but fail qualitatively in others . </S>"
  ]
}