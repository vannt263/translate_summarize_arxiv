{
  "article_text": [
    "stochastic simulation of physical variables such as minimum or maximum temperature , precipitation amount and solar radiation are often required as inputs to physical models over varying types of topography . over plains regions ,",
    "agricultural and crop models require daily minimum and maximum temperature simulations at locations that typically do not have direct observations . in mountainous regions ,",
    "hydrological models require stochastic weather realizations for runoff , snowmelt and watershed modeling , as well as water resource planning and climate impact assessment [ @xcite , @xcite ] .",
    "stochastic weather generators ( swgs ) are one approach to producing simulations of daily weather ; they are simply probability models whose simulations are statistically similar to observations [ @xcite ] .",
    "swgs can loosely be categorized into model - based [ e.g. , @xcite , @xcite ] and empirical approaches [ e.g. , @xcite , @xcite ] .",
    "often these weather generators produce simulations only at locations with observational data , but modern physical models require gridded daily weather .",
    "hence , recent research has been directed toward generating spatially consistent swgs that are available at and between observation locations [ @xcite , @xcite ] .",
    "herein we focus on a model - based approach to minimum and maximum temperature simulation over a mix of complex terrain and relatively homogeneous terrain simultaneously .",
    "spatially consistent simulation over most agricultural regions can be accommodated using isotropic or stationary models that are appropriate for regions with relatively constant or slowly changing topography .",
    "domains with highly variable terrain , in particular , mountainous domains , are challenging for the majority of univariate spatial models due to substantial nonstationarity of physical processes in these areas .",
    "weather over complex terrain is highly variable due to topography ; for example , at high elevations in the northern hemisphere , north facing slopes tend to be cooler than lower elevations and south facing slopes and valleys can create their own micro - climate relative to the surrounding high elevation .",
    "these conspire to produce intricate spatial variability that is hard for models to capture .",
    "a typical approach is to partition the space into homogeneous regions and model each region separately .",
    "while a number of statistical nonstationary spatial models have been proposed for univariate fields [ @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ] , fewer are available for multivariate spatial simulation , which is of key concern for simultaneous minimum and maximum temperature simulation [ @xcite , @xcite , @xcite , @xcite ] .        some literature in geography and the atmospheric sciences",
    "is concerned with deterministic interpolation of observed weather variables , often over domains with complex terrain [ @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ] .",
    "the common theme among these approaches is the inclusion of high resolution digital elevation maps as well as other physical information such as slope and aspect to deterministically interpolate meteorological variables . while most of these models are sophisticated physical interpolation schemes , they [ apart from @xcite ] are chiefly concerned with monthly or annual average quantities , and do not produce stochastic realizations of daily weather , which is our primary interest .",
    "these schemes are also typically ad hoc , and are not based on a formal statistical model .",
    "stochastic interpolation and simulation of physical variables has persistent interest in the statistics literature .",
    "often , precipitation holds the primary interest , as its mixed discrete - continuous and skewed nature pose substantial challenges [ @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ] .",
    "however , recent authors have acknowledged the difficulties of temperature modeling in complex terrain [ @xcite ] , and @xcite is one of few to simultaneously model temperature and precipitation .",
    "the study domain in this paper is the state of colorado .",
    "figure  [ fignetwork ] illustrates the challenging terrain of colorado , with eastern plains dipping to a minimum elevation of approximately 1000  m and the rocky mountains of central colorado peaking out at above 4000  m. the front range , the ridge separating the rocky mountains from the eastern plains ( running north - south on approximately the @xmath0 longitude line ) , is especially difficult to accommodate using the currently available multivariate covariance models , most of which are isotropic models , and do not allow for sudden boundaries or even gradually evolving spatial structures across a domain .",
    "the 145 locations shown in figure  [ fignetwork ] are a subset of stations from the global historical climatology network database [ ghcnd ; @xcite ] .",
    "daily observations of minimum and maximum temperatures are available between a time period of at most 1893 through 2011 . associated with each observation",
    "is a quality flag provided by the ghcnd ; we removed all flagged observations to avoid poor quality observations .    in this paper",
    "we propose a framework for bivariate stochastic temperature simulation that splits the model into two components .",
    "the first component represents local climate , allowing the average behavior of minimum and maximum temperature to vary with location , which is of critical concern in regions such as colorado with the average behavior of temperature in the rocky mountains being vastly different than that over the eastern plains .",
    "the second component can be interpreted as daily weather , yielding local variability in space and time , and preserving the spatial correlation between both processes .",
    "consider the bivariate process of minimum temperature , @xmath1 , and maximum temperature , @xmath2 , at location @xmath3 on day @xmath4 .",
    "our model for the bivariate process is @xmath5 the vector of coefficients @xmath6 , for @xmath7 , may be of different length for minimum and maximum temperatures , allowing for distinct sets of covariates , although for notational simplicity we assume both processes share the same number of covariates , @xmath8 .",
    "the covariates @xmath9 typically involve autoregressive and seasonality terms and , if available , can contain additional information such as regional climate model output .",
    "it is convenient to view the models of ( [ eqnmodel ] ) and ( [ eqxmodel ] ) as a sum of `` local climate '' plus `` weather . ''",
    "the local climate is dependent on spatially and temporally varying covariates , and whose coefficients vary across the domain , allowing for the relative influence of each covariate to depend on location .",
    "the weather terms , @xmath10 and @xmath11 , capture small scale variability and correlate the bivariate temperature process across space .",
    "the coefficients @xmath12 , for @xmath7 and @xmath13 , allow the average behavior of temperature to vary with location .",
    "this is crucially important in areas of complex terrain or over large domains where variable orography and general circulation patterns give rise to varying climate [ @xcite , @xcite , @xcite ] .",
    "@xcite point out that climate change trends in colorado are highly dependent on the terrain .",
    "direct estimates of these coefficients are usually only available at locations within the observation network , so we model the coefficients as spatial gaussian processes . in particular , we suppose @xmath12 has mean @xmath14 and matrn covariance augmented with a nugget effect , with variance parameter @xmath15 , range @xmath16 , smoothness @xmath17 and nugget effect @xmath18 [ @xcite ] .",
    "the goal of a spatial model for the coefficients @xmath12 is for interpolation from the observational network locations to a chosen grid .",
    "the matrn is an isotropic covariance function that is especially useful for kriging [ @xcite ] .",
    "one might consider using a nonstationary function for the coefficient covariance model , but in our experience ( see the example section below ) , the simpler stationary model works well for local climate interpolation .    for colorado",
    ", we use the following covariates : @xmath19 with the corresponding case for @xmath20 reversing indices @xmath21 and @xmath22 .",
    "the harmonics allow for seasonality in minimum and maximum temperatures , and we include bivariate autoregressive terms to account for temporal persistence of temperature .",
    "the final covariate , @xmath23 , is a linear drift of length @xmath24 between @xmath25 and 1 ( for numerical stability ) , which we include to control for temperature trends over the 119 year period of our data set , noting that these trends do not necessarily reflect global warming .",
    "these covariates were selected using a bic criterion at all individual stations ; that is , fitting a model to each location independently , the model with all of the above covariates had the smallest bic value for all stations within the ghcnd in colorado , as compared to any subset of the selected covariates .",
    "we considered models with higher order harmonics and autoregressive lags , but the results were nearly identical to those presented below , hence , we favor the simpler set of covariates .",
    "suppose we observe the bivariate process @xmath26 at locations @xmath27 and time points @xmath28 .",
    "at each location within the observation network , we estimate local parameters @xmath29 by ordinary least squares .",
    "these estimates have low uncertainty ; in the colorado network , the location with the sparsest observational record still has more than 10,000 available observations .",
    "conditional on the estimates @xmath29 , we estimate the spatial gaussian process parameters @xmath30 and @xmath18 by maximum likelihood , exploiting the gaussian process assumption .",
    "these spatially varying coefficients models [ @xcite ] have been used for probabilistic forecasting , with a similar two - step estimation procedure [ @xcite , @xcite ] .    at an arbitrary location @xmath31 , not necessarily within the observation network , we spatially interpolate the estimates @xmath32 via kriging [ @xcite ] . in particular ,",
    "the kriging estimator is @xmath33 and the interpolation variance is @xmath34 where @xmath35 is a vector of 1s of length @xmath36 , @xmath37 and @xmath38 for @xmath39 .",
    "as kriging is an exact interpolator , when @xmath40 for any @xmath41 , the interpolator returns the ordinary least squares estimate @xmath42 .    in the next section we exploit a nonparametric estimator of the covariance function for the bivariate weather process .",
    "key to the nonparametric estimator being consistent is a large number of realizations of the process [ @xcite ] which we have available for the residual weather processes , whereas the coefficient processes of the local climate component have only one realization .",
    "hence , we favor the parametric model with a two - step estimation procedure for local climate .",
    "to simulate spatially correlated fields of minimum and maximum temperatures consistent with observed spatial patterns , we require a bivariate spatial model for @xmath10 and @xmath11 . in particular , we model these weather processes as a zero - mean bivariate spatial gaussian process indexed by day of the year . for locations @xmath43 , and arbitrary time point @xmath44",
    ", the bivariate covariance model is @xmath45 } , \\label{eqwcov } \\\\ & { \\operatorname{cov}}\\bigl(w_i(\\mathbf{x},t),w_j({\\mathbf{y}},t)\\bigr ) = c_{ij}\\bigl(\\mathbf{x},{\\mathbf{y}},d(t)\\bigr)\\qquad \\mbox{for } i\\not = j\\label{eqwcross}\\end{aligned}\\ ] ] for @xmath46 , where @xmath47 is just the calendar day of the year on which time point @xmath44 falls .",
    "the covariance model of ( [ eqwtime ] ) , ( [ eqwcov ] ) and ( [ eqwcross ] ) implies some important assumptions .",
    "first , we assume temporal dependence has been accounted for in the local mean function ( e.g. , via autoregressive terms ) so that the weather process is temporally independent , hence ( [ eqwtime ] ) . indeed",
    ", exploratory plots such as autocorrelation functions and empirical covariance functions indicate the bivariate autoregression of ( [ eqcovariates ] ) is sufficient to account for the temporal persistence of temperature in colorado ; see the example section below .",
    "second , the covariance and cross - covariance functions @xmath48 and @xmath49 depend on the day of year , allowing the bivariate process to have seasonally dependent second - order structure .    in ( [ eqwcov ] ) , @xmath50 is a local nugget effect , accounting for small scale variability as well as measurement error . in the geostatistical literature , @xmath51 is often termed the marginal variance , while @xmath52 is called the sill , that is , the total variance at a given location [ @xcite ] . unlike most geostatistical models [ @xcite being a notable departure ] , we allow the nugget effect to vary with location , as we expect the small scale variability to be highly dependent on orography .    at any fixed time point @xmath44",
    "[ i.e. , calendar day @xmath53 , we require the matrix - valued covariance function @xmath54 to be a nonnegative definite matrix function . specifically , at arbitrary locations @xmath55 , the covariance matrix of the random vector @xmath56 which is made up of blocks @xmath57 , must be nonnegative definite .    over regions with complex terrain , temperature observations can exhibit substantial nonstationarity [ @xcite ] . while some multivariate spatial models that can account for nonstationarity are available [ e.g. , @xcite , @xcite ] , these are parametric models with locally varying parameter functions that are difficult to estimate .",
    "we aim to exploit the large number of replications and reasonably well covered observation network of the ghcnd over colorado , and propose a nonparametric estimator of the matrix - valued covariance function that retains nonnegative definiteness .",
    "in particular , suppose the bivariate process is observed at locations @xmath58 , and times @xmath4 .",
    "then our nonparametric estimator of @xmath59 in ( [ eqwcov ] ) and ( [ eqwcross ] ) , at location pair @xmath60 and time point @xmath61 is @xmath62 \\\\[-8pt ] \\nonumber & & \\hspace*{169pt}\\qquad\\quad{}\\times w_i({\\mathbf{s}}_k , t ) w_j({\\mathbf{s}}_\\ell , t)\\biggr)\\\\ & & \\qquad\\quad{}\\bigg/\\biggl(\\sum_{t=1}^{t } \\sum_{k=1}^n \\sum _ { \\ell=1}^n k_{\\lambda_t}\\bigl(\\bigl\\|d(t_0),d(t)\\bigr\\|_d\\bigr ) k_\\lambda\\bigl(\\|\\mathbf{x}-{\\mathbf{s}}_k\\|\\bigr ) k_\\lambda\\bigl(\\|{\\mathbf{y}}-{\\mathbf{s}}_\\ell\\|\\bigr)\\biggr)\\nonumber\\end{aligned}\\ ] ] for @xmath46 . here",
    ", @xmath63 is a kernel function with bandwidth @xmath64 , and we use @xmath65 .",
    "we use the euclidean norm @xmath66 , and the distance function @xmath67 is the distance between days of the year so that @xmath68 for @xmath69 and @xmath70 for @xmath71 , where @xmath72 , for example , @xmath73 . occasionally @xmath74 [ and subsequently @xmath75 is not available in practice due to instrument failure or disruptions in communications .",
    "the estimator we use operationally is a slightly modified version of ( [ eqnp ] ) , where we make the convention @xmath76 } = 0 $ ] when @xmath77 is missing .",
    "it is convenient to define the single - time - point smoothed empirical covariance function=-1 @xmath78 & & \\qquad= \\biggl(\\sum_{k=1}^n \\sum_{\\ell=1}^n k_\\lambda\\bigl(\\|\\mathbf{x}-{\\mathbf{s}}_k\\|",
    "\\bigr)k_\\lambda\\bigl(\\|{\\mathbf{y}}-{\\mathbf{s}}_\\ell\\| \\bigr ) w_i({\\mathbf{s}}_k , t ) w_j({\\mathbf{s}}_\\ell , t)\\nonumber\\\\[-3pt ] & & \\hspace*{94pt}{}\\times { \\mathbh{1}}_{[w_i(\\mathbf{s}_k , t)\\ \\mathrm{is\\ observed } ] } { \\mathbh{1}}_{[w_j(\\mathbf{s}_\\ell ,",
    "t)\\ \\mathrm{is\\ observed}]}\\biggr)\\\\[-3pt ] & & \\qquad\\quad{}\\bigg/ \\biggl ( \\sum_{k=1}^n \\sum_{\\ell=1}^n k_\\lambda\\bigl(\\|\\mathbf{x}-{\\mathbf{s}}_k\\|\\bigr ) k_\\lambda\\bigl(\\|{\\mathbf{y}}-{\\mathbf{s}}_\\ell\\|\\bigr)\\nonumber\\\\[-3pt ] & & \\hspace*{50pt}\\qquad\\quad{}\\times { \\mathbh{1}}_{[w_i(\\mathbf{s}_k , t)\\ \\mathrm{is\\ observed } ] } { \\mathbh{1}}_{[w_j(\\mathbf{s}_\\ell , t)\\ \\mathrm{is\\ observed}]}\\biggr).\\nonumber\\end{aligned}\\]]=0 notice @xmath79 is just a ( spatially ) smoothed empirical covariance function over the available observations on day @xmath44 .",
    "@xmath79 is a nonnegative definite multivariate covariance function , a property we show in the .",
    "our adjusted version of ( [ eqnp ] ) that accounts for missing observations then is @xmath80 as @xmath81 is a positively weighted linear combination of multivariate covariance functions , it is again nonnegative definite .",
    "the estimator for missing observations ( [ eqnpmissing ] ) reduces to the original estimator ( [ eqnp ] ) when no observations are missing and , hence , ( [ eqnp ] ) is also nonnegative definite .",
    "the estimator ( [ eqnp ] ) is a smoothed version of daily empirical covariance matrices . the first level of smoothing yields an estimate of spatial covariance at any arbitrary location pairs in the domain .",
    "the temporal smoothing shares information between adjacent time points , where we assume that spatial covariance on a given day is similar to that in a short period leading up to that day , and in a short period following that day .",
    "this estimator is a generalization of kernel smoothed empirical covariance estimators considered by @xcite , @xcite and @xcite to the multivariate process setting evolving across time .",
    "we estimate the time bandwidth @xmath82 by predictive leave - one - out cross - validation , leaving out local empirical variance estimates .",
    "the estimated bandwidth for time is @xmath83 days .",
    "we use cross - validation for the temporal bandwidth , as we assume the temporal evolution of spatial covariance is slowly evolving across time , for example ,  we do not expect a sharp change in spatial covariance between june  1 and june  2 . in our experience , using cross - validation for the spatial bandwidth parameter @xmath64 oversmooths the spatial covariance function . when kernel smoothing a mean function , cross - validation is generally acknowledged to yield more variability than is expected for a smoothly varying mean function , and typically the bandwidth must be inflated [ @xcite ] . however , this experience is under the assumption that the mean function is varying smoothly across the domain , and in regions of complex terrain we expect the opposite behavior , where sharp boundaries of the covariance function may exist due to sudden changes in elevation .",
    "for example , cross - validation implies the optimal spatial bandwidth is 75  km , which implies an effective range of the kernel function ( i.e. , up to @xmath84 weight ) of approximately 225 km , greatly oversmoothing regions such as the san luis valley in southern colorado , at approximately 100 km across .",
    "hence , we choose a bandwidth such that the effective distance of the kernel function coincides with the @xmath84 quantile of all intersite distances ( 62 km ) ; the heuristic argument is that , for approximately evenly distributed observation locations , the covariance estimator at a given location uses the nearest @xmath84 of available network locations and down - weights remote locations ; this ad hoc criterion implies a spatial bandwidth of @xmath85  km .",
    "the estimator ( [ eqnp ] ) is asymptotically unbiased for @xmath59 when the domain sample size increases and the bandwidth decreases to zero sufficiently quickly .",
    "a short argument is given in the .",
    "in fact , it can be shown that the estimator is consistent for @xmath59 , using arguments similar to those of @xcite , but this is beyond the scope of the present paper .",
    "all that remains to be estimated is the local nugget effect @xmath86 . at each observation location @xmath58 , and time point @xmath4 ,",
    "let @xmath87 be the estimated residual @xmath88 .",
    "define the local empirical variance on day @xmath89 as @xmath90 where @xmath91 denotes cardinality of the set , with the natural redefinition for missing values of @xmath87 . intuitively , a good estimator for @xmath92 is @xmath93 since , by the law of large numbers , @xmath94 , where the convergence is taken as @xmath95 , and by the argument in the , @xmath96 . while theoretically appealing , in practice , due to the smoothing in @xmath97 , at some locations",
    "the estimate @xmath98 is negative .",
    "hence , in similar spirit we use ( [ eqtau ] ) , but set the invalid estimates to zero .",
    "estimates of @xmath99 are gathered at arbitrary locations , that is , not necessarily within the observation network , by imposing a probabilistic spatial structure on @xmath100 . in particular , we model @xmath100 as a gaussian process with spatially constant mean and matrn covariance function , augmented with a nugget effect . just as for the spatial parameters of the @xmath12 , we estimate the spatial parameters of @xmath100 by maximum likelihood , conditional on the estimates @xmath101 .",
    "while the estimates @xmath98 at observation locations are always valid , the kriging interpolator of @xmath100 may occasionally take on very small negative values ; in our example below we did not experience such an issue , but in other domains these degenerate estimates may be artificially set to zero .",
    "we fit our model to the data from the 145 ghcnd locations shown in figure  [ fignetwork ] . for simplicity",
    ", we removed all leap days from the 119 years of available data , so that each year has 365 days . using all available data , we fit local climate parameters by ordinary least squares and estimate temporally varying multivariate spatial covariances using the nonparametric estimator ( [ eqnpmissing ] ) applied to the observed residuals .",
    "we then simulate the bivariate process for a 119 year trajectory to compare to the observed bivariate series . the first day s ( january 1 , 1893 ) simulation requires autoregressive terms in  ( [ eqnmodel ] ) and  ( [ eqxmodel ] ) ; we initialize using the climatological domain average of minimum and maximum temperatures on december  31 .",
    "the resulting simulations are masked to share the same missing value pattern as the observations .",
    "recall the assumption implied by equation ( [ eqwtime ] ) , where we assume temporal dependence has been accounted for in the local mean function via the bivariate autoregression .",
    "figure  [ figacfs ] contains empirical autocorrelation functions for the observed residuals @xmath10 and @xmath11 at four network stations , shown in figure  [ fignetwork ] .",
    "these locations we view as representative of four distinct regimes of colorado : eastern plains ( a , kit carson ) , front range ( b , estes park ) , rocky mountains ( c , buena vista ) and the western slopes ( d , delta ) .",
    "it is evident that the bivariate autoregression accounts for the majority of temporal persistence in temperature ; the maximal lag-1 autocorrelation coefficient for the residual processes at these four stations is @xmath102 at estes park , whereas all other coefficients are less than or equal to @xmath103 .        to motivate the flexibility of the nonparametric estimator ( [ eqnp ] ) , we compare it to a state - of - the - art isotropic bivariate spatial model .",
    "in particular , we fit a bivariate matrn model [ @xcite , @xcite ] augmented with a nugget effect , where @xmath104 } , \\\\",
    "\\quad\\qquad c_{nx}(\\mathbf{x},{\\mathbf{y}},t ) & = & \\rho_{nx } \\frac { 1}{2^{\\nu_{nx}-1}\\gamma(\\nu_{nx } ) } \\bigl(a_{nx}\\|\\mathbf{x}-{\\mathbf{y}}\\|\\bigr)^{\\nu_i } \\mathrm { k}_{\\nu _ { nx}}\\bigl(a_{nx } \\|\\mathbf{x}-{\\mathbf{y}}\\|\\bigr)\\vadjust{\\goodbreak}\\end{aligned}\\ ] ] for @xmath7 , where @xmath105 is a modified bessel function of the second kind of order @xmath106 , and @xmath107 and @xmath108 .",
    "we fit the parameters by maximum likelihood , viewing each bivariate estimated residual @xmath109 as independent across time . in the stochastic weather simulation literature",
    ", it is customary to fit separate models for each season .",
    "while our nonparametric estimator is available on any day , to facilitate comparisons to the bivariate matrn , we fit both models to only the summer months ( jja ) , and compare empirical to simulated correlations and cross - correlations under both the isotropic and nonparametric models ; figure  [ figpairwise ] displays these results .",
    "the stationary model tends to overestimate spatial correlation for both minimum and maximum temperatures , whereas our nonstationary model adequately captures low and high correlations simultaneously .",
    "the third panel of figure  [ figpairwise ] shows empirical against simulated cross - correlations .",
    "substantial nonstationarity of cross - correlation across colorado is well modeled by our nonparametric approach , but the stationary model clearly fails , putting most cross - correlations at around @xmath110 , whereas the empirical estimates suggest the true cross - correlations should vary between @xmath111 and @xmath112 .    , on @xmath113 june  1 where @xmath31 is a grid location in the eastern plains ( top row ) or a grid location in the rocky mountains ( bottom row ) , with grid locations indicated by black dots .",
    "each pixel s color indicates the model estimated spatial correlation between the pixel location and the dot . ]",
    "our nonparametric matrix covariance estimator ( [ eqnp ] ) accommodates nonstationary behavior of the multivariate process .",
    "figure  [ figspatialcor ] shows two covariance functions on june 1 , one whose first argument is based at a grid location in the eastern plains of colorado , and the second covariance function whose first argument is based at a grid location in the rocky mountains . the top row is the covariance function for the plains - based grid location ; particularly for maximum temperature , and lesser so for minimum temperature , there is strong positive within variable correlation throughout the plains region , suggesting that maximum temperatures are highly correlated across the plains . at the front range boundary ( approximately @xmath114 longitude ) , there is a sharp drop off in spatial correlation from approximately @xmath115 over the plains to @xmath112 in the rocky mountains .",
    "this is due to the fact that temperature is more highly correlated within the two main types of topography of colorado , either the plains or mountains , but not between the two types .",
    "hence , our estimator is able to capture the sharp boundary between the eastern plains and rocky mountains for within variable spatial correlation .",
    "our estimator also identifies the positive cross - correlation between minimum and maximum temperatures in the plains , but allows the two processes to be effectively independent over the rocky mountains .",
    "this nonstationarity of cross - correlation is very difficult to accommodate using extant models , and has only been recently acknowledged in the literature [ @xcite ] .    , except for @xmath113 january 1 instead of june 1 . ]",
    "not only does our estimator allow for substantial nonstationarity , the amount and type of nonstationarity is allowed to vary across time .",
    "figure  [ figspatialcorjan ] shows the same plots of spatial direct and cross - correlation on january 1 , during winter , as opposed to the summer estimates of figure  [ figspatialcor ] . in terms of direct covariance",
    ", we see the length scale of minimum temperature correlation drastically increase for both the plains- and mountain - based grid locations . in the plains , the spatial correlation structure of maximum temperature is similar during both the winter and summer ; on the other hand , this spatial correlation in the mountainous region over winter has a substantially different pattern than over summer .",
    "the correlation structure of the weather component for maximum temperature in the rocky mountains is clearly nonstationary , implying lower correlation between the example grid point and the southwestern slopes of the rockies , but having higher correlation along a northwest to southeast transect along the western slopes and through the rocky mountains ; this pattern makes sense climatologically , as the band of high correlation connects the low lying western grand valley area through the lower mountains north of the san juan chain to the san luis valley in southern colorado .",
    "a  similar pattern is present for the cross - correlation function , which is distinct from the summer behavior which indicated near - independence between minimum and maximum temperatures over the complex topography .     and @xmath116 at observation network locations ,",
    "units are degrees celsius . ]",
    "a notable departure of our model from typical geostatistical approaches is in allowing the nugget effect to vary with location .",
    "our motivation is that the small scale spatial structure is expected to be dampened in the eastern plains with stable orography , but potentially inflated over the mountainous region of colorado .",
    "figure  [ fignuggets ] displays the local estimates @xmath117 for @xmath7 at the locations within our observation network . for both minimum and maximum temperatures ,",
    "the nugget effects tend to be less over the eastern plains , indicating less fine scale spatial structure ( although there is yet some evidence of small scale structure in the maximum temperature nuggets here ) . over the rocky mountains , especially the northern rockies , minimum temperature exhibits inflated nugget effects , indicating fine scale spatial processes in the complex terrain .",
    "similarly , the finest scale spatial structures indicated by these nugget effects for maximum temperature fall almost directly along the front range , the longitude line of approximately @xmath114 , indicating highly variable maximum temperatures between the boundary of the plains and sudden mountainous terrain .",
    "the inclusion of a spatially varying @xmath100 allows the statistical model to retain increased variability along the front range , for example , while simultaneously generating tempered fields over the eastern plains and fields of medium variability over the main rockies and western slopes .",
    "an increasingly important consideration in climate science is the effect of climate change on extremes [ @xcite ] .",
    "our model is not explicitly designed to replicate extreme events , as we focus mainly on the first and second order properties of minimum and maximum temperatures .",
    "figure  [ figextrema ] shows q ",
    "q plots for daily domain - wide extrema .",
    "in particular , we find the minimal and maximal domain - wide temperatures @xmath118 and @xmath119 , and compare simulated to observed daily statistics for @xmath7 .",
    "our model replicates the statistical properties of @xmath120 and @xmath121 very well , at even the most extreme tails of these domain extrema .",
    "however , we simulate domain - wide maximal maximum temperatures that are slightly too high , on average about @xmath122c .",
    "overall , even though our approach does not explicitly model extreme temperatures , we are able to capture the spatial extrema with reasonable accuracy .",
    "quantile for maximum temperature , or whose weather fell below the local @xmath123 quantile for minimum temperature . ]",
    "while our model adequately replicates domain - wide extrema , the related quantity of spatially consistent local extrema is critically important to replicate . in particular , for energy use forecasting and modeling , if a large number of locations experience unusually low or high temperatures simultaneously , then the load on the energy grid can be much greater than if the temperature anomaly were highly localized . figure  [ figexceedance ] shows log frequencies ( i.e. ,  the log number of days ) of the number of stations whose local weather process @xmath77 either exceeded the local @xmath124 quantile ( i.e. , the quantile using only data from location @xmath125 ) or fell below the local @xmath123 quantile , corresponding to local hot or cold events , respectively .",
    "our approach captures the spatial frequencies of unusual local cold temperatures extremely well , and tends to simulate local heat events over slightly inflated regions when many stations experience hot events , although usually fewer than seven extra days on average .     for @xmath7 on all days of the calendar year @xmath89 , and",
    "predicted standard deviations for the four hold out stations @xmath126 kit carson , estes park , buena vista and delta . ]",
    "our nonparametric weather component covariance estimator ( [ eqnp ] ) is not optimized for cross - validation . to assess the interpolative properties of our estimator , we hold out data from the four network stations shown in figure  [ fignetwork ] , representing four distinct regimes of colorado .",
    "we predict the local standard deviations @xmath127 for @xmath7 and compare these to the locally estimated values of @xmath127 when station data is retained .",
    "figure  [ figsdcv ] contains the local and predicted estimates for all days of the calendar year .",
    "clearly the weather component variability is highly dependent on season as well as location , particularly for maximum temperature there is substantially greater variability in the eastern plains ( @xmath128@xmath129c ) compared to the mountain regions ( @xmath122@xmath130c ) .",
    "our predictive local standard deviations ( dashed lines in figure  [ figsdcv ] ) generally agree closely with the local estimates , although there is a slight tendency to under - predict local standard deviation at kit carson by @xmath131@xmath132c .",
    "not only are the raw values well predicted , but the climatological curvature is preserved as well ; for example , we successfully replicate the increased variability of maximum temperature over the western slopes during springtime with relatively constant variability throughout the three remaining seasons ( panel d ) while simultaneously producing significant seasonality over the eastern plains , with low variability during summer and high variability during winter ( panel a ) .",
    "@ld2.9d2.8d2.9d2.8d2.2d2.2d2.2d2.2@ & & + & & + & & & & & & & & + @xmath133 & -2.70  ( 1.40 ) & -5.43  ( 1.32 ) & -6.37  ( 1.35 ) & -4.39  ( 1.34 ) & -3.43 & -4.76 & -4.58 & -4.49 + @xmath134 & -3.94  ( 0.45 ) & -2.45  ( 0.41 ) & -2.89  ( 0.43 ) & -1.78  ( 0.42 ) & -4.48 & -2.01 & -2.66 & -1.69 + @xmath135 & -1.08  ( 0.25 ) & -0.63  ( 0.23 ) & -0.81  ( 0.24 ) & -0.36  ( 0.24 ) & -1.07 & -0.68 & -0.58 & -0.19 + @xmath136 & 0.20  ( 0.06 ) & 0.28  ( 0.06 ) & 0.27  ( 0.06 ) & 0.27  ( 0.06 ) & 0.20 & 0.27 & 0.21 & 0.25 + @xmath137 & 0.46  ( 0.06 ) & 0.41  ( 0.06 ) & 0.47  ( 0.06 ) & 0.50  ( 0.06 ) & 0.45 & 0.38 & 0.49 & 0.52 + @xmath138 & 0.55  ( 1.30 ) & 0.53  ( 1.30 ) & 0.57  ( 1.30 ) & 0.60  ( 1.30 ) & 0.42 & 0.67 & 0.58 & 0.72 + @xmath139 & 6.99  ( 1.08 ) & 4.40  ( 0.98 ) & 3.27  ( 1.02 ) & 4.31  ( 1.01 ) & 7.28 & 4.03 & 3.62 & 4.36 + @xmath140 & -4.30^ *  ( 0.41 ) & -3.80  ( 0.38 ) & -3.81^ *  ( 0.39 ) & -3.77  ( 0.39 ) & -5.29 & -3.30 & -3.00 & -4.08 + @xmath141 & -1.26^ *  ( 0.15 ) & -1.31  ( 0.14 ) & -1.29^ *  ( 0.14 ) & -0.93  ( 0.14 ) & -1.58 & -1.20 & -0.93 & -0.90 + @xmath142 & 0.03  ( 0.07 ) & -0.01  ( 0.07 ) & -0.02  ( 0.07 ) & -0.03  ( 0.07 ) & -0.05 & -0.01 & -0.02 & -0.08 + @xmath143 & 0.63  ( 0.05 ) & 0.67  ( 0.05 ) & 0.69  ( 0.05 ) & 0.75  ( 0.05 ) & 0.64 & 0.70 & 0.75 & 0.78 + @xmath144 & 0.30  ( 0.80 ) & 0.31  ( 0.80 ) & 0.31  ( 0.80 ) & 0.30  ( 0.80 ) & -0.42 & 0.67 & 0.48 & 0.13 +    table  [ tabests ] shows the interpolated coefficients with predictive standard deviation , along with the locally estimated parameters @xmath145 for @xmath146 and @xmath7 for @xmath125 being one of the four held out network stations .",
    "all locally estimated parameters are within the @xmath147 predictive confidence interval , except for four cases for maximum temperature .",
    "our predictive intervals are calibrated ; the coverage of the @xmath147 interpolation intervals for leave - one - station - out cross - validation over all locations was , at worst , @xmath148 for @xmath141 .",
    "notice that the local estimates vary substantially between locations , indicating that indeed the local climate varies over the domain .",
    "hence , we are able to successfully predict the local weather component parameters and local climate component parameters at these four hold out locations which are representative of four regimes in colorado .        finally , we illustrate the final product of our approach in figure [ figsim ] which displays four days of gridded simulations of minimum and maximum temperatures over colorado .",
    "marginally , we visually see the temporal persistence of temperature over a period of days , as both minimum and maximum temperatures experience a period of cooling over june 14 .",
    "notice the effect of local climate is to keep the rocky mountain region cooler for both variables , allowing higher minimum and maximum temperatures to fall over the eastern plains of colorado .",
    "we also see slightly warmer temperatures on the western slopes , as the rocky mountains decay in elevation to the western border of colorado .",
    "the cross - correlation between the two variables is also present , as both variables are seen to cool across the domain simultaneously .",
    "in this paper we introduce a framework for stochastic bivariate minimum and maximum temperature simulation over complex domains .",
    "the framework distinguishes between local climate and weather processes .",
    "the local climate is accommodated through a linear model whose coefficients are spatially varying , and the weather process is modeled as a bivariate spatial gaussian process with a nonparametric estimate of the matrix - valued covariance function that retains nonnegative definiteness at arbitrary locations .",
    "we successfully capture the temporally varying spatial dependence between minimum and maximum temperatures over the state of colorado , which exhibits challenging complex terrain that is difficult for extant models to accommodate .",
    "our nonparametric estimator smooths multivariate spatial covariance over space as well as time .",
    "this approach allows spatial dependence to be highly different during winter than during summer , for instance , and also retains nonstationary spatial structures both within each process and between processes .",
    "the estimator is available at any location , not only those within the observation network , and always retains nonnegative definiteness , allowing for gridded simulations .",
    "the estimator relies on kernel - smoothed empirical covariance functions , and our current approach to spatial bandwidth selection is ad hoc .",
    "one future route of research may be to decide on a quantitative approach to bandwidth selection when sharp boundaries and highly variable covariances are expected across the study domain , notably different than most mean function smoothing literature [ @xcite ] .",
    "a second potential direction of research may be to develop a nonparametric kernel - smoothed estimate of the multivariate covariance function that is robust against outliers and still retains nonnegative definiteness .    while our approach does not explicitly model extremes , our simulations indicate reasonable replication of tail behavior , even domain - wide extrema .",
    "a limitation in using gaussian processes is that there is a lack of clustering at high levels , both spatially and temporally [ @xcite ] .",
    "this is one potential explanation for the behavior of figure  [ figextrema](b ) , where domain - wide maximal maximum temperatures were simulated slightly above the observed extremes , although we would expect to see similar behavior in panels ( a ) , ( c ) and ( d ) .",
    "an approach that includes a gaussian process model for the bulk of the distribution along with a model for spatial extremes may improve extremal performance .",
    "one consideration of our model is that we do not explicitly force the simulation of maximum temperature to be greater than or equal to minimum temperature ; in our colorado example maximum temperature was less than minimum temperature for approximately one tenth of a percent of our simulations .",
    "it may be of interest to adopt the models of @xcite or @xcite to our situation if this issue is of critical concern .",
    "the clearest route of future research is to extend our ideas to a full stochastic weather simulator that can simulate spatially correlated fields of multiple variables such as minimum and maximum temperatures , precipitation amount , solar radiation , wind direction / wind speed and relative humidity simultaneously . indeed ,",
    "in complex terrains the practitioner will need to rely on highly flexible spatial models to replicate the strong nonstationarities exhibited by these various processes , as well as the complicated spatially evolving relationship between them .",
    "in this appendix we show the nonparametric estimator ( [ eqnpr ] ) is nonnegative definite , from which it follows that ( [ eqnp ] ) and ( [ eqnpmissing ] ) are also nonnegative definite .",
    "below , we present an argument that ( [ eqnp ] ) is asymptotically unbiased for @xmath59 .",
    "the nonnegative definiteness property is not restricted to a bivariate process , so assume there are @xmath149 spatial processes @xmath150 , with observation network locations @xmath151 . define @xmath152}$ ] , noting that if @xmath77 is unavailable at a particular location and time , @xmath153 .",
    "consider evaluating @xmath154 at any arbitrary locations @xmath155 and @xmath156 , and define the arbitrary vector @xmath157 set @xmath158 to be the covariance matrix made up of the functions @xmath159 corresponding to the random vector @xmath160 then , absorbing the denominator into the kernel functions of @xmath154 , and writing @xmath161 for this normalized function , we have @xmath162    to show that ( [ eqnp ] ) is asymptotically unbiased for @xmath59 , we disregard the smoothing over time , since asymptotically we do not have a finer resolution of time points ( but for consistency we would assume an increasing number of realizations per each day of the year ) . in particular , suppose we observe the bivariate process @xmath163 for @xmath164 , which are samples from a distribution with strictly positive probability density @xmath165 , with empirical c.d.f .",
    "@xmath166}$ ] , where the indicator function is 1 if the inequality holds for all indices of @xmath167 .",
    "the density  @xmath168 , with corresponding c.d.f .",
    "@xmath169 , allows the network density to vary across the domain .",
    "we additionally suppose @xmath170 and @xmath171 such that @xmath172 for some small @xmath173 .    suppressing the time indexing from our notation , we can write @xmath174 where the denominator of ( [ eqnp ] ) is absorbed into the kernel functions of the numerator , yielding standardized functions @xmath175 . here",
    "we only consider the direct covariance estimators at a location @xmath176 , @xmath177 ; the same argument applies for the direct and cross - covariance functions @xmath178 for @xmath179 .",
    "we have @xmath180 invoking lemma 7 of @xcite , in the limit as @xmath170 , we can pass from the sum to the integral",
    ". assume the empirical c.d.f .",
    "@xmath181 is close to the limiting c.d.f .",
    "@xmath169 , where @xmath182 where @xmath183 . this rate holds , for example , if @xmath184 $ ] , @xmath169 is the uniform density and @xmath181 is the empirical c.d.f . of the uniform grid @xmath185 . for @xmath186 , if @xmath36 grows as @xmath187 , a rate of @xmath188 can be derived for sampling locations on a regular grid with limiting uniform distribution [ @xcite ] .",
    "then we have @xmath189 \\\\[-10pt ] \\nonumber & & { } + \\frac{1}{n \\lambda^{2d } } \\int_{{\\cal d } } k_\\lambda ' \\bigl(\\|{\\mathbf{u}}-\\mathbf{x}\\| \\bigr)^2 \\tau_i({\\mathbf{u}},{\\mathbf{u}})^2 \\,\\mathrm { d}f ( { \\mathbf{u } } ) + { \\cal o}(d_n).\\end{aligned}\\ ] ] making the change of variables to @xmath190 and @xmath191 yields @xmath192 \\\\[-8pt ] \\nonumber & & \\qquad { } + \\frac{1}{n \\lambda^{d } } \\int_{{\\cal d ' } } k ' \\bigl(\\|{\\mathbf{a}}\\| \\bigr)^2 \\tau_{i}(\\lambda{\\mathbf{a}}+ \\mathbf{x},\\lambda{\\mathbf{a}}+ \\mathbf{x})^2\\,\\mathrm { d}f({\\mathbf{a } } ) + { \\cal o}(d_n)\\end{aligned}\\ ] ] for an appropriate translated domain @xmath193 . as @xmath172 ,",
    "the second term of ( [ eqasymptoticbias ] ) converges to zero .",
    "the arguments from @xcite applied to the first term of ( [ eqasymptoticbias ] ) then yield the unbiasedness of @xmath177 ."
  ],
  "abstract_text": [
    "<S> spatiotemporal simulation of minimum and maximum temperature is a fundamental requirement for climate impact studies and hydrological or agricultural models . particularly over regions with variable orography , </S>",
    "<S> these simulations are difficult to produce due to terrain driven nonstationarity . </S>",
    "<S> we develop a bivariate stochastic model for the spatiotemporal field of minimum and maximum temperature . </S>",
    "<S> the proposed framework splits the bivariate field into two components of `` local climate '' and `` weather . '' </S>",
    "<S> the local climate component is a linear model with spatially varying process coefficients capturing the annual cycle and yielding local climate estimates at all locations , not only those within the observation network . </S>",
    "<S> the weather component spatially correlates the bivariate simulations , whose matrix - valued covariance function we estimate using a nonparametric kernel smoother that retains nonnegative definiteness and allows for substantial nonstationarity across the simulation domain . </S>",
    "<S> the statistical model is augmented with a spatially varying nugget effect to allow for locally varying small scale variability . </S>",
    "<S> our model is applied to a daily temperature data set covering the complex terrain of colorado , usa , and successfully accommodates substantial temporally varying nonstationarity in both the direct - covariance and cross - covariance functions .    , </S>"
  ]
}