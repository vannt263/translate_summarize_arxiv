{
  "article_text": [
    "the presence of prominent emission lines in the spectra of close binaries is one of the tell - tale signs of an accretion flow .",
    "the highly structured and time dependent emission line profiles observed in cataclysmic variables ( cvs ) and x - ray binaries harbour a wealth of information . since the flow is highly supersonic , the overall line profile shape is not determined by the local line profile .",
    "instead , it is dominated by the dynamics of the flow , thus providing a direct kinematical signature of the accretion structure ( smak 1981 , horne & marsh 1986 ) .",
    "this motivated the development of doppler tomography ( marsh & horne 1988 ) as a tool to recover the accretion flow from the observed line profiles in cvs .",
    "it was recognised that the observed line profile at each orbital phase is a projection of the accretion flow along the line of sight , and given sufficient observed projection angles , the profiles can be inverted to give the line emission distribution in the binary .",
    "such different projection angles are naturally provided to us as the binary components orbit their common centre of mass as a function of the orbital period permitting reconstructions that resolve the accretion flow on micro - arcsecond scales .",
    "i refer to marsh ( 2002 ) and horne ( 1991 ) for the basic details concerning the inversion process from data to doppler maps , a process which shares many similarities with medical cat - scanning procedures .",
    "since one observes the radial velocities of the emitting material in the line profiles through doppler shifts , the choice of working in velocity space is one of the major advantages of standard doppler tomography . while not perhaps as intuitive to interpret as spatial images in the cartesian x - y frame , doppler tomograms in @xmath0 velocity space can be obtained without specific prior assumptions concerning the velocity field in the flow as a function of position .",
    "this significantly simplifies the inversion process and allows the application of doppler tomography in a variety of conditions where the nature of the flow is not a - priori known . since its conception",
    ", doppler tomography has grown to become a widely used tool with over 100 papers in the refereed press presenting doppler images . for recent reviews and a number of examples of its application",
    "see boffin , steeghs & cuypers ( 2002 ) . despite its flexibility ,",
    "doppler tomography rests on certain assumptions and approximations . in this paper",
    ", i present an extension to doppler tomography that relaxes one of its main assumptions , thus further increasing its applicability .",
    "i will start by reviewing the basic axioms of tomography in section 2 , the implementation of the extension is described in sections 3 and 4 , and the new code is scrutinised in sections 5 and 6 .",
    "standard tomography reconstructs the distribution of line emission in the binary in a velocity coordinate frame .",
    "it effectively decomposes the observed line profiles into discrete emission sources characterised by their velocity vector in the co - rotating frame of the binary .",
    "i start by reviewing the basic axioms of doppler tomography as given in marsh ( 2002 ) , albeit in a different order ;    1 .",
    "the intrinsic line profile width is negligible 2 .",
    "all velocity vectors co - rotate in the binary 3 .",
    "motion is mapped parallel to the orbital plane only 4 .",
    "all points are equally visible at all times 5 .",
    "the flux from any point is constant in time    violations of these assumptions do not imply that doppler tomography can not be performed , or that the maps are meaningless , but these assumptions must be borne in mind when interpreting doppler maps .",
    "as such , the tomogram is a representation of the observed data given the above assumptions and the accuracy and reliability of that representation is thus intimately tied in with the validity of the above axioms .",
    "for example , the local line profile is expected to be set by a thermally broadened profile , amounting to a width of order 10 km / s for typical cv temperatures .",
    "compared to doppler velocities of hundreds to thousands of km / s makes axiom 1 generally satisfied under a wide range of conditions . however , non - thermal broadening mechanisms may be at work in parts of the flow , and can in particular affect low velocity emission .",
    "axioms 2 and 3 can be violated in parts of the flow , but the derived doppler map should then be seen as approximations whereby the flow is projected onto the orbital frame of the binary and the map provides a time averaged representation of the flow in the co - rotating frame .",
    "of the five axioms , number four is the most difficult to deal with since one does not generally know the full geometry of the flow that is being mapped .",
    "after all , the whole point of doppler mapping is to probe this geometry . in high inclination systems ,",
    "self - shadowing effects may play a role , and complicate the analysis of emission line profiles .",
    "this leads us to the remaining axiom , that is the flux from each point in the co - rotating frame is assumed constant in time .",
    "however , observations show that the typical emission sources one is mapping do modulate their flux in time",
    ". this can be because the line source emits an - isotropically ( e.g. the emission from density waves and shocks in an accretion disc ) or because axiom 4 is violated and the geometry is responsible for a strong modulation of the flux ( e.g. the buried bright spot or the irradiated secondary star ) or a combination of both .",
    "doppler tomography can still be used in that case , since the doppler map serves to present a time averaged image of the distribution of line emission , ignoring such phase - dependent complications .",
    "however , one will not be able to fit the data very well , and the phase dependent information contained in the observed line profiles is lost .",
    "this motivated the development of an extension to doppler tomography that allows the line flux from a given point to vary as a function of time .",
    "the next sections concern the implementation of such an extension which i refer to as modulation doppler tomography .",
    "in conventional doppler tomography , each line source is characterised by its inertial velocity vector @xmath1 , where the binary centre of mass is at the origin , the x - axis points from the accretor to the donor and the y - axis point in the direction of motion of the donor , as viewed in the co - rotating frame of the binary .",
    "the intensity of the doppler map at a given velocity @xmath2 describes the line flux observed from the velocity element with centre @xmath3 and width @xmath4 .",
    "each velocity vector follows a sinusoidal radial velocity curve @xmath5 in the inertial frame of the observer as a function of the orbital phase @xmath6 given by :    @xmath7    where @xmath8 is the systemic velocity of the binary system and phase zero is defined to be inferior conjunction of the donor star with @xmath9 .",
    "each line source contributes a constant amount to the observed line profiles at each phase ( axioms 4 and 5 ) , and the observed line profile @xmath10 is simply a projection of the radial velocities and intensities of all velocity vectors considered ;    @xmath11    with @xmath12 describing the local line profile intensity at a doppler shift of @xmath13 , which is usually assumed to be a gaussian profile with a width corresponding to the instrumental resolution .",
    "let us now consider line sources that modulate harmonically in flux as a function of the orbital phase ;    @xmath14    [ spot ]    one then has three parameters to describe the line flux from a specific velocity vector ; the average line flux @xmath15 and the amplitude and phase of the modulation in terms of @xmath16 and @xmath17 .",
    "this in contrast to the single parameter @xmath2 in doppler tomography as described above . in this prescription , we need three doppler maps describing the values of @xmath15,@xmath16 and @xmath17 for each velocity @xmath3 ( see figure 1 ) .",
    "the total amplitude of the modulation is then @xmath18 , and its phase is @xmath19 . in terms of equation 2 , this amounts to replacing @xmath2 with @xmath20 .",
    "this extension is thus straightforward to implement , and does not fundamentally alter the nature of the projection from data to maps and vice - versa .",
    "rather then constructing one doppler map , one now has three doppler maps characterising the nature of the emission across the co - rotating frame . while i could have allowed for a more complicated type of modulation , either by including more terms to account for non - sinusoidal modulations , or by letting the period of modulation to be different from the orbital period , the above implementation provides a simple and flexible prescription with minimal additional free parameters to fit the observed data with",
    "the inversion process from observed data to doppler maps is normally done via either the back - projection method in combination with fourier filtering ( horne 1991 ) or maximum entropy regularisation ( marsh & horne 1988 ) . for a comparison of the relative merits of both methods in the light of doppler tomography see marsh ( 2002 ) . for the implementation of the modulation doppler tomography code ,",
    "i choose to employ the maximum entropy route , since a back - projection would suffer from serious cross - talk between the three image terms and produce significant imaging artifacts .",
    "the fortran code modmap uses the memsys algorithm ( skilling & bryan 1984 ) in order to iteratively adjust the doppler images while achieving a user specified @xmath21 .",
    "the algorithm gradually steers toward the requested @xmath21 value while maximising the entropy of the images in order to converge to a unique solution .",
    "it delivers the simplest image that can fit to data to the specified level , whereby simplicity is reflected by the image entropy ( see also horne 1994 ) .",
    "this image entropy ( @xmath22 ) of an image vector @xmath23 is defined relative to a template image of the same dimension , the default map @xmath24 :    @xmath25    using such a maximum entropy regularised fitting scheme , the final solution is determined by the requested @xmath21 value and the choice of default .",
    "the entropy is maximised ( approaches zero ) as @xmath26 approaches @xmath24 .",
    "since the entropy is only defined for positive image values , but the cosine and sine amplitudes of the modulation can be both positive or negative , the doppler image vector passed to the fitting code was split into a sequence of five velocity maps .",
    "the first image array represents the average image values ( @xmath27 ) , while the cosine and sine values are represented by two image arrays each . for those two images ,",
    "one image reflects positive amplitudes , the other negative amplitudes such that @xmath28 and @xmath29 . in this way",
    "all possible modulations are included while a positive image vector is maintained under all circumstances for which an entropy can be defined .",
    "for the default image vector , i experimented with several options , and the commonly used running default method using a blurred version of the image vector was implemented because of its good convergence properties . in this scheme , the default is recalculated after each iteration by heavily blurring the current image in velocity space , providing a smooth default that only contains large scale image structure . in order to minimise structure in the modulation images @xmath30 , the defaults for these were steered to zero after blurring .",
    "the velocity grid ( @xmath31 ) of the doppler images is user defined , finer grids requiring significantly more cpu time for each iteration since the number of pixels in the image vector is @xmath32 . in order to speed up the iterative fitting procedure ,",
    "an optimal value was sought for the initial average image ( @xmath33 ) through @xmath21 minimisation of a constant scaling factor .",
    "the other four images were started off at zero .",
    "the modmap code would then iterate to a user specified @xmath21 until converged at the maximum entropy solution .",
    "in order to test the reliability of the modulation doppler tomography technique , and to explore image artifacts due to both random and systematic errors , a large set of test data sets were generated .",
    "time - dependent line profiles were synthesised and passed to the modmap code so that its reconstructions could be compared with the original input data . in this section ,",
    "i discuss a selection of these reconstructions .",
    "they will illustrate the robustness of the image reconstructions , and explore the possible effects of external systematic errors .",
    "the first test data set concerns the reconstruction of three isolated emission spots , each at a different inertial velocity and with different modulation characteristics .",
    "the first spot does not modulate at all , has a fwhm of 100 km / s and unit strength .",
    "the second spot is broader ( 250 km / s ) and modulates strictly in a cosine fashion with 90% amplitude , while the third spot modulates strictly in sine fashion with an amplitude of 50% .",
    "the corresponding doppler maps for these spots are presented in figure 2 , and test data was generated from these maps . after adding random poisson - type noise , the simulated data was loaded into the modmap code in order to reconstruct the doppler maps . as figure 2 illustrates , the code reconstructs these spots perfectly , in terms of their velocity location , overall strength and width as well as modulation amplitudes .",
    "most importantly , no cross talk is present between the modulation images in the sense that there is no remnant of a pure cosine source in the sine image and vice versa .",
    "[ spot ]    [ cols=\"^,^ \" , ]     the systemic velocity needs to be known in order to calculate the correct radial velocity curve ( eqn 1 ) of a line source with velocity ( @xmath34,@xmath35 ) .",
    "if one attempts to reconstruct a data set with an incorrect gamma , it will be difficult to achieve a good fit to the data since the code is not tracing the correct velocity curves ( see also marsh & horne 1988 ) .",
    "figure 3b illustrates the reconstructed doppler images using the same data set that was employed in the previous test reconstruction , but now reconstructing it with a systemic velocity that is incorrect by 60 km / s .",
    "clear artifacts are present in all the maps , and the code , as expected , is unable to achieve a reduced @xmath36 .",
    "thus , an incorrectly assumed gamma can lead to significant artifacts in the modulation maps , more so than in the average map .",
    "the total modulation flux map illustrates that the ( non - varying ) disc in particular leaves artifacts in the modulation images .    for many systems , an estimate of the systemic velocity",
    "is known or can be measured from the line profiles .",
    "the uncertainty in @xmath8 only becomes an issue if its error approaches or exceeds the local line profile width . in those cases where the data resolution is very high , or independent",
    "@xmath8 estimates are not available , the achieved @xmath21 value can be employed as a self - consistent test of the assumed systemic velocity .",
    "since an incorrect @xmath8 leads to image artifacts and poor data fits , one can perform a series of doppler map reconstructions while trying to minimise @xmath21 as a function of @xmath8 in order to identify the correct systemic velocity .",
    "thus , provided the potential effects of an incorrect gamma are borne in mind , its impact on the image reconstructions can usually be verified self - consistently , and can be used to determine the systemic velocity .",
    "the local line profile is assumed to be a gaussian with its width adjusted to the instrumental resolution of the data . in figure 3c , i illustrate the reconstructed doppler maps after underestimating the local line width by a factor of two .",
    "while the maps show weak fine structure due to this oversampling effect , it still recovers the correct image structure . on the other hand , overestimating the local line width by the same factor leads to a sharpening of the recovered maps ( figure 3d ) ; the reconstructed spot sizes are now too small in the doppler images and the convergence is very slow .",
    "this is the result of the code attempting to reproduce the observed width of the spots with an assumed local line profile that is too broad .",
    "this can only be achieved by making the spot widths smaller in the maps .",
    "the effect of a forced error in @xmath37 affects all the maps in the same way , and does not degrade the ability to recover modulated emission sources .",
    "it is clearly better to caution on the side of oversampling by underestimating the local line width to avoid artificial sharpening of the tomograms .",
    "thus provided the structures that one is imaging are sampled properly , reconstructions are robust against modest local line width variations .",
    "as a real world example of the use of modulation mapping , i applied modmap to existing data of the eclipsing dwarf nova ip pegasi during outburst .",
    "this data together with conventional doppler maps were presented in harlaftis et al .",
    "( 1999 ) and revealed strong spiral arms in the accretion disc .",
    "figure 4 plots the reconstructed modulation doppler maps for the heii 4686  emission of ip pegasi",
    ". a much better reconstruction of the observed data was achieved using the modmap code compared to the conventional doppler reconstruction , indicative of significant orbital variability .",
    "the average map corresponds in detail to the maps presented in harlaftis et al .",
    "( 1999 ) , with a disc dominated by two spiral arms and weak secondary star emission .",
    "most of the modulated flux is dominated by the sine term , with modulation amplitudes of up to 20% .",
    "again , the variable disc emission is concentrated in two arms . however , these arms do not correspond to the location of the spirals in detail , but only overlap partially . instead , the modulated disc flux is at slightly larger velocities ( i.e. closer in ) and rotated anti - clockwise in terms of phase .",
    "it thus appears that most of the modulation is not due to anisotropic radiation from the spiral arms directly , but variable emission from the disc regions just inside .",
    "this could be due to geometric shielding of those disc areas by the vertically extended spiral structures .",
    "the phasing of the modulation supports such an interpretation ; the emission from the disc just inside the closest arm is weaker compared to that of the disc inside the opposite arm and both modulate in anti - phase .",
    "this is expected if the spiral arms are vertically extended , shielding the disc area immediately behind them from the observer at high inclinations ( ip pegasi is an eclipsing system after all ) . as always , one must bear in mind that although the modulation mapping code is able to show that disc flux is modulated , significant geometrical shielding violates the basic assumptions of doppler tomography ( axiom 4 ) .    as well as",
    "modulated emission from the disc , the maps also show that the secondary star and an extended low velocity region are time dependent emission sites . this reconstruction illustrates the ability of modmap to identify emission sites in the binary that modulate as a function of the orbital phase and characterise their modulation in terms of its phase and amplitude .",
    "it achieves better fits to the data , and aids in establishing the nature of the line emitting sources .",
    "a more extensive and quantitative analysis of reconstructions using modmap on existing data sets will be presented in future papers .",
    "i presented an extension to emission line doppler tomography that permits the mapping of time dependent emission sources .",
    "it relaxes one of the five fundamental axioms of conventional doppler tomography , and maps harmonically varying modulations on the orbital period . since",
    "significant variability on the orbital period is a common characteristic of the typical emission sources in cvs and x - ray binaries , this prescription permits a more detailed reconstruction of the nature of the accretion flow .",
    "intrinsic variability not correlated with the orbit is however not described by this extension . instead of a single doppler map describing the time averaged emission distribution in the co - rotating frame of the target",
    ", modulation doppler tomography describes the emission through three doppler tomograms .",
    "one describes the average flux distribution just like in standard doppler tomography , while the two additional tomograms describe the variable component in terms of its sine and cosine amplitudes .",
    "thus for each location in the @xmath0 doppler coordinate frame , the mean flux and the amplitude and phase of any variable flux contribution is given by the three image values at that velocity .",
    "test reconstructions using the maximum entropy based fitting code modmap in conjunction with synthetic data show that the technique is robust , and artifact free reconstructions of complex emission distributions can be achieved under a wide range of signal to noise levels .",
    "the effects of systematic uncertainties in the assumed systemic velocity and local line profile width are similar to those seen in conventional tomography .",
    "there are several reasons to expect anisotropic emission from the accretion flow .",
    "horne ( 1995 ) explores the signature of anisotropic turbulence on the emission pattern of a turbulent accretion disc .",
    "anisotropy in the turbulence mach matrix also leads to anisotropic line emission from the disc .",
    "the prominent spiral structures seen in dwarf nova accretion discs are also likely to emit an - isotropically ( e.g. steeghs & stehle 1999 ) as was illustrated in section 6 .",
    "the highly variable emission from the disk - stream impact region ( e.g. spruit & rutten 1998 ) is another prime example of orbitally modulated emission . in morales - rueda",
    "( 2003 ) , the results from modeling the bright spot emission in gp com using modmap are presented . finally , the irradiated secondary star is a common emission line source present in the line profiles ( e.g. marsh & horne 1990 ) .",
    "while the emission from the roche - lobe shaped donor is better mapped with roche - tomography techniques ( watson & dhillon 2002 ) , modulation doppler tomography is able to reproduce the basic properties of the emission .",
    "this permits much better fits to the data , making a strong secondary star contribution less problematic for disc mapping experiments ( steeghs 2002 ) .",
    "modulation doppler tomography is a robust and well constrained extension that may assist the interpretation of both existing and future data sets of accreting binaries . as with all tomographic imaging techniques",
    ", it nevertheless still relies on several assumptions that need to be borne in mind when interpreting any image reconstructions ( section 2 ) .",
    "its main advantage over conventional doppler tomography is to describe emission sources that vary harmonically as a function of the orbital phase .",
    "its added flexibility should find a wide range of uses , in particular in conjunction with high signal to noise data .",
    "the author acknowledges support from a smithsonian astrophysical observatory clay fellowship and was supported by a pparc fellowship when this work was initiated .",
    "keith horne and tom marsh are thanked for many useful discussions on tomography and maximum entropy related topics . thanks to emilios harlaftis for his role in securing the ip pegasi outburst data .",
    "boffin , h.m.j . , steeghs , d. , cuypers , j. , 2002 , eds .",
    ", astrotomography ; indirect imaging methods in observational astronomy , lecture notes in physics series volume 573 , springer verlag , berlin harlaftis , e.t . ,",
    "steeghs , d. , horne , k. , martin , e. , magazzu a. , 1999 , mnras , 306 , 348 horne , k. , 1991 , in : fundamental properties of cataclysmic variable stars , ed .",
    "a.w.shafter , san diego state uiversity , san diego horne , k. , 1995 , a&a , 297 , 273 horne , k. , 1994 , in : asp conf series vol .",
    "69 , gondhalekar , p , horne , k. , peterson , b. , eds . , asp press horne , k. , marsh , t.r . , 1986 , mnras , 218 , 761 marsh , t.r , 2002 , in : astro - tomography , boffin , h. , steeghs , d. , cuypers , j , eds . ,",
    "lecture notes in physics series 573 , springer verlag marsh , t.r . , horne , k. , 1990 , apj , 349 , 593 marsh , t.r . ,",
    "horne , k. , 1988 , mnras , 236 , 269 morales - rueda , l. , marsh , t. r. , steeghs , d. , unda - sanzana , e. , wood , janet h. , north , r. c. , 2003 , a&a , in press skilling , j. , bryan , r.k . , 1984 , mnras , 211 , 111 smak , j. , 1981 , aca , 31 , 395 spruit , h. , rutten , r. , 1998 , mnras , 299 , 768 steeghs , d. , 2002 , in : astro - tomography , boffin , h. , steeghs , d. , cuypers , j , eds . , lecture notes in physics series 573 , springer verlag steeghs , d. , stehle , r. , 1999 , mnras , 307 , 99 watson , c. , dhillon , v. , 2002 , mnras , 326 , 67"
  ],
  "abstract_text": [
    "<S> emission line doppler tomography is a powerful tool that resolves the accretion flow in binaries on micro - arcsecond scales using time - resolved spectroscopy . </S>",
    "<S> i present an extension to doppler tomography that relaxes one of its fundamental axioms and permits the mapping of time - dependent emission sources . </S>",
    "<S> significant variability on the orbital period is a common characteristic of the emission sources that are observed in the accretion flows of cataclysmic variables and x - ray binaries . </S>",
    "<S> modulation doppler tomography maps sources varying harmonically as a function of the orbital period through the simultaneous reconstruction of three doppler tomograms . </S>",
    "<S> one image describes the average flux distribution like in standard tomography , while the two additional images describe the variable component in terms of its sine and cosine amplitudes . </S>",
    "<S> i describe the implementation of such an extension in the form of the maximum entropy based fitting code modmap . </S>",
    "<S> test reconstructions of synthetic data illustrate that the technique is robust and well constrained . </S>",
    "<S> artifact free reconstructions of complex emission distributions can be achieved under a wide range of signal to noise levels . </S>",
    "<S> an application of the technique is illustrated by mapping the orbital modulations of the asymmetric accretion disc emission in the dwarf nova ip pegasi .    </S>",
    "<S> [ firstpage ]    binaries : close  accretion , accretion discs  novae , cataclysmic variables  line : profiles  techniques : spectroscopic </S>"
  ]
}