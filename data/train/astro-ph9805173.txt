{
  "article_text": [
    "the power spectra of temperature and polarization fluctuations of the cosmic microwave background contain a rich harvest of cosmological information . from upcoming high - resolution maps of the microwave background",
    ", we can hope to determine the basic cosmological parameters to high precision , as well as test the nature of the primordial perturbations and the mechanism for structure formation in the universe @xcite .",
    "extracting this information will require computationally intensive analysis of the parameter space of cosmological models ; a basic , general family of inflation - like models requires around ten parameters .",
    "monte carlo explorations of such a large parameter space will require power spectra evaluations for millions of models , so it is imperative that the fastest possible code be available for calculating power spectra .",
    "traditionally , microwave background power spectra were computed by expanding the angular dependence of the radiation field in multipole moments and then evolving the resulting set of coupled differential equations . for power spectra at sub - degree scales ,",
    "typically several thousand coupled equations need to be evolved ; the cpu time for such codes on current workstations is generally measured in hours . even scaling up to supercomputer speeds ,",
    "large monte carlo calculations are not possible with such codes .",
    "a major advance was the realization by seljak and zaldarriaga that a formal integral solution to the photon evolution equation allows the solution ( in flat space ) to be expressed as a source term integrated against spherical bessel functions @xcite .",
    "the source term still needs to be calculated via coupled evolution equations , but since only the lowest moments contribute to the source term , far fewer equations must be evolved .",
    "in essence , the full set of coupled equations integrates the bessel equation , whose solution is already known .",
    "the spherical bessel functions depend on radius @xmath0 and on two parameters , the wavenumber @xmath1 and the index @xmath2 ; however , in flat space , the wavenumber can be scaled with the radial variable so @xmath3 is actually a one - parameter family of functions .",
    "microwave background computations generally require values of @xmath2 up to a few thousand , and it is computationally feasible to precompute and cache the required bessel functions .",
    "thus the flat - space power spectrum can be evaluated with a greatly increased speed using the seljak - zaldarriaga algorithm .    for open or closed universes ,",
    "the analogous `` hyperspherical '' bessel functions depend on the radial coordinate and the wavenumber separately , so an inordinate number of functions would need to be precomputed and stored .",
    "seljak and zaldarriaga resort to a numerical integration of the differential equation defining the hyperspherical bessel functions , which is far slower than calling the precomputed functions in the flat case .",
    "this paper calculates the wkb approximation to the hyperspherical bessel functions , which , while not as fast as precomputation , offers a dramatic increase in computational speed over other methods .",
    "furthermore , the wkb approximation is _ highly _ accurate for all but the lowest few values of @xmath2 .",
    "the following section gives a brief review of wkb theory .",
    "section iii then gives an overview of the relevant properties of the hyperspherical bessel functions ; section iv derives the wkb approximation for all cases , including the usual spherical bessel functions in the flat space limit .",
    "comparisons with exact functions demonstrate the remarkable accuracy of the approximation .",
    "the paper concludes with brief remarks discussing implementation and application of the approximations .",
    "the wkb approximation applies to equations of the schrodinger form @xmath4 such equations have exponential behavior in regions where @xmath5 ( dissipative regions ) and oscillatory behavior when @xmath6 ( dispersive regions ) .",
    "points with @xmath7 are called turning points , marking the transition between the two behaviors . the wkb approximation",
    "( away from the turning points ) consists of an exponentiated power series in @xmath8 : @xmath9 . \\label{wkbdef}\\ ] ] this paper considers the usual first - order wkb approximation , which retains only the @xmath10 and @xmath11 terms of the expansion .",
    "this approximation is often surprisingly accurate for @xmath8 as large as 1 . for a more detailed exposition of wkb theory ,",
    "see ref .",
    "@xcite .",
    "equations possessing a single turning point are the most straightforward application of wkb theory . without loss of generality ,",
    "translate the dependent variable so that the turning point is at the origin and @xmath12 for @xmath13 . in the dissipative region @xmath13 , which will be called region i",
    ", a simple asymptotic expansion gives the familiar `` wkb formula '' for the exponentially decaying solution",
    "@xmath14^{-1/4}\\exp\\left [ -{1\\over\\epsilon }                            \\int_0^x \\sqrt{q(t)}\\ , dt\\right ] , \\label{wkbi}\\ ] ] where @xmath15 is an undetermined normalization constant . in region ii in the neighborhood of @xmath16 ,",
    "@xmath17 can be replaced by its asymptotic expansion @xmath18 @xmath19 which converts eq .",
    "( [ schrodinger ] ) to an airy equation with solution @xmath20 where @xmath21 is the first type of airy function and the prefactor has been determined by an asymptotic match with eq .",
    "( [ wkbi ] ) .",
    "finally , in region iii with @xmath22 , an analytic continuation of eq .",
    "( [ wkbi ] ) and an asymptotic match to @xmath23 gives @xmath24^{-1/4 }          \\sin\\left [ { 1\\over\\epsilon }          \\int_x^0 \\sqrt{-q(t)}\\ , dt + { \\pi\\over 4}\\right ] . \\label{wkbiii}\\ ] ] remarkably , there exists a single function which uniformly approximates @xmath25 and reduces to the above asymptotic forms in the various limits : @xmath26^{-1/4 } { \\rm ai}\\left [ \\left({3s_0(x)\\over 2\\epsilon}\\right)^{2/3}\\right],\\\\ \\label{langer } & & \\qquad\\qquad s_0(x ) = \\int_0^x \\sqrt{q(t)}\\ , dt.\\nonumber\\end{aligned}\\ ] ] this formula is the basis for all approximations presented in this paper .",
    "for the case of a function with two turning points at @xmath27 and @xmath28 , two single - turning - point solutions can be asymptotically matched to form the general solution , which leads to the eigenvalue condition @xmath29 with @xmath30 a non - negative integer .",
    "this condition typically is used to approximate the energy eigenvalues of a particle in an arbitrary potential well in quantum mechanics .",
    "it is straightforward to apply these expressions to the case of hyperspherical bessel functions .",
    "a review of their relevant properties is presented here ; a more detailed exposition of these functions on which the following discussion is based is given in ref .",
    "the hyperspherical bessel functions @xmath31 are radial eigenfunctions of the covariant laplace operator in spherical coordinates , for spaces of constant curvature : @xmath32 where the index @xmath33 with @xmath34 the spatial curvature , and @xmath35 is the covariant 3-derivative associated with the spatial part of the robertson - walker metric : @xmath36 .",
    "\\label{metric}\\ ] ] in this paper , all physical distances will be expressed in units of the curvature scale , giving @xmath37 for a closed universe , @xmath38 for a critical ( flat ) universe , and @xmath39 for an open universe .",
    "the eigenfunctions @xmath40 , termed `` hyperspherical '' or `` ultraspherical '' bessel functions because they reduce to the usual spherical bessel functions in the case of a flat universe , are very useful because they serve as the analog of fourier modes for cosmological models with non - zero curvature . for a critical density universe with no spatial curvature , @xmath35 is just the usual gradient operator and @xmath41 .",
    "it is convenient to change variables to the radial coordinate @xmath42 defined by @xmath43 ; explicitly , @xmath44 then it is straightforward to demonstrate from eq .",
    "( [ laplace ] ) that the hyperspherical bessel functions satisfy the schrodinger equation @xmath45 u_l^\\beta \\label{ueq}\\ ] ] where @xmath46 .",
    "the hyperspherical bessel functions are normalized so as to match the normalization of @xmath3 in the flat - space limit . for the cases @xmath38 and @xmath39 , the momentum variable @xmath47 can have any positive value , eq .",
    "( [ ueq ] ) has a single turning point for @xmath48 , and the wkb approximation can be applied directly .",
    "the @xmath37 case is more complicated : the spatial sections of the spacetime are compact , resulting in a discrete eigenvalue spectrum for the eigenfunctions .",
    "it is possible to express the closed - universe functions in terms of associated legendre polynomials as @xmath49 this form shows that @xmath40 is periodic in @xmath42 with period @xmath50 . as with spherical bessel functions , @xmath40 is symmetric ( antisymmetric ) around @xmath51 for @xmath2 even ( odd ) ; thus the function is determined by its values on the interval @xmath52 $ ] . requiring @xmath40 to be single - valued gives the condition @xmath53\\phi_l^\\beta(\\cos\\chi ) . \\label{bdrycond}\\ ] ] two conclusions follow immediately : @xmath47 must be a positive integer , and the functions are symmetric ( antisymmetric ) around @xmath54 if @xmath55 is even ( odd ) .",
    "thus the value of @xmath56 must be computed only on the interval @xmath57 $ ] and can be determined for all other values of @xmath42 by symmetry .",
    "it can be demonstrated that @xmath58 and @xmath59 represent gauge modes , not physical perturbations @xcite , so @xmath47 takes integer values of 3 or larger , and @xmath60 follows from eq .",
    "( [ pmnform ] ) .",
    "the hyperspherical bessel functions also satisfy several useful recursion relations which are given in ref .",
    "@xcite . a closed - form expression for @xmath40",
    "can be obtained as @xmath61 derivatives of an elementary function ; it is practicable to use these exact expressions for evaluating the hyperspherical bessel functions up to @xmath62 or 5 . for precise calculation of the functions for larger values of @xmath2 ,",
    "recursion techniques can be used for the open case , in analogy with the miller s method evaluation of bessel functions in ref .",
    ". however , for the closed case , downwards recursion is not always available due to the restriction @xmath63 , so direct integration of eq .",
    "( [ ueq ] ) is better @xcite .",
    "to apply the wkb formalism most effectively , first divide both sides of eq .",
    "( [ ueq ] ) by @xmath64 to obtain eq .",
    "( [ schrodinger ] ) with @xmath65 with @xmath66 and @xmath67 .",
    "turning points @xmath68 are located where @xmath69 note that the @xmath38 and @xmath37 cases each have a single turning point , while the @xmath37 case has a single turning point within the range @xmath57 $ ] .",
    "thus eq .",
    "( [ langer ] ) can be applied directly to each case .",
    "the wkb approximation is an asymptotic series in powers of @xmath8 , which in this case is the inverse of @xmath2 . for larger @xmath2 values ,",
    "the approximation becomes progressively better ; it is also better away from the region of the turning point where the various asymptotic solutions are matched .",
    "as demonstrated below , the approximation is remarkably good even for @xmath70 and 3 .",
    "the wkb approximation offers a great increase in numerical speed because the required integrals can be performed exactly in terms of elementary functions . for the @xmath38 case ,    @xmath71    [ flatqints ]    for the @xmath39 case , defining @xmath72 ,    @xmath73         - { \\pi\\over 2},\\\\ \\int_{\\chi}^{\\chi_0 } \\left({1\\over \\sinh^2 t } - \\alpha^2\\right)^{1/2 } dt    & = & { \\alpha\\over 2}\\tan^{-1 }        \\left({2\\sqrt{(1-w^2)(w^2+\\alpha^2)}\\over 2w^2+\\alpha^2 - 1}\\right )        + \\log\\left({\\alpha\\sqrt{1-w^2}+\\sqrt{\\alpha^2+w^2}\\over                            w^2\\sqrt{1+\\alpha^2}}\\right).\\end{aligned}\\ ] ]    [ openqints ]    and similarly , for the @xmath37 case , defining @xmath74 ,    @xmath75            -{\\alpha\\over 2}\\tan^{-1}\\left({2\\sqrt{(v^2 - 1)(\\alpha^2-v^2 ) }               \\over 2v^2-\\alpha^2 - 1}\\right )        - { \\pi\\over 2},\\\\ \\int_{\\chi}^{\\chi_0 } \\left({1\\over \\sin^2 t } - \\alpha^2\\right)^{1/2 } dt    & = & \\tanh^{-1}\\left[\\alpha        \\left({1-v^2\\over \\alpha^2 -v^2}\\right)^{1/2}\\right ]        - \\log\\left({\\sqrt{1-v^2}+\\sqrt{\\alpha^2-v^2}\\over                            \\sqrt{\\alpha^2 -1}}\\right).\\end{aligned}\\ ] ]    [ closedqints ]    care must be taken to use the correct branch of the inverse tangent functions .    in the closed case , the eigenvalue condition eq .",
    "( [ eigencondition ] ) becomes @xmath76 with @xmath30 an integer , so for a given exact integer value of @xmath47 , the corrected wkb eigenvalue can be obtained by the replacement @xmath77 which is sufficiently accurate for a first - order wkb approximation . if the eigenvalue @xmath47 is not corrected when evaluating the approximate function , the function or its first derivative will be discontinuous at @xmath54 .",
    "the other necessary numerical ingredient is the evaluation of the airy function in eq .",
    "( [ langer ] ) .",
    "if a fast routine is not available , a reasonable approximation is to use the leading asymptotic behavior at large arguments and a taylor series around the origin . with a crossover at @xmath78 and a series including @xmath79 terms",
    ", the residual error in @xmath21 is at the 1% level .",
    "fast routines based on chebyshev polynomial fits or pade expansions are readily obtainable in both fortran and c. note that since the airy function is evaluated for every hyperspherical bessel function , errors in airy function evaluation translate into systematic errors in @xmath80 . using the simple asymptotic approximation to @xmath21 , for example , leads to a systematic 1% error when integrating smooth functions against @xmath80 independent of @xmath2 ; this error is reduced to 0.01% or less when an accurate airy function evaluation is employed @xcite .",
    "figure 1 displays the exact and wkb - approximated spherical bessel functions @xmath81 for @xmath70 and @xmath82 .",
    "the accuracy is very good even for @xmath70 , with an error of 1.5% at the first peak in the @xmath70 case and 0.6% at the first peak in the @xmath82 case . for higher values of @xmath2 , the actual and approximated functions are indistinguishable on the scale of the plot ; by @xmath83 , the first peak is accurate to 0.05% .",
    "as mentioned above , the harmonics for the lowest few @xmath2 values can be evaluated exactly in terms of trigonometric functions .",
    "figures 2 and 3 compare the exact and wkb - approximated hyperspherical bessel functions for open and closed universes , respectively .",
    "the level of accuracy is essentially the same as in the flat case , with approximations for @xmath84 indistinguishable from the exact values on the scales of the plots .",
    "one particular set of closed - universe functions always has a significant error : the lowest eigenvalue corresponding to a given @xmath2 with the unperturbed value @xmath85 .",
    "as shown in figure 4 , the approximate functions have discontinuous derivatives at @xmath54 for all @xmath2 .",
    "the reason is that the turning point @xmath68 is so close to @xmath86 for the lowest eigenvalue that the solution does not have enough room between @xmath68 and @xmath86 to attain its asymptotic behavior away from the turning point , so an asymptotic match around @xmath54 is unsuccessful .",
    "this behavior can be circumvented with an exact form for the lowest eigenfunctions : @xmath87^{1/2 } \\sin^l\\chi\\qquad\\qquad(k=1)\\nonumber\\\\ & \\sim & \\left[2\\pi\\over 2l+1\\right]^{1/4 } \\left[l\\over ( l+1)(2l+1)\\right]^{1/2 } \\left [ 1 + { 9\\over 48l } - { 7\\over 512l^2 } \\right]\\sin^l\\chi , \\qquad\\qquad l\\rightarrow\\infty ; \\label{lowesteigenfcn}\\end{aligned}\\ ] ] the asymptotic expression is good to 0.02% at @xmath70 .",
    "fortunately , the second and higher eigenvalues are not greatly affected by this problem ( see fig .  3 , for example ) .",
    "the above calculations demonstrate that the wkb approximation to hyperspherical bessel functions is highly accurate , with increasing accuracy as @xmath2 becomes larger .",
    "furthermore , the computation of one of the functions at a given value of @xmath42 requires around ten elementary function calls , plus some arithmetic , so the approximation is much faster than evaluation based on recursion methods or integration of eq .",
    "( [ ueq ] ) .",
    "the computation time is also independent of @xmath2 , in marked contrast to other methods , and is completely stable for any values of @xmath2 and @xmath47 .",
    "this approximation will substantially speed the computation of microwave background power spectra in open or closed universes , potentially by an order of magnitude based on rough timings of the cmbfast code @xcite .    a further speedup in evaluating these functions",
    "can be accomplished by precomputing and caching the integrals in eqs .",
    "( [ flatqints ] ) to ( [ closedqints ] ) ; each is a function of the two variables @xmath42 and @xmath88 .",
    "the integrals are very uneventful functions of these variables , and accurate interpolation is possible based on a small number of computed values . with this scheme",
    ", the computational work for a hyperspherical bessel function is reduced to evaluating a power and a sine or exponential in eq .",
    "( [ wkbi ] ) or ( [ wkbiii ] ) , an inverse sine or hyperbolic sine to evaluate @xmath68 , and a small amount of arithmetic .",
    "the uniform wkb approximation presented here is useful for evaluating any functions defined by a second - order differential equation in schrodinger form , especially when speed of evaluation is more important than accuracy to many significant figures .",
    "this is often the case in physics problems , and particularly in the case where a special function is integrated against another function .",
    "if it is impracticable to cache all needed values of the special function , wkb offers a fast , simple , and remarkably accurate alternative .",
    "g.  jungman , m.  kamionkowski , a.  kosowsky , and d.n .",
    "spergel , phys .",
    "lett .  * 76 * , 1007 ( 1996 ) , and phys .",
    "d * 54 * , 1332 ( 1996 ) ; m.  zaldarriaga , d.n .",
    "spergel , and u.  seljak , astrophys .",
    "j. * 488 * , 1 ( 1997 ) ; j.r .",
    "bond , g.  efstathiou , and m.  tegmark , mon .  not .",
    "r.  ast .",
    "soc .  * 291 * , 33 ( 1997 ) ."
  ],
  "abstract_text": [
    "<S> fast and accurate computations of the power spectrum of cosmic microwave background fluctuations are essential for comparing current and upcoming data sets with the large parameter space of viable cosmological models . </S>",
    "<S> the most efficient numerical algorithm for power spectrum calculation , recently implemented by seljak and zaldarriaga , involves integrating sources against spherical bessel functions or , in the cases of a non - flat universe , analogous hyperspherical bessel functions . </S>",
    "<S> evaluation of these special functions usually dominates the computation time in non - flat spatial geometries . </S>",
    "<S> this paper presents a highly accurate and very fast wkb approximation for computing hyperspherical bessel functions which will greatly increase the speed of microwave background power spectrum computations in open and closed universes . </S>"
  ]
}