{
  "article_text": [
    "the control of spin systems by magnetic fields has a great potential for applications in nuclear magnetic resonance ( nmr ) @xcite .",
    "an example is given by the preparation of a well - defined initial state such as the saturation process which consists in vanishing the magnetization vector of a sample by using an adequate pulse sequence @xcite . in the setting of nmr spectroscopy and imaging ,",
    "the saturation control can be used for solvent suppression or contrast enhancement .",
    "different approaches have been proposed up to date to solve this control problem .",
    "they extend from intuitive schemes such as the inversion recovery ( ir ) method @xcite to more elaborate pulse sequences based on geometric optimal control theory @xcite or optimization schemes @xcite . in a recent letter @xcite",
    ", we showed that a gain of 60 % in the duration of the saturation process can be reached when using the time - optimal solution with respect to the ir one .",
    "in general , however , analytic solutions as derived in @xcite are not available , and easily accessible numerical methods are required for the control of complex and realistic systems . here",
    ", we investigate such a method and demonstrate its efficiency through a comparison with time - optimal analytic solutions @xcite . roughly speaking",
    ", the present method is an extension of local @xcite or lyapunov control @xcite , in terms of a so - called lyapunov function @xmath0 over the state space which is minimum ( or maximum ) for the target state . in original lyapunov control theory , a control field that ensures the monotonic decrease of @xmath0",
    "is constructed with the help of the first time derivative @xmath1 of @xmath0 . under well established general conditions on the hamiltonian ( see e.g. @xcite for a recent review ) , the system converges asymptotically towards the target state .",
    "this approach has been largely explored in quantum mechanics both from the physical @xcite and mathematical points of view @xcite .    in this paper",
    ", we will employ a target functional whose first time derivative does _ not _ depend on the available control fields . in this case ,",
    "an inspection of @xmath1 does not help to identify suitable control fields and standard local control theory can not be used .",
    "therefore , one has to resort to the second time derivative @xmath2 , which allows the design of control pulses that speed up the increase of @xmath0 @xcite . on the first sight",
    ", one might assume that loosing control of @xmath1 should be a disadvantage .",
    "however , it turns out that it also yields significant advantages : since control fields typically induce unitary dynamics , the independence of @xmath1 on the control field implies the invariance of @xmath0 under the corresponding unitary group .",
    "consequently , the function @xmath0 is constant for a continuous manifold of quantum states within which the control can induce dynamics . by not enforcing a given path through state space , but leaving the systems the opportunity to find its optimal path with a direction restricted only by the manifolds of constant @xmath0 permits to not exert unnecessary control , but to leave the system substantial freedom to find its optimal path .",
    "also , @xmath2 allows to predict the dynamics of @xmath0 for longer intervals than @xmath1 , since it extrapolates for two infinitesimal time steps rather than one .",
    "this reduces the time - local character of lyapunov control , and the efficiency of this generalized approach will be illustrated by different numerical simulations in this work .",
    "the paper is organized as follows",
    ". section [ sec2 ] deals with the description of the system and of the control problem .",
    "the description of the generalized local control approach and of the time - optimal one is done in sec .",
    "different numerical results are finally presented in sec .",
    "[ sec4 ] for relevant situations in nmr .",
    "conclusion and prospective views are given in sec .",
    "the state of a spin 1/2 particle in an nmr experiment is most conveniently expressed by its bloch vector with components @xmath3 , @xmath4 and @xmath5 .",
    "if the radio - frequency magnetic field is in resonance with the spin , the bloch equations are given by : @xmath6 where @xmath7 and @xmath8 are the two components of the control field @xmath9 , @xmath10 and @xmath11 are two relaxation rates characterizing the incoherent process due to the interaction with the environment and @xmath12 is the thermal equilibrium magnetization . since the maximum amplitude @xmath13 that the control fields @xmath14 can adopt induces a natural time - scale , it is convenient to introduce the scaled variables @xmath15 since , in addition , the equations of motions are invariant under rotations around the @xmath16-axis",
    ", we can restrict the entire dynamics to the ( @xmath17)-plane by assuming that @xmath18 .",
    "doing so , eqs .",
    "( [ blocheq ] ) reduce to @xmath19 in terms of the scaled and scalar control field @xmath20 .",
    "in the following we will take the thermal equilibrium state with @xmath21 and @xmath22 as initial state . in terms of the scaled magnetization",
    ", this implies that the initial state is located at the north pole of the scaled bloch sphere .",
    "as mentioned below , the goal of the control is to bring the scaled bloch vector to the center of the sphere in minimum time with the constraint @xmath23 on the control field .",
    "since our goal is to reach a vanishing magnetization vector , which is equivalent to a maximum entropy state , we can choose any entropy - like functional as target .",
    "we consider the linear entropy defined as @xmath24 reaching a maximum entropy in minimum time , i.e. as quickly as possible , can be done by choosing @xmath25 such that the temporal increment of @xmath26 is maximized . as anticipated above , the time derivative @xmath27 of @xmath26 is independent of @xmath25 , which is a direct consequence of the invariance of @xmath26 under coherent dynamics , as generated by @xmath25 . we , therefore , have to inspect the curvature of @xmath26 , which essentially contains the information of how the impact of relaxation changes under the coherent dynamics . in the present case , it reads @xmath28 where @xmath29 denotes the curvature in the absence of a control field . since maximization of the curvature results in maximally fast increase of @xmath30 , which in turn implies an acceleration of the increase of entropy , we will choose , at any instance of time , @xmath25 such that it maximizes the curvature .",
    "given that the modulus of @xmath25 is bounded by @xmath31 , this leads to the choice @xmath32 if @xmath33 , and @xmath34 if @xmath35 .",
    "as long as @xmath36 is finite , this implies that @xmath25 is constant over a finite period of time so that the equations of motion can be integrated straightforwardly .",
    "care is , however , necessary if @xmath37 . in this case , one has to distinguish between stable solutions , where the control fields ensure that the condition @xmath37 is preserved and unstable conditions , where the control , or the natural dynamics ensures that the condition @xmath37 is satisfied only for an isolated point in time .",
    "the latter case is realized for @xmath38 and it corresponds to @xmath39 ( _ i.e. _ no control pulse ) , the system remaining in the line of equation @xmath38 to follow its natural dynamics .",
    "the former case is realized for @xmath40 and requires some more care .",
    "let us , therefore , step back for a moment from the framework of differential equations and discuss eqs .",
    "( [ eqcont ] ) in terms of finite time steps .",
    "if we start out with @xmath41 than the value of @xmath36 will increase in time since we were assuming the condition @xmath37 to be stable . due to the finite time steps , however , we might end up in a situation where @xmath42 .",
    "now , in turn , @xmath36 will decrease in time , so that we risk to end up in rapid changes of sign of @xmath36 , which results in a rapidly changing sign of the control pulses . decreasing",
    "the size of the time steps will decrease the size of the fluctuations of @xmath36 and increase the frequency with which the control pulse changes sign .",
    "once this frequency has exceeded all system frequencies sufficiently , we can replace the rapidly oscillating pulse by a time - averaged pulse @xmath43 where @xmath44 is some function , like a gaussian , that is positive in some finite domain around @xmath45 , and that decays sufficiently fast outside this domain .",
    "in the limit of infinitesimal time steps , the fluctuation of @xmath36 will vanish , and @xmath46 is the pulse that has to be applied to preserve the condition @xmath37 . the control @xmath46 needs to be chosen such that @xmath47 this implies that the local pulse solution can be written as @xmath48 note that @xmath49 when @xmath50 which defines a limit of admissibility due to the bound on the control given by @xmath51 this means that for smaller values of @xmath52 , the system can not follow this horizontal line and a constant control @xmath53 has to be used . together with eq .",
    "( [ eqcont ] ) , the equation of motion for the @xmath52-component with @xmath54 reads consequently as @xmath55 which has the solution @xmath56 where @xmath57 is the initial @xmath52- coordinate on the horizontal axis .",
    "one deduces that @xmath46 is determined through eq .",
    "( [ eq : ubar ] ) , and , @xmath46 in turn , defines @xmath58 uniquely .",
    "one finally arrives at : @xmath59 and the complete solution is a concatenation of these pieces , as sketched in fig .",
    "[ fig : vectors ] . in the following",
    ", the control fields of maximum intensity will be called regular or bang , while those such that @xmath60 will be said to be singular .    $ ] of the bloch vector in the @xmath52-@xmath16-plane in the presence of local control as given in eqs .",
    "( [ eq : sol1])-([eq : sol4 ] ) .",
    "the dashed arrow depicts the evolution along the line @xmath37 according to eq .",
    "( [ eq : sol4 ] ) ; the dotted arrow corresponds to free evolution according to eq .",
    "( [ eq : sol3 ] ) . the curved , solid arrows correspond to eqs .",
    "( [ eq : sol1 ] ) and ( [ eq : sol2 ] ) . ]    using this material , we can follow the dynamics starting from the thermal equilibrium ( @xmath61 ) .",
    "this point is an unstable fixed point of the dynamics , _",
    "i.e. _ following the above prescription one should not add any control pulse , the state being stationary . any small deviation , however , will indicate that a finite control field needs to be applied .",
    "we will , therefore , begin with an infinitesimally displaced initial condition @xmath62 , @xmath63 .",
    "then , according to eq .",
    "( [ eq : sol2 ] ) the system is driven with maximum intensity @xmath34 until the bloch vector reaches a point with @xmath37 . at this point",
    ", the control field has to be changed such as to satisfy eq .",
    "( [ eq : sol4 ] ) and the bloch vector moves along the line @xmath37 until its @xmath52-component vanishes .",
    "once , this is achieved , the spin will relax to the target state without any control field according to eq .",
    "( [ eq : sol3 ] ) . for the moment",
    ", we have been assuming that the control field can be chosen strong enough to ensure that the spin remains on the horizontal @xmath37- trajectory . here , it is not the case due to the limitation in the field amplitude , a constant pulse according to eq .",
    "( [ eq : sol2 ] ) has therefore to be applied when @xmath64 along the horizontal line .      in this section",
    ", we briefly recall the tools of optimal control theory based on the application of the pontryagin maximum principle ( pmp ) .",
    "the reader is referred to @xcite for a general application to dissipative quantum systems and to @xcite for examples in nmr .",
    "the first step of this method consists in introducing the pseudo - hamiltonian @xmath65 defined by @xmath66 where @xmath67 and the vectors fields @xmath68 and @xmath69 have respectively the components @xmath70 and @xmath71 .",
    "the vector @xmath72 is the adjoint state of coordinates @xmath73 .",
    "the pmp states that the optimal trajectories are solutions of the system @xmath74 introducing the switching function @xmath75 , the pmp leads to two types of situations , the regular and the singular ones . in the regular case , @xmath76 or vanishes in an isolated point while in the singular case @xmath77 is zero on a time interval . in the former situation , the corresponding control field",
    "is given by @xmath78 $ ] .",
    "in the latter case where @xmath79 , we introduce the vector @xmath80 which satisfies @xmath81 .",
    "the singular trajectories belong to the set of points where @xmath82 is parallel to @xmath69 , i.e. to the points such that @xmath83 .",
    "a straightforward computation leads to the two lines of equation @xmath38 and @xmath84 @xcite , which shows that the singular set is the same in the local control and optimal approaches .",
    "the corresponding optimal singular control is by definition the field such that the dynamics remains on the singular lines .",
    "still this field is identical to local singular control . at this point , it is important to note that the trajectories given by the maximization of @xmath65 are only extremal solutions , i.e. candidates to be optimal .",
    "other tools like those introduced in @xcite have to be used to get optimality results and to select among extremal trajectories the ones which are effectively optimal .",
    "as a specific example to illustrate the efficiency of these two optimization schemes , we consider the control problem of a spin 1/2 particle coupled to a thermal environment as analyzed and experimentally implemented in ref .",
    "@xcite . in this section",
    ", we will consider two examples characterized by different relaxation parameters .",
    "in the first case , we have @xmath85 ms and @xmath86 ms which leads , with a maximum amplitude @xmath87 hz , to @xmath88 and @xmath89 . in the second situation ,",
    "we choose @xmath90 ms and @xmath86 ms which gives with the same maximum amplitude @xmath91 and @xmath89 .",
    "let us compare the time - optimal solution as computed in @xcite with the solutions obtained with the generalized local control theory .",
    "the numerical results are represented in fig .",
    "[ fig2 ] and [ fig3 ] for the first and second cases , respectively . in the two cases , the time optimal solution is composed of two bang pulses of maximum amplitude @xmath31 and two singular controls : starting from the initial point of coordinates ( @xmath38,@xmath92 )",
    ", the first bang pulse drives the spin up to the horizontal singular line where @xmath36 vanishes .",
    "the consecutive singular control ensures that the @xmath16-component remains constant until @xmath93 , when the second bang pulse is applied .",
    "the position @xmath94 is computed to ensure that the switching function @xmath95 and its first derivative @xmath96 remain continuous along the optimal sequence .",
    "the values of @xmath94 are equal to -0.1605 and -0.1356 in the first and second cases .",
    "the second bang pulse increases the @xmath16-component of the magnetization vector until its @xmath52-component vanishes .",
    "the final part of the optimal sequence is a zero control along the vertical singular axis @xmath38 which allows to reach the target state . with the chosen relaxation parameters @xmath97 and @xmath98 , the time - optimal sequence has a duration of 0.95050 and 0.97 in dimensionless units [ defined above in eq .",
    "( [ eq : scaled_time ] ) ] in the first and second cases .",
    "when there is no bound on the control , the second bang does not exist and the optimal sequence is formed by a bang arc followed by the two singular trajectories along the horizontal and vertical lines .",
    "the solution of the generalized local control is very similar . exactly like the time - optimal solution",
    ", it begins with a bang pulse followed by a singular pulse ensuring that @xmath36 vanishes , but this pulse is maintained longer than in the time - optimal solution . only at @xmath99 and @xmath100",
    "where @xmath101 , the limited control intensity does not permit to maintain the condition @xmath37 and a bang pulse has to be applied .",
    "in the unbounded situation , note that the local and optimal solutions are identical . in the bounded case , if the second bang arc intersects the vertical @xmath16- axis , the dynamics relaxes without any control until its bloch vector vanishes . in the case of fig .",
    "[ fig2 ] , this leads to an overall control duration of 0.95098 which is slightly larger than the one of the time - optimal solution , the difference is of the order of @xmath102 .",
    "whereas local control does not reproduce the time - optimal solution exactly , we can conclude in this case that the longer duration of the former is negligible for all practical purposes .",
    "this conclusion is not true for all the values of the relaxation parameters . in particular in fig .",
    "[ fig3 ] , since there is no intersection between the second bang pulse and the @xmath16- axis , we observe that the local control approach does not manage to reach the target , the minimum distance being equal to @xmath103",
    ".    figure [ fig4 ] gives a third example where the initial point of the dynamics is the south pole of the bloch sphere , the relaxation rates being the ones of the first example .",
    "if we assume that the initial point is exactly on the @xmath16- axis then the local solution consists of letting act the relaxation with @xmath39 up to the center of the bloch ball .",
    "since this axis is unstable , any small deviation from this point will induces a bang control of amplitude @xmath104 up to the horizontal singular line .",
    "a second bang pulse is applied when the limit of admissibility of the control is reached and a zero control finally used up to the target state .",
    "the optimal control sequence is quite similar , except for the second bang which is applied earlier than in the local control strategy .",
    "we observe in fig .",
    "[ fig4 ] that the local and the optimal solutions are very close to each other with a control duration respectively of 0.8758 and 0.8753 , while if @xmath39 this time is of 1.3861 .",
    "-plane for the local control trajectory ( blue or black ) and the optimal solution ( red or gray ) with decoherence - times @xmath85 ms and @xmath86 .",
    "the insert is a zoom of the trajectories near the singular horizontal line .",
    "the cross indicates the position of the limit of admissibility of the control along the horizontal axis .",
    "the bottom panel displays the corresponding control fields .",
    "[ fig2 ] ]     but with decoherence - times @xmath90 ms and @xmath86.[fig3 ] ]     ms and @xmath86 as in fig .",
    "[ fig2 ] , but for an initial state corresponding to the south pole of the bloch sphere.[fig4 ] ]",
    "the close - to - optimal performance of the generalized time - local control pulses reflect the potential of this new approach which can efficiently replace the standard local control design when this strategy can not be used .",
    "whereas we have seen that sufficiently strong control typically permits to reach the target , it can also be missed with weak control fields .",
    "this opens up the general question of convergence in the present generalized framework of lyapunov control . in standard lyapunov control theory",
    "there is a well - established theory of convergence , based , e.g. , on the concept of the lasalle invariant set on which the derivative of the lyapunov function vanishes @xcite .",
    "in addition , necessary and sufficient conditions on the hamiltonian of the system have been derived to ensure the converge towards the target state @xcite .",
    "given the success of these tools for standard lyapunov control theory it seems within reach to also develop rigorous concepts to predict convergence properties of the present extension .",
    "+   + * aknowledgment * s.j.g . acknowledges support from the dfg ( gi 203/6 - 1 ) , sfb 631 .",
    "s. j. g. thank the fonds der chemischen industrie . f.m .",
    "gratefully acknowledges support of the european research council ( 259264 ) .",
    "+   +            skinner t. e. , reiss t. o.,luy b. , khaneja n. and glaser s. j. 2003 j. magn . reson . *",
    "163 * , 8 ; skinner t. e. , reiss t. o. , luy b. , khaneja n. and glaser s. j. 2004 j. magn .",
    "reson . * 167 * , 68 ; kobzar k. , skinner t. e. , khaneja n. , glaser s. j. and luy b. 2004 j. magn . reson . * 170 * , 236 ; skinner t. e. , reiss t. o. , luy b. , khaneja n. and glaser s. j. 2005 j. magn",
    ". reson . * 172 * , 17 ; skinner t. e. , kobzar k. , luy b. , bendall r. , bermel w. , khaneja n. and glaser s. j. 2006 j. magn . reson . * 179 * , 241 ; gershenzon n. i. , kobzar k. , luy b. , glaser s. j. and skinner t. e. 2007 j. magn . reson . * 188 * , 330 .                mirrahimi m. and turinici g. 2005 automatica * 41 * , 1987 ; beauchard k. , coron j .-",
    "m . , mirrahimi m. and rouchon p. 2007 system control lett .",
    "* 56 * , 388 ; mirrahimi m. and van handel r. 2007 siam j. control optim . * 46 * , 445      zhu w. , botina j. and rabitz h. 1998 j. chem",
    "* 108 * , 1953 ; maximov i. i. , salomon j. , turinici g. and nielsen n. c. 2010 j. chem .",
    "132 * , 084107 ; sugny d. , kontz c. , ndong m. , justum y. and desouter - lecomte m. 2006 phys . rev .",
    "a * 74 * , 043419 ; sugny d. , ndong m. , lauvergnat d. , justum y. and desouter - lecomte m. 2007 j. photochem .",
    "a * 190 * , 359 ; lapert m. , tehini r. , turinici g. and sugny d. 2008 phys .",
    "a * 78 * , 023408 ( 2008 ) ; lapert m. , tehini r. , turinici g. and sugny d. 2009 phys . rev .",
    "a * 79 * , 063411      sugny d. , kontz c. and jauslin h. r. 2007 phys .",
    "a * 76 * , 023419 ; bonnard b. and sugny d. 2009 siam j. on control and optimization , * 48 * , 1289 ; bonnard b. , chyba m. and sugny d. 2009 ieee transactions on automatic control , * 54 * , 11 , 2598 ; sugny d. and kontz c. 2008 phys .",
    "a * 77 * , 063420"
  ],
  "abstract_text": [
    "<S> we show how to apply a generalization of local control design to the problem of saturation of a spin 1/2 particle by magnetic fields in nuclear magnetic resonance . </S>",
    "<S> the generalization of local or lyapunov control arises from the fact that the derivative of the lyapunov function does not depend explicitly on the control field . </S>",
    "<S> the second derivative is used to determine the local control field . </S>",
    "<S> we compare the efficiency of this approach with respect to the time - optimal solution which has been recently derived using geometric methods . </S>"
  ]
}