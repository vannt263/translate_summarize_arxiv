{
  "article_text": [
    "quantum information   is moving towards practical applications , promising next - generation quantum technologies with performances well beyond the state of the art of the current classical infrastructure . in these advances ,",
    "quantum communications play a central role .",
    "the most developed field is certainly quantum cryptography and , particularly , quantum key distribution ( qkd )  @xcite where two remote authenticated parties are allowed to generate unconditionally secure keys .",
    "indeed this field has been the first to be extended to simple network implementations  @xcite , with end - to - end  @xcite prototypes at the metropolitan scale  @xcite .",
    "quantum teleportation  @xcite is another remarkable protocol of quantum communication .",
    "once two remote parties share enough entanglement , they can teleport quantum information from one location to another by means of suitable local operations ( los ) and classical communication ( cc ) , briefly called loccs .",
    "this procedure may form the backbone of a future quantum internet  @xcite , where quantum information is being teleported between nodes and then subject to local quantum processing . in this",
    "regard , hybrid approaches which mix different substrates are the most promising  @xcite .",
    "the construction of a quantum network not only aims at connect and deliver quantum services to many users , but also addresses a precise physical issue : extending the range of the quantum communication .",
    "in fact , quantum signals are very fragile to loss and noise , which means that the maximum distance of any direct point - to - point quantum communication turns out to be limited . as shown in ref .",
    "@xcite , the maximum rates at which two parties can distribute secret keys , distill entanglement , or transmit quantum information over a lossy channel with transmissivity @xmath0 are all equal to @xmath1 corresponding to about @xmath2 bits per channel use at high loss .",
    "this two - way assisted capacity is achieved by using the most powerful quantum protocols , where the remote parties exploit unlimited two - way cc and use adaptive los , also known as adaptive loccs  @xcite .    to overcome these limitations",
    ", we need to design a multi - hop quantum network where we exploit the assistance of quantum repeaters  @xcite .",
    "the advantage of introducing a quantum relay can be explained with a simple example .",
    "start with an optical fiber with transmissivity @xmath0 between alice and bob .",
    "suppose that its two - way capacity @xmath3 is zero or too low .",
    "then , we can split the fiber in two identical parts and introduce charlie as a middle quantum repeater .",
    "the two fiber connections are now lossy channels with higher transmissivities , both equal to @xmath4 .",
    "this means that the quantum communication in the single links , from alice to charlie and from charlie to bob , can both occur at the capacity value @xmath5 . combining the independent point - to - point outputs , e.g. ,",
    "composing keys or swapping entanglement , the higher value @xmath6 becomes an achievable rate for the entire repeater - assisted communication between alice and bob .",
    "we may call this strategy point - to - point composition .",
    "this is the basic idea .",
    "but can we do even better than this simple strategy and further increase the rate ? while @xmath6 is certainly an achievable performance , it is still unknown whether or not this is also the maximum rate achievable with the quantum repeater . in fact , we may consider a more general and powerful network protocol , where each transmission of a quantum system , occurring through each link , is assisted by multipartite adaptive loccs where all the parties are involved . in the previous basic example",
    ", this means that alice , bob and charlie may optimize the process by using unlimited and collective two - way ccs , one with each other , and performing real - time adaptive los on their quantum systems before and after each quantum transmission through the links .    in our manuscript",
    "we show that this general network protocol does not outperform the basic strategy based on the point - to - point composition .",
    "in other words , we show that @xmath6 is indeed the maximum performance allowed by quantum mechanics , i.e. , it provides the capacity of the lossy quantum communication assisted by a single repeater .",
    "most importantly , we prove that suitable generalizations of this fundamental result hold for communication scenarios of increasing complexity , starting from a linear chain of quantum repeaters , and ending with a quantum network of generic topology , assuming single - path or multi - path routing strategies .    using new tools from quantum information theory ,",
    "we show how certain quantum networks can be reduced to a tensor - product representation , where quantum channels are replaced by their choi matrices . exploiting this choi representation  and suitable entanglement cuts of these quantum networks",
    ", we can derive simple upper bounds for their end - to - end capacities in terms of the relative entropy of entanglement . under the most relevant decoherence models , including the case of a lossy bosonic environment , we determine achievable rates which coincide with these upper bounds , therefore establishing simple formulas for all the end - to - end capacities . in particular , we show that the optimal capacity - achieving protocols are given by combining the basic point - to - point composition strategy with classical routing algorithms which solve the widest path problem ( for single - path routing ) and the maximum flow problem ( for multi - path routing ) . in this way , we extend the widest path problem and the max - flow min - cut theorem to quantum communications .",
    "the manuscript has the following structure .",
    "we discuss our main results in sec .",
    "[ generalsection ] , which is accessible to a general audience .",
    "full details are provided in the subsequent technical sections , where we first give preliminary tools ( sec .",
    "[ secprelimi ] ) and then we show complete proofs for repeater chains ( sec .  [ secrepeaters ] ) and quantum networks ( secs .  [ secnetworks]-[secdistillablenet ] ) . finally , sec .",
    "[ secconclusions ] is for conclusions and discussions .",
    "in our work , we study the capacities for quantum and private communication between two end - points of a repeater chain and , more generally , a quantum network .",
    "we use the short - hand notation @xmath7 for the generic end - to - end capacity .",
    "this is the ultimate rate which is achievable in an adaptive network protocol where each system transmission through each quantum channel is assisted by the most general network loccs , i.e. , unlimited two - way ccs and real - time adaptive los involving all the parties . depending on the specific task of the protocol , i.e. , quantum communication , entanglement distillation or key generation , the generic capacity @xmath7 may represent a quantum capacity ( @xmath8 ) , an entanglement distillation capacity ( @xmath9 ) or a secret - key agreement capacity ( @xmath10 ) .    because of the feedback among all the parties and the real - time optimization of the channel inputs , the previous capacities are generally hard to compute , especially if we do not consider a direct point - to - point communication but more complex network scenarios .",
    "despite such difficulties , our methodology turns out to be successful for the most relevant models of noise and decoherence for continuous - variable ( cv ) systems , i.e. , bosonic modes , and discrete - variable ( dv ) systems , i.e. , qubits or qudits .    for the converse part",
    ", we generalize the reduction method of ref .",
    "@xcite which combines teleportation stretching with the use of the relative entropy of entanglement ( ree )  @xcite .",
    "in particular , teleportation stretching  @xcite allows us to reduce a quantum network into a tensor - product representation , where channels are replaced by their choi matrices .",
    "crucial for this generalization is use of entanglement cuts  which allow us to further simplify this choi representation and derive simple upper bounds for the end - to - end capacity . for the achievability part , we start from the observation that the simple strategy based on point - to - point composition provides an achievable rate . combining this observation with tools for classical networks , we can establish achievable lower bounds in a variety of situations .",
    "showing coincidence with the upper bounds allows us to establish the end - to - end capacities in chains or networks whose connections are modeled by the most fundamental quantum channels .",
    "as already mentioned , a starting tool for our investigation is teleportation stretching  @xcite .",
    "this technique can be applied to any quantum channel that suitably commutes  with teleportation , in which case the channel is called stretchable . for a stretchable channel",
    ", the feed - forward correction operation of quantum teleportation  @xcite can equivalently be performed at the input or at the output .",
    "the reason is because the random unitaries , generated by teleportation at the input , are mapped into output unitaries by the channel  @xcite , so that they can be corrected after transmission .",
    "such a feature is common to many channels in both cv and dv settings , including bosonic gaussian channels and qubit pauli channels . by exploiting this teleportation - covariance property",
    ", we can reduce the complexity of any point - to - point adaptive protocol implemented over these channels .",
    "in fact , assume that alice and bob possess local ( countable ) ensembles of quantum systems , @xmath11  and @xmath12 , prepared in some initial state @xmath13 .",
    "they may perform @xmath14 transmissions through a stretchable channel @xmath15 and use adaptive loccs to map their initial state into an output @xmath16 which closely approximates some pre - established target state .",
    "for instance , the latter may be a maximally entangled state in a protocol of entanglement distillation , or a private state  @xcite in a protocol of key generation . according to ref .",
    "@xcite , alice and bob s output state can be written as @xmath17 where @xmath18 is the choi matrix of the channel  @xcite and @xmath19 is a trace - preserving locc .",
    "then , the suitable combination of this choi decomposition with the properties of the ree allows us to bound the two - way capacity @xmath20 , @xmath9 or @xmath10 of any stretchable channel via a simple and computable one - shot quantity .",
    "in fact , we may write  @xcite @xmath21 where @xmath22 is called the entanglement flux  of the channel and is defined as the ree of its choi matrix .    remarkably , there are stretchable channels for which the entanglement flux is achieved by applying one - way distillation protocols to their choi matrices , i.e. , @xmath23 .",
    "these channels are called distillable  and their two - way capacities are all identical and given by  @xcite@xmath24 the family of distillable  channels is wide and includes lossy bosonic channels , quantum - limited amplifiers , dephasing and erasure channels in arbitrary dimension  @xcite . using eq .",
    "( [ preveq ] ) , ref .",
    "@xcite computed analytical formulas for the two - way capacities of all such distillable channels . a detailed review of these results for point - to - point quantum communications are given in sec .  [ secprelimi ] .",
    "the previous ree+teleportation  method  @xcite is here suitable generalized and applied to network quantum communications .",
    "let us start by discussing an arbitrary linear chain of @xmath25 quantum repeaters , labeled by @xmath26 .",
    "this is characterized by an ensemble of @xmath27 quantum channels @xmath28 describing the sequence of transmissions @xmath29 between the two end - points @xmath30 and @xmath31 ( see fig .",
    "[ intropic ] ) .",
    "we may define the entanglement flux of the chain as the minimum of the fluxes @xmath32 for a chain of stretchable channels @xmath28 , we find that the repeater - assisted capacity for the two end - points of the chain , denoted by @xmath33 , must satisfy the bound @xmath34 which is a direct generalization of eq .",
    "( [ cmax ] ) .",
    "quantum repeaters @xmath35 between the two end - points , alice @xmath30 and bob @xmath31 .",
    "the chain is connected by an ensemble of @xmath27 quantum channels @xmath36 .",
    "the chain is called stretchable ( distillable ) if all the channels are stretchable ( distillable).,scaledwidth=48.0% ]    a sketched proof goes as follows .",
    "after @xmath14 adaptive uses of the chain , alice and bob s output state can be written as @xmath37 , where @xmath38 is the choi matrix of channel @xmath39 and @xmath40 is a trace - preserving locc .",
    "up to this locc , the chain @xmath41 can therefore be represented by the tensor - product of choi matrices @xmath42 .",
    "let us now perform a cut @xmath43  in the chain so to disconnect channel @xmath39 between repeater @xmath44 and @xmath45 .",
    "we may extend the two end - points , so that the extended alice  includes all the repeaters @xmath46  and the extended bob  all the others @xmath47 .",
    "performing teleportation stretching with respect to the point - to - point link @xmath39  between the extended parties leads to @xmath48 for some suitable locc @xmath49 .",
    "compare eq .",
    "( [ plobchaindeco ] ) with previous eq .",
    "( [ plobdecomposition ] ) . the procedure can be repeated for any cut @xmath43 .",
    "computing the ree on the output , this leads to @xmath50 for any @xmath43 . by taking the minimum over @xmath43",
    ", we get eq .",
    "( [ chainboundpp ] ) .",
    "see sec .",
    "[ secrepeaters ] for a more detailed proof .",
    "@xmath51    in the case of a repeater chain connected by distillable channels , we can immediately show that the upper bound @xmath52  is achievable .",
    "in fact , for each distillable channel @xmath39 , we may write @xmath53 , so that the entanglement flux of the chain becomes @xmath54 .",
    "then , the point - to - point composition strategy assures that an achievable rate @xmath55 for the two end - points is just given by the minimum among the single - link capacities , i.e. , @xmath56 . for this reason",
    ", we may write@xmath57 in other words , the repeater - assisted capacity of a distillable chain is equal to the minimum two - way capacity that we may find among the channels in the chain .",
    "let us specify the previous result for the important scenario of optical and telecom quantum communications , where the most important type of decoherence is loss . in this setting",
    ", we consider a chain of repeaters which are connected by lossy channels , with arbitrary transmissivities @xmath58 and two - way capacities @xmath59 , where @xmath3 is given in eq .",
    "( [ plobbound ] ) . for the lossy chain ,",
    "we can then write @xmath60 thus , the minimum transmissivity within the chain characterizes the ultimate rate for repeater - assisted lossy quantum communications , for all the crucial tasks of key generation ( qkd ) , entanglement distillation , and transmission of quantum information .",
    "corresponding simple formulas are derived for the repeater - assisted capacities of the other distillable channels , as thoroughly discussed in sec .",
    "[ secrepeaters ] . according to eq .",
    "( [ eqlossy ] ) , if we are given a long optical fiber with total transmissivity @xmath0 , the optimal way in which we may distribute @xmath25 quantum repeaters along the line is taking them to be equidistant , so that each of the @xmath27 links will have exactly the same transmissivity @xmath61{\\eta}$ ] . assuming high - loss in each link , we can see that the repeater - assisted capacity scales as @xmath62{\\eta}$ ]  bits per chain use .",
    "this establishes the ultimate rate - loss scaling in repeater - assisted quantum optical communications .",
    "further discussions are provided in sec .",
    "[ secrepeaters ] .",
    "in general , our work considers the scenario of a quantum communication network .",
    "this can be represented as an undirected finite graph  @xcite @xmath63 , where @xmath64 is the set of points of the network and @xmath65 is the set of all edges .",
    "each point @xmath66 is associated with a local countable ensemble of quantum systems @xmath67 that are used for the quantum communication ( to simplify notation , we identify a point with its local ensemble @xmath68 ) .",
    "two points @xmath69 * * and * * @xmath70 are connected by an edge @xmath71 if there is a quantum channel @xmath72 between them .",
    "this channel is memoryless and can be forward or backward .",
    "two points may have multiple undirected edges , each edge corresponding to each channel present ( e.g. , they may have both forward and backward channels ) .    by definition ,",
    "a route is an undirected path between the two end - points , alice @xmath11 and bob @xmath12 .",
    "this is specified by a sequence of edges and may be denoted with the notation @xmath73 . without losing generality , we may consider simple paths only , i.e. , paths that are void of cycles .",
    "the two end - points are connected by an ensemble of possible routes @xmath74 , with the generic route @xmath75 corresponding to the transmission through a sequence of quantum channels @xmath76 .",
    "note that different routes may have collisions , i.e. , repeaters and channels in common .",
    "see fig .",
    "[ diamondf ] for an example .    , with end - points @xmath77 ( alice ) and",
    "@xmath78 ( bob ) .",
    "two points @xmath69 and @xmath70 are connected by an edge @xmath79 if there is an associated quantum channel @xmath80 .",
    "there are four ( simple ) routes : @xmath81 , @xmath82 , @xmath83 , and @xmath84 . as an example",
    ", route @xmath85 involves the transmission through the sequence of quantum channels @xmath86 which is defined by @xmath87 , @xmath88and @xmath89 . * sequential or single - path routing*. each use of the network corresponds to using a single route @xmath75 between the two end - points , with some probability @xmath90 . * * parallel or multipath routing .  * *",
    "quantum systems are transmitted from alice to bob through a sequence of multicasts , such that each edge of the network is used once in each end - to - end transmission . in this example",
    ", alice simultaneoustly communicates with repeaters @xmath91 and @xmath92 , which is denoted by @xmath93 .",
    "then , repeater @xmath91 may communicate with repeater @xmath92 and bob @xmath94 , i.e. , @xmath95 .",
    "finally , repeater @xmath92 may communicate with bob , i.e. , @xmath96 .",
    "another possible multipath routing is @xmath97 , @xmath98 and @xmath99.,scaledwidth=45.0% ]    in general , we may consider two different and basic types of routing through the quantum network : sequential or parallel . in a sequential or single - path routing ,",
    "the two end - points transmit the quantum systems through a single route for each use of the network .",
    "this process can be stochastic , i.e. , route @xmath75 may be chosen with some probability @xmath90 . in a parallel or multi - path routing ,",
    "the two end - points exploit multiple paths for each use of the network .",
    "this broadband use  of the quantum network can be realized through a suitable sequence of multicasts , where each point exchanges quantum systems simultaneously with several neighbor points , in such a way that each edge of the network is exploited .",
    "see fig .",
    "[ diamondf ] for an example , with full details being available in sec .",
    "[ secnetworks ] .",
    "let us start by describing the first case . in a sequential protocol",
    ", the whole network is initialized by means of a preliminary network loccs , where all the points communicate with each other via unlimited two - way ccs and perform adaptive los on their local quantum systems . with some probability , alice exchanges a quantum system with some repeater @xmath69 , followed by a second network locc ; then repeater @xmath69 exchanges a quantum system with another repeater @xmath70 , followed by a third network locc and so on , until bob is reached through some route . for large @xmath14 uses of the network",
    ", there will be a probability distribution associated with the route ensemble @xmath100 , with the generic route @xmath75 being used @xmath101 times .",
    "alice and bob s output state @xmath102 will asymptotically approximate some pre - established target state , which depends on the task of the protocol . by optimizing over the network loccs and the sequential routing strategies",
    ", we may define the sequential or single - path capacity of the network @xmath103 , for the various tasks of error - free quantum communication ( @xmath8 ) , entanglement distillation ( @xmath9 ) and secret key generation ( @xmath10 ) .",
    "remarkably , we can upper bound @xmath103 for any quantum network which is connected by stretchable channels , here called stretchable network . more strongly",
    ", we exactly establish the capacity @xmath103 for any distillable network , where the point - to - point connections are realized by distillable channels .    in order to show these results we need to combine several tools .",
    "the procedure is sketched in fig .",
    "[ quadro1 ] for the simple case of a diamond quantum network , while full details are available in secs .",
    "[ secstretchingnet ] and  [ secdistillablenet ] .",
    "first of all , by teleportation stretching  @xcite , we decompose a stretchable network into a network where each channel @xmath104 , associated with an edge @xmath105 , is replaced by its choi matrix @xmath106 .",
    "more precisely , after @xmath14 uses of the protocol , we may write the output state of the network as @xmath107 , where @xmath19 is a trace - preserving locc and@xmath108 with @xmath109 being the number of uses of channel @xmath104 . tracing out all points but alice and bob , we get their output @xmath110 for another trace - preserving locc @xmath40 .     into a novel choi representation .",
    "each channel @xmath104 is replaced by the tensor - product @xmath111 , where @xmath112 is the choi matrix of the channel and @xmath113is the number of quantum transmissions through the channel .",
    "up to a locc , the output state can be represented as in eq .",
    "( [ outputtesn ] ) .",
    "( middle panel )  * entanglement cuts*. an entanglement cut @xmath114 devides the network in two partitions , one including alice @xmath11 and the other including bob @xmath12 .",
    "let us extend the two end - points , @xmath11 and @xmath12 , to their corresponding partitions @xmath115 and @xmath116 . as a result ,",
    "only the choi matrices in the cut set @xmath117  contribute to alice and bob s output state , according to eq .",
    "( [ aftercut ] ) .",
    "this simplification implies that the entanglement flux @xmath118 through any cut @xmath114 is an upper bound for the capacity @xmath103 .",
    "there will be an optimal cut which minimizes @xmath118 and identifies the entanglement flux of the network @xmath119 , according to eq .",
    "( [ minentf ] ) .",
    "( bottom panel )  * optimal routing . * the entanglement flux of the network @xmath119 is equal to the maximum flux of entanglement among all the possible routes connecting the two end - points . in particular , it is equal to the flux @xmath120 of an optimal route @xmath121 . for distillable networks ,",
    "@xmath120 is an achievable rate , therefore providing the network capacity @xmath103 for all the considered quantum tasks .",
    "( [ distillableresult]).,scaledwidth=45.0% ]    this choi representation of the quantum network is our starting point but alone provides an upper bound which is too large .",
    "the solution comes from introducing suitable cuts of the network . following terminology from graph theory",
    ", we define an alice - bob cut @xmath114 of the quantum network as a bipartition @xmath122 of all the points @xmath64 such that @xmath123 and @xmath124 . correspondingly , the cut - set @xmath117 of @xmath114 is the set of edges with one end - point in each subset of the bipartition , so that the removal of these edges disconnects the quantum network .",
    "explicitly , @xmath125 .",
    "it is clear that an alice - bob cut of the network prevents any distribution of entanglement between the two end - points , which is why we may equivalently call it an entanglement cut .    to simplify the stretching of the network",
    ", we then adopt the following procedure .",
    "given an entanglement cut @xmath126 , we extend alice and bob to their corresponding partitions .",
    "this means that we consider an extended alice with total ensemble @xmath115 which is given by all the local ensembles of the points in @xmath127 ( see fig .",
    "[ quadro1 ] ) .",
    "then , all choi matrices in alice s partition are included in the los of the extended alice .",
    "similar reasoning for bob . as a result , we are left with the choi matrices in the cut - set @xmath128 .",
    "these are the only ones responsible for distributing entanglement between the two partitions and , therefore , the two end - points .",
    "thus , for any cut @xmath114 , we may simplify the choi decomposition of alice and bob s output state , which becomes@xmath129   .",
    "\\label{aftercut}\\ ] ]    by computing the ree on the latter state , we can bound the capacity with a network version of the entanglement flux .",
    "in fact , denote the entanglement flux through an arbitrary edge @xmath130 by @xmath131 .",
    "then , for an arbitrary entanglement cut @xmath114 , we may consider the maximum flux of entanglement which is distributed across @xmath114 by an edge of the cut - set@xmath132 this quantity provides the bound @xmath133 . by minimizing over all cuts , we therefore find@xmath134 where",
    "the bottleneck value @xmath119 may be identified as the entanglement flux of the network .",
    "the upper bound in eq .",
    "( [ minentf ] ) is not yet in a form which allows us to prove its achievability in the most interesting cases ( distillable networks ) . for this reason ,",
    "we prove a result which generally applies to any weighted undirected graph .",
    "we show that the entanglement flux of the network @xmath119 , which is defined by a minimization over the cuts , is just equal to the entanglement flux of an optimal route between alice and bob .",
    "in fact , for any route @xmath135  with quantum channels @xmath136 , define its entanglement flux as @xmath137 . then , we find @xmath138 for some optimal route @xmath121 ( see fig .  [ quadro1 ] ) .",
    "we call the result of eq .",
    "( [ propertycutmain ] ) the cut property  of the optimal route .",
    "we are now in the condition to determine the capacity of a distillable network . in this case , we may write @xmath139 for any edge @xmath105 , and @xmath140 for any route @xmath75 , in particular , for the optimal route @xmath121 . thus , by applying the point - to - point composition strategy along the optimal route , we find the achievable rate @xmath141 . as a result , for any distillable network @xmath142 , we may write @xmath143 which is a network generalization of eq .",
    "( [ ceintro ] ) .",
    "the single - path capacity of a distillable network , for any of the tasks of error - free quantum communication , entanglement distillation and secret key generation , is equal to the entanglement flux of the network , which is the maximum entanglement ( ree )  that can be distributed between the two end - points for each sequential use of the network or single - path transmission .    according to this result",
    ", the single - path capacity of a distillable network is expressed by the optimization @xmath144 where @xmath145 is the capacity of cut @xmath114 , and @xmath146 is the capacity of route @xmath75 , which are given by @xmath147 in particular , this reduces the computation of the capacity and the determination of the optimal route to the solution of the widest path problem  @xcite .",
    "the optimal route @xmath121 can be found using the modified dijkstra s shortest path algorithm  @xcite , which works in time @xmath148 , where @xmath149 is the number of edges and @xmath150 is the number of points ( or even faster in practical cases  @xcite ) .",
    "another possibility is using the kruskal s algorithm  @xcite to find a maximum spanning tree in the network , with asymptotic time @xmath148 , followed by the search of the optimal route within the tree in time @xmath151  @xcite .",
    "these results apply to any distillable network , which includes cv networks affected by loss and/or amplification , or dv networks subject to dephasing and/or erasure , e.g. , spin networks . in general",
    ", they apply to any hybrid network combining these error models , such as a hybrid quantum internet  @xcite based on different substrates for communication , local storage and information processing . as an important practical example , consider here an optical network , so that any route @xmath75 is composed of lossy channels with transmissivities @xmath152 , which may be fibers or free - space connections .",
    "denote by @xmath153 the end - to - end transmissivity of route @xmath75 .",
    "the single - path capacity of the lossy network @xmath154 is determined by the route with maximum transmissivity@xmath155 this is the ultimate rate at which the two end - points can transmit quantum information ( qubits ) , distill entanglement ( ebits ) or generate secret correlations ( secret bits ) per sequential use of the lossy network .",
    "results for the other distillable networks are discussed in sec .",
    "[ secdistillablenet ] .",
    "it is important to note that the sequential use of the network is the best practical strategy to optimize the use of the available quantum resources .",
    "in fact , @xmath103 can also be expressed as the maximum number of target bits per quantum system routed .",
    "the situation changes if we do not have such restriction and quantum systems are cheap , as is the case of optical implementations based on coherent states . in such a case , we can send many quantum systems in parallel through all the available paths .",
    "this is the parallel or broadband use of the quantum network , which has been previously mentioned .    in a broadband network protocol",
    ", the network is initialized by a preliminary network locc . then , alice @xmath11 broadcasts quantum systems to all her neighbor repeaters @xmath156 .",
    "such broadcasting must be intended as an exchange of quantum systems which may occur through forward or backward transmissions , depending on the direction of the available quantum channels .",
    "it is however useful to assign a _",
    "logical _ sender - receiver orientation , so that we represent alice s broadcast with the notation @xmath157 .",
    "this is followed by a second network locc .",
    "then , each receiving repeater multicasts quantum systems to neighbor repeaters .",
    "this is done in such a way that every multicast occurs between two network loccs and different multicasts do not overlap , so that no edge of the network is used twice .",
    "the latter condition is assured by imposing that receiving repeaters only choose unused connections for the subsequent transmissions , which is a routing strategy known as flooding  in standard computer networks  @xcite .",
    "eventually , bob is reached as an end - point ( see fig .",
    "[ diamondf ]  for a simple example ) .    in this way ,",
    "the first end - to - end transmission is carried out through a sequence of multicasts which defines a flow - like orientation for the network or broadband routing strategy . in a network with stable connections ,",
    "such a strategy can be agreed during the preliminary locc and updated for the second end - to - end transmission and so on .",
    "after many transmissions , alice and bob will get an output state @xmath102 which closely approximates some pre - established target state .",
    "thus , by optimizing over the network loccs and the broadband routing strategies , we may define the broadband or multipath capacity of the network @xmath158  for the tasks of error - free quantum communication , entanglement distillation and key generation . as before",
    ", we can bound @xmath159 for any stretchable network , and establish @xmath159 for any distillable network .    for the determination of the upper bound , we suitably adapt the previous method , based on the choi decomposition of the network followed by the minimization of the ree  over the entanglement cuts .",
    "after @xmath14 uses of a broadband network protocol , each edge is used @xmath14 times , so that we may set @xmath160 in the choi decomposition of eq .",
    "( [ outputtesn ] ) .",
    "thus , for any entanglement cut @xmath114 , we write the output state @xmath161  of eq .",
    "( [ aftercut ] ) with @xmath160 .",
    "let us define the broadband flux of entanglement through a cut @xmath114 as the sum of the fluxes in the cut - set@xmath162 the computation of the ree on the output state @xmath161 shows that  @xmath163 upperbounds @xmath158 for any cut @xmath114 .",
    "therefore , we may minimize over all cuts and write@xmath164 where the bottleneck quantity @xmath165 may be identified as the broadband entanglement flux of the network .",
    "in the important case of distillable networks , we show that the upper bound @xmath165 is achievable by combining the point - to - point composition strategy with the max - flow min - cut theorem for classical flow networks  @xcite .",
    "in fact , for an arbitrary edge @xmath130 of a distillable network , we may write @xmath166 , where the latter is the two - way capacity of the associated channel .  this leads to @xmath167 where @xmath168 is the broadband capacity of the cut .",
    "let us call @xmath169the minimum cut that solves the minimization of eq .",
    "( [ mincbb ] ) .",
    "the crux is to show that @xmath170 is a rate that some protocol may achieve .",
    "such optimal protocol exists and can be described as follows .",
    "first of all , in preliminary ccs , the points solve the maximum flow problem from the knowledge of the capacities @xmath171 .",
    "this solution fixes a flow - like orientation for the quantum network and provide an ensemble of point - to - point rates @xmath172 for the corresponding directed edges .",
    "this is the flow vector  which will maximize the flow of quantum information from alice to bob .",
    "compatibly with the optimal orientation , the points perform their @xmath14 multicasts .",
    "generic point @xmath173 multicasts to an out - neighborhood @xmath174 of points identified by the heads of the directed edges .",
    "since the channels are distillable , it is sufficient to distribute @xmath14 epr states along each edge @xmath175 between @xmath173  and @xmath176 , and distill the output choi matrices into @xmath177 ebits by means of one - way ccs .",
    "these ebits are then used to teleport @xmath177 incoming qubits from @xmath173 to @xmath178 . as a matter of fact",
    ", the multicasts of each point can be reduced to a collection of independent point - to - point distillation protocols , one for each edge , followed by directed teleportation .    by means of this classically - routed teleportation process , a number @xmath179  of alice",
    "s input qubits are transmitted to bob through all the multicasts . according to the max - flow min - cut theorem  @xcite",
    ", the maximum value of these qubits equals the cut bound @xmath180 .",
    "similarly , the points may perform a sequence of entanglement swapping protocols providing alice and bob with @xmath180 ebits .",
    "the latter resource may be used to teleport an equal number of qubits directly between the end - points or to generate an equal number of secret bits .",
    "thus , for distillable quantum networks we prove the quantum communication equivalent of the classical max - flow min - cut theorem , which reads@xmath181 this can be seen as the broadband version of eqs .",
    "( [ distillableresult ] ) and  ( [ distillableresult2 ] ) . according to eq .",
    "( [ broadcapdistilla ] ) , the broadband ( multipath ) capacity of a distillable network is simply equal to its broadband entanglement flux ; most importantly , it is equal to the minimum broadband capacity among all the entanglement cuts of the quantum network .",
    "thanks to this result , the optimal multi - path routing of a quantum network is given by classical algorithms solving the maximum flow problem , including the ford - fulkerson algorithm  @xcite , the edmonds - karp algorithm  @xcite and dinic s algorithm  @xcite .",
    "recently , more powerful algorithms have been discovered  @xcite . by using orlin s algorithm  @xcite ,",
    "the optimal routing can be found in @xmath182 time .",
    "an important application is clearly for optical / telecom quantum communications .",
    "consider a bosonic quantum network composed of lossy channels @xmath154 , so that each undirected edge @xmath130 has an associated transmissivity @xmath183 and , therefore , a loss parameter given by @xmath184 .",
    "for any entanglement cut @xmath114 , consider its loss @xmath185 to be the product of the loss parameters in the cut - set , i.e.,@xmath186 then , we may define the total loss of the network as the maximization of @xmath185 over all cuts , i.e.,@xmath187 from eq .",
    "( [ broadcapdistilla ] ) , we find that the broadband ( multipath ) capacity of the lossy quantum network is just given by@xmath188 which is the broadband version of eq .",
    "( [ losssingle ] ) .",
    "similar results for the other distillable networks are in sec .",
    "[ secdistillablenet ] .",
    "note that the previous results , derived for the basic unicast scenario of a single sender and a single receiver , provide upper bounds for the performance that is achievable by individual pairs of end - points also in the presence of multiple senders and receivers within the quantum network . for simplicity ,",
    "these sets are intended to be separated , i.e. , an end - point can not be sender and receiver at the same time . besides the general applicability of the previous unicast bounds , we may also derive tighter bounds which are specific for the various network configurations with multiple end - points , including multiple unicasts , multicast and multiple multicasts ( see fig .",
    "[ butterfly ]  for a simple description ) . for simplicity",
    ", here we present the main results for distillable networks .",
    "full details and general results for stretchable networks are in sec .",
    "[ secmultiplenets ] .    in a multiple - unicast",
    "setting , we consider @xmath189  sender - receiver pairs @xmath190 , where alice @xmath191  communicates with a corresponding bob @xmath192 .",
    "all the senders access the quantum network simultaneously and they may exploit either single - path or multipath routing for their end - to - end communication .",
    "we can easily generalize previous descriptions to define the most general adaptive protocols for such configurations .",
    "accordingly , we define a set of achievable rates @xmath193 under single - path routing , and a set of achievable broadband rates @xmath194 under multipath routing .",
    "these provide the maximum numbers of target bits that can be simultaneously distributed between each end - to - end pair .",
    "let us adopt the compact notation @xmath195 for an entanglement cut @xmath126 such that @xmath196 and @xmath197",
    ". in a multiple - unicast distillable network  with @xmath189 sender - receiver pairs @xmath198 communicating via single - path routing , we may write the following cutset bounds for the capacity region@xmath199 where @xmath145 is the capacity of cut @xmath114 . in particular , note that @xmath200 in eq .",
    "( [ cieq ] ) is the single - sender single - receiver capacity associated with the generic pair @xmath198 .     communicating with bob @xmath201 , and alice @xmath202 with bob @xmath203 .",
    "single - path routing corresponds to the simultaneous use of two end - to - end routes , e.g. , @xmath204 and @xmath205 .",
    "multipath routing corresponds to choosing a common network orientation , where the end - points may also act as relays .",
    "each point of the network multicasts to its out - neighborhood .",
    "for instance , we may have the following point - to - point multicasts : @xmath206 , @xmath207 , @xmath96 , and @xmath208 .",
    "an example of end - to - end multicast is alice @xmath209 communicating wih both bobs @xmath210 via multipath routing . in a crypto setting , alice may send to keys to the bobs , or the same identical key . in the latter case ,",
    "she is bounded by the single - key multicast capacity , which is achievable by linear nework coding . finally , an example of multiple - multicast is considering alice @xmath209 communicating with @xmath210 , and alice @xmath202 communicating with the same destination set @xmath210 .",
    "if each alice transmits a single key , the capacity region of the achievable rates has a tight outer bound.,scaledwidth=35.0% ]    for multipath routing , we derive a set of conditions similar to eqs .",
    "( [ cieq])-([cieq3 ] ) , where the capacity @xmath7 is replaced by the broadband capacity @xmath159 . for instance , for  each individual rate , we may write the bound @xmath211 , where the latter is single - sender single - receiver broadband capacity associated with the pair @xmath198 .",
    "finally , achievable lower bounds can be derived by combining the point - to - point composition strategy with classical routing algorithms , associated with the search of multiple bottleneck paths  @xcite for the case of single - path routing , and multicommodity flows  @xcite for multipath routing .",
    "another important scenario to study is end - to - end multicast , where a single alice simultaneously communicates with a set of @xmath189 remote bobs via multipath routing . by optimizing over suitably - defined adaptive protocols ,",
    "we consider the capacity region for the achievable rates @xmath193 at which alice @xmath11  may communicate with each bob in the destination set @xmath212 . for a multicast distillable network ,",
    "we may write the cutset bounds @xmath213 where @xmath168 is the broadband capacity of cut @xmath114 , and @xmath214 represents here the broadband capacity between the sender and the @xmath43th receiver .",
    "note that we may consider a multicast network capacity which may be expressed as the maximum common rate @xmath215 that alice may achieve with each bob . for a distillable network , we may write@xmath216 the specification of eq .",
    "( [ simplecibb ] ) to key generation means that the maximum common number of secret bits @xmath217 that alice may simultaneously share with each bob can not exceed the maximum number of secret bits @xmath218 that alice would distribute to the @xmath43th bob in a unicast configuration .",
    "we do not know if we can achieve the cutset bound of eq .",
    "( [ simplecibb ] ) in the general case where alice distributes @xmath189 independent keys to the bobs ( i.e. , one for each bob ) .",
    "however , we can prove that this bound is achievable in a single - key multicasting scenario .",
    "in fact , assume that alice aims to distribute exactly the same key to all bobs .",
    "this restriction defines a single - key multicast capacity @xmath219 which is certainly bounded as in eq .",
    "( [ simplecibb ] ) .",
    "more strongly , we may show that such bound is achievable , so that we may write @xmath220 an optimal protocol achieving this capacity is based on a point - to - point distillation of ebits , followed by the teleportation of orthogonal states encoding blocks of alice s secret key .",
    "network points not only decide the optimal multi - path routing for transmitting the secret information via point - to - point teleportation , but also have the possibility to perform linear coding , i.e. , apply linear transformations to incoming blocks before forwarding .",
    "this allows us to use the classical network coding theorem  @xcite to show the achievability of the bound . in this sense ,",
    "( [ netcodmain ] ) is a formulation of the network coding theorem for multi - end quantum key distribution .",
    "the previous results can be further extended to a multiple - multicast scenario , where we have a set of @xmath221 alices @xmath222 , where generic alice @xmath191 simultaneously communicates with a set of @xmath223 bobs @xmath224 .",
    "we can derive corresponding cutset bounds for the capacity region of all achievable rates ( see sec .",
    "[ secmultiplenets ]  for more details ) .",
    "in particular , we have that the maximum common rate @xmath225 at which the generic alice @xmath191 can communicate with the destination set @xmath224 is bounded by the same bound which is valid for single - sender multicast capacity with @xmath223 receivers , i.e. , @xmath226 , where @xmath227 is the broadband capacity between @xmath191 and @xmath228 .    similarly , we can extend the network coding theorem .",
    "consider the single - key rates @xmath229 which are associated with the communication of a single key from alice @xmath191 to the entire destination set @xmath224 , for a total of @xmath221 independent keys communicated by all alices .",
    "then , we may apply linear coding arguments to show that these rates satisfy the achievable bound @xmath230 where @xmath231 is the broadband secret - key capacity of @xmath114 .",
    "* structure of the technical sections*.   mathematical details , definitions and proofs of the main results presented in this general section are all available in the following technical sections . in sec .",
    "[ secprelimi ] we give all the details of teleportation stretching , and we describe the entire ree+teleportation method for the study of adaptive point - to - point quantum communications . in sec .",
    "[ secrepeaters ] , we provide the complete proofs for chains of quantum repeaters , besides discussing additional results for distillable chains . in sec .",
    "[ secnetworks ] we consider quantum networks and we exactly define the adaptive network protocols for the basic routing strategies . in sec .",
    "[ secstretchingnet ] , we give theorems and proofs for stretchable networks .",
    "we show their choi representation and its simplification via the entanglement cuts .",
    "we then derive upper bounds for their capacities based on the entanglement flux . in sec .",
    "[ secdistillablenet ] , we give theorems and proofs for distillable networks , including the quantum versions of the widest path problem and of the max - flow min - cut theorem . in sec .",
    "[ secmultiplenets ] , we study quantum networks with multiple senders and receivers , and we prove the network coding theorem for quantum key distribution .",
    "finally , sec .",
    "[ secconclusions ]  is for conclusions .    technical sections",
    "let us describe the teleportation protocol in the ideal case , i.e. , without noise and with perfect resources and measurements .",
    "given an arbitrary state @xmath232 on some input system @xmath233 , this is perfectly teleported onto an output system @xmath234 by the following procedure .",
    "first of all , we need an ideal einstein - podolsky - rosen ( epr ) source @xmath235 of systems @xmath127  and @xmath234 . for a qudit of arbitrary dimension",
    "@xmath236 , this is a generalized bell state@xmath237 becoming the usual bell state @xmath238 for a qubit . for a cv system , we take the asymptotic limit of @xmath239 in eq .",
    "( [ eprfinite ] ) , which corresponds to considering a two - mode squeezed vacuum state  @xcite with infinite energy .    then , input system @xmath233 and epr system @xmath127 are subject to an ideal bell detection",
    ". this measurement corresponds to projecting on a basis of bell states @xmath240 where the outcome @xmath241 takes @xmath242 equiprobable values for qudits , while it is a complex number for cvs  @xcite .",
    "more precisely , the bell measurement is described by a positive - operator valued measure ( povm ) with generic operator @xmath243 where @xmath244 is a suitable teleportation unitary .",
    "let us call teleportation set @xmath245 the ensemble of all possible teleportation unitaries @xmath244 at dimension @xmath236 .",
    "for a qudit , these are @xmath242 generalized pauli operators ( generators of a finite - dimensional weyl - heisenberg group )  @xcite ; for a cv system , these are an infinite number of displacement operators  @xcite ( infinite - dimensional weyl - heisenberg group ) .    for any given outcome @xmath241 of the bell detection on system @xmath233 and @xmath127 ,",
    "the remaining system @xmath234 is projected onto @xmath246 where @xmath247 .",
    "the last step is the cc of the outcome @xmath241 , which allows the receiver to undo the teleportation unitary by applying @xmath248 to system @xmath234 .",
    "note that this process also teleports all correlations that the input system might have with other systems .",
    "now suppose that system @xmath234 is subject to a quantum channel @xmath15 which outputs system @xmath249 . in order to clean the probabilistic action of the bell measurement ,",
    "can we apply the correction unitary after the channel ?",
    "in other words , instead of applying @xmath248 to system @xmath234 , can we apply another unitary @xmath250 to the output system @xmath249 ?",
    "this is not possible in general , but it is a property for a wide class of channels called stretchable  @xcite .",
    "a quantum channel @xmath15 is said to be stretchable  by quantum teleportation  if , for any @xmath247 and any input state @xmath232 , we may write@xmath251 for some unitary @xmath252 .    typically , the stretchability condition of eq .",
    "( [ stretch ] ) is satisfied with @xmath253 , i.e. , the channel is covariant with respect to the weyl - heisenberg group",
    ". notable examples of stretchable channels are the pauli channels ( e.g. , depolarizing and dephasing channels ) , the erasure channels , and the bosonic gaussian channels .",
    "now we discuss how quantum / private communication over a stretchable channel can be re - arranged in time , so as to be reduced to the partial distribution of an ideal epr source followed by a trace - preserving locc .",
    "this is the basic idea of the method of teleportation stretching  @xcite  ( see fig .",
    "[ stretchpic ] for a schematic ) .",
    "suppose that alice is sending a quantum system @xmath233 through a quantum channel @xmath15 with output @xmath254 , i.e. , we have @xmath255 .",
    "we can replace @xmath233  with another input system @xmath234 by quantum teleportation .",
    "in fact , we can prepare an ideal epr source @xmath235 of systems @xmath127 and @xmath234 , and perform a bell detection on the original input system @xmath233 and the epr system @xmath127 .     from input system",
    "@xmath233 to output system @xmath254 .",
    "( ii )  input system @xmath233 is teleported into the new input system @xmath234 by a teleportation circuit composed by an ideal epr state ( orange triangle ) and a bell detection ( green triangle ) .",
    "the outcome @xmath241 of the measurement is classically comunicated to bob who applies an inverse unitary @xmath256 . (",
    "iii ) the ideal epr source and the bell detection are stretched in time : the epr source is anticipated and replaces the original input state , while the bell detection is postponed after the transmission over the channel . thus , alice first distributes the epr mode @xmath234 . then",
    ", a locc is applied to the output systems @xmath127 and @xmath249 , which includes the previous preparation of system @xmath233 , the bell detection , cc of @xmath241 and the local unitary @xmath256 .",
    "( iv )  the final scheme is equivalent to considering the choi - matrix @xmath18 of the original channel subject to a locc.,scaledwidth=49.0% ]    this leads to perfect teleportation of @xmath233 onto @xmath234 , up to a random teleportation unitary , i.e. , we have @xmath257 .",
    "the unitary @xmath258 could be undone before transmission through the channel but , because @xmath15 is stretchable , @xmath258 is mapped into an output unitary @xmath259 that bob can equivalently delete at the channel output , i.e.,@xmath260 therefore , bob just needs to receive alice s cc about the outcome @xmath241 and correspondingly apply @xmath256 to retrieve the input state , i.e. , @xmath261 .",
    "thanks to this property , the bell detection can be delayed in time , meaning that it can equivalently be performed after the transmission through the channel @xmath15 .",
    "the first step then becomes the preparation of the ideal epr source and the distribution of its system @xmath234 through the channel , i.e. , we have the shared state @xmath262 . only after this epr distribution , the bell detection",
    "is applied to system @xmath233 and epr system @xmath127 , performing quantum teleportation of @xmath233 back in time .    in such a scenario , where the preparation of the epr source is anticipated and the bell detection is postponed , alice and bob are left with a final locc @xmath263 to be applied to their systems @xmath127 and @xmath249 .",
    "this locc combines the preparation of the input system @xmath233 , the bell detection , the cc  of its outcome @xmath241 , and the local unitary @xmath256 .",
    "in other words , we may write bob s output state as @xmath264 . note that , by construction , @xmath265 is the choi matrix @xmath18 of the channel @xmath15 .",
    "thus , we may write @xmath266 .    because the final state @xmath267 does not depend on @xmath241 , we may equivalently write @xmath268 where @xmath19 is computed from the previous locc @xmath263 by averaging over all outcomes @xmath241  of the bell detection .",
    "this is a crucial step because @xmath19 is not only a locc but also a completely positive trace - preserving ( cptp ) map , which allows us to exploit the monotonicity of entanglement measures under such local maps . as a matter of fact",
    ", this method allows us to replace the quantum communication over the channel @xmath15 by the choi matrix of the channel @xmath18  subject to a trace - preserving locc .",
    "this technique is different from programmable quantum gate arrays  @xcite or port - based teleportation  @xcite .",
    "in particular , the fact that the method provides an overall trace - preserving locc is absolutely crucial for the simplification of the adaptive protocols .",
    "also note that part of this technique ( specifically , panel  ( ii ) of fig .",
    "[ stretchpic ] ) can be represented as a generic teleportation channel  from @xmath233 to @xmath254 , as introduced in ref .",
    "* section  v ) .",
    "however , the following peculiar collapse of the teleportation protocol into a trace - preserving locc , as specified by panels ( iii)-(iv ) of fig .",
    "[ stretchpic ] and final eq .",
    "( [ collapsemain ] ) , represents a recent advance in the literature  @xcite .",
    "in fact , the mathematical expression in eq .",
    "( [ collapsemain ] ) can only be exploited today , using recent knowledge on entanglement measures ( in particular , the ree ) which allow us to discard the locc @xmath19 .",
    "see supplementary material of ref .",
    "@xcite for more detailed discussions on relations with previous literature .",
    "point - to - point quantum / private communication over a stretchable channel can be greatly simplified by teleportation stretching  @xcite .",
    "suppose that alice and bob are separated by a quantum channel @xmath15 and they want to implement the most general protocol with the aim of distributing entanglement , quantum information or secret keys .",
    "suppose that they can exploit unlimited two - way cc and perform real - time adaptive los on their systems , i.e. , they use adaptive loccs .",
    "we can always assume that alice and bob have countable ensembles of systems , denoted by @xmath11 and @xmath12 , respectively . to simplify notation",
    ", we update their local ensembles so that a system @xmath233 to be transmitted is extracted from the origin ensemble @xmath269 , and a system @xmath254 received is absorbed by the target ensemble @xmath270 . in general",
    ", the quantum communication can be forward or backward . in case a two - way quantum channel is available , the two parties may always pick the optimal direction  @xcite .",
    "the most general adaptive protocol goes as follows ( here described for forward communication ) .",
    "the first step is the preparation of the initial state of @xmath11 and @xmath12 by an adaptive locc @xmath271 .",
    "next , alice picks a system @xmath272 which is sent through the channel @xmath15 .",
    "once bob gets the output @xmath273 , the parties apply an adaptive locc @xmath274 on all systems @xmath275 .",
    "let us update bob s set @xmath276 .",
    "in the second transmission , alice sends another system @xmath277 through @xmath15 resulting into an output @xmath278 for bob .",
    "the parties apply a further adaptive locc @xmath279  on all systems @xmath280 .",
    "bob s set is updated and so on .",
    "after @xmath14 transmissions , alice and bob share a state @xmath102 depending on the sequence of adaptive loccs @xmath281 .",
    "note that these adaptive loccs can be assumed to be trace - preserving , since we are interested in the average performance of the protocol  @xcite .",
    "the adaptive protocol has an average rate of @xmath282 if @xmath283 , where @xmath284 is the trace norm and @xmath285 is a target state with @xmath286 bits . by taking the limit of @xmath287  and optimizing over all the protocols @xmath288 , one can define the ( generic ) two - way capacity of the channel @xmath289 in particular , if the parties implement entanglement distillation ( ed ) , the target state is a maximally - entangled state and @xmath290 is the number of entanglement bits ( ebit ) per use . if the parties implement qkd , the target state is a private state  @xcite with secret - key rate @xmath291  @xcite .",
    "thus , @xmath292 may describe the two - way entanglement distillation capacity @xmath9 or the secret - key capacity @xmath10 .",
    "explicitly these capacities are defined as follows@xmath293 also note that @xmath294 , where @xmath8 is the two - way quantum capacity of the channel .",
    "in fact , under two - way ccs , transmitting an ebit as part of a qubit is fully equivalent to teleporting a qubit via an ebit .",
    "for any quantum channel @xmath15 we can bound its two - way capacity @xmath292 by using the ree . recall that the ree of an arbitrary quantum state @xmath232 is given by  @xcite@xmath295 where sep is the set of separable states and @xmath296\\ ] ]",
    "is the relative entropy .",
    "then , we may write  @xcite @xmath297    note that the proof of eq .",
    "( [ proofof ] ) derives from @xmath298 which is valid for any output state @xmath102 asymptotically close to the private state  @xmath285 , no matter how @xmath102 has been generated .",
    "in fact , the epsilon - closeness @xmath299 directly leads to @xmath300 , where @xmath301 depends on the dimension @xmath236  @xcite .",
    "then , we have @xmath302 , because the ree is an upper bound of the distillable key of any state  @xcite .",
    "this leads to @xmath303 .",
    "the latter @xmath304  becomes a @xmath305  if we also include cv states  @xcite .",
    "the fact that eq .",
    "( [ forproofs ] ) depends only on the two states @xmath102 and @xmath285 is crucial in order to extend this inequality to other communication scenarios .",
    "the upper bound @xmath306 in eq .",
    "( [ proofof ] ) is called the regularized ree of the channel  @xcite and quantifies the maximum entanglement  which can be distributed through the channel ( as measured by the ree ) .",
    "its computation appears to be very hard but becomes feasible for stretchable channels . in this case",
    ", the most general adaptive protocol can be suitably stretched  in time : it can be reduced to a block ( i.e. , non - adaptive ) protocol , where channels are replaced by their choi matrices , and the adaptive loccs are all collapsed into a final trace - preserving locc .",
    "formally , we can state the following .",
    "[ stretching @xcite][theo1]an arbitrary adaptive protocol performed over a stretchable channel @xmath15 can be reduced to tensor products of choi matrices @xmath18 plus a trace - preserving locc @xmath19 .",
    "in fact , after @xmath14 uses , alice and bob s output state can be written as @xmath307    * proof*.  this result was originally proven in refs .",
    "we formally repeat the proof here because it contains preliminary tools which are exploited in our next developments .",
    "the derivation is presented for finite - dimensional systems , but can be easily extended to the asymptotic limit of cv systems , according to the reasonings of ref .  @xcite . for simplicity of notation , we omit identities when they are involved in tensor products with other operators ( for instance , we set @xmath308 ) .",
    "we first discuss the stretching of the @xmath43th transmission ; then we extend the result by iteration to the entire quantum communication .",
    "see the panels ( i)-(iv ) of fig .",
    "[ pic2 ] for a schematic which helps the discussion .    in fig .",
    "[ pic2](i ) we consider the @xmath43th transmission @xmath309 between alice and bob .",
    "the input state @xmath310 is subject to the channel @xmath15 acting on @xmath311 with the identity being applied to the local ensembles @xmath11 and @xmath12 .",
    "after transmission , the adaptive locc @xmath312 provides the output state @xmath313 , which is the input for the next transmission . in fig .",
    "[ pic2](ii ) , we insert a teleportation circuit which teleports @xmath311 into system @xmath314 .",
    "the total state @xmath315 is subject to the bell detection @xmath316 , with outcome @xmath241 and probability @xmath317 . after re - normalization",
    ", we have @xmath318 for a teleportation unitary @xmath258 .    ) and bob is at the bottom ( ensemble @xmath12 ) . dashed lines are cc . in panel",
    "( i ) we show the @xmath43th transmission @xmath319 through channel @xmath15 , which is followed by an adaptive locc @xmath312 performed by the parties on their ensembles @xmath11 and @xmath12 . in panel",
    "( ii ) we insert an ideal teleportation circuit , just before the channel , teleporting  @xmath311 into the new input @xmath320 up to a @xmath241-dependent unitary @xmath258 .",
    "since @xmath15  is stretchable , this unitary is mapped into an output one @xmath259 which can be undone by bob in the next locc .",
    "in fact , alice and bob apply @xmath321 where @xmath256 is performed on @xmath322 . in panel  ( iii )",
    "we stretch the protocol by anticipating the distribution of the epr source and post - poning the bell detection after the channel . in panel",
    "( iv ) we show the final result , where the @xmath43th transmission through channel @xmath15 is replaced by its choi - matrix @xmath323 .",
    "the tensor product @xmath324 is subject to the trace - preserving locc @xmath325.,scaledwidth=50.0% ]    applying the quantum channel to the new input system @xmath320 and using the condition of stretchability , we get@xmath326 for some unitary @xmath259 . the value of @xmath241 is communicated to bob , who applies @xmath256 obtaining @xmath327 which is then transformed into @xmath313 by the final locc @xmath312 .",
    "globally , the parties perform the output conditional locc @xmath328 which depends on the outcome @xmath241 .    now note that we may equivalently write the normalized output state as@xmath329 where ( 1 ) we have commuted the quantum channel with the bell detection and ( 2 ) we have used @xmath330 . setting @xmath331 , we may write @xmath332 which is the scenario depicted in fig .  [ pic2](iii ) .",
    "note that @xmath333 contains two @xmath241-dependent quantum operations which cancel each other out , reason why the output state @xmath313 does not depend on @xmath241 .",
    "what remains from the bell measurement is only the normalization factor @xmath334 .    finally , we average over the bell outcomes @xmath335 , obtaining@xmath336 where @xmath337 is a trace - preserving locc  @xcite .",
    "since the input state is the output of the previous transmission , i.e. , @xmath338 , we have@xmath339 which is the final scenario depicted in fig .  [ pic2](iv ) .",
    "the latter equation is a building block which is crucial not only for the present proof but also for our next derivations on quantum repeaters .    by using eq .",
    "( [ iter ] ) we can now stretch all the quantum communication  in an iteratively way , i.e. , transmission after transmission .",
    "for instance , consider two transmissions ( @xmath340 ) as also depicted in fig .",
    "[ repetitionmain ] .",
    "for the first transmission we may write @xmath341 where @xmath342 is the separable input state of alice s and bob s ensembles . because @xmath343 is separable , we may insert this preparation into the locc and write @xmath344 .",
    "this is now the input of the second transmission , for which we may write @xmath345\\nonumber\\\\ &   = \\bar{\\lambda}_{2}\\circ\\bar{\\lambda}_{1}(\\rho_{\\mathcal{e}}^{a_{1}b_{1}}\\otimes\\rho_{\\mathcal{e}}^{a_{2}b_{2}}),\\end{aligned}\\ ] ] since @xmath346 acts as an identity on the second choi matrix @xmath347 .",
    "thus , we finally get @xmath348 , for a trace - preserving locc @xmath349 .",
    "the extension to arbitrary @xmath14 transmissions is easy .",
    "we may directly iterate eq .",
    "( [ iter ] ) for @xmath14 times to get@xmath350 because @xmath343 is separable and @xmath49 are all trace - preserving loccs , we may equivalently write @xmath351 , where all the use of the channel are represented by corresponding choi matrices and all the adaptive loccs are collapsed into a single final trace - preserving locc @xmath19 .",
    "thus , we have proven eq .",
    "( [ outlemma ] ) .",
    "@xmath352     transmissions .",
    "see text for details.,scaledwidth=40.0% ]    it is important to observe that the choi decomposition of eq .",
    "( [ outlemma ] ) is useful only if we find a way to discard the very complicated locc @xmath19 .",
    "the solution comes from computing the ree of the output state @xmath102 .",
    "in fact , we have that : ( i ) the ree of the output state  @xmath353  provides an upper bound for the two - way capacity of the channel according to eq .",
    "( [ proofof ] ) ; and ( ii ) the ree is an entanglement measure monotonic under trace - preserving loccs , which means that it allows us to find an upper bound that completely discards @xmath19 .",
    "furthermore , the ree is also sub - additive under tensor products , so that the final bound will be a simple and computable one - shot quantity .",
    "this is the crucial insight of ref .",
    "@xcite which provides teleportation stretching with an effective application in adaptive quantum communications . as a matter of fact , ref .",
    "@xcite called the entire procedure ree+teleportation  method .    in detail , combining eqs .",
    "( [ proofof ] ) and  ( [ outlemma ] ) , we may write @xmath354 \\nonumber\\\\ &   \\overset{(1)}{\\leq}\\sup_{\\mathcal{l}}\\underset{n\\rightarrow+\\infty}{\\lim\\sup}~n^{-1}e_{r}\\left (   \\rho_{\\mathcal{e}}^{\\otimes n}\\right ) \\nonumber\\\\ &   \\overset{(2)}{\\leq}\\sup_{\\mathcal{l}}\\underset{n\\rightarrow+\\infty}{\\lim\\sup}~n^{-1}\\left [   ne_{r}\\left (   \\rho_{\\mathcal{e}}\\right )   \\right ] \\nonumber\\\\ &   \\overset{(3)}{\\leq}e_{r}\\left (   \\rho_{\\mathcal{e}}\\right )   , \\end{aligned}\\ ] ] where :  ( 1 )  exploits the monotonicity under trace - preserving loccs , ( 2 ) comes from the sub - additivity under tensor products , and ( 3 ) is due to the fact that both the @xmath355 and @xmath305 become redundant .",
    "as previously discussed , we may call entanglement flux  @xmath22  of channel @xmath15 the ree  of its choi matrix @xmath18 , i.e. , we set @xmath356 . therefore , for any stretchable channel @xmath15 , we may write the upper bound  @xcite@xmath357 the computation of @xmath22 is relatively simple for many stretchable channels in finite dimension ( qubits , qudits ) .",
    "explicit analytical formulas can be derived for pauli channels ( including depolarizing and dephasing channels ) and erasure channels  @xcite .",
    "all the theoretical derivation can then be extended to bosonic channels in a regular way , which allows us to compute @xmath22 for all gaussian channels . as discussed in ref .",
    "@xcite , this is possible by introducing suitable sequences of energy - constrained states over which we take the limit for infinite energy .    in fact , for cv systems ,",
    "the epr  state @xmath358 is unbounded , which means that also the choi matrix of a bosonic channel is unbounded . to handle this case",
    ", we consider a sequence of two - mode squeezed vacuum states  @xcite @xmath359 whose variance @xmath360  is sent to infinite .",
    "this sequence naturally defines @xmath361 .",
    "correspondingly , the choi matrix of a bosonic channel is defined by the limit @xmath362 where @xmath363 .",
    "teleportation stretching and all the subsequent derivations are continuously extended to the asymptotic state @xmath18 via the sequence @xmath364 . finally , by using the lower semicontinuity of the relative entropy  @xcite , we may write @xmath365 for a suitable sequence of separable states @xmath366 .    for a bosonic gaussian channel , the two sequences in eq .",
    "( [ liminf ] ) are composed of gaussian states ( @xmath364 is necessarily gaussian , while @xmath366 can be chosen to be gaussian ) .",
    "thus , we can easily compute their relative entropy by using the formula for the relative entropy of two gaussian states of ref .",
    "this is a closed formula , derived using techniques from ref .",
    "@xcite , which is directly expressed in terms of the statistical moments of the gaussian states , without the need of simplectic diagonalizations .",
    "the entanglement flux is therefore an upper bound for all the two - way capacities @xmath20 , @xmath9 or @xmath10 of a stretchable channel . by showing coincidence with achievable lower bounds for entanglement distillation",
    ", we can determine the two - way capacities of several quantum channels .",
    "these good  channels belong to the class of  distillable channels  introduced in ref .",
    "@xcite and defined below .",
    "given the choi matrix @xmath18  of an arbitrary quantum channel @xmath15 , let us consider its one - way entanglement distillation rate @xmath367 .",
    "this is an achievable rate that satisfies two important properties .",
    "first of all , it is a lower bound for the two - way entanglement distillation capacity of the channel @xmath368 , therefore a lower bound for @xmath292 .",
    "second , we may write the hashing inequality  @xcite @xmath369 where @xmath370 is the coherent information  @xcite and @xmath371 is the  reverse coherent information  @xcite associated with the channel . setting @xmath372 ,",
    "these quantities are defined by @xmath373 where @xmath374 is the von neumann entropy .",
    "both @xmath370 and @xmath371 provide simple tools for estimating the achievable rate @xmath367 .",
    "we have the following  @xcite .",
    "a stretchable channel @xmath15  is called distillable if it satisfies the additional condition@xmath375    thus , for a distillable channel , the maximum entanglement that can be transmitted , as given by @xmath22 , is all one - way distillable from its choi matrix .",
    "most importantly , for a distillable channel , eqs .",
    "( [ preres ] ) and  ( [ distillabledef ] ) imply@xmath376 thus , the entanglement flux of a distillable channel determines all its two - way capacities @xmath10 , @xmath9 , and @xmath8 , and these optimal rates are achievable by block protocols of one - way entanglement distillation over @xmath377 .    in detail ,",
    "an optimal protocol goes as follows .",
    "alice prepares @xmath14 copies of the ideal epr source @xmath235 , sending the @xmath234-parts to bob through the channel , therefore distributing the ensemble of choi matrices @xmath377 .",
    "this is then subject to one - way entanglement distillation loccs @xmath378 , i.e. , entanglement distillation los assisted by one - way ccs , which may be forward or backward .",
    "the final state @xmath379 closely approximates @xmath380 ebits .",
    "these ebits may equivalently be used to teleport @xmath381 qubits or to generate @xmath382 secret bits .",
    "note that these results are valid at any dimension .",
    "in particular , for cv systems , the coherent information quantities and the achievable rate @xmath367 can be defined as asymptotic limits over a sequence of tmsv states @xmath359 , exactly as before . the hashing inequality can also be extended to choi matrices of bosonic gaussian channels  @xcite . as a result",
    ", the previous definitions and tools for distillable channels also apply to gaussian channels .",
    "thus , the family of distillable channels involves both dv and cv systems . in the bosonic",
    "setting , the most important distillable channel is the lossy channel .",
    "this is a particular gaussian channel whose action on input quadratures @xmath383 is given by @xmath384 , where @xmath385 $ ] is the transmissivity and @xmath386 are the quadrature of an environmental vacuum . at any transmissivity",
    ", its two - way capacity is given by  @xcite@xmath387 this result sets the fundamental rate - loss scaling of optical quantum communications at @xmath388  @xmath0 bits per channel use  @xcite , closing a long - standing investigation  @xcite .",
    "furthermore , @xmath389 equals the maximum quantum discord that can be distributed to the parties , as computed with the techniques of ref .",
    "@xcite and confirming the role of discord in qkd  @xcite ( see also ref .",
    "@xcite ) .",
    "the previous result can be readily extended to a multiband lossy channel , like a multimode optical fiber .",
    "for instance , suppose that alice and bob can exploit a number @xmath189 of independent lossy channels with the same transmissivity @xmath0 . according to ref .",
    "@xcite , the two - way capacity of the multiband lossy channel will be given by @xmath390 in particular , suppose that @xmath189 is the bandwidth of the optical fiber .",
    "then , its two - way capacity @xmath391 provides the maximum number of target bits per second .",
    "note that the previous multiband formula can be easily generalized to the case where the parallel lossy channels have different transmissivities .",
    "we just need to use eq .",
    "( [ lossychannelform ] ) in an additive way as shown in ref .",
    "@xcite .    in the bosonic",
    "setting , another important distillable channel is the quantum - limited amplifier .",
    "this is a gaussian channel whose action on input quadratures is given by @xmath392 , where @xmath393 is the gain and @xmath386 are vacuum quadratures . for any gain , we may write  @xcite @xmath394 where @xmath395 plays the same role as @xmath0 in eq .",
    "( [ lossychannelform ] ) .    in the dv setting ,",
    "dephasing channels are distillable . for qubits ,",
    "this channel is given by the transformation @xmath396 , where @xmath397 is the phase - flip pauli operator and @xmath398 is the probability of such a flip .",
    "the two - way capacity is equal to  @xcite @xmath399 where @xmath400 is the binary shannon entropy  .",
    "this result can be extended to qudits @xmath401 of arbitrary dimension @xmath236 , for which we may write  @xcite @xmath402 where @xmath403 is the shannon entropy and @xmath404 is the probability of @xmath241 phase flips @xmath405 with @xmath406 .",
    "finally , another dv  distillable channel is the erasure channel .",
    "its action is described by @xmath407 , where @xmath398 is the probability that the input state @xmath232 is transformed into an orthogonal erasure state @xmath408 . for qubits , the two - way capacity of an erasure channel",
    "is given by@xmath409 for qudits , it can be generalized to@xmath410 note that the @xmath8 of the erasure channel was proven in ref .",
    "@xcite , while its secret - key capacity @xmath10 has been independently found by refs .  @xcite .",
    "exploiting many of the previous tools , we can now extend the study of adaptive quantum communications beyond the basic scenario of a direct point - to - point connection between alice and bob .",
    "the first non - trivial extension is to consider a single linear chain of quantum repeaters between the two remote parties .",
    "this is the simplest example of a multi - hop quantum network .",
    "consider alice and bob to be end - points of a linear chain of @xmath411 points with @xmath25 repeaters in the middle .",
    "for @xmath29 we assume that point @xmath43 is connected with point @xmath412 by a quantum channel @xmath39 which can be forward or backward , for a total of @xmath27 channels @xmath413 .",
    "each point has a countable ensemble of quantum systems , denoted by @xmath44 for the @xmath43-th point .",
    "in particular , we set @xmath414 for alice and @xmath415 for bob .",
    "to simplify notation , we update the local ensembles so that a system @xmath416 to be transmitted is extracted from the origin ensemble @xmath417 , and a system @xmath416 received is absorbed by the target ensemble @xmath418 .",
    "the most general distribution protocol over the chain is based on adaptive los and unlimited two - way cc involving all the points in the chain . in other words ,",
    "each point broadcasts classical information and receives classical feedback from all the other points , which is used to perform conditional los on the local ensembles . in the following we always assume these network  adaptive loccs , unless we specify otherwise .",
    "the first step is the preparation of the initial state of the local ensembles by a locc @xmath271 which provides a separable state @xmath419 .",
    "then , alice and the first repeater exchange a quantum system through channel @xmath420 . for a forward transmission ,",
    "this means that alice transmits a system @xmath421 and the repeater gets its output @xmath416 with the update @xmath422 . for a backward transmission ,",
    "the repeater transmits a system @xmath423 and alice gets @xmath424with the update @xmath425 . in each case",
    ", this transmission is followed by a locc @xmath274 on the local ensembles @xmath426 .",
    "next , the first and the second repeaters exchange another quantum system through channel @xmath427 followed by another locc @xmath279 applied to all the ensembles , and so on . finally , bob exchanges a system with the @xmath25th repeater through channel @xmath428 and the final locc @xmath429 provides the output state @xmath430 .",
    "this procedure completes the exchange of a quantum system through the chain . in the second round",
    ", the initial state is the ( non - separable ) output state of the first round @xmath431 .",
    "the protocol goes as before with each pair of points @xmath43 and @xmath412 exchanging one system between two loccs .",
    "the second round ends by giving the output state @xmath432 which is the input for the third round and so on .",
    "after @xmath14 rounds , all the points share an output state @xmath433 . by tracing out the repeaters , we get alice and bob s final state @xmath16 .",
    "this state is obtained after @xmath14 uses of the chain @xmath28 and depends on the whole sequence of adaptive loccs @xmath434 .",
    "the previous adaptive protocol has an average rate of @xmath282 if @xmath283 , where @xmath285 is a target state with @xmath286 bits .",
    "by taking the limit of @xmath435  and optimizing over @xmath288 , we define the ( generic ) repeater - assisted capacity for the two end - points of the chain , i.e. , @xmath436 let us specify the task of the distribution protocol . for qkd , the target state is a private state  @xcite with secret key rate @xmath290 ( bits per chain use ) . in this case @xmath33 describes the repeater - assisted secret key capacity@xmath437    for entanglement distillation ( ed ) , the target state is a maximally - entangled state with rate @xmath438 ( ebits per chain use ) . in this other case",
    ", @xmath33 represents the repeater - assisted entanglement distillation capacity @xmath439 since an ebit can teleport a qubit and a qubit can distribute an ebit , @xmath9 coincides with the repeater - assisted quantum capacity , i.e. , @xmath440 .",
    "we can build an upper bound for all the previous capacities , i.e. , for the generic @xmath33 .",
    "in fact , using the general inequality in eq .",
    "( [ forproofs ] ) , we may write @xmath441 this upper bound can be extremely simplified in the case of a stretchable chain , i.e. , a chain composed by stretchable channels .",
    "it is sufficient to extend the notion of entanglement flux to a chain and then suitably stretch the repeater - based protocol by teleportation .",
    "recall that the entanglement flux  @xmath22  of a channel @xmath15 is defined as the ree of its choi matrix , i.e. , @xmath442 .",
    "thus , we may define the entanglement flux of a chain as the minimum flux of its channels @xmath443 for a stretchable chain , this quantity bounds the maximum entanglement that can be distributed between the two end - points .",
    "most importantly , it bounds all the repeater - assisted capacities .",
    "we have the following .    [ stretchable chains][theochain]consider a linear chain of @xmath411 points connected by stretchable channels @xmath444 .",
    "the most general adaptive protocol over @xmath14 uses of the chain provides the output@xmath445 where @xmath49 is a trace - preserving locc . as a result ,",
    "the repeater - assisted capacities are all bounded by the entanglement flux of the chain , i.e.,@xmath446    * proof .",
    "*  to prove the decomposition in eq .",
    "( [ repde ] ) consider the case of @xmath447-point chain ( @xmath448 ) , where alice @xmath11 and bob @xmath12 are connected with a middle repeater @xmath449 by means of two stretchable channels @xmath15 and @xmath450 .",
    "this is shown in fig .  [ repic ] for the first two uses of the repeater .",
    "the direction of the channels can be different and the extension to arbitrary @xmath25 is just a matter of technicalities . as depicted in fig .",
    "[ repic ] , we can stretch the protocol iteratively .",
    "each time we stretch a transmission between two ensembles , we accumulate a choi matrix at the input , which distributes entanglement between those two ensembles .",
    "correspondingly , the two adaptive loccs ( before and after the transmission ) are collapsed into a single trace - preserving locc , with the output state @xmath451 becoming the input state for the next transmission .",
    "after two uses of the repeater we have the output state @xmath452 . by tracing the repeater @xmath449 , we derive @xmath453 up to re - defining the locc . by extending the procedure to an arbitrary number of repeaters @xmath25 and",
    "uses @xmath14 , we get@xmath454     by alice @xmath11 and bob @xmath12 , where each use involves the transmissions of two systems @xmath455 and @xmath456 , through channels @xmath15 and @xmath450 .",
    "each transmission occurs between two loccs .",
    "we iterate the method of teleportation stretching to simplify transmission after transmission . at the end",
    "we trace the repeater.,scaledwidth=38.0% ]    the procedure leading to the decompositions in eq .",
    "( [ decoproof ] ) can be made completely formal as follows .",
    "suppose that the @xmath457th transmission occurs between repeater @xmath44 and @xmath45 via channel @xmath39 .",
    "let us denote by @xmath458 the total state of the chain after this transmission , where @xmath459 is the ensemble of all the repeaters . then",
    ", we may modify our building block  eq .",
    "( [ iter ] ) into@xmath460 where @xmath225 and @xmath461 are ancillary systems absorbed by repeaters @xmath44 and @xmath45 , respectively , and @xmath462  is a trace - preserving locc .",
    "suppose that the transmissions are sequential , as described in the basic repeater protocol , so that the first transmission is between alice @xmath414 and the first repeater @xmath463 and so on .",
    "this means to set @xmath464  in eq .",
    "( [ toiterate ] ) for @xmath29 .",
    "starting from the separable state @xmath465 , we derive @xmath466 which leads to@xmath467    this completes the first use of the chain . in the second use of the chain , the input state becomes @xmath468 and we iterate eq .",
    "( [ toiterate ] ) with @xmath469 , so that we have@xmath470 an so on , with similar expressions up to @xmath471 . by replacing as before ,",
    "we derive @xmath472   .\\ ] ] after @xmath14 uses of the chain , we then get@xmath473   .",
    "\\label{lambdaall}\\ ] ] this can be re - written as @xmath474 where we exploit the fact that @xmath475  is separable and , therefore , can be included in the global locc . finally , tracing out the repeaters @xmath476 , we may write @xmath477 where @xmath40 is another trace - preserving locc .    it is important to note that we can equivalently reach the final result of eq .",
    "( [ finalapp ] ) also considering other orderings for the transmissions between the repeaters , i.e. , not necessarily sequential , one after the other .",
    "one can check that a random permutation of the order of the transmissions corresponds to a permutation of the @xmath462 in eq .",
    "( [ lambdaall ] ) .",
    "therefore , by teleportation stretching , we have reached the stretched scenario @xmath478 which is depicted in the left side of fig .",
    "[ reduction ] .",
    "the quantum transmissions between each pair of near - neighbor points have been replaced with tensor - products of choi matrices , followed by a single but complicated trace - preserving locc @xmath19 . in this reduction ,",
    "the choi matrices are responsible for distributing entanglement between the points of the chain .    in order to get tight upper bounds we need to perform a further manipulation of the scheme , which allows us to improve the decompositions in eq .",
    "( [ decoproof ] ) . as mentioned before in our general sec .",
    "[ generalsection ] , this is possible by introducing an entanglement cut of the chain , such that alice and bob end up to be disconnected . in a linear chain ,",
    "the situation is particularly simple , because any cut disconnects the end - points .",
    "the procedure goes as follows .",
    "let us perform a cut @xmath43  of the chain between repeaters @xmath44 and @xmath45 .",
    "this cut disconnects channel @xmath39 ( before stretching ) and disentangles its choi matrix @xmath38 ( after stretching ) .",
    "we extend alice and bob to the corresponding partitions , i.e. , we consider @xmath479 to be an extended alice  and @xmath480 to be an extended bob .",
    "see the right side of fig .",
    "[ reduction ] .",
    "all the choi matrices @xmath481 with @xmath482 are included in alice s los , and all those with @xmath483 are included in bob s .",
    "therefore , we are left with a reduced input @xmath484 which is processed by a corresponding trace - preserving locc @xmath49 . by tracing out all the middle repeaters @xmath485 ,",
    "the locc @xmath49 remains local with respect to @xmath11 and @xmath12 , and we get the end - to - end output @xmath102 .",
    "this leads to eq .",
    "( [ repde ] ) for any cut @xmath43 .    at this point",
    ", we apply the ree to the reduced decomposition of eq .",
    "( [ repde ] ) .",
    "since the ree is non - decreasing under trace - preserving loccs and additive under tensor products , this leads to @xmath486 for any cut @xmath43 . by replacing the latter inequality in eq .",
    "( [ hard ] ) , we derive @xmath487 for any cut @xmath43 .",
    "finally , by minimizing over all possible cuts , we find @xmath488 , which is eq.@xmath489([theore]).@xmath490    as already noted in the previous proof , the stretched scenario depicted in fig .",
    "[ reduction ] remains the same if we randomly permute the order of the transmissions in the quantum communication .",
    "for instance , in some use of the chain , the first transmission might occur between two repeaters , with the transmission between alice and the first repeater only occurring at a later time .",
    "this permutation - invariance is true proviso that we suitably replace the final trace - preserving locc in eq .",
    "( [ decoproof ] ) and , therefore , in eq .",
    "( [ repde ] ) .",
    "thus , the main result in eq .",
    "( [ theore ] ) is valid for any order of the transmissions in the chain .",
    "now , by using theorem  [ theochain ] , we can bound the maximal rates for entanglement distillation ( @xmath9 ) , quantum communication ( @xmath8 ) and secret key generation ( @xmath10 ) through a stretchable chain of repeaters .",
    "it is in fact sufficient to compute the entanglement flux of each individual channel @xmath491 and take the minimum . as discussed in sec .",
    "[ secprelimi ] , the entanglement flux has been computed for many fundamental channels , including all pauli channels , erasure channels and all single - mode gaussian channels  @xcite .    as we also know from section  [ secprelimi ] , there is a class of stretchable channels for which the entanglement flux coincides with the two - way capacities , i.e. , @xmath492 with @xmath493 , @xmath8 or @xmath10 .",
    "this is the class of distillable channels , which include lossy channels , quantum - limited amplifiers , dephasing and erasure channels in arbitrary dimension . for chains involving these channels ( distillable chains )",
    ", we can easily show that a repeater protocol based on a point - to - point composition is able to achieve the entanglement flux of the chain @xmath52 . as a result",
    "we can establish all the repeater - assisted capacities of a distillable chain . in detail",
    ", we have the following .    [ distillable chains][chaincoro]consider a chain of @xmath411 points connected by @xmath27  distillable channels @xmath28 .",
    "the repeater - assisted capacity of the chain is equal to its entanglement flux . in turn",
    ", this is equal to the minimum among the two - way capacities of the individual channels@xmath494    * proof . *  for distillable channels",
    ", we have @xmath53 .",
    "thus , from theorem  [ theochain ] , we find @xmath495 .",
    "it is clear that @xmath496 is also an achievable lower bound for @xmath33 . in fact , @xmath497 is the capacity for the point - to - point connection between @xmath44 and @xmath45 , not assisted by the other points . by performing optimal point - to - point adaptive protocols between each pair of near - neighbor points and finally composing all the point - to - point outputs ( e.g. , by entanglement swapping or classical key composition )",
    ", alice and bob can communicate at a rate @xmath55 which is at least the minimum of the single - connection capacities , i.e. , @xmath498.@xmath490        then , consider an amplifying chain which is connected by quantum - limited amplifiers with arbitrary gains @xmath502 .",
    "the repeater - assisted capacity is fully determined by the highest gain @xmath503 , so that @xmath504 in the dv setting , we consider spin chains affected by dephasing or erasure . for a spin chain where the state transfer between the @xmath43th spin and the next one is modelled by a dephasing channel with probability @xmath505 , we find@xmath506 where @xmath507 is the maximum probability of phase flipping in the chain , and @xmath508 is the binary shannon entropy .",
    "when the spins are connected by erasure channels with probabilities @xmath509 , then we have @xmath510 where @xmath511 is the maximum probability of an erasure .",
    "note that the latter results for the spin chains can be readily extended from qubits to qudits of arbitrary dimension @xmath236 , by using the two - way capacities of eqs .",
    "( [ dephagen ] ) and  ( [ erasuregen ] ) .",
    "finally , note that the general eq .",
    "( [ reppasscc ] ) may be applied to hybrid distillable chains , where channels are distillable but of different kind between each pair of repeaters , e.g. , we might have erasure channels alternated with dephasing channels or lossy channels , etc .",
    "let us discuss in more detail the use of quantum repeaters in the bosonic setting .",
    "suppose that we are given a long communication line with transmissivity @xmath0 , such as an optical / telecom fiber .",
    "a cut of this line generates two lossy channels with transmissivities @xmath512 and @xmath513 such that @xmath514 .",
    "suppose that we are also given a number @xmath25 of repeaters that we could potentially insert along the line .",
    "the question is : _ what is the optimal way to cut the line and insert the repeaters ? _    from the formula in eq .",
    "( [ lossychain ] ) , we can immediately see that the optimal solution is to insert @xmath25  equidistant repeaters , so that the resulting @xmath27 lossy channels have identical transmissivities @xmath515{\\eta}~.\\ ] ] this leads to the maximum repeater - assisted capacity@xmath516{\\eta}\\right ) ~. \\label{optlosscap}\\ ] ] this capacity is plotted in fig .",
    "[ lossybits ] for increasing number of repeaters @xmath25 as a function of the total loss of the line , which is expressed in decibel ( db ) by @xmath517 .",
    "in particular , we compare the repeater - assisted capacity with the point - to - point benchmark , i.e. , the maximum performance achievable in the absence of repeaters .     and @xmath518 equidistant repeaters .",
    "compare the repeater - assisted capacities ( solid curves ) with the point - to - point capacity ( no repeaters , dashed curve).,scaledwidth=48.0% ]    suppose that we require a minimum performance of @xmath519 bit per use of the line ( depending on the specific protocol , this could be @xmath519 secret bit or @xmath519 ebit or @xmath519 qubit ) . from eq .",
    "( [ optlosscap ] ) , we see that we need at least @xmath520 equidistant repeaters .",
    "this is about @xmath519 quantum repeater every @xmath521db loss , corresponding to about @xmath522 km in standard optical fiber ( at the loss rate of @xmath523db / km ) .",
    "let us study two opposite regimes that we may call repeater - dominant and loss - dominant . in the former , we fix the total transmissivity @xmath0 of the line and use many equidistant repeaters @xmath524 .",
    "we then have@xmath525 which means that the capacity scales logarithmically in the number of repeaters , independently from the loss .",
    "in the second regime ( loss - dominant ) , we fix the number of repeaters @xmath25 and we consider high loss @xmath526 , in such a way that each link of the chain is very lossy , i.e. , we may set @xmath527{\\eta}\\simeq0 $ ] .",
    "we then find@xmath528{\\eta}}{\\ln 2}\\simeq1.44~\\sqrt[n+1]{\\eta},\\ ] ] which is also equal to @xmath527{\\eta}$ ] nats per use .",
    "this is the fundamental rate - loss scaling which affects long - distance repeater - assisted quantum optical communications .    in the bosonic",
    "setting , it is interesting to compare the use of quantum repeaters with the performance of a point - to - point quantum communication through a multiband channel .",
    "assume that alice and bob can exploit a communication line which is composed of @xmath189  parallel and independent lossy channels with identical transmissivity @xmath0 . for instance , @xmath189 can be interpreted as the frequency bandwidth of a multimode optical fiber . as",
    "already discussed in sec .",
    "[ secprelimi ] , the two - way capacity of such multiband lossy channel is given by  @xcite@xmath529    by comparing eqs .",
    "( [ optlosscap ] ) and  ( [ mband ] ) we compare the use of @xmath25 equidistant repeaters with the use of @xmath189 bands . from fig .",
    "[ compara ] , we clearly see that multiband quantum communication provides an additive effect on the capacity which is very useful at short - intermediate distances .",
    "however , at long distances , this solution is clearly limited by the same rate - loss scaling which affects the single - band quantum channel ( point - to - point benchmark ) and , therefore , it can not compete with the long - distance performance of repeater - assisted quantum communication .",
    "we compare the use of repeaters ( @xmath530 ) with that of a point - to - point multiband communication ( for @xmath531 , @xmath518 , and @xmath532 bands or parallel channels ) .",
    "dashed line is the point - to - point benchmark ( single - band , no repeaters ) .",
    "we see how the multiband strategy increases the capacity in an additive way but it clearly suffers from a poor long - distance rate - loss scaling with respect to the use of quantum repeaters.,scaledwidth=46.0% ]      in general , the most powerful approach consists of relaying multiband quantum communication , i.e. , combining multiband channels with quantum repeaters . in this regard ,",
    "let us first discuss how theorem  [ theochain ] and corollary  [ chaincoro ] can be easily extended to repeater chains which are connected by multiband quantum channels .",
    "then , we describe the performances in the bosonic setting .",
    "consider a multiband channel @xmath533 which is composed of @xmath189 independent channels ( or bands ) @xmath534 , i.e. , @xmath535 by taking @xmath189 ideal epr states at the input , we define its choi matrix as @xmath536 \\nonumber\\\\ &   = { \\textstyle\\bigotimes\\nolimits_{k=1}^{m } } \\rho_{\\mathcal{e}_{k}},\\end{aligned}\\ ] ] so that its entanglement flux is given by @xmath537 note that the subadditivity of the ree implies@xmath538 here @xmath539 is connected with the definition of broadband entanglement flux that is given afterwards for a quantum network under parallel routing ( of which a multiband repeater chain can be seen as a very specific case ) .",
    "a multiband channel @xmath533 is said  to be stretchable ( distillable ) if all its components @xmath534 are stretchable ( distillable ) .    given a repeater chain which is connected by multiband stretchable channels @xmath540 , we can repeat all the derivation which leads to eq .",
    "( [ repde ] ) of theorem  [ theochain ] .",
    "then , we may re - write eq .",
    "( [ theore ] ) explicitly as@xmath541 we may also extend our corollary  [ chaincoro ] to a repeater chain which is connected by multiband distillable channels .",
    "in fact , for the two - way capacity of any multiband distillable channel as in eq .",
    "( [ multibandgen ] ) , one easily shows  @xcite @xmath542 which is due to the fact that each component @xmath534 is distillable , therefore satisfying @xmath543 .",
    "using eq .",
    "( [ band2 ] ) for each multiband channel @xmath544 that is present in eq .",
    "( [ band1 ] ) , it is therefore immediate to show@xmath545 for any multiband distillable chain .    in the bosonic setting , consider a chain of @xmath25 quantum repeaters with @xmath27 channels @xmath28 , where @xmath39 is a multiband lossy channel with @xmath546 bands and constant transmissivity @xmath499 ( over the bands )  @xcite .",
    "the two - way capacity of the @xmath43th link is therefore given by @xmath547 as specified by eq .",
    "( [ mband ] ) . because multiband lossy channels are distillable",
    ", we can apply eq .",
    "( [ banddistill11 ] ) and derive the following repeater - assisted capacity of the multiband lossy chain@xmath548 \\nonumber\\\\ &   = -\\log_{2}\\left [   \\max_{i}(1-\\eta_{i})^{m_{i}}\\right ] \\nonumber\\\\ &   : = -\\log_{2}\\theta_{\\max}~. \\label{prebandr}\\ ] ]    as before , it is interesting to discuss the symmetric scenario where the @xmath25 repeaters are equidistant , so that entire communication line is split into @xmath27 links of the same optical length .",
    "each link @xmath43  is therefore associated with a multiband lossy channel , with bandwidth @xmath546 and constant transmissivity @xmath549{\\eta}$ ] ( equal for all its bands ) . in this case , we have @xmath550{\\eta})^{\\min_{i}m_{i}}$ ] in previous eq .",
    "( [ prebandr ] ) . in other words , the repeater - assisted capacity of the chain becomes@xmath551{\\eta}),\\ ] ] where @xmath552 is the minimum bandwidth along the line , as intuitively expected .    in general",
    ", the capacity is determined by an interplay between transmissivity and bandwidth of each link .",
    "this is particularly evident in the regime of high loss . by setting @xmath553 in eq .",
    "( [ prebandr ] ) , we derive@xmath554 where the constant @xmath555 is equal to @xmath388 bits or @xmath519 nat .",
    "we now consider the general case of a quantum network , where two end - users are connected by an arbitrary ensemble of routes through intermediate points or repeaters . assuming the most basic quantum channels for the various point - to - point connections , we determine the end - to - end capacities for quantum communication , entanglement distillation and key generation under different routing strategies . as mentioned in sec .",
    "[ generalsection ] , our analysis combines tools from quantum information theory ( in particular , the generalization of the tools developed in ref .",
    "@xcite , needed for the converse part ) and elements from classical network information theory ( which are necessary for proving the achievability part ) .    in this section ,",
    "we start by providing preliminary notions and discussing the main network protocols based on sequential or parallel routing of quantum systems .",
    "we then give the corresponding definitions of end - to - end network capacities . in the following sections",
    ", we will study quantum networks based on stretchable channels ( for which we can bound the capacities , sec .  [ secstretchingnet ] ) and",
    "quantum networks based on distillable channels ( for which we can exactly establish the capacities , sec .  [ secdistillablenet ] ) .",
    "consider a quantum communication network @xmath142 whose points are connected by memoryless quantum channels .",
    "as already discussed in sec .",
    "[ generalsection ] , the quantum network can be represented as an undirected finite graph  @xcite @xmath63 where @xmath64 is the finite set of points of the network ( vertices ) and @xmath65 is the set of all connections ( edges ) .",
    "every point @xmath556 has a local ensemble of quantum systems @xmath173 to be used for the quantum communication . to simplify notation",
    ", we identify a point with its local ensemble @xmath557 .",
    "two points @xmath558 are connected by an undirected edge @xmath105 if there is a memoryless quantum channel @xmath104 between @xmath173  and @xmath178 , which may be forward @xmath559  or backward @xmath560 .",
    "in general , there may be multiple edges between two points , with each edge representing an independent quantum channel .",
    "for instance , two undirected edges between @xmath173  and @xmath178 represent two channels @xmath561  and these may be associated with a double - band quantum communication ( in one of the two directions ) or a two - way quantum communication ( forward and backward channels ) . while we allow for the possibility of multiple edges in the graph ( so that it is more generally a multi - graph ) we may also collapse multiple edges into a single edges to simplify the complexity of the network and therefore notation .",
    "for instance , we use single edges in a quantum network which is only connected by multi - band channels , so that the quantum communication is implicitly multi - band .    in the following",
    ", we also use the labeled notation @xmath69 for the generic point of the graphical network , so that two points @xmath69 and @xmath70 are connected by an edge if there is a quantum channel @xmath72 .",
    "we also adopt the specific notation @xmath11 and @xmath12 for the two end - points , alice and bob .",
    "an end - to - end route is an undirected path between alice and bob , which is specified by a sequence of edges @xmath562 , simply denoted as @xmath563 .",
    "this may be interpreted as a linear chain of @xmath25 repeaters between alice and bob , connected by a sequence of @xmath27 channels @xmath564 , i.e.,@xmath565 where the same repeater may appear at different positions ( in particular , this occurs when the route is not a simple path , so that there are cycles ) .",
    "in general , the two end - points may transmit quantum systems through an ensemble of routes @xmath566 .",
    "note that this ensemble is generally large but can always be made finite in a finite network , by just reducing the routes to be simple paths , void of cycles ( without losing generality ) .",
    "different routes @xmath75 and @xmath567 may have collisions , i.e. , repeaters and channels in common .",
    "generic route @xmath75 involves the transmission through @xmath568 channels @xmath569 . in general",
    ", we assume that each quantum transmission through each channel is alternated with network loccs : these are defined as adaptive los performed by all points of the network on their local ensembles , which are assisted by unlimited two - way cc involving the entire network .",
    "finally , we consider two possible fundamental strategies for routing the quantum systems through the network : sequential or parallel . in a sequential or single - path routing ,",
    "quantum systems are transmitted from alice to bob through a single route for each use of the network .",
    "this process is generally stochastic , so that route @xmath75 is chosen with some probability @xmath570 . by contrast , in a parallel or multi - path routing , systems are simultaneously transmitted through multiple routes for each use of the network .",
    "this is called broadband use  of the quantum network and is generally stochastic .",
    "the most general network protocol for sequential quantum communication involves the use of generally - different routes , accessed one after the other .",
    "the network is initialized by means of a first locc @xmath271 which prepares an initial separable state . with probability @xmath571 , alice @xmath11 exchanges one system with repeater @xmath69 .",
    "this is followed by another locc @xmath274 .",
    "next , with probability @xmath572 , repeater @xmath69 exchanges one system with repeater @xmath70 and so on . finally , with probability @xmath573 , repeater @xmath574 exchanges one system with bob @xmath12 , followed by a final locc @xmath575 .",
    "thus , with probability @xmath576 , the end - points exchange one system which has undergone @xmath577 transmissions @xmath578 along the first route .",
    "the next uses involve generally - different routes .",
    "after many uses @xmath14 , the random process defines a sequential routing table @xmath579 , where route @xmath75 is picked with probability @xmath90 and involves @xmath568 transmissions @xmath136 .",
    "thus , we have a total of @xmath580 transmissions and a sequence of loccs @xmath581 , whose output provides alice and bob s final state @xmath102 .",
    "note that we may weaken the previous description : while maintaining the sequential use of the routes , in each route we may permute the order of the transmissions ( as before for the case of a linear chain of repeaters ) .",
    "the sequential network protocol is characterized by @xmath582 and @xmath288 , and its average rate is @xmath282 if @xmath299 , where @xmath285 is a target state of @xmath286 bits . by taking the asymptotic rate for large @xmath14 and optimizing over all the sequential protocols , we define the sequential or single - path capacity of the network@xmath583 the capacity @xmath103 provides the maximum number of ( quantum , entanglement , or secret ) bits which are distributed per sequential use of the network or single - path transmission . in particular , by specifying the target state , we define the corresponding network capacities for quantum communication , entanglement distillation and key generation , which satisfy @xmath584    it is important to note that the sequential use is the best practical strategy when alice and the other points of the network aim to optimize the use of their quantum resources .  in fact ,",
    "@xmath103 can also be expressed as maximum number of target bits per quantum system routed . furthermore , suppose that the end - points have control on the routing , so that they can adaptively select the best routes based on the ccs received by the repeaters . under such hypothesis , they can optimize the protocol on the fly and adapt the routing table so that it asymptotically converges to the use of an optimal route @xmath121 .",
    "see fig .",
    "[ net1 ] for an example of sequential use of a simple network .     and bob @xmath12 . in a diamond network with four points @xmath77 , @xmath91 , @xmath92 , and @xmath78",
    ", we may identify four basic routes @xmath585 ( see list on the right ) .",
    "these are simple paths between alice and bob with the middle points @xmath91 and @xmath92 acting as quantum repeaters in different succession .",
    "for instance , @xmath91 is the first repeater in route @xmath447 and the second repeater in route @xmath85 . note that we may consider further routes by including loops between @xmath91 and @xmath92 .",
    "these other solutions are non - simple paths that we may discard without losing generality.,scaledwidth=50.0% ]      here we consider a different situation where alice , bob and the other points of the network do not have restrictions or costs associated with the use of their quantum resources , so that they can optimize the use of the quantum network without worrying if some of their quantum systems are inefficiently transmitted or even lost ( this may be the practical scenario of many optical implementations , e.g. , based on cheap resources like coherent states ) . in such a case ,",
    "the optimal use of the quantum network is parallel or broadband , meaning that the quantum systems are simultaneously routed through multiple paths each time the quantum network is accessed .    in a broadband network protocol ,",
    "alice broadcasts quantum systems to all repeaters she has a connection with .",
    "such a simultaneous transmission to her neighbor  repeaters can be denoted by @xmath157 . in turn , each of the receiving repeaters multicasts quantum systems to another set of neighbor repeaters @xmath586 and so on , until bob @xmath12 is reached as an end - point .",
    "this is done in such a way that each multicast occurs between two network loccs , and different multicasts do not overlap , so that all edges of the network are used exactly once at the end of each end - to - end transmission .",
    "this condition is assured by imposing that multicasts may only occur though unused connections .    in general , each multicast",
    "must be intended in a weaker sense as a point - to - multipoint connection where quantum systems may be exchanged through forward or backward transmissions , depending on the actual physical directions of the available quantum channels . independently from the physical directions of the channels , we may always assign a common sender - receiver direction to all the edges involved in the process , so that there will be a _",
    "logical _ sender - receiver orientation associated with the multicast .",
    "for this reason , the notation @xmath157 must be generally interpreted as a logical multicast where alice connects to  repeaters @xmath156 . to better explain this broadband use , let us better formalize the orientations .",
    "recall that a directed edge is an ordered pair @xmath130 , where the initial vertex @xmath173 is called tail  and the terminal vertex @xmath178 is called head .",
    "let us transform the undirected graph of the network @xmath63 into a directed graph by randomly choosing a direction for all the edges , while keeping alice as tail and bob as head .",
    "the goal is to represent the quantum network as a flow network where alice is the _ source _ and bob is the _ sink _  @xcite . in general , there are many solutions for this random orientation .",
    "in fact , consider the sub - network where alice and bob have been disconnected , i.e. , @xmath587 with @xmath588 .",
    "there are @xmath589 possible directed graphs that can be generated , where @xmath590 is the number of undirected edges in @xmath591 .",
    "thus , we have @xmath589  orientations of the original network @xmath142 .",
    "each of these orientations defines a flow network and provides possible strategies for broadband routing @xmath592 .",
    "see fig .",
    "[ net2b ] for a simple example .    , @xmath593 , and @xmath594 .",
    "other routings are given by permuting these multicasts .",
    "for instance , we may have the different sequence @xmath593 , @xmath594 and @xmath595 for the upper orientation . in the lower orientation",
    ", we have the basic broadband routing @xmath595 , @xmath596 and @xmath597 , plus all the possible permutations.,scaledwidth=50.0% ]    to better formalize the routing strategy , let us exploit the notions of in- and out - neighborhoods .",
    "given an orientation of @xmath142 , we have a corresponding flow network , denoted by @xmath598 , where @xmath599 is the set of directed edges .",
    "for arbitrary point @xmath67 , we define its out - neighborhood as the set of heads going from @xmath67@xmath600 and its in - neighborhood as the set of tails going into @xmath67@xmath601 a logical multicast from point @xmath67 can be defined as a point - to - multipoint connection from @xmath67 to all its out - neighborhood @xmath602 , i.e. , @xmath603 .",
    "a broadband routing strategy can therefore be defined as an ordered sequence of all such multicasts .",
    "see fig .",
    "[ net2b ] .    using these definitions",
    "we may easily formalize the broadband network protocol .",
    "suppose that we have @xmath604 points in the network ( @xmath397 repeaters plus the two end - points ) .",
    "the first step of the protocol is the agreement of a broadband routing strategy @xmath605 by means of preliminary ccs among all the points .",
    "this is part of an initialization locc @xmath271 which prepares an initial separable state for the entire network .",
    "then , alice @xmath11  exchanges quantum systems with all her out - neighborhood @xmath606 .",
    "this multicast is followed by a network locc @xmath607 .",
    "next , repeater @xmath608 exchanges quantum systems with all its out - neighborhood @xmath609 , which is followed by another locc @xmath279 and so on . at some step @xmath610 ,",
    "bob @xmath12 will have exchanged quantum systems with all his in - neighborhood @xmath611 , after which there is a final locc @xmath612 .",
    "this completes the first broadband transmission between the end - points by means of the routing @xmath605 and the sequence of loccs @xmath613 .",
    "then , there will be the second broadband use of the network with a generally different routing strategy @xmath614 , and so on .",
    "see fig .  [ duo ] for a simple example .",
    ", after the initial locc @xmath271 , there is the first multicast @xmath595 , followed by the locc @xmath274 .",
    "then , we have the second multicast @xmath615 followed by @xmath279 . finally , we have @xmath594 followed by the final locc @xmath616",
    "this completes a single end - to - end broadband transmission . in the lower routing @xmath614 ,",
    "the process is similar to @xmath605 but with @xmath91 and @xmath92 being inverted.,scaledwidth=45.0% ]    let us note that the points of the network may generally update their routing strategy on the fly , i.e. , while the protocol is running  @xcite ; then , the various multicasts may be suitably permuted in their order . in any case , for large number of uses @xmath14 , we will have a sequence of broadband routing strategies @xmath617 and network loccs @xmath618 whose output provides alice and bob s final state @xmath102 .",
    "the broadband network protocol will be fully described by @xmath619 and @xmath288 . by definition ,",
    "its average rate is @xmath282 if @xmath283 , where @xmath285 is a target state of @xmath286 bits .",
    "the broadband or multipath capacity of the network is defined by optimizing the asymptotic rate over all protocols , i.e. , @xmath620 by specifying the target state , we define the broadband network capacities for quantum communication , entanglement distillation and key generation , satisfying @xmath621    before proceeding some other considerations are in order .",
    "note that the uses of the network may also be re - arranged in such a way that each point performs all its multicasts before another point .",
    "for instance , in the example of fig .  [ duo ] , we may consider alice performing all her @xmath14 multicasts @xmath622 as a first step .",
    "suppose that routes @xmath605 and @xmath614  are chosen with probability @xmath398 and @xmath623 .",
    "then , after alice has finished ,  point @xmath91 performs its @xmath624 multicasts and @xmath92  performs its @xmath625 multicasts , and so on .",
    "we may always re - arrange the protocol and adapt the locc sequence @xmath288 to include this variant .",
    "then , there is a simplified formulation to keep in mind .",
    "in fact , a special case is when the various multicasts within the same routing strategy are not alternated with network loccs but they are all performed simultaneously , with only the initial and final loccs to be applied .",
    "for instance , for the routing @xmath605 of fig",
    ".  [ duo ] , this means to set @xmath626 and assume that the multicasts @xmath595 , @xmath615 and @xmath594 occur simultaneously , after the initialization @xmath271 and before @xmath627 . in general , any variant of the broadband protocol may be considered as long as each quantum channel ( edge ) is used exactly @xmath14 times at the end of the communication , i.e. , after @xmath14 uses of the quantum network  @xcite .    in the following ,",
    "we show that the network capacities ( sequential and broadband ) can be suitably upper - bounded in the case of a stretchable network , i.e. , a quantum network connected by stretchable channels .",
    "this is possible by stretching the quantum network into a tensor - product of choi matrices and then applying further manipulations based on entanglement cuts and the ree .",
    "then , we will show that we can compute exactly @xmath103 and @xmath158 in the case of a distillable network , i.e. , a quantum network connected by distillable channels .",
    "consider a quantum network which is connected by stretchable channels . the simplification of this network via teleportation stretching generalizes the procedure employed for a linear chain of quantum repeaters , with the important difference that we now have many possible chains ( the network routes ) and these may have collisions , i.e. , repeaters and channels in common .",
    "the stretching of a quantum network is performed iteratively , i.e. , transmission after transmission .",
    "suppose that the @xmath457th transmission in the network occurs between points @xmath173 and @xmath178 via the stretchable channel @xmath104 .",
    "call @xmath628 the total state of the network after this transmission .",
    "then , we may modify eq .",
    "( [ iter ] ) into@xmath629 where @xmath462  is a trace - preserving locc ( see also fig .  [ net3 ] ) .",
    "th transmission between points @xmath173 and @xmath178 of a quantum network .",
    "see text for details.,scaledwidth=50.0% ]    by iterating eq .",
    "( [ net_it ] ) and considering that the initial state of network @xmath630 is separable , we may then write the network output state after @xmath14 transmissions as@xmath631   , \\label{netreduction}\\ ] ] where @xmath109 is the number of uses of channel @xmath104 or , equivalently , edge @xmath130 . then , by tracing out all the points but alice and bob , we get their final shared state @xmath632   , \\ ] ] for another trace - preserving locc @xmath40 .",
    "note that the decomposition of eq .",
    "( [ netreduction ] ) can be written for any adaptive network protocol ( sequential or broadband ) .",
    "in particular , for a broadband network protocol , we have the parallel use of several quantum channels @xmath633 , @xmath634 ,   for each multicast between two loccs .",
    "thus , the previous procedure can be adapted by inserting trivial loccs ( identities ) between every two transmissions belonging to the same multicast ( with corresponding simplifications in the structure of @xmath19 and @xmath40 ) .",
    "the decomposition of eq .",
    "( [ netreduction ] ) is the starting point of our next proofs and can be stated as a lemma .",
    "[ tensor - product choi representation][lemmanet]consider a quantum network @xmath63 connected by stretchable channels and @xmath14 uses of an adaptive network protocol ( sequential or broadband ) so that edge @xmath105 is used @xmath109 times .",
    "up to a trace - preserving locc @xmath19 , we may write the global output state of the network as@xmath635 similarly , alice and bob s output state @xmath102 is given by eq .",
    "( [ lemmanetstretching ] ) up to a different trace - preserving locc @xmath40 .",
    "the content of lemma  [ lemmanet ] is that we may reduce @xmath14 adaptive uses of a stretchable quantum network to an undirected edge - weighted graph @xmath636 , where each edge @xmath105 has a weight @xmath637 providing the number of choi matrices @xmath112 associated with that edge .",
    "we call this choi representation  of the stretchable network .",
    "each choi matrix @xmath112 distributes entanglement between the two points of its edge @xmath130 .",
    "the ensemble of all choi matrices may be seen as a sort of entanglement glue  generated by the protocol for the entire quantum network .",
    "see fig .",
    "[ net4 ]  for an example .    .",
    "before stretching , an arbitrary edge @xmath130 with channel @xmath104 is used @xmath109 times . after stretching , the same edge @xmath130 is associated with @xmath109 copies of the choi matrix @xmath112 .",
    "this matrix distributes entanglement between points @xmath173 and @xmath178 . in the figure ,",
    "we adopt the short - hand notation @xmath638 and @xmath639.,scaledwidth=80.0% ]    now let us better specify the result of the stretching in eq .",
    "( [ lemmanetstretching ] ) for the two different uses of the quantum network ( sequential or parallel ) . for a sequential protocol",
    ", we must clearly have @xmath640 .",
    "furthermore , notice that @xmath109 uses of an edge comes from different routes @xmath75 containing that edge @xmath130  which are sequentially used with probabilities @xmath90 .",
    "it is easy to re - write eq .",
    "( [ lemmanetstretching ] ) as@xmath641 where @xmath642 is the sequence of channels associated with route @xmath75  @xcite . to understand the re - shuffling in eq .",
    "( [ reshuffl ] ) , one applies the previous iteration rule of eq .",
    "( [ net_it ] ) and fig .",
    "[ net3 ] , route - by - route and transmission - by - transmission .",
    "the stretching of the arbitrary route @xmath75 provides @xmath643 .",
    "since this is used @xmath101 times , we then have @xmath644  @xcite .",
    "finally , considering all the routes in @xmath100 we get eq .",
    "( [ reshuffl ] ) . for the broadband protocol",
    ", we have different final decomposition . in this case",
    ", we have @xmath160 for any edge @xmath130 .",
    "this means that we may just simplify eq .",
    "( [ lemmanetstretching ] ) into@xmath645      starting from the choi representation of the quantum network ( lemma  [ lemmanet ] ) , we may perform a further non - trivial simplification which allows us to greatly reduce the number of choi matrices in the decomposition of alice and bob s output state @xmath102 .",
    "this is possible by using suitable alice - bob entanglement cuts of the quantum network .",
    "these types of cuts will enable us to include many choi matrices in alice s and bob s los while preserving the locality between the two end - points .",
    "let us adapt the necessary tools from graph theory ( these tools have been already mentioned in our general sec .",
    "[ generalsection ] ) .    by definition ,",
    "an alice - bob entanglement cut @xmath114 of the quantum network is a bipartition @xmath122 of all the points @xmath64  of the network such that @xmath123 and @xmath646 .",
    "correspondingly , the cut - set of @xmath114 ( here denoted as @xmath117 )  is the set of edges with one end - point in each subset of the bipartition ( so that the removal of these edges disconnects the quantum network ) .",
    "explicitly , @xmath647 note that the cut - set @xmath117  identifies an ensemble of channels @xmath648 before stretching , and a corresponding ensemble of choi matrices @xmath649 after stretching .",
    "similarly , we define the following complementary sets @xmath650 so that @xmath651 .    to simplify the stretching of the network , we then adopt the following procedure .",
    "given an arbitrary alice - bob cut @xmath126 , we extend alice and bob to their corresponding partitions .",
    "this means that we consider an extended alice with total ensemble @xmath115 which is given by all the local ensembles of the points in @xmath127 .",
    "then , all the choi matrices in alice s partition @xmath652 are included as part of the los of the extended alice .",
    "similarly , we consider an extended bob with total ensemble @xmath116  given by all the local ensembles in @xmath249 , and we include the choi matrices @xmath653 in his los .",
    "note that the only choi matrices not absorbed in los are those in the cut - set @xmath128 .",
    "these choi matrices are the only ones responsible for distributing entanglement between the two partitions , i.e. , extended alice @xmath115 and extended bob @xmath116 .",
    "the inclusion of all the other choi matrices into the global locc @xmath19 leads to another trace - preserving quantum operation @xmath654 which remains local with respect to @xmath115 and @xmath116 .",
    "thus , for any alice - bob cut @xmath114 of the network , we may write the following output state for extended alice @xmath115 and extended bob @xmath116 after @xmath14 uses of an adaptive protocol@xmath655   .\\ ] ]    the next step is tracing out all ensembles but the original alice s @xmath11 and bob s @xmath12 .",
    "this operation preserves the locality between @xmath11 and @xmath12 .",
    "in other words , we may write the following reduced output state for the two end - points@xmath656 \\nonumber\\\\ &   = \\bar{\\lambda}_{\\mathbf{ab}}\\left [   \\underset{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}{{\\textstyle\\bigotimes } } ~\\rho_{\\mathcal{e}_{\\mathbf{xy}}}^{\\otimes n_{\\mathbf{xy}}}\\right ]   , \\end{aligned}\\ ] ] where @xmath40 is a trace - preserving locc . all these reasonings automatically transform lemma  [ lemmanet ] into the following improved lemma . see also fig .  [ cut ] for an example .",
    "[ entanglement cuts][reducechoi]in a quantum network @xmath63 connected by stretchable channels , consider @xmath14 uses of an adaptive network protocol ( sequential or broadband ) so that edge @xmath105 is used @xmath109 times .",
    "for any alice - bob entanglement cut @xmath114 of the network , we may write alice and bob s output state as@xmath657 up to a trace - preserving locc @xmath40 .     of the diamond quantum network .",
    "the shown cut creates the two partitions @xmath658 and @xmath659 .",
    "the choi matrices @xmath660 are absorbed in the los of extended alice @xmath115 , while the choi matrices @xmath661 are absorbed in the los of extended bob @xmath116 .",
    "the cut - set is composed by the set of edges @xmath662 with corresponding choi matrices @xmath663 , @xmath664 and @xmath665",
    ". this subset of choi matrices can be used to represent the output state of alice and bob @xmath161 according to eq .",
    "( [ cuteq]).,scaledwidth=78.0% ]      to derive upper bounds for the end - to - end capacities ( sequential and broadband ) of a stretchable network , we first need to extend the notion of entanglement flux , taking into account of the network topology and the possible entanglement cuts . given an arbitrary quantum network @xmath63 , we may associate an entanglement flux @xmath666 to each edge @xmath105 , as given by the entanglement flux of the corresponding quantum channel @xmath104 , i.e. , @xmath667 as a matter of fact , this is equivalent to map the original quantum network @xmath142 into an undirected edge - weighted graph @xmath636 , where edge @xmath105 has weight @xmath668 .",
    "see fig .",
    "[ cutflux ] for an example of such an entanglement flux representation .",
    ", we consider the fluxes in the cut - set @xmath117 , here corresponding to @xmath669 , @xmath670 and @xmath671 .",
    "their maximum provides the entanglement flux of the cut @xmath672 , while their sum provides the broadband entanglement flux of the cut @xmath163.,scaledwidth=50.0% ]    then , for an arbitrary alice - bob entanglement cut @xmath114 of the quantum network , we define its entanglement flux as the maximum of the fluxes in the cut - set , i.e. , @xmath673 this quantity represents the maximum entanglement that can be distributed by an edge ( e.g. of a route ) between the two partitions @xmath115 and @xmath116 of the cut .",
    "similarly , we define the broadband entanglement flux of the cut as the sum of the fluxes in the cut - set , i.e.,@xmath674 this other quantity represents instead the maximum entanglement that can be distributed overall between the two partitions @xmath115 and @xmath116 , as achieved by the simultaneous use of all the edges in the cut - set .",
    "see fig .",
    "[ cutflux ] .",
    "now , by minimizing the previous quantities , @xmath118 and @xmath163 , over all the possible alice - bob cuts @xmath114 , we define the entanglement flux of the quantum network as@xmath675 and its broadband entanglement flux as @xmath676 in particular , there will be optimal alice - bob cuts such that @xmath677 and @xmath678 .",
    "note that these network definitions of entanglement flux are valid in general for any quantum network ( not - necessarily stretchable ) .",
    "the important point is that , for a stretchable network , they provide upper bounds for the end - to - end capacities , as we show in the next section .      with the tools developed in the previous sections",
    ", we can write upper bounds for the sequential capacity @xmath103 and the broadband capacity @xmath158 of a stretchable network .",
    "in fact , we can state the following main result .",
    "[ converse for stretchable networks][theoubnet]consider a quantum network @xmath63 connected by stretchable channels .",
    "the sequential ( i.e. , single - path ) capacity of the network is bounded by the entanglement flux of the network@xmath679 similarly , the broadband ( i.e. , multipath ) capacity of the network is bounded by the broadband entanglement flux of the network@xmath680    * proof . *  according to eq .",
    "( [ neccapdef ] ) the sequential network capacity is defined by the following optimization of the asymptotic rate over the sequential protocols @xmath681 @xmath682 the rate @xmath282 satisfies the condition in eq .",
    "( [ forproofs ] ) , i.e.,@xmath683 which applies to alice and bob s output state @xmath102 no matter how this state has been generated by the protocol ( this condition is derived under the single requirement that the output state is close to the target state ) .    according to previous lemma  [ reducechoi ] , for any alice - bob cut @xmath114 , we may write the following decomposition @xmath129   . \\label{ccc2bis}\\ ] ] computing the ree on this state and exploiting its basic properties ( monotonicity under @xmath40 and subadditivity with respect to the tensor product ) , we derive@xmath684   \\leq\\sum_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}n_{\\mathbf{xy}}e_{r}(\\rho_{\\mathcal{e}_{\\mathbf{xy}}})=\\sum_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}n_{\\mathbf{xy}}\\phi_{\\mathbf{xy } } , \\label{ccc3}\\ ] ] where @xmath666 is the entanglement flux of the edge @xmath130 .    combining eqs .",
    "( [ ccc1 ] ) , ( [ ccc2 ] ) and  ( [ ccc3 ] ) , we may write @xmath685 \\nonumber\\\\ \\overset{(1)}{\\leq}\\sum_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}p_{\\mathbf{xy}}\\phi_{\\mathbf{xy}}\\overset{(2)}{\\leq}\\max_{(\\mathbf{x},\\mathbf{y})\\in \\tilde{c}}\\phi_{\\mathbf{xy}}\\overset{(3)}{=}\\phi(c),\\end{gathered}\\ ] ] where ( 1 ) we have introduced the probability @xmath686 of using the edge @xmath130 in the cut - set , ( 2 ) we have maximized over the convex combination , and ( 3 ) we have used the definition of entanglement flux of the cut . because , we have @xmath133 for any alice - bob cut @xmath114 , we can minimize over all such cuts and write@xmath687    consider now the definition of the broadband network capacity of eq .",
    "( [ bbnetcapdef ] ) , i.e.,@xmath688 we apply eq .",
    "( [ ccc2 ] ) together with the output decomposition of eq .",
    "( [ ccc2bis ] ) but setting @xmath160 , i.e.,@xmath689   .\\ ] ] the latter decomposition leads to@xmath690    &   \\leq n\\sum_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}e_{r}(\\rho_{\\mathcal{e}_{\\mathbf{xy}}})\\nonumber\\\\ &   = n\\sum_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}\\phi_{\\mathbf{xy}}=n~\\phi^{\\text{bb}}(c ) , \\label{ddd2}\\ ] ] where @xmath163 is the broadband entanglement flux of @xmath114 .    combining eqs .",
    "( [ ccc2 ] ) , ( [ ddd1 ] ) and  ( [ ddd2 ] ) , we derive@xmath691   \\leq\\phi^{\\text{bb}}(c).\\ ] ] since this is valid for any alice - bob cut @xmath114 , it is also true for the minimum , i.e. , we may write@xmath692 which completes the proof .",
    "@xmath51      we now discuss an important equivalence which applies to any quantum network ( stretchable or not ) when accessed sequentially via single - path routing .",
    "we may write the entanglement flux of the network @xmath119 as the entanglement flux of an optimal route between alice and bob .",
    "this equivalence between a cut property of the network and one of its routes is crucial for our subsequent derivations .",
    "we have the following .    [",
    "cut property of the optimal route][optro]consider an arbitrary quantum network @xmath63 where the two end - points are connected by an ensemble @xmath693  of routes .",
    "each route is associated with a sequence of channels @xmath136 and has an associated entanglement flux @xmath694 then , the entanglement flux of the network is equal to the maximum entanglement flux among the routes @xmath695 in other words , we may write @xmath696 for some optimal route @xmath121 .    * proof .",
    "*  it is easy to show the inequality @xmath697  in eq .",
    "( [ netrr ] ) .",
    "consider the optimal alice - bob cut @xmath698 , such that @xmath699 .",
    "it clear that an edge @xmath130 of the optimal route @xmath121 must belong to the cut - set @xmath700 .",
    "thus , the entanglement flux of that edge must simultaneously satisfy @xmath701 and @xmath702 , so that @xmath703 to prove the stronger result @xmath704 , we need to exploit some basic results from graph theory . consider the maximum spanning tree of the connected undirected graph @xmath705 : this is a subgraph @xmath706 which connects all the points in such a way that the sum of the fluxes , associated with each edge @xmath707 , is the maximum .",
    "in other words , it maximizes the following quantity@xmath708    note that the optimal route @xmath121 between alice and bob is the unique path between alice and bob within this tree  @xcite .",
    "let us call @xmath709 the critical edge in @xmath121 , i.e. , that specific edge which realizes the minimization @xmath710 since this edge is part of a spanning tree , there is always an alice - bob cut @xmath711 of the network which crosses @xmath709 and no other edges of the spanning tree .",
    "in fact , this condition would fail only if there was a cycle in the tree , which is not possible by definition",
    ".     between alice and bob is a unique path within this tree ( highlighed by the asterisks ) . wherever the critical edge @xmath709 might be along the optimal route",
    ", we can always make an alice - bob cut @xmath711 which crosses that edge and no other edge of the spanning tree.,scaledwidth=55.0% ]    we must also have that @xmath709 is the optimal edge in the cut - set @xmath712 , i.e. , @xmath713 . by absurd , assume this is not the case .",
    "this implies that there is another edge @xmath714 , not belonging to @xmath715 , such that @xmath716 . for the cut property of the maximum spanning trees  @xcite",
    ", we have that an edge in @xmath711 with maximum flux must belong to all the maximum spanning trees of the network",
    ". therefore @xmath717 must belong to @xmath715 which leads to a contradiction . in conclusion",
    ", we have found an alice - bob cut which realizes the condition @xmath718 , i.e. , the equality in eq .",
    "( [ disuguagl ] ) .",
    "for an example see fig .",
    "[ cutp ] .",
    "@xmath51    note that the previous result applies not only to quantum networks but to any graphical network .",
    "it is sufficient to replace the entanglement flux with the bandwidth / capacity / weight of the edges .",
    "in fact , lemma  [ optro ] can be restated in the following general terms .",
    "[ cut property of the widest path]consider a generic network described by an undirected graph @xmath63 , whose edge @xmath719  has weight @xmath720 .",
    "denote by @xmath693  the ensemble of routes ( undirected paths ) between two end - points , alice and bob .",
    "define the weight of an alice - bob route @xmath721 as@xmath722 let us define the weight of an alice - bob cut @xmath114 as @xmath723 then , the weight of the minimum cut is equal to the weight of the optimal route or widest path , i.e. , @xmath724    * proof . *",
    "same proof of lemma  [ optro ] , up to replacing @xmath725 for generic edge @xmath726 .",
    "@xmath51    the latter proposition has not been found in previous literature on classical network theory , at least by the author . in any case , this cut property is particularly important for quantum networks .",
    "thanks to lemma  [ optro ] , we may re - write eq .",
    "( [ ubnetmain ] ) of theorem  [ theoubnet ] as@xmath727 where the maximization over @xmath100  can always be restricted to simple paths , since the optimal route @xmath121 is a simple path within a maximum spanning tree .",
    "( [ spanttt ] ) will enable us to find the sequential ( single - path )  capacity of a distillable network , as we discuss in the next section .",
    "the results of theorem  [ theoubnet ] can be made stronger for quantum networks which are connected by distillable channels .",
    "in fact , for distillable networks we can derive lower bounds coinciding with the previous upper bounds , thus fully determining their end - to - end capacities ( sequential and broadband ) . to show this achievability",
    ", we exploit the fact that the two - way capacities of the quantum channels associated with each point - to - point connection are equal to their entanglement fluxes .",
    "then we combine the point - to - point composition strategy with optimal algorithms for classical routing .",
    "the important property of a distillable network @xmath63 is that all its point - to - point ( two - way ) capacities are known and simply given by the entanglement flux . for a generic edge @xmath105",
    ", we may therefore write @xmath728 and represent the network as an undirected graph  which is weighted by the capacities , as in fig .",
    "[ distnet ] .     are known .",
    "see text.,scaledwidth=30.0% ]    broadly speaking , because of eq .",
    "( [ equivdistill ] ) , all the previous quantities defined for the entanglement flux can be reduced to corresponding capacities .",
    "let us start with the sequential use of the network ( sec .",
    "[ subsecdist0 ] ) and , then , we consider the broadband use in sec .",
    "[ subsecdist ] .      for any alice - bob entanglement cut @xmath114 of a distillable network",
    ", we may write@xmath729 where @xmath145 is the sequential or single - edge capacity of the cut , i.e. , the maximum number of target bits that can be extracted by using a single edge across the cut . then , given an end - to - end route @xmath75 with associated channels @xmath136 , we have @xmath730 @xmath731 and we may write @xmath732 where @xmath146 is the capacity of the route .    it is clear that , for any route @xmath135 between alice and bob , its capacity @xmath146 is an achievable end - to - end rate , due to the point - to - point composition strategy .",
    "in fact , let us perform individual point - to - point protocols between each pair of consecutive points along the route @xmath75@xmath733 an optimal adaptive protocol between points @xmath734 and @xmath735 achieves the capacity value @xmath731 . then compose all outputs by means of a final network loccs ( e.g.,by swapping the distilled states or relaying the secret keys via one - time pad sessions )",
    ". an achievable end - to - end rate is therefore given by the minimum capacity along the chain , i.e. , @xmath736 .",
    "it is also clear that we can not achieve more by using route @xmath75 , because we are saturating the upper bound given by @xmath737 , as we can also see by collapsing @xmath100 to route @xmath75 and applying eqs .",
    "( [ ubnetmain ] ) and  ( [ netrr ] ) .    as a consequence of these reasonings ,",
    "the optimization of the sequential use of a distillable quantum network is reduced to the classical search of a route with maximum capacity ( or widest path ) . finding this optimal route @xmath121",
    "provides an achievable rate equal to @xmath738 so that @xmath119 is achievable in eq .",
    "( [ ubnetmain ] ) .",
    "more formally , we can state the following result which extends the widest path problem  @xcite to quantum communications .",
    "[ widest path for quantum comms][coronetseq]consider a distillable network @xmath63 , where two end - points are connected by an ensemble  of routes @xmath693 and may be disconnected by an entanglement cut @xmath114 .",
    "the sequential ( i.e. , single - path ) capacity of the network equals the entanglement flux of the network@xmath739 equivalently , it equals the minimum ( single - edge ) capacity of the entanglement cuts and the maximum capacity of the routes@xmath740 the optimal end - to - end route @xmath121 achieving the capacity can be found in time @xmath148 , where @xmath149 is the number of edges and @xmath741 is the number of points .    *",
    "*  the proof is very easy because we have already introduced many elements . in particular , by using lemma  [ optro ] in theorem  [ theoubnet ] , we may write @xmath742 by replacing eqs .",
    "( [ cutequiv ] ) and  ( [ genrr ] ) into eq .",
    "( [ lasteqpp ] ) we get@xmath743 for an optimal route @xmath121 . because we also have @xmath744 , then eq .",
    "( [ lastineqpp ] ) becomes an equality , automatically proving eqs .",
    "( [ stretccor ] ) and  ( [ stretccor2 ] ) .",
    "finding the optimal route is equivalent to solve the widest path problem .",
    "it can be found by using a modified dijkstra s shortest path algorithm  @xcite .",
    "this finds the optimal route in time @xmath745 . in practical cases ,",
    "this algorithm can be optimized and its asymptotic performance becomes @xmath746  @xcite .",
    "another possibility is using an algorithm for finding a maximum spanning tree of the network , such as the kruskal s algorithm  @xcite .",
    "the latter has the asymptotic complexity @xmath148 for building the tree .",
    "this step is then followed by the search of the route within the tree which takes linear time @xmath747",
    "@xmath51    corollary  [ coronetseq ] reduces the optimal use of a distillable quantum network to the resolution of a classical optimization problem .",
    "let us remark that this result can be applied to fundamental scenarios such as bosonic networks subject to loss or amplification , and spin networks affected by dephasing or erasure .",
    "we may even consider hybrid networks with both dv and cv systems , e.g. , spin - bosonic networks affected by erasure and loss .",
    "in particular , consider a quantum network connected by lossy channels @xmath154 , which well describes both free - space or fiber - based optical communications . according to corollary  [ coronetseq ] , we may compute its capacity @xmath748 by minimizing over the cuts or maximizing over the routes .",
    "generic edge @xmath105 has an associated lossy channel with transmissivity @xmath183 and capacity @xmath749 .",
    "therefore , an entanglement cut has single - edge capacity @xmath750   = -\\log_{2}(1-\\eta_{c}),\\nonumber\\\\ \\eta_{c }   &   : = \\max_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}\\eta_{\\mathbf{xy}},\\end{aligned}\\ ] ] where @xmath751 may be identified as the transmissivity of the cut . by minimizing over the cuts",
    ", we may write the single - path capacity of the lossy network as @xmath752 where @xmath753 is the minimum transmissivity of the cuts .    consider now a generic end - to - end route @xmath75 along the lossy network .",
    "this route is associated with a sequence of lossy channels with transmissivities @xmath754 .",
    "we then compute the route capacity as@xmath755   = -\\log_{2}(1-\\eta_{\\omega}),\\nonumber\\\\ \\eta_{\\omega }   &   : = \\min_{i}\\eta_{i}^{\\omega},\\end{aligned}\\ ] ] where @xmath756 is the route transmissivity . by maximizing over the routes",
    ", we may equivalently write the single - path capacity of the lossy network as@xmath757 where @xmath758 is the maximum transmissivity of the routes .    similar conclusions can be derived for bosonic networks which are composed of other distillable gaussian channels , such as multiband lossy channels , quantum - limited amplifiers or even hybrid combinations . in particular , consider a network of quantum - limited amplifiers @xmath759 , where the generic edge @xmath105 has gain @xmath760 with capacity @xmath761 , and the generic end - to - end route @xmath75 is associated with a sequence of gains @xmath762 .",
    "we can repeat the previous steps of the lossy network setting @xmath763 , so that @xmath764 .",
    "thus , for an entanglement cut @xmath114 , we may write @xmath765   = -\\log_{2}(1-g_{c}^{-1}),\\nonumber\\\\ g_{c }   &   : = \\min_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}g_{\\mathbf{xy}}~.\\end{aligned}\\ ] ] for a route @xmath75 , we have the capacity@xmath766\\}=-\\log_{2}(1-g_{\\omega}^{-1}),\\nonumber\\\\ g_{\\omega }   &   : = \\max_{i}g_{i}^{\\omega}~.\\end{aligned}\\ ] ] by minimizing over the cuts or maximizing over the routes , we derive the two equivalent formulas@xmath767 where @xmath768 and @xmath769",
    ".    we can also compute the single - path capacities of dv networks where links between qudits are affected by dephasing or erasure or a mix of the two errors . for simplicity",
    ", consider the case of qubits , such as spin @xmath770 or polarized photons . in a qubit network with dephasing channels",
    "@xmath771 , the generic edge @xmath105 has a dephasing probability @xmath772 and capacity @xmath773 . the generic end - to - end route @xmath75 is associated with a sequence of such dephasing probabilities @xmath774 .",
    "for an entanglement cut @xmath114 , we have @xmath775   = 1-h_{2}(p_{c}),\\nonumber\\\\ p_{c }   &   : = \\min_{(\\mathbf{x},\\mathbf{y})\\in\\tilde{c}}p_{\\mathbf{xy}}. \\label{pcdep}\\ ] ] for a generic route @xmath75 , we may write@xmath776 = 1-h_{2}(p_{\\omega}),\\nonumber\\\\ p_{\\omega }   &   : = \\max_{i}p_{i}^{\\omega}~. \\label{pomegadep}\\ ] ] by minimizing over the cuts or maximizing over the routes , we then derive the single - path capacity @xmath777 where we have set @xmath778    finally , for a qubit network affected by erasures @xmath779 we have that edge @xmath105 is associated with an erasure channel with probability @xmath686 and corresponding capacity @xmath780 . as a result , we may repeat all the previous derivation for the dephasing network @xmath771 up to replacing @xmath781 with @xmath398 . for a cut and a route , we have@xmath782 where @xmath783 and @xmath90 are defined as in eqs .",
    "( [ pcdep ] ) and  ( [ pomegadep ] ) .",
    "thus , the single - path capacity of the erasure network simply reads@xmath784 where @xmath785 and @xmath786 are defined as in eq .",
    "( [ pcset ] ) .",
    "let us now consider the broadband use of a distillable network .",
    "because of eq .",
    "( [ equivdistill ] ) , we may reduce the broadband entanglement flux to a capacity . in other words , for any alice - bob entanglement cut @xmath114  of the distillable network , we may write @xmath787 where @xmath168 is the broadband capacity of the cut .",
    "this corresponds to the maximum number of target bits that can be extracted by the simultaneous use of all the edges across the cut .",
    "in fact , it can be seen as a multiband quantum communication across the cut @xmath126 between an extended alice @xmath115 and an extended bob @xmath116 .",
    "let us now consider the broadband capacity of the minimum cut @xmath169 , i.e. , @xmath788 the latter is certainly an achievable rate between extended alice and extended bob , but it is not immediately clear if it is also a broadband rate achievable by the original end - points . in the following ,",
    "we show that this is the case if we perform the point - to - point composition strategy in a parallel fashion in such a way to optimize the flow of quantum information through the network . in this way",
    ", we show that @xmath165 in eq .",
    "( [ ubnetmainbroadband ] ) is indeed achievable for a distillable network .",
    "thus , for the broadband use of a distillable network we prove the following result which extends the max - flow min - cut theorem  @xcite to quantum communications .",
    "[ quantum max - flow min - cut][theomaxflow]consider a distillable network @xmath63 where two end - points may be disconnected by an entanglement cut @xmath114 .",
    "the broadband ( i.e. , multipath ) capacity of the network is given by its broadband entanglement flux@xmath789 equivalently , it corresponds to the minimum broadband capacity of the entanglement cuts@xmath790 the optimal multi - path routing can be found in @xmath182 time by solving the classical maximum flow problem .",
    "* proof . *  since the upper bound",
    "@xmath791 has been proven in theorem  [ theoubnet ] for any stretchable network , here we need to show that @xmath165 is an achievable rate for a distillable @xmath142 . as already said , because of eq .",
    "( [ equivdistill ] ) , we may write @xmath792 , which leads to @xmath793 to show that the latter quantity is achievable , we resort to the classical max - flow min - cut theorem  @xcite . in the literature , this theorem has been widely adopted for the study of directed graphs . in general , it can also be applied to directed multi - graphs as well as undirected graphs / multi - graphs ( e.g. , see  ( * ? ? ?",
    "* sec .  6 ) ) .",
    "the latter cases can be treated by suitably splitting the undirected edges into directed ones ( e.g. , see  ( * ? ? ?",
    "2.4 ) ) .",
    "our first step is therefore the transformation of the undirected graph of the quantum network @xmath63 into a suitable directed graph ( in general , these may be multi - graphs , in which case the following derivation still holds but with more technical notation ) . starting from @xmath705 ,",
    "we consider the directed graph where alice s edges are all out - going ( so that she is a source ) , while bob s edges are all in - going ( so that he is a sink ) . then , for any pair @xmath173 and @xmath178 of intermediate points @xmath794 , we split the undirected edge @xmath105 into two directed edges @xmath795 and @xmath796 , having capacities equal to the capacity @xmath171 of the original undirected edge  @xcite .",
    "these manipulations generate our flow network @xmath797 .",
    "see fig .",
    "[ diamondsplot ] for an example .    .",
    "( middle )  flow network @xmath798 with alice @xmath11 as source and bob @xmath12 as sink , where the middle undirected edge @xmath130 has been split in two directed edges @xmath799 and @xmath717 with the same capacity .",
    "( rigth )  assuming the displayed alice - bob cut , the dotted edge does not belong to the directed cut - set @xmath800.,scaledwidth=48.0% ]    we then adopt the standard definition of cut - set for flow networks , here called directed cut - set .",
    "given an alice - bob cut @xmath114 of the flow network , with bipartition @xmath122 of the points @xmath64 , its directed cut - set is defined as @xmath801 .",
    "this means that directed edges of the type @xmath802 do not belong to this set ( see fig .",
    "[ diamondsplot ] ) . using this definition ,",
    "the cut - properties of the flow network @xmath798 are exactly the same as those of the original undirected graph @xmath142 , for which we used the undirected  definition of cut - set .",
    "more precisely , the quantity @xmath165 in eq .",
    "( [ quantprof ] ) equals@xmath803 which represents the capacity of the minimum cut in the flow network @xmath798 with point - to - point capacities @xmath171 .",
    "let us now define the flow  in the network @xmath798 as the number of qubits per use which are reliably transmitted from @xmath173 to @xmath178 along the directed edge @xmath804 , denoted by @xmath805 .",
    "this quantum transmission is performed by means of a point - to - point protocol where @xmath173 and @xmath178 exploit adaptive loccs , i.e. , unlimited two - way ccs and adaptive los , without the help of the other points of the network .",
    "it is therefore bounded by the two - way quantum capacity of the associated channel @xmath104 , i.e. , @xmath806 .",
    "the actual physical direction of the quantum channel does not matter since it is used with two - way ccs , so that the two points @xmath173 and @xmath178 first distill entanglement and then they teleport qubits in the logical direction  specified by the directed edge .    since every",
    "directed edge @xmath726 between two intermediate points @xmath807 has an opposite counterpart  @xmath808 , we may simultaneously consider an opposite flow of qubits from @xmath178 to @xmath173 with rate @xmath809 . as a result",
    ", there will be an effective  point - to - point  rate between @xmath173 and @xmath178 which is defined by the difference of the two directed  rates along @xmath799 and @xmath717 @xmath810 its absolute value @xmath811 provides the effective number of qubits transmitted between @xmath173 to @xmath178 per use of the undirected edge : for @xmath812 , effective qubits flow from @xmath173 to @xmath178 , while @xmath813 means that effective qubits flow from @xmath178 to * * @xmath173 .",
    "the effective rate is correctly bounded @xmath814 and we set @xmath815 if two points are not connected .",
    "the ensemble of positive directed rates @xmath816 represents a flow vector in @xmath798 . for any choice of this vector",
    ", there is a corresponding ensemble of effective rates @xmath817 for the original network @xmath142 .",
    "the signs @xmath818 specify an orientation @xmath819 for @xmath142 , and the absolute values @xmath820 provide point - to - point quantum communication rates for the associated broadband network protocol ( more details on this quantum protocol are given afterwards ) .",
    "it is important to note that @xmath816 represents a legal  flow vector in @xmath798  only if we impose the property of flow conservation  @xcite .",
    "this property can be stated for @xmath816  or , equivalently , for the effective vector @xmath817 . at any intermediate point , the number of qubits simultaneously received must be equal to the number of qubits simultaneously transmitted through all the point - to - point communications with neighbor points . in other words , for any @xmath821 , we must impose @xmath822    this property does not hold for alice @xmath11 ( source ) and bob @xmath12 ( sink ) , for which we impose@xmath823 where @xmath824 is known as the value of the flow .",
    "this is an achievable end - to - end rate since it represents the total number of qubits per network use which are transmitted by alice and correspondingly received by bob via all the end - to - end routes , where the intermediate points quantum - communicate at the rates @xmath817 .",
    "now , from the classical max - flow min - cut theorem , we know that the maximum value of the flow in the network @xmath825 is equal to the capacity of the minimum cut  @xcite , i.e. , we may write @xmath826 thus , by construction , we have that @xmath825 is an achievable rate for quantum communication @xmath827 and , therefore , for entanglement distillation @xmath828 and key generation @xmath829 .",
    "then , according to eq .",
    "( [ maxproo ] ) , it is equal to the broadband entanglement flux @xmath165 in eq .",
    "( [ quantprof ] ) , i.e. , we have @xmath830 . as a result ,",
    "we may write@xmath831 which leads to eqs .",
    "( [ cut1 ] ) and  ( [ cut2 ] ) .",
    "let us call @xmath832 the optimal flow vector in @xmath798 , i.e. , achieving the maximum value @xmath825 . there is a corresponding vector @xmath833 which determines an optimal orientation @xmath834 for the quantum network @xmath63 , besides providing the optimal rates @xmath835 to be reached in the point - to - point connections .",
    "in other words , starting from the knowledge of the capacities @xmath171 , the points can classically solve the maximum flow problem and then establish an optimal broadband routing strategy @xmath836 ( see also sec .",
    "[ secnetworks ] ) . after this preliminary stage , they start their multicasts .    each point @xmath837 multicasts to its out - neighborhood @xmath838 as defined by the optimal orientation @xmath839 .",
    "the multicast @xmath840 of point @xmath173 occurs simultaneously with that of any other point of the network , and all multicasts are repeated @xmath14 times without the assistance of adaptive network loccs ( apart from sending and storing the quantum systems ) .",
    "in fact , since the channels are distillable , it is sufficient to distribute @xmath14 epr states along each edge @xmath175 and exploit final one - way ccs between @xmath173 and @xmath178 in order to distill the output choi matrices into @xmath841 ebits . as a matter of fact",
    ", the entire multicast process is just reduced to a collection of independent point - to - point distillation protocols , one for each edge .",
    "the final step is a network locc where all the points exploit the distilled ebits to route quantum information from alice to bob .",
    "this is achieved by a sequence of teleportation protocols where alice s input qubits are simultaneously teleported through the different routes identified by the multicasts .",
    "in practice , each point of the network teleports incoming qubits to its out - neighborhood according to the number of ebits available for each point - to - point connection . in this way",
    ", the end - points achieve the broadband quantum capacity @xmath842 .",
    "similarly , the points may perform a sequence of entanglement swapping protocols providing alice and bob with @xmath843 ebits .",
    "the latter may be used to teleport an equal number of qubits or to generate an equal number of secret bits .    in conclusion ,",
    "let us study the complexity associated with finding the optimal broadband routing @xmath836 in the quantum network . by construction",
    ", the flow network @xmath844 has only a small overhead with respect to the original network @xmath845 .",
    "in fact , we just have @xmath846 . within @xmath798",
    ", the maximum flow can be found with classical algorithms .",
    "if the capacities are rational , we can apply the ford - fulkerson algorithm  @xcite or the edmonds ",
    "karp algorithm  @xcite , the latter running in @xmath847 time .",
    "an alternative is dinic s algorithm  @xcite , which runs in @xmath848 time .",
    "more powerful algorithms are available  @xcite and the best running performance is currently @xmath849 time  @xcite .",
    "thus , adopting orlin s algorithm  @xcite , we find the solution in @xmath850 time .",
    "@xmath51    thus , previous theorem reduces the optimization of the broadband use of a distillable quantum network to the determination of the maximum flow in a classical network . in this sense",
    "the max - flow min - cut theorem is extended from classical to quantum communications .",
    "as we have seen , an optimal protocol reaching the broadband capacity combines point - to - point entanglement distillation with the optimal routing of quantum information , which is teleported as a flow through the quantum network .",
    "let us give here a simplified version of this optimal protocol ( where the optimal flow - like orientation of the network is found and exploited _",
    "after _ entanglement distillation ) .    in a distillable network ,",
    "it is sufficient that the points agree _ any _ classical strategy that allows them to distribute @xmath14 epr states along each edge of the network .",
    "this quantum distribution is followed by independent sessions of point - to - point entanglement distillation at the two ends of each edge @xmath130 , where points @xmath173 and @xmath178 transform the output choi matrices into @xmath851 ebits by means of one - way ccs .",
    "the quantum network is now ready to be used as a teleportation network based on the distilled ebits .    by using the shared ebits ,",
    "the points teleport alice s qubits to bob along the routes associated with the solution of the maximum flow problem .",
    "the classical solution provides the direction of teleportation along each edge @xmath130 together with the number of qubits @xmath852 to be teleported . as a result of this classically - routed teleportation ,",
    "the two end - points are able to achieve the broadband quantum capacity @xmath842 .",
    "then , since alice s input qubits can be part of input ebits and , therefore , private states , this protocol can also distill entanglement and keys at the same end - to - end rate .",
    "an important application of the previous theorem  [ theomaxflow ] regards the practical scenario of quantum optical communications affected by loss , e.g. , free - space or fiber - based . as a specific distillable network ,",
    "let us consider the case of a bosonic gaussian network connected by lossy channels @xmath154 , so that each undirected edge @xmath130 has an associated lossy channel @xmath104 with transmissivity @xmath183 or equivalent loss parameter  @xmath184 .",
    "we may then re - express the result of theorem  [ theomaxflow ] directly in terms of suitable loss parameters of the network .",
    "let us define the loss of an alice - bob entanglement cut @xmath114 as the product of the loss parameters of the channels in the cut - set , i.e. , we set@xmath186 this quantity determines the broadband capacity of the cut , since we have @xmath853 . by applying eq .",
    "( [ cut2 ] ) , we find that the broadband ( multipath ) capacity of the lossy network is given by@xmath854   = -\\log_{2}\\left [   \\max_{c}l(c)\\right ]   .\\ ] ] thus , we may define the total loss of the network as the maximization of @xmath185 over all cuts , i.e.,@xmath855 and write the simple formula@xmath856    in general , we may consider a multiband lossy network @xmath857 , where each edge @xmath130 represents a multiband lossy channel @xmath858 with bandwidth @xmath859  and constant transmissivity @xmath860 .",
    "in other words , each single edge @xmath130 corresponds to @xmath859 independent lossy channels with the same transmissivity @xmath183 . in this case",
    ", we have @xmath861 .",
    "therefore , we may write @xmath862   , \\ ] ] which directly generalizes eq .",
    "( [ togenmulti ] ) .",
    "in particular , suppose that we have the same loss in each edge of the multiband network , i.e. , @xmath863 for any @xmath105 , which may occur when points @xmath173 and @xmath178 are equidistant .",
    "then , we may simply write@xmath864 where @xmath865 is the effective bandwidth of the network .      for other types of distillable networks",
    ", we may specify other results starting from theorem  [ theomaxflow ] .",
    "consider a bosonic gaussian network of quantum - limited amplifiers @xmath759 , where the generic edge @xmath130  has an associated gain @xmath760 .",
    "its broadband ( multipath ) capacity is given by @xmath866   .\\ ] ] for a qubit network of dephasing channels @xmath771 , where the generic edge @xmath130 has dephasing probability @xmath686 , we may write the broadband ( multipath ) capacity@xmath867   .\\ ] ] finally , for a qubit network of erasure channels @xmath779 with erasure probabilities @xmath686 , we simply have@xmath868 similar expressions may be derived for qudit networks of dephasing and erasure channels in arbitrary dimension .",
    "previous results have been derived in the unicast setting , with a single sender @xmath11 and a single receiver @xmath12 . in general , we may consider the presence of multiple senders @xmath222 and receivers @xmath224 , which may communicate according to various configurations .",
    "for simplicity , these sets are intended to be disjoint @xmath869 , so that an end - point can not be sender and receiver at the same time .",
    "it is clear that all previous results derived for the two basic routing strategies ( see theorem  [ theoubnet ] , corollary  [ coronetseq ] and theorem  [ theomaxflow ] ) provide general upper bounds which are still valid for the individual end - to - end capacities associated with each sender - receiver pair @xmath198 in the various settings with multiple end - points .    in the following sections , we first study the multiple - unicast scenario ( secs .  [ secmultiunicast ] and  [ secmultiunicast2 ] ) .",
    "this consists of @xmath189 alices @xmath870 and @xmath189 bobs @xmath871 , with the generic @xmath43th alice @xmath191 communicating with a corresponding @xmath43th bob @xmath192 .",
    "this case can be studied by assuming both single - path and multipath routing . besides the general bounds inherited from the unicast scenario",
    ", we also derive a specific set of upper bounds for the rates that are simultaneously achievable by all parties .",
    "another important case is the multicast network , where a single sender simultaneously communicates with @xmath872 of receivers . by its nature",
    ", this is studied under multipath routing ( sec .",
    "[ secmulticastsingle ] ) . more generally , we may consider a multiple - multicast network .",
    "here we have @xmath873 senders and @xmath874 receivers , and each sender communicates with the entire set of receivers through the network ( sec .",
    "[ secmulticastmany ] ) . in all these configurations ,",
    "we derive specific upper bounds for the achievable rates .",
    "finally , a relevant case is that of key generation where we restrict the sender to transmit exactly the same key to all receivers in the destination set ( sec .",
    "[ secnetcoding ] ) . under such assumption",
    "we may show the achievability of the upper bounds and extend the classical network coding theorem  @xcite to multi - end quantum cryptography .",
    "the generalization to a multiple - unicast setting is relatively easy .",
    "let us start by considering two alice - bob pairs @xmath875 and @xmath876 , since the extension to arbitrary number of pairs is immediate .",
    "we may easily formulate network protocols which are based on single - path routing . in this case , each sequential use of the network involves the transmission of quantum systems along two ( potentially - overlapping ) routes@xmath877 where each transmission through an edge is assisted by network loccs .",
    "the routes are updated use after use .",
    "after @xmath14 uses , the output of the double - unicast network protocol @xmath878 is a state @xmath879 which is @xmath880-close in trace norm to a target state @xmath881 where @xmath882 is a one - bit state ( private bit or ebit ) for the pair @xmath198 and @xmath883 the number of its copies . by taking the asymptotic limit for large @xmath14 and optimizing over all protocols @xmath878 ,",
    "we define the capacity region as the closure of the set of the achievable asymptotic rates @xmath884 . in general , for @xmath189 sender - receiver pairs , we have an @xmath189-tuple of achievable rates @xmath193 . depending on the task of the protocol ( i.e. , , the target state ) , these rates refer to end - to - end entanglement distillation ( equivalently , error - free quantum communication ) or secret - key generation .    before proceeding ,",
    "let us first introduce more general types of entanglement cuts of the quantum network .",
    "given two sets of senders @xmath222 and receivers @xmath212 , we adopt the notation @xmath885 for a cut @xmath126 such that @xmath886 and @xmath887 .",
    "similarly , we write @xmath888 for a cut with @xmath889 and @xmath890 , and @xmath891 for a cut with @xmath892 and @xmath893 . as usual , we define the entanglement flux of a cut as@xmath894 where @xmath895 is the flux of edge @xmath130 and @xmath117 is the cut - set .",
    "we can now state the following result .",
    "[ multi - unicast / single - path][theomultipleunicast]consider a quantum multiple - unicast network @xmath142  with @xmath189 sender - receiver pairs @xmath198 communicating by means of single - path routing .",
    "if the network is stretchable , then we have the following bounds for the capacity region@xmath896 where @xmath118  is the entanglement flux of cut @xmath114 .",
    "* proof . *  for simplicity consider first the case @xmath897 , since the generalization to arbitrary @xmath189 is straightforward .",
    "let us also consider key generation , since it automatically provides an upper bound for the other tasks .",
    "considering the bipartition @xmath898 , the distillable key of the target state @xmath899 in eq .",
    "( [ targettt ] ) is equal to@xmath900 using the ree with respect to the same bipartition , we may write the upper bound@xmath901 where the latter inequality comes from the fact that @xmath902 is @xmath880-close to @xmath899 . the extra term @xmath903 depends the @xmath880-closeness , and the dimension @xmath236 of the hilbert space .",
    "for more details about this term , see the proof of the weak converse theorem in supplementary section  iii of ref .",
    "@xcite . in the limit of large @xmath14",
    ", we can neglect @xmath904 .",
    "more precisely , we may write @xmath905 where the @xmath305 appears to account for cv systems    because the network is stretchable we may write the following choi decomposition of the output state@xmath906   , \\label{cmtoo}\\ ] ] where @xmath907 is a trace - preserving locc , which is local with respect to the bipartition @xmath898 . by using entanglement cuts which disconnect the senders and receivers ,",
    "we reduce the number of choi matrices appearing in eq .",
    "( [ cmtoo ] ) while preserving the locality of the locc with respect to the bipartition of the end - points .",
    "in other words , for any cut @xmath908 we may write@xmath909   .\\ ] ]    using the latter decomposition in eq .",
    "( [ todecppp ] ) , we obtain@xmath910 by minimizing over the cuts , we derive@xmath911 it is important to note that this bound holds for any protocol @xmath878 , whose details were collapsed in the locc @xmath907 and therefore discarded .",
    "thus , the same bound applies if we optimize over all protocols , which means that eq .",
    "( [ outerccc ] ) provides the following outer bound for the capacity region@xmath912    note that , besides this bound , we also have the following unicast bounds for the individual rates @xmath913 these follows directly from theorem  [ theoubnet ] on the converse for unicast stretchable networks .",
    "equivalently , we may re - derive these bounds here , by setting @xmath914 or @xmath915 in the target state of eq .",
    "( [ targettt ] ) and repeating the previous derivation .",
    "for instance , for @xmath914 , we have @xmath916 , where @xmath917 does not contain target bits and may be taken to be separable .",
    "therefore , we start from @xmath918 and we repeat all the derivation with respect to the bipartition @xmath919 .",
    "it is clear that the generalization from @xmath897 to arbitrary @xmath189 is immediate . for any integer @xmath189",
    ", we have the target state@xmath920 considering the bipartition @xmath921 and the corresponding cuts of the network leads to @xmath922 where we note that increasing the number of rates reduces the number of possible cuts in the minimization . in order to get all the remaining inequalities of the theorem",
    ", we just need to set some of the rates to zero .",
    "for instance , for @xmath923 and @xmath924 , we get the unicast bounds of eq .",
    "( [ unicvvv ] ) . for @xmath923 , @xmath925 and @xmath926",
    "we get the double - unicast bounds of eq .",
    "( [ doublehhhh ] ) , and so on .",
    "@xmath51    once we have proven the previous theorem , it is immediate to specify the results for the case of multiple - unicast distillable networks , for which we may write @xmath166 for each edge @xmath927 , where @xmath171 is the two - way capacity of the associated quantum channel . in this case , we may directly write @xmath928 for any cut of the network , so that we may express the bounds of theorem  [ theomultipleunicast ]  directly in terms of the capacities of the cuts @xmath145 .",
    "we have therefore the following .",
    "consider a quantum multiple - unicast network @xmath142  with @xmath189 sender - receiver pairs @xmath198 communicating by means of single - path routing .",
    "if the network is distillable , then we may write the following outer bounds for the capacity region@xmath929 where @xmath145 is the capacity of cut @xmath114 .",
    "the proof of this corollary is immediate .",
    "note that we can not establish the achievability of the outer bounds in eqs .",
    "( [ distooo])-([distoooo ] ) , apart from the case where @xmath930 , so that we recover the result of corollary  [ coronetseq ] on the widest path for unicast distillable networks . in general , for @xmath931 , achievable lower bounds can be established by combining the point - to - point composition strategies with classical routing algorithms that solve the multiple - version of the widest path problem .",
    "here we consider a quantum network where @xmath189  senders @xmath222 and @xmath189 receivers @xmath212 communicate in a pairwise fashion @xmath198 by means of multipath routing . as usual in a broadband protocol , the points first agree an orientation for the quantum network . for multiple - unicasts note that both the senders and receivers may assists one with each other as relays of the network .",
    "this means that @xmath222 are not necessarily sources and @xmath212 are not necessarily sinks , i.e. , these sets may have both incoming and outgoing edges .",
    "given an orientation , each point multicasts to its out - neighborhood with the assistance of network loccs .",
    "this flooding process ends when each edge of the network has been exploited . for the next use",
    ", the points may agree a different orientation , and so on .",
    "the sequence of the orientations together with the sequence of all network loccs ( exploited in each orientation ) define a multiple - unicast broadband protocol @xmath932",
    ". its output will be a shared state @xmath933 which is @xmath880-close to a target state @xmath920 where @xmath882 is a one - bit state ( private bit or ebit ) for the pair @xmath198 and @xmath883 the number of its copies . by taking the limit of large @xmath14 and optimizing over @xmath932 ,",
    "we define the capacity region associated with the achievable broadband rates @xmath194 for the various quantum tasks .",
    "we can state the following result .",
    "[ multi - unicast / multipath][theomultipleunicast2]consider a quantum multiple - unicast network @xmath142  with @xmath189 sender - receiver pairs @xmath198 communicating via multipath routing .",
    "if the network is stretchable , we have the following bounds for the broadband capacity region@xmath934 where @xmath935  is the broadband entanglement flux of cut @xmath114",
    ".    * proof . *",
    "the proof follows the main steps of the one of theorem  [ theomultipleunicast ] . as before ,",
    "consider key generation .",
    "for the bipartition @xmath921 , the distillable key of the target state @xmath899 is equal to@xmath936 which leads to the inequality@xmath937    for any cut @xmath885 of the stretchable network , we may write the following choi decomposition of the output state@xmath938   , \\ ] ] for some trace - preserving locc @xmath939 . note that here we have @xmath160 .  by replacing @xmath940 in eq .",
    "( [ repkkkj ] ) , we therefore get@xmath941 the next step is to minimize over the cuts , leading to@xmath942    since the latter inequality holds for any protocol @xmath932 , it can be extended to the achievable rates , i.e. , we write @xmath943 finally , by setting some of the rates equal to zero in the target state , we may repeat the procedure with respect to different bipartitions and derive all the remaining conditions in eqs .",
    "( [ rtg])-([rtg3 ] ) .",
    "@xmath352    as before for the single - path routing , it is immediate to specify the result for distillable networks for which we may directly write @xmath787 for any cut of the network .",
    "therefore , we have    consider a quantum multiple - unicast network @xmath142  with @xmath189 sender - receiver pairs @xmath198 communicating via multipath routing .",
    "if the network is distillable , then we may write the following outer bounds for the broadband capacity region@xmath944 where @xmath168 is the broadband capacity of cut @xmath114 .",
    "achievable lower bounds may be determined by combining the point - to - point composition strategy with classical routing algorithms based on the maximization of multiple flows . for the specific case @xmath930 ,",
    "the outer bound is achievable and we retrieve the max - flow min - cut theorem for quantum communications ( theorem  [ theomaxflow ] ) . for @xmath945 , achievable lower bounds may be found by exploiting classical literature on multicommodity flow algorithms , e.g. , ref .",
    "@xcite who showed a version of max - flow min - cut theorem for undirected networks with two commodities , and ref .",
    "@xcite which discusses extensions to more than two commodities .",
    "let us now consider a multicast scenario , where alice @xmath11 aims to simultaneously communicate with a set of @xmath189  receivers , i.e. , a set of bobs @xmath946 .",
    "because of the implicit parallel nature of this communication process , it is directly formulated under the assumption of multipath routing .",
    "we can easily generalize the description of the one - sender one - receiver broadband network protocol to the present case of multiple receivers .    in a @xmath519-to-@xmath189 multicast network protocol ,",
    "the quantum network @xmath142 is subject to an orientation where alice is treated as a source , while the various bobs are destination points , each one being a receiver but also a potential relay for another receiver ( so that they are not necessarily sinks in the general case ) .",
    "each end - to - end simultaneous communication between alice and the bobs consists of a sequence of multicasts from each point of the network to its out - neighborhood , assisted by network loccs .",
    "this is done in a flooding fashion so that each edge of the network is exploited .",
    "the orientation of the network may be updated and optimized at each round of the protocol .",
    "the sequence of orientations and the network loccs define the multicast network protocol @xmath947 .",
    "after @xmath14 uses of the network , alice and the @xmath189 bobs will share an output state @xmath948 which is @xmath880-close to a target state @xmath949 where @xmath950 is a one - bit state ( private bit or ebit ) for the pair of points @xmath951 and @xmath883 the number of its copies .",
    "note that this is a compact notation which involves countable sets of systems @xmath952 and @xmath953 .",
    "therefore , the tensor product @xmath954 explicitly means @xmath955 , so that there are different systems involved in alice s side .    by taking the limit of large @xmath14 and",
    "optimizing over @xmath947 , we define the capacity region associated with the achievable rates @xmath193 . in particular",
    ", we may define a unique capacity which is associated with the symmetric condition @xmath956 .",
    "in fact , we may consider a symmetric type of multicast protocol @xmath957 whose target state @xmath899 must have @xmath958 bits for any @xmath43 .",
    "then , by taking the asymptotic limit of large @xmath14 and maximizing over all such protocols , we may define the multicast network capacity@xmath959 this rate quantifies the maximum number of target bits per network use ( multipath transmission ) that alice may simultaneously share with each bob in the destination set @xmath946 .",
    "we have the usual hierarchy @xmath960 when we specify the target state .",
    "we can state the following results for stretchable multicast networks .",
    "[ quantum multicast][theomulticast]let us consider a quantum multicast network @xmath142 with one sender and @xmath189 receivers @xmath946 .",
    "if the network is stretchable , then we have the following outer bounds for the capacity region @xmath961 where @xmath163 is the broadband entanglement flux of cut @xmath114 .",
    "in particular , the multicast network capacity satisfies@xmath962    * proof . *  consider the upper bound given by secret - key generation .",
    "with respect to the bipartition @xmath963 , we may write the usual steps starting form the distillable key of the target state @xmath964 leading to the asymptotic limit@xmath965    for any cut @xmath966 of the stretchable network , we may write the choi decomposition@xmath967   , \\ ] ] for some trace - preserving locc @xmath968 . by replacing @xmath969 in eq .",
    "( [ repkkkj2 ] ) , we therefore get@xmath941 by minimizing over the cuts and maximizing over the protocols , we may write@xmath970    the other conditions in eqs .",
    "( [ cvcc])-([cvcc3 ] ) are obtained by setting part of the rates @xmath971 to zero in the target state ( as in the previous proofs ) . in particular ,",
    "set @xmath972 for some @xmath43 , while @xmath973 for any @xmath974 .",
    "the target state becomes @xmath975 and we repeat the derivation with respect to the bipartition @xmath976 .",
    "this leads to @xmath977 where we may directly consider the reduced state @xmath978   .\\ ] ]    for any cut @xmath979 , we therefore have@xmath980   , \\label{multi22}\\ ] ] which leads to @xmath981 . by minimizing over the cuts ,",
    "one gets @xmath982 since this is true for any protocol @xmath947 , it can be extended to the achievable rates , i.e. , we get eq .",
    "( [ cvcc ] ) .    for the multicast network capacity ,",
    "just note that @xmath983 therefore , from eq .",
    "( [ bbbmmm ] ) , we may write@xmath984 this is true for any symmetric protocol @xmath985 which leads to the result of eq .",
    "( [ cmnmultics ] ) .",
    "@xmath51    as usual , in the case of distillable networks , we may prove stronger results .",
    "for a distillable network @xmath142 , we have @xmath166 , so that we may introduce the capacity - equivalent of the entanglement flux quantities .",
    "in fact , for any cut @xmath114 of a distillable network , we may write@xmath986 where @xmath168 is the broadband capacity of the cut .    then , for alice @xmath11 and the @xmath43th bob @xmath192 , we have@xmath987 where @xmath214 is the broadband capacity between the two end - points @xmath11 and @xmath192 .",
    "this is exactly the broadband capacity that we would achieve in a quantum unicast network , where the @xmath43th bob is the only receiver , according to the previous max - flow min - cut result of theorem  [ theomaxflow ] . combining previous theorem  [ theomulticast ] with eqs .",
    "( [ cvc1 ] ) and  ( [ cvc2 ] ) automatically proves the following .",
    "consider a quantum multicast network @xmath142 with one sender and @xmath189 receivers @xmath946 .",
    "if the network is distillable , then we have the following outer bounds for the capacity region @xmath213 where @xmath168 is the broadband capacity of cut @xmath114 and @xmath214 is the individual broadband capacity between the sender and the @xmath43th receiver . in particular",
    ", the multicast network capacity must satisfy the bound@xmath988    an important issue is to show the achievability of the cutset bound in eq .",
    "( [ cutsetdist ] ) .",
    "the question clearly remains open for error - free quantum communication @xmath989 ( due to issues related with quantum no - cloning at intermediate relays ) and equivalently for entanglement distillation @xmath990 ( due to similar issues related with entanglement monogamy ) .",
    "however , for secret key generation , the situation is different and we can reach the bound under the assumption that alice distributes the same single key to all bobs . this single - message scenario is further investigated in sec .",
    "[ secnetcoding ] .",
    "the multiple - multicast network is an extension of the previous case to considering multiple senders .",
    "we have @xmath221 alices @xmath222 , each of them communicating with @xmath223 bobs @xmath224 via multipath routing .",
    "each end - to - end multicast @xmath991 is associated with the distribution of generally - independent quantum resources or keys , from the @xmath43th alice to the entire destination set of bobs .",
    "the description of a multiple - multicast protocol for a quantum network follows the same main features discussed for the case of a single - multicast network @xmath992 ( see previous section ) .",
    "because we have multiple senders and receivers , here we need to consider all possible orientations of the network .",
    "each use of the quantum network is performed under some orientation which is adopted by the points for their point - to - point multicasts , suitably assisted by network loccs .",
    "use after use , these steps define a multiple - multicast protocol @xmath993 .",
    "after @xmath14 uses , the sets of alices and bobs will share an output state @xmath994 which is @xmath880-close to a target state @xmath995 where @xmath996 is a one - bit state ( private bit or ebit ) for the pair @xmath997 and @xmath998 the number of its copies . by taking the limit of large @xmath14 and optimizing over @xmath993 ,",
    "we define the capacity region for the achievable rates @xmath999 .",
    "assume the symmetric case where the @xmath43th alice @xmath191 achieves the same rate @xmath1000 with all bobs @xmath224 .",
    "this means to consider symmetric protocols whose target state @xmath899 must have @xmath1001 bits for any @xmath43 . by taking the asymptotic limit of @xmath971 for large @xmath14 and maximizing over all symmetric protocols",
    ", we may define the capacity region for the achievable multicast rates @xmath1002 . in the latter",
    "set , rate @xmath225 provides the minimum number of target bits per use that the @xmath43th alice may independently share with each bob in the destination set @xmath1003 .",
    "we have the following for stretchable and distillable networks .    [",
    "quantum multiple - multicast][theomultimulti]consider a quantum multiple - multicast network @xmath142 where each of the @xmath221 senders @xmath1004 communicates with @xmath223 receivers @xmath1003 at the achievable rate @xmath225 .",
    "let us consider all possible cuts @xmath126 such that @xmath1005 and @xmath1006 . then",
    ", if the network is stretchable , we have the following outer bounds for the capacity region @xmath1007 where @xmath168 is the broadband entanglement flux through cut @xmath114 . for a distillable network",
    ", we may write@xmath1008 where @xmath168 is the broadband capacity of cut @xmath114 .",
    "*  the proof is again similar to previous ones .",
    "consider the upper bound given by secret - key generation .",
    "with respect to the bipartition @xmath1009 , we can manipulate the distillable key @xmath1010 of the target state @xmath899 as follows @xmath1011 leading to the asymptotic limit@xmath1012    for any cut @xmath1013 of the stretchable network , we may write the choi decomposition@xmath1014   , \\ ] ] and manipulate eq .",
    "( [ repkkkj3 ] ) into the following@xmath1015 by minimizing over the cuts and maximizing over the protocols , we may write@xmath1016    by setting part of the rates @xmath1017 to zero in the target state , we derive the full set of conditions @xmath1018    the latter conditions are valid for the end - to - end rates @xmath1019 achievable between each pair @xmath997 .",
    "we are interested in the achievable multicast rates @xmath1020 between each sender @xmath191 and all receivers @xmath224 .",
    "corresponding conditions can be derived by considering a subset of protocols with target state of the type @xmath1021 for some @xmath241 , where all alices @xmath222  aim to optimize their rates @xmath1022 with some fixed bob @xmath1023 , so that @xmath1024 for any @xmath1025 . by repeating the previous steps with respect to the bipartition @xmath1026 , we obtain@xmath1027 since we have @xmath1028 for any @xmath241 , we can then write the same inequality for @xmath1029 . then , by optimizing over the protocols , we get@xmath1030 because the latter expression is true for any @xmath241 , we may equivalently write@xmath1031 with @xmath126 such that @xmath1032 and @xmath1033 .    now , for any fixed @xmath241 , impose that the rates @xmath1022 are zero for some of the alices @xmath222 .",
    "if we only have @xmath1034 for a pair @xmath1035 , then the condition @xmath1036 leads to@xmath1037 because the latter is true for any @xmath241 , we may then write@xmath1038 with @xmath126 such that @xmath889 and @xmath1006 . extending the previous reasoning to two non - zero rates @xmath1034 and",
    "@xmath1039 leads to@xmath1040 with @xmath126 such that @xmath1041 and @xmath1033 .",
    "other similar conditions can be derived for the multicast rates .",
    "compactly , all these conditions can be written as@xmath1042 with @xmath126 such that @xmath1005 and @xmath1033 , which is the result of eq .",
    "( [ setcvb ] ) .",
    "finally , for a distillable network we have @xmath1043 and , therefore , it is immediate to express all the previous results in terms of the broadband capacities of the cuts , and derive eq .",
    "( [ setcvbb ] ) .",
    "@xmath51      our previous results for the single- and multiple - multicast networks refer to the general case of multiple independent messages .",
    "this means that the end - to - end multicast between alice @xmath191 and the destination set of @xmath223 bobs @xmath224 corresponds to the distribution of @xmath223 sets of ebits , independent sequences of qubits , or independent secret keys . in the case of key distribution",
    ", it is interesting to consider the specific case where alice @xmath191 wants to distribute exactly the same secret key to all bobs @xmath224 .    by restricting previously - described quantum protocols to this particular task",
    ", we may define corresponding single - message versions for the achievable rates . in a quantum multicast network with one alice @xmath11 and @xmath189",
    "bobs @xmath224 , the single - key multicast capacity @xmath1044 is the maximum rate at which alice@xmath1045may distribute the same secret key @xmath241 to all bobs . in a quantum multiple - multicast network with @xmath221 alices and @xmath223 bobs ,",
    "the single - key multicast rates @xmath1046 are the maximum rates at which the different alices may distribute different secret keys @xmath1047 to all bobs .",
    "it is clear that these rates must satisfy the same cutset bound given in previous theorems . for stretchable networks ,",
    "we have@xmath1048 and@xmath1049 for distillable networks , we may write the latter expressions with @xmath1050 . most importantly , we may prove the achievability of the outer bounds by resorting to quantum protocols that combine optimal routing with linear network coding  @xcite .",
    "we therefore prove a quantum version of the network coding theorem  @xcite    [ network coding theorem for qkd]consider a distillable quantum network @xmath142 .",
    "the single - key multicast capacity between one sender and a set of @xmath189 receivers @xmath224 is given by@xmath1051 where @xmath1052 is the broadband secret - key capacity between the sender and the @xmath457th receiver .",
    "assuming @xmath221 senders @xmath222 and @xmath223 receivers @xmath224 , the capacity region of the single - key multicast rates must satisfy@xmath1053 where @xmath231 is the broadband secret - key capacity of cut @xmath114 . in particular , we may write the achievable bound @xmath1054 with @xmath126 such that @xmath1032 and @xmath1033 .    * proof . *",
    "let us start with the single - multicast case , i.e. , a single sender .",
    "the proof repeats some of the steps of the previous proofs for multi - path routing .",
    "first of all we transform the quantum network into a directed network where each undirected edge is split in two directed edges .",
    "the alice - bob cut properties of the original quantum network and the new directed graphical network are exactly the same if we consider a corresponding directed  definition for the cut - sets . in particular , the cutset bound in eq .",
    "( [ cutsetnnn ] ) remains the same for the directed network under the re - definition of the cut - sets .",
    "an optimal key distribution protocol goes as follows .",
    "the points distill @xmath851 ebits along each ( undirected ) edge .",
    "these ebits are then used to teleport orthogonal states along the directed edges of the oriented graphical network .",
    "let us call @xmath241 alice s secret variable , uniformly chosen and encoding @xmath55 bits .",
    "after @xmath14 extractions of @xmath241 , we have a sequence @xmath1055 of @xmath179 bits .",
    "let us split this sequence into @xmath1056 blocks @xmath1057 , where each block @xmath1058 contains @xmath1059 bits . for large @xmath14 , we may always assume that @xmath1060 is an integer , so that each block corresponds to an element of the finite field @xmath1061 .",
    "the blocks are then subject to a linear coding transformation , i.e. , alice computes the output @xmath1062{c}\\tilde{k}_{1}^{n}\\\\",
    "\\vdots\\\\ \\tilde{k}_{m}^{n}\\end{array } \\right )   = \\left ( \\begin{array } [ c]{ccc}\\alpha_{11 } & \\cdots & \\alpha_{1m}\\\\ \\vdots & \\ddots & \\vdots\\\\ \\alpha_{m1 } & \\cdots & \\alpha_{mm}\\end{array } \\right )   \\left ( \\begin{array } [ c]{c}k_{1}^{n}\\\\ \\vdots\\\\ k_{m}^{n}\\end{array } \\right )   , \\ ] ] with some coefficients @xmath1063 .",
    "the generic block @xmath1064 is encoded into an orthogonal set of pure states @xmath1065 and teleported to a neighbor point @xmath1066 by means of the @xmath1067 shared ebits .",
    "alice communicates both the dimension of the basis @xmath1068 and the outcome of the bell detection to point @xmath178 .",
    "the latter will apply the correction unitary and then detect the state with the povm @xmath1069 , so to extract @xmath1070 without errors . in this way",
    ", the blocks of the sequence @xmath1071 are all teleported from alice to her neighborhood @xmath1072 .    in turn , each point @xmath173 of the network will receive a number of teleported states which will be measured and decoded into the blocks of an input sequence @xmath1073 .",
    "the latter will be subject to linear coding with coefficients @xmath1074 and transformed into an output sequence @xmath1075 whose blocks are encoded into orthogonal states and then teleported to neighbor points , and so on . in this way , we have transformed the original network into a teleportation network where orthogonal states are used to securely transfer blocks of the secret key through the points of the network , with the only limitation being provided by the point - to - point capacities @xmath171 .",
    "security is provided by the pre - distillation of the ebits , while the effective secret - key transfer has become equivalent to solving the transfer of classical bits in a directed network , thanks to teleportation .",
    "for this reason we can apply the classical network coding theorem  @xcite , which states that the optimal achievable rate @xmath55 is equal to the cutset bound ( e.g. , see theorem  15.3 of ref .",
    "@xcite ) . here",
    ", this means that the single - key multicast capacity @xmath219 saturates the cutset bound in eq .",
    "( [ cutsetnnn ] ) .",
    "note that we may equivalently write@xmath1076    let us now consider multiple - multicasts , i.e. , @xmath873 alices .",
    "it is trivial to show that the bound of eq .",
    "( [ trivvbb ] ) just follows from specifying theorem  [ theomultimulti ] to single - key multicast rates , as already discussed in regard to previous eq .",
    "( [ trivnn ] ) .",
    "let us further specify this bound to the case where @xmath1032 , so that it takes the expression in eq .",
    "( [ achievnetcod ] ) .",
    "this specific cutset bound for the sum of all rates is achievable .",
    "in fact , as shown before , by means of point - to - point entanglement distillation , we can transform the quantum network into a classical network where secret bits are transferred by teleportation and classically manipulated at the points .",
    "then , on the classical network , we can use the same arguments of ref .",
    "@xcite .",
    "in particular , we may introduce an auxiliary node or super - alice @xmath1077 which is connected to all alices @xmath222 by means of edges with capacities @xmath1078 . in this augmented network @xmath591",
    ", we can interpret a single - message communication from @xmath1077 to the bobs @xmath224 as a multiple - message communication from @xmath222 to @xmath224 .",
    "now it is sufficient to note that , in the augmented network , the single - key multicast capacity is given by @xmath1079 the second observation is that @xmath1080 combining the latter two equations and considering that the minimization over @xmath1081 is equivalent to that over @xmath222 , we obtain the achievability of the outer bound in eq .",
    "( [ achievnetcod ] ) .",
    "in this work , we have established the ultimate end - to - end rates for transmitting quantum information , distributing entanglement and generating secret correlations between two end - points of a repeater chain and , more generally , of a quantum network under the most fundamental routing strategies .",
    "we have derived simple analytical formulas for the various repeater - assisted and network - based capacities considering the most relevant models of decoherence for cv and dv systems , including loss , quantum - limited amplification , dephasing and erasure .",
    "all these results are found by employing a new methodology which may go well beyond our goals .",
    "in fact , we have shown how to simplify the most general adaptive protocols that can be performed in repeater chains and quantum networks , where all points may exploit unlimited two - way ccs , one with each other , and perform adaptive los on their quantum systems ( network loccs ) . assuming that a network is stretchable , i.e. , connected by quantum channels commuting with teleportation , we can apply teleportation stretching  @xcite and reduce the network into an equivalent choi representation , where channels are replaced by tensor products of choi matrices .",
    "thanks to entanglement cuts of the network , we can further simplify the choi representation and exploit the relative entropy of entanglement to compute sufficiently - tight upper bounds for the end - to - end network capacities .",
    "these bounds are very general , since stretchable networks are extremely common in both cv and dv settings .",
    "for instance , quantum networks connected by gaussian or pauli channels are all stretchable .",
    "most importantly , we have proven the achievability of these upper bounds for fundamental types of stretchable networks , which are those connected by distillable channels , such as lossy channels , quantum - limited amplifiers , dephasing and erasure channels in arbitrary dimension .",
    "in such distillable networks , we can achieve the capacity by combining point - to - point protocols , involving loccs between neighbor points , with classical routing strategies , so that the individual outputs are composed to realize an optimal end - to - end transmission of quantum information or distribution of quantum / secret correlations .",
    "in particular , for the sequential use of a distillable network , the optimal strategy for single - path routing is reduced to the solution of the widest path problem , so that this basic tool of classical network theory is extended to quantum communications .",
    "then , for the broadband use of a distillable network , the optimal multipath routing is given by the maximum flow of qubits within the network , so that the max - flow min - cut theorem is also extended from classical to quantum communications .",
    "in the multipath setting , let us remark that the flooding  condition @xmath1082 , corresponding to each edge being used exactly once in each multipath transmission , is crucial to achieve a maximum flow of quantum information or entanglement through the network , i.e. , to prove our quantum version of the max - flow min - cut theorem",
    ". however , let us also notice that non - flooding protocols ( where @xmath1082 is not enforced ) may also have good performances . independently from our results , recent ref .",
    "@xcite has considered these protocols and showed the absence of scaling gaps in general quantum networks .",
    "the applicability of our results is very wide , encompassing both dv networks , such as spin networks , and cv networks , such as optical bosonic networks .",
    "more generally , they can be applied to hybrid scenarios , involving both dv and cv systems , as is expected in a distributed quantum computing architecture or quantum internet  @xcite .",
    "an important practical application is clearly for optical and telecom quantum communications , where bosonic loss is the main cause of decoherence in fibers and free - space links , especially at long distances , e.g. , in connections with satellites .    in the specific optical / telecom",
    "setting , our results establish the fundamental rate - loss scaling affecting repeater - assisted and network - based quantum and private communications .",
    "this trade - off bounds the optimal performance of any end - to - end qkd protocol , which is performed in repeater chains or quantum networks , therefore generalizing the fundamental limits of ref .  @xcite .",
    "in particular , we now have the full meter  for assessing the performance of quantum repeaters : not only we can establish if a repeater is beating the point - to - point benchmark  @xcite but we may also analyze how far it is working from the optimal rate allowed by quantum mechanics .    finally , we have also extended our results to quantum networks with multiple senders and receivers , considering the most fundamental models of network multipoint communication , including multiple - unicast , multicast and multiple - multicast . for the specific case of key generation in distillable networks ,",
    "we have proven a quantum communication version of the network coding theorem , which establishes the longest secret key that a sender may simultaneously share with many receivers .",
    "future investigations can be pursued in several directions .",
    "one is the determination of the end - to - end capacities for all stretchable networks ( not only those distillable ) .",
    "this further development requires to compute the two - way capacities for all possible stretchable channels and then adopt the methods of this work to extend the results to chains and networks .",
    "another challenging step will be to include non - stretchable quantum channels , such as the amplitude damping channel .",
    "further work should certainly be carried out for quantum networks with multiple senders and receivers with the final goal of fully characterizing their capacity regions .    *",
    "acknowledgments*.  this work has been supported by the epsrc  via the ` uk quantum communications hub ' ( ep / m013472/1 ) and ` qdata ' ( ep / l011298/1 ) .",
    "s.p . would like to thank richard wilson , edwin hancock , and rod van meter for discussions , and saikat guha for comments on the bounds in ref .",
    "@xcite .                c. h. bennett and g. brassard , _",
    "quantum cryptography : public key distribution and coin tossing _ ,  proc .",
    "ieee international conf . on computers , systems , and signal processing , bangalaore , pp .",
    "175179 ( 1984 ) .",
    "s. pirandola _",
    "_ , _ reply to ` discrete and continuous variables for measurement - device - independent quantum cryptography ' _ , nature photon . * 9 * , 773 - 775 ( 2015 ) .",
    "see also preprint arxiv.1506.06748 ( 2015 ) .        c. h. bennett , g. brassard , c. crepeau , r. jozsa , a. peres , and w. k. wootters , _ teleporting an unknown quantum state via dual classical and einstein - podolsky - rosen channels _ , phys .",
    "* 70 * , 1895 - 1899 ( 1993 ) .",
    "it is understood that the choi matrices of bosonic channels are unbounded and therefore must be defined as the asymptotic limit of finite - energy states . in such a limit , we intend the teleportation stretching @xmath1083 of bosonic channels and the bounds @xmath1084 and @xmath367 , as thoroughly explained in ref .  @xcite .                                                            if the loccs of the protocol contain measurements , the entire sequence @xmath288  can be made trace - preserving a posteriori , by averaging over all the possible outcomes . as discussed in ref .",
    "@xcite , the resulting average provides the average rate of the protocol , which is what we need to consider in the definition of the capacity .      strictly speaking , the locc @xmath49 is trace - preserving if we start from a trace - preserving locc @xmath312  in the original protocol .",
    "as previously said , if @xmath312 does not preserve the trace because it contains measurements , there will be a final averaging over the corresponding outcomes that will make everything trace - preserving _ a posteriori_.                                  in general ,",
    "these strategies are chosen probabilistically by all the points of the network during each end - to - end transmission . however , in a deterministic network , where connections are stable and the end - points may control the routing table , such strategies may be chosen probabilistically at the beginning of each end - to - end transmission and , most importantly , they may be adapted towards an optimal asymptotic strategy thanks to the classical feedback from all the intermediate repeaters .    note",
    "that , if we allow for the possibility of overlapping multicasts , resulting in multiple uses of some edge , then we may just split that edge into identical edges ( one for each use ) and analyse the resulting new network under the assumption of non - overlapping multicasts .    note that a channel @xmath104 , associated with an edge @xmath130 , may be in common to different routes , e.g. , @xmath1085 for @xmath1086 . in the presence of non - simple paths",
    ", the same edge may also appear in different @xmath1087  positions of the same route @xmath75 .",
    "any @xmath101 can be made integer or infinitesimally close to an integer for suitably large @xmath14  and for any _ finite _ @xmath100 .",
    "the size of @xmath100 , i.e. , the number of end - to - end routes , is certainly finite if we consider routes which are simple paths in a finite network .",
    "see refs .",
    "@xcite on how to enumerate and bound the number of simple paths in a general graph .",
    "note that one may always enforce a single direction between @xmath173 and @xmath178 by introducing an artificial point @xmath1088  in one of the two directed edges .",
    "for instance , we may keep @xmath130 as is , while replacing @xmath1089 with @xmath1090 and @xmath1091 , both having the same capacity of @xmath1089 .",
    "this further modification does not affect the maximum flow value and the minimum cut capacity , but increases the complexity of the network ."
  ],
  "abstract_text": [
    "<S> we establish the ultimate rates for transmitting quantum information , distilling entanglement , and distributing secret keys in repeater - assisted quantum communications , under the most fundamental decoherence models for both discrete and continuous variable systems , including lossy channels , quantum - limited amplifiers , dephasing and erasure channels . </S>",
    "<S> these capacities are derived considering the most general adaptive protocols of quantum and private communication between the two end - points of a repeater chain and , more generally , of an arbitrarily - complex quantum network or internet , where systems may be routed though single or multiple paths . </S>",
    "<S> our methodology combines tools from quantum information and classical network theory . </S>",
    "<S> converse results are derived by introducing a novel tensor - product representation for a quantum communication network , where quantum channels are replaced by their choi matrices . exploiting this representation and suitable entanglement cuts of the network , we upperbound the end - to - end capacities by means of the relative entropy of entanglement . </S>",
    "<S> achievability of the bounds is proven by combining point - to - point quantum communications with classical network algorithms , so that optimal routing strategies are found by determining the widest path and the maximum flow in the network .  in this way </S>",
    "<S> we extend both the widest path problem and the max - flow min - cut theorem from classical to quantum communications . </S>",
    "<S> finally , we generalize our results to multiple senders and receivers in the quantum network , proving a quantum version of the network coding theorem for multi - end quantum key distribution . </S>"
  ]
}