{
  "article_text": [
    "the interstellar medium of our galaxy , consisting of large regions of ionized gas with free electrons , can be modeled as a cold tenuous plasma which alters the characteristics of any electromagnetic wave passing through it .",
    "pulsar signals are ideal tools to study these effects because of the pulsed nature of their signal , which allows one to probe the effects of dispersion and scattering .",
    "furthermore , the compact nature of the source allows one to observe the effects of scintillation . on the other hand",
    ", the same dispersion and scattering effects can be a hindrance to the detection and detailed study of short period pulsars , especially at low radio frequencies and typical galactic distances ( see @xcite and @xcite for a review of these effects ) .",
    "this becomes very important for low frequency radio telescopes such as the gmrt .",
    "the gmrt located in khodad near pune , india is a multi - element aperture synthesis telescope consisting of 30 antennas , each with a diameter of 45 metres , and spread over a region of 25 km diameter ( @xcite ) .",
    "it currently operates in 5 frequency bands centered around 150 mhz , 235 mhz , 325 mhz , 610 mhz and 1000 - 1450 mhz , with a maximum available bandwidth of 32 mhz .",
    "the high sensitivity of the gmrt at low frequencies , as well as its wide frequency coverage with reasonably large bandwidths makes it a powerful instrument for pulsar studies .",
    "pulsar observations can be carried out in the array mode in two ways : the incoherent array ( ia ) mode or the phased array ( pa ) mode(@xcite ) .    in the ia mode , the power signals from each of the antennas are added to produce the final total intensity signal , whereas in the pa mode , voltage signals from the antennas are phased , added and then detected to produce the final signal .",
    "the intensity signals in both these modes have 256 or 512 spectral channels , leading to minimum time resolutions of 16 and 32 microseconds , respectively .",
    "these can be integrated to produce the desired time resolution , and then recorded on disk as intensities in multiple spectral channels .",
    "the pa mode also has a voltage beam mode where the raw voltage from a single phased array beam can be recorded on a disk , as the real and imaginary parts from the output of a fast fourier transform ( fft ) on the original voltage time series , with 256 or 512 spectral channels .",
    "pulsar observations at low frequencies are distorted by the deleterious effects of dispersion , which can limit the utility of such an instrument .",
    "when an electromagnetic wave travels through the ionized interstellar medium , low frequency components of the signal travel slower than the higher frequency components due to dispersion , which causes a broadband sharp pulse from the source to be smeared out in time when detected with a receiver having a finite bandwidth . this effect becomes more significant at lower frequencies ( as the dispersion delay for a frequency @xmath0 increases as @xmath1 ) , and hence proper correction techniques are vital for pulsar observations in this regime .",
    "the correction for dispersion involves accounting for the frequency dependent velocity of the electromagnetic waves in the interstellar medium , and applying appropriate time delays , or alternatively , phase corrections in the frequency domain to correct for dispersion .",
    "this leads to two techniques for implementing such modifications : incoherent and coherent dedispersion ( @xcite ) . in the former , the observable bandwidth",
    "is split into a number of smaller channels , and the signal is detected separately in each of the channels .",
    "appropriate time delays are then applied to align the pulses in the separate frequency channels , which are then added to produce a dedispersed time series .",
    "it is evident that this technique does not remove the intra - channel dispersion time , which can only be reduced by using a larger number of channels across the bandwidth .",
    "however , this comes at the cost of reduced time resolution since the nyquist time resolution of a channel of width @xmath2 is @xmath3 .",
    "coherent dedispersion ( @xcite ) can provide significant improvements over incoherent dedispersion by completely removing the effects of interstellar dispersion , and recovering the original nyquist time resolution of the sampled voltage signal .",
    "this is done by deconvolving the received voltage signal at the telescope with the transfer function of the interstellar medium , which is treated as a linear filter .",
    "the length of the impulse response to be deconvolved is roughly proportional to the inverse cube of the frequency of observation , linearly proportional to the dispersion measure ( dm ) along the line of sight , and has a quadratic dependence on the bandwidth of observation .",
    "since convolutions are efficiently computed in the frequency domain by using efficient fft algorithms , it is evident that implementing such a technique at low frequencies and large bandwidths is a challenging task due to the computation of the long ffts ( the length of which has to be larger than the impulse response ) that are involved in the process .",
    "the inaccuracies of the incoherent dedispersion technique can be a significant drawback for observations at low frequencies requiring high time resolution .",
    "coherent dedispersion is thus very useful for pulsar observations with low frequency telescopes such as the giant metrewave radio telescope ( gmrt @xcite ) , the long wavelength array ( lwa @xcite ) , the low frequency array ( lofar @xcite ) and the murchison widefield array ( mwa @xcite ) .    as a demonstration of the merits of the coherent dedispersion technique , we present incoherently and coherently",
    "dedispersed folded profiles of the pulsar b1937 + 21 , observed with the gmrt at 325 mhz and dedispersed with our offline coherent dedispersion system , in figure [ fig:1937 + 21 ] .",
    "since this pulsar has a relatively large dm of 71 pc / cc and a very short period of 1.55 ms , the effects of intra - channel dispersion time are clearly evident in terms of smearing of the folded profile in the incoherently dedispersed case . on the other hand ,",
    "the coherently dedispersed profile shows sharper pulses and a clear indication of a scattering ` tail ' ( described in section [ scattering ] ) .",
    "we describe the details of the coherent dedispersion technique in section [ cd ] .",
    "@c@ + ( a ) incoherently dedispersed and normalized folded profile for b1937 + 21 .",
    "@c@ + ( b ) coherently dedispersed and normalized folded profile for b1937 + 21 .",
    "coherent dedispersion necessarily requires one to process the original nyquist sampled voltage signal from the phased array beam .",
    "since this voltage data can not be integrated , it either has to be stored on a disk for offline processing , or processed in real - time .",
    "recording voltage data in such cases can require very large amounts of disk space ( particularly for long term programs such as high precision timing ) , and may be a difficult task as one goes for larger bandwidths of observation .",
    "for example , with the current gmrt software back - end ( @xcite ) , the data recording rate is 120 gb / hour in the 16 mhz mode and 240 gb / hour in the 32 mhz mode of observation .",
    "for the 200 mhz bandwidth of the upgraded gmrt wideband back - end , the data recording rate required would be 1500 gb / hour , which would be impractical for recording followed by offline processing , especially for long term observing programs .",
    "the data rates would be similar for other low frequency telescopes with similar bandwidths . for higher frequency telescopes like the green bank telescope ( @xcite ) where the bandwidths may be larger",
    ", the data rates would be proportionately higher .",
    "implementing coherent dedispersion in real - time provides a solution to overcome these drawbacks .",
    "however , the process of coherent dedispersion itself is computationally expensive ( especially at low radio frequencies ) , requiring the computation of large ffts ( often longer than a million points ) , and hence requires a large amount of computing power to implement in real - time . an effective way to reduce the computational load of the process",
    "is dividing the bandwidth of the receiver into a number of channels , coherently dedispersing each sub - band , followed by alignment of the individual sub - bands in time ( the individual sub - bands thus do not contain any intra - channel dispersion ) . using smaller sub - bands",
    "reduces the length of the impulse response to be convolved with , thereby reducing the required length of the ffts and the overall computational load",
    ". however , this comes at the cost of reduced time resolution , which is now limited by the inverse of the bandwidth of the individual smaller sub - bands .",
    "one of the first real - time coherent dedispersion systems was developed in the mid-1980s by hankins and rajkowski ( @xcite ) at the arecibo observatory for a modest bandwidth of 1.5 mhz centered at a frequency of 1414 mhz using a hardware based implementation . before this ,",
    "coherent dedispersion was most commonly implemented by recording data on magnetic tape , followed by offline processing in hardware / software based systems .",
    "the recent emergence of parallel computing on cpu - based clusters and gpus has provided a powerful tool to realize the associated computational challenges and develop real - time coherent dedispersion systems .",
    "the puma - ii back - end developed at the westerbork synthesis radio telescope ( wsrt @xcite ) demonstrated the use of a cpu cluster to implement a near real - time coherent dedispersion system for a bandwidth of 160 mhz , by dividing the bandwidth into 8 sub - bands , each with a bandwidth of 20 mhz , and then dedispersing and combining the signal .",
    "the system first records the baseband signal into a cluster of disks , which is then processed with the a 32 node cluster in near real - time .",
    "it has been implemented with the code available from the open - source software library digital signal processing software for pulsar astronomy ( dspsr @xcite ) .",
    "the dspsr was developed for pulsar observations at the parkes telescope and allows coherent dedispersion to operate in multiple modes involving both cpus and gpus .",
    "as with the dedispersion system in puma - ii , dspsr implements coherent dedispersion by forming a filter - bank of smaller bandwidths , which are coherently dedispersed , detected and aligned in time .",
    "the green bank ultimate pulsar processing instrument ( guppi @xcite ) , functioning on fpgas , a cpu cluster and a gpu cluster of 8 gpus includes a wide bandwidth coherent dedispersion system supporting a total bandwidth of 800 mhz .",
    "the total bandwidth is divided into 8 smaller sub - bands , each of which can be processed in one gpu of the 8 gpu cluster .",
    "the nancay telescope has recently developed a real - time gpu - based coherent dedispersion back - end ( @xcite ) .",
    "a gpu cluster consisting of 4 nvidia geforce 8800 gtx cards is used to coherently dedisperse a bandwidth of 128 mhz ( after sub - banding into four 32 mhz bands ) , at frequencies in the l - band .",
    "the range of fft lengths implemented by these systems ( typically of the order of 1 million points ) are however much smaller than that required for dedispersing signals at low frequencies with similar bandwidths and dms .",
    "scattering occurs due to electron density fluctuations in the interstellar medium , which causes part of the signal from the source to be deflected from its original path of propagation and travel along longer nearby paths . in the case of pulsars ,",
    "this time delay causes narrow pulses to be spread out into an exponential ` tail ' ( see @xcite ) .",
    "the effective time resolution obtainable from coherent dedispersion is thus limited by scatter broadening in the interstellar medium which , unlike dispersion , can not be removed by post - processing techniques .",
    "hence , it is a useful exercise to estimate the best time resolution obtainable in the presence of scattering .",
    "to estimate the effect of scattering for the frequency bands in use at the gmrt , we use the empirical relation determined by bhat et al .",
    "( @xcite ) relating the scattering time @xmath4 to the dispersion measure ( dm ) of the pulsar .",
    "we compare the estimated scattering time @xmath4 as a function of dm for a fixed observing frequency ( center frequencies of 325 mhz and 610 mhz ) with the intra - channel smear time for incoherent dedispersion using 256 channels ( as implemented at the gmrt ) for a fixed bandwidth of observation .",
    "the results are shown in figure [ fig : scattering ] for two sets of parameters .",
    "note that the @xmath4 - dm relation has a significant scatter in observations ( the plots show a scatter of one order of magnitude , which is typically observed @xcite ) , and hence the plots are only meant to give approximate estimates .    @c@ + ( a ) center frequency of 325 mhz    @c@ + ( b ) center frequency of 610 mhz    as can be seen from figure [ fig : scattering ] , for small values of dm , the scattering time is significantly smaller than the intra - channel dispersion time for incoherent dedispersion .",
    "as a result , coherent dedispersion can be useful in this regime for obtaining better time resolution .",
    "the scattering curve still provides a lower limit to the obtainable time resolution ( instead of the nyquist resolution ) after coherent dedispersion has been performed .",
    "however , above a particular value of dm ( depending on the frequency of observation ) , the scattering time dominates over the intra - channel smear time , and hence coherent dedispersion would provide no improvement over incoherent dedispersion in this regime . for 610 mhz observations ,",
    "this limiting value of the dm is around 100 pc / cc , and it is a bit less than that for 325 mhz observations .",
    "the action of the interstellar medium on a propagating electromagnetic wave can be considered as that of a linear filter with a transfer function @xmath5 , where @xmath0 is the observing frequency .",
    "let @xmath6 and @xmath7 be the fourier transforms of the electromagnetic wave emitted at the pulsar and that received at the telescope respectively . considering a real - sampled signal ,",
    "let the bandwidth of observation extend from a frequency of @xmath8 to @xmath9 , where @xmath10 is the lower edge frequency of the band , and @xmath11 is the bandwidth .",
    "if @xmath12 be the deviation from the lower edge of the band so that @xmath13 , then the expression for the received wave can be expressed as @xmath14 .",
    "the phase picked up by an electromagnetic wave travelling though the ism is given by ( see @xcite ) , @xmath15 where l is the distance travelled in the ionized plasma , @xmath16 is the plasma frequency of the medium and @xmath17 is the speed of light .",
    "hence , the transfer function can be written as @xmath18 , which , using equation [ new_eq ] , can be rewritten as @xmath19}\\label{eq:1}\\ ] ] the first term in the square brackets is a constant phase offset which is lost in detection , while the second term is a linear frequency gradient which corresponds to a time delay in the arrival of the pulse .",
    "the third term causes the dispersion within the band , and needs to be corrected for .",
    "hence the transfer function to correct for the dispersion within the band is the inverse of the third term in equation [ eq:1 ] . in terms of the dispersion measure of the pulsar",
    ", the third term can be expressed as , @xmath20 where @xmath21 is a constant equal to @xmath22 cc / pc mhz .",
    "the impulse response associated with the transfer function in equation [ eq:2 ] has been numerically computed for two sets of parameters and are shown in figure [ fig : impulse ] ( a ) , with the normalized amplitude of the response plotted as a function of time .",
    "the necessary parameters in this case are the observing frequency , bandwidth of observation and the dm along the line of sight to the pulsar .",
    "the length of the response is equal to the dispersion time in the observing band .",
    "the discontinuous termination of the transfer function in the frequency domain ( corresponding to multiplication of the transfer function with a rectangular window , with a width equal to the bandwidth of the receiver ) produces ripples in the time domain impulse response . these ripples can produce unreal artifacts in the data , and hence need to be eliminated with the use of an appropriate window or taper function in the frequency domain .",
    "the modified impulse response for two well known window functions , the hanning and welch windows are shown in figure [ fig : impulse ] ( b ) , which show reduced levels of oscillations , however , at the cost of reduced sensitivity to the edges of the band .",
    "the taper function multiplied with the inverse transfer function is known as the _ chirp function_.    @c@ + ( a ) normalized impulse response amplitude .",
    "@c@ + ( b ) effect of applying a window function .",
    "deconvolution of the ism impulse response requires proper book - keeping of edge effects to prevent aliasing in the computed time series .",
    "the overlap - save method is a standard method of computing long convolutions , as described in @xcite , where the number of samples corresponding to the length of the impulse response is discarded from the beginning of the output of a time series segment which has been convolved , while the same number of samples at the end is overlapped with the next such segment in the data to maintain continuity in the time series .      at the gmrt ,",
    "the voltage beam data is recorded as 8-bit integers from the output of a fft performed on the original sampled voltage from the phased array .",
    "consequently , one needs to perform an inverse fft on the beam data to get back the original time series , and then perform a longer fft to implement the deconvolution algorithm of coherent dedispersion .",
    "the length of the long fft ( designated with the letter ` n ' henceforth ) has to be at least greater than the number of samples corresponding to the length of the impulse response , i.e. , the dispersion time in the band .",
    "since ffts can be efficiently computed if the length is a power of 2 , we choose the number of samples to be the smallest power of 2 greater than twice the number of samples corresponding to the dispersion time .",
    "the phase changes are then applied to the spectral output from the long fft , and the overlap - save method is used to get back dedispersed data in the time domain .",
    "the final algorithm implemented for the gmrt is schematically shown in figure [ fig : coherent_algorithm ] .",
    "our initial attempts towards developing a coherent dedispersion system for the gmrt were centered around designing an optimized cpu - based implementation of the algorithm ( see @xcite for a cluster based cpu implementation ) and comparing its performance with respect to that required for a real - time pipeline .",
    "we report the steps involved in implementing and optimizing such a cpu - based coherent dedispersion system , as well as our results on its performance as compared to real - time processing rates .",
    "the computing resources used include an intel xeon x5550 cpu @ 2.67 ghz with 4 cores ( supporting a maximum of 8 threads simultaneously ) with on board ram of 4 gb .",
    "we have based our cpu implementation on the fastest fourier transform in the west ( fftw ) package ( @xcite ) , which provides optimized routines to perform forward and inverse ffts on sampled real data .",
    "all our routines have been coded using the double precision floating point format , since we found that the use of single precision resulted in clearly visible artifacts in the dedispersed time series .",
    "we believe that this is due to the fact that the single precision floating point fftw routines produce increasingly inaccurate results ( which are much larger than those for double precision computations ) when computing longer ffts ( see @xcite ) .",
    "see section [ cufft ] for an example of this effect .      given the different steps involved in the dedispersion algorithm , the first step towards optimization would involve dividing the algorithm into different and independent sections which can be executed in parallel on a multiple core processor .",
    "however , as shown in figure [ fig : coherent_algorithm ] , each of the steps in the algorithm is dependent on the earlier step , and hence one is required to proceed by performing the different steps in parallel , but on consecutive blocks of data . in this case",
    ", the blocks of data correspond to each of the long n point segments on which the fft is to be performed .",
    "we have designed a scheme where the process has been divided into 3 different sections , such that the respective routines can process different blocks of data and then transfer these to the next process in the pipeline via shared memory .",
    "the division of the process into three different sections follows logically from the schematic shown in figure [ fig : coherent_algorithm ] , with the individual sections ( processes ) corresponding to :    * inverse transforming the voltage fft data * performing coherent dedispersion on the voltage time series * detecting and writing the dedispersed intensity signal to a disk    seven of the eight available threads on the system are used .",
    "the number of threads assigned to each process has been selected based on tests to determine the best configuration to balance the computational load of different routines .",
    "the optimal algorithm derived is depicted in figure [ fig : cpu_scheme ] .         + the details of the individual routines are as follows : + _ inverse transform ( block i ) : _ the spectral data from the gsb is from a 1024 point or 2048 point fft on the original nyquist sampled voltage data .",
    "the gsb is however configured to output this data in larger blocks , consisting of a number of these fft outputs in series .",
    "hence , to improve the processing rate , we use 2 threads on the processor to simultaneously inverse transform 2 halves of a given block into a continuous time series . the data is then written into a ping - pong scheme double buffer in shared memory .",
    "the use of the double buffer in shared memory allows the next routine in the pipeline to read from a shared memory segment , while the other is being simultaneously written into by the current routine .",
    "+ _ coherent dedispersion ( block i-1 ) : _ the chirp function is initialized in this routine , and the voltage time series ( block i-1 ) from the inverse transform is read from the shared memory double buffer .",
    "multi - threaded fftw using 4 threads is used to compute the long n - point fft , the chirp function is applied and then the data is inverse transformed into a time series . this time series is written to a single shared memory segment for the next step of processing . + _ write to disk ( block i-2 ) : _ this routine ( using 1 cpu thread ) reads the deconvolved voltage data ( block i-2 ) written to a shared memory segment by the coherent dedispersion routine , squares it , and integrates it to a given number of samples .",
    "this intensity output is written to a file on the disk .",
    "+      the algorithm has been characterized by measuring the processing rate of the inverse transform and coherent dedispersion routines ( which perform the maximum amount of computation ) , as well as of the entire pipeline itself , as a function of the length of the dedispersion transform ( twice the number of samples corresponding to the dispersion time in the band ) .",
    "we have performed the tests by simulating random data for the voltage stream , storing it in the shared memory of the system in a structure identical to real - time observations , followed by processing the data with the routines described above .",
    "hence , these tests did not involve any disk access and are not i / o dominated .",
    "the lengths of the dedispersion transforms bench - marked are typical lengths of the transforms ( chosen to be powers of 2 ) that are required for the observing frequencies and bandwidths available at the gmrt .",
    "the rate has been expressed as a multiple of the real - time data acquisition rate and in terms of the number of gflops achieved in run - time .",
    "the rate of a routine must be higher than 1 to be able to process data in a real - time application .",
    "the number of gflops has been estimated by calculating the number of floating point operations for each of the two routines .",
    "for the inverse transform routine , this is given by : @xmath23 where n is the length of the original fft on the voltage time series and @xmath24 is the time in nanoseconds taken to compute the inverse transform . for the coherent dedispersion routine ,",
    "the same is given by : @xmath25 where n is the length of the long fft to be computed for coherent dedispersion and @xmath24 is the time taken in nanoseconds to perform the computations . here",
    "the the first term in the numerator corresponds to the computation for the forward and inverse ffts , while the second term comes from applying the complex phases to the @xmath26 frequency channels .",
    "@c@ + ( a ) relative processing rate for the 16mhz mode .",
    "@c@ + ( b ) relative processing rate for the 32 mhz mode .",
    "the results are shown in figures [ fig : cpu_rate ] and [ fig : cpu_perf ] .",
    "it is evident that the processing rate of the optimized cpu - based implementation is significantly below that required for a real - time application ( with the given computing resources ) .",
    "the performance of the full pipeline is limited by the slowest routine in the process , i.e. , coherent dedispersion , and hence the full pipeline performs at roughly the same rate as the coherent dedispersion routine .",
    "our benchmarks indicate that the full cpu - based pipeline performs 3.25 x slower ( on average ) than real - time data acquisition in the 16 mhz mode .",
    "consequently , we have reserved our cpu - based implementation exclusively for offline processing of data , and developed a real - time pipeline using a gpu - based implementation of the algorithm .",
    "we describe the working of the real - time pipeline in the next section .",
    "a real - time coherent dedispersion pipeline provides the ideal platform for harnessing the power of parallel computation on graphics processing units ( gpus ) . for the current implementation",
    ", we have used a nvidia tesla c2075 gpu , with 448 processor cores , each with a clock speed of 1.15 ghz , and a total internal memory of 6 gb , mounted on the same host machine as used for the cpu based implementation .",
    "we present below our implementation of a real - time gpu based coherent dedispersion pipeline , which has been optimized such that the most compute intensive portions of the algorithm are executed on the gpu .",
    "the routines for the gpu - based algorithm have been coded in c under the nvidia cuda^tm^ programming environment .",
    "our benchmarks of the cpu - based implementation clearly indicate that the coherent dedispersion routine is the slowest process in the pipeline , evidently due to the computation of the long fft . the cufft library ( @xcite ) , available with the cuda^tm^ platform , provides routines to compute ffts much faster than standard cpu - based fft libraries , using the computational power of hundreds of processor cores available on standard gpus .",
    "our tests ( explained later ) clearly demonstrate the improvement in the performance of the dedispersion process when using the cufft library . we have based our routines on the double precision floating point cufft routines since we found that the use of single precision resulted in clearly visible artifacts in the dedispersed time series .",
    "similar to the case of the cpu implementation , we believe that this is again due to the fact that the single precision floating point cufft routines produce increasingly inaccurate results when computing longer ffts , which are significantly larger than those produced by the double precision versions ( see @xcite ) .    as a demonstration of the artifacts observed",
    "when using the single precision fft routines ( both in the cpu - based fftw and the gpu - based cufft ) , we show in figure [ fig : floatvsdouble ] coherently dedispersed folded profiles from an observation of the pulsar b0329 + 54 at 325 mhz with the gmrt .",
    "figure [ fig : floatvsdouble](a ) shows the coherently dedispersed folded profile using the double precision mode of the pipeline , and is in good agreement with profiles published elsewhere ( @xcite ) .",
    "figure [ fig : floatvsdouble](b ) shows the same data coherently dedispersed in the single precision mode , where one clearly observes the additional artifacts produced in and around the main pulse region .",
    "c     +    \\(a ) folded profile produced from the double precision version of the coherent dedispersion pipeline .",
    "c     +    \\(b ) folded profile produced from the single precision version of the coherent dedispersion pipeline .",
    "the additional artifacts are clearly visible in the profile .",
    "the availability of thousands of threads on a gpu provides further opportunity to parallelize the dedispersion algorithm to improve its performance .",
    "the memory of the gpu and the host cpu are separate , unless one uses pinned memory on the host .",
    "a large amount of allocated pinned memory , however , degrades system performance since it leaves less memory available for paging .",
    "since the dedispersion process requires computation on a large amount of data at once , this data has to be transferred to the gpu memory from the host memory before any computation can be performed .",
    "memory transfers turn out to be relatively expensive as compared to kernel executions , and hence parallelizing memory transfers and kernel executions can improve the performance of an algorithm as compared to a serial implementation .",
    "cuda^tm^ allows for simultaneous memory transfers and kernel executions with the use of streams . for our algorithm",
    ", we have parallelized the memory transfers and kernel executions on the gpu such that at any iteration , there are 3 streams functioning on the gpu :    * transferring an already deconvolved block of data from the gpu memory to the host memory . * computing the long fft , applying the chirp function and then computing an inverse fft on the current data block to get deconvolved voltage data in gpu memory .",
    "the chirp function is applied by initializing a kernel which applies the chirp function to each frequency channel in parallel by calling the required number of threads .",
    "* asynchronously transferring the next data block to be processed from the host memory to gpu memory .",
    "the process is depicted in figure [ fig : gpu_streams ] for a sequence of 4 consecutive data blocks ( n point ffts ) .",
    "the real - time coherent dedispersion algorithm is similar to the cpu based algorithm , with the exception of the long ffts for the deconvolution being performed on the gpu to improve the processing rate of the pipeline .",
    "it operates on the following key principles :    * the entire process again logically divides into 3 different processes ( as described in section [ cpu_optimize ] ) , which can be run in parallel on a multi - processor system , but on consecutive blocks of data .",
    "the individual sections correspond to the inverse transform , coherent dedispersion and detection followed by writing to disk respectively . *",
    "as described in section [ gpu_optimize ] , the process handling the computation in the gpu can be further sub - divided into 3 parallel processes , handling data transfer and computation inside the gpu .",
    "this is done to reduce the overhead of memory transfers to and from the gpu .",
    "overall , this leads to a 5-way parallelism in the final algorithm . * transferring the coherent dedispersion process over to the gpu",
    "leaves a larger number of free threads in the cpu , which can be now used to speed up other processes in the pipeline .",
    "consequently , the inverse transform process now uses 4 threads instead of 2 as in the cpu based implementation , which leads to a significant improvement in the processing rates ( described below in section [ gpu_performance ] ) . * the configuration of threads assigned to different processes has been restructured to allow optimal performance in the real - time pipeline by balancing the computation load of different routines .",
    "as described below , the overall coherent dedispersion pipeline now uses only 6 of the 8 available threads , with the 2 free threads being left to accommodate 2 additional processes which are involved in real - time operations : the process writing the voltage beam data to shared memory , and the process synchronising the dedispersion process for the 2 polarisations of the beam ( on different systems ) via an mpi based routine .    in the voltage beam mode of the gsb ,",
    "the voltage data ( in the form of fft outputs from the original sampled voltage ) is written into a shared memory on two different systems , each receiving the voltage data for two polarisations and synchronized with an mpi based routine to allow one to combine the signals from the two polarisations after detection .",
    "the real - time algorithm is depicted in figure [ fig : realtime_algo ] .",
    "there are again 3 routines which run in parallel , and simultaneously handle different consecutive blocks of data , which are transferred via shared memory . in this case , with the availability of streams on the gpu , we have designed an algorithm with 5-way parallelism to reduce the overhead of memory transfers to and from the gpu .",
    "the voltage beam data is read directly from the shared memory on both the systems which are receiving the data .",
    "the pipeline runs by performing the following tasks in parallel ( the respective routine names are shown in bold ) :    1 .   *",
    "inverse transform * : ( using 4 cpu threads ) inverse fft on beam data for the i^th^ block , by splitting the data block into 4 sections and inverse transforming the 4 blocks in parallel .",
    "this allows the simultaneous utilisation of 4 threads on the cpu ( note that we could use only 2 threads for this process in the cpu - based implementation since the coherent dedispersion routine used up 4 threads ) to complete this task . the data is written to a shared memory double buffer .",
    "the use of the shared memory double buffer allows the next routine in the pipeline to read from one segment in the shared memory while the next block is still being written into the other segment simultaneously .",
    "* coherent dedispersion * : ( using 1 cpu thread ) 1 .   copy ( i-1)^th^ block from shared memory to gpu memory 2 .",
    "perform long fft on ( i-2)^th^ , apply chirp function and then produce dedispersed time series with appropriate overlap . for applying the chirp function , n/2 threads of a particular kernel ( corresponding to the choice of a particular taper function )",
    "are initialised , corresponding to each of the n/2 frequency channels produced by the forward fft in the gpu .",
    "3 .   copy ( i-3)^th^ block from gpu to host shared memory in a double buffer . + the use of this 3 way parallelism inside the gpu allows us to eliminate overheads of data transfer to and from the gpu , by simultaneously processing and copying different segments of data from the voltage beam . +",
    "the overlap - save method of computing convolutions requires one to reject a certain number of samples at the end of a given block , and overlap the same length with the previous block ( corresponding to the length of the impulse response ) .",
    "hence , with every input block of the long fft , one loses samples from the end of the block . to ensure continuity in the time series",
    ", we have implemented the gpu routine such that the number of samples lost in this process is then prefixed to the next block in the input data stream .",
    "write to disk * : ( using 1 cpu thread ) read deconvolved voltage data from the shared memory double buffer .",
    "square , integrate to certain number of samples , and write intensity to a disk .",
    "again , the use of the double buffer allows this detection routine to read from a shared memory segment simultaneously while the next segment is being written to by the gpu routine coherent dedispersion .",
    "the dspsr ( @xcite ) also uses some of the techniques we have used in our implementation , including the use of ring buffers in shared memory for real - time signal processing .",
    "further , the thread - safe input buffering technique in dspsr is similar to the technique we have used to account for the samples lost in the overlap - save method of computing convolutions .",
    "however , the process of initially inverse transforming the data is an additional task that is required for the gmrt voltage beam and has been a part of our implementation .",
    "further , since dspsr was designed primarily to handle larger bandwidths at higher frequencies , it uses the filter - bank scheme to split the full band into narrower bands on which coherent dedispersion is performed .",
    "since we have relatively smaller bandwidths to deal with at the gmrt , we do not use sub - banding which , in principle , allows us to achieve higher time resolutions .",
    "similar to the analysis done for the cpu based implementation described in section [ cpu_analysis ] , we have benchmarked the performance of our gpu - based real - time pipeline , using the same equations to measure the processing rates .",
    "the improvements clearly show up as a significant increase in the computation rate , and in the number of gflops achieved in run - time .",
    "the results are shown in figures [ fig : gpu_rate ] and [ fig : gpu_perf ] .    @c@ + ( a ) relative processing rate for the 16mhz mode .",
    "@c@ + ( b ) relative processing rate for the 32 mhz mode .",
    "the performance of the gpu - based pipeline shows improvements on a number of fronts as compared to the cpu based implementation .",
    "firstly , the processing rate of the inverse transform routine shows about a factor of 3 improvement in processing rate as compared to the cpu - based implementation ( and overall 3 times faster than real - time data acquisition rate in 32 mhz mode ) , both in time taken and the number of gflops achieved .",
    "though this routine still runs on the cpu , this marked improvement arises due to the routine now using 4 threads , instead of 2 in the cpu - only based implementation .",
    "the most compute intensive portion of the algorithm , i.e. the coherent dedispersion routine , shows a factor of about 9 improvement in processing rate ( and overall 1.5 times faster than real - time data acquisition rate in 32 mhz mode ) on the gpu , which was what we originally aimed to achieve by moving our implementation to a gpu .",
    "clearly , porting over the algorithm to a gpu has now allowed us to achieve better than real - time processing rates for the coherent dedispersion pipeline .",
    "our benchmarks indicate that the optimized full pipeline can perform coherent dedispersion 1.4 x faster ( on average ) than real - time data acquisition in the 32 mhz mode and 2.5 x faster ( on average ) than real - time data acquisition in the 16 mhz mode .",
    "the processing rate of the pipeline is thus well - suited for a real - time application , which has been subsequently verified in real - time tests .",
    "we present these results in the next section .",
    "the coherent dedispersion pipeline has been tested in real - time at the gmrt , running in parallel on two systems with identical specifications , each receiving one polarisation of the voltage beam data .",
    "we present here the first results obtained from the real - time pipeline . in figure [ fig:0329_realtime ]",
    "( a ) , the folded profile for the pulsar b0329 + 54 observed at 325 mhz with the real - time coherent dedispersion pipeline is shown .",
    "figure [ fig:0329_realtime ] ( b ) shows a sample single pulse from the same data set , exhibiting clear evidence for the occurence of micropulses .",
    "figure [ fig : realtime_2 ] shows folded profiles for the pulsars b0833 - 45 and b2016 + 28 ( zoomed into the on pulse region ) .",
    "the observations parameters are given in table [ test_table ] , and have also been mentioned in the figure captions .",
    "the folded profiles agree with the ones available in the databases provided in @xcite and @xcite .",
    "these tests and sample results show that the pipeline works stably , maintaining real - time performance without losing any blocks of data  segments of the voltage time series which are written as individual blocks in the shared memory by the gsb .",
    "if the pipeline does not process data fast enough , blocks of data would be lost in real - time analysis , leading to gaps in the observed time series .",
    "these gaps would show up as multiple pulse features at different phases in the folded profile , which is not the case .",
    "c     +    \\(a ) the folded profile of the pulsar b0329 + 54 .",
    "the profile has been zoomed into the on - pulse region .",
    "c     +    \\(b ) a single pulse from the data stream corresponding to the folded profile in ( a ) , clearly showing small time - scale structure in the pulse intensity .",
    "the figure has been zoomed into the region of the central component of the pulse in phase .",
    "p11 cm c     +    \\(a ) folded profile of the pulsar b0833 - 45 observed at 235 mhz with a bandwidth of 16 mhz for a duration of 5 minutes .",
    "the pulsar has a dm of 67.99 pc / cc and a period of 89.3 ms .",
    "owing to the high dm and low frequency of observation , the scattering tail is very prominent and extends throughout the profile .",
    "time resolution used is 30 @xmath27 .",
    "c     +    \\(b ) folded profile of the pulsar b2016 + 28 observed at 325 mhz with a bandwidth of 32 mhz for a duration of 15 minutes .",
    "the profile has been zoomed into the on - pulse region .",
    "the pulsar has a dm of 14.172 pc / cc and a period of 557.9 ms .",
    "time resolution used is 15 @xmath27 .",
    "currently , the range of dms for a given frequency of observation that can be dedispersed in real - time using our pipeline are limited only by the memory of the gpu . for the observing frequency of 610 mhz ,",
    "the highest dm that can be dedispersed is @xmath28 3000 pc / cc and @xmath28 750 pc / cc for the 16 mhz and 32 mhz modes respectively . for the observing frequency of 325 mhz , the corresponding maximum dms",
    "are @xmath28 480 pc / cc and @xmath28 120 pc / cc for the 16 mhz and 32 mhz modes respectively .     figure & observation frequency ( mhz ) & bandwidth ( mhz ) & pulsar name & pulsar period ( ms ) & dm ( pc / cc ) & duration of observation + [ 0.5ex ] 12 ( a ) & 325 & 32 & b0329 + 54 & 714.5 & 26.77 & 900 s + 12 ( b ) & 325 & 32 & b0329 + 54 & 714.5 & 26.77 & 19.8 ms + 13 ( a ) & 235 & 16 & b0833 - 45 & 89.3 & 67.99 & 300 s + 13 ( b ) & 325 & 32 & b2016 + 28 & 557.9 & 14.172 & 900 s +",
    "we have developed a real - time coherent dedispersion pipeline for the voltage beam mode of the gmrt using a gpu - based implementation of the algorithm .",
    "our benchmarks indicate that , using a tesla c2075 gpu , the pipeline is able to perform coherent dedispersion at better than real - time data acquisition rates for the currently available bandwidths at the gmrt , of 16 mhz and 32 mhz , by factors of approximately 2.5 & 1.4 , respectively .",
    "this real - time pipeline has been tested fairly extensively and is found to work reliably , without losing any data .",
    "a cpu based implementation of the pipeline has also been developed and released as an offline processing package , along with an offline version of the gpu - based implementation .",
    "the first results from the pipeline clearly demonstrate the potential of this system as a powerful tool for low frequency pulsar observations at the gmrt , covering aspects such as studies of pulsar microstructure , accurate profiles of millisecond pulsars at low radio frequencies and development of a high fidelity pulsar timing machine .",
    "our coherent dedispersion pipeline has some unique features as compared to existing coherent dedispersion systems ( described in section [ compare ] ) : firstly , our system works completely in real - time , without the requirement of recording data on disk ( as implemented in puma - ii ) .",
    "further , our system does not split the bandwidth of observation to reduce the computational load of the process , which allows one to achieve higher time resolutions than that obtainable by sub - banding .",
    "also , we have implemented the process with transform lengths much larger than the ones explored by other systems ( e.g. guppi ) , as the impulse response duration of the ism is much longer at the low frequencies our pipeline operates at .",
    "this is thus one of the first cases of the development of a real - time coherent dedispersion pipeline for a large , low frequency multi - element radio telescope like the gmrt .",
    "our current design , matched to the existing gmrt system , is easily extensible to a larger bandwidth system .",
    "in particular , we plan to extend the implementation of this pipeline to the gmrt wideband back - end ( gwb ) that is being developed for the upgraded gmrt .",
    "for the large bandwidths of operation of the gwb ( 100 , 200 and 400 mhz ) , recording full time resolution voltage data ( if possible at all ) will require a prohibitively large amount of disk storage space , even for relatively small duration observations .",
    "in such a case , a real - time pipeline for coherent dedispersion becomes a necessity , if one wants to fully exploit the wider bandwidths of the upgraded gmrt and make it an outstanding instrument to study pulsars at low frequencies .",
    "this should be fairly easy to do , as we show below .",
    "the computational complexity for implementing the real - time coherent dedispersion pipeline stems from two aspects : the first is that the length of the ffts involved in the deconvolution increases as @xmath29 ( where @xmath30 is the bandwidth of the observations ) , since both the sampling rate and dispersion time across the band increase approximately linearly with @xmath30 .",
    "this would amount to a factor of 100 times increase over that of the current gsb implementation , and one may run into memory size limitations on the gpu .",
    "this problem can be partially overcome by the trade - off of splitting the wideband into a few narrower sub - bands , the coherent dedispersions of each of which can fit within the memory constraints of the gpu , and then combining the coherently dedispersed signals from all the sub - bands to get a time resolution that is the inverse of the bandwidth of one sub - band .",
    "the second is the fact that even for a given length of the fft , the total computational load would go up as @xmath31 , implying a factor of approximately 30 increase in the required computation rate .",
    "since the current system is built on a relatively old gpu ( tesla c2075 ) , it should be possible to overcome both these challenges with the future generations of the gpus that are expected to become available in the near future , and thus implement a real - time coherent dedispersion system for the upgraded gmrt",
    ".    we would like to thank the staff members from ncra who have helped at various stages of this work .",
    "we acknowledge the support of the back - end team at the gmrt who have provided support for the computing infrastructure that was required for this work .",
    "we would particularly like to thank mr .",
    "s. s. kudale from the gmrt digital back - end team for useful inputs on the voltage - beam mode of the telescope .",
    "the gmrt is run by the national centre for radio astrophysics of the tata institute of fundamental research .",
    "+ * compliance with ethical standards * + the work was carried out as a part of the student training programme of the national centre for radio astrophysics ( ncra ) , pune , using equipment and facilities funded by ncra .",
    "kishalay de was visiting yashwant gupta at ncra , pune during the working period .",
    "kishalay de s participation in the project was supported by a fellowship from the kishore vaigyanik protsahan yojana ( kvpy ) scheme of the department of science and technology , government of india , which promotes research careers for undergraduate students .",
    "ait allal , d. , weber , r. , cognard , i. , desvignes , g. and theureau , g. , 2009 , _ rfi mitigation in the context of pulsar coherent dedispersion at the nancay radio astronomical observatory _",
    ", 17th european signal processing conference , glasgow , scotland .",
    "bhat , n. d. ramesh , cordes , james m. , camilo , fernando , nice , david j. and lorimer , duncan r. , 2004 , _ multifrequency observations of radio pulse broadening and constraints on interstellar electron density microstructure _ , the astrophysical journal , * 605 * , 759 - 783 .",
    "gupta , y. , gothoskar , p. , joshi , b. c. , vivekanand , m. , swain , r. , sirothia , s. and bhat , n. d. r. , 2000 , _ pulsar research with the gmrt : a status report _",
    ", pulsar astronomy - 2000 and beyond , asp conference series , proceedings of the 177th colloquium of the iau held in bonn , germany , * 202 * , 277 .",
    "karuppusamy , ramesh , stappers , m. , and van straten , w. , 2008 , _ puma - ii : a wide band pulsar machine for the westerbork synthesis radio telescope _ , publications of the astronomical society of the pacific , * 120 * , 191 - 202 .",
    "swarup , g. , ananthakrishnan , s. , subrahmanya , c. r. , rao , a. p. , kulkarni , v. k. and kapahi , v. k. , 1997 , _ the giant metrewave radio telescope _ ,",
    "high - sensitivity radio astronomy , proceedings of a meeting held at jodrell bank , university of manchester , january 22 - 26 , 1996 , 217 .",
    "whitney , alan , booler , t. , bowman , j. , emrich , d. , goeke , b. and remillard , r. , 2011 , _ the murchison widefield array ( mwa ) : current status and plans _ , bulletin of the american astronomical society , * 43*."
  ],
  "abstract_text": [
    "<S> a fully real - time coherent dedispersion system has been developed for the pulsar back - end at the giant metrewave radio telescope ( gmrt ) . </S>",
    "<S> the dedispersion pipeline uses the single phased array voltage beam produced by the existing gmrt software back - end ( gsb ) to produce coherently dedispersed intensity output in real time , for the currently operational bandwidths of 16 mhz and 32 mhz . </S>",
    "<S> provision has also been made to coherently dedisperse voltage beam data from observations recorded on disk .    </S>",
    "<S> we discuss the design and implementation of the real - time coherent dedispersion system , describing the steps carried out to optimise the performance of the pipeline . </S>",
    "<S> presently functioning on an intel xeon x5550 cpu equipped with a nvidia tesla c2075 gpu , the pipeline allows dispersion free , high time resolution data to be obtained in real - time . </S>",
    "<S> we illustrate the significant improvements over the existing incoherent dedispersion system at the gmrt , and present some preliminary results obtained from studies of pulsars using this system , demonstrating its potential as a useful tool for low frequency pulsar observations .    </S>",
    "<S> we describe the salient features of our implementation , comparing it with other recently developed real - time coherent dedispersion systems . </S>",
    "<S> this implementation of a real - time coherent dedispersion pipeline for a large , low frequency array instrument like the gmrt , will enable long - term observing programs using coherent dedispersion to be carried out routinely at the observatory . </S>",
    "<S> we also outline the possible improvements for such a pipeline , including prospects for the upgraded gmrt which will have bandwidths about ten times larger than at present . </S>"
  ]
}