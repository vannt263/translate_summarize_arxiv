{
  "article_text": [
    "the concept of physical layer network coding has attracted a lot of attention in recent times .",
    "the idea of physical layer network coding for the two way relay channel was first introduced in @xcite , where the multiple access interference occurring at the relay was exploited so that the communication between the end nodes can be done using a two stage protocol .",
    "information theoretic studies for the physical layer network coding scenario were reported in @xcite , @xcite .",
    "the design principles governing the choice of modulation schemes to be used at the nodes for uncoded transmission were studied in @xcite .",
    "an extension for the case when the nodes use convolutional codes was done in @xcite . a multi - level coding scheme for the two - way relaying was proposed in @xcite .",
    "+ we consider the two - way wireless relaying scenario shown in fig .",
    "1 , where two - way data transfer takes place among the nodes a and b with the help of the relay r. it is assumed that the two nodes operate in half - duplex mode , i.e. , they can not transmit and receive at the same time in the same frequency band .",
    "the relaying protocol consists of two phases , _ multiple access _ ( ma )",
    "phase , consisting of two channel uses during which a and b transmit to r twice , two independent messages in the two channel uses , with points from 4-psk constellation , and _ broadcast _ ( bc ) phase , in which r transmits to a and b. the relay node r accumulates the information sent by the user nodes in the first and second channel use of the ma phase , and transmits in the bc phase a message that contains information about all the four messages received by it in the ma phase .",
    "network coding is employed at r in such a way that a(/b ) can decode the two messages transmitted by b(/a ) , given that a(/b ) knows its own messages .",
    "we call this strategy accumulate - compute and forward ( acf ) protocol .",
    "+ it was observed in @xcite and @xcite for 4-psk , that for uncoded transmission , the network coding map used at the relay needs to be changed adaptively according to the channel fade coefficient , in order to minimize the impact of multiple access interference . in other words ,",
    "the set of all possible channel realizations is quantized into a finite number of regions , with a specific network coding map giving the best performance in a particular region .",
    "it is shown in @xcite for any choice of signal sets of equal cardinality used at the two users , that every such network coding map that satisfies the _ exclusive law _ is representable as a latin square and conversely , this relationship can be used to get the network coding maps satisfying the exclusive law .",
    "+    a latin square of order @xmath0 is an @xmath1 array in which each cell contains a symbol from a set of t different symbols such that each symbol occurs at most once in each row and column @xcite .",
    "+        similar to the acf protocol , a store - and - forward protocol has been earlier studied in @xcite , for the two - way relaying channel . in @xcite ,",
    "the authors derive an upper bound on the ergodic sum - capacity for the two - way relaying scenario when delay tends to infinity , and propose two alternative awaiting and broadcast ( aab ) schemes which approach the new upper bound at high snr . using numerical results ,",
    "they show that the proposed aab schemes significantly outperforms the traditional physical layer network coding methods without delay in terms of ergodic maximum sum rates .",
    "however , modulation and physical layer network coding have not been addressed in @xcite .",
    "+        the remaining content is organized as follows : section ii discusses the basic concepts , definitions and a summary of the contributions of this paper .",
    "section iii demonstrates the network code obtained using cartesian product that is utilized at the relay for two - way acf relaying which removes the fade states associated with the channels . in section iv",
    ", we show how this network code can be obtained using singularity removal constraints .",
    "section v gives results based on structural properties of latin squares .",
    "in section vi the complex plane is quantized depending on which one of the obtained latin squares maximizes the minimum cluster distance and section vii gives the simulation results that demonstrate the improvement in the performance using the suggested scheme .",
    "section viii concludes the paper .",
    "let @xmath2 denote the symmetric 4-psk constellation @xmath3 as shown in fig . 2 , used at a and b. assume that a(/b ) wants to send two 2-bit binary tuples to b(/a ) .",
    "let @xmath4 denote the mapping from bits to complex symbols used at a and b where @xmath5 .",
    "let @xmath6 denote the complex symbols transmitted by a and b at the first channel use respectively , and @xmath7 denote the complex symbols transmitted by a and b at the second channel use respectively , where @xmath8 + _ multiple access ( ma ) phase : _ + it is assumed that the channel state information is not available at the transmitting nodes a and b during the ma phase .",
    "the received signal at r at first channel use is given by @xmath9 and the received signal at r at the second channel use , @xmath10 where @xmath11 and @xmath12 are the fading coefficients associated with the a - r and b - r link respectively .",
    "note that we are taking @xmath11 and @xmath12 to be the same for the two channel uses .",
    "the additive noise @xmath13 and @xmath14 are assumed to be @xmath15 , where @xmath15 denotes the circularly symmetric complex gaussian random variable with variance @xmath16 .",
    "we assume a block fading scenario , with @xmath17 , where @xmath18 and @xmath19 , is referred to as the _ fade state _ for the first and second transmission by a and b at the first and second channel use , and for simplicity can also be denoted by @xmath20 .",
    "also , it is assumed that @xmath21 is distributed according to a continuous probability distribution .",
    "+    @xmath22    let @xmath23 denote the effective constellation seen at the relay during the ma phase , i.e. , @xmath24 the effective constellation remains the same over the two channel uses , since we assume @xmath11 and @xmath12 and hence the ratio @xmath25 to be the same during the two channel uses .",
    "+ let @xmath26 denote the minimum distance between the points in the constellation @xmath27 during ma phase , as given by ( [ dist ] ) on the next page . from ( [ dist ] ) ,",
    "it is clear that there exist values of @xmath28 , for which @xmath29 .",
    "let , @xmath30 the elements of @xmath31 are called singular fade states . for singular fade states , @xmath32 +    a fade state @xmath28 is defined to be a _ singular fade state _ for the _ acf two - way relaying _ , if the cardinality of the signal set @xmath23 is less than @xmath33 .",
    "let @xmath34 denote the set of singular fade states for the two - way acf relaying .",
    "+    let @xmath35 denote the maximum likelihood ( ml ) estimate of @xmath36 at r based on the received complex numbers @xmath37 and @xmath38 at the two channel uses , as given in ( [ mle ] ) .",
    "+ _ broadcast ( bc ) phase : _",
    "+ depending on the value of @xmath28 , r chooses a map @xmath39 where @xmath40 is a complex signal set of size between @xmath41 and @xmath33 used by r during the _ bc _ phase . + the received signals at a and b during the bc phase are respectively given by , @xmath42    where @xmath43 is the complex number transmitted by r. the fading coefficients corresponding to the r - a and r - b links are given by @xmath44 and @xmath45 respectively and the additive noises @xmath46 and @xmath47 are @xmath48 .",
    "+ the elements in @xmath49 which are mapped to the same signal point in @xmath50 by the map @xmath51 are said to form a cluster .",
    "let @xmath52 denote the set of all such clusters .",
    "the formation of clusters is called clustering , denoted by @xmath53 . + in order to ensure that a(/b ) is able to decode bs(/a s ) messages , the clustering @xmath53 should satisfy the exclusive law , as given in ( [ mel1 ] ) , ( [ mel2 ] ) above .",
    "+    the cluster distance between a pair of clusters @xmath54 and @xmath55 is the minimum among all the distances calculated between the points @xmath56 and @xmath57 in the effective constellation used by the relay node r , as given in above .",
    "+    the _ minimum cluster distance _ of the clustering @xmath53 is the minimum among all the cluster distances , as given in above .",
    "+    the minimum cluster distance determines the performance during the ma phase of relaying .",
    "the performance during the bc phase is determined by the minimum distance of the signal set @xmath40 . for values of @xmath58 in the neighborhood of the singular fade states ,",
    "the value of @xmath59 is greatly reduced , a phenomenon referred to as _ distance shortening _ [ 4 ] . to avoid distance shortening , for each singular fade state",
    ", a clustering needs to be chosen such that the minimum cluster distance is non zero . +",
    "a clustering @xmath60 is said to remove singular fade state @xmath61 if @xmath62 . for a singular fade state @xmath63 ,",
    "let @xmath64 denote the clustering which removes the singular fade state @xmath65 ( if there are multiple clusterings which remove the same singular fade state @xmath65 , choose any of the clusterings ) .",
    "let @xmath66 denote the set of all such clusterings .",
    "+    the minimum cluster distance of the clustering @xmath67 at the fade state @xmath28 which is not necessarily a singular fade state , denoted by @xmath68 , is as given in ( [ cl3 ] ) .",
    "note that if @xmath69 @xmath70 reduces to @xmath71 given in .    in general , the channel fade state @xmath28",
    "need not be a singular fade state .",
    "in such a scenario , among all the clusterings which remove the singular fade states , the one which has the maximum value of the minimum cluster distance at @xmath72 is chosen by the relay r. in other words , for @xmath73 the clustering @xmath74 is chosen to be @xmath75 by the relay r , which satisfies @xmath76 since the clusterings which remove the singular fade states are known to all the three nodes and are finite in number , the clustering used for a particular realization of the fade state can be indicated by r to a and b using overhead bits .    in @xcite ,",
    "such clusterings that remove singular fade states for two - way 2-stage relaying scenario were obtained with the help of latin squares .",
    "+ the contributions of this paper are as follows :    * it is shown that if the users a and b transmit points from the same 4-psk constellation , the clusterings proposed in @xcite for two user case can be utilized to get clusterings for this case for removing the singular fade states containing either 16 or 25 points by introducing the notion of cartesian product of clusters .",
    "in other words , the @xmath77 latin squares representing the acf relaying can be obtained with the help of @xmath78 latin squares representing the clusterings for two - way 2-stage relaying as given in @xcite . *",
    "another clustering is proposed for the acf protocol in the two - way relay channel called direct clustering .",
    "this clustering also removes the singular fade states and reduces the number of clusters for some cases . using this clustering ,",
    "the size of the resulting constellation used by the relay node r in the bc phase is reduced to 20 for a category of cases , as compared to the cartesian product approach which results in the constellation size being 25 for these cases . *",
    "the quantization of the complex plane that contains all the possible fade states , depending on which one of the obtained clusterings maximizes the minimum cluster distance , is proven to be the same as for the two - way 2-stage relaying scenario as done in @xcite .",
    "* simulation results indicate that at high snr , the schemes based on the acf protocol performs better than the schemes proposed in @xcite,@xcite based on two - stage two way relaying . with 4-psk signal set used at the end nodes ,",
    "the acf protocol achieves a maximum sum throughput of 8/3 bits / s / hz , whereas it is 2 bits / s / hz for the schemes based on 2-stage two way relaying .",
    "the nodes a and b transmit symbols from the same constellation , viz . , 4-psk .",
    "our aim is to find the map that the relay node r should use in order to cluster the @xmath79 possibilities of @xmath80 such that the exclusive law given by ( [ mel1 ] ) , ( [ mel2 ] ) is satisfied .",
    "consider the @xmath77 array consisting of the 16 possibilities of @xmath81 along the rows and the 16 possibilities of @xmath82 along the columns .",
    "we fill this array with elements from @xmath83 where each symbol denotes a unique cluster .",
    "the constellation size used by the relay in the bc phase , or the number of clusters has to be at least 16 , since each user needs 4 bit information corresponding to the two messages sent by the other user implying @xmath84 . in order to keep ( [ mel1 ] ) and ( [ mel2 ] ) satisfied , a symbol from @xmath85 can occur at most once in each row and column .",
    "so the @xmath77 array having @xmath81 along the rows and @xmath82 along the columns must be a latin square of side 16 ( definition 1 ) .",
    "the equivalence between the network code used by the relay in two - way relaying scenario and latin squares has been previously discussed in [ 7 ] .",
    "the clusters are obtained by putting together all those @xmath80 for which the corresponding entry @xmath86 in the array is the same .",
    "+ from above , we can say that all the relay clusterings that satisfy the mutually exclusive law forms latin squares of order 16 with entries from @xmath85 with @xmath84 , when the end nodes use psk constellations of size 4 .",
    "it therefore suffices to consider the network code used by the relay node in the bc phase to be a @xmath77 array with rows(/columns ) indexed by the 2-tuple consisting of the symbols sent by a(/b ) during the first and second channel use .",
    "the cells of the array must be filled with elements of @xmath85 in such a way , that the resulting array is a latin square of order 16 and @xmath84 .",
    "+ _ * removing singular fade states and constrained latin squares * _    the relay can manage with constellations of size 16 in bc phase , but it is observed that in some cases relay may not be able to remove the singular fade states and results in severe performance degradation in the ma phase . as stated in section ii , that a clustering @xmath75 is said to remove singular fade state @xmath61 if @xmath62 . removing singular fade states for a two - way acf relay channel can also be defined as follows : +    a clustering @xmath75 is said to _ remove the singular fade state _ @xmath87 , if any two possibilities of the messages sent by the users @xmath88 that satisfy + @xmath89 are placed together in the same cluster by @xmath75 .",
    "+    a set @xmath90 consisting of all the possibilities of @xmath91 that must be placed in the same cluster of the clustering used at relay node r in the bc phase in order to remove the singular fade state @xmath65 is referred to as a _ singularity removal constraint _ for the singular fade state @xmath65 in two - way acf relaying scenario .",
    "+    as given in @xcite , a complex number @xmath28 is defined to be a _ singular fade state _ for the _ two - way 2-stage relaying scenario _ , if @xmath92 and the set @xmath93 consisting of all the possibilities of @xmath94 that must be placed in the same cluster of the clustering that removes the fade state @xmath28 for the two - way 2-stage relaying scenario is the corresponding set of singularity removal constraint for the singular fade state @xmath28 .",
    "as we show in the following lemma , the singular fade state for the acf two - way relaying are the same as the singular fade state for the two - way 2-stage relaying scenario .",
    "+    the singular fade states for the acf two - way relaying scenario are the same as the 12 singular fade states for two - way 2-stage relaying scenario as computed in @xcite .",
    "let @xmath28 be a singular fade state for the acf two - way relaying scenario . by definition , @xmath95 such that , @xmath96 where @xmath97 .",
    "+ then , by definition , @xmath28 must be a singular fade state for two - user 2-stage relaying .",
    "+ conversely , let @xmath28 be a singular fade state for two - user 2-stage relaying scenario . then , @xmath98 such that , @xmath99 then , since for any @xmath100 is a subset of a singularity removal constraint and @xmath28 is a singular fade state for the acf two - way relaying scenario .",
    "+ thus , the singular fade states for the acf two - way relaying scenario and the singular fade states for the two - way 2-stage relaying scenario are the same .",
    "let @xmath28 be a fade state for the two - way acf relaying scenario .",
    "then @xmath28 can be viewed as a fade state for the first and second channel use in the ma phase as shown in lemma 1 . in @xcite and @xcite",
    ", it is shown that for the two - way 2-stage relaying , the @xmath41 possible pairs of symbols from 4-psk constellation sent by the two users in the ma phase , can be clustered into a clustering dependent on a singular fade coefficient , of size 4 or 5 in a manner so as to remove this singular fade coefficient . in the case of two - way acf relaying , at the end of ma phase",
    ", relay receives two complex numbers , given by ( [ yr1 ] ) and ( [ yr2 ] ) . instead of r transmitting a point from the @xmath33 point constellation resulting from all the possibilities of @xmath101",
    "the relay r can choose to group these possibilities into clusters represented by a smaller constellation .",
    "one such clustering for the case when @xmath102 can be obtained by utilizing the clustering provided in [ 7 ] for the two - way 2-stage problem in order to remove this fade state .",
    "let @xmath103}$ ] denote the clustering for the physical network coded two - way relaying scenario that removes the singular fade state @xmath104 for the two - way 2-stage relaying case as given in [ 7 ] .",
    "+    we define the _ cartesian product _ of a clustering @xmath103}=\\left\\{l_{1 } , l_{2}, ... ,l_{m}\\right\\}$ ] with itself denoted by @xmath105}$ ] , where for @xmath106 ; @xmath107 with @xmath108 as follows : @xmath109}=\\left\\{\\mathcal{c}^{\\left\\{l_{1},l_{1}\\right\\}}, ... ,\\mathcal{c}^{\\left\\{l_{1},l_{m}\\right\\}}, ... ,\\mathcal{c}^{\\left\\{l_{m},l_{1}\\right\\}}, ...",
    ",\\mathcal{c}^{\\left\\{l_{m},l_{m}\\right\\ } } \\right\\}\\ ] ] where , @xmath110    let @xmath111 .",
    "the clustering obtained by taking the cartesian product @xmath112}$ ] of @xmath113}$ ] with itself removes the singular fade state @xmath28 for the two - way acf relaying scenario .",
    "let @xmath113}=\\left\\{l_1 , l_2, ... ,l_m\\right\\}$],where for @xmath106 , @xmath114 then ,",
    ",\\mathcal{c}^{\\left\\{l_{1},l_{m}\\right\\}}, ... ,\\mathcal{c}^{\\left\\{l_{m},l_{1}\\right\\}}, ...",
    ",\\mathcal{c}^{\\left\\{l_{m},l_{m}\\right\\ } } \\right\\}\\ ] ] where , @xmath116 by definition , a singularity removal constraint for the fade state @xmath28 in the case of two - way acf relaying scenario is a set @xmath117 such that @xmath118 , @xmath119    now , @xmath120 must belong to the same cluster , say @xmath121 in @xmath113}$ ] for it to remove the fade state @xmath28 .",
    "similarly , @xmath122 must belong to the same cluster , say @xmath123 in @xmath113}$ ] .",
    "this holds @xmath118 .",
    "thus , the singularity removal constraint is ,     @xmath124 for some @xmath125",
    ". therefore , the clustering @xmath112}$ ] removes the singular fade state @xmath28 .",
    "it was studied in [ 4 ] by computer search , and then in [ 7 ] analytically , that there are 12 possible singular fade states in the complex plane for the case when two users transmit points from 4-psk constellation in the ma phase . out of these 12 fade states ,",
    "4 lie on the unit circle , 4 lie on a circle of radius @xmath126 and 4 lie on a circle of radius 1/@xmath126 .",
    "the size of the constellation used at r in the bc phase for these cases is either 4 or 5 .",
    "for the two - user acf scenario we are dealing with , we have two channel uses in the ma phase , with a and b transmitting a message each in the first channel and second channel uses , with the two messages sent by each user in the first and second channel use being possibly different . keeping in mind the three classes of fade states depending on the radius of the circle it lies on , we consider the following three cases : +   + _ case 1 : _ @xmath102 lies on the unit circle .",
    "+   + _ case 2 : _",
    "@xmath102 lies on the circle of radius @xmath127 .",
    "+   + _ case 3 : _ @xmath102 lies on the circle of radius @xmath128 .",
    "+   + * _ case 1 : _ @xmath102 lies on the unit circle . *",
    "+ since both user nodes a and b require @xmath129 bits of information from the other user , the size of the constellation that r uses will be at least @xmath130 .",
    "the cartesian product of @xmath113}$ ] with itself consists of @xmath131 clusters since the clustering @xmath113}$ ] has @xmath129 clusters .",
    "we illustrate this case with the help of the following example , the remaining instances of fade states that lie on the unit circle can be obtained using this example , as we show in lemma 6 in section v. +    let the fade state @xmath132 .",
    "the clustering @xmath133}$ ] for the case as given in @xcite is given by , @xmath134}=&\\left\\{l_{1},l_{2},l_{3},l_{4}\\right\\ }   \\nonumber \\text{where,}\\\\ \\nonumber & l_{1}=\\left\\{\\left(0,0\\right),\\left(1,2\\right),\\left(2,1\\right),\\left(3,3\\right)\\right\\}\\\\ \\nonumber & l_{2}=\\left\\{\\left(0,3\\right),\\left(1,1\\right),\\left(2,2\\right),\\left(3,0\\right)\\right\\}\\\\ \\nonumber & l_{3}=\\left\\{\\left(0,1\\right),\\left(1,3\\right),\\left(2,0\\right),\\left(3,2\\right)\\right\\}\\\\ \\nonumber & l_{4}=\\left\\{\\left(0,2\\right),\\left(1,0\\right),\\left(2,3\\right),\\left(3,1\\right)\\right\\}. \\vspace{-0.8 cm } \\nonumber\\end{aligned}\\ ] ] the cartesian product of the above clustering given by @xmath135}=\\left\\ { \\mathcal{c}^{\\left\\{l_{i},l_{j}\\right\\}}~ |~ i , j=1,2,3,4\\right\\}$ ] contains exactly @xmath131 clusters : @xmath136 @xmath137    the entries of the above clusters are of the form @xmath138 , i.e. , in the order a s transmission during the first channel use , b s transmission during the first channel use , a s transmission during the second channel use , b s transmission during the second channel use .",
    "we now represent these clusters by a latin square of side @xmath131 , with @xmath139 along the rows , and @xmath140 along the columns .",
    "the @xmath141 entry of the latin square as dictated by the clusters above are as follows :    @xmath142 @xmath143 @xmath144 @xmath145 @xmath146 @xmath147 @xmath148 @xmath149 @xmath150 @xmath151 @xmath152 @xmath153 @xmath154 @xmath155 @xmath156 @xmath157    the resulting latin square representing the clusters denoted by say @xmath158 , is shown in fig .",
    "this @xmath77 array @xmath158 can be divided into 16 blocks of @xmath78 arrays .",
    "let @xmath159 $ ] where each @xmath160 is a @xmath161 array for @xmath162 as shown in fig .",
    "each @xmath160 is in one - to - one correspondence with the latin square obtained in @xcite for removing the singular fade state @xmath163 for the two - way 2-stage relaying scenario representing the clustering @xmath133}$ ] given in fig [ l1 ] . also let , @xmath164 this makes @xmath165 of the form shown in fig .",
    "[ fig : l_b ] .",
    "this makes the block matrix @xmath165 also consistent with the latin square given in fig .",
    "4 . the reason behind @xmath165 and @xmath160 being consistent with this latin square is as follows : each @xmath160 corresponds to some fixed values of the symbols a and b send during the first channel use , with the symbols sent by a and b during second channel use varying along the rows and columns respectively . the latin",
    "square in fig .",
    "3 has been obtained by taking the cartesian product of the clustering for removing the fade state @xmath163 with itself .",
    "the cartesian product utilizes the clustering that is represented by the latin square given in fig .",
    "4 , given by @xmath166}$ ] , for the case for both the first and second channel use in the ma phase , which makes each @xmath167 and @xmath165 in one - to - one correspondence with this latin square that represents the clustering @xmath133}$ ] . +    * _ case 2 : _",
    "@xmath102 lies on the circle of radius @xmath127 . *",
    "+ in this case , the cartesian product of @xmath113}$ ] with itself consists of @xmath168 clusters since the clustering @xmath113}$ ] has @xmath169 clusters .",
    "we now give an example of this case .",
    "the remaining instances of this case can be obtained from this example as will be shown later in section v , lemma 6 .",
    "+    consider the case when @xmath170 the clustering @xmath171}$ ] given in @xcite that removes this fade state for the two - way 2-stage relaying scenario is given by : @xmath172}=&\\left\\{l_1,l_2,l_3,l_4,l_5\\right\\},\\\\ \\text{where,}\\\\ \\nonumber & l_{1}=\\left\\{\\left(0,1\\right),\\left(1,2\\right),\\left(2,3\\right)\\right\\}\\\\ \\nonumber & l_{2}=\\left\\{\\left(0,2\\right),\\left(1,3\\right),\\left(3,0\\right)\\right\\}\\\\ \\nonumber & l_{3}=\\left\\{\\left(0,3\\right),\\left(2,0\\right),\\left(3,1\\right)\\right\\}\\\\ \\nonumber & l_{4}=\\left\\{\\left(1,0\\right),\\left(2,1\\right),\\left(3,2\\right)\\right\\}\\\\ \\nonumber & l_{5}=\\left\\{\\left(0,0\\right),\\left(1,1\\right),\\left(2,2\\right),\\left(3,3\\right)\\right\\}. \\nonumber\\end{aligned}\\ ] ]    the cartesian product of the above clustering given by @xmath173}=\\left\\ { \\mathcal{c}^{\\left\\{l_{i},l_{j}\\right\\}}~ |~ i , j=1,2,3,4,5\\right\\}$ ] contains exactly @xmath168 clusters .",
    "the clusters and the corresponding constraints for the latin square representing the clustering have been listed in the appendix a. the cartesian product of the clustering @xmath171}$ ] with itself , denoted by @xmath173}$ ] can be represented by the latin square given in fig .",
    "+    ! width 1ptc!width",
    "1ptc|c|c|c!width 1pt & @xmath174&@xmath175&@xmath176&@xmath177 + @xmath174 & @xmath178 & @xmath179 & @xmath180 & @xmath181 + @xmath175 & @xmath182 & @xmath178 & @xmath179 & @xmath180 + @xmath176 & @xmath181 & @xmath182 & @xmath178 & @xmath179 + @xmath177 & @xmath180 & @xmath181 & @xmath182 & @xmath178 +    as explained in the previous example , let the @xmath77 latin square obtained as shown in fig .",
    "5 be denoted by say @xmath183 and @xmath184 $ ] with @xmath162 .",
    "then both @xmath185 and @xmath186 must be consistent with the latin square of side @xmath129 given in fig .",
    "6 , denoted by @xmath187 , which represents the clustering @xmath171}$ ] . as can be seen in fig . 5 ,",
    "@xmath187 is repeated in each block @xmath186 with a possibly different set of five symbols amongst @xmath188 denoting the five symbols @xmath189 in each @xmath186 .",
    "more precisely , the blocks @xmath190 are the same as @xmath187 , with the symbols @xmath191 replacing the symbols @xmath192 respectively . similarly , the blocks @xmath193 are the same as @xmath187 with symbols @xmath194 replacing the symbols @xmath192 respectively , the blocks @xmath195 are the same as @xmath187 with symbols @xmath196 replacing the symbols @xmath192 respectively , the blocks @xmath197 are the same as @xmath187 with symbols @xmath198 replacing the symbols @xmath192 respectively , and the blocks @xmath199 are the same as @xmath187 with symbols @xmath200 replacing the symbols @xmath192 respectively .",
    "thus , the array @xmath183 can be obtained using @xmath187 by simply using a different set of five symbols to denote @xmath201 for every set of blocks corresponding to a symbol amongst @xmath201 in @xmath187 .",
    "we will illustrate this in the next example by obtaining the @xmath77 latin square using the @xmath161 latin square given in @xcite for the case .",
    "+    * _ case 3 : _ @xmath102 lies on the circle of radius @xmath128 . * + in this case , the cartesian product of @xmath113}$ ] with itself consists of @xmath168 clusters since the clustering @xmath113}$ ] has @xmath169 clusters .",
    "an instance of this case is as follows .",
    "+    consider the case when @xmath202 the clustering @xmath203}$ ] given in @xcite that removes this fade state for the two - way 2-stage relaying scenario is given by : @xmath204}=&\\left\\{l_{1},l_{2},l_{3},l_{4},l_{5}\\right\\ } \\\\",
    "\\nonumber \\text{where,}\\\\ \\nonumber & l_{1}=\\left\\{\\left(0,1\\right),\\left(2,3\\right),\\left(3,0\\right)\\right\\}\\\\ \\nonumber & l_{2}=\\left\\{\\left(0,3\\right),\\left(1,0\\right),\\left(3,2\\right)\\right\\}\\\\ \\nonumber & l_{3}=\\left\\{\\left(1,2\\right),\\left(2,0\\right),\\left(3,1\\right)\\right\\}\\\\ \\nonumber & l_{4}=\\left\\{\\left(0,2\\right),\\left(1,3\\right),\\left(2,1\\right)\\right\\}\\\\ \\nonumber & l_{5}=\\left\\{\\left(0,0\\right),\\left(1,1\\right),\\left(2,2\\right),\\left(3,3\\right)\\right\\}. \\nonumber\\end{aligned}\\ ] ]    this clustering can be represented by a latin square of side @xmath129 denoted by @xmath205 as shown in fig .",
    "+    ! width 1ptc!width",
    "1ptc|c|c|c!width 1pt & @xmath174&@xmath175&@xmath176&@xmath177 + @xmath174 & @xmath178 & @xmath179 & @xmath182 & @xmath180 + @xmath175 & @xmath180 & @xmath178 & @xmath181 & @xmath182 + @xmath176 & @xmath181 & @xmath182 & @xmath178 & @xmath179 + @xmath177 & @xmath179 & @xmath181 & @xmath180 & @xmath178 +    the cartesian product of the above clustering given by @xmath206}=\\left\\ { \\mathcal{c}^{\\left\\{l_{i},l_{j}\\right\\}}~ |~ i , j=1,2,3,4,5\\right\\}$ ] contains exactly @xmath168 clusters as given in the appendix b. we represent these clusters by a latin square of side @xmath131 , with @xmath139 along the rows , and @xmath140 along the columns .",
    "the @xmath141 entry of the latin square as dictated by the clusters above are also listed in the appendix b. let the @xmath77 latin square that represents the clustering obtained as a cartesian product of @xmath203}$ ] with itself be denoted by say @xmath207 , and @xmath208 $ ] with @xmath162",
    ". then each of @xmath209 and @xmath210 must be consistent with the latin square of side @xmath129 given in fig .",
    "8 which represents the clustering @xmath203}$ ] .",
    "we denote @xmath211 in @xmath212 by @xmath213 , in @xmath214 by @xmath215 , in blocks @xmath216 by @xmath217 , in blocks @xmath218 by @xmath219 and in blocks @xmath220 by @xmath221 . placing these blocks in accordance with @xmath205 , the cartesian product of the clustering @xmath203}$ ] with itself , denoted by @xmath206}$ ]",
    "can be represented by the latin square given in fig .",
    "+ the latin square which removes the singular fade state @xmath222 can be obtained by taking the transpose of the latin square which removes the singular fade state @xmath223 .",
    "for example , the latin square which removes the singular fade state @xmath224 can also be obtained by taking the transpose of the latin square which removes the singular fade state @xmath225 the reason for this is as follows : the case when the singular fade state is @xmath222 can be equivalently viewed as the case when the singular fade states is @xmath223 with the users a and b interchanged .",
    "interchanging the users is equivalent to taking transpose of the latin square .",
    "in this section , we deal with any @xmath226-psk constellation . in @xcite , it was shown that the singular fade states for the two - way 2-stage relaying scenario lie on circles centered at the origin . from lemma 1 ,",
    "since the singular fade states for the acf two - way relaying scenario are the same as that of the two - way 2-stage relaying scenario , it follows that the singular fade states for the acf two - way relaying scenario lie on circles centered at the origin as well . in this section",
    ", it is shown that for each circle , it is enough if we obtain one latin square which removes a singular fade state on that circle .",
    "the latin squares which remove the other singular fade states on that circle can be obtained by some elementary operations on the latin square , which are described in the sequel .",
    "+ for a latin square @xmath158 of order @xmath227 , let @xmath228 denote the latin sub - square of order @xmath229 obtained by taking only the rows @xmath230 to @xmath231 and only the columns @xmath232 to @xmath233 of @xmath158 .",
    "for example , in fig .",
    "[ latin_subsquare_ex ] , the latin sub - squares @xmath234 of order 2 corresponding to the latin square @xmath158 of order 4 are shown .",
    "let @xmath165 denote the square of order @xmath235 , associated with the latin square @xmath158 of order @xmath227 , with @xmath236 as its entries .",
    "for example the square @xmath165 of order 2 associated to a latin square @xmath158 of order 4 is as shown in fig .",
    "[ l_b_example ] .",
    "+    s from the latin square @xmath158.,width=240 ]     order 2 corresponding to a latin square @xmath158 of order 4.,width=96 ]    consider the two - way acf relaying with @xmath235-psk signal set used at nodes a and b. the latin square @xmath207 of order @xmath227 which removes the singular fade state @xmath237 , can be obtained from the latin square @xmath158 of order @xmath227 which removes the singular fade state @xmath238 , where @xmath239 , as follows : cyclic shift the columns of each one the @xmath227 latin squares @xmath228 @xmath240 times to the left to get the latin square @xmath183 .",
    "cyclic shift the columns of the square @xmath185 associated with @xmath183 , @xmath240 times to the left , to get the square @xmath209 associated with the latin square @xmath241 +    for the singular fade state @xmath72 , let @xmath242 be a singularity removal constraint , i.e. , + @xmath243    from , it follows that     @xmath244 is a singularity removal constraint for the singular fade state @xmath237 , where @xmath245 in other words , the rotation in the @xmath72 plane by an angle @xmath246 can be viewed equivalently as a rotation of the constellations used by b during the ma phases by an angle @xmath247 .",
    "note that the columns of the latin square @xmath158 which removes the singular fade states @xmath72 are indexed by the symbols @xmath248 transmitted by b during the two ma phases .",
    "rotating the signal set used by b during the second ma phase by an angle @xmath249 is equivalent to shifting the columns of the latin sub - squares @xmath160 @xmath240 times to the left .",
    "similarly , rotating the signal set used by b during the first ma phase by an angle @xmath250 is equivalent to cyclic shifting the columns of the square @xmath165 , @xmath240 times to the left .",
    "this completes the proof .",
    "for example consider the latin square @xmath158 in fig .",
    "[ fig : ex1 ] which removes the singular fade state @xmath251 the latin square @xmath207 which removes the singular fade state @xmath252 can be obtained from @xmath158 as follows : the columns of the latin sub - squares @xmath253 are cyclically shifted once to the left , to obtain the latin square @xmath183 shown in fig .",
    "[ fig : ex2 ] .",
    "the columns of the square @xmath185 associated with the latin square @xmath183 are cyclically shifted once to the left , to obtain the square @xmath209 .",
    "the latin square @xmath207 associated with the square @xmath254 which removes the singular fade state @xmath252 is shown in fig .",
    "[ fig : ex3 ] .",
    "+ for the acf two - way relaying scenario with 4-psk signal set used at the end nodes , the twelve singular fade states lie on three circles with radii @xmath255 @xmath256 and @xmath257 the latin squares which remove all the twelve singular fade states can be obtained from the three latin squares which remove the singular fade states @xmath258 @xmath259 and @xmath260 given in fig .",
    "3 , fig . 5 and fig.7 respectively .",
    "[ alg ]        recall that there are three classes of singular fade states depending on the radius of the circle it lies on _ ( case 1 : ) _ @xmath102 lies on the unit circle , _ ( case 2 : ) _ @xmath102 lies on the circle of radius @xmath127 and _ ( case 3 : ) _ @xmath102 lies on the circle of radius @xmath128 .",
    "the number of clusters in the clustering utilized by relay node r during bc phase obtained using cartesian product in the three cases is @xmath131 , @xmath168 and @xmath168 respectively .",
    "it is observed that , if instead of taking the cartesian product of the clusterings given in @xcite , the cartesian product of the _ singularity removal constraints _ corresponding to each fade state are used to fill a @xmath77 array , and the resulting incomplete array so obtained is completed using algorithm [ alg ] , so as to form a latin square of side 16 , then the number of clusters of the resulting clustering corresponding the to this latin square can be reduced from 25 to a lesser number in both _ case 2 _ and _ case 3_. we call this the direct clustering .",
    "we now explain this clustering with the help of examples in the second and the third case only , since for the first case , the minimum number of clusters required , i.e. , @xmath131 , can be achieved using cartesian product clustering as shown in section iii . +   + * _ case 2 : _",
    "@xmath102 lies on the circle of radius @xmath127 . *",
    "+ in this case , there are a total of @xmath261 singularity removal constraints as shown in the following lemma .",
    "+            since in the case of two - way acf relaying , the user nodes a and b transmit twice to the relay node r , these constraints for the acf relaying can be obtained by taking the cartesian product of all sets of the form @xmath267      1 .",
    "the singularity removal constraints corresponding to the fade state @xmath102 for the two - way 2-stage relaying as given in @xcite .",
    "let us denote the 2-stage singularity removal constraints as : @xmath268 2 .",
    "the sets of the form @xmath269 for @xmath270 where @xmath271 , since @xmath272 .",
    "the @xmath273 for which @xmath274 are not considered in this category , as it already occurs in some set of the above category",
    ".      1 .   for @xmath275 , @xmath276 these singularity removal constraints account for 16 of the total number of constraints .",
    "+ 2 .   for @xmath277 and the four @xmath278 for @xmath279 that satisfy @xmath280 ; +   @xmath281 these singularity",
    "removal constraints account for remaining 64 constraints ."
  ],
  "abstract_text": [
    "<S> the design of modulation schemes for the physical layer network - coded two way wireless relaying scenario is considered . </S>",
    "<S> it was observed by koike - akino et al . </S>",
    "<S> @xcite for the two way relaying scenario , that adaptively changing the network coding map used at the relay according to the channel conditions greatly reduces the impact of multiple access interference which occurs at the relay during the ma phase and all these network coding maps should satisfy a requirement called _ exclusive law_. we extend this approach to an accumulate - compute and forward protocol which employs two phases : multiple access ( ma ) phase consisting of two channel uses with independent messages in each channel use , and broadcast ( bc ) phase having one channel use . assuming that the two users transmit points from the same 4-psk constellation , every such network coding map that satisfies the exclusive law can be represented by a latin square with side 16 , and conversely , this relationship can be used to get the network coding maps satisfying the exclusive law . </S>",
    "<S> two methods of obtaining this network coding map to be used at the relay are discussed . using the structural properties of the latin squares for a given set of parameters , the problem of finding all the required maps </S>",
    "<S> is reduced to finding a small set of maps . </S>",
    "<S> having obtained all the latin squares , the set of all possible channel realizations is quantized , depending on which one of the latin squares obtained optimizes the performance . </S>",
    "<S> the quantization thus obtained , is shown to be the same as the one obtained in @xcite for the 2-stage bidirectional relaying . </S>"
  ]
}