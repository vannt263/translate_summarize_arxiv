{
  "article_text": [
    "most applications in computational astrophysics involve matter that is in thermal or reactive equilibrium .",
    "astrophysical observations , however , require information to propagate from the astrophysical site to a terrestrial observer .",
    "hence , the observationally interesting events involve additional particle species that are not trapped in the fluid and must therefore be treated by radiative transfer . in many traditional numerical models ,",
    "the equilibrated matter is treated in the hydrodynamic limit , while transported particle species are treated by a suitable algorithm of radiative transfer .",
    "if this splitting in the numerical method is based on the particle species , it can become extremely challenging and inefficient if the range of conditions in the astrophysical scenario is large . in situations where radiative particles are in thermal or reactive equilibrium ,",
    "the non - local algorithm of radiative transfer has to be perfectly consistent with the hydrodynamics scheme and capable of handling very stiff source terms in order to evolve the applicable equilibria .",
    "for example core collapse supernova events have challenged computer models for several decades @xcite .",
    "these stellar explosions occur at the end of the life of a massive star when the growing iron core , as the end product of nuclear fusion , becomes unstable against gravitational collapse .",
    "the collapse is halted only after nuclear density is reached at the centre .",
    "the repulsive strong interaction and the neutron degeneracy pressure reduce the compressibility of matter so that a sound wave travels outward through the causally connected inner core .",
    "it turns into a shock wave when it reaches supersonically accreting matter from the outer layers and , due to dissociation and neutrino losses , stalls within few milliseconds to an initially hydrostatic accretion front , which is thought to slowly expand over several hundreds of milliseconds before the explosion sets in .",
    "the new - born protoneutron star ( pns ) at the centre of the event has a larger density by many orders of magnitude than the shock - heated and dissociated matter that continues to accumulate behind the accretion front .",
    "this accreted matter is subject to a variety of fluid instabilities and asymmetric flow patterns that couple to the energetic neutrino radiation field produced within or close to the surface of the pns .",
    "the emergence of an explosion and the detailed interaction between the multi - dimensional flow and the neutrino field is subject to a long - standing and ongoing debate .",
    "see for example @xcite for a theoretical description of the scenario or @xcite for recent axisymmetric computer simulations with spectral neutrino transport .",
    "several aspects of the core collapse supernova scenario make computer models difficult to perform : the relevant densities in the computational domain range over ten decades from about @xmath0 g/@xmath1 at the centre of the pns down to about @xmath2 g/@xmath1 in the outermost layers ( the star is much larger but does not dynamically react to the changes at the centre during the first few hundred milliseconds after bounce ) .",
    "this density range implies very disparate dynamical time scales . at high densities ,",
    "the weak interaction rates are much faster than the dynamical time scale , while at low density , they are even slower than the evolution time scale .",
    "this requires implicit finite differencing of many processes to perform simulations in a reasonable amount of time .",
    "moreover , the gravitational and stored internal energy scales are of order @xmath3 erg , while typical kinetic explosion energies are two orders of magnitude smaller .",
    "the presence of a strong shock with near - relativistic infall velocities further challenges the resolution and stability of numerical models . in this very dynamical environment with multi - dimensional fluid instabilities and differential rotation , a computer model has to quantify the exchange of energy between matter and the emitted neutrino field in order to allow statements about the explosion dynamics to be made .",
    "as the neutrino cross sections at given matter conditions scale with the square of the neutrino energy , the neutrino transport problem must be considered as a superposition of several single - energy ( monochromatic ) transport problems , where the geometry of the scattering sphere depends on the neutrino energy and type .",
    "this leads to multi - group transport schemes where all propagation quantities are solved in separate energy groups @xcite .",
    "moreover , stationary - state studies with spherically symmetric boltzmann neutrino transport showed that the angular distribution of the neutrino propagation directions have also to be taken into acount to obtain accurate neutrino heating and cooling rates @xcite .    in the mean time",
    ", the spherically symmetric boltzmann transport equation is routinely solved for all neutrino flavours in dynamical models of stellar core collapse and postbounce evolution @xcite .",
    "these comprehensive and sophisticated codes treat disparate time scales by implicit finite differencing and require large computational resources .",
    "however , due to the enormous density range in the scenario , a considerable fraction of the computational domain is either neutrino - opaque or neutrino - transparent . in a fully neutrino - opaque regime ,",
    "a numerical solution to the boltzmann transport equation is rarely more accurate than the solution of the simpler diffusion equation that describes the correct physical limit .",
    "similarly , the angular distribution of the neutrino propagation directions in the far - field free streaming regime is precisely determined by the geometry and emissivity of the distant sources , while an angular discretisation of the boltzmann equation may lead to discretisation errors .",
    "hence , we suggest that a combination of different approaches to radiative transfer is applied in the same astrophysical simulation .",
    "this leads to the concept of an adaptive algorithm , which should not be regarded as an inconsistency or drawback . on the contrary , it saves computation power that can be invested for better resolution , more input physics , or the coverage of a larger parameter space .",
    "current state - of - the - art supernova models with spectral neutrino transport are performed under the assumption of axisymmetry . as a 2d solution of the boltzmann equation",
    "is computationally inefficient for the reasons discussed above , different groups either apply 1d boltzmann solutions in separate angular segments in combination with 2d neutrino advection in opaque regimes ( ray - by - ray ) @xcite , resort to the multi - group flux - limited diffusion ( mgfld ) approximation @xcite , or use a combination of both @xcite .",
    "three - dimensional supernova models were hitherto only affordable with grey neutrino transport @xcite or with other simple ad hoc approximations to the neutrino physics @xcite .",
    "but many features of the supernova should be studied in three spatial dimensions , for example the pattern of the accretion flow @xcite , the standing accretion shock instability @xcite , the excitation of pns g - modes @xcite , and the evolution of magnetic fields ( see e.g. @xcite and references therein ) . in order to enable three - dimensional supernova models with spectral neutrino transport and in order to accelerate parameter studies with simulations of lower dimensionality",
    ", we construct the isotropic diffusion source approximation based on several ideas scattered across the literature .",
    "our algorithm is not meant to compete in accuracy with more detailed solutions of the transport equation in the semi - transparent regime . as the transition from the opaque to the transparent regime",
    "will be handled by interpolation and basic geometric considerations , it is important that the approach is verified by an accurate transport solution for every new field of application .",
    "our approach shares this limitation with the well - known flux - limited diffusion approximation .",
    "the main advantage of the isotropic diffusion source approximation over the latter is that the fluxes and flux factors in the transparent regime are determined by the non - local distribution of sources rather than the local intensity gradient , which may give an incorrect flux direction .",
    "moreover , the new approach tries to limit the computationally expensive solution of the multi - dimensional diffusion equation to the opaque regime where the diffusion approximation is adequate .",
    "the goal is to create a flexible algorithm that efficiently implements only the dominant features of radiative transfer in one consistent framework .",
    "the most obvious method of avoiding the inefficient global application of algorithms is a decomposition of the problem in space , so that one algorithm is used in one subdomain while another algorithm is used in another subdomain @xcite .",
    "another approach is the decomposition in the momentum phase space into particles with thermal velocities and particles with supra - thermal velocities . if one treats the thermal particles by an efficient fluid model , a hybrid kinetic / fluid model",
    "is obtained @xcite .",
    "the isotropic diffusion source approximation described in this article is more similar to the so - called @xmath4-method @xcite .",
    "we also decompose the distribution function of the transported particles into a thermal component and a perturbation that is allowed to overlap the thermal part in the entire computational domain and particle phase space .",
    "however , in our case , the perturbation is not considered to be small .",
    "inspired by flux - limited diffusion @xcite , the evolution of the radiation component is guided by the diffusion limit at large opacities and by the free streaming limit at low opacities .",
    "in contrast to flux - limited diffusion , we build our scheme conceptually on approximations of the collision integral rather than particle fluxes .",
    "we assume that the free streaming particle flux is dominated by the flux emerging from the diffusive domain so that the sources for the far field can easily be integrated . in the stationary - state limit",
    ", the determination of the particle fluxes reduces to the solution of a poisson equation @xcite .",
    "since the matter interacts according to the local particle abundances and not fluxes , we have to convert the particle fluxes to local particle densities .",
    "this is achieved by a geometric estimate of the flux factor as suggested and evaluated by bruenn in @xcite .    in sect .",
    "[ sec : idsa ] we describe in detail how these concepts enter the framework of the isotropic diffusion source approximation , which we design for the transport of massless fermions through a compressible gas .",
    "its connection to the well - known diffusion limit is made in appendix a. in sect .",
    "[ sec : verification ] , we evaluate the performance of this approximation in comparison with boltzmann neutrino transport in spherical symmetry . finally , in sect .",
    "[ sec : multid ] , we discuss the extension to multi - dimensional simulations .",
    "details of the finite differencing and implementation are given in appendix b.",
    "in the idsa , the separation into hydrodynamics and radiative transfer is not based on particle species , but on the local opacity . one particle species is allowed to have a component that evolves in the hydrodynamic limit , while another component of the same particle species is treated by radiative transfer .",
    "the restriction of a chosen radiative transfer algorithm to the more transparent regimes enables the use of more efficient techniques that would not be stable in the full domain . in opaque regimes ,",
    "on the other hand , one can take advantage of equilibrium conditions to reduce the number of primitive variables that need to be evolved .",
    "this algorithmic flexibility can drastically decrease the overall computational cost with respect to a traditional approach .    in the idsa",
    ", we decompose the distribution function of one particle species , @xmath5 , into an isotropic distribution function of trapped particles , @xmath6 , and a distribution function of streaming particles , @xmath7 . in terms of a linear operator @xmath8 describing particle propagation , the transport equation is written as @xmath9 , where @xmath10 is a suitable decomposition of the collision integral according to the coupling to the trapped ( @xmath11 ) or streaming ( @xmath12 ) particle components .",
    "the ansatz@xmath13 requires that we specify an additional source term @xmath14 , which converts trapped particles into streaming particles and vice versa .",
    "we determine it approximately from the requirement that the temporal change of @xmath6 in eq .",
    "( [ eq : schematic.trapped ] ) has to reproduce the diffusion limit in the limit of small mean free paths .",
    "hence , we call @xmath14 the diffusion source. in regions of large mean free paths , we limit the diffusion source by the local particle emissivity . once @xmath14 is determined by the solution of eq .",
    "( [ eq : schematic.trapped ] ) for the trapped particle component , we calculate the streaming particle flux according to eq .",
    "( [ eq : schematic.streaming ] ) by integrating its source , @xmath15 , over space .",
    "finally , the streaming particle distribution function @xmath7 is determined from the quotient of the net particle flux and a geometric estimate of the flux factor .",
    "the diffusion source will turn out to have an additional weak dependence on @xmath7 .",
    "thus , iterations or information from past time steps will be used in the above sequence to reach a consistent solution .",
    "as our target application is neutrino transport in core collapse supernovae , we develop and test the idsa using the example of the o(@xmath16 ) boltzmann equation in spherical symmetry @xcite , @xmath17 \\left ( 1-\\mu ^{2}\\right ) \\frac{\\partial f}{\\partial \\mu } \\nonumber \\\\   & + & \\left [ \\mu ^{2}\\left ( \\frac{d\\ln \\rho } { cdt}+\\frac{3v}{cr}\\right ) -\\frac{v}{cr}\\right ] e\\frac{\\partial f}{\\partial e}\\nonumber \\\\   & = & j\\left ( 1-f\\right ) -\\chi f + \\frac{e^{2}}{c\\left ( hc\\right ) ^{3 } } \\nonumber \\\\ & \\times & \\left [ \\left ( 1-f\\right ) \\int rf'd\\mu ' -f\\int r\\left ( 1-f'\\right ) d\\mu ' \\right ] .\\label{eq : boltzmann } \\end{aligned}\\ ] ] this transport equation describes the propagation of massless fermions at the speed of light , @xmath18 , with respect to a compressible background matter having a rest mass density @xmath19 .",
    "the particle distribution function @xmath20 depends on the time , @xmath21 , radius , @xmath22 , and the momentum phase space spanned by the angle cosine , @xmath23 , of the particle propagation direction with respect to the radius and the particle energy , @xmath24 .",
    "the momentum phase space variables are measured in the frame comoving with the background matter , which moves with velocity @xmath25 with respect to the laboratory frame .",
    "we denote the lagrangian time derivative in the comoving frame by @xmath26 .",
    "note that the derivatives @xmath27 and @xmath28 in eq .",
    "( [ eq : boltzmann ] ) are also understood to be taken comoving with a fluid element .",
    "the particle density is given by an integration of the distribution function over the momentum phase space , @xmath29 , where @xmath30 denotes plancks constant .",
    "on the right hand side , we include a particle emissivity , @xmath31 , and a particle absorptivity , @xmath32 , as well as an isoenergetic scattering kernel , @xmath33 .",
    "we write out all blocking factors @xmath34 in eq .",
    "( [ eq : boltzmann ] ) to ease the identification of in - scattering and out - scattering terms .",
    "the shorthand notation @xmath35 refers to @xmath36 , where @xmath37 is the angle cosine over which the integration is performed . for the present state of our approximation",
    "we neglect inelastic scattering .",
    "we separate the particles described by the distribution function @xmath38 in eq .",
    "( [ eq : boltzmann ] ) into a trapped particle component , described by a distribution function @xmath6 , and a streaming particle component , described by a distribution function @xmath7 .",
    "we assume that the two components evolve separately according to eq .",
    "( [ eq : boltzmann ] ) , coupled only by an as yet unspecified source function @xmath14 which converts trapped particles into streaming ones and vice versa . in this subsection",
    "we discuss the evolution equation of the trapped particle component ,    @xmath39 \\left ( 1-\\mu ^{2}\\right ) \\frac{\\partial f^{{\\rm t}}}{\\partial \\mu } \\nonumber \\\\   & + & \\left [ \\mu ^{2}\\left ( \\frac{d\\ln \\rho } { cdt}+\\frac{3v}{cr}\\right ) -\\frac{v}{cr}\\right ] e\\frac{\\partial f^{{\\rm t}}}{\\partial e}\\nonumber \\\\   & = & j-\\left ( j+\\chi \\right ) f^{{\\rm t}}-\\sigma \\nonumber \\\\   & + & \\frac{e^{2}}{c\\left ( hc\\right ) ^{3}}\\left [ \\int rf^{{\\rm t}\\prime } d\\mu ' -f^{{\\rm t}}\\int rd\\mu ' \\right ] .\\label{eq : boltzmann.trapped } \\end{aligned}\\ ] ]    we assume that the distribution of the trapped particle component , @xmath40 , and the source function , @xmath14 , are isotropic .",
    "the angular integration of eq .",
    "( [ eq : boltzmann.trapped ] ) then reduces to@xmath41 however , even if we are now steering towards the hydrodynamic limit , the evolution of the trapped particle distribution function in our approximation should at least reproduce the correct diffusion limit . the physical understanding of diffusion relies on fast - moving particles with a very short transport mean free path ( see the derivation of the diffusion limit , eq .",
    "( [ eq : diffusion ] ) , in appendix a ) .",
    "the divergence of the small net particle flux leads to a slow drain ( or replenishment ) of particles in a fluid element . in order to accomodate this diffusive drain ( or replenishment ) of trapped particles in eq .",
    "( [ eq : trapped.isotropic ] ) , we have to implement it through the so far unspecified source term @xmath14 .",
    "in the framework of our approximation , trapped particles are converted to streaming ones ( or vice versa ) at the same rate diffusion would drain ( or replenish ) particles in the fluid element . a comparison of eq .",
    "( [ eq : trapped.isotropic ] ) with eq . ( [ eq : diffusion ] ) in appendix a suggests the following diffusion source,@xmath42 isoenergetic scattering enters eq .",
    "( [ eq : trapped.isotropic ] ) only via its opacity @xmath43 in the expression for the transport mean free path @xmath44 that determines the flux in eq .",
    "( [ eq : definition.sigma.1 ] ) ( see appendix a ) . the additional term @xmath45 accounts for the absorption of streaming particles in matter .",
    "its necessity is best understood with the help of fig .",
    "( [ fig : fluid.element ] ) .    shown",
    "are the different particle fluxes that relate to one fluid element .",
    "the fluid element contains both matter and trapped particles .",
    "they interact by the emissivity @xmath31 and absorption @xmath46 ( vertical arrows ) .",
    "the radiation particles leaving the fluid element will convert into streaming particles at the rate @xmath14 ( upper horizontal arrow ) .",
    "we do not include the possibility of a direct emission of matter into the streaming particle component because this process is more easily accounted for by a high conversion rate @xmath14 of trapped particles . on the other hand ,",
    "we account for streaming particles that are absorbed by matter as represented by the arrow denoted by @xmath47 in fig .",
    "( [ fig : fluid.element ] ) . in the diffusion limit",
    ", the net particle exchange of the fluid element with its environment , @xmath48 , must correspond to the diffusion term in eq .",
    "( [ eq : diffusion ] ) .",
    "this is the case for our choice of @xmath14 in eq .",
    "( [ eq : definition.sigma.1 ] ) .    if the above scheme is applied in a more transparent regime where the diffusion approximation does not hold , the diffusion source in eq .",
    "( [ eq : definition.sigma.1 ] ) may become arbitrarily large .",
    "this would be inconsistent with the particle fluxes drawn in fig .",
    "( [ fig : fluid.element ] ) because over a long time the diffusion source can not exceed the emissivity of trapped particles without creating an unphysical deficit in trapped particles . instead , we would like the trapped particle component to drop to zero and stay zero in the limit of long mean free paths .",
    "this is achieved if we limit the diffusion source in eq .",
    "( [ eq : definition.sigma.1 ] ) to @xmath49 .",
    "if the diffusion source and emissivity reach equality , the matter absorptivity -@xmath46 removes remaining trapped particles while all newly emitted ones are directly converted to streaming particles that escape the fluid element . with this limit imposed , the net interaction of particles with matter in fig .",
    "( [ fig : fluid.element ] ) has the correct limit for large mean free paths , @xmath50 .",
    "the search for a lower bound to the diffusion source is less straight - forward . in principle",
    ", a negative @xmath14 can not be physically excluded .",
    "it corresponds to streaming particles that become trapped in a region of large opacity and low absorptivity .",
    "a limit corresponding to the restriction @xmath51 would suggest @xmath52 .",
    "however , @xmath53 can be an excessively large particle density compared to the physically expected value .",
    "much more stable and more accurate results were obtained by the requirement that @xmath54 , where @xmath55 represents the equilibrium distribution function . if one considers this condition for the particle fluxes in fig .",
    "( [ fig : fluid.element ] ) this leads to the simple requirement @xmath56 .",
    "hence , the net absorption of particles in a fluid element can not exceed @xmath47 .",
    "the diffusion source from eq .",
    "( [ eq : definition.sigma.1 ] ) then becomes@xmath57 , j\\right\\ } \\nonumber \\\\ \\alpha   & = & \\frac{1}{r^{2}}\\frac{\\partial } { \\partial r}\\left ( \\frac{-r^{2}}{3\\left ( j+\\chi + \\phi \\right ) } \\frac{\\partial f^{{\\rm t}}}{\\partial r}\\right ) .\\label{eq : definition.sigma.2 } \\end{aligned}\\ ] ] assuming that the streaming particle density @xmath58 was known from the considerations described in the following subsection , eq .",
    "( [ eq : trapped.isotropic ] ) can be used to calculate the evolution of the trapped particle component consistently with the diffusion source specified in eq .",
    "( [ eq : definition.sigma.2 ] ) .",
    "the evolution equation for the streaming particle component consists of all terms in eq .",
    "( [ eq : boltzmann ] ) that have not been considered in the evolution equation ( [ eq : boltzmann.trapped ] ) for the trapped particles .",
    "as mentioned above , we neglect direct scattering from the trapped component into the streaming component and vice versa .",
    "that is @xmath59 \\left ( 1-\\mu ^{2}\\right ) \\frac{\\partial f^{{\\rm s}}}{\\partial \\mu } \\nonumber \\\\ & + & \\left [ \\mu ^{2}\\left ( \\frac{d\\ln \\rho } { cdt}+\\frac{3v}{cr}\\right ) -\\frac{v}{cr}\\right ] e\\frac{\\partial f^{{\\rm s}}}{\\partial e } = -\\left ( j+\\chi \\right ) f^{{\\rm s } } \\nonumber \\\\ & + & \\sigma + \\frac{e^{2}}{c\\left ( hc\\right ) ^{3}}\\left [ \\int rf^{{\\rm s}\\prime } d\\mu ' -f^{{\\rm s}}\\int rd\\mu ' \\right ] .\\label{eq : boltzmann.streaming } \\end{aligned}\\ ] ] for the evolution of streaming particles we neglect the scattering integrals on the right hand side of eq .",
    "( [ eq : boltzmann.streaming ] ) , because the streaming particle density is designed to be small compared to the trapped particle density in regions where the scattering rate dominates the interactions . the weak coupling between streaming particles and the background matter in more transparent regimes where the streaming particle component becomes large makes an inertial laboratory frame more convenient for the solution of eq . ( [ eq : boltzmann.streaming ] ) than the frame comoving with the fluid .",
    "one may simply substitute the conditions @xmath60 and @xmath61 for a static background in eq .",
    "( [ eq : boltzmann.streaming ] ) to find the streaming particle evolution equation in the laboratory frame:@xmath62 note that the quantities carrying a hat now are measured in the laboratory frame . in this frame ,",
    "the particle energy is a constant of motion .",
    "the cumbersome energy derivatives of the distribution function in eq .",
    "( [ eq : boltzmann.streaming ] ) are avoided , but some quantities require lorentz transformations between the comoving and laboratory frames .",
    "in contrast to the full boltzmann equation ( [ eq : boltzmann ] ) , the source term on the right hand side couples only weakly to the particle distribution function @xmath63 . in the diffusive domain , the angle integrated term @xmath64 cancels to a large extent with the corresponding contribution to @xmath65 as defined in eq .",
    "( [ eq : definition.sigma.2 ] ) . in the free streaming domain , the emissivity @xmath66 and opacity @xmath67",
    "are assumed to be small .",
    "depending on the application , there might be various suitable approaches to solve eq .",
    "( [ eq : free.streaming ] ) . here",
    ", we will proceed with a stationary - state approximation .",
    "if we assume that the fluxes of free streaming particles reach stationary values much faster than the dynamical time scale of interest , we can drop the time - derivative in the first term in eq .",
    "( [ eq : free.streaming ] ) . if the source on the right hand side is assumed to be known from a consistent solution of eqs .",
    "( [ eq : trapped.isotropic ] ) and ( [ eq : definition.sigma.2 ] ) , the integration of eq .",
    "( [ eq : free.streaming ] ) over angles leads to a poisson equation for a potential @xmath68 , whose gradient represents the particle flux : @xmath69 d\\hat{\\mu } .\\label{eq : spherical.poisson } \\end{aligned}\\ ] ]    in the end , we are interested in the streaming particle density rather than flux .",
    "both quantities are related by the flux factor .",
    "it is a very challenging problem to calculate an accurate flux factor .",
    "however , bruenn in @xcite suggested a simple and very successful approximation based on the assumption that all particles of a given energy are isotropically emitted at their corresponding scattering sphere .",
    "this leads to the additional relation @xmath70 where @xmath71 is the radius of the monochromatic scattering sphere that depends on the particle energy @xmath72 .    in order to solve for both trapped and streaming particle components , we have to lorentz - transform quantities between the comoving and laboratory frames .",
    "the source of eq .",
    "( [ eq : spherical.poisson ] ) in the laboratory frame is related to the comoving frame by @xmath73 d\\hat{\\mu } \\hat{e}^{2}d\\hat{e } \\nonumber \\\\ & = & \\frac{1}{2}\\int \\left [ -\\left ( j+\\chi \\right ) f^{{\\rm s}}+\\sigma \\right ] d\\mu e^{2}de.\\label{eq : lorentz.source}\\end{aligned}\\ ] ] here we used the fact that the source is isotropic in the comoving frame together with the relations @xmath74 , @xmath75 and @xmath76 @xcite , where @xmath77 is the lorentz factor . on the other hand , the streaming particle contribution to eq .",
    "( [ eq : definition.sigma.2 ] ) in the comoving frame is related to the solution of eq .",
    "( [ eq : spherical.poisson ] ) in the laboratory frame by @xmath78 where the first term is given in eq .",
    "( [ eq : flux.factor ] ) . in @xmath79 we may neglect the factor @xmath80 .",
    "hence , as soon as the evolution of the trapped particle component according to eq .",
    "( [ eq : trapped.isotropic ] ) has determined the source in eq .",
    "( [ eq : definition.sigma.2 ] ) , one can transform it to the laboratory frame by eq .",
    "( [ eq : lorentz.source ] ) . then one determines the stationary - state streaming particle flux and density based on eqs .",
    "( [ eq : spherical.poisson ] ) and ( [ eq : flux.factor ] ) in the laboratory frame . the resulting streaming particle density",
    "is transformed back to the comoving frame by eq .",
    "( [ eq : lorentz.streaming ] ) . in this form",
    "it can be used for the next iteration or time step in eq .",
    "( [ eq : definition.sigma.2 ] ) .      the evolution of the trapped particle component in eqs .",
    "( [ eq : trapped.isotropic ] ) and ( [ eq : definition.sigma.2 ] ) and the stationary - state limit of the streaming particle component in eqs .",
    "( [ eq : spherical.poisson ] ) and ( [ eq : flux.factor ] ) must be coupled with the dynamics of the background matter .",
    "we assume that the dynamics of the background matter is well described by the conservation laws of hydrodynamics,@xmath81 where @xmath82 is a vector of primitive variables and @xmath83 a vector of fluxes .",
    "we rewrite the evolution equation ( [ eq : trapped.isotropic ] ) for the trapped particle component with an eulerian time derivative and use the continuity equation to substitute the @xmath84 term by the velocity divergence , @xmath85 one could now merge the hydrodynamical update on the left hand side of eq .",
    "( [ eq : trapped.advection ] ) with the conservation law in eq .",
    "( [ eq : conservation.law ] ) .",
    "however , if the dynamics of the background matter requires a large - scale numerical simulation and if there are many particle species , the required memory and cpu time to store and advect all these quantities can easily exceed the capacity of the available hardware . in our supernova application , for example , we need in three dimensions a vector @xmath82 of @xmath86 entries to describe the hydrodynamics as detailed below .",
    "the neutrino transport involves @xmath87-@xmath88 neutrino species ( @xmath89 , @xmath90 , @xmath91 , @xmath92 ) with at least @xmath93 entries per species to sample the different neutrino energies @xmath24 in @xmath94 .",
    "if the characteristic time scale of local reactions between the transported particle species is faster than the diffusion time scale , one can use equilibrium conditions to reduce the number of primitive variables necessary to describe the distribution functions of trapped particles . in the supernova model , for example",
    ", we can approximate the spectrum by a thermal spectrum .",
    "note , that this assumption is only made for the _ trapped _ particles within a fluid element .",
    "the streaming particles , which communicate _ between _ fluid elements , keep their detailed spectral information .",
    "our scheme should therefore not be confused with a grey scheme that may additionally assume a predefined energy - spectrum for the particle exchange between fluid elements .",
    "we characterise the thermal equilibrium by a particle number fraction , @xmath95 , and a particle mean specific energy , @xmath96,@xmath97 where @xmath98 is a constant relating a particle number to the rest mass of the background matter ( in our application it is the baryon mass ) .",
    "the corresponding energy integrals performed on eq .",
    "( [ eq : trapped.advection ] ) lead to evolution equations for @xmath95 and @xmath96,@xmath99 e^{2}de\\\\   &   & \\frac{\\partial } { \\partial t}\\left ( \\rho z^{{\\rm t}}\\right ) + \\frac{\\partial } { r^{2}\\partial r}\\left ( r^{2}v\\rho z^{{\\rm t}}\\right ) + \\frac{\\partial } { r^{2}\\partial r}\\left ( r^{2}v\\right ) \\frac{\\rho z^{{\\rm t}}}{3}\\\\   & = & m_{\\rm b}\\frac{4\\pi c}{\\left ( hc\\right ) ^{3}}\\int \\left [ j-\\left ( j+\\chi \\right ) f^{{\\rm t}}-\\sigma \\right ] e^{3}de.\\end{aligned}\\ ] ] the equation for @xmath96 corresponds to an energy equation with a @xmath100 term for the radiation pressure @xmath101 on the left hand side .",
    "analogously to an entropy equation it can be cast into a conservative form for the evolution of @xmath102 .",
    "hence , one can solve the advective part of eq .",
    "( [ eq : trapped.advection ] ) together with the hydrodynamics conservation law ( [ eq : conservation.law ] ) based on the following primitive variables:@xmath103 where @xmath104 is the fluid pressure , @xmath105 the fluid specific internal energy and @xmath106 the electron fraction .",
    "the index @xmath107 labels different species of trapped particles .    as the distribution function of trapped particles in thermal equilibrium , @xmath108 + 1\\right\\ } ^{-1 } $ ] , has two free parameters @xmath109 and @xmath110 , it can be reconstructed so that eq .",
    "( [ eq : definition.yt.zt ] ) is fulfilled for the new values of @xmath111 and @xmath112 .",
    "then , the remaining update of the trapped particle distribution in eq .",
    "( [ eq : trapped.advection ] ) is given by @xmath113 this equation also determines the net interaction rates , @xmath114 , between matter and the radiation particles , which leads to the following changes of the electron fraction and internal specific energy:@xmath115 the changes in the matter electron fraction and specific energy feed back into the emissivity and absorptivity used in eq .",
    "( [ eq : trapped.update.f ] ) . once a consistent solution has been found , eq .",
    "( [ eq : trapped.update.f ] ) allows updates of the trapped particle fraction , of the trapped particle specific energy , and of the matter velocity , which is subject to radiation pressure .",
    "@xmath116 finally , the cycle of updates is completed by the solution of eqs .",
    "( [ eq : spherical.poisson ] ) and ( [ eq : flux.factor ] ) for the distribution function @xmath7 for streaming particles based on the sources determined in eqs .",
    "( [ eq : trapped.update.f ] ) and ( [ eq : definition.sigma.2 ] ) .",
    "details on the finite differencing of our implementation of the idsa are given in appendix b.",
    "we implement the idsa in the hydrodynamics code agile @xcite . for the evaluation of the radiative transfer approximations , we run the simulations in the newtonian limit and include only electron flavour neutrinos . their dominant emission and absorption reactions are@xmath117 where @xmath118 , @xmath119 , @xmath89 , @xmath90 refer to electrons , positrons , electron neutrinos and electron antineutrinos , respectively , that interact with protons , @xmath104 , and neutrons @xmath120 .",
    "the opacities in our example are given by isoenergetic scattering on nucleons and nuclei .",
    "all weak interactions are implemented as described in @xcite .",
    "the thermodynamical state of matter as a function of density , @xmath19 , temperature , @xmath121 , and electron fraction , @xmath106 , is calculated by the lattimer - swesty equation of state @xcite .    very simple and efficient approximations to treat the deleptonisation in the collapse phase have been suggested and evaluated in an earlier paper @xcite .",
    "here we concentrate on the postbounce phase , which is more difficult to capture with neutrino physics approximations .",
    "the neutrinos not only leak out , but they also interact at distant locations and feed back into the hydrodynamics by their transfer of lepton number and energy . due to the as yet restricted input physics",
    ", we base our first comparison on model n13 in @xcite , which we have repeated with the most recent code version to obtain perfect consistency in all parts that are not related to the neutrino transport . the additional neutrino - electron scattering and pair creation rates , which are included in model n13 , do not significantly contribute to the electron flavour neutrino transport in the postbounce phase . in order to keep the approximation as simple as possible , we additionally neglect the transformations between comoving and laboratory frames in our current implementation .    we start with the verification of the description of the trapped particle component .",
    "the trapped particle distribution function is assumed to be thermal and is parameterised by the two parameters inverse temperature , @xmath122 , and the particle degeneracy parameter , @xmath123 .",
    "they are chosen such that eq .",
    "( [ eq : definition.yt.zt ] ) is fulfilled . in fig .",
    "[ fig : fig2.ps ] we compare these parameters to the temperature of matter and to the equilibrium degeneracy parameter determined by reactions ( [ eq : reactions ] ) .",
    "we find as expected that the neutrino distribution function of a reference simulation with boltzmann neutrino transport is very well described by the parameterisation in regimes where the neutrinos are trapped and thermal and weak equilibrium are good approximations .",
    "deviations are visible where the neutrinos start to decouple from matter",
    ". the idsa leads to decreasing trapped particle abundances in this transition regime as more and more particles change from the trapped particle component to the streaming particle component .",
    "this is visible in the decreasing chemical potentials at radii larger than @xmath124 km .",
    "the temperature parameter of the remaining trapped particle component is slightly larger than the temperature of the matter .",
    "this decoupling of particles from opaque matter is an important feature that needs to be handled by a radiative transfer algorithm .",
    "since the idsa treats this transition by a gradual conversion of trapped particles to streaming particles , we can compare the sum of the trapped particle and streaming particle densities with the total particle density in a reference simulation that solves the boltzmann equation .",
    "[ fig : fig3.ps ] shows this comparison for a typical time slice at @xmath125 ms after bounce . because the trapped particle distribution function in eq .",
    "( [ eq : definition.yt.zt ] ) is characterised by the particle abundance and mean energy , we select these two quantities for the comparison .",
    "panel ( a ) shows how the trapped and streaming particle abundances overlap and add up to a reasonable total particle abundance .",
    "panel ( b ) shows similar agreement in the particle mean energies .",
    "although the results agree very well in general , we also note that the deviations are largest around @xmath126 km radius .",
    "[ fig : fig2.ps ] indicates that this is exactly in the difficult regime where the neutrinos decouple from matter .",
    "the less relevant deviations at radii larger than @xmath127 km stem from the doppler energy shift at the shock front , that is not present in the idsa data , because the transformation between the laboratory and comoving frames has been neglected .",
    "we can analyse the discrepancies further by looking at the particle spectra in the different regimes .",
    "the panels on the left hand side of fig .",
    "[ fig : fig4.ps ] show neutrino spectra , while the panels on the right hand side show antineutrino spectra .",
    "the spectra in panels ( a ) and ( b ) are taken at @xmath124 km radius from the time slice at @xmath125 ms after bounce .",
    "one can immediately see that the trapped neutrino component ( dashed lines ) dominates over the streaming particle component ( dash - dotted lines ) .",
    "the sum of both ( thin solid line ) matches well with the reference solution ( thick solid line ) . at these conditions",
    "the spectrum of the neutrinos is very accurately represented by the idsa , while small differences become visible in the antineutrino spectra .",
    "the spectra match well , because the thermal distribution function used for the trapped neutrino component is still a good approximation at the border of the neutrino - opaque regime .",
    "panels ( c ) and ( d ) show the same quantities further out , where the trapped and streaming particle abundances reach about the same value ( i.e. at @xmath128 km radius ) .",
    "the particle abundances again match well with the reference data , but the neutrino spectra in the idsa peak at lower energies than in the reference simulation .",
    "this is consistent with the findings above in fig .",
    "[ fig : fig3.ps ] .",
    "the reason is that the assumption of a thermal spectrum for the trapped particle component starts to become inaccurate at @xmath129 km radius , while the trapped particle component still makes a significant contribution of @xmath130% to the total abundance .",
    "the inaccuracy of a thermal spectrum in the semi - transparent regime is well - documented in the supernova literature ( e.g. @xcite ) and appears most dramatic if presented on logarithmic axes .",
    "we prefer a linear axis where the total particle abundance , or deviations between abundances , are proportional to the enclosed area between the lines . at a radius of @xmath131 km the streaming particle component dominates over the trapped particle component as shown in panels ( e ) and ( f ) .",
    "the comparison of the spectra shows more accurate agreement because the streaming particle component keeps its full spectral information in the idsa .",
    "some deviations in the abundances are visible .",
    "they are most likely an effect of the approximations in the decoupling regime and demonstrate the limitations of the idsa .    at this stage",
    "we are curious , how much accuracy was lost by the decision to parameterise the trapped particle component by a thermal distribution function . in order to test this",
    ", we developed an alternative version that takes deviations from the thermal trapped particle spectrum into account .",
    "the details of this test approach are described in eq .",
    "( [ eq : spectral.correction ] ) in appendix b. the resulting spectra of this more complicated version are shown in fig .",
    "[ fig : fig5.ps ] .",
    "now the reference spectra are perfectly matched by the idsa results at @xmath124 km radius and for the antineutrinos also at @xmath131 km radius . even in the difficult regime at @xmath129",
    "km radius the spectral shapes agree very nicely with the reference .",
    "but new deviations appear this time in the particle abundances , which are somewhat smaller in the idsa data than in the reference data .",
    "we conclude from these comparisons that the results of the idsa are in qualitatively robust agreement with the reference data , but inaccuracies of @xmath132% are likely to be present in the details of the distribution function and are difficult to remove by simple upgrades . in order to become able to better distinguish the systematic errors from the accidental errors , we include both the normal and the spectral version of the idsa in the following comparisons with the reference data .",
    "once the trapped and streaming particle components are specified we investigate the resulting net heating and cooling rates from neutrino absorption and emission .",
    "[ fig : fig6.ps ] shows the energy exchange between neutrinos and matter separately for the neutrinos ( solid lines ) and antineutrinos ( dashed lines ) .",
    "this comparison has to be performed and interpreted very carefully , because the matter conditions are partially in equilibrium with the transported particles .",
    "even minor deviations from the stationary - state equilibrium at a restart of the calculation may lead to large transient corrections in the exchange rates .",
    "hence , we let the hydrodynamics , the reference simulation and the idsa solution evolve after restart at @xmath125 ms postbounce until the stationary - state is achieved in both cases .",
    "the agreement of the idsa ( lines labelled with approx. and spectra ) with the reference simulation ( line labelled with boltzmann ) is excellent in the heating region at radii larger than @xmath133 km .",
    "differences of up to @xmath134% can be seen in the cooling rates at smaller radii in the rates for the antineutrinos ( dashed lines ) .",
    "the idsa with a spectral representation of the trapped particles ( lines labelled with spectral ) performs better than the idsa with the approximate representation of trapped particles ( lines labelled with approx. ) .",
    "the reference simulation shows stronger cooling by neutrinos than antineutrinos at @xmath135 km radius .",
    "this detail feature is not reproduced by either idsa version . however , as the cooling rates are a response to an intricate dynamical equilibrium between the hydrodynamics and the quantities evolved by the transport algorithm , a simple comparison of the heating and cooling rates alone is not sufficient to predict the accuracy of a long - term evolution . in analogy , the instantaneous corrections applied to the steering wheel of a car can vary from driver to driver , but most drivers follow the trajectory of the road on the long term .",
    "a comparison of profiles at the very early postbounce times of @xmath136 and @xmath137 ms is shown in fig .",
    "[ fig : fig7.ps ] .",
    "no significant deleptonisation has occured before @xmath136 ms after bounce , while at @xmath137 ms after bounce the launch of the neutrino burst is reflected in a trough of the electron fraction profile and a strong decline of the entropy profile at an enclosed mass @xmath138 m@xmath139 .",
    "significant differences between the idsa and the boltzmann solution are only visible in the electron fraction profiles .    in fact , if one defines the diffusion source as described in eq .",
    "( [ eq : definition.sigma.2 ] ) , both idsa versions lead to an earlier and somewhat faster deleptonisation than in the boltzmann solution .",
    "our stationary - state assumption of the free streaming particle component implies that produced neutrinos propagate infinitely fast .",
    "this assumption is not applicable in the very early postbounce phase because the dynamical changes of the matter conditions occur on a similar time scale as the neutrino transport .",
    "this transient deviation in the deleptonisation rates during the first few milliseconds lets the models start on a different footing so that the performance of the approximation in the more interesting later postbounce phases becomes difficult to assess .",
    "in order to account for the neutrino propagation time in an averaged way we therefore limit the diffusion source @xmath14 in eq .",
    "( [ eq : definition.sigma.2 ] ) additionally by @xmath140 , where @xmath141 is an empirically determined constant parameter that stands for a typical distance the neutrinos have to propagate until stationary - state conditions become applicable .",
    "the value @xmath142 km leads to satisfactory results . with this",
    ", the idsa version with the spectral treatment of the trapped particle distribution function ( dash - dotted lines ) leads to nice agreement with the boltzmann results ( solid lines ) while the idsa version with the two - parameter description of a thermal distribution function ( dashed lines ) initially deleptonises slightly slower , but excellent agreement is achieved later during the shock expansion phase .",
    "corresponding profiles at @xmath134 ms and @xmath143 ms after bounce are shown in fig .",
    "[ fig : fig8.ps ] . the solutions based on the idsa",
    "lead to a slightly more optimistic shock expansion , but the detailed features in the entropy and electron fraction profiles are accurately reproduced .    the shock retraction phase is shown in fig .",
    "[ fig : fig9.ps ] . shown",
    "are profiles at @xmath125 ms and @xmath144 ms after bounce ( note that now the larger shock radius belongs to the earlier time slice ) .",
    "the effect of neutrino heating ( and hence successful neutrino transport ) is clearly visible in the entropy profile .",
    "models that implement only neutrino leakage develop a much smaller entropy that is entirely set by the heat dissipation at the shock front . in the shock retraction phase , the peak entropy is obtained at the shock front .",
    "if neutrino heating is switched on , the region of peak heating is located between the neutrinospheres and the shock radius ( see fig . [",
    "fig : fig6.ps ] ) , because the neutrino flux dilutes at larger distances and the matter density decreases in the outer layers . figs .",
    "[ fig : fig8.ps ] and [ fig : fig9.ps ] show the negative entropy gradient between @xmath133 km radius and the shock position that is caused by this neutrino heating . as before we obtain excellent agreement in the diffusive regime .",
    "but the model with neutrino transport approximations starts to retract slightly earlier than the more accurate model with boltzmann neutrino transport .",
    "this is consistent with the larger cooling rates of the idsa model found in fig .",
    "[ fig : fig6.ps ] .",
    "however , the overall differences are not much larger than differences that were also found in the first comparison of two independent implementations of boltzmann neutrino transport @xcite .",
    "the chances of obtaining a delayed explosion seem to be more pessimistic in the model with approximate neutrino transport .    a short overview of the comparison is given in fig .",
    "[ fig : fig10.ps ] in the form of shock trajectories and neutrino luminosities for the three models .",
    "panel ( a ) shows the shock trajectories . as stated before",
    ", the agreement is excellent from the early postbounce phase through the shock expansion phase .",
    "the models with approximate neutrino transport initially produce a larger peak shock radius , but then compensate by a faster shock retraction .",
    "the model with the spectral treatment of the trapped particle component ( dash - dotted line ) is somewhat closer to the reference simulation ( solid line ) than the standard idsa with the two - parameter description of the trapped particle distribution function ( dashed line ) .",
    "panel ( b ) shows the neutrino luminosities measured in the comoving frame ( this distinction is only made for the boltzmann reference results ) at @xmath145 km radius .",
    "overall , the luminosities are in good agreement .",
    "the neutrino luminosities in the approximate models are somewhat smaller than in the more accurate boltzmann model .    while experimenting with different variations in the approximation scheme we found that the stationary - state luminosity in the approximate model is not a perfectly smooth function of time , which leads us to the discussion of some numerical issues related to the isotropic diffusion source approach .",
    "the numerical details of our current implementation are outlined in appendix b. all local reaction rates and the corresponding updates of the lepton fractions and temperature are implemented in a time - implicit way .",
    "the non - local contribution from the diffusion is also unconditionally stable because the updates are ordered in such a way that each zone can use the updated distribution function of its neighbour zone in the upwind direction ( with respect to the diffusion flux ) , while the contribution of the local distribution function to the diffusion term is included in the time - implicit update .",
    "however , the coupling to the stationary - state solution of the streaming particle component is operator split .",
    "it is therefore still necessary to restrict the time step to obtain a numerically stable evolution . in the diffusion limit ,",
    "the operator splitting is numerically stable due to above - mentioned implicit finite differencing . in the free streaming limit ,",
    "the operator splitting is numerically stable due to the absence of relevant interactions between the streaming particle component and matter .",
    "it is again the semi - transparent transition regime where the operator splitting has the highest potential for numerical instabilities .",
    "we obtain converged solutions if the time step chosen is smaller than @xmath146 km@xmath147 .",
    "this corresponds to the courant - friedrich - levy ( cfl ) limit for the speed of light or the time step limit of an explicitly finite differenced diffusion scheme where the mean free path is half the zone width , i.e. in the semi - transparent regime . if the time step chosen is larger , the stationary - state solution for the streaming particle component starts to jump from time step to time step .",
    "rare luminosity jumps are still visible in fig .",
    "[ fig : fig10.ps]b .",
    "all other variables , e.g. the lepton fractions and the temperature , do not react to these instantaneous luminosity jumps because they evolve on a slower time scale where the luminosity oscillations enter in a time - averaged manner .    in summary , we believe that the separation of particles into trapped and streaming components provides an interesting ansatz for specifically tailored simplifications of the boltzmann transport equations . the results in figs .",
    "[ fig : fig7.ps]-[fig : fig10.ps ] show that such a simplified descriptijon can reproduce the key features of neutrino transport in supernova models . in the diffusion limit ,",
    "the results are stable and accurate . in the transition regime",
    "the time step of our current implementation is at present limited by numerical fluctuations of the stationary - state streaming particle flux at the transition to transparent conditions . with our not thoroughly optimized code ,",
    "a single time step with the idsa is of order @xmath143 times faster than a corresponding time step with boltzmann neutrino transport .",
    "as the fully implicit boltzmann transport can take about @xmath148 times larger time steps , a full simulation with the idsa is about an order of magnitude faster than the one with boltzmann transport .",
    "however , this number may vary from application to application because the performance of the time - implicit boltzmann solution does not scale favourably with an increased dimensionality and size of the computational domain . in three dimensions ,",
    "we believe that simulations based on the idsa are feasible on average size high - performance computer clusters , while simulations with comprehensive boltzmann transport have not yet been reported to be feasible even on top - performing computer systems .",
    "a possible extension of the idsa to multi - dimensional applications is outlined in the following section .",
    "so far , we have discussed the idsa only in spherical symmetry . as mentioned above ,",
    "it is not the goal of this paper to develop yet another approach that works only for spherically symmetric models .",
    "spherical symmetry is much better treated with three - flavour boltzmann transport where the comprehensive equations of radiative transfer can consistently be solved @xcite .",
    "hence , in this section we discuss how the scheme extends to the three - dimensional case .",
    "the state vector @xmath82 of a 3d simulation only differs from eq .",
    "( [ eq : primitive.variables ] ) by the velocity @xmath25 , which becomes a vector @xmath149 . with the corresponding three directional components @xmath150 in the momentum equation",
    ", the state vector @xmath82 and flux vector @xmath83 become:@xmath151 this state vector can be evolved by a standard hydrodynamics scheme that solves the multi - dimensional conservation law@xmath152    a more difficult part in the multi - dimensional idsa is the consistent solution of eqs .",
    "( [ eq : definition.sigma.2 ] ) and ( [ eq : trapped.update.f])-([eq : trapped.update.e ] ) .",
    "the difficulty arises from the non - local scalar @xmath153 in eq .",
    "( [ eq : definition.sigma.2 ] ) .",
    "the other equations are local and do not depend on the dimensionality of the problem , except that the integration over the angle cosine , @xmath154 , must be replaced by an integration over the entire solid angle of a sphere , @xmath155 .",
    "we believe that there are three options when implementing eq .",
    "( [ eq:3d.alpha ] ) : ( i ) one may calculate eq .",
    "( [ eq:3d.alpha ] ) based on @xmath6 of the previous time step and update @xmath6 locally with eqs .",
    "( [ eq : trapped.update.f])-([eq : trapped.update.e ] ) .",
    "hence , only the local reactions would be implemented implicitly while the diffusion part remains explicit .",
    "this approach is only conditionally stable and the time step must be restricted to @xmath156 .",
    "the relevance of trapped particles diminishes in the transparent regime around @xmath157 .",
    "thus , the time step restriction is of similar order of magnitude as the cfl condition for the particle propagation speed @xmath18 . as the sound speed in neutron stars",
    "is close to the speed of light , the explicit approach may still be a viable option for our application .",
    "( ii ) in order to obtain an unconditionally stable time step , a global implicit solution of above equations could also be attempted . because of the source limiting in eq .",
    "( [ eq : definition.sigma.2 ] ) , the problem is most easily expressed in terms of the unlimited diffusion source @xmath14 as function of @xmath158 as outlined in appendix b in eqs .",
    "( [ eq : fd.sigma.1 ] ) and ( [ eq : fd.implicit.dfdt ] ) .",
    "then , one may search for a globally consistent solution of the field of diffusion sources .",
    "this approach has the disadvantage that a spectral problem has to be solved globally , which results in very memory- and cpu - intensive code",
    ". the computational effort would become comparable with multi - group flux limited diffusion or even more sophisticated algorithms of radiative transfer .",
    "however , the solution could still be restricted to the regimes where the trapped particle component is dominant .",
    "( iii ) perhaps the most promising approach is the combination of specific directional sweeps with a locally implicit update of the diffusion source , be it in the form of a crank - nicholson scheme with adi ( e.g. @xcite ) or using saulyev s asymmetric updates @xcite .",
    "this approach leads to an unconditionally stable time step while retaining the efficiency of an explicit scheme . in appendix",
    "b we apply such an approch for our spherically symmetric application .",
    "independent of the method used , the result of this step determines a partial update of the compositional quantities in @xmath82 and a spectral diffusion source @xmath159 for each particle species @xmath107 at each grid point .",
    "this information is stored for the following updates .",
    "the stationary - state solution for the streaming particle component is then based on@xmath160 d\\hat{\\omega } , \\label{eq:3d.poisson } \\end{aligned}\\ ] ] which is the natural extension of eq .",
    "( [ eq : spherical.poisson ] ) to the multi - dimensional case . the integration over @xmath161 is again performed over the solid angle of a sphere .",
    "if the relative velocities in the transparent regime are large , the source should be transformed from the comoving frame to the laboratory frame ( quantities measured in the laboratory frame carry a hat ) .",
    "note that eq .",
    "( [ eq:3d.poisson ] ) must be solved for each energy group and particle species separately .",
    "but all directional information of the streaming particle flux @xmath162 can be retrieved from the corresponding scalar potential @xmath163 .",
    "once @xmath163 has been calculated , the equally large field @xmath159 is no longer needed .    after the hydrodynamic update according to eq .",
    "( [ eq:3d.conservation.law ] ) , we have to convert the particle flux , @xmath164 , into a streaming particle density .",
    "this is now more ambiguous than in eq .",
    "( [ eq : lorentz.streaming ] ) .",
    "one may still follow the same procedure and first determine the particle scattering spheres .",
    "then , one assumes a flux factor of one half in regions enclosed by the scattering spheres while using an isotropic emission ansatz along the scattering spheres to estimate the flux factor in the domain outside the scattering spheres based on their geometry . for nearly spherical problems such as ours ,",
    "the much simpler spherically symmetric ansatz described above might even be sufficient to obtain an estimate of the flux factor . once the spectral streaming particle density @xmath165 has been determined by the quotient of @xmath164 and the flux factor ,",
    "one cycle of updates in a multidimensional application is concluded .",
    "the isotropic diffusion source approximation ( idsa ) has been designed to treat radiative transfer most efficiently in astrophysical applications where particles diffuse out of an opaque domain that is subject to multi - dimensional dynamics .",
    "this scenario occurs frequently in new - born gravitationally bound objects , accretion discs , or dynamical atmospheres .",
    "we have developed and tested the idsa in the context of spherically symmetric supernova models .",
    "the neutrino transport in core collapse supernovae provides a very challenging application where comprehensive solutions of the boltzmann transport equation have been studied in great detail ( e.g. @xcite and references therein ) .",
    "our approximation treats only the most important features of radiative transfer . in a supernova model , these are ( i ) the thermodynamics of trapped neutrinos ( for example the @xmath166-term ) , ( ii ) the correct diffusion limit , ( iii ) the spectrum of transported neutrinos , and ( iv ) the angular focussing of the neutrino propagation directions with increasing distance from the neutrinospheres .",
    "we implemented the idsa in the hydrodynamics code agile @xcite to compare its performance with a more sophisticated transport model .",
    "we compare the postbounce evolution of a @xmath167 m@xmath139 star @xcite in newtonian gravity with the corresponding model n13 that is based on boltzmann neutrino transport @xcite .",
    "we find good agreement between the results of the idsa and the reference model during the early postbounce phase when the neutrino burst is launched and the accretion shock expands to its maximum radius .",
    "the idsa leads to a somewhat larger maximum shock radius and a faster shock retraction thereafter , i.e. a slightly more pessimistic model with respect to the possibility of a delayed supernova explosion .",
    "we conclude that the concept of the idsa accurately captures the feedback of neutrino transport onto the hydrodynamics evolution in spherically symmetric supernova models .",
    "the neutrino fluxes and spectra are in nice agreement if small time steps are taken , but unphysical fluctuations in the stationary - state neutrino luminosities develop when the time steps are increased much beyond the neutrino propagation time scale",
    ". we will continue to improve the numerical stability of the scheme in future work .",
    "with respect to the choice of physical assumptions and with respect to the quality of the results , the idsa is most closely related to the well - known flux - limited diffusion ( fld ) approximation .",
    "like the latter , the idsa is guided by the diffusion limit at high opacities and the free streaming limit at low opacities .",
    "the fld approximation is based on diffusive fluxes that are limited by the physical particle speed at the transition to the free streaming regime .",
    "this limiting is well - defined in a spherically symmetric setup where the limiting can be applied to the radial velocity direction . in a multi - dimensional simulation , however , fld fails to determine the correct direction of the net flux outside the diffusive regime . in the free streaming regime",
    "there is no physical connection between the local radiation intensity and the flux direction .",
    "a related point is the efficiency of the fld approach .",
    "since the implemented numerical solution strategies are optimised for the diffusive domain , they easily become inefficient in the free streaming regime , which represents often the larger part of the computational domain .",
    "these are the two main shortcomings of fld which we address with the idsa .",
    "the idsa is based on an overlapping two - component description .",
    "the trapped particle component dominates in the diffusive regime while the streaming component dominates in the free streaming regime . in the diffusive regime",
    ", the idsa is equivalent to fld . in the semi - transparent regime , the idsa",
    "is based on a different interpolation between the diffusive and the free streaming regimes . in the idsa ,",
    "the limiter is applied to the sources instead of the fluxes . in the free streaming limit of a multi - dimensional application ,",
    "the direction of fluxes is well - defined by the non - local position of the sources .",
    "the distinction between the trapped and streaming particle components allows us to separately test more efficient solution algorithms for both regimes .",
    "for example , we assumed that the trapped particle component is close to thermal and weak equilibrium while the streaming particle component carries a non - equilibrium spectrum . in the framework of the idsa",
    "we have compare a grey and a spectral ( i.e. energy - averaged and energy - dependent ) treatment of the evolution of the trapped particle component .",
    "we found visible differences of several percent .",
    "we believe that the differences are large enough to value the spectral approach , but at the same time they are small enough to be ignored if the efficiency of the algorithm in 3d simulations becomes critical .",
    "however , we emphasise that this comparison must not be confused with the comparison of a globally grey scheme and a globally spectral approach .",
    "we believe that the _ streaming _ particle component , which represents the lepton and energy flux in a supernova application , must be treated in a spectral manner .",
    "the location of the neutrinospheres is highly energy - dependent .",
    "hence , the geometry of the radiative transfer problem is different for each neutrino energy .",
    "an energy - averaged local quantity can only be expected to be accurately represented if one averages over solutions of the energy - dependent transport problem . a grey scheme , that solves an energy - averaged transport problem instead , is unlikely to produce accurate results in the supernova context .    aside from the field of neutrino - driven supernova models , fld has been used in fields ranging from planet migration @xcite to cosmology @xcite , including areas such as accretion discs , both around stars @xcite and more energetic objects where the accretion disc is dominated by radiation ( e.g. @xcite ) , and star formation @xcite .",
    "the idsa is potentially applicable to these and other areas of astrophysics where fld is commonly used .",
    "however , neither the idsa nor the flda can replace the development of more reliable transport schemes because , for each application , it has to be ascertained that no important physical ingredients are missed .",
    "we hope that the idsa is well - suited to accompany the application of sophisticated radiative transfer algorithms in order to enable an efficient exploration of input physics , parameter space , or dimensionality in computer models where a comprehensive solution of the boltzmann transport equation is not affordable .",
    "this research was funded by the swiss national science foundation under grant no .",
    "pp002 - 106627/1 .",
    "ml and scw acknowledge the hospitality of the institute for pure and applied mathematics at the university of california , los angeles , where our collaboration began .",
    "we are grateful for prolific discussions with ue - li pen , tom abel , jose pons , yudai suwa and andrey yudin .",
    "60 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , , , ,     , , , ,    , , , ,    , , , , ,    , , , , , ,    , , , , ,    , , , , ,    , , , ,    , , , , , , , , ,    , , , , , ,    , , , , , , , ,    , , , , , , , ,    , , , ,    , , , _ _ ( )    , , , in _ _ , edited by , , volume of _ _ , pp .    , , , , ,    , , , , , ,    , , , , , , ,    , , , , ,    , , , , ,    , , , , ,    , , , , , , , ,    , , , , ,    , , , ,    , , , , , ,    , , , , ,    , , , , ,    , , , , , , , , ,    , , , , , , ,    , , , , , ,    , , , ,    , , , , , , , , ,    , , , ,    , , , , , ,    , , , ,    , , , , , , ,    , , in _ _ , edited by , , , , pp .    , , , , ,    , , , , ,    , , , _ _ ( )    , , , , ,    , , , , ,    , , , , ,    , , , , , , ,    , , , , , , , , , ,    , , , , ,    , , , , ,    , , , , , _ _ ( )    , , , , ,    , , _ _ ( , )    , , , , , , , ,    , , , , , , ,    , , , , , , , , ,    , , , , ,    , , , , , ,    , , , , , ,    , , , , , , , , ,    , , , , ,    , , , ,    , , , , , ,",
    "even if the following is old wine in a new hose , we derive the diffusion limit here in brief in order to make a clear distinction between a flux - limited diffusion approximation , which determines the _ particle flux _ based on the diffusion limit and our scheme , which requires a well - founded approximation for the _ collision integral _ in the diffusive limit .    the source term on the right hand side of the boltzmann equation ( [ eq : boltzmann ] ) features an isotropic emissivity , @xmath31 , an isotropic absorptivity , @xmath168 , and an isoenergetic scattering kernel , @xmath33 .",
    "for the derivation of the diffusion limit , the angular dependence of the scattering kernel is usually expanded in a legendre series ( see e.g. @xcite ) , @xmath169 where @xmath170^{1/2 } $ ] specifies the angle between the incoming and the scattered particle propagation directions . in eq .",
    "( [ eq : legendre.expansion ] ) we define @xmath171 such that it enters eq .",
    "( [ eq : boltzmann ] ) without additional factors .",
    "if we denote the operator on the left hand side of eq .",
    "( [ eq : boltzmann ] ) by @xmath172 and truncate the legendre expansion after the second term , we reach a very concise representation of the boltzmann equation , @xmath173 from the zeroth and first angular moments of eq .",
    "( [ eq : boltzmann.compact ] ) we extract an expression for the zeroth and first moments of the distribution function , respectively , @xmath174 if we substitute these terms back into eq .",
    "( [ eq : boltzmann.compact ] ) , we can express the distribution function @xmath175 in the following way , @xmath176 - \\frac{\\mu\\phi_1}{j+\\chi+\\phi_0-\\phi_1 } \\frac{1}{2}\\int d\\left ( f\\right ) \\mu",
    "d\\mu \\right\\}.\\ ] ]    now , we perform a chapman - enskog expansion @xcite . to this purpose",
    "we introduce a small expansion parameter , @xmath177 , and replace the large source functions @xmath31 , @xmath32 and @xmath178 in eq .",
    "( [ eq : f.as.function.of.df ] ) by @xmath179 , @xmath180 and @xmath181 , respectively . from the zeroth order terms in @xmath182",
    "we then obtain as expected the isotropic equilibrium distribution function @xmath183 .",
    "however , we can also determine the first order corrections to the equilibrium distribution function : @xmath184.\\ ] ] after these preparations , we obtain the leading order particle number exchange rate with matter , @xmath185 , by substituting the approximate distribution function @xmath186 into eq .",
    "( [ eq : boltzmann.compact ] ) and integrating the left hand side over particle propagation angles : @xmath187    this integral can be simplified if one decomposes the operator @xmath188 into an operator @xmath189 containing terms that are symmetric in @xmath23 and an operator @xmath190 containing terms that are antisymmetric in @xmath23 .",
    "hence , @xmath191 , with @xmath192 e\\frac{\\partial f}{\\partial e}\\nonumber \\\\ d^{-}\\left ( f\\right )   & = & \\mu \\frac{\\partial f}{\\partial r}+\\frac{1}{r}\\left ( 1-\\mu ^{2}\\right ) \\frac{\\partial f}{\\partial \\mu } .\\label{eq : dplus.dminus } \\end{aligned}\\ ] ] only the symmetric terms @xmath193 , @xmath194   $ ] and @xmath195   $ ] survive the angular integration in eq .",
    "( [ eq : net.source ] ) .",
    "furthermore , we may neglect the @xmath196   $ ] terms because they are of higher order in the expansion than the leading @xmath197 term .",
    "the @xmath195   $ ] terms , however , are of leading order because there is no lower order contribution involving @xmath198 .",
    "the intermediate result @xmath199\\right)\\ ] ] can be further simplified if one explicitly calculates the integral in the last term using @xmath200 .",
    "this leaves us with the following leading order source terms in the diffusion limit , @xmath201 the original operators in eq .",
    "( [ eq : dplus.dminus ] ) may now be readily substituted .",
    "several @xmath202-terms drop out due to the isotropy of @xmath203 and the remaining angular integrations can easily be performed . with this , we obtain the following simple expression for the collision integral in the diffusion limit , @xmath204 where , in order to shorten the notation , we define @xmath205 .",
    "note that a flux - limited diffusion scheme applies eq .",
    "( [ eq : diffusion ] ) as evolution equation for an unknown @xmath206 ( instead of @xmath207 ) together with a source function @xmath208 .",
    "our scheme uses eq .",
    "( [ eq : diffusion ] ) as leading order approximation to the source @xmath185 for a given equilibrium distribution function @xmath207 , exactly as derived . the first term in eq .",
    "( [ eq : diffusion ] ) describes sources that arise from adjustments to a time - dependent equilibrium , the second term accounts for changes in the average particle energy when the fluid is compressed or expanded and the third term describes the divergence of the diffusive flux in the rest frame of the fluid according to the transport mean free path @xmath209 .",
    "in this appendix we discuss the finite differencing of our implementation of the idsa .",
    "our scheme solves eq .",
    "( [ eq : trapped.update.f ] ) for the trapped particles , eq .",
    "( [ eq : spherical.poisson ] ) for the streaming particles , and eq . ( [ eq : conservation.law ] ) for the hydrodynamics in an operator splitting manner",
    ". the spherically symmetric computational domain is represented by an array of concentric fluid shells labelled by the index @xmath210 .",
    "unprimed indices are used for zone centre values and primed indices for the upper zone edge values .",
    "energy - dependent quantities are calculated for a set of discrete particle energies @xmath211 , where @xmath212 .",
    "this representation exists for several time instances , which we label by an upper index @xmath213 .",
    "for example , @xmath214 refers to the mean free path @xmath215 at the zone edge between @xmath216 and @xmath217 , at energy @xmath211 and at time @xmath218 .",
    "a time steps begins with the construction of the particle flux at time @xmath219 from the particle sources , @xmath220 , which have been calculated and stored during the previous time step @xmath218 .",
    "the particle flux is given by the gradient of the potential @xmath221 as described in eq .",
    "( [ eq : spherical.poisson ] ) . in",
    "spherical symmetry , this poisson equation is easily solved by the integration of the sources over the volume , @xmath222 r^{2}_{j}\\left ( r_{j'}-r_{j'-1}\\right),\\ ] ] where we used a tilde to denote stimulated absorption @xmath223 . at present we neglect the lorentz transformation of the sources from the comoving frame to the laboratory frame .",
    "next , we retrieve the current conditions from the solution vector @xmath224 and calculate the energy - dependent transport mean free path @xmath225 and the optical depth @xmath226 . in spherical symmetry , the energy - dependent radius @xmath227 of the neutrinosphere is found at the point where @xmath228 .",
    "the neutrinosphere is then used to derive the streaming particle density from the streaming particle flux according to eq .",
    "( [ eq : lorentz.streaming ] ) .",
    "again , we neglect the lorentz transformation between the laboratory and comoving frames and approximate the streaming particle density by @xmath229 ^{2 } } } \\left ( \\frac{r_{i'-1}}{r_{i}}\\right ) ^{2}\\max \\left [ \\left ( \\frac{\\partial \\psi } { \\partial r}\\right ) _ { i'-1,k}^{n+1},0\\right ] .\\label{eq : fd.streaming.density}\\ ] ] the factor @xmath230 converts the flux from the inner zone edge @xmath231 , where it has been calculated in eq .",
    "( [ eq : fd.poisson ] ) , to the zone centre @xmath216 , where it is used in the calculation of the diffusion source . two measures significantly increase the stability of the scheme .",
    "on the one hand it is important to exclude the contribution of zone @xmath232 to the streaming particle flux . on the other hand ,",
    "the maximum function with the square brackets eliminates fluxes that stream against the density gradient .",
    "the trapped particle distribution functions are separated into a thermal component , and a spectral perturbation , @xmath233 the thermal part is represented by a fermi function , @xmath234 , where the particle temperature and particle degeneracy are chosen such that eq .",
    "( [ eq : definition.yt.zt ] ) is fulfilled for the current values of the quantities @xmath235 and @xmath236 in the solution vector @xmath237 .",
    "if the analytical approximations given in @xcite are used , a consistent set of the particle temperature and degeneracy parameters can be obtained from the solution of a one - dimensional newton - raphson scheme . for the standard version of the idsa we neglect the perturbations by setting @xmath238 . in order to test this approximation in sect .",
    "[ sec : verification ] , we implemented a second version of the idsa , where the deviation of the trapped particle spectrum from the thermal spectrum is evolved in time as described in eq .",
    "( [ eq : spectral.correction ] ) .",
    "the next step is the search for a consistent solution of eqs .",
    "( [ eq : trapped.update.f ] ) , ( [ eq : trapped.update.ye ] ) and ( [ eq : trapped.update.e ] ) . in most of the following monochromatic equations ,",
    "all quantities carry the same energy index @xmath239 . to further reduce the amount of indices we will write the energy index only if quantities at different energies are involved in one equation .",
    "we discretise the fast reaction rates on the right hand side of eq .",
    "( [ eq : trapped.update.f ] ) in a time - implicit way,@xmath240 and eliminate the dependence on @xmath241 on the right hand side by rewriting eq .",
    "( [ eq : fd.explicit.dfdt ] ) in the form@xmath242 the diffusion source @xmath14 , which is defined in eq .",
    "( [ eq : definition.sigma.2 ] ) , depends on @xmath243 .",
    "we will work with the following definition of @xmath243 : @xmath244    in the search for a consistent diffusion source we first assume that @xmath245 is not limited .",
    "then we apply the limiters in eq .",
    "( [ eq : definition.sigma.2 ] ) to the result .",
    "it is known that the numerical evolution of the diffusion equation is not unconditionally stable unless the term @xmath243 is finite differenced in an at least partially implicit manner ( e.g. @xcite ) .",
    "hence , we would like to discretise the diffusion source as @xmath246 the dependence of this equation on the unknown distribution functions @xmath247 can be removed if we substitute eq .",
    "( [ eq : fd.implicit.dfdt ] ) in the first three terms .",
    "the result is a non - local equation involving @xmath248 , @xmath249 and @xmath250 , which could globally be solved for @xmath249 .",
    "however , since our target application is based on a three - dimensional parallelised hydrodynamics code , for the moment we try to avoid a global solution of eqs .",
    "( [ eq : fd.sigma.1 ] ) and ( [ eq : fd.implicit.dfdt ] ) . at least in our spherically symmetric example",
    ", the diffusive fluxes propagate almost exclusively outward .",
    "hence we finite difference the outward propagating flux implicitly and the inward propagating flux explicitly , which leads to @xmath251 if one applies eq .",
    "( [ eq : fd.sigma.2 ] ) from the inside out , @xmath252 is known from the update of the previous zone .",
    "after substitution of eq .",
    "( [ eq : fd.implicit.dfdt ] ) in the first term , eq .",
    "( [ eq : fd.sigma.2 ] ) can be solved for @xmath253 so that the limiter from eq .",
    "( [ eq : definition.sigma.2 ] ) can be applied , @xmath254 , j_{i}^{n+1}\\right\\ } \\nonumber \\\\ \\tilde{\\sigma } _",
    "{ i}^{n+1 } & = & \\frac{1}{1+\\left ( \\zeta _ { i}^{n}+\\tilde{\\chi } _ { i}^{n+1}\\right ) c\\delta t}\\left\\ { \\zeta _ { i}^{n}c\\delta t\\left ( j_{i}^{n+1}-\\tilde{\\chi } _ { i}^{n+1}f_{i}^{{\\rm t},n}\\right ) + \\left ( 1+\\tilde{\\chi } _ { i}^{n+1}c\\delta t\\right ) \\right .",
    "\\nonumber \\\\   & \\times   & \\left .",
    "\\left [ -\\xi _ { i}^{n}f_{i+1}^{{\\rm t},n}+\\eta _ { i}^{n}f_{i}^{{\\rm t},n}-\\zeta _ { i}^{n}f_{i-1}^{{\\rm t},n+1}+\\tilde{\\chi } _ { i}^{n+1}\\frac{1}{2}\\int f_{i}^{{\\rm s},n+1}d\\mu \\right ] \\right\\ } .",
    "\\label{eq : fd.sigma.3 } \\end{aligned}\\ ] ] this diffusion source @xmath255 can now be used in eq .",
    "( [ eq : fd.implicit.dfdt ] ) to determine the discrete time derivative of the trapped particle distribution function , @xmath256 .",
    "furthermore , this derivative specifies the net interaction rate between matter and trapped particles , which can be calculated according to eq .",
    "( [ eq : trapped.update.matter]),@xmath257    in the application of eq .",
    "( [ eq : fd.sigma.3 ] ) to the supernova model in sect .",
    "[ sec : verification ] we observed a slightly too rapid deleptonisation few milliseconds after the bounce of the stellar core . as the dynamical time scale of the bounce is comparable to the neutrino propagation time scale in this short transition phase , the stationary - state assumption of our approximation may not hold .",
    "this effect disappeared when we additionally limited @xmath258 in eq .",
    "( [ eq : fd.sigma.3 ] ) by @xmath259 , where @xmath260 km is an empirically determined constant parameter .    in the case of neutrino transport with electron neutrinos and electron antineutrinos eq .",
    "( [ eq : fd.s ] ) leads to the following updates of the electron fraction and the internal specific energy in eqs .",
    "( [ eq : trapped.update.ye ] ) and ( [ eq : trapped.update.e]):@xmath261 however , the neutrino - matter interactions @xmath262 and @xmath263 , which enter the right hand sides of eqs .",
    "( [ eq : fd.ye ] ) and ( [ eq : fd.e ] ) via eq .",
    "( [ eq : fd.implicit.dfdt ] ) , depend on the updated values for the electron fraction and specific internal energy .",
    "hence we solve this nonlinear algebraic system of equations numerically by two - dimensional newton - raphson iterations to determine a consistent @xmath264-pair .",
    "this consistency is important to accurately represent reactive equilibria at high opacities . following an approach of @xcite",
    ", we first evaluate eq .",
    "( [ eq : fd.s ] ) on four corners of a rectangle , centred around the initial values @xmath265 in the space spanned by electron fraction and specific energy .",
    "then , we use interpolations in this rectangle to efficiently obtain the reaction rates and their derivatives with respect to @xmath106 and @xmath105 during the iterations required to find a consistent solution of eqs .",
    "( [ eq : fd.ye ] ) and ( [ eq : fd.e ] ) .",
    "once the iterations have converged , we update @xmath266 and @xmath267 in the hydrodynamics state vector @xmath268 , where @xmath269 indicates an intermediate incomplete update .",
    "finally , the components @xmath270 and @xmath102 in @xmath271 are updated based on eqs .",
    "( [ eq : trapped.update.yt ] ) , ( [ eq : trapped.update.zt ] ) and ( [ eq : fd.implicit.dfdt ] ) . in the standard version of the idsa",
    ", the spectral information of the trapped particle component is discarded at this point . for the alternative version ,",
    "the spectral information is stored in an energy - dependent vector @xmath272 that will be used in the next time step according to eq .",
    "( [ eq : definition.distft ] ) .",
    "the latter is obtained from @xmath273 the first line in eq .",
    "( [ eq : spectral.correction ] ) calculates the deviation between the updated trapped particle distribution function and the thermal spectrum . due to numerical inaccuracies , spurious errors can accumulate in @xmath274 over many time steps and start to contribute to the trapped particle abundance @xmath275 and the mean specific energy @xmath276 which should be determined by the thermal part alone . adding the correction term on the second line of eq .",
    "( [ eq : spectral.correction ] ) guarantees that @xmath277 and @xmath278 to machine precision .",
    "the correction term depends on energy moments of @xmath274 and the thermal distribution function .",
    "the cycle of updates is concluded by evolving the partially updated hydrodynamics state @xmath268 to @xmath279 according to eq .",
    "( [ eq : conservation.law ] ) ( and including gravity ) by any standard hydrodynamics scheme . for this demonstration of the method we use the spherically symmetric hydrodynamics code agile @xcite with a second order accurate tvd advection scheme ."
  ],
  "abstract_text": [
    "<S> astrophysical observations originate from matter that interacts with radiation or transported particles . </S>",
    "<S> we develop a pragmatic approximation in order to enable multi - dimensional simulations with basic spectral radiative transfer when the available computational resources are not sufficient to solve the complete boltzmann transport equation . </S>",
    "<S> the distribution function of the transported particles is decomposed into a trapped particle component and a streaming particle component . </S>",
    "<S> their separate evolution equations are coupled by a source term that converts trapped particles into streaming particles . </S>",
    "<S> we determine this source term by requiring the correct diffusion limit for the evolution of the trapped particle component . for a smooth transition to the free streaming regime , </S>",
    "<S> this diffusion source is limited by the matter emissivity . </S>",
    "<S> the resulting streaming particle emission rates are integrated over space to obtain the streaming particle flux . </S>",
    "<S> finally , a geometric estimate of the flux factor is used to convert the particle flux to the streaming particle density , which enters the evaluation of streaming particle - matter interactions . </S>",
    "<S> the efficiency of the scheme results from the freedom to use different approximations for each particle component . in supernovae , for example , reactions with trapped particles on fast time scales establish equilibria that reduce the number of primitive variables required to evolve the trapped particle component . on the other hand , </S>",
    "<S> a stationary - state approximation considerably facilitates the treatment of the streaming particle component . </S>",
    "<S> different approximations may apply in applications to stellar atmospheres , star formation , or cosmological radiative transfer . </S>",
    "<S> we compare the isotropic diffusion source approximation with boltzmann neutrino transport of electron flavour neutrinos in spherically symmetric supernova models and find good agreement . </S>",
    "<S> an extension of the scheme to the multi - dimensional case is also discussed . </S>"
  ]
}