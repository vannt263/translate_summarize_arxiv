{
  "article_text": [
    "since almost a decade , non - contact atomic force microscopy ( nc - afm ) has proven capable of yielding images showing contrasts down to atomic scale on metals , semiconductors , as well as insulating ionic crystals , with or without metallic or adsorbate overlayers  @xcite . like other scanning force methods ,",
    "the technique relies on a micro - fabricated tip grown at the end of a cantilever .",
    "however , unlike the widely used contact or the tapping modes , the cantilever deflection is neither static nor driven at constant frequency , but is driven at a frequency @xmath1 equal to its fundamental bending resonance frequency , slightly shifted by the tip - sample interaction .",
    "a sufficiently large oscillation amplitude prevents snap into contact .",
    "a quality factor exceeding @xmath2 , readily achieved in uhv , together with frequency detection by demodulation provide unprecedented force sensitivity  @xcite . a phase - locked loop ( pll )",
    "is typically used for that purpose .",
    "since @xmath3 varies with the tip - surface distance , it deviates from @xmath4 , the fundamental bending eigenfrequency of the free cantilever . upon approaching the surface , the tip is first attracted , in particular by van der waals forces , which decrease @xmath3 .",
    "the negative frequency shift , @xmath5 , varies rapidly with the minimum tip - distance @xmath6 , usually as @xmath7 with @xmath8 , and then as @xmath9 a few angstrms above the surface , owing to short - range chemical and/or steric forces  @xcite .",
    "when @xmath10 is used for distance control , contrasts down to the atomic scale can be achieved .",
    "another specific feature of the nc - afm technique is that the oscillation amplitude @xmath11 is kept constant while approaching or scanning the surface at constant @xmath10 .",
    "controlling the phase of the excitation so as to maintain it on resonance and to make the frequency matching a preset @xmath3-value , as well as the driving amplitude so as to keep the tip oscillation amplitude constant , respectively , requires dedicated electronic components .",
    "amplitude control is usually achieved using a proportional integral controller ( pic ) , hereafter referred to as apic , whereas phase and frequency control can be performed in two ways . in both cases",
    "the ac deflection signal of the cantilever is filtered , then phase - shifted and multiplied by the apic output and by a suitable gain .",
    "the most common method consists in using a band - pass filtered deflection signal  @xcite .",
    "this is referred to as the self - excitation mode .",
    "the second method , extensively analyzed hereafter , consists in using the pll to generate the time - dependent phase of the excitation signal .",
    "the pll output is driven by the ac deflection signal and phase - locked to it , provided that the pll settings are properly adjusted .",
    "then , the pll continuously tracks the oscillator frequency @xmath3 with high precision .",
    "moreover , the phase lag introduced by the pll itself can be compensated . for reasons of clarity ,",
    "this mode will be referred to as the pll - excitation mode .",
    "the choice of the pll as the excitation source has initially been motivated to take benefit of the noise reduction due to plls  @xcite .",
    "a further advantage is that the noise reduction does not only optimize the detection of the frequency shift , but also the excitation signal . in both modes ,",
    "the phase shifter is adjusted so as the phase lag @xmath12 between the excitation and the tip oscillation equals @xmath13  rad throughout an experiment .",
    "if all adjustments and controls were perfect , the oscillator would then always remain on resonance .",
    "the nc - afm technique therefore requires the simultaneous operation of three controllers  : pll , apic and distance controller , which keeps constant a given @xmath10 while scanning the surface .",
    "since the tip - surface interaction makes the dynamic of the oscillator non - linear , the combined action of those three controllers becomes complex .",
    "they can conditionally interplay  @xcite and therefore influence the dynamics of the system .",
    "consider for instance the time the pll spends to track @xmath3 is long compared to the time constant of the apic .",
    "then , the cantilever is no longer maintained at @xmath3 , but at a frequency slightly higher or lower .",
    "consequently , the oscillation amplitude drops  @xcite and the apic increases the excitation to correct the amplitude reduction .",
    "such an apparent loss of energy , which can as well be interpreted as a damping increase of the cantilever , does not result of a dissipative process occurring between the tip and the surface , but is the consequence of the bad tracking of @xmath3 .",
    "so - called apparent dissipation ( or apparent damping ) remains under discussions in the nc - afm community , which hinders the quantitative interpretation of the experimental proofs of dissipative phenomena on the atomic scale over a wide variety of samples  @xcite .",
    "thus , addressing the problem of apparent dissipation turns out to be mandatory but requires to understand the complex interplay between controllers as well as to analyze the system time constants .",
    "although several models of physical dissipation , connected or not to the conservative tip - surface interaction have been proposed  @xcite and reviewed  @xcite , the question of apparent dissipation in the self - excitation scheme has been addressed by two groups  @xcite .",
    "m.  gauthier _ et al .",
    "_  [ ] emphasize the interplay between the controllers and the conservative tip - sample interaction which , although weak , can significantly affect the damping .",
    "they put in evidence resonance effects which can conditionally occur in damping images upon scan speed and apic gains .",
    "g.  couturier et al .",
    "@xcite address a similar problem numerically and analytically .",
    "they show that the self - excited oscillator can be conditionally stable within a narrow domain of @xmath14 and @xmath15 gains of the apic , but that consequent damping variations can as well be generated upon conservative force steps which change the borders of the stability domain .",
    "the results mentioned above are valid for the self - excitation mode , but the question of apparent dissipation remains open regarding the pll - excitation mode .",
    "however recently , j.  polesel - maris and s.  gauthier  [ ] have proposed a virtual dynamic afm based on the pll - excitation scheme .",
    "their work is targeted at images calculations including realistic force fields obtained from molecular dynamics calculations  @xcite .",
    "their conclusions stress the contribution of the scanning speed and of the experimental noise to images distortion but do not address the potential contribution of the pll upon operating conditions .",
    "the goal of the present work is two - fold  : 1- providing a detailed description of the pll - excitation based electronics of a home - built afm used in our laboratory ; 2- assessing the contribution of the various controllers to the dissipation signal and in particular the contribution of the pll . the paper is organized as follows . in section [ section_overview ] , an overview of the chart of the microscope and of the attached electronics ( _ cf_. fig.[fig_microscope ] ) ,",
    "is given in terms of blocks , namely  ; oscillator and optical detection ( block 1 ) , rms - to - dc converter ( block 2 ) , amplitude controller ( block 3 ) , pll ( block 4 ) , phase shifter ( block 5 ) and tip - surface distance controller ( block 6 ) . in section [ section_numericalscheme ] , the detailed description of the numerical scheme used to perform the calculations",
    "is given on the base of coupled integro - differential equations ruling each block .",
    "section [ section_mindissdetect ] provides an estimate of the minimum detectable dissipation by the instrument with the goal to assess the relevance , compared to experimental results , of the apparent dissipation which can be conditionally generated numerically .",
    "section [ section_results ] reports the results . in the first part",
    ", the simulation is validated by comparing a numerical @xmath16 _ vs. _ distance curve to the analytic expression of the @xmath10 due to morse and van der waals interactions which does not take into account the finite response of the various controllers .",
    "then the dynamic properties of the numerical pll and apic upon gains are compared to those of the real components .",
    "section [ subsection_apparentdamping ] gives some examples on how apparent dissipation can be produced upon working conditions of the pll .",
    "section [ subsection_scans ] finally shows scan lines computed while varying pll gains , scan speed and apic gains . a discussion and a conclusion end the article .",
    "the electronics consists of analog and digital ( @xmath17 bits ) circuits which are described by six interconnected main blocks operating at various sampling frequencies ( @xmath18 ) .",
    "the highest sampling frequency among the digital blocks is the pll one , @xmath19  mhz .",
    "the pll electronics has initially been developped by ch.loppacher  [ ] .",
    "block @xmath20 represents the detected oscillating tip motion coupled to the sample surface . in the simulation ,",
    "the block is described by an equivalent analog circuit .",
    "more generally , all the analog parts of the electronics are described in the simulation using a larger sampling frequency compared to @xmath21 , namely @xmath22  mhz .",
    "this is motivated by the ultra - high vacuum environment within which the microscope is placed , thus resulting in a high quality factor of the cantilever , typically @xmath23 at room temperature .",
    "besides , nc - afm cantilevers have typical fundamental eigenfrequencies @xmath24  khz .",
    "the chosen sampling frequency should therefore insure a proper integration of the differential equations with an error weak enough .",
    "the signal of the oscillating cantilever motion goes into a band pass filter which cuts - off its low and high frequencies components .",
    "the bandwidth of the filter is typically @xmath25  khz , centered on the resonance frequency of the cantilever . despite the filter",
    "has been implemented in the simulation , no noise has been considered , so far .",
    "the signal is then sent to other blocks depicting the interconnected parts of two boards , namely an analog / digital one , the  pll board \" , and a fully digital one which integrates a digital signal processor ( dsp ) , the  dsp board \" .",
    "the boards share data _ via _ a  communication bus \" operating at @xmath26  khz , the lowest frequency of the digital electronics .",
    "block @xmath27 stands for the lone analog part of the pll board ( @xmath28 ) .",
    "it consists of a rms - to - dc converter .",
    "the block output is the rms value of the oscillations amplitude , @xmath29 .",
    "@xmath29 is provided to block 3 , one of the two pics implemented on the dsp ( @xmath30 ) . when operating in the nc - afm mode , the block output is the dc value of the driving amplitude which maintains constant the reference value of the oscillations amplitude , @xmath31 .",
    "this is why it is referred to as the amplitude controller , apic . for technical reasons due to the chips",
    ", the signal is saturated between @xmath32 and @xmath33  v.    the dashed line in fig.[fig_microscope ] depicts the border between analog and digital circuits in the pll board .",
    "the digital pll , block @xmath34 ( @xmath35 ) , consists of three sub - blocks  : a phase detector ( pd ) , a numerical controlled oscillator ( nco ) and a filtering stage consisting of a decimation filter and a finite impulse response ( fir ) low pass filter in series .",
    "the pll receives the signal of the oscillation divided by @xmath29 plus an external parameter  : the  center frequency \" , @xmath36 .",
    "@xmath37 specifies the frequency to which the input signal has to be compared to for the demodulation frequency stage .",
    "this point is particularly addressed in section [ subsection_pll ] .",
    "the nco generates the digital @xmath38 and @xmath39 waveforms of the time - dependent phase , @xmath40(t ) , ideally identical to the one of the input signal .",
    "@xmath41 is correlated to the error which is potentially produced while the frequency demodulation , upon operating conditions .",
    "the @xmath38 and @xmath39 waveforms are then sent to a digital phase shifter , block @xmath42 ( @xmath35 ) which shifts the incoming phase @xmath43 by a constant amount , @xmath44 , set by the user . since the cantilever is usually driven at @xmath3 , @xmath44 is adjusted to make that condition fulfilled  @xcite , namely  :    @xmath45    indeed , the pll produces the phase locked to the input , that is @xmath46 .",
    "if it optimally operates , @xmath47 .",
    "@xmath44 has therefore to be set equal to @xmath48 to maintain the excitation at the resonance frequency prior to starting the experiments .",
    "consequently , @xmath49  rad . the block output , @xmath50 $ ] ,",
    "is converted into an analog signal and then multiplied by the apic output , thus generating the full ac excitation applied to the piezoelectric actuator to drive the cantilever .",
    "block @xmath51 is the second pic of the dsp ( @xmath30 ) .",
    "it controls the tip - surface distance to maintain constant either a given value of the frequency shift , or a given value of the driving amplitude while performing a scan line ( switch @xmath52 set to location  a \" or  b \" , respectively in fig.[fig_microscope ] ) .",
    "the output is the so - called  topography \" signal .",
    "the block is referred to as the distance controller , dpic .",
    "finally , a digital lock - in amplifier detects the phase lag , @xmath12 , between the excitation signal provided to the oscillator and the oscillating cantilever motion .",
    "analog and digital data are properly transformed by analog - to - digital and digital - to - analog converters ( adc and dac , respectively ) . in the electronics , adc1 is an _ ad@xmath53 _",
    "_ fig.[fig_microscope ] ) with a nominal sampling rate of @xmath54 samples _ per _ second  @xcite .",
    "this ensures the analog signal is sampled quick enough and properly operated by the pll at @xmath21 .",
    "this adc is therefore not described in the simulation .",
    "adc@xmath27 ( _ ads @xmath55 _ ) has a nominal frequency of @xmath56  khz  [ ] .",
    "the signal is transmitted to the communication bus , the bandwidth of which is ten times smaller .",
    "its role is therefore as well supposed to be negligible .",
    "the code is implemented assuming that the rms - to - dc output signal is provided to the communication bus operating at @xmath57 .",
    "dac1 ( _ ad @xmath58 _ ) is a @xmath17 bits ultrahigh speed converter .",
    "it receives the digital waveform coming from the ps .",
    "indeed , it must be fast enough to provide a proper analog signal to hold the excitation .",
    "its nominal reference bandwidth is @xmath59  mhz  [ ] . to make the code implementation easier , the dac has not been implemented neither .",
    "thus , it is assumed that the ps signal directly provides the signal at @xmath21 to perform the analog multiplication , itself processed at @xmath57 due to the apic output .",
    "the others dacs have all nominal bandwidths much larger than the communication bus one and are also assumed to play negligible roles .",
    "the block mimics the photodiodes acquiring the signal of the motion of the oscillating cantilever .",
    "the equation describing its behavior is given by the differential equation of the harmonic oscillator  :    @xmath60    @xmath61 , @xmath62 , @xmath63 stand for the angular resonance frequency , quality factor and cantilever stiffness of the free oscillator , respectively .",
    "@xmath64 , @xmath65 and @xmath66 are the instantaneous location of the tip , excitation signal driving the cantilever and the interaction force acting between the tip and the surface , respectively .",
    "the equation is solved with a modified verlet algorithm , so - called leapfrog algorithm  @xcite , using a time step @xmath67  ns . in the followings , the time will be denoted by its discrete notation  : @xmath68 .",
    "the instantaneous value of the driving amplitude @xmath69 ( units  :  m ) can be written as  :    @xmath70    @xmath71 ( units  :  m.v@xmath72 ) represents the linear transfer function of the piezoelectric actuator driving the cantilever .",
    "@xmath73 ( units  :  v ) is the apic output ( _ cf .",
    "_ section [ subsection_apic ] ) .",
    "it is proportional to the damping signal according to  :    @xmath74    @xmath75 and @xmath76 ( units  :  s@xmath72 and m , respectively ) being the damping signal and oscillations amplitude of the cantilever when driven at @xmath4 , respectively . when the cantilever is externally driven and if no interaction occurs , @xmath73 can be written as a function of @xmath76 and of the quality factor of the cantilever  :    @xmath77    then the damping of the free cantilever equals  :    @xmath78    in nc - afm , the dissipation is commonly expressed in terms of dissipated energy _ per _ oscillation cycle , @xmath79 .",
    "for a cantilever with a high quality factor oscillating with an amplitude @xmath76  :    @xmath80    in uhv and at room temperature , @xmath23 . besides , nc - afm commercial cantilevers have typical stiffnesses  @xcite @xmath81  n.m@xmath72",
    ". considering @xmath82  nm , the intrinsic dissipated energy _ per _ cycle of the cantilever is then @xmath83  ev / cycle .    in equation [ equ_xiexc(t ) ] , @xmath84 is the ac part of the excitation signal ( _ cf .",
    "_ section [ subsection_ps ] ) .",
    "it is provided by the ps when the pll is engaged .",
    "when the steady state is reached , _ e.g. _",
    "@xmath85 , the block output is  :    @xmath86\\ ] ]    @xmath87 ( v.m@xmath72 ) depicts the transfer function of the photodiodes which is assumed to be linear within the bandwidth ( @xmath52  mhz in the real setup ) .",
    "if the damping is kept constant , the amplitude and the phase , @xmath88 and @xmath89 respectively , are supposed to be constant as well .",
    "this is no longer true once the various controllers are engaged , therefore their time dependence is explicitly preserved .    in equation [ equ_otcs ] ,",
    "the interaction force @xmath90 is derived from a conservative potential consisting of two components  : a long - range part , depicted by a van der waals term defined between a sphere and a half - plane and a short - range part , prevailing at closer distances , depicted by a morse potential  :    @xmath91\\ ] ]    @xmath92 and @xmath93 are the hamaker constant of the tip - vacuum - surface interface and tip s radius , respectively .",
    "@xmath94 , @xmath95 and @xmath96 are the depth , equilibrium position and range of the morse potential .",
    "the instantaneous tip - surface separation is @xmath97 , where @xmath98 is the distance between the surface location and the cantilever position at rest .",
    "so far , neither elastic deformation of the sample and tip , nor dissipative interaction have been considered .",
    "the signal @xmath99 then gets into the band pass filter ( bpf ) , the central frequency of which , @xmath100 , equals the resonance frequency of the cantilever , @xmath4 , with a bandwidth @xmath101  khz . the output , @xmath102 ( units  :  v ) , is ruled by  :    @xmath103    @xmath102",
    "is then provided to the rms - to - dc converter of the pll board .",
    "the converter is the only analog part of the pll board .",
    "the related differential equation is integrated at @xmath104 .",
    "the chip ( ad734 ) computes the square root of the squared value of the incoming signal , preliminary filtered by a first - order low pass filter , the cut - off frequency of which is @xmath105  hz .",
    "the output is the amplitude ( dc value ) of the oscillation , @xmath106 ( units  :  v )  :    @xmath107    @xmath108 being the output of the first - order low pass filter  :    @xmath109    with @xmath110  @xmath111s .",
    "@xmath102 is then divided by @xmath106 in order to normalize the amplitude of the waveform .",
    "the signal thus normalized is sent to the adc1 to be operated by the digital pll .",
    "the block represents a digital pi controller implemented in the dsp board .",
    "the controller receives the rms - to - dc output signal _ via _ the communication bus .",
    "since the bus operates at @xmath26  khz , the time step used to solve the related differential equation is @xmath112  @xmath111s .",
    "besides @xmath113 , the controller receives three external parameters  : the proportional and integral gains , @xmath114 and @xmath115 respectively ( units  :  dimensionless and s@xmath72 , respectively ) , and the reference amplitude expected to be kept constant as soon as the controller is engaged ( switch @xmath20 set to location",
    " b \" in fig.[fig_microscope ] ) , @xmath31 ( units  :  v ) .",
    "the block output is the dc value of the excitation , previously referred to as @xmath73 ( _ cf . _",
    "equ.[equ_xiexc(t ) ] )  :    @xmath116 \\notag \\\\ & + \\sum_{k=0}^{i}{k_i^\\text{ac}\\left[a_0^\\text{set}-a_\\text{rms}(t_k)\\right]\\delta t_{s_3}}\\end{aligned}\\ ] ]    engaging the apic makes the nc - afm mode effective .",
    "this requires the pll - excitation mode ( block 4 , _ cf .",
    "_ section [ subsection_pll ] ) to be already engaged .",
    "if operating at @xmath3 , then @xmath117 equals the resonance amplitude , @xmath76 .",
    "@xmath118 is then minimal .      before starting this section , note that some of the elements detailed hereafter are adapted from the book by r.best  [ ]",
    "the digital pll consists of three sub - units  : a phase detector , a decimation filter and a fir low pass filter in series and a nco .",
    "the block operates at @xmath119  mhz , with the related time step @xmath120  ns . in the electronics , various fir low pass filters",
    "have been implemented upon the desired sensitivity in the frequency detection , among which a @xmath121 order filter with a 3  khz cut - off frequency and a @xmath122 order filter with a 500  hz cut - off frequency .",
    "both of them can be used in the simulation .",
    "the pd is analogous to a multiplier regarding the two input signals  : the bpf output divided by @xmath113 and the @xmath39 waveform coming out of the nco ( _ cf . _",
    "fig.[fig_microscope ] ) .",
    "their product is multiplied by a further gain , @xmath123 ( units  : v ) converting the dimensionless signal into volts to be operated by the fir low pass filter .",
    "the instantaneous block output is referred to as @xmath124  :    @xmath125      assume that @xmath126 and @xmath127 are the instantaneous angular frequencies of the cantilever and of the signal generated by the nco , respectively .",
    "@xmath124 consists of a high frequency component  : @xmath128 and a low frequency one  : @xmath129 .",
    "the fir low pass filter cuts off the high frequency component and produces @xmath130\\times t_i$ ] , which can be referred to as an error signal of the pll . indeed , when the pll optimally operates , @xmath127 almost perfectly matches @xmath126 .",
    "the instantaneous value @xmath131 can therefore be interpreted as a correction term in the pll cycle .    before being operated by the fir low pass filter",
    ", the signal is processed by the decimation filter .",
    "the filter averages @xmath132 over @xmath133 pll cycles upon the fir low pass filter cut - off frequency .",
    "for instance , @xmath134 for the 3  khz low pass filter .",
    "the updating rate of the fir low pass filter is therefore @xmath135  khz .",
    "the digital data are averaged over those @xmath133 cycles .",
    "the average value is fed at the first entry of a buffer @xmath136 consisting of @xmath137 entries .",
    "the entries of the buffer are then all shifted by one into the buffer . at a given moment in time , @xmath138 , @xmath131 is given by the following algorithm  :    @xmath139    @xmath137 is the order of the fir low pass filter ( @xmath140 ) and @xmath141 is the k@xmath142 coefficient of the fir low pass filter . once the buffer is transmitted , it is initialized and filled again .",
    "finally , @xmath131 is multiplied by a further gain , @xmath143 , which depicts the linear conversion of the signal from volts to rad.s@xmath72 ( units : rad.v@xmath72.s@xmath72 ) and provided to the nco .",
    "we first assume that the frequency tracker of the pll is disengaged ( switch @xmath27 set to location  a \" in fig.[fig_microscope ] ) .",
    "its role is carefully addressed in section [ subsubsection_ftracker ] .",
    "the nco adds the instantaneous angular frequency @xmath144 to an external input , the center angular frequency of the pll , @xmath145 .",
    "@xmath145 is fixed equal to the angular resonance frequency of the free cantilever @xmath146 , prior to starting the experiments . the signal is then integrated , which produces the related phase , @xmath147 , locked to the one of the cantilever  :    @xmath148 \\delta t_{s_1},\\ ] ]    @xmath149 being the moment when the pll is engaged .",
    "obviously , the pll has to be engaged once the oscillator has reached its steady state and before the apic .      when the tip is located far from the surface , @xmath150 .",
    "once approached close enough from it , @xmath151 starts decreasing . meanwhile , the nco produces @xmath152 , as mentioned above .",
    "when the frequency tracker is disengaged , @xmath145 is kept constant and matches the resonance frequency of the free cantilever , @xmath153 .",
    "therefore @xmath144 is nothing but the instantaneous frequency shift ( actually @xmath154 ) of the tip interacting with the surface . in other words  :    @xmath155    @xmath143 is a key parameter of the pll .",
    "it sets its capability to get locked to the input signal and in turn it sets its stability .",
    "r.best defines @xmath143 from the locking range @xmath156 of the pll , _",
    "e.g. _ the frequency gap with respect to the center frequency the pll can detect remaining locked  @xcite . on the hardware level ,",
    "the control signal @xmath157 is limited to a range which is smaller than the supply voltages , usually @xmath158v .",
    "assuming @xmath159 and @xmath160 be the minimum and maximum values allowed for @xmath161 , best defines @xmath143 as  :    @xmath162    therefore @xmath143 is related to the maximum frequency shift detectable _ per _ volt within the detection range of the low pass filter . practically , the value of @xmath143 is not accessible _ a priori_. it s easier to set the locking range @xmath156 . for an oscillation at @xmath163  khz , frequency shifts of about a few hundreds of hertz",
    "are typically expected@xcite .",
    "we can therefore choose the 3  khz fir low pass filter to insure a proper detection of @xmath10 , which sets the locking range to @xmath164  rad.s@xmath72 .",
    "the maximal value of @xmath143 expected is then @xmath165  rad.v@xmath72.s@xmath72 , which is an excellent estimate as detailed in section [ section_results ] .",
    "the frequency tracker is a specific feature of our digital pll . when engaged ( switch @xmath27 set to location",
    " b \" in fig.[fig_microscope ] ) , the center frequency is continuously updated by the fir low pass filter output  :    @xmath166    the updating frequency is 2.5  khz . the frequency tracker has been implemented in order to compensate the fact that the frequency demodulation was performed _ via _ the lone proportional gain @xmath143 .",
    "thus , as mentioned before , @xmath167 can be interpreted as the error signal produced in the frequency detection compared to @xmath145 .",
    "consequently , this error is also integrated by the nco , which leads to an additional phase lag added to @xmath168 at each pll cycle and previously referred to as @xmath169 .",
    "@xmath169 _ per _",
    "pll cycle can approximately be estimated to  :    @xmath170    @xmath169 would be zero if no frequency shift occurred , which is the case in most of the applications using plls .",
    "but while approaching , @xmath10 decreases continuously , therefore so does @xmath169 . on the contrary ,",
    "when the frequency tracker is engaged , @xmath145 is continuously updated .",
    "the error in the frequency detection drops to zero .",
    "more exactly , it is equal to the difference between two consecutive values of @xmath145  : @xmath171 , but is necessarily small and so is @xmath169 .    to assess how sensitive to frequency changes",
    "the phase is , the following experiment is carried out .",
    "a @xmath172  khz sinusoidal waveform is generated by means of a function generator and sent to the real pll .",
    "the frequency is then slowly detuned from @xmath173  hz up to @xmath174  hz .",
    "the phase lag between input and output waveforms , @xmath169 , is recorded with a lock - in amplifier ( perkin elmer 7280 ) and reported as a function of the detuning .",
    "the pll center frequency is fixed to @xmath175  khz .",
    "the experiment is repeated the frequency tracker being engaged and disengaged .",
    "two amplitudes of the pll input waveform are used . in this experiment",
    ", the input waveform stands for the oscillatory motion of the cantilever and the tuning for the shift occurring when the tip is approached towards the surface upon attractive or repulsive forces .",
    "the results are reported in fig.[fig_frequtrack ] .",
    "when the tracker is disengaged , the maximum detuning corresponds to a phase lag of @xmath176  degrees , which means that the cantilever would then be driven off resonance severely . on the opposite , when engaged , the phase lag reduces ( inset ) to @xmath177 degree .",
    "this feature has no consequence when the pll is only used as a frequency demodulator like in the self - excitation mode . on the opposite in the pll - excitation scheme ,",
    "this point is crucial since the pll is produces the excitation signal .",
    "therefore particular attention has to be paid on the way it is produced . if it is abnormally phase shifted , then the oscillation amplitude drops and consequently apparent dissipation is generated , as shown in section [ section_results ] .",
    "the ps receives the @xmath38 and @xmath39 waveforms generated by the nco .",
    "a further input to the block is the phase lag , @xmath44 , fixed prior to starting the experiments to make the cantilever oscillating at @xmath4 . the ps digitally computes  :      when the system is being operated in the pll - excitation mode , @xmath179 is converted into an analog signal by the dac1 and multiplied by the apic output .",
    "the distance controller is the second digital pi controller implemented in the dsp operating at @xmath57 .",
    "the block gets the setpoint value of the signal ( @xmath10 or damping ) onto which the control of the tip - sample distance is performed and the proportional and integral gains , @xmath180 and @xmath181 , respectively . here",
    ", let s assume that the reference signal is the frequency shift , as depicted in fig.[fig_microscope ] .",
    "we have arbitrarily chosen not to describe the transfer function of the z - piezo drive .",
    "therefore @xmath180 and @xmath181 have natural units ( nm.hz@xmath72 and nm.hz@xmath72.s@xmath72 , respectively ) .",
    "the controller is described by  :    @xmath182 \\notag \\\\ + & \\sum_{k>\\text{dc}}^{i}{k_i^\\text{dc}\\left[\\delta f_\\text{set}-\\delta f(t_k)\\right]\\delta t_{s_3}},\\end{aligned}\\ ] ]    @xmath183 being the tip - surface distance when the dpic is engaged .",
    "the description of the lock - in amplifier implemented in the simulation does not depict the detailed operational mode of the real lock - in which is used to monitor the phase shift of the oscillator ( perkin elmer 7280 ) .",
    "its purpose is to provide an easy way to estimate the phase shift between the excitation and the oscillation .",
    "the calculation of the phase is performed at @xmath184  khz .",
    "the buffer used to extract the phase therefore consists of @xmath185 samples .",
    "the numerical code used to describe it is  :    @xmath186}{\\sum_{k = i - n_\\text{lock - in}}^{i}z_\\text{bpf}(t_k)\\times \\cos[\\varphi_\\text{nco}(t_k)+\\varphi_\\text{pll}+\\varphi_\\text{ps}]}\\end{aligned}\\ ] ]      the numerical code has been implemented with labview@xmath187 @xmath188 , supplied by national instruments@xmath187 .",
    "it consists of a user interface where all the parameters are tunable at run - time , like during a real experiment .",
    "the couple of integro - differential equations [ equ_otcs ] , [ equ_xiexc(t ) ] , [ equ_zbpf(t ) ] , [ equ_rms2dc ] , [ equ_rms2dclp ] , [ equ_apic ] , [ equ_pd ] , [ equ_filteringstagepll ] , [ equ_finco ] , [ equ_zps(t ) ] and [ equ_dpic ] are integrated at their respective sampling frequencies .",
    "the monitored signals are the oscillation amplitude @xmath113 ( equ.[equ_rms2dc ] ) , the frequency shift @xmath10 ( equ.[equ_deltaf ] ) , the phase @xmath12 ( equ.[equ_filockin ] ) and the relative damping @xmath189=@xmath190 , deduced from the apic output ( equ.[equ_aexc(t ) ] ) .",
    "the connection to the dissipated energy _ per _",
    "cycle @xmath191 is given by equation [ equ_energylossintrinsic ] , that is @xmath192 .",
    "addressing the question of apparent dissipation requires to estimate the minimum dissipation which is detectable by the instrument upon operating conditions . beyond the specificities of the pll- or self - excitation modes , important parameters like quality factor @xmath62 , temperature and bandwidth of the measurement must be considered .",
    "we here focus on the minimum dissipated energy , @xmath193 , due to thermal fluctuations of the cantilever when it oscillates close to a surface .",
    "thermal driving forces are connected to the energy dissipation by the @xmath62 factor of the cantilever .",
    "the thermal kicks introduce fluctuations of amplitude and phase and therefore fluctuations of the energy dissipation .",
    "this is true for a free cantilever , but the contribution of the thermal noise is expected to be even more pronounced when the tip is close to the surface .",
    "then , the fluctuations of the interaction force @xmath194 have a strong influence on the nonlinear dynamics of the cantilever , in particular when the tip is at distances involving short - range forces where the nonlinearity is more pronounced .    the instrumental noise ( _ cf .",
    "_ ch.2 in refs .",
    "[ ] and [ ] ) , essentially due to electronic components , is not considered and we further assume that the electronic blocks ( rms - to - dc , pi controllers , pll ) operate perfectly . doing so , @xmath193 is under - estimated but the framework of this section is to provide a ground value to be compared to the values obtained with the simulation .",
    "the fluctuation of the dissipated energy _ per _ cycle can be connected to the fluctuation of damping @xmath196 , _ via _ equ.[equ_energylossintrinsic ]  :    @xmath197    besides , because @xmath198 on resonance and because the tip - sample interaction force @xmath199 can be treated , to first order  @xcite , on the same level as @xmath200 , a fluctuation of @xmath199 should produce , a fluctuation of damping  :    @xmath201    consequently  :    @xmath202      for large oscillation amplitudes ( that is larger than the minimum tip - surface distance , a few angstrms ) , @xmath199 is connected to the so - called normalized frequency shift  @xcite , @xmath203 , _ via _ the equation  @xcite ( _ cf .",
    "_ also ch.16 in ref . [ ] )  :    @xmath204    where @xmath205 and @xmath206 are the interaction potential and force , respectively , between the tip and the sample at a location @xmath207 . the fluctuation in the relative frequency shift @xmath208 , that is the cantilever frequency noise , due to a fluctuation of @xmath199",
    "is then given by  :    @xmath209      y.  martin _ et al .",
    "_  [ ] , t.r .",
    "albrecht _ et al . _  [ ] , h.  drig _ et al . _  [ ] and f.j .",
    "giessibl ( ch.2 in ref . [ ] ) have calculated the thermal limit of the frequency noise in frequency - modulation technique over a measurement bandwidth @xmath136 .",
    "it is given by  :    @xmath211    therefore , the dissipated energy due to thermal fluctuations of the cantilever close to the surface can be estimated to  :    @xmath212    the measurement bandwidth @xmath136 can be estimated out of the following considerations . as mentioned by f.j .",
    "giessibl ( _ cf .",
    "_ ch.2 in ref .",
    "[ ] ) , @xmath136 is a function of the scan speed @xmath213 and the distance @xmath214 between the features which need to be resolved  :    @xmath215    for uhv investigations , @xmath214 is of about one atomic lattice constant , that is a few angstrms . at room temperature , due to thermal drift , atomic scale images are usually recorded at scan speeds of about 6 lines ( 3 forwards plus 3 backwards ) _ per _ second .",
    "let s consider for instance a moderate resolution of @xmath51 pixels _ per _ atomic period .",
    "then , a line consisting of @xmath216 pixels should be acquired with a bandwidth @xmath217  hz .",
    "table [ table_edissvse0 ] gives some estimates of the relative dissipated energy due to thermal fluctuations of the cantilever @xmath218 close to the surface in the short - range or pure van der waals regimes at various temperatures and for various quality factors . in uhv at room temperature , our experimental conditions , the minimum dissipated energy which is detectable corresponds to @xmath219 of the intrinsic dissipated energy of the free cantilever .",
    "this corresponds to about 150  mev / cycle with typical conditions for uhv investigations carried out at room temperature ( _ cf . _",
    "equ.[equ_energylossintrinsic ] and discussion below ) .",
    "besides , as mentioned before , this value is underestimated .",
    "a straightforward consequence is that the strength of apparent dissipation should overcome this limit to be relevant . with a moderate quality factor in the van der waals regime like in high vacuum for instance ,",
    "the limit drops by almost a factor 3 ( @xmath220 ) .",
    "thus , apparent dissipation effects might occur more easily under these conditions  @xcite . at low temperatures , in the short - range regime",
    "the ratio is @xmath221 .",
    "however , this value is likely still too high because then , the thermal drift being drastically reduced , the measurement bandwidth can be lowered and apparent dissipation more likely to be measured .    .dissipated energy of the free cantilever @xmath79 ( equ.[equ_energylossintrinsic ] ) and dissipated energy due to thermal fluctuations of the cantilever close to the surface @xmath193 ( equ.[equ_deltaed ] ) for various quality factors and temperatures when van der waals plus short - range ( equ.[equ_force ] ) or pure van der waals forces ( similar equation , with @xmath222 ) are considered .",
    "the cantilever parameters are @xmath223  nm , @xmath163  khz , @xmath224  n.m@xmath72 and @xmath225  hz . the parameters of the interaction potential have been taken from ref . [ ]  : @xmath226  j , @xmath227  nm , @xmath228  j , @xmath229 , and @xmath230 .",
    "@xmath193 has been estimated at a distance @xmath207 for which the two interaction regimes are clearly distinct ( _ cf . _",
    "fig.[fig_forcedistance](a ) ) , @xmath231  @xmath232 . [ cols=\"^,^,^,^,^ \" , ]",
    "frequency shift _ vs. _ distance curves obtained from the simulation have first been compared to the analytic expression of @xmath10 due to van der waals and morse potentials ( _ cf .",
    "_ appendix , section a ) .",
    "the results are shown in fig.[fig_forcedistance](a ) .",
    "the parameters chosen to perform the simulation are consistent with typical parameters used during experiments performed in uhv .",
    "the parameters of the interaction potential have been taken from ref .",
    "they are representative of the interaction between a silicon tip and a silicon(111 ) facet .",
    "an excellent agreement is observed between numerical and analytic curves along the attractive and repulsive parts of the interaction potential , thus validating the numerical scheme .",
    "the parameters used to perform the calculation are given in the caption .",
    "let s also notice that the frequency tracker was engaged . in figs .",
    "[ fig_forcedistance](b ) , ( c ) and ( d ) , the variations of @xmath12 , @xmath113 and relative damping , respectively are reported _ vs. _ the tip - surface separation .",
    "phase and amplitude remain almost constant while approaching , within , however , deviations limited to @xmath233 compared to @xmath234  degrees and @xmath235  nm , respectively . in the repulsive part of the potential , steep phase changes occur , but the amplitude does not dramatically drops , at least up to @xmath236  hz .",
    "consequently , the relative damping remains constant .",
    "the dynamic behaviors of real and simulated plls have then been compared .",
    "the experiment consists in locking the pll onto a @xmath172  khz sinusoidal waveform according to the same procedure than in section [ subsubsection_ftracker ] .",
    "the @xmath52  khz fir low pass filter is used . at a certain moment",
    ", a frequency step of @xmath237  hz is applied to the center frequency , resulting in a shift of @xmath238  hz ( @xmath239 ) .",
    "the step response is recorded for various values of the so - called loop gain ( real pll ) and various values of @xmath240 ( simulation ) .",
    "the variations of @xmath10 _ vs. _ time are fitted with simple decaying exponential functions , the characteristic time of which stands for the locking time of the pll .",
    "the results are reported in figs.[fig_realvsvirtual](a ) and ( b ) .",
    "a rather long locking time is noticed for low values of the gains whereas the plls lock faster when the gains become larger .",
    "for the latter case , the plls can operate up to the limit of the locking range as shown by the oscillations .    the locking time deduced from each fit",
    "is plotted as a function of the gains of both plls . in order to make the curves comparable",
    ", the loop gain must be rescaled by an arbitrary constant which depends on the electronics .",
    "the best agreement between the curves was achieved with @xmath241 ( _ cf .",
    "_ fig.[fig_realvsvirtual_lockingtime ] ) . a single master curve of the pll dynamics can thus be extracted .",
    "the rather good agreement between the two curves provides evidence that the simulation reasonably describes the real component , at least within the locking range . for values of the gains up to @xmath242  rad.s@xmath72 ,",
    "the pll is stable and able to track frequency changes within the locking range around @xmath172  khz . above 6000  rad.s@xmath72",
    ", the pll introduces overshoot in the output waveform while attempting to lock the input signal . for higher gains ,",
    "the pll is not able to properly track the input signal , even though its frequency is within the locking range .",
    "the border is reached for @xmath243  rad.v@xmath72.s@xmath72 , in good agreement with the value expected from r.bests criterion ( _ cf .",
    "_ discussion in section [ subsubsection_fdemodulation ] ) .",
    "the arrow in fig.[fig_realvsvirtual_lockingtime ] indicates the usual loop gain value which is chosen to perform the experiments using the @xmath52  khz low pass filter , corresponding to @xmath244  rad.s@xmath72 .",
    "the related locking time of the pll is then @xmath245  ms . for those values of gains ,",
    "the locking range is about @xmath246  hz .      in order to extract a typical time constant of the component ,",
    "similar experiments have been carried out with the apics .",
    "the cantilever remaining far from the surface , a step is applied to the setpoint amplitude @xmath31 resulting in an abrupt change in @xmath113 upon gains .",
    "the results are reported in fig.[fig_apicstepresponse](a , real setup ) and ( b , simulated setup ) .",
    "the curves exhibit over- ( no overshoot at all ) under- ( oscillating behavior ) or critically damped ( single overshoot ) behaviors upon chosen gains .",
    "so as to extract the apic response time , we focus at curves which exhibit a single time constant , that is curves for which a weak overcritically or a critically damped response is observed ( _ cf . _",
    "insets in figs.[fig_apicstepresponse](a ) and ( b ) ) .",
    "this is motivated by the controller response which is then the fastest , while preserving an overall stable behavior . the changes in @xmath113 are fitted with decaying exponentials functions and the related characteristic time is extracted .",
    "the variation of the so - called response time of the controller ( @xmath247 ) _ vs. _ gains is reported in fig.[fig_apictimeresponse ] .",
    "the restriction to curves exhibiting a single time constant is similar to restricting the analysis to a single gain of the controller  @xcite .",
    "thus , a single master curve which describes the dynamics of both apics can be extracted as well . in fig.[fig_apictimeresponse ] , the @xmath14 gain of the real controller has been rescaled to make it matching @xmath114 ( the best rescaling factor is 1/40000 ) .",
    "@xmath247 decreases as @xmath114 increases ( being given a single @xmath115 _ per _",
    "@xmath114 ) .",
    "however , the controller is limited to an optimum @xmath247 of about @xmath27  ms as shown by the plateau reached for @xmath248  [ ] ( arrow in fig.[fig_apictimeresponse ] ) .",
    "so far , the origin of the saturation remains unclear .",
    "nevertheless , a brief analysis of the response function of the controller to a step wherein the contribution of the rms - to - dc converter is neglected ( _ cf .",
    "_ appendix , section b ) emphasizes that the dynamic behavior can reasonably be predicted ( triangles in fig.[fig_apictimeresponse ] ) up to @xmath27  ms . the best agreement between the experimental results and the model",
    "is found when considering the weak overcritically damped regime , namely  :    @xmath249    with  :    @xmath250    the origin of the saturation might thus be attributed to the contribution of the rms - to - dc converter .",
    "as expected , the shortest apic response time is approximately @xmath51 times longer than the optimal pll locking time , @xmath245  ms . thus the pll should track frequency changes much faster than amplitude changes . therefore , with pll gains insuring a locking time much shorter than the apic one , the two blocks can be considered as operating separately .",
    "then , no amplitude changes which would be the consequence of a bad tracking of the resonance frequency can occur .",
    "it might be objected that the experiments and the analysis , despite consistent , have been performed without considering the tip - sample interaction . regarding the pll , the way the dynamics",
    "is affected when the tip is close to the surface has not yet been investigated .",
    "but regarding the amplitude controller , couturier _ et al .",
    "_  [ ] have reported a theoretical analysis of the controller stability upon the gains and the strength of the non - linear interaction in the self - excitation scheme .",
    "the analysis stresses that the stability domain of the controller shrinks when the contribution of the non - linear interaction ( pure van der waals ) increases .",
    "thus , a couple ( @xmath114;@xmath115 ) initially inside the stability domain might correspond to an unstable behavior of the controller close to the surface , thus introducing apparent dissipation  @xcite .",
    "nevertheless , considering their parameters with a tip - surface distance ranging from infinity down to @xmath251  @xmath232 ( corresponding to @xmath252  hz ) , that is very close to the surface for operating in nc - afm  @xcite , the stability domain weakly shrinks  @xcite .",
    "a similar analysis for the pll - excitation scheme is still lacking and should be performed for quantitative comparison and discussion . but comparing their analysis to the tip - surface distances and frequency shifts which are being used in this work , we believe that the contribution of the non - linear interaction to the apic dynamics remains weak and thus would not change drastically its coupling to the pll .",
    "this point is strengthened by the results given in the following section ( [ subsubsection_pllgains ] ) .",
    "section [ subsubsection_plldynamics ] has proved that the pll gains were controlling the pll locking time . within the locking range , the higher @xmath253 , the faster the pll .",
    "the test performed here is to compute approach curves for various values of @xmath253 . except @xmath253 ,",
    "the parameters are similar to those given in fig.[fig_forcedistance ] .",
    "in particular , @xmath23 , @xmath254 and @xmath255  s@xmath72 , corresponding to @xmath256  ms .",
    "@xmath34 sets of @xmath240 have been used , namely  : @xmath257 , @xmath258 , @xmath259 and @xmath56  rad.s@xmath72 , corresponding to locking times of @xmath260  ms , @xmath261  ms , @xmath262  ms and @xmath263  ms , respectively . note that the two later values are almost similar or larger , respectively , than @xmath247 .",
    "the @xmath52  khz fir low pass filter has been used and the frequency tracker has been engaged .",
    "the results are reported in fig.[fig_pllgains ] .    with the four sets of data ,",
    "no effect on the frequency shift is observed . for @xmath264 and @xmath258  rad.s@xmath72 ,",
    "changes in phase , amplitude and damping are noticeably similar .",
    "the phase and the amplitude remain constant and subsequently , no damping occurs . on the opposite , for @xmath265 and @xmath56  rad.s@xmath72 ,",
    "that is for a pll locking time of about or larger than the apic one , the changes are more pronounced . with @xmath265  rad.s@xmath72 ( set 3 ) ,",
    "the phase strongly varies along the repulsive part of the interaction , from @xmath266 to @xmath267  degrees .",
    "consequently , the amplitude starts dropping and the damping increases .",
    "this trend is more pronounced with @xmath268  rad.s@xmath72 , for which the phase in the repulsive regime reaches @xmath269  degrees , requiring the apic to produce @xmath270 more excitation . according to the discussion put forward in section [ section_mindissdetect ]",
    ", such an effect is expected to be detected if it would occur .",
    "therefore , if the pll does not lock the incoming signal fast enough , that is for locking times of about or larger than @xmath20  ms , corresponding approximately to @xmath271 , an undesirable phase shifted signal is produced , resulting in an amplitude decrease and producing significant apparent dissipation .",
    "it s peculiar to notice that , when the cantilever is driven out of resonance as shown with the phase changes with @xmath272  rad.s@xmath72 , no abnormal frequency shift occurs . as a matter of fact , close to the resonance , the phase changes of the free cantilever scale as , to first order  : @xmath273 , where @xmath274 . considering @xmath163  khz and @xmath275  degrees , then @xmath276  hz , which is not visible in fig.[fig_pllgains](a ) .",
    "similar effects have been reported by h.hlscher _",
    "et al . _",
    "[ ] . this effect should be more ( less ) pronounced with low ( high ) @xmath62 values ( @xmath277  hz or @xmath278  hz with @xmath279 or @xmath280 , respectively ) and the apparent dissipation higher ( lower ) .      as mentioned in paragraph",
    "[ subsubsection_ftracker ] , the frequency tracker updates @xmath145 with the goal to prevent the phase due to the frequency shift , @xmath169 , be added to the nco output .",
    "figure [ fig_pllfrequtrack ] reports two approach curves computed upon the frequency tracker is engaged or not .",
    "when it is disengaged , the phase continuously decreases along the attractive part of the interaction potential , as expected from equ.[equ_phipll ] . at a tip - sample separation corresponding to the minimum of the interaction potential , @xmath281  @xmath232 , the phase reaches @xmath282  degrees , meaning that the oscillator is then seriously driven out of resonance . following the phase change , the amplitude continuously decreases and the damping strives to compensate the amplitude reduction , thus reaching @xmath0 of the intrinsic damping of the free oscillator . here again , such an effect should be measurable .",
    "when the tip is further approached towards the surface , the repulsive regime makes the frequency shift increasing and so does @xmath169 .",
    "the amplitude increases back to reach @xmath31 and the damping is obviously reduced .",
    "an amplitude growth is not expected in the repulsive region of the interaction potential , but it is the consequence of the bad tracking of the resonance frequency . on the other hand , when the tracker is engaged , as already mentioned , the phase remains constant and no apparent dissipation occurs .",
    "in addition to the analysis of the time constant of the various blocks , it is important to focus at variables changes when the tip is scanned along a surface . two types of surfaces have been investigated  : 1- a sinusoidally corrugated surface with a spatial wavelength of @xmath283 and a corrugation of @xmath284  nm , consistently with the lattice constant of kbr , a sample regularly used in the group , and 2- a surface with two opposite steps with a step height of @xmath285 .",
    "the steps are built out of @xmath286 functions and spread out laterally over @xmath287 .",
    "the upper terrace spreads out over @xmath52  nm ( _ cf .",
    "_ insets in fig.[fig_scanapic ] ) .",
    "the results shown here have all been obtained by @xmath10 regulation .",
    "the scan lines have been initiated from the approach curve shown in fig.[fig_forcedistance ] with @xmath288  hz , corresponding to an initial tip - surface separation of about @xmath287 , that is in the short - range regime ( _ cf . _",
    "fig.[fig_forcedistance](a ) ) .",
    "the gains of the distance controller have been chosen in order to insure a critically damped response of the controller to a step of @xmath289  hz when @xmath290 is reached , namely @xmath291  nm.hz@xmath72 and @xmath292  nm.hz@xmath72.s@xmath72 .",
    "for all of the following curves , the frequency tracker has been engaged .",
    "three sets of parameters have been varied  : the pll gains , the scan speed and the apic gains .",
    "paragraph [ subsubsection_plldynamics ] has proven how @xmath143 and @xmath123 gains were controlling the pll locking time .",
    "figure [ fig_scanpll ] shows scan lines computed for three values of @xmath240 , namely  : @xmath56 , @xmath259 and @xmath258  rad.s@xmath72 , corresponding to locking times @xmath263 , @xmath262 and @xmath261  ms , respectively .",
    "the unchanged parameters are  : scan speed @xmath293  nm.s@xmath72 , @xmath254 and @xmath255  s@xmath72 .",
    "the latter gains correspond to @xmath294  ms ( arrow in fig.[fig_apictimeresponse ] ) .",
    "each signal , namely topography , @xmath10 , @xmath12 , @xmath113 and relative damping , consists of 256 samples .",
    "the topography signal follows accurately the surface corrugation .",
    "no contribution due to the gains is revealed .",
    "@xmath10 is modulated around @xmath288  hz , with an amplitude ranging from @xmath295 to @xmath296  hz upon @xmath253 .",
    "the accuracy of the distance control is then of about @xmath297 .",
    "note also that the nonlinear interaction makes the modulation asymmetric around @xmath290 and the maxima are mismatched compared to the maxima of the surface .",
    "however , the mismatch does not depend on @xmath253 .",
    "if the pll is slow , a rather important phase lag is observed , ranging from @xmath298 to @xmath299 degrees , resulting in small amplitude changes . here also , the asymmetry around @xmath234  degrees is manifest and it s interesting , despite expected , to notice the doubling in the periodicity of the amplitude fluctuation .",
    "the related relative apparent damping fluctuates accordingly , reaching about @xmath300 , which should be experimentally detectable .",
    "five scan speeds ranging from @xmath20 to @xmath301  nm.s@xmath72 have been used , accordingly to typical experimental values for such a scan size .",
    "the unchanged parameters are  : @xmath302  rad.s@xmath72 , @xmath254 and @xmath255  s@xmath72 .",
    "the surface with opposite steps has been used and each signal consists of 256 samples .",
    "the results are given in fig.[fig_scanspeed ] . at high speed ,",
    "the topography channel starts being distorted as a consequence of a bad distance regulation as shown by the large @xmath10 variations .",
    "the phase varies accordingly , but within a narrower domain .",
    "therefore neither relevant variations of amplitude nor of relative damping ( @xmath303 only ) are revealed .",
    "similar experiments have been carried out by varying the apic gains .",
    "thirteen sets of @xmath114 and @xmath115 values have been used over 2 orders of magnitude for each gain .",
    "the unchanged parameters are  : scan speed @xmath304  nm.s@xmath72 and @xmath305  rad.s@xmath72 .",
    "the surface with opposite steps has been used . for those curves ,",
    "each signal consists of 1024 samples .",
    "the sets of gains have been chosen such that the response time of the controller is varied from @xmath27 to @xmath301  ms , according to fig.[fig_apictimeresponse ] .",
    "the results are reported in fig.[fig_scanapic ] . here again , the topography signal accurately follows the corrugation . in particular , no unwanted overshoot is observed at the step edge despite @xmath10 varies significantly .",
    "a small phase variation is observed at the step edge . for the latter three channels , no dependence",
    "is observed upon the gains such that the curves match each other .",
    "the small phase variation induces a tiny amplitude change , barely visible in the inset of fig.[fig_scanapic](d ) , but the overall fluctuations are weak , which corresponds to relative damping fluctuations of @xmath306 ( worse case , @xmath307  ms ) .",
    "following discussion of section [ section_mindissdetect ] , this value is below the threshold limit of thermal noise , at least for experiments carried out in uhv and at room temperature . upon gains ,",
    "a small spatial shift is observed in the amplitude or in the relative damping signals up to a maximum value of @xmath308  @xmath232 .",
    "the above analysis stresses five important results  :    * the pll dynamics plays a major role in the occurrence of relevant apparent damping if the locking time is about or larger than 1  ms , that is only twice faster than the apic optimum response time . by  relevant damping \" , we mean , on the base of the discussion given in section [ section_mindissdetect ] , a damping which would be detectable experimentally upon operating conditions ( _ cf .",
    "_ table [ table_edissvse0 ] ) . *",
    "the frequency tracker , the aim of which is to update the pll center frequency to make it matching the actual resonance frequency , plays also a major role in the occurrence of apparent damping .",
    "it has to be mandatorily engaged when performing approach - curves , otherwise unwanted additional phase shift due to the pll occurs and the cantilever is then driven off resonance . *",
    "the pll optimal locking time is about @xmath261  ms that is 6 times shorter than the shortest apic response time of the free cantilever .",
    "therefore the resonance condition is expected to be always properly maintained .",
    "consequently , when the pll operates properly , no amplitude changes due to a bad tracking of the resonance frequency are expected to occur .",
    "if they would , this should rather be the consequence of the apic and/or the dpic dynamics . *",
    "the apic response time seems to be limited to @xmath294  ms due to the rms - to - dc converter .",
    "there is _ a priori _ no fundamental restriction to the apic response time , as shown by fig.[fig_apictimeresponse ] .",
    "however , it must be stressed that if the apic is made faster , the pll should be made faster accordingly . * a weak contribution of the apic to apparent dissipation is observed .",
    "although spatial shift and apparent dissipation can conditionally be generated , the overall strength of the effect remains weak and should hardly be measurable for uhv investigations at room temperature .    in order to compare our results to other works ,",
    "the contribution of the noise ( equ.[equ_deltaed ] ) to the dissipation has been estimated with the parameters given by gauthier _",
    "et al . _",
    "the maximum of relative apparent damping they report is about @xmath219 ( _ cf . _",
    "fig.4 in the above reference , curve @xmath3096 ) , corresponding to a scanning speed of about @xmath310.s@xmath72 . the spatial wavelength of their surface model being @xmath311 , the bandwidth of the corresponding measurement is @xmath312  hz ( _ cf . _ equ.[equ_bandwidth ] ) . the non - linear interaction is depicted by a rydberg function with @xmath313  j , @xmath314 and @xmath315 . with @xmath316",
    "nm , @xmath317  hz , @xmath318  n.m@xmath72 , @xmath319 ( @xmath320  ev / cycle ) , we get @xmath321 at a distance  @xcite @xmath322 .",
    "therefore , due to the use of a low amplitude  @xcite , the strength of the effect would not be balanced by the noise and could be detectable experimentally .",
    "on the opposite , considering smaller scan speeds , the maximum of apparent dissipation decreases down to @xmath323 .",
    "such effects become then unlikely to be observed experimentally .    finally , let s note that the contribution of the third controller , the dpic , has not been assessed in this work .",
    "nevertheless , as mentioned by h.  hug and a.  baratoff  [ ] , in order to minimize feedback errors and resulting image distortions , the time constant of the distance controller must be shorter than the speed in the fast scanning direction / lateral extent of the smallest feature to be resolved and necessarily ( much ) larger than other time constants ( rms - to - dc , apic , pll ) . if those conditions are satisfied , then its contribution to the overall stability of the setup should be weak .",
    "this is what is readily seen in figs.[fig_scanpll ] , [ fig_scanapic ] and , to a certain extend in fig.[fig_scanspeed ] , with reasonable speeds .",
    "this is also confirmed by couturier _",
    "et al . _ who have recently found out that the distance controller had no effect on the stability diagram in the self - excitation scheme and that only the amplitude controller played a role  @xcite .    to summarize",
    ", this analysis has emphasized that a maximum of about @xmath0 of apparent dissipation , mainly due to the pll and not to the apic , could be generated ( _ cf .",
    "_ fig.[fig_scanpll ] ) .",
    "the contribution of the apic , within the range of gains used , is systematically smaller .",
    "we finally infer that , with our setup ( uhv and room temperature ) and under typical experimental conditions ( scanning speed , pll and apic gains ... ) corresponding to @xmath324  ev / cycle , apparent dissipation in the range of a few ev _ per _ cycle , as frequently reported in the literature , is unlikely to occur .",
    "a striking example is provided by r.  hoffmann _ et al . _  [ ] who put in evidence a dissipation of 3  ev / cycle on a nio(001 ) sample , despite operating at 4  k  [ ] .",
    "this strongly suggests the interpretation of the experimental damping images in terms of  physical \" dissipation .",
    "the realization and successful testing of a modular nc - afm simulator implemented with labview@xmath325 is reported .",
    "the design is based on a real electronics which includes a digital pll , the output of which is used to detect the frequency shift but also to generate the time dependent phase of the excitation signal .",
    "good agreement is obtained between the locking behavior of the real pll and the pll from the simulator .",
    "the optimum locking time of the pll is found to be about 0.35  ms .",
    "the behavior of the amplitude controller is also found to correctly describe the real setup with an optimum response of 2  ms .",
    "the analysis of the time constants of the former two components provides evidence that the electronics tracks properly the cantilever dynamics if the pll runs more than twice faster than the amplitude controller .",
    "when the system is operated with properly chosen parameters , frequency shift _ vs. _ distance curves successfully compare to an analytic expression which ignores the finite response of the electronics .",
    "no phase deviation resulting in apparent dissipation occur if the center frequency of the pll tracks the resonance frequency shifted by the tip - sample interaction .",
    "an estimate of the minimum dissipation expected to be detected experimentally gives some insights on the relevance of apparent dissipation which can conditionally be generated numerically .",
    "this provides a framework to discuss the overall contribution of apparent dissipation during experiments .",
    "computations of scan lines show that when the system is operated with experimentally relevant parameters , the contribution of the proportional and integral gains of the amplitude controller and the scan speed ( up to @xmath301  nm.s@xmath72 ) do not lead to significant apparent dissipation . to give orders of magnitude , the worse situation ( frequency tracker disengaged ) leads to a maximum of @xmath0 more dissipation than the intrinsic dissipation of the free cantilever .",
    "this is below the values which are experimentally reported .",
    "this strongly suggests that nc - afm damping images mainly reflect physical channels of dissipation and not electronics artifacts .    besides ref.@xcite",
    ", two publications dealing with the implementation and/or performance of  virtual force microscopes \" have appeared recently .",
    "these simulation codes are analogous to ours but differ in detail .",
    "kokavecz et al.@xcite proposed and tested a numerical scheme designed to produce response times of the whole simulated setup , as well as of separate blocks ( amplitude , phase and distance controllers ) as short as 0.1 ms .",
    "trevethan et al.@xcite used the scheme described in ref .",
    "@xcite to compute fingerprint - like responses in the frequency shift , the minimum tip - sample distance and the damping signal caused by an atomic - scale configuration change at the surface of the sample .",
    "this change was first predicted from atomistic simulations and then induced upon approach under distance control down to a judiciously chosen frequency setpoint .",
    "a manual describing the combined atomistic simulation@xcite and virtual force microscope codes is now available online@xcite .",
    "the authors acknowledge the swiss national center of competence in research on nanoscale science and the national science foundation for financial support .",
    "they are grateful to r.  bennewitz ( mac gill univ . ,",
    "canada ) , c.  loppacher ( dresden univ .",
    ", germany ) , to colleagues of the electronics workshop of the university of basel for discussions and advices , in particular ch .",
    "wehrle h .-",
    "hidber and m.  steinacher , to s.  gauthier , j.  polesel - maris and x.  bouju ( cemes , france ) for stimulating discussions on noise , h.  hug , n.  pilet and t.  ashworth ( basel univ . ) for discussions on the frequency tracker and to g.  couturier for having provided a copy of his poster presented at the 2004 nc - afm conference ( seattle , usa ) .",
    "10    s.  morita , r.  wiesendanger , and e.  meyer . .",
    "springer , berlin , germany , 2002 .",
    "r.  garcia and r.  prez .",
    "dynamic atomic force microscopy methods . , 47:197301 , 2002 .",
    "advances in atomic force microscopy . , 75:949983 , 2003 .",
    "albrecht , p.  grtter , d.  horne , and d.  rugar . .",
    ", 69:668 , 1991 .",
    "u.  drig , o.  zger , and a.  stalder . .",
    ", 72(5):1778 , 1992 .",
    "m.  guggisberg , m.  bammerlin , c.  loppacher , o.  pfeiffer , a.  abdurixit , v.  barwich , r.  bennewitz , a.  baratoff , e.  meyer , and h.j .",
    "separation of interactions by non - contact force microscopy . ,",
    "61:11151 , 2000 .",
    "m.  gauthier , r.  prez , t.  arai , m.  tomitori , and m.  tsukada .",
    "interplay between nonlinearity , scan speed , damping and electronics in frequency modulation atomic force microscopy .",
    ", 89(14):146104 , 2002 .",
    "g.  couturier , r.  boisgard , l.  nony , and j .-",
    "noncontact atomic force microscopy : stability criterion and dynamical responses of the shift of frequency and damping signal . , 74(5):27262734 , 2003 .    roland  e. best . .",
    "mc graw - hill , new york , @xmath326 edition edition , 1999 .",
    "b.  gotsmann , c.  seidel , b.  anczykowski , and h.  fuchs .",
    "conservative and dissipative tip - sample interaction forces probed with dynamic afm .",
    ", 60(15):11051 , 1999 .    c.  loppacher , m.  bammerlin , m.  guggisberg , s.  schr , r.  bennewitz , a.  baratoff , e.  meyer , and h.j .",
    "gntherodt . . ,",
    "62(24):1694416949 , 2000 .    c.  loppacher , r.  bennewitz , o.  pfeiffer , m.  guggisberg , m.  bammerlin , s.  schr , v.  barwich , a.  baratoff , and e.  meyer . . ,",
    "62(20):1367413679 , 2000 .",
    "r.  bennewitz , a.s .",
    "foster , l.n .",
    "kantorovich , m.  bammerlin , c.  loppacher , s.  schr , m.  guggisberg , e.  meyer , h.j .",
    "gntherodt , and a.l .",
    "shluger . . ,",
    "62(3):20742084 , 2000 .",
    "b.  gotsmann and h.  fuchs . .",
    ", 86(12):25972600 , 2001 .",
    "p.m. hoffmann , s.  jeffery , j.b .",
    "pethica , h.  zer , and a.  oral .",
    "energy dissipation in atomic force microscopy and atomic loss processes .",
    ", 87(26):265502 , 2001 .",
    "giessibl , m.  herz , and j.  mannhart . .",
    ", 99(19):1200612010 , 2002 .",
    "r.  hoffmann , m.a .",
    "lantz , h.j .",
    "hug , p.j.a .",
    "van schendel , p.  kappenberger , s.  martin , a.  baratoff , and h.j .",
    "gntherodt . .",
    ", 67:085402 , 2003 .",
    "o.  pfeiffer , l.  nony , r.  bennewitz , a.  baratoff , and e.  meyer . .",
    ", 15:s101s107 , 2004 .",
    "s.  hembacher , f.j .",
    "giessibl , j.  mannhart , and c.f .",
    "local spectroscopy and atomic imaging of tunneling current , forces , and dissipation on graphite .",
    ", 94:056101 , 2005 .",
    "m.  gauthier and m.  tsukada .",
    "theory of noncontact dissipation force microscopy .",
    ", 60(16):11716 , 1999 .",
    "n.  sasaki and m.  tsukada . .",
    ", 39:l1334l1337 , 2000 .",
    "m.  gauthier and m.  tsukada . damping mechanism in dynamic force microscopy .",
    ", 85(25):5348 , 2000 .",
    "u.  drig .",
    "interaction sensing in dynamic force microscopy . , 2:5.15.12 , 2000 .",
    "stochastic friction force mechanism of energy dissipation in noncontact force microscopy .",
    ", 64:245409 , 2001 .",
    "r.  boisgard , j .-",
    "aim , and g.  couturier . .",
    ", 188:363371 , 2002 .",
    "r.  boisgard , j .-",
    "aim , and g.  couturier . .",
    ", 511:171182 , 2002 .",
    "t.  trevethan and l.  kantorovich .",
    "physical dissipation mechanisms in non - contact atomic force microscopy . 15:s44s48 , 2004 .",
    "t.  trevethan and l.  kantorovich .",
    "atomistic simulations of the adhesion mechanism of atomic scale dissipation in non - contact atomic force microscopy . 15:s34s39 , 2004 .",
    "kantorovich and t.  trevethan .",
    "general theory of microscopic dynamical response in surface probe microscopy : from imaging to dissipation .",
    ", 93:236102 , 2004 .    .    g.  couturier , l.  nony , r.  boisgard , and j .-",
    "stability of an oscillating tip in noncontact atomic force microscopy : theoretical and numerical investigations .",
    ", 91(4):25372543 , 2002 .",
    "j.  polesel - maris and s.gauthier . a virtual dynamic atomic force microscope for image calculations .",
    ", 97:044902 , 2005 .    c.  loppacher , m.  bammerlin , f.m .",
    "battiston , m.  guggisberg , d.  mller , h .- r .",
    "hidber , r.  lthi , e.  meyer , and h.j .",
    "gntherodt . .",
    ", 66:215 , 1998 .",
    "analog  devices : http://www.analog.com ; intersil : http://www.intersil.com/cda/home ; burr - brown :  http://www.burr brown.com .",
    "rapaport . .",
    "cambridge university press , cambridge , 1995 .",
    "forces and frequency shifts in atomic - resolution dynamic - force microscopy .",
    ", 56(24):1601016015 , 1997 .",
    "ke , t.  uda , and k.  teakura .",
    "quantity measured in frequency - shift - mode atomic - force microscopy : an analysis with a numerical model .",
    ", 59:1326713272 , 1999 .",
    "y.  martin , c.c .",
    "williams , and h.k .",
    "wickramasinghe . .",
    ", 61(10):47234729 , 1987 .",
    "u.  drig , h.r .",
    "steinauer , and n.  blanc .",
    "dynamic force microscopy by means of the phase - controlled oscillator method .",
    ", 82:36413651 , 1997 .",
    "r.  prez , i.  stich , m.c .",
    "payne , and k.  terakura .",
    "surface - tip interactions in noncontact atomic - force microscopy on reactive surfaces : si(111 ) .",
    ", 58:1083510849 , 1998 .",
    "h.  hlscher , b.  gotsmann , w.  allers , u.d .",
    "schwarz , h.  fuchs , and r.  wiesendanger .",
    "measurement of conservative and dissipative tip - sample interaction forces with a dynamic force microscope using the frequency modulation technique . , 64:075402 , 2001 .",
    "g.  couturier , r.  boisgard , d.  dietzel , and j .-",
    "aim . damping and instability in non - contact atomic force microscopy : the contribution of the instrument . 16:13461353 , 2005 .",
    "l.  nony , r.  boisgard , and j .-",
    "stability criterions of an oscillating tip - cantilever system in dynamic force microscopy . , 24:221229 , 2001 .",
    "giessibl and h.  bielefeldt . physical interpretation of frequency - modulation atomic force microscopy . ,",
    "61(15):9968 , 2000 .",
    "j. kokavecz and z. toth and z.l .",
    "horvath and p. heszler and a. mechler novel amplitude and frequency demodulation algorithm for a virtual dynamic atomic force microscope .",
    ", 17:s173s177 , 2006 .",
    "t. trevethan and m. watkins and l. n. kantorovich and a. l. shluger and j. polesel - maris and s. gauthier .",
    "modelling atomic scale manipulation with the non - contact atomic force microscope .",
    "17:s5866s5874 , 2006 .    `",
    "the analytical method gives analytical , tractable expressions of the frequency shift versus distance upon the force expression .",
    "couple of years ago , f.j .",
    "giessibl and m.guggisberg have proposed approached expressions for the frequency induced by a morse potential  @xcite . here",
    "a complete expression is provided .",
    "the following calculation is based on a variational method extensively detailed in former articles  @xcite .",
    "we start from equation [ equ_otcs ] and postulate a solution of the differential equation where the amplitude and the phase are not constant , but are allowed to vary slowly within time , that is over durations much longer than the oscillating period , namely  :    @xmath327\\ ] ]    equation [ equ_otcs ] is then equivalent to  :    @xmath328    with  :    @xmath329 ^ 2\\right\\}a(t)+\\frac{2}{m}\\tilde{f_c}\\\\ \\beta = a(t)\\ddot{\\varphi}(t)+\\left[2\\dot{a}(t)+\\frac{\\omega_0}{q}a(t)\\right]\\left [ \\omega+ \\dot{\\varphi}(t)\\right]+\\frac{2}{m}\\tilde{f_d}\\\\ \\gamma=\\omega_0 ^ 2k_3 a_{exc } \\end{array } \\right.\\ ] ]    @xmath330 and @xmath331 are the first fourier components of the conservative and dissipative forces experienced by the tip over one oscillation period @xmath332 , respectively  :    @xmath333    setting @xmath334 yields to the steady equations of the oscillator in amplitude and phase out of which the relevant variables , namely @xmath335 and driving amplitude , related to the damping , can be extracted  :    @xmath336    equation [ equ_conscontribution2 ] illustrates that , if the phase is properly maintained at @xmath13  rad , the frequency shift is essentially due to the conservative interaction , whatever the dissipative contribution . besides , equ.[equ_conscontribution2 ] gives the well known expression of the frequency shift due to the conservative contribution  @xcite  :    @xmath337    the expression of @xmath330 related to the morse potential given in equ.[equ_force ] can be integrated analytically  :    @xmath338    where  :    @xmath339    @xmath340 is the modified bessel function of first kind for the parameters @xmath341 and @xmath342 . as shown by equ.[equ_conscontribution ] , the method not only requires to estimate the action related to @xmath343 , but also its derivative with respect to the amplitude @xmath11  :    @xmath344    regarding the van der waals contribution , it was demonstrated  @xcite  :    @xmath345    the frequency shift due to both contributions can finally be deduced  :    @xmath346\\ ] ]      the problem consists in analyzing the dynamics of the oscillator the amplitude of which is controlled by a proportional - integral controller . for that purpose ,",
    "all the components are assumed to be linear .",
    "no interaction occurs between the oscillator and the surface .",
    "the contributions of the rms - to - dc and of the band pass filter are neglected .",
    "the system under investigation is given in figure [ fig_apictheo ] .",
    "we start from the set of equations [ equ_sysref ] wherein the phase is assumed to be constant and fixed to @xmath347 .",
    "this assumption is argued by the pll behavior which maintains the phase almost constant , even when the interaction occurs ( _ cf .",
    "[ fig_forcedistance](b ) ) .",
    "the assumption implies  : @xmath348 , @xmath349 and obviously , we only focus at changes occurring in the resonance amplitude @xmath350 .",
    "the set of equations [ equ_sysref ] is then equivalent to  :    @xmath351    keeping @xmath352 yields to  :    @xmath353    the transfer function of the block standing for the oscillator can thus be written  : @xmath354    where  :    @xmath355    the transfer function of the apic being @xmath356 , the transfer function of the closed loop @xmath357 can now be calculated  :    @xmath358    with  :    @xmath359    the proportional and integral gains are scaled by the transfer functions of the piezoelectric actuator and of the photodiodes , @xmath71 and @xmath87 , respectively .",
    "equation [ equ_tf_closedloop ] has two poles  :    @xmath360    where @xmath361 is the parameter given in equation [ equ_c ] , which can also be written  :    @xmath362    equation [ equ_tf_closedloop ] is thus almost analog to a standard @xmath363 order system , the canonical form of which can be written  :    @xmath364    where @xmath365 and @xmath366 are the characteristic frequency and damping factor of the system , respectively .",
    "thus  :    @xmath367    now , it s well known that the position of @xmath366 with respect to 1 defines the overall behavior of the system  :    @xmath368      to assess",
    "how fast the controller reacts , we investigate the response of the controller to a step in amplitude upon it is in the over- , under- or critically damped regime .",
    "let s assume a step of amplitude @xmath369 , the corresponding transfer function is @xmath370 and the transfer function of the closed loop system to which the step is applied is therefore @xmath371 , that is  :    @xmath372    the time - dependent solutions @xmath373 are  :    * overcritically damped regime  : @xmath374 + @xmath375 with @xmath376 and @xmath377 .",
    "* critically damped regime  : @xmath378 @xmath379te^{-ct }      \\right\\}\\ ] ] * undercritically damped regime  : @xmath380 @xmath381\\right\\}\\ ] ] with @xmath382 .",
    "the transition from the over to the under critically damped regime is thus controlled by the parameter @xmath361 , that is the proportional gain , and occurs when the condition @xmath378 is fulfilled . in the critically damped regime ,",
    "the relationship between the two gains is  :    @xmath383    the time constant of the system can be extracted upon the regime and the time scale that are considered . for short time scales , the response time of the controller is typically @xmath384 in the critically damped regime and @xmath385 in the overcritically damped regime ( _ cf . _",
    "equ.[equ_gcls_over ] ) , which is given in equation [ equ_timeresponseapic ] .",
    "figure [ fig_apictimeresponse ] shows that the response times of the real system and of the simulated machine reasonably match @xmath247 while the rms - to - dc converter has a negligible influence on the system dynamics .",
    "+    khz sinusoidal waveform sent to the real pll and the pll output waveform ( @xmath175  khz ) when tuning the input frequency from @xmath173 to @xmath174  hz upon the frequency tracker is engaged or not .",
    "the 3khz fir low pass filter has been used .",
    "when the tracker is disengaged , the phase lag can reach @xmath176  degrees ( continuous black line , amplitude of the input waveform  : @xmath386  mv peak - to - peak ) .",
    "when it is engaged , the phase lag drops to almost zero ( dotted black line and inset , similar input waveform ) .",
    "when the input frequency accurately matches the center frequency , the shift is zero ( modulo an error corresponding to a few fractions of degrees as shown in the inset).,title=\"fig:\",height=302 ] +    nm , @xmath163  khz , @xmath387  n.m@xmath72 , @xmath23 , therefore @xmath388",
    "s@xmath72 and @xmath389  ev / cycle , @xmath390  v.nm@xmath72 , @xmath391  nm.v@xmath72 , @xmath392  v , @xmath393  rad.v@xmath72.s@xmath72 , @xmath254 , @xmath255  s@xmath72 , approach speed @xmath27  nm.s@xmath72 .",
    "the parameters of the interaction potential have been taken from ref .",
    "[ ]  : @xmath226  j , @xmath227  nm , @xmath228  j , @xmath229 , and @xmath230 . except in ( a )",
    ", the signals are monitored at @xmath33  khz .",
    "( a)- comparison between the @xmath10 computed numerically ( open circles ) and the analytic expression of @xmath10 ( thick grey line ) due to van der waals and morse interactions ( equ.[equ_deltafanalyt ] ) .",
    "the two curves match accurately along the attractive and repulsive parts of the interaction potential . for clarity reasons , 10 times",
    "less samples are displayed compared to plots shown in ( b ) , ( c ) and ( d ) .",
    "the dotted line depicts the analytic @xmath10 due to a pure van der waals potential , thus showing where the short- and long - range interaction regimes are discernable .",
    "( b)- phase lag , @xmath12 .",
    "the frequency tracker being engaged , the phase remains constant and equal to @xmath234  degrees within deviations limited to @xmath233 , thus maintaining the cantilever driven on resonance .",
    "( c)- amplitude @xmath394 .",
    "since no phase variation occur , the amplitude remains constant as well throughout the approach .",
    "( d)- relative damping.,title=\"fig:\",height=415 ] +    hz at @xmath175  khz , resulting in a @xmath10 of @xmath238  hz .",
    "for this experiment , no interaction between the tip and the surface occurs .",
    "the various curves represent the experiments carried out for various values of the related gains of the plls denoted by the symbols .",
    "the pll output is recorded at @xmath33  khz .",
    "the curves are fitted with a decaying exponential ( thick continuous lines ) out of which the pll  locking time \" is extracted .",
    "they are displayed over similar relative ranges.,title=\"fig:\",height=245 ] +     and loop gain@xmath395 .",
    "the locking times are obtained from the related step response curves ( figs.[fig_realvsvirtual](b ) and ( a ) , respectively ) .",
    "the error bars depict the uncertainty on the fitted value of the locking time ( @xmath396 ) .",
    "the arrow indicates the value of the loop gain used experimentally which corresponds to an optimum behavior of the pll and a related locking time of about 0.35  ms .",
    "the curve is given as guide eyes.,title=\"fig:\",height=302 ] +     step . to perform the experiments ,",
    "the related plls are engaged ( frequency trackers as well ) .",
    "the @xmath52  khz fir low pass filter has been used .",
    "no interaction between the tip and the surface occurs .",
    "the cantilever properties are @xmath397  hz and @xmath398 . to perform the calculation ,",
    "since the cantilever stiffness was not accurately known , we have arbitrarily chosen @xmath387  n.m@xmath72 , in reasonable agreement with manufacturer s datasheet .",
    "the other numerical parameters are similar to those given in fig.[fig_forcedistance ] .",
    "the curves depict the experiments carried out for various values of @xmath114 and @xmath115 gains .",
    "three behaviors are observed  : overcritically damped responses without overshoot , critically damped responses with a slight overshoot and undercritically damped responses with an oscillating behavior .",
    "the insets show them for couple of curves which have been arbitrarily shifted along the time axis , but note that the relative ranges are similar.,title=\"fig:\",height=245 ] +     of the simulated setup and the rescaled @xmath14 gain of the real controller .",
    "the best agreement between the curves is obtained with @xmath399 .",
    "the two curves match with a reasonable agreement and exhibit two domains  : first the response time decreases when increasing @xmath114 and then a saturation is reached corresponding to @xmath294  ms .",
    "the dotted line is given as guide eyes .",
    "such an analysis can be performed assuming that the step response is governed by a single time constant , thus restricting the analysis to curves which exhibit an almost critically damped behavior ( _ cf . _",
    "the triangles depict the trace of the function @xmath247 ( equ . [ equ_timeresponseapic ] ) with @xmath397  hz , @xmath398 , @xmath390  v.nm@xmath72 and @xmath391  nm.v@xmath72 .",
    "the arrow denotes the value of the gain used to perform the scan lines ( _ cf . _ section [ section_results ] ) . beyond @xmath254 , a noticeable discrepancy between the theoretical model and the experiments",
    "is observed which might be due to the contribution of the rms - to - dc converter.,title=\"fig:\",height=302 ] +     to @xmath34 ) of @xmath240 of the pll gains , namely  : @xmath257 ( continuous black line ) , @xmath258 ( continuous grey line ) , @xmath259 ( dotted black line ) and @xmath56  rad.s@xmath72 ( dotted grey line ) , corresponding to locking times of 0.2 , 0.35 , 1.8 and @xmath263  ms , respectively .",
    "( a)- @xmath10 , the curves are all matching each other .",
    "( b)- phase lag @xmath12 , ( c)- amplitude @xmath394 and ( d)- relative damping . except @xmath253 ,",
    "the parameters are similar to those given in fig.[fig_forcedistance ] , in particular @xmath254 and @xmath255  s@xmath72 corresponding to @xmath294  ms .",
    "when the pll locking time is larger than @xmath247 ( set @xmath34 , @xmath268 ) , the resonance is not properly locked , which induces a phase shift .",
    "consequently , the amplitude decreases and the damping increases.,title=\"fig:\",height=415 ] +    , ( b)- phase lag @xmath12 , ( c)- amplitude @xmath394 and ( d)- relative damping .",
    "the parameters are similar to those given in the caption of fig.[fig_forcedistance ] .",
    "when not engaged , the phase continuously drifts during the approach due to the increase of the attractive interaction meaning that the oscillator is not driven on resonance .",
    "subsequently , the amplitude drops and the apic strives to keep it constant by increasing the excitation .",
    "@xmath0 more excitation is thus produced , that is above thermal noise ( _ cf .",
    "_ section [ section_mindissdetect]).,title=\"fig:\",height=415 ] +    rad.s@xmath72 ( continuous black line ) , @xmath259  rad.s@xmath72 ( continuous grey line ) and @xmath258  rad.s@xmath72 ( dotted black line ) .",
    "the scan lines have been initiated from the approach curve shown on fig.[fig_forcedistance ] by @xmath10 regulation using @xmath400  hz .",
    "the lateral scan speed is @xmath401  nm.s@xmath72 and the section consists of 256 samples . @xmath291  nm.hz@xmath72 and @xmath292  nm.hz@xmath72.s@xmath72 , corresponding to a critically damped response of the controller to a frequency step of @xmath289  hz .",
    "( a)- topography .",
    "( b)- frequency shift .",
    "( c)- phase lag @xmath12 .",
    "( d)- amplitude @xmath117 and ( e)- relative damping .",
    "no noticeable effect is revealed on the topography .",
    "the apparent dissipation remains below the thermal noise ( _ cf .",
    "_ section [ section_mindissdetect ] ) , except if the pll is slow ( @xmath272  rad.s@xmath72 , @xmath402).,title=\"fig:\",width=529 ] +    ) , 2 ( @xmath403 ) , 5 ( @xmath404 ) , 10 ( @xmath405 ) and 20  nm.s@xmath72 ( @xmath406 ) . for clarity reasons ,",
    "the right hand side step region has been magnified .",
    "the insets show the whole section .",
    "the scan lines have been initiated upon the same conditions than in fig.[fig_scanpll ] with @xmath244  rad.s@xmath72 , @xmath254 and @xmath407  s@xmath72 .",
    "the high speeds require to reduce the number of samples _ per _ line to 256 .",
    "the gains of the distance controller are similar to those given in fig.[fig_scanpll ] .",
    "( a)- topography .",
    "( b)- frequency shift .",
    "( c)- phase lag @xmath12 .",
    "( d)- amplitude @xmath117 and ( e)- relative damping . at high scan speeds ,",
    "the topography is slightly distorted , but the overall damping remains weak and below the thermal noise ( _ cf .",
    "_ section [ section_mindissdetect]).,title=\"fig:\",width=529 ] +    s@xmath408 , @xmath409 , @xmath410 , @xmath411 , @xmath412 , @xmath413 , @xmath414 , @xmath415 , @xmath416 , @xmath417 and @xmath418 .",
    "the scan lines have been initiated upon the same conditions than in fig.[fig_scanpll ] with @xmath244  rad.s@xmath72 .",
    "the lateral scan speed is @xmath42  nm.s@xmath72 and the section consists of 1024 samples .",
    "the gains of the distance controller are similar to those given in fig.[fig_scanpll ] .",
    "( a)- topography .",
    "( b)- frequency shift .",
    "( c)- phase lag @xmath12 .",
    "( d)- amplitude @xmath117 and ( e)- relative damping .",
    "the apic gains have a negligible effect on the topography . a weak apparent damping ( @xmath419 , that is not experimentally relevant )",
    "is revealed at the step if the apic is slow , corresponding to @xmath420  ms.,title=\"fig:\",width=529 ] +"
  ],
  "abstract_text": [
    "<S> a simulation of an atomic force microscope operating in the constant amplitude dynamic mode is described . </S>",
    "<S> the implementation mimics the electronics of a real setup which includes a digital phase locked loop ( pll ) . </S>",
    "<S> the pll is not only used as a very sensitive frequency detector , but also to generate the time - dependent phase - shifted signal which drives the cantilever . </S>",
    "<S> the optimum adjustments of individual functional blocks and their joint performance in typical experiments are determined in details . prior to testing the complete setup , </S>",
    "<S> the performances of the numerical pll and of the amplitude controller were ascertained to be satisfactory compared to those of the real components . </S>",
    "<S> attention is also focussed on the issue of apparent dissipation , that is of spurious variations in the driving amplitude caused by the non - linear interaction occurring between the tip and the surface and by the finite response times of the various controllers . </S>",
    "<S> to do so , an estimate of the minimum dissipated energy which is detectable by the instrument upon operating conditions is given . </S>",
    "<S> this allows to discuss the relevance of apparent dissipation which can be conditionally generated with the simulator in comparison to values reported experimentally . </S>",
    "<S> the analysis emphasizes that apparent dissipation can contribute to the measured dissipation up to @xmath0 of the intrinsic dissipated energy of the cantilever , but can be made negligible when properly adjusting the controllers , the pll gains and the scan speed . </S>",
    "<S> it is inferred that the experimental values of dissipation reported can not only originate in apparent dissipation , which favors the hypothesis of  physical \" channels of dissipation . </S>"
  ]
}