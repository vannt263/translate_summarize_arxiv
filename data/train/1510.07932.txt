{
  "article_text": [
    "energy harvesting from environment resources ( e.g. , through solar panels , wind power , or geo - thermal power ) is a potential technique to reduce the energy cost of operating the base stations ( bss ) in emerging multi - tier cellular networks .",
    "while this solution may not be practically feasible for macrocell base stations ( mbss ) due to their high power consumption and stochastic nature of energy harvesting sources , it is appealing for small cell bss ( sbss ) that typically consume less power  @xcite . providing grid power to all sbss may not always be feasible due to their possible outdoor / remote / hard - to - reach locations .",
    "wireless energy harvesting thus enables dense deployment of sbss irrespective of the availability of grid power connections . in general ,",
    "wireless energy harvesting can be classified into the following two categories : ambient energy harvesting and dedicated energy harvesting . in the former case , energy harvested from renewable energy sources ( such as thermal , solar , wind ) as well as the energy harvested from the radio signals in the environment",
    "can be sensed by energy - harvesting receivers . in the latter case ,",
    "energy from dedicated sources is transmitted to energy - harvesting devices to charge them wirelessly .    designing efficient power control policies with different objectives ( e.g. ,",
    "maximizing system throughput ) is among one of the major challenges in energy - harvesting networks . in @xcite ,",
    "the authors proposed an offline power control policy for two - hop transmission systems assuming energy arrival information at the nodes .",
    "the optimal transmission policy was given by the directional water filling method .",
    "in @xcite , the authors generalized this idea to the case where many sources supply energy to the destinations using a single relay .",
    "a water filling algorithm was proposed to minimize the probability of outage .",
    "although the offline power control policies provide an upper bound and heuristic for online algorithms , the knowledge of energy / data arrivals is required which may not be feasible in practice . in @xcite ,",
    "the authors proposed a two - state markov decision process ( mdp ) model for a single energy - harvesting device considering random rate of energy arrival and different priority levels for the data packets .",
    "the authors proposed a low - cost balance policy to maximize the system throughput by adapting the energy harvesting state , such that , on average , the harvested and consumed energy remain balanced .",
    "recently , in @xcite , the outage performance analysis was conducted for a multi - tier cellular network in which all bss are powered by the harvested energy . a detailed survey on energy harvesting systems",
    "can be found in @xcite where the authors summarized the current research trends and potential challenges .",
    "compared to the existing literature on energy - harvesting systems , this paper considers the power control problem for downlink transmission in two - tier macrocell - small cell networks considering stochastic nature of the energy arrival process at the sbss .",
    "in particular , we assume that ambient energy harvesting is exploited at a central energy storage ( ces ) from where energy can be transferred to the sbss , for example , by using dedicated power beacons ( pbs ) .",
    "pbs are low - cost devices that can potentially charge wireless terminals by transferring energy in a directional manner .",
    "note that the power control policies at the mbs and the sbss and their resulting interference levels directly affect the overall system performance .",
    "the design of efficient power control policies is thus of paramount importance . in the above context",
    ", we formulate a discounted stochastic game model in which all sbss form a coalition to compete with the mbs in order to achieve the target signal - to - interference - plus - noise ratio ( @xmath0 ) of their users through transmit power control .",
    "that is , the mbs and the ces ( which actually represents the set of sbss in the game ) compete to achieve the desired @xmath0 targets of macrocell users and small cell users , respectively .",
    "note that both the mbs and the sbss transmit in the same channel ( i.e. , a co - channel deployment scenario is considered ) .",
    "therefore , the competition ( or conflict ) arises due to the resulting cross - tier interference , i.e. , as the mbs uses more power / energy to increase the utility of macrocell users , it results in higher cross - tier interference to small cell users .",
    "similarly , the more energy / power the ces assigns to sbss , the higher would be the cross - tier interference to macrocell users .",
    "note that the energy harvesting component is an important factor that indirectly contributes to the conflict .",
    "if the energy arrival rate is large , the sbss will have a larger energy pool to spend and thus cause more interference . clearly , we need to take into the account the probability of energy arrival when determining the optimal transmit power policy for each sbs . the amount of available energy at the transmitter will vary according the amount of power transmitted and the energy arrival during each transmission interval .",
    "naturally , the competition above can be modeled and analyzed by game theoretic tools . however , unlike in traditional power control games , the actions and the payoffs of the transmitters at successive transmission intervals are correlated .",
    "this correlation is taken into account in the proposed stochastic game model .",
    "for this game model , the nash equilibrium power control policy is obtained as the solution of a quadratic programming problem . for the case",
    "when the number of sbss is very large ( i.e. , an ultra - dense small cell network ( scn ) @xcite ) , the stochastic game is approximated by a mean field game ( mfg ) . in general , mfgs are designed to study the strategic decision making in very large populations of interacting individuals .",
    "recently , in @xcite , the authors proposed an mfg model to determine the optimal power control policy for a finite battery powered scn with no energy replacements .",
    "however , the stochastic nature of energy arrival for small cells was not considered . in this paper",
    ", we will consider the case where the battery can be recharged using random energy arrivals . by solving a set of forward and backward partial differential equations ,",
    "we derive a distributed power control policy for each sbs using a stochastic mfg model .",
    "the contributions of the paper can be summarized as follows .    1 .   for a two - tier macrocell - small cell network ,",
    "we consider a centralized energy harvesting mechanism for the sbss in which energy is harvested and then distributed to the sbss through a ces . unlike in @xcite , the ces can have any finite number of energy levels in its storage , not only 0 and 1 .",
    "note that the concept of ces is somewhat similar to the concept of dedicated power beacons for wireless energy transfer to users in cellular networks  @xcite .",
    "moreover , in a cloud - ran architecture  @xcite , where along with data processing resources , a centralized cloud can also act as an energy farm that distributes energy to the remote radio heads each of which acts as an sbs .",
    "note that the sbss are not restricted to indoor deployments .",
    "subsequently , we formulate the power control problem for the mbs and sbss as a discrete single - controller stochastic game with two players . also ,",
    "in this paper , we use the signal - to - interference - plus - noise - ratio ( sinr ) model instead of an snr model which has been commonly used in other research works on energy harvesting communication .",
    "consideration of random energy arrivals along with both co - tier and cross - tier interferences in the downlink power control problem is the major novelty of the paper .",
    "2 .   the existence of the nash equilibrium and pure stationary strategies for this single - controller stochastic game is proven .",
    "the power control policy is derived as the solution of a quadratic - constrained quadratic programming problem .",
    "when the network becomes very dense , a stochastic mfg model is used to obtain the power control policy as a solution of the forward and backward differential equations . in this case , each sbs can harvest , store energy and transmit data by itself .",
    "an algorithm using finite difference method is proposed to solve these forward - backward differential equations for the mfg model .",
    "numerical results demonstrate that the proposed power control policies offer reduced outage probability for the users served by the sbss when compared to the power control policies using a simple stackelberg game wherein each sbs tries to obtain the target @xmath0 of its users without considering the distribution of energy arrivals .",
    "the rest of the paper is organized as follows .",
    "section ii describes the system model and assumptions .",
    "the formulation of the single - controller stochastic game model for multiple sbss is presented in section  iii . in section",
    "iv , we derive the distributed power control policy using a mfg model when the number of sbss increases asymptotically .",
    "performance evaluation results are presented in section  v before the paper is concluded in section vi .",
    "we consider a single macrocell overlaid with @xmath1 small cells .",
    "the downlink co - channel time - slotted transmission of the mbs and sbss is considered and it is assumed that each bs serves only a single user on a given transmission channel during a transmission interval ( e.g. , time slot ) .",
    "the mbs uses a conventional power source and its transmit power level is quantized  @xcite into a discrete set of power levels @xmath2 , where the subscript @xmath3 denotes the mbs . on the other hand ,",
    "the sbss receive energy from a centralized energy storage ( ces ) , which harvests renewable energies from the environment .",
    "we assume that only the ces can store energy for future use and each sbs must consume all the energy it receives from the ces at every time slot .",
    "the energy arrives at the ces in the form of packets ( one energy packet corresponds to one energy level in ces ) .",
    "the quantization of energy arrival was assumed in other research studies such as in @xcite .",
    "the number of energy packet arrivals @xmath4 during any time interval @xmath5 is discrete and follows an arbitrary distribution , i.e. , @xmath6 .",
    "we assume that the battery at the ces has a finite storage @xmath7 .",
    "therefore , the number of energy packet arrivals is constrained by this limit and all the exceeding energy packets will be lost , i.e. , @xmath8 .",
    "the statistics of energy arrival is known _ a priori _ at both the mbs and the ces . at time",
    "@xmath5 , given the battery level @xmath9 , the number of energy packet arrivals @xmath4 , and the energy packets @xmath10 that the ces distributes to the @xmath1 sbss , the battery level @xmath11 at the next time slot can be calculated as follows : @xmath12    given @xmath10 energy packets to distribute , the ces will choose the best allocation method for the @xmath1 sbss according to their desired objectives . denoting the slot duration as @xmath13 and the volume of one energy packet as @xmath14",
    ", we have the energies distributed to the @xmath1 sbss at time @xmath5 as @xmath15 where @xmath16 is the transmit power of sbs @xmath17 at time @xmath5 .",
    "clearly we must have :    @xmath18    from the causality constraint , @xmath19 , i.e. , the ces can not send more energy than that it currently possesses .",
    "note that @xmath9 is the current battery level which is an integer and has its maximum size limited by @xmath7 .",
    "since the battery level of the ces and the number of packet arrivals are integer values , it follows from ( [ energy ] ) that @xmath10 is also an integer .",
    "similar to @xcite and @xcite , in our system model , the conflict between the ces and the mbs arises due to the interferences between the mbs and the sbss .",
    "clearly , if the mbs transmits with large power to achieve the @xmath0 targets for macrocell users , it will cause high interference to the small cell users .",
    "this means , the sbss will need to transmit with larger power to combat this cross - tier interference .",
    "the ces and the mbs have different objective functions and are free to choose any actions that maximize their own objectives ( i.e. , non - cooperative game ) . since the sbss can only use renewable energy , it is crucial for them to use their harvested energy economically .",
    "also , unlike a traditional one - shot transmit power control game , the ces needs to take into the account the future payoff given the current battery size and the probability of energy arrivals . in summary , for our ces model , at each time slot , we will have a random battery size at the ces and our objective is to maintain the long - term average @xmath0 close to the target value as much as possible and thus improve the outage probability .",
    "without a centralized ces - based architecture , each sbs can have different amount of harvested energy and in turn battery levels at each time slot , which will make this problem a multi - agent stochastic game @xcite .",
    "although this kind of game can be heuristically solved by using q - learning @xcite , the conditions for convergence to a nash equilibrium are often very strict and in many cases impractical . by introducing the ces ,",
    "the number of the possible states of the game is simplified into the battery size of the ces , and the multi - player game is converted into a two - player game .",
    "another benefit of the centralized ces - based architecture is that the energy can be distributed based on the channel conditions of the users served by the sbss so that the total payoff will be higher than the case where each sbs individually stores and consumes the energy .",
    "for ease of exposition , in this paper , we consider an ideal energy transfer from the ces to the sbss .",
    "however , to model a simple energy loss , we can add a fixed percentage of loss into the energy consumption of the ces at each time slot .",
    "all the symbols that are used in the system model and section iii are listed in * table i*.     @xmath17 and its associated user & @xmath20 & average channel gain between bs @xmath21 and user of bs @xmath17 + @xmath22 ( @xmath23 ) & target sinr for mbs ( sbs ) & @xmath9 & ( discrete ) battery level of ces at time @xmath5 + @xmath13 & duration of one time slot in seconds & @xmath10 & number of quanta distributed by the ces at time @xmath5 + @xmath24 & average interference at the user served by the mbs at time @xmath5 & @xmath25 & average interference at the user served by sbs @xmath17 at time @xmath5 + @xmath7 & maximum battery level of the ces & @xmath26 & finite set of transmit power of the mbs + @xmath27 , @xmath28 & & @xmath29 , @xmath30 & + @xmath31 & probability that the mbs chooses power @xmath32 when @xmath33 & @xmath34 & probability that the ces sends @xmath17 quanta when @xmath33 + @xmath4 & energy harvested at time @xmath5 & @xmath35 & probability that the ces starts with battery level @xmath36 + @xmath37 & discount factor of the stochastic game & @xmath38 & utility function of the mbs and the ces , respectively + @xmath39 & payoff matrix for the mbs and the ces , respectively & @xmath40 , @xmath41 & +      the received @xmath0 at the user served by sbs @xmath17 in the downlink at time slot @xmath5 is defined as follows : @xmath42 where @xmath43 is the interference caused by other bss .",
    "@xmath44 is the channel gain between mbs and the user served by sbs @xmath17 , @xmath45 represents the channel gain between sbs @xmath17 and the user it serves , and @xmath46 is the channel gain between sbs @xmath21 and the user served by sbs @xmath17 .",
    "finally , @xmath16 represents the transmit power of sbs @xmath17 at time @xmath5 .",
    "the transmit power of mbs @xmath47 belongs to a discrete set @xmath48  @xcite .",
    "we ignore the thermal noise assuming that it is very small compared to the cross - tier interference .",
    "similarly , the sinr at a macrocell user can be calculated as follows : @xmath49 where @xmath50 is the cross - tier interference from @xmath1 sbss to the macrocell user , @xmath51 denotes the channel gain between the mbs and its user , @xmath52 represents the channel gain between sbs @xmath17 and macrocell user , and @xmath53 is the thermal noise .",
    "the channel gain @xmath46 is calculated based on path - loss and fading gain as follows : @xmath54 where @xmath55 is the distance from bs @xmath21 to user served by bs @xmath17 , @xmath56 follows a rayleigh distribution , and @xmath57 is the path - loss exponent .",
    "we assume that the @xmath1 sbss are randomly located around the mbs and the users are uniformly distributed within their coverage radii @xmath58 . during a transmission interval ( i.e. , a time slot )",
    ", only one user is served by each sbs in the downlink direction .",
    "a stochastic game is a multiple stage game where it can have different states at each stage .",
    "each player chooses an action from a finite set of possible actions ( which can be different at each stage ) .",
    "the players actions and the current state jointly determine the payoff to each player and the transition probabilities to the succeeding state .",
    "the total payoff to a player is defined as the discounted sum of the stage payoffs or the limit inferior of the averages of the stage payoffs .",
    "the transition of the game at each time instant follows markovian property , i.e. , the current stage only depends on the previous one .      in our model ,",
    "the mbs and the sbss try to maintain the average @xmath0 of their users to be close to some targets .",
    "note that a large target @xmath0 means that a high transmit power will be required for the sbs which could be limited by the energy arrival rate and the battery size of the ces .",
    "also , a higher transmit power means a higher level of interference to other users .",
    "similar to @xcite and @xcite , the utility function of the mbs at time @xmath5 is defined as : @xmath59 where @xmath60 is the average interference at the macrocell user at time @xmath5 , and @xmath22 is the target @xmath0 for the macrocell user .",
    "clearly , this utility function is maximized when the @xmath0 at the mbs is @xmath22 .",
    "if the @xmath0 is larger than the target @xmath0 , this implies that mbs transmits with a larger power than necessary and thus wastes energy . on the other hand ,",
    "if the @xmath0 is smaller than the target @xmath0 , it implies that energy is not utilized effectively provided it has sufficient energy .",
    "similarly , the utility function of the ces is defined as follows : @xmath61 where @xmath62 is the average interference at the user served by sbs @xmath17 at time @xmath5 .",
    "the arguments of both the utility functions demonstrate that the action at time @xmath5 for the mbs is its _ transmission power _ @xmath47",
    "while the action of the ces is the _ number of energy packets @xmath10 that is used to transmit data from the sbss_. later , in * remark 2 * , we will show that the interference and the transmit power of each sbs can be derived from @xmath63 and @xmath64 .",
    "the conflict in the payoffs of both the players arises from their transmit powers that directly impact the cross - tier interference .",
    "note that the proposed single - controller approach can be extended to consider a variety of utility functions ( average throughput , total network throughput , energy efficiency , etc . )      unlike a traditional power control problem , the action space of the ces changes at each time slot and is limited by its battery size . given the distribution of energy arrival and the discount factor @xmath37 , the power control problem can be modeled by a single - controller discounted stochastic game as follows :    * there are two players : one mbs and one ces . * the state of the game is the battery level of the ces , which belongs to @xmath65 . * at time @xmath5 and state @xmath36 , the action @xmath47 of the mbs is its transmission power and belongs to the finite set @xmath2 . on the other hand ,",
    "the action of the ces is @xmath10 , which is the number of energy packets distributed to @xmath1 sbss .",
    "@xmath10 belongs to the set @xmath66 .",
    "* let @xmath27 and @xmath28 denote the concatenated mixed - stationary - strategy vectors of the mbs and the ces , respectively .",
    "the vector @xmath27 is constructed by concatenating @xmath67 sub - vectors into one big vector as @xmath68,$ ] in which each @xmath29 is a vector of probability mass function for the actions of the mbs at state @xmath36 .",
    "for example , if the game is in state @xmath36 , @xmath31 gives the probability that the mbs transmits with power @xmath69 .",
    "therefore , the full form of @xmath27 will include the state @xmath36 and power @xmath69 .",
    "however , to make the formulas simple , in the later parts of the paper , we will use @xmath27 or @xmath29 to denote , respectively , the entire vector or a sub - vector at state @xmath36 , respectively . * similarly , for the ces , @xmath34 gives the probability that the ces distributes @xmath17 energy packets .",
    "note that the available actions of the ces dynamically vary at each state whereas the available actions for the mbs remain unchanged at every state .",
    "* * payoffs : * at state @xmath36 , if the mbs transmits with power @xmath64 and the ces distributes @xmath63 energy packets , the payoff function for the mbs is @xmath70 while the payoff function for the ces is @xmath71 .",
    "we omit @xmath5 since @xmath5 does not directly appear in @xmath72 and @xmath73 . *",
    "* discounted payoffs : * denoting by @xmath37 the discount factor ( @xmath74 ) , the discounted sum of payoffs of the mbs is given as : @xmath75,\\ ] ] where @xmath76 $ ] is the average utility of macrocell user at time @xmath5 if the mbs and the ces are using strategy @xmath27 and @xmath28 , respectively .",
    "similarly , we define the discounted sum of payoffs @xmath41 at the ces . in (",
    "* chapter  2 ) , it was proven that the limit of @xmath40 and @xmath41 always exist when @xmath77 .",
    "* * objective : * to find a pair of strategies @xmath78 such that @xmath40 and @xmath41 become a nash equilibrium , i.e. , @xmath79 , where @xmath80 and @xmath81 are the sets of strategies of mbs and ces , respectively .",
    "given the distribution of energy arrival at the ces , the transition probability of the system from state @xmath36 to state @xmath82 under action @xmath63 ( @xmath83 ) of the ces is given as follows : @xmath84 also , we assume that information about the average channel gains are available to all players .",
    "this implies that the single - controller stochastic game we present here will be a perfect information non - cooperative game .",
    "the states of the game can be described by a markov chain for which the transition probabilities are defined by ( [ markovstate ] ) .",
    "clearly , the ces controls the state of the game while the mbs has no direct influence .",
    "therefore , the single - controller stochastic game can be applied to derive the nash equilibrium strategies for both the mbs and the ces .",
    "the two main steps to find the nash equilibrium strategies are :    * first , we build the payoff matrices for the mbs and the ces for every state @xmath36 , where @xmath85 . denote them by @xmath86 and @xmath87 , respectively . *",
    "second , using these matrices , we solve a quadratic programming problem to obtain the nash equilibrium strategies for both the mbs and the ces .      to build @xmath86 and @xmath87",
    ", we calculate @xmath73 and @xmath72 for every possible pair @xmath88 , where @xmath89 and @xmath90 . in this regard ,",
    "we first derive the average channel gain @xmath20 .",
    "second , from the energy consumed @xmath63 and transmission power @xmath64 of the ces and the mbs ,     @xmath91 , and the user @xmath92 located within the disk centred at @xmath91.,width=192 ]    respectively , we decide how the ces distributes this energy @xmath63 among the sbss .",
    "then , we calculate the transmit power at each sbs and obtain @xmath73 and @xmath72 .",
    "the next two remarks provide us with the methods to calculate @xmath73 and @xmath72 .",
    "[ rem1 ] given two bss @xmath93 and @xmath91 , assume that a user @xmath92 , who is associated with @xmath91 , is uniformly located within the circle centred at @xmath91 with radius @xmath58 ( fig .",
    "[ locations ] ) .",
    "assume that @xmath93 does not lie on the circumference of the circle centred at @xmath91 and @xmath94 .",
    "denote @xmath95 and @xmath96 , then the expected value of @xmath97 , i.e. , @xmath98 $ ] is @xmath99 .",
    "if @xmath100 , then @xmath98 = \\frac{1-r^{-2}}{r^2}$ ] given that @xmath101 .",
    "for other values of @xmath57 , @xmath102 $ ] can be easily computed numerically using tools such as ` mathematica ` .",
    "see * appendix a. *    recalling that @xmath103 and that the fading and path - loss are independent , we have @xmath104\\mathbb{e}[r_{ij}^{-4}]$ ] , where @xmath105 = \\lambda$ ] , if @xmath56 follows rayleigh distribution with scale parameter @xmath106 .",
    "next , we need to find how the ces distributes its energy to each sbs such that @xmath72 is maximized .",
    "( optimal energy distribution at the ces)[rem2 ] if at time @xmath5 the ces distributes @xmath63 energy packets to @xmath1 sbss and the mbs transmits with power @xmath64 , then the transmit powers @xmath107 at the @xmath1 sbss are the solutions of the following optimization problem ( @xmath5 is omitted for brevity ) : @xmath108 where @xmath109 is the maximum transmit power of each sbs . since",
    "this problem is strictly concave , the solution @xmath110 always exists and is unique for each pair ( @xmath111 ) .",
    "thus , for each pair @xmath112 , where @xmath113 and @xmath114 , we have unique values for @xmath70 and @xmath71 .    based on the remarks above , for each combination of @xmath63 and @xmath64 , we can find the unique payoff @xmath73 and @xmath72 of mbs and ces . since @xmath63 and @xmath64 belongs to discrete sets we can find the payoff for all of the possible combinations between them .",
    "thus , we can build the pay - off matrix @xmath86 for the mbs and @xmath87 for the ces .",
    "the matrix @xmath86 has the form of a block - diagonal matrix @xmath115 , where each sub - matrix @xmath116 , with @xmath89 and @xmath117 is the matrix of all possible payoffs for the mbs at state @xmath36 .",
    "similarly , we can build @xmath87 , which is the payoff matrix for the ces .",
    "a detailed explanation on how we use them will be given in the next subsection .        by solving the pair of linear programs above , the probability that the sbs chooses action @xmath21 at state @xmath36",
    "can be found as @xmath128 using some algebraic manipulations , we can convert the optimization problem in ( [ p ] ) into a matrix form as : @xmath129 and its dual as @xmath130 where @xmath87 is the payoff matrices of the ces . combining the primal and dual linear programs ( i.e. , ( p ) and ( d ) above ) and using the same notations",
    ", we have the following theorems .",
    "we can define different utility functions for the mbs and the sbs and apply the same method to achieve the nash equilibrium .",
    "as long as the number of states is finite and the transition probabilities and the payoff matrices are known , a nash equilibrium point always exists .",
    "[ best response strategy for the mbs ] [ mbs ] given a stationary strategy @xmath28 of the ces , there exists a pure stationary strategy @xmath27 as the best response for the mbs .",
    "similarly , for any stationary strategy @xmath27 of the mbs , there exists a pure stationary best response @xmath28 of the ces .",
    "see * appendix b*.    because for every mixed strategy of the ces , the mbs can find a pure stationary strategy as a best response , we only need to find nash equilibrium where the strategy of the mbs is deterministic .",
    "from there , this problem can be converted to a mixed - integer program with @xmath27 as a vector of 0 and 1 .",
    "we can use a brute - force search to obtain an equilibrium point . for each feasible integer value of @xmath27",
    "we insert it into ( [ quadr ] ) to obtain @xmath28 .",
    "if the objective is zero , then @xmath131 is the equilibrium point .",
    "this theorem implies that the optimization problem in ( [ quadr ] ) can be solved in a finite amount of time .    notice that since @xmath136 is not a positive semi - definite matrix , there can be several solutions for the quadratic programming problem in ( [ quadr ] ) , i.e. , multiple nash equilibrium .",
    "therefore , to make the chosen nash equilibrium point more meaningful , we use the following lemma from @xcite .",
    "( necessary and sufficient conditions for the nash equilibrium ) @xmath27 and @xmath28 constitute a pair of nash equilibrium policies for the mbs and the ces if and only if @xmath137    since @xmath138 is the probability that the ces starts with @xmath36 energy level in the battery at starting time , from ( [ p ] ) , @xmath139 is the average value function of the ces with respect to the energy arrival rate and the strategies @xmath140 .",
    "we are interested in the nash equilibrium that maximizes the average payoff of the ces ( i.e. , the sbss ) .",
    "this bias towards the sbss is crucial as the available energy of the ces is limited by the randomness of the energy arrival process and thus the sbss are more likely to suffer when compared to the mbs . using the lemma above",
    ", we change the problem in ( [ quadr ] ) to a quadratic - constrained quadratic programming ( qcqp ) as stated below .",
    "( nash equilibriums that favor the sbss ) the nash equilibrium @xmath131 that has the best payoff for the ces is a solution of the following qcqp problem : @xmath141    by solving this qcqp ( i.e. , by using a brute - force search ) , we obtain a nash equilibrium that returns the best average payoff for the ces .",
    "again , we can still have multiple nash equilibrium in this case , but all of them must return the same payoff for the ces . because there may be multiple solutions , the ces and the mbs need to exchange information so that they agree on the same nash equilibrium .",
    "the mbs and the ces calculate their strategy @xmath27 and @xmath28 , respectively , by solving ( [ qcqp ] ) . at time @xmath5",
    ", the ces sends its current battery level @xmath36 to the mbs .",
    "it also randomly chooses an action @xmath63 using the probability vector @xmath30 .",
    "the mbs then randomly picks power @xmath64 using distribution @xmath29 and sends it back to the ces .",
    "based on @xmath64 and @xmath63 , the ces searches its records and retrieves the corresponding tuple @xmath142 .",
    "the ces distributes energy @xmath143 , respectively , to the @xmath1 sbss .    from * theorem 2 * , we know that there exists an equilibrium with pure stationary strategies for both the mbs and ces .",
    "recall that with pure strategy , the action of each player is a function of the state .",
    "thus , if we can obtain this equilibrium , the ces can predict which transmit power @xmath64 the mbs will use based on the current state , without exchanging information with the mbs and vice versa .      for the discrete stochastic control game with the ces , each sbs first needs to send its location and average fading channel information @xmath105 $ ] of its user to the ces .",
    "then the ces and the mbs will exchange information so that the mbs can have complete knowledge about the average channel gains at each sbs . since we only use average value , the ces and the mbs only need to re - calculate the nash equilibrium strategies when either the locations of sbss change , e.g. , some sbss go off and some are turned on , or when the average of channel fading gain @xmath56 changes , or when distribution of energy arrival @xmath4 at the ces changes .",
    "note that the sbss and the mbs only need to send the channel gain information of the corresponding users ( to be served ) to the ces .",
    "the main problem of the two - player single - controller stochastic game is the  curse of dimensionality \" .",
    "the time complexity of * algorithm  1 * increases exponentially with the number of states @xmath7 or the maximum battery size .",
    "note that @xmath86 and @xmath87 have dimensions of @xmath144 , so the complexity increases proportionally to @xmath7 .",
    "moreover , unlike other optimization problems , we are unable to relax the qcqp in ( [ qcqp ] ) , because * theorem  1 * states that the nash equilibrium must be the global solution of the quadratic program in ( [ quadr ] ) . to tackle these problems , we extend the stochastic game model to an mfg model for a very large number of players .",
    "the main idea of an mfg is the assumption of similarity , i.e. , all players are identical and follow the same strategy .",
    "they can only be differentiated by their  state \" vectors .",
    "if the number of players is very large , we can assume that the effect of a specific player on other players is nearly negligible .",
    "therefore , in an mfg , a player does not care about others states but only act according to a ",
    "mean field \" @xmath145 , which usually is the probability distribution of state @xmath36 at time instant @xmath5 @xcite . in our energy harvesting game ,",
    "the state is the battery @xmath146 and the mean field @xmath147 is the probability distribution of energy in the area we are considering .",
    "when the number of players @xmath1 is very large , we can assume that @xmath147 is a smooth continuous distribution function .",
    "we will express the average interference at an sbs as a function of the mean field @xmath148 .",
    "all the symbols used in this section are listed in * table ii*.    [ cols=\"^,<,^ , < \" , ]        thanks to similarity , all the sbss have the same set of equations and constraints , so the optimal control problem for the @xmath1 sbss reduces to finding the optimal policy for only one generic sbs .",
    "mathematically , if an sbs has infinite available energy , i.e. , @xmath160 , it will act as an mbs . however , for simplicity , we will assume that only the sbss are involved in the game and the interference from the mbs is constant , which is included in the noise @xmath53 as in @xcite . except that , the system model and the optimization problem here are similar to those in the discrete stochastic game model .        assuming that the optimal control above starts at time @xmath5 with @xmath172 , we obtain the bellman function @xmath173 as @xmath174.\\ ] ] from this function , at time @xmath5 , we obtain the following hamilton - jacobi - bellman ( hjb ) @xcite equation : @xmath175 where @xmath176 is the average transmit power at a generic sbs .",
    "the hamiltonian @xmath177 is given by the bellman s principle of optimality . by applying the first order necessary condition",
    ", we obtain the optimal power control as follows : @xmath178^+ .",
    "\\label{powermfg}\\ ] ]    the bellman @xmath179 , if exists , is a non - increasing function of time and energy .",
    "therefore , we have @xmath180 and @xmath181 .    from equation ( @xmath182 ) , given the current interference @xmath183 at a user , the corresponding sbs will transmit less power based on the future prospect @xmath184 . if the future prospect is too small , i.e. , @xmath185 , it stops transmission to save energy .",
    "replacing @xmath186 back to the hjb equation , we have @xmath187^+\\right)^2 = 0 , &   \\ ] ] which has a simpler form as follows : @xmath188 also , from ( [ mfg:2 ] ) , at time @xmath5 , we have the fokker - planck equation @xcite as : @xmath189 where @xmath190 is the probability density function of @xmath191 at time @xmath5 . combining all these information , we have the following proposition .      [ mfgpower ]",
    "the average transmit power @xmath194 of a generic sbs is a derivative of the average energy available with respect to time and can be calculated as @xmath195    see * appendix c*.    since @xmath196 is always non - negative , the average energy in an sbs s battery is a decreasing function of time .",
    "that is , the distribution @xmath148 should shift toward left when @xmath5 increases .",
    "this is because , we use the wiener process in ( [ mfg:1 ] ) .",
    "since @xmath197 has a normal distribution with mean zero , the energy harvested will be equal to the energy leakage .",
    "therefore , for the entire system , the total energy reduces when time increases .",
    "if @xmath198 and @xmath199 are two solutions of * proposition [ pdes ] * and @xmath200 , then we have @xmath201 .",
    "first , from ( [ mfg:2 ] ) we derive fokker - planck equation : @xmath202 since @xmath203 , we subtract the first equation from the second one to obtain @xmath204 this means @xmath205 is a function of @xmath5 .",
    "let us denote @xmath206 , then we have @xmath207 . from * lemma [ mfgpower ]",
    "* , if @xmath208 then @xmath209 . since @xmath210 , we have @xmath211 now we substitute @xmath207 that results in @xmath212 this means @xmath213 or @xmath214 . note",
    "that @xmath179 is a function of @xmath196 and @xmath69 . since @xmath215 and @xmath214",
    ", it follows that @xmath216 .",
    "this lemma confirms that an sbs will act only against the mean field @xmath148 .",
    "thus only @xmath148 determines the evolution of the system .",
    "two systems with the same mean field will behave similarly .      to obtain @xmath179 and @xmath148 ,",
    "we use the finite difference method ( fdm ) as in @xcite and @xcite .",
    "we discretize time and energy coefficient @xmath191 into large intervals as @xmath217 $ ] and @xmath218 $ ] with @xmath219 and @xmath220 as the step sizes , respectively . then @xmath221 become matrices with size @xmath222 .",
    "to keep the notations simple , we use @xmath5 and @xmath191 as the index for time and energy coefficient in these matrices with @xmath223 and @xmath224 .",
    "for example , @xmath190 is the probability distribution of energy @xmath225 at time @xmath226 . using the fdm , we replace @xmath227 , @xmath228 , and @xmath229 with the corresponding discrete formulas as follows @xcite : @xmath230 by using them in ( [ valuef ] ) and after some simple algebraic steps , we have @xmath231 where @xmath232 similarly , discretizing ( [ discreteimfg ] ) , we have @xmath233 where @xmath234    to obtain @xmath221 , and @xmath196 using * proposition [ pdes ] * , we need to have some boundary conditions . first , to find @xmath148 , we assume that there is no sbs that has the battery level equal to or larger than @xmath235 so that @xmath236 .",
    "this is true if we assume that @xmath237 is the largest battery size of an sbs .",
    "also , when @xmath238 , from the basic property of probability distribution @xmath239    next , to find @xmath179 , again we need to set some boundary conditions . notice that @xmath240 for all @xmath191 .",
    "we further assume the following :    * intutitively , if the battery level of a sbs is full , i.e. , when @xmath241 , this sbs should transmit something , or equivalently , @xmath242 .",
    "that means @xmath243 therefore , if we know @xmath244 and @xmath69 , we can calculate @xmath245 . *",
    "similarly , it must be true that when the available energy is @xmath3 , i.e. , @xmath238 , an sbs will stop transmission .",
    "therefore , we can assume @xmath246 again , if we know @xmath247 , we can calculate @xmath248 .",
    "* during simulations , in some cases when the density is very high , we obtain very large ( unrealistic ) values of transmit power .",
    "therefore , we must put an extra constraint for the upper limit . in this paper , we use @xmath249 , or @xmath250 , where @xmath13 is the duration of one time slot .",
    "this means , we have to limit the transmit power during one time step @xmath219 to be smaller than the maximum power that can be transmitted during one time interval @xmath13 .    based on the above considerations , we develop an iterative algorithm ( * algorithm [ fdm ] * ) detailed as follows",
    ".    set up @xmath251 matrices @xmath252 , @xmath253 , @xmath254 , and @xmath255 vector @xmath196 .",
    "guess arbitrarily initial values for power @xmath254 , i.e. , @xmath256 .",
    "initialize @xmath257 , @xmath258 , @xmath259 , @xmath260 , and @xmath261 .",
    "initialize @xmath220 and @xmath219 as the step size of energy and time with @xmath262 .",
    "set @xmath263 as the number of iteration .",
    ":    solve the fokker - planck equation to obtain @xmath148 using ( [ discretem ] ) and ( [ mbound ] ) with given @xmath69 , @xmath264 .",
    "update @xmath194 for @xmath265 using discrete form of equation ( [ discreteimfg ] ) .",
    "calculate @xmath179 for all @xmath266 by using ( [ discreteu ] ) , ( [ urmax ] ) and ( [ -urmax ] ) with @xmath69 , @xmath196 .",
    "calculate new transmission power @xmath267 using ( [ pow ] ) .",
    "regressively update @xmath268 with @xmath269 . * for * @xmath270 * if * @xmath271 * then * @xmath272 . * end * @xmath273 .    *",
    "end *    at time slot @xmath5 , sbs with energy battery @xmath225 transmits with power @xmath274 .      for the mfg , we do not need the location information for each sbs .",
    "however , we need information about the average channel gain @xmath155 , the number of sbss @xmath1 in one macrocell , and the initial distribution @xmath264 of the energy of the sbss .",
    "therefore , some central system should measure these information , solve the differential equations , and then broadcast the power policy @xmath69 to all the sbss .",
    "it is more efficient than broadcasting all the information to all sbss and let them solve the differential equations by themselves .",
    "again , the central system only needs to re - calculate and broadcast to all sbss a new power policy if there are changes in @xmath155 or @xmath1 .",
    "in this section , we quantify the efficacy of the developed stochastic policy in comparison to the simple stackelberg game - based power control policy .",
    "the stochastic policy is obtained from the qcqp problem . on the other hand , for the stackelberg policy",
    ", we follow a hierarchical method .",
    "let us assume that at time @xmath5 sbs @xmath17 has @xmath275 joules of energy in its battery .",
    "if the mbs transmits with power @xmath64 , then each sbs tries to transmit with a power such that @xmath276 where @xmath277 is the interference from both the sbss and the mbs .",
    "since this is a convex problem , although it is solved independently by each sbs , the results are the same .",
    "notice that the objective function for each sbs is similar to the utility function in ( [ u1 ] ) ; therefore , it can provide a fair comparison against our method .",
    "the constraint means that each sbs can not transmit more than the energy it has in its battery .",
    "next , knowing that sbs @xmath17 will solve the above optimization problem to find its @xmath278 , the mbs calculates its @xmath0 for different values of its transmit power and picks the optimal @xmath64 .",
    "knowing @xmath64 , each sbs solves the convex optimization above to obtain its transmit power @xmath279 .",
    "the tuple @xmath280 will be a nash equilibrium because no one can choose a better option given the others actions .    to solve the qcqp in ( [ qcqp ] )",
    ", we use the _ fmincon _ function from matlab .",
    "note that the _ fmincon _ function may return a local optimal instead .",
    "therefore , in order to obtain a good approximation for the optimal solution , in our simulations , we use the incremental method as described below .",
    "first , our qcqp problem is stated as follows : @xmath281 where @xmath282 is a group of linear functions of @xmath283 .    by solving this using _ fmincon _",
    ", we obtain a local optimal result @xmath284 .",
    "then we solve the updated qcqp problem as follows : @xmath285 where @xmath286 is a small positive constant . by solving this new qcqp",
    ", we obtain a local optimal solution that satisfies the constraints of the original qcqp and returns a better result .",
    "we keep repeating this step as long as _",
    "fmincon _ is able to return a solution @xmath287 with @xmath288 that satisfies the constraints .",
    "then we say that @xmath289 is the optimal solution ( with the error of @xmath286 ) .",
    "note that the optimal solution for this qcqp can be found by using brute force search through all possible integer values of @xmath27 .",
    "therefore , the result can be double checked when the number of sbss is small .    in the simulations ,",
    "the ces has a maximum battery size of @xmath290 and the volume of one energy packet is @xmath291 j. the duration of one time interval is @xmath292  ms and the thermal noise is @xmath293 w. the small cell users are considered to be in outage if the @xmath0 falls below 0.02 .",
    "the mbs has two levels of transmission power [ 10 ; 20 ] watts and the sinr outage threshold is set to 5 .",
    "the energy arrival at each sbs follows a poisson distribution with unit rate .",
    "the volume of each energy packet arriving at the ces is @xmath294 times larger than the energy packet collected by each sbs .",
    "thus , the amount of energy in each packet at the ces will be @xmath295 @xmath296j .",
    "therefore , the ces should have a more efficient method to harvest energy than each sbs ( in the case of stackelberg method ) . however , as the maximum battery size of the ces is limited by @xmath7 , its total available energy is always limited by the product @xmath297 @xmath296j regardless of @xmath1 . for both the cases , each sbs can receive up to 1.5 mj of energy from either the ces or the environment . at the beginning , the ces is assumed to have its battery full .     when @xmath290 states , @xmath298 , @xmath299 sbss , @xmath300.,width=288 ]     when @xmath290 states , @xmath298 , @xmath299 sbss , @xmath300.,width=288 ]    from fig .",
    "[ density ] , it can be seen that when the number of sbss is smaller than some value , the stochastic method gives better results .",
    "this is because , the ces can redistribute the harvested energy among the sbss based on their average channel gains , and also the qcqp in ( [ qcqp ] ) gives a nash equilibrium that favors the ces .",
    "however , at some point , its outage probability will be higher than that for the stackelberg approach .",
    "this is not surprising since the ces can only store at most @xmath301 @xmath296j of energy .",
    "therefore , when the number of sbss increases , the average allocated power per sbs by the ces reduces while the stackelberg method allows each sbs to harvest up to 1.5mj no matter how large @xmath1 is .",
    "this means that the stackelberg method can provide a better performance compared to using the ces when @xmath1 is large .",
    "following fig .",
    "[ threshold ] , by increasing the threshold sinr target @xmath23 while keeping the number of sbss fixed , we can reduce the outage probability of a user served by an sbs .",
    "this is understandable since the average @xmath0 will approach the higher target and thus reduce the outage probability .",
    "however , for the stochastic methods , the outage will start to increase when the target @xmath0 is larger than some value . to increase the average @xmath0 , the sbss need to transmit with higher power to at least mitigate the cross - tier interference",
    "however , a higher transmit power means a higher consumption of harvested energy , which can create shortages later . also , higher transmit powers from the sbss wil make the mbs to increase its own transmit power and thus create high cross - interference .",
    "when the target @xmath0 is higher than some value , the stochastic method will behave greedily by transmitting as much as possible and the outage will begin to increase . when the target @xmath0 is large enough",
    ", the ces distributes all of the energy it currently has and thus the outage probability will become flat .",
    "a similar observation can be made for the stackelberg approach .",
    "however , for this method , the energy can not be redistributed to the sbss with good channel gains to its users and the distribution of energy arrivals is ignored ; therefore , the results are worse than those for our stochastic method .    fig .",
    "[ volume ] shows the outage probability when increasing the quanta volume by choosing a higher multiplier @xmath294 for the ces .",
    "it is easy to see that , with a higher @xmath294 , i.e. , choosing a more effective method to harvest energy at the ces , we can achieve a better performance .",
    "the stackelberg method does not use the ces , so the outage probability remains unchanged .",
    "note that , since the battery size of each sbs is limited to 1.5 mj , at some point , a higher @xmath294 does not improve the outage probability .",
    "states , @xmath299 sbss , @xmath298 , @xmath300.,width=288 ]     states , @xmath299 sbss , @xmath298 , @xmath300.,width=288 ]    fig .",
    "[ mbs_fbs ] shows the outage probability of the macrocell user when @xmath299 and @xmath298 .",
    "the stochastic method gives better results in this case since the sbss are more ",
    "rational \" in choosing their transmit powers in long term .",
    "also , unlike the stackelberg method , the ces has a fixed - energy battery , so when @xmath1 is large , the average amount of energy distributed to an sbs will be small , which in turn limits the cross - interference to the macrocell user . with the stackelberg method ,",
    "the sbss only try to maximize their payoffs in the current time slot and ignore the distribution of energy ; therefore , it uses a higher transmit power to compete against the mbs when the target @xmath0 is increased ; therefore , it creates a larger cross - interference and in turn increases the outage probability of the macrocell user .    in summary , we see that the centralized method using a ces can provide a better performance in terms of outage probability for both the mbs and sbss .",
    "the advantages of using ces are two folds : first , it allows the harvested energy to be distributed to the sbss which have good channel gains for the scheduled users , and second , it considers the probability distribution of energy arrivals when calculating the transmit power policy for both the mbs and sbss . however , since the ces has a fixed battery size , this centralized model performs poorer when it needs to support a large number of sbss . to improve this inflexibility",
    ", we can adjust other parameters as follows : change the target @xmath0 , increase the multiplier @xmath294 , or increase the battery size of each sbs .",
    "we assume that the transmit power at the mbs is fixed at 10w and it results in a constant noise at the user served by a generic sbs .",
    "the radius of the macrocell is @xmath302 meter , so we have constant cross - interference @xmath303 w. the target @xmath0 is @xmath304 and assume that @xmath305 .",
    "we discretize the energy coefficient @xmath191 into 80 intervals , i.e. , @xmath306 and @xmath307 intervals .",
    "similar to the discrete stochastic case , each sbs can hold up to 150 @xmath296j in the battery , so the maximum transmit power is 30 mw .",
    "we impose the threshold such that an sbs will not transmit at @xmath308 or @xmath309j .",
    "the intensity of energy loss / energy harvesting , @xmath161 is 1 .",
    "sbss / macrocell.,width=288 ]     sbss / macrocell.,width=288 ]     sbss / macrocell.,width=288 ]     sbss / macrocell.,width=288 ]     sbss / macrocell.,width=288 ]     sbss / macrocell.,width=288 ]    for @xmath310 sbss / cell , we have @xmath311 , so a generic sbs does not need to use a large amount of power in order to obtain the target @xmath0 .",
    "notice that @xmath196 is the average transmit power of a generic sbs .",
    "therefore , if a generic sbs reduces @xmath196 , the cost term @xmath312 also reduces . thus the difference between the cost and the received power @xmath313",
    "will be smaller , which is desirable .",
    "it makes sense that a generic sbs will try to reduce its power as much as possible in this case .",
    "the power can not be zero though , because @xmath314 .",
    "moreover , from fig . [ powmfg401 ] and fig .",
    "[ powmfg402 ] , we see that , at the beginning , the sbs with higher energy ( i.e. , 100 @xmath296j ) will transmit with a high power and will gradually reduce to some value .",
    "the sbss with smaller battery will increase their transmit powers gradually . since the transmit power is small",
    ", we see that in fig .",
    "[ dismfg401 ] and fig .",
    "[ dismfg402 ] , the energy distribution shifts to the left slowly .    on the other hand , when @xmath315 sbss / macrocell , we have @xmath316 . in this case , the effect is more complicated because reducing the transmit power may not reduce the gap between the received power @xmath313 and the cost term @xmath317 . again , as can be seen from fig .",
    "[ powmfg502 ] , the sbss with larger available energy will transmit with large power first and after sometime when there is less energy available in the system , all of them start to use less power . therefore , as can be seen in fig .",
    "[ dismfg502 ] , the energy distribution shifts toward the left with a faster speed than the previous case .    for @xmath318 sbss / macrocell",
    ", we have @xmath319 .",
    "this means each sbs needs to transmit with a power larger than the average @xmath196 to achieve the target @xmath0 . in fig .",
    "[ powmfg602 ] , we see that the behavior of each sbs is the same as in the previous case .",
    "that is , the sbss with higher energy transmit with larger power first and then reduce it , while the  poorer \" sbss increase their transmit power over time .            we compare the mfg model against the stochastic discrete model for different values of @xmath1 . for simplicity , we assume that each sbs has the same link gain to its user as @xmath320 . also , we assume that the channel gain from each sbs to the user of another sbs is @xmath321 . using * remark   [ rem2 ]",
    "* , it can easily be proven that in this case , each sbs will transmit with the same power , i.e. , if the ces sends @xmath322 @xmath296j of energy to @xmath1 sbss , then each sbs receives @xmath323 @xmath296j .",
    "then , the interference at each sbs will be calculated as @xmath324 with multiplier @xmath325 and the maximum battery size of the ces as @xmath326 . because the mbs is not a player of the game ,",
    "the simulation step becomes simpler , and we only need to solve a linear program for the mdp problem instead of a qcqp .",
    "therefore , we can call it as mdp method to accurately reflect the difference .    for the discrete stochastic case , we discretize the gaussian distribution to model the energy arrivals at the ces .",
    "the battery size of each sbs is still 150 @xmath327 .",
    "the average sinr of a generic small cell user using both the mfg and mdp models with different density is plotted in fig .",
    "[ mfgvsdiscrete ] .",
    "we see that using the mfg model , the average @xmath0 increases at the beginning and then it starts falling at some point .",
    "this is because , when the density is low , the interference from the mbs is noticeable ( i.e. , @xmath328 w in our simulation ) . from the previous figures",
    ", it can be seen that an sbs will increase its power when the density is higher .",
    "therefore , after some point the co - tier interference becomes dominant and the average @xmath0 will begin to drop .",
    "it means at some value of the density , e.g. , @xmath310 sbss / macrocell in fig .",
    "[ mfgvsdiscrete ] , we obtain the optimal average @xmath0 .",
    "we notice that the mfg model performs better than the mdp model with the ces .",
    "this is due to the limited battery size of ces which makes it difficult to support a large number of sbss .    in summary , we have two important remarks for the mfg model .",
    "first , if the density of small cells is high , the sbss will transmit with higher power .",
    "second , from fig .",
    "[ mfgvsdiscrete ] , we see that by choosing a suitable density of the sbss , we can obtain the highest average @xmath0 . from ( [ pow ] )",
    ", it can be easily proven that the average @xmath0 at a user served by an sbs will always be smaller than the target @xmath0 ( because @xmath329 ) .",
    "therefore , the highest average @xmath0 is also the closest to the target @xmath0 , which is our objective in the first place .",
    "we have proposed a discrete single - controller discounted two - player stochastic game to address the problem of downlink power control in a two - tier macrocell - small cell network under co - channel deployment where the sbss use stochastic renewable energy source . for the discrete case ,",
    "the strategies for both the macrocell and sbss have been derived by solving a quadratic optimization problem .",
    "the numerical results have shown that these strategies can perform well in terms of outage probability experienced by the users .",
    "we have also applied a mean field game model to obtain the optimal power for the case when the number of sbss is very large .",
    "we have also discussed the implementation aspects of these models in a practical network .    in this paper , we have not explicitly considered the correlation in the energy arrival process . however , this correlation can be modeled by assuming that the energy arrival has markovian property . in this case , to calculate the transition probability , we will need to extend the definition of the state to a two - element vector , one is the current energy in the storage and the second is the energy arrival at this time slot .",
    "moreover , we have not considered the details of cost and latency analysis related to the information exchange to and from the ces and also the charge and discharge loss of the battery storage .",
    "these issues can be addressed in future .",
    "[ [ section ] ]    denote the distance between the bs @xmath91 to its user @xmath92 as @xmath330 .",
    "if @xmath92 is uniformly located inside the disk centred at @xmath91 , the pdf of @xmath331 is @xmath332 . denote by @xmath333 the value of the angle @xmath334 , @xmath333 is uniformly distributed between @xmath335 . using the cosine law @xmath336 , we obtain @xmath337   = \\int_0^{2\\pi}\\int_0^r ( r^2 + a^2 - 2ar \\cos\\theta)^{-2 } \\frac{1}{2\\pi } \\frac{2a}{r^2 } \\ , da \\ , d\\theta .",
    "\\end{aligned}\\ ] ] first , we solve the indefinite integral over @xmath333 as @xmath338 where @xmath339 is a constant and @xmath340 since @xmath341 , after integrating @xmath342 over @xmath343 $ ] , we can ignore it .",
    "thus @xmath344 next , we integrate the above result over @xmath345 to obtain the indefinite integral as : @xmath346 applying the upper and lower limits of @xmath345 , we complete the proof .",
    "first , we prove that given @xmath28 , there exists a pure stationary strategy @xmath27 which is the best response of the mbs against @xmath28 .",
    "since the action set of the mbs is fixed , at each state @xmath36 , given strategy @xmath30 of the ces , the mbs just needs to choose a mixed stationary strategy @xmath29 such that its average payoff is maximized . at state @xmath36 , the average utility function of",
    "the mbs is @xmath347 = \\sum\\limits_{p_0^s \\in \\mathcal{p}}\\sum\\limits^{s}_{j=0 } - ( p_0^s\\bar{g}_0-\\lambda_0\\bar{i}(p_0^s , j))^2 \\mathbf{m}(s , p_0^s)\\mathbf{n}(s , j ) ,      \\ ] ] where @xmath348 and @xmath117 are the transmit power of the mbs and the number of energy packets distributed at the ces at state @xmath36 , respectively .",
    "@xmath349 is the average interference from other sbss to the mbs if the ces distributes @xmath21 energy packets and the mbs transmits with power @xmath348 .",
    "we have @xmath350 where @xmath107 is the solution of * remark   [ rem2 ] * , with @xmath63 and @xmath64 replaced by @xmath21 and @xmath348 , respectively .",
    "since @xmath351 and @xmath352 is a non - negative vector , we have @xmath353 \\leq \\max\\limits_{p_0^s \\in \\mathcal{p } } \\left\\ { -\\sum\\limits^{s}_{j=0 } ( p_0^s\\bar{g}_0-\\lambda_0\\bar{i}(p_0^s , j))^2     \\mathbf{n}(s , j ) \\right\\}.\\ ] ]    since the set @xmath26 is fixed and finite , there always exists at least one value of @xmath348 that achieves the maximum for the right hand side .",
    "that means when the game in state @xmath36 , the mbs can choose this power level with probability of 1 .",
    "however , obtaining a closed - form @xmath348 is difficult because first we need to find @xmath142 in closed - form by solving @xmath354 .    nevertheless , if the average channel gains from each sbs to the macrocell user ( say @xmath355 ) are same , we can obtain @xmath348 in closed form by defining @xmath356 the final equality is from ( [ power ] ) .",
    "replacing this result back into ( [ maxmbs ] ) , we have @xmath357 \\leq \\max\\limits_{p_0^s \\in \\mathcal{p } }   -\\sum\\limits^{s}_{j=0 } ( p_0^s\\bar{g}_0-\\lambda_0(\\frac{k}{\\delta t}j\\bar{g}_{0,sbs}+n_0))^2              \\mathbf{n}(s , j ) .",
    "\\end{split}\\ ] ] the right hand side of this inequality is a strictly concave function ( downward parabola ) with respect to @xmath348 . note that @xmath358 .",
    "the parabola will achieve the maximum value at its vertex given by @xmath359 if @xmath360 is not available in @xmath26 , since the right hand side of the inequality above is a parabola w.r.t .",
    "@xmath361 , the best response @xmath361 to @xmath30 is the one nearest to the vertex @xmath360 .    on the other hand ,",
    "given strategy @xmath27 of the mbs , the problem of finding the best response strategy @xmath28 for the ces is simplified into a simple mdp in ( [ p ] ) .",
    "then , there always exists a pure stationary strategy @xmath28 ( * ? ? ?",
    "* chapter   2 ) .",
    "this completes the proof .",
    "using the stochastic differential equation in ( [ mfg:1 ] ) at time @xmath5 , @xmath362 we obtain the integral form as follows : @xmath363 where @xmath364 .",
    "we obtain the second equality using the mean value theorem for integrals : if @xmath365 is a continuous function and @xmath366 is integrable function that does not change sign on the interval @xmath367 $ ] , then there exists @xmath368 $ ] such that @xmath369 since equation ( [ integralform ] ) is true for all sbss , taking expectation of this equality above for all sbss ( or all possible values of @xmath146 ) , we have @xmath370 -\\mathbb{e}[e(t ) ] & =   -\\mathbb{e}[p(\\bar{t},e(\\bar{t}))]t ' + \\sigma\\mathbb{e}[w_{t+t'}-w_{t } ] , \\\\",
    "\\int\\limits_{0}^{\\infty}e m(t+t',e ) & de - \\int\\limits_{0}^{\\infty}em(t , e)de                       = -t'\\mathbb{e}[p(\\bar{t},e(\\bar{t } ) ) ] ,      \\end{aligned}\\ ] ] where @xmath147 is the distribution of @xmath146 in the system at time instant @xmath5 .",
    "using the fact that @xmath371 is a wiener process , @xmath372 follows a normal distribution with mean zero ( i.e. , @xmath373=0 $ ] ) .    by dividing both sides by @xmath374 and letting @xmath374 to be very small ( or @xmath375 )",
    ", we have @xmath376 and @xmath377 using @xmath378 , @xmath379 , and changing the variable @xmath146 to @xmath191 , we complete the proof .",
    "99 k. t. tran , h. tabassum , and e. hossain ,  a stochastic power control game for two - tier cellular networks with energy harvesting small cells , \" _ proc .",
    "ieee globecom14 _ , austin , tx , usa , 8 - 12 december , 2014 .",
    "n. michelusi , k. stamatiou , and m. zorzi , ",
    "transmission policies for energy harvesting sensors with time - correlated energy supply , \" _ ieee transactions on communications _ , vol .",
    "61 , no . 7 , jul .",
    "2013 , pp . 29883001 .",
    "p. semasinghe and e. hossain ,  downlink power control in self - organizing dense small cells underlaying macrocells : a mean field game , \" _ ieee transactions on mobile computing , _ doi : 10.1109/tmc.2015.2417880 .",
    "k. huang and v. k. lau ,  enabling wireless power transfer in cellular networks : architecture , modeling and deployment , \" _ ieee transactions on wireless communications _",
    "2014 , pp . 902912 .",
    "p. blasco , d. gunduz , and m. dohler , `` a learning theoretic approach to energy harvesting communication system optimization , '' _ ieee transactions on wireless communications , _ vol .",
    "4 , pp . 18721882 , apr . 2013 .",
    "d. ngo , l. b. le , t. l .- ngoc , e. hossain , and d.i .",
    "kim ,  distributed interference management in two - tier cdma femtocell networks , \" _ ieee transactions on wireless communications , _ vol .",
    "2012 , pp . 979989 .",
    "a. y. al - zahrani , r. yu , and m. huang ,  a joint cross - layer and co - layer interference management scheme in hyper - dense heterogeneous networks using mean - field game theory , \" _ ieee transaction of vehicular technology _ , doi : 10.1109/tvt.2015.2413394 .        s. guruacharya , d. niyato , d. i. kim , and e. hossain ,  hierarchical competition for downlink power allocation in ofdma femtocell networks , \" _ ieee transactions on wireless communications _ , vol .",
    "2013 , pp . 15431553 .",
    "m. huang , member , p. e. caines , and r. p. malham ,  uplink power adjustment in wireless communication systems : a stochastic control analysis , \" _ ieee transactions on automatic control _",
    "49 , no . 10 , oct .",
    "2004 , pp . 16931708 ."
  ],
  "abstract_text": [
    "<S> energy harvesting in cellular networks is an emerging technique to enhance the sustainability of power - constrained wireless devices . </S>",
    "<S> this paper considers the co - channel deployment of a macrocell overlaid with small cells . </S>",
    "<S> the small cell base stations ( sbss ) harvest energy from environmental sources whereas the macrocell base station ( mbs ) uses conventional power supply . given a stochastic energy arrival process for the sbss </S>",
    "<S> , we derive a power control policy for the downlink transmission of both mbs and sbss such that they can achieve their objectives ( e.g. , maintain the signal - to - interference - plus - noise ratio ( sinr ) at an acceptable level ) on a given transmission channel . </S>",
    "<S> we consider a centralized energy harvesting mechanism for sbss , i.e. , there is a central energy storage ( ces ) where energy is harvested and then distributed to the sbss . </S>",
    "<S> when the number of sbss is small , the game between the ces and the mbs is modeled as a single - controller stochastic game and the equilibrium policies are obtained as a solution of a quadratic programming problem . however , when the number of sbss tends to infinity ( i.e. , a highly dense network ) , the centralized scheme becomes infeasible , and therefore , we use a mean field stochastic game to obtain a distributed power control policy for each sbs . by solving a system of partial differential equations , </S>",
    "<S> we derive the power control policy of sbss given the knowledge of mean field distribution and the available harvested energy levels in the batteries of the sbss .    </S>",
    "<S> small cell networks , power control , energy harvesting , stochastic game , mean field game . </S>"
  ]
}