{
  "article_text": [
    "much work has gone into finding sufficient conditions for the optimal transportation map ( otm ) to be continuous . according to caffarelli @xcite ,",
    "the otm between two smooth densities ( uniformly bounded away from zero and infinity ) defined on bounded domains in @xmath9 with smooth boundaries is continuous when the target domain is convex .",
    "when @xmath10 , figalli ( * ? ? ?",
    "* theorem 3.1 ) showed that even when the target domain is not convex , the otm is still continuous outside a set of measure zero .",
    "this result has subsequently been extended to @xmath11 by figalli and kim @xcite .",
    "these results have also been studied for riemannian manifolds , see the recent survey by de philippis and figalli @xcite .",
    "however , there seems to be no known condition guaranteeing the discontinuity of planar otms .",
    "the main result of this article is such a condition .    in the present article",
    "we restrict ourselves to @xmath10 . throughout this article",
    ", we denote the uniform probability measures on @xmath0 and @xmath1 by @xmath12 respectively .",
    "we suppose for simplicity that @xmath13 and @xmath14 have unit area , i.e. , @xmath15 .",
    "of course , one could consider more general probability measures , and certainly the results we discuss below carry over to measures with smooth densities that are uniformly bounded away from zero and from above .",
    "our main interest is in the following :    give conditions on @xmath0 and @xmath1 guaranteeing the discontinuity of the optimal transportation map from @xmath3 to @xmath4 .",
    "the main result of this note is a sufficient condition guaranteeing the discontinuity of the otm between two domains in @xmath16 assuming the source domain @xmath13 is convex .",
    "this condition can be phrased solely in terms of the geodesic curvature of the boundary of the target domain .",
    "moreover , we give examples to show that the numerical constant in our condition is essentially sharp .",
    "nevertheless , we show that the condition is not a necessary one for discontinuity .",
    "in addition , we give an alternative proof of a result of wolfson and urbas on the nonexistence of an otm that extends smoothly to the boundary between arbitrary domains in @xmath16 .",
    "our methods are different from theirs in that we rely on cyclical monotonicity .",
    "this is what allows us to prove interior discontinuity as opposed to just non - smoothness up to the boundary .",
    "finally , we revisit an example of caffarelli and analyze precisely where the discontinuities occur using symmetry arguments and results of caffarelli and figalli . unlike caffarelli , we give a constructive proof of the discontinuity , and quantify where and how this discontinuity appears .",
    "this note is organized as follows : in section [ sec : suff - discont ] , we state and prove our conditions for discontinuity .",
    "we also give several examples illustrating when these conditions do and do not hold .",
    "then , in section [ squareman ] , we consider a concrete example ( which we term the `` squareman '' ) of an optimal map between two domains in which we can precisely determine how the map fails to be continuous .",
    "finally , in appendix [ sec : app ] , we state and prove several lemmas that we need for the proof of the curvature condition .",
    "in this section we derive a sufficient condition for the discontinuity of the otm between @xmath13 and @xmath14 based on the geometry of the boundaries .",
    "we further show how our method proves a result of wolfson , which was subsequently refined by urbas .",
    "it is interesting to note that while wolfson s original proof uses symplectic geometry , our approach is based on convex analysis .    consider a simple closed @xmath17 curve @xmath18 , and let @xmath19 denote the inward - pointing unit normal along @xmath20 . given a unit - speed parametrization @xmath21 of @xmath20 ( here",
    ", @xmath22 denotes an interval , which we can assume equals @xmath23 $ ] without any loss of generality ) , the curvature of @xmath20 is defined to be the function @xmath24 satisfying @xmath25 . note that since we have defined the signed curvature with respect to the inward pointing unit normal , it is independent of the orientation of the curve . in this article , we will refer numerous times to connected subsets or connected components of a simple ( possibly closed ) curve .",
    "both of these simply refer to a subset of the ( image of the ) curve which is connected ( and hence , path connected ) in the subspace topology induced from @xmath2 . in particular , we are not referring to maximally ( path ) connected components of the curve .",
    "since a continuous bijection from a compact space to a hausdorff space is automatically a homeomorphism , and all our curves have domain @xmath26 $ ] or @xmath27 , it follows that a subset of the curve @xmath28 is connected if and only if it is of the form @xmath29 , where @xmath30 is a sub - interval of @xmath26 $ ] or @xmath27 .",
    "[ mainthm ] let @xmath0 and @xmath1 be bounded , connected , simply connected open domains in @xmath2 such that @xmath31 and @xmath8 are @xmath32 , closed curves .",
    "assume @xmath0 is convex .",
    "equip @xmath0 and @xmath1 with the uniform measures @xmath3 and @xmath4 .",
    "let @xmath33 and @xmath34 be the signed curvatures of @xmath31 and @xmath8 with respect to the corresponding inward - pointing unit normal fields .",
    "if there exists a connected subset @xmath35 with @xmath36 then @xmath37 the otm from @xmath0 to @xmath1 , is discontinuous .",
    "we employ similar techniques , together with an additional modification , to give a new proof of the following result due to wolfson and urbas @xcite .",
    "[ maincor ] let @xmath0 and @xmath1 be two bounded , connected , simply connected domains in @xmath2 with @xmath17 boundaries .",
    "let @xmath33 and @xmath34 denote the signed curvatures ( as defined above ) of the two boundaries .",
    "assume that @xmath38 where @xmath30 and @xmath39 are connected subsets of @xmath31 and @xmath8 , respectively .",
    "then there does not exist a @xmath40-diffeomorphism @xmath41 whose restriction to @xmath13 is an otm .    when @xmath0 is convex , of course @xmath42 .",
    "one may ask whether may be weakened .",
    "below , we will construct an example ( example 6 ) to show that at least when the @xmath32 hypothesis in theorem [ mainthm ] is replaced with piecewise smooth , the constant @xmath43 in can not be increased .",
    "however , is not a necessary condition : in section [ squareman ] we will construct an example where @xmath0 is convex and @xmath1 has a connected subset of total curvature of at most @xmath44 , but @xmath45 is discontinuous .",
    "condition is also not necessary : below ( example 5 ) , we construct @xmath0 and @xmath1 so that @xmath46 , but @xmath45 is not a @xmath40 diffeomorphism up to the boundary .",
    "the strength of theorem [ mainthm ] lies in the fact that it does not assume any nice behavior of the optimal map near the boundary . at the same time it shows not only lack of regularity , but discontinuity . in the proof of theorem [ mainthm ] ,",
    "the convexity is used to show a continuous otm from @xmath0 to @xmath1 is necessarily a @xmath40-diffeomorphism , by caffarelli s regularity theorem .",
    "if we are concerned only with the nonexistence of otms which are @xmath40 diffeomorphisms up to the boundary , one can do away with the convexity assumption , which is the content of theorem [ maincor ] .",
    "the proof of theorem [ maincor ] contains two differences from the proof of theorem [ mainthm ] .",
    "first , the technical lemma [ technicallemma ] is no longer necessary , since we are assuming regularity up to the boundary . on the other hand , condition is weaker than , and so one must make use of cyclical monotonicity and not just of monotonicity",
    ".    assume for the sake of contradiction that the otm @xmath47 is continuous everywhere on @xmath0 .",
    "since @xmath0 is convex , we have from caffarelli s regularity theorem ( * ? ? ? * theorem 12.50 ) that the map @xmath48 ( the optimal map from @xmath1 to @xmath0 ) is @xmath49 everywhere on @xmath1 .",
    "we also know that for @xmath3-almost all @xmath50 and for @xmath4-almost all @xmath51 , @xmath52 and @xmath53 ( * ? ? ?",
    "* theorem 2.12 ) .",
    "since both compositions are continuous and are equal to the identity almost everywhere , it follows that they must be the identity everywhere , and therefore , that @xmath54 everywhere .",
    "moreover , since @xmath48 is @xmath49 by caffarelli s regularity theorem , and since its jacobian matrix is nonsingular at every point in @xmath1 by the monge - ampre equation , it follows from the inverse function theorem that @xmath55 is also @xmath49 .",
    "hence @xmath48 is a @xmath49-diffeomorphism between @xmath1 and @xmath0 .    for sufficiently small @xmath56 ,",
    "consider the sets ( see figure [ fig:1 ] ) @xmath57 from proposition [ app1 ] , we know that there exists @xmath58 such that for every @xmath59 , the curve @xmath60 is @xmath61 .",
    "furthermore , there exists a diffeomorphism @xmath62 such that the vector @xmath63 is normal to @xmath8 at @xmath50 and to @xmath60 at @xmath64 , and has magnitude @xmath65 .",
    "consider the image @xmath66 .",
    "is `` close '' to @xmath8 and @xmath67 is convex . ]",
    "since @xmath48 is @xmath49 and @xmath60 is compact , we have that @xmath68 is also a compact , closed @xmath61 curve , so that in particular , @xmath69 . in order to be able to work in the interior of @xmath0",
    ", we would like to construct a @xmath17 convex curve @xmath70 such that the interior of the region enclosed by @xmath67 completely contains @xmath71 .",
    "note that here , and elsewhere , we use the standard terminology of calling a closed curve convex if it is the boundary of a bounded convex set .",
    "such a @xmath67 can readily be constructed : we pick a point @xmath72 contained in the interior of the region bounded by @xmath71 and scale points on @xmath31 with respect to @xmath72 by a factor @xmath73 for a small enough @xmath74 .",
    "denote the resulting curve by @xmath75 .",
    "then , @xmath75 is seen to be convex and @xmath17 , since @xmath31 is convex and @xmath17 ( in fact we have assumed that it is @xmath32 ) .",
    "further , we can always arrange @xmath76 by picking @xmath74 small enough .",
    "in particular , we can choose @xmath77 so that @xmath78 contains @xmath71 completely in its interior , and is as close to @xmath31 as desired .",
    "note that the convexity of @xmath67 implies that the signed curvature @xmath79 of @xmath67 with respect to the inward unit normal field is non - negative .",
    "next , consider the @xmath17 curve @xmath80 .",
    "we claim that @xmath81 contains @xmath60 in its interior in the sense that every continuous path between @xmath60 and @xmath8 must intersect @xmath81 .",
    "indeed , let @xmath82\\rightarrow\\bar{\\lambda}$ ] ( note that we may assume without loss of generality that @xmath83 ) be a continuous map such that @xmath84 and @xmath85 . then , @xmath86 , while @xmath87 by the finite intersection property applied to the compact space @xmath88 .",
    "we claim that @xmath89 . indeed , suppose that @xmath90 .",
    "since the intersection is nonempty and contained in @xmath88 , we must have some point @xmath91 such that @xmath92 .",
    "consider the point @xmath93 .",
    "since @xmath94 , we can ( by the continuity of @xmath95 ) find some @xmath96 sufficiently close to @xmath97 such that @xmath98 $ ] .",
    "since @xmath99 is an open map on @xmath1 by hypothesis , it follows that @xmath100 , which gives us a contradiction .",
    "once we have that @xmath101we can prove that @xmath102 intersects @xmath67 , and hence , that @xmath95 intersects @xmath81 .",
    "for this , it clearly suffices to show that there exists some @xmath103 such that for all @xmath104 one has @xmath105 .",
    "suppose such a @xmath106 does not exist .",
    "then , there exists a sequence @xmath107 such that @xmath108 sits inside the closure of the domain bounded by @xmath67 ( we will denote this domain by dom@xmath109 ) . by compactness of dom@xmath109",
    ", we can assume after possibly passing to a subsequence that @xmath110 in dom@xmath109 .",
    "but then , we have that @xmath111 , and @xmath112 , which is a contradiction . note that since connected components are preserved under homeomorphisms , @xmath60 is a jordan curve , and @xmath81 contains at least one point in @xmath60 , we have also showed that @xmath113 .",
    "we will need the following lemma .",
    "[ technicallemma ] let @xmath114 be the signed curvature of @xmath81 with respect to the inward pointing unit normal vector field .",
    "then for sufficiently small @xmath115 there exists some connected subset @xmath116 for which the total signed curvature is less than @xmath43 , i.e. , @xmath117 .",
    "the lemma says that a closed curve `` close '' to the boundary of our domain must exhibit similar curvature behaviour .",
    "we will prove this after we show how it implies the curvature condition .",
    "using lemma [ technicallemma ] , we can pick a connected @xmath116 such that@xmath117 .",
    "let @xmath118 be the length of @xmath119 .",
    "we denote a unit speed parametrization for @xmath119 by @xmath120\\to i_{1}$ ] .",
    "since @xmath48 is an optimal map from @xmath4 to @xmath3 , we have from monotonicity ( * ? ? ?",
    "* proposition 2.24 ) that for any two points @xmath121 , @xmath122 . in particular , for every @xmath123 and for a suitably small @xmath124",
    ", we must have that @xmath125 dividing by @xmath126 and letting @xmath127 in the previous equation , we get that @xmath128 where @xmath129 is a parametrization of @xmath130 .",
    "note @xmath131 as @xmath48 is locally a diffeomorphism around every @xmath132 .",
    "equation implies that the tangent vectors to @xmath81 and @xmath67 at any @xmath133 and @xmath134 must have a non - negative inner product .",
    "we show that this can not happen , thereby proving theorem [ mainthm ] ( modulo the proof of lemma [ technicallemma ] ) .",
    "intuitively , it is clear that this can not happen : as we move along @xmath119 counterclockwise , the tangent vector at a point along @xmath119 rotates clockwise , while the tangent vector at the corresponding point on @xmath67 rotates counterclockwise .",
    "monotonicity dictates that the angle between the corresponding vectors must always be within @xmath135 .",
    "however , since the curvature of @xmath119 is less than @xmath43 , and the curvature of the corresponding connected subset of @xmath67 is @xmath136 by convexity , the angle between corresponding tangent vectors changes by more than @xmath43 when traversing @xmath119 , and therefore , can not lie in @xmath137 $ ] at all points of @xmath119 .    to make the above discussion more precise ,",
    "consider the `` tail - to - tail '' angle between two vectors .",
    "this is the standard notion of angle which takes values in the interval @xmath138 $ ] . given an ordered pair of vectors , we define the angle between them as the signed `` tail - to - tail angle '' between them , with the sign taken to be positive if we move counterclockwise from the first vector to the second and negative otherwise .",
    "we now define @xmath139\\to(-\\pi,\\pi]$ ] , where @xmath140 is the angle from @xmath141 to @xmath142 . from it",
    "follows that @xmath143 $ ] for every @xmath144 $ ] .",
    "set @xmath145)\\subset i_{1}$ ] .",
    "then @xmath146 where @xmath147 .",
    "since @xmath81 and @xmath67 are @xmath17 , the unsigned angle between @xmath142 and @xmath141 defined from @xmath148 $ ] to @xmath149 varies continuously .",
    "therefore , any discontinuities in the signed angle @xmath140 can occur only near the values @xmath43 and @xmath150 .",
    "but since @xmath143 $ ] , it is never close to @xmath150 or @xmath43 and therefore must be continuous everywhere on @xmath148 $ ] . hence @xmath151 must also be continuous . but @xmath152 is integer - valued , so it is the constant @xmath153 . in particular yields",
    "@xmath154 setting @xmath155 in , we get @xmath156 where the inequality holds since @xmath157 and @xmath158 for every @xmath159 as @xmath67 is the boundary of a convex set . on the other hand",
    "@xmath160 $ ] since @xmath143 $ ] for all @xmath144 $ ] .",
    "this contradicts @xmath161 .",
    "hence our assumption that @xmath55 is continuous must be incorrect , and @xmath55 is discontinuous as desired .",
    "recall @xmath162 dist@xmath163 , and @xmath81 contains @xmath60 in its interior in the sense that every continuous path between @xmath60 and @xmath8 must intersect @xmath81 . also recall that by assumption , @xmath164 for some connected subset @xmath165",
    "the underlying idea is to choose a connected subset of @xmath81 which is close to the connected subset @xmath30 of @xmath8 , and then show that this subset must necessarily contain a further connected subset of signed curvature less than @xmath43 .",
    "we have illustrated the arguments made below in figure [ fig:2 ] .",
    "let @xmath166 and @xmath167 be the endpoints of @xmath30 .",
    "let @xmath168 . then pick @xmath169 close to @xmath166 so that the angle between @xmath170 and the tangent to @xmath8 at @xmath166 is less than @xmath171 . similarly pick some @xmath172 close to @xmath167 which satisfies the same criterion . for @xmath56 small , consider the curve @xmath60 . recall @xmath173 maps points on @xmath174 to points @xmath115 away on @xmath60 .",
    "now @xmath175 , @xmath176 , @xmath177 and @xmath178 are points on @xmath60 . by selecting @xmath56 small enough",
    ", we can ensure that for any @xmath179 and any @xmath180 , the angle between @xmath181 and @xmath182 belongs to the interval @xmath183 , and also that for any @xmath184 and @xmath185 , the angle between @xmath186 and @xmath187 belongs to the interval @xmath183 .",
    "this is equivalent to saying that the direction of @xmath182 differs by no more than @xmath188 from the direction of @xmath8 at the point @xmath166 , and the direction of @xmath187 differs by no more than @xmath188 from the direction of @xmath8 at the point @xmath167 .",
    "next , from proposition [ app3 ] , we have that there exists a connected subset @xmath189 which is contained in the region bounded by @xmath30 , @xmath181 , @xmath186 and @xmath60 , and which has endpoints @xmath190 and @xmath191 .",
    "we move along @xmath192 from @xmath193 to @xmath194 and denote by @xmath195 the point where @xmath192 intersects @xmath196 for the first time .",
    "we denote by @xmath197 the point where @xmath192 intersects @xmath198 for the last time . from proposition",
    "[ app2 ] , we further know that there exists a point @xmath199 lying on the portion of @xmath192 between @xmath193 and @xmath195 at which the direction of the tangent to @xmath192 coincides with the direction of @xmath200 . in particular , the angle between the tangent to @xmath192 at @xmath199 and the segment @xmath181 is in the interval @xmath183 .",
    "similarly , we can choose a point @xmath201 that lies on the portion of @xmath192 connecting @xmath197 to @xmath194 such that the angle between the tangent to @xmath192 at @xmath201 and @xmath186 is in the interval @xmath183 .",
    "enclosed by the region of negative curvature . ]    finally , we are in a position to establish the existence of the interval @xmath202 for which @xmath117 with respect to the unit normal pointing inside the bounded component of the complement of the jordan curve @xmath81 .",
    "equivalently , it is the signed curvature with respect to the standard orientation on @xmath2 and with @xmath119 oriented from @xmath194 to @xmath193 .",
    "we will always use this sign of curvature for ( connected components ) of @xmath192 .",
    "denote by @xmath203 the angle between the tangent to @xmath192 at the point @xmath193 and the vector @xmath204 and by @xmath205 , the angle between the vector @xmath206 and the tangent to @xmath192 . in this definition",
    ", we have used the tangent vector to @xmath192 when it is oriented from @xmath207 to @xmath208 . note that both @xmath203 and @xmath205 are in @xmath209 $ ] .",
    "we now apply the gauss - bonnet theorem to the region ( with its boundary oriented counterclockwise ) bounded by @xmath30 , @xmath192 , @xmath210 and @xmath211 to get that @xmath212    note the negative sign in front of the integral over @xmath192 , which comes from the fact that the orientation of @xmath192 in this calculation is from @xmath207 to @xmath208 , which is the opposite of what we had originally used ( i.e. from @xmath208 to @xmath207 ) in computing @xmath213 . simplifying , we have @xmath214 we will now split @xmath192 into three parts and",
    "show that some connected combination of these three parts has a total signed curvature lesser than @xmath43 with the original orientation i.e. with @xmath192 going from @xmath194 to @xmath193 .",
    "note that the points @xmath199 and @xmath201 provide such a splitting naturally .",
    "denote these three components of @xmath192 between @xmath193 and @xmath199 , @xmath199 and @xmath201 , and @xmath201 and @xmath194 by @xmath215 , @xmath216 , @xmath217 respectively .",
    "for some @xmath218 , @xmath219 for some integer @xmath220 , and @xmath221 for some integer @xmath222 .    if @xmath223 , then @xmath224 taking @xmath225 small enough , we get @xmath226 in which case @xmath227 is the desired segment .",
    "if @xmath228 , then @xmath229 as long as we take @xmath168 sufficiently small . hence , in this case we have that @xmath230 has total curvature less than @xmath43 .    similarly ,",
    "if @xmath231 , then using one of the arguments above , we can take @xmath119 to be either @xmath217 or @xmath232 .",
    "thus , the only case left to investigate is when @xmath233 . in this case",
    ", @xmath234 combining these two equations , we get that @xmath235 in particular , if we choose @xmath236 , then , it follows that @xmath237 and thus in this case , @xmath216 satisfies the claim .",
    "this completes the proof of the lemma .",
    "assume the existence of such @xmath55 .",
    "we follow the notation established in the proof of theorem [ mainthm ] .",
    "pick @xmath35 so that @xmath238 .",
    "we can choose such a @xmath35 because by assumption , @xmath239 , and the infimum on the left hand side is attained because @xmath8 is compact .",
    "let @xmath240\\to j$ ] be the unit speed parametrization of @xmath39 , so that @xmath241 where @xmath242 is the inward pointing unit normal at @xmath243 and @xmath244 is the length of @xmath39",
    ". from monotonicity ( recall ) , @xmath143 $ ] for all @xmath245 .",
    "but we also have that for every @xmath144 $ ] , @xmath246)}\\kappa_{\\partial\\lambda}-\\int_{t_1^{-1}(\\gamma([0,t]))}\\kappa_{\\partial\\omega}+2k(t)\\pi\\ ] ] where as before @xmath152 is an integer that accounts for the discontinuity that amounts from restricting the codomain of @xmath247 to @xmath138 $ ] .",
    "since @xmath143 $ ] , @xmath248 .",
    "thus @xmath249)}\\kappa_{\\partial\\lambda}-\\int_{t_1^{-1}(\\gamma([0,t]))}\\kappa_{\\partial\\omega}=f(t)-f(0).\\ ] ] on the other hand , from the choice of @xmath35 , we have that @xmath250))}\\kappa_{\\partial\\omega}-\\int_{\\gamma([0,l])}\\kappa_{\\partial\\lambda } =   \\int_{t_1^{-1}(j)}\\kappa_{\\partial\\omega}-\\int_{j}\\kappa_{\\partial\\lambda }    \\ge \\inf_{i\\subset\\partial\\omega}\\int_{i}\\kappa_{\\partial\\omega}-\\int_{j}\\kappa_{\\partial\\lambda}\\ge \\pi.\\end{aligned}\\ ] ]    to conclude the proof , we claim that @xmath251 . to see this , observe that for any @xmath252 @xmath253 by cyclical monotonicity , or equivalently @xmath254 now by brenier s theorem @xmath255 for some convex function @xmath256 on @xmath14 which is @xmath49 by our assumptions , and since @xmath257 this function is strongly convex in the sense that @xmath258 . since @xmath48 is @xmath40 we have @xmath259 , where @xmath260 .",
    "thus , @xmath261 now pick a closed disk that is contained in @xmath262 s.t .",
    "the circle bounding the disk is tangent to @xmath8 at @xmath50 .",
    "let @xmath263 be a unit speed parametrization of this circle .",
    "in particular , for some fixed @xmath264 we have that @xmath265 .",
    "set @xmath266 and @xmath267 and such that @xmath268 or equivalently @xmath269 . also , set @xmath270 .",
    "then , @xmath271 note that for sufficiently small @xmath272 , there exists a constant @xmath273 such that @xmath274 and @xmath275 . thus dividing both sides of the equation by @xmath276 and taking the limit as @xmath277 tends to zero",
    "gives @xmath278 as @xmath279 is the tangent vector to the disk at @xmath50 and @xmath280 .",
    "this completes the proof of the theorem .      in this section",
    "we will explore several concrete examples .",
    "the first one shows that the extended curvature criterion for the non - existence of otms which are diffeomorphisms up to the boundary is sufficient but not necessary .",
    "the second example shows that it is reasonable not to hope for a constant better than @xmath43 in the curvature criterion .",
    "consider the two domains pictured in figure [ fig:3 ] and suppose there exists an optimal map @xmath281 , which is a @xmath40-diffeomorphism .",
    "given @xmath56 small , we construct our domains so that @xmath282 . in particular , the hypotheses of theorem [ maincor ] ( and , of course , those of theorem [ mainthm ] , since @xmath0 is not convex ) do not apply here .",
    "note that @xmath8 has 4 disjoint connected subsets @xmath283 of signed curvature @xmath284 for some @xmath285 , while @xmath31 has only one negatively curved component , with signed curvature no lesser than @xmath286 . in particular , the integral of @xmath33 over any union of connected subsets of @xmath31 can not be lesser than @xmath286 .",
    "as before , we show that an otm @xmath5 ( as above ) can not exist , by showing that it violates the monotonicity condition for otms . indeed , by the `` tail - to - tail '' argument used in the proof of theorem 2 , we have that @xmath287    so that @xmath288    note that the images @xmath289 are disjoint .",
    "therefore , from the above discussion , we have @xmath290    for @xmath115 small enough , which is a contradiction .",
    "this completes the proof of the non - optimality of @xmath5 .",
    "let @xmath291 } be a half annulus and @xmath292 be the unit half disk .",
    "we equip them with the restricted lebesgue measure .",
    "note that this equips both @xmath0 and @xmath1 with probability measures .",
    "further note that @xmath1 is convex , while @xmath0 has a segment of curvature ( the inner half circle ) @xmath43 . also observe that both boundaries are piecewise smooth .",
    "we will show that the otm @xmath293 is continuous on the interior of @xmath0 .",
    "indeed we expect the map to preserve the points radially and to `` contract '' the half annulus to the half disk by preserving the area .",
    "such a map would take the form @xmath294    it is immediate to see @xmath5 is a diffeomorphism between @xmath0 and @xmath1 with @xmath295 , so that @xmath5 is area preserving .",
    "further , @xmath296 where @xmath297 is the smooth convex function given by @xmath298 but now @xmath5 is the gradient of a convex function , and is also area preserving . by brenier s theorem ( *",
    "* theorem 2.12 ) , it is the unique otm between @xmath0 and @xmath1 .",
    "one of the characteristics of the subject of optimal transport is that despite many deep results on existence and regularity of otms , it is still very hard to explicitly compute the otm in almost any non - trivial example .",
    "caffarelli gave an example of a discontinuous otm to show that without convexity of the target his regularity theory could break down @xcite ( see also ( * ? ? ? * theorem 12.3 ) ) .",
    "he showed that the otm between a disk and two half disks connected via a sufficiently thin bridge is discontinuous .",
    "however , it is not exactly clear how `` thin '' the bridge should be and where and how the discontinuity arises . in this section",
    "we will consider an example very close to caffarelli s example , and hopefully provide the reader with some intuition of what the map looks like .",
    "in particular , we will discuss where and how the discontinuity arises in this example , and make some qualitative statements about the extent of this discontinuity .",
    "our computation relies on results due to caffarelli and figalli and we begin by recalling some of these results .    recall that if @xmath3 and @xmath4 are two probability measures ( not necessarily uniform ) supported on @xmath0 and @xmath1 respectively , then we denote by @xmath55 the optimal map which transports @xmath3 to @xmath4 .",
    "similarly , @xmath48 is the optimal map that transports @xmath4 to @xmath3 . in our setting , where @xmath299 are sufficiently regular measures supported on domains in @xmath2 and the transportation cost is the quadratic cost , we have that @xmath300 for some convex function @xmath301 on @xmath1 and @xmath302 on @xmath0 , where @xmath303 is the legendre transform of @xmath301 ( * ? ? ?",
    "* theorem 2.12 ) .",
    "let @xmath28 be the optimal transportation plan between @xmath3 and @xmath4 i.e. @xmath304 .",
    "we will need the following short lemma :    [ shortlemma ] assume that @xmath3 and @xmath4 are uniform measures supported on @xmath305 and @xmath306 respectively , where @xmath305 and @xmath306 are bounded , connected , simply connected , open domains in @xmath2 .",
    "let @xmath305 be convex .",
    "then the otm from @xmath306 to @xmath305 , denoted by @xmath5 , is smooth .",
    "further , @xmath5 is a diffeomorphism between @xmath306 and an open set @xmath307 of full measure .    since @xmath305 is convex , caffarelli s regularity theory is applicable .",
    "hence @xmath5 is smooth on @xmath306 . by the monge  ampre equation , @xmath308 for some @xmath309 almost everywhere on @xmath306 .",
    "since @xmath5 is smooth , it follows that @xmath310 everywhere .",
    "in particular , by the inverse function theorem @xmath5 is a local diffeomorphism at every point of @xmath306 . to show that @xmath5 is a global diffeomorphism between @xmath306 and @xmath311 , we only need to show that @xmath5 is injective .",
    "this follows , for instance , from caffarelli s result on strict convexity of solutions to the monge  ampre equation above , but we also give an elementary argument .",
    "indeed , assume on the contrary that there exist @xmath312 such that @xmath313 .",
    "pick @xmath56 such that @xmath314 and @xmath5 is a diffeomorphism when restricted separately to both @xmath315 and @xmath316 .",
    "let @xmath317 . since @xmath166 is non - empty and open , it must have positive measure .",
    "but then , for every @xmath318 the set @xmath319 contains at least two elements - one from @xmath315 and one from @xmath316 , where @xmath28 is the optimal transportation plan between @xmath3 and @xmath4 .",
    "this means that @xmath28 is not a monge map since it sends every element in @xmath166 to at least two locations , which contradicts brenier s theorem .",
    "it follows that @xmath5 is a global diffeomorphism between @xmath306 and @xmath320 .      finally , in our example below",
    ", we will need two additional properties , which we state now : + property * a * : restrictions of optimal maps are still optimal between the restricted domain and its image .",
    "* theorem 4.6 ) + property * b * : if the optimal map between @xmath0 and @xmath1 is of the form @xmath323 , then the set @xmath324 contains a segment@xmath325 is empty .",
    "* proposition 3.2 )      we now introduce a specific example we refer to as the squareman .",
    "let @xmath3 be the uniform probability measure on a rectangle @xmath0 with sides @xmath326 and @xmath327 , and @xmath4 be the uniform probability measure on @xmath1 , which is made up of two rectangles - a rectangle @xmath328 with sides @xmath329 and @xmath330 , and another rectangle @xmath331 on top of it with sides @xmath332 and @xmath333 , where @xmath334 ( see figure [ fig:4 ] ) .",
    "note that since the optimal map is invariant under translations of @xmath0 and @xmath1 , it does not depend on the relative positions of the domains with respect to each other .",
    "our example is similar to the one by caffarelli : indeed , if we work with rectangles instead of disks , then the example by caffarelli transforms to transporting a rectangle to an h - shape figure . due to symmetry",
    ", we can divide these figures into 4 different symmetric parts and look at the otm for each one .",
    "but this is exactly the example we are considering .",
    "since @xmath0 is convex , it follows from lemma [ shortlemma ] that the map @xmath48 is a diffeomorphism onto its image , which is a set of full measure in @xmath0 .",
    "further , by proposition [ app4 ] , it follows that there exists a continuous extension of @xmath48 from @xmath262 to @xmath88 .",
    "however , since @xmath1 is not convex , we can not make any such claims about @xmath55 .",
    "in fact , we will show below that @xmath55 is discontinuous , and further , give a qualitative statement of how discontinuous it is .",
    "note that since @xmath8 does not contain any connected subset with total signed curvature less than @xmath335 , this shows that the condition in theorem [ mainthm ] is not necessary .",
    "note that brenier s theorem and caffarelli s regularity theory are applicable only to the interiors of @xmath0 and @xmath1 . however , in this particular example , we will take advantage of the fact that the boundaries of the two domains are parts of straight segments . using this",
    ", we will be able to identify where parts of the boundary @xmath8 are mapped by @xmath48 , which will give us useful information about the discontinuity of the map @xmath302 .",
    "indeed , if we knew that two points @xmath336 and @xmath337 are mapped to an interior point @xmath338 , and since @xmath48 is continuous , then @xmath339 would contain both @xmath340 and @xmath341 , and in particular , the extent of discontinuity of @xmath55 at @xmath50 would be at least the distance between @xmath340 and @xmath341 .    in the following four steps we will determine how the map @xmath48 behaves on the boundary of @xmath1 and",
    "this will also give us information about the behaviour of @xmath55 .",
    "in particular , we will justify figure [ fig:5 ] , in which same - colored segments are mapped to same - colored segments .",
    "the 4 steps are as follows : + @xmath342 @xmath343 and @xmath344 and both restrictions are homeomorphisms .",
    "furthermore , @xmath345 and @xmath346 .",
    "@xmath347 we have that either @xmath348 or @xmath349 . in particular , we can assume without any loss of generality that @xmath348 , so @xmath350 homeomorphically .",
    "we will further show that @xmath351 lies completely in @xmath0 except for , of course , @xmath352 which is on the boundary .",
    "@xmath356 @xmath357 .",
    "+ @xmath342 @xmath343 and @xmath344 and both restrictions are homeomorphisms .",
    "furthermore , @xmath345 and @xmath346 .",
    "+ to get the desired information on @xmath8 , we are going to use what will henceforth be referred to as @xmath358 .",
    "more precisely , we reflect @xmath1 with respect to @xmath359 to get a domain of twice the area , @xmath360 and reflect @xmath0 with repect to @xmath361 to get a domain @xmath362 .",
    "see figure [ fig:6 ] .",
    "let @xmath363 and @xmath364 be uniform probability measures on @xmath362 and @xmath360 respectively with respective uniform densities @xmath365 and @xmath366 . as before ,",
    "since @xmath362 is convex , it follows from caffarelli s regularity theory that the ( @xmath4-almost everywhere ) unique , optimal map @xmath367 from @xmath360 to @xmath362 is smooth .",
    "we claim @xmath368 . * *    for simplicity let @xmath359 and @xmath361 lie on the @xmath50-axis and for any @xmath369 let @xmath370 denote its reflection with respect to the @xmath50-axis . due to symmetry , the map @xmath371 has the same cost as @xmath367 and by the uniqueness of the otm , we get @xmath372 for a.e",
    ". @xmath50 .",
    "but now if @xmath373 and @xmath50 and @xmath51 are on different sides of the @xmath50-axis , we know @xmath374 .",
    "it is immediately checked that this violates the cyclic monotonicity condition for @xmath50 and @xmath375 . in particular for almost all @xmath376 we get that @xmath377 and since @xmath367 is smooth we conclude that @xmath368 . also note @xmath378 since otherwise by the continuity of @xmath367 we could find a ball around a point on @xmath359 whose image under @xmath367 lies completely above or below the @xmath50-axis , which as we explained above violates cyclic monotonicity .",
    "note that there are two key conditions in the use of the reflection principle .",
    "first we need to reflect along a straight segment .",
    "second we need one of the domains after reflection to be convex .    from here , since optimality",
    "is inherited by restriction ( property * a * ) , and since brenier s theorem also guarantees almost - everywhere uniqueness of the optimal map , @xmath379 coincides with @xmath48 almost everywhere .",
    "since @xmath367 is smooth , this gives us a smooth extension of @xmath48 to the interior of the segment @xmath359 and @xmath380 .",
    "note that proposition [ app4 ] already gives us a continuous extension of @xmath48 to the entire boundary @xmath8 .",
    "however , by using the reflection principle here , we have a smooth extension of @xmath48 to the interior of the segment @xmath359 , and more importantly , we get information about the image of this extension on the interior of the segment @xmath359 . similarly , we get an extension of @xmath48 to the interior of @xmath381 and @xmath382",
    ". we will use the same notation for @xmath48 and its continuous extensions to ( parts of ) @xmath8 .    further ,",
    "observe we can also use the reflection principle again and reflect @xmath360 with respect to the line containing @xmath381 to get @xmath383 and reflect @xmath362 with respect to the line containing @xmath384 to get @xmath385 . now the newly obtained domains are 4 times the size of the original ones and @xmath385 is still convex .",
    "the motivation for doing so is to include the points @xmath167 and @xmath194 in the interiors of the domains @xmath383 and @xmath385 respectively .",
    "exactly as above due to symmetry and smoothness of the optimal map , it follows that the optimal map must send @xmath167 to @xmath194 . therefore using lemma [ shortlemma ] we have that @xmath48 maps the half - open segment @xmath386 ( with @xmath167 included )",
    "injectively to a ( possibly strict ) subset of @xmath387 ( with @xmath167 mapping to @xmath194 )    similarly , we can reflect @xmath360 with respect to the line containing @xmath388 to get @xmath389 and reflect @xmath362 with respect to the line containing @xmath390 to get @xmath391 .",
    "using exactly the same arguments as in the preceding paragraph , it follows that @xmath48 extends to a continuous , injective map on the entire closed segment @xmath359 , @xmath392 and @xmath380 .",
    "in fact , since @xmath393 and @xmath394 , we have that @xmath343 so that @xmath48 is a homeomorphism between the closed segments @xmath359 and @xmath361 .",
    "note that symmetry considerations in the optimal map from @xmath389 to @xmath391 lead to the conclusion that the interior of the segment @xmath388 must be mapped to a part of the interior of the segment @xmath390 . since we can not perform any reflection of the form considered earlier to include @xmath395 in the interior of the reflected domain",
    ", we can not claim that @xmath48 can be extended to a continuous map till @xmath395 and , in particular , that @xmath348 .",
    "in fact , as we will end up showing @xmath396 might be distinct from @xmath397 .",
    "it is clear now , using exactly the same arguments as above , that @xmath398 and in fact , that @xmath48 is a homeomorphism between the closed segments @xmath381 and @xmath384 .",
    "similarly , it also follows that @xmath48 extends smoothly to the interior of the segment @xmath399 and sends it to part of the interior of the segment @xmath400 .",
    "+ @xmath347 we have that either @xmath348 or @xmath349 . + after proving step 2 , we may thus assume ( without loss of generality ) that @xmath348 , so @xmath350 homeomorphically .",
    "we will further show that @xmath351 lies completely in @xmath0 except for , of course , @xmath352 which is on the boundary .    to check the above first note that @xmath401 is of full measure and is compact , so it must be that @xmath402 . furthermore we know @xmath403 , so it must be that @xmath404 .",
    "since in step 1 we determined where @xmath8 is mapped except for the segments @xmath405 and @xmath406 we must have that @xmath407 now we will study @xmath351 .",
    "set @xmath408 .",
    "note @xmath81 is a continuous curve from @xmath199 to @xmath409 .",
    "then @xmath410 is a continuous loop .",
    "note it is simple since if a point @xmath50 is an intersection point , then @xmath339 would contain a segment in @xmath411 , which contradicts ( property @xmath412 ) .",
    "hence by the jordan curve theorem the loop bounds some open set @xmath413 , and we will refer to this loop as @xmath414 . note that neither @xmath415 nor @xmath416 can intersect @xmath417 ( property @xmath412 ) .",
    "also , both @xmath415 and @xmath416 are path connected , since @xmath331 and @xmath328 are path connected and @xmath48 is continuous . in particular",
    ", @xmath418 is either completely contained inside @xmath419 or completely contained inside @xmath420 , and a similar statement also holds for @xmath415 .",
    "finally , note that by step 1 , the intersection of a ball of sufficiently small radius centered at @xmath421 with @xmath88 is contained inside @xmath422 .",
    "we claim that @xmath423 . indeed , suppose this is not so .",
    "then , we must have @xmath418 is contained in @xmath420 as noted above .",
    "we will show that this leads to a contradiction . to see this , choose a continuous path @xmath28 in @xmath331 with one endpoint at @xmath424 .",
    "since @xmath425 , and the intersection of a sufficiently small ball centered at @xmath421 with @xmath88 is contained inside @xmath422 , it follows that there exist points in @xmath28 which must be mapped to @xmath426 by @xmath48 , so that we can not have @xmath427 .",
    "therefore , @xmath428 and in fact , @xmath418 is of full measure in @xmath419 since @xmath403 is of full measure in @xmath0 .",
    "since the restriction of an optimal map ( property * a * ) is optimal we get that @xmath429 is the optimal map between the two domains .",
    "now we are in a position to study @xmath351 .",
    "let @xmath430 be the point on @xmath351 satisfying the following two properties : ( a ) it lies on @xmath431 ( b ) it has the least distance to @xmath397 among all the points on @xmath406 whose images under @xmath48 lies on @xmath431 .",
    "we will show that @xmath432 .",
    "observe first that @xmath433 . indeed",
    "if this was not the case then for some @xmath434 we would have that @xmath435 , but then the pair of points @xmath436 would violate the cyclical monotonicity condition . note that even though these points are on the boundary of @xmath1 , the continuity of @xmath48 allows us to extend the cyclical monotonicity condition to these points .",
    "hence @xmath433 .",
    "now , we reflect @xmath419 with respect to @xmath437 and reflect @xmath331 with respect to @xmath438 .",
    "the reflection of @xmath331 is a convex domain , and therefore , we can use the reflection principle as before , from which we can conclude that @xmath439 .",
    "note here we are using the fact that @xmath440 is convex to be able to define @xmath55 everywhere on @xmath441 ( proposition [ app4 ] ) .",
    "however , we already knew that @xmath442 , so we conclude @xmath443 , so @xmath432 as desired .",
    "in particular , we get that @xmath444 . applying the same argument for @xmath445",
    "we conclude that @xmath446 where @xmath447 . in particular , and imply that @xmath448 or @xmath348 . due to symmetry between @xmath449 and @xmath395 ,",
    "we can assume without loss of generality that @xmath348 .",
    "further , if @xmath450 then since we have covered @xmath451 by boundary segments of @xmath452 we would get that @xmath339 contains a segment in @xmath262 , which contradicts ( property * b * ) .",
    "hence @xmath351 is in @xmath0 except for @xmath453 .",
    "note that here we used the fact that the only points of @xmath331 that can be mapped to the same point are pairs of points on @xmath406 and @xmath405 since the segment connecting them intersects @xmath262 at isolated points and not segments ( property * b * ) + @xmath353 for some @xmath354 we have that @xmath355 homeomorphically .",
    "+ as we explained at the beginning of step 2 we must have that @xmath404 .",
    "the only part of @xmath8 whose position under @xmath48 we havent determined yet is @xmath405 . at the same time we know @xmath454 , so we conclude that @xmath455 .",
    "let @xmath456 be such that @xmath457 .",
    "it is clear now that by property * b * , @xmath458 is simple .",
    "further , note that if some @xmath459 maps to the @xmath431 then the pair @xmath460 would violate the cyclical monotonicity condition .",
    "hence since @xmath461 we must have that @xmath462 .",
    "but now @xmath458 is simple with endpoints @xmath397 and @xmath199 and it contains @xmath431 , so it must be that @xmath355 as desired",
    ". + @xmath356 @xmath357 .",
    "+ set @xmath463 and @xmath464 and note that both are simple curves ( property * b * ) .",
    "following the notation from above we have that @xmath465 .",
    "now @xmath466 is a jordan curve , so it bounds some @xmath467 .",
    "in particular we have that @xmath468 where @xmath469 is the curve without its endpoints .",
    "in step 2 we showed that @xmath418 is of full measure in @xmath419 . hence @xmath470 and",
    "is of full measure in @xmath467 .",
    "therefore @xmath471 restricts to an optimal map by property * a*. @xmath472 is its inverse , so it is optimal as well .",
    "but now @xmath328 is convex , so @xmath472 is smooth on @xmath467 by caffarelli s regularity theory and extends continuously to the boundary .",
    "now @xmath473 is compact and of full measure , so @xmath474 . since @xmath475",
    "we conclude that @xmath476 . we know that @xmath48 sends @xmath477 to @xmath478 homeomorphically by the previous three steps .",
    "this means @xmath479 , so we must have that @xmath480 . but",
    "note @xmath481 is a simple curve ( by property @xmath412 ) that contains @xmath482 and has endpoints @xmath483 and @xmath484 .",
    "hence it must be that @xmath485 homeomorphically , so we conclude that @xmath486 as desired .",
    "thus we have completely determined @xmath487 and thus we have justified the picture in figure [ fig:5 ] .",
    "further , we have determined that the set of discontinuity of @xmath55 is exactly the curve @xmath488 and for every @xmath489 , the subdifferential @xmath339 is a segment that connects the preimages of @xmath50 on @xmath482 and @xmath406 . in particular , as @xmath50 moves from @xmath490 to @xmath199 this segment grows and reaches @xmath491 as @xmath50 gets to @xmath199 .",
    "[ app1 ] assume @xmath1 is a bounded simply connected domain with @xmath17 boundary .",
    "then there exists an @xmath492 such that for all @xmath493 , @xmath494 is a @xmath61 simple curve with a diffeomorphism @xmath62 such that @xmath63 is normal to both curves at the points @xmath50 and @xmath64 and @xmath65 .",
    "define @xmath495 to be the inward pointing unit normal vector field .",
    "next define @xmath496 by @xmath497 .",
    "this map is well defined for @xmath115 small , so that @xmath498 .",
    "in fact we will show @xmath484 is the desired diffeomorphic map @xmath499 .",
    "note that for any @xmath500 there exists @xmath501 .",
    "we claim that there exists an @xmath492 such that @xmath502 for all @xmath500 .",
    "indeed , this is true because @xmath8 is assumed to be @xmath17 , so that its radius of curvature is a continuous , strictly positive function on @xmath8 , which is assumed to be compact . by taking @xmath503 to be smaller than the positive lower bound for the radius of curvature , the proof of the claim is complete",
    "therefore , for @xmath493 , we get @xmath504 , for any @xmath500 , so that in particular @xmath505 . furthermore if @xmath506 then there exists @xmath500 with @xmath507 , so in particular @xmath508 .",
    "hence @xmath509 .",
    "next note that @xmath484 is clearly 1 - 1 since @xmath510 for every @xmath500 .",
    "hence @xmath484 is a bijection .",
    "finally , note that since @xmath8 is @xmath17 then @xmath511 is @xmath61 and so @xmath484 is @xmath61 . hence @xmath509 is a @xmath61 curve which is diffeomorphic to @xmath8 . also by definition @xmath512 is normal to @xmath8 at @xmath50 and since @xmath513 we also have that @xmath512 is normal to @xmath60 at @xmath514 .",
    "this completes the proof of the proposition .",
    "let @xmath519 .",
    "by cauchy s mean value theorem , there exists some @xmath516 such that @xmath520 . without loss of generality",
    ", we can assume that @xmath521 .",
    "then , if @xmath522 , we get that @xmath523 , which contradicts the regularity assumption . dividing by @xmath524 , we have the result .",
    "[ app3 ] assume @xmath1 is a bounded simply connected domain with @xmath17 boundary .",
    "let @xmath56 be such that @xmath494 is a @xmath61 simple curve and @xmath62 be a diffeomorphism such that @xmath63 is normal to both curves at the points @xmath50 and @xmath64 and @xmath65 ( guaranteed to exist by proposition [ app1 ] ) .",
    "now let @xmath515\\to\\mathbb{r}^{2}$ ] be a simple @xmath61 closed curve that lies in @xmath1 and contains @xmath60 in its interior in the sense that every continuous path between @xmath60 and @xmath8 must intersect @xmath28 .",
    "also assume that @xmath28 intersects neither @xmath8 nor @xmath60 .",
    "then for all pairs @xmath525 of distinct points , if @xmath165 is the subset of @xmath8 that connects @xmath20 and @xmath424 as we move clockwise around @xmath8 there exists a connected subset of @xmath28 that lies completely in the closed figure @xmath526 bounded by the segments @xmath527,[d , d_{2}]$ ] and by @xmath30 and @xmath528 such that it has one endpoint on each of @xmath527 $ ] and @xmath529 $ ] , where @xmath177and @xmath178 .",
    "we prove this by contradiction .",
    "without loss of generality , we can assume that @xmath532 lies outside @xmath526 .",
    "let @xmath533 and @xmath534 . by the compactness of the unit interval , the continuity of @xmath28 , and the closedness of @xmath526 , the infimum and supremum are attained .",
    "consider @xmath535\\cap\\theta_{cd}$ ] .",
    "since we are assuming that there does not exist a connected subset of @xmath28 that lies completely in the closed figure @xmath526 such that it has one endpoint on each of @xmath527 $ ] and @xmath529 $ ] , it follows that there are two , mutually exclusive types of path connected components of @xmath536 - those that intersect @xmath537 $ ] and those that intersect @xmath538 $ ] .",
    "let @xmath539 denote the union of all the path connected components of @xmath536 that intersect @xmath537 $ ] and @xmath540 denote the union of those that intersect @xmath538 $ ] . then , @xmath539 and @xmath540 are disjoint , and we claim that they are also compact subsets of @xmath2 .",
    "first , let us see how the compactness of @xmath539 and @xmath540 finishes the proof .",
    "let @xmath541 denote the complement of @xmath526 in the region enclosed between @xmath8 and @xmath60 .",
    "let @xmath542\\cup[dd_{2}]$ ] .",
    "note that @xmath543 is a closed and bounded , hence compact subset of @xmath2 .",
    "finally , let @xmath544 and @xmath545 .",
    "then , the compactness of @xmath546 implies that @xmath547 are compact and further , for @xmath449 in the interior of @xmath30 and @xmath548 , we get that @xmath549 are not separated by @xmath166 or @xmath167 in the sense that they lie in the same path connected ( and hence , connected ) component of @xmath550 and of @xmath551 . to see that @xmath549 are not separated by @xmath166 , we begin by noting that the compactness of @xmath539 implies that the distance between @xmath539 and @xmath529 $ ] is always greater than some @xmath56",
    ". then , we can go from @xmath549 in @xmath550 by travelling along @xmath30 towards @xmath424 until we are at a distance @xmath552 away from @xmath424 , then moving parallel to @xmath529 $ ] until we hit @xmath528 , and finally , moving along @xmath528 to @xmath553 . here , we use the fact that @xmath539 does not intersect @xmath30 or @xmath528 .",
    "a similar argument shows that @xmath549 are not separated by @xmath167 .",
    "now , we recall janiszewski s theorem ( * ? ? ?",
    "* ap.3.2 ) , which says that if @xmath547 are compact subsets of @xmath2 such that @xmath554 is connected , and @xmath555 such that neither @xmath166 nor @xmath167 separates @xmath549 , then @xmath556 also does not separate @xmath549 .",
    "this implies that @xmath28 does not separate @xmath549 i.e. @xmath549 lie in the same connected component of @xmath557 ( and hence , the same path connected component of the open subset @xmath557 of @xmath2 ) .",
    "but this contradicts the hypothesis that @xmath60 lies in the interior of @xmath28 .",
    "so , to finish the proof , we only need to show that @xmath546 are compact .",
    "we do this only for @xmath539 , the proof for @xmath540 being similar .",
    "since @xmath539 is a bounded subset of @xmath2 , we only need to show that it is closed in @xmath2 .",
    "let @xmath558 be a sequence of points in @xmath539 such that @xmath110 .",
    "there exists a unique sequence @xmath559 $ ] such that @xmath560 . by the compactness of @xmath561 $ ] , we can , after possibly passing to a subsequence , assume that @xmath562 $ ] .",
    "after possibly passing to another subsequence , we can further assume that either @xmath563 or @xmath564 ( since the case where @xmath565 is eventually @xmath566 is trivial ) . in the subsequent discussion",
    ", we will assume that @xmath563 .",
    "the case @xmath564 is treated similarly .    by the continuity of @xmath28",
    ", it follows that @xmath567 . since @xmath568 $ ] , we have that either @xmath569 or @xmath570 .",
    "if @xmath569 , then we are done , so suppose that @xmath570 .",
    "since @xmath571 $ ] is path connected but @xmath572 and @xmath573 are in different path connected components of @xmath536 , it follows that @xmath571 $ ] must leave @xmath536 through @xmath527 $ ] .",
    "let @xmath574 be such that @xmath575 $ ] .",
    "note that we can always find such a @xmath576 by the previous remark .",
    "but then , @xmath577 , so that from the continuity of @xmath28 and the closedness of @xmath527 $ ] we get @xmath578 $ ] , which contradicts that @xmath579 .",
    "this completes the proof .",
    "[ app4 ] let @xmath0 and @xmath1 be bounded , connected , simply connected open domains in @xmath2 , equipped with the uniform measures @xmath3 and @xmath4 .",
    "assume that @xmath88 convex .",
    "then , the otm @xmath580 admits a single - valued , continuous extension to @xmath262 .    by considering @xmath4 as a measure on all of @xmath16 supported on @xmath1 , brenier s theorem furnishes a globally lipschitz convex function @xmath581 such that @xmath582 on @xmath1 ( the equality holds everywhere , instead of just almost everywhere , because of caffarelli s regularity theory ) , and @xmath583 since @xmath88 is convex ( * ? ? ? * lemma 1(b ) ) . for @xmath584 ,",
    "the set @xmath585 is convex @xcite , and so if it is not a singleton it contains a segment that is contained in the convex set @xmath88",
    ". however , this contradicts property * b * stated in  [ sqmansec ] .",
    "in particular , @xmath586 is differentiable on @xmath2 and therefore is @xmath40 ( * ? ? ? * theorem 25.5 ) , implying the statement ."
  ],
  "abstract_text": [
    "<S> consider two bounded domains @xmath0 and @xmath1 in @xmath2 , and two sufficiently regular probability measures @xmath3 and @xmath4 supported on them . by brenier s theorem </S>",
    "<S> , there exists a unique transportation map @xmath5 satisfying @xmath6 and minimizing the quadratic cost @xmath7 . furthermore , by caffarelli s regularity theory for the real monge  ampre equations , if @xmath1 is convex , @xmath5 is continuous .    </S>",
    "<S> we study the reverse problem , namely , when is @xmath5 discontinuous if @xmath1 fails to be convex ? </S>",
    "<S> we prove a result guaranteeing the discontinuity of @xmath5 in terms of the geometries of @xmath1 and @xmath0 in the two - dimensional case . </S>",
    "<S> the main idea is to use tools of convex analysis and the extrinsic geometry of @xmath8 to distinguish between brenier and alexandrov weak solutions of the monge  ampre equation . </S>",
    "<S> we also use this approach to give a new proof of a result due to wolfson and urbas .    </S>",
    "<S> we conclude by revisiting an example of caffarelli , giving a detailed study of a discontinuous map between two explicit domains , and determining precisely where the discontinuities occur .    . </S>"
  ]
}