{
  "article_text": [
    "experimental information about cosmic particles at very high energies is obtained through the study of atmospheric showers induced by these particles and is hence indirect",
    ". a necessary ingredient of these studies is therefore a good understanding of a shower initiated by a primary particle with given parameters .",
    "since the shower development is a complicated random process , the monte - carlo simulations are often used to model atmospheric showers .",
    "physical parameters are then reconstructed from the simulations and compared to real data .    at very high energies , however , the number of particles in a shower is so large that the simulations start to require unrealistic computer resources . among several ways to simplify the problem and to reduce the computational time , the thinning approximation  @xcite is currently the most popular one .",
    "its key idea is to track only a representative set of particles ; while very efficient in calculations and providing correct values of observables on average , this method introduces artificial fluctuations because the number of tracked particles is reduced by several orders of magnitude . these artificial fluctuations mix with natural ones and therefore reduce the precision of determination of physical parameters .    the standard approach",
    "to account for natural fluctuations in the air - shower simulations is to fix all shower parameters and to simulate sufficient number of artificial showers . technically , these showers differ by initial random seed numbers .",
    "all interactions in a simulated shower are fixed by these numbers for a given thinning level .",
    "random variations of these numbers result in a plethora of possible interaction patterns which end up in a distribution of an observable quantity of interest calculated for the showers with exactly the same initial physical parameters .",
    "this distribution thus intends to represent intrinsic fluctuations in the shower development .",
    "both the central value and the width of this distribution are important for physical applications .    in practice",
    ", however , the width of the distribution arises from two sources : physical fluctuations and artificial fluctuations introduced by thinning . to obtain the physical width alone",
    ", one should in principle perform simulations without thinning .",
    "this is hardly possible for the highest energies at the current level of computational techniques since one often needs to simulate thousands of events for a typical study .",
    "the aim of the present work is to estimate the relative size of these artificial fluctuations ( for the first time it is done by direct comparison of showers simulated with and without thinning ) and to develop an efficient resource - saving method to suppress them in realistic calculations .    in sec .",
    "[ sec : thinning ] , we start with a description ( sec .  [",
    "sec : standard - thin ] ) of the standard thinning algorithm and explain why its use introduces additional fluctuations .",
    "then , we briefly recall , in sec .  [ sec : suppress - fluct ] , conventional approaches to avoid or suppress these fluctuations . sec .",
    "[ sec : library ] describes the library of showers simulated without thinning for this study .",
    "this library is publicly available .",
    "[ sec : fluct - size ] is devoted to a quantitative study of the artificial fluctuations .",
    "a new method , multisampling , which allows one to suppress efficiently these unphysical fluctuations without invoking extensive computer resources , is suggested and discussed in sec .",
    "[ sec : msampl ] .",
    "[ sec : concl ] contains the discussion of the method and our conclusions .",
    "the number of particles in an extended air shower ( eas ) , and hence the cpu time and disk space required for its full simulation , scales with the energy of the primary particle . at energies in excess of @xmath0  ev ,",
    "the number of particles of kinetic energy above 100  mev at the ground level exceeds @xmath2 and the time required to simulate such a shower at a computer with a few - ghz cpu is of order of several days . a typical vertical shower induced by a hadron of @xmath1  ev requires about 100  gb of disk space and a month of cpu time .",
    "modelling individual showers with incident energies of about @xmath3  ev is at the limit of realistic capabilities of modern computers ; meanwhile one needs thousands of simulated showers for comparison with experimental data .    as a result of a full simulation of a shower ,",
    "one obtains the list of all particles at the ground level .",
    "this information is redundant for many practical purposes .",
    "real ground - based experiments detect only a small fraction of these particles , so for calculating average particle densities one does not need to know precise coordinates and energies of all particles . in the thinning approximation",
    "@xcite , groups of particles are replaced by effective representative particles with weights .",
    "let us briefly recall how the thinning approximation works ( see e.g.ref .",
    "@xcite for a detailed discussion ) . denote the primary energy by @xmath4 and introduce a parameter @xmath5 called the thinning level .",
    "for each subsequent interaction , consider the energies @xmath6 of the secondary particles created in this interaction .",
    "if the condition @xmath7 is satisfied , then the method prescribes to keep one of the secondary particles and to discard the others . the probability to keep the @xmath8th particle @xmath9 is proportional to its energy , @xmath10 to the selected particle , the weight @xmath11 is assigned , where @xmath12 is the weight of the initial particle of this interaction ( @xmath13 for the particle which initiated the shower ) .",
    "if the condition  ( [ thin0 ] ) is not satisfied , then the so - called statistical thinning operates : among the secondary particles , a subsample of ones with energies @xmath14 is considered and ( one or more ) effective particles are selected with probabilities @xmath15 these particles , to which the weights @xmath16 are assigned , are kept for further simulations together with original particles which have had energies @xmath17 .    for useful values of @xmath5 ,",
    "the number of particles tracked is reduced by a factor of @xmath18  @xmath19 . for a random process , this change in the number of particles ( and consequently , in the number of interactions ) results in the increase of fluctuations compared to the fully simulated process .",
    "this means that a part of fluctuations in the development of a shower simulated with thinning is artificial , that is it is present neither in the full shower simulated with @xmath20 nor in a real eas . for a number of applications , these fluctuations are undesirable and should be suppressed or at least brought under control .      in the framework of the thinning method ,",
    "the fluctuations are effectively suppressed by introducing the upper limit on the weight factor @xmath21  @xcite .",
    "the number of `` real '' particles tracked is thus enlarged .",
    "maximal weights for hadrons and for electromagnetic particles may be assigned in different ways . for a given problem , the optimal values of the maximal weights",
    "may be found in order to minimise the ratio of the size of artificial fluctuations to the computational time . in what follows , when we refer to the thinning with weights limitation , we will use the maximal weights optimised in ref .",
    "@xcite for the calculation of the particle density .",
    "the optimal values of parameters of thinning procedure may depend on the interaction models adopted in simulations for a given problem . in principle , the weights should be optimized for each combination of the models ( which are updated every few years ) and for each particular task ( different observables , primaries , energies , etc . ) .",
    "however , this optimization requires a dedicated time consuming study in each case .",
    "we suggest another approach to the problem in sec .  [",
    "sec : msampl ] .",
    "we have performed simulations of air showers without thinning by making use of the corsika simulation code  @xcite . for different showers ,",
    "we have used qgsjet  01c  @xcite and qgsjet  ii-03  @xcite as high - energy and gheisha  2002d  @xcite as low - energy hadronic interaction models .",
    "currently , the library contains about 40 showers induced by primary protons , gamma - rays and iron nuclei with energies between @xmath0  ev and @xmath1  ev and zenith angles between @xmath22 and @xmath23 .",
    "the showers have been simulated for the observational conditions ( atmospheric depth and geomagnetic field ) of either agasa  @xcite or the telescope array  @xcite experiments .",
    "the shower library  @xcite is publicly available at http://livni.inr.ac.ru .",
    "detailed information about input parameters used for the simulation of each shower is available from the library website together with full output files .",
    "the access to the data files is provided freely upon request . for users not familiar with the corsika output format , a `` datafile reading programming manual ''",
    "is given , containing a working example in c++ .",
    "free access to the computational resources of the server is provided to avoid lengthy copying of the output files ( some of which exceed 100  gb in size ) .",
    "an access request form along with conditions of the usage of the library are available from the library website .    given the amount of computing resources required for simulation , each shower simulated without thinning is valuable .",
    "we hope that the open library would be useful in studies of various physical problems , notably facing the improved precision of modern experiments which often exceeds the precision of simulations .",
    "the library is being continuously extended ; we plan to supplement it with showers of higher energies in the future .",
    "with a library of showers simulated without thinning , the comparison of the observables reconstructed from showers with and without thinning is possible .",
    "this allows one to estimate the effect of the approximation . to do that , for each shower without thinning ( @xmath24 )",
    "we have simulated a number of showers with different thinning levels ( @xmath25 ) .",
    "all initial parameters ( including the random seed numbers ) were kept the same as in the @xmath24 simulation , which enabled us to reproduce exactly the same first interaction in the entire set of showers .",
    "three important observables  the signal density at 600  m from the shower axis @xmath26 , the muon density at 1000  m from the axis @xmath27 , and the depth of the maximal shower development @xmath28  were reconstructed for each of the showers following the data - processing operation adopted by the agasa experiment .",
    "the detector response was calculated with the help of geant simulations in ref .",
    "@xcite . @xmath26 and",
    "@xmath29 were obtained by fitting the corresponding density at the ground level with empirical formulae  @xcite . for fitting purpose",
    "the density was binned into 50m - width rings centered at the shower axis .",
    "@xmath28 was obtained by fitting the longitudinal shower profile with the empirical gaisser - hillas curve  @xcite ( incorporated into corsika ) .",
    "this procedure was repeated for all showers in the livni library with the results similar to those shown in figs .",
    "[ fig : distrib][fig : fluct1a ] .",
    "figure  [ fig : distrib ]    shows the distribution of the reconstructed @xmath26 for showers with thinning simulated with the same initial random seed ( and thus the same first interaction ) as three representative @xmath20 livni showers .",
    "though quite wide for @xmath30 thinning , the distributions of @xmath31 are well centered at unity .    the distribution of the mean values of @xmath31 for the ensembles of the thinned showers is presented in fig .",
    "[ fig : distrib20 ]    for a uniform sample of twenty different @xmath20 showers . for each of them",
    ", 500 showers with @xmath30 were simulated with the same first interaction as the corresponding @xmath20 shower .",
    "the values of the observable averaged over 500 thinned showers approximate the `` exact '' @xmath32 with the accuracy of about @xmath33 , which is consistent with the level of statistical fluctuations , @xmath34 .",
    "we have found the same distributions for other observables considered , @xmath27 and @xmath28 .",
    "the important conclusion is that for the first time , _ the usual assumption that thinning does not introduce systematic errors in the reconstructed observables has been checked by explicit comparison of @xmath24 shower and averaged @xmath25 showers _ , at least for energies up to @xmath1  ev , observables @xmath26 , @xmath27 and @xmath28 , and proton , photon and iron primaries .",
    "the spread of observables reconstructed from thinned showers depends on the thinning level @xmath5 .",
    "it is not the width of the distribution but the average deviation of the observables from those of an @xmath20 shower which is the most interesting for practical purposes .",
    "this quantity is plotted in fig .",
    "[ fig : fluct1a ]    for a typical shower from the livni library .",
    "we note in passing that , technically , to study the spread at a given @xmath5 with corsika , one has to simulate showers with slightly different thinning levels ( otherwise they all would be absolutely identical , given a fixed random seed ) .",
    "for instance , to obtain the points corresponding to @xmath35 in fig .",
    "[ fig : fluct1a ] , we have simulated 500 showers with different thinning levels in the interval @xmath36 .      in most cases",
    "one is not interested in details of a particular realization of a shower ; it is the ensemble of simulated showers with fixed initial parameters but varied random seeds which is compared to the real data .",
    "the study of sec .",
    "[ sec : fluct - size - single ] does not help seriously to estimate the effect of thinning on these distributions of parameters because the size of fluctuations seen , e.g. , in fig .",
    "[ fig : fluct1a ] is determined by a combination of artificial fluctuations and a part of real ones : the random seed together with initial conditions fixes the first interaction , but different thinning levels introduce variations in other interactions and effectively change the simulation of the entire shower development .    to estimate the effect of thinning on the distribution of observables",
    ", we have simulated samples of showers with fixed initial conditions but different random seeds for various thinning levels , including @xmath24 . we have considered samples of @xmath37  ev vertical proton - induced showers consisting of 20 showers with @xmath24 , 100 showers with @xmath35 , 100 showers with @xmath35 and weight limitation , 100 showers with @xmath38 and 100 showers with @xmath38 and weight limitation .",
    "the simulations have been performed using qgsjet  ii and gheisha as hadronic interaction models , for the observational conditions of the telescope array experiment .",
    "the distributions of @xmath26 , @xmath27 and @xmath39 have been reconstructed with statistical fluctuations ( originated from the limited number @xmath40 of showers in the samples ) of about @xmath41 , that is , about 23% for @xmath24 showers and about 10% for the other samples .",
    "figure [ fig : ta1e17s ]    illustrates the widths of the distributions obtained at different @xmath5 .",
    "artificial fluctuations in @xmath26 and @xmath27 caused by thinning are clearly seen by comparing @xmath38 case with others ( for @xmath28 the artificial fluctuations are quite small ) .",
    "we note that , for a given @xmath5 , the fluctuations should be larger at high energy since the multiplicity of hadronic interactions grows with energy and thinning starts to operate earlier in the shower affecting the first few interactions which determine the fluctuations . for many practical purposes ,",
    "these artificial fluctuations should be efficiently suppressed .",
    "from the results of the previous section , we conclude that the use of thinning is well motivated when one is interested in the reconstruction of the central values of fluctuating observables ( the most important application is e.g.  to establish a relation between , say , @xmath26 and energy for a given experimental setup ) .",
    "on the other hand , thinning may limit the precision of composition studies , where the observed value of some quantity is compared to the simulated distributions of the same quantity for different primaries , and the width of these distributions is of crucial importance ( see e.g.  the proton  iron comparison in examples of ref .",
    "@xcite ) .",
    "as it has been pointed out above , the effect of physical fluctuations on the distribution of an observable quantity should be , in principle , estimated by simulating a set of showers with the same physical parameters , with different random seeds and without thinning . to obtain a good approximation to this distribution ,",
    "we make use of the results of sec .",
    "[ sec : fluct - size - single ] ( see , in particular , figs .  [",
    "fig : distrib ] and [ fig : distrib20 ] ) .",
    "the average of an observable over a sample of thinned showers with a fixed initial random seed approximates the value of the same observable for an @xmath20 shower with the same random seed with a good accuracy .",
    "the distribution of observables for @xmath20 showers with different random seeds is then approximated by a distribution of these approximated observables calculated for samples with random seeds varying from one sample to another but fixed inside a sample .",
    "a practical way to do this is as follows :    * instead of a single shower with @xmath24 , simulate @xmath42 showers with some @xmath43 and fixed random seed ; * reconstruct the observable for each of @xmath42 showers , average over these @xmath42 realizations and keep this average value which approximates the result for a single shower without thinning ; * repeat the procedure @xmath44 times for different random seeds to mimic a simulation of @xmath44 showers without thinning and to obtain the required distribution of the observable .",
    "we will refer to this procedure as to _ multisampling _ @xmath45 . even for relatively large @xmath5 ,",
    "averaging over a sufficiently large number of showers ( @xmath42 ) gives a good approximation to an @xmath46 value of the observable ; the larger @xmath42 , the better the approximation . the required value of @xmath42 may be estimated as follows .",
    "consider the distribution of an observable reconstructed from showers simulated with the thinning level close to @xmath47 for a given initial random seed .",
    "assume that the distribution is gaussian with the width @xmath48 ( though the qualitative conclusions do not depend on the exact form of the distribution , we note that , in practice , it is indeed very close to gaussian  @xcite ) ; then one needs @xmath42 measurements to know the mean value with the precision @xmath49 .",
    "numerical results for the livni showers demonstrate that @xmath50 multisampling for @xmath51 and @xmath52 results in the precision of @xmath53 in the reconstruction of @xmath26 , @xmath27 and @xmath28 of the original @xmath24 showers .",
    "the distributions of parameters reconstructed from showers without thinning are consistent ( within statistical errors ) with those extracted by making use of multisampling .",
    "the distributions of @xmath26 are presented in fig .",
    "[ fig : s600distrib2 ] .    in fig .",
    "[ fig : ta5e19s ]    we present the widths of the distributions obtained with the usual thinning and with multisampling for @xmath54  ev vertical proton - induced showers ; the limited statistics ( we used @xmath55 showers ) implies the statistical uncertainty of about @xmath56 . the gain in precision",
    "is clearly seen ; for the case of @xmath57  ev the multisampled distribution ( which is expected to mimic the @xmath24 distribution with a good accuracy ) allows us to estimate the size of purely artificial fluctuations caused by thinning .",
    "for instance , for @xmath58 with weights limitations , these fluctuations remain at the level of @xmath59 for @xmath26 and of @xmath60 for @xmath27 .",
    "let us note in passing that , for this particular simulation ( @xmath57  ev vertical protons at the telescope array location ) and for our choice of hadronic models ( qgsjet  ii and gheisha ) , the choice of maximal weights suggested in ref .",
    "@xcite may not be optimal .",
    "let us compare now the computer resources needed for calculations with the standard thinning ( with and without weights limitations ) and with multisampling .",
    "the disk space scales as the number of simulated particles ; fig .",
    "[ fig : disk - versus - t ]    illustrates this fact .",
    "we see that the multisampling ( @xmath61 ) saves the disk space compared to @xmath35 with weights limitation , giving at the same time gain in the precision of simulations .",
    "the cpu time is very sensitive to the choice of the hadronic interaction model : since thinning starts to work when the number of particles is large enough , the first few interactions are simulated in full even for relatively large @xmath5 .",
    "if the high - energy model is slow , then the effect of multisampling on the computational time is not so pronounced . by variations of the hadronic interaction models ,",
    "we have estimated the average time consumed by qgsjet  ii , sybill , fluka and gheisha for simulations of showers at energies @xmath0  ev and @xmath62  ev . for @xmath62",
    "ev vertical proton showers , ( @xmath63 ) multisampling is about 5 times faster than @xmath64 thinning with weights limitation for sybill while for ( very slow ) qgsjet  ii , both take roughly the same time . a way to change the multisampling procedure in order to gain in the cpu time for any hadronic model",
    "is discussed below in sec .",
    "[ sec : concl ] .",
    "a library of atmospheric showers has been simulated without the thinning approximation .",
    "the showers have been used for a quantitative direct study of the effect of thinning on the reconstruction of signal ( @xmath65 ) and muon @xmath66 ) densities at the ground level as well as on the depth @xmath28 of the maximal shower development .",
    "we demonstrate that thinning _ does not introduce systematic shifts _ into these observables , as was conjectured but never explicitly checked .",
    "we estimate the size of artificial fluctuations which appear due to the reduction of the number of particles in the framework of the thinning approximation ; these unphysical fluctuations may affect the precision , e.g. , of the composition studies .",
    "for instance , at the energies of @xmath57  ev for vertical proton primaries , artificial fluctuations are about 10% in the signal density at 600  m and about 12% in the muon density at 1000  m for @xmath35 thinning with weight limitations .",
    "an effective method to suppress these artificial fluctuations , multisampling , is suggested and studied .",
    "the method does not invoke any changes in simulation codes ; only parameters of , say , the corsika input are affected .",
    "compared to the @xmath64 thinning with weights limitations , it gives a similar precision but allows one to gain an order - of - magnitude decrease in the required disk space .",
    "gain in the cpu time depends on the speed of the high - energy interaction model : it is of order @xmath67 for fast ones ( sybill ) and of order 1 for slow ones ( qgsjet  ii ) .",
    "a way to change the multisampling procedure in order to further improve the gain in the cpu time is to simulate the high - energy part of a shower once for each initial random seed while having the low - energy part multisampled .",
    "the multisampling procedure described above is a particular case of such improved procedure with a high - energy part restricted to the first interaction only .",
    "we would expect the modification to make it possible to conserve the physical fluctuations in the second and several following interactions and will allow for an order - of - magnitude improvement in the computational time for any hadronic model .",
    "however , it would require ( simple ) changes in the simulation codes thus loosing an important advantage of the multisampling discussed above : to implement the latter , one operates with the standard simulation code ( e.g. , corsika ) without any modifications .",
    "this minimal change is to add the option to start simulations from a _ predefined set _ of the primary particles .",
    "we are indebted to t.i .",
    "rashba and v.a .",
    "rubakov for helpful discussions .",
    "this work was supported in part by the intas grant 03 - 51 - 5112 , by the russian foundation of basic research grants 07 - 02 - 00820 , 05 - 02 - 17363 ( dg and gr ) , by the grants of the president of the russian federation ns-7293.2006.2 ( government contract 02.445.11.7370 ; dg , gr and st ) and mk-2974.2006.2 ( dg ) and by the russian science support foundation ( st ) .",
    "numerical part of the work was performed at the computer cluster of the theory division of inr ras .",
    "our library of showers without thinning is publicly available at http://livni.inr.ac.ru .",
    "l.  g.  dedenko , can .  j.  phys .",
    "* 46 * , 178 ( 1968 ) .",
    "a.  m.  hillas , nucl .",
    "suppl .   *",
    "52b * , 29 ( 1997 ) . m.  nagano , d.  heck , k.  shinozaki , n.  inoue and j.  knapp , astropart .",
    "* 13 * , 277 ( 2000 ) .",
    "m.  kobal , astropart .",
    "* 15 * , 259 ( 2001 ) .",
    "d.  heck , g.  schatz , t.  thouw , j.  knapp and j.  n.  capdevielle , `` corsika : a monte carlo code to simulate extensive air showers , '' fzka-6019 .",
    "n.  n.  kalmykov , s.  s.  ostapchenko and a.  i.  pavlov , nucl .",
    "* 52b * , 17 ( 1997 ) . s.  ostapchenko , nucl .  phys .  proc .",
    "suppl .   * 151 * , 143 ( 2006 ) .",
    "h.  fesefeldt , `` the simulation of hadronic showers : physics and applications , '' cern - dd - ee-80 - 2 .",
    "n.  chiba _ et al .",
    "_ , nucl .",
    "instrum .",
    "a * 311 * , 338 ( 1992 ) .",
    "f.  kakimoto _ et al .",
    "_ [ ta collaboration ] , proc .",
    "28th icrc , tsukuba , 2003 .",
    "g.  i.  rubtsov , talk given at the 3rd international workshop on the highest energy cosmic rays and their sources : forty years of the gzk problem , http://www.inr.ac.ru/~st/gzk-40_program.html n.  sakaki _ et al .",
    "_ , proc .",
    "27th icrc , hamburg , 2001 , * 1 * , 333 .",
    "s.  yoshida _ et al .",
    "_ , j.  phys .",
    "g * 20 * , 651 ( 1994 ) .",
    "n.  hayashida _ et al .",
    "_ [ agasa collaboration ] , j.  phys .",
    "g * 21 * , 1101 ( 1995 ) .",
    "t.  k.  gaisser and a.  m.  hillas , proc .",
    "15th icrc , plovdiv * 8 * , 353 ( 1977 )",
    ". d.  s.  gorbunov , g.  i.  rubtsov and s.  v.  troitsky , arxiv : astro - ph/0606442 . s.  v.  troitsky , talk given at the 3rd international workshop on the highest energy cosmic rays and their sources : forty years of the gzk problem , http://www.inr.ac.ru/~st/gzk-40_program.html"
  ],
  "abstract_text": [
    "<S> the most common way to simplify extensive monte - carlo simulations of air showers is to use the thinning approximation . </S>",
    "<S> we study its effect on the physical parameters reconstructed from simulated showers . to this end </S>",
    "<S> , we have created a library of showers simulated without thinning with energies from @xmath0  ev to @xmath1  ev , various zenith angles and primaries . </S>",
    "<S> this library is publicly available . </S>",
    "<S> physically interesting applications of the showers simulated without thinning are discussed . </S>",
    "<S> observables reconstructed from these showers are compared to those obtained with the thinning approximation . </S>",
    "<S> the amount of artificial fluctuations introduced by thinning is estimated . a simple method , multisampling , is suggested which results in a controllable suppression of artificial fluctuations and at the same time requires less demanding computational resources as compared to the usual thinning . </S>"
  ]
}