{
  "article_text": [
    "in local thermodynamic equilibrium it is explicitly assumed that the local kinetic temperature of the gas determines the level populations of the atoms or molecules via the boltzmann distribution .",
    "this situation pertains when collisions dominate or when the radiation field is a black body corresponding to the local kinetic temperature of the gas . in contrast , in non - lte , the level populations are determined by the rate equations , and depend both on the local kinetic temperature and on the local radiation field which may not be black body like ( see oxenius ( 1986 ) for precise definitions ) . in most problems in astrophysics , non - lte is associated with steady state level populations .",
    "there are situations where time dependent non - lte calculations are required .",
    "this could occur for instance when the hydrodynamical time scales are shorter or comparable to the radiative time scales ( e.g. in the formation of shock fronts or in stellar explosions ) .",
    "another situation of current interest where time dependent effects are important occurs in the description of the re - ionisation of the universe ( e.g. peacock ( 2000 ) , liddle and lyth ( 2000 ) ) . here",
    ", the densities are sufficiently low and the recombination times correspondingly large that a global equilibrium between photoionisation and recombination may not be achieved during the lifetime of the source of the ionising photons .",
    "the modelling of this phenomenon in an inhomogeneous medium with a complex 3d geometry is a formidable computational task .",
    "the past few years have seen the development of many numerical methods aimed at addressing the problem of re - ionisation in a 3-d framework . rather than attempting to solve this problem in its full complexity ,",
    "many of these methods make practical approximations to the solution of the 3-d transfer equation .",
    "we note in particular adaptive ray tracing methods ( abel , norman & madau 1999 , abel & wandelt 2002 , sokasian et al .",
    "2003 ) , the fast fourier transform method ( cen 2002 ) and the moment equation method using eddington tensors with an optically thin approximation ( gnedin & abel 2001 ) . in all of these methods ,",
    "a key element is the coupling between the chemical ( rate ) equations and the radiative transfer equations which determines how well the ionisation front is resolved . in general",
    "no explicit allowance is made for the time rate of change of the specific intensity ( the @xmath6 term ) in the transfer equation so that the methods yield faster than light propagation of ionisation fronts close to the source .",
    "although these methods can not be rigorously justified in all their assumptions , they are physically motivated , and provide a description of the process of re - ionisation at some level .",
    "another approach has been to use monte carlo methods ( e.g. masselli , ferrara & ciadi 2003 , masselli et al .",
    "the major limitation here is that they require the adoption of an explicit time stepping method which is unstable for large time steps .",
    "this , combined with the large number of trials that are needed , appears to limit the method by the computational effort that is required .    in this paper",
    "we present a new and robust numerical method for solving the time dependent rate equations and the time dependent radiative transfer equation concurrently using a backward differencing scheme . in section 2",
    "we discuss the nature of the problem and present our numerical scheme formulated in 1-spatial dimension .",
    "illustrative results describing the time evolution of ionisation domains that propagate through homogeneous and inhomogeneous plane parallel distributions of initially neutral hydrogen gas are presented in section 3 .",
    "the effects of including multiple sources are discussed in section 4 .",
    "the models in these two sections can serve as a useful bench mark for comparisons of results from other codes and for understanding the process of re - ionisation in the early universe .",
    "our main results are summarised in section 5 .",
    "we consider only the simplest case of the re - ionisation of hydrogen although the method can be easily extended to include helium .",
    "the basic equations are then the rate equations which describe the populations of neutral hydrogen ( hi ) and ionised hydrogen ( hii ) , and the radiative transfer equation which describes the evolution of the mean radiation intensity due to the absorption and the emission of radiation .      in the simplest case that we consider , the model h atoms have one bound and one continuum state .",
    "the two processes of relevance are then ionization from the lower ( ground ) state and recombination from the upper ( continuum ) state .    the rate equation for the number density of neutral hydrogen atoms @xmath7 can be written as @xmath8 where @xmath9 and @xmath10 is the number density of ionised hydrogen ( hii ) .",
    "here @xmath11 is the photoionisation cross section , @xmath12 is the recombination coefficient , and @xmath13 is the mean intensity of the radiation field where @xmath14 is the element of solid angle .",
    "note that all occupation numbers are functions of position @xmath15 and time @xmath16 . since the radiative rates depend on the local mean intensity , it is necessary also to solve concurrently the radiative transfer equation which we give here for a ray in the direction @xmath17 @xmath18 where @xmath19 is an appropriate source function .",
    "equations [ rateeq ] and [ transfeq ] have to be solved as an initial value problem with @xmath20 with the inflow boundary condition @xmath21 on the radiation field where @xmath22 is specified .",
    "that is , we assume that the medium is completely neutral at the time @xmath23 when the source of ionising photons first turns on .    [ cols= \" < , > , > , > , > , > , > , > , > \" , ]     .    to our knowledge there",
    "does not exist an analytical solution for equation [ rateeq ] combined with equation [ transfeq ] , which is a system of non - linear partial differential equations .",
    "therefore , we have to solve the discretized equations numerically .",
    "an immediate possibility is to employ the method of lines ( cf .",
    "schiesser , 1991 ) which would incorporate an up - wind discretisation in the spatial coordinate and the use of a solver for the resulting system of ordinary differential equations ( as e.g. a stoer - burlisch method ) . unfortunately , since the right hand sides of both the rate and the transfer equations are always negative in our cases , such an discretisation leads to instabilities whenever the temporal stepsize exceeds a certain value ( cf .",
    "kahaner et al . , 1989 ) .",
    "moreover , the system is often very stiff as a consequence of the large differences in the time - scales associated with photoionisation and recombination . as a consequence , in explicit schemes",
    "unacceptably short time steps have to be employed .",
    "therefore , we employ here an implicit scheme , i.e. an up - wind discretisation in x - t space .",
    "only first order differencing is considered here in order to avoid overshooting . in general , this involves the solution of a huge system of simultaneous non - linear equations ( cf .",
    "schiesser , 1991 ) .",
    "fortunately , this is not necessary here , when the fact is exploited that light rays propagate always in one direction , i.e. the specific intensity at a spatial point @xmath24 depends only on the specific intensity at @xmath25 and the absorption coefficients @xmath26 and the source function @xmath27 in @xmath28 .",
    "if we restrict ourselves to linear approximations these quantities can be assumed to be given by @xmath29 and @xmath30 .",
    "the discretized equations [ rateeq ] and [ transfeq ] therefore read @xmath31 @xmath32\\end{aligned}\\ ] ] or if we solve equation [ discret1a ] for @xmath33 and insert the result into eq .",
    "[ discret1 ] we get @xmath34 \\nonumber \\\\ & & + \\alpha \\left({\\it n}_{tot}(x^{i+1})- { \\it n}_0(x^{i+1},t^{k+1 } ) \\right)^2 \\nonumber \\\\\\end{aligned}\\ ] ] and @xmath35 \\nonumber \\\\ & & \\end{aligned}\\ ] ] with @xmath36 equation [ discret2 ] is a cubic equation for @xmath37 , i.e. it is an equation in one variable , whenever @xmath38 is known .",
    "therefore , if we make use of the boundary conditions , we can march through the @xmath39 plane as indicated in figure [ grid_march ] .",
    "the equation can be solved analytically or by a simple numerical solver .",
    "this is much more economic in memory and cpu requirements than the general case , where one has to solve at every time - step a non - linear system , in which each equation depends on the densities at all spatial gridpoints . in this way we get an algorithm that is unconditionally stable for all spatial and temporal stepsizes and that is very efficient even for very many grid points .",
    "we demonstrate that our method converges to the required steady states for model b3 ( see table 1 ) in fig .",
    "[ istcomp ] . in order to calculate the steady state model by an independent method we have first set @xmath40 in the rate equation , solved the algebraic equation for @xmath41 and inserted the result into the transfer equation which we subsequently solved as an ordinary differential equation by means of a predictor - corrector scheme .    depending on the computer and operating system as well as",
    "the software used the cpu times range from a few seconds to a few minutes .",
    "this is about a factor @xmath42 more efficient than an explicit method of lines approach .",
    "if the details of the ionising flux are to be taken into account , the relevant wavelengths @xmath43 and the wavelength dependence of opacities and of the source function have to be considered explicitly .",
    "therefore the rate equation and the transfer equation read @xmath44    @xmath45    the discretized versions ( cf . equations [ discret2 ] ) can now be written    @xmath46 \\nonumber \\\\ & & \\quad+\\alpha \\left({\\it n}_{tot}(x^{i+1})- { \\it n}_0(x^{i+1},t^{k+1 } ) \\right)^2 \\nonumber \\\\\\end{aligned}\\ ] ]    with @xmath47 ( @xmath48 are the weights for the wavelength integration ) .",
    "it is seen that the first equation contains only @xmath49 as an unknown . however , the polynomial for the determination of @xmath49 is now of degree @xmath50 .",
    "fortunately , this does not slow down the calculations significantly if a numerical solver is used .      in the general case , we need to consider the presence of more than one source of radiation .",
    "we describe the algorithm we use in terms of two sources of radiation , but the generalisation to many sources is immediate .",
    "suppose we have two sources of illumination : one is situated at @xmath51 and shines from time @xmath23 to time @xmath52 with constant luminosity and the other one is placed at @xmath53 and shines from @xmath54 to @xmath55 where the subscript ` end ' indicates the maximum value .",
    "we now employ the two - stream - approximation where @xmath56 indicates the direction of increasing @xmath15 values and @xmath57 the opposite direction . the mean intensity",
    "is then given by @xmath58 .",
    "corresponding neutral hydrogen densities are denoted by @xmath59 and @xmath60 .",
    "the solution is derived now by a fixed - point iteration for @xmath61 .",
    "for the first step @xmath62 is assumed for all @xmath15 and @xmath16 values .",
    "@xmath63 and @xmath64 are then calculated for all spatial and temporal grid points as described above .",
    "next , @xmath65 and @xmath66 are calculated starting from @xmath23 and @xmath53 ( using the same scheme as above but just going in the opposite direction ) with the @xmath63 as just derived .",
    "@xmath67 is then calculated as the algebraic mean of @xmath64 and @xmath66 .",
    "next , @xmath68 and @xmath69 are evaluated with the assumption that the intensity in the opposite direction is given by the values of the previous iteration , and then @xmath70 and @xmath71 leading to @xmath72 .",
    "the next iteration then follows , and we stop the process when @xmath73 for all spatial and temporal grid points . for @xmath74",
    "this was always the case for @xmath75 in our computations , i.e. we find a fast convergence .    for the models discussed in this paper ,",
    "the @xmath76 term is unimportant and is therefore not included .",
    "the role played by this term is discussed in section 3.3 .",
    "since we are not dealing with recombination radiation in this paper , we set @xmath77 in our calculations . furthermore ,",
    "unless explicitly stated , all our illustrative models assume two levels .",
    "we assume that the medium is plane parallel extending from @xmath51 to @xmath78 .",
    "the density profile is specified to be    @xmath79~\\rm{cm}^{-3}\\end{aligned}\\ ] ]    where @xmath80 is the ambient density .",
    "the second term allows for a density enhancement with a gaussian profile of amplitude @xmath81 and half width @xmath82 centered at @xmath83 .",
    "we choose values for the free parameters to correspond approximately to the conditions that are expected in the universe when the first sources of radiation turned on . for the standard cosmological parameters , the gas density at redshift @xmath84",
    "is given by @xmath85 so we consider a density range @xmath86 @xmath2 appropriate to @xmath4 .",
    "we set the density enhancements to peak at @xmath87 dex above the mean .",
    "we place the source of uv photons at @xmath51 and obtain results for a spatial region that extends to @xmath88 kpc .",
    "the inflow intensity at the outer boundary of the plane parallel region that is being irradiated will depend on the luminosity of the source , its geometry , and its location relative to the region . in our examples",
    "we use an incident intensity @xmath89 erg  @xmath90 s@xmath91 which corresponds to the total intensity of a black body of temperature @xmath92 k ( a uv source ) diluted by a factor @xmath93 .",
    "since these are 1-d models , we do not specify the nature of the sources or of the dilution .",
    "equation [ rateeq ] can be used to estimate a recombination time scale @xmath94 initially , when the gas is mainly neutral , recombination is ineffective ( @xmath95 ) , and the time evolution is governed by photoionisation . as the degree of ionisation increases , @xmath96 decreases , and for a gas that is @xmath97 ionised , the above expression yields a characteristic recombination time scale ( using @xmath98 @xmath99 ( osterbrock ( 1974 ) ) @xmath100 ~{\\rm   ma}\\end{aligned}\\ ] ] this time scale becomes smaller , the higher the density .    likewise , using @xmath101 @xmath99 ( osterbrock 1974 ) equation [ transfeq ] yields a photo - ionisation time scale @xmath102 ~{\\rm ma}\\end{aligned}\\ ] ] this time scale is smallest for the highest intensities . as the intensity of radiation decreases ( due to photo - absorption ) , the photo ionisation time scale increases , with @xmath103 as @xmath104 . in principle , the radiation field and the ionised fraction can adjust so as to reach equilibrium at all points in the medium .",
    "however , in the situations that we consider the level populations never reach full equilibrium during the lifetime of the source . our calculations",
    ", however , allow us to chart the rate at which this equilibrium is approached at different times at different points in the medium .    in the first set of calculations we do not allow for a density enhancement ( @xmath105 ) and consider three models with different uniform densities",
    "@xmath106  @xmath2 ( model a ) , @xmath107  @xmath2 ( model b ) and @xmath108  @xmath2 ( model c ) .",
    "figure [ unifden ] shows the run of density of neutral hydrogen for these three cases at three different times @xmath109 ma . for the model with the lowest ambient density ( model a ) ,",
    "the entire computational region is optically thin to uv radiation ( even at @xmath23 ) so that the effects of radiative transfer are minimal . as a consequence ,",
    "the density of neutral gas is nearly independent of @xmath15 , but decreases with time .",
    "the decline occurs exponentially on the photoionisation time scale being dominated by the first term in the rate equation [ rateeq ] .",
    "the neutral component does not show any marked spatial structure at a given time within the domain of calculation up to the time @xmath110 when the calculation is terminated .    as the ambient density is increased by a factor @xmath111 ( model b ; figure [ unifden ] )",
    "optical depth effects become more important .",
    "regions that are closest to the source are least affected by transfer effects and ionise more quickly in comparison to regions that are further away . as a consequence recombinations become relatively more important as one moves away from the source .",
    "this is shown by the gradual increase in the neutral gas density with increase in @xmath15 at any given time @xmath112 . in this model",
    "there are clear changes in @xmath113 which  as we shall see  can be used to define the location of the ionisation front .    as the ambient density is increased even further ( model c ; figure [ unifden ] ) , optical depth effects dominate except very close to the source . a well defined ionisation front which propagates outwards with time",
    "is now clearly seen within our computational domain .",
    "the effect of increasing the incident intensity by a factor of three to @xmath114 erg @xmath90 s@xmath91 for the same density distribution is shown in model d. the ionsiation front is now seen to propagate further in the same time interval .    comparing the models in figure [ unifden ] , we see that the maximum degree of ionisation that is achieved at @xmath115 ranges from @xmath116 to @xmath117 which agrees in order of magnitude with the mean observed degree of ionisation of the diffuse intergalactic medium at the tail end of re - ionisation ( fan et al .",
    "2003 ) .",
    "the properties of the fronts are best illustrated in figure [ unifden_fronts ] where we present @xmath118 as a function of @xmath15 and @xmath16 for models a , b , c and d. we identify the front as the region of the maximum rate of change of ionisation ( in an absolute sense ) .",
    "these diagrams clearly show how the front propagates in time and changes its spatial structure .",
    "the properties of the fronts , such as the speed , can be extracted from this data and these are given in table 1 .    in model",
    "a , the front propagates fast as it eats its way through the low density medium .",
    "the speed of the front is highest for this model . in model b",
    ", the higher density slows down the front , so that it advances at a slower rate while in model c , the even higher density reduces the speed further .",
    "we note that in these calculations , the front speed is essentially independent of time except close to @xmath23 where the speed is not well defined ( see section 3.3 ) .    the front speed is a strong function of the irradiating intensity as shown in figure [ unifden_fronts ] .",
    "in general , a stronger source will result in a front that propagates faster qualitatively similar to a model with a lower mean density .",
    "the spatial distribution and time evolution of the intensity of radiation for models a , b and c are shown in figure [ unifden_i ] .",
    "as already noted , this sequence corresponds to one of increasing optical depth at time @xmath23 when the gas is neutral .",
    "very close to the source , the intensity is maintained at essentially the input intensity at all times considered due to the dominance of photoionisation .",
    "the intensity that emerges from the computational region ( i.e. at @xmath78 ) , on the other hand , evolves with time at different rates depending on the density of the model . in figure [ unifden_i ] ( model",
    "a ) , the emergent intensity is essentially the input intensity with little change as @xmath16 approaches @xmath115 since photoionisation dominates over the entire computational volume . on the other hand , in figure [ unifden_i ] ( model b )",
    ", this intensity increases from a low value at initial times to a value close to the input intensity as @xmath119 approaches @xmath110 and a larger fraction of the gas becomes ionised and therefore less opaque .",
    "the source will therefore first appear dimmed when viewed from @xmath78 brightening as @xmath16 increases towards @xmath110 . in a sense",
    ", this source emerges from a dark phase ( the ` dark ages ' in a cosmological context ) within the maximum time used in our computations .",
    "in contrast , at the even higher densities represented in the model in figure [ unifden_i ] ( model c ) , the bulk of the material remains neutral for all @xmath120 so that the source never emerges from the dark phase .",
    "clearly , had these calculations been carried out for even larger times , the ionisation front will eventually move outwards to @xmath121 and the source will no longer be dark .",
    "we note that apart from a scaling factor , the inverse of the intensity in figure [ unifden_i ] is proportional to the photoionisation time scale .      in the second",
    "set of models we introduce a density enhancement in the middle of the computational region at @xmath122 kpc ( models b1 , b2 and b3 ) and at @xmath123 ( model b4 ) parametrised by @xmath124 and @xmath82 .",
    "the widths of the enhancements increase from model b1 through to model b3 , and the densities are normalised so that the total column number density is always @xmath125 @xmath90 .",
    "the parameters for this series of models are also summarised in table 1 .",
    "we show in figure [ nonunif ] a , b , c and d the density of neutral hydrogen for model b1 , b2 , b3 and b4 at three different times @xmath126  ma .",
    "the introduction of a density enhancement leads to a local increase in the extinction coefficient and therefore a decrease in the number of ionising photons that can propagate to the far side of the enhancement in models a , b and c. as a result ionisation is more effective on the ` near side ' of the density enhancement ( the side that faces the source of irradiation ) than on the ` far side ' as can be seen by the drop in the level of ionisation as one crosses the enhancement .",
    "the model with the largest value of @xmath82 ( model b3 ) shows the strongest drop in the level of ionisation at any given time .",
    "as @xmath16 increases , the overall level of ionisation increases and the optical depth through the density enhancement decreases . the relative change in the level of ionisation across the enhancement also decreases .    in model b4 ,",
    "the source is at the peak of the density enhancement so that the radiation propagates through a density distribution that decreases with distance from the source .",
    "the time evolution is very similar to what is found for the far side of the density enhancements in models a , b and c. the ionisation proceeds slowly first close to the source , and then propagates outwards at later times .",
    "the interaction of the outward propagating front with a density enhancement is beautifully illustrated in figure [ nonunif_fronts ] which is analogous to figure [ unifden_fronts ] .",
    "here we see that as a front with a velocity @xmath127 encounters a density enhancement , it slows down dramatically to a mean speed @xmath128 as it adjusts to the higher density environment .",
    "eventually the front penetrates the density enhancement and emerges at a speed @xmath129 . @xmath127 and @xmath129 correspond very approximately to the speeds appropriate to the ambient density and intensity on the near and far sides of the density enhancement .",
    "however , in general @xmath129 is larger than @xmath127 with the difference being largest for the enhancement with the largest gaussian half width .",
    "the encounter creates a well defined delay @xmath130 in the process of ionisation which is a function of the parameters of the gaussian .    in the case of model b4 , where the source is at the peak of the density enhancement ,",
    "the velocity is initially low , and then steepens very quickly as the front breaks through and the velocity approaches the value appropriate to the ambient density .",
    "the time delays and the other properties of the fronts are summarised in table 1 .",
    "the above calculations show that in the presence of gaussian density enhancements , even of modest amplitude , can result in significant delays in the onset of re - ionisation . for suitable choices of parameters ( as in model b3 ) that may be appropriate to the first sources of radiation that form in the early universe ,",
    "the delay could exceed the lifetime of the source .",
    "once the source dies out , the gas would recombine on the much larger recombination time scale @xmath96 .",
    "pockets of ionised regions would thus survive enshadowed by high density regions until another source of uv photons turns on in its vicinity and proceedes to ionise its surroundings .",
    "the spatial distribution and time evolution of the intensity of radiation for the models b1 , b2 and b3 are shown in figure [ nonunif_i ] .",
    "these figures should be compared with the corresponding uniform density model b in figure [ unifden_i ] which has the same total column number density .",
    "the intensity is seen to drop sharply across the density enhancement initially due to the local increase in optical depth , but with time , as the region ionises and becomes less opaque , the intensity approaches the input intensity .",
    "we conclude this section by presenting calculations of the recombination time scale and the actual time scale on which the number of neutral hydrogen atoms change in model b3 ( figure [ eqmrate ] ) as a function of @xmath131 .",
    "the diagram shows that initially the recombination time scale has a minimum at the peak of the gaussian density enhancement .",
    "comparing with the actual time scale we see that the photoionisation time scale is relatively more important close to the source than further away due to shielding effect of the density enhancement .",
    "as time increases the shielding effect decreases and recombination time scale becomes more uniform in the spatial domain .",
    "we note that these time scales can vary over several orders of magnitude across the ionising region so that it is not possible to describe the time dependent evolution using average recombination and photoionisation time scales .",
    "the calculations that we have presented so far have neglected the time dependent term @xmath132 in the transfer equation . to illustrate the role played by this term , we have repeated the calculations for our model model b3 discussed in the previous section including this term .",
    "the results are presented in figure [ timedep ] .    the term with the time derivative in the transfer equation [ transfeq ]",
    "may be expected to play an important role when @xmath133 .",
    "the neglect of this term could result in faster than light propagation of ionising fronts .",
    "the light travel time across our computational region is @xmath134  ma , and in our calculations , this condition is satisfied only at very early times which we have not attempted to resolve .",
    "the results of figure [ timedep ] , however , show that when taken in conjunction with the rate equations , this term has an additional effect on the state populations at all spatial locations yielding values that are lower than when the term is neglected .",
    "the effect arises from the non - linearity of the rate equations , and its magnitude depends on spatial location and time .",
    "although we have neglected this term in our present models , our method allows for its inclusion with little additional cost in computing time . this term may play a role in cosmological calculations .",
    "the approach to the steady state solution of this particular model was shown in figure [ istcomp ] .",
    "it is clear that none of the models in figure [ nonunif ] have reached a steady state in @xmath135  ma , the assumed lifetime of the source indicating that full time dependent calculations are required to estimate the scale of ionisation domains .",
    "a good global indicator of the time evolution of ionisation can be obtained by plotting the number of neutral hydrogen atoms in our fixed computational volume as a function of time @xmath16 .",
    "this is shown in figure [ ion_m ] for the three uniform density models that have been discussed .",
    "the time evolution of the optical depths of these configurations can also be obtained from these diagrams by simply shifting the vertical scale by @xmath136 .    in the very low density model ( figure [ ion_m ] ) ,",
    "the column density of neutral gas within the computational region is essentially constant decreasing only very slowly with time . for this model ,",
    "the simple estimates based on equations [ eqnrecomb2 ] and [ eqnphotion ] give @xmath137  ma ,  @xmath138  ma . as the density",
    "is increased by a factor @xmath111 and optical depth effects become more important , the column density of neutral gas is seen to decline more rapidly initially due to photoionisation , but then more slowly as recombination begins to play a significant role . for this model @xmath139  ma .",
    "these effects are seen even more strongly in the highest density model considered for which @xmath140  ma .",
    "we have not shown the corresponding curves for the models with density enhancements discussed in figures [ nonunif ] since they are identical to the curve with @xmath141  @xmath2 in figure [ ion_m ] .",
    "this is because all these four models have the same total column density in the computational region .",
    "the main effect of the introduction of the density enhancement is to change the spatial distribution of ionised gas , and the time evolution of the ionisation fronts , but not the total column density of ionised gas .",
    "the column density of ionised gas , and its evolution with time is therefore a strong function of the total column density and the incident radiation field and is not sensitive to the distribution of mass within the computational region .",
    "a related quantity that can be derived from our calculations is the time evolution of the ratio of the total number of ionising photons in our computational region to the total number of ionised particles .",
    "we have derived this quantity    @xmath142 for our model with a central density enhancement ( model b4 ) and the results are shown in figures [ ratio ] .    initially , the gas is neutral , and we therefore expect @xmath143 to be large . as time proceeds ,",
    "photons are removed from this region generating ionised particles . as photoionisations proceeed , @xmath143 declines rapidly , reaches a plateau , and rises again as the competing effect of recombination comes into play .",
    "the models that we have presented so far have been based on a model atom with one bound state and one continuum state . to allow for different spectral slopes for the source of ionising photons and a better description of the photoionisation cross section",
    "we need to include more than one continuum state .",
    "we show in figure [ multifreq ] the effect of including three continuum levels with @xmath144 and @xmath145   in model b discussed in figure [ unifden ] b. the incident spectrum is assumed to be flat in wavelength but have the same total average intensity @xmath146 erg  @xmath90 s@xmath91 .",
    "the spatial profiles of the neutral density component and its time evolution are markedly different even though the maximum degree of ionisation remains the same .",
    "we see that the central regions ionise more quickly and that a well defined front that propagates outwards can be seen within our computational region .",
    "the intensity of radiation ( figures [ multifreq ] b , c and d ) is now strongly frequency dependent reflecting the @xmath147 dependence of the photoionisation cross - section , with the highest frequency showing the strongest attenuation close to the source at early times .",
    "a distant observer will thus see the source first at high frequencies , and then at lower frequencies as the lyman limit is reached .",
    "the ionisation state of the intergalactic medium depends on the nature of the sources of ionising radiation ( modelled by @xmath22 ) , their distribution in space and time , and the density structure of the ambient intergalactic medium .",
    "our calculations show that small uncertainties in these input parameters can have large effects on our conclusions on the state of ionisation of the intergalactic medium .",
    "to illustrate the sensitivity of our results on the state of ionisation to input parameters , we have repeated the calculations for model b4 , first by keeping @xmath22 fixed , and decreasing the ambient density by 10 percent , and then by keeping the ambient density fixed , and decreasing @xmath22 by 10 percent .",
    "the results of these two sets of calculations are shown in figure [ stochastic ] .",
    "a 10 percent variation in either the density , or the incident intensity translates to a a factor 3 in the neutral density on a time scale of 4 million years .",
    "these results show that the details of how re - ionisation proceeds requires accurate calculation of the density structure in the early universe , such as those that can be obtained from hydrodynamic simulations ( abel et al .",
    "( 1999 ) ) .",
    "in this section we present results of one set of calculations that were carried out with two sources using the generalisation of the numerical method described in section 2.2 ( model s1 in table 1 ) . in these models ,",
    "the first source is located at @xmath51,turns on at @xmath23 , and shines for @xmath148  ma after which time it shuts off . a second source located at @xmath149",
    "kpc turns on at a subsequent time @xmath150  ma , shines for another @xmath148  ma , and then shuts off .",
    "each source has @xmath89 erg  @xmath90 s@xmath91 and we assume a density distribution with a density enhancement centered at @xmath123 as in model b4 .",
    "we show in figure [ multisource1_den]a the time evolution of the logarithm of the number density of neutral hydrogen .",
    "initially , the behaviour is similar to the single source case , with the ionisation front propagating outwards with time starting at @xmath51 with the number density of neutral hydrogen decreasing with time at any given spatial position .",
    "once the first source of radiation turns off ( @xmath151  ma ) , the gas begins to recombine slowly , and the number density of neutral hydrogen increases at any given spatial location , but not significantly in the intervening @xmath152  ma .",
    "the second source then turns on and ionisation proceeds again , but starting from a medium which is already partially ionised . in the next @xmath148",
    "ma the degree of ionsiation drops rapidly reaching values as low as @xmath153 over most of the region at the end of the calculation .",
    "the evolution of mean intensity @xmath154 in our computational volume is shown in [ multisource1_den]b .",
    "if we were located at @xmath155  kpc , mid way between the two sources , we would first see the radiation from the first source rise to reach a peak at @xmath156  ma , and the source will then vanish from view almost instantaneously on a time scale corresponding to the light travel time from the source .",
    "the second source will then come into view on a similar time scale , and brighten slowly as the medium becomes significantly ionised again .",
    "the net effect of having two sources of ionisation that turn on at different times is to ionise a significantly larger volume of gas to a higher degree of ionisation .",
    "these calculations demonstrate that after the first sources turn on , the universe will ionise very quickly as subsequent sources turn on , even though the lifetime of the sources of radiation may be much shorter than the time between the sources .",
    "we have presented a robust numerical scheme that is unconditionally stable and allows the calculation of the time dependent evolution of ionisation domains with full time and spatial resolution .",
    "the method allows for the explicit inclusion of the time dependence of the radiative intensity in the transfer equation .",
    "our illustrative 1-d examples were chosen to mimic conditions in the early universe and highlight the basic processes that are involved in the development of ionisation domains around uv sources of radiation .",
    "the physics of the non - lte ionisation process is of course well understood , and has been incorporated at different levels of approximation in many previous investigations of cosmological reionisation . as a source first turns on , and illuminates a neutral medium , photoionisations will dominate everywhere except that they will be less effective in the outer regions because of the larger optical depth towards the illuminating source",
    ". the neutral density will therefore initially decline at different rates at different spatial locations in the medium with the neutral density in the inner regions declining more rapidly . as the neutral density decreases ,",
    "recombinations become relatively more important and slows down the rate of decline . in addition",
    "the ionisation of the regions closest to the source makes this gas more transparent enhancing the photoionisation of adjacent outer regions .",
    "these two processes combine to yield an expanding ionisation ` front ' that separates the mainly ionised and mainly neutral gas .",
    "the front expands at a rate that is determined by the local density and the intensity @xmath22 of the source of irradiation .",
    "as @xmath16 increases , the amplitude of @xmath157 decreases , but an equilibrium situation is not reached in any of our calculations within the lifetime of the source ( @xmath158 ma ) .    the above simple picture can change significantly when density fluctuations are taken into consideration .",
    "we have investigated the effects that come into play when an outward propagating ionising front encounters a gaussian density enhancement of given peak density and half width .",
    "the density enhancement slows down the speed of the front in a complex manner depending on both of these parameters .",
    "before the front encounters the enhancement , it has a speed that is nearly constant and equal to the value appropriate to the ambient mean density and the input irradiating intensity @xmath22 .",
    "as the front emerges from the density enhancement , the speed reaches a value that is generally lower than before the encounter . the density enhancement ` delays ' the propagation of the ionisation front by a time @xmath130 that is strongly dependent on the peak density and the half width of the assumed gaussain density enhancement .",
    "our calculations have shown that delays of the order of a few tens of million years are possible even for modest density enhancements .",
    "the delay could therefore exceed the lifetime of the ionising source , so that the density enhancement in effect stops the propagation of the front .",
    "due to the long recombination times , such regions will remain ionised , enshrouded by neutral gas , until the next source of radiation turns on in its vicinity and continues the process of ionsiation .",
    "our calculations have shown that even though the lifetime of a source of ionising radiation may be much smaller than the time between the emergence of such sources , ionisation will proceed very effectively once started .",
    "various generalisations , such as extension to three dimensions are easily implemented .",
    "helium ionisation can be readily incorporated by the use of more levels ( and therefore more frequency points ) and the cosmological expansion term by implicitly discretizing the frequency variable .",
    "our future plans are to apply our numerical method to outputs of cosmological simulations .",
    "the authors thank the deutsche forschungsgemeinschaft ( sfb 439 , project a4 ) for financial support and owen dive for reading through the manuscript and providing valuable comments .",
    "abel , t. & wandelt , b. d. , 2002 , mnras,330 , l53 abel , t. , norman , m. l. , & madau , p. , 1999",
    ", apj 523 , 66 cen , r. , 2002 , apj , 591 , 12 gnedin , n. y. & ostriker , j. , 1997 , apj , 486 , 581 gnedin , n. y. & abel , t . , 2001 , new",
    "a , 6 , 437 kahaner , d. , moler , c. , & nash , st . , 1989 , numerical methods and software , prentice - hall"
  ],
  "abstract_text": [
    "<S> we present a new implicit numerical algorithm for the calculation of the time dependent non - local thermodynamic equilibrium of a gas in an external radiation field that is accurate , fast and unconditionally stable for all spatial and temporal increments . </S>",
    "<S> the method is presented as a backward difference scheme in 1-d but can be readily generalised to 3-d . </S>",
    "<S> we apply the method for calculating the evolution of ionisation domains in a hydrogen plasma with plane - parallel gaussian density enhancements illuminated by sources of uv radiation . </S>",
    "<S> we calculate the speed of propagation of ionising fronts through different ambient densities and the interaction of such ionising fronts with density enhancements . </S>",
    "<S> we show that for a typical uv source that may be present in the early universe , the introduction of a density enhancement of a factor @xmath0 above an ambient density @xmath1 @xmath2 could delay the outward propagation of an ionisation front by millions of years . </S>",
    "<S> our calculations show that within the lifetime of a single source ( @xmath3 a few million years ) , and for ambient intergalactic densities appropriate to redshifts @xmath4 , degrees of ionisation of @xmath5 can be achieved within its zone of influence . </S>",
    "<S> we also present calculations which demonstrate that once started , ionisation will proceed very efficiently as multiple sources are subsequently introduced , even if the time between the appearence of such sources may be much longer than their lifetimes .    </S>",
    "<S> [ firstpage ]    numerical radiative transfer . </S>",
    "<S> early universe . </S>",
    "<S> proto - galactic clouds . </S>"
  ]
}