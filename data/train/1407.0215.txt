{
  "article_text": [
    "genetic recombination is an important mechanismwhich generates and maintains diversity .",
    "it is one of the main sources providing new genetic materials that allow nature selection to carry on . in various population",
    "genetic studies , such as dna sequencing , disease study , population history study , etc .",
    ", recombination information plays an important role . on the other hand",
    ", recombination adds much more complexity and makes statistical inference of some evolutionary parameters more difficult . in the last two decades",
    ", some simulation models generating graphs , called ancestral recombination graphs ( args ) , based on coalescent processes have been developed to study recombination . however",
    ", none of the existing simulation models is perfect and each has its own advantages and disadvantages .",
    "historically , a model generating the genealogical relationship between @xmath0 sampled sequences from a population with constant size without recombination was first described by watterson ( cf .",
    "@xcite ) , and further developed into the theory of the coalescent by kingman ( cf .",
    "@xcite ) . a model describing the evolution of infinite - site sequences subject to both coalescence and recombination in a population was first introduced by hudson ( cf .",
    "@xcite ) . in his setup",
    ", a combined coalescent and recombination process is followed back in time until all nucleotide positions in the extant sequence have one common ancestral nucleotide .",
    "the resulting structure is no longer a tree but a graph , which was later named as arg by griffiths and marjoram , who gave in @xcite more details on arg and embedded arg in a birth ",
    "death process with exponentially distributed and independent waiting times for coalescent and recombination events .",
    "the arg described by griffiths and marjoram is simple but in many cases unnecessarily time consuming to simulate . because an `` ancestral '' sequence in the birth  death process may have no genetic material in common with a sequence descended from it . adjusting the above shortcoming , hudson proposed a more efficient algorithm @xmath1 ( cf .",
    "@xcite ) which is now a commonly used computer program to simulate coalescence .",
    "hudson s program generates arg back in time from the present .",
    "due to the markov property of the process , the algorithm is computationally straightforward and simple .",
    "but it is not possible to reduce the computation further , and it is hard to approximate the computation .",
    "on the other hand , wiuf and hein proposed an alternative algorithm that moves along the sequencs and modifies the genealogy as recombination breakpoints are encountered ( cf .",
    "it begins with a coalescent tree at the left end of the sequence , and adds more different local trees gradually along the sequence , which form part of the arg .",
    "the algorithm terminates at the right end of the sequence when the full arg is determined .",
    "wiuf and hein s algorithm will produce some redundant branches in arg .",
    "its performance is not so good in comparison with @xmath1 .",
    "but the spatially moving program is easier to approximate .",
    "based on the idea of constructing arg along sequences , there have been some approximation algorithms , such as smc , smc , and macs ( cf .",
    "@xcite ) . wiuf and hein s spatial approach of simulating genealogies along a sequence has a complex non - markovian structure in that the distribution of the next genealogy depends not just on the current genealogy , but also on all previous ones .",
    "therefore , the mathematical formulation of spatial algorithm is cumbersome , and up to date all the comparisons and discussions between spatial algorithms and @xmath1 ( back - in - time algorithm ) are based on simulation studies .",
    "there is no rigorous argument showing that the arg generated by a spatial algorithm can share the same probability distribution as the arg generated by a back - in - time algorithm .    in our recent joint research with scientists in computational biology",
    ", we proposed a new model describing coalescent with recombination , and developed a new algorithm based on this new model .",
    "our algorithm is also a spatial algorithm .",
    "but we have improved wiuf and hein s program in that our algorithm does not produce any redundant branches which are inevitable in wiuf and hein s algorithm . in generating args , our algorithm has comparable performance with the algorithm @xmath1 .",
    "in addition , our method can generate args that are consistent with the sample directly .",
    "moreover , we can show that the existing approximation methods ( smc , smc , macs ) are all special cases of our algorithm . for details , see our joint paper @xcite .    in this paper , we further study the statistical properties of our new model . in particular",
    ", we prove rigorously that the statistical properties of the arg generated by our spatially moving model and that generated by a back - in - time model are identical , that is , they share the same probability distribution on the space of args ( cf . theorem  [ coincide ] below ) .",
    "since the existing approximations by spatial methods ( smc , smc , macs ) are all special cases of our algorithm , consequently our study provides a unified interpretation for the algorithms of simulating coalescent with recombination , and will facilitate the study of statistical inference of recombination .",
    "the remainder of this paper is organized as follows . as a necessary preparation , in section  [ preparation ]",
    "we investigate in detail the back - in - time model . in section  [ statespace ] , we describe briefly a typical back - in - time model for simulating coalescent processes with recombination .",
    "then we study the state space of the markov jump process behind the model . in section  [ construction ] , we construct a markov jump process corresponding to the typical back - in - time algorithm . in section  [ constructiong ] , we show that with probability one , a path of the markov jump process constitutes an arg .",
    "we then explore some properties of the space @xmath2 of args .",
    "it is worth pointing out that although section  [ preparation ] is a necessary preparation , indeed our investigation is new and the results obtained in this section have interests by their own . in particular",
    ", we believe that the probabilistic arg space @xmath3 obtained in theorem  [ space ] will be very useful elsewhere . in section  [ mainsection ]",
    ", we present our main results on the spatially moving model . in section  [ sequence ] , we define and study a random sequence @xmath4 on the probabilistic arg space @xmath3 , which is important for modeling our spatial algorithm .",
    "we first define the random sequence @xmath4 and study its measurable structure .",
    "we then discuss and derive the distributions of @xmath5 and  @xmath6 .",
    "the derivations of the successive conditional distributions of the involved random variables are very complicated .",
    "some cumbersome derivations are moved to the supplementary article @xcite . in section",
    "[ algorithm ] , we describe our model of spatially moving algorithm and study its statistical property .",
    "we first briefly describe the algorithm @xmath7 ( sequence coalescence simulator ) of our spatial model .",
    "afterward , we give some explanation of the algorithm . finally , we reach the main goal of the paper .",
    "we show that the statistical property of the arg generated by our spatially moving model recently proposed in @xcite is identical with the one generated by the typical back - in - time model discussed in section  [ preparation ] , that is , they share the same probability distribution on the arg space ( see theorem  [ coincide ] ) . in section  [ proofs ] , we present the proofs of the main results along with some technical lemmas . to reduce the length of the paper , the proofs of the results in section  [ preparation ] as well as part of the results in section  [ mainsection ]",
    "are moved to the supplementary article  @xcite .",
    "we start our discussion by describing the state space of the markov jump process behind the model of a typical back - in - time algorithm .",
    "following griffiths and marjoram ( cf .",
    "@xcite ) , in our model a gene or a dna sequence is represented by the unit interval @xmath8 . the model is derived from a discrete wright  fisher model in which , when looking back in time , children in a generation choose one parent with probability @xmath9 , or two parents with probability @xmath10 ; the latter means that a recombination event occurs .",
    "if recombination occurs , a position @xmath11 for the breakpoint is chosen ( independent from other breakpoints ) according to a given distribution , and the child gene is formed with the gene segments @xmath12 from the first parent and @xmath13 from the second parent .",
    "a continuous time model is obtained by first fixing the population size @xmath14 and then letting @xmath15 .",
    "time is measured in units of @xmath14 and the recombination rate per gene per generation @xmath10 is scaled by holding @xmath16 fixed .",
    "the limit model is a continuous time markov process with state space described as below .",
    "let @xmath17 be the collection of all the subsets of @xmath18 .",
    "we endow @xmath17 with the discrete metric which will be denoted by @xmath19 . throughout this paper , we shall fix @xmath20 and shall hence simply write @xmath21 for @xmath17 .",
    "we denote by @xmath22 the family of all the @xmath21-valued right continuous piecewise constant functions on @xmath8 with at most finitely many discontinuity points .",
    "an element @xmath23 may be expressed as @xmath24 with @xmath25 , which means that @xmath26 takes value @xmath27 on the semiclosed interval @xmath28 for each @xmath29 .",
    "[ state ] a finite subset @xmath30 of @xmath22 is said to be a state , and is denoted by @xmath31 , if and only if @xmath32 form a partition of @xmath18 for each @xmath33 , and @xmath34 for each @xmath35 .",
    "the totality @xmath36 of all the states will serve as a state space of the markov process behind our algorithm .",
    "the process takes values in @xmath36 , starts at the present and traces back in time . at the present time",
    "@xmath37 , here @xmath38 representing that the algorithm starts from @xmath20 sample lineages of @xmath39 sequences .",
    "starting from the present and looking back in time , if @xmath40 with @xmath41 , then it represents that at time point @xmath42 , there are @xmath0 ancestral lineages ( i.e. , there are @xmath0 lineages which carry the ancestral materials of the samples ) ; if @xmath43 is expressed as @xmath44 , then , for @xmath45 , on the loci located in the interval @xmath28 , the @xmath46th lineage carries ancestral materials of the sample sequences @xmath47 .",
    "the @xmath0 ancestral lineages are kept unchanged until coalescence or recombination event happens .",
    "when a coalescence event happens , the algorithm chooses two lineages randomly from the @xmath0 lineages and merges them into one lineage .",
    "when a recombination event happens , it draws a lineage randomly from the @xmath0 lineages and splits it into two lineages with breakpoint @xmath48 , whereas the breakpoint @xmath49 is chosen according to a given distribution .",
    "the waiting times between two events are designed to be exponentially distributed with parameters depending on the current states .",
    "the algorithm starts at the present and performs back in time generating successive waiting times together with recombination or coalescence events . in griffiths and",
    "marjoram s program , the algorithm will repeat the above procedure until there is only one ancestral lineage , that is , until the gmrca ( grand most recent common ancestor ) is found . to avoid redundant computation , @xmath1 algorithm has improved the above procedure in some aspects . in particular ,",
    "@xmath1 respects the following two rules .",
    "( r1 ) when the @xmath20 samples have already found common ancestry in @xmath50 , the algorithm will not perform any recombination event with breakpoint located in @xmath50 .",
    "( r2 ) a locus @xmath51 in the sequence of a lineage can be chosen as a breakpoint only if both @xmath50 and @xmath52 carry ancestral materials of the samples .    in this paper",
    ", we shall refer the algorithm with the above two rules as a _ typical back - in - time algorithm_. ( remark : a minor difference between @xmath1 and our typical back - in - time algorithm is that in the above rule ( r1 ) , @xmath1 will respect common ancestry in @xmath53 for any @xmath54 , while we respect only common ancestry in @xmath53 with @xmath55 . ) since in the infinite allele model mutation is independent of the coalescent process with recombination , in our model we shall temporarily not consider mutation .",
    "below we shall show that @xmath36 equipped with a suitable metric @xmath56 is a locally compact separable space , which is crucial and very convenient for our further discussion .",
    "let @xmath57 .",
    "we say that @xmath49 is a breakpoint of @xmath58 , if there exist at least one @xmath59 such that @xmath60 is discontinuous at @xmath48 .",
    "suppose that @xmath61 are the different breakpoints of @xmath58 .",
    "we make the convention that @xmath62 and @xmath63 , then each @xmath59 may be expressed as @xmath64 .",
    "we define @xmath65 for @xmath66 , we set @xmath67 and @xmath68 let @xmath69 be the number of elements in @xmath58 .",
    "we set @xmath70    [ prop1 ] for @xmath71 , we define @xmath72 then @xmath73 is a metric on @xmath22 .",
    "let @xmath74 .",
    "suppose that @xmath75 and @xmath76 , we define @xmath77 to the set @xmath78 , then @xmath56 is a metric on  @xmath36 .",
    "the proof of proposition  [ prop1 ] is presented in section a.1 of the supplemental article @xcite .    for our purpose",
    ", we shall sometimes put the functions of a state @xmath31 in a parentheses to indicate that they have been well ranked in a specific order .",
    "more precisely , we may sometimes write @xmath79 , which means that @xmath80 have been ranked in such a way that if @xmath81 , then either @xmath82 or , in case that @xmath83 , @xmath84 note that with the above specific order , the subscript `` @xmath46 '' of an element @xmath85 is uniquely determined .    the proposition below explores the neighborhood of a state @xmath31 .",
    "[ neighborhood ] let @xmath86 and @xmath87 be the different breakpoints of @xmath58 .",
    "suppose that @xmath88 satisfies @xmath89 , then @xmath90 .",
    "suppose that @xmath91 satisfies @xmath92 .",
    "let @xmath93 be the different breakpoints of @xmath94 .",
    "then @xmath95 for all @xmath96 .",
    "moreover , for each @xmath97 , it holds that @xmath98 , and @xmath99 can be expressed as @xmath100    for any @xmath101 with @xmath102 , there exists an element @xmath103 such that @xmath104 .",
    "the proof of proposition  [ neighborhood ] is presented in section a.2 of the supplemental article @xcite .    employing the above proposition",
    ", we can check the following topological properties of @xmath36 .",
    "[ prop2 ] for each @xmath66 and @xmath105 , @xmath106 is an isolated subset of @xmath36 , that is , @xmath106 is both open and closed in @xmath36 .",
    "@xmath36 is a locally compact separable metric space .",
    "proposition  [ prop2 ] is proved in section a.2 of the supplemental article @xcite .      in this subsection",
    ", we shall construct a markov jump process describing the typical back - in - time algorithm . to formulate a rigorous mathematical model ,",
    "we need to introduce some operations on @xmath22 and on @xmath36 corresponding to the algorithm .",
    "let @xmath107 .",
    "we define @xmath108 for @xmath109 , we define @xmath110 then @xmath111 and @xmath112 are all elements of @xmath22 .    for a state @xmath41 , we set @xmath113 and @xmath114 we define for @xmath115 and @xmath116 , @xmath117 which indicates that a recombination event happens on the lineage @xmath118 with breakpoint @xmath51 .",
    "note that the definitions of @xmath119 and @xmath120 ensure that the algorithm respects the above mentioned rule ( r2 ) .",
    "moreover , the definition of @xmath121 , which is different from the other @xmath119 , and the ranking rule specified by ( [ order1 ] ) and ( [ order2 ] ) ensure that the algorithm respects the rule ( r1 ) .",
    "further , we define for @xmath122 , @xmath123 which denotes the coalescence of the lineages @xmath124 and @xmath125",
    ".    we can now construct a markov jump process @xmath126 as a rigorous mathematical model for our typical back - in - time algorithm . in what follows for any metric space @xmath36 ,",
    "we shall write @xmath127 for the borel subsets of @xmath36 .    we define @xmath128 for @xmath31 and @xmath129 as follows : @xmath130 if @xmath131 , and @xmath132 where @xmath133 is the indicator function of @xmath134 , @xmath135 is the density function of a given distribution on @xmath136 , and @xmath137 is a positive constant corresponding to a given recombination rate .",
    "further , we define @xmath138 for @xmath31 by setting @xmath139    for the terminologies involved in the proposition below , we refer to definition  1.9 of @xcite .",
    "[ prop3 ] @xmath140 defined by ( [ qx ] ) and ( [ qxa ] ) is a q - pair in the sense that for each @xmath31 , @xmath141 is a measure on @xmath142 ; and for each @xmath143 and @xmath144 are @xmath127-measurable .",
    "moreover , @xmath140 is totally stable in the sense that @xmath145 for all @xmath31 , and is conservative in the sense that @xmath146 for all @xmath31 .",
    "the proof of proposition  [ prop3 ] is presented in section a.3 of the supplemental article @xcite .    by virtue of proposition  [ prop3 ] and making use of the theory of q - processes we obtain the following proposition .",
    "[ existence ] given any initial distribution @xmath147 on @xmath127 , there exists a @xmath148 corresponding to the q - pair @xmath140 , in the sense that @xmath126 is a time homogeneous markov jump process satisfying : @xmath149 ; the transition probability of its embedded markov chain is given by @xmath150 the waiting time of its jump given @xmath151 is exponentially distributed with parameter @xmath138 .    the proof of proposition  [ existence ] is presented in section a.4 of the supplemental article @xcite .",
    "define @xmath152 note that @xmath153 is the only element in @xmath154 , and hence is the only absorbing state in @xmath36 satisfying @xmath155 .",
    "[ uniqueness ] the transition semigroup of the q - process specified by proposition  [ existence ] is unique .",
    "moreover , the process will almost surely arrive at the absorbing state @xmath153 in at most finitely many jumps .",
    "the proof of proposition  [ uniqueness ] is presented in section a.5 of the supplemental article @xcite .",
    "let @xmath148 be the markov jump process constructed in proposition  [ existence ] with initial distribution @xmath156 , where @xmath157 is specified by ( [ x0 ] ) .",
    "assume that @xmath126 is defined on some probability space @xmath158 .",
    "then for each @xmath159 , @xmath160 is an element in @xmath161 , where @xmath161 denotes the family of all the @xmath36-valued right continuous piecewise constant functions on @xmath162 with at most finitely many discontinuity points .",
    "note that not all elements @xmath163 can be regarded as an arg generated by the back - in - time algorithm . indeed ,",
    "if @xmath163 represents an arg , then @xmath164 should satisfy the following two intuitive requirements .",
    "( i ) @xmath165 and if @xmath166 , then @xmath167 is generated by a coalescent event or a recombination event from the state @xmath168 .",
    "( ii ) along the path @xmath169 , recombination events will not happen more than once in any locus @xmath49 .",
    "below we shall prove that with probability one , @xmath170 satisfies the above two requirements , and hence represents an arg .",
    "to state our result rigorously , we introduce some notation first .    for a state @xmath171 with @xmath131",
    ", we set @xmath172 \\\\[-8pt ] \\nonumber & & { } \\cup\\bigl\\{r_{is}(x ) \\dvtx",
    "1\\leq i\\leq|x| , s\\in\\bigl(b_i(x),e_i(x)\\bigr)\\bigr\\}.\\end{aligned}\\ ] ] for notational convenience , we shall also write @xmath173 if @xmath31 with @xmath174 .",
    "we define a function @xmath175 by setting @xmath176 \\\\[-8pt ] \\nonumber & = & \\cases{u,&\\quad$\\mbox{if there exists a unique } u\\in(0,1)$\\vspace*{2pt } \\cr & \\quad$\\mbox{such that } y = r_{iu}(x ) \\mbox { for some } 1\\leq i \\leq k;$ \\vspace*{2pt } \\cr -1 , & \\quad $ \\mbox{else}.$}\\end{aligned}\\ ] ] we set for @xmath163 , @xmath177 with the convention that @xmath178 and @xmath179 . for the sake of convenience , we shall write @xmath180 .",
    "we define @xmath181 and @xmath182 it is easy to see that if @xmath183 , then @xmath184 satisfies the above two intuitive requirements .",
    "we shall call @xmath2 the _ arg space_.    [ thg ] there exists @xmath185 with @xmath186 , such that for all @xmath187 , we have @xmath188 .    the proof of proposition  [ thg ] is presented in section a.6 of the supplemental article @xcite .",
    "note that the arg space @xmath2 specified by ( [ g ] ) is a subset of the @xmath36-valued skorohod space @xmath189 .",
    "we are going to show that @xmath2 equipped with the skorohod topology is a locally compact separable metric space .",
    "we first introduce some terminologies and notation . for @xmath183",
    ", we set @xmath190 where @xmath191 is defined by ( [ taok ] ) .",
    "let @xmath192 be the collection of all the breakpoints on @xmath184 .",
    "then @xmath193 consists of at most finitely many points of @xmath136 .",
    "moreover , by ( [ g ] ) the points of @xmath193 are all different from each other .",
    "denote by @xmath194 the number of points contained in @xmath193 .",
    "we define @xmath195 to be the @xmath29th order statistic of @xmath193 .",
    "that is , @xmath196 and @xmath197 for all @xmath29 . for convenience",
    ", we make the convention that @xmath198 and @xmath199 for @xmath200 .",
    "suppose that @xmath201 and @xmath202 , we define an @xmath203-dimensional @xmath21-valued vector for each @xmath204 by setting @xmath205 .",
    "further , we write @xmath206 when @xmath207 for all @xmath208 . in",
    "what follows , we set @xmath209 .    for the convenience of the reader , we recall the definition of the skorohod metric @xmath210 on @xmath189 ( cf .",
    "@xcite ) .",
    "let @xmath211 be the collection of lipschitz continuous and strictly increasing functions @xmath212 such that @xmath213 . for @xmath214 , the skorohod metric @xmath210 is defined as @xmath215,\\ ] ] where @xmath216    the proposition below plays an important role in our further study .",
    "[ 2gneighborhood ] let @xmath217 .",
    "suppose that @xmath218 then the following assertions hold :    @xmath219 .",
    "@xmath220 and @xmath221 for all @xmath222 .",
    "@xmath223 for all @xmath222 .",
    "proposition  [ 2gneighborhood ] is proved in section a.7 of the supplemental article @xcite .",
    "[ 3gneighborhood ] let @xmath224 and @xmath225 .",
    "then @xmath226 if and only if @xmath227 for all @xmath228 for all @xmath229 , and there exists @xmath230 such that for all @xmath231 the assertions of proposition  [ 2gneighborhood ] hold .    @xmath2 equipped with the skorohod metric @xmath210 is a locally compact separable metric space .",
    "the proof of proposition  [ 3gneighborhood ] is presented in section a.8 of the supplemental article @xcite .",
    "note that @xmath2 can be regarded as the collection of all the args generated by the back - in - time algorithm .",
    "we denote by @xmath232 the borel sets of @xmath2 .",
    "[ space ] let @xmath233 be the probability distribution on @xmath234 generated by the typical back - in - time algorithm , and denote by @xmath235 the coordinate process on @xmath2 .",
    "then @xmath148 is an @xmath36-valued markov jump process corresponding to the q - pair ( [ qxa])([qx ] ) .    since on the skorohod space the borel @xmath236-field coincides with the @xmath236-field generated by its coordinate process ( cf .",
    ", e.g. , @xcite ) , the theorem follows directly from propositions [ thg ] and  [ 3gneighborhood](ii ) .    before concluding this subsection",
    ", we explore some properties of @xmath193 and @xmath237 as stated in proposition  [ sgt ] below , which will play an important role in our further discussion .",
    "below we denote by @xmath238 the totality of @xmath203-dimensional @xmath21-valued vectors . for @xmath239 , we define @xmath240 for @xmath241 . for @xmath242 and @xmath243",
    ", we define @xmath244 by setting @xmath245 .",
    "further , for @xmath246 , we define @xmath247 by setting @xmath248 for @xmath81 and @xmath249 for @xmath250 , define @xmath251 by setting @xmath252 for @xmath81 and @xmath253 for @xmath250 .",
    "we say that a vector @xmath254 is null , if @xmath255 for all @xmath256 .",
    "[ sgt ] for @xmath183 with @xmath201 and @xmath257 , we denote by @xmath258 the @xmath29th order statistic of @xmath193 for @xmath259 , and write @xmath260 for @xmath237 .",
    "then the following assertions hold :    for all @xmath42 , @xmath260 is a finite subset of @xmath261 such that @xmath262 form a partition of @xmath18 for each @xmath263 .",
    "moreover , any @xmath264 is not null .",
    "there exist @xmath265 with @xmath266 such that @xmath267 and @xmath268 when @xmath269 for all @xmath270 .    for @xmath271 ,",
    "if we write @xmath272",
    ". then either @xmath273 for some @xmath274 , or @xmath275 for some @xmath97 and some @xmath276 .",
    "for each @xmath276 , there exists @xmath277 at which @xmath5 appears in the following sense : if we write @xmath278 , then @xmath279 for some @xmath280 satisfying @xmath281 .",
    "moreover , the time point @xmath282 at which @xmath5 appears is unique .    for @xmath269 ,",
    "if we write @xmath283 and make the convention that @xmath198 and @xmath284 , then @xmath167 is expressed as @xmath285 with @xmath286 for each @xmath97 .",
    "all the assertions can be checked directly by the definition of @xmath193 and @xmath237 , as well as definition  [ state ] , ( [ g^ ] ) and ( [ g ] ) , we leave the details to the reader .",
    "let @xmath3 be the probability space specified in theorem  [ space ] . in this subsection , we shall define a sequence of random variables @xmath4 on @xmath3 and derive their distributions , which will be used to model our spatial algorithm .",
    "in section  [ constructiong ] , we have defined @xmath195 to be the @xmath29th order statistic of @xmath193 . with the convention that @xmath198 and @xmath287 for @xmath200 , by proposition  [ 3gneighborhood ] we see that @xmath288 is a sequence of continuous mappings from @xmath2 to @xmath289 $ ] . in what follows",
    ", we define the random sequence @xmath290 .",
    "below for @xmath239 and @xmath291 , we write @xmath292}(\\vec{z})=(z_0 , \\ldots , z_i)$ ] . for a subset @xmath293 , we write @xmath294}(a):= \\{\\pi_{[0,i]}(\\vec{a})\\dvtx    \\vec{a } \\in a,\\break     \\pi_{[0,i]}(\\vec{a } )    \\mbox { is not null in }   \\mathcal{p}^{i+1}\\}$ ] for @xmath295 , and make the convention that@xmath294}(a)= a$ ] for @xmath296 .",
    "let @xmath183 . for @xmath297 , we define @xmath298}\\bigl(\\mathfrak{s}\\bigl(g(t)\\bigr )",
    "\\bigr).\\ ] ] for @xmath299 , we set @xmath300 where @xmath301 is specified in proposition  [ sgt](iv ) , that is , @xmath302 is the type set involved at the recombination at locus @xmath5 when it first becomes a breakpoint .",
    "further , we define @xmath303}(\\vec { z}_l ) \\qquad\\mbox{for } t\\geq t^i_0,\\ ] ] here @xmath282 is specified in proposition  [ sgt](iv ) and @xmath304 is the unique vector in @xmath237 satisfying @xmath305 .",
    "note that the existence and uniqueness of @xmath306 employed above is ensured by proposition  [ sgt](i ) .",
    "intuitively , @xmath307 traces those lineages containing the genotypes @xmath302 at locus @xmath5 , the ancestral materials @xmath306 and @xmath308 are objects at different times @xmath42 and @xmath309 , respectively . for @xmath310",
    ", we make the convention that @xmath311 and @xmath312 , here @xmath313 denotes the null vector in @xmath314 .    for each @xmath315 , we define recursively for @xmath229 , @xmath316 and @xmath317 with the convention that @xmath318 . for convenience ,",
    "we make the further convention that @xmath319 when @xmath320",
    ". then @xmath321 is uniquely determined by the @xmath322-valued sequence @xmath323 .",
    "( here and henceforth , @xmath324 $ ] . )",
    "we remind the reader that for @xmath325 where @xmath302 was used as a label for defining @xmath307 [ cf .",
    "( [ xii ] ) , ( [ z^i ] ) ] .",
    "below we endow the product topology on @xmath326 .",
    "[ zjcon ] for each @xmath29 and @xmath208 , @xmath327 is a continuous functional from @xmath2 to @xmath328 .    for each @xmath29 , @xmath321 is a jump process on @xmath2 with at most finitely many jumps .",
    "proposition  [ zjcon ] is proved in section a.9 of the supplemental article @xcite .",
    "we now study the measurable structure of @xmath4 .",
    "let @xmath183 .",
    "we define for @xmath329 , @xmath330 for @xmath331 , we define @xmath332 recursively by the scheme below . for @xmath333 , define @xmath334 \\\\[-8pt ] \\nonumber & & \\qquad= \\bigl\\{\\vec{z}\\in\\mathcal{p}^{i+1}\\dvtx \\pi_{[0,i-1]}(\\vec{z } ) \\in v\\bigl(z^0,z^1,\\ldots , z^{i-1};t\\bigr ) , \\pi_i(\\vec{z})= \\pi_{i-1}(\\vec{z } ) \\bigr\\};\\end{aligned}\\ ] ] for @xmath335 , define @xmath336 \\\\[-8pt ] \\nonumber & & \\qquad\\quad { } \\cup \\bigl\\{\\vec{z}\\in\\mathcal{p}^{i+1}\\dvtx \\pi_{[0,i-1]}(\\vec{z } ) \\in v\\bigl(z^0,z^1,\\ldots , z^{i-1};t\\bigr ) \\setminus\\bigl\\{\\pi_{[0,i-1]}\\bigl(z^i(t)\\bigr)\\bigr\\},\\\\ & & \\hspace*{220pt}\\qquad\\quad\\pi_i(\\vec{z})= \\pi_{i-1}(\\vec{z})\\setminus \\xi^i \\bigr\\}. \\nonumber\\end{aligned}\\ ] ] for @xmath337 , we define @xmath338 .",
    "[ v ] let @xmath339 be defined as above .",
    "then for each @xmath340 , we have @xmath341}\\bigl(\\mathfrak{s}\\bigl(g(t)\\bigr)\\bigr).\\ ] ]    proposition  [ v ] is proved in section a.10 of the supplemental article @xcite .    next ,",
    "for @xmath33 and @xmath23 , we define @xmath342 by setting @xmath343 for @xmath57 , we define @xmath344}^{e}(x ) \\in e$ ] by setting @xmath345}^{e}(x):=\\bigl\\{f^s_j \\dvtx 1\\leq j \\leq k , f^s_j\\not\\equiv\\varnothing\\bigr\\}.\\ ] ] applying proposition  [ neighborhood](ii ) , one can check that @xmath346}^{e}$ ] is a measurable map from @xmath347 to @xmath348 .",
    "below we shall sometimes write @xmath349}^{e}(x)$ ] , and write @xmath350= ( \\pi_{[0,s]}^{e})^{-1}\\{x^s\\}=:\\{y\\in e\\dvtx y^s = x^s\\}$ ] . let @xmath351}^{e})$ ] be the sub @xmath236-algebra of @xmath352 generated by @xmath344}^{e}$ ] . then @xmath350 $ ] is an atom of @xmath351}^{e})$ ] for each @xmath31 .    for @xmath183",
    ", we define @xmath344}^{g}(g)$ ] by setting @xmath353}^{g}(g ) ( t):=\\pi_{[0,s]}^{e } \\bigl(g(t)\\bigr)\\qquad \\forall t\\geq0.\\ ] ]    [ measg ] @xmath344}^{g}$ ] is a measurable map from @xmath234 to @xmath234 .",
    "proposition  [ measg ] is proved in section a.11 of the supplemental article @xcite .",
    "we extend the definition of @xmath344}^{g}(g)$ ] by setting @xmath346}^{g}(g)=g$ ] for @xmath354 .",
    "write @xmath355}^{g}(g)$ ]",
    ". then @xmath356 can be viewed as a @xmath2-valued stochastic process defined on the probability space @xmath357 . from proposition  [ sgt](v ) , we see that @xmath358 is a jump process , that is , its pathes are piecewise constant and right continuous with left limits .",
    "define @xmath359 and @xmath360 for @xmath315 .",
    "that is , @xmath361 is the @xmath29th jump time of @xmath362 .",
    "let @xmath363 , be the natural filtration of @xmath362 and @xmath364 .",
    "since for @xmath365 , it holds that @xmath366}^{g}(x^{s})$ ] , therefore , @xmath367 is @xmath368 measurable .",
    "thus , @xmath369 and @xmath370 is a @xmath2-valued markov process with respect to its natural filtration .",
    "the proposition below shows that @xmath4 enjoys a very nice measurable structure .",
    "[ fil]for @xmath315 , we have @xmath371    proposition  [ fil ] is proved in section  [ prooffil ] .",
    "we write @xmath372 for @xmath373 . for fixed @xmath374 ,",
    "we write @xmath375 .",
    "it is easy to see that @xmath376}^e(x(t))$ ] .",
    "therefore , @xmath377 is a jump process taking values in @xmath378 . here and henceforth , @xmath379}^{e}(e)=\\bigl",
    "\\{x^s\\dvtx x\\in e\\bigr\\}.\\ ] ] note that @xmath380}^{e}(x)\\}$ ] , hence @xmath381 is a borel subset of @xmath36 .",
    "set @xmath382 and for @xmath229 define @xmath383 since @xmath384 , we have that @xmath385 \\\\[-8pt ] \\nonumber & = & \\sigma\\bigl\\{x^s(0),\\tau_1^{s},x^s \\bigl(\\tau_1^{s}\\bigr),\\tau_2^{s},x^s \\bigl(\\tau_2^{s}\\bigr ) , \\ldots\\bigr\\}.\\end{aligned}\\ ] ]    the proposition below is crucial for deriving the distributions of @xmath386 .",
    "its proof is quite long and involves a study of projections of q - processes . to avoid digression from the main topics of this paper",
    ", the proof will appear elsewhere . in",
    "what follows , we always assume that @xmath387 where @xmath157 was specified by  ( [ x0 ] ) .",
    "[ distribution2]let @xmath388 . for @xmath229 and @xmath389",
    ", we define @xmath390 for @xmath391 , where @xmath392 is the time shift operator with respect to the @xmath393-stopping time @xmath394 ( @xmath395 refers to the natural filtration generated by @xmath148 ) . then for @xmath396",
    ", we have @xmath397}^e(y_n),dy_{n+1 } \\bigr ) \\\\ & & \\qquad\\quad \\int_e q(y_{n+1},dy_{n+2})\\cdots\\int _ e q(y_{n+k-1 } , dy_{n+k})i_{b}(t_1,y_1 , \\ldots , t_{n+k},y_{n+k } ) \\\\ & & \\qquad\\quad { } \\cdot i_{\\{t_1<\\cdots < t_{n+k}\\}}(t_1,\\ldots , t_{n+k})\\prod _ { j=0}^{n-1}i_{e^{s}}(y_{j+1})\\prod _ { i=0}^{k-1}i_{e^{u}}(y_{n+i+1 } ) \\\\ & & \\qquad\\quad { } \\cdot\\exp\\biggl\\{-\\sum_{j=0}^{n-1}q \\bigl(y_j,\\bigl[y_j^s\\bigr]^{c } \\bigr ) ( t_{j+1}-t_j ) \\\\ & & \\hspace*{59pt}{}-\\sum_{i=0}^{k-1}q \\bigl(y_{n+i},\\bigl[y_{n+i}^u\\bigr]^{c } \\bigr ) ( t_{n+i+1}-t_{n+i})\\biggr\\}.\\end{aligned}\\ ] ]    see @xcite .    for @xmath398 , we define @xmath399 by setting @xmath400 note that by definition  [ state ] , @xmath401 is a partition of @xmath18 . for @xmath183 , @xmath33",
    ", we write @xmath402 where @xmath403 . intuitively , @xmath404 is the coalescent tree at site @xmath48 , and @xmath405 is the total length of the coalescent tree @xmath406 before  @xmath407 .",
    "[ distsi ] for @xmath408 , the distribution of @xmath409 conditioning on @xmath410 is : for @xmath411 , @xmath412 and @xmath413    theorem  [ distsi ] is proved in section  [ proofdistsi ] .",
    "[ distz^0 ] we have @xmath414 , and the distribution of @xmath415 follows that of a standard kingman s coalescent tree developed in @xcite .    theorem  [ distz^0 ] is proved in section  [ proofdistz^0 ] .    below we study the distribution of @xmath416 conditioning on @xmath417 for each @xmath408 .",
    "note that for @xmath315 , @xmath418 is uniquely determined by the @xmath322-valued sequence @xmath323 .",
    "thus , by virtue of proposition  [ fil ] , we need only to calculate the distribution of @xmath419 conditioning on @xmath420 .",
    "let @xmath408 be fixed .",
    "we calculate first @xmath421 for @xmath422 .",
    "the theorem below shows that the location where @xmath409 first appears is uniformly distributed on @xmath423 .",
    "[ distt0 ] for any @xmath424 , @xmath425 , we have @xmath426 where @xmath212 is the lebesegue measure and @xmath427 .",
    "theorem  [ distt0 ] is proved in section  [ proofdistt0 ] .    for fixed @xmath428 ,",
    "with much more complicated argument and discussion , we can calculate the conditional distribution @xmath429 for arbitrary @xmath430 and @xmath431 .",
    "the detailed discussion is given in the supplemental article @xcite .",
    "the corresponding results are divided into 3 cases and stated below .",
    "_ case _ 1 : @xmath432 . since @xmath292}(\\xi_0^{i+1})=\\vec { \\varnothing}$ ] , and",
    "the time point at which @xmath409 appears is unique [ cf .",
    "proposition  [ sgt](iv ) ] , in this case the next event at time point @xmath433 must be a coalescence .",
    "we have the following theorem .    [ disttxi1 ]",
    "suppose that @xmath432 .    for @xmath431 satisfying @xmath434 , we have @xmath435    for @xmath431 satisfying @xmath436 , we have for arbitrary @xmath430 @xmath437}(\\vec { \\xi})\\in \\mathfrak{s}(x^{s_i}(t_{j+1}))\\}}(t_{j+1})\\\\ & & \\qquad\\quad{}\\cdot\\exp\\biggl\\{-\\int_{t_j^{i+1}}^{t_{j+1}}\\bigl|x^{s_i}(t)\\bigr|\\,dt \\biggr\\ } \\,dt_{j+1}.\\end{aligned}\\ ] ]    see theorem b.10 in the supplemental article @xcite .",
    "_ case _ 2 : @xmath438 and @xmath439 .",
    "because the time point at which @xmath409 appears is unique , in this case @xmath433 must be a jump time of @xmath440 .",
    "we define @xmath441}\\bigl(\\xi_j^{i+1}\\bigr)\\notin \\mathfrak{s}\\bigl(x^{s_i}(t)\\bigr)\\bigr\\}.\\ ] ]    [ disttxi3 ] suppose that @xmath442 and @xmath443 . then for @xmath431 satisfying @xmath436 , @xmath444 and @xmath292}(\\vec{\\xi})\\in\\mathfrak{s}(x^{s_i}(\\mathcal{h}))$ ] , it holds that @xmath445 where @xmath446 is defined by ( [ h ] ) .",
    "see theorem b.11 in the supplemental article @xcite .",
    "_ case _ 3 : @xmath438 and @xmath447 . in this case",
    "there is a potential recombination which generates again a new lineage carrying @xmath448 .",
    "let @xmath446 be defined by  ( [ h ] ) .",
    "if the waiting time is smaller than @xmath449 , then recombination happens ; otherwise no recombination will happen and the lineage which carrys @xmath450 will follow the change of @xmath440 . in what follows , for an arbitrary @xmath431 , we define @xmath451 if @xmath452 , otherwise we set @xmath453 .",
    "[ disttxi2 ] suppose that @xmath442 and @xmath447 .    for @xmath454 and @xmath430 , we have @xmath455 where @xmath456 is specified by ( [ hxi ] ) .    for @xmath431 satisfying @xmath436 , @xmath444 and @xmath292}(\\vec{\\xi})\\in\\mathfrak{s}(x^{s_i}(\\mathcal{h}))$ ]",
    ", we have @xmath457    for @xmath431 satisfying neither nor , we have @xmath435    see theorem b.12 in the supplemental article @xcite .",
    "based on the random sequence @xmath458 discussed above , in this subsection we describe our model of spatially moving algorithm and study its statistical property .      in this subsection , we describe briefly our spatially moving algorithm ; for details , see @xcite .",
    "our new algorithm is called @xmath7 , which will recursively construct part graph @xmath440 with each branch assigned some label @xmath459 .",
    "all the branches with label @xmath29 form the local tree @xmath423 .",
    "_ step _ 1 .",
    "construct a standard kingman s coalescent tree ( cf .",
    "@xcite ) @xmath460 at the position @xmath198 ( the left end point of the sequence ) and assign each branch of the tree with the label @xmath461 .",
    "let @xmath462 .",
    "_ step _ 2 .",
    "assume that we have already constructed @xmath440 along with local tree @xmath423 .",
    "take the next recombination point @xmath409 along the sequence according to the distribution @xmath463 if @xmath464 , stop ; otherwise , go to step 3 .",
    "_ step _ 3 .",
    "uniformly choose a recombination location on @xmath423 .",
    "for @xmath465 , let @xmath466 denote the latitude ( i.e. , the height from the bottom to the location ) of the chosen location .",
    "_ step _ 4 . at the recombination location ,",
    "a new branch with label @xmath467 is created by forking off the recombination node and moving backward in time ( i.e. , along the direction of increasing latitude ) . with equal exponential rate 1",
    ", the new branch will have a tendency to coalesce to each branch in @xmath440 which has higher latitude than @xmath466 .",
    "thus , if there are @xmath468 branches in @xmath440 at the current latitude , then the waiting time before coalescence is exponentially distributed with parameter @xmath468 .",
    "note at different latitude there may be different number @xmath468 of branches .",
    "let the branch to which the new branch coalesces be called edge , and let @xmath433 be the latitude of the coalescent point and regard @xmath469 as @xmath46 in the next step .",
    "_ step _ 5 .",
    "if the edge is labeled with @xmath29 , go to step 6 ; if the edge is labeled with some @xmath0 less than @xmath29 , then a potential recombination event should be considered . the waiting time @xmath42 of the possible recombination event on the edge is exponentially distributed with parameter @xmath470 .    * _ case _ 5.1 .",
    "if @xmath471 is less than the latitude of the upper node of the edge which is denoted by @xmath446 , then it is the next recombination location .",
    "let @xmath472 , the part of the branch above @xmath433 is no longer called edge .",
    "regard @xmath469 as @xmath46 and go to step 4 . *",
    "_ case _ 5.2 .",
    "if @xmath473 , choose the upper edge of the current edge with the larger label to be the next edge .",
    "let @xmath474 , regard @xmath469 as @xmath46 and go to step 5 .",
    "_ step _ 6 .",
    "let @xmath475 be the collection of all the branches in @xmath476 and all the new branches labeled @xmath467 .",
    "starting from each node @xmath477 at the bottom of the graph , specify a path moving along the edges in @xmath475 increasing latitude , until the top of the graph .",
    "whenever a recombination node is encountered , choose the edge with the larger label .",
    "the collection of all the paths then form the local tree @xmath478 .",
    "update all the branches in @xmath478 with label @xmath467 .",
    "assume that we have already constructed @xmath440 .",
    "then the local tree @xmath423 and the breakpoints @xmath479 are all known .",
    "thus , steps  2 and  3 are feasible .",
    "moreover , once we have constructed @xmath440 , then the ancestral material of each edge in @xmath440 , expressed as an @xmath480-dimensional @xmath21-valued vector [ cf .",
    "( [ f^si ] ) ] , is also implicitly known . in step 4 , if we denote by @xmath481 the ancestral material of the edge where the recombination location lies , then it is implicitly assumed that the ancestral material carried on the new branch with label @xmath467 is the @xmath482-dimensional @xmath21-valued vector @xmath483 .",
    "if for @xmath465 we write @xmath484 for @xmath485 , and denote @xmath486 , then in steps 4 and  5 the algorithm specifies a path describing how the ancestral material @xmath448 coalesces to @xmath440 by coalescence and leaves @xmath440 by recombination .",
    "when the edge in step 4 is labeled @xmath29 , then it is implicitly assumed that the path carrying the ancestral material @xmath448 extends continuously along the edges with the larger label in @xmath476 , starting from the edge until the top of the graph . in step 6 ,",
    "the algorithm formulates @xmath475 with the branches in @xmath440 and the new branches created in step 4 . for an edge in @xmath440 carrying an ancestral material @xmath487 ,",
    "when the edge is viewed as an edge in @xmath475 , it is implicitly assumed that its ancestral material is updated to @xmath488 by the following rule : ( i ) if the edge is on the path of @xmath448 specified above , then @xmath489 ; ( ii ) if the edge is not on the path of @xmath448 , then @xmath490 on the part of the edge below the latitude @xmath491 , and @xmath492 on the part of the edge above the latitude @xmath491 .      in this subsection",
    ", we shall show that the probability distribution of the arg generated by the @xmath7 algorithm coincides with that generated by the back - in - time algorithm as specified in theorem  [ space ] . to this end , we denote by @xmath493 the maximum @xmath29 such that @xmath494 .",
    "for each @xmath495 , we denote by @xmath496 the ancestral material [ represented as an @xmath482-dimensional @xmath497-valued vector ] at the latitude @xmath498 on the path of edges carrying @xmath448 , and set @xmath499 for @xmath500 , with @xmath501 representing the null vector in @xmath502 . for @xmath503",
    ", we set @xmath504 , and @xmath505 .",
    "further , we write @xmath414 for @xmath424 .",
    "[ finitedim ] with the above convention , the finite dimensional distribution of the random sequence @xmath4 generated by the @xmath7 algorithm is the same as that developed in section  [ sequence ] .",
    "proposition  [ finitedim ] is proved in section  [ prooffinitedim ] .    by virtue of the above proposition , we are in a position to prove the following most important theorem of this paper .    [ coincide ]",
    "let @xmath3 be the probability space specified in theorem  [ space ] , and denote by @xmath506 the probability distribution on @xmath2 generated by @xmath7 algorithm .",
    "then we have @xmath507 .",
    "theorem  [ coincide ] is proved in section  [ proofcoincide ] .",
    "the proof of proposition  [ fil ] needs the following lemma .",
    "[ f^si ] for each @xmath315 , we have @xmath508    by the classical theory of jump processes ( cf . , e.g. , @xcite , definition  11.48 and corollary  5.57 ) , we have @xmath509 and @xmath510 where @xmath511 . since @xmath512 for @xmath354 , one can check that @xmath513 , @xmath514 , @xmath515 and @xmath516 for @xmath315 .",
    "hence , we have @xmath517 .",
    "therefore , we have @xmath518    next , for an arbitrary @xmath183 , suppose that @xmath167 is expressed as @xmath285 , then by proposition  [ sgt](v ) we can show that @xmath519 consequently , for @xmath520 , we have @xmath521}^{g}(x^{s_i})$ ] and @xmath522 , and the second equality of ( [ fsi ] ) follows .",
    "proof of proposition  [ fil ] by ( [ f^si ] ) , we have @xmath523 for all @xmath520 , hence @xmath524 to show the inverse inclusion , we put @xmath525^i \\times \\mathcal{s}_{[0,\\infty)}(\\mathcal{r } ) \\times \\prod _ { l=1}^{i } \\mathcal{s}_{[0,\\infty)}\\bigl ( \\mathcal{p}^{l+1}\\bigr),\\ ] ] where @xmath526 is the collection of all the partitions of @xmath527 , and @xmath528 [ resp . , @xmath529 equipped with the skorohod topology are the spaces of all the @xmath530-valued ( resp . , @xmath526-valued )",
    "right continuous piecewise constant functions on @xmath162 with at most finitely many discontinuity points .",
    "define @xmath531 from propositions [ 3gneighborhood ] and  [ zjcon ] , we see that @xmath532 is a continuous map from @xmath2 to the polish space @xmath533 .",
    "denote by @xmath534 . by ( [ f^si ] )",
    ", we have @xmath535 . by ( [ f^si ] ) and proposition  [ v ]",
    "one can check that @xmath532 restricted to @xmath536 is an injective map .",
    "below we write @xmath537 .",
    "note that @xmath538 is a borel subset of the polish space @xmath2 .",
    "hence @xmath539 is a borel subset of @xmath540 and @xmath541 is borel measurable ( cf .",
    "@xcite , theorems  8.3.5 and 8.3.7 ) .",
    "define a map @xmath542 by setting @xmath543 if @xmath544 and @xmath545 if @xmath546 , where @xmath547 is a fixed element in @xmath2 .",
    "since @xmath548 is borel measurable and @xmath549 is a borel subset of @xmath540 , hence @xmath550 is also borel measurable . noticing that @xmath551",
    ", we conclude that @xmath552 , completing the proof .",
    "the proof of theorem  [ distsi ] requires the following two lemmas .",
    "[ si1 ] for @xmath553 , it holds that @xmath554}^g(g)=\\pi_{[0,u]}^g(g ) \\bigr\\}|\\mathcal{f}^u\\bigr)=\\exp\\biggl\\{-\\rho",
    "l_u \\bigl(x^u\\bigr)\\int_{u}^{s}2^{-1}p(r)\\,dr \\biggr\\}.\\ ] ]    for @xmath374 , we set @xmath555 .",
    "note that @xmath556}^g(g)$ ] is uniquely determined by @xmath557 .",
    "therefore for @xmath558 , @xmath344}^g(g)=\\pi_{[0,u]}^g(g)$ ] if and only if @xmath559 and @xmath560 for all @xmath561 , and @xmath562 .",
    "write @xmath563 . since @xmath564}^g(g)\\}$ ] ,",
    "hence @xmath565 . for @xmath105",
    ", we set @xmath566 and define @xmath567 for @xmath568 .",
    "then @xmath569 is a measurable map from @xmath570 to @xmath571 .",
    "since @xmath570 is a borel subset of the polish space @xmath2 and @xmath569 is injective , @xmath572 is a borel subset of @xmath573 ( cf .",
    ", e.g. , @xcite , theorem  8.3.7 ) . by the one to one correspondence between @xmath570 and @xmath572",
    ", one can check that if @xmath183 satisfies @xmath574 , then @xmath344}^g(g)=\\pi_{[0,u]}^g(g)$ ] .    for @xmath575 ,",
    "denote by @xmath576 . applying proposition  [ distribution2 ]",
    ", we have @xmath577}^g(g)= \\pi_{[0,u]}^g(g)\\bigr\\}\\bigr ) \\\\ & & \\qquad = p\\bigl(\\bigl\\{g\\dvtx \\bigl(x^u(0),\\tau_1^{u},x^u \\bigl(\\tau_1^{u}\\bigr),\\ldots,\\tau_k^{u},x^u \\bigl(\\tau _ k^{u}\\bigr)\\bigr)\\in b,\\pi_{[0,s]}^g(g)= \\pi_{[0,u]}^g(g)\\bigr\\}\\bigr ) \\\\ & & \\qquad = p\\bigl(\\bigl\\{g\\dvtx \\bigl(x^s(0),\\tau_1^{s},x^s \\bigl(\\tau_1^{s}\\bigr),\\ldots,\\tau_k^{s},x^s \\bigl(\\tau _ k^{s}\\bigr)\\bigr)\\in b\\bigr\\}\\bigr ) \\\\ & & \\qquad=\\int_{r^+\\times e}\\cdots\\int_{r^+\\times e}\\cdots \\int _ { r^+\\times e}i_{b}(y_0,t_1,y_1 , \\ldots , t_k , y_k ) \\\\ & & \\qquad\\quad { } \\cdot\\exp\\biggl\\{-\\sum_{n=0}^{k-1}q \\bigl(y_{n},\\bigl[y_{n}^{s}\\bigr]^{c } \\bigr ) ( t_{n+1}-t_{n})\\biggr\\ } \\\\ & & \\qquad\\quad dt_{k+1}q(y_{k},dy_{k+1})\\cdots dt_{n+1}q(y_{n},dy_{n+1})\\cdots dt_1q(y_0,dy_1).\\end{aligned}\\ ] ] for @xmath578 , if we set @xmath579 , with the convention that @xmath580 , then @xmath581 and it is easy to check that @xmath582 .",
    "since @xmath583 , by ( [ qxa ] ) we can derive that for @xmath584 , @xmath585^{c})=q(y_n,[y_n^{u}]^{c})+|\\pi _",
    "u(y_n)|\\int_u^s 2^{-1}\\rho p(r)\\,dr$ ] .",
    "therefore , from the above we get @xmath577}^g(g)= \\pi_{[0,u]}^g(g)\\bigr\\}\\bigr ) \\\\ & & \\qquad=\\int_{r^+\\times e}\\cdots\\int_{r^+\\times e}\\cdots \\int _ { r^+\\times e}i_{b}(y_0,t_1,y_1 , \\ldots , t_k , y_k ) \\\\ & & \\qquad\\quad { } \\cdot\\exp\\biggl\\{-\\sum_{n=0}^{k-1}q \\bigl(y_{n},\\bigl[y_{n}^{u}\\bigr]^{c } \\bigr ) ( t_{n+1}-t_{n})\\biggr\\ } \\\\ & & \\qquad\\quad { } \\cdot\\exp\\biggl\\{-\\sum_{n=0}^{k-1}\\bigl| \\pi_u(y_n)\\bigr|(t_{n+1}-t_n ) \\int _ { u}^{s}2^{-1}\\rho p(r)\\,dr\\biggr\\ } \\\\ & & \\qquad\\quad dt_{k+1}q(y_{k},dy_{k+1})\\cdots dt_{n+1}q(y_{n},dy_{n+1})\\cdots dt_1q(y_0,dy_1 ) \\\\ & & \\qquad= \\int_g i_{\\{x^u\\in a\\}}\\exp\\biggl\\{-\\rho l_u\\bigl(x^u\\bigr)\\int_{u}^{s}2^{-1}p(r)\\,dr \\biggr\\}p(dg).\\end{aligned}\\ ] ] the proof is completed by noticing that @xmath586 and @xmath587 .",
    "[ si2 ] for an arbitrary @xmath588-stopping time @xmath589 , we write @xmath590 , then the distribution of @xmath591 conditioning on @xmath592 is : for @xmath411 , @xmath593    for @xmath229 , we define @xmath594 then @xmath595 are countably valued stopping times and @xmath596 . by the convergence theorem of conditional expectations ( cf . ,",
    "e.g. , @xcite , theorem  2.21 ) , for @xmath411 employing lemma  [ si1 ] we obtain @xmath597 on the other hand , we have @xmath598    proof of theorem  [ distsi ] if @xmath599 , then we have @xmath600 .",
    "therefore , the theorem is a direct consequence of the above lemma .      comparing ( [ z^o ] ) and ( [ ts ] ) , it is apparent that @xmath414 . in proposition",
    "[ distribution2 ] , let @xmath601 and @xmath602 , then for @xmath603 we have @xmath604^{c } \\bigr ) ( t_{j+1}-t_j)\\biggr\\}.\\end{aligned}\\ ] ] note that @xmath605^{c})=|\\pi_0^e(y)|(|\\pi_0^e(y)|-1)/2 $ ] for @xmath606 . identifying @xmath94 with @xmath607 for @xmath608 , we see that @xmath609 is a standard kingman s coalescent tree .",
    "we first make some preparing discussions . for @xmath610 and @xmath425 , we put @xmath611 . for notational convenience , below we use also @xmath612 to denote the indicator function of @xmath612 . for @xmath428 , @xmath613 , @xmath33 , @xmath614 and @xmath615 , we define @xmath616    [ distz1 ] let @xmath33 and @xmath614 be such that @xmath617 .",
    "then for any @xmath618 , we have @xmath619 \\\\[-8pt ] \\nonumber & & \\qquad\\quad{}\\cdot\\int_{\\tau_j^a\\wedge t}^{\\tau_{j+1}^a\\wedge t}\\exp \\biggl\\{- \\biggl[\\bigl| \\mathcal{t}_{a}\\bigl(\\tau_j^a\\bigr)\\bigr| \\bigl(t^{\\prime}-\\tau_j^a\\bigr ) + \\sum_{l=0}^{j-1}\\bigl|\\mathcal{t}_{a } \\bigl(\\tau _ l^a\\bigr)\\bigr|\\bigl(\\tau_{l+1}^{a}- \\tau_l^a\\bigr ) \\biggr ] \\\\ & & \\hspace*{195pt}\\qquad\\quad{}\\cdot\\int_{s-\\varepsilon}^{s}2^{-1 } \\rho p(r)\\,dr \\biggr\\}\\,dt^{\\prime}. \\nonumber\\end{aligned}\\ ] ]    we need only to check the lemma in the case that @xmath620 .",
    "note that @xmath621 .",
    "take an arbitrary set @xmath622 .",
    "define @xmath623 , where @xmath569 is specified as in the proof of lemma  [ si1 ] .",
    "then @xmath624 and @xmath625 suppose that @xmath626 .",
    "one can check that @xmath627 because @xmath628 , therefore , for @xmath629 , there exists @xmath630 such that @xmath631 for @xmath632 .",
    "we set @xmath633 and define @xmath634 , y^{\\prime}\\in j_{y_j } \\bigr\\}.\\end{aligned}\\ ] ] with @xmath635 in the place of @xmath636 , we may write ( [ inb ] ) as @xmath637 for @xmath638 , we set @xmath639",
    ". one can check that @xmath640 for each @xmath468 . employing the strong markov property and proposition  [ distribution2 ] , we get @xmath641}^e \\bigl(y^{\\prime}\\bigr),dy_{j+1}\\bigr)\\cdots\\int _",
    "e q(y_{k-1 } , dy_k)i_{b}(t_1,y_1 , \\ldots , t_k , y_k)i_{j_{y_j}}\\bigl(y^{\\prime } \\bigr ) \\\\ & & \\qquad\\quad { } \\cdot\\exp \\biggl\\{-\\sum_{l=0}^{j-1}q \\bigl(y_l,\\bigl[y_l^s\\bigr]^{c } \\bigr ) ( t_{l+1}-t_l)- \\sum_{l = j+1}^{k-1}q \\bigl(y_l,\\bigl[y_l^{s-\\varepsilon}\\bigr]^{c } \\bigr ) ( t_{l+1}-t_l ) \\\\ & & \\hspace*{62pt}\\qquad\\quad { } -q\\bigl(y_j,\\bigl[y_j^s \\bigr]^{c}\\bigr ) \\bigl(t^{\\prime}-t_j\\bigr)-q \\bigl(y^{\\prime},\\bigl[\\bigl(y^{\\prime}\\bigr)^{s-\\varepsilon } \\bigr]^{c}\\bigr ) \\bigl(t_{j+1}-t^{\\prime}\\bigr ) \\biggr \\}.\\end{aligned}\\ ] ] since @xmath642 , hence for @xmath643 we have @xmath644}^e(y^{\\prime})=\\pi_{[0,s-\\varepsilon]}^e(y_j)=y_j$ ] and @xmath645 . therefore , @xmath646^{c } \\bigr ) ( t_{l+1}-t_l ) -\\sum_{l = j+1}^{k-1}q \\bigl(y_l,\\bigl[y_l^{s-\\varepsilon}\\bigr]^{c } \\bigr ) ( t_{l+1}-t_l ) \\\\[-2pt ] & & \\hspace*{72pt}\\qquad\\quad { } -q\\bigl(y_j,\\bigl[y_j^s \\bigr]^{c}\\bigr ) \\bigl(t^{\\prime}-t_j\\bigr)-q \\bigl(y_j,\\bigl[y_j^{s-\\varepsilon}\\bigr]^{c } \\bigr ) \\bigl(t_{j+1}-t^{\\prime}\\bigr ) \\biggr\\}.\\end{aligned}\\ ] ] for @xmath647 , we have @xmath648 for all @xmath649 , therefore,@xmath650^{c})=q(y_l,[y_l^{s-\\varepsilon}]^{c})+|\\pi_a(y_l)| \\int_{s-\\varepsilon}^{s}2^{-1}\\rho",
    "p(u)\\,du$ ] .",
    "thus , @xmath651 & & \\qquad=\\int_0^{\\infty}\\,dt_1\\cdots\\int _ 0^{\\infty}\\,dt_k\\int_e q(y_0,dy_1)\\cdots \\int_e q(y_{k-1 } , dy_k ) \\\\[-2pt ] & & \\qquad\\quad i_{b}(t_1,y_1,\\ldots , t_k , y_k ) \\int_{s-\\varepsilon}^{s}2^{-1}\\rho p(u)\\,du\\int _ { t_j\\wedge t}^{t_{j+1}\\wedge t}\\,dt^{\\prime } \\\\[-2pt ] & & \\qquad\\quad { } \\cdot\\exp \\biggl\\ { -\\sum_{l=0}^{j-1 } \\biggl[q\\bigl(y_l,\\bigl[y_l^{s-\\varepsilon } \\bigr]^{c}\\bigr)+\\bigl| \\pi_a(y_l)\\bigr|\\int _",
    "{ s-\\varepsilon}^{s}2^{-1}\\rho p(u)\\,du \\biggr](t_{l+1}-t_l ) \\\\[-2pt ] & & \\hspace*{28pt}\\qquad\\quad { } -\\sum_{l = j+1}^{k-1}q\\bigl(y_l , \\bigl[y_l^{s-\\varepsilon}\\bigr]^{c}\\bigr ) ( t_{l+1}-t_l)-q\\bigl(y_j,\\bigl[y_j^{s-\\varepsilon } \\bigr]^{c}\\bigr ) \\bigl(t_{j+1}-t^{\\prime}\\bigr ) \\\\[-2pt ] & & \\hspace*{46pt}\\qquad\\quad { } - \\biggl[q\\bigl(y_j,\\bigl[y_j^{s-\\varepsilon } \\bigr]^{c}\\bigr)+\\bigl|\\pi_a(y_j)\\bigr|\\int _ { s-\\varepsilon } ^{s}2^{-1}\\rho p(u)\\,du \\biggr ] \\bigl(t^{\\prime}-t_j\\bigr ) \\biggr\\}.\\end{aligned}\\ ] ] note that @xmath652^{c})=q(y_l,[y_l^a]^{c})+|\\pi_a(y_l)| \\int_{a}^{s-\\varepsilon}2^{-1}\\rho p(u)\\,du$ ] .",
    "we define @xmath653 , then @xmath651 & & \\qquad= \\int_0^{\\infty}\\,dt_1\\cdots\\int _",
    "0^{\\infty}\\,dt_k\\int_e q(y_0,dy_1)\\cdots \\int_e q(y_{k-1 } , dy_k ) \\\\[-2pt ] & & \\qquad\\quad i_{b}(t_1,y_1,\\ldots , t_k , y_k ) \\int_{s-\\varepsilon}^{s}2^{-1}\\rho p(u)\\,du \\int _ { t_j\\wedge t}^{t_{j+1}\\wedge t}\\,dt^{\\prime } \\\\[-2pt ] & & \\qquad\\quad { } \\cdot\\exp \\biggl\\{-\\sum_{l=0}^{k-1}q \\bigl(y_l,\\bigl[y_l^a\\bigr]^{c }",
    "\\bigr ) ( t_{l+1}-t_l)-2^{-1}\\rho \\tilde{l}_a\\int_{a}^{s-\\varepsilon}p(u)\\,du \\\\[-2pt ] & & \\hspace*{26pt}\\qquad\\quad { } -\\sum_{l=0}^{j-1}\\bigl|\\pi_a(y_l)\\bigr|(t_{l+1}-t_l ) \\int_{s-\\varepsilon } ^{s}2^{-1}\\rho p(u)\\,du \\\\[-2pt ] & & \\hspace*{95pt}\\qquad\\quad { } -\\bigl|\\pi_a(y_j)\\bigr|\\bigl(t^{\\prime}-t_j \\bigr)\\int_{s-\\varepsilon } ^{s}2^{-1}\\rho p(u)\\,du \\biggr\\}.\\end{aligned}\\ ] ] multiplying with @xmath654 at the right - hand side of the above equality , we get @xmath655^{c } \\bigr ) ( t_{l+1}-t_l)\\biggr\\ } \\tilde{c}(t_1,y_1 , \\ldots , t_k , y_k ) \\\\ & & \\qquad\\quad { } \\cdot \\biggl[\\exp\\biggl(-2^{-1}\\rho\\tilde{l}_a\\int _ { a}^{s-\\varepsilon } p(u)\\,du\\biggr)-\\exp\\biggl(-2^{-1 } \\rho\\tilde{l}_a\\int_{a}^{s}p(u)\\,du \\biggr ) \\biggr],\\end{aligned}\\ ] ] where @xmath656 \\\\ & & \\hspace*{179pt}\\qquad\\quad{}\\cdot\\int_{s-\\varepsilon}^{s}2^{-1}\\rho p(u)\\,du \\biggr\\}\\,dt^{\\prime}.\\end{aligned}\\ ] ] for @xmath657 , if we set @xmath658 , with the convention that @xmath580 , then @xmath659 .",
    "one can check that @xmath660 and @xmath661 .",
    "therefore , applying proposition  [ distribution2 ] we obtain @xmath662a_{k , a , j,\\xi } p(dg).\\end{aligned}\\ ] ] since @xmath622 is arbitrary , hence what we have proved implies that @xmath663a_{k , a , j,\\xi } \\\\ & & \\qquad = c(a , j , s,\\varepsilon)p\\bigl(\\{s-\\varepsilon\\leq s_{i+1 } < s\\ }    lemma  [ si2 ] . the proof is completed by noticing that @xmath664 .    for @xmath229",
    ", we define @xmath665 + 1)$ ] .",
    "then each @xmath666 is a countably valued @xmath667 stopping time and @xmath668 .",
    "if we replace @xmath48 by @xmath669 and @xmath670 by @xmath671 in ( [ k1 ] ) , we get another subset @xmath672 from the expression of @xmath673 as follows : @xmath674 \\\\[-8pt ] \\nonumber & & \\hspace*{56pt}\\mbox{and } f\\in x^{\\sigma_n}\\bigl(\\tau _ { j+1}^{\\sigma_n } \\bigr ) , \\mbox { s.t . } f(r)=\\xi , f(u)=\\varnothing \\mbox { for all } u < r\\bigr\\}. \\nonumber\\end{aligned}\\ ] ]    [ distn ] let the notation be the same as the above lemma . for any @xmath229 and @xmath618 , we have @xmath675    by the definition of @xmath666 , we have @xmath676 , hence @xmath677 .",
    "then by lemma  [ distz1 ] one can check directly that @xmath678    proof of theorem  [ distt0 ] for @xmath679 , we define @xmath680 + 1)$ ] .",
    "if we replace @xmath681 by @xmath682 in @xmath672 , we get another subset @xmath683 .",
    "similar to the proof of lemma  [ distn ] , we can show that @xmath684 since @xmath685 and @xmath686 , by the convergence property of conditional expectations ( cf .",
    ", e.g. , @xcite , theorem  2.21 ) , we get @xmath687 \\\\[-8pt ] \\nonumber & & \\qquad = c\\biggl(s_i , j,\\sigma_n,\\frac{1}{2^n } \\biggr)a_{k , s_i , j,\\xi}i_{\\{s_i < \\sigma_n-{1}/{2^n}\\}}.\\end{aligned}\\ ] ] note that by ( [ cajs ] ) we have @xmath688 by the definition of @xmath689 , we have @xmath690 noticing that @xmath691 a.s .",
    "as @xmath692 , letting @xmath693 in the both sides of ( [ kj ] ) and employing again the convergence property of conditional expectations , we get @xmath694 summing up the above equation for @xmath0 and @xmath46 , and noticing that @xmath695 if and only if @xmath696 for all @xmath697 , we complete the proof of the theorem .      by theorem  [ distz^0 ] , we see that the distribution of @xmath698 generated by step 1 coincides the distribution of @xmath698 defined by ( [ z^o ] ) . it is apparent that the conditional distribution of @xmath409 generated by step 2 coincides with the one specified by theorem  [ distsi ] , and the conditional distribution of @xmath491 and @xmath484 generated by step 3 is the same as those described by theorem  [ distt0 ] . to analyze the random elements generated in steps 4 and  5 , we define recursively for @xmath229 , @xmath699 in step 4 , it is implicitly assumed that the ancestral material carried on the new branch is @xmath448 , which means that @xmath432 .",
    "it is not difficult to check that the distribution employed in step 4 coincides with the one developed in theorem  [ disttxi1 ] . to analyze step 5",
    ", we note that step 5 corresponds to the case that @xmath700 , and the edge is labeled with @xmath29 if and only if @xmath443 .",
    "when the edge is labeled with @xmath29 , the algorithm goes to step 6 , the path carrying the ancestral material @xmath448 is assumed to move along the edges of @xmath476 . in this case",
    ", @xmath433 must be the jump time of @xmath440 at which the lineage carrying the ancestral material @xmath292}(\\xi_j^{i+1})$ ] meets its first change after @xmath701 .",
    "thus , the conditional distribution of @xmath702 coincides with the one described in theorem  [ disttxi3 ] . in step 5 ,",
    "when the edge is labeled with some @xmath0 less than @xmath29 , then a potential recombination event is considered in the algorithm .",
    "we point out that @xmath0 is equal to @xmath703 used in theorem  [ disttxi2 ] , and the upper node of the edge , denoted by @xmath446 in the algorithm , is the time point @xmath446 used in theorem  [ disttxi2 ]",
    ". then one can check that the distribution used in step 5 coincides with the conditional distribution developed in theorem  [ disttxi2 ] . to sum up the above discussion",
    ", we find that all the distributions of the random elements generated by the algorithm coincide with those developed in section  [ sequence ] .",
    "therefore , the finite dimensional distribution of the random sequence @xmath4 generated by the @xmath7 algorithm is the same as that developed in section  [ sequence ] .",
    "below we use @xmath704 to denote the random elements @xmath4 generated by the @xmath7 algorithm , and reserve @xmath4 for those originally defined on @xmath3 as discussed in section  [ sequence ] .",
    "it is implicitly assumed that @xmath705 are taken from some probability space other than the space @xmath2 .",
    "we denote by @xmath706 and denote by @xmath707 the probability distribution of @xmath708 on its sample space @xmath540 specified by ( [ omigai ] ) . here , @xmath709^{i",
    "} \\times\\mathcal{s}_{[0,\\infty ) } ( \\mathcal{r } ) \\times \\prod_{l=1}^{i } \\mathcal{s}_{[0,\\infty)}\\bigl(\\mathcal{p}^{l+1}\\bigr)\\ ] ] is also the sample space of @xmath710 specified by ( [ phii ] ) .",
    "denote by @xmath711 the probability distribution of @xmath532 . by proposition  [ finitedim ] , we have @xmath712 .",
    "bellow we use the notation employed in the proof of proposition  [ fil ] .",
    "then @xmath712 implies in particular that @xmath713 .",
    "each @xmath544 constitutes a part graph @xmath714 , which is described by the map @xmath715 .",
    "since @xmath716 is a one to one borel map , hence @xmath707 induces a probability measure @xmath717 on @xmath718 .",
    "similarly , @xmath711 induces a probability measure @xmath719 on @xmath718 and we have @xmath720 . by lemma  [ f^si ] , we have @xmath721 . for notational convenience below",
    ", we write @xmath722 for @xmath410 . through the mapping @xmath723 , the probability measure @xmath719 determines a probability measure @xmath724 on @xmath725 by setting @xmath726 for all @xmath727 . noticing that @xmath551 , one can check that @xmath728 where @xmath729 is the restriction of @xmath233 on @xmath722 .",
    "similarly , @xmath730 determines a probability measure @xmath731 on @xmath725 . on the other hand ,",
    "let @xmath506 be the probability distribution on @xmath234 generated by the algorithm @xmath7 , then we must have @xmath732 on @xmath718 .",
    "then it is clear that @xmath733 .",
    "therefore , we get @xmath734 . the proof of the theorem is completed by noticing that @xmath735 .",
    "we are indebted to shuhua xu , ying zhou , linfeng li and yuting liu for allowing us to use some material from our joint work @xcite .",
    "we are grateful to de - xin zhang and wei - wei zhai for offering their stimulating idea and for their encouragement .",
    "we thank renming song for his very helpful comments and suggestions .",
    "we thank the editor , associate editor and the anonymous referees for their valuable comments and suggestions which improved the presentation of this paper ."
  ],
  "abstract_text": [
    "<S> genetic recombination is one of the most important mechanisms that can generate and maintain diversity , and recombination information plays an important role in population genetic studies . </S>",
    "<S> however , the phenomenon of recombination is extremely complex , and hence simulation methods are indispensable in the statistical inference of recombination . </S>",
    "<S> so far there are mainly two classes of simulation models practically in wide use : back - in - time models and spatially moving models . </S>",
    "<S> however , the statistical properties shared by the two classes of simulation models have not yet been theoretically studied . </S>",
    "<S> based on our joint research with cas - mpg partner institute for computational biology and with beijing jiaotong university , in this paper we provide for the first time a rigorous argument that the statistical properties of the two classes of simulation models are identical . </S>",
    "<S> that is , they share the same probability distribution on the space of ancestral recombination graphs ( args ) . as a consequence </S>",
    "<S> , our study provides a unified interpretation for the algorithms of simulating coalescent with recombination , and will facilitate the study of statistical inference on recombination .    , </S>"
  ]
}