{
  "article_text": [
    "numerical approximations of the perfectly matched layer ( pml ) @xcite for maxwell s equations in first order form often exhibit a late time linear or exponential energy growth , see for example @xcite .",
    "this unwanted growth can spread into the computational domain and ruin the accuracy of a numerical simulation .",
    "growth is often seen long after a wave has exited the domain or when a wave has been trapped in the domain for a longtime .",
    "the later situation can occur , for example , in the simulation of an electromagnetic waveguide . this has generated substantial interests .",
    "one explanation for this behavior of the pml was offered in @xcite .",
    "it is shown that the split ",
    "field pml is weakly hyperbolic , and numerical approximations can lead to perturbations that excite explosive modes in the pml . because of the result in @xcite , several unsplit ( strongly hyperbolic ) pmls for maxwell s equations were developed @xcite .",
    "however , series of numerical experiments presented in the literature , see for instance @xcite , using standard finite difference schemes and @xcite for finite element methods , suggest that these unsplit pmls also suffer from the same late time exponential energy growth as the split field pml .",
    "it was later shown in @xcite that the source of the late time exponential growth was characterized by the multiplicity of eigenvalues and the degeneracy of eigenvectors of the lower order undifferentiated terms . in @xcite , however , it was shown , for a given computational setup , that the growth generated in the pml , if any , may not propagate back into the computational domain .",
    "it is also important to note that a partial remedy for this problem in odd ( 1 and 3 ) spatial dimensions has been proposed in @xcite , using a lacunae based time integration .",
    "nonetheless , a recent analysis of a pml for maxwell s equations in @xcite shows that the corresponding initial value problem ( ivp ) is asymptotically stable . in this study",
    ", we argue that many of the late time energy growth of the pml for maxwell s equations observed in computations are caused by inadequate numerical boundary treatments in the pml .",
    "we denote that the well  posedness and temporal stability analysis of the pml has been a topic of several works , see for instance @xcite and many others . in @xcite , perfect matching , well - posedness and temporal stability for pmls as well as some other classes of layers are discussed for general systems .",
    "unfortunately , there is no guarantee that all solutions decay with time . in @xcite",
    "however , the geometric stability condition was introduce to characterize the temporal stability of ivp for the pml .",
    "if this condition is not satisfied , then there are modes of high spatial frequencies with temporally growing amplitudes . in this paper",
    ", we consider a two space dimensional model problem satisfying the geometric stability condition but augmented with boundary conditions in the tangential and normal directions .",
    "our primary objective in this paper is the analysis and development of high order accurate and provably stable numerical approximations of the corresponding initial boundary value problem ( ibvp ) .",
    "it is a well known fact that the theory and numerical techniques to solve an ibvp are more elaborate and complicated than that of a corresponding ivp . for a",
    "well  posed partial differential equation which is stable in the absence of boundaries can support unstable solutions , or become ill  posed , when boundaries are introduced .",
    "in fact , the analysis of the ivp is a necessary ( first ) step towards the analysis of the ibvp @xcite . for symmetric hyperbolic systems such as the maxwell s equations and certain boundary conditions , using the energy method , it is possible to obtain a uniform bound on the l@xmath0norm of the solutions ( electric and magnetic fields ) in terms of the l@xmath0norm of the initial data and a boundary norm of the boundary data @xcite . in numerical approximations of ibvps ,",
    "most of the difficulties arise from the boundaries .",
    "similarly , a numerical method which is stable in the absence of boundaries can support growth when boundary conditions are imposed . in the discrete",
    "setting , it is possible though to design stable numerical boundary procedures by mimicking the continuous estimates @xcite .",
    "effective boundary treatments are also important when pmls are used in computations . if there are physical boundaries , for instance in waveguides @xcite , the corresponding boundary conditions must be accurately extended into the pml . in practice",
    ", the pml must be solved on a bounded computational domain .",
    "a stable and accurate pml boundary closure becomes essential , since it enables efficient numerical computations .",
    "there is an ongoing discussion though on how to effectively terminate the pml .",
    "it is also important to point out that a numerical method which is stable in the absence of the pml can support growth when the pml is included .",
    "a major difficulty is that in general the pml ( for symmetric systems ) is asymmetric .",
    "therefore , deriving energy estimates for the pml that are useful in designing stable and accurate numerical boundary procedures can be very challenging .",
    "linear and/or exponential temporal growth are frequently seen in numerical simulations of pmls @xcite , particularly if higher order methods are considered .",
    "often , artificial numerical dissipations are added to the scheme in order to eliminate these unwanted temporal growth .",
    "artificial numerical dissipations certainly helps in many ways , but can also introduce some interesting , and unfortunately undesirable , effects . in standard computational electromagnetic codes , discrete stability of the numerical method is usually investigated in the absence of the pml . once the interior scheme is confirmed stable , the pml is then included by discretizing the accompanying auxiliary differential equations and appending the auxiliary functions accordingly , without further discrete stability analysis . as in @xcite , any eventual growth seen when the absorption function is present",
    "is then attributed to the pml .",
    "we emphasize that a more complete analysis of discrete stability must include all the equations and variables in the pml . in",
    "bounded and semi  bounded domains the stability of the pml has been analyzed for certain classes of problems and boundary conditions @xcite using normal mode analysis .",
    "these results @xcite are mostly for second order systems . in the continuous",
    "setting , it is possible to extend some of these theoretical results to the pml for first order systems .",
    "however , numerical treatments for first order systems are essentially different from numerical methods for second order systems .",
    "for instance , standard boundary conditions for first order hyperbolic systems can only contain a linear combination of the unknown variables , while boundary conditions for second order systems often involve combinations of the unknown variables and their spatial and temporal derivatives . therefore , for first order systems different numerical techniques and , probably , new theories are required .    in the present paper",
    ", we consider unsplit pmls @xcite and the classical split ",
    "field pml @xcite , for maxwell s equations in first order form with boundary conditions set by an electromagnetic waveguide .",
    "we are particularly interested in high order accurate and efficient methods for numerical simulation of maxwell s equations .",
    "our first objective is to extend the continuous analysis for cauchy problems @xcite to the pml in semi  bounded and bounded domains .",
    "the first sets of results are the proofs of stability of the constant coefficient pml in a lower half  plane and a left half  plane .",
    "the second results in the paper are the derivation of energy estimates for constant coefficients in the laplace space and for variable coefficients pml in the time domain .",
    "we show that a stable numerical boundary procedure for the undamped problem can become unstable when the pml is introduced .",
    "the second objective of the paper is to develop a high order accurate and provably stable numerical approximation for the pml in a bounded domain .",
    "we use summation  by  parts ( sbp ) finite difference operators @xcite to approximate spatial derivatives .",
    "boundary conditions are enforced weakly using a penalty technique , referred to as the simultaneous approximation term ( sat ) methodology @xcite . by mimicking the continuous energy estimates we construct accurate and stable boundary procedures .",
    "the convergence of the numerical method follows .",
    "finally , we present numerical experiments , using sbp finite difference operators in space with interior order of accuracy 2 , 4 and 6 , and the classical fourth order accurate runge  kutta scheme in time .",
    "the numerical examples illustrate high order accuracy and longtime stability of the pml .",
    "note that in @xcite it was pointed out that the discrete pml for maxwell s equations in first order form can suffer severely from longtime exponential energy growth when spatial derivatives are discretized with high order accurate central finite difference operators and and the time derivative discretized using runge  kutta schemes .",
    "this indicates that an appropriate remedy is required .",
    "the results obtained in this paper provide a cure for this problem without any additional cost .",
    "we believe that the results obtained in this paper can be extended to other situations , not only for finite difference electromagnetic codes , but also for finite volume methods , finite element methods and spectral methods , and for more complicated systems such as the elastic wave equation in isotropic media and the linearized euler equation with vanishing mean flow .",
    "the remainder of the paper is planned as follows . in the next section",
    ", we present some preliminaries , introducing maxwell s equations in two space dimensions and a brief description of a discrete approximation of the maxwell s equations in a bounded domain using the sbp - sat methodology . in section 3",
    ", we introduce the pmls and present some instructive numerical experiments , motivating the continuous analysis in section 4 and the discrete analysis in section 5 . in section 5 , we construct discrete approximations for the pml , derive discrete energy estimates and prove asymptotic stability .",
    "more numerical experiments are presented in section 6 , verifying the analysis of previous sections .",
    "a summary of the paper and suggestions for future work are offered in the last section .",
    "here , we introduce the maxwell s equations in a two dimensional rectangular domain .",
    "we end the section with a brief description of the sbp  sat methodology for maxwell s equations .",
    "consider the transverse magnetic @xmath1 case of the maxwell equation in a source free , homogeneous isotropic medium , @xmath2 here , @xmath3 are the magnetic fields and electric fields respectively . at the initial time",
    "@xmath4 we set the smooth initial data @xmath5 consider now the two space dimensional rectangular domain @xmath6 \\times [ -y_0 , y_0]$ ] , with @xmath7",
    ". the length and width of the rectangle are @xmath8 and @xmath9 . at the edges of the rectangle , at @xmath10 and @xmath11 , we set the general boundary conditions , expressed as a relation between the incoming and outgoing characteristics @xmath12 @xmath13 here , the reflection coefficients @xmath14 @xmath15 with @xmath16 , are real constants .",
    "note that the boundary condition , can support boundary waves : waves whose amplitudes are maximum on the boundaries , at @xmath10 , @xmath11 , but decay exponentially into the domain . in particular if @xmath17 , then the boundary conditions , model insulated electromagnetic walls . glancing waves , constant modes normal to the boundaries , can be supported .",
    "if @xmath18 , then the boundary conditions , model perfect electric conductor ( pec ) boundary conditions . and if @xmath19 , then the boundary conditions , correspond to local one dimensional absorbing boundary conditions , which are also equivalent to setting the incoming characteristics ( riemann invariant ) at the boundaries to zero .",
    "note that if @xmath20 then we have @xmath21 @xmath22 the special case of @xmath23 in , corresponds to pec boundary conditions @xmath24 @xmath25 let the standard @xmath26 inner product and the corresponding norm be defined by @xmath27 we also introduce the boundary norms @xmath28 , @xmath29 , defined by @xmath30 here , @xmath31 are the complex conjugates of @xmath32 and @xmath33 depend on one spatial variable @xmath34 or @xmath35 . using the energy method and integration by parts , it is straightforward to show that the maxwell s equation subject to the boundary conditions , , with @xmath36 , satisfies @xmath37 in particular if @xmath38 in , or @xmath18 ( we consider the pec condition ) in , then @xmath39 note that the @xmath26-norm of the solutions ( electric and magnetic fields ) are uniformly bounded in time by the @xmath26-norm of the initial data .",
    "this subsection serves as a brief introduction to the sbp  sat scheme for ibvps ( maxwell s equations in bounded domains ) .",
    "the main idea is to approximate all spatial derivatives in using sbp finite difference operators .",
    "the boundary conditions , are then enforced weakly using penalties .",
    "however , penalty parameters must be chosen such that discrete energy estimates , analogous to the continuous estimates , , can be derived .",
    "thus , proving asymptotic stability for the discretization .",
    "more elaborate discussions on this topic can be found in @xcite , see also the recent review paper @xcite . to begin with ,",
    "consider the uniform discretization of the unit interval with @xmath40 number of grid points and the spatial step , @xmath41 , @xmath42 let @xmath43 denote a differentiation matrix approximating the first derivative , @xmath44 on the grid .",
    "the matrix @xmath43 is an sbp operator ( in one space dimension ) , see @xcite , if the following properties hold @xmath45 here , @xmath46 , @xmath47 pick out the left and right boundary values .",
    "the matrix @xmath48 is symmetric and positive definite , and thus defines a discrete norm .",
    "the matrix @xmath49 is almost skew - symmetric .",
    "it is important to note that sbp operators can be constructed using galerkin finite / spectral element approaches @xcite .",
    "the one space dimensional sbp operator @xmath43 can be extended to higher space dimensions using the kronecker product , @xmath50 , defined by    [ def : section26 ] let a be an m - by - n matrix and b be a p - by - q matrix .",
    "then @xmath51 , the kronecker product of a and b , is the ( mp)-by-(nq ) matrix + @xmath52{4}\\\\ \\hdotsfor[4]{4}\\\\ a_{m1}b&a_{m2}b&\\hdots&a_{mn}b \\end{pmatrix}.\\ ] ]    the following properties hold for kronecker products    1 .",
    "assume that the products ac and bd are well defined then + @xmath53 , 2 .",
    "if a and b are invertible , then @xmath54 , 3 .",
    "@xmath55 .",
    "now consider the maxwell s equation in a two dimensional rectangular domain . to begin",
    ", we discretize the spatial domain in the @xmath56- and @xmath57-directions using @xmath58 grid points with constant spatial steps @xmath59 , respectively .",
    "a two dimensional scalar grid function , @xmath60 $ ] , is stacked as a vector of length @xmath61 , @xmath62 spatial derivatives are discretized using sbp operators , and the boundary conditions , and , are impose weakly using sat @xcite .",
    "the sbp  sat approximation of the maxwell s equation subject the boundary conditions , and , is    [ eq : maxwell_waveguide_discrete ] @xmath63    here , the operators @xmath64 are identity matrices , and @xmath65 are the penalty parameters chosen by requiring stability .",
    "note that the boundary conditions , are enforced weakly by the sat ",
    "terms , @xmath66 and @xmath67 , defined on the right hand side of equation .",
    "this is opposed to strong enforcement of boundary conditions , where boundary conditions are explicitly imposed by injection . by construction",
    "the sbp  sat scheme is a consistent approximation of the ibvp , , and .",
    "the critical aspect of the scheme lies in chosing penalties and ensuring numerical stability . since the ibvp , , , , does not support any temporal growth , it is imperative that penalties parameters must be chosen in a manner that does not allow any growth in time .",
    "the penalty parameters , @xmath65 , are not necessarily unique",
    ". often the choice of stable penalty parameters are guided by constructing discrete energy estimates which , as far as possible , mimic the continuous energy estimates , . in particular , penalty parameters are chosen such that the corresponding discrete boundary terms dissipate energy , at least , as fast as the continuous problem . however , from a practical point of view , for efficient explicit time integration , penalty parameters must also be chosen in order to avoid numerical stiffness .",
    "note that if @xmath68 , then the ordinary differential equation ( ode ) is increasingly stiff . for more elaborate discussions and results on numerical boundary procedure",
    ", please see @xcite .",
    "note that the weak boundary treatment  is often used for high order accurate discontinuous galerkin ( dg ) finite element methods @xcite and also for pseudo spectral methods @xcite .",
    "we will now chose the penalty parameters @xmath65 such that the semi ",
    "discrete approximation  is stable . to begin with",
    ", we define the discrete scalar product and the corresponding discrete norm @xmath69 note that from the sbp property we have @xmath70 thus , using the sbp property we can rewrite the right hand side of to obtain    [ eq : maxwell_waveguide_discrete_sbp ] @xmath71    by applying the energy method to  , that is , we multiply , , from the left with @xmath72 , @xmath73 , @xmath74 , respectively , and add the transpose of the products , we obtain @xmath75 therefore , the discrete approximation  is asymptotically stable if the boundary terms @xmath76 are nonnegative .",
    "if @xmath77 and @xmath78 , then we can choose @xmath79 to obtain @xmath80 where @xmath81 are @xmath82 symmetric matrices and @xmath83 to ensure numerical stability the symmetric matrices @xmath84 defined above must have nonnegative eigenvalues .",
    "the eigenvalues of the matrices @xmath84 are @xmath85 clearly , the eigenvalues are real and nonnegative if @xmath86 by comparing @xmath87 to the continuous analog in the right hand side of we can determine how fast energy is dissipated by the numerical boundary treatment . note that with @xmath88 , the boundary treatment dissipates energy as fast as the continuous problem , and we have @xmath89 thus , implying @xmath90 note that is completely analogous to .",
    "note also that standard finite element and nodal finite volume methods for maxwell s equation are constructed to satisfy analogous discrete equations  and energy estimates and .",
    "if we choose @xmath91 @xmath92 , then the numerical boundary treatment will dissipate energy faster than the continuous problem .    more generally , for any @xmath93 and @xmath94 ,",
    "then we can choose @xmath95 to obtain @xmath96 note that @xmath97 and @xmath98    thus , the discrete solutions of  are uniformly bounded in time by the initial data .",
    "therefore , the discrete approximation  with @xmath99 is also asymptotically stable .",
    "the sbp operators used in the present study are high order accurate finite difference operators with diagonal norms @xmath48 , where the boundary stencils are @xmath100th order accurate and the interior accuracy is @xmath101    as will be seen in the next section , the pml will be placed in the @xmath56-direction .",
    "the primary goal of this paper is to study the numerical difficulties , such as stability and stiffness , arising from the numerical boundary procedure when the pml is introduced .",
    "we will also investigate the optimal penalty parameters for the pml .",
    "the pml will be terminated by the characteristic boundary condition , with @xmath102 .",
    "it is possible though to terminate the pml with the pec boundary condition , with @xmath103 .",
    "however , the characteristic boundary condition at the external boundary have been shown to yield smaller spurious reflections , due to the modeling error , when combined with the pml than the pec backed pml @xcite . in order to closely make comparisons with the results published in the literature @xcite we will impose the characteristic boundary condition , with @xmath104 , in the @xmath57direction .",
    "nevertheless , it is possible though to use the pec boundary condition , with @xmath105 , also in the @xmath57direction .",
    "let us now consider the solutions of the maxwell s equations , in the truncated domain @xmath106 , where @xmath107 are artificial boundaries introduced to limit the computational domain .",
    "in order to absorb outgoing waves at @xmath107 , we have introduced two layers , of width @xmath108 , having @xmath109 in which the pml equations are solved .",
    "note that in the @xmath56-direction the boundary condition is and in the @xmath57-direction the boundary condition is .",
    "this setup can model an infinitely long electromagnetic waveguide truncated by the pml . in this section",
    ", we will derive pml models that truncate the computational domain in the @xmath56direction using two standard approaches , the complex coordinate stretching technique @xcite and berenger s splitting method @xcite .",
    "the two approaches are mathematically analogous but yield two different formulations of the pml , the unsplit pml and split  field pml , respectively .",
    "the difference lies on the choice of variables in the time domain .",
    "as we will see below , by appropriate choice of variables the split - field @xcite can be formulated as the unsplit @xcite .",
    "this shows that the general solutions of the two pml formulations are identical .",
    "let the laplace transform of @xmath110 be defined by @xmath111 in order to derive the pml we assume homogeneous initial data and take the laplace transform of the maxwell s equations in time , having @xmath112 here @xmath113 , with the positive real part @xmath114 , is the dual variable to time .",
    "note that we have tacitly assumed homogeneous initial data",
    ".      a general approach to deriving a pml was introduced in @xcite .",
    "the main idea is to analytically continue the maxwell s equation to a complex spatial coordinate system where all spatially oscillating solutions are turned into exponentially decaying solutions . by using the complex coordinate stretching technique",
    "it is straightforward to construct the pml for many wave equations .",
    "however , in order to localize the pml in time auxiliary variables are often introduced , to avoid explicit convolution operations .",
    "a pml truncating the boundary in the @xmath56direction can be derived by considering the , laplace transformed , maxwell s equation and applying the complex coordinate transformation @xmath115 we have    [ eq : maxwell_laplace_pml_unsplit ] @xmath116    where @xmath117 is a pml complex metric . in this study , we will use the complex metric @xmath118 corresponding to the standard pml model . here",
    ", @xmath119 is a positive real function that vanishes in @xmath120 and @xmath113 is the dual variable to @xmath121 .",
    "more complicated complex metrics can be derived by using a modal ansatz @xcite , constructed to support only spatially decaying modes .",
    "the next step is to invert the laplace transforms in back to the time domain . to do this",
    "we multiply equations  by @xmath117 and introduce the auxiliary variable @xmath122 inverting the laplace transforms yields the time  dependent pml model    [ eq : maxwell_pml_split_2 ] @xmath123    using instead the auxiliary variable @xmath124 and inverting the laplace transform yields the time  dependent pml model    [ eq : maxwell_pml_waveguide ] @xmath125    we can also choose auxiliary variables to obtain the physically motivated pml used in @xcite . to begin , we consider and define the auxiliary variables @xmath126 inverting the laplace transform and omitting the tilde signs ( @xmath127 ) results in the physically motivated unsplit pml of @xcite    [ eq : maxwell_pml_ababarnel ] @xmath128    note that the pml was originally derived using physical arguments @xcite .",
    "there are certainly other ways to choose auxiliary variables , see for example @xcite .",
    "however , all resulting pml models can be shown to be linearly equivalent to  ,  and . since in the laplace space the pml models , , correspond to , a complex change of coordinates , it follows that the equations are perfectly matched to the maxwell s equation by construction @xcite .",
    "berenger s original idea @xcite was to split the electric field and the corresponding equations into two artificial tangential components before special lower order terms that simulate the absorption of waves are added .",
    "that is , consider the maxwell s equation in the laplace space .",
    "introduce the split variables @xmath129 and equations    [ eq : maxwell_laplace_pml_split ] @xmath130    where @xmath119 is a positive real function that vanishes in @xmath120 .",
    "note that equation can be derived by splitting the variables and equations , and then introducing the complex coordinate transformation .",
    "this shows that the two approaches are mathematically analogous .",
    "however , unlike the unsplit pml , the split - field pml introduces the additional degrees of before the pml transformation is introduced . it can be shown that the restriction of the general solution to the pml in @xmath120 coincides with the general solution to the maxwell s equation , see @xcite .",
    "therefore , the pml equation is perfectly matched to the maxwell s equation by construction . by inverting the laplace",
    "transforms in we obtain the time - dependent split - field pml @xcite    [ eq : maxwell_pml_split_1 ] @xmath131    we will show that the split - field pml can be reformulated as the unsplit pml models , . following @xcite , it is possible to re - introduce the electric field @xmath132 in the pml equations while eliminating one of the split variables . by summing , together and using the identity @xmath133 we again",
    "obtain the pml equation .",
    "we can also rewrite the equation in the form .",
    "multiplying equation by @xmath134 and introducing @xmath135 we obtain .",
    "note that in @xcite the berenger s pml and the modal unsplit pml , in the form , gave identical numerical results .",
    "the turning point is in efficient numerical implementation . implementing the split ",
    "field pml also requires the splitting of the electric field in the interior .",
    "the unsplit pml appears as a lower order modification of the maxwell equations and does not require such unphysical splitting of the field variables . in the laplace space , the pml models  ,  ,  and",
    " are mathematically equivalent @xcite .",
    "the difference in the time domain lies on the choice of auxiliary variables . by standard definitions",
    "the physically motivated pml  satisfies the definition of a strongly hyperbolic system . on the order hand , also by standard definitions the modal pmls  ,  and the split ",
    "field pml  are weakly hyperbolic .",
    "it is a bit strange though to say that the strongly hyperbolic system  is equivalent to the weakly hyperbolic problems  , ",
    ", . however , as we will see in the next section , it is possible to rewrite the pmls  ,  ,  as a second order system and derive an energy estimate for the solutions in a certain sobolev norm .",
    "thus , showing well  posedness also for the time ",
    "dependent pml models  ,  , .      in this study , we will investigate discrete stability of three pmls resulting from the modifications of the discrete equations .",
    "the first candidate is an unsplit modal pml recently derived in @xcite and given by .",
    "note that the results obtained for the pml  can be easily extended to the pml model . we will not consider the pml model  in this study .",
    "the second is the so called physically motivated unsplit pml of @xcite defined by  , and",
    "the third candidate is the classical berenger s @xcite split ",
    "field pml . here , the damping function is given by the third degree monomial @xmath136 the damping coefficient is @xmath137 , which allows a relative modeling error of magnitude @xmath138 from the outer boundaries , see @xcite .",
    "note that @xmath139 is a user input parameter .",
    "we will now perform some instructive numerical experiments which are the motivations of the analysis in the coming sections .",
    "we consider a typical test problem as in @xcite with @xmath140 in , and we set @xmath141 , @xmath142 , and the pml width is @xmath143 we discretize the domain with a uniform spatial step @xmath144 .",
    "the pml equations  are discretized straightforwardly .",
    "that is , we replace the spatial derivative in with a finite difference sbp operator and append the discrete auxiliary functions to the discrete equations  , we have    [ eq : maxwell_pml1_waveguide ] @xmath145    note that for the pml model  , the auxiliary differential equation is governed by an ordinary differential equation .",
    "the corresponding discrete pml is    [ eq : maxwell_pml2_waveguide ] @xmath146    the corresponding semi - discretization for the split  field pml ",
    "is    [ eq : maxwell_pml3_waveguide ] @xmath147    the penalty parameters are @xmath148 similarly , as in the continuous case , using the identity @xmath149 we can eliminate the auxiliary variable @xmath150 and rewrite the split ",
    "field pml  exactly as the discrete modal pml . therefore , we expect the pml models  and  to have identical stability properties",
    ". note that when the damping vanishes @xmath151 we can eliminate the auxiliary variables in  ,  and the split variable in  to obtain . since the discrete approximation  of the interior , when @xmath151 , is stable , we hope that the discrete approximations  ,  and",
    " , with @xmath152 , corresponding to the pml are also stable .",
    "we set the smooth initial data @xmath153 for the electric field and use zero initial data for all other variables .",
    "high order accurate sbp operators of interior order of accuracy 2 , 4 , 6 are used to approximate spatial derivatives .",
    "we advance the solutions in time for the three pml models using the classical fourth order accurate runge ",
    "kutta scheme .",
    "the final time is @xmath154 and the time step is @xmath155 .",
    "here , the modeling error is @xmath156 .",
    "the time histories of the discrete @xmath157-norm of the electric field are recorded in figures [ fig : model_standard_ourpml ] , [ fig : model_standard_ababarnel ] and [ fig : model_split_field ] for the discrete pml models ,  and  , repsectively .",
    "clearly , from figures [ fig : model_standard_ourpml ] , [ fig : model_standard_ababarnel ] and [ fig : model_split_field ] , the three discrete pml models  ,  and  are unstable for sbp operators of accuracy 4 and 6 .",
    "note that the numerical solution for higher order accurate schemes are more sensitive to numerical instability . for the chosen simulation duration , @xmath154 ( 12 500 time steps )",
    ", we did not observe any growth for the second order accurate case , see also figures [ fig : model_standard_ourpml ] , [ fig : model_standard_ababarnel ] and [ fig : model_split_field ] .",
    "it is also important to see that the stability behavior of discrete modal pml  and discrete split ",
    "field pml  are identical . however ,",
    "when the absorption function is absent ( @xmath151 ) the solutions , see figure [ fig : model_standard ] , decay throughout the simulation for all orders of accuracy .",
    "this is consistent with the theory , since the numerical scheme ,  , of the interior is provably stable .",
    "note also when @xmath151 , the corresponding ode  is not stiff .",
    "[ h ! ]    as in @xcite , it is possible to argue here that the growth seen for the 4th and 6th order accurate schemes are due to instabilities in the continuous pml models .",
    "however , in @xcite , stability analysis of an ivp corresponding to  was performed in detail .",
    "the result is that the ivp  is asymptotically stable .",
    "we believe that the instability seen here and , probably , some of the growth observed in @xcite are caused by inappropriate numerical boundary treatments in the pml . to investigate further ,",
    "we have also performed numerical experiments with smaller time steps or / and spatial steps . in some cases",
    "mesh refinement or smaller time step eliminates the growth , but in other cases the instabilities persist , but it occurs at much later times .",
    "for instance , using half of the time step , @xmath158 , postpones the initiation of growth until about @xmath159 for the pml models  and  with a 4th order accurate sbp operator . while in all other cases growth was not seen for the entire simulation duration .",
    "these simulations are a strong indication that the growth observed here is a numerical artifact .",
    "in particular , for the discrete physically motivated pml  , figure [ fig : model_standard_ababarnel_2dt02h ] indicates that the growth seen in figure [ fig : model_standard_ababarnel ] is due to numerical stiffness .",
    "thus , the numerical approximation  of the pml may not be suitable for efficient explicit time integration .",
    "these results are also consistent with some of the conclusions drawn in @xcite , which show that growth for pmls depends on both the discretization used and the pml model .    [ h ! ]    in the next section , we will show that the ibvps ,  ,  ,  and  with , are also stable . to enable a systematic development of stable numerical boundary procedures",
    "we will derive continuous energy estimates . in section 5 , by mimicking the continuous energy estimates we will design accurate and stable numerical boundary treatments for the pmls ,  ,  ,  and  , subject to the boundary conditions , .",
    "the analysis in @xcite shows that the constant coefficient cauchy pml problem  is asymptotically stable . since the continuous pml models  ,  ,  and  are equivalent , the results in @xcite for the cauchy problem hold also for the pml models  ,  and . note that the boundary condition extends into the pml .",
    "in addition the pml is terminated in the @xmath56direction by the boundary condition .",
    "the stability analysis of  ,  ,  or ",
    "subject to the boundary conditions and is not as straightforward . here , we prove that the pml  ,  ,  or  with the boundary conditions , is stable .",
    "first , we will use a modal analysis for a constant coefficient pml .",
    "second , we will derive energy estimates for the variable coefficients case .      to perform a modal analysis",
    ", we assume constant coefficients .",
    "we split the pml problem into three : 1 ) a cauchy pml problem with no boundary conditions , 2 ) a lower half  plane pml problem , @xmath160 , with the boundary condition at @xmath161 , and 3 ) a left half - plane pml problem , @xmath162 , with the boundary condition at @xmath163 .",
    "each of the three pml problems above can be analyzed separately .",
    "we note that the lower half  plane pml problem and the left half ",
    "plane pml problem are distinct and must be analyzed severally .",
    "the cauchy problem can be analyzed , as in @xcite , using standard fourier methods .",
    "the analysis in @xcite shows that the constant coefficient cauchy pml problem  ,  ,  or ",
    "is asymptotically stable . as before we have    [ theo : cauchy_problem ] the constant coefficient cauchy pml problem  ,  ,  or  with @xmath164 is asymptotically stable .",
    "consider now the constant coefficient pml ",
    ",  ,  or  in a lower half  plane , @xmath160 , with the boundary condition at @xmath161 .",
    "note that the relevant ansatz is no longer a pure fourier mode , but a simple wave solution on the form @xmath165 in order to prove the stability of the pml  ,  ,  or ",
    "subject to the boundary condition , we will show that the only solution of the form with @xmath166 for any @xmath167 is the trivial solution , @xmath168 . to begin with ,",
    "we introduce the complex number @xmath169 and define the branch cut of @xmath170 by @xmath171 next , we introduce in the pml  ,  ,  or  , and the boundary condition",
    "we can eliminate the magnetic fields and the auxiliary variable , then we obtain a second order ode , @xmath172 subject to the boundary condition @xmath173 or the pec boundary condition @xmath174 consider now @xmath175 , we can construct modal solutions , for , of the form @xmath176 where @xmath177 and @xmath178 are parameters which must not be zero at the same time .",
    "note that it can be shown that @xmath179 for all @xmath180 , see lemma [ lem : duru1 ] in the appendix .",
    "thus , boundedness of the solutions at @xmath181 implies @xmath182 .",
    "the parameter @xmath183 is determined by the boundary condition .",
    "introducing in we obtain @xmath184 since @xmath185 , we have nontrivial solutions only if @xmath186 the following lemma characterizes the roots of the dispersion relation .",
    "[ lem : lower_half_plane ] consider the dispersion relation @xmath187 defined in with @xmath188 the equation @xmath189 has no solution for all @xmath190 , @xmath191 and @xmath192    consider first @xmath151 , we have @xmath193 , with the solution @xmath194 . note that since the maxwell s equation subject to the boundary conditions satisfy the energy estimate we must have @xmath195 , for all @xmath196 .",
    "otherwise if @xmath197 , then the energy will grow for some solutions , which is in contradiction with the energy estimate . by inspection ,",
    "the zero root @xmath198 is also not a solution of @xmath199 if @xmath167 , then the equation @xmath189 has the solution @xmath200 therefore , any @xmath167 will move all roots @xmath113 further into the stable complex plane .    by lemma [ lem : lower_half_plane ]",
    "we must have @xmath201 for all @xmath167 , @xmath202 .",
    "this also implies that @xmath203 in for all @xmath204 .",
    "therefore , the trivial solution is the only possible solution of  with or  with , of the form with @xmath205 .",
    "consider now the pec boundary condition and substitute , with @xmath206 , we have @xmath207 thus the pec boundary condition supports only trivial solutions , @xmath208 .",
    "consider now the constant coefficient pml  ,  ,  or  in the left half ",
    "plane , @xmath210 @xmath211 , with the boundary condition at @xmath212 .",
    "we make the ansatz @xmath213 in order to prove the stability of the pml ,  ,  ,  or ",
    ", subject to the boundary condition , we will show that there are no nontrivial solutions on the form with @xmath214 for any @xmath152 .",
    "we insert in  ,  ,  or  and in the boundary condition . as",
    "before , we eliminate the magnetic fields and the auxiliary variable to obtain a second order ordinary differential equation , @xmath215 subject to the boundary conditions @xmath216 or the pec boundary condition @xmath217 consider now @xmath175 , we can construct modal solutions , for , on the form @xmath218 where @xmath219 and @xmath178 are parameters which must not be zero at the same time .",
    "note that it can be shown that @xmath179 for all @xmath180 , see lemma [ lem : duru2 ] in the appendix .",
    "thus , boundedness of the solution at @xmath220 implies @xmath182 .",
    "the parameter @xmath183 is determined by the boundary condition .",
    "introducing in we obtain @xmath221 since @xmath185 , we have nontrivial solutions only if @xmath222 it is particularly important to note that the dispersion relation @xmath223 , defined by , is independent of the pml parameter @xmath164 .",
    "the dispersion relation corresponds to that of the undamped problem , and it is not perturbed by the pml .",
    "this is unlike the dispersion relation , @xmath224 for the lower half  plane pml problem , which depends on the pml parameter @xmath164 . since",
    ", the maxwell s equation subject to the boundary conditions and satisfy the energy estimate , the following lemma characterizing the roots of the dispersion relation holds    [ lem : left_half_plane ] consider the dispersion relation @xmath223 defined in with @xmath225 .",
    "the equation @xmath226 has no solution @xmath113 for all @xmath190 and @xmath227 .    since the maxwell s equation with the boundary condition at @xmath163 satisfy the energy estimate we must have @xmath228 , for all @xmath227",
    "otherwise if @xmath229 , then the energy will grow for some solutions , which is also in contradiction with the energy estimate . again by inspection , the zero root @xmath230 is not a solution of @xmath231 note that if @xmath232 we have @xmath233 .",
    "next , we consider the case @xmath234 , @xmath235 , and introduce @xmath236 @xmath237 if @xmath238 , then we have @xmath239 since the square root can never be negative . if @xmath240 , then we also have @xmath239 since the square root is zero or purely imaginary .",
    "therefore , we must have @xmath241 , for all @xmath227 .",
    "this completes the proof of the lemma .    as before , for @xmath205",
    "the trivial solution is the only possible solution of  with or  with , on the form .",
    "consider now the pec boundary condition and substitute , with @xmath206 , we have @xmath207 the pec boundary condition also supports only trivial solutions , @xmath208 . by theorem [ theo :",
    "cauchy_problem ] , and lemmas [ lem : lower_half_plane ] and [ lem : left_half_plane ] , it then follows that all non  trivial modes in the pml decay .",
    "the difficulty lies in constructing accurate and stable numerical approximations for the pml ,  ,  ,  or ",
    "subject to the boundary conditions and , and ensuring numerical stability .",
    "consider now the constant coefficient pml  ,  ,  or  in the rectangular domain , @xmath242 , and the boundary conditions , .",
    "we will prove that the corresponding constant coefficient ibvp can not support growing modes .",
    "to begin , we assume homogeneous initial data and take the laplace transform of the pml equations and boundary conditions in time . we can eliminate the magnetic fields and all the auxiliary variables , we have @xmath243 subject to the boundary conditions @xmath244 @xmath245 or @xmath246 @xmath247 we define the quantity @xmath248 for the pec boundary conditions , , the boundary terms vanish and we have @xmath249 note that @xmath250 , see lemma [ lem : duru3 ] in the appendix .",
    "therefore , @xmath251 and @xmath252 are energies .",
    "note also that for @xmath253 , @xmath254 we have @xmath255 and @xmath256 we can now prove the theorem :    [ theorem : wellposedness_laplace ] for any @xmath113 , with @xmath257 , and @xmath258 all solutions @xmath259 of the constant coefficient pml in the rectangular domain , with the boundary conditions , or , must satisfy @xmath260    multiply equation from the left by @xmath261 , and integrate over the whole domain , we have @xmath262 integrating by parts and using the boundary conditions , obtaining @xmath263 we add the complex conjugates of the products in to obtain @xmath264 note that in particular if the pec boundary conditions , are imposed , the boundary terms vanish and @xmath265 thus , for @xmath114 no nontrivial solutions @xmath259 can be supported by the pml .      to enable the development of a systematic and rigorous stable numerical boundary procedure for the time ",
    "dependent pml we will derive energy estimates for the variable coefficient pml .",
    "the importance of the energy estimates are twofold : the first is that the energy estimates establish the well  posedness of the variable coefficients pmls .",
    "the second is that by mimicking the energy estimates we can construct high order accurate , stable and convergent discrete approximations of the pml in a bounded domain .",
    "the first step is to rewrite the pml  and the boundary conditions , as a second order system . differentiating equation with respect to time and using equations  to eliminate the time ",
    "derivatives on the right hand side , we obtain    [ eq : maxwell_pml_waveguide_2nd2 ] @xmath266    the corresponding boundary conditions are @xmath267 @xmath268 or @xmath269 @xmath270 here , the length and width of the computational domain are @xmath8 and @xmath9 , respectively . to derive an energy estimate we introduce the relevant energy norms @xmath271 and @xmath272 note that away from the boundaries , the energy norm is analogous to the norms derived in @xcite .",
    "the difference between and @xcite is that the energy norm introduced here contains also boundary norms , @xmath273 , @xmath274 .",
    "note also that @xmath275 , @xmath276 , if and only if @xmath277 when the damping vanishes , @xmath151 , we have the physical energy norms @xmath278 and @xmath279 let us define the spaces of real functions @xmath280 @xmath281 and @xmath282 the space of square integrable real functions .",
    "it can be shown that @xmath283 and @xmath284 we can now prove the theorem , see appendix [ proof : wellposedness ] :    [ theorem : wellposedness ] all solutions of the perfectly matched layer  or ( [ eq : maxwell_pml_waveguide_2nd])([eq : maxwell_pml_waveguide_y ] ) subject to the boundary conditions ( [ eq : wall_bc_y1 ] ) at @xmath11 and ( [ eq : wall_bc_x1 ] ) at @xmath285 , or ( [ eq : wall_bc_y1_pec ] ) at @xmath11 and ( [ eq : wall_bc_x1_pec ] ) at @xmath285 satisfies the energy estimate @xmath286 where @xmath287    it is particularly noteworthy that the pml models  and  can be rewritten directly in the time domain as . therefore , theorem [ theorem : wellposedness ] holds also for the solutions of  and .    in the next section , by mimicking the continuous energy estimate , we will develop stable numerical boundary procedures for the pml models  ,  and  , subject to the boundary conditions ( [ eq : wall_bc_y1 ] ) at @xmath11 and ( [ eq : wall_bc_x1 ] ) at @xmath288 .      the physically motivated pml model  , satisfies the definition of a strongly hyperbolic system . by applying the energy method directly to the pml ,  , subject to the boundary conditions , , with @xmath36",
    ", we have @xmath289 in particular if @xmath38 in , or @xmath18 ( we consider the pec condition ) in , then @xmath290 note that all terms , excepting @xmath291 , in the right hand sides of , are dissipative .",
    "we denote the energy by @xmath292 and @xmath293 if @xmath38 in , or @xmath18 ( we consider the pec condition ) in .",
    "we have    [ theorem : wellposedness_physical ] the solutions of the perfectly matched layer ",
    "subject to the boundary conditions , with @xmath294 or @xmath295 satisfy the energy estimate @xmath296 where @xmath287",
    "the main focus of this section is to design accurate , stable and efficient numerical boundary procedures for the pmls ,  , , and  , subject to the boundary conditions , .",
    "we will use sbp finite difference operators , see @xcite , to approximate the spatial derivatives and impose boundary conditions weakly using penalties @xcite . to ensure numerical stability",
    "we will impose boundary conditions in a manner which allows a derivation of discrete energy estimates analogous to the continuous energy estimate ( [ eq : energyestimate_continuous ] ) .",
    "for the physically motivated pml model  , an efficient numerical boundary treatment is achieved by using characteristics and reducing the strength of the penalty parameters .",
    "finally , we will show that the corresponding discrete models do not support growing modes .      in standard numerical methods @xcite , once the interior scheme is proven stable the discrete pml",
    "is obtained by discretizing the auxiliary differential equations and appending the auxiliary functions accordingly .",
    "usually no more attention is placed on how the boundary conditions are implemented in the pml .",
    "note that numerical experiments presented in section 3 and the next section show that a straightforward enforcement of the boundary conditions , and , can lead to unstable solutions in the pml . a stable discrete approximation for the modal pml",
    "can be obtained by extending the enforcement of the boundary condition to the auxiliary differential equation , having    [ eq : maxwell_pml1_waveguide_stable_0 ] @xmath297    note that we have included the term involving @xmath298 . the standard choice @xmath299 , which corresponds to ",
    ", is obtained by simply replacing spatial derivatives with difference operators in the pml .",
    "the other choice , @xmath300 , extends weak enforcements of the boundary conditions , in the @xmath57-direction , to the auxiliary differential equation .",
    "it is particularly important to note that this extension , with @xmath300 , does not destroy the accuracy of the scheme . when @xmath151 , the auxiliary variable @xmath301 also vanishes , and the discrete approximation  , for any value of @xmath298 ,",
    "correspond to the stable discrete approximation . however , as we will see later , when @xmath167 the particular choice @xmath302 ensures numerical stability .",
    "to be able to simplify the analysis and also make comparisons with results published in the literature , we will focus on the setup considered in section [ sect : num_example ] and @xcite .",
    "therefore , we set @xmath140 and the penalty parameters @xmath303 having    [ eq : maxwell_pml1_waveguide_stable ] @xmath304      we will derive a discrete energy estimate analogous to the continuous energy estimate ( [ eq : energyestimate_continuous ] ) .",
    "first and foremost , we rewrite  as a second order system .",
    "differentiate equation in time , and use equations  to eliminate the time derivatives in the right hand side .",
    "we have    [ eq : maxwell_pml1_waveguide_stable_step1 ] @xmath305    subsequently , by using the sbp property we eliminate some of the sat terms and obtain    [ eq : maxwell_pml_waveguide_discrete_first ] @xmath306    introduce the discrete energy @xmath307 when @xmath151 we have the standard discrete energy @xmath308 we can also prove the following , see appendix [ proof : discrete_stability ] .    [",
    "theorem : discrete_stability ] consider the discrete approximation  or  of the the perfectly matched layer ",
    "subject to the boundary conditions ( [ eq : wall_bc_y1 ] ) at @xmath11 and ( [ eq : wall_bc_x1 ] ) at @xmath285 .",
    "if @xmath302 , then the quantity @xmath309 defined in is an energy and the solutions of the discrete system  or  satisfy the energy estimate @xmath310    note that when @xmath151 we have a strict energy estimate @xmath311 for any values of @xmath298 . however , for @xmath152 , if @xmath312 we are unable to derive a discrete energy estimate for the discrete pml . in standard numerical codes , as shown in section 3 , once the interior scheme is proven stable , the pml is then added as lower order modification , leading to the standard choice @xmath299 .",
    "if @xmath313 , then there is a non - vanishing boundary term , @xmath314 the boundary term will probably diminish with mesh refinement , @xmath315 .",
    "however , on a realistic mesh the boundary term may be nontrivial .",
    "the energy estimate above does not exclude the possibility of exponentially growing solutions for @xmath167 .",
    "however , the estimate can be extended to the error equations to proof convergence of the solutions of the discrete approximation  or  for any finite time interval @xmath316 $ ] .",
    "below , we will prove that at constant coefficients the semi ",
    "discrete pml problem  or  can not support exponentially growing solutions .",
    "consider now the semi  discrete system  and take the laplace transform in time , we have    [ eq : maxwell_pml_waveguide_discrete_first_laplace ] @xmath317    here , @xmath113 with @xmath114 , is the dual variable to time . note that in we have also used the sbp properties and to eliminate some of the sat terms",
    ". we can also eliminate the magnetic fields in using , and obtain @xmath318 where @xmath319 .",
    "we define the discrete quantity @xmath320 note that it can be shown that @xmath321 see lemma [ lem : duru3 ] in the appendix . therefore , if @xmath322 then @xmath323 is an energy .",
    "we can now prove the following result establishing the stability of the discretization .",
    "[ theo : asymptotic_stability ] consider the constant coefficient semi ",
    "discrete pml with @xmath114 , @xmath152 and @xmath302 .",
    "all solutions of satisfy the energy equation @xmath324    multiply equation from the left by @xmath325 and add the complex conjugate of the product we have @xmath326 on the left hand side of we recognize the energy @xmath327 . on the right hand side , if @xmath302 , then all the expressions vanish , yielding @xmath328 the proof of the theorem is complete .    by theorem",
    "no nontrivial solution of the discrete problem can grow exponentially for all @xmath152 and @xmath329 however , for @xmath152 and @xmath313 there are indefinite non  vanishing boundary terms . as we saw in the previous experiments these terms can ruin the accuracy of numerical solutions .      here ,",
    "we develop a stable numerical method for the split ",
    "field pml . since the split ",
    "field pml can be rewritten as the modal unsplit  , our task is made simpler .",
    "we will design a numerical method for such that the corresponding discrete problem can be rewritten as the stable discrete modal pml with @xmath302",
    ". we can then apply theorem [ theorem : discrete_stability ] and theorem [ theo : asymptotic_stability ] to prove the stability of the discretization .",
    "the corresponding stable semi - discretization for the split ",
    "field pml  is    [ eq : maxwell_stablesplitfieldpml ] @xmath330    note that we have moved the sat - term @xmath67 to the last equation .",
    "this is important since we can rewrite the discrete approximation as the stable discrete unsplit pml with @xmath302 .",
    "similarly , as in the continuous case , using the identity @xmath149 we can eliminate the split variable @xmath150 , obtaining    [ eq : maxwell_stablesplitfieldpml_modal ] @xmath331    note that equation above corresponds to discretizing the unsplit pml . now multiply equation by @xmath332 and introduce @xmath333",
    ", we obtain exactly the stable discrete unsplit pml with @xmath302",
    ". we can now apply theorem [ theorem : discrete_stability ] and theorem [ theo : asymptotic_stability ] to prove the temporal stability of the discretizations and .",
    "these results are clearly demonstrated by the numerical experiments performed in the next section .",
    "now , we turn our attention to the physically motivated pml model . we know that the principal part of this pml is symmetric hyperbolic .",
    "the lower order terms appear in the pml in a nontrivial way . as was shown in @xcite ( and we have already seen in section [ sect : num_example ] )",
    ", the pml terms can pose a numerical challenge .",
    "however , we will show that using the sbp  sat scheme proposed in section [ sec : sbp_sat ] , we can choose penalties such that any stable numerical boundary procedure for the undamped problem ( with @xmath334 ) satisfying an energy estimate also leads to a discrete energy estimate , analogous to continuous estimate , for the discrete pml . however , the continuous energy for the pml and the corresponding discrete energy for the discrete pml can grow exponentially in time . by theorem , we also know the constant coefficient pml model  subject to the boundary conditions ( [ eq : wall_bc_y_0 ] ) , ( [ eq : wall_bc_x ] ) can not support exponentially growing solutions . therefore , at constant coefficients , for a particular set of penalty parameters , we will show that the solutions for the discrete pml can not grow exponentially in time .    to begin , consider the discrete pml .",
    "by applying the energy method directly to  , we have @xmath335 the boundary terms @xmath76 are exactly the same as the boundary terms derived for the undamped problem in section [ sec : sbp_sat ] .",
    "as before , if @xmath77 and @xmath78 , then we can choose @xmath79 and @xmath336 we have @xmath337 . also , for any @xmath93 and @xmath94 , then we can choose @xmath95 obtaining @xmath337 .",
    "note that all terms in the right hand side of , excepting @xmath338 , are dissipative . introducing the discrete energy @xmath339 we have    [ theorem : discrete_stability2 ]",
    "consider the discrete approximation for the physically motivated pml ",
    "subject to the boundary conditions ( [ eq : wall_bc_y_0 ] ) at @xmath11 and ( [ eq : wall_bc_x ] ) at @xmath340 . for    * @xmath77 and @xmath78 , and @xmath79 with @xmath336 or * @xmath93 and @xmath94 , and @xmath341    then @xmath337 and the quantity @xmath342 defined in is an energy . for these sets of penalty parameters",
    "the solutions of the discrete pml problem satisfy the energy estimate @xmath343    by , the discrete energy can grow exponentially in time .",
    "however , the modal analysis presented in section [ section : modal_analysis ] shows that the continuous pml problem  subject to the boundary conditions ( [ eq : wall_bc_y ] ) at @xmath11 and ( [ eq : wall_bc_x ] ) at @xmath340 does not support temporally growing modes .",
    "therefore , in the discrete setting , it will be more desirable to design numerical methods that ensure that all eigenvalues of the discrete spatial operator satisfy @xmath344 for any @xmath345 .",
    "this has the potential to eliminate any nonphysical temporal growth . at constant coefficients",
    "we will show that the corresponding discretization used in section [ sect : num_example ] can not allow growing modes      consider the discrete approximation with @xmath140 and @xmath346 we have    [ eq : maxwell_pml2_waveguide_stable ] @xmath347    after laplace transformation of in time , we can eliminate the auxiliary variable and the magnetic fields obtaining @xmath348 where @xmath319 and @xmath114 . as in , note",
    "also that we have used the sbp property to eliminate some of the sat boundary terms .",
    "we define the corresponding discrete energy @xmath349 note that by lemma [ lem : duru3 ] in the appendix , we have @xmath350 therefore , @xmath351 is an energy",
    ". we can now prove the following result establishing the stability of the discretization .",
    "[ theo : asymptotic_stability_abarbanel ] consider the constant coefficient semi ",
    "discrete pml with @xmath114 , @xmath152 .",
    "all solutions of satisfy the energy equation @xmath352    the proof of theorem [ theo : asymptotic_stability_abarbanel ] is completely analogous to the proof of theorem [ theo : asymptotic_stability ] .",
    "we therefore omit it here .",
    "note that theorem [ theo : asymptotic_stability_abarbanel ] shows that the discrete pml problem can not have eigenvalues with positive real parts .",
    "however , for efficient explicit time integration we do not only need the temporal eigenvalues to have non positive real parts , the spectral radius , @xmath353 , must also be sufficiently small .",
    "note that in section [ sect : num_example ] , the penalty parameters @xmath354 when combined with the physically motivated pml yielded unstable solutions for the time step @xmath355 .",
    "however , when we reduced the time step to @xmath158 the numerical solutions are stable .",
    "this shows that the above penalty parameters for the physically motivated pml is not adequate for efficient explicit time integration .",
    "it is possible though to construct stable boundary procedures which will not restrict the time step further when the pml is introduced . for the physically motivated pml we propose to use the stable penalty parameters , @xmath356 note that the maximum weights of these penalty parameters are smaller . for many choices of boundary parameters @xmath357 , this has the potential to reduce numerical stiffness in the discrete pml .",
    "numerical experiments performed in the next section confirm this .",
    "in this section , we present some numerical tests to verify the analysis of previous sections . in particular , we will investigate temporal stability of the discrete pmls ,  , ",
    ",  , and also evaluate the accuracy of the pml , in an electromagnetic waveguide . to begin with , we will repeat the experiments of section 3 .",
    "we consider exactly the same setup as in section 3 .",
    "also , the same discretization parameters , time step @xmath155 , absorption function and damping coefficient are used .",
    "we run the simulations now for a very long time , until @xmath358 ( 125 000 time steps ) , using the discrete pmls ,  with @xmath302 ,  with @xmath359 and  , respectively .",
    "the time histories of the @xmath157-norm of the solutions are recorded in figures [ fig : model1_stable][fig : model3_stable ] for the discrete pmls  ,  and  , respectively .",
    "clearly , the solutions decay with time throughout the simulation .",
    "this verifies the analysis of sections 4 and 5 .",
    "the numerical growth seen in section 3 are due to inappropriate boundary treatments in the pml .",
    "we also believe that some of the growth seen in @xcite are probably caused by numerical enforcements of boundary conditions .",
    "it is noteworthy that the behaviors of the discrete pmls ,  and  , are completely analogous .    [ h ! ]    we have also performed numerous numerical experiments with different boundary parameters , @xmath360 and penalty parameters @xmath361 .",
    "unfortunately , because of space , we can not report all of them here .",
    "it is particularly important to note that applying the penalty @xmath359 to the discrete modal pml ",
    ", with @xmath299 , yields unstable solutions .",
    "numerical growth was also observed when the stable boundary treatment used in  was applied to the physically motivated pml  without decreasing the time step further .",
    "this indicates that each pml model must be treated individually . a stable and efficient numerical boundary treatment for a particular pml model may not necessarily yield stable and efficient numerical scheme for another pml modeling the same physical phenomena .",
    "of course , when the underlying physical model changes , the corresponding pml model will also change . we will also expect different stable numerical boundary treatments . in the next section",
    ", we will verify the stability and accuracy of the pml in an electromagnetic waveguide .      here",
    ", we will focus on the discrete pml . the results obtained for the discrete pmls ,  and  , are analogous , and will not be presented .",
    "consider the rectangular semi ",
    "infinite electromagnetic waveguide @xmath362 , @xmath363 . at the upper wall , @xmath364 of the waveguide ,",
    "the boundary condition is a magnetic source @xmath365 , where @xmath366 and @xmath367 at the lower wall , @xmath368 the boundary condition is homogeneous @xmath369 . at the left wall , @xmath370 , we impose the characteristic boundary condition @xmath371 . in order to perform numerical simulations ,",
    "we truncate the right boundary at @xmath372 with a pml of width @xmath373 .",
    "we terminate the pml at @xmath374 with the characteristic boundary condition @xmath375 .",
    "homogeneous initial conditions @xmath376 are used for all variables .",
    "we also use the cubic monomial damping profile @xmath377 with the damping coefficient @xmath378 , where the factor @xmath379 is empirically determined and @xmath380 is the spatial step .",
    "we approximate all spatial derivatives using sbp operators with interior order of accuracy 2 , 4 , 6 .",
    "boundary conditions are imposed weakly using penalties .",
    "as before , we discretize in time using the classical 4th order accurate runge ",
    "kutta method .      in the first sets of experiments we investigate discrete stability .",
    "consider sbp finite difference operators of order of accuracy 2 , 4 , 6 , respectively .",
    "we use the spatial step @xmath381 and the time step @xmath355 , and evolve the solutions until @xmath382 ( 250 000 time steps ) with @xmath383 , respectively , in .",
    "note that here the domain , spatial and time steps are much smaller than the ones used in the previous sections .",
    "the snapshots of the solutions at @xmath384 are shown in figure [ fig : slution_t300 ] , for the 4th order accurate sbp operator .",
    "note that initially the two solutions , using @xmath383 , are similar . for the standard choice",
    ", @xmath299 , the solution in the pml starts growing after a longtime , just before @xmath385 , and spreads into the computational domain as time passes . at @xmath384 , growth in the pml",
    "has already corrupted the solutions everywhere .",
    "the 2nd and 6th order accurate operators with @xmath299 are also unstable , but with slower growth rates . on the other hand , for @xmath386 the solutions decay throughout the simulation for all sbp operators .",
    "it is important to remark that the observed growth is due to the unstable boundary treatments in the pml .",
    "the conclusion here is that a numerical method which is stable in the absence of the pml , when @xmath151 , can result in an unstable scheme when , @xmath167 , the pml is included .",
    "it is possible though to design stable numerical methods which can be proven stable for all @xmath387 here , numerical stability for the discrete pml  was achieved by using @xmath302 in equation without any additional cost or difficulty .",
    "next , we evaluate the accuracy of the pml .",
    "we set @xmath302 and compute the solutions for various resolutions using sbp operators of interior order of accuracy 2 , 4 and 6 , until the final time , @xmath388 the snapshots of the solutions at @xmath389 are displayed in figure [ fig : maxwell_solutions_waveguide ] , showing the evolution of the electric field on the boundary , the propagation and reflection of waves in the waveguide , and the absorption of waves by the pml .",
    "the errors introduced when a pml is used in computations can be divided into two different categories : numerical reflections and the modeling error .",
    "numerical reflections are discrete effects introduced by discretizing the pml and seen inside the computational domain . the modeling error is introduced because the layer and the magnitude of damping coefficient are finite .",
    "numerical reflections should converge to zero as the mesh is refined .",
    "note that the modeling error is not caused by numerical approximations , and thus is independent of the numerical method used .",
    "the modeling error is expected to decrease as the pml width or the magnitude of damping coefficient increases . for sufficiently small mesh",
    "sizes numerical reflections are infinitesimally small and the modeling error dominates the total pml error . in order to measure numerical errors , we also computed a reference solution in a larger domain without the pml . by comparing the reference solutions to the pml solutions in the interior , measured in the maximum norm ,",
    "we obtain accurate measure of total pml errors .",
    "the numerical errors at @xmath390 are displayed in table [ tab : error_pml_waveguide ] , and the time history of the error are shown in figure [ fig : pmlerror_waveguide ] .",
    "note that the errors converge to zero exponentially . because we have used exactly the same damping strength , @xmath391 , for the 2nd",
    ", 4th and 6th order accurate schemes we expect to have the same modeling error independent of the accuracy of the scheme used .",
    "it is also important to note that for small mesh  sizes the modeling error dominates and",
    "the behavior of the total pml error does not depend on the order of accuracy of the scheme .",
    ".total pml errors and the convergence of the error in a waveguide using sbp operators of interior order 2 , 4 , 6 for different grid resolutions . [ cols=\"^,^,^,^,^,^,^,^ \" , ]     [ h ! ]",
    "in this paper , we have studied the ( long time ) temporal energy growth associated with numerical approximations of the pml in bounded domains .",
    "three different unsplit pml models and the classical split ",
    "field pml model are considered .",
    "we proved the stability of the constant coefficient ibvp for the pml .",
    "we also derived energy estimates for the constant coefficient ibvp in the laplace space and for variable coefficients pml in the time domain domain .",
    "thus , establishing well  posedness and stability of the ibvp corresponding to the pml .",
    "we have demonstrated in theory and numerical experiments that a numerical method which is stable in the absence of the pml can become unstable when the pml is introduced . here , the discrete stability of the pml depends only on the numerical implementation of boundary conditions ; the interior approximations do not play any roles .",
    "we developed high order accurate and stable numerical approximation using sbp finite difference operators to approximate spatial derivatives and weak enforcement of boundary conditions using penalties . by constructing analogous discrete energy estimates",
    "we obtain a bound on the energy growth of the solution at any future time .",
    "further , we showed that the corresponding constant coefficient pml problem can not support temporally growing solution .",
    "we presented numerical experiments demonstrating high order accuracy and longtime stability of the pml .",
    "we note that a stable numerical boundary treatment for a particular pml model may not necessarily yield stable numerical solutions for another pml modeling the same physical phenomena . when the underlying physical model changes , the corresponding pml model will be different .",
    "we also expect different stable numerical boundary treatments .",
    "although the analysis here focuses on the maxwell s equations the results obtained can be straightforwardly applied to equations of acoustics .",
    "we are currently extending the techniques described in this paper to other numerical methods such as finite element methods , spectral element methods , dg finite element / volume methods and mixed spectral - finite element methods .",
    "however , these require substantially more details and analysis .",
    "our preliminary results are quite promising and will be reported in another paper @xcite .",
    "it will be interesting to compare the results obtained from a dg method to the results obtained in this paper using high order finite difference sbp operators .",
    "introduce the complex number @xmath392 and define the branch cut of @xmath170 by @xmath393 the following lemma was adapted from lemma 6 in @xcite .    [",
    "lem : heinz_anders ] let @xmath394 be a real number and let @xmath395 be a complex number where @xmath396 . consider the relation @xmath397 there are positive real numbers @xmath398 , @xmath399 such that @xmath400 , @xmath401 .",
    "we can also prove the following lemma    [ lem : duru1 ] let @xmath152 , @xmath394 be real numbers and let @xmath395 be a complex number where @xmath396 .",
    "consider the relation @xmath402 there are positive real numbers @xmath403 , @xmath404 such that @xmath405    consider @xmath406    [ lem : duru2 ] let @xmath152 , @xmath394 be real numbers and let @xmath395 be a complex number where @xmath396 .",
    "consider the relation @xmath397 there are positive real numbers @xmath403 , @xmath404 such that @xmath407    consider @xmath408    [ lem : duru3 ] let @xmath152 , be a nonnegative real number and @xmath395 a complex number where @xmath396 .",
    "consider the relations @xmath409 we have @xmath410    consider @xmath411 note that @xmath412 thus , we have @xmath413 consider now @xmath414 the proof of the lemma is complete .",
    "multiply equation ( [ eq : maxwell_pml_waveguide_2nd ] ) by @xmath415 and integrate over the whole domain .",
    "integration by parts yields @xmath416 imposing the boundary conditions ( [ eq : wall_bc_y1 ] ) at @xmath11 and ( [ eq : wall_bc_x1 ] ) at @xmath340 , we arrive at @xmath417 by adding @xmath418 to both sides of equation ( [ eq : energyestimate_first_continuous ] ) we have @xmath419 by using and in the right hand side of ( [ eq : energyestimate_second_continuous ] ) , we obtain @xmath420 where the energy @xmath421 is define in .",
    "note that if the boundary conditions are ( [ eq : wall_bc_y1_pec ] ) at @xmath11 and ( [ eq : wall_bc_x1_pec ] ) at @xmath288 , from we have @xmath422 thus , cauchy  schwartz inequality and the facts @xmath423 , @xmath424 , @xmath425 , @xmath426 , @xmath427 and @xmath428 , @xmath429 , @xmath430 , @xmath431 , @xmath427 lead to @xmath432 the proof of the theorem is complete .",
    "multiplying equation with @xmath435 from the left , we have @xmath436 by adding @xmath437 to both sides of equation ( [ eq : discrete_estimate_1 ] ) we have @xmath438 where the energy @xmath439 is defined in . eliminating the time derivatives on the right hand side of using  , we obtain @xmath440 as before , cauchy  schwartz inequality and the facts @xmath441 @xmath442 lead to @xmath443 @xmath444    99 s. abarbanel , d. gottlieb , on the construction and analysis of absorbing layers in cem , appl .",
    ", 27 ( 1998 ) , 331340 . s. abarbanel , h. qasimov , s. tsynkov , long - time performance of unsplit pmls with explicit second order schemes , j. sci .",
    ", 41 ( 2009 ) , 112 . s. abarbanel , d. gottlieb , j. s. hesthaven , long time behaviour of the perfectly matched layer equations in computational electromagnetics , j. sci .",
    "17 ( 2002 ) , 14 . s. abarbanel and d. gottlieb , a mathematical analysis of the pml method , j. comput . phys . , 134 ( 1997 ) , 357363 .",
    "s. abarbanel and a. chertock , strict stability of high - order compact implicit finite - difference schemes : the role of boundary conditions for for hyperbolic pdes , i , j. comput .",
    "158 , 125 ( 2000 ) .",
    "s. abarbanel , a. chertock and a. yefet , strict stability of high - order compact implicit finite - difference schemes : the role of boundary conditions for for hyperbolic pdes , ii , j. comput .",
    "160 , 6787 ( 2000 ) .",
    "e. abenius , f , edelvik and c. johansson , waveguide truncation using upml in the finite - element time - domain method , tech .",
    "report , department of information technology , uppsala university , issn 14043203 ; 200506 , ( 2005 ) . t. g. amler , k. duru and i. hoteit , stable dg finite element / volume schemes for the perfectly matched layer for maxwell s equation , in preparation , ( 2014 )            j .- p .",
    "brenger , numerical reflection from fdtd - pmls : a comparison of the split pml with the unsplit and cfs pmls , ieee trans on antennas and propag . , 50 ( 2003 ) , 258265 . j .-",
    "brenger , a perfectly matched layer for the absorption of electromagnetic waves , j. comput .",
    "( 114 ) 1994 , 185200 .",
    "m. h. carpenter , d. gottlieb , s. abarbanel , time - stable boundary conditions for finite - difference schemes solving hyperbolic systems : methodology and application to high - order compact schemes , j. comput .",
    ", 111 ( 1994 ) , 220236 .",
    "w. chew and w. weedon , a 3-d perfectly matched medium from modified maxwell s equations with stretched coordinates , micro .",
    "lett . , 7 ( 1994 ) , 599604",
    ". k. duru , a perfectly matched layer for the time ",
    "dependent wave equation in heterogeneous and layered media , j. comput .",
    ", * 257 * : 757 - 781 , ( 2014 ) .",
    "k. duru , g. kreiss , boundary waves and the stability of perfectly matched layer i , in proceedings of num . and",
    "math . aspects of waves ( 2013 ) .",
    "s. d. gedney , an anisotropic perfectly matched layer absorbing media for the truncation of fdtd latices , ieee trans . on antennas and propag . , 44 ( 1996 ) , 16301639 . b. gustafsson , high order difference methods for time dependent pde , springer ",
    "verlag , berlin heidelberg , 2008 .",
    "b. gustafsson , on the implementation of boundary conditions for method of lines , bit numer math 38 ( 1998 ) , 293314 .",
    "k. o. friedrichs , symmetric hyperbolic linear differential equations , comm .",
    "pure appl .",
    ", 7 ( 1954 ) , 345392 .",
    "t. hagstrom , new results on absorbing layers and radiation boundary conditions , topics in comput .",
    "wave propag .",
    "notes comput .",
    "( 2003 ) , 142 .",
    "l. halpern , s. petit - bergez , j. rauch , the analysis of matched layers , conflu .",
    "3(2 ) , 159236 ( 2011 ) .",
    "j. hesthaven and t. warburton nodal discontinuous galerkin methods : algorithms , analysis , and applications , springer ( 2008 ) .",
    "jin , w. c. chew , combining pml and abc for the finite - element analysis of scattering problems , microwave and optical technology letters 12 ( 1996 ) , 192197 .",
    "k. kormann , m. kronbichler and b. mller , derivation of strictly stable high order difference approximations for variable - coefficient pde , j. sci comput , doi : 10.1007/s10915 - 011 - 9479 - 1 ( 2012 ) g. kreiss , k. duru , discrete stability of perfectly matched layers for anisotropic wave equations in first and second order formulation , bit numer math ( 2013 ) , doi : 10.1007/s10543 - 013 - 0426 - 4 .",
    "kreiss , and n.a .",
    "petersson , _ boundary estimates for the elastic wave equations in almost incompressible materials , _",
    "siam j. num .",
    "1556 - 1580 , doi : 10.1137/110832847 ( 2012 ) .",
    "kreiss , j. lorenz , initial - boundary value problems and the navier - stokes equations , first ed . , academic press , boston , 1989 .",
    "kreiss , initial boundary value problems for hyperbolic systems , comm .",
    "pure appl .",
    ", 23 ( 1970 ) , 277298 . m. kuzuoglu , r. mittra , frequency dependence of the constitutive parameters of causal perfectly matched anisotropic absorbers , ieee microwave and guided wave letters , 6 ( 1996 ) , 447449 .",
    "lions , j. mtral , o. vacus , _ well - posed absorbing layer for hyperbolic problems , _ numer . math .",
    "( 2002 ) 92 : 535562 .",
    "y. y. lu , minimizing the discrete reflectivity of perfectly matched layers , ieee photonic tech .",
    "18 ( 2006 ) , 487489 . k. mattsson , boundary procedures for summation  by  parts operators , j. sc . comput . , 18 ( 2003 ) , 133153 . m. motamed , h  o .",
    "kreiss , hyperbolic initial boundary value problems which are not boundary stable , numerical analysis , school of computer science and communication , kth , stockholm , sweden ( 2008 ) .",
    "j. nordstrm , error bounded schemes for time - dependent hyperbolic problems , siam j. sci .",
    "comput . , 30 ( 2008 ) , 4659 . h. qasimov , s. tsynkov , lacunae based stabilization of pmls , j. comput",
    ". phys . , 227 ( 2008 ) , 73227345 .",
    "b. sj \" ogreen , n. a. petersson , perfectly matched layer for maxwell s equation in second order formulation , j. comput .",
    "phys . , 209 ( 2005 ) , 1946 . b. strand , summation by parts for finite difference approximations for d / dx , j. comput . ,",
    "( 1994 ) 4767 .",
    "m. svrd and j. nordstrm , review of summation - by - parts schemes for initial - boundary - value problems , j. comput .",
    ", 268 ( 2014 ) 1738 .",
    "a. taflove , advances in computational electrodynamics , the finite - difference time - domain artec house inc .",
    "e. turkel and a. yefet , absorbing pml boundary layers for wave  like equations , appl .",
    "maths 27 ( 1998 ) , 533557 ."
  ],
  "abstract_text": [
    "<S> in this paper we address the temporal energy growth associated with numerical approximations of the perfectly matched layer ( pml ) for maxwell s equations in first order form . in the literature </S>",
    "<S> , several studies have shown that a numerical method which is stable in the absence of the pml can become unstable when the pml is introduced . </S>",
    "<S> we demonstrate in this paper that this instability can be directly related to numerical treatment of boundary conditions in the pml . </S>",
    "<S> first , at the continuous level , we establish the stability of the constant coefficient initial boundary value problem for the pml . to enable the construction of stable numerical boundary procedures </S>",
    "<S> , we derive energy estimates for the variable coefficient pml . </S>",
    "<S> second , we develop a high order accurate and stable numerical approximation for the pml using summation  by  parts finite difference operators to approximate spatial derivatives and weak enforcement of boundary conditions using penalties . by constructing analogous discrete energy estimates </S>",
    "<S> we show discrete stability and convergence of the numerical method . </S>",
    "<S> numerical experiments verify the theoretical results .    </S>",
    "<S> maxwell s equations , guided waves , boundary waves , normal mode analysis , perfectly matched layers , energy method , well  </S>",
    "<S> posedness , stability , high order accuracy , efficiency , finite difference , summation  by  parts , penalty terms .    </S>",
    "<S> 35l15 35l05 35l10 35l20 35q61 35q74 </S>"
  ]
}