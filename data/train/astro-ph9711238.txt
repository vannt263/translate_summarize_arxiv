{
  "article_text": [
    "gravitation is the only one of the four fundamental forces in physics which can not be shielded by particles of opposite charge and whose force at long range interactions does not have any ( e.g. exponential ) cutoff ; the gravitational force is described by newton s inverse square force law to the largest possible ranges in which classical mechanics applies .",
    "so it does not have a preferred scale and as a consequence gravitational forces play an important role for the dynamical evolution of astrophysical systems on practically all scales . among the most challenging problems which have been treated by purely gravitational @xmath0-body simulations",
    "are structure formation in the universe , evolution of galactic nuclei and globular star clusters . even if non - gravitative effects become important , like hydrodynamics or magnetohydrodynamic forces ( e.g. for star formation or dissipative galaxy formation ) some of the methods to solve the relevant dynamical equations represent the gas by particles interacting by a combination of gravitational and non - gravitative forces ( smoothed particle hydrodynamics , sph , lucy 1977 , gingold & monaghan 1977 ) .",
    "thus , simulations using particles to follow the dynamical evolution of astrophysical systems are one of the most important tools in computational astrophysics and have become a third independent experimental field of astrophysical research besides theory and observations .",
    "this paper is organized as follows .",
    "first we present some key questions which are being addressed by present or future direct @xmath0-body simulations in the fields of globular star clusters , galactic nuclei , and cosmological models of structure formation ( sect .",
    "second , the main algorithms for astrophysical @xmath0-body simulations are briefly introduced and discussed in comparison with each other ( sect .",
    "3 ) . in sect . 4",
    "their implementation on special purpose hardware is discussed and a new concept for faster and more flexible hardware tailored to various kinds of direct @xmath0-body simulations including gas dynamics is presented .",
    "there is an excellent review of the internal dynamics of globular star clusters ( meylan & heggie 1997 ) . here",
    "we only want to stress some selected topics which are relevant to the subject of @xmath0-body simulations .",
    "globular star clusters are nicely spherical ( sometimes slightly flattened ) star clusters consisting of @xmath1 ",
    "@xmath2 stars .",
    "since their escape velocity is small compared to the typical velocities of stellar winds and explosions they are practically gas - free .",
    "they are ideal stellar dynamical laboratories because their relevant thermal ( two  body relaxation ) and dynamical timescales are smaller than their lifetime .",
    "globular cluster systems exist around many other galaxies as well ( see e.g. forbes , brodie & grillmair 1997 ) .",
    "due to their relative isolation , lack of observable interstellar gas and due to their symmetry globular clusters are well approximated by simplified theoretical models . since the relaxation timescale is long compared to the dynamical time they develop through a sequence of dynamical ( virial ) equilibria .",
    "the fundamental kinetic equation in such case is the fokker - planck equation .",
    "inspired by plasma physical work the use of this equation for stellar dynamics goes back to cohn ( 1980 ) .",
    "recent models of that type include the effects of anisotropy ( differences between radial and tangential velocity dispersion , which can be present even in spherical systems , takahashi 1996 , 1997 ) .",
    "another improvement includes for the first time the effect of rotation for those of the globular clusters which are slightly flattened ( einsel & spurzem 1997 ) .",
    "also anisotropic gaseous models based on a moment evaluation of the fokker ",
    "planck equation were successfully used ( louis & spurzem 1991 , spurzem 1994 ) .    in the presence of self - gravitation many concepts of thermodynamics ,",
    "however , have to be used with care .",
    "so , for example , there is no global thermodynamic equilibrium , because a system of gravitating point masses can always achieve infinite amounts of binding energy just by moving two or more or all of the particles closer and closer together .",
    "at some limiting central velocity dispersion general relativity takes over and the cluster collapses by a dynamical instability towards a black hole ( shapiro & teukolsky 1985 ) . before reaching that limit most realistic astrophysical systems , however ,",
    "will reach the limit of physical collisions and merging of their stars .",
    "another alternative is that strong two  body correlations ( close binaries ) form which subsequently stop the global gravitational collapse by superelastic scatterings with field stars ( bettwieser & sugimoto 1984 ) .",
    "if there are too many binaries , however , the fundamental assumption of using the one - particle distribution function and the fokker - planck equation breaks down .",
    "the second obstacle of thermodynamic methods to treat astrophysical ensembles of particles is simply that particle numbers are not large enough .",
    "therefore stochastic fluctuations , deviations from thermodynamic expectation values in individual representations of e.g. star clusters are much more significant than in any laboratory gas ; the amplitude of such fluctuations can be of a size comparable to that of the observed quantity .",
    "hence it is by no means guaranteed , that a given individual globular cluster consisting of some one million or less particles strictly evolves according to models derived from statistical mechanics . as a consequence giersz & heggie ( 1994a , b , 1996 , 1997 ) in their seminal series of papers compared the results of statistical models based on the fokker - planck approximation with ensemble averages of a number of statistically independent direct @xmath0-body simulations . from this and similar work ( spurzem & aarseth 1996 , makino 1996 )",
    "one can conclude that in spherical isolated clusters statistical models in spherical symmetry with standard two  body relaxation work fairly well , but already in the case of a galactic tidal field with an enhanced mass loss by stellar escapers , severe problems occur in understanding the results of the direct @xmath0-body models and their relation to the results of the fokker - planck results ( heggie 1997 , this volume ) .",
    "note that such problems occur for one of the still most simplified globular cluster models ; no rotation and no mass loss by stellar evolution was included , stars were considered as point masses and no effects of binary stellar evolution taken into account , no primordial binaries present , no time - dependent three - dimensional tidal field , and so on .",
    "consequences from that are two  fold : first great care should be taken advancing fokker - planck and gaseous models to more complicated situations , second direct @xmath0-body models should be seen either as a theoretical tool to check and gauge the statistical models ( eventually after a process of ensemble averaging ) or they should employ a realistic particle number to directly model an individual , real star cluster .",
    "besides the questions of gravothermal oscillations in very large @xmath0-body systems and the scalability of cluster models in a galactic tidal field , which are treated elsewhere , we would like to stress here the importance to acquire information on the pre- and post - collapse evolution of @xmath0-body models of rotating globular clusters , for which very little is known yet .    from the previous paragraphs",
    "it should be clear , that only an exact , direct @xmath0-body integrator should be used for problems of globular cluster dynamics , which treats the two - body relaxation by small angle gravitative encounters of all impact parameters with a maximal accuracy and simultaneously , accurately and efficiently follows the formation and evolution of very close binaries , whose timescales differ by many orders of magnitude from the dynamical timescale of the whole cluster .",
    "such requirements are fulfilled by nbody5 ( aarseth 1985 ) and its successors ( see sect .",
    "3 ) . as a final remark for this subsection",
    ", we stress that in very young stellar clusters , like newly forming globular clusters seen around merging galaxies ( schweizer et al . 1996 ) , the timescales to deplete the cluster from remaining protostellar gas by stellar winds , for star formation and evolution of massive stars , are comparable to the dynamical time of the cluster . since mass segregation by two ",
    "body relaxation can be faster than the standard relaxation by a factor of @xmath3 , where @xmath4 are the most massive species , and @xmath5 is the average particle mass in the cluster , even two - body effects are not completely negligible at cluster formation .",
    "modelling such situation in a context of cooling and fragmentation of a gas cloud ( murray & lin 1996 ) including stellar dynamical effects would require an highly accurate @xmath0-body integrator in dynamical coupling with a gaseous component .",
    "another long  standing problem of collisional stellar dynamics is the question of the equilibrium system and dynamical evolution of a cusp of stars surrounding a massive central black hole .",
    "such massive black holes are very likely to reside in the centres of galaxies as a fossile of earlier acticity ( kormendy & richstone 1995 ) .",
    "their formation as a result of collisionless dynamical general relativistic collapse and dissipative processes during galaxy formation is very likely but not yet fully understood ( quinlan & shapiro 1990 ) .",
    "frank & rees ( 1976 ) examined the interplay between mass and energy transport by two  body relaxation and loss ",
    "cone accretion of stars on orbits with low angular momentum by the black hole ; their results were confirmed by monte - carlo numerical models of marchant & shapiro ( 1980 ) , later followed by multi ",
    "mass direct numerical solutions of the 1d fokker ",
    "planck equation for isotropic stellar cusps of murphy , cohn & durisen ( 1991 ) .",
    "only recently the first self - consistent @xmath0-body models of massive black holes including a sufficient number of stars in their surrounding cusps were done by use of hybrid @xmath0-body algorithms ( quinlan 1996 , quinlan & hernquist 1997 ) or a high - speed special purpose computer for a direct summation algorithm ( makino & ebisuzaki 1996 , makino 1997 ) .",
    "however , the latter work was occupied mainly with the question of dynamical friction of black hole binaries in a galactic nucleus after a merger event .",
    "still the standard picture of frank & rees ( 1976 ) has not yet carefully been checked by using a direct full @xmath0-body simulation .",
    "it is not certain , whether the assumption that two ",
    "body relaxation dominates the evolution is correct ; it has been suggested that large angle close encounters of stars with each other and with the black hole compete with it , and that there may be non  standard relaxation processes at work ( rauch & tremaine 1996 ) .",
    "these are interesting open question to tackle with high accuracy pure particle @xmath0-body simulations .",
    "even more important as in the case of globular clusters , however , are the possible effects of gas produced by stellar collisions , which can accumulate in the centre due to the much deeper central potential , and form new stars ( quinlan & shapiro 1990 , rees 1997 ) we would like to conclude this subsection with the final remark that this is again a physical situation where highly accurate direct @xmath0-body models , eventually dynamically coupled with the dynamics of a gas component are very important for future understanding of such objects .      in the standard paradigm of cosmological structure formation",
    "primordial quantum fluctuations grow gravitationally in a universe dominated by non - dissipative dark matter . in the non - linear regime",
    "the distribution of masses can be estimated by simple theory ( press & schechter 1974 ) , later extended to @xmath0-body models ( e.g. white et al .",
    "1987 , navarro , frenk & white 1997 ) . on small scales",
    "gas physics , which ( e.g. in the case of star formation ) is only known approximately has to be included into the models ( steinmetz 1996 ) .",
    "recently it has been shown , that softening of the gravitational potential , which was adopted in most of the models , causes spurious two ",
    "body relaxation effects ( steinmetz & white 1997 ) .",
    "consistently moore et al .",
    "( 1997 ) find that the structure of cold - dark - matter ( cdm ) haloes significantly changes if models with much higher resolution in particle number are used .",
    "again , we want to conclude here that high resolution , high - accuracy @xmath0-body simulations , gravitationally coupled with a gas component are useful to study such questions .",
    ".algorithms for @xmath0-body simulations [ cols=\"<,<,<,<\",options=\"header \" , ]     in table 1 an overview over the most commonly used present algorithms for direct @xmath0-body simulations is given .",
    "the symbols used in the `` scaling '' column denote the particle number @xmath0 , a neighbour number @xmath6 ( compare sect .",
    "4 ) , a grid resolution @xmath7 or the number of terms @xmath8 in a series evaluation of the gravitational potential . we want to comment only very briefly on each of the methods to give an overview for the reader .",
    "the first group has been labelled `` no particle  particle relaxation '' because it does not use direct gravitational forces between particles .",
    "the gravitational potential is computed from the particle configuration via an intermediate step , either through a mesh in coordinate space or an orthogonal function series .",
    "reviews on classical particle mesh ( pm ) techniques can be found in sellwood ( 1987 ) .",
    "`` superbox '' is a multi  grid method in a classical pm scheme suitable for high resolution problems and relaxing the inflexibility of conventional pm methods somehow ( madejsky & bien 1993 ) .",
    "fast multipole methods used e.g. by greengard ( 1990 ) and greengard & rokhlin ( 1987 ) can only efficiently be used for codes using the same timestep for particles , which makes them unfeasible for astrophysical problems with gravitating particles developing into highly structured and/or inhomogeneous states .",
    "codes using an orthogonal series expansion ( so - called `` self consistent field '' or scf codes ) have been introduced to the astrophysical community mainly by hernquist & ostriker ( 1992 ) , although there are earlier similar approaches ( e.g. clutton - brock 1972 ) .    in all cases where a highly accurate computation of the gravitational potential with all its graininess due to individual particles , responsible for various relaxation effects , is necessary , there is no way to avoid a direct brute  force summation algorithm , where individual pairwise forces are computed .",
    "such approach goes back to aarseth ( 1963 ) and von hoerner ( 1960 ) .",
    "close encounters and the formation of binaries , whose binding energies are large compared to the thermal energy of the system have led to the inclusion of regularization in such codes ( named nbody1 - 4 , aarseth 1996 ) .",
    "in addition to an individual time step scheme and a high order time integrator some versions ( named nbody5 , 6 , aarseth 1985 , makino & aarseth 1992 ) also use an ahmad - cohen neighbour scheme to reduce the number of total force computations required . the algorithm is well parallelizable and has been implemented on general purpose parallel computers ( spurzem 1997 ) .",
    "the kira code is a new development by hut , mcmillan & makino ( cf .",
    "www.sns.ias.edu/starlab/starlab.html ) .",
    "at the end of table 1 there are the `` mixed '' codes ; one is the tree - code ( barnes & hut 1986 ) , using particle  particle forces in principle ; it groups , however , subsets of particles in some distance from a test particle together , taking only their centres of masses into account ( and if required also some multipole moments of the mass distribution ) .",
    "it is highly efficient for lumpy particle configurations , where the configuration has a small overall filling factor , and has been used very successfully for large - scale cosmological simulations and models of merging galaxies , partly even including a gas component treated by sph ( just as examples of most recent work look at e.g. dav , dubinski & hernquist 1997 , mihos , dubinski & hernquist 1997 ) .",
    "most tree - code implementations do not require very high accuracies , for example an energy error of up to a few percent is generally tolerated .",
    "enforcing in a tree ",
    "code very high accuracy as it is required for globular cluster models ( @xmath9 % , a typical value achieved for direct aarseth nbody - integrators ) leads to a very significant reduction of its efficiency ( mcmillan & aarseth 1993 ) .",
    "finally , another `` mixed '' code also used especially for cosmological simulations with an sph gas component is the @xmath10code , for which we refer to a recent paper of pearce & couchman ( 1997 ) .",
    "the construction of special - purpose hardware to compute gravitational forces in direct @xmath0-body simulations was inspired by the fact that the total cpu time required for one time step of all particles scales as @xmath11 , with some numerical time constants @xmath12 and @xmath13 . for",
    "large particle number @xmath0 the second part ( the pairwise force calculation ) consumes most of the time ( see sugimoto et al .",
    "so our japanese colleagues built the grape hardware , whose development culminated in the presentation of the grape-4 teraflop computer ( makino et al .",
    "1997 , see also the papers of makino and taiji in this volume )",
    ". the latter could be so fast , that according to amdahl s law the other parts of the code ( e.g. to advance the particles ) become the bottleneck of the simulation , especially if not just the simplest possible @xmath0-body integrator is used , but a neighbour scheme like nbody6 or , even worse , a code which also includes some gas dynamical sph calculations ( see e.g. steinmetz 1996 ) .",
    "a prototype timing formula for the cpu time required per timestep in such cases is @xmath14 , where @xmath15 is another time constant and @xmath6 a typical neighbour number , for which neighbour forces ( in case of nbody6 ) or gas dynamical forces ( in case of sph ) are to be calculated on a test particle .",
    "we are proposing to use here reconfigurable hardware based on field  programmable gate arrays ( fpga ) which has been developed at the university of mannheim , germany ( cf .",
    "e.g. hgl et al .",
    "the neighbour operations could be mapped onto the fpga device and both this device and the grape machine could be connected to a standard host workstation . in fig .",
    "1 the expected speed - up of such a configuration ( models e , g ) compared to a standard configuration with grape ( models d , f ) for such applications is depicted . since the fpga device is somewhat more flexible to code and adapt to different problems , and",
    "since such type of machine would be ideally suited for high accuracy gravitational force computations in an @xmath0-body simulation with a gas component it is called aha - grape ( * a*daptive * h*ydrodyn*a*mics * grape * ) .    the data of fig .",
    "1 were obtained under a number of conservative and simplified assumptions , e.g. all effects of parallelization were neglected , host speeds of 50 mflops , grape speeds of 500 gflops ( `` fast '' ) and 50 gflops ( `` normal '' ) , aha ( fpga ) speeds of 5 gflops ( `` fast '' ) and 500 mflops ( `` normal '' ) were adopted .",
    "the bus connection from the host to aha and grape was assumed having a bandwidth of 100 mb / s ( `` fast '' ) and 10 mb / s ( `` normal '' ) .",
    "the number of floating point operations assumed was 20 for a gravitational force calculation on grape , 100 for all neighbour operations per neighbour , and 100 to advance a particle by a high order integrator on its orbit .",
    "all adopted values are considered as rather conservative , especially if the technological evolution of the next 5 - 10 years is allowed for .",
    "it is concluded that the overall speedup of such a combined machine is considerable , that it will be an ideal tool for high - accuracy @xmath0-body simulations including an sph gas component , and that such a prototype will open up the road to very fast and flexible customized computers for astrophysical @xmath0-body simulations in the future .",
    "more details will be published elsewhere .",
    "aarseth s.j .",
    ", 1963 , mnras , 126 , 223 aarseth s.j . , 1985 , in brackbill j.u . , cohen b.i .",
    ", eds , multiple time scales , academic press , orlando , p. 378",
    "barnes j. , hut p. , 1986",
    ", nature , 324 , 446 bettwieser e. , sugimoto d. , 1984 , mnras , 208 , 493 clutton - brock , m. , 1972 , astrophys .",
    "space science , 16 , 101 cohn h.n .",
    ", 1980 , apj , 242 , 765 dav r. , dubinski j. , hernquist l. , 1997 , newa , 2 , 277 einsel c. , spurzem r. , 1997 , mnras , subm .",
    "( astro - ph/9704284 ) forbes d.a . ,",
    "brodie j.p . , grillmair c.j . , 1997 , aj , 113 , 1652 frank j. , rees m.j . , 1976 , mnras , 176 , 633 giersz m. , heggie d.c .",
    ", 1994a , mnras , 268 , 257 giersz m. , heggie d.c . , 1994b , mnras , 270 , 298 giersz m. , heggie d.c . , 1996 , mnras , 279 , 1037 giersz m. , heggie d.c . , 1997 , mnras , 286 , 709 gingold r.a . , monaghan j.j . , 1977 , mnras , 181 , 375 greengard l. , 1990 , computers in physics , mar / apr 1990 , p. 142 . greengard l. , rokhlin v. , 1987 , j. comp .",
    ", 73 , 325 heggie d.c . , 1997 , `` star cluster simulations '' , this volume heggie d.c . , giersz m. , spurzem r. , takahashi k. , 1997 , in j. andersen , ed , highlights of astronomy vol . 11 , kluwer acad .",
    "publishers , in press hernquist l. , ostriker j.p . , 1992 ,",
    "apj , 386 , 375 hgl h. , kugel a. , ludvig j. , mnner r. , noffz k .- h . , zoz r. , 1995 , enable++ : a second generation fpga processor ; proc .",
    "3rd ieee symp .",
    "on fpgas for custom computing machines , napa , ca , 45 - 53 von hoerner s. , 1960 , zeits .",
    "f. astroph . ,",
    "50 , 184 ( in german ) kormendy j. , richstone d. , 1995 , ara&a , 33 , 581 louis p.d .",
    ", spurzem r. , 1991 , mnras , 244 , 478 lucy l. , 1977 , aj , 82 , 1013 madejsky r. , bien r. , 1993 , a&a , 280 , 383 makino j. , 1996 , apj , 471 , 796 makino j. , 1997 , apj , 478 , 58 makino j. , aarseth s.j .",
    ", 1992 , pasj , 44 , 141 makino j. , ebisuzaki t. , 1996 , apj , 465 , 527 makino j. , taiji m. , ebisuzaki t. , sugimoto d. , 1997 , apj , 480 , 432 marchant a.b . , shapiro s.l . , 1980 , apj , 239 , 685 mcmillan s.l.w . ,",
    "aarseth s.j . , 1993 , apj , 414 , 200 meylan g. , heggie d.c . , 1997 , a&arv , 8 , 1 mihos j.c . , dubinski j. , hernquist l. , 1997 , apj , in press ( astro - ph/9708009 ) murphy b.w . , cohn h.n . , durisen r.h",
    ", 1991 , apj , 370 , 60 murray s.d . ,",
    "lin d.n.c . , 1996 ,",
    "apj , 467 , 728 navarro j.f . ,",
    "frenk c.s . ,",
    "white s.d.m . , 1997 ,",
    "apj , 490 , 493 pearce f.r .",
    ", couchman h.m.p . , 1997 , newa , 2 , 411 press w.h . , schechter p.l . , 1974 ,",
    "apj , 187 , 425 quinlan g.d . , 1996 , newa , 1 , 35 quinlan g.d . ,",
    "hernquist l. , 1997 , newa , 2 , 533 quinlan g.d . , shapiro s. , 1990 , apj , 356 , 483 rauch k.p . , tremaine s. , 1996 , newa , 1 , 149 rees m.j .",
    ", 1997 , rev .",
    ", 10 , 179 schweizer f. , miller b.w .",
    ", whitmore b.c . ,",
    "fall s.m . , 1996 ,",
    "aj , 112 , 1839 sellwood j.a . , 1987 , ara&a , 25 , 151 shapiro s.a . , teukolsky s.a . , 1985 , apjl , 292 , l41 spurzem r. , 1994 , in pfenniger d. , gurzadyan v.g . , eds , ergodic concepts in stellar dynamics , springer - vlg . , berlin , heidelberg , p. 170",
    "spurzem r. , 1997 , mnras , subm .",
    "( ari preprint no .",
    "68 ) spurzem r. , aarseth s.j . , 1996 , mnras , 282 , 19 steinmetz m. , 1996 , mnras , 278 , 1005 steinmetz m. , white s.d.m . , 1997 , mnras , 288 , 545 sugimoto d. , chikada y. , makino j. , ito t. , ebisuzaki t. , umemura m. , 1990 , nature , 345 , 33 takahashi k. , 1996 , pasj , 48 , 691 takahashi k. , 1997 , pasj , 49 , 547 white s.d.m , frenk c.s . , davis m. , efstathiou g. , 1987 , apj , 313 , 505"
  ],
  "abstract_text": [
    "<S> the subjects and key questions faced by computational astrophysics using @xmath0-body simulations are discussed in the fields of globular star cluster dynamics , galactic nuclei and cosmological structure formation . after a comparison of the relevance of different @xmath0-body algorithms a new concept for a more flexible customized special purpose computer based on a combination of grape and fpga is proposed . </S>",
    "<S> it is an ideal machine for all kinds of @xmath0-body simulations using neighbour schemes , as the ahmad - cohen direct @xmath0-body codes and smoothed particle hydrodynamics for systems including gas .    </S>",
    "<S> epsfig.sty cmcsc10 </S>"
  ]
}