{
  "article_text": [
    "the sunyaev - zeldovich effect  @xcite is one of the most interesting and promising observational tools for cosmology . during the last four decades",
    ", many works have addressed its usefulness as a probe that can be used to determine cosmological parameters ( in special when combined with other observational diagnostics such as gravitational lensing or x - ray observations ) , to study the abundances and evolution of galaxy clusters up to high redshifts , to estimate the gas mass fractions inside clusters , to measure peculiar velocities of the gas and to map the inner structure of galaxy clusters . some excellent recent reviews on the physics of the sz effect",
    "can be found in @xcite and @xcite .",
    "recent observational results have been reviewed in  @xcite and  @xcite .",
    "another excellent review that focus in the application of sz effect observations to cosmology can be found in @xcite .",
    "while the theory of the sz effect physics is very well understood , from the observational point of view its study is still difficult .",
    "this is mainly due to the faintness of the effect specially the elusive kinematic sz effect and the presence of many astrophysical `` contaminants '' in the frequencies where the sz effect is better observed .",
    "the sz effect appears as a secondary anisotropy in the cosmic microwave background ( cmb ) , that is , as a small spectral distortion in the cmb spectrum caused by the scattering of cmb photons due to high energy electrons .",
    "therefore , it must be disentangled from the cmb fluctuations themselves , a task that is relatively easy to accomplish in the case of the thermal sz effect but very difficult in the case of the kinematic sz . besides , all the contaminants ( or `` foregrounds '' ) that affect cmb observations affect as well sz effect experiments : extragalactic point sources and galactic foregrounds such as dust , synchrotron and free - free emissions . as we will show later in this work , even the two different types of sz effects , the thermal and the kinematic , can be considered as contaminants one of the other .    in the last few years several sz experiments",
    "have reached the sensitivities and angular resolutions needed to , for the first time in history , fully exploit the power of sz observations .",
    "even more experiments are under construction or planned for the next years @xcite . ever for these high - sensitivity experiments",
    "the observation of the sz effect is not an easy task , and therefore a great care must be placed in the analysis and interpretation of the data .",
    "several different approaches lead to the many different sz data analysis methods proposed in the literature .",
    "one approach is the _ component separation _ , which goal is to extract from the data all the different signals that were present for their separate study . in this context",
    "the sz effect is just one of the products of the separation .",
    "component separation techniques typically make use of the different statistical distribution and spectral behaviour ( i.e. the different frequency dependence ) of the components .",
    "an example of component separation method that has been applied to simulations containing sz effect is the maximum entropy method , e.g. @xcite .",
    "as noted by @xcite and @xcite , component separation methods can be very powerful but there is a risk when the main goal is to study only one of the sources ( in this case the sz effect ) : an error in the separation of any one of the components is easily propagated to the others , and therefore it is necessary to be extremely careful that all the assumptions made ( such as the frequency dependence of the components , or their statistical independence , etc ) are correct .",
    "another approach focuses only on the one component under study ( the sz in this case ) , trying to extract it from the data or to estimate a few parameters that characterise it .",
    "for example , in the case of the sz effect we can try to obtain a map of the compton parameter or just to obtain the positions of the clusters , their integrated fluxes , their peculiar velocities , etc .",
    "we will call this approach _ detection _ and/or _",
    "estimation_. detection / estimation techniques consider all the other components of the data apart from the one under study as interference ( noise ) and try to minimise its impact . compared with component separation techniques , they tend to be more robust in the sense that they do not need to model in detail all the different components that form part of the `` background '' .",
    "examples of this type of techniques applied to sz data are bayesian non - parametric mapping of the compton parameter @xcite , optimal filtering @xcite , markov chain monte carlo ( mcmc ) sampling techniques @xcite and parameter estimation via simulated annealing @xcite .",
    "the choice among the above mentioned techniques is a delicate issue ; all of them have some desirable properties and some drawbacks , and depending on the case under study one or another ( or even a combination of several of them ) will be more appropriate .",
    "the good thing is that they are not mutually exclusive and in certain cases they can work together to obtain better results .",
    "in general non - linear methods such as mcmc and simulated annealing are more powerful , but they are not free of problems .",
    "mcmc methods are expensive and time - demanding from the computational point of view .",
    "this make them unpractical for large blind sz surveys .",
    "the sasz simulated annealing code @xcite is fast but in presence of astrophysical contaminants such as extragalactic point sources and galactic foregrounds it is likely to suffer from systematic errors that can be relatively large @xcite .",
    "linear `` optimal '' filters may be not so powerful as non - linear detection / estimation techniques , but they have some nice properties that may make us consider their use .",
    "they are simple to understand and implement .",
    "they are quite fast and not computationally demanding .",
    "moreover , since they do not need a detailed modelling of the background statistical properties apart from the fact that it is statistically homogeneous and that it can be properly described by second - order statistics , namely the power spectrum they are very robust . moreover , convolutive filters are appropriate to select `` compact '' features ( as clusters of galaxies ) in the data by filtering out the large scales where diffuse components manifest and the small scales where pixel noise appear .",
    "the multifilters ( filters that operate simultaneously on all the frequency channels of an experiment , taking into account the frequency dependence of the sz effect and the correlations among different channels in order to optimise the detection of the sz effect ) presented in @xcite provide a powerful denoising tool ( they minimise the background contamination ) as well as a straightforward amplitude estimation criterion . in that work two families of multifilters ,",
    "the matched multifilter ( mmf ) and the scale - adaptive multifilter ( samf ) were studied and tested on realistic planck simulations .",
    "the results showed that both families of multifilters lead to unbiased estimators of the central value of the compton parameter of the clusters in the simulations , even in presence of realistic contaminants .",
    "mmf give higher gain factors ( the ratio between the variance of the background before and after filtering ) than the samf , keeping the same level of spurious detections , so they are preferred as our tool of choice .",
    "the @xcite multifilters were designed to detect / estimate the amplitude of the thermal sz effect . in the same way",
    "they can be constructed to detect the more elusive kinematic sz effect just by changing accordingly the frequency dependence of the effect in the formulae that lead to the expression of the filter .    in the previous discussion",
    "we have considered the case when only the thermal ( or kinematic ) sz effect is present in the data .",
    "but if the two effects appear at the same time , will be the multifilter estimator still unbiased ?",
    "the answer , as we will see , is no .",
    "multifilters use information on the frequency dependence and the spatial profile of the sources at the same time .",
    "if two sources have different frequency dependence and profile they are likely to be separated very well .",
    "but if the two sources have the same profile , or the same frequency dependence , the problem will be somewhat degenerated and the estimator will show systematic effects .",
    "a case of two sources with the same frequency dependence but different spatial profile is evident : the kinematic sz effect and the cmb spectra are identical ( except for second - order relativistic effects ) .",
    "this means that some residual contamination from cmb fluctuations will remain after filtering , introducing errors in the estimation of the kinematic sz .",
    "fortunately , the cmb fluctuations are damped considerably on the angular scales of typical galaxy clusters ( see for example @xcite ) .",
    "moreover , since cmb fluctuations can be symmetrically positive or negative , on average the statistical systematic bias due to this effect is zero .",
    "considered individually , however , all kinematic sz measurements by mean of multifilters will be affected by a non - removable error , and little can be done to solve this problem .",
    "on the other hand , the problem that appears when two signals with the same spatial profile and different frequency dependence are overlapped can be solved . in our case",
    "these two signals are the thermal and the kinematic sz effects .",
    "we will show here that their superposition leads inevitably to systematic errors in the estimation of the sz parameters when we use standard matched multifilters .",
    "this errors can be very large in the case of the kinematic sz effect and can be very dangerous for automatic blind sz surveys .",
    "this paper is devoted to the study and cancellation of this dangerous type of bias .",
    "the paper is structured as follows . in section  [ sec : mmf ] we will briefly review the mmf and its properties . in section  [ sec:2signals ]",
    "we will show how the non - removable systematic bias appears in the mmf estimator when two signals with the same spatial profile and location but different frequency dependence are present .",
    "section  [ sec : ummf ] shows how to design families of multifilters that overcome that problem : the unbiased matched multifilters ( ummf ) . in section  [ sec : planck ] we will test the mmf and the ummf in realistic planck simulations .",
    "finally , we will discuss our results in section  [ sec : discussion ] .",
    "the standard matched multifilter ( mmf ) was introduced by @xcite and , independently , by  @xcite . following  @xcite ,",
    "let us consider a set of @xmath0 astronomical images corresponding to observations at different frequencies of a given region of the sky .",
    "a signal with a known frequency dependence is embedded in the data , so that the observations can be described with the following model : @xmath1 where the _ generalised noise _",
    "@xmath2 corresponds to the sum of the other emission components in the map .",
    "the background @xmath3 is modelled as a homogeneous and isotropic random field with average value @xmath4 and cross - power spectrum @xmath5 ( @xmath6 ) defined by @xmath7 where @xmath8 is the fourier transform of @xmath3 and @xmath9 is the 2-d dirac distribution .",
    "the spatial profile @xmath10 is usually written as the product of the source amplitude @xmath11 and a spatial template @xmath12 .",
    "in general , the template at each frequency @xmath13 is the result of the convolution of the normalised profile of the source and the antenna beam at that frequency .",
    "hereinafter , we assume for simplicity that the source has spherical symmetry , @xmath14 , but the methods can be generalised for non - symmetric profiles . for simplicity as well we will assume that the source is centred at the position @xmath15 .    equation ( [ eq : data_model ] ) can be expressed in a more compact way as a vector equation , @xmath16 where the elements of vector @xmath17 are @xmath18 .",
    "hereinafter , we will employ the usual boldface notation for the @xmath0-component vectors in frequency whereas the `` arrow '' notation @xmath19 will refer to 2-dimensional vectors in real space or fourier space .",
    "the goal is to obtain a set of @xmath0 linear filters that , once applied to the data , allow us to determine the amplitude @xmath11 of the signal with a minimum interference of the contaminant noise",
    ". the filters should take advantage on the knowledge of the frequency dependence of the signal @xmath20 , the characteristic profile of the source @xmath21 and the cross - power spectrum of the noise , that can be directly estimated from the data .",
    "the filters are applied to the @xmath0 frequency channels in order to give a quantity called _ filtered map_ at each position that will be used as an estimator of @xmath11 .",
    "let @xmath22 the vector of @xmath0 filters we are looking for , then the filtered map at the position @xmath23 is given by @xmath24 that can be expressed in fourier space in a very compact way @xmath25 where the superscript @xmath26 denotes vector transposition , and the operation inside the integral is the usual scalar product of vectors .",
    "the variance of the filtered map can be expressed as @xmath27 the explicit dependence in @xmath28 has been removed from the previous equation for the sake of simplicity of notation . unless it is necessary to include it , we will do the same in the following .",
    "the mmf is obtained when two constraints are imposed on the filters",
    "@xmath29 :    1 .   that @xmath30 is an _ unbiased estimator _ of the amplitude of the source , that is , @xmath31 .",
    "2 .   that @xmath30 is an _ efficient estimator _ of the amplitude of the source , that is , the variance of the @xmath32 values is minimum .",
    "as was shown in @xcite , the filters that satisfy these conditions are given by : @xmath33 where @xmath34 is the inverse matrix of the cross - spectrum @xmath35 .",
    "( [ eq : variance ] ) we have that for the mmf @xmath36",
    "the mmf is designed to produce an unbiased and efficient linear estimator of the amplitude of a signal with known frequency dependence and spatial profile in multiwavelenght observations . but what happens when there are present two signals with the same spatial profile and location but different frequency dependence ?",
    "such is the case , for example , of the thermal and kinetic sunyaev - zeldovich effects .",
    "both effects are superimposed with identical spatial distribution ( if we do not take into account intracluster gas motions that can distort the shape of the kinematic effect ) but quite different frequency dependence .",
    "the thermal sz effect is due to the inverse compton scattering of cmb photons by free electrons in the hot intra - cluster gas .",
    "it produces a shift in the cmb spectrum to higher frequencies in the direction where the cluster is observed .",
    "this effect is characterised by the comptonization parameter @xmath37 , @xmath38 where @xmath39 is the boltzmann constant , @xmath40 the thomson section , @xmath41 the electron mass , @xmath42 the velocity of light , @xmath43 and @xmath44 are the temperature and density of the electrons in the gas and @xmath45 is the distance along the line of sight . ignoring relativistic effects ,",
    "the frequency dependence of the thermal sz effect is given by @xmath46 where @xmath47 is the planck constant and @xmath48 the temperature of the cmb , and where @xmath49    the kinematic sz effect , on the other hand , is due to the doppler effect that arises because of the radial peculiar velocity of the cluster @xmath50 along the line of sight .",
    "the intensity of the kinematic effect , not taking into account second - order relativistic corrections and considering @xmath43 to be constant along the cluster , is @xmath51 and the frequency dependence is ( again ignoring relativistic corrections ) constant in @xmath52 units .",
    "the intensity of the kinematic effect is in general significantly smaller than the intensity of the thermal effect .    at high frequencies ,",
    "the expressions given above are not accurate and relativistic corrections should be taken into account when dealing with real data . in this work",
    "we restrict the discussion to the non - relativistic case for simplicity .      combining the two sz effects",
    "our data model is @xmath53 + \\mathbf{n } \\mathnormal{(\\vec{x } ) } , \\ ] ] where @xmath54 and the vector @xmath17 is constructed using the profile @xmath21 and the thermal sz frequency dependence in eqs .",
    "( [ eq : szt_freqdep ] ) and ( [ eq : szt_freqdep2 ] ) .",
    "imagine a mmf designed for the detection of the thermal sz effect is applied to the data in ( [ eq : data_model_both_vectorial ] )",
    ". the filter will be the one given in eq .",
    "( [ eq : mmf ] ) using the vector @xmath17 that corresponds to eq .",
    "( [ eq : data_model_both_vectorial ] ) .",
    "it is easy to calculate the average value of the filtered map : @xmath55   \\upsilon_{mmft } = \\nonumber \\\\ y_c \\ \\alpha^{-1 } \\int d \\vec{q } \\",
    "\\mathbf{f}^{\\mathrm{t } } \\mathbf{p}^{\\mathnormal{-1 } } \\mathbf{f } - y_c   v \\alpha^{-1 } \\int d \\vec{q } \\",
    "\\mathbf{\\tau}^{\\mathrm{t } } \\mathbf{p}^{\\mathnormal{-1 } } \\mathbf{f }   = \\nonumber \\\\ y_c - y_c v \\frac{\\beta}{\\alpha},\\end{aligned}\\ ] ] where the constant @xmath56 is defined as @xmath57    according with eq .",
    "( [ eq : filtered_map_mmft ] ) , due to the presence of the kinematic sz effect the estimator @xmath58 is not longer unbiased , and the estimation of @xmath37 will have a systematic error proportional to @xmath59 .",
    "the same will occur when a mmf designed for the detection of the kinematic sz effect . in that case",
    ", the frequency dependence to be used is a constant whose value can be included in @xmath60 and therefore @xmath61 .",
    "the shape of the mmf is then @xmath62 the average value of the filtered map is then @xmath63   \\upsilon_{mmfk } = \\nonumber \\\\ y_c \\ \\gamma^{-1 } \\int d \\vec{q } \\",
    "\\mathbf{f}^{\\mathrm{t } } \\mathbf{p}^{\\mathnormal{-1 } } \\mathbf{\\tau } - y_c   v \\gamma^{-1 } \\int d \\vec{q } \\",
    "\\mathbf{\\tau}^{\\mathrm{t } } \\mathbf{p}^{\\mathnormal{-1 } } \\mathbf{\\tau }   = \\nonumber \\\\",
    "y_c \\frac{\\beta}{\\gamma }   - y_c v.\\end{aligned}\\ ] ] note that since @xmath37 and @xmath60 appear as a product in eq .",
    "( [ eq : data_model_both_vectorial ] ) , @xmath64 is not a direct estimator of @xmath60 but of the quantity @xmath65 .",
    "dividing by @xmath37 and changing the signs we obtain @xmath66 and therefore we find that our estimator is again biased .    as we will see later in section  [",
    "sec : planck ] , in the case of microwave observations of the sz effect , the bias in the mmf estimator of the thermal sz effect is normally negligible , but in the case of the kinematic sz effect it is expected to be very large , of the order of the effect itself or even bigger . therefore , this bias must be taken into account and corrected .",
    "there are several ways in which the bias described above can be taken into account .",
    "the first option is simply to separate the thermal and kinematic effects before estimating their amplitudes .",
    "this goal can be attained using a convenient component separation technique , for example the maximum entropy method @xcite , non - parametric bayesian detection @xcite or mcmc sampling techniques @xcite .",
    "the problem is that in practise no component separation technique works perfectly , and some uncontrolled residuals always remain that will still bias the estimation of the amplitude of the effects .",
    "a second option consists in using eqs .",
    "( [ eq : filtered_map_mmft ] ) and ( [ eq : bias_mmfk ] ) to subtract the bias factor in each case .",
    "this is a perfectly licit option in principle , but can be a little difficult to carry out in a real case .",
    "the argument is as follows : to determine the bias in @xmath37 we need , according to eq .",
    "( [ eq : filtered_map_mmft ] ) , to know the value of @xmath65 , whose estimation is biased . to remove the bias in @xmath65 we need , according to eq .",
    "( [ eq : bias_mmfk ] ) , to know the value of @xmath37 , which is biased as well .",
    "moreover , on an individual basis ( cluster by cluster ) the quantities @xmath60 and @xmath37 will be estimated with a non - zero error .",
    "therefore , trying to cancel the bias in this way leads us to a vicious circle . in section  [ sec : planck ] we will see that for the case of the future planck satellite observations the bias in @xmath37 will be small , and the vicious circle could be circumvented just by considering the estimated @xmath37 as the correct one .",
    "this would however introduce further errors in any case . besides , in other experiments the bias in @xmath37 can be not so small as in the planck case is .",
    "therefore , we do not recommend this option to cancel the bias of the mmf . in the next section",
    "we will describe two novel lineal multifilters that automatically cancel the bias in the estimation of the thermal and kinematic sz amplitudes .",
    "instead of following any of the approaches described in section  [ sec : cancelling ] , let us see if it is possible to design linear filters that are nearly as efficient as the mmf and do not show the systematic bias described above . to do it",
    "we will make use of the knowledge on the two distinct frequency dependences of the thermal and kinematic sz effects .",
    "the resulting filters will be called _ unbiased matched multifilters _ ( ummf ) . specifically , we search for a set of filters specifically designed to give the thermal amplitude @xmath37 without bias and a different set of filters specifically designed to give the kinematic amplitude @xmath65 .",
    "we construct the filters @xmath67 so that the filtered map @xmath68 satisfies the canonical matched filter conditions plus another one aimed at cancelling the bias due to the presence of the kinematic effect .    1 .   the filters , when applied to the thermal part of eq .",
    "( [ eq : data_model_both_vectorial ] ) , give , at the position of the source , the value of the comptonization parameter , that is , @xmath69 2 .",
    "the filters , when applied to the kinematic part of eq .",
    "( [ eq : data_model_both_vectorial ] ) , give , at the position of the source , no contribution to the filtered map , that is , @xmath70 3 .",
    "the variance of the filtered map , @xmath71 , is minimum ( _ efficient _ estimator ) .",
    "the two first two conditions ensure that the filtered map at the position of the source is an unbiased estimator of the thermal sz effect .",
    "the third one is the condition for efficiency of the estimator .",
    "the filters that satisfy the previous three conditions are @xmath72 where the constants @xmath73 , @xmath56 and @xmath74 are defined in equations ( [ eq : mmf ] ) , ( [ eq : beta ] ) and ( [ eq : mmfk ] ) .",
    "it is straightforward to see that @xmath75 and that the variance of the filtered map is @xmath76      let us now find the filters @xmath77 so that the filtered map @xmath78 satisfies the canonical matched filter conditions plus another one aimed at cancelling the bias due to the presence of the thermal effect .    1 .   the filters , when applied to the thermal part of eq .",
    "( [ eq : data_model_both_vectorial ] ) , give , at the position of the source , no contribution to the filtered map , that is , @xmath79 2 .",
    "the filters , when applied to the kinematic part of eq .",
    "( [ eq : data_model_both_vectorial ] ) , give , at the position of the source , the value of the product @xmath65 , that is , @xmath80 3 .",
    "the variance of the filtered map , @xmath81 , is minimum ( _ efficient _ estimator ) .",
    "the two first two conditions ensure that the filtered map at the position of the source is an unbiased estimator of the kinematic sz effect .",
    "the third one is the condition for efficiency of the estimator .",
    "the filters that satisfy the previous three conditions are @xmath82 where the constants @xmath73 , @xmath56 , @xmath74 and @xmath83 are the same as in eq .",
    "( [ eq : ummft ] ) .",
    "it is straightforward to see that @xmath84 and that the variance of the filtered map is @xmath85",
    "as a test of the previous ideas , we now apply both the standard and the unbiased matched multifilters to simulated planck observations in order to estimate the thermal and kinematic sz of test clusters placed on the simulations .",
    "our goal is just to show by an example how the biases described in section  [ sec:2signals ] appear and how the unbiased matched multifilters are able to cancel it .",
    "therefore , to keep the example simple and clear we will restrict ourselves to ideal conditions in which the spatial profile of the clusters is perfectly known from the beginning .",
    "a full study of the performance of the filters in the planck case , including uncertainties in the cluster profile , asymmetric profiles and realistic cluster distributions is out of the scope of this work and will be addressed in the future .",
    "we will focus specially on filters designed to extract the kinematic sz effect .",
    "note that due to the extreme faintness of the kinematic sz effect the task of detecting it is going to be very difficult .",
    "in fact , planck sensitivities , angular resolution and noise levels do not make it the best experiment to study the kinematic sz effect . in spite of this",
    ", we choose the planck mission as our example scenario for two reasons .",
    "the first one is that planck s instrumental specifications , noise levels and performance have been thoroughly studied in the literature , and realistic simulations of planck observations are relatively easy to produce and analyse .",
    "the second reason is that at planck s angular resolution most of the clusters will appear as point sources in the sky .",
    "therefore , their observed profile will be practically equal to the well - known beam profile of the planck detectors .",
    "then , the assumption that the spatial profile of the clusters is known is not so unreasonable .      even though for this work we are going to use very simplistic toy clusters and non - relativistic sz effects , we intend to simulate the other astrophysical and instrumental signals that constitute the generalised noise @xmath86 in eq .",
    "( [ eq : data_model_vectorial ] ) in the most realistic way possible .",
    "our simulations include the latest available information about the physical components of the emission ( cmb , galactic foregrounds and extragalactic point sources ) and the technical specifications of the different planck channels .",
    "the simulations were performed in patches of the sky of @xmath87 .",
    "table  [ tb : tech_mf ] shows the assumed observational characteristics of the simulated maps .",
    ".technical characteristics of the 9 simulated planck channels .",
    "column two lists the fwhm assuming a gaussian beam .",
    "column three shows the pixel size in arcmin adopted in our simulations . in column four the instrumental noise variance per pixel",
    "is given in @xmath52 units ( thermodynamic temperature ) . [ cols=\"^,^,^,^ \" , ]     the @xmath88 s for the cmb simulation were generated using the cmbfast code @xcite for a spatially - flat @xmath89cdm universe with @xmath90 and @xmath91 ( gaussian realisation ) .",
    "the simulated galactic emission includes four components : thermal dust , spinning dust , free - free and synchrotron .",
    "the details of the galactic foreground simulations are identical to those described in @xcite ( see references therein ) .",
    "the extragalactic point source simulations come from the model of @xcite for a gaussian realisation with the same cosmological parameters used for the cmb simulation .",
    "synthetic clusters were simulated using the spatial profile @xmath92 the previous profile is a modification of the basic multiquadric profile in which @xmath93 takes the role of the core radius of the cluster and @xmath94 is a limiting cut scale that can be associated with the virial radius of the clusters .",
    "for @xmath95 the profile in eq .",
    "( [ eq : cluster_profile ] ) behaves like the classical @xmath56 model ( with @xmath96 ) whereas for @xmath97 the profile quickly drops to zero . the profile in eq .",
    "( [ eq : cluster_profile ] ) is continuous , gives a good approximation for the typical cluster profile and is well - behaved in fourier space . for this work we used @xmath98 .      given a set of maps corresponding to the simulations described above for the nine planck frequencies , it is easy to estimate the values of the cross - power matrix @xmath35 and therefore to calculate the values of integrals @xmath73 , @xmath56 and @xmath74 for this case . doing so , we obtain the values @xmath99 according to these numbers and eqs .",
    "( [ eq : variance_ummft ] ) and ( [ eq : variance_ummfk ] ) we should expect that after using the filters @xmath100 and @xmath101 the filtered maps should have variances @xmath102 and @xmath103 , in @xmath52 units .",
    "let us remember that for the case of the classical matched multifilters the expected variances of the filtered maps should be @xmath104 and @xmath105 , respectively .",
    "then the addition of the bias cancellation constraint in the formulation of the ummf leads to a small increment of the variance of the filtered maps , but a very small one indeed .    on the other hand , from equations ( [ eq : filtered_map_mmft ] ) and ( [ eq : bias_mmfk ] ) it is possible to calculate the expected biases that will arise with the standard mmf .",
    "let us denote the estimation of a quantity @xmath106 with the standard mmf as @xmath107 .",
    "we have for the case of the planck simulations that @xmath108 depending on the value of @xmath60 , some of the previous quantities can be considerable .",
    "typical values are @xmath109 , and therefore we find that for the case of the thermal effect the bias will be negligible ( @xmath110 ) whereas for the kinematic effect the bias is huge ( @xmath111 ) and can not be discarded . _ standard mmf for the estimation of the kinematic sz effect is strongly biased_.    the expected errors in the estimation of the amplitudes of the thermal and kinematic effects by means of the multifilters is directly related to the variances of the filtered map calculated above . note that in the case of planck the variances in the maps filtered with `` kinematic - type '' multifilters ( both @xmath101 filters and mmfk ) are higher than the variances for the `` thermal - type '' multifilters .",
    "that is bad news .",
    "it implies that the detection and estimation of the kinematic effect by means of multifilters is difficult not only due to the faintness of the effect , but also to the relatively high intrinsic variance of the filtered map .      in order to test whether the numbers obtained above are correct or not we ran a set of simulations , including synthetic clusters with the profile ( [ eq : cluster_profile ] ) and the frequency law ( [ eq : data_model_both_vectorial ] ) .",
    "we simulated 5000 of these clusters . in order to avoid cluster overlapping only five cluster per simulated sky map",
    "were included .",
    "for this test , we simulated very bright and big clusters , with fixed parameters @xmath112 arcmin , @xmath113 and @xmath114 .",
    "for a temperature of the electrons @xmath115 kev that value of @xmath60 corresponds to a velocity along the line of sight of @xmath116 .",
    "the simulations were filtered with standard matched multifilters designed for the detection / estimation of both thermal and kinematic sz effects as well as with the @xmath100 and @xmath101 unbiased matched multifilters .",
    "we will focus here in the performance of the filters regarding the _ estimation _ of the sz effects .",
    "we will assume that the presence of the clusters is already stablished and their locations well known .",
    "we would like to remark that in a more general situation , where detection must be achieved before estimating the parameters , other sources of systematic bias different from the one discussed in this work may arise due to the detection criterion itself .",
    "for example , if detection is done by looking for local maxima in the images , clusters located in areas where the background is positive will be favoured for detection , and then in the background will not have zero mean _ in the areas where clusters are detected _ , leading to a new source of bias . for a more complete discussion on this , see for example @xcite and @xcite .",
    "these bias depend on the choice of the detection device and their study is out of the scope of this work .",
    "figure  [ fig : fig1 ] shows     parameter using standard mmf for the thermal sz effect .",
    "the true value of @xmath37 is shown with a vertical red line.,width=317 ]    the results of the estimation of @xmath37 for the 5000 simulated clusters using the standard mmf for the thermal sz effect .",
    "the average value of the estimated @xmath37 is @xmath117 and the dispersion around this value is @xmath118 .",
    "the average standard deviation of the filtered maps is , for comparison , @xmath119 .",
    "the value for this quantity that was predicted in section  [ sec : preliminar ] was @xmath120 .",
    "( [ eq : expected_biases ] ) predicts @xmath121 , and the value that is found in the simulations is @xmath122 .",
    "figure  [ fig : fig2 ] shows     parameter using @xmath100 ummf for the thermal sz effect .",
    "the true value of @xmath37 is shown with a vertical red line.,width=317 ]    the results of the estimation of @xmath37 for the 5000 simulated clusters using the unbiased @xmath100 multifilters for the thermal sz effect . the average value of the estimated @xmath37 is @xmath123 and the dispersion around this value is @xmath124 .",
    "the average standard deviation of the filtered maps is , for comparison , @xmath125 .",
    "the value for this quantity that was predicted in section  [ sec : preliminar ] was @xmath126 .",
    "a small bias is present as well in this case , that can be attributed to the finite size of the sample .",
    "hence , for this case both the @xmath100 and the standard mmft multifilters perform similarly well , down to the precision of the simulations .",
    "figure  [ fig : fig3 ] shows     parameter using standard mmf for the kinematic sz effect .",
    "the true value of @xmath60 is shown with a vertical red line.,width=317 ]    the results of the estimation of @xmath60 for the 5000 simulated clusters using the standard mmf for the kinematic sz effect .",
    "the average value of the estimated @xmath60 is @xmath127 and the dispersion around this value is @xmath128 .",
    "the average standard deviation of the filtered maps is , for comparison , @xmath129 .",
    "the value for this quantity that was predicted in section  [ sec : preliminar ] was @xmath130 .",
    "( [ eq : expected_biases ] ) predicts @xmath131 , and the value that is found in the simulations is @xmath132 .",
    "the previous results have been obtained without previous knowledge of @xmath37 , that is , the estimation of @xmath60 for each simulated cluster is obtained by dividing the filtered map at the position of the cluster by the value @xmath133 estimated with the mmft . therefore , the errors in the estimation of @xmath37 do propagate and affect the estimation of @xmath60 .",
    "if we assume that @xmath37 is perfectly known we can use is nominal value ( @xmath134 in this case ) and then we obtain @xmath135 and @xmath136 .",
    "we conclude that the uncertainty on @xmath37 is relatively unimportant in this case .",
    "figure  [ fig : fig4 ] shows     parameter using @xmath101 multifilters for the kinematic sz effect .",
    "the true value of @xmath60 is shown with a vertical red line.,width=317 ]    the results of the estimation of @xmath60 for the 5000 simulated clusters using the @xmath101 multifilters for the kinematic sz effect . the average value of the estimated @xmath60 is @xmath137 and the dispersion around this value is @xmath138 .",
    "the average standard deviation of the filtered maps is , for comparison , @xmath139 .",
    "the value for this quantity that was predicted in section  [ sec : preliminar ] was @xmath140 .",
    "the bias has been very much reduced , and the small deviation from zero can in our opinion be attributed to the limited size of the sample and the large variance of the filtered maps .",
    "if we assume that @xmath37 is perfectly known we can use is nominal value ( @xmath134 in this case ) and then we obtain @xmath141 and @xmath142 . we conclude that the uncertainty on @xmath37 is relatively unimportant in this case as well .      the toy clusters used above have large values of the comptonization @xmath37 and the peculiar velocity .",
    "only a few clusters in the sky are expected to have such large values of these parameters at the same time .",
    "though they serve well for our academic test , it is necessary to determine if the filters are still unbiased in more realistic cases where the cluster parameters take lower values .",
    "we performed two sets of simulations varying the value of @xmath37 and @xmath60 . the same as before , for each value of @xmath37 and @xmath60 we simulated 5000 clusters , only five of them per map .",
    "the core radius was fixed to @xmath143 pixel .",
    "figure  [ fig : fig5 ] shows     parameter using @xmath101 multifilters for different values of the comptonization @xmath37 .",
    "the true value is indicated with an horizontal dotted line.,width=317 ]    how the @xmath60 parameter is estimated when varying the comptonization @xmath37 .",
    "the true value of the velocity parameter was fixed to @xmath144 .",
    "the estimation is unbiased even for low values of @xmath37 .",
    "the error bars grow as @xmath37 decreases , which is not unexpected since @xmath145 .",
    "figure  [ fig : fig6 ] shows     parameter using @xmath101 multifilters for different values of the true value of @xmath60 .",
    "the true value is indicated with a dotted line.,width=317 ]    how the @xmath60 parameter is estimated when fixing @xmath146 and changing the velocity of the cluster .",
    "the velocity can be positive or negative .",
    "the estimation is unbiased for all the considered cases , even for the case @xmath147 .",
    "in this work we have studied the performance of multifilters used to enhance the sunyaev - zeldovich effect signal in cmb maps such as the future planck satellite will obtain .",
    "the aim of multifilters is to boost the cluster signal with respect to the background ( cmb plus other astrophysical sources plus noise ) so that they can be more easily detected and studied .",
    "multifilters can be used alone or as a previous step before more sophisticated data analysis tools are applied to extract the maximum possible amount of information from the data .",
    "a problem arises when two different signals with different frequency dependence but the same spatial profile appear in a given position .",
    "such is the case of the thermal and kinematic sz effects . in that case",
    ", we have shown that standard matched multifilters are intrinsically biased .",
    "this bias can be very strong in the case of the weak kinematic sz effect .",
    "we have designed a family of unbiased matched multifilters that cancellate this bias .",
    "the price paid for this bias cancellation is a small decrease on the gain factor with respect to the standard matched multifilters .",
    "unbiased matched multifilters use the _ a priori _ knowledge on both thermal and kinematic sz effect s frequency dependences simultaneously in order to optimise the accuracy of the estimation .",
    "we have tested the performance of both standard and unbiased matched multifilters using realistic simulations of the nine planck s frequencies .",
    "the simulations contain cmb , the main galactic foregrounds , extragalactic point sources and instrumental noise with the levels expected for the different planck channels . with these simulations",
    "we have shown that standard matched multifilters can estimate the kinematic sz effect with systematic biases much larger than the true value of the effect .",
    "this problem is automatically solved using unbiased matched multifilters .",
    "the results of the numerical tests agree very well with the theoretical expectations .",
    "our tests show that the statistical error bars in the determination of the cluster parameters @xmath37 and @xmath60 ( or , equivalently , the cluster velocity @xmath50 ) are directly related to the standard deviation of the filtered map ; in the case of the thermal sz effect this last quantity does not depend on the intensity of the sz effect but on the properties of the background ( i.e. the cross - power spectrum matrix ) and the shape of the filter ( given by the source and beam profiles ) .",
    "for the planck sky patches here considered and using @xmath100 multifilters , the typical error bars in the determination of @xmath37 are @xmath148 , independently of the value of the comptonization of the clusters , which means that for `` bright '' clusters ( @xmath149 ) individual comptonizations can be determined with errors @xmath150 using the planck satellite and linear multifilters . in the case of the kinematic sz effect , to obtain @xmath60 ( @xmath50 ) it is necessary to divide the filtered map by @xmath37 , so error bars are larger for low comptonizations ( as reflected by figure  [ fig : fig5 ] ) . for clusters",
    "as considered here , with @xmath146 and temperature @xmath115 kev , the @xmath101 multifilters give statistical error bars @xmath151 , that is , @xmath152 km s@xmath153 . the situation becomes worse for fainter clusters .",
    "this means that plank will not be able to tell us the velocities of individual clusters . since @xmath101 multifilters provide an unbiased estimator of the kinematic sz effect it may be possible , however , to determine mean peculiar velocities on large scales by averaging over many clusters . on the other hand , standard matched multifilters would lead to erroneous estimations of mean peculiar velocities due to their intrinsic bias .",
    "one of the strongest traits of linear filtering is that it requires only a small number of assumptions about the data to work .",
    "the multifilters need only three information elements to do their work : the frequency dependence of the sz effects , a reasonable knowledge on the generic cluster profile ( and the instrumental beam at each frequency ) and the cross - power spectra of the different channels background . uncertainties and errors in",
    "the _ a priori _ information must be kept to a minimum and , when present , they should be taken into account . in the following",
    "we will discuss briefly some of the expected problematics that will arise in real life clusters , and suggest a few ways to deal with them .",
    "the frequency dependence of the thermal and the kinematic sz effects are very well known , so few surprises will come from this direction .",
    "second - order relativistic corrections , however , can play a role , changing the spectral shape of the effects .",
    "in particular , relativistic effects can change the crossover frequency of the thermal sz effect , a region that is fundamental to the detection of the kinematic sz effect",
    ". the sensitivity of planck will be too low to constrain the optical depth of relativistic electrons @xmath154 of individual clusters  @xcite .",
    "for other more sensitive experiments it may be necessary to take this effect into account . the relativistic correction to the thermal sz effect frequency dependence",
    "is given by  @xcite and it is a function of the frequency @xmath155 and the temperature of the electrons in the intracluster gas @xmath43 . the relativistic correction to the kinematic sz effect is due to the lorentz boost to the electrons caused by the bulk velocity , introduces very small spectral distortions on the kinematic sz frequency dependence and for a 10 kev cluster moving at 1000 km s@xmath153the effect is about an 8 @xmath156 of the non - relativistic term .",
    "if @xmath43 is known , the relativistic corrections can be calculated , eqs .",
    "( [ eq : szt_freqdep ] ) and ( [ eq : szk_freqdep ] ) can be correspondingly modified and the method can be used without problems .",
    "if @xmath43 is not known , it can be considered as another quantity to be estimated . in principle , multifilters such as these here described are able to estimate only amplitudes .",
    "however , @xcite showed a way to estimate additional parameters by means of consecutive linear filterings . in that work ,",
    "the additional parameter to be estimated was the core radius ( as we will discuss later ) and the filter under study was the scale - adaptive filter .",
    "it is straightforward to generalise the idea to ummf and other parameters such as the frequency dependence .",
    "the philosophy of the method is as follows : it can be shown that matched filters ( an unbiased matched filters ) give a maximum amplification of the sources when the correlation between the shape of the filter and the shape of the source is perfect . if for example the shape ( profile ) of the source is known except for a scale factor ( such as the core radius ) , we can filter the image with a number of different matched filters with varying core radius parameter , and study how amplification changes with @xmath93 .",
    "the value of the test parameter at which the maximum amplification is obtained will be our estimate of @xmath93 .",
    "the same applies to multifilters : the maximum amplification will be obtained when the frequency dependence assumed for the filter matches the true one .",
    "then , we can pass a set of different multifilters with varying frequency dependences ( in this case , parametrised by different values of @xmath43 ) .",
    "the maximum amplification occurs when the value of @xmath43 of the multifilter coincides with the true one .      for the sake of clarity",
    "we have deliberately kept the examples presented here as very simple , academic tests , at least regarding to our sz cluster simulations . on the other hand , the background simulations cmb , galactic foregrounds , extragalactic point sources and planck instrumental noise levels as well as pixel and beam sizes are very realistic .",
    "the purpose of this is to focus on the effect of the `` contaminants '' rather than the whole problem .",
    "unfortunately , in real life clusters are not so nicely symmetric and we do not have a perfect _ a priori _ knowledge of their spatial profile .",
    "luckily , we neither have a total ignorance about it .",
    "normally we have some previous idea about how clusters look like .",
    "the main uncertainties here are :      clusters of many different sizes do appear in cmb maps . throughout the examples presented in this work we assumed that all the clusters had the same core radius @xmath93 , which was known a priori .",
    "@xcite provided a method to deal with this uncertainty using the scale - adaptive filter on a single map .",
    "the generalization to multifilters is straightforward @xcite .",
    "the basic idea is to filter the maps with a set of different filters varying the @xmath93 parameter and then to look for the maximum gain cluster by cluster . with this method",
    "it is possible to determine the value of @xmath93 with typical errors lower than the pixel size  @xcite .      if instead of the modified multiquadric profile used in eq .",
    "( [ eq : cluster_profile ] ) the cluster has a different profile the matching between the filter and the cluster will not be perfect and the filtering will loose performance",
    ". this will be an important issue in high resolution experiments where the cluster size is much larger than the beam size . in the case of planck",
    "most clusters will be smaller than the beam size and after convolution their observed shapes will be dominated by the beam profile .",
    "therefore , in the case of planck the errors due to profile uncertainties will be small except for a few cases of very extense clusters . for these few extense cluster and for the case of high resolution experiments",
    "we suggest the use of an iterative technique to adaptively fit the true profile of a cluster in an empiric way . starting with a given profile guess such as the one in eq .",
    "( [ eq : cluster_profile ] ) , the shape of the profile can be slowly varied in successive steps , introducing small filter shape perturbations and maximising the signal to noise gain after filtering .",
    "the maximum gain corresponds to the best fit between the profile of the filter and the profile of the cluster .",
    "a method for adaptive shape fitting that could be adapted to this problem has been successfully accomplished in the modelling of gravitational lensing effect due to massive galaxy clusters ( see for example  @xcite ) .",
    "we will explore this possibility in a future work .      in this work we have assumed symmetric circular profiles and beams .",
    "this condition can be relaxed without loss of generality .",
    "if the non - symmetric profile is previously known ( for example thanks to high - resolution observations in x - ray or other wavelengths ) specific non - symmetric filters can be calculated without problem .",
    "if the shape of the cluster is not previously known , an iterative scheme such as the previously mentioned can be attempted .",
    "it is frequent to consider that @xmath43 is constant all along the cluster , which allows us to write nicely the kinematic sz effect as in eq .",
    "( [ eq : szk_freqdep ] ) .",
    "but galaxy clusters are not iso - thermal . as a consequence of this",
    ", cluster parameters derived through the observation of sz effect will be affected .",
    "@xcite has shown that peculiar velocities will be systematically shifted by @xmath157 if the inner structure of the cluster is not considered in detail , which requires either observationally expensive x - ray observations or high angular resolution sz observations .",
    "the background power spectrum can usually be estimated directly from the data .",
    "this is a safe practise if sz clusters contribution to the total power spectrum is relatively small .",
    "such is the case expected for the planck mission .",
    "if the sz clusters were so strong that they contributed significantly to the total power spectrum at all the scales , they would be so conspicuous that detection would not be a problem , and multifiltering would not be necessary .",
    "historically , extragalactic point sources have been the strongest source of contamination in sz observations . in this work",
    "we have included realistic point source simulations using the  @xcite model , whose predictions for the radio source counts have been recently confirmed by the wmap mission  @xcite .",
    "we have shown that multifilter estimation is not substantially affected by these point sources .",
    "there are however two details that have not been included in the simulations and can affect the estimation of cluster parameters : the intrinsic galaxy clustering and the spatial correlation between individual galaxies and galaxy clusters .",
    "we used the point sources of the  @xcite model assuming a uniform poisson distribution of galaxies in the sky . in the real sky , however , galaxies are spatially correlated due to clustering .",
    "temperature fluctuations due to unresolved point sources are stronger if clustering is considered .",
    "apart from increasing the error bars ,  @xcite have shown that this effect leads to significant systematic errors in the determination of the thermal and kinematic sz amplitudes by means of the sasz method  @xcite .",
    "it is not clear how galaxy clustering will affect the multifiltering method presented in this work .",
    "if the correlation scale of the galaxies is similar to the cluster size systematic shifts can occur , but if the unresolved galaxies fluctuation field is not correlated with the positions of the clusters the effect should be small .",
    "this is a problem worth to study in future works .",
    "another factor not considered in the simulations is the associations between clusters and individual galaxies .",
    "these associations can be due to the galaxies that form part of the cluster or to gravitational lensing , that increases the number of faint galaxies that are observed in the direction of the cluster through magnification effects .",
    "emission from such galaxies can fill in the sze decrement , leading to a wrong estimation of the effect .",
    "galaxies inside the cluster are likely to affect the estimation of sz effect at high frequencies while gravitational lensing effect is expected to be an issue for frequencies @xmath158 ghz  @xcite .",
    "the solution to this problem is increasing the resolution of the observations so that individual galaxies can be detected an accounted for ; in low - resolution experiments such as planck this will not be possible .",
    "the different frequency dependence of the sz effect and galaxy emission will help to reduce contamination , but some residual effects will remain that can lead to additional unavoidable biases .",
    "we remark that the method presented in this work is not incompatibly with other sz detection and estimation techniques .",
    "linear filtering is an useful tool that can be used alone or as a step inside a more ambitious analysis of the data .",
    "the filters here introduced are computationally fast , robust , efficient and unbiased .",
    "they reduce the contamination due to noise and other astrophysical emission and optimise the separation between the thermal and the kinematic effect using all the frequency channels available ( and not only the channels around the thermal crossover frequency ) . in the context of the future planck mission ,",
    "the implementation of the filters is straightforward , but due to the limitations on angular resolution and sensitivity the kinematic sz effect will be badly determined .",
    "experiments with more sensitivity and angular resolution will be much better for the detection of this elusive effect , but the implementation of the filters will require much more care since the inner structure of the clusters will reveal its complexity .",
    "we have hinted in the discussion some ways to deal with this complexity ; applications to specific cases will be addressed in future works .",
    "the authors thank patricio vielva for useful suggestions .",
    "dh acknowledges support from the european community s human potential programme under contract hprn - ct-2000 - 00124 , cmbnet , and the instituto de fsica de cantabria for the hospitality during several research stays in 2003 .",
    "rbb thanks the spanish ministerio de ciencia y tecnologa and the universidad de cantabria for a ramn y cajal contract .",
    "mc acknowledges support from the spanish ministerio de educacin for a doctoral fpi fellowship .",
    "we thank feder project 1fd97 - 1769-c04 - 01 , spanish dgesic project pb98 - 0531-c02 - 01 and intas project intas - open-97 - 1192 for partial financial support ."
  ],
  "abstract_text": [
    "<S> in this work we study the performance of linear multifilters for the estimation of the amplitudes of the thermal and kinematic sunyaev - zeldovich effects . </S>",
    "<S> we show that when both effects are present , estimation of these effects with standard matched multifilters is intrinsically biased . </S>",
    "<S> this bias is due to the fact that both signals have basically the same spatial profile . </S>",
    "<S> we find a new family of multifilters related to the matched multifilters that cancel this systematic bias , hence we call them unbiased matched multifilters </S>",
    "<S> . we test the unbiased matched multifilters and compare them with the standard matched multifilters using simulations that reproduce the future planck mission s observations . </S>",
    "<S> we find that in the case of the standard matched multifilters the systematic bias in the estimation of the kinematic sunyaev - zeldovich effect can be very large , even greater than the statistical error bars . </S>",
    "<S> unbiased matched multifilters cancel effectively this kind of bias . in concordance with other works in the literature , </S>",
    "<S> our results indicate that the sensitivity and resolution of planck will not be enough to give reliable estimations of the kinematic sunyaev - zeldovich of individual clusters . </S>",
    "<S> however , since the estimation with the unbiased matched multifilters is not intrinsically biased , it can be possible to use them to statistically study peculiar velocities in large scales using large sets of clusters .    </S>",
    "<S> [ firstpage ]    methods : data analysis  techniques : image processing  galaxies : clusters  cosmic microwave background </S>"
  ]
}