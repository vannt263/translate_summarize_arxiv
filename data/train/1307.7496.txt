{
  "article_text": [
    "the interaction of acoustic or electromagnetic waves with structured , periodic materials is often complicated by the fact that the scattering geometry involves domains where multiple media meet at a single point .",
    "examples include the design of diffraction gratings , the development of high efficiency solar cells , and non - destructive optical inspection in semiconductor manufacturing ( metrology ) @xcite .",
    "the geometry of a typical scattering problem is shown in fig .",
    "[ fig - geom1 ] .    , that for the trapezoidal - shaped scatterers is @xmath0 and that of the two layers beneath are @xmath1 and @xmath2 , respectively .",
    "we assume that the lowest interface ( here between the @xmath1 and @xmath2 layers ) is located at @xmath3 and that the maximum height of the scatterers is at @xmath4 .",
    "we also assume that the unit cell is centered at @xmath5 .",
    "the bottom layer is assumed to be infinite in extent.,width=384 ]    for the sake of concreteness , we will assume throughout this paper that the governing equations are the maxwell equations in two dimensions ( here , the @xmath6 plane ) .",
    "we also assume the incident wave is in tm - polarization @xcite and that each of the constituent materials is locally isotropic with constant permittivity @xmath7 and permeability @xmath8 . in this case , the maxwell equations are well - known to take the simpler form @xmath9 with @xmath10 here , @xmath11 , where we have assumed a time - dependence of @xmath12 with @xmath13 the frequency of interest .    using the language of scattering theory",
    ", we let @xmath14 where @xmath15 is a known incoming field , @xmath16 and @xmath17 is the unknown scattered field . at material interfaces , @xmath18 =   0   \\quad & \\rightarrow\\quad \\left[u \\right ] = -\\left[u^{{\\mbox{\\tiny in}}}\\right ]   \\\\ \\label{dielecbc2 } \\left[\\frac{1}{\\mu } \\frac{\\partial e}{\\partial \\nu } \\right ] =   0 \\quad & \\rightarrow\\quad \\left[\\frac{1}{\\mu } \\frac{\\partial u}{\\partial \\nu } \\right ] = -\\left[\\frac{1}{\\mu } \\frac{\\partial u^{{\\mbox{\\tiny in}}}}{\\partial \\nu}\\right ] \\",
    ", , \\end{aligned}\\ ] ] where @xmath19 denotes the normal direction and @xmath20 $ ] denotes the jump in the quantity @xmath21 across an interface . for simplicity",
    ", we will assume @xmath22 and @xmath7 is distinct in each domain .",
    "the essential difficulties that we wish to address are manifested in that setting , so we ignore other variants of the scattering problem without loss of generality .",
    "scattering problems of the type illustrated in fig .",
    "[ fig - geom1 ] are often called _ quasi - periodic _ since the obstacles are arrayed periodically , but the incoming , scattered and total field experience a phase change in traversing the unit cell : @xmath23 where @xmath24 .",
    "( in this convention , normal incidence corresponds to @xmath25 . )    in the @xmath26-direction , to obtain a well - posed problem , the scattered field @xmath27 must satisfy a somewhat involved radiation condition @xcite - namely that it takes the form of rayleigh ",
    "bloch expansions @xmath28 assuming , as in fig .  [ fig - geom1 ] , that the lowest interface lies at @xmath3 and that @xmath29 is the maximum extent of the scatterers . in this formula , @xmath30 , in order to satisfy the quasi - periodicity condition .",
    "letting @xmath31 enforces that the expansion satisfy the homogeneous helmholtz equation in the upper half - space , while letting @xmath32 enforces that the expansion satisfy the homogeneous helmholtz equation in the lower half - space with wavenumber @xmath33 ( @xmath2 in fig .",
    "[ fig - geom1 ] ) .    above the scatterers in the unit cell ( @xmath34 ) , note that if @xmath35 , then @xmath36 is real and the waves in the rayleigh - bloch expansion ( [ e : rbu ] ) are _ propagating _ modes . if @xmath37 , then @xmath36 is imaginary and the corresponding modes are called _",
    "evanescent_. they do not contribute to the far field .    the complex coefficients @xmath38 for propagating modes in the rayleigh - bloch expansion are known as the _ bragg diffraction amplitudes at the grating orders_.    for each fixed @xmath39 and @xmath40 , there is a discrete set of frequencies @xmath41 for which some @xmath36 may vanish , at which point the rayleigh - bloch mode is constant in the @xmath26-direction .",
    "such modes are called _",
    "wood s anomalies_. ( there is also a discrete set of frequencies where the solution is nonunique , due to guided modes which propagate along the grating .",
    "the latter are , in a certain sense , nonphysical and we refer the interested reader to @xcite for further discussion . )    in this paper , we present an integral equation method and a corresponding fast direct solver for scattering problems of the type discussed above .",
    "we make use of the _ quasi - periodic green s function _ , which requires only a discretization of the dielectric interfaces within the unit cell . in a recent paper , gillman and barnett",
    "@xcite address the same problem using a slightly different formulation with a different approach to imposing quasi - periodicity .",
    "we will discuss the relative advantages of the two approaches in section [ sec : conclusions ] .",
    "a classical approach to the calculation of quasi - periodic scattering is based on using the green s function that satisfies the desired conditions ( [ qpcond ] ) , ( [ e : rbu ] ) , and ( [ e : rbd ] ) @xcite .",
    "this is accomplished by constructing a one - dimensional array of suitably  phased \" copies of the free - space green s function for the helmholtz equation with wavenumber @xmath42 .",
    "more precisely , the quasi - periodic green s function is defined by @xmath43 where @xmath44 is the outgoing hankel function of order zero .",
    "it is clear that the sum formally satisfies the condition ( [ qpcond ] ) .",
    "the rayleigh - bloch conditions ( [ e : rbu ] ) , ( [ e : rbd ] ) follow from fourier analysis and the fact that @xmath44 itself satisfies the sommerfeld radiation condition .",
    "unfortunately , the series in ( [ e : gqp ] ) is only conditionally convergent for real @xmath42 . to obtain a physically meaningful limit",
    ", one adds a small amount of dissipation ( @xmath45 ) and considers @xmath46 .",
    "( see @xcite for a more detailed discussion ) .",
    "we define the `` near field '' of the quasi - periodic green s function by @xmath47 } e^{im\\alpha d } h_0^{(1)}(k|{{\\mathbf x}}-(md,0)| ) \\label{e : gqpn}\\ ] ] and the `` smooth '' part of the quasi - periodic green s function by @xmath48 } } e^{im\\alpha d } h_0^{(1)}(k|{{\\mathbf x}}-(md,0)| ) \\ , .",
    "\\label{e : gqpr}\\ ] ] the latter is a smooth solution to the helmholtz equation within the unit cell centered at the origin ( see fig .  [ fig - geom1 ] ) and can be expanded in a bessel series @xmath49 in the low frequency regime , where the unit cell is on the order of a few wavelengths or smaller , the bessel series converges rapidly so long as the @xmath26-component of the target point @xmath50 is less than @xmath40 . for larger values of @xmath26",
    "it is more convenient to switch representations and use the rayleigh - bloch expansion ( [ e : rbu ] ) directly .",
    "an analytic formula for the coefficients @xmath51 of the bessel expansion ( [ jexp ] ) can be obtained from the graf addition theorem ( * ? ? ?",
    "9.1.79 ) : @xmath52 } } e^{im\\alpha d } h_n(k|md| ) ( -1)^{n \\cdot \\rm{signum}(m)}\\ ] ] these coefficients are known as _ lattice sums _ and depend only on the parameters @xmath53 .",
    "most numerical schemes for the rapid evaluation of the quasi - periodic green s function are based on the evaluation of @xmath54 } e^{im\\alpha d } h_0^{(1)}(k|{{\\mathbf x}}-(md,0)| ) + \\sum_{n=-\\infty}^{\\infty } s_n j_n(k|{{\\mathbf x}}|),\\ ] ] combining ( [ e : gqpn ] ) and ( [ jexp ] ) .",
    "there is a substantial literature on efficient methods for computing the lattice sums themselves ( see , for example , @xcite ) . in this paper",
    "we use a scheme based on asymptotic analysis and the euler - maclaurin formula @xcite .",
    "since there are a number of effective schemes for this step , we omit further discussion except to note that    1 .   the quasi - periodic green s function fails to exist at wood s anomalies 2 .",
    "if the scattering structure in the unit cell has a high aspect ratio @xmath55 , then the lattice sum approach is inconvenient because more images need to be added to @xmath56 in order to ensure convergence of the bessel expansion for @xmath57 .",
    "we refer the reader to @xcite for a method capable of handling both these difficulties . here , we assume that @xmath58 is well - defined and that the aspect ratio @xmath59 is less than or equal to 1 .",
    "in the absence of triple - points , a number of groups have developed high - order accurate integral equation methods for scattering from periodic structures ( see , for example , @xcite ) .",
    "for this , suppose that we have a single scatterer @xmath60 in the unit cell , with helmholtz parameter @xmath0 and boundary @xmath61 .",
    "in the context of fig .  [ fig - geom1 ] , this would correspond to an absence of the layered substrate ( that is , @xmath62 ) , with @xmath60 an isolated trapezoidal - shaped scatterer .",
    "one can then use the representation @xmath63({{\\mathbf x } } ) + { { { \\cal d}}}^{k_1}[\\gamma,\\mu]({{\\mathbf x } } ) & \\mbox{in } \\omega\\\\ { { { \\cal s}}}^{k_0}_{{\\mbox{\\tiny qp}}}[\\gamma,\\sigma]({{\\mathbf x } } ) + { { { \\cal d}}}^{k_0}_{{\\mbox{\\tiny qp}}}[\\gamma,\\mu]({{\\mathbf x } } ) & \\mbox{in } u\\setminus\\overline{\\omega } \\end{array}\\right .",
    "\\label{e : qprep}\\ ] ] where @xmath64 and @xmath65 denote the usual single and double layer operators @xcite @xmath66({{\\mathbf x } } ) & = & \\int_\\gamma g^{k}({{\\mathbf x}}-{{\\mathbf y } } ) \\sigma({{\\mathbf y } } ) ds_{{\\mathbf y}}\\label{e : s } \\\\ { { { \\cal d}}}^{k}[\\gamma,\\mu]({{\\mathbf x } } ) & = & \\int_\\gamma \\frac{\\partial g^{k}}{\\partial \\nu_{{\\mathbf y}}}({{\\mathbf x}}-{{\\mathbf y } } ) \\mu({{\\mathbf y } } ) ds_{{\\mathbf y}}\\ , .",
    "\\label{e : d}\\end{aligned}\\ ] ] with @xmath67 .",
    "the quasi - periodic layer potentials @xmath68 and @xmath69 are simply defined by replacing the free - space green s function @xmath70 with @xmath71 . here",
    "@xmath72 indicates that we are integrating in arclength on @xmath61 , and @xmath73 denotes the outward normal at @xmath74 .",
    "we will also need the normal derivatives of @xmath75 and @xmath76 at a point @xmath77 , defined by @xmath78 the periodic versions @xmath79 and @xmath80 are defined in the same manner .",
    "note that by construction , the governing helmholtz equation is satisfied in each domain .",
    "note also that we have only chosen to use the quasi - periodic layer potentials in the exterior domain @xmath81 . in the context of fig .",
    "[ fig - geom1 ] , we will use the quasi - periodic layer potentials for the @xmath82 , @xmath1 and @xmath2 domain and the standard layer potentials for the @xmath0 domain .",
    "@xmath83 is weakly singular as @xmath84 , and the integral is well - defined . for @xmath85 and @xmath86 ,",
    "the limiting value depends on the side of @xmath61 from which @xmath50 approaches the curve . for @xmath87 , we assume both are defined in the principal value sense .",
    "the operator @xmath88 is _ hypersingular _ and unbounded as a map from the space of smooth functions on @xmath61 to itself .",
    "it should be interpreted in the hadamard finite part sense .",
    "substituting the representation ( [ e : qprep ] ) into the interface conditions ( [ dielecbc1 ] ) , ( [ dielecbc2 ] ) and taking the appropriate limits yields the system of integral equations    [ grpb ] @xmath89 + ( { { \\cal d}_{{\\mbox{\\tiny qp}}}}^{k_0}(\\gamma_,\\mu ) - { { \\cal d}}^{k_1}(\\gamma,\\mu))[{{\\mathbf x } } ] = - \\left[u^{{\\mbox{\\tiny in}}}({{\\mathbf x } } ) \\right ] \\label{ib1}\\\\ -\\sigma({{\\mathbf x } } ) & +   ( { { \\cal n}_{{\\mbox{\\tiny qp}}}}^{k_{0}}(\\gamma,\\sigma ) - { { \\cal n}}^{k_{1}}(\\gamma,\\sigma))[{{\\mathbf x } } ] + ( { { \\cal t}_{{\\mbox{\\tiny qp}}}}^{k_{0}}(\\gamma,\\mu ) - { { \\cal t}}^{k_{1}}(\\gamma,\\mu))[{{\\mathbf x } } ] = - \\left [ \\frac{\\partial u^{{\\mbox{\\tiny in}}}}{\\partial \\nu}({{\\mathbf x } } ) \\right ] \\label{ib2}\\end{aligned}\\ ] ]    for the unknowns @xmath90 $ ] .",
    "a critical feature of the system ( [ ib1 ] ) , ( [ ib2 ] ) is that , while @xmath91 itself is hypersingular , only the _ difference _ of hypersingular kernels appears in the equations .",
    "all the operators appearing above are compact on smooth domains and we have a system of fredholm equations of the second kind , for which the formal theory is classical @xcite and the solution is unique .",
    "the cancellation of hypersingular terms in this manner was introduced in electromagnetics by mller @xcite , and in the scalar case by kress , rokhlin , haider , shipman and venakides @xcite .    for smooth domains ,",
    "the issue of quadrature has been satisfactorily resolved , so that high order accuracy is straightforward to achieve @xcite .",
    "the generalized gaussian quadrature method of @xcite , for example , permits the use of composite quadrature rules that take into account the singularity of the green s function and can be stored in tables that do not depend on the curve geometry .",
    "assuming the boundary component @xmath61 is subdivided into @xmath92 curved panels with @xmath42 points on each panel , these rules achieve @xmath42-th order accuracy .",
    "more precisely , each integral operator @xmath93 is replaced by a sum of the form @xmath94 where @xmath95 is the @xmath96-th gauss - legendre node on panel @xmath97 , @xmath98 is the @xmath99-th gauss - legendre node on panel @xmath100 , @xmath101 is a quadrature weight and @xmath102 is a  quadrature kernel \" .    for nonadjacent panels ,",
    "@xmath102 is simply the original kernel @xmath103 . for the interaction of a panel with itself or its two nearest neighbors ,",
    "the quadrature kernel is produced by a somewhat involved interpolation scheme according to the generalized gaussian quadrature formalism @xcite . from a linear algebra perspective",
    ", generalized gaussian quadrature can be viewed as producing a block tridiagonal matrix ( with block size @xmath104 ) of interactions of each panel with itself and its two neighbors .",
    "these are computed directly .",
    "all other block matrix interactions are obtained using standard gauss - legendre weights @xmath105 scaled to the dimensions of the @xmath100-th source panel .",
    "this structure of the far - field interactions permits the straightforward use of fast multipole acceleration and the hierarchical direct solver of @xcite .    in domains with corners , but not multi  material junctions ,",
    "exponentially adaptive grids maintain high - order accuracy ( see , for example @xcite ) . in the simplest version",
    ", one can first divide the boundary into equal size subintervals and employ a @xmath42-th order generalized gaussian quadrature rule on each . for each segment that impinges on a corner point , one can further subdivide it using a dyadically refined mesh , creating @xmath106 additional subintervals , where @xmath107 is a specified numerical precision .",
    "if the same @xmath42-th order rule is used for each refined subinterval , it is straightforward to show that the resulting rule has a net error of the order @xmath108 .",
    "the need for dyadic refinement comes from the fact that the densities @xmath109 or @xmath8 may develop singularities at the corner points and the refinement yields a high order piecewise polynomial approximation of the density . for @xmath110 and @xmath111 ,",
    "the net corner error is about @xmath112 while for @xmath113 , it is about @xmath114 ( see fig .",
    "[ figskel ] for an illustration ) .    in recent work , @xcite have shown that one can dramatically reduce the number of degrees of freedom in the vicinity of the corner by the use of compression , as well .",
    "we have not used such optimization here .",
    "it is now appreciated ( see , for example , @xcite ) that the condition number of a properly discretized system of equations is very well controlled . following discretization ,",
    "we use bremer s approach @xcite here , which involves setting the discrete variables to be @xmath115 and @xmath116 , rather than the density values @xmath117 and @xmath118 themselves .",
    "this ensures that that spectrum of the discrete system approximates the spectrum of the continuous integral equation in @xmath119 .",
    "the formal analysis is somewhat involved , since operators that are compact on smooth domains are only bounded ( but not compact ) on domains with corners .",
    "we refer the reader to @xcite for details .",
    "in the case of multiple subdomains , a natural approach would be to represent the field in each subdomain @xmath120 with helmholtz coefficient @xmath121 in terms of layer potentials on the boundary @xmath122 of @xmath120 .",
    "that is , in subdomain @xmath120 , we would represent the solution as @xmath123({{\\mathbf x } } ) + { { { \\cal d}}}^{k_i}[\\gamma_i,\\mu]({{\\mathbf x } } ) \\label{e : qprepi}\\ ] ] with @xmath64 and @xmath65 replaced by their quasi - periodic counterparts for subdomains that extend across the unit cell ( the @xmath82 , @xmath1 , and @xmath2 domains in fig .",
    "[ fig - geom1 ] ) .    in doing so , it turns out that the analog of equations ( [ ib1],[ib2 ] ) fails to converge in the presence of multi - material junctions .",
    "the reason for this is simple , and analyzed in @xcite . consider the interface condition ( [ ib2 ] ) for @xmath124 lying on the segment @xmath125 in fig .",
    "[ figskel ] . restricting our attention just to the segments impinging on the corner point @xmath126 , we have @xmath127 +   { { \\cal n}_{{\\mbox{\\tiny qp}}}}^{k_{0}}(\\overline{ae},\\sigma,{\\mathbf x } ) -   { { \\cal n}}^{k_{1}}(\\overline{ad},\\sigma,{\\mathbf x } ) \\ + \\",
    "\\dots \\hspace{.3 in }   \\nonumber \\\\ + \\left [ { { \\cal t}_{{\\mbox{\\tiny qp}}}}^{k_{0}}(\\overline{ab},\\mu,{\\mathbf x } ) -   { { \\cal t}}^{k_{1}}(\\overline{ab},\\mu,{\\mathbf x } ) \\right ] +   { { \\cal t}_{{\\mbox{\\tiny qp}}}}^{k_{0}}(\\overline{ae},\\mu,{\\mathbf x } ) -   { { \\cal t}}^{k_{1}}(\\overline{ad},\\mu,{\\mathbf x } ) \\ + \\ \\dots = - \\left [ \\frac{\\partial u^{{\\mbox{\\tiny in}}}}{\\partial \\nu}({{\\mathbf x } } ) \\right ] \\label{ib2a}\\end{aligned}\\ ] ] note that both the terms @xmath128 and @xmath129 involve hypersingular contributions at the junction @xmath126 without forming part of a difference kernel .",
    "this destroys the high - order accuracy of the scheme .    by using a global integral representation ,",
    "it was shown in @xcite that high - order accuracy can be restored .",
    "that is , instead of ( [ e : qprepi ] ) , we let @xmath130({{\\mathbf x } } ) + { { { \\cal d}}}^{k_i}[\\gamma,\\mu]({{\\mathbf x } } ) \\label{e : qprepall}\\ ] ] and apply the continuity conditions . for @xmath131 lying on an interface between subdomains with helmholtz coefficients @xmath121 and @xmath132 , we have    [ grpc ] @xmath133 \\label{ic1}\\\\ - \\sigma({\\mathbf x } ) & +   { { \\cal n}}^{k_{i}}(\\gamma,\\sigma,{\\mathbf x } ) -   { { \\cal n}}^{k_{j}}(\\gamma,\\sigma,{\\mathbf x } ) +   { { \\cal t}}^{k_{i}}(\\gamma,\\mu,{\\mathbf x } ) -   { { \\cal t}}^{k_{j}}(\\gamma,\\mu,{\\mathbf x } ) = - \\left [ \\frac{\\partial \\phi^{{\\mbox{\\tiny in}}}}{\\partial \\nu}({\\mathbf x } ) \\right ] \\label{ic2}\\end{aligned}\\ ] ]    as above , the operators @xmath64 , @xmath65 , @xmath134 , @xmath91 are replaced by their quasi - periodic counterparts for subdomains that extend across the unit cell ( the @xmath82 , @xmath1 , and @xmath2 domains in fig .",
    "[ fig - geom1 ] ) .",
    "the global representation ( [ e : qprepall ] ) is  non - physical \" in the sense that the field in a given subdomain is determined , in part , by layer potential components that are not actually part of the subdomain s boundary . by doing so , however , we remove all hypersingular terms from the integral equation .",
    "only difference kernels appear in the final linear system .",
    "one could improve efficiency somewhat , while achieving similar results , by supplementing the representation ( [ e : qprepi ] ) only by the boundary segments that actually impinge on a multi - material junction .",
    "we use the fully global representation in our experiments here for the sake of simplicity .    for related approaches addressed at solving problems with multi - material junctions , see @xcite .",
    "given a well - conditioned and high order discretization , large scale scattering problems in singular geometries can be solved by using fast multipole - accelerated iterative solution methods such as gmres @xcite .",
    "while these are asymptotically optimal schemes , one is often interested in modeling the interaction of a given physical structure ( such as the geometry in fig .",
    "[ fig - geom1 ] ) with a large number of incoming fields .",
    "this requires the solution of an integral equation with multiple right - hand sides , and standard iterative methods do not take maximal advantage of this fact .",
    "direct solvers , on the other hand , first construct a factorization of the system matrix , then solve against each right - hand side using that factorization at a cost that is typically much lower . in the last decade ,",
    "specialized versions have been created which are particularly suited to the integral equation environment .",
    "this is an active area of research and we do not seek to review the literature , except to note selected important developments in the case of hierarchically semiseparable matrices @xcite , @xmath135-matrices @xcite , and hierarchically block separable matrices @xcite .",
    "we provide a brief description of the approach , following the presentation of @xcite .",
    "let @xmath136 be the matrix discretization of an integral equation such as ( [ grpc ] ) , and let its indices @xmath137 be ordered hierarchically according to a quadtree on the unit cell .",
    "this can be done by first enclosing the set of all associated points within a sufficiently large box .",
    "if the box contains more than a specified number of points , it is subdivided into four quadrants and its points distributed accordingly between them .",
    "this procedure is repeated for each new box added , terminating only when all boxes contain @xmath138 points .",
    "the boxes that are not subdivided are called _",
    "leaf boxes_. for simplicity , we assume that all leaf boxes live on the same level of the tree , but this restriction can easily be relaxed .",
    "start at the bottom of the tree and consider the partitioning induced by the leaves .",
    "let @xmath100 be the number of leaf boxes and assume that each has @xmath139 points so that @xmath140",
    ". then @xmath141 has the block form @xmath142 for @xmath143 .",
    "we now use the _ interpolative decomposition _ ( i d ) @xcite to skeletonize @xmath141 .",
    "the i d is a matrix factorization that rewrites a given low - rank matrix in terms of a subset of its rows or columns , called _",
    "skeletons_. in the integral equation setting , the off - diagonal block rows @xmath144",
    "\\label{eq : block - row}\\ ] ] are low - rank due to the smoothness of the green s function , and the same is true of the off - diagonal block columns .",
    "thus , it can be shown @xcite that the i d enables a representation of the form @xmath145 for each off - diagonal block , where @xmath146 , @xmath147 , and @xmath148 is a submatrix of @xmath149 , with @xmath150 .",
    "the matrix can then be written as @xmath151 where @xmath152 \\in \\mathbb{c}^{n \\times n }   \\ , , \\ ] ] @xmath153 \\in \\mathbb{c}^{n \\times k } , \\qquad { \\mathsf{r}}= \\left [ \\begin{array}{ccc } { \\mathsf{r}}_{1 } & & 0 \\\\ & \\ddots\\\\ 0 & & { \\mathsf{r}}_{p } \\end{array } \\right ] \\in \\mathbb{c}^{k \\times n}\\ ] ] are block diagonal with @xmath154 , and @xmath155 \\in \\mathbb{c}^{k \\times k}\\ ] ] is dense with zero diagonal blocks .",
    "[ rmk : proxy ] the efficient calculation of the interpolation matrices @xmath156 and @xmath157 , and the associated skeleton indices , in ( [ eq : block - separable ] ) is somewhat subtle .",
    "briefly , it involves separating out neighboring and far - field interactions and representing the latter via free - space interactions with a local `` proxy '' surface .",
    "this is justified by the observation that any well - separated interaction governed by a homogeneous partial differential equation ( here , the helmholtz equation ) can be induced by sources / targets on the proxy surface , each of which is expressed in terms of the free - space kernel . for details , see @xcite . in this paper , for a box of scaled size @xmath158 , we use the circle of radius @xmath158 about the box center as its proxy surface .",
    "note that all neighbors are defined relative to the periodicity of the unit cell .    now consider the linear system @xmath159 .",
    "one way to solve it is to construct @xmath160 directly from ( [ eq : compressed - representation ] ) using a variant of the sherman - morrison - woodbury formula .",
    "this approach is taken in @xcite . here , we follow the strategy of @xcite instead and let @xmath161 and @xmath162 to obtain the equivalent _ sparse _ system @xmath163 \\left [   \\begin{array}{c }    { \\mathsf{x}}\\\\    { \\mathsf{y}}\\\\    { \\mathsf{z}}\\end{array } \\right ] = \\left [   \\begin{array}{c }    { \\mathsf{b}}\\\\    0\\\\    0   \\end{array } \\right ] .",
    "\\label{eq : sparse - embedding}\\ ] ] this can be solved efficiently using any standard sparse direct solver and may provide better stability . in this paper , we use the open - source software package umfpack @xcite .",
    "since @xmath164 is a submatrix of @xmath141 ( up to diagonal modifications ) , @xmath164 can itself be expressed in the form ( [ eq : compressed - representation ] ) by moving up one level in the tree and regrouping appropriately .",
    "this leads to a multilevel decomposition @xmath165 where the superscript indexes the tree level @xmath166 with @xmath167 denoting the root .",
    "we call this process _ recursive skeletonization_. the analogue of ( [ eq : sparse - embedding ] ) is @xmath168 \\left [   \\begin{array}{c }    { \\mathsf{x}}^{(\\lambda)}\\\\    { \\mathsf{y}}^{(\\lambda)}\\\\    \\vdots\\\\    { \\mathsf{x}}^{(1)}\\\\    { \\mathsf{y}}^{(1)}\\\\    { \\mathsf{x}}^{(0 ) }   \\end{array } \\right ] = \\left [   \\begin{array}{c }    { \\mathsf{b}}\\\\    0\\\\",
    "\\vdots\\\\    0\\\\    0\\\\    0   \\end{array } \\right ] ,   \\label{eq : multilevel - embedding}\\ ] ] corresponding to expanding @xmath164 out in the same way .",
    "it can be shown that the solver requires @xmath169 work when the unit cell is a moderate number of wavelengths in size .",
    "we refer the reader to @xcite for further discussion .    for our present purposes",
    ", we simply note that the output of the fast direct solver is a _ compressed _ representation of the inverse which is computed in two steps :    1 .   a recursive skeletonization procedure to obtain the compressed forward operator ( [ eq : multilevel - representation ] ) ; and 2 .",
    "a factorization of the sparse matrix embedding in ( [ eq : multilevel - embedding ] ) .",
    "both steps have the same asymptotic complexity , but the constant for compression is typically far larger . after the inverse has been computed , it can be applied to each right - hand side as needed at a much lower cost .",
    "the i d can be constructed to any specified relative precision @xmath107 .",
    "this is an input parameter to recursive skeletonization and hence to the direct solver .",
    "it can be shown that if ( [ eq : multilevel - representation ] ) has relative error @xmath170 , as is often the case numerically , then the algorithm produces a solution with relative error @xmath171 , where @xmath172 is the condition number of @xmath141 .",
    "in particular , if @xmath173 , as for the integral equation ( [ grpc ] ) , then the error is @xmath170 .",
    "[ rmk : in - out ] although we have assumed in the discussion above that each block at the same level has the same size , this is in no way essential to the algorithm . in fact , our code uses separate `` incoming '' ( row ) and `` outgoing '' ( column ) skeletons for each box .",
    "this enables some additional optimization , which , for the present case , can be especially pronounced . this is because while each point receives incoming interactions from only the two wavenumbers on either side of the segment to which it belongs , it sends outgoing interactions consisting of all wavenumbers in the problem .",
    "for example , for a point on the segment @xmath125 in fig .",
    "[ figskel ] , it receives at wavenumbers @xmath174 and @xmath175 but sends at wavenumbers @xmath174 , @xmath175 , and @xmath176 .",
    "therefore , the outgoing skeleton dimension is typically larger , and the amount by which it is larger increases with the total number of wavenumbers / domains .",
    "the fast direct solver of the previous subsection allows the robust and accurate solution of @xmath177 where we have made explicit the dependence of the integral equation ( [ grpc ] ) on the incident angle @xmath178 . in the present setting ,",
    "we are interested in solving ( [ eq : system - angle ] ) for many @xmath178 .",
    "this is not a situation that the direct solver can easily handle since @xmath179 is not fixed . in this subsection ,",
    "we describe a modified strategy for computing a compressed representation ( [ eq : multilevel - representation ] ) of @xmath179 such that it can be rapidly updated to yield a compressed representation of @xmath180 for any @xmath181 _ without having to re - skeletonize_. since skeletonization is typically the most expensive step , this can offer significant computational savings .",
    "the sparse matrix in ( [ eq : multilevel - embedding ] ) must still be updated and re - factored , but the relative cost of this is small .    to see why such a uniform skeletonization might be possible , consider any finite truncation of the periodic geometry so that it consists merely of a very large array of many , many scatterers .",
    "then the governing integral equation is specified in terms of the _ free - space _ green s function so that @xmath141 is independent of @xmath178 .",
    "the only angle dependence comes from the incoming data @xmath182 .",
    "therefore , only one skeletonized representation of @xmath141 is needed for all @xmath178 .",
    "the same is true of any finite approximation to the periodic problem .",
    "we now make this intuition precise by considering all interactions , say , incoming on a given box .",
    "this is given by the off - diagonal block row ( [ eq : block - row ] ) and can be decomposed as @xmath183 in terms of the near- and far - field contributions , respectively , to the quasi - periodic green s function @xmath184 following section [ s : gqp ] .",
    "clearly , an interpolation basis for both terms together provides an interpolation basis for the sum , so @xmath185 can be skeletonized by applying the i d to the rows of the matrix @xmath186.\\ ] ] since @xmath57 consists only of well - separated interactions , by remark [ rmk : proxy ] , @xmath187 can be replaced by a matrix @xmath188 corresponding to free - space interactions with a proxy surface . in linear algebraic terms , this means that @xmath189 can be written as @xmath190 for some matrix @xmath191 .",
    "hence , @xmath192 \\left [   \\begin{array}{cc }    { \\mathsf{i}}\\\\    & { \\mathsf{t}}_{i \\leftarrow } ( \\theta )   \\end{array } \\right ] ,   \\label{eq : a - proxy}\\ ] ] so @xmath193 can be skeletonized by applying the i d to just the left matrix on the right - hand side .",
    "observe that the angular dependence of the far field has been eliminated .    to eliminate the angular dependence of the near field",
    ", we can similarly expand @xmath56 in terms of a @xmath178-independent basis .",
    "this can be done using the functions @xmath194 corresponding to interactions with the self- , left- , and right - images , respectively , with corresponding matrices @xmath195 , @xmath196 , and @xmath197 .",
    "then , from ( [ e : gqpn ] ) , @xmath198 \\left [   \\begin{array}{c }    { \\mathsf{i}}\\\\    e^{-i \\alpha d } { \\mathsf{i}}\\\\    e^{i \\alpha d } { \\mathsf{i}}\\end{array } \\right ] ,   \\label{eq : a - near}\\ ] ] where , recall , @xmath199 , so @xmath185 can be skeletonized by applying the i d to @xmath200 ,   \\label{eq : id - matrix}\\ ] ] which we note has no angular dependence .",
    "thus , the interpolation matrices and skeleton indices resulting from compressing ( [ eq : id - matrix ] ) are valid for all @xmath178 .    the same approach can be used for outgoing interactions and for interactions at each wavenumber .",
    "the result is a modified compressed representation @xmath201 where only the @xmath202 depend on @xmath178 .",
    "therefore , to obtain a compressed representation of @xmath180 for any other @xmath181 , it suffices to perform the update @xmath203 for each @xmath96 .",
    "this , in general , consists only of generating a very small subset of entries of the new matrix and requires @xmath169 work with a small constant .    in summary , the full algorithm for analyzing multiple incident angles with fast updating is :    1 .",
    "compress the matrix @xmath179 for some initial @xmath178 by representing interactions with an angle - independent basis such as ( [ eq : id - matrix ] ) .",
    "this is an expensive recursive skeletonization that only needs to be performed once .",
    "2 .   embed the resulting decomposition ( [ eq : angle - representation ] ) into the sparse matrix of ( [ eq : multilevel - embedding ] ) and solve .",
    "3 .   for each new angle @xmath181 , update the compressed representation ( [ eq : angle - representation ] ) via @xmath204 .",
    "repeat step 2 .    in our tests",
    ", we have often found it unnecessary to decompose @xmath205 as in ( [ eq : a - near ] ) .",
    "instead , we apply the i d to the left matrix on the right - hand side of ( [ eq : a - proxy ] ) , which depends on @xmath178 but seems to yield results that recover angle independence numerically .",
    "this optimization can reduce the constant associated with skeletonization by about a factor of @xmath206 .",
    "the algorithm presented above has been implemented in fortran . each boundary segment ( in the piecewise smooth boundary )",
    "is first divided into @xmath207 equal subintervals .",
    "the first and last intervals are then further subdivided with dyadic refinement toward the corner using @xmath208 subintervals each .",
    "thus , the total number of intervals on each smooth component of the boundary ( each side ) is @xmath209 and the number of points is @xmath210 .",
    "we use the 8th order generalized gaussian quadrature rule of @xcite for logarithmic singularities and solve the integral equations ( [ grpc ] ) using recursive skeletonization @xcite with a tolerance of @xmath211 .",
    "all timing listed below are for a laptop with a 1.7ghz intel core i5 processor .",
    "points each and @xmath206 degrees of freedom per point , resulting in a complex matrix of size @xmath212 .",
    "after skeletonization , there are only @xmath213 points remaining at the coarsest level of the recursion .",
    "[ figskel],width=432 ]    * example 1 : * we set @xmath214 , with @xmath7 chosen so that the helmholtz coefficient in the upper half - space , the trapezoidal scatterer , and the substrate are @xmath215 , @xmath216 , and @xmath217 , respectively .",
    "the incident angle is @xmath218 .",
    "the original matrix of dimension @xmath212 is compressed to one of dimension @xmath219 .",
    "the incoming and outgoing skeleton dimensions are slightly different as explained in remark [ rmk : in - out ] and computed as part of the recursion .",
    "the time for compression in our current implementation was 290 secs .",
    "( while generating the necessary matrix entries required 1219 secs . )",
    ". given the compressed representation , the solution time was 2.46 secs .",
    "the resulting accuracy was approximately @xmath220 .",
    "we plot the real part of the total field in fig .",
    "[ figs1 ] . in fig .",
    "[ figskel ] , we plot both the original set of discretization points and the skeletons that remain at the coarsest level of the recursion .",
    "incidence impinges on a periodic structure .",
    "the unit cell and its first neighbor are shown , with a zoom in the region of the triple - point.,width=432 ]      given our integral representation of the scattered field , it is straightforward to compute the coefficients @xmath38 in ( [ e : rbu ] ) or ( [ e : rbd ] ) - the bragg diffraction amplitudes at the grating orders . for an incident field",
    "@xmath16 we simply let @xmath221 denote some height above the scatterers and rewrite ( [ e : rbu ] ) in the form @xmath222 where @xmath223 .",
    "thus , the @xmath224 can be computed using fourier analysis : @xmath225 the accurate calculation of @xmath38 from this formula depends on ensuring that the discretization in @xmath226 is sufficiently fine to resolve the integrand . in the near field ( when @xmath227 is small ) , the evanescent modes , corresponding to large @xmath139 , are still present in @xmath228 requiring a large number of points to avoid aliasing errors . by making @xmath227 sufficiently large ,",
    "the evanescent modes are suppressed . and",
    "a mesh can be used that resolves only the propagating modes - that is , values of @xmath139 for which @xmath229 .",
    "* example 2 : * we now consider a scattering problem with a two - layered substrate ( fig .",
    "[ fig2layer ] ) .",
    "we again set @xmath214 and choose @xmath7 so that the helmholtz coefficient in the upper half - space , the trapezoidal scatterer , and the two substrate layers are @xmath215 , @xmath216 , @xmath217 and @xmath208 , respectively .",
    "we first set up the scattering problem for an angle of incidence of @xmath218 .",
    "the original matrix is of dimension @xmath230 , which is compressed to one of dimension @xmath231 .",
    "the time for compression was 416.6 secs .",
    "( and for generating the matrix entries , 1762.3 secs . ) .",
    "the time for inversion was 2.9 secs .",
    "the relative error in the solution ( compared with standard lu factorization ) was @xmath232 .",
    "we then changed the angle of incidence to @xmath233 and used the updating method of section [ multangle ] .",
    "the time for updating the compressed forward operator was 68.4 secs.and the relative error in the solution was @xmath234 . in this problem , there are six propagating modes , with directions indicated in fig .  [ scatmodes2 ] .",
    "incidence impinges on a periodic structure with a two - layer substrate .",
    "the unit cell and its first neighbor are shown , with a zoom in the region of the triple - point .",
    "[ fig2layer],width=432 ]    .",
    "the length of the arrows in the various diffraction directions indicate the relative magnitude of the amplitudes @xmath38 .",
    "approximately @xmath235 of the energy is scattered upward .",
    "[ scatmodes2],width=336 ]    * example 3 : * the complexity of the scattering pattern can be quite striking . in fig .  [ hemifig ]",
    "is shown the scattering pattern from a semicircular scatterer with an angle of incidence of @xmath218 .",
    "we set @xmath214 and choose @xmath7 so that the helmholtz coefficient in the upper half - space , the semicircular scatterer and the substrate layer are @xmath236 , @xmath237 , and @xmath238 , respectively .",
    "there are 19 radiation modes at this angle of incidence .    , @xmath239 , @xmath240 and @xmath241 .",
    "only the scatterer in the unit cell is plotted .",
    "the length of the arrows in the various diffraction directions indicate the relative amplitudes @xmath38 .",
    "approximately @xmath242 of the energy is scattered upward .",
    "[ hemifig],width=336 ]    * examples 4 , 5 : * in our final examples , we compute the diffraction pattern across all angles of incidence from @xmath243 to @xmath244 for the scattering geometries depicted in examples 1 and 3 , except that for the trapezoidal - shaped scatterer , we increased @xmath41 by a factor of 3 , so that @xmath245 instead of 10 . for the semicircular scatterer , we decreased @xmath41 by a factor of 3 , so that @xmath246 instead of 30 . on the left - hand side of figs .",
    "[ trapscan ] and [ hemiscan ] are plotted the diffraction orders as a function of incident angle .",
    "that is , for each incident angle @xmath178 , the intersection of the indicated vertical line with the various curves are the _",
    "bragg angles _ @xmath247 according to formula ( [ e : rbu ] ) , where @xmath36 and @xmath248 are chosen to enforce both quasiperiodicity and the helmholtz equation .",
    "the number of intersections of each vertical line on these left - hand plots defines the precise number of modes for a given angle of incidence .",
    "it is easy to see that each of the curves on the left - hand plots traverses the _ incident angle_-_scattered angle _ plane continuously ( until it disappears ) , so that we may enumerate the modes unambiguously from the lower left corner to the upper right corner .",
    "the labels (  10 \" ,  19 \" ,  28 \" ) in fig .",
    "[ trapscan ] are drawn on the 10th , 19th , and 28th such curve .",
    "the labels (  4 \" ,  7 \" ,  10 \" ) in fig .",
    "[ hemiscan ] are drawn on the 4th , 7th , and 10th such curve .",
    "on the right - hand side of figs .",
    "[ trapscan ] and [ hemiscan ] are plotted the fraction of energy radiated into each mode .",
    "the @xmath249th curve in the right - hand plots show the total energy scattered in modes @xmath158 through @xmath249 .",
    "thus , the separation between curves corresponding to modes @xmath249 and @xmath250 shows the fraction of energy radiated in the @xmath249th mode . highlighted in gray are the energies scattered in the 10th , 19th , and 28th modes in fig .",
    "[ trapscan ] and in the 4th , 7th , and 10th modes in fig .",
    "[ hemiscan ] .",
    "note that the strength can change quite abruptly when the incident angle is changed only slightly .    .",
    "( see the text for a discussion of the plots . )",
    "[ trapscan],width=480 ]    .",
    "( see the text for a discussion of the plots . )",
    "[ hemiscan],width=480 ]",
    "we have described an integral equation method for quasi - periodic scattering from layered materials with grating - like structures on the  top \" surface .",
    "it combines ( 1 ) the use of the quasi - periodic green s function , ( 2 ) the modified kress / mller / rokhlin integral equation for multi - material junctions @xcite , ( 3 ) the use of exponential refinement near geometric singularities , @xcite , and ( 4 ) the fast direct solver of @xcite .",
    "since the quasi - periodic green s function changes with each incident angle , there is a global change to the system matrix with each new illumination .",
    "we have shown , however , that the _ difference _ between green s functions at different angles of incidence is ( hierarchically ) smooth so that the compressed representation of the system matrix can be rapidly updated .    in recent work ,",
    "gillman and barnett @xcite developed an alternative fast direct solver based on using the free - space green s function with auxilliary variables to impose quasi - periodicity . in that formulation ,",
    "the bulk of the matrix is left unchanged for different illuminations .",
    "we suspect that the relative advantages of the two approaches will depend on the aspect ratio of the unit cell , the spatial dimension ( 2d vs.  3d scattering ) and detailed implementation issues .",
    "both approaches have asymptotically optimal complexity for unit cells that are a modest number of wavelengths in size .",
    "this work was supported by the applied mathematical sciences program of the u.s .",
    "department of energy under contract defgo288er25053 and by the air force office of scientific research under nsseff program award fa9550 - 10 - 1 - 0180 .",
    "klh was also supported in part by the national science foundation under grants dge-0333389 and dms-1203554 .",
    "jyl was also supported in part by the priority research centers program ( 2009 - 0093827 ) and the basic science research program ( 2012 - 002298 ) through the national research foundation ( nrf ) of korea .",
    "( 2012 ) ,  on the nystrm discretization of integral equations on planar curves with corners , _ appl .",
    "comput . harm .",
    "_ , * 32 * , 4564 .",
    "( 2011 ) ,  universal quadratures for boundary integral equations on two - dimensional domains with corners , _ j. comput .",
    "_ , * 229 * , 82598280 .",
    "( 2011 ) ,  integral formulation of the second kind for multi - subdomain scattering \" , proc .",
    "10th int . conf . on math .",
    "aspects of waves ( waves 2011 ) , pacific institute for the mathematical sciences ( to appear , http://www.pims.math.ca/ ) .",
    "( 2012 ) ,  multiple traces boundary integral formulation for helmholtz transmission problems \" , _ adv .",
    "comput . math .",
    "_ , * 37 * , 3991 .",
    "( 2012 ) ,  a fast direct solver for structured linear systems by recursive skeletonization \" , _",
    "siam j. sci .",
    "_ , * 35 * , a2507a2532 ."
  ],
  "abstract_text": [
    "<S> we present a new integral equation method for the calculation of two - dimensional scattering from periodic structures involving _ triple - points _ ( multiple materials meeting at a single point ) . </S>",
    "<S> the combination of a robust and high - order accurate integral representation and a fast direct solver permits the efficient simulation of scattering from fixed structures at multiple angles of incidence . </S>",
    "<S> we demonstrate the performance of the scheme with several numerical examples .    acoustic scattering , electromagnetic scattering , triple junctions , multiple material interfaces , boundary integral equations , fast direct solvers 43.20.-f , 41.20.jb , 81.05.xj , 02.60.-x , 02.30.rz 65r20 , 78a45 , 31a10 , 35j05 </S>"
  ]
}