{
  "article_text": [
    "[ sec : intro ] the classical area of _ combinatorial designs _ ( see , e.g. , @xcite ) asks about extremal subset systems of a finite set that have specified intersection patterns . in this paper , we are interested in extremal families of curves in a closed , orientable surface with specified intersection patterns . more specifically , benson farb and chris leininger brought the following topological variant to our attention :    [ farbq ] let @xmath1 be a closed oriented surface of genus @xmath0 , and let @xmath2 be a collection of pairwise non - isotopic essential simple closed curves @xmath3 such that @xmath4 intersects @xmath5 at most once for any @xmath6 .",
    "how large can @xmath2 be ?",
    "in fact , this question goes back further , to work of juvan , malni , and mohar @xcite , which we learned about after circulating an earlier version @xcite of the present paper .",
    "juvan , et al .",
    "@xmath7-system _ of curves on a genus @xmath0 closed , oriented surface to be a collection of non - isotopic , essential , simple closed curves @xmath8 such that each of the @xmath4 intersects any @xmath5 , @xmath9 at most @xmath7 times .",
    "we define @xmath10 to be the maximum size of any @xmath7-system on a closed surface @xmath1 of genus @xmath0 .",
    "the most important related results from @xcite are :    * for all @xmath11 and @xmath12 , @xmath10 is finite .",
    "* @xmath13 .",
    "* @xmath14    asymptotics for @xmath7 and @xmath0 growing are also given in @xcite .",
    "we study @xmath15 for @xmath7 fixed .",
    "we are particularly interested in the farb - leininger case @xmath16 , for which we can prove :    [ theo : generalbounds ] for @xmath17 , @xmath18 and for all @xmath19 , @xmath20    both the upper and lower bounds are , to the best of our knowledge , the best known .",
    "juvan , et al .",
    "do nt optimize the bound in ( * ? ? ?",
    "* theorem 3.3 ) for @xmath16 , but examining their arguments , we get an upper bound on the order of @xmath21 .",
    "the upper bound of theorem [ theo : generalbounds ] is based on the @xmath22-homology of curves ( proposition [ prop : mod2classupper ] ) .",
    "thus same upper bound statement and proof applies if we replace `` @xmath23-system '' with @xmath7-system in which all pairs of curves are either disjoint or intersect an odd number of times .",
    "thus the upper bound in theorem [ theo : generalbounds ] has some built - in slack , and it is plausible that , for large enough @xmath7 , this upper bound is nearly tight . reducing the gap will require a proof method that can see the difference between `` one intersection '' and `` an odd number of intersections '' .",
    "[ [ surfaces - with - boundary - components ] ] surfaces with boundary components + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for a surface with boundary components , a @xmath7-system is defined similarly to the closed case , except we add the condition that none of the curves is allowed to to be homotopic to a boundary curve .",
    "define @xmath24 to be the maximum size of a @xmath7-system in a surface of genus @xmath0 with @xmath25 boundary components .",
    "holding @xmath0 fixed ( along with @xmath7 ) , we can determine @xmath26 very precisely in terms of @xmath27 :    [ theo : boundaryasymptotics ] fix some @xmath28 .",
    "then , for all @xmath29 , @xmath30 for @xmath31 and @xmath32 @xmath33    relaxing the definition of a @xmath7-system to allowed arcs as well as curves on a surface with boundary seems to make the problem as hard as determining @xmath27 .    [ [ low - genus ] ] low genus + + + + + + + + +    on the torus , it is straightforward to show that a maximal @xmath23-system has @xmath34 curves , i.e. @xmath35 . in genus two , we present an elegant geometric argument , based on the hyperelliptic involution , which shows that :    [ theo : genus2 ] n(1,2 ) = 12 .",
    "moreover , there are exactly two mapping class orbits of maximal @xmath23-systems on a genus-@xmath36 surface .",
    "the proof gives exact structural information about the maximal @xmath23-systems on a genus-@xmath36 surface : they are lifts of @xmath37-vertex triangulations of the sphere drawn in the quotient of the surface by the hyperelliptic involution .",
    "[ [ nearly - all - curves - intersecting ] ] nearly all curves intersecting + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    given a @xmath7-system @xmath38 on a closed surface @xmath1 of genus @xmath0 , we define its _ odd intersection graph _ @xmath39 to be the graph that has one vertex for each of the @xmath4 and an edge between vertices @xmath40 and @xmath41 if @xmath4 intersects @xmath5 an odd number of times . with assumptions on @xmath42 , we can get much tighter upper bounds .",
    "[ theo : alloddupper ] let @xmath38 be a @xmath7-system with odd intersection graph @xmath39 . then for @xmath43 and @xmath44 :    * if @xmath39 is the complete graph @xmath45 , then @xmath46 , and the bound is sharp for all @xmath47 .",
    "* if @xmath39 has average degree @xmath48 , then @xmath49 .",
    "the first statement is proved using a @xmath22-homology argument and the second statement follows via an application of turn s theorem @xcite to @xmath42 s complement , an idea we learned from van vu s paper @xcite .",
    "[ [ nearly - all - curves - non - intersecting ] ] nearly all curves non - intersecting + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    given a @xmath7-system @xmath38 we define its _ intersection graph _ to be the graph that has one vertex for each @xmath4 and an edge between vertices @xmath40 and @xmath41 if @xmath4 intersects @xmath5 .",
    "[ theo : lowdegree ] let @xmath38 be a @xmath7-system on a closed surface of genus @xmath0 with intersection graph @xmath42 . for @xmath50 and @xmath44 .",
    "if @xmath42 has average degree @xmath51 , then @xmath52 .    in the case where @xmath53 , this is just the well - known fact that a maximal system of disjoint nonisotopic simple closed curves has at most @xmath54 curves",
    "jm , ir , and lt received support for this work from rivin s nsf cdi - i grant dmr 0835586 .",
    "lt s final preparation was supported by the european research council under the european union s seventh framework programme ( fp7/2007 - 2013 ) / erc grant agreement no 247029-sdmodels .",
    "our initial work on this problem took place at ileana streinu s 2010 barbados workshop at the bellairs research institute .",
    "[ sec : gen2 ] in this section , we give a geometric argument to prove theorem [ theo : genus2 ] . the argument generalizes to give a sub - quadratic lower bound in higher genus .",
    "the key tool we need is the _",
    "hyperelliptic involution_. here are the facts we need , which can all be found in @xcite .",
    "[ prop : hyper - exists ] every riemann surface @xmath1 of genus @xmath36 admits a `` hyperelliptic involution '' with @xmath37 fixed points .    the fixed points of the hyperelliptic involution are called _ weirstrass points _ , and we denote them @xmath55 .    [",
    "prop : hyper - quotient ] let @xmath1 be a closed riemann surface of genus @xmath36 .",
    "the quotient @xmath56 of @xmath1 by the hyperelliptic involution is a sphere with six double points corresponding to the weierstrass points ; i.e. , @xmath56 is an orbifold of signature @xmath57 .",
    "simple closed geodesics in the riemann surface @xmath1 have nice representatives in @xmath56 .    [",
    "prop : hyper - geodesics ] let @xmath1 and @xmath56 be as in proposition [ prop : hyper - quotient ]",
    ". then any non - separating simple closed geodesic @xmath58 in @xmath1 goes through exactly two of the wierstrass points and projects to a geodesic segment going between exactly two of the doubled points in @xmath56 .      by proposition",
    "[ prop : nosep ] proven below , there is no separating curve in a maximal @xmath23-system , and by proposition [ prop : hyper - geodesics ] , the @xmath23-systems in @xmath1 that have only non - separating curves correspond to isomorphism classes of simple planar graphs on @xmath37 vertices .",
    "since planar triangulations on @xmath37 vertices have @xmath59 edges , it follows that @xmath60 .",
    "there are two graph isomorphism classes of planar triangulations on @xmath37 vertices , namely , the octahedron and doubly stellated tetrahedron .",
    "since these graphs are @xmath34-connected , there are only two triangulations up to homeomorphism of the sphere ( permuting weierstrass points ) .",
    "birman and hilden @xcite have shown that the mapping class group of the genus @xmath36 surface modulo the hyperelliptic involution is isomorphic to the mapping class group of the @xmath37-times punctured sphere . consequently , there are two mapping class group orbits of maximal @xmath23-systems .",
    "@xmath61      the lower bound of theorem [ theo : genus2 ] generalizes to surfaces @xmath1 of @xmath62 : there are @xmath63 weierstrass points corresponding to double points in the quotient by the hyperelliptic involution , implying that any planar graph on @xmath63 vertices corresponds to some @xmath23-system .",
    "thus , we obtain the lower bound for @xmath17 from theorem [ theo : generalbounds ] .",
    "[ sec : structure ] we will need the following result on the structure of maximal @xmath23-systems :    [ prop : nosep ] let @xmath1 be a closed surface of genus @xmath43 .",
    "then , any maximal @xmath23-system in @xmath1 contains no separating curves .    from now on in this section , we assume that @xmath1 satisfies the hypotheses of proposition [ prop : nosep ] .",
    "we also use the standard notions of _ minimal position _ and _ geometric intersection number _ for curves , which may be found in ( * ? ? ?",
    "* section 1.2.3 ) .",
    "we denote the geometric intersection number of ( the isotopy classes of ) @xmath64 and @xmath65 by @xmath66 .",
    "a @xmath7-system is in minimal position when the curves in it are pairwise in minimal position .",
    "every @xmath7-system has such a representative ( * ? ? ?",
    "* corollary 1.9 ) .",
    "the auxiliary lemma [ lemma : annulipoly ] , which describes the complementary regions of a maximal @xmath7-system is also of independent interest .",
    "let @xmath2 be a @xmath7-system and define the _ complementary regions of @xmath2 _ to be the components of the surface @xmath67 obtained by cutting @xmath1 along the curves in @xmath2 .",
    "[ lemma : annulipoly ] let @xmath2 be a maximal @xmath7-system such that the curves in @xmath2 are in minimal position . then",
    ", the complementary regions are polygons and annuli .",
    "furthermore , each annulus has a boundary component consisting of a single curve in @xmath2 .",
    "intuitively , one would expect that if proposition [ prop : nosep ] were to fail , an inductive argument would establish an @xmath68 upper bound on the size of any @xmath23-system , contradicting the fact that there are @xmath23-systems with @xmath69 curves .",
    "however , we are unaware of a rigorous proof along these lines , so instead we use lemma [ lemma : annulipoly ] .    the difficult part of the proof of lemma [ lemma : annulipoly ] will be to rule out pairs of pants as complementary regions .",
    "this next lemma is straightforward and gives the starting point .",
    "[ lemma : nobiggerthanpants ] suppose @xmath2 is a maximal @xmath7-system in minimal position .",
    "then , the complementary regions are all polygons , annuli , or pairs of pants .",
    "furthermore , each annulus has a boundary component consisting of a single curve in @xmath2 , and every boundary component of the pairs of pants are curves in @xmath2 .",
    "if a complementary region has nonzero genus , then it contains a simple closed curve that is not isotopic to a boundary curve which we could add to @xmath2 to obtain a larger @xmath7-system . a similar fact is true if a complementary region is a sphere with at least @xmath70 boundary components .",
    "this proves that the complementary regions are all polygons , annuli , or pairs of pants .",
    "now consider a complementary region that is an annulus .",
    "if neither boundary component is a single curve in @xmath2 , then the core curve of this annulus is , by our assumption of minimal position , not isotopic to any curve in @xmath2 and does not intersect any curves in @xmath2 .",
    "this contradicts the maximality of @xmath2 .",
    "similar reasoning shows that all boundary curves of a pair of pants must be elements of @xmath2 .",
    "continuing from lemma [ lemma : nobiggerthanpants ] , it suffices to rule out pants as a complementary region . comparing the ( classical ) upper bound , theorem [ theo : all - disjoint ] , of the size of a @xmath71-system and the lower bound on the size of a @xmath23-system from theorem [ theo : generalbounds ]",
    ", we see that not all the complementary regions can be pairs of pants .",
    "thus , if @xmath2 has some pair of pants as a complementary region , then connectedness of @xmath1 and lemma [ lemma : nobiggerthanpants ] implies that some curve @xmath58 in @xmath2 is disjoint from the rest of @xmath2 and bounds a pair of pants @xmath72 on one side and an annulus @xmath73 on the other .",
    "the other boundary component of @xmath73 consists of arcs of curves in @xmath2 , and there are at least two such arcs .",
    "let @xmath74 be two curves with consecutive arcs in @xmath75 .",
    "@xmath76 at 50 140 @xmath77 at 58 21 @xmath78 at 110 170 @xmath79 at 130 58 @xmath58 at 37 25 @xmath80 at 76 50 @xmath81 at 150 89 @xmath82 at 48 104 @xmath83 at 140 145     and arcs @xmath84.,scaledwidth=50.0% ]    we now show that @xmath58 may be replaced with two new curves to obtain a larger @xmath23-system ; the construction is depicted in figure [ figure : newcurves ] .",
    "let @xmath85 be the other boundary components ( aside from @xmath58 ) in the pair of pants @xmath72 , and let @xmath82 be a simple arc connecting @xmath76 to @xmath80 and lying in @xmath86 .",
    "the regular neighborhood of @xmath87 is a pair of pants where two of the boundary curves are isotopic to @xmath76 and @xmath80 ; let @xmath77 be the other boundary component .",
    "similarly , let @xmath83 be a simple arc which connects @xmath78 to @xmath81 , lies in @xmath86 , and is disjoint from @xmath82 ; let @xmath79 be defined similarly to @xmath77 .    to show @xmath88 is a @xmath7-system of larger size , we must show pairwise intersections are less than or equal to @xmath7 and that @xmath77 and @xmath79 are not isotopic to other curves in @xmath2 or each other .",
    "it is possible to do the latter by establishing the following geometric intersection numbers since the numbers are an invariant of isotopy classes .",
    "* for all curves @xmath89 , we have @xmath90 and @xmath91 * @xmath92 * @xmath93    before proving ( 1)-(3 ) , let us see that they establish that @xmath94 is a @xmath7-system",
    ". statements ( 1 ) and ( 2 ) show @xmath94 is a @xmath7-system .",
    "( note that ( 1 ) also says @xmath95 and similarly for @xmath96 . )",
    "statement ( 3 ) implies @xmath77 and @xmath79 are not isotopic to any curves in @xmath2 since they are all disjoint from @xmath58 , and statement ( 1 ) implies @xmath97 which establishes that @xmath77 and @xmath79 are not isotopic .",
    "[ [ proof - of-1 ] ] proof of ( 1 ) + + + + + + + + + + + +    we only show that @xmath90 since the proof applies also to @xmath78 and @xmath79 . if @xmath98 , this is immediate since @xmath77 and @xmath76 are disjoint .",
    "now suppose @xmath99 .",
    "homotope @xmath77 to a simple closed curve @xmath100 which is the union of an arc @xmath101 from @xmath76 and an arc @xmath102 which lies in @xmath86 , is disjoint from all curves in @xmath103 , and cuts @xmath72 into two annuli .",
    "( see figure [ figure : nopantsfig2 ] . ) clearly , the arc @xmath101 and curve @xmath104 cross @xmath105 times , so by the bigon criterion ( ( * ? ? ?",
    "* proposition 1.7 ) ) , it suffices to show that it is impossible to bound a disc with an arc from @xmath104 and an arc from @xmath100 .",
    "since @xmath2 is in minimal position , @xmath76 and @xmath104 have no bigons , and so any bigon made from @xmath104 and @xmath100 must use the arc @xmath102 .",
    "however , on each side of @xmath102 , we may connect @xmath102 to either @xmath80 or @xmath106 with an arc disjoint from @xmath104 ( since @xmath104 is disjoint from @xmath72 ) ; this would be impossible if an arc containing @xmath102 made a bigon with an arc from @xmath104 .",
    "this established the first equality ; the second follows by a similar argument",
    ".     indicated in gray.,scaledwidth=50.0% ]    [ [ proof - of-2 ] ] proof of ( 2 ) + + + + + + + + + + + +    let @xmath100 be as above . by further homotoping , we can ensure that @xmath102 is disjoint from @xmath79 and so @xmath107    [ [ proof - of-3 ] ] proof of ( 3 ) + + + + + + + + + + + +    again , we use the bigon criterion . by construction , @xmath58 and @xmath77 each cut each other into two arcs , @xmath108 and @xmath109 respectively , where w.l.o.g .",
    "@xmath110 lies in @xmath72 .",
    "the curves @xmath111 and @xmath112 are each homotopic to some boundary component in @xmath72 and hence can not be trivial .",
    "if @xmath113 bounded a disc , then we could homotope @xmath77 to lie in @xmath72 which is impossible since @xmath78 and @xmath77 have nonzero geometric intersection number .",
    "@xmath61      suppose , for a contradiction , that @xmath2 is a maximal @xmath23-system with a separating curve @xmath58 ; w.l.o.g .",
    ", we may assume that @xmath2 is in minimal position .",
    "lemma [ lemma : annulipoly ] then applies , so @xmath58 is incident on two complementary regions @xmath73 and @xmath114 that are both annuli , and each of @xmath73 and @xmath114 has a boundary component consisting of arcs from at least two different curves in @xmath2 .",
    "we will show that by removing @xmath58 , two new curves may be added to get a larger @xmath23-system .    because @xmath2 is a @xmath23-system",
    ", we may slightly strengthen the conclusion of lemma [ lemma : annulipoly ] : the boundary components of @xmath73 and @xmath114 that are not @xmath58 span arcs from at least three different curves in @xmath2 .",
    "let @xmath74 be curves with consecutive arcs in @xmath75 , and let @xmath80 be a curve contributing a boundary arc to @xmath114 .",
    "let @xmath115 be the surface obtained by cutting along @xmath58 .",
    "there is an arc @xmath101 starting and ending at @xmath116 such that @xmath101 `` follows '' @xmath76 .",
    "more precisely , there is an arc @xmath101 such that @xmath101 , @xmath76 and a part of @xmath116 cobound an annulus and @xmath101 has the same intersection numbers with the other curves in @xmath103 .",
    "similarly , there is such an arc @xmath117 for @xmath78 , and let @xmath118 be two disjoint such arcs for @xmath80 .",
    "we can homotope the arcs @xmath119 so that :    @xmath76 at 50 100 @xmath78 at 110 130 @xmath58 at 102 26 @xmath58 at 331 26 @xmath80 at 284 110 @xmath101 at 48 48 @xmath117 at 140 95 @xmath120 at 285 62 @xmath121 at 280 30     * @xmath101 and @xmath117 intersect exactly once transversely and * the endpoints of @xmath101 match up with @xmath120 and @xmath117 with @xmath121 when gluing @xmath115 back together .",
    "( this is depicted in figure [ figure : arcsfornosep ] . )",
    "let @xmath77 and @xmath79 be the resulting arcs from gluing @xmath101 with @xmath120 and @xmath117 with @xmath121 respectively . since @xmath77 and @xmath79 intersect",
    "exactly once transversely , they are distinct non - trivial simple closed curves . furthermore both @xmath77 and @xmath79 intersect some curve exactly once on either side of @xmath58 .",
    "since no other curve in @xmath2 does this , @xmath77 and @xmath79 are isotopically distinct from all other curves in @xmath2 .",
    "thus @xmath122 is a larger @xmath23-system than @xmath2 . @xmath61",
    "[ sec : upper - hom ] now we turn to the general case of a surface @xmath1 of genus @xmath50 .",
    "the point of this section is to prove the following proposition , from which the upper bound in theorem [ theo : generalbounds ] follows readily .",
    "[ prop : mod2classupper ] let @xmath1 be a closed oriented surface of genus @xmath50",
    ". then any @xmath23-system of curves on @xmath1 has at most @xmath123 curves in any nontrivial @xmath22-homology class .",
    "the main lemma we need is :    [ lemma : disj - all - sep ] let @xmath43 and let @xmath1 be a genus @xmath0 surface with @xmath36 boundary components .",
    "let @xmath2 be a @xmath71-system of separating curves in @xmath1 such that each curve separates the boundary components .",
    "then , @xmath124 .",
    "we argue by induction .",
    "suppose @xmath31 . in this case ,",
    "the only separating simple curves which are not boundary parallel cut @xmath1 into a torus with a single boundary component and a three - holed sphere .",
    "such a curve does not separate the boundary components of @xmath1 .",
    "suppose @xmath125 . cutting @xmath1 along a curve @xmath58 in @xmath2 yields two surfaces @xmath126 with genus @xmath127 adding up to @xmath0 and each with @xmath36 boundary components .",
    "we note that @xmath103 deposits a @xmath71-system in each of @xmath115 and @xmath128 with the same properties as @xmath2 . thus @xmath129 .",
    "it suffices to show that one can find at most @xmath123 mutually disjoint curves in the same @xmath22-homology class .",
    "let @xmath1 be a closed genus @xmath50 surface , and @xmath2 be a @xmath71-system of curves all in the same @xmath22-homology class .",
    "we reduce the proposition to lemma [ lemma : disj - all - sep ] .",
    "cut along some @xmath130 to obtain a surface @xmath115 of genus @xmath131 with two boundary components corresponding to @xmath58 ; fill in each boundary component with a disk to get a closed surface @xmath128 .",
    "the curves in @xmath132 in @xmath128 are all null - homologous in @xmath133 .",
    "this means that their homology classes in @xmath134 are all either non - primitive or trivial .",
    "the former implies the the classes are not primitive in @xmath135 , which is disallowed by the hypothesis that all the curves in @xmath2 are simple ( see ( * ? ? ?",
    "* proposition 6.2 ) ) .",
    "thus , any curve in @xmath103 separates @xmath128 .    furthermore , any @xmath136 must separate the boundary components of @xmath115 . if it did",
    "not , then it would bound a subsurface in @xmath115 with a single boundary component , and thus also in @xmath1 .",
    "this however would imply that @xmath81 is null - homologous as an element of @xmath137 , a contradiction .",
    "consequently , we are in the situation of lemma [ lemma : disj - all - sep ] and are done .",
    "@xmath61      by proposition [ prop : nosep ] , a maximal @xmath23-system contains no separating curve and thus no null - homologous curve .",
    "the curves must then all lie in the @xmath138 nontrivial @xmath22-homology classes , and , by proposition [ prop : mod2classupper ] , each of these contains at most @xmath123 curves in a @xmath23-system .",
    "[ sec : extreme ] in this section we give much sharper upper bounds when the intersection graph @xmath42 of a @xmath23-system @xmath2 is either very sparse or very dense .",
    "the key cases are when @xmath42 or its complement are complete .",
    "we recall the following classical and widely known fact , which may be found in ( * ? ? ?",
    "* section 8.3.1 ) .",
    "[ theo : all - disjoint ] let @xmath139 and let @xmath1 be a closed surface of genus @xmath0 , and let @xmath2 be a @xmath71-system . then @xmath140 .      to bound the size of @xmath23-systems with all pairs of curves intersecting , we continue along the lines of section [ sec : upper - hom ] .",
    "let @xmath141 and @xmath142 be vectors in @xmath143 and let @xmath144 denote the standard symplectic pairing .",
    "[ prop : linalg ] let @xmath145 be non - zero vectors in @xmath143 with the property that , for all @xmath6 , @xmath146 . then @xmath46 .",
    "suppose there is a linear dependence @xmath147 among the @xmath148 , with not all the @xmath149 zero .",
    "suppose further that the dependence is non - trivial and that @xmath150 and @xmath151 .",
    "pairing both sides of with @xmath152 tells us the number of non - zero @xmath149 is odd ; similarly pairing both sides of with @xmath153 tells us the number of non - zero @xmath149 is even .",
    "the resulting contradiction implies that , in fact , for any non - trivial linear dependence among the @xmath148 , the @xmath149 are all one .",
    "thus , the @xmath148 are either independent , implying @xmath154 , or there is a unique linear dependence with full support among them , implying @xmath155 .    as a corollary",
    ", we obtain :    [ prop : all - intersecting ] let @xmath44 , and let @xmath2 be a @xmath7-system in a closed genus @xmath0 surface with any pair of curves intersecting an odd number of times",
    ". then @xmath156 .",
    "if the minimal geometric intersection number between essential , non - isotopic , simple closed curves is odd , then their algebraic intersection number mod @xmath36 is @xmath23 and , furthermore , their @xmath22-homology classes must be distinct .",
    "apply proposition [ prop : linalg ] .",
    "we prove theorem [ theo : alloddupper ] , since the proof of theorem [ theo : lowdegree ] is nearly identical .",
    "the upper bound when the graph @xmath39 is @xmath45 is proposition [ prop : all - intersecting ] . if @xmath39 has average degree @xmath48 , then its complement has average degree @xmath51 , and by turn s theorem @xcite , must contain an independent set of size @xmath157 .",
    "applying proposition [ prop : all - intersecting ] to the curves in @xmath2 represented by the corresponding clique in @xmath39 , we see that @xmath158 .",
    "@xmath61      the bound of proposition [ prop : linalg ] is tight , as the following example shows .",
    "define @xmath159 , @xmath160 , and @xmath161 . for @xmath50 , inductively define @xmath162 for @xmath163 $ ] and then @xmath164 , @xmath165 , and @xmath166 .",
    "( the semi - colons mean concatenating vectors . )",
    ".,scaledwidth=70.0% ]    [ prop : linalg - tight ] let @xmath43 , and let @xmath167 be defined as above . for all @xmath9 , we have @xmath168 .    for @xmath169 , this is an easy computation , and the @xmath50 cases follow by induction .",
    "figure [ fig : curves - g2 ] shows curves with @xmath22-homology classes given by the @xmath170 .",
    "the vectors @xmath167 are canonical .",
    "[ prop : linalg - canonical ] let @xmath43 and suppose that @xmath171 have the property that , for @xmath6 , @xmath172 . then there is a symplectic automorphism @xmath73 of @xmath143 such that @xmath173 .    in the proof , we need the basic fact :    [ lemma : linalg - indep ] let @xmath174 and @xmath175 be linearly independent sets of vectors such that @xmath176 for all @xmath40 and @xmath41 .",
    "then there is a symplectic automorphism @xmath73 of @xmath143 such that @xmath173 .",
    "let @xmath73 be the automorphism from lemma [ lemma : linalg - indep ] applied to the @xmath177 and @xmath178 from the statement of the theorem .",
    "this is allowed , because the proof of proposition [ prop : linalg ] says that for any collections meeting the hypothesis of the @xmath167 and @xmath179 , we have @xmath180 with the first @xmath181 vectors independent .",
    "thus , we see that @xmath182      we can explicitly describe a @xmath23-system with @xmath183 curves all intersecting pairwise .",
    "[ theo : canonical - curves ] for any genus @xmath184 closed surface , there is a @xmath23-system of @xmath183 curves which all pairwise intersect .",
    "a genus @xmath0 surface is homeomorphic to a regular @xmath185-gon with opposite sides identified .",
    "we obtain @xmath181 simple closed curves from simple arcs connecting opposite sides of the @xmath185-gon . after identifying sides ,",
    "all vertices become identified , so we can add a diagonal to the configuration as well .",
    "later , we will use the following slightly stronger statement which is clear from the construction .",
    "[ cor : canonical - curves - same - point ] the @xmath23-system from theorem [ theo : canonical - curves ] can be chosen so that all curves pairwise intersect at the same point on the surface .    in both genus @xmath23 and @xmath36 , it can be shown that , up to the mapping class group , there is only one maximal configuration of curves all of which pairwise intersect exactly once . in genus",
    "@xmath36 , the configuration corresponds to a star graph in the quotient under hyperelliptic involution .",
    "it would be interesting to know if this generalizes .    in higher genus surfaces",
    ", is there only one mapping class orbit of @xmath23-systems such that each pair of curves intersects ?",
    "we now prove the upper bound of theorem [ theo : boundaryasymptotics ] .",
    "first , we improve proposition [ prop : all - intersecting ]    [ lemma : all - intersecting - boundary ] the statement of proposition [ prop : all - intersecting ] holds for a genus @xmath0 surface with any number of boundary components .",
    "suppose @xmath2 is a @xmath7-system in a genus @xmath0 surface with @xmath25 boundary components with any pair of curves intersecting an odd number of times .",
    "glue in discs into all the boundary components to obtain a closed surface @xmath1 .",
    "since each curve intersects any other curve transversely an odd number of times , no pair of curves of @xmath2 can be pairwise isotopic in @xmath1 .",
    "consequently , @xmath2 is a @xmath7-system satisfying the hypothesis of proposition [ prop : all - intersecting ] and hence @xmath186 .",
    "we argue by induction and show that @xmath187    let @xmath2 be a maximal @xmath23-system in @xmath188 , the surface of genus @xmath0 and @xmath25 boundary components .",
    "glue in a disc @xmath51 to one of the boundary components to obtain @xmath189 .",
    "since intersection numbers did not increase , curves in @xmath2 still pairwise intersect at most once , but some curves may have become isotopic as a result of gluing in the disc .",
    "we will show that a @xmath23-system @xmath190 on @xmath189 may be obtained by removing at most @xmath183 curves from @xmath2 .",
    "then , we have @xmath191    if two curves become isotopic after gluing in @xmath51 , then since @xmath2 is a @xmath23-system , they are disjoint and hence bound an annulus which necessarily contains @xmath51 . in particular , any curve can become isotopic to at most @xmath23 other curve , so we must understand how many pairs of isotopic curves can occur . if @xmath192 and @xmath193 are two such pairs , then both pairs bound an annulus containing @xmath51 and the annuli must intersect .",
    "consequently , each curve in an isotopic pair intersects every curve in the other pairs .",
    "if we construct a set @xmath94 by taking one curve from each pair , then @xmath94 is as in lemma [ lemma : all - intersecting - boundary ] and so @xmath194 .",
    "thus @xmath195 is the @xmath23-system on @xmath189 as desired .    in the case of the torus",
    ", we have @xmath196 .",
    "indeed , if two curves on a one - holed torus become isotopic after gluing in the disc @xmath51 , then , as before , they bound an annulus containing @xmath51 ; however , since the surface is a torus , they also bound an annulus , not containing @xmath51 , on the other side , and so they must have already been isotopic in the one - holed torus .",
    "@xmath61    in the next section , we will see that obtaining our lower bounds essentially amounts to reversing the argument in the previous paragraph .",
    "[ sec : lower ] in this section we prove the lower bounds of theorem [ theo : generalbounds ] and theorem [ theo : boundaryasymptotics ]",
    ". we will first prove theorem [ theo : boundaryasymptotics ] .",
    "the lower bound of theorem [ theo : generalbounds ] then follows easily by attaching handles .",
    "the base case is corollary [ cor : canonical - curves - same - point ] .",
    "suppose we have constructed @xmath2 for @xmath188 .",
    "let @xmath51 be a small disc which contains @xmath199 and intersects only the curves from @xmath94 . via a homeomorphism",
    ", we can identify @xmath51 with the standard unit disc in @xmath200 and the arcs from @xmath94 as straight - line diagonals all intersecting at the center @xmath201 , none of which is vertical . remove a small disc @xmath202 directly above @xmath199 , and construct @xmath183 new simple closed curves as follows .      for each arc @xmath101 in @xmath51 , place a new arc @xmath203 in @xmath51 parallel to @xmath101 but above @xmath202 .",
    "see figure [ figure : lowerbound ] . obtain a simple closed curve @xmath77 by continuing @xmath203 outside of @xmath51 along the curve @xmath76 in @xmath94 which contains @xmath101 .",
    "this can be done over all @xmath204 so that :    * for all @xmath205 , the corresponding new curves @xmath206 deposit straight lines in @xmath51 and otherwise outside of @xmath51 , the curves @xmath207 are pairwise disjoint .",
    "hence , pairwise intersections among @xmath207 are at most @xmath23 .",
    "* for all @xmath204 and @xmath208 , the new curve @xmath77 has intersection @xmath209    let @xmath190 be @xmath2 with the newly constructed curves added .",
    "each new curve @xmath77 bounds with its `` parent '' @xmath76 an annulus containing the ( removed ) disc @xmath202 . since @xmath28 , the complement of the annulus has genus at least @xmath23 , and thus is not an annulus ; consequently @xmath76 and @xmath77 are non isotopic .",
    "furthermore , @xmath77 is not isotopic to any other curve in @xmath190 since if it were , then , after replacing @xmath202 , we would see that @xmath76 were isotopic to some other curve in @xmath2 , a contradiction .",
    "note that @xmath190 has exactly @xmath183 more curves and @xmath210 still has the desired properties .",
    "notice that this argument fails in @xmath31 only because if @xmath211 , then the complement of the annulus containing @xmath51 would in fact be another annulus .",
    "however , once @xmath32 , the complement would contain a boundary component , and the argument proceeds mutatis mutandis , but with the smaller lower bound of @xmath212 . @xmath61",
    "the cases @xmath213 were established in section [ sec : gen2 ] so assume @xmath214 . let @xmath215 if @xmath0 is even and @xmath216 if @xmath0 is odd and let @xmath217 . by theorem [ theo : boundaryasymptotics ]",
    ", there is a @xmath23-system @xmath2 of size @xmath218 on a surface of genus @xmath219 and @xmath220 boundary components .",
    "gluing @xmath25 handles to the @xmath220 boundary components does not cause curves to become isotopic , the system consisting of @xmath2 and the @xmath25 curves going around the handles is a @xmath23-system of at least @xmath221 curves on a genus @xmath0 surface . @xmath61",
    "joan  s. birman and hugh  m. hilden . on the mapping class groups of closed surfaces as covering spaces . in",
    "_ advances in the theory of riemann surfaces ( proc .",
    "conf . , stony brook , n.y . , 1969 ) _ , pages 81115 .",
    "ann . of math .",
    "studies , no .",
    "princeton univ . press , princeton , n.j . ,",
    "1971 .",
    "andrew haas and perry susskind .",
    "the geometry of the hyperelliptic involution in genus two .",
    "_ , 1050 ( 1):0 159165 , 1989 .",
    "issn 0002 - 9939 .",
    "doi : 10.2307/2046751 .",
    "url http://dx.doi.org/10.2307/2046751 .",
    "m.  juvan , a.  malni , and b.  mohar .",
    "systems of curves on surfaces .",
    "_ j. combin .",
    "theory ser .",
    "b _ , 680 ( 1):0 722 , 1996 .",
    "issn 0095 - 8956 .",
    "doi : 10.1006/jctb.1996.0053 .",
    "url http://dx.doi.org/10.1006/jctb.1996.0053 .          van  h. vu .",
    "extremal set systems with weakly restricted intersections .",
    "_ combinatorica _ , 190 ( 4):0 567587 , 1999 .",
    "issn 0209 - 9683 .",
    "doi : 10.1007/s004939970008 .",
    "url http://dx.doi.org/10.1007/s004939970008 ."
  ],
  "abstract_text": [
    "<S> we give an exponential upper and a quadratic lower bound on the number of pairwise non - isotopic simple closed curves can be placed on a closed surface of genus @xmath0 such that any two of the curves intersects at most once . although the gap is large , both bounds are the best known for large genus . in genus one and two , we solve the problem exactly .    </S>",
    "<S> our methods generalize to variants in which the allowed number of pairwise intersections is odd , even , or bounded , and to surfaces with boundary components .    </S>",
    "<S> = 1 </S>"
  ]
}