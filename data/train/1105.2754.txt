{
  "article_text": [
    "many programs and software packages simulate orbits of charged particles in magnetic fields as noted in table 1 . some use a single reference orbit and represent the magnetic field as a series of matrices , one for each magnetic element .",
    "other programs allow more realistic spiral orbits by using magnetic field equations or interpolated magnetic field maps for point to point runge - kutta track integrators .",
    "some programs such as cosy infinity use exact analytical determination of magnetic field derivatives ; others use numerical differentiation .",
    "an important preliminary step before simulation of fields produced by magnets is investigation of orbit dynamics in an idealized magnetic field which satisfies maxwell s equations in vacuum to sufficient order .",
    "magnetic fields for cyclotrons @xcite are most conveniently expressed in cylindrical ( @xmath10,@xmath11,@xmath7 ) coordinates in which the @xmath7 direction is the cyclotron rotation axis . in many applications",
    ", an ideal field is specfied in the cyclotron median plane which is the @xmath9 plane where @xmath12 and @xmath3 vanish .",
    "determination of ( @xmath12,@xmath13,@xmath6 ) for @xmath14 to sufficient order ( beyond 1st order ) is necessary for detailed orbit and dynamics studies @xcite .",
    "reduction of the phase space of a muon beam through ionization cooling in an inverse cyclotron is being researched @xcite as part of the muon r&d for possible future facilities such as a neutrino factory and muon collider @xcite .",
    "= 1.2 mm    .computer programs for tracking charged particles in magnetic fields and designing accelerators . [ cols=\"<,^,^,^,^ \" , ]",
    "the importance of correct field expansion for reliable particle tracking simulation and beam dynamics analysis has been recognized , and the expansion around the reference orbit of a bent - solenoid geometry has been calculated @xcite .",
    "expansions to eighth order are done with the aid of mathematica .",
    "a static magnetic field can be expanded out of a plane because it must satisfy the source - free maxwell equations in vacuum , @xmath15 and @xmath16 .",
    "only @xmath17 constrains fields in the plane , so any function can be used for @xmath6 .",
    "one gets the three field components out of the plane as follows    @xmath18    the expansion of a magnetic field specified in a plane has been addressed by zgoubi for cartesian coordinates @xcite .",
    "zgoubi uses taylor expansion with @xmath15 and @xmath16 . here",
    "we work out a solution in cylindrical coordinates to arbitrary order .",
    "median plane antisymmetry is assumed so that    @xmath19    @xmath20    with @xmath21 the magnetic field is @xmath22    @xmath23    @xmath24    which is    @xmath25\\ ] ]    @xmath26\\ ] ]    @xmath27\\ ] ] a rigorous proof of these expansions is provided in the final section of this paper .    in most implementations of simulating a magnetic field ,",
    "the expansions of @xmath28 can not be expressed in closed form . in such cases ,",
    "only a finite number of terms of the magnetic field expansion can be used .",
    "the order of the expansion is defined as the highest power of @xmath7 in the summation . to odd ( even )",
    "order @xmath29 , @xmath2 and @xmath3 have @xmath30 ( @xmath31 ) terms while @xmath6 has @xmath30 ( @xmath32 ) terms .",
    "when @xmath33 is expanded to odd order , @xmath16 and @xmath34 ; when @xmath33 is expanded to even order , @xmath15 and @xmath35 .",
    "an even order expansion with @xmath15 is needed to satisfy the hamiltonian and allow a symplectic map @xcite .",
    "this section shows some example midplane fields @xmath36 expanded to 4th order to obtain @xmath4 , @xmath37 , and @xmath38 .",
    "these example fields have fairly simple radial and azimuthal dependences and were checked with mathemtica .",
    "the 4th order expansion of a more complex field , one with a constant radial field index , @xmath39 and spiral angle , @xmath40 , such as @xmath41)$ ] , yields pages of output so that the use of a program such as mathematica is necessary .",
    "mathematica includes a command which produces output in fortran or c syntax which can be copied directly into a routine which generates a grid of magnetic field points .",
    "example mathematica and fortran files are presented in appendices a and b.      is this case , @xmath43 is @xmath44 so that @xmath45 @xmath46 @xmath47    an example of such a field is a non - sectored field in the middle of helmoltz coils . at @xmath9 ,",
    "the @xmath6 is maximal at @xmath48 and decreases very slowly with radius so that @xmath49 and higher derivatives are small , but still large enough to provide weak focusing in @xmath10 and @xmath7 .      for this field @xmath43",
    "is @xmath50 : an example is @xmath51 so that @xmath52 @xmath53 @xmath54    a sectored field such as this provides stronger focusing in @xmath7 than a non - sectored field .      for this field , @xmath43 is @xmath50 : a field with constant spiral angle @xmath40 is    @xmath55)$ ] so that @xmath56)+\\ ] ] @xmath57 + 2\\sin[n(\\theta-\\tan\\alpha\\log(r / r_0))])\\ ] ] @xmath58 ) -   \\frac{1}{6 } \\left(\\frac{z}{r } \\right)^3 ( f b_0 n^3 \\sec^2\\alpha ) ( \\cos[n(\\theta-\\tan\\alpha\\ln(r / r_0))])\\ ] ] @xmath59 ) -\\ ] ] @xmath60 ) + \\ ] ] @xmath61 + \\ ] ] @xmath62 + n \\tan\\alpha \\cos[n(\\theta-\\tan\\alpha\\ln(r / r_0))]\\big\\}\\ ] ]    the spiraled magnetic field provides stronger focusing in @xmath7 than the non - spiraled sectored field . when @xmath40 = 0 , the magnetic field components reduce to those of the previous azimuthally sectored field with no spiral angle nor midplane radial dependence .",
    "@xmath63    for this field , @xmath64 .",
    "then @xmath65 @xmath66",
    "@xmath67 @xmath68 @xmath69\\ ] ]",
    "let @xmath70 @xmath71 @xmath72 , @xmath73 @xmath74 , for any vector field * v * and scalar field @xmath75 , @xmath76 , @xmath77 .",
    "@xmath78 it is necessary and sufficient to show that the specification of @xmath79 for @xmath80 and @xmath81 for @xmath80 .",
    "note that @xmath42 was defined as @xmath82 .",
    "@xmath83z^k = 0 \\rightarrow \\newline ( \\vec{\\nabla}_\\bot \\cdot { \\bf a}_k ) + ( k + 1)b_{k+1 } = 0 \\rightarrow \\newline b_{k+1 } = -\\frac{1}{k+1}(\\vec{\\nabla}_\\bot \\cdot { \\bf a}_k)$ ] for @xmath84 @xmath85",
    ". therefore , @xmath86 and @xmath87 .",
    "then @xmath88 for @xmath84 @xmath89 @xmath90 @xmath91 @xmath92 continuing recursively , @xmath93 @xmath94 the proof is complete .",
    "the procedure for expanding a specified @xmath36 out of the @xmath9 midplane is described .",
    "examples of expansions out to 4th order are included .",
    "1 shows an example of a magnetic field .     including the outer 6-sector focus field which merges into the inner magnetic bottle . @xmath95",
    "ranges from -0.6 to 3.2 tesla .",
    "the inner bottle field is generated by two @xmath10 = 0.2 m circular coils , located 0.2 m above and below the midplane .",
    "the @xmath6 field at @xmath10 = 0 , @xmath7 = 0 is 2.4 tesla.,title=\"fig:\",width=377 ]    including the outer 6-sector focus field which merges into the inner magnetic bottle . @xmath95 ranges from -0.6 to 3.2 tesla .",
    "the inner bottle field is generated by two @xmath10 = 0.2 m circular coils , located 0.2 m above and below the midplane .",
    "the @xmath6 field at @xmath10 = 0 , @xmath7 = 0 is 2.4 tesla.,title=\"fig:\",width=249 ]    this work was supported by national science foundation award 757938 , doe grant de - fg05 - 91er40622 , and doe sbir de - fg02 - 08er85044 .",
    "many thanks to t.  roberts , r.  fernow , j.  gallardo , s.  berg , a.  garren , m.  berz , a.  bogacz , and r.  palmer for their advice and help .",
    "99    j.  j.  livingood ,  principles of cyclic particle accelerators , \" ( 1961 ) isbn-139780442048228 ; e. d. courant and h. s. snyder ,  theory of the alternating gradient synchrotron , \" annals phys .",
    "* 3 * ( 1958 ) 1 .",
    "d. jeon ,  compact finite difference method for calculating magnetic field components of cyclotrons , \" j.  comput . phys .",
    "* 132 * ( 1997 ) 167 ; d.  jeon ,  finite difference method for calculating magnetic field components off - median plane using median plane field data , \" j. comput . phys .",
    "* 117 * ( 1995 ) 55 .",
    "d.summers _ et al . ,",
    "_ `` 6d muon ionization cooling with an inverse cyclotron , '' aip conf .",
    "* 821 * ( 2006 ) 432 ; d.  j.  summers _ et al . , _ ",
    "6d ionization muon cooling with tabletop rings , \" int .",
    "a20 * ( 2005 ) 3851 ; kevin paul , e.cormier-michel , t.hart , and d.summers ,  recent developments in simulations of an inverse cyclotron for intense muon beams , \" aip conf",
    "* 1299 * ( 2010 ) 676 ; k. paul _",
    "et al . , _  end - to - end simulation of an inverse cyclotron for muon cooling , \" pac-2011-mop051 ; t. hart _ et al . , _  magnetic field expansion out of a plane ... cyclotron development , \" pac-2011-wep190 ; j.eades and l.simons ,  deceleration in an anticyclotron ... low energy @xmath96 , \" nucl.inst.meth.*a278 * ( 1989 ) 368 ; p.  dececco _ et al . , _  low energy @xmath97 beam from the psi anticyclotron , \" hyperfine interact . *",
    "76 * ( 1993 ) 273 ; p.  dececco _ et al . , _  new method to produce @xmath97 beam of kev energies , \" nucl.inst.meth .",
    "* a394 * ( 1997 ) 287 ; d.  horvth _ et al . _",
    " deceleration of mev antiprotons and muons to kev energies  the anticyclotron , \" nucl .",
    "b85 * ( 1994 ) 736 ;   d. horvath ,  the anticyclotron project , \" aip conf . proc .",
    "* 793 * ( 2005 ) 318 ; g.  bollen _ et al .",
    ", _  the cyclotron gas stopper project at the nscl , \" pac07-thpas040 ( 2007 ) pp .",
    "3588 ; g.  bollen _ et al . , _  ... rare isotope beams from high to low energies , \" nucl.inst.meth .",
    "* b266 * ( 2008 ) 4442 .",
    "g.  i.  budker ,  accelerators and colliding beams , \" 1969 yerevan conference , aip conf . proc .",
    "* 352 * ( 1996 ) 4 ; a.  skrinsky and v.  parkhomchuk ,  cooling methods for beams ... , \" sov .",
    "j. part . nucl .",
    "* 12 * ( 1981 ) 223 ; d. neuffer ,  principles and applications of muon cooling , \" part .",
    "* 14 * ( 1983 ) 75 ; d. neuffer ,  multi - tev muon colliders , \" aip conf . proc .",
    "* 156 * ( 1987 ) 201 ; d.neuffer and r.palmer ,  a high - energy , high - luminosity @xmath98 collider , \" epac94-london , pp .",
    "52 ; d.  b.  cline ,  physics potential of a few hundred gev @xmath98 collider , nucl .",
    "* a350 * ( 1994 ) 24 ; d.  j.  summers ,  top , higgs , and supersymmetry at @xmath98 colliders , bull.am.phys.soc.*39 * ( 1994 ) 1818 ; d.neuffer and r.palmer ,  ... high - energy , high - luminosity @xmath98 collider , \" aip conf.proc.*352 * ( 1995 ) 93 ; v.  barger _",
    "et al . , _  s - channel higgs boson production at a @xmath98 collider , \" phys .",
    "* 75 * ( 1995 ) 1462 ; r.  fernow and j.  gallardo ,  muon transverse ionization cooling : stochastic ... , \" phys . rev .",
    "* e52 * ( 1995 ) 1039 ; j.  c.  gallardo _ et al . , _ ",
    "@xmath98 collider : feasiblity study , \" snowmass 1996 , bnl-52503 ; i.  stumer _ et al .",
    ", _  study of detector backgrounds in a @xmath98 collider , \" snowmass 1996 , pp .",
    "463 ; j.  chapman and s.  geer ,  the pixel microtelescope , \" snowmass 1996 , pp .",
    "480 ; g.w.foster and n.mokhov ,  backgrounds , detector ... 4",
    "tev @xmath98 collider , aip conf.proc.*352 * ( 1995 ) 178 ; d.  trbojevic _ et al . , _  lattice for the muon collider demonstration ring in the rhic tunnel , `` pac97 pp.405 ; c.  m.  ankenbrandt _ et al . , _ `` status of muon collider r&d ... plans , '' phys.rev .",
    "beams * 2 * ( 1999 ) 081001 ; d.  ayers _ et al . , _",
    "`` eoi for r&d towards a storage ring neutrino factory and a muon collider , '' physics/9911009 ; r.  palmer , c.  johnson , and e.  keil , ' ' cost - effective design for @xmath99 factory , \" nucl . inst . meth . *",
    "a451 * ( 2000 ) 265 ; a. blondel _",
    "et al . , _  the neutrino factory : beam and experiments , \" nucl .",
    "a451 * ( 2000 ) 102 ; g.  penn and j.  wurtele ,  beam envelopes for muon cooling in solenoids , \" phys.rev.lett.*85 * ( 2000 ) 764 ; c.wang and k.kim ,  linear theory : ionization cooling in 6d phase space , \" phys.rev.lett.*88 * ( 2002 ) 184801 ; j.  norem _ et al .",
    "_  dark current , breakdown , magnetic effects ... , \" phys . rev .",
    "beams * 6 * ( 2003 ) 072001 ; m.  alsharoa _ et al . , _ , ",
    "recent ... @xmath99 factory , @xmath98 collider r&d ... , \" phys . rev .",
    "beams * 6 * ( 2003 ) 081001 ; k.  hoffman , ",
    "muon colliders : from science fiction to real science , \" eur",
    ". j. phys .",
    "* c33 * ( 2004 ) s1059 ; d.  neuffer ,  introduction to muon cooling , \" nucl .",
    "a532 * ( 2004 ) 26 ; r.  b.  palmer _ et al . _  ionization cooling ring for muons , \" phys . rev .",
    "beams * 8 * ( 2005 ) 061003 ; d.neuffer ,  analyses ... of longitudinal motion in @xmath100-recirculating linacs , \" nucl.inst.meth.*a384 * ( 1997 ) 263 ; s.  a.  bogacz ,  low energy stages  ` dogbone ' rla , \" nucl .",
    "proc suppl .",
    "* 149 * ( 2005 ) 309 ; j.  s.  berg _ et al . , _  a cost - effective design for a neutrino factory , \" phys . rev .",
    "beams * 9 * ( 2006 ) 011001 ; m.  apollonio _ et al . , _  accelerator design concept for future neutrino facilities , \" jinst * 4 * ( 2009 ) p07001 ; d.  j.  summers _ et al . , _  muon acceleration to 750 gev in the tevatron tunnel ... , \" pac07 , arxiv:0707.0302 ; r.palmer _ et al . , _ `` a complete scheme of ionization cooling for a muon collider , '' pac07 , arxiv:0711.4275 ; p. snopok _",
    "et al . , _  ... 6d cooling simulations in the guggenheim channel , \" int.j.mod.phys .",
    "* a24 * ( 2009 ) 987 ; y. alexahin ,  helical fofo snake for 6d ionization cooling of muons , \" aip conf . proc .",
    "* 1222 * ( 2010 ) 313 ; s. a. kahn _",
    "et al . , _  high field hts solenoid for muon cooling , \" pac07-mopan118 ; r.palmer , r.fernow , and j.lederman , ",
    "@xmath100 collider final cooling in 30 - 50 t solenoids , \" pac-2011-thobn2 ; d.greenwald , y.bao , and a.caldwell ,  frictional cooling ... muon collider , \" aip conf.proc.*1222 * ( 2010 ) 293 ; y.bao , a.  caldwell , and d.  greenwald ,  a sphere cooler scheme for muon cooling , \" pac-2011-mop017 ; t. j. roberts and d. m. kaplan ,  particle refrigerator , \" pac09-we6pfp096 ; m. muhlbauer _",
    "et al . , _ ",
    "frictional cooling : experimental results , \" hyperfine interact .",
    "* 119 * ( 1999 ) 305 ; a.  d.  bross _ et al .",
    "_  a neutrino factory for both large and small @xmath101 , \" phys",
    "* d77 * ( 2008 ) 093012 ; l.  coney ,  mice overview , \" dpf2009-detroit , arxiv:0910.3479 ; k.  t.  mcdonald _ et al .",
    ", _  the merit high - power target experiment at the cern ps , \" ipac-2010-wepe078 ; y.  torun _ et al . _  the mucool test area and rf program , \" ipac-2010-thpea046 ; r.  b.  palmer _ et al . , _  rf breakdown with and without external magnetic fields , \" arxiv:0809.1633 ; d.  stratakis _ et al . , _  ... magnetic fields ... high - gradient acceleration ... , \" nucl .",
    "a620 * ( 2010 ) 147 ; d. li , r. palmer , d. stratakis , s. virostek , and m. s. zisman ,  ... be cavity design , \" nufact10 , lbnl-4191e ; y.alexahin , e.gianfelice-wendt , a.netepenko ,  ... muon collider ring lattice , \" ipac-2010-tupeb021 ; y. i. alexahin _",
    "et al _ ,  muon collider interaction region design , \" ipac-2010-tupeb022 .",
    "t.  j.  roberts _ et al . , _",
    "`` g4beamline particle tracking in matter - dominated beam lines , '' epac08-wepp120 .    c.  nieter and j.  r.  cary ,  vorpal : a versatile plasma simulation code , \" j. comput .",
    "* 196 * ( 2004 ) 448 .",
    "r.c.fernow , `` icool : a simulation code for ionization cooling of muon beams , '' pac99-thp31 ; r.c.fernow ,  recent developments on the muon - facility design code icool , \" pac05-tppp041 .",
    "h.  grote and f. schmidt , `` mad - x : an upgrade from mad8 '' , pac03-portland ( 2003 ) pp .",
    "a.  garren _",
    " synch : its status and its recent use at sscl , \" aip conf .",
    "* 297 * ( 1994 ) 403 .",
    "f.  mot , `` the ray tracing code zgoubi , '' nucl .",
    "* a427 * ( 1999 ) 353 ; j.  fourrier _ et al . , _  spiral ffag lattice design tools ...",
    "6-d tracking .. , \" nucl .",
    "* a589 * ( 2008 ) 133 .",
    "k.  makino and m.  berz , `` cosy infinity version 9 , '' nucl .",
    "* a558 * ( 2006 ) 346 ; c.johnstone _ et al . , _ ",
    "isochronous ( cw ) non - scalling ffags , \" aip conf .",
    "* 1299 * ( 2010 ) 682 ; k.makino , m.berz , and c.johnstone ,  high - order out - of - plane expansion for 3d fields , \"",
    "int.j.mod.phys.a    m.gordon ,  closed orbits , basic focusing for sector - focused cyclotrons : cyclops , \" part.accel.*16 * ( 1984 ) 39 ; m. m. gordon and t. a. welton ,  computation methods for avf cyclotron design , \" ( 1959 ) ornl-2765 ; m.  k.  craddock and y .- n .  rao ,  ffag tracking with cyclotron codes , \" ipac10-kyoto ( 2010 ) pp . 4319 .",
    "valery lebedev , http://www-bdnew.fnal.gov/pbar/organizationalchart/lebedev/optim/optim.htm .",
    "chun - xi  wang and lee  c.  teng , `` magnetic field expansion in a bent - solenoid channel '' , pac 2001 , pp .",
    "f.  mot and s.  valero , `` zgoubi users guide , version 4 , '' fermilab - tm-2010 ( 1997 ) pp .",
    "14 - 19 .    e.  forest and r.  d.  ruth ,  fourth - order symplectic integration , \" physica * d43 * ( 1990 ) 105 ; h.  yoshida ,  construction of higher order symplectic integrators , \" phys . lett . *",
    "a150 * ( 1990 ) 262 .",
    "an example of a mathematica file which evaluates the coefficients of @xmath102 up to 4th order is shown .",
    "this @xmath103 is simpler than the field of fig .",
    "[ bz0 ] so that the example file and output are reasonably short and clear .",
    "the example file also formats the expressions of the coefficients to fortran .",
    "the next appendix is an example fortran routine which uses the output fortran expressions from this file to generate a grid of magnetic field points used by a g4beamline input file ( appendix c ) .",
    "this mathematica file shows the output of each mathematica command indented .    ....",
    "( * set b as bz(z = 0 ) with ( r , t ) as radius and theta .",
    "* ) b[r_,t _ ] = ( c r^k)(1+f cos[n ( t ) ] )          c r^k ( 1+f cos[n t ] )    ( * set trans as d^2b / dr^2 + ( 1/r)db / r + ( 1/r^2)d^2b / dt^2 . * ) trans[r_,t _ ] = d[b[r , t],{r,2 } ] + ( 1/r)d[b[r , t],{r,1}]+ ( 1/r^2)d[b[r , t],{t,2 } ]         -c f n^2 r^(-2+k ) cos[n t]+c k r^(-2+k ) ( 1+f cos[n t])+c ( -1+k ) k        r^(-2+k)(1+f cos[n t ] )    ( * fullsimplify does an algebraic simplification * ) fullsimplify[% ]         c r^(-2+k ) ( k^2+f ( k - n ) ( k+n ) cos[n t ] )    ( * trans2 is a double application of the derivatives of trans . * ) trans2[r_,t _ ] = d[trans[r , t],{r,2 } ] + ( 1/r)d[trans[r , t],{r,1 } ] +   ( 1/r^2)d[trans[r , t],{t,2 } ]         -c f ( -3+k ) ( -2+k ) n^2 r^(-4+k ) cos[n t]+c ( -3+k ) ( -2+k ) k r^(-4+k )        ( 1+f cos[n t])+c ( -3+k ) ( -2+k ) ( -1+k ) k",
    "r^(-4+k ) ( 1+f cos[n t])+       ( -c f",
    "k n^2 r^(-2+k ) cos[n t]-c f ( -1+k ) k n^2",
    "r^(-2+k ) cos[n t]+       c f n^4",
    "r^(-2+k ) cos[n t])/r^2 + 1/r ( -c f ( -2+k ) n^2 r^(-3+k ) cos[n t]+       c ( -2+k ) k r^(-3+k ) ( 1+f cos[n t])+c ( -2+k ) ( -1+k ) k r^(-3+k )        ( 1+f cos[n t ] ) )    fullsimplify[% ]         c r^(-4+k ) ( ( -2+k)^2 k^2+f ( -2+k - n ) ( k - n ) ( -2+k+n ) ( k+n ) cos[n t ] )    ( * set field components , apply simplifications , convert to * ) ( * fortran format . * )    ( * use o1 , o2 , o3 , and o4 as switches to set order of expansion . * ) ( * for 2nd order , set o1 = 1 , o2 = 1 , o3 = o4 = 0 . * )    ( * set the 0th , 2nd , and 4th order terms of bz(z ) . * ) bz0[r_,t _ ] = b[r , t ]         c r^k ( 1+f cos[n t ] )    fullsimplify[% ]         c r^k ( 1+f cos[n t ] )    fortranform[% ]         c*r**k*(1 + f*cos(n*t ) )    bz2[r_,t _ ] = -(o2)(z^2/2)trans[r , t ]         -(1/2 ) o2 z^2 ( -c f n^2 r^(-2+k ) cos[n t]+c k r^(-2+k ) ( 1+f cos[n t])+       c ( -1+k ) k r^(-2+k ) ( 1+f cos[n t ] ) )    fullsimplify[% ]         -(1/2 ) c o2 r^(-2+k ) z^2 ( k^2+f ( k - n ) ( k+n ) cos[n t ] )    fortranform[% ]         -(c*o2*r**(-2 + k)*z**2*(k**2 + f*(k - n)*(k + n)*cos(n*t)))/2 .",
    "bz4[r_,t _ ] = ( o4)(z^4/24)trans2[r , t ]         1/24 o4 z^4 ( -c f ( -3+k ) ( -2+k ) n^2 r^(-4+k ) cos[n t]+       c ( -3+k ) ( -2+k ) k r^(-4+k ) ( 1+f cos[n t])+       c ( -3+k ) ( -2+k ) ( -1+k ) k r^(-4+k ) ( 1+f cos[n t])+       ( -c f",
    "k n^2 r^(-2+k ) cos[n t]-c f ( -1+k ) k n^2",
    "r^(-2+k ) cos[n t]+       c f n^4 r^(-2+k ) cos[n t])/r^2 + 1/r ( -c f ( -2+k ) n^2 r^(-3+k ) cos[n t]+       c ( -2+k ) k r^(-3+k ) ( 1+f cos[n t])+       c ( -2+k ) ( -1+k ) k r^(-3+k ) ( 1+f cos[n t ] ) ) )    fullsimplify[% ]         1/24 c o4 r^(-4+k ) z^4 ( ( -2+k)^2 k^2+f ( -2+k - n ) ( k - n ) ( -2+k+n ) ( k+n )        cos[n t ] )    fortranform[% ]            ( c*o4*r**(-4 + k)*z**4 *       -     ( ( -2 + k)**2*k**2 +        -       f*(-2 + k - n)*(k - n)*(-2 + k + n)*(k + n)*cos(n*t)))/24 .",
    "( * set the 1st and 3rd order terms of br(z ) . * ) br1[r , t ] = ( o1)z d[b[r , t],{r,1 } ]          c k o1 r^(-1+k ) z ( 1+f cos[n t ] )    fullsimplify[% ]         c k o1 r^(-1+k ) z ( 1+f cos[n t ] )    fortranform[% ]         c*k*o1*r**(-1 + k)*z*(1 + f*cos(n*t ) )    br3[r , t ] = -(o3)(z^3/6)d[trans[r , t],{r,1 } ]         -(1/6 ) o3 z^3 ( -c f ( -2+k ) n^2 r^(-3+k ) cos[n t]+       c ( -2+k ) k r^(-3+k ) ( 1+f cos[n t])+       c ( -2+k ) ( -1+k ) k r^(-3+k ) ( 1+f cos[n t ] ) )    fullsimplify[% ]         -(1/6 ) c ( -2+k ) o3 r^(-3+k ) z^3 ( k^2+f ( k - n ) ( k+n ) cos[n t ] )    fortranform[% ]            -(c*(-2 + k)*o3*r**(-3 + k)*z**3 *       -      ( k**2 + f*(k - n)*(k + n)*cos(n*t)))/6 .",
    "( * set the 1st and 3rd order terms of btheta(z ) . * ) bt1[r , t ] = ( o1)z ( 1/r ) d[b[r , t],{t,1 } ]         -c f n o1 r^(-1+k ) z sin[n t ]    fullsimplify[% ]         -c f n o1 r^(-1+k ) z sin[n t ]    fortranform[% ]         -(c*f*n*o1*r**(-1 + k)*z*sin(n*t ) )    bt3[r , t ] = -(o3)(z^3/6)(1/r)d[trans[r , t],{t,1 } ]         -1/(6 r ) o3 z^3 ( -c f k n r^(-2+k ) sin[n t]-       c f ( -1+k ) k n r^(-2+k ) sin[n t]+c f n^3 r^(-2+k ) sin[n t ] )    fullsimplify[% ]         1/6 c f ( k - n ) n ( k+n ) o3 r^(-3+k ) z^3 sin[n t ]    fortranform[% ]         ( c*f*(k - n)*n*(k + n)*o3*r**(-3 + k)*z**3*sin(n*t))/6 . ....",
    "this program takes the output expressions of @xmath104 , @xmath105 , and @xmath106 from mathematica and prints out a grid of magnetic field values recast as @xmath107 , @xmath108 , and @xmath6 .",
    "the output file generated by this routine is fort.71 . with",
    "further formatting described in the initial comments of the routine , the output file can be used by a g4beamline input file to generate a magnetic field for an anticyclotron simulation . in this example",
    ", the field componenets are expanded to 4th order in @xmath7 .    ....",
    "program fourth_order_arxiv_example    c            c   prints out grid of ( bx , by , bz ) in ( x , y , z ) for a file suitable for the c   g4beamline command ' fieldmap ' .",
    "c c   the output of this program is fort.71 .",
    "c c   distances in the fort.71 file are in mm . , and magnetic fields are   c   in tesla .",
    "( distances in this fortran routine are in meters . )",
    "c c   the following must be added to fort.71 for the file to work in g4beamline : c c   grid x0=[smallest x ] y0=[smallest y ] z0=[smallest z ] nx=[number of x points ] c ny=[number of y points ] nz=[number of z points ] dx=[dist . between x",
    "points ] c dy=[dist . between y",
    "points ] dz=[dist . between z points ] c   data c          implicit none          integer i , j , l          real*8 x , y , z , r , t        real*8 bz0,bz2,bz4,br1,br3,bt1,bt3        real*8 bx , by , bz , br , bt          real*8 pi , e        real*8 b , c , k , s , f , n          real*8 o1,o2,o3,o4          e = 2.718281828d+0        pi = acos(-1.0d+0 )    c   bz(z=0 ) = ( c*r^k)*(1+f*cos(n(t ) ) )     c   bz(z = 0 ) parameters        b = 25.0d+0        c = 1.77d+0        k = 0.6d+0        s = ( pi/180.0d+0)*0.0d+0        f = sqrt(2.0d+0 )        n = 6.0d+0    c   o1 through o4 set the order of the expansion in z of bz(z=0 ) c   4th order :   o4 = o3 = o2 = o1 = 1 c   3rd order :   o4 = 0 , o3 = o2 = o1 = 1 c   2nd order :   o4 = o3 = 0 , o2 = o1 = 1 c   1st order :   o4 = o3 = o2 = 0 , o1 = 1 c   0th order :   o4 = o3 = o2 = o1 = 0          o1 = 1.0d+0        o2 = 1.0d+0        o3 = 1.0d+0        o4 = 1.0d+0     c   loop over x , y , z        do 100 i = 1 , 201          do 200 j = 1 , 201            do 300 l = 1 , 61    c   x , y , z , r in meters c   t in radians c   br , bt , bz in tesla                x = -1.01d+0 + 0.01d+0*i              y = -1.01d+0 + 0.01d+0*j              z = -0.31d+0 + 0.01d+0*l                r = sqrt(x*x+y*y )                t = atan2(y , x )    c   br , bt , bz formula determined through and copied and pasted from mathematica    c   bz terms up to 4th order              bz0 = c*r**k*(1 + f*cos(n*t ) )                bz2 = -(c*o2*r**(-2 + k)*z**2*(k**2 +        -              f*(k - n)*(k + n)*cos(n*t)))/2 .",
    "bz4 = ( c*o4*r**(-4 + k)*z**4 *       -         ( ( -2 + k)**2*k**2 +        -         f*(-2 + k - n)*(k - n)*(-2 + k + n)*(k + n)*cos(n*t)))/24 .",
    "c   br terms up to 4th order              br1 = c*k*o1*r**(-1 + k)*z*(1 + f*cos(n*t ) )                br3 = -(c*(-2 + k)*o3*r**(-3 + k)*z**3 *       -        ( k**2 + f*(k - n)*(k + n)*cos(n*t)))/6 .",
    "c   bt terms up to 4th order              bt1 = -(c*f*n*o1*r**(-1 + k)*z*sin(n*t ) )                bt3 = ( c*f*(k - n)*n*(k + n)*o3*r**(-3 + k)*z**3*sin(n*t))/6 .",
    "c   add each order to get bz , br , bt              bz = bz0 + bz2 + bz4                br = br1 + br3                bt = bt1 + bt3    c   transform br , bt to bx , by              bx = br*cos(t)-bt*sin(t )                by = br*sin(t)+bt*cos(t )                           write(71,174 ) 1000*x,1000*y,1000*z , bx , by , bz,0.0    174          format(f8.1,\",\",f8.1,\",\",f8.1,\",\",f9.3,\",\",f9.3,\",\",f9.3 ,       1              \" , 0.0 , 0.0 , \" , f7.3 )     300       continue   200     continue        100   continue             end ....    here are the first 10 lines in the fort.71 output file .    ....",
    "head fort.71   -1000.0 , -1000.0 ,   -300.0 ,    -3.318 ,     3.712 ,     2.162 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -290.0 ,    -3.160 ,     3.542 ,     2.163 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -280.0 ,    -3.007 ,     3.375 ,     2.164 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -270.0 ,    -2.859 ,     3.214 ,     2.165 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -260.0 ,    -2.716 ,     3.057 ,     2.166 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -250.0 ,    -2.576 ,     2.904 ,     2.167 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -240.0 ,    -2.441 ,     2.756 ,     2.168 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -230.0 ,    -2.310 ,     2.611 ,     2.169 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -220.0 ,    -2.182 ,     2.471 ,     2.170 , 0.0 , 0.0 ,    0.000   -1000.0 , -1000.0 ,   -210.0 ,    -2.058 ,     2.334 ,     2.171 , 0.0 , 0.0 ,    0.000 ....    with a grid spacing of 10 @xmath109 ranging from @xmath110 and @xmath111 , the following lines need to be placed at the start of ` fort.71 ` to match the syntax required by the g4beamline command ` fieldmap `    .... param normb=1.0000 norme=0.0000 grid x0=-1000 y0=-1000 z0=-300 nx=201 ny=201 nz=61 dx=10 dy=10 dz=10 data ....",
    "an example g4beamline@xcite input file of positive muons being decelerated in an anticycloton is shown .",
    "the file ` test_bfield_6sector_rk06_0d_2nd_order_cos_example.dat ` as specified in the ` fieldmap field_grid file = test_bfield_6sector_rk06_0d_2nd_order_cos_example.dat ` command is needed to generate the outer sectored focusing field .",
    "the inner magnetic bottle is generated by the field from two current carrying coils .",
    "muons lose energy by passing through @xmath112 lithium hydride wedges . the uniform @xmath112 wedge angle in this example file is simpler than the moderator configuration used for the anticyclotron .",
    "the anticyclotron includes an inner cylinder of 0.1 @xmath113 helium and six lih wedges whose thickness decreases adiabatically from 4.2 @xmath109 at @xmath114 to @xmath115 at @xmath116 .",
    "the output is a root file , ` alltracks.root ` , which shows all the kinematic information of each muon along its orbit , and which can be opened by ` historoot ` .",
    ".... * example g4beamline file for anticyclotron simulation , april 11 , 2011 * # use tjr recommended physics routines physics qgsp_bert dostochastics=1 disable = decay    # reference particle with no stochastic processes particlecolor reference=1,1,1 reference referencemomentum=180 particle = mu+ \\",
    "beamx=0.0 beamy=500.0 beamz=0.0 meanxp=0.0 meanyp=0.0 rotation = x90,z90    # simulate 3 muons with stochastic processes ( since dostochastics=1 ) beam gaussian particle = mu+ nevents=3 \\",
    "beamx=0.0 beamy=500.0 beamz=0.0 meanxp=0.0 meanyp=0.0 \\",
    "sigmax=0 sigmay=0 sigmaxp=0 sigmayp=0 \\",
    "meanmomentum=180.00 sigmap=0 meant=0 sigmat=0   rotation = x90,z90     # keep only positive muons trackcuts keep = mu+ maxtime=200000.0    # output file for historoot showing kinematic information for orbits trace ntrace=3 format = root filename = alltracks.root onentuple=1 primaryonly=1    # output file for historoot showing kinematic information when particles are lost   beamlossntuple loss_ntuple format = ascii    param maxstep=5 .",
    "steppingverbose=1    # lithium hydride , density ( 0.82 g / cm^3 ) from wikipedia material lih z=4 a=8",
    "density=0.82 state = s    # define lih wedges , each with 1 degree angle tubs gascylinder_1 innerradius=2 outerradius=600 length=200",
    "\\    initialphi=30 - 0.5 finalphi=30 + 0.5 color=1,0,0 material = lih tubs gascylinder_2 innerradius=2 outerradius=600 length=200",
    "\\    initialphi=90 - 0.5 finalphi=90 + 0.5 color=1,0,0 material = lih tubs gascylinder_3",
    "innerradius=2 outerradius=600 length=200 \\    initialphi=150 - 0.5 finalphi=150 + 0.5 color=1,0,0 material = lih tubs gascylinder_4 innerradius=2 outerradius=600 length=200 \\    initialphi=210 - 0.5 finalphi=210 + 0.5 color=1,0,0 material = lih tubs gascylinder_5 innerradius=2 outerradius=600 length=200 \\    initialphi=270 - 0.5 finalphi=270 + 0.5 color=1,0,0 material = lih tubs gascylinder_6 innerradius=2 outerradius=600 length=200 \\",
    "initialphi=330 - 0.5 finalphi=330 + 0.5 color=1,0,0 material = lih    # define coils of inner magnetic bottle coil   coil1 \\      innerradius=195 \\      outerradius=205 \\",
    "length=50 \\      material = vacuum \\      filename = coil1.dat    coil   coil2 \\      innerradius=195 \\",
    "outerradius=205 \\",
    "length=50 \\      material = vacuum \\",
    "filename = coil2.dat    # set currents for magnetic bottle coils which provide inner bottle magnetic field solenoid   c1 \\          coilname = coil1 \\",
    "current=(0.2)*10803.6 \\          color=0.3,1,0 \\          alternate=0    solenoid   c2 \\          coilname = coil1 \\",
    "current=(0.2)*10803.6 \\          color=0.3,1,0 \\",
    "alternate=0    # grid of magnetic field points for outer sectored field fieldmap field_grid file = test_bfield_no_poly_bottle_6sector_rk06_0d_2nd_order_beq25_cos.dat    # place wedges , coils , and magnetic field map grid place gascylinder_1 z=0 place gascylinder_2 z=0 place gascylinder_3 z=0 place gascylinder_4 z=0 place gascylinder_5 z=0 place gascylinder_6 z=0    place c1 x=0 y=0 z=200 place c2 x=0 y=0 z=-200    place field_grid x=0 y=0 z=0 ....    fig .",
    "[ g4bl_orbits ] shows a ` historoot ` visualation of the orbits of three muons in this g4beamline example simulation .",
    "the muons stop in about 125 @xmath117 .",
    "another program which can simulate an anticyclotron with lithium hydride wedges is icool@xcite .",
    "the coordinate system of icool is an @xmath118 coordinate system in which the @xmath7 coordinate is along the beamline .",
    "this can be converted to an @xmath119 system by incorporating a bent solenoid so that @xmath120 becomes @xmath121 , @xmath122 becomes @xmath7 , and the reference path coordinate , @xmath7 , becomes @xmath11 .",
    "icool does not have the visualization capabilites of g4beamline so software to check element placement , orbits , and dynamics must be added .",
    "icool can do its own magnetic field expansion@xcite to check an orbit at a particular radius .",
    "this can provide a cross check of g4beamline .",
    "icool can be run on unix , pc , and macintosh platforms .",
    "the command file needs to be called ` for001.dat ` . in this particular application of icool ,",
    "two more input files are used : ` for003.dat ` which defines each particle of the beam and ` for056.dat ` which defines the magnetic field . the output file in the example simulation",
    "is ` for009.dat ` which lists the kinematic information of each particle .",
    "postprocessing of this file is needed to visualize the orbits and to evaluate the dynamics",
    ".                this command files uses a bent solenoid magnetic field to simulate a cyclotron field .",
    "the ` bsol ` command sets the initial muon momentum to 0.18 @xmath123 , the inverse radius of the bent solenoid to 2.0 @xmath124 , and reads the amplitude , period , and initial offset of the sinusoidal vertical magnetic field ( @xmath125 where @xmath122 is vertical and @xmath7 is along the reference path ) from the file ` fort.56 ` . in this icool example , muons lose energy by passing through @xmath126 lithium hydride wedges .",
    "the magnetic field in this example does not vary with radius is in the g4beamline example of appendix c. the geometry of the anticyclotron is specified by ` sregions ` .",
    "one ` sregion ` of the lithium hydride wedge is followed by 10 ` sregions ` of vacuum , and the sequence of 11 ` sregions ` is repeated 600 times .",
    "the total length of the 11 ` sregions ` is @xmath127 which corresponds to 1/6 of the circumference of a @xmath128 circle .",
    "this arrangement is set for a 6-sector anticyclotron with a bent solenoid radius of @xmath128 .",
    "$ bmt $ 1 2 1 . 1               ! ntyp typ(1e",
    "2mu 3pi 4k 5p ) frac dist(1=gauss 2=ring ) -0.010   0.019    0",
    ".   0 .    0 .",
    "0.203   ! means : x y z px py pz 0.0425   0.0425 .18 .030 .030   0.024     !",
    "sigmas :      \" 1                                     ! correlations 2   .19   .40   0                        ! palmer   gev / a^2 beta                      output sregion                        ! define a region                .023598775 1 0.0001                    !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           ! no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 . 0 .",
    "lih vac                        !",
    "lih material surrounded by vacuum wedge 1 0.5 0.01 180 1.0 1.5 0 .",
    "0 . 0 .       !",
    "angle rvert zvert azymuth apx apy    output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0 . 2                         ! radial extent none                           ! no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    ". vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0",
    "0 . 0 . 0 .",
    "0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0 . 2                         !",
    "radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    ". 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0 . 2                         !",
    "radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0 . 0 .",
    ". 0 . 0 . 0",
    ".    output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0",
    "0 . 0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0 . 2                         !",
    "radial extent none                           ! no associated field 0 .",
    "0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0",
    ". vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 .",
    ". vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 .",
    "output sregion                        !",
    "define a region                .05 1 0.001             !",
    "length , 1 radial subregion , step 1 0",
    ". 2                         ! radial extent none                           !",
    "no associated field 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "0 . 0 . 0 . 0 .",
    "vac                            !",
    "vacuum cblock                         !",
    "cylindrical block geometry 0 . 0",
    "0 . 0 . 0 . 0 .",
    "0 . 0 .",
    "this input file defines the initial positions and momenta of three input muons .",
    "the initial positions are set to zero with respect to the 0.5 m reference radius of the bent solenoid field .",
    "the initial momentum of the three muons is 0.18 @xmath123 in the @xmath7 direction .",
    "title 0   0   0   0   0   0   0   0       1 0 2 0    0.0000e+00 1.0 0.00e-00   0.0000e+00   0.0000e+00 0.0000e-03   0.0000e+00   1.8000e-01 0 0 0 0 0 0      2 0 2 0    0.0000e+00 1.0 0.00e-00   0.0000e+00   0.0000e+00 0.0000e-03   0.0000e+00   1.8000e-01 0 0 0 0 0 0      3 0 2 0    0.0000e+00 1.0 0.00e-00   0.0000e+00   0.0000e+00 0.0000e-03",
    "0.0000e+00   1.8000e-01 0 0 0 0 0 0 ....",
    "this file sets the parameters of the bent solenoid field .",
    "this field is sinusoidal with respect to the @xmath7 coordinate ( in icool , the vertical component is @xmath122 and @xmath7 is the coordinate along the reference path . ) .",
    "the period is about 0.5236 @xmath29 corresponding to 1/6 the circumference of a circle with reference radius of 0.5 @xmath29 .",
    "the field is independent with respect to radius and depends on the @xmath7 coordinate as @xmath129 where the field is in tesla and the distance is in meters .",
    "test 6 sector anticyclotron   0.523598775   1   1   1   1   1   1   1   1   1   1   1   1   1 1 n      s            d      a           q   0   0   0 1.167764501   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0   0   0   0   1   0   0 -1.651468395   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0     0   0   0   0   0 ....        .... # test ring 180 mev ( h5b )                                                          #   units = [ s ] [ m ]   [ gev / c ] [ t ] [ v / m ]   #    evt par typ   flg reg   time       x         y        z     px",
    "py       pz        bx        by       bz      wt ex   ey ez arc     polx poly polz        0   0    2     0    1   0.0e+00 0.0e+00   0.0e+00 0.0e+00    0.0e+00   0.0e+00 1.8e-01",
    "0.0e+00   0.0e+00   0.0e+00   1    0   0   0 0.0e+00      0     0     0        1   0    2     0    1   0.0e+00 0.0e+00   0.0e+00 0.0e+00    0.0e+00   0.0e+00 1.8e-01   0.0e+00   0.0e+00   0.0e+00   1    0   0   0 0.0e+00      0     0     0        2   0    2     0    1   0.0e+00 0.0e+00   0.0e+00 0.0e+00    0.0e+00   0.0e+00 1.8e-01   0.0e+00   0.0e+00   0.0e+00   1    0   0   0 0.0e+00      0     0     0        3   0    2     0    1   0.0e+00 0.0e+00   0.0e+00 0.0e+00    0.0e+00   0.0e+00 1.8e-01   0.0e+00   0.0e+00   0.0e+00   1    0   0   0 0.0e+00      0     0     0        0   0    2     0    5   9.1e-11 0.0e+00   0.0e+00 2.4e-02    0.0e+00   0.0e+00 1.8e-01   0.0e+00 -4.2e-01   0.0e+00   1    0   0   0 2.4e-02      0     0     0        1   0    2     0    5   9.2e-11 7.8e-04   1.2e-04 2.4e-02    1.1e-02   1.9e-03 1.7e-01   2.4e-10 -4.2e-01   6.4e-04   1    0   0   0 2.4e-02      0     0     0        2   0    2     0    5   9.2e-11 1.1e-03 -7.4e-05 2.4e-02    1.5e-02 -1.7e-03 1.7e-01 -6.2e-11 -4.2e-01 -4.1e-04   1    0   0   0 2.4e-02      0     0     0        3   0    2     0    5   9.2e-11 7.8e-04 -1.6e-04 2.4e-02    1.2e-02 -1.5e-03 1.8e-01 -6.2e-10 -4.2e-01 -8.8e-04   1    0   0   0 2.4e-02      0     0     0 ....    the orbit in the lab @xmath130 plane can be viewed with ` historoot ` which can be obtained by downloading ` g4beamline ` from ` www.muonsinc.com ` . with ` for009.dat ` as the input file to ` historoot ` , the orbit in the lab @xmath130 frame is obtained by plotting @xmath131 vs. @xmath132 . the radius is the lab frame of the anticyclotron is @xmath133 where @xmath120 is the the horizontal coordinate with respect to the icool reference path which has a bent solenoid radius of curvature @xmath128 . fig .",
    "[ icool ] shows the orbits of three muons in this example icool anticyclotron simulation which are stopped in about 200 @xmath117 ."
  ],
  "abstract_text": [
    "<S> in studies of the dynamics of charged particles in a cyclotron magnetic field , the specified field is generally @xmath0 in the @xmath1 midplane where @xmath2 and @xmath3 are zero . </S>",
    "<S> @xmath4 and @xmath5 are simple to determine through a linear expansion which assumes that @xmath6 is independent of @xmath7 . </S>",
    "<S> but , an expansion to only first order may not be sufficient for orbit simulations at large @xmath7 . </S>",
    "<S> this paper reviews the expansion of a specified @xmath8 out of the @xmath9 midplane to arbitrary order , and shows simple examples worked out to 4th order .    </S>",
    "<S> * magnetic field expansion out of a plane : *    * application to inverse cyclotron muon cooling *    * t. l. hart and d. j. summers , u.  mississippi - oxford , university , ms 38677 , usa *    * k. paul , tech - x corporation , boulder , co 80303 , usa * </S>"
  ]
}