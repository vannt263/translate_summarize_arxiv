{
  "article_text": [
    "understanding heat transport is key in many fields of science and technology , such as materials and planetary sciences , energy saving , heat dissipation and shielding , or thermoelectric conversion , to name but a few .",
    "heat transport in insulators is determined by the dynamics of atoms , the electrons following adiabatically in their ground state . simulating atomic heat transport usually relies on boltzmann s kinetic approach @xcite , or on molecular dynamics ( md ) , both in its equilibrium ( green - kubo , gk @xcite ) and non - equilibrium @xcite flavors .",
    "the boltzmann equation only applies to crystalline solids well below melting , whereas classical md ( cmd ) bears on those materials and conditions that can be modeled by inter - atomic potentials .",
    "equilibrium ab - initio ( ai ) md @xcite is set to overcome these limitations , but it is still surprisingly thought to be unfit to cope with thermal transport _ because in first - principles calculations it is impossible to uniquely decompose the total energy into individual contributions from each atom _ ( excerpted from ref . ) .",
    "such a unique decomposition is not possible in classical mechanics either , because the potential energy of a system of interacting atoms can be partitioned into local contributions in an infinite number of equivalent ways .",
    "the quantum mechanical energy density is also affected by a similar indeterminacy .",
    "notwithstanding , the expression for the heat conductivity derived from any sensible energy partitioning or density should obviously be well defined , as any measurable quantity must .    in this work",
    "we first demonstrate that the thermal conductivity resulting from the gk relation is unaffected by the indeterminacy of the microscopic energy density ; we then introduce a form of energy density , and a corresponding adiabatic energy flux , from which heat transport coefficients can be computed within the gk formalism , using density - functional theory ( dft ) .",
    "our approach is validated by comparing the results of equilibrium aimd with those of non - equilibrium ( mller - plathe , mp @xcite ) aimd and equilibrium cmd simulations for a liquid - argon model , for which accurate inter - atomic potentials are derived by matching the forces generated by them with quantum - mechanical forces computed along the aimd trajectories .",
    "the case of molecular fluids is finally addressed , and illustrated in the case of water at ambient conditions .",
    "according to the gk theory @xcite , the atomic thermal conductivity of an isotropic system is given by : @xmath0 where brackets @xmath1 indicate canonical averages , @xmath2 is the boltzmann constant , @xmath3 and @xmath4 the system volume and temperature , @xmath5 is the macroscopic heat flux , @xmath6 , @xmath7 ,",
    "@xmath8 , and @xmath9 being the energy - current density , local velocity field , and equilibrium values of pressure and energy density , respectively @xcite . for further reference , we define as _ diffusive _ a flux that results in a non - vanishing gk conductivity , according to eq . .",
    "the integral of the velocity field is non diffusive in solids and can be assumed to vanish in one - component fluids , because of momentum conservation . in these cases , as well as in molecular fluids as we will see , we can therefore assume that heat and energy fluxes coincide .",
    "energy is extensive : it can thus be expressed as the integral of a density , which is defined up to the divergence of a bounded vector field : two densities that differ by such a divergence , @xmath10 and @xmath11 , are indeed equivalent , in that their integrals differ by a surface term , which is irrelevant in the thermodinamic limit , and can thus be thought of as _ different gauges _ of a same scalar field .",
    "energy is also conserved : therefore , for any given gauge of its density , @xmath12 , a corresponding current density , @xmath6 , can be defined so as to satisfy the continuity equation : @xmath13 according to eq .",
    "the macroscopic fluxes in two different energy gauges differ by a total time derivative , which is non - diffusive : @xmath14 , where @xmath15 . the equality of the corresponding heat conductivities results from the following    _ lemma_let @xmath16 and @xmath17 be two macroscopic fluxes defined for a same system , and @xmath18 their sum .",
    "the corresponding gk conductivities , @xmath19 , @xmath20 , and @xmath21 satisfy the relation : @xmath22 .",
    "_ proof_let the _ energy displacement _ associated with the flux @xmath23 be defined as : @xmath24 .",
    "the standard einstein relation @xcite states that : @xmath25 ; it follows that : @xmath26 .",
    "canonical averages of products of phase - space functions can be seen as scalar products : the lemma then follows from the cauchy - schwartz inequality , as applied to the last relation .",
    "the application of the gk methodology to multi - component fluids requires some generalizations because the presence of multiple atomic species and the existence of additional hydrodynamical modes ( one conserved number per atomic species ) do not permit to identify the velocity field with the mass - current density , its integral with the total momentum , and the heat flux with the energy flux . in molecular fluids",
    ", however , this identification can still be done because the integral of the velocity field , while not a constant , is a non - diffusive flux , thus not contributing to the heat conductivity . in order to demonstrate this statement",
    ", we first define the fluxes @xmath27 , where @xmath28 and @xmath29 indicate any two atomic species , @xmath30 their stoichiometric ratio , and @xmath31 is the sum of the velocities of all the atoms of a same species @xmath32 .",
    "the integral @xmath33 is equal to the sum of the variations of all the @xmath34 relative positions in a same molecule , which is bound by the sum of the variations of all the @xmath34 distances .",
    "@xmath35 is therefore a non - diffusive flux .",
    "we have @xmath36 such non - diffusive fluxes , @xmath37 being the number of species , of which only @xmath38 are linearly independent ; furthermore the flux @xmath39 ( @xmath40 is the mass of the @xmath32-th atomic species ) is the total momentum , and is thus non - diffusive .",
    "we have therefore @xmath37 independent linear combinations of the @xmath41 fluxes that are non - diffusive .",
    "we conclude that all of them , as well as their sum , @xmath42 , are also non - diffusive .    in order to derive an expression for the macroscopic energy flux appearing in the gk formula , eq . , we first multiply the continuity equation , eq . , by @xmath43 and integrate by parts , to obtain the first moment of the time derivative of the energy density : @xmath44 in periodic boundary conditions ( pbc ) eq . is ill - defined for the very same reason why macroscopic polarization in dielectrics is so @xcite . in cmd",
    "the usual expression for the energy flux in terms of atomic energies and forces @xcite is recovered from eq . by the somewhat arbitrary definition : @xmath45 , where @xmath46 , @xmath47 , and @xmath48 are the atomic energies , positions , and velocities , and by reducing the resulting expression to a boundary - insensitive form . in dft",
    "an energy density can be defined , which is however inherently ill - determined because of the non - uniqueness of the quantum - mechanical kinetic and classical electrostatic energy densities @xcite .",
    "our previous analysis demonstrates that , in spite of previous worries to the contrary , the transport coefficients derived from a dft energy density through the gk formula , eq .",
    ", are well defined , provided a macroscopic energy flux can be computed from eq . in pbc . to this end , among many equivalent gauges , we choose to represent the dft total energy as the integral of the density :    @xmath49    where @xmath50 are bare ionic energies ; @xmath51 , @xmath52 , and @xmath53 being ionic masses , charges , and electrostatic energies , respectively ; the electron charge is assumed to be one ; @xmath54 is the instantaneous kohn - sham ( ks ) hamiltonian , @xmath55 s its occupied eigenfunctions , and @xmath56 the ground - state electron - density distribution ; @xmath57 and @xmath58 are hartree and exchange - correlation ( xc ) potentials , and @xmath59 is a local xc energy per particle , defined by the relation : @xmath60(\\mathbf{r})\\rho(\\mathbf{r})d\\mathbf{r}$ ] . is also to some extent ill - defined , in that any xc densities resulting in a same integral should be considered as equivalent . ]",
    "the energy density of eq .",
    "depends on time through atomic positions and velocities and ks orbitals . inserting its time derivative into eq . and using the born - oppenheimer ( bo ) equations of motion for the nuclei ( @xmath61 ) , the resulting adiabatic energy flux can be expressed as : @xmath62 the five fluxes in eq .",
    "are defined as : @xmath63 , \\label{eq : j_n } \\\\",
    "\\mathbf{j}_{xc } & = \\begin{cases } 0 & \\text{(lda ) } \\\\        -\\int\\rho(\\mathbf{r})\\dot{\\rho}(\\mathbf{r } ) \\partial\\epsilon_{gga }        ( \\mathbf{r})d\\mathbf{r } & \\text{(gga ) } , \\label{eq : j_xc } \\end{cases}\\end{aligned}\\ ] ] where @xmath64 in eq . is the @xmath65-th eigenvalue of the ks hamiltonian ; @xmath66 and @xmath67 in eqs .",
    "( [ eq : j_h]-[eq : j_n ] ) indicate the gradients with respect to the argument of the function and to the @xmath68-th atomic position , respectively ; the simbol @xmath69 in eq .",
    "indicates the ( possibly non - local ) ionic ( pseudo- ) potential acting on the electrons ; finally , `` lda '' and `` gga '' in eq .",
    "indicate the local - density @xcite and generalized - gradient @xcite approximations to the xc energy functional , respectively , and @xmath70 the derivative of the gga xc local energy per particle with respect to density gradients .",
    "eq . can be derived from eqs .",
    "( [ eq : macroscopic - current]-[eq : epsilon_dft ] ) with some tedious but straightforward algebra ( see _ methods _ ) .",
    "the last four terms on its right - hand side , eqs .",
    "( [ eq : j_h][eq : j_xc ] ) , are manifestly boundary - insensitive , whilst the first , eq . , is not , because the position operator appearing therein is ill - defined in pbc . within the adiabatic time evolution that is assumed in aimd ,",
    "however , the time derivative of a ks orbital , as well as its product with the ks hamiltonian , are orthogonal to the orbital itself in the `` parallel transport '' gauge where ks orbitals are real @xcite : @xmath71 and @xmath72 therefore , in order to evaluate eq .",
    ", one only needs the projection of @xmath73 onto the manifold orthogonal to * @xmath55 * , which is well defined in pbc . actually , by expanding @xmath74 in the basis of the eigenstates of the instantaneous ks hamiltonian @xcite",
    ", one sees that only the projection of @xmath73 onto the empty - state manifold , @xmath75 contributes to @xmath76 , where @xmath77 and @xmath78 is the @xmath79-th cartesian component of @xmath43 .",
    "using the standard prescription adopted in density - functional perturbation theory ( dfpt ) , such a projection can be computed by solving the linear equation @xcite : @xmath80| \\varphi_{v}\\rangle,\\label{eq : dfpt}\\ ] ] where the ill - definedness of the solution , due to the singularity of the left - hand side , is lifted by enforcing its orthogonality to the occupied - state manifold . in terms of the @xmath81 s eq .",
    "reads : @xmath82    the flux in eq .",
    "is not manifestly invariant with respect to the arbitrary choice of the zero of the one - electron energy levels . a shift of the energy zero by a quantity @xmath83 results in a shift of the kohn - sham energy flux : @xmath84 where @xmath85 is the adiabatic electronic macroscopic flux introduced in ref .",
    "the electronic current is the difference between the total charge current and its ionic component : the first is by definition non - diffusive in insulators , while the second is so in mono - atomic and molecular systems , as we have seen when discussing the latter .",
    "we conclude that the electronic flux is non - diffusive in insulators , thus not contributing to their heat conductivity and lifting the apparent indeterminacy of eq . .",
    "the methodology presented above has been implemented in the quantum espresso suite of computer codes @xcite : a car - parrinello ( cp ) @xcite aimd trajectory is first generated using the ` cp.x ` code ; the energy flux is then evaluated along this trajectory according to eqs .",
    "( [ eq:5js]-[eq : j_n ] ) by an add - on to the ` pw.x ` code implemented using several dfpt routines borrowed from the ` ph.x ` code ; the thermal conductivity is finally computed from the gk relation , eq . , or the equivalent einstein relation @xcite .    in order to demonstrate this methodology , we compare its predictions with those from cmd @xcite for a system whose dft bo energy surface can be accurately mimicked by pair potentials .",
    "not aiming at a realistic description of any specific system , but rather at the ease and accuracy of the classical representation of the dft bo surface , we choose liquid argon and use the lda xc functional , in spite of the well known inability of the latter to capture dispersion forces .",
    "this reference system will be dubbed `` lda - ar '' .",
    "ks orbitals are treated within the plane - wave ( pw ) pseudo - potential ( pp ) method @xcite .",
    "our model consists of 108 atoms in a periodically repeated cubic supercell with an edge of 33 a.u .",
    ", corresponding to a density of 1.34 @xmath86 aimd trajectories were generated via the car - parrinello dynamics @xcite for 100 picoseconds ( ps ) , using a time step of 0.242 femtoseconds ( fs ) and a fictitious electronic mass of 1000 electronic masses , at two different temperatures , @xmath87 and @xmath88 .",
    "the fictitious electronic temperature was monitored and checked not to be subject to any significant drift .",
    "the bo energy surface was modeled with a sum of classical pair potentials of the form @xmath89 , where @xmath90 is a second - order polynomial , whose parameters were determined independently for each temperature by a least - square fit of the classical vs. quantum - mechanical forces computed along the aimd trajectory .",
    "self - diffusion coefficients of @xmath91 , and @xmath92 were estimated along the two aimd trajectories , in close agreement with the cmd values @xmath93 , and @xmath94 , thus confirming the quality of the classical model .",
    "radial distribution functions computed from aimd and cmd trajectories were also found to be very similar .    }",
    "( b ) @xmath95}$ ] ( see text ) .",
    "blue : aimd ( 100 ps ) .",
    "orange , cmd ( 100 ps ) .",
    "green , cmd ( 1000 ps ) .",
    "the shaded areas depict statistical errors as estimated from a block analysis of our md trajectories .",
    "[ fig : ar - correlation ] ]    in fig .",
    "[ fig : ar - correlation]a we compare the time correlation functions of the energy flux in lda ar , as computed from aimd and cmd at @xmath96 .",
    "the cmd and aimd correlation functions differ not quite because they correspond to different systems  which are actually close enough as to have very similar equilibrium and diffusion properties  as because the aimd and cmd fluxes derive from a different unpacking of the total energy into local contributions . in fig .",
    "[ fig : ar - correlation]b we display the integrals @xmath97 ; the aimd and cmd heat conductivities , @xmath98 , coincide within statistical errors with each other and with the cmd value evaluated from a 1-ns - long simulation : ( @xmath99 , @xmath100 , and @xmath101 ) @xmath102 $ ] , respectively . a similar level of agreement is obtained for the other temperature , @xmath103 ( @xmath104 , @xmath105 , and @xmath106 ) @xmath102 $ ] .    in order to further validate these results",
    ", we have recomputed the thermal conductivities of our lda - argon model , using non - equilibrium ( mp ) aimd @xcite",
    ". a detailed comparison of gk _ vs. _ mp aimd for heat - transport simulations is out of the scope of the present paper , and we have limited ourselves to two mp simulations , aimed at mimicking the physical conditions of the gk aimd simulations reported above , and performed using minimal simulation settings : we used @xmath107 supercells , where the notation indicates multiples of a 4-atom cubic unit cell , thus resulting in 80-atom tetragonal supercells whose size was chosen so as to result in the same mass density of @xmath108 as used before .",
    "mp simulations were performed by subdividing the supercell in eight equally spaced layers stacked along the c axis and by swapping the velocities of the hottest atom in the cool region and the coolest atom in the hot region every picosecond . rather long simulations ( @xmath109 ) were necessary to achieve an acceptable statistical accuracy , resulting in estimated thermal conductivities of @xmath110 and @xmath111 $ ] at the temperatures of @xmath112 and @xmath113 , respectively .",
    "our gk and mp aimd results are compared in fig .",
    "[ fig : mp - gk_comparison ] , witnessing to a convincing validation of our approach based on the green - kubo formalism .    ] .",
    "orange : equilibrium ( gk ) molecular dynamics ; the two dots indicate the estimates from our simulations , the straight line their linear inter-/extrapolation .",
    "statistical errors , as estimated by a block analysis of our md trajectories , are indicated by error bars or by shaded areas , where relevant .",
    "[ fig : mp - gk_comparison ] ]    } $ ] was evaluated from the modified flux @xmath114 at @xmath115 with a gga xc functional ( see text ) ; the dashed line indicates a linear fit to the large - time behavior of the curve .",
    "inset : integral in the gk relation , @xmath116 eq . , as a function of the upper limit of integration ( see caption to fig .",
    "1 ) ; the dashed line indicates the value of the thermal conductivity obtained from the einstein relation . _",
    "i.e. _ from the slope of above linear fit .",
    "the shaded areas depict statistical errors , as estimated from a block analysis of our md trajectories.[fig : h2o - einstein ] ]    we have applied our newly developed method to compute the heat conductiviy of heavy water at ambient conditions .",
    "we have generated a 90-ps long aimd trajectory for a system of 64 heavy - water molecules in a cubic supercell with an edge of 23.46 a.u .",
    ", corresponding to the experimental density of 1.11 @xmath117 , and at an estimated temperature @xmath118 , using the pbe xc energy functional @xcite and the pw - pp method as above @xcite . a time step of 0.0726 fs and a fictitious electronic mass of 340 electron masses",
    "were used in this case .",
    "the resulting self - diffusion coefficient was estimated to @xmath119 , to be compared with an experimental value of @xmath120 at @xmath121 , following the common practice of comparing experimental data for water at ambient conditions with aimd - pbe simulations performed at @xmath122 @xcite .",
    "the power spectrum of the computed energy flux is characterized by three relatively narrow peaks in correspondence to the intramolecular vibrational modes @xcite , resulting in long - lived high - frequency oscillations in the integrand of eq . , that plague the evaluation of the integral as a function of the upper limit of integration well beyond the time where the noise of the integrand becomes larger than the amplitude of its oscillations .",
    "as the computation of transport coefficients from the einstein relation @xcite is less affected by the high - frequency components of the power spectrum @xcite , this ailment is alleviated by evaluating the heat conductivity as the slope of the _ energy squared displacement _",
    ", @xmath123 , as a function of @xmath124 in the large - time limit .",
    "a direct application of this technique is however not possible as the long - time behavior of the energy squared displacement does not allow us to extrapolate a straight line before it becomes too noisy to analyze .",
    "this state of affairs indicates the existence of a slowly decaying mode in the energy - flux correlation function , possibly correlated with a non - diffusive flux . as we have seen , the total velocity @xmath125 is such a non - diffusive flux .",
    "the value of the corresponding gk conductivity , eq .",
    ", however , goes to zero very slowly as a function of the upper limit of integration .",
    "this suggests that the slow convergence of the heat conductivity of water as estimated from the slope of the energy squared displacament as a function of time , is possibly due to large correlations existing between the energy flux and the total velocity .",
    "we have therefore decided to analyze , instead of @xmath126 , the modified flux @xmath127 , where @xmath128 has been fixed in such a way as to minimize the correlations between @xmath129 and @xmath125 .",
    "2 displays the squared energy displacement computed from @xmath130 as a function of time and demonstrates that a constant slope can indeed be identified in the long - time limit , giving a value for the heat conductivity of heavy water of @xmath131 , to be compared with an experimental value of @xmath132 and @xmath133 for light and heavy water respectively at ambient conditions @xcite .",
    "the inset displays the behavior of @xmath116 ( see caption to fig .",
    "1 ) as a function of the upper limit of integration in the gk formula , indicating that a direct use of eq . would be extremely difficult in this case .",
    "a more detailed error analysis and a systematic extension of this study to different isotopic compositions and other conditions of temperature and pressure is currently in the works .",
    "we believe that the discussion presented in this work will elucidate the scope of a number of assumptions that , although routinely made in the classical simulation of heat transport , have never been fully clarified , thus hampering their generalization to quantum simulations .",
    "we are confident that the resulting new methodology will have an impact on important problems where other methods may fail , such as _ e.g. _ liquids and glasses , particularly at extreme conditions of temperature and pressure .",
    "in order to derive eqs .",
    "( [ eq:5js][eq : j_xc ] ) , we start from eq . , which we rewrite as : @xmath134 where @xmath135 @xmath59 is a local xc energy per particle , defined by the relation @xmath136(\\mathbf{r})\\rho(\\mathbf{r})d\\mathbf{r } , \\label{eq : exc}\\ ] ] and the xc potential @xmath58 is @xmath137 in the lda , @xmath59 is a function of the local density , whereas in the gga it is a function of the local density and density gradients : @xmath138(\\mathbf{r } )    & = \\epsilon_{lda}\\bigl ( \\rho(\\mathbf{r})\\bigr ) , \\\\    \\epsilon^{gga}_{xc}[\\rho](\\mathbf{r } )    & = \\epsilon_{gga}\\bigl ( \\rho(\\mathbf{r}),\\nabla\\rho(\\mathbf{r } )      \\bigr ) .",
    "\\label{eq : gga}\\end{aligned}\\ ] ]    we now proceed to computing the first moments of the time derivatives of the above four densities , according to eq . .",
    "in order to simplify the notation , the time dependence of the various quantities will be omitted .",
    "let s start with the kohn - sham energy density , eq . .",
    "@xmath139    where @xmath140 , \\label{eq : dot_bar_epsilon_ks}\\\\    \\dot{e}'_{0}(\\mathbf{r } )    & = \\sum_{v } \\varphi_{v}^{*}(\\mathbf{r } )      \\dot{\\hat{v}}_{0 }      \\varphi_{n}(\\mathbf{r } ) , \\label{eq : dot_epsilon_0 }   \\\\    \\dot{e}_{h}'(\\mathbf{r } )    & = \\dot{v}_{h}(\\mathbf{r})\\rho(\\mathbf{r}),\\qquad      \\text{and } \\label{eq : dot_epsilon_prime_h}\\\\     \\dot{e}'_{xc}(\\mathbf{r } )    & = \\dot{v}_{xc}(\\mathbf{r } )      \\rho(\\mathbf{r } ) .",
    "\\label{eq : dot_epsilon_prime_xc }   \\end{aligned}\\ ] ] the macrosopic flux deriving from @xmath141 , eq . , is the `` kohn - sham '' flux of eq . :",
    "@xmath142 the other three terms , eqs .",
    "( [ eq : dot_epsilon_0][eq : dot_epsilon_prime_xc ] ) result from the external- , hartree- , and xc - potential contributions to the time derivative of the ks hamiltonian ( third term in eq .",
    "[ eq : epsilon_dot_ks_1 ] ) .",
    "the corresponding fluxes combine with the fluxes originating from the energy densities of eqs .",
    "( [ eq : epsilon_n][eq : epsilon_xc ] ) , as explained below .    the first moment of the `` ionic potential '' energy - density derivative , eq .",
    ", reads :    @xmath143      \\nonumber \\\\     & = \\mathbf{j}'_{0 } - \\sum_{i } \\mathbf{r}_{i } \\left ( \\mathbf{v}_{i }      \\cdot \\mathbf{f}_{i}^{el } \\right ) , \\label{eq : j_0_prime }   \\end{aligned}\\ ] ]    where @xmath144 is the flux of eq . ,",
    "and @xmath145 is the electronic ( hellmann - feynman ) contribution to the force acting on the @xmath68-th atom .",
    "the corresponding ( second ) term in the energy flux of eq .",
    "is ill - defined in pbc but , as we will see shortly , it cancels with a similar term coming from the first moment of the `` ionic '' energy density , eq . .",
    "the time derivative of the `` ionic '' energy density , eq . , reads :    @xmath146.\\ ] ]    we now use newton s equations of motion ( @xmath147 , where @xmath148 is the force acting on the @xmath68-th atom ) , and split @xmath149 into an electronic ( hellmann - feynman ) contribution , plus a sum of pair - wise electrostatic terms , @xmath150 , to obtain :    @xmath151 . \\nonumber \\\\    & = \\sum_i       \\bigl [      e^0_i\\mathbf{v}_i      + \\mathbf{r}_i       \\left (      \\mathbf{f}^{el}_i\\cdot\\mathbf{v}_i       \\right ) + \\mathbf{r}_i \\sum_{j\\ne i }       \\bigl (        \\mathbf{v}_j\\cdot         \\nabla_j w_i        - \\mathbf{v}_i\\cdot         \\nabla_i w_j      \\bigr )     \\bigr ]   \\nonumber \\\\    & = \\sum_i       \\bigl [      e^0_i\\mathbf{v}_i      + \\mathbf{r}_i       \\left (      \\mathbf{f}^{el}_i\\cdot\\mathbf{v}_i       \\right ) + \\sum_{j\\ne i } ( \\mathbf{r}_i-\\mathbf{r}_j)(\\mathbf{v}_j\\cdot      \\nabla_j w_i ) \\bigr ] \\nonumber \\\\    & = \\mathbf{j}_0+\\sum_i \\mathbf{r}_i       \\left (      \\mathbf{f}^{el}_i\\cdot\\mathbf{v}_i       \\right ) , \\label{eq : j_0_k}\\end{aligned}\\ ] ]    where @xmath152 is the energy flux of eq . and the third step follows from the second by interchanging the dummy indeces of one of the two sums over @xmath68 and @xmath153 . as anticipated before , the second term on the right - hand side of eq . ,",
    "which is ill - defined in pbc , cancels a similar term in eq . , leaving all the surviving terms well defined .",
    "we summarize eqs . and",
    "as : @xmath154    d\\mathbf{r } =    \\mathbf{j}_0+\\mathbf{j}'_0,\\ ] ] where @xmath144 and @xmath152 are the energy fluxes of eqs . and , respectively .",
    "we then combine the time derivative of the `` hartree '' energy density , eq .",
    ", with the `` hartree - potential '' energy - density derivative , eq .",
    ": @xmath155 multiplying eq . by @xmath43 and integrating by parts , one obtains : @xmath156 which is eq . .",
    "we finally address the first moments of the time derivative of the `` xc '' energy density , eq . , and of the `` xc - potential '' energy - density derivative , eq .",
    "we define :    @xmath157    which derives from the definition of the xc potential , eq . , and from the chain rule as applied to the time derivative of @xmath59 : @xmath158 the first moment of eq .",
    "reads : @xmath159 in the lda , because of the local dependence of @xmath59 on the electron density , the functional derivative in eq . is proportional to @xmath160 , thus making the integral vanish . in the gga eq .",
    "gives : @xmath161 @xmath162 where @xmath163 , and @xmath164 .",
    "the first term on the right - hand side of eq",
    ". does not contribute to the xc energy flux as in the lda . by inserting the second term into eq .",
    ", one finally arrives at the expression for the xc energy flux of eq .",
    ", thus completing the derivation of eqs .",
    "( [ eq : j_ks]-[eq : j_xc ] ) .",
    "this rather unwieldy , but all in all straightfoward , derivation is visually summarized in fig .",
    "[ fig : flow ] .",
    "-[eq : j_xc ] ) , from the definition of a microscopic energy density , eqs .",
    "( [ eq : esplit]-[eq : epsilon_xc ] ) [ fig : flow ] ]    10    p.g .",
    "klemens , _ thermal conductivity and lattice vibrational modes _ , solid state phys . *",
    "7 * , 198 ( 1958 ) .",
    "green , _ markoff random processes and the statistical mechanics of time - dependent phenomena , ii .",
    "irreversible processes in fluids _ , j. chem .",
    "* 22 , * 398413 ( 1954 ) .",
    "r. kubo , _ statistical - mechanical theory of irreversible processes . i. general theory and simple applications to magnetic and conduction problems _ , j. phys .",
    "* 12 * , 570586 ( 1957 ) .",
    "evans and g. morriss , _ statistical mechanics of nonequilibrium liquids _",
    "( cambridge university press , cambridge uk , 2008 ) .    m.p . allen and d.j .",
    "tildesley , _ computer simulation of liquids _",
    "( clarendon press , oxford , 1987 ) .",
    "f. m \" uller - plather , _ a simple nonequilibrium molecular dynamics method for calculating the thermal conductivity _ , j. chem .",
    "phys . * 106 * , 60826085 ( 1997 ) .",
    "r. car and m. parrinello , _ unified approach for molecular dynamics and density functional theory _ , phys .",
    "* 55 * , 24712474 ( 1985 ) .",
    "d. marx and j. hutter , _ ab initio molecular dynamics _",
    "( cambridge university press , cambridge uk , 2012 ) .",
    "s. stackhouse , l. stixrude , and b.b .",
    "karki , _ thermal conductivitity of periclase ( mgo ) from first principles _ , phys .",
    "lett . * 104 * , 208501 ( 2010 ) .",
    "p. hohenberg and w. kohn , _ inhomogeneous electron gas _ , phys .",
    "* 136 * , b864b871 ( 1964 ) .",
    "w. kohn and l. sham , _ self - consistent equations including exchange and correlation effects _ , phys . rev . *",
    "140 * , a1133a1138 ( 1965 ) .",
    "kadanoff and p.c .",
    "martin , _ hydrodynamic equations and correlation functions _ , ann.phys . * 24 * , 419469 ( 1963 ) .",
    "d. forster , _ hydrodynamic fluctuations , broken symmetry , and correlation functions _ ( benjamin , reading , 1975 ) .",
    "e. helfand , _ transport coefficients from dissipation in a canonical ensemble _ , phys",
    ". rev . * 119 * , 19 ( 1960 ) .",
    "r. resta and d. vanderbilt , _ theory of polarization : a modern approach _ , top .",
    ". phys . * 105 * , 3168 ( 2007 ) .",
    "n. chetty and r.m .",
    "martin , _ first - principles energy density and its applications to selected polar surfaces _ , phys . rev .",
    "b * 45 * , 60746088 ( 1992 ) .",
    "r. ramprasad , _ first - principles energy and stress fields in defected materials _ , j. phys . : condens .",
    "matter , * 14 * , 54975516 ( 2002 ) .",
    "perdew , k. burke , and m. ernzerhof , _ generalized gradient approximation made simple _ , phys .",
    "77 * , 38653868 ( 1996 ) .",
    "thouless , _ quantization of particle transport _ , phys .",
    "b * 27 * , 60836087 ( 1983 ) .",
    "r. resta , _ manifestations of berry s phase in molecules and in condensed matter _ , j. phys . : condens .",
    "matter * 12 * , r107r143 ( 2000 ) .",
    "s. baroni , s. de gironcoli , a. dal corso , and p. giannozzi , _ phonons and related crystal properties from density - functional perturbation theory _ , rev .",
    "phys . * 73 * , 515562 ( 2001 ) .",
    "p. giannozzi _",
    "_ , _ quantum espresso : a modular and open - source software project for quantum simulations of materials _ , j. phys .",
    ": condens .",
    "matter * 21 * , 395502 ( 2009 ) ; http://www.quantum-espresso.org .",
    "cmd simulations have been performed using the lammps code , see : s. plimpton , _ fast parallel algorithms for short - range molecular dynamics _ , j. comp .",
    "phys . * 117 * , 119 ( 1995 ) ; http://lammps.sandia.gov .",
    "norm - conserving pp s from the quantum espresso public repository ( http://pseudopotentials.quantum-espresso.org ) were used .",
    "the pp datasets used for ar , o , and h are ` ar.pz-rrkj.upf ` , ` o.pbe-hgh.upf ` , and ` h.pbe-vbc.upf ` , respectively .",
    "pw s up to a kinetic - energy cutoff of 24 ry for ar and 80 ry for water were included in the basis set .",
    "grossman , e. schwegler , e.w .",
    "draeger , f. gygi , and g. galli , _ towards an assessment of the accuracy of density functional theory for first principles simulations of water _ , j. chem",
    "120 * , 300311 ( 2004 ) .",
    "silvestrelli , m. bernasconi , and m. parrinello , _ ab initio infrared spectrum of liquid water _ , chem .",
    "277 * , 478482 ( 1997 ) .",
    "a. marcolongo , _ theory and ab initio simulation of atomic heat transport _ , sissa phd thesis ( 2014 ) ,    n. matsunaga and a. nagashima , _ transport properties of liquid and gaseous d@xmath165o over a wide range of temperature and pressure _",
    ", j. phys .",
    "chem . ref .",
    "data * 12 * , 933966 ( 1983 ) ; m.l.v .",
    "ramires * * _ et al . _ * * , _ standard reference data for thermal conductivity of water _ , j. phys .",
    "chem . ref .",
    "data * 24 * , 13771381 ( 1994 ) .",
    "all correspondence should be addressed to sb , ` baroni@sissa.it `",
    "sb gratefully acknowledges useful discussions with tao sun and dario alf in the early phases of this work and , more recently , with roberto car and raffaele resta .",
    "all the authors gratefully thank luciano colombo , claudio melis , simon r. philpot , and aleksandr chernatynskiy for commucating to them some of their unpublished material .",
    "all authors contributed to all aspects of this work ."
  ],
  "abstract_text": [
    "<S> quantum simulation methods based on density - functional theory are currently deemed unfit to cope with atomic heat transport within the green - kubo formalism , because quantum - mechanical energy densities and currents are inherently ill - defined at the atomic scale . </S>",
    "<S> we show that , while this difficulty would also affect classical simulations , thermal conductivity is indeed insensitive to such ill - definedness by virtue of a sort of _ gauge invariance _ resulting from energy extensivity and conservation . based on these findings , we derive an expression for the adiabatic energy flux from density - functional theory , which allows heat transport to be simulated using ab - initio equilibrium molecular dynamics . our methodology </S>",
    "<S> is demonstrated by comparing its predictions with those of classical equilibrium and ab - initio non - equilibrium ( mller - plathe ) simulations for a liquid - argon model , and finally applied to heavy water at ambient conditions . </S>"
  ]
}