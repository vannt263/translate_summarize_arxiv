{
  "article_text": [
    "forecasting methodologies , traditionally motivated by numerical weather prediction ( nwp ) , can find applications in other fields such as engineering @xcite , finance @xcite , epidemiology @xcite , and marketing @xcite .",
    "techniques borrowed from the weather forecasting community may prove to be powerful for forecasting these other types of complex systems .",
    "fluid systems can be particularly challenging due to dynamics taking place at multiple interacting spatial and temporal scales .",
    "however , because of their relationship to nwp , fluid systems are among the most studied in the context of forecasting .    in this paper , we show that the flow in a computational fluid dynamics ( cfd ) simulated thermosyphon undergoing chaotic convection can be accurately forecast using an ordinary differential equation ( ode ) model akin to the classic @xcite system .",
    "the thermosyphon , a type of natural convection loop or non - mechanical heat pump , can be likened to a toy model of climate .",
    "thermosyphons are used in solar water heaters @xcite , cooling systems for computers @xcite , roads and railways that cross permafrost @xcite , nuclear power plants @xcite , and other industrial applications . in these heat pumps ,",
    "buoyant forces move fluid through a closed loop , and at high amounts of forcing they can exhibit complex aperiodic behavior .",
    "as first suggested by @xcite , this is illustrative of the unpredictable convection behavior observed in weather and climate dynamics .",
    "synthetic observations of the thermosyphon are combined with model data to produce new forecasts in the process known as data assimilation ( da ) .",
    "da is a generic method of combining observations with past forecasts to produce the analysis , an approximately optimal initial condition ( ic ) for the next forecast cycle .",
    "another interpretation of the analysis is that it is a `` best guess '' for the true system state as represented in the phase space of the model .",
    "da can be used as a platform for the reanalysis of past observations , in which the dynamical model plays a key role in constraining the state estimates to be physically realistic @xcite .    in the present study ,",
    "we use an analysis of simulated thermosyphon mass flow rate data to explain the heat transport processes occurring during chaotic flow reversals , and to inform empirical forecasts of the occurrence of these flow reversals .",
    "although the flow reversals are chaotic , we show they have short - term predictability , quantifying the extent to which this is possible with our methods .",
    "this paper is structured in the following way : in sec .",
    "[ sec : model ] , we explain the cfd simulation used to generate a synthetic true state or `` nature run '' of the thermosyphon and the separate forecasting model . in sec .  [",
    "sec : da ] we present an overview of how da was applied to this experiment and its performance . in sec .",
    "[ sec : reversals ] we explain and present the results for flow reversal and rotational state residency time forecasts . finally , sec .",
    "[ sec : conclusion ] contains concluding remarks . in appendices s1 - 4 in the supporting information we present a derivation of the model , detail the tuning of model parameters , and explain in detail the da methods used .     while the top wall is maintained at the temperature @xmath0 , creating a temperature inversion of hot fluid below cold fluid .",
    "if conduction alone can not stabilize this temperature inversion , then the fluid will begin to rotate and convection becomes the dominant process of heat transfer .",
    "the relevant model state variables are proportional to the bulk fluid velocity @xmath1 and the temperature difference across the loop @xmath2 . for counterclockwise flow , as indicated by the arrow near 9 oclock , fluid velocity @xmath3 and @xmath2 is typically @xmath4 .",
    "the radius ratio @xmath5 used in our experiments is shown to scale . ]",
    "following previous experiments that examined the periodic @xcite and chaotic @xcite behavior of toroidal thermosyphons , we also consider a circular thermosyphon geometry .",
    "picture a vertically - oriented hula hoop , as shown in fig .",
    "[ fig : loopcartoon ] .",
    "an imposed wall temperature @xmath6 on the lower half of the loop ( @xmath7 ) heats the fluid contained in this section .",
    "similarly , a wall temperature @xmath8 is imposed on the upper half ( @xmath9 ) to cool the upper section ( fig .",
    "[ fig : loopcartoon ] ) .",
    "the forcing , proportional to the temperature difference @xmath10 , is constant .",
    "we focus on the case of developed flow , ignoring transient behavior .",
    "the behavior of the fluid can be qualitatively understood as follows . as the heating parameter is increased , the flow behavior transitions from a conduction state ( conducting equilibrium ) to a steady , unidirectional state of convection ( convecting equilibrium ) .",
    "no particular rotational state ( clockwise , cw , or counterclockwise , ccw ) is favored due to symmetry . at still higher heating values , chaotic flow oscillations can be observed . in the chaotic regime , the flow",
    "is observed to oscillate around one unstable convecting equilibrium state until flow reversal .",
    "each flow reversals causes the system to transition between cw and ccw rotational states .",
    "the reference state of the thermosyphon is represented by a cfd - based numerical simulation in two spatial dimensions ( 2d ) .",
    "the details of the computational model have been described in detail in a previous study by @xcite ; however , for completeness , we summarize here its essential elements .    it is assumed that the temperature differential @xmath11 is sufficiently small so that temperature - dependent variations of material properties can be regarded as negligible , save for the density .",
    "the standard boussinesq approximation is invoked and all fluid properties are assumed to be constant and evaluated at the reference temperature @xmath12 .",
    "the flow is assumed to be laminar , two - dimensional , with negligible viscous dissipation due to low velocities . under these circumstances ,",
    "the governing dimensionless equations are the unsteady , 2d laminar navier - stokes equations along with the energy equation and equation of state for the density .",
    "no slip velocity boundary conditions are imposed on the walls and isothermal boundary conditions of @xmath6 and @xmath0 are imposed on the heated and cooled lower and upper walls , respectively .",
    "the dimensionless control parameter for convection is the rayleigh number , defined here as @xmath13 where @xmath14 is the gravitational acceleration , @xmath15 is the thermal expansion coefficient , @xmath16 is the kinematic viscosity , and @xmath17 is the thermal diffusivity .",
    "the one dimensionless geometric parameter is the ratio of major ( loop ) radius @xmath18 to minor ( tube ) radius @xmath19 , hereafter referred to as the radius ratio .",
    "consistent with the previous study , the dimensions of the loop are chosen with @xmath18 = 36 cm and @xmath19 = 1.5 cm to yield a radius ratio of 24 .",
    "as in the classic rayleigh - bnard problem , the rayleigh number determines the onset of convection in the thermosyphon .",
    "for the numerical simulations on this fixed geometry , a range of rayleigh numbers can be imposed by varying the value of the gravitational acceleration . as the rayleigh number is increased from zero , the flow behavior transitions from a stationary , conduction state to a steady , unidirectional state of convection . at still higher values of ra , chaotic flow oscillations can be observed . unless otherwise indicated , the simulation results presented in this paper correspond to a value of ra= @xmath20 , which is within the chaotic regime .",
    "all numerical simulations were performed using the commercial cfd software @xcite , which is based on the finite - volume method .",
    "( an example of the output is shown in fig .",
    "[ fig : regchangeprofiles ] , in the discussion of flow reversals . ) during the course of the simulations , the time - varying mass flow rate , a scalar denoted by @xmath21 and proportional to @xmath1 , is saved at 10 s intervals .",
    "this reporting interval is conservative , as laboratory thermocouples can be sampled more than once pre second . in doing so , a time series of the `` true '' synthetic thermosyphon state",
    "is recorded to be used in a forecasting scheme .",
    "the ehrhard - mller ( em ) system is a three - variable ode derived specifically to model bulk flow in the thermosyphon ( @xcite ; also see appendix s1 in the supporting information for an alternative derivation ) .",
    "written in dimensionless form , the governing equations are    [ eq : em ] @xmath22    the state variable @xmath23 is proportional to the mass flow rate or mean fluid velocity , @xmath24 to the temperature difference across the convection cell ( @xmath25 , measured between 3 oclock and 9 oclock ) , and @xmath26 to the deviation of the vertical temperature profile from the value it takes during conduction ; specifically , @xmath27 , where @xmath28 is the temperature difference measured between 6 oclock and 12 oclock .",
    "the parameter @xmath29 is comparable to the prandtl number , the ratio of momentum diffusivity and thermal diffusivity .",
    "similar to the rayleigh number , the heating parameter @xmath30 determines the onset of convection as well as the transition to the chaotic regime .",
    "finally , @xmath31 determines the magnitude of variation of the wall heat transfer coefficient with velocity .",
    "the functional form of that variation is determined by @xmath32 , where @xmath33 the interested reader is referred to appendix s1 in the supporting information for an explanation of this piecewise form , which differs slightly from the original model of @xcite .    note that when @xmath34 , the system is analogous to the @xcite system with geometric factor ( lorenz s @xmath35 ) equal to one .",
    "the lack of a geometric factor in the em system is due to the circular geometry of the convection cell .",
    "lorenz equations have been widely used in nonlinear dynamics to study chaos and in nwp as a model system for testing da @xcite .",
    "when in the chaotic parameter regime , the em system exhibits growing oscillations in the @xmath23 and @xmath24 state variables around their convecting equilibrium values until flow reversal . in this system ,",
    "the ccw rotational state is characterized by @xmath36 and @xmath37 , and the cw rotational state by @xmath38 and @xmath39 .",
    "however , one should note that near a flow reversal @xmath23 and @xmath24 can have opposite signs , because zero - crossings of the @xmath23 variable typically lag behind those of @xmath24 .",
    "the parameters found to match the simulated thermosyphon were @xmath40 , @xmath41 , and @xmath42 . the characteristic time and mass flow rate scales , used to transform the dimensionless model variables @xmath43 and",
    "@xmath23 into dimensional time and `` observations '' of mass flow rate , were 631.6 s and 0.0136 kg / s , respectively .",
    "the @xmath21 scale is the one nonzero entry in the observation operator @xmath44 , eqn .  .",
    "the above parameters were found using a multiple shooting algorithm explained in appendix s1.2 in the supporting information .",
    "numerical integration of this autonomous ode was performed with a fourth - order runge - kutta method and timestep 0.01 ( corresponding to 6.316 s ) in @xcite .",
    "da is the process by which observations of a dynamical system are combined with forecasts from a model to estimate error covariances and calculate an optimal estimate for the current state of the system , called the analysis .",
    "the inherent difficulties are compounded by the fact that the forecaster uses an inexact forecasting model and never knows the true state of the dynamical system .",
    "the number of state variables in a nwp model is typically @xmath45 times larger than the number of observations .",
    "nevertheless , the analysis becomes the ic for a new forecast .",
    "the time interval between successive applications of the da algorithm , i.e. the time between analysis steps ( usually determined by the availability of observations but here allowed to vary ) , is called the assimilation window .",
    "the process is illustrated in fig .",
    "[ fig : daexample ] .",
    "a variety of filters are capable of solving the da problem .",
    "the canonical example is the kalman filter ( kf ; @xcite ) , the optimal state estimation algorithm for a linear system .",
    "one of da s first applications was to trajectory estimation and correction of missiles and rockets @xcite .",
    "a number of nonlinear da schemes are implemented in this study . in 3d",
    "variational da ( 3d - var ; here 3d refers to the spatial dimensions for weather models ) , the background error covariance is estimated a single time , offline , prior to the data assimilation procedure . in the extended kalman filter ( ekf ) ,",
    "background error is evolved according to the linear tangent model , which approximates the evolution of small perturbations about the trajectory .",
    "ensemble kalman filters ( collectively enkfs ) use ensembles of forecasts to estimate the background error and better capture nonlinear behavior .",
    "the methods examined in this study were 3d - var , the ekf , the ensemble square root kalman filter ( ensrf ) , and the ensemble transform kalman filter ( etkf ) .",
    "detailed descriptions of each method are included in appendix s2 in the supporting information .",
    "a full review of da is beyond the scope of the present paper ; for a comprehensive treatment , we refer the reader to @xcite .",
    "a perfect model experiment , in which the lorenz equations were used to forecast a synthetic truth created by the exact same system , was tested first but not included here .",
    "we found analysis errors similar to those reported by @xcite ( 3d - var and ekf ) and @xcite ( etkf ) , using the same model and tuning parameters .",
    "this ensured that the da algorithms were working before applying them to the synthetic thermosyphon data .",
    "as stated in sec .",
    "[ sec : thermosyphon ] , forecasts of the thermosyphon are made observing one scalar variable , the mass flow rate @xmath46 .",
    "gaussian noise with standard deviation equal to @xmath47 kg / s , approximately @xmath48 of the mass flow rate climatological mean , @xmath49 kg / s , is added to the synthetic truth to create observations .",
    "the relative magnitude of this error is comparable to that of experimental measurements .",
    "the em model is used in the forecast step to integrate the analysis forward in time and create the new background forecast .",
    "the end results of applying da are a background and analysis timeseries of @xmath50 , informed by both the timeseries of thermosyphon mass flow rate and the em model dynamics .    in this realistic forecasting scenario ,",
    "where only limited information about the true state is available , the observations of state variable @xmath21 provide the only validation .",
    "for this reason , we calculate the forecast errors in observation space .",
    "these are given as root mean square error ( rmse ) , where @xmath51 .",
    "the residual at a specific assimilation cycle is given by @xmath52 . here",
    ", @xmath53 is the background forecast made by the model , and @xmath54 is the linear observation operator @xmath55\\ ] ] in units of kg / s . all errors are then scaled by @xmath56 , the climatology of @xmath21 .",
    "analysis error is a common metric for assessing da performance in perfect model experiments . in this study , however , we assert that background error is preferable .",
    "analysis error in observation space , which will be small even for large assimilation windows , is not an appropriate metric for assessing model performance since it can disagree substantially with the background error .",
    "for example , 3d - var in one experiment with a 10 minute assimilation window yielded analysis and background scaled errors of 0.08 and 0.86 , respectively . the analysis error would seem to indicate that forecasting is doing a good job , but the background error shows that background forecasts are essentially meaningless .",
    "the filter , however , accounts for this and weights the observations heavily over the background forecasts when producing the analysis . since we are concerned with forecasting , background error is a more representative metric",
    "when applying da to nonlinear systems , some type of covariance inflation is performed to prevent filter divergence due to error underestimation .",
    "@xcite found that a lorenz forecasting model with a slightly different forcing parameter required a 10-fold increase in the multiplicative inflation factor when using a 3 member enkf .",
    "model error is more pronounced for our forecasts , since the em model is a reduced approximation of the numerically simulated thermosyphon .",
    "we relied upon additive and multiplicative background covariance inflation to capture model error .",
    "additive inflation was particularly important for the stability of the ekf and enkfs .",
    "additive noise provides a different exploration of dynamically accessible regions of state space , and it would be interesting to explore why additive versus multiplicative is preferred in certain cases , although this is beyond the scope of this paper . the specifics of how inflation was performed and tuned , and the parameters used are given in appendix s2 in the supporting information .",
    "all em and da parameter tuning was performed using a separate mass flow rate time series than was used for validation . each da algorithm was allowed 500 cycles to spin - up , and its performance was measured over the following 2500 cycles .",
    "ensemble size in each case was set to 10 members .",
    "over 2500 assimilation cycles plotted for different da algorithms and varying assimilation windows .",
    "as the window becomes larger , the error increases towards saturation .",
    "the lower dashed line in the main figure shows the limit of a `` perfect '' forecast while the upper demarcates a `` useless '' forecast . ]    with proper tuning , all da algorithms were capable of synchronizing the em model to observations of mass flow rate alone .",
    "as the assimilation window increased , scaled background error increased in a sigmoidal fashion , as expected ( see fig .",
    "[ fig : emfwindows ] ) . for assimilation windows up to 2.5 min ,",
    "all da algorithms have nearly indistinguishable errors . for assimilation windows between 3 and 6 min",
    ", 3d - var performs noticeably worse than the other methods which remain indistinguishable . then , with assimilation windows greater than 6 min , the ensemble methods ( ensrf and etkf ) outperform the ekf noticeably .",
    "this is perhaps surprising , at first glance , because the ensemble size is significantly smaller than the dimension of the simulated thermosyphon state space ( @xmath57 variables ) .",
    "however , we know the thermosyphon dynamics effectively take place on the em equations attractor ( a manifold in three dimensions ) .",
    "the superior performance of enkfs here is likely due to the ensemble methods capturing nonlinear effects which dominate at larger windows .    following the historical s1 score convention , scaled error above 70%",
    "is considered a `` useless '' forecast , while under 20% the forecast is `` perfect '' @xcite .",
    "perfect forecasts for 3d - var were found up to a 4 minute assimilation window , while the other methods ( ensrf , etkf , and ekf ) produced perfect forecasts with assimilation windows 1.5 minutes longer .    a persistent spike in background error for the 5 minute assimilation window ( fig .",
    "[ fig : emfwindows ] ) is possibly due to that time being approximately the same as the characteristic period of oscillations in @xmath21 ( evident in fig .",
    "[ fig : daexample ] ) .",
    "we conjecture that this may lead to a type of resonance in the da - coupled em system which degrades da performance .    besides these results pertaining to forecast skill",
    ", we also found that the da algorithms infer thermosyphon dynamics which are absent from the em model . in fig .  [",
    "fig : attractor ] we see the simulated thermosyphon s attractor obtained by both a time - delay embedding ( fig .",
    "[ fig : attractor](a ) ; @xcite ) and a projection of the em analysis states to the @xmath23-@xmath24 plane ( fig .",
    "[ fig : attractor](b ) ) .",
    "if the thermosyphon fluid flow stalls in the midst of a reversal , fluid in the bottom can quickly heat up while that in the top is cooled , leading to an unstable , strong temperature inversion .",
    "this causes the fluid to move very quickly in the reversed direction , but this new direction also ends up being unstable , and a new flow reversal can occur immediately .",
    "absent da , the em model system does not exhibit this behavior of stalling followed by large swings of the trajectory .    in the time - delay embedding ( fig .",
    "[ fig : attractor](a ) ) , this phenomenon is exhibited by small loops in the trajectory as it moves near the convective fixed points .",
    "the flow stalls when the system state is near the conductive fixed point at the origin , then it swings wildly which brings it near the convective fixed point , but in such a way that it does not end up spiraling outward in the usual fashion as during a normal flow reversal , as exhibited by the lorenz equations .",
    "instead , it quickly reverses again , which we call non - lorenz behavior .",
    "this non - lorenz behavior is further elaborated upon in sec .",
    "[ sec : revoccur.new ] .",
    "forecast skill is worst at the far edges of the assimilated attractor ( fig .",
    "[ fig : attractor](b ) ) .",
    "this could be due to the wild swings of the em trajectory after being ejected from the region of state space near the conducting equilibrium , or to the nonlinear dynamical instabilities at the edge of the attractor found by @xcite and @xcite .",
    "that creeps towards 0 with @xmath23,@xmath58 , before the state swings quickly ( b ) through one oscillation in the cw rotational state .",
    "this is followed by one oscillation in the ccw state ( c ) before another stall near the conducting point and subsequent swing ( b again ) before settling into lorenz - like oscillations ( d ) .",
    "note that the filter only observes the @xmath23 variable but is able to reconstruct the dynamics in the full state space . ]",
    "we also explicitly show one of these stalled flow reversals in fig .",
    "[ fig : perfectstorm ] , where we plot the ekf - assimilated em trajectory using a 30 s assimilation window .",
    "when the fluid stalls , the @xmath26 variable moves closer to 0 ( i.e. @xmath28 increases ) while @xmath23 and @xmath24 ( proportional to @xmath21 and @xmath2 , respectively ) are approximately 0 , reflecting the growing temperature inversion while the fluid remains stationary .",
    "when the fluid starts to move , the assimilated trajectory swings wildly to the left attractor lobe ( cw rotational state ) , then right ( ccw rotational state ) .",
    "the trajectory undergoes another stall - swing cycle before finally resuming lorenz behavior , where the trajectory spirals outward from the ccw convecting equilibria .",
    "this contrasts the lorenz and em model dynamics , for which large deviations in the system state from convecting equilibrium are driven close to the other convecting equilibrium during a flow reversal , which stabilizes the system .",
    "see also sec .",
    "[ sec : revoccur.new ] , fig .",
    "[ fig : emfregchange ] , and the accompanying discussion .",
    "this result remains unchanged for the other da algorithms also using a 30 s assimilation window .",
    "the inference remains using ekf and a 60 s assimilation window , but the trajectory appears much noisier , leading us to believe that this is due to the rapid update . with larger assimilation windows ,",
    "the trajectory becomes uninterpretable as error in the unobserved variables increases .",
    "for the purpose of flow reversal forecasts , we picked a single da algorithm and assimilation window . in this section ,",
    "all analyses were generated by the extended kalman filter and an assimilation window of 30 s. this interval corresponds to 5 time steps of the model and is shorter than that used in @xcite and @xcite .",
    "the following could certainly be repeated using other algorithms , observations , and assimilation windows , but this was beyond the scope of this paper .",
    "the flow reversal tests in sec .",
    "[ sec : revoccur.tests ] and the residency time forecasts in sec .  [",
    "sec : revoccur.dur ] were tuned and validated on separate analysis timeseries .",
    "the length of the tuning and validation timeseries were approximately 39 and 93 days , respectively .",
    "the first explanation of the mechanism responsible for flow reversals was presented by @xcite and repeated by @xcite .",
    "welander , who was also the first to discover that thermosyphons exhibit aperiodic oscillatory behavior , explained the instability of steady convecting flow by considering a thermal anomaly or `` warm pocket '' of fluid . for low heating rates ,",
    "the convecting equilibrium is stable because viscous and thermal dissipation are in phase , thus an increase ( decrease ) in flow rate leads to an increase ( decrease ) in friction and a decrease ( increase ) in buoyancy , and such perturbations are damped out . at higher heating rates , the warm pocket is amplified with each cycle through the loop due to out of phase viscous and thermal dissipation s .",
    "welander explained that when the warm pocket emerges from the heating section and enters the cooling section , it feels a greater buoyant force than the surrounding fluid and accelerates , exiting the cooling section quickly , giving it less time to radiate away its energy .",
    "as the pocket moves into the section with warm boundary , the buoyant force it experiences is again higher than normal , so now the pocket decelerates and passes slowly through the heating section , gaining more energy .",
    "this positive feedback effect causes the pocket to grow hotter and larger with each pass through the loop .",
    "these oscillations in the fluid temperature and velocity do not grow unhindered , however .",
    "the pocket eventually becomes large and hot enough that its descent towards the heating section is stopped entirely by its own buoyancy . without movement , the pocket dissipates , but its remnant heat biases new rotation in the opposite direction , and the flow reverses .    in the lorenz and em systems ,",
    "this feedback is embodied in the spiraling repulsion of trajectories from the unstable convecting equilibria at the center of each lobe or wing of the attractor before moving to the other lobe . because the growth of oscillations is an important component to the flow reversal process in both the cfd simulated thermosyphon and em system",
    ", we define here what is meant by oscillation amplitude in each case . in the cfd simulated thermosyphon , it is the maximum distance of the system state from the nearest convecting equilibrium , where system state is understood to mean the state of the entire temperature and velocity flow fields in the cfd simulation . when considering the da - generated em analysis ,",
    "the @xmath59th @xmath23 oscillation amplitude @xmath60 is defined as the maximum amplitude @xmath61 where @xmath62 $ ] is the time interval of the @xmath59th oscillation .",
    "three separate tests were developed to predict , at each assimilation step , whether a flow reversal would occur within the next oscillation period ( approximately 11 min ) , here taken to be within the next 20 da cycles .",
    "see sec .",
    "[ sec : revoccur.skill1 ] and appendix s3 in the supporting information for a description of how the tunable parameters were chosen .",
    "the simplest test forecasts a flow reversal whenever the background forecast changes rotational state .",
    "note that to forecast a flow reversal occurring in the future , the background forecast started from the most recent analysis ic provides our only information about the system s future state .",
    "ignoring the three - dimensional nature of the state space , a flow reversal is forecast whenever @xmath23 crosses through zero .",
    "note also that the forecast is unable to predict flow reversals that occur beyond the lead time , and that lead forecast quality quickly degrades as the lead time is increased .",
    "we impose a limit on the number of assimilation cycles to look ahead , @xmath63 , so that the algorithm does not trust forecasts too far in advance .",
    "an ensemble of perturbed states forming a small ball around the analysis can be used to represent uncertainty in the ic .",
    "a nonlinear system will dynamically stretch and shrink such a ball around its trajectory as it moves through the attractor @xcite .",
    "small perturbations to points on a trajectory are integrated forward in time , and the differences between perturbed and unperturbed solutions are called bred vectors ( bvs ) . here",
    ", the rescaling amplitude is 0.001 and the integration time coincides with the 30 s assimilation window .    the average bv growth rate is a useful measure of local instabilities @xcite .",
    "@xcite , studying perfect - model forecasting of the lorenz system , set a bv growth rate threshold which accounted for 91.4% of the observed flow reversals ( hit rate ) .",
    "our bv test simply forecasts a flow reversal whenever the average bv growth rate over the previous assimilation window exceeds a threshold , @xmath64 .",
    "the final test uses the fact that flow reversals are suspected to be caused by out of phase viscous and thermal dissipation .",
    "since the friction term grows with fluid velocity @xmath65 and the thermal dissipation grows with the size of the temperature anomaly , related to @xmath24 , we examined the correlation between those two variables over a tunable number of previous analysis cycles . specifically , when the slope of the least - squares linear fit of @xmath66 previous analysis points @xmath67^t$ ] for @xmath68 exceeds a threshold @xmath69 , a flow reversal is forecast .",
    "see fig .",
    "[ fig : corr ] for an illustration of this process .",
    "interestingly , increasing autocorrelation of the state seems to be a universal property of many systems in advance of critical transitions @xcite .",
    "^t$ ] correlation exceeds a threshold ( red ) , a flow reversal is forecast .",
    "correct positive predictions are shown as filled circles and false positives as open circles .",
    "the starred point corresponds to the inset , which shows how correlation is computed as the slope of the least squares fit ( green line ) of previous analysis points , and the arrow shows the direction of the trajectory .",
    "note that each analysis cycle where the correlation fails to exceed the threshold counts as a correct negative forecast ( not shown ) .",
    "there are no false negatives , i.e. misses , in this timeseries . here",
    "@xmath70 and @xmath71 are the same as for tab .",
    "[ tbl : con ] . ]",
    "we found that the analysis @xmath23 oscillation amplitude preceding each flow reversal is correlated with the duration of the following rotational state , shown in fig .",
    "[ fig : emfregchange ] .",
    "we refer to these durations between flow reversals as residency times .",
    "residency times are observed at discernible `` steps '' corresponding to integer numbers of oscillations .",
    "this correlation makes the @xmath23 oscillation amplitude a plausible predictor for residency time in the new rotational state .",
    "furthermore , the average bv growth rate measured over the assimilation window preceding that extremum follows a clear gradient in fig .",
    "[ fig : emfregchange ] , the growth rate increasing with oscillation amplitude .",
    "the bv growth rate gradient implies that more unstable system states precede longer residency times in the next rotational state .",
    "outliers with @xmath72 result in shorter residency times than expected from making similar plots to fig .",
    "[ fig : emfregchange ] for the pure lorenz and em systems ( not shown ) . in the lorenz and em systems ,",
    "the steps continue to move upwards with @xmath23 oscillation amplitude .",
    "the discrepancy is due to the non - lorenz behavior that was mentioned at the end of sec .",
    "[ sec : da.results ]    our residency time prediction algorithm proceeds as follows . when a flow reversal is forecast by one of the methods described in sec .",
    "[ sec : revoccur.tests ] , the algorithm first calculates @xmath73 as defined by eqn .   for the presently occurring oscillation .",
    "the algorithm uses only the analysis and lead forecast data available at the time the flow reversal test is triggered when estimating @xmath73 .",
    "the algorithm then examines the residency times of all flow reversals which followed an @xmath73 in the interval @xmath74 .",
    "these ordered pairs of amplitudes and residency times are drawn from the training timeseries . from the relative abundance of residency times in this sample ,",
    "we assign a probability to the number of flow oscillations in the forthcoming rotational state .",
    "( see the inset histogram in fig .",
    "[ fig : emfregchange ] . ) the categories are restricted to 16 oscillations ( a duration of 7 oscillations , shown in fig .",
    "[ fig : emfregchange ] , is observed exactly once in the training timeseries , so it was considered too rare an event to merit a category ) .",
    "the typical residency times corresponding to 1 , 2 , 3 , 4 , 5 , and 6 oscillations are taken to be 11.48 , 23.09 , 33.72 , 44.38 , 55.11 , and 66.08 minutes , respectively ; the oscillation category associated with a given residency time is taken to be that with the closest time in this list .",
    "this algorithm generates a probabilistic forecast from the relative abundance of points in each oscillation category .",
    "an example output would be 20% , 40% , 30% , and 10% chance of 1 , 2 , 3 , and 4 oscillations in the next rotational state and zero probability of 5 or 6 oscillations .",
    "not all flow reversals occur when the system reaches the same flow oscillation amplitude , nor do all rotational states last the same amount of time . during a flow reversal , the fluid motion stalls after hot",
    "fluid extends across the entire heating section into the cooling section ( see sec .  [",
    "sec : revoccur.trad ] and fig .",
    "[ fig : regchangeprofiles ] ) .",
    "the magnitudes of this hot `` tongue '' and , likewise , the opposite cold tongue affect the stability of the system as it reverses .",
    "if the oscillation is small , it will mostly dissipate before the new rotational state is entered , bringing the temperature profile close to that of conduction .",
    "this is a highly unstable equilibrium , since the vertical temperature gradient builds until the fluid in the bottom is much hotter than the fluid above ( illustrated in the analysis in fig .",
    "[ fig : perfectstorm ] ) .",
    "when the fluid begins to rotate , it accelerates rapidly .",
    "the large amount of heat carried by the fluid brings the system state far from the convecting equilibrium .",
    "if the oscillation is large ( corresponding to a large deviation from convecting equilibrium in temperature and velocity ) , remnant warm and cool areas will be present in the top and bottom sections of the loop , respectively .",
    "these stabilize the new rotational state near its convective equilibrium . the resulting duration is longer since the instability requires more time to grow before causing the next reversal .",
    "these two situations are illustrated in fig .",
    "[ fig : regchangeprofiles ] and explain the trend in the lorenz region of fig .",
    "[ fig : emfregchange ] .",
    "animations of the simulated temperature field during flow reversal are consistent with this explanation .",
    "is provided online at http://www.uvm.edu/~kharris/thermosyphon/t-ra-18000-new.mp4 . ]",
    "we believe that the behavior in the extremely large oscillation , non - lorenz region , where @xmath72 and shown in fig .  [ fig : emfregchange ] , is caused by excessive remnant thermal energy after flow reversal .",
    "although the temperature distribution present after a flow reversal is configured in a way that stabilizes the flow in the new rotational state , the very large magnitude of the temperature field is a competing , destabilizing factor that dominates as @xmath60 increases into the non - lorenz region .",
    "this leads to shorter durations in the new rotational state before a second flow reversal occurs .",
    "the results of the three tests are presented in tab .",
    "[ tbl : con ] as two - by - two contingency tables .",
    "shown in tab .",
    "[ tbl : skill ] are the threat score ( ts ) , false alarm ratio ( far ) , and probability of detection ( pod ) @xcite .",
    "given a non - probabilistic yes / no forecast with @xmath75 hits , @xmath35 false alarms , @xmath76 misses , and @xmath77 correct negatives for a total of @xmath78 events , these are defined as ts=@xmath79 , far=@xmath80 , pod=@xmath81 . because flow reversals are relatively rare events , the hit rate @xmath82 would be dominated by correct negatives . instead , ts is chosen as an appropriate overall performance metric since it disregards these frequent negative events and takes into account both false alarms and misses .",
    "there are trade - offs among the various skill scores for each flow reversal test . tuning the reversal tests then amounts to multiobjective optimization , attempting to maximize ts , rps - avg , and rps - med ( the skill scores used for residency time forecasts , defined in sec .",
    "[ sec : revoccur.skill2 ] ) , minimize far , and maintain pod above 95% .",
    "the goal was to tune each method to all - around good performance , for both reversal occurrence and residency time forecasts . to guide the process",
    ", plots of the skill scores were made for different tuning parameters , but the final tuning was performed ad hoc . in appendix s3 in the supporting information ,",
    "s3 - 2 shows one of these tuning experiments with the final parameters chosen appearing in the center of each subfigure .",
    "considering ts alone , the lead forecast performed best , followed by the correlation test , with the bv test performing poorest .",
    "the bv test also had a very high far , leading us to conclude , in contrast to the results of @xcite for a perfect model experiment , that bv growth rate is a poor overall predictor of flow reversals in a realistic thermosyphon .",
    "on the other hand , the correlation test had the lowest far while maintaining a high ts , but this comes at the price of more misses , resulting in a lower pod .",
    "the reasonable performance of the correlation test in all areas lends circumstantial evidence to the claim that out of phase dissipations are indeed the cause of flow reversals .",
    "the flow reversal occurrence tests are triggered in different situations , leading to variation in how far in advance flow reversals are detected , the `` warning time '' .",
    "warning times were only computed for hits , i.e. forecast flow reversals which were observed to occur . the lead , bv , and correlation tests had average warning times of 175 , 217 , and 304 s respectively .",
    "histograms of these warning times are presented in appendix s3 in the supporting information .",
    "( a ) lead forecast , n=175592   +    .contingency tables for the three flow reversal tests .",
    "the parameters used were : @xmath83 , @xmath84 , and @xmath85 . for a detailed description of the tuning ,",
    "see the text and fig .  s3 - 2 in appendix s3 in the supporting information .",
    "[ tbl : con ] [ cols=\"^,^,^,^ \" , ]     the results of the multiple shooting algorithm are shown in fig .",
    "[ fig : multshoot ] and table  [ tbl : params ] .",
    "the kf is well - known and widely used in linear da and control problems .",
    "although the thermosyphon is highly nonlinear , the linear update equations are similar to those of the nonlinear algorithms used for this experiment .",
    "the kf attempts to assimilate observations and forecasts for a process of the form @xmath86 in this case , @xmath87 is the true state , which advances in time according to the linear process @xmath88 , which is unknown but approximated by the model @xmath89 .",
    "subscripts index the time step . using the model ,",
    "the analysis from the previous time step is integrated to generate the background forecast for the current time step @xmath90 where @xmath89 is the linear model , @xmath91 is the old analysis , and @xmath53 is the background . because @xmath89 is only an approximation of @xmath88 , a perfect initial condition will not lead to a perfect forecast , so @xmath92 where the model errors @xmath93 have covariance @xmath94 ( usually assumed to be constant in time ) and are written on the right hand side for convenience . when deemed unnecessary , time subscripts are left out",
    ".    given an observation @xmath95 and background forecast @xmath53 , the kf finds the optimal way to combine them into the _ analysis _",
    "@xmath91 , the best guess of the current state .",
    "this becomes the ic when forecasting with the model , eqn .  .",
    "in an operational context , we usually can not observe every state variable . if @xmath96 and @xmath97 , then @xmath98 ( in nwp @xmath99 ) , so we define the observation operator @xmath100 that takes the background forecast from the model state space into the observation space .",
    "this serves two purposes : first , it avoids extrapolation of observations to gridpoints in state space ; and second , it enables us to interpret our forecasts by comparing them directly to observations . for the thermosyphon , @xmath101 is linear , so we write it as @xmath44 , but this is usually not the case for the observations in nwp , e.g. , satellite radiances and radar reflectivities .",
    "the complete application of the kf consists of a forecast step    [ eq : kffcast ] @xmath102    and an analysis step    [ eq : kfanalysis ] @xmath103    with the kalman gain @xmath104 given by @xmath105    the forecast equations create the background forecast and update the background error covariance .",
    "the new background error covariance is the old analysis error integrated forward plus the model error @xmath94 . in the analysis step",
    ", this background forecast is incremented by the gain times the innovation ( @xmath106 ) to produce the analysis .",
    "the difference between the analysis and the background is referred to as the _ analysis increment _ ; statistical properties of these increments can be used to reduce model error @xcite .",
    "the new analysis error is equal to the background error reduced by a factor of @xmath107 . by finding the analysis ,",
    "the filter has revealed the best possible starting point for the next background forecast .",
    "in fact , if the system is linear , the kf is the optimal algorithm for state - estimation .      rather than minimize the analysis error variance ,",
    "the analysis equations can also be derived by finding the analysis state @xmath91 that minimizes the quadratic scalar cost function @xmath108 .",
    "the cost @xmath109 has its minimum at @xmath110 , where @xmath91 is given by eqn .  .",
    "this is called the 3d variational ( 3d - var ) method since the minimization for nwp is with respect to a state vector embedded in a three - dimensional field ( latitude , longitude , and height ) .    formally , both 3d - var and the kf yield the same solution @xcite",
    ". however , in this case the control variable is the analysis , while in the kf the control variable is the weight matrix itself . in operational nwp , where the dimension of the state space @xmath111 is of @xmath112 , the numerical implementations of 3d - var and the nonlinear kf are drastically different .",
    "because 3d - var assumes the background error @xmath113 is fixed in time , the kalman gain @xmath114 needs to be calculated only once .",
    "the calculation of @xmath114 is the most computationally prohibitive part of da because it requires solving a linear system in @xmath111 variables .",
    "a constant @xmath114 thus makes the algorithm computationally simple ; the most difficult part of implementing 3d - var is finding the optimal @xmath113 .    however , a static @xmath113 is not realistic . from a dynamical systems standpoint ,",
    "uncertainty is closely related to stability , which is clearly dependent on the system state . in the thermosyphon ,",
    "the true background error is typically smaller when the system state is near the unstable convecting equilibria than when the state is near the more unstable conducting equilibrium .",
    "because 3d - var is computationally cheap , the national centers for environmental prediction ( ncep ) employ it to estimate ics for the national weather service 14-day global forecasts .",
    "however , it can not detect so - called `` errors of the day '' , state - dependent forecast errors which grow quickly but are not represented in the 3d - var background error covariance matrix @xcite .    in our implementation",
    ", the 3d - var background error covariance @xmath115 was calculated iteratively , using a techniques similar to that described in @xcite .",
    "we did this by calculating a time average of the outer product of analysis increments @xmath116 disregarding the initial 500 assimilation cycles and iterating the process until convergence . during this",
    ", forecast errors were observed to decrease and stabilize .",
    "this @xmath115 was first computed for the 30 s assimilation window .",
    "it was stored and then used to bootstrap the iterative procedure for the 60 s assimilation window , which was stored and fed into the calculation for the 90 s assimilation window , etc .",
    "the ekf is essentially the kf applied to a nonlinear model .",
    "given a nonlinear model @xmath117 , the error covariances are updated by the _ linear tangent model _",
    "@xmath118 which takes the place of @xmath89 in eqn .  .",
    "this model propagates small perturbations around the trajectory @xmath53 forward in time . to operate on the matrix @xmath119 with the linear tangent model ,",
    "first take the jacobian of @xmath120 ( the right hand side of the nonlinear differential equation @xmath121 which describes the model @xmath117 ) and evaluate it at the background point @xmath53 ; call this matrix @xmath122 .",
    "each column @xmath123 of @xmath119 , which can be thought of as an error perturbation to the analysis state , is then integrated forward in time according to the linear ode @xmath124 .    also note that if the observation operator @xmath101 is nonlinear , it is replaced by a similar linear tangent model @xmath44 in the matrix equations and .",
    "the transpose of these matrix functions are called _ adjoint models _ , which are used in sensitivity analysis of the state to perturbations .    to propagate the background covariance without the explicit adjoint model , as eqn",
    ".   would require , @xmath113 was first decomposed with the cholesky factorization @xcite into the product of a lower and upper diagonal matrix before its columns were integrated forward with the linear tangent model @xmath89 .",
    "@xmath125 this guarantees symmetry for the new analysis error covariance @xmath119 .",
    "some modifications to the ekf algorithm are necessary to prevent filter divergence . a multiplicative inflation factor @xmath126",
    "was applied to the background covariance matrix after the model integration and before the analysis step .",
    "we also performed additive inflation , following @xcite .",
    "random numbers uniformly distributed between 0 and @xmath127 were added to the diagonal elements of @xmath119 after performing the analysis and before the next forecast step , i.e. @xmath128 where @xmath129 is an @xmath111-dimensional vector whose entries are drawn from a uniform distribution between 0 and 1 .      the enkf is a method that replaces a single forecast state with an ensemble of states .",
    "the spread of the ensemble about its mean gives an approximation of the background error covariance and forecast uncertainty , while the ensemble average gives the best guess of the forecast .",
    "the enkf was first introduced by @xcite . for a comprehensive overview of ensemble filters ,",
    "see @xcite .",
    "it was shown that if the observation , which has random error with covariance @xmath130 , is perturbed with @xmath131 random errors ( again with covariance @xmath130 ) , to make an @xmath131-member ensemble of independent observations @xmath132 , then the background error covariance can be written @xcite @xmath133 which is simply the unbiased average outer product of background perturbations @xmath134 $ ] . the background forecast of ensemble member @xmath135",
    "is denoted @xmath136 , @xmath137 is the background forecast ensemble average , and @xmath138 is the @xmath135th member s deviation from the mean . in this case , each ensemble member is updated according to the kf equations for their associated observation    the advantages of the enkf are many : there is no linear tangent model to compute , the number of ensemble members can be small ( @xmath139 for nwp ) relative to the dimensionality of the state space , and prior knowledge about the structure of the forecast errors is not necessary .",
    "currently , 4d - var ( like 3d - var but also taking into account older observations ) and ensemble filters are the most promising candidates being considered to replace 3d - var in operational nwp .    as with the ekf ,",
    "ensemble filters tend to underestimate the background error , resulting in an ensemble spread which is typically less too small .",
    "we again used multiplicative inflation of the background error , a common method shown to be successful in @xcite .",
    "this is accomplished by setting @xmath140 before the analysis step .",
    "additive inflation proved crucial to stabilizing both enkfs tested . without it ,",
    "the filters sometimes worked but only with @xmath141 ; @xmath142 is supposed to be a small parameter .",
    "as in the ekf , additive inflation is applied immediately after the analysis step , but in this case the noise is added to the analysis ensemble states @xmath143 for all @xmath144 .",
    "the noise @xmath16 is , again , an @xmath111-dimensional random vector with entries drawn from the uniform distribution between 0 and 1 .",
    "the original enkf adds noise to create linearly independent observations and is classified as a _",
    "perturbed observations _ method @xcite .",
    "this necessarily introduces additional sampling error into the forecast . for this reason",
    ", @xcite introduced the ensemble square root filter ( ensrf ) as an improved enkf . in the ensrf ,",
    "the ensemble mean is updated with the traditional kalman gain ( eqn .  )",
    "@xmath145 and deviations from the mean are updated by @xmath146 where @xmath147^t    \\times    \\left[\\sqrt{\\mathbf{hbh}^t+\\mathbf{r}}+\\sqrt{\\mathbf{r } } \\right]^{-1 }    \\;.    \\ ] ] when the observation is a scalar , it can be shown that @xmath148 if observation errors are uncorrelated ( @xmath130 is diagonal ) , then eqn .",
    "can be used to process observations one at a time @xcite .",
    "the updated analysis ensemble is then @xmath149 , where @xmath150 .",
    "square root filters have better numerical stability and speed than their standard kf counterparts .",
    "the potter square root filter was employed for navigation in the lunar module of the apollo program @xcite .",
    "the etkf is another type of deterministic square root filter . in this variant ,",
    "the analysis perturbations are assumed to be equal to the background perturbations postmultiplied by a transformation matrix @xmath151 so that the analysis error covariance satisfies eqn .  .",
    "the analysis covariance is written @xmath152 where @xmath153^{-1}$ ] .",
    "the analysis perturbations are @xmath154 , where @xmath155^{1/2}$ ] .",
    "see @xcite for further details .",
    "the local ensemble transform filter ( letkf ) is a variant that computes the analysis at a given gridpoint using only local observations .",
    "this allows for efficient parallelization .",
    "localization removes spurious long - distance correlations from @xmath113 and allows greater flexibility in the global analysis by allowing different linear combinations of ensemble members at different spatial locations @xcite",
    ".      table  [ tbl : datuneparam ] lists the tuning parameters used for the da experiments .",
    "the tuning was done manually .",
    "sensitivity of model error to the tuning parameters was checked by creating a course contour plot of background error for assimilation windows of 2 , 4 , 6 , 8 , and 10 minutes for each filter ; an example is shown in fig .",
    "[ fig : s2 ] .",
    "l|l|l + analysis window ( s ) & @xmath142 & @xmath127 + 30 & 0.15 & 0.25 + 60 & 0.15 & 0.25 + 90 & 0.15 & 0.25 + 120 & 0.15 & 0.25 + 150 & 0.15 & 0.25 + 180 & 0.15 & 0.25 + 210 & 0.15 & 0.25 + 240 & 0.15 & 0.25 + 270 & 0.15 & 0.25 + 300 & 0.15 & 0.25 + 330 & 0.15 & 0.25 + 360 & 0.15 & 0.25 + 390 & 0.2 & 0.25 + 420 & 0.2 & 0.25 + 450 & 0.2 & 0.25 + 480 & 0.25 & 0.25 + 510 & 0.25 & 0.25 + 540 & 0.25 & 0.25 + 570 & 0.25 & 0.25 + 600 & 0.25 & 0.25    l|l|l + analysis window ( s ) & @xmath142 & @xmath127 + 30 & 0.15 & 0.25 + 60 & 0.15 & 0.25 + 90 & 0.15 & 0.25 + 120 & 0.15 & 0.25 + 150 & 0.15 & 0.25 + 180 & 0.15 & 0.25 + 210 & 0.15 & 0.25 + 240 & 0.15 & 0.25 + 270 & 0.15 & 0.25 + 300 & 0.15 & 0.25 + 330 & 0.15 & 0.25 + 360 & 0.15 & 0.25 + 390 & 0.2 & 0.25 + 420 & 0.2 & 0.25 + 450 & 0.2 & 0.25 + 480 & 0.2 & 0.25 + 510 & 0.2 & 0.25 + 540 & 0.25 & 0.25 + 570 & 0.25 & 0.25 + 600 & 0.25 & 0.25     and @xmath127 were varied .",
    "the chosen parameters @xmath156 and @xmath157 lie in the region of lowest error . ]",
    "in fig .  [ fig : regchgtune ] , we present skill score curves as the tuning parameters of the three flow reversal forecasts are varied .",
    "we used a sequence of plots of this type to inform our tuning of the various flow reversal tests .         for the correlation test , ( b ) @xmath158 for the bv test , and ( c ) @xmath159 for lead test",
    "the dashed line is at 95% .",
    "there are tradeoffs among the various skill scores ( pod , ts , rps - avg , rps - med ) and costs ( far ) .",
    "the chosen , final parameters @xmath63 , @xmath160 , and @xmath161 ( with @xmath66 ) appear in the middle of each plot .",
    "[ fig : regchgtune ] ]                                          yang , s .- c . ,",
    "baker , d. , li , h. , cordes , k. , huff , m. , nagpal , g. , okereke , e. , villafae , j. , kalnay , e. and duane , g.  s. 2006 .",
    "data assimilation as synchronization of truth and model .",
    "_ journal of the atmospheric sciences _ * 63 * ,  23402354 ."
  ],
  "abstract_text": [
    "<S> a simplified model of natural convection , similar to the lorenz ( 1963 ) system , is compared to computational fluid dynamics simulations of a thermosyphon in order to test data assimilation methods and better understand the dynamics of convection . </S>",
    "<S> the thermosyphon is represented by a long time flow simulation , which serves as a reference `` truth '' . </S>",
    "<S> forecasts are then made using the lorenz - like model and synchronized to noisy and limited observations of the truth using data assimilation . </S>",
    "<S> the resulting analysis is observed to infer dynamics absent from the model when using short assimilation windows .    </S>",
    "<S> furthermore , chaotic flow reversal occurrence and residency times in each rotational state are forecast using analysis data . </S>",
    "<S> flow reversals have been successfully forecast in the related lorenz system , as part of a perfect model experiment , but never in the presence of significant model error or unobserved variables . </S>",
    "<S> finally , we provide new details concerning the fluid dynamical processes present in the thermosyphon during these flow reversals . </S>"
  ]
}