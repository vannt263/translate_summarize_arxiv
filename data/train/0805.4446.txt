{
  "article_text": [
    "the nuclear many - body problem is undergoing a renaissance . hand in hand with the experimental developments in the science of rare isotopes , a qualitative change in theoretical modeling of the nucleus is taking place .",
    "developments of powerful conceptual , analytic , algorithmic , and computational tools enable scientists to probe the inner workings of nuclei with far greater precision than previously possible .",
    "these new tools , including terascale computer platforms , make researchers optimistic that the goal of developing a comprehensive , quantitative , and predictive theory of the nucleus and nucleonic matter is achievable @xcite .",
    "the research challenges faced by the nuclear structure community are often interdisciplinary .",
    "indeed , the quantum many - body problem represents one of the great intellectual and numerical challenges for nuclear and hadronic physics , quantum chemistry , atomic and condensed matter physics , and materials sciences .",
    "often , to solve problems in many - body science , close interactions of physicists with computer scientists and mathematicians are required .",
    "a theoretical framework aiming at the microscopic description of many - body systems and capable of extrapolating into unknown regions must fulfill several requirements .",
    "namely , ( i ) it must be general enough to be confidently applied to unknown species whose properties are largely unknown ; ( ii ) it should be capable of handling symmetry - breaking effects inherent to finite systems ; ( iii ) it should be able to describe both finite systems and bulk matter ; and ( iv ) in addition to observables , the method should provide associated error bars .",
    "these requirements are met by the density functional theory ( dft ) in the formulation of kohn and sham @xcite .",
    "the generalization of the dft  to the case of fermionic pairing was formulated for electronic superconductors @xcite .",
    "the resulting hartree - fock - bogoliubov ( hfb ) or bogoliubov de - gennes ( bdg ) equations can be viewed as the generalized kohn - sham equations of the standard dft .",
    "the nuclear dft   provides a reliable method for calculating properties of nuclei across the whole nuclear mass chart .",
    "the main ingredient of the nuclear dft  @xcite is the energy density functional that depends on proton and neutron densities and currents representing distributions of nucleonic matter , spins , momentum , and kinetic energy , as well as their derivatives ( gradient terms ) .",
    "if pairing correlations are present , the particle densities are augmented by pairing densities representing correlated nucleonic pairs @xcite .",
    "initially , attempts to build effective energy functionals were rooted in the empirical zero - range skyrme interaction treated within the hartree - fock ( hf ) or hfb  approximation . following the success of dft  in atomic and molecular physics and , more recently , in the physics of ultra - cold atoms",
    ", it was realized that the interaction could be secondary to the functional , and recent progress has been directed towards extensions of the energy functionals to less traditional forms .    in parallel ,",
    "much effort is put into trying to connect the nuclear dft   to more fundamental many - body theory based on inter - nucleon interactions . in order to extend the _ ab - initio _ program to the medium - mass region of the nuclear chart , a method which scales softly with system size and has a controllable error estimate",
    "is called for . the coupled - cluster ( cc ) theory is ideal in this respect .",
    "it scales polynomial with system size and it is _ size extensive _ , meaning that the energy scales correctly with increasing system size .",
    "this work represents a collaborative effort performed under the universal nuclear energy density functional ( unedf ) project @xcite .",
    "the goal of unedf is to develop a new - generation theoretical framework that will describe all nuclei and their reactions by making use of the massive computer power .",
    "one of the objectives of unedf is to develop computational infrastructure for leadership - class computers ; hence the algorithmic and computational focus of this paper .",
    "the common feature of dft   and cc  is to solve the quantum many - body problem for interacting fermions through self - consistent convergence schemes .",
    "the computational cost of these iterative procedures can become very expensive , especially when the size of the model space or the number of nuclei processed simultaneously is huge .",
    "the advent of teraflop computers make such large - scale calculations feasible , but in order to take full advantage of unique resources , better convergence algorithms are called for .",
    "the aim of the present paper is to report the implementation of broyden s method @xcite , a quasi - newton algorithm to solve large sets of non - linear equations , in nuclear structure calculations .",
    "the hfb  ( or bdg ) equations  the kohn - sham equations of the superfluid dft   represent a coupled system of non - linear equations for densities or mean fields .",
    "the non - linearity enters through the self - consistency , i.e. , the dependence of mean fields on densities .",
    "the cc  equations have in fact a very similar structure . here , the non - linearity is hidden in the cc  intermediates which depend on the particle - hole amplitudes .",
    "self - consistent formulations of these approaches usually diverge when using straight iterations .",
    "the simplest method commonly used to avoid divergences is the so - called linear mixing , in which input and output at a given iteration of the self - consistent process are mixed to provide input for the next step .",
    "we show that broyden s method leads to much improved convergence rates . in many cases ,",
    "the number of iterations required to reach convergence is lower by a factor of 3 to 10 with respect to linear - mixing iterative schemes .",
    "the paper is organized as follows .",
    "broyden s method is outlined in sec .",
    "[ sec : broyd - mixing - meth ] , both in its standard version ( sec .",
    "[ sbm ] ) that applies to a small number of unknowns , and in a modified version ( sec .",
    "[ mbm ] ) which is used to crunch very large sets of nonlinear equations .",
    "the examples of implementations come next .",
    "section  [ sec : unitary - fermi - gas ] discusses the performance of the standard broyden s method for the case of the unitary gas of two fermionic superfluids in spherical geometry . in the following examples",
    "the modified broyden s method has been used , as the size of the problem is intractable with the standard approach . the general case of the symmetry - unrestricted skyrme - dft theory",
    "is discussed in sec .",
    "[ sec : symm - unconstr - hfb ] .",
    "section  [ sec : symm - constr - hfb ] illustrates the particular case of an axially - symmetric skyrme - dft problem and discusses the ability of the method to converge to the local energy extrema ( i.e , minima , maxima , and saddle points ) .",
    "the performance of the method in _ ab - initio _ coupled - cluster calculations , where the number of unknowns can be as large as @xmath0 , is presented in sec .  [ sec : coupl - clust - theory ] .",
    "finally , the conclusions of our work are contained in sec .",
    "[ conclusions ] .",
    "when solving a system of self - consistent equations , one usually begins with a set of initial conditions ( in nuclear structure : single - particle wave functions , densities , fields , etc . )",
    "that linearize the problem .",
    "these initial conditions can be represented formally by an @xmath1-dimensional vector @xmath2 .",
    "solving the self - consistent equations with these initial conditions defines a new vector @xmath3 where @xmath4 is a function of the initial conditions .",
    "the self - consistency condition requires that the solution @xmath5 be a fixed - point of this iteration : @xmath6 .    the goal of a fixed - point iteration algorithm is to construct a new guess @xmath7 in such a way that the iteration converges , @xmath8 within the required tolerance .",
    "using the previous output as the next input , @xmath9 , does not guarantee convergence .",
    "if the resulting divergence exhibits oscillatory behavior , the usual ansatz is to mix the input at iteration @xmath10 to define the input at iteration @xmath11 :    [ lm ] @xmath12    this _ simple mixing _ slows down the iteration , and with a suitable choice of the mixing parameter @xmath13 $ ] , convergence may be achieved . however , even if one can find @xmath14 that leads to a convergent solution , there are many instances where the convergence is very slow . in large - scale calculations involving huge numbers of cases ,",
    "the running time to find poorly converging solutions may become prohibitive .",
    "if the vector field @xmath4 is differentiable , one can use derivative information to improve convergence .",
    "the idea is to regard the self - consistent condition @xmath15 as a set of non - linear equations , and to approach the problem from the point of view of finding the root : @xmath16 .",
    "this set of non - linear equations can be solved using the multidimensional newton - raphson method , in which the next guess can be approximated by @xmath17 where @xmath18 and @xmath19 is the jacobian matrix of the non - linear equations at @xmath20 . for sufficiently smooth functions",
    ", this method has a quadratic convergence .",
    "however , this approach is very expensive as it needs the explicit derivative evaluation .      in many situations ,",
    "the quick evaluation of the inverse jacobian is not possible . in such cases one can often achieve superlinear convergence by using a multidimensional generalization of the secant method ,",
    "whereby an approximate matrix @xmath21 is computed using a secant approximation based on the information obtained in previous iterations .",
    "this method is usually referred to as the quasi - newton method .",
    "the difficulty in higher dimensions is that the secant update is not unique , and nave implementations fail to converge .",
    "broyden  @xcite suggested using the sherman - morrison formula to form an update to the inverse of the jacobian that has good convergence properties : @xmath22 where @xmath23 one can start the iterative process with the initial guess @xmath24 , as this is equivalent to the simple mixing  ( [ lm ] ) . at",
    "any given step , one may also check the full quasi - newton step  ( [ bm0 ] ) : if it produces larger residuals @xmath25 or increases the energy of the solution , then one might revert to simple mixing ( [ lm ] ) .",
    "this can be especially important if the function @xmath26 varies significantly with the step size because the secant approximation may then be extremely poor .",
    "more sophisticated , but globally convergent algorithms , are discussed in @xcite .",
    "if the self - consistent equations involve many variables , i.e. , @xmath1 is large , storing the @xmath27 matrix elements of the inverse jacobian and performing the @xmath27 matrix multiplications might be prohibitive ; hence , further improvements are needed . to deal with the size issues and to improve performance ,",
    "broyden s method has been modified @xcite .",
    "the modification by johnson @xcite is now widely used in quantum chemistry . this _ modified broyden s method _ only utilizes information obtained in @xmath28 previous iterations , and this information is used in the update of the approximate inverse jacobian .",
    "we recall here the final expressions of this modified broyden mixing procedure ( a detailed derivation is given in ref .",
    "@xcite ) : @xmath29 with @xmath30 and @xmath31 where @xmath32 the weights @xmath33 ( @xmath34 ) are associated with each previous iteration and the values @xmath35 are usually chosen .",
    "the weight @xmath36 is assigned to the error in the inverse jacobian and the value @xmath37 proposed in @xcite gives stable results .",
    "the first two terms in eq .",
    "( [ bm ] ) are simply the linear mixing of eq .",
    "( [ lm ] ) with a mixing parameter @xmath14 , while the last term is an additional correction .",
    "as mentioned in @xcite , the parameter @xmath14 can be chosen to be rather large ( in the examples of this paper we have used @xmath38 ) compared to the usual values used in the simple mixing approach .",
    "equations ( [ bm]-[bm2 ] ) are all that is required to update @xmath39 . in the modified broyden s method ,",
    "large @xmath27 matrices do not appear .",
    "it is only one @xmath40 matrix @xmath41 and @xmath28 vectors of length @xmath1 that need to be stored .",
    "the iterative procedure starts with an initial input guess @xmath2 which generates the first output solution @xmath42 . in the next iteration , @xmath10=1",
    ", @xmath43 is a linear combination of @xmath2 and @xmath42 and the correction term is zero . for @xmath10=2 , the new @xmath44 contains the broyden correction including the information obtained in the previous ( @xmath10=1 ) iterations .",
    "the process is repeated until convergence is reached .",
    "our actual implementation of the modified broyden s method is based on a modified subroutine from the package pwscf(plane - wave self - consistent field ) for electronic - structure dftcalculations using pseudo - potentials and a plane - wave basis set @xcite .",
    "the code is published under the gnu  general public license .",
    "the broyden mixing routine in pwscf   is a simple module of about 20 statements that uses the blas  and lapack  libraries .",
    "as a first application of the standard broyden s method in nuclear structure calculations , we describe the numerical solution of a two - component superfluid in a spherically symmetric harmonic trap using the superfluid local density approximation ( slda ) of dft .",
    "the system is described by a three - parameter local energy density functional @xcite adjusted to results of monte - carlo calculations for homogeneous matter .",
    "the functional depends on the three local densities : @xmath45 ( particle density ) , @xmath46 ( kinetic energy density ) , and @xmath47 ( pairing tensor ) , which are constructed from the usual bogoliubov two - component quasi - particle wave functions @xmath48 $ ] : @xmath49 where @xmath50 runs over the quasi - particle states , @xmath51 , and the function @xmath52^{-1}$ ] is the thermal distribution function for fermions .",
    "the resulting kohn - sham equations can be written in the usual hfb  form , @xmath53    \\begin{pmatrix }      v_{k}(\\boldsymbol{r } )   \\\\",
    "u_{k}(\\boldsymbol{r } )     \\end{pmatrix }    =    e_{k }    \\begin{pmatrix }      v_{k}(\\boldsymbol{r } )   \\\\",
    "u_{k}(\\boldsymbol{r } )     \\end{pmatrix},\\ ] ] with the hfb matrix given by @xmath54 where the particle - hole potential @xmath55 , which enters the particle - hole hamiltonian @xmath56 and the pairing potential @xmath57 are both functions of the local densities .",
    "( the value of the effective mass @xmath58 in eq .",
    "( [ effmass ] ) has been determined in ref .",
    "@xcite . ) the introduction of two chemical potentials @xmath59 and @xmath60 eschews the need to use a different formalism ( pauli blocking ) for dealing with odd systems @xcite .",
    "the spherical hfb  equations ( [ hfbm ] ) are solved by discretizing @xmath61 in the radial coordinate @xmath62 using the so - called dvr  basis @xcite .",
    "we use two sets of abscissa ",
    "@xmath63 ( @xmath64 ) for even-@xmath65 and @xmath66 for odd-@xmath65 partial waves .",
    "thus , to represent the functions @xmath67 , @xmath68 , etc . , we need only store @xmath69 sets of data .    the chemical potentials for the two species ( @xmath59 and @xmath60 ) can be viewed as the lagrange multipliers that enter the grand thermodynamic potential @xmath70 . in the asymmetric situation , @xmath71 , the spectra for the species",
    "are shifted so that the thermal distribution functions @xmath72 appearing in  ( [ eq : anomalous_density ] ) results in different numbers of each species . at zero temperature",
    "this produces a quantized step as @xmath73 approaches the pairing gap . by introducing a small temperature ,",
    "however , this discontinuity can be smoothed without noticeably affecting the physics .",
    "this smoothing is important in order for broyden s method to achieve convergence .    instead of treating the chemical potentials as external parameters and adjusting them separately during the iteration process",
    ", we have found that they may be adjusted _ during the iteration _ in such a way that the process converges to a solution with the desired particle number constraints .",
    "after some experimenting , we have found that  in order to speed up the convergence ",
    "the chemical potentials should be updated after every iteration according to a simple ansatz : @xmath74 where @xmath75 or @xmath76 , @xmath77 is the desired particle number , and @xmath78 is some typical positive scale for the chemical potentials , and @xmath79 is some typical positive scale for the particle numbers ( such as the total desired particle number ) .",
    "the parameter @xmath80 can be adjusted to ensure convergence .",
    "note that the computed particle number @xmath81 enters in exactly one place so that the update is zero if and only if @xmath82 .",
    "thermodynamics ensures that the chemical potential is adjusted in the appropriate direction , so as long as the scales in eq .",
    "( [ eq : mu_update ] ) are appropriately chosen the process converges nicely .",
    "the only problems we have encountered are : ( i ) if the updated steps are too large , the system might oscillate wildly .",
    "this is easily compensated for by choosing a smaller value of @xmath80 ; ( ii ) if the temperature is too low , the resulting function may be discontinuous , in which case the update ( [ eq : mu_update ] ) may cause an oscillation . introducing a small , but finite , temperature ( smaller than any relevant scale ) cures this problem .",
    "the broyden vector @xmath83 in our slda calculations contains the values of @xmath68 and @xmath67 on two dvr  grids , and two chemical potentials : @xmath84 thus , for a basis of size @xmath85 , the size of the broyden vector is @xmath86 .",
    "we found that in order to ensure consistency in the above scheme , _ all _ parameters used in the iteration should appear in the broyden process .",
    "thus , even though our description in terms of the dvr  basis is somewhat redundant with the function evaluated at two sets of abscissa @xmath63 and @xmath66 , one must keep track of all the information describing the jacobian .",
    "also , one must be extremely careful to include any external parameters that are adjusted during the iteration in the jacobian , as well as any internal parameters that are allowed to relax , but which might add hysteresis to the system .",
    "the output of a single iteration must be a smooth and uniquely defined function of only the input vector @xmath87 .",
    "( color online ) comparison between the linear mixing algorithm and the standard broyden s method in slda for systems of @xmath88 ( top ) , @xmath89 ( middle ) , and @xmath90 ( bottom ) .",
    "the basis size is @xmath85=40 and the convergence parameter of eq .",
    "( [ eq : mu_update ] ) is @xmath80=1 .",
    "for the asymmetric systems , the equations exhibit a discontinuity responsible for small plateaus in the plots . introducing a small temperature @xmath91",
    "restores the continuity .",
    "once the approximate solution is found , the temperature may be set back to zero . ]",
    "figure [ fig : slda ] displays some typical results . here",
    "we solve the problem of 60 , 59 , and 45 particles in a harmonic trap .",
    "we consider the cases with equal numbers @xmath92 , one particle extra @xmath93 , and half - paired @xmath94 .",
    "the size of the broyden vector is @xmath1=162 .",
    "we see that in all cases , broyden s method performs substantially better than the linear mixing method .",
    "note that there are many cases in which the full - step algorithm ( @xmath14=1 ) does not converge .",
    "this is typically because the system exhibits some form of oscillation and the full step overshoots each time . in our problem",
    "this is due to the chemical potential update , and indicates that we should probably choose a smaller factor @xmath80 in eq .",
    "( [ eq : mu_update ] ) .",
    "broyden s method , however , automatically detects this and compensates accordingly , thus achieving good convergence even if @xmath80 is not properly chosen .    in the odd - particle case",
    "( 30 , 29 ) , a plateau appears where the convergence improves very slowly .",
    "this marks the point at which the chemical potentials adjust so as to split one state off from the fermi sea .",
    "prior to this , the large - scale structure of the initial state is corrected , but once this occurs , the chemical potentials must be finely tuned so that exactly one extra state is occupied .",
    "broyden s method has the same problem because the approximate gradient changes rapidly . to deal with this",
    ", a small temperature is assumed .",
    "this makes the functions smooth and facilitates convergence .",
    "once the steps are small enough that the energies do not cross zero , the oscillations terminate and convergence is resumed .",
    "if problems persist , the strategy is to start with a fairly large temperature to isolate the approximate values of the chemical potentials ( only achieving rough convergence ) , and then iterating with these values at much lower temperatures to reach the desired tolerance .",
    "in this section we discuss the adaptation and performance of the modified broyden s method in self - consistent nuclear structure calculations with the hfodd  code of ref .",
    "the code solves the skyrme - hfb  problem by expanding the solutions on the anisotropic cartesian harmonic oscillator ( ho ) basis .",
    "hfodd does not have any self - consistent symmetry built in ; hence , all deformation degrees of freedom can be taken into account . as the time - reversal symmetry can be broken in hfodd , the code can be used to describe nuclear rotation using the cranking approximation .",
    "the building blocks of the skyrme - hfb  approach are the particle density @xmath95 and the pairing density @xmath96 .",
    "the latter is related to the pairing tensor @xmath97 of sec .",
    "[ sec : unitary - fermi - gas ] by an anti - unitary transformation ( see , e.g. , @xcite ) .    from @xmath98 and @xmath99 ,",
    "other local densities and currents are constructed by considering spin and isospin degrees of freedom , and by taking derivatives up to the second order @xcite . by coupling the local densities and currents , one constructs the energy density @xmath100 that is scalar , time - even , and isoscalar . in its current version",
    ", hfodd does not consider explicit proton - neutron mixing ; hence , the hfb  equations are solved for protons and neutrons separately .",
    "a variation of the total energy with respect to the single - particle wave functions yields the mean field @xmath101 and pairing field @xmath102 that enter the hfb  hamiltonian matrix : @xmath103 the particle - hole mean - field hamiltonian can be expressed as : @xmath104 where the subscript @xmath105=0 ( 1 ) denotes isoscalar ( isovector ) fields , while the superscript @xmath106 ( @xmath107 ) labels time - even ( time - odd ) fields .",
    "the pairing field @xmath102 in hfodd is related to the usual pairing field @xmath108 in eq .",
    "( [ matrixh ] ) by the same anti - unitary transformation that relates @xmath99 and @xmath97 . in our hfb  calculations",
    ", we employed the density - dependent delta interaction in the particle - particle channel .",
    "the corresponding particle - particle mean - field hamiltonian reads : @xmath109   \\tilde{\\rho}(\\boldsymbol{r } ) , \\label{pairing - field}\\ ] ] where @xmath110=0.16@xmath111 .",
    "it this paper we adopted the value of @xmath112=0.5 corresponding to the so - called mixed pairing ( see ref .  @xcite and references therein ) . due to the zero - range of the pairing interaction , a cut - off energy of 60mev is used when summing up the contributions of the hfbquasi - particle states to the density matrices . for",
    "a given cut - off , the pairing strength @xmath113 is determined such as to reproduce the experimental neutron pairing gap in @xmath114sn , @xmath115=1.245mev . as discussed in ref .",
    "@xcite , this renormalization procedure gives very similar results as the pairing regularization method @xcite .",
    "the mean - field hamiltonian ( [ mean - field ] ) depends on the following self - consistent potentials built of the local densities and currents : @xmath116 + u_{t}(\\boldsymbol{r } ) \\medskip\\\\                    & \\displaystyle + \\frac{1}{2i } \\left (   \\overleftrightarrow{\\nabla}\\sigma\\cdot\\overleftrightarrow{b}_{t}(\\boldsymbol{r } ) +   \\overleftrightarrow{b}_{t}(\\boldsymbol{r})\\cdot\\overleftrightarrow{\\nabla}\\sigma",
    "\\right ) \\medskip \\\\ \\gamma_{t}^{odd}(\\boldsymbol{r } ) & = \\displaystyle -\\boldsymbol{\\nabla}\\cdot\\left [ \\left ( \\boldsymbol{\\sigma}\\cdot\\boldsymbol{c}(\\boldsymbol{r})\\boldsymbol{\\nabla}\\right)\\right ] + \\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\sigma}_{t}(\\boldsymbol{r } ) \\medskip\\\\                    & \\displaystyle + \\frac{1}{2i } \\left (   \\boldsymbol{\\nabla}\\sigma\\cdot\\boldsymbol{i}_{t}(\\boldsymbol{r } ) +   \\boldsymbol{i}_{t}(\\boldsymbol{r})\\cdot\\boldsymbol{\\nabla } \\right ) .",
    "\\end{array}\\ ] ] the potentials @xmath117 and @xmath118 are real scalar fields ( 1 component ) , @xmath119 , @xmath120 and @xmath121 are real vector fields ( 3 components ) , and @xmath122 is a real second - rank tensor field ( 9 components ) .",
    "the pairing potential @xmath123 is a two - component complex scalar field .",
    "the ho  eigenfunctions are hermite polynomials weighted by a gaussian factor .",
    "consequently , all integrations in hfodd are carried out by using the gauss - hermite quadrature @xcite .",
    "the mesh of the gauss - hermite nodes defines the discretized grid , and it is sufficient to define mean - field potentials on this grid to compute the hfb  matrix .",
    "the broyden vector @xmath83 in hfodd  contains the values of the 44 self - consistent field components on the gauss - hermite grid @xmath124 : @xmath125 ,   \\im[\\tilde{h}_{t}(\\boldsymbol{r_i } ) ]     \\right \\}.\\end{gathered}\\ ] ] the advantage of dealing with the fields is that one does not have to worry about the unitarity condition for the generalized density matrix .    if @xmath126 , @xmath127 , and @xmath128 are the numbers of gauss - hermite nodes in the @xmath129- , @xmath130- and @xmath131-direction respectively , the total size of the broyden vector in hfoddis @xmath132 . for a spherical ho  basis with @xmath133=12 , the number of gauss - hermite points required to perform exact integrations is @xmath134 , and the size of the broyden vector becomes @xmath1=773,344 . in double precision",
    "floating point arithmetics , this represents approximately 6.2 mb of memory . for @xmath28=8 vectors retained in the broyden history , this represents a 100 mb memory overhead .",
    "calculations involving larger bases are often required for studies of , e.g. , fission pathways , and it is not unusual to deal with @xmath133=20 for which the size of the broyden vector becomes as large as @xmath1=3,259,872 , corresponding to @xmath135416 mb of additional memory .",
    "figure  [ fig2 ] illustrates the use of broyden s method for a cranked hartree - fock calculation ( without pairing ) for the lowest high - spin superdeformed band of @xmath136 tb . the skm@xmath137 skyrme functional @xcite has been used .",
    "the rotation is generated by adding to the mean - field hamiltonian ( [ mean - field ] ) the cranking term @xmath138 , with @xmath139 being the rotational frequency . as the time - reversal symmetry",
    "is broken in hf , both time - even and time - odd fields appear .",
    "the calculation at @xmath140=0.5mev was initialized with the unconstrained hf  results for the superdeformed vacuum configuration of @xmath136 tb ( with all the lowest single - particle hf  routhians occupied ) at @xmath141=0 .",
    "the calculations at @xmath140=1.0mev were initialized with the converged results at @xmath140=0.5mev .",
    "the same stretched ho  basis containing @xmath133=15 shells and a deformation of @xmath142=0.61 and @xmath143=0.1 was used in both cases .",
    "= 0.5 , black symbols ) and the modified broyden s method ( @xmath14=0.7 , @xmath28=7 ) in hfodd  for a high - spin superdeformed band in @xmath136 tb at two values of rotational frequencies @xmath144=0.5mev and 1mev . ,",
    "scaledwidth=47.0% ]    the advantage of the modified broyden s method over the simple mixing is evident .",
    "while in the standard calculations the required tolerance of @xmath145 is achieved after @xmath10@xmath13530 iterations , using the linear mixing , the same outcome is achieved after 130 steps .",
    "figure  [ fig3 ] illustrates the constrained hfodd  calculations with pairing for the superdeformed minimum in @xmath146dy at the quadrupole moment of @xmath147=20eb ( using the sly4 skyrme functional @xcite ) and also for the spherical ground - state of @xmath148pb ( using the skp skyrme functional @xcite ) .",
    "both calculations were carried out with mixed pairing and the lipkin - nogami ( ln ) particle - number corrections ( see , e.g. , ref .",
    "@xcite ) . in order to obtain stability of the results ,",
    "the proton and neutron @xmath149 parameters of the ln  model had to be incorporated into the broyden vector .",
    "= 0.5 , black symbols ) and broyden s method ( @xmath14=0.7 , @xmath28=7 ) in hfodd   for the superdeformed minimum in @xmath146dy at the quadrupole moment of @xmath147=20eb ( sly4 skyrme functional , @xmath133=14 ) and the spherical ground state of @xmath148pb ( skp skyrme functional , @xmath133=12 ) .",
    ", scaledwidth=47.0% ]    again , as in fig .",
    "[ fig2 ] , the modified broyden s method provides an impressive improvement over the linear mixing scheme .    before concluding this section",
    ", we would like to make an important technical remark .",
    "in cartesian coordinates , the ho  wave - functions are products of the hermite polynomials and the gaussians . in the code hfodd",
    "the gaussians do not have to be calculated explicitly , as they are already incorporated into the gauss - hermite quadrature weights @xcite .",
    "however , this implies that the mean fields used in hfoddare gaussian - scaled .",
    "consequently , they can take non - zero ( and possibly large ) values at some points of the gauss - hermite grid where the physical potentials practically vanish .",
    "using the scaled potentials as inputs to broyden s method can be a source of very significant numerical instability .",
    "indeed if the scaled potentials ( or densities ) are used , numerical and physically insignificant fluctuations of the real potentials are artificially enhanced , thereby introducing considerable ( and artificial ) numerical noise .",
    "this instability is not present when the physical mean - field potentials are used .",
    "in this section we discuss the performance of the modified broyden s method as applied to the axial hfb   problem . to this end , we employ the hfbtho  code @xcite that solves the skyrme - hfb  equations by expanding the eigenstates in the cylindrical transformed harmonic oscillator ( tho ) basis . in the examples shown in this section",
    ", we use a sly4 skyrme energy density functional augmented by mixed pairing ( [ pairing - field ] ) . the hfb  hamiltonian matrix ( [ hfbmatrix ] )",
    "is represented in a tho   basis .",
    "the broyden vector @xmath83 in hfbtho   contains the matrix elements of the self - consistent fields @xmath101 and @xmath102 for neutrons and protons : @xmath150 since @xmath101 and @xmath102 are hermitian , @xmath151 .",
    "the chemical potentials for neutrons and protons are adjusted at each step @xmath10 to the correct number of particles .",
    "the matrix formulation ( [ mfor ] ) makes it easy to efficiently incorporate non - local terms that appear , e.g. , in the particle - number restoration schemes .",
    "some results of our broyden hfbtho   calculations have been reported in ref .",
    "@xcite .",
    "since hfbtho   strictly preserves axial symmetry , parity , and time reversal , the number of independent matrix elements is significantly reduced as compared to the full symmetry - unconstrained case of sec .",
    "[ sec : symm - unconstr - hfb ] .",
    "for instance , for the basis space of @xmath152=20 principal oscillator shells , the length of the broyden vector is @xmath1=261,228 . for the modified broyden s method with @xmath28=8 , the required memory increase in hfbthoas compared to",
    "the simple linear mixing algorithm is usually less than 33 mb , i.e. , is practically negligible .    in the implementation of the linear",
    "mixing procedure in hfbtho , the mixing parameter @xmath14 varies .",
    "initially its value is set at @xmath14=0.1 . in the next iteration ,",
    "if the largest element of @xmath153 , max@xmath154 , is less than max@xmath155 , @xmath14 is multiplied by a factor of 1.13 until it reaches the maximum value of @xmath14=1.0 .",
    "when the condition max@xmath154@xmath156max@xmath155 is met , @xmath14 is returned to its initial value of 0.1 , and the process starts all over again .",
    "such a technique has yielded stable results for all cases considered .",
    "figure [ fig4 ] compares linear mixing and broyden s method for the spherical nucleus @xmath114sn , which is often used to determine the pairing strength of the functional .",
    "both calculations are initiated from the same woods - saxon fields @xcite .",
    "usually convergence of all physical quantities of interest is achieved when max@xmath154 is less than @xmath157 . for the nucleus @xmath114sn , which represents a typical case ,",
    "broyden s method increases the convergence rate by a factor of @xmath1353 , as compared to the linear mixing .",
    "while the absolute convergence rate does depend on an individual nuclear configuration , broyden s method has proved faster than the linear mixing in all the cases investigated . in particular , for some pathological configurations the improvement is staggering .",
    "such an example is shown in fig .  [ fig4 ] ( bottom ) for the prolate configuration in @xmath158rn .",
    "sn ( top ) and @xmath158rn ( bottom ) .",
    "the largest element of @xmath153 is shown as a function of @xmath10 .",
    "the modified broyden mixing was carried out with @xmath14=0.7 , @xmath36=0.01 , and @xmath33=1 for @xmath28=3 ( dashed line ) and @xmath28=7 ( solid line ) .",
    "the inset shows the slow convergence of the linear mixing for the pathological case of @xmath158rn . here",
    ", the tolerance 10@xmath159 is reached after 4,345 iterations .",
    ", scaledwidth=47.0% ]    here , the efficiency of broyden s algorithm is almost a hundred times better than the linear mixing .",
    "an additional 30% gain can be made by increasing the number of vectors retained in the broyden history from @xmath28=3 to @xmath28=7 .",
    "broyden s method proves especially helpful for constrained calculations in which the total energy is calculated as a function of some collective variables ( usually expectation values of selected one - body operators ) .",
    "a typical example is shown in fig .",
    "[ fig6 ] that displays the quadrupole deformation energy curve for @xmath160ra .",
    "the quadrupole deformation @xmath161 is related to the total quadrupole moment @xmath162 via the usual relation : @xmath163 starting from the converged solution at the neighboring point of the deformation curve , the calculation converges in no more than 20 - 30 iterations .",
    "the number of iterations is reduced by a factor of 2 - 3 with respect to the linear mixing used under the same conditions .",
    "since constrained calculations involve a large number of points along the collective path , and in many applications several collective coordinates are involved , such a gain greatly improves the scalability of computations .",
    "ra versus quadrupole deformation obtained in the constrained hfbtho  calculations . the local minima ( maxima ) are marked by dots ( squares ) .",
    "while in the unconstrained calculations the linear mixing converges at the local minima only , broyden s method yields _ both _ local minima and maxima , as indicated by arrows .",
    ", scaledwidth=47.0% ]    a feature of broyden s method , which is not present when using the linear mixing , is the ability to converge at both minima and maxima of the energy curve , which represent solutions of unconstrained hfb  calculations .",
    "the extrema in the energy curve of @xmath160ra are marked in fig .",
    "[ fig6 ] by black symbols . starting the unconstrained calculation from a constrained solution at @xmath161=0.25 and using the linear mixing , one obtains the local minimum at @xmath161@xmath1640.05 . under the same conditions , the broyden mixing yields the maximum at @xmath161@xmath1640.3 .",
    "a similar situation happens when starting with an initial guess at zero deformation : the linear mixing converges to the slightly deformed prolate minimum , while the broyden mixing yields the spherical maximum of the energy curve .",
    "this interesting feature of broyden s method may be particularly useful for many - body tunneling calculations ( e.g. , fission ) , since it allows to compute the potential barrier height with a much better accuracy than when using the linear mixing in a constrained mode .",
    "however , it also implies that a more detailed knowledge of the potential energy surface is required to compute unconstrained minima , since some of the converged solutions may turn out to be local maxima .",
    "a possible solution to this problem is to make use of the curvature condition @xmath165 which guarantees that the broyden step is downhill , i.e. , toward the minimum . in practical calculations ,",
    "we accept the broyden step if eq .",
    "( [ cc ] ) is satisfied . otherwise , we apply the linear mixing while keeping the current iteration in the broyden history",
    ". such a procedure bypasses maxima or inflection points and properly converges to the nearest local minimum .",
    "in this section we illustrate the efficiency of the modified broyden s method in the context of the nuclear cc  theory .",
    "coupled - cluster theory originated in nuclear structure ; it was pioneered by coester and kmmel @xcite in the early 1960s . in the last two decades , it has been applied mostly in quantum chemistry and today it defines the state - of - the - art many - body theory in this field ( see @xcite for a recent overview ) .",
    "recently , the ccapproach has seen a revival in nuclear structure @xcite . in @xcite",
    "it was applied to the description of loosely bound and unbound helium isotopes ; in @xcite it was shown that coupled cluster meets few - body benchmarks , and converged results for the ground state energy of @xmath166ca were given ; in @xcite coupled - cluster theory was extended to three - body hamiltonians , and the first cc  calculations with three - nucleon forces were presented .    within the cc  theory , the nuclear ground - state wave function",
    "is written as @xmath167 is a single - particle product state expressed in some convenient representation and @xmath168 is a correlation operator that can be expressed in terms of @xmath50-body operators @xmath169 representing particle - hole ( p - h ) excitations with respect to the reference state @xmath170 . in eq .",
    "( [ t ] ) and in the following , @xmath171 label hole orbitals , while @xmath172 refer to particle states .",
    "the many - body correlations atop the reference state are introduced through the exponentiated correlation operator .",
    "if no truncations are introduced in @xmath173 , the theory is exact and the choice of starting reference state is arbitrary .",
    "however , in practice , one typically restricts expansion ( [ t ] ) to the two leading terms , @xmath174 . within the resulting coupled - cluster singles and doubles ( ccsd ) model ,",
    "the cc  equations can be written as @xmath175 here @xmath176 is a @xmath177 excitation of the reference state @xmath170 , and @xmath178 is the similarity - transformed hamiltonian ( note that @xmath179 is non - hermitian ) .",
    "the last expression on the right - hand side of eq .",
    "( [ hsim ] ) indicates that only fully connected diagrams contribute to the construction .",
    "this ensures that no unlinked diagrams enter the cc  wave function , regardless of the truncation level in @xmath173 , and this property makes cc  theory size extensive @xcite .    in order to determine the ground state energy @xmath180 in eq .",
    "( [ ccsd ] ) , the p - h excitation amplitudes @xmath181 and @xmath182 have to be evaluated through a nonlinear set of equations ( [ ccsd1 ] ) and ( [ ccsd2 ] ) . by making use of diagram rules and defining intermediates by writing the diagrams in factorized form",
    ", the equations for the amplitudes can be written in a quasi - linearized form .",
    "as an example , eq .  ( [ ccsd1 ] ) can be written as : @xmath183 in ( [ eq : int_eq ] ) , @xmath184 is the fock matrix and @xmath185 , @xmath186 , and @xmath187 are the intermediates @xcite .",
    "the non - linearity is hidden in the intermediates which depend on the amplitudes @xmath181 and @xmath182 .",
    "typically the number of unknowns is too large to allow for a direct solution of the cc  equations ; hence , one has to resort to iterative approaches . in the largest calculation",
    "we have performed to date @xcite , we solved eqs .",
    "( [ ccsd1 ] ) and ( [ ccsd2 ] ) for @xmath188 number of unknowns , on 1000 2 gb parallel processors .",
    "each iterative step costs , at the ccsd  level , @xmath189 computational cycles ( @xmath190 is the number of hole / particle orbitals ) .    considering the number of unknowns and the highly non - linear nature of cc  equations ,",
    "the use of iterative convergence accelerators , such as the modified broyden s method , is a must . in our nuclear cc  calculations ,",
    "the broyden vector is given by the amplitudes : @xmath191    figure  [ ccfig1 ] compares the performance of the modified broyden s method with @xmath28=4 , 8 , and 12 to the simple mixing ansatz ( [ lm ] ) . to solve the ccsd  equations for the ccsd  ground state energies of @xmath192si ( top ) and @xmath193ni ( bottom ) , we have used an oscillator representation of the hamiltonian in a model space of @xmath152=10 major oscillator shells with @xmath194=32mev .",
    "the hamiltonian consists of the kinetic - energy operator ( minus the center - of - mass correction ) and the n@xmath195lo nucleon - nucleon interaction of ref .  @xcite .",
    "it is seen that utilizing broyden s method increases the convergence dramatically as compared to the simple mixing .",
    "it is found that for @xmath28=12 , iterations converge more rapidly , and the tolerance of 10@xmath196 is reached typically after 30 - 40 iterations . for the linear mixing to achieve similar accuracy ,",
    "130 - 140 iterations are required .",
    "broyden s method , a quasi - newton method for the numerical solution of nonlinear equations in many variables , is widely used in quantum chemistry to perform electronic - structure calculations . in this work",
    ", we applied broyden s method ( both in its standard and modified variants ) to several nuclear structure problems .",
    "the examples range from several dft   applications in various geometries to _ ab - initio _",
    "cc  calculations .    the number of unknown variables ( i.e. , the size of the broyden vector ) in our calculations ranges from @xmath135200 in slda calculations with the standard broyden s method , to @xmath135300,000 in hfbtho , @xmath1353,000,000 in hfodd , and @xmath13510@xmath197 in cc applications of the modified broyden s algorithm . much faster convergence has been achieved in comparison with the linear - mixing procedure which is often used in such types of calculations .",
    "we note that broyden s method often achieves superlinear convergence , although mildly .",
    "if the iteration is not properly structured , then it might not correspond to a contractive mapping and may not converge . by constructing an approximation to the jacobian",
    ", broyden s method can determine the downhill direction even if the iteration itself does not provide this information .",
    "the downhill direction chosen by broyden s method is towards a fixed point , not necessarily towards a minimum of the functional .",
    "thus , the iterative process might easily converge to a maximum or a saddle point even when the iteration would naturally head towards a minimum .",
    "if the goal is to find the minimum , a combination of the linear mixing and broyden s method can be efficiently used , as demonstrated in the example of constrained hfb  calculations of fig .",
    "[ fig6 ] . however , the above feature of broyden s method to converge to maxima or saddle points can be taken advantage of if the theoretical objective _ is _ to determine local maxima or saddle points ( e.g. , when studying fission pathways )",
    ".      useful discussions with jorge mor and jason sarich are gratefully acknowledged .",
    "the unedf scidac collaboration is supported by the u.s .",
    "department of energy under grant no .",
    "de - fc02 - 07er41457 .",
    "this work was also supported by the u.s .",
    "department of energy under contract nos .",
    "de - fg02 - 96er40963 ( university of tennessee ) , de - ac05 - 00or22725 with ut - battelle , llc ( oak ridge national laboratory ) , de - fg05 - 87er40361 ( joint institute for heavy ion research ) , and de - fg02 - 97er41014 ( university of washington ) , by the national nuclear security administration under the stewardship science academic alliances program through the u.s .",
    "department of energy research grant de - fg03 - 03na00083 , and by the polish ministry of science and education under contract n 202 179 31/3920 .",
    "wn acknowledges support from the carnegie trust during his stay in scotland .",
    "oliveira , e.k.u .",
    "gross , and w. kohn , phys .",
    ". lett . * 60 * , 2430 ( 1988 ) ; n.n .",
    "lathiotakis , m.a.l .",
    "marques , m. lders , l. fast , and e.k.u .",
    "gross , int .",
    ". chem . * 99 * , 790 ( 2004 ) ; m. lders , m.a.l .",
    "marques , n.n .",
    "lathiotakis , a. floris , g. profeta , l. fast , a. continenza , s. massidda , and e.k.u .",
    "gross , phys .",
    "b * 72 * , 024545 ( 2005 ) .    m. bender , p .- h . heenen , and p .-",
    "reinhard , rev .",
    "mod . phys . * 75 * , 121 ( 2003 ) ; _ extended density functionals in nuclear structure physics _ , ed . by g.a .",
    "lalazissis , p. ring , and d. vretenar ( springer verlag , 2004 ) .",
    "broyden , math . comput . * 19 * , 577 ( 1965 ) .",
    "dennis and r.b .",
    "schnabel , _ numerical methods for unconstrained optimization and nonlinear equations _ , ( prentice - hall , 1983 ) ; w.h .",
    "press , s.a .",
    "teukolsky , w.t .",
    "vetterling , and b.p .",
    "flannery , _ numerical recipies : the art of scientific computing _",
    ", third ed .",
    "( cambridge university press , 2007 ) .",
    "j. dobaczewski and j. dudek , comput .",
    ". commun . * 102 * , 166 ( 1997 ) .",
    "j. dobaczewski and j. dudek , comput .",
    "commun.*102 * , 183 ( 1997 ) ; j. dobaczewski and j. dudek , comput .",
    "* 131 * , 164 ( 2000 ) ; j. dobaczewski and p. olbratowski , comput .",
    ". commun . * 158 * , 158 ( 2004 ) ; j. dobaczewski and p. olbratowski , comput . phys .",
    "commun.*167 * , 214 ( 2005 ) .",
    "j. dobaczewski , w. nazarewicz , t.r .",
    "werner , j .- f .",
    "berger , c.r .",
    "chinn , and j. decharg , phys .",
    "rev . * c53 * , 2809 ( 1996 ) . j. dobaczewski , w. nazarewicz , and m.+v .",
    "stoitsov , eur .",
    "j. a * 15 * , 21 ( 2002 ) p.j .",
    "borycki , j. dobaczewski , w. nazarewicz , and m.v .",
    ". rev . * c73 * , 044319 ( 2006 ) .",
    "a. bulgac , phys .",
    "c * 65 * , 051305(r ) ( 2002 ) .",
    "j. bartel , p. quentin , m. brack , c. guet , and h.b .",
    "hkansson , nucl . phys . *",
    "a386 * , 79 ( 1982 ) .",
    "e. chabanat , p. bonche , p. haensel , j. meyer , and r. schaeffer , nucl . phys . *",
    "a627 * , 710 ( 1997 ) ; * a635 * , 231 ( 1998 ) .      m.v .",
    "stoitsov , j. dobaczewski , r. kirchner , w. nazarewicz , and j. terasaki , phys .",
    "c * 76 * , 014308 ( 2007 ) .",
    "stoitsov , j. dobaczewski , w. nazarewicz , s. pittel , and d.j .",
    "dean , phys .",
    "c * 68 * , 054312 ( 2003 ) .",
    "stoitsov , in _ nuclear theory _ , ed . by s. dimitrova , proc .",
    "workshop on nuclear theory , rila mountains , bulgaria , june 2007 ( institute for nuclear research and nuclear energy bulgarian academy of sciences , sofia , 2008 ) , p. 13 .",
    "f.  coester , nucl .",
    "* 7 * , 421 ( 1958 ) .",
    "f.  coester and h.  k \" ummel , nucl .",
    "* 17 * , 477 ( 1960 ) .",
    "bartlett and m.  musia , , 291 ( 2007 ) .",
    "gour , g. hagen , m. hjorth - jensen , k. kowalski , t. papenbrock , p. piecuch , and m. woch , nucl .",
    "a * 752 * , 299 ( 2005 ) .",
    "g.  hagen , d.j .",
    "dean , m.  hjorth - jensen , and t.  papenbrock , phys .",
    "b * 656 * , 169 ( 2007 ) .",
    "g.  hagen , t.  papenbrock , d.j .",
    "dean , a.  schwenk , a.  nogga , m.  wloch , and p.  piecuch , 034302 ( 2007 ) . g.  hagen , d.  j.  dean , m.  hjorth - jensen , t.  papenbrock , a.schwenk , , 044305 ( 2007 ) .",
    "gour , p. piecuch , m. hjorth - jensen , m. woch , and d.j .",
    "dean , , 024310 ( 2006 ) .",
    "d.r . entem and r. machleidt , phys .",
    "b * 524 * , 93 ( 2002 ) ."
  ],
  "abstract_text": [
    "<S> broyden s method , widely used in quantum chemistry electronic - structure calculations for the numerical solution of nonlinear equations in many variables , is applied in the context of the nuclear many - body problem . </S>",
    "<S> examples include the unitary gas problem , the nuclear density functional theory with skyrme functionals , and the nuclear coupled - cluster theory . </S>",
    "<S> the stability of the method , its ease of use , and its rapid convergence rates make broyden s method a tool of choice for large - scale nuclear structure calculations .     </S>",
    "<S> = # 1 </S>"
  ]
}