{
  "article_text": [
    "the single - particle retarded green s function ( gf ) is a key tool to calculate local and transport properties in mesoscopic systems @xcite , such as conductance , shot noise @xcite , local density of states , and local currents @xcite . in the most popular scheme in which a scatterer is connected to two ( or more ) semi - infinite ballistic leads",
    ", the landauer - bttiker formula @xcite expresses the conductance @xmath0 in terms of the transmission probability @xmath1 across the scatterer on the fermi surface .",
    "typically , the electronic structure and transport properties of a mesoscopic system are described by a lattice model with a localized basis in real space , e.g. , discretization of the continuous model @xcite , empirical tight - binding @xcite , or first - principles density - functional theory with a localized basis set @xcite .",
    "then @xmath1 is constructed from the lattice gf @xmath2 across the scatterer through either an expression derived by caroli _",
    "@xcite or the fisher - lee relations @xcite that express the scattering matrix @xmath3 of the scatterer in terms of the lattice gf @xmath2 .    the recursive gf method ( rgf ) is a standard tool to compute the lattice gf of a scatterer connected to multiple leads @xcite .",
    "this method is reliable , computationally efficient , and allows for a parallel implementation @xcite .",
    "it was pioneered by thouless and kirkpatrick @xcite and by lee and fisher @xcite .",
    "then mackinnon presented a slice  formulation for a general layered system , which is the form most used nowadays @xcite .",
    "variations of the method were also introduced to treat multiple leads @xcite , arbitrary geometries @xcite , and local scatterers inside an infinite periodic system @xcite . with the development of many numerical algorithms , such as fast recursive or iterative schemes @xcite and closed - form solutions @xcite , the development of rgf has culminated in many packages with different focus @xcite and is applicable to an arbitrary lattice hamiltonian @xcite . however , these techniques and our knowledge about the lattice gf still suffer from two drawbacks / limitations .    , while the latter calculates the scattering matrix @xmath4 .",
    "the fisher - lee relations allow @xmath4 to be constructed from @xmath5 , while the inverse relation remains absent for a general lattice model . ]",
    "first , there are two widely used approaches in mesoscopic quantum transport :  the gf approach @xcite that computes the gf @xmath5 and the wave function mode matching approach @xcite that computes the unitary scattering matrix @xmath4 .",
    "however , the connection between the gf @xmath5 and @xmath4 and hence the connection between these two approaches remain incomplete .",
    "it is well known that @xmath4 can be constructed from @xmath5 through the fisher - lee relations ( see fig .",
    "[ g_gfvsmodematch ] ) , as first derived by fisher and lee @xcite for a single parabolic band and two - terminal structures and later generalized to multiple leads @xcite and arbitrary lattice models @xcite . however , the inverse of this relation is nontrivial : describes the scattering of both traveling and _ evanescent _ waves , while @xmath4 only describes the scattering of traveling waves , @xmath5 and @xmath4 are equivalent only in the asymptotic regions of the lead , i.e. , sufficiently far way from the scatterer such that the evanescent waves vanish completely . ]",
    "explicit expressions of @xmath5 in terms of @xmath4 were derived @xcite only for a single parabolic band and in regions far from the scatterer .",
    "generalization of this result to a general lattice model and over other regions would not only complete the equivalence @xcite between the gf approach and the wave function mode matching approach ( fig .",
    "[ g_gfvsmodematch ] ) , but also provides important tools to analyze the multi - probe scanning tunneling microscopy ( stm ) , which has been applied to characterize a wide range of systems ( see refs . for recent reviews ) in the past few years , including nanowires @xcite , carbon nanotubes @xcite , graphene nanoribbons @xcite , monolayer and bilayer graphene @xcite , and grain boundaries in graphene @xcite and copper @xcite . with one stm probe at @xmath6 and the other stm  probe at @xmath7 ,",
    "the landauer - bttiker formula expresses the conductance between the stm probes in terms of the gf @xmath8 , which provides spatially resolved information about the sample ; e.g. , with an analytical expression for the gf of pristine graphene @xcite , settnes _",
    "_ @xcite were able to identify the different scattering processes of local scatterers in graphene . however , this analysis is still qualitative . to go one step further to extract _",
    "quantitatively _ the information about the scatterers , an explicit expression of the gf in terms of the scattering matrix is required .",
    "second , the time cost of rgf increases rapidly with the number of localized basis required to subtend the sample .",
    "this imposes a computational limit when addressing realistic experimental samples ; e.g. , many quantum transport studies on graphene consider narrow graphene nanoribbons  rather than large - area graphene .",
    "three methods have been proposed to lift this constraint .",
    "the modular rgf @xcite is limited to electrons in a single parabolic band and specific shape of the sample .",
    "the other two methods essentially reduce the number of transverse bases , either by projecting the system hamiltonian onto a small number of transverse modes @xcite or by assuming translational invariance @xcite along the transverse direction .",
    "they could significantly reduce the time cost for wide samples , but the time cost still increases linearly with the length of the scatterer ( along which transport occurs ) . to study a _",
    "long _ sample , a more efficient method is desirable .",
    "the origin of the above drawbacks / limitations is probably that the rgf treats the gf as a matrix and constructs the gf by a series of matrix recursion rules derived from the dyson equation .",
    "interestingly , although the rules for constructing the scattering matrix in terms of the gf ( i.e. , the fisher - lee relation ) are concise and physically intuitive , their rigorous derivation ( in which the gf is treated as a matrix ) turns out to be rather tedious ( see , e.g. , refs . ) .",
    "this somewhat surprising fact suggests the possible existence of a very different way to represent and calculate the gf . this could not only enable a straightforward physical interpretation of the final results , but also shed light on some previous debates @xcite on the relationship between different calculation techniques in mesoscopic quantum transport .    in this work",
    ", we develop a numerically efficient and physically transparent gf formalism to address the above issues in layered systems , i.e. , any system that is non - periodic along one direction , but is finite or periodic along the other directions .",
    "this includes a wide range of physical systems , such as interfaces and junctions , hall bars , nanowires , multilayers , superlattices , carbon nanotubes , and graphene nanoribbons .",
    "compared with the rgf that directly calculates the gf as a matrix through the dyson equations , our approach converts the calculation of the gf to the generation and subsequent propagation of a scattering wave function emanating from a local excitation .",
    "this viewpoint provides several advantages .",
    "first , the procedures for calculating the gf @xmath5 becomes physically transparent and existing results from the rgf ( such as the fisher - lee relation ) can be derived in a concise and physically intuitive manner .",
    "second , the gf @xmath5 can be readily expressed in terms of a few scattering wave functions with energy @xmath9 .",
    "this provides an _ on - shell _ generalization of the standard spectral expansion in classic textbooks on quantum mechanics @xcite , @xmath10 , which involves _ all _ the eigenstates @xmath11 and eigenenergies @xmath12 of the system . in terms of a generalized scattering matrix @xmath13 that describes the scattering of both traveling and evanescent waves",
    ", we further establish a one - to - one correspondence between @xmath5 and and @xmath13 ( see fig .",
    "1 ) . this identifies the contributions from each individual scattering channel ( including evanescent channels ) to the gf and hence allows this information to be extracted quantitatively from dual - probe stm .",
    "third , the simplicity and physical transparency of the formalism further allows us to perform an infinite summation of the multiple reflection between different scatterers and arrive at an analytical construction rule for the gf of a general layered system containing an arbitrary number of scatterers .",
    "this could make the time cost independent of the length of the sample along the transport direction and hence significantly speed up the calculation . by further reducing the number of bases along the transverse direction @xcite , our formalism enables quantum transport calculations over macroscopic distances and on large samples .",
    "recently , the chiral tunneling @xcite and negative refraction @xcite of graphene _",
    "p - n _ junctions have received a lot of interest and the anomalous focusing effect was observed experimentally @xcite , but previous theoretical studies are mostly based on the low - energy continuous model , whose validity is limited to the vicinity of the dirac points .",
    "here we apply our gf approach to perform an analytical analysis and numerical simulation for the two - dimensional conductance map of dual - probe stm experiments in a realistic graphene _",
    "p - n _ junction described by the tight - binding model .",
    "the results demonstrate the possibility of observing the spatially resolved interference pattern caused by negative refraction and further reveals some interesting features ( such as the distance - independent conductance and its quadratic dependence on the carrier concentration , as opposed to the linear dependence in uniform graphene ) that may also be observed in dual - probe stm experiments .",
    "this paper is organized as follows . in sec .",
    "ii , we introduce the model , review the commonly used rgf technique , and presents the key idea of our approach . in sec .",
    "iii , we derive the gf of an infinite system containing a single scatterer , as well as an analytical construction rule for the gf of a general layered system containing an arbitrary number of scatterers . in sec .",
    "iv , we express the gf analytically in terms of a generalized scattering matrix or in terms of a few scattering states on the energy shell @xmath9 . in sec .",
    "v , we exemplify our results in a 1d chain and then apply it to analyze and simulate the two - dimensional conductance map of a realistic graphene _",
    "p - n _ junction . finally , a brief conclusion is given in sec .",
    "-independent inside the lead , but could be disordered inside the scatterer . ]",
    "we consider a general layered system in the lattice representation .",
    "when each layer is an infinite , periodic repetition of a basic unit , we can make a fourier transform to effectively reduce each layer to a single basic unit .",
    "disorder inside each layer can also be introduced by using a sufficiently large unit cell and repeating it periodically .",
    "then we can regard each layer as a finite - size unit cell , so the system becomes a 1d lattice , e.g. , by taking each layer / slice of the structure in fig .",
    "[ g_setup](a ) as a unit cell , fig .",
    "[ g_setup](a ) becomes fig .",
    "[ g_setup](b ) .",
    "a general 1d lattice can always be decomposed into a few nonperiodic regions ( referred to as _ scatterers _ ) consisting of different unit cells sandwiched between periodic regions ( referred to as _ leads _ ) consisting of identical unit cells ; see fig .",
    "[ g_setup](b ) for an example .    without losing generality ,",
    "we consider nearest - neighbor hoppingth nearest neighbors can always be reduced to nearest - neighbor hopping by retarding @xmath14 successive unit cells as one composite unit cell . ] and use @xmath15 to denote the number of orthonormal local bases in the @xmath16th unit cell . in the representation of these bases , the lattice hamiltonian is an infinite - dimensional block - tridiagonal matrix : @xmath17 consisting of the @xmath18 hopping matrix @xmath19 between neighboring unit cells , its hermitian conjugate @xmath20 , and the @xmath21 hamiltonian matrix @xmath22 of the @xmath16th unit cell . in a lead ,",
    "@xmath23 and @xmath24 are independent of @xmath16 . in a scatterer , @xmath22 and",
    "@xmath25 could dependent on @xmath16 arbitrarily . here , as a convention , the region of the scatterers",
    "is chosen such that the hopping between the lead and the surface of a scatterer is _ the same _ as that inside this lead , e.g. , @xmath26 in fig .",
    "[ g_setup](c ) , where @xmath27 is the hopping inside the left lead . except for the hermiticity requirement @xmath28 ,",
    "the lattice hamiltonian is completely general .",
    "the ( retarded ) gf of the layered system is an infinite - dimensional matrix : @xmath29 , where @xmath30 .",
    "the gf from the unit cell @xmath31 to the unit cell @xmath16 is an @xmath32 matrix and corresponds to the @xmath33 block of @xmath34 , i.e. , @xmath35_{m , m_{0}}$ ] .",
    "hereafter we consider a fixed energy @xmath9 or @xmath36 and omit this argument for brevity .    to highlight the distinguishing features of our approach and introduce relevant concepts , we first review the commonly used rgf method before presenting our idea .",
    "the idea of the rgf is to build up the entire system out of disconnected subsystems by the dyson equation .",
    "let us start from two disconnected subsystems @xmath37 and @xmath38 characterized by the hamiltonian @xmath39 and @xmath40 , respectively .",
    "the ( retarded ) gfs of each subsystem are @xmath41 and @xmath42 .",
    "next we connect the interface ( denoted by @xmath43 ) of @xmath37 and the interface ( denoted by @xmath44 ) of @xmath38 by local couplings @xmath45 and @xmath46 .",
    "thus the dyson equation gives the gf @xmath47 of the connected system in terms of the gfs of each subsystem @xcite :    [ dseq1]@xmath48 or vice versa :    [ dseq2]@xmath49 equation ( [ dseq1 ] ) is the key to building up the entire system out of disconnected subsystems , while eq .",
    "( [ dseq2 ] ) can be used to calculate the gf of each subsystem when the gf of the connected system is known ( e.g. , if the connected system is infinite and periodic @xcite ) .",
    "the first two equations of eq .",
    "( [ dseq1 ] ) show that if we focus on one subsystem ( say @xmath37 ) , the presence of the other subsystem @xmath38  amounts to a self - energy correction to the interface of @xmath37 :  @xmath50 .      in rgf , to calculate the conductance of the general layered system as described earlier [ eq .",
    "( [ hamil ] ) ] , the system is first partitioned into the semi - infinite left lead @xmath51 ( unit cells @xmath52 ) , the central region @xmath53 ( unit cells @xmath54 ) , and the semi - infinite right lead @xmath55 ( unit cells @xmath56 ) .",
    "the _ entire _",
    "central region @xmath53 is regarded as a scatterer [ see fig . [",
    "g_setup](a ) for an example ] , so the gf is    @xmath57    let us use @xmath58 for the hamiltonian of the central region , and @xmath59 @xmath60 for the hamiltonian of the lead @xmath14 , as characterized by the unit cell hamiltonian @xmath61 and nearest - neighbor hopping @xmath62 .",
    "then the central region part of the gf is computed from @xmath63 where @xmath64 is the effective central region hamiltonian : it equals @xmath58 in the interior of @xmath53 , but differs from @xmath58 at the two surface unit cells :    [ hcc]@xmath65 due to self - energy corrections from the left and right leads :    @xmath66    here @xmath67_{0,0}$ ] is the gf of the left lead at the right surface , and @xmath68_{n+1,n+1}$ ] is the gf of the right lead at the left surface , so they are referred to as _ surface gfs _ in the literature . finally , to compute the linear conductance",
    ", we need to set @xmath69 and use the landauer - buttiker formula @xcite @xmath70 , where @xcite @xmath71 and @xmath72 .",
    "note that eq .",
    "( [ tef ] ) only involves @xmath73 , the @xmath74 block of @xmath75 . instead of direct matrix inversion",
    "( 6 ) ] , @xmath73 can be computed by building up the central region layer by layer @xcite through eq .",
    "( [ dseq1 ] ) .",
    "let us use @xmath76 @xmath77 ) to denote the gf of the subsystem consisting of the unit cells @xmath78 .",
    "the rgf starts from @xmath79 , first uses the iteration @xmath80 to obtain @xmath81 , and then uses the iteration @xmath82 to obtain @xmath83 .",
    "the number of iterations and hence the time cost of the above recursive algorithm scales linearly with the length of the scattering region .",
    "equation  ( [ tef ] ) gives the total transmission probability , i.e. , the sum of the transmission probabilities of all channels . to identify the contributions from each individual transmission channels ,",
    "it is necessary to use the gf to construct the transmission amplitude @xmath84 from the @xmath85th traveling channel in the lead @xmath51 to the @xmath86th traveling channel in the lead @xmath55 through the fisher - lee relations @xcite and then sum over all the traveling channels:@xmath87 alternatively , it is also possible to calculate the transmission amplitudes @xmath88 ( and more generally the entire scattering matrix ) by directly calculating the scattering of an incident traveling wave through the wave function mode matching approach @xcite .",
    "the equivalence between eqs .",
    "( [ tef ] ) and ( [ tef2 ] ) , which establishes a connection between the gf approach and the wave function mode matching approach , is well known for a single parabolic band @xcite . for a general lattice model , there was suspicion @xcite that eq .",
    "( [ tef2 ] ) was incomplete since the gf in eq .",
    "( [ tef ] ) includes both traveling waves and evanescent waves , while eq .",
    "( [ tef2 ] ) only includes the contributions from traveling waves .",
    "later , a rigorous equivalence proof was provided by khomyakov _",
    "_ @xcite and others @xcite , but the presence of the evanescent states does suggest that the gf is not completely equivalent to the unitary scattering matrix .",
    "there are still two remaining issues :  the calculation of the self - energies @xmath89 ( or equivalently the surface gfs @xmath90 )  and a proper definition of the scattering channels and the transmission amplitudes @xmath84 .      the numerical algorithms for computing @xmath89 or equivalently the surface gfs @xmath91 can be classified into two groups : recursive methods and eigenmode methods ( see ref .",
    "for a review ) .",
    "the former calculates an approximate surface gf through some recursive relations , while the latter provides exact  within the numerical precision  closed - form solutions to the surface gf .    the idea of the recursive methods is to split the left lead into the surface unit cell @xmath92 ( subsystem @xmath37 ) and the remaining part ( subsystem @xmath38 ) ; the dyson equation [ eq . ( [ dseq1_aa ] ) ] gives the recursive relation @xmath93 similarly , by splitting the right lead into the surface unit cell @xmath94 ( subsystem @xmath37 ) and the remaining part ( subsystem @xmath38 ) , eq .",
    "( [ dseq1_aa ] ) gives the recursive relation@xmath95 thus the surface gfs and self - energies can be obtained by simple or more efficient iteration techniques @xcite .",
    "the eigenmode method has been derived independently several times @xcite and has been shown to be superior in accuracy and performance @xcite compared to the recursive methods .",
    "the central results are explicit expressions for the self - energies :    [ sigma]@xmath96 and surface gfs :    @xmath97    in terms of the ( retarded ) _ propagation matrices _ @xmath98 ( also referred to as bloch matrices @xcite or amplitude transfer matrices @xcite in the literature ) , which can be constructed from the ( retarded ) _ eigenmodes _ of each lead .",
    "now we introduce the propagation matrices and eigenmodes in some detail , since they will play a central role in our gf approach .",
    "let us consider a lead characterized by the unit cell hamiltonian @xmath99 and nearest - neighbor hopping matrix @xmath100 .",
    "the wave propagation in this lead is governed by the uniform schrdinger equation@xmath101 where @xmath30 .",
    "imposing the bloch symmetry @xmath102 ( @xmath43 is the thickness of each unit cell ) gives @xmath103 for the eigenvector @xmath104 .",
    "for an infinite lead , the wave function @xmath105 must remain finite at @xmath106 .",
    "this natural boundary condition dictates @xmath107 to be real , so that eq . ( [ meq1 ] ) gives @xmath108 real energy bands of the lead , where @xmath108 is the number of basis states in each unit cell of this lead . for certain complex @xmath107 s ,",
    "the energies could still be real , which form the complex energy bands of the lead .",
    "conversely , given the energy @xmath9 and without imposing any boundary conditions , eq .",
    "( [ se ] ) or ( [ meq1 ] ) can be solved to yield @xmath109(retarded ) eigenmodes @xmath110 ( see appendix [ append_bulkmode ] ) @xcite , where the wave vector @xmath107 could be either real ( i.e. , _ traveling _ modes )  or complex ( i.e. , _ evanescent _ modes ) .",
    "the eigenmodes are just the collection of eigenstates on the energy shell @xmath9 in the real and complex energy bands of the lead . as a convention ,",
    "each eigenvector @xmath104 should be normalized to unity , but different eigenvectors are not necessarily orthogonal . for a traveling",
    "eigenmodes with wave vector @xmath107 and eigenvector @xmath104 , its group velocity is @xmath111 where @xmath112 is the conjugate transpose of @xmath104 , i.e. , an @xmath108-component row vector",
    ". then the @xmath113 eigenmodes are classified into @xmath108 right - going ones and @xmath108 left - going ones : the former consist of traveling modes with a positive group velocity and evanescent modes decaying exponentially to the right ( i.e. , @xmath114 ) , while the latter consist of traveling modes with a negative group velocity and evanescent modes decaying exponentially to the left ( i.e. , @xmath115 ) . for clarity",
    ", we denote the @xmath108 right - going eigenmodes as @xmath116 and the @xmath108 left - going eigenmodes as @xmath117 , where @xmath118 . for every right - going evanescent mode @xmath119 with wave vector @xmath120",
    ", there is always a left - going evanescent mode @xmath121 with wave vector @xmath122 @xmath123 @xcite .",
    "the propagation matrix @xmath124 for left - going @xmath125 ) or right - going ( @xmath126 ) waves is constructed as @xcite @xmath127 where @xmath128 $ ] ( i.e. , its @xmath85th column is @xmath129 ) .",
    "the propagation matrices are standard tools in the wave function mode matching approach @xcite to describe wave propagation ; e.g. , a general right - going wave that obeys eq .",
    "( [ se ] ) can be written as @xmath130 .",
    "since the gf @xmath34 describes the scattering of both traveling and evanescent eigenmodes by the central region , while the unitary scattering matrix @xmath131 describes the scattering of traveling eigenmodes only , it is possible to construct @xmath131 in terms of @xmath34 , i.e. , the fisher - lee - type relations .",
    "compared with the caroli s expression [ eq .",
    "( [ tef ] ) ] that gives the total transmission probability , the fisher - lee relations further provide information about the scattering of each individual traveling eigenmode . for a general lattice model , different eigenmodes @xmath132 are not orthogonal ; then for each lead , it is necessary to introduce @xmath113 ( retarded ) dual vectors @xmath133 through @xcite@xmath134 where @xmath108 is the number of bases in each unit cell of this lead . in general ,",
    "different left - going ( right - going )  eigenvectors are not orthogonal , so @xmath135 is not necessarily unitary and @xmath136 is not necessarily equal to @xmath129 , but we always have the orthonormalization and completeness relations @xmath137 which follow from @xmath138 ( @xmath139 is the identity matrix ) . by inserting the completeness relation ,",
    "any column vector @xmath104 can be expanded as a linear combination of either the @xmath108 left - going eigenvectors or the @xmath108 right - going  eigenvectors as @xmath140 with @xmath141 ) can be written as@xmath142 which has a clear physical interpretation .",
    "for example , a general right - going wave is@xmath143 i.e. , @xmath144 is first expanded as a linear combination of right - going eigenmodes @xmath145 and then each right - going eigenmode propagates as @xmath146 .",
    "now the scattering channel can be labeled by the eigenmodes , which could be either traveling or evanescent .",
    "the scattering matrix @xmath131 provides a complete description for the scattering from one traveling eigenmode into another traveling eigenmode . for a general lattice model ,",
    "the fisher - lee relations allow us to construct the scattering matrix from the lattice gf , e.g. , the transmission amplitude from the right - going eigenmode @xmath147 of the left lead into the right - going eigenmode @xmath148 of the right lead is @xcite:@xmath149 while the transmission amplitude from the left - going eigenmode @xmath150 of the right lead into the left - going eigenmode @xmath151 of the left lead is @xcite@xmath152 where @xmath153 and @xmath154 are , respectively , the unit cell thickness and _ free gf _ of the lead @xmath14 [ see eq .",
    "( [ g00 ] ) ] , and @xmath155 is the group velocity [ see eq .",
    "( [ velocity ] ) ] of the traveling eigenmode @xmath156 in the lead @xmath14 .",
    "let us assume that there is a local excitation at the unit cell @xmath31 , as described by an @xmath157-dimensional column vector @xmath158 .",
    "this excitation generates a casual scattering wave @xmath105 that has an energy @xmath9 and obeys the schrdinger equation with a local source at @xmath31:@xmath159 the solution is given by @xmath160 e.g. , for a unit excitation of the @xmath85th basis state , as described by @xmath161^{t}$ ] ( only the @xmath85th element is nonzero ) , eq .",
    "( [ phi_gf ] ) gives @xmath105 as the @xmath85th column of @xmath162 .     in an infinite lead ( a ) , a semi - infinite lead connected to a scatterer on its right ( b ) , and a finite lead sandwiched between two scatterers",
    "the zeroth - order , first - order , and second - order partial waves are denoted by black , blue , and orange arrows , respectively . ]    equation ( [ phi_gf ] ) shows that the gf can be immediately obtained once the scattering state is determined , e.g. , based on physical considerations on how the local excitation evolves to the scattering state .",
    "for example , if the local excitation @xmath163 occurs inside a lead , then it first generates an outgoing zeroth - order wave consisting of a left - going one at @xmath164 and a right - going one at @xmath165 . for an infinite lead ,",
    "there are no scatterers , so this outgoing wave is the total scattering state [ fig .",
    "[ g_basicprocess](a ) ] . for a semi - infinite lead connected to a scatterer on its right [ fig .",
    "[ g_basicprocess](b ) ] , the zeroth - order right - going wave will produce a first - order reflection wave , so the total scattering state in the lead is the sum of the zeroth - order and first - order waves . more generally , for a finite lead sandwiched between two scatterers [ fig .",
    "[ g_basicprocess](c ) ] , the right - going ( left - going ) zeroth - order wave will propagate to the right ( left ) scatterer and produce a first - order reflection wave , which in turn will propagate to the left ( right ) scatterer and then produce high - order reflection waves",
    ". the total scattering state would be the sum of all these waves .",
    "in contrast to the commonly used rgf that treats the _ entire _ central region ( regarded as a large scatterer ) numerically [ see fig .",
    "[ g_setup](a ) for an example ] , our method need only regard each _ truly disordered _ region as a scatterer for numerical treatment , while all the periodic subregions [ such as the middle lead in fig . [ g_setup](a ) ] inside the central region can be treated semianalytically by fully utilizing the translational invariance of these subregions .",
    "physically , the wave propagation inside these periodic subregions leads to complicated multiple reflection between different scatterers , which is difficult to handle analytically in the standard rgf technique in which the gf is treated as a matrix .",
    "by contrast , in our approach , it is straightforward to perform analytically an infinite summation over all the multiple reflection waves , so that the time cost can be significantly reduced .",
    "this approach also provides a physically transparent expansion of the gf @xmath5 in terms of a generalized scattering matrix @xmath13 , which can be regarded as a reverse of the well - known fisher - lee relations @xcite ( see fig .",
    "1 ) . in the next section",
    ", we will establish the procedures for calculating the gf within this framework in a physically transparent way .",
    "our gf approach essentially consists of two steps : generation of the zeroth - order outgoing partial wave by the local excitation and its propagation in the leads and scattering by the scatterers .",
    "the wave function mode matching approach @xcite has developed useful tools to describe the latter process .",
    "below we begin with an infinite lead , then we consider an infinite system containing a single scatterer .",
    "finally , we give the analytical construction rule for the gf of a general layered system containing an arbitrary number of scatterers .",
    "suppose that the lead is characterized by the unit cell hamiltonian @xmath99 and hopping @xmath27 .",
    "the scattering state @xmath105 emanating from a local excitation @xmath163 is determined by the schrdinger equation with a local source at @xmath31 : @xmath166 in either the left region @xmath167 ) or the right region ( @xmath168 ) , the local source vanishes , so the general solution would be a linear combination of left - going and right - going eigenmodes with energy @xmath9 .",
    "however , by causality considerations ( due to the infinitesimal imaginary part of the energy @xmath169 ) , the solution in the left ( right ) region should be a left - going ( right - going ) wave [ see fig .",
    "[ g_basicprocess](a ) ] : @xmath170 substituting into eq .",
    "( [ eom_0 ] ) gives @xmath171@xmath172^{-1}=[\\mathbf{t}^{\\dagger}% ( \\mathbf{p}_{+}^{-1}-\\mathbf{p}_{-}^{-1})]^{-1}. \\label{g00b}%\\end{aligned}\\ ] ] here we have used the equality @xcite    @xmath173    in arriving at eq .",
    "( [ g00b ] ) . from the scattering wave function",
    ", we immediately identify the gf of an infinite lead as @xmath174{ll}% \\mathbf{p}_{+}^{m - m_{0}}\\mathbf{g\\ \\ } & ( m\\geq m_{0}),\\\\ \\mathbf{p}_{-}^{m - m_{0}}\\mathbf{g } & ( m\\leq m_{0 } ) .",
    "\\end{array } \\right .   \\label{g_infinite}%\\ ] ] this recovers the previous result @xcite obtained by directly solving the equations of motion of the gf . for convenience , hereafter we call @xmath175 the _ free gf _ of the lead since it describes the generation of the zeroth - order outgoing wave @xmath176 from a local excitation inside this lead",
    ".          let us consider a scatterer @xmath53 connected to two semi - infinite leads @xmath51 and @xmath55 [ fig .",
    "[ g_single](a ) ] . the left ( right )",
    "surface of the scatterer is @xmath177 ( @xmath178 ) .",
    "the unit cell hamiltonian and hopping inside the left ( right ) lead are @xmath179 and @xmath180 ( @xmath181 and @xmath182 ) .",
    "the zeroth - order outgoing wave @xmath105 emanating from a local excitation @xmath163 at @xmath183 obeys eq .",
    "( [ eom ] ) with @xmath184 , i.e. , inside the scatterer . inside the left lead",
    ", @xmath105 obeys @xmath185 with @xmath186 . inside the right lead , @xmath105 obeys@xmath187 with @xmath188 . by causality",
    ", the solution in the left ( right ) lead is a left - going ( right - going ) wave [ see fig . [ g_single](a ) ] : @xmath189 where @xmath190 are propagation matrices of lead @xmath14 [ see eq .",
    "substituting @xmath191 and @xmath192 into eq .",
    "( [ eom ] ) gives a closed set of equations for @xmath105 inside the scatterer .",
    "the solution is@xmath193 where @xmath194 and @xmath64 is the effective hamiltonian for the scatterer :  it is equal to the scatterer part of the system hamiltonian @xmath195 , except for the two surface unit cells :    [ hh ] @xmath196    since @xmath197 converts a local excitation inside the scatterer into a scattering state inside the scatterer , we call it the _ conversion matrix _ of the scatterer . comparing eqs .",
    "( [ gg ] ) and ( [ hh ] ) to eqs .",
    "( [ gcc ] ) , ( [ hcc ] ) , and ( [ sigma ] ) , we see that @xmath197 is just the scatterer part of the gf .",
    "actually , from the scattering wave function , we immediately identify the gf :    [ g_all_s]@xmath198 equation ( [ gls ] ) shows that the local excitation first evolves to an outgoing wave @xmath199 at the left surface of the scatterer , and then propagates to the unit cell @xmath16 as @xmath200 .",
    "equation ( [ grs ] ) has a similar physical interpretation .      as shown in fig .",
    "[ g_single](b ) , for @xmath201 , the local excitation first generates a zeroth - order outgoing wave in the left lead:@xmath202 , where @xmath203 is the free gf of the lead @xmath14 [ eq .",
    "( [ g_infinite ] ) ] . next",
    "the right - going partial wave reaches the left surface of @xmath53 and evolves into a scattering state @xmath204 . for @xmath205 ,",
    "the local excitation first generates a zeroth - order outgoing wave in the right lead : latexmath:[$|\\phi^{(0)}(m)\\rangle=\\mathbf{g}_{m , m_{0}}^{(r)}%    reaches the right surface of @xmath53 and evolves to a scattering state @xmath204 . for either case , the total scattering state @xmath105 emanating from the local excitation is the sum of the unscattered zeroth - order partial wave and the scattering state @xmath204 .",
    "the central issue is to determine the scattering state emanating from a known incident wave , in a way similar to the wave function mode matching approach to mesoscopic quantum transport @xcite .",
    "first we consider the scattering state @xmath204 emanating from a right - going incident wave @xmath207 in the left lead .",
    "the key observation is that for arbitrary @xmath208 , the local excitation @xmath209 generates a right - going partial wave @xmath210 .",
    "therefore , in the region @xmath211 , the scattering state emanating from @xmath207 is the same as the scattering state emanating from this local excitation ( see appendix [ append_equivalence ] for a rigorous proof ) .",
    "taking @xmath212 immediately gives    @xmath213 is converted back to a local excitation @xmath214 , then the conversion matrix @xmath197 of the scatterer further converts it to the total scattering state @xmath215 according to eq .",
    "( [ phi0_scatterer ] ) . inside the left lead",
    ", @xmath204 is the sum of the right - going incident wave and a left - going reflection partial wave @xmath216|\\phi _ { \\mathrm{in}}(m_{l})\\rangle .",
    "\\label{phir_ml}%\\end{aligned}\\ ] ] inside the right lead , @xmath204 is the right - going transmission wave : @xmath217 , wherelatexmath:[\\[|\\psi(m_{r})\\rangle=\\mathbb{g}_{m_{r},m_{l}}(\\mathbf{g}^{(l)})^{-1}%     similarly , we can derive the scattering state @xmath204 emanating from a left - going incident wave @xmath207 in the right lead . inside the scatterer ,",
    "the scattering state is @xmath219 at the right surface of the scatterer [ cf .",
    "( [ phi0_scatterer ] ) ] . inside the right lead",
    ", @xmath204 is the sum of the left - going incident wave and a right - going reflection partial wave @xmath220 , where@xmath221|\\phi _ { \\mathrm{in}}(m_{r})\\rangle . \\label{phir_mr}%\\end{aligned}\\ ] ] inside the left lead , @xmath204 is the left - going transmission wave :  @xmath222 , where@xmath223)-([phi_mr ] ) with @xmath224 .",
    "this allows us to identify the gf    [ g_all_l]@xmath225\\mathbf{g}_{m_{l},m_{0}}^{(l)}. \\label{gll}%\\end{aligned}\\ ] ] these expressions have clear physical interpretations ; e.g. , eq .",
    "( [ gsl ] ) shows that the local excitation @xmath226 first evolves to a right - going partial wave and propagates rightward to the left surface of the scatterer as @xmath227 , and finally the conversion matrix of the scatterer @xmath228 further converts it to the scattering state inside the scatterer . as another example , eq .",
    "( [ gll ] ) shows that the total scattering wave inside the left lead is the sum of the zeroth - order partial wave @xmath229 and the reflection partial wave : first the local excitation @xmath226 evolves to a zeroth - order partial wave and then propagates rightwards to the left surface of the scatterer as @xmath230 , then @xmath231 converts it to the reflection wave .",
    "finally , @xmath232 propagates this reflection wave leftward to @xmath16 .",
    "similarly , the scattering state emanating from the zeroth - order left - going partial wave in the right lead is given by eqs .",
    "( [ phi_s2])-([phi_ml ] ) with @xmath233 .",
    "this allows us to identify the gf    [ g_all_r]@xmath234\\mathbf{g}_{m_{r},m_{0}}^{(r)}. \\label{grr}%\\end{aligned}\\ ] ] these can be interpreted in a similar way to eqs .",
    "( [ g_all_s ] ) and ( [ g_all_l ] ) .",
    "the above results cover previous results as special cases .",
    "for example , by directly solving the equation of motion , sanvito _ et al .",
    "_ @xcite and krsti _ et al . _",
    "@xcite obtain the gf of an infinite lead [ eq .",
    "( [ g_infinite ] ) ] and a semi - infinite lead consisting of the unit cells @xmath52 ( @xmath235 ) [ eq .",
    "( [ gl_mm0 ] ) ] , which can be regarded as a single - unit - cell scatterer at @xmath92 connected to a semi - infinite left ( right ) lead .",
    "@xcite further obtained the gf across a single scatterer [ eq .",
    "( [ grl ] ) ] . a sharp interface between a semi - infinite left lead and a semi - infinite right lead can also be regarded as a single - unit - cell scatterer connected to two semi - infinite leads . for reference ,",
    "the explicit expressions of the gfs for these simple cases are given in appendix [ append_example ] .",
    "a general layered system containing an arbitrary number of scatterers can be regarded as a _",
    "scatterer connected to one or two semi - infinite leads , e.g. , a scatterer @xmath38 connected to a finite lead @xmath51 and a semi - infinite lead @xmath55 can be regarded as a composite scatterer @xmath236 connected to one semi - infinite right lead [ fig . [ g_composite_scatterer](a ) ] , while two scatterers sandwiched between three leads can be regarded a composite scatterer @xmath236 connected to two semi - infinite leads [ fig .",
    "[ g_composite_scatterer](b ) ] .",
    "therefore , we can use eqs .",
    "( [ g_all_s ] ) , ( [ g_all_l ] ) , and ( [ g_all_r ] ) to obtain the gf of the entire system once the conversion matrix of the composite scatterer is known . in the rgf method ,",
    "the conversion matrix ( which coincides with the gf of the infinite system within the composite scatterer ) is calculated by a numerical iteration algorithm that builds up the composite scatterer slice by slice , thus the time cost increases linearly with the total length of the composite scatterer . here the physical transparency of our approach allows us to treat the multiple reflection between different scatterers analytically , so that the conversion matrix of a composite scatterer can be obtained by combining the conversion matrices of the constituent scatterers analytically with a significantly reduced time cost .",
    "the basic step is the combination of the conversion matrices @xmath237 and @xmath238 of two scatterers @xmath37 and @xmath38 into the conversion matrix @xmath197 of a composite scatterer @xmath239 .",
    "connected to a finite left lead @xmath51 and a semi - infinite right lead @xmath55 can be regarded as a composite scatterer @xmath53 connected to one semi - infinite right lead @xmath55 .",
    "( b ) two scatterers sandwiched between three leads @xmath240 can be regarded as a composite scatterer @xmath53 connected to two semi - infinite leads @xmath51 and @xmath55 . ]    as shown in fig .",
    "[ g_composite_scatterer](b ) , the left and right surfaces of the scatterer @xmath37 ( @xmath38 ) are @xmath241 and @xmath242 ( @xmath243 and @xmath244 ) and the three leads sandwiching the scatterers are the semi - infinite left lead @xmath245 the middle lead @xmath246 and the semi - infinite right lead @xmath55 . for a local excitation @xmath163 at @xmath183 , the total scattering state inside @xmath53",
    "is @xmath247 , which allows us to identify @xmath197 once the total scattering state has been obtained . for @xmath248 ,",
    "the local excitation first produces a zeroth - order partial wave in @xmath37 and @xmath108 .",
    "next the right - going partial wave in @xmath108 undergoes multiple reflections between @xmath38 and @xmath37 and finally evolves to a scattering state . for @xmath249 ,",
    "the local excitation first produces a zeroth - order partial wave inside @xmath38 and @xmath108 .",
    "next the left - going partial wave in @xmath108 undergoes multiple reflections and finally evolves to a scattering state . for @xmath250 ,",
    "the local excitation first produces a zeroth - order outgoing partial wave in @xmath108 .",
    "next the left- and right - going partial waves each undergo multiple reflections and evolve to a scattering state . for each case",
    ", the total scattering state emanating from the local excitation is the sum of the unscattered zeroth - order partial wave and the scattering state(s ) emanating from the scattered zeroth - order partial wave .",
    "therefore , the key issue is to calculate the scattering state @xmath204 emanating from a right- or left - going incident wave @xmath207 in the middle lead through multiple reflections between @xmath37 and @xmath38 .    in the middle lead , @xmath204 is the sum of the right - going part @xmath251 and the left - going part @xmath252 . inside the scatterer @xmath37 ,",
    "@xmath204 is equal to the scattering state emanating from the total incident wave @xmath253 on @xmath37 [ cf .",
    "( [ phi_s2 ] ) ] :    @xmath254    inside the scatterer @xmath38 , @xmath204 is equal to the scattering state emanating from the total incident wave @xmath255 on @xmath38 [ cf .",
    "( [ phi_s1])]:@xmath256 therefore , the scattering state inside @xmath53 is completely determined by @xmath255 and @xmath253 . for brevity",
    ", we introduce the reflection matrices @xmath257 the former ( latter ) converts a right - going ( left - going )  incident wave on the left ( right ) surface of @xmath38 ( @xmath37 ) to a left - going ( right - going )  reflection wave . to describe the multiple reflections between @xmath37 and @xmath38",
    ", we introduce the following renormalized propagation matrices that incorporate multiple reflections:@xmath258^{-1}(\\mathbf{p}_{+}^{(m)})^{\\delta m},\\\\ \\mathbf{p}_{a_{r}\\leftarrow b_{l } }   &   \\equiv\\lbrack1-(\\mathbf{p}_{-}% ^{(m)})^{-\\delta m}\\mathbb{r}_{b}(\\mathbf{p}_{+}^{(m)})^{\\delta m}% \\mathbb{r}_{a}]^{-1}(\\mathbf{p}_{-}^{(m)})^{-\\delta m},\\\\ \\mathbf{p}_{a_{r}\\leftarrow a_{r } }   &   \\equiv(\\mathbf{p}_{-}^{(m)})^{-\\delta m}\\mathbb{r}_{b}\\mathbf{p}_{b_{l}\\leftarrow a_{r}}=\\mathbf{p}_{a_{r}\\leftarrow b_{l}}\\mathbb{r}_{b}(\\mathbf{p}_{+}^{(m)})^{\\delta m},\\\\ \\mathbf{p}_{b_{l}\\leftarrow b_{l } }   &   \\equiv(\\mathbf{p}_{+}^{(m)})^{\\delta m}\\mathbb{r}_{a}\\mathbf{p}_{a_{r}\\leftarrow b_{l}}=\\mathbf{p}_{b_{l}\\leftarrow a_{r}}\\mathbb{r}_{a}(\\mathbf{p}_{-}^{(m)})^{-\\delta m},\\end{aligned}\\ ] ] where @xmath259 is the distance between @xmath37 and @xmath38 . for example , the renormalized propagation matrix @xmath260 from @xmath242 to @xmath243 is the sum of the free propagation term @xmath261 , the propagation term with two reflections @xmath262 , and so on .    using the above notations ,",
    "when @xmath207 is a right - going incident wave on @xmath38 , we have@xmath263 when @xmath207 is a left - going incident wave on @xmath37 , we have @xmath264    using the above results together with @xmath247 , we identify    [ g_all]@xmath265\\mathbb{g}_{a_{r},m_{0}}^{(a)},\\label{gma}\\\\ \\mathbb{g}_{m\\in a , m_{0}\\in m } &   = \\mathbb{g}_{m , a_{r}}^{(a)}(\\mathbf{g}% ^{(m)})^{-1}[(1+\\mathbf{p}_{a_{r}\\leftarrow a_{r}}\\mathbb{r}_{a}% ) \\mathbf{g}_{a_{r},m_{0}}^{(m)}+\\mathbf{p}_{a_{r}\\leftarrow b_{l}}% \\mathbb{r}_{b}\\mathbf{g}_{b_{l},m_{0}}^{(m)}],\\label{gam}\\\\ \\mathbb{g}_{m\\in m , m_{0}\\in b } &   = [ ( \\mathbf{p}_{-}^{(m)})^{m - b_{l}% } ( 1+\\mathbb{r}_{b}\\mathbf{p}_{b_{l}\\leftarrow b_{l}})+(\\mathbf{p}_{+}% ^{(m)})^{m - a_{r}}\\mathbb{r}_{a}\\mathbf{p}_{a_{r}\\leftarrow b_{l}}% ] \\mathbb{g}_{b_{l},m_{0}}^{(b)},\\label{gmb}\\\\ \\mathbb{g}_{m\\in b , m_{0}\\in m } &   = \\mathbb{g}_{m , b_{l}}^{(b)}(\\mathbf{g}% ^{(m)})^{-1}[(1+\\mathbf{p}_{b_{l}\\leftarrow b_{l}}\\mathbb{r}_{b}% ) \\mathbf{g}_{b_{l},m_{0}}^{(m)}+\\mathbf{p}_{b_{l}\\leftarrow a_{r}}% \\mathbb{r}_{a}\\mathbf{g}_{a_{r},m_{0}}^{(m)}],\\label{gbm}\\\\ \\mathbb{g}_{m\\in m , m_{0}\\in m } &   = \\mathbf{g}_{m , m_{0}}^{(m)}+(\\mathbf{p}% _ { + } ^{(m)})^{m - a_{r}}\\mathbb{r}_{a}\\mathbf{p}_{a_{r}\\leftarrow b_{l}% } \\mathbb{r}_{b}\\mathbf{g}_{b_{l},m_{0}}^{(m)}+(\\mathbf{p}_{-}^{(m)})^{m - b_{l}% } \\mathbb{r}_{b}\\mathbf{p}_{b_{l}\\leftarrow a_{r}}\\mathbb{r}_{a}\\mathbf{g}% _ { a_{r},m_{0}}^{(m)}\\label{gmm}\\\\ &   + ( \\mathbf{p}_{-}^{(m)})^{m - b_{l}}(\\mathbb{r}_{b}+\\mathbb{r}_{b}% \\mathbf{p}_{b_{l}\\leftarrow b_{l}}\\mathbb{r}_{b})\\mathbf{g}_{b_{l},m_{0}% } ^{(m)}+(\\mathbf{p}_{+}^{(m)})^{m - a_{r}}(\\mathbb{r}_{a}+\\mathbb{r}% _ { a}\\mathbf{p}_{a_{r}\\leftarrow a_{r}}\\mathbb{r}_{a})\\mathbf{g}_{a_{r},m_{0}% } ^{(m)}.\\nonumber\\end{aligned}\\ ] ]    these equations can be interpreted in a physically transparent way .",
    "for example , eq .",
    "( [ gba ] ) shows that the local excitation at @xmath248 evolves to the scattering wave at @xmath266 through the following steps : first it is converted by @xmath267 to a zeroth - order partial wave at @xmath242 , next it undergoes renormalized propagation from @xmath242 to @xmath243 , and finally it is converted back to a local excitation and then to the scattering wave at @xmath266 .       of an infinite system containing eight scatterers , where  @xmath31 and @xmath16 are both inside the leads or at the surfaces of the scatterers .",
    "]    by repeatedly using eq .",
    "( [ g_all ] ) , the conversion matrix of a composite scatterer can be obtained analytically as functions of the conversion matrices of the constituent scatterers . in particular",
    ", the four surface elements of the conversion matrix of the composite scatterer can be immediately obtained from those of the constituent scatterers :    [ g_boundary]@xmath268 while the latter can be calculated through recursive techniques [ eqs .",
    "( [ recursive1 ] ) and ( [ recursive2 ] ) ] .",
    "for example , let us consider an infinite layered system with eight scatterers @xmath269 and calculate its gf @xmath162 .",
    "for simplicity we assume that @xmath31 and @xmath16 are both inside the leads or at the surfaces of the scatterers ( see fig .",
    "6 ) , so that @xmath162 is just the @xmath33 element of the conversion matrix @xmath197 of the composite scatterer @xmath270 , i.e. , @xmath271 , and @xmath272 is completely determined by the surface elements of @xmath273 , which are readily obtained through recursive techniques . first",
    ", we use eq .",
    "( [ g_boundary ] ) to calculate the surface elements of @xmath237 , @xmath274 , and @xmath275 for the three composite scatterers @xmath276 , @xmath277 , and @xmath278 .",
    "next we regard @xmath279 as a composite scatterer @xmath38 and calculate @xmath280 ( @xmath243 is the left surface of @xmath38 ) from eq .",
    "( [ gma ] ) .",
    "now the entire system contains two scatterers  @xmath37 and @xmath38 ; thus @xmath272 can be obtained from eq .",
    "( [ gbm ] ) .",
    "in the previous section , we have developed a physically transparent and numerically efficient way to calculate the gf of a general layered system . there the gf is expressed as a matrix , i.e. , in terms of the propagation matrices @xmath281 and conversion matrix @xmath282 of the leads and the conversion matrices @xmath197 of the scatterers . in this section , we give further physical insight into our gf approach by expressing the gf analytically in terms of a generalized scattering matrix , which describes the scattering of both traveling states and evanescent states .",
    "this could be regarded as the inverse of the well - known fisher - lee relations @xcite ( see fig .",
    "1 ) . the key is to express the conversion matrix @xmath197 in terms of a generalized scattering matrix .",
    "let us consider an infinite system consisting of a single scatterer ( with the left surface at @xmath177 and the right surface at @xmath178 )  connected to two semi - infinite leads @xmath51 and @xmath55 ( see fig . [ g_single ] ) .",
    "for a right - going eigenmode @xmath283 incident on the scatterer from the left lead , the resulting scattering state @xmath204 follows from eqs .",
    "( [ phi_s1])-([phi_mr ] ) . using eq .",
    "( [ p_expand ] ) for the propagation matrix , we obtain    @xmath284    where @xmath285 is a generalized transmission amplitude from @xmath286 at the left surface of the scatterer into @xmath148 at the right surface of the scatterer , and @xmath287 is a generalized reflection amplitude from @xmath286 into @xmath151 at the left surface of the scatterer .",
    "similarly , for a left - going incident wave @xmath288 in the right lead , the resulting scattering state @xmath204 follows from eqs .",
    "( [ phi_s2])-([phi_ml ] ) as @xmath289 is a generalized transmission amplitude from @xmath290 at the right surface of the scatterer into @xmath151 at the left surface of the scatterer , and @xmath291 is a generalized reflection amplitude from @xmath290 into @xmath148 at the right surface of the scatterer .",
    "equations ( [ srl])-([srr ] ) define a generalized scattering matrix @xmath13 and express it in terms of the surface elements of the conversion matrix .",
    "they were first derived in the wave function mode matching approach @xcite and its connection to the gf approach was established later @xcite .",
    "they are valid for both traveling modes and evanescent modes . in our gf approach , these expressions have clear physical meanings . taking @xmath292 as an example , @xmath293 converts the incident eigenmode @xmath286 at the left surface of the scatterer back to a local excitation and then to the scattering wave at the right surface of the scatterer",
    ". then the dual vector @xmath294 projects the scattering wave onto the eigenmode @xmath295 [ see eqs .",
    "( 24 ) and ( 25 ) ] .",
    "the transmission and reflection amplitudes of the unitary scattering matrix connecting two traveling eigenmodes are obtained by normalizing with respect to the current @xcite : @xmath296 where @xmath297 for @xmath298 ; @xmath299 for @xmath300 ; @xmath301 , @xmath302 for @xmath303 ; and @xmath304 , @xmath305 for @xmath306 , thus eqs .",
    "( [ srl ] ) and ( [ slr ] ) lead to eqs .",
    "( [ sunitary_rl ] ) and ( [ sunitary_lr ] ) , respectively .      the inverse of eqs .",
    "( [ srl])-([srr ] ) gives the surface elements of @xmath307 in terms of the generalized scattering matrix @xmath308 :    [ g_boundary_exp]@xmath309 these expressions have very clear physical interpretations .",
    "for example , eq .",
    "( [ gb_rl_exp ] ) shows that a local excitation @xmath310 at the left surface of the scatterer evolves to the scattering wave at the right surface of the scatterer through two steps .",
    "first , it evolves to a partial wave @xmath311 , then it is expanded into linear combinations of right - going eigenmodes @xmath312 and each eigenmode transmits across the scatterer to its right surface as    @xmath313    similarly , eq .",
    "( [ gb_ll_exp ] ) shows that a local excitation at the left surface of the scatterer first evolves to a partial wave @xmath314 , then it is expanded as @xmath315 and each eigenmode evolves to a scattering wave:@xmath316 which consists of the incident wave and the reflection wave .",
    "next , we can express other blocks of the gf , i.e. , eqs .",
    "( [ g_all_s])-([g_all_r ] ) with @xmath317 inside the leads , in terms of the generalized scattering matrix :    [ g_all_exp]@xmath318    the above expressions have clear physical meanings .",
    "for example , eq .",
    "( [ grl_exp ] ) shows that a local excitation @xmath319 in the left lead first evolves to a partial wave @xmath320 and then propagates freely to the left surface of the scatterer as @xmath321 .",
    "finally each eigenmode @xmath286 evolves to a transmission wave : @xmath322 as another example , eq .",
    "( [ gll_exp ] ) shows that @xmath323 is the sum of the free gf @xmath324 and the reflection wave contribution , which emerges as follows : the local excitation @xmath163 in the left lead first evolves to a partial wave @xmath320 and then propagates freely to the left surface of the scatterer as @xmath325 .",
    "finally , each mode evolves to a reflection wave : @xmath326 equation ( [ g_all_exp ] ) not only allows us to construct the gf from the generalized scattering matrix , but also reveals the contribution of each individual scattering channels to the gf .      the fisher - lee relations @xcite and its inverse [ eq .",
    "( [ g_all_exp ] ) ] provide a complete one - to - one correspondence between the lattice gf approach and the wave function mode matching approach @xcite to mesoscopic quantum transport ( see fig .",
    "we show that we can construct the gf @xmath34 analytically in terms of a few scattering states on the energy shell @xmath9 .",
    "since the latter can be readily obtained from standard textbook technique and approximation methods ( such as the wkb approximation ) , this provides a convenient way to obtain the gf .",
    "let us introduce @xmath113 _ advanced _",
    "eigenmodes @xmath327 of each lead @xcite,@xmath328{ccc}% \\tilde{k}_{s,\\alpha}\\equiv k_{s,\\alpha } , & |\\tilde{\\phi}_{s,\\alpha}% \\rangle\\equiv|\\phi_{s,\\alpha}\\rangle\\   & ( \\alpha\\in\\text{\\textrm{evanescent}% } ) , \\\\",
    "\\tilde{k}_{s,\\alpha}\\equiv k_{-s,\\alpha } , & |\\tilde{\\phi}_{s,\\alpha}% \\rangle\\equiv|\\phi_{-s,\\alpha}\\rangle & ( \\alpha\\in\\text{\\textrm{traveling } } ) , \\end{array}\\ ] ] and their dual vectors:@xmath329 where @xmath330 $ ] .",
    "the advanced eigenvectors @xmath331 and dual vectors @xmath332 obey exactly the same orthonormal and completeness relations as their retarded counterpart [ eqs . ( [ ortho ] ) and ( [ complete ] ) ] . using @xcite@xmath333 and the completeness relations eq .",
    "( [ complete ] ) , we obtain@xmath334 where the second line holds when all the eigenmodes are traveling modes . here",
    "@xmath43 is the unit cell spacing of the lead and @xmath335 is the generalized group velocity of the eigenmode @xmath336 :  for a traveling mode , it equals the group velocity [ eq .",
    "( [ velocity ] ) ] ; for an evanescent mode , it is defined as @xmath337 note that for an evanescent ( traveling ) mode , @xmath335 depends ( does not depend ) on the choice of the phases of the eigenvectors @xmath338 .    to express the gf in terms of on - shell scattering states , we introduce the eigenmode wave functions    [ bulk_mode_def]@xmath339{ll}% e^{ik_{+,\\alpha}(m - m_{0})a}|\\phi_{+,\\alpha}\\rangle & ( m\\geq m_{0}),\\\\ 0 & ( m < m_{0 } ) , \\end{array } \\right . \\\\",
    "\\begin{array } [ c]{ll}% 0 & ( m\\geq m_{0}),\\\\ e^{ik_{-,\\alpha}(m - m_{0})a}|\\phi_{-,\\alpha}\\rangle & ( m < m_{0 } ) , \\end{array } \\right.\\end{aligned}\\ ] ] for the lead in which @xmath31 locates .",
    "note that so - defined @xmath340 depends on @xmath31 , which is regarded as fixed and hence omitted for brevity .",
    "if there were no scatterers , then @xmath162 would coincide with the free gf of this lead [ eq .",
    "( [ g_infinite ] ) ] , which can be written as    @xmath341    due to the presence of scatterers , each eigenmode @xmath342 evolves to a corresponding scattering state @xmath343 , so replacing @xmath342 in eq .",
    "( [ gfree_spectral_exp ] ) with @xmath343 gives the gf:@xmath344 since the total scattering state @xmath343 can be decomposed into the sum of the incident wave @xmath342 ( which vanishes outside the lead in which @xmath31 locates ) and the outgoing scattering wave @xmath345 ) can also be written as @xmath346 where @xmath175 is nonzero only for @xmath16 in the same lead as @xmath31 .",
    "equation ( [ g_spectral_exp2 ] ) or ( [ g_spectral_exp3 ] ) shows that the gf @xmath347 is essentially certain scattering states @xmath348 ( on the energy shell @xmath9 ) that obey outgoing boundary conditions ; i.e. , they emanate from the on - shell eigenmodes @xmath342 of the lead in which the local excitation occurs . compared with the standard spectral expansion in classic textbook on quantum mechanics @xcite that expresses the gf in terms of all the eigenstates ( both on - shell eigenstates and off - shell ones ) of the system , eq .",
    "( [ g_spectral_exp2 ] ) or ( [ g_spectral_exp3 ] ) deepens our physical understanding about the gf and allows analytical reconstruction of the gf from a few scattering states of the system .    as an example , let us consider an infinite system containing a single scatterer ( fig .",
    "[ g_single ] ) . for @xmath31 in the left lead , the left - going eigenmode @xmath349 is not scattered , so @xmath350 , while the right - going eigenmode @xmath351 produces an outgoing scattering wave@xmath352 substituting into eq .",
    "( [ g_spectral_exp3 ] ) gives eqs .",
    "( [ grl_exp ] ) and ( [ gll_exp ] ) .",
    "similarly , for @xmath31 in the right lead , the right - going eigenmode @xmath353 is not scattered , so @xmath354 , while the left - going eigenmode @xmath355 produces the outgoing wave @xmath356 substituting them into eq .",
    "( [ g_spectral_exp3 ] ) gives eqs .",
    "( [ glr_exp ] ) and ( [ grr_exp ] ) .",
    "here we first exemplify our general results in a 1d chain and then apply the formalism to graphene _",
    "p - n _ junctions described by the tight - binding model .",
    "we consider a 1d chain characterized by one basis state in each unit cell , the unit cell hamiltonian @xmath357 , and the nearest - neighbor hopping @xmath358 . for a given wave vector @xmath107 , eq .",
    "( [ meq1 ] ) can be solved to yield the energy @xmath359 , which is real in two cases : ( 1 ) @xmath360 ; ( 2 ) @xmath361 or @xmath362 with @xmath363 .",
    "the former gives the real energy band@xmath364 while the latter gives the complex energy bands .",
    "for specificity we consider the energy @xmath365 $ ] , so there is one right - going traveling eigenmode @xmath366 with group velocity @xmath367 and one left - going traveling eigenmode @xmath368 with group velocity @xmath369 , where @xmath107 is the positive solution to @xmath370 .",
    "the eigenvectors of the eigenmodes and dual vectors are @xmath371 .",
    "the propagation matrices are @xmath372 , the conversion matrix of the lead is@xmath373 and the free gf of the lead is @xmath374    when the on - site energy of the unit cell @xmath375 of the infinite 1d chain is replaced by @xmath376 , the unit cell @xmath375 becomes a scatterer characterized the conversion matrix@xmath377 or equivalently the transmission amplitude @xmath378 and reflection amplitude @xmath379 .",
    "the gfs of the entire system are given by eqs .",
    "( [ g_all_s ] ) , ( [ g_all_l ] ) , and ( [ g_all_r ] ) as@xmath380 the above results are also consistent with eq .",
    "( [ g_all_exp ] ) .",
    "finally , when the on - site energies of unit cell @xmath375 and unit cell @xmath381 ( @xmath382 ) are both replaced by @xmath376 , then each unit cell becomes a scatterer characterized by the conversion matrix in eq .",
    "( [ cm_example ] ) .",
    "the conversion matrix @xmath383 of the composite scatterer @xmath384 is given by eq .",
    "( [ g_all ] ) .",
    "in particular , the surface elements are obtained from eq .",
    "( [ g_boundary ] ) as@xmath385 from which we can obtain the generalized transmission amplitude across the composite scatterer as @xmath386 and the generalized reflection amplitude as@xmath387       axes when the interface is along the  zigzag direction ( b ) , the armchair direction ( c ) , or a more general direction ( d ) .",
    "the filled dots mark the bravais lattice ( @xmath37 sublattice ) of graphene .",
    "the shaded regions mark the unit cells . in panel",
    "( b ) , the @xmath388 and @xmath389 axes of the cartesian coordinate system are also shown . ]",
    "graphene is a single layer of carbon atoms in a honeycomb lattice that hosts massless dirac fermions @xcite .",
    "one of the unique properties of electrons in graphene is chiral tunneling @xcite : an electron normally incident on a potential barrier will always be perfectly transmitted , independently of its kinetic energy and the height and width of the potential barrier ( for oblique incidence , the transverse momentum serves as a gap - opening mass term , so the transmission is not perfect , and bound states may be created by a 1d potential well @xcite ) . in recent years , the chiral tunneling in graphene _ p - n _ junctions has attracted a lot of attention ( see ref . for a review ) . another interesting phenomenon for electrons in graphene _",
    "p - n _ junctions is the anomalous focusing due to negative refraction , which was initially proposed by veselago for electromagnetic waves @xcite : a spatially diverging pencil of rays is focused to a spatially converging one during the transition from a medium with positive refractive index across a sharp interface into a negative index medium . in 2007 , cheianov _",
    "et al_. @xcite proposed that ballistic graphene _",
    "p - n _ junctions can also exhibit negative refraction and hence focus the electron flow :  in the electron - doped _",
    "n _ ( hole - doped _ p _ ) region , the carrier group velocity is parallel ( anti - parallel ) to its momentum , in analogy to light propagation in a positive ( negative ) refractive index medium .",
    "ever since then , there have been a lot of works on the negative refraction in graphene ( see refs . for examples ) and on the surface of topological insulators @xcite .",
    "recently , the veselago lens effect in graphene was observed experimentally @xcite .    on the theoretical side , most of the previous studies focus on traveling states and are based on the low - energy continuous model , whose validity is limited to the vicinity of the dirac points .",
    "a very recent work @xcite , based on the tight - binding model , calculates numerically the propagation of a wave packet in a large but finite graphene flake to approximate the klein tunneling and caustics of electron waves .",
    "here we apply our general gf formalism to study the chiral tunneling in an infinite graphene _ p - n _ junction and pay special attention to the _ evanescent _ eigenmode .",
    "our approach provides a clear physical picture and allows us to calculate the gf over long distances , so we further perform both analytical analysis and numerical simulations of dual - probe stm measurements .",
    "our results demonstrate the possibility of observing the spatially resolved interference pattern caused by the negative refraction in graphene _",
    "p - n _ junctions and further reveal a few interesting features , such as the distance - independent conductance and its quadratic dependence on the carrier concentration , as opposed to the linear dependence in uniform graphene .",
    "we consider a graphene _ p - n _ junction with an interface that can be either sharp or smooth , as shown in fig .",
    "[ g_pnj](a ) . in the tight - binding model",
    ", the interface could align along different crystalline directions . to provide the simplest description ,",
    "a _ tilted _ coordinate system is usually necessary : we choose one primitive vector @xmath390 ( defined as the @xmath391 axis ) of the bravais lattice of uniform graphene to be parallel to the interface , and choose the @xmath392 axis of our tilted coordinate system to be parallel to the other primitive vector @xmath393 ; i.e. , the two nonorthogonal unit vectors of the tilted coordinate are @xmath394 and @xmath395 , as shown in figs .",
    "[ g_pnj](b)-[g_pnj](d ) for the interface along the zigzag direction , armchair direction , and a more general direction .",
    "this choice of the primitive vectors and the tilted coordinate system ensures that the lattice hamiltonian is invariant upon translation by @xmath396 along the @xmath391 axis , so that the original 2d lattice model can be reduced to a 1d lattice model .      for specificity , we assume that the interface is along the zigzag direction [ fig .",
    "[ g_pnj](c ) ] , where @xmath397 and @xmath398 is the c - c bond length .",
    "the vanishingly small spin - orbit coupling in graphene makes the gf spin - independent , so we neglect the electron spin . in the tight - binding model , each unit cell of graphene",
    "consists of @xmath399 orbitals , i.e. , @xmath400 and @xmath401 for the unit cell @xmath402 , where @xmath16 ( @xmath403 ) is the index along the @xmath392 ( @xmath391 ) axis of the tilted coordinate and @xmath404 labels the sublattice [ see fig .",
    "[ g_pnj](c ) ] .",
    "the hamiltonian @xmath405 is the sum of the uniform part @xmath406 and the _",
    "p - n _ junction potential @xmath407 where @xmath408 ev is the nearest - neighbor hopping constant@xcite .",
    "the junction potential @xmath409 depends arbitrarily on @xmath16 inside the interface ( @xmath184 ) , but equals @xmath410 inside the left lead @xmath51 ( @xmath186 ) and equals @xmath411 inside the right lead @xmath55 ( @xmath188 ) .    due to the invariance of @xmath412 upon translation by @xmath396 along the @xmath391 axis",
    ", the problem can be reduced from 2d to 1d by a fourier transform latexmath:[\\[|k_{y}\\rangle\\equiv\\frac{1}{\\sqrt{n_{y}}}\\sum_{n}e^{ik_{y}{n}a}|n\\rangle , \\ \\ \\",
    "|n\\rangle\\equiv\\frac{1}{\\sqrt{n_{y}}}\\sum_{k_{y}}e^{-ik_{y}{n}a}%    unit cells along the @xmath391 axis . in the new basis ,",
    "the hamiltonian @xmath414 is diagonal with respect to @xmath415 , where @xmath416 describes a 1d lattice with the unit cells labeled by @xmath16 and each unit cell containing @xmath417 basis states @xmath418 .",
    "let us use @xmath419 to denote the bravais vector of the unit cell @xmath402 and use @xmath420 to denote the retarded gf from the unit cell @xmath421 to the unit cell @xmath422 of the original 2d system , which is connected to the retarded gf @xmath423 of the 1d lattice from the unit cell @xmath375 to the unit cell @xmath381 via a fourier transform @xmath424 where @xmath420 and @xmath423 are both @xmath425 matrices .",
    "below we consider fixed @xmath9 and @xmath415 and apply our general results to calculate the gf @xmath426 of the 1d lattice , with @xmath9 and @xmath415 omitted for brevity .",
    "in the 1d lattice , the hopping is uniform : @xmath427 the unit cell hamiltonian @xmath428 is the sum of the unit cell hamiltonian of pristine graphene,@xmath429 and the _ p - n _ junction potential @xmath409 .",
    "the entire infinite system consists of a single scatterer ( @xmath184 ) connected to two semi - infinite leads @xmath51 and @xmath55 [ cf .",
    "[ g_pnj](a ) ] , whose gfs can be constructed from the conversion and propagation matrices of the leads and the conversion matrix @xmath197 of the _ p - n _ interface ( see sec .",
    "iii  and sec .",
    "iv ) .    .",
    "]    the remaining issue is to calculate the eigenmodes of each lead , as characterized by the hopping @xmath27 and the unit cell hamiltonian @xmath430 , where @xmath431 ( left lead ) or @xmath411 ( right lead ) . given a complex wave vector @xmath107 , we can solve the eigenvalue problem eq .",
    "( [ meq1 ] ) and obtain the energy bands of the lead as @xmath432 , where @xmath433 and @xmath434 .",
    "here @xmath435 is real in two cases : ( 1 ) @xmath436 ; ( 2 )  @xmath437 or @xmath438 , where @xmath363 .",
    "the former gives the real energy bands , while the latter gives the complex energy bands , as shown in fig .",
    "[ g_spectra ] .",
    "conversely , given the energy @xmath9 , we can solve eq .",
    "( [ meq1 ] ) and obtain a right - going eigenmode @xmath439 and a left - going eigenmode @xmath440 , where @xmath441 are the two solutions to @xmath442 or equivalently the two intersection points of @xmath443 with the real and complex energy bands of pristine graphene .",
    "when @xmath443 lies in the range of the real energy bands ( dashed black line in fig .",
    "[ g_spectra ] ) , the wave vectors @xmath441 are both real and both eigenmodes are traveling modes .",
    "when @xmath443 lies outside the range of the real energy bands ( dashed gray line in fig .",
    "[ g_spectra ] ) , the wave vectors @xmath444 are complex and both eigenmodes are evanescent . a more convenient method to obtain the eigenmodes is to define @xmath445 and rewrite eq .",
    "( [ meq1 ] ) as @xmath446+tb^{\\ast}=0\\ ] ] with @xmath447 , so that @xmath448 are obtained as the two solutions to this quadratic equation for @xmath449 .",
    "in addition to the two _ normal _ eigenmodes , there are also a pair of _ ideally evanescent _ eigenmodes , including a right - going one @xmath450 , @xmath451^{t}$ ] and a left - going one @xmath452 , @xmath453^{t}$ ] ( see appendix [ append_bulkmode ] ) .",
    "the ideally evanescent eigenmodes do not propagate , so they do not directly contribute to the gf , but their existence does influence the generalized transmission and reflection amplitudes of the normal eigenmodes .    using the eigenmodes , we can calculate the conversion matrix @xmath197 of the _ p - n _ interface using eq .",
    "( [ gg ] ) and then obtain the generalized transmission and reflection amplitudes @xmath454 , @xmath455 , @xmath456 , and @xmath457 of the normal eigenmode from eqs .",
    "( [ srl])-([srr ] ) . for @xmath458 ,",
    "the free gf of the left lead is essentially the sum of the left - going eigenmode @xmath459 and the right - going eigenmode @xmath460 [ cf .",
    "( [ bulk_mode_def ] ) for their definitions]:@xmath461 due to the _ p - n _ interface , the eigenmode @xmath462 produces a reflection wave in the left lead and a transmission wave in the right lead:@xmath463{ll}% e^{ik_{-}^{(l)}(m - m_{l})a}|\\phi_{-}^{(l)}\\rangle\\mathcal{s}^{(ll)}% e^{ik_{+}^{(l)}(m_{l}-m_{0})a } & ( m\\in l),\\\\ e^{ik_{+}^{(r)}(m - m_{r})a}|\\phi_{+}^{(r)}\\rangle\\mathcal{s}^{(rl)}% e^{ik_{+}^{(l)}(m_{l}-m_{0})a } & ( m\\in r ) , \\end{array } \\right.\\ ] ] so the gf from the left lead to the right lead is essentially the transmission wave:@xmath464 while the gf inside the left lead is essentially the sum of the incident eigenmode @xmath465 and the reflection wave:@xmath466      compared with the standard rgf method , the advantages of our gf method lie in its physical transparency and numerical efficiency .",
    "here we demonstrate the first point by using our method to provide a clear physical picture of the anomalous focusing effect @xcite across the graphene _ p - n _ junction described by the tight - binding model .",
    "for this purpose , we first obtain the gf of the 2d graphene _ p - n _ junction from the 1d gfs by a fourier transform [ eq .",
    "( [ g2d_ft ] ) ] .",
    "in particular , the gf from the unit cell @xmath421 in the _",
    "n _ region to the unit cell @xmath467 in the _ p _ region , @xmath468 is essentially the sum of all transmission wave functions@xmath469 which emanates from the incident eigenmode @xmath470 through three steps : propagation to the left interface @xmath471 of the junction with wave vector @xmath472 , transmission across the interface , and propagation from @xmath473 to @xmath474 with wave vector @xmath475 .",
    "here @xmath476 ( @xmath477 ) are the wave vectors of the _ normal _ eigenmodes in the left ( right ) region , i.e. , in the tilted coordinate [ fig .",
    "[ g_pnj](b)]:@xmath478 and @xmath479 ( @xmath480 ) .",
    "the gf from @xmath481 to @xmath474 can be measured as the conductance between one stm probe coupled to @xmath481 and another stm probe coupled to @xmath474 through the landauer - bttiker formula @xcite ( @xmath482 , where the transmission probability @xmath483 .",
    "therefore , eq . ( [ g2d_rl ] ) directly connects the transmission wave function to the experimentally measurable conductance and hence provides a clear physical picture for observing the anomalous focusing in dual - probe stm measurements , and further reveals some interesting effects .",
    "let us consider a sharp , symmetric interface at @xmath484 and @xmath485 . in this case",
    ", the transmission wave simplifies to@xmath486 here @xmath475 , @xmath472 , @xmath487 , and @xmath488 all depend on @xmath415 weakly .",
    "the strongest dependence on @xmath415 comes from the phase factor @xmath489 , which usually oscillates rapidly as a function of @xmath415 when @xmath474 and @xmath481 are far away .",
    "however , when the energy of the incident electron lies midway in between the dirac point of the _",
    "n _  region and the dirac point of the _ p _ region ( i.e. , @xmath490 ) , in the _ cartesian _ coordinate system spanned by the orthogonal unit vectors @xmath491 and @xmath492 [ see fig .",
    "[ g_pnj](b ) ] , the electron - hole symmetry of graphene dictates that the fermi wave vector @xmath472 of the right - going eigenmode in the _",
    "n _ region and the fermi wave vector @xmath475 of the right - going eigenmode in the _ p _ region to have the same component along the _ p - n _ interface ( i.e. , @xmath493 ) , but opposite components perpendicular to the _",
    "p - n _ interface ( i.e. , @xmath494 ) . therefore , when @xmath481 and @xmath474 are mirror symmetric about the _",
    "p - n _ interface , the rapidly oscillating phase factor equals unity for all @xmath415 . in this case , all the transmitted waves have nearly the same phase factor for all @xmath415 , so they contribute constructively to the gf .",
    "this corresponds to electrons flowing out of an electron source at @xmath481 being focused to @xmath474 , i.e. , the anomalous focusing @xcite . according to the landauer - bttiker formula",
    ", the constructive enhancement of the gf could be detected as an enhanced conductance in dual - probe stm measurements .",
    "in addition to locally enhancing the gf , the constructive interference of all the transmission waves also gives rise to two interesting behaviors .",
    "first , the phase factor @xmath495 and hence the transmission wave and the gf remain invariant when @xmath474 and @xmath481 are moved equally but in opposite directions perpendicular to the _ p - n _ interface .",
    "this would give rise to distance - independent conductance .",
    "second , since each transmission wave contributes constructively to the gf , we have @xmath496 density of states on the fermi surface @xmath497 carrier concentration .",
    "thus the locally enhanced conductance should increase quadratically with increasing doping level @xmath498 ( or equivalently the carrier concentration ) , in contrast to the linear dependence in uniform graphene @xcite .",
    "these points will be verified in our subsequent numerical simulations of the dual - probe stm measurements , which provide a useful tool , with high spatial resolution , to measure such local transport properties and detect possible zero - energy bound states of the dirac fermions caused by suitable 2d potential well @xcite .",
    "compared with the standard rgf that treats the _ entire _ central region numerically [ see fig . [",
    "g_setup](a ) for an example ] , an important advantage of our approach is that it fully utilizes the translational invariance of all the periodic subregions [ even if they lie inside the central region , such as the middle lead in fig .",
    "[ g_setup](a ) ] to treat these subregions semianalytically , so that only the _ truly disordered _ subregions need numerical treatment .",
    "therefore , our gf approach is more efficient if the central region contains periodic subregions ; otherwise the two approaches are equally efficient . here",
    "we calculate @xmath499 across a sharp graphene _",
    "p - n _ junction using these two methods to demonstrate their equivalence and highlight the numerical efficiency of our approach . in the calculation , @xmath500 is fixed at a randomly chosen a - sublattice site in the _",
    "n _ region ; @xmath501 is swept over all the b - sublattice sites along the @xmath392 axis from the _",
    "n _ region to the _ p _ region .",
    "the range of the sweep is from @xmath502 m on the left of @xmath500 to @xmath503 m on the right of @xmath500 . for the rgf method , the central region ( infinite along the _",
    "p - n _ interface ) is the smallest region that encloses @xmath500 , @xmath501 , and the _ p - n _ interface . for our gf method , the scatterer region ( infinite along the _ p - n _ interface ) consists of one slice at the _ p - n _ interface . the numerical results from the two approaches always agree with each other up to the machine accuracy .",
    "the time cost , however , differs by two orders of magnitude : with 90 intel cores , the time cost of the standard rgf approach varies from 260 s to 540 s , depending on the position of @xmath500 relative to the _ p - n _ interface , while the time cost of our approach is always less than 3 s. similar speedup is expected in long multilayer structures with sharp interfaces , such as quantum wells , superlattices , or sharp _",
    "p - n - p _ junctions .       incident from the _",
    "n _ region of a sharp ( solid lines and dotted lines ) or 5 nm wide smooth ( dashed lines ) , symmetric ( i.e. , @xmath504 ) graphene _ p - n _ junction . for @xmath505 , the range of @xmath415 in which the eigenmode is traveling is marked by the double arrow . for @xmath506 ,",
    "the range of @xmath415 in which the eigenmode is traveling is much narrower . ]    in the following ( main text and all the figures ) , we always use the c - c bond length of graphene @xmath507 nm as the unit of length and the nearest - neighbor hopping amplitude @xmath508 ev as the unit of energy . for specificity , we focus on symmetric graphene _",
    "p - n _ junctions with @xmath485 .",
    "unless explicitly specified , we always take a typical doping level @xmath505 and set the energy @xmath490 , so we denote @xmath499 by @xmath509 for brevity .    as shown in fig .",
    "[ g_trans ] , at @xmath505 , the tunneling of a right - going traveling eigenmode reproduces the well - known results from the continuum model @xcite , such as the perfect transmission at normal incidence . for the evanescent eigenmode in a sharp _ p - n _ junction , however , @xmath510 shows a peak , indicating enhanced tunneling of certain evanescent states .",
    "when the fermi level is tuned closer to the dirac point , i.e. , for @xmath506 , this enhanced tunneling becomes more pronounced and may be observed by dual - probe stm measurements .",
    "next we visualize the contributions from different scattering channels to the gf and their interference . for a smooth junction , the spatial map of the gf [ fig .",
    "[ gftu12](a ) ] shows imperfect focusing @xcite due to negative refraction across a finite - width _ p - n _ junction .",
    "let us consider @xmath474 and @xmath481 both in the _",
    "n _ region and @xmath474 on the right of @xmath481 ( i.e. , @xmath511 ) ; the gf @xmath512\\langle\\tilde{\\phi}_{-}% ^{(l)}|\\end{aligned}\\ ] ] is essential the sum of all right - going eigenmodes @xmath513 and all reflection waves @xmath514 the incident wave contribution coincides with that of pristine graphene [ fig .",
    "[ gftu12](b ) ] . the reflection wave contribution [ fig .",
    "[ gftu12](c ) ] tends to vanish perpendicularly to the junction interface , indicative of the chiral tunneling .",
    "the interference between the incident and reflection waves [ fig .",
    "[ gftu12](d ) ] is responsible for the interference pattern in the total gf [ fig .",
    "[ gftu12](a ) ] , which would be directly manifested in dual - probe stm measurements .",
    "times @xmath515 ) in a sharp graphene _",
    "p - n _ junction as a function of @xmath516 . here",
    "@xmath517 is fixed at the @xmath37 sublattice of the unit cell @xmath518 and @xmath519 is swept over all the lattice sites ( including both @xmath37 and @xmath38 sublattices ) of the entire structure . ]    finally we simulate dual - probe stm measurements @xcite over the graphene _ p - n _ junction at zero temperature . following refs . , we assume that each probe couples to a single carbon site for simplicity , so the landauer - bttiker formula @xcite gives the interprobe conductance as @xmath520 , where @xmath521 is the gf incorporating the self - energy corrections from the stm probes and @xmath522 are coupling constants between the stm probes and the graphene . usually , @xmath522 have a sensitive exponential dependence on the distance between the stm probe and the graphene sample , but their specific values do not affect the shape of the signal . therefore , following ref . , we always rescale the maximum of @xmath523 to unity . in fig .",
    "[ condmap ] , the real - space conductance map shows a pronounced focusing due to negative refraction @xcite .",
    "other observable electron optics features include the high transparency of the junction near normal incidence , i.e. , chiral tunneling @xcite , and the interference pattern between the incident and reflection waves .",
    "recently , negative refraction in graphene _",
    "p - n _ junctions was observed @xcite , but the measurement via macroscopic contacts only gives a spatially averaged result .",
    "here our simulation shows that dual - probe stm measurements can further provide spatially resolved interference pattern ; i.e. , dual - probe stm could be an ideal experimental technique for studying local transport and quantum interference phenomenon .     between two stm probes at mirror symmetric locations about the junction interface .",
    "( a ) @xmath523 vs. interprobe distance .",
    "( b ) @xmath523 vs. @xmath498 . here",
    ", the width of the smooth junction is 5 nm for ( a ) and inset of ( b ) , and the maximum of @xmath523 is always rescaled to 1 in each panel . ]",
    "now we demonstrate numerically some interesting features of the dual - probe stm measurements in graphene _ p - n _ junctions [ see the physical analysis following eq .",
    "( [ phi_out_2 ] ) ] .",
    "first , when the two probes are mirror symmetric about the junction interface , @xmath523 is nearly independent of the interprobe distance [ fig .",
    "[ depend](a ) ] , in contrast to the @xmath524 decay in uniform graphene @xcite . for a sharp junction",
    ", this behavior can be attributed to the anomalous focusing @xcite .",
    "however , the existence of the same behavior for a smooth junction interface indicates that it has a different physical origin , i.e. , the cancellation of the propagation phases due to the matching of the electron fermi surfaces in the _",
    "n _ region and the hole fermi surface in the _ p _ region @xcite .",
    "the distance - independent response could change qualitatively the spatial scaling of many physical quantities , such as the friedel oscillation induced by an impurity and the carrier - mediated rkky interaction between two localized magnetic moments .",
    "second , the conductance across a sharp junction scales quadratically with the junction potential:@xmath525 [ red line in fig .",
    "[ depend](b ) ] , which differs qualitatively from the linear scaling @xmath526 of uniform graphene @xcite .",
    "when the junction becomes smooth [ inset of fig .",
    "[ depend](b ) ] , the quadratic dependence still persists for small @xmath498 ( electron s fermi wavelength @xmath527 junction width ) , but recovers the linear scaling behavior in uniform graphene for large @xmath498 . this can be attributed to the gradual destruction of the anomalous focusing when the junction width becomes larger than the fermi wavelength @xcite .",
    "we have presented a numerically efficient and physically transparent formalism to calculate and understand the green s function ( gf ) of a general layered structure .",
    "in contrast to the commonly used recursive gf method that directly calculates the gf through the dyson equations , our approach converts the calculation of the gf to the generation and subsequent propagation of a scattering wave function emanating from a local excitation . this viewpoint provides analytical expressions of the gf in terms of a generalized scattering matrix .",
    "this identifies the contributions of individual scattering channels to the gf and hence allows this information to be extracted quantitatively from dual - probe stm experiments .",
    "we further derive an analytical rule to construct the gf of a general layered system , which could significantly reduce the computational time cost and enable quantum transport calculations for large samples .",
    "application of this formalism to simulate the two - dimensional conductance map of a realistic graphene _",
    "p - n _ junction demonstrates the possibility of observing the spatial interference caused by negative refraction and further reveals a few interesting features , such as the distance - independent conductance and its quadratic dependence on the carrier concentration , as opposed to the linear dependence in uniform graphene .",
    "in addition to conventional mesoscopic quantum transport , it would be interesting to apply our gf approach to the investigation other electron interference phenomena , such as the carrier - mediated rkky interaction between local magnetic moments , the impurity - induced friedel oscillation , and using dual - probe stm measurements to detect possible zero - energy bound states in graphene caused by suitable 2d potentials @xcite .",
    "this work was supported by the most of china ( grants no . 2015cb921503 and no .",
    "2014cb848700 ) , the nsfc ( grants no . 11274036 , no . 11322542 , no . 11434010 , and no.11504018 ) , and the nsfc program for `` scientific research center '' ( grant no .",
    "u1530401 ) .",
    "we acknowledge the computational support from the beijing computational science research center ( csrc ) .",
    "when the determinant of the @xmath528  hopping matrix @xmath529 or @xmath27 is nonzero , the @xmath113 eigenmodes can be obtained by letting @xmath445 and rewriting eq .",
    "( [ meq1 ] ) or equivalently @xmath530|\\phi\\rangle\\equiv0\\mathbf{\\ } $ ] as a generalized @xmath531 eigenvalue problem@xmath532 where @xmath169 . in the numerical calculation",
    ", we remove the infinitesimal imaginary part of @xmath533 , i.e. , @xmath534 .",
    "( [ geig ] ) is solved for @xmath113 solutions @xmath535 , where @xmath107 could be either real ( traveling modes )  or complex ( evanescent modes ) .",
    "next the @xmath113 eigenmodes are classified into @xmath108 right - going ones and @xmath108 left - going ones : the former consists of traveling modes ( i.e. , @xmath536 ) with a positive group velocity and evanescent modes decaying exponentially to the right ( i.e. , @xmath114 ) , while the latter consists of traveling modes ( i.e. , @xmath536 ) with a negative group velocity and evanescent modes decaying exponentially to the left ( i.e. , @xmath537 ) .",
    "there is an alternative but less accurate method to calculate and classify the eigenmodes . in this approach ,",
    "the infinitesimal imaginary part of @xmath533 is replaced by a finite but small positive number @xmath538 , i.e. , @xmath539 . then eq . ( [ geig ] )",
    "is solved for the @xmath113 solutions @xmath535 .",
    "next , according to the sign of @xmath540 , the @xmath113 eigenmodes are classified into @xmath108 right - going ones with @xmath114 and @xmath108 left - going ones with @xmath115 . in the limit @xmath541",
    ", the imaginary part @xmath540 may either vanish ( i.e. , traveling modes ) or remain finite ( i.e. , evanescent modes ) .",
    "obviously , the second approach is accurate only in the limit of @xmath541 , so we always use the first approach in the main text .",
    "when the determinant of the hopping matrix @xmath27 vanishes , solving eq .",
    "( [ geig ] ) would give some trivial evanescent eigenmodes .",
    "suppose that @xmath542 out of the @xmath108 eigenvalues of the hopping matrix @xmath529 or @xmath27 are zero , and the corresponding eigenvectors are @xmath543 ( for @xmath544 ) and @xmath545 ( for @xmath27 ) , where @xmath546",
    ". then there would be @xmath547 trivial evanescent eigenmodes , including @xmath108 right - going ones @xmath548 and @xmath542 left - going ones @xmath549 , @xmath550 .",
    "the former correspond to @xmath551 @xmath552 in eq .",
    "( [ se ] ) , while the latter correspond to @xmath553 @xmath554 in eq .",
    "( [ se ] ) . as a result , propagation matrices @xmath555 and @xmath556 both diverge .",
    "however , this does not affect our formulas , which only contain @xmath557 and @xmath558 due to causality .",
    "the only problem is that for a trivial evanescent eigenmode @xmath336 , the generalized group velocity @xmath335 [ eq . ( [ vsa ] ) ] is not well defined .",
    "for example , when @xmath559 and hence @xmath549 , the generalized velocity @xmath560 involves the product of @xmath561 and @xmath562 .",
    "this singular problem can be avoided by adding sufficiently small numbers @xmath563 to @xmath27 and @xmath564 to make their determinant nonzero and take the limit @xmath565 at the end of the calculation .",
    "taking the graphene junction as an example , the 1d left or right lead is characterized by the hopping matrix @xmath27 and unit cell hamiltonian @xmath566 , where @xmath431 ( left lead ) or @xmath411 ( right lead ) and @xmath567 , @xmath27 are given by eqs .",
    "( [ t ] ) and ( [ h0 ] ) . here",
    "the hopping matrix @xmath27 has one zero eigenvalue with eigenvector @xmath568^{t}$ ] , while @xmath544 has one zero eigenvalue with eigenvector @xmath451^{t}$ ] .",
    "this gives rise to two trivial evanescent eigenmodes : the right - going one @xmath569 and the left - going one @xmath570 , @xmath571 , for which the generalized group velocities @xmath572 are not well defined . to cure this problem , we add a small number @xmath573 to the off - diagonal of the hopping matrix , so that @xmath27 and @xmath544 become @xmath574 then using the first - order perturbation theory , we obtain @xmath575 substituting into eq .",
    "( [ vsa ] ) and taking the limit @xmath576 gives @xmath577",
    "let us consider a scatterer connected to a semi - infinite left lead ( whose conversion matrix is @xmath282 ) and prove that a right - going incident partial wave @xmath207 is equivalent to a local excitation @xmath578 ( @xmath177 is the left surface of the scatterer ) , in the sense that they produce the same scattering state at @xmath165 . for this purpose , we use @xmath204 for the conventional scattering state emanating from the incident wave @xmath207 and @xmath105 for the scattering state emanating from the local excitation @xmath158 at @xmath31 . we notice that @xmath204 and @xmath105 obey the same schrdinger equation for @xmath579 , and the same uniform schrdinger equation @xmath580 for @xmath581 .",
    "the difference lies at @xmath582 : @xmath583 and the boundary conditions : @xmath105 should be finite at @xmath584 , while the right - going part of @xmath204 should equal the incident wave on the left of the scatterer , i.e. , @xmath585 for @xmath586 .",
    "the former gives @xmath587 , while the latter gives @xmath588 using these relations to eliminate @xmath589 and @xmath590 from the equations for @xmath105 and @xmath591 at @xmath582 , and using eq .",
    "( [ equality ] ) , we see that they become identical and contains the same source @xmath319 .",
    "therefore , @xmath592 and @xmath593 obeys exactly the same set of closed equations and natural boundary conditions ( i.e. , they should be finite for @xmath594 ) ; thus they are identical . applying this equivalence principle to a scatterer connected to a semi - infinite left lead @xmath51 and",
    "a semi - infinite right lead @xmath55 gives eqs .",
    "( [ phi_s1 ] ) and ( [ phi_s2 ] ) of the main text .",
    "here we give a few simple examples for the gf of an infinite ( or semi - infinite ) system containing a single scatterer . as the first example",
    ", a semi - infinite lead ( with unit cell hamiltonian @xmath99 , hopping @xmath27 , and propagation matrices @xmath281 ) consisting of the unit cells @xmath52 can be regarded as a single - unit - cell scatterer at @xmath92 connected to a semi - infinite left lead .",
    "then the conversion matrix of this scatterer is @xmath595 where we have used eq .",
    "( [ equality ] ) in the second step .",
    "the gf of the entire system is@xmath596 taking @xmath597 gives @xmath598 . by using eqs .",
    "( [ gl ] ) and ( [ g00 ] ) , we have @xmath599 and hence recover the results by sanvito _",
    "et al_. @xcite : @xmath600 .    as the second example",
    ", a semi - infinite lead consisting of the unit cells @xmath235 can be regarded as a single - unit - cell scatterer at @xmath92 connected to a semi - infinite right lead .",
    "then the conversion matrix of this scatterer is@xmath601 the gf of the entire system is@xmath602 where @xmath603 .",
    "taking @xmath597 gives @xmath604 .",
    "the third example is an interface at @xmath92 ( with unit cell hamiltonian @xmath605 ) connected to two semi - infinite leads @xmath51 and @xmath55 . in this case",
    "the conversion matrix of the interface is @xmath606 where @xmath180 ( @xmath182 ) is the nearest - neighbor hopping in the left ( right ) lead .",
    "the gfs of the entire system are given by@xmath607\\mathbf{g}_{0,m_{0}}^{(l)},\\\\ \\mathbf{g}_{m\\geq0,m_{0}\\geq0 }   &   = \\mathbf{g}_{m , m_{0}}^{(r)}+(\\mathbf{p}% _ { + } ^{(r)})^{m}[\\mathbb{g}^{(\\mathrm{i})}(\\mathbf{g}^{(r)})^{-1}% -\\mathbf{i}]\\mathbf{g}_{0,m_{0}}^{(r)}.\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> the single - particle green s function ( gf ) of mesoscopic structures plays a central role in mesoscopic quantum transport . </S>",
    "<S> the recursive gf technique is a standard tool to compute this quantity numerically , but it lacks physical transparency and is limited to relatively small systems . here </S>",
    "<S> we present a numerically efficient and physically transparent gf formalism for a general layered structure . </S>",
    "<S> in contrast to the recursive gf that directly calculates the gf through the dyson equations , our approach converts the calculation of the gf to the generation and subsequent propagation of a scattering wave function emanating from a local excitation . </S>",
    "<S> this viewpoint not only allows us to reproduce existing results in a concise and physically intuitive manner , but also provides analytical expressions of the gf in terms of a generalized scattering matrix . </S>",
    "<S> this identifies the contributions from each individual scattering channel to the gf and hence allows this information to be extracted quantitatively from dual - probe stm experiments . </S>",
    "<S> the simplicity and physical transparency of the formalism further allows us to treat the multiple reflection analytically and derive an analytical rule to construct the gf of a general layered system . </S>",
    "<S> this could significantly reduce the computational time and enable quantum transport calculations for large samples . </S>",
    "<S> we apply this formalism to perform both analytical analysis and numerical simulation for the two - dimensional conductance map of a realistic graphene _ </S>",
    "<S> p - n _ junction . </S>",
    "<S> the results demonstrate the possibility of observing the spatially - resolved interference pattern caused by negative refraction and further reveal a few interesting features , such as the distance - independent conductance and its quadratic dependence on the carrier concentration , as opposed to the linear dependence in uniform graphene . </S>"
  ]
}