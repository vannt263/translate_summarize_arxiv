{
  "article_text": [
    "the mass function @xmath0 in cosmology is defined to give the comoving number density of dark halos with mass @xmath1 at redshift @xmath2 .",
    "it provides a useful analytical tool to understand the formation and evolution of the large - scale structure in the universe .",
    "the excursion set approach to the mass function provides the most direct and solid way to count the number density of dark halos .",
    "bond et al .",
    "( 1991 ) applied for the first time the excursion set theory to the gaussian random density field , and recovered the popular press - schechter mass function ( press & schechter 1974 , hereafter ps ) with a correct normalization factor of @xmath3 .",
    "sheth , mo , & tormen ( 1999 , hereafter smt ) suggested an extension of the excursion set approach to a nonspherical dynamical model .",
    "although the ps mass function works fairly well at the high - mass section , recent hight - resolution n - body simulations have yielded less intermediate - mass and more low - mass halos than the ps prediction @xcite .",
    "it has been suspected that this discrepancy of the numerical mass functions with the ps prediction must be due to the departure of the true dynamics from the idealistic spherical one @xcite .",
    "the work of smt was in fact so motivated , attempting to justify the empirical mass function derived by sheth & tormen ( 1999 , hereafter st ) .",
    "indeed , current numerical results from high - resolution n - body simulations agree with the st formula much better than the standard ps mass function @xcite .",
    "yet it is hard to claim that the st mass function is anything beyond a phenomenological fitting formula .",
    "although smt claimed that the excursion set approach associated with their nonspherical collapse condition does produce the st mass function to excellent approximation , a more careful analysis of the nonspherical collapse condition from a different perspective ought to be encouraged .",
    "in particular , the perspective of symmetry and smoothness of the collapse condition in the @xmath4-space ( see @xmath5 ) should be seriously considered , and can serve as a guiding principle in constraining the correct collapse condition .    in this paper , we investigate the idea of smt in a more sophisticated manner to find a physically motivated ellipsoidal collapse condition which yields almost the same st mass function .",
    "the new collapse condition demonstrates in a clear - cut manner how the initial nonspherical properties of proto - halos affect the gravitational process , yielding the halo abundance substantially deviating from the ps predictions based on the spherical model .",
    "we use the following five hypotheses to evaluate the mass function : 1 ) all cold dark matter elements eventually collapse into gravitationally bound halos by self similar clustering .",
    "2 ) the collaspe process is so rapid that the violent relaxation may completely erase the internal structure of the bound region .",
    "3 ) the collapse condition can be expressed by the linearly extrapolated parameters of proto - halos .",
    "4 ) the rms fluctuations @xmath6 of the linear density field smoothed over a mass scale of @xmath1 at the moment of collapse determines the mass of the bound halo .",
    "5 ) the collapse occurs in an ellipsoidal way , for which the necessary and sufficient collapse condition is a function of the three eigenvalues , @xmath7 of the initial deformation tensor ( defined as the second derivative of the linear gravitational potential ) .",
    "note that the first four hypotheses are borrowed from the standard ps mass function theory .",
    "the discrepancy from the ps theory arises in the fifth hypothesis . for the spherical collapse model on which the ps theory is based ,",
    "the evolution of an initial spherical overdense region is governed by the self gravity alone , so the collapse condition for the given region to form dark halos depends solely on its local average overdensity @xmath8 ( @xmath9 .",
    "@xmath10 : the mean mass density ) . while for the nonspherical collapse model , not only the self gravity but also the tidal interaction with the surrounding matter acts on the given region",
    ". therefore , the evolution of the initial density inhomogeneities can be no longer described by the local average density alone once the simple constraint of the spherical symmetry on the initial region is released .",
    "it must be described by other parameters quantifying both the intrinsic self gravity and the extrinsic tidal coupling with the neighbor mass distribution .",
    "it is worth mentioning here that it is this tidal interaction which causes the rotational motion of dark halos .",
    "that is , the generation of the angular momentum of dark halos is a unique consequence of the nonspherical collapse .",
    "given the third hypothesis , one can expect that the linear parameters to determine the _ sufficient _ nonspherical collapse condition may be the three eigenvalues of the tidal shear tensor ( i.e. , the deformation tensor ) , suggesting the fifth hypothesis .",
    "below we also explain why all the three eigenvalues determine the _ necessary _ nonspherical collapse condition .",
    "our fifth hypothesis is qualitatively consistent with the peak - patch theory for the ellipsoidal dynamics proposed by bond & myers ( 1996 ) .",
    "smt followed the peak - patch prescriptions to determine their nonspherical collapse condition .",
    "however , we have noted that the collapse condition ( eq . [ 3 ] in smt ) obtained from the peak - patch picture has some _ unphysical _ drawbacks . in our model , instead of relying on the peak - patch prescriptions fully , we suggest an original idea of the _ logical generalization _ of the spherical collapse condition into the nonspherical one ( see @xmath11 ) .",
    "the above set of five basic hypotheses leads us to view the whole halo - formation process as a diffusion - like process of random fields in the three dimensional functional space spanned by the three eigenvalues @xmath12 of the random deformation tensor .",
    "note that here we use an _ unordered _ set of eigenvalues rather than the ordered one .",
    "thus , all three eigenvalues are equivalent .",
    "let us consider a large - scale smoothed initial region where the local eigenvalues of the deformation tensor are given by @xmath13 , and the rms linear density fluctuations has a small initial value of @xmath14 with the corresponding mass scale of @xmath15 .",
    "as one zooms in to look into the details , the rms fluctuations increases and the probability distribution of @xmath4 @xcite becomes broader , making the low - mass bound objects easier to collapse .",
    "when @xmath4 of a given rms fluctuations @xmath16 just satisfies the collapse condition , this region will collapse into an _ isolated bound halo _ with mass @xmath1 , according to the fourth hypothesis .",
    "the isolated bound halo refers to the halo which has just collapsed with no larger halo enclosing it .    since the change of @xmath4 as the smoothing scale decreases is random",
    ", one can look upon this change of the smoothing scale as special kind of random walk of a particle in the three dimensional @xmath4-space .",
    "a particle corresponds to a bound region , and its position in the @xmath4-space is the local eigenvalues @xmath13 of the deformation tensor defined at the region .",
    "each random step is assumed to be independent , which amounts to choosing a sharp k - space filter to smooth out the density field @xcite .",
    "this random walk process is restricted within some absorbing boundary which corresponds to the collapse condition .",
    "the number of random - walk steps before the particle first hits the absorbing boundary is directly proportional to @xmath16 , a decreasing function of m. thus , those particles that first hit the absorbing boundary in a small number of steps correspond to the high - mass halos while the opposite cases correspond to the low - mass halos .",
    "the shape of the absorbing boundary is determined by the collapse condition which is in turn governed by the underlying dynamics . for the case of the top - hat spherical model ,",
    "the collapse condition is given by @xmath17 where @xmath18 is the density threshold .",
    "the original top - hat spherical dynamics gives @xmath19 for a flat universe @xcite .",
    "however , the more realistic treatment of spherical collapse given the rapid virialization due to the growth of small - scale inhomogeneities gives @xmath20 @xcite . in our approach",
    ", we use this realistic lowered value of @xmath18 .    since @xmath21 , the boundary for the spherical model is an infinite flat plane ( the ps plane ) described by the equation of @xmath22 in the @xmath4 space .",
    "note that the ps plane is smooth ( i.e. , continuous and differentiable everywhere ) and also symmetric about the line of @xmath23 .",
    "the latter property yields a rotationally invariant boundary , that is , the boundary remains unchanged under the exchange of the three variables ( @xmath24 ) .",
    "we take these two important properties of the ps plane as the general properties that a physical collapse condition must satisfy .",
    "given that the spherical collapse is a special case of the ellipsoidal one satisfying @xmath23 , we expect that a physically meaningful ellipsoidal collapse condition must possess these two properties just as the spherical one does .",
    "the rotational invariance implies the isotropic nature of the initial matter distribution , while the smoothness implies the absence of any inherent singularity in the gravitational collapse as a general physical process .",
    "note also here that these two required properties of the absorbing boundary , the _ rotational invariance _ and the _ smoothness _ , explains why the sufficient and necessary nonspherical collapse condition must be expressed in terms of all the three eigenvalues . if the absorbing boundary is expressed as a function of only one or two eigenvalues among the three , then either the rotational invariance or the smoothness must break in the @xmath4-space .    at any rate ,",
    "it has long been pointed out that the spherical collapse condition is far from being realistic , and the true gravitational process must be ellipsoidal @xcite .",
    "consequently the collapse condition can not be expressed simply just by the density alone .",
    "unfortunately , there has been no simple ellipsoidal dynamical model that can describe the nonlinear regime adequately well , whereas the simplest top - hat spherical model can trace all stages of halo formation even into the highly nonlinear regime after the moment of turn - around .",
    "the complicated nature of the tidal coupling with the surrounding matter in the nonlinear regime makes it extremely difficult to construct an universal ellipsoidal model from the first principles .",
    "nonetheless , some qualitative considerations on the nature of ellipsoidal dynamics can give us a hint for the collapse condition .",
    "the spherical collapse model is in fact a special case of the ellipsoidal one , satisfying @xmath23 .",
    "if the gravitational collapse of a bound region were spherical , then the differences between the three eigenvalues of a bound region , @xmath25 would remain zero during the collapse process .",
    "it implies that the the nonzero values of @xmath25 should quantify the _ nonspherical _ aspects of the true collapse . using the given probability density distributions of each @xmath26 s ( see appendix a in lee & shandarin 1998 )",
    ", one can easily show that @xmath27 on average .",
    "thus , as @xmath28 increases , the average @xmath25 of a bound region also increases in proportional to @xmath28 . or , as the mass scale decreases , the degree to which the collapse deviates from the spherical model ( the _ nonsphericality _ ) increases .",
    "this explains why the ps mass function based on the top - hat spherical model works fairly well at the high - mass section where the nonsphericality is small @xcite , while it fails at the low - mass section where the nonsphericality is high .",
    "this idea can be quantitatively embodied by the @xmath4-space diffusion - like process .",
    "as mentioned above , the spherical collapse condition is represented by an absorbing boundary of an infinite flat plane in the @xmath4-space , with its distance to the origin being @xmath18 .",
    "one may expect that the shape of the boundary for the nonspherical collapse should also be a smooth curved surface @xcite that coincides with the ps plane at its apex , where @xmath23 . the underlying logic is as follows :",
    "the distance from the ps plane to the nonspherical collapse boundary must provide a measure of the nonsphericality .",
    "the nonsphericality of the system is small at the high - mass section as argued above .",
    "in fact bernardeau ( 1994 ) has shown semi - analytically that the evolution of rare events ( very high - mass halos ) is quasi - spherical .",
    "the formation of a high - mass halo therefore corresponds to the particles that reach the boundary near the @xmath23 axis in only a small number of random - walk steps , and it suggests that the nonspherical collapse boundary should be smoothly tangential to the ps plane at the apex of that axis .",
    "distant from the apex , the nonspherical collapse boundary should increasingly deviate from the ps plane .",
    "this is because the distant part of the boundary can be reached only by those particles that have undergone a large number of random steps , and they correspond to the low - mass halos , for which the nonsphericality is dominant . as the nonspherical collapse boundary should also possess the smoothness and rotational invariance as the ps boundary does , the analytic equation for this rotationally symmetric smooth surface can be constructed as follows . on the curved boundary ,",
    "the ratio of @xmath29 ) to @xmath18 equals unity only at the apex , @xmath30 .",
    "this ratio becomes slightly larger than unity near @xmath30 , and increasingly exceeds unity at distant points from @xmath30 .",
    "thus , the most general equation of the nonspherical collapse boundary can be written as @xmath31 , where @xmath32.\\ ] ] and @xmath33 . here",
    "the form of @xmath34 does guarantee the smoothness and rotational invariance of @xmath35 .",
    "it is worth noting that the variable @xmath34 is proportional to the angular momentum square of the bound region provided that the principal axes of the inertia and the deformation tensors of the region are not perfectly aligned with each other @xcite .",
    "thus , the above general equation for the nonspherical collapse accounts for the generation of the rotational motion of dark halos .",
    "specifically , we propose the following boundary equation for the nonspherical collapse : @xmath36 where @xmath37 is a positive constant to be determined by fitting to the st mass function . here",
    "note that the height of our absorbing boundary @xmath35 scales like @xmath38 rather than @xmath34 .",
    "it guarantees the flatter bottom of the absorbing boundary , making it closer to the ps boundary around the apex , @xmath30 ( @xmath39 ) .",
    "since the random walks representing the nonspherical collapse tend to avoid the axes of symmetry where any pair of the eigenvalues are the same @xcite , the walks quicly diffuse away from @xmath40 , never hitting the bottom of the absorbing boundary at @xmath40 . therefore in order to reproduce a mass function quite similar to the ps one at the high - mass section , one needs an absorbing boundary with a flat bottom .",
    "we realize this flat - bottom absorbing boundary by expressing @xmath35 scaled as @xmath38 rather than @xmath34 .",
    "in this section , we describe the numerical algorithm for the monte - carlo simulation of the random - walk process in @xmath4-space given the above absorbing boundary ( eq . [ 2 ] ) .",
    "this algorithm basically represents our nonspherical collapse of bound regions into dark halos out of the initial gaussian density field , which is in fact closely related to , but simpler than the ellipsoidal collapse model developed by eisenstein & loeb ( 1995 ) .    to simulate the initial random deformation tensor where the rms density fluctuations is @xmath41 , we first generate six independent gaussian variables with the dispersion of @xmath42 , say @xmath43 .",
    "the symmetric deformation tensor @xmath44 can be constructed by the linear transformation of @xmath45 such that @xmath46 one can show easily that this linear transformation does satisfy the correlations of the deformation tensor @xcite .    using the similarity transformation , we diagonalize the deformation tensor to find the three eigenvalues .",
    "we then check whether the set of the three eigenvalues crosses the boundary or not .",
    "if not , we generate a new six dimensional gaussian random vector with the same dispersion of @xmath42 , and add it to the previous random vector . here the new random vector is assumed to be uncorrelated with the previous random vector , which is consistent with the use of the sharp k - space filter .    using this accumulated random vector , we repeat the above process : linear transformation into the deformation tensor , similarity transformation into a diagonal matrix to get the eigenvalues , and finally checking the boundary crossing .",
    "this process is repeated until the first crossing over the boundary occurs .",
    "the number of the repetition ( @xmath47 ) is proportional to the square of @xmath16 at the moment of the halo formation such that @xmath48 .",
    "after a particle crosses the boundary , we re - starts the whole process with a new particle .",
    "we have simulated a ensemble of @xmath49 particles , and calculated the distribution of the number of particles which first cross the boundary at a range of @xmath50 $ ] .",
    "the results are plotted in figure 1 .",
    "this distribution is nothing but the differential volume fraction @xmath51 , occupied by the halos with the corresponding mass of @xmath1 , directly proportional to the mass function by @xmath52d{\\rm ln}m / d\\sigma$ ] .    to show the robustness of our approach",
    ", we also simulated the ps differential volume fraction by the above monte carlo method with the flat boundary .",
    "the triangle dots represent the resulting ps differential volume fraction while the dashed line is the analytic standard ps formula .",
    "the numerical and analytical ps mass function agree with each other perfectly , which guarantees the robustness of the diffusion approach to the mass function as well as the accuracy of our numerical scheme .",
    "the solid line is the st formula which has been proved to fit the currently available n - body results of high resolution very well @xcite , while the square dots represent our simulation results with the choice of the best - fit parameter of @xmath53 ( and we used the realistic lowered value of @xmath54 as mentioned in @xmath5 ) .",
    "here we used the st formula as our fitting standard to find this value of @xmath37 .",
    "of course , fine tuning of @xmath37 would be necessary if one is to use another fitting standard .",
    "as one can see , our result agrees strikingly well with the st formula , suggesting that our collapse condition can replace the ps spherical collapse condition in many interesting applications of the mass function .",
    "motivated by the inspiring practical success of the st mass function in recent n - body tests @xcite , we have attempted here to provide a more sophisticated and robust way to determine the nonspherical collapse condition which produces the st mass function to good approximation .",
    "in fact , various nonspherical approaches to the mass function were already attempted by several authors in the past decades @xcite .",
    "strictly speaking , however , their approaches were not appropriate in the sense that they all used the original ps formalism which always yields ill - normalized mass functions .",
    "although the ps mass function can be properly normalized by multiplying a constant normalization factor of @xmath3 @xcite , the mass function from a nonspherical model can no longer be corrected just by a constant normalization factor .",
    "the normalization factor is scale - dependent in any nonspherical dynamical model , due to the complicated pattern of the scale - dependent occurrence of the cloud - in - clouds . for a detailed description of the cloud - in - cloud problem , see bond et al .",
    "( 1991 ) , jedamzik ( 1995 ) , and lee & shandarin ( 1998 ) .",
    "due to this scale - dependent manner of the cloud - in - cloud occurrence in the nonspherical models , the shape of the mass function could be very different from the one obtained without considering the cloud - in - cloud occurrence correctly .",
    "for example , we have tested by our diffusion algorithm the condition that the bound objects form at the local maxima of the smallest eigenfield of the deformation tensor .",
    "we found that the resulting mass function deviates considerably from the one originally given by lee & shandarin ( 1998 ) who had used a constant normalization factor of @xmath55 .    in order to correctly solve the normalization problem",
    ", one should not rely on the original ps formalism .",
    "the only viable alternative for the evaluation of the mass function without extra efforts of concerning about the normalization is the excursion set approach , or equivalently the diffusion approach .",
    "smt employed the excursion set approach to justify the st mass function in terms of the nonspherical collapse condition .",
    "they related the nonspherical collapse condition with a moving barrier and approximated its shape with the help of the peak - patch prescriptions for the ellipsoidal dynamics @xcite .",
    "their moving barrier ( eq . [ 3 ] in smt ) is similar to our curved boundary in concept , but differs significantly in practice since the smt boundary is not a rotationally invariant smooth surface in the @xmath4-space and has kinks . given equation ( 3 ) in smt , one can see that the kinks arise at @xmath56 ( @xmath57 : the prolateness of the given ellipsoidal region , see bardeen et al .",
    "1986 ) . as mentioned in smt , however , @xmath56 on average in a gaussian random field .",
    "thus , the kinks of the smt boundary occur in so high probability regions that one may not ignore the presence of those kinks .",
    "here we did not attempt to provide a better ellipsoidal dynamical model to describe the gravitational collapse process .",
    "rather we retained the general framework of the peak - patch theory and try to improve the smt boundary collapse condition into a more physically meaningful one by the logical generalization of the spherical collapse model .",
    "two superior features of our collapse condition can be summarized as follows : first , it has a sound physical meaning , in that equation ( 2 ) is expressed in terms of only one single variable @xmath34 which is in fact directly proportional to the halo angular momentum square @xcite .",
    "any physically meaningful nonspherical collapse condition should be expressed in terms of such quantities as obviously represent the nonshperical nature of halo formation . as mentioned in @xmath58 ,",
    "the rotational motion of dark halos is a unique consequence of the nonspherical collapse . in this respect",
    ", our nonspherical collapse condition shows explicitly and quantitatively how the nonspherical gravitational collapse leads to the acquisition of the angular momentum of dark halos .",
    "second it has the desirable analytical property , _ rotational invariance and smoothness_. this feature of our collapse condition , in common with the ps collapse condition , will make it easy to extend various important cosmological issues , such as the halo merging , the light - to - mass bias , and so on , from the spherical dynamics to a nonspherical one .",
    "we thank z. fan for helpful discussions and useful comments .",
    "we also thank our referee , r. sheth , who helped us to improve the original manuscript .",
    "this work has been supported by the taida - asiaa cospa project .",
    "t. chiueh acknowledges the partial support from the national science council of taiwan under the grant : nsc89 - 2112-m-002 - 065 .",
    "audit , e. , teyssier , r. , & alimi , j. m. 1997 , , 325 , 439 bardeen , j. m. , bond , j. r. , kaiser , n. , & szalay , a. s. 1986 , , 304 , 15 bernardeau , f. 1994 , , 427 , 51 bond , j. r. , cole , s. , efstathiou , g. , & kaiser , n. 1991 , , 379 , 440 bond , j. r. , & myers , s. t. 1996 , , 103 , 1 catelan , p. , & theuns , t. 1996 , , 282 , 436 doroshkevich , a. g. 1970 , astrofizika , 6 , 581 eisenstein , d. j. , & loeb , a. 1995 , , 439 , 520 governato , f. , babul , a. , guinn , t. , tozzi , p , baugh , c. m. , katz , n. & lake , g. 1999 , , 307 , 949 heavens , a. f. , & peacock , j. a. 1988 , , 232 , 339 jedamzik , k. 1995 , , 448 , 1 jenkins , a. , frenk , c. s. , white , s. d. m. , colberg , j. m. , cole , s. , evrard , a. e. , & yoshida , n. 2000 , preprint ( astro - ph/0005260 ) lacey , c. & cole , s. 1994 , , 271 , 676 lee , j. & shandarin , s. f. 1998 , , 500 , 14 monaco , p. 1995",
    ", , 447 , 23 peacock , j. a. , & heavens , a. f. 1990 , , 243 , 133 peebles , p. j. e. 1993 , principles of physical cosmology ( princeton : princeton univ .",
    "press ) press , w. h. , & schechter , p. 1974 , , 187 , 425 kuhlman , b. , melott , a. l. , & shandarin , s. f. 1996 , , 470 , l41 shaprio , p. r. , iliev , i. , & raga , a. c. 1999 , , 307 , 203 sheth , r. k. , & tormen , g. 1999 , , 308 , 119 sheth , r. k. , mo , h. j. , & tormen , g. 1999 , preprint ( astro - ph/9907024 ) tormen , g. 1998 , , 297 , 648"
  ],
  "abstract_text": [
    "<S> we present a new collapse condition to describe the formation of dark halos via nonspherical gravitational clustering . </S>",
    "<S> this new nonspherical collapse condition is obtained by the logical generalization of the spherical model to the nonspherical one . by solving a diffusion - like random matrix equation with the help of the monte carlo method , </S>",
    "<S> we show that this nonspherical collapse condition yields the mass function derived by sheth & tormen ( 1999 ) which has been shown to be in excellent agreement with the recent n - body results of high resolution . </S>",
    "<S> we expect that this nonspherical collapse condition might provide us a deeper insight into the structure formation , and suggest that it should be widely applied to various cosmological issues such as the galaxy merging history , the galaxy bias , and so forth . </S>"
  ]
}