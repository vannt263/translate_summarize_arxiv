{
  "article_text": [
    "predicting observables from a combination of scientific ( knowledge - based ) and statistical ( data - based ) information is at the heart of any parameteric property model applied in computational science.@xcite in chemical physics , property models are applied whenever it is unfeasible or too demanding to calculate a _ target _",
    "observable for a desired range of chemical systems with benchmark methods . to resolve this issue , the target observable",
    "is represented by a property model , which is a parametric representation of the former .",
    "the statistical variables of a property model ( _ parameters _ ) represent its unknown part , and their optimization ( _ calibration _ of the model ) requires both a reference data set and an objective , e.g. , minimization of the mean squared error .",
    "the reference data set comprises pairs of values for ( a ) the target observable ( obtained from measurements or benchmark results ) and ( b ) the corresponding _ input _ variable . the input variable can represent the target observable itself or another physically motivated variable .",
    "it is also possible that the input variable is a vectorial quantity representing , e.g. , nuclear coordinates .",
    "the purpose of calibration is the estimation of parameter values that maximize the transferability of a property model to measurements or benchmark results of its target observable not included in the reference data set . in the field - specific literature ,",
    "there are numerous applications of property models , e.g. , for the calibration of force fields@xcite , exchange  correlation density functionals@xcite , dispersion - corrected potentials for density functional theory@xcite , semi - empirical electronic structure methods@xcite , vibrational frequencies@xcite , kinetic models@xcite , ionization potentials@xcite , thermochemical properties @xcite , properties of semi - conductors and insulators@xcite , linear free energy relationships@xcite , or melting point models@xcite , to name only a few .",
    "concomitant with the maximization of transferability is the assessment of model prediction uncertainty ( mpu ) , i.e. , the expected random deviation of a prediction from a measurement or benchmark result .",
    "mpu can be estimated analytically ( or at least iteratively ) if certain parametric assumptions are made on the population distribution underlying the reference data set . for a continuous variable ,",
    "the most likely of all other parametric population distributions is the normal distribution , which is parameterized by mean and variance.@xcite in that case , the evidence approximation employed in bayesian inference is an efficient iterative approach to estimate mpu,@xcite which we will also address in this paper . generally ,",
    "the more input  target pairs are included in the reference data set , the more reliable it does represent the underlying population distribution , and the less ambiguous is the selection of an adequate property model .",
    "consequently , mpu estimation becomes increasingly reliable for an increasing number of data points given a reasonable property model and a specific input domain ( the interval of the input variable studied ) .",
    "however , in the usual case of a limited number of data points , mpu estimation is error - prone and requires a thorough analysis of parametric population assumptions .",
    "moreover , the property model under consideration may be inadequate such that systematic deviations of predictions from measurements or benchmark results are observed.@xcite another source of systematic errors are inconsistent data ( e.g. , outliers).@xcite    here , we study nonparametric bootstrapping introduced by efron@xcite , a statistical inference method that meets the challenge of unknown population distributions by sampling from available data .",
    "this approach produces an _ empirical _ population distribution , where the reference data set itself represents the underlying population . by drawing samples from the empirical population",
    "distribution , uncertainty in the parameters can be inferred , which is an essential part in mpu estimation and , hence , for the assessment of transferability .",
    "we apply nonparametric bootstrapping to estimate the uncertainty of predictions of the @xmath0fe mssbauer _ isomer shift _",
    "( target observable ) inferred from a linear property model .",
    "the corresponding input variable is the contact electron density at the iron nucleus of a molecular iron compound , which is obtained from calculations based on density functional theory . for 44 molecular iron compounds , we generate input data with 12 exchange ",
    "correlation density functionals across jacob s ladder ( pwlda , bp86 , blyp , pw91 , pbe , m06-l , tpss , b3lyp , b3pw91 , pbe0 , m06 , tpssh ) .",
    "we examine ( a ) systematic errors in both the reference data and the property model , ( b ) the effect of experimental uncertainty on the model parameters , ( c ) the reliability of different performance measures ( e.g. , the coefficient of correlation , @xmath2 , or the root - mean - square error , rmse ) , and ( d ) the dependency of density functional rankings on the number and composition of reference data points .",
    "this paper is organized as follows : in section [ chap : sampling ] , we introduce the idea of sampling methods to estimate mpu , explain the essential concepts of nonparametric bootstrapping , discuss its advantages for a specific class of property models ( univariate linear least - squares regression ) , and demonstrate its ability to unravel different sources of systematic errors . in section [ chap :",
    "moessbauer ] , we discuss challenges for the prediction of the @xmath0fe mssbauer isomer shift on the basis of density functional theory , and reevaluate these challenges in the light of a statistically rigorous calibration analysis .",
    "since statistically rigorous calibration of physico - chemical property models is the objective of this paper , we first provide a brief and concise review of the relevant concepts and notation needed for this purpose .    to discuss the general concepts of sampling methods , we focus on the common case of a single target observable , @xmath3 , linked to a scalar input variable , @xmath4 , or to a vectorial input variable , @xmath5 ( in the following , we choose the more general notation @xmath5 ) .    given a reference data set , @xmath6",
    ", comprising @xmath7 data points ( @xmath8 with @xmath9 ) we would like to learn predictions of the target observable by calibration of the underlying property model , @xmath10 , where @xmath11 is the vector of parameters .",
    "the mean squared error , mse , and the coefficient of determination , @xmath12 , are common performance measures of the property model , @xmath13 and @xmath14 where @xmath15 is the arithmetic mean of the target values , @xmath16 , and @xmath17 is the vector of parameters obtained from calibration with respect to @xmath6 and a given objective ( usually , minimization / maximization of a performance measure ) .",
    "it is important to distinguish the _ coefficient of determination _ ,",
    "@xmath12 , from the _ coefficient of correlation _ , @xmath18 , the latter being independent of the parametric model .",
    "only in some cases ( such as linear least - squares regression with a single input variable ) , both quantities are equivalent .",
    "mse and @xmath12 are measures of the mpu of a target observable conditioned on @xmath6 . however , in terms of transferability , we would like to know the mpu of a target observable _ independent _ of a specific data set . in the following thought experiment",
    ", we assume that we can generate an asymptotically large number , @xmath19 , of new ( training ) samples , @xmath20 with @xmath9 and @xmath21 , where the asterisk means `` drawn from the population distribution underlying @xmath6 '' .",
    "if the data points are randomly drawn from a smooth population distribution , we can safely assume that all samples have no data in common ( the importance of independent samples for mpu estimation will be discussed in section [ chap : bootstrap ] ) .",
    "for every training sample , @xmath22 , we learn the parameters of the corresponding property model , @xmath23 , and evaluate its deviation from the target values of the reference sample , @xmath6 , @xmath24 in eq .",
    "( [ eq : mseb ] ) , the target values @xmath25 are elements of @xmath6 , whereas the predictions @xmath26 have been learned from @xmath22 .",
    "to estimate the mpu independent of @xmath6 , @xmath27 $ ] , we average over all samples , @xmath22 , @xmath28 = \\frac{1}{b } \\sum_{b=1}^b \\text{mse}_b^\\ast \\geq \\text{mse}_\\mathcal{d } \\",
    ", , \\ ] ] where the equality only holds in the artificially ideal case of @xmath29 .",
    "compared to the @xmath30 , the @xmath27 $ ] additionally incorporates uncertainty in the parameters .    note that under the assumption of normally distributed data with respect to a parametric model , the @xmath27 $ ] can be calculated analytically , i.e.",
    ", sampling is not required in that case . here , however , we examine the implications of such a critical assumption , which is why we explicitly refrain from considering a parameteric population distribution underlying @xmath6 .      the bootstrapping class of sampling methods by efron@xcite has been continuously developed@xcite . in nonparametric bootstrapping , the reference sample , @xmath6 , itself acts as population and , hence , new samples are drawn from @xmath6 . consequently , given @xmath7 input  target pairs in @xmath6 , these pairs are drawn with equal probability , @xmath31 .",
    "this procedure of sampling from available data is referred to as _ resampling_.@xcite the term _ nonparametric _ refers to the exclusion of a parameteric population distribution.@xcite we drop this term in the following and _ bootstrapping _ , if not otherwise mentioned , implies its ( original ) nonparametric variant .    to generate a _ bootstrap sample _ , @xmath7 elements are drawn from @xmath6 with replacement .",
    "this procedure is repeated @xmath19 times , say @xmath32 .",
    "there exist two variants of bootstrapping if the reference data set is composed of input ",
    "target pairs.@xcite the first variant is independent of the property model under consideration and referred to as _",
    "pair resampling_.@xcite in that case , the input ",
    "target pairs themselves are drawn with replacement , i.e. , the bootstrap samples are constructed as @xmath33 .",
    "the second variant requires a pre - calibrated property model conditioned on the reference data set , @xmath6 .",
    "the resulting residuals , @xmath34 , are then subject to resampling , which is referred to as _ residual resampling_.@xcite since independent and identically distributed residuals are assumed in that case , they have the same probability to occur anywhere along the input domain for which data is available .",
    "consequently , the input values , @xmath35 , are fixed in residual resampling , whereas the residuals , @xmath36 , are randomly drawn ( with replacement ) and added to the pre - calibrated property model , @xmath37 .",
    "hence , the corresponding bootstrap samples are constructed as @xmath38 . here",
    ", we will exclusively apply pair resampling since calibration prior to bootstrapping imposes further critical assumptions .",
    "bootstrapping allows us to sample mean and variance of the parameters contained in a calibration model ( and of arbitrary other statistics ) without relying on parametric population assumptions .",
    "mean and covariance of @xmath11 read @xmath39 and @xmath40 respectively .",
    "the mpu can be estimated from bootstrapping according to eq .",
    "( [ eq : emse ] ) .",
    "note that this bootstrapped variant of @xmath27 $ ] is different from that derived in the thought experiment introduced in the beginning of this section . here , the reference data set , @xmath6 , and the training data sets , @xmath22 , have many data points in common .",
    "this overlap promotes underestimation of mpu , and there exist straightforward corrections to the bootstrapped @xmath27 $ ] , for instance , the _ .632 _ estimator , @xcite @xmath41_{.632 } = 0.368 \\ \\text{mse } + 0.632 \\ \\frac{1}{n}\\sum_{n=1}^n \\mathbb{e}[\\text{mse}]_{-n } \\",
    ", , \\ ] ] where @xmath27_{-n}$ ] is the bootstrap estimate of the @xmath27 $ ] with the @xmath42-th input ",
    "target pair removed from the reference data set ( see also subsection [ chap : jackknife ] ) .",
    "the constant 0.632 @xmath43 relates to the probability of a data point to be included in a bootstrap sample.@xcite    we would like to highlight that the sampled parameter distributions resemble empirical variants of posterior distributions employed in bayesian inference.@xcite the latter approach allows for a direct estimation of mpu , which bypasses the need for corrections . for the inference of arbitrary posterior distributions , a bayesian approach is generally much more involved than bootstrapping",
    "however , in the case of gaussian posterior distributions , there exist efficient approximations to the problem such as the _ evidence approximation_,@xcite which we will discuss in the next subsection . in this study",
    ", we will compare the .632 bootstrap estimate of the mpu to that obtained from the evidence approximation assuming normality of the population distribution .",
    "hence , bootstrapping is an appealing alternative to statistical methods implying parametric assumptions on population distributions . on the one hand",
    ", modern general - purpose computers can generate and analyze thousands of bootstrap samples in a few seconds given a light fitting problem , i.e. , one where calibration is not the limiting step such as in linear least - squares regression . on the other hand , it is an objective approach as it allows for inferring statistical quantities solely from available information ( the reference data set ) .",
    "clearly , if the available data is biased in a way that it badly represents the true underlying population distribution , application of bootstrapping or any other statistical method is not sensible .",
    "major sources of data bias are small sample sizes@xcite and gross outliers . for the latter",
    "exist established detection methods@xcite . strictly speaking , even bootstrapping builds upon a population assumption , i.e. , the reference data set itself being the population . to express it in chernick s words@xcite , bootstrapping does not mean `` getting nothing for something '' , but `` getting the most from the little that is available '' .",
    "linear regression refers to a class of calibration procedures , where a target observable , @xmath3 , is estimated to be a linear combination , @xmath44 , of @xmath45 input variables , @xmath46 ( @xmath47 ) , and @xmath48 parameters , @xmath49 ( @xmath50 , where the zero - index refers to the intercept , which is quasi - multiplied by @xmath51 ) , @xmath52 where @xmath9 enumerates the input  target pairs of the reference data set , @xmath6 .",
    "given a least - squares objective ( one which seeks to minimize the @xmath30 with respect to the parameters , @xmath53 ) , the parameter vector @xmath17 learned from @xmath6 can be calculated analytically , @xmath54 where the so - called design matrix@xcite @xmath55 contains all instances of the input vector @xmath5 contained in @xmath6 , @xmath56 and @xmath57 is the vector of target values , @xmath58    even though linear least - squares regression is a well - established approach with eligibility for many applications , it implies certain critical assumptions@xcite ; ( a ) independent and identically distributed residuals , @xmath34 , ( b ) finite variance of residuals , and ( c ) variance - free input variables . only if these assumptions are valid , the least - squares approach yields the best linear unbiased estimate of the regression parameters .",
    "for instance , violation of assumption ( c ) is a ubiquitous phenomenon in the calibration of property models .",
    "it is a central topic of this paper and will be discussed in detail in section [ chap : moessbauer ] .",
    "furthermore , if assumption ( a ) is violated because the variance of the residuals is correlated with one or more input variables , one should instead minimize the weighted mse , wmse,@xcite for calibration , @xmath59 where @xmath60 is a diagonal weight matrix ( assumption of independent residuals ) , @xmath61 for property models , the elements @xmath62 usually represent squared experimental uncertainties . for our purposes ,",
    "the wmse serves only as objective function , i.e. , to calibrate the property model , and not as performance measure .",
    "the parameter vector @xmath63 learned from @xmath6 and @xmath60 reads @xmath64 this expression is a generalization of the special case covered by eq .",
    "( [ eq : ls ] ) where all elements @xmath65 are equal , which is why we drop the subscript @xmath60 in the following . in the special case of equality",
    ", it is sufficient to consider the average ( root - mean - square ) experimental uncertainty , @xmath66 , @xmath67    bootstrapping is an appealing diagnostic tool , which can be harnessed to validate these assumptions .",
    "each bootstrap sample yields a parameter vector @xmath68 where the asterisk indicates that @xmath55 , @xmath57 and @xmath60 are affected by the resampling procedure . properly speaking , when explicitly considering uncertainty on the target observable , pair resampling is replaced by triple resampling where bootstrap samples are constructed as @xmath69 .",
    "locally resolved mpu for a prediction at the input value @xmath70 , @xmath71 , can be estimated from the @xmath30 and the covariance matrix , @xmath72 , introduced in eq .",
    "( [ eq : var_w]),@xcite @xmath73 note that @xmath74 estimates the _ average _ prediction uncertainty of a series of measurements at the input value @xmath70 , and not the prediction uncertainty of a single measurement . in the latter case",
    ", one needs to add the squared experimental uncertainty @xmath75 to @xmath74 .",
    "the relation between the @xmath27_{.632}$ ] and the locally resolved mpu is given by @xmath41_{.632 } \\approx \\frac{1}{n } \\sum_{n=1}^n u^2(\\mathbf{x}_n ) \\ , , \\ ] ] where the approximation sign arises from the assumption of normality in the second term on the right - hand side of eq .",
    "( [ eq : local_error ] ) . this term can be replaced by its sampled analogue , but for the sake of user - friendliness , we decide to employ a limited number of characteristic values ( in this study , two for a prediction , @xmath76 , and three for the corresponding uncertainty , @xmath72 ) to facilitate comparisons of different computational methods ( e.g. , density functionals ) with respect to their performance .",
    "bayesian linear regression is an alternative to linear least - squares regression supported by bootstrapping .",
    "if there is good reason to assume that the parameter distributions are gaussian , bayesian linear regression can be much more efficient than sampling - based regression .",
    "this efficiency stems from the evidence approximation,@xcite which iteratively infers the posterior distributions of parameters , the maxima of which yield the best - fit parameter vector , @xmath77 ( map , maximum posterior ) .",
    "the procedure is outlined in the appendix and yields an mpu estimate referred to as mean predictive variance ( mpv ) , @xmath78 where @xmath79 is the analogue of @xmath80 obtained from bootstrapping .    in the following",
    ", we will report the square roots ( rmse , r632 , rmpv ) of the performance measures introduced ( @xmath30 , @xmath27_{.632}$ ] , @xmath81 ) for the sake of better comparability with the experimental uncertainty .",
    "so far , the discussion of statistical inference was built on the implicit assumption of data sets representing their underlying population distributions well .",
    "verifying the validity of this assumption is a tedious task , but a diagnostic referred to as _ jackknife - after - bootstrapping _ provides a good approximation to the problem@xcite . in the first step of that diagnostic ( given a data set with @xmath7 input  target pairs ) , the sampled ensemble of parameters , @xmath82 , is decomposed into @xmath7 different sets , @xmath83 ( @xmath9 ) , the @xmath42-th of them containing only those parameters @xmath84 learned from bootstrap samples in which the @xmath42-th input ",
    "target pair is _ not _ included .",
    "for instance , one obtains a bootstrap estimate of the mean of a parameter with the @xmath42-th data point removed , @xmath85 .",
    "if this jackknifed mean deviates significantly from that inferred from the complete reference data set , @xmath76 , we have an indication that the @xmath42-th data point biases the calibration .",
    "an appealing feature of the jackknife - after - bootstrapping method is its efficiency . instead of running @xmath7 extra bootstrap simulations ,",
    "one only performs a single bootstrap simulation on the complete reference data set .",
    "the reason is that some bootstrap samples do not contain certain data points . in this way",
    ", the decomposition of parameters into @xmath7 subsets can be performed simultaneously to the bootstrap simulation on the complete reference data set .",
    "since the probability of a data point to be excluded from a bootstrap sample is roughly@xcite 0.362 @xmath86 , we recommend to increase the default number of bootstrap samples by a factor of approximately 3 to preserve the intended calibration accuracy .",
    "calibration has been frequently applied to predict the isomer shift observed in @xmath0fe mssbauer spectroscopy.@xcite the corresponding theory@xcite postulates a linear relationship between the measurable isomer shift , @xmath88 , and the difference in the contact electron density ( ced ) , @xmath89 , of the @xmath0fe isotope embedded in two different chemical environments ( referred to as _ absorber _ and _ source _ ) , @xmath90 \\ , .\\ ] ] @xmath91 is a function of the average charge radius , @xmath92 , of an iron nucleus , and @xmath93 is the difference between the charge radii of the excited state and the ground state of an iron nucleus . in the corresponding property model , @xmath94 with @xmath95 , all quantities of the right - hand side of eq .",
    "( [ eq : mis ] ) except for @xmath96 are hidden in the regression parameters , @xmath97 ( intercept ) and @xmath98 ( slope ) , @xmath99    the absorber ced ( aced ) , @xmath96 , is determined from an electronic structure method , typically based on density functional theory . since every specification employed in an electronic structure calculation ( e.g. , density functionals , basis sets , integration grids , convergence criteria ) may affect the value of @xmath96 , the property model needs to be calibrated every time a specification is changed . as noted in section [ chap : regression ] , one of the key assumptions in applying linear least - squares regression are variance - free input values .",
    "while electronic structure calculations yield virtually variance - free results ( neglecting numerical errors and convergence threshold effects ) , the expectation value of an observable remains unpredictable due to method - inherent systematic errors , which are collectively referred to as method inadequacy.@xcite method inadequacy causes the average uncertainty of the reference isomer shifts to be non - reproducible , no matter which values we choose for @xmath97 and @xmath98 .",
    "consequently , one should have serious doubt on the validity of the free - of - variance assumption .",
    "another frequent source of systematic errors are inconsistent data . on the one hand ,",
    "the reference isomer shifts employed in this study have been recorded at different temperatures ( 4100 k ) , which can lead to deviations of about 0.02  mm  s@xmath1 ( second - order doppler shift).@xcite bochevarov , friesner , and lippard@xcite proposed to consider only those isomer shifts recorded at liquid helium temperature ( 4.2 k ) .",
    "this situation is clearly desirable , but it would have limited our reference data set in terms of chemical diversity . on the other hand ,",
    "it is difficult to ensure that the molecular - structure representations employed are sufficiently accurate for reliable aced calculations . even though crystal structures guide the search for the correct minimum on the born ",
    "oppenheimer surface , there is no guarantee that structure optimization yields reliable results .",
    "furthermore , not only the iron - containing compound itself may be important for isomer - shift calibration , but also the closer environment of the solid sample such as adjacent iron complexes , counter - ions , or solvent molecules .",
    "the effect of the molecular - structure representation on the aced remains an issue to be studied , which is beyond the scope of this work",
    ".    in essentially all previous calibration studies of the isomer shift,@xcite the coefficient of correlation , @xmath18 , served as a measure to assess the performance of an electronic structure method ( note that in linear least - squares regression with a single input variable , as applied here , @xmath18 is identical to the coefficient of determination , @xmath12 ) .",
    "however , according to eqs .",
    "( [ eq : r2 ] ) and ( [ eq : emse ] ) , there is no guarantee that @xmath12 ( @xmath100 ) allows for a reliable comparison of two electronic structure methods with respect to their transferability , because this performance measure does not take into account uncertainty in both the reference data and the model parameters .    the incompleteness of @xmath18 ( or the rmse ) as mpu estimator , the possible existence of inconsistent reference data , and the unpredictable variability in the input variable has motivated us to reexamine isomer - shift calibration in the light of a statistically rigorous analysis .",
    "we assess the reliability of different performance measures and study the transferability of 12 density functionals with respect to isomer - shift predictions for 44 iron compounds of considerable chemical diversity ( cf .",
    "table [ tab : compounds ] ) .",
    "details on the computational protocol employed for both statistical calibration analysis and quantum chemical calculations are provided in the appendix and scripts for the analysis will be made available on our webpage .      in previous calibration studies of the isomer shift@xcite ,",
    "a variety of iron complexes was considered . here , we chose a diverse set of molecular iron compounds ( see table [ tab : compounds ] ) representing wide ranges of formal oxidation states , spin multiplicities , total charges , and ligand environments ( type , number , and spatial orientation ) .",
    "we blended parts of previous reference sets by friesner and lippard@xcite , neese@xcite , noodleman@xcite , and our group@xcite with iron(i ) complexes@xcite .",
    "we explicitly excluded linear and t - shaped iron compounds with a formal oxidation state of + 1 , since these species are known to reveal pronounced spin ",
    "orbit coupling@xcite not considered in our computational approach .",
    "orbit coupling induces a shift of nonrelativistic aceds depending on the chemical system , which is why it can not simply be absorbed into the regression parameters.@xcite by contrast , scalar - relativistic effects have been found to induce a constant shift of nonrelativistic aceds for iron - containing molecules , which is why isomer - shift calibration is frequently based on nonrelativistic calculations.@xcite in our previous study on @xmath101 isomer - shift calibration @xcite , we found that scalar - relativistic calculations lead to a slightly higher correlation between the target observable and the input variable compared to nonrelativistic calculations .",
    "however , in preparation of the present work , we detected a specification error for iodine in the emsl basis - set database@xcite for the def2-tzvp basis set and the molcas computer program that turned out to be the source of the slightly better performance .",
    "correction of this error reveals equivalent input ",
    "target correlation for scalar - relativistic and nonrelativistic results .    [ cols=\"<,<,^,^,^,^,^,^,^,<\",options=\"header \" , ]     combining all these findings , we are confident that the updated , consistent reference data set represents the underlying population distribution sufficiently well if hybrid density functionals generate the input data . hence ,",
    "our reference set of @xmath102 , already pruned by statistically critical outliers , provides a well - defined starting ground for further parametrization studies or for systematic extensions of the reference data .",
    "hence , we may call this special set of data the mis39 data set ( for 39 reference data points of mssbauer isomer shifts ) .      in the previous subsection",
    ", we found for the particular composition and number of data points that the effect of parameter uncertainty on the mpu is very small ( @xmath1030.01  mm  s@xmath1 for all density functionals ) .",
    "hence , given this specific reference data set , we are confident that the rmse ( and with it the coefficient of correlation , @xmath18 ) is a good approximation to performance measures such as r632 and rmpv , and therefore , suited to set up a ranking of density functionals . in the following ,",
    "we only distinguish between first and other places in a ranking as only those density functionals will be considered for actual applications that reveal highest transferability .",
    "b3lyp , b3pw91 , and pbe0 are placed first in all rankings studied ( rmse , r632 , rmpv ) , with tpssh being placed first in the rankings based on r632 and rmpv ( cf .",
    "table [ tab : error39 ] ) .",
    "this finding is consistent with those of other calibration studies of the isomer shift.@xcite    however , in practice , it is relevant to know which density functional yields the most accurate predictions _",
    "independent _ of the reference data employed for calibration of the property model .",
    "so far , we considered rankings of density functionals conditioned on a specific reference data set , but what we aim at is an unconditional ranking of density functionals .",
    "otherwise , we can not assess the transferability of a property model trained on a specific density functional to data not involved in its calibration .",
    "clearly , the dependency of any statistical measure on reference data can not entirely be removed , but bootstrapping can yield a good approximation to the problem given the data under consideration is representative of the underlying population distribution , which we have assessed in detail by the jackknife - after - bootstrapping method .    to study the reliability of density functional rankings with respect to the composition and number of data points , we have drawn samples of different size ( @xmath104 ) with replacement ( @xmath105 , respectively ) from the empirical population distribution of the consistent reference data set ( @xmath102 ) .",
    "for every bootstrap sample , the isomer shifts have been perturbed randomly according to their experimental uncertainty ( for details , see the appendix ) . in fig .",
    "[ fig : ranking ] , we show the percentage of first places that a density functional has reached for 2500 different data sets and four different data - set sizes .",
    "the rankings are based on the rmse .    [ !",
    "ht ]   synthetic data sets of different size ( @xmath104 ) , which were generated by drawing from the empirical population distribution of the consistent reference data set ( @xmath102 ) with replacement .",
    "the rankings were determined on the basis of the rmse . for every bootstrap sample",
    ", the isomer shifts have been perturbed randomly according to their experimental distribution ( for details , see the appendix ) . while false conclusions about the transferability of a density functional are likely for 5 data points ( no density functional is placed first in more than about 60% of the cases ) , the `` best '' density functional , pbe0 , is identified first in 95% of the cases for @xmath102 , the size of the reference data set employed in this study .",
    ", title=\"fig : \" ]    for all different data sets considered , b3lyp , b3pw91 , and pbe0 are still most frequently placed first , but the respective percentage varies significantly . for @xmath106 data points ,",
    "pbe0 reveals the highest number of first places , but only in about 60% of the cases .",
    "even some pure density functionals are placed first in more than 10% of the cases , although the different performance measures are clearly in favor of hybrid density functionals regarding the reference data set ( cf .",
    "table [ tab : error39 ] ) . hence , calibration studies based on 5 data points are highly susceptible to random conclusions about the transferability of density functionals . with an increasing number of data points ,",
    "the percentage of first places continuously decreases for all pure density functionals and for m06 until it vanishes for 1000 data points , while tpssh reveals relatively constant results for all data points considered ( between 30% and 40% first places ) . by contrast , the percentage of first places for b3lyp , b3pw91 , and pbe0 increases up to 100% for 1000 data points .",
    "qualitatively identical and quantitatively similar results were obtained for density functional rankings based on the rmpv ( cf .",
    "this finding indicates that for the given experimental resolution , parameter uncertainty plays no role , even for 5 data points where the standard deviation in the parameters is about 4 times larger compared to 39 data points , the number of reference data points considered in this study ( see fig .  [",
    "fig : parameters ] ) . consequently ,",
    "both rmse and @xmath18 can be considered stable performance measures for density functional rankings applied in isomer - shift predictions of molecular iron compounds .",
    "note that we did not employ the r632 as performance measure as it is very costly to sample an error for every bootstrap sample , which is equivalent to bootstrapping bootstrap samples ( double bootstrapping@xcite ) .",
    "however , as shown above , the rmpv can be expected a good approximation to the r632 .    [ !",
    "ht ] , and slope , @xmath98 , of eq .",
    "( [ eq : model ] ) for a varying number of data points ( @xmath107 ) .",
    "the synthetic data sets were generated by drawing from the empirical population distribution of the consistent reference data set ( @xmath102 ) with replacement .",
    "the colored lines represent specific synthetic data sets , while the black solid line is the arithmetic mean over them .",
    "the transparent yellow area represents the standard deviation of the regression parameters .",
    "compared to the data - set size employed for isomer - shift calibration in this study ( @xmath102 ) , the standard deviation increases by a factor of 4 when reducing the number of data points to 5 . however , due to the low experimental resolution of 0.01  mm  s@xmath1 , the uncertainty in the parameters has a negligible effect on both r632 and rmpv .",
    "the aced values were obtained from b3lyp calculations .",
    ", title=\"fig : \" ]    the fact that more than one density functional is placed first on average is clearly an indicator of the low experimental resolution .",
    "when increasing the experimental resolution from 0.01  mm  s@xmath1 to 0.001  mm  s@xmath1 in a statistically sound way ( for details , see the appendix ) , the results based on the rmse change significantly ( see fig .  [",
    "fig : highres ] ) .",
    "the dispersion of the rankings is much more pronounced for 5 and 15 data points , and a clear preference for a density functional of more than 95% ( pbe0 ) is only reached at a number of data points significantly larger than that employed in this study ( @xmath102 ) .",
    "similar results were obtained for density functional rankings based on the rmpv ( cf .",
    "ht ]   synthetic data sets of different size ( @xmath104 ) , which were generated by drawing from the empirical population distribution of the consistent reference data set ( @xmath102 ) with replacement .",
    "the rankings were determined on the basis of the rmse . for every bootstrap sample ,",
    "the reference isomer shifts have been perturbed randomly according to their experimental distribution .",
    "additionally , the experimental resolution has been artificially increased from 0.01  mm  s@xmath1 to 0.001  mm  s@xmath1 in a statistically sound way ( for details , see the appendix ) .",
    "the dispersion of the rankings increases compared to the actual experimental resolution , and even for 39 data points , the `` best '' density functional , pbe0 , is identified as such in only 70% of the cases .",
    ", title=\"fig : \" ]    reducing the data - set dependency of the mpu by the application of bootstrapping and increasing the experimental resolution in a statistically sound way , we find a clear preference for pbe0 as the density functional with the highest transferability .",
    "this preference even remains ( a ) when resubstituting the 5 inconsistent input ",
    "target pairs ( # 1 , # 2 , # 7 , # 13 , # 28 , cf .",
    "table [ tab : compounds ] ) into our consistent reference data set ( @xmath108 ) , and ( b ) when selecting only those reference isomer shifts for which experimental uncertainties were reported ( without resubstitution of inconsistent data points , @xmath109 ) ; cf .",
    "therefore , we suggest that pbe0 is the density functional of choice for applications ( with the cp(ppp ) basis for fe and def2-tzvp for all other elements ; see appendix ) , which leads to the following linear isomer - shift model obtained from linear least - squares regression supported by bootstrapping ( @xmath110 ) , @xmath111 and the corresponding covariance matrix , @xmath112 for reasons of reproducibility , we specify six significant figures for the characteristic values contained in @xmath113 and @xmath114 .",
    "to reliably estimate the prediction uncertainty of a property model , it is important to identify and correct for systematic errors due to , e.g. , inconsistent measurements , parametric population assumptions , or inadequate computational methods . here",
    ", we studied this issue at the example of @xmath0fe mssbauer isomer - shift predictions based on a linear regression model .",
    "twelve density functionals across jacob s ladder were considered for the calculation of the aced for 44 chemically diverse molecular iron compounds ( formal oxidation states : 0 , + 1 , + 2 , + 3 , + 4 ) , whereas the corresponding target data refer to measured isomer shifts .",
    "we explicitly considered uncertainty in the model parameters , which is a crucial ingredient for the estimation of mpu .",
    "for this purpose , we employed both bootstrapping@xcite and bayesian linear regression based on the evidence approximation.@xcite .",
    "first of all , we found that the rmse , which measures the standard deviation of the model residuals , is significantly larger than the average experimental uncertainty ( 0.070.10  mm  s@xmath1 versus 0.02  mm  s@xmath1 ) .",
    "this discrepancy can not be explained by the simplicity of the linear model as more complex property models ( quadratic , cubic , quartic ) were found to yield either equal or larger mpu estimates when applying bootstrapping .",
    "however , with the jackknife - after - bootstrapping approach , which probes the sensitivity in the mpu with respect to small changes in the reference data set , we could identify 5 inconsistent data points .",
    "the reliability of the jacknife - after - bootstrapping approach can be assessed by determining the fraction of data points lying in a certain prediction interval . when including the inconsistent data points , 86% of the reference isomer shifts lie in the 68% prediction band ( representing one standard deviation of mpu ) , whereas excluding them leads to only 72% of the reference isomer shifts still contained in the 68% prediction band , which reveals a significant improvement of the statistical reliability .    the new ( consistent ) reference data set still leads to overestimation of the average experimental uncertainty ( rmse of 0.030.08  mm  s@xmath1 ) , which can be assigned to non - constant systematic errors of the density functionals leading to random shifts of the ( unknown ) true input values .",
    "this random method inadequacy implies that weighted least - squares regression , where experimental uncertainties are explicitly introduced as a weight , can bias the calibration of the property model . on the basis of iteratively reweighted least - squares regression",
    ", we found that the parameters obtained from standard ( unweighted ) least - squares regression are much more reliable than those of a weighted least - squares regression .",
    "this result is in contrast to the conclusion of grandjean and long@xcite , who recommend the application of weighted least - squares regression for the calibration of isomer - shift models .",
    "comparison of the rmse with more reliable performance measures , which consider uncertainty in the parameters ( such as the .632 bootstrap estimator , r632 , or the mean predictive variance obtained from bayesian linear regression , rmpv ) , reveals nearly equal results in most of the cases .",
    "this finding can be explained by the low experimental resolution of 0.01  mm  s@xmath1 compared to the width of the input domain ( 1.08  mm  s@xmath1 ) , which almost completely masks parameter uncertainty .",
    "therefore , simple performance measures such as the rmse and the coefficient of determination , @xmath12 , are expected to be reliable for the construction of density functional rankings , where relative rather than absolute mpu estimates are required .",
    "finally , we examined the sensitivity of density functional rankings with respect to the composition and number of data points . for this purpose",
    ", we generated 10000 synthetic data sets ( based on bootstrapping ) with 5 , 15 , 39 ( the size of our reference data set ) , and 1000 data points . for 5 data points , false conclusions about the performance of a density functional are likely .",
    "for instance , the `` best '' density functional , pbe0 , is placed first in only about 60% of the cases .",
    "the difference in the rankings for 15 and 39 data points is marginal .",
    "b3lyp and b3pw91 are placed first in 7585% of the cases , whereas pbe0 is placed first in 8595% of the cases .",
    "still , there remains a serious chance of favoring a subprime density functional for usual data - set sizes ( @xmath115)@xcite employed in calibration studies of the isomer shift .",
    "rmse and rmpv produced equivalent density functional rankings .",
    "however , due to the low experimental resolution , important effects stemming from parameter uncertainty may be hidden .",
    "we examined this hypothesis by artificially increasing the experimental resolution from 0.01  mm  s@xmath1 to 0.001  mm  s@xmath1 . while rmse and rmpv still yielded similar rankings , their dispersion increased significantly .",
    "for instance , the `` best '' density functional , pbe0 , is placed first in only 3040% of the cases for 5 and 15 data points .",
    "even for 39 data points , the identification of pbe0 as `` best '' density functional is only successful in 70% of the cases .",
    "when selecting a density functional for actual applications , one is interested in a reliable uncertainty estimation of an isomer - shift prediction for a given aced . for this purpose ,",
    "the prediction bands employed in this study represent locally resolved mpu based on the .632 estimator .",
    "the validity of the mpu is highest at the mean aced for a given density functional and decreases continuously from there , which is why extrapolations outside the input domain studied are not recommended .",
    "this limitation motivated us to cover a wide range of possible aced values such that chemically diverse iron complexes can be investigated on the basis of our calibration analysis .",
    "another possibility to approach accurate isomer - shift predictions is to calculate the isomer shift directly from first principles .",
    "filatov derived the corresponding computational scheme@xcite and applied it to examine the isomer shift of molecular iron compounds @xcite .",
    "post - calibration of the resulting isomer - shift pairs ( measured versus calculated ) would allow for an assessment of the more adequate input variable ( isomer shift versus aced ) .",
    "we discussed several issues in this paper ranging from error diagnostics , mpu estimation , and the role of experimental resolution to the reliability of conclusions drawn on the basis of a specific data set .",
    "bootstrapping clearly shows that performance assessment of density functionals is error - prone for a small number of data points , and for univariate linear regression models , one should consider at least about 40 data points .",
    "while the main message of previous calibration studies of the isomer shift remains ( hybrid density functionals perform superior to pure density functionals@xcite ) , we now provide a solid statistical framework to examine the certainty of such findings .",
    "this framework allowed us to suggest a new , statistically well - justified property model for the isomer shift , given in eq .",
    "( [ refmet ] ) , based on pbe0 calculations .",
    "moreover , we introduced a new reference data set for such parametrizations , mis39 , which may be employed and extended for future work .",
    "in particular , this calibration study presents the first statistically rigorous analysis for theoretical mssbauer spectroscopy providing the practitioner with reliable , locally resolved uncertainties for isomer - shift predictions .",
    "moreover , our calibration analysis is of general applicability and not restricted to property models applied in mssbauer spectroscopy .",
    "we will provide the scripts which were written for this work on our webpage so that the methodology can be applied in other parametrization studies of physical and chemical property model .",
    "financial support from the swiss national science foundation ( project no .",
    "200020_169120 ) is gratefully acknowledged .",
    "all statistical results presented in this work have been produced with scripts we wrote in the matlab programming language .",
    "gnu octave@xcite is free software that is mostly compatible with matlab .",
    "the basic functionalities of the calibration methods employed are already described in section [ chap : sampling ] . in this subsection",
    ", we discuss some further details .",
    "the evidence approximation@xcite is an efficient calibration procedure for normally distributed parameters .",
    "the best - fit parameter vector , @xmath77 , is obtained from @xmath116 where @xmath117 is the covariance matrix of the parameters , @xmath118 @xmath119 is the @xmath120 unit matrix ( @xmath45 is the number of parameters contained in the property model ) , and @xmath121 and @xmath122 are so - called hyperparameters , @xmath123 @xmath124 which need to be iteratively refined . for this purpose , the effective number of parameters , @xmath125 , is calculated according to @xmath126 where the @xmath127 are eigenvalues of the @xmath128 matrix of dimension @xmath120 , @xmath129 and the @xmath130 are the corresponding eigenvectors .",
    "finally , the locally resolved mpu at input value @xmath70 , @xmath131 , is estimated as @xmath132    in all cases examined in this study , the rmpv did not change by more than 0.002% after the first iteration of the evidence approximations .",
    "this deviation is completely masked by the low experimental resolution of 0.01  mm  s@xmath1 for measurements of the @xmath0fe mssbauer isomer shift .",
    "therefore , we conclude that a single iteration is sufficient to obtain a converged rmpv .      in iteratively reweighted linear least - squares regression @xcite ,",
    "one starts with a weighted linear least - squares regression with respect to a reference data set , @xmath6 .",
    "the elements of the weight matrix @xmath60 introduced in eq .",
    "( [ eq : umatrix ] ) are updated , @xmath133 where the term @xmath134 accounts for the discrepancy between the mse and the average experimental variance , @xmath135 , @xmath136 subsequently , one performs another weighted linear least - squares regression with the updated weight matrix .",
    "this procedure is repeated until the change in @xmath134 becomes negligible between two iterations .",
    "here , we chose a threshold of 0.001% .",
    "bootstrap samples were drawn by pair resampling ( cf .",
    "section [ chap : bootstrap ] ) .",
    "each target value , @xmath25 , in a bootstrap sample was randomly perturbed according to its experimental uncertainty ( @xmath137 0.02  mm  s@xmath1 for compounds without reported experimental uncertainty ) .",
    "for instance , if a data point considered refers to the @xmath42-th input ",
    "target pair in the reference data set , a random value was drawn from a normal distribution with zero - mean and a standard deviation of @xmath65 .",
    "this random value was rounded to the second decimal place to account for the experimental resolution of 0.01  mm  s@xmath1 , and subsequently added to @xmath25 of the data point considered .",
    "bootstrap samples were drawn by pair resampling ( cf .",
    "section [ chap : bootstrap ] ) . to increase the experimental resolution from its actual value of 0.01  mm  s@xmath1 to 0.001  mm  s@xmath1 , one must respect that any value of the isomer shift with three decimal places is equiprobable as long as the result rounded to two decimal places equals the reported isomer shift . for this purpose ,",
    "random values were drawn from a uniform distribution with boundaries of @xmath1380.005  mm  s@xmath1 and @xmath1390.004  mm  s@xmath1 , and subsequently added to the actual isomer shifts , @xmath25 , assuming the third decimal place equals zero prior to addition .",
    "if experimental uncertainty , @xmath65 , was explicitly considered in bootstrapping ( see above ) , the same procedure was repeated for @xmath65 .",
    "references to the original crystal structures are listed in table [ tab : compounds ] .",
    "first of all , solute molecules and counterions were removed from all molecular structures .",
    "the only exceptions are structures 22 and 26 ( table [ tab : compounds ] ) , where we kept the very small counterions due to their proximity to the iron nucleus ( lithium and sodium , respectively ) .",
    "all molecular structures were fully optimized with the tpss density functional @xcite , ahlrichs def2-tzvp basis set on all atoms @xcite , grimme s dft - d3 dispersion correction @xcite , and the conductor - like screening model ( cosmo)@xcite for electrostatic screening with a dielectric constant of @xmath140 ( water ) . for iodine ,",
    "the only group-5 element in the reference set of iron compounds , the effective core potential def2-ecp was employed.@xcite structure optimizations were performed with turbomole 6.4.0@xcite applying the resolution - of - the - identity approximation , which invokes an auxiliary basis set .",
    "the convergence thresholds were set to @xmath141 hartree for the electronic energy difference and @xmath142 hartree / bohr for the length of the gradient of the electronic energy with respect to the nuclear coordinates .",
    "some molecular structures were further truncated prior to structure optimization ( see table [ tab : compounds ] ) . for instance , larger alkyl groups at aromatic rings not directly attached to iron were replaced by methyl groups .",
    "all subsequent aced calculations were performed with orca 3.0.3@xcite ( see table s2 ) . for every molecular iron compound contained in our reference set , we determined the aced with 12 different density functionals ; one lda functional ( pwlda@xcite ) , four gga functionals ( bp86@xcite , blyp@xcite , pw91@xcite , pbe@xcite ) , two meta - gga functionals ( m06-l@xcite , tpss ) , three hybrid - gga functionals ( b3lyp@xcite , b3pw91@xcite , pbe0@xcite ) , and two meta - hybrid - gga functionals ( m06@xcite , tpssh@xcite ) .",
    "neese s cp(ppp ) basis set @xcite was employed for iron , whereas ahlrichs def2-tzvp basis set was employed for all other elements .",
    "all calculations were based on electrostatic screening ( cosmo ) with a dielectric constant of @xmath143 .",
    "the convergence threshold for the electronic energy difference was set to @xmath144 hartree ( default ) . in case of error code 16384 ( the only type of error that occurred in our aced calculations ) , we added either the keyword ` slowconv ` to the first line ( starting with ` ! ` ) or ` % scf maxiter < no . > end ` in a separate line ( ` < no .",
    "> ` @xmath137 500 always worked in the cases studied ) .",
    "we repeated all aced calculations with def2-tzvp replaced by def2-svp@xcite ( see table s3 ) , resulting in slightly higher mpu for the latter ( cf .",
    "tables s6 and s7 ) .",
    "we did not perform further statistical analyses based on the def2-svp results , but exploited this smaller basis set to probe the sensitivity of the aced with respect to the convergence threshold for the electronic energy difference ( see table s4 ) .",
    "we decreased the convergence threshold for the electronic energy difference to @xmath145 hartree ( b3lyp / def2-svp ) .",
    "for both thresholds , mean and maximum of the unsigned difference in the aced are only 0.1% and 3.7% as large as the standard deviation of the aced itself , respectively .",
    "we may conclude that default self - consistent field convergence criteria lead to stable results , especially taking into account the low experimental resolution of 0.01  mm  s@xmath146 .",
    "hastie ,  t. ;  tibshirani ,  r.  j. ;  friedman ,  j. _ the elements of statistical learning : data mining , inference , and prediction ; _ springer series in statistics springer : new york , ny , usa , second edition , corrected at 11th printing 2016 ed . ;",
    "2016 .",
    "samuel ,  p.  p. ;  mondal ,  k.  c. ;  amin  sk ,  n. ;  roesky ,  h.  w. ;   carl ,  e. ;  neufeld ,  r. ;  stalke ,  d. ;  demeshko ,  s. ;  meyer ,  f. ;   ungur ,  l. ;  chibotaru ,  l.  f. ;  christian ,  j. ;  ramachandran ,  v. ;  ,  j. ;  dalal ,  n.  s. _ j. am .",
    "* 2014 , * _ 136 , _ 1196411971 .",
    "hartman ,  j. a.  r. ;  rardin ,  r.  l. ;  chaudhuri ,  p. ;  pohl ,  k. ;   wieghardt ,  k. ;  nuber ,  b. ;  weiss ,  j. ;  papaefthymiou ,  g.  c. ;   frankel ,  r.  b. ;  lippard ,  s.  j. _ j. am .",
    "soc . _ * 1987 , * _ 109 , _ 73877396 ."
  ],
  "abstract_text": [
    "<S> one of the major challenges in computational science is to determine the uncertainty of a virtual measurement , that is the prediction of an observable based on calculations . </S>",
    "<S> as highly accurate first - principles calculations are in general unfeasible for most physical systems , one usually resorts to parameteric property models of observables , which require calibration by incorporating reference data . </S>",
    "<S> the resulting predictions and their uncertainties are sensitive to systematic errors such as inconsistent reference data , parametric model assumptions , or inadequate computational methods . here , we discuss the calibration of property models in the light of bootstrapping , a sampling method akin to bayesian inference that can be employed for identifying systematic errors and for reliable estimation of the prediction uncertainty . </S>",
    "<S> we apply bootstrapping to assess a linear property model linking the @xmath0fe mssbauer isomer shift to the contact electron density at the iron nucleus for a diverse set of 44 molecular iron compounds . </S>",
    "<S> the contact electron density is calculated with twelve density functionals across jacob s ladder ( pwlda , bp86 , blyp , pw91 , pbe , m06-l , tpss , b3lyp , b3pw91 , pbe0 , m06 , tpssh ) . </S>",
    "<S> we provide systematic - error diagnostics and reliable , locally resolved uncertainties for isomer - shift predictions . </S>",
    "<S> pure and hybrid density functionals yield average prediction uncertainties of 0.060.08  mm  s@xmath1 and 0.040.05  mm  s@xmath1 , respectively , the latter being close to the average experimental uncertainty of 0.02  mm  s@xmath1 . </S>",
    "<S> furthermore , we show that both model parameters and prediction uncertainty depend significantly on the composition and number of reference data points . accordingly , we suggest that rankings of density functionals based on performance measures ( e.g. , the coefficient of correlation , @xmath2 , or the root - mean - square error , rmse ) should not be inferred from a single data set . </S>",
    "<S> this study presents the first statistically rigorous calibration analysis for theoretical mssbauer spectroscopy , which is of general applicability for physico - chemical property models and not restricted to isomer - shift predictions . </S>",
    "<S> we provide the statistically meaningful reference data set mis39 and a new calibration of the isomer shift based on the pbe0 functional .    </S>",
    "<S> eth zrich , laboratorium fr physikalische chemie , + vladimir - prelog - weg 2 , 8093 zrich , switzerland . </S>"
  ]
}