{
  "article_text": [
    "the astronomical time domain provides unique insight into a range of astrophysical phenomena .",
    "studies of variable stars yield information about stellar structure and evolution as well as help to set the extra - galactic distance scale",
    ". active galactic nuclei ( agn ) reveal the high - energy phenomena associated with the super - massive black holes that reside at the centers of most galaxies .",
    "supernovae ( sne ) and gamma - ray bursts ( grbs ) provide a glimpse of the fantastic energies released during the violent death throes of several types of stars .",
    "type  ia supernovae ( sne  ia ) are of particular interest because their use as `` standard candles '' has revealed the acceleration of the expansion of the universe from an inferred cosmological constant - like force  @xcite .",
    "studies of variable sources require specific analysis methods that are not necessary for non - variable sources .",
    "since it is often difficult to detect variation in an object by simply inspecting images , the standard procedure is to subtract images taken at different times to remove objects with constant flux .",
    "photometrically variable objects are then obvious . for the case of sne ,",
    "one typically obtains a pair of observations separated in time to allow for sne not present in the first image to reach observable brightness in the second ( see , e.g. , @xcite and @xcite for a description of the method ) . after detection",
    ", additional observations are made to obtain the complete light curve necessary for cosmological analysis ( see * ? ? ?",
    "* ; * ? ? ?",
    "in order to construct the light curve , it is necessary for at least one observation ( the `` template '' image ) to contain no sn flux .",
    "often this is the initial image used during discovery of the sn . in many instances , however , the sn is present at a faint level in this image , so an additional observation , taken after the sn has faded from view , is required .",
    "the light curve is then calculated by measuring the flux levels in subtractions of each image from the designated template using , for example , the subtraction procedure described by @xcite .",
    "this , the `` single - template method , '' is the typical means of constructing light curves of sne and other variable sources .",
    "however , this method has certain drawbacks .",
    "the primary flaw is that the quality of any subtraction depends greatly upon the two images involved .",
    "if the template is of a poor quality caused , for instance , by poor seeing or a low signal - to - noise ratio ( s / n ) , then @xmath2 subtraction will be degraded , with a corresponding increase in the measured flux uncertainty , even if all other images are of high quality .",
    "any flaw in the template creates a systematic error for the entire light curve that is not detectable from internal consistency checks or through comparison with another sn light curve .    in order to alleviate this problem ,",
    "we have developed a new method for constructing light curves of photometrically variable objects . given @xmath0 observations",
    "there are a total of @xmath1 pairs of images that can be subtracted together , only @xmath3 of which are performed in the single - template method .",
    "a matrix of flux differences can be constructed from these subtractions and used to determine the flux at each individual epoch .",
    "this process removes the dependence on any single observation , because all observations are treated equally as a `` template . ''",
    "we refer to this method as the `` n(n-1)/2 '' method ( hereafter abbreviated nn2 ; see @xcite for an initial description ) .",
    "section  [ sec - math ] describes the mathematical underpinnings of nn2 . in section  [ sec - example ]",
    "we demonstrate the efficacy of the method using simulated sne inserted into images used during an actual high - redshift sn survey .",
    "section  [ sec - conclusions ] gives our conclusions .",
    "we assume that we start with @xmath0 observations of an object , so that one may construct from all pairs of subtractions an @xmath4 antisymmetric matrix @xmath5 of flux differences that we wish to analyze as a `` vector - term difference . '' in other words , we want to find an @xmath0-vector @xmath6 of fluxes such that @xmath7 we also assume that we have a symmetric @xmath4 error matrix @xmath8 that expresses our uncertainty in each term of @xmath5 .",
    "as we shall see , this matrix may not be easy to generate , and its interpretation may be somewhat ambiguous .",
    "however , one can imagine generating an error matrix by the following procedure .",
    "in each of the difference images , we measure a flux for the object in question . in general this measurement",
    "consists of fitting a fixed point - spread function ( psf ) profile at the location of the object by adjusting the amplitude of the psf ( both positive or negative ) and the local background level .",
    "the psf profile may be obtained from a suitable star in the original image while the location of the variable source may be determined by summing all the difference images ( adjusted to keep the sign of the object positive ) and fitting the location in this sum .",
    "once we have a flux measurement , we can insert copies of the object at nearby empty regions of the difference image and repeat the procedure .",
    "the mean of the recovered fluxes indicates whether there is a bias in the measurement , and the scatter may be used as a term @xmath9 in the error matrix .",
    "the crux of the nn2 method is the distillation of the photometric measurements from the full set of @xmath1 subtractions to a lightcurve , @xmath6 , that represents our best understanding of the behavior of the object under consideration . as long",
    "as it is consistent , the exact procedure for measuring the flux on the difference images is not central to the nn2 method we present here .    in order to find an optimal @xmath6",
    ", we wish to minimize the quantity @xmath10 this construction may not be entirely appropriate depending on the errors in the flux differences @xmath11 .",
    "ideally , if we possessed an extremely high - quality template with no sn flux present and applied an optimal subtraction procedure , the errors would be primarily due to photon counting statistics ( see @xcite for a discussion ) .",
    "we would expect these errors to be uncorrelated and would simply wish to employ the single - template method to construct the sn light curve . as mentioned in the introduction , in practice",
    "there are nearly always imperfections associated with the template image that remove us from this idealized regime .",
    "these template errors introduce correlations in the individual flux measurement errors that are difficult to quantify and are typically assumed to be negligible in sn light - curve analysis .",
    "the use of the nn2 method , however , will introduce further correlations as a result of the common images in the various subtractions ( for instance , the error in @xmath12 will be anti - correlated with the error in @xmath13 due to the common error in @xmath14 ) .",
    "although we believe that the use of the nn2 method will improve the ability to accurately recover variable object light curves , one should recognize that the nn2 method is expected to introduce these additional correlations to the fluxes measured from the various subtraction images , and so the @xmath15 given above is not technically appropriate .",
    "errors due to systematics in the subtraction procedure , such as those associated with template or software imperfections , would be expected to be effectively uncorrelated , and if they were dominant then eq .  [ eq : chi2 ] would indeed represent the proper @xmath15 . with these caveats in mind , we will proceed to use the definition of @xmath15 as given in eq .  [",
    "eq : chi2 ] as the basis of the nn2 method .",
    "tests of its ability to recover accurate light - curve information in the following section demonstrate its effectiveness in practice .",
    "however , we need to make one minor modification to our @xmath15 because the @xmath15 defined in eq .",
    "[ eq : chi2 ] is degenerate to the addition of a constant to the @xmath6 vector  geometrically , @xmath15 is constant along the line @xmath16 . in order to lift this degeneracy and permit us to solve for @xmath6",
    ", we add a term to @xmath15 that is quadratic in the degenerate direction , so that @xmath17 where @xmath18 is a suitable typical uncertainty ; for example , @xmath19 our solution will therefore have @xmath20 .",
    "this construction explicitly forces one to determine an accurate zero flux level at a later stage . in the single - template method",
    "this zero flux level is generally implicitly determined by assuming that the object of interest has zero flux in the template image .",
    "this same assumption can similarly be used in the nn2 method , but more sophisticated methods involving comparisons of many different images can also be invoked . if the absolute brightness of the variation being studied is important , the nn2 method clearly can not free one from the requirement of having a fiducial image to measure the zero flux level .",
    "this is a fundamental limitation of any differential photometry method as the information is simply not available without such a fiducial image .",
    "however , even in the absence of a fiducial image , the nn2 method will produce a sensible and accurate relative lightcurve .",
    "we now seek to solve for our lightcurve vector @xmath6 by minimizing @xmath15 with respect to @xmath6 : @xmath21 exploiting the antisymmetry of @xmath5 and the symmetry of @xmath8 we can rewrite eq .  [ eq : chi2v ] as @xmath22 these @xmath0 equations can be solved for @xmath6 by inverting a matrix @xmath23 : @xmath24 where @xmath25    the inverse of this curvature ( hessian ) matrix @xmath23 yields uncertainties for @xmath6 from the square root of the diagonal elements as well as covariances from normalizing the off - diagonal elements by the two diagonal terms ( under the assumption that the error matrix truly does represent gaussian , independent uncertainties for each of the terms of the antisymmetric difference matrix ) .",
    "an alternative approach to calculating uncertainties in @xmath6 stems from assuming that there is a vector @xmath26 such that @xmath27 under this assumption , we seek to minimize @xmath28 the minimization condition is @xmath29 these @xmath0 equations are solved by inverting a matrix @xmath30 @xmath31 where @xmath32    after solving for @xmath6 and @xmath26 , we can evaluate the quality of the fit by comparing @xmath15 to the number of degrees of freedom , @xmath33 this @xmath34 comes from the number of data points , @xmath1 , minus the number of model parameters , @xmath3 .",
    "recall that we ve explicitly required @xmath20 , so that the number of model parameters is @xmath3 rather than @xmath0 .",
    "having outlined the basic method , we now discuss a fundamental uncertainty in the nn2 process .",
    "we can imagine two types of error that will cause @xmath6 to differ from the true flux values .",
    "the first , which we term `` external error , '' is intrinsic to the images themselves .",
    "for example , if the object has a positive statistical fluctuation in flux in one image or is corrupted by a cosmic ray that happens to coincide with the position of the object on the detector , this error will propagate through the entire differencing and analysis procedure .",
    "it is possible to obtain an antisymmetric difference matrix that is an exact vector - term difference ( @xmath35 ) , but the solution vector will still contain errors .",
    "the second type of error , which we call `` internal error , '' is caused by the procedure of generating the antisymmetric matrix .",
    "one might imagine a set of images that have no flux error whatsoever , but through errors in convolving , differencing , or flux fitting , an antisymmetric matrix may be created that is not a perfect vector - term difference and for which @xmath36 .    roughly speaking , one might expect that if the error matrix @xmath8 consists entirely of external errors the resulting @xmath26 terms will all be approximately @xmath37 , since @xmath8 is the quadrature sum of two @xmath26 terms .",
    "alternatively , if the error matrix is purely internal error the @xmath26 terms might be expected to be approximately @xmath38 , since each term in @xmath6 comes from comparison with @xmath3 other images . in the case of external errors ,",
    "the uncertainties derived from the @xmath39 analysis are correct . in the internal error case",
    "the uncertainties obtained from the covariance matrix derived from the @xmath15 analysis are likewise appropriate .",
    "it is not clear how to disentangle these different sorts of errors .",
    "the procedure suggested above of dropping copies of the object into each difference image and evaluating the scatter of the result will be sensitive to each sort of error , but it is possible to imagine cases where this procedure is unsatisfactory .",
    "we suggest that the errors provided in the @xmath8 matrix be interpreted as external errors and taken seriously as such .",
    "thus , the vector @xmath6 is assigned an external uncertainty equal to the @xmath26 vector . however , in order to handle a situation where @xmath40 is much greater than 1 ( i.e. , where the antisymmetric matrix is simply _ not _ well represented as a vector - term difference ) , we suggest also creating an internal uncertainty vector @xmath41 that is obtained from the diagonal terms of the covariance matrix , scaled by @xmath40 :    @xmath42    the total uncertainty is then the quadrature sum of @xmath26 and @xmath41 .",
    "note that this approach implicitly assumes that the internal and external errors are uncorrelated and are proportional to one another as well as the provided @xmath8 matrix .    for problems where @xmath43 is near unity without adjustment",
    ", the @xmath41 vector will be smaller than the @xmath26 vector by approximately @xmath44 and will make a fairly small contribution to the total uncertainty .",
    "when @xmath45 ( i.e. , the antisymmetric matrix is very closely represented by the vector - term difference ) , the @xmath41 vector will be negligible .",
    "however , when @xmath46 , the @xmath41 vector will act to correct @xmath43 to approximately unity , and this procedure will provide reasonable uncertainties , even though @xmath8 may be much too small .",
    "the first extensive use of the nn2 method we have developed here occurred during the sn - search component of the ifa deep survey  @xcite , although we also employed it to a limited extent in a previous sn survey by @xcite .",
    "the ifa deep survey was undertaken primarily with suprime - cam  @xcite on the subaru 8.2-m telescope and was supplemented with the 12k camera  @xcite on the canada - france - hawaii 3.6-m telescope .",
    "scores of high - redshift sn candidates were discovered  @xcite with 23 confirmed as sne  ia .",
    "we here present several tests we performed to demonstrate the improved performance of nn2 relative to the single - template method .    in order to make a controlled test of the effectiveness of nn2 vs. the single - template method",
    ", we inserted artificial sne into the survey images .",
    "the light curves of these objects consisted of a linear ramp - up and ramp - down in brightness over the time period covered by the survey observations .",
    "the timing of the light - curve maxima were selected at random and could lie within or outside of the survey period .",
    "the simulated sne were laid down in a regular grid across the survey area , and all pairs of images were subtracted .",
    "object - detection software was then run on all subtraction images to detect photometrically variable objects ( both real objects and the artificial sne ) and to construct the nn2 flux difference matrix .",
    "the positions of both real and artificial sne were fit by the object - detection software as described in section  [ sec - math ] .",
    "since we knew the true light - curve properties used to create the synthetic sne , we could calculate the root - mean - square scatter ( rms ) around this artificial light curve using both the nn2 flux calculation and the single - template method with every individual observation as the template ( this latter is equivalent to taking the flux values from a single column of the nn2 flux difference matrix ) .",
    "we inserted approximately 2000 simulated sne into the @xmath47-band observations of each of four @xmath480.5 square - degree fields from the ifa deep survey , spanning a peak magnitude range of approximately @xmath49@xmath50 .",
    "we used a predefined grid of positions to insert the simulated sne , without taking into consideration the presence of actual objects nearby that would cause problems for detection and accurate photometric measurements .",
    "the small fraction that were so affected were accordingly not used in the final analysis .",
    "figure  [ fig : fakehisto ] shows the percentage improvement in the cumulative distributions of the rms ( in flux units ) from the nn2 method over the set of all rms values from the single - template method from the four survey fields ( rms values are calculated from flux measurements scaled so that a value of @xmath51 corresponds to a magnitude of @xmath50 ) . the cumulative fraction for the nn2 method is larger than that for the single - template method distribution at all values of rms , indicating that the nn2 method does indeed tend to yield @xmath52 rms values .",
    "the nn2 method more accurately recovers the actual light curve of these variable objects .",
    "since one could imagine that certain templates of very high quality could outperform the nn2 method while the collection of all single - template measurements , as shown in fig .",
    "[ fig : fakehisto ] , does not , we next examine the relationship between the nn2 rms and the single - template rms for individual observations . to illustrate this comparison ,",
    "we will concentrate on only one of the survey fields , although details of our investigation of the entire survey area can be found in @xcite .",
    "table  [ table : obsinfo-0438 ] contains relevant information for the 16 observations of the selected field , f0438 .",
    "this field is representative of the entire survey area , though it is notable that it contains an observation that was quite strongly affected by clouds ( observation 4 ) , as seen by its unusually bright zero - point magnitude . also noteworthy",
    "is observation 11 , taken in poor seeing conditions .",
    "we would expect the performance of the single - template method using these observations to be poor in comparison to the nn2 procedure .    in table",
    "[ table : obsinfo-0438 ] we demonstrate that the typical rms obtained with the nn2 method for the set of 1775 simulated sne is smaller than the single - template method rms using @xmath2 observation of the selected field .",
    "the improvement is generally fairly small , ranging from @xmath53% .",
    "we demonstrate below that these differences are statistically significant .",
    "the use of either observations 4 and 11 as single templates , as expected , produces substantially worse results relative to the nn2 method than the other observations . for these observations the improvement due to",
    "the nn2 method is substantially larger than 10% .",
    "figure  [ fig : rmscumfake-0438 ] shows graphically the percentage difference in the cumulative rms distributions , similar to figure  [ fig : fakehisto ] , for each individual observation of f0438 .",
    "having demonstrated the improved performance of the nn2 method , we can test the statistical significance of the differences between the nn2 rms values and those calculated via the single - template method and examine whether these differences indicate an actual difference in the distributions of the results from the two methods .",
    "to do so we use the non - parametric kolmogorov - smirnov ( k - s ) test , with results given in table  [ table : ksinfo-0438 ] .",
    "for the sample of all single - template rms values compared to nn2 , the k - s probability value is @xmath54 , indicating with strong confidence that the distributions are different .",
    "we also divide the sample into magnitude bins , since the relative behavior of nn2 rms to single - template rms is expected to be sensitive to the object s s / n and hence to the magnitude for a given sensitivity .",
    "the k - s probability values for three approximately equal magnitude bins show that for each of the subsamples the difference between nn2 and the single - template method is statistically significant , increasingly so at fainter magnitudes .",
    "finally , we compare each observation individually with the nn2 method and see again that the observed improvement in rms with nn2 is highly significant for nearly all observations ( the only obvious potential exception is observation 8) .",
    "these k - s probability values demonstrate that the nn2 method is not distributed identically to the single - template method , and the differences in median values given in table  [ table : obsinfo-0438 ] are indeed indicative of statistically significant differences in the distributions .",
    "this test confirms that the nn2 method truly does produce improved results in generating differential light curves .",
    "we have described the mathematical foundation of a new method for constructing the light curves of photometrically variable objects .",
    "this method uses all @xmath1 possible subtractions involving @xmath0 images in order to calculate a vector of fluxes of the variable object and offers a powerful alternative to the single - template method that is in standard use for studying variable sources .",
    "if one has a data set with a limited number of good fiducial observations , the nn2 method will outperform any single - template subtraction approach . for cases where a large number of fiducial observations are available to construct a deep template image , the nn2 method and the single - template approach using this deep template should yield comparable results .",
    "in this situation we would encourage the use of both methods to provide additional checks and constraints on the differential light curve .",
    "we have tested the performance of the nn2 method by inserting artificial sne into images from the ifa deep survey and comparing the rms scatter from flux measurements using the two different methods .",
    "we find that the rms from the nn2 method is better than the single - template rms for the large majority ( typically 65%-72% ) of the sne for every possible template .",
    "the median values for the ratio of nn2 rms ( in flux units ) to single - template rms measurements are typically @xmath55@xmath56 , demonstrating that the nn2 method results in a @xmath57% improvement in the accuracy of the recovered light curve for these observations .    using kolmogorov - smirnov statistics ,",
    "we have demonstrated that these differences are significant , reflecting an actual difference between the performance of the two methods .",
    "we find extremely high probabilities that the nn2 rms is distributed significantly differently from the single - template rms values .",
    "this difference and improvement in rms holds even for the very high quality templates that would be considered ideal for the single - template method .",
    "when working with high - quality observations , with small external error , the internal errors ( such as those due to implementation of the subtraction process ) dominate .",
    "if these errors are large , the nn2 method should outperform the single - template method to a large degree .",
    "if these errors are kept small , as we believe is possible based our extensive experience with sn surveys , then the nn2 method will result in a modest but significant improvement in accuracy of light - curve recovery .    in summary ,",
    "the nn2 method we present here maximizes the time variability information contained in a series of observations by using the relative differences between all pairs of images to construct the optimal differential light curve .",
    "references                                      cccccc 1 & 52164.57 & 0.75 & 30.48 & 0.441 & 0.951 + 2 & 52176.49 & 0.72 & 30.05 & 0.432 & 0.963 + 3 & 52191.50 & 0.71 & 30.12 & 0.427 & 0.970 + 4 & 52198.56 & 0.59 & 27.63 & 0.810 & 0.625 + 5 & 52204.59 & 0.63 & 30.46 & 0.424 & 0.973 + 6 & 52225.39 & 0.62 & 30.17 & 0.445 & 0.960 + 7 & 52231.38 & 0.51 & 30.46 & 0.455 & 0.944 + 8 & 52232.35 & 0.68 & 30.21 & 0.419 & 0.970 + 9 & 52236.34 & 0.94 & 30.36 & 0.440 & 0.938 + 10 & 52252.35 & 0.83 & 30.59 & 0.429 & 0.957 + 11 & 52263.38 & 1.14 & 30.33 & 0.515 & 0.839 + 12 & 52283.39 & 0.68 & 30.51 & 0.460 & 0.946 + 13 & 52288.23 & 0.84 & 30.65 & 0.438 & 0.941 + 14 & 52289.39 & 0.93 & 30.27 & 0.448 & 0.936 + 15 & 52323.35 & 0.97 & 30.23 & 0.468 & 0.908 + 16 & 52369.25 & 0.58 & 29.58 & 0.432 & 0.943 + [ table : obsinfo-0438 ]    rrccl 1775 & 28400 & all & 0.0769 & 4.7430e-09 + 482 & 7712 & @xmath59 & 0.0809 & 4.9083e-03 + 617 & 9872 & @xmath60 & 0.0897 & 1.5707e-04 + 676 & 10816 & @xmath61 & 0.1330 & 2.5150e-10 + 1775 & 1775 & @xmath62observation 1 & 0.0524 & 1.4698e-02 + 1775 & 1775 & @xmath62observation 2 & 0.0462 & 4.3869e-02 + 1775 & 1775 & @xmath62observation 3 & 0.0411 & 9.6888e-02 + 1775 & 1775 & @xmath62observation 4 & 0.3977 & @xmath631.0e-30 + 1775 & 1775 & @xmath62observation 5 & 0.0445 & 5.7717e-02 + 1775 & 1775 & @xmath62observation 6 & 0.0608 & 2.6510e-03 + 1775 & 1775 &",
    "@xmath62observation 7 & 0.0845 & 5.6244e-06 + 1775 & 1775 & @xmath62observation 8 & 0.0332 & 2.7611e-01 + 1775 & 1775 & @xmath62observation 9 & 0.0518 & 1.6326e-02 + 1775 & 1775 & observation 10 & 0.0417 & 8.9127e-02 + 1775 & 1775 & observation 11 & 0.1639 & 2.5672e-21 + 1775 & 1775 & observation 12 & 0.0794 & 2.4901e-05 + 1775 & 1775 & observation 13 & 0.0575 & 5.4234e-03 + 1775 & 1775 & observation 14 & 0.0710 & 2.4226e-04 + 1775 & 1775 & observation 15 & 0.0885 & 1.6592e-06 + 1775 & 1775 & observation 16 & 0.0541 & 1.0650e-02 + [ table : ksinfo-0438 ]"
  ],
  "abstract_text": [
    "<S> we present a new method for optimally extracting point - source time variability information from a series of images . </S>",
    "<S> differential photometry is generally best accomplished by subtracting two images separated in time , since this removes all constant objects in the field . by removing background sources such as the host galaxies of supernovae , such subtractions make possible the measurement of the proper flux of point - source objects superimposed on extended sources . in traditional difference photometry , </S>",
    "<S> a single image is designated as the `` template '' image and subtracted from all other observations . </S>",
    "<S> this procedure does not take all the available information into account and for sub - optimal template images may produce poor results . given @xmath0 total observations of an object , we show how to obtain an estimate of the vector of fluxes from the individual images using the antisymmetric matrix of flux differences formed from the @xmath1 distinct possible subtractions and provide a prescription for estimating the associated uncertainties . </S>",
    "<S> we then demonstrate how this method improves results over the standard procedure of designating one image as a `` template '' and differencing against only that image . </S>"
  ]
}