{
  "article_text": [
    "for any group @xmath1 generated by a subset @xmath2 one has the associated cayley graph , @xmath3 .",
    "this is the graph with vertex set @xmath1 and edges connecting any pair of elements which differ by right multiplication by a generator .",
    "there is a natural @xmath1 action on @xmath3 by left translation . by giving every edge length one ,",
    "the cayley graph can be made into a ( geodesic ) metric space .",
    "the distance on @xmath1 viewed as the vertices of the cayley graph is the _ word metric _ , defined via the norm :    @xmath4    different sets of generators give rise to different metrics and cayley graphs for a group but one wants these to be equivalent .",
    "the natural notion of equivalence in this category is _ quasi - isometry _ :    [ defn : qi ] let @xmath5 and @xmath6 be metric spaces . given real numbers @xmath7 and @xmath8,a map @xmath9 is called a _ @xmath10-quasi - isometry _ if    1 .",
    "@xmath11 for all @xmath12 and @xmath13 in @xmath14 , and , 2 .",
    "the @xmath15 neighborhood of @xmath16 is all of @xmath17 .",
    "this paper begins the proofs of results announced in @xcite by developing the technique of _ coarse differentiation _",
    "first described there .",
    "proofs of some of the results in @xcite are continued in @xcite .",
    "even though quasi - isometries have no local structure and conventional derivatives do not make sense , we essentially construct a ",
    "coarse derivative \" that models the large scale behavior of the quasi - isometry .",
    "a natural question which has arisen in several contexts is whether there exist spaces not quasi - isometric to cayley graphs .",
    "this is uninteresting without some assumption on homogeneity on the space , since cayley graphs clearly have transitive isometry group . in this paper",
    "we prove that two types of spaces are not quasi - isometric to cayley graphs .",
    "the first are non - unimodular three dimensional solvable groups which do not admit left invariant metrics of nonpositive curvature .",
    "the second are the diestel - leader graphs , homogeneous graphs first constructed in @xcite where it was conjectured that they were not quasi - isometric to any cayley graph .",
    "we prove this conjecture , thereby answering a question raised by woess in @xcite .",
    "our work is also motivated by the program initiated by gromov to study finitely generated groups up to quasi - isometry @xcite .",
    "much interesting work has been done in this direction , see e.g. @xcite . for a more detailed discussion of history and motivation , see @xcite .",
    "we state our results for solvable lie groups first as it requires less discussion :    [ theorem : nolattice ] let @xmath18 be a solvable lie group where the @xmath19 action on @xmath20 is defined by @xmath21 for for @xmath22 with @xmath23 .",
    "then there is no finitely generated group @xmath1 quasi - isometric to @xmath24 .",
    "if @xmath25 and @xmath26 , then @xmath24 admits a left invariant metric of negative curvature . the fact that there is no finitely generated group quasi - isometric to @xmath27 in this case , provided @xmath28 , is a result of kleiner @xcite , see also @xcite .",
    "when @xmath29 , the group @xmath30 contains cocompact lattices which are ( obviously ) quasi - isometric to @xmath30 . in the sequel to this paper",
    "we prove that any group quasi - isometric to @xmath30 is virtually a lattice in @xmath30 @xcite .",
    "many of the partial results in this paper hold for @xmath31 and are used in that paper as well . note that the assumption @xmath32 is only to fix orientation and that the case @xmath33 can be reduced to this one by changing coordinates .",
    "we also obtain the following , which is an immediate corollary of ( * ? ? ?",
    "* theorem 5.1 ) and theorem  [ theorem : qisol ] below :    [ theorem : different : sol : not : qi ] @xmath24 is quasi - isometric to @xmath34 if and only if @xmath35 .    before stating the next results",
    ", we recall a definition of the diestel - leader graphs , @xmath36 . in this",
    "setting , @xmath37 and we assume @xmath31 .",
    "let @xmath38 and @xmath39 be regular trees of valence @xmath40 and @xmath41 respectively .",
    "choose orientations on the edges of @xmath38 and @xmath39 so each vertex has @xmath42 ( resp .",
    "@xmath43 ) edges pointing away from it .",
    "this is equivalent to choosing ends on these trees .",
    "we can view these orientations as defining height functions @xmath44 and @xmath45 on the trees ( the busemann functions for the chosen ends ) .",
    "if one places the point at infinity determining @xmath44 at the bottom of the page and the point at infinity determining @xmath45 at the top of the page , then the trees can be drawn as :    .",
    "figure borrowed from @xcite.,width=528 ]    the graph @xmath36 is the subset of the product @xmath46 defined by @xmath47",
    ". there is strong analogy with the geometry of solvable groups which is made clear in section @xmath48 .",
    "[ theorem : dl ] there is no finitely generated group quasi - isometric to the graph @xmath36 for @xmath49 .",
    "for @xmath50 the diestel - leader graphs arise as cayley graphs of lamplighter groups @xmath51 for @xmath52 .",
    "this observation was apparently first made by r.moeller and p.neumann @xcite and is described explicitly , from two slightly different points of view , in @xcite and @xcite . in @xcite",
    "we classify lamplighter groups up to quasi - isometry and prove that any group quasi - isometric to a lamplighter group is a lattice in @xmath53 for some @xmath42 .",
    "as discussed above , many of the technical results in this paper are used in those proofs .",
    "we also obtain the following analogue of theorem  [ theorem : different : sol : not : qi ] :    [ theorem : different : dl : not : qi ] @xmath36 is quasi - isometric to @xmath54 if and only if @xmath43 and @xmath55 are powers of a common integer , @xmath42 and @xmath56 are powers of a common integer , and @xmath57 .    unlike theorem [ theorem : different : sol :",
    "not : qi ] , the proof of this theorem is not completed in this paper .",
    "the case when @xmath29 here requires additional arguments . for solvable groups ,",
    "@xmath30 is always quasi - isometric to @xmath58 for all @xmath42 and @xmath56 . as indicated by the statement of the theorem ,",
    "this is not true for @xmath59 and @xmath60 which are only quasi - isometric when @xmath42 and @xmath56 are powers of a common integer .",
    "this last statement is only proven in @xcite .",
    "first author partially supported by nsf grant dms-0244542 .",
    "second author partially supported by nsf grants dms-0226121 and dms-0541917 .",
    "third author partially supported by nsf grant dms-0349290 and a sloan foundation fellowship .",
    "the first two named authors would also like to thank the institute of advanced study at princeton and the math departments at ens - paris and paris - orsay for hospitality while this paper was being completed .",
    "the authors also thank russ lyons for useful conversations concerning diestal - leader graphs and jen taback for comments on an early version of the manuscript .",
    "a typical step in the study of quasi - isometric rigidity of groups is the identification of all quasi - isometries of some space @xmath14 quasi - isometric to the group , see  [ section : atinfinity ] for more details . for us ,",
    "the space @xmath14 is either a solvable lie group @xmath24 or @xmath36 . in all of these examples there",
    "is a special function @xmath61 which we call the height function and a foliation of @xmath14 by level sets of the height function .",
    "we will call a quasi - isometry of any of these spaces _ height respecting _ if it permutes the height level sets to within bounded distance ( in @xcite , the term used is horizontal respecting ) . for technical reasons , it is convenient to consider the more general question of quasi - isometries @xmath62 .    for @xmath24 ,",
    "the height function is @xmath63 .",
    "[ theorem : qisol ] for any @xmath64 , any @xmath10-quasi - isometry @xmath65 is within bounded distance of a height respecting quasi - isometry @xmath66 .",
    "furthermore , this distance can be taken uniform in @xmath10 and therefore , in particular , @xmath67 is a @xmath68-quasi - isometry where @xmath69 depend only on @xmath70 and @xmath15 and on @xmath43 , @xmath42 , @xmath55 , @xmath56 .",
    "the proof of theorem [ theorem : qisol ] is completed in this paper in the case @xmath23 .",
    "the remaining case , @xmath29 , is more difficult and is treated in @xcite .",
    "most of the argument here applies in both cases and the only difference occurs at what is labelled `` step  ii '' below .",
    "in fact , theorem [ theorem : qisol ] can be used to identify the self quasi - isometries of @xmath24 completely .",
    "we will need the following definition :    a map @xmath71 is called a _ product map _ if it is of the form @xmath72 or @xmath73 , where @xmath74 , @xmath75 and @xmath76 are functions from @xmath77 . a product map @xmath78 is called _",
    "@xmath79-standard _ if it is the compostion of an isometry with a map of the form @xmath80 , where @xmath74 and @xmath75 are bilipshitz with the bilipshitz constant bounded by @xmath79 .",
    "it is easy to see that any height - respecting quasi - isometry is at a bounded distance from a standard map , and the standard maps from @xmath24 to @xmath24 form a group which is isomorphic to @xmath81 when @xmath29 and @xmath82 otherwise . given a metric space @xmath14 , one defines @xmath83 to be the group of quasi - isometries of @xmath14 modulo the subgroup of those at finite distance from the identity .",
    "theorem  [ theorem : qisol ] then implies that @xmath84 when @xmath29 and @xmath85 otherwise .",
    "this explicit description was conjectured by farb and mosher in the case @xmath29 .",
    "recall that @xmath36 is defined as the subset of @xmath86 where @xmath87 where @xmath44 and @xmath45 are busemann functions on @xmath88 and @xmath89 respectively .",
    "we fix the convention that busemann functions decrease as one moves toward the end from which they are defined .",
    "we set @xmath90 which makes sense exactly on @xmath91 .",
    "note that in this choice @xmath88 branches downwards and @xmath89 branches upwards .",
    "the reader can verify that the level sets of the height function are orbits for a subgroup of @xmath92 .",
    "[ theorem : qidl ] for any @xmath31 , any @xmath10-quasi - isometry @xmath93 from @xmath36 to @xmath54 is within bounded distance of a height respecting quasi - isometry @xmath94 .",
    "furthermore , the bound is uniform in @xmath70 and @xmath15 .    * remark : * as above ,",
    "this is proven here when @xmath23 and in @xcite when @xmath29 .",
    "the discussion of standard and product maps in the setting of @xmath36 is slightly more complicated .",
    "we let @xmath95 be the @xmath96-adic rationals .",
    "the complement of a point in the boundary at infinity of @xmath97 is easily seen to be @xmath95 .",
    "let @xmath98 be a point in @xmath99 and @xmath100 a point in @xmath101 .",
    "there is a unique vertical geodesic in @xmath36 connecting @xmath98 to @xmath100 . to specify a point in @xmath36 it suffices to specify @xmath102 and a height @xmath103 .",
    "we will frequently abuse notation by referring to the @xmath104 coordinate of a point in @xmath36 even though this representation is highly non - unique .",
    "theorem [ theorem : qidl ] can be used to identify the quasi - isometries of @xmath36 completely .",
    "we need to define product and standard maps as in the case of solvable groups , but there is an additional difficulty introduced by the non - uniqueness of our coordinates .",
    "this is that maps of the form @xmath105 , even when one assumes they are quasi - isometries , are not well - defined .",
    "different coordinates for the same points will give rise to different images .",
    "we will say a quasi - isometry @xmath106 is _ at bounded distance _ from a map of the form @xmath72 if @xmath107 is uniformly bounded for all points and all choices @xmath108 of coordinates representing each point .",
    "it is easy to check that @xmath72 is defined up to bounded distance if we assume that the resulting map of @xmath36 is a quasi - isometry .",
    "the bound depends on @xmath109 and @xmath56 .",
    "a map @xmath110 is called a _",
    "product map _ if it is within bounded distance of the form @xmath111 or or @xmath112 , where @xmath113 ( or @xmath114 ) , @xmath115 ( or @xmath116 ) and @xmath117 .",
    "a product map @xmath78 is called _",
    "@xmath79-standard _ if it is the compostion of an isometry with a map within bounded distance of one of the form @xmath118 , where @xmath74 and @xmath75 are bilipshitz with the bilipshitz constant bounded by @xmath79 .",
    "any height - respecting quasi - isometry is at a bounded distance from a standard map , and the standard self maps of @xmath36 form a group which is isomorphic to @xmath119 when @xmath29 and @xmath120 otherwise .",
    "theorem  [ theorem : qisol ] implies that @xmath121 unless @xmath29 when @xmath122 .",
    "in this section we describe the geometry of @xmath24 and @xmath36 , with emphasis on the geometric facts used in our proofs . in this section",
    "we allow the possibility that @xmath29 .",
    "the upper half plane model of the hyperbolic plane @xmath123 is the set @xmath124 with the length element @xmath125 .",
    "if we make the change of variable @xmath126 , we get @xmath20 with the length element @xmath127 .",
    "this is the _ log model _ of the hyperbolic plane @xmath123 .",
    "note that changing @xmath128 to @xmath129 we are choosing another metric of constant negative curvature , but changing the value of the curvature .",
    "this can be seen by checking that the substitution @xmath130 is a homothety .",
    "the length element of @xmath24 is : @xmath131 thus planes parallel to the @xmath132 plane are hyperbolic planes in the log model .",
    "planes parallel to the @xmath133 plane are _ upside - down _ hyperbolic planes in the log model . when @xmath28 , these two families of hyperbolic planes have different normalization on the curvature .",
    "all of these copies of @xmath123 are isometrically embedded and totally geodesic .",
    "* we use @xmath134 coordinates on @xmath24 , with @xmath103 called the _ height _ , and @xmath98 called the _ depth_. the planes parallel to the @xmath135 plane are right - side up hyperbolic planes ( in the log model ) , and the planes parallel to the @xmath136 plane are upside - down hyperbolic planes ( also in the log model ) .",
    "* by `` distance '' , `` area '' and `` volume '' we mean these quantities in the @xmath24 metric",
    ".    we will refer to lines parallel to the @xmath98-axis as @xmath98-horocycles , and to lines parallel to the @xmath100-axis as @xmath100-horocycles .",
    "this terminology is justified by the fact that each ( @xmath98 or @xmath100)-horocycle is indeed a horocycle in the hyperbolic plane which contains it .",
    "we now turn to a discussion of geodesics and quasi - geodesics in @xmath24 .",
    "any geodesic in an @xmath123 leaf in @xmath24 is a geodesic .",
    "there is a special class of geodesics , which we call _ vertical geodesics_. these are the geodesics which are of the form @xmath137 or @xmath138 .",
    "we call the vertical geodesic _ upward oriented _ in the first case , and _ downward oriented _ in the second case . in both cases ,",
    "this is a unit speed parametrization .",
    "each vertical geodesic is a geodesic in two hyperbolic planes , the plane @xmath139 and the plane @xmath140 .",
    "certain quasi - geodesics in @xmath24 are easy to describe . given two points @xmath141 and @xmath142 , there is a geodesic @xmath143 in the hyperbolic plane @xmath139 that joins @xmath141 to @xmath144 and a geodesic @xmath145 in the plane @xmath146 that joins @xmath144 to a @xmath142 .",
    "it is easy to check that the concatenation of @xmath143 and @xmath145 is a quasi - geodesic . in first matching the @xmath98 coordinates and then matching the @xmath100 coordinates , we made a choice .",
    "it is possible to construct a quasi - geodesic by first matching the @xmath100 coordinates and then the @xmath98 coordinates .",
    "this immediately shows that any pair of points not contained in a hyperbolic plane in @xmath24 can be joined by two distinct quasi - geodesics which are not close together .",
    "this is an aspect of positive curvature .",
    "one way to prove that the objects just constructed are quasi - geodesics is to note the following : the pair of projections @xmath147 onto the @xmath132 and @xmath133 coordinate planes can be combined into a quasi - isometric embedding @xmath148 .",
    "this entire discussion is easily mimicked in @xmath36 by replacing geodesics and horocycles in hyperbolic planes with geodesics and horocycles in the corresponding trees .",
    "when we want to state a fact that holds both for @xmath24 and @xmath36 , we refer to the _ model space _ which we denote by @xmath149 .",
    "we define the upper boundary @xmath150 as the set of equivalence classes of vertical geodesic rays going up ( where two rays are considered equivalent if they are bounded distance apart ) .",
    "the lower boundary @xmath151 is defined similarly .",
    "it is easy to see that if @xmath152 case , @xmath153 and @xmath154 .",
    "if @xmath155 , then @xmath156 and @xmath157 . as discussed in section [ section",
    ": qis ] , if @xmath158 , @xmath159 and @xmath160 , we can define @xmath161 as the point at height @xmath103 on the unique vertical geodesic connecting @xmath98 and @xmath100 .",
    "* landau asymptotic notation .",
    "* in the following lemma and throughout the paper , we use the notation @xmath162 to mean that @xmath163 where @xmath164 is a constant depending only on the quasi - isometry constants @xmath10 of @xmath165 and on the model space or spaces ( i.e. on @xmath43,@xmath42 , @xmath55 , @xmath56 ) .",
    "we use the notation @xmath166 to mean that @xmath167 , where @xmath168 depends on the same quantities as @xmath164 .",
    "we also use the notation @xmath169 and @xmath170 with the same meaning of the implied constants .",
    "we state here a key geometric fact used at various steps in the proof .",
    "[ lemma : quadrilateral ] let @xmath171 depending only on @xmath172 .",
    "suppose @xmath173 and @xmath174 \\to { \\operatorname{x}(m',n')}$ ] are vertical geodesic segments parametrized by arclength .",
    "suppose @xmath175 and @xmath176 .",
    "assume that for @xmath177 , @xmath178 , @xmath179 so that @xmath180 connects the @xmath15-neighborhood of @xmath181 to the @xmath182-neighborhood of @xmath183 .",
    "further assume that for @xmath177 and all @xmath184 , @xmath185 ( so that for each @xmath186 , the two segments leaving the neighborhood of @xmath181 diverge right away ) .",
    "then there exists @xmath187 such that exactly one of the following holds :    * all four @xmath180 are upward oriented , and @xmath188 is within @xmath189 of the @xmath98-horocycle passing through @xmath190 . *",
    "all four @xmath180 are downward oriented , and @xmath188 is within @xmath189 of the @xmath100-horocycle passing through @xmath190 .",
    "we think of @xmath191 and @xmath192 as defining a quadrilateral .",
    "the content of the lemma is that any quadrilateral has its four `` corners '' in pairs that lie essentially along horocycles .",
    "in particular , if we take a quadrilateral with geodesic segments @xmath180 and with @xmath193 and @xmath194 and map it forward under a @xmath10-quasi - isometry @xmath195 , and if we would somehow know that @xmath165 sends each of the four @xmath180 close to a vertical geodesic , then lemma  [ lemma : quadrilateral ] would imply that @xmath165 sends the @xmath181 to a pair of points at roughly the same height .    to prove lemma  [ lemma : quadrilateral ] , we require a combinatorial lemma .",
    "[ lemma : complete : bipartite : graphs ] let @xmath196 be an oriented graph with four vertices @xmath197 and four edges , such that there is exactly one edge connecting each @xmath181 to each @xmath183 . then exactly one of the following is true :    * all the edges of @xmath196 are from some @xmath181 to some @xmath183 .",
    "* all the edges of @xmath196 are from some @xmath183 to some @xmath181 .",
    "* there exist two vertices @xmath198 and @xmath199 which are connected by two distinct directed paths , and at least of the the @xmath200 is @xmath190 or @xmath188 .    * proof . *",
    "since there are only 16 possibilities for @xmath196 , one can check directly .",
    "one way to organize the check is to let @xmath201 denote the sum of number of edges outgoing from @xmath190 and the number of edges outgoing from @xmath188 . if @xmath202 , ( ii ) holds , and if @xmath203 , then ( i ) holds .",
    "it is easy to check that for @xmath204 , ( iii ) holds .",
    "* proof of lemma  [ lemma : quadrilateral ] .",
    "* let us assume for the moment that all the geodesics are downward oriented .",
    "let @xmath205 , @xmath206 denote the @xmath98 and @xmath100 coordinates of the vertical geodesics @xmath180 . by the assumptions near @xmath181 we have for @xmath177 , @xmath207 , where @xmath208 . by the assumptions near @xmath183 we have for @xmath178 , @xmath209 where @xmath210 .",
    "note that since for all @xmath211 , @xmath212 , we have @xmath213 .",
    "these inequalities imply that @xmath214 , and also that @xmath215 .",
    "this proves the lemma under the assumption of downward orientation .",
    "the case where all the vertical geodesics are upward oriented is identical ( except that one considers differences in @xmath100-coordinates instead ) .    to reduce to the cases already considered ,",
    "we apply lemma  [ lemma : complete : bipartite : graphs ] to the graph @xmath196 consisting of the vertices @xmath190 , @xmath188 , @xmath216 , @xmath192 with edges the vertical geodesics  almost \" connecting them .",
    "suppose that possibility ( iii ) of lemma  [ lemma : complete : bipartite : graphs ] holds .",
    "then , we would then have two distinct oriented paths @xmath217 and @xmath218 connecting @xmath198 and @xmath199 . each @xmath219 is either a vertical geodesics , a concatenation two vertical geodesics , one of which ends near the beginning of the other , or a similar concatenation of three vertical geodesics . in each case",
    "it is easy to check that each @xmath219 is close to a vertical geodesic @xmath220 .",
    "( see lemma [ lemma : epsilon : monotone : segment ] for a more general variant of this fact . ) but this is a contradiction in view of the divergence assumptions , since any pair of vertical geodesics beginning and ending near the same point are close for their entire length .",
    "thus either ( i ) or ( ii ) of lemma  [ lemma : complete : bipartite : graphs ] holds .",
    "there is a large difference between the unimodular and nonunimodular examples we consider that has to do with the measures of sets , unimodularity and amenability . in the cases where @xmath29 the spaces we consider are metrically amenable and have unimodular isometry group . when @xmath221 the spaces are not metrically amenable and the isometry groups are not unimodular , though the isometry group remains amenable as a group .",
    "in particular it is immediately clear that @xmath222 can not be quasi - isometric to @xmath36 with @xmath49 ( since one has metric flner sets and the other does not ) .",
    "for the same reason , @xmath30 is not quasi - isometric to @xmath34 with @xmath223 .",
    "the natural volume @xmath224 on @xmath36 is the counting measure , the natural volume on @xmath24 is @xmath225 .",
    "note that for the unimodular case where @xmath29 , the volume on @xmath24 is just the standard volume on @xmath226 . in the case when @xmath227 we introduce a new measure .",
    "in the case of @xmath24 this is just @xmath228 .",
    "note that on @xmath103 level sets this is a rescaling of @xmath224 by a factor of @xmath229 .",
    "analogously on @xmath36 , we choose a height function @xmath230 and let @xmath231 be counting measure times @xmath232 .",
    "recall that we are assuming that @xmath31 .",
    "the measure @xmath231 is also introduced in @xcite and is natural for many problems .    we now define certain useful subsets of @xmath24 .",
    "let @xmath233 \\times [ -\\frac{e^{2nl}}{2},\\frac{e^{2nl}}{2 } ] \\times [ -\\frac{l}{2},\\frac{l}{2}]$ ] . when @xmath29 , then @xmath234 and @xmath235 , so @xmath236 is a flner set .    to define the analogous object in @xmath36 , we look at the set of points in @xmath36 we fix a basepoint @xmath237 and a height function @xmath238 with @xmath239 .",
    "let @xmath240 be an even integer and let @xmath241 be the @xmath242)$ ] .",
    "then @xmath243 is the connected component of @xmath244 in @xmath241 .",
    "we are assuming that the top and bottom of the box are midpoints of edges , to guarantee that they have zero measure .",
    "we call @xmath245 a box of size @xmath240 centered at the identity . in @xmath24",
    ", we define the box of size @xmath240 centered at a point @xmath246 by @xmath247 where @xmath248 is left translation by @xmath246 .",
    "we frequently omit the center of a box in our notation and write @xmath236 . for the case of @xmath36",
    "it is easiest to define the box @xmath249 directly .",
    "that is let @xmath250}=h^{{^{-1}}}([h(p)-\\frac{l+1}{2},h(p)+\\frac{l+1}{2}])$ ] and let @xmath249 be the connected component of @xmath246 in @xmath251}$ ] .",
    "it is easy to see that isometries of @xmath36 carry boxes to boxes .",
    "we record the following lemma which holds for any model space @xmath149 .",
    "[ lemma : box : amenable ] when @xmath29 , the fraction of the volume of @xmath236 which is within @xmath252 of the boundary of @xmath236 is @xmath253 . in all other cases ,",
    "this is true for the @xmath231-measure but not the volume .",
    "we first describe @xmath236 in the case of @xmath24 . in this case , the top of @xmath236 , meaning the set @xmath254 \\times [ -\\frac{e^{2nl}}{2},\\frac{e^{2nl}}{2 } ] \\times \\{\\frac{l}{2}\\}$ ] , is not at all square - the sides of this rectangle are horocyclic segments of lengths @xmath255 and @xmath256 - in other words it is just a small metric neighborhood of a horocycle . similarly , the bottom is also essentially a horocycle but in the transverse direction .",
    "further , we can connect the @xmath256-neighborhood of any point of the top horocycle to the @xmath256-neighborhood of any point of the bottom horocycle by a vertical geodesic segment , and these segments essentially sweep out the box @xmath236 .",
    "this picture is even easier to understand in the diestel - leader graphs @xmath222 , where the boundary of the box is simply the union of the top and bottom `` horocycles '' , and the vertical geodesics in the box form a complete bipartite graph between the two .",
    "thus a box @xmath236 contains a very large number of quadrilaterals .",
    "the purpose of this subsection is to prove the following lemma .",
    "[ lemma : tiling ] choose @xmath257 .",
    "we can write @xmath258 where @xmath259 and the implied constant depends only on the model space .    in the case",
    "when @xmath260 , then @xmath261 can be chosen to be empty .",
    "( this is also possible for @xmath24 if @xmath262 and @xmath263 are integers . )    * remark : * we will always refer to a decomposition as in equation ( [ eqn : tiling ] ) as a _ tiling _ of @xmath236 .",
    "we often omit specific reference to the set @xmath261 when discussing tilings .    * proof . * for simplicity of notation , we assume @xmath236 is centered at the origin .",
    "we give the proof first in the case of @xmath36 where it is almost trivial . since @xmath264 , we can partition @xmath265 $ ] into subsegments of length @xmath266 which we label @xmath267 where @xmath268 .",
    "we can then look at the sets @xmath269 .",
    "each connected component of @xmath270 is clearly a box @xmath271 of size @xmath266 .",
    "each @xmath271 is either entirely inside or entirely outside of @xmath236 .",
    "we choose only those @xmath201 for which @xmath272 .",
    "it is also clear that , after reindexing , we have chosen boxes such that @xmath273 .    in @xmath24 the proof is similar , though does not in general give an exact tiling .",
    "we simply take the box @xmath236 and cover it as best possible with boxes of size @xmath266 . since @xmath264 , if we take @xmath274 and look at translates by @xmath275 for @xmath276 an integer between @xmath277 and @xmath278 , the resulting boxes are all in @xmath236 .",
    "we then take the resulting box @xmath279 at height @xmath201 and translate it by vectors of the form @xmath280 where @xmath281 and @xmath282 are integers .",
    "this results in boxes @xmath283 which we re - index as @xmath284 .",
    "it is clear that every point not in @xmath285 is within @xmath266 of the boundary of @xmath236 . letting @xmath286",
    "we have that @xmath287 by lemma [ lemma : box : amenable ] .",
    "all the results of this section hold for @xmath149 with @xmath31 , so in particular for the case @xmath29 .",
    "the case @xmath29 will be used in the sequel @xcite .",
    "also , all results in this section hold for quasi - isometric embeddings , i.e. maps satisfying @xmath288 but not @xmath289 of definition [ defn : qi ] . in the this part of the paper ,",
    "our aim is to prove the following :    [ theorem : main : step : one ] suppose @xmath290 , @xmath291 .",
    "then there exist constants @xmath292 ( depending on @xmath293 , @xmath294 , @xmath70 , @xmath15 and the model spaces ) such that the following holds : let @xmath295 be a @xmath10 quasi - isometry and suppose @xmath296 is sufficiently large ( depending on @xmath70 , @xmath15 , @xmath293 , @xmath294 ) .",
    "then for any @xmath297 and any @xmath236 , there exists @xmath266 with @xmath298 such that if one tiles @xmath299 then there exists a subset @xmath300 of @xmath301 with @xmath302 so that for any @xmath303 there exists @xmath304 with @xmath305 and a product map @xmath306 such that @xmath307    * remarks . *",
    "this theorem says that every sufficiently large box @xmath236 can be tiled by much smaller boxes @xmath284 , and for most ( i.e. @xmath308 fraction ) of the smaller boxes @xmath284 there exist a subset @xmath309 containing @xmath308 fraction of the @xmath231-measure of @xmath284 on which the map is a product map , up to error @xmath310 . in the case where @xmath50 , the measure of @xmath284 is independent of @xmath186 , and we have exactly @xmath311 .",
    "when @xmath28 , both the number of boxes of size @xmath266 in a height level set tiling and @xmath312 are functions of height .",
    "we note here that it is possible to apply the proof of theorem [ theorem : main : step : one ] simultaneously to a finite collection @xmath313 of boxes @xmath314 all of the same size and obtain the same conclusions ( with the same constants ) on most of the boxes in @xmath313 .",
    "as long as @xmath29 , by most boxes in @xmath313 we mean most boxes with the counting measure on @xmath313 . this observation will be used in @xcite .",
    "one should note that the number @xmath266 , and the subset where we control the map , depends on @xmath165 .",
    "also in theorem  [ theorem : main : step : one ] there is no assertion that the product maps @xmath315 on the different boxes @xmath284 match up .",
    "this theorem is in a sense an analogue of rademacher s theorem that a lipschitz function ( or map ) is differentiable almost everywhere .",
    "the boxes @xmath284 with @xmath316 should be thought of as coarse analogues of points of differentiability .",
    "we begin by discussing some quantative estimates on the behavior of quasi - geodesic segments in @xmath317 ( or equivalently in @xmath149 ) . throughout the discussion",
    "we assume @xmath318 \\to { \\operatorname{x}(m',n')}$ ] is a @xmath10-quasi - geodesic segment for a fixed choice of @xmath10 , i.e. @xmath319 is a quasi - isometric embedding of @xmath320 $ ] into @xmath317 .",
    "a quasi - isometric embedding is a map that satisfies point @xmath288 in definition [ defn : qi ] but not point @xmath289 .",
    "all of our quasi - isometric embeddings are assumed to be continuous .",
    "a quasigeodesic segment @xmath321 \\to    { \\operatorname{x}(m',n')}$ ] is @xmath294-monotone if for all @xmath322 $ ] with @xmath323 we have @xmath324 .",
    "-monotone.,width=96 ]    in  [ sec : staircase ] and  [ sec : fullmeasure ] we will also need a variant . the reader may safely ignore this variant on first reading this section .",
    "[ def : weakly : eta : monotone ] a quasigeodesic segment @xmath325 \\to    { \\operatorname{x}(m',n')}$ ] is _ weakly @xmath326-monotone _ if for any two points @xmath327 with @xmath328 , we have @xmath329 .    * remark * : an @xmath294-monotone quasi - geodesic @xmath318{\\rightarrow}{\\operatorname{x}(m',n')}$ ] is a weakly @xmath330-monotone quasi - geodesic .",
    "the following fact about @xmath331-monotone geodesics is an easy exercise in hyperbolic geometry :    [ lemma : epsilon : monotone : segment ] @xmath332    * suppose @xmath321 \\to    { \\operatorname{x}(m',n')}$ ] is an @xmath294-monotone quasi - geodesic segment .",
    "then , there exists a vertical geodesic segment @xmath333 in @xmath317 such that @xmath334 , where @xmath335 depends only on the model space @xmath317 . *",
    "suppose @xmath321 \\to    { \\operatorname{x}(m',n')}$ ] is a weakly @xmath326-monotone quasi - geodesic segment .",
    "then , there exists a vertical geodesic segment @xmath333 in @xmath317 such that @xmath336 , where @xmath337 depends only on @xmath317 .",
    "* proof . * both @xmath294-monotone and weakly @xmath338-monotone imply that the projections of @xmath319 onto both @xmath132 and @xmath133 hyperbolic planes are quasi - geodesics .",
    "the result is then a consequence of the mostow - morse lemma and the fact that the only geodesics shared by both families of hyperbolic planes are vertical geodesics .",
    "one can also prove the lemma by direct computation .",
    "* remark : * the distance @xmath339 in ( a ) is the hausdorff distance between the sets and does not depend on parametrizations . however , the parametrization on @xmath333 implied in ( b ) is not neccessarily by arc length .",
    "[ lemma : subdivision ] suppose @xmath321 \\to { \\operatorname{x}(m',n')}$ ] is a quasi - geodesic segment which is not @xmath294-monotone and @xmath340 .",
    "suppose @xmath341 ( depending on @xmath294 , @xmath70 , @xmath15 ) .",
    "then @xmath342    informally , the proof amounts to the assertion that if @xmath343 is sufficiently large , the total variation of the height increases after the subdivision by a term proportional to @xmath294 .",
    "see figure  [ fig : subdivision ] .    ,",
    "width=96 ]    * proof . * without loss of generality , we may assume that @xmath344 , where @xmath345 ( if not , parametrize in the opposite direction ) .",
    "since @xmath346 , @xmath347 and @xmath348 are two points in @xmath317 which are at the same height and are at least @xmath349 apart .",
    "then , by @xmath317 geometry , any quasigeodesic path connecting @xmath347 and @xmath348 must contain a point @xmath76 such that @xmath350 .",
    "hence , there exists a point @xmath351 with @xmath352 such that @xmath353 .",
    "hence , latexmath:[\\[\\sum_{j=1}^4 |h(\\alpha(t_j ) ) - h(\\alpha(t_{j-1}))| \\ge",
    "@xmath343 is large enough then the points @xmath355 , @xmath351 and @xmath356 have good approximations of the form @xmath357 , with @xmath358 .",
    "this implies the lemma .    * choosing scales :",
    "* choose @xmath359 .",
    "in particular , @xmath360 and for @xmath361 \\cap { { { { \\mathbb}z}}}$ ] , @xmath362 where @xmath343 is as in lemma [ lemma : subdivision ] .",
    "[ lemma : scales ] suppose @xmath363 , and suppose @xmath364 \\to { \\operatorname{x}(m',n')}$ ] is a quasi - geodesic segment . for each @xmath365 $ ] , subdivide @xmath366 $ ] into @xmath367 segments of length @xmath368 .",
    "let @xmath369 denote the fraction of these segments whose images are not @xmath294-monotone .",
    "then , @xmath370    * remark : * the utility of the lemma is that the right hand side is fixed and does not depend on @xmath2 .",
    "so for @xmath2 large enough , some ( in fact many ) @xmath369 must be small .",
    "_ by applying lemma  [ lemma : subdivision ] to each non-@xmath294-monotone segment on the scale @xmath371 , we get @xmath372 doing this again , we get after @xmath2 iterations , @xmath373 but the left - hand - side is bounded from above by the length and so bounded above by @xmath374 .",
    "in this subsection we apply the estimates from above to images of geodesics under a quasi - isometry from @xmath149 to @xmath317 .",
    "the idea is to average the previous estimates over families of geodesics . in order to unify notation for the two possible model space types",
    ", we shift the parametrization of vertical geodesics in @xmath36 so that they are parametrized by height minus @xmath375 , i.e. by the interval @xmath376 $ ] rather than @xmath265 $ ] .    * setup and notation .",
    "*    * suppose @xmath295 is a @xmath10 quasi - isometry .",
    "without loss of generality , we may assume that @xmath165 is continuous .",
    "* let @xmath377 \\to { \\operatorname{x}(m , n)}$ ] be a vertical geodesic segment parametrized by arclength where @xmath378 .",
    "* let @xmath379 .",
    "then @xmath380 \\to { \\operatorname{x}(m',n')}$ ] is a quasi - geodesic segment .",
    "it follows from lemma  [ lemma : scales ] , that for every @xmath290 and every geodesic segment @xmath381 , assuming that @xmath2 is sufficiently large , there exists @xmath365 $ ] such that @xmath382 .",
    "the difficulty is that @xmath383 may depend on @xmath381 . in our situation , this is overcome as follows :    we will average the result of lemma  [ lemma : scales ] over @xmath384 , the set of vertical geodesics in @xmath236 .",
    "let @xmath385 denote the measure / cardinality of @xmath384 .",
    "we will always denote our average by @xmath386 , despite the fact that when @xmath387 this is actually an integral over @xmath384 and not a sum .",
    "when @xmath260 it is actually a sum . changing order , we get : @xmath388 let @xmath389 be a small parameter ( in fact , we will choose @xmath390 so that @xmath391 , where @xmath293 is as in theorem  [ theorem : main : step : one ] )",
    ". then , if we choose @xmath392 , then there exists a scale @xmath383 such that @xmath393    * conclusion . * on the scale @xmath394 , at least @xmath395 fraction of all vertical geodesic segments of length @xmath266 in @xmath236 have nearly vertical images under @xmath165 .",
    "from now on , we fix this scale , and drop the index @xmath383",
    ". we will refer to segments of length @xmath266 arising in our subdivision as _ edges _ of length @xmath266 . in the case of @xmath396",
    "these edges are unions of edges in the graph . in what follows we will use the terms _ big edges _ for edges of length @xmath266 if there is any chance of confusion with an actual edge in the graph @xmath396",
    ".    * remark .",
    "* the difficulty is that , at this point , even though we know that most edges have images under @xmath165 which are nearly vertical , it is possible that some may have images which are going up , and some may have images which are going down .",
    "we assume that @xmath397 .",
    "as described in ",
    "[ sec : tiling ] , we tile @xmath398 let @xmath399 denote the set of vertical geodesic segements in @xmath284 .",
    "we have @xmath400 where @xmath401 , and @xmath402 is equal to @xmath403 if @xmath333 is @xmath294-monotone , and equal to @xmath256 otherwise .",
    "the error term of @xmath404 is due to the fact that the tiling may not be exact , see lemma  [ lemma : tiling ] . to justify equation [ eq : tiling : identity ]",
    ", one uses that @xmath405 and @xmath406 .    since the left hand side is bounded by @xmath407 and assuming @xmath408 , we conclude the following :    [ lemma : good : box ] let us tile @xmath236 by boxes @xmath284 of size @xmath266 , so that @xmath409",
    ". then there exists a subset @xmath300 of the indexing set @xmath301 with @xmath410 such that if we let @xmath399 denote the set of vertical geodesics in @xmath284 then @xmath411    note that @xmath266 is the length of one big edge so that the set @xmath399 of vertical geodesics in @xmath284 consists of big edges connecting the top to the bottom .",
    "the equation ( [ eq : goodbox : average : delta : small ] ) means that the fraction these edges which are not @xmath294-monotone is at most @xmath412",
    ".    * notation . * in the rest of  [ sec : align ] and in  [ sec : product ] we fix @xmath413 and drop the index @xmath186 .",
    "[ lemma : big : edges : aligned ] let @xmath414 be an @xmath294-monotone big edge of @xmath415 going from the bottom to the top .",
    "we say that @xmath414 is `` upside - down '' if @xmath416 is going down , and `` right - side - up '' if @xmath416 is going up",
    ". then either the fraction of the big edges in @xmath415 which are upside down or the fraction of the big edges in @xmath415 which are right - side - up is at least @xmath417 .",
    "* we have a natural notion of `` top '' vertices and `` bottom '' vertices so that each big edge connects a bottom vertex to a top vertex .",
    "then @xmath415 is a complete bipartite graph .",
    "there must be a subset @xmath418 of vertices of density @xmath419 , such that for each vertex in @xmath420 the fraction of the edges incident to @xmath421 which are not @xmath294-monotone is at most @xmath422 .",
    "let @xmath423 be the subgraph of @xmath415 obtained by erasing any edge @xmath414 such that @xmath416 is not @xmath294-monotone .",
    "we orient each edge @xmath414 of @xmath423 by requiring that @xmath416 is going down .",
    "let @xmath424 be any two top vertices .",
    "then we can find two bottom vertices @xmath425 such that all four quasigeodesic segments @xmath426 , @xmath427 , @xmath428 and @xmath429 are all @xmath294-monotone , @xmath430 and @xmath431 diverge quickly at @xmath190 , and @xmath432 and @xmath433 diverge quickly at @xmath188 .",
    "we now apply lemma  [ lemma : quadrilateral ] to conclude that @xmath434 and that all the segments @xmath435 with @xmath436 have the same orientation .",
    "thus any two top vertices in @xmath418 have images on essentially the same height , say @xmath437 .",
    "similarly , any two bottom vertices in @xmath418 have images on the same height , say @xmath438 .",
    "since we must have @xmath439 or @xmath440 , the lemma holds .",
    "we define the _ dominant orientation _ to be right - side - up or upside - down so that the fraction of big edges which have the dominant orientation is at least @xmath441 .",
    "let @xmath442 denote the space of pairs @xmath443 where @xmath444 is a vertical geodesic in @xmath415 and @xmath445 is a point .",
    "let @xmath446 denote uniform measure on @xmath442 .",
    "( in the case of @xmath36 this is just the counting measure . )",
    "the following lemma is a formal statement regarding subsets of @xmath442 of large measure .",
    "[ lemma : uniform : set ] suppose @xmath447 ( where the implied constant depends only on the model space ) .",
    "suppose @xmath448 , with @xmath449 .",
    "then , there exists a subset @xmath450 such that :    * @xmath451 , where @xmath231 is defined in @xmath452 . * if @xmath453 , then for at least @xmath454 fraction of the vertical geodesics @xmath455 passing within distance @xmath456 of @xmath98 , @xmath457 .    * remark . * note that for the case of @xmath36 , any geodesic passing within distance @xmath458 of @xmath98 passes through @xmath98 .    * proof . * for @xmath459 , let @xmath460 denote the set of geodesics which pass within @xmath456 of @xmath98 . for clarity",
    ", we first give the proof for the @xmath36 case .",
    "note that @xmath461 , where @xmath276 depends on @xmath462 and the location and size of @xmath415 .",
    "note that @xmath463    suppose @xmath464 is any function of a geodesic @xmath381 and a point @xmath445 : then , @xmath465 where in the last line we used ( [ eq : measure : exchange ] ) .",
    "we apply ( [ eq : exchange ] ) with @xmath74 the the characteristic function of the complement of @xmath418 .",
    "we get , @xmath466 let @xmath467 denote the parenthesized quantity in the above expression .",
    "let @xmath468 . recall that markov s inequality says that for any real - valued function @xmath74 , and any real number @xmath469 , the measure of the set @xmath470 is at most @xmath471 . then , by this inequality , @xmath472 , and for @xmath473 , for at least @xmath454 fraction of the geodesics @xmath381 passing through @xmath98 , @xmath457 .",
    "this completes the proof for the @xmath36 case . in @xmath24",
    "the computation is essentially the same , except for the fact that @xmath474 ( i.e. the measure of set of geodesics passing within @xmath458 of @xmath98 ) can become smaller when @xmath98 is within @xmath458 of the boundary of @xmath415 .",
    "however , the relative @xmath231 measure of such points is @xmath475 by lemma  [ lemma : box : amenable ] .",
    "therefore ( [ eq : measure : exchange ] ) and ( [ eq : exchange ] ) hold up to error @xmath476 .",
    "[ cor : mostly : monotone ] there exists a subset @xmath450 with @xmath477 such that for @xmath478 , @xmath479-fraction of the geodesics passing within @xmath458 of @xmath98 are @xmath294-monotone and have the dominant orientation .",
    "* let @xmath418 denote the set of pairs @xmath443 where @xmath455 is a dominantly oriented @xmath294-monotone geodesic segment , and @xmath98 is a point of @xmath381 .",
    "let @xmath480 be the subset constructed by lemma  [ lemma : uniform : set ] .",
    "since @xmath481 , @xmath482 .",
    "[ lemma : height : preserving ] suppose @xmath165 and @xmath415 and @xmath483 are as in corollary  [ cor : mostly : monotone ] .",
    "then , there exist functions @xmath484 , @xmath485 , and a subset @xmath486 with @xmath487 such that for @xmath488 , @xmath489    * proof .",
    "* we assume that the dominant orientation is right - side - up ( the other case is identical ) .",
    "now suppose @xmath490 belong to the same @xmath98-horocycle . by the construction of @xmath483 there",
    "exist @xmath425 in @xmath415 ( above @xmath190 , @xmath188 ) such that for each @xmath177 the two geodesic segments @xmath491 and @xmath492 leaving @xmath181 diverge quickly , and each of the quasigeodesic segments @xmath435 is @xmath294-monotone .",
    "then by lemma  [ lemma : epsilon : monotone : segment ] , each of the @xmath435 is within @xmath493 of a quasi - geodesic segment @xmath494 .",
    "now by applying lemma  [ lemma : quadrilateral ] to the @xmath494 we see that @xmath495 and @xmath496 are on the same @xmath98-horocycle , up to an error of @xmath493 .",
    "thus , the restriction of @xmath165 to @xmath483 preserves the @xmath98-horocycles . a similar argument (",
    "but now we will pick @xmath216 , @xmath192 below @xmath190 , @xmath188 ) shows that the restriction of @xmath165 to @xmath483 preserves the @xmath100-horocycles . we can now conclude that @xmath165 is height respecting on a slightly smaller set @xmath497 , i.e. there exist functions @xmath498 and @xmath499 such that for @xmath500 , ( [ eq : partial : product ] ) holds .",
    "[ prop : product : map ] suppose @xmath165 and @xmath415 and @xmath483 are as in corollary  [ cor : mostly : monotone ] .",
    "then , there exist functions @xmath74 , @xmath75 , @xmath76 , a corresponding product map @xmath67 , and a subset @xmath501 with @xmath502 such that for @xmath503 , @xmath504    * proof . * to simplify language",
    ", we assume that the dominant orientation is right - side - up ( the other case is identical ) .",
    "let @xmath505 ( resp .",
    "@xmath506 ) denote the height of the bottom ( resp .",
    "top ) of @xmath415 . if @xmath507 , we let @xmath508 \\to b(r)$ ] denote the vertical geodesic segement @xmath509",
    ". let @xmath510 ( resp .",
    "@xmath511 ) denote the subset of the bottom ( resp .",
    "top ) face of @xmath415 which is within @xmath512 of a point of @xmath483 .",
    "since @xmath513 , each @xmath514 has nearly full @xmath231-measure . in fact if we let @xmath515 denote the set of points @xmath104 such that @xmath516 , @xmath517 , and @xmath518 has @xmath294-monotone image under @xmath165 , then @xmath519 .    note",
    "that @xmath510 is an @xmath520 neighborhood of a ( subset of a ) segment of a @xmath98-horocycle , say @xmath521 . since the restriction of @xmath165 to @xmath483 preserves the @xmath98-horocycles , @xmath522 ,",
    "there exist numbers @xmath523 and @xmath524 and a function @xmath525 or @xmath526 such that for @xmath527 , @xmath528 is at most @xmath529 distance from @xmath530 .",
    "similarly , @xmath511 is bounded distance from a set of the form @xmath531 , and there exists a function @xmath532 or @xmath533 such that the restriction of @xmath165 to @xmath511 is @xmath493 distance from a map of the form @xmath534 .",
    "let @xmath497 be as in lemma  [ lemma : height : preserving ] .",
    "now suppose @xmath535 .",
    "since @xmath536 , @xmath537 is @xmath493 from a vertical geodesic connecting a point in the @xmath493 neighborhood of @xmath538 to a point in the @xmath493 neighborhood of @xmath539 .",
    "hence , @xmath537 is within @xmath493 distance of the vertical geodesic connecting @xmath540 to @xmath541 .",
    "this , combined with ( [ eq : partial : product ] ) implies the proposition , and hence theorem  [ theorem : main : step : one ] .",
    "* remark : * the product map @xmath67 produced in the proof of proposition [ prop : product : map ] is not defined on the entire box . since we are not assuming anything about the regularity of the maps @xmath542 and @xmath76 which define @xmath67 , one can choose an arbitrary extension to a product map defined on the box .",
    "this is sufficient for our purposes here .",
    "* order in which constants are chosen .",
    "*    * we may assume that @xmath294 is sufficiently small so that in lemma  [ lemma : quadrilateral ] , the @xmath543 error term is smaller then @xmath544 .",
    "* we choose @xmath545 , so that lemma  [ lemma : subdivision ] works .",
    "we may assume @xmath546 .",
    "* as described in ",
    "[ sec : averaging ] , we choose @xmath547 , so that @xmath522 ( see proof of proposition  [ prop : product : map ] ) , @xmath548 ( see proposition  [ prop : product : map ] ) and also @xmath549 , see lemma  [ lemma : good : box ] .",
    "* we choose @xmath550 so that @xmath551 , as described in  [ sec : averaging ] . * for @xmath552 ,",
    "write @xmath553 .",
    "* write @xmath554",
    ". choose @xmath555 for some @xmath556 , and so that for @xmath557 , the @xmath404 error term in ( [ eq : tiling : identity ] ) is at most @xmath558 .",
    "then the same is true for any @xmath559 , @xmath560 .",
    "now assume @xmath296 is sufficiently large so that lemma  [ lemma : uniform : set ] holds with @xmath561 and @xmath562 .",
    "theorem  [ theorem : main : step : one ] holds with @xmath563 and @xmath564 .",
    "in this section , we assume that @xmath565 . we prove the following theorem :    [ theorem : main : step : two ] for every @xmath389 , @xmath566 and @xmath175 there exists a constant @xmath567 ( depending on @xmath390 , @xmath70 , @xmath15 ) such that the following holds : suppose @xmath295 is a @xmath10 quasi - isometry .",
    "then for every @xmath568 and every box @xmath236 , there exists a subset @xmath569 with @xmath570 and a height - respecting map @xmath571 such that    * @xmath572 * for @xmath573 heights of two points in @xmath236 , we have @xmath574 * for all @xmath453 , at least @xmath575 fraction of the vertical geodesics passing within @xmath520 of @xmath98 are @xmath576-weakly monotone .    * remark . *",
    "it is not difficult to conclude from theorem  [ theorem : main : step : two ] that @xmath78 is in fact a product map ( not merely height - respecting ) .",
    "however , we will not need this .",
    "theorem  [ theorem : main : step : two ] is true also for the case @xmath577 ; its proof for that case is the content of @xcite .",
    "the proof presented in this section is much simpler , but applies only to the case @xmath565 .",
    "the main point of the proof is to show that if @xmath565 , then in the notation of theorem  [ theorem : main : step : one ] , for each @xmath413 , the maps @xmath578 must preserve the up direction .",
    "this is done in  [ sec : noflips ] .",
    "the deduction of theorem  [ theorem : main : step : two ] from that fact is in  [ sec : lininguptheboxes ] .",
    "the following is a basic property shared for example by all homogeneous spaces and all spaces with a transitive isometry group ( such as @xmath149 ) .",
    "[ lemma : ball : growth ] for @xmath579 , let @xmath580 denote the metric ball of radius @xmath581 centered at @xmath246 .",
    "then , for every @xmath582 there exists @xmath583 with @xmath584 such that for all @xmath585 , @xmath586 where @xmath446 denotes volume ( relative to the @xmath149 metric ) .",
    "also @xmath587 , where the implied constant depends on the model space @xmath149 .    *",
    "* the first statement is immediate since @xmath149 is a homogeneous space .",
    "the second is a simple calculation .    in this section",
    "we prove some fairly elementary facts about quasi - isometries quasi - preserving volume .",
    "the main tool is the following basic covering lemma .",
    "[ lemma : covering ] let @xmath14 be a metric space and let @xmath588 be a collection of points in @xmath14 . then for any @xmath589 there is a subset @xmath590 in @xmath591 such that :    * the sets @xmath592 are pairwise disjoint . * @xmath593    this lemma and it s proof ( which consists of picking @xmath594 by a greedy algorithm ) can be found in ( * ? ? ?",
    "* chapter 1 ) .",
    "this argument is implicit in almost any reference which discusses covering lemmas .",
    "recall that we are assuming that @xmath165 is a continuous @xmath10 quasi - isometry .    from this we can deduce the following fact about quasi - isometries of @xmath149 .",
    "this fact holds much more generally for metric measure spaces which satisfy lemma  [ lemma : ball : growth ] .",
    "[ prop : qivolume ] let @xmath595 be a continuous @xmath10 quasi - isometry .",
    "then for any @xmath596 there exists @xmath597 with @xmath598 such that for any @xmath599 , @xmath600 .",
    "* we assume that @xmath601 .",
    "note that we are assuming that every point is within distance @xmath15 of the image of @xmath165 .",
    "let @xmath602 be the covering of @xmath603 consisting of all balls of radius @xmath604 centered in @xmath483 . by lemma  [ lemma : covering",
    "] , we can find a ( finite ) subset @xmath594 of @xmath483 such that @xmath605 cover @xmath603 and such that the balls centered at @xmath594 are pairwise disjoint .",
    "hence , @xmath606 is covered by @xmath607 .",
    "hence , @xmath608    for the other inequality , @xmath609    * terminology .",
    "* the `` coarse volume '' of a set @xmath418 means the volume of @xmath610 for a suitable @xmath604 . if the set @xmath418 is essentially one dimensional ( resp .",
    "two dimensional ) we use the term `` coarse length '' ( resp .",
    "`` coarse area '' ) instead of coarse volume but the meaning is still the volume of @xmath610 .",
    "we also use @xmath611 to denote coarse length .      for a path @xmath381 ,",
    "let @xmath612 denote the length of @xmath381 ( measured in the @xmath149-metric ) .",
    "recall that we are assuming @xmath31 .",
    "[ lemma : length : area ] suppose @xmath240 is a constant @xmath103 plane , and suppose @xmath483 is a bounded set contained in @xmath240 .",
    "suppose @xmath613 and @xmath381 is a path which stays at least @xmath201 units below @xmath240 , i.e. that @xmath614 .",
    "suppose also that any vertical geodesic ray starting at @xmath483 and going down intersects the @xmath581-neighborhood of @xmath381 .",
    "then , @xmath615 where @xmath616 and @xmath617 depend only on the model space , and both the length and the area are measured using the @xmath149 metric",
    ".    * proof .",
    "* we give a proof for @xmath396 , the proof for @xmath24 is similar .",
    "let @xmath618 denote the @xmath581-neighborhood of @xmath381 , then @xmath619 . pick @xmath343 so that @xmath618 stays above height @xmath620 .",
    "let @xmath621 denote the set of vertical segments of length @xmath343 which start at height @xmath622 and go down .",
    "let @xmath623 denote the elements of @xmath621 which start at points of @xmath483",
    ". then @xmath624 .",
    "now for @xmath625 , any point at height @xmath626 intersects exactly @xmath627 elements of @xmath621 .",
    "thus , by the assumption on the height of @xmath618 , any point of @xmath618 can intersect at most @xmath628 elements of @xmath621 .",
    "but by assumption , @xmath618 intersects any element of @xmath623 .",
    "thus , @xmath629 , which implies the lemma .",
    "( recall that in our notation , length = area = cardinality in @xmath396 ) .",
    "* remark : * when @xmath29 , lemma [ lemma : length : area ] still holds ( but with @xmath630 ) , and also in addition with the word _ below _ replaced by the word _",
    "above_. when @xmath28 , volume decreases on upwards projection .      given a box @xmath415 , an @xmath100-horocycle @xmath631 in @xmath415 , and a number @xmath632 , we let the _ shadow _ , @xmath633 , of @xmath631 in @xmath415 be the set of points that can be reached by a vertical geodesics going straight down from the @xmath632 neighborhood of @xmath631 .",
    "note that if @xmath631 is the top of the box , @xmath634 is the entire box .",
    "similar definitions hold for @xmath98-horocycles , but then the shadow will be above the horocycle .",
    "the goal of this subsection is the following :    [ theorem : noflips ] suppose @xmath565 and that @xmath294 and @xmath293 are sufficiently small ( depending only on the model space ) .",
    "let @xmath301 , @xmath300 , @xmath309 and @xmath315 be as in theorem  [ theorem : main : step : one ] .",
    "suppose @xmath413 .",
    "then the product map @xmath635 can be written as @xmath636 , with @xmath637 coarsely orientation preserving .    * remark . *",
    "the result of theorem  [ theorem : noflips ] is _ false _ in the case @xmath638 , since there exist `` flips '' , i.e. isometries which reverse vertical orientation .",
    "this is the point where the proof in the case @xmath638 diverges from the case @xmath565 .    in the rest of  [ sec :",
    "noflips ] we prove theorem  [ theorem : noflips ] .",
    "we pick @xmath413 and suppress the index @xmath186 for the rest of this subsection .",
    "pick @xmath639 to be determined later ( see the end of this subsection ) .",
    "[ lemma : goodshadow ] all but @xmath640 proportion of the @xmath100-horocycles @xmath631 that are above the middle of the box @xmath415 have all but @xmath641 fraction of the @xmath231-measure of both @xmath642 and @xmath643 in @xmath483 .",
    "* let @xmath644 be a constant @xmath103 plane above the middle of the box ( and not too close to the top ) .",
    "we choose horocycles @xmath645 in @xmath644 such that @xmath646 .",
    "the subset of @xmath415 below @xmath644 is then the disjoint union of the shadows @xmath647 .",
    "since at least half the measure of @xmath415 is below @xmath644 , it follows that there is some @xmath186 so that all but @xmath641 of the @xmath231-measure of @xmath648 is in @xmath483 . to guarantee the same fact about @xmath642 , we pick @xmath644 such that @xmath649 has all but @xmath641 fraction of its @xmath231-measure in @xmath483 .",
    "[ lemma : goodplane ] for any @xmath631 as in lemma [ lemma : goodshadow ] , there exists a constant @xmath103 plane @xmath644 such that @xmath650 contains all but @xmath651 fraction of the @xmath231-measure in @xmath652 .",
    "furthermore , we can choose @xmath644 and @xmath631 such that @xmath653 .",
    "* let @xmath654 by lemma  [ lemma : goodshadow ] , @xmath655 , where @xmath276 is the implied constant in lemma  [ lemma : goodshadow ] , and we have assumed that @xmath656 .",
    "now this is another application of fubini s theorem , where we partition @xmath418 into its intersections with neighborhood of constant @xmath103 planes .",
    "[ lemma : goodpieces ] let @xmath644 be as in the conclusion of lemma [ lemma : goodplane ] . there are subsets @xmath657 of @xmath658 such that    1 .",
    "@xmath659 contains all but @xmath651 fraction of the @xmath231-measure of @xmath660 .",
    "2 .   for @xmath661 any path joining @xmath662 to @xmath663 of length less than @xmath664 passes within @xmath665 of @xmath631 .",
    "3 .   for @xmath177 , @xmath666 where @xmath276 depends on the model spaces .    *",
    "* we divide @xmath667 into equal thirds where each third has the entire @xmath100-extent and a third of the @xmath98-extent .",
    "we let @xmath668 and @xmath669 be the two non - middle thirds .",
    "now let @xmath670 be the portion of @xmath671 which is at least @xmath672 away from the edges of @xmath415 .",
    "the area of each of these regions is much more than the coarse area @xmath673 since projecting upwards decreases area and each region projects upwards onto @xmath631 .",
    "the proof of theorem [ theorem : noflips ] involves deriving contradiction to the reversal of orientation of vertical geodesics under @xmath67 on @xmath284 .",
    "the goal is to show that if the orientation were to reverse , we could find a path in the target joining @xmath674 to @xmath675 that contradicts lemma [ lemma : goodpieces ] .",
    "* proof of theorem [ theorem : noflips ] .",
    "* we assume that vertical orientation is not preserved but reversed .",
    "this means the @xmath103 component @xmath676 of the product map in theorem  [ theorem : main : step : one ] is orientation reversing .",
    "let @xmath677 denote the @xmath98-horocycle through @xmath246 .",
    "for @xmath177 , let @xmath678 let @xmath679",
    ". by proposition  [ prop : qivolume ] , and lemma  [ lemma : goodpieces ] part 3 , we have @xmath680 where @xmath182 depends only on the model spaces , @xmath70 and @xmath15 .",
    "assuming @xmath294 is sufficiently small , @xmath681 .",
    "then by lemma  [ lemma : length : area ] , 99.9% of the geodesics going down from @xmath682 do not enter the @xmath665 neighborhood of @xmath683 .",
    "let @xmath684 denote the set of @xmath685 so that @xmath686 of the geodesics going down from ( the @xmath456-neighborhood of ) @xmath246 do not enter the @xmath665 neighborhood of @xmath683 . then @xmath687 .",
    "let @xmath688 denote the set of @xmath100-horocycles @xmath689 such that @xmath690 is non - empty for some ( or equivalently for all ) @xmath691 .",
    "let @xmath692 .",
    "we claim that @xmath693 .",
    "indeed , @xmath694 , and @xmath695 , where @xmath696 is independent of @xmath697 .",
    "now , @xmath698 thus , we have @xmath699 , and hence there exists @xmath700 . by the definition of the @xmath701",
    ", we can find @xmath190 , @xmath188 such that @xmath702 . then for @xmath177 , by the definition of @xmath684",
    ", we can find geodesics @xmath703 going down from @xmath181 , such that @xmath703 do not enter the @xmath665 neighborhood of @xmath683 , and such that @xmath143 and @xmath145 meet at some point @xmath704 . by construction @xmath705 .",
    "concatenating subsegments of these two geodesics yields a path connecting @xmath190 to @xmath188 of length @xmath706 which avoids the @xmath665 neighborhood of @xmath683 . pulling back",
    ", we have a path of length at most @xmath707 and avoiding the @xmath665 neighborhood of @xmath631 , which connects a point within @xmath493 of @xmath708 to a point within @xmath493 of @xmath709 .",
    "this contradicts lemma [ lemma : goodpieces ] .",
    "* remark : * the only place in this paper where we make essential use of the fact that @xmath165 satisfies @xmath289 of definition [ defn : qi ] is in pulling back the path connecting @xmath190 and @xmath188 at the end of the proof of theorem [ theorem : noflips ] .",
    "* choice of constants .",
    "* let @xmath710 be the largest constant depending only on @xmath711 and the model spaces , which arises in the course of the argument in ",
    "[ sec : noflips ] .",
    "we choose @xmath712 so that @xmath713 .",
    "similarly we choose @xmath714 so that @xmath715 and @xmath294 @xmath716 .",
    "we also choose @xmath293 so that @xmath717 .",
    "we also make sure that @xmath294 and @xmath293 are sufficiently small so that theorem  [ theorem : noflips ] applies .",
    "in addition we choose @xmath296 in the statement of theorem [ theorem : main : step : one ] such that the constant @xmath718 that appears in the proof of theorem [ theorem : noflips ] is at least @xmath719 .",
    "our other choices guarantee that @xmath720 , so this is just a lower bound on @xmath266 and therefore @xmath296 .      *",
    "the uniform set and the exceptional set .",
    "* let @xmath300 and @xmath309 , @xmath413 be as in theorem  [ theorem : main : step : one ] .",
    "let @xmath721 .",
    "recall that @xmath384 is the set of vertical geodesics in @xmath236 . here",
    "we will work with a fixed geodesic @xmath722 .",
    "let @xmath723 denote the complement of @xmath724 in @xmath236 .",
    "for a point @xmath445 and @xmath725 let @xmath726 where @xmath727 is the ball of radius @xmath728 centered at @xmath98 ( so that @xmath729 is an interval of length @xmath730 centered at @xmath98 ) .",
    "[ lemma : uniform : implies : weakly : monotone ] for every @xmath731 there exists @xmath732 ( with @xmath733 as @xmath734 ) such that the following holds : suppose @xmath381 is a geodesic ray leaving @xmath98 , and for any @xmath735 , @xmath736 . then , @xmath737 is @xmath326-weakly - monotone , where @xmath738 .",
    "* proof . * parametrize @xmath381 so that @xmath739 .",
    "without loss of generality , we may assume that @xmath381 is going up . let @xmath737 .",
    "suppose @xmath740 are such that @xmath741 .",
    "write @xmath742 .",
    "subdivide @xmath743 $ ] into intervals @xmath744 of length @xmath745 and so that the length of all but the first and last is exactly @xmath746 .",
    "we may assume @xmath747 .",
    "let @xmath748 $ ] be the set of @xmath358 such that @xmath749 .",
    "for @xmath750 , pick @xmath751 such that @xmath752 , and pick @xmath753 arbitrarily otherwise .",
    "now @xmath754 where @xmath755 is either @xmath343 or @xmath756 depending on whether @xmath343 is odd or even .",
    "let @xmath757 { \\;\\ : : \\;\\:}\\gamma(s_j ) \\in u_i , \\",
    "\\gamma(s_{j-2 } ) \\in u_i \\}$ ] ( same @xmath309 ) .",
    "let @xmath758 denote the set of odd @xmath759 $ ] such that @xmath760 and @xmath761 are in different boxes @xmath284 .",
    "finally , let @xmath762 denote the set of odd @xmath759 $ ] such that @xmath763 or @xmath764 . by assumption , @xmath765 and also @xmath766 .",
    "then , @xmath767 .",
    "note that if @xmath768 , then @xmath769 , and for any @xmath770 , @xmath771 .",
    "hence , @xmath772 also , @xmath773 ) we see that @xmath774 or @xmath775 which implies the lemma .",
    "pick @xmath776 ( in fact we will eventually choose @xmath777 ) .",
    "suppose @xmath722 , we define a point @xmath445 to be _",
    "@xmath710-uniform along @xmath381 _ , if for all @xmath778 , @xmath779    [ lemma : vitali ] let @xmath780 denote the proportion of non-@xmath710-uniform points along @xmath381 .",
    "then , @xmath781 .",
    "* this is a standard application of the vitali covering lemma .",
    "let @xmath782 .",
    "suppose @xmath98 is non - uniform , then there is an interval @xmath783 centered at @xmath98 such that @xmath784 the intervals @xmath783 obviously cover the non - uniform set of @xmath381 , and , by vitali , we can choose a disjoint subset @xmath785 which cover at least half the measure of the non - uniform set .",
    "then , @xmath786 dividing both sides by @xmath240 ( the length @xmath381 ) , and recalling that @xmath787 , we obtain the estimate .",
    "let @xmath788 .",
    "[ cor : mostly : weakly : monotone ] there exists a subset @xmath569 with @xmath789 such that for @xmath453 , @xmath454-fraction of the geodesics passing within @xmath458 of @xmath98 are right - side - up @xmath790-weakly - monotone .",
    "* let @xmath442 denote the space of pairs @xmath443 where @xmath722 is a vertical geodesic in @xmath236 and @xmath791 is a point .",
    "let @xmath792 denote the set of pairs @xmath443 such that @xmath793 , and @xmath98 is @xmath710-uniform along @xmath381 .",
    "then , by lemma  [ lemma : vitali ] we have @xmath449 .",
    "let @xmath483 be the subset constructed by applying lemma  [ lemma : uniform : set ] .",
    "then @xmath794 , and for @xmath453 by lemma  [ lemma : uniform : implies : weakly : monotone ] at least @xmath454 fraction of the geodesic rays leaving @xmath98 are @xmath795-weakly - monotone .",
    "[ lemma : weakly : monotone : to : height : preserving ] suppose @xmath165 and @xmath236 and @xmath483 are as in corollary  [ cor : mostly : weakly : monotone ] , and @xmath796 is sufficiently small ( depending only on the model space )",
    ". then , there exist functions @xmath106 ,",
    "@xmath76 , and a subset @xmath797 with @xmath798 such that for @xmath500 , @xmath799    * proof .",
    "* this proof is identical to that of lemma  [ lemma : height : preserving ] .",
    "* proof of theorem  [ theorem : main : step : two ] . * choose @xmath796 so that lemma  [ lemma : weakly : monotone : to : height : preserving ] holds .",
    "choose @xmath217 so that lemma  [ lemma : uniform : implies : weakly : monotone ] holds , and also that the @xmath800 term in lemma  [ lemma : uniform : implies : weakly : monotone ] is at most @xmath801 .",
    "choose @xmath802 and choose @xmath803 so that @xmath804 .",
    "now the theorem follows from combining corollary  [ cor : mostly : weakly : monotone ] and lemma  [ lemma : weakly : monotone : to : height : preserving ] .",
    "in this section , we complete the proof of theorem  [ theorem : qisol ] and theorem  [ theorem : qidl ] .",
    "we assume that @xmath165 is a @xmath711 quasi - isometry from @xmath149 to @xmath317 satisfying the conclusion of theorem  [ theorem : main : step : two ] .",
    "all the arguments in this section are valid also in the case @xmath29 ( and are used in @xcite ) .      in this subsection ,",
    "our main goal is to prove the following :    [ theorem : euc : plane : lin : drift ] let @xmath295 be a @xmath10 quasi - isometry satisfying the conclusions of theorem  [ theorem : main : step : two ] . then for any @xmath805 there exists @xmath806 ( depending on @xmath807 ) such that for any @xmath98 and @xmath100 in @xmath149 with @xmath808 , @xmath809    * note .",
    "* this is a step forward , since the theorem asserts that ( [ eq : euc : plane : lin : drift ] ) holds _ for all _ pairs @xmath102 of equal height ( and not just on a set of large measure ) .",
    "we would like to restrict theorem  [ theorem : main : step : two ] to the neighborhood of a constant @xmath103 plane .",
    "let @xmath810 .",
    "fix a constant @xmath103 plane @xmath644 . for notational convinience ,",
    "assume that @xmath644 is at height @xmath403 .",
    "let @xmath811 denote the intersection of @xmath644 with a box @xmath812 whose top face is at height @xmath240 and bottom face at @xmath813 .",
    "then @xmath814 is a rectangle ( in fact , when @xmath29 , with this choice of @xmath644 , @xmath814 is a square in the euclidean metric ) .",
    "we will call @xmath240 the _ size _ of @xmath814 .",
    "let @xmath815 denote the `` thickening '' of @xmath814 in the @xmath103-direction by the amount @xmath816 , i.e. @xmath815 is the intersection of @xmath817 with the region @xmath818 , where as above @xmath819 denotes the height function .",
    "we now have the following corollary of theorem  [ theorem : main : step : two ] :    [ cor : euc : plane : most : measure ] suppose @xmath568",
    ". then for every rectangle @xmath811 there exists @xmath820 with @xmath821 and a standard map @xmath822 such that @xmath823 .",
    "furthermore , for any @xmath824 , for 99% of the geodesics @xmath381 leaving @xmath246 , @xmath825 is within @xmath826 of a vertical geodesic segment ( in the right direction ) .",
    "* the tilings . *",
    "choose @xmath827 depending only on @xmath828 and @xmath42 .",
    "when @xmath29 , @xmath829 .",
    "let @xmath830 . for each @xmath831",
    "we tile @xmath644 by rectangles @xmath266 of size @xmath832 ; we denote the rectangles by @xmath833 , @xmath834 . for @xmath835 ,",
    "let @xmath836 $ ] denote the unique rectangle in the @xmath770th tiling to which the orthogonal projection of @xmath98 to @xmath644 belongs .",
    "* warning .",
    "* despite the fact that @xmath837 , the number of rectangles of the form @xmath836 $ ] needed to cover a rectangle of the form @xmath838 $ ] is very large ( on the order of @xmath839 ) .",
    "this is because the euclidean size of @xmath840 is approximately @xmath841 .    * the sets @xmath842 .",
    "* for each rectangle @xmath833 , corollary  [ cor : euc : plane : most : measure ] gives us a subset of @xmath843 which we will denote by @xmath844 .",
    "let @xmath845 in view of corollary  [ cor : euc : plane : most : measure ] , for any @xmath846 , @xmath847 \\cap u_j } |h(\\phi(y ) ) - h(\\phi(x))| \\le 2 \\nu l_j\\ ] ]    we also have the following generalization :    [ lemma : next : level ] for any @xmath848 and any @xmath849 \\cap u_j$ ] , @xmath850    * proof .",
    "* let @xmath851 $ ] be a rectangle on the same `` row '' as @xmath836 $ ] and the same `` column '' as @xmath852 $ ] . then , since @xmath853 , there exists an @xmath98-horocycle @xmath631 which intersects both @xmath854 \\cap u_j$ ] and @xmath855 \\cap u_j$ ] ; let us denote the points of intersection by @xmath12 and @xmath190 respectively .",
    "now for @xmath177 choose ( sufficiently different ) vertical geodesics @xmath703 coming down from ( near ) @xmath12 and @xmath856 coming down from ( near ) @xmath190 such that for @xmath177 , @xmath857 and @xmath858 are close .",
    "( here all the geodesics are parametrized by arclength ) . in view of corollary  [ cor : euc : plane : most : measure ] , since @xmath12 and @xmath190 are in @xmath842 , we may assume that there exist vertical geodesics @xmath859 and @xmath220 such that for @xmath860 , @xmath861 where @xmath862 .",
    "similarly , @xmath863 .",
    "thus , in particular , @xmath864 , and similarly @xmath865 . now note that @xmath866 .",
    "hence @xmath867 , and by assumption @xmath868 .",
    "then by lemma  [ lemma : quadrilateral ] , @xmath869 and @xmath495 are near the same horocycle , and thus , in particular , @xmath870 similarly , we can find @xmath871 \\cap u_j$ ] and @xmath872 \\cap u_j$ ] such that @xmath188 and @xmath873 are on the same @xmath100-horocycle .",
    "then , by the same argument , @xmath874 hence , in view of ( [ eq : x : hor ] ) , ( [ eq : y : hor ] ) , and ( [ eq : same : j ] ) , @xmath875 as required .    [ lemma : uj : ujplus : one ] suppose @xmath876 \\cap u_j$ ] , @xmath877 \\cap u_{j+1}$ ] .",
    "then , @xmath878    * proof . *",
    "note that the orthogonal projection of @xmath879 $ ] to @xmath880 $ ] has full @xmath231-measure ( up to order @xmath881 ) .",
    "the same is true of @xmath882 $ ] .",
    "thus , the projections intersect , and thus we can find @xmath883 $ ] and @xmath884 \\cap u_{j+1}$ ] such that @xmath885 .",
    "now , in view of lemma  [ lemma : next : level ] , @xmath886 and in view of ( [ eq : same : j ] ) , @xmath887 this implies ( [ eq : uj : ujplus : one ] ) .",
    "* proof of theorem  [ theorem : euc : plane : lin : drift ] .",
    "* we have @xmath888 \\subset r_1[x ] \\subset r_2[x ] \\subset \\dots\\ ] ] and @xmath889 \\subset r_1[y ] \\subset r_2[y ] \\subset \\dots\\ ] ] there exists @xmath343 with @xmath890 comparable to @xmath891 such that ( after possibly shifting the @xmath343th grid by a bit ) @xmath892 = r_n[y]$ ] .",
    "now for @xmath893 , pick @xmath894 \\cap u_j$ ] , @xmath895 \\cap u_j$ ] .",
    "we may assume that @xmath896 .",
    "now , using lemma  [ lemma : uj : ujplus : one ] , @xmath897 where in the last line we used that @xmath830 . now since @xmath898 $ ] , @xmath899 , so @xmath900 . similarly , @xmath901 . also note that @xmath902 is within a factor of @xmath903 of @xmath891 .",
    "thus the theorem follows .",
    "[ lemma : all : weakly : monotone ] let @xmath295 be a @xmath10 quasi - isometry .",
    "then for any @xmath862 there exists @xmath904 ( depending on @xmath905 ) such that for any vertical geodesic ray @xmath381 , @xmath906 is @xmath907-weakly monotone .",
    "* this is a corollary of theorem  [ theorem : euc : plane : lin : drift ] .",
    "suppose @xmath381 is a vertical geodesic ray parametrized by arclength , and @xmath908 .",
    "suppose @xmath909 are such that @xmath741 .",
    "we now apply theorem  [ theorem : euc : plane : lin : drift ] to @xmath910 instead of @xmath165 ( with @xmath911 and @xmath912 .",
    "we get @xmath913 , i.e. @xmath914 i.e. @xmath915 is @xmath916-weakly monotone .",
    "* proof of theorem  [ theorem : qisol ] and theorem  [ theorem : qidl ] .",
    "* suppose @xmath190 and @xmath188 are two points of @xmath149 , with @xmath917 .",
    "we can find @xmath216 , @xmath192 in @xmath149 such that @xmath918 form a quadrilateral . by lemma  [ lemma : all : weakly : monotone ] , each of the segments @xmath180 connecting a point in the @xmath520 neighborhood of @xmath181 to a point in the @xmath520 neighborhood of @xmath183 maps under @xmath165 to an @xmath919-weakly monotone quasi - geodesic segment .",
    "then by lemma  [ lemma : epsilon : monotone : segment ] , and lemma  [ lemma : quadrilateral ] , we see that @xmath920 .",
    "the purpose of this section is to apply the previous results on self quasi - isometries of @xmath24 and the @xmath921-graphs to understand all finitely generated groups quasi - isometric to either one .",
    "this follows a standard outline : if @xmath1 is quasi - isometric to @xmath14 then @xmath1 quasi - acts on @xmath14 ( in this case that just means there is a homomorphism @xmath922 with uniformly bounded constants ) .",
    "we then need to show that such a quasi - action can be conjugated to an isometric action .",
    "the basic ingredients we need to do this are the following :        @xcite[qsqp ] let @xmath1 have a uniform quasi - similarity action on @xmath526 . if the @xmath1 action is cocompact on the space of pairs of distinct points in @xmath526 then there is some @xmath42 and a similarity action of @xmath1 on @xmath533 which is bilipschitz conjugate to the given quasi - similarity action .",
    "it is useful to think about these results in a quasi - action interpretation",
    ". one can view @xmath923 as @xmath924 , and interpret a uniform quasi - similarity action on @xmath923 as the boundary of a quasi - action on @xmath925 fixing a point at infinity .",
    "the result of farb and mosher then says that this quasi - action is quasi - conjugate to an isometric action on @xmath925 .",
    "the interpretation of the second result is similar , with a tree of valence @xmath40 replacing @xmath925 .",
    "the hypothesis of cocompactness on pairs in that theorem then translates to cocompactness of the quasi - action on the tree .",
    "[ theorem : qitoisom ] assume every @xmath10 self quasi - isometry of @xmath24 is at bounded distance from a @xmath79-standard map where @xmath926 .",
    "then any uniform group of quasi - isometries of @xmath24 is virtually a lattice in @xmath24 .      by theorem [ theorem : qisol ] , @xmath929 is bounded distance from a standard map . on a subgroup @xmath931 of @xmath1 of index at most two ,",
    "this gives a homomorphism @xmath932 . by theorem [ qsr ] , each of these quasi - similarity actions on @xmath923 can be bilipschitz conjugated to a similarity action .",
    "this gives @xmath933 .    since the quasi - isometries @xmath929 have uniformly bounded constants , we know that the stretch factors of the two quasi - similarity actions @xmath934 are approximately on the curve @xmath935 - meaning that the products weighted by these factors are uniformly close to @xmath256 .",
    "this therefore is true for @xmath936 as well .",
    "so , in the sequence :      where the final map is the log of the stretch factor , we know that the image lies within a bounded neighborhood of the line @xmath938 . since the image is a subgroup , this implies it must lie on this line . since the subgroup of @xmath939 above this line is @xmath24 , we have produced a homorphism        consider a compact subset @xmath941 .",
    "the set @xmath942 consists of maps with uniformly bounded stretch factors , and which move the origin at most a bounded amount . transporting this information back to the standard maps of @xmath24",
    ", we see that for @xmath943 the maps @xmath929 move the identity a uniformly bounded amount . however , the quasi - action @xmath728 of @xmath1 on @xmath24 is the @xmath74-conjugate of the left action of @xmath1 on @xmath1 .",
    "this action is proper , so we conclude that @xmath944 is finite .",
    "this implies that @xmath936 has finite kernel and discrete image . in the same way ,",
    "the fact that the @xmath1 action on @xmath1 is transitive implies that the image of @xmath936 is cocompact .          [ theorem : qitoisomdl ] assume every @xmath10 self quasi - isometry of @xmath36 is at bounded distance from a @xmath79-standard map where @xmath926 .",
    "then any uniform group of quasi - isometries of @xmath36 is virtually a lattice in @xmath946 where @xmath947 are all powers of a common integer",
    ".          * proof .",
    "* we proceed as in the previous proof for @xmath24 .",
    "the first difference is that to apply theorem [ qsqp ] we need to know that the quasi - similarity actions of @xmath931 on @xmath533 and @xmath526 are cocompact on pairs of points .",
    "as discussed above , this is equivalent to asking the corresponding quasi - action on the trees of valence @xmath41 and @xmath40 to be cocompact .",
    "this then follows immediately from the fact that @xmath931 is cocompact on @xmath36 .        we know , as before , that the weighted stretch factors are approximate inverses .",
    "in this case the stretch factors are in @xmath958 - in @xmath959 one can stretch only by powers of @xmath43 .",
    "thus the image is a subgroup lying on the line @xmath960 .",
    "for this to be a non - empty subgroup of @xmath961 we must have @xmath962 rational , which implies that there is a @xmath963 with @xmath964 , @xmath965 for some @xmath966 and @xmath421 .",
    "there is still some ambiguity in the choices , since many groups occur as subgroups of @xmath967 for many different @xmath201 . as in the construction of",
    "@xcite we can make the choices unique by choosing the @xmath968 the maximum possible , so that all powers of @xmath969 occur as stretch factors . with these choices",
    "we are forced to have the line @xmath970 as this is the only line of negative slope in @xmath961 surjecting to both factors .",
    "thus we have @xmath971 , with the image contained in the subgroup having inverse stretch factors .",
    "this group is , up to finite index , @xmath972 .",
    "so we have :      exactly as before , one can see that the kernel is finite and the image is a lattice , which implies that @xmath974 .",
    "this implies that @xmath1 is amenable , and hence it and @xmath36 have metric flner sets .",
    "this is true only for @xmath29 , which completes the proof .",
    "* proof of theorem  [ theorem : different : sol : not : qi ] .",
    "* since all @xmath30 are obviously quasi - isometric to one another , it suffices to consider the case @xmath28 .",
    "this then follows immediately from theorem  [ theorem : qisol ] and ( * ? ? ?",
    "* theorem 5.1 ) .      * proof .",
    "* in view of theorem  [ theorem : qidl ] , the proof of this result is similar to the last one .",
    "the point is that ( up to permuting @xmath43 and @xmath42 ) the quasi - isometry @xmath975 induces quasi - similarities @xmath976 and @xmath977 .",
    "theorem [ theorem : cooper ] then implies that @xmath43 and @xmath55 are both powers of some number @xmath963 and that @xmath42 and @xmath56 are both powers of some number @xmath383 .",
    "however , since the quasi - similarities both come from the same map on vertical geodesics , the scale factors must agree .",
    "this immediately implies @xmath978 .",
    "farb , benson ; mosher , lee .",
    "problems on the geometry of finitely generated solvable groups .",
    "_ crystallographic groups and their generalizations ( kortrijk , 1999 ) _ , 121134 , contemp .",
    ", 262 , amer .",
    "soc . , providence , ri , 2000 .",
    "pansu , pierre .",
    "metriques de carnot - carathodory et quasiisomtries des espaces symtriques de rang un .",
    "( french ) [ carnot - caratheodory metrics and quasi - isometries of rank - one symmetric spaces ] _ ann . of math . _",
    "( 2 ) 129 ( 1989 ) , no .",
    "1 , 160 .",
    "pansu , pierre .",
    "dimension conforme et sphre linfini des varits  courbure ngative .",
    "( french ) [ conformal dimension and sphere at infinity of manifolds of negative curvature ] ann .",
    "ser . a i math .",
    "14 ( 1989 ) , no .",
    "2 , 177212 ."
  ],
  "abstract_text": [
    "<S> in this paper , we prove that certain spaces are not quasi - isometric to cayley graphs of finitely generated groups . in particular , we answer a question of woess and prove a conjecture of diestel and leader by showing that certain homogeneous graphs are not quasi - isometric to a cayley graph of a finitely generated group .    </S>",
    "<S> this paper is the first in a sequence of papers proving results announced in @xcite . in particular </S>",
    "<S> , this paper contains many steps in the proofs of quasi - isometric rigidity of lattices in @xmath0 and of the quasi - isometry classification of lamplighter groups . </S>",
    "<S> the proofs of those results are completed in @xcite .    </S>",
    "<S> the method used here is based on the idea of _ coarse differentiation _ introduced in @xcite . </S>"
  ]
}