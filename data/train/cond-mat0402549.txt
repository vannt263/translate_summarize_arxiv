{
  "article_text": [
    "monte carlo simulations of polymer models have played a significant role in the development of monte carlo methods for more than fifty years @xcite .",
    "we present here results of simulations performed with a powerful new algorithm , flatperm @xcite , which combines a stochastic growth algorithm , perm @xcite , with umbrella sampling techniques @xcite .",
    "this leads to a flat histogram in a chosen parameterization of configuration space .",
    "the stochastic growth algorithm used is the pruned and enriched rosenbluth method ( perm ) @xcite , which is an enhancement of the rosenbluth and rosenbluth algorithm @xcite , an algorithm that dates back to the early days of monte carlo simulations .",
    "while perm already is a powerful algorithm for simulating polymers , the addition of flat - histogram techniques @xcite provides a significant enhancement , as has already been exploited in @xcite , where it has been combined with multicanonical sampling @xcite .",
    "before we describe the algorithm in detail and present results of the simulations , we give a brief motivating introduction to the lattice models considered here .",
    "if one wants to understand the critical behavior of long linear polymers in solution , one is naturally led to a course - grained picture of polymers as beads of monomers on a chain .",
    "there are two main physical ingredients leading to this picture .",
    "first , one needs an `` _ _ excluded volume _ _ '' effect , which takes into account the fact that different monomers can not simultaneously occupy the same region in space .",
    "second , the quality of the solvent can be modeled by an effective monomer - monomer interaction .",
    "monomers in a good solvent are surrounded by solvent molecules and hence experience an effective monomer - monomer repulsion .",
    "similarly , a bad solvent leads to an effective monomer - monomer attraction .",
    "consequently , polymers in a good solvent form swollen `` _ _ coils _ _ '' , whereas polymers in a bad solvent form collapsed `` _ _ globules _ _ '' and also clump together with each other ( see fig .",
    "[ figure1 ] ) . in order to study the transition between these two states , it is advantageous to go to the limit of an infinitely dilute solution , in which one considers precisely one polymer in an infinitely extended solvent .     ,",
    "width=264 ]    as we are interested in critical behavior , it is also possible to further simplify the model by discretizing it . due to universality",
    ", the critical behavior is expected to be unchanged by doing so .",
    "we therefore consider random walks on a regular lattice , _ eg _ the simple cubic lattice for a three - dimensional model .",
    "one can think of each lattice site corresponding to a monomer and the steps as monomer - monomer bonds .",
    "we model excluded volume effects by considering _ self - avoiding _ random walks which are not allowed to visit a lattice site more than once .",
    "the quality of the solvent is modeled by an attractive short - range interaction between non - consecutive monomers which occupy nearest - neighbor sites on the lattice . at this point",
    "we may add more structure to our polymer model by considering monomer - specific interactions .",
    "specific properties of monomers @xmath0 and @xmath1 on the chain lead to an interaction @xmath2 depending on @xmath0 and @xmath1 .    in this paper",
    ", we will consider three examples in detail .",
    "first , we consider as pedagogical example , the problem of simulating polymers in a two - dimensional strip .",
    "the interaction energy is simply @xmath3 , however , the introduction of boundaries makes simulations difficult @xcite .",
    "our second example is the hp model which is a toy model of proteins @xcite .",
    "it consists of a self - avoiding walk with two types of monomers along the sites visited by the walk  hydrophobic ( type h ) and polar ( type p ) .",
    "one considers monomer - specific interactions , mimicking the interaction with a polar solvent such as water .",
    "the interaction strengths are chosen so that hh - contacts are favored , _",
    "eg _ @xmath4 and @xmath5 .",
    "the central question is to determine the density of states ( and to find the ground state with lowest energy ) for a given sequence of monomers .",
    "an example of a conjectured ground state is given in fig .",
    "[ figure2 ] for a particular sequence of 85 monomers on the square lattice ( the sequence is taken from @xcite ) .",
    ", width=264 ]    our third example is the interacting self - avoiding walk ( isaw ) model of ( homo)-polymer collapse ; it is obtained by setting @xmath6 independent of the individual monomers . here",
    ", one is interested in the critical behavior in the thermodynamic limit , _ ie _ the limit of large chain lengths .",
    "an example of an @xmath7-step interacting self - avoiding walk with @xmath8 interactions is shown in fig .",
    "[ figure3 ] .",
    ", width=188 ]    the partition function of @xmath9-step interacting self - avoiding walks can be written as @xmath10 where @xmath11 is the energy of an @xmath9-step walk , @xmath12 .",
    "note that the second sum is over the number @xmath13 of interactions , and @xmath14 is the number of configurations of @xmath9-step self - avoiding walks with precisely @xmath13 interactions .",
    "while the motivation for simulations of the various models is different , the central problems turn out to be similar . for interacting self - avoiding walks ,",
    "the collapse transition is in principle understood .",
    "one has a tri - critical phase transition with upper critical dimension @xmath15 , so that one can derive the critical behavior from mean - field theory for @xmath16 @xcite , whereas for @xmath17 one obtains results from conformal invariance @xcite .",
    "however , even though this transition is in principle understood , there are surprising observations above the upper critical dimension @xcite .",
    "most importantly , there is no good understanding of the collapsed regime , which is also notoriously difficult to simulate .",
    "similarly , in the hp model one is interested in low - temperature problems , _ ie _ deep inside the collapsed phase .",
    "in particular , one wishes to understand the design problem , which deals with the mapping of sequences along the polymer chain to specific ground state structures .",
    "again , the most important open question is in the collapsed regime .",
    "it is therefore imperative , to find algorithms which work well at low temperatures . in the following section",
    ", we present just such an algorithm .",
    "this section describes our algorithm , as proposed in @xcite .",
    "the basis of the algorithm is the rosenbluth and rosenbluth algorithm , a stochastic growth algorithm in which each configuration sampled is grown from scratch .",
    "the growth is kinetic , which is to say that each growth step is selected at random from all possible growth steps .",
    "thus , if there are @xmath18 possible ways to add a step then one selects one of them with probability @xmath19 .",
    "for example , for a self - avoiding walk on the square lattice there may be between one and three possible ways of continuing , but it is also possible that there are no continuing steps , in which case we say that the walk is _ trapped _ ( see fig .",
    "[ figure4 ] ) .     ]",
    "as the number of possible continuations generally changes during the growth process , different configurations are generated with different probabilities and so one needs to reweight configurations to counter this . if one views this algorithm as `` _",
    "_ approximate counting _ _ ''",
    "then the required weights of the configurations serve as estimates of the total number of configurations .    to understand this point of view ,",
    "imagine that we were to perform a _",
    "complete _ enumeration of the configuration space .",
    "doing this requires that at each growth step we would have to choose _ all _ the possible continuations and count them each with equal weight . if we now select _ fewer _ configurations , then we have to change the weight of these included configurations in order to correct for those that we have missed .",
    "thus , if we choose one growth step out of @xmath18 possible , then we must replace @xmath18 configurations of equal weight by one `` representative '' configuration with @xmath18-fold weight .",
    "in this way , the weight of each grown configuration is a direct estimate of the total number of configurations .",
    "let the _ atmosphere _ , @xmath20 , be the number of distinct ways in which a configuration @xmath21 of size @xmath9 can be extended by one step .",
    "then , the weight associated with a configuration of size @xmath9 is the product of all the atmospheres @xmath22 encountered during its growth , _ ie _ @xmath23 after having started @xmath24 growth chains , an estimator @xmath25 for the total number of configurations @xmath26 is given by the mean over all generated samples , @xmath27 , of size @xmath9 with respective weights @xmath28 , _ ie _ @xmath29 here , the mean is taken with respect to the total number of growth chains @xmath24 , and _ not _ the number of configurations which actually reach size @xmath9 .",
    "configurations which get trapped before they reach size @xmath9 appear in this sum with weight zero .",
    "the rosenbluth and rosenbluth algorithm suffers from two problems .",
    "first , the weights can vary widely in magnitude , so that the mean may become dominated by very few samples with very large weight .",
    "second , regularly occurring trapping events , _ ie _ generation of configurations with zero atmosphere can lead to exponential `` _ _ attrition _ _ '' , _ ie _ exponentially strong suppression of configurations of large sizes .    to overcome these problems , enrichment and pruning steps have been added to this algorithm , leading to the pruned and enriched rosenbluth method ( perm ) @xcite .",
    "the basic idea is that one wishes to suppress large fluctuations in the weights @xmath28 , as these should on average be equal to @xmath26 .",
    "if the weight of a configuration is too large one `` _ _ enriches _ _ '' by making copies of the configuration and reducing the weights by an appropriate factor . on the other hand ,",
    "if the weight is too small , one throws away or `` _ _ prunes _ _ '' the configuration with a certain probability and otherwise continues growing the configuration with a weight increased by an appropriate factor . note that neither @xmath24 nor the expression ( [ est ] ) for the estimate , @xmath25 , are changed by either enriching or pruning steps .",
    "a simple but significant improvement of perm was added in @xcite , where it was observed that it would be advantageous to force each of the copies of an enriched configuration to grow in _ distinct _ ways .",
    "this increases the diversity of the sample population and it is this version of perm that we consider below .",
    "we still need to specify enrichment and pruning criteria as well as the actual enrichment and pruning processes . while the idea of perm itself is straightforward , there is now a lot of freedom in the precise choice of the pruning and the enrichment steps .",
    "the `` art '' of making perm perform efficiently is based to a large extent on a suitable choice of these steps  this can be far from trivial !",
    "distilling our own experience with perm , we present here what we believe to be an efficient , and , most importantly , _",
    "parameter free _ version .",
    "in contrast to other expositions of perm ( _ eg _",
    "@xcite ) , we propose to prune and enrich constantly ; this enables greater exploration of the configuration space .",
    "define the _ threshold ratio _",
    ", @xmath30 , as the ratio of weight and estimated number of configurations , @xmath31",
    ". ideally we want @xmath30 to be close to @xmath32 to keep weight fluctuations small .",
    "hence if @xmath33 the weight is too large and so we enrich . similarly if @xmath34 then the weight is too small and so we prune .",
    "moreover , the details of the pruning and enrichment steps are chosen such that the new weights are as close as possible to @xmath25 :    * @xmath33 @xmath35 * enrichment step * : + make @xmath36 distinct copies of the configuration , each with weight @xmath37 ( as in nperm @xcite ) . * @xmath34 @xmath35 * pruning step * : + continue growing with probability @xmath30 and weight @xmath38 ( _ ie _ prune with probability @xmath39 ) .    note that we perform pruning and enrichment _ after _ the configuration has been included in the calculation of @xmath25 .",
    "the new values are used during the _ next _ growth step .",
    "initially , the estimates @xmath25 can of course be grossly wrong , as the algorithm knows nothing about the system it is simulating .",
    "however , even if initially `` wrong '' estimates are used for pruning and enrichment the algorithm can be seen to converge to the true values in all applications we have considered . in a sense , it is self - tuning .",
    "we also note here , that the number of samples generated for each size is roughly constant .",
    "ideally , in order to effectively sample configuration space , the algorithm traces an unbiased random walk in configuration size .",
    "this means that perm is , in some sense , already a flat histogram algorithm .",
    "we shall return to this central observation below .",
    "it is now straight - forward to change perm to a thermal ensemble with inverse temperature @xmath40 and energy @xmath41 ( defined by some property of the configuration , such as the number of contacts ) by multiplying the weight with the appropriate boltzmann factor @xmath42 , which leads to an estimate of the partition function , @xmath43 , of the form @xmath44 the pruning and enrichment procedures are changed accordingly , replacing @xmath45 by @xmath46 and @xmath25 by @xmath47 .",
    "this gives threshold ratio @xmath48 .",
    "this is the setting in which perm is usually described .    alternatively , however , it is also possible to consider microcanonical estimators for the total number @xmath14 of configurations of size @xmath9 with energy @xmath13 ( _ ie _ the `` density of states '' ) .",
    "an appropriate estimator @xmath49 is then given by the mean over all generated samples @xmath50 of size @xmath9 and energy @xmath13 with respective weights @xmath51 , _ ie _ @xmath52 again , the mean is taken with respect to the total number of growth chains @xmath24 , and _ not _ the number of configurations @xmath53 which actually reach a configuration of size @xmath9 and energy @xmath13 .",
    "the pruning and enrichment procedures are also changed accordingly , replacing @xmath26 by @xmath14 and using @xmath54 .",
    "as observed above , the pruning and enrichment criterion for perm leads to a flat histogram in length , _ ie _ a roughly constant number of samples being generated at each size @xmath9 for perm .",
    "in fact , one can motivate the given pruning and enrichment criteria by stipulating that one wishes to have a roughly constant number of samples , as this leads to the algorithm performing an unbiased random walk in the configuration size .",
    "similarly , in the microcanonical version described above , the algorithm performs an unbiased random walk in both size and energy of the configurations , and we obtain a roughly constant number of samples at each size @xmath9 and energy @xmath13 .    it is because of the fact that the number of samples is roughly constant in each histogram entry , that this algorithm can be seen as a `` flat histogram '' algorithm , which we consequently call flat histogram perm , or flatperm . in hindsight in",
    "becomes clear that perm itself can be seen as a flat histogram algorithm , at it creates a roughly flat histogram in size @xmath9 .",
    "recognizing this led us to the formulation of this algorithm in the first place .",
    "we have seen that by casting perm as an approximate counting method , the generalization from perm to flat histogram perm is straight - forward and ( nearly ) trivial .",
    "one can now add various refinements to this method if needed .",
    "for examples we refer the reader to @xcite .",
    "we close this section with a summary of the central steps to convert simple perm to flatperm by comparing the respective estimators and threshold ratios , @xmath30 :    1 .   * athermal perm * : estimate the number of configurations @xmath26 * @xmath55 * @xmath31 2 .   * thermal perm * : estimate the partition function @xmath43 * @xmath56 * @xmath57 3 .",
    "* flat histogram perm * : estimate the density of states @xmath14 * @xmath58 * @xmath54    one can similarly generalize the above to several microcanonical parameters , @xmath59 , to produce estimates of @xmath60 .",
    "once the simulations have been performed the average of an observable , @xmath61 , defined on the set of configurations can be obtained from weighted sums : @xmath62 these can then be used for subsequent evaluations . for instance , the expectation value of @xmath61 in the canonical ensemble at a given temperature @xmath63 can now be computed via @xmath64 _ ie _ only a single simulation is required to compute expectations at _ any _ temperature .    for many problems we are interested in their behavior at low temperatures where averages of observables are dominated by configurations with high energy .",
    "such configurations are normally very difficult to obtain in simulations .",
    "the flatperm algorithm is able to effectively sample such configurations because it obtains a roughly constant number of samples at all sizes and energies ( due to the constant pruning and enrichment ) .",
    "this means that it is possible to study models even at very low temperatures .",
    "examples of this are given in the next section .",
    "a good way of showing how flatperm works is to simulate two - dimensional polymers in a strip .",
    "this kind of simulation has previously been performed with perm using markovian anticipation techniques @xcite which are quite complicated . with flatperm one simply chooses the vertical position of the endpoint of the walk in the strip as an `` energy '' for the algorithm to flatten against .",
    "we have found that this produces very good results .",
    "[ figure6 ] shows the results of our simulations of @xmath65-step self - avoiding walks in a strip of width @xmath66 .",
    "the left - hand figure is the probability density @xmath67 of the endpoint coordinate @xmath68 shown as a function of walk length @xmath9 .",
    "the right - hand figure shows the actual number of samples generated for each length @xmath9 and end point position @xmath68 .",
    "one sees that the histogram of samples is indeed nearly completely flat .",
    "one can now extract several quantities from such simulations ( see @xcite ) , but we restrict ourselves here to the scaled end - point density shown in fig .",
    "[ figure7 ] .    ):",
    "density of states versus energy ( above ) and specific heat @xmath69 versus temperature @xmath70 ( below ) .",
    "[ figure8 ] , title=\"fig:\",width=313 ] + ): density of states versus energy ( above ) and specific heat @xmath69 versus temperature @xmath70 ( below ) .",
    "[ figure8 ] , title=\"fig:\",width=302 ]    ): density of states versus energy ( above ) and specific heat @xmath69 versus temperature @xmath70 ( below ) .",
    "[ figure9 ] , title=\"fig:\",width=302 ] + ): density of states versus energy ( above ) and specific heat @xmath69 versus temperature @xmath70 ( below ) .",
    "[ figure9 ] , title=\"fig:\",width=287 ]    next we show results from simulations of the hp - model . here",
    ", we have obtained the whole density of states for small model proteins with fixed sequences .",
    "the first sequence considered ( taken from @xcite ) is small enough to enable comparison with exact enumeration data .",
    "it has moreover been designed to possess a unique ground state ( up to lattice symmetries ) .",
    "[ figure8 ] shows our results .",
    "we find ( near ) perfect agreement with exact enumeration even though the density of states varies over a range of eight orders of magnitude !",
    "the derived specific heat data clearly shows a collapse transition around @xmath71 and a sharper transition into the ground state around @xmath72 .",
    "the next sequence ( taken from @xcite ) is the one for which fig .",
    "[ figure2 ] shows a state with the lowest found energy .",
    "[ figure9 ] shows our results for the density of states and specific heat .",
    "we find the same lowest energy @xmath73 as @xcite ( though this is not proof of it being the ground state ) .",
    "the density of states varies now over a range of 30 orders of magnitude !",
    "the derived specific heat data clearly shows a much more complicated structure than the previous example .    for several other sequences taken from the literature",
    "we have confirmed previous density of states calculations and obtained identical ground state energies .",
    "the sequences we considered had @xmath74 steps ( @xmath75 dimensions , @xmath76 ) and @xmath77 steps ( @xmath78 dimensions , @xmath79 ) from @xcite , and @xmath80 steps ( @xmath75 dimensions , @xmath81 ) from @xcite .",
    "we studied also a particularly difficult sequence with @xmath82 steps ( @xmath75 dimensions , @xmath83 ) from @xcite , but the lowest energy we obtained was @xmath84 . while we have not been able to obtain the ground state , neither has any other perm implementation ( see @xcite ) .",
    "+   +    we now turn to the simulation of interacting self - avoiding walks ( isaw ) on the square and simple cubic lattices . in both cases have we simulated walks up to length @xmath65 . here",
    ", we encounter a small additional difficulty ; when perm is initially started it is effectively blind and may produce poor estimates of @xmath14 and this may in turn lead to overflow problems .",
    "it is therefore necessary to stabilize the algorithm by delaying the growth of large configurations . for this",
    ", it suffices to restrict the size of the walks by only allowing them to grow to size @xmath9 once @xmath85 tours ( the number of times the algorithm returns to an object of zero size ) has been reached .",
    "we found a value of @xmath86 sufficient .",
    "[ figure10 ] shows the equilibration of the algorithm due to the delay .",
    "snapshots are taken after @xmath87 , @xmath88 , and @xmath89 generated samples .",
    "while the sample histogram looks relatively rough ( even on a logarithmic scale ) the density of states is already rather well behaved . in the plots one clearly sees the effect of large correlated tours in which large number of enrichments produce many samples with the same initial walk segment .",
    "( left ) and number of generated samples ( right ) versus internal energy @xmath90 and length @xmath9 for isaw on the square lattice ( above ) and simple cubic lattice ( below ) [ figure11 ] , title=\"fig:\",width=207 ]   ( left ) and number of generated samples ( right ) versus internal energy @xmath90 and length @xmath9 for isaw on the square lattice ( above ) and simple cubic lattice ( below ) [ figure11 ] , title=\"fig:\",width=207 ] +   ( left ) and number of generated samples ( right ) versus internal energy @xmath90 and length @xmath9 for isaw on the square lattice ( above ) and simple cubic lattice ( below ) [ figure11 ] , title=\"fig:\",width=207 ]   ( left ) and number of generated samples ( right ) versus internal energy @xmath90 and length @xmath9 for isaw on the square lattice ( above ) and simple cubic lattice ( below ) [ figure11 ] , title=\"fig:\",width=207 ]    the final result of our simulations for interacting self - avoiding walks in two and three dimensions is shown in fig .",
    "[ figure11 ] .",
    "it clearly shows the strength of flatperm : with one single simulation can one obtain a density of states which ranges over more than 300 orders of magnitude !",
    "versus inverse temperature @xmath40 for isaw on the square lattice ( above ) and the simple cubic lattice ( below ) at lengths 64 , 128 , 256 , 512 , and 1024 .",
    "the curves for larger lengths are more highly peaked .",
    "the vertical lines denote the expected transition temperature at infinite length .",
    "[ figure12 ] , title=\"fig:\",width=207 ]    versus inverse temperature @xmath40 for isaw on the square lattice ( above ) and the simple cubic lattice ( below ) at lengths 64 , 128 , 256 , 512 , and 1024 .",
    "the curves for larger lengths are more highly peaked .",
    "the vertical lines denote the expected transition temperature at infinite length .",
    "[ figure12 ] , title=\"fig:\",width=207 ]    from these data one can now , for example , compute the specific heat curves @xmath91 .",
    "the results for both systems are shown in fig .",
    "[ figure12 ] .",
    "we see that the data is well behaved well into the collapsed low - temperature regime .",
    "we have reviewed stochastic growth algorithms for polymers . describing",
    "the rosenbluth and rosenbluth method as an approximate counting method has enabled us to present a straight - forward extension of simple perm to flat histogram perm . using this algorithm",
    "one can obtain the complete density of states ( even over several hundred orders of magnitude ) from one single simulation .",
    "we demonstrated the strength of the algorithm by simulating self - avoiding walks in a strip , the hp - model of proteins , and interacting self - avoiding walks in two and three dimensions as a model of polymer collapse .",
    "99 g. w. king , in _",
    "monte carlo method _ ,",
    "volume 12 of _ applied mathematics series _ , national bureau of standards , 1951 t. prellberg and j. krawczyk , phys .",
    ", in print p. grassberger , phys .",
    "rev e * 56 * 3682 ( 1997 ) g. m. torrie and j. p. valleau , j. comput .",
    "* 23 * 187 ( 1977 ) m. n. rosenbluth and a. w. rosenbluth , j. chem",
    ". phys . * 23 * 356 ( 1955 ) f. wang and d. p. landau , phys .",
    "* 86 * 2050 ( 2001 ) m. bachmann and w. janke , phys .",
    "* 91 * 208105 ( 2003 ) b. a. berg and t. neuhaus , phys .",
    "b * 267 * 249 ( 1991 ) h .- p .",
    "hsu and p. grassberger , eur .",
    "j. b * 36 * 209 ( 2003 ) k. a. dill , biochemistry * 24 * 1501 ( 1985 ) h .- p .",
    "hsu and v. mehra and w. nadler and p. grassberger , j. chem .",
    "phys . * 118 * 444 ( 2003 ) i. d. lawrie and s. sarbach , in _ phase transitions and critical phenomena _ , edited by c. domb and j. l. lebowitz , volume 9 , academic , london , 1984 j. l. cardy , in _ phase transitions and critical phenomena _ , edited by c. domb and j. l. lebowitz , volume 11 , academic press , new york , 1987 t. prellberg and a. l. owczarek , phys .",
    "e. * 62 * , 3780 ( 2000 ) h .- p . hsu and v. mehra and w. nadler and p. grassberger , phys",
    "e * 68 * 21113 ( 2003 ) h. frauenkron and u. bastolla and e. gerstner and p. grassberger and w. nadler , phys . rev",
    ". lett . * 80 * 3149 ( 1998 ) t.c .",
    "beutler and k.a .",
    "dill , protein sci .",
    "* 5 * 2037 ( 1996 )"
  ],
  "abstract_text": [
    "<S> we present monte carlo simulations of lattice models of polymers . </S>",
    "<S> these simulations are intended to demonstrate the strengths of a powerful new flat histogram algorithm which is obtained by adding microcanonical reweighting techniques to the pruned and enriched rosenbluth method ( perm ) . </S>"
  ]
}