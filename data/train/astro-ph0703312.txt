{
  "article_text": [
    "in the pursuit of strong lensing science , spatial resolution is of paramount importance , and therefore high - resolution imaging with the _ hubble space telescope _ ( _ hst _ ) currently sets the gold standard at optical wavelengths .",
    "this paper presents a different observational approach : a spatially resolved spectroscopic survey for strong galaxy - galaxy gravitational lenses using the optical integral - field units ( ifus ) of the gemini gmos - n and magellan imacs spectrographs .",
    "a significant goal of this paper is to demonstrate the potential of this technique for the confirmation and study of strong lenses .",
    "we will show that , in comparison with _ hst _ imaging , ground - based ifu spectroscopy is always complementary , often competitive , and occasionally superior .",
    "these favorable comparisons are all due to the combination of large collecting aperture with simultaneous spatial and spectral resolution , currently only available at ground - based observatories .",
    "specifically , we show that ifu observations can be valuable for corroborating the lensing interpretation of high - resolution imaging data by using the third ( wavelength ) dimension to cleanly separate the narrow - band images of two separate galaxies along a single line of sight .",
    "we show that in many cases , ground - based ifu data alone can provide competitive constraints on the mass model of the lensing galaxy as compared to _",
    "finally , we show that ifu data can be superior to space - based imaging in cases where the lensed emission - line flux gives a clearer picture than the lensed continuum , or when the presence of resolved velocity structure in the lensed galaxy allows a three - dimensional approach to lens modeling .",
    "numerous previous studies have used the unique three - dimensional capability of high spatial sampling ifus for galaxy - scale strong lensing science .",
    "the majority of these works have used ifu spectroscopy to measure differential substructure lensing effects on the continuum and emission - line regions of lensed quasars @xcite .",
    "ifus have also been used to resolve the kinematic structure of high - redshift galaxies lensed into magnified arcs by intervening galaxy clusters @xcite .",
    "the results we present here represent the first application of ifu spectroscopy to the confirmation and modeling of spectroscopically selected strong gravitational lens candidates consisting of a superposition of two galaxies along a single line of sight .",
    "a further goal of this paper is to present the details of our custom ifu data calibration and analysis software .",
    "this software ( described in [ ifu_red ] ) performs optimal extraction , relative and absolute wavelength calibration to a few hundredths of a pixel rms , and nearly poisson - limited sky subtraction .",
    "the lens candidates observed for this study were selected from the spatially unresolved spectroscopic database of the sloan digital sky survey ( sdss ; @xcite ) using the technique described in @xcite .",
    "they are identified through the presence of an emission - line redshift significantly higher than the absorption - line redshift within the same spectrum , as observed through the 3@xmath0-diameter sdss spectroscopic fiber aperture . by design of the selection process",
    ", the candidates consist of a close angular superposition of a bright foreground early - type galaxy with a faint background star - forming galaxy .",
    "if the ( initially unknown ) impact parameter is small enough , the background galaxy will be multiply imaged by the gravity of the intervening early - type , furnishing a powerful probe of the distribution of mass in the latter .",
    "many such candidates , including all the confirmed lenses presented in this paper , have been successfully observed with the advanced camera for surveys ( acs ) aboard the _ hubble space telescope _ ( _ hst _ ) by the sloan lens acs ( slacs ) survey @xcite .",
    "the observations for this work were obtained with with ifus built by the university of durham astronomical instrumentation group for the the inamori magellan areal camera and spectrograph ( imacs ; * ? ? ? * ) and the gemini - north multi - object spectrograph ( gmos - n ; * ? ? ? * ) .",
    "the data were collected during 2004 march  may ( gmos - n ) and 2004 september ( imacs ) .",
    "imacs data were also collected during 2003 november and 2004 march , but observing and instrument conditions were too poor for scientific use .",
    "table  [ infotab ] gives information on the candidate systems for which data is presented in this paper .",
    "@llllll name & sdss spec .",
    "i d & j2000 ra & dec .",
    "& @xmath1 & @xmath2 & @xmath3 + sdssj0037@xmath40942 & 0655 - 52162 - 392 & 00:37:53.21@xmath409:42:20.1 & 0.1954 & 0.6322 & 16.8 + sdssj0044@xmath50113 & 0393 - 51794 - 456 & 00:44:02.90@xmath501:13:12.5 & 0.1196 & 0.1967 & 16.2 + sdssj0737@xmath53216 & 0541 - 51959 - 145 & 07:37:28.44@xmath532:16:18.6 & 0.3223 & 0.5812 & 17.9 + sdssj0928@xmath54400 & 0870 - 52325 - 465 & 09:28:57.33@xmath544:00:59.1 & 0.2909 & 0.4538 & 18.0 + sdssj0956@xmath55100 & 0902 - 52409 - 068 & 09:56:29.78@xmath551:00:06.3 & 0.2405 & 0.4700 & 17.2 + sdssj1029@xmath56115 & 0772 - 52375 - 140 & 10:29:27.53@xmath561:15:05.0 & 0.1573 & 0.2512 & 16.5 + sdssj1128@xmath55835 & 0951 - 52398 - 036 & 11:28:37.77@xmath558:35:26.8 & 0.3809 & 0.5466 & 18.3 + sdssj1155@xmath56237 & 0777 - 52320 - 501 & 11:55:10.09@xmath562:37:22.1 & 0.3751 & 0.6690 & 18.2 + sdssj1259@xmath56134 & 0783 - 52325 - 279 & 12:59:19.06@xmath561:34:08.4 & 0.2333 & 0.4488 & 17.5 + sdssj1402@xmath56321 & 0605 - 52353 - 503 & 14:02:28.22@xmath563:21:33.3 & 0.2046 & 0.4814 & 17.0 + sdssj1416@xmath55136 & 1045 - 52725 - 464 & 14:16:22.33@xmath551:36:30.2 & 0.2987 & 0.8115 & 18.1 + sdssj1521@xmath55805 & 0615 - 52347 - 311 & 15:21:23.87@xmath558:05:50.6 & 0.2042 & 0.4857 & 17.4 + sdssj1630@xmath54520 & 0626 - 52057 - 518 & 16:30:28.15@xmath545:20:36.2 & 0.2479 & 0.7933 & 17.4 + sdssj1702@xmath53320 & 0973 - 52426 - 464 & 17:02:16.76@xmath533:20:44.7 & 0.1784 & 0.4357 & 16.9 + sdssj2238@xmath40754 & 0722 - 52224 - 442 & 22:38:40.20@xmath407:54:56.0 & 0.1371 & 0.7126 & 16.8 + sdssj2302@xmath40840 & 0725 - 52258 - 463 & 23:02:20.17@xmath408:40:49.4 & 0.0901 & 0.2223 & 16.9 + sdssj2321@xmath40939 & 0645 - 52203 - 517 & 23:21:20.93@xmath409:39:10.3 & 0.0819 & 0.5324 & 15.2 +    the imacs ifu @xcite observes two @xmath6 fields of view in the focal plane , separated by roughly one arc - minute : one fov for the object and one from which to estimate the sky background .",
    "the fields are sampled by a close - packed hexagonal array of lenslets which subtend @xmath7 from side to side , for a total of 2000 lenslets between the two fields .",
    "the lenslets feed the light to optical fibers , which reformat the fields via a defined field - mapping into a one - dimensional array of output lenslets ( a `` pseudo - slit '' ) for dispersion .",
    "this is accomplished within the space of a narrow cartridge that occupies the width of three adjacent mask slots in the slit - mask server , which inserts and removes the ifu in the same manner as a simple mask .",
    "thus the ifu behaves like a slit - mask with two @xmath6 slits on the input side and one long slit on the output .",
    "the imacs ifu can be used with either of the two imacs cameras : @xmath8 ( `` long '' ) or @xmath9 ( `` short '' ) .",
    "all imacs data presented in this paper were obtained using the @xmath9 camera , which uses grisms for dispersion .",
    "the gmos - n ifu @xcite operates in an identical manner to the imacs ifu , with a few notable exceptions .",
    "first , while the object field is @xmath6 ( 1000 lenslets ) as in imacs , the background field is half this size : @xmath10 ( 500 lenslets ) .",
    "second , the 1500 total fibers are reformatted not into one single pseudo - slit , but rather into two parallel pseudo - slits separated by approximately 3200 pixels on the detector .",
    "in the `` two - slit '' mode employed in the current work , broad - band filters must be used to limit the wavelength domain of the individual pseudo - slits so as to prevent overlapping of spectra .",
    "table  [ modetab ] lists the various unique spectrograph configurations used in the current work , along with their general characteristics .",
    "@llllll short &   &   & blocking &   & @xmath11 + name & mode & disperser & filter & range & @xmath12 + imacs & f/2 camera & 300 l / mm grism & none & 40009000 & @xmath13 + gmos - r & two - slit & r600 grating & sloan @xmath3 & 55007000 & @xmath14 + gmos - i & two - slit & r600 grating & sloan @xmath15 & 70008500 & @xmath14 +",
    "the three - dimensional data provided by ifus affords the opportunity to construct narrow - band images of any bandwidth and at any wavelength within the data cube .",
    "furthermore , emission - line regions of the spectrum may be decomposed into continuum and emission - line components through suitable profile modeling . to a very good approximation ",
    "largely as a consequence of our initial selection bias ",
    "continuum emission seen in the ifu spectra of our lens candidates can be attributed to the foreground galaxy .",
    "similarly , high - redshift emission lines is of course entirely due to the background galaxies .",
    "thus decomposition into continuum and emission line components is approximately equivalent to decomposition into foreground and background galaxy images .",
    "our strategy for continuum / emission - line decomposition is as follows .",
    "first , we select a small ( @xmath16   ) wavelength range about the wavelength of a background emission line detected in the sdss spectroscopy .",
    "we parameterize the emission - line component as a gaussian function of wavelength , and the continuum as either a constant or linear function of wavelength , which are sufficient for our purposes over these small wavelength ranges .",
    "the central wavelength and width of the gaussian term , as well as the dimensionless slope of the continuum , are treated as global model parameters applying to all fiber spectra . for a given trial set of these parameters ,",
    "a basis is constructed and the amplitudes of the continuum and emission - line components are fitted with a linear least - squares fit to the ifu data over the selected wavelength range . this linear fit is wrapped within a non - linear optimization of the global emission - line and continuum shape parameters that minimizes the overall @xmath17 using the mpfit idl implementation of the levenberg - marquardt algorithm . for the case of [ oii ]  3727 emission , a double gaussian line profile is used , with the line spacing fixed to its known rest - frame value of @xmath18 and the relative strength of the two line components fitted as an additional global parameter . in several systems ,",
    "slight velocity shifts are detected in the background emission lines , and these are modeled with an additional gaussian - derivative amplitude that approximates the small velocity shifts .",
    "one system shows an appreciably resolved rotation curve , which is treated separately as described below .",
    "the linearly fitted coefficients of the final parameterized basis functions are our best decomposition of the spectrum into background ( emission - line ) and foreground ( continuum ) components . using these components",
    ", we can form emission - line and continuum images in the focal plane of the telescope using the known ifu field mapping .",
    "note that the modeling process yields optimal signal - to - noise ratio for these images , better than simple flux - averaging within defined continuum and emission - line wavelength aperture .",
    "figures [ lensmodels ] ,  [ otherifu ] , and  [ ifu1029 ] show reconstructed narrow - band images of those systems for which the original sdss emission - line detection was confirmed by ifu observation , with related information given in table  [ datatab ] .",
    "ifu observations of several additional candidate systems described in table  [ nodetect ] failed to confirm the original sdss line detection , and the associated data are not presented in this paper .",
    "@lllllll   &   &   &   & &   +   & obs . & exp .",
    "& ifu & & lens + name & mode & time & line & cont . & line & model ?",
    "+ sdssj0037@xmath40942 & imacs & 2@xmath191200s & [ oiii ]  5007 & 0.30 & 3.00 & yes + sdssj0044@xmath50113 & imacs & 2@xmath19900s & h@xmath20 & 0.50 & 6.00 & yes + sdssj0737@xmath53216 & gmos-@xmath15 & 3@xmath19900s & [ oiii ]  5007 & 0.10 & 1.70 & yes + sdssj0928@xmath54400 & gmos-@xmath15 & 3@xmath19900s & [ oiii ]  5007 & 0.15 & 0.50 & no + sdssj0956@xmath55100 & gmos-@xmath15 & 3@xmath19900s & h@xmath21 & 0.20 & 0.20 & no + sdssj1029@xmath56115 & gmos-@xmath15 & 3@xmath19900s & h@xmath20 & 0.20 & 0.15@xmath22 & yes@xmath22 + sdssj1128@xmath55835 & gmos-@xmath3 & 3@xmath19900s & [ oii ]  3727 & 0.12 & 1.00 & no + sdssj1155@xmath56237 & gmos-@xmath15 & 2@xmath19900s & [ oiii ]  5007 & 0.12 & 4.00 & no + sdssj1259@xmath56134 & gmos-@xmath15 & 3@xmath19900s & [ oiii ]  5007 & 0.25 & 0.25 & no + sdssj1402@xmath56321 & gmos-@xmath15 & 3@xmath19900s & [ oiii ]  5007 & 0.25 & 0.40 & yes + sdssj1416@xmath55136 & gmos-@xmath3 & 3@xmath19900s & [ oii ]  3727 & 0.12 & 0.60 & no + sdssj1521@xmath55805 & gmos-@xmath15 & 3@xmath19900s & [ oiii ]  5007 & 0.20 & 0.24 & no + sdssj1630@xmath54520 & gmos-@xmath3 & 3@xmath19900s & [ oii ]  3727 & 0.15 & 0.30 & no + sdssj1702@xmath53320 & gmos-@xmath15 & 3@xmath19900s & [ oiii ]  5007 & 0.30 & 0.30 & no + sdssj2238@xmath40754 & imacs & 3@xmath191200s & [ oiii ]  5007 & 0.30 & 0.80 & yes + sdssj2302@xmath40840 & imacs & 3@xmath19900s & h@xmath20 & 0.60 & 3.00 & yes + sdssj2321@xmath40939 & imacs & 2@xmath191500s & h@xmath21 & 0.80 & 0.40 & yes +    @xmath22 emission - line images of sdssj1029@xmath56115 shown in figure  [ ifu1029 ] are in units of 10@xmath23erg  @xmath24s@xmath25@xmath25lenslet@xmath25 .",
    "see section  [ threed ] for full description of j1029 lens modeling .",
    "@lllllll name & emission line & comment + sdssj1151@xmath56455 & [ oii ]  3727 & non - detection + sdssj1310@xmath56211 & h@xmath21 & non - detect .",
    "[ oiii ]  5007 in atmos .",
    "+ sdssj1550@xmath55217 & [ oii ]  3727 & non - detect .",
    "the emission - line images of the systems shown in figure  [ lensmodels ] , along with a number of systems in figure  [ otherifu ] ( specifically , j0956 , j1259 , j1416 , j1521 , j1630 , and j1702 ) , show multiple features that suggest strong gravitational lensing .",
    "@xcite show how many of these same narrow - band ifu emission - line images confirm the lensing interpretation of _ hst _ imaging data by showing the spatial coincidence of the detected high - redshift emission - line features with the putative lensed images seen with _ hst_. confirmation of a lens candidate as a gravitational lens solely through ifu observation , however , relies on the successful fitting of a lensing mass model to the putative strongly lensed images .",
    "here we describe the ifu lens modeling strategy that we apply to all possible lens images , with successful results for the 7 systems shown in figure  [ lensmodels ] .    where the signal - to - noise ratio and spatial resolution allow",
    ", we analyze all candidate lens systems uniformly by fitting a singular isothermal ellipsoid mass model ( sie : @xcite ) to the observed emission - line image configurations .",
    "the sie model is well motivated , simple , analytic , and able to reproduce all qualitative features of galaxy - scale strong lenses .",
    "( a related model , the singular isothermal sphere with external shear , also offers these advantages . ) the convergence ( scaled surface density ) of the sie model is given by @xmath26 where @xmath27 and @xmath28 and @xmath29 are angular coordinates aligned along the major and minor axes of the iso - density contours .",
    "the dependence of the model on @xmath28 and @xmath29 only through @xmath30 means that all iso - density contours are aligned , similar ( not confocal ) , concentric ellipses .",
    "the parameter @xmath31 expresses the strength of the lens and @xmath32 gives the minor - to - major axis ratio of the iso - density contours ( hence @xmath33 by convention ) .",
    "when @xmath34 , the sie reduces to the singular isothermal sphere ( sis ) and @xmath31 is equal to the angular radius of ring images of on - axis sources .",
    "this `` einstein radius '' is in turn related to the velocity dispersion @xmath35 of the lensing distribution through @xmath36 ( @xmath37 and @xmath38 are angular - diameter distances from lens to source and observer to source . ) for purposes of comparison between models with differing @xmath32 values , we adopt the same intermediate - axis normalization as @xcite , whereby the mass interior to a given iso - density contour at fixed @xmath31 is constant with changing @xmath32 .",
    "a great advantage of the sie is that its projected gravitational potential can be expressed analytically . for our purposes",
    "we need only the derivatives of this potential , which we use in the simple form given by @xcite .",
    "we perform all lens modeling with our own idl routines .",
    "as is always the case when fitting gravitational lens models , we must take care not to fit for more parameters than are constrained by the data .",
    "fortunately the sie is generally free from fundamental degeneracies among its parameters with regard to the constraints furnished by real lenses . in this paper",
    "we are concerned with spatially extended lensed star - forming galaxies which will generally be of sufficient physical size to average over any microlensing effects , and thus we use image surface brightness rather than image positions to constrain our lens models .",
    "we begin the model - fitting procedure for each individual system with a best - guess choice for the parameters of the lens model and source galaxy that gives a reasonable qualitative approximation to the observed emission - line image morphology . for systems",
    "that show spatially resolved emission - line brightness distributions ( most cases ) , we fit for lens and source parameters by generating an unlensed source - galaxy image ( either gaussian or srsic , with ellipticity if necessary ) and viewing it through the potential of the parameterized lens model . this image",
    "is then smeared by a gaussian psf model ( whose width is fit as another free parameter ) , integrated over the hexagonal ifu lenslets , and used to calculate @xmath17 directly relative to the narrow - band ifu data .",
    "the model parameters are optimized non - linearly to minimize the @xmath17 statistic .",
    "we expect appreciable degeneracies between best - fit model parameters ( i.e.  between the psf width and the intrinsic source size ) , but the parameter of greatest interest to us  the model s einstein radius @xmath31is",
    "largely orthogonal to the others .",
    "for some lenses , we constrain the center of the lensing potential to be coincident with the center of the lensing galaxy , which we determine by fitting a srsic model to the ifu continuum image . for one lens consisting of unresolved images ( j0037 ) , we fit the images with hexagonally - sampled gaussians ( constrained to have the same width as one another ) .",
    "the image positions and fluxes from these fits are then used to constrain the lens model , with @xmath17 computed from the image position and flux residuals .",
    "table  [ modelpars ] gives the measured angular einstein radii that result from our lens model fitting procedure .",
    "also shown are the einstein radii measured from a similar analysis of _",
    "hst_-acs imaging of these same systems ( @xcite ; see also @xcite )    @lllcl   & @xmath39 & @xmath40 & @xmath41 & @xmath42 + system & @xmath43 & @xmath43 & ( km s@xmath25 ) & ( km s@xmath25 ) + sdssj0037@xmath40942 & 1.49@xmath440.01 & 1.53 & 282 & 279@xmath4410 + sdssj0044@xmath50113 & 0.73@xmath440.01 & 0.78 & 259 & 266@xmath4413 + sdssj0737@xmath53216 & 1.02@xmath440.01 & 1.00 & 295 & 338@xmath4416 + sdssj1029@xmath56115 & 0.60@xmath440.01 & n / a & 241 & 228@xmath4414 + sdssj1402@xmath56321 & 1.41@xmath440.01 & 1.34 & 300 & 267@xmath4417 + sdssj2238@xmath40754 & 1.21@xmath440.02 & 1.26 & 232 & 198@xmath4411 + sdssj2302@xmath40840 & 1.03@xmath440.01 & n / a & 248 & 237@xmath44 8 + sdssj2321@xmath40939 & 1.55@xmath440.03 & 1.60 & 255 & 249@xmath44 8 +",
    "with one exception , the internal velocity gradients in the lensed emission line galaxies observed by this program are unresolved spectroscopically .",
    "the exception is j1029 , for which the rotation curve of the lensed galaxy is clearly visible .",
    "figure  [ rotcurve ] shows a section of the extracted ifu spectrum array for this system .",
    "the appearance of resolved velocity structure in the lensed source affords a unique opportunity for three - dimensional strong lens modeling : two spatial dimensions plus one velocity dimension . since multiple points in the lensed image plane coming from the same point in the source plane",
    "not only have the same surface brightness but also the same velocity , this technique can in principle constrain the lensing model in more detail than techniques using only velocity - unresolved data . in practice ,",
    "the spatial resolution of our j1029 data is not sufficient to enable a high - quality analysis .",
    "nevertheless , the wavelength - dependent ( i.e. , velocity - dependent ) lensed image structure , seen in iso - wavelength slices through the continuum - subtracted data - cube in the first and third rows of figure  [ ifu1029 ] , reveals intriguing behavior that invites a plausible explanation in terms of three - dimensional lens modeling .",
    "we describe our modeling technique here , which predicts the data - cube slices shown in the second and fourth rows of figure  [ ifu1029 ] . though the data and model disagree in detail , the qualitative features of the data are reproduced by the model .",
    "we adopt the same sie model as above to describe the mass distribution of the lensing galaxy .",
    "we model the lensed background galaxy as an infinitesimally thin , inclined exponential disk with a constant circular orbital velocity as a function of galactocentric radius and a single overall systemic average velocity along the line of sight . for any given set of parameters ,",
    "we compute the model image and velocity field of the background galaxy as seen through the lens potential .",
    "we then convolve the image and the intensity - weighted velocity and squared - velocity images with the spatial psf and the spectral resolution , and assign to each ifu fiber in the model data cube a gaussian line profile with the appropriate line intensity , central wavelength , and broadening .",
    "the @xmath17 statistic is then computed with respect to the continuum - subtracted data - cube , and the parameters are optimized non - linearly . the model shown in figure  [ ifu1029 ] represents the best result obtainable .",
    "the mismatches in detail between data and model are likely attributable to the inadequacy of the parameterized model employed .",
    "unfortunately the limited spatial resolution of the data prevent us from exploring more detailed models for the source galaxy , which might in turn allow us to constrain more detailed models for the mass distribution of the lens .",
    "( in the simpler two - dimensional modeling context above , we experienced similar difficulty with j1630 . )",
    "we have shown that the high spatial resolution ifus of the gemini - n and magellan telescopes can be used successfully to confirm the spatially extended nature of higher - redshift line emission detected along the line of sight behind lower redshift elliptical galaxies .",
    "the third ( wavelength ) dimension permits exceptionally accurate decomposition of the reconstructed narrow - band images into continuum and emission line components .",
    "the emission - line images can then be analyzed in a lensing framework virtually free from contamination by the continuum of the foreground galaxy . in a number of cases ,",
    "the ifu narrow - band emission - line images are sufficient resolution and signal - to - noise ratio to constrain gravitational - lens models that agree with models from high - resolution _ hst _ imaging to within @xmath45 rms ( i.e. , @xmath46 of a lenslet ) .",
    "this result indicates that much  though certainly not all  of the science that can be done with space - based imaging of these lenses could perhaps be done with ground - based telescopes , provided sufficient aperture , time , and image quality .",
    "space - based imaging enjoys a great advantage in the interpretation and analysis of strong galaxy - galaxy lenses with complex and irregular spatial morphology in the lensed images .",
    "this is the case for j1630 , shown in figure  [ otherifu ] , which can be seen at _ hst _ resolution to consist of five distinct and irregularly oriented knots of emission in the source plane @xcite .",
    "however , even in cases where space - based imaging is clearly superior for lens modeling , ifu spectroscopy is of great value as an independent confirmation of the lensing hypothesis .",
    "we have also demonstrated the technique of three - dimensional strong gravitational lens modeling , which is currently only feasible using large ground - based telescopes such as gemini and magellan .",
    "although the demonstration data presented here are of insufficient resolution for high - quality lens modeling , we consider this application to hold great promise , particularly if it can be deployed in combination with adaptive optics .    based in part on data gathered with the 6.5 meter magellan telescopes located at las campanas observatory , chile .",
    "+ based in part on observations obtained under program gn-2004a - q-5 at the gemini observatory , which is operated by the association of universities for research in astronomy , inc .",
    ", under a cooperative agreement with the nsf on behalf of the gemini partnership : the national science foundation ( united states ) , the particle physics and astronomy research council ( united kingdom ) , the national research council ( canada ) , conicyt ( chile ) , the australian research council ( australia ) , cnpq ( brazil ) and conicet ( argentina ) .",
    "the format of the data delivered by the gmos - n and imacs ifus to their respective ccd - mosaic detectors is sufficiently complicated to justify analysis with specially - developed software .",
    "furthermore , the scientific application of strong lens modeling requires highly accurate wavelength calibration , flat - fielding , and sky subtraction . for these reasons ,",
    "we have developed our own set of ifu data - analysis software tools written in the idl language .",
    "although there is an officially maintained and distributed package for the reduction of gmos ifu data under iraf , there is no such package for imacs . having developed our own imacs routines , we preferred adapting them to gmos usage over using the official gmos package .",
    "we refer to our software as `` kungifu '' ( kung eye eff you ) , and in this appendix we describe its function .",
    "the kungifu package can be obtained for usage by other investigators by contacting the authors , though the authors are unable to offer user support beyond the distributed documentation .",
    "the imacs detector consists of a mosaic of eight @xmath47-pixel ccds .",
    "the bias level of raw frames varies between the ccds , within each ccd , and from one exposure to the next . for any given exposure",
    ", the bias is well characterized as the sum of row - overscan and column - overscan terms .",
    "our imacs bias - subtraction routine first fits a smooth b - spline model @xcite to the overscan region at the end of each row for a specified breakpoint spacing .",
    "this model is evaluated for all pixels in all rows of the image and subtracted .",
    "the imacs bias level also has significant column - dependence , and a similar bspline fit to the overscan region at the end of each column is subtracted next .",
    "the bias - subtracted and overscan - trimmed individual ccd images are then stored to a single multi - extension fits ( mef ) file .",
    "the detailed gmos - n bias pattern is more stable that the imacs bias pattern , but can not be estimated from the overscan alone .",
    "thus we perform gmos - n bias subtraction using mean bias images , and also subtract an overall average bias value for each of the three gmos - n ccds from the overscan region to account for slight variations . in two - slit ifu mode , the central ccd records spectra from both pseudo - slits .",
    "we break the central ccd into 2 logically separate images to separate these two regions , and store them as separate mef extensions along with the first and third ccds , after bias subtraction and overscan trimming .",
    "relative flux calibrations of the imacs and gmos - n ifus are accomplished using dispersed ifu exposures of uniform spatial illumination by ( approximately ) flat - spectrum incandescent lamps .",
    "note that highly uniform spatial illumination with facility calibration equipment over such small ifu fields of view is much more easily achieved than similarly uniform illumination over wide direct - imaging fields of view .",
    "these raw spectroscopic flat images measure the product of two non - uniform responses : the relative sensitivity of individual ccd pixels , and the fiber response image ( including both individual fiber profiles and relative throughput differences between fibers ) . in an ideal spectrograph",
    "the illumination pattern of the fibers would be fixed relative to the detector , and these two effects would never need to be distinguished .",
    "in actuality both gmos - n and imacs exhibit limited flexure between successive exposures that causes the ifu fiber spectra to shift their position in ccd coordinates .",
    "thus we perform a factorization of the pixel - response and fiber - response calibrations by assuming an approximate scale separation between them . since the ifu fiber spectra for all data obtained for this work run approximately along ccd rows , horizontal cross sections through the ifu spectroscopic flat frames follow the smooth variation of the flat - lamp spectrum , modulated by gradual transitions from one fiber to the next .",
    "we generate smooth models of the spectroscopic flat - field images by fitting b - spline models to these cross sections , with a breakpoint spacing chosen ideally to be smaller than the typical scale of flat - lamp features but greater than the scale of pixel - to - pixel defects .",
    "the resulting model - flat images are an approximation to the fiber response , and the ratio of raw- to model - flat images give the approximate pixel response(pixel flat ) .",
    "figure  [ flat_fig ] demonstrates this flat - field factorization graphically .",
    "we derive a master pixel flat from the median - image of many individual pixel flats in a given spectrograph configuration , for application to all science frames in that configuration .",
    "we choose not to use imaging flats to calibrate the pixel response , since this calibration can in general be wavelength - dependent . using pixel flats derived from spectroscopic flat - field frames",
    "ensures that the correction is derived with illumination at the appropriate wavelength .",
    "we describe our use of the model - flat images for the calibration of fiber response in ",
    "[ extract ] below .",
    "we also use the model - flat images to determine the location of individual fiber traces on the ccd .",
    "for both the imacs and gmos - n ifus , fibers along the output pseudo - slit are grouped into blocks of 50 , with median inter - fiber spacings on the detector of 3.5 and 5.7 pixels respectively for imacs ( in the @xmath9 or `` short '' camera mode ) and gmos - n .",
    "fibers are approximately equally - spaced within the blocks , and we use this fact to our advantage to locate and trace all 50 fibers in a block at once . for the purpose of locating block positions relative to one another , our automatic tracing routine also makes use of a table of inter - block separations in units of the approximate local inter - fiber spacing ( which will be independent of pixel scale ) , which is determined once for each ifu by a careful analysis of a model - flat cross section .",
    "all imacs and gmos - n spectroscopic exposures exhibit a non - negligible scattered - light background not directly associated with the flux through the fibers , as evidenced by non - zero count levels in the inter - block regions where the flux from the fibers drops essentially to zero .",
    "for all ifu frames used in this work  calibrations and science exposures  we subtract a model of this background after pixel - flat correction .",
    "we estimate this scattered - light image from the observed levels between the fiber blocks .",
    "we use the flat - field - derived trace solution to define bands in the inter - block regions running parallel to the spectra , with a reasonable buffer to avoid the wings of the fiber cross sections .",
    "each band is fit with a bspline as a function of column , and this fit is subsequently evaluated for each column .",
    "we then interpolate this fit across the fiber blocks by fitting a bspline in each column , taking the band centers in that column as dependent variables and the previous - fit evaluations in that column as independent variables .",
    "the b - spline breakpoint spacing in each fit may be adjusted according to the signal - to - noise in the scattered light levels and the degree of structure that one wishes to model .",
    "imacs and gmos - n ifu observations distribute the photons from a few dozen square arc - seconds of the sky over a few tens of millions of ccd pixels . thus for all but the brightest objects , low signal - to - noise is a primary concern .",
    "this fact combined with the well - behaved profile of the ifu fibers on the ccd suggests optimal spectrum extraction as a natural approach ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "in an optimal extraction , the specific flux of a spectrum at a given wavelength is determined not from a simple sum over pixels within a defined aperture , but rather from the amplitude of a maximum - likelihood fit of a model cross section to the observed spectral cross section at that wavelength .",
    "this gives the maximum signal - to - noise in the extracted spectrum , and is unbiased to the extent that the model cross section matches the actual cross section .",
    "the most apparent obstacle to optimal extraction of imacs and gmos - n ifu data ( aside from the sheer number of spectra ) is the significant overlap between neighboring spectra .",
    "fortunately the situation is less dire for fiber - fed ifus such as those of imacs and gmos - n than for multi - object multi - fiber spectrographs , since adjacent fibers on the detector are also adjacent on the sky ( an explicit design feature ) . since the @xmath7-diameter ifu lenslets will critically sample all but the very best ground - based seeing , the blending of neighboring fiber spectra on the detector leads to no significant loss of information @xcite .",
    "furthermore , modeling of the fiber profile is unnecessary , since the model flats described in [ mflat ] provide us with a high signal - to - noise determination of the spectrum cross - sectional shape for all fibers and at all wavelengths .    before using the model flats for the extraction of spectra from the pixel - flat corrected and scattered - light subtracted object frames",
    ", we first normalize the model flats ( also scattered - light subtracted ) by dividing out a crude approximation to the flat - field lamp spectrum as a function of wavelength .",
    "this step is not crucial ( particularly if one eventually performs an absolute flux calibration ) , but it prevents the flat - lamp spectrum from being imprinted on the data before flux calibration .",
    "we note that it is not important to use an exceedingly accurate model of the lamp spectrum , but only to divide all pixels with the same wavelength by the same value .",
    "next we shift the model flats perpendicular to the dispersion direction with a flux - conserving damped - sinc kernel so as to maximize the cross - correlation between the model - flat image and the object - frame image to be extracted .",
    "this shifting of the model flat accounts for the slight ( typically of order 1 pixel or less ) flexure that can occur between the object frames and the flat frames taken immediately following .",
    "our approach to extraction is described mathematically as follows . we define boundaries between fiber spectra by lines exactly half - way between the fiber traces , and in each ccd column @xmath15 we associate with fiber @xmath48 all pixels ( i.e.  rows ) @xmath49 falling between the boundaries on either side .",
    "pixels split by the boundary are associated fractionally ( see figure  [ flat_fit ] ) .",
    "let @xmath50 express this weighting : @xmath51 for rows @xmath49 wholly within the boundaries for fiber @xmath48 in column @xmath15 , 0 for rows wholly outside , and between 0 and 1 for rows fractionally included .",
    "let @xmath52 be the data frame to be extracted , @xmath53 be the statistical variance of @xmath52 , and @xmath54 be the aligned , normalized model flat - field image of the fiber response .",
    "the optimally extracted specific flux in fiber @xmath48 at column @xmath15 ( corresponding to a particular wavelength by the dispersion solution for that fiber ) , which we denote @xmath55 , will be given by the value that minimizes @xmath56 which is @xmath57 a simple adjustment of this expression suggests a more succinct conceptual and operational approach : @xmath58 this instructs us to obtain the optimally extracted specific flux by dividing the data image by the model - flat image , then computing a weighted average over the appropriate fiber / column window , with the statistical weight given by the product of the squared model - flat image and the inverse - variance image .",
    "we implement the extraction algorithm in this manner .",
    "the flat - fielding procedure thus yields calibrated specific intensity measurements ( flux per unit wavelength per unit area ) in a relative sense at any given wavelength across the entire spatial field , though the absolute extracted flux values are not meaningful unless and until an absolute flux calibration is applied .",
    "the optimal - extraction technique also provides a natural means for rejecting cosmic - ray ( cr ) hits in single exposures , because cosmic rays generally will not have the same shape as the fiber cross section .",
    "we flag pixels with highly statistically significant positive deviations between the data frame and the optimal - extraction model frame as cr pixels and grow the resulting cr mask to laterally - adjacent pixels , then repeat the extraction with cr pixels given zero weight .    we store the extracted ifu object spectra for each ccd in the imacs and gmos - n mosaics as a separate image extension in a single mef file for a single exposure .",
    "these spectrum images have a horizontal dimension equal to that of the ccd and a vertical dimension equal to the number of fibers with spectra falling on the ccd , and are not rectified in wavelength but rather have a unique wavelength sampling for each spectrum .",
    "we note here that storing the data in this two - dimensional spectrum - image form instead of in the `` data - cube '' form of two spatial dimensions by one spectral dimension affords a distinct advantage even for wavelength - rectified data ( [ rect ] ) in that it preserves the integrity of the detector frame .",
    "we establish wavelength calibration using exposures of he - ne - ar ( for imacs ) and cu - ar ( for gmos - n ) arc lamps .",
    "we first process arc images by subtracting the bias level , dividing by a pixel flat , and subtracting a scattered - light image model .",
    "we then use the most closely - associated ( in time ) model spectroscopic flat , globally sinc - shifted perpendicular to the dispersion direction if needed for alignment , to perform an optimal extraction as described in ",
    "[ extract ] .",
    "the model flat image is not normalized in wavelength since the wavelength calibration is as yet unknown . within the resulting set of extracted arc spectra",
    ", we identify as many individual bright lines as possible .",
    "the centroids of these lines are found in each spectrum through an iterative linearized gaussian centroiding algorithm that also measures the width of each line in the dispersion direction . the median line - spread width for each fiber",
    "is saved for later use .",
    "due to global curvature of the pseudo - slit image on the detector mosaic , each fiber spectrum has its own unique dispersion solution , as would be the case for the individual rows in a single long - slit spectrum .",
    "furthermore , discrete offsets in the dispersion direction of 50-fiber blocks relative to one another , as well as offsets of individual fiber spot positions from the mean within their blocks , make a global 2d dispersion solution impractical .",
    "rather , we use the set of arc line positions in each fiber to derive the individual dispersion solution in that fiber _ relative to a baseline defined by the average arc - line position across all fibers _ , which we refer to as the `` pixel - wavelength '' baseline .",
    "we derive this solution in the following iterative fashion .",
    "first , for each arc line , we compute the simple average centroid position ( ccd column ) across all fibers , which we take to be the pixel - wavelength of that line .",
    "we then fit the position of all lines in each fiber spectrum with a low - order ( linear or quadratic ) polynomial function of this single pixel - wavelength baseline .",
    "we then use the average residuals of these fits across all fibers to correct the adopted pixel - wavelength values for each line and re - fit .",
    "this process converges rapidly after a few iterations , and the resulting polynomial solutions are accurate to within a few hundredths of a pixel rms difference between arc - line centroids as measured and as predicted by the fit ( equivalent to a few hundredths of an angstrom rms at the dispersions used in this work ) .",
    "this process  which amounts to the determination , but not the application , of a wavelength - rectifying solution  has several advantages .",
    "first , one need not know the identifications of the arc lines used .",
    "second , one need not exclude blended lines , since any bias introduced by blended lines into the independent variable ( pixel ) will be exactly canceled in the dependent variable ( pixel - wavelength ) .",
    "finally , the strategy reduces absolute wavelength calibration to a one - dimensional problem .",
    "once the solution for pixel as a function of pixel - wavelength has been determined for each individual fiber , we determine the single solution for physical wavelength as a function of pixel wavelength .",
    "we first use the ( inverse ) pixel - wavelength solution to determine the central pixel - wavelength of each pixel in the extracted arc frame .",
    "we then perform a single b - spline fit to the extracted arc flux as a function of pixel wavelength across all fibers . from a signal - to - noise point of view",
    "we are effectively stacking all the individual arc spectra , but rather than re - binning / rectifying in ( pixel-)wavelength , we fit to the data in their native pixel sampling . we identify peaks in the fitted b - spline model , and fit a polynomial solution for the absolute wavelength calibration .",
    "a further benefit of our decomposition of the wavelength calibration problem into relative and absolute steps is that even arc lines detected at snr @xmath59 in individual fiber spectra can be robustly centroided in the global b - spline model and used in the fit .",
    "note that the separation into relative and absolute wavelength calibration is entirely analogous to the usual separation of flux calibration into the relative step of flat - fielding and a subsequent step of absolute calibration using a flux standard .",
    "when applying the wavelength calibration to the science data , we also correct for slight flexure between the object frames and the dispersion solution from the calibrating arc frame by fitting for a low - order two - dimensional polynomial transformation as defined by the positions of known night - sky emission lines .",
    "both the gmos - n and imacs ifus incorporate dedicated fiber bundles for the observation of blank sky , from which to estimate the foreground level to be subtracted from the science data . as discussed by @xcite , there is a distinct advantage in the estimation and subtraction of the night - sky spectrum before performing any rectification in wavelength .",
    "the multiple fibers of the ifu fields of view each have a slightly different wavelength sampling on the detector , and hence the discretely sampled line - spread function ( lsf ) observed for night - sky emission lines depends upon the sub - pixel location of the line s central wavelength .",
    "the native binning of the ccd , when considered for all blank - sky fibers together , provides a finely - sampled observation of the night sky spectrum .",
    "we thus fit a bspline model to this data as a function of the central pixel - wavelength of each native spectral pixel , which we then evaluate for all fibers ( object and sky ) and subtract as our sky model .",
    "the extracted one - dimensional lsf of the imacs and gmos - n ifus exhibits some variation due to global distortions and fiber - optic heterogeneity , which we characterize via the lsf width measured for each fiber from arc frames as described in [ wavecal ] above .",
    "this lsf width is then treated as a second independent variable in the bspline model , fitted with linear or quadratic dependence .",
    "figure  [ sky_sub ] shows the results of @xmath15-band sky subtraction for a single 900-s gmos - n frame , and figure  [ sky_signif ] characterizes the typical statistical quality of sky subtraction across the observational sample .      to facilitate the combination of multiple exposures ( and to make analysis more straightforward ) , we rebin our sky - subtracted ifu spectra onto a uniform wavelength baseline .",
    "we use a constant - wavelength binning across the spectrum , with bin size slightly larger than the largest native pixel - width , so that only nearest - neighbor correlations will be present in the rebinned frames .",
    "the wavelength - bin boundaries are specified in heliocentric vacuum wavelengths , corrected with a heliocentric velocity shift appropriate to each observation , converted to air wavelengths , and mapped into the extracted ifu frames using the arc - frame dispersion solution , as adjusted to match the observes night sky lines .",
    "multiple exposures are then combined after re - binning , with further cosmic - ray rejection .",
    "finally , the rebinned data from individual ccds are combined onto a single mosaic image that maintains the native orientation of the spectra on the detector mosaic . as a data product ,",
    "we prefer this mosaic to a three - dimensional `` data cube '' ( 2 spatial plus 1 spectral dimension ) because it allows the reduced data to be displayed all at once in the frame of the detector .",
    "data cubes may always be constructed using the ifu field - mapping .",
    "we do not rebin our data spatially , since all observations were made with single undithered telescope pointings .",
    "flux calibration is currently not implemented as an integral aspect of the kungifu tasks , and is not necessary for gravitational - lens modeling using emission - line images at a single wavelength . in order to judge the depth of our observations and the scale of emission - line luminosities observed , we implement a somewhat crude flux calibration for our gravitational - lens candidate sample through a bootstrap connection to the flux - calibrated sdss spectra , which were obtained through a single @xmath60-diameter fiber aperture that can be synthesized from within the ifu field of view .      , b.  c. , & dressler , a.  m. 2003 , in instrument design and performance for optical / infrared ground - based telescop es .",
    "edited by iye , masanori ; moorwood , alan f. m. proceedings of the spie , volume 484 1 , pp .",
    "1727 - 1738 ( 2003 ) . ,",
    "17271738                  , i. , et  al . 2003 , in instrument design and performance for optical / infrared ground - based telescop es . edited by iye , masanori ;",
    "moorwood , alan f. m. proceedings of the spie , volume 484 1 , pp .",
    "1645 - 1656 ( 2003 ) . ,",
    "16451656                        , g.  j. , et  al .",
    "2003 , in instrument design and performance for optical / infrared ground - based telescop es . edited by iye , masanori",
    "; moorwood , alan f. m. proceedings of the spie , volume 484 1 , pp .",
    "1750 - 1759 ( 2003 ) .",
    ", 17501759      , j. , dodsworth , g.  n. , content , r. , & allington - smith , j.  r. 2004 , in ground - based instrumentation for astronomy .",
    "edited by alan f. m. moorwood and iye masanori .",
    "proceedings of the spie , volume 5492 , pp . 624 - 633 ( 2004 ) . , ed .",
    "a.  f.  m. moorwood & m.  iye , 624633"
  ],
  "abstract_text": [
    "<S> we present the observational results of a survey for strong gravitational lens systems consisting of extended emission - line galaxies lensed by intervening early - type galaxies , conducted using integral field units ( ifus ) of the magellan imacs and gemini gmos - n spectrographs . </S>",
    "<S> these data are highly valuable for corroborating the lensing interpretation of hubble space telescope imaging data . </S>",
    "<S> we show that in many cases , ground - based ifu spectroscopy is in fact competitive with space - based imaging for the measurement of the mass model parameters of the lensing galaxy . </S>",
    "<S> we demonstrate a novel technique of three - dimensional gravitational lens modeling for a single lens system with a resolved lensed rotation curve . </S>",
    "<S> we also describe the details of our custom ifu data analysis software , which performs optimal multi - fiber extraction , relative and absolute wavelength calibration to a few hundredths of a pixel rms , and nearly poisson - limited sky subtraction . </S>"
  ]
}