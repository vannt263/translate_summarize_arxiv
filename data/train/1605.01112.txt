{
  "article_text": [
    "since its first isolation , preparation , and theoretical description @xcite , graphene , a monolayer of carbon atoms distributed in a hexagonal lattice , has attracted a tremendous amount of interest in science and engineering due primarily to its outstanding physical properties and potential for novel applications .",
    "graphene was shown to have remarkable mechanical strength @xcite and extremely high thermal conductivity @xcite , making it a particularly appealing materials platform for nano - electromechanical applications and management of thermal processes in nanoelectronic circuits @xcite .",
    "in addition , the high carrier mobility of graphene enhances its potential for applications to high - frequency electronics @xcite . these and other remarkable properties of graphene have spurred new research into and development of new two - dimensional ( 2d ) materials , such as hexagonal boron nitride ( _ h_-bn ) , silicene ( a monolayer of silicon ) , and transition - metal dichalcogenide ( tmdc ) monolayers @xcite , each with their own array of unique physical properties .",
    "one additional compelling aspect of 2d materials ( 2dms ) is closely related to their optical properties .",
    "graphene , for example , is nearly transparent at optical frequencies , exhibiting absorption of only about 2.3% @xcite , which suggests it barely interacts with light .",
    "this optical transparency and the earlier mentioned electro - mechanical properties make graphene a promising new material for flexible optical devices @xcite ( e.g. , touch screens ) .",
    "moreover , graphene based structures can provide an alternative to conventional metallo - dielectric structures to spatially confine and guide light at the nanoscale , a research direction actively pursued in the emerging field of graphene nanoplasmonics  @xcite .",
    "in addition to these linear physical properties , the nonlinear optical properties of graphene and other 2d materials have attracted increased attention .",
    "graphene , as a centrosymmetric material , exhibits large third - harmonic generation ( thg ) @xcite , strong optical kerr nonlinearity @xcite , and induced second - order nonlinearity @xcite in a single atomic layer .",
    "this allows one to employ graphene in active photonic devices with improved functionality , including ultra - compact modulators , optical limiters , frequency converters , and photovoltaic and photoresistive devices @xcite . in a complementary fashion ,",
    "tmdc monolayers are semiconducting materials , which renders them particularly suitable to be employed in nanoscale transistors and saturable absorbers @xcite , and have non - centrosymmetric atomic lattice and hence allow even - order nonlinear optical processes @xcite .",
    "the implementation of these linear and nonlinear optical properties into applications , however , requires advances in nanofabrication and experimental techniques @xcite , theoretical models , and numerical methods for modeling of devices incorporating 2d materials .",
    "there is a multitude of numerical methods for computational study of optical structures and devices comprising regular , three - dimensional ( 3d ) materials @xcite , and they can in principle be used for modeling 2d materials , too .",
    "this is customarily done by defining an effective thickness of the material and incorporating the 2 dm into the computational algorithm simply as a very thin layer of 3d material @xcite .",
    "this computational approach , albeit simple and easy to implement , has a serious drawback , namely it relies on an obviously ambiguous quantity , the thickness of the monolayer .",
    "moreover , this thickness is typically orders of magnitude smaller than the other characteristic lengths of the photonic structure and the operating wavelength , leading to a large length - scale imbalance that is detrimental to the effectiveness of the spatial discretization .",
    "these issues result in potentially reduced accuracy , increased computational cost , and numerical artefacts that are difficult to avoid @xcite .",
    "it is hence desirable to treat the sources of the optical effects pertaining to the 2 dm as confined to a 2d manifold , i.e. as induced by a surface conductivity @xcite .",
    "the numerical method proposed here follows this approach and implements it in the context of the rigorous coupled - wave analysis ( rcwa ) method , a modal frequency domain method for modeling periodic optical structures @xcite .",
    "however , in addition to previous work on handling 2dms by means of fourier series expansion methods @xcite , we also model nonlinear optical effects in 2d materials , in particular second - harmonic generation ( shg ) and thg , and provide the mathematical formulation for arbitrary nonlinear optical processes .",
    "in addition , the method introduced in this work allows one to describe structured 2d materials , which themselves can be embedded in inhomogeneous 3d optical structures .",
    "the remainder of this paper introduces the general periodic optical system under consideration in section  [ sec : geommaterparam ] and gives a detailed overview of linear and nonlinear optical properties of different 2dms in section  [ sec : linnonlinprop ] .",
    "section  [ sec : mathformulation ] provides the mathematical formulation for higher - harmonic generation in patterned 2dms based on the rcwa and introduces the inhomogeneous scattering matrix formalism for multilayered 3d structures .",
    "this is followed by section  [ sec : convergence ] , where the validation and benchmarking of the numerical method is performed , using as test problems one - dimensional ( 1d ) and 2d periodic structures .",
    "applications of the proposed numerical method are presented and discussed in section  [ sec : examples ] , where we also investigate different resonant mechanisms to enhance the nonlinear optical response of 2d-3d heteromaterials containing tdmc monolayers and nanostructured graphene .",
    "finally , the main conclusions are drawn and an outlook towards future work is given in section  [ sec : conclusions ] .",
    "the computational method introduced in this article is designed for a very general physical setting , namely periodically patterned photonic structures that contain both bulk and 2d optical materials .",
    "our numerical method accurately describes the physics of such photonic structures by incorporating in the numerical algorithm the relevant linear and nonlinear optical effects pertaining to 2d materials .",
    "equally important , since the nonlinear optical response of different 2d materials contained by the photonic structure is described via a generic nonlinear polarization , this computational method can be used to investigate a multitude of nonlinear optical effects , including shg , sum- and difference - frequency generation , thg , and four - wave mixing .    the geometric setting and important nomenclature used in the presentation of our numerical method",
    "are introduced in what follows .",
    "thus , consider the generic multilayer , periodic structure presented in fig .",
    "[ fig : multilayerstructure ] . the birds - eye view in fig .",
    "[ fig : multilayerstructure ] depicts the unit cell of a 2d - periodic structure with periods @xmath0 and @xmath1 , with the corresponding grating vectors , @xmath2 and @xmath3 , laying in the @xmath4-plane .",
    "it consists of several bulky , periodically structured regions with relative electric permittivity , @xmath5 , which will be called bulk - layers , or simply layers .",
    "the periodic structure is sandwiched in - between semi - infinite homogeneous cover and substrate layers with relative permittivity , @xmath6 and @xmath7 , respectively .",
    "in addition , the structure can comprise 2 dm sheets , or simply sheets , located at @xmath8 , which are assumed to lay in the @xmath4-plane between two bulk - layers .",
    "each sheet is made of homogeneous or periodically patterned 2dms and is described by its surface conductivity distribution , @xmath9 .",
    "- and @xmath10-direction under plane wave incidence , and a close - up of the unit cell .",
    "the distribution of the 2d material ( blue ) is defined by the position dependent sheet conductance , @xmath9 , at @xmath11 .",
    "the bulk part of the periodic structure , which can consist of slanted ( olive green ) , straight walled ( red ) , or embedded parts ( sand brown ) , is defined by the permittivity function @xmath12 . ]",
    "this periodic structure is excited by an incident harmonic plane wave with the electric field given by : @xmath13 where @xmath14 is the angular frequency , @xmath15 is the in - plane component of the position vector , @xmath16 and @xmath17 are the in - plane and normal components of the wave vector of the incident wave in the cover , respectively , with @xmath18 being the wavenumber in the cover region and @xmath19 is the speed of light .",
    "the polarization state of the incoming plane wave is described by the field components in the transverse electric ( te ) and transverse magnetic ( tm ) configurations , namely @xmath20 and @xmath21 , respectively , such that @xmath22 is determined by the polarization angle , @xmath23 .    in the rigorous coupled - wave analysis , the underlying algorithm on which our computational method is built , oblique structures or devices consisting of several periodic layers are approximated in a staircasing manner ( see ref .",
    "@xcite ) . to be more specific ,",
    "the structure is sliced into thin and @xmath24-invariant bulk - layers , the optical response of each layer is calculated , and then the combined response of all layers is determined by properly incorporating the inter - layers optical coupling described in section  [ sec : inhomsmatrix ] . before this algorithm",
    "is derived thoroughly in section  [ sec : mathformulation ] , the optical properties of 2dms are introduced and formalized mathematically in the next section .",
    "understanding the physics of 2dms is a rather recent endeavor and as such a comprehensive characterization of their linear and nonlinear optical properties is only emerging .",
    "in particular , a complete knowledge of the frequency dependence of the linear and nonlinear optical constants is a prerequisite for a rigorous computational description of the optical response of these materials .",
    "theoretical calculations @xcite and experimental investigations @xcite are beginning to fill in this gap , a summary of the results of these studies being briefly outlined in this section .",
    "since graphene and other 2dms are physical systems consisting of a single atomic layer , their electromagnetic properties are conveniently characterized by surface quantities .",
    "for example , in the case of graphene , the optical properties are described by the sheet conductance ( sometimes simply called conductivity ) , which in the random - phase approximation and zero temperature conditions can be expressed as @xcite : @xmath25 here , @xmath26 is the universal dynamic conductivity of graphene , @xmath27 denotes the elementary charge , @xmath28 the fermi level , @xmath29 the reduced planck constant , @xmath30 the relaxation time and @xmath31 is the heaviside step function .",
    "the values of the fermi level and relaxation time used throughout this study are @xmath32 and @xmath33 , respectively . the dispersion of @xmath34 for graphene is shown in fig .",
    "[ fig : mat_linear_properties](a ) .    , of graphene in interband and intraband wavelength range .",
    "b ) , c ) frequency dependence of the real and imaginary parts of the sheet conductance of several tmdc monolayer materials , respectively . ]    [ cols=\">,^,^,^,^,^,^,^,^,^,^,^,^ \" , ]     the sheet conductance contains the intraband ( drude ) contribution , described by the first term in the r.h.s .",
    "of eq .  , and",
    "the interband component given by the next two terms . a more complete model valid at finite temperature can be used ( see refs .",
    "@xcite ) ; however , the model described by eq .   already captures the main features of graphene conductivity , most notable being the possibility of tuning @xmath34 by changing the fermi level via chemical doping or applying a gate voltage .    in many numerical methods pertaining to computational electromagnetics",
    "it is more convenient to work with bulk rather than surface quantities and therefore one often introduces bulk equivalents of the surface quantities . in particular , instead of the sheet conductance , @xmath35 , one uses a bulk conductivity , @xmath36 , where @xmath37 is the effective thickness of the 2 dm .",
    "this approach can oftentimes create confusion due to the ambiguity contained in the definition of the thickness of an atomic monolayer .",
    "moreover , the electromagnetic properties of 2dms can alternatively be described by the electric permittivity , @xmath38 , which is related to the optical conductivity @xmath39 via the following relation : @xmath40    in the case of tmdc monolayer materials , we describe their relative electric permittivity , @xmath41 , as a superposition of @xmath42 lorentzian functions : @xmath43 where @xmath44 , @xmath45 , and @xmath46 are the oscillator strength , resonance frequency , and spectral width of the @xmath47th oscillator , respectively .",
    "the values of the model parameters for the four considered tmdc monolayers were determined by fitting eq .   to the experimental data provided in ref .",
    "@xcite and are presented in table  [ tab : lorentzianparameters ] in terms of @xmath48 , @xmath49 , and @xmath50 .",
    "note that the permittivity given by eq .",
    "fulfils the kramers - kronig relation ; however , the numerical fitting is less accurate for @xmath51 ( @xmath52 ) due to the limited range of the available experimental data .",
    "the spectra of @xmath53 , a physical quantity related to the optical absorption in the material , and @xmath54 are depicted in figs .",
    "[ fig : mat_linear_properties](b ) and [ fig : mat_linear_properties](c ) , respectively . for each tmdc",
    ", @xmath53 exhibits spectral peaks at wavelengths specific to the particular 2 dm : the absorption peaks of @xmath53 with highest and second highest wavelength for each material ( shown for mose@xmath55 as @xmath56 and @xmath57 , respectively ) correspond to low - energy interband transitions at the @xmath58-point of the first brillouin zone due to splitting of the valence - band by spin - orbit coupling , whereas peaks at lower wavelengths correspond to higher energy interband transitions @xcite .",
    "the lattices of graphene and tmdc monolayers belong to different space symmetry groups , which means that each of these materials requires a separate treatment .",
    "the graphene lattice belongs to the @xmath59 space group , as illustrated in fig .",
    "[ fig : groupstructure ] , which means that graphene is a centrosymmetric material and thus shg is a forbidden nonlinear optical process . on the other hand",
    ", thg is an allowed , particularly strong process in graphene @xcite , which makes it a suitable material for nonlinear optical applications .",
    "by contrast , tmdc monolayers belong to the @xmath60 space group @xcite so that in this case shg is the lowest - order nonlinear optical process .    , left ) and tmdc monolayers ( symmetry group @xmath60 , right ) .",
    "the hexagonal lattice of graphene is centrosymmetric and thus shg is forbidden . by contrast , the lattice of tmdc monolayers is noncentrosymmetric and as such shg is allowed . ]",
    "the nonlinear optical response of graphene can be described by using the nonlinear optical conductivity tensor , @xmath61 , which relates the nonlinear surface current density , @xmath62 , and the electric field , @xmath63 , at the fundamental frequency ( ff ) .",
    "thus , if we assume that the graphene sheet lies in the @xmath4-plane at @xmath24=0 , the nonlinear current density , @xmath64 , can be written as : @xmath65 where @xmath66 is the position vector lying in the graphene plane .",
    "then , the nonlinear surface current density can be written as : @xmath67 where @xmath68 is the electric field component lying in the plane of graphene . in this description @xcite ,",
    "the nonlinear current density lies in the plane of graphene and only depends on the tangential field components . as a result , @xmath69 and @xmath70 .",
    "a formula for @xmath71 , derived under the assumptions that electron - electron and electron - phonon scattering as well as thermal effects can be neglected , has been recently derived in ref .",
    "@xcite and reads : @xmath72 in this equation , derived using perturbation theory , @xmath73 , @xmath74 and @xmath75 is the fermi velocity , with @xmath76 being the nearest - neighbor distance between carbon atoms in graphene and @xmath77 is the nearest - neighbor coupling constant .",
    "figure  [ fig : mat_nonlinear_properties](a ) depicts @xmath78 and additionally highlights the lowest spectral peak at @xmath79 in the inset of the figure .",
    "similarly to the linear case , one can introduce a `` bulk '' nonlinear conductivity , @xmath80 .",
    "this nonlinear conductivity is particularly useful in experimental investigations of nonlinear optics of graphene because it is related to an effective bulk third - order nonlinear susceptibility , @xmath81 , the physical quantity that is usually measured experimentally .",
    "using the fact that for harmonic fields @xmath82 , where @xmath83 is the nonlinear polarization , one can easily show that @xmath84 where @xmath85 is the frequency at the third - harmonic ( th ) , with @xmath86 being the fundamental frequency .",
    "in contrast to graphene , tmdc monolayers are non - centrosymmetric ( see fig .  [",
    "fig : groupstructure ] ) and therefore shg is allowed @xcite .",
    "based on the symmetry properties of their space group , @xmath60 , it can be shown that the structure of their quadratically nonlinear susceptibility tensor , @xmath87 , yields only one independent , non - vanishing component @xcite : @xmath88 where @xmath89 is the armchair direction of the monolayer and @xmath10 the orthogonal zig - zag - direction .",
    "the nonlinear surface conductivity tensor , @xmath90 , has the same structure and is related to the nonlinear susceptibility via a relation similar to eq .",
    ": @xmath91 @xmath92 being the second - harmonic ( sh ) frequency .    .",
    "b ) spectral dependence of the effective bulk quadratic nonlinear susceptibility @xmath93 of three tmdc monolayer materials and the value of the dominant component of @xmath94 for gaas , given for reference . for @xmath95 , the experimental noisy data ( black line ) has been smoothed out ( blue line ) . ]",
    "numerical values for the effective thickness of the four tmdc monolayer materials are taken from ref .",
    "@xcite and are presented in table  [ tab : lorentzianparameters ] .",
    "although the tensorial structure expressed in eq .   already qualitatively determines the nonlinear surface current , @xmath96 the particular value of @xmath97 ( and hence that of @xmath98 ) is of practical importance .",
    "reliable values over a certain spectral range exist for @xmath99 @xcite , @xmath100 @xcite , and @xmath101 @xcite and are depicted in fig .",
    "[ fig : mat_nonlinear_properties](b ) . despite these materials consisting of just a single atomic layer ,",
    "the largest values of @xmath102 , @xmath103 , and @xmath104 , respectively , have comparable magnitude to that of gaas , @xmath105 , a medium with strong bulk quadratic susceptibility @xcite .",
    "it is also instructive to compare the strength of the shg in tmdc monolayer materials to that in noble metals , as in both cases the sh is generated largely in a single atomic layer . to this end , we introduce a surface quadratic nonlinear susceptibility tensor , @xmath106 , which we then compare to the surface quadratic nonlinear susceptibility tensor of au and ag .",
    "the highest value of @xmath107 of @xmath99 is @xmath108 and is hence comparable to the dominant component , @xmath109 , for ag and au , i.e. @xmath110 and @xmath111 @xcite , respectively .",
    "this section will introduce a numerical method for calculating the nonlinear optical interaction of light with periodic structures consisting of 2dms embedded in dielectric or metallic patterned media .",
    "nonlinear optical effects in the bulk part of periodic structures are not considered in this article , as there already exist numerical formulations that are compatible with @xcite or complementary to @xcite the proposed method to accurately calculate these bulk nonlinear optical effects .    to this end , the undepleted pump approximation will be used as a means to introduce the nonlinear optical interactions in the governing maxwell equations ( mes ) .",
    "since the basis of the proposed numerical method is the rcwa , this method will be briefly revisited and the necessary mathematical formalism derived .",
    "then , a modified boundary condition for interfaces incorporating conductive , potentially nonlinear 2dms , is considered and a numerically stable @xmath112-matrix algorithm for propagation of nonlinear fields generated by the monolayers of 2dms in multilayered periodic structures is derived to complete the proposed algorithm .",
    "importantly , the thickness of the 2dms does not enter in our numerical method , thus removing an ambiguity present in other numerical methods currently used to describe these materials @xcite .",
    "this section introduces the physical and mathematical model for multi - frequency , nonlinear optical interaction in the so - called undepleted pump approximation . for a more complete description of this theoretical approach",
    "we refer the reader to ref .  @xcite . to this end , let us assume that the real electric field , @xmath113 , as a function of position , @xmath114 , and time , @xmath115 , is composed of @xmath116 monochromatic waves with pairwise different optical frequencies , @xmath117 , @xmath118 , that is : @xmath119 where @xmath120 is the amplitude of the wave with frequency , @xmath117 , and @xmath121 denotes the complex conjugation operation .",
    "the fields with frequencies @xmath117 , @xmath122 , are assumed to be excitation ( pump ) fields , whereas the field at @xmath123 is a higher - harmonic , nonlinearly generated field .",
    "this nonlinear optical field depends on the specific nonlinear optical process under investigation .",
    "similar expressions are assumed for the other electromagnetic quantities . in particular , the polarization , @xmath124 , is expressed as : @xmath125 where @xmath126 encodes a  possibly nonlinear  functional relation between the total , time dependant field @xmath127 and the polarization with @xmath117-harmonic time dependence at position @xmath114 .    in most situations of practical interest , depending on particular physical conditions ,",
    "only certain nonlinear polarizations are generated with significant strength .",
    "moreover , in the case of strong excitation fields or when the induced nonlinear polarizations are weak , the following assumption can be made : @xmath128 this means that the polarizations at the frequencies of the pump fields , @xmath117 , @xmath122 , are solely determined by the corresponding linear optical susceptibility , @xmath129 , of the optical medium and the electric field at frequency @xmath117 .",
    "the polarization at the nonlinear frequency , @xmath130 , however , consists of both the linear polarization at @xmath130 , which is proportional to the nonlinear field , @xmath131 , and a nonlinear polarization , @xmath132 , which can incorporate the electric field from all pump fields with frequencies @xmath133 , @xmath134 : @xmath135    under this assumption , the optical fields at the pump frequencies , @xmath136 , are not altered , or in a narrower sense , depleted by the nonlinear processes , hence this assumption is called the undepleted pump approximation .",
    "the particular form of the nonlinear polarization , @xmath132 , depends on the nonlinear process under consideration , such as sum- or difference - frequency generation ( sfg or dfg ) , shg , and thg .",
    "specific expressions for @xmath132 for shg and thg in 2dms have been given in the previous section .",
    "the algorithmic appeal of this approximation is the possibility to obtain a general , one - way coupled calculation scheme , which only requires the solution of @xmath137 homogeneous linear optical problems and one affine linear problem with electrical sources .",
    "in particular , the numerical algorithm consists of the following three steps : in the step , _ i _ )",
    "( _ linear calculations _ )",
    "one calculates the fields @xmath138 at the pump frequencies , @xmath117 , @xmath122 . in the second step , _ ii _ )",
    "( _ polarization evaluation _ ) one evaluates the nonlinear polarization , @xmath132 , for the particular nonlinear process under consideration .",
    "finally , in the third step , _ iii _ ) ( _ nonlinear calculation _ ) , one calculates the generated nonlinear electric field , @xmath139 .    given this generic three - step algorithm , in the remaining part of this section we will describe the numerical implementation of the computational steps _ i _ ) and",
    "_ iii _ ) for the particular case of higher - harmonic generation in multilayered periodic structures , which contain periodically patterned monolayers of 2dms that can exhibit quadratic or cubic optical nonlinearity .",
    "the proposed method aims at describing nonlinear optical effects in 2d materials , hence , for the sake of simplicity , we do not consider nonlinear optical effects in the bulky materials involved , but only in the 2 dm sheets .",
    "these latter nonlinear effects can be easily incorporated into our algorithm , as we have recently shown @xcite .",
    "thus , the electromagnetic fields in the bulk parts of the structure are governed by the time - harmonic mes for nonmagnetic media without sources :    [ eq : me ] @xmath140 = 0 , \\label{eq : me1 } \\\\      & \\nabla \\times { { \\bf h}}^{(\\omega)}(\\mathbf{r } ) = - i\\omega \\epsilon_0\\epsilon_r(\\mathbf{r } ) { { \\bf e}}^{(\\omega)}(\\mathbf{r } ) , \\label{eq : me2 } \\\\      & \\nabla \\times { { \\bf e}}^{(\\omega)}(\\mathbf{r } ) = i\\omega \\mu_0 { { \\bf h}}^{(\\omega)}(\\mathbf{r } ) , \\label{eq : me3 } \\\\      & \\nabla \\cdot { { \\bf h}}^{(\\omega)}(\\mathbf{r } ) = 0 , \\label{eq : me4}\\end{aligned}\\ ] ]    for @xmath141 , @xmath142 .",
    "these equations have to be completed by boundary conditions , which will be the point where both linear and nonlinear interface effects are incorporated .",
    "before the appropriate boundary conditions are introduced and discussed in section  [ sec : bc_2 dm ] , the rcwa is used to describe the solution of eqs .   in each layer .",
    "for now , let us drop the superscript @xmath14 , as the description of the modal form of the electromagnetic fields is independent on whether a pump or a nonlinearly generated frequency is considered .",
    "the rcwa method is a mature , widely known algorithm@xcite , but in order to make the further derivation mathematically consistent , the notation and framework used here is described in the appendix .",
    "the main result that is necessary for the extension of this method to nonlinear 2dms is that the solutions in each of the bulk layers are given by a modal expansion , where each mode profile is given as a fourier series .    the electromagnetic fields in each layer , denoted with superscript  @xmath143 ",
    ", are expressed in a linear combination of upward- and downward - propagating modes with coefficients @xmath144 , where superscripts `` @xmath145 '' and `` @xmath146 '' refer to upward and downward propagation , respectively .",
    "each mode is fully described by its complex propagation constant , @xmath147 , which determines the @xmath24-dependence , and the @xmath24-independent fourier series coefficients @xmath148 and @xmath149 , for @xmath150 .",
    "these coefficients determine the transverse profile of mode @xmath151 via the fourier series reconstruction operator , @xmath152 , defined in the appendix .",
    "this reconstruction of the electric field is hence expressed as : @xmath153}}\\right)}}(x , y ) , \\label{eq : modalfieldtotal}\\end{aligned}\\ ] ] with @xmath154 } } \\\\ { { [ h_\\alpha^{(l)}(z ) ] } } \\end{array}\\!\\!\\right ) \\!&=\\ ! \\left[\\!\\!\\begin{array}{cc } \\textsf{e}_{\\alpha}^{(l,+ ) } & \\!\\!\\!\\textsf{e}_{\\alpha}^{(l,- ) } \\\\ \\textsf{h}_{\\alpha}^{(l,+ ) } & \\!\\!\\!\\textsf{h}_{\\alpha}^{(l,- ) } \\end{array}\\!\\!\\!\\right]\\!\\ !",
    "\\left[\\!\\!\\begin{array}{cc }      { { \\textsf{v}}}^{(l,+)}(z ) \\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! & \\quad 0   \\\\      \\!\\!\\!\\!\\!\\!\\!\\!0   & \\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! { { \\textsf{v}}}^{(l,-)}(z ) \\end{array}\\!\\!\\right]\\!\\ !",
    "\\left(\\!\\!\\begin{array}{c } { { \\bf c}}^{(l,+ ) } \\\\ { { \\bf c}}^{(l,- ) } \\end{array}\\!\\!\\right).\\!\\!\\end{aligned}\\ ] ] here , the @xmath151th column of @xmath155 and @xmath156 is the vector of fourier coefficients @xmath157}}$ ] and @xmath158}}$ ] , respectively , of the @xmath159-component of the @xmath151th mode .",
    "the propagation matrix , @xmath160 , is diagonal with entries @xmath161 , where @xmath162 is the bottom / top @xmath24-coordinate of layer @xmath143 .",
    "this means that the electromagnetic fields in each layer are fully determined by their coefficients @xmath163 .          the optical response of 2dms",
    "can chiefly be described in two different ways .",
    "one direct approach in rcwa and other numerical methods is to model the monolayer material as a periodic , very thin film , similar to the layers in which the periodic bulk components are decomposed . to this end , a physical effective thickness , @xmath37 , of the 2",
    "dm under consideration has to be chosen as well as its permittivity .",
    "this is a rather questionable and inefficient approach , for three main reasons .",
    "first , the choice of @xmath37 is somewhat ambiguous , both because the thickness of an atomic monolayer does not have a clear meaning in the classical physics context and due to the fact that the experimentally measured value of this thickness varies considerably , for all 2dms .",
    "second , this approach suffers from numerical artefacts and slow convergence , as reported in recent works  @xcite .",
    "this is understandable as the thickness of the monolayer is much smaller than the optical wavelength , @xmath164 .",
    "finally , it is computationally costly to find rcwa modes of the 2dms since this requires the numerical solution of an eigenvalue problem ( see the appendix ) .",
    "an alternative procedure for describing sheets of structured 2dms is introduced in this article and consists of modeling such 2dm - sheets by means of a surface conductance , which enters the algorithm in via electromagnetic boundary conditions between adjacent bulk layers .",
    "thus , consider the schematic of the multilayer structure presented in fig .",
    "[ fig : smatrixcollapse](a ) . at a horizontal plane with @xmath11 , which is located between two adjacent bulk layers ,",
    "the following relations of the tangential @xmath63 and @xmath165 fields in the top region ( superscript @xmath56 ) and the bottom region ( superscript @xmath57 ) have to be fulfilled @xcite :    [ eq : bc ] @xmath166    where @xmath167 denotes the unit vector along the @xmath24-direction , pointing towards region @xmath56 .",
    "the first of these equations expresses the continuity of the tangential components of @xmath63 at the interface .",
    "the second equation warrants further discussion .",
    "thus , in the presence of a 2 dm at @xmath11 , the tangential component of @xmath165 is discontinuous , its variation across the _ _",
    "i__th interface being given by the surface current , @xmath168 .",
    "in particular , the total surface current contains a linear component given by , @xmath169 and a nonlinear surface current , @xmath170 .",
    "the linear surface current depends only on the electric field at the interface , @xmath171 , at the same frequency , @xmath14 , and the sheet conductance distribution at the interface .",
    "the nonlinear surface current , on the other hand , is assumed to be different from zero only at the frequency @xmath172 and generally depends on the electric field at all the other frequencies , @xmath173 , @xmath174 .",
    "one can easily see that @xmath175 is a pseudo - periodic function of @xmath89- and @xmath10-coordinate , hence it is determined by its fourier vector coefficient , @xmath176}}$ ] .",
    "special attention is , however , necessary when one calculates the fourier coefficients of the linear current , @xmath177}}$ ] , as in the real space it is given by a product of two periodic functions , @xmath178 and @xmath179 .",
    "this issue , known as the fast fourier factorization problem , must be properly addressed in order to achieve high accuracy and fast convergence of methods relying on fourier series representation @xcite .     containing the 2 dm distribution @xmath180 with the boundary contour , @xmath181 , showing a unit cell and the local coordinate system at a generic location , @xmath182 .",
    "b ) local coordinate system at @xmath182 .",
    "c ) qualitative behavior of the surface quantities @xmath183 and @xmath184 . ]    to find the correct factorization rule for eq .  , the continuity property of the two factors in the r.h.s . of this equation as well as that of the product have to be investigated . to this end , consider fig .",
    "[ fig : localcs ] , which depicts the @xmath11 plane that comprises a surface conductivity , @xmath185 .",
    "hereby , @xmath180 denotes the characteristic function of the 2 dm distribution and @xmath34 is the sheet conductance of the 2 dm , e.g. eq .   for graphene .",
    "at each point , @xmath186 , of the 1d boundary @xmath181 of the 2 dm we introduce a local coordinate system defined by the orthogonal vectors @xmath187 , @xmath188 , and @xmath189 , where @xmath187 and @xmath188 are the in - plane unit vectors normal and tangent to the contour @xmath181 , respectively , at the point @xmath182 and @xmath189 is the unit vector along the @xmath24-axis .",
    "one can assume that the sheet conductance function is smooth along the @xmath188 direction , yet it is discontinuous along the @xmath187 direction , as per fig .  [ fig : localcs](b ) .",
    "the continuity relation , eq .",
    ", of the tangential electric field at @xmath11 allows one to define a tangential surface electric field , @xmath190 , as the limit of the volumetric electric fields , @xmath191 , from either side of @xmath8 plane : @xmath192    the electromagnetic near - field in the vicinity of such a conductive sheet can be calculated analytically @xcite and here we only summarize the main results relevant to our numerical method : _ i _ ) the @xmath187-component of the surface current vanishes at @xmath182 as @xmath193 since @xmath194 for @xmath195 , @xmath196 is continuous around @xmath182 . _",
    "ii _ ) the @xmath187-component of the surface electric field , @xmath197 , is discontinuous at the boundary @xmath181 .",
    "more specifically , @xmath198 that is @xmath199 inside the 2 dm vanishes near the boundary , whereas it diverges when approaching the interface from outside the 2 dm , @xmath200 finally , _ iii _ ) the in - plane tangential component @xmath201 of the interfacial electric field is continuous and bounded at the boundary @xmath181 .",
    "findings _ i _ ) and _ ii _ ) are schematically depicted in fig .",
    "[ fig : localcs](c ) .",
    "these results imply that @xmath202 is a continuous function but both factors , @xmath178 and @xmath190 , in eq .",
    "are discontinuous .",
    "therefore , laurent s product rule can not be applied , as it would result in spurious field oscillations near the boundary @xmath181 and slow convergence of the algorithm .",
    "the inverse rule is also not applicable , as the first factor , @xmath178 , vanishes in some regions of the unit cell , outside of the domains occupied by the 2 dm . to overcome this problem , a small but nonzero surface conductivity , @xmath203 ,",
    "is added at the interface regions where there is no 2 dm with finite conductivity . as a result ,",
    "this modified sheet conductance distribution in the unit cell is defined as : @xmath204\\sigma_{s,\\mathrm{add}}.\\end{aligned}\\ ] ]    as it has been seen in section  [ sec:2dlinprop ] , @xmath205 is a function of frequency and can vary by orders of magnitude .",
    "therefore , it is natural to scale the added conductivity , @xmath206 , relative to the absolute value of the physical conductivity of the 2 dm , that is @xmath207 , where @xmath208 is a small scaling constant .",
    "this choice ensures in addition that @xmath206 is a negative imaginary quantity , so that one does not introduce artificial losses in the system but only a vanishingly small phase change at the interface .",
    "however small this effect is , it introduces an error and hence its quantitative contribution to the optical response of the photonic structure must be investigated . the influence of @xmath206 , and implicitly that of @xmath208 , on the calculated near- and far - fields by the proposed method will be investigated in section  [ sec : convergence ] .",
    "a further justification of our nonzero conductivity model is provided by the application of ampere s law for a loop around the interface , an approach that has been recently introduced elsewhere @xcite .",
    "this alternative model also amounts to using a modified conductivity at the interface similar to that in eq .  .",
    "in order to complete the derivation of the correct fourier factorization of the surface current defined by eq .   for @xmath209 ,",
    "let @xmath210 denote a normal vector field ( nvf ) , namely a vector field that is normal to the 1d contour @xmath181 at any point of the interface and is analytically continued into the regions away from @xmath181 .",
    "this can be done analytically for certain cross - sections and ways to automatically generate a nvf for arbitrary cross - sections are readily available @xcite .",
    "this allows one to express the factorization of @xmath177}}$ ] in terms of the conductivity distribution coefficients , @xmath211 and @xmath212 , and tangential field coefficients , @xmath213}}$ ] , in such a way that the normal @xmath187-component of @xmath214 is decomposed using the inverse rule , and its tangential @xmath188-component is decomposed using the regular product rule : @xmath215 } } = & \\sum_{\\beta = x , y }      \\delta\\textsf{{{n}}}_{\\alpha,\\beta}{{[e_\\beta^{(\\omega , s)}]}},\\end{aligned}\\ ] ] where the conductivity difference matrix is given by @xmath216 this procedure is similar to the factorization rule for the displacement field used in the regular rcwa for bulk materials employing the nvf approach for fast fourier factorization given in ; see also refs .",
    "@xcite .",
    "the calculation of @xmath217 as a function of @xmath63 requires the electric near - field distribution at the interface .",
    "this near - field is difficult to calculate accurately in the rcwa even when the correct fourier factorization rules are employed , as was noted in refs .",
    "a revealing insight into the accuracy of near - field calculations is that rcwa relies on the accurate description of continuous quantities , as they can be readily expanded in fourier series .",
    "this can be exploited to achieve an accurate interface - field description : knowing that the @xmath188-component of the interface electric field , @xmath218 , is continuous , it is convenient to evaluate this component directly by fourier series reconstruction .",
    "since , however , its @xmath187-component is discontinuous ( and in fact singular ) , it can only be poorly represented by its fourier series , so that the reconstructed field @xmath219 will experience unphysical oscillations and the gibbs phenomenon .",
    "a more well - behaved quantity is the surface current , which is continuous and hence properly described by its fourier series . with the definition of the fourier coefficients of the vectorial normal surface current and tangential surface fields as :    [ eq : improvedeval ] @xmath220 } } = & { { \\llbracket \\textsf{i}-{{\\bf { { n}}}}{{\\bf { { n}}}}^t \\rrbracket}}{{[{{\\bf e}}_{{{\\bf t}}}^{(s ) } ] } } , \\label{eq : improvedeval_t } \\\\      { { [ { { \\bf j}}_{{{\\bf t}}_n}^{(\\omega ) } ] } } = & \\frac 12\\left({{\\llbracket { { \\bf { { n}}}}{{\\bf { { n}}}}^t \\rrbracket } } { { \\llbracket 1/ \\tilde \\sigma^{(\\omega)}_s \\rrbracket}}^{-1 } \\right .",
    "\\nonumber \\\\      & + \\left.{{\\llbracket 1/ \\tilde \\sigma^{(\\omega)}_s \\rrbracket}}^{-1 } { { \\llbracket { { \\bf { { n}}}}{{\\bf { { n}}}}^t \\rrbracket}}\\right ) { { [ { { \\bf e}}_{{{\\bf t}}}^{(\\omega , s ) } ] } } , \\label{eq : improvedeval_n}\\end{aligned}\\ ] ]    one obtains the reconstructed field at the interface as : @xmath221 } } \\right)}}(x , y ) +    \\frac{1}{\\sigma_s(\\omega ) } { { { \\mathcal r}\\left({{[{{\\bf j}}_{{{\\bf t}}_n}^{(\\omega)}]}}\\right)}}(x , y).\\end{aligned}\\ ] ] here , all fourier series represent functions continuous at the in - plane boundaries of the 2 dm .",
    "the fact that this approach only allows a reconstruction of the near - field at the 2 dm interface , where @xmath222 , is not particularly concerning since the nonlinear surface current is _ a priori _ nonvanishing there only .      in he previous section",
    "we have introduced the modal expansion of the electromagnetic fields inside and around the diffraction grating structure and cast them in a concise matrix form , as per eq .  .",
    "it remains now to determine the coefficients @xmath223 in every computational layer in order to obtain the electromagnetic fields .",
    "this is achieved by fulfilling the boundary conditions given by eq .   between all computational layers ,",
    "the results of these calculations being cast in a versatile inhomogeneous @xmath112-matrix formalism .    to this end , let us consider again the multilayer structure and the computational variables defining the corresponding electromagnetic field schematically illustrated in figs .",
    "[ fig : smatrixcollapse](a ) and [ fig : smatrixcollapse](b ) , respectively .",
    "the optical structure consists of exactly one 2 dm sheet located at @xmath11 , defined by its distribution of conductivity , and an arbitrary number of bulk layers , defined by their respective electrical permittivity distribution and identified by their superscript .",
    "three of the layers are of particular interest , namely the two computational layers directly enclosing the 2 dm sheet , identified by `` @xmath56 '' and `` @xmath57 '' , and the evaluation layer , `` @xmath224 '' , which can be any computational bulk layer in the grating structure .",
    "in addition , the semi - infinite layers `` @xmath225 '' and `` @xmath226 '' identify the cover and substrate , respectively .",
    "these capital letters are used to label the mode shape matrices , @xmath155 and @xmath156 , and the propagation matrix , @xmath160 , in each layer , @xmath227 .",
    "the vector of mode coefficients in each layer is denoted by the corresponding bold lower - case letters , @xmath228 , @xmath229 , @xmath230 , @xmath231 , and @xmath232 .    at each of the pump frequencies ,",
    "plane wave incidence is assumed , i.e. the incoming cover and substrate coefficients , @xmath233 and @xmath234 , respectively , are given and at least one of their entries is nonzero . at the generated frequency , no field is assumed to be incident , hence @xmath235 .",
    "moreover , the higher - harmonics optical field is generated due to the nonlinear surface current , @xmath170 . with this set - up",
    ", the goal of the remaining derivation is to determine the mode coefficients , @xmath236 , in the evaluation layer , @xmath224 .",
    "since the layer @xmath224 was arbitrarily chosen , this suffices to determine the mode coefficients , and hence the electromagnetic field , in any layer .    since the fields in layers @xmath56 and @xmath57 are expressed using their fourier series according to eq .",
    ", the boundary conditions given by eq .   can be expressed in terms of the fourier vector coefficients of the fields and read :    [ eq : bc_fs ] @xmath237 } } = { { [ e_{{{\\bf t}}}^{(b)}(z_s ) ] } } , \\label{eq : bc_electricfs}\\\\          & { { [ h_{{{\\bf t}}}^{(a)}(z_s ) ] } } - { { [ h_{{{\\bf t}}}^{(b)}(z_s ) ] } } = { { [ \\delta h_{{{\\bf t}}}^{(s)}]}}.   \\label{eq : bc_magneticfs }      \\end{aligned}\\ ] ]    hereby , @xmath238 denotes the variation of the tangential components of @xmath165 across the surface @xmath11 and the superscript , @xmath14 , is dropped to simplify the notation .",
    "the symbol `` @xmath239 '' means matrix transpose operation .",
    "the vector fourier coefficients , @xmath240}}$ ] and @xmath241}}$ ] , can be expressed in terms of their mode coefficients , @xmath242 and @xmath243 , via eq .  .",
    "this same procedure is performed with the linear surface current according to the factorization rule expressed by eq .  , which relies on the tangential field at @xmath11 .",
    "due to the continuity of the tangential surface field , in principle , the field values from either side @xmath56 or @xmath57 , or their average , could be taken , as they are all equal .",
    "the latter is chosen in our approach , thus yielding @xmath244 } } = ( { { [ e_{{{\\bf t}}}^{(a)}(z_s)]}}+{{[e_{{{\\bf t}}}^{(b)}(z_s)]}})/2 $ ] .        by multiplying from the left both sides of eq .   with the inverse of matrix @xmath254 ,",
    "the fourier coefficients of the outgoing modes , @xmath255 and @xmath256 , can be determined in terms of the coefficients of the incoming modes , @xmath257 and @xmath258 , and the nonlinear surface current : @xmath259}}\\end{array } \\!\\!\\right )      + \\textsf{r}^{ab } \\left(\\begin{array}{c }          { { \\bf b}}^{+ } \\\\ { { \\bf a}}^{- }      \\end{array}\\right)\\right\\ } \\nonumber \\\\     & = \\left(\\!\\!\\begin{array}{c }      \\tilde{{{\\bf a}}}^{+ } \\\\ \\tilde{{{\\bf b}}}^{- } \\end{array}\\!\\!\\right )         + \\textsf{s}^{ab } \\left(\\!\\!\\begin{array}{c }          { { \\bf b}}^{+ } \\\\ { { \\bf a}}^{- }      \\end{array}\\!\\!\\right )      = \\left(\\!\\!\\begin{array}{c }          \\tilde{{{\\bf a}}}^{+ } \\\\ \\tilde{{{\\bf b}}}^{- }      \\end{array}\\!\\!\\right )      + \\left(\\!\\!\\begin{array}{c }          \\overline{{{\\bf a}}}^{+ } \\\\",
    "\\overline{{{\\bf b}}}^{- }      \\end{array}\\!\\!\\right),\\end{aligned}\\ ] ] where @xmath260 is the scattering matrix ( @xmath112-matrix ) of the interface system .",
    "this equation shows that the outgoing coefficients are comprised of two parts : @xmath261 and @xmath262 are the contributions to the total coefficients , @xmath255 and @xmath256 , respectively , given by linear scattering at the interface of the incident modes described by the coefficients @xmath257 and @xmath258 , whereas @xmath263 and @xmath264 are the contributions of the nonlinear surface current to the total coefficients @xmath255 and @xmath256 , respectively , and only enter if the generated frequency @xmath172 is considered .",
    "if the considered structure only consists of cover , substrate , and one periodically patterned 2 dm sheet , eq .",
    "is sufficient to fully describe its optical response . in multilayer structures",
    ", however , the contributions of @xmath112-matrices of different layers and interfaces have to be properly incorporated . to this end , consider three layers , @xmath56 , @xmath57 , and @xmath226 , with coefficients @xmath228 , @xmath229 , and @xmath232 , respectively , depicted in fig .",
    "[ fig : smatrixcollapse](b ) .",
    "we assume that the @xmath112-matrix , which connects the mode coefficients in layers @xmath57 and @xmath226 , is known and fulfills the relation @xmath265 combining this equation and eq .",
    ", one determines the scattering matrix relation between the coefficients associated to the top and bottom layers , @xmath228 and @xmath232 , respectively , by eliminating the coefficients @xmath229 : @xmath266 where the four @xmath267 sub - blocks of the combined @xmath112-matrix , @xmath268 , are given by :    [ eq : defredheffer ] @xmath269    and the four sub - blocks of the combined matrix @xmath270 are expressed as :    [ eq : defredheffert ] @xmath271    these relations are found by straightforward matrix calculations , where one of the intermediate steps yields the coefficients of the middle layer , @xmath57 :    [ eq : defredheffermiddle ] @xmath272 , \\\\          { { \\bf b}}^{+ } = & \\left({{\\textsf{i}}}-\\textsf{s}^{bs}_{11}\\textsf{s}^{ab}_{22}\\right)^{-1 } \\nonumber \\\\          & ~\\times\\left[\\textsf{s}^{bs}_{11}\\textsf{s}^{ab}_{21}{{\\bf a}}^{- } + \\textsf{s}^{bs}_{12}{{\\bf s}}^{+ } + \\textsf{s}^{bs}_{11}\\tilde{{{\\bf b}}}^{- } +          \\tilde{{{\\bf b}}}^{+}\\right ] ,      \\end{aligned}\\ ] ]    expressed solely in terms of incoming and known coefficients @xmath273 @xmath274 , and @xmath275 .",
    "the matrix operation , @xmath276 , is known as the redheffer star - product @xcite .",
    "it is associative , noncommutative , and has the neutral element @xmath277 $ ] .",
    "it can be applied repeatedly and hence at all pump frequencies , where all nonlinear coefficients ( @xmath278 ) vanish , it enables the calculation of the outgoing mode coefficients @xmath279 and @xmath280 from the incident mode coefficients , @xmath233 and @xmath234 .",
    "note that the term @xmath281 in eq .   can be viewed as the effective coefficients of the modes that are radiated by the combined multilayer - interface system , @xmath282 .",
    "more specifically , this term accounts for the linear propagation of the internally radiated modes at the generated frequency , with coefficients @xmath283 in bulk layer @xmath57 , and it accounts for linear optical interaction ( reflection , transmission , and absorption ) with the 2 dm located at the @xmath284-interface or the @xmath285-layer - interface system .    equipped with these matrix - vector relations , the calculation of all solution coefficients at the generated frequency can now be completed . in order to evaluate the mode coefficients @xmath230 in the evaluation layer @xmath224 , one calculates the combined @xmath112-matrix , @xmath286 , of all layers and interfaces above the evaluation layer @xmath224 , and the combined @xmath112-matrix , @xmath287 , of all interfaces and layers between the evaluation layer @xmath224 and up to but excluding the 2 dm sheet .",
    "this is depicted in fig .",
    "[ fig : smatrixcollapse](c ) . note that this procedure allows for @xmath286 , @xmath287 , or @xmath288 to be equal to @xmath289 ,",
    "i.e. the evaluation layer can be any layer above the nonlinear 2 dm sheet , which itself can be located at any interface , including just above the substrate .    under these circumstances ,",
    "the governing @xmath112-matrix relations read as follows :    [ eq : inhomsmatrixrelations ] @xmath290    by applying eq .   to the matrix relations for @xmath287 and @xmath268 , one obtains @xmath291 and effective affine coefficients , @xmath292 and @xmath293 , as per eq .  .    the final constellation of the remaining two @xmath112-matrices , @xmath294 and @xmath295 , and corresponding coefficients is depicted in fig .  [ fig : smatrixcollapse](d ) .",
    "this configuration is similar to the initial system of @xmath112-matrices , @xmath296 in eq .   and",
    "@xmath288 in eq .  .",
    "hence , it allows the calculation of the evaluation coefficients @xmath236 by means of eq .",
    ", with the following replacements @xmath297 , @xmath298 , @xmath299 , @xmath300 , @xmath301 , @xmath302 , and @xmath303 , yielding @xmath304    the treatment of an evaluation layer below the nonlinear layer can be performed in a similar manner . moreover , if the structure contains more than one nonlinear 2 dm sheet , the algorithm we just described can be repeated independently for each interface where nonlinear 2 dm is located and then sum the individually obtained solution coefficients . it should be noted that in addition to the nonlinear optical response of 2dms , the linear scattering effects at interfaces are naturally incorporated in our algorithm .",
    "this overall approach to linear and nonlinear light scattering in layered photonic structures containing 2dms is possible because of the affine linearity of the total system .",
    "in this section , aiming to validate our numerical method , we consider a series of generic test cases of diffraction gratings containing 2dms and analyze the corresponding convergence characteristics of the numerical method .",
    "we consider both 1d- and 2d - periodic structures made of graphene , which has cubic nonlinearity .",
    "no additional test cases for the tmdc monolayers are shown here because they are far less challenging than graphene from a computational point of view : tmdc monolayers are poorly conductive materials and thus do not affect the optical field as strongly as graphene does .    in our analysis , we investigate physical quantities describing the near- and far - field , so as to fully assess the stability and convergence properties of our modal method , as was discussed in ref",
    ".  @xcite . to characterize the far - field",
    ", we used the optical absorption , @xmath56 , at the ff , which is given by @xmath305 , where @xmath306 and @xmath239 denote the fraction of the intensity of the incident light that is reflected and transmitted , respectively . at the th , the total radiation , @xmath307 ,",
    "is chosen as a far - field quantity suitable to validate our method , where @xmath308 and @xmath309 denote the intensity at the th radiated in the direction of reflection and transmission , respectively .    , and width , @xmath310 .",
    "b ) 2d array of circular graphene disks with radius , @xmath311 , and periods , @xmath312 . ]      as a first example of a periodic diffraction grating containing nonlinear 2dms , consider the 1d periodic array of graphene ribbons depicted in fig .",
    "[ fig : ndstructures](a ) , sandwiched in - between homogeneous cover and substrate materials with electric permittivity , @xmath313 and @xmath314 , respectively .",
    "the period of the grating is @xmath315 and the spacing between adjacent ribbons is @xmath316 .",
    "the incident light is normally impinging onto this binary graphene grating and is tm - polarized .    in order to illustrate the effectiveness and benefits of our algorithm with added conductivity , eq .   with @xmath317 , and correct fourier factorization , eq .  , we compare it with two other versions of the proposed method .",
    "the first of these two algorithms employs a zero conductivity , @xmath318 , in the regions without graphene and only uses the product factorization rule for eq .",
    ", i.e. an incorrect factorization rule . in the second algorithm",
    "we assume that graphene has a finite thickness , @xmath319 , i.e. we model the array of graphene ribbons as a periodic bulk layer with relative permittivity , @xmath320 .",
    "this can be done using a standard rcwa implementation .",
    "we stress , however , that this is computationally more costly as it involves the determination of the rcwa modes in this bulk layer representing the array of graphene ribbons .",
    "in addition , for the sake of completeness , computational results from ref .",
    "@xcite are included , too .",
    "the linear absorption spectra calculated using a moderate number of harmonics , @xmath321 , are shown in fig .",
    "[ fig:1dlinearplots](a ) .",
    "the device absorption presents a broad resonance peak with maximum of about @xmath322 at the wavelength , @xmath323 , with negligible absorption being observed at both shorter and longer wavelengths .",
    "the results obtained using the algorithm with added conductivity with @xmath324 shows very good agreement with those found using conventional bulk rcwa calculations and with the results taken from ref .",
    "the model without added conductivity slightly overestimates the absorption , in the region @xmath325 .",
    "( solid line ) , by using @xmath326 ( dashed line ) , using a standard rcwa with @xmath327 ( dashed - dotted line ) and results from @xcite ( green circles ) .",
    "b ) top panel shows the dispersion map of the absorption vs. @xmath42 and @xmath208 , determined using the algorithm with added conductivity , whereas the bottom panel shows the dependence of absorption on @xmath42 , calculated using a standard rcwa ( dashed - dotted line ) , the the algorithm with @xmath318 ( solid line ) , and the algorithm with added conductivity , @xmath326 ( dashed line ) . ]",
    "keeping in mind that the sheet conductance of graphene , @xmath328 , has been introduced somewhat artificially to facilitate the use of the correct ( inverse ) factorization rule , the influence of @xmath329 on the accuracy of the computed results needs to be carefully investigated .",
    "the asymptotic behavior of both near- and far - field physical quantities are suitable tools for performing this analysis . to this end",
    ", we have determined the dependence of the absorption at @xmath330 on @xmath42 and @xmath208 , as depicted in fig .",
    "[ fig:1dlinearplots](b ) . among other things",
    ", this figure shows that the convergence with respect to @xmath42 is faster for larger @xmath208 .",
    "this dependence is not surprising , because the interface containing the structured graphene sheet becomes more optically homogeneous as @xmath208 increases , i.e. the description of @xmath331 as a fourier series becomes more accurate .",
    "however , this does not prove the accuracy of the method just yet : @xmath206 was introduced at a purely mathematical level and as such it should vanish in physical diffraction gratings .",
    "the accuracy of the method is demonstrated by the fact that as @xmath332 , convergence of the absorption is reached ; for example , as @xmath332 the maximum absorption converges to @xmath333 for increasing value of @xmath42 .    in the bottom panel of fig .",
    "[ fig:1dlinearplots](b ) we contrast the convergence characteristics of the three algorithms we just described . as it can be seen in this figure ,",
    "all three approaches converge to the same value but , importantly , the convergence speed in the case of finite added conductivity is the fastest among the three cases .",
    "it is also instructive to remark that the slowest convergence is observed in the case of zero conductivity , an added drawback in this case being the oscillatory dependence of the absorption on @xmath42 , which confirms that this formulation is incorrect as was theoretically argued in section  [ sec : bc_2 dm ] .     around the graphene ribbon calculated for @xmath321 and the fields at the surface of the graphene ribbon corresponding to the improper ( colored lines ) and correct ( black lines ) field evaluation , respectively .",
    "in both cases , @xmath318 .",
    "c ) , d ) the same quantities as in a ) and b ) , respectively , but determined for @xmath326 .",
    "only a part of the left half of the unit cell , defined by @xmath334 $ ] , is shown , as the results are symmetric in @xmath89 and rather featureless far away from the graphene ribbon located at @xmath335 . ]",
    "the spatial profile of the electric near - field deserves special attention as well because it reveals new important features pertaining to the convergence of the numerical method . to illustrate this idea ,",
    "the @xmath89-component of the electric field for the cases in which @xmath318 and when the conductivity is finite , @xmath326 , are shown in figs .",
    "[ fig:1dlinearfields](a ) and [ fig:1dlinearfields](c ) , respectively .",
    "the operating wavelength is @xmath336 and @xmath321 in both cases . in these plots ,",
    "the boundary of the graphene ribbon in the unit cell is located at @xmath337 .",
    "it can be seen from these plots that without the added conductivity the field exhibits very strong , unphysical oscillations near the boundary of the graphene ribbons , i.e. at @xmath338 , which spread over the whole unit cell along the @xmath89-direction .",
    "the spatial frequency of these oscillations is equal to the highest spatial discretization frequency , namely to @xmath339 . in the case of finite @xmath206 , on the other hand , there are no such spurious field oscillations outside graphene regions and only weak oscillations are seen inside the graphene ribbon , as per fig .",
    "[ fig:1dlinearfields](c ) . in both cases",
    ", these field oscillations only occur very close to the interface where the graphene sheet is located and can merely be observed at distances @xmath340 .",
    "these oscillations are due to the fact that the fourier series decomposition does not resolve the singularity of the electric field at the edges of the graphene ribbons , as we discussed in section  [ sec : bc_2 dm ] .",
    "one of the aims of the accurate near - field formulation introduced by eqs .   is to overcome this shortcoming of fourier series decompositions and thus to allow the accurate field evaluation exactly at the location of the 2 dm monolayers , i.e. at @xmath11 . to illustrate how our method achieves this , we depict in figs .",
    "[ fig:1dlinearfields](b ) and [ fig:1dlinearfields](d ) the interface field , @xmath341 , for the cases in which @xmath318 and when the conductivity is finite , @xmath326 , respectively . without using an added conductivity",
    ", the improper field evaluation @xmath342}}\\big)(x , y)$ ] of the surface field leads to a strongly oscillatory spatial dependence , which in addition changes significantly with @xmath42 , as shown by the blue and red lines in fig .",
    "[ fig:1dlinearfields](b ) for @xmath343 and @xmath321 , respectively . by contrast ,",
    "the interface field obtained by using eqs .   with @xmath344 replaced by @xmath345 displays hardly any oscillations , as per the black lines in this figure , yet it does not vanish at the edge of the graphene ribbon as required by the theoretical analysis presented in section  [ sec : bc_2 dm ] .",
    "these remaining oscillations are merely due to the fact that the incorrect factorization rule was used and not because of the unresolved singularity of the field .",
    "this description changes significantly if one uses a small , finite value for @xmath206 , see fig .",
    "[ fig:1dlinearfields](d ) .",
    "the improper evaluation using a finite value for @xmath206 yields a smooth field outside the graphene region , @xmath346 , but still displays unphysical oscillations inside the graphene region , @xmath347 , and does not vanish at the graphene boundary , @xmath348 , as required .",
    "on the other hand , by employing the correct evaluation of the surface field and surface current given by eqs .",
    ", one obtains a surface field that vanishes at @xmath348 , is free of spurious oscillations , and converges rapidly with @xmath42 .",
    "we stress that since the nonlinear polarization generated in our photonic structures is determined by the optical near - field at the location of 2dms , an accurate evaluation of these near - fields is a paramount prerequisite to a rigorous description of the nonlinear optical response of these nonlinear photonic devices . to this end , as we just showed , this can be readily achieved by using the correct fourier factorization expressed as eq .   in the model with finite sheet conductance , the correct field evaluation given by eqs .  , and a properly chosen number of harmonics .",
    "( dashed lines ) and @xmath349 ( solid lines ) calculated using the improper field evaluation ( blue lines ) and correct field evaluation ( black lines ) at the ff .",
    "b ) intensity of th radiation at @xmath350 vs. @xmath42 determined for different values of added conductivity @xmath206 .",
    "c ) , d ) intensity of th radiation at @xmath351 and @xmath350 , respectively , vs. @xmath42 determined using improper field evaluation ( blue lines ) and correct field evaluation ( black lines ) at the ff . in both cases",
    "]    the total intensity of radiated th is considered as the first quantity characterizing the nonlinear optical response of our graphene gratings , the corresponding computational results being summarized in fig .  [ fig:1dnonlinearplots ] .",
    "thus , fig .",
    "[ fig:1dnonlinearplots](a ) depicts the total radiated power at the th , determined for the case of finite added conductivity , @xmath326 , and number of harmonics , @xmath352 and @xmath349 .",
    "the nonlinear source current given by eq .   was calculated using both the improperly evaluated interface field , @xmath353 , and the correctly calculated interface field , @xmath354 .",
    "interestingly , in the wavelength range @xmath355 , both calculation methods yield qualitatively similar spectra . for longer wavelengths , however , results differ considerably and in fact only the results obtained using @xmath354 field converge .    before investigating in more detail this behavior ,",
    "we consider first the convergence characteristics of the far - field at the th with respect to the value of the added conductivity , @xmath206 .",
    "the main features of this dependence , illustrated by the data plotted in fig .",
    "[ fig:1dnonlinearplots](b ) , which corresponds to @xmath350 , are similar to those observed in the case of linear calculations . more specifically , the larger @xmath206 is the faster self - convergence with respect to @xmath42 is observed and the computational results converge for vanishingly small @xmath206 .",
    "the difference in convergence behavior for increasing @xmath42 of the two approaches used to evaluate the surface field is illustrated in figs .",
    "[ fig:1dnonlinearplots](c ) and [ fig:1dnonlinearplots](d ) , for two representative wavelengths , @xmath351 and @xmath350 , respectively .",
    "these figures show that the correct field evaluation leads to rapid convergence at both wavelengths , whereas the improper approach yields slow and oscillatory convergence at @xmath351 and completely fails to converge at @xmath350 .",
    ", to calculate the nonlinear polarization , @xmath356 .",
    "b ) the same as in a ) but using the correctly evaluated field at the ff , @xmath357 , to compute @xmath356 . ]",
    "the electromagnetic near - field , @xmath139 , at the th wavelength , @xmath351 , determined using the two algorithmic choices and @xmath321 spatial harmonics , is plotted in fig .",
    "[ fig:1dnonlinearplotsb ] .",
    "thus , the th @xmath358 field derived from the nonlinear source polarization , @xmath359 , comprising the incorrectly evaluated field at the ff , @xmath353 , is completely swamped by unphysical oscillations , i.e. numerical artefacts , at the interface where the graphene ribbon is located , as per fig .",
    "[ fig:1dnonlinearplotsb](a ) . on the other hand , the @xmath89-component of the th electric field , @xmath360 , which has the nonlinear polarization @xmath361 as its source , shows almost no oscillatory behavior and thus has the expected spatial profile , as shown in fig .",
    "[ fig:1dnonlinearplotsb](b ) . only further away from the interface ,",
    "some agreement between the data in figs .",
    "[ fig:1dnonlinearplotsb](a ) and [ fig:1dnonlinearplotsb](b ) can be observed .    the faster convergence ,",
    "the more physically correct near - fields at both ff and th , combined with the expected electric field behavior at graphene boundaries allow us to conclude that the properly evaluated field , @xmath354 , at the ff yields the correct results at the th , whereas the th optical response obtained using the improperly evaluated field , @xmath353 , at the ff is plagued by numerical artefacts and unphysical behavior .",
    "let us now consider 2d diffraction gratings that contain 2dms , namely the periodically arranged graphene disks depicted in fig .",
    "[ fig : ndstructures](b ) .",
    "we assume that the two periods are the same , @xmath362 and the diameter of the graphene disks is @xmath363 .",
    "for the sake of simplicity , we consider that the incoming light is normally impinging onto the grating , the cover and substrate media being air ( @xmath364 ) and glass ( @xmath365 ) , respectively .    , and number of harmonics @xmath366 . ]",
    "the absorption spectrum for @xmath89-polarized incoming light , calculated for @xmath366 harmonics , is presented in fig .",
    "[ fig:2dbothplot](a ) .",
    "all results are obtained using the finite conductivity model defined by eq .  , the scaling parameter being @xmath367 . the zero - conductivity model or the improper interface field evaluation yield highly oscillatory near - field profiles at ff and th and fails to deliver converging th far - field results .",
    "thus , it can be seen that the spectra calculated using different values of @xmath42 agree well and exhibit similar features . in particular , all spectra show a series of resonances whose amplitude and spectral width increase with the wavelength .",
    "figure  [ fig:2dbothplot](b ) depicts the dependence of the intensity of the total radiated th from the array of graphene disks , @xmath368 , on the number of harmonics , @xmath42 .",
    "the nonlinear radiation spectra corresponding to the largest values @xmath343 and @xmath369 already show good agreement , which suggests that convergence has been achieved .",
    "we now investigate in more detail the self - convergence characteristics of linear calculations , the main conclusions of this analysis being summarized in fig .",
    "[ fig:2dconvergence](a ) .",
    "we considered the wavelengths of the first three absorption resonances seen in fig .",
    "[ fig:2dbothplot](a ) , that is @xmath370 , @xmath371 , and @xmath372 . setting as converged values the results obtained by using a large number of harmonics , @xmath373 , specifically @xmath374 , the relative self - error corresponding to a number of harmonics , @xmath42 ,",
    "is then defined as : @xmath375 this self - error function can be used as a reliable measure of the convergence of the method as long as the value of @xmath42 for which the reference absorption is defined is chosen to be sufficiently large .",
    "( dots ) , @xmath371 ( crosses ) and @xmath372 ( circles ) . ]    at all three resonance wavelengths , relative errors of @xmath376 are achieved for @xmath377 .",
    "it should be noted that in terms of computational effort , using @xmath378 in 2d simulations is comparable to using @xmath379 in 1d simulations .",
    "moreover , the accuracy of the 2d simulation with @xmath378 is still correlated to and limited by the highest spatial frequency , @xmath380 .",
    "to asses the convergence of the th simulations more rigorously , the relative error , @xmath381 , of the th radiation intensity , @xmath368 , for a given number of harmonics @xmath42 , which is defined similarly to @xmath382 in eq .   with @xmath383 , is depicted in fig .",
    "[ fig:2dconvergence](b ) .",
    "a relative self error of @xmath384 can be achieved at @xmath385 for all three resonance wavelengths .",
    "note also that the intensity of the th radiation varies over six orders of magnitude and has maxima at the locations of the spectral resonances of the linear absorption , as per fig .",
    "[ fig:2dbothplot](a ) .",
    "graphene is a lossy conductor in the spectral range considered and therefore allows the excitation of surface waves @xcite .",
    "this is the case with each of the absorption maxima seen in the linear spectrum , as illustrated by figs .",
    "[ fig:2dfieldprofiles](a)[fig:2dfieldprofiles](c ) .",
    "thus , we show in these figures the dominant field component , @xmath386 , of the linear electric field at the first three resonance wavelengths , @xmath370 in fig .",
    "[ fig:2dfieldprofiles](a ) , @xmath371 in fig .",
    "[ fig:2dfieldprofiles](b ) , and @xmath372 in fig .",
    "[ fig:2dfieldprofiles](c ) .",
    "these field profiles exhibit distinct mode shapes with one , three and five maxima , which demonstrates that the corresponding resonances represent the first three plasmon modes of the graphene disks .    strongly enhanced and largely confined optical field resulting from the excitation of localized plasmon modes",
    "gives rise to enhanced thg .",
    "this fact is supported by the field profiles plotted in the bottom panels of fig .",
    "[ fig:2dfieldprofiles ] , where the dominant electric field component at the th , @xmath386 , is shown .",
    "indeed , regions of strong field enhancement can be seen , with field profiles with three , seven , and eleven maxima being observed at @xmath387 in fig .",
    "[ fig:2dfieldprofiles](d ) , @xmath388 in fig .",
    "[ fig:2dfieldprofiles](e ) , and @xmath389 in fig .",
    "[ fig:2dfieldprofiles](f ) , respectively .    , at the ff ( top panels ) and th ( bottom panels ) at the surface of a graphene disk for the resonance wavelengths , from left to right , @xmath390 , @xmath391 , and @xmath392 .",
    "the number of harmonics used in the simulations was @xmath373 at the ff and @xmath393 at the th . ]",
    "in this section the linear and nonlinear optical response of diffraction gratings incorporating tmdc monolayer materials or graphene is investigated and the application of the inhomogeneous @xmath112-matrix formulation introduced in section  [ sec : inhomsmatrix ] is illustrated in several specific cases .    throughout this section , the intensity of the incident beam is chosen to be @xmath394 , which is a moderately high peak intensity generated by a pulsed laser . changing the incident intensity in the undepleted pump approximation does not alter the numerical results at any of the incident frequencies , @xmath122 but it substantially changes the magnitude of the electromagnetic field at the generated frequency , @xmath395 .",
    "more specifically , for shg and thg the intensity of the generated waves behaves as @xmath396 and @xmath397 , respectively , and as such they can increase to significant values .",
    "a problem that might arise in the undepleted pump approximation is that if the intensity of the generated waves becomes comparable to the intensity of the incident wave , the use of this approximation would become questionable .",
    "this is not the case in most practical situations and certainly not the case here , as can be seen by the intensity of generated optical fields in the examples hereafter .      to begin with ,",
    "we consider a 1d binary tmdc grating placed on top of a glass substrate with @xmath398 .",
    "its period is @xmath399 and the filling factor is @xmath400 .",
    "an @xmath89-polarized plane wave is normally incident onto the grating and a spectral range of for the incident wavelength @xmath401 is considered .",
    "the computations were performed using @xmath349 harmonics and an added sheet conductance of @xmath402 , the results being presented in fig .",
    "[ fig : tmdc_ribbons ] .",
    "the convergence of these calculations has been assured as diligently as for the binary graphene diffraction gratings discussed in section  [ sec : convergence:1d ] .",
    "the plots presented in fig .",
    "[ fig : tmdc_ribbons](a ) reveal that the linear absorption spectra are primarily determined by the linear material properties @xmath34 of the tmdc materials .",
    "the absence of any additional resonant features in the spectra has two main reasons : the dielectric nature of the tmdcs does not allow the formation of plasmons , as in the case of graphene , whereas the vanishingly small thickness of the tmdc monolayers precludes the existence of geometric , mie - type resonances .",
    "these explanations are supported also by the fact that linear and nonlinear spectra are qualitatively similar if one varies the grating period and the feature size of the tmdc ribbons .    in order to obtain the sh radiation of the 2 dm grating",
    ", we used the nonlinear conductivity , @xmath403 , discussed in section  [ sec:2dnonlinprop ] . since no values of @xmath403 for @xmath404 were available , we determined the nonlinear optical response of the grating only in the case of three tmdc materials , @xmath99 , @xmath100 , and @xmath101 . as our calculations showed that there is no resonant field enhancement at the tmdc ribbons at the ff , no strong enhancement of generated sh",
    "is expected .",
    "the nonlinear sh radiation spectra presented in fig .",
    "[ fig : tmdc_ribbons](b ) suggest that indeed the intensity of radiated sh closely follows the magnitude of @xmath405 , as can be found by comparison with the plots in fig .",
    "[ fig : mat_nonlinear_properties](b ) .",
    "the maximal intensity of generated sh is @xmath406 , rendering valid the undepleted pump approximation .    ,",
    "@xmath100 , @xmath101 , and @xmath404 .",
    "b ) the sh radiation spectra for ribbons made of @xmath99 , @xmath100 , and @xmath101 . ]      since tmdc monolayers themselves do not possess optical modes , we use a different approach to achieve enhanced nonlinear optical interactions in these 2d materials .",
    "thus , we combine a tmdc monolayer with a bulk structure that possesses waveguide modes whose excitation leads to strong local field enhancement . a very effective structure for this purpose is a periodically patterned slab waveguide , covered by a tmdc monolayer , as depicted in fig .",
    "[ fig : wg_setting](a ) .",
    "dielectric slab waveguides exhibit very narrow spectral resonances , due to the resonant excitation of guiding slab modes , a phenomenon that can be used to enhance linear and nonlinear optical response of certain devices @xcite .     and @xmath407 covered by air and placed on a dielectric substrate with @xmath408 . on top of the slab waveguide different 2dms are placed : a ) a uniform monolayer of @xmath99 or graphene .",
    "b ) , c ) graphene ribbons with width @xmath310 distributed over the slab material with lower and higher permittivity , respectively .",
    "d ) graphene ribbons with width @xmath310 distributed over both regions of the slab waveguide . ]",
    "the waveguide structure under consideration consists of a slab of height , @xmath409 , placed between a monolayer ws@xmath55 and substrate with relative permittivity @xmath410 ( index of refraction , @xmath411 ) .",
    "the 2 dm monolayer is adjacent to the cover region , which is assumed to be air , @xmath364 .",
    "the slab itself is periodically patterned , that is it consists of alternating regions with permittivity @xmath412 ( @xmath413 ) and @xmath414 ( @xmath415 ) with a period @xmath416 .",
    "this particular choice of parameters was inspired by ref .",
    "@xcite .    for",
    "now , consider the unperturbed waveguide consisting of a material with relative permittivity @xmath417 .",
    "a slab waveguide supports optical guided modes and their excitation strongly affects its reflective and transmissive characteristics .",
    "a mode of order @xmath418 with in - plane propagation constant @xmath419 can be excited , when the in - plane wavenumber , @xmath420 , of an incident wave coincides with @xmath419 .",
    "this is not possible for a homogeneous waveguide due to the particular dispersion properties of @xmath420 and @xmath419 , but can be achieved if the waveguide permittivity is periodically modulated , as illustrated in fig .",
    "[ fig : wg_setting](a ) .",
    "this periodic perturbation effectively folds the propagation constant @xmath419 into the first brillouin - zone of the @xmath47-space of the modes of the periodic waveguide and enables phase matching between @xmath420 and @xmath419 , i.e. the excitation of the mode @xmath418 .",
    "it should be stressed that , albeit less effectively , free - space photons couple to waveguide modes even if the periodic slab waveguide is covered by a thin , optically homogeneous layer , such as a 2 dm , because the effective refractive index of the combined structure is periodic in this case , too .    in what follows",
    ", we demonstrate the resonant excitation of modes in the tmdc - waveguide structure for a fixed height of @xmath421 .",
    "subsequently we optimize the height of the slab waveguide to obtain maximal generated sh and investigate the interplay between various resonant mechanisms in the combined waveguide-2 dm device that lead to enhanced nonlinear optical response .",
    "only monolayer ws@xmath55 is considered as covering 2 dm in this example , because for this tmdc monolayer the dispersion of the nonlinear conductivity , @xmath422 , is known over the broadest spectral domain .",
    "the ws@xmath55 monolayer is oriented such that the arm - chair direction of the atomic lattice is aligned with the @xmath89-axis of the structure .",
    "due to the particular tensorial structure of @xmath422 , this configuration only yields tm - polarized sh for a tm - polarized fundamental field .",
    ", demonstrate the effect of the intrinsic material absorption at @xmath423 and the fano resonance due to a waveguide resonance at @xmath424 .",
    "b ) electric near - field in and around the waveguide for @xmath424 exhibits the spatial profile of the tm@xmath425 mode , with strong field enhancement at waveguide interfaces .",
    "c ) nonlinear radiation intensity spectra near the fundamental frequency corresponding to the tm@xmath425 mode , determined for three values of the waveguide height , @xmath409 .",
    "d ) electric near - field at sh wavelength , @xmath426 , for @xmath427 . ]    in order to illustrate the excitation of a waveguide mode , we considered a tm - polarized , normally incident plane wave in a wavelength range at ff of . the corresponding reflection , transmission , and absorption spectra are depicted in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](a )",
    ". a steep increase of the absorption is observed , from less than to a maximum of at @xmath428 .",
    "moreover , the transmission and reflection have their minimum and maximum at this wavelength , respectively .",
    "this is due to the excitation of the tm@xmath425 waveguide mode , as can be confirmed by the inspection of the electric near - field profile in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](b ) : @xmath386 has maxima at the top and bottom facets of the waveguide , which also implies a maximum of @xmath429 at its center , as one expects for a tm@xmath425 waveguide mode .",
    "another local maximum of the absorption can be seen at @xmath430 and is due to one of the exciton absorption peaks of monolayer ws@xmath55 [ c.f .",
    "[ fig : mat_linear_properties](b ) ] .",
    "the enhancement of the fundamental field at the top of the waveguide , where the ws@xmath55 monolayer is located , yields a strongly increased intensity of sh radiation with a maximal value of @xmath431 , as shown in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](c ) .",
    "comparison of the radiation spectra for different waveguide heights , @xmath432 , @xmath427 , and @xmath433 , already shows the large sensitivity of the spectral location of waveguide modes to changing height .",
    "this is the basis for the parameter study in the remainder of this section . before that , let us inspect the electric near - field at the sh wavelength , @xmath434 , presented in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](d ) .",
    "this profile is markedly different from that of the linear near - field , namely it is spatially more inhomogeneous and has a different distribution of local minima and maxima . finally , we point out that the absorption peak at @xmath430 does no translate to a notable increase of sh radiation , which is similar to the findings reported in section  [ sec : example1 ] .    in the rest of this section",
    "we explore the interplay among different resonant mechanisms in the combined waveguide-2 dm structure that lead to enhanced nonlinear optical response and investigate how one can exploit them to increase the intensity of sh generated from this optical device . to this end",
    ", tm - polarized incident light in a wavelength range at the ff of is considered and simulations for waveguide height ranging from , using @xmath343 harmonics , are performed .",
    "the results of these calculations , corresponding to the ff , are shown in fig .",
    "[ fig : wgr_tmdc](a ) in terms of the reflection spectra maps , and will be discussed now .",
    "the nonlinear part of the device study is summarized in fig .",
    "[ fig : wgr_tmdc](b ) in terms of maps of its outgoing radiation at the sh and will be investigated subsequently .",
    "the linear optical characteristics of the tmdc - covered waveguide determined for different heights are depicted as a 2d map of reflectivity values .",
    "this 2d map of reflection spectra exhibits a smooth dependence on @xmath401 and @xmath409 with minimal and maximal values of @xmath435 and @xmath436 , respectively , except when one of several mechanisms leads to resonant enhancement of the reflectivity .",
    "_ i _ )  the most evident and spectrally broadest features are due to the fabry - perot interference mechanism , which yields maximal ( minimal ) reflectivity if the multiple reflections inside the slab waveguide are in ( out - of ) phase @xcite .",
    "these fabry - perot resonances appear in the reflectivity map as spectrally broad variations from reflection minima to maxima . _",
    "ii ) _  the second kind of spectral feature is due to the resonant increase of intrinsic optical absorption of ws@xmath55 , which occurs at wavelengths at which excitons are generated in the ws@xmath55 monolayer .",
    "the strongest of these absorption peaks is at @xmath430 .",
    "their spectral location is determined by the dispersion of @xmath53 , given in fig .",
    "[ fig : mat_linear_properties](b ) , and is largely independent of the electromagnetic environment and hence does not depend on @xmath409 .",
    "the intrinsic optical absorption mostly increases the absorption in the combined waveguide-2 dm device , but also leads to increasing reflection and decreasing transmission , as was already shown for @xmath427 around @xmath437 in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](a ) .",
    "_ iii ) _",
    "the third kind of resonance is due to the excitation of tm@xmath438 waveguide modes and manifests itself as a spectrally narrow , asymmetric , and steep variation of the reflectivity of the device .",
    "a detailed analysis of the resonant excitation of the tm@xmath439 mode for @xmath427 and @xmath440 was already presented in relation to fig .",
    "[ fig : wgr_tmdc_closeupnearfield ] . by varying the waveguide height and wavelength",
    ", the excitation of the tm@xmath441 and tm@xmath55 modes was found , too .",
    "exhibits fabry - perot resonances , resonances due to exciton generation ( @xmath442 ) , and resonances due to excitation of waveguide modes ( ) .",
    "interaction between the tm@xmath425 waveguide mode and excitons of ws@xmath55 monolayer as well as fano resonances can be observed .",
    "b ) map of nonlinear radiation spectra determined for different waveguide height , @xmath409 . ]    as the map in fig .",
    "[ fig : wgr_tmdc](a ) suggests , there is a mutual interaction among resonances of the tmdc - covered waveguide , giving rise to several interesting phenomena .",
    "first , one can observe the generation of fano resonances , which generally result from the interference between a discrete state and a broad continuum and are characterized by an asymmetric spectral profile @xcite .",
    "fano resonances arise via different scenarios in the considered structure , most notably due to the interference of the tm@xmath425 waveguide mode ( the discrete state ) and the fabry - perot resonance ( the broad continuum ) .",
    "for example , for a device height of @xmath427 and for increasing wavelengths around @xmath443 , the reflection decreases to a minimum value of @xmath444 , then steeply increases to @xmath445 , as shown in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](a ) .",
    "similar behavior can be observed when tm@xmath441 and tm@xmath55 waveguide modes are excited .",
    "the absorption and transmission spectra exhibit similar features , but the spectral asymmetry , a characteristic feature of fano resonances , is not as well pronounced in these cases . hence , only the reflection is shown here . the second phenomenon revealed by fig .",
    "[ fig : wgr_tmdc_closeupnearfield](a ) is the crossing of the tm@xmath425 waveguide mode with the spectrally highest exciton absorption peak of monolayer ws@xmath55 . in particular , the two resonances",
    "exhibit an anti - crossing behavior at the wavelength of their strongest interaction , which is a well - known phenomenon in photonics and other physical systems @xcite .",
    "having understood the key features of the linear response of the combined waveguide-2 dm optical system , we now explore its nonlinear optical properties . to this end , consider fig .",
    "[ fig : wgr_tmdc](b ) , which depicts the map of the intensity of the total generated sh at wavelengths , @xmath446 , ranging from and for the same values of the waveguide height as in fig .",
    "[ fig : wgr_tmdc](a ) .",
    "this intensity varies over almost 6 orders of magnitude , from a minimum of @xmath447 at @xmath448 and @xmath449 to a maximum of @xmath450 for @xmath451 and @xmath452 .",
    "it exhibits a smooth dependence on the system parameters , except for the excitation of certain resonances via mechanisms similar to those examined in the linear case .    in general",
    ", the nonlinear radiation is affected by two factors , which we call _ inherited _ and _ intrinsic _ effects .",
    "inherited effects are due to the enhancement via certain mechanisms of the optical field at the ff , at the location of the ws@xmath55 monolayer , which increases the nonlinear source current and consequently the intensity of the generated sh .",
    "intrinsic effects , on the other hand , are resonant effects at the sh wavelength , which can also influence the intensity of radiated waves at the sh .    the most important inherited effects leading to resonant enhancement of nonlinear radiation , seen in the map plotted in fig .  [",
    "fig : wgr_tmdc](b ) , are as follows : _",
    "i ) _  the inherited fabry - perot reflection minima lead to a moderate increase of the sh over broad wavelength ranges . _",
    "ii ) _  the excitation of waveguide modes at the ff leads to particularly strong enhancement of the fundamental field and yields the highest intensity of sh radiation , most notably when the tm@xmath425 mode is excited .",
    "in particular , sh radiation with intensity @xmath453 is consistently achieved when this mode is excited , except for fundamental wavelengths near the exciton absorption maximum at @xmath430 . _",
    "iii ) _  finally , the interaction of the fundamental tm@xmath425 mode and the ws@xmath55 exciton leads to a reduced enhancement of the fundamental field , as compared to the case of the sole excitation of the tm@xmath425 mode , and results in a decrease of the sh intensity to @xmath454 .    amongst the intrinsic effects ,",
    "two important mechanisms that lead to enhancement of sh intensity were identified : _",
    "i ) _  the generated electric field at the sh wavelength acts as excitation waves for the tmdc monolayer - waveguide system and resonantly excites waveguide modes existing at the sh , namely the tm@xmath425 and tm@xmath441 modes .",
    "this leads to a relatively small increase in the sh intensity . _",
    "ii ) _  the frequency dispersion of the nonlinear optical conductivity of monolayer ws@xmath55 is apparent in the sh spectra : maxima of @xmath455 , which are naturally independent of the waveguide height , @xmath409 , correspond to maxima in the sh radiation spectrum .",
    "moreover , the shg due to the combined inherited tm@xmath425 mode and the intrinsic maximum of @xmath455 for three values of @xmath409 is presented in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](c ) and shows that the two effects constructively add to increase the intensity of the shg .",
    "note that the reflection , transmission , and absorption spectra , the nonlinear radiation spectra , as well as the resonance wavelengths of the slab waveguide were accurately calculated even for the moderate number of @xmath343 harmonics , as was ensured with a convergence check for fixed height @xmath409 and with the rigorous procedures described in section  [ sec : convergence:1d ] .",
    "a total of @xmath456 simulations for pairs of @xmath457 were performed , where a higher spectral resolution was used near the resonance wavelengths of the device in order to accurately resolve the spectrally narrow effect of the waveguide resonances .      in the preceding section",
    ", we combined a 2d material , ws@xmath55 , which does not support localized optical modes , with an optical device consisting of a periodic slab waveguide , and achieved a strong enhancement of the nonlinear efficiency of the combined device . in this section",
    "we follow a similar approach and combine a similar slab waveguide with graphene structures , which we have already shown that support localized surface plasmon modes , in order to achieve a multiresonant , highly nonlinear optical device .",
    "thus , the structure under consideration is schematically depicted in fig .",
    "[ fig : wg_setting](d ) .",
    "it consists of a periodically patterned slab waveguide with the same optical parameters as the one in the preceding section , which now is covered by graphene ribbons with width @xmath458 .",
    "we will call the three graphene ribbons centered on top of the material with permittivity @xmath459 and @xmath460 the inner and outer ribbons , respectively , which is natural given the definition of the unit cell in fig .  [",
    "fig : wg_setting](d ) .",
    "the center - to - center distance of the inner ribbons ( and outer ribbons ) is @xmath461 and the center - to - center distance between a inner ribbon to a neighboring outer ribbon is @xmath462 . in this case , the height of the slab waveguide is @xmath463 and the period is @xmath464 .",
    "the small feature size of the graphene ribbons , @xmath465 , is required to excite graphene plasmons at moderately small wavelengths , at which waveguide modes exist , too .",
    "this is not a conceptual drawback of this particular structure , but it is computationally costly to accurately resolve graphene ribbons with very small width .",
    "thus , @xmath466 harmonics were used throughout this computational analysis and an added conductivity of @xmath467 was introduced .    to fully understand the linear and nonlinear optical properties of the graphene - waveguide structure ,",
    "let us first investigate two less complex , complementary structures where the graphene ribbons are located on the waveguide sections with either low or high index of refraction , as per figs .",
    "[ fig : wg_setting](b ) and [ fig : wg_setting](c ) , respectively , and also the waveguide covered with an unstructured , uniform graphene sheet , as per fig .",
    "[ fig : wg_setting](a ) .    a ) absorption spectra ( solid lines ) of the homogeneous graphene sheet and the graphene ribbons on top of inner and outer parts of the slab waveguide , c.f . figs .",
    "[ fig : wg_setting](a ) through [ fig : wg_setting](c ) , and reflection spectrum ( dashed line ) of the homogeneous graphene sheet .",
    "b ) the nonlinear radiation spectrum of the same structures as in a ) .",
    "c ) linear spectra ( reflection , transmission , and absorption ) and th spectrum for the graphene ribbons placed on top of both parts of the waveguide , as per fig .",
    "[ fig : wg_setting](d ) . ]    the linear absorption spectra for these three variations of the device , determined for values of the fundamental wavelength ranging from , are depicted in fig .",
    "[ fig : wgr_graphene_spectrum](a ) , where normal incidence and tm - polarization is assumed .",
    "the absorption of the waveguide with the covering graphene sheet follows a monotonously increasing trend , upon which alternating , broad local minima and maxima are superimposed .",
    "these maxima are due to the fabry - perot interference and primarily reveal themselves as maxima and minima of the device reflectivity , also shown in fig .",
    "[ fig : wgr_graphene_spectrum](a ) .",
    "the absorption spectra for the waveguide with graphene ribbons on top of the inner and outer parts of the waveguide exhibit relatively broad spectral peaks due to the excitation of surface plasmons in the graphene ribbons .",
    "their excitation wavelength chiefly depends on the width of the ribbon and the permittivity of the underlying dielectric : the lower refractive index material ( @xmath415 ) underneath the inner ribbons leads to excitation of plasmons at smaller wavelength than the wavelength corresponding to the plasmons in the outer ribbons , placed on top of waveguide sections with higher refractive index ( @xmath468 ) . in all three devices ,",
    "the absorption exhibits additional , spectrally narrow peaks with up to 30% absorption due to the excitation of optical modes in the slab waveguide grating .    the nonlinear radiation spectra in fig .  [ fig : wgr_graphene_spectrum](b ) complement these findings .",
    "thus , the intensity of the th radiation generated by the unstructured graphene sheet increases with wavelength and overlayed on it one can observe the effect of fabry - perot resonances .",
    "moreover , the local field enhancement due to the excitation of localized surface plasmons in the inner and outer graphene ribbons leads to increased thg at lower and higher wavelengths , respectively .",
    "the inherited waveguide modes maximize the amount of generated th radiation , which reaches values of up to @xmath469 .",
    "the interplay of these resonant effects in the combined graphene - waveguide structure with ribbons distributed over the whole area of the waveguide is revealed by the results presented in fig .",
    "[ fig : wgr_graphene_spectrum](c ) .",
    "note that the abscissa of this figure gives the values of the incoming wavelength , @xmath401 , for the linear reflection , transmission , and absorption spectra and the th wavelength , @xmath470 , for the intensity of thg .",
    "the absorption at the ff displays an increasing trend in the range of ; however , there are several spectrally broad and narrow absorption peaks , which are the manifestation of different phenomena .",
    "thus , the narrow resonances are due to the excitation of the tm@xmath425 mode of the slab waveguide , e.g. those at @xmath471 , @xmath472 , and @xmath473 .",
    "the electric field , @xmath474 , at the ff , @xmath471 , shows a strong enhancement at the top of the waveguide region , as per fig .",
    "[ fig : wgr_graphene_nearfield](a , top ) . similarly to the tm@xmath425 mode shown in fig .",
    "[ fig : wgr_tmdc_closeupnearfield](b ) , this field profile has two maxima over the @xmath89-extent of one unit cell of the grating and two maxima along the @xmath24-extent of the waveguide , where the maximum near the top of the waveguide is much larger than the one at the bottom .",
    "this strong fundamental field enhancement increases the absorption to @xmath475 and leads to a strong nonlinear source current , which in turn generates a strong electric field at the th , the near - field of which is depicted in fig .",
    "[ fig : wgr_graphene_nearfield](a , bottom ) .",
    "this th field is mostly localized around the graphene ribbons and has an evanescent nature .",
    "the total intensity of th radiated into the cover and substrate amounts to @xmath476 .",
    "the excitation of the tm@xmath425 mode at @xmath477 is equally interesting .",
    "it appears both as a sharp local maximum in the linear absorption spectrum at @xmath477 and as an increase of th intensity at the th wavelength @xmath478 in fig .",
    "[ fig : wgr_graphene_spectrum](c ) . the nonlinear electric near - field profile in fig .  [ fig : wgr_graphene_nearfield](b , bottom ) confirms the excitation of this intrinsic nonlinear tm@xmath425 mode for @xmath478 .    dominant component of the electric field @xmath358 at the ff ( top parts ) and the th ( bottom parts ) for selected fundamental wavelengths @xmath401 and th wavelengths @xmath470 : a ) field enhancement due to excitation of the tm@xmath425 waveguide mode for @xmath479 .",
    "b ) near - field profile of the tm@xmath425 mode at the th wavelength @xmath480 .",
    "c ) , d ) plasmonic field enhancement in the inner and outer ribbons for @xmath481 and @xmath482 , respectively .",
    "e ) , f ) excitation of surface plasmons in graphene ribbons located on top of waveguide sections with @xmath459 ( inner ribbons , @xmath483 ) and @xmath460 ( outer ribbons , @xmath484 ) , respectively .",
    "the labels of the panels correspond to the labels of the peaks in fig .",
    "[ fig : wgr_graphene_spectrum](c ) . ]",
    "another reason for increased absorption is the excitation of localized surface plasmons on the graphene ribbons . in order to illustrate this ,",
    "let us consider the two absorption peaks with largest wavelengths , around @xmath485 and @xmath486 .",
    "the absorption maximum with the largest wavelength appears in the linear spectrum as a very broad resonance around @xmath487 , but the electric near - field profiles in the two top panels of figs .",
    "[ fig : wgr_graphene_nearfield](c ) and [ fig : wgr_graphene_nearfield](d ) reveal that the actually surface plasmons are excited on the inner and outer graphene ribbons at slightly different wavelengths , @xmath481 and @xmath482 , respectively , which is explained by the difference in the electromagnetic environment probed by the corresponding plasmons .",
    "the excitation of these surface plasmons can also be seen in fig .",
    "[ fig : wgr_graphene_spectrum](c ) , as the local maxima labeled by `` _ _ c _ _ '' and `` _ _ d _ _ '' .",
    "moreover , they can be viewed directly in the nonlinear far - field radiation spectrum , too , as spectrally separated peaks . as a consequence of excitation of localized surface plasmons",
    ", the th near - field shows its highest values near the inner and outer ribbons at the th wavelengths , @xmath488 and @xmath489 , as illustrated in the bottom panels of figs .",
    "[ fig : wgr_graphene_nearfield](c ) and [ fig : wgr_graphene_nearfield](d ) , respectively .",
    "similar physics describe the lower - order plasmon corresponding to @xmath486 .",
    "thus , by inspecting the profiles of the fundamental near - field in the top panels of figs .",
    "[ fig : wgr_graphene_nearfield](e ) and [ fig : wgr_graphene_nearfield](f ) , one can see that , correspondingly , a plasmon with three peaks in the field profile is excited on the inner ribbons at @xmath490 whereas this same type of plasmon is excited on the outer ribbons at @xmath491 .",
    "this near - field pattern is in accordance to the surface plasmon field profiles that were found in section  [ sec : convergence:2d ] , fig .",
    "[ fig:2dfieldprofiles](b ) .",
    "moreover , no optical coupling between the plasmonic fields near adjacent ribbons could be observed .",
    "the spectra of the th radiation at the wavelengths @xmath492 and @xmath493 also exhibits two local maxima , due to the enhancement of the fundamental field . the number of electric field maxima near the inner and outer graphene ribbons in the bottom of figs .",
    "[ fig : wgr_graphene_nearfield](e ) and [ fig : wgr_graphene_nearfield](f ) , respectively , agrees with the 5 field maxima in fig .",
    "[ fig:2dfieldprofiles](d ) .",
    "the two physical mechanisms that lead to the resonant enhancement of the optical response of the graphene - waveguide structure can partly be observed in the reflection and transmission spectra at the fundamental wavelength , which mainly exhibit a variation between minima and maxima due to the fabry - perot interference .",
    "this pattern is complemented by spectrally very narrow regions of increased reflection and decreased transmission due to the excitation of waveguide modes .",
    "the influence of surface plasmons on the reflection and transmission is only apparent at the largest excitation wavelengths around @xmath487 , where reflection and transmission are notably increased and decreased , respectively .    ,",
    "determined in the wavelength range of the second - order surface plasmon of graphene ribbons .",
    "b ) the map of nonlinear radiation spectra shows the inherited ( red labels ) and intrinsic , nonlinear ( green labels ) modes of the slab waveguide .",
    "the left and right branches of intrinsic modes of the same order exhibit anti - crossing mode interaction , which leads to the formation of spectral band - gaps . ]",
    "an effective way of tuning the characteristics of the light radiated by our nonlinear diffraction grating is by varying the angle of incidence of the incoming light . not only will this showcase the effectiveness of the proposed numerical method in the oblique - incidence configuration , but it will also demonstrate the influence of the angle of incidence on the optical response of the grating .",
    "for example , the interaction of the spectrally narrow tm@xmath425 waveguide mode at @xmath479 with the two broad continua corresponding to the excitation of graphene plasmons at @xmath483 and @xmath484 provides a convenient optical setting for studying a tunable fano resonance resulting from the interaction between a discrete state and multiple continua , a phenomenon that has recently been explored in a different plasmonic structure @xcite .    to investigate the interaction between a waveguide mode and the two absorption peaks , @xmath494 simulations with @xmath466 harmonics",
    "have been performed for increasing angle of incidence , @xmath495 , ranging from ( and constant azimuthal angle @xmath496 ) in the fundamental wavelength range of the second - order plasmon peak , namely from .",
    "higher spectral resolution was employed near the waveguide resonance wavelengths of the slab waveguide .",
    "the resulting absorption map is shown in fig .",
    "[ fig : wgr_graphene_scans](a ) .",
    "the spectrum for @xmath497 is the same as in fig .",
    "[ fig : wgr_graphene_spectrum](c ) and shows two broad maxima of @xmath498 , due to the excitation of surface plasmons , and a sharp maximum of @xmath499 due to the excitation of the tm@xmath425 waveguide mode at @xmath500 .",
    "increasing the angle of incidence , @xmath495 , leaves the spectral location of the plasmon excitation unchanged ; however , the spectral location of the waveguide mode resonance varies . for @xmath501",
    ", the tm@xmath425 mode is excited at two wavelengths , @xmath502 and @xmath503 .",
    "their separation from @xmath504 increases with @xmath495 and a more effective excitation on the left branch of the tm@xmath425 mode can be seen as compared to the right branch . for @xmath505 and @xmath506 the wavelengths of the mode , @xmath507 and @xmath508 , coincide with the central wavelength of the plasmon absorption peaks of the inner and outer ribbons , yielding absorption of @xmath509 and @xmath510 , respectively .    along the tm@xmath425 band , i.e. the path of excitation of the tm@xmath425 mode in the ( @xmath511)-space , strong enhancement of conversion efficiency due to inherited effect of this mode can be observed in fig .",
    "[ fig : wgr_graphene_scans](b ) .",
    "the simultaneous excitation of waveguide modes and graphene plasmons yields strong thg , with intensities of @xmath512 at @xmath513 and @xmath506 and @xmath514 at @xmath515 and @xmath505 .",
    "however , the strongest th intensity of @xmath516 is generated at @xmath517 and @xmath518 , namely where the intrinsic tm@xmath441 band crosses the inherited tm@xmath425 band .",
    "the increase of the conversion efficiency due to sole excitation of the intrinsic nonlinear modes is notable , but orders of magnitude lower than in the case of inherited effects , e.g. the same intrinsic tm@xmath441 mode away from the simultaneous resonance , at @xmath519 and @xmath520 , yields th radiation of intensity @xmath521 .",
    "inspection of the bands of the intrinsic modes reveals and additional interesting feature .",
    "specifically , intrinsic modes of the same order show anti - crossing behavior , e.g. tm@xmath425 at @xmath522 and @xmath523 or tm@xmath441 at @xmath524 and @xmath525 , whereas bands of different intrinsic modes pass through each other , i.e. tm@xmath425 and tm@xmath441 at @xmath526 and @xmath527 .",
    "this crossing of modes of same order occurs when the transverse component of the incident @xmath47 vector , @xmath420 , reaches the edge of the first brillouin zone .",
    "in conclusion , we have derived an improved , an accurate formulation of the rigorous coupled - wave analysis ( rcwa ) method to describe linear and nonlinear optical interactions between light and periodically patterned 2d materials , such as graphene and transition - metal dichalcogenide ( tmdc ) monolayers . unlike previous approaches ,",
    "our numerical formalism does not depend on the height of the 2d material , a poorly defined physical quantity , and as such is applicable to any 2d material , as long as their linear and nonlinear optical surface conductivities are known . a key ingredient that markedly improves the accuracy and convergence of this numerical method is a vanishingly small , added conductivity , which allows for correctly solving the fourier factorization problem and consequently a reliable computational investigation of 2d materials . in particular , this small value of the added conductivity yields accurate results when convergence with respect to the number of harmonics has been achieved .",
    "the proposed numerical method also allows one to describe the nonlinear optical response of generic periodically patterned 2d materials . in this context",
    ", we have found that correct nonlinear optical physics in these structures can only be captured when using the accurate near - field formulation of rcwa introduced in @xcite .",
    "importantly , our approach employing boundary conditions for the linear and nonlinear fields can be readily extended to other methods @xcite used to describe nonlinear optical effects at interfaces , as in the case of graphene and tmdc monolayer materials the optical higher - harmonics are generated in a single atomic layer .",
    "our numerical method has been comprehensively validated by comparing its predictions to results obtained using an alternative method . upon successful validation ,",
    "we have used it to investigate the characteristics of various kinds of diffraction gratings comprising graphene and tmdc monolayers .",
    "we found that these materials interact differently with light , which is explained by their metallic or semiconductor nature .",
    "thus , graphene exhibits thg as the lowest - order nonlinear optical interaction , due to the inversion symmetry properties of its atomic lattice , and supports surface plasmons .",
    "we found that the excitation of surface plasmons leads to increased linear absorption and enhanced thg , which points to significant potential for tunable thg in graphene .",
    "the tmdc monolayer materials , on the other hand , are semiconductors and non - centrosymmetric . as a result ,",
    "their linear optical absorption spectra show a series of exciton resonances , whereas in this case the shg is the lowest - order nonlinear optical process .    as an application of our numerical method",
    ", we have demonstrated that by coupling a tmdc monolayer with a photonic structure that possesses optical resonances , namely a periodically patterned slab waveguide , one can achieve strong , frequency selective field enhancement and consequently increased nonlinear optical response of the tmdc monolayer .",
    "in addition , we have showed that by coupling graphene with a similar waveguiding device , the interplay between plasmon resonances in graphene and leaky waveguide resonances of the slab waveguide leads to rich physics explained by intriguing phenomena , such as multi - continua fano resonances and enhanced shg via simultaneous excitation and efficient coupling of optical modes at the ff and sh .",
    "the formulation of our method is general enough to describe most nonlinear optical processes of practical interest in the undepleted pump approximation , which is valid in essentially all experimental settings . in order to tackle those cases where this approximation might be less accurate , such as the optical kerr effect",
    ", one can easily extend our method beyond the undepleted pump approximation by employing an iterative , self - consistent solution process , similar to the approach introduced in @xcite for describing optical kerr effects in periodic bulk media .",
    "equally important , it is also possible to investigate important carriers related optical effects in 2d materials with the proposed method , namely the influence of charge doping on the optical properties of photonic structures containing 2d materials . whereas a rigorous description of transient effects in such systems would require the incorporation of charge dynamics in our numerical algorithm , a nontrivial but tractable task , the optical response in the steady - state can be determined by simply modifying the electric permittivity of the 2d materials so as to take into account the dependence of the permittivity on the charge density .",
    "this work was supported by the european research council , grant agreement no .",
    "the work of m. w. was partly supported through a ucl impact award graduate studentship funded by ucl and photon design , ltd .",
    "the authors thank y. s. kivshar and d. f. g. gallagher for many insightful discussions and wish to acknowledge support from the royal society s international exchanges scheme and the hospitality of the nonlinear physics centre of the australian national university .",
    "the authors acknowledge the use of the ucl legion high performance computing facility ( legion@ucl ) and associated support services in the completion of this work .",
    "for the sake of completeness , we outline in this appendix the mathematical description of the rcwa based approach used to find the layer - wise solution of the diffraction grating problem . for now , let us drop the superscript @xmath14 , as the description of the modal form of the electromagnetic field is independent on whether a pump or generated frequency is considered .    known as the bloch theorem , the solution of mes for a periodic structure is pseudo - periodic , i.e. periodic with an additional transverse phase shift .",
    "therefore , the permittivity @xmath12 of the structure in the @xmath4-plane can be expressed as a 2d fourier series : @xmath528 with @xmath24-dependent coefficients @xmath529 .",
    "the sum over @xmath530 is to be understood as the double infinite sum over the integers @xmath531 , @xmath532 .",
    "similarly , the electromagnetic field quantities , @xmath533 , can be expressed as a fourier series with phase shift , @xmath534}}\\right)}}(x , y ) ,    \\label{eq : deffs}\\end{aligned}\\ ] ] where @xmath535 is the @xmath536 component of the @xmath537th diffraction order .",
    "the intrinsic phase shift is determined by the transverse component of the @xmath47-vector of the incident plane wave , @xmath538 .",
    "the sequence of fourier coefficients shall be denoted by @xmath539}}$ ] , and the evaluation of a fourier by means of the sum in eq .",
    "is denoted by the reconstruction operator , @xmath540}}\\right)}}$ ] .    in actual calculations ,",
    "the infinite sums in eqs .   and",
    "have to be truncated .",
    "a rectangular truncation approach , namely @xmath541 , will be used throughout this derivation , yielding a total of @xmath542 fourier series coefficients ( or harmonics ) .    in the remaining part of the section we will provide the general mathematical formulation of the modal field expansion of the electromagnetic field .",
    "thus , the underlying assumption of the modal field expansion in a periodic bulk layer of the grating is that the permittivity function , @xmath543 , in layer @xmath544 $ ] is @xmath24-invariant , where @xmath545 and @xmath546 denote the bottom and the top of the periodic bulk layer .",
    "this implies that the fourier coefficients , @xmath547 , of @xmath543 are @xmath24-independent , too .",
    "since the field solution is periodic according to bloch theorem , the electromagnetic fields inside this periodic bulk layer are pseudo - periodic , i.e. they can be expressed as fourier series with phase shift using the reconstruction operator , @xmath548 :    [ eq : periodicansatz ] @xmath549}}{{\\bf e}}_x + { { [ e_{y}(z)]}}{{\\bf e}}_y + { { [ e_{z}(z)]}}{{\\bf e}}_z\\right)}},\\\\          { { \\bf h}}({{\\bf r } } ) = & \\ { { { \\mathcal r}\\left({{[h_{x}(z)]}}{{\\bf e}}_x + { { [ h_{y}(z)]}}{{\\bf e}}_y + { { [ h_{z}(z)]}}{{\\bf e}}_z\\right)}}.      \\end{aligned}\\ ] ]    before using these ansatz functions to determine the electromagnetic fields , the correct fourier factorization rules @xcite have to be used in order to factorize the product , @xmath550 as they ensure accuracy and convergence of the rcwa modal expansion even for low number of harmonics .    in this work , the normal vector field approach @xcite in bulk layers is used to accurately solve the fourier factorization problem in 2d . to this end , let @xmath551 be a continuation of the surface normal vectors of the grating structure , i.e. a normal vector field .",
    "the fourier series factorization of the constitutive relation eq",
    ".   then reads , @xmath552 } } & = \\epsilon_0\\sum_{\\beta=1}^3 \\left(\\delta_{\\alpha,\\beta}{{\\llbracket \\epsilon_r \\rrbracket } } -      \\delta\\textsf{{{n}}}_{\\alpha\\beta}\\right){{[e_\\beta(z ) ] } } , \\label{eq : constrelationnvf}\\end{aligned}\\ ] ] where @xmath553 is the kronecker delta . here",
    ", @xmath554 denotes the toeplitz matrix of fourier coefficients of a function @xmath555 , and the matrix @xmath556 is given by @xmath557 , with @xmath558 and @xmath559 being the @xmath159-component of the normal vector field , @xmath560 , at the material boundary .    inserting eq .  , the permittivity given by eq .  , and the correct factorization provided by eq .   into the mes one obtains a linear system of ordinary differential equations for the @xmath24-dependent amplitudes of the modal fields .",
    "this system is solved assuming exponential dependency for modal fourier coefficients , @xmath561 } } = { { [ e_\\alpha]}}e^{ik_0{{\\nu}}z}$ ] and @xmath562 } } = { { [ h_\\alpha]}}e^{ik_0{{\\nu}}z}$ ] , with the complex propagation constant , @xmath563 .",
    "then , the system of ordinary differential equations can be rewritten as an algebraic eigenvalue problem for @xmath564}}$ ] , @xmath565}}\\\\{{[e_y]}}\\end{array}\\right ) = { { \\nu}}^2 \\left(\\begin{array}{c } { { [ e_x]}}\\\\{{[e_y]}}\\end{array}\\right ) , \\label{eq : defevproblem}\\end{aligned}\\ ] ] and an additional relation for @xmath566}}$ ] , @xmath567}}\\\\{{[h_y]}}\\end{array}\\right ) = \\textsf{m}_1 \\left(\\begin{array}{c } { { [ e_x]}}\\\\{{[e_y]}}\\end{array}\\right ) .",
    "\\label{eq : defevh}\\end{aligned}\\ ] ] in these relations , @xmath568 are @xmath253 matrices of block - matrix form : @xmath569 here , @xmath570 , the matrices @xmath571 , @xmath572 , are diagonal matrices of the in - plane propagation constants , @xmath573 , of the diffraction orders , and @xmath574 is the identity matrix of size @xmath267 .",
    "the eigenvalue problem defined by eq .   has @xmath575 solutions consisting of the eigenvalues @xmath576 and eigenvectors @xmath577}},{{[e^{m}_y]}}\\right)$ ] , @xmath578 . defining the positive and negative roots of @xmath576 as @xmath579 respectively ,",
    "one obtains a total of @xmath575 upward and @xmath575 downward propagating modes of the grating .",
    "the upward ( downward ) mode with index @xmath151 is defined by its propagation constant , @xmath580 ( @xmath581 ) , and its transverse mode profile given by the fourier vector coefficients , @xmath582}}$ ] and @xmath583}}$ ] ( @xmath584}}$ ] and @xmath585}}$ ] ) , where @xmath583}}$ ] ( @xmath585}}$ ] ) are obtained from eq .   by setting @xmath586 ( @xmath587 ) .    since the bulk grating layer is considered to be made of linear optical materials ,",
    "the linear superposition of modes is a solution to the mes , too .",
    "therefore , the total electric field in the grating is given by @xmath588}}\\right)}}(x , y)e^{ik_0{{\\nu}}_m^+(z - z^{- } ) } \\nonumber \\\\      & + c^-_m { { { \\mathcal r}\\left({{[e^{(m,-)}]}}\\right)}}(x , y)e^{ik_0{{\\nu}}_m^-(z - z^{+ } ) } , \\label{eq : defrcwamodalexpansion}\\end{aligned}\\ ] ] where the complex mode coefficient @xmath589 ( @xmath590 ) determines the contribution of each upward ( downward ) propagating mode to the total grating field and @xmath591 ( @xmath592 ) denotes the @xmath24-coordinate of the bottom ( top ) of the considered grating layer .",
    "the components of the magnetic field , @xmath593 , can be found from a similar equation . given this structure of the modes , the electromagnetic fields in the grating",
    "are hence fully determined by @xmath594 mode coefficients , @xmath595 .",
    "their values are obtained by means of the electromagnetic boundary conditions described in section  [ sec : inhomsmatrix ] .    for reasons related to the practical implementation of rcwa ,",
    "it is useful to rewrite eq .   in terms of @xmath24-dependent fourier coefficients , similar to eqs .  , but interchanging the order of summation of modes and fourier components in eq .  :",
    "[ eq : defrcwamodalfield ] @xmath596}}\\right)}}(x , y ) + { { { \\mathcal r}\\left({{[e_\\alpha^{-}(z)]}}\\right)}}(x , y ) , \\\\          & h_\\alpha({{\\bf r } } ) = \\ { { { \\mathcal r}\\left({{[h_\\alpha^{+}(z)]}}\\right)}}(x , y ) + { { { \\mathcal r}\\left({{[h_\\alpha^{-}(z)]}}\\right)}}(x , y ) ,      \\end{aligned}\\ ] ]      [ eq : defrcwamodalmatrix ] @xmath599 } } = & \\sum_{m=1}^{2n_0 } { { [ e^{(m , \\pm)}_\\alpha(z ) ] } }          = \\sum_{m=1}^{2n_0 } { { [ e^{(m,\\pm)}_\\alpha ] } } e^{ik_0{{\\nu}}^\\mp_m ( z - z^\\mp ) } c_m^\\pm \\nonumber \\\\          & =   \\textsf{e}^\\pm_\\alpha { { \\textsf{v}}}^\\pm(z){{\\bf c}}^\\pm,\\\\          { { [ h^{\\pm}_\\alpha(z ) ] } } = & \\textsf{h}^\\pm_\\alpha { { \\textsf{v}}}^\\pm(z){{\\bf c}}^\\pm .",
    "\\end{aligned}\\ ] ]    here , the @xmath253 mode - shape matrix @xmath600 ( @xmath601 ) contains the vector of fourier coefficients , @xmath602}}$ ] ( @xmath603}}$ ] ) , in its @xmath151th column .",
    "moreover , the propagation matrix , @xmath604 , is a diagonal matrix containing the @xmath24-dependence of each mode on its diagonal , @xmath605 , with @xmath606 , and @xmath223 denotes the vector of upward ( `` @xmath145 '' ) and downward ( `` @xmath146 '' ) propagating mode coefficients .    using eqs .",
    "and one can determine the electromagnetic field everywhere in and around the grating , namely in the periodic or homogeneous bulk layers forming the grating as well as in the cover and substrate .",
    "however , for homogeneous layers a rayleigh expansion @xcite with the diffraction orders as modes is preferable to the solution of the rcwa eigenproblem defined by eq .   as it is computationally less demanding to calculate @xmath600 , @xmath607 , and @xmath223 for the rayleigh expansion .    as a concluding remark",
    ", we note that the importance of eqs .",
    "resides in that it translates the electromagnetic field from its modal representation to its direct representation as fourier series . the modal representation in terms of @xmath600 , @xmath607 , and @xmath223 in the r.h.s . of eqs .",
    "is restricted to a computational layer , but very advantageous therein , as it separates mode - shape quantities , @xmath608}}$ ] , propagation and decay constants @xmath609 , and excitation strength coefficients @xmath610 .",
    "on the other hand , the direct field representation as a fourier series with coefficients @xmath611}}$ ] in the l.h.s . of eqs .",
    "has the same complex exponentials , @xmath612 , as basis functions everywhere in the grating , and hence it facilitates the comparison of quantities in different computational layers .    97 ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1 '' '' @noop",
    "[ 0]secondoftwo sanitize@url [ 0 ] ",
    "+ 12$12  & 12#1212_12%12 @startlink[1 ] @endlink[0 ] @bib@innerbibempty @noop * * ,   ( ) @noop * * , ( ) link:\\doibase          10.1073/pnas.0502848102 [ * * ,   ( ) ] @noop * * , ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) link:\\doibase          10.1021/cr300263a [ * * ,   ( ) ] link:\\doibase 10.1021/nl1022139 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1109/jproc.2013.2260115 [ * * ,   ( ) ] \\doibase      http://dx.doi.org/10.1016/j.mser.2013.09.001 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.92.161406 [ * * , ( ) ] @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1038/srep05530 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.87.201401 [ * * ,   ( ) ] link:\\doibase 10.1021/nl401561r [ *",
    "* , ( ) ] http://dx.doi.org/10.1038/nnano.2015.73 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1126/science.1171245 [ * * ,   ( ) ] @noop _ _  ( ,  ) @noop _ _  ( , ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.85.081405 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1364/ol.38.003009 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1364/josaa.12.001068 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1364/josab.31.000987 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.88.045318 [ * * , ( ) ] link:\\doibase      10.1103/physrevb.90.205422 [ * * ,   ( ) ] link:\\doibase      10.1364/ome.5.000447 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.75.205418 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase      10.1103/physrevb.90.115438 [ * * ,   ( ) ] https://books.google.co.uk/books?id=xeg9aqaaiaaj [ _ _ ]  ( ,  ) @noop _ _ ( ,  ) link:\\doibase 10.1103/physrevlett.90.036801 [ * * , ( ) ] @noop * * ,   ( ) link:\\doibase 10.1364/josaa.19.001919 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1364/josab.27.001118 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop _ _  ( ,  ) @noop * * ,   ( ) https://books.google.co.uk/books?id=ov80aaaaiaaj[_ _ ]  ( ,  )  chap .",
    "@noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1364/josaa.13.001024 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop _ _ ,  vol .",
    "( ,  ) link:\\doibase 10.1103/physrev.124.1866 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase      10.1103/physrevlett.110.087402 [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase      10.1364/josab.31.002371 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> remarkable optical and electrical properties of two - dimensional ( 2d ) materials , such as graphene and transition - metal dichalcogenide ( tmdc ) monolayers , offer vast technological potential for novel and improved optoelectronic nanodevices , many of which relying on nonlinear optical effects in these 2d materials . </S>",
    "<S> this article introduces a highly effective numerical method for efficient and accurate description of linear and nonlinear optical effects in nanostructured 2d materials embedded in periodic photonic structures containing regular three - dimensional ( 3d ) optical materials , such as diffraction gratings and periodic metamaterials . </S>",
    "<S> the proposed method builds upon the rigorous coupled - wave analysis and incorporates the nonlinear optical response of 2d materials by means of modified electromagnetic boundary conditions . </S>",
    "<S> this allows one to reduce the mathematical framework of the numerical method to an inhomogeneous scattering matrix formalism , which makes it more accurate and efficient than previously used approaches . </S>",
    "<S> an overview of linear and nonlinear optical properties of graphene and tmdc monolayers is given and the various features of the corresponding optical spectra are explored numerically and discussed . </S>",
    "<S> to illustrate the versatility of our numerical method , we use it to investigate the linear and nonlinear multiresonant optical response of 2d-3d heteromaterials for enhanced and tunable second- and third - harmonic generation . </S>",
    "<S> in particular , by employing a structured 2d material optically coupled to a patterned slab waveguide , we study the interplay between geometric resonances associated to guiding modes of periodically patterned slab waveguides and plasmon or exciton resonances of 2d materials . </S>"
  ]
}