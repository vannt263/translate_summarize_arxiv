{
  "article_text": [
    "this paper is to honor giovanni jona - lasinio birthday .",
    "we are grateful to him since he has taught to us , as to so many other people in rome and in other places , a lot of physics and much about the way to love good physics .",
    "thanks , and happy birthday !",
    "the use of clustering methods to qualify the low temperature phase of spin glass systems has been recently advocated in a group of very interesting papers @xcite .",
    "it is indeed well known that the broken phase of mean field spin glasses has a high level of complexity , that translates statically in parisi spontaneous replica symmetry breaking ( rsb ) and dynamically in a series of dramatic phenomena that go from a severe critical slowing down @xmath1 to memory effects , aging phenomena and violations of the fluctuation - dissipation theorem @xcite .",
    "ultrametricity of states @xcite is one of the key features of the mean field parisi picture : states of the system turn out to be endowed by an ultrametric distance , and the phase space is organized hierarchically .",
    "do finite dimensional spin glass systems share this properties , and can we find a way to check that ?",
    "this is an important issue of the persistent debate @xcite about the physics of the low temperature phase of finite dimensional spin glasses .",
    "detecting ultrametricity on finite volume systems turns out to be very difficult @xcite : the introduction of constrained monte carlo methods @xcite and the analysis of the dynamical behavior of the system @xcite help only marginally .",
    "finite size effects are very strong , and make the asymptotic potential emergence of a hierarchical structure difficult to observe .    here we introduce some new analysis techniques and we study the sherrington - kirkpatrick ( sk ) mean field model , where we know that for low @xmath0 a non - trivial ultrametric structure emerges in the infinite volume limit",
    ". we will find out that this is a difficult task , sharing all the problems one observes in finite dimensional systems @xcite .",
    "our main points can be summarized in four basic issues :    1 .   we find that to be of better use the approach based on hierarchical clustering has to be complemented by the use of testing techniques that have been developed in the field of numerical taxonomy @xcite .",
    "we discuss some of these techniques and we show how they can be applied to our problem .",
    "we discuss the role of the @xmath2 symmetry of the phase space .",
    "we find that removing this symmetry ( that in this context is accidental ) is crucial to get sensible results from quantitative tests .",
    "we introduce and discuss the way to remove the symmetry from equilibrium configurations obtained in zero magnetic field .",
    "thanks to these techniques we are able to clarify how a finite volume sk system behaves as far as ultrametricity is concerned , by working out strengths and limitations of the method . we find that on the ( medium - large ) lattice sizes that we are able to analyze one can establish that a structure is emerging , but that one can not get a compulsory evidence about this structure being ultrametric .",
    "this is exactly the same kind of phenomenon one observes when studying finite dimensional systems @xcite .",
    "we analyze systematically finite size effects ( by studying systems on different lattice sizes ) and the dependence of our results over @xmath0 .",
    "thanks to the quantitative analysis techniques that we introduce we are able to use hierarchical clustering techniques to discuss also quantities that are _ averaged over the disorder _ , opening in this way a large information window .",
    "the low temperature mean field behavior of spin glass systems is understood in the framework of the parisi rsb scheme @xcite .",
    "the prototype of mean field spin glass models is the sk fully connected ising model where coupling constants are _ quenched _ random variables : @xmath3=-\\sum_{i ,",
    "k=1}^n \\sigma_i j_{i , k}\\sigma_k \\ , \\label{e - h}\\ ] ] where @xmath4 are spin variables and the @xmath5 are distributed according to an even distribution function .",
    "for example we can use a gaussian distribution with @xmath6 ( since we want to avoid ferromagnetic effects ) and @xmath7 ( to ensure that the energy is extensive ) . as we have already reminded , the parisi rsb solution of the sk model , which is believed to be the correct solution of mean field theory at low @xmath0 , exhibits an ultrametric organization of the states @xcite .",
    "this means that in the infinite volume limit for any triple of equilibrium spin configurations @xmath8 we have that : @xmath9 where @xmath10 is the overlap among configurations @xmath11 and @xmath12 , defined as @xmath13 ( here configurations @xmath11 and @xmath12 are independent configurations at equilibrium under the same hamiltonian , sharing the same quenched realization of the random couplings : they are only coupled by the fact of sharing the same realization of the random hamiltonian ) .",
    "the overlap @xmath10 is a similarity index , and the distance is connected to one minus the overlap",
    ".    we will analyze in detail the fact that revealing numerically an ultrametrical emerging structure on finite systems is difficult .",
    "the question is even more relevant since detecting reliable signs of an ultrametric structure could be crucial in finite dimensional systems , where the behavior of the system in the low @xmath0 phase is not yet understood @xcite .",
    "clustering @xcite is a powerful technique for analyzing data ( for interesting applications of statistical mechanical ideas to clustering see @xcite ) . since producing a valid hierarchical clustering is equivalent to show the existence of a true ultrametric structure of the data ,",
    "this kind of approach can give crucial evidences .",
    "we will discuss here what happens in the infinite range mean field sk model , where we know that eventually , in the infinite volume limit , ultrametricity of states will emerge .",
    "we believe this is needed to help in interpreting the results obtained in the analysis of finite dimensional models @xcite .",
    "we will see that some important hints do indeed emerge .",
    "in this note we introduce some new ideas relevant for hierarchical cluster as applied to the analysis of disordered and complex systems , and we discuss numerical results obtained from a clustering analysis of equilibrium spin glass configurations , with a particular emphasis on the study of the ultrametric nature of these states .",
    "we explain why a detailed analysis requires an appropriate elimination of the spin flip symmetry and we investigate the dependence of our results on the number of degrees of freedom of the system , showing that finite size effects are actually very large .    the paper is organized as follows . in section [ s - cluster ]",
    "we introduce the clustering procedure and we explain the motivations for our precise choice of a given clustering algorithm . in section [ s - analysis ]",
    "we apply this technique to the sk model ; we discuss our findings about ultrametricity , also by comparing them with those that one obtains by using standard techniques . here",
    "we will introduce and use quantitative ways to state the significance of the results obtained by clustering ( mainly in section [ ss - qt ] ) . as we said",
    "before a more detailed analysis requires a previous elimination of the @xmath2 symmetry , and this is done in section [ ss - reverse ] : in section [ ss - other ] we will also say a few words about using different clustering schemes .",
    "section [ s - spins ] is dedicated to the clustering of the spins .",
    "we report our conclusions in the last section .",
    "clustering is a special kind of ( potentially very powerful ) classification tool .",
    "we will give here only the basic informations we need for our analysis , and we advise the reader to look at @xcite for further details .",
    "let us consider a sample done of @xmath14 data @xmath15 , where each data point @xmath16 is a vector in a @xmath17-dimensional space .",
    "we want to study the underlying organization of the data , i.e. we want to find out whether the data are organized according to some non - trivial structure .",
    "a problem of this type is strictly related to pattern recognition analysis and to bayes decision theory @xcite : it is of very general interest , since it emerges in many relevant contexts .",
    "the main ingredient for the analysis is the _ proximity matrix _ @xmath18 .",
    "@xmath19 is some measure of the dissimilarity of data @xmath20 and @xmath21 .",
    "it is such that @xmath22 and @xmath23 .",
    "@xmath24 does not need to be a distance ( for example the triangular inequality could not be satisfied ) but usually it is one .    by clustering we group the data in sets that can be related among them in different ways . here",
    "we will use the exclusive ( each data belongs to exactly one cluster ) , intrinsic ( i.e. based only on the proximity matrix @xmath24 ) classification known as _",
    "hierarchical clustering_. hierarchical clustering is a nested sequence of partitions obtained through a classification technique based on one of many possible algorithms . the output of the algorithm can be represented by a hierarchical tree ( a so - called _ dendogram _ ) .    a generic ( even random ) set of data can always be arranged to fit a tree - like structure : this is indeed what clustering does . after doing such ( potentially arbitrary ) clustering",
    "we are left with the relevant question of deciding if the hierarchical structure that has been reconstructed was somehow intrinsic to the data set : this requires an analysis _",
    "a posteriori_.    so , in hierarchical clustering we start from a set of data , we group them by some algorithm ( that we will specify in the following ) building in this way a hierarchical tree .",
    "comparison of this tree and the original data can lead to quantitative conclusions about the presence of a true hierarchical structure in the data .    in the course of a cluster analysis one usually faces two main problems .    *",
    "the first important step is the definition of the dissimilarity index @xmath25 which is not always naturally induced from the context ( data do not necessarily belong to an euclidean space ) . + in our case this is an easy problem .",
    "starting from the usual notion of overlap ( [ e - overlap ] ) the distance between two spin configurations can be for example naturally and easily defined as @xmath26 * the second problem is how to update distances among elements . when we fuse elements @xmath11 and @xmath12 in element @xmath27 ( so joining two smaller clusters in a larger one ) we have to define all distances from the new cluster @xmath27 to all other clusters of the system @xmath28 .",
    "this step is crucial since it can play a dramatic role in the structure of the iteration , even if in situation where hierarchical clustering turns out to be _ natural _ , i.e. an intrinsic property of the data set , results have to be independent from this issue ( there exist alternative approaches which allows to avoid such an explicit choice by means of a priori hypothesis @xcite ) .",
    "+ the most part of our results has been obtained by the _ ward method _ ( or _ minimum variance method _ ) @xcite .",
    "the method is based on minimizing the square error , and is empirically known to outperform other hierarchical clustering methods .",
    "+ when we merge the two clusters that have the smaller distance we define the new distance using the following rule : if @xmath29 and @xmath30 merge to form @xmath31 , and @xmath32 is the number of elements in the cluster @xmath11 , then for any other cluster @xmath33 : @xmath34 let @xmath35 stand for one of the clusters of the system and consider the quantity @xmath36 where the sum is over all the clusters defined in the system and where @xmath37 the choice of the ward algorithm ensures that when merging two clusters to form a new one @xmath38 increases of a minimal amount . in other terms",
    "this definition of distance is the one induced from the maximum likelihood principle .",
    "this defines the clustering scheme that we will follow .",
    "we will discuss next how these ideas can be applied to mean field spin glass models , and how the result can be understood and quantified by testing the cluster validity .",
    "as we have said we have decided to analyze numerically the mean field sk model . since here",
    "the infinite volume scenario is under full control we believe this is a crucial step in understanding what one can learn from numerical simulations on finite lattices , and to control the consequences of such results obtained on finite dimensional models @xcite where , on the contrary , the theoretical scenario is far from clear .",
    "we have started by generating by an optimized monte carlo method a large number of uncorrelated spin configurations on lattices of different sizes and for a number of different realizations of the quenched disorder ( on which we eventually average ) , under the hamiltonian ( [ e - h ] ) , with quenched random couplings assigned under a gaussian distribution .",
    "we analyze systems with @xmath17 , number of spins , equal to @xmath39 , @xmath40 and @xmath41 ( @xmath42 is typical of a medium size numerical simulation , corresponding for example to a linear size of @xmath43 in three dimensions ) .",
    "we thermalize our systems at a set of different values of the temperature typically going from @xmath44 ( a very low value , that we can reach only thanks the power of parallel tempering @xcite ) , and in all cases we analyze @xmath45 different realizations of the quenched couplings . for all lattice sizes , relevant temperatures and disorder realizations we first thermalize the system . after doing that we record one spin configuration after any new set of @xmath46 combined full monte carlo sweeps and parallel tempering updates of the system .",
    "the large `` computer time '' separation among different configurations guarantees a very high level of statistical independence .",
    "residual possible ( very small ) correlations would not spoil our analysis but would only make it a bit less effective .",
    "we have recorded @xmath47 such independent spin configuration for each value of the parameters : such configurations are the basic set of objects that we have clustered .",
    "parallel tempering @xcite has been crucial in allowing to bring at thermal equilibrium spin configurations at such low temperature values on acceptable lattice volumes .",
    "the method is based on simulating in parallel copies of the system at different temperature @xmath0 values , allowing the different copies to swap @xmath0 among them ( with a standard metropolis weight ) .",
    "this reduces the free energy barriers , always keeping the different copies at boltzmann equilibrium : tempering can be seen as an annealing where the basic quantity is not energy but free energy .",
    "we have used all standard criteria to check that , when using the parallel tempering optimized monte carlo scheme , we have really reached thermal equilibrium @xcite : we have checked that our sample dependent overlap probability distributions @xmath48 are indeed well symmetric under @xmath49 , we have checked that all copies of the system have visited a number of times all available temperature values , we have checked that the acceptance factor of the temperature acceptance swap has been of order @xmath50 .    in the rest of this note",
    "we will work on _ clustering _ these configurations and on using quantitative testing to extract the implications of the hierarchical structure that we obtain .",
    "we first introduce a standard graphical way to get a qualitative feeling about the set of data .",
    "we consider the proximity matrix @xmath51 , where we have the set of data ( in some order to be specified ) on the @xmath52 and on the @xmath53 axis , and where we plot with darker colors points with higher overlap : the diagonal constitutes by definition the darkest set of the matrix . in figure [ f - matrix - a ]",
    "we start by showing , on the left , the matrix @xmath54 for a given disorder realization at @xmath42 and @xmath55 ( a very low value of @xmath0 , the lowest we have analyzed : here the system is basically in its ground state ) where configurations have been ordered at random .",
    "a clearly random pattern emerges .",
    "we apply the ward algorithm to these configurations in order to obtain a hierarchical tree ( as we have discussed before).kleiweg / clustering / clustering.html ] the hierarchical tree that contains the information about the clustering , the so - called _ dendogram _ is shown in the upper part of the right side of figure [ f - matrix - a ] . in the lower part of the right hand side of figure [ f - matrix - a ] we show the matrix obtained by ordering the configurations _ as from the dendogram _ on the @xmath52 and on the @xmath53 axis . now",
    "the two reflected states appear very clearly ( at such a low @xmath0 value there are basically two @xmath56 functions at values @xmath57 , where @xmath58 is close to one )",
    ". we can not observe any further structure , since @xmath0 is too low ( the ideal temperature value for observing hints of ultrametric effects will turn out to be , for our lattice sizes , of the order of @xmath59 ) .",
    "as we increase the temperature we observe that well defined structures emerge ( see figure [ f-3 t ] , where we show results for a single sample , with @xmath42 , at @xmath60 , @xmath61 and @xmath62 ) : when we reach the critical temperature @xmath63 and we go deeper in the warm phase we obtain _ a homogeneous matrix _ : here spins are equally likely to be up or down , and as a consequence the overlap between two configurations is zero on average .",
    "we stress that the information about the @xmath2 symmetry is a trivial , well known one , that does not give us further insight : still , it is interesting that the clustering algorithm is able to reconstruct it .",
    "we will discuss at length the fact that , on the opposite side , the presence of the symmetry is deeply annoying in that it makes more difficult to get quantitative information about the structure in one of the two @xmath2 sectors , hiding many features of the data , and making interesting predictions impossible .",
    "we also use figure [ f-3 t ] to make a further point .",
    "the dendograms , that make possible to visualize the hierarchical structure build from the clustering , do not give much unambiguous information about the underlying structure .",
    "the picture from @xmath60 is not so different , but for some power rescaling of the lengths , from the one at very high @xmath0 ( @xmath62 ) where we do not expect a non trivial ultrametricity to appear .",
    "clusters at hight @xmath0 are , indeed , more balanced , but one can only get some qualitative feelings about it .    in the following we will work on trying to quantify the qualitative statements about the possible presence of a ( maybe hierarchical ) definite structure in the low @xmath0 phase .      before discussing our approach toward a quantitative analysis based on hierarchical clustering techniques and aimed to check whether the spin configurations ( our original data set ) are really organized according to an ultrametric structure , we analyze the system by applying a more standard statistical mechanical approach .",
    "following @xcite we analyze the probability distribution of the variable @xmath64 where we have ordered the three distances to satisfy the condition @xmath65 .",
    "this implies that @xmath66 $ ] . in an ultrametric space",
    "we would get that @xmath67 .    on our finite @xmath17 lattices",
    "we assume the following dependence of @xmath68 over @xmath69 : @xmath70 where @xmath71 is the step function .",
    "we analyze the behavior of the variance @xmath72 with the size @xmath17 .",
    "we show our results in figure [ f - sigma ] . in the upper plot we select @xmath61 and we plot @xmath30 as a function of @xmath17 .",
    "@xmath30 decreases with @xmath17 , but very slowly ( as we expected from the results of @xcite , where even with a tuned up monte carlo procedure one finds that similar analysis are very difficult ) : it is not even easy to get a reasonable fit to a zero limit of @xmath30 ( but the very large statistical error allows for it ) . in the inset of the upper part of the plot",
    "we show @xmath73 for one single sample . in the bottom plot",
    "we show how @xmath30 depends on @xmath0 on our largest lattice size , @xmath42 .",
    "nothing dramatic happens when increasing @xmath0 : again , only some qualitative low key effect is taking place .",
    "now we start with analysis of the results of our cluster reconstruction .",
    "we have used our data ( spin configurations for a given lattice size and temperature , together with their mutual distances obtained from their mutual overlap ) to produce a hierarchical tree , and we want to test if this tree is connected to intrinsic properties of our data ( as we have already clarified an ultrametric tree can always be superimposed even to random data ) .",
    "we will adapt standard techniques @xcite to judge about the validity of the structure we have found and about the statement that data are organized according to an ultrametric structure .",
    "the general procedure testing has a simple structure : given a starting proximity matrix @xmath54 , we end our clustering procedure with a particular ordering of elements of @xmath54 , i.e. with a particular permutation of @xmath74 data .",
    "this is what our clustering scheme achieves ( transforming the left part of figure [ f - matrix - a ] in the right bottom matrix ) .",
    "now we have the problem of deciding if what we did was sensible : we can rephrase this question by saying that we have to choose between the _ randomness hypothesis _",
    "( @xmath75 : all permutations of labels of @xmath14 are equally likely ) and the _ alternative hypothesis _",
    "( @xmath76 : the data have some structure that has been at least partially reconstructed by the clustering ) .",
    "in order to check that we :    1 .   define a variable @xmath0 that we expect to be `` small '' under the null hypothesis @xmath75 ; 2 .",
    "assign a _ confidence level _",
    "@xmath11 for @xmath76 and define a threshold @xmath77 by solving the equation @xmath78 3 .",
    "measure from the data the value of @xmath0 , that we call @xmath79 . if 1 .",
    "@xmath80 @xmath81 reject @xmath82 at level @xmath11 ; 2 .",
    "@xmath83 @xmath81 accept @xmath75 at level @xmath11 .",
    "@xmath11 is a confidence level , i.e. it is connected to the probability that by accepting @xmath76 as true we are not making a mistake .    the first tool that we introduce is based on _ hubert s @xmath84 statistics",
    "@xcite , and it is useful to validate clustering .",
    "this is done by checking the correlation of the data with a structure we define _ a priori_.    we consider our measured distance matrix @xmath25 , and we introduce the matrix @xmath85 by @xmath86 we will study the correlations among @xmath25 and @xmath85 .",
    "clearly we have also to specify the definition of _ being in the same cluster_. this introduces a parameter that allow to decide how deeply we want to test the clusterization features of the data .",
    "we will introduce a threshold , that defines the refinement level that we want to use to check our description .",
    "we then have to define the a priori structure that we will compare to the data .",
    "let us call @xmath87 the maximum distance ( on the hierarchical tree ) among two configurations of our set : we say that _ two configurations belong to the same cluster if their distance is smaller than a certain fraction of @xmath87 , say than @xmath88_. we show in the right part of figure [ f - hubert ] how the number of clusters @xmath89 depends on @xmath90 . at very low @xmath0",
    "we find a linear dependence of @xmath89 over @xmath90 , while at values of the order of @xmath91 @xmath89 grows faster than linearly . in figure [ f - hubert ] we also show , for one sample of the quenched disorder , the true distance matrix @xmath92 and four different matrices @xmath93 obtained with an increasing value of @xmath90 ( from the upper left corner going rightward and then to the lower line and rightward again ) , @xmath94 @xmath95 , @xmath43 , @xmath96 and @xmath97 .",
    "the difference among the structures that we are testing in the different cases is obvious",
    ". the careful reader will be able to recognize by eye that the three valley structure implied by the threshold level @xmath98 can indeed be found in the raw distance data of the leftmost matrix .",
    "the main ingredient needed for analyzing the hubert s @xmath84 statistics is the correlation function @xmath99 where ( for @xmath100 , @xmath101 ) @xmath102 let us say that when looking at the output of the clustering we observe a value of @xmath84 equal to @xmath103 .",
    "in order to estimate if this value hints for the hierarchical structure being intrinsic to the data we have used a number of tests . the first test amounts to little more than checking if our procedures are correct : we take as @xmath75 the randomness hypothesis , i.e. we compare our ordered distance matrix to a matrix where the configurations are at random .",
    "we would find that the configuration is not atypical only if our programming was wrong .",
    "we compute an histogram @xmath104 , i.e. the distribution of @xmath84 under the null hypothesis of randomness , by evaluating @xmath105 where the @xmath106 are random permutations of the @xmath14 configuration .",
    "a cluster is not consistent with the hypothesis @xmath75 ( in this case the hypothesis that configurations have not been ordered ) if it is `` unusual '' . in order to quantify this statement",
    ", we introduce an indicator @xmath107 defined as @xmath108 where the value of @xmath84 that we have observed in our sample and where the averages are taken with respect to the conditioned probability distribution @xmath104 .",
    "as expected we always find a very high value of @xmath107 for all reasonable values of the threshold @xmath90 ( i.e. , say , values of @xmath90 that produce from two to order hundred valleys ) : @xmath107 is of order @xmath109 and that it is only weakly dependent on the temperature ( even at @xmath110 this test tells that , yes , we had ordered the configurations , rejecting in this way @xmath75 in a very clear cut way , since we are dealing with a large matrix ) .",
    "as expected this procedure gives positive results both on the original set of configurations and after applying the reversing procedure described in section [ ss - reverse ] .",
    "the rest of the ( more crucial ) testing of the hubert s @xmath84 statistics has been done on the set of reversed configurations , where the @xmath2 symmetry has been eliminated ( see section [ ss - reverse ] ) .",
    "we will discuss it later on , after introducing same other important objects and methods .",
    "the second tool we use to establish whether the particular hierarchical structure we find is the correct one is based on the evaluation of the so called _ cophenetic correlation coefficient _ @xmath111 .",
    "it is defined as @xmath112 where the cophenetic distance @xmath113 is measured on the dendogram ( and because of that it is ultrametric by definition ) .",
    "for example , in the case of ward clustering , it is the quantity defined in ( [ e - ward ] ) . a high level of correlation of true distance and cophenetic distance implies that the data have an intrinsic ultrametric organization . on the contrary",
    "a low level of correlation suggests that a true ultrametric structure can not be detected .",
    "@xmath111 is a natural measure of the ultrametricity build in our data set .",
    "if we try to analyze our original configuration set without removing the @xmath2 symmetry ( each configuration @xmath114 has a corresponding configuration @xmath115 which appears with the same probability ) we measure a high value of @xmath111 , always higher than @xmath116 . interpreting this result as a confirm of the detection of an ultrametric structure would be wrong : the @xmath2 implies a very primitive form of hierarchical organization ( states are grouped in two well separated sectors of the phase space ) and on finite , medium size volumes , this is what we are measuring .",
    "one way to clarify this issue is to look at figure [ cfr ] , where we plot , for a given sample of the quenched disorder , at @xmath42 and low temperature @xmath117 , both the true distance @xmath118 and the cophenetic distance @xmath119 as a function of @xmath120 for various values of @xmath121 .",
    "it is clear that the @xmath2 symmetry makes the two distances similar in a trivial way , by designing the same step : this is the reason that makes @xmath122 .",
    "the real physical differences are in the wavy behavior of the true distance : it is its difference from the constant behavior of the cophenetic distance that has to be analyzed .",
    "this is what we will do in the next section .",
    "we will now apply a spin reversal procedure that allows us to obtain a set of configurations that have , in the infinite volume limit , a positive definite mutual overlap .",
    "this is a very useful procedure @xcite that makes our set of configurations equivalent to a set of configurations obtained in an infinitesimal magnetic field ( without the drawback of having to keep under control the smallness of the field ) . only after doing that we will come back to the evaluation of the cophenetic coefficient @xmath111 .      in the infinite volume limit",
    "the question of identifying in our set of configurations two subsets , @xmath123 and @xmath124 is well posed . after doing that we can flip all signs of the configurations in @xmath124 , obtaining in this way a set of configurations with a positive definite overlap .",
    "we use here the approach introduced in @xcite .",
    "we take one configuration as starting point , @xmath125 .",
    "we consider now a new configuration , and if its overlap with @xmath125 is negative we flip it . for a third configuration",
    "we consider the average overlap with the first two , and we flip it if this is negative .",
    "we do that for all configurations .",
    "this procedure works quite well , and it can be improved in a number of ways ( for example we can repeat it by starting from the new set and considering a different reference configuration and a different order ) .    in figure [ pdq ]",
    "we show the @xmath48 for several samples , before and after the reversing procedure .",
    "it is clear that the procedure works quite well .",
    "the main problems are for samples where different valleys are quite similar ( we are on finite lattices and there are intrinsic ambiguities that disappear in the thermodynamic limit ) .",
    "a good example of a troublesome samples is the second sample from the top on the right , where the reconstructed @xmath48 has , even after our reversal procedure , a long tail at negative @xmath126 values .",
    "we have verified ( see also @xcite ) that when increasing the volume size these spurious effects become smaller .",
    "we have also found that a second effective approach to the separation of the phase space is based on using the same clusterization procedure we will eventually use for analyzing the hierarchical structure .",
    "we first use clusterization ( based for example on the ward algorithm ) to identify the two @xmath2 subsets .",
    "we then flip all spins of all configurations of one of the two , and repeat the clusterization to find a new ( hopefully faithful ) hierarchical structure .",
    "this second approach gives results that are very similar to the ones of the first approach @xcite that we have discussed before : for example the resulting @xmath48 are basically indistinguishable .    in the following",
    "we will use spin configurations _",
    "`` reversed '' _ using this technique .",
    "in figure [ a16 ] we show the proximity matrix for two @xmath42 samples ( at @xmath127 and at @xmath128 ) ordered according to the output of the clustering procedure ( i.e. as from the dendogram ) and the corresponding cophenetic matrix implied by the same dendogram .",
    "when the hierarchical , ultrametric structure is intrinsic to the data set the matrices in the bottom line of figure [ a16 ] become equal to the ones in the central line .",
    "now that the accidental @xmath2 symmetry has been removed we are able to look at the real , relevant physical effects . we have investigated the issue in a systematic way .",
    "we average over @xmath45 different quenched realizations of the disorder , and analyze the system for different lattice volumes as a function of the temperature .    in figures",
    "[ corr].a , [ corr].b and [ corr].c we plot @xmath129 as a function of @xmath130 for @xmath131 , @xmath132 and @xmath42 .",
    "the upper sets of points with smaller errors are from the analysis done _ before _ the spin reversal ( @xmath133 ) , the lower sets of points with larger error are from the analysis of the spin reversed configurations ( @xmath134 ) .",
    "we have already discussed the fake detection of ultrametricity induced by the @xmath2 symmetry .",
    "we discuss now the data obtained after removing the symmetry . in no cases",
    "a clear evidence for the existence of a true ultrametric structure emerges .",
    "@xmath111 is always small , and for @xmath135 it does not even increase clearly with @xmath17 ( finite size effects are very large and uncontrolled ) .",
    "it is interesting that in the set of @xmath133 data the phase transition is detected quite clearly ( but , as we have explained , what we observed is no connected to a hierarchical structure , but only to the usual breaking of the @xmath2 symmetry ) . at high @xmath0 values , for @xmath136 the @xmath133 and the @xmath134 sets of data coincide : here there is one single state .",
    "this analysis shows clearly that on medium size lattices it is impossible to detect more than hints toward a hierarchical structure : in our mean field model we know that ultrametricity will eventually emerge , but very large lattices are needed for that .    in figure [ corr].d we try a further test to improve the level of our quantitative understanding .",
    "we could phrase our goal by saying that we are trying to understand how many valleys we can be sure are present in the phase space ( we repeat that since we are studying the mean field sherrington - kirkpatrick theory in the parisi broken phase we know that asymptotically an infinite number of such valleys will emerge ) .",
    "we go back to @xmath84 defined in equation [ e - gamma ] . at different @xmath0 values",
    "we change the threshold value @xmath90 and monitor the number of valleys we are building for a given @xmath90 value ( this depends on @xmath0 : we have discussed this procedure when commenting figure [ f - hubert ] ) .",
    "we measure @xmath137 and we plot it versus the average number of valleys per sample ( all data are for reversed configurations , except for one set of non - reversed data at @xmath138 that we plot for sake of comparison ) .",
    "we use the high @xmath0 ( @xmath139 ) curve as a reference curve , and we consider it as the randomness threshold : if at a given temperature @xmath0 the value of @xmath137 is very different than the high @xmath0 value we consider that as evidence for existence of this number of valleys .    using the hight @xmath0 limit as the reference line looks to us as a sensible choice ( we have already discussing that using unordered matrix lines is basically just a check of the correctness of our procedure ) .",
    "if , for example , we select a value of the @xmath52 variable ( number of clusters divided by @xmath14 ) @xmath140 , that in the case of @xmath42 assumes the presence of two valleys ( _ after _ removal of the @xmath2 symmetry ) we see that at low @xmath0 the data are quite different from the high @xmath0 ones , suggesting that we are probably already detecting this ( quite low ) level of organization .",
    "when we try a threshold implying a larger number of valleys ( already for example for three of four valleys on our larger lattice , @xmath42 ) the data are not far from the high @xmath0 ones , implying a failure in supporting the hypothesis .    we will discuss figure [ corr].e in the next section .      as we have discussed in some detail in section [ s - cluster ] the cluster reconstruction algorithm",
    "is defined by selecting the rule used to join two elements at different levels of the partitioning , an to update the distance matrix after each step of refining the partitioning level .    in our analysis",
    "we have used the ward scheme @xcite ( that updates the distances as in equation [ e - ward ] ) : this is believed to be an optimal choice when there is no information _ a priori _ on the data @xcite .",
    "basic clustering algorithms are the _ single link _ scheme and the _ complete link _ one .",
    "we will not enter here in many details ( see @xcite for further information ) , but let us say that in the single link scheme one just demands a weak connectivity to merge two subsets , and joins them to form a new cluster as early as possible , while in the complete link scheme the opposite happens , and subsets are joined to form a new cluster `` as late as possible '' .",
    "both methods have advantages and drawbacks .",
    "the crucial observation that we will use now is that when a real hierarchical structure is present all these methods end up to give the same result , and to reconstruct the same classification .    in these two algorithms",
    "we have that , if as before @xmath29 and @xmath30 merge to form the new cluster @xmath31 for all other clusters @xmath33 : @xmath141 the reason for the names is in the graph theory interpretation of the algorithms @xcite .",
    "as we have already said it is not difficult to show that if the true distance matrix is actually ultrametric the optimal permutation with respect to these two algorithms is be exactly the same .    in this framework",
    "we have introduced a last test of the structure of our data : we check how different are the output of the two algorithms to try to understand if we can detect further hints for an emerging ultrametric structure .",
    "we have analyzed 20 samples at several temperatures values , and we show in figure [ corr].e the average correlation between the two output distance matrices , that is @xmath142 the correlation is very high at low @xmath0 , and decreases toward the high @xmath0 value around @xmath143 . again , on medium large lattice sizes we can detect hints toward an emerging ultrametric structure but we can not in any way get a clear cut answer .",
    "an interesting question ( discussed in details in @xcite ) concerns a possible clustering of the _ spins _ of our system .",
    "the issue is clearly very relevant in the finite dimensional systems studied in @xcite where spatial structures can be very relevant . here , in mean field ,",
    "there is no notion of distance , but still spins can be aggregated in different groups that have different degrees of correlation .",
    "we will look for the possible presence of some kind of structure ( in this case not hierarchical since there is no reason for this ) now in the space of the elementary spins instead than in configuration space . in the analysis of configurations we were considering the @xmath144 data matrix @xmath145 as representing @xmath14 configurations , where each data point was an @xmath17-dimensional vector .",
    "now we change our point of view ; we regard each of the @xmath17 spins as a data point , that is as a vector in a @xmath14-dimensional space .",
    "since we expect highly correlated spins to be in the same cluster , following @xcite we define the distance between spin @xmath146 and spin @xmath120 as @xmath147 where @xmath148 is the spin correlation matrix that we can evaluate using our spin configurations generated in a monte carlo run .",
    "it is interesting to follow the evolution in temperature of the ordered spin matrix for a given sample : we show it in figure [ spin ] . at intermediate temperature values",
    "a large group of spin is clearly very correlated : here @xmath149 spins are grouped together .",
    "this structure disappears at high @xmath0 values .",
    "it is remarkable how this picture is similar to figure 11.d of the second paper of reference @xcite .",
    "this is a severe warning against misleading interpretations of the data analysis : here we are in mean field , and there are no spatial local domains .",
    "the configuration space of a @xmath17-spin system is a @xmath150-dimensional space and it is very difficult to represent it in order to catch the main physical features  .",
    "we have shown that cluster analysis allows not only to visualize in a physically meaningful way the structure of the configuration space , but also allows for quantitative testing of a priori hypothesis about the structure of the data set .",
    "we have discussed the role of the @xmath2 symmetry of the system , and how its removal is necessary to study the relevant physical phenomena .",
    "our main issue is that quantitative testing is mandatory to make of clustering techniques an useful tool .",
    "we have introduced some of these techniques by designing tests such to be useful in our context of a ( disordered ) statistical mechanics context .    as a crucial benchmark",
    "we have analyzed the mean field theory in the low @xmath0 replica broken phase , where we know that eventually , in the infinite volume limit , a hierarchical structure of states emerges .",
    "we are able to observe many hints toward the emerging of such structure , but on the lattice sizes where we are able to work these indications can not be considered as unambiguous .",
    "detecting ultrametricity is very difficult , and demands very large lattice sizes : this turns out to be true in mean field , and we expect it to be probably true also in finite dimensional models , where the existence itself of mean field like states is all to be checked .",
    "we believe that the findings and the techniques that we have reported here will be important to use in the finite dimensional context . as many other features ( we have in mind for example temperature chaos @xcite , that is very difficult to detect numerically and emerges only at very high orders in perturbation theory ) ultrametricity emerges , already in mean field , only on very large lattices .",
    "we also believe it is important that in this `` quantitative '' approach to clustering we have been able to introduce a natural way to consider not only sample dependent but also disorder average quantities .    a next step is to apply , by continuing the work of @xcite , these techniques to finite dimensional disordered systems ( defined on very large lattices ! ) on the one side and to glassy systems on the other side :",
    "since here a crucial goal is to try to understand the details of the spatial , time dependent organization of the system , techniques like the ones introduced here could turn out to be very useful .",
    "we acknowledge the precious contribution of loredana correale to a first phase of this work .",
    "we thank eytan domany and peter young for many useful conversations that have motivated us toward this problem .",
    "m. mzard , g. parisi and m. a. virasoro , _ spin glass theory and beyond _ ( world scientific , singapore 1987 ) ; k. binder and a. p. young , rev .",
    "phys . * 58 * , 801 ( 1986 ) ; k. h. fischer and j. a. hertz , _ spin glasses _ ( cambridge university press , cambridge , uk 1993 ) ; _ spin glasses and random fields _ , edited by a. p.",
    "young ( world scientific , singapore 1998 ) ."
  ],
  "abstract_text": [
    "<S> we discuss the problem of ultrametricity in mean field spin glasses by means of a hierarchical clustering algorithm . </S>",
    "<S> we complement the clustering approach with quantitative testing : we discuss both in some detail . </S>",
    "<S> we show that the elimination of the ( in this context accidental ) spin flip symmetry plays a crucial role in the analysis , since the symmetry hides the real nature of the data . </S>",
    "<S> we are able to use in the analysis disorder averaged quantities . </S>",
    "<S> we are able to exhibit a number of features of the low @xmath0 phase of the mean field theory , and to claim that the full hierarchical structure can be observed without ambiguities only on very large lattice volumes , not currently accessible by numerical simulations . </S>"
  ]
}