{
  "article_text": [
    "in the field of algebraic number theory , an integral two - sided ideal is well known , and has been thoroughly studied over the past two centuries . in _ maximal quadratic orders _",
    "@xmath2 of _ number fields _ , @xmath3 , where @xmath4 is a non - zero squarefree integer , there are many things known about ideals .",
    "namely , we know that equivalence classes of ideals in @xmath2 form a group , known as the _ ideal class group_. if we consider this group , we know how to manipulate its elements .",
    "but there are still many more things that we do nt know about ideals . for example , even though we know that the size of the ideal class group is finite , we do not have any effective algorithm for its computation .",
    "there are also various heuristics known , such as the cohen - lenstra heuristics @xcite , which give certain predictions regarding the structure of an odd part of the ideal class group .",
    "however , we still do nt have an efficient algorithm to compute its structure .    in this paper , we suggest studying an ideal class group from a different perspective . when @xmath5 , instead of @xmath3 , we consider it in the _ ring of integral quaternions _",
    "the reason is that @xmath6 has many beautiful properties that @xmath3 may not have .",
    "for example , @xmath6 is a _ principal ideal domain _ , which means that each ideal of @xmath6 can be represented by a single generator .",
    "because of this fundamental property , even though @xmath7 , a quadratic order of @xmath6 , isomorphic to @xmath2 , is not a principal ideal domain , we can still represent each ideal in @xmath7 with a unique ( up to a multiplication by a unit ) integral quaternion , which we call a _",
    "pseudo generator_. knowing this , we asked the following question : is it possible to take advantage of this fact , and come up with algorithms , that manipulate ideals using only their pseudo generators",
    "? eventually it was discovered that it is possible , and we introduce these algorithms in the section [ sec : algorithms ] .",
    "another interesting property of the ring of integral quaternions is that , unlike @xmath2 in @xmath3 , there are many quadratic orders in @xmath6 , which are isomorphic to @xmath2 . the total number of quadratic orders of a fixed discriminant @xmath8 is related to the number of representations of an integer @xmath9 as a sum of three squares . in the first half of the 20th century , mathematicians hurwitz and venkov explored the connections , that arise between various quadratic orders in @xmath6 . in continuation of this thread , in the section [ sec : fermat ] we demonstrate how a pair of quadratic orders can generate a non - trivial factor of @xmath4 . in the same section ,",
    "we demonstrate that the fermat number factoring technique is a special case of the theory , introduced in this paper .",
    "in addition to the two sections mentioned above , the paper is structured as follows : section 2 describes the previous work in the field .",
    "section 3 gives background information on the theory of integral quaternions and quadratic orders in @xmath6 , which was developed by hurwitz and venkov .",
    "section 6 describes three identities that ideals must satisfy .",
    "section 7 presents some computational data regarding the number of ambiguous classes within an ideal class group , which were generated by the equation @xmath1 .",
    "section 8 introduces a novel approach to the problem of finding a divisor of a class number .",
    "finally , section 9 concludes the paper .",
    "the theory of integral quaternions was first introduced by hurwitz @xcite . after hurwitz , it was the soviet mathematician boris venkov , who expanded the theory by studying ideals in @xmath6 @xcite .",
    "the monographs of voight @xcite and vignras @xcite give a thorough explanation on how ideals arise in the context of quaternion algebras .    in terms of algorithms , there is a ` sage ` code written by d. r. kohel in 2005 @xcite , and maintained by j. bobber and w. stein @xcite , which has a broad functionality on quaternion algebras , including the operations on ideals .",
    "however , this code utilizes a different and more generalized approach to ideal manipulation . in this paper , we restrict our attention to the hamilton algebra , and we tend to operate ideals using _ only _ their pseudo generators , without ever mentioning a @xmath0-basis . among our algorithms",
    ", we also describe an algorithm on _ ideal reduction _ , which , to our best knowledge , is not present in any literature available .    as for other algorithms",
    ", we would like to mention a paper by kirschmer and voight @xcite .",
    "though not related to our research , it demonstrates another application of ideals in quaternion algebras ( namely algebras defined over number fields ) .",
    "this paper describes algorithms , which count and enumerate representatives of the ideal classes of an eichler order in a quaternion algebra defined over a number field .",
    "in this paper , we assume that our reader is familiar with some fundamental notions of algebraic number theory , such as an _ imaginary number field _ @xmath10 ( for @xmath11 positive and squarefree ) , a _ maximal quadratic order _ @xmath2 , and a _ ( two - sided ) @xmath2-ideal_.",
    "we encourage our reader to refer to the monographs ( * ? ? ?",
    "4 ) and ( * ? ? ?",
    "1.6 ) for more details .    in this section , we shall primarily focus on the hurwitz theory and the connection that exists between quadratic orders in number fields and quadratic orders in the ring of integral quaternions .",
    "consider the hamilton algebra , where the trio of imaginary units @xmath12 , @xmath13 , @xmath14 produces the following multiplication table :    @xmath15    the elements of hamilton algebra are called _ quaternions _ , and have the form @xmath16 , where @xmath17 , @xmath18 , @xmath19 , @xmath20 are real numbers .",
    "we shall use the standard denotations of venkov @xcite    = 1.4pt    @xmath21    to refer to the _ real part _",
    ", _ norm _ , _ conjugate _ and the _ inverse _ of a quaternion .",
    "we shall also write @xmath22 to denote the _ vector part _ of a quaternion @xmath23 .",
    "an _ integral quaternion _ is a quaternion of the form    @xmath24    where @xmath25 , @xmath26 , @xmath27 , @xmath28 are integers that satisfy the congruence @xmath29 ( mod 2 ) .",
    "we shall denote the set of integral quaternions by @xmath6 .",
    "an integral quaternion is _ primitive _ , if there is no positive integer other than 1 , which divides all of its coefficients @xmath25 , @xmath26 , @xmath27 , @xmath28 .",
    "hurwitz demonstrated that @xmath6 is a maximal non - commutative ring with identity @xcite . in this ring , there exist 24 units , namely    @xmath30    furthermore , @xmath6 is a _",
    "euclidean domain _",
    "* , a ) , c ) ) , and therefore for any pair of integral quaternions @xmath23 , @xmath31 there exists a unique ( up to a multiplication by a unit from the left ( or right ) ) integral quaternion , which we shall denote as @xmath32 ( or @xmath33 ) , of the largest norm , which divides both @xmath23 and @xmath31 from the right ( or left ) .    in his letter @xcite",
    ", venkov formulates the connection between quadratic orders in the ring of integral quaternions and quadratic orders of imaginary number fields . following his reasoning",
    ", we first notice that each @xmath34 satisfies the relation    @xmath35    whence any integral quaternion @xmath36 of norm @xmath11 with a zero real part satisfies the equation @xmath37 .",
    "next , recall that quaternion @xmath36 commutes with any other quaternion of the form @xmath38 , where @xmath39 ( * ? ? ?",
    "* , a ) ) .",
    "therefore , the quadratic order @xmath40 $ ] , where    @xmath41    is isomorphic to the maximal quadratic order @xmath2 of @xmath10 @xcite .",
    "it is important to emphasize that this relation between @xmath2 and @xmath7 exists if and only if @xmath11 is not representable in the form @xmath42 for some non - negative integers @xmath14 , @xmath43 , since there are no three squares representations for integers of this form ( * ? ? ? * chap . 4 , 1 ) .",
    "in the remaining parts of this paper , we shall consider only squarefree values of @xmath44 , so @xmath11 must satisfy the congruence @xmath45 ( mod 8) .",
    "after the formation of a quadratic order @xmath7 , which is isomorphic to @xmath2 , it is now possible to study various ideals that belong to @xmath7 are _ two - sided _ , since all elements of the quadratic order commute to each other ( * ? ? ? * , a ) ) . ] .",
    "a natural question arises : if @xmath2 and @xmath7 are isomorphic , why do we need to study @xmath7 ?",
    "after all , it is much easier to manipulate algebraic integers than quaternions .",
    "there are two main reasonings that led to the study of quadratic orders and ideals in @xmath6 :    a.   the ring @xmath6 is a euclidean domain , and therefore it is a _ principal ideal domain _",
    "* , b ) ) . as we are about to demonstrate , this property allows us to represent an ideal with a single right ( left ) _ pseudo generator _",
    "( to be defined ) , which is an integral quaternion , and is unique up to a multiplication by a unit from the left ( right ) ; b.   a maximal quadratic order @xmath2 in @xmath10 is unique , which is not true for @xmath6 . unless @xmath46 ( mod 8) , there exist several solutions to the equation @xmath37 , hence several quadratic orders , isomorphic to @xmath2 .",
    "there exist a number of interesting relations between various quadratic orders , which were studied by venkov ( e.g. in @xcite ) , and which we will demonstrate in this paper .",
    "there are other interesting properties of ideals and quadratic orders , which arise in @xmath6 @xcite .",
    "consider a primitive ideal @xmath47 of some fixed quadratic order @xmath7 , and let the @xmath0-basis of @xmath47 be equal to @xmath48 $ ] for some integers @xmath25 , @xmath26 . in this case , the norm of @xmath47 is equal to @xmath49 ( * ? ? ?",
    "* def . 4.33 , prop . 4.23 ) .",
    "since @xmath6 is a euclidean domain , there exist integral quaternions @xmath50 , and @xmath51 .",
    "because @xmath47 is primitive , @xmath52 and @xmath53 must be primitive as well .",
    "following the proof of venkov @xcite , we can demonstrate that @xmath54 .",
    "since @xmath25 is divisible by @xmath52 from the right and @xmath52 is primitive , we have @xmath55 for some positive integer @xmath56 . we also have @xmath57 for some integral quaternion @xmath58 , and because @xmath52 is the greatest common divisor , quaternions @xmath58 and @xmath59 have no common divisors from the right .",
    "since @xmath60 is divisible by @xmath61 , @xmath62 is divisible by @xmath56 ( * ? ? ?",
    "* thm . 4.24 ) , and therefore @xmath63 , @xmath64 .",
    "analogously , we can show that @xmath65 .",
    "now , let us demonstrate that @xmath52 unambiguously determines an ideal @xmath47 of @xmath7 .",
    "define a set @xmath66 as follows :    @xmath67    we call @xmath52 a _ pseudo generator _ of @xmath66 , and use the letter @xmath68 to indicate that every element of this set is divisible by @xmath52 from the right . from the definition of @xmath66",
    ", it follows that    @xmath69    where @xmath70 is a left ideal , generated by @xmath52 .",
    "now , let us demonstrate that @xmath71 .",
    "first of all , notice that all the elements of @xmath72 $ ] are divisible by @xmath52 from the right , so @xmath73 . to show that the converse statement holds , once again , we follow the proof of venkov @xcite .",
    "pick @xmath74 . since @xmath75 , we have @xmath76 for some integers @xmath77 and @xmath78 .",
    "since @xmath79 is divisible by @xmath52 from the right , we can put @xmath80 for some positive integer @xmath27 , which means that    @xmath81    we conclude that @xmath71 .",
    "analogously , we can define    @xmath82    and demonstrate that @xmath83 . in the remaining parts of this paper , we call @xmath52 and @xmath53 the _ right _ and _ left pseudo generators _ of @xmath84 , respectively . for obvious reasons ,",
    "if @xmath47 is non - primitive , i.e. representable in the form @xmath85 $ ] for some integer @xmath86 , then both @xmath52 and @xmath53 will be non - primitive integral quaternions , and their greatest integral divisor will be exactly @xmath27 .",
    "the proof above allows us to make the following observation : even though an ideal @xmath47 in @xmath7 may have multiple generators , it still has a unique right ( left ) pseudo generator .",
    "note that the right ( left ) pseudo generator is unique up to a multiplication by a unit of @xmath6 from the left ( right ) , because @xmath87 for any unit @xmath88 ( analogous statement holds for @xmath89 ) .",
    "hereinafter , all our results will be demonstrated for right pseudo generators , but by analogy we can demonstrate that they hold for left pseudo generators as well .",
    "we now move our attention to the next important topic .",
    "let @xmath90 $ ] be an arbitrary ideal in @xmath7 .",
    "since @xmath71 for some integral quaternion @xmath52 , there exist a pair of integral quaternions @xmath91 and @xmath92 s.t .",
    "@xmath93    since @xmath94 , we conclude that @xmath91 , @xmath92 do not have a common divisor from the right , and therefore @xmath95 . on the other hand , since @xmath96 both belong to @xmath7 , they commute with @xmath36 , whence the greatest common divisor of @xmath97 and @xmath98 is divisible by @xmath52 from the right .",
    "this allows us to conclude , that there exists an integral quaternion @xmath99 , which satisfies the relation    @xmath100    if we multiply the previous equation by @xmath36 from the right , it is not hard to notice that @xmath101 , so @xmath99 forms another quadratic order @xmath102 in @xmath6 . a similar reasoning can be applied towards the left pseudo generator of an ideal .",
    "thus , if @xmath84 belongs to the quadratic order @xmath7 , then the relations    @xmath103    generate the _",
    "right _ and _ left orders _ @xmath102 and @xmath104 , respectively . the relation ( [ eq : rhomu ] ) describes a very important property of a pseudo generator @xmath52 : while @xmath48 = { \\langle\\rho\\rangle_r}$ ] belongs to the quadratic order @xmath7 , @xmath105 = { \\langle\\rho\\rangle_l}$ ] belongs to the quadratic order @xmath102 , where @xmath106 .",
    "let us now answer the following question : if we know the pseudo generators of an ideal @xmath107 in @xmath7 , then how do pseudo generators of @xmath108 ( the conjugate of @xmath47 ) look like ?",
    "let @xmath107 belong to the quadratic order @xmath7 .",
    "then @xmath109 .",
    "let @xmath110 $ ] .",
    "then the right and left pseudo generators of an ideal can be found from the following relations :    @xmath111    let @xmath57 for some integral quaternion @xmath58 .",
    "then @xmath112 .",
    "since @xmath113 , the left generator of @xmath114 $ ] is equal to    @xmath115    analogously , we can find the right pseudo generator @xmath116 of @xmath108 by noticing that @xmath117 .    as a special case of this proposition , we notice that an _ amgiuous _ ideal @xmath71 , i.e. the ideal with a property @xmath118 , has @xmath119 as its left pseudo generator .",
    "we also emphasize another important property of ambiguous ideals in the following theorem .",
    "[ thm : ambiguous ] if @xmath71 is ambiguous in the quadratic order @xmath7 , then @xmath52 divides @xmath120 from the right , where @xmath31 is defined as in relation ( [ eq : omega ] ) .",
    "since @xmath118 , an ideal @xmath72 $ ] contains both @xmath121 and @xmath122 .",
    "let @xmath57 , @xmath123 for some @xmath124 .",
    "then    @xmath125    hence , @xmath126 , i.e. the quaternion @xmath127 is integral , which means that @xmath52 divides @xmath120 from the right .",
    "we are aware that in a maximal quadratic order @xmath2 of @xmath10 , if @xmath47 is ambiguous , then @xmath128 divides @xmath129 ( * ? ? ?",
    "the theorem above demonstrates that an analogous statement holds for @xmath7 as well , where @xmath130 .",
    "moreover , we can notice that our theorem implies this result , for if @xmath52 divides @xmath120 from the right , then @xmath131 divides @xmath132 .",
    "so far , we have seen many interesting properties that ideals and their pseudo generators have .",
    "now that we know how ideals get represented in the ring of integral quaternions , it would be interesting to study how to operate them .",
    "a common approach to manipulate ideals is to use their @xmath0-basis representation @xmath133 $ ] , where integers @xmath25 , @xmath26 satisfy inequalities @xmath134 and @xmath135 , and @xmath27 divides both @xmath25 and @xmath26 .",
    "this approach is used in ideal reduction ( * ? ? ?",
    "5.1 ) and multiplication ( * ? ? ?",
    "5.4 ) algorithms . in the next section",
    ", we introduce a number of algorithms , which allow us to manipulate ideals in the ring of integral quaternions using solely their pseudo generators . while developing these algorithms , our primary goal was to avoid _ any _ mentioning of the @xmath0-basis . as a result , besides the reduction and multiplication algorithms , we introduce two additional ones : an algorithm to restore the @xmath0-basis of an ideal by its pseudo generator , and an algorithm to compute the right pseudo generator of an ideal using its left pseudo generator .",
    "we begin our explorations with the series of definitions , where we consider two integral quaternions @xmath23 and @xmath31 of the form    @xmath136    a _ scalar product _ of quaternions @xmath23 and @xmath31 is the value @xmath137 ;    a _ full scalar product _ of quaternions @xmath23 and @xmath31 is the value @xmath138 .",
    "a _ vector product _ of quaternions @xmath23 and @xmath31 is the value @xmath139 = ( y_0z_1 - y_1z_0)i + ( x_1z_0 -x_0z_1)j + ( x_0y_1 - x_1y_0)k$ ] .",
    "it is not hard to verify that , in case if @xmath140 , @xmath23 and @xmath31 satisfy the relation    @xmath141.\\ ] ]    finally , we shall introduce one more interesting relation , which holds for any integral quaternions @xmath23 and",
    "@xmath31 :    @xmath142    this equality can be easily demonstrated using the properties of quaternion arithmetic . both of the relations above will be used in the proofs that will be introduced in the following subsections .",
    "the following algorithms allow us to manipulate ideals in the ring of integral quaternions .",
    "note that , in order to migrate from an imaginary number field @xmath10 to the ring of integral quaternions , we need to generate one initial representation of an integer @xmath11 as a sum of three squares , i.e. @xmath143 .",
    "fortunately , there exists a fast algorithm , which computes integers @xmath18 , @xmath19 , @xmath20 with high probability in random polynomial time @xcite .",
    "consider the following problem : given a primitive ideal @xmath66 and the quadratic order @xmath7 which it belongs to , find the @xmath0-basis of @xmath66 . in other words , we need to find integers @xmath144 s.t .",
    "@xmath48 = { \\langle\\rho\\rangle_r}$ ] .    in the section [ sec : background ]",
    ", we have demonstrated that @xmath145 .",
    "now it is left only to find @xmath26 .",
    "one possible way to solve this problem is to find the square root of @xmath146 mod @xmath147 , where @xmath31 is defined as in ( [ eq : omega ] ) , for if @xmath48 $ ] is a valid ideal , then @xmath26 has to satisfy the congruence    @xmath148    there exists an effective algorithm ( * ? ? ?",
    "2.3.8 ) with the worst case complexity @xmath149 , which computes a square root mod @xmath25 if @xmath25 is an odd prime .",
    "however , we would like to solve this problem for _ all _ the possible values of @xmath25 .    before we introduce another algorithm , which solves the problem for any @xmath25 ,",
    "let us first prove a couple of important propositions , which shall be quite useful in our future explorations .    [ prop : equal_scalar_products_rho ] if real parts of quaternions @xmath36 and @xmath99 are equal , then the equality @xmath150 implies @xmath151 .",
    "let us write @xmath152 as the sum of their real and vector parts :    @xmath153    @xmath154    since @xmath155 ,    @xmath156    if we now apply the relation ( [ eq : product ] ) , we shall get    @xmath157 + \\re(\\rho)\\vec\\mu = -(\\mu',\\rho ) + [ \\mu',\\rho ] + \\re(\\rho)\\vec{\\mu'}.\\ ] ]    by taking the real part on both sides of the equality above , we obtain the desirable result : @xmath151 .",
    "[ prop : main_prop ] if a primitive ideal @xmath48 = { \\langle\\rho\\rangle_r}$ ] belongs to the quadratic order @xmath7 , then    @xmath158    where @xmath58 is an integral quaternion , which satisfies the relation @xmath57 , and an integer @xmath31 is defined as in ( [ eq : omega ] ) .",
    "since @xmath121 belongs to @xmath66 , there exists an integral quaternion @xmath58 s.t .",
    "@xmath57 . because @xmath66 belongs to @xmath7 , the relation ( [ eq : rhomu ] )",
    "must hold for some @xmath99 of the same norm as @xmath36 .",
    "if we now multiply @xmath57 by @xmath52 from the left and from the right , we shall get @xmath159 , where @xmath106 .",
    "therefore , @xmath160 , and from the relation ( [ eq : qrrq ] ) we obtain the following system of equations :    @xmath161    from the proposition [ prop : equal_scalar_products_rho ] it follows that @xmath162 , and therefore @xmath163 .",
    "if we now combine this statement with the second equality of the system ( [ eq : system ] ) , we shall obtain    @xmath164    @xmath165    from the first equality of the system ( [ eq : system ] ) , we know that @xmath166 .",
    "now , a simple substitution of @xmath167 in the equation above will give us the relation ( [ eq : main_relation_rho ] ) :    @xmath168    @xmath169    this proposition allows us to formulate the following algorithm , which computes the @xmath0-basis of an ideal @xmath66 in the quadratic order @xmath7 .",
    "[ alg : restore ] _ restoring the @xmath0-basis of an ideal by its pseudo generator . _",
    "* input : * a quadratic order @xmath7 and a primitive ideal @xmath66 , which belongs to this order ;    * output : * integers @xmath25 and @xmath26 s.t .",
    "@xmath170 $ ] .    1 .",
    "find a unit @xmath88 s.t .",
    "@xmath171 is an odd integer .",
    "put @xmath172 ; 2 .",
    "if @xmath173 is even and @xmath174 , @xmath175 have different parity , set @xmath176 .",
    "otherwise set @xmath177 ; 3 .",
    "find @xmath178 ; 4 .   using the extended euclidean algorithm ,",
    "compute the smallest non - negative @xmath26 , s.t .",
    "@xmath179 , and + @xmath180 5 .",
    "return @xmath113 and @xmath26 .",
    "the work of this algorithm is based on the relation ( [ eq : main_relation_rho ] ) . obviously , if @xmath181 , then the summand which contains @xmath26 , vanishes .",
    "this is why we redefine @xmath52 so that its real part would not be equal to zero . in this case , we pick @xmath88 to be equal to either @xmath12 , @xmath13 , or @xmath14 , depending on which coefficient of @xmath52 is odd .",
    "we would also like to avoid the case when @xmath52 has half - integer coefficients .",
    "fortunately , there will always exist exactly _ eight _ units of the form @xmath182 , which will make @xmath183 have integral coefficients .",
    "in particular , if @xmath52 has even ( odd ) number of coefficients congruent to 1 mod 4 , then all units of the type mentioned above , which have an odd ( even ) number of 1 s , will work .    finally , we argue that a pseudo generator @xmath52 with integral coefficients will always have at least one odd coefficient , for if this is not the case , then all coefficients of @xmath52 are even , which makes @xmath52 non - primitive .",
    "now that our @xmath52 has an odd real part , we want to make sure that all the other parts of the relation ( [ eq : main_relation_rho ] ) are not half - integers .",
    "if we multiply this equality by @xmath31 , and keep in mind that @xmath184 , we get    @xmath185    if @xmath186 , then all the numbers above are integers , including @xmath187 . however , if @xmath188 , then we have to check whether @xmath189 is a half - integer",
    ". this can happen only if @xmath173 is even , because the value on the left side can never be a half - integer .",
    "suppose that @xmath173 is even .",
    "let us demonstrate that @xmath190 ( mod 4 ) .",
    "recall that @xmath173 divides @xmath191 , where @xmath44 .",
    "if @xmath11 is odd , then @xmath26 must be odd as well , since 2 divides @xmath192 . because @xmath193 ( mod 4 ) and @xmath194 ( mod 4 ) , we have @xmath195 ( mod 4 ) , so @xmath173 can not be divisible by 4 . on the other hand , if @xmath11 is even , then @xmath196 ( mod 4 ) , because @xmath11 is squarefree .",
    "for the reason that @xmath11 and @xmath26 have to be of the same parity , the congruence @xmath197 ( mod 4 ) holds , and therefore @xmath195 ( mod 4 ) . once again",
    ", this gives us the desirable result .",
    "now we know : if @xmath173 is even and @xmath58 has half - integer coefficients , then the value on the right side of the previous equation has to be odd . therefore , the value on the left side must be odd as well . when @xmath11 ( and therefore @xmath26 ) is odd , this can happen only if @xmath175 is even , because @xmath198 will always be odd .",
    "on the other hand , if @xmath11 ( and therefore @xmath26 ) is even , this happens only when @xmath175 is odd .",
    "summarizing , when @xmath173 is even and @xmath199 is odd , then we can say that @xmath58 has half - integer coefficients if and only if @xmath11 and @xmath175 have different parity .",
    "if we now set @xmath17 as it is described at the step 2 , then the following equation has no half - integers involved , independently of the input to the algorithm :    @xmath200    define @xmath178 . because @xmath28 divides both @xmath199 and @xmath201",
    ", it has to divide @xmath175 as well .",
    "if we now divide both sides of the equation above by @xmath28 , then @xmath202 and @xmath203 have no common divisor greater than @xmath204 , and therefore we can apply the extended euclidean algorithm to find the value of @xmath205 , using the formula introduced in step 4 of the algorithm . finally , when computing @xmath26 , we would also like to make sure that @xmath179 , just in case if @xmath206 .",
    "analogous algorithm exists for the ring of polynomials ( * ? ? ?",
    "ideal ) .",
    "algorithm [ alg : restore ] resides on the euclidean algorithm , so its time complexity ( in the worst case ) is estimated by @xmath207 , where the right pseudo generator @xmath52 is chosen so that @xmath199 is positive and odd .",
    "the next problem of a great interest is the following : given an ideal @xmath208 in the quadratic order @xmath7 , find an integral quaternion @xmath53 s.t . @xmath209 .",
    "consider the @xmath0-basis of an ideal : @xmath210 $ ] . recall that @xmath211 , so the most straightforward way to compute @xmath53 is to restore the @xmath0-basis using the algorithm [ alg : restore ] , and then apply the euclidean algorithm to @xmath25 and @xmath121 .",
    "however , as was mentioned earlier , in this paper we try to avoid the usage of the @xmath0-basis in our computations . in this section",
    ", we present another approach to find @xmath53 , without obtaining @xmath26 in the first place .",
    "recall that for any integers @xmath77 and @xmath78 , a quaternion @xmath212 belongs to the ideal , and therefore has to be divisible by @xmath53 from the right .",
    "since the relation ( [ eq : main_relation_rho ] ) holds for the left pseudo generator as well , if we now set @xmath213 and @xmath214 , we shall obtain    @xmath215    @xmath216    recall that @xmath113 and @xmath58 satisfies the relation @xmath217 . since @xmath184 and @xmath218 , we conclude that    @xmath219    now an application of the euclidean algorithm will help us to derive @xmath53 :    @xmath220    consider another approach to the same problem . since @xmath52 is the left pseudo generator of an ideal which belongs to @xmath7",
    ", then there exists an integral quaternion @xmath99 of the same norm as @xmath36 , s.t .",
    "if we now add @xmath222 on both sides of this equation , and then apply the relation ( [ eq : qrrq ] ) , we shall get the following result :    @xmath223    @xmath224    so , the following formula can also be used to compute @xmath53 :    @xmath225    analogously , we can solve the problem of finding the left pseudo generator of an ideal given its right pseudo generator . in that case ,",
    "the formula ( [ eq : right_by_left_1 ] ) does not change , except for @xmath226 , which gets replaced by @xmath227 . in turn",
    ", the formula ( [ eq : right_by_left_2 ] ) takes the form    @xmath228      let us now turn our attention to the problem of ideal multiplication . consider a quadratic order @xmath7 and two ideals , @xmath66 and @xmath229 , which belong to this quadratic order . the following algorithm multiplies these ideals using solely their pseudo generators .    _ ideal multiplication . _",
    "* input : * a quadratic order @xmath7 , and two primitive ideals , @xmath66 and @xmath229 , which belong to this quadratic order ;    * output : * ( non - reduced ) ideal @xmath230 .",
    "compute @xmath231 ; 2 .",
    "compute @xmath232 ; 3 .",
    "return @xmath233 .",
    "the problem of ideal multiplication was studied by venkov in his letter @xcite .",
    "let @xmath71 and @xmath234 .",
    "venkov demonstrated that if an ideal @xmath235 $ ] ( where @xmath236 can be replaced by @xmath237 , @xmath238 , etc . to move an ideal between various quadratic orders )",
    "has a right pseudo generator @xmath239 in a quadratic order @xmath102 , where @xmath231 , then @xmath240 is a right pseudo generator of an ideal @xmath241 in @xmath7 .",
    "the question is , how do we find @xmath239 ?",
    "@xmath242_{\\rho } \\ar@/_/@{.>}[dr]^{\\rho''\\rho ' } \\ar[r]^{\\rho ' } & \\mu ' \\ar[d]^{\\rho''}\\\\ \\mu ' '' & \\mu '' } \\ ] ]    we can compute @xmath239 using an approach similar to the one described in the previous subsection .",
    "let @xmath170 $ ] . then @xmath105 $ ] , where @xmath243 , belongs to the quadratic order @xmath102 .",
    "for any integers @xmath77 and @xmath78 , the quaternion @xmath244 belongs to this ideal , and therefore has to be divisible by @xmath239 from the right .",
    "since the relation ( [ eq : main_relation_rho ] ) holds for the ideal @xmath48 $ ] in the quadratic order @xmath7 , then we can set @xmath213 and @xmath214 , which will give us    @xmath245    this integral quaternion belongs to @xmath105 $ ] .",
    "now @xmath239 can be obtained using the euclidean algorithm , as it is described in the step 2 .",
    "now that we went over the steps of the algorithm , let us prove that @xmath240 is really a pseudo generator of the product . consider the product of @xmath170 $ ] and @xmath246 $ ] :    @xmath247 \\cdot [ a ' , b ' + \\omega ] = \\left[aa ' , a(b ' + \\omega ) , a'(b + \\omega ) , ( b ' + \\omega)(b + \\omega)\\right].\\ ] ]    let @xmath248 and @xmath249 .",
    "then    @xmath250    @xmath251    @xmath252    @xmath253    since @xmath249 is primitive , quaternions @xmath254 and @xmath255 do not have a common divisor from the right , and therefore @xmath240 is the greatest common divisor of @xmath256 , @xmath257 , @xmath258 and @xmath259 .",
    "since these four quaternions form a @xmath0-basis of a resulting ideal , @xmath240 has to be the right pseudo generator of this ideal .",
    "our proof is similar to the proof for the multiplication of ideals in the ring of adles @xcite .      before we turn our attention to the process of ideal reduction ,",
    "let us first state some important theorems .",
    "[ thm : ideal_generated_by_orders ] let @xmath7 be a quadratic order , @xmath44 .",
    "if a primitive integral quaternion @xmath52 satisfies the relation ( [ eq : rhomu ] ) for some @xmath99 , and @xmath173 is odd when @xmath260 , then it is a right ( left ) pseudo generator of some ideal in the quadratic order @xmath7 ( @xmath102 ) .",
    "conversely , if @xmath66 is an ideal in the quadratic order @xmath7 , then @xmath52 satisfies ( [ eq : rhomu ] ) for some @xmath99 , and @xmath173 is odd when @xmath260 .",
    "moreover , @xmath208 is an ideal in @xmath102 .",
    "let us first argue why it is necessary for @xmath173 to be odd when @xmath261 ( mod 8) .",
    "if we consider a primitive ideal @xmath262 $ ] , then @xmath263 , so @xmath146 has to be a quadratic residue of @xmath264 .",
    "since any odd integer @xmath18 satisfies the congruence @xmath265 ( mod 8) , we have @xmath266 ( mod 8) , and therefore @xmath173 has to be odd . in his letter , venkov proved that for any @xmath52 and @xmath36 , which satisfy the relation ( [ eq : rhomu ] ) for some @xmath99 , @xmath146 has to be a quadratic residue of @xmath173 @xcite .",
    "however , when @xmath261 ( mod 8) , this does not imply that @xmath146 is a quadratic residue mod @xmath264 .",
    "in fact , the implication takes place only if @xmath173 is odd . in that case , it is easy to see that if @xmath267 ( mod @xmath173 ) for some @xmath18 , then @xmath264 divides @xmath268 if @xmath18 is odd , and @xmath269 if @xmath18 is even . note that if @xmath173 is even while @xmath261 ( mod 8) , then an ideal @xmath66 would belong to @xmath270 $ ] , which is not isomorphic to the maximal quadratic order @xmath271 $ ] of @xmath10 .",
    "( @xmath272 ) let @xmath52 satisfy the equation @xmath150 for some @xmath99 , and @xmath173 be odd when @xmath261 ( mod 8) .",
    "then @xmath146 is a quadratic residue of @xmath273 , where @xmath31 is defined as in ( [ eq : omega ] ) .",
    "define @xmath26 as a square root of @xmath146 mod @xmath273 . then @xmath262 $ ] is an ideal in @xmath7 .",
    "let @xmath57 for some @xmath58 . since @xmath121 is primitive , quaternions @xmath58 and @xmath119 have no common divisor from the right , which makes @xmath52 a greatest common divisor of @xmath173 and @xmath121 from the right , and therefore a right pseudo generator of @xmath262 $ ] .",
    "since @xmath274 , a similar argument can be applied towards the ideal @xmath275 $ ] , where @xmath276 .",
    "( @xmath277 ) the proof of the converse statement was demonstrated in the section [ sec : background ] .",
    "next , we must point out that some quadratic orders are equivalent to each other .",
    "note that for any unit @xmath88 we have @xmath87 .",
    "hence , if @xmath52 satisfies the relation @xmath150 , then @xmath183 satisfies    @xmath278    it means that our @xmath99 in the relation ( [ eq : rhomu ] ) may vary , depending on the pseudo generator we choose . as a result , we can define the following equivalence relation on the set of all quadratic orders in @xmath6 of a certain discriminant .",
    "we say that two quadratic orders @xmath7 and @xmath102 are _ equivalent _ , if @xmath36 and @xmath99 satisfy the relation @xmath279 for some unit @xmath88 .",
    "it is well known that ideals , which are equivalent to each other , form an _",
    "equivalence class_. the following theorem describes how we can fully characterize this set .",
    "[ thm : equivalence_class ] _",
    "@xcite _ consider a quadratic order @xmath7 , which contains two equivalent ideals @xmath66 and @xmath229 . if @xmath150 and @xmath280 , then @xmath102 and @xmath104 are equivalent .",
    "the theorem above demonstrates a rather interesting fact that all solutions to the equation @xmath281 for given @xmath36 and @xmath99 are pseudo generators of ideals , which are equivalent to each other .    in his letter , venkov described the full set of solutions to the equation ( [ eq : rhomu ] ) .",
    "we summarize his results in the following theorem .",
    "[ thm : solutions ] _",
    "@xcite _ let @xmath36 and @xmath99 be two primitive integral quaternions with the zero real part , s.t . @xmath274 .",
    "then the set of all solutions to the equation @xmath150 takes the form of a @xmath0-module @xmath282 $ ] for some particular integral quaternions @xmath283 , @xmath284 .    in this proof",
    ", we will simply describe the form of quaternions @xmath283 , @xmath284 . for more details , we ask our reader to refer to the original works of venkov .",
    "let    @xmath285    if @xmath286 , then the set of all @xmath52 with _ integral _ coefficients is of the form @xcite    @xmath287    where @xmath288 are integers , and @xmath283 , @xmath289 are two integral quaternions , defined by the following system of equations :    @xmath290    in this system , @xmath28 and @xmath291 are defined as follows :    @xmath292    @xmath293    integers @xmath25 , @xmath26 and @xmath27 are defined using the extended euclidean algorithm :    @xmath294    integers @xmath295 , @xmath23 and @xmath31 are defined through @xmath25 , @xmath26 , @xmath27 :    @xmath296    the full set of solutions ( including those @xmath52 with half - integer coefficients ) has the form @xcite",
    "@xmath297    where @xmath283 is defined as in system ( [ eq : integral_solutions ] ) , and @xmath284 is defined as in one of the following four cases :    a.   if @xmath298 ( mod 4 ) , and one of the sums @xmath299 , @xmath300 , @xmath301 , for example @xmath299 , is even , then + @xmath302 b.   if @xmath261 ( mod 8) and one of the sums , for example @xmath303 ( mod 4 ) , and others are @xmath304 ( mod 4 ) , then + @xmath305 c.   if @xmath261 ( mod 8) and all of the sums are @xmath306 ( mod 4 ) , then + @xmath307 d.    otherwise @xmath308 .    in case if @xmath309 , define @xmath310 . if @xmath291 , @xmath311 are solutions to the equation    @xmath312    then the set of all @xmath52 satisfying the equation @xmath1 is of the form ( [ eq : all_solutions ] ) , where    @xmath313    while the theorem [ thm : equivalence_class ] tells us that the relation ( [ eq : rhomu ] ) fully characterizes some particular equivalence class , the theorem [ thm : solutions ] tells us that all pseudo generators of ideals in this equivalence class have to be of the form @xmath314 for some integers @xmath288 and some fixed integral quaternions @xmath283 , @xmath284 .",
    "now we have all the results we need to turn our attention to the problem of ideal reduction .",
    "[ def : reduced ] an ideal @xmath315 in the quadratic order @xmath7 is said to be _ reduced _ , if in the set of solutions to the equation ( [ eq : rhomu ] ) , where @xmath316 , it has the smallest positive norm .    by the theorem [ thm : solutions ] , the set of all solutions to the equation ( [ eq : rhomu ] ) is equal to the @xmath0-module @xmath282 $ ] . in turn , the theorem [ thm : equivalence_class ] tells us that any ideal @xmath317 is equivalent to @xmath315 .",
    "therefore , our goal is to find an integral quaternion of the smallest positive norm , which belongs to @xmath282 $ ] .",
    "it is quite straightforward to find the norm of the reduced ideal .",
    "consider the norm of @xmath314 :    @xmath318    since @xmath319 is a quadratic form , then the problem of finding the smallest norm is equivalent to the problem of finding the smallest integer , representable by the form @xmath320 .",
    "using the reduction algorithm for quadratic forms ( * ? ? ?",
    "5.6.2 ) , we can find the reduced form @xmath321 , equivalent to the given one .",
    "the form @xmath321 has a property that @xmath25 is the smallest integer representable by this form , and therefore it is also the smallest integer representable by the original form ( * ? ? ?",
    "5.10 ) .",
    "as we have seen , given an ideal @xmath66 in the quadratic order @xmath7 , it is possible to find the norm of the reduced ideal @xmath315 , but not the ideal itself .",
    "the following algorithm allows us to compute a pseudo generator of the reduced ideal .",
    "note that @xmath322 defines an integer , which is closest to @xmath18 .",
    "[ alg : reduction ] _ ideal reduction .",
    "_    * input : * a quadratic order @xmath7 and a primitive ideal @xmath66 , which belongs to this order ;    * output : * a reduced ideal , which is equivalent to @xmath66 .    1 .",
    "compute @xmath323 ; 2 .",
    "compute the @xmath0-basis of the module @xmath282 $ ] , @xmath324 , which characterizes the set of solutions to the equation @xmath150 ; 3 .",
    "switch @xmath283 and @xmath284 ; 4 .",
    "compute @xmath325 ; 5 .",
    "put @xmath326 ; 6 .   if @xmath324 , go to step 3 ; 7 .   if @xmath327 and @xmath328 , return @xmath329",
    "otherwise return @xmath330 .",
    "let @xmath331 .",
    "consider the norm of a quaternion @xmath332 :    @xmath333    this quadratic function of one variable reaches its minimum at the point @xmath334 .",
    "however , we are interested in integral ( or half - integral ) @xmath77 , s.t .",
    "@xmath335 takes its smallest positive value , and @xmath332 is an integral quaternion . note that @xmath77 can be a half - integer only in one of the following two cases :    a.   when coefficients of @xmath284 are integers , and coefficients of @xmath283 are integral and odd ; b.   when coefficients of @xmath284 are half - integers , and coefficients of @xmath283 are integral and even .",
    "let us demonstrate that during the work of algorithm [ alg : reduction ] quaternions @xmath283 , @xmath284 can not satisfy neither ( a ) , nor ( b ) .",
    "note that if any of the above conditions hold , then @xmath283 is divisible by 2 , and therefore it is non - primitive .",
    "we aim to show that @xmath283 and @xmath284 will always be primitive .",
    "the first time we reach the step 3 of our algorithm , @xmath283 and @xmath284 are primitive and linearly independent , because of the way they were defined in the theorem [ thm : solutions ] . on the step 5",
    ", we define @xmath336 , so now our new @xmath284 may not be primitive .",
    "however , we can demonstrate that this is not the case .",
    "suppose that in the @xmath0-module @xmath282 $ ] we have @xmath337 for some integer @xmath338 and a primitive quaternion @xmath23 .",
    "since @xmath284 is a solution to the equation ( [ eq : rhomu ] ) , then @xmath23 is a solution as well .",
    "it means that @xmath339 for some integers @xmath77 and @xmath78 , because @xmath282 $ ] completely characterizes the set of solutions of the equation ( [ eq : rhomu ] ) .",
    "therefore , both of the following equalities    @xmath340    must hold at the same time .",
    "note that @xmath341 , since @xmath338 .",
    "now , because @xmath23 is primitive , @xmath77 must divide @xmath342 , and since @xmath283 is primitive , @xmath342 must divide @xmath77 , whence @xmath343 .",
    "it implies that @xmath283 is equal to @xmath23 , which contradicts the fact that @xmath283 and @xmath284 are linearly independent .",
    "therefore , @xmath283 and @xmath284 are both primitive , which means that @xmath77 can not be a half - integer .",
    "let us now return back to our algorithm . as it was mentioned before , the function ( [ eq : norm_quadratic ] ) reaches its minimum at the point @xmath334 .",
    "therefore , an integer @xmath344 corresponds to an integral quaternion @xmath332 , which has the smallest norm .",
    "now we can replace the @xmath0-module @xmath282 $ ] with the equivalent @xmath0-module @xmath345 $ ] .",
    "however , if @xmath346 , where @xmath336 , there is no need to go back to step 3 . for if we would perform the norm reduction in the same way one more time ( without swapping @xmath283 and @xmath284 , because @xmath347 is already greater than @xmath348 ) , we would get @xmath349 . as we shall see later",
    ", @xmath349 actually indicates that @xmath330 is reduced . in case",
    "if @xmath327 , we also do nt need to go back to step 3 . if we consider the quadratic form ( [ eq : norm ] ) , which characterizes the norm of @xmath314 , the cauchy - schwarz inequality holds :    @xmath350    it means that @xmath77 is either @xmath351 ( i.e. @xmath330 is reduced ) , or @xmath352 , depending on the sign of @xmath353 . in the second case , we replace a @xmath0-module @xmath282 $ ] with @xmath354 $ ] . note that @xmath355 because @xmath356 ( i.e. @xmath357 ) .",
    "now , compute    @xmath358    because @xmath349 , we conclude that @xmath329 is reduced .    summing up , we have to replace @xmath282 $ ] with @xmath345 $ ] only if @xmath324 . when this is done , at the step 3 we swap the basis quaternions , in order to ensure that at the step 4 we have @xmath346 .",
    "note that on each iteration we ensure that the norm of one of the basis quaternions gets lessened .",
    "since norms are bounded below by zero , and we return the result whenever @xmath331 , our algorithm will definitely terminate .",
    "now , let us prove that if @xmath349 , then the norm of @xmath283 is the smallest positive integer , which can be represented by a quadratic form @xmath320 .",
    "first of all , recall that the condition @xmath359 means    @xmath360    second , suppose that there exists a quaternion @xmath31 s.t . @xmath361 .",
    "then there exist two integers @xmath77 and @xmath78 s.t .",
    "@xmath362 , i.e.    @xmath363    since @xmath364 satisfies the relation ( [ eq : x=0 ] ) , we have    @xmath365    on the step ,",
    "we ensure that @xmath284 has a greater norm than @xmath283 , so the following inequality holds :    @xmath366    if we now divide all the parts of the inequality above by @xmath367 , we get    @xmath368    since @xmath369 takes only integral values , it has to be equal to either 0 or 1 .",
    "if it is equal to zero , then @xmath349 and @xmath370 , because @xmath369 is a positive definite quadratic form ( * ? ?",
    "this implies @xmath371 . on the other hand , if @xmath372 , then @xmath373 .",
    "therefore , @xmath283 has the smallest positive norm .",
    "the following theorem describes an upper bound to the number of iterations that algorithm [ alg : reduction ] performs in order to compute the reduced ideal .",
    "[ thm : reduce_bound ] let @xmath374 $ ] be a @xmath0-module , where @xmath375 and @xmath376 are two arbitrary linearly independent integral quaternions with @xmath377 . define an algorithm , which computes    @xmath378    and terminates whenever @xmath379 for some @xmath14 .",
    "then @xmath380 as @xmath381 , where @xmath382 . in case if @xmath383 , then @xmath384 as @xmath385 , where @xmath386 denotes the fractional part of @xmath18 .",
    "let us estimate the difference between the norms of quaternions @xmath387 and @xmath388 :    @xmath389    note that the difference can be either less than , or greater than , or equal to @xmath390 .",
    "consider the first case . then    @xmath391    note that for the function @xmath392 the inequality @xmath393 holds only for @xmath394",
    ". therefore , @xmath395 , and @xmath396 , depending on the sign of @xmath397 .",
    "we do not consider the case @xmath398 , because it indicates the termination of our algorithm .",
    "suppose that @xmath399 ( we can prove the opposite case analogously ) .",
    "then    @xmath400    @xmath401    let us simplify the integer occurring in @xmath402 :    @xmath403    @xmath404    if we now look closer at the difference under the floor sign , we notice that it actually varies from 0 to @xmath405 , excluding @xmath405 , because @xmath406 .",
    "this allows us to conclude that the integer we have been computing is actually zero , and therefore @xmath407 . summarizing",
    ", we have    @xmath408    we conclude that whenever the norm of @xmath409 gets reduced by less than @xmath390 , our algorithm will terminate either on the @xmath410-st , or on the @xmath411-nd iteration .",
    "now , consider the second case , when @xmath412 .",
    "let us assume the worst case , when on each iteration of the algorithm the norm of @xmath409 gets reduced exactly by @xmath390 .",
    "denote @xmath413 , @xmath414 , and let @xmath415 for natural @xmath43 denote the @xmath43-th element of the fibonacci sequence , i.e. @xmath416 , @xmath417 , @xmath418 .",
    "then on the first six iterations , our algorithm produces the result , demonstrated in the table below .",
    "note that the column demonstrates which inequality has to be satisfied in order for the algorithm to proceed to the next iteration , and the column demonstrates an interval , which @xmath419 belongs to if two consecutive iterations did not result in a termination of the algorithm .",
    "@xmath420    table 1    in general , it is not hard to show that , depending on the parity of @xmath43 , for @xmath421 we get    @xmath422    using the famous relation @xmath423 , which holds for any @xmath424 , we can demonstrate that an interval , defined on the iteration @xmath425 , is a subset of an interval , defined on the iteration @xmath426 :    @xmath427 \\subset \\left[\\frac{f_{2m}}{f_{2 m - 1 } } ; \\frac{f_{2m+1}}{f_{2m}}\\right].\\ ] ]    so as we can see , our interval gets shorter with each iteration , and our algorithm terminates whenever @xmath419 falls out of the interval .",
    "but we can go even further : recall that @xmath428 , where @xmath429 , known as the _ golden ratio _ , is equal to @xmath430 . since this sequence converges , any subsequence of it must converge as well , which implies that @xmath431 and @xmath432 both tend to @xmath429 .",
    "but the first sequence is monotonously increasing , while the second one is monotonously decreasing .",
    "it means that each interval of the form @xmath433 $ ] must contain @xmath429 . as a consequence",
    ", we can see that the closer @xmath419 to @xmath429 , the more iterations our algorithm has to perform .",
    "there are two separate cases arise at this point : when @xmath419 is less than , or greater than @xmath429 . if @xmath434 , then @xmath435 is true for any @xmath11 , which means that the algorithm can not terminate at the even iteration .",
    "analogously , if @xmath436 , then @xmath437 , and the algorithm can not terminate at the odd iteration .    note that we expect out algorithm to terminate when @xmath438 for some @xmath14 .",
    "assume that @xmath436 , which means that @xmath439 for some positive integer @xmath11 .",
    "recall the exact formula for the @xmath43-th element of the fibonacci sequence :    @xmath440    then for @xmath43 , satisfying @xmath441 , we have    @xmath442    if we now take the logarithm on both parts of the inequality above , we shall get    @xmath443    since @xmath444 for @xmath445 , and @xmath446 tends to zero as @xmath11 goes to infinity , then for big values of @xmath11 the following inequality holds :    @xmath447    which , in turn , results in    @xmath448    if we now take the logarithm on both sides of the inequality above , we shall obtain    @xmath449    let    @xmath450    then    @xmath451    which means that for any even @xmath14 , which satisfies the inequality above , the relation @xmath452 holds . in other words , the closest even integer greater than @xmath453 will be the least upper bound for @xmath14 , which allows us to conclude that @xmath454 as @xmath381 .",
    "here we used the module sign because in case if @xmath455 , the value of @xmath456 is negative .",
    "we also expect the value @xmath457 to be negative .",
    "now , let s see how bad our algorithm will perform , if we will make @xmath419 as close to @xmath429 as possible .",
    "if @xmath458 , this happens when @xmath383 . in this case",
    ",    @xmath459    we conclude that in this case    @xmath460    and therefore @xmath384 as @xmath461 approaches infinity .    from the theorem [ thm : reduce_bound ]",
    ", it follows that the algorithm [ alg : reduction ] executes in @xmath462 , assuming that @xmath331 .",
    "if @xmath463 approximates @xmath429 in the best possible manner , i.e. @xmath464 , then the algorithm works in @xmath465 .",
    "recall the fermat factorization method : suppose that we know a couple of different representations of a positive integer @xmath11 as a sum of two squares :    @xmath466    then @xmath467 ( * ? ? ?",
    "same formula holds if we know a couple of different representations of @xmath11 as the sum of a square and a doubled square : @xmath468 .",
    "the result of fermat is a special case of the theory , introduced in this paper .",
    "consider a quadratic order @xmath7 with @xmath469 , where @xmath470 is composite .",
    "then by the theorem [ thm : ambiguous ] , the pseudo generator of an ambiguous ideal @xmath66 has to divide @xmath120 from the right , and therefore @xmath173 has to divide @xmath471 .",
    "since @xmath52 satisfies the relation ( [ eq : rhomu ] ) for some @xmath472 of the same norm as @xmath36 , it is evident that for any three squares representation of an integer there exists another three squares representation , which allows us to factor @xmath129 .",
    "the following couple of theorems demonstrate that for quaternions @xmath473 and @xmath474 and an ambiguous ideal @xmath66 , @xmath99 has to be of a certain form .",
    "[ thm : two_squares ] consider a quadratic order @xmath7 , where @xmath475 , and exactly one of the coefficients @xmath476 , @xmath477 , @xmath478 is equal to zero .",
    "the equivalence class @xmath479 $ ] is ambiguous if and only if for the quaternion @xmath480 exactly one of the coefficients @xmath481 , @xmath482 , @xmath483 is zero .",
    "( @xmath272 ) let @xmath66 be an ambiguous ideal , which belongs to the order @xmath7 , where @xmath484 and @xmath485 .",
    "note that in here we have picked @xmath36 so that @xmath486 , but in general we can zero out any of the coefficients by replacing @xmath7 with a suitable quadratic order of the form @xmath487 for some unit @xmath88 .    by the theorem [ thm : ambiguous ]",
    ", @xmath52 has to divide @xmath488 from the right , i.e. @xmath489 for some integral quaternion @xmath53 .",
    "then @xmath490 . let us demonstrate that @xmath491 .",
    "first of all , notice that @xmath492 is an element of the ring of gaussian integers @xmath493 $ ] . since @xmath493 $ ] is a unique factorization domain ( * ? ? ? * chap .",
    "1 ) , the quaternion @xmath494 of norm @xmath495 can be uniquely represented as the product of two integral quaternions @xmath496 and @xmath497 , which are also in @xmath493 $ ] , and @xmath498 , @xmath499 :    @xmath500    since @xmath501 , put    @xmath502    then @xmath503 has @xmath491 .",
    "( @xmath277 ) let @xmath484 , @xmath504 , and @xmath274 .",
    "once again , we have picked our @xmath36 and @xmath99 so that @xmath505 , but this is not necessary , as we can always find suitable quaternions @xmath506 or @xmath507 for some units @xmath508 , @xmath509 , which would make @xmath505 .    by the theorem [ thm : ideal_generated_by_orders ] ,",
    "an integral quaternion @xmath510 , where @xmath28 is the greatest integral divisor of @xmath511 , is a right pseudo generator of a primitive ideal @xmath512 \\subseteq { \\mathcal o}(\\mu)$ ] for some integer @xmath26 .",
    "since @xmath53 is a right pseudo generator of an ideal , then @xmath513 is a pseudo generator of the same ideal :    @xmath514    obviously , we have @xmath515 , which means that the relation ( [ eq : main_relation_rho ] ) takes the form    @xmath516    where @xmath17 is defined as in step 2 of the algorithm [ alg : restore ] .",
    "since @xmath517 ( otherwise @xmath52 would not be primitive ) , we have @xmath518 for an integer @xmath519 .",
    "it implies that the @xmath0-basis of @xmath66 takes the form @xmath520 $ ] . in turn , this ideal is equivalent to @xmath521 $ ] , which is ambiguous .",
    "consider a quadratic order @xmath7 , where @xmath475 , and exactly two of the coefficients @xmath476 , @xmath477 , @xmath478 are equal to each other in their absolute value .",
    "the equivalence class @xmath479 $ ] is ambiguous if and only if for the quaternion @xmath480 exactly two of the coefficients @xmath481 , @xmath482 , @xmath483 are equal to each other in their absolute value .",
    "( @xmath272 ) if we have @xmath522 , then @xmath523 belongs to the ring @xmath524 $ ] , which is isomorphic to @xmath525 $ ] .",
    "since @xmath525 $ ] is a unique factorization domain , the same reasoning as in the proof of the theorem [ thm : two_squares ] can be applied to demonstrate the desirable result .",
    "( @xmath277 ) the sufficient condition can be proved using almost the same reasoning as in the theorem [ thm : two_squares ] .",
    "the only contrast between two proves would be in the difference of initial quaternions @xmath36 and @xmath99 .",
    "in this section , we present three formulas , which characterize a primitive ideal @xmath170 $ ] in the quadratic order @xmath7 .",
    "the first formula that we are about to introduce has the same form as ( [ eq : main_relation_rho ] ) , except that @xmath52 gets replaced by @xmath58 , which satisfies @xmath57 . to prove it , we first need to demonstrate the following proposition .    [ prop : equal_scalar_products_xi ] consider @xmath170 $ ] in the quadratic order @xmath7 .",
    "then @xmath526 , where @xmath527 , and @xmath58 satisfies the relation @xmath57 .",
    "consider two equalities : @xmath528 and @xmath529 . since every quaternion satisfies the relation ( [ eq : quat_relation ] )",
    ", we have    @xmath530    @xmath531    let us subtract the second equation from the first one :    @xmath532    @xmath533    consider the quaternion on the left side of the equation :    @xmath534    @xmath535    since @xmath536 ,    @xmath537    applying the relation ( [ eq : product ] ) , we obtain    @xmath538 + ( \\omega',\\xi ) - [ \\omega',\\xi ] + \\re(\\xi)\\left(\\vec\\omega - \\vec{\\omega'}\\right ) = 2\\re(\\xi)\\left(\\omega - \\omega'\\right).\\ ] ]    since the quaternion on the right has a zero real part , if we now take the real part on both sides of the equation above , we get @xmath526 .    [",
    "prop : main_prop_xi ] if a primitive ideal @xmath48 = { \\langle\\rho\\rangle_r}$ ] belongs to the quadratic order @xmath7 , then    @xmath539    where @xmath58 is an integral quaternion , which satisfies the relation @xmath57 , and an integer @xmath31 is defined as in ( [ eq : omega ] ) .",
    "if we use the fact from proposition [ prop : equal_scalar_products_xi ] that @xmath540 , the relation ( [ eq : main_relation_xi ] ) can be shown in the same manner as in the proof of the proposition [ prop : main_prop ] .",
    "next two relations follow from the fact that an integral quaternion @xmath541 will always be a root of the the equation @xmath542 . by the proposition [ prop : equal_scalar_products_rho ] , @xmath543 .",
    "it follows that    @xmath544    since @xmath545 , where @xmath546 .",
    "if we now apply the relation from the system ( [ eq : system ] ) , we shall obtain    @xmath547    @xmath548    @xmath549    @xmath550    in the end , we obtain the following couple of relations :    @xmath551    @xmath552",
    "from the theorem [ thm : ideal_generated_by_orders ] , we know that each ideal gets generated by a couple of quadratic orders . among these ideals , some of them get generated by orders @xmath7 and @xmath553 . in our research ,",
    "we were interested in the following question : how many nontrivial _ ambiguous _ ideals get generated by such quadratic orders ? to answer it , we have written a program , which counts up to some bound @xmath4 how many integers , which satisfy certain parameters mentioned below , have at least one ambiguous ideal of that form .",
    "first of all , we have to emphasize that it is not always the case that @xmath7 and @xmath553 are not equivalent . normally , if @xmath143 and @xmath18 , @xmath19 , @xmath20 are all distinct and non - zero , out of a single three squares representation we can produce 48 different , including the original one .",
    "these representations can be obtained by switching signs and by permuting @xmath18 , @xmath19 , @xmath20 . on the other hand , if @xmath469 , there exist exactly 12 equivalent quadratic orders of the form @xmath487 .",
    "now it is not hard to observe that if @xmath18 , @xmath19 , @xmath20 are different and non - zero , quaternions @xmath36 , @xmath554 , @xmath555 and @xmath556 , where @xmath557 , will form quadratic orders , which are not equivalent to each other .",
    "there are two special cases arise at this point : if @xmath469 and @xmath558 , then @xmath559 , i.e. quadratic orders , generated by these quaternions , are equivalent .",
    "analogous observation can be made when @xmath560 or @xmath561 . if @xmath469 and @xmath562 , then @xmath563 , which means that @xmath7 and @xmath553 are equivalent to each other .",
    "once again , analogous observation can be made when @xmath564 or @xmath565 .    as a result , we have decided to avoid two squares representations , for they will always generate trivial ambiguous ideals .",
    "we can also argue that the case @xmath469 when @xmath558 will also produce a trivial result .",
    "recall the theorem [ thm : solutions ] . in its proof , we have demonstrated how to compute the @xmath0-module @xmath282 $ ] , which fully characterizes the set of solutions to the equation @xmath1 .",
    "if we would follow the procedure described in that proof , we could notice that @xmath566 . because @xmath7 and @xmath553 are not equivalent",
    ", the norm @xmath567 is the smallest , which means that @xmath330 is reduced . when @xmath261 ( mod 8) , from the theorem [ thm : ideal_generated_by_orders ] we know that such an ideal does not belong to @xmath7 . in the opposite case ,",
    "from the theorem [ thm : ambiguous ] we know that @xmath567 has to divide @xmath568 , which obviously corresponds to the trivial case .",
    "this is why we ignore those @xmath469 with @xmath558 , as well as the cases when @xmath561 or @xmath569 , which produce the trivial result for the same reason .",
    "the table below demonstrates our computational data . in our experiment",
    ", we were considering only those integers , which are a ) squarefree ; b ) not prime ; and c ) not congruent to 7 mod 8 ( since these integers can not be represented as a sum of three squares ) .",
    "let us denote the set of those integers as @xmath570",
    ". among the elements of @xmath570 , our algorithm was looking for those @xmath11 , which have at least one quaternion @xmath469 with the norm @xmath44 , s.t .",
    "quadratic orders @xmath7 and @xmath553 generate a non - trivial ambiguous ideal .",
    "we denote this set as @xmath461 .",
    "the column demonstrates what is the percentage of elements of @xmath461 in respect to the number of elements of @xmath570 .",
    "the column shows an integer less than @xmath4 , which has the maximal number @xmath571 of non - trivial ambiguous ideals , generated by @xmath1 .",
    "the number @xmath571 is indicated in brackets .",
    "finally , the column gives an example of an element @xmath143 in @xmath461 and a three squares representation ( @xmath18,@xmath19,@xmath20 ) , which generates an ambiguous ideal , while the column gives an example of an integer , which is in @xmath572 .",
    "[ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     many questions arise at this point .",
    "first of all , do separated ideals exist in @xmath7 for any squarefree @xmath174 ?",
    "second , can we say anything meaningful about their quantity ?",
    "third , how hard is it to find a separated ideal ? probably , these ideals satisfy some other interesting properties that need to be explored .",
    "we leave all these questions open , hoping to dedicate more time to the study of separated ideals in the near future .",
    "in this paper , we have introduced four algorithms , which allow us to manipulate ideals in the ring of integral quaternions using only their pseudo generators , without ever mentioning their @xmath0-basis . in the future",
    ", we would like to extend our algorithms to the generalized quaternion algebras , possibly defined over a different field .",
    "we have also demonstrated the theorem , which shows that the fermat s number factoring technique , which uses two different representations of an integer as a sum of two squares , is a special of case of the theory , presented in this paper . in general ,",
    "if we have a single three squares representation for a composite integer @xmath573 , there must exist another three squares representation @xmath574 , which can help us to factor @xmath11 .",
    "but the more interesting fact is that this is not always necessary , as sometimes a _",
    "three squares representation can produce a non - trivial factor of @xmath11 .",
    "this phenomenon was studied in the section [ sec : count_ambiguous ] .",
    "there are multiple questions left open at this point .",
    "what is the necessary , or , even better , sufficient condition for an integer @xmath4 to contain an ambiguous ideal , generated by the equation @xmath1 ? why each integer @xmath4 , with a number @xmath571 of those ambiguous classes greater than any integer less than @xmath4 , has @xmath571 being a power of 2 ?",
    "why for each @xmath4 that satisfy this property , the class number @xmath575 also turns out to be a power of 2 ?",
    "finally , how can we find separated ideals within a certain ideal class group ? we intend to explore all these questions in more depth in the future .",
    "this research was done for the author s",
    "master s thesis , which was submitted to the faculty of higher mathematics of the st .",
    "petersburg national research university of information technologies , mechanics and optics in june , 2013 .",
    "the author would like to thank his supervisor , mikhail nikolayevich kubensky , for his wise guidance .",
    "the author is also grateful to dr .",
    "matthew greenberg ( university of calgary , canada ) and robert bateman ( linstitut polytechnique des sciences avances , france ) for their thoughtful comments and the paper revision .",
    "r. scheidler , _ compact representation in real quadratic congruence function fields _ , in proc .",
    "second algorithmic number theory symposium ants - ii , lecture notes in computer science 1122 ( 1996 ) , springer , berlin , 323336 ."
  ],
  "abstract_text": [
    "<S> an ideal is a classical object of study in the field of algebraic number theory . in </S>",
    "<S> maximal quadratic orders of number fields , ideals usually represented by the @xmath0-basis . </S>",
    "<S> this form of representation is used in most of the algorithms for ideal manipulation . however , </S>",
    "<S> this is not the only option , as an ideal can also be represented by its generating set . moreover , in certain quadratic orders of the ring of integral quaternions , every ideal can be represented by a single quaternion , called a _ </S>",
    "<S> pseudo generator_.    in this paper , we develop algorithms which allow us to manipulate ideals using solely their pseudo generators . </S>",
    "<S> we also demonstrate the connection between the three squares problem and factorization . </S>",
    "<S> this result comes as an extension of a number factoring technique discovered by fermat , which allows the factoring of an integer if a pair of its two squares representations is known . </S>",
    "<S> in addition to this , we present a number of identities , which ideals must satisfy ; some computational data on the number of ambiguous classes , generated by the equation @xmath1 ; and a new approach to the problem of finding a non - trivial divisor of a class number . </S>"
  ]
}