{
  "article_text": [
    "biochemical systems with small numbers of interacting components have increasingly been studied in the recent years .",
    "examples include the phage @xmath0 lysis - lysogeny decision circuit  @xcite , circadian rhythms  @xcite and cell cycle @xcite .",
    "it is this small number of interacting components that makes the appropriate mathematical framework for describing these systems a stochastic one . in particular , the kinetics of the different species is accurately described , under appropriate assumptions , by a continuous - time discrete - space markov chain .",
    "the theory of stochastic processes  @xcite allows the association of the markov chain with an underlying master equation , which is a set of ordinary differential equations ( odes ) , possible of infinite dimensions , that describe , at each point in time , the probability density of all the different possible states of the system . in the context of biochemical systems",
    "this equation is known as the _ chemical master equation _ ( cme ) .",
    "the high dimensionality of the cme makes it intractable to solve in practice .",
    "in particular , with the exception of some very simple chemical systems  @xcite analytic solutions of the cme are not available . one way to deal with this issue is to resort to stochastic simulation of the underlying markov chain . the stochastic simulation algorithm ( ssa ) developed by gillespie",
    "@xcite exactly simulates trajectories of the cme as the system evolves in time . the main idea behind this algorithm , is that at each time point , one samples a waiting time to the next reaction from an appropriate exponential distribution , while another draw of a random variable is then used to decide which of the possible reactions will actually occur . for suitable classes of chemically reacting systems",
    ", one can sometimes use exact algorithms which , although equivalent to the gillespie ssa are less computationally intensive .",
    "examples include the gibson - bruck next reaction method  @xcite and the optimized direct method  @xcite .",
    "these algorithms can be further accelerated by using parallel computing , for example , on graphics processing units  @xcite .",
    "all the methods described above can only go so far in terms of speeding up the simulations , since even with the all possible speed ups running the ssa can be computationally intensive for realistic problems .",
    "one approach to alleviate the computational cost is to employ different approximations on the level of the description of the chemical system .",
    "for example , in the limit of large molecular populations , the waiting time becomes , on average , very small and under the law of mass action the time evolution of the kinetics is described by a system of odes .",
    "this system is known as the _ reaction rate equation _ which describes , approximately , the time evolution of the mean of the evolving markov chain .",
    "an intermediate regime between the ssa and the reaction rate equation is the one where stochasticity is still important , but there exist a sufficient number of molecules to describe the evolving kinetics by a continuous model .",
    "this regime is called the chemical langevin equation ( cle )  @xcite , which is an it stochastic differential equation ( sde ) driven by a multidimensional wiener process . in this case",
    "the corresponding master equation for the cle is called the chemical fokker - planck equation ( cfpe ) which is a @xmath1-dimensional parabolic partial differential equation , where @xmath1 is the number of the different chemical species present in the system .",
    "the fact that stochasticity is still present in the description of the chemical system , combined with the fact that the underlying cfpe is more amenable to rigorous analysis than the cme , has made the cle equation a very popular regime used in applications  @xcite . however , while there are benefits to working with the cle / cfpe , this approximation is only valid in the limit of large system volume and provides poor approximations for systems possessing one or more chemical species with low copy numbers .",
    "furthermore , unlike the ssa / cme which ensures that there is always a positive ( or zero ) number of molecules in the system , the cfpe and cle can give rise to negative concentrations , so that the chemical species can attain negative copy numbers .",
    "this can have serious mathematical implications , since the cfpe equation might break down completely , due to regions in which the diffusion tensor is no longer positive definite , which makes the underlying problem ill - posed . on the level of the cfpe , one way to deal with such positivity issues is to truncate the domain and artificially impose no flux - boundary conditions along the domain boundary  @xcite , which will have a negligible effect on the solution when it is concentrated far away from the boundary .",
    "when all chemical species exist in sufficiently high concentration , dirichlet boundary conditions can also be used if one solves the stationary cfpe as an eigenvalue problem  @xcite .",
    "however , as shown in  @xcite , these artificial boundary conditions can result in significant approximation errors when the solution is concentrated near the boundary .",
    "other alternatives have been proposed to overcome the behaviour of the cle close to the boundary , either by suppressing reaction channels which may cause negativity near the boundary  @xcite , or by extending the domain of the process to allow exploration in the complex domain  @xcite . in the later approach",
    "the resulting process , called the complex cle will have a positive definite diffusion tensor for all time , thus avoiding such breakdowns entirely . however",
    ", this method does not accurately capture the cme behaviour near the boundary , and in areas where the cle is a poor approximation to the cme , the corresponding complex cle will suffer equally .",
    "these issues have motivated a number of hybrid schemes which have been obtained by treating only certain chemical species as continuous variables and the others as discrete  @xcite . by doing so ,",
    "such schemes are able to benefit from the computational efficiency of continuum approximations while still taking into account discrete fluctuations when necessary .",
    "typically such schemes involve partitioning the reactions into `` fast '' and `` slow '' reactions , with the fast reactions modelled using a continuum approximation ( cle or the reaction rate equation ) , while using markov jump process to simulate the discrete reactions .",
    "chemical species which are affected by fast reactions are then modelled as continuous variables while the others are kept discrete .",
    "since the reaction rate depends on the state , it is possible that some fast reactions become slow and vice versa .",
    "this is typically accounted for by periodically repartitioning the reactions .",
    "based on this approach , a number of hybrid models have been proposed , such as  @xcite , which couple deterministic reaction - rate equations for the fast reactions with markov jump dynamics for the slow , resulting in a piecewise - deterministic markov process for the entire system .",
    "error estimates for such systems , in the large volume limit , were carried out in  @xcite .",
    "similar methods have been proposed , such as  @xcite and more recently  @xcite .",
    "other hybrid schemes  @xcite also involve a similar partition into slow and fast species , however the evolution of the slow species is obtained by solving the cme directly , coupled to a number of reaction - rate equations for the fast reactions .",
    "the hybrid system is thus reduced to a system of odes .",
    "an error analysis of these schemes was carried out in  @xcite .    in this paper",
    ", we propose a hybrid scheme which uses langevin dynamics to simulate fast reactions coupled with jump / ssa dynamics to simulate reactions in which the discreteness can not be discounted .",
    "thus , unlike the previously proposed models , both the continuous and discrete parts of the model are described using a stochastic formulation .",
    "moreover , our scheme does not explicitly keep track of fast and slow reactions , but rather , the process will perform langevin dynamics in regions of abundance , jump dynamics in regions in where one of the involved chemical species are in small concentrations , and a mixture of both in intermediate regions .",
    "the resulting process thus becomes a jump - diffusion process with poisson distributed jumps .",
    "the preference of jump over langevin dynamics is controlled for each individual reaction by means of a _ blending _ function which is chosen to take value @xmath2 in regions of low concentration , @xmath3 in regions where all involved chemical species are abundant , and smoothly interpolates in between .",
    "the choice of the blending regions will depend on the constants of the propensity and are generally chosen so that the propensity is large in the continuum region , and small in the discrete region .",
    "hybrid models for chemical dynamics involving both jump and diffusive dynamics have been previously studied in various contexts .",
    "recently , a method  @xcite based on a similar coupling of ssa and langevin dynamics was proposed .",
    "the authors introduce a partition of reactions into fast and slow reactions , applying the diffusion approximation to the fast reactions to obtain a jump - diffusion process .",
    "based on an a - posteriori error estimator the algorithm periodically repartitions the species accordingly . by introducing the blending region our approach",
    "no longer requires periodic repartitioning .",
    "other works which have considered hybrid schemes based on jump - diffusion dynamics include  @xcite . in @xcite a hybrid scheme based on a similar domain decomposition idea",
    "was proposed for simulating spatially - extended stochastic - reaction diffusion models . in one part of the domain a sde",
    "was used to simulate the position of the particles and on the other part a compartment - based jump process for diffusion was used .",
    "these two domains were separated by a sharp interface , where corrections to the transition probabilities at the interface were applied to ensure that probability mass was transferred between domains .",
    "while such a direct matching between continuum and discrete fluxes at the interface can accurately simulate systems having only reactions with unit jumps , for systems possessing jumps of length @xmath4 or higher , such a direct coupling would cause non - physical results .",
    "this scenario is analogous to _ ghost forces _ which arise in quasi - continuum methods used in the multiscale modelling of materials  @xcite .",
    "overlap regions are also necessary for coupling brownian dynamics ( sdes ) with mean - field partial differential equations  @xcite .",
    "the paper is organised as follows . in section [ sec : prelims ] after reviewing the cme / ssa and cle / cfpe formalisms we introduce blending functions and the hybrid jump - diffusion formalism . in section [ sec : derivation ] we derive weak error bounds for the hybrid scheme in the limit of large volume , and in particular show that the hybrid scheme does not perform worse than the cle in this regime . in section [ sec : algorithm ] we describe three possible discretisations of the process , which can be used in practise to simulate the jump - diffusion process .",
    "a number of numerical experiments which demonstrates the use of the hybrid scheme are detailed in sections [ sec : lotka_volterra ] , [ sec : dimer_steady_state ] and [ sec : exit_time ] .",
    "consider a biochemical network of @xmath1 chemical species interacting via @xmath5 reaction channels within an isothermal reactor of fixed volume @xmath6 .",
    "for @xmath7 , denote by @xmath8 the number of molecules of species @xmath9 at time @xmath10 , and let @xmath11 . under the assumption that the chemical species are well - mixed it",
    "can be shown @xcite that @xmath12 is a continuous time markov process .",
    "when in state @xmath12 , the @xmath13-th reaction gives rise to a transition @xmath14 with exponentially distributed waiting time with inhomogeneous rate @xmath15 , where @xmath16 and @xmath17 denote the propensity and stoichiometric vector corresponding to the @xmath13-th reaction , respectively .",
    "more specifically , each reaction is of the form @xmath18 where @xmath19 and @xmath20 @xmath21 , for @xmath22 .",
    "let us denote @xmath23 and @xmath24 .",
    "the stoichiometric vectors @xmath25 are then given by @xmath26 and describe the net change in molecular copy numbers which occurs during the @xmath27-th reaction .",
    "under the assumption of mass action kinetics , the propensity function @xmath28 for the @xmath27-th reaction is @xmath29 assuming that @xmath30 if @xmath31 , to simplify notation . within the interval @xmath32 , we update @xmath33 the process @xmath12 can thus be expressed as the sum of @xmath5 poisson processes with inhomogeneous rates @xmath15 . as noted in @xcite ,",
    "@xmath12 can be expressed as a random time change of unit rate poisson processes , @xmath34 where @xmath35 are independent unit - rate poisson processes .",
    "this is a continuous time markov process with infinitesimal generator @xmath36 the classical method for sampling realisations of @xmath12 is the gillespie ssa @xcite .",
    "given the current state @xmath12 at time @xmath10 , the time of next reaction @xmath37 and state @xmath38 are sampled as follows :    1 .",
    "let @xmath39 .",
    "sample @xmath40 , where @xmath41 $ ] .",
    "3 .   choose the next reaction @xmath27 with probability @xmath42 , where @xmath43 .",
    "4 .   @xmath44 .",
    "we note that in advancing the system from time @xmath10 to time @xmath45 one needs to generate two random numbers each time .",
    "based on the time changed representation ( [ eq : poisson_rep ] ) one can derive an alternative algorithm , known as the _ next reaction method _ of gibson and bruck  @xcite .",
    "indeed , for a fixed realisation of each unit rate poisson process @xmath46 , define @xmath47 to be the last jump time of @xmath48 before time @xmath10 .",
    "then for each @xmath27 , the next jump time of @xmath48 after time @xmath47 will be distributed as @xmath49 , where @xmath50 $ ] . clearly ,",
    "as the process @xmath51 evolves , the @xmath27-th reaction will then occur at @xmath52 satisfying @xmath53 this provides the basis of the next reaction method .",
    "suppose we are time @xmath10 , the next reaction will occur at @xmath54 for @xmath55 where @xmath56 $ ] are independently distributed random numbers .",
    "noting that the values of the propensities do not change within @xmath57 we have @xmath58 , so that the next reaction time is given by @xmath59 at which time the reaction that occurs is the one for which @xmath60 .",
    "this leads to the following exact algorithm for sampling realizations of @xmath12 .    1 .",
    "set the initial number of molecules of each species , set @xmath61 .",
    "2 .   calculate the propensity function @xmath62 for each reaction .",
    "3 .   generate @xmath5 independent random numbers @xmath63 $ ] .",
    "4 .   set @xmath64 and @xmath65 for each @xmath66 .",
    "5 .   set @xmath67 for each @xmath66 . 6 .",
    "set @xmath68 and let @xmath69 be the reaction for which this minimum is realised . 7 .",
    "set @xmath70 and update the number of each molecular species according to reaction @xmath71 . 8 .   for each k , set @xmath72 , and for the reaction @xmath71 , let @xmath41 $ ] and set @xmath73 . 9 .",
    "recalculate the propensity functions @xmath62 .",
    "return to step 5 or quit .",
    "this algorithm was introduced by gibson and bruck  @xcite who additionally proposed the introduction of an indexed priority queue to efficiently search for the minimum required in step 6 , along with a dependency graph structure to efficiently update propensity values in step 9 .",
    "this makes it less computationally intensive from the gillespie ssa when simulating systems with many reaction channels  @xcite .",
    "for @xmath74 define @xmath75 to be a smooth , non - negative extension of @xmath76 from @xmath77 to @xmath78 ( the precise conditions on this extension are given in section [ sec : derivation ] ) .",
    "given the extended propensities , a commonly used approximation of ( [ eq : poisson_rep ] ) is the cle , given by the following it sde @xmath79 where @xmath80 are mutually independent standard brownian motions .",
    "this diffusion approximation is valid in the large volume regime , where all species exist in abundance , and all reactions occur frequently , see for example  @xcite .",
    "more precisely , one can show strong convergence of @xmath81 to @xmath12 over finite time intervals @xmath82 $ ] , see  @xcite . clearly , the lifting of @xmath83 to @xmath84 is not unique , and different extensions will give rise to different diffusion approximations .",
    "however , as we shall see in section [ sec : derivation ] , in the classical large volume rescaling , the dynamics of the process will be largely determined by the value of the propensities on the rescaled grid @xmath85 , and indeed , subject to the extension satisfying a number of assumptions , different extensions will lead to the diffusion approximation having weak error of the same order .      in this section",
    ", we introduce a jump - diffusion process which provides an approximation which is intermediate between the gillespie ssa and cle by introducing a series of _ blending _",
    "functions @xmath86 which are used to blend the dynamics linearly between the ssa jump process and the cle .",
    "more specifically , given @xmath5 smooth functions @xmath87 $ ] , @xmath74 we consider the following it jump - diffusion equation @xmath88 where @xmath89 and @xmath90 are standard wiener and poisson processes , respectively , all mutually independent , and @xmath91 is the closest point in the lattice @xmath92 to @xmath93 .",
    "thus , ( [ eq : hybrid ] ) describes a jump - diffusion markov process with infinitesimal generator @xmath94 defined by @xmath95 +   \\sum_{r=1}^{r}(1 - \\beta_r(\\mathbf{z } ) )   \\ , \\widetilde{\\lambda}_r(\\mathbf{z } ) \\",
    ", \\boldsymbol{\\nu}_r \\!\\cdot\\!\\nabla f(\\mathbf{z } ) \\nonumber \\\\",
    "\\frac{1}{2 } \\sum_{r=1}^{r } ( 1-\\beta_r(\\mathbf{z } ) ) \\,\\widetilde{\\lambda}_r(\\mathbf{z } ) \\,(\\boldsymbol{\\nu}_r\\otimes   \\boldsymbol{\\nu}_r )   : \\nabla\\nabla f(\\mathbf{z } ) , \\label{eq : hybrid_generator}\\end{aligned}\\ ] ] for all @xmath96 , where @xmath97 stands for the tensor product , and @xmath98 for square matrices @xmath99 and @xmath100 .",
    "the first term on the right hand side of ( [ eq : hybrid_generator ] ) captures the jump behaviour of the process , while the remaining two terms encode the effect of the diffusive dynamics .",
    "we see that in regions where @xmath101 the dynamics of the @xmath27-th reaction is modelled by a pure jump process .",
    "conversely , when @xmath102 the dynamics are purely diffusive , corresponding to cle dynamics . in intermediate regions",
    "where @xmath103 we obtain a mixture of the two .",
    "the rationale is to choose @xmath104 to be @xmath3 in regions where the cle provides a valid approximation of the biochemical system , and @xmath104 to be @xmath2 in regions where the diffusion approximation breaks down , i.e. in regions where the concentrations of certain species are low and the discrete behaviour becomes significant .",
    "an example of a trajectory is shown in figure [ fig : vanity ] , where the blue line depicts diffusive dynamics , while the red lines indicate jumps .",
    "we note that the process @xmath105 can still attain negative ( and thus non - physical ) states , however , @xmath106 is always non - negative .",
    "a natural interpretation is that one should consider the cell @xmath106 as the actual observed dynamics of the system , and the state of the underlying process @xmath105 is a hidden markov model which is not observed directly .",
    "[ t ]   starting from @xmath107 .",
    "red lines denote jump dynamics while blue lines cle dynamics .",
    "the black lines demarcate the `` blending '' region.__,title=\"fig : \" ]      the blending functions @xmath108 are to be considered as simulation parameters which are chosen to balance the trade - off between the computational cost of using the ssa and the error arising from the diffusion approximation . generally chosen so that langevin dynamics are only used in regions where",
    "the reactions are considered fast . since",
    "not all species are involved in every reaction , it is natural to choose each blending function differently . for a single species system ,",
    "a natural choice of blending function is the following piecewise linear function @xmath109 where @xmath110 are the boundaries between the different regions . with this choice of @xmath111",
    ", the hybrid process will perform purely jump dynamics for @xmath112 , purely diffusive dynamics for @xmath113 , and jump - diffusion in between .    for chemical systems with @xmath1 species we can construct blending functions for each reaction as follows .",
    "let @xmath114 be the set of chemical species involved in the @xmath27-th reaction ( both as reactants , and products of the reaction ) .",
    "then we can define @xmath115 , @xmath66 , as follows @xmath116 where @xmath117 , @xmath118 , are the boundaries for each individual chemical species .",
    "with this choice of blending function , when @xmath105 is in a state where one of the species involved in the @xmath27-th reaction is not abundant , the hybrid process will blend between jumps and diffusion to simulate the corresponding reaction .",
    "the choice of the boundaries @xmath119 and @xmath120 is important to correctly delineate between discrete and continuous behaviour . as will be seen in the numerical experiments in section  [ sec : dimer_steady_state ] , the accuracy of the scheme is dependent on the width of the blending region . if the blending region @xmath121 is small ( i.e. close to 1 ) , the step size for the discretised cle must be accordingly decreased to maintain constant error .",
    "while @xmath122 is a natural blending function for the typical biochemical systems where the diffusion approximation breaks down only close to the boundary of the positive orthant , for constrained systems , one must have jump dynamics near all the boundaries of the system .",
    "a typical example is the reversible isomerisation model @xmath123 which can be modelled as a single species birth - death process for @xmath99 with birth rate @xmath124 and death rate @xmath125 , where @xmath126 is the total molecule count .",
    "for such systems , an appropriate blending function would take value @xmath2 in neighbourhoods of both @xmath127 and @xmath128 .",
    "in this section we shall make explicit the regime in which the hybrid scheme correctly captures the dynamics of the original process , and subsequently derive weak error estimates for the expectation of observables at a finite time @xmath129 . let @xmath130 be the lattice of possible states . for most biochemical systems , we can make the following natural assumptions .",
    "the propensity functions satisfy @xmath131 for all @xmath132 , and @xmath133 if @xmath132 and @xmath134 .",
    "in particular , we are ensured that the jump process @xmath12 never attains a negative state .    for fixed @xmath129 , the set @xmath135\\rbrace$ ]",
    "is almost surely constrained within a bounded subset @xmath136 of @xmath137 .",
    "we note that the domain @xmath136 will depend on the initial condition @xmath138 .",
    "as it stands this assumption will not hold for general chemical reacting systems . under suitable conditions on the propensities it is possible to replace this assumption with a localization result showing that the probability of @xmath12 escaping the bounded set is exponentially small .",
    "we shall avoid this approach for simplicity , simply noting that one can always ensure this assumption by setting propensities to zero outside a fixed bounded region .",
    "chemical langevin dynamics @xmath81 are only a valid approximation of @xmath12 in the large volume limit .",
    "to study this regime , we introduce a system size @xmath139 which can be viewed as the ( dimensionless ) volume of the reactor . writing @xmath140 , we then rewrite the molecular copy number @xmath12 as @xmath141 where @xmath142 will be the vector of concentrations of each chemical species .",
    "we shall assume that each rate constant @xmath143 satisfies @xmath144 given this scaling assumption , we can always write the propensity for the @xmath27-th reaction , @xmath66 , as @xmath145 where @xmath146 is @xmath147 with respect to @xmath148 . using ( [ notrescaledgenerator ] ) , the generator of the rescaled process @xmath149 is given as follows : @xmath150 we now introduce the hybrid jump - diffusion scheme .",
    "to do so we must extend propensities @xmath151 from the discrete lattice @xmath152 to @xmath153 on the continuous space @xmath78 .",
    "we shall make the following assumptions on the extension .",
    "[ ass : extension_assumptions ] the following properties hold for the extended propensities",
    "@xmath154 :    1 .",
    "they are non - negative , and lie in @xmath155 .",
    "2 .   they are bounded , uniformly with respect to @xmath148 , and the same applies for their mixed derivatives up to order @xmath156 .",
    "3 .   for each @xmath13",
    ", @xmath154 is zero outside a bounded domain @xmath157 which contains @xmath158 .",
    "a @xmath155 extension of the propensities satisfying assumption @xmath159 is always possible . indeed , for each @xmath13 , set @xmath160 to be zero in @xmath161",
    ". then one can extend the value of the propensities to @xmath162 by transfinite interpolation , see  @xcite .",
    "such an extension may result in propensities which differ from the `` standard '' propensities typically used for the cle .",
    "in particular , propensities of the form @xmath163 must be modified so as to remain non - negative .",
    "such an explicit construction of extended propensities for unimolecular and bimolecular reactions of a single species can be found in  ( * ? ? ?",
    "* example 4.7 - 4.8 ) .",
    "using the extended propensities , one can extend the markov jump process @xmath149 to take initial conditions @xmath164 .",
    "the infinitesimal generator of @xmath149 is the natural extension of ( [ eq : generator_epsilon ] ) , also denoted by @xmath165 defined by @xmath166 ,      \\quad \\text{for all } \\ f \\in c_0(\\mathbb{r}^n).\\ ] ] for a fixed observable @xmath167 , define the value function @xmath168\\times\\mathbb{r}^n \\rightarrow \\mathbb{r}$ ] : @xmath169.\\ ] ] then @xmath170 can be expressed as the unique solution of the backward kolmorogov equation  @xcite @xmath171 for any fixed @xmath93 , equation ( [ eq : rescaled_kbe_u ] ) can be viewed as an infinite linear ode on the translated lattice @xmath172 . by assumption [",
    "ass : extension_assumptions ] the propensity is only non - zero for finitely many terms , thus the dynamics is characterised by a finite linear system of odes . existence and uniqueness of a solution @xmath170 in @xmath173 $ ] follows immediately .",
    "moreover , if @xmath174 is locally bounded , then so is @xmath170 .",
    "clearly , for @xmath93 such that @xmath175 for all @xmath27 we have @xmath176 , for all @xmath177 $ ] .    moreover , using assumption  [ ass : extension_assumptions ]",
    ", it follows that @xmath178 , such that the mixed derivatives can be expressed as the unique solutions of the following equations , where @xmath179 , @xmath180 and @xmath181 denote first , second and third spatial derivatives with respect to the variables @xmath182 , @xmath183 .",
    "@xmath184,\\ ] ] @xmath185 \\\\ \\notag        & \\quad + \\frac{1}{\\varepsilon}\\sum_{a , b\\in\\pi_2}\\sum_{r=1}^{r }   \\partial_a \\widetilde{\\lambda}^\\varepsilon_r(\\mathbf{x } )   \\left[\\partial_b u^\\varepsilon(t , \\mathbf{x }   + \\varepsilon \\boldsymbol{\\nu}_r ) - \\partial_b u^\\varepsilon(t , \\mathbf{x})\\right],\\end{aligned}\\ ] ] @xmath186 \\\\ \\notag & \\quad +   \\frac{1}{2\\varepsilon } \\sum_{a , b , c\\in\\pi_3}\\sum_{r=1}^{r } \\partial_{ab } \\widetilde{\\lambda}^\\varepsilon_r(\\mathbf{x } )   \\left [ \\partial_c u^\\varepsilon(t , \\mathbf{x }   + \\varepsilon \\boldsymbol{\\nu}_r )   - \\partial_c u^\\varepsilon(t , \\mathbf{x})\\right ] \\\\",
    "\\notag & \\quad + \\frac{1}{2\\varepsilon } \\sum_{a , b , c\\in\\pi_3}\\sum_{r=1}^{r } \\partial_a \\widetilde{\\lambda}^\\varepsilon_r(\\mathbf{x } )   \\left[\\partial_{bc } u^\\varepsilon(t , \\mathbf{x }   + \\varepsilon",
    "\\boldsymbol{\\nu}_r ) - \\partial_{bc }   u^\\varepsilon(t , \\mathbf{x})\\right],\\end{aligned}\\ ] ] where @xmath187 and @xmath188 denote the set of permutations of @xmath189 and @xmath190 , respectively .    given @xmath191 , and @xmath177 $ ] define the following scalar quantities @xmath192 then",
    ", there exists constants @xmath193 , @xmath194 and @xmath195 and @xmath196 , @xmath197 , and @xmath198 independent of @xmath148 such that @xmath199 for @xmath177 $ ] , where the @xmath193 , @xmath194 and @xmath195 depend on @xmath200 respectively , which by assumption @xmath201 are bounded independently of @xmath148 .    using ( [ eq : d1 ] )",
    ", we have @xmath202 where @xmath203 . \\label{f1def}\\ ] ] let @xmath204 be the semigroup associated with @xmath205 so that @xmath206.\\ ] ] clearly , if @xmath207 is bounded , then @xmath208 in particular , @xmath209 is bounded uniformly with respect to @xmath148 .",
    "it is straightforward to check that we can write the solution @xmath210 as @xmath211 ( \\mathbf{x } )   +   \\int_0^t p_{t - s } \\ , f_1^\\varepsilon(s , \\mathbf{x})\\,\\mbd s,\\ ] ] where @xmath212 is the fixed observable used as the initial condition in ( [ eq : rescaled_kbe_u ] ) .",
    "thus , @xmath213 since @xmath214 is @xmath215 , we have @xmath216   = \\int_0 ^ 1 a_r^\\varepsilon(t , \\mathbf{x }   + w \\ , \\varepsilon \\ , \\boldsymbol{\\nu}_r ) w\\,\\mbox{d}w.\\ ] ] substituting into ( [ f1def ] ) , we obtain @xmath217 therefore , using ( [ aqeest ] ) , we get @xmath218 so that @xmath219 similarly , @xmath220 where @xmath221 \\\\ & + \\frac{1}{\\varepsilon }   \\sum_{r=1}^{r } \\boldsymbol{\\nu}_q \\cdot \\nabla\\widetilde{\\lambda}_r^\\varepsilon(\\mathbf{x } ) \\left [ a_p^\\varepsilon(t , \\mathbf{x } + \\varepsilon \\boldsymbol{\\nu}_r )   - a_p^\\varepsilon(t , \\mathbf{x } ) \\right ] \\\\ &   + \\frac{1}{\\varepsilon } \\sum_{r=1}^{r }   \\boldsymbol{\\nu}_p \\cdot   \\nabla\\widetilde{\\lambda}_r^\\varepsilon(\\mathbf{x } )   \\left [ a_q^\\varepsilon(t , \\mathbf{x } + \\varepsilon \\boldsymbol{\\nu}_r )   - a_q^\\varepsilon(t , \\mathbf{x})\\right].\\end{aligned}\\ ] ] thus it follows that @xmath222(\\mathbf{x } )   + \\int_0^t p_{t - s } \\ , f_2^\\varepsilon(s , \\mathbf{x})\\,\\mbd s,\\ ] ] where @xmath223 it follows that @xmath224 which implies the second inequality in ( [ eq : uniform_bound ] ) by gronwall s inequality .",
    "the proof of the third inequality in ( [ eq : uniform_bound ] ) follows analogously .",
    "having extended the propensity function to take arbitrary values in @xmath78 we can now study the weak error that arises from taking the hybrid approximation in the large - volume limit .",
    "[ asblend ] we assume that the blending functions @xmath104 , @xmath225 satisfy @xmath226 and @xmath227 $ ] , for all @xmath93 .    given the extended propensities , we can apply the same large - volume rescaling to the hybrid process ( [ eq : hybrid ] ) to obtain a jump - diffusion @xmath228 given by @xmath229 where @xmath89 and @xmath90 are standard wiener and poisson processes , respectively , all mutually independent , and @xmath230 is the closest in @xmath152 to @xmath231 , or equivalently @xmath232 .",
    "the generator of this process is given by @xmath233   \\\\ + & \\sum_{r=1}^r \\left ( 1 - \\beta_r(\\mathbf{x } ) \\right ) \\",
    ", \\widetilde{\\lambda}_r^\\varepsilon(\\mathbf{x } )   \\ , \\boldsymbol{\\nu}_r\\cdot\\nabla f(\\mathbf{x } )   \\\\ + &   \\frac{\\varepsilon}{2 } \\sum_{r=1}^r \\left ( 1 - \\beta_r(\\mathbf{x } ) \\right ) \\ ,   \\widetilde{\\lambda}_r^\\varepsilon ( \\mathbf{x } ) \\ , ( \\boldsymbol{\\nu}_r\\otimes\\boldsymbol{\\nu}_r ) : \\nabla\\nabla f(\\mathbf{x}).\\end{aligned}\\ ] ] we now obtain a weak error estimate between the processes @xmath149 and @xmath228 in the large volume limit as @xmath234 .",
    "let blending functions satisfy assumption  @xmath235 .",
    "let @xmath167 , then there exists a constant @xmath236 , independent of @xmath148 , such that @xmath237   -   \\mathbb{e}_{\\mathbf{x}}\\left[{g(\\mathbf{z}^\\varepsilon(t ) ) } \\right ] \\big\\rvert   \\leq c \\varepsilon^2 , \\quad \\mbox { for } t \\in [ 0,t],\\ ] ] where @xmath238 .",
    "let @xmath239 $ ] and @xmath240 $ ] .",
    "we wish to obtain a bound on @xmath241 .",
    "then taking the derivative with respect to @xmath10 and using the fact that @xmath242 for all @xmath243 , we obtain @xmath244.\\end{aligned}\\ ] ] since @xmath214 is in @xmath155 , we can apply taylor s theorem up to the second order on @xmath245 to obtain @xmath246 where @xmath247 for some @xmath248 lying on the line between @xmath231 and @xmath249 .",
    "from ( [ eq : ereq ] ) and the fact that @xmath250 , it follows that @xmath251 where @xmath252 is the semigroup operator corresponding to @xmath228 .",
    "applying the uniform bound ( [ eq : uniform_bound ] ) we thus have that @xmath253.\\ ] ]    the remainder term @xmath254 in equation ( [ eq : ereq ] ) characterises the local error at the point @xmath231 .",
    "we note that it is non - zero only in regions where @xmath255 .",
    "intuitively we would expect this to imply that @xmath228 is a superior approximation to the standard cle .",
    "however , the global error estimate we derived is too coarse to capture the distinction between the two diffusion approximations , and thus we have only shown that the two approximations are consistent : in that the hybrid scheme does no worse than the cle in the large - volume limit .",
    "equation ( [ eq : hybrid ] ) provides a general framework for simulating chemical systems which can capture both the discrete and continuum nature of a biochemical system . any numerical scheme which can generate realisations of a jump - diffusion process with inhomogeneous jump rates with deterministic jump sizes",
    "can be used to simulate ( [ eq : hybrid ] ) . for illustrative reasons we describe three different possible numerical schemes , the first based on the gillespie ssa and the second based on the modified next reaction method proposed in  @xcite , and discussed in section [ sec : prelims ]",
    "finally , we describe an alternative scheme based on adaptive thinning which works well for systems with bounded blending regions .",
    "the main difference between the purely jump case ( where these algorithms have been applied before ) and is the fact that in the blending region the propensity functions do not remain constant between two consecutive reactions . for the sake of clarity ,",
    "given the propensities @xmath256 and blending functions @xmath257 define @xmath258 pseudocodes of each approach are given as algorithms [ alg : hybrid ] , [ alg : hybrid1 ] and [ alg : hybrid3 ] .",
    "they all have the same input , namely propensities @xmath259 , blending functions @xmath260 , the stoichiometric matrix @xmath261 , the final time of simulation @xmath262 , time steps for the cle @xmath263 and @xmath264 ( here , @xmath265 ) and initial state @xmath266 .",
    "set @xmath267 .",
    "+      the steps to simulate the jump - diffusion process based on an extension of the gillespie ssa are described in algorithm [ alg : hybrid ] . as we can see in regions where @xmath268 are @xmath2",
    ", the scheme reduces to the standard gillespie ssa , and thus simulates the discrete dynamics exactly .",
    "analogously , in regions where @xmath269 are all zero one can use a larger time - step @xmath264 to evolve cle since it is not necessary to approximate the solutions of in such regions , which can only be done with @xmath270 accuracy . in the intermediate regime for the continuous part of the dynamics the following cle",
    "is used @xmath271 if during the cle time step @xmath272 a discrete event is occurring at time @xmath45 we simulate the cle up to that time and then add the discrete event .    to simulate the diffusion part of the hybrid scheme we make use of the weak trapezoidal method described in  @xcite .",
    "given the current state @xmath273 we perform the following two steps to obtain @xmath274 : @xmath275^{+ } } \\boldsymbol{\\nu}_j \\,\\xi'_j,\\end{aligned}\\ ] ] where @xmath276 @xmath277^{+ } = \\max\\left(0 , a\\right)$ ] and @xmath278 , @xmath279 are mutually independent standard gaussian random variables .",
    "a second algorithm , based on @xcite , for simulating is described in algorithm  [ alg : hybrid1 ] .",
    "while it is entirely equivalent to the standard next reaction method , the modified scheme keeps explicit track of the internal times @xmath280 and the next firing time @xmath281 of each poisson process @xmath282 which simplifies integrating diffusion steps into the scheme .",
    "we note that the hybrid scheme described in @xcite also employs a similar discretisation . again in the presence of diffusion , it is no longer true that the propensity @xmath283 is constant from @xmath10 until the next reaction .",
    "computing the next reaction time is equivalent to solving the following first passage time problem : @xmath284 in algorithm  [ alg : hybrid1 ] , we use an euler discretization of @xmath285 .    generate @xmath5 independent , @xmath286 $ ] random numbers @xmath287 , @xmath288 . +",
    "set @xmath267 .",
    "set @xmath289 and @xmath290 , for each @xmath288 .",
    "+ compute the weighted propensities @xmath291 .",
    "+      in the special case where one can bound the value of the weighted propensities @xmath292 , it is possible to use a third method , based on standard thinning methods for sampling inhomogeneous poisson processes , see for example  @xcite and more recently  @xcite . the main advantage of this scheme would be that it avoids the necessity to approximate the solution of the first passage time problem associated with the modified next reaction method , thus being potentially more efficient . while one can find such bounds for many chemical systems , the added caveat is that the bounds must be known a priori , and choosing them too loosely",
    "will severely degrade the performance of the scheme .    to this end",
    ", we shall assume that there exist constants @xmath293 , where @xmath294 these constants will form the additional input of algorithm  [ alg : hybrid3 ] .",
    "suppose that @xmath295 for some @xmath27 . to compute the next jump time of the @xmath27-th reaction",
    ", we sample from a dominating homogeneous process with rate @xmath296 , so that the next jump time for the @xmath27-th reaction occurs at time @xmath297 where @xmath298.\\ ] ] suppose that @xmath299 is the first jump occurring after the current time @xmath10 . to determine whether the reaction @xmath27 will occur at time @xmath297 , we sample @xmath300 $ ] and perform the reaction only if @xmath301 where @xmath302 is the state of the process after simulating the langevin dynamics from time @xmath10 to @xmath297 .",
    "this thinning approach can be integrated into the gillespie ssa , demonstrated in algorithm [ alg : hybrid3 ] . at each timestep",
    ", three cases can occur . if @xmath303 ( i.e. the process @xmath12 is a pure jump process ) we use the standard gillespie ssa .",
    "if @xmath304 ( i.e. the process is purely diffusive ) , then we perform a `` macro - step '' of the cle dynamics of size @xmath264 .",
    "the final case is where there is both diffusion and jumps , we simulate the homogeneous dominating process with rate @xmath305 , and accept / reject according to condition  ( [ eq : thinning_condition ] ) .",
    "the main advantage is that we avoid the error arising from the piecewise constant approximation of integral @xmath306 .",
    "in particular , one can use higher order methods for simulating the langevin dynamics within the blending region to obtain a better weak order of convergence in @xmath263 .",
    "the drawback of this approach is the necessity to know _ a priori _ the upper bounds @xmath296 , assuming such bounds exist .",
    "care must be taken so that the bounds are not too pessimistic , otherwise the dominating homogeneous poisson process will fire very rapidly when the system lies within a blending region . in such cases",
    "the bounds can be tuned by running exploratory simulations and keeping track of the acceptance rate for each reaction .",
    "set @xmath267 .",
    "we illustrate the main features of the hybrid framework described in section [ subsec : stoc_fram ] and demonstrate the use of algorithms [ alg : hybrid ] , [ alg : hybrid1 ] and [ alg : hybrid3 ] by considering three numerical examples .",
    "each of these examples were implemented in the programming language julia  @xcite .      as a first example , we consider a chemical system consisting of two reacting chemical species @xmath99 and @xmath100 undergoing the following reactions @xmath307 the chemicals @xmath99 and @xmath100 can be considered to be in a  predator - prey \" relationship with @xmath99 and @xmath100 as prey and predator , respectively .",
    "the reaction - rate equations corresponding to reactions ( [ eq : lotka ] ) would then be the standard lotka - volterra model .",
    "we choose the dimensionless parameters @xmath308 @xmath309 and @xmath310 the initial condition is chosen to be @xmath311 and @xmath312 .",
    "a histogram generated from @xmath313 independent ssa simulations of this system up to time @xmath314 is shown in figure  [ fig : lotka1 ] . the dashed line depicts the evolution of the deterministic reaction rate equation starting from the same initial point .",
    "one sees that the nonequilibrium dynamics force the system to spend time in both low and high concentration regimes . due to the time spent in states with high propensity ,",
    "the ssa is computationally expensive to simulate .",
    "it is clear that away from the boundary , using an approximation such as the cle would be computationally beneficial .",
    "the cle corresponding to ( [ eq : lotka ] ) , choosing the multiplicative noise as described in @xcite , is given by @xmath315 where @xmath316 , @xmath317 and @xmath318 , are three standard independent brownian motions .",
    "for a non - negative initial condition , the process @xmath319 will remain nonnegative , however , this will not be the case for fixed - timestep discretisation .",
    "in particular , an euler discretisation ( @xmath320 will contain a term of the form @xmath321 , where @xmath322 is a standard gaussian random variable , which can cause the discretised process to cross the @xmath323 axis if the process sufficiently close to this line . thus , it is essential that reflective boundary conditions are imposed to ensure positivity .",
    "however , even if positivity is guaranteed , there is no reason to believe that the cle will correctly approximate the dynamics near the axes .",
    "this motivates the use of the hybrid model to efficiently simulate this chemical system .    to simulate the hybrid model we use algorithm [ alg : hybrid ] , choosing blending functions @xmath324 , @xmath325 and @xmath326 as described in ( [ eq : multi_species_blending ] ) .",
    "we simulate the langevin dynamics in the blending region using a timestep of size @xmath327 , and a timestep @xmath328 outside the blending regions . in figure",
    "[ fig : lotka_timedep](a ) , we plot @xmath329 at times @xmath330 , generated from @xmath331 independent realisations of each model .",
    "error bars denote @xmath332 confidence intervals .",
    "the hybrid models were simulated for different values of @xmath333 and @xmath334 , @xmath335 , however , the results were not plotted as the monte carlo error was too large to distinguish between the schemes . the hybrid scheme displayed in figure  [ fig : lotka_timedep](a ) has blending regions with parameters @xmath336 and @xmath337 .",
    "while all models agree approximately at small times , for larger @xmath262 the averages generated from ssa and cle differ significantly . indeed , for @xmath338 ( corresponding to a single period of the deterministic system ) the means from",
    "the ssa and cle differ by three orders of magnitude . on the other hand ,",
    "the hybrid scheme remains in good agreement with the ssa . in figure",
    "[ fig : lotka_timedep](b ) we compare the average computational ( cpu ) time to simulate each model up to time @xmath262 , averaged over @xmath331 realisations .",
    "this was measured in seconds , using the standard julia functions tic and toc .",
    "the computational cost of the hybrid scheme was plotted for three different choices of blending regions namely @xmath339 , @xmath340 and @xmath341 , respectively . for small @xmath262",
    "the ssa and hybrid schemes require a comparable amount of computational effort .",
    "however , as @xmath262 increases , the computational cost of the ssa scheme dramatically increases , while the cost of the hybrid scheme remains approximately constant . to compute the average value at time @xmath342 ,",
    "the hybrid scheme was on average @xmath4 orders of magnitude cheaper to run .",
    "as expected , the computational effort is smaller when the blending region is closer to the boundary .",
    "however , relative to the computational cost of the ssa and cle , varying the blending region does not significantly alter performance .",
    "for these simulations , the value of @xmath263 and @xmath264 where chosen manually by computing the error for a number of short exploratory runs",
    ". a more sophisticated implementation of the hybrid model would require an adaptive scheme for the langevin part of the process .",
    "ssa simulations of @xmath343 up to time @xmath344 starting from @xmath311 and @xmath312 . the dashed line is the solution of the corresponding deterministic reaction rate equations._,scaledwidth=75.0% ]     as a function of @xmath262 for the ssa , cle and hybrid schemes ; _ ( b ) _ the corresponding average computational ( cpu ) time in seconds as a function of @xmath262._,title=\"fig:\",scaledwidth=46.0% ]   as a function of @xmath262 for the ssa , cle and hybrid schemes ; _ ( b ) _ the corresponding average computational ( cpu ) time in seconds as a function of @xmath262._,title=\"fig:\",scaledwidth=46.0% ]    -4.6 cm      as a second example , we consider a chemical system consisting of two species @xmath99 and @xmath100 in a reactor of volume @xmath6 .",
    "the species are subject to the following system of four chemical reactions  @xcite : @xmath345 this corresponds to a jump process @xmath12 having stoichiometric vectors @xmath346 with corresponding propensities ( depending on the volume @xmath6 ) : @xmath347 the dimensionless reaction rates are given by @xmath348 , @xmath349 , @xmath350 and @xmath351 .",
    "as a first numerical experiment , we compute the evolution of the distribution of @xmath352 over time .",
    "we assume that @xmath353 , and that the initial distribution is a `` discrete '' gaussian mixture , namely the gaussian mixture @xmath354 restricted to the lattice @xmath355 . for each scheme ( ssa , cle and hybrid )",
    ", the distribution is approximated by a histogram generated from @xmath356 independent realisations of the process .",
    "the cle was simulated using the weak second order trapezoidal scheme described in @xcite . to ensure positivity of the cle",
    ", reflective boundary conditions were imposed at the boundary of the orthant .",
    "the hybrid scheme was simulated the hybrid next reaction scheme detailed in algorithm [ alg : hybrid1 ] .",
    "the timestep was chosen to be @xmath357 .",
    "the blending functions for the hybrid scheme were chosen according to ( [ eq : multi_species_blending ] ) , with @xmath358 and @xmath359 . in figure",
    "[ fig : dimer_timedep ] we plot the distribution approximated using each scheme at times @xmath360 and @xmath361 . as expected ,",
    "when the concentrations of @xmath99 and @xmath100 remain abundant , all three models agree .",
    "as the distribution approaches the low concentration regions , the discrete nature of the chemical system becomes important , and the cle is no longer able to correctly capture the dynamics .",
    "indeed , at time @xmath361 one observes a significant difference between the ssa and cle distributions . on the other hand",
    ", the hybrid scheme provides a good approximation to the ssa at all times , but benefiting from a computational advantage in the large concentration regimes .",
    "[ htp ]   using ssa , cle and the hybrid scheme starting from initial distribution @xmath362 given by @xmath363._,title=\"fig : \" ]    the corresponding markov jump process @xmath12 can be shown to possess a unique stationary steady state  @xcite .",
    "we use all three models to compute the first two moments @xmath364 and @xmath365 of the stationary distribution , for decreasing values of @xmath6 .",
    "the moments were approximated using ergodic average of the discretised schemes , i.e. @xmath366 where @xmath367 is the value of the discretised process at time @xmath368 and @xmath369 are the jump times of the process .",
    "each process was simulated up to time @xmath370 . for the hybrid and cle schemes a timestep of @xmath371 was used throughout .",
    "the blending region was chosen as in the previous example .",
    "the first and second moment are plotted in figure [ fig : dimer_stat ] for @xmath372 where @xmath373 .",
    "while there is good agreement between all three schemes for @xmath6 large , the cle consistently overestimates the moments when @xmath6 is small . on the other hand ,",
    "the hybrid scheme remains robust to this rescaling .     with parameters as in figure  @xmath374 for @xmath372 for @xmath373 .",
    "_ ( b ) _ comparison of the second moments as a function of @xmath6._,title=\"fig:\",scaledwidth=46.0% ]   with parameters as in figure  @xmath374 for @xmath372 for @xmath373 . _",
    "( b ) _ comparison of the second moments as a function of @xmath6._,title=\"fig:\",scaledwidth=46.0% ]    -4.6 cm      as a final example , we consider the problem of computing the mean extinction time ( met ) for a one - dimensional birth - death process , namely a system two reactions for one chemical species @xmath99 : @xmath375 by assuming that @xmath376 for all @xmath377 , the state of the system lies within the finite domain @xmath378 . for @xmath379 , the birth - death process will hit the extinction state @xmath380 with probability @xmath2 .",
    "we denote by @xmath381 the met of the process starting from @xmath382 .",
    "following directly the approach of  ( * ? ? ?",
    "* section 2.1 ) ( also see  @xcite ) , we obtain @xmath383 the corresponding cle is given by @xmath384 for standard independent brownian motions @xmath316 and @xmath317 .",
    "the mean first time of @xmath385 reaching @xmath3 starting from @xmath386 can be calculated explicitly as @xmath387 where @xmath388 is the potential @xmath389 since @xmath390 is a unique solution of @xmath391 , the stochastic birth - death process will fluctuate around @xmath392 for a long time before eventually going extinct . in general , we expect that any approximation which correctly describes the extinction time behaviour of the birth - death process must accurately capture the behaviour of the process particularly near @xmath393 and @xmath394 ( and possibly all points in between ) .",
    "if @xmath392 is large , then a gaussian approximation ( e.g. cle or the system size expansion ) would accurately capture the fluctuations around the quasi - equilibrium .",
    "however , as observed in @xcite such approximations would suffer close to @xmath393 .",
    "this suggests that the hybrid scheme with a blending region supported between @xmath393 and @xmath394 would be a good candidate for an approximation to the process .",
    "similar observations have been in more general chemical systems  @xcite , where it is observed that diffusion approximations of jump processes are not able to correctly capture rare events , even when the system is in a regime where the cle correctly captures both the transient and stationary dynamics of the process .    to test the hybrid scheme for met problems ,",
    "we consider the above birth - death process @xmath12 with @xmath395 , so that @xmath396 .",
    "we compute the mean time of the birth - death process starting from @xmath392 to extinction .",
    "following the discussion at the end of section [ sec : prelims ] , the hybrid scheme is considered extinct when the process satisfies @xmath397 .",
    "we choose the blending functions according to ( [ eq : multi_species_blending ] ) , simulating the process for different values of @xmath333 and @xmath334 .",
    "since the blending region is bounded , we can use the thinning - based algorithm [ alg : hybrid3 ] to simulate the jump - diffusion process within the blending region , choosing @xmath398 and @xmath399 .",
    "a timestep of @xmath400 is chosen throughout .    in figure",
    "[ fig : mfpt_bd ] , we plot the met of the hybrid scheme for varying @xmath401 , each point generated from @xmath402 independent realisations , and for different choices of blending regions .",
    "the met for the cme and cle , computed directly from ( [ eq : bd_mfpt ] ) and ( [ eq : bd_cle_mfpt ] ) , respectively , are shown for comparison .",
    "it is evident from the numerical experiments that the hybrid scheme provides a better approximation for the mer compared to the cle .",
    "however , the improvement is not uniform over all timescales : the region in which the jump process is simulated must be increased to correctly capture rare events .",
    "figure [ fig : mfpt_bd ] suggests that the width of the blending region also plays a role in the simulation .",
    "indeed , a blending region with @xmath403 appears to be sufficient to accurately estimate the met up to @xmath404 , although it is likely this approximation will break down , if @xmath401 is increased further .",
    "the necessity of tuning the blending region to capture the escape time dynamics is a disadvantage .",
    "nonetheless , the hybrid scheme provides us with an approach for improving the met estimate obtained from the cle , at the `` cost '' of having to simulate discrete jumps in ( increasingly large ) regions of the domain .    , the corresponding cle @xmath405 and the hybrid scheme .",
    "the parameters used are @xmath406 and @xmath407 and the process is started from @xmath408 .",
    "we use : _ ( a ) _ blending regions of width @xmath2 ; _ ( b ) _ blending regions of width @xmath4 .",
    "_ , title=\"fig:\",scaledwidth=46.0% ] , the corresponding cle @xmath405 and the hybrid scheme .",
    "the parameters used are @xmath406 and @xmath407 and the process is started from @xmath408 .",
    "we use : _ ( a ) _ blending regions of width @xmath2 ; _ ( b ) _ blending regions of width @xmath4 .",
    "_ , title=\"fig:\",scaledwidth=46.0% ]    -4.6 cm",
    "in this paper we have introduced a jump - diffusion model for simulating multiscale reaction systems efficiently while still accounting for the discrete fluctuations where necessary .",
    "fast reactions are simulated using the cle , while the standard discrete description is used for slow ones .",
    "our approach involves the introduction of a set of blending functions  ( [ eq : multi_species_blending ] ) which allow one to make explicit in which regions the continuum approximation should be expected to hold .",
    "based on the representation of the markov jump process as a time changed poisson process , we described three different schemes , based on @xcite to numerically simulate the jump - diffusion model in the three different regimes ( discrete , continuous and hybrid ) . to demonstrate the efficacy of the schemes , we simulated equilibrium distributions of chemical systems and computed extinction times of chemical species for illustrative chemical systems .",
    "the results suggest that the proposed algorithm is robust , and is able to handle multiscale processes efficiently without the breakdown associated when using the cle directly .",
    "the research leading to these results has received funding from the european research council under the _",
    "european community _ s seventh framework programme ( _ fp7/2007 - 2013_)/erc _ grant agreement _",
    "n@xmath409 239870 .",
    "radek erban would also like to thank the royal society for a university research fellowship and the leverhulme trust for a philip leverhulme prize .",
    "andrew duncan was also supported by the epsrc grant ep / j009636/1 .",
    "10 url # 1`#1`urlprefixhref # 1#2#2 # 1#1                      g.  klingbeil , r.  erban , m.  giles , p.  maini , fat vs. thin threading approach on gpus : application to stochastic simulation of chemical reactions , ieee transactions on parallel and distributed systems 23  ( 2 ) ( 2012 ) 280 - 287 .",
    "r.  erban , s.j .",
    "chapman , i.  kevrekidis , t.  vejchodsk , analysis of a stochastic chemical system close to a sniper bifurcation of its mean - field model , siam journal of applied mathematics 70  ( 3 ) ( 2009 ) 9841016 .",
    "l.  ferm , p.  ltstedt , p.  sjberg , adaptive , conservative solution of the fokker - planck equation in molecular biology , technical report , available as http://www.it.uu.se/research/reports/2004-054 ( 2004 ) .",
    "b.  mlykti , k.  burrage , k.  zygalakis , fast stochastic simulation of biochemical reaction systems by alternative formulation of the chemical langevin equation , journal of chemical physics 132  ( 16 ) ( 2010 ) 164109 .                          c.  doering , k.  sargsyan , l.  sander , extinction times for birth - death processes : exact results , continuum asymptotics , and the failure of the fokker - planck approximation , multiscale modeling & simulation 3  ( 2 ) ( 2005 ) 283299 ."
  ],
  "abstract_text": [
    "<S> stochasticity plays a fundamental role in various biochemical processes , such as cell regulatory networks and enzyme cascades . </S>",
    "<S> isothermal , well - mixed systems can be modelled as markov processes , typically simulated using the gillespie stochastic simulation algorithm ( ssa )  @xcite . </S>",
    "<S> while easy to implement and exact , the computational cost of using the gillespie ssa to simulate such systems can become prohibitive as the frequency of reaction events increases . </S>",
    "<S> this has motivated numerous coarse - grained schemes , where the `` fast '' reactions are approximated either using langevin dynamics or deterministically . while such approaches provide a good approximation when all reactants are abundant , the approximation breaks down when one or more species exist only in small concentrations and the fluctuations arising from the discrete nature of the reactions becomes significant . </S>",
    "<S> this is particularly problematic when using such methods to compute statistics of extinction times for chemical species , as well as simulating non - equilibrium systems such as cell - cycle models in which a single species can cycle between abundance and scarcity . in this paper , a hybrid jump - diffusion model for simulating well - mixed stochastic kinetics </S>",
    "<S> is derived . </S>",
    "<S> it acts as a bridge between the gillespie ssa and the chemical langevin equation . for low reactant reactions </S>",
    "<S> the underlying behaviour is purely discrete , while purely diffusive when the concentrations of all species is large , with the two different behaviours coexisting in the intermediate region . </S>",
    "<S> a bound on the weak error in the classical large volume scaling limit is obtained , and three different numerical discretizations of the jump - diffusion model are described . </S>",
    "<S> the benefits of such a formalism are illustrated using computational examples .    </S>",
    "<S> chemical master equation , chemical langevin equation , jump - diffusion process , hybrid scheme . </S>"
  ]
}