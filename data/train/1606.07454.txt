{
  "article_text": [
    "in molecular systems the interplay between the localized ( strongly correlated ) and delocalized ( weakly correlated ) electrons is the chief reason causing a difficulty in describing these systems since a robust quantum chemistry method has to be able to treat both types of electrons simultaneously with a comparable effectiveness and yield molecular energies reaching chemical accuracy .",
    "similar challenges are faced by condensed matter methods where both itinerant and localized electrons present in a solid have to be accounted for by a computational method that yields thermodynamic quantities and spectra .    in quantum chemistry , complete active space",
    "second order perturbation theory ( caspt2 )  @xcite , @xmath0-electron valence state second - order perturbation theory ( nevpt2 )  @xcite , multi - reference coupled cluster ( mrcc ) @xcite , multi - reference configuration interaction ( mrci )  @xcite , and multi - configurational density functional theory ( mc - dft )  @xcite belong to a class of methods capable of addressing the problem of strongly correlated electrons in the presence of weakly correlated ones .",
    "these are primarily wavefunction methods that are at least in principle systematically improvable and aim to produce very accurate energies for the ground state and couple of low - lying excited states .    in condensed matter community when solids are described by a realistic hamiltonian , dynamical mean - field theory ( dmft )  @xcite on top of gw  @xcite method ( gw+dmft )  @xcite formulated in many - body green s function language is the primary tool to describe the intricate nature of realistic systems and give information about the spectral function and thermodynamic properties .",
    "a natural direction is to find a common ground between approaches present in different communities and create a method that could yield not only thermodynamic quantities and spectra but also a satisfactory chemical accuracy while using the green s function language .",
    "we have developed the self - energy embedding theory ( seet )  @xcite where the self - energy describing couple of strongly correlated orbitals is embedded into the self - energy coming from the weakly correlated orbitals present in the physical problem .",
    "consequently , seet is a hybrid approach where we use two green s function methods , a weekly correlated and strongly correlated ones . the second order green s function ( gf2 )  @xcite method is used as a weakly correlated approach presenting a useful compromise between the computational cost and accuracy .",
    "we have demonstrated that gf2 can describe moderately correlated systems well  @xcite , can be successfully used to find strongly correlated orbitals , and can deliver information about periodic systems  @xcite and their thermodynamic properties  @xcite .",
    "the accurate correlated method that is used to describe a chosen set of strongly correlated orbitals is in our case a quantum impurity solver based on configuration interaction ( ci ) with various levels of wavefunction truncation  @xcite .",
    "we have applied seet to the 2d hubbard model  @xcite and small molecular problems  @xcite obtaining in both cases excellent results when compared against other established methods . for the 2d hubbard model at half- and away from half - filling ,",
    "seet self - energies matched very well the self - energies obtained from the continuous time auxiliary field quantum monte carlo ( ct - qmc )  @xcite calculations at all interaction strengths analyzed . in ref .",
    "using molecular examples , we have demonstrated that seet , which is a perturb and diagonalize scheme , can reach a level of accuracy that is comparable to other quantum chemistry methods such as nevpt2 and caspt2 .",
    "moreover , we have shown that seet has potential to be extended to periodic systems since in contrast to nevpt2/caspt2 it does not require preparing one- , two- , three- or four - body reduced density matrices and only one - body green s function and self - energy are sufficient to perform all calculations .",
    "additionally , seet in the ci - in - gf2 variant does not suffer from the intruder state problem resulting in denominator divergences present in caspt2 .    in this paper",
    ", we are further examining all the aspects of seet and we are focusing on describing all the requirements that have to be fulfilled to make seet systematically improvable and applicable to a wide variety of systems .",
    "we base our discussion on the molecular systems where the near exact ( or very accurate ) solutions at zero temperature are known from variety of methods such as density matrix renormalization group ( dmrg )  @xcite or nevpt2/caspt2 .",
    "these simple benchmark systems allow us to establish the best way of treating molecular systems using green s function methods .",
    "this paper is organized in the following way . in sec .",
    "[ sec : seet_theory ] , we present a theoretical motivation behind seet . in sec .",
    "[ gf2_non_local ] , we describe the gf2 theory that allows us to produce the self - energy for the weakly correlated orbitals . subsequently , in sec .",
    "[ screening_seet ] , we proceed to explaining how seet is related to dmft - type approaches that use on - site effective interactions .",
    "seet can be executed using various strongly correlated orbital selection schemes either based on energy or spatial criteria as discussed in sec .",
    "[ orb_basis ] . to ensure that very high accuracy and systematic improbability is maintained during seet calculations , it is essential to use green s function quantum impurity solvers that can describe full realistic hamiltonian in the impurity orbitals .",
    "we discuss possible implication of this fact in sec .",
    "[ realistic_impurity_solvers ] . finally , we present numerical results in sec .",
    "[ results ] and conclude this paper in sec .",
    "[ conclusions ] .",
    "let us assume that we would like to calculate properties of a realistic system described by a hamiltonian @xmath1 where @xmath2 and @xmath3 are the one- and two - body integrals in an orbital basis that can be either orthogonal or non - orthogonal .",
    "many realistic systems are correlated enough that low - level many - body methods can not describe them with sufficient accuracy .",
    "while high - level many - body methods can deliver accurate answers , for many interesting systems the total number of orbitals @xmath4 may be too large to compute the whole problem using a high - level method .",
    "however , for most realistic cases only few orbitals contribute significantly to the physics or chemistry of the total problem .",
    "consequently , these physically or chemically important orbitals , which we will call active or strongly correlated orbitals , can be described by a high - level method , while all the other inactive or weakly correlated orbitals can be described by a lower level method .",
    "the separation of the orbital space into active and inactive or strongly and weakly correlated orbitals implies in the green s function language that we will express the self - energy of the strongly correlated orbitals @xmath5 and @xmath6 as @xmath7_{uv}=[\\mathbf{\\sigma}^{low - level}_{non - local}]_{uv}+[\\mathbf{\\sigma}^{high - level}_{local}]_{uv},\\end{aligned}\\ ] ] where a given self - energy matrix element @xmath8_{uv}$ ] is composed out of the local self - energy described by a high - level theory embedded into the self - energy described by a low - level theory .",
    "we assume that the self - energy contains both the frequency dependent and independent parts , @xmath9 .",
    "note that the separation of the self - energy presented in eq .",
    "[ eq : se_separation ] is characteristic for embedding methods and thus is general without necessarily specifying how the low- and high - level self - energies are evaluated in practice . here ,",
    "few major routes exist * ( i ) * either by a variational minimization of the free energy functional ( that depends on the self - energy and green s function ) , * ( ii ) * by an explicit construction of the diagrammatic series necessary to represent different parts of the self - energy , * ( iii ) * or by perturbative construction that allows for updating the hybridization between the embedded system and the environment .",
    "clearly while multitude of approximations are possible , the choice of a particular route should depend on the physics of the system under study .    in our two previous papers  @xcite and in this paper",
    ", we use the third option and construct an impurity model for the strongly correlated orbitals that then has its self - energy evaluated in dmft - type iterations ; however , we would like to stress that the self - energy partitioning is general and our choice of evaluating the two parts of self - energy is one of many possible choices .",
    "the separation of the self - energy contributions allows us to evaluate the non - local part of the self - energy at a perturbative , inexpensive level , while the local , strongly correlated part is expressed as an impurity problem and is evaluated with a more accurate method .",
    "consequently , one of the most important questions is how to choose orbitals that are strongly correlated and ought to be treated by a higher level method . to make such a choice based on the physics and not only our intuition , we first perform a low - level perturbative calculation and analyze occupations , energy , or spatial domains of the orbitals involved .",
    "the details of such a procedure will be discussed in subsection  [ orb_basis ] .    for now , let us assume that using one of the possible criteria ( orbital occupations , energies , or spatial domains ) , we have chosen the active ( strongly correlated ) orbitals that we denote @xmath10 , while @xmath11 are the inactive ( weakly correlated ) orbitals , and @xmath12 stands for a bath orbital index .",
    "we define the active space green s function as @xmath13^{-1 } ,   \\end{aligned}\\ ] ] where subscript @xmath14 stands for the active space .",
    "a molecular fock matrix without double counting is denoted as @xmath15 .",
    "the double counting between the mean - field and high - level treatments in the active space is removed since the mean - field coulomb interaction in the active space is exactly subtracted .",
    "explicitly , the above operation is given by @xmath16 where @xmath17 is the one - body density matrix obtained from a perturbative method .",
    "note that the chemical potential has been included in the one - body electron integral matrix , @xmath18 , for convenience .",
    "seet is general and multiple perturbative methods such as gf2 , gw , or flex  @xcite , etc .",
    "can be used to describe the inactive orbitals and deliver initial density and fock matrices describing all the orbitals .",
    "we have chosen to use gf2 since it contains an exchange diagram that is important for reaching the chemical accuracy in molecular systems .",
    "the details of the gf2 procedure will be listed in subsection  [ gf2_non_local ] . in gf2 ,",
    "the one - body density matrix @xmath19 is obtained using eq .",
    "[ eq : gf2 dm ] .",
    "the hybridization @xmath20 from eq .",
    "[ eq : gfimp ] describes the coupling of the active orbitals to the remaining weakly correlated ones .",
    "while at later iterations the active space green s function and self - energy are evaluated by a more accurate many - body methods , at the first iteration of seet , to initialize these matrices , we express them as sub - matrices of the gf2 green s function and self - energy in the subset of active orbitals , @xmath21_{act } \\label{eq : gf2actgf}\\\\    \\boldsymbol{\\sigma}_{act}(i\\omega)=[\\boldsymbol{\\sigma}^{gf2}(i\\omega)]_{act } \\label{eq : gf2actse } \\ .\\end{aligned}\\ ] ] the initial hybridization is then computed by substituting @xmath22 and @xmath23 into eq .",
    "[ eq : gfimp ] .    the infinite , continuum bath that describes the hybridization can be approximated by a finite , discrete one .",
    "a finite number of bath orbital energies @xmath24 and the impurity - bath couplings @xmath25 are then fitted to the hybridization @xmath20 , @xmath26 in order to produce the impurity hamiltonian .    to compute the active space green s function from eq .",
    "[ eq : gfimp ] using quantum impurity solvers that need an explicit hamiltonian formulation , one needs to formulate the anderson impurity hamiltonian as follows  @xcite @xmath27 where @xmath28 is the full active space hamiltonian @xmath29 where @xmath30 describes the non - interacting bath , and @xmath31 stands for the coupling between the active space and non - interacting bath , @xmath32    multiple numerical methods have been developed to solve the impurity hamiltonian from eq .",
    "[ eq : imph ] .",
    "quantum chemistry approaches that use an explicit hamiltonian formulation and properly capture strong correlations in the active space can be extended to become green s function impurity solvers .",
    "a discussion concerning the exact diagonalization ( ed ) or full configuration interaction ( fci ) solvers and a later class of solvers based on a truncated configuration interaction ( ci ) or restricted active space configuration interaction ( rasci ) approaches can be found in refs .  .",
    "we employ a rasci solver in seet if the total number of orbitals ( impurity + bath ) in the impurity hamiltonian exceeds 16 orbitals and is intractable with fci .",
    "this quantum chemistry rasci solver that works with hamiltonians containing general two - body interactions is important since it allows us to achieve chemical accuracy in molecular _ ab initio _ seet .    as an alternative to the ci solvers ,",
    "the continuous time quantum monte carlo ( ct - qmc ) methods , which introduce an explicit temperature - dependence can also be used with seet . in subsection  [ realistic_impurity_solvers ] , we will discuss in more details how realistic interactions impact the impurity problem and solvers .",
    "after obtaining the active space green s function using the impurity hamiltonian from eq .",
    "[ eq : imph ] , the active space self - energy is evaluated using the dyson equation . combining the non - local self - energy obtained from a perturbative method ( e.g. gf2 ,",
    "[ eq : gf2nl ] ) and the active space self - energy obtained from a high level many - body method , we construct the molecular self - energy for strongly correlated orbitals as @xmath33_{uv } = [ \\boldsymbol{\\sigma}^{gf2}_{non - local}(i\\omega)]_{uv } + [ \\boldsymbol{\\sigma}_{local}^{high - level}(i\\omega)]_{uv } , \\label{eq : semol1}\\end{aligned}\\ ] ] where the non - local part of the self - energy coming from the perturbative method does not contain any double counting of diagrams , for details see subsection  [ gf2_non_local ] .",
    "the inactive orbitals are described using only the self - energy obtained from a perturbative method and consequently @xmath33_{\\mu\\lambda } = [ \\boldsymbol{\\sigma}^{gf2}(i\\omega)]_{\\mu\\lambda}. \\label{eq : semol_inactive}\\end{aligned}\\ ] ]    in seet , the impurity hamiltonian is solved using bare interactions since the frequency dependent field coming from all the other orbitals is described by @xmath34 .",
    "however , to connect to the condensed matter and materials science community that uses screened interactions in the impurity hamiltonian , we present a discussion of how these interactions can be evaluated in seet in subsection  [ screening_seet ] .",
    "the new molecular green s function , which contains the gf2 self - energy coming from all the inactive , weakly correlated orbitals as well as the strongly correlated self - energy from the active space orbitals , is reconstructed as @xmath35^{-1}.\\end{aligned}\\ ] ] this @xmath36 is an @xmath37 matrix and has elements for all the orbitals present in the molecular problem @xmath38 .",
    "the hybridization @xmath20 present in eq .",
    "[ eq : gfimp ] is then updated using the new green s function and self - energy , and subsequent iterations are performed until convergence is achieved .    in seet ,",
    "the self - consistency procedure is made out of two loops .",
    "the inner loop has dmft - like iterations and in this loop the matrices such as @xmath39 , @xmath40 , and @xmath20 are determined self - consistently . at the convergence of the dmft - like loop , the quantities of interest , such as the density matrix , molecular energy , and density of states , can be evaluated using the converged green s function and self - energy .    in seet outer loop ,",
    "we use the converged green s function that contains the self - energy obtained using an accurate many - body method and we pass it back to the perturbative method as a zeroth - order green s function . note that in the case of gf2 only a single iteration is performed in the seet outer loop .",
    "( otherwise , due to the self - consistent nature of gf2 , the converged gf2 green s function will be the same as the one obtained previously . )    an overall scheme of seet self - consistency is summarized as follows .    1 .",
    "generate hartree ",
    "fock ( hf ) or density functional theory ( dft ) green s function as an initial guess .",
    "2 .   perform a self - consistent gf2 calculation for the whole molecule , see ref .   for details of the gf2 iterative loop .",
    "[ dmeval_iter ] evaluate the one - body density matrix @xmath17 using eq .",
    "[ eq : gf2 dm ] and construct a desired orbital basis such as natural orbitals , localized orbitals , or orthogonal atomic orbitals .",
    "4 .   transform all quantities from the atomic orbital ( ao ) basis to the new desired orbital basis .",
    "5 .   construct the impurity hamiltonian in which two - electron term is either a subset of bare coulomb or screened interactions in the active space . 6 .",
    "perform dmft - like loop : 1 .",
    "use an impurity solver ( rasci / fci or ct - hyb ) to obtain the active space green s function @xmath22 and extract the active space self - energy @xmath23 . at the first iteration",
    "the hybridization @xmath20 is initialized using gf2 quantities .",
    "2 .   set up the molecular self - energy according to eqs .",
    "[ eq : semol1]-[eq : semol_inactive ] if a non - local self - energy is used or eq .  [ eq : screened_u ] if screened interactions are used .",
    "3 .   reconstruct the molecular green s function via the dyson equation and adjust the chemical potential to obtain a correct electron number for the whole molecule .",
    "4 .   update the hybridization @xmath20 using the new molecular green s function and self - energy . 5 .",
    "go back to step 6(a ) and iterate until convergence is reached .",
    "[ outloop1 ] pass the converged molecular green s function to a gf2 calculation and perform only a single gf2 iteration . 8 .",
    "[ outloop2 ] go back to step  [ dmeval_iter ] and iterate until outer loop convergence is reached .",
    "steps [ outloop1 ] and [ outloop2 ] are optional . in the past , we have investigated a single - shot scheme of dmft - like iterations on top of gf2 without any further self - consistent iterations ( steps [ outloop1 ] and [ outloop2 ] ) . in practical calculations",
    ", we found that when the embedding was done in the energy domain then performing single - shot calculations was almost always sufficient .",
    "the outer loop was necessary to relax the non - local self - energy when the embedding construction was executed using spatial fragments .",
    "in the first step of seet , a low - level green s function method is used to obtain a non - local self - energy . in our work",
    ", we employ the _ ab initio _ self - consistent gf2 method using either hf or dft green s function as an initial guess .",
    "the gf2 self - energy in the imaginary time domain reads @xmath41_{ij } = & - \\sum_{klmnpq}\\left[g^{gf2}_{mol}(\\tau)\\right]_{kl } \\",
    "\\left[g^{gf2}_{mol}(\\tau)\\right]_{mn } \\left[g^{gf2}_{mol}(-\\tau)\\right]_{pq } \\nonumber \\\\                                               & \\times v_{ikmq } \\left ( 2v_{ljpn } - v_{pjln } \\right ) ,   \\label{eq : siggf2}\\end{aligned}\\ ] ] where @xmath42 is the imaginary time gf2 green s function and @xmath43 are two - electron integrals in the ao basis . the resulting @xmath44 matrix is then transformed to the imaginary frequency domain @xmath45 using either a traditional fourier transform ( ft ) or a fourier transform in the basis of orthogonal polynomials  @xcite . the non - local part of the gf2 self - energy without the double counting is directly defined as a difference between the gf2 self - energy obtained from eq .",
    "[ eq : siggf2 ] while summing over all the molecular orbitals and that obtained by summing only over the local ( active ) part @xmath46 where @xmath47 is evaluated using local interactions within the active space .",
    "the inclusion of this non - local self - energy into the dmft - like iterations of seet eliminates the need for screened , effective interactions in the active space since the non - local self - energy term contains all the non - local interactions between the active and remaining orbitals .",
    "we will elaborate on this point in subsection  [ screening_seet ] .",
    "recently , a comprehensive comparison between approximate diagrammatic schemes including second - order perturbation theory ( @xmath48 ) , gw , flex , and @xmath49matrix approximation ( tma )  @xcite was performed for the 2d hubbard model@xcite where formally exact results are known for multiple regimes .",
    "this study showed that the gw , flex , and tma methods consisting of partial summations of bubble and/or ladder diagrams can yield worse results than the second - order perturbation theory .",
    "more importantly , when combined with dmft , @xmath48 non - local self - energy is more reliable than that from other methods including partial diagrammatic summations @xcite .",
    "we have chosen gf2 as the low - level perturbative method since we expect that similar conclusions will hold for realistic systems , particularly for molecular systems , where it is widely acknowledged that an exchange diagram is important if chemical accuracy is required .",
    "the main bottleneck of gf2 is the evaluation of the second - order self - energy from eq .",
    "[ eq : siggf2 ] .",
    "however , a highly parallel scheme consisting of factorizations and multiplications can easily make the gf2 calculation possible for a couple of hundred orbitals .",
    "the other bottleneck in the gf2 calculation is the size of the imaginary frequency and time grids necessary to express the self - energy and matsubara green s function . to reach chemical accuracy for realistic systems",
    ", these grids can have up to ten or even hundred thousand of points , leading to computations that are both processor and memory demanding .",
    "recently , we have optimized these numerical grids .",
    "first , a fourier transform in the basis of orthogonal polynomials  @xcite was used to transform the second - order self - energy from the imaginary time to the matsubara frequency domain instead of a conventional fourier transformation .",
    "the imaginary time grid can be therefore reduced to a couple of hundred points , while preserving a micro - hartree accuracy in the energy evaluation .",
    "later , the cubic spline interpolation was implemented to approximate the equidistant matsubara frequency grid  @xcite .",
    "we showed that the chemical accuracy can be maintained with a very sparse subset of imaginary frequency points ( only a few percent of the full imaginary frequency grid ) .",
    "these new grids significantly lower the required computation time and memory storage for the the self - energy and matsubara green s function .      in a molecular system ,",
    "the active space self - energy obtained from an impurity described by the bare interactions @xmath50 combined with the the self - energy @xmath51_{uv}$ ] evaluated by summing over all weakly correlated ( inactive ) orbitals is equivalent to the self - energy evaluated for an impurity problem described by screened interactions @xmath52 .",
    "numerically , this amounts to requiring that the impurity self - energy evaluated using imaginary time dependent screened interactions recovers the full second - order self - energy at every @xmath53 point @xmath54_{uv } & = [ \\boldsymbol{\\sigma}^{gf2}_{non - local}(\\tau , v_{bare})]_{uv } + [ \\boldsymbol{\\sigma}_{act}(\\tau , v_{bare})]_{uv } \\nonumber \\\\   &   = [ \\boldsymbol{\\sigma}_{act}(\\tau , u(\\tau))]_{uv } .\\end{aligned}\\ ] ] consequently , in multiple theories present in condensed matter and materials science the non - local field coming from all the other electrons is described by @xmath52 , while in seet this non - local field is described by @xmath51_{uv}$ ] .",
    "typically , screened interactions are obtained by a _ downfolding procedure _ of the full realistic band structure or infinite lattice hamiltonian to an effective impurity model with only few correlated orbitals  @xcite . in seet",
    ", we avoid the explicit downfolding procedure by including the @xmath55 matrix in the dmft - like self - consistency .",
    "however , in order to connect to the many - body condensed matter and materials science community , we demonstrate how to evaluate on - site screened interactions in molecular problems and by numerical examples ( subsection  [ numres : screening ] ) show that both the procedures , seet and dmft with screened interactions , give similar numerical answers .    in our previous work",
    ", we proposed a procedure for finding screened interactions that reached satisfactory chemical accuracy for molecular systems  @xcite . in this work",
    ", we capitalize on the previous procedure , and we require that for a single strongly correlated on - site orbital we fulfill the following relationship @xmath56_{ii } & = [ \\sigma^{gf2}_{act}(\\tau , u(\\tau))]_{ii}\\nonumber \\\\   & = -\\left[g^{gf2}_{mol}(\\tau)\\right]_{ii}^2\\left[g^{gf2}_{mol}(-\\tau)\\right]_{ii}[u(\\tau)]^2 , \\ ] ] for the on - site gf2 imaginary time self - energy ( eq .  [ eq : siggf2 ] ) . the on - site screened interaction @xmath52 is then obtained as follows @xmath57_{ii } } { \\left[g^{gf2}_{mol}(\\tau)\\right]_{ii}^2\\left[g^{gf2}_{mol}(-\\tau)\\right]_{ii } } } .",
    "\\label{eq : uscr}\\end{aligned}\\ ] ]    it is worth mentioning that while the non - local self - energy in eq .  [ eq : gf2nl ] for multiple - orbital active spaces can be straightforwardly evaluated , the generalization of the on - site screened interaction to treat multiple orbitals , unfortunately , is non - trivial .",
    "this is due to the multiple choices of screened interactions @xmath58 and the parametrization not always being unique  @xcite",
    ". additional advantages of using the non - local self - energy as compared to using the screened interaction in seet will be numerically demonstrated in subsection  [ numres : screening ] .",
    "now , let us shortly discuss the main distinction between seet using the gf2 non - local self - energy and gw+dmft .",
    "first , in gw+dmft , the gw non - local self - energy is given by the product of green s function and the dynamically screened interaction @xmath59 .",
    "thus , in gw+dmft , when the realistic band structure or infinite lattice hamiltonian is mapped onto an effective low energy model , it is mandatory to reconstruct the local components of both @xmath60 and screened interaction @xmath59 @xcite",
    ". this leads to  the _",
    "double _ embedding in both green s function @xmath60 and dynamically screened interaction @xmath59 \" @xcite . in seet ,",
    "the gf2 non - local self - energy is computed using bare coulomb interactions ( eq .  [ eq : siggf2 ] ) , it is therefore unnecessary to reconstruct the local component for the interaction in the active space , which can be directly taken from the bare interaction matrix . second , because of the dynamical nature of local screened interactions , the rigorous solution the impurity problem without neglecting the @xmath53-dependence of the interactions in gw+dmft can be only obtained by ct - qmc solver . in seet , any existing quantum impurity solver can be used to tackle the impurity problem .",
    "gw+dmft is known to yield good results for realistic materials such as nio , it remains to be established if seet can yield accurate results for these systems .",
    "however , for molecular systems , seet with the gf2 non - local self - energy is a fully _ ab initio _ ,",
    "systematically improvable , and self - consistent procedure able to give results with chemical accuracy .",
    "after a self - consistent gf2 calculation is performed , the next step in the seet procedure is to construct an orbital basis in which active orbitals are chosen . here ,",
    "as we have mentioned earlier , two general schemes are possible : either to perform the selection based on the orbital energies or spatial domains criteria , depending on system studied .",
    "as an example , in fig .",
    "[ fig : seet_selection ] , we present the selection of impurities using the aforementioned criteria for the h@xmath61 chain .",
    "[ h ]   chain .",
    "note that in the spatial selection scheme there are two pairs of degenerate impurities ( a , d ) and ( b , c ) . in the energy or occupation scheme",
    ", there is no such degeneracy and impurities are build using bonding and corresponding antibonding orbitals.,title=\"fig : \" ]    to construct the orbital basis in the energy domain , the one - body density matrix @xmath17 is first evaluated using the converged gf2 green s function , @xmath62 where @xmath63 is the inverse temperature .",
    "then , this whole molecular one - body density matrix is diagonalized to obtain the natural orbitals ( nos ) and occupation numbers .",
    "the active orbitals are then chosen from this set of nos based on their occupations , as it is done in traditional cas type methods .",
    "the strongly correlated orbitals have occupations significantly different from 0 or 2 , while the weakly correlated orbitals are mostly empty or doubly occupied . in seet",
    "performed in the no basis , if the number of active orbitals is too large to be included in a single impurity , the orbitals can be easily split into different groups ( impurities ) belonging to different fragments or different symmetries without any further implementation as shown in fig .",
    "[ fig : seet_selection ] , for numerical examples see table  [ tab : h10 ] .    in the spatial domain ,",
    "the localized orbitals can be formally obtained by localizing nos using the well - known pipek ",
    "mezey  @xcite and boys  @xcite localization schemes .",
    "note that boys orbitals are a molecular analogue of wannier orbitals  @xcite . in this work ,",
    "we use the lwdin orthogonalized ao ( sao ) basis when dealing with a minimal basis set , while the so - called regional natural orbital ( rno ) basis  @xcite is employed for larger basis sets than the minimal one .",
    "the construction of rno basis for seet can be briefly described as follows .",
    "starting from ao density matrix @xmath64 , the density matrix in sao basis @xmath65 can be obtained by the lwdin orthogonalization , @xmath66 where @xmath67 is an ao overlap matrix . in the next step of rno basis construction ,",
    "we separately diagonalize a block density matrix of predefined fragments @xmath68 @xmath69 the transformation matrix from sao to rno basis for a molecule consisting of @xmath0 molecular fragments is a direct summation of all block eigenvectors @xmath70 @xmath71 the density matrix in rno basis can be obtained as follows @xmath72 finally , the rno coefficients present in the non - orthogonal ao basis are obtained by a back transformation @xmath73 the active orbitals are then chosen from rnos belonging to particular molecular fragments .",
    "it is worth mentioning that in the original description of the rno construction @xcite , the rno density matrix ( eq .  [ eq : prno ] ) is further diagonalized using the jacobi rotation to obtain the bonding between fragments .",
    "however , since our purpose is to approximately disentangle the bonding between fragments , we will not proceed according to the original description . generally ,",
    "depending on a system under study , we can use either no or sao / rno bases .",
    "if the entanglement between molecular fragments is large , the no basis should be used to correctly describe the bonding between fragments . on the other hand , if molecular fragments are only weakly coupled , we approximately can separate them and employ sao / rno bases . the advantages and disadvantages of each orbital basis",
    "will be carefully demonstrated using numerical results in subsection  [ numres : energy_spatial_domains ] .      for seet procedure to be computationally",
    "well behaved and accurate one has to fulfill multiple requirements : * ( i ) * orthogonality of the orbital basis to properly carry out the embedding procedure when an explicit bath representation for a ci solver is necessary , * ( ii ) * including a realistic hamiltonian in the impurity problem , * ( iii ) * hybridizations that simplify the bath fitting procedure , * ( iv ) * locality to make the self - energy decay fast with respect to the distance , and * ( v ) * a possibility of treating many strongly correlated orbitals by an impurity solver .",
    "all of these requirements have implications for the possible quantum impurity solvers that can be used in seet or dmft procedures . for molecules ,",
    "if chemical accuracy is desired , any modification of the realistic hamiltonian containing full one- and two - body interactions to a simplified hamiltonian including only a subset of all interactions may have a detrimental effect  @xcite .",
    "many of the off - diagonal elements of the realistic hamiltonian can have a similar magnitude to the diagonal elements , thus presenting no justification for neglecting them and keeping only the diagonal elements .",
    "moreover , solutions obtained by such modifications usually can not be improved in a systematic manner .",
    "consequently , for molecular calculations the safest option for preserving chemical accuracy is to use a class of quantum impurity solvers that employ a full realistic hamiltonian for the impurity orbitals .",
    "this requirement allows us to use two classes of solvers : either based on ci expansions or continuous time hybridization expansion quantum monte carlo ( ct - hyb qmc  @xcite ) .",
    "solvers based on ci expansions such as restricted active space ci ( rasci ) allow us to comfortably include around 8 orbitals in the impurity and around 16 - 24 bath orbitals .",
    "they usually work in the zero ( or low ) temperature formulation and require a bath discretization that can be a potential source of errors .",
    "the hybridization expansion solvers can handle an infinite bath but face difficulties with monte carlo sign problem that gets especially pronounced for non - diagonal hybridizations and low temperatures .",
    "consequently , for both classes of solvers non - diagonal hybridizations lead to problems . for ci solvers",
    "non - diagonal hybridizations lead to large number of bath orbitals necessary to fit the discrete bath accurately . for hybridization expansion solvers",
    "non - diagonal hybridizations lead to long computation times due to sign problem .",
    "thus , a crucial challenge is to define a set of orbitals that either diagonalizes hybridization or minimizes its off - diagonal elements for a range of frequencies .    to gain insight into the possibility of making the hybridization as diagonal as possible , we plot in figs .",
    "[ fig : hyb_dm ] and [ fig : hyb_boys ] hybridizations for different impurities in the h@xmath61 chain in the 6 - 31 g basis  @xcite using different selection schemes presented in fig .",
    "[ fig : seet_selection ] .",
    "spatially localized orbitals are obtained using the boys localization method implemented in gaussian 09  @xcite .",
    "it is evident that nos yield a diagonal hybridization while boys orbitals yield hybridization containing off - diagonal elements of large magnitudes .",
    "this insight explains some of our observations that nos are quite advantageous for seet calculations since the bath fitting procedure can be done using relatively few bath sites .",
    "[ h ] _ { ij}$ ] in nos for all the impurities present in h@xmath61 chain in the 6 - 31 g basis set at @xmath74 .",
    "note that the off - diagonal hybridization elements are zero.,title=\"fig : \" ]    [ h ] _ { ij}$ ] in boys orbitals for the impurities a and b present in h@xmath61 chain in the 6 - 31 g basis set at @xmath74 .",
    "note that the off - diagonal hybridization elements are of a similar magnitude as the diagonal elements.,title=\"fig : \" ]    we also consider how different orbitals , by influencing hybridization behavior , can change the performance of ct - hyb qmc , in tables  [ tab : hyb_exp_sto3 g ] and  [ tab : hyb_exp_631 g ] .",
    "let us note in passing that for a minimal basis ( sto-3 g @xcite ) , saos are very similar to boys orbitals and the off - diagonal elements of hybridization are significant for saos .",
    "it is evident that ct - hyb qmc has a much worse average sign and larger perturbation order in orbital bases that yield non - diagonal hybridizations , thus making such calculations particularly challenging especially at low temperatures since the average perturbation order in ct - hyb qmc calculations grows when temperature decreases .",
    "we observe that even for high temperatures the difference in ct - hyb qmc performance is present and nos are still favored .",
    "moreover , this difference in performance is independent of the number of orbitals present in a given basis and the trend is maintained when a larger orbital basis such as 6 - 31 g is employed .",
    "our observations indicate that for molecular examples nos are advantageous when used with the ct - hyb qmc solver since due to the minimization of the sign problem they lead to a significant computational speed up . a similar conclusion was reached in ct - hyb qmc study of hubbard model  @xcite where the monte carlo sign error was minimized by a canonical transformation that brought the hybridization matrix to a diagonal form .    in ci calculations ,",
    "nos lead to fewer bath orbitals - also resulting in an increased computational efficiency ; however , here the savings are not so dramatic since including additional bath orbitals in truncated ci schemes does not result in a significant cost increase .",
    "it is important to showcase one more aspect necessary for a high accuracy quantum impurity solver for realistic problems . a quantum impurity solver capable of treating multiple regimes from weakly to strongly correlated ones , should be able to treat multiple partially occupied orbitals present in the impurity+bath system .",
    "to illustrate this statement , in table  [ tab : h10_occ_imp ] , we list impurity+bath occupations ( 8 impurity and 8 bath orbitals ) for the h@xmath75 chain in the cc - pvdz basis ( with a total of 50 orbitals ) .",
    "it is evident that for short interatomic distances this impurity+bath system has very few partial occupations , however for the stretched geometries , the number of partially occupied orbitals is significant .",
    "consequently , if quantum chemistry methods are used as solvers for the impurity problems , they should be capable of treating many partially occupied orbitals - prompting us to conclude that single reference methods will generally not be capable of treating these impurity problems successfully .    [",
    "cols=\"<,<,<,^,^,^,^,^,^,^,^,^,^,^,^,^ \" , ]     [ h ] .,title=\"fig:\",width=302,height=207 ]    consequently , one can expect that in cases where the number of active space orbitals is too large to be treated within one impurity , it is possible to split the active space orbitals among several impurities and systematically improve the answer .",
    "we would like to stress that this systematic improvement will become crucial for systems where the exact answer is unknown , thus the only way of assessing if the level of accuracy given by seet is sufficient will be coming from internal seet criteria and checking if the answer obtained does not change drastically upon enlarging the number of impurity orbitals .",
    "in this paper , we have presented a detailed discussion of the molecular green s function quantum embedding scheme called seet .",
    "the self - energy separation characteristic for seet onto strongly correlated / active / subsystem and weakly correlated / inactive / environment parts is completely general and does not specify how the self - energies for these fragments will be evaluated in practice . while many schemes are possible , in this paper we used a scheme where first the whole molecule is treated by the perturbative self - consistent gf2 approach and then selected strongly correlated orbitals are used to build impurity+bath models that are solved in dmft - like procedure in the presence of self - energy coming from the weakly correlated / inactive / environment orbitals .",
    "we aim for seet to be systematically improvable , without empirical parameters , and reaching chemical accuracy .",
    "consequently , we discussed many aspects of seet that were developed by us to fulfill these strict demands .",
    "seet is a green s function method capable not only of delivering ground state energies but also many more physically relevant quantities such as free energies , ionization potentials ( ip ) and electron affinities ( ea ) , or temperature - dependent magnetic susceptibility ; however , here we focused on analyzing seet results for small molecular examples where multiple ground state methods are known to give excellent results and ground state energies can be easily used to asses the seet performance .",
    "we started our considerations by explaining the double self - consistency loop present in seet , where in the inner dmft - like loop the active space / impurity self - energy is updated using an accurate many - body solver .",
    "the outer loop requires an update of the self - energy for inactive orbitals performed by us at the gf2 level ; however other inexpensive _ ab initio _ methods could also be used for the calculation of the inactive orbitals self - energy .",
    "we observed , when analyzing numerical results , that this outer loop s self - energy update is crucial for classes of systems where the initial perturbative description was not quantitative .",
    "next , we have analyzed different schemes for selecting the strongly correlated / active / subsystem orbitals either based on the energy ( occupations ) or spatial criteria .",
    "we stress that in the energy ( or occupation ) scheme the strongly correlated orbital selection is done mainly based on the occupations of correlated one - body density matrix , thus not only relying on intuitive means .",
    "moreover , in the result section for h@xmath76 chain , we have demonstrated that the results of such a selection scheme can be systematically improved .",
    "we have also analyzed how different orbital bases , sao , rno , and no influence seet results . as expected , we found that no basis , which allows us easily describe a large inter - orbital entanglement , yields very good results for equilibrium geometries ; however , in the limit of separated fragment bases that localize orbitals , such as saos / rnos , yield better energies .",
    "we discussed optimal impurity solvers that can be used with seet , stressing that a full realistic hamiltonian should be employed for strongly correlated orbitals if one desires systematically improvable and accurate results .",
    "moreover , we have observed that suitable solvers ( to be applicable in multiple regimes from weakly to strongly correlated ) must be able to deal with near degeneracy and have to be able to treat multiple strongly correlated impurity orbitals .",
    "finally , we highlighted the influence of the orbital basis onto the performance of impurity solvers by noticing that for molecular examples the no basis seems to be particularly advantageous for the ct - hyb and rasci solvers .",
    "in seet the influence of the non - local interactions on the strongly correlated / active / embedded system is contained in the non - local self - energy evaluated at the perturbative level .",
    "we have compared seet results with dmft results where the non - local interactions are accounted for by employing the effective on - site interactions @xmath52 present in the impurity model .",
    "we found that for molecular examples both methods give almost identical results thus showing that seet with bare coulomb interactions present in the impurity model solved in the presence of self - energy coming from the inactive orbitals allows us to avoid the downfolding procedure and constructing an effective hamiltonian for the impurity model .",
    "finally , we have performed multiple total energy comparisons against established quantum chemistry methods such as nevpt2 and dmrg . for calculations in the no basis and when a full active space is used , seet can be considered as a green s function analog of caspt2 or nevpt2 procedure .",
    "we have demonstrated that when employing a full set of active space orbitals seet(ci",
    "/ gf2 ) yields energies that are very close to nevpt2 .",
    "however , unlike caspt2 or nevpt2 , seet(ci / gf2 ) is a perturb and diagonalize scheme that does not require storing or evaluating of two- , three- , or four - body reduced density matrices and avoids the intruder state problem present in caspt2 . here , we focused on analyzing how splitting of the full set of active orbitals into several impurities can be done in a systematic manner leading to an improvable and controlled procedure .",
    "we have shown that both in the spatial and energy domains , seet results can be systematically improved by using multi - site impurities .",
    "we analyzed the spatial domain using the example of h@xmath77 chain in sto-6 g basis , while the energy domain was examined on the example of h@xmath76 chain in cc - pvdz basis .",
    "moreover , we have shown that seet results in a small non - parallelity error when compared against dmrg and other established multi - reference methods .",
    "these results that indicate systematic trends provide us with a number of important self - contained assessment tools that in the future can be used to help us rigorously analyze the accuracy of seet in the absence of known results .",
    "we believe that the considerations and results presented here are further establishing seet as a quantum embedding green s function method that is controlled , systematically improvable , and not only able to reach accuracy comparable to currently established active space quantum chemistry methods but also flexible enough to yield other spectral and thermodynamic quantities than the ground state energies .",
    "t.n.l , a.a.k , and d.z . would like to acknowledge support from the us department of energy ( doe ) grant no .",
    ". authors also thank ushnish ray and garnet kin - lic chan for providing the dmrg data for the h@xmath76 chain in the cc - pvdz basis set .",
    "83ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty \\doibase http://dx.doi.org/10.1016/j.cplett.2004.08.032 [ * * ,   ( ) ] @noop * * ,   ( ) http://scitation.aip.org/content/aip/journal/jcp/114/23/10.1063/1.1361246 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/117/20/10.1063/1.1515317 [ * * ,   ( ) ] link:\\doibase 10.1103/revmodphys.79.291 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.24.1668 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.454528 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/134/11/10.1063/1.3567115 [ * * ,   ( ) ] link:\\doibase 10.1002/qua.560140804 [ * * ,   ( ) ] link:\\doibase 10.1080/00268977500103351 [ * * ,   ( ) ] link:\\doibase    10.1021/cr200137a [ * * ,   ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/revmodphys.68.13 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/revmodphys.77.1027 [ * * ,   ( ) ] link:\\doibase 10.1103/physrev.139.a796 [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.90.086402 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/100/i=6/a=67001 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.91.121111 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/143/24/10.1063/1.4938562 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/140/24/10.1063/1.4884951 [ * * ,   ( ) ] @noop * * ,   ( ) http://scitation.aip.org/content/aip/journal/jcp/144/5/10.1063/1.4940900 [ * * ,   ( ) ] @noop   @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.86.165128 [ * * ,   ( ) ] http://stacks.iop.org/0295-5075/82/i=5/a=57003 [ * * , ( ) ] link:\\doibase    10.1103/physrevb.83.075122 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.69.2863 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.478295 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.1574318 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.1638734 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/128/14/10.1063/1.2883981 [ * * ,   ( ) ] http://scitation.aip.org/content/aip/journal/jcp/130/23/10.1063/1.3152576 [ * * ,   ( ) ] link:\\doibase 10.1039/c0cp01883j [ * * , ( ) ] \\doibase    http://dx.doi.org/10.1016/0003-4916(89)90359-x [ * * , ( ) ] link:\\doibase 10.1103/physrevlett.62.961 [ * * , ( ) ] link:\\doibase 10.1103/physrev.124.41 [ * * , ( ) ] \\doibase    http://dx.doi.org/10.1016/0021-9991(75)90065-0 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.76.245116 [ * * ,   ( ) ] \\doibase    http://dx.doi.org/10.1063/1.4823192 [ * * ,   ( ) ] http://stacks.iop.org/0953-8984/24/i=5/a=053201 [ * * ,   ( ) ] link:\\doibase 10.1021/acs.jctc.5b00884 [ * * ,   ( ) ] @noop * * ,   ( ) link:\\doibase 10.1103/physrevb.91.235114 [ * * ,   ( ) ] link:\\doibase    10.1021/acs.jctc.6b00178 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.71.035105 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevb.70.195104 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.104.146401 [ * * ,   ( ) ] @noop   @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase 10.1103/revmodphys.32.296 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.56.12847 [ * * ,   ( ) ] @noop * * ,   ( ) \\doibase    http://dx.doi.org/10.1063/1.1812736 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.106.096402 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.97.076405 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevb.74.155107 [ * * ,   ( ) ] link:\\doibase 10.3929/ethz - a-005722583 [ 10.3929/ethz - a-005722583 ] ,   link:\\doibase    10.1103/revmodphys.83.349 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.1677527 [ * * , ( ) ] @noop `` , ''   \\doibase http://dx.doi.org/10.1063/1.1672392 [ * * , ( ) ] link:\\doibase 10.1103/physrevb.85.201101 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1016/j.cpc.2015.10.023 [ * * ,   ( ) ] link:\\doibase 10.1002/wcms.81 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1016/0301-0104(80)80045-0 [ * * ,   ( ) ] link:\\doibase 10.1002/qua.560180822 [ * * ,   ( ) ] \\doibase http://dx.doi.org/10.1063/1.441359 [ * * ,   ( ) ] link:\\doibase    10.1002/wcms.1172 [ * * , ( ) ] @noop * * ,   ( ) @noop * * ,   ( ) link:\\doibase    10.1103/physrevb.89.201106 [ * * ,   ( ) ] @noop * * ,   ( ) \\doibase http://dx.doi.org/10.1063/1.456153 [ * * ,   ( ) ] @noop   ( ) ,   \\doibase http://dx.doi.org/10.1063/1.3695642 [ * * ,   ( ) ] \\doibase    http://dx.doi.org/10.1063/1.4905329 [ * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we present a detailed discussion of self - energy embedding theory ( seet ) which is a quantum embedding scheme allowing us to describe a chosen subsystem very accurately while keeping the description of the environment at a lower cost . </S>",
    "<S> we apply seet to molecular examples where commonly our chosen subsystem is made out of a set of strongly correlated orbitals while the weakly correlated orbitals constitute an environment . </S>",
    "<S> such a self - energy separation is very general and to make this procedure applicable to multiple systems a detailed and practical procedure for the evaluation of the system and environment self - energy is necessary . </S>",
    "<S> we list all the intricacies for one of the possible procedures while focusing our discussion on many practical implementation aspects such as the choice of best orbital basis , impurity solver , and many steps necessary to reach chemical accuracy . </S>",
    "<S> finally , on a set of carefully chosen molecular examples , we demonstrate that seet which is a controlled , systematically improvable green s function method can be as accurate as established wavefunction quantum chemistry methods . </S>"
  ]
}