{
  "article_text": [
    "in the current cold dark matter ( cdm ) cosmogony , a key concept in the build - up of structure is the formation of dark matter haloes .",
    "these are quasi - equilibrium systems of dark matter , formed through non - linear gravitational collapse . in a cdm - like hierarchical scenario ,",
    "most of the mass is bound within haloes ; galaxies and other luminous objects are assumed to form in these haloes because of cooling and condensation of baryonic gas ( see mo , van den bosch & white 2010 ) . with @xmath0-body simulations , the properties of the halo population , such as the spatial clustering properties , the mass function , the assembly histories and the internal structures are well understood .",
    "nevertheless , how galaxies form in dark matter haloes in the cosmic density field remains an unsolved problem .",
    "a long - standing problem in current galaxy formation theory is to explain the low efficiency with which baryonic gas is converted into stars : the observed mass in stars at the present time is less than @xmath4 of the total baryonic mass in the universe ( bell et al .",
    "including cold gas associated with galaxies only increases this to @xmath5 .",
    "this low efficiency of star formation and gas assembly into galaxies is not a natural consequence of hierarchical formation , in which the gas is expected to cool rapidly at high redshift in low - mass dark matter haloes .",
    "a number of physical processes have been proposed to suppress gas cooling and the star formation efficiency .",
    "these include photoionization heating by the uv background ( e.g. efstathiou 1992 ; thoul & weinberg 1996 ; somerville 2002 ; gnedin 2000 ; hoeft et al .",
    "2006 ) , feedback from supernova explosions ( e.g. white & rees 1978 ; dekel & silk 1986 ) and from agn ( e.g. tabor & binney 1993 ; ciotti & ostriker 1997 ; hopkins et al .",
    "2006 and references therein ; wang et al .",
    "2012b ) , and pre - heating by star formation / agn ( e.g. mo & mao 2002 ; pfroemmer et al . 2012 ) , and by pre - virialization ( mo et al .",
    "unfortunately , our understanding of all these processes is still poor , making it difficult to test the predictions of these scenarios with observations .    in order to understand the galaxy formation processes throughout the cosmic density field ,",
    "a key step is to study the distributions and properties of galaxies and the intergalactic medium ( igm ) , and their interactions with each other and with dark matter . in the local universe ,",
    "detailed observations of the galaxy population are now available from large redshift surveys , for example the sloan digital sky survey ( sdss ; york et al .",
    "this not only allows us to study the large - scale structure in the local universe , but can also be used to derive a large number of physical quantities characterizing the intrinsic properties of individual galaxies , such as luminosity , stellar mass , color , morphology , size , star formation rate , and nuclear activity .",
    "there have also been observational programs dedicated to the various aspects of the igm .",
    "extensive x - ray observations have been conducted to study the hot gas associated with clusters and rich groups of galaxies but the total gas mass associated with these systems is expected to be small . with the advent of accurate measurements of the cosmic microwave background from observations such as the south pole telescope , the atacama cosmology telescope , and the planck satellite , one can also probe the hot , diffuse gas outside clusters and groups through the sunyaev - zeldovich ( sz ) effect .",
    "however , at low redshift , about @xmath6 of all the mass is in virialized halos with virial temperatures below @xmath7 k ( see mo & white 2002 ) , too cold to be studied with x - ray data and/or the sz effect . a promising way to study",
    "the diffuse igm at such low temperature is through quasar absorption lines . with the installation of the _ cosmic origins spectrograph _ on the _ hst _ the sample of uv absorption systems at low redshift",
    "is expected to increase by an order - of - magnitude or more , allowing a much more detailed examination of the warm component of the local igm .",
    "these observational programs together provide an unprecedented data base to study how galaxies form and evolve in the cosmic density field .",
    "however , in order to make full use of the potential of the observational data to test models , one has to develop an optimal strategy .",
    "conventionally , one starts with a cosmological model , _",
    "e.g. _ the current @xmath8cdm model , uses computer simulations to follow the evolution of the cosmic density field , and compares simulation results with observational data in a statistical way .",
    "however , such a comparison can be made directly only under the assumption that the observational sample and simulation are fair representations of the universe , so that cosmic variance is not an issue .",
    "unfortunately , this assumption is almost always violated in reality .",
    "simulations are limited by the dynamical ranges they can cover . in order to resolve processes on the scale of galaxies , the simulation volume has often to be much smaller than a fair sample of the large scale structure .",
    "observationally , finite sample volumes also lead to a biased representation of the statistical properties of the cosmic density field and galaxy population in the universe .",
    "it is thus imperative to have theoretical and empirical input to optimize an observational strategy and to help interpret the limited observations in an unbiased way .",
    "the uncertainties can be minimized if comparisons between observation and model prediction are made for systems that have both the same environments and the same formation histories .",
    "ideally , if we can accurately reconstruct the initial conditions for the formation of the structures in which the observed galaxy population resides and from which the actual gas emissions and absorptions are produced , then we will be able to compare observation and simulation ( i.e. , data and theory ) in a way that is free of cosmic variance , thereby greatly enhancing the constraining power of the observational data .",
    "the goal of this paper is to develop a method that can be used to reconstruct the initial ( linear ) density field that forms the large scale structure in the local universe . in this first paper in a series , we describe our reconstruction method and test its performance with realistic mock galaxy catalogs .",
    "the structure of the paper is arranged as follows . in section  [",
    "sec : method ] , we describe our reconstruction method . in section  [ sec : sim ] , we test our method using a simulated density field . in section  [ sec : mocktest ] we present our mock catalog that is used to test our method and our results of the linear density field reconstructed from it . in section [ sec : resim ] we use n - body simulations to follow the structure formation seeded by the re - constructed initial density field , and compare the final density field with the original one used to construct the mock catalogs .",
    "finally section [ sec : discussion ] contains a summary of the main results and some further discussions .    in order to avoid confusion",
    ", we here list the various matter density fields used in the text : ( i ) the final density field , @xmath9 : the _ true _ present - day ( final ) density field , either in the real universe or in an original @xmath0-body simulation .",
    "( ii ) the reconstructed density field , @xmath10 : the present - day density field re - constructed from the mock catalog . (",
    "iii ) the reconstructed initial ( linear ) density field : the initial linear density re - constructed from a present - day density field .",
    "( iv ) the re - simulated density field , @xmath11 : the present - day density field obtained from numerical @xmath0-body simulations using the re - constructed initial density field as initial conditions . ( v ) the modeled density field , @xmath12 : a model prediction for the present - day density field obtained from the initial density field using the modified zeldovich approximation introduced by tassev & zaldarriaga ( 2012b , hereafter tz12 ) .",
    "this model density field is used in the reconstruction method to link the initial and final density fields .",
    "our reconstruction consists of the following several steps : ( i ) use galaxy groups selected from the sdss , to represent dark matter haloes ; ( ii ) use haloes above a certain mass to reconstruct the cosmic density field at the present day ; ( iii ) reconstruct the initial density field that best matches the final density field under the constraint of current cosmology and a linear perturbation spectrum .",
    "the galaxy group finder used is described and tested in detail in yang et al .",
    "( 2005 , 2007 ) .",
    "the method for reconstructing the density field starting from dark matter haloes ( i.e. , galaxy groups ) above a given mass threshold is described and tested in wang et al .",
    "( 2009a , 2012a ) .",
    "in what follows we describe how we reconstruct the initial linear density field from a given present - day density field .",
    "our goal is to obtain the linear density field that can reproduce a given present - day density field .",
    "we work in fourier space , so that the initial density field is specified by @xmath13 , the fourier modes of the initial density field .",
    "two constraints are used in the reconstruction .",
    "first , according to the standard cosmology , we assume the linear density field to be gaussian , so that the fourier modes obey the following probability distribution : @xmath14=\\prod_{\\bf k}^{\\rm half } \\prod_{j=0}^1 \\frac{1}{[\\pi p_{\\rm lin}(k)]^{1/2 } } \\exp\\left\\{-[\\delta_j({\\bf k})]^2/p_{\\rm lin}(k)\\right\\}\\,,\\ ] ] where @xmath15 is the ( analytical ) linear power spectrum , and the subscripts @xmath16 denote the real and imaginary parts , respectively . because @xmath13 is the fourier transform of a real field , @xmath17 so that only the fourier modes in the upper half - space ( i.e. with @xmath18 ) are needed .",
    "second , the density field , @xmath12 , evolved from this linear density field according to a chosen model of structure formation , should best match a present - day density field , @xmath19 .",
    "in other words , we seek the appropriate @xmath13 to minimize a ` cost parameter ' which we define as @xmath20 ^ 2\\omega({\\bf x})}{2\\sigma_{\\rm p}^2({\\bf x})}\\,,\\ ] ] where @xmath21 is the statistical uncertainties in @xmath22 , while @xmath23 is a weight function used to account for the survey geometry .",
    "the present - day density field , @xmath24 , may either be the original simulated density field ( @xmath25 , section [ sec : sim ] ) or the density field reconstructed from a galaxy redshift survey ( @xmath26 , section [ sec : mocktest ] ) .",
    "the uncertainties @xmath21 are found to be roughly proportional to @xmath22 ( see section [ sec_denrc ] ) , and so we set @xmath27 , with @xmath28 a constant parameter . in order to obtain the model prediction for the final density field",
    ", we need a model to link @xmath29 with @xmath13 . this model should not only be accurate , but also be efficient so that the computation can be achieved in a reasonable amount of time , as to be discussed in section [ sec_hf ] . in practice , all these fields are to be sampled in a periodic box of length @xmath30 on a side , divided into @xmath31 grids in each dimension , so that the number of fourier modes to be dealt with is finite .    because of the statistical uncertainties in @xmath32 and the finite survey volume , the solution for @xmath33 under the two constraints described above is not unique , but should obey the posterior probability distribution of @xmath33 .",
    "assuming that the likelihood of @xmath29 given @xmath22 is @xmath34 , the posterior probability distribution for @xmath13 given @xmath35 can be written as @xmath36 ^ 2\\omega({\\bf x})/2\\sigma_{\\rm p}^2({\\bf x})}\\prod_{\\bf k}^{\\rm half}\\prod_{j=0}^1\\frac{1}{[\\pi p_{\\rm lin}(k)]^{1/2}}{\\rm e}^{-[\\delta_j({\\bf k})]^2/p_{\\rm lin}(k)}\\label{eq_post}\\,.\\ ] ] for our purpose , we seek the solutions for @xmath13 that maximize this posterior probability distribution function .",
    "we use the hamiltonian markov chain monte carlo technique ( hmc ) to achieve our goal .",
    "the hmc method was originally developed to sample a posterior distribution ( duane et al .",
    "1987 ; neal 1996 ) and has proven to be effective for exploring large , multi - dimensional posterior spaces ( e.g. hanson 2001 ) .",
    "different from the conventional markov chain monte carlo , the hmc method introduces a persistent motion of the markov chain when exploring the parameter space so that the random walk is greatly suppressed and the efficiency much improved ( duane et al .",
    "this method has already been widely used in astrophysics and cosmology ( see hajian 2007 ; taylor , ashdown & hobson 2008 ; jasche & kitaura 2010 ; kitaura et al .",
    "2012a ; jasche & wandelt 2013 , hereafter jw13 ; kitaura 2013 ) .",
    "for example , both jw13 and kitaura ( 2013 ) developed methods incorporating the hmc to reconstruct the initial density field from galaxy distribution . in particular",
    ", jw13 used a posterior distribution function composed of a poissonian likelihood based directly on galaxy distribution and a prior distribution of the initial density field .",
    "they successfully drew a sample of the initial density field from their posterior distribution , demonstrating that hmc is a powerful method for reconstructing the initial density field . in principle , such a sample can be used to inspect the statistical uncertainties in the reconstruction . however",
    ", this kind of analysis requires a careful design of the likelihood function to take into account in detail the statistical uncertainties in the constraining data and in the model of the cosmic density field .",
    "our basic idea is similar to that of jw13 , but for our purpose described above we restrict ourselves to seeking the maximum posterior estimates of @xmath13 instead of obtaining the posterior distribution of @xmath33 . as we will demonstrate below using realistic mock catalogs constructed from a cosmological @xmath0-body simulation , our hmc method based on the likelihood function defined above",
    "is sufficient for this research objective .      in this subsection",
    ", we briefly outline the hmc method ( see hanson 2001 ; taylor et al .",
    "2008 ; jw13 for some more detailed descriptions ) .",
    "the method is itself based on an analogy to solving a physical system in hamiltonian dynamics . as a first step ,",
    "we define the potential of the system to be the negative of the logarithm of the target probability distribution , @xmath37 & \\equiv & -\\ln[\\emph{q}(\\delta_j({\\bf k})|\\rho_{\\rm p}({\\bf x}))]\\nonumber\\\\ & = & \\sum_{\\bf k}^{\\rm half}\\ln[\\pi p_{\\rm lin}(k)]+\\sum_{\\bf k}^{\\rm half}\\sum_{j=0}^1\\frac{[\\delta_j({\\bf k})]^2}{p_{\\rm lin}(k)}+\\sum_{\\bf x}\\frac{[\\rho_{\\rm mod}({\\bf x})-\\rho_{\\rm p}({\\bf x})]^2\\omega({\\bf x})}{2\\sigma_{\\rm p}^2({\\bf x})}\\,.\\end{aligned}\\ ] ] for each @xmath38 , a momentum variable , @xmath39 , and a mass variable , @xmath40 , are introduced .",
    "the hamiltonian of the fictitious system can then be written as @xmath41\\,.\\ ] ] the statistical properties of the system is given by the partition function , @xmath42 , which can be separated into a gaussian distribution in momenta @xmath43 multiplied by the target distribution , @xmath44 \\prod_{\\bf k}^{\\rm half}\\prod_{j=0}^1{\\rm e}^{-\\frac{p_j^2({\\bf k})}{2m_j({\\bf k})}}\\label{eq_eh}\\,.\\ ] ] thus , the target probability distribution can be obtained by first sampling this partition function and then marginalizing over momenta ( i.e setting all the momenta to be zero ) .    in order to sample from the partition function , we first pick a set of momenta @xmath39 randomly from the multi - dimensional un - correlated gaussian distribution with variances @xmath40",
    ". we describe how to pick the mass variables in section [ sec_hmass ] .",
    "we then evolve the system from the starting point @xmath45 $ ] in the phase space to some pseudo time @xmath46 according to the hamilton equations , @xmath47 @xmath48 where @xmath49 is the likelihood term of the hamiltonian force to be discussed below .",
    "the integrated trajectory finally reaches a point @xmath50 $ ] in phase space and we accept this state with a probability @xmath51}\\right \\}\\,.\\ ] ] the procedure is repeated by randomly picking a new set of momenta .",
    "since the hamiltonian of a physical system is conserved , the acceptance rate should in principle be unity , which is one of the main advantages of working with the partition function , @xmath42 , instead of the target distribution function itself .",
    "however , rejection may occur because of numerical errors . in order to optimize the acceptance rate , it is common practice to integrate the `` equations of motion '' using the leapfrog technique , @xmath52 @xmath53 @xmath54 where @xmath55 represents the time increment for the leapfrog step .",
    "the leapfrog technique uses half - time steps in the first and third equations so that the scheme is accurate to second order in @xmath55 .",
    "the equations are integrated for @xmath56 steps so that @xmath57 .",
    "the value of @xmath46 must be randomized to avoid resonance trajectories .",
    "we thus randomly pick @xmath56 and @xmath55 from two uniform distributions in the range of @xmath58 $ ] and @xmath59 $ ] , respectively .",
    "we will discuss our choices of @xmath60 and @xmath61 below .",
    "the @xmath56 leapfrog steps are referred to as one chain step .      as shown in eq .",
    "( [ eq_dp ] ) , the hamiltonian force consists of two components , the prior term , @xmath62 , and the likelihood term , @xmath63 .",
    "the latter can be re - written as : @xmath64\\omega({\\bf x})}{\\sigma_{\\rm p}^2({\\bf x})}\\frac{\\partial\\rho_{\\rm mod}({\\bf x})}{\\partial\\delta_j({\\bf k})}\\equiv\\sum_{\\bf x}\\rho_{\\rm d}({\\bf x})\\frac{\\partial\\rho_{\\rm mod}({\\bf x})}{\\partial\\delta_j({\\bf k})}\\nonumber\\\\ & = & \\sum_{\\bf x}\\sum_{\\bf k_2}\\rho_{\\rm d}({\\bf k_2}){\\rm e}^{i{\\bf k_2\\cdot x}}\\frac{\\partial}{\\partial\\delta_j({\\bf k})}\\sum_{\\bf k_1}\\rho_{\\rm mod}({\\bf k_1}){\\rm e}^{i{\\bf k_1\\cdot x}}=n_{\\rm c}^3\\sum_{\\bf k_1}\\rho_{\\rm d}^{\\ast}({\\bf k_1})\\frac{\\partial\\rho_{\\rm mod}({\\bf k_1})}{\\partial\\delta_j({\\bf k})}\\,.\\end{aligned}\\ ] ] for the sake of simplicity we have introduced in this equation a new quantity , @xmath65 , which is directly related to @xmath29 , as defined in the second equation .    to derive the solution of the hamiltonian force , we need a model of structure formation to connect @xmath66 and @xmath13 . in this work ,",
    "we adopt the model developed in tz12 . according to tz12",
    ", the present - day density field can be written in terms of the modeled density field , @xmath67 , as @xmath68 .",
    "here , @xmath69 , a random mode - coupling residual , is generally small on mildly non - linear scales and can be neglected .",
    "the modeled density can be obtained via @xmath70 , where @xmath71 is the density field predicted by the modified zeldovich approximation ( mza ) developed by tz12 and @xmath72 is a density transfer function .",
    "the transfer function is obtained via comparing the prediction of the zeldovich approximation with @xmath0-body simulations , and can suppress the effects of shell crossing . using numerical simulations as reference , tz12 found that the prediction of mza is better / worse than that of the second - order lagrangian perturbation theory ( 2lpt ) on small / large scales . because mza is computationally faster than 2lpt",
    ", we choose mza to predict the present - day density field .",
    "following tz12 , we use the mza to derive the displacement field , @xmath73 , @xmath74 where @xmath75 is a lagrangian coordinate , @xmath76 is the zeldovich displacement field , and @xmath77 is the transfer function for the zeldovich displacement field , with @xmath78 the non - linear scale at redshift zero .",
    "we move particles , which are initially located on uniform grids of positions @xmath75 , to @xmath79 to sample the density field .",
    "we then utilize a clouds - in - cells ( cic ) assignment ( hockney & eastwood 1981 ) to construct the mza density field on grids from the particle population .",
    "we fourier transform the mza density , and multiply it with the density transfer function @xmath80 , where @xmath81 , and @xmath82 can be read off from eq .",
    "( 3.9 ) in tz12 .",
    "the detailed form of the density transfer function for mza was communicated to us by svetlin tassev . ] and a gaussian kernel @xmath83 characterized by a smoothing scale @xmath84 .",
    "we then deconvolve the cic kernel by dividing the resulting density field in fourier space by the fourier transform of the cic kernel , @xmath85 , where @xmath86 , @xmath87 and @xmath88 are the @xmath89 , @xmath90 and @xmath91 components of the wavevector @xmath92 , respectively .",
    "finally we obtain the modeled density field as , @xmath93 inserting eqs .",
    "( [ eq_disp ] ) and ( [ eq_rhoz ] ) together with @xmath79 into eq .",
    "( [ eq_pi1 ] ) then yields the likelihood term of the hamiltonian force : @xmath94 note that @xmath95 is used in the derivation .    for convenience",
    "we introduce a density - vector field , @xmath96 it is important to note that @xmath97 can not be directly derived with fourier transformation because @xmath98 are not spaced regularly . to bypass this problem",
    ", we introduce a transitional field in fourier space , @xmath99 , which is related to the density - vector through @xmath100={\\bf \\gamma}[{\\bf l - x(q)}]$ ] , with @xmath101 the fourier transform of @xmath102 and the vector @xmath103 .",
    "one might think that the density - vector field can be derived straightforwardly via interpolation .",
    "unfortunately , interpolation can cause smoothing and serious errors in the final estimation of the hamiltonian force .",
    "in order to correct these effects , we proceed as follows .",
    "we first divide @xmath104 by @xmath105 to deconvolve the cic interpolation that is applied later .",
    "we then fourier transform the deconvolved @xmath102 into real space to obtain @xmath106 .",
    "finally we interpolate @xmath106 to the position , @xmath107 , to obtain @xmath97 via a cic scheme .",
    "we emphasize again that deconvolving the cic kernel is crucial for obtaining an accurate estimate of the hamiltonian force ( see section [ sec : sim ] ) . with",
    "@xmath97 obtained , we can rewrite the hamiltonian force as : @xmath108 where @xmath109 is the fourier transform of @xmath110 .",
    "again , the last equation can not be obtained directly from fourier transforms since the signs in the exponents are not negative ; it is obtained using the fact that @xmath111 and that @xmath112 .    since @xmath113 is nonzero only when @xmath114 , the likelihood term of the hamiltonian force for the real part of @xmath13 can be obtained as @xmath115 and for the imaginary part as @xmath116 where @xmath117 and @xmath118 are the real and imaginary parts of @xmath119 , respectively .",
    "it is interesting to note that the formulae for the hamiltonian force are very similar to the gravitational force equation in fourier space if we consider @xmath120 as the mass density field .",
    "the method described above has two free parameters ; the hamiltonian masses @xmath40 and the pseudo time @xmath46 .",
    "the efficiency of the hmc method is strongly dependent on the choices for these parameters .",
    "taylor et al .",
    "( 2008 ) suggested that the hamiltonian mass for a variable is taken to be inversely proportional to the width of the target probability distribution but the suggestion made in hanson ( 2001 ) was almost the opposite . in this paper",
    "we take a different and much simpler approach .",
    "when the hamilton equations are evolved to a pseudo time @xmath46 , to first order approximation the change in @xmath38 is @xmath121\\frac{t^2}{m_j({\\bf k})}\\,.\\ ] ] to ensure the convergence of the hamiltonian system , @xmath122 can not be much larger than @xmath38 .",
    "we thus require that both the first and second terms of @xmath122 be of the same order as or less than @xmath123 , the root mean square ( rms ) of @xmath38 .",
    "let us first consider the second term .",
    "supposing @xmath124 , one can deduce that the mass is of the same order as ( or less than ) @xmath125 .",
    "we therefore define the hamiltonian mass as , @xmath126 where @xmath127 denotes average over the phase of @xmath92 .",
    "note that the first and second terms in the mass equation are actually the rms of @xmath128 and @xmath129 , respectively .",
    "since the momentum @xmath39 follows a gaussian distribution with variance @xmath40 , i.e. @xmath130 , our mass definition also ensures that the first term in eq ( [ eq_nm1 ] ) is comparable to or less than @xmath123 . for consistency , we set @xmath131 and choose @xmath61 around @xmath132 to guarantee that @xmath46 is of order unity .",
    "the quantities @xmath133 vary significantly before the hmc chain converges , and so it is not necessary to compute the masses at every step . in practice",
    "we only calculate the masses twice during the whole sampling .",
    "the first calculation is before the generation of the first sample .",
    "after proceeding @xmath134 accepted chain steps , we use the new hamiltonian forces to update the mass variables and then retain the masses all the way to the end of the sampling . in the next section",
    ", we will show that the parameters @xmath61 and @xmath134 have no important impact on our final results .      given the complicated , technical nature of the method described above",
    ", this subsection gives a step - by - step description of the hamiltonian monte carlo method used to reconstruct the linear density field , given a present - day density field , @xmath35 .",
    "this serves as a ` road - map ' for anyone who wishes to implement this powerful method .    1 .",
    "pick a cosmology , which sets the analytical , linear power spectrum , @xmath15 .",
    "2 .   randomly pick an initial guess for the modes @xmath13 of the initial density field by specifying the corresponding real and imaginary parts .",
    "pick a set of hamiltonian masses , @xmath40 using eq .",
    "( [ eq_hmass ] ) .",
    "4 .   randomly draw a set of momenta , @xmath39 , from multi - dimensional , un - correlated gaussian distributions with variances @xmath40 .",
    "randomly pick values for the number of time steps , @xmath56 , and the leapfrog time steps @xmath55 , from uniform distributions in the range @xmath58 $ ] and @xmath135 $ ] , respectively . in this paper",
    ", we set @xmath131 and @xmath136 unless otherwise specified .",
    "6 .   integrate the hamiltonian ",
    "equations of motion \" using the leapfrog technique ( eqs .",
    "[ [ eq_lf1]]-[[eq_lf3 ] ] ) for a total pseudo - time @xmath137 , starting from @xmath45 $ ] .",
    "the detailed numerical operations performed for each time step @xmath55 are listed below .",
    "7 .   accept the new ` state ' @xmath138 $ ] , to which the system has evolved , with a probability given by eq .",
    "( [ paccept ] ) . 8 .",
    "go back to step 4 and repeat until the markov chain has converged and accumulated the required number of chain elements .",
    "finally , we list the numerical operations performed in each leapfrog time step @xmath55 :    * start from the modes , @xmath38 , use eq .",
    "( [ eq_disp ] ) to compute the displacement field , @xmath139 , and move particles initially located on a uniform rectangular grid of positions @xmath75 to @xmath79 . *",
    "construct the mza density field utilizing the clouds - in - cells ( cic ) assignment method of hockney & eastwood ( 1981 ) .",
    "* fourier transform this density field using the fast fourier transform method , and multiply the result with the density transfer function @xmath140 $ ] and the gaussian kernel @xmath141 .",
    "divide the result with the fourier transform of cic kernel and obtain the modeled density field , @xmath66 . * use @xmath66 to compute @xmath142 as described in eq .",
    "( [ eq_pi1 ] ) , and use the method described in the paragraph below eq .",
    "( [ eq_dvf ] ) to compute the density - vector field @xmath97 .",
    "* fourier transform @xmath97 to get @xmath143 , and compute the likelihood term of the hamiltonian forces using eqs .",
    "( [ eq_f0 ] ) and ( [ eq_f1 ] ) for the real and imaginary parts , respectively . * use the hamiltonian forces to evolve the system according to eqs .",
    "( [ eq_lf1])-([eq_lf3 ] ) .",
    "the main purpose of using the gaussian kernel is to suppress noises on the grid size @xmath144 that affect the efficiency of the hmc .",
    "we find that using @xmath145 results in a quite low acceptance rate , and so we adopt @xmath146 throughout the paper .",
    "the efficiency of our hmc method depends also on the value of @xmath28 , in the sense that a smaller @xmath28 leads to a lower acceptance rate .",
    "in fact , the value of @xmath28 affects the hmc in a similar way to the smoothing scale @xmath84 , as we will see in the next section .",
    "moreover , in order to achieve a good performance , the mass variables and the pseudo - time @xmath147 should not be specified independently but according to their combinations in eq .",
    "( [ eq_nm1 ] ) . in this paper",
    ", we always choose @xmath46 to be of order unity and derive the mass variables accordingly .",
    "finally we note that our method is very fast .",
    "the computations shown below are all performed using one single processor ( amd opteron 8380 , 2.5 ghz ) .",
    "each chain step takes about 21 , 222 and 2,080 seconds for @xmath148 , @xmath149 and @xmath150 , respectively ( see table  [ tab_hmc ] ) .",
    "in this section we use the `` millennium simulation '' ( ms , springel et al . 2005 ) to test our method and tune the adjustable parameters when necessary .",
    "this simulation adopts a spatially - flat @xmath8cdm model , with @xmath151 , @xmath152 , @xmath153 and @xmath154 , where @xmath155 is hubble constant and @xmath156 is the _ rms _ amplitude of linear mass fluctuations in a sphere of of @xmath157 radius .",
    "it follows the evolution of the density field with @xmath158 particles , each having a mass of @xmath159 , in a cubic box of @xmath160 .",
    "we divide the simulation box into @xmath161 grid cells and use a gaussian kernel with a smoothing scale of @xmath162 to smooth the particle distribution on to the grid ( see table  [ tab_hmc ] for the values of @xmath31 and @xmath84 used ) .",
    "the method used to sample the density field on the grid is the same as that used to calculate @xmath29 except that now we do not include the density transfer function .",
    "the resultant density field , denoted by @xmath9 , is what we want to match in the reconstruction ( @xmath163 ) , and we assume @xmath164 as discussed in  [ sec_goal ] . moreover @xmath23 is always set to be unity and the non - linear scale @xmath165 used in the transfer function for the zeldovich approximation is chosen to be @xmath166 .    before showing the test results",
    ", we verify the accuracy of our estimation of the hamiltonian forces . to this end , let us start with how the forces should be calculated based on their definitions .",
    "suppose we want to calculate the hamiltonian force for a chosen variable @xmath38 .",
    "we alter @xmath38 by a small amount , @xmath167 , with all other variables held fixed .",
    "this leads to a small variation , @xmath168 , in the parameter @xmath169 .",
    "consequently we can obtain the corresponding force numerically , @xmath170 .",
    "this is what we would like to have .",
    "unfortunately , this method is very time - consuming and can not be used to evolve the hamiltonian system .",
    "the left panel of fig .",
    "[ fig_hfc ] shows a plot of @xmath63 , obtained using eqs.([eq_f0 ] ) and ( [ eq_f1 ] ) , versus @xmath171 .",
    "there is almost no visible difference between these two quantities .",
    "we also present a probability distribution of @xmath172 in the right panel of fig .",
    "[ fig_hfc ] .",
    "the distribution exhibits a high peak at unity with a shallow but broad wing .",
    "our further check finds that the hamiltonian forces in the broad wing are very small , which explains why we can not see any scatter in the left panel .",
    "we also show the hamiltonian forces without deconvolving the cic kernel in deriving the density - vector field @xmath97 .",
    "the resultant @xmath173 is systematically smaller than @xmath171 due to the smoothing with the cic kernel .",
    "this demonstrates that our estimates of the hamiltonian forces based on eqs.([eq_f0 ] ) and ( [ eq_f1 ] ) are accurate , and that deconvolution of the cic kernel is essential .",
    "now we apply our hamiltonian method to the ms simulation .",
    "we first perform a test with the following parameters : @xmath148 , @xmath174 , @xmath175 and @xmath136 . in what follows this test",
    "is referred to as  primary test \" .",
    "the initial set of @xmath38 is randomly drawn from the prior probability distribution given by eq.([eq_gs ] ) .",
    "we make calculations of 2,000 hmc steps and the average acceptance rate is @xmath176 .",
    "fig.[fig_ins ] shows @xmath177 ( here , @xmath178 ) as a function of chain step .",
    "one can see that @xmath179 drops sharply at the beginning ( the burn - in phase ) , then remains almost constant after about 150 chain steps ( the convergence phase ) .",
    "the density field of a converged chain step matches well the original input density field , with a rms difference between the two about @xmath180 . for reference ,",
    "the important parameters and characteristics of the primary test are listed in table [ tab_hmc ] .    in fig .",
    "[ fig_evps ] , we show the power spectra measured from different chain steps .",
    "we refer these power spectra as the hamiltonian power spectra [ @xmath181 , to distinguish them from the input linear power spectrum and the analytic linear power spectrum .",
    "the ` two - phase ' behavior can be clearly seen in the power spectra evolution .",
    "for the first 150 steps , one sees an obvious tuning process : on large scales the hamiltonian spectrum first decreases and then increases , while on small scales the behavior is the opposite .",
    "the first ( starting ) spectrum is very similar to the analytic linear power spectrum , because the initial @xmath182 are drawn from eq.([eq_gs ] ) .",
    "after about 150 steps , the hamiltonian spectra settle close to the initial spectrum used in the simulation , implying the convergence of the chain .",
    "both the @xmath169 and the power spectrum results demonstrate that our method ensures quick convergence .",
    ".the important parameters and characteristics for hmc and resimulation . here",
    "@xmath30 and @xmath84 are in unit of @xmath183 , while the softening length @xmath184 is in unit of @xmath185 .",
    "the mean consumption time @xmath186 for each chain step is in second .",
    "@xmath187 is the acceptance rate .",
    "the particle mass @xmath188 for resimulation is in unit of @xmath189 . [",
    "cols=\"<,^,^,^,^,^ \" , ]     such two - phase behavior is common in hmc ( e.g. hanson 2001 ; taylor et al . 2008 ) and can be understood in terms of the behavior of a physical system .",
    "the system initially has very large potential and large @xmath169 because its initial configuration , represented by the randomly generated initial @xmath38 , is unstable and tends to fall rapidly into the deep potential well , which reduces @xmath169 and potential of the system but increases the kinetic energy .",
    "since the kinetic energy is directly related to the current momenta which are reset to lower values before each chain step , the system is ` cooled ' so that it continuously falls towards the potential well ( burn in phase ) .",
    "once the changes of the potential and kinetic energy become insignificant within one chain step , the ` cooling process ' can be neglected and the total energy of the system becomes stable and so the value of @xmath169 remains more or less constant . in this convergence phase ,",
    "the accepted states reach the bottom region of the potential well around the posterior peak we are searching .",
    "recall again that we want to generate a linear density field which obeys the prior gaussian probability function specified by a linear power spectrum and evolves to a non - linear density field that matches the input density field . in",
    "what follows , we will examine our results in two different aspects .",
    "one is whether or not our reconstructed @xmath38 matches the prior constraints .",
    "the other is how well the predicted ( or modeled ) density field ( from the mza ) , @xmath67 , and the original simulated density field , @xmath25 , match each other . in the conventional application of the hmc method ,",
    "one generally performs the correlation length test ( see e.g. taylor et al .",
    "2008 ; jw13 ) to determine the amount of independent samples that are drawn from a hmc chain .",
    "however , for our purpose we are not trying to sample the whole posterior distribution , it is not necessary to perform the correlation analysis .",
    "the very small @xmath179 for the converged chain states demonstrates that our method can recover the input density field at high accuracy .",
    "to further quantify at which scales @xmath67 matches @xmath25",
    "well , we measure the phase correlation between the two density fields .",
    "we define a phase correlation coefficient between two fields @xmath190 and @xmath191 as @xmath192 where the subscripts 0 and 1 indicate the real and imaginary parts , respectively .",
    "note that @xmath193 means that the two quantities have exactly the same phase , while @xmath194 indicates no correlation .",
    "we show the phase correlation between @xmath25 and @xmath67 at the 1,700th chain step for our primary test in fig .",
    "[ fig_phcr ] .",
    "the correlation coefficient is close to one at large scales ( @xmath195 ) , and declines quickly towards smaller scales .",
    "such a sharp transition is due to the fact that small - scale structures are severely suppressed by our gaussian smoothing and so contribute little to @xmath169 and to the hamiltonian force . as a result",
    ", the transition scale should be related to the smoothing scale . to demonstrate this ,",
    "we perform two additional tests with @xmath196 and @xmath197 , assuming the same @xmath134 , @xmath61 and @xmath28 as in the primary test .",
    "we adopt @xmath198 for the test with large @xmath84 , and @xmath199 for the one with smaller @xmath84 one . for @xmath200",
    "the correlation coefficient remains about unity until @xmath201 , while for @xmath196 the transition starts already from @xmath202 . as expected , the transition scale is inversely proportional to the value of @xmath84 .",
    "we also show @xmath179 as a function of chain steps for these two tests in fig . [ fig_ins ] . similar to the primary test ,",
    "their @xmath179 first declines rapidly and then stabilizes at some small values .",
    "now let us check whether our method can recover the power spectrum and the gaussian distribution used as priors in our reconstruction . inspecting the hamiltonian spectra in more detail",
    ", we see that , over the entire range of wavenumbers , the hamiltonian spectra converge to the linear power spectrum used in the ms simulation .",
    "however , there is noticeable discrepancy between the hamiltonian spectra and the linear power spectrum on intermediate scales ( @xmath203 ) .",
    "the distributions of @xmath204 are shown in fig .",
    "[ fig_gaudis ] for three different ( large , intermediate and small ) scales .",
    "these distributions can all be well fitted with a gaussian , as expected , with the values of @xmath205 shown in the corresponding panel .",
    "the best - fitting @xmath205 on both small and large scales are very close to the expectation value , @xmath206 , indicating the spectrum is well reproduced on these scales . on intermediate scales , however , a deviation of @xmath205 from unity is clearly seen , consistent with the power spectrum result .",
    "to understand the origin of this discrepancy on intermediate scales , we perform a series of tests with smoothing scales ranging from @xmath207 to @xmath208 . in each case , we find that the input linear power spectrum is well recovered at both large and small scales , but that noticeable discrepancies are apparent on intermediate scales .",
    "the discrepancy moves gradually from small to large wavenumbers as the smoothing scale decreases ( see e.g. the lower right panel of fig .",
    "[ fig_dpps ] ) .",
    "we define a wavenumber @xmath209 with @xmath210 to quantify this scale , and find that the @xmath211 - @xmath84 relation can be well fitted by @xmath212 .",
    "note that the phase correlation between @xmath67 and @xmath25 also depends on the smoothing scale .",
    "we show @xmath211 so defined as the dashed lines in the phase correlation plot ( fig .",
    "[ fig_phcr ] ) , which clearly shows that @xmath211 also characterizes the transition scale in the phase correlation .",
    "the question is why the reconstructed linear power spectrum has the deviation from the analytical linear power spectrum just around @xmath211 .",
    "according to eq.([eq_dp ] ) , the hamiltonian force has two components , the prior term and the likelihood term .",
    "the phase can be well recovered only when the likelihood term dominates the force because the prior term actually generates random phases .",
    "the mean ratio of these two terms is , @xmath213 we find that @xmath214 decreases continuously with @xmath215 and is about unity around @xmath211 .",
    "this implies that the @xmath169 is more sensitive to @xmath13 at smaller @xmath215 , and is almost completely independent of @xmath13 at @xmath216 . at @xmath216 ,",
    "the trajectories of @xmath13 in the hmc are dominated by the prior so that the hamiltonian spectra match the linear power spectrum but the fourier phases are not constrained . at @xmath217 ,",
    "on the other hand , the trajectories of @xmath218 is governed by the likelihood term so that they try to trace the original linear density field of the ms simulation , consequently leading to a small @xmath169 and a strong phase correlation between the reconstructed and original density fields . however , on scales around @xmath211 , @xmath13 has a reduced contribution to @xmath169 and the posterior distribution is partly regulated by the prior . consequently the final result is a compromise between the prior constraint and the likelihood . since the likelihood term decreases with increasing smoothing scale [ see eqs.([eq_dvf ] ) , ( [ eq_f0 ] ) and ( [ eq_f1 ] ) ] while the prior term is not , it explains why both @xmath211 and the transition scale of the phase correlation depend linearly on the smoothing scale .",
    "although the discrepancy between the reconstructed and original linear power spectra is not big , we may want to correct it using a ` renormalization ' process .",
    "first we visually identify the region where the discrepancy is significant ( @xmath219 for the primary test ) , and then use @xmath220 to scale the amplitude of @xmath38 without changing its phase . since @xmath38 in this region are still well described by a gaussian distribution ( see fig .",
    "[ fig_gaudis ] ) , and since rescaling preserves the shape of the distribution , the distribution of the scaled @xmath38 is still close to gaussian . because the discrepancy to be corrected is fairly small and",
    "the contribution of @xmath13 around @xmath211 to @xmath169 is not large , the scaling does not cause any significant change in @xmath169 and the phase correlation . in section [ sec : resim ] , we will use the renormalized @xmath13 to generate initial conditions at high redshift , then use a @xmath0-body simulation to evolve the initial condition to the present day and compare the re - simulated density fields with the original simulated density field .",
    "finally , we discuss the effects of changing @xmath61 , @xmath134 and @xmath28 on our results .",
    "we perform several tests with different @xmath61 , @xmath134 and @xmath28 .",
    "similar to the primary test , all these tests exhibit a two - phase behavior , and a final convergence with a low @xmath179 is always achieved ( see fig . [ fig_ins ] ) .",
    "inspecting the results in detail , one can see that the values of @xmath61 and @xmath134 affect the number of steps required for burn - in : large @xmath61 and small @xmath134 both result in a quick burn - in phase .",
    "similar to @xmath84 , the value of @xmath28 also affects the difference between the converged @xmath67 and @xmath221 , in the sense that a smaller @xmath28 results in smaller @xmath222 , as shown in the lower left panel of fig.[fig_ins ] .",
    "furthermore , the value of @xmath211 decreases with the increase of @xmath28 ( see the lower left panel of fig .",
    "[ fig_dpps ] ) , because a larger @xmath28 suppresses more the contribution of small - scale structures to @xmath169 .",
    "thus @xmath28 affects the accuracy of the final result in a way quite similar to @xmath84 . on the other hand ,",
    "since the mza becomes increasingly inaccurate on small scales , a smaller @xmath28 also leads to a lower acceptance rate . as a compromise between efficiency and accuracy , and",
    "because the effects of changes in @xmath28 and @xmath84 are degenerate , we fix @xmath175 and only test the impact of changing @xmath84 .",
    "we have also checked the hamiltonian power spectra and the probability distribution of @xmath223 in these tests and found that they are very similar to those in the primary test ( fig .",
    "[ fig_dpps ] ) .",
    "as we discussed above , the hmc method needs a present - day density field , @xmath24 , as an input .",
    "therefore the method is useful only when we have a reliable method to obtain the present - day density field from observation . in wang et al .",
    "( 2009a ) , we developed a method to reconstruct the present - day density field based on the distribution of galaxy groups ( haloes ) . in this section",
    ", we apply this method to a mock group catalogue to reconstruct the density field and then apply our hmc method to the reconstructed density field to obtain the initial linear density field ( @xmath224 ) . in the first subsection ,",
    "we briefly describe how we construct the mock galaxy and group catalogs and the method to correct for redshift space distortions of the groups .",
    "the two mock catalogs are exactly the same as those used in wang et al .",
    "( 2012a ) and are constructed from the ms simulation with the use of the sdss dr7 sky coverage and selection functions .",
    "we refer the interested readers to wang et al .",
    "( 2009a , 2012a ) and references therein for further details .",
    "the construction of the mock galaxy catalogue is similar to that in yang et al .",
    "( 2007 , hereafter y07 ) .",
    "first , we populate galaxies inside dark matter halos according to the conditional luminosity function ( clf , yang , mo & van den bosch 2003 ) model of van den bosch et al .",
    "these halos are identified from the ms simulation with a friends - of - friends algorithm ( hereafter fof , davis et al .",
    "1985 ) employing a linking length of @xmath225 .",
    "next , we assign phase - space parameters to these galaxies following yang et al .",
    "( 2004 ; see also more et al .",
    "briefly , in each halo , the brightest galaxy is regarded as the central galaxy and assumed to be located at the halo center , while the other galaxies are satellites and distributed spherically following an nfw ( navarro , frenk & white 1997 ) density profile , with the concentration - mass relation given by macci et al .",
    "the peculiar velocity of a central galaxy is set equal to the mean velocity of the corresponding halo , while satellites have additional velocity components to account for the virial motions within the host halo .",
    "this component of velocity is drawn from a gaussian probability function with a dispersion computed from the jeans equation ( see more et al .",
    ". then we stack @xmath226 galaxy - populated simulation boxes together and place a virtual observer at the center of the stack .",
    "we assign each galaxy a redshift and ( @xmath227 , @xmath228 ) coordinates with respect to the observer .",
    "note that the redshift of a galaxy is a combination of its cosmological redshift and peculiar velocity .",
    "the mock galaxy catalogue is constructed by mimicking the sky coverage of the sdss dr7 and taking into account the angular variation of the magnitude limit and the survey completeness ( see li et al . 2007 ) .",
    "mock galaxy groups are identified with a halo - based group finder developed by yang et al .",
    "this group finder has already been successfully applied to the sdss dr4 ( y07 ) .",
    "the application to our mock galaxy catalogue is the same , except that different cosmology and larger sky coverage are adopted .",
    "groups are selected in the survey region that has the redshift completeness criterion of @xmath229 .",
    "the masses of groups are estimated based on the ranking of the characteristic luminosities of groups .",
    "the characteristic luminosity of a group is determined from the luminous group members with @xmath230 . to take account of the survey edge effect ,",
    "the group finder calculates the fraction of each group s volume that falls inside the survey region , then uses this fraction to correct for the group luminosity and mass . in this paper , we use all groups with assigned mass @xmath231 and we restrict our reconstruction of the present - day density field to the cosmic volume covering the redshift range @xmath232 , which we call the survey volume .    in order to reconstruct the density field in real space",
    ", we have to correct for redshift space distortions .",
    "to do that , we follow exactly the same procedure as described in wang et al .",
    "( 2012a , see also wang et al .",
    "first , we embed the survey volume in a periodic cubic box of side @xmath233 , which is referred to as survey box in the following .",
    "we divide the survey box into @xmath234 grids and assign the masses of groups ( with @xmath235 ) on the grids according to their redshift - space coordinates .",
    "the grids outside of the survey volume are assigned the mean mass density of the groups ( @xmath236 ) in the survey volume .",
    "then we calculate the overdensity field of the groups , and smooth it using a gaussian kernel with a large smoothing scale of @xmath157 . in the linear regime ,",
    "the peculiar velocities induced by density perturbations are proportional to the amplitudes of the density fluctuations , hence we can use this smoothed overdensity field to derive the peculiar velocities . adopting the relatively large smoothing scale can effectively suppress non - linear velocities that can not be predicted accurately . as shown in wang et al .",
    "( 2009a ) , the resultant velocities based on the halo ( group ) population are biased but tightly proportional to the real velocities .",
    "we thus can predict the peculiar velocity of each group by simply taking into account the bias factor of the overdensity field represented by the groups , and we use equation ( 10 ) in wang et al .",
    "( 2009a ) to calculate the bias factor .",
    "finally we use the line - of - sight component of the predicted velocity to correct for the redshift space distortions .",
    "since the velocity field is obtained from the groups distributed in redshift space , this method requires iteration to make sure that convergence is achieved ( typically twice ; wang et al .",
    "2012a ) .",
    "according to the results obtained in wang et al .",
    "( 2009a ) and from our further tests , the average offset between the real and predicted positions of groups is between @xmath237 to @xmath238 .",
    "using the 2lpt to correct for the redshift distortion can achieve a higher accuracy than the simple linear model ( kitaura et al .",
    "however , in our case it is not necessary to adopt the more accurate 2lpt , because the density field reconstructed from the mock groups is to be smoothed on a scale of at least @xmath239 ( see below ) .",
    "this smoothing scale is larger than the typical offset so that the linear theory and the 2lpt lead to very similar results .",
    "another important issue related to redshift distortion is the finger - of - god effect .",
    "this effect is mainly due to the virial motion within individual groups , especially massive groups , and thus can not be handled by a method based on linear or quasi - linear model . such effect ,",
    "if not properly corrected , can lead to artifacts in the reconstructed density field .",
    "an advantage in our reconstruction is that it is based on galaxy groups rather than galaxies .",
    "the redshift of a group is estimated using the luminosity - weighted average of all member galaxies so that the finger - of - god effect within the group is largely mitigated ( see figure 8 in y07 for a comparison between the distributions of groups and galaxies ) .",
    "however , some small groups that are close to massive groups may have significant non - linear motion ( see wang et al . 2009b ) , and such motion can not be corrected properly with any linear or quasi - linear model .",
    "fortunately the total mass contained in such groups is very small and the their effect is expected to be small .      in wang",
    "et al . ( 2009a ) , we developed a method to reconstruct the present - day density field starting from the distribution of galaxy groups ( haloes ) .",
    "we tested this method using fof haloes but did not apply it to mock groups to examine its reliability against uncertainties due to false identification of group members and survey boundary effect .",
    "survey boundaries have no direct impact on our reconstruction , but can affect the correction for redshift space distortions . in this subsection , we reconstruct the density field using the mock group catalogue corrected for redshift space distortions as described above and compare our reconstruction with the original simulation .    as in wang et al .",
    "( 2009a ) , we first calculate the density profiles in ` domains ' using the ms simulation . for a given population of fof",
    "haloes with mass of @xmath240 , we partition the cosmic space into a set of domains in such a way that each domain contains one and only one halo .",
    "any point in the domain of a halo is closer ( according to a distance proximity defined below ) to this halo than to any other haloes .",
    "the proximity of a point to a halo with viral radius of @xmath241 is defined as , @xmath242 where @xmath243 is the physical distance from the point to the halo center .",
    "we calculate the average density profile around halos of the same mass in the corresponding domains .",
    "[ fig_dp12 ] shows the results in six different mass bins . despite using a different cosmology ,",
    "these profiles are very similar to those shown in wang et al .",
    "( 2009a ) .",
    "then we ` convolve ' our mock groups with these density profiles to reconstruct the cosmic density in the following way . for a mock group of mass above the mass threshold @xmath244",
    ", we pick a density profile shown in fig .",
    "[ fig_dp12 ] according to the mass of this group . using monte carlo method",
    ", we put particles around this group up to @xmath245 times the virial radius regardless of the domain .",
    "we remove particles outside of the domain of the group .",
    "we repeat the above three steps for all groups with mass larger than @xmath244 .",
    "eventually we get a present - day density field , embedded in the survey box .",
    "one advantage of our reconstruction method is that we define a very special cross correlation function ( i.e. the average density profile in domain ) .",
    "it is different from the conventional cross correlation , which does not use domain . in the conventional one ,",
    "all haloes contribute to the average density profiles at all scale , especially on large scales .",
    "this has the effect of smoothing halo masses over very large scales .",
    "on the other hand , in our cross correlation based on domains , massive haloes ( @xmath246 ) contribute only to the density profiles within the virial radii , while the diffuse mass and low - mass halos with @xmath247 contribute to the large scale .",
    "another advantage of our method is that we use galaxy groups ( haloes ) instead of galaxies .",
    "while the bias of galaxy distribution relative to the underlying density field may depend on various galaxy properties , such as luminosity and color , and the exact form of the bias is not well established , the use of galaxy groups ( haloes ) automatically takes into account the bias of the galaxy distribution through the connection between galaxies and haloes .    in order to compare our reconstructed density field with the simulated density field ,",
    "we divide the survey box into @xmath234 grids with size of @xmath248 , and smooth the sampled particles on the grids using a gaussian kernel with @xmath249 . since the peculiar velocities are predicted more accurately in the inner region than near the boundary of survey volume ( wang et al .",
    "2012a ) and we use these velocities to correct for the redshift space distortions , one may expect that the reconstruction is more reliable in the inner region . to check whether or not this is the case , we need to compute the distance of any point in the survey volume to the boundary . following wang et al .",
    "( 2012a ) , we define a filling factor @xmath250 , to characterize the closeness of a grid to the boundary .",
    "for a grid ( @xmath251 ) in the survey volume , @xmath250 is the fraction of a spherical volume of radius @xmath252 centered on the grid @xmath251 , that falls inside the survey volume .",
    "therefore , @xmath253 for grids located more than @xmath252 from any survey boundary , while it is much less than unity for grids close to the boundary .    in fig .",
    "[ fig_rhorc ] we present the comparison between the simulated density field @xmath25 and the reconstructed density field @xmath26 in the inner region with @xmath254 , which is about @xmath255 of the survey volume .",
    "the solid line shows the mean relation and the error bars indicate the standard deviation in @xmath25 for a given @xmath26 .",
    "the bias is very small and the uncertainties are about @xmath256 to @xmath257 of @xmath26 in most bins . at the two largest density bins , there is a significant deviation from the one to one relation .",
    "the volume of the grids in these two bins is tiny and their presence does not affect our reconstruction significantly .",
    "we then show the same comparison for grids near the boundary , i.e. with @xmath258 .",
    "as one can see , the result is as good as that in the inner region .",
    "apparently , the smoothing used is able to remedy partly the problem in the correction of the redshift space distortions near the survey boundary .",
    "overall , with an appropriate choice of the smoothing radius , our method is able to reconstruct the density field accurately , and the effects due to survey boundary and group contamination do not introduce any significant bias .    in the next subsection",
    ", we will apply the hmc method to the reconstructed density field in two volumes , one is the entire survey volume and the other is a cubic volume well inside the survey volume ( see below for details ) . before doing that",
    ", we show in fig.[fig_phrs ] the phase correlation between our reconstructed and simulation fields in these two volumes .",
    "these correlations set an upper limit on the accuracy we can achieve for our reconstruction of the linear density field . as one can see , the correlation coefficient is almost unity on large scales , and declines gradually with the increase of the wavenumber . at @xmath259",
    "the coefficient drops to @xmath260 , demonstrating that our method is successful well into the nonlinear regime ( the translinear scale is @xmath261 ) .",
    "the phase correlation at @xmath262 obtained for the inner cube is slightly stronger than that for the total volume , indicating that boundary effects indeed have a non - negligible impact on the reconstruction .",
    "we first apply our hmc method to the reconstructed density field in the entire survey volume , which is embedded in the survey box with size @xmath263 on a side . in order to examine the ability of our method over a large dynamical range",
    ", we divide the survey box into @xmath264 grids in each dimension , so that our reconstruction deals with more than @xmath265 free parameters .",
    "we adopt a smoothing radius of @xmath266 , on which our reconstructed density field is quite similar to the original density field . in order to derive the weight @xmath267",
    ", we divide each grid into @xmath268 subgrids .",
    "if more than 6 subgrids of a grid are located inside the survey volume , this grid is assigned a weight of unity , otherwise zero .",
    "the other parameters are chosen as @xmath136 , @xmath175 and @xmath269 , similar to those in the primary test .",
    "this application is referred to as the ` low resolution run ' or lrr in the following .",
    "as shown in table  [ tab_hmc ] , on average it takes @xmath270 seconds for each hmc step and the acceptance rate is about @xmath271 .",
    "the @xmath179 value for a converged state is about 0.0029 , indicating that the rms difference between @xmath272 and @xmath10 is only 3.8% .",
    "we show the phase correlation between @xmath26 and @xmath67 at the 1700th chain step in the left panel of fig .",
    "[ fig_phrs ] .",
    "the correlation is almost unity at large scales , and drops quickly around @xmath211 , consistent with our test results presented above .    in the left panel of fig .",
    "[ fig_ps ] we compare a converged hamiltonian spectrum , @xmath273 , with the analytic linear power spectrum , @xmath15 , used in the prior .",
    "as one can see , @xmath273 is very close to @xmath15 over the entire range of scale . in particular ,",
    "the discrepancy around @xmath211 is also small .",
    "the distribution of the reconstructed initial density field is extremely close to gaussian , as shown in the upper three panels of fig .",
    "[ fig_mgau ] .",
    "as described above , we can also renormalize the reconstructed linear power spectrum by visually identifying the discrepancy region * ( @xmath274 ) * and scaling the corresponding @xmath275 with a factor @xmath220 .",
    "the new power spectrum so obtained and the distributions of the re - normalized @xmath38 are also shown in the corresponding figures . since the discrepancy is tiny , the curves before and after the renormalization are undistinguishable in the figure . as shown in the upper panels of fig .",
    "[ fig_mgau ] , these re - normalized @xmath38 are well described by a gaussian function with unity variance .",
    "these results demonstrate clearly that our hmc method works well on large scales .    to examine the performance of our hmc method on small scales , we perform a high resolution run ( hrr ) with a small smoothing scale .",
    "this is a cubic box of side @xmath276 located in the inner region of the survey volume , put inside a larger periodic box with @xmath277 .",
    "we divide the larger box into @xmath199 grids in each dimension , and adopt a smoothing scale of @xmath278 , for which our reconstructed density field is in good agreement with the original simulation . only grid cells that are located within both the small box and the survey volume",
    "are assigned a weight of unity .",
    "all other grid cells are assigned a weight of zero .",
    "note that some grids in the small box may not be in the survey volume , because of the existence of small holes in the survey mask .",
    "the other parameters are chosen to be the same as in the lrr .",
    "on average the hrr takes 222 seconds for each hmc step , and the acceptance rate is about @xmath279 .",
    "the chain finally converges to @xmath280 , corresponding to a rms of @xmath281 in the difference between @xmath272 and @xmath10 .",
    "the corresponding phase correlation is shown in the right panel of fig .",
    "[ fig_phrs ] . here",
    "we see a significant correlation all the way to @xmath282 , a scale much smaller than the translinear scale which corresponds to @xmath261 .",
    "the converged @xmath273 and the distributions of @xmath204 for the hrr are shown in figs .",
    "[ fig_ps ] and [ fig_mgau ] . here",
    "we see a significant bump at @xmath283 @xmath273 compared with @xmath15 .",
    "the reason for this bump is twofold .",
    "first , the bump is around @xmath211 , suggesting that it is a compromise between the prior constraint and the likelihood ( see section [ sec : sim ] ) .",
    "second , the bump is partly ascribed to the inaccuracy in the adopted approximation of the structure formation model on small scales . according to tz12",
    ", the mode - coupling term , @xmath284 , can not be neglected at @xmath285 ( see their figure 1 ) . on such scales ,",
    "the amplitude of @xmath286 predicted by the mza is somewhat lower than that of the fully evolved density field . to achieve a small @xmath169 in the hmc , the hamiltonian spectra have to be enhanced to compensate the deficit . on even smaller scales , @xmath287",
    ", however , the hamiltonian force is dominated by the prior term so that @xmath288 is forced back to @xmath15 . despite of this inaccuracy , our hmc method can still recover more than half of the phase correlation all the way to @xmath289 , as demonstrated in the next section .",
    "as before , we re - normalized the amplitudes of the fourier modes to correct for the discrepancy in the range of @xmath290 . the corrected power spectrum and distribution of the re - normalized @xmath38 ,",
    "are shown in the right panel of fig .",
    "[ fig_ps ] and the lower panels of fig.[fig_mgau ] , respectively .",
    "we only show the results at the 1700th chain steps for both the simulated and reconstructed density fields in all figures ( except in fig . [ fig_ins ] and [ fig_evps ] where results are shown for different steps ) . because we just want to reconstruct the linear density field rather than to draw a sample for statistical study ( see section [ sec_goal ] for our objective in detail ) , it is not necessary to show the results for all chain steps .",
    "in fact , the accepted samples after burn - in have very similar hamiltonian power spectra and @xmath291 ( see e.g. figs . [ fig_ins ] and [ fig_evps ] ) , the results at all other steps are very similar to those that are shown .",
    "the choice of the 1700th step is arbitrary ; the only requirement is that the chain at this step has already converged .",
    "moreover , in order to investigate whether the results are sensitive to the choice of the initial set of @xmath38 , we have performed tests with different initial sets of @xmath38 and found the results change very little .",
    "for example , the changes in @xmath179 and the phase correlation functions are small .",
    "up to now , all our results are based on the structure formation model of tz12 .",
    "the advantage of using the tz12 model is that it is very fast and can thus be implemented into our hmc to infer the initial linear density field .",
    "however , the tz12 model is not expected to work accurately in the highly non - linear regime .",
    "although the modeled density field shown above is closely correlated with the input present - day density , it is unclear to which extent the density field _ fully _ evolved from our reconstructed linear density field matches the original simulated density field , especially on small scales where non - linear evolution becomes important . in order to test the model in the highly nonlinear regime",
    ", we need to use full @xmath0-body simulations to evolve our reconstructed initial linear density field to the present day and to compare the resimulation with the original simulation .",
    "to do this we set up the initial condition for our constrained n - body simulation using the renormalized @xmath13 .",
    "we generate the initial displacement field at a given high redshift , @xmath292 , using the zeldovich approximation .",
    "the displacement field is used to perturb the positions of the n - body particles that initially have uniform distribution .",
    "each particle is assigned a velocity according to the growing mode solution of the linear perturbations .",
    "we then use the n - body code gadget-2 ( springel 2005 ) to evolve the initial condition to the present day .",
    "the fully evolved density field is referred to as the resimulated density field , and denoted by @xmath293 .",
    "let us first consider @xmath13 reconstructed from the original simulated density field , i.e. @xmath163 ( section [ sec : sim ] ) .",
    "for our primary test , we use @xmath294 particles in a box of @xmath295 to trace the evolution of the density field . as shown in table .",
    "[ tab_hmc ] , we adopt an initial redshift @xmath296 , a particle mass @xmath297 and a force softening length @xmath298 . the dashed black line in fig .",
    "[ fig_phcr ] shows the phase correlation between @xmath293 and @xmath25 .",
    "as can be seen , this phase correlation is very similar to that between @xmath67 and @xmath25 .",
    "we also show the results of the resimulation from the reconstructed linear density field using @xmath299 and @xmath300 , respectively . for the test with @xmath200 ,",
    "the phase correlation is again very similar to that between @xmath301 and @xmath25 , suggesting that the mza works well up to @xmath302 . in the test with @xmath303",
    ", however , the @xmath293 - @xmath25 correlation is much stronger than the @xmath67 - @xmath25 correlation at @xmath304 .",
    "given that the hmc method tends to minimize the difference between @xmath67 and @xmath25 , it is unexpected that the @xmath67 - @xmath25 correlation is much weaker than the @xmath293 - @xmath25 correlation at @xmath304 .",
    "the most important difference between @xmath67 and @xmath293 is that the later is the result of fully non - linear process , in which the mode of the non - linear density field on small scales may be coupled to that on large scales ( see , e.g. , tassev & zaldarriaga 2012a ) .",
    "consequently , part of phases at @xmath304 , where the initial phases are not well constrained , is reproduced in the re - simulation .",
    "such mode coupling is not included in the tz12 model based on quasi - linear theory , so that the phase information in @xmath25 at @xmath305 is almost completely lost in @xmath67 .",
    "our above results clearly show that the match between the resimulation and the original simulation is better at smaller @xmath84 . to quantify this trend",
    ", we introduce a quantity @xmath306 to measure the scale at which @xmath293 can well match @xmath25 .",
    "it is defined in such a way that the phase correlation between the two density fields at @xmath306 is half . in fig .",
    "[ fig_rskh ] , we show @xmath306 as a function of @xmath84 . on large scales",
    ", @xmath306 increases with decreasing @xmath84 , consistent with expectation because information of the density field on scales below @xmath84 is lost due to the smoothing . as it reaches about unity",
    ", however , the value of @xmath306 becomes insensitive to @xmath84 .",
    "this is also expected , because the tz12 model is not expected to work accurately on very small scales .",
    "this demonstrates that in order to reconstruct the density field on scales below @xmath289 , one has to use a model that is more accurate than the tz12 model adopted here .",
    "in this subsection , we use @xmath0-body simulations to evolve the initial conditions obtained from the present - day density field reconstructed from the mock catalogs ( @xmath307 , section [ sec : mocktest ] ) . for reference",
    "we list the parameters for both lrr and hrr in table [ tab_hmc ] . to inspect our results visually , we present density maps of the same thin slices in the original simulation used to construct the mock catalog , the density field reconstructed from the mock catalog , and the density field in the re - simulations . fig .",
    "[ fig_dcl ] shows the results for the lrr . here",
    "all density fields are smoothed with a gaussian kernel with @xmath308 . within the survey volume ,",
    "the three maps look quite similar ; almost all structures in the original simulation , such as massive clusters , filaments and underdense voids , are reproduced in the re - simulation .",
    "the density maps for the hrr , smoothed with @xmath249 , are presented in fig .",
    "[ fig_dcs ] .",
    "there are about twenty bright spots in the original simulation , which correspond to a single halo or a cluster of a few haloes with masses down to about a few times @xmath309 .",
    "most of these structures are clearly reproduced in our resimulation .",
    "in addition , some small filaments in the original simulation are also correctly reproduced in the re - simulation .",
    "this is quite remarkable , given that our reconstruction from the mock catalog uses only groups with assigned masses above @xmath310 and that non - linear effects are important on such small scales .    in the left panel of fig .",
    "[ fig_rhors ] we show the comparison of @xmath293 with @xmath26 and @xmath25 for the lrr .",
    "there is weak bias at the high density end in both relations : while @xmath293 is higher than @xmath26 , it is slightly lower than @xmath25 . since the initial condition for the resimulation",
    "is constrained by the reconstructed density field , the @xmath293 - @xmath26 relation is much tighter than the @xmath293 - @xmath25 relation .",
    "the typical dispersion in the former relation is about 0.05 dex , while it is about two to three times larger in the latter relation .",
    "the phase correlations among the three density fields are shown in the left panel of fig .",
    "[ fig_phrs ] .",
    "similar to the @xmath67 - @xmath26 correlation , there is a sharp transition in the correlation coefficient from unity to about zero around @xmath211 . upon closer examination",
    ", we find that the @xmath293 - @xmath25 phase correlation is always lower than the minimum of the @xmath293 - @xmath26 and @xmath26 - @xmath25 phase correlations .",
    "this is expected , as the accuracy of the resimulation depends both on the accuracy of the hmc method , which determines the strength of the @xmath293-@xmath26 correlation , and the accuracy in the reconstruction of the present - day density field , which determines the strength of the @xmath26-@xmath25 correlation .",
    "the comparisons of @xmath293 with @xmath26 and @xmath25 for the hrr are shown in the right panel of fig .",
    "[ fig_rhors ] . as one can see ,",
    "@xmath293 is also strongly correlated with both @xmath26 and @xmath25 .",
    "the scatter in the @xmath311-@xmath25 correlation is less than 0.2 dex in most density bins . at the high - density end ,",
    "a weak bias is present in the @xmath293- @xmath26 relation , but such a bias is absent in the @xmath293 - @xmath25 relation . at the low - density end ( @xmath312 ) , @xmath293 is correlated neither with @xmath26 nor @xmath25 .",
    "the reason is that in our reconstruction of the present - day density field using mass distributions around haloes , the minimum of the density profiles in the domain is about @xmath313 ( fig .",
    "[ fig_dp12 ] ) .",
    "therefore the information in the most underdense regions is totally lost when reconstructing the present - day density field .",
    "this bias can be mitigated by adopting a smaller mass threshold @xmath244 for the group catalogue .",
    "the usage of a smaller @xmath244 can lower the minimum density that our reconstruction can reach ( see wang et al .",
    "2009a ) .",
    "the phase correlations for the hrr are presented in the right panel of fig .",
    "[ fig_phrs ] .",
    "the phase correlation between @xmath293 and @xmath26 declines gradually around @xmath211 .",
    "similar to the results shown in the previous subsection , this correlation is much stronger than the @xmath314 - @xmath26 correlation at @xmath304 .",
    "as discussed above , this is due to mode coupling which is not fully included in the tz12 model .",
    "moreover , the @xmath26 - @xmath25 phase correlation lies below the @xmath293 - @xmath26 phase correlation at almost all scales .",
    "it indicates that , on the smoothing scale @xmath249 , the accuracy of the re - simulation in matching the original density field is mainly limited by the reconstruction of the present day density rather than by the hmc method . despite all of these",
    ", the match between the resimulation and the original simulation is remarkable . at @xmath315 ,",
    "the phase correlation between @xmath293 and @xmath25 is still as high as 0.6 ; even at @xmath316 , about half ( @xmath317 ) of the phase information is reproduced .",
    "we recall again that the translinear scale corresponds to @xmath318 .",
    "we also perform tests with other values of @xmath84 and measure @xmath306 , at which the phase correlation between the resimulation and original simulation is half .",
    "we show @xmath306 as a function of @xmath84 as the dashed line in fig .",
    "[ fig_rskh ] .",
    "one see that the value of @xmath306 first increases with decreasing @xmath84 then remains almost constant , and has the maximum of @xmath319 at @xmath278 .",
    "the curve generally lies below that based on original simulated density field ( solid line ) , because the reconstruction of the present - day density field is not perfect .",
    "note that at @xmath249 , the value of @xmath306 obtained from the reconstructed present - day density field is similar to that obtained from the simulated present - day density field , because on such small scales the inaccuracy of the tz12 model becomes the dominating source of error in the reconstructed initial condition .",
    "in this paper we have developed an effective method to reconstruct the linear density field that underlies the formation of the cosmic density field in the local universe . to this end",
    "we have developed a hamiltonian markov chain monte carlo ( hmc ) method which allows us to generate the linear density field based on a posterior probability function .",
    "this distribution consists of two components , a prior term which takes into account the gaussianity and power spectrum assumed for the linear density field , and a likelihood term designed to ensure that the predicted density field from the initial condition matches a given final density field .",
    "we adopt the modified zeldovich approximation developed by tz12 to model the final , evolved density field off the initial , linear density field .",
    "the hmc method is based on an analogy to a physical system .",
    "the potential is taken to be minus the logarithm of the posterior function .",
    "the momenta are drawn from given gaussian distributions before each chain step so that the fictitious system can continue to equilibrate and  orbit \" within the extended potential well with the passage of  time \" .",
    "the system eventually converges to a state in which balance between kinetic and potential  energy \" is achieved . using a simulated density field ,",
    "we demonstrate that our hmc method converges very quickly , and that the converged linear density fields closely follow a gaussian distribution with a spectrum that accurately matches the input linear power spectrum .",
    "a small discrepancy is found at the scales where the likelihood and prior terms in the hamiltonian force are comparable .",
    "this discrepancy , however , can straightforwardly be corrected for by re - normalizing the amplitudes of the corresponding fourier modes ( while keeping their phases fixed ) with the input linear spectrum .",
    "we find that the modeled density field matches the input density field with high precision , with a rms difference typically smaller than @xmath320 .",
    "since our hmc method needs the present - day density field as a constraint in reconstructing the initial linear density field , we also present a method to reconstruct the present - day density field from mock galaxy and group catalogues .",
    "the mock catalogues are constructed from the ms simulation for the sdss dr7 , taking detailed account of the angular variation of the magnitude limit and the survey completeness ( wang et al .",
    "2012a and the references therein ) so that we can verify the reliability of our method in real applications .",
    "we use the method developed by wang et al .",
    "( 2009a ) to reconstruct the density field based on the mock group catalogue , taking into account inaccuracies in the group finder , as well as uncertainties arising from the assignment of a halo mass to each individual group and the redshift space distortions .",
    "we find that the phase correlation between the reconstructed and simulated density fields is almost perfect at large scales , with a correlation coefficient close to one .",
    "the scale at which the correlation coefficient drops to 0.5 is @xmath321 , indicating that our method works surprisingly well down to scales that are well into the non - linear regime .",
    "we apply the hmc method to the reconstructed density field in two different volumes .",
    "the first one ( lrr ) is the entire survey volume of the sdss embedded in a periodic box of size @xmath233 , and the second one ( hrr ) is a cubic box of size @xmath276 covering the inner region of the survey volume .",
    "these two applications are used to test and verify the performance of the hmc method over a wide dynamic range . as an additional test of the performance of our methods , we use the reconstructed linear density fields of lrr and hrr to generate initial conditions , which we subsequently evolve to the present day using a @xmath0-body simulation code . both visual inspection and",
    "quantitative analysis show that the density field obtained from these re - simulations accurately match the density field of the original simulation used to construct the mock catalog .",
    "in particular , the phase correlation between re - simulation and original simulation has a coefficient close to unity on large scales and only starts to drop to 0.5 at @xmath322 .",
    "this clearly demonstrates that our hmc method together with the reconstruction method of wang et al .",
    "( 2009a ) provides a robust way to reconstruct the initial conditions for the local cosmological density field from observational data .",
    "numerous studies in the past have tried to infer the initial conditions of structure formation in the local universe using observational data such as galaxy distributions and/or peculiar velocity surveys ( e.g. nusser & dekel 1992 ; weinberg 1992 ; kolatt et al .",
    "1996 ; klypin et al . 2003 ; dolag et al . 2005 ; lavaux 2010 ) .",
    "most of these studies integrate the observed density field _ backwards _ in time to some initial time .",
    "however , these approaches suffer from complications in the observational data , such as spatial variations in the magnitude limit and complex survey boundaries , as well as the amplification of noise and numerical errors by the decaying mode during backward integration ( nusser & dekel 1992 ) .",
    "as pointed out by jw13 , these problems can be overcome by the hmc method .",
    "the amplification of noise and numerical errors is not an issue since the hmc method uses _ forward _ evolution of the cosmic density field ( see also kitaura 2013 ) , and the survey geometry is taken into account by the weight field in the likelihood .",
    "finally , it is worth emphasizing that some of the previous methods had to gaussianize the inferred initial density field using some order - preserving transformation . in the hmc method adopted here",
    ", however , the initial density field is gaussian by the construction of the posterior .",
    "our own hmc method has some unique advantages .",
    "we design the likelihood using the present - day density field reconstructed from galaxy groups ( i.e. , dark matter haloes ) , rather than the galaxy distribution itself .",
    "the latter requires a detailed understanding of how galaxies are biased relative to the underlying dark matter distribution ( see e.g. kitaura & enlin 2008 ) . as mentioned earlier , this bias between galaxies and dark matter is far from trivial ; it depends on galaxy properties , has stochastic and non - linear contributions , and may even be non - local .",
    "adopting a simple linear bias model would significantly underestimate the density in high density regions .",
    "currently it is still unclear how to directly use the galaxy distribution to model the density field , especially in high density region , in an unbiased way .",
    "another problem with using the galaxy distribution is that the constraint becomes very poor in underdense regions , where only few or no galaxies can be observed in a uniformly selected galaxy sample ( jw13 ) . in our approach , these problems are largely absent .",
    "as shown in section [ sec_denrc ] , the reconstructed density fields based on the detailed mock catalogues match the input density field very well over a large dynamical range .",
    "furthermore , since our reconstruction relies on groups ( haloes ) , we can accurately reproduce the high density regions within individual haloes . in underdense regions , using the density profiles in the domains of haloes can recover the density field down to @xmath323 . and in principle",
    ", we can recover even lower densities by simply using groups ( haloes ) above a lower mass threshold , although this requires either a deeper redshift survey , or the use of a more limited volume .",
    "the use of groups to trace the large - scale density field can effectively mitigate the problem due to the finger - of - god effect , which may severely impact the reconstruction if not properly handled .",
    "the reliability of our reconstruction is further demonstrated by the fact that the resimulations from the initial conditions constrained by the reconstruction match the original simulation remarkably well in the same density range .",
    "moreover , our hmc method works in fourier space .",
    "different fourier modes are mutually independent in the prior , and so are the real and imaginary parts of individual modes .",
    "this enables us to derive simple formulae for both the prior and likelihood terms in the hamiltonian force , and makes the computation much faster .",
    "as shown in table [ tab_hmc ] , it takes , on average , only about 21 , 220 and 2100 seconds for each step for @xmath148 , @xmath149 and @xmath150 respectively .",
    "particularly , our method can successfully handle more than one hundred million free parameters !",
    "such efficiency is crucial when aiming to achieve high resolution in a large volume .    in forthcoming papers",
    ", we will apply our reconstruction and hmc methods to the sdss dr7 group catalogue in order to generate the initial conditions for structure formation in the sdss volume .",
    "we will then use these initial conditions to run constrained simulations to study the evolution of the local cosmic density field .",
    "this will provide a unique opportunity to further our understanding of the formation and evolution of the galaxies we directly observe .",
    "for example , one can investigate the correlation between the large scale environments , measured from the constrained simulation , and the observational galaxy properties .",
    "recent studies have found significant dependencies of halo properties on the large - scale environments , in particular the large scale tidal fields ( see e.g. wang et al . 2011 and the references therein ) , and it would be interesting to see whether this is also the case for galaxies that reside in haloes .",
    "one can also perform semi - analytical models of galaxy formation using halo merger trees extracted directly from the constrained simulations .",
    "the comparison between model galaxies and real galaxies in the same large scale structures , such as filaments , sheets and clusters , will provide us an avenue to constrain galaxy formation in a way that is free of cosmic variance .",
    "finally , the constrained simulation can also be used to study the physics and dynamics of the igm .",
    "for instance , the hot gas and peculiar velocities predicted by the constrained simulations can be used to make predictions for the ( both thermal and kinetic ) sunyaev - zeldovich effects , which can be compared with ( forthcoming ) observations . moreover",
    ", a comparison of the simulated density field with quasar absorption lines in a wide range of ionization potentials can provide constraints on the metallicity and temperature of the baryonic gas inside cosmic web ( cen & ostriker 1999 ) .",
    "such studies will provide a unique way for understanding the nature of the low-@xmath91 absorption systems and the state and structure of the igm .",
    "in particular , it will allow a detailed exploration of the connection and interaction between the galaxy population and the igm .",
    "this work is supported by nsfc ( 11073017 , 10925314 , 11128306 , 11121062 , 11233005 ) , ncet-11 - 0879 and the fundamental research funds for the central universities .",
    "hjm would like to acknowledge the support of nsf ast-0908334 and the cas / safea international partnership program for creative research teams ( kjcx2-yw - t23 ) ."
  ],
  "abstract_text": [
    "<S> our research objective in this paper is to reconstruct an initial linear density field , which follows the multivariate gaussian distribution with variances given by the linear power spectrum of the current cdm model and evolves through gravitational instability to the present - day density field in the local universe . for this purpose </S>",
    "<S> , we develop a hamiltonian markov chain monte carlo method to obtain the linear density field from a posterior probability function that consists of two components : a prior of a gaussian density field with a given linear spectrum , and a likelihood term that is given by the current density field . </S>",
    "<S> the present - day density field can be reconstructed from galaxy groups using the method developed in wang et al . </S>",
    "<S> ( 2009a ) . using a realistic mock sdss dr7 , obtained by populating dark matter haloes in the millennium simulation with galaxies , </S>",
    "<S> we show that our method can effectively and accurately recover both the amplitudes and phases of the initial , linear density field . to examine the accuracy of our method </S>",
    "<S> , we use @xmath0-body simulations to evolve these reconstructed initial conditions to the present day . </S>",
    "<S> the resimulated density field thus obtained accurately matches the original density field of the millennium simulation in the density range @xmath1 without any significant bias . </S>",
    "<S> especially , the fourier phases of the resimulated density fields are tightly correlated with those of the original simulation down to a scale corresponding to a wavenumber of @xmath2 , much smaller than the translinear scale , which corresponds to a wavenumber of @xmath3 . </S>"
  ]
}