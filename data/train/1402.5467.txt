{
  "article_text": [
    "high fidelity controlled - phase ( cz ) gates were recently demonstrated for adjacent qubits in a 5-qubit quantum processor @xcite .",
    "for a two - qubit gate , cz fidelity as high as 99.4% was obtained using the phase shift from near crossing of the @xmath0 and @xmath1 states , similar to previous work on superconducting qubits @xcite , but following a new `` fast adiabatic '' protocol that gives both fast gate times and low error rates . here",
    "we explain the theoretical concepts behind this protocol , showing how waveforms may be generated and parameterized in a manner that is readily optimized , both numerically and experimentally .",
    "the general problem of achieving fast adiabatic performance is of great interest to the physics community @xcite , with applications in coherent manipulation , precision measurements , and quantum computing .",
    "finding an improved control methodology therefore has potential for applications in a variety of quantum systems .",
    "although adiabatic quantum control has a long history , we are not aware of a theory that could address in detail our particular experimental problem : what is the optimal control trajectory for the desired cz operation , having both short gate time and small non - adiabatic error , described in a way that is readily optimized with numerical and experimental methods . for example , although a previous experiment used adiabaticity for a cz gate @xcite , the characterization and optimization of the adiabatic control waveform was not developed .",
    "the goal here is to describe a simple theory that can be used to intuitively understand optimal waveforms for fast and accurate operation .",
    "since we are concerned here with transition errors between the states @xmath0 and @xmath1 as their frequencies are varied , we may map this to a qubit problem for states @xmath4 and @xmath5 that has a fixed energy in @xmath6 from the avoided - level crossing and adjustable qubit frequency in @xmath2 .",
    "we note that this optimization problem differs from conventional quantum control , where the @xmath2 part of the hamiltonian is fixed and both the @xmath6 and @xmath7 parts can be varied . here , the single - component control in @xmath2 makes optimal control much more difficult since a second operator does not exist that could be used to restore the desired adiabatic character @xcite , disallowing standard pulse shaping techniques @xcite and `` superadiabatic '' theory @xcite .",
    "the set of possible adiabatic solutions is also influenced by other constraints with the superconducting qubit system .",
    "first , the non - linearity of the qubits is small @xcite , so other unwanted transitions are not necessarily far off resonance .",
    "for example , although the waveform is optimized for adiabaticity of the near resonance @xmath0 and @xmath1 states , fast changes in the control waveform may produce transitions between the states @xmath8 and @xmath9 , even though off resonance by @xmath10 .",
    "a natural solution to this constraint is using smooth waveforms , which also seems to be a good strategy in terms of controlling many qubits , achieving low crosstalk , and simplifying the requirements of control electronics and their system calibration .",
    "we thus rule out pulse and refocussing type protocols common in nuclear magnetic resonance ( nmr ) @xcite , but welcome any theory making this a practical solution .",
    "second , we are looking for control waveforms with fast gate times , of order @xmath11 for our qubits , that efficiently uses the moderate coupling @xmath12 between qubits @xcite ; note that @xmath13 , making this problem non - trivial for adiabaticity .",
    "fast gates are important for coherence , especially since errors from 1/f flux noise and off - resonant coupling to other qubits , described as frequency shifts , produce phase errors proportional to characteristic gate times : if limited by these processes , the error probability thus scales as the _ square _ of gate time .",
    "a full system optimization of a qubit processor , for example describing the optimal choice of on - resonance qubit - qubit coupling @xmath14 and its smaller off - resonant coupling , is beyond the scope of this article .",
    "but clearly even a small improvement of gate time can be quite important , motivating here a detailed understanding of both fast and accurate control .",
    "third , the cz gate uses adiabatic control that is non - standard , as it partially moves into the avoided level crossing regime and then back out again , with the amplitude and time of the waveform adjusted to give a @xmath15 phase shift to the @xmath0 state .",
    "typical solutions to an adiabatic problem consider moving through an avoided - level crossings @xcite , so a theory is needed to calculate optimal waveforms for an arbitrary control problem .",
    "since one varies only a single control parameter in @xmath2 , this theory may be described in a simple manner with familiar concepts that give insight into a physical understanding of adiabatic behavior .",
    "we first show how state change from @xmath2 control in the qubit hamiltonian can be intuitively described in an instantaneous coordinate system . here",
    ", the evolution of the quantum system can be understood in the small error limit using a geometrical construction .",
    "second , this description allows errors to be calculated using a generalized fourier transform .",
    "third , to obtain a minimum time solution for small changes in angle , the theory of window functions is used to find optimal control waveforms .",
    "we then show how to efficiently parameterize the optimum waveform using a few - term fourier series .",
    "lastly , a non - linear mapping is used to find the optimal control waveform for an arbitrary change in the control .",
    "we also examine a second problem , microwave control of a qubit , and show that conventional two - component optimal control using @xmath6 and @xmath7 gives better results as expected , but not by much .    these results",
    "present a simple yet effective way to optimize for adiabatic fidelity when changing control only in @xmath2 .",
    "perhaps surprisingly , non - adiabatic errors can be small even if the interaction time is only slightly larger than the time scale of the transverse coupling , similar to that proposed earlier for a non - adiabatic gate @xcite . a recent experiment by our group",
    "has also demonstrated that these theoretical ideas can be used to optimize cz performance @xcite .",
    "we start with a geometrical solution to non - adiabatic error , a problem previously described using conventional methods @xcite .",
    "the description of a qubit given by the 2-state hamiltonian is @xmath16 where @xmath17 is constant and the qubit frequency is controlled by a time dependent @xmath18 , for example the magnetic field in the z - direction for an electron spin .",
    "we consider the qubit to be controlled by a hamiltonian vector @xmath19 , having both length and direction . as shown in fig.[fig : bloch]a , we define the control parameter @xmath20 as the angle between the hamiltonian vector and the z - axis @xmath21    the qubit state is described by a bloch vector that can point in any direction on the bloch sphere . here , the usefulness of this geometric construction is the idea that the lowest energy eigenstate has a bloch vector that points in the direction of the control vector : the eigenstate vector has angle @xmath20 from vertical and lies in the plane of the @xmath22 and @xmath23 axes .",
    "the ground state eigenvalue @xmath24 is proportional to the length of the control vector , whereas the excited eigenstate points in the opposite direction with eigenenergy @xmath25 .",
    "if the bloch state vector is not an eigenstate , then its time dynamics is to rotate ( precess ) around the eigenstate vector at a frequency proportional to the difference in eigenstate energies @xmath26     geometric picture of non - adiabatic errors .",
    "a ) control field of constant @xmath17 and variable @xmath18 gives control angle @xmath20 from z - axis .",
    "b ) bloch sphere representation gives ground eigenstate parallel to control vector ( solid arrow ) .",
    "for a small step in @xmath20 , the quantum state ( gray arrow ) points slightly away , with change @xmath27 ( small gray arrow ) .",
    "this state rotates around the eigenstate at frequency @xmath28 ( gray dotted lines ) .",
    ", scaledwidth=48.0% ]    non - adiabatic errors are typically understood by considering the landau - zener trajectory @xmath29 .",
    "initially at large negative times @xmath30 , where @xmath31 is large and negative , the hamiltonian control vector points in the down direction , with the state given by the bloch vector also in the down direction having @xmath32 .",
    "as the time goes to zero , the control vector @xmath33 points along the equator , with the bloch vector @xmath34 . at large positive times",
    "the control and bloch vector points in the up direction @xmath35 .",
    "when the field is slowly varied @xmath36 , the state adiabatically changes from @xmath32 to @xmath35 .",
    "a finite ramp rate gives errors , with the probability to make a transition to the excited final eigenstate as @xmath37 a small final error @xmath38 implies the condition @xmath39 .",
    "if we assume a change in @xmath31 from @xmath40 to @xmath41 , the total time for the control pulse is @xmath42 , where @xmath43 is the oscillation time for the transverse hamiltonian .",
    "the factor 18.6 implies a long control time for the landau - zener trajectory .",
    "we will show with optimal control this time factor can be reduced significantly , to order unity .    for adiabatic evolution of the quantum state ,",
    "the state vector stays aligned with the direction of the control hamiltonian . to better characterize non - adiabatic errors",
    ", we change the reference frame of the bloch sphere to coincide with that of the control hamiltonian . in this moving frame",
    "@xmath44 represents being in the ground state of the instantaneous hamiltonian , with no non - adiabatic error .    to understand non - adiabatic deviations , we consider the time dynamics of state change .",
    "we first consider an infinitesimal time step @xmath45 , during which the the control vector initially changes its direction by @xmath27 , as shown in fig.[fig : bloch]b .",
    "a transformation to the new moving frame produces a small change in the angle of the bloch vector @xmath46 . during the remainder of the time @xmath45 the bloch vector rotates around the @xmath47 axis , at the frequency @xmath28 . starting with @xmath48 before this time step ,",
    "the angles @xmath49 and @xmath50 in the x- and y - direction can be written compactly as @xmath51 after time @xmath45 , assuming small angles as appropriate for small non - adiabatic errors .",
    "this finite angle implies the quantum state has not changed adiabatically ( as @xmath52 ) , with the error probability given by @xmath53 .",
    "we next understand the error coming from a sequence of time steps @xmath54 each with a small angle change @xmath55 .",
    "a useful simplification comes from changing to a new frame that rotates with the precession of the bloch vector , which implies the above @xmath56 vector does not rotate .",
    "instead , the change @xmath57 rotates in time by an angle @xmath58 , which is computed by summing over all the previous phase changes in the individual steps .",
    "the net change in the complex angle of the bloch vector in this moving and rotating frame is @xmath59 \\ , \\label{glint}\\\\ p_e&= |\\theta_{mr}|^2/4 \\ , \\end{aligned}\\ ] ] where @xmath60 is the total probability error .",
    "these equations are the general solution for non - adiabatic error in the small error limit , derived here using a geometric description .",
    "the amplitude error @xmath61 is proportional to the rate of change in the eigenstates , as given by @xmath62 .",
    "this quantity is mostly averaged to zero because of the rapidly changing phase from the @xmath28 integral , with averaged amplitude decreasing with increasing qubit frequency @xmath28 .",
    "note that we have assumed here that all changes add linearly .",
    "this is a good assumption as long as the net change in angle is very small ; for example , it is known that for qubits with small change in state can be approximated by a harmonic oscillator , a linear system .",
    "this assumption is generally acceptable since we are only interested in qubit control that give small errors .",
    "an exact calculation of the error , starting from the schrdinger equation , is derived in appendix i. it gives results identical to this geometrical solution in the small error limit .",
    "there are two changes for the exact solution : the driving amplitude @xmath62 should also be multiplied by the factor @xmath63 , and the probability is @xmath64\\}^2 $ ] .",
    "to understand how to construct an optimal waveform , we first note that there is a trade - off between the control time and the magnitude of non - adiabatic error .",
    "zero error is not possible - we are instead looking for acceptably small errors , say below @xmath3 , with as short of a control time as possible .",
    "we also want stable control waveforms , so that the error does not increase rapidly for small changes in the waveform .",
    "we first note that non - adiabatic errors are proportional to a change in the control variable @xmath20 .",
    "errors will be relatively small when @xmath65 , due to the slow dependence of @xmath20 on @xmath66 and the large oscillation frequency @xmath28 , as described in eqs.([eq : theta ] ) and ( [ eq : omega ] ) .",
    "for the case where @xmath31 only changes by a small amount , the qubit frequency can be approximated as being constant @xmath67 . then eq.([glint ] ) is just the fourier transform of @xmath62 at frequency @xmath68 , which gives a probability proportional to the power spectral density of the signal at the oscillation frequency @xmath68 @xmath69 this makes sense physically since it is power at the transition frequency , given by @xmath70 , that drives the qubit transition to produce errors .",
    "( color online ) waveform and power spectral density @xmath71 , for a small change in control @xmath20 such that the qubit frequency is approximately constant @xmath67 . here , the spectral density is dimensionless and proportional to the qubit error @xmath72 , valid in the limit of large @xmath73 .",
    "a ) plot of waveform @xmath62 versus @xmath74 for a rectangular pulse ( i , black ) , hanning window ( 1 , blue ) , slepian ( ii , gray ) , and optimized fourier coefficients with two ( 2 , red ) , four ( 4 , green ) , and ten ( 10 , cyan ) terms .",
    "note the similarity of the slepian curves to the optimized fourier functions , except near @xmath75 .",
    "b ) plot of power spectral density obtained from a fourier transform of the waveforms in a ) .",
    "all waveforms are normalized to have unit area .",
    "the vertical dashed line shows spectral cutoff for minimization of integrated noise .",
    ", scaledwidth=48.0% ]    for the simple case of a linear change in the control @xmath20 from @xmath76 to @xmath77 , the error is proportional to the ( constant ) derivative @xmath78 , shown as the black line in fig.[fig : theta]a .",
    "the error versus the pulse time @xmath73 is the power spectral density of a rectangular pulse @xmath79 which corresponds to the square of the sinc function .",
    "although the error is zero when @xmath80 , small errors occur only around a small range of this time , so we consider this solution not to be stable or practically useful . for large times , the general falloff of the error is quite slow , scaling as @xmath81 , so this control waveform does not present a good solution to adiabatic control .",
    "the functional dependence of the error versus pulse time can be changed by using different control waveforms @xcite .",
    "another example is the function @xmath82/2 $ ] , known as the hanning window , as shown in blue in fig.[fig : theta ] . in this case , the error is @xmath83 where the first zero is at twice the time of the square window @xmath84 , but the error falls off more quickly as @xmath85 at large times .",
    "although this window function is superior to the square window , the errors are still somewhat large right after the first zero , so other window functions should be considered .    as well known from nmr @xcite , optimizing non - adiabatic error versus total control time @xmath73",
    "can be understood as optimizing windowing functions : the optimization criteria depend on the requirements for a particular application .",
    "since we are interested in low errors for a range of pulse times , we define the optimal waveform as one that gives low error for any time larger than some chosen time : this definition is essentially equivalent to adiabatic behavior .",
    "we can use the theory of optimal window functions in signal processing to find this control waveform , known as a slepian @xcite .",
    "this function is defined by finding the optimal waveform that minimizes the integrated spectral density above a chosen frequency .",
    "for example , the slepian waveform optimized for frequencies above @xmath86 is shown in gray in fig.[fig : theta ] .",
    "although the first minimum is at slightly longer times than for the hanning window , the error is always below @xmath87 above this value .",
    "a different slepian cutoff parameter can be used to tradeoff the maximum error for the time of the first minimum .",
    "a disadvantage of the slepian function is that it does not go to zero at the beginning and end of the pulse , which creates a sharp edge as for a rectangular pulse .",
    "this makes the function harder to synthesize , since real waveform generators have finite response times .",
    "a practical way around this issue is to find a near optimum solution using fourier basis functions @xcite given by @xmath88 \\",
    ", \\label{eq : dth}\\end{aligned}\\ ] ] which goes smoothly to zero at the beginning and end of the pulse .",
    "the coefficients are constrained by the height of the pulse @xmath89 using standard numerical minimization ( function in matlab ) , the coefficients @xmath90 can be found that optimizes for the minimum integrated spectral density , as for the slepian .",
    "the waveform and spectral densities for @xmath91 and @xmath92 are plotted in fig.[fig : theta ] , which shows performance close to the slepian .",
    "coefficients are given in table[tab : lamfourier ] , showing the first two are dominant .",
    "it is particularly interesting to note that the waveform for @xmath93 ( red ) , with only 2 fourier coefficients , is reasonably close in shape to the slepian and has acceptably small errors @xmath94 .",
    ".[tab : lamfourier ] table of @xmath95 coefficients obtained from numerical minimization of noise for frequencies @xmath86 , using the constraint @xmath96 . [ cols=\"^,^,^,^,^,^,^,^\",options=\"header \" , ]     the fourier basis functions can also include the terms @xmath97 for @xmath98 odd , which go to zero at @xmath99 but have non - zero derivatives there . upon using this larger basis set , we find the numerically optimized solutions are not much better than found above only using cosine terms .",
    "we choose not use use these sine basis functions because we prefer to also have a zero derivative at the beginning and end of the pulse .",
    "we are also interested in control waveforms that take an initial @xmath76 to @xmath77 and then back again to @xmath76 . in this case",
    "the waveform for @xmath20 , not @xmath62 , is given by the fourier basis @xmath100 \\",
    ", \\label{eq : dthprime}\\end{aligned}\\ ] ] with constraints on the coefficients @xmath101 the derivative @xmath62 is now a sum of sine functions , which have non - zero derivatives at the beginning and end of the pulse .",
    "figure[fig : dtheta ] shows optimized results for 1 , 2 , and 3 fourier coefficients , as well as for the first - harmonic solution of the slepian . as for the previous case ,",
    "the optimized fourier solution is close to that of the slepian : only two coefficients ( red curve ) is required for close approximation to the ideal solution .",
    "( color online ) waveform and power spectral density ( @xmath102 ) as for fig.[fig : theta ] , but with a trajectory from @xmath76 to @xmath77 and back . a ) plot of waveform @xmath62 versus @xmath74 for optimized fourier coefficients with one ( 1 , blue ) , two ( 2 , red ) , and three ( 3 , green ) terms , as well as slepian ( i , gray ) .",
    "b ) plot of power spectral density from fourier transforms of the waveforms in a ) .",
    "waveforms normalized using @xmath103.,scaledwidth=48.0% ]",
    "the optimal solution for an arbitrary change in @xmath20 will have to account for the qubit frequency @xmath28 changing during the control pulse .",
    "the solution is found by first making a coordinate transformation to an accelerating frame in time where the oscillation frequency is constant , and then using optimal waveforms as found previously .",
    "the basic idea is to define a new frame with time @xmath104 such that the rate of change of the phase is constant . choosing this frequency as the constant @xmath105",
    ", the times are related by @xmath106 in this frame , the error angle from eq.([glint ] ) becomes @xmath107 \\ , \\label{gltauint}\\end{aligned}\\ ] ] so that the optimal shape of @xmath108 can be computed for constant frequency @xmath109 , as done in the last section .",
    "integration of @xmath110 is next used to compute the quantity @xmath111 .",
    "the relationship between the real time @xmath30 and @xmath104 is finally solved by integrating eq.([eq : wt ] ) @xmath112 where in the last equation we have used eqs.([eq : theta ] ) and ( [ eq : omega ] ) to find the relation @xmath113 .",
    "the function @xmath114 can be inverted numerically using interpolation .",
    "for example , in matlab code the dependence @xmath115 would be given through the interpolation of the vectors @xmath114 and @xmath111 using the command @xmath115 = @xmath116 .",
    "( color online ) waveform and error for @xmath31 changing from @xmath117 to @xmath118 .",
    "a ) blue lines are plot of control @xmath115 versus @xmath74 for two ( solid ) and three ( dashed ) fourier coefficients .",
    "the right scale shows the waveform @xmath18 as green lines .",
    "b ) plot of non - adiabatic error versus pulse time @xmath73 for linearized and exact solutions , with both two and three optimized coefficients .",
    "low errors can be achieved for times greater than @xmath119 , corresponding to one oscillation at the avoided level crossing .",
    "we define @xmath105.,scaledwidth=48.0% ]    to illustrate this solution for an arbitrary control problem , we first consider the avoided level crossing from @xmath120 to @xmath121 , as discussed earlier for the landau - zener trajectory . the waveform is shown as solid lines in fig.[fig : lzopt]a for the 2 fourier coefficients @xmath122 found earlier . here",
    "we find the control waveform is nearly linear in @xmath20 , not in @xmath31 as assumed for the standard landau - zener problem .",
    "the non - adiabatic error @xmath60 is plotted in fig.[fig : lzopt]b , both for the linearized ( black ) and the exact ( blue ) solution of the qubit dynamics .",
    "the linearized solution has similar shape to that found earlier , as expected , whereas the exact solution shows significantly higher errors , demonstrating that an exact solution for this control problem is important .",
    "( color online ) waveform and error for @xmath31 changing from @xmath123 to @xmath124 , and then back to @xmath118 .",
    "a ) black line ( 1 ) is for optimal waveform , whereas blue line ( 2 ) includes the effect of waveform rounding by control electronics , here accounted for by a convolution .",
    "b ) plot of non - adiabatic error versus pulse time @xmath73 for the two cases , using exact solutions .",
    "optimal coefficients are @xmath125 for black ( 1 ) and @xmath126 for blue ( 2 ) line .",
    ", scaledwidth=48.0% ]    to further reduce error , we next optimize the @xmath95 coefficients for better performance . shown in green is the best performance obtained for varying @xmath127 , whereas the red curve shows optimal performance for a choice of @xmath127 and @xmath128 .",
    "it is impressive that non - adiabatic errors in the @xmath87 range can be obtained with only a small number of coefficients .",
    "also note that that low errors occurs at a pulse time @xmath73 equal to one oscillation period @xmath43 of the avoided level crossing , about 20 times faster than the simple landau - zener trajectory .",
    "another important waveform is for a controlled pulse in @xmath20 , as shown earlier in fig.[fig : dtheta ] . here",
    "we consider the control angle changing from @xmath129 to @xmath130 , then back again to @xmath76 ; these parameters are chosen to give the cz gate @xmath131 , where this additional @xmath15 phase shift comes from the avoided level crossing between the states @xmath0 and @xmath1 . in this case",
    "@xmath111 is given by eqs.([eq : dthprime ] ) and ( [ eq : dthprimecon ] ) , and @xmath115 is found as for the last example . we find a near optimal solution for only one additional coefficient @xmath132 , as shown in black in fig.[fig : cz ] .",
    "we obtain very low error for a total control time about one oscillation of @xmath133 .",
    "this waveform requires fast changes in @xmath17 at the beginning and end of the pulse .",
    "because of the finite bandwidth of the control electronics , such a shape may not be possible to synthesize , so we next consider the optimal control including rounding of the waveform , here accounted for by convolution of the output waveform with a gaussian .",
    "with convolution , the computed non - adiabatic error increases significantly with the original @xmath134 coefficient .",
    "we found that adjusting @xmath134 could not improve the error much , but by including the next coefficient @xmath135 the error could be effectively minimized .",
    "this optimal solution is shown as the blue line in fig.[fig : cz ] , where low error is now found at about twice the oscillation period of @xmath133 .",
    "note that about 1/2 of the increase in time of the control waveform is accounted for by the extra time added at the beginning and end of the pulse from convolution .",
    "the fourier basis may be used to optimize waveforms for other control problems , so it is natural to ask whether these ideas can be used to minimize the excitation to the second excited state when driving weakly anharmonic qubits .",
    "this corresponds to the standard problem for optimal control , where shaping occurs in the off - diagonal @xmath6 and @xmath7 parts of the hamiltonian .",
    "a solution that works extremely well is waveform shaping by derivative removal by adiabatic gate ( drag ) @xcite .",
    "it is interesting to consider whether simple shaping using the fourier basis waveforms can improve upon drag .",
    "errors from the @xmath136 state come in two forms : ( i ) direct transitions to @xmath136 producing 2-state errors , and ( ii ) virtual excitations to @xmath136 , producing an ac stark shift between the qubit states @xmath4 and @xmath5 that give changes in rotation amplitude and direction .",
    "the transition frequencies between the states @xmath137 and @xmath138 are @xmath68 and @xmath139 , which defines a nonlinearity @xmath140 that is negative for transmons .",
    "\\(i ) transitions to the 2-state come from the drive waveform having spectral density at the @xmath138 frequency .",
    "as the drive needs to be resonant with the @xmath137 transition , it can be described in general with a two - quadrature form @xmath141 , which can be written compactly in complex notation as @xmath142\\exp(i\\omega_0 t)$ ] .",
    "the drive waveform for drag has the quadrature component proportional to the time derivative @xmath143 @xmath144e^{i\\omega_0 t } \\ , \\end{aligned}\\ ] ] with its magnitude adjusted by a dimensionless derivative parameter @xmath145 .",
    "the transition rate is expected to scale as the spectral density of @xmath146 , which is the squared magnitude of the fourier transform @xmath147 \\int dt \\",
    "e^{-i\\omega t } x(t)e^{i\\omega_0 t } \\ , \\end{aligned}\\ ] ] where integration by parts is used @xcite to shift the derivative of @xmath148 to the term @xmath149 $ ] . driving the @xmath137 transition at @xmath68 ,",
    "the spectral density is zero at the @xmath138 transition frequency ( @xmath150 ) when @xmath151 .",
    "as this is a qualitative argument , we use numerical simulation to minimize the population error to the 2-state ; below we show our optimal drag coefficient is @xmath152 , close to the computed value .",
    "\\(ii ) the origin of the ac stark shift can be understood as coming from level repulsion between the @xmath5 and @xmath136 states when driven off - resonance , which changes the frequency of @xmath5 state proportional to @xmath153 .",
    "the derivative term also stark shifts the qubit , giving a net shift @xcite proportional to @xmath154 .",
    "as the @xmath155 term gives a shift that is time dependent , a practical solution is to choose @xmath156 for no stark shift , allowing the qubit frequency to be constant @xcite . in this case transition errors to the 2-state are not optimized , but the solution is still useful since errors are lowered by @xmath157 .    as we wish to use @xmath151 for minimum 2-state errors",
    ", we note here there exists another practical solution : constant detuning of the microwave frequency .",
    "this works because the dynamic stark shift , which produces a small change in the rotation direction of the bloch vector in the qubit subspace , can always be compensated for by a static change in drive frequency and phase .",
    "equivalently stated , the three parameters of the drive frequency , phase and amplitude moves the bloch vector by any desired rotation direction and angle . finding",
    "zero error thus becomes the same procedure as for normal tuning up of qubit gates , only here the frequency and phase must be separately tuned for @xmath158 and @xmath15 rotations . as this optimization",
    "can always be performed , we need only be concerned with 2-state errors .",
    "these ideas were evaluated using numerical simulations of a 3-level system with @xmath140 nonlinearity , integrating the hamiltonian matrix over the waveform pulse to find the net unitary transformation .",
    "we find good performance using the fourier basis , shown initially for a drive @xmath159 with amplitude adjusted to give a @xmath15-pulse .",
    "as we find transition probabilities for @xmath160 and @xmath161 are quite close in magnitude , we plot in fig.[fig : hd ] the average of these 2-state errors versus pulse time @xmath73 normalized with the qubit anharmonicity @xmath162 . here ,",
    "we optimize amplitude and detuning parameters for qubit subspace errors below @xmath163 at @xmath164 ; we find the 2-state errors change little when slightly varying these parameters to zero errors at different values of @xmath73 .",
    "the error without a derivative @xmath165 is plotted in black .",
    "the waveform with the half - derivative @xmath166 , plotted in red , shows a reduction in error by about a factor of 4 that is consistent with the above argument .",
    "as expected , we find a much better solution using the drag coefficient near unity @xmath152 , as plotted in green .",
    "we also tested for waveform optimization of @xmath167 by adjusting the fourier coefficient @xmath127 . for the @xmath165 case",
    "we find better performance for @xmath168 , plotted in blue , with an average magnitude similar to the @xmath166 solution . for @xmath152 and @xmath169 ,",
    "plotted in purple , we found adjusting @xmath127 shifted the first minimum ; we thus propose that this parameter can be used to tune for a somewhat smaller 2-state error .",
    "comparing to plots in ref.@xcite using a truncated gaussian waveform , we find the @xmath166 solution has errors comparable to first order drag ( purple curve of their fig.3 ) .",
    "our @xmath152 solution is about one order of magnitude below the second order drag solution ( green curve of their fig.4 ) for @xmath170 .",
    "we conjecture that combining second - order drag with our optimized fourier - based waveforms would perform even better .",
    "( color online ) average probability of two - state population versus pulse time @xmath73 for a qubit @xmath15-pulse .",
    "the time is normalized with the qubit nonlinearity @xmath162 .",
    "parameters are chosen to minimize qubit errors near @xmath171 .",
    "drag term @xmath172 0 , -0.48 and -1.20 are shown in black ( 1 ) , red ( 3 ) and green ( 4 ) , respectively .",
    "optimization of the waveform @xmath167 with fourier coefficient @xmath127 are shown in blue ( 2 ) and purple ( 5).,scaledwidth=48.0% ]    waveforms corrected by a derivative term with @xmath152 produce a good optimum solution .",
    "however , one - component optimal control is not that much slower , acceptable for problems where there is only access to @xmath2 control .",
    "we have shown that an optimal control waveform for adiabatic behavior may be obtained by minimizing the spectral weight integrated above a cutoff frequency .",
    "although the best solution is a slepian , optimization of a few - term fourier series shows comparably low errors , with acceptable performance achieved with only two or three coefficients .",
    "this solution can be used for arbitrary control , even when the transition frequency is changing in time , by first solving the problem with a fixed frequency and then transforming to the proper time frame .",
    "we find effects of finite bandwidth in the control waveform can be readily accounted for by optimizing the fourier coefficients .",
    "this method of solution can be used for other control problems , such as minimizing the 2-state occupation for a single qubit @xmath15-pulse .    with this protocol",
    ", we find that gates with intrinsic error below @xmath3 should be possible for the two - qubit controlled - phase operation , even for relatively fast gate times .",
    "this theoretical understanding may help open up a route to ultra - high fidelity quantum operations and fault tolerant quantum computation .",
    "we thank a. korotkov for helpful discussions .",
    "this work was supported by the office of the director of national intelligence ( odni ) , intelligence advanced research projects activity ( iarpa ) , through the army research office grants w911nf-09 - 1 - 0375 and w911nf-10 - 1 - 0334 .",
    "all statements of fact , opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of iarpa , the odni , or the u.s . government .",
    "the exact quantum solution to the non - adiabatic problem may be expressed in the form found geometrically .",
    "we start by considering the effect of a rotation around the @xmath17-axis .",
    "if the wavefunction in a fixed basis is given by @xmath173 , then it can be rewritten in a basis rotated by the angle @xmath20 as @xmath174 , re - expressed in eigenstates of the new basis with amplitudes given by @xmath175    in the @xmath20-rotated basis we define the energy eigenvalues as @xmath176 , which introduces phase factors that has differential form @xmath177 and @xmath178 .",
    "we are interested in changes in the control vector , so if @xmath20 changes with time one finds @xmath179 note the symmetry of the rotations , with factors @xmath180 for the time - dependence of @xmath31 rotations , and @xmath181 for the @xmath17 rotation .    the time dependence can be described simply if one considers the quantity @xmath182 , where @xmath183 is the complex conjugate .",
    "its derivative is @xmath184 \\\\ & = i\\omega ( \\alpha^ * \\beta)+(|\\alpha|^2-|\\beta|^2)\\dot{\\theta}/2 \\\\ & = i\\omega ( \\alpha^ * \\beta)+\\sqrt{1 - 4|\\alpha^*\\beta|^2}\\ \\dot{\\theta}/2 \\ , \\label{lzde}\\end{aligned}\\ ] ] where in the last equation we have used the relation @xmath185 note that the square root factor in eq.([lzde ] ) changes sign when @xmath186 is negative .    for bloch vector angles @xmath187 and @xmath188 the amplitudes are @xmath189 and @xmath190 , which gives @xmath191 so that its magnitude is the error probability @xmath192 ^ 2 \\approx |\\alpha^*\\beta|$ ] only for small angles @xmath187 . inserting this result for @xmath182 into eq.([lzde ] ) , one finds @xmath193 changing phase variables @xmath194 , where @xmath195 and noting that @xmath196 , we can remove the @xmath180 phase term @xmath197 which is equivalent to previous geometrical result eq.([glint ] ) in the low amplitude limit @xmath198 . here , the exact solution has the amplitude of the drive term @xmath199 rescaled by @xmath200 to account for the geometry of the bloch sphere .",
    "r. barends , j. kelly , a. megrant , a. veitia , d. sank , e. jeffrey , t. c. white , j. mutus , a. g. fowler , b. campbell , y. chen , z. chen , b. chiaro , a. dunsworth , c. neill , p. omalley , p. roushan , a. vainsencher , j. wenner , a. n. korotkov , a. n. cleland and john m. martinis , nature * 508 * , 500 - 503 ( 2014 ) .",
    "t. yamamoto , m. neeley , e. lucero , r. c. bialczak , j. kelly , m. lenander , matteo mariantoni , a. d. oconnell , d. sank , h. wang , m. weides , j. wenner , y. yin , a. n. cleland and john m. martinis , phys rev .",
    "b * 82 * , 184515 ( 2010 ) .",
    "j. kelly , r. barends , b. campbell , y. chen , z. chen , b. chiaro , a. dunsworth , a. fowler , i. hoi , e. jeffrey , a. megrant , j. mutus , c. neill , p. omalley , c. quintana , p. roushan , d. sank , a. vainsencher , j. wenner , t. white , a. cleland and john m. martinis , phys .",
    "* 112 * , 240504 ( 2014 ) .",
    "e. lucero , j. kelly , r. c. bialczak , m. lenander , m. mariantoni , m. neeley , a. d. oconnell , d. sank , h. wang , m. weides , j. wenner , t. yamamoto , a. n. cleland and j. m. martinis phys .",
    "a * 82 * , 042339 ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> a controlled - phase gate was demonstrated in superconducting xmon transmon qubits with fidelity reaching 99.4% , relying on the adiabatic interaction between the @xmath0 and @xmath1 states . </S>",
    "<S> here we explain the theoretical concepts behind this protocol that achieves fast gate times with only @xmath2 control of the hamiltonian , based on a theory of non - linear mapping of state errors to a power spectral density and use of optimal window functions . with a solution given in the fourier basis , optimization is shown to be straightforward for practical cases of an arbitrary state change and finite bandwidth of control signals . </S>",
    "<S> we find that errors below @xmath3 are readily achievable for realistic control waveforms . </S>"
  ]
}