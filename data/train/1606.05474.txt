{
  "article_text": [
    "the past few years have been marked by a slow , but steady , shift from the era of the detections of exoplanets to the new age of the characterization of their atmospheres .",
    "exoplanets transiting in front of their host stars allow for atmospheric features to be imprinted onto the total system light @xcite .",
    "secondary eclipses allow for photons from the exoplanetary atmosphere to be directly measured @xcite . extracting the spectroscopic signatures of these exoplanetary atmospheres",
    "is a challenging task , because they are typically many orders of magnitude fainter than the light from their host stars .",
    "interpreting these signatures requires a profound understanding of radiative transfer and atmospheric chemistry , in order to infer the thermal structure and atomic / molecular abundances of the atmosphere from the data .",
    "hot jupiters are particularly accessible to atmospheric characterization via transits and eclipses .",
    "they are hardly one - dimensional ( 1d ) objects , but a reasonable first approach is to study them using 1d , plane - parallel model atmospheres @xcite , which may be used to mimic the dayside- or nightside - integrated emission .",
    "the simplest model one may construct of a dayside emission spectrum ( besides a planck function ) is a 1d model with an atmosphere in radiative and chemical equilibrium , if one neglects the effects of atmospheric dynamics and photochemistry . despite these simplifications ,",
    "there are several non - trivial demands associated with such a model : it should be able to consider a rich variety of chemistries , metallicities , irradiation fluxes from the star and internal heat fluxes from the interior of the exoplanet .",
    "it should be able to take , as an input , arbitrary combinations of molecules and their opacities",
    ". the synthetic spectrum computed should be highly customizable , such that it may be readily compared to both photometric and spectroscopic data , often combined in a heterogeneous way across wavelength .",
    "to explore such a broad range of parameter space , the numerical implementation of a model ( short :  code \" ) needs to solve for radiative equilibrium very efficiently and also allow for numerical convergence to be checked in several different ways : number of model layers , spectral resolution of opacity function , number of wavelength bins used , etc .",
    "such a code forms the basis of a flexible radiation package that one may couple to a chemical kinetics code or a three - dimensional general circulation model .",
    "the challenges of constructing a 1d radiative - convective model are also discussed in the review article by @xcite , where the  convective \" part stands for the additional consideration of convective stability , which marks the next step in sophistication of an atmospheric model .    in the current work",
    ", we present a customizable and built - from - scratch computer code named ` helios ` , which has or uses the following components .    * in this initial version , we use the analytical solutions of the radiative transfer equation in the two - stream approximation , as derived by @xcite .",
    "these solutions enable us to iteratively and self - consistently solve for the temperature - pressure profile of the atmosphere via iteration with its opacity function , which generally depends on temperature , pressure and wavelength .",
    "the synthetic spectrum is obtained as a natural by - product of this self - consistent calculation .",
    "* for the opacity function of the atmosphere , we use our open - source and custom opacity calculator , ` helios - k ` , which was previously published by @xcite .",
    "the finest resolution we have used is @xmath5 @xmath2 across the entire wavenumber range considered .",
    "we then compute @xmath0-distribution tables from this finely - spaced grid of opacities across temperature , pressure and molecular species . * throughout this work , we assume chemical equilibrium , which effectively means that the chemistry is described by only two parameters : the elemental abundances of carbon and oxygen . given the input values of these elemental abundances , we then use the validated analytical formulae of @xcite and @xcite to calculate the mixing ratios ( abundances normalized to that of molecular hydrogen ) of the various molecules .",
    "we consider water ( h@xmath6o ) , carbon monoxide ( co ) , carbon dioxide ( co@xmath6 ) and methane ( ch@xmath7 ) .",
    "* we have built ` helios ` to run on graphics processing units ( gpus ) to maximize the computational throughput .",
    "a ` helios ` calculation with 101 model layers and 300 wavelength bins takes only a few minutes to complete on a personal computer with a nvidia geforce 750 m gpu .",
    "this level of efficiency allows us to effectively perform parameter studies .    in section [ sec : meth ]",
    ", we provide a detailed description of our methodology , including the equations and boundary conditions used , the numerical methods , the structure of our grid , the opacity calculations , the chemistry model , and the stellar models used . in section [ sec : res ] , we subject ` helios ` to various tests , use it to address several lingering ambiguities in the literature and also to examine 6 case studies of hot jupiters . in section [ sec :",
    "sum ] , we summarize our results , compare them to previous work and discuss opportunities for future work .",
    "any scheme to represent the propagation of radiation through an atmosphere has to solve the radiative transfer equation @xcite , @xmath8 where @xmath9 is the monochromatic and wavelength - dependent intensity , @xmath10 is the cosine of the incident angle ( @xmath11 ) relative to the normal and @xmath12 is the optical depth measured from the top of the atmosphere downwards .",
    "we denote the wavelength by @xmath13 .",
    "the crucial  length \" to adopt in radiative transfer is the optical depth .",
    "( only a non - vanishing @xmath14 leads to a change in intensity @xmath15 . )",
    "the source function @xmath16 accounts for both radiation scattered into the line of sight and the thermal emission associated with each location in the medium . equation ( [ eq : general ] ) is generally difficult to solve , because it is a partial differential equation in @xmath12 and @xmath17 .",
    "a commonly used simplification is to reduce equation ( [ eq : general ] ) to an ordinary differential equation in @xmath12 by integrating over the incoming ( @xmath18 or @xmath19 ) and outgoing ( @xmath20 or @xmath21 ) hemispheres and assuming that the ratios of various moments of the intensity are constant and take on specific values .",
    "this is known as the  two - stream approximation \" @xcite .",
    "one may then solve the ordinary differential equation analytically to obtain solutions for _ pairs _ of model atmospheric layers @xcite .",
    "the moments of the intensity are related by the so - called  eddington coefficients \" .",
    "of particular interest to us is the first eddington coefficient @xcite , @xmath22 which is related to the  diffusivity factor \" @xmath23 . in the next subsection ,",
    "we show that @xmath23 should take on a value between 1 and 2 depending on the thickness of the atmospheric layers .    in the current study",
    ", we use the two - stream solutions previously derived by @xcite .",
    "we note that these solutions allow for the inclusion of non - isotropic scattering via two functions : the single - scattering albedo ( @xmath24 ) and the scattering asymmetry factor ( @xmath25 ) @xcite .",
    "pure absorption and scattering correspond to @xmath26 and @xmath27 , respectively .",
    "forward , backward and isotropic scattering correspond to @xmath28 , -1 and 0 , respectively .",
    "our formulation allows for @xmath24 and @xmath25 to be specified as functions of wavelength / frequency / wavenumber , temperature and pressure .",
    "hereafter , the term  flux \" describes a wavelength - dependent quantity .",
    "are @xmath29=$ ] erg s@xmath30 @xmath31 . ] integrating the flux over all wavelengths , one obtains the  bolometric flux \" .",
    "we also neglect for readability the subscript @xmath13 for @xmath32 and @xmath33 .",
    "as previously shown by @xcite ( and references therein ) , the radiative transfer equation has an exact solution in the limit of pure absorption ( @xmath26 ) .",
    "we use a staggered grid ( see section [ subsect : grid ] ) , such that the two - stream solutions are applied to the _ interfaces _ of a model layer .",
    "we label the interfaces by  1 \" and  2 \" and our convention is to locate interace 2 above interface 1 in altitude . if the layer has only one temperature throughout ( i.e. , it is isothermal ) , then the fluxes at the interfaces are given by @xmath34 the @xmath35 and @xmath36 subscripts refer to the outgoing and incoming fluxes , respectively .",
    "the blackbody intensity within this layer is given by @xmath37 .",
    "we can improve upon the isothermal - layer treatment by considering a ( linear ) temperature gradient within the layer @xcite . if we instead taylor - expand the planck function in @xmath32 and retain only the constant and linear terms , we obtain @xmath38 - \\delta \\tau \\left(1-\\frac{\\mathcal{t}}{3}\\right ) \\right\\ } , \\\\",
    "f_{1,\\downarrow } = & \\mathcal{t } f_{2,\\downarrow } + \\pi b_2 ( 1   - \\mathcal{t } )   , \\\\ + & \\pi b^\\prime \\left\\{-\\frac{2}{3}\\left[1-e^{-\\delta \\tau } \\right ] + \\delta \\tau \\left(1-\\frac{\\mathcal{t}}{3}\\right ) \\right\\}. \\end{split}\\ ] ] following the derivation in @xcite .",
    "the difference in optical depth between the layers is given by @xmath39 .",
    "the gradient of the planck function is approximated by @xmath40 where @xmath37 and @xmath41 are now the planck functions for the temperatures at the interfaces 1 and 2 , respectively .    in both the isothermal and non - isothermal cases ,",
    "the transmission function or transmissivity is @xmath42 where @xmath43 is the exponential integral of the first order . unlike for the two - stream solutions",
    ", there is no need to specify @xmath44 as an input , because it has an exact solution , @xmath45 } .\\ ] ] for very thin layers ( @xmath46 ) , @xmath47 is an accurate approximation , but as the layer becomes optically thick the value of @xmath48 approaches unity ( figure [ fig : diff ] ) .",
    "operationally , since we pick our model grid to be equally spaced in the logarithm of pressure , it means that the value of @xmath49 is small near the top of the model atmosphere and gradually becomes large ( and exceeds unity ) at high pressures . within the context of the two - stream approximation , assuming @xmath23 to be constant is equivalent to picking a representative or mean value , over the entire atmosphere , of the diffusivity factor .",
    "as already pointed out by @xcite , the analytical expression for @xmath23 when scattering is present ( equivalent to eq .",
    "[ eq : diff ] ) is unknown .",
    "it is worth emphasizing that equations ( [ eq : isodirect ] ) and ( [ eq : nonisodirect ] ) are exact solutions and that the two - stream approximation is _ not _ taken . in section [ subsect : diffuse ] , we compare these exact solutions to the two - stream solutions to derive the value of @xmath44 .",
    "we now rederive the two - stream solutions of @xcite without setting @xmath47 , so as to facilitate comparisons with the exact solutions . for all of the solutions presented in this subsection ,",
    "the transmission function is @xmath50}.\\ ] ]    the simplest two - stream solutions are derived in the limit of pure absorption and isothermal atmospheric layers , @xmath51 without scattering ( @xmath52 ) , the coupling coefficients are @xmath53 and @xmath54 , and the transmission function simply becomes @xmath55 .",
    "if we increase the sophistication of the model by considering non - isothermal layers and pure absorption , we obtain @xmath56 , \\\\",
    "f_{1,\\downarrow } = & \\mathcal{t } f_{2,\\downarrow } + 2\\pi\\epsilon \\left [ b_2 - \\mathcal{t } b_1 - \\epsilon b ' ( 1 - \\mathcal{t } )   \\right ] .",
    "\\end{split}\\ ] ]    for isothermal atmospheric layers with non - isotropic scattering being included , the two - stream solutions for the fluxes read @xmath57 , \\\\",
    "f_{1,\\downarrow } & = \\frac{1}{\\alpha } \\left[\\xi f_{2,\\downarrow } - \\beta f_{1,\\uparrow } + 2\\pi \\epsilon b_1 ( \\beta - \\upsilon ) \\right ] .",
    "\\end{split}\\ ] ] the coefficients @xmath58 , @xmath59 , @xmath60 , @xmath61 are defined as @xmath62 with the coupling coefficients being @xmath63.\\ ] ] in the limit of @xmath64 , the equations in ( [ eq : isoscat ] ) are replaced by @xmath65 these solutions give the correct limits of a transparent or opaque atmosphere when @xmath27 @xcite .",
    "the general solutions stated before in equation ( [ eq : isoscat ] ) do not reproduce this limit .",
    "our most sophisticated two - stream solutions include non - isotropic scattering and non - isothermal model atmospheric layers , @xmath66 \\right\\ } , \\\\",
    "f_{1,\\downarrow } = & \\frac{1}{\\alpha } \\left\\{\\xi f_{2,\\downarrow } - \\beta f_{1,\\uparrow } + 2\\pi \\epsilon \\left [ b_2 ( \\alpha + \\beta ) - b_1 \\xi \\right . { } \\right . { } \\\\ & + \\left . { } \\left . { }   \\frac{\\epsilon}{1+\\omega_0 g_0 } b ' ( \\xi - \\alpha +",
    "\\beta )   \\right ] \\right\\}. \\end{split}\\ ] ] note that in the non - isothermal approach a single constant gradient of @xmath67 is assumed within a layer . thus @xmath37 and @xmath41 are placed at the interfaces . ) . ]",
    "the coefficients @xmath58 , @xmath59 and @xmath60 , as well as the coupling coefficients @xmath68 , retain the same functional forms as in the case of having isothermal layers .",
    "generally , we find that the non - isothermal solutions attain more rapid numerical convergence ( to radiative equilibrium ) . in principle",
    ", if a large enough number of isothermal layers is used , the isothermal and non - isothermal calculations should agree .",
    ", as a function of the difference in optical depth @xmath49 across a layer , in the limit of pure absorption .",
    "]      to include the effects of rayleigh scattering by molecules , we use the cross section @xcite , @xmath69 where @xmath70 is the number density at a reference temperature and pressure @xmath71 is the wavelength - dependent refractive index and @xmath72 is the king factor , which is a correction factor for polarization .    in the current study",
    ", we focus on rayleigh scattering by hydrogen molecules , but our approach may be straightforwardly generalized to other molecules .",
    "we ignore the contribution due to helium , which is less than 1% compared to that of molecular hydrogen .",
    "for h@xmath6 , we use @xmath73@xmath31 , @xmath74 and @xmath75 the influence of rayleigh scattering enters via its inclusion , as @xmath76 , to the opacity of each model layer , where @xmath77 is the mean molecular mass , and also via the single - scattering albedo @xmath24 . the dashed line in figure [ fig : opac ]",
    "shows the opacity of rayleigh scattering by h@xmath6 , which dominates in the optical but becomes subdominant , compared to molecular absorption , in the infrared due to its dropoff with @xmath78 .",
    "if the scattering dominates and @xmath79 in this layer and waveband , then we switch to the pure scattering solutions ( eq . [ eq : purescat ] ) .        for the isothermal treatment , a staggered grid",
    "is used with the layers being separated by interfaces .",
    "there are @xmath80 layers and @xmath81 interfaces .",
    "the grid is evenly spaced in height or the logarithm of pressure , which serves as the vertical coordinate .",
    "the thickness of the @xmath82-th layer is given by @xmath83 with @xmath84 being the boltzmann constant , @xmath85 the surface gravity . for hydrogen - dominated atmospheres",
    ", we set @xmath86 with @xmath87 being the mass of the proton .",
    "the pressures at the interfaces are represented by @xmath88 and @xmath89 .",
    "the preceding expression is obtained from integrating the equation of hydrostatic balance over a model layer and assuming isothermality and the equation of state for an ideal gas .",
    "the contribution to the optical depth by the @xmath82-th layer is @xmath90 where @xmath91 is the opacity and @xmath92 is the difference in column mass , which can be further written in terms of pressure and surface gravity .    for the non - isothermal grid , we require a more sophisticated grid layout , which is shown in figure [ fig : grid ] .",
    "each layer has a temperature and pressure , located at its center . to compute the fluxes , we need to interpolate across the temperature and pressure grids to obtain their values at the interfaces .",
    "a key quantity to compute is the planck function @xmath33 , which relates the temperature to the thermal emission of a layer .",
    "if one constructs the grid using a single gradient @xmath93 of the planck function over the whole layer , one is essentially decoupling the radiative transfer process from the temperature at the center of the layer .",
    "we solve this problem by splitting each layer into two sublayers , leading to two @xmath93 values within a layer .",
    "the fluxes are propagated first from the lower interface to the layer center , then from the layer center to the upper interface ( and vice versa ) , similar to the approach taken in e.g. @xcite . in this manner ,",
    "both the layer centers and interfaces are involved in the iteration for radiative equilibrium .",
    "finally , in the non - isothermal grid , a numerical caveat arises in the upper atmosphere .",
    "there , the optical depth difference @xmath94 of a layer @xmath82 is tiny ( due to the very small pressure ) and thus the denominator of eq .",
    "( [ eq : planck ] ) vanishes , which in turn leads to numerical issues for @xmath95 in eq .",
    "( [ eq : nonisoscat ] ) . to prevent this",
    ", we keep the sub - layered grid of the non - isothermal approach , but switch in each sublayer from the non - isothermal ( eq . [ eq : nonisoscat ] ) to the isothermal prescription ( eq . [ eq : isoscat ] ) whenever @xmath96 occurs .      at the top of the atmosphere ( toa ) , which is also the @xmath80-th interface of the model atmosphere , the flux is given by @xmath97 where @xmath98 is the stellar radius",
    ", @xmath99 is the orbital distance of the planet and @xmath100 is the stellar blackbody function .",
    "this represents the heating from the incident stellar flux .",
    "most of the quantities in the preceding expression are astronomical observables ( or quantities that may be inferred from the observations ) .",
    "it is possible to replace @xmath100 by a more sophisticated model of the stellar spectrum ( see section [ sec : star ] ) .",
    "the quantity @xmath101 is a parameter that describes the redistribution of heat from the dayside to the nightside of a tidally - locked hot jupiter , which is dictated by an interplay between atmospheric dynamics and radiative cooling . in principle",
    ", its value may be inferred from infrared phase curves . theoretically , it is bounded between @xmath102 ( full redistribution ) and @xmath103 ( no redistribution ) .",
    "since we are using our 1d , plane - parallel model to describe the dayside emission spectra of hot jupiters , the value of @xmath101 is a proxy for the dayside integrated absorption and re - emission of radiation . in the current study , we adopt @xmath104 following the arguments in e.g. @xcite and @xcite .    at the bottom of the model atmosphere ( boa ) , we have included the option to specify an internal radiative heat flux ( @xmath105 ) , such that @xmath106 where @xmath13 is the wavelength , @xmath107 is the stefan - boltzmann constant , @xmath108 is the internal temperature , @xmath109 and @xmath33 is the planck function .",
    "the internal heat flux reflects the thermal heating due to gravitational contraction .",
    "the boa is also the 0-th interface .",
    "it is important to note that any form of atmospheric heating is associated with the _ net flux _ ( the difference between the outgoing and incoming fluxes ) @xcite , @xmath110 in our current study , we set @xmath111 k in the absence of such constraints on hot jupiters .",
    "-th and 0th interfaces , respectively .",
    "the pressure and temperature are located at the center of each layer , while the fluxes tranversing a layer are computed at the layer interfaces .",
    "we further divide each layer into two sublayers during the iteration for radiative equilibrium ( see text for details ) . in the schematic ,",
    "we have focused on the @xmath0-th layer and the various quantities associated with its center and interfaces .",
    "quantities marked with an asterisk are temporarily used in the computation , but not stored as the final output .",
    "the layers are evenly spaced in the logarithm of pressure . ]      within each model layer of the atmosphere , its temperature and pressure determine its absorption and scattering properties , given by molecular abundances and opacities , which in turn determines the transmission function and fluxes . however , as flux enters and exits the layer , the temperature changes , which in turn changes the opacity .",
    "clearly , this is an iterative process .",
    "it turns out that one is iterating for radiative equilibrium , which is a statement of _ local _ energy conservation @xcite .",
    "local energy conservation implies global energy conservation , but not vice versa @xcite .",
    "we integrate the fluxes ( @xmath112 and @xmath113 ) over the entire spectral range to obtain the bolometric fluxes ( @xmath114 and @xmath115 ) , which in turn allows us to construct the bolometric net flux ( @xmath116 ) . for the @xmath82-th layer",
    ", the divergence of the bolometric net flux becomes @xmath117 between successive timesteps , the change in temperature of the @xmath82-th layer then becomes @xcite @xmath118 where @xmath119 is the local density and @xmath120 is the numerical timestep .",
    "the specific heat capacity of an ideal gas at constant pressure is @xcite @xmath121 where we set the number of degrees of freedom of the gas to be @xmath122 , as is valid for a diatomic molecule ( ignoring the vibrational modes ) like molecular hydrogen , the main component of gas planet atmospheres .",
    "this simplification does not hold should the atmospheric composition change , e.g. by dissociation of molecular hydrogen at very high temperatures . since in our model",
    "the only occurence of @xmath123 is in the timestepping algorithm this flaw is for our cause of only minor concern , but would render e.g. the calculation of the entropy inaccurate .    in practice , we start with an arbitrary temperature profile with @xmath124 .",
    "we perform the iteration described until @xmath125 vanishes for each layer , which is our numerical condition for radiative equilibrium ( c.f .",
    "[ eq : condition ] ) .",
    "physically , each atmospheric layer emits the same amount of energy which it receives .",
    "when scattering is present , the flux solutions become coupled . each array of outgoing or incoming fluxes can not be populated independently of the other",
    "this is solved iteratively by starting with the coupled dependencies as zero and populating the flux arrays multiple times in each temperature step .",
    "we include 4 additional scattering iterations in the full radiative transfer calculation as the flux values are still known from the previous timestep and 80 scattering iterations for pure post - processing ( propagating only once through the atmosphere ) purposes .      for the numerical timestepping",
    ", there are two options in ` helios ` .",
    "the first option uses a fixed and uniform timestep ( @xmath126 ) for every model layer . typically , we choose @xmath127 s. the challenge is that @xmath128 and @xmath129 may vary by several orders of magnitude across our model atmosphere . with a uniform timestep",
    ", the upper layers of the atmosphere attain convergence much more rapidly than the lower atmosphere .",
    "thus , this approach is plausible and technically correct , but infeasible .",
    "a more efficient approach is to implement an adaptive timestepping scheme that uses a different timestep for each model layer .",
    "specifically , the timestep in the @xmath82-th layer is related to the radiative timescale ( @xmath130 ) , @xmath131 where @xmath132 is a pre - factor to adjust to the optimal value of @xmath120 .",
    "the radiative timescale is approximated by @xmath133 where the temperature and pressure of the @xmath82-th layer is given by @xmath134 and @xmath135 , respectively . with this improved timestepping scheme ,",
    "the timestep becomes larger as one goes deeper into the model atmosphere .",
    "the evolution of the model does not strictly correspond to a physical evolution , but is rather a convenient way of reaching a numerical steady state .    to further optimize the efficiency of ` helios",
    "` , we also allow the timestep to vary in time as the model approaches radiative equilibrium . specifically , the algorithm checks in each layer whether the temperature has oscillated for the most recent 6 successive timesteps .",
    "we find oscillations in temperature to be a robust and practical indicator of having adopted too large a timestep .",
    "if oscillations are detected , the timestep is reduced by 33% . by contrast , if no oscillations are detected ( i.e. , the change in temperature is monotonic ) , then the timestep is increased by 10% .",
    "we note that the purpose of the pre - factor ( @xmath136 ) is to dampen sudden spikes in @xmath125 . for practical purposes",
    ", it takes the form of @xmath137^{0.9 } } , \\ ] ] which leads the temperature iteration step @xmath138 to depend only on @xmath139 , which guarantees the correct direction of the evolution but substantially smoothes irregularities , making the iteration process significantly more stable .",
    "finally , we need a condition to judge if radiative equilibrium has been established .",
    "usually , one would assume a criterion demanding the rate of temperature change to be below a certain threshold , @xmath140 , and evaluate whether this is satisfied in every layer .",
    "however , if @xmath126 is variable and not representing a physical time , then the utility of this approach becomes suspect .",
    "instead of setting a threshold on the consequence of radiative equilibrium ( changes in temperature ) , we set one on its cause ( a vanishing bolometric flux divergence ) .",
    "we use the dimensionless convergence criterion , @xmath141 where the change in bolometric net flux is normalized by the thermal emission associated with each layer . in practice",
    ", this criterion results in changes in temperature of less than 4 k at the boa and less than 1 k in the photospheric regions , which impacts the emission spectrum by less than 0.5% .",
    "our method for computing the opacities ( cross sections per unit mass ) of molecules has previously been elucidated in @xcite , who published an opacity calculator named ` helios - k ` that is part of the ` helios ` radiation package . as such",
    ", we do not repeat the detailed explanations of @xcite and instead highlight only the salient points .",
    "we include the opacities associated with the four main infrared absorbers : h@xmath6o , co@xmath6 , co and ch@xmath7 .",
    "we also include the opacities associated with the collision - induced absorption ( cia ) of h@xmath6-h@xmath6 and h@xmath6-he pairs .",
    "table [ tab : opac ] states the spectroscopic line lists used to compute our opacities , while figure [ fig : opac ] displays the final weighted opacities used in the code at one temperature and pressure . ,",
    "hcn , c@xmath6h@xmath6 and the alkali metals na and k , which may have an impact on the atmospheric structure .",
    "h and h@xmath142 absorption may also be important at high temperatures .",
    "nevertheless , our starting set of four molecules is sufficient for us to build up the first version of a radiative transfer code , and we intend to augment this set in the future . ]",
    "the first step involves calculating the opacity function ( cross section per unit mass as a function of wavelength , temperature and pressure ) , which includes all of the molecules previously mentioned , at a given spectral resolution . if the spectral resolution is too coarse , then spectral lines may be missed or omitted , which leads to an under - estimation of the true opacity . to avoid this pitfall",
    ", we use a resolution of @xmath5 @xmath2 .",
    "since the wavenumber range goes up to @xmath143 @xmath2 , this means that we are sampling the opacity function at @xmath144 points , which approaches a true line - by - line calculation .",
    "the shape of each spectral line is described by a voigt profile .",
    "a major uncertainty associated with this approach , which remains an unsolved physics problem , is that the far line wings of the voigt profile over - estimate or under - estimate the true opacity contribution depending on the molecule ( see @xcite for a discussion ) .",
    "the common practice is to truncate each voigt profile at some fixed spectral width .",
    "for example , @xcite use a line - wing cutoff of @xmath145 @xmath2 .",
    "we use a cutoff of 100 @xmath2 except for water , where we instead use 25 @xmath2 .",
    "we emphasize that the correct functional form of these far line wings is unknown .",
    "to speed up our calculations , we wish to avoid having to deal with integrating over @xmath144 points in the opacity function to obtain the transmissivities .",
    "instead , we employ the @xmath0-distribution method to calculate the transmission function within each wavelength bin , @xmath146 where the integrand , which is given by @xmath147 , is a function of a new variable ( @xmath148 ) that is bounded between 0 and 1 .",
    "we refer the reader to @xcite for a detailed explanation of the @xmath0-distribution method and instead focus on our method for numerically evaluating the preceding integral , which we solve by applying the gauss - legendre quadrature rule , @xmath149 where @xmath150 is @xmath85-th root of the 20-th order legendre polynomial @xmath151 .",
    "the corresponding gaussian weight @xmath152 is @xcite @xmath153p_{20}^\\prime[y_g]^2},\\ ] ] with @xmath154 being the derivative of @xmath151 .",
    "we find that using a 20th order gaussian quadrature rule is sufficient by comparing our calculations to direct integration using simpson s rule ( not shown ) .",
    "the obvious advantage of using gaussian quadrature over direct integration is the enhanced computational efficiency . in ` helios ` , we propagate the fluxes through the model atmosphere for each of the 20 gaussian points and perform the gaussian quadrature sum at the end of the propagation to obtain the flux associated with a wavelength bin . since the fluxes follow inhomogeneous paths across pairs of layers ( i.e. , the temperatures and pressures are not constant along these paths ) and we also add the @xmath0-distribution functions of the various molecules , we have to invoke the correlated-@xmath0 approximation _ twice _ @xcite .",
    "computing the flux through each gaussian point is equivalent to expressing the transmission function through layer @xmath82 and waveband @xmath155 by    @xmath156    which is nothing else than a discrete form of equation ( [ eq : trans_gen ] ) applied to our model .",
    "the @xmath85-th @xmath0-coefficient in waveband @xmath155 is written as    @xmath157    where @xmath134 and @xmath135 are the temperature and pressure at the center of the @xmath82-th layer in the isothermal layer grid and also at the interfaces in the non - isothermal layer grid where we have sublayers . in the latter case",
    ", we calculate the opacity in the center and at the interface and take their average to obtain the value in the connecting sublayer .",
    "the mixing ratios and opacities are generally functions of temperature and pressure . at this point",
    ", we have to distinguish between the mixing ratios by volume ( @xmath158 ) versus the mixing ratios by mass ( @xmath159 ) .",
    "the chemistry formulae ( see sect . [",
    "sec : chem ] ) are constructed to compute @xmath158 .",
    "however , to construct @xmath91 we need @xmath160 where @xmath161 is the mass of the @xmath162-th molecule .    in equations ( [ eq : kappa_gauss ] ) and ( [ eq : mixing ] ) , the indices @xmath163 refer to the 4 molecules being included in the current study : co , co@xmath6 , h@xmath6o and ch@xmath7 . for these molecules ,",
    "@xmath158 is computed using the chemistry model .",
    "the indices @xmath164 and @xmath165 refer to the cia opacities associated with h@xmath6-h@xmath6 and h@xmath6-he , respectively . for these , we use @xmath166 and @xmath167 to approximately reflect cosmic abundance .",
    "we use @xmath168 and @xmath169 .    by using equation ( [ eq : kappa_gauss ] )",
    ", we inherently assume the spectral lines of the various molecules to be _",
    "perfectly correlated_. in general , there are three limits : perfectly correlated , randomly overlapping ( perfectly uncorrelated ) and disjoint lines ( see @xcite for a review ) .",
    "real spectral lines behave in a way that is intermediate between these limits .",
    "@xcite and , more recently , @xcite have implemented a randomly overlapping method for combining the opacities of the different molecules , which is computationally more expensive as it involves multiple summations .",
    "as the spectral resolution increases ( and the bin size decreases ) , these approaches should converge to the same answer .",
    "the true accuracy of these approaches remains unquantified in the hot atmosphere regime and needs to be tested by a true line - by - line calculation , where each of the @xmath170 line shapes is numerically resolved .",
    "this is the subject of future work and is beyond the scope of the present paper .    in ` helios ` , the @xmath0-coefficients are read in from a four - dimensional , pre - computed table in temperature ( @xmath171 k , @xmath172 k ) , pressure ( @xmath173 bar , @xmath174 = 0.5 ) and wavelength ( @xmath175 @xmath17 m ) , with the bins subdivided by 20 gaussian points .",
    "the opacities are used at the constructed wavelength ( and gaussian point ) values , but are linearly interpolated across @xmath176 and @xmath177 .",
    "finally , we note that we use 300 wavelength bins ( equally spaced in wavenumber ) when running ` helios ` to solve for radiative equilibrium . upon obtaining the converged temperature - pressure profile ,",
    "we then use it to compute synthetic spectra in 3000 wavelength bins as a post - processing step .",
    "we find that this approach produces essentially identical results to performing the entire calculation using 3000 wavelength bins ( not shown ) .",
    "[ cols=\"<,<\",options=\"header \" , ]     we have chosen the sample of hot jupiters to include in this analysis based on a literature search for planets with non - blackbody emission spectra .",
    "we have started from @xcite , which catalogs all planets with secondary eclipse measurements in at least two bandpasses as of 2014 .",
    "they found 7 planets that are poorly fit by a blackbody model .",
    "we also searched for any more recent non - blackbody results . to select the most precise , reliable measurements from our search , we consider space - based data only .",
    "we have also stipulated that the data were reduced with state - of - the - art techniques .",
    "specifically , we only consider spitzer results that used sophisticated models of the intrapixel sensitivity such as bliss mapping or pixel - level decorrelation @xcite .",
    "this approach has been demonstrated to be the best practice in spitzer data analysis @xcite .",
    "this search has resulted in the selection of six planets : hd 189733b , wasp-8b , wasp-12b , wasp-14b , wasp-33b , and wasp-43b .",
    "their model parameter values and spectral data sources are shown in tables [ tab : para ] and [ tab : data ] , respectively .",
    "figure [ fig : bench_star ] shows the null - hypothesis models for all 6 studies .",
    "we have computed synthetic spectra and temperature - pressure profiles using a stellar blackbody , a kurucz stellar model and a ` phoenix ` stellar model .",
    "all of the stellar models were customized for each case study by specifying , as input parameters , the stellar effective temperature , surface gravity and metallicity .",
    "the synthetic spectra in all three cases are qualitatively similar .",
    "the largest difference occurs between 3 and 10 @xmath17 m .",
    "these differences appear to be more pronounced for the hottest hot jupiters ( i.e. , wasp-12b and wasp-33b ) .",
    "interestingly , the choice of stellar model affects the strength of the water - band features between 1.5 and 2.5 @xmath17 m , which are partially probed by the wfc3 instrument on the hubble space telescope .",
    "this discrepancy between the models is somewhat apparent for hd 189733b and wasp-43b .",
    "the shapes of the temperature - pressure profiles , in all 6 cases , are very similar with the largest discrepancies in either the very high optically thin or deep optically thick layers , which are less important for the planetary emission .",
    "overall , hd 189733b appears to be consistent with a null hypothesis and its dayside emission spectrum is reasonably described by a 1d , plane - parallel model in chemical and radiative equilibrium with solar metallicity .",
    "wasp-43b is fairly well described by the null hypothesis . however , our models for wasp-8b , wasp-12b , wasp-14b and wasp-33b consistently under - predict the infrared fluxes",
    ". these discrepancies could be either due to an insufficient opacity implementation ( lacking partial molecular absorption , aerosol extinction or inaccurate line profiles ) or due to a limited methodological framework , lacking chemical disequilibrium ( which requires a self - consistent calculation coupled to a chemical kinetics solver ) , radiative disequilibrium ( which requires another self - consistent calculation coupled to atmospheric dynamics ) or non-1d effects ( which a 1d model prescription with @xmath101 can not characterize and which would ideally require coupling to a 3d spatially resolved general circulation model ) .",
    "we will defer this investigation to future work .    for further variations on the theme",
    ", we retain the ` phoenix ` stellar models as they offer higher spectral resolution and more updated atomic / molecular line lists than the kurucz stellar models . in figure",
    "[ fig : bench_metal ] , we repeat our calculations with 1/3@xmath178 , 1@xmath178 and 3@xmath178 solar metallicity . we find the expected trend that a higher metallicity leads to generally hotter model atmospheres , which has the effect of strengthening the near - infrared water - band features . however , compared to the null hypothesis , decreasing or increasing the metallicity by a factor of 3 appears to have a minimal effect on the synthetic spectra , which is consistent with the retrieval analysis conducted for wasp-43b in @xcite , where they obtain similar metallicity uncertainties based on data constraints .",
    "our conclusions are qualitatively identical to those visible in figure [ fig : bench_star ] .",
    "varying the c / o has a more marked effect , as we show in figure [ fig : bench_coratio ] .",
    "specifically , we examine water - rich ( c / o@xmath179 ) , solar - abundance ( c / o@xmath180 ) and c / o@xmath181 scenarios . generally , we find that the c / o@xmath181 models have consistently colder temperature - pressure profiles , due to the lower abundance of h@xmath6o as the oxygen atom is preferentially sequestered by co , at high temperatures , compared to the water - rich and solar - abundance models .",
    "the increasing abundance of co also leads to stronger absorption features at 2.3 , 4.5 and 4.8 @xmath17 m , which render the model atmospheres darker ( i.e. , they have less flux in these bands ) .",
    "this transition to the stronger co features is more pronounced in the hotter objects ( wasp-12b and wasp-33b ) .",
    "our qualitative conclusions appear to be unchanged : our models for wasp-8b , wasp-12b , wasp-14b and wasp-33b still under - predict the infrared fluxes .",
    "it is somewhat difficult to judge if the data favours the water - rich or c / o@xmath181 models , for hd 189733b and wasp-43b , without running a detailed atmospheric retrieval model , which we again defer to future work .",
    "we have presented the new , extensible code , ` helios ` , which solves the equation of radiative transfer for a 1d , plane - parallel atmosphere that allows for non - isotropic scattering via the specification of the functional forms of the single - scattering albedo and the scattering asymmetry factor .",
    "it uses a staggered spatial grid with the options of specifying isothermal or non - isothermal layers .",
    "we have used ` helios - k ` @xcite to compute the opacities of the four molecules , which are active in the infrared , and combined those by weighing them with the validated analytical formulae of @xcite and @xcite for equilibrium chemistry . in order to combine the various gaseous absorbers we have employed a correlated-@xmath0 approximation , which assumes perfect correlation between the molecular bands .",
    "the boundary conditions are the stellar irradiation flux at the top of the model atmosphere and the internal heat flux at the bottom .",
    "` helios ` further allows for the stellar irradiation flux to be specified as a simple planck function or from a stellar model ( e.g. kurucz , ` phoenix ` ) .",
    "we have constructed and optimized ` helios ` to run on gpus , which allows for fast computation on a single machine .",
    "we have exploited this efficiency to explore the parameter space of stellar type , metallicity and c / o ratio .",
    "several groups have made contributions to a rich body of literature on self - consistent radiative transfer models in exoplanetary atmospheres .",
    "the work of @xcite uses the accelerated lambda iteration method , originally developed for stellar atmospheres @xcite .",
    "the work of @xcite and @xcite use an atmosphere modeling code and radiative transfer methods with a heritage from brown dwarf and solar system models @xcite .",
    "@xcite recently implemented a radiative transfer code using the two - stream approximation in the limit of pure absorption .",
    "@xcite constructed a pure - absorption code using the  variable eddington factor \" method , which has a heritage from the study of stellar atmospheres ( e.g. @xcite ) and protoplanetary disks @xcite .",
    "our approach and assembly of the various components ( see above ) and their collective implementation is a novel endeavor and we hope it will contribute to the advancement of this field .      in the current work ,",
    "we have considered a small set of the four main infrared absorbers ( h@xmath6o , co@xmath6 , co , ch@xmath7 ) , and included the opacity associated with cia from h@xmath6-h@xmath6 and h@xmath6-he pairs .",
    "future work should include more opacity sources , especially that associated with c@xmath6h@xmath6 and hcn , if one is interested in c / o@xmath182 models , and na and k as these are major absorbers in the visible for very hot planets .",
    "also , important at the higher - temperature end of exoplanets is continuum absorption by electrons moving freely in the field or being decoupled from the shell of neutral atoms ( e.g. h , he ) , molecules ( e.g. h@xmath6 ) or ions ( e.g. h@xmath142 ) @xcite .",
    "furthermore , it is important to conduct a study examining the accuracy of the employed correlated-@xmath0 approximation for different combinations of molecular absorbers , since this could be a potential source of error  a study similar to @xcite for the random - overlap scheme .",
    "another opportunity for future work is the inclusion of aerosols and clouds , whose proper implementation remains a subject of debate .",
    "additionally , we will implement convective adjustment as the next step in sophistication and we plan to investigate the effect of disequilibrium chemistry ( induced by both atmospheric motion and photochemistry ) and radiative disequilibrium by coupling ` helios ` to a chemical kinetics code and a general circulation model .",
    "hot jupiters are complex , three - dimensional entities ( e.g. , @xcite ) and interpreting them , on a detailed case - by - case basis , requires a three - dimensional model ( e.g. , @xcite ) . the exact interpretation of the molecular abundances associated with the 6 hot jupiters may be performed using an atmospheric retrieval code . `",
    "helios ` is a key component of the open - source exoclimes simulation platform ( esp ; exoclime.net ) , which includes a chemical kinetics code @xcite , retrieval code @xcite and general circulation models ( @xcite ; grosheintz et al .",
    ", in preparation ) .",
    "the up - to - date version of ` helios ` may be downloaded from its main repository github.com/exoclime/helios and the version used to produce the results in this work is archived under the doi : 10.5281/zenodo.164176 .",
    "m.m . , l.g . , s.g . , j.m . ,",
    "s.t . and k.h .",
    "thank the swiss national science foundation ( snf ) , the center for space and habitability ( csh ) , the planets national center of competence in research ( nccr ) and the merac foundation for partial financial support .",
    "we thank the developers of the thermochemical equilibrium abundances ( ` tea ` ) code @xcite , initially developed at the university of central florida , orlando , florida , usa . the reproducible - research compendium ( rrc ) is available at ` github.com/exoclime/helios.publications ` ."
  ],
  "abstract_text": [
    "<S> we present the open - source radiative transfer code named ` helios ` , which is constructed for studying exoplanetary atmospheres . in its initial version , the model atmospheres of ` helios ` are one - dimensional and plane - parallel , and the equation of radiative transfer is solved in the two - stream approximation with non - isotropic scattering . </S>",
    "<S> a small set of the main infrared absorbers is employed , computed with the opacity calculator ` helios - k ` and combined using a correlated-@xmath0 approximation . </S>",
    "<S> the molecular abundances originate from validated analytical formulae for equilibrium chemistry . </S>",
    "<S> we compare ` helios ` with the work of miller - ricci & fortney using a model of gj 1214b , and perform several tests , where we find : model atmospheres with single - temperature layers struggle to converge to radiative equilibrium ; @xmath0-distribution tables constructed with @xmath1 @xmath2 resolution in the opacity function ( @xmath3 points per wavenumber bin ) may result in errors @xmath410% in the synthetic spectra ; and a diffusivity factor of 2 approximates well the exact radiative transfer solution in the limit of pure absorption . we construct  null - hypothesis \" models ( chemical equilibrium , radiative equilibrium and solar element abundances ) for 6 hot jupiters . we find that the dayside emission spectra of hd 189733b and wasp-43b are consistent with the null hypothesis , while it consistently under - predicts the observed fluxes of wasp-8b , wasp-12b , wasp-14b and wasp-33b . we demonstrate that our results are somewhat insensitive to the choice of stellar models ( blackbody , kurucz or ` phoenix ` ) and metallicity , but are strongly affected by higher carbon - to - oxygen ratios . </S>",
    "<S> the code is publicly available as part of the exoclimes simulation platform ( esp ; exoclime.net ) . </S>"
  ]
}