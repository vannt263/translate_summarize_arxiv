{
  "article_text": [
    "particle - based numerical methods are routinely used in plasma physics calculations @xcite . in many cases these methods are more efficient and simpler to implement than the corresponding continuum eulerian methods . however , particle methods face the well known statistical sampling limitation of attempting to simulate a physical system containing @xmath0 particles using @xmath1 computational particles .",
    "particle methods do not seek to reproduce the exact individual behavior of the particles , but rather to approximate statistical macroscopic quantities like density , current , and temperature .",
    "these quantities are determined from the particle distribution function .",
    "therefore , a problem of relevance for the success of particle - based simulations is the reconstruction of the particle distribution function from discrete particle data .",
    "the difference between the distribution function reconstructed from a simulation using @xmath2 particles and the exact distribution function gives rise to a discretization error generically known as `` particle noise '' due to its random - like character .",
    "understanding and reducing this error is a complex problem of importance in the validation and verification of particle codes , see for example refs .",
    "@xcite and references therein for a discussion in the context of gyrokinetic calculations .",
    "one obvious way to reduce particle noise is by increasing the number of computational particles .",
    "however , the unfavorable scaling of the error with the number of particles , @xmath3 @xcite , puts a severe limitation on this straightforward approach .",
    "this has motivated the development of various noise reduction techniques including finite size particles ( fsp ) @xcite , monte - carlo methods @xcite , fourier - filtering @xcite , coarse - graining @xcite , krook operators @xcite , smooth interpolation @xcite , low noise collision operators @xcite , and proper orthogonal decomposition ( pod ) methods @xcite among others .    in the present paper",
    "we propose a wavelet - based method for noise reduction in the reconstruction of particle distribution functions from particle simulation data .",
    "the method , known as wavelet based density estimation ( wbde ) , was originally introduced in ref .",
    "@xcite in the context of statistics to estimate probability densities given a finite number of independent measurements .",
    "however , to our knowledge , this method has not been applied before to particle - base computations .",
    "wbde , as used here , is based on truncations of the wavelet representation of the dirac delta function associated with each particle .",
    "the method yields almost optimal results for functions with unknown local smoothness without compromising computational efficiency , assuming that the particles coordinates are statistically independent . as a first step in the application of the wbde method to plasma particle simulations , we limit attention to `` passive denoising '' . that is the wbde method",
    "is treated as a post - processing technique applied to independently generated particle data .",
    "the problem of `` active denoising '' , e.g. the application of wbde methods in the evaluation of self - consistent fields in particle in cell simulations , will not be addressed .",
    "this simplification will allow us to assess the efficiency of the proposed noise reduction method in a simple setting .",
    "another simplification pertains the dimensionality . here , for the sake of simplicity , we limit attention to the reconstruction and denoising problem in two dimensions . however , the extension of the wbde method to higher dimensions is in principle straightforward .",
    "collisions , or the absence of them , play an important role in plasma transport problems .",
    "particle methods handle the collisional and non - collisional parts of the dynamics differently .",
    "fokker - planck - type collision operators are typically introduced in particle methods using langevin - type stochastic differential equations . on the other hand ,",
    "the non - collisional part of the dynamics is described using deterministic ordinary differential equations .",
    "collisional dominated problems tend to washout small scale structures whereas collisionless problems typically develop fine scale filamentary structures in phase space .",
    "therefore , it is important to test the dependence of the efficiency of denoising reconstruction methods on the level of collisionality .",
    "here we test the wbde method in strongly collisional , weakly collisional and collisionless regimes . for the strongly collisional regime",
    "we consider particle data of force - free collisional relaxation involving energy and pinch - angle scattering .",
    "the weakly collisional regime is illustrated using guiding - center particle data of a magnetically confined plasma in toroidal geometry .",
    "the collisionless regime is studied using particle in cell ( pic ) data corresponding to bump - on - tail and two streams instabilities in the vlasov - poisson system .    beyond the role of collisions",
    ", the data sets that we are considering open the possibility of exploring the role of external and self - consistent fields in the reconstruction of the particle density . in the collisional relaxation problem no forces act on the particles , in the guiding - center problem particles interact with an external magnetic field , and in the vlasov - poisson problem particle interactions are incorporated through a self - consistent electrostatic mean field .",
    "one of the goals of this paper is to compare the wbde method with the proper orthogonal decomposition ( pod ) density reconstruction method proposed in ref .",
    "@xcite .",
    "the rest of the paper is organized as follows . in sect .",
    "ii we review the main properties of kernel density estimation ( kde ) and show its relationship with finite size particles ( fsp ) .",
    "we then review basic notions on orthogonal wavelet and multiresolution analysis and outline a step by step algorithm for wbde .",
    "also , for completeness , in this section we include a brief description of the pod reconstruction method proposed in ref .",
    "@xcite . section  iii discusses applications of the wbde method and the comparison with the pod method .",
    "we start by post - processing a simulation of plasma relaxation by random collisions against a background thermostat .",
    "we then turn to a @xmath4 monte - carlo simulation in toroidal geometry , whose phase space has been reduced to two dimensions .",
    "finally , we analyze the results of particle - in - cell ( pic ) simulations of a 1d vlasov - poisson plasma . the conclusions are presented in sec .  iv .",
    "this section presents the wavelet - based density estimation ( wbde ) algorithm .",
    "we start by reviewing basic ideas on kernel density estimation ( kde ) which is closely related to the use of finite size particles ( fsp ) in pic simulations . following this",
    ", we we give a brief introduction to wavelet analysis and discuss the wbde algorithm . for completeness",
    ", we also include a brief summary of the pod approach .      given a sequence of independent and identically distributed measurements , the nonparametric density estimation problem consists in finding the underlying probability density function ( pdf ) , with no a priori assumptions on its functional form .",
    "here we discuss general ideas on this difficult problem for which a variety of statistical methods have been developed .",
    "further details can be found in the statistics literature , e.g. ref .",
    "@xcite .",
    "consider a number @xmath2 of statistically independent particles with phase space coordinates @xmath5 distributed in @xmath6 according to a pdf @xmath7 .",
    "this data can come from a pic or a monte - carlo , full @xmath7 or @xmath4 simulation .",
    "formally , the sample pdf can be written as @xmath8 where @xmath9 is the dirac distribution . because of its lack of smoothness , eq .",
    "( [ dirac_estimate ] ) is far from the actual distribution @xmath7 according to most reasonable definitions of the error .",
    "moreover , the dependence of @xmath10 on the statistical fluctuations in @xmath11 can lead to an artificial increase of the collisionality of the plasma .",
    "the simplest method to introduce some smoothness in @xmath10 is to use a histogram . consider a tiling of the phase space by a cartesian grid with @xmath12 cells .",
    "let @xmath13 denote the set of all cells with characteristic function @xmath14 defined as @xmath15 if @xmath16 and @xmath17 otherwise .",
    "then the histogram corresponding to the tiling is @xmath18 which can also be viewed as the orthogonal projection of @xmath10 on the space spanned by the @xmath14 .",
    "the main difference between @xmath19 and @xmath20 is that the latter can not vary at scales finer than the grid scale which is of order @xmath21 . by choosing @xmath22 small enough",
    ", it is therefore possible to reduce the variance of @xmath20 to very low levels , but the estimate then becomes more and more biased towards a piecewise continuous function , which is not smooth enough to be the true density .",
    "histograms correspond to the nearest grid point ( ngp ) charge assignment scheme used in the early days of plasma physics computations @xcite .",
    "one of the most popular methods to achieve higher level of smoothness is kernel density estimation ( kde ) @xcite .",
    "given @xmath5 , the kernel estimate of @xmath7 is defined as @xmath23 where the smoothing kernel @xmath24 is a positive definite , normalized , @xmath25 , function .",
    "equation  ( [ kernel_estimate ] ) corresponds to the convolution of @xmath24 with the dirac delta measure corresponding to each particle .",
    "a typical example is the gaussian kernel @xmath26 where the so - called `` bandwidth '' , or smoothing scale , @xmath27 , is a free parameter .",
    "the optimal smoothing scale depends on how the error is measured .",
    "for example , in the one dimensional case , to minimize the mean @xmath28-error between the estimate and the true density , the smoothing volume @xmath29 should scale like @xmath30 , and the resulting error scales like @xmath31 @xcite . as in the case of histograms , the choice of @xmath27 relies on a trade - off between variance and bias . in the context of plasma physics simulations",
    "the kernel @xmath24 corresponds to the charge assignment function @xcite .",
    "a significant effort has been devoted in the choice of the function @xmath24 since it has a strong impact on computational efficiency and on the conservation of global quantities .",
    "concerning @xmath27 , it has been shown that it should not be much larger than the debye length @xmath32 of the plasma to obtain a realistic and stable simulation @xcite .",
    "given a certain amount of computational resources , the general tendency has thus been to reduce @xmath27 as far as possible in order to fit more debye lengths inside the simulation domain , which means that the effort has been concentrated on reducing the bias term in the error .",
    "since the force fields depend on @xmath7 through integral equations , like the poisson equation , that tend to reduce the high wavenumber noise , we do not expect the disastrous scaling @xmath33 , which would mean @xmath34 in @xmath35 dimensions , to hold .",
    "nevertheless , the problem remains that if we want to preserve high resolution features of @xmath7 or of the electromagnetic fields , we need to reduce @xmath27 , and therefore greatly increase the number of particles to prevent the simulation from drowning into noise .",
    "bandwidth selection has long been recognized as the central issue in kernel density estimation @xcite .",
    "we are not aware of a theoretical or numerical prediction of the optimal value of @xmath27 taking into account the noise term . to bypass this difficulty , it is possible to use new statistical methods which do not force us to choose a global smoothing parameter .",
    "instead , they adapt locally to the behavior of the density @xmath7 based on the available data .",
    "wavelet based - density estimation , which we will introduce in the next two sections , is one of these methods .",
    "wavelets are a standard mathematical tool to analyze and compute non stationary signals . here",
    "we recall basic concepts and definitions .",
    "further details can be found in ref .",
    "@xcite and references therein .",
    "the construction takes place in the hilbert space @xmath36 of square integrable functions .",
    "an orthonormal family @xmath37 is called a wavelet family when its members are dilations and translations of a fixed function @xmath38 called the mother wavelet : @xmath39 where @xmath40 indexes the scale of the wavelets and @xmath41 their positions , and @xmath38 satisfies @xmath42 . in the following",
    "we shall always assume that @xmath38 has compact support of length @xmath43 .",
    "the coefficients @xmath44 of a function @xmath7 for this family are denoted by @xmath45 .",
    "these coefficients describe the fluctuations of @xmath7 at scale @xmath46 around position @xmath47 .",
    "large values of @xmath40 correspond to fine scales , and small values to coarse scales .",
    "some members of the commonly used daubechies 6 wavelet family are shown in the left panel of fig .",
    "it can be shown that the orthogonal complement in @xmath36 of the linear space spanned by the wavelets is itself orthogonally spanned by the translates of a function @xmath48 , called the scaling function . defining @xmath49 and the scaling coefficients",
    "@xmath50 , one thus has the reconstruction formula : @xmath51 the first sum on the right hand side of eq .",
    "( [ wavelet_reconstruction ] ) is a smooth approximation of @xmath7 at the coarse scale , @xmath52 , and the second sum corresponds to the addition of details at successively finer scales .",
    "if the wavelet @xmath38 has @xmath53 vanishing moments : @xmath54 for @xmath55 , and if @xmath7 is locally @xmath56 times continuously differentiable around some point @xmath57 , then a key property of the wavelet expansion is that the coefficients located near @xmath57 decay when @xmath58 like @xmath59 @xcite . hence , localized singularities or sharp features in @xmath7 affect only a finite number of wavelet coefficients within each scale . another important consequence of ( [ vanishing_moments ] ) of special relevance to particle methods is that for @xmath55 , the moments @xmath60 of the particle distribution function depend only on its scaling coefficients , and not on its wavelet coefficients .",
    "if the scaling coefficients @xmath61 at a certain scale @xmath62 are known , all the wavelet coefficients at coarser scales ( @xmath63 ) can be computed using the fast wavelet transform ( fwt ) algorithm @xcite .",
    "we shall address the issue of computing the scaling coefficients themselves in section [ critical_discussion ] .",
    "the generalization to @xmath35 dimensions involves tensor products of wavelets and scaling functions at the same scale .",
    "for example , given a wavelet basis on @xmath64 , a wavelet basis on @xmath65 can be constructed in the following way : @xmath66 where we refer to the exponent @xmath67 as the direction of the wavelets .",
    "this name is easily understood by looking at different wavelets shown in fig .",
    "[ daubechies_wavelets_1d ] ( right ) .",
    "the corresponding scaling functions are simply given by @xmath68 .",
    "wavelets on @xmath6 are constructed exactly in the same way , but this time using @xmath69 directions . to lighten the notation we write the @xmath35-dimensional analog of eq .",
    "( [ wavelet_reconstruction ] ) as @xmath70 where @xmath71 is a multi - index , with the integer @xmath40 denoting the scale and the integer vector @xmath72 denoting the position of the wavelet .",
    "the wavelet multiresolution reconstruction formula in eq .",
    "( [ wavelet_reconstruction ] ) involves an infinite sum over the position index @xmath41 .",
    "one way of dealing with this sum is to determine a priori the non - zero coefficients in eq .",
    "( [ wavelet_reconstruction ] ) , and work only with these coefficients , but still retaining the full wavelet basis on @xmath6 as presented above .",
    "another alternative , which we have chosen because it is easier to implement , is to periodize the wavelet transform on a bounded domain @xcite .",
    "assuming that the coordinates have been rescaled so that all the particles lie in @xmath73^d$ ] , we replace the wavelets and scaling functions by their periodized counterparts : @xmath74 throughout this paper we will consider only periodic wavelets .",
    "for the sake of completeness we mention a third alternative which is technically more complicated .",
    "it consists in constructing a wavelet basis on a bounded interval @xcite .",
    "the advantage of this approach is that it does not introduce artificially large wavelet coefficients at the boundaries for functions @xmath7 that are not periodic .",
    "the multiscale nature of wavelets allows them to adapt locally to the smoothness of the analyzed function @xcite .",
    "this fundamental property has triggered their use in a variety of problems .",
    "one of their most fruitful applications has been the denoising of intermittent signals @xcite .",
    "the practical success of wavelet thresholding to reduce noise relies on the observation that the expansion of signals in a wavelet basis is typically sparse .",
    "sparsity means that the interesting features of the signal are well summarized by a small fraction of large wavelet coefficients . on the contrary , the variance of the noise is spread over all the coefficients appearing in eq .",
    "( [ wavelet_reconstruction_2d ] ) .",
    "although the few large coefficients are of course also affected by noise , curing the noise in the small coefficients is already a very good improvement .",
    "the original setting of this technique , hereafter referred to as global wavelet shrinkage , requires the noise to be additive , stationary , gaussian and white .",
    "it found a first application in plasma physics in ref .",
    "@xcite , where coherent bursts were extracted out of plasma density signals . since ref .",
    "@xcite , wavelet denoising has been extended to a number of more general situations , like non - gaussian or correlated additive noise , or to denoise the spectra of locally stationary time series @xcite .",
    "in particular , the same ideas were developed in ref .",
    "@xcite to propose a wavelet - based density estimation ( wbde ) method based on independent observations . at this point",
    "we would like to stress that wbde assumes nothing about the gaussianity of the noise or whether or not it is stationary .",
    "in fact , under the independence hypothesis  which is admittedly quite strong  the statistical properties of the noise are entirely determined by standard probability theory .",
    "we refer to ref .",
    "@xcite for a review on the applications of wavelets in statistics . in ref .",
    "@xcite , global wavelet shrinkage was applied directly to the charge density of a 2d pic code , in a case were the statistical fluctuations were quasi gaussian and stationary .",
    "in particular , an iterative algorithm @xcite , which crucially relies on the stationnarity hypothesis , was used to determine the level of fluctuations . however , in the next section we will show an example where the noise is clearly non - stationary , and this procedure fails .",
    "let us now describe the wbde method as we have generalized it to several dimensions .",
    "the first step is to expand the sample particle distribution function , @xmath10 , in eq .",
    "( [ dirac_estimate ] ) in a wavelet basis according to eq .",
    "( [ wavelet_reconstruction_2d ] ) with the wavelet coefficients @xmath75 since this reconstruction is exact , keeping all the wavelet coefficients does not improve the smoothness of @xmath10 .",
    "the simple and yet efficient remedy consists in keeping only a subset of the wavelet coefficients in eq .",
    "( [ wavelet_reconstruction_2d ] ) .",
    "a straightforward prescription would be to discard all the wavelet coefficients at scales finer than a cut - off scale @xmath76 .",
    "this approach corresponds to a generalization of the histogram method in eq .",
    "( [ histogram_estimate ] ) with @xmath77 . because the characteristic functions @xmath14 of the cells in a dyadic grid are the scaling functions associated with the haar wavelet family , eqs .",
    "( [ wavelet_reconstruction_2d ] ) and ( [ histogram_estimate ] ) are in fact equivalent for this wavelet family . accordingly , like in the histogram case , we would have to choose @xmath76 quite low to obtain a stable estimate , at the risk of losing some sharp features of @xmath7 .",
    "better results can be obtained by keeping some wavelet coefficients down to a much finer scale @xmath78 .",
    "however , to prevent that statistical fluctuations contaminate the estimate , only those coefficients whose modulus are above a certain threshold should be kept .",
    "we are thus naturally led to a nonlinear thresholding procedure . in the one dimensional case , values of @xmath62 , @xmath76 , and of the threshold within each scale that yield",
    "theoretically optimal results have been given in ref .",
    "this reference discusses the precise smoothness requirements on @xmath7 , which can accommodate well localized singularities , like shocks and filamentary structures known to arise in collisionless plasma simulations .",
    "there remains the question of how to compute the @xmath79 based on the positions of the particles .",
    "although more accurate methods based on ( [ empirical_wavelet_coefficients ] ) may be developed in the future , our present approximation relies on the computation of a histogram , which creates errors of order @xmath21 .",
    "the complete procedure is described in the following * wavelet - based density estimation * algorithm :    1 .",
    "[ histogram_approx ] construct a histogram @xmath20 of the particle data with @xmath80 cells in each direction , 2 .",
    "[ scaling_function_approx ] approximate the scaling coefficients at the finest scale @xmath81 by : @xmath82 3 .",
    "compute all the needed wavelet coefficients using the fwt algorithm , 4 .",
    "keep all the coefficients for scales coarser than @xmath76 , defined by @xmath83 where @xmath84 is the order of regularity of the wavelet ( 1 in our case ) , 5 .",
    "discard all the coefficients for scales strictly finer than @xmath62 defined by @xmath85 , 6 .",
    "[ thresholding_function ] for scales @xmath40 in between @xmath76 and @xmath62 , keep only the wavelet coefficients @xmath86 such that @xmath87 where @xmath88 is a constant that must in principle depend on the smoothness of @xmath7 and on the wavelet family @xcite .    in the following , except otherwise indicated , @xmath89 . for the wavelet bases we used orthonormal daubechies wavelets with 6 vanishing moments and",
    "thus support of size @xmath90 @xcite . in our case , @xmath91 , which means that the wavelets have a first derivative but no second derivative , and the size of the wavelets at scale @xmath76 for @xmath92 is roughly @xmath93 . since @xmath94",
    ", it follows from the definition at stage 5 of the algorithm that the size of the wavelets at scale @xmath62 is orders of magnitude smaller than that . using the adaptive properties of wavelets , we are thus able to detect small scale structures of @xmath7 without compromising the stability of the estimate .",
    "note that the error at stage [ scaling_function_approx ] could be reduced by using coiflets @xcite instead of daubechies wavelets , but the gain would be negligible compared to the error made at stage [ histogram_approx ] .",
    "we will denote the wbde estimate of @xmath7 as @xmath95 .",
    "in the one - dimensional case , @xmath96 where @xmath97 is the thresholding function as defined by stage [ thresholding_function ] of the algorithm : @xmath98",
    "if @xmath99 and @xmath100 otherwise .    finally , let us propose two methods for applying wbde to postprocess @xmath4 simulations .",
    "recall that the lagrangian equations involved in the @xmath4 schemes are identical to their full @xmath7 counterparts .",
    "the only difficulty introduced by the @xmath4 method lies in the evaluation of phase space integrals of the form @xmath101 , where @xmath102 is a function on phase space and @xmath103 is a known reference distribution function . in these integrals ,",
    "@xmath104 should be replaced by @xmath4 , which is in turn written as a product @xmath105 , where @xmath106 is a `` weighting '' function .",
    "numerically , @xmath106 is known via its values at particles positions , @xmath107 , and the usual expression for @xmath108 is thus @xmath109 .",
    "we can not apply wbde directly to @xmath4 , since this function is not a density function.an elegant approach would be to first apply wbde to the unweighted distribution @xmath10 to determine the set of statistically significant wavelet coefficients , and to include the weights only in the final reconstruction ( [ explicit_wavelet_estimate ] ) of @xmath95",
    ". a simpler approach , which we will illustrate in section [ delta_5d_example ] , consists in renormalizing @xmath4 , so that @xmath110 , and treat it like a density .      in this section",
    "we discuss how the wbde method handles two issues of direct relevance to plasma simulations : conservation of moments and computational efficiency .",
    "as mentioned before , due to the vanishing moments of the wavelets in eq .",
    "( [ vanishing_moments ] ) , the moments up to order @xmath53 of the particle distribution distribution are solely determined by its scaling function coefficients . as a consequence",
    ", we expect the thresholding procedure to conserve these moments , in the sense that @xmath111 for @xmath112 and for all @xmath113 .",
    "this conservation holds up to round - off error if the wavelet coefficients can be computed exactly . due to the type of wavelets that we have used , we were not able to achieve this in the results presented here . there remains a small error related to stages 1 and 2 of the algorithm , namely the construction of @xmath20 and the approximation of the scaling function coefficients by eq .",
    "( [ scaling_function_approximation ] ) .",
    "they are both of order @xmath21 .",
    "we will present numerical examples of the moments of @xmath95 in the next section .",
    "conservation of moments is closely related to a peculiarity of the denoised distribution function resulting from the wbde algorithm : it is not necessarily everywhere positive .",
    "indeed , wavelets are oscillating functions by definition , and removing wavelet coefficients therefore can not preserve positivity in general .",
    "further studies are needed to assess if this creates numerical instabilities when @xmath95 is used in the computation of self - consistent fields .",
    "the same issue was discussed in ref .",
    "@xcite where a kernel with two vanishing moments was used to linearly smooth the distribution function .",
    "the fact that this kernel is not everywhere positive was not considered harmful in this reference .",
    "we acknowledge that it may render the resampling of new particles from @xmath95 , if it is needed in the future , more difficult .",
    "there are ways of forcing @xmath95 to be positive , for example by applying the method to @xmath114 and then taking the square of the resulting estimate , but this implies the loss of the moment conservation , and we have not pursued in this direction .",
    "daubechies 6 wavelet family . left , bold red : scaling function @xmath48 at scale @xmath115 .",
    "left , bold blue : wavelet @xmath38 at scale @xmath115 .",
    "left , thin black , from left to right : wavelets at scales 6 , 7 , 8 and 9 .",
    "right : ( a ) 2d scaling function @xmath116 .",
    "( b ) first 2d wavelet @xmath117 .",
    "( c ) second 2d wavelet @xmath118 .",
    "( d ) third 2d wavelet @xmath119 . , title=\"fig : \" ] daubechies 6 wavelet family . left , bold red : scaling function @xmath48 at scale @xmath115 .",
    "left , bold blue : wavelet @xmath38 at scale @xmath115 .",
    "left , thin black , from left to right : wavelets at scales 6 , 7 , 8 and 9 .",
    "right : ( a ) 2d scaling function @xmath116 .",
    "( b ) first 2d wavelet @xmath117 .",
    "( c ) second 2d wavelet @xmath118 .",
    "( d ) third 2d wavelet @xmath119 . , title=\"fig : \" ]    the number of arithmetic operations to perform a fast wavelet transform from scale @xmath120 to scale @xmath52 with the fwt in @xmath35 dimensions is @xmath121 , where @xmath43 is the length of the wavelet filter ( 12 for the daubechies filter that we are using ) . the definitions of @xmath62 and @xmath76 imply that @xmath122 scales like @xmath123 . the cost of the binning stage of order @xmath124 , so that the total cost for computing @xmath95 is @xmath125 , not larger than the cost of one time step during the simulation that produced the data .",
    "the amount of memory needed to store the wavelet coefficients during the denoising procedure is proportional to @xmath12 , which should at least scale like @xmath126 , and therefore also like @xmath2 .",
    "if one wishes to use a finer grid to ensure high accuracy conservation of moments , the storage requirements grow like @xmath12 .",
    "thanks to optimized in - place algorithms , the amount of additional memory needed during the computation does not exceed @xmath127 .",
    "another consequence of using the fwt algorithm is that @xmath22 must be an integer multiple of @xmath128 . for comparison purposes ,",
    "let us recall that most algorithms to compute the pod have a complexity proportional to @xmath129 when @xmath130 .    to conclude this subsection , fig .",
    "[ example_1d ] presents an example of the reconstruction of a 1d discontinuous density that illustrates the difference between the kde and wbde methods .",
    "the probability density function is uniform on the interval @xmath131 $ ] and the estimates were computed on @xmath132 $ ] to include the discontinuities .",
    "the sample size was @xmath133 , and the binning used @xmath134 cells to compute the scaling function coefficients .",
    "for this 1d case the value @xmath135 was used to determine the thresholds ( step [ thresholding_function ] of the algorithm ) .",
    "the kde estimate is computed using a gaussian kernel with smoothing scale @xmath136 @xcite .",
    "the relative mean squared errors associated with the kde and wbde estimates are respectively @xmath137 and @xmath138 .",
    "the error in the kde estimate comes mostly from the smoothing of the discontinuities",
    ". the better performance of wbde stems from the much sharper representation of these discontinuities .",
    "it is also observed that the wbde estimate is not everywhere positive .",
    "the approximate conservation of moments is demonstrated on table [ example_1d_moments ] .",
    "note that the error on all these moments for @xmath95 could be made arbitrary low by increasing @xmath22 .",
    "the overshoots could also be mitigated by using nearly shift invariant wavelets @xcite .",
    "estimation of the density of a sample of size @xmath133 drawn uniformly in @xmath139 $ ] , using gaussian kernels ( left ) or wavelets ( right ) .",
    "the discontinuous analytical density is plotted with a dashed line in the two cases .",
    ", title=\"fig : \" ]   estimation of the density of a sample of size @xmath133 drawn uniformly in @xmath139 $ ] , using gaussian kernels ( left ) or wavelets ( right ) .",
    "the discontinuous analytical density is plotted with a dashed line in the two cases .",
    ", title=\"fig : \" ]      for completeness , in this subsection we present a brief review of the pod density reconstruction method . for the sake of comparison with the wbde method ,",
    "we limit attention to the time independent case . further details , including the reconstruction of time dependent densities using pod methods can be found in ref .",
    "@xcite .",
    "the first step in the pod method is to construct the histogram @xmath20 from the particle data .",
    "this density is represented by an @xmath140 matrix @xmath141 containing the fraction of particles with coordinates @xmath142 such that @xmath143 and @xmath144 . in two dimensions ,",
    "the pod method is based on the singular value decomposition of the histogram . according to the svd theorem @xcite",
    ", the matrix @xmath145 can always be factorized as @xmath146 where @xmath147 and @xmath148 are @xmath149 and @xmath150 orthogonal matrices , @xmath151 , and @xmath152 is a diagonal matrix , @xmath153 , such that @xmath154 . with @xmath155 .    in vector form",
    ", the decomposition can be expressed as [ svd_vector ] _ ij= _",
    "k=1^n w_k u^(k)_i v^(k)_j , where the @xmath156-dimensional vectors , @xmath157 , and the @xmath158-dimensional vectors , @xmath159 , are the orthonormal pod modes and correspond to the columns of the matrices @xmath147 and @xmath148 respectively . given the decomposition in eq .",
    "( [ svd_vector ] ) , we define the rank-@xmath160 approximation of @xmath145 as [ lr_svd ] ^(r)_ij= _ k=1^r w_k u^(k)_i v^(k)_j , where @xmath161 , and define the corresponding rank-@xmath160 reconstruction error as [ nre ] e(r ) = || -^(r ) ||^2",
    "= _ i = r+1^n w_i^2 , where @xmath162 is the frobenius norm . since @xmath163",
    ", we define @xmath164 .",
    "the key property of the pod is that the approximation in eq .",
    "( [ lr_svd ] ) is optimal in the sense that e(r ) = min \\ { ||-g||^2 | rank ( g )",
    "= r . } . that is , of all the possible rank-@xmath160",
    "cartesian product approximations of @xmath145 , @xmath165 is the closest to @xmath145 in the frobenius norm .",
    "the svd spectrum , @xmath166 , of noise free coherent signals decays very rapidly after a few modes , but the spectrum of noise dominated signals is relatively flat and decays very slowly .",
    "when a coherent signal is contaminated with low level noise , the svd spectrum exhibits an initial rapid decay followed by a weakly decaying spectrum known as the noisy plateau . in the pod method the denoised density is defined as the truncation @xmath167 , where @xmath168 corresponds to the rank where the noisy plateau starts . in general it is difficult to provide a precise a priori estimate of @xmath168 , and this is one of the potential limitations of the pod method .",
    "one possible quantitative criterion used in ref .",
    "@xcite is to consider the relative decay of the spectrum , @xmath169 , for @xmath170 , and define @xmath168 by the condition @xmath171 where @xmath172 is a predetermined threshold .",
    "l*6cr & @xmath173 & @xmath174 & @xmath175 & @xmath176 + @xmath177 & @xmath178 & @xmath179 & @xmath180 & @xmath181 + @xmath95 & @xmath182 & @xmath183 & @xmath184 & @xmath185 +",
    "in this section , we apply the wbde method to reconstruct and denoise the particle distribution function starting from discrete particle data .",
    "the data corresponds to three different groups of simulations : collisional thermalization with a background plasma , guiding center transport in toroidal geometry , and vlasov - poisson electrostatic instabilities .",
    "the first two groups of simulations were analyzed using pod methods in ref .",
    "one of the goals of this section is to compare the pod method with the wbde method in these cases and in a new vlasov - poisson data set .",
    "this data set allows the testing of the reconstruction algorithms in a collisionless system that incorporates the self - consistent evaluation of the forces acting on the particles , as opposed to the collisional , test particle problems analyzed before . when comparing the two methods it is important to keep in mind that pod has one free parameter , namely the number @xmath160 of singular vectors that are retained to reconstruct the denoised distribution function . in the cases studied here we used a best guess for @xmath160 based on the properties of the reconstruction . in ref .",
    "@xcite the pod method was developed and applied to time independent and time dependent data sets .",
    "however , in the comparison with the wbde method , we limit attention to @xmath186-dimensional time independent data sets .    the accuracy of the reconstruction of the density at a fixed time @xmath187 will be monitored using the absolute mean square error @xmath188 where @xmath189 are the coordinates of the nodes of a prescribed @xmath190 grid in the space , and @xmath191 denotes the estimated density computed from a sample with @xmath2 particles . for the wbde method @xmath192 , and for the pod method @xmath193 . in principle , the reference density , @xmath194 , in eq .",
    "( [ error_e ] ) should be the density function obtained from the exact solution of the corresponding continuum model , e.g. the fokker - planck or the vlasov - poisson system . however , when no explicit solution is available , we will set @xmath195 where @xmath196 is the histogram corresponding to a simulation with a maximum number of particles available which in the cases reported here correspond to @xmath197 .",
    "we will also use the normalized error [ error_e0 ] e_0= .",
    "this first example models the relaxation of a non equilibrium plasma by collisional damping and pitch angle scattering on a thermal background .",
    "the plasma is spatially homogeneous and is represented by an ensemble of @xmath2 particles in a three - dimensional velocity space . assuming a strong magnetic field , the dynamics can be reduced to two degrees of freedom : the magnitude of the particle velocity , @xmath198 , and the particle pitch , @xmath199 , where @xmath200 is the angle between the particle velocity and the magnetic field . in the continuum limit the particle distribution function",
    "is governed by the fokker - planck equation which in the particle description corresponds to the stochastic differential equations [ mc_1 ] d = - _ d dt - d _ , [ mc_2 ] d v = - dt + d_v , describing the evolution of @xmath201 and @xmath202 $ ] for each particle , where @xmath203 and @xmath204 are independent wiener stochastic processes and @xmath205 , @xmath206 and @xmath207 are functions of @xmath198 . for",
    "further details on the model see ref .",
    "@xcite and references therein .",
    "we considered simulations with @xmath208 , @xmath209 , @xmath210 and @xmath211 particles .",
    "the initial conditions of the ensemble of particles were obtained by sampling a distribution of the form [ f_ic ] f(v,,t=0)= c v^2 \\ { - } , where a @xmath212 factor has been included in the definition of the initial condition so that the volume element is simply @xmath213 , @xmath88 is a normalization constant , @xmath214 , @xmath215 , @xmath216 and @xmath217 .",
    "this relatively simple problem is particularly well suited for the wbde method because the simulated particles do not interact and therefore statistical correlations can not build - up between them .    before applying the wbde method",
    ", we analyze the sparsity of the wavelet expansion of @xmath10 , and compare the number of modes kept and the reconstruction error for different thresholding rules . the plot in the upper left panel of fig .",
    "[ compression_curve_time_dependent ] shows the absolute values of the wavelet coefficients in decreasing order at different fixed times .",
    "the wavelet coefficients exhibit a clear rapid decay beyond the few significant modes corresponding to the gross shape of the maxwellian distribution .",
    "a similar trend is observed in the coefficients of the pod expansion shown in the upper right panel of fig .",
    "[ compression_curve_time_dependent ] .",
    "however , in the wavelet case the exponential decay starts after more than @xmath218 modes , whereas in the pod case the exponential decay starts after only one mode .",
    "wavelet and pod analyses of collisional relaxation particle data at different fixed times , with @xmath219 .",
    "top left : absolute values of the wavelet coefficients sorted by decreasing order ( full lines ) , and thresholds given by the waveshrink algorithm ( dashed lines ) .",
    "top right : singular values of the histogram used to construct @xmath220 .",
    "bottom left : error estimate @xmath221 with respect to the run for @xmath222 as a function of the number of retained wavelet coefficients ( full lines ) , error obtained when using the waveshrink threshold ( dashed lines ) , and error obtained using the wbde method ( dash - dotted lines ) .",
    "bottom right : error estimate @xmath223 for @xmath220 as a function of the number @xmath224 of retained singular values .",
    ", title=\"fig : \" ]   wavelet and pod analyses of collisional relaxation particle data at different fixed times , with @xmath219 .",
    "top left : absolute values of the wavelet coefficients sorted by decreasing order ( full lines ) , and thresholds given by the waveshrink algorithm ( dashed lines ) .",
    "top right : singular values of the histogram used to construct @xmath220 .",
    "bottom left : error estimate @xmath221 with respect to the run for @xmath222 as a function of the number of retained wavelet coefficients ( full lines ) , error obtained when using the waveshrink threshold ( dashed lines ) , and error obtained using the wbde method ( dash - dotted lines ) .",
    "bottom right : error estimate @xmath223 for @xmath220 as a function of the number @xmath224 of retained singular values .",
    ", title=\"fig : \" ]   wavelet and pod analyses of collisional relaxation particle data at different fixed times , with @xmath219 .",
    "top left : absolute values of the wavelet coefficients sorted by decreasing order ( full lines ) , and thresholds given by the waveshrink algorithm ( dashed lines ) .",
    "top right : singular values of the histogram used to construct @xmath220 .",
    "bottom left : error estimate @xmath221 with respect to the run for @xmath222 as a function of the number of retained wavelet coefficients ( full lines ) , error obtained when using the waveshrink threshold ( dashed lines ) , and error obtained using the wbde method ( dash - dotted lines ) .",
    "bottom right : error estimate @xmath223 for @xmath220 as a function of the number @xmath224 of retained singular values .",
    ", title=\"fig : \" ]   wavelet and pod analyses of collisional relaxation particle data at different fixed times , with @xmath219 .",
    "top left : absolute values of the wavelet coefficients sorted by decreasing order ( full lines ) , and thresholds given by the waveshrink algorithm ( dashed lines ) .",
    "top right : singular values of the histogram used to construct @xmath220 .",
    "bottom left : error estimate @xmath221 with respect to the run for @xmath222 as a function of the number of retained wavelet coefficients ( full lines ) , error obtained when using the waveshrink threshold ( dashed lines ) , and error obtained using the wbde method ( dash - dotted lines ) .",
    "bottom right : error estimate @xmath223 for @xmath220 as a function of the number @xmath224 of retained singular values .",
    ", title=\"fig : \" ]    the two panels at the bottom of fig .",
    "[ compression_curve_time_dependent ] show the square root of the reconstruction error normalized by @xmath22 , @xmath225 , in the wbde and pod methods .",
    "because in this case we do not have access to the exact solution of the corresponding fokker - planck equation at the prescribed time , we used @xmath20 computed using @xmath197 particles as the reference density @xmath194 in eq .",
    "( [ error_e ] ) .",
    "the error observed when applying a global threshold to the wavelet coefficients ( bottom left panel in fig .",
    "[ compression_curve_time_dependent ] ) is minimal when around @xmath218 modes are kept whereas in the pod case ( bottom right panel in fig .",
    "[ compression_curve_time_dependent ] ) the minimal error is reached with about two or three modes .",
    "[ compression_curve_time_dependent ] also shows the wavelet threshold obtained by applying the iterative algorithm based on the stationary gaussian white noise hypothesis @xcite . the error corresponding to this threshold is larger than the optimal error because the noise in this problem is very non - stationary due to the lack of statistical fluctuations in the regions",
    "were particles are absent .",
    "in contrast , the error corresponding to the wbde procedure ( dash - dotted line ) is typically smaller than the optimal error obtained by global thresholding.this is not a contradiction , because the wbde procedure is not a global threshold , but a level dependent threshold .",
    "contour - plots of estimates of @xmath7 for the collisional relaxation particle data .",
    "first row : histogram method estimated using @xmath226 particles . second row : histogram method estimated using @xmath227 particles .",
    "third row : pod method estimated using @xmath228 particles .",
    "fourth row : wbde method estimated using @xmath228 particles .",
    "the three columns correspond to @xmath229 , @xmath230 and @xmath231 respectively .",
    "the plots show twenty isolines , equally spaced in the interval @xmath232 $ ] . ]",
    "figure  [ time_dependent_contour_plots ] compares at different times the densities estimated with the wbde and the pod ( retaining only three modes ) methods using @xmath228 particles with the histograms computed using @xmath228 and @xmath211 particles .",
    "the key future to observe is that the level of smoothness of @xmath95 and @xmath220 corresponding to @xmath228 is similar , if not greater , than the level of smoothness in @xmath20 computed using ten times more particles , i.e. @xmath197 particles .",
    "table  [ time_dependent_error ] summarizes the normalized reconstruction errors for @xmath228 according eq .",
    "( [ error_e ] ) using @xmath20 with @xmath197 as @xmath194 .",
    "the wbde and pod denoising methods offer a significant improvement , approximately by a factor @xmath186 , over the raw histogram method .",
    "l*6cr & @xmath233 & @xmath234 & @xmath235 + @xmath20 & @xmath236 & @xmath237 & @xmath238 + @xmath220 & @xmath239 & @xmath240 & @xmath241 + @xmath95 & @xmath242 & @xmath241 & @xmath243 +    a more detailed comparison of the estimates can be achieved by focusing on the maxwellian final equilibrium state [ f_max ] f_m(v)= v^2 e^-v^2 , where , as in eq .",
    "( [ f_ic ] ) , the @xmath212 metric factor has been included in the definition of the distribution .",
    "for this calculations we considered sets of particles sampled from eq .",
    "( [ f_max ] ) in the compact domain @xmath244\\times[0,4]$ ] .",
    "since @xmath245 is an exact equilibrium solution of the fokker - plack equation , the ensemble of particles will be in statistical equilibrium but it will exhibit fluctuations due to the finite number of particles .",
    "figure  [ wavelets_e ] shows the dependence of the square root of the reconstruction error , @xmath246 ( normalized by @xmath247 ) on the number of particles @xmath2 and the grid resolution @xmath22 for the wbde and pod methods . the main advantage of this example is that the exact density @xmath248 can be used as the reference density @xmath194 in the evaluation of the error .",
    "reconstruction error , @xmath221 , as a function of @xmath124 for the collisional relaxation particle data corresponding to the maxwellian equilibrium state .",
    "bold solid lines correspond to the wbde method , bold dashed lines correspond to the pod method , and thin dashed lines correspond to the histogram method . ]",
    "the previous example focused on collisional dynamics .",
    "however , in addition to collisions , plasma transport involves external and self - consistent electromagnetic fields and it is of interest to test the particle density reconstruction algorithms in these more complicated settings . as a first step on this challenging problem we consider a plasma subject to collisions and an externally applied fixed magnetic field in toroidal geometry .",
    "the choice of the field geometry and structure was motivated by problems of interest to magnetically confined fusion plasmas .",
    "the data was presented and analyzed using pod method in ref .",
    "the phase space of the simulation is five dimensional .",
    "however , as in ref .",
    "@xcite , we limit attention to the denoising of the particles distribution function along two coordinates corresponding to the poloidal angle @xmath249 $ ] and the cosine of the pitch angle @xmath250 $ ] . the remaining three coordinates have been averaged out for the purpose of this study .",
    "the @xmath200 coordinate is periodic , but the pitch coordinate @xmath251 is not .",
    "an important issue to consider is that the data was generated using a @xmath4 code ( delta5d ) .",
    "based on an expansion on @xmath252 ( where @xmath253 is the characteristic larmor radius and @xmath76 a typical equilibrium length scale ) the distribution function is decomposed into a maxwellian part @xmath245 and a first - order perturbation @xmath4 represented as a collection of particles ( markers ) f(*x * ) = _ n w_n ( * x*-*x*_n ) , like in eq .",
    "( [ dirac_estimate ] ) except that each marker is assigned a time dependent weight @xmath254 whose time evolution depends on the maxwellian background @xcite .",
    "the direct use of @xmath255 is problematic in the wbde method because @xmath4 is not a probability density . to circumvent this problem",
    "the wbde method was applied after normalizing the @xmath256 distribution so that @xmath257 , on a @xmath258 grid .",
    "figure  [ fig : d5d_3d_comp ] shows contour plots of the histogram @xmath20 corresponding to @xmath259 , @xmath260 , and @xmath261 along with the wbde and pod reconstructed densities .",
    "the pod reconstructions were done using @xmath262 modes , as in ref .",
    "it is observed that comparatively high levels of smoothness can be achieved with considerably less particles by using either the wbde or pod reconstruction methods .",
    "the wbde method provides better results for the @xmath263 contours .",
    "this is because pod modes are tensor product functions , that have difficulties in approximating the triangular shape of these contour lines .",
    "note that the boundary artifacts due to periodization of the daubechies wavelets do not seem to be very critical .",
    "the large wavelet coefficients associated with the discontinuity between the values of @xmath4 at @xmath264 are not thresholded , so that the discontinuity is preserved in the denoised function .",
    "figure  [ fig : d5d_rms ] compares the reconstruction errors in the wbde , pod , and histogram methods as functions of the number of particles . to evaluate the error we used @xmath20 computed using @xmath265 as the reference density @xmath194 . as in the collisional transport problem ,",
    "the error is reduced roughly by a factor @xmath186 for both methods compared to the raw histogram .",
    "note that the scaling with @xmath2 is slightly better for wbde than for pod .",
    "contour plots of estimates of @xmath7 for the collisional guiding center transport particle data : histogram method ( first row ) , pod method ( second row ) , and wbde method ( third row ) .",
    "the left , center and right columns correspond to @xmath266 ( left ) , @xmath267 ( middle ) and @xmath268 ( right ) respectively .",
    "the plots show seventeen isolines equally spaced within the interval @xmath269 $ ] . ]",
    "error estimate , @xmath221 , for collisional guiding center transport particle data according to the histogram , the pod , and the wavelet methods .",
    ", title=\"fig : \" ]      in this section we apply the wbde and pod methods to reconstruct the single particle distribution function from discrete particle data obtained from pic simulations of a vlasov - poisson plasma .",
    "we consider a one - dimensional , electrostatic , collisionless electron plasma with an ion neutralizing background in a finite size domain with periodic boundary conditions . in the continuum limit the dynamics of the distribution function",
    "is governed by the system of equations @xmath270 where the variables have been non - dimensionalized using the debye length as length scale and the plasma frequency as time scale , and @xmath76 is the length of the system normalized with the debye length . following the standard pic methodology @xcite , we solve the poisson equation on a grid and solve the particle equations using a leap - frog method .",
    "the reconstruction of the charge density uses a triangular shape function .",
    "we consider two initial conditions : the first one leads to a bump on tail instability , and the second one to a two streams instability .      for the bump on tail instability we initialized ensembles of particles by sampling the distribution function @xmath271 using a pseudo - random number generator .",
    "this equilibrium is stable for @xmath272 and unstable for @xmath273 .",
    "the dispersion relation and linear stability analysis for this equilibrium studied in ref .",
    "@xcite was used to benchmark the pic code as shown in fig .",
    "[ pic_validation ] . in all the computations presented here @xmath274 and @xmath275 , @xmath210 and @xmath211 .",
    "the spatial domain size was set to @xmath276 to fit the wavelength of the most unstable mode .",
    "electrostatic energy as a function of time in the vlasov - poisson pic simulations of the bump on tail instability for different numbers of particles .",
    "the straight lines denote the growth rate predicted by linear stability theory @xcite . ]",
    "since the value of @xmath277 is relatively close to the marginal value , the instability grows weakly and is concentrated in a narrow band in phase space centered around the point where the bump is located , @xmath278 in this case . in order to unveil the nontrivial dynamics we focus the analysis in the band @xmath279 , and plot the departure of the particle distribution function from the initial background equilibrium .",
    "the pod method is applied directly to @xmath280 , but the wbde method is applied to the full @xmath281 , and @xmath282 is subtracted only for visualization . note that because we are considering only a subset of phase space , the effective numbers of particles , @xmath283 , @xmath284 and @xmath285 , are smaller than the nominal numbers of particles , @xmath275 , @xmath228 and @xmath197 respectively .",
    "figure  [ bump_tail_snapshots ] shows contour plots of @xmath4 , for different number of particles . since the instability is seeded only by the random fluctuations in the initial condition , increasing @xmath2 delays the onset of the linear stability and this leads to a phase shift of the nonlinear saturated regime . to aid the comparison of the saturated regime for different numbers of particles we have eliminated this phase shift by centering the peak of the particle distributions in the middle of the computational domain .",
    "a @xmath286 grid was used in the wbde method , and a @xmath287 grid was used for the histogram and the pod methods .",
    "the thresholds for the pod method where @xmath288 , @xmath289 , and @xmath262 for @xmath275 , @xmath228 and @xmath197 , respectively . except for the case where @xmath275 , both the pod and wbde estimates are very smooth , in agreement with the expected behavior of @xmath7 for this instability .",
    "it is observed that the level of smoothness of the histogram estimated using @xmath211 particles is comparable to the level of smoothness achieved after denoising using only @xmath210 particles .",
    "one should mention that for scales between @xmath76 and @xmath62 occurring in the wbde algorithm we find that none of the wavelet coefficients are above the thresholds at each scale .",
    "in fact , a simple kde estimate with a large enough smoothing scale would probably do the job pretty well for this kind of instabilities which do not induce abrupt variations in @xmath7 .",
    "table  [ bump_tail_error ] shows the pod and wbde reconstruction errors for @xmath275 and @xmath228 .",
    "the error is computed using formula ( [ error_e0 ] ) , taking for @xmath290 the histogram obtained from the simulation with @xmath197 .",
    "contour plots of estimates of @xmath4 for the bump - on - tail instability pic data at @xmath291 : histogram method ( first row ) , pod method ( second row ) , and wbde method ( third row ) , the left , center and right columns correspond to @xmath275 , @xmath228 and @xmath197 particles respectively .",
    "the plots show thirteen contour lines equally spaced within the interval @xmath292 $ ] . ]",
    "figure  [ pic_moments ] shows the relative error on the second order moment : @xmath293 where @xmath294 is defined by ( [ moments_def ] ) . a similar quantity is also represented for @xmath20 and @xmath220 . the time and number of particles are kept fixed at @xmath291 and @xmath197 , and the grid resolution is varied .",
    "as expected , @xmath20 and @xmath95 conserve the second order moment with accuracy @xmath295 .",
    "the errors corresponding to @xmath220 is of the same order of magnitude but seems to reach a plateau for @xmath296 .",
    "this may be due to the fact that for @xmath297 , there is less than one particle per cell of the histogram used to compute @xmath298 .",
    "relative error on the second order moment as a function of the grid resolution , @xmath22 , in the pod , wbde , and histogram methods for the bump on tail instability particle data at @xmath291 , with @xmath197 particles . ]      as a second example we consider the standard two - streams instability with an initial condition consisting of two counter - propagating cold electron beams initially located at @xmath299 and @xmath300 .",
    "this case is conceptually different to the previous one because the initial condition depends trivially on the velocity .",
    "therefore , there is no statistical error in the sampling of the distribution and the noise builds up only due to the self - consistent interactions between particles . in other words",
    ", there is initially a strong correlation between particles coordinates , which will eventually almost vanish .",
    "this situation offers a way to test robustness of the wbde method with respect to the underlying decorrelation hypothesis .",
    "l*6cr & @xmath275 & @xmath228 + @xmath20 & @xmath301 & @xmath302 + @xmath220 & @xmath303 & @xmath304 + @xmath95 & @xmath305 & @xmath306 +    the analysis is focused on four stages of the instability corresponding to @xmath307 , @xmath308 , @xmath218 , and @xmath309 .",
    "[ two_streams_snapshot ] shows a comparison of the raw histogram , the pod and the wbde reconstructed particle distribution functions at these four instants .",
    "grid sizes were @xmath310 for the wbde estimate , and @xmath311 for the two others .",
    "for @xmath307 , no noise seems to have affected the particle distribution yet , therefore a perfect denoising procedure should conserve the full information about the particle positions . although wbde introduces some artifacts in regions of phase space that should contain no particles at all , it remarkably preserves the global structure of the two streams .",
    "this is possible thanks to the numerous wavelet coefficients close to the sharp features in @xmath7 that are above the thresholds , in contrast to the bump - on - tail case . on the next snapshot at @xmath312 ,",
    "the filaments have overlapped and the system is beginning to loose its memory due to numerical round - off errors .",
    "the fastest filaments still visible on the histogram are not preserved by wbde , but the most active regions are well reproduced . at @xmath313 ,",
    "the closeness between the histogram and the wbde estimate is striking . to put it somewhat subjectively , one may say that wbde did not consider most of the rough features present at this stage as noise , since they are not removed . only with the last snapshot at @xmath314",
    "does the wbde estimate begin to be smoother than the histogram , suggesting that the nonlinear interaction between particles has introduced randomization in the system .",
    "the pod method is able to track very well the small and large scale structures of the particle density using a significantly smaller number of modes . in particular , for @xmath307 , @xmath308 , @xmath218 , and @xmath309 only @xmath315 , @xmath316 , @xmath317 , and @xmath318 modes were kept .",
    "the decrease of the number of modes with time is a result of the lost of fine scale features in the distribution function . despite this , a limitation of the pod method is the lack of a thresholding algorithm to determine the optimal number of modes a priori .",
    "wavelet based density estimation was investigated as a post - processing tool to reduce the noise in the reconstruction of particle distribution functions starting from discrete particle data .",
    "this is a problem of direct relevance to particle - based transport calculations in plasma physics and related fields .",
    "in particular , particle methods present many advantages over continuum methods , but have the potential drawback of introducing noise due to statistical sampling .    in the context of particle in cell methods this problem is typically approached using finite size particles .",
    "however , this approach , which is closely related to the kernel density estimation method in statistics , requires the choice of a smoothing scale , @xmath27 , ( e.g. , the standard deviation for gaussian shape functions ) whose optimal value is not known a priori .",
    "a small @xmath27 is desirable to fit as many debye wavelengths as possible , whereas a large @xmath27 would lead to smoother distributions .",
    "this situation results from the compromise between bias and variance in statistical estimation . to address this problem we proposed a wavelet based density estimation ( wbde ) method that does not require an a priori selection of a global smoothing scale and that its able to adapt locally to the smoothness of the density based on the given discrete data .",
    "the wbde was introduced in statistics @xcite . in this paper",
    "we extended the method to higher dimension and applied it for the first time to particle - based calculations .",
    "the resulting method exploits the multiresolution properties of wavelets , has very weak dependence on adjustable parameters , and relies mostly on the raw data to separate the relevant information from the noise .    as a first example",
    ", we analyzed a plasma collisional relaxation problem modeled by stochastic differential equations .",
    "thanks to the sparsity of the wavelet expansion of the distribution function , we have been able to extract the information out of the statistical fluctuations by nonlinear thresholding of the wavelet coefficients . at late times ,",
    "when the particle distribution approaches a maxwellian state , we have been able to quantify the difference between the denoised particle distribution function and its analytical counterpart , thus demonstrating the improvement with respect to the raw histogram .",
    "the pod - smoothed and wavelet - smoothed particle distribution functions were shown to be roughly equivalent in this respect .",
    "these results were then extended to a more complex situation simulated with a @xmath4 code .",
    "finally , we have turned to the vlasov - poisson problem , which includes interactions between particles via the self - consistent electric field .",
    "the pod and wbde methods were shown to yield quantitatively close results in terms of mean squared error for a particle distribution function resulting from nonlinear saturation after occurrence of a bump - on - tail instability .",
    "we have then studied the denoising algorithm during nonlinear evolution after the two - streams instability starting from two counter - streaming cold electron beams .",
    "this initial condition violates the decorrelation hypothesis underlying the wbde algorithm , and thus offers a good way to test its robustness regarding this aspect .",
    "the wbde method was shown to yield qualitatively good results without changing the threshold values .",
    "one limitation of the present work comes from the way denoising quality is measured .",
    "we have considered the quadratic error on the distribution function @xmath7 as a first indicator of the quality of our denoising methods .",
    "however , it may be more relevant to compute the error on the force fields , which determine the evolution of the simulated plasma .",
    "these forces depend on @xmath7 through integrals , and statistical analysis of the estimation of @xmath7 using weak norms , like was done in @xcite in the deterministic case , could therefore be of great help to obtain threshold parameters more efficient than those considered in this study .",
    "the computational cost of our method scales linearly with the number of particles and with the grid resolution .",
    "therefore , wbde is an excellent candidate to be performed at each time step during the course of a simulation .",
    "once the wavelet expansion of the denoised particle distribution function is known , it is possible to continue using the wavelet representation to solve the poisson equation @xcite and to compute the forces .",
    "the moment conservation properties that we have demonstrated in this paper should mitigate the unavoidable dissipative effects implied by the smoothing stage . in ref .",
    "@xcite , a dissipative term was introduced in a global pic code to avoid unlimited growth of particle weights in @xmath4 codes , and this was shown to improve long time convergence of the simulations .",
    "it would be of interest to assess if the nonlinear dissipation operator corresponding to wbde has the same effect .",
    "we thank d. spong for providing the delta5d monte - carlo guiding center simulation data in fig.6 , originally published in ref .",
    "we also thank xavier garbet for his comments on the paper and for pointing out several key references .",
    "mf and ks acknowledge financial support by anr under contract m2tfp , mthodes multichelles pour la turbulence dans les fluides et les plasmas .",
    "dcn and gch acknowledge support from the oak ridge national laboratory , managed by ut - battelle , llc , for the u.s .",
    "department of energy under contract de - ac05 - 00or22725 .",
    "dcn also gratefully acknowledges the support and hospitality of the cole centrale de marseille for the three , one month visiting positions during the elaboration of this work .",
    "this work , supported by the european communities under the contract of association between euratom , cea and the french research federation for fusion studies , was carried out within the framework of the european fusion development agreement .",
    "the views and opinions expressed herein do not necessarily reflect those of the european commission ."
  ],
  "abstract_text": [
    "<S> for given computational resources , the accuracy of plasma simulations using particles is mainly held back by the noise due to limited statistical sampling in the reconstruction of the particle distribution function . a method based on wavelet analysis </S>",
    "<S> is proposed and tested to reduce this noise . </S>",
    "<S> the method , known as wavelet based density estimation ( wbde ) , was previously introduced in the statistical literature to estimate probability densities given a finite number of independent measurements . </S>",
    "<S> its novel application to plasma simulations can be viewed as a natural extension of the finite size particles ( fsp ) approach , with the advantage of estimating more accurately distribution functions that have localized sharp features . </S>",
    "<S> the proposed method preserves the moments of the particle distribution function to a good level of accuracy , has no constraints on the dimensionality of the system , does not require an a priori selection of a global smoothing scale , and its able to adapt locally to the smoothness of the density based on the given discrete particle data . </S>",
    "<S> most importantly , the computational cost of the denoising stage is of the same order as one time step of a fsp simulation . </S>",
    "<S> the method is compared with a recently proposed proper orthogonal decomposition based method , and it is tested with three particle data sets that involve different levels of collisionality and interaction with external and self - consistent fields . </S>"
  ]
}