{
  "article_text": [
    "variational and diffusion quantum monte carlo ( vmc and dmc ) are stochastic quantum monte carlo ( qmc ) methods for evaluating expectation values with many - body wave functions @xcite .",
    "the accuracy of vmc is quite limited in practice , but its more accurate and sophisticated cousin the dmc method is capable of giving very accurate results , often retrieving over 90% of the correlation energy .",
    "the computational costs of fermion vmc and dmc calculations scale approximately as the third power of the number of particles , making it feasible to deal with hundreds or even thousands of particles and allowing applications to electrons in condensed matter .",
    "dmc has been applied to a wide variety of condensed matter systems , including electron gases @xcite , nanocrystals @xcite , molecules on solid surfaces @xcite , defects in semiconductors @xcite , solid state structural phase transitions @xcite , and equations of state @xcite .",
    "dmc calculations have provided accurate benchmark results for many systems .",
    "qmc algorithms are intrinsically parallel and are ideal candidates for utilising the petascale computers which are now becoming available .",
    "our casino code @xcite has already achieved efficient parallelisation on machines with thousands of processors .",
    "calculating energy derivatives such as atomic forces is very important in quantum mechanical simulations .",
    "forces are used in relaxing structures , calculating their vibrational properties , and performing molecular dynamics simulations .",
    "it has , however , proved difficult to develop accurate and efficient methods for calculating atomic forces within dmc .",
    "difficulties have arisen in obtaining accurate expressions which can readily be evaluated , and the statistical properties of the force expressions are less advantageous than those for the energy . in this paper",
    "we study approaches for calculating derivatives directly within qmc .",
    "finite - difference energy calculations within qmc using correlated sampling methods @xcite provide a different route to the same goal , and such methods have been developed by other workers @xcite .",
    "in vmc the energy is calculated as the expectation value of the hamiltonian with an approximate many - body trial wave function @xmath0 . for a real @xmath0",
    "the energy is @xmath1 where @xmath2 is the many - body hamiltonian and @xmath3 denotes the vector of particle coordinates . to facilitate stochastic evaluation ,",
    "@xmath4 is written as @xmath5 where the the local energy is @xmath6 the calculation proceeds by the generation of @xmath7 configurations @xmath8 sampled from the probability distribution @xmath9 using , for example , the metropolis algorithm , and the energy is evaluated as @xmath10    equation ( [ eq : variational_energy_2 ] ) with the @xmath11 of equation ( [ eq : vmc distribution ] ) is an importance sampling transformation of equation ( [ eq : variational_energy ] ) which exhibits the _",
    "zero variance property_. as @xmath0 approaches an exact eigenfunction , @xmath12 becomes a smoother function of @xmath3 and the number of configurations , @xmath7 , required to achieve an accurate estimate of @xmath4 is reduced .",
    "if @xmath0 is exact , equation  ( [ eq : variational_energy_2 ] ) gives the exact result even for a single configuration .",
    "although this ideal limit can not be reached in non - trivial calculations , it is expected that using a zero - variance estimator will lead to improved statistics .",
    "dmc reduces the systematic bias inherent in vmc by an evolution of the wave function in imaginary time .",
    "such projector methods suffer from the infamous `` fermion sign problem '' in which the wave function decays rapidly towards the lower energy bosonic ground state .",
    "stable fermionic behaviour may , however , be achieved by using the `` fixed - node approximation '' @xcite in which the nodal surface of the dmc wave function @xmath13 is constrained to equal that of @xmath0 .",
    "an importance sampling transformation is also used and the algorithm generates configurations distributed according to the `` mixed '' probability distribution , @xmath14 the dmc energy is given by @xmath15 which is evaluated as @xmath16 both the vmc and dmc energies are upper bounds on the exact ground state energy .",
    "the dmc energy is , however , more accurate as it is bounded from above by the vmc energy .",
    "we also calculate expectation values with the pure probability distribution , @xmath17 pure expectation values can be obtained using several methods : the approximate ( but often very accurate ) extrapolation technique @xcite , the future - walking technique @xcite which is formally exact but statistically badly behaved for large systems and poor trial wave functions , and the reptation qmc technique @xcite , which is formally exact and well behaved , but quite expensive .",
    "the extrapolation technique can be used for any operator , but the future - walking and reptation techniques are limited to spatially local operators .",
    "the derivative of the vmc energy of equation ( [ eq : variational_energy_2 ] ) with respect to a parameter @xmath18 in the hamiltonian can be written as @xmath19 \\ , d{\\bf r } } }   { \\displaystyle{\\int \\psi_{\\rm t }   \\psi_{\\rm t } \\ , d{\\bf r } } } \\nonumber   \\\\   & & + 2 \\frac{\\displaystyle{\\int \\psi_{\\rm t }   \\psi_{\\rm t } \\ , \\frac { ( e_{\\rm l}-e_{\\rm v } ) } { \\psi_{\\rm t } } \\ ,   \\frac{{\\rm d}\\psi_{\\rm t}}{{\\rm d}\\lambda } \\ , d{\\bf r}}}{\\displaystyle{\\int \\psi_{\\rm t }   \\psi_{\\rm t } \\ , d{\\bf r } } } \\;,\\end{aligned}\\ ] ] this expression may be evaluated as an average over the probability distribution @xmath11 of equation ( [ eq : vmc distribution ] ) .",
    "the term involving @xmath20 is the hellmann - feynman force and the others are pulay terms which contain the derivative of @xmath0 with respect to the parameter in the hamiltonian . calculating vmc forces including the pulay terms",
    "is straightforward , although it requires the evaluation of @xmath21 .    equation ( [ eq : vmc force ] ) can be written in a number of different ways which are equivalent when the expectation values are evaluated exactly .",
    "the particular form chosen satisfies the zero variance condition if the configurations are sampled from @xmath11 and @xmath2 and @xmath22 are taken to act to the right . if @xmath0 and @xmath23 were exact , the exact force would be obtained from averaging over any number of configurations .",
    "it is expected that this property will reduce the statistical noise in practical calculations .",
    "equation ( [ eq : vmc force ] ) has been used by a number of groups to evaluate forces within vmc @xcite .",
    "the derivative of the dmc energy of equation ( [ eq : diffusion_energy 1 ] ) can be written as @xmath24 this expression includes the derivative of the dmc wave function @xmath25 which can not be evaluated within the standard approach .",
    "a number of studies have used equation  ( [ eq : mixed dmc force ] ) with the approximation @xcite @xmath26 which leads to an expression which is no more difficult to evaluate than the vmc one of equation ( [ eq : vmc force ] ) .",
    "this approach gives reasonable results if @xmath0 and @xmath21 are accurate enough , but it leads to errors of first order in @xmath27 and @xmath28 , which are often significant in practice .    an alternative approach is to evaluate the forces using the pure distribution @xmath29 of equation ( [ eq : pure distribution ] ) , which is proportional to @xmath30 .",
    "it is more expensive to generate configurations distributed according to the pure distribution than the mixed one , but it brings significant advantages because less severe approximations are required in evaluating the forces .",
    "the energies evaluated with the mixed and pure distributions are equal , i.e. , @xmath31 so that the dmc force evaluated with the pure distribution is @xmath32    it turns out that the pulay term in this expression can be written as an integral over the nodal surface of @xmath0 @xcite .",
    "this fact was first pointed out by huang _",
    "et al _ @xcite , and schautz and flad @xcite provided an exact expression for the pulay term , @xmath33 where @xmath34 denotes the nodal surface and @xmath35 is the gradient of @xmath13 obtained on approaching the nodal surface from inside the nodal pocket along the direction normal to the surface . unfortunately this expression can not readily be evaluated because it involves ( @xmath36 ) an integral over the nodal surface and ( @xmath37 ) the quantity @xmath38 .",
    "one of the achievements of badinski _ et al _ @xcite was to show that @xmath38 can be eliminated from equation ( [ nodal term 1 ] ) because the nodal surfaces of @xmath13 and @xmath0 must be equal for all values of the parameter in the hamiltonian .",
    "they obtained the result @xmath39 which is the average over the pure distribution of a quantity written entirely in terms of @xmath0 .",
    "the difficulty of evaluating an integral over the nodal surface remains and badinski _ et al _ @xcite attempted to circumvent this problem by writing the nodal surface integral as a volume integral .",
    "they noted that the second term on the right hand side of equation ( [ eq : mixed dmc force ] ) can also be written as a nodal surface integral , and that it is related to the pure distribution nodal term of equations ( [ nodal term 1 ] ) and ( [ nodal term 2 ] ) by an extrapolation approximation .",
    "the standard extrapolation approximation is @xmath40 \\;,\\end{aligned}\\ ] ] where @xmath41 is a hermitian operator .",
    "this expression can be obtained by taylor expansion in @xmath27 .",
    "application of equation ( [ extrapolation 1 ] ) to the nodal term of equation ( [ nodal term 2 ] ) gives @xmath42 \\;.",
    "\\label{extrapolation 2}\\end{aligned}\\ ] ] it is straightforward to show that the variational term in equation ( [ extrapolation 2 ] ) is zero because @xmath0 is continuous and differentiable across the nodal surface @xcite .",
    "the mixed - distribution term on the right hand side of equation ( [ extrapolation 2 ] ) is , moreover , exactly equal to twice the second term on the right hand side of equation ( [ eq : mixed dmc force ] ) @xcite , and therefore @xmath43 \\;.\\end{aligned}\\ ] ] the mixed - distribution term on the right hand side of equation ( [ extrapolation 3 ] ) may be evaluated straightforwardly if @xmath2 is taken to act to the right .",
    "next we apply the extrapolation procedure again to eliminate the mixed distribution term in equation ( [ extrapolation 3 ] ) , which leads to @xmath44 \\;.\\end{aligned}\\ ] ] using equations ( [ eq : pure dmc force ] ) , ( [ nodal term 2 ] ) , and ( [ extrapolation 4 ] ) with @xmath2 acting to the left in the variational term , we obtain our final expression for the energy derivative @xcite @xmath45 \\ , d{\\bf r } } } { { \\displaystyle \\int \\phi \\phi \\ , d{\\bf r } } } \\nonumber \\\\ & & + \\frac { { \\displaystyle \\int \\psi_{\\rm t } \\psi_{\\rm t } \\ , \\frac{(e_{\\rm l}-e_{\\rm d})}{\\psi_{\\rm t } } \\frac{{\\rm d}\\psi_{\\rm t}}{{\\rm d}\\lambda } \\ , d{\\bf r } } } { { \\displaystyle \\int \\psi_{\\rm t } \\psi_{\\rm t } \\ , d{\\bf r } } }    + { \\cal{o}}[(\\psi_{\\rm t}-\\phi)^2 ] \\;. \\label{final pure force}\\end{aligned}\\ ] ] equation ( [ final pure force ] ) consists of integrals over the pure and variational distributions .",
    "this expression is expected to give much more accurate forces than equation ( [ eq : mixed dmc force ] ) with the approximation ( [ eq : reynolds approximation ] ) because ( @xmath36 ) the pulay terms with the pure distribution are smaller than those obtained with the mixed distribution , and ( @xmath37 ) the error is of second order rather than first order .",
    "equation ( [ final pure force ] ) is expected to show reasonable statistical behaviour because it satisfies a zero - variance principle .",
    "if @xmath0 and @xmath46 are exact , the pure distribution term in equation ( [ final pure force ] ) gives the exact result even for a single configuration , and the variational term has the same property and , in addition , gives zero if @xmath0 is exact .",
    "if the nodal surface of @xmath0 is independent of the variable parameter in the hamiltonian then only the hellmann - feynman term survives in equation ( [ final pure force ] ) .",
    "the fixed - node approximation is equivalent to placing infinite potential barriers everywhere on the nodal surface of @xmath0 .",
    "the nodal surface term can be viewed as arising from the change in the potential barriers as the variable parameter changes .",
    "alternatively , one can include the infinite potential barriers in the hamiltonian , formulating a fixed - node hamiltonian @xmath47 @xcite .",
    "the hellmann - feynman theorem holds for @xmath47 , but @xmath47 depends on the nodal surface of @xmath0 and the derivative @xmath48 generates the same pulay terms as in the approach described above .",
    "we assume that the trial wave function @xmath49 ( and hence the nodal surface ) depends on @xmath50 variational parameters @xmath51 , with @xmath52 .",
    "we further assume that @xmath49 has both explicit and implicit dependence on the parameter @xmath18 in the hamiltonian we wish to vary .",
    "for example , the atomic centres of a localised basis set or the jastrow factor may have explicit dependence on the positions of the atoms , and they may contain variable parameters whose optimal values depend implicitly on the atomic positions . the total force calculated with the variational , mixed or pure distributions can be written as @xmath53 where @xmath54 for vmc and @xmath55 for the mixed and pure dmc distributions .",
    "the two terms on the right hand side of equation ( [ eq : f : f_total_partial ] ) correspond to the explicit and implicit dependences on @xmath18 .",
    "the choice of these dependences is not unique and may depend on how the parameters are considered in a qmc simulation .",
    "it is possible to construct @xmath49 without variational parameters if the values of all of the parameters @xmath51 are kept fixed .",
    "also , @xmath49 can be constructed so that it has no explicit dependence on the nuclear coordinates when , for example , the centres of atomic - centred basis sets are made variational parameters  @xcite .",
    "for qmc calculations it is , however , convenient to choose forms of @xmath49 where both explicit and implicit dependences on @xmath18 are present .    calculating the force using equation ( [ eq : f : f_total_partial ] )",
    "involves knowledge of how the wave function and hence the @xmath51 change with @xmath18 , i.e. , @xmath56 . in standard quantum chemistry methods ,",
    "these derivatives are typically obtained by second - order perturbation theory  @xcite .",
    "unfortunately such an approach is not straightforward in vmc and dmc .",
    "we follow a different route and approximate all total derivatives by partial derivatives or , equivalently , the term involving the sum in equation ( [ eq : f : f_total_partial ] ) is neglected .",
    "this approximation introduces an error in the force of first order in @xmath57 .",
    "we expect this approximation to be rather accurate in both vmc and dmc for the following reasons . in vmc",
    "each term in the sum vanishes if @xmath58 is energy - minimized with respect to the corresponding @xmath51 , i.e. , @xmath59  @xcite . in practice this condition will not normally be satisfied exactly because @xmath60 the @xmath51 are obtained by stochastic methods and are therefore subject to statistical noise , @xmath61 the @xmath51 are sometimes obtained by minimizing the variance of the local energy rather than the energy itself , @xmath62 the orbital parameters are often obtained from density - functional theory calculations and are therefore energy minimised with respect to the wrong hamiltonian .",
    "similar considerations apply within dmc , and we expect that @xmath58 is approximately minimized with respect to the @xmath51 so that the @xmath63 are very small . the terms in the sum in equation ( [ eq : f : f_total_partial ] ) are therefore expected to be very small and can be neglected .",
    "before presenting some results , it is worth discussing the accuracy we require of qmc forces for them to be useful .",
    "it is helpful to think about the error in the force on an atom in a molecule or solid in terms of the associated error in the bond length .",
    "the errors in equilibrium bond lengths obtained from well - converged density functional theory ( dft ) calculations for @xmath64-bonded atoms are @xmath65 0.01 , where `` exp '' denotes the experimental value . to be useful ,",
    "the errors in dmc bond lengths measured as the difference between the values obtained from the forces and energies @xmath66 should be substantially smaller than @xmath670.01 .",
    "we illustrate the results obtained for the mixed and pure dmc force estimates with calculations on the sih molecule .",
    "it should be noted that we have calculated the forces on both the si and h atoms , which should of course be of equal magnitude and opposite sign .",
    "this is in fact a highly non - trivial test of the computational method as the condition of zero net force on the molecule is not automatically satisfied in these calculations .",
    "it is easier to obtain accurate trial wave functions for h atoms than for heavier atoms and therefore the forces on the h atoms tend to be more accurate .",
    "a number of other dmc studies have calculated forces on small molecules containing h atoms in which the bond lengths were deduced entirely from the forces on the h atoms .",
    "we do not regard this procedure as a proper test of the methodology .    in our calculations we used dirac - fock based non - local pseudopotentials to represent the h@xmath68 and si@xmath69 ions @xcite .",
    "the hellmann - feynman contributions to the forces from the non - local pseudopotentials were calculated using the expressions given in the appendix of ref .",
    "the pseudopotential localisation procedure @xcite introduces additional terms in the force which contain @xmath46 @xcite .",
    "these terms arise from the derivative of the hamiltonian and therefore we have included them in the hft expression for the forces in the following discussion .",
    "the trial wave functions were constructed as follows .",
    "we calculated the molecular orbitals within hartree - fock theory using the gamess code @xcite with a fairly small basis set consisting of 5@xmath70 and 2@xmath71 gaussian basis functions for each atom .",
    "we used a jastrow factor which included electron - electron and electron - ion terms @xcite .",
    "the initial values of the jastrow parameters were obtained by minimising the variance of the energy @xcite and they were further refined by minimising the vmc energy @xcite .",
    "we could have generated considerably more accurate trial wave functions by using a larger gaussian basis set , a more complicated form of jastrow factor , including several determinants , or backflow transformations @xcite .",
    "we chose not to do this because we wanted to work with trial wave functions of a similar quality to those we could readily generate for heavier atoms and much larger systems .",
    "when evaluating @xmath21 we included only the explicit dependence on the ionic positions which occurs in the jastrow factor and gaussian basis functions .",
    "expectation values with the pure distribution were evaluated using the future - walking method @xcite .    ) and the total force ( @xmath72 ) evaluated for the h and si atoms .",
    "the derivative of the morse potential fitted to the dmc energies ( @xmath73 ) is shown as reference . ]",
    "results using the mixed distribution expression of equation ( [ eq : mixed dmc force ] ) with the approximation of ( [ eq : reynolds approximation ] ) are plotted in figure [ fig : mixed ] . as reference",
    ", we have also plotted the derivative of the morse potential previously obtained from a fit to the dmc energies .",
    "the minimum in the dmc energy occurs at a bond length of 1.5242(6) .",
    "the forces on the h and si atoms should be equal and opposite , and figure [ fig : mixed ] shows that the total forces @xmath72 on the h and si atoms sum almost to zero over the range of bond lengths shown , with an error corresponding to an error in the bond length of equal or less than 0.001 .",
    "however , the total force gives an equilibrium bond length which is about 0.010  too short .",
    "the hellmann - feynman force @xmath74 on the h atom is zero at a bond length which is 0.003(1)  too long , while that on the si atom is zero at a bond length which is 0.020(1)  too short .",
    "including the pulay terms improves the agreement between the forces calculated on the h and si atoms , but overall the bond lengths from the mixed - estimator forces are no better than those which could be obtained in dft calculations .    , but for the pure forces evaluated using equation ( [ final pure force ] ) . ]",
    "results using equation ( [ final pure force ] ) are plotted in figure [ fig : pure ] .",
    "we refer to this as the expression for the pure forces , although it also contains a term evaluated with the variational distribution .",
    "the total pure forces @xmath75 on the h and si atoms sum almost to zero over the range of bond lengths shown , with an error corresponding to an error in the bond length of less than 0.003 , which is about three times the statistical error .",
    "the equilibrium bond lengths from the zero force condition are also within statistical errors of the equilibrium bond length obtained from the minimum in the dmc energy .",
    "the nodal terms in equation ( [ final pure force ] ) are by no means negligible .",
    "the pure hellmann - feynman forces @xmath76 on the h and si atoms do not sum to zero , and the force on the h atom is zero at a bond length which is 0.008(1)  too long , while the force on the si atom is zero at a bond length which is 0.010(2)  too long .",
    "the total pure forces are much more accurate than the total mixed forces , which suggests that the approximate forms of equation ( [ final pure force ] ) and @xmath46 give rather accurate results in our simulations .",
    "the bond lengths obtained from the total forces and from the hft term , and using forces on the si and h atoms , within mixed and pure dmc , are summarised in table [ tab : bond lengths ] .",
    "it is clear that the total pure forces give equilibrium bond lengths differing from that obtained from the dmc energies by much less than the typical error in dft bond lengths of @xmath670.01 .",
    ".equilibrium bond lengths @xmath77 in   for the sih molecule obtained from the total forces and from the hft term and using forces on the si and h atoms , within mixed and pure dmc .",
    "the equilibrium bond length obtained from the minimum in the dmc energy curve is 1.5242(6) . [ cols=\"<,<,<,<\",options=\"header \" , ]",
    "a statistical estimate of a quantity should be accompanied by a confidence interval which indicates the reliability of the estimate .",
    "consider a probability distribution function ( pdf ) @xmath78 which has a mean value @xmath79 and variance @xmath80 .",
    "the mean value of a random variable @xmath81 drawn from @xmath78 may be estimated using the sample mean , @xmath82 and the variance estimated using the sample variance , @xmath83 we then say that @xmath84 lies within the interval @xmath85 $ ] with a confidence of 68% .",
    "this statement relies upon the probability distribution satisfying certain conditions which are the content of the law of large numbers ( lln ) and the central limit theorem ( clt ) .",
    "the lln concerns the statistical convergence of the sum in equation ( [ mean ] ) to the true mean value with increasing @xmath7 .",
    "similarly , the clt concerns the statistical convergence with increasing @xmath7 of the probability distribution from which @xmath84 is drawn to a normal distribution with mean @xmath86 and variance @xmath87 . for the lln to be valid",
    "it is sufficient that the first moment of @xmath78 exists , which requires that @xmath78 decays faster than @xmath88 , where @xmath89 is a constant .",
    "similarly , the clt is valid if the second moment of @xmath78 exists , which requires that @xmath78 decays faster than @xmath90 .    equations ( [ eq : variational_energy_3 ] ) and ( [ eq : diffusion_energy 2 ] ) show that the vmc and dmc energies are evaluated as averages of local energies @xmath91 . the probability distribution of the local energies @xmath92 is generally non - gaussian and has `` fat tails '' .",
    "the asymptotic behaviour of @xmath92 is determined by the singularities in @xmath12 .",
    "trail @xcite considered singularities in @xmath12 arising from a coulomb energy divergence at particle coalescences , divergences in the local kinetic energy at the nodal surface of @xmath0 , and in finite systems where @xmath0 has the wrong asymptotic behaviour . the coulomb energy divergence at particle coalescences",
    "can be removed by imposing the kato cusp conditions on @xmath0 , as is normally done in qmc calculations , but it is not clear how to remove the divergences at the nodal surface .",
    "trail @xcite showed that the singularities in @xmath12 lead to tails in @xmath92 which decay as @xmath93 , where @xmath94 is a constant .",
    "consequently the energy estimate is drawn from a normal distribution whose variance we may estimate ( in the limit of large @xmath7 ) .",
    "however , the estimated variance of the local energy is drawn from a distribution of infinite variance that is not normal , hence it is not entirely clear how to obtain a meaningful confidence interval for this estimate .",
    "a similar analysis can be performed for the forces .",
    "each term in the force can be written as a sum of local contributions , @xmath95 for the hellmann - feynman term we distinguish between three cases : an all - electron atom , a smooth local pseudopotential , and a smooth non - local pseudopotential .",
    "the probability distribution of the hellmann - feynman term for an all - electron atom has slowly decaying tails of the form @xmath96 , where @xmath97 is a constant . in this case",
    "the lln applies but the clt is not satisfied , and the variance of the hellmann - feynman force is infinite .",
    "although a sample variance can be calculated it does not statistically converge to a constant value with increasing @xmath7 , and it is not related to the width of the distribution from which the estimated force is drawn .",
    "the infinite variance in the hellmann - feynman force for an all - electron atom has long been recognised and methods for dealing with it have been devised .",
    "assaraf and caffarel @xcite suggested adding a term to the hft force which has zero mean but may greatly reduce the sample variance .",
    "( this amounts to adding the term containing @xmath46 in the first term on the right hand side of equations ( [ eq : vmc force ] ) and ( [ final pure force ] ) . )",
    "a similar approach was developed by per _",
    "et al _ @xcite .",
    "et al _ @xcite developed a method to filter out the component of the electronic charge density responsible for the infinite variance . using smooth local or non - local pseudopotentials without singularities at the nucleus",
    "also eliminates the infinite - variance problem arising from the electron - nucleus interaction .",
    "the terms in the force estimators which contain @xmath46 also give probability distributions with @xmath96 tails , and hence the clt is not applicable .",
    "the origin of the problem is that although @xmath0 is zero on the nodal surface , @xmath46 is normally finite .",
    "trail @xcite and attaccalite and sorella @xcite have devised rigorous methods within vmc to eliminate the infinite variance by altering the probability distribution near the nodes .",
    "the upper and lower graphs show the same data on different scales . ]",
    "figure [ probability distribution forces ] shows probability distributions for vmc local forces on the ge atom in a geh molecule .",
    "the upper graph shows that the probability distribution for the sum of the local hellmann - feynman force ( the term in equation ( [ eq : vmc force ] ) containing @xmath98 ) and the local zero - variance force ( the term in equation ( [ eq : vmc force ] ) containing @xmath2 ) is much more strongly peaked in the region of the mean value than the local hellmann - feynman force itself .",
    "this illustrates the operation of the zero - variance term .",
    "the lower graphs show the same data plotted on different scales .",
    "the inset graph shows a very wide scale of local forces , and the local zero - variance force actually has more outlying contributions than the local hellmann - feynman force .",
    "this illustrates the result that the probability distribution of the local hellmann - feynman force has @xmath99 tails ( for a smooth pseudopotential ) and the clt holds , while the probability distribution of the local zero - variance force has @xmath96 tails so that the clt is not satisfied .",
    "this seems somewhat counterintuitive ; without the zero - variance term the variance is finite but does not approach zero when @xmath100 are exact whereas , if we include the zero - variance term , the variance is zero for the exact case , but infinite for the approximate case .",
    "analogous results apply for the dmc forces obtained with the mixed and pure distributions .",
    "currently no rigorous procedure has been demonstrated for removing the infinite variance which arises in dmc calculations of the pulay forces .",
    "although this state of affairs is unsatisfactory , the probability distribution of the local forces is strongly peaked in the region of the true value , which suggests that reasonable procedures for estimating a confidence interval can be devised .",
    "we have formulated dmc forces evaluated with the pure distribution .",
    "the force can be written as the sum of a hellmann - feynman force and a term which can be cast as an integral over the nodal surface .",
    "the nodal term can be recast as an average over the pure distribution of a quantity which depends only on @xmath0 and @xmath101 .",
    "it is obvious that such an exact expression must exist , as @xmath0 and @xmath102 fix both the nodal surface and its first order variation , which in turn fix the dmc energy and its first derivative .",
    "it is however , very awkward to evaluate an integral over the nodal surface , and therefore we have adopted an approximate approach to evaluating it which has an error of order @xmath103 . our final expression ( [ final pure force ] )",
    "consists of integrals over the pure and variational distributions , both of which exhibit a zero variance property .",
    "the forces evaluated using equation ( [ final pure force ] ) yield bond lengths for the sih molecule with an error ( with respect to dmc energy calculations ) of much less than 0.01 , which is acceptable for most purposes . of course , before claiming that the problem of calculating dmc forces is `` solved '' , accurate results for heavier atoms and larger systems are required . to this",
    "we should add the issues of efficient generation of the pure probability distribution for large systems , overcoming the `` infinite variance '' described in section [ sec : statistical properties ] , obtaining accurate forms for @xmath0 and @xmath102 , and ( hopefully ) removing the second approximation in equation ( [ final pure force ] ) .",
    "notwithstanding these caveats , we believe that substantial progress has been made in calculating dmc forces , and that their evaluation will become routine in the not - too - distant future .",
    "this work has been supported by the engineering and physical sciences research council ( epsrc ) , uk .",
    "pdh was supported by a royal society university research fellowship .",
    "computing resources were provided by the cambridge high performance computing service ."
  ],
  "abstract_text": [
    "<S> atomic force calculations within the variational and diffusion quantum monte carlo ( vmc and dmc ) methods are described . </S>",
    "<S> the advantages of calculating dmc forces with the `` pure '' rather than the `` mixed '' probability distribution are discussed . an accurate and practical method for calculating forces using the pure distribution </S>",
    "<S> is presented and tested for the sih molecule . </S>",
    "<S> the statistics of force estimators are explored and violations of the central limit theorem are found in some cases . </S>"
  ]
}