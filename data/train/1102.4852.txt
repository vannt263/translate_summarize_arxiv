{
  "article_text": [
    "as originally laid out by @xcite , failing to obey the @xmath0 constraint in magnetohydrodynamics may lead to numerical instability and unphysical results .",
    "this issue has been an issue which has attracted much attention in computational astrophysics ( ex : @xcite ) . to elucidate what @xmath0 means ,",
    "specifying the manner in which @xmath1 is represented is essential . in a numerical method ,",
    "the vector fields are represented by a discrete set of values .",
    "two classes of discretizations are popular in astrophysical applications , finite - volume and point values .",
    "finite volume discretizations store the volume - average of the field over some cell .",
    "these volume averages constrain the possible divergence of a vector field interpolating these values , and hence the constrained transport method @xcite can be applied to conserve this divergence throughout the simulation . however ,",
    "when the magnetic field is represented by point values , the divergence of the interpolated field is not constrained by the point values , so some extra freedom exists .",
    "two classes of approaches have been used .",
    "the first class is to admit @xmath2 errors , and then attempt to manage the consequences .",
    "methods of this type include the 8-wave scheme @xcite , and diffusion method @xcite .",
    "the smoothed particle hydrodynamics schemes of @xcite and @xcite also fall into this class , as the former uses a formulation of the mhd equations which is consistent even in @xmath2 , and the latter removes the @xmath2 contributions to the momentum equation .",
    "the second class of methods constrain the derivatives of the interpolated field .",
    "the projection method , used in finite - difference @xcite , and pseudo - spectral methods , constructs an interpolation of the magnetic field and then modifies the point values so that with the given interpolation scheme they produce a divergence - free continuous field .",
    "it is also possible to store and evolve point values of the magnetic vector potential , interpolate this vector potential , and find a value and derivatives of the magnetic field from this interpolation .",
    "this approach is used in the pencil code .",
    "the vector potential approach always yields a magnetic field which is @xmath0 .",
    "some of the disadvantages of this method are that it has the property that more than one vector potential configuration leads to the same magnetic field configuration , boundary conditions may be difficult to arrange , and compared to evolving @xmath1 directly an extra level of spatial derivatives needs to be evaluated .",
    "the smoothed particle method ( sph ) attempts at mhd are notable in that sph is a non - polynomial method used for approximating derivatives . in this context , in addition to the aforementioned methods following the strategy of admitting @xmath2 , a method based on the euler angles formulation have been proposed by @xcite which by construction yields @xmath0 , but @xcite has observed that this approach is not sufficient for realistic mhd as it severely constrains the allowed magnetic field geometries .",
    "additionally , @xcite explored the use of the vector potential strategy in sph , but found it to be unworkable .    in this paper",
    ", we describe a principle that if adhered to allows point - value methods to evolve the magnetic field directly , while maintaining formally @xmath0 .",
    "although throughout this paper we refer to magnetic fields , the principles and methods can apply to any vector field .",
    "since the discrete point values of the magnetic field do not have a defined derivative , the problem of @xmath0 lies entirely in the method used to produce the continuous representation of the magnetic field from which derivatives are taken .",
    "thus , to produce a @xmath0 method , it is sufficient to define an interpolation ( or quasi - interpolation ) which is restricted to producing only @xmath0 fields .",
    "a concrete example of such a method is provided by divergence - free matrix valued radial basis function interpolation @xcite .",
    "the following two sections of this paper are devoted to a summary of this technique , and its use to construct finite - difference like operators .    radial basis function ( rbf ) interpolation is an alternate method to polynomial basis interpolation for constructing functions which interpolate some discrete set of values . instead of using a set of functions with a different polynomial form",
    "all mentored at the same place ( a taylor series ) , rbf uses shifted versions of a one - parameter function .",
    "further , these functions are shifted to be centred on each interpolating point . for a set of scalar valued samples @xmath3 where @xmath4 is the position of each point and",
    "@xmath5 is the value of the scalar field to be interpolated at that point , the rbf interpolant is of the form @xmath6 where @xmath7 is the interpolant , @xmath8 is a radial basis function , and @xmath9 are a set of coefficients .",
    "these coefficients @xmath10 are such that @xmath11 solving for these coefficients is done by solving the equation @xmath12 where the matrix entries @xmath13 .",
    "the remarkable ability of rbf interpolation is that if @xmath8 has certain properties , this equation has a unique solution for any set of points @xmath14 in any number of dimensions .",
    "the reader is encouraged to refer to @xcite and @xcite for the mathematical details of the theory of radial basis function interpolation .    beyond scalar fields ,",
    "it is possible to construct a rbf interpolation for a vector field such as the magnetic field .",
    "if the rbf is chosen appropriately , this interpolation can be constrained to produce @xmath0 .",
    "given a set of point values @xmath15 where @xmath4 is the position of each point and @xmath16 is the value of the vector field to be interpolated at that point , the interpolation is constructed in the form @xmath17 where @xmath18 are such that @xmath19 the matrix valued radial basis function @xmath20 is constructed by @xmath21 where @xmath8 is a scalar valued radial basis function and @xmath22 is an identity matrix . if a numerical method is built using this representation for the magnetic fields , then the results will be free of @xmath2 errors .",
    "this use of a @xmath0 interpolation basis is a general principle , it could apply to other classes of basis , and spectral basis .",
    "vector field component of eq .",
    "[ phiform ] with @xmath23 , the @xmath24 component is the same rotated @xmath25 degrees.,width=302 ]     with @xmath26 and @xmath27 point stencils .",
    "_ lower _ : convergence of alfven wave solution to analytical result .",
    "results from @xmath26 stencils plotted with @xmath28 and from @xmath27 stencils plotted with @xmath29 .",
    "the solid line marks a slope of @xmath30 .",
    "the @xmath26 stencil error saturates at a larger value than the @xmath31 stencil error.,title=\"fig:\",width=340 ] +   with @xmath26 and @xmath27 point stencils . _",
    "lower _ : convergence of alfven wave solution to analytical result .",
    "results from @xmath26 stencils plotted with @xmath28 and from @xmath27 stencils plotted with @xmath29 .",
    "the solid line marks a slope of @xmath30 .",
    "the @xmath26 stencil error saturates at a larger value than the @xmath31 stencil error.,title=\"fig:\",width=340 ]    in a manner similar to taylor - series based finite difference stencils , we can build generalised finite difference stencils using radial basis function interpolation .",
    "the procedure is the same as for taylor - series based finite differences , we interpolate the data at a local set of points , then take derivatives of the interpolant . like with taylor - series based finite differences ,",
    "the resulting scheme will not in general conserve mass , linear momentum , or energy to machine precision .",
    "these quantities will usually only be conserved to the level of the truncation error of the scheme .",
    "one can look to the body of work produced with the pencil code , a high order finite difference scheme , to see examples of a successful approach based on a non - conservative method ( ex : @xcite ) .",
    "scalar value radial basis function finite difference stencils have been studied in @xcite for the case of the multiquadric radial basis function . the radial basis function",
    "finite difference approach ( rbf - fd ) has also been applied to convection - type pdes in @xcite .    to illustrate this construction , we must choose a radial basis function , in this case a gaussian : @xmath32 where @xmath33 is a constant called the scaling factor .",
    "the scaling factor can be adjusted depending on the interpolation point distribution .",
    "other radial basis functions can be used ( see @xcite or @xcite , and recent results on the near equivalence of some common rbfs @xcite ) , but the gaussian gives the simplest algebraic expressions in the following .    to construct a divergence free matrix valued basis function from @xmath34 , we apply equation [ phieq ] in two dimensions with @xmath35 , yielding :",
    "@xmath36 the combinations @xmath37 and @xmath38 are divergence - free vector fields .",
    "figure [ rbfbasisfields ] shows the two components .",
    "one component resembles a dipole field in the @xmath39 direction , and the other a dipole field in the @xmath24 direction .",
    "in essence the method interpolates only @xmath0 fields because the field is built entirely from shifted and normalised versions of these dipole components . to build up an interpolation of some point - sampled field with these as the basis functions , it is necessary to solve the set of linear equations : @xmath40 for @xmath41 interpolation points the matrix @xmath42 has entries : @xmath43 each sub - matrix of @xmath44 has entries corresponding to an entry in @xmath20 .",
    "the vector @xmath45 has entries : @xmath46 @xmath44 is the interpolation matrix , and @xmath45 is the values being interpolated . @xmath47 and @xmath48 are the components of the vector field being interpolated . @xmath49 and @xmath50 are constant background field components , which may be chosen to be the field at the interpolation point where the derivatives are being calculated .",
    "this subtraction of the background constant component of the field increases the accuracy of the radial basis function approximation as this component is not in the space spanned by the interpolation basis .",
    "this background component is irrelevant to the @xmath0 constraint and to the determination of derivatives .",
    "the vector @xmath51 is composed of the interpolation coefficients in eq .",
    "[ mrbf ] . to find the derivatives of the interpolating function at point @xmath52",
    ", we can simply evaluate the derivative of eq .",
    "[ mrbf ] as @xmath53 which yields the radial basis function estimate of the derivative at the point @xmath52 .",
    "this gives us a method of finding the derivatives of a @xmath0 magnetic field from point values .",
    "the interpolation points chosen can be arbitrary , but for the purposes of building finite - difference like derivative operators a set of nearest neighbouring points is natural choice . in the following ,",
    "we demonstrate the use of @xmath26 ( 9 point ) and @xmath31 ( 25 point ) stencils , centred on @xmath52 , in two dimensions to solve the equations of magnetohydrodynamics .",
    "the equations solved are those for viscous , resistive , compressible isothermal magnetohydrodynamics in two dimensions : @xmath54 with the equation of state @xmath55 where @xmath56 is the density , @xmath57 is the velocity , @xmath58 is pressure , @xmath1 is the magnetic field , @xmath59 is the dynamic viscosity , and @xmath60 is the magnetic diffusivity .",
    "the equations are spatially discretized on an evenly spaced square grid with periodic boundary conditions .",
    "spatial derivatives are estimated using the radial basis function methods on @xmath26 stencils as outlined above , and explicit time integration is performed with the forward euler method .",
    "both the derivatives of the scalar fields ( @xmath56,@xmath58 , components of @xmath57 ) and the vector field @xmath1 are taken with scalar and vector rbf interpolations .",
    "this method is chosen so that the resulting code is as simple as possible to facilitate the reader s understanding .",
    "the source code in python is available on the author s websitecolinm / dfi/ ] .",
    "[ rbfblast ]     and @xmath61,width=340 ]     and @xmath61,width=340 ]    .linear momentum errors in the magnetised blast problem [ cols=\"<,<,<,<,<\",options=\"header \" , ]     since the method is @xmath0 by construction , we need only demonstrate that the solution converges as @xmath2 errors can not occur .",
    "a suitable test is the evolution of a damped alfven wave for finite @xmath59 and @xmath60 , the analytical solution for which is given in @xcite , section 39 .",
    "the experimental convergence of the numerical solution to the analytical result for an alfven wave is shown in figure [ alfvenconvergence ] with @xmath62 , @xmath63 .",
    "note that the error saturates in this test for the @xmath64 stencil .",
    "as the rbf interpolation used does not reproduce a first - order polynomial exactly , the approximation effectively stops improving below some grid spacing . to obtain further convergence ,",
    "a larger stencil must be used .",
    "the @xmath65 error when the @xmath31 point stencil is used decays at a rate of @xmath66 , which is the limit set by the first order time integration scheme .    as a further demonstration",
    ", the result of a magnetised blast problem , starting for an initial over density in the centre of the box is shown in figure [ rbfblast ] .",
    "the initial condition of this problem is @xmath67 , @xmath68 , @xmath69 , @xmath70 , @xmath71 , @xmath72 in a area @xmath73 with a @xmath74 grid with periodic boundary conditions .",
    "the output is shown at @xmath75 .",
    "the @xmath64 stencil was used with @xmath76 .",
    "a similar problem is shown in @xcite .",
    "we note the the intermediate shock can be seen in the solution on the axis of the blast along the magnetic field @xcite .",
    "the time history of the absolute error in total mass in the magnetised blast problem is shown in figure [ rbfblastmass ] for two resolutions .",
    "the error is at the limit of numerical precision for all resolutions .",
    "evidently the scheme used here is in fact mass - conserving even though it was not explicitly constructed to be so . the error in linear momentum is limited by truncation error , figure [ rbfblastmomentum ] shows the time evolution of the absolute momentum error for two resolutions .",
    "table [ blasterrors ] lists the momentum errors at @xmath75 in the blast problem for four grid resolutions @xmath41 .",
    "the momentum error can be seen to converge towards zero as the resolution is increased .",
    "energy conservation errors are not treated as the discussion is limited to isothermal magnetohydrodynamics .",
    "the stability of this scheme is not explored here as the method is presented only as a demonstration of the use of these radial basis function based derivative operators .",
    "the computational cost of a rbf based finite difference scheme for a derivative is the same as that for a polynomial based scheme with the same number of stencil points , as the only difference is in the stencil coefficients .",
    "however , with rbf based schemes the well - motivated stencils may not be the same shape and size as for polynomial based finite differences - for example the square @xmath64 stencil used here is not a popular choice when used with polynomial based schemes .",
    "in contrast to the most directly comparable polynomial based finite difference scheme yielding @xmath0 ( the vector potential method ) , the rbf based approach has the advantage of requiring fewer derivative stencils to be computed as the magnetic field is obtained directly not computed from derivatives of the vector potential .",
    "the method for constructing radial basis function based derivative approximations has no dependence on regularly placed points or the existence of mesh edges .",
    "hence , these methods are easily used in a mesh - free context .",
    "also , though in radial basis function interpolation theory the interpolation points are chosen to be the radial basis function centres , in practise the approximation matrix can still be inverted if the interpolation points do not coincide with the radial basis function centres . furthermore , fewer radial basis functions can be used than interpolation points are specified - in this case a @xmath0 least squares approximation can be computed . the divergence - free basis used as an example in this work is not orthonormal . if an orthonormal basis were specified , it would be possible to preform divergence - free pseudo - spectral simulations with @xmath1 , which may be of particular use in general relativistic mhd and force - free electrodynamics simulations .",
    "other constraints beyond divergence - free can be placed on the vector field .",
    "for example , @xcite observed that @xmath77 type vector fields can be interpolated in a similar manner to shown here .",
    "this suggests the possibility to satisfy more complicated , though homogeneous , constraints .",
    "in a point - value method , @xmath0 can be satisfied by the correct choice of interpolation scheme .",
    "matrix - valued radial basis functions provide such an interpolations scheme .",
    "finite - difference - like @xmath0 derivative operators can be constructed from matrix - valued radial basis function interpolations , and their use in the solution of magnetohydrodynamics problems has been demonstrated .",
    "further exploration of the stability properties , accuracy , and computational cost of schemes based on these operators is warranted .",
    "the underlying principle of the choice of a @xmath0 interpolation also applies to pseudo spectral methods , and in general can be applied to any vector field where such a constraint is required .",
    "we acknowledge useful discussions with m .- m .",
    "mac  low and j.  maron for discussions on the nature of @xmath0 and m .- m .  mac  low for advice on the manuscript .",
    "c.p.m .  was supported by nsf cdi grant ast08 - 35734 .",
    "k.  g. , 1994 , approximate riemann solver for magnetohydrodynamics ( that works in more than one dimension ) .",
    "icase report no .",
    "94 - 24 , institute for computer applications in engineering and science , nasa langley research center"
  ],
  "abstract_text": [
    "<S> in astrophysical magnetohydrodynamics ( mhd ) and electrodynamics simulations , numerically enforcing the @xmath0 constraint on the magnetic field has been difficult . </S>",
    "<S> we observe that for point - based discretization , as used in finite - difference type and pseudo - spectral methods , the @xmath0 constraint can be satisfied entirely by a choice of interpolation used to define the derivatives of @xmath1 . as an example we demonstrate a new class of finite - difference type derivative operators on a regular grid which has the @xmath0 property . </S>",
    "<S> this principle clarifies the nature of @xmath2 errors . </S>",
    "<S> the principles and techniques demonstrated in this paper are particularly useful for the magnetic field , but can be applied to any vector field . </S>",
    "<S> this paper serves as a brief introduction to the method and demonstrates an implementation showing convergence .    </S>",
    "<S> magnetic fields  magnetohydrodynamics ( mhd )  methods : numerical </S>"
  ]
}