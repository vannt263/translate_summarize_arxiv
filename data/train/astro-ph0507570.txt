{
  "article_text": [
    "quasar spectra contain numerous absorption lines that are produced in the intervening intergalactic medium ( bahcall & salpeter 1965 ; gunn & peterson ) .",
    "most of the lines are transitions of hydrogen ( lynds 1971 ; sargent et al .",
    "1980 ) , but metal transitions , such as for example due to c , si , o and many others , are observed as well ( e.g. cowie et al . 1995 ) .",
    "the hydrogen lines have column densities from @xmath0 to several times @xmath1 , with the number density per unit redshift of the stronger lines decreasing approximately as a power - law in column density , see rauch ( 1998 ) for a recent review .",
    "+ the properties of the weaker lines , up to a column density of a few times @xmath2 say at redshift @xmath3 , are well reproduced by numerical simulations of the growth of structure in flat cold - dark matter dominated cosmological models , in which the intergalactic medium is ionised by the uv - background produced by galaxies and quasars ( cen et al .",
    "1994 ; zhang , anninos & norman 1995 ; miralda - escud et al .",
    "1996 ; hernquist et al . 1996",
    "; wadsley & bond 1996 ; zhang et al .",
    "1997 ; theuns et al . 1998",
    "; bryan et al . 1999 ; meiksin , bryan & machacek 2001 ) . in these simulations ,",
    "the hi absorption lines arise in the mildly over- and under dense filaments of the cosmic web that forms naturally in this type of cosmology .",
    "the evolution of the number of these lines with redshift , is determined by the decrease in the mean density of the universe as function of redshift , and in the change of the amplitude of the uv - background ( theuns , leonard & efstathiou 1998 ; dav et al .",
    "the impressive agreement between simulations and data have led to a paradigm shift in the interpretation of these lyman-@xmath4 forest lines , away from the earlier models were absorption occurred in lyman-@xmath4 clouds confined by a variety of mechanisms , to the new model where lines arise in the slightly denser regions of a continuous , fluctuating intergalactic medium ( igm ) , with higher column - density lines arising in higher density gas , on average .",
    "the decomposition of such a continuous field in terms of ( blends of ) discrete absorption lines is artificial but the simulations show that the line - properties do depend on the physical state of the igm , such as its temperature ( schaye et al .",
    "1999 , 2000b ; ricotti et al .",
    "2000 ; bryan & machacek 2000 ; mcdonald et al . 2001 ) , the amplitude of the ionising background ( rauch et al . 1997 ; meiksin & white 2003 ; bolton et al .",
    "this volume ) , the amplitude and shape of the dark matter power - spectrum ( croft et al .",
    "1998 ; gnedin & hamilton 2002 ; mandelbaum et al .",
    "2003 ) , on the mass of the neutrino ( croft et al . 1999 ) and the dark matter particle ( narayanan et al . 2000 ; viel et al .",
    "this makes the lyman-@xmath4 forest a very valuable probe for a range of physical properties of the universe ( hui 1999 ) , given that these mildly non - linear density fluctuations can be simulated reliably .",
    "+ the fact that the over densities are low also makes it possible to make simple physical models ( bi , brner & chu 1992 ; bi & davidsen 1997 ; schaye 2001 ) , based on the concept of jeans smoothing where pressure gradients cause the gas distribution to differ from the dark matter distribution on small scales ( theuns , schaye & haehnelt 2000 ) .",
    "the dark matter distribution is approximated as a log - normal field ( coles & jones 1991 ) or else gas is crafted onto a simulated dark matter distribution either during the simulation ( gnedin & hui 1998 ) or afterwards ( viel et al . 2002 ) + simulated higher column density lines form invariably closer , or even inside , the high - density dark matter haloes that in the real universe are presumably associated with galaxies .",
    "the outer parts of the cloud will shield the inner parts from ionization when the column density is sufficiently high , @xmath5 .",
    "this self - shielding therefore requires simulations to include some radiative transfer .",
    "in adition , radiative cooling becomes important in these regions , as do the potential feedback effects from star - formation and/or active galactic nuclei .",
    "the reliability of the simulations correspondingly decreases , as the physics behind these processes is relatively poorly understood , and even harder to model realistically .",
    "however the simulations are not in obvious conflict with the data , except may be for the very strongest lines , but this is at least in part a consequence of the relatively poor statistics of these rarer lines ( gardner et al .",
    "1997 ; cen et al .",
    "2003 ; nagamine , springel & hernquist 2004 ) .",
    "+ the metals observed in the quasar spectra were presumably synthesised in stars .",
    "it is possible to constrain the physical properties of the regions in the igm that contain metals by comparing the metal - line column density with the corresponding hi column density ( cowie et al .",
    "1995 ; songaila & cowie 1996 ; dav et al . 1998 ; aguirre , schaye & theuns 2002 ) . the results ( songaila 2001 ; schaye et .",
    "2003 ) are surprising .",
    "metals are detected in gas with density below the cosmic _ mean _ density , albeit with low but uncertain metallicity @xmath6 , uncertain filling factor , and with little if any evidence for evolution with redshift over the observable range of redshifts @xmath7 .",
    "the low density to which they are detected suggests that metals were able to escape from galaxies due to some type of ( feedback ? ) mechanism .",
    "however , the lack of strong evolution in the metallicity , combined with evidence for vigorous star formation and hence also metal production over the same redshift interval , suggests that many metals that are present in the igm are not seen in the qso spectra .",
    "in contrast , adelberger and collaborators ( e.g. this volume ) argue that the intimate connection between galaxies and metal lines seen in their data implies that by and large the observed galaxies are responsible for the observed metals .",
    "the observational situations is thus a bit open to interpretation , but anyhow the present series of simulations is not very successful in reproducing the observed metal - line properties in detail ( aguirre et al .",
    "2005 and this volume ) .",
    "+ observed quasar spectra and mock spectra obtained from numerical simulations are practically indistinguishable for the untrained eye , at least for the hydrogen lines .",
    "this makes it possible to use mock spectra to estimate errors , investigate observational biases , and constrain and interpret correlations .",
    "in addition they make it possible to examine the level to which the parameters that determine the igm properties can be constrained , as well as investigate possible degeneracies between parameters given the statistics of an actual observed sample of quasars .",
    "+ given this , the comparison of observed quasar spectra with mock spectra obtained from numerical simulations has become a very valuable tool in the interpretation of absorption line data .",
    "unfortunately the comparison is often hampered by the different languages employed by observers and simulators .",
    "simulators are often unaware of the uncertainties due to continuum - fitting for example , partly because this is often done by eye , and hence almost impossible to quantify .",
    "few non - simulators would suspect that adiabatic simulations are in fact not adiabatic at all , what is meant is that there is no radiative cooling .",
    "the aim of this paper is to discuss the ingredients of current numerical simulations , the differences between popular codes , their strengths and weaknesses , so that the non - expert can judge which results are more reliable , and which may be less robust .",
    "a more in depth recent review of numerical simulations is by bertschinger ( 1998 ) .",
    "the aim of a numerical simulation is to follow how initially small density perturbations grow when they enter into the non - linear regime .",
    "this involves a choice of the background cosmological model in which the fluctuations grow , for example by specifying the density of the various constituents in units of the critical density .",
    "next we need to specify the statistics of the perturbations .",
    "in addition to these physical parameters , numerical limitations also require us to decide values for some purely numerical parameters , for example the size of the simulation box and the gravitational softening length . and because the simulations will only resolve a specific range of scales , we may also need to specify the effect of sub - grid physics , for example star formation , that happens below the resolution limit and hence is not computed but rather is imposed .",
    "other physical processes may have to be added by hand as well , for example simulations of the igm often impose the assumed evolution of the ionising background as a function of redshift .",
    "i will discuss these various parameters that need specifying , and the corresponding equations in turn , starting with the background cosmological model .",
    "many more are in for example peebles ( 1993 )",
    ".      the evolution of the scale factor of the universe , @xmath8 , is obtained from the friedmann equation ,    @xmath9    where @xmath10 is the hubble constant at time @xmath11 , @xmath12 is the hubble constant now ( when @xmath13 ) , and the various @xmath14s denote the density of respectively matter , radiation , curvature , and the vacuum - energy ( cosmological constant ) in units of the critical density .",
    "for example    @xmath15    the scale factor is used to convert physical quantities into co - moving variables , for example for the position , @xmath16 , and velocity , @xmath17 ,    @xmath18    the physical velocity @xmath19 is the sum of the hubble expansion , @xmath20 , and a peculiar velocity , @xmath21 .",
    "most simulations are performed using co - moving variables such as @xmath22 and @xmath23 , but there is wide and therefore confusing choice of how to convert other physical quantities into co - moving ones .",
    "the equations we want to solve are those expressing conservation of mass , momentum , and energy in a self - gravitating fluid ( e.g. landau & lifschitz 1959 ) .",
    "these are the continuity , euler and energy equations , supplemented by poisson s equation ,    @xmath24    here , @xmath25 is the energy per unit mass , @xmath26 of the fluid with density @xmath27 , pressure @xmath28 , temperature @xmath29 , and mean molecular weight @xmath30 .",
    "dark matter , stars and baryons contribute to the density in the right hand side of the poisson equation , but only baryons contribute to the pressure gradient .    the derivatives with respect to time are assumed to be evaluated at constant @xmath16 in these eulerian equations .",
    "we can re - write them in terms of derivatives at constant co - moving position , @xmath22 , using the relation @xmath31 ( see e.g. peebles 1993 for details )    @xmath32 & = & 0{\\nonumber}\\\\ \\ddot{{\\bf x}}+ 2h\\dot{{\\bf x}}+ ( \\dot{{\\bf x}}\\cdot\\nabla)\\dot{{\\bf x}}&=&-{1\\over a^2}\\nabla\\psi - { 1\\over a^2}\\,{\\nabla\\,p\\over\\rho}{\\nonumber}\\\\ \\dot u+ 3h{p\\over\\rho } + ( \\dot{{\\bf x}}\\cdot\\nabla ) u & = & -{p\\over\\rho } \\nabla\\dot{{\\bf x}}{\\nonumber}\\\\ \\nabla^2\\psi & = & 4\\pi g\\rho_b\\delta a^2\\ , .",
    "\\label{eq : nsf}\\end{aligned}\\ ] ]    the density is written as @xmath33 , where @xmath34 is the time - dependent background density , @xmath35 the deviation from uniformity , and the derivative is @xmath36 .",
    "these equations are valid in a reference frame at rest with respect to the matter in the universe , since the cosmological principle of a homogeneous and isotropic universe only applies to such fundamental observers .",
    "+ if it were not for the explicit time - dependencies arising from the scale factor , @xmath8 , and background density , @xmath34 , then the dynamics expressed by these equations is purely newtonian .",
    "how good this approximation is , can be estimated by calculating post - newtonian corrections arising from general relativity .",
    "these corrections depend on the size of the region in units of the horizon size squared , @xmath37 , times the amplitude of the density perturbation on the scale of the region ( see matarrese & terrenova 1996 ; takada & futamase 1999 ; ellis & tsagas 2002 for recent discussions on this , and peebles 1993 for more background ) . in practise",
    "this means that the newtonian approximation is very good , since in most simulations of the currently popular models the typical density fluctuations are indeed small on the scale of the horizon .",
    "+ these differential equations of course implicitly assume that the fluid variables are everywhere continuous , but that need not be the case .",
    "the conservation equations also allow discontinuous changes , which correspond to for example _ contact discontinuities _ , through which the pressure is continuous but the density and thermal energy are not , and _ shocks _ through which also the pressure is discontinuous ( see e.g. harlow & masden 1971 for an excellent introduction ) .",
    "these more general solutions are called the rankine - hugoniot shock conditions , and can be solved exactly for one - dimensional discontinuities .",
    "the widths of such discontinuities are of order of the mean - free path of the particles , which is usually much shorter than what can be resolved in the simulations and therefore usually neglected .",
    "their widths in the numerical calculation is then determined by the numerical scheme employed . + it is possible to convert these differential equations into difference equations , expressing conservation of mass , momentum and energy as the fluid flows between computational cells .",
    "these are _ eulerian _ simulations if the cells themselves do not move .",
    "in contrast for _ lagrangian _ simulations the change in fluid properties is expressed with respect to cells that move with the fluid .",
    "this can be done by introducing the lagragian time - derivative , @xmath38 , in terms of which the continuity changes to    @xmath39    a lock keeper who computes the rate of flow of the river past his lock performs eulerian calculations , whereas the rafter who notices changes in the river as the raft moves along with the flow is a lagrangian calculator .",
    "it is of course also possible to study the flow with respect to coordinates that move , but not with the fluid velocity : these are moving - mesh calculations .",
    "the numerical implementation of these equations , and the advantages of the different schemes , are discussed further below .",
    "+ equation  ( [ eq : e ] ) expresses entropy conservation , since @xmath40 is constant along the fluid s trajectory .",
    "simulations that integrate these equations are therefore often referred to as _ adiabatic _",
    "simulations but this is a misnomer since entropy is generated when shocks occur : non - radiative simulations would be a better name . the entropy can also change because of radiative processes which will be discussed below .",
    "it is usually assumed that density perturbations on a given scale at sufficiently early times are small .",
    "this is true for cold dark matter models , but not for some more exotic cosmologies .",
    "the statistical properties of the initial conditions ( ics ) can be specified in terms of the fourier coefficients of for example the density perturbations @xmath41 , as ,    @xmath42    the definition of a _ gaussian _ random field , is one where the real and imaginary parts of @xmath43 are independently gaussian distributed with zero mean and dispersion @xmath44 , where @xmath45 is the power spectrum of fluctuations ( see e.g. bardeen et al .",
    "1986 for a comprehensive overview ) . the power spectrum , @xmath46 , only depends on the magnitude , @xmath47 , of the wave - vector to guarantee isotropy . the probability distribution , @xmath48 , for the real part and imaginary parts , @xmath49 respectively @xmath50 , of a gaussian field are thus by definition    @xmath51    gaussian statistics may result from the central limit theorem or inflation ( guth 1981 ) , and observations of the cosmic microwave background are consistent with gaussian statistics ( e.g. komatsu et al .",
    "2003 ) . in the linear regime when the fluctuations are small",
    ", the different @xmath52-modes grow independently and the linear power - spectrum can be written as a product of the primordial power - spectrum , @xmath53 , and a transfer function , @xmath54 ,    @xmath55    the growth of a perturbation from the primordial epoch at @xmath56 to the early time @xmath11 depends on the the matter content of the model and a variety of fitting functions to @xmath54 are in common use .",
    "however when generating ic for a simulation it is equally possible to compute @xmath54 directly with a boltzmann code such as for example ( seljak & zaldarriaga 1996 ) , and use a tabulated version .",
    "given the transfer function , the linear power - spectrum is now completely specified by its primordial shape , @xmath53 .",
    "symmetry considerations ( harrison 1970 ; zeldovich 1972 ) and cosmic inflation ( guth 1981 ) both suggest a ( nearly ) scale - invariant form @xmath57 , @xmath58 .",
    "the amplitude of the power - spectrum , traditionally characterised by the mass variance on cluster scales ( @xmath59 ) , _ i.e. _ in spheres of radius @xmath60 , can not be reliably computed yet , and is left free to fit the data , for example @xmath61 for a cluster normalisation",
    "( eke at al .",
    "once a power - spectrum and its normalisation are chosen , numerical simulations are set - up by generating a realisation of such a random field using a pseudo - random number generator ( e.g. press et al .",
    "1992 ) and using lagrangian perturbation theory ( the zeldovich 1970 approximation ; davis et al .",
    "1995 ) . however , the range of waves that can be represented in a finite calculation is of course finite ( see e.g. hockney & eastwood 1988 for details ) .",
    "how serious a limitation is that ? consider a simulation in a periodic box with co - moving size @xmath62 , and try representing the linear density field on a regular grid with grid - spacing @xmath63 .",
    "this grid can represent waves with wavelength @xmath64 or wave - vector @xmath65 .",
    "the mean density in the simulation box equals the cosmic mean because of the inability of the grid to represent waves with @xmath66 .",
    "therefore the simulation inevitably suffers from a lack of _ cosmic variance _ and the statistics of rare objects which result from large - scale power , such as very massive objects or very large voids , will not be represented properly by the ics  and hence by the simulation . the only way to decide how severe a limitation this is , is to perform simulations with a larger box as well and look for convergence .",
    "the simulation also lacks power below the grid spacing . in cdm simulations transfer of power",
    "is mostly from large to small scales , so this need not be a major problem .",
    "however because the first structures to collapse do so on very small scales , the lack of small - scale power may still influence the high - density regions and in particular the slope of the inner density profile of the dark matter halos ( e.g. binney & knebe 2002 ) .",
    "transfer of power could also result from baryonic physics , for example a generation of early massive stars potentially disturbs the gas in a large region around them which might affect subsequent structure formation .",
    "+ the missing large - scale fluctuations due to a finite box - size also means that the ics do not represent the initial correlation function , @xmath67 accurately .",
    "this can be improved by generating the ics in real space as pointed - out by penn ( 1997 ) , implemented by bertschinger ( 2001 ) , and discussed in more detail by sirko ( 2005 ) + _ zoomed initial conditions _ a possible way to break the dilemma between wanting the simulation box to be at the same time large  for better statistics and a proper representation of the power - spectrum  and small  for better resolution  is to perform zoomed simulations , where the best of both worlds results from using high resolution in a small fraction of a large simulation volume .",
    "reed et al .",
    "( 2005 ) used a hierarchy of such zoomed simulations to obtain a mass resolution of better than a solar mass in a comfortably large box of size 497 h@xmath68mpc .",
    "the dynamic range of the initial conditions required is so large that it becomes impossible to perform the huge fast fourier transform when the ics are generated in fourier space .",
    "the grafic2 ics generator ( bertschinger 2001 ) is ideal for this type of problem , because it never requires a large fft since the ics are generated in real space .",
    "the equations for the growth of structure given earlier are not enough for an accurate description of the behaviour of baryons .",
    "we need to add terms that describe the radiative cooling and heating of the gas , and describe the effect of feedback .",
    "+ _ radiative cooling _",
    "a collision between an electron and an atom or ion may be able to excite or ionise the atom if the collision energy is comparable to , or higher than , the ionisation energy , @xmath69 .",
    "this represents a loss term for the thermal energy of the system if the photon which results from de - excitation or recombination is able to escape ; this is radiative cooling .",
    "the cooling rate is proportional to the density squared since the process involves the collision between two particles .",
    "the temperature dependence can be understood from the requirement that the collision energy needs to be of order of the binding energy .",
    "consequently , cooling will become inefficient once the typical collision energy is far below the ionisation energy , @xmath70 , in practise @xmath71  k for cooling by atomic hydrogen .",
    "the gas will become mostly ionised once @xmath72 , also quenching cooling .",
    "therefore the cooling rate for a given ion will peak at energies around but @xmath73 .",
    "the net radiative cooling rate is then the sum of the cooling rates due to all ions combined .",
    "the cooling rate of gas sufficiently enriched by metals will be dominated by these heavier elements .",
    "dalgarno & mccray ( 1972 ) review these processes and give fitting formulae for the net cooling rate summed over all ions assuming ionisation equilibrium .",
    "+ electrons will loose energy through coulomb interactions with ions which is the thermal bremsstrahlung that makes clusters of galaxies glow in x - rays .",
    "this cooling channel becomes important for @xmath74k .",
    "finally electrons loose energy by inverse compton - scattering with photons from the microwave background .",
    "this rate depends on the energy density of the cmb and hence increases rapidly with redshift , @xmath75 .",
    "+ _ photoionization _ a sufficiently energetic photon of energy @xmath76 may ionise an atom .",
    "the excess energy @xmath77 goes into the kinetic energy of the electron representing a heating term ; this is photoionization heating .",
    "the rate of photoionizations depends on the flux of ionising photons , @xmath78 ( usually expressed in the unwieldy units of erg @xmath79 s@xmath68 hz@xmath68",
    "sr@xmath68 ) as    @xmath80    where @xmath81 is the photoionization cross - section , and @xmath82 . the change in ionisation balance in a pure hydrogen gas , resulting from photoionizations and recombinations is given by    @xmath83    where @xmath84 , @xmath85 is the electron number density , @xmath4 is the recombination coefficient and i neglected collisional processes .",
    "the corresponding heating rate is    @xmath86    with @xmath87 the mean energy that goes into the gas per photoionzation .",
    "+ when the gas is highly ionised and in photoionization equilibrium ( @xmath88 ) , eq .",
    "( [ eq : eb ] ) simplifies to @xmath89 , and the heating rate becomes    @xmath90    this shows that the heating rate is _ independent _ of the amplitude of the ionising background , @xmath91 , ( since both @xmath87 and @xmath92 are @xmath93 ) but does depend on the _ physical _ density of the gas . +",
    "other heating mechanisms may be important as well , for example photoelectric heating by dust grains ( nath , sethi & shchekinov 99 ; inoue & kamaya 2003 ) , by x - rays either post ( madau & efstathiou 99 ) or pre - reionisation ( ricotti & ostriker 2004 ) , or cosmic rays ( samui , subramanian & srianand 2005 ) . + the radiative cooling rate depends on the ionisation state of the gas , since only neutral ions ( hi , hei , heii ) can cool . the presence of an ionising background may change the ionisation state thereby quenching cooling , see _",
    "e.g. _ efstathiou ( 1992 ) for the effect this has on the formation of dwarf galaxies .",
    "this is of course true for cooling by metal lines as well .",
    "note also that the gas is not necessarily in ionisation equilibrium : non - equilibrium effects may be important when the uv - background changes rapidly , for example during reionisation ( abel & haehnelt 2000 ) .",
    "all this makes it hard to include radiative cooling accurately in simulations , with many simulators preferring to use the equilibrium dalgarno & mccray tables which do not include photoionization .",
    "+ when the photoionization equations are integrated to determine the ionisation states , one needs to know the temperature dependence of the atomic parameters , such as recombination and photoionization rates , over a large range in @xmath29 , given the large temperature range , @xmath94 encountered in typical simulations . as a result",
    ", there is a variety of fitting formulae for the temperature dependence of these parameters in common use .",
    "a cursory comparison reveals differences @xmath95% . to get around this simulations",
    "could use tabulated values for these constants , obtained from experimental measurements or quantum mechanical calculations .",
    "the hazy website ( http://www.nublado.org/ ; ferland 2000 ) has links to such data bases .",
    "although this uncertainty in the hydrogen atomic parameters are due to poor fits rather then poorly known physics , the atomic parameters for some transitions in metals may be genuinely uncertain by a sometimes surprisingly large factor .",
    "+ the temperature of the low - density igm is set by photoionization , if other heating mechanisms are neglected .",
    "both galaxies and quasars contribute to @xmath91 ( e.g. haardt & madau 1996 ) , but the relative contribution is uncertain , as is the spectral shape @xmath78 and amplitude @xmath96 at the hydrogen ionisation edge ( see e.g. bolton et al .",
    ", this volume ) .",
    "photons emitted by hot shocked gas may also contribute to the photo - heating rate @xmath87 ( miniati et al .",
    "most cosmological simulations are too small to have a representative number of sources of each type from which to compute @xmath91 , and hence an ionising background is imposed by hand , by specifying the redshift evolution of @xmath92 and @xmath87 .",
    "+ when the universe is highly ionised , photoionizations are dominated by photons with @xmath97 since the ionisation cross - section , @xmath98 , peaks there .",
    "consequently the heating rate is low .",
    "in contrast during reionisation most photons will cause an ionisation , the mean energy injection per ionisation increases , and the universe gets heated uniformly if one neglects radiative transfer effects ( miralda - escud & rees 1994 )",
    ". note that the heating rate depends on the spectrum of ionising photons , which will change as the source spectrum is processed by the intervening absorbers .",
    "+ the epoch of reionisation is relatively uncertain , as is the nature of the sources responsible .",
    "if reionisation happens relatively quickly , then the universe will become nearly isothermal at that epoch .",
    "it is then a combination of adiabatic cooling and photoionzation - heating that determines the further thermal evolution , at least in the low - density igm ( @xmath99 say ) where radiative cooling is unimportant .",
    "this establishes a tight temperature - density relation , @xmath100 ( hui & gnedin 1997 ; theuns et al .",
    "1998 ) , and the slope steepens from isothermal @xmath101 at reionisation to an asymptotic value @xmath102 as the igm cools adiabatically .",
    "the steepening results from the fact that the lower - density gas cools more , and is heated less , since @xmath103 .",
    "if this were the whole story , then the igm temperature - density relation can be used to constrain the reionisation epoch ( miralda - escud & rees 1994 ; haehnelt & steinmetz 1998 ; theuns et .",
    "al 2002a ) .",
    "+ some regions of the universe may have been reionised before others if reionisation is patchy .",
    "this will lead to large variations in temperature during reionisation , and the long thermal time - scales in the igm guarantee that some of these temperature fluctuations may still be observable at later times .",
    "such temperature fluctuations have not been found yet ( theuns et al . 2002b ; zaldarriaga 2002 ) .",
    "the mean free path of x - ray photons is much larger and one would not expect to see temperature fluctuations if x - ray heating dominated ( ricotti & ostriker 2004 ) .",
    "the thermal state of the igm could thus plausibly elucidate the nature of the sources responsible for reionisation .",
    "+ _ feedback and subgrid physics _",
    "cosmological hydrodynamical simulations are far from resolving giant molecular clouds which are the sites of star formation .",
    "in addition they lack important physics for example dust cooling , or the dynamical effects of magnetic fields and cosmic rays , _ etc .",
    "_ , which are known to be important in the interstellar medium of the milky way , say .",
    "therefore since they can not _ simulate _ how cold gas gets converted into stars they use recipes of how this happens instead , usually of the form where cold dense gas gets converted into stars at a given rate , @xmath104 , with a given efficiency , @xmath87 , with @xmath104 and @xmath87 chosen after some experimentation .",
    "more sophisticated approaches model the multi - phase interstellar medium as discussed by mckee & ostriker ( 1997 ) and more recently by monaco ( 2004 ) , by integrating rate equations that govern the mass exchange between a hot phase ( the one simulated by the hydrodynamical modules of the code ) , a cold phase , and stars .",
    "this subgrid step is important because it is thought that the feedback from star formation regulates the conversion from gas into stars .",
    "how this works in practise is not well understood , and consequently there is a wide variety of implementations of how the energy released by massive stars and super novae couples back to the gas .",
    "other feedback processes may be important as well , for example due to agn .",
    "+ the gas cooling rate and hence the star formation rate , can be dominated by the metals produced by stars and sne . but how well are the metals mixed ? and how does this happen ?",
    "after all , the metallicity range between the highly super solar sne ejecta , the interstellar , inter - cluster and finally intergalactic gas is very large . in simulations , the extent of the mixing is mostly determined by the details of the numerical implementation . it might be possible to get a handle on this by comparing mock metal spectra to observations , for example using observations of parallel sight lines in lensed quasars ( rauch et al .",
    "1999 ) , but the issue can also be addressed in galaxies ( brighenti & mathews 200 ) and clusters of galaxies ( morris & fabian 2003 ) .",
    "the development of a mature simulation code is usually measured in person - years .",
    "fortunately several groups have started making their codes publically available and this , together with the rapid increase in computer power , has given a huge boost to the simulation industry .",
    "an important distinguishing feature between codes is whether they are eulerian or lagrangian , _",
    "i.e. _ whether they follow the fluid with respect to fixed cells , or whether they use cells ( particles ) that move with the fluid . +",
    "* eulerian codes * can accurately incorporate the rankine - hugoniot shock conditions by treating the boundary between cells as the membrane in a shock tube experiment ( the riemann problem ) .",
    "they are therefore very good at computing for example the intricate kelvin - helmholtz and rayleigh - taylor instabilities that develop when hot tenuous bubbles expand into a denser atmosphere , and the home pages of these codes usually contain beautiful examples of such instabilities .",
    "in addition , it is straightforward to distribute the computational cells over many compute nodes of a parallel computer and still achieve excellent load balance with a minimum of communication overhead .",
    "the simulations by cen and ostriker ( 1994 ) use such a code , in which the numerical resolution is uniform across the domain .",
    "note that these codes are not exact riemann solvers because the exact solution of the jump conditions can only be obtained in one dimension .",
    "+ using a uniform mesh has the great advantage of simplicity , but it does mean that the code may waste computational resources in un - interesting regions and at the same time lack resolution where the real action is . consider for example a large run of @xmath105 cells in a 100mpc box , then the cell size and hence resolution is 100mpc/1024@xmath1060.1mpc , which gives impressive mass resolution in voids , but is not enough to resolve a galaxy .",
    "* adaptive mesh refinement * ( amr ) codes try to avoid using ever more cells by varying the cell size across the grid , based on some refinement criterion specified by the user .",
    "for example try to keep the mean mass per cell constant , or require the gradient of a quantity to be sufficiently small across a single cell .",
    "these codes are significantly more complicated than single grid codes , and need to take good care of what happens at the interface between smaller and larger cells .",
    "the gains of using fewer cells may be undone by the overhead associated with the adaptive part of the code , depending on the problem and the type of refinement criterion employed .",
    "flash ( http://flash.uchicago.edu/website/home/ ; fryxell et al .",
    "2000 ) and ( http://cosmos.ucsd.edu/enzo/ ; bryan et al .",
    "1995 ) are publically available amr codes , while other amr codes include art ( kravtsov et al .",
    "2002 ) , masclet ( quilis 2004 ) and ramses ( teyssier 2002 ) .",
    "+ eulerian codes compute how material moves across the grid , and this can be difficult in cosmology because the high velocity of the cold material in the igm means potentially very high mach number flows .",
    "this problem does not arise in * lagrangian codes * which simply follow the fluid as it moves , and this is obviously quite an advantage for cosmological simulations for the growth of structure .",
    "_ smoothed particle hydrodynamics _",
    "( sph ; see monaghan 2002 for a review ) uses interpolation on irregularly gridded data to obtain smooth estimates of hydrodynamical quantities .",
    "for example the density , @xmath27 , at position @xmath107 is    @xmath108    where the sum extends over nearby particles ( @xmath109 ) , @xmath110 is the mass associated with particle @xmath111 , and @xmath112 is a smoothly peaked interpolation function .",
    "the spatial resolution is set by @xmath113 , which typically is chosen such that about 40 particles contribute , and the simulations use linked - lists ( hockney & eastwood 1988 ) or hierarchical trees ( barnes & hut 1986 ) to identify neighbours . in general this means that the resolution is higher in high - density regions , and so lagrangian codes generally resolve high density regions better than eulerian codes , whereas the latter may do better in under - densities .",
    "there is a variety of possibilities for how to convert the hydrodynamical equations into the type of interpolation in eq .",
    "( [ eq : sph ] ) .",
    "+ smooth interpolation can not handle the discontinuous changes associated with shocks hence requires the addition of extra terms that act like a viscosity .",
    "their net effect is to convert ram - pressure into thermal pressure when the fluid passes through a shock .",
    "such artificial viscosity terms manage to capture shocks within a few resolution lengths @xmath114 , even for very strong shocks .",
    "they increase the pressure gradient between two rapidly approaching particles to mimic ram - pressure .",
    "the switch that triggers the artificial viscosity can mistake a shear flow such as occurs in a differentially rotating galaxy disk for a shock .",
    "this has the unwanted side effect of transferring angular momentum through the disk , but the severity of the effect can be controlled by increasing the resolution .",
    "there is a large number of sph codes in use , ( springel 2005 ) can be downloaded from http://www.mpa - garching.mpg.de / gadget/. + which code / numerical scheme is best really depends largely on the problem being studied . zoomed simulations ",
    "in which one is interested in high resolution in a small fraction of the total simulation volume , such as simulations of the formation of individual galaxies say , obviously benefit from the advantages of amr or sph simulations over uniform grid codes .",
    "but the shear speed and efficiency of a single grid code may yet win the race when uniform resolution is sufficient .",
    "amr and sph simulations have another big potential advantage : the possibility to have a hierarchy of time steps , where some regions of spaces are updated more frequently than others .",
    "a super nova ( sn ) exploding in a high density region may cause the time step to plunge dramatically in a small region of space .",
    "clearly it is a great advantage if it is possible to decrease the time step in the affected region , but continue striding with large steps outside it . and",
    "most sph codes use such a hierarchy of time steps , and it leads to a very substantial time savings .",
    "note that there are numerical issues on the boundary between the time step zones .",
    "+ the santa barbara cluster comparison project ( frenk et al . 1999 ) compared the properties of the _ same _ cluster at z=0 , simulated with a variety of codes , and more recently oshea et al .",
    "( 2003 ) compared with .",
    "not surprisingly , the more involved the physics is , the more the results of these codes differ .",
    "whereas the structure in the collisionless dark matter is very similar in all codes , there are significant differences in the central gas distribution because of the different ways that shocks are treated .",
    "the differences would have been much greater had radiative cooling , and/or stellar feedback been included .",
    "+      it is now straightforward to download and compile one or more simulation codes , and interesting results can be obtained using nothing more than a standard desktop computer .",
    "in contrast , large simulations may take weeks to run on a large supercomputer producing several tera bytes of data in the process .",
    "this can make post processing a real nightmare .",
    "most simulators stick almost religiously to a single code , because unfortunately there is still a significant overhead in learning how to use a code .",
    "this is largely due to the bewildering variety of input / output formats and units used .",
    "this is exacerbated by the fact that the initial conditions generator , simulation code , and visualisation software , usually assume a different set of units / formats , which is why simulators stick to a given set .",
    "the situation could be improved by a wider use of hierarchical data formats such as for example hdf5 ( http://hdf.ncsa.uiuc.edu/hdf5/ ) , which allow a much more detailed description of the data than the usual binary file , without significant overhead .",
    "+      modern cosmological hydrodynamical simulation codes regularly require several 10s of lines of input parameters , most of which do not get quoted in the resulting paper .",
    "some of these are particular to the numerical algorithm while others describe parameterisations of physical processes .",
    "one of the latter is for example the evolution of the ionising background , and it will be clear from the previous discussion that the subgrid modelling inevitably involves a lot of parameter choices . +      _ small scale structure and gas cooling _",
    "the dark matter power spectrum may have power on all scales and one should therefore be clear what is meant when one claims convergence , of a simulation . this problem becomes more accurate when baryons are included .",
    "gas cooling is strongly density dependent , hence the fraction of gas that is able to cool depends on resolution . with increasing resolution",
    ", a numerical simulation will predict that a larger fraction of gas will cool .",
    "this is in fact the right answer , and it has long been known that without feedback the universe suffers from a cooling catastrophe where most baryons cool , clearly in contradiction with observations ( e.g. balogh et al .",
    "2001 for a recent discussion ) .",
    "however it does mean that simulations that do not include some type of feedback simulate a physical problem that _ does not have a solution _ , with the amount of gas cooling determined by resolution .",
    "claiming that these simulations are resolved is wrong .",
    "+ _ over cooling at interface between dense and tenuous gas _ the density in sph simulations is smoothly varying .",
    "therefore the presence of a dense cold cloud may lead to an over estimate of the density of surrounding tenuous gas , which in turn will lead to artificially increased cooling .",
    "this is a real problem in sph simulations .",
    "a possible fix is to decouple hot and cold gas when computing sph estimates of quantities , but this is at the expense of altering the equations in an ad hoc way .",
    "grid - based codes suffer to a lesser extent , but the boundary cells between the two phases may still overestimate @xmath27 and hence the cooling rate . + _ time stepping _ the time - scale of some physical processes , such as for example the cooling time , or the lifetime of massive stars , may be so short that they are not resolved in a cosmological simulation .",
    "this is usually circumvented by integrating the equations using an implicit solver , which at least guarantees stability .",
    "however the net outcome of the intricate feedback loop of gas cooling leading to star formation and sne explosions again heating the gas , may give significantly different answers depending on the time step .",
    "for example suppose that during a long time step a lot of gas cools , leading to a large burst of star formation at the end . with a much smaller time step , feedback from star formation could have heated the gas and prevented more gas from cooling , implying a much smaller star formation efficiency .",
    "models that treat this cycle partly as sub - grid physics can get around this by taking small time steps in the sub - grid physics , but larger ones in the more expensive hydrodynamical part of the calculation . again",
    "the downside is that the equations are not actually simulated by the hydrodynamical code anymore but rather solved by hand .",
    "+ _ feedback _ the net effect of a sn explosion depends strongly on the density of the gas it goes off in . in a high - density region",
    "most of the sn energy may be lost to radiation , whereas the material in a lower density region may be swept - up and driven out of the potential well of the galaxy .",
    "the real ism of a galaxy is a much more dynamic and complex multi - phase medium with both dense and tenuous phases , and can not be resolved yet in cosmological simulations .",
    "note also that cosmic rays , not usually included in simulations , are thought to provide a significant fraction of the pressure support , at least in the milky way . given these limitations ,",
    "it is not clear how we can realistically expect that the sn explosions in a simulated galaxy power the feedback cycle correctly .",
    "again it might be necessary to relegate most of this physics to the subgrid domain , where we simply impose an answer instead of trying to obtain it by integrating the proper hydrodynamical equations ( yepes et al .",
    "1997 ) . + _ metal enrichment and cooling _ simulations that include metal production usually add these metals to cells or particles near the site of star formation .",
    "lack of resolution means that the mixing from high density sn shells to the much lower ism densities is a result of the numerical implementation of the mixing , it is not _",
    "computed_. the metals are associated with a given particle in sph simulations , which is in keeping with its lagrangian nature .",
    "if this metal enriched particle is swept out of the galaxy by a galactic wind , it may find itself surrounded by zero metallicity gas falling into the galaxy for the first time .",
    "mean _ metallicity at this radius may be very low , but it is the result of many particles having zero metallicity , and few having high metallicity .",
    "this may already seem awkward , but a problem arises if we want to compute the cooling rate due to metals .",
    "it may be low in the zero metallicity gas , but high for the single particle . yet",
    "this is mostly a result of the way we mixed , or rather did not mix metals , it was not the result of a computation .",
    "suppose that as a result of metal cooling the expanding shell fragments : should we trust this outcome ?",
    "in an eulerian code , metals would mix when the enriched gas rises out of the galaxy , and this may give significantly different answers .",
    "+ _ subgrid physics _ an increasingly large fraction of the numerical calculations performed during a simulation is treated as subgrid physics , due to limitations of missing physics and lack of resolution in the hydrodynamical modules of the code .",
    "this increasingly blurs the distinction between semi - analytical calculations and numerical simulations .",
    "it also means that it becomes difficult to quantify the robustness of results obtained from simulations , because some results may result directly from the subgrid physics module , and not from the integration of hydrodynamical equations .",
    "to obtain a high - resolution , high signal - to - noise quasar spectrum requires many hours on a large telescope and is therefore an expensive commodity .",
    "consequently , observers will spend a significant amount of time reducing the data to obtain most out of the spectrum .",
    "however , it is easy to generate many hundred mock spectra from a simulation , and it is impossible to analyse them in the same detail .",
    "this is unfortunate because we would clearly like to treat observed and mock spectra in the same way .",
    "+ it is possible to generate mock spectra for comparison with a given quasar spectra , by creating spectra with the same wavelength extent , pixel size , and signal - to - noise as function of @xmath115 and flux .",
    "to do so we compute these spectra as the simulation is running , which allows us to take the rapid redshift evolution into account ( e.g. aguirre , schaye & theuns 2002 ) .",
    "note that our mock spectra are periodic with period equal to the box size .",
    "we cycle these short periodic spectra and stitch them together where there is little absorption to avoid discontinuities .",
    "this inevitably introduces undesirable periodicities in the mock spectra .",
    "of course this step is only necessary if the spatial location of the pixels is important .",
    "+ although this gives observed and mock spectra with very similar data quality and noise properties , observed spectra also need to be continuum fitted , to take into account the quasar s continuum variation , and the wavelength dependence of the sensitivity of the detector . at present",
    "this is one of the most important sources of uncertainty since this process is often done by eye and hence can not be modelled .",
    "the properties of the mock spectra also depend on the assumed amplitude of the relatively poorly known amplitude of the ionising background .",
    "it has become customary to get around this uncertainty by scaling the mock spectra so that they have the same mean flux , @xmath116 .",
    "unfortunately @xmath117 is difficult to measure and different analysis procedures give significantly different values ( e.g. bernardi et al 2003 ) .",
    "note that at low @xmath118 a non - negligible part of the absorption is due to metals , which may not be present in the mock spectra .",
    "+ quasar spectra can be analysed by fitting voigt profiles to the absorption lines ( e.g. using vpfit , http://www.ast.cam.ac.uk/@xmath119rfc/vpfit.html ) .",
    "this produces a line list with three numbers , ( 1 ) a central wavelength , ( 2 ) width and ( 3 ) column density for each line .",
    "it has been shown that the statistical properties of the lines depend on the physics of the igm .",
    "for example the fraction of strong lines increases with the amount of large - scale power , whereas the line - widths depend on the temperature - density relation .",
    "some lines can be fit well by a small number of voigt components , but others differ significantly form the voigt profile shape and hence require a large number of components .",
    "this decomposition in voigt components is not unique , since gaussians are not orthogonal basis functions , and will thus depend to some extent on how lines are fit . different fitting routines ( vpfit , fitlyman , autovp ) will produce different line - lists , definitely on a line - by - line basis but also statistically . a large fraction of the fitted lines will occur in blends and their parameters are therefore not independent .",
    "this complicates the statistical comparison between line - lists from data and mock spectra .",
    "+ the central part of a sufficiently strong line becomes effectively black , and therefore gives little hint about the absorption profile there .",
    "it is sometimes possible to constrain such lines using higher - order transitions .",
    "however this makes it even harder to compare line - lists from observed and mock spectra , because the decision to make use of the higher - order lines for a given absorption line is not automated hence introduces a further subjective step in the analysis . + a more objective way of analysing the spectra is in terms of pixel statistics , for example the flux probability distribution ( pdf ) @xmath120 , the fraction of pixels with a given flux @xmath121 ( e.g. mcdonald et al .",
    "continuum fitting and thermal broadening introduce correlations between the pixels , which need to be taken into account .",
    "for example although the _ number _ of pixels in the lyman-@xmath4 forest part of a spectrum is very large , one should not be fooled into believing that this implies great statistics for the pdf since these pixels occur in a relatively small number of _ lines_. analysis of many mock spectra can be of great help to obtain more realistic error bars , but note that some statistics may be adversely affected by very strong lines which the simulations may not model particularly well .",
    "analysis of pixels is very fast , and makes it possible to look at all transitions from a given redshift , including higher - order lyman-@xmath4 transitions but also metal line transitions .",
    "this is exploited to great effect in the pixel optical depth method ( aguirre , schaye & theuns 2002 and references therein ) .",
    "+ orthogonal to a pixel analysis is to directly compute the power - spectrum of the flux , @xmath122 ( croft et al .",
    "1998 , mcdonald et al .",
    "some parts of the spectrum may need to be excluded because of the presence of gaps in the data , or the presence of strong metal absorption lines , but this can be done with the lomb periodogram ( press et al . 1992 ) .",
    "the quasar sightline samples the 1d power - spectrum , which is an integral over the 3d power - spectrum and therefore sensitive to small scale power .",
    "one way to see that this matters is to realise that the total column density of a single strong line can be a significant fraction of the column density of the whole spectrum .",
    "this illustrates that the power - spectrum could be sensitive to the number and shape of strong lines ( choudhury , srianand & padmanabhan 2001 ; viel et al .",
    "of course the number and properties of these strong lines will depend on cosmological parameters as well and therefore @xmath122 can still be used to constrain them ( mandelbaum et al . 2003 ) .",
    "+ another alternative is to decompose the spectrum in true basis functions , for example using wavelets ( meiksin 2000 ; theuns & zaroubi 2000 ) .",
    "this method is fast and objective , but the interpretation of the wavelet coefficients may be less intuitive .",
    "pixel correlations again introduce correlations in wavelet coefficients .",
    "+ it is important to realise that the quasar s flux spectrum depends on many parameters , some of which may be almost degenerate . for example there is a near degeneracy between the amplitude of the matter power - spectrum and the ( inverse of the ) amplitude of the ionising background .",
    "conversely changing some cosmological parameters may have unexpected side effects : for example changing @xmath123 changes the temperature of the igm , because the models specify the photo - heating _ rate _",
    "@xmath87 , and hence @xmath29 depends on the age of the universe , which depends on @xmath123 .",
    "it does not stop there because changing @xmath29 changes the neutral fraction , hence the flux power - spectrum , hence the inferred matter power spectrum .",
    "_ temperature of the igm _ several groups obtain temperatures @xmath124k at @xmath3 at the mean density , from analysing line shapes ( schaye et al 1999 , 2000 ; ricotti , gnedin & shull 2000 ; bryan & machacek 2000 ; mcdonald et al .",
    "the underlying physics uses the fact that there is a minimum line width at a given column density due to thermal smoothing .",
    "of course the occasional erroneous lines introduced by the fitting algorithm may yet violate this limit , but one does expect a rather well defined lower limit to the line width , @xmath125 , as function of column density , @xmath126 .",
    "such a cut - off had in fact already been noticed in the observed @xmath127 scatter plots ( lu et al .",
    "the groups make different predictions for the evolution @xmath128 but these need not be inconsistent since different methods will measure and weigh @xmath29 at different densities differently .",
    "a temperature @xmath129k is expected for photo - heated gas , but only if reionisation occurred relatively late ( theuns et al 2002a ) .",
    "we will need to look for alternative heat sources if the early epoch of reionisation advocated by wmap ( bennett et al .",
    "2003 ) holds .",
    "there is no indication for spatial fluctuations in the @xmath29 distribution which might be expected from patchy reionisation ( theuns et al .",
    "2002b ; zaldarriaga 2002 ) , but the existing noisy estimates were based on fewer spectra than are available now .",
    "there is an indication for an increase in @xmath29 around @xmath130 which might signal heii reionisation ( theuns et al 2002d ) .",
    "+ _ amplitude and evolution of the ionising background _",
    "the amplitude @xmath92 of the ionising background can be estimated by comparing the mean flux , @xmath131 , in simulations to the observed mean .",
    "however , @xmath131 is difficult to determine observationally because of systematic uncertainties in the continuum fitting .",
    "continua are fitted to high resolution spectra by assuming that the flux recovers to the continuum level between the lines .",
    "this somewhat subjective procedure becomes increasingly suspect at higher redshift where simulations show that the flux hardly ever fully recovers .",
    "lower resolution flux calibrated spectra are continuum fitted by extrapolating from longer wavelengths .",
    "this goes wrong at lower redshifts where a fraction of the absorption is due to metal lines , which are not resolved .",
    "the differences in the observed evolution of @xmath117 between the two methods is uncomfortably large ( e.g. bernardi et al .",
    "the determination of @xmath131 from simulations is also not straightforward . for a given set of cosmological parameters , @xmath131 will decrease both when increasing numerical resolution and when increasing the box size at given resolution . in both cases ,",
    "more gas collapses to higher densities which decreases the net absorption",
    ". therefore one needs simulations with a large dynamic range , since high resolution and large box size put orthogonal demands on the simulation set - up .",
    "note also that the value of @xmath92 required in a simulation to reproduce a given mean flux , depends on many other simulations parameters , notably the temperature @xmath29 of the gas , and the amplitude , @xmath59 , of the fluctuations .",
    "therefore one should avoid the vicious circle of first measuring @xmath59 by assuming @xmath92 , then determining @xmath92 using the value @xmath59 found earlier .",
    "+ _ metals _ the evolution of the metallicity of the igm as determined either from lines ( songaila 2001 ) or pixels ( schaye et al . 2003 ) , is surprisingly weak , with little if any change between redshifts 2 and 5 .",
    "simulations have been instrumental in interpreting the distribution of metals at lower densities , using pixel statistics .",
    "note that strong metal lines are relatively rare .",
    "this makes them hard to simulate because it could be that the galaxies that produce them are also rare , and might be absent in the small simulation boxes that have enough resolution to simulate the enrichment process .",
    "the stronger lines also tend to occur in rare metal systems which the simulations that include metal enrichment do not reproduce .",
    "a major uncertainty in converting the observed metal transitions into a metallicity is the largely unknown shape , amplitude , and coherence of the uvb at the higher energies relevant to the metallic ions",
    ". it will be interesting to see whether the new generation of simulations is able to distribute metals produced in forming galaxies , in a way consistent with the data ( theuns et al .",
    "2002c ; springel & hernquist 2003 , aguirre et al .",
    "+ _ power spectrum _ the properties of the low - density igm depends on small - scale structures when the fluctuations are still small and is therefore very well placed to probe the shape and amplitude of the mass power - spectrum on small scales , and hence address such fundamental issues such as the index of the primordial power - spectrum , the neutrino mass and the nature of dark matter including the masses of potential warm dark matter candidates ( e.g. seljak et al . 2005 ) . it might even be possible to constrain the geometry of the universe comparing clustering along and perpendicular to the line of sight ( the alcock - pacynski test , hui et al .",
    "1999 ; rollinde et al .",
    "2003 , lidz et al 2003 ) .",
    "+ _ in summary _ quasar spectra are a very sensitive probe of the physical state of the distant intergalactic medium , which we can in principle use to learn about reionisation , galaxy formation , the large - scale distribution of matter , the nature of dark matter , and the geometry of the universe .",
    "it is important to understand to what extent the lyman-@xmath4 forest can live - up to this promise and simulation are well suited to investigate this ."
  ],
  "abstract_text": [
    "<S> the physical state of the intergalactic medium can be probed in great detail with the intervening absorption systems seen in quasar spectra . </S>",
    "<S> the properties of the hydrogen absorbers depend on many cosmological parameters , such as the matter - power spectrum , reionisation history , ionising background and the nature of the dark matter . </S>",
    "<S> the spectra also contain metal lines , which can be used to constrain the star formation history and the feedback processes acting in large and small galaxies . </S>",
    "<S> simulations have been instrumental in investigating to what extent these parameters can be unambiguously constrained with current and future data . </S>",
    "<S> this paper is meant as an introduction to this subject , and reviews techniques and methods for simulating the intergalactic medium . </S>"
  ]
}