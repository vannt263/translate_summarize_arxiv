{
  "article_text": [
    "the creation of smooth two - dimensional maps from a series of samples measured at discrete points is a common problem in astronomical image processing .",
    "the goal is to create a smooth map with the best possible spatial resolution given a set of data sampled in two - dimensions .",
    "the solution is complicated by the fact that the data are often not sampled in a regular way even if the detector layout is regular .",
    "for example , telescopes may be scanned or dithered to map areas larger than the array , some instruments are unable to follow objects as they rotate on the sky , or an array itself may contain flaws ( i.e. , missing or dead pixels ) .",
    "the resulting two - dimensional sample pattern can often appear quite irregular .",
    "although the layout of most modern detector arrays ( e.g. , ccds ) can reasonably be approximated as generating evenly sampled grids ( esg ) extending to infinity in all directions , observations with these arrays will typically include a series of array translations and rotations .",
    "additionally , one may want to combine multiple images of the same piece of sky in order to increase the signal - to - noise ratio .",
    "this requires that the images be registered so that the same area of the sky is being observed in each image .",
    "that is , any relative translation and rotation of the array positions with respect to the sky must be taken into account when combining the images .",
    "unless the translation and rotation operations are such that every pixel lies in a location previously occupied by another pixel then the resulting sample pattern is no longer an esg .",
    "the processing of data from any case other than an esg requires performing an interpolation .",
    "some of these cases have been discussed by other authors ( e.g. , @xcite ) .",
    "the interpolation ( or smoothing ) necessarily has an effect on the spatial resolution of the resulting map . for the case of any sampling pattern ( esg or otherwise )",
    "we wish to address the following two questions : 1 ) how does one choose an optimal kernel shape and size for the interpolation function ? and 2 )",
    "how does this kernel choice affect the spatial resolution of the resulting map ?",
    "we will concentrate on the case of a gaussian kernel .    as mentioned above , the construction of maps from non - esg sampled data is generally done through an interpolation of the data using a smoothing kernel ( see  [ sec : rsg ] and @xcite ) . in this paper , we begin by reviewing the solution for esgs using a technique based on fourier transforms (  [ sec : esg ] ) and extend this technique in  [ sec : rsg ] to regularly spaced grids ( rsgs ) , which are composed of relatively translated esgs . in  [ sec : isg ] we use the tools developed for studying rsgs and esgs to analyze irregularly sampled grids ( isgs ) and explore the effects of missing samples in a map .    throughout this paper",
    "we present examples that reference the bolometer array used with sharp .",
    "sharp is a polarimeter module that is used in conjunction with the sharc - ii camera , which is deployed at the caltech submillimeter observatory @xcite . for this , the @xmath0 sharc - ii detector array is optically split into two @xmath1 sub - arrays ( and a section of @xmath2 unused pixels ) , which image two orthogonal linear polarization components of radiation @xcite .",
    "although we concentrate on sharp maps , the results are applicable to any detector array or sampling pattern .",
    "before embarking on the analysis of the evenly sampled grid ( esg ) we first introduce a set of definitions and functions that are central to the development of the subsequent sections . given a function @xmath3 , which is dependent on position @xmath4 , ( @xmath5 and @xmath6 are the usual cartesian unit basis vectors ) , we define the fourier transform pair    @xmath7    with @xmath8 the spatial frequency vector .",
    "the digitization of a signal will invariably introduce trains of dirac distributions .",
    "for example , a two - dimensional dirac train of periods @xmath9 and @xmath10 along @xmath5 and @xmath6 , respectively , is defined such that    @xmath11    with the following fourier transform relation ( see appendix )    @xmath12    where    @xmath13    another useful distribution is the flat - top window of length @xmath14 ( in the @xmath5 direction in this case ) , which we denote by    @xmath15    and the corresponding fourier transform pair    @xmath16",
    "the detection of a signal @xmath17 from an astronomical source is inevitably achieved through a series of transformations .",
    "mathematically speaking , the signal is first convolved with the telescope transfer function @xmath18 such that    @xmath19    where `` @xmath20 '' stands for a convolution , while the measured signal @xmath21 is a sampled , pixel - integrated version of @xmath22 . for an esg",
    ", the sampling is done in an even manner with a dirac train as defined in equations ( [ eq : diractrain ] ) and ( [ eq : dtrain_ft ] ) .",
    "more precisely , for rectangular pixels of widths @xmath14 and @xmath23 we write    @xmath24    with    @xmath25\\otimes s\\left(\\mathbf{r}\\right)\\label{eq : t(r)_conv}\\\\ p\\left(\\mathbf{r}\\right ) & = & \\mathrm{rect\\mathnormal{\\left(\\frac{x}{\\delta l_{1}}\\right)}}\\mathrm{rect}\\mathnormal{\\left(\\frac{y}{\\delta l_{2}}\\right).}\\label{eq : p(r)}\\end{aligned}\\ ] ]    the convolution    @xmath26\\label{eq : psf}\\ ] ]    stands for what is commonly described as the point spread function ( psf ) .",
    "using equations ( [ eq : g(w ) ] ) and ( [ eq : dtrain_ft ] ) , and the properties of the fourier transform for products and convolutions of functions , we find that    @xmath27    with    @xmath28    and    @xmath29    equation ( [ eq : t(r)_esg ] ) is only valid for the idealized case of an infinite array . in reality this relation should be multiplied by an aperture function of appropriate width and shape . although we will take this restriction into account when analyzing the effect of missing pixels in  [ sub : missing ]",
    ", we will for the moment simplify our analysis by assuming that the array is sufficiently large so that equations ( [ eq : t(r)_esg ] ) and ( [ eq : t(w ) ] ) are suitable approximations .",
    "the esg studied in the previous section is the simplest representation that can be given for a sampled set of data .",
    "as we will see in later sections , we will always seek to transform more complicated forms of data grids ( i.e. , not evenly sampled ones ) into esgs to facilitate analysis ; this will invariably require the interpolation of sampled quantities from different locations .",
    "also , one might inquire about quantities at positions where there are no samples .",
    "for example , questions such as `` what is the intensity at position a , where there is no sample , and how does it compare to the flux at position b , c , and d on this map ? '' are common when analyzing astronomical images .",
    "it is , therefore , often necessary to generate a new interpolated map from the data set expressed through equation ( [ eq : t(r)_esg ] ) .    given a weighting function @xmath30 , any value @xmath31 to be assigned to an interpolated point can be expressed as    @xmath32    where @xmath33 is the value associated with the @xmath34th of the @xmath35 data points used for the interpolation .",
    "the quantity    @xmath36^{-1}\\label{eq : n(r)_esg}\\ ] ]    is the normalization factor , which is a function of the position of interpolation .",
    "the generation of an interpolated map is equivalent to the convolution of the initial data set with the weighting function followed by the normalization and re - sampling of the data .",
    "this can be ascertained through a comparison of equation ( [ eq : z_int(r ) ] ) with    @xmath37\\right\\ } \\nonumber \\\\   & = & \\sum_{s , t=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{st}-\\mathbf{a}_{pq}\\right)\\cdot\\left(n\\left(\\mathbf{r}\\right)\\cdot\\left\\ { \\left[t\\left(\\mathbf{r}\\right)\\cdot\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}\\right)\\right]\\otimes w\\left(\\mathbf{r}\\right)\\right\\ } \\right)\\nonumber \\\\   & = & \\sum_{s , t=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{st}-\\mathbf{a}_{pq}\\right)\\cdot\\left[n\\left(\\mathbf{r}\\right)\\cdot\\sum_{i , k=-\\infty}^{\\infty}t\\left(\\mathbf{r}_{ik}\\right)w\\left(\\mathbf{r}-\\mathbf{r}_{ik}\\right)\\right],\\label{eq : tint(r)}\\end{aligned}\\ ] ]    where @xmath38 is defined as in equation ( [ eq : r_ik ] ) and    @xmath39    is the displacement vector specifying the position of the interpolated grid @xmath40 in the relation to the initial grid .",
    "it is important to realize that because of the evenness in the sampling distribution of the original map @xmath21 the normalization factor @xmath41 will be periodic in character with the same periods ( i.e. , @xmath9 and @xmath10 ) as the original sampling dirac train for @xmath42 or @xmath43 ( e.g. , _ sinc _ weighting functions of corresponding widths in normal space ) .",
    "this condition must be strictly enforced in order to obtain a constant normalization factor while satisfying the nyquist sampling criterion . ] . as a consequence",
    ", it will take a common value for all interpolated points similarly located within a one - period segment anywhere on the grid ( see appendix ) .",
    "more precisely , data resulting from interpolations at points at @xmath44 and @xmath45 , for any integer @xmath34 and @xmath46 when @xmath47 is defined as in equation ( [ eq : r_ik ] ) , will have the same normalization factor .",
    "therefore , when the re - sampling is done using the same spatial sampling rate as for the original grid ( as is the case in eq .",
    "[ [ eq : tint(r ) ] ] ) we can write fourier transform of @xmath40 as    @xmath48\\otimes\\left[w\\left(\\mathbf{w}\\right)\\cdot\\frac{c}{l_{1}l_{2}}\\sum_{m , n=-\\infty}^{\\infty}t\\left(\\mathbf{w}-\\mathbf{w}_{mn}\\right)\\right],\\label{eq : tint(w)}\\ ] ]    where @xmath49 is the constant value associated with @xmath41 for this particular re - sampling process .",
    "equation ( [ eq : tint(w ) ] ) contains multiple copies of @xmath50 , one for each pair of @xmath51 and @xmath35 .",
    "if the nyquist sampling criterion is satisfied ( see appendix ) , then the high frequency copies may be removed with negligible aliasing by choosing the weighting function such that @xmath52 when @xmath53 ( when @xmath54 or @xmath55 )",
    ". equation ( [ eq : tint(w ) ] ) then simplifies to    @xmath56    and    @xmath57\\cdot\\frac{c}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}-\\mathbf{a}_{pq}\\right).\\label{eq : tint(r)_app}\\ ] ]    the only difference between @xmath40 and @xmath21 ( see eq . [ [ eq : t(r)_esg ] ] ) , besides the overall scaling factor and translation , is the presence of the convolution by @xmath30 for the former .",
    "it is therefore apparent that @xmath30 can serve not only as a weighting function for interpolation but also as a smoothing kernel , as its effect is functionally similar to that of the psf @xmath58 or any other function that can be applied to @xmath59 ( see eq . [ [ eq : t(r)_conv ] ] ) before or during the sampling process leading to @xmath21 .",
    "it therefore follows that the weighting functions also possesses spectral filtering qualities , as the base spectrum @xmath50 is multiplied by its fourier transform @xmath60 ( see eq . [ [ eq : tint(w)_app ] ] ) .",
    "one can , in fact , take advantage of this property in some cases .",
    "for example , the extraction of a signal from noise can be optimized by matching the spectral shape of the fourier transform of the weighting function ( more appropriately named the `` filter '' in this case ) to that of the signal itself ( if such information is available _ a priori _ ) .",
    "this is a result commonly established through the so - called matched filter theorem @xcite .",
    "it is to be noted , however , that optimization of the signal - to - noise ratio through filtering is not our goal .",
    "as will be made evident in  [ sub : weight ] , besides its fundamental role in the interpolation process we are also concerned with determining the effects of the weighting function on the spatial resolution of a map . in general , the spatial extent of the smoothing kernel will always be significantly smaller than that of the optimized matched filter .",
    "we now investigate the case of a map resulting from a re - sampling process where we seek to increase the density of samples .",
    "for example , a map with half the sampling periods as the original ( i.e. , of periods @xmath61 and @xmath62 ) will consist of the combination of four different re - sampled maps @xmath63 , @xmath64 , @xmath65 , and @xmath66 that all share the same sampling periods as the original map , but translated relative to each other .",
    "more precisely , we define    @xmath67    in other words , @xmath63 is re - sampled at the same positions as the original map while @xmath64 , @xmath65 , and @xmath66 are relatively shifted by @xmath68 , @xmath69 , and @xmath70 respectively .",
    "calculating and summing the corresponding fourier transforms ( using eq . [ [ eq : tint(w)_app ] ] ) we find for the combined map that    @xmath71w\\left(\\mathbf{w}-\\mathbf{w}_{st}\\right)t\\left(\\mathbf{w}-\\mathbf{w}_{st}\\right),\\label{eq : ts(w)_a}\\end{aligned}\\ ] ]    where @xmath72 is the normalization constant associated with @xmath73 .",
    "correspondingly , we further define @xmath74 , for @xmath75 , and we rewrite equation ( [ eq : ts(w)_a ] ) as    @xmath76w\\left(\\mathbf{w}-\\mathbf{w}_{st}\\right)t\\left(\\mathbf{w}-\\mathbf{w}_{st}\\right)\\right\\ } .\\label{eq : ts(w)_b}\\end{aligned}\\ ] ]    as will be soon discussed in  [ sub : weight ] , the magnitude of the coefficient @xmath77 depends on the width of the weighting function @xmath30 ; the wider the function , the smaller the coefficient , and vice - versa . as we will see below , there are good reasons to limit the width of the weighting function , but if we assume for the moment that @xmath30 is such that @xmath78 , then    @xmath79    and    @xmath80\\cdot\\frac{c_{1}}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\frac{\\mathbf{r}_{ik}}{2}\\right).\\label{eq : ts(r)_app}\\ ] ]    it is instructive to compare this result with the corresponding equation for an esg @xmath81 , similar to that of equation ( [ eq : t(r)_esg ] ) but with half the sampling interval in each direction    @xmath82    again we see that , apart from a multiplication factor , the ( approximate ) interpolated grid @xmath83 differs from @xmath81 by the presence of the convolution by @xmath30 .",
    "although equations ( [ eq : ts(w)_app ] ) and ( [ eq : ts(r)_app ] ) are approximations and the aforementioned correspondence between @xmath83 and @xmath81 may fail for a given weighting function ( i.e. , @xmath84 in general in eq .",
    "[ [ eq : ts(w)_b ] ] ) , this simplification is often reasonable ( see  [ sub : weight ] ) . at any rate",
    ", one can more closely approach the idealization of equation ( [ eq : ts(r)_app ] ) by broadening the width of the weighting function @xmath30 ( with a corresponding loss in spatial resolution , however ) .",
    "there is a fair amount of subjectiveness in choosing the specific form and characteristics of a weighting function .",
    "we choose the following two criteria as guidelines for achieving this :    1 .",
    "the function must be sufficiently broad so that its amplitude is large enough at the interpolated positions , while not being too broad to significantly degrade the resolution of the map .",
    "its spectral extent must be such that it filters out spatial frequencies for which @xmath85 or @xmath86 ( see eq . [ [ eq : tint(w ) ] ] and the discussion that follows ) .",
    "we now show how this can be practically implemented by considering the case of sharc - ii ( or sharp ) where @xmath87 .",
    "furthermore , we approximate the sharc - ii psf with the following gaussian profile    @xmath88    the psf size is usually defined by its full - width - half - magnitude ( fwhm ) , which is approximately 9 arcseconds for sharc - ii at 350 @xmath89 m @xcite .",
    "this gives @xmath90 arcseconds ; we will use standard deviations to specify widths of gaussian psfs . with this definition , the one - sided bandwidth associated with sharc - ii at 350",
    "@xmath89 m is    @xmath91    since @xmath92 arcseconds , then @xmath93 and the nyquist sampling criterion is met , as previously assumed .",
    "if we were to choose the weighting function @xmath30 to also be gaussian , and of width @xmath94 , then to satisfy criterion 2 above we must have    @xmath95    taking the lower limit for the size of the kernel , we can evaluate the new resolution of the map with    @xmath96    which corresponds to an equivalent psf width of 9.6 arcseconds for sharc - ii and a loss of approximately 7% in spatial resolution . finally , the relative amplitude of the weighting function at a distance of one - half pixel away from the position of interpolation would be    @xmath97    although equations ( [ eq : beamwidth ] ) and ( [ eq : weigth ] ) satisfy criterion 1 above and one could reasonably choose the corresponding weighting function to interpolate a map , one should nonetheless verify that the coefficients @xmath77 resulting from the interpolation process ( see  [ sub : interpolation ] ) are sufficiently small when seeking to increase the density of samples in the final grid .",
    "doing so will ensure that the approximation leading to equation ( [ eq : ts(r)_app ] ) is adequate , for example .",
    "figure [ fig : normalization ] shows a map ( top ) of the normalization function @xmath41 for a sharp esg with the lower - limit weighting function considered above ( @xmath98 arcseconds ) .",
    "the top most curve in the lower part of the figure is a cut through a row or column of pixels for the normalization map .",
    "the bottom two curves are similar cuts for weighting functions of @xmath99 and @xmath100 , respectively .",
    "it is clear from these curves that the relative amplitude of the @xmath77 coefficients , which can be asserted from the level of ripple on the curves , exhibits a strong dependency on the width of the weighting function .",
    "for example , the two larger weighting functions in the lower part of figure [ fig : normalization ] exhibit variations in amplitude of 11% and 1% for a loss in spatial resolution of 13% and 22% , respectively .",
    "this behavior is traced to the fact that a larger weighting function will more completely cover the space located between neighboring sampling positions , hence the existence of a smoother normalization function @xmath41 .",
    "this will be better visualized for the general case with the graph shown in figure [ fig : ripple ] where trends in normalization function ( solid line ) and spatial resolution degradation ( dashed lines ) with smoothing kernel size are plotted ( see the corresponding caption ) .",
    "we define a regularly sampled grid ( rsg ) as being a generalization of the esg discussed in the previous section .",
    "that is , a rsg has a well defined periodicity ( just as the esg ) , but it is a grid for which the pattern of dirac distributions is more complex . while along a coordinate axis of the esg there is only one dirac distribution for a given period , a rsg may have many dirac distributions ( not necessarily evenly spaced ) over the same interval .",
    "this difference is illustrated in cases ( a ) and ( b ) of figure [ fig : grids ] for one - dimensional versions of an esg and a rsg , respectively .",
    "practically speaking , a rsg would be encountered any time that maps of similar characteristics , but translated relative to one another , are combined together to form a unique and final map .",
    "an example for this would be astronomical images of a given object at different pointing positions",
    ".    it should be apparent from this discussion and figure [ fig : grids]_b _ that a rsg , which we again denote by @xmath21 , can be simply expressed as a combination of a set of relatively displaced esgs with    @xmath101,\\label{eq : t'_rsg}\\ ] ]    where @xmath59 is defined in equation ( [ eq : t(r)_conv ] ) and    @xmath102    is the relative displacement associated with the @xmath103th of the @xmath104 esgs that make up the rsg .",
    "it is straightforward to calculate the fourier transform of equation ( [ eq : t_rsg ] ) to get    @xmath105    with @xmath106 defined in equation ( [ eq : w_mn ] ) .",
    "the important aspect to emphasize for the interpolation of a rsg is that , as was the case for an esg , the normalization factor @xmath41 in equation ( [ eq : z_int(r ) ] ) is common to all interpolated points similarly located within a one - period segment anywhere on the grid .",
    "this is illustrated with the vertical broken lines in figure [ fig : grids ] .",
    "the existence of such a common normalization factor could be effectively adopted as the definition for a rsg .",
    "if we interpolate our rsg using a weighting function @xmath30 that satisfies criterion 2 above , then the high spatial frequency components of the spectrum will be filtered out .",
    "therefore , starting from equation ( [ eq : t(w)_rsg ] ) , and using steps similar to those that led from equation ( [ eq : t(w ) ] ) to equations ( [ eq : tint(w ) ] ) and ( [ eq : tint(w)_app ] ) , the resulting interpolated grid becomes    @xmath107    and    @xmath57\\cdot\\frac{n_{g}c}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}-\\mathbf{a}_{pq}\\right).\\label{eq : tint(r)_rsg}\\ ] ]    once again @xmath49 and @xmath108 denote , respectively , the common normalization factor and the displacement of the new interpolated grid in relation to the original grid ( see eq . [ [ eq : a_pq ] ] ) .",
    "obviously , the same comments apply for the map resulting from the re - sampling of a rsg here as for an esg in  [ sec : esg ] .",
    "that is , the most notable effect of the interpolation / re - sampling process is the presence of the convolution by the weighting function in equation ( [ eq : tint(r)_rsg ] ) .",
    "an irregularly sampled grid ( isg ) can manifest itself in different ways .",
    "for example , figure [ fig : grids]_c _ shows a case where the distribution of dirac functions within a given base period ( of length @xmath109 in the figure ) is not the same from one interval to the next .",
    "another possibility is shown in figure [ fig : grids]_d _ where no dirac distributions are present for some intervals .",
    "this can be likened to situations where pixels are missing from an array detector ( see below ) .",
    "the problem in the analysis of an isg is twofold .",
    "first , there is no simple way of expressing the fourier transform of irregularly spaced dirac distributions such that the spectrum will show a repeating pattern of some frequency , as is the case for an esg or a rsg .",
    "moreover , the lack of regularity in the positions of the dirac distributions implies that there does not exist a common normalization factor when performing interpolations to create an esg from an isg ( see below ) . nevertheless , it is still possible to analyze some specific types of isgs .",
    "we deal with two possible cases in what follows .",
    "it often happens that an astronomical source will be observed at different times , when it is at different locations and orientations on the celestial sphere .",
    "invariably , we seek to combine the resulting images to form a final map of the object . if the array detector ( which we assume perfect and therefore able to generate esgs of data ) used to record the images is part of an instrument that is unable to precisely track the apparent rotation of the source on the sky , then the different images of the source will be sampled with esgs that will be rotated and possibly translated relative to each other .",
    "a simple example is shown in figure [ fig : isg_rotation ] where two esgs are combined : one rotated by 10 degrees with respect to the other .",
    "these grids are not relatively translated ( see the caption ) .",
    "perhaps the most important aspect of figure [ fig : isg_rotation ] is the fact that the combination of the two esgs produces a grid which has an irregular pattern of dirac distributions , as can be asserted by the coverage of a predetermined weighting function ( shown with large empty circles in the figure ) .",
    "clearly , any weighting function @xmath30 is likely to cover a different number of samples at different positions on the map .",
    "the main consequence resulting from this fact will be the absence of a common normalizing factor at the different locations where interpolations are performed ( note that the normalization function in eq .",
    "[ [ eq : n(r)_esg ] ] will not be periodic ) .",
    "we can therefore expect that interpolated maps originating from isgs will be more complex than those resulting from esgs and rsgs .",
    "another point to consider is the possible relative rotation between the different maps to be combined . because of this",
    ", we will do well to use the fact that the fourier transform of a rotated map is the rotated fourier transform of the original ( i.e. , without rotation ) map .",
    "that is , if we have the fourier pair    @xmath110    then it is also true that ( see appendix )    @xmath111    where @xmath112 stands for the rotation operation ( i.e. , matrix ) . because of this property of the fourier transform we can express an isg @xmath21 composed of @xmath104 rotated and translated esgs and its fourier transform as    @xmath113    where @xmath114 and @xmath115 are , respectively , the rotation matrix and the translation vector corresponding to grid @xmath103 . just as for the rsg",
    "our goal is to generate an esg @xmath40 of periods @xmath9 and @xmath10 ( along the @xmath116 and @xmath117 axes , respectively ) from @xmath21 .",
    "although , as was previously pointed out , we can not express the interpolation process with a simple convolution with a weighting function @xmath30 , we can still use the general expression given in equation ( [ eq : tint(r ) ] ) .",
    "that is , with @xmath108 denoting the origin of the new interpolated grid ( see eq . [ [ eq : a_pq ] ] ) we have    @xmath118\\cdot n\\left(\\mathbf{r}\\right)\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}-\\mathbf{a}_{pq}\\right)\\nonumber \\\\   & = & \\left\\ { \\left[t\\left(\\mathbf{r}\\right)\\cdot\\sum_{p=1}^{n_{g}}\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{p}\\mathbf{r}_{ik}-\\mathbf{d}_{p}\\right)\\right]\\otimes w\\left(\\mathbf{r}\\right)\\right\\ } \\nonumber \\\\   &   & \\,\\,\\,\\cdot n\\left(\\mathbf{r}\\right)\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}-\\mathbf{a}_{pq}\\right).\\label{eq : tint(r)_isg}\\end{aligned}\\ ] ]    calculating the fourier transform of equation ( [ eq : tint(r)_isg ] ) we get    @xmath119w\\left(\\mathbf{w}\\right)\\right\\ } \\otimes n\\left(\\mathbf{w}\\right)\\right)\\\\   &   & \\,\\,\\,\\otimes\\frac{1}{l_{1}l_{2}}\\sum_{m , n=-\\infty}^{\\infty}\\delta\\left(\\mathbf{w}-\\mathbf{w}_{mn}\\right)e^{-j2\\pi\\mathbf{w}_{mn}\\cdot\\mathbf{a}_{pq}},\\end{aligned}\\ ] ]    which , using the assumption that @xmath60 is such that it filters out the higher frequency components of the spectrum , can be approximated to    @xmath120\\otimes n\\left(\\mathbf{w}\\right)\\right\\ } _ { \\mathbf{w}=\\mathbf{w}-\\mathbf{w}_{mn}}.\\label{eq : tint(w)_isg_approx}\\ ] ]    correspondingly , we can approximate equation ( [ eq : tint(r)_isg ] ) to    @xmath121\\cdot n\\left(\\mathbf{r}\\right)\\right\\ } \\cdot\\frac{n_{g}}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}-\\mathbf{a}_{pq}\\right).\\label{eq : tint(r)_isg_approx}\\ ] ]    equation ( [ eq : tint(w)_isg_approx ] ) shows best the effect of the lack of a common normalization factor on the interpolation process . since the fourier transform @xmath122 of the normalization function is convolved with the weighted ( and low - pass filtered ) spectrum @xmath123 , the resulting spectrum of the interpolated esg @xmath40 is broadened by @xmath122 .",
    "it is interesting to note that @xmath30 and @xmath41 have opposite effects on the signal .",
    "that is , the weighting function restricts the extent of the spectrum , while the normalization function extends it .",
    "given such an isg , it should be in principle possible to evaluate @xmath41 and quantify its effect .",
    "in particular , one should ensure that the two previous criteria ( see  [ sub : weight ] ) used to select the weighting function are met .",
    "optimally , @xmath41 will be sufficiently slowly varying , and of low enough amplitude , that the spectral broadening will be minimal . to make this clearer ,",
    "we show in figure [ fig : isg_ripple ] an example consisting of a combination of two relatively rotated esgs , similar to those of figure [ fig : isg_rotation ] ( i.e. , one rotated by 10 degrees with respect to the other , and no relative translation between the two ) . the map at the top of the figure is for the normalization function @xmath41 of the resulting sharp isg using a weighting function with @xmath124 ( @xmath92 arcseconds for sharp ) .",
    "the top most curve in the lower part of the figure is an arbitrary cut through a row of pixels for this normalization map .",
    "the bottom two curves are similar cuts for weighting functions of @xmath99 and @xmath100 , respectively .",
    "the black dots highlight the values taken by @xmath41 for a re - sampling onto an esg at the original sampling rate .",
    "it is clear from the top two cuts that the normalization factor is not constant in general .",
    "one can also assert from this that the spectrum due to a broad source ( in relation to the size of the map ) would be significantly more broadened by the weighting function that produced the top curve ( i.e. , with @xmath124 ) than by the other two .",
    "it is a common , if unfortunate , fact that detectors arrays used in astronomy will often contain pixels that are either performing significantly below specifications or are completely unusable .",
    "astronomers usually work around the difficulties occasioned by these so - called `` missing '' pixels by dithering the array during observations , thus ensuring complete mapping of the source under study .",
    "it would be , however , instructive to analyze and quantify the impact that missing pixels would have on the representation of astronomical signals without such corrective techniques .",
    "although we will take into account the fact that the map obtained from the array is composed of a finite number of samples , our approach will consist of first temporarily lending it an infinite character and then removing it . more precisely , although the size of the ( rectangular ) detector array considered in this section is @xmath125 , we first assume that the two - dimensional pattern of @xmath126 pixels ( including the missing pixels ) repeats infinitely in all directions .",
    "the underlying assumption is that the finiteness of the map will be restored in the end by windowing with the appropriate aperture function . using this approach we express the sampled signal ( before windowing ) as    @xmath127    with @xmath128 the position of a pixel on the array and ( take note of the periods )    @xmath129    that is , we first account for",
    "the pixels of the finite array through the summation @xmath130 , and then associate a dirac train of periods @xmath131 to each pixel .",
    "these dirac trains are relatively translated in space and are accounted for by the summations on @xmath132 and @xmath133 in equation ( [ eq : t(r)_miss ] ) .",
    "the fourier transform of the combined dirac trains is    @xmath134\\cdot\\frac{1}{n_{1}n_{2}l_{1}l_{2}}\\sum_{m , n=-\\infty}^{\\infty}\\delta\\left(\\mathbf{w}-\\mathbf{w}_{mn}\\right),\\label{eq : dtrain_miss}\\ ] ]    with    @xmath135    note that the minimum separation between two dirac distributions in frequency space is @xmath136 , where @xmath137 is the greater of @xmath138 and @xmath139 .",
    "we write the right hand side of equation ( [ eq : dtrain_miss ] ) , which we denote by @xmath140 , as follows    @xmath141    with    @xmath142    the effect of missing pixels can now easily be quantified , at least in principle , by omitting them from the @xmath130 summation in equations ( [ eq : e(w)_miss ] ) . as an example , consider the case where the @xmath143 pixels in the `` top - right '' corner of the array are missing .",
    "for this particular example , we will do well to make the following substitutions    @xmath144    where @xmath34 and @xmath46 indices stand for the columns and rows of the detector , respectively .",
    "we can then transform equation ( [ eq : e(w)_miss ] ) to    @xmath145}{\\sin\\left(\\pi n / n_{2}\\right)}\\right.\\nonumber \\\\   &   & \\left.+\\left(-1\\right)^{m}e^{j\\pi m\\left(m+1\\right)/n_{1}}\\frac{\\sin\\left[\\pi m\\left(n_{1}-m\\right)/n_{1}\\right]}{\\sin\\left(\\pi m / n_{1}\\right)}\\frac{\\sin\\left(\\pi nm / n_{2}\\right)}{\\sin\\left(\\pi",
    "n / n_{2}\\right)}\\right\\ } .\\label{eq : e(w)_m^2}\\end{aligned}\\ ] ]    when @xmath146 ( i.e. , when all the pixels are accounted for ) equation ( [ eq : e(w)_m^2 ] ) simplifies to    @xmath147    with @xmath148 and @xmath149 some integer numbers . that is to say ,",
    "equation ( [ eq : d(w)_miss ] ) then becomes    @xmath150,\\ ] ]    which is , as it should be , the same result as was obtained earlier with equation ( [ eq : dtrain_ft ] ) for the esg .",
    "although it is necessary to plot @xmath151 to assess the effect of an arbitrary distribution of missing pixels , it should now be clear from equation ( [ eq : e(w)_m^2 ] ) that its amplitude is in general non - zero for all values of @xmath51 and @xmath35 .",
    "in other words , by removing even only one pixel we went from a case where we only had dirac functions at frequency intervals of @xmath152 and @xmath153 to a situation where they are separated by intervals of only @xmath154 and @xmath155 .",
    "it is important , however , to quantify the relative magnitude of these dirac distributions .",
    "for example , returning to equation ( [ eq : e(w)_m^2 ] ) pertaining to our case of the @xmath143 missing `` top - right '' pixels , we find that    @xmath156/\\sin\\left(\\pi / n_{1}\\right)\\right|}{n_{1}n_{2}-m^{2}}\\nonumber \\\\   & \\simeq & \\frac{m^{2}}{n_{1}n_{2}-m^{2}},\\,\\,\\,\\,\\,\\,\\,\\,\\mathrm{for}\\ , m\\ll n_{1}.\\label{eq : e_10/e_00}\\end{aligned}\\ ] ]    this last relation yields the perhaps intuitive result that when only a small number of pixels are missing the amount of contamination determined by the ratio expressed in equation ( [ eq : e_10/e_00 ] ) is approximately equal to the ratio of the number of missing pixels to that of good pixels .",
    "we should , however , resist the temptation to generalize this result , since different distributions of @xmath157 missing pixels would give different levels of contamination . especially if they are not concentrated in one part of the array , as is the case here .",
    "an example is shown in figure [ fig : missing ] where the function @xmath151 is plotted for three different cases . starting with the nominal sharp @xmath1 array , @xmath151 is shown for @xmath158 when _ i ) _ no pixels ( black curve and dots ) , _ ii ) _ 16 randomly positioned pixels ( red curve and dots ) , and _",
    "iii ) _ the @xmath159 `` top - right '' corner pixels ( blue curve and dots ) are missing .",
    "contrary to the case of an esg ( corresponding to the black dots ) where @xmath160 when @xmath161 , an isg ( red and blue dots ) will in general have @xmath162 for all @xmath51 and @xmath35 .",
    "it should be clear that @xmath151 acts as a mask that will or will not allow the appearance of dirac distributions that are more closely spaced in frequency depending on whether or not there are missing pixels in the array .",
    "this serves to emphasize the fact that missing pixels will bring some spectral contamination ( i.e. , aliasing ) in the sampled signal .",
    "this becomes more evident if we calculate the spectrum of the measured signal from equations ( [ eq : t(r)_miss ] ) and ( [ eq : d(w)_miss ] )    @xmath163    we see that the different replicas of @xmath50 are spaced in frequency according to equation ( [ eq : w_mn_miss ] ) ( compare this with the case of the esg in equation ( [ eq : w_mn ] ) where the spacing between replicas is @xmath164-times greater ) .",
    "contrary to the case of an esg , a convolution with the usual weighting function @xmath30 will not restore a low - pass filtered version of the @xmath59 map . to make this clear",
    ", we first define a new function @xmath165 such that    @xmath166    then proceeding with the usual interpolation defined in equation ( [ eq : z_int(r ) ] ) we find that    @xmath167\\otimes n\\left(\\mathbf{w}\\right)\\right\\ } _ { \\mathbf{w}=\\mathbf{w}-\\mathbf{w}_{st}}\\label{eq : tint(w)_miss}\\ ] ]    and    @xmath168\\cdot n\\left(\\mathbf{r}\\right)\\right\\ } \\cdot\\frac{1}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}\\delta\\left(\\mathbf{r}-\\mathbf{r}_{ik}-\\mathbf{a}_{pq}\\right),\\label{eq : tint(r)_miss}\\ ] ]    where @xmath108 is defined in equation ( [ eq : a_pq ] ) and denotes , once again , the position of the origin of the interpolated grid .",
    "these equations show that maps resulting from the interpolation of isgs containing missing pixels suffer from both spectral aliasing ( from the presence of @xmath165 in lieu of @xmath50 in eq .",
    "[ [ eq : tint(w)_miss ] ] ) and broadening ( because of the presence of @xmath122 ) .",
    "we once again stress the realization that _ missing pixels will bring some amount of aliasing that will be impossible to remove with a reasonably sized weighting function .",
    "the concept of nyquist sampling can even lose much of its meaning and usefulness in a situation where too many pixels are missing , or when the level of contamination due to spectral aliasing is comparable to the noise level present in the map .",
    "_ this fact strongly underlines the necessity of performing adequate dithers or other scanning strategies when observing with an imperfect detector array .",
    "we complete the analysis by performing the windowing mentioned earlier , which transforms equation ( [ eq : t(w)_miss ] ) to    @xmath169\\label{eq : t'int(r)_miss}\\\\ t_{\\mathrm{int}}^{\\prime}\\left(\\mathbf{w}\\right ) & = & t_{\\mathrm{int}}\\left(\\mathbf{w}\\right)\\otimes\\left[n_{1}l_{1}n_{2}l_{2}\\,\\mathrm{sinc}\\left(\\pi un_{1}l_{1}\\right)\\mathrm{sinc}\\left(\\pi vn_{2}l_{2}\\right)\\right].\\label{eq : t'int(w)_miss}\\end{aligned}\\ ] ]    for reasonably large detector arrays we do not expect that the presence of the @xmath170 functions will be of any significance due to their spectral narrowness relative to the extent of @xmath50 ( or @xmath171 ) .",
    "because of this , our periodic depiction of the array , upon which our analysis rests , is justified .",
    "in this paper we addressed the question of astronomical image processing from data obtained with array detectors .",
    "we defined and analyzed the cases of evenly ( esg ) , regularly ( rsg ) , and irregularly ( isg ) sampled grids for idealized and realistic detectors .",
    "we focused on the effect of interpolation on the maps , while using a gaussian kernel to accomplish this task . in all cases ( i.e. , esg , rsg , and isg )",
    "we have applied the method of weighted averages ( eq . [ [ eq : z_int(r ) ] ] ) to produce a map interpolated on a finely spaced grid .",
    "we defined an esg as a map where the signal to be analysed is digitized with a simple , two - dimensional , train of dirac distributions evenly separated with well - defined spacings ( see eq . [ [ eq : diractrain ] ] ) .",
    "moreover , since the esg is the simplest way to represent and analyse a set of sampled data , we always sought to transform a non - evenly sampled grid ( i.e. , a rsg or an isg ) to an esg through the process of interpolation .",
    "while studying the esg , we found that the interpolation process invariably leads to a loss in spatial resolution ; this loss grows with increasing width of the smoothing kernel ( this result is true in general , i.e. , when considering rsgs and isgs ) .",
    "when an esg is re - sampled at the same rate as the original map the interpolation process can usually be adequately taken into account by replacing the original signal by its convolution with the weighting function ( see eq . [ [ eq : tint(r)_app ] ] ) .",
    "the same is not true in general , however , when the final esg is re - sampled at a rate different than that of the original map ( see eq .",
    "[ [ eq : ts(w)_b ] ] ) .",
    "this is due to the fact that the normalization function that is intrinsic ( and necessary ) to the interpolation process is not constant but a function of position ( although it is periodic with periods corresponding to the sampling rates )",
    ". the aforementioned replacement of the original map in the interpolation process by its convolution with the weighting function will only be adequate in such cases when the latter is sufficiently broad relative to the spacing between samples ( see figs .",
    "[ fig : normalization ] and [ fig : ripple ] ) .",
    "we defined an rsg as a generalization of an esg such that it consists of a combination of a number of relatively translated esgs of similar sampling rates .",
    "all the results obtained for the esg can be generalized to the rsg .",
    "we analyzed two different types of isgs : the combination of relatively translated and rotated esgs , and esg - like maps with missing samples ( e.g. , data grids made with detectors exhibiting dead pixels ) . in the first case , the interpolation process can not be simply represented by a convolution of the original signal with the weighting function , as this operation must be subsequently multiplied by the normalization function ( see eq . [ [ eq : tint(r)_isg_approx ] ] ) . because of the irregular nature of the new map , the normalization function is not periodic in general and will add structure to the spectrum ( i.e. , the fourier transform ) of the map .",
    "more precisely , the spectrum of the source ( filtered by the spectral profile of the weighting function ) will be broadened through its convolution with the fourier transform of the normalization function .",
    "this effect is a function of the size of the weighting function , as the spatial variation of the normalization function grows larger for smaller kernel widths .",
    "although these results also apply to maps exhibiting missing samples , we found that these further suffer from spectral aliasing that may reduce or negate the usefulness of the nyquist sampling criterion in extreme cases .",
    "this fact strongly underlines the necessity of performing adequate dithers or other scanning strategies when observing with an imperfect detector array .",
    "in this appendix we provide a few simple derivations to justify some of the results used in the text .                  before calculating the fourier transform of equation ( [ eq : del(r)_app ] )",
    ", we consider the so - called duality property of the fourier pair in equations ( [ eq : g(r ) ] ) and ( [ eq : g(w ) ] ) .",
    "more precisely , we mean that if for a function @xmath177 we have                          the _ nyquist sampling criterion _ can be understood with equation ( [ eq : del(u)_app ] ) and the product / convolution property of the fourier transform .",
    "this property states that the following fourier pair is valid          which implies that the base spectrum @xmath187 is repeated in frequency space at an interval equal to the sampling period of @xmath188 .",
    "it is apparent that in order to avoid any cross - contamination between the different spectral replicas of @xmath187 the following relation must be enforced      relation ( [ eq : nyquist ] ) is the one - dimensional mathematical equivalent of the nyquist sampling criterion , which states that in order to recover the base spectrum @xmath187 from its sampled version ( through spectral filtering ) the sampling frequency must be at least twice as large as the frequency extent of @xmath187 .",
    "as usual @xmath41 and @xmath30 are the normalization and weighting functions , respectively , and the vectors @xmath38 and @xmath108 are given by equations ( [ eq : r_ik ] ) and ( [ eq : a_pq ] ) .",
    "when the original map is an esg the normalization function is periodic and can therefore be expanded with a two - dimensional fourier series          @xmath195\\otimes\\left[\\frac{1}{l_{1}l_{2}}\\sum_{m , n=-\\infty}^{\\infty}\\delta\\left(\\mathbf{w}-\\mathbf{w}_{mn}\\right)e^{-j2\\pi\\mathbf{w}\\cdot\\mathbf{a}_{pq}}\\right]\\right\\ } \\\\   &   & \\,\\,\\,\\otimes\\left[t^{\\prime}\\left(\\mathbf{w}\\right)w\\left(\\mathbf{w}\\right)\\right]\\\\   & = & \\left[\\frac{1}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}n\\left(i , k\\right)\\sum_{m , n=-\\infty}^{\\infty}\\delta\\left(\\mathbf{w}-\\mathbf{w}_{mn}-\\mathbf{w}_{ik}\\right)e^{-j2\\pi\\left(\\mathbf{w}-\\mathbf{w}_{ik}\\right)\\cdot\\mathbf{a}_{pq}}\\right]\\\\   &   & \\,\\,\\,\\otimes\\left[t^{\\prime}\\left(\\mathbf{w}\\right)w\\left(\\mathbf{w}\\right)\\right]\\\\   & = & \\left[\\frac{1}{l_{1}l_{2}}\\sum_{i , k=-\\infty}^{\\infty}n\\left(i , k\\right)e^{-j2\\pi\\mathbf{w}_{ik}\\cdot\\mathbf{a}_{pq}}\\sum_{m , n=-\\infty}^{\\infty}\\delta\\left(\\mathbf{w}-\\mathbf{w}_{mn}-\\mathbf{w}_{ik}\\right)e^{-j2\\pi\\mathbf{w}\\cdot\\mathbf{a}_{pq}}\\right]\\\\   &   & \\,\\,\\,\\otimes\\left[t^{\\prime}\\left(\\mathbf{w}\\right)w\\left(\\mathbf{w}\\right)\\right],\\end{aligned}\\ ] ]          @xmath199\\left[\\frac{1}{l_{1}l_{2}}\\sum_{m^{\\prime},n^{\\prime}=-\\infty}^{\\infty}\\delta\\left(\\mathbf{w}-\\mathbf{w}_{m^{\\prime}n^{\\prime}}\\right)e^{-j2\\pi\\mathbf{w}\\cdot\\mathbf{a}_{pq}}\\right]\\right\\ } \\\\   &   & \\,\\,\\,\\otimes\\left[t^{\\prime}\\left(\\mathbf{w}\\right)w\\left(\\mathbf{w}\\right)\\right].\\end{aligned}\\ ] ]            evidently @xmath202 is constant for a given interpolated map , but will vary as a function of the displacement of the new sampling grid ( defined by @xmath108 ) relative to the original one .",
    "equation ( [ eq : tint(r)_const_app ] ) leads to ( and justifies ) equation ( [ eq : tint(r)_app ] ) provided that we set @xmath203 .",
    "finally , we prove the result used in  [ sec : isg ] that the fourier transform of a rotated map is the rotated fourier transform of the unrotated map .",
    "to do so we subject a two - dimensional map @xmath3 to a rotation @xmath112 and calculate the fourier transform of the transformed map @xmath204 with"
  ],
  "abstract_text": [
    "<S> we address the question of astronomical image processing from data obtained with array detectors . </S>",
    "<S> we define and analyze the cases of evenly , regularly , and irregularly sampled maps for idealized ( i.e. , infinite ) and realistic ( i.e. , finite ) detectors . </S>",
    "<S> we concentrate on the effect of interpolation on the maps , and the choice of the kernel used to accomplish this task . </S>",
    "<S> we show how the normalization intrinsic to the interpolation process must be carefully accounted for when dealing with irregularly sampled grids . </S>",
    "<S> we also analyze the effect of missing or dead pixels in the array , and their consequences for the nyquist sampling criterion . </S>"
  ]
}