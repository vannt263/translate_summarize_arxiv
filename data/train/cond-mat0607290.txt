{
  "article_text": [
    "distributed message passing algorithms like belief propagation have been around for over a decade now @xcite .",
    "recently some important problems in combinatorial optimization have seen faster distributed algorithms - motivated using a heuristic technique in statistical physics called the cavity method - that seem to solve problem instances much larger than what was previously feasible .",
    "this method has also led to analytical predictions about some threshold phenomenon in various problems of cross - disciplinary interest .",
    "some examples of its application include the satisfiability threshold for random constraint satisfaction @xcite and the corresponding survey - propagation algorithm , iterative decoding algorithms in multi - user cdma @xcite , etc .    however , very few rigorous results are known concerning the validity of the cavity method and the convergence of the algorithms . in this paper",
    "we wish to add to the body of rigorous results @xcite supporting the predictions of the cavity method by showing its correctness for the problem of counting matchings in large sparse graphs .",
    "we borrow some of the techniques from gamarnik et.al . @xcite",
    "but we hope that some newer lines of the argument ( e.g. showing validity of the free energy shifts ) could lead to useful insights into the validity of the method for other instances in which the method was applied .",
    "the algorithms generated using this method in some instances resemble the naive believe propagation equations , whereas in some other instances they resemble two - layered belief propagation ( or survey propagation ) equations , and in few other cases are significantly more involved . in the problem of counting matchings",
    ", the equations generated using the cavity method resemble the naive belief propagation equations . in this paper",
    "we show the convergence of the cavity equations and the uniqueness of the fixed points for arbitrary graphs @xmath0 . in general such convergence results",
    "are not known except for trees or graphs with exactly one cycle @xcite .      counting the number and size of matchings on various types of random graphs",
    "has been a classical problem in graph theory .",
    "this problem has been intensively studied for a long time by mathematicians and computer scientists @xcite .",
    "very recently zdebrov and mzard @xcite used the cavity method to solve this problem .",
    "they believed that the results obtained by this heuristic are exact for the matching problem and using this approach : a ) they derived an algorithm that computes the entropy for arbitrary graphs with girth that diverges in the large size limit and b ) derived analytical results for regular and erds - rnyi random graph ensembles .",
    "we first define the problem of finding the number of perfect matchings in a simple graph and then describe the cavity equations for solving it .",
    "consider a graph @xmath1 with @xmath2 vertices @xmath3 , and edge - set @xmath4 . throughout this paper",
    "we will always assume that @xmath0 is simple ( i.e. g has no multi - edge or self - loops ) and undirected .",
    "the _ girth _ of a graph @xmath0 is defined as the length of the shortest cycle .",
    "a _ matching _ is a subset of edges @xmath5 such that no two edges of @xmath6 have a common endpoint .",
    "let @xmath7 denote the size of matching @xmath6 and let @xmath8 be a matching of maximum size . if @xmath9 then @xmath8 is called a _",
    "perfect _ matching .    counting the number of perfect matchings in a graph @xmath0",
    "is shown to be # -p complete @xcite , ( i.e. in general no polynomial - time algorithm can find the exact number of perfect matchings of @xmath0 unless @xmath10 ) . since it is widely believed that @xmath11 , many approaches have been focused on finding polynomial - time algorithms for approximately counting the number of perfect matchings @xcite .",
    "let @xmath12 denote the vertices of @xmath0 and @xmath13 denote the edges .",
    "for every vertex @xmath14 let @xmath15 denote the vertex - neighborhood of vertex @xmath16 , i.e. @xmath17 , and let @xmath18 denote the edge - neighborhood of vertex @xmath16 , i.e. the set of edges in @xmath4 that have the vertex @xmath16 as an endpoint .    describe a matching @xmath6 by variables @xmath19 assigned to each edge @xmath20 with @xmath21    since @xmath6 is a matching , it follows that for any vertex @xmath22 : @xmath23    for every matching @xmath24 define its energy to be its number of unmatched vertices : @xmath25 where @xmath26 .",
    "this induces a probability distribution ( called the _ gibb s _ distribution ) on the set of all matchings , @xmath27 , of the graph @xmath0 , defined by : @xmath28 where @xmath29 is a positive number and is called _",
    "inverse temperature_. the normalizing term @xmath30 is called _ partition function_.",
    "the partition function of an empty graph is defined as @xmath31 . to simplify notation",
    "we will omit the dependence on @xmath29 and write @xmath32 instead of @xmath33 and @xmath34 instead of @xmath35 .",
    "let a configuration denote a collection of edges @xmath36 .",
    "observe that @xmath32 can also be represented on the set of all configurations , as below .",
    "let for all @xmath22 @xmath37 then it follows that @xmath38 note that @xmath39 is minimized when @xmath6 is a maximum size matching and for large values of @xmath29 the partition function is dominated by the terms corresponding to maximum size matchings of @xmath0 . hence for @xmath40    @xmath41 where @xmath42 is number of maximum size matchings in @xmath0 .",
    "@xmath43 is defined as the free - energy of the system .",
    "observe that for large @xmath29 , we have @xmath44 with the approximation becoming exact as @xmath45 .",
    "the cavity method of statistical physics is a heuristic that is used to evaluate the partition function . in the next section we will state the equations derived in @xcite using the cavity approach and",
    "then prove that these equations compute the partition function exactly for sparse graphs .",
    "in the first few sections the term sparse graph is used loosely to mean graphs that have no short loops . the precise dependence needed between the length of the shortest loop and the size of the graphs ( measured in terms of the number of vertices and number of edges )",
    "will be spelt out in the final section .",
    "let @xmath46 be the ` message ' that edge @xmath47 conveys to vertex @xmath16 , one of its end - points .",
    "note that there are @xmath48 messages as there are two messages for each edge .",
    "the following two claims form the algorithmic and analytical crux of the cavity method for this problem .",
    "[ zdeborov - mzard ] [ cl : bp ] consider the iterative equation defined by @xmath49.\\ ] ]    these iterative equations converge to a unique fixed point for a large sparse graph whose girth diverges with the size of the graph .",
    "let @xmath50 be the unique fixed points of the system of equations in the above claim , i.e. @xmath51.\\ ] ]    [ zdeborov - mzard ] [ cl : cavity ] the free energy for a single large sparse graph is given by @xmath52 where @xmath53    @xmath54 is often called the _ free energy shift _ corresponding to the removal of a vertex @xmath16 and its associated edges , and @xmath55 the _ free energy shift _ corresponding to the removal of the edge @xmath56 .",
    "our outline of the proof is as follows : first we will prove the cavity - claims for the case when @xmath0 is a tree , and then we will proceed to establish this for a large sparse graph .",
    "validity of claim [ cl : bp ] is well - known for the case of a tree and the main result in the next section is to show that claim [ cl : cavity ] is exact as well .",
    "in this section , we shall assume that the graph @xmath0 is a tree .",
    "note that removing any edge @xmath57 from @xmath0 splits the graph into two subgraphs : @xmath58 containing the vertex @xmath16 , and @xmath59 containing the vertex @xmath60 .        for any graph @xmath1 with @xmath22 and @xmath61 ,",
    "let @xmath62 denote the graph with edge @xmath56 removed .",
    "further , let @xmath63 denote the graph @xmath0 with vertex @xmath16 and with all edges adjacent to @xmath16 removed . in figure",
    "[ fig : graph ] , observe that @xmath64 is formed from @xmath58 by removing vertex @xmath16 and all its adjacent edges .    observe that , @xmath65    defining @xmath66 we see that @xmath67 note that @xmath68 thus , @xmath69    [ le : fshfttree ] free energy @xmath70 , can be expressed as the sum of free energy shifts when g is a tree , i.e. @xmath52    observe that @xmath71 here @xmath72 follows form the fact that @xmath73 and @xmath74 follows form the fact that in a tree @xmath75 .    to complete the proof of claim [ cl : cavity ] for the case that g is a tree we need to show the following :    * the variables @xmath50 defined in satisfy equation .",
    "* the equations have a unique fixed point .",
    "the fact that the equations have a unique fixed point is a well - known fact for the case when @xmath0 is a tree . for general graphs @xmath0 , the convergence and the uniqueness",
    "is not known .",
    "one of the main technical ingredients in this paper is to establish the convergence and the uniqueness for general graphs as well .",
    "[ le : recsatisfy ] the variables @xmath50 defined in satisfy equation .    we need to show that @xmath76.\\ ] ] this is equivalent to showing that @xmath77 now using the equations , we see that this reduces to showing @xmath78 observe that this follows from the following : @xmath79 and @xmath80 .",
    "consider any simple graph @xmath0 and consider the iterative equations defined on it according to .",
    "the proof for the convergence of the iterative equations is based on the following lemma :    [ lem : lip ] let @xmath81 be a real valued function defined as follows : @xmath82 then for any @xmath83 : @xmath84    since @xmath85 is differentiable , multi - variable version of the mean value theorem implies that for any @xmath86 there exist a point @xmath87 on the line - segment connecting @xmath88 and @xmath89 in @xmath90 such that : @xmath91 from hlder s inequality it follows that @xmath92    in order to show ( [ eq : lip ] ) it suffices to show that @xmath93 . note that , @xmath94 for simplicity of notation let @xmath95 , then one obtains @xmath96 now using @xmath97 : @xmath98 this completes the proof of lemma [ lem : lip ] .",
    "next we will use lemma [ lem : lip ] to prove convergence of the cavity equations ( [ eq : iter ] ) for any graph @xmath0 .",
    "[ th : maincon ] for any graph @xmath0 the set of cavity equations ( [ eq : iter ] ) converges to a unique fixed point independent of its initial conditions .",
    "consider an arbitrary initial condition @xmath99 .",
    "the iterative equations in states that @xmath100.\\ ] ]    define @xmath101 to be the multi - valued function from @xmath102 to @xmath102 such that @xmath103    consider the two - iterate of function @xmath104 , i.e. let @xmath105 .",
    "let @xmath106 where each @xmath107 is a real valued function on @xmath102 .",
    "observe that each function @xmath108 can be written in the form @xmath109 where @xmath110deg@xmath111 .",
    "let @xmath112deg@xmath111 , the maximum degree of a vertex in @xmath0 .",
    "now using lemma [ lem : lip ] for any @xmath113 , we have :    @xmath114    thus the sequence @xmath115 is cauchy and hence converges to a point @xmath116 .",
    "this shows that the equations converge for any graph @xmath0 .    to show uniqueness consider two different initial conditions @xmath99 and @xmath117 . using the same argument as in equation ( [ eq : attract ] ) one",
    "has : @xmath118 so both sequences @xmath115 and @xmath119 converge to the same point and this contradicts the existence of multiple fixed points .",
    "this completes the proof of the theorem [ th : maincon ] and shows that the equations converge to a unique fixed point for any graph .    in the next section",
    "we show that validity of the cavity - claims when the graph @xmath0 has a large girth .",
    "theorem [ th : maincon ] proves the validity of the claim [ cl : bp ] for arbitrary graphs and in particular for graphs with large girth .",
    "therefore it suffices to show the validity of claim [ cl : cavity ] for graphs with large girth . before starting the proof , we note the following bounds on the values of the fixed points of the equation .",
    "the proof of this lemma is straightforward and is omitted .",
    "[ le : bound ] let @xmath120 be the the unique fixed points of the iterative equations on any graph @xmath0 with maximum degree @xmath121 .",
    "then @xmath122 \\leq h^{i \\to a } \\leq 1.\\ ] ]    consider a fixed graph @xmath0 of size @xmath2 .",
    "let @xmath123 denote the maximum distance such that the subgraph , @xmath124 , formed using the vertices that are within a distance @xmath123 from the vertex @xmath16 is a tree .",
    "let the vertices in @xmath124 be denoted by @xmath125 .",
    "consider the set of edges , @xmath126 , that connect @xmath125 and @xmath127 .",
    "further let the subgraph formed by the vertices @xmath127 be denoted as @xmath128 .",
    "this decomposes the original graph @xmath0 into three parts : the subgraph @xmath124 , the set of edges @xmath126 , and the subgraph @xmath128 .",
    "pick any subset of the edges @xmath129 .",
    "let @xmath130 denote the set of matchings in @xmath0 that use precisely the subset of edges @xmath131 in @xmath126 .",
    "let @xmath132 denote the set of vertices in @xmath124 that are the endpoints of the edges @xmath126 .",
    "let @xmath133 denote the set of vertices in @xmath124 that are the endpoints of the edges @xmath131 .",
    "further , let @xmath134 denote the set of vertices in @xmath128 that are the endpoints of the edges @xmath131 .    denote @xmath135 as the sub - graph formed using the vertices that are within distance @xmath136 from vertex @xmath16 .",
    "observe that @xmath137    [ le : iterconv ] let @xmath138 and @xmath139 be two different subsets of @xmath126 .",
    "let @xmath140 be the unique fixed points of the iterative equations on the graphs @xmath141 and @xmath142 .",
    "then @xmath143 \\end{aligned}\\ ] ]    since @xmath144 we can set @xmath145 for the messages in the sub - graph @xmath146 .    to bound the difference in the messages at the boundary depending on choice of @xmath131 , observe the following :",
    "let @xmath147 be any vertex at distance @xmath136 from @xmath16 and let @xmath148 be any neighbor of @xmath147 that is at distance @xmath149 .",
    "let @xmath150 denote the degree of the vertex @xmath147 in the graphs @xmath151 respectively .",
    "let @xmath152 denote the edge joining @xmath147 to @xmath148 .",
    "then from lemma [ le : bound ] we see that @xmath153.\\ ] ]    we can use lemma [ lem : lip ] to determine the propagation of this difference to the messages at @xmath16 .",
    "it is not difficult to see from repeated use of lemma [ lem : lip ] that @xmath154\\ ] ]    for simplicity of notation let us denote @xmath155 , \\quad k = { \\frac}{\\delta}{e^{-2{\\beta}}+\\delta}.\\ ] ] it is easy to see that @xmath156 for large enough @xmath157 .",
    "let @xmath56 be an edge that is connected to the vertex @xmath16 .",
    "we will show that the free - energy shift @xmath55 for the graph @xmath0 can be approximated by the free energy shift corresponding to the tree @xmath158 .",
    "[ le : lemfe ] let @xmath159 .",
    "then , @xmath160    observe that @xmath161 similarly for @xmath62 , obtained by removing edge @xmath56 in @xmath0 , we obtain @xmath162    let @xmath163 be the converged values of the iterative equations for the case when @xmath164 . combining the result for trees and our bounds on the converged values of @xmath50 for different initial conditions in lemma [ le : iterconv ] we know that @xmath165    therefore for all choices of @xmath131 the following holds    @xmath166    using this result and the decompositions of @xmath167 and @xmath168 presented above we obtain that @xmath169    observing that the boundary conditions do not influence the value of @xmath50 , the fixed points of the iterative equations for the graph @xmath0 , we can infer that    @xmath170    in a very similar manner to the removal of an edge , we can also show that for some @xmath171 @xmath172 similar to the case of the removal of the edge , the above equation implies that @xmath173         let @xmath0 be a graph that satisfies the _ girth condition_. @xmath174 where @xmath175 .",
    "[ th : mainform ] for any @xmath176 .",
    "let @xmath0 be a graph satisfying the girth condition .",
    "then the free energy shifts approximates @xmath34 within factor @xmath177 , i.e. @xmath178    note that when @xmath179 , then @xmath180 and so holds .",
    "let @xmath181 be an ordering of edges and @xmath182 .",
    "the following lemma is crucial to prove theorem [ th : mainform ] .",
    "[ le : approxzbyx ] for all @xmath183 : @xmath184 where @xmath185 , @xmath186 and @xmath187 .    before proving lemma [",
    "le : approxzbyx ] we will show how it can be used to prove theorem [ th : mainform ] .    [",
    "proof of theorem [ th : mainform ] ]    assuming lemma [ le : approxzbyx ] and taking the telescopic product of @xmath188 to @xmath189 , we obtain @xmath190 and hence @xmath191 the assumptions on the girth of the graph in implies that @xmath192 and this completes the proof .    therefore , all that remains is to prove lemma [ le : approxzbyx ] .",
    "we need to show that @xmath193    observe that , @xmath194    let @xmath195 be an endpoint of the edge @xmath196 .",
    "we will estimate the product @xmath197 by partitioning the vertices and edges into two groups ; those that are in @xmath198 and those that are outside @xmath198 .",
    "using equation whenever @xmath199 , we have @xmath200    similarly whenever @xmath201 then from lemma [ le : lemfe ] we have @xmath202    now we consider the case when @xmath203",
    ".    since @xmath204 and both graphs are trees , we can use for @xmath205 to obtain @xmath206    similarly , for @xmath207 using lemma [ le : lemfe ] we have @xmath208    note that ,    @xmath209    using equations , , in the first product and equations , in the second product ( and from the definition of @xmath210 ) , we obtain @xmath211    lemma [ le : fshfttree ] implies that @xmath212 when @xmath0 is a tree . therefore , since @xmath213",
    ", @xmath214 are trees we can replace @xmath215 with @xmath216 and subsequently using lemma [ le : lemfe ] to replace @xmath216 with @xmath217 , we complete the proof of lemma [ le : approxzbyx ] .",
    "in this paper we show the validity of the cavity method for the problem of counting the number of matchings for graphs with large girth .",
    "the girth condition we have in this paper is quite restrictive and several graphs of practical relevance do not meet this condition .",
    "however we hope that the methods presented here can be extended in a straightforward manner to random regular graphs and erds - rnyi graphs .",
    "this would lead to , as observed in @xcite , tighter estimates for counting the number of matchings in such graphs .",
    "we also demonstrate the convergence and uniqueness of the iterative equations for arbitrary graphs .",
    "the techniques used in this paper do not heavily depend on the nature of the problem and therefore there is a good possibility of these techniques having a wider interest and applicability to other important problems were cavity method has been applied .",
    "d.gamarnik , r. nowicki and g. swirscsz , `` maximum weight independent sets and matchings in sparse random graphs .",
    "exact results using the local weak convergence method '' , lecture notes on computer science , 3122 , 357 [ math.pr/0309441 ]    m. jerrum and a. sinclair , `` the markov chain monte carlo method : an approach to approximate counting and integration , in approximation algorithms for np - hard problems ( d. hochbaum , ed . ) '' , pws publishing company , boston ma , 482 - 520 , 1996 ."
  ],
  "abstract_text": [
    "<S> in this paper we rigorously prove the validity of the cavity method for the problem of counting the number of matchings in graphs with large girth . </S>",
    "<S> cavity method is an important heuristic developed by statistical physicists that has lead to the development of faster distributed algorithms for problems in various combinatorial optimization problems . </S>",
    "<S> the validity of the approach has been supported mostly by numerical simulations . in this paper </S>",
    "<S> we prove the validity of cavity method for the problem of counting matchings using rigorous techniques . </S>",
    "<S> we hope that these rigorous approaches will finally help us establish the validity of the cavity method in general . </S>"
  ]
}