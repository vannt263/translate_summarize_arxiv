{
  "article_text": [
    "determining unknown values of parameters from noisy measurements is a ubiquitous problem in physics and engineering . in quantum mechanics ,",
    "the single - parameter problem is posed as determining a coupling parameter @xmath0 that controls the evolution of a probe quantum system via a hamiltonian of the form @xmath1 @xcite . traditionally , an estimation procedure proceeds by ( i ) preparing an ensemble of probe systems , either independently or jointly ; ( ii ) evolving the ensemble under @xmath2 ; ( iii ) measuring an appropriate observable in order to infer @xmath0 .",
    "the quantum cramr - rao bound @xcite gives the optimal sensitivity for _ any _ possible estimator and much research has focused on achieving this bound in practice , using entangled probe states and nonlinear probe hamiltonians @xcite .    yet",
    ", it is often technically difficult to prepare the exotic states and hamiltonians needed for improved sensitivity . instead",
    ", an experiment is usually repeated many times to build up sufficient statistics for the estimator .",
    "in contrast , the burgeoning field of continuous quantum measurement @xcite provides an opportunity for on - line _ single - shot _",
    "parameter estimation , in which an estimate is provided in near real - time using a measurement trajectory from a single probe system .",
    "parameter estimation via continuous measurement has been previously studied in the context of force estimation @xcite and magnetometry @xcite . although verstraete et .",
    "al develop a general framework for quantum parameter estimation , both of @xcite focus on the readily tractable case when the dynamical equations are linear and the quantum states have gaussian statistics . in this case , the optimal estimator is the quantum analog of the classical kalman filter @xcite .    in this paper",
    ", we develop on - line estimators for continuous measurement when the dynamics and states are not restricted .",
    "rather than focusing on fundamental quantum limits , we instead consider the more basic problem of developing an actual parameter filter for use with continuous quantum measurements . by embedding parameter estimation in the standard quantum filtering formalism @xcite",
    ", we construct the optimal bayesian estimator for parameters drawn from a finite dimensional set .",
    "the resulting filter is a generalized form of one derived by jacobs for binary state discrimination @xcite . using recent stability results of van handel @xcite",
    ", we give a simple check for whether the estimator can successfully track to the true parameter value in an asymptotic time limit . for cases",
    "when the parameter is continuous valued , we develop _ quantum particle filters _ as a practical computational method for quantum parameter estimation .",
    "these are analogous to , and inspired by , particle filtering methods that have had much success in classical filtering theory @xcite .",
    "although the quantum particle filter is necessarily sub - optimal , we present numerical simulations which suggest they perform well in practice . throughout",
    ", we demonstrate our techniques using a single qubit magnetometer .",
    "the remainder of the paper is organized as follows .",
    "section [ sec : quantum_filtering ] reviews quantum filtering theory .",
    "section [ sec : finite ] develops the estimator and stability results for a parameter from a finite - dimensional set .",
    "section [ sec : infinite ] presents the quantum particle filtering algorithm , which is appropriate for estimation of a continuous valued parameters .",
    "section [ sec : conclude ] concludes .",
    "in this section , we review the notation and features of quantum filtering and quantum stochastic calculus , predominantly summarizing the presentation in @xcite , which provides a more complete introduction . in the general quantum filtering problem , we consider a continuous - stream of probe quantum systems interacting with a target quantum system .",
    "the probes are subsequently measured and provide a continuous stream of measurement outcomes .",
    "the task of quantum filtering is to provide an estimate of the state of the target system given these indirect measurements . in the quantum optics setting ,",
    "the target system is usually a collection of atomic systems , with hilbert space @xmath3 and associated space of operators @xmath4 .",
    "the probe is taken to be a single mode of the quantum electromagnetic field , from which vacuum fluctuations give rise to white noise statistics .    in the limit of weak atom - field coupling , the joint atom - field evolution",
    "is described by the following quantum stochastic differential equation ( qsde ) @xmath5 where @xmath6 is an atomic operator that describes the atom - field interaction and @xmath7 is the atomic hamiltonian .",
    "the interaction - picture field operators @xmath8 are quantum white noise processes with a single non - zero it product @xmath9 .    for any atomic observable @xmath10",
    ", the heisenberg evolution or quantum flow is defined as @xmath11 .",
    "application of the it rules gives the time evolution as @xmath12)dt + j_t([l^{\\dag},x_a])da_t + j_t([x_a , l])da_t^{\\dag}\\ ] ] with lindblad generator @xmath13 = i[h , x_a ] + l^{\\dag}x_al -\\frac{1}{2}l^{\\dag}lx_a - \\frac{1}{2}x_al^{\\dag}l .\\ ] ] similarly , the observation process , which we take to be homodyne detection of the scattered field , is given by @xmath14 .",
    "the it rules give the corresponding time evolution @xmath15 together , and are the system - observation pair which define the filtering problem .",
    "the quantum flow describes our knowledge of how atomic observables evolve exactly under the joint propagator in , but it is inaccessible since the system is not directly observed . nonetheless , the scattered fields as measured in carry information about the atomic system , providing a continuous measurement of the observable @xmath16 , albeit corrupted by quantum noise .",
    "the quantum filtering problem is to find @xmath17 = \\mathbbm{e}(j_t(x_a)|m_{[0,t]})$ ] , the best estimate ( in a least squares sense ) of an atomic observable conditioned on the measurement record .",
    "we invite the reader to consult @xcite for details on deriving the recursive form of this filter , which is governed by the ( classical ) stochastic differential equation ( sde ) @xmath18 = \\pi_t[\\mathcal{l}[x_a]]dt +           \\left(\\pi_t[l^{\\dag}x_a + x_al ] \\right.\\\\          \\left .",
    "- \\pi_t[l^{\\dag } + l]\\pi_t[x_a]\\right )                  \\times ( dm_t - \\pi_t[l + l^{\\dag}]dt ) .\\end{gathered}\\ ] ] we see that this is an entirely classical filter , driven by the classical measurement stream @xmath19 .",
    "oftentimes , it is more convenient to work with the adjoint form of the equation for @xmath20 , which satisfies @xmath21 } = \\pi_t[x_a]$ ] for all @xmath10 .",
    "the state @xmath20 is often called the conditional density matrix .",
    "the sde or stochastic master equation ( sme ) for @xmath20 is then @xmath22dt + ( l\\rho_tl^{\\dag } - \\frac{1}{2}l^{\\dag}l\\rho_t - \\frac{1}{2}\\rho_tl^{\\dag}l)dt\\\\              + ( l\\rho_t + \\rho_tl^{\\dag } - { \\operatorname{tr}\\bigl[(l+l^{\\dag})\\rho_t\\bigr]}\\rho_t)dw_t\\end{gathered}\\ ] ] where the _ innovations process _ ,",
    "@xmath23}dt$ ] , is a wiener process that satisfies @xmath24 = 0 $ ] and it rule @xmath25 .",
    "measurement , @xmath26 , @xmath27 ( top ) filtered values of @xmath28 $ ] and @xmath29 $ ] for simulated trajectory ]    consider the setup depicted in figure [ fig : schematic ] .",
    "a qubit , initially in the pure state @xmath30 , precesses about a magnetic field @xmath31 while undergoing a continuous measurement along @xmath32 . in terms of the general framework , @xmath33 and @xmath34 , where @xmath35 is the continuous measurement strength in the weak coupling limit .",
    "we will not dwell on the underlying physical mechanism which gives rise to the @xmath36 measurement , though continuous polarimetry measurements could suffice @xcite . plugging into",
    ", the quantum filter for the bloch vector @xmath37,\\pi_t[\\sigma_y],\\pi_t[\\sigma_z])$ ] is @xmath38 & = 2b\\pi_t[\\sigma_z ] dt - 2\\kappa \\pi_t[\\sigma_x ] dt                        - 2\\sqrt{\\kappa}\\pi_t[\\sigma_x]\\pi_t[\\sigma_z ] dw_t\\\\      d\\pi_t[\\sigma_y ] & = -2m\\pi_t[\\sigma_y ] dt - 2\\sqrt{\\kappa}\\pi_t[\\sigma_x]\\pi_t[\\sigma_y ] dw_t\\\\      d\\pi_t[\\sigma_z ] & = -2b\\pi_t[\\sigma_x]dt   + 2\\sqrt{\\kappa } ( 1 -   \\pi_t[\\sigma_z]^2)dw_t\\end{aligned}\\ ] ] with innovations @xmath39 dt$ ] .",
    "it is not difficult to verify that the quantum filter maintains pure states and that the initial state @xmath40 remains on the bloch circle in the @xmath41-@xmath32 plane .",
    "letting @xmath42 be the angle from the positive @xmath41-axis such that @xmath43/\\pi_t[\\sigma_x]$ ] , we then simplify the filter to @xmath44 where now @xmath45 .",
    "figure [ fig : typical_trajectory ] shows a computer simulation of a typical measurement trajectory and filtered bloch vector values when @xmath27 .",
    "note that in the absence of a magnetic field , the steady - states are the @xmath36 eigenstates , which are reached with probabilities given by the born rule @xcite .",
    "using the atomic system as a probe for the unknown parameter @xmath0 , we set the atomic hamiltonian of the quantum filter to @xmath46 supposing we knew the true value of the parameter , the quantum filtering equations would give us the best least - squares estimate of the atomic system conditioned on the measurements and the knowledge of dynamics induced by @xmath0 through @xmath47 . but given the optimality of the filter , we could equally well embed the parameter @xmath0 as a diagonal operator @xmath48 acting on an auxiliary quantum space , after which the filter _ still _ gives the best estimate of _ both _ system and auxiliary space operators . finding",
    "the best estimate of @xmath0 conditioned on the measurements simply corresponds to integrating the equations for @xmath49 $ ] .",
    "more precisely , extend the atomic hilbert space @xmath50 and the operator space @xmath51 , where @xmath52 is the set of diagonal operators on @xmath53 .",
    "assuming @xmath0 takes on @xmath54 possible values @xmath55 , @xmath56 .",
    "introduce the diagonal operator @xmath57 so that @xmath58 with @xmath59 .",
    "this allows one to generalize as @xmath60 any remaining atomic operators @xmath10 act as the identity on the auxiliary space , i.e. @xmath61 .",
    "given these definitions , the derivation of the quantum filtering equation remains essentially unchanged , so that the filter in either the operator form of or the adjoint form of is simply updated with the extended forms of operators given in the last paragraph .    since @xmath0 is a classical parameter",
    ", we require that the reduced conditional density matrix @xmath62 be diagonal in the basis of @xmath48 .",
    "thus we can write @xmath63 where @xmath64 }           \\equiv \\pi_t[{{\\lvert \\xi_i \\rangle}{\\langle \\xi_i \\rvert}}\\otimes i]\\\\          \\equiv \\mathbbm{e}[{{\\lvert",
    "\\xi_i \\rangle}{\\langle \\xi_i \\rvert } } \\otimes i | m_{[0,t ] } ]           \\equiv p(\\xi = \\xi_i | m_{[0,t ] } ) .\\end{gathered}\\ ] ] then @xmath65 is precisely the conditional probability for @xmath0 to have the value @xmath66 and the set @xmath67 gives the discrete conditional distribution of the random variable represented by @xmath48 . similarly , by requiring operators to be diagonal in @xmath53 ,",
    "we ensure that they correspond to classical random variables . in short ,",
    "we have simply embedded filtering of a truly classical random variable in the quantum formalism .",
    "the fact that both states and operators are diagonal in the auxiliary space suggests using an ensemble form for filtering . as such ,",
    "consider an ensemble consisting of a weighted set of @xmath54 conditional atomic states , each state evolved under a different @xmath66 .",
    "later , in section [ sec : infinite ] , we will call each ensemble member a _",
    "quantum particle_. for now , we explicitly write the conditional quantum state as @xmath68 where @xmath69 is a density matrix on @xmath3 .",
    "the reduced state , @xmath70 , is clearly diagonal in the basis of @xmath48 . using the extended version of the adjoint quantum filter in",
    ", one can derive the _ ensemble quantum filtering equations _",
    "[ eq : finitedim : ensemblefilter ] @xmath71dt                                + ( l\\rho_t^{(i)}l^{\\dag } - \\frac{1}{2}l^{\\dag}l\\rho_t^{(i ) } - \\frac{1}{2}\\rho_t^{(i)}l^{\\dag}l)dt                              \\nonumber \\\\                            & + \\left(l\\rho_t^{(i ) } + \\rho_t^{(i)}l^{\\dag }                              - { \\operatorname{tr}\\bigl[(l+l^{\\dag})\\rho_t^{(i)}\\bigr]}\\rho_t^{(i)}\\right)dw_t \\label{eq : finitedim : ensemblefilter : rho}\\\\              dp_t^{(i ) } & = \\left({\\operatorname{tr}\\bigl[(l+l^{\\dag})\\rho_t^{(i)}\\bigr ] } - { \\operatorname{tr}\\bigl[i\\otimes(l+ l^{\\dag})\\rho_t^{e}\\bigr]}\\right)p_t^{(i)}dw_t                              \\label{eq : finitedim : ensemblefilter : prob}\\\\              dw_t & = dm_t - { \\operatorname{tr}\\bigl[i\\otimes ( l +   l^{\\dag})\\rho_t^{e}\\bigr]}dt \\label{eq : finitedim : ensemblefilter : innov }      \\end{aligned}\\ ] ]    we see that each @xmath69 in the ensemble evolves under a quantum filter with @xmath72 and is coupled to other ensemble members through the innovation factor @xmath73 , which depends on the ensemble expectation of the measurement observable .",
    "note that one can incorporate any prior knowledge of @xmath0 in the weights of the initial distribution @xmath74 .",
    "the reader should not be surprised that a similar approach would work for estimating more than one parameter at a time , such as three cartesian components of an applied magnetic field .",
    "one would introduce an auxiliary space for each parameter and extend the operators in the obvious way .",
    "the ensemble filter would then be for a joint distribution over the multi - dimensional parameter space .",
    "similarly , one could use this formalism to distinguish initial states , rather than parameters which couple via the hamiltonian .",
    "for example , in the case of state discrimination , one would introduce an auxiliary space which labels the possible input states , but does not play any role in the dynamics .",
    "the filtered weights would then be the probabilities to have been given a particular initial state .",
    "in fact , using a slightly different derivation , jacobs derived equations similar to for the case of binary state discrimination @xcite .",
    "yanagisawa recently studied the general problem of retrodiction or `` smoothing '' of quantum states @xcite . in light of his work and results in the following section ,",
    "the retrodictive capabilities of quantum filtering are very limited without significant prior knowledge or feedback .",
    "although introducing the auxiliary parameter space does not change the derivation of the quantum filter , it is not clear how the initial uncertainty in the parameter will impact the filter s ability to ultimately track to the correct value .",
    "indeed , outside of anecdotal numerical evidence ( which we will presently add to ) , there has been little formal consideration of the sensitivity of the quantum filter to the initial state estimate .",
    "recently , van handel presented a set of conditions which determine whether the quantum filter will asymptotically track to the correct state independently of the assumed initial state @xcite .",
    "since we have embedded parameter estimation in the state estimation framework , such stability then determines whether the quantum filter can asymptotically track to the true parameter , i.e. whether @xmath75 when @xmath76 . in this section ,",
    "we present van handel s results in the context of our parameter estimation formalism and present a simple check of asymptotic convergence of the parameter estimate .",
    "we begin by reviewing the notions of absolute continuity and observability .    in the general stability problem ,",
    "let @xmath77 be the true underlying state and @xmath78 be the initial filter estimate .",
    "we say that @xmath77 is _ absolutely continuous _ with respect to @xmath78 , written @xmath79 , if and only if @xmath80 . in the context of parameter estimation",
    ", we assume that we know the initial atomic state exactly , so that @xmath79 as long as the reduced states satisfy @xmath81 .",
    "since these reduced states are simply discrete probability distributions , @xmath82 and @xmath83 , this is just the standard definition of absolute continuity in classical probability theory . in our case",
    ", the true state has @xmath84 if the parameter has value @xmath66 . thus , as long as our estimate has non - zero weight on the @xmath85-th component , @xmath79 .",
    "this is trivially satisfied if @xmath86 for all @xmath87 .",
    "the other condition for asymptotic convergence is that of observability .",
    "a system is _ observable _ if one can determine the exact initial atomic state given the entire measurement record over the infinite time interval .",
    "observability is then akin to the ability to distinguish any pair of initial states on the basis of the measurement statistics alone .",
    "recall the definition of the lindblad generator in and further define the operator @xmath88 = l^{\\dag}x_a + x_al$ ] . then according to proposition 5.7 in @xcite ,",
    "the observable space @xmath89 is defined as the smallest linear subspace of @xmath4 containing the identity and which is invariant under the action of @xmath90 and @xmath91 .",
    "the filter is observable if and only if @xmath92 , or equivalently @xmath93 .    in the finite - dimensional case",
    ", van handel presents an iterative procedure for constructing the observable space .",
    "define the linear spaces @xmath94 as @xmath95 , \\mathcal{k}[\\mathcal{z}_{n-1}]\\},\\quad n > 0      \\end{split}\\ ] ] the procedure terminates when @xmath96 , which is guaranteed for some finite @xmath97 , as the dimension of @xmath98 can not exceed the dimension of the ambient space @xmath4 .",
    "moreover , the terminal @xmath99 , so that using a gram - schmidt procedure , one can iteratively find a basis for @xmath89 and easily compute its dimension . note that for operators @xmath100 and @xmath31 , the inner - product @xmath101 is the hilbert - schmidt inner product @xmath102}$ ] .",
    "given these definitions , one has the following theorem for filter convergence and corollary for parameter estimation .",
    "( theorem 2.5 in @xcite ) let @xmath103 be the evolved filter estimate , initialized under state @xmath104 . if the system is observable and @xmath79 , the quantum filter is asymptotically stable in the sense that @xmath105 } } \\stackrel{t \\rightarrow\\infty }                          { \\longrightarrow } 0 \\quad \\forall x_a \\in \\mathcal{a}\\ ] ] where the convergence is under the observations generated by @xmath77",
    ".    one could use this theorem to directly check the stability of the quantum filter for parameter estimation , using the extended forms of operators in @xmath90 and @xmath91 and being careful that the observability condition is now @xmath106 .",
    "however , the following corollary relates the observability of the parameter filter to the observability of the related filter for a known parameter . combined with the discussion of extending the absolute continuity condition ,",
    "this then gives a simple check for the stability of the parameter filter .",
    "consider a parameter @xmath0 which takes on one of @xmath54 distinct positive real values @xmath107 .",
    "if the quantum filter with known parameter is observable , then the corresponding extended filter for estimation of @xmath0 is observable .    in order to satisfy the observability condition ,",
    "we require @xmath108 , where we have set @xmath109 and used the fact that @xmath110 .",
    "given that the filter for a known parameter is observable , its observable space coincides with @xmath4 and has an orthogonal operator basis @xmath111 , where we take @xmath112 .",
    "similarly , consider the @xmath54-dimensional operator space @xmath113 .",
    "if @xmath107 are distinct , any set of the form @xmath114 is linearly independent , since the corresponding generalized vandermonde matrix @xmath115 has linearly independent columns @xcite .",
    "following the iterative procedure , we construct the observable space for the parameter estimation filter starting with @xmath116 , which is the identity in the extended space .",
    "we then iteratively apply @xmath90 and @xmath91 until we have an invariant linear span of operators .",
    "the only non - trivial operator on the auxiliary space comes from the hamiltonian part of the lindblad generator , which introduces higher and higher powers of the diagonal matrix @xmath48 .",
    "since @xmath117 is finite , this procedure must terminate .",
    "the resulting observable space can be decomposed into subspaces @xmath118 where @xmath119 is some increasing sequence of non - negative integers which correspond to the powers of @xmath48 that are introduced via the hamiltonian .",
    "note that the specific values of @xmath119 depend on the commutator algebra of @xmath120 and the atomic - space operator basis @xmath111 .",
    "regardless , since the hamiltonian in @xmath90 can always add more powers of @xmath48 , the procedure will not terminate until @xmath121 is composed of a largest linearly independent set of powers of @xmath48 .",
    "this set has at most @xmath54 distinct powers of @xmath48 , since it can not exceed the dimension of the auxiliary space .",
    "given that any collection of @xmath54 powers of @xmath48 is linearly independent , this means once we reach a set of @xmath54 powers @xmath119 , the procedure terminates and @xmath122 .",
    "since @xmath89 has @xmath123 subspaces @xmath121 , each of dimension @xmath54 , @xmath124 as desired and the observability condition is satisfied .",
    "although these conditions provide a simple check , we would like to stress that they do not determine how quickly the convergence occurs , which will depend on the specifics of the problem at hand .",
    "additionally , as posed , the question of observability is a binary one",
    ". one might expect that some unobservable systems are nonetheless `` more observable '' than others or simply that unobservable systems might still be useful for parameter estimation .",
    "given the corollary above , one can see that this may occur if a single parameter @xmath125 . then @xmath126 has a row of all zeros , so that the maximal dimension of a set of linearly independent powers of @xmath48 is @xmath127 .",
    "similarly , if one allows both positive and negative real - valued parameters , the properties of @xmath126 are not as obvious , though in many circumstances , having both @xmath66 and @xmath128 renders the system unobservable .",
    "we explore these nuances in numerical simulations presented in the following section .",
    "consider using the single qubit magnetometer of section [ subsec : single_qubit ] as a probe for the magnetic field @xmath31 .",
    "since the initial state is restricted to the @xmath41-@xmath32 plane , the @xmath129 component of the bloch vector is always zero and thus is not a relevant part of the atomic observable space , which is spanned by @xmath130 . in some sense ,",
    "the filter with known @xmath31 is trivially observable , since we assume the initial state is known precisely .",
    "when @xmath31 is unknown , the ensemble parameter filter is given by    [ eq : qubit_ensemble ] @xmath131    where @xmath132 and @xmath133 .",
    "we simulated this filter by numerically integrating the quantum filter in using a value for @xmath31 uniformly chosen from the given ensemble of potential @xmath31 values .",
    "this generates a measurement current @xmath134 , which is then fed into the ensemble filter of . for all simulations , we set @xmath26 and used a simple it - euler integrator with a step - size @xmath135 @xcite .",
    "figure [ fig : discrete : combinedruns](a ) shows a simulation of a filter for the case @xmath136 .",
    "the filter was initialized with a uniform distribution , @xmath137 . for the particular trajectory shown ,",
    "the true value of @xmath31 was @xmath138 and we see that the filter successfully tracks to the correct @xmath31 value .",
    "this is not surprising , given that the potential values of @xmath31 are positive and distinct , thus satisfying the convergence corollary .",
    "it is also interesting to note that the filter quickly discounts the probabilities for @xmath139 , which are far from the true value .",
    "conversely , the filter initially favors the incorrect @xmath140 value before honing in on the correct parameter value .    in figure",
    "[ fig : discrete : combinedruns](b ) , we show a simulation for the case of @xmath141 , which does not satisfy the convergence corollary .",
    "in fact , using the iterative procedure , one finds the observable space is spanned by @xmath142 .",
    "but since @xmath143 , @xmath144 so that only 3 of the 6 operators are linearly independent .",
    "although the filter does not converge to the true underlying value of @xmath145 , it does reach a steady - state that weights the true value of @xmath31 more heavily .",
    "simulating 100 different trajectories for the filter , we observed 81 trials for which the final probabilities were weighted more heavily towards the true value of @xmath31 .",
    "this confirms our intuition that the binary question of observability does not entirely characterize the performance of the parameter filter .",
    "figure [ fig : discrete : convergence ] shows the rate of convergence of filters meant to distinguish different sets of @xmath31 .",
    "the rate of convergence is defined as the ensemble average of the random variable @xmath146 although any individual run might fluctuate before converging to the underlying @xmath31 value , the average of @xmath147 over many runs should give some sense of the rate at which these fluctuations die down . for the simulation shown ,",
    "we set @xmath148 and averaged @xmath149 over 1000 runs for two different cases  either all possible @xmath31 values are greater than @xmath150 or all are less than @xmath150 .",
    "as shown in the plot , the former case shows faster convergence since the @xmath31 field drives the dynamics more strongly than the measurement process , which in turn makes the trajectories of different ensemble members more distinct .",
    "of course , one can not make the measurement strength too weak since we need to learn about the system evolution .    ) , averaged over 1000 trajectories .",
    "the filters are for cases when possible @xmath31 values are either all larger or all smaller than the measurement strength @xmath150 . ]",
    "abstractly , developing a parameter estimator in the continuous case is not very different than in the finite dimensional case .",
    "one can still introduce an auxiliary space @xmath53 , which is now infinite dimensional . in this space , we embed the operator version of @xmath0 as @xmath151 where @xmath152 and @xmath153 .",
    "again , by extending operators appropriately , the filters in and become optimal parameter estimation filters .",
    "we generalize the conditional ensemble state of to @xmath154 where @xmath155})$ ] is the continuous conditional probability density .",
    "although the quantum filter provides an exact formula for the evolution of this density , calculating it is impractical , as one can not exactly represent the continuous distribution on a computer .",
    "the obvious approximation is to discretize the space of parameter values and then use the ensemble filter determined by ; indeed such an approach is very common in classical filtering theory and encompasses a broad set of monte carlo methods called particle filters @xcite .",
    "the inspiration for particle filtering comes from noting that any distribution can be approximated by a weighted set of point masses or _",
    "particles_. in the quantum case , we introduce a _ quantum particle _ approximation of the conditional density in as @xmath156 the approximation can be made arbitrarily accurate in the limit of @xmath157 . plugging this into , we recover precisely the form for the discrete conditional state given in .",
    "accordingly , the quantum particle filtering equations are identical to those of the ensemble filter given in .",
    "the only distinction here is in the initial approximation of the space of parameter values .",
    "thus the basic quantum particle filter simply involves discretizing the parameter space , then integrating the filter according to the ensemble filtering equations .",
    "the basic particle filter suffers from a degeneracy problem , in that all but a few particles may end up with negligible weights @xmath158 .",
    "this problem is even more relevant when performing parameter estimation , since the set of possible values for @xmath0 are fixed at the outset by the choice of discretization .",
    "even if a region in parameter space has low weights , its particles take up computational resources , but contribute little to the estimate of @xmath0 .",
    "more importantly , the ultimate precision of the parameter estimate is inherently limited by the initial discretization ; we can never have a particle whose parameter value @xmath66 is any closer to the true value @xmath0 than the closest initial discretized value .    in order to circumvent these issues",
    ", we adopt the kernel resampling techniques of liu and west @xcite .",
    "the idea is to replace low weight particles with new ones concentrated in high weight regions of parameter space .",
    "one first samples a source particle from the discrete distribution given by the weights @xmath159 , ensuring new particles come from more probable regions of parameter space . given a source particle",
    ", we then create a child particle by sampling from a gaussian kernel centered near the source particle . by repeating this procedure @xmath54 times",
    ", we create a new set of particles which populate more probable regions of parameter space . over time",
    ", this adaptive procedure allows the filter to move away from unimportant regions of parameter space and more finely explore the most probable parameter values .",
    "the details of the adaptive filter lie in parameterizing and sampling from the gaussian kernel . essentially , we are given a source particle , characterized by @xmath160 and @xmath161 , and using the kernel , create a child particle , characterized by @xmath162 and @xmath163 .",
    "one could attempt to sample from a multi - dimensional gaussian over both the parameter and atomic state components , but ensuring that the sampled @xmath163 is a valid atomic state would be non - trivial in general .",
    "there will be some cases , including the qubit example in the following section , where the atomic state is conveniently parameterized for gaussian resampling . but for clarity in presenting the general filter , we will create a child particle with the same atomic state as the parent particle .    under this assumption ,",
    "the gaussian kernel for parent particle @xmath85 is characterized by a mean @xmath164 and variance @xmath165 , both defined over the one dimensional parameter space .",
    "rather than setting the mean of this kernel to the parameter value of the parent , liu and west suggest setting @xmath166\\ ] ] where @xmath167 is the ensemble mean .",
    "the parameter @xmath168 is generally taken to be close to one and serves as a mean reverting factor .",
    "this is important because simply resampling from gaussians centered at @xmath66 results in an overly dispersed ensemble relative to the parent ensemble .",
    "the kernel variance is set to @xmath169\\ ] ] where @xmath170 is the ensemble variance and @xmath171 is the smoothing parameter .",
    "it is generally a small number chosen to scale with @xmath54 , so as to control how much kernel sampling explores parameter space .",
    "while @xmath168 and @xmath171 can be chosen independently , liu and west relate them by @xmath172 , so that the new sample does not have an increased variance .",
    "of course , it would be computationally inefficient to perform this resampling strategy at every timestep , especially since there will be many steps where most particles have non - negligible contributions to the parameter estimate .",
    "instead , we should only resample if some undesired level of degeneracy is reached . as discussed by arulampalam et al .",
    "@xcite , one measure of degeneracy is the effective sample size @xmath173 at each timestep , we then resample if the ratio @xmath174 is below some given threshold .",
    "we are not aware of an optimal threshold to chose in general , but the literature suggest @xmath175 as a rule of thumb @xcite .",
    "altogether , the _ resampling quantum particle filter _ algorithm proceeds as follows :    initialization : :    for @xmath176 :    +    1 .",
    "sample @xmath66 from the prior parameter distribution .    2 .",
    "create a quantum particle with weight    @xmath177 , parameter state    @xmath160 and    atomic state @xmath178 , where    @xmath179 is the known initial atomic state .",
    "repeat : :    for all time :    +    1 .   update the particle ensemble by integrating a timestep of the    filter given in .    2 .",
    "if @xmath174 is less than the target threshold ,    create a new particle ensemble :    +    resample ; ;      for @xmath176 :      +      1 .   sample an index @xmath85 from the discrete density      @xmath67 .      2 .",
    "sample a new parameter value @xmath180 from      the gaussian kernel with mean @xmath164 and variance      @xmath165 given by and .      3 .",
    "add a quantum particle to the new ensemble with weight      @xmath177 , parameter state      @xmath162      and atomic state @xmath181    unfortunately , checking asymptotic convergence of the filter is more involved in the continuous - valued case , as the observability and absolute continuity conditions require extra care in infinite dimensions .",
    "however , given that the quantum particle filter actually works on a discretized space , in practice we can simply use the results we had for the finite - dimensional case . as before , we note that one can generalize the quantum particle filter to multidimensional parameters by using a multi - dimensional gaussian kernel .",
    "one might also consider using alternate kernel forms , such as a regular grid which has increasingly finer resolution with each resampling stage .",
    "we will not consider such extensions here .",
    "we now consider a resampling quantum particle filter for the qubit magnetometer introduced earlier in the paper .",
    "as hinted at in the previous section , since the qubit state is parameterized by the continuous variable @xmath182 , we can easily resample both the magnetic field @xmath183 and state @xmath184 using a two - dimensional gaussian kernel for @xmath185 , with mean vector and covariance matrix given by generalizations of and .",
    "since different values of @xmath31 result in different state evolutions , resampling both the state and magnetic field values should result in child particles that are closer to the true evolved state .    } ) db$ ] for @xmath186 particle filter set with @xmath187 , @xmath188 , @xmath189 and resampling threshold of @xmath175 .",
    "the true magnetic field was @xmath140 . ]",
    "figure [ fig : densityplot ] shows a typical run of the quantum particle filter for @xmath186 particles .",
    "the true @xmath31 value was @xmath190 and the prior distribution over @xmath31 was taken to be uniform over the interval @xmath191 $ ] .",
    "as before , we used an it - euler integrator with a step - size of @xmath192 . note that both the timespan of integration and the potential values of @xmath31 range from @xmath193 to @xmath194 in our units .",
    "the resampling parameters were @xmath188 , @xmath189 and resampling threshold @xmath175 .",
    "note that we chose not to use liu and west s relation between @xmath168 and @xmath171 .    in order to generate the figure ,",
    "each particle s weight and parameter values were stored at 50 equally spaced times over the integration timespan .",
    "using matlab s ` ksdensity ` function , these samples were then used to reconstruct @xmath195 via a gaussian kernel density estimate of the distribution .",
    "the resulting kernel density estimate was then evaluated at 150 equally spaced @xmath31 values in the range @xmath191 $ ] , which we plotted as @xmath196 with @xmath187 . as is seen in the figure , after some initial multi - modal distributions over parameter space , the filter hones in on the true value of @xmath140 . for the simulation shown ,",
    "the final estimate was @xmath197 with uncertainty @xmath198 .",
    "the filter resampled 7 times over the course of integration .",
    "we have presented practical methods for single - shot parameter estimation via continuous quantum measurement . by embedding the parameter estimation problem in the standard quantum filtering problem ,",
    "the optimal parameter filter is given by an extended form of the standard quantum filtering equation .",
    "for parameters taking values in a finite set , we gave conditions for determining whether the parameter filter will asymptotically converge to the correct value .",
    "for parameters taking values from an infinite set , we introduced the quantum particle filter as a computational tool for suboptimal estimation . throughout",
    ", we presented numerical simulations of our methods using a single qubit magnetometer .",
    "our techniques should generalize straightforwardly for estimating time - dependent parameters and to a lesser extent , estimating initial state parameters .",
    "the binary state discrimination problem studied by jacobs @xcite is one such example and his approach is essentially a special case of our ensemble parameter filter .",
    "we caution that the utility of initial state or parameter estimation depends heavily on the observability and absolute continuity of the problem at hand .",
    "future extensions of our work include exploring alternate resampling techniques for the quantum particle filter and developing feedback strategies for improving the parameter estimate .",
    "more broadly , we believe there is much to be learned from classical control and parameter estimation theories ."
  ],
  "abstract_text": [
    "<S> we present filtering equations for single shot parameter estimation using continuous quantum measurement . by embedding parameter estimation in the standard quantum filtering formalism </S>",
    "<S> , we derive the optimal bayesian filter for cases when the parameter takes on a finite range of values . leveraging recent convergence results [ van handel , arxiv:0709.2216 ( 2008 ) ] , </S>",
    "<S> we give a condition which determines the asymptotic convergence of the estimator . for cases </S>",
    "<S> when the parameter is continuous valued , we develop _ quantum particle filters _ as a practical computational method for quantum parameter estimation . </S>"
  ]
}