{
  "article_text": [
    "biochemical reactions systems frequently comprise species with low copy numbers of molecules which leads to strong stochastic effects @xcite . under well - mixed and dilute conditions , the chemical master equation ( cme ) is the accepted description of the dynamics of such systems @xcite . for all but the most simple systems , however , no analytic solutions of the cme are known . the standard approach in this case is to use the stochastic simulation algorithm ( ssa @xcite ) , a popular monte - carlo method that samples from the solution of the cme .",
    "however , the ssa is computationally expensive and becomes infeasible for all but the smallest systems , in particular if some of the species occur in high molecule numbers with many reactions happening per unit time . while the derivation of a reduced cme enforcing time scale separation may help in some cases",
    "@xcite , analytical approximations are still an important alternative for the exploration of chemical systems .",
    "using the cme one can derive ordinary differential equations for the moments of the numbers of molecules of each species in the system .",
    "in general the equation for a given moment is coupled to the equations of higher order moments giving rise to an infinite hierarchy of equations which can not be solved @xcite . a popular method to approximate the moments of the cme are moment - closure approximations ( ma ) @xcite . the latter usually express moments above a certain order in terms of lower order moments , thereby closing the moment equations which",
    "can then be solved either analytically or numerically .",
    "several different moment - closure methods have been proposed in the literature .",
    "the most popular is the normal ma ( also called  cumulant neglect ma \" ) , which sets all cumulants above a certain order to zero , thus corresponding to a normal distribution @xcite .",
    "if all cumulants above order @xmath0 are set to zero we speak of the `` normal ma of order @xmath0 '' .",
    "several other mas have been proposed to close the moment equations ; some common types are the poisson ma @xcite , the log - normal ma @xcite and the central - moment - neglect ma ( cmn - ma ) @xcite .",
    "the purpose of this paper is twofold : ( i ) an empirical comparison of the predictions of different types of mas when applied to chemical reaction systems , and ( ii ) the presentation of a new user - friendly software package which enables the automatic derivation and analysis of mas .",
    "mas are an ad - hoc approximation and there is no straightforward way to predict their accuracy . while several different ma methods have been proposed @xcite and successfully applied @xcite in the literature , there are few studies analysing and comparing their performance . in @xcite",
    "the log - normal ma was found to be more accurate than the normal ma for a gene cascade network for one parameter set . in @xcite",
    "the accuracy of the normal ma has been investigated for general monostable systems in the limit of large volumes using the system size expansion .",
    "however , the accuracy of mas for small to intermediate volumes remains unknown and in particular how different ma methods perform with respect to each other .",
    "moreover , it is unknown under which conditions mas give physically meaningful results . in an empirical study @xcite formulated a set of validity conditions guaranteeing mas to give physically meaningful approximations to the moments of the cme .",
    "we will adopt these validity conditions here .",
    "specifically , whenever the cme has a stationary solution , we require the mas to have a single positive and globally attractive fixed point , and their time trajectories to stay non - negative and finite for all times and all initial conditions .",
    "in @xcite it was found that the normal ma fails to satisfy these validity conditions for certain systems and parameter regimes .",
    "it was shown that the normal ma can give rise to unphysical behaviour outside of this regime , such as negative mean values or variances , divergent time trajectories , unphysical oscillations and unphysical bistability , thus not allowing for a physical interpretation in these cases .",
    "it remains unclear if this is also the case for other moment - closure schemes and how their ranges in parameter space for which they are valid ( if they exist ) compare to each other .    in this article , we apply the normal , poisson , log - normal and cmn - mas to several chemical reaction systems .",
    "we confine our analysis to mas of second order , since these are the most used in practice .",
    "we study their qualitative behaviour in the sense of the validity conditions stated before and compare their quantitative accuracy with exact stochastic simulations @xcite .",
    "it should be stressed that `` validity '' and `` accuracy '' are not unrelated properties , since one can only speak of a method s accuracy when it gives physically valid results . yet",
    "physically meaningful results can be quantitatively highly inaccurate . therefore",
    ", `` validity '' is a necessary but not sufficient condition for `` accuracy '' . in this study",
    ", we first use the different ma methods to study stochasticity in a system whose large volume limit is deterministically bistable .",
    "next , we investigate how well the ma methods can capture the influence of noise in a protein - phosphorylation system whose deterministic system shows ultrasensitivity . and finally , we use the mas to study the role of stochasticity in a system whose deterministic system is oscillating and which becomes entrained by an external force for a finite time interval .",
    "the derivation of the moment equations from the cme and the subsequent application of moment - closures is conceptually a straightforward task .",
    "practically , however , it becomes extremely cumbersome if more than one species is involved and if one considers higher - order mas .",
    "suppose for example a system of three species for which we want to compute the fourth - order normal ma equations .",
    "taking symmetries into account , this leads to 34 moment equations which have to be derived from the cme .",
    "these will have to be closed , and several fifth - order moments ( and potentially higher - order moments ) will have to be replaced in terms of lower - order moments . obviously , this task quickly becomes unfeasible to do manually .",
    "moreover , the numerical analysis of ma equations is not straightforward , and there is no user - friendly software package available allowing non - expert users to derive and analyse mas .    to our knowledge , there are three software packages available in the literature for moment - closures : the matlab toolbox stochdyntools @xcite which allows the derivation of ma equations using several different closure schemes for mass - action chemical systems , i.e. , those with polynomial propensity functions ; the python package momentclosure @xcite which allows the same but only using the normal moment closure and has the facility to export the ma equations to a maple file for further analysis ; and a matlab toolbox presented in @xcite which allows to use normal moment closure to second order for mass - action chemical systems . for the application of all three packages , the user needs to be familiar with the respective programming language and the numerical analysis is not automated .    in this article we present the mathematica package moca ( moment - closure analysis ) which was used for the presented numerical analysis .",
    "moca significantly extends the applicability and functionality of the two software packages stochdyntools and momentclosure @xcite as well as the software package presented in @xcite .",
    "it allows the non - expert user to apply and compare different moment - closure schemes in a graphical user interface ( gui ) without any coding necessary .",
    "it implements the normal , poisson , log - normal and cmn - ma and in addition allows the user to define his own novel moment - closure schemes .",
    "it extends the applicability to reaction systems with non - polynomial or time - dependent propensity functions .",
    "these can either be functions in time or given by discrete time points , for example obtained from experiments .",
    "all functions are available either in a gui or as code version for more experienced users , making the usage of moca maximally flexible .",
    "moca can perform steady state analysis with parameter scans , numerically integrate the ma equations in time and allows to export tables and figures to various commonly used formats .",
    "this paper is structured as follows .",
    "section [ sec_methods ] introduces the theoretical background for general moment - closure schemes and defines the particular ma methods analysed in this work .",
    "the numerical analysis of the various mas is then presented in section [ sec_numerical_analysis ] .",
    "next , we introduce the software package moca in section [ sec_moca ] .",
    "we explain the user input format and demonstrate its capabilities .",
    "we finish by summarising our results and concluding in section [ sec_conclusion ] .",
    "consider a chemical reaction system with species @xmath1 ( @xmath2 ) and @xmath3 chemical reactions : @xmath4 here , @xmath5 is the rate constant of reaction @xmath6 .",
    "we define the elements of the stoichiometric matrix @xmath7 as @xmath8 under well - mixed and dilute conditions the dynamics of the system is governed by the chemical master equation ( cme ) @xcite : @xmath9 here , @xmath10 is the joint probability distribution at time @xmath11 , where @xmath12 is the state vector of the system and @xmath13 is the number of molecules of species @xmath1 .",
    "@xmath14 is the @xmath15th column vector of the matrix @xmath7 and @xmath16 is the propensity function of reaction @xmath15 . for reactions described by the law of mass - action , the propensity is polynomial and defined as @xcite : @xmath17 here",
    ", @xmath18 denotes the volume of the compartment in which the reaction occurs .",
    "if in addition @xmath19 , which basically means that not more than two molecules react which each other in a single reaction ( at most a second - order reaction ) , we call reaction @xmath6 an `` elementary reaction '' .",
    "higher - order reactions do not really occur under conditions found in living cells and although they can often give a useful description of a system , they should really be interpreted as an effective approximate description of a set of elementary reactions , valid only under certain conditions .",
    "multiplying with @xmath20 and summing over all @xmath13 @xmath21 leads to the time evolution equation of the moment @xmath22 : @xmath23 here , @xmath24 denotes the expectation with respect to @xmath10 .",
    "accordingly , the first two moments obey @xmath25.\\end{aligned}\\ ] ] we see that , unless all @xmath16 are a zeroth or first - order polynomial in @xmath26 , the evolution equation of a certain moment depends on higher order moments , i.e. , the equations are not closed .",
    "the idea underlying the class of moment - closure approximations studied in this work is to express all moments above a certain order @xmath0 as functions of lower - order moments .",
    "the latter is typically done by assuming the distribution of the system to have a particular functional form , for example a normal distribution .",
    "this decouples the equations of the moments up to order @xmath0 from higher - order moments , which then allows one to numerically integrate the moment equations .",
    "we refer to such a moment - closure as `` ma of order @xmath0 '' .",
    "let    @xmath27    denote the raw or `` normal '' moments , central moments and cumulants of order @xmath28 of the system , respectively .",
    "we call @xmath29 a `` diagonal moment '' if @xmath30 for all @xmath31 , and a `` mixed moment '' otherwise , and similarly for central moments and cumulants . in eq .",
    "@xmath32 is the cumulant generating function defined as @xmath33 we note that all three types of moments are respectively invariant under permutations of their indices .",
    "therefore , only one representative combination of each permutation class has to be considered .",
    "taking this symmetry into account significantly reduces the number of variables and moment equations .",
    "we adopt here the convention that the indices are ordered from small to large , i.e. , for a moment @xmath29 we have @xmath34 . expressing the moment - closure functions in terms of cumulants rather than raw moments",
    "often gives shorter expressions .",
    "the equations for the cumulants can then be rearranged to give equations for the raw moments .",
    "we consider here the following ma methods :    *  normal moment - closure \" ( also called  cumulant neglect moment - closure \" in the literature ) : all cumulants above order @xmath0 are set to zero , i.e. , @xmath35 *  poisson moment - closure \" : the cumulants of a one - dimensional poisson distribution are all equal to the mean value .",
    "we assume here the multi - variate distribution to be a product of uni - variate poisson distributions . accordingly , for the poisson ma of order @xmath0 we set all diagonal cumulants to the corresponding mean and all mixed cumulants to zero , i.e. , @xmath36 *  log - normal moment - closure \" : let @xmath37 and @xmath7 be the mean vector and covariance matrix of a multi - dimensional normal random variable",
    ". then the logarithm of the latter has a multivariate log - normal distribution and its moments can be expressed in terms of @xmath37 and @xmath7 as @xcite @xmath38 where @xmath39 , where @xmath40 is the number of @xmath41 s having the value @xmath42 .",
    "this allows to express @xmath37 and @xmath7 in terms of the first two moments @xmath43 and @xmath44 which then in turn allows to express higher - order moments in terms of the latter , too . *",
    " cmn moment - closure \" : all central moments above order @xmath0 are set to zero : @xmath45    each of the equations can then be used to express the raw moments above order @xmath0 in terms of lower order moments and thus close the moment equations according to the corresponding ma .",
    "we note that the normal ma , poisson ma and cmn - ma can be equivalent depending on the reaction system ( see later for examples of such systems ) .",
    "the normal moment - closure has been used in the field of biochemical reactions for example in @xcite and is probably the most commonly used one .",
    "it has been considered together with the poisson and log - normal ma for the one - dimensional stochastic logistic model in @xcite .",
    "the log - normal moment - closure technique has been proposed in @xcite . in @xcite",
    "it has been shown that the assumption of a log - normal distribution is equivalent to a  derivative matching \" closure .",
    "the cmn - ma has also been called a  low dispersion moment - closure \" in @xcite .      as an example , consider a reaction system of the michaelis menten type : @xmath46 where @xmath47 is the free enzyme , @xmath7 is the substrate , @xmath48 is the enzyme - substrate complex and @xmath49 the product .",
    "the sum of the numbers of @xmath47 and @xmath48 molecules is constant at all times since each enzyme is either in the free @xmath47 or complex @xmath48 state .",
    "let @xmath50 denote the total number of enzyme molecules .",
    "assuming mass - action kinetics , the propensity vector is given by @xmath51 where @xmath18 is the volume of the system and we have defined @xmath52 and @xmath53 . here ,",
    "@xmath54 and @xmath55 denote the copy number of substrate @xmath7 and free enzymes @xmath47 , respectively , and we have used the fact that the number of complex molecules @xmath48 is @xmath56 to eliminate the corresponding variable .",
    "the stoichiometric matrix is defined in eq .   and reads for system @xmath57 the corresponding cme is obtained by substituting eqs .   and in eq .",
    "leading to @xmath58 multiplying with @xmath59 and @xmath60 and summing over all @xmath54 and @xmath55 gives the following equations for the first two moments @xmath61 recall that the moments are invariant under index permutations and thus @xmath62 does not have to be considered explicitly .",
    "we see that the equations of the mean @xmath63 and @xmath64 depend on the second moment @xmath65 .",
    "the equation of the latter depends on the third moments @xmath66 and @xmath67 and similarly the equations for @xmath68 and @xmath69 .",
    "it can easily be seen that this applies also to all higher order moments , i.e. , the time - evolution equation of a moment of order @xmath28 depends on moments of order @xmath70 .",
    "therefore , the system of equations is not closed and can not be solved directly .",
    "now consider the normal ma which sets all cumulants above a certain order to zero .",
    "if we aim at closing the equations to second - order , we have to set the third - order cumulants to zero @xmath71 expressing the cumulants in terms of raw moments , this allows one to find expressions of the third - order moments in terms of first and second - order moments .",
    "for @xmath66 , for example , this reads @xmath72 and similarly for the other third - order moments . replacing the third - order moments accordingly in eqs .   -",
    "closes the equations .",
    "we give here the resulting equations transformed to central moments : @xmath73",
    "we recently formulated validity conditions guaranteeing physically meaningful predictions of ma approximations @xcite and analysed the validity of the normal ma for several example systems .",
    "we briefly review these conditions here . for a system for which the cme has a stationary solution",
    ", the exact moments of the system converge to a single steady - state in the limit of long times .",
    "therefore , for the mas to be valid moment approximations , we require convergence to a single steady - state in the limit of long times , too .",
    "moreover , the trajectories should preserve a positive mean and even central moments in the molecule numbers for all times and for all sensible initial conditions . note that this is also the case for deterministic bistable systems and deterministic oscillatory systems .",
    "if the cme converges to a stationary solution , the resulting moments are unique , even if the deterministic rate equations are bistable . moreover , while single ssa trajectories oscillate for a deterministic oscillatory system , the moments of the cme converge to fixed points because single ssa trajectories get out of phase over time .    in the following we",
    "analyse different mas with respect to these validity conditions and compare their quantitative accuracy with ssa simulations .",
    "in @xcite it has been shown that for the deterministic bistable schlgl model @xcite , the normal ma gives physically meaningful results only for an intermediate range of volumes . for smaller volumes",
    "it shows negative or diverging trajectories , while it becomes bistable for larger ones .",
    "the ssa , in contrast , has a globally attractive positive fixed point and non - negative time trajectories for all volumes . here , we study the stochastic properties of the minimal elementary reaction system whose rate equations show bistability @xcite @xmath74 we added the first reaction to the ones given in @xcite to prevent the stochastic system from having an absorbing state for zero molecule numbers . depending on the parameter values the deterministic rate equations become bistable for this system .",
    "all parameter sets used in this section are chosen such that this is the case .",
    "we assume mass - action kinetics here . since the reactions in eqs .",
    "- are of order two or lower , their rate functions are polynomials up to order two in the species variables .",
    "this means that the time evolution equations of the second - moments depend on the third - order moments , but not on higher - order moments .",
    "we thus have to express the third - order moments in terms of first and second - order moments to close the equations to second order .",
    "recall that the second - order normal and cmn - mas set all cumulants and central moments above order two to zero , respectively ( c.f .",
    "eqs .   and ) . since the third - order cumulant and third - order central moment are identical , the second - order normal ma and cmn - ma are thus equivalent for the reaction system in eq .",
    "this is of course a general result , i.e. , for chemical reaction systems with elementary reactions and mass - action kinetics ( i.e. , reactions up to order two and polynomial propensity functions ) , the second - order normal ma and second - order cmn - ma are identical .",
    "we thus analyse the normal , poisson and log - normal ma here .       on log - scale obtained from steady - state analysis for the bistable reaction system in eqs .",
    "- for the parameters @xmath75 and @xmath76 .",
    "we shift the points slightly to make coinciding points distinguishable .",
    "we find that all three mas give a physical result of a single positive stable fixed point only on an intermediate range of volumes .",
    "the latter is significantly smaller for the log - normal ma than for the normal and poisson mas . ]",
    "qualitatively , we find a similar behaviour for the three different ma methods .",
    "as for the bistable system analysed in @xcite using the normal ma , we find that there exists an intermediate regime of volumes for the three mas to be valid , i.e. , they have a single globally attractive positive fixed point , and we find that the moments become bistable ( and hence physically meaningless ) above this regime .",
    "interestingly , however , we find that when increasing the volume further all three mas become tristable , i.e. , have three positive stable fixed points , see figure [ fig_bistable_number_of_fixed_points ] .",
    "this means the mas have more positive stable fixed points than the rate equations here , the latter being bistable independent of the volume , and thus the mas have no physical interpretation anymore whatsoever .",
    "in @xcite it has been shown that for monostable systems , the normal ma becomes equivalent to the rate equations for the means in the limit of large volumes .",
    "one can easily show that the result also applies to the poisson , log - normal and cmn - ma .",
    "here , we find numerically that the tristability remains for volumes up to @xmath77 , which suggests that the convergence of the mas to the res in the limit of large volumes does not hold for deterministic bistable systems .",
    "figure [ fig_bistable_time_course ] shows the time trajectories for the mas for different volumes , verifying that the mas can indeed have one , two or three positive stable fixed points depending on the volume .     and different initial conditions for the parameters @xmath75 and @xmath76 .",
    "the dashed and dotted lines indicate the respective positive and stable fixed points of species @xmath49 and @xmath78 . depending on the volume , the mas have one , two or three positive stable fixed points . ]",
    "the table in figure 3 lists the endpoints of the validity interval for the mas for ten different parameter sets on logarithmic scale .",
    "the figure below visualises these .",
    "we observe that the log - normal ma has a much smaller validity range than the other two mas .",
    "the normal and poisson ma most of the time have a similar upper bound while the lower bound is generally smaller for the poisson ma .",
    "we thus find that in terms of validity , the log - normal ma performs significantly worse than the other two ma schemes for the reaction system studied here .",
    "[ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^ \" , ]      on logarithmic scale for different parameter sets for the bistable reaction system in eqs .  - .",
    "@xmath79 and @xmath80 denote the left and right end of the validity interval , respectively .",
    "we have only checked for fixed points down to a volume of @xmath81 . the term",
    " @xmath82 \" thus indicates that the lower boundary of the corresponding validity interval is smaller than @xmath81 .",
    "bottom : visualisation of the validity interval on logarithmic scale in the volume for the same ten parameter sets as used in the table . for a lower bound smaller than @xmath81",
    "the lines have an arrow pointing to the left we find that the log - normal ma s range of validity is significantly smaller than that of the normal and poisson mas . ]    [ table_bistable ]      we next compare the prediction of the different ma schemes and of the rate equations for the mean copy numbers of species @xmath49 and species @xmath78 in steady state with results obtained from exact stochastic simulations using the ssa .",
    "the latter have been performed using the software package ina @xcite .",
    "figure [ fig_bistable_deviation_species_x ] shows the mean values of species @xmath49 as a function of the volume for the ten parameter sets used in figure 3 .",
    "the corresponding figures for species @xmath78 look very similar and are not shown here .",
    "the result is divided by the corresponding ssa result .",
    "the range of volumes shown corresponds roughly to the validity range of the normal and poisson ma .",
    "we observe here again that the mas become bistable for larger volumes and that the validity interval of the log - normal ma is significantly smaller than the one of the normal and poisson ma .",
    "we find that the mas overestimate the mean copy numbers and that the deviation from the ssa result increases for decreasing volumes .",
    "where two or all three mas are valid and thus comparable , the accuracy is similar with the log - normal ma being slightly more accurate than the other two and the normal ma being slightly more inaccurate than the poisson ma .",
    "note , however , that for most parameter sets the log - normal ma s range of validity is significantly smaller than that of the other mas .    for large volumes , the mas have two positive stable fixed points converging to the two positive stable fixed points of the rate equations .",
    "the exact result obtained from ssa simulations agrees with the larger of these two fixed points .",
    "the third fixed point of the mas for large volumes seems to always lie between the two of the rate equations .",
    "while it lies exactly in the middle for the normal and poisson ma , it is very close to the lower one for the log - normal ma .",
    "we find the same behaviour for all parameter sets .",
    "note though that this can not be seen for all parameter sets in figure [ fig_bistable_deviation_species_x ] due to the small plot range .     on logarithmic scale for the bistable reaction system in eqs .",
    "the parameter sets are the same as in the table in figure 3 .",
    "the values are divided by the corresponding result obtained from stochastic simulations using the ssa .",
    "the horizontal dashed line thus indicates the exact value . for the ssa result @xmath83 samples were simulated for each point . ]      next , we study an enzyme catalysed protein - phosphorylation system with the reactions @xmath84{\\quad",
    "a_1 \\quad } e_1p \\xrightarrow{\\quad k_1 \\quad } p^ * + e_1 , \\\\",
    "\\label{reactions_ultra2 }     & p^ * + e_2 \\xrightleftharpoons[\\quad d_2",
    "\\quad]{\\quad a_2 \\quad } e_2p^ * \\xrightarrow{\\quad",
    "k_2 \\quad } p + e_2.\\end{aligned}\\ ] ] this system shows ultrasensitivity for certain parameter values @xcite , namely when the enzymes are saturated , i.e. , most enzymes are on average in the complex state . here ,",
    "@xmath85 and @xmath86 denote the non - phosphorylated and phosphorylated forms of the protein , respectively , @xmath87 and @xmath88 the phosphorylating and de - phosphorylating enzymes , respectively , and @xmath89 and @xmath90 the respective protein - enzyme - complexes . in @xcite",
    "the authors studied the dependence of the ratio of phosphorylated to non - phosphorylated proteins as a function of @xmath91 with @xmath92 and @xmath93 in a deterministic system , where @xmath94 and @xmath95 are the conserved total numbers of the respective enzymes in the system . assuming a hill - type response curve , the corresponding hill coefficient is often used to quantify the steepness of the response .",
    "the authors here speak of an  ultrasensitive response \" whenever the response is steeper than a michaelis - menten response , i.e. , has a hill coefficient of larger than unity .",
    "we study here the effect of noise on the ultrasensitive response and again compare moment - closure results with ssa simulations .",
    "the latter have been performed using the software package ina @xcite .",
    "first , however , we describe a surprising non - uniqueness of the poisson and log - normal ma and study the validity of the different ma schemes . as we have explained below eq .",
    ", the second - order normal and second - order cmm - ma are identical for elementary reaction systems with mass - action kinetics . since this is the case here , we study the normal , poisson and log - normal mas in the following .      the studied reaction system in eqs .   and has six species : @xmath96 , and three conservation laws : the total number of proteins and the total numbers of the respective enzymes , i.e. , @xmath97 , @xmath98 and @xmath99 , are conserved , where we use the symbol for the species also as the corresponding molecule number variable in a slight abuse of notation .",
    "the conservation laws allow one to reduce the system to three variables , which is obviously of computational advantage .",
    "there are two ways of obtaining the reduced moment - closure equations : arguably , the standard approach would be to start from the reduced cme , compute the reduced moment equations and subsequently apply the moment closure .",
    "alternatively , one may start from the full cme , compute the moment - closure equations and afterwards reduce the equations by taking the conservation laws into account .",
    "one may expect , or require , the two approaches for a sensible moment - closure scheme to be equivalent .",
    "it is easy to show that this is indeed the case for the normal and cmn moment - closures .",
    "however , we find here that this is not the case for the poisson and log - normal ma .",
    "we thus conclude that _ the poisson and log - normal mas are generally not uniquely defined if one reduces a system according to conservation laws in molecule numbers _ , a clear flaw of these methods .",
    "the reason for the non - uniqueness of the ma equations is that while the moment - equations depend on _ diagonal _ higher - order moments if one starts from a reduced cme , no such dependence is found if the ma equations are derived from the full cme . while the normal and cmn - mas treat diagonal and non - diagonal moments equivalently , the poisson and log - normal mas do not do so , thus leading to the issue of non - uniqueness .",
    "we explain this in more detail in appendix a.    one consequence of this non - uniqueness is that certain symmetries of the system are broken .",
    "looking at the reaction system in eqs .",
    "and one sees that the system is symmetric under exchanging species labels and reaction constants , @xmath100 and @xmath101 and @xmath102 and @xmath103 .",
    "this means that for @xmath104 and @xmath105 the mean values of @xmath85 and @xmath86 , @xmath87 and @xmath88 , as well as @xmath89 and @xmath106 should be respectively equal .",
    "we find that this is indeed the case for the normal and cmn moment - closure , and also for the poisson and log - normal mas if one derives the equations starting from the full cme . if one applies the poisson and log - normal mas to the reduced cme , however , _",
    "they do break the symmetry_.    we conclude that one should be careful when using the poisson or log - normal ma for systems with conservation laws . in case",
    "the mas are non - unique it is favourable to first derive the mas before applying the conservation laws . in the following",
    "we will study the opposite cases , i.e. , if the poisson and log - normal ma are applied to the reduced cme , which would be normally the standard approach .      as in @xcite",
    "we define @xmath92 and @xmath93 .",
    "the authors in @xcite studied the dependence of the fraction of the protein number in the phosphorylated state as a function of @xmath91 using deterministic rate equations .",
    "the authors call this response  ultrasensitive \" whenever it is steeper than michaelis - menten response , meaning a hill - coefficient larger than one . here",
    ", we would like to study the effect of noise on the response and investigate how different moment - closures perform for this system .",
    "to this end , we compute the mean value of the phosphorylated protein @xmath86 in steady state using the different methods of the protein on a grid in @xmath91 with all the other parameters fixed and fit a hill function @xmath107 to the result , where @xmath108 and @xmath109 are the dissociation constant and the hill - coefficient , respectively .     for the protein phosphorylation system in eqs .   and",
    "the blue and orange curve are hill - functions fitted to the points of the re and normal ma , respectively .",
    "the poisson and log - normal mas have only few positive stable fixed points in the response region making a sensible fit impossible .",
    "the used parameters are @xmath110 and @xmath111 , where @xmath112 and @xmath113 are the total number of enzyme @xmath87 , the total number of enzyme @xmath88 and the total number of proteins in the system , respectively . for the ssa result @xmath83 samples were simulated for each point . ]",
    "we find that the normal ma and rate equations are valid for all @xmath91 for all chosen parameter sets , whereas the poisson and log - normal ma are not for certain parameter regimes , i.e. , they do not always have a positive stable fixed point .",
    "figure [ fig_ultra_example ] visualises the fitting procedure for one parameter set .",
    "while the rate equations and normal ma are stable on the whole considered response region in @xmath91 , the poisson and log - normal mas are unstable for the major part of the region .",
    "we obtain only one and two values in the response region , respectively .",
    "the poisson and log - normal mas thus do not allow a sensible estimate of the response - steepness via a fit of a hill - function .     and of @xmath91 for the protein phosphorylation system in eqs .",
    "and for five different parameter sets . if we write @xmath114 with @xmath115 , @xmath116 and @xmath117 , where @xmath113 is the total protein number and @xmath18 is the volume , the parameter sets are given by set  1 = @xmath118 , set  2 = @xmath119 , set  3 = @xmath120 , set  4 = @xmath121 and set  5 = @xmath122 .",
    "the blue regions indicate that the methods have no positive stable fixed point .",
    "the yellow regions indicate where a positive stable fixed points exists _ and _ the time trajectories converge with initial condition being the fixed point of the rate equations .",
    "the green regions show where the time trajectories diverge despite the existence of a positive stable fixed point , which means that the fixed point is only locally attractive . ]",
    "figure [ fig_ultra_validity ] visualises the validity of the rate equations , normal , poisson and log - normal mas as a function of the total enzyme number and @xmath91 for five different parameter sets .",
    "the figure indicates where the methods have a positive stable fixed point and where not .",
    "in addition , when a positive stable fixed points exists , we solve the time - dependent mas with the initial condition being the fixed point of the rate equations for the corresponding parameters , and the figure indicates the regions where these diverge despite the existence of a positive stable fixed point .",
    "this thus indicates the sensitivity of the different methods to initial conditions . while the rate equations and normal ma are stable and the time trajectories converge everywhere , the poisson and log - normal ma do so only in subregions of the parameter space .",
    "note that we do not make any statements about _ unstable _ fixed points here since we investigated the convergence of time - trajectories only for one fixed initial condition .",
    "the divergence of the time - trajectories in the green region suggest that there exists an unstable positive fixed point , but the same might be true in some parts of the yellow region despite the convergence of time - trajectories .    in conclusion , we find that the normal ma performs significantly better than the poisson and log - normal ma for the studied system in terms of validity .",
    "for the protein phosphorylation system in eqs .   and .",
    "the ssa result is shown as a solid black line . as explained in the main text , for some parameter values the poisson and log - normal ma do not allow to estimate a hill function due to instability . in such cases",
    "we set the hill coefficient to zero .",
    "for the ssa result @xmath83 samples were simulated for each point . ]    next , we compare the hill coefficient obtained from the different methods with the results obtained from ssa simulations as a function of the total enzyme number @xmath123 for the five parameter sets defined in the caption of figure [ fig_ultra_validity ] .",
    "the ssa simulations were performed using the software package ina @xcite . if a method did not allow to estimate a hill coefficient for some @xmath123 we set the corresponding value to zero .",
    "figure [ fig_ultra_hill ] illustrates the results .",
    "first of all , we find that the rate equations overestimate the hill coefficient for all @xmath123 , with a larger deviation for small @xmath123 , which means that the noise in the system significantly reduces the steepness of the response . for small @xmath123",
    "the hill coefficient estimated from the rate equations becomes up to four times larger then the ssa result ( set 4 in figure [ fig_ultra_hill ] ) . whenever they allow to estimate a hill coefficient , the moment - closure approximations are more accurate than the rate equations .",
    "while the normal and poisson mas underestimate the response , i.e. , overestimate the influence of noise , the log - normal overestimates the response .",
    "accuracy wise the three methods perform very similar , the poisson ma perhaps being slightly more accurate than the other two .",
    "however , this slightly higher accuracy of the poisson ma does not overcome its disadvantage of instability described in section [ sec_ultra_validity ] .",
    "next , we study the brusselator , a well known deterministic oscillating chemical system given by @xcite @xmath124{\\quad c_3 \\quad } x.\\end{aligned}\\ ] ] depending on the parameter values , the deterministic rate equations show sustained oscillations , damped oscillations or overdamped oscillations .",
    "single ssa trajectories may show sustained oscillations , while ensemble averages of the ssa always show damped or overdamped oscillations due to the dephasing of independent trajectories .",
    "therefore , a ma can only be interpreted as a valid moment approximation if its trajectories show damped or no oscillations . in @xcite",
    "it has been shown that for a parameter set for which the system in eq .",
    "is a deterministic oscillator , the normal ma is valid only for an intermediate range of volumes , with unphysical sustained oscillatory trajectories for larger volumes and either oscillatory or otherwise unphysical trajectories ( i.e. , divergent or negative trajectories ) for smaller volumes . here , we want to first study the validity of the different ma methods for different parameter sets , and then analyse their behaviour if the system becomes entrained by an external force .",
    "note that the first reaction in is trimolecular , which means that the corresponding propensity function is of third order in the molecule numbers ( c.f .",
    "the time - evolution equation of the second - order moments thus depend on the third and fourth - order moments ( c.f .",
    "therefore , since the fourth - order central moments and fourth - order cumulants are not identical ( in contrast to the third - order ones ) , the normal and cmn - mas are not equivalent for the reaction system in and we thus analyse all four mas separately in the following .",
    "( blue line ) and @xmath78 ( orange line ) for several volumes for the brusselator system in eq .   for the parameters @xmath125 .",
    "the blue and red curve denote the mean of species @xmath49 and species @xmath78 , respectively .",
    "while the normal , poisson and cmn - mas give physically meaningful results , i.e. , damped oscillations , for an intermediate range of volumes , the log - normal ma fails to do so for all volumes . to minimise the possibility of numerical effects we computed the shown results using the ode integration methods  adams \" ,  backward differentiation formula \" ,  explicit runge kutta \" ,  implicit runge kutta \" ,  explicit midpoint \" and  stiffness switching \" and varied the step sizes over several orders or magnitude , all giving the same results . ]",
    "we study here the validity of the mas for three different parameter sets defined in the caption of figure [ brusselator_validity_line_plot ] .",
    "similar to the findings in @xcite , we find that all four mas are only valid on an intermediate regime of volumes . however , unexpectedly , for the log - normal ma we can not find such a regime .",
    "figure [ brusselator_time_validity ] shows the time trajectories of the moments for the different mas for four different volumes for one fixed parameter set . while the normal , poisson and cmn - mas diverge for small volumes ,",
    "are monostable for intermediate volumes and show sustained oscillations for large volumes , the log - normal switches directly from divergent to oscillatory behaviour .",
    "we estimated the range of validity for the three different parameter sets for fixed initial conditions of unity for the mean values of both species and zero variance .",
    "figure [ brusselator_validity_line_plot ] shows the ranges of validity on logarithmic scale in the volume . while the poisson and normal ma have a finite range of volumes where they lead to physically meaningful results for all parameter sets , the cmn - ma has a vanishing one for one parameter set and the log - normal for all parameter sets .     in logarithmic scale .",
    "the used parameters for @xmath126 are set  1 @xmath127 , set  2 @xmath128 and set  3 @xmath129 . if the range of validity has length zero we plot a single point at zero . by ",
    "range of validity \" we mean the range of volumes for which the mas give physically meaningful ( i.e. , non - negative and converging ) time - trajectories . ]      in systems biology it is frequently of interest to study systems where one or several propensity functions are time - dependent .",
    "for example , circadian oscillators are often modelled by a deterministic oscillatory system with an imposed periodic propensity function modelling the influence of an external light input @xcite . here , we want to study the performance of the different ma schemes for such a system in the stochastic setting . to this end , we modify the rate constant @xmath130 of the second reaction in eq .   such that it varies over time from @xmath131 to @xmath132 times the chosen mean value in a sinusoidal way , i.e. , @xmath133 where @xmath134 is the fixed mean value of @xmath130 and the frequency @xmath135 of the sine curve is chosen to be the oscillation frequency of the deterministic system . after ten periods ,",
    "we switch off the time dependence and fix @xmath130 to its mean value . since we have a time - dependent propensity function here",
    ", we can not use the ssa to simulate the system .",
    "we therefore use extrande , a recently developed exact mc method to sample from the solution of cmes with time - dependent rate functions @xcite .",
    "figure [ brusselator_entrainment ] shows the time trajectories for the rate equations , extrande simulations and the different ma methods .",
    "we find that the rate equations show sustained oscillations after entrainment , while the extrande results show damped or overdamped oscillations .",
    "the normal and poisson ma behave qualitatively the same way as the extrande and are thus valid moment approximations for the chosen parameter values .",
    "quantitatively they differ quite significantly from the extrande result , however .",
    "they underestimate the mean values , show oscillations with larger amplitudes during entrainment and a weaker damping after entrainment .",
    "looking at figure [ brusselator_entrainment ] one finds that these effects are stronger for the respective smaller volume for each parameter set .",
    "the normal and poisson ma thus _ underestimate _ the influence of noise here . the log - normal and cmn - mas fail everywhere to provide a physical result . for the the former this",
    "may to be expected , since it also failed to do so in the case without entrainment .",
    "interestingly , however , the cmn - ma is invalid even for parameters for which it is valid in the case without external input .",
    "overall , the normal and poisson ma seem to perform significantly better for this system than the log - normal and cmn - ma .",
    "with entrainment for two different volumes for each parameter set .",
    "the blue and orange lines denote the mean values of species @xmath49 and @xmath78 , respectively . the external input gets switched on at time @xmath136 and switched off after ten oscillation periods of the deterministic system ( which depends on the given parameter set ) . while the normal and poisson mas give physically meaningful results ( i.e. , non - negative and converging time - trajectories ) for an intermediate range of volumes , the log - normal and cmn - mas fails to do so for all volumes . for the extrande result we simulated @xmath137 samples for set 1 and @xmath83 samples for set 2 and set 3 , respectively . ]",
    "the mathematica package moca implements the investigated four moment - closure approximations , as well as deterministic rate equations , in a graphical user interface and is freely available in the supplemental material @xcite .",
    "in contrast to other available moment - closure software packages @xcite , moca does not only derive the closure equations but also automatically performs numerical analysis of the derived equations , making the methods available to non - expert users .",
    "the results are automatically visualised and can be exported to various formats .",
    "moca extends the applicability over existing moment - closure packages to    * non - polynomial propensity functions * time - dependent propensities functions * propensities defined on discrete time points ( e.g. measured fluctuating external parameter )    note that while non - polynomial propensities can often give a useful description of a system , they should really be interpreted as an effective approximate description of a set of elementary reactions , valid only under certain conditions @xcite . for these type of propensities",
    "the software applies a taylor expansion of the propensity around the mean value to a specified order as proposed in @xcite .",
    "these different features make moca applicable to virtually any reaction system with arbitrary propensity functions .",
    "in addition to the different moment - closure methods described above , moca allows the user to define his own moment - closure method , providing an easy way to develop novel moment - closure schemes .",
    "and the rate constants @xmath138 into the parameters @xmath139 as defined below eq .  . ]      to use the package , the file moca.m needs to be placed in the same folder as the mathematica notebook that will be used for the analysis",
    "figure [ input1 ] shows an example input for the corresponding notebook for the reaction system defined in .",
    "the first two lines , which set the path and load the package , respectively , have to be executed without any modification .",
    "next , the number of species and the stoichiometric matrix have to be specified and assigned to the variables * ns * and * stochmatrix * , respectively , as depicted in the third and fourth line in figure [ input1 ] . the propensity vector and stoichiometric matrix",
    "are given in eqs .   and , respectively .",
    "the number of species * ns * has to be equal to the number of rows of * stochmatrix*. next , the parameter vector * parameters * and the propensity vector called * propensity * need to be specified , as done in the fifth and sixth input lines in figure [ input1 ] .",
    "the species variables have to be denoted by an  @xmath140 \" with the species index as a subscript .",
    "all terms in the propensity function that are not species variables or numerical values have to be listed as parameter in * parameters*. this is all the input needed if dealing with time - independent propensity functions and when using the gui .",
    "note that the propensities do not need to be of mass - action , i.e. , polynomial type , they can have any analytical form .    for using the coding version of moca , deterministic rate equations and time - dependent propensity functions , as well as for the definition of moment - closures , see the corresponding tutorial files in the supplemental material @xcite .",
    "the command * steadystate * has to be evaluated in the notebook for the gui to appear .",
    "the user can choose the closure method , closure order , expansion order and specify parameter values .",
    "for changes to apply the user needs to press the little  update button \" in the top right corner . ]",
    "there are four functions available to be used within a gui .",
    "they simply need to be typed into the notebook and evaluated to open the corresponding gui :    * * deriveequations * : derives the ma equations for central moments for general parameters and allows to assign numerical values to the parameters . * * steadystate * : numerically searches for positive and stable fixed points of the ma equations . * * steadystatevaryparameter * : same as * steadystate * but with one parameter varied over a grid specified by the user .",
    "the resulting table can be exported into a  csv \" ( `` comma - separated values '' ) file . * * timetrajectory * : solves ma equations numerically in time for numerical parameter values and plots the result .",
    "the result can be exported as a figure to various formats or evaluated on a grid in time and stored in a ",
    "csv \" file .",
    "figure [ analysis_mm_equations ] shows the gui that appears after typing and evaluating * deriveequations*. the user can interactively choose a moment - closure method , the closure order as well as the expansion order . by  expansion order \" we mean the expansion of the propensity functions around the mean value as proposed in @xcite .",
    "this is only necessary for non - polynomial rate functions . for exclusively polynomial rate functions ,",
    "the expansion does not make a difference as long as its order is equal to or higher than the maximum order of the propensity polynomials . finally , it is possible to assign numerical values to the parameters .",
    "the equations only become updated when the small  update bottom \" in the top right corner is clicked .",
    "this is also true for the functions described in the following , i.e. , changes in the input are only applied after clicking the  update bottom \" .",
    "the function * steadystate * allows to numerically compute positive stable fixed points of the ma equations .",
    "it has the same input parameters as the function * deriveequations * described before , with the difference that the parameters have an initial numerical value .",
    "for some parameter values , the method can not find a positive and stable fixed point .",
    "however , this does not necessarily mean that the numerical algorithm fails .",
    "in @xcite it has recently been shown that ma equations can indeed have no positive and stable fixed point for certain bimolecular reaction system ( even though the ssa and rate equations do have positive stable fixed points ) .",
    "the authors also showed that mas can have more than one positive stable fixed point , in which case * steadystate * function may give more than one result .",
    "the function * steadystatevaryparameter * also searches for positive stable fixed points but varies a user specified parameter over a user specified grid .",
    "the corresponding gui is shown in figure [ analysis_mm_ss_grid ] .",
    "the resulting table can be exported to a text file in  csv \" format to the same folder where the notebook is located .        the final function * timetrajectory * solves the ma equations numerically in time and plots the result .",
    "figure [ analysis_mm_time ] shows the corresponding gui .",
    "in addition to method specifications and values for parameters , the user can specify initial conditions for the mean values of the species ( higher order central moments are set to zero initially , i.e. , deterministic initial conditions ) , the final time point and the plot order specifying up to which order moments should be plotted .",
    "the result can either be exported as a figure to various formats or into a ",
    "csv \" text file where the solution is evaluated on a time grid with user specified time spacing @xmath141 .",
    "the gui commands described above are also available as mathematica functions allowing more experienced mathematica users a more flexible application of the methods .",
    "see the example files in the supplemental material @xcite for details on how to use these functions .",
    "in this paper , we compared the second - order normal , poisson , log - normal and cmn - mas for several reaction systems with respect to their qualitative behaviour ( if they give physically meaningful results ) and their quantitative accuracy ( how well they approximate results obtained from exact stochastic simulations ) whenever they give physically meaningful results . while we found no significant difference in quantitative accuracy between the four mas , the ranges in parameter space for which the mas gave physically meaningful results were significantly larger for the normal ma suggesting that the normal ma is favourable over the other studied mas .",
    "we emphasise that the presented results are exclusively based on numerical analysis and although we confirmed the results for a wide range of parameter sets and several example systems , we can not expect them to hold in general for all parameter sets or chemical reaction systems . in @xcite for example , it has been found for a single parameter set for one chemical reaction system that the log - normal ma is significantly more accurate than the normal ma .",
    "however , for non - linear systems , our results suggest that the mas give physically meaningful results only above a certain critical volume if the system is deterministically monostable , and only for intermediate volumes if the system is not deterministically monostable .    by",
    " physically meaningful \" we mean the validity conditions proposed in @xcite which are : ( i ) the mean values and even central moments of a system should stay non - negative and finite for all times and they should converge to a steady state whenever the cme has a steady state solution , ( ii ) the moments are unique in the sense that the same steady - state moments can be reached from all initial conditions , and ( iii ) the moments do not exhibit sustained oscillations in the limit of long times ( unless there is an external time - dependent input ) . in @xcite it has been found that the normal ma does not satisfy ( i ) for small volumes for several non - linear reaction systems , and that it does not satisfy conditions ( ii ) and ( iii ) for large volumes for deterministic bistable and oscillatory chemical systems , respectively .    here , we performed a similar analysis for four different ma methods .",
    "we first studied a deterministically bistable system , i.e. , a system whose rate equations have two positive stable fixed points .",
    "interestingly , we find that the mas have _ three positive stable fixed points _ for large volumes , thus allowing no physical interpretation .",
    "surprisingly , we found that , for an enzyme - catalised reaction , _ the poisson and log - normal mas were not uniquely defined_. our analysis suggests that this may indeed be generally the case for systems with conservation laws , a flaw not shared by the other two mas .",
    "finally , we studied a deterministically oscillatory system with and without an external periodic input . in both cases we found that the normal and poisson mas are valid only for an intermediate range of volumes , becoming unstable for smaller volumes and undergoing unphysical sustained oscillations for larger volumes . curiously",
    ", the cmn - ma behaves like this only for some of the studied parameter sets , and the log - normal for none of these , i.e. , _ there is no range of volumes where the latter two mas give physically meaningful results_.    in conclusion , our results taken together do not favour one ma over the others in terms of accuracy , but suggest that the normal ma is favourable over the other mas , in the sense that the range of parameter space where it gives physically meaningful results is considerably larger than that of the other mas .    finally , we presented the software package moca which was used for the numerical analysis of the various mas .",
    "moca allows one to derive and analyse moment - closure approximations for systems with polynomial , non - polynomial as well as time - dependent propensities .",
    "moca implements the  normal \" or  cumulant - neglect \" , the  poisson \" , the  log - normal \" and the  cmn \" closures as well as user - defined moment - closure schemes and automatises the numerical analysis .",
    "it allows non - expert users to apply moment - closure methods in a user - friendly graphical user interface .",
    "g.s . acknowledges support from the european research council under grant mlcs 306999 .    10 r. grima and s. schnell , essays biochem . *",
    "45 * , 41 ( 2008 ) .",
    "d. t. gillespie , annu .",
    "phys . chem . *",
    "58 * , 35 ( 2007 ) .",
    "d. t. gillespie , j. phys .",
    "chem . * 81 * , 2340 ( 1977 ) .    c. a. gmez - uribe , g. c. verghese , and a. r. tzafriri , j. chem .",
    "phys . * 129 * , 244112 ( 2008 ) .",
    "d. t. gillespie , y. cao , k. r. sanft , l. r. petzold , j. chem .",
    "phys . * 130 * , 064103 ( 2009 ) .",
    "d. a. mcquarrie , j. app . prob . * 4 * , 413 ( 1967 ) .",
    "r. grima , j. chem .",
    "phys . * 136 * , 154105 ( 2012 ) .",
    "l. ferm , p. ltstedt and a. hellander , j. sci . comput . * 34 * , 127 ( 2008 ) . m. ullah and o. wolkenhauer , j. theor",
    ". biol . * 260 * , 340 ( 2009 ) . c. a. gomez - uribe and g. c. verghese , j. chem",
    ". phys . * 126 * , 024109 ( 2007 ) .",
    "a. ale , p. kirk and m. p. h. stumpf , j. chem .",
    "* 138 * , 174101 ( 2013 ) .",
    "i. nasell , theor .",
    ". biol . * 64 * , 233 ( 2003 ) .",
    "m. j. keeling , j. theor . biol . * 205 * , 269 ( 2000 ) . j. hespanha , proceedings of the 3rd international symposium on communications , control and signal processing ( ieee ) * 142 * , 2063 ( 2008 ) .",
    "a. singh , and j. p. hespanha , decision and control , 2006 45th ieee conference on .",
    "ieee , 2006 .",
    "e. lakatos , a. ale , p. kirk , and m. p. h. stumpf , j. chem . phys .",
    "* 143 * , 094107 ( 2015 ) .",
    "p. milner , c. s. gillespie and d. j. wilkinson , stat .",
    "* 23 * , 287 ( 2013 ) . c. zechner et al .",
    "usa * 109 * , 8340 ( 2012 ) .",
    "a. singh , and j. p. hespanha , ieee trans autom control * 56 * , 414 ( 2011 ) .",
    "d. schnoerr , g. sanguinetti , r. grima , j. chem . phys .",
    "* 141 * , 084103 ( 2014 ) .",
    "j. hespanha .",
    "stochdyntools - a matlab toolbox to compute moment dynamics for stochastic networks of bio - chemical reactions .",
    "available at http://www.ece.ucsb.edu/  hespanha , 2007 . c. gillespie , iet systems biology * 3 * , 52 ( 2009 ) .",
    "p. azunre , c. gmez - uribe , and g. verghese , iet systems biology * 5 * , 325 - 335 ( 2011 ) .",
    "n. g. van kampen , _",
    "stochastic processes in physics and chemistry _ ( elsevier , 2007 ) .",
    "e. l. crow and k. shimizu , eds . _",
    "lognormal distributions : theory and applications .",
    "_ ( new york : dekker , 1988 ) .",
    "f. schlgl , z. phys .",
    "* 253 * , 147 ( 1972 ) .",
    "t. wilhelm , bmc systems biology * 3 * , 90 ( 2009 ) .",
    "p. thomas , h. matuschek and r. grima , plos one * 7 * , e38518 ( 2012 ) .",
    "a.goldbeter and d. e. koshland , proc . natl",
    ", * 78 * , 6840 ( 1981 ) .    i. prigogine and r. lefever , j. chem . phys .",
    "* 48 * , 1695 ( 1968 ) .",
    "r. lefever , g. nicolis and p. borckmans , j. chem .",
    ", faraday trans . 1 * 84 * , 1013 ( 1988 ) .",
    "p. o. westermark et al .",
    ", plos comput biol * 5 * , 1000580 ( 2009 ) . c. troein et al . ,",
    "the plant journal * 66 * , 375 ( 2011 ) .",
    "g. kurosawa , a. goldbeter , j. theor .",
    "biol . * 242 * , 478 ( 2006 ) .",
    "m. voliotis , p. thomas , r. grima and c. bowsher , _ stochastic simulation of biomolecular networks in dynamic environments _ ( 2015 ) ( submitted ) .",
    "see supplemental material at http://grimagroup.bio.ed.ac.uk/publications.html for software package moca , as well as tutorial and example files .",
    "thomas , a. v. straube and r. grima , j. chem . phys . * 135 * , 181103 ( 2011 ) .",
    "here , we investigate in detail , the non - uniqueness of the poisson and log - normal mas for systems with conservation laws . to this end , we consider the simple reversible reaction system @xmath142{\\quad k_1 \\quad } c.\\end{aligned}\\ ] ] we now compute the ma equations by applying the conservation laws of the system once _",
    "after _ , and once _ before _ closing the equations .",
    "this approach involves obtaining the moment equations from the cme and subsequently imposing the conservation laws on the resulting moment equations .",
    "the stoichiometric matrix @xmath7 and propensity functions @xmath143 and @xmath144 of the two elementary reactions for this system read ( c.f .",
    "@xmath145 where @xmath146 and @xmath147 denote the copy numbers of species @xmath148 and @xmath149 , respectively .",
    "the corresponding time - evolution equations for the first and second - order moments can be obtained from eqs .   and .",
    "for @xmath150 and @xmath151 , for example , they read @xmath152 note that due to the term @xmath153 in @xmath143 , the equation for @xmath68 depends on the third - order moment @xmath66 , but not on any _ diagonal _ third - order moment , i.e. , not on @xmath154 or @xmath155 .",
    "the same is of course true for the equations of the other second - order moments : they do not depend on a diagonal third - order moment .",
    "this means that the second - order normal and poisson mas are equivalent , since they differ only in their expressions for diagonal moments ( c.f .",
    "eqs .  - ) .",
    "the corresponding second - order normal and poisson mas for @xmath63 and @xmath68 are obtained by setting the corresponding third - order cumulant @xmath156 to zero which leads to @xmath157 and thus gives @xmath158 and similarly for the other first and second - order moments .",
    "note that the system has two conservation laws @xmath159 to simplify the following equations , let us assume @xmath160 , which implies @xmath161 .",
    "the system of moment equations of three variables can thus be reduced to a system with only one variable , since all moments of first and second order can be expressed in terms of @xmath162 and @xmath68 using eqs .",
    "( [ app_cons_1 ] ) and ( [ app_cons_2 ] ) .",
    "for example , we have @xmath163 and @xmath164 and similarly for the other first and second - order moments .",
    "the resulting equations for @xmath63 and @xmath68 are thus closed and read @xmath165 note that these are the resulting second - order ma equations for both the normal _ and _ the poisson ma .",
    "alternatively , we can start from the reduced cme with species @xmath166 and @xmath149 eliminated , whose stoichiometric matrix and propensity functions are given by @xmath167 note that due to the term @xmath168 , the time - evolution equation for the second - order moment @xmath68 depends on the _ diagonal _ third - order moment @xmath169 ( all moments are diagonal here of course , since we deal with a system with only one variable ) .",
    "the corresponding equations for the first two moments can be obtained using eqs .   and and read @xmath170 for closing these equations to second order",
    ", we need to express @xmath171 in terms of @xmath63 and @xmath68 .",
    "the corresponding expression is now not the same anymore for the normal and poisson mas . for the normal ma we have @xmath172 .",
    "inserting the latter into eq .",
    "one obtains the same result as in eqs .   and which we obtained by applying the conservation laws _ after _ closing the equations .",
    "in contrast , if we apply the poisson ma , which sets @xmath173 , the resulting equation for @xmath68 is _ not _ equal to eq .  .",
    "the reason for this is that the poisson ma does not treat diagonal and non - diagonal moments equivalently . here",
    ", this means that the replacements of @xmath169 and @xmath66 differ from each other if one sets the index @xmath174 to @xmath175 in the expression for @xmath66 .",
    "since the same is true for the log - normal ma , the latter also gives differing results depending if the equations are closed before or after the conservation laws are applied . since the normal and cmn - ma do treat diagonal and non - diagonal moments equivalently ( so the expressions for @xmath169 and @xmath66 are the same after setting @xmath174 to @xmath175 )",
    ", these mas do not suffer from this flaw ."
  ],
  "abstract_text": [
    "<S> in recent years moment - closure approximations ( ma ) of the chemical master equation have become a popular method for the study of stochastic effects in chemical reaction systems . </S>",
    "<S> several different ma methods have been proposed and applied in the literature , but it remains unclear how they perform with respect to each other . in this paper </S>",
    "<S> we study the normal , poisson , log - normal and central - moment - neglect mas by applying them to understand the stochastic properties of chemical systems whose deterministic rate equations show the properties of bistability , ultrasensitivity and oscillatory behaviour . </S>",
    "<S> our results suggest that the normal ma is favourable over the other studied mas . </S>",
    "<S> in particular we found that ( i ) the size of the region of parameter space where a closure gives physically meaningful results , e.g. positive mean and variance , is considerably larger for the normal closure than for the other three closures ; ( ii ) the accuracy of the predictions of the four closures ( relative to simulations using the stochastic simulation algorithm ) is comparable in those regions of parameter space where all closures give physically meaningful results ; ( iii ) the poisson and log - normal mas are not uniquely defined for systems involving conservation laws in molecule numbers . </S>",
    "<S> we also describe the new software package moca which enables the automated numerical analysis of various ma methods in a graphical user interface and which was used to perform the comparative analysis presented in this paper . </S>",
    "<S> moca allows the user to develop novel closure methods and can treat polynomial , non - polynomial , as well as time - dependent propensity functions , thus being applicable to virtually any chemical reaction system . </S>"
  ]
}