{
  "article_text": [
    "an outstanding challenge in socio - economic systems is to disentangle the internal dynamics from the exogenous influence .",
    "it is obvious that any non - trivial system is both subject to external shocks as well as to internal organizational forces and feedback loops . in absence of external influences",
    ", many natural and social systems would regress or die , however the internal mechanisms are of no less importance and can either stabilize or destabilize the system .",
    "these systems are continuously subjected to external shocks , forces , noises and stimulations ; they propagate and process these inputs in a self - reflexive way .",
    "the stability ( or criticality ) of these dynamics is characterized by the relative strength of self - reinforcing mechanisms .",
    "for instance , the brain development and performance is given by both external stimuli and endogenous collective and interactive wiring between neurons .",
    "the normal regime of brain dynamics corresponds to asynchronous firing of neurons with relatively low coupling between individual neurons .",
    "however as the coupling strength increases , the internal feedback loops starts playing an increasingly important role in the dynamics , and the system moves towards the tipping point at which abnormal synchronous `` neuronal avalanches '' result in an epileptic seizure  @xcite . as another example",
    ", financial systems are known to be driven by exogenous idiosyncratic news that are digested by investors and complemented with quasi - rational ( sometimes self - referential ) behavior . correlated over - expectations ( herding ) of investors",
    "correspond to the bubble phase that pushes the system towards criticality , where the crash may result as a bifurcation towards a distressed regime  @xcite .    in physical systems at thermodynamic equilibrium , the so - called fluctuation - dissipation theorem relates quantitatively the response of the system to an exogenous ( and instantaneous ) shock to the correlation structure of the spontaneous endogenous fluctuations  @xcite . in out - of - equilibrium systems ,",
    "the existence of such relation is still an open question  @xcite . in a given observation set",
    ", it seems in general hopeless to separate the contributions resulting from external perturbations and internal fluctuations and responses .",
    "however , one would like to understand the interplay between endogeneity and exogeneity ( the ` endo - exo ' problem , for short ) in order to characterize the reaction of a given system to external influences , to quantify its resilience , and explain its dynamics . using the class of self - exciting conditional poisson ( hawkes ) processes @xcite ,",
    "some progress has recently been made in this direction @xcite .    in the modeling of complex point processes in natural and socio - economic systems ,",
    "the hawkes process @xcite has become the gold standard due to its simple construction and flexibility .",
    "nowadays , it is being successfully used for modeling sequences of triggered earthquakes  @xcite ; genomic events along dna  @xcite ; brain seizures  @xcite ; spread of violence  @xcite and crime  @xcite across some regions ; extreme events in financial series  @xcite and probabilities of credit defaults  @xcite . in financial applications ,",
    "the hawkes processes are most actively used for modeling high frequency fluctuations of financial prices ( see for instance  @xcite ) , however applications to lower frequency data , such as daily , are also possible ( see  [ apx : financial ] ) .",
    "being closely related to branching processes  @xcite , the hawkes model combines , in a natural and parsimonious way , exogenous influences with self - excited dynamics .",
    "it accounts simultaneously for the co - existence and interplay between the exogenous impact on the system and the endogenous mechanism where past events contribute to the probability of occurrence of future events .",
    "moreover , using the mapping of the hawkes process onto a branching structure , it is possible to construct a representation of the sequence of events according to a branching structure , with each event leading to a whole tree of offspring .",
    "the linear construction of the hawkes model allows one to separate exogenous events and develop a single parameter , the so - called `` branching ratio '' @xmath0 that directly measures the level of endogeneity in the system .",
    "the branching ratio can be interpreted as the fraction of endogenous events within the whole population of events  @xcite .",
    "the branching ratio provides a simple and illuminating characterization of the system , in particular with respect to its fragility and susceptibility to shocks . for @xmath1 , on average , the proportion @xmath2 of events arrive to the system externally , while the proportion @xmath0 of events can be traced back to the influence of past dynamics .",
    "as @xmath0 approaches @xmath3 from below , the system becomes `` critical '' , in the sense that its activity is mostly endogenous or self - fulfilling .",
    "more precisely , its activity becomes hyperbolically sensitive to external influences .",
    "the regime @xmath4 corresponds to the occurrence of an unbounded explosion of activity nucleated by just a few external events ( e.g. , news ) with non - zero probability . in any realistic case ,",
    "when present , this explosion will be observable in finite time .",
    "not only does the hawkes model provide this valuable parameter @xmath0 , but it also amenable to an easy and transparent estimation by maximum likelihood  @xcite without requiring stochastic declustering  @xcite , which is essential in the branching processes framework but has several limitations  @xcite .",
    "however , the hawkes model is not the only model that describes self - excitation in point processes . in particular , the autoregressive conditional duration ( acd ) model @xcite and the autoregressive conditional intensity ( aci ) model @xcite",
    "have been introduced and successfully used in econometric applications .",
    "a similar concept was used in the so - called autoregressive conditional hazard ( ach ) model  @xcite .",
    "these processes were designed to mimic properties of the famous autoregressive conditional heteroskedasticity ( arch ) model  @xcite and generalized autoregressive conditional heteroskedasticity ( garch ) model  @xcite that successfully account for volatility clustering and self - excitation in price time series .",
    "some other modifications of acd models such as fractionally integrated acd ( fiacd )  @xcite or augmented acd ( aacd )  @xcite were introduced to account for additional effects ( such as long memory ) or to increase the flexibility of the model ( for a more detailed review , see  @xcite and references therein ) .    in general , all approaches to modeling self - excited point processes can be separated into the classes of duration - based ( represented by the acd model and its derivations ) and intensity - based approaches ( hawkes , ach , aci , and so on ) , which define a stochastic expression for inter - event durations and intensity respectively .",
    "of all the models , as discussed above , the hawkes process dominates by far in the class of intensity - based model , and the acd model  a direct offspring of the garch - family  is the most used duration - based model .    despite belonging to different classes ,",
    "both models describe the same phenomena and exhibit similar mathematical properties . in this article",
    ", we aim to establish a link between the acd and hawkes models .",
    "we show that , despite the fact that the acd model can not be directly mapped onto a branching structure , and thus the branching ratio for this model can not be derived , it is possible to introduce a parameter @xmath5 $ ] that serves as an effective degree of endogeneity in the acd model .",
    "we show that this parameter shares important properties with the branching ratio @xmath6 $ ] in the framework of the hawkes model .",
    "namely , both @xmath7 and @xmath0 characterize stationarity properties of the models , and provide an effective transformation of the exogenous excitation of the system onto its total activity . by numerical simulations , we show that there exists a monotonous relationship between the parameter @xmath7 of the acd model and the branching ratio @xmath0 of the corresponding hawkes model . in particular , the purely exogenous case ( @xmath8 ) and the critical state ( @xmath9 ) are exactly mapped to the corresponding values @xmath10 and @xmath11 .",
    "we validate our results by goodness - of - fit tests and show that our findings are robust with respect to the specification of the memory kernel of the hawkes model .",
    "the article is structured as follows . in section  [ sec : models ] , we introduce the hawkes and acd models and briefly discuss their properties .",
    "section  [ sec : branching ] introduces the branching ratio and relates it to the measure of endogeneity within the framework of the hawkes model . in section  [ sec : endo_acd ] , we discuss similarities between the hawkes and acd models , and identify a parameter in the acd model that can be treated as an effective degree of endogeneity .",
    "we support our thesis with extensive numerical simulations and goodness - of - fit tests . in section",
    "[ sec : conclusion ] , we conclude .",
    "let us define a _ univariate point process _ of event times @xmath12 ( @xmath13 for @xmath14 ) with the _ counting process _ @xmath15 , and the _ duration process _ of inter - event times @xmath16 .",
    "properties of the point process @xmath17 are usually described with the _ ( unconditional ) intensity process _",
    "@xmath18 $ ] and _ conditional intensity process _ @xmath19 $ ] , which is adapted to the natural _ filtration _ @xmath20 representing the history of the process .",
    "the well - known _ poisson point process _ is defined as the point process whose conditional intensity does not depend on the history of the process and is constant : @xmath21 the _ non - homogenous poisson process _ extends expression to account for time - dependence of both conditional and unconditional intensity functions : @xmath22 .",
    "both homogeneous and non - homogeneous poisson processes are completely memoryless , which means that the durations @xmath23 are independent from each other and are completely determined by the exogenous parameter ( function ) @xmath24 .",
    "the _ self - excited hawkes process _ and _ autoregressive conditional durations ( acd ) _ model , which are described in this article , extend the concept of the poisson point processes by adding path dependence and non - trivial correlation structures .",
    "these models represent two different approaches in modelling point processes with memory : the so called _ intensity - based _ and _ duration - based _ approaches .",
    "as follows from their names , the first approach focuses on models for the conditional intensity function @xmath25 and the second considers models of the durations @xmath23 . for example , in the context of the intensity - based approach , the poisson process is defined by equation  . in the context of the duration - based approach",
    ", the poisson process is defined as the point process whose durations @xmath23 are independent and identically distributed ( iid ) random variables with exponential probability distribution function @xmath26 .",
    "the linear hawkes process  @xcite , which belongs to the class of intensity - based models , has its conditional intensity @xmath25 being a stochastic process of the following general form : @xmath27 where @xmath28 is the _ background intensity _ , which is a deterministic function of time that accounts for the intensity of arrival of _ exogenous _ events ( not dependent on history ) .",
    "a deterministic _ kernel function _",
    "@xmath29 , which should satisfy causality ( @xmath30 for @xmath31 ) , models the _ endogenous _ feedback mechanism ( memory of the process ) . given that each event arrives instantaneously , the differential of the counting process @xmath32 can be represented in the form of a sum of delta - functions @xmath33 , allowing   to be rewritten in the following form : @xmath34 it can be shown ( and we will discuss this point in the following section ) that the stationarity of the process   requires that @xmath35    the shape of the kernel function @xmath29 defines the correlation properties of the process . in particular , the geophysical applications of the hawkes model , or more precisely of its spatio - temporal extension called the _ epidemic - type aftershock sequence ( etas ) _  @xcite , assume in general a power law time - dependence of the kernel @xmath29 : @xmath36 that describes the modified omori - utsu law of aftershock rates  @xcite .",
    "financial applications  @xcite traditionally use an exponential kernel @xmath37 which has been originally suggested by  @xcite and ensures markovian properties of the model  @xcite . in both cases ,",
    "a heaviside function @xmath38 ensures the validity of the causality principle .",
    "the stationarity condition   requires @xmath39 for the power law kernel and @xmath40 for the exponential kernel .    in the present work ,",
    "we focus on the hawkes model with an exponential kernel   and background intensity @xmath28 that does not depend on time : @xmath41 . we introduce a new dimensionless parameter , @xmath42 , which will be discussed in detail later , which allows us to write the final expression for the conditional intensity as follows : @xmath43 then , the stationarity condition reads @xmath1 . in order to check the robustness of the results presented below , in particular with respect to the choice of the memory kernel , we have also considered a power law kernel   with time - independent background intensity @xmath41 .",
    "similarly to the exponential kernel , the integral from @xmath44 to @xmath45 of the memory kernel defines the dimensionless parameter @xmath46 , which allows us to rewrite the hawkes model with power law kernel as : @xmath47 again , the stationarity condition reads @xmath1 .      the class of _ autoregressive conditional durations _ ( acd )",
    "models has been introduced by  @xcite in the field of econometrics to model financial data at the transaction level .",
    "the acd model applies the ideas of the autoregressive conditional heteroskedasticity ( arch )  @xcite model , which separates the dynamics of a stationary random process into a multiplicative random error term and a dynamical variance that regresses the past values of the process . in the spirit of the arch , the acd model",
    "is represented by the duration process @xmath48 in the form @xmath49 where @xmath50 defines an iid random non - negative variable with unit mean @xmath51=1 $ ] , and the function @xmath52 is the conditional expected duration : @xmath53= \\psi_{i}$ ] . here",
    ", @xmath54 represents the set of parameters of the model . from expression",
    ", one can simply derive the conditional intensity of the process  @xcite : @xmath55 where @xmath56 represents the intensity function of the noise term , @xmath57 .",
    "assuming @xmath57 to be iid exponentially distributed , one can call this model   an _ exponential acd _ model .",
    "the conditional expected duration @xmath58 of the acd(@xmath59,@xmath60 ) model , where @xmath61 denotes the order of the model , is defined as an autoregressive function of the past observed durations @xmath48 and the conditional durations @xmath62 themselves : @xmath63 where @xmath64 , @xmath65 and @xmath66 are parameters of the model that constitute the set @xmath67 .",
    "the stationarity condition for the acd model has the form  @xcite : @xmath68    in the simple acd(1,1 ) case that is considered in the present article , equation   is reduced to : @xmath69 similarly , the conditional intensity   of the exponential acd(1,1 ) has the form : @xmath70 and the stationarity condition   reduces to @xmath71 .",
    "the linear structure of the hawkes process   with identical functional form of summands @xmath72 , that depend only on arrival time of a single event @xmath73 , allows one to consider it as a cluster process in which the random process of cluster centers @xmath74 is the poisson process with rate @xmath28 .",
    "all clusters associated with centers @xmath75 are mutually independent by construction and can be considered as a _ generalized branching process _",
    "@xcite , illustrated in figure  [ fig : branching ] .    [ insert figure  [ fig : branching ] here ]    in this context , each event @xmath73 can be either an _ immigrant _ or a _",
    "descendant_. the rate of immigration is determined by the background intensity @xmath28 and results in an exogenous random process .",
    "once an immigrant event occurs , it generates a whole cluster of events .",
    "namely , a zeroth - order event ( which we will call the _ mother event _ ) can trigger one or more first - order events ( _ daughter events _ ) .",
    "each of these daughters , in turn , may trigger several second - order events ( the grand - daughters of the initial mother ) , and so on .",
    "all first- , second- and higher - order events form a cluster and are called descendants ( or _ aftershocks _ ) and represent endogenously driven events that appear due to internal feedback mechanisms in the system .",
    "it should be noted that this mapping of the hawkes process   onto the branching structure ( figure  [ fig : branching ] ) is possible due to the linearity of the model , and is not valid for nonlinear self - excited point processes , such as the class of nonlinear mutually excited point processes  @xcite , of which the multifractal stress activation model  @xcite is a particular implementation .",
    "the crucial parameter of the branching process is the _ branching ratio _ ( @xmath76 ) , which is defined as the average number of daughter events per mother event .",
    "depending on the branching ratio , there are three regimes : ( i ) _ sub - critical _ ( @xmath77 ) , ( ii ) _ critical _ ( @xmath78 ) and ( iii ) _ super - critical _ or explosive ( @xmath79 ) .",
    "starting from a single mother event ( or immigrant ) at time @xmath80 , the process dies out with probability @xmath3 in the sub - critical and critical regimes and has a finite probability to explode to an infinite number of events in the super - critical regime .",
    "the critical regime for @xmath78 separates the two main regimes and is characterized by power law statistics of the number of events and in the number of generations before extinction  @xcite . for @xmath81 ,",
    "the process is stationary in the presence of a poissonian or more generally stationary flux of immigrants .",
    "being the parameter that describes the clustering structure of the branching process , the branching ratio @xmath76 defines the relative proportion of exogenous events ( immigrants ) and endogenous events ( descendants or aftershocks ) .",
    "moreover , in the sub - critical regime , in the case of a constant background intensity ( @xmath82 ) , the branching ratio is exactly equal to the fraction of the average number of descendants in the whole population  @xcite . in other words ,",
    "the branching ratio is equal to the proportion of the average number of endogenously generated events among all events and can be considered as an effective measure of endogeneity of the system .    to see this ,",
    "let us count separately the rates of exogenous and endogenous events .",
    "the rate of exogenous immigrants ( zeroth - order events ) is equal to the background activity rate : @xmath83 .",
    "each immigrant independently gives birth , on average , to @xmath76 daughters and thus the rate of first - order events is equal to @xmath84 . in turn , each first - order event produces , on average , @xmath76 second - order events , whose rate is equal to @xmath85 .",
    "continuing this process ad infinitum and summing over all generations , we obtain the rate of all endogenous descendants : @xmath86 which is finite for @xmath77 .",
    "the global rate is the sum of the rates of immigrants and descendants and equal to @xmath87 and the proportion of descendants ( endogenously driven events ) in the whole system is equal to the branching ratio : @xmath88 calibrating @xmath76 on the data therefore provides a direct quantitative estimate of the degree of endogeneity .    in the framework of the hawkes model   with @xmath82 ,",
    "the branching ratio @xmath76 is easily defined via the kernel @xmath29 : @xmath89 for the exponential parametrization  , the branching ratio , @xmath90 , is equal to a dimensionless parameter @xmath91 previously introduced .",
    "the hawkes framework provides a convenient way of estimating the branching ratio , @xmath91 , from the observations @xmath92 , using the maximum likelihood method , which benefits from the fact that the log - likelihood function is known for hawkes processes  @xcite .",
    "the calibration of the model and estimation of the branching ratio @xmath76 can then be performed with the numerical maximization of log - likelihood function in the parameter space @xmath93 for the exponential kernel   and @xmath94 for the power law model  . despite being a relatively straightforward calibration procedure ,",
    "special care should be taken with respect to data processing , choice of the kernel , robustness of numerical methods and stationarity tests as discussed in details in  @xcite .",
    "note that the acd(@xmath59,@xmath60 ) and hawkes models operate on different variables with inverse dimensions : duration @xmath95 for the acd(@xmath59,@xmath60 ) model and conditional intensity @xmath25 for the hawkes model , which is of the order of the inverse @xmath96 of the duration @xmath95 . as a consequence , equations   and   apply to different statistics ( average durations @xmath97 $ ] and average rate @xmath98 $ ] ) .",
    "moreover , the acd model can not be exactly mapped onto a branching structure whereas the hawkes process can .",
    "indeed , the branching structure requires that the conditional probability for an event to occur within the infinitely small interval @xmath99 ( which is the conditional intensity ) should be decomposed into a sum of ( 1 ) a ( deterministic or stochastic ) function of time that represents the immigration intensity and ( 2 ) the contributions @xmath100 from each past event @xmath73 that satisfy the following conditions : ( i ) these contributions should depend only on @xmath73 and be independent from all other events @xmath101 ; ( ii ) these contributions should exhibit identical structure for all events ; and ( iii ) they should satisfy the causality principle .",
    "thus , in its general form , a conditional poisson process that can be mapped on ( multiple ) branching structures if it is described by the following conditional intensity : @xmath102 where @xmath103 is some deterministic function , and @xmath38 is a unit step ( heaviside function ) . in the context of autoregressive models ( such as acd ) , the expected waiting time at a given time @xmath104 is defined as a regressive sum of past durations , which means that the contribution of each event @xmath105 to the intensity at time @xmath104 depends on all the events @xmath106 that happened after it ( @xmath107 ) .",
    "this violates the first principle for a branching processes of the independence of distinct branches . for the acd model ,",
    "the analysis is also complicated by the structure of the conditional intensity function  , where past history is influencing the intensity both in a multiplicative way and with a shift in the baseline intensity @xmath108 .",
    "one should note that autoregressive intensity models ( such as aci ) in general also do not have a branching structure representation due to the problem discussed above .    despite the differences in their definition and the impossibility of developing an exact mapping onto a branching structure , the acd model shares many similarities with the hawkes model and their point processes exhibit similar degrees of clustering .",
    "in particular , for the acd defined by expression  , the combined parameter , @xmath109 plays a similar role to the parameter @xmath0 of the hawkes process with an exponential kernel  .",
    "the similarities start with the stationarity conditions   and  , which require @xmath1 for the hawkes model and @xmath110 for the acd , but go much deeper than the simple idea of `` effective distance '' to a non - stationary regime .",
    "as we have seen in the previous section , @xmath0 defines the effective degree of endogeneity   that translates the exogenous rate @xmath83 into the total rate @xmath111 .",
    "similarly , let us study the role of endogenous feedback in the acd model .",
    "for @xmath112 , the acd(0,0 ) model  , reduces to a simple poisson process with durations @xmath113 having an average value of @xmath114=\\omega$ ] , which can be considered as the exogenous factor . when @xmath115 and @xmath116 , there is an amplification of the average durations . considering the average of eq .   in the stationary regime ( @xmath117=\\mathrm{e}[\\delta t_{i}]$ ] and",
    "@xmath118=\\mathrm{e}[\\psi_{i}]$ ] ) , and taking into account eq .",
    ", we obtain the following expression for the mean duration in the stationary regime : @xmath119=    \\frac{\\omega}{1-\\sum_{j=1}^p\\alpha_j-\\sum_{k=1}^q\\beta_k}\\equiv\\frac{\\omega}{1-\\zeta}.\\ ] ] equations   and   share the same functional dependence , with a divergence when the corresponding control parameters @xmath0 and @xmath7 approach @xmath3 .      in order to quantify the similarities between the acd and hawkes models outlined in the previous section",
    ", we have performed the following numerical study .",
    "we simulated realizations of the acd(1,1 ) process and calibrated the hawkes model to it . the traditional way of fitting the hawkes model uses the maximum likelihood method  @xcite , which is asymptotically normal and asymptotically efficient  @xcite . we have used the r package `` ptprocess ''  @xcite , which provides a convenient framework for hawkes models   with arbitrary kernel @xmath29 and background intensity @xmath28 . then , we maximized the likelihood function using a newton - type non - linear maximization  @xcite .",
    "the  [ apx : bias ] reports a study of the finite sample bias and efficiency of the hawkes maximum likelihood estimator .",
    "we find that the estimation error @xmath122 of the branching ratio ( without model error ) measured with the 90% quantile ranges does not exceed @xmath123 for all values @xmath124 .",
    "more precisely , we want to quantify similarities between control parameters @xmath7 of the model acd(@xmath59,@xmath60 ) and @xmath0 of the exponential hawkes model . for this",
    ", we have simulated realizations of the acd process and estimated the parameter @xmath0 from these realizations .",
    "the parameter @xmath125 of the acd(@xmath59,@xmath60 )   model defines the time scale . without loss of generality , we let @xmath126 , which accounts for a linear transformation of time @xmath127 in equations   and  . for the sake of simplicity , we present our results for the acd(1,1 ) model , for which the dimensionless parameter @xmath7 reduces to @xmath121",
    ". however , our findings are robust to the choice of the order of the acd model and can be easily generalized to the case of @xmath128 .",
    "the parameters @xmath129 and @xmath130 were chosen so that @xmath121 spanned @xmath131 $ ] at 40 equidistant points .",
    "for each of the 40 values of @xmath7 , we have generated 100 realizations of the corresponding exponential acd(1,1 ) process .",
    "each realization of 3500 events was generated by a recursive algorithm using eq .  .",
    "in order to minimize the impact of edge effects that can bias the estimation of the branching ratio  @xcite , the first 500 points of each realization were discarded .",
    "then , the hawkes model   was calibrated on these synthetic datasets .    for each calibration",
    ", we have performed a goodness - of - fit test based on residual analysis  @xcite , which consists of studying the so - called residual process defined as the nonparametric transformation of the initial time - series @xmath73 into @xmath132 where @xmath133 is the conditional intensity of the hawkes process estimated with the maximum likelihood method . under the null hypothesis that the data has been generated by the hawkes process  ,",
    "the residual process @xmath134 should be poisson with unit intensity  @xcite .",
    "visual analysis involves studying the cusum plot or q - q plot and may be complemented with rigorous statistical tests . under the null hypothesis",
    "( poisson statistics of the residual process @xmath134 ) , the inter - event times in the residual process , @xmath135 , should be exponentially distributed with cdf @xmath136 .",
    "thus , the random variables @xmath137 should be uniformly distributed in @xmath131 $ ] .",
    "we have performed rigorous kolmogorov - smirnov tests for uniformity and provided the corresponding p - values .",
    "we start with a visual comparison of realizations generated with the two models .",
    "figure  [ fig : acdhawkesseries ] presents a comparison of the conditional intensities and durations for ( i ) simulations of the acd(1,1 ) process and , ( ii ) simulations of the hawkes process with parameters calibrated to the corresponding acd process realization .",
    "visual similarities are striking for all four acd - hawkes pairs : total , average , and maximum durations are similar .",
    "moreover , bursts of short and long durations are of similar length .",
    "the conditional intensities fluctuate in a similar range and show qualitatively similar clustering of events , although the acd conditional intensity is constant between events while the hawkes decays exponentially .",
    "quantitatively , the distributions of durations also show a large degree of similarity .",
    "[ insert figure  [ fig : acdhawkesseries ] here ]    figure  [ fig : acdhawkesseries ] also reveals one important property of the acd model . despite the fact that many statistical properties ( such as average durations  ) are defined by the control parameter @xmath121 , @xmath129 and @xmath130 have different impacts on the effective degree of endogeneity @xmath0 .",
    "for instance , case ( b ) @xmath138 , and case(c ) @xmath139 both have the same @xmath140 but @xmath141 for ( b ) and @xmath142 for ( c ) . the smaller endogeneity found in case ( c ) is compensated by a higher rate of exogenous events ( @xmath143 for ( c ) compared with @xmath144 for ( b ) ) , resulting in a `` flatter '' conditional intensity for ( c ) .    in order to explore this effect in simulations of the acd model ,",
    "for each value of @xmath121 , we considered different relations between @xmath129 and @xmath130 : ( i ) @xmath145 , ( ii ) @xmath146 , ( iii ) @xmath147 , ( iv ) @xmath148 and ( v ) @xmath149 .",
    "figure  [ fig : hawkesfit ] presents the results of the fitting of the hawkes model on realizations of the acd(1,1 ) model in these five cases .",
    "the first striking observation is the existence of two fundamentally different behaviors observed for @xmath150 ( case ( iii ) ) versus @xmath151 ( cases ( i),(ii),(iv),(v ) ) . for @xmath150 , the estimated effective branching ratio @xmath152 is @xmath44 for all values of the control parameter @xmath153 , as shown in figure [ fig : hawkesfit](b ) .",
    "this diagnoses a completely exogenous dynamics of the acd process , which is indeed the expected diagnostic given that , for @xmath150 , eq .   and   reduce to @xmath154 for which the dynamics of the conditional durations @xmath155 is purely deterministic and independent of the realized durations @xmath156 , while the later are entirely driven by the random term @xmath57 .",
    "[ insert figure  [ fig : hawkesfit ] here ]    for @xmath151 , we find similar non - trivial results .",
    "figure  [ fig : hawkesfit](b ) shows the effective branching ratio @xmath152 as a monotonously increasing function of @xmath7 for all combinations of @xmath157 and @xmath130 . in cases ( ii ) ( @xmath158 ) and ( iv ) ( @xmath159 ) , the dependence of @xmath152 on @xmath7 is almost linear for @xmath160 and @xmath161 respectively and , for higher values of @xmath7 , the convexity increases . in case ( i )",
    "( @xmath162 ) , @xmath152 depends linearly on @xmath7 for @xmath163 with a very good approximation .",
    "finally , in case ( v ) ( @xmath159 ) , the curvature of @xmath164 is significant over the range of @xmath165 .",
    "remarkably , all four dependencies converge to the same value @xmath166 for @xmath11 .",
    "figure  [ fig : hawkesfitunbias ] presents the dependence of the effective branching ratio @xmath152 on the control parameter @xmath121 after correction of the bias in estimation due to finite size effects presented in the  [ apx : bias ] and summarized in figure  [ fig : bias ] ) .",
    "all dependencies of @xmath152 as a function of @xmath7 converge to the critical value @xmath11 .",
    "[ insert figure  [ fig : hawkesfitunbias ] here ]    figure  [ fig : contour ] generalizes figure  [ fig : hawkesfit](b ) by presenting the dependence of the effective branching ratio @xmath152 ( corrected for the finite sample bias determined in the  [ apx : bias ] ) on the parameters @xmath129 and @xmath130 separately . as expected , the impact of a change of @xmath129 is much larger than that of @xmath130 .",
    "there is a region , delineated by the dashed line , within which the hawkes model is rejected at the 5% level for the kolmogorov - smirnov test . for most combinations of @xmath129 and @xmath130 such that",
    "@xmath167 , the hawkes model is rejected .",
    "interestingly , the hawkes model is not rejected in the case where @xmath130 is kept significantly larger than @xmath129 , and it is only rejected in a small interval in the extreme opposite case where @xmath168 .",
    "the model is often not rejected for large values of @xmath169 .      despite similarities ,",
    "the hawkes and acd models exhibit some important differences .",
    "figure  [ fig : hawkesfit]a shows that the effective background rate @xmath170 estimated by the hawkes model is a decreasing function of the control parameter @xmath7 .",
    "this is an indirect consequence of the dependence of the expected duration on @xmath7 given by expression .",
    "in contrast to the hawkes model  , for which the background rate @xmath28 completely describes the exogenous impact on the system , the parameter @xmath125 of the acd model   is not the only factor embodying the exogenous activity and there is no strict decoupling between the exogenous driver @xmath125 and endogenous level @xmath7 as occurs for the parameters @xmath171 and @xmath0 of the hawkes model . in other words ,",
    "in contrast to the hawkes model , the acd in its classical form   does not provide a clean distinction between exogenous and endogenous activities .",
    "another difference between the hawkes and acd models can be observed in figure  [ fig : hawkesfit](d ) , which presents a residual analysis of the calibration of realizations of the acd process by the hawkes model using the kolmogorov - smirnov test . the null hypothesis that the realizations of the acd process are generated by the hawkes model",
    "is rejected at the 5% confidence level for @xmath172 in case ( i ) ( @xmath162 ) . for case ( ii )",
    "( @xmath158 ) and ( iv ) ( @xmath159 ) , the null hypothesis is rejected for even lower @xmath163 .",
    "however , for case ( v ) ( @xmath173 ) , the null can not be rejected for almost all values of the control parameter @xmath7 , except for a small interval around @xmath174 .      finally , we need to discuss the choice of the kernel @xmath29 in the specification of the hawkes model   used in the calibration of the realizations generated with the acg process .",
    "the use of the exponential kernel   is a priori justified by the short memory of the acd(@xmath3,@xmath3 ) process .",
    "indeed , the autocorrelation function of the acd(@xmath3,@xmath3 ) model decays exponentially  @xcite , and the same can be shown explicitly for the garch(@xmath3,@xmath3 ) model  @xcite .",
    "the choice of a short - memory exponential kernel for the hawkes model ensures markovian properties with a fast decaying autocorrelation function of the durations  @xcite .",
    "high p - values of the goodness - of - fit tests for parameters @xmath160 ( see figure  [ fig : hawkesfit ] ) confirm the good mapping between the exponential acd(1,1 ) and hawkes processes with an exponential kernel .    in order to further validate the selection of the exponential kernel of the hawkes process",
    ", we have compared the calibrations of realizations generated with the acg process with the hawkes model with the exponential kernel   and with the power law kernel  . since these models have a different number of parameters ( @xmath175 and @xmath176 respectively ) , we compare them using the akaike information criterion ( aic )  @xcite .",
    "the aic is by far the most popular model comparison criterion used in the point process literature  @xcite .",
    "the aic penalizes complex models by discounting the likelihood function @xmath177 by the number @xmath178 of parameters of the model .",
    "specifically , the aic suggests selecting the model with a minimum @xmath179 value , where @xmath180 .",
    "[ insert table  [ tb : exp_pow ] here ]    table  [ tb : exp_pow ] gives the results for the realizations presented in figure  [ fig : acdhawkesseries ] . in terms of likelihood , the exponential and power law kernels give practically identical values ( @xmath181 ) . penalizing model complexity with the aic",
    "widens the gap , and the exponential kernel with one fewer parameters is selected under the aic .",
    "notwithstanding their apparent strong difference , the estimated background intensities ( @xmath170 ) and branching ratios ( @xmath182 ) are almost the same for both memory kernels .",
    "this can explained by the fact that the parameters @xmath183 and @xmath184 estimated for the power law kernel ( [ eq : pow ] ) are such that the later remains very close to an exponential kernel over a large time interval , as illustrated by figure  [ fig : kernels ] for case c ( @xmath185 , @xmath186 ) , which presents a direct comparison between the exponential kernel @xmath187 ) and the power law kernel @xmath188 .",
    "the corresponding ml estimates of their parameters are respectively @xmath189 , @xmath190 and @xmath191 .",
    "the large value of the estimated exponent @xmath183 ( of the order of 100 ) implies a fast decay , similar to an exponential function .",
    "correlatively , the large value of the constant @xmath184 implies the absence of the hyperbolic range ( or `` long tail '' ) as well .",
    "the almost perfect coincidence is observed for up to times @xmath192 , over which the kernels @xmath193 decay by a factor of almost 50 . for @xmath194 for which the relative difference between the two kernels exceed 20% , the absolute values of @xmath29 is less than @xmath195 so that the contribution of time scales beyond @xmath196 to the total intensity  , becomes insignificant .",
    "[ insert figure  [ fig : kernels ] here ]",
    "the present article positions itself within the neoclassical financial literature that investigates the nature of the mechanisms that drive financial prices .",
    "the benchmark , called the `` efficient market hypothesis '' ( emh )  @xcite , holds that markets only reacts to external inputs ( information flow ) and almost instantaneously reflect these inputs in the price dynamics . this purely exogenous view on price formation",
    "has been contradicted by many empirical observations ( see for instance the original works  @xcite and more recent  @xcite ) , which show that only a minor fraction of price movements can be explained by relevant news releases .",
    "this implies a significant role for internal feedback mechanisms . using the framework of hawkes processes , two of us @xcite have used the corresponding branching ratio to provide what is , to the best of our knowledge , the first quantitative estimate of the degree of endogeneity in financial markets",
    "this degree of endogeneity is measured as the proportion of price moves resulting from endogenous interactions among the total number of all price moves ( including both endogenous interactions and exogenous news ) .",
    "these works provided a solid counter - example of short - term `` inefficiency '' of financial markets , which was complemented with the similar confirmation from longer time scales  @xcite .",
    "the later work , though , is subjected to a number of numerical biases , as shown in  @xcite , and triggered an ongoing discussion about the nature of long - range memory and criticality .    in this context",
    ", the present article expands the quantification of endogeneity to the class of autoregressive conditional duration ( acd ) point processes .",
    "this is done by the introduction of the composite parameter @xmath7 ( [ eq : zeta ] ) associated with the parameters @xmath197 and @xmath198 , which control the dependence of the conditional expectated duration between events as a function of past realized duration and past conditional expected duration .",
    "we have shown that the parameter @xmath7 can be mapped onto the branching ratio @xmath0 that directly measures the level of endogeneity within the framework of the hawkes self - excited conditional poisson model .",
    "this result leads to a novel interpretation of the various studies that analyzed high - frequency financial data with the acd model .",
    "an important conclusion derives from our mapping of the acd onto the hawkes process .",
    "both original works  @xcite as well as more recent studies reviewed in refs .",
    "@xcite have reported estimated parameters @xmath197 and @xmath198 that combine to extremely large values of @xmath7 , often larger than @xmath199 , and up to @xmath200 .",
    "from the perspective offered by the present work and in particular from the mapping of @xmath7 onto @xmath0 , these empirical findings provide strong support to the hypothesis of a dominant endogenous or `` reflexive ''  @xcite component in the dynamics of financial markets .    the present work offers itself to a natural extension beyond point processes to the class of discrete time processes .",
    "there are several successful models of self - excitation within a discrete time framework , such as ar ( auto - regressive ) , arma ( auto - regressive moving average )  @xcite and garch models  @xcite and their siblings , as well as the recently introduced self - excited multifractal ( semf ) model  @xcite , that extends quasi - multifractal models  @xcite by introducing explicit feedback mechanism .",
    "however , until now , there has been no framework that provides a direct quantification and estimation of the degree of endogeneity present in a given time series . as discussed above , the acd(@xmath59,@xmath60 ) model in fact",
    "belongs to the class of garch(@xmath59,@xmath60 ) models , though not with normally distributed innovations but instead with iid distributed innovations with a poisson distribution . by extension , this suggests a direct application of our present findings to garch models .",
    "this correspondence will benefit from the elaborate toolbox of calibration methods and the detailed accumulated knowledge of the statistical properties of garch models  @xcite .",
    "both hawkes and acd - type models belong to a class of point processes and describe stochastic arrival times of events of some kind . since the key variable of these models is the arrival time , selection of what defines an event is extremely important both for numerical analysis and for the diagnostic of the exogenous and endogenous mechanisms . in  @xcite ,",
    "a number of endogenous mechanisms that exist in financial markets are listed  ranging from high frequency trading to behavioural herding at longer time scales .",
    "these mechanisms operate on different time scales , and have different magnitudes . thus",
    ", the appropriate events must be defined to capture ( and hopefully isolate ) the dynamics of the mechanism of interest .",
    "below , we present a non - exhaustive review of modern financial applications of hawkes and acd models .    as discussed in the introduction , high - frequency applications of hawkes and acd models are by far dominant in modern financial econometrics ( see also  @xcite ) . in the context of the description of the order - book formation process",
    ", events can be naturally defined as a sequence of individual transactions  @xcite or quotes  @xcite , or more detailed as a set of mutually - exciting processes of submission and cancellation of limit orders and submission of market orders  @xcite . on the aggregate level ,",
    "the last transaction price change can serve as a proxy for cross - excitation between different markets  @xcite .",
    "following the modern literature on price impacts ( see  @xcite and references therein ) , @xcite and @xcite suggested mid - quote price as a better proxy for price movements and mid - quote price changes were used for the estimation of the endogeneity of the price dynamics . in  @xcite and  @xcite ,",
    "the co - excitation between market orders and mid - price changes was used to model market impact .",
    "however , applications of self - excited point processes are not limited to microstructure events ( that can be defined only using complete order flow or level-1 tick data ) . in case of regularly - spaced discrete time time series ( such as minutely , hourly or daily price dynamics ) , events can be defined as some kind of `` extremes '' in the dynamics . the most standard way",
    "( see for instance  @xcite with respect to applications to daily data ) defines events using the `` peak - over - threshold '' concept : for a given dynamics of financial returns , one selects those returns that fall outside a selected quantile range ( for example 10%90% ) .",
    "the resulting irregularly - spaced point process can then be calibrated using the hawkes or acd model",
    ". a more accurate approach should account for potential changes of regime and volatility clustering , and thus should use local extreme detection methods , such as the realized bi - power variation  @xcite ( @xcite apply this method to model co - jumps in time - series of 1-minute returns ) .",
    "another interesting , but not yet explored application of point process models , involves detecting regime ( or trend ) changes in price dynamics and defining a point process using turning points .",
    "the simplest way is to define a local minima and maxima at a fixed time - scale in the discrete time series , and use these extrema to construct a point process .",
    "more accurate trend detection would involve local volatility estimation , such as method of drawup and drawdown detection ( consecutive positive or negative price changes ) discussed in  @xcite .",
    "however , one needs to be warned that : ( i ) most trend detection methods are not causal and require information about the future price dynamics , thus they are not well - suited for forecasting purposes ; and ( ii ) all these methods are based on conditional statistics that should be treated carefully in order to avoid spurious phenomena even in featureless processes  @xcite . a general recommendation is to always consider one or several well - known processes ( such as the uncorrelated random walk ) and apply first the new method to these known processes to check if the event defining procedure might not introduce some spurious endogeneity .    finally , in modeling both micro- and macro - structure of financial time series , the magnitude of events ( size of orders , size and sign of price changes or jumps ) can be relevant . in this case , a marked hawkes model may be considered in which the size of the event determines its expected number of offspring , such as in the etas model for earthquakes for which the marks are the earthquake magnitudes  @xcite .",
    "in order to optimize the calibration of the hawkes model on the acd(@xmath3,@xmath3 ) , we study the finite sample bias and efficiency of the hawkes maximum likelihood estimator . for this",
    ", we have simulated realizations of the hawkes process with a modified thinning procedure  @xcite implemented in the same `` ptprocess '' package  @xcite , and afterwards we have calibrated the hawkes model on this synthetic data .",
    "it should be noted that simulation ( and fitting  @xcite ) of the acd model is computationally easier than for the hawkes model .",
    "indeed , simulation of the hawkes process with the thinning algorithm has complexity of @xmath201 ( with possibility to reduce to @xmath202 @xcite ) , compared with complexity of only @xmath203 for the acd(@xmath3,@xmath3 ) model .",
    "we swept the parameter @xmath0 in the range @xmath131 $ ] , fixing other parameters to @xmath204 and @xmath205 .",
    "we generated 100 realizations of the hawkes process of size 3500 each .",
    "to reduce the edge effects of the thinning algorithm , we discarded the first 500 points of each realization and afterwards calibrated the parameters of the hawkes model on these realizations of length 3000 . figure  [ fig : bias ] illustrates the bias and efficiency of the maximum likelihood estimator in our framework .",
    "the definition of the hawkes model  ( [ eq : hawkes_discr ] ) requires the kernel @xmath29 to be always positive .",
    "this implies @xmath206 , so the estimation of @xmath0 is expected to have positive bias for small values , as seen in figure  [ fig : bias ] . on the other hand ,",
    "when @xmath0 approaches the critical value of 1 from below , the memory of the system increases dramatically and , for critical state of @xmath9 , the memory becomes infinite .",
    "thus , for a realization of limited length , the finite size will play a very important role and will result in a systematic negative bias for @xmath207 .",
    "this reasoning is supported by the evidence presented in figure  [ fig : bias ] , where one observes large systematic bias for @xmath208 . for values of the branching ratio not too close to @xmath44 or @xmath3 ,",
    "the bias is very small for almost all reasonable realization lengths ( longer than 200 to 400 points ) .",
    "we also find that the bias for @xmath0 close to @xmath3 strongly depends on the realization length .",
    "finally , figure  [ fig : bias ] illustrates the high efficiency of the maximum likelihood estimator : for values of @xmath209 , the estimation error @xmath122 measured with the 90% quantile ranges does not exceed @xmath123 .",
    "guttorp , p. , & thorarinsdottir , t.  l. ( 2012 ) . .",
    "in e.  porcu , j.  m. montero , & m.  schlather ( eds . ) _ advances and challenges in space - time modelling of natural events _ , ( pp . 79102 ) .",
    "berlin , heidelberg : springer berlin heidelberg .                                                                                                                            , @xmath3 ) process ( left column ) , and hawkes process ( right column ) simulated with parameters obtained by calibrating to the realization of the acd process . parameters of the acd process @xmath210 and estimated parameters of the hawkes model @xmath211 are the following : ( a ) @xmath212 , @xmath213 , ( b ) @xmath214 , @xmath215 , ( c ) @xmath216 , @xmath217 and ( d ) @xmath218 , @xmath219 . ]    , @xmath3 ) realizations",
    ". estimated ( a ) background intensity @xmath170 , ( b ) branching ratio @xmath152 , and ( c ) characteristic time of the kernel @xmath220 .",
    "panel ( d ) shows the p - value from the goodness - of - fit test , where the dashed line indicates the the 10% level .",
    "( i ) @xmath145 , ( ii ) @xmath146 , ( iii ) @xmath147 , ( iv ) @xmath148 and ( v ) @xmath149 .",
    "the black line corresponds to the mean p - value for case ( i ) ( @xmath162 ) , the shaded area to the 95% quantile range for case ( i ) , and the dotted lines depict mean p - values for cases ( ii ) @xmath158 , ( iii ) @xmath150 , ( iv ) @xmath159 and ( v ) @xmath173 . ]       of the hawkes model calibrated to acd(@xmath3,@xmath3 ) realizations for a grid of values @xmath129 and @xmath130 with @xmath221 , corrected for the finite sample estimation bias determined in the  [ apx : bias ] .",
    "the dashed line delineates the region where the goodness - of - fit tests rejects the null hypothesis ( see text).,scaledwidth=70.0% ]       and the true value @xmath171 used for the generation of the time series ; panel ( b ) : difference between the estimates of the branching ratio @xmath152 and the true value @xmath0 ; panel ( c ) : difference between the estimates of the characteristic time of the kernel @xmath220 and the true value @xmath224 .",
    "panel ( d ) shows the p - value of the kolmogorov smirnov test for standard uniformity of the transformed durations of the residual process @xcite . in all panels ,",
    "the black lines correspond to the mean , and the shaded areas to 90% , 50% , and 10% quantile ranges . ]"
  ],
  "abstract_text": [
    "<S> in order to disentangle the internal dynamics from exogenous factors within the autoregressive conditional duration ( acd ) model , we present an effective measure of endogeneity . inspired from the hawkes model , this measure is defined as the average fraction of events that are triggered due to internal feedback mechanisms within the total population . </S>",
    "<S> we provide a direct comparison of the hawkes and acd models based on numerical simulations and show that our effective measure of endogeneity for the acd can be mapped onto the `` branching ratio '' of the hawkes model . </S>"
  ]
}