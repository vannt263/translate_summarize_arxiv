{
  "article_text": [
    "natural ( or darwinian ) selection is the gradual process by which biological traits ( phenotypes ) become either more or less common in a population as a consequence of reproduction success of the individuals that bear them . over time",
    ", this process can result in populations that specialize for particular ecological niches and may eventually lead to the emergence of new species .",
    "the study of selection is an important aspect of evolutionary biology as it provides insight about speciation but also about the genetic response of possibly lesser magnitude to environmental variation",
    ". an important goal of such analyses consists in identifying genes or genomic regions that have been the target of selection @xcite . identifying such genes may provide important information about their function which may eventually help improving crops @xcite and livestock @xcite .",
    "recent genotyping techniques make it possible to obtain dna sequences at a high number of genomic locations in a growing number of both model and non - model species @xcite .",
    "this opens the door to methods of identifying regions under selection , even for organisms whose genome is poorly documented ( non - model organisms ) , but the large size of such datasets ( @xmath0-@xmath1 variables ) makes the task a formidable statistical challenge .",
    "so far , identifying genomic regions targeted by selection has relied extensively on the analysis of genetic data alone , based on the idea that , if local selection occurs at a given chromosome region ( or locus ) , differentiation ( genetic difference between population ) will increase at this locus compared with what is theoretically expected at neutral loci @xcite . to further identify the environmental characteristics associated with the observed genetic variation , a recent family of methods attempts to identify loci displaying outstanding correlation with some environmental variables .",
    "this more direct approach has the potential advantage to provide functional information about those conspicuous loci .",
    "the data required for the latter type of analyses typically consist of the genotypes of a set of individuals at various genomic loci and measurements of various environmental variables at the same sampling sites .",
    "the method amounts to quantifying the statistical dependence between allele counts and environmental variables .",
    "the most natural method to model dependence of count data on a quantitative or qualitative variable is the logistic regression , as implemented in this context by @xcite .",
    "however , plain logistic regression assumes that allele counts among different populations or individuals are independent conditionally on the environmental variable .",
    "doing so , logistic regression fails to capture the residual genetic dependence of neighboring individuals or populations due to their common ancestry and recent common evolutionary history .",
    "another method to test the dependence between genetic and environmental variables is the mantel test and its variant the partial mantel test .",
    "these tests attempt to assess the significance of a correlation coefficient by re - sampling with permutations .",
    "they have long been popular methods in ecology and evolution .",
    "however , a recent study @xcite show that they are not appropriate if the data are spatially correlated .",
    "the method proposed by @xcite attempts to model genetic structure by including a random term in the logistic regression in a fashion similar to a generalized linear mixed model .",
    "they propose to do inference with mcmc .",
    "a recent study by @xcite shows that under biologically realistic conditions , accounting for structure in the data as in @xcite improves the accuracy of inferences .",
    "the goal of the present paper is to extend the latter approach by rooting it in a spatially explicit model and implementing inference with an mcmc - free inference approach .",
    "the method proposed is described in the next section .",
    "next we illustrate the method accuracy by analyzing simulated data produced first under a purely geostatistical model then under a biological model that simulates selection explicitly .",
    "we conclude by discussing our results and outlining possible extensions .",
    "we consider a set of individuals observed at various geographical locations .",
    "each individual is genotyped at @xmath2 genetic loci . besides , we consider that these loci are bi - allelic , i.e the sequence observed at a particular locus can be only of two types ( denoted arbitrarily a / a in the sequel ) .",
    "we consider haploid or diploid organisms , i.e. organisms that carry either one or two copies of each chromosome .",
    "a genotype is therefore a vector with @xmath2 entries in @xmath3 or @xmath4 respectively .",
    "as it is frequent to sample more than one individual at each location , we denote by @xmath5 the haploid sample size of population @xmath6 for locus @xmath7 , that is the number of individuals at site @xmath6 genotyped at locus @xmath7 times the number of chromosome copies carried by the organism under study .      to illustrate the method proposed here , we will re - analyse a dataset relative to pine weevils initially produced by @xcite .",
    "anticipating on the results section and for the sake of fleshing out the presentation of the method in the next section , we briefly outline the main features of this dataset .",
    "it consists of 367 pine weevil individuals ( _ hylobius abietis _ ) sampled in 19 geographical locations across europe ( figure [ fig : weevil_coord ] ) .",
    "each individual has been genotyped at 83 genetic markers ( see below for details ) .",
    "this dataset has been analysed by @xcite who looked for signatures of selection by comparing spatial genetic variation to ten environmental variables .",
    "we focus here on a subset consisting of four environmental variables : average diurnal temperature range , number of days with ground frost , average monthly precipitation and average wind speed .",
    "we denote by @xmath8 a collection of geographical coordinates , @xmath9 some measurements of an environmental variable obtained at these sites and @xmath10 the number of alleles of type a at locus @xmath7 observed in a population sampled at site @xmath6 .",
    "we also denote by @xmath11 the local frequency of allele a at geographical location @xmath12 for locus @xmath7 .",
    "we make the assumption that there is no within - population statistical structure and that for organisms harboring more than one copy of each chromosome , the various alleles carried at a locus by an individual are independent and that the allele counts are sampled from a binomial distribution : @xmath13 where @xmath5 denotes the number of alleles sampled ( or haploid sample size ) at site @xmath6 .",
    "the above assumes that the data at hand provide exact information about the alleles carried by each individual .",
    "this is not the case for certain genetic markers such as amplified fragment length polymorphism markers ( aflp ) . with this type of markers",
    ", one can only know whether an individual carries allele @xmath14 or not but the number of copies carried by each individual is not known . for diploid organisms , this leads to a genotype ambiguity : the record of allele @xmath14 may correspond to genotypes @xmath15 or @xmath16 .",
    "we therefore consider an alternative likelihood for the case above where @xmath17 denotes the number of individuals at sampling site @xmath6 for which allele @xmath14 has been observed . still denoting by @xmath11 the frequency of a reference allele @xmath14 at locus @xmath7 at geographical site @xmath6 but we have now @xmath18      we model the dependency between an environmental variable @xmath19 and the allele frequency at locus @xmath7 by assuming that @xmath20 where @xmath21 is an unobserved spatially random effect that accounts for spatial auto - correlation due to population history and @xmath22 are parameters that quantify the locus - specific effect of the environment variable @xmath23 .",
    "the environment variable is observed and is treated as a spatially variable explanatory variable ( fixed effect ) .",
    "the variables @xmath24 are un - observed random effects and are assumed to be independent replicates from the same gaussian random field .",
    "doing so , we assume the absence of linkage disequilibrium ( i.e absence of statistical dependence across loci ) . by assuming a common distribution for all vectors @xmath25",
    ", we inject the key information in the model that there is a characteristic spatial scale that is common to all loci and reflects the species- and area - specific population structure of the data under study .",
    "as commonly done in spatial statistics @xcite , we make the assumption that @xmath26 is 0-mean isotropic and stationary .",
    "further , we assume that the stationary covariance @xmath27 belongs to the matrn family i.e. @xmath28 where @xmath29 is the modified bessel function of the second kind and order @xmath30 , @xmath31 is a scaling parameter and @xmath32 is the marginal variance .",
    "a key feature of the model above is that it can be handled within the theoretical and computational framework developed by @xcite and @xcite .",
    "the former develops a framework for bayesian inference in a broad class of models enjoying a latent gaussian structure .",
    "the latter , bridges a gap between markov random fields and gaussian random fields theory making it possible to combine the flexibility of gaussian random fields for modelling and the computational efficiency of markov random fields for inference .",
    "the approach of @xcite is based on the observation that a gaussian random field @xmath33 with a matrn covariance function is the solution of the stochastic partial differential equation @xmath34 where @xmath35 is the laplacian , @xmath36 is the scale parameter , @xmath37 controls the smoothness and @xmath38 controls the variance . in approximating @xmath33 by @xmath39 where the @xmath40 are basis functions with compact support , one can choose the weights @xmath41 so that the distribution of the function @xmath33 approximates the distribution of the solution of eq .",
    "[ eq : spde ] .",
    "+ the method of @xcite is based on laplace approximations of the various conditional densities involved in the inference of the hyper - parameters and latent variables .",
    "it makes use of the markov structure of the latent variables in the computation .",
    "in contrast with mcmc , the inla method does not compute estimates of the joint posterior distributions of hyper - parameters and latent variables but it only estimates the marginal posterior densities .    casting the present problem in the framework of inla - spde opens the door to accurate and fast computations using the r package inla .",
    "for parameter inference , data relative to all loci are combined into a matrix @xmath42 to compute the marginal posterior distribution @xmath43 and @xmath44 . for computational reasons @xcite ,",
    "the smoothness parameter @xmath37 is taken equal to one .",
    "a log - gamma prior is assumed for @xmath36 and a normal prior is assumed for the fixed effect ( @xmath45 and @xmath46 ) . from these marginal posterior distributions ,",
    "we derive estimates of @xmath36 and @xmath47 as posterior means . in presence of a large number of loci ,",
    "implementing the above on the full dataset may become unpractical due to memory load issues .",
    "in this case we recommend to infer the parameters of the spatial covariance on a random subset of loci .      for each locus , we are concerned with selecting among two competing models : a model in which the environment has an effect , i.e. where @xmath48 $ ] and a reduced model in which the environmental variable has no effect , namely @xmath49 in the previous equation . for the vector @xmath50 of data at locus @xmath7 ,",
    "we denote @xmath51 the evidence or integrated likelihood of data under model @xmath52 . assessing the strength of association with environmental variables of selection",
    "can be done by computing the bayes factor @xmath53 we compute bayes factors @xmath54 and estimate @xmath45 and @xmath46 locus - by - locus . in this second step of computations ,",
    "the variance and scale parameters are fixed to the values inferred from the global dataset @xmath55 as explained in the previous section .",
    "the bayes factors can be used to flag loci displaying outstanding dependence with the environmental variables and rank loci by decreasing evidence of genetic selection .",
    "we analyse here data simulated under the exact model described above .",
    "we consider first a dataset of 1000 bi - allelic dominant markers ( eq . [ eq : clump_binom ] ) for 500 individuals observed at 25 geographical sites uniformly sampled in the unit square ( 20 individuals per site ) , which are typical sample sizes encountered in molecular ecology studies .",
    "for the fixed effects ( eq . [ eq : logit ] ) , we draw @xmath45 , @xmath46 and @xmath9 independently from a @xmath56 distribution . the random effect @xmath25 is a gaussian random field with a matrn covariance function with parameters @xmath57 , @xmath58 and @xmath59 .",
    "the results of inference reported figure [ fig : geostat_r2_aflp ] show an excellent accuracy in the inference of the underlying covariance function and also a good accuracy in the estimation of the fixed effect ( parameters @xmath45 and @xmath46 ) . in the inference with inla , we use everywhere the default prior distributions . in other simulation experiments under the same geostatistical model with other combinations of parameters , we observed sometimes that the estimation of the variance parameter could be inaccurate .",
    "for example , with a range parameter @xmath59 however , this does not seem to affect the accuracy in the estimation of the other parameters .",
    "in particular , the slope @xmath45 in the fixed effect which quantifies the effect of the environmental variable is consistently accurately estimated .    [ cols=\"^,^ \" , ]",
    "the approach we propose extends existing methods in several ways : we introduce a method that ( i ) is spatially explicit , ( ii ) handles spatial coordinates either on @xmath60 ( plan ) or @xmath61 ( sphere ) , ( iii ) works for both co - dominant and dominant markers , ( iv ) is equally well suited for individual data or allele counts aggregated at the population level , ( v ) does not require any calibration step on a subset of neutral loci , ( vi ) can handle quantitative as well as categorical environmental variables , ( vii ) returns bayesian measures of model fit , and ( viii ) does not rely on mcmc computation .",
    "one limit common to the approach proposed here and that of @xcite is that loci are assumed to be conditionally independent ( no residual linkage disequilibrium not accounted for by @xmath26 and @xmath19 ) .",
    "this assumption will be clearly violated for dense snps datasets .",
    "this aspect requires more work for a rigorous and efficient control of false discovery .",
    "however we note that bonferroni - type correction offers a solution to protect oneself against false positives .",
    "moreover , potential linkage disequilibrium not accounted for has no effect affect on the ranking of the loci in terms of evidence of selection .",
    "the approach proposed can be therefore readily used to identify conspicuous loci that are likely to be the target of selection .",
    "the model we described embeds the main features of the models of @xcite and the magnitude of the improvement in terms of inference accuracy brought by the use of an explicit spatial model depends on how much this model complies with the data at hand .",
    "we expect our model to be best suited for datasets at a scale that is large enough to observe genetic variation and spatial auto - correlation but small enough for the stationary model to make sense .",
    "the latter condition suggests that datasets collected at the continental scale may be the best targets for our approach ."
  ],
  "abstract_text": [
    "<S> genomic regions ( or loci ) displaying outstanding correlation with some environmental variables are likely to be under selection and this is the rationale of recent methods of identifying selected loci and retrieving functional information about them . to be efficient , </S>",
    "<S> such methods need to be able to disentangle the potential effect of environmental variables from the confounding effect of population history . for the routine analysis of genome - wide datasets , </S>",
    "<S> one also needs fast inference and model selection algorithms . </S>",
    "<S> we propose a method based on an explicit spatial model which is an instance of spatial generalized linear mixed model ( sglmm ) . for inference , we make use of the inla - spde theoretical and computational framework developed by @xcite and @xcite . </S>",
    "<S> the method we propose allows one to quantify the correlation between genotypes and environmental variables . </S>",
    "<S> it works for the most common types of genetic markers , obtained either at the individual or at the population level . analyzing simulated data produced under a geostatistical model then under an explicit model of selection , we show that the method is efficient . </S>",
    "<S> we also re - analyze a dataset relative to nineteen pine weevils ( _ hylobius abietis _ ) populations across europe . </S>",
    "<S> the method proposed appears also as a statistically sound alternative to the mantel tests for testing the association between genetic and environmental variables . </S>",
    "<S> +    snp and aflp data , genomics , spatial population structure , mantel test , model choice , mcmc - free method , inla , gmrf . </S>"
  ]
}