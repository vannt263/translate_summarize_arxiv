{
  "article_text": [
    "the probability density function ( pdf ) @xmath0 of a reconstructed characteristic @xmath1 of an event obtained from a detector with finite resolution and limited acceptance can be represented as @xmath2 where @xmath3 is the true pdf , @xmath4 is the acceptance of the setup , i.e. the probability of recording an event with a characteristic @xmath5 , and @xmath6 is the experimental resolution , i.e. the probability of obtaining @xmath1 instead of @xmath5 after the reconstruction of the event .",
    "the integration in ( [ p1_main ] ) is carried out over the domain @xmath7 of the variable @xmath5 and the domain @xmath8 of the variable @xmath1 .",
    "there are two ways of fitting a parametric model @xmath9 of the true pdf to reconstructed data :    1 .",
    "find an estimate @xmath10 of the true pdf @xmath3 by solving an unfolding problem , and then fit a parametric model of the true pdf @xmath11 @xmath12 to the unfolded distribution @xmath10 .",
    "2 .   fit a parametric model of the reconstructed pdf , that is , @xmath13 directly to the reconstructed data .",
    "these two possibilities have been discussed in @xcite .",
    "the acceptance @xmath4 and the resolution function @xmath14 must be defined for both methods . in the majority of cases , they can not be found analytically , and a monte carlo method is used instead for that purpose .",
    "the unfolding ( inverse ) problem is known to be an ill - posed problem and can not be solved without a priori information about the solution .",
    "any solution of this problem has , in addition to statistical errors due to the finite statistics of the experimental data , also systematic errors related to the use of a priori information .",
    "these systematic errors have an influence on the choice of the parametric model and the estimation of the parameters in the first method .",
    "the second method is preferable in many cases .",
    "after discretization of the problem , the authors of @xcite found the acceptance function @xmath4 and the resolution function @xmath14 , and then used these functions to fit the parameters of the true distribution .",
    "the main disadvantage of this approach is that the resolution function @xmath14 , which is a matrix after discretization , has rather noisy matrix elements because in real cases the size of the monte carlo sample of events is of the same order as the size of the experimental sample of events .",
    "another source of uncertainty is the discretization .",
    "also , the authors of @xcite did not propose a statistic that could be used for a goodness - of - fit test .    in @xcite , a reweighting procedure for fitting a monte carlo reconstructed distribution to the reconstructed data",
    "was proposed .",
    "the procedure was presented rather sketchily , and can not be repeated even for the example that was used in @xcite for illustration .",
    "there is not a clear explanation of how the parameters and the errors in them were calculated .",
    "the authors of @xcite stated , without proof , that the statistic used for the fitting of the parameters had a @xmath15 distribution but did not define the number of degrees of freedom .",
    "this makes it impossible to use this statistic for choosing the best model from a set of alternative parametric models .",
    "recently , a test for comparing a weighted histogram @xcite that is a generalization of the classical chi - square test @xcite has been proposed . in this paper",
    ", we apply the results obtained in @xcite to develop a procedure for direct parametric fitting of data obtained from detectors with finite resolution and limited acceptance .",
    "this paper is organized as follows . in section 2 , a method for fitting the parameters of the model of the true pdf to the data and a goodness - of - fit test are proposed . a statistic for comparing a histogram with unweighted entries and a histogram with weights that depend on the parameters",
    "is used for that purpose . in section 3 , a numerical example that demonstrates how one can estimate the parameters and the statistical errors in them",
    "practically is presented . a numerical experiment with 10000 runs",
    "is described to validate the proposed method .",
    "we consider the pdf @xmath16 of a reconstructed characteristic of experimental events and the pdf @xmath17 of the corresponding reconstructed characteristic of the monte carlo events for the same detector .    a histogram with @xmath18 bins for a given pdf @xmath16",
    "is used to estimate the probability @xmath19 that a random event belongs in bin @xmath20 : @xmath21 the integration in ( [ p1 ] ) is carried out over the bin @xmath22 , and @xmath23 .",
    "the histogram can be obtained as the result of a random experiment with the pdf @xmath16 .",
    "we denote the number of random events belonging to the @xmath20th bin of the histogram by @xmath24 . the total number of events in the histogram is equal to @xmath25 .",
    "the quantity @xmath26 is an estimator of @xmath19 with an expectation value @xmath27 .",
    "a histogram of the monte carlo reconstructed pdf @xmath17 can be obtained as the result of a random experiment ( simulation ) that has three steps",
    "@xcite :    1 .",
    "a random value @xmath5 is chosen according to a pdf @xmath28 .",
    "the function @xmath28 is some expected true ( initial ) distribution defined in the domain @xmath7 .",
    "we go back to step 1 again with probability @xmath29 , and to step 3 with probability @xmath4 .",
    "a random value @xmath1 is chosen according to the pdf @xmath14 .",
    "the events @xmath1 are distributed according to the pdf @xmath30 , where @xmath31 the quantity @xmath32 , where @xmath33 is the number of events belonging to the @xmath20th bin for a histogram with total number of events @xmath34 , is an estimator of @xmath35 , @xmath36 with the expectation value of the estimator equal to @xmath37 it is expected that @xmath4 and the resolution function @xmath14 for the real setup and for the monte carlo simulation will be the same .",
    "this is achieved by adjusting the monte carlo simulation program and by a suitable choice of the domains @xmath38 and @xmath8 of the variables @xmath5 and @xmath1 .    in experimental particle and nuclear physics , step 3",
    "is the most time - consuming step of the monte carlo simulation .",
    "this step is related to the simulation of the process of transport of particles through a medium and the rather complex registration apparatus .    to use the results of the simulation with an initial pdf @xmath28 to calculate a histogram of events distributed according to the pdf @xmath39 with a true pdf @xmath3 ,",
    "we write the equation for @xmath40 in the form    @xmath41    where @xmath42 is the weight function . because of the condition @xmath43",
    ", we shall call the weights defined above `` normalized weights '' from now on , as opposed to the unnormalized weights @xmath44 , which are given by @xmath45 .",
    "the monte carlo reconstructed histogram for the pdf @xmath39 can be obtained using reconstructed events for the pdf @xmath46 with weights calculated according to ( [ fweight ] ) . in this way , we avoid step 3 of the simulation procedure , which is important in cases where one needs to calculate monte carlo reconstructed histograms for many different true pdfs .",
    "we denote the sum of the weights of the events in the @xmath20th bin of the histogram with normalized weights by @xmath47 where @xmath33 is the number of events in bin @xmath20 and @xmath48 is the weight of the @xmath49th event in the @xmath20th bin .",
    "the quantity @xmath50 is an estimator of @xmath40 with expectation value @xmath51 .",
    "a frequently used technique in data analysis is the comparison of a reconstructed pdf with a monte carlo reconstructed pdf through a comparison of histograms .",
    "the hypothesis of homogeneity @xcite states that the two histograms represent random values with identical distributions .",
    "this is equivalent to assuming that there exist @xmath18 constants @xmath52 such that @xmath53 and that the probability of belonging to the @xmath20th bin for some measured value in the experiment and in the monte carlo simulation is equal to @xmath54 .    from here onwards ,",
    "we use the weighted histogram with _ unnormalized _ weights and @xmath55 denote the sum of the weights of the events in bin @xmath20 .",
    "this is convenient because the calculation of normalization factors is quite problematic in many practical cases .",
    "we introduce the statistics @xcite @xmath56 where @xmath57 and @xmath58 with the sums extending over all bins @xmath20 except one bin @xmath49 . in these equations ,",
    "the probabilities @xmath54 are unknown , and estimators of @xmath59 can be found by minimization of ( [ sssu ] ) .",
    "we denote by @xmath60 the value of @xmath61 after substitution of the estimators @xmath59 into ( [ sssu ] ) .",
    "as shown in @xcite , the statistic @xmath62 approximately has a @xmath63 distribution if the hypothesis of homogeneity is valid .",
    "we substitute the pdf @xmath3 by the parametric formula @xmath64 ; the weights of the monte carlo events and the statistic @xmath65 are then dependent on the parameters .",
    "the estimators @xmath66 of the parameters @xmath67 can be found by minimization of this statistic . the statistic @xmath68 has a @xmath69 distribution if the parametric model fits the data , because @xmath70 parameters are estimated .",
    "it can be used for a goodness - of - fit test for selection of the best model from a set of alternative models .",
    "in this section two examples are presented to illustrate and validate the fitting procedure .",
    "we took the true pdf , as in @xcite , to be of the form @xmath71 defined on the interval [ 0,1 ] .",
    "the reconstructed pdf was defined as @xmath72 with an acceptance function @xmath73 and a resolution function of the form @xmath74 with @xmath75 .",
    "the domain of the variable @xmath5 was taken as @xmath76 $ ] and that of @xmath1 as @xmath77 $ ] .",
    "a simulation of events with a pdf @xmath16 was done according to the algorithm described in the previous section .    for the monte carlo reconstructed pdf , we used the initial pdf @xmath78 and chose the parametrization for the true pdf in the form @xmath79 the monte carlo reconstructed pdf was defined as @xmath80 monte carlo events were simulated according to the algorithm described in the previous section with @xmath28 as the initial pdf .",
    "weights of events were calculated according to the formula @xmath81 . reconstructed and",
    "monte carlo reconstructed samples were simulated by generating @xmath82 , @xmath83 , and @xmath84 events in the first step .",
    "we chose 5-bin and 20-bin histograms and used pairs of histograms with various numbers of events in the fitting procedure .",
    "10000 simulation runs were done for each case . to investigate the fitting procedure ,",
    "the following quantities were calculated :    * average values @xmath85 of the estimated parameter , where @xmath20 is the run number .",
    "* average statistical errors @xmath86 of the estimated parameter . for this purpose ,",
    "the various realizations of the estimator @xmath87 were ordered , and then the positive error was defined as the minimal interval with lower bound @xmath88 that contained 34.1345% of the realizations of @xmath89 and the negative error was defined as the minimal interval with upper bound @xmath90 that contained 34.1345% . *",
    "the real sizes of the test @xmath91 for a nominal test size @xmath92 were estimated as the fraction of runs that had a @xmath93-value lower than 5% .",
    "the program minuit @xcite was used for the minimization of @xmath94 and for error analysis .",
    "the results of this calculation are presented in table 1 .",
    "we may notice that the estimators are biased in the cases where at least one histogram is the result of a simulation of @xmath95 events .",
    "the bias is lower for 20-bin than for 5-bin histograms .",
    "the errors are asymmetric , and the asymmetry is reduced if the statistics of the generated events are reduced .",
    "the sizes of the tests @xmath91 are close to the nominal value of @xmath92 ; see @xcite for details of the method of comparison .    in the right part of table 1",
    ", we present results of calculations for the case where @xmath96 , or @xmath97 , which helps us to understand the effect of the resolution function .",
    "the results of calculations for  infinite \" statistics of the monte carlo simulation are also presented . in this case , the data histograms were fitted by probabilities @xmath98 that were calculated analytically : @xmath99 where @xmath100 is the lower bound of bin @xmath20 .",
    "the statistic @xmath101 was used to estimate the parameters and for goodness - of - fit tests .",
    "this case represents the best result that can be achieved for given statistics of the data , and is useful for comparison .",
    "the results presented in table 1 show that a deterioration of the resolution leads to an increase in the statistical error of @xmath102 and also a bias .",
    "we observe an asymmetry in the errors even in the case of an  infinite \" monte carlo simulation .",
    "note that the statistics ( [ goodness ] ) for the estimated values of the parameters @xmath103 have a @xmath63 distribution if the experimental histogram is the result of a random experiment with probabilities @xmath104 @xcite .    for the purposes of illustration , we present the results of a parametric fit of the monte carlo results to the data for one of the cases described above .",
    "the numbers of generated events for the data and the monte carlo simulation were taken equal to @xmath105 , and we used histograms with 20 bins .",
    "the result of fitting with minuit was @xmath106 , with @xmath107 and the @xmath93-value equal to 0.82 .",
    "a comparison of the histograms of the true pdf with the weighted histogram of the monte carlo true pdf gave @xmath108 , and the @xmath93-value was equal to 0.45 .",
    "figure 1a shows the histograms of the reconstructed pdf and of the monte carlo reconstructed pdf , calculated with the weights of the events equal to @xmath109 .",
    "figure 1b shows the histograms of the true pdf and of the monte carlo true pdf .",
    "+ for convenience of visual comparison , the monte carlo histograms have been divided by a factor @xmath110 in both figures .",
    "we took the true pdf to be of the form @xmath111 defined on the interval [ 4,16 ] .",
    "the reconstructed pdf @xmath16 was defined according ( [ reco ] ) with an acceptance function @xmath112 and a resolution function of the form defined by formula ( [ gauss ] ) with @xmath113 .",
    "the domain of the variable @xmath5 was taken as @xmath114 $ ] and that of @xmath1 as @xmath115 $ ] .",
    "a simulation of events with a pdf @xmath16 was done according to the algorithm described in the previous section .",
    "for the monte carlo reconstructed pdf , we used the initial pdf @xmath116 and chose the parametrization for the true pdf in the form @xmath117 the monte carlo reconstructed pdf @xmath17 was defined according formula ( [ mrec ] ) .",
    "monte carlo events were simulated according to the algorithm described in the previous section with @xmath28 as the initial pdf .",
    "weights of events were calculated according to the formula @xmath118 . reconstructed and monte carlo reconstructed samples were simulated by generating @xmath83 , and @xmath119 events in the first step .",
    "we chose 40-bins histogram .",
    "the result of fitting with minuit was @xmath120 , @xmath121 and @xmath122 , with @xmath123 and the @xmath93-value equal to 0.70 .",
    "a comparison of the histograms of the true pdf with the weighted histogram of the monte carlo true pdf gave @xmath124 , and the @xmath93-value was equal to 0.15 .",
    "figure 2a shows the histograms of the reconstructed pdf and of the monte carlo reconstructed pdf , calculated with the weights of the events equal to @xmath125 .",
    "figure 2b shows the histograms of the true pdf and of the monte carlo true pdf . for convenience of visual comparison ,",
    "the monte carlo histograms have been divided by a factor @xmath126 in both figures .",
    "@xmath127{fit_measured.eps } \\hspace*{-1.58 cm }   \\includegraphics[width=3.1in]{fit_true.eps } \\end{array}$ ]    @xmath127{fit_measured2.eps } \\hspace*{-1.58 cm }   \\includegraphics[width=3.1in]{fit_true2.eps } \\end{array}$ ]    [ cols= \" < , < , < , < , < , < , < , < \" , ]",
    "a method of fitting a parametric model to data measured with a detector with finite resolution and limited acceptance has been developed .",
    "it was developed as an application of a test for comparing histograms with unweighted entries and histograms with unnormalized weights proposed in previous work by the present author .",
    "the method demonstrates a new approach to the direct parametric fitting of experimental data that permits one to decrease the systematic errors in the estimated parameters .",
    "it is a rather flexible tool for data analysis that can be used with multidimensional data , and does not have any restrictions on the configuration of the bins or the domain of the variables investigated .",
    "a goodness - of - fit test has been proposed that can be used for selection of the best parametric model from a set of alternative models for describing the data .",
    "an evaluation of the method has been done numerically for histograms with various numbers of bins and numbers of events .",
    "a numerical examples have been given to demonstrate the use of the method in practice .",
    "ammosov , z.u .",
    "usubov , v.p .",
    "zhigunov , nucl .",
    "instr . meth .",
    "a295 ( 1990 ) 224 - 230 . g. bohm , g. zech , introduction to statistics and data analysis for physicists , verlag deutsches elektronen - synchrotron , 2010 .",
    "gagunashvili , nucl .",
    "instr . meth . a614 ( 2010 ) 287 - 296 . h. cramer , mathematical methods of statistics , princeton university press , princeton , 1999 . i.m .",
    "sobol , numerical monte carlo methods , nauka , moscow , 1973 ( in russian ) .",
    "f. james , m. roos , comput .",
    "commun . 10",
    "( 1975 ) 343 - 367 ."
  ],
  "abstract_text": [
    "<S> a goodness - of - fit test for the fitting of a parametric model to data obtained from a detector with finite resolution and limited acceptance is proposed . </S>",
    "<S> the parameters of the model are found by minimization of a statistic that is used for comparing experimental data and simulated reconstructed data . </S>",
    "<S> numerical examples are presented to illustrate and validate the fitting procedure .    </S>",
    "<S> fit monte carlo distribution to data , comparison experimental and simulated data , homogeneity test , weighted histogram , inverse problem , unfolding problem </S>"
  ]
}