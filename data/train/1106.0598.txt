{
  "article_text": [
    "we consider canonical hamiltonian systems in the form @xmath2 where @xmath3 is a smooth real - valued function .",
    "our interest is in researching numerical methods that provide approximations @xmath4 to the true solution along which the energy is precisely conserved , namely @xmath5    the study of energy - preserving methods form a branch of _ geometrical numerical integration _ , a research topic whose main aim is preserving qualitative features of simulated differential equations . in this context ,",
    "symplectic methods have had considerable attention due to their good long - time behavior as compared to standard methods for odes @xcite . a related interesting approach based upon",
    "exponential / trigonometric fitting may be found in @xcite .",
    "unfortunately , symplecticity can not be fully combined with the energy preservation property @xcite , and this partly explains why the latter has been absent from the scene for a long time .    among the first examples of energy - preserving methods we mention discrete gradient schemes @xcite which are defined by devising discrete analogs of the gradient function . the first formulae in this class had order at most two but recently discrete gradient methods of arbitrarily high order have been researched by considering the simpler case of systems with one - degree of freedom @xcite .    here",
    ", the key tool we wish to exploit is the well - known line integral associated with conservative vector fields , such us the one defined at , as well as its discrete version , the so called _ discrete line integral_. interestingly , the line integral provides a means to check the energy conservation property , namely @xmath6   & = h\\displaystyle \\int_0 ^ 1 \\nabla^t h(y(t_0+\\tau h ) ) j^t   \\nabla h(y(t_0+\\tau h ) ) \\d \\tau = 0 , \\end{array}\\ ] ] with @xmath7 , that can be easily converted into a discrete analog by considering a quadrature formula in place of the integral .",
    "the discretization process requires to change the curve @xmath8 in the phase space @xmath9 to a simpler curve @xmath10 ( generally but not necessarily a polynomial ) , which is meant to yield the approximation at time @xmath11 , that is @xmath12 , where @xmath13 is the order of the resulting numerical method . in a certain sense",
    ", the problem of numerically solving while preserving the hamiltonian function is translated into a quadrature problem .",
    "for example , consider the segment @xmath14 , with @xmath15 $ ] , joining @xmath16 to an unknown point @xmath17 of the phase space .",
    "the line integral of @xmath18 evaluated along @xmath19 becomes @xmath20 now assume that @xmath21 is a polynomial of degree @xmath22 in the generalized coordinates @xmath23 and in the momenta @xmath13 .",
    "the integrand in is a polynomial of degree @xmath24 in @xmath25 and can be exactly solved by any quadrature formula with abscissae @xmath26 in @xmath27 $ ] and weights @xmath28 , having degree of precision @xmath29 .",
    "we thus obtain @xmath30 to get the energy conservation property we impose that @xmath31 be orthogonal to the above sum , and in particular we choose ( for the sake of generality we use @xmath32 in place of @xmath33 to mean that the resulting method also makes sense when applied to a general ordinary differential equation @xmath34 ) @xmath35 formula defines a runge  kutta method with butcher tableau @xmath36 , where @xmath25 and @xmath37 are the vectors of the abscissae and weights , respectively .",
    "the stages @xmath38 are called _ silent stages _ since their presence does not affect the degree of nonlinearity of the system to be solved at each step of the integration procedure : the only unknown is @xmath17 and consequently defines a mono - implicit method .",
    "mono - implicit methods of runge  kutta type have been researched in the past by several authors ( see , for example , @xcite for their use in the solution of initial value problems ) .",
    "methods such as date back to 2007 @xcite and are called @xmath39-stage trapezoidal methods since on the one hand the choice @xmath40 , @xmath41 , @xmath42 leads to the trapezoidal method and on the other hand all other methods evidently become the trapezoidal method when applied to linear problems .",
    "generalizations of to higher orders require the use of a polynomial @xmath19 of higher degree and are based upon the same reasoning as the one discussed above . up to now",
    ", such extensions have taken the form of runge  kutta methods @xcite .",
    "it has been shown that choosing a proper polynomial @xmath19 of degree @xmath43 yields a runge  kutta method of order @xmath44 with @xmath45 stages .",
    "the peculiarity of such energy - preserving formulae , called hamiltonian boundary value methods ( hbvms ) , is that the associated butcher matrix has rank @xmath43 rather than @xmath39 , since @xmath46 stages may be cast as linear combinations of the remaining ones , similarly to the stages @xmath38 in . as a consequence ,",
    "the nonlinear system to be solved at each step has dimension @xmath47 instead of @xmath48 , which is better visualized by recasting the method in block - bvm form @xcite .    in the case where @xmath3 is not a polynomial ,",
    "one can still get a _",
    "practical _ energy conservation by choosing @xmath39 large enough so that the quadrature formula approximates the corresponding integral to within machine precision . strictly speaking , taking the limit as @xmath49 leads to limit formulae where the integrals come back into play in place of the sums .",
    "for example , letting @xmath50 in just means that the integral in must not be discretized at all , which would yield the _ averaged vector field _",
    "method @xmath51 , ( see @xcite for details ) .    in this paper",
    "we start an investigation that follows a different route . unlike the case with hbvms",
    ", we want now to take advantage of the previously computed approximations to extend the class in such a way to increase the order of the resulting methods , much as the class of linear multistep method may be viewed as a generalization of ( linear ) one step methods .",
    "the general question we want to address is whether there exist @xmath39-step mono - implicit energy - preserving methods of order greater than two .",
    "clearly , the main motivation is to reduce the computational cost associated with the implementation of hbvms .",
    "the purpose of the present paper is to give an affermative answer to this issue in the case @xmath40 .",
    "more specifically , the method resulting from our analysis , summarized by formula , may be thought of as a nearly linear two - step method in that it is the sum of a fourth order linear two - step method , formula , plus a nonlinear correction of higher order .",
    "the paper is organized as follows . in section [ def_methods ]",
    "we introduce the general formulation of the method , by which we mean that the integrals are initially not discretized to maintain the theory at a general level . in this section",
    "we also report a brief description of the hbvm of order four , since its properties will be later exploited to deduce the order of the new method : this will be the subject of section [ analysis_sec ] .",
    "section [ discr_sec ] is devoted to the discretization of the integrals , which will produce the final form of the methods making them ready for implementation .",
    "a few test problems are presented in section [ test_sec ] to confirm the theoretical results .",
    "suppose that @xmath17 is an approximation to the true solution @xmath8 at time @xmath11 , where @xmath52 is the stepsize of integration .",
    "more precisely , we assume that    * @xmath53 with @xmath54 ; * @xmath55 , which means that @xmath17 lies on the very same manifold @xmath56 as the continuous solution @xmath8 .",
    "the two above assumptions are fulfilled if , for example , we compute @xmath17 by means of a hbvm ( or an @xmath57-hbvm @xcite ) of order @xmath58 .",
    "the new approximation @xmath59 is constructed as follows .",
    "consider the quadratic polynomial @xmath60 that interpolates the set of data @xmath61 .",
    "expanded along the newton basis @xmath62 defined on the nodes @xmath63 , @xmath64 , @xmath65 , the polynomial @xmath19 takes the form ( for convenience we order the nodes as @xmath66 ) @xmath67 as @xmath68 ranges in the interval @xmath27 $ ] , the @xmath69-length vector @xmath70 describes a curve in the phase space @xmath9 . the line integral of the conservative vector field @xmath18 along the curve @xmath71 will match the variation of the energy function @xmath3 , that is @xmath72^t   \\nabla h(\\gamma(\\tau ) ) \\ ,   \\d \\tau \\\\[.5 cm ] &   \\hspace*{-1.5 cm } \\displaystyle = ( y_2-y_0)^t \\int_0 ^ 1 \\nabla h(\\gamma(\\tau ) ) \\ , \\mathrm{d}\\tau   + 2(y_2 - 2y_1+y_0)^t \\int_0 ^ 1 ( 2\\tau-1 ) \\nabla h(\\gamma(\\tau ) ) \\ , \\mathrm{d}\\tau .",
    "\\end{array}\\ ] ] the energy conservation condition @xmath73 yields the following equation in the unknown @xmath74 @xmath75 the method we are interested in has the form @xmath76 , where @xmath77 is implicitly defined by the following nonlinear equation in the unknown @xmath78 : @xmath79 where the residual @xmath80 is defined as @xmath81 a direct computation shows that any solution @xmath82 of also satisfies . in the next section we will show that admits a unique solution @xmath83 satisfying the order condition @xmath84",
    ". such a result will be derived by regarding as a perturbation of the hbvm of order @xmath85 and , in turn , by comparing the two associated numerical solutions . to this end and to better explain the genesis of formula and the role of the integrals therein , a brief introduction of the hbvm formula of order four is in order .",
    "suppose that both @xmath17 and @xmath86 are unknown ( so now @xmath17 is no longer given a priori as indicated by assumption ( @xmath87 ) ) : let us call them @xmath88 and @xmath89 respectively .",
    "for to be satisfied , we can impose the two orthogonality conditions @xmath90 \\displaystyle   u_2 - 2u_1+y_0    = \\eta_2 h j \\int_0 ^ 1 ( 2\\tau-1 ) \\nabla h(\\gamma(\\tau ) ) \\ , \\mathrm{d}\\tau , \\end{array } \\right.\\ ] ] giving rise to a system of two block - equations ( the curve @xmath91 is as in with @xmath88 and @xmath89 in place of @xmath17 and @xmath86 ) . setting the free constants @xmath92 and @xmath93 equal to @xmath94 and @xmath95 ,",
    "respectively , confers the highest possible order , namely @xmath85 , on the resulting method : @xmath96 ( see @xcite for details).$ ] of length @xmath97 , we have scaled the constants @xmath92 and @xmath93 by a factor two with respect to the values reported in @xcite . ]",
    "furthermore , it may be shown that the internal stage @xmath88 satisfies the order condition @xmath98 .",
    "evidently , the implementation of on a computer can not leave out of consideration the issue of solving the integrals appearing in both equations .",
    "two different situations may emerge :    * the hamiltonian function @xmath3 is a polynomial of degree @xmath22 . in such a case ,",
    "the two integrals in are exactly computed by a quadrature formula having degree of precision @xmath99 .",
    "* @xmath3 is not a polynomial , nor do the two integrands admit a primitive function in closed form .",
    "again , an appropriate quadrature formula can be used to approximate the two integrals to within machine precision , so that no substantial difference is expected during the implementation process by replacing the integrals by their discrete counterparts .",
    "case ( a ) gives rise to an infinite family of runge - kutta methods , each depending on the specific choice ( number and distribution ) of nodes the quadrature formula is based upon ( see @xcite for a general introduction on hbvms and @xcite for their relation with standard collocation methods ) . for example , choosing @xmath39 nodes according to a gauss distribution over the interval @xmath27 $ ] results in a method that precisely conserves the energy if applied to polynomial canonical hamiltonian systems with @xmath100 and that becomes the classical @xmath94-stage gauss collocation method when @xmath40 . on the other hand , choosing a lobatto distribution yields a runge - kutta method that preserves polynomial hamiltonian functions of degree @xmath101 and that becomes the lobatto iiia method of order four when @xmath40 .",
    "the method resulting from case ( b ) are undistinguishable from the original formulae in that they are energy - preserving up to machine precision when applied to any regular canonical hamiltonian system",
    ". stated differently , may be viewed as the limit of the family of hbvms of order four , as the number of nodes tends to infinity .",
    "for this reason the limit formulae have been called @xmath57-hbvm of order @xmath85 ( see @xcite ) .    in the present context ,",
    "@xmath17 being a known quantity , the unknown @xmath78 in can not in general satisfy , at the same time , both orthogonality conditions in .",
    "however , since @xmath17 may be thought of as an approximation of order four to the quantity @xmath88 in , should we only impose the first orthogonality condition , namely @xmath102 we would expect the residual @xmath80 ( the right hand side of ) to be very small .",
    "below , it is not difficult to show that actually implies @xmath103 .",
    "this aspect is further emphasized in the numerical test section ( see table [ tab2 ] ) . ]",
    "this suggests that a solution to that yields an approximation of high order to @xmath104 may be obtained by allowing a small deviation from orthogonality in .",
    "this is accomplished by setting @xmath105 , and by tuning the perturbation parameter @xmath106 in such a way that be satisfied : this evidently gives @xmath107 and we arrive at .",
    "results on the existence and uniqueness of a solution of as well as on its order of accuracy will be derived by first analyzing the simpler nonlinear system @xmath108 obtained by neglecting the correction term @xmath109 .",
    "for @xmath110 we set ( see ) @xmath111 and ( see ) @xmath112 in the following @xmath113 will denote the @xmath94-norm .",
    "[ lem1 ] there exist positive constants @xmath114 and @xmath115 such that , for @xmath116 , system admits a unique solution @xmath117 in the ball @xmath118 of center @xmath16 and radius @xmath114 .",
    "we show that constants @xmath119 exist such that the function defined in satisfies the following two conditions for @xmath120 :    * @xmath121 is a contraction on @xmath118 , namely @xmath122 * @xmath123 .",
    "the contraction mapping theorem can then be applied to obtain the assertion .",
    "let @xmath118 a ball centered at @xmath16 with radius @xmath114 .",
    "we can choose @xmath124 and @xmath114 small enough that the image set @xmath125,~ z\\in b(y_0,\\rho),~h\\le h'_0\\}$ ] is entirely contained in a ball @xmath126 which , in turn , is contained in the domain of @xmath127 .",
    "is an open simply connected subset of @xmath9 containing @xmath118 while , from the assumption ( @xmath87 ) , decreasing @xmath1 causes the point @xmath17 to approach @xmath16 . ]",
    "we set @xmath128 from and we have @xmath129 and hence @xmath130 consequently ( a ) is satisfied by choosing @xmath131 and @xmath132 . concerning ( b ) ,",
    "we observe that @xmath133 hence @xmath134 with @xmath135 bounded with respect to @xmath1 . since @xmath136 vanishes with @xmath1 ( see ( [ lcond ] ) ) , we can always tune @xmath115 in such a way that @xmath137 .",
    "[ lem2 ] the solution @xmath117 of satisfies @xmath138 .    under the assumption ( @xmath87 ) ,",
    "may be regarded as a perturbation of system , since @xmath17 and @xmath88 are @xmath0 and @xmath139 close to @xmath140 respectively .. ] since @xmath141 , we can estimate the accuracy of @xmath117 as an approximation of @xmath142 by evaluating its distance from @xmath89 .",
    "let @xmath143 be the underlying quadratic curve associated with the hbvm defined by , namely @xmath144 considering that ( see ) @xmath145 from the first equation in and we get @xmath146 & \\displaystyle   + 8hj \\int_0 ^ 1 \\nabla^2 h(\\tilde \\gamma(\\tau))\\tau(\\tau-1 ) \\,\\d",
    "\\tau \\cdot ( u_1-y_1 ) + o(||u_1-y_1||^2 ) \\\\[.4 cm ] = & \\displaystyle u_2+o(h^5 ) .",
    "\\end{array}\\ ] ] if @xmath1 is small enough , @xmath89 will be inside the ball @xmath118 defined in lemma [ lem1 ] . the lipschitz condition yields ( see ) @xmath147 and hence @xmath148 .",
    "the above result states that defines a method of order @xmath85 which is a simplified ( non corrected ) version of our conservative method defined at . in section [ test_sec ] the behavior of these two methods will be compared on a set of test problems .",
    "we now state the analogous results for system .",
    "[ th1 ] under the assumption ( @xmath87 ) , for @xmath1 small enough , equation admits a unique solution @xmath82 satisfying @xmath149 .",
    "consider the solution @xmath117 of system .",
    "we have ( see ) @xmath150 and @xmath151 hence , by virtue of , @xmath152^t \\left[\\int_0 ^ 1 ( 2\\tau-1)\\nabla h(\\tilde \\gamma(\\tau ) ) \\ , \\d \\tau + o(h^5)\\right]=o(h^5).\\ ] ] since @xmath153 is bounded with respect to @xmath1 , it follows that , in a neighborhood of @xmath117 , system may be regarded as a perturbation of system , the perturbation term being @xmath154 .",
    "consider the ball @xmath155 : since @xmath156 , and @xmath157 , this ball is contained in @xmath158 defined in lemma [ lem1 ] and the perturbed function @xmath159 is a contraction therein , provided @xmath1 is small enough .",
    "evaluating the right - hand side of at @xmath160 we get @xmath161 which means that property ( b ) listed in the proof of lemma [ lem1 ] , with @xmath117 in place of @xmath16 , holds true for the perturbed function @xmath162 , and the contraction mapping theorem may be again exploited to deduce the assertion .",
    "as was stressed in section [ def_methods ] , formula is not operative unless a technique to solve the two integrals is taken into account .",
    "the most obvious choice is to compute the integrals by means of a suitable quadrature formula which may be assumed exact in the case where the hamiltonian function is a polynomial , and to provide an approximation to within machine precision in all other cases .",
    "hereafter we assume that @xmath163 is a polynomial in @xmath23 and @xmath13 of degree @xmath22 .",
    "since @xmath164 has degree two , it follows that the integrand functions appearing in the definitions of @xmath165 and @xmath80 at and have degree @xmath166 and @xmath167 respectively and can be solved by any quadrature formula with abscissae @xmath26 in @xmath27 $ ] and weights @xmath28 , having degree of precision @xmath168 . in place of we now consider the equivalent form suitable for implementation @xmath169 where @xmath170 notice that from we get @xmath171 that is , @xmath172 is a linear combination , actually a weighted average , of the approximations @xmath16 , @xmath17 and @xmath86 .",
    "therefore , since @xmath173 ( see lemma  [ lem2 ] and theorem  [ th1 ] ) , we may look at this term as a nonlinear correction of the generalized linear multistep method @xmath174    if @xmath163 is quadratic , we can choose @xmath175 , @xmath41 , @xmath176 , @xmath177 , @xmath178 and @xmath179 , that is we can use simpson s quadrature formula to compute the integrals in and . since , in such a case , @xmath180 , method becomes @xmath181 that is , the standard milne - simpson s method .    in all other cases",
    "@xmath172 will differ in general from @xmath182 , @xmath183 and may be regarded as an off - point entry in formula . in the sequel",
    "we will denote the method defined at by @xmath184 and its linear part , defined at , by @xmath185 .",
    "of course , the choice of the abscissae distribution influences the energy preserving properties of the method @xmath184 , as is indicated in table [ nodes - distribution - table ] .",
    ".energy preserving properties of method @xmath184 for some well - known distributions of the nodes @xmath186 . [ cols=\"^,^,^,^\",options=\"header \" , ]      we finally consider the non - polynomial hamiltonian function @xmath187 that defines the well known kepler problem , namely the motion of two masses under the action of their mutual gravitational attraction .",
    "taking as initial condition @xmath188 yields an elliptic periodic orbit of period @xmath189 and eccentricity @xmath190 .",
    "we have chosen @xmath191 .",
    "though the vector field fails to be a polynomial in @xmath192 and @xmath193 , we can plan to use a sufficiently large number of quadrature nodes to discretize the integrals in so that the corresponding accuracy is within the machine precision . under this assumption , and taking aside the effect of the floating point arithmetic , the computer will make no difference between the conservative formulae and their discrete counterparts .",
    "the left picture in figure [ kepler_fig1 ] explains the above argument .",
    "it reports the error @xmath194 in the hamiltonian function for various choices of the number of lobatto nodes , and precisely @xmath195 .",
    "we see that the error decreases quickly as the number of nodes is incremented and for @xmath196 it is within the epsilon machine .",
    "the use of finite arithmetic may sometimes cause a mild numerical drift of the energy over long times , like the one shown in the upper line in the right picture of figure [ kepler_fig1 ] .",
    "this is due to the fact that on a computer the numerical solution satisfy the conservation relation @xmath197 up to machine precision times the conditioning number of the nonlinear system that is to be solved at each step .    to prevent the accumulation of roundoff errors",
    "we may apply a simple and costless _ correction _ technique on the approximation @xmath198 which consists in a single step of a gradient descent method ( see also @xcite ) .",
    "more precisely , the corrected solution @xmath199 is defined by @xmath200 which stems from choosing as @xmath201 the value that minimizes the linear part of the function @xmath202 .",
    "the bottom line in the right picture of figure [ kepler_fig1 ] shows the energy conservation property of the corrected solution .     produced by methods @xmath184 , with @xmath195 .",
    "parameters : stepsize @xmath203 , integration interval @xmath204 $ ] .",
    "right picture .",
    "roundoff errors may cause a drift of the numerical hamiltonian function ( upper line ) which can be easily taken under control by coupling the method with a costless correction procedure like the one described at .,title=\"fig:\",width=253,height=188 ]   produced by methods @xmath184 , with @xmath195 .",
    "parameters : stepsize @xmath203 , integration interval @xmath204 $ ] .",
    "right picture .",
    "roundoff errors may cause a drift of the numerical hamiltonian function ( upper line ) which can be easily taken under control by coupling the method with a costless correction procedure like the one described at .,title=\"fig:\",width=253,height=188 ]",
    "we have derived a family of mono - implicit methods of order four with energy - preserving properties .",
    "each element in the family originates from a limit formula and is defined by discretizing the integral therein by means of a suitable quadrature scheme .",
    "this process assures an exact energy conservation in the case where the hamiltonian function is a polynomial , or a conservation to within machine precision in all other cases , as is also illustrated in the numerical tests .",
    "interestingly , each method may be conceived as a @xmath0 perturbation of a two - step linear method .",
    "l. brugnano , f. iavernaro and d. trigiante , _ analisys of hamiltonian boundary value methods ( hbvms ) : a class of energy - preserving runge - kutta methods for the numerical solution of polynomial hamiltonian dynamical systems _ , ( 2009 ) ( submitted ) ( arxiv:0909.5659 [ arxiv:0909.5659 ] ) .",
    "l. brugnano , f. iavernaro and d. trigiante , _ hamiltonian boundary value methods ( energy preserving discrete line integral methods ) _ , jour . of numer .",
    "industr . and",
    "appl . math . * 5 * , 12 ( 2010 ) , 1737 ( arxiv:0910.3621 [ arxiv:0910.3621 ] ) .",
    "l.  brugnano , f.  iavernaro , d.  trigiante , _ the lack of continuity and the role of infinite and infnitesimal in numerical methods for odes : the case of symplecticity _ , applied mathematics and computation ( to appear ) , doi : 10.1016/j.amc.2011.03.022[doi : 10.1016/j.amc.2011.03.022 ] , ( arxiv:1010.4538 ) ."
  ],
  "abstract_text": [
    "<S> we introduce a family of fourth order two - step methods that preserve the energy function of canonical polynomial hamiltonian systems . </S>",
    "<S> each method in the family may be viewed as a correction of a linear two - step method , where the correction term is @xmath0 ( @xmath1 is the stepsize of integration ) . </S>",
    "<S> the key tools the new methods are based upon are the line integral associated with a conservative vector field ( such as the one defined by a hamiltonian dynamical system ) and its discretization obtained by the aid of a quadrature formula . </S>",
    "<S> energy conservation is equivalent to the requirement that the quadrature is exact , which turns out to be always the case in the event that the hamiltonian function is a polynomial and the degree of precision of the quadrature formula is high enough . </S>",
    "<S> the non - polynomial case is also discussed and a number of test problems are finally presented in order to compare the behavior of the new methods to the theoretical results .    ordinary differential equations , mono - implicit methods , multistep methods , canonical hamiltonian problems , hamiltonian boundary value methods , energy preserving methods , energy drift .    </S>",
    "<S> 65l05 , 65p10 . </S>"
  ]
}