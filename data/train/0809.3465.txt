{
  "article_text": [
    "galaxy shapes provide the unique signature of gravitational lensing by large scale structure , which has been recognized as a key to the study of dark matter and dark energy @xcite .",
    "a limiting factor is the accuracy with which one can measure shapes @xcite . among the different existing methods ,",
    "one particularly interesting approach is the decomposition of galaxy images using basis functions e.g. @xcite or",
    "_ shapelets _ @xcite .",
    "the strengths of this approach rely on the fact that the shape measurement is analytical and therefore time efficient as it involves rather small matrix multiplications .",
    "_ shapelets _ decompose an image into a linear combination of orthonormal components up to some truncation order , and the shape parameters are extracted from a least - squares best fit using the recomposed ( noise free ) model .",
    "however , the shapelet type approach suffers from a few difficulties :    \\(i ) the choice of the decomposition truncation order is arbitrary . in practice ,",
    "different lensing groups use radically different `` optimal '' truncation orders . some prefer low @xcite , while others prefer high @xcite , although the @xmath0 values for different truncation order could be very different .",
    "therefore a constant @xmath0 criterion to measure the shape does not appear to be a robust guarantee of unbiased shape measurement .",
    "\\(ii ) `` easy cases '' such as large and bright elliptical galaxies are poorly fitted .",
    "this suggests that a good fit for low signal - to - noise galaxies does not necessarily mean that the shape has been correctly measured , since it could just be buried in the sky noise .",
    "this is the overfitting problem .",
    "\\(iii ) basis decomposition has too many degrees of freedom for shear measurement , since ideally we are only interested in two numbers ( or six if we include the flexion ) .",
    "this is where galaxy morphology and shear measurement are clearly two different problems .",
    "all of those problems have one common origin , namely the choice of the zeroth order weight function  gaussian functions for both cartesian @xcite and polar shapelets @xcite , as well as @xcite . unfortunately , gaussian functions are poor matches to real galaxy profiles . ideally , we would like the zeroth order to be as close as possible to the real profile , and leave to the basis decomposition the task to fit departures from this `` typical '' profile .",
    "currently the most promising shape measurement method uses a bayesian model fitting approach @xcite .",
    "this method does not suffer from the same issues as shapelets , but is limited by the strong galaxy profile prior .    in this paper ,",
    "we investigate how the change of the weight function affects the basis decomposition method , and how it leads naturally to a hybrid method which combines shapelets and fitting techniques .",
    "we choose to focus on the srsic  profile ( hence the term sersiclets ) , but our discussion can be extended to any profile , e.g. moffat profile for ground based point spread function ( psf ) .",
    "section [ sec : methodology ] introduces the notation and gives a technical description of the new fitting functions .",
    "section [ sec : experiment ] shows the impact of those fitting functions on shape fitting and decomposition .",
    "finally , section [ sec : conclusion ] summarizes our work so far and future possibilities .",
    "note that in this paper we choose not to discuss the psf deconvolution .",
    "indeed , the problems we mentioned earlier affect equally the measurement of galaxy shapes whether or not the galaxies are convolved with a psf , and shapelets are a popular approach because their gaussian properties allow for very efficient psf treatment .",
    "the psf deconvolution issue goes beyond this work because it depends on how the psf is measured and interpolated between stars .",
    "moreover the approach developed here could as well be applied to the psf profile measurement separately , and then used later to address the deconvolution step through a forward convolution model fitting method .",
    "see for example @xcite .",
    "in 1d , all polynomials @xmath1 of degree @xmath2 are orthonormal with respect to a weight function @xmath3 if they satisfy @xmath4 a particular choice of weight function @xmath3 uniquely determines the family of polynomials ( e.g. for the cartesian shapelets , a gaussian weight defines the hermite polynomials )",
    ". a complete set of polynomials can be useful for decomposing an arbitrary function @xmath5 as a linear combination of _ basis functions _",
    "@xmath6^{1/2}$ ] such that @xmath7    in 2d , the basis functions can be represented using polar coordinates . following the intuition for polar shapelets , we separate our basis functions @xmath8 into the radial component @xmath9 and the angular component @xmath10 .",
    "we also assume that the weight function @xmath11 has no angular dependence .",
    "the 2d basis functions @xmath8 in polar coordinates would be in the form @xmath12^{1/2}e^{im\\phi}.",
    "\\label{eqn : defrn}\\ ] ] the orthonormality is then written as @xmath13 where * denotes complex conjugate .",
    "the orthonormality requirements for radial and angular parts , @xmath14 and @xmath15 , can be satisfied independently . in particular",
    ", @xmath9 is an orthonormal polynomial of degree @xmath16 with respect to the weight function @xmath11 .",
    "the integration limit @xmath17 for the radial component will be discussed in section [ sec : integration_limits ] .    with an orthogonal and complete set of basis functions , an arbitrary image @xmath18",
    "can then be decomposed into @xmath19 where the complex basis coefficients @xmath20 satisfy @xmath21 so that @xmath18 is wholly real .",
    "we will refer @xmath22 as `` order '' in the following sections .",
    "readers familiar with polar shapelets may notice that our radial component here only requires @xmath16 , and @xmath23 increases in steps of 1 . in polar shapelets ,",
    "the radial component requires both @xmath23 and @xmath16 , and @xmath23 increases in steps of 2 .",
    "our choice to completely decouple the radial and the angular components is of mere convenience , which comes with the cost that our set of `` basis functions '' is no longer complete .",
    "consequently , our set of _ fitting functions _ can not decompose an arbitrary image .",
    "as we shall see in section [ sec : completeness ] and section [ sec : basis_reduction ] , though , the lack of completeness is not a hindrance to decomposing images of galaxies for weak lensing , as galaxies follow srsic  profiles @xcite and are not arbitrary in general .",
    "the basis functions in shapelets often require high order polynomials to describe galaxy shapes accurately because galaxies radial light profiles do not match the weight functions .",
    "galaxies light profiles are well described by srsic s empirical formula @xcite : @xmath24      \\label{eqn : sersic}\\ ] ] where @xmath2 is a scale radius , and @xmath25 is known as the srsic  index . for @xmath26 , @xmath27 .",
    "we use a parameterized form of equation [ eqn : sersic ] as our weight function : @xmath28 .",
    "\\label{eqn : weightfunction}\\ ] ]      the radial component involves a non - trivial computational step , as @xmath9 must satisfy the orthonormality requirement described in section [ sec : basis_functions ] .",
    "we obtain @xmath9 by the gram - schmidt process . using dirac notation @xmath29",
    ", the gram - schmidt process generates each @xmath9 by a recurrence relation : @xmath30 where @xmath31 , and @xmath32 . after the recurrence step ,",
    "each @xmath9 is individually normalized .      when generating the radial polynomials ( section [ sec : radial_component ] ) , a sensible integration limit must be chosen . in shapelets",
    "one can integrate @xmath33 from 0 to @xmath34 thanks to the gaussian function s localized profile . for srsicfunctions in general , however , the profile may not be localized enough to allow for an infinitely large domain .",
    "this is generally true for any galaxy and stellar profile used as a weight function .",
    "the problem with using an infinitely large domain is the lack of mutual independence among the fitting functions . in order to construct a model as a linear combination of fitting functions ,",
    "each fitting function must be distinct so that there is no redundancy in their shapes .",
    "figure [ fig : infinite_polys ] shows the polynomials that are generated using a weight function ( equation [ eqn : weightfunction ] ) with @xmath35 .",
    "we find that limiting the orthogonality to a finite domain preserves linear independency better than extending to an infinitely large domain .",
    "we conveniently choose @xmath36 for our domain .",
    "for a square image stamp of @xmath37 pixels , @xmath33 would be normalized to have units of @xmath38 pixels .",
    "it also allows us to constrain @xmath39 , as the scale radius is always positive , and a galaxy should be well captured in a stamp .",
    "orthonormality holds in @xmath36 ( upper panel ) and @xmath40 ( lower panel ) .",
    "the functions in the lower panel are hardly distinguishable , hence lack linear independence .",
    "this is due to large variation in the polynomials coefficients , so the high order details are not visible .",
    "the functions in the top panel are distinguishably different.,title=\"fig:\",width=326 ] $ ] .",
    "orthonormality holds in @xmath36 ( upper panel ) and @xmath40 ( lower panel ) .",
    "the functions in the lower panel are hardly distinguishable , hence lack linear independence .",
    "this is due to large variation in the polynomials coefficients , so the high order details are not visible .",
    "the functions in the top panel are distinguishably different.,title=\"fig:\",width=326 ]      although the fitting functions of sersiclets are indeed mutually orthonormal , they are not necessarily complete . as a result ,",
    "equation [ eqn : linear_combo ] does not necessarily converge , even at high @xmath22 .",
    "the basis functions in both cartesian and polar shapelets are complete , meaning that equation [ eqn : linear_combo ] can converge for any arbitrary @xmath18 as @xmath41 .",
    "the incompleteness of sersiclets is shown in figure [ fig : chi2_convergence ] .",
    "it shows the average difference squared per pixel @xmath42 when decomposing a noiseless elliptical object on a @xmath43 grid by integrating equation [ eqn : linear_combo ] with @xmath44 , and exploiting orthonormality to obtain each @xmath20 .",
    "the reconstruction using sersiclets does not improve even as the order increases ; in fact , the reconstruction becomes slightly worse because higher order contributions are as small as the discretization error .",
    "clearly , sersiclets fail to decompose even a simple elliptical object .    for this reason , we would not attempt the decomposition by including higher order fitting functions . in the next section",
    "we take a different approach  throwing away all circularly asymmetric components .",
    "the lack of contribution by those components is an important rationale of our technique to reduce the set of fitting functions .    ,",
    "represented by the average difference squared per pixel @xmath42 when decomposing a high resolution and noiseless elliptical profile .",
    "polar shapelets are clearly more efficient at describing arbitrary profiles.,width=307 ]      it is clear from section [ sec : completeness ] that the fitting set should be reduced in order to take advantage of the matched filter due to the lack of completeness . in the following",
    "we reduce our set of fitting functions to only the circularly symmetric components ( @xmath45 ) , and we introduce ellipticities by transforming the now perfectly circular model by `` scaling '' and `` rotating '' , which yield unique values of @xmath46 and @xmath47 .",
    "this is similar to the process described in @xcite .",
    "the set of `` reduced sersiclets '' has two advantages ; eliminating the @xmath48 components not only cures the overfitting problem , but it also offers a dramatic increase in speed as the number of terms in equation [ eqn : linear_combo ] now increases like @xmath49 rather than @xmath50 .",
    "it also provides a direct estimate of @xmath46 and @xmath47 , which are treated as asymmetric scaling parameters for the fitting function .",
    "we focus on fitting profiles that are smooth , centrally peaked , and elliptical in general .",
    "these fitting functions are not suitable for studying galaxy morphology , as they can not provide information about a galaxy s detailed structure . in weak gravitational lensing studies , however , the details in the typical faint images analyzed are dominated by noise and should not be fitted .",
    "therefore our reduced fitting set offers a natural regularization process which is missing in the standard shapelet approach .",
    "our method is a hybrid of shapelets and fitting techniques , where we do allow some decomposition into fitting functions , but those fitting functions are by construction axisymmetric and therefore prevent isophote mixing ( i.e. overfitting ) as higher order fitting techniques do .",
    "our experiment at this stage is not a rigorous test for shape measurement , as our test cases ( figure [ fig : source_images ] ) are idealized profiles without psf convolution .",
    "rather , we are exploring the effect of using a variety of weight functions with different ( @xmath2 , @xmath25 ) .",
    "our test cases consist of both circular and elliptical profiles .",
    "we generated two - dimensional reduced @xmath0 maps of @xmath2 vs order at fixed @xmath25 values .",
    "the @xmath51 maps are then compared against those generated using polar shapelets , which we will refer to simply as `` shapelets '' in the following discussion . in shapelets case ,",
    "the @xmath33 coordinate is also normalized to @xmath36 .",
    "the `` scaling - factor '' @xmath52 in shapelets is now comparable to @xmath2 in sersiclets , which is relative to the size of the image .",
    "the model fits for both sersiclets and shapelets were computed using hrothgar implemented in c.    ccc +   and @xmath53 , respectively.,title=\"fig:\",width=86 ] &   and @xmath53 , respectively.,title=\"fig:\",width=86 ] &   and @xmath53 , respectively.,title=\"fig:\",width=86 ] + de vaucouleurs & exponential & generic srsic +   +   and @xmath53 , respectively.,title=\"fig:\",width=86 ] &   and @xmath53 , respectively.,title=\"fig:\",width=86 ] &   and @xmath53 , respectively.,title=\"fig:\",width=86 ] + exponential & exponential & generic srsic +      we first test the full fitting set by fitting against circular profiles . in figure",
    "[ fig : circular_result ] , we see that convergence of @xmath54 is achieved very quickly .",
    "this is not surprising as the weight functions in the models are indeed realistic .",
    "more importantly , we find that the fits are insensitive to the choice of @xmath55 after the first few orders .",
    "this robustness allows us to obtain good fits without searching for an optimal @xmath55 .",
    "this result is useful in fitting large collections of objects , where families of objects can simply share the same pair of @xmath55 without compromise .",
    "comparing the @xmath51 maps and image reconstructions between sersiclets and shapelets reveals sersiclets advantage . in very non - gaussian cases such as the de vaucouleurs case ,",
    "sersiclets converge at a much lower order than shapelets .",
    "in fact , shapelets require low signal - to - noise ratios in order to render an illusion of `` good fit '' . from figure",
    "[ fig : circular_result ] , we see that shapelets lowest order best fit at @xmath56 already shows signs of noise fitting ; the model is not smooth , and it shows non - circular isophotes .",
    "sersiclets , though , can recover the smooth and circular profile at orders 0 or 1 .    [",
    "cols=\"^,^ \" , ]      residuals measured using the reduced fitting set .",
    "each column of points is an object ( table [ table : ellipticals ] ) , and each data point is a different @xmath57 , where @xmath58 in steps of 0.1 and @xmath59 in steps of 0.2 ( for sersiclets ) .",
    "the behavior of the best fit @xmath47 is very similar to those in @xmath46 . at order 3",
    ", sersiclets can achieve @xmath60 and measure @xmath61 with only a small dispersion .",
    "in contrast , shapelets can do so only at a certain range of @xmath2 ( or @xmath52 ) that produces good fits ( see figure [ fig : elliptical_result ] ) . at a given `` order '' ,",
    "sersiclets have about twice as many degrees of freedom as shapelets.,title=\"fig:\",width=316 ]   residuals measured using the reduced fitting set .",
    "each column of points is an object ( table [ table : ellipticals ] ) , and each data point is a different @xmath57 , where @xmath58 in steps of 0.1 and @xmath59 in steps of 0.2 ( for sersiclets ) .",
    "the behavior of the best fit @xmath47 is very similar to those in @xmath46 . at order 3",
    ", sersiclets can achieve @xmath60 and measure @xmath61 with only a small dispersion .",
    "in contrast , shapelets can do so only at a certain range of @xmath2 ( or @xmath52 ) that produces good fits ( see figure [ fig : elliptical_result ] ) . at a given `` order '' ,",
    "sersiclets have about twice as many degrees of freedom as shapelets.,title=\"fig:\",width=316 ]   residuals measured using the reduced fitting set .",
    "each column of points is an object ( table [ table : ellipticals ] ) , and each data point is a different @xmath57 , where @xmath58 in steps of 0.1 and @xmath59 in steps of 0.2 ( for sersiclets ) .",
    "the behavior of the best fit @xmath47 is very similar to those in @xmath46 . at order 3",
    ", sersiclets can achieve @xmath60 and measure @xmath61 with only a small dispersion .",
    "in contrast , shapelets can do so only at a certain range of @xmath2 ( or @xmath52 ) that produces good fits ( see figure [ fig : elliptical_result ] ) . at a given `` order '' , sersiclets have about twice as many degrees of freedom as shapelets.,title=\"fig:\",width=316 ]    rrrr @xmath46 & @xmath47 & @xmath2 & @xmath62 + 0.130 & 0.225 & 0.43 & 1.0 + 0.244 & 0.089 & 0.43 & 1.0 + 0.180 & 0.186 & 0.43 & 1.0",
    "+ @xmath63 & 0.164 & 0.24 & 1.0 + 0.274 & 0.146 & 0.24 & 1.0 + 0.011 & 0.310 & 0.24 & 1.0 + 0.012 & 0.069 & 0.29 & 0.75 + 0.066 & 0.024 & 0.29 & 0.75 + @xmath64 & 0.024 & 0.29 & 0.75 + @xmath65 & 0.348 & 0.28 & 0.75 + 0.116 & 0.357 & 0.28 & 0.75 + @xmath66 & @xmath67 & 0.28 & 0.75      sersiclets robustness in @xmath55 and its ability to converge in relatively low orders comes from the abundance of its degrees of freedom in the model . for the full fitting set , equation [ eqn : linear_combo ]",
    "has @xmath68 terms in the summation as the angular quantum number @xmath23 increases in steps of 1 .",
    "polar shapelets , however , have only @xmath69 terms as @xmath23 increases in steps of 2 at a given order of @xmath16 . for the reduced fitting set , sersiclets have @xmath70 terms , and polar shapelets have only @xmath71 terms . together with @xmath25 and @xmath2 , sersiclets would have about twice as many degrees of freedom as polar shapelets . to facilitate a fair comparison , figure [ fig : e1_result ]",
    "compares sersiclets at order 3 against shapelets at order 6 in the second and third panels .",
    "this ensures that the test uses the same degrees of polynomials available to each decomposition technique .",
    "a drawback of sersiclets is numerical instability .",
    "hermite or associated laguerre polynomials in shapelets can be generated very easily with elementary operations , whereas the general sersiclet polynomials require gamma functions .",
    "in particular , the analytical solution to the integral @xmath72 dr \\qquad ( j=1,2 ... )      \\label{eqn : num_int}\\ ] ] which is ubiquitous in section [ sec : radial_component ] , can be written as @xmath73 \\label{eqn : num_int_soln } \\ ] ] where @xmath74 and @xmath75 are the complete and incomplete gamma functions , respectively , and @xmath76 as before . at first glance",
    ", it may be tempting to use the analytical solution because it exists and gamma functions can be readily evaluated . upon closer inspection , though , equation [ eqn : num_int_soln ] evaluates the difference between two gamma functions , each on the order of @xmath77 .",
    "the difference is then scaled by a number raised to the power of @xmath78 .",
    "one needs to be careful when evaluating such an expression if @xmath77 becomes large , especially when using numerical libraries with single precision .",
    "alternatively , the integrand in equation [ eqn : num_int ] is a smooth function , so the integral can be evaluated directly without implementing the analytical solution .",
    "sersiclets can be generalized to different weight functions . in our derivation , although we have chosen the srsic  function as our weight function , the process would still be the same for any weight functions which are intrinsically elliptical without explicit angular dependence .",
    "this allows for modeling different types of objects such as the psf using the moffat profile as the weight function .",
    "the integration limit of the radial component , as we discussed in section [ sec : integration_limits ] , can be either finite or infinite depending on whether the weight function is sufficiently localized .",
    "we presented an extension of shapelets by using an arbitrary weight function in place of the gaussian function .",
    "as galaxies light profiles follow the srsic  profile on average , we used the srsic  function as our weight function .",
    "this allowed us to fit cuspy galaxies at lower orders than shapelets could .",
    "because the srsic  function lacks analytical properties , we used the gram - schmidt process to generate the orthonormal polynomials as radial components for the fitting functions , where the integrals in the process must be evaluated numerically .",
    "as the srsic  profile has poor local support , the integration limit must be truncated to a finite limit .",
    "we found that the full set of fitting functions for sersiclets can not decompose an arbitrary image even at high orders , as the fitting functions do not form a complete set . instead of modeling objects using all fitting functions , we reduced the fitting set to only the circularly symmetric components ( @xmath45 ) .",
    "the model was then sheared by @xmath46 and @xmath47 to render elliptical shapes .",
    "the reduced set of fitting functions defines a hybrid method which combines the most interesting features of the basis decomposition and the fitting technique .",
    "our experiments so far only focused on idealized images simulated using known profiles and noise .",
    "both the full and the reduced sersiclets outperformed shapelets , as we expected .",
    "the shapelet matched filter s true performance will be tested in a future paper on image simulations such as those for great08 @xcite .",
    "the c code to evaluate sersiclet models is publicly available on request .",
    "we are grateful to ariel zhitnitsky for inspiring discussions at the beginning of this work , and peter melchior for valuable comments .",
    "we also thank the anonymous referee for detailed and very constructive comments on the manuscript .",
    "wayne ngan , lvw , and henk hoekstra are supported by nserc and cifar .",
    "99 berg , j. , pacaud , f. , et al . , 2008 , mnras , 385 , 695 .",
    "bernstein , g. , jarvis , m. , 2002 , aj , 123 , 583 .",
    "bridle , s. , et al .",
    ", 2008 , arxiv:0802.1214 .",
    "heymans , c. , van waerbeke , l. , et al . , 2006 , mnras , 368 , 1323 .",
    "hoekstra , h. , jain , b. , 2008 , arxiv:0805.0139 .",
    "kitching , t. , miller , l. , et al .",
    "2008 , arxiv:0802.1528 .",
    "kuijken , k. , 2006 , a & a , 456 , 827 .",
    "massey , r. , heymans , c. , et al . , 2007 , mnras , 376 , 13 .",
    "massey , r. , refregier , a. , 2005 , mnras , 359 , 1277 .",
    "miller , l. , kitching , t. , et al .",
    ", 2007 , mnras 382 , 315 .",
    "munshi , d. , valageas , p. , et al . , 2008 ,",
    "phr , 462 , 67 .",
    "peng , c. , ho , l. , et al .",
    ", aj , 2002 , 124 , 266 .",
    "refregier , a. , 2003 , mnras , 338 , 35 .",
    "refregier , a. , bacon , d. , 2003 , mnras , 338 , 48 .",
    "srsic j. l. , 1968 , atlas de galaxias australes ( crdoba : obs .",
    "crdoba ) ."
  ],
  "abstract_text": [
    "<S> the precision study of dark matter using weak lensing by large scale structure is strongly constrained by the accuracy with which one can measure galaxy shapes . </S>",
    "<S> several methods have been devised but none have demonstrated the ability to reach the level of precision required by future weak lensing surveys . in this paper </S>",
    "<S> we explore new avenues to the existing _ shapelets _ approach , combining a priori knowledge of the galaxy profile with the power of orthogonal basis function decomposition . </S>",
    "<S> this paper discusses the new issues raised by this matched filter approach and proposes promising alternatives to shape measurement techniques . </S>",
    "<S> in particular it appears that the use of a matched filter ( e.g. srsic  profile ) restricted to elliptical radial fitting functions resolves several well known shapelet issues .    </S>",
    "<S> [ firstpage ]    cosmology  dark matter : gravitational lensing . </S>"
  ]
}