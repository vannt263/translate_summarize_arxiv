{
  "article_text": [
    "air shower and detector simulations play a fundamental role in the study of cosmic rays",
    ". in particular , arrays of surface detectors that do not have fluorescence telescopes to calibrate the energy scale , must resort to simulated data in order to estimate the energy of the primary particle .",
    "furthermore , the primary mass is also obtained comparing experimental data with simulations .",
    "there are several monte carlo programs for air shower simulation , the most used in the literature are aires @xcite , corsika @xcite , and conex @xcite , the latter for a fast simulation of the longitudinal shower development .",
    "since the number of particles produced in a shower can be extremely large , e.g. , @xmath0 for a @xmath1 ev proton shower , the computer processing time and disk space needed are also very large , even if unthinning methods @xcite are used . due to this difficulty it is a common practice to reuse the same shower for generating several events",
    "( see for example @xcite ) .",
    "this practice is more common in simulations that include surface detectors because , for fluorescence telescopes , very fast monte carlo programs like conex , have very fast and efficient algorithms for the generation of longitudinal profiles .    in this work we present a study of the effects of using multiple repetitions of individual showers @xcite , applied to the simulation of detectors , on the evaluation of standard estimators of the expected value , variance , and covariance .",
    "we study in detail the effects introduced in the kernel density estimators , which are analytical estimates of the underlying distribution function obtained from a finite sample of events . in cosmic rays physics this technique is used mainly in connection with composition analyses ( see for example @xcite ) ; however , it is also extensively used in many different areas of knowledge @xcite to which this work can be directly extended .",
    "as mentioned in the introduction , we want to study the potential distortions introduced by reusing individual showers to maximize the statistics when simulating the response of a detector .",
    "let us start with the optimum case in which each individual shower is used only once and , therefore , best reproduces reality .",
    "let @xmath2 be a @xmath3-dimensional vector composed by physical observables ( e.g. mass sensitive parameters ) distributed as @xmath4 and let @xmath5 be a random vector , distributed as @xmath6 , that takes into account the effects of the detectors and the corresponding reconstruction method such that , after measuring and reconstructing the empirical information , a vector @xmath7 is obtained .",
    "the distribution function of @xmath8 is the convolution of @xmath4 and @xmath6 , @xmath9 suppose that we have a sample of @xmath10 independent events of the distribution @xmath11 , @xmath12 the probability of this configuration can be written as , @xmath13 however , as previously noted , if single showers are recycled and used many times to simulate the response of the detectors , non - independent samples are obtained .",
    "if we use each shower of a sample of @xmath14 independent showers @xmath15 times to simulate the detectors response , the following sample of size @xmath16 is obtained , @xmath17 @xmath18 @xmath19 @xmath20 , where the notation used henceforth corresponds to @xmath21 , where @xmath22 is the @xmath23 coordinate of vector @xmath24 , @xmath25 indicates the number of independent shower and @xmath26 the number of detector simulation performed using the @xmath27 shower .",
    "the probability of such configuration is given by @xmath28      let us consider the average of the @xmath23 coordinate of @xmath8 , @xmath29 , for the realistic case in which each shower is used only once to simulate the detector response , @xmath30 by using eq .",
    "( [ dsamp ] ) it is easy to obtain the very well known expressions for the expected value and variance of @xmath31 , @xmath32&=&e[x^i ] \\\\",
    "\\label{vx } var[\\bar{x}^i ] & = & \\frac{1}{n}\\ var[x^i ] . \\ ] ] the usual estimator of the covariance between two random variables is given by , @xmath33 for @xmath34 the estimator of the variance of @xmath29 is obtained , @xmath35 . by using eq .",
    "( [ dsamp ] ) it can be shown that both estimators are non - biased , @xmath36&=&cov[x^i , x^j ] , \\\\",
    "\\label{es } e[s_{i}^2 ] & = & e[\\hat{c}_{ii}]= var[x^i ] .",
    "\\ ] ]    for the case in which each shower is used several times to simulate the response of the detectors the average of @xmath29 is given by , @xmath37    from eqs .",
    "( [ dsamprep],[avrep ] ) it can be shown that , @xmath38 & = & e[x^i ] , \\\\",
    "\\label{vavxrep } var[\\bar{x}'^i ] & = & \\frac{1}{mm}\\ var[x^i]+\\frac{m-1}{mm}\\ \\int d\\mathbf{y } d\\mathbf{x}_1 d\\mathbf{x}_2 \\nonumber \\\\   & & ( x^i_1-e[x^i])(x^i_2-e[x^i])\\times \\nonumber \\\\ & & g(\\mathbf{y})\\ h(\\mathbf{x}_1-\\mathbf{y})\\ h(\\mathbf{x}_2-\\mathbf{y } ) , \\ ] ] which means that using samples obtained by reusing individual showers to simulate the detector response does not introduce any bias when calculating the average .",
    "however the fluctuations of @xmath31 are increased by the generation of an additional term proportional to @xmath39 .",
    "the estimator of the covariance , between @xmath29 and @xmath40 , including multiple repetitions of the individual showers takes the form , @xmath41    the expected value of the covariance estimator is obtained from eqs .",
    "( [ dsamprep ] ) and ( [ covrep ] ) , @xmath42 & = & cov[x^i , x^j]-\\frac{m-1}{mm } \\int d\\mathbf{y } d\\mathbf{x}_1 d\\mathbf{x}_2 \\nonumber \\\\   & & ( x^i_1-e[x^i])(x^j_2-e[x^j ] ) g(\\mathbf{y } ) \\times \\nonumber \\\\ & & h(\\mathbf{x}_1-\\mathbf{y})\\ h(\\mathbf{x}_2-\\mathbf{y } ) . \\ ] ] therefore , as expected , the repetition of individual showers introduces a bias in the covariance estimator because the events are not independent .",
    "the bias results proportional to @xmath39 .    as mentioned before",
    ", the expected value of the variance estimator is obtained setting @xmath34 in eq .",
    "( [ ecovxrep ] ) , @xmath43 & = & var[x^i]-\\frac{m-1}{mm } \\int d\\mathbf{y } d\\mathbf{x}_1 d\\mathbf{x}_2 ( x^i_1- \\nonumber \\\\ & & e[x^i ] ) ( x^i_2-e[x^i])\\ g(\\mathbf{y } ) \\times \\nonumber \\\\ & & h(\\mathbf{x}_1-\\mathbf{y})\\ h(\\mathbf{x}_2-\\mathbf{y } ) , \\ ] ] which shows that also @xmath44 is now a biased estimator of the variance of @xmath29 .",
    "the density estimation technique consist in obtaining an estimator of the underlying density function from a given data sample @xcite . in one of the most widely used variants of that technique",
    ", a density estimator is obtained from a superposition of kernel functions centered at each event of the data sample . for @xmath3-dimensional data the kernel density estimator can be written as , @xmath45 where @xmath8 is a @xmath3-dimensional vector",
    ", @xmath46 is a symmetric , positively defined matrix ( i.e. , the symmetric , positively defined square - root matrix @xmath47 exists ) and @xmath48 is the kernel function .",
    "the matrix @xmath46 gives the covariance between the different pairs of variables and also the degree of smoothing , i.e. , the width of the kernel function .    from eqs .",
    "( [ dsamp ] ) and ( [ dest ] ) the expected value of the density estimator is obtained , @xmath49 = \\frac{1}{\\sqrt{|h|}}\\ \\int d\\mathbf{x } ' \\ k(h^{-1/2 } \\cdot ( \\mathbf{x}-\\mathbf{x}'))\\ f(\\mathbf{x } ' ) , \\ ] ] which shows that @xmath50 is a biased estimator of @xmath51 .    by using the taylor expansion and retaining the dominant terms an approximated expression for the integrated mean square error @xmath52 $ ]",
    "is obtained , @xmath53 ^ 2 + \\frac{r(k)}{n\\ h^d\\ \\sqrt{|v| } } , \\label{imsevarbiash } \\ ] ] where @xmath54_{ij } = \\frac{\\partial^2 f}{\\partial x^i \\partial x^j}(\\mathbf{x } ) \\ \\ \\ r(a ) = \\int d\\mathbf{u}\\ a^2(\\mathbf{u } ) .",
    "\\label{d2f } \\ ] ] here we take @xmath55 , where @xmath56 is a small parameter that parametrizes the degree of smoothing .",
    "minimizing @xmath57 with respect to @xmath56 , the well known expression of @xmath58 is recovered , @xmath59 where the constant of proportionality depends on @xmath51 , the unknown density function that we want to estimate .",
    "let us consider the case in which shower repetitions of individual showers are included .",
    "the density estimator in this case is given by , @xmath60 it can be seen from eqs .",
    "( [ dsamprep ] ) and ( [ destrep ] ) , that the bias does not change when the repetitions are introduced .",
    "however , as expected , the variance increases , @xmath61\\ & \\cong & \\frac{1}{m m\\ \\sqrt{|h|}}\\ r(k)\\ f(\\mathbf{x } ) + \\frac{m-1}{m m }   \\nonumber \\\\",
    "\\label{varrep } & & \\left ( \\int d\\mathbf{y}\\ g(\\mathbf{y } ) h^2(\\mathbf{x}-\\mathbf{y})- f^2(\\mathbf{x})\\right),\\ \\nonumber \\\\",
    "\\ ] ] where just the leading terms are retained",
    ". consequently , the @xmath57 takes in this particular case the form @xmath62 ^ 2 + \\frac{r(k)}{m m\\ h^d\\ \\sqrt{|v| } } + \\nonumber \\\\ & & \\frac{m-1}{m m } \\int d\\mathbf{x } d\\mathbf{y}\\ g(\\mathbf{y } ) h^2(\\mathbf{x}-\\mathbf{y } ) - \\nonumber \\\\ & & \\frac{m-1}{m m } r(f ) .",
    "\\label{imsevarbiashrep } \\ ] ] eq .",
    "( [ imsevarbiashrep ] ) shows that the leading term introduced by the repetitions does not depend on @xmath56 and , therefore , the expression for @xmath58 remains equal to the @xmath63 case .",
    "the only effect introduced by the repetitions of the individual showers is to increase the fluctuations of the estimator for each @xmath8 .",
    "in this section a numerical example that shows the predicted effects introduced by the shower repetitions is given .",
    "for that purpose , air showers simulations are performed using the program conex .",
    "a total of @xmath64 proton showers of primary energy @xmath65 ev and zenith angle @xmath66 are generated .",
    "samples of the parameter @xmath67 obtained from the conex simulations are considered .",
    "a gaussian uncertainty of @xmath68=20 $ ] g @xmath69 and @xmath70 is assumed in order to take into account the detector response and the reconstruction method .",
    "therefore , the distribution function of the reconstructed @xmath67 is given by eq .",
    "( [ fdef ] ) with @xmath71 the distribution function corresponding to the physical fluctuations and @xmath72)$ ] , a gaussian distribution of mean value @xmath73 and @xmath74 $ ] , which takes into account the response of the detectors and reconstruction methods .",
    "four sets of 100 samples are considered .",
    "each set of samples is noted as @xmath75 where @xmath14 indicates the independent values of @xmath67 ( obtained from conex ) in each sample and @xmath15 the number of repetitions of each shower , i.e. , the number of times that the gaussian distribution @xmath76)$ ] is sampled for each of the @xmath14 independent values @xmath77 in each individual sample .",
    "therefore , @xmath78 , @xmath79 , @xmath80 and @xmath81 are considered , where @xmath78 and @xmath80 just differ in the different values obtained from the gaussian distribution performed to include the detector response and reconstruction method .",
    "the number of events in each sample , belonging to the different sets , is @xmath82 , the same for all kind of samples considered .",
    "figure [ meanrms ] shows the distributions of the estimators of the average , @xmath83 , and the standard deviation , @xmath84 $ ] , for the sets of samples considered .",
    "it can be seen that , as expected , when the repetitions are included , the fluctuations increase and when the number of independent showers increases the fluctuations decrease .",
    "figure [ meanrms ] also shows that , although the distributions of @xmath84 $ ] with repetitions have a tail towards larger values of grammage , which is not present in the corresponding without repetitions , the bias is not statistically significative .",
    "this is consistent with eq .",
    "( [ evarxrep ] ) which shows that the expected bias introduced by repetitions in the variance is proportional to @xmath85 for @xmath79 .     and @xmath84 $ ] for the different sets of samples considered .",
    "[ meanrms],title=\"fig:\",width=307 ]    and @xmath84 $ ] for the different sets of samples considered .",
    "[ meanrms],title=\"fig:\",width=307 ]    in order to illustrate the effects of repetitions on the density estimators , one - dimensional gaussian kernels are used to estimate the density function of @xmath67 .",
    "an adaptive bandwidth method , introduced by b. silverman @xcite , is used to obtain better estimates of the density function .    for each sample belonging to",
    "a given set a density estimate is obtained , therefore , 110 density estimates are obtained for each set of samples considered .",
    "figure [ estimates ] shows the mean value and the one sigma region obtained from the density estimates of each set .",
    "it can be seen that the mean values corresponding to samples with or without repetitions are very similar , which is consistent with the result obtained in subsection [ densest ] .",
    "also , as expected from eq .",
    "( [ varrep ] ) , the fluctuations corresponding to sets including repetition are larger and comparing the results obtained for @xmath79 and @xmath81 we see that the fluctuations in the latter case are smaller due to the smaller number of repetitions .    , title=\"fig:\",width=307 ] , title=\"fig:\",width=307 ]",
    "in this work we present a study of the effects of recycling individual cosmic ray showers to simulate the detector response , which is a common practice in monte carlo simulations at the highest energies .",
    "we find that the standard estimators of the expected value , variance and covariance are modified . in particular",
    ", the average remains as a non - biased estimator of the expected value but the fluctuations are increased . for the standard estimators of the variance and covariance",
    "a bias proportional to @xmath39 appears when repetitions are included .",
    "besides , as in the case of the average , the fluctuations of both estimators are increased .",
    "finally , we study the effects introduced by repetition in the kernel density estimators obtained from finite samples .",
    "we find again that the expected value of the estimator is unchanged , i.e. , the bias takes the same form .",
    "however , the pointwise fluctuations are increased and become more important as the ratio @xmath39 increases .",
    "this work is partially supported by the mexican agencies conacyt , unam s cic , and papiit .",
    "ads is supported by a postdoctoral grant from the unam ."
  ],
  "abstract_text": [
    "<S> the simulations of extensive air showers as well as the detectors involved in their detection play a fundamental role in the study of the high energy cosmic rays . at the highest energies the detailed simulation of air showers is very costly in processing time and disk space due to the large number of secondary particles generated in interactions with the atmosphere , e.g. @xmath0 for @xmath1 ev proton shower . </S>",
    "<S> therefore , in order to increase the statistics , it is quite common to recycle single showers many times to simulate the detector response . in this work we present a detailed study of the artificial effects introduced by the multiple use of single air showers for the detector simulations . in particular , we study the effects introduced by the repetitions in the kernel density estimators which are frequently used in composition studies .    </S>",
    "<S> shower simulations , detector simulations </S>"
  ]
}