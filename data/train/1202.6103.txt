{
  "article_text": [
    "in recent years , there has been a proliferation of data in geophysics and other applied sciences acquired through observations @xcite , reanalyses @xcite , and large - scale numerical models @xcite .",
    "the availability of such data holds promise for advances in a number of important applications , such as decadal - range climate forecasts through improved understanding of regime transitions in the ocean @xcite and weather forecasts beyond seven - day lead times through skillful models of organized convection in the tropics @xcite .",
    "however , a major obstacle in using large - scale datasets in such applications is their sheer volume and complexity .",
    "typically , the data are presented in the form of a high - dimensional time series , acquired through noisy , partial observations of a strongly - nonlinear dynamical system .",
    "thus , there exists a strong practical interest in developing novel data analysis techniques to decompose the data into a set of spatiotemporal patterns revealing the operating nonlinear processes .",
    "such patterns can be used to gain scientific understanding of complex phenomena , or to build reduced dynamical models for prediction .",
    "machine learning methods , such as those based on kernels @xcite and neural networks @xcite , are well - suited to capture the nonlinear features of data generated by complex systems , but in certain cases are prone to overfitting and/or poor scaling with the dimension of ambient space @xcite . in contrast ,",
    "classical linear approaches , such as singular spectrum analysis ( ssa ) and its variants @xcite , have the advantages of direct physical interpretability and analysis through the tools of linear algebra , but are generally limited in detecting patterns carrying a high portion of the variance ( energy ) of the observed signal .",
    "such patterns are likely to miss important nonlinear dynamical features , including intermittency and rare events @xcite .",
    "the latter carry low variance , but can play an important dynamical role by triggering large - scale regime transitions .    in @xcite ( building on preliminary work in @xcite ) , a method called nonlinear laplacian spectral analysis ( nlsa ) was developed , whose objective is to address the above shortcomings by combining aspects of both nonlinear and linear methods . similarly to ssa , nlsa decomposes an observed signal through spectral analysis of linear operators mapping a space of temporal modes ( the `` chronos '' space ) to the corresponding space of spatial patterns ( `` topos '' space ) @xcite .",
    "however , the linear operators used in nlsa , denoted here by @xmath3 , differ crucially from ssa in that they are tailored to the nonlinear manifold structure of the data . specifically , the chronos spaces in nlsa are low - dimensional subspaces of the hilbert space @xmath4 of square - integrable functions on the data manifold @xmath0 , with @xmath5 the riemannian measure induced by the embedding of @xmath0 in @xmath6-dimensional ambient space .",
    "nlsa employs graph - theoretic algorithms @xcite to produce a set of orthonormal laplace - beltrami eigenfunctions , which form bases for a family of @xmath7-dimensional subspaces @xmath8 of @xmath4 , with @xmath7 controlling the scale ( `` resolution '' ) on the data manifold of the temporal patterns described by the corresponding @xmath3 operator .",
    "a decomposition of the data into a set of @xmath7 spatial and temporal patterns then follows from singular value decomposition ( svd ) of the @xmath9 matrix representing @xmath3 in the eigenfunction basis .",
    "a key difference between nlsa and other nonlinear dimensionality reduction techniques in the literature is that the eigenfunctions are not used to define feature maps as done , e.g. , in kernel pca @xcite .",
    "moreover , the diffusion process on the graph employed to evaluate the laplace - beltrami eigenfunctions has no implied relation to the actual dynamics ( cf .",
    "rather , the graph laplacian eigenfunctions are used in nlsa solely as a set of basis functions for @xmath8 .",
    "the physical , spatiotemporal processes operating on the data manifold are obtained in the linear svd step .",
    "two further important ingredients of the scheme are :    1 .",
    "time - lagged embedding @xcite to alleviate non - markovianity of the input data due to partial observations , and capture propagating coherent structures ; 2 .",
    "adaptive kernels in the construction of the graph laplacian ( with gaussian widths determined from the distances between temporal nearest neighbors ) , enhancing the capability of the algorithm to recover rapid transitions and rare events .",
    "we demonstrate the efficacy of the scheme in an analysis of the north pacific sector of the community climate system model version 3 ( ccsm3 ) @xcite , augmenting the work in @xcite with new practical criteria for choosing the dimension @xmath7 of the temporal spaces @xmath8 . using a 700-year equilibrated dataset of the upper-300 m ocean @xcite",
    ", we identify a number of qualitatively - distinct spatiotemporal processes , each with a meaningful physical interpretation .",
    "these include the seasonal cycle , semiannual variability , as well as decadal - scale processes resembling the pacific decadal oscillation ( pdo ) @xcite .",
    "besides these modes , which are familiar from ssa , the spectrum of nlsa also contains modes with a strongly intermittent behavior in the temporal domain , characterized by five - year periods of high - amplitude oscillations with annual and semiannual frequencies , separated by periods of quiescence .",
    "spatially , these modes describe enhanced eastward transport in the region of the kuroshio current , as well as retrograde ( westward ) propagating temperature anomalies and circulation patterns resembling the subpolar and subtropical gyres .",
    "the bursting - like behavior of these modes , a hallmark of nonlinear dynamics , means that they carry little variance of the raw signal ( about an order of magnitude less than the seasonal and pdo modes ) , and as a result , they are not captured by linear ssa .    here",
    ", we pay particular attention to the choice of the dimension of @xmath8 . introducing a spectral entropy measure @xmath10 characterizing the change in the energy distribution among the modes of @xmath3",
    "as @xmath7 grows , we propose to select @xmath7 as the minimum value beyond which @xmath10 becomes small .",
    "we find this to be a particularly effective way to prevent overfitting the data ( a common issue in machine learning methods @xcite ) , while capturing the important features of the signal through the spatiotemporal modes of @xmath3 .",
    "another key theme of the framework presented here is to apply minimal or no preprocessing to the data prior to analysis . in particular , we find that removing the seasonal cycle from the data ( as is commonly done in the geosciences ) eliminates the intrinsically nonlinear intermittent modes from the spectrum of @xmath3 ; a fact which we attribute to the distortion of neighborhood relationships imparted by preprocessing a nonlinear data manifold through a linear operation such as seasonal detrending . these results should be useful in several disciplines where data detrending is common practice",
    "overall , the theoretical perspective in this paper complements our earlier work @xcite , emphasizing the role of regularity of the temporal basis functions on the nonlinear data manifold .",
    "the plan of this paper is as follows . in sec .",
    "[ sectheory ] , we describe the theoretical framework of nlsa algorithms . in sec .",
    "[ secmodes ] , we apply this framework to the upper - ocean temperature in the north pacific sector of ccsm3 .",
    "we discuss the implications of these results in sec .",
    "[ secdiscussion ] , and conclude in sec .",
    "[ secconclusions ] . a movie showing dynamical evolution of spatiotemporal patterns",
    "is provided as additional supporting information .",
    "we consider that we have at our disposal samples of a time - series @xmath11 of a @xmath12-dimensional variable sampled uniformly with time step @xmath13 . here",
    ", @xmath14 is generated by a dynamical system , but observations of @xmath11 alone are not sufficient to uniquely determine the state of the system in phase space ; i.e. , our observations are incomplete .",
    "for instance , in section  [ secmodes ] ahead , @xmath11 will be a depth - averaged ocean temperature field restricted in the north - pacific sector of ccsm3 .",
    "our objective is to produce a decomposition of @xmath11 into a set of @xmath7 spatiotemporal patterns , @xmath15 taking explicitly into account the fact that the underlying trajectory of the dynamical system lies on a nonlinear manifold @xmath0 in phase space .",
    "the methodology employed here to address this objective consists of four basic steps : ( 1 ) embed the observed data in a vector space @xmath16 of dimension greater than @xmath12 via the method of delays ; ( 2 ) construct a linear map @xmath3 taking a hilbert space of scalar functions on @xmath0 representing temporal patterns to the spatial patterns in @xmath16 ; ( 3 ) perform an svd in a basis of orthonormal laplacian eigenfunctions to extract the spatial and temporal modes associated with @xmath3 ; ( 4 ) project the modes from @xmath16 to physical space @xmath17 to obtain the spatiotemporal patterns @xmath18 in  .",
    "below , we provide a description of each step .",
    "further details of the procedure , as well as pseudocode , are presented in @xcite .",
    "hereafter , we shall consider that @xmath0 is compact and smooth , so that a well - defined spectral theory exists @xcite .",
    "even though these conditions may not be fulfilled in practice , eventually we will pass to a discrete , graph - theoretic description @xcite , where smoothness is not an issue .",
    "step ( 1 ) is familiar from the qualitative theory of dynamical systems @xcite . under generic conditions , the image of @xmath11 in embedding space @xmath19 under the delayed - coordinate mapping , @xmath20 lies on a manifold which is diffeomorphic to @xmath0 ( i.e. , indistinguishable from @xmath0 from the point of view of differential geometry ) , provided that the dimension @xmath6 of @xmath16 is sufficiently large .",
    "thus , given a sufficiently - long embedding window @xmath21 , we obtain a representation of the nonlinear manifold underlying our incomplete observations , which can be thought of as a curved hypersurface in euclidean space . that hypersurface inherits a riemannian metric @xmath22 ( i.e. , an inner product between tangent vectors on @xmath0 constructed from the canonical inner product of @xmath16 ) and a corresponding riemannian measure @xmath23 .",
    "steps  ( 2 ) and  ( 3 ) effectively constitute a generalization of ssa , adapted to nonlinear datasets .",
    "first , recall that ssa @xcite views the data matrix @xmath24\\ ] ] ( dimensioned @xmath25 for @xmath26 samples in @xmath6-dimensional embedding space ) as a linear map from the space of temporal patterns @xmath27 ( so - called chronos space ) to the space of spatial patterns @xmath16 ( the topos space ) , defined as @xmath28 that is , the spatial pattern @xmath29 corresponding to the temporal pattern @xmath30 is given by a weighted sum of the data points @xmath31 by @xmath32 . depending on the application at hand ,",
    "@xmath27 may be replaced by a more general hilbert space @xmath33 over the set of temporal observations @xmath34 . in either case",
    ", ssa produces a spatiotemporal decomposition of the signal through svd of the linear map @xmath35 , viz .",
    "@xmath36 with @xmath37 , \\quad \\sigma = \\operatorname{diag } ( \\sigma_1 , \\ldots , \\sigma_{\\min\\{n , s\\ } } ) , \\quad   v = [ v_1 , \\ldots , v_s ] ,",
    "\\\\      u_i \\in h , \\quad   \\sigma_i \\geq 0 , \\quad v_i \\in l^2 ( \\mathcal { t } ) .    \\end{gathered}\\ ] ] this leads to a rank-@xmath7 decomposition of the signal through @xmath38 where @xmath39 is the component of @xmath40 associated with time @xmath41 . similarly to  , the spatial pattern @xmath42 corresponding to @xmath40 is given by a weighted sum of the input data , @xmath43 geometrically , @xmath44 are the principal axes of the covariance ellipsoid @xmath45 , and @xmath46 linear projections of the data onto those axes .    even though the temporal patterns @xmath40 are well - behaved functions of time [ because they are square - integrable functions in @xmath33 ] , they exhibit no notion of regularity on the nonlinear data manifold .",
    "that is , the corresponding temporal patterns @xmath48 in ssa ( acquired through linear projections ) may develop rapid oscillations which are not related to the intrinsic geometry of the nonlinear data manifold ( e .. g , if the embedding of @xmath0 in @xmath49 produces folds ) . in nlsa",
    ", geometrical regularity is viewed as an essential ingredient of an efficient description of high - dimensional complex data , and is enforced by replacing the chronos space of ssa with function spaces on the data manifold of sufficient smoothness .",
    "more specifically , the temporal modes in nlsa have well - behaved derivatives on the data manifold , in the sense that @xmath50 is integrable on @xmath0 . here and in  ,",
    "summation over the tensorial indices @xmath51 and @xmath52 is over the dimensions of @xmath0 , and @xmath53 the gradient operator associated with the riemannian metric @xmath22 of @xmath0 .",
    "moreover , we assume for now that @xmath0 is smooth and compact , so that a well - defined spectral theory exists . later , we will pass to a graph - theoretic description , where smoothness is not an issue .",
    "a natural set of basis functions possessing this type of regularity are the eigenfunctions @xmath54 of the laplace - beltrami operator @xmath55 , defined as @xcite @xmath56 with @xmath57 , and @xmath58 an element of the hilbert space @xmath4 of square - integrable scalar functions on @xmath0 with inner product inherited from the riemannian measure @xmath5 [ see   ahead ] .",
    "the eigenfunctions of @xmath59 are solutions of the eigenvalue problem @xmath60 ( together with appropriate boundary conditions if @xmath0 has boundaries ) with @xmath61 .",
    "moreover , @xmath54 can be chosen to be orthonormal with respect to the inner product of @xmath4 , i.e. , @xmath62    let @xmath63 be the @xmath7-dimensional subspace of @xmath4 spanned by the leading @xmath7 eigenfunctions from   meeting the orthonormality condition in  ; i.e. , @xmath64 these spaces have the following important properties .    1 .",
    "as @xmath65 , @xmath63 provides a dense coverage of @xmath4 .",
    "moreover , if @xmath0 is a differentiable manifold , every basis element of @xmath63 is a smooth function with bounded covariant derivative .",
    "heuristically , @xmath7 may be though of as a parameter controlling the scale on the data manifold resolved by the eigenfunctions spanning @xmath63 .",
    "2 .   for sufficiently small @xmath7 and large - enough number of samples @xmath26 , the values of @xmath66 on the discrete samples of the data manifold in   can be computed efficiently using sparse graph - theoretic algorithms @xcite . even if @xmath0 is not a smooth manifold ( as is frequently the case in practice ) ,",
    "the leading few eigenfunctions determined by graph - theoretic analysis can be associated with some smooth coarse - grained manifold reflecting the large - scale nonlinear geometry of @xmath0 .",
    "note that @xmath7 is in general not equal to the dimension of @xmath0 .    in nlsa ,",
    "the family of @xmath63 with @xmath7 between one and some upper limit are employed to construct temporal spaces analogous to the chronos space in classical ssa .",
    "specifically , given a trajectory @xmath67 on the data manifold , a function @xmath68 with expansion coefficients @xmath69 gives rise to a temporal process @xmath70 for @xmath41 .",
    "thus , introducing the hilbert space @xmath71 with weighted inner product @xmath72 the @xmath7-th temporal space in nlsa is the @xmath7-dimensional subspace @xmath8 of @xmath71 consisting of temporal patterns @xmath73 generated by functions of the form in  .",
    "similarly to  , for each @xmath8 there exists a linear map @xmath74 linking the temporal modes to the spatial modes through the formula @xmath75 let @xmath76 be the orthonormal basis of @xmath63 from  , and @xmath77 an orthonormal basis of @xmath16 .",
    "the matrix elements of @xmath3 with this choice of bases are @xmath78 where @xmath79 is the inner product of @xmath16 , and @xmath80 .",
    "computing the svd of the @xmath9 matrix @xmath81 $ ] then leads to a spectral decomposition of @xmath3 analogous to  , viz .",
    "@xmath82 where @xmath83 and @xmath84 are elements of @xmath85 and @xmath86 orthogonal matrices , respectively , and @xmath87 are singular values ( ordered in order of decreasing @xmath88 ) .",
    "each @xmath89 is a spatial pattern in @xmath16 expanded in the @xmath90 basis .",
    "moreover , the entries @xmath91 are the expansion coefficients of the corresponding temporal pattern in the @xmath92 basis for @xmath8 , leading to the temporal process @xmath93 thus , the decomposition of the signal @xmath67 in terms of the @xmath7 chronos and topos modes of @xmath3 , analogous to  , is @xmath94 note that by completeness of laplace - beltrami eigenfunctions [ @xmath95 , @xmath96 converges to @xmath67 as @xmath65 .",
    "moreover , the spatial and temporal covariance operators in nlsa , @xmath97 and @xmath98 , can be expressed as convolutions of the spatial and temporal two - point correlation functions with the spectral kernel , @xmath99 , weighted by the riemannian measure ; see @xcite for details .    to complete the procedure , in step  ( 5 )",
    "the @xmath100 are projected to @xmath12-dimensional physical space by writing @xmath101 and taking the average , @xmath102 this leads to the decomposition in  .      in applications ,",
    "the laplace - beltrami eigenfunctions for a finite dataset are computed by replacing the manifold by a weighted graph @xmath103 with vertices @xmath104 , and solving the eigenproblem of a transition probability matrix @xmath105 defined on the vertex set of @xmath103 , such that , for large - enough @xmath26 and small - enough @xmath106 , the right eigenvectors @xmath107 of @xmath105 approximate the corresponding laplace - beltrami eigenfunctions @xmath54 in  ; i.e. , @xmath108 with @xmath109and @xmath110 .",
    "these eigenvectors satisfy an orthonormality condition which is the discrete analog to  , @xmath111 with @xmath112 given by the invariant measure ( leading left eigenvector ) of @xmath105 ; namely,@xmath113 where @xmath114 , @xmath115 , and @xmath116 .    in the present work ,",
    "we evaluate @xmath105 using the diffusion map ( dm ) algorithm of coifman and lafon @xcite , with a simple but important modification in the calculation of the gaussian weight matrix .",
    "specifically , we assign to each sample @xmath117 a local velocity in embedding space , @xmath118 , and evaluate the gaussian weights @xmath119 where @xmath120 denotes the norm of @xmath16 .",
    "this approach was motivated by the clustering algorithm developed in @xcite , with the difference that in the latter paper @xmath121 is evaluated using spatial nearest neighbors , rather than the temporal nearest neighbors employed here .",
    "locally - scaled kernels have also been used in other works in the literature ; e.g. , @xcite .    in the standard implementation of dm",
    ", @xmath122 must be sufficiently small in order for the diffusion process represented by @xmath105 to be sensitive only to local neighborhoods around each data point .",
    "here , the normalization by @xmath123 enforces geometrical localization even for @xmath124 . in @xcite",
    ", we found that this type of adaptive kernel significantly enhances the capability of nlsa to capture rare events .",
    "the remaining standard steps needed to compute @xmath105 given @xmath125 are @xcite    @xmath126    because the riemannian measure in the dm family of algorithms is given by @xmath127 for some parameter @xmath128 , states with large @xmath129 acquire larger riemannian measure than in the uniform-@xmath130 case .",
    "hereafter , we work with the so - called laplace - beltrami normalization , @xmath131 @xcite .",
    "even though we have not performed such tests , we believe that suitable basis functions for nlsa may be constructed using a variety of other graph laplacian algorithms ( e.g. , @xcite ) , so long as those algorithms permit the use of time - adaptive weights of the form of  .",
    "the scalability of this class of algorithms to large problem sizes has been widely demonstrated in the machine learning and data mining literature . in particular , as a result of gaussian decay of the weights , the @xmath125 matrix used in implementations is made sparse , e.g. , by truncating @xmath125 to the largest @xmath52 nonzero elements per row with @xmath132 , significantly reducing the cost of the eigenvalue problem for @xmath107 .",
    "the least - favorable scaling involves the pairwise distance calculation between the data samples in embedding space , which scales like @xmath133 if done in brute force . despite the quadratic scaling with @xmath26 , the linear scaling with @xmath134 is of key importance , as it guarantees that nlsa does not suffer from a `` curse of dimension '' as do neural - network - based methods @xcite .",
    "moreover , an @xmath135 scaling may be realized in the pairwise - distance calculation if the dimension of @xmath16 is small - enough for approximate @xmath136-tree - based algorithms to operate efficiently @xcite . note also that the number of elements of the @xmath9 matrix @xmath3 appearing in the svd step of nlsa is smaller by a factor of @xmath137 compared to the full @xmath25 data matrix @xmath35 used in ssa , resulting in significant efficiency gains in practical applications with @xmath138 . in the present study , all calculations were performed on a desktop workstation using brute - force evaluation of pairwise distances .      an important question concerning parameter selection in nlsa is how to choose the parameter @xmath7 controlling the dimension of the temporal spaces @xmath8 . clearly , working at large @xmath7 is desirable , since the lengthscale on the data manifold resolved by the eigenfunctions spanning @xmath139 generally becomes smaller as @xmath7 grows .",
    "however , for a given finite number of samples @xmath26 , the approximation error in the eigenvectors of the graph laplacian in   also increases with @xmath7 @xcite .",
    "in other words , the eigenfunctions @xmath54 determined through graph - theoretic analysis will generally depend more strongly on @xmath26 for large @xmath106 , resulting in an overfit of the discrete data manifold .",
    "thus , in practical applications it is important to establish criteria that allow one to determine a reasonable tradeoff between improved resolution and risk of overfitting .",
    "one way of addressing this issue is to monitor the growth of an operator norm for @xmath140 with @xmath7 , seeking plateau behavior or @xmath141-shaped curves .",
    "a standard choice of operator norm in this context is the frobenius norm , which may be evaluated conveniently via the matrix elements @xmath142 in  , viz .",
    "@xmath143 however , as we will see below , this approach may lead to considerable uncertainty in the choice of @xmath7 .",
    "instead , we find that a more effective method is to choose @xmath7 by monitoring changes in the distribution of the singular values @xmath144 with @xmath7 .",
    "in particular , we propose to assess the behavior of the spectrum of @xmath3 with @xmath7 via a spectral entropy measure , as follows .",
    "let @xmath145 be normalized weights measuring the distribution of energy among the spatiotemporal modes of @xmath3 , which , as usual , are ordered in order of decreasing @xmath146 .",
    "consider also the energy distribution @xmath147 over @xmath148 modes determined by replicating @xmath144 for @xmath149 $ ] , and setting the energy in @xmath150 equal to @xmath151 .",
    "that is , we have @xmath152 here , we measure the change in the spectrum of @xmath3 relative to @xmath153 through the relative entropy between the energy distributions @xmath154 and @xmath147 , i.e. , @xmath155 it is a standard result in information theory and statistics @xcite that @xmath10 is a non - negative quantity which vanishes if and only if @xmath156 for all @xmath106 . in sec .",
    "[ secdimensionselection2 ] we demonstrate that as @xmath7 grows @xmath10 exhibits a sequence of spikes at small to moderate @xmath7 ( as qualitatively new features appear in the spectrum of @xmath3 ) , until it eventually settles to small values at higher @xmath7 .",
    "the practical criterion proposed here is to set @xmath7 to values near that transition .",
    "we apply the nlsa framework presented above to study variability in the north pacific sector of ccsm3 ; specifically , variability of the mean upper 300 m sea temperature field in the 700 y equilibrated control integration used by teng and branstator @xcite and branstator and teng @xcite in work on the initial and boundary - value predictability of subsurface temperature in that model . here",
    ", our objective is to diagnose the prominent modes of variability in a time series generated by a coupled general circulation model . in this analysis ,",
    "the @xmath11 observable is the mean upper 300 m temperature field sampled every month at @xmath157 gridpoints ( native ocean grid mapped to the model s t42 atmosphere ) in the region 20@xmath158n65@xmath158n and 120@xmath158e110@xmath158w .      deferring a discussion on parameter selection to sec .",
    "[ secdiscussion ] , we begin with a description of the spatiotemporal patterns determined via nlsa using a two - year lagged - embedding window and the leading @xmath159 laplace - beltrami eigenfunctions as basis functions for @xmath8 .",
    "thus , the dimension of the spatial and temporal spaces is @xmath160 and @xmath161 , respectively . throughout",
    ", we work with canonical euclidean distances between vectors in embedding space , @xmath162 where @xmath163 denotes the @xmath106-th gridpoint value of the system state at time @xmath164 in embedding space . for the evaluation of the graph - laplacian eigenfunctions in   we nominally set @xmath165 ( adaptive kernel width ) and @xmath166 ( number of edges per data point ) .",
    "we display the singular values @xmath146 of the resulting @xmath3 operator in fig .",
    "[ figsingularvalues](a ) . to verify the robustness of our results",
    ", we evaluated the spectrum of @xmath3 for various parameter values in the intervals @xmath167 $ ] , @xmath168 $ ] , and @xmath169 $ ] . in the examples shown in fig .",
    "[ figsingularvalues](b ) , reducing @xmath52 to 1000 with @xmath122 and @xmath7 fixed to their nominal values causes some reshuffling of the modes ( e.g. , @xmath170 and @xmath171 ) , but imparts little change to the singular values of the modes which are not reshuffled .",
    "increasing @xmath7 to 47 reestablishes the mode ordering to some extent , bringing the @xmath172 and @xmath166 spectra to a near overlap for the first 17 modes .",
    "we will return to the question of setting @xmath7 in sec .",
    "[ secdimensionselection2 ] ahead , but for the time being note that the modes which are most sensitive to changes of @xmath52 and/or @xmath7 in fig .",
    "[ figsingularvalues ] lie on the ssa branch of the spectrum , i.e. , they are modes carrying little spectral information in the sense of the relative entropy metric @xmath10 in  . in general , the properties the leading modes in the all three families described below exhibit small sensitivity to changes of @xmath122 and @xmath52 in the examined ranges , with @xmath7 selected according to the @xmath10 criterion .",
    "for the remainder of sec .",
    "[ secmodes ] , we work with the nominal values @xmath165 , @xmath166 , and @xmath173 . studying the corresponding temporal patterns @xmath40 from   in both the temporal and frequency ( fourier ) domains , we find that the modes fall into three distinct families of periodic , low - frequency , and intermittent modes , illustrated in fig .  [ figtemporalpatterns ] , and described below .",
    "the resulting spatiotemporal patterns @xmath174 from   are shown in fig .",
    "[ figreconstruction ] and , more clearly , in the dynamical evolution in movie  s1 .",
    "note that the time - lagged embedding in   is essential to the separability of the modes into these families ; we will return to this point in sec .",
    "[ seclaggedembedding ] .",
    "* periodic modes . *",
    "the periodic modes come in doubly - degenerate pairs ( see fig .  [ figsingularvalues ] ) , and have the structure of sinusoidal waves with phase difference @xmath175 and frequency equal to integer multiples of 1 y@xmath176 .",
    "the leading periodic modes , @xmath177 and @xmath178 , represent the annual ( seasonal ) cycle in the data . in the physical domain",
    "[ figreconstruction](c ) and movie  s1(c ) ] , these modes generate an annual oscillation of temperature anomalies , whose amplitude is largest ( @xmath179c ) in the western part of the basin ( @xmath180e@xmath181e ) and for latitudes in the range @xmath182n@xmath183n .",
    "the second set of periodic modes , @xmath184 and @xmath185 , have semiannual variability .",
    "these modes exhibit significant amplitude in the western part of the domain [ fig .",
    "[ figreconstruction](e ) and movie  s1(e ) ] , but also along the west coast of north america , which is consistent with semiannual variability of the upper ocean associated with the california current @xcite . together with the higher - frequency overtones , the modes in this family are the standard eigenfunctions of the laplacian on the circle , suggesting that the data manifold @xmath0 has the geometry of a circle along one of its dimensions .    *",
    "low - frequency modes .",
    "* the low - frequency modes are characterized by high spectral power over interannual to interdecadal timescales , and strongly suppressed power over annual or shorter time scales . as a result",
    ", these modes represent the low - frequency variability of the upper ocean , which has been well - studied in the north pacific sector of ccsm3 @xcite . the leading mode in this family [ @xmath186",
    "; see fig .",
    "[ figtemporalpatterns](b ) ] , gives rise to a typical pdo pattern [ figure  [ figreconstruction](c ) and movie  s1(c ) ] , where the most prominent basin - scale structure is a horseshoe - like temperature anomaly pattern developing eastward along the kuroshio current , together with an anomaly of the opposite sign along the west coast of north america .",
    "the higher modes in this family gradually develop smaller spatial features and spectral content over shorter time scales than @xmath186 , but have no spectral peaks on annual or shorter timescales .",
    "* intermittent modes . * as illustrated in fig .",
    "[ figreconstruction](f ) and movie  s1(f ) , the key feature of modes in this family is temporal intermittency , arising out of oscillations at annual or higher frequency , which are modulated by relatively sharp envelopes with a temporal extent in the 210-year regime . like",
    "their periodic counterparts , the intermittent modes form nearly degenerate pairs ( see fig .",
    "[ figsingularvalues ] ) , and their base frequency of oscillation is an integer multiple of 1 year@xmath176 .",
    "the resulting fourier spectrum is dominated by a peak centered at at the base frequency , exhibiting some skewness towards lower frequencies .    in the physical domain",
    ", these modes describe processes with relatively fine spatial structure , which are activated during the intermittent bursts , and become quiescent when the amplitude of the envelopes is small .",
    "the most physically - recognizable aspect of these processes is enhanced transport along the kuroshio current region , shown for the leading - two intermittent modes ( @xmath187 and @xmath188 ) in figure  [ figreconstruction](d ) .",
    "this process features sustained eastward propagation of small - scale , @xmath189 @xmath190c temperature anomalies during the intermittent bursts",
    ". the intermittent modes higher in the spectrum also encode rich spatiotemporal patterns , including retrograde ( westward ) propagating anomalies , and gyre - like patterns resembling the subpolar and subtropical gyres .",
    "these features are shown in movie  s1(f ) , which displays a composite temperature anomaly field consisting of the leading four intermittent modes ( @xmath191 ; see fig .",
    "[ figsingularvalues ] ) .",
    "singular values @xmath144 ( normalized so that @xmath192 ) for the periodic , low - frequency ( decadal ) , and intermittent spatiotemporal patterns evaluated through nlsa and ssa for lagged embedding window @xmath193 y. ( a ) nlsa spectrum for the nominal parameter values ( temporal space dimension @xmath194 , nearest neighbors per data point @xmath195 ) and the corresponding spectrum from ssa .",
    "( b ) comparison of nlsa spectra with different @xmath7 and @xmath52 values.the kernel scaling parameter is @xmath165 throughout . ]",
    "temporal patterns @xmath48 corresponding to the singular values in fig .  [ figsingularvalues ]",
    ". shown in the temporal ( left - hand panels ) and frequency domains ( right - hand panels ) are ( a ) the annual mode , @xmath196 , ( b ) the pdo mode , @xmath186 , ( c ) the leading kuroshio intermittent mode , @xmath187 . ]    spatiotemporal patterns of the the upper 300 m temperature anomaly field ( annual mean subtracted at each gridpoint ) in the north pacific sector of ccsm 3 , evaluated using nlsa with @xmath197 ( see fig .",
    "[ figsingularvalues ] ) and ssa .",
    "( a ) raw data in november of year 91 of figure  [ figtemporalpatterns ] .",
    "( b ) leading low - frequency mode from ssa .",
    "( c  f ) composite fields determined through nlsa . ( c )",
    "annual modes , @xmath177 and @xmath178 .",
    "( d ) leading low - frequency mode , @xmath186 , describing the pdo .",
    "( e ) semiannual modes , @xmath184 and @xmath185 .",
    "( f ) first two - fold degenerate set of intermittent modes , @xmath187 and @xmath188 , describing variability of the kuroshio current .",
    "the dynamical evolution of these patterns in movie  s1 is much more revealing . ]",
    "the main result of this analysis , which highlights the importance of taking explicitly into account the nonlinear structure of complex high - dimensional datasets , is the existence of intermittent patterns of variability in the north pacific sector of ccsm3 , which are not accessible through ssa .",
    "this type of variability naturally emerges by restricting the temporal modes to lie in the low - dimensional subspaces @xmath8 spanned by the leading laplace - beltrami eigenfunctions on the data manifold @xmath0 .",
    "the inner product of these vector spaces , weighted by the riemannian measure @xmath5 in  , plays an important role in the skill of nlsa of capturing intermittency and rare events @xcite .",
    "heuristically , this is because @xmath198 weighs each state @xmath67 by the volume it occupies in @xmath0 , which is expected to be large for rare and/or intermittent states .    as shown in figs .",
    "[ figsingularvalues ] and  [ figreconstruction ] , the spatiotemporal patterns determined through nlsa are in close agreement with ssa for the annual and low - frequency modes , but intermittent modes have no ssa counterparts .",
    "in particular , instead of the qualitatively - distinct families of processes described above , the ssa spectrum is characterized by a smooth decay involving modes of progressively higher spatiotemporal frequencies , but with no intermittent behavior analogous , e.g. , to mode @xmath187 in fig .",
    "[ figtemporalpatterns ] .",
    "the @xmath144 values associated with the intermittent modes and , correspondingly , their contributed variance of temperature anomaly , is significantly smaller than the periodic or low - frequency modes . however , this is not to say the dynamical significance of these modes is negligible .",
    "in fact , intermittent events , carrying low variance , are widely prevalent features of complex dynamical systems @xcite .",
    "being able to capture this intrinsically nonlinear behavior constitutes one of the major strengths of the nlsa methodology presented here .      as discussed in sec .",
    "[ secdimensionselection ] , an important issue in nlsa is the selection of the dimension of the temporal space @xmath8 through the number @xmath7 of laplace - beltrami eigenfunctions used in  .",
    "setting @xmath7 too low will cause some important features to be lost , due to under - resolution on the data manifold . on the other hand ,",
    "as @xmath7 grows , eventually the algorithm will overfit the data if the number of samples @xmath26 remains fixed . here , we illustrate how the spectral entropy measure @xmath10 introduced in   can be used to inform the selection of suitable values of @xmath7 . for ease of comparison ,",
    "we normalize @xmath10 to lie in the unit interval by applying the standard transformation @xcite @xmath199    figure  [ figrelativeentropy ] shows the dependence of @xmath10 , as well as the frobenius norm @xmath200 of the linear operators in nlsa , for values of @xmath7 in the interval @xmath201 $ ] and embedding windows @xmath202 , 2 , and 4 y. as expected , @xmath200 increases with @xmath8 , and apart from the case with @xmath203 , rapidly approaches values close to 90% of its maximum value ( occurring for @xmath204 ) . compared with the corresponding behavior of the norm in truncated ssa expansions ( also shown in fig .",
    "[ figrelativeentropy ] ) , @xmath200 follows a more staircase - like growth , but because the operator norm is dominated by the leading few singular values carrying the majority of the energy of the signal , it is not immediately obvious when @xmath7 has reached an optimum value . on the other hand , the spectral entropy measure @xmath10 clearly transitions from a regime of saw - tooth behavior with appreciable magnitude at small to moderate @xmath7 , to a regime of negligible amplitude at larger values of @xmath7 .",
    "that transition , which occurs around @xmath205 for the nlsa cases with @xmath193 and @xmath206 y ( @xmath207 for the case with no embedding and for ssa ) , indicates that increasing the dimension of @xmath8 beyond those values introduces no qualitatively new spatiotemporal patterns .",
    "this provides justification for the @xmath173 value used in sec .",
    "[ secmodes ] . as illustrated in fig .",
    "[ figsingularvalues2 ] , the spectral gaps separating the low - frequency , semiannual , and intermittent modes are absent from the @xmath144 spectrum with @xmath7 significantly exceeding the threshold value identified via @xmath10 .    frobenius norm of the @xmath3 operator and spectral entropy @xmath10 , evaluated via   and  , versus the parameter @xmath7 controlling the dimension of the temporal spaces @xmath8 ( @xmath208 ) . the lagged - embedding window is @xmath202 , 2 , and 4 y. the norm @xmath200 has been normalized to unity at @xmath204 ( number of samples ) . also shown for reference are the corresponding frobenius norms and spectral entropy measures evaluated by truncating the ssa expansion in   at @xmath7 modes .",
    "note that the frobenius norms for nlsa and ssa can not be compared directly because they are defined for linear maps acting on different vector spaces .",
    "@xmath10 has been scaled to the unit interval by applying the transformation in  . ]",
    "singular value spectrum from nlsa with temporal space dimension @xmath209 and 70 . ]",
    "the embedding in   of the input data @xmath11 in @xmath16 is essential to the separability of the temporal into distinct families of processes . to illustrate this , in figure  [ figvtmixed ] we display the temporal mode that most - closely resembles the pdo mode of fig .",
    "[ figreconstruction](d ) , evaluated without embedding ( @xmath210 , @xmath202 ) .",
    "it is evident from both the temporal and fourier representations of that mode that the decadal process recovered in sec .",
    "[ secspatiotemporalpatterns ] using a two - year embedding window has been contaminated with high - frequency variability ; in particular , prominent spectral lines at integer multiples of 1 y@xmath176 down to the maximum frequency of @xmath211 allowed by the monthly sampling of the data .",
    "an even stronger frequency mixing was found to take place in the corresponding temporal ssa modes .",
    "optimal values for the embedding window are generally hard to determine _ a priori_. however , the following guidelines are useful in the parameter selection process if some physical information is available about the dataset :    1 .",
    "_ external factors and non - markovian effects .",
    "_ if the data are known to be influenced by time - dependent external factors ( e.g. , solar forcing ) , or exhibit non - markovian effects due to partial observations @xcite , then a good initial choice for @xmath212 would be a value comparable to timescales associated with those factors .",
    "the @xmath193 y choice made here is compatible with the annually varying solar forcing , which is one of the most important external factors in upper ocean dynamics .",
    "timescales associated with propagating structures . _",
    "if the dataset features propagating coherent structures ( e.g. , oceanic or atmospheric waves ) , then suitable candidate values for @xmath212 are given by the natural timescales ( e.g. , period , decorrelation time ) of the propagating structures . because each point in lagged embedding space corresponds to a spatiotemporal process of temporal extent @xmath212 , such propagating structures can be described via two - fold degenerate sets of modes evolving in temporal quadrature .",
    "for instance , the @xmath193 y window employed here is long - enough to capture prominent low - frequency waves in the ocean such as baroclinic rossby waves and intraseasonal kelvin waves @xcite .",
    "see @xcite for an example involving organized convection in the tropics .",
    "the relative entropy measure @xmath10 of sec .",
    "[ secdimensionselection ] can also be used to inform the selection of @xmath212 , especially in situations with little _ a priori _ information about the dynamics . in separate calculations",
    ", we have verified that the modes separate into periodic , low - frequency , and intermittent processes for embedding windows up to @xmath213 y , including the @xmath214 y case displayed in fig .",
    "[ figrelativeentropy ] .",
    "leading `` low - frequency '' mode evaluated without embedding [ cf .",
    "note the pronounced spectral lines with period @xmath215 y. ]      a standard preprocessing step in the geosciences and other disciplines is to detrend the data by subtracting monthly climatology , or applying bandpass filtering , to isolate the signal of interest ( see , e.g. , @xcite for an overview of popular methods ) . in the context of nlsa algorithms",
    ", we advocate that such preprocessing can in fact lead to significant loss of information and performance degradation . conceptually",
    ", preprocessing a nonlinear data manifold through a linear operation such as seasonal - cycle subtraction may lead to distortion of the neighborhood relationships of the data , with adverse consequences on the extracted spatiotemporal patterns , which is what we have observed in the north pacific data studied here .",
    "figure  [ figrelativeentropydeseasonalized ] shows the relative entropy measure @xmath10 obtained by applying nlsa with lagged embedding window @xmath193 y to the temperature field data of sec .",
    "[ secmodes ] with the monthly climatology ( average temperature anomaly field for each month ) subtracted . as manifested by the faster decay of @xmath10 compared to the @xmath193 y results of fig .",
    "[ figrelativeentropy ] , detrending leads to a decrease in the number of modes that carry significant information .",
    "indeed , the temporal patterns of the detrended data all have the same qualitative structure as the low - frequency modes of sec .  [ secspatiotemporalpatterns ] , characterized by decaying frequency spectra with no obvious peaks",
    "; see fig .",
    "[ figvtdeseasonalized ] . that seasonal detrending eliminates the annual periodic modes and their harmonics from the spectrum is intuitively obvious , but it turns out that the intermittent modes are removed from the spectrum as well . in particular ,",
    "we have not been able to find modes with the spatial features characteristic of the intermittent modes in fig .",
    "[ figreconstruction](e , f ) in a number of experiments with temporal space dimension @xmath7 up to 34 .",
    "we believe that the intermittent modes depend crucially on phase relationships with the seasonal cycle and its higher harmonics , and as result the algorithm fails to detect these modes if seasonality has been removed from the data .",
    "relative entropy @xmath10 , normalized to the unit interval via  , as a function of temporal space dimension @xmath7 for deseasonalized data .",
    "the lagged embedding window is @xmath193 y. ]    leading three temporal patterns from nlsa for deseasonalized data .",
    "the lagged embedding window and temporal space dimension are @xmath216 2 y and @xmath217 , respectively . ]",
    "combining techniques from machine learning and the qualitative theory of dynamical systems , in this work we have presented a scheme called nlsa for spatiotemporal analysis of high - dimensional time series , which takes explicitly into account the nonlinear geometrical structure of datasets arising in geophysics and other applied sciences . like classical ssa @xcite ,",
    "the method presented here utilizes time - lagged embedding and svd to produce a decomposition of time series generated by partial observations of high - dimensional , complex dynamical systems into distinct spatiotemporal modes .",
    "however , the linear operators used here in the svd step differs crucially from ssa in that their domains of definition are low - dimensional hilbert spaces of square - integrable functions on the nonlinear manifold @xmath0 comprised by the data ( in a suitable coarse - grained representation via a graph ) .",
    "this family of spaces , @xmath8 , is tailored to the nonlinear geometry of @xmath0 through its riemannian measure , and has high skill in capturing intermittency and rare events . as its dimension @xmath7 grows",
    ", @xmath8 provides a description of spatiotemporal patterns at increasingly fine resolution on the data manifold .",
    "moreover , well - behaved orthonormal basis functions for these spaces can be computed efficiently via graph - laplacian algorithms developed in data mining and machine learning @xcite .    applying this scheme to the upper - ocean temperature in the north pacific sector of the ccsm3 model",
    ", we find a family of intermittent processes which are not captured by ssa .",
    "these processes describe eastward - propagating , small - scale temperature anomalies in the kuroshio current region , as well as retrograde - propagating structures at high latitudes and in the subtropics ( see movie  s1 ) .",
    "moreover , they carry little variance of the raw signal , and display burst - like behavior characteristic of strongly nonlinear dynamics .",
    "the remaining identified modes include the familiar pdo pattern of low - frequency variability , as well as annual and semiannual periodic processes .",
    "the ability to recover the intermittent modes relies crucially on retaining the seasonal cycle ( monthly climatology ) of the data , suggesting that these modes operate in non - trivial phase relationships with the periodic modes .",
    "the nature of the analysis presented here is purely diagnostic .",
    "in particular , we have not touched upon the dynamical role of these modes in reproducing the observed dynamics , e.g. , by triggering large - scale regime transitions @xcite .",
    "this question was addressed to some extent in @xcite in the context of a low - order chaotic model for the atmosphere , but remains open in applications involving high - dimensional complex dynamical systems with unknown equations of motion . here ,",
    "statistical modeling techniques , such as bayesian hierarchical modeling @xcite , combined with information - theoretic methods for assessing predictability and model error @xcite , are promising methods for training empirical models for these processes , and assessing their predictive skill .",
    "we plan to study these topics in future work .",
    "this work was supported by nsf grant dms-0456713 , onr dri grants n25 - 74200-f6607 and n00014 - 10 - 1 - 0554 , and darpa grants n00014 - 07 - 10750 and n00014 - 08 - 1 - 1080 .",
    "we thank g.  branstator and h.  teng for providing access to the ccsm3 dataset used in this analysis .",
    "spatiotemporal patterns of the the upper 300 m temperature anomaly field ( annual mean subtracted at each gridpoint ) in the north pacific sector of ccsm 3 , evaluated using nlsa with @xmath197 ( see fig .  [ figsingularvalues ] ) and ssa .",
    "( a ) raw data .",
    "( b ) leading low - frequency mode from ssa .",
    "( c  f ) composite fields determined through nlsa . ( c )",
    "annual modes , @xmath177 and @xmath178 .",
    "( d ) leading low - frequency mode , @xmath186 , describing the pdo .",
    "( e ) semiannual modes , @xmath184 and @xmath185 .",
    "( f ) leading four intermittent modes , @xmath218 , describing variability of the kuroshio current and retrograde ( westward ) propagating structures .",
    "the starting time of this animation is the same as in fig .",
    "[ figtemporalpatterns ] .            h.  teng and g.  branstator",
    ". initial - value predictability of prominent modes of north pacific subsurface temperature in a cgcm .",
    "_ climate dyn .",
    "_ , 360 ( 910):0 18131834 , 2010 .",
    "doi : 10.1007/s00382 - 010 - 0749 - 7 .      c.  h.  r. lima , u.  lall , t.  jebara , and a.  g. barnston .",
    "statistical prediction of enso from subsurface sea temperature using a nonlinear dimensionality reduction .",
    "_ j. clim .",
    "_ , 22:0 45014519 , 2009 .",
    "doi : 10.1175/2009jcli2524.1 .",
    "d.  giannakis and a.  j. majda .",
    "nonlinear laplacian spectral analysis for time series with intermittency and low - frequency variability .",
    "_ , 1090 ( 7):0 22222227 , 2012 .",
    "doi : 10.1073/pnas.1118984109 .",
    "d.  giannakis and a.  j. majda . revealing qualitatively - distinct spatio - temporal processes in climate data through machine learning . in _ conference on intelligent data understanding ( cidu ) 2011_. nasa , 2011 .",
    "a.  singer , r.  erban , i.  g. kevrekidis , and r.  r. coifman . detecting intrinsic slow variables in stochastic dynamical systems by anisotropic diffusion maps .",
    "_ , 1060 ( 38):0 1609016095 , 2009 .",
    "doi : 10.1073/pnas.0905547106 .",
    "f.  takens . detecting strange attractors in turbulence . in _ dynamical systems and turbulence ,",
    "warwick 1980 _ , volume 898 of _ lecture notes in mathematics _ , pages 366381 .",
    "springer , berlin , 1981 .",
    "doi : 10.1007/bfb0091924 .",
    "d.  giannakis , w .- w .",
    "tung , and a.  j. majda .",
    "hierarchical structure of the madden - julian oscillation in infrared brightness temperature revealed through nonlinear laplacian spectral analysis . in _ conference on intelligent data understanding ( cidu )",
    "2012_. nasa , 2012 . submitted .",
    "d.  giannakis and a.  j. majda . quantifying the predictive skill in long - range forecasting .",
    "part ii : model error in coarse - grained markov models with application to ocean - circulation regimes .",
    "_ j. clim .",
    "_ , 250 ( 6):0 18141826 , 2011 ."
  ],
  "abstract_text": [
    "<S> we present a technique for spatiotemporal data analysis called nonlinear laplacian spectral analysis ( nlsa ) , which generalizes singular spectrum analysis ( ssa ) to take into account the nonlinear manifold structure of complex datasets . </S>",
    "<S> the key principle underlying nlsa is that the functions used to represent temporal patterns should exhibit a degree of smoothness on the nonlinear data manifold @xmath0 ; a constraint absent from classical ssa . </S>",
    "<S> nlsa enforces such a notion of smoothness by requiring that temporal patterns belong in low - dimensional hilbert spaces @xmath1 spanned by the leading @xmath2 laplace - beltrami eigenfunctions on @xmath0 . </S>",
    "<S> these eigenfunctions can be evaluated efficiently in high ambient - space dimensions using sparse graph - theoretic algorithms . </S>",
    "<S> moreover , they provide orthonormal bases to expand a family of linear maps , whose singular value decomposition leads to sets of spatiotemporal patterns at progressively finer resolution on the data manifold . </S>",
    "<S> the riemannian measure of @xmath0 and an adaptive graph kernel width enhances the capability of nlsa to detect important nonlinear processes , including intermittency and rare events . </S>",
    "<S> the minimum dimension of @xmath1 required to capture these features while avoiding overfitting is estimated here using spectral entropy criteria .    as an application </S>",
    "<S> , we study the upper - ocean temperature in the north pacific sector of a 700-year control run of the ccsm3 climate model . besides the familiar annual and decadal modes , nlsa recovers a family of intermittent processes associated with the kuroshio current and the subtropical and subpolar gyres . </S>",
    "<S> these processes carry little variance ( and are therefore not captured by ssa ) , yet their dynamical role is expected to be significant .      </S>",
    "<S> laplacian eigenmaps , singular spectrum analysis , intermittency , decadal variability , manifold embedding </S>"
  ]
}