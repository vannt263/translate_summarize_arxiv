{
  "article_text": [
    "stochastic behavior is an essential facet of biological processes such as gene expression , protein expression , and epigenetic processes  @xcite .",
    "stochastic chemical kinetics simulations are often used to study systems biology models of such processes  @xcite .",
    "one of the more common stochastic approaches , and the one employed in the present study , is the stochastic simulation algorithm ( ssa ) , also known as the gillespie algorithm  @xcite .    as stochastic",
    "systems biology models approach the true complexity of the systems being modeled , it quickly becomes intractable to investigate rare behaviors using nave ( `` brute - force '' ) simulation approaches . by their very nature ,",
    "rare events occur infrequently ; confoundingly , rare events are often those of most interest .",
    "for example , the switching of a bistable system from one state to another may happen so infrequently that running a stochastic simulation long enough to see transitions is ( extremely ) computationally prohibitive  @xcite .",
    "this impediment only grows as model complexity increases , and as such it poses a serious hurdle for systems models as they grow more intricate .",
    "several approaches to speeding up the simulation of rare events in stochastic chemical kinetic systems exist .",
    "a variety of `` leaping '' methods can , by taking advantage of approximate time - scale separation , accelerate the ssa itself  @xcite .",
    "kuwahara and mura s weighted stochastic simulation ( wssa ) method  @xcite was refined by gillespie and petzold et al .",
    "@xcite , and is based on importance sampling .",
    "the forward flux sampling method of ten wolde et al .",
    "@xcite uses a series of interfaces in state - space to reduce computational effort , as does the non - equilibrium umbrella sampling approach  @xcite .",
    "rare event sampling is also an active topic in the field of molecular dynamics simulations , and many approaches have been proposed . of the approaches that do not irreversibly modify the free energy landscape of the system ,",
    "some notable methods include dynamic importance sampling  @xcite , milestoning  @xcite , transition path sampling  @xcite , transition interface sampling  @xcite , forward flux sampling  @xcite , non - equilibrium umbrella sampling  @xcite , and weighted ensemble sampling  @xcite . for a summary of these methods ,",
    "see  @xcite .",
    "many of the ideas behind these techniques are not exclusive to molecular dynamics simulations , and can be adapted to studying stochastic chemical kinetic models .",
    "for example , dynamic importance sampling seems to be closely related to wssa .",
    "because of its relative simplicity and potential simplicity in sampling rare events , we apply one of these methods , the weighted ensemble algorithm ( we ) to well - established model systems of stochastic kinetic chemical reactions .",
    "these models range in complexity from one species and two reactions , to 354 species and 3680 reactions . for the systems",
    "studied , we proves many orders of magnitude faster than ssa simulation alone , offers linear parallel scaling , returns full distributions of desired species at arbitrary times , and can yield mean first passage times ( mfpts ) via the setup of a feedback steady - state .",
    "the methods employed are described immediately below , while the models are specified in sec .",
    "[ sec : modelsandresults ] .",
    "stochastic chemical kinetics occupies a middle - ground in the realm of chemical simulation , between very explicit , and costly , molecular dynamics ( md ) simulations and the deterministic formalism of reaction rate equations ( rre ) .",
    "stochastic chemical kinetics attempts to account for the randomness inherent in chemical reactions , without trying to explicitly model the spatial structure of the reacting species .",
    "it is many orders of magnitude faster than md simulations , but much slower than the rre approach .",
    "it is an ideal method to use for modeling the effects of low concentrations ( or copy numbers ) of chemical reactants , while ignoring the effects of specific spatial distribution .",
    "stochastic chemical kinetics models can be solved exactly for sufficiently simple systems using the chemical master equation ( cme ) , and approximately ( for all systems ) using gillespie s direct stochastic simulation algorithm ( ssa )  @xcite .",
    "the ssa samples the cme exact solution by modeling stochastic chemical kinetics in a straightforward manner , and yields trajectories of species concentrations that converge to the rre method in the limit of large amounts of reactants . in brief , the ssa iteratively and stochastically determines which reaction fires when reactions occur , by sampling from the exponential distribution of waiting times between reactions . for a detailed explanation of the ssa ,",
    "see @xcite .",
    "we employ the rule - based modeling and simulation package bionetgen  @xcite to simulate both our toy and complex models .",
    "rule - based modeling languages allow the specification of biochemical networks based on molecular interactions .",
    "rules that describe those interactions can be used to generate a reaction network that can be simulated either as rres or using the ssa , or the rules can be used directly to drive stochastic chemical kinetics simulations .",
    "bionetgen has been applied to a variety of systems , such as the aggregation of membrane proteins by cytosolic cross - linkers in the lat - grb2-sos1 system  @xcite , the single - cell quantification of il-2 response by effector and regulatory t cells  @xcite , the analysis and verification of the hmgb1 signaling pathway  @xcite , the role of scaffold number in yeast signaling systems  @xcite , and the analysis of the roles of lyn and fyn in early events in b cell antigen receptor signaling  @xcite .",
    "we employ bionetgen s implementation of the direct ssa to propagate the dynamics in our systems .",
    "we is a general - purpose protocol used in molecular dynamics simulations  @xcite that we adapt here to the efficient sampling of dynamics generated by chemical kinetic models . in brief",
    ", we employs a strategy of `` statistical natural selection '' using quasi - independent parallel simulations which are coupled by the intermittent exchange of information .",
    "the intermittency leads directly to linear parallel scaling .",
    "importantly , the simulations are coupled via configuration space ( essentially the `` phase space '' of the system in physics language or the `` state - space '' in cell and population modeling ) .",
    "this type of coupling permits both efficiency and a large degree of scale independence .",
    "the efficiency results from distributing trajectories to typically under - sampled parts of the space , while scale independence is afforded because every type of system has a configuration or state - space .",
    "we s strategy of statistical natural selection or statistical ratcheting is schematized in fig .",
    "[ fig : wecartoon ] .",
    "first , the space is divided / classified into non - overlapping `` bins '' which are typically static , although dynamic and adaptive tessellations are possible  @xcite .",
    "a target number of trajectories ,  @xmath6 , is set for each bin .",
    "multiple trajectories are initiated and each is assigned a weight so that the sum of weights is one .",
    "trajectories are then simulated independently according to the desired dynamics ( e.g. , molecular dynamics or ssa ) and checked intermittently ( every @xmath7 units of time ) for their location .",
    "if a trajectory of weight @xmath8 is found to occupy a previously unoccupied bin , that trajectory is replicated to obtain the target number of copies , @xmath6 , for the bin .",
    "daughter trajectories weights are set to @xmath9 , to sum to the weight of the parent trajectory .",
    "if a bin is occupied by more than the target number , trajectories must be pruned in a statistical fashion maintaining the sum of weights .",
    "specifically , the two lowest weight trajectories are `` merged '' by randomly selecting one of them to survive , with probability proportional to their weights , and the surviving trajectory absorbs the weight of the pruned one .",
    "this process is repeated as needed , and maintains an exact statistical representation of the evolving distribution of trajectories  @xcite .",
    "setting up a we simulation requires selection of state - space binning , trajectory multiplicity , and timing parameters . in our simulations",
    ", we chose to divide the state - space of an @xmath10-dimensional system into one- or two - dimensional regular grids of non - overlapping bins .",
    "it is possible to use non - cartesian bins , and to adaptively change the bins during simulation  @xcite , but for simplicity we did not pursue any such optimization .",
    "specific parameter choices for each model are given in sec .",
    "[ sec : modelsandresults ]",
    ".    the weighted ensemble algorithm can be outlined fairly concisely .",
    "let @xmath6 be the target number of segments in each bin , @xmath11 the number of bins , whose geometry are defined by the grid @xmath12 , @xmath7 the time - step of an iteration of we , and @xmath13 the total number of iterations of we .",
    "the we procedure also requires an initial state of the system , @xmath14 , which in our case is a list of the concentrations of all the chemical species in the system .    do nothing",
    "replicate trajectories until bin pop .",
    "@xmath15 maintain sum of weights in each bin merge trajectories until bin pop .",
    "@xmath15 maintain sum of weights in each bin * return * trajectory coordinates & weights for each iter .",
    "the replicating and merging of trajectories in the above algorithm are done randomly , according to the weight of each trajectory segment in a given bin , which has been shown not to bias the dynamics of the ensemble  @xcite .    when we is used to manage an ensemble of trajectories ,",
    "there are two time - scales of immediate concern : the period at which trajectory coordinates are saved , and the period @xmath7 at which ensemble operations are performed .",
    "these two time - scales can be different , but for simplicity we set them to be the same , and select @xmath7 such that it is greater than the average event firing rate for the ssa .",
    "when we refer to the time - step , or iteration of a process , we are referring to the @xmath7 of fig .",
    "[ fig : wecartoon ] .",
    "we can be employed in a variety of modes to address different questions . originally developed to monitor the time evolution of arbitrary initial probability distributions  @xcite , i.e.  non - stationary non - equilibrium systems , we was generalized to efficiently simulate both equilibrium and non - equilibrium steady - states  @xcite .",
    "in steady - state mode , mean first passage times ( mfpts ) can be estimated rapidly based on simulations much shorter than the mfpt using a simple rigorous relation between the flux and mfpt  @xcite .",
    "steady - states can be attained rapidly , avoiding long relaxation times , by using the inter - bin rates computed during a simulation to estimate bin probabilities appropriate to the desired steady - state ; trajectories are then reweighted to conform to the steady - state bin probabilities  @xcite . both of these methods are described in more detail below .",
    "perhaps the simplest use of a weighted ensemble of trajectories is to better sample rare states as a system evolves in time , specifically the states corresponding to extreme values of the binning coordinate .",
    "the ssa itself samples the exact distribution , but its sampling is concentrated about the mode(s ) of the distribution .",
    "the ssa naturally  and correctly  samples rare states infrequently . by using we to split up the state - space , however , one can resample the distribution at every time step @xmath7 , selecting those trajectories that advance along a progress coordinate for more detailed study , but doing so without applying any forces or biasing the trajectories or the distribution .",
    "essentially , we appropriates much of the effort that brute - force ssa devotes to sampling the central component of the distribution , repurposing it to obtain better estimates of the tails .",
    "this basic use of we requires none of the `` tricks '' we apply in later sections , such as using reweighting techniques to accelerate obtaining a steady - state .",
    "we apply basic we to some of our systems  particularly , but not exclusively , to those that are not bistable .",
    "the mean first passage time ( mfpt ) from state @xmath16 to state @xmath17 is a key observable .",
    "it is equal to the inverse of the flux ( of probability density ) from state @xmath16 to state @xmath17 in steady - state @xcite , @xmath18 this relation provides the weighted ensemble approach the ability to calculate mfpts in a straightforward manner . during a we run ,",
    "when any trajectories ( and their associated weights ) reach a designated target area of state - space ( or `` state @xmath17 '' ) , they are removed and placed back in the initial state ( `` state @xmath16 '' ) . eventually , such a process will result in a steady - state flow of probability from state @xmath16 to state @xmath17 that does not change in time ( other than with stochastic noise ) .",
    "[ [ par : reweighting ] ] reweighting .",
    "+ + + + + + + + + + + +    the waiting time to obtain a steady - state constrains the efficiency of obtaining a mfpt by measuring fluxes via equation [ eqn : mfpt ] .",
    "this waiting time can vary from the relatively short time scale of intra - state equilibration for simple systems , to much longer time - scales , on the order of the mfpt itself for more complicated systems . to reduce this waiting time",
    ", we use the steady - state reweighting procedure of bhatt et al .",
    "this method measures the fluxes between bins to obtain a rate - matrix for transitions between bins , and uses a markov formulation to infer a steady - state distribution from the ( noisy ) data available .",
    "for instance , let @xmath19 be the set of bin weights ( i.e  the sum of the weights of the trajectories in each bin ) , and let @xmath20 be the set of steady - state values of the bin weights . if @xmath21 is the flux of weight into bin @xmath22 from bin @xmath23 , then in steady - state , since the flux out of a bin is equal to the flux into it , @xmath24 since the flux of weight into bin @xmath22 from bin @xmath23 is the product of a ( constant ) rate and the ( current ) weight in a bin , i.e.  @xmath25 ( true for both steady state and not ) , we can use eq .",
    "[ eq : ss ] to find the inter - bin rates . by measuring the inter - bin fluxes and the bin weights",
    ", we can approximately infer the transition rates , and then find a set of weights that satisfy eq .",
    "[ eq : ss ] .",
    "once the set of bin weights is found , the weights of the individual trajectories in the bins are rescaled commensurately .",
    "the steady - state distribution of weights thus inferred is not necessarily the true steady - state of the system , but it tends to be closer to it , and an iterative application of this procedure can converge to the true distribution fairly rapidly . in practice",
    "it has been shown to accelerate the system s evolution to a true steady - state by orders of magnitude in some cases  @xcite .",
    "since it is important to assess new approaches quantitatively , we compare the speedup in computing time from weighted ensemble to a brute - force simulation , ( i.e.  ssa ) .",
    "for a given observable ( e.g. , the fraction of probability in a specified tail of the distribution ) and a desired precision , we estimate the efficiency using the ratio : @xmath26 since both we and brute - force use the same dynamics engine / software , we can estimate the speedup of we over brute - force by just keeping track of how much total `` dynamics time '' was simulated in each .",
    "we employ this measure when estimating the advantage of using we to investigate the tails of probability distributions , as well as for finding mfpts in bistable systems .",
    "another measure of efficiency we employ for mfpt estimation gauges how fast we attains a result that is within 50% of the true result ( determined from exact or extensive brute - force calculation ) : @xmath27 this is an assessment of how well we can extract rough estimates of long time - scale behavior from simulations that are much shorter than those timescales .",
    "brute - force ssa simulations can be run for long times without seeing a transition from one macro - state to another . to take account of the brute - force simulations where no transitions occurred",
    "we use a maximum likelihood estimator for the transition time , based on an exponential distribution of waiting times , which is a valid approximation for the one - dimensional and two - state systems studied below :    @xmath28    where @xmath29 is the length of the brute - force simulations , @xmath10 is the number of these simulations performed , @xmath30 is the number of these simulations in which a transition from one state to another is observed , and @xmath31 are the times at which the transition is observed .",
    "we used two different implementations of the weighted ensemble framework : westpa , written in python , is the most feature - rich and stable  @xcite , which will be available at http://chong.chem.pitt.edu/westpa .",
    "another , written by bin zhang  @xcite and modified by us , is written in c , and is faster though less robust , and is available at http://donovanr.github.com/we_git_code .",
    "weighted ensemble ( we ) , as a scripting - level approach , inherently adds some unavoidable overhead to the runtime of the dynamics . this overhead , in theory , is quite minimal : stopping , starting , merging , and splitting trajectories are not computationally costly operations . a key issue in practical implementations , though , is how long the algorithm actually takes to run , i.e  the wall - clock running - time for dynamics ( here , the ssa ) .    in practice",
    ", overhead can be significant for very simple systems , for the sole reason that reading and writing to disk takes so much time compared to how long it takes to run the dynamics of small models . in our implementation",
    ", data is passed from the dynamics engine to we by reading and writing files to disk .",
    "this handicap is an artifact of our interface , which could , with minimal work , be modified to something more efficient . as a proof - of - principle ,",
    "the version of we written in c was modified , for the schlgl reactions and the futile cycle , to contain hard - coded versions of the gillespie direct algorithm for those systems , so as to obviate the i / o between we and bng . with these modifications , it was difficult to ascertain any significant overhead costs at all , and our runs completed in a matter of seconds .",
    "we also note that as model complexity increases and more time is devoted to dynamics , the overhead problem becomes negligible .",
    "practical applications of we will , by nature , target models where dynamics are expensive , rather than toy models , where they are cheap .",
    "we study four different models , ranging in complexity from two chemical reactions governing one chemical species , to 3680 reactions governing 354 species .",
    "the models we employ are coupled stochastic chemical reactions , which we implement and simulate in bionetgen using the ssa  @xcite . as depicted in fig .",
    "[ fig : wecartoon ] , these simulations are , in turn , managed by a weighted ensemble procedure .",
    "the enzymatic futile cycle is a simple and robust model that can , in certain parameter regimes , exhibit qualitatively different behavior due to stochastic noise  @xcite .",
    "this signaling motif can be seen in biological systems including gtpase cycles , mapk cascades , and glucose mobilization  @xcite .",
    "the enzymatic futile cycle studied here is modeled by : @xmath32{k_f } b_1 \\xrightarrow{k_s } e_1 + s_2 \\\\",
    "e_2 + s_2 \\xrightleftharpoons[k_f]{k_f } b_2 \\xrightarrow{k_s } e_2 + s_1 \\end{aligned}\\ ] ] where @xmath33 and @xmath34 . here",
    "@xmath35 can bind to its enzyme @xmath36 , and in the bound form , @xmath37 , ( i.e.  @xmath38 ) , it can be converted to @xmath39 , and then dissociate ( and similarly for @xmath40 ) .",
    "the total amount of substrate , @xmath41 , is conserved , as are the amounts of the different enzymes @xmath36 and @xmath42 , of which is supplied only one of each kind . following kuwahara and mura  @xcite , in the specific system",
    "we look at , we set @xmath43 and @xmath44",
    ".    thus constrained , the above system of reactions can be solved by a 404-state chemical master equation ( cme ) , to obtain an exact probability density for all times when initialized from an arbitrary starting point .",
    "we start the system at @xmath45 and @xmath46 , and are interested in the probability distribution of @xmath35 after 100 seconds , that is , @xmath47 .",
    "the we data was generated using 101 bins of unit width on the coordinate @xmath35 .",
    "we employed 100 trajectory segments per bin that were run for 100 iterations of a @xmath48 time - step , with no reweighting events .",
    "the brute - force data is from 10,200 100-second runs , which is an equivalent amount of dynamics to compute as the single we run , if all the bins were full all the time .",
    "however , since the bins take some time to fill up , the we run employed only 840,000 one - second segments , which makes the comparison to brute - force ssa more than fair .",
    "[ fig : futilepdf ] shows that the brute - force ssa is unable to sample values of @xmath35 much outside the range @xmath49 , whereas the we method is able to accurately sample the entire distribution .",
    "waiting for the brute - force approach to sample the tails would take @xmath50 brute - force runs . with a conservative estimate of @xmath1@xmath51",
    "runs per second , it would take @xmath1@xmath52 seconds , or many times the age of the universe , for brute - force ssa to sample the tails at all .",
    "we takes 23 seconds to sample them ( note the comparison to exact distribution provided by the cme ) , for an approximate efficiency increase @xmath53 .    for the sake of clarity , error - bars",
    "were omitted from fig .",
    "[ fig : futilepdf ] . over most of the data range ,",
    "the error is too small to see on the plot . in the tails ( of both ssa and we - ssa )",
    "the error is not computable from a single run , since there are plot points comprised of only a single trajectory .",
    "the error in the estimate of the distribution can be inferred visually from the data s departure form the cme exact solution . for ssa",
    ", however , generating uncertainties far all values is essentially impossible . when computing quantitative observables reported below , we employ multiple independent runs to procure standard errors in our estimate .     in the enzymatic futile cycle system ,",
    "after @xmath54 seconds , when initialized from a delta function at @xmath55 , @xmath56 at @xmath57 . the exact solution , procured via the chemical master equation ( cme ) , is compared to data obtained using the ssa in a weighted ensemble run ( we - ssa ) , and to ordinary ssa , when each are given equal computation time .",
    "we data is from a single run .",
    "error bars are not plotted ; for a discussion of uncertainties , see sec .  [",
    "sec : futileresults].,width=321 ]    from the distribution , we are able to read off useful statistics . instead of computing mfpts , kuwahara and mura  @xcite , and petzold and gillespie et al .",
    "@xcite defined a related quantity , the probability of a system to pass from one state to another in a certain time : @xmath58  @xcite .",
    "for instance , one might desire to know the probability of the futile cycle to have a value of @xmath59 at @xmath60 . since we gives an accurate estimate of @xmath61 , all that is required to find such statistics is to sum up the area under the state of interest .",
    "for the futile cycle , we find a value of @xmath62 at one standard error for @xmath63 , as computed from ten replicates of the single we run plotted in fig .",
    "[ fig : futilepdf ] .",
    "the cme equation gives an exact value of @xmath64 .",
    "sampling this tail of the distribution at all by brute - force would take @xmath65 brute - force runs . using ten replicate runs ,",
    "we is able to sample it using 8,400,000 we segments , which is equivalent to 83,170 brute - force trajectories , resulting in an increase in sampling efficiency by a factor of @xmath66 for this observable .        the schlgl reactions are a classic toy - model for benchmarking stochastic simulations of bistable systems  @xcite .",
    "they are two coupled reactions with one dynamic species , @xmath67 : @xmath68{k_1 } 3x \\\\ b & \\xrightleftharpoons[k_4]{k_3 } x \\end{aligned}\\ ] ] where @xmath69 , @xmath70 , @xmath71 , @xmath72 , @xmath73 , and @xmath74 .",
    "the species @xmath16 and @xmath17 are assumed to be in abundance , and are held constant . both the mean first passage times and the time - evolution of arbitrary probability distributions can be computed exactly  @xcite .",
    "the we data in fig .",
    "[ fig : schloglpdf ] was generated using 802 bins of unit width , 100 trajectory segments per bin , a time - step @xmath75 , and run for 101 iterations of that time - step , with no reweighting events .",
    "the brute - force data is from 80,200 5-second runs , which is an equivalent amount of dynamics as a single we run , if all bins are always full .",
    "were that the case , the we run would compute dynamics for 8,100,200 trajectory segments ; in our case the we simulation ran 7,047,300 trajectory segments , which makes the comparison to brute - force more than fair .",
    "the we data in fig .",
    "[ fig : schloglflux ] was generated using 80 bins of width 10 , with 32 trajectory segments per bin , a time - step @xmath76 , run for 500 iterations of that time - step . reweighting events ( see sec .  [",
    "par : reweighting ] ) were applied every 100 , 5 , and 2 iterations for the data labeled `` rw-100 '' , `` rw-5 '' , and `` rw-2 '' , respectively .",
    "[ fig : schloglpdf ] shows how the results of both a brute - force ( bf ) approach , and the we approach compare to the exact solution  @xcite , when each employs the same amount of dynamics time .",
    "we start the schlgl system with @xmath77 , i.e.  the pdf is initially a delta function at @xmath77 . to investigate rare transitions , we study the pdf at time @xmath78 .",
    "we is able to accurately sample almost the entire distributions , even over the potential barrier near @xmath79 , while the bf approach is limited to sampling only high probability states .",
    "the schlgl system is bistable , with states centered at @xmath77 and @xmath80 , and a potential barrier between them , peaked at @xmath81 .",
    "the brute - force approach is unable to accurately sample values outside of the initial state , and can not detect bistability in the model .    for the sake of clarity , error - bars were omitted from fig .",
    "[ fig : schloglpdf ] .",
    "over most of the data range , the error is too small to see on the plot . in the tails ( of both ssa and we - ssa )",
    "the error is not computable from a single run , since there are plot points comprised of only a single trajectory .",
    "multiple runs are consistent with the data shown .",
    "the error in the estimate of the distribution can be inferred visually from the data s departure form the cme exact solution .",
    "when computing quantitative observables below , we employ multiple independent runs to procure standard errors in our estimate .",
    "we yields the full , unbiased probability distribution , but we again examine an observable investigated by petzold and gillespie et al .  @xcite . as such , the conversion to the rare event statistics of gillespie et al .",
    "is a simple summation . from ten replicates of the schlgl run plotted in fig .",
    "[ fig : schloglpdf ] , the probability that @xmath82 at @xmath83 seconds , i.e.  @xmath84 , is @xmath85 at 1-@xmath86 .",
    "the cme exact value is @xmath87 .",
    "since it would take at least @xmath88 brute - force trajectories to sample the probability that @xmath82 at @xmath89 , we can estimate an improvement in efficiency of using we over brute - force of @xmath90 .     in the schlgl system , at @xmath89 seconds , when initialized from a delta function at @xmath77 .",
    "the exact solution from the chemical master equation is compared to data obtained using the ssa in a weighted ensemble run ( we - ssa ) , and to ordinary ssa .",
    "we data is from a single run . for a discussion of uncertainties , see sec .",
    "[ sec : schloglresults].,width=321 ]    we also estimate the mean first passage time ( mfpt ) of the schlgl system , which can be computed exactly  @xcite .",
    "weighted ensemble can estimate the mfpt using eq .",
    "[ eqn : mfpt ] when the system is put into a steady - state . for the run",
    "that was reweighted every 100 iterations , fig .",
    "[ fig : schloglflux ] shows the we estimates of the flux from the initial state ( @xmath77 ) to the final state ( @xmath91 ) converge to the exact value in about 100 iterations of weighted ensemble splittings and mergings , which is when the system relaxes from its delta - function initialization to a steady - state .",
    "the attainment of steady - state is accelerated by more frequent reweighting ( see sec .  [",
    "par : reweighting ] on reweighting ) , as is shown in fig .",
    "[ fig : schloglflux ] in the runs that are reweighted every 2 and 5 iterations .",
    "these more frequently reweighted runs yield fluxes close to the exact value within about 30 iterations .    to quantify we s improvement over brute - force in the estimate of the mfpt , we use the measure @xmath92 defined in sec .",
    "[ subsec : efficiency ] . a brute - force estimate of the mfpt would require , optimistically , computing an amount of dynamics on the order of the mfpt itself ( approximately @xmath93 ) seconds . since transitions in this system",
    "follow an exponential distribution , the standard deviation of the first passage times is equal to the mean of them .",
    "we s estimate of the mfpt is within @xmath94 of the exact value after about 30 iterations of we simulation , at which point about 1100 trajectory segments have been propagated , which is equivalent to propagating about 110 seconds of brute - force dynamics .",
    "thus we find @xmath95 .",
    "as can be seen in fig .",
    "[ fig : schloglflux ] , this value is about a 35 fold increase over the we results when reweighting very infrequently ( every 100 iterations ) .    ) for the schlgl system .",
    "the exact value is compared to we results , for reweighting periods of every 100 , 5 , and 2 iterations .",
    "the inverse of the flux gives the mean first passage time by eq .",
    ".,width=321 ]        this model consists of two genes that repress each other s expression",
    ". once expressed , each protein can bind particular dna sites upstream of the gene which codes for the other protein , thereby repressing its transcription  @xcite . if we denote the @xmath22th protein concentration by @xmath96 , the deterministic system is described by the equations : @xmath97 where @xmath98 , @xmath99 , @xmath100 , @xmath101 , @xmath102 , @xmath103 , @xmath104 . in our stochastic model , our chemical reactions",
    "take the form of a birth - death process , the propensity functions of which are taken from the above differential equations : @xmath105 where @xmath106 , @xmath107 $ ] , @xmath108 $ ] .      for this system we implemented 2-dimensional bins : 15 along @xmath109 and 31 along @xmath110 , for a total of 465 bins .",
    "the bins along the @xmath109 coordinate were of unit width on the interval @xmath111 $ ] , and then of width 10 on the interval @xmath112 $ ] , with one additional bin on @xmath113 $ ] .",
    "the bins along the @xmath110 coordinate were of unit width on the interval [ 0,30 ] , with one additional bin on @xmath114 $ ] .",
    "the we data in fig .",
    "[ fig : e - switchmfpt ] was generated using 16 trajectory segments per bin , a time - step @xmath76 , and run for 500 iterations of that time - step , with reweighting events applied every 100 iterations .",
    "[ fig : e - switchmfpt ] shows six independent simulations using these parameters , as well as mle statistics from our brute - force computations .",
    "were all the bins full at all iterations , we would compute , for each of the six runs , 3,720,000 trajectory segments of length 0.1 seconds each , which is equivalent in cost to running 372,000 seconds of brute - force dynamics . in our case ,",
    "most of the bins never get populated ; we computed dynamics for 148,855 , 149,516 , 148,940 , 147,351 , 146,804 , and 149,765 segments in the six different runs . in toto , this is equivalent to 89,123.1 seconds of brute - force dynamics .",
    "even the state - space of this two - species stochastic system is too large to solve exactly , necessitating the use of brute - force simulation as a baseline comparison .",
    "a brute - force computation was performed using the ssa as implemented in bng .",
    "753 simulations of @xmath115 seconds each were run , and using an exponential distribution of mfpts , the mle ( see eq .",
    "[ eq : mld ] ) of the mean and standard error of the mean , @xmath116 and @xmath117 , were found to be @xmath118 seconds and @xmath119 seconds respectively .",
    "the we results are plotted against the brute - force values in fig .",
    "[ fig : e - switchmfpt ] , where we have used the relation @xmath120 ( eq .  [ eqn : mfpt ] ) to plot the steady - state flux that brute - force predicts .",
    "we plot the net flux entering the target state as the simulation progresses , because this is what we measures directly ; we can infer the mfpt using the above relation .",
    "taking the mean of each of the six we runs after the simulation is in steady - state ( we discard the first 100 iterations ) , and treating each of these means as an independent data point , we gives a combined estimate for the mfpt of @xmath121 seconds at 1-@xmath86 .",
    "we is able to find an estimate of the mfpt with greater precision than brute - force , using the equivalent of 89,123.1 seconds of brute - force dynamics .",
    "the brute - force estimate uses @xmath122 seconds of dynamics , yielding a speedup by a factor of @xmath123 when using we compared to brute - force .",
    "we is also able to quickly attain an efficient rough estimate of the mfpt .",
    "a brute - force estimate of the mfpt would require , optimistically , computing an amount of dynamics on the order of the mfpt itself ( @xmath1@xmath124 ) .",
    "in the six different simulations , we s estimate of the mfpt is within @xmath94 of the brute - force value after @xmath125 iterations of we simulation , at which point @xmath126 trajectory segments have been propagated , which is equivalent to propagating @xmath127 seconds of brute - force dynamics , the mean of which is approximately 775 .",
    "thus we find a mean @xmath128 .",
    "confidence interval for the brute - force data , which is from 753 trajectories of @xmath115 seconds each .",
    "the inverse of the flux gives the mean first passage time by eq .",
    ".,width=321 ]        to demonstrate the flexibility of the we approach , we applied it to a signaling model that is , to our knowledge , considerably more complex than any other biochemical system to which rare event sampling techniques have been applied .",
    "the reaction network in this model ( see supplementary material [ url will be inserted by aip ] fceri_ji.bngl ) contains 354 chemical species and 3680 chemical reactions  @xcite .",
    "this model describes association , dissociation , and phosphorylation reactions among four components : the receptor fcri , a bivalent ligand that aggregates receptors into dimers , and the protein tyrosine kinases lyn and syk .",
    "the model also includes dephosphorylation reactions mediated by a pool of protein tyrosine phosphatases .",
    "these reactions generate a network of 354 distinct molecular species .",
    "the model predicts levels of association and phosphorylation of molecular complexes as they vary with time , ligand concentration , concentrations of signaling components , and genetic modifications of the interacting proteins .",
    "the we data in fig .",
    "[ fig : reksykpspdf ] was generated using 60 bins of unit width , 100 trajectory segments per bin , a time - step @xmath129 , and run for 100 iterations of that time - step , with no reweighting events .",
    "the brute - force data is from 1484 brute - force runs of 60 seconds each , which is equivalent to the dynamics time employed in attaining the we data .",
    "no attempt was made to optimize sampling times or bin widths in we .",
    "[ fig : reksykpspdf ] shows the probability distribution of activated receptors in the fcri - mediated signaling model at time @xmath130 .",
    "the brute - force ssa approach is unable to sample out to likelihoods much below @xmath1@xmath131 , while we gets clean statistics for likelihood values down to @xmath1@xmath132 , for an estimated improvement in efficiency @xmath133 .",
    "we applied the weighted ensemble ( we )  @xcite approach to systems - biology models of stochastic chemical kinetics equations , implemented in bionetgen  @xcite .",
    "increases in computational efficiency on the order of @xmath3 were attained for a simple system of biological relevance ( the enzymatic futile cycle ) , and on the order of @xmath2 for a large systems - biology model ( fcri ) , with 354 species and 3680 reactions .",
    "we is easy to understand and implement , statistically exact  @xcite , and easy to parallelize .",
    "it can yield long - timescale information such as mean first passage times ( mfpts ) from simulations of much shorter length .",
    "as in prior molecular simulations  @xcite , we has been demonstrated to increase computational efficiency by orders of magnitude for models of non - trivial complexity , and offers perfect ( linear ) parallel scaling .",
    "it appears that we holds significant promise as a tool for the investigation of complex stochastic systems .    nevertheless , a number of additional points , including limitations of we and related procedures , merit further discussion .",
    "beyond the efficiency observed for the systems studied here , the we approach has other significant strengths .",
    "weighted ensemble is easy to implement : it examines trajectories at fixed time - intervals , and its implementation as scripting - level code makes it amenable to using any stochastic dynamics engine to propagate trajectories .",
    "we also parallelizes well , and can take advantage of multiple cores on a single machine , or across many machines on a cluster ; zwier et al .",
    "have successfully performed a we computation on more than 1,000 cores on the ranger supercomputer  @xcite . additionally , we trajectories are unbiased and follow the natural dynamics of the system .",
    "we also yields full probability distributions , and can find mean first passage times ( mfpts ) and equilibrium properties of systems .",
    "we is most similar in spirit to recent versions of forward flux sampling ( ffs )  @xcite and non - equilibrium umbrella sampling ( neus )  @xcite .",
    "all of these methods divide up state - space into different regions , and are able to merge and split trajectories so as to enhance the sampling of rare regions of state - space .",
    "the approaches described differ slightly in the way the splitting and merging of trajectories is performed .",
    "we also differs from ffs in that we does not have to catch trajectories in the act of crossing a bin boundary ; instead we checks , at a prescribed time step , in which bin a trajectory resides .",
    "this can be advantageous in that no low - level interaction with the dynamics engine / software is required in we .    the central hurdle to improving efficiency using accelerating sampling techniques such as",
    "we , ffs , and neus , is to adequately divide that state - space by selecting reaction coordinates that are both important to the dynamics of interest , and that are slowly sampled by brute - force approaches .",
    "optimally and automatically dividing and binning the state - space is , to our knowledge , an open problem , and one that , for complex systems , where a target state is unknown , is not always a straightforward one to solve , though adaptive strategies have been suggested  @xcite .",
    "the wssa approach  @xcite differs from the above approaches .",
    "it does not use a state - space approach , but rather uses importance sampling to bias and then unbias the dynamics .",
    "we seems to have comparable performance to wssa for systems to which both can be applied . since wssa biases / unbiases reaction rates ,",
    "while we divides state - space , the advantage of one over the other may be situation - dependent .",
    "the ease of implementation of the we framework would appear to scale better with model complexity than current versions of wssa , though for very small models wssa may outperform we in measuring select observables .",
    "a limitation common to accelerated sampling techniques used to estimate non - equilibrium observables is the system - intrinsic timescale : `` @xmath134 '' , or the `` event duration '' time  @xcite .",
    "this timescale represents the time it takes for realistic trajectories to `` walk '' from one state to another , excluding the waiting time prior to the event .",
    "the event duration is often only a fraction of the mfpt , since it is the _ likelihood _ of walking this path that is low ; the time to actually walk the path is often quite moderate .",
    "that is , the waiting time in an initially metastable state can greatly exceed @xmath134 .",
    "we excels at overcoming the low likelihood of a transition , but no accelerated sampling technique can overcome @xmath134 .    finally , it should be noted that all state - space methods that branch trajectories , including we , produce correlated trajectories , due to the splitting / merging events . while such correlations do not appear to have impeded the application of we to the systems investigated here , future work will aim to quantify their effects and reduce their potential impact . the present work accounted for correlations by analyzing multiple fully independent we runs .      beyond potential applications to more complex stochastic chemical kinetics models , the weighted ensemble formalism could be applied to spatially heterogeneous systems .",
    "we should be able to accelerate the sampling of models such as those generated by mcell @xcite or smoldyn @xcite , perhaps using three - dimensional spatial bins",
    ".    it may be possible to integrate we with other methods .",
    "we note that the state - space dividing approaches of a number of methods ( forward flux  @xcite , non - equilibrium umbrella sampling  @xcite , and weighted ensemble  @xcite ) , since they are dynamics - agnostic , could be combined with other methods that accelerate the dynamics engine itself , such as the @xmath7-leaping modification of gillespie s ssa and its many variants and improvements  @xcite , to yield multiplicative increases in runtime speedup .",
    "more speculatively , we could be combined with parallel tempering methods  @xcite .",
    "we accelerates the exploration of the free - energy landscape at a given temperature , and since it does not bias dynamics , the trajectories it propagates could be suitable for replica exchange schemes .    for complex models where exploring the state - space via brute - force is prohibitively expensive , we could also be employed to search for bistability , or in a model - checking capacity @xcite to search for pathological states .",
    "we gratefully acknowledge funding from nsf grant mcb-1119091 , nih grant p41 gm103712 , nih grant t32 eb009403 , and nsf expeditions in computing grant ( award 0926181 ) .",
    "we thank steve lettieri , ernesto suarez , and justin hogg for helpful discussions .",
    "82ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1056/nejmra072067 [ * * ,   ( ) ] http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=19596&tool=pmcentrez&rendertype=abstract [ * * ,   ( ) ] http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1460268&tool=pmcentrez&rendertype=abstract [ * * ,   ( ) ] link:\\doibase 10.1038/nature01546 [ * * ,   ( ) ] link:\\doibase 10.1126/science.1098641 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cell.2005.06.006 [ * * , ( ) ] link:\\doibase 10.1038/ng.110 [ * * , ( ) ] link:\\doibase 10.1038/nature04599 [ * * ,   ( ) ] link:\\doibase 10.1126/science.1070919 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cell.2008.09.050 [ * * , ( ) ] link:\\doibase 10.1146/annurev.biophys.36.040306.132705 [ * * ,   ( ) ] link:\\doibase 10.1016/j.gde.2007.02.007 [ * * ,   ( ) ] link:\\doibase 10.1016/j.copbio.2008.06.011 [ * * ,   ( ) ] link:\\doibase 10.1146/annurev.biophys.37.032807.125928 [ * * ,   ( ) ] link:\\doibase 10.1146/annurev.physchem.58.032806.104637 [ * * ,   ( ) ] http://books.google.com/books?hl=en&lr=&id=g3bahtbrw68c&pgis=1[__ ] ,  vol .",
    "( ,  )  p.",
    "link:\\doibase 10.1093/bioinformatics / bth378 [ * * ,   ( ) ] link:\\doibase 10.1016/0021 - 9991(76)90041 - 3 [ * * ,   ( ) ] link:\\doibase 10.1021/j100540a008 [ * * ,   ( ) ]",
    "link:\\doibase 10.1103/physrevlett.94.018104 [ * * , ( ) ] link:\\doibase    10.1016/j.compbiolchem.2008.03.007 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3078490 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cpc.2011.07.013 [ * * ,   ( ) ] link:\\doibase 10.1093/bioinformatics / bti308 [ * * ,   ( ) ] link:\\doibase 10.1016/j.jcp.2009.05.004 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1613254 [ * * ,   ( ) ] link:\\doibase 10.1016/j.cpc.2012.02.018 [ * * ,   ( ) ] link:\\doibase 10.1021/jp993732q [ * * ,   ( ) ] link:\\doibase 10.1063/1.2987701 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3116791 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3493460 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3522769 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3668100 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2140273 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2198827 [ * * ,   ( ) ] link:\\doibase 10.1088/0953 - 8984/21/46/463102 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3070677 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2784118 [ * * ,   ( ) ] link:\\doibase 10.1063/1.480278 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1738640 [ * * ,   ( ) ] link:\\doibase 10.1063/1.475562 [ * * , ( ) ] link:\\doibase 10.1063/1.1562614 [ * * ,   ( ) ] link:\\doibase 10.1016/s0006 - 3495(96)79552 - 8 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.0706349104 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3306345 [ * * ,   ( ) ] link:\\doibase 10.1063/1.3456985 [ * * ,   ( ) ] link:\\doibase 10.1021/ct100626x [ * * ,   ( ) ] link:\\doibase 10.1063/1.4773892 [ * * ,   ( ) ] http://arxiv.org/abs/1210.3094 [ `` , ''  ] ( ) ,   http://chong.chem.pitt.edu/westpa/home.html [ `` , ''  ] ( ) link:\\doibase 10.1016/j.coph.2010.09.008 [ * * ,   ( ) ] link:\\doibase 10.1007/978 - 1 - 59745 - 525 - 1_5 [ * * ,   ( ) ] link:\\doibase 10.1016/j.bpj.2009.01.019 [ * * ,   ( ) ] link:\\doibase 10.1038/msb.2010.90 [ * * ,   ( ) ] link:\\doibase    10.1186/1471 - 2105 - 11-s7-s10 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.1004042108 [ * * ,   ( ) ] link:\\doibase 10.4049/jimmunol.1102003 [ * * ,   ( ) ] http://books.google.com/books?id=aqvsaaaacaaj&pgis=1[__ ]  ( ,  )  p.",
    "link:\\doibase 10.1073/pnas.0406841102 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2929841 [ * * ,   ( ) ] link:\\doibase 10.1038/nrm1838 [ * * ,   ( ) ] link:\\doibase 10.1007/s00285 - 007 - 0145-z [ * * ,   ( ) ] link:\\doibase 10.1098/rsif.2008.0476 [ * * ,   ( ) ] http://books.google.com/books?hl=en&lr=&id=blinsgpxhtec&pgis=1[__ ]  ( , )  p.   link:\\doibase    10.1103/physreve.71.011902 [ * * ,   ( ) ] http://www.jimmunol.org/content/170/7/3769.full [ * * , ( ) ] link:\\doibase 10.1063/1.4748278 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2434966 [ * * ,   ( ) ] in  http://www.citeulike.org/user/wvangeit/article/1721805[__ ] ,  ( ,  ,  ) chap .  , pp .",
    "link:\\doibase    10.1137/070692017 [ * * ,   ( ) ] http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=39132&tool=pmcentrez&rendertype=abstract [ * * ,   ( ) ] link:\\doibase 10.1007/978 - 1 - 61779 - 361 - 5_26 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2354085 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1810475 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2159468 [ * * ,   ( ) ] link:\\doibase 10.1063/1.1378322 [ * * ,   ( ) ] link:\\doibase 10.1016/s0009 - 2614(97)01198 - 6 [ * * ,   ( ) ] link:\\doibase 10.1016/s0009 - 2614(99)01123 - 9 [ * * ,   ( ) ] link:\\doibase 10.1039/b509983h [ * * ,   ( ) ] http://books.google.com/books?hl=en&lr=&id=nmc4wealxfec&pgis=1[__ ]  ( , )  p.",
    "link:\\doibase    10.1007/978 - 3 - 540 - 88562 - 7 [ ,  * * ,   ( ) ] link:\\doibase    10.1007/978 - 3 - 642 - 03845 - 7 [ ,  * * ,   ( ) ]"
  ],
  "abstract_text": [
    "<S> we apply the `` weighted ensemble '' ( we ) simulation strategy , previously employed in the context of molecular dynamics simulations , to a series of systems - biology models that range in complexity from one - dimensional to a system with 354 species and 3680 reactions . </S>",
    "<S> we is relatively easy to implement , does not require extensive hand - tuning of parameters , does not depend on the details of the simulation algorithm , and can facilitate the simulation of extremely rare events .    for the coupled stochastic reaction systems we study , </S>",
    "<S> we is able to produce accurate and efficient approximations of the joint probability distribution for all chemical species for all time @xmath0 . </S>",
    "<S> we is also able to efficiently extract mean first passage times for the systems , via the construction of a steady - state condition with feedback . in all cases studied here , </S>",
    "<S> we results agree with independent calculations , but significantly enhance the precision with which rare or slow processes can be characterized . </S>",
    "<S> speedups over `` brute - force '' in sampling rare events via the gillespie direct stochastic simulation algorithm range from @xmath1@xmath2 to @xmath1@xmath3 for rare states in a distribution , and @xmath1@xmath4 to @xmath1@xmath5 for finding mean first passage times . </S>"
  ]
}