{
  "article_text": [
    "classifying images into a small number of categories is a common task in scientific and industrial fields . in particle physics ,",
    "this task usually involves interpreting particle detector data to determine the type of particles , interactions , or decays present .",
    "given the sheer volume of information that can be collected , the data is often first reduced to a set of derived quantities by running algorithms that pull out key features :  clusters , tracks , showers , jets , etc . while this form of lossy compression is acceptable in some applications , it is worth exploring whether a classification scheme that uses all of the available information is feasible , even in cases where the data volume is high .    in this article",
    "we describe such a classification scheme developed to categorize neutrino scattering events recorded in the no@xmath0a detectors . in the library event matching ( lem ) algorithm , a trial event of unknown type is compared to a large number of known `` library '' events to find those events that are most similar to the trial event .",
    "the properties of those best - matched library events reveal the likely nature of the trial event .",
    "a distinguishing feature of lem is that the comparisons are made using the energy depositions directly , to avoid any information loss from calculating higher - level variables .",
    "this fundamental philosophy of lem was developed within the minos collaboration for its own neutrino event categorization needs  @xcite .",
    "the lem version described in this article has substantial differences from its predecessor , many of which are motivated by the higher spatial resolution of the no@xmath0a detectors .    while we use no@xmath0a as our case study",
    ", the approach discussed is generalizable and could be usefully applied to any highly segmented detector , from hadron calorimeters determining jet multiplicity to cubic kilometer arrays collecting neutrinos from astrophysical sources . as with many machine learning algorithms",
    ", lem requires a large number of known examples from each classification category . in particle physics applications",
    ", these would typically come either from an advanced monte carlo simulation or from calibration sources .",
    "+   +   +",
    "the no@xmath0a ( numi off - axis @xmath2 appearance ) experiment studies the phenomenon of neutrino flavor oscillation  @xcite .",
    "neutrinos produced by the numi beamline at fermilab  @xcite are observed by a near detector on the fermilab site and by a far detector of identical construction located 810  km downstream in ash river , minnesota . for the purposes of this article ,",
    "the neutrino oscillation mode of interest is @xmath1 , and the goal of the classification algorithm is to obtain a sample of electron neutrino interactions in the far detector with the highest possible efficiency and purity .",
    "the no@xmath0a detectors are constructed from long pvc cells filled with scintillator - doped mineral oil .",
    "each of the far detector s 344,064 cells is 16  m long with rectangular cross section 4  cm  @xmath3  6  cm .",
    "a loop of wavelength - shifting fiber runs the length of each cell , with both ends of the fiber terminating at one pixel of a 32-pixel apd array .",
    "the body of the 14-kiloton detector consists of 896 layers , or `` planes '' , each with 384 cells .",
    "each plane is 16  m  @xmath3  16  m square , and the depth of the detector along the beam direction is 60  m. alternate planes are aligned vertically and horizontally so that three - dimensional information can be obtained through combination of the two `` views '' .",
    "the detector has unprecedented granularity for its size , with one radiation length ( 38  cm ) extending over many cells , to give a detailed view of neutrino - induced electromagnetic showers .",
    "figure  [ fig : det ] shows a cut - away diagram of the detector s construction .",
    "the signal for the @xmath1 oscillation analysis in no@xmath0a is @xmath2 charged - current ( cc ) scattering , which yields a high - energy electron in the final state that allows one to tag the incident neutrino s flavor . in the 1 to 3  gev energy range of no@xmath0a",
    ", this electron will be accompanied , with similar probabilities , by a proton ( quasi - elastic scattering ) , a nucleon plus a pion ( resonant scattering ) , or a richer hadronic shower ( deep inelastic scattering ) .",
    "while nuclear effects blur these crisp definitions , these three scattering types are useful for conveying the variety of shapes that signal events in no@xmath0a can take .",
    "the @xmath4 electron in the final state produces an electromagnetic shower in the detector that has a width of a few cells and runs longitudinally an average distance of 2.5  m ( 40 planes ) .",
    "figure  [ fig : evds]a shows a simulated @xmath2 cc interaction in the no@xmath0a far detector .",
    "the primary mis - identification background comes from neutral - current ( nc ) interactions , particularly those where the recoil hadronic system contains a @xmath5 .",
    "the @xmath5 decays quickly to two photons , each of which induces an electromagnetic shower that is essentially indistinguishable from an electron - induced shower .",
    "nc @xmath5 events , taken as a whole , look sufficiently different from signal @xmath2 cc events that we can reject them well , but the differences are sometimes obscured :    * the presence of two electromagnetic showers , rather than one , can reveal a @xmath5 in the final state .",
    "however , if one of the showers has low energy or overlaps the other in the detector , it can be missed . *",
    "photon - induced showers are separated from the neutrino interaction point due to the distance traveled by the photon prior to its conversion .",
    "this gap is a tell - tale sign of a photon , but in some cases the gap will be too small to resolve .",
    "the conversion length in no@xmath0a is 50  cm .",
    "* photon - induced showers begin with two particles ( an electron / positron pair ) rather than one , but these cases can end up indistinguishable given the energy resolution of the detector . * the energy lost to the outgoing neutrino in nc scattering leads to reconstructed energies lower than those of signal events .",
    "interactions from a sufficiently high - energy neutrino or with a large energy transfer can fall in the signal region of 1 to 3  gev reconstructed energy .    figure  [ fig : evds]b shows a simulated nc event with a @xmath5 .",
    "additional background comes from @xmath6 cc scattering , which produces a muon in the final state .",
    "the muon leaves a long track of activity in the detector with a characteristic energy deposition per unit pathlength .",
    "these are readily removed from the sample due to the clear muon track except in cases where the muon is low in energy or is lost amongst other activity . in these cases ,",
    "the background is similar to nc interactions , with neutral pions playing the same role .",
    "figure  [ fig : evds]c shows a @xmath6 cc example .",
    "the numi beam also includes a 2% contamination of @xmath2 .",
    "these @xmath2 interact identically to the @xmath2 from oscillations and thus constitute a background to the @xmath1 oscillation measurement . however , their rate is low and their energies are somewhat higher .",
    "figure  [ fig : espec ] illustrates the energy differences among all the event classes before any selection cuts have been applied .    since the @xmath2 cc signal falls within a known energy range",
    ", we can safely remove lower and higher energy events up front .",
    "for all figures and tables that follow , we require events to have reconstructed visible energies between 0.5  gev and 4  gev .",
    "signal to be identified by lem is shown in red .",
    "the neutral current , @xmath6 charged current , and intrinsic beam @xmath2 charged current components are blue , black , and magenta respectively .",
    ", title=\"fig : \" ]   signal to be identified by lem is shown in red . the neutral current , @xmath6 charged current , and intrinsic beam @xmath2 charged current components are blue , black , and magenta respectively .",
    ", title=\"fig : \" ]",
    "at the heart of the lem algorithm is the comparison of each unknown trial event to a large number of known library events , with the comparisons based on low - level information collected by the detector . for no@xmath0a",
    ", this means using the calibrated energy depositions in all the detector cells directly rather than forming higher - level objects such as showers and tracks from those .",
    "once the very best matches are found ( here , the best 0.0001% of all library events ) , their known properties are used to estimate the properties of the trial event . in the simplest version of lem ,",
    "the fraction of the best matches that are signal events can be used as the discriminant .",
    "[ sec : knnsvm ] discusses the relationship between lem and other machine learning techniques .      when comparing two events , a metric is needed to quantify how similar they are .",
    "it is instructive to look at the minos case briefly , as the situation there is somewhat simpler  @xcite .",
    "the minos detector has a segmented structure analogous to that of the no@xmath0a detector , but the effective spatial resolution for events of interest is significantly lower . a @xmath2 cc signal event in minos involves only a couple dozen active `` strips '' ( the analogue of no@xmath0a s cells ) , and these active strips are clustered in a relatively compact pattern .",
    "thus , two events with the same underlying particle kinematics have a good chance of having identical ( or near - identical ) arrangements of active strips .",
    "the readout electronics report the number of photoelectrons detected in each active strip . since this charge measurement suffers from shot noise ( typical charge :  @xmath78  photoelectrons ) , strips with identical energy depositions may report different charges .",
    "the level of difference is governed by poisson statistics .",
    "these details guided the form of matching metric used by minos , which can be thought of as the likelihood @xmath8 that the two events recorded charges represent the same underlying energy depositions : @xmath9\\ , \\ ] ] where @xmath10 is number of photoelectrons registered by the @xmath11 strip of event a , @xmath12 is the same for event b , @xmath13 is the poisson probability of observing @xmath14 given mean @xmath15 , and the sum runs over all strips active in at least one of the events .",
    "a higher @xmath16 for a pair of events means a better match . before @xmath8",
    "is calculated , the events , which in general occur in different parts of the detector , are spatially aligned by shifting them so that their charge - weighted mean strip positions , rounded to the nearest strip , overlap .    in the minos metric @xmath8 ,",
    "displaced energy depositions in the two events do not get their charges directly compared . to obtain good matches for a trial event , the library must be large enough to span minor variations in active strip positions for nominally equivalent events .",
    "this is possible in minos given the limited spatial resolution of the detectors for @xmath2 cc events .",
    "that is , the library can be expected to give reasonable coverage of all possibilities . requiring exact _",
    "agreement across the @xmath720 active strips , though , would be combinatorically overwhelming .",
    "the poisson factors take care of this , with acceptably different charges able to contribute appropriately to the match score .",
    "the no@xmath0a detectors are significantly more finely - grained than those of minos .",
    "this makes event discrimination easier in principle since more details are visible , but it makes the above matching metric impractical .",
    "it is much less likely that `` equivalent '' activity in the trial and library events will fall on the same cells .",
    "what is needed is a matching metric that rewards activity in nearby cells without requiring them to lie directly on top of one another .",
    "a library event identical to the trial event should still be a perfect match , but events with similar charges offset by a cell or so should still score well .",
    "the metric we use draws its motivation from electrostatics .",
    "two coulomb charge distributions of similar shape , but with opposite signs , will have a low electrostatic potential energy when overlaid and examined together , as the attraction between the opposite signed charges counters the internal repulsion of the like - signed charges . two overlaid charge distributions with dissimilar shape suffer the internal repulsion but lack the benefit of mutual attraction , leading to a large potential energy . given the electrostatic analogue to what follows , we use `` energy '' to refer to the lem match score for the remainder of the article unless otherwise stated .",
    "lower energies correspond to better matches .",
    "the match energy is defined as @xmath17 where @xmath18 is the self - energy ( repulsion ) of event a s charges , @xmath19 is the self - energy of event b s charges , and @xmath20 is the ( negative ) energy due to the the a / b attraction .",
    "the charges are taken to be the recorded energy depositions in the no@xmath0a cells . treating the electrostatic analogue as exact for a moment ,",
    "the self - energy terms are given by @xmath21 with @xmath10 ( @xmath12 ) the recorded deposition in the @xmath11 cell of event a ( event b ) and with @xmath22 the distance between cells @xmath23 and @xmath24 .",
    "the @xmath25 case is handled again with an electrostatic analogue by distributing all charges uniformly across their individual cells .",
    "( see [ sec : zeror ] . )",
    "the interaction term is given by @xmath26 before evaluating this sum , the events are globally aligned with one another according to a separately reconstructed interaction vertex .    a perfect match , in which events a and b have identical depositions in identical cell positions , would yield @xmath27 . a poorly matched pair with charges far away from one another will have large energy @xmath28 .",
    "( [ eqn : interaction ] ) can be recast in terms of one set of charges embedded in the field of the other : @xmath29 the advantage of this formulation is that @xmath30 can be precalculated for each trial event , along with the self - energies of the trial and library events .",
    "when matching against a large number of library events using ( [ eqn : potential_voltage ] ) , the complexity is linear in the number of charges rather than requiring a double sum over both trial and library charges .",
    "while the no@xmath0a matching metric is inspired by electrostatics , there is no reason to expect that the precise form above will yield the best sensitivity .",
    "we incorporate the following generalizations .    *",
    "above , @xmath22 is calculated as the euclidean distance in terms of the number of planes @xmath31 and number of cells @xmath32 .",
    "however , no@xmath0a events are boosted forward and cover many planes longitudinally but relatively few cells transversely , so we assign different relative importance to separations in the two directions . * the @xmath33 falloff with distance is generalized to @xmath34 .",
    "* the importance of larger charges relative to smaller ones is adjusted by raising all charges to a power @xmath35 .",
    "the resulting form of the matching metric still follows eq .",
    "( [ eqn : potential ] ) , but the self - energy and interaction terms are now given by @xmath36 with the transfer matrix @xmath37 and field @xmath38 given by @xmath39 the electrostatics version is recovered by setting @xmath40 we ran toy experiments with different values of these parameters and calculated a figure - of - merit for each to optimize performance .",
    "the parameters chosen were : @xmath41 the first two parameters validate the intuition that transverse differences should be considered more significant than longitudinal ones .",
    "the third parameter specifies a @xmath42 r$ ] falloff with distance , slower than the electrostatic analogue . for @xmath35 , note that the simple presence or absence of activity in a cell conveys information regardless of its charge .",
    "having @xmath43 moves the metric towards this binary `` on / off '' interpretation and away from a charge - proportional weighting .",
    "the library consists of 77 m simulated neutrino events , of which 18 m are signal @xmath2 cc events , 29 m are background @xmath6 cc and nc events , and 30 m are @xmath5-enriched nc background events . each trial event that lem classifies is compared to these 77 m events to find the 1,000 library events that are most similar to it , as quantified by the metric above .",
    "when we discuss speed optimizations . ] figure  [ fig : matchexample ] shows an example trial event along with its event potential @xmath44 and its best - matched library event .",
    "the library events are generated ahead of time using the full no@xmath0a monte carlo simulation chain including realistic neutrino flux , cross sections , and detector components .",
    "the flux is calculated using a fluka / flugg implementation of the beamline elements  @xcite , the neutrino interactions are simulated by genie  @xcite , and particle propagation through the detector geometry is handled by geant4  @xcite .",
    "simulated energy depositions in the liquid scintillator are converted into expected signals by no@xmath0a electronics and data acquisition simulation code .",
    "the registered signals are corrected for light attenuation in the cells fibers using standard no@xmath0a calibration procedures .",
    "nc events containing neutral pions are the dominant mis - identification background owing to the electromagnetic showers from @xmath45 .",
    "thus , we supplement the base background library sample with a @xmath5-enriched library sample . to build this enriched sample ,",
    "we apply a cut that selects out only those neutral current events with a @xmath5 present in the final state as reported by genie .",
    "the library events are generated according to the expected @xmath6 flux ( for background ) or a 100% @xmath1 transmutation ( for signal ) , without regard to any actual probabilities for neutrino flavor change .",
    "oscillations are introduced into the library later by event weighting .",
    "this is discussed in sec .",
    "[ sec : mva ] below .",
    "[ sec : oscweights ] describes the oscillation probabilities used .",
    "while increasing the library size beyond the 77 m events would provide incremental improvement in classification performance , we observe that these gains enter logarithmically with the number of library events once the library is sufficiently large . in an earlier version of the algorithm , we found that doubling the library size provided only 1% gain in physics sensitivity . in light of the computational requirements discussed in section  [ sec : comp ] , additional library events are not worthwhile for our application .      to good approximation , flipping an event transversely in one or both views produces an equally valid event .",
    "we use such flipping to effectively quadruple the size of the library when the matching is performed .",
    "each library event is used in each of the four possible configurations , and the best of the four is retained .",
    "this symmetry is not quite perfect in the no@xmath0a detectors .",
    "attenuation in the readout fibers leads to subtly different charge resolutions and threshold effects on transversely opposing sides of an event , and numi neutrinos at the far detector enter at a @xmath46 upwards angle .",
    "nevertheless , the best - scoring matches come from the four possible flipped configurations with nearly equal probability : 26% from unflipped events , 50% from events with either one of the two views flipped , and 24% from events with both views flipped .",
    "as library size increases , the fraction of an event s best matches that are truly signal tends toward the probability that the trial event itself is signal .",
    "further , all of the information available in the trial event is used when determining this probability .",
    "it is in this sense that lem is optimal .    for a library of finite and practical size , though , this signal fraction alone does not contain the full information extractable .",
    "other statistics constructed from the details of the best matches may , for example , indicate that the matches are drawn from an area of sparse library coverage and are thus less reliable . the most powerful approach given",
    "a finite library is to construct several statistics describing the matches and to feed these into one of the standard multivariate analysis techniques to extract the final classifier . in lem",
    ", five variables are constructed from the 1,000 best library matches and are used as inputs to a decision tree , along with the calorimetric energy of the trial event as a sixth input .",
    "the basic quantity measuring what fraction of the best matches are signal events can be improved upon by weighting up the truly best matches over the lesser ones when calculating the signal fraction .",
    "we use the weighting @xmath47 where @xmath14 is the match index , @xmath48 is the energy of the @xmath49 best match for the trial event , and @xmath50 is the energy of the final ( 1000@xmath51 ) best match .",
    "the optimized values used for @xmath15 and @xmath52 in no@xmath0a are @xmath53 the typical ratio of weights @xmath54 is @xmath55 , indicating that the most important matches are captured within the first thousand .    in practice , the weight must also include the oscillation probabilities alluded to earlier : @xmath56 where @xmath57 is the oscillation probability of match @xmath14 , as described in [ sec : oscweights ] .",
    "all sums below that are indexed by @xmath14 run over the match list . for notational convenience",
    "we also define @xmath58 .",
    "this weighting scheme is used for all five quantities formed from the best - match list .",
    "the first is the weighted fraction of signal matches , @xmath59 where this sum includes only those terms due to signal matches .",
    "signal events in which the outgoing electron carries only a small fraction of the incident neutrino s energy will look very much like nc background events .",
    "the kinematic quantity @xmath60 ( or rather , @xmath61 ) measures this fraction : @xmath62 , where we ve used @xmath63 and @xmath64 as the outgoing and incoming lepton energies to avoid confusion with the match energies @xmath65 .",
    "if a trial event matches well to signal events with high @xmath60 , this can suggest that the trial event is in fact a high-@xmath60 nc event .",
    "a second input is the mean @xmath60 for the best matches : @xmath66       +        +         matched charge fraction is an independent measure of the quality of the library matches , separate from the match energy .",
    "for each trial / match pair , this is the quantity of charge that has a counterpart on identical cells in the two events divided by the total charge in the two events : @xmath67 the weighted average of the matched charge fraction over all the matches yields the next input : @xmath68      this quantity measures whether the signal or background matches are the better matches on average .",
    "it is the difference of the weighted mean energy of each class of matches : @xmath69      the final match list quantity , similar in construction to @xmath70 , is the weighted fraction of signal matches present among the signal and @xmath5-enriched matches ( _ i.e. _ , excluding the non - enriched background )  , @xmath71      nc backgrounds skew heavily to low visible energy thanks to the energy removed by the exiting neutrino .",
    "the sum of all depositions @xmath72 recorded in the trial event , @xmath73 is included as a final input so that the classifier knows the prior expectations of signal and background .",
    "there are many multivariate techniques capable of combining these six input quantities into a single classifier output .",
    "we investigated artificial neural networks , support vector machines , and decision trees .",
    "an ensemble decision tree yielded the best performance of the approaches tried .",
    "one problem with other techniques is that the figure of merit ( f.o.m . )",
    "that , for example , artificial neural network training aims to minimize is the mean - squared - error of the classifier variable @xmath74 : @xmath75 where the sums run over the signal and background training samples .",
    "however , the figure of merit relevant to an experiment measuring the magnitude of a signal excess @xmath76 over a background @xmath77 with poisson fluctuations is@xmath78 if events are binned according to , say , the classifier output , the generalization is simply to sum in quadrature the significances in the individual bins : @xmath79 while training a decision tree classifier , if the sample is divided at each step into subsamples 1 and 2 so as to maximize @xmath80 then the performance of the full classifier is trivially optimized with respect to the figure of merit in eq .",
    "( [ eqn : binned_fom ] ) .",
    "the final classifier output is a voting ensemble of 1,000 decision trees each trained on a randomly chosen half of the full training sample .",
    "the ensemble technique protects against over - training , a feature that we confirmed by evaluating the classifier performance on independent control samples .",
    "figure  [ fig : vars ] shows the distribution of the six input variables for all event classes in the no@xmath0a @xmath1 analysis .",
    "figure  [ fig : spectrum ] shows the final lem classifier output .",
    "figure  [ fig : eff_pur ] shows the signal efficiency and purity obtained with various cuts on the lem output .",
    "all curves come from monte carlo simulation of the expected no@xmath0a data set .",
    "we choose the cut on the lem output variable that maximizes the figure - of - merit in eq .",
    "( [ eqn : fom ] ) . when applying lem in a full experimental setting , one can fit the output distribution to gain additional discrimination power .",
    "cc signal events ( red ) compared to the background components :  neutral current ( blue ) , @xmath6 cc ( black ) and intrinsic beam @xmath2 cc ( magenta ) . in order to make the details in the signal - like region visible , the @xmath60-axis truncates much of the background peak .",
    "95% of neutral current events and 98% of @xmath6 charged current events have @xmath81 .",
    "the distributions are scaled to a nominal 3-year numi exposure  @xcite of @xmath82  protons - on - target.,title=\"fig : \" ]   cc signal events ( red ) compared to the background components :  neutral current ( blue ) , @xmath6 cc ( black ) and intrinsic beam @xmath2 cc ( magenta ) . in order to make the details in the signal - like region visible , the @xmath60-axis truncates much of the background peak .",
    "95% of neutral current events and 98% of @xmath6 charged current events have @xmath81 .",
    "the distributions are scaled to a nominal 3-year numi exposure  @xcite of @xmath82  protons - on - target.,title=\"fig : \" ]     candidate sample selected by lem for different cut positions .",
    "the dashed lines are curves of constant f.o.m .",
    "@xmath83 , and the solid circle indicates the result of the optimum cut . ]    table  [ tbl : counts ] shows the expected number of signal and background events selected by the optimum lem cut .",
    "the signal efficiency is 55% for a background mis - identification rate of 2.0% .",
    "the muon track of @xmath6 cc events keeps their mis - identification rate particulary low .",
    "background beam @xmath2 events are selected with a lower efficiency than signal @xmath2 events .",
    "this is possible due to the different underlying energy spectra of the two classes . as there is no absolute metric",
    "by which to judge the performance of the lem classification algorithm described here , we note simply that the performance shown is excellent for the physics goals of no@xmath0a  @xcite .    [",
    "cols=\"<,^,^,^,^,^,^\",options=\"header \" , ]      +",
    "while each individual energy calculation can be performed very quickly , classifying a single event takes some time given the large size of the library . for the no@xmath0a application",
    ", a single event must be treated in a second or so , which is the time scale required by other steps already performed during no@xmath0a event processing . without specialized hardware to run the inner loop , techniques to manage the lem matching time focus on reducing the number of energies that need to be calculated .",
    "we achieve a significant speed - up by introducing a library `` index '' .",
    "if trial event @xmath84 matches well to library event @xmath85 , @xmath84 will likely match well to other library events that are , themselves , good matches to @xmath85 .",
    "similarly , if @xmath84 and @xmath85 match poorly , then @xmath84 will likely match poorly to library events similar to @xmath85 .",
    "a library index is formed by drawing 10,000 events uniformly from the full library and matching each of these to the full library . for each index event , a list of its 1,000,000 best - matched library events is saved .",
    "this process happens ahead of time , at library creation .",
    "when a trial event is classified , it is compared first to the 10,000 index events to find the single best - matching index event .",
    "the trial event is then compared only to the 1 m sibling events of that index event , reducing the total number of energies calculated per trial event from 77,000,000 to 1,010,000  a significant speed improvement that takes the per trial matching time from 97  s down to 1.7  s on a 2.3  ghz amd opteron processor .",
    "empirically , we find that 85% of the trial event s `` true '' one - thousand top matches are captured with this indexed approach , and we find no noticeable degradation in the physics performance .",
    "the speed optimization above is what allows the use of a 77 m event library .",
    "however , such a large library strains memory resources .",
    "the full library is too large ( @xmath753  gb each for the library and index ) to read from disk for each event , yet it is larger than the typical per - core memory allocation on grid computing nodes .",
    "thus , the library is converted from its original high - level format into the memory representation used by a running job .",
    "this representation includes the self - energy of each event .",
    "the conversion inflates the library slightly to 131  gb , but the advantage is that it can now be shared between running processes .",
    "each parallel matching job uses the mmap ( ) system call to make the contents of this file visible in its address space .",
    "the mapping is marked read - only , so the kernel shares the pages between all the running processes .",
    "for example , on a 64-core server , the memory requirement to run 64 matching jobs is still only 131  gb , equivalent to an unshared 2  gb per core . in case of memory pressure , the kernel will discard pages , knowing that they can be retrieved from disk ( that is , the library file essentially acts as swap space ) although this will significantly impact performance .",
    "in addition to signal - or - background classification , the detailed truth information available in the list of best matches allows other information about the trial event to be inferred .",
    "one could extract probabilities for different interaction modes , the inelasticity , and so on , without requiring any independent reconstruction .",
    "an application that has been pursued is the estimation of the incident neutrino energy for @xmath2 cc events . simply by averaging the true neutrino energies of the best signal library matches and calibrating the resulting estimator",
    ", we achieve an energy resolution of 8.8% on signal events selected by the oscillation analysis , competitive with other energy estimators in no@xmath0a .",
    "the library event matching algorithm compares input trial events to a large library of known events using all the information available , making lem an optimal classifier given a sufficiently large library .",
    "the no@xmath0a implementation of lem has demonstrated excellent performance in separating @xmath2 signal from the key backgrounds , and a few simple optimizations have maintained practical computational requirements despite the large number of library events used . within the no@xmath0a context , the lem technique has potential applications from reconstruction of the hadronic system to the event energy measure described above .",
    "more broadly , lem can be applied to completely different particle detectors or imaging systems in an array of fields and industries , wherever one needs to classify fine - grained images of objects whose visual characteristics vary in known ways .",
    "the authors thank the no@xmath0a collaboration for use of its monte carlo simulation software and related tools .",
    "this work was supported by the the us doe under award de - sc0006543 .",
    "a few technical notes are included in this appendix so as not to break up the discussion in the main text .",
    "if @xmath86 and @xmath87 were calculated unweighted , then those variables would be @xmath88-nearest - neighbors classifiers , albeit with very large input vectors . with the weights @xmath89 applied , they act as kernel density estimators .",
    "note that @xmath90 is a metric for the space of possible event images .",
    "that is , distances defined in this way obey the triangle inequality . for a gaussian kernel in this space one would expect @xmath91 , which contrasts with the optimal value of @xmath92 found in practice .",
    "similarly @xmath93 is an estimator for the true value of @xmath60 using the same kernel .",
    "methods exist to efficiently find nearest - neighbors in general metric spaces without having to rely on heuristics such as the library index in section  [ sec : heads ] .",
    "testing of a vantage - point tree  @xcite indicated its performance was affected by the curse of dimensionality .",
    "a large fraction of the nodes would have to be entered during a typical search .      the transfer matrix element @xmath37 as written in eq .",
    "( [ eqn : transfer ] ) diverges when @xmath94 since @xmath95 and @xmath96 are zero .",
    "thus , for nearby cell pairs ( @xmath97 and @xmath98 ) , the energy calculation is performed as if the charge is distributed uniformly over each cell , with @xmath99^{-\\alpha }         dx\\,dy\\,du\\,dv\\ , \\ ] ] where @xmath100 and @xmath101 scan over the areas of cells @xmath23 and @xmath24 and where @xmath22 here is a generalization of the discrete distance used in the main text : @xmath102 for more distant pairs the simplified form of the transfer matrix given in eq .",
    "( [ eqn : transfer ] ) is sufficient .",
    "the retained matches are weighted according to eq .",
    "( [ eqn : fullweight ] ) , which includes the probability for flavor oscillation .",
    "the probabilities used are @xmath103 where @xmath104 is the oscillation baseline , @xmath65 is the neutrino energy in gev , and the oscillation parameters are taken to be @xmath105 these oscillation probabilities are first - order approximations to the full expressions .",
    "this is both for practical reasons ",
    "the second - order effects are poorly determined and are in fact what no@xmath0a aims to measure  and because there is no requirement for the library have any particular distribution of events in it .",
    "the second order effects can pull the probabilities higher or lower , making this weighting a reasonable middle ground for the library .",
    "the library is also made devoid of intrinsic @xmath2 from the numi beam by setting that survival probability to zero .",
    "the overall prefactor on the @xmath106 ( signal ) line relative to the background lines actually does not enter in practice since the signal , background , and @xmath5-enriched background classes are scaled to have equal total weight in the library .",
    "p.  adamson _ et al .",
    "_  ( minos ) , phys .  rev",
    ".  lett .  * 107 * , 181802 ( 2011 ) .",
    "p.  adamson _ et al .",
    "_  ( minos ) , phys .  rev",
    ".  lett .",
    "* 110 * , 171801 ( 2013 ) .",
    "j.  p.  ochoa , ph.d .",
    "thesis , california institute of technology , fermilab - thesis-2009 - 44 ( 2009 ) .",
    "r.  toner , ph.d .",
    "thesis , university of cambridge , fermilab - thesis-2011 - 53 ( 2011 ) .",
    "d.  s.  ayres _",
    "et al . _  ( nova ) , fermilab - design-2007 - 01 ( 2007 ) ; r.  b.  patterson , for nova , nucl .",
    "suppl .  * 235 - 236 * , 151 ( 2013 ) .",
    "k.  anderson _",
    "et al . _ ,  fermilab - design-1998 - 01 ( 1998 ) .",
    "a.  ferrari , p.  r.  sala , a.  fasso , and j.  ranft , cern-2005 - 10 ( 2005 ) ; g.  battistoni _ et al .",
    "_ ,  aip conf .",
    "proc .  * 896 * , 31 ( 2007 ) . c.  andreopoulos , for genie , acta phys .",
    "b * 40 * , 2461 ( 2009 ) .",
    "s.  agostinelli _ et al .",
    "_ ,  nucl .",
    "instrum .",
    "a * 506 * , 250 ( 2003 ) .",
    "j.  uhlmann , inform .  process .",
    "lett .  * 40 * , 4 ( 1991 ) ; p.  n.  yianilos , proceedings of the fourth annual acm - siam symposium on discrete algorithms , 311 ( 1993 ) ."
  ],
  "abstract_text": [
    "<S> we describe the library event matching classification algorithm implemented for use in the no@xmath0a @xmath1 oscillation measurement . </S>",
    "<S> library event matching , developed in a different form by the earlier minos experiment , is a powerful approach in which input trial events are compared to a large library of simulated events to find those that best match the input event . </S>",
    "<S> a key feature of the algorithm is that the comparisons are based on all the information available in the event , as opposed to higher - level derived quantities . </S>",
    "<S> the final event classifier is formed by examining the details of the best - matched library events . </S>",
    "<S> we discuss the concept , definition , optimization , and broader applications of the algorithm as implemented here . </S>",
    "<S> library event matching is well - suited to the monolithic , segmented detectors of no@xmath0a and thus provides a powerful technique for event discrimination .    </S>",
    "<S> library matching , classification algorithm , particle identification , nova </S>"
  ]
}