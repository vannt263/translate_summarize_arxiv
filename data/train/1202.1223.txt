{
  "article_text": [
    "a _ phylogenetic tree _ is a representation of the shared evolutionary history of a set of extant species . from the mathematical point",
    "a view , it is a leaf - labeled rooted tree , with its leaves representing the extant species under study , its internal nodes representing common ancestors of some of them , the root representing the most recent common ancestor of all of them , and the arcs representing direct descendants through mutations .",
    "one of the most thoroughly studied shape properties of phylogenetic trees is their balance , that is , the degree to which the children of internal nodes tend to have the same number of descendant taxa .",
    "this global degree of balance of a tree is usually quantified by means of a single number generically called an _",
    "balance index_. the two most popular balance indices are sackin s @xcite and colless @xcite ( see  2.2 ) , but there are many more ( * ? ? ? * chap .",
    "33 ) , and shao and sokal @xcite explicitly advise to use more than one such index to quantify tree balance .",
    "such balance indices only depend on the topology of the trees , not on the branch lengths or the actual taxa labeling their leaves . since it is believed that the raw topology of a phylogenetic tree already reflects , at least to some extent , the evolutionary processes that have produced it ( * ? ? ?",
    "33 ) , these indices have also been widely used as tools to test stochastic models of evolution @xcite .",
    "two of the most popular stochastic models of evolutionary tree growth are the yule and the uniform models .",
    "the _ yule _ , or _",
    "equal - rate markov _",
    "model @xcite , starts with a single node and , at every step , a leaf is chosen randomly and uniformly , and it is replaced by a _ cherry _ ,",
    "i.e. , a phylogenetic tree consisting only of a root and two leaves .",
    "finally , once the desired number of leaves is reached , the labels are assigned randomly and uniformly to the leaves .",
    "this corresponds to a model of evolution where , at each step , each currently extant species can give rise with the same probability to two new species . under this model different trees with the same number of leaves may have different probabilities .",
    "in contrast , the main feature of the _ uniform _ , or _ proportional to distinguishable arrangements _ model @xcite is that all phylogenetic trees with the same number of leaves have the same probability . from the point of view of tree growth @xcite",
    ", this corresponds to a process where , starting with a node labeled 1 , at the @xmath0-th step a new pendant arc , ending in the leaf labeled @xmath1 , is added either to a new root or to some edge ( being all possible locations of this new pendant arc equiprobable ) . notice that this is not an explicit model of evolution , only of tree growth .",
    "several properties of the distributions of sackin s and colless indices have been studied in the literature under these models @xcite .    in this paper",
    "we propose a new balance index , the _ total cophenetic index_. it is defined as the sum of the cophenetic values @xcite of all pairs of different leaves .",
    "the main features of our index are that , unlike colless index , it makes sense for arbitrary ( i.e. , not necessarily fully resolved ) trees ; as colless and sackin s indices , it can be easily computed in linear time ; its range of values is larger than colless and sackin s ( up to @xmath2 , instead of @xmath3 ) , and it has a greater resolution power than those indices .",
    "we compute the maximum and minimum values of our index , both in the arbitrary and the binary cases , and explicit formulas for its average value under the yule and the uniform models for binary trees .",
    "we actually deduce its average value under the uniform model from an explicit formula for the average value of the sackin index .",
    "this average value was known until now only for its limit distribution @xcite , and our formula seems thus to be new in the literature .",
    "the rest of this paper is organized as follows . in a first section",
    "we introduce the basic notations and facts on phylogenetic trees that will be used henceforth , and we recall some basic facts on the sackin and the colless indices . then , in section 3 , we define our total cophenetic index @xmath4 and we establish its basic properties . in section 4",
    "we compute its maximum and minimum values , and then , in subsequent sections , we compute its expected value under the yule and the uniform models .",
    "we finally devote a last section to conclusions and the discussion of two preliminary numerical experiments involving @xmath4 .",
    "in this paper , by a _ phylogenetic tree _ on a set @xmath5 of taxa we mean a rooted tree with its leaves bijectively labeled in the set @xmath5 . to simplify the language , we shall always identify a leaf of a phylogenetic tree with its label .",
    "we shall use the term _ phylogenetic tree with @xmath6 leaves _ to refer to a phylogenetic tree on the set @xmath7 .",
    "we shall denote by @xmath8 the set of leaves of a phylogenetic tree @xmath9 and by @xmath10 its set of internal nodes .",
    "a phylogenetic tree is _ binary _ , or _ fully resolved _",
    ", when all its internal nodes are _ bifurcating _ , that is , when every internal node has exactly two children .",
    "whenever there exists a path from @xmath11 to @xmath12 in a phylogenetic tree @xmath9 , we shall say that @xmath12 is a _ descendant _ of @xmath11 and also that @xmath11 is an _ ancestor _ of @xmath12 .",
    "the _ cluster _ of a node @xmath12 in @xmath9 is the set @xmath13 of its descendant leaves , an we shall denote by @xmath14 the cardinal @xmath15 , that is , the number of descendant leaves of @xmath12 .    given a node @xmath12 of a phylogenetic tree @xmath9 , the _ subtree of @xmath9 rooted at @xmath12 _ is the subgraph of @xmath9 induced on the set of descendants of @xmath12 .",
    "it is a phylogenetic tree on @xmath13 with root this node @xmath12 .",
    "the _ lowest common ancestor _ ( lca ) of a pair of nodes @xmath16 of a phylogenetic tree @xmath9 , in symbols @xmath17 , is the unique common ancestor of them that is a descendant of every other common ancestor of them .",
    "the _ depth _ @xmath18 of a node @xmath12 in a phylogenetic tree @xmath9 is the length ( in number of arcs ) of the unique path from the root @xmath19 to @xmath12 .",
    "a _ rooted caterpillar _ is a binary phylogenetic tree all whose internal nodes have a leaf child : see fig .",
    "[ fig : exs].(a ) . a _ rooted star _",
    "is a phylogenetic tree such that all its leaves have depth 1 : see fig .",
    "[ fig : exs].(b ) .",
    "( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 4,0 ) node [ tre ] ( 3 ) ; 3 ( 6,0 ) node @xmath20 ; ( 8,0 ) node [ tre ] ( n ) ; n ( 1,2 ) node[tre ] ( a ) ; ( 3,3 ) node[tre ] ( b ) ; ( 7,5 ) node[tre ] ( r ) ; ( 5,4 ) node . ;",
    "( 5.3,4.15 ) node . ;",
    "( 5.6,4.3 ) node . ; ( a)(1 ) ; ( a)(2 ) ; ( b)(3 ) ; ( b)(a ) ; ( b) ( 4.5,3.75 ) ; ( r) ( 6,4.5 ) ; ( r) ( n ) ; ( 4,-2 ) node ( a ) ;    ( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 4,0 ) node [ tre ] ( 3 ) ; 3 ( 6,0 ) node @xmath20 ; ( 8,0 ) node [ tre ] ( n ) ; n ( 4,3 ) node[tre ] ( r ) ; ( r)(1 ) ; ( r)(2 ) ; ( r)(3 ) ; ( r)(n ) ; ( 4,-2 ) node ( b ) ;    let @xmath9 be a binary phylogenetic tree .",
    "for every @xmath21 , say with children @xmath22 , the _ balance value _ of @xmath12 is @xmath23 .",
    "an internal node @xmath12 of @xmath9 is _ balanced _",
    "when @xmath24 .",
    "so , a node @xmath12 with children @xmath25 and @xmath26 is balanced if , and only if , @xmath27 .",
    "we shall say that a binary phylogenetic tree @xmath9 is _ maximally balanced _ when all its internal nodes are balanced .",
    "recurrently , a binary phylogenetic tree is maximally balanced when its root is balanced and both subtrees rooted at the children of the root are maximally balanced .",
    "notice that , for any number @xmath6 of nodes , the topology of a maximally balanced tree with @xmath6 leaves is fixed , and therefore two maximally balanced trees with the same number of leaves differ only in their labeling .",
    "[ fig : bal ] depicts the maximally balanced trees with @xmath28 leaves , up to relabelings .",
    "( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 1,2 ) node[tre ] ( a ) ; ( a)(1 ) ; ( a)(2 ) ;       ( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 4,0 ) node [ tre ] ( 3 ) ; 3 ( 1,2 ) node[tre ] ( a ) ; ( 2,4 ) node[tre ] ( b ) ; ( a)(1 ) ; ( a)(2 ) ; ( b)(a ) ; ( b)(3 ) ;       ( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 4,0 ) node [ tre ] ( 3 ) ; 3 ( 6,0 ) node [ tre ] ( 4 ) ; 4 ( 1,2 ) node[tre ] ( a ) ; ( 5,2 ) node[tre ] ( c ) ; ( 3,4 ) node[tre ] ( b ) ; ( a)(1 ) ; ( a)(2 ) ; ( b)(a ) ; ( b)(c ) ; ( c)(3 ) ; ( c)(4 ) ;       ( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 4,0 ) node [ tre ] ( 3 ) ; 3 ( 6,0 ) node [ tre ] ( 4 ) ; 4 ( 8,0 ) node [ tre ] ( 5 ) ; 5 ( 1,2 ) node[tre ] ( a ) ; ( 7,2 ) node[tre ] ( c ) ; ( 2,4 ) node[tre ] ( b ) ; ( 4,6 ) node[tre ] ( d ) ; ( a)(1 ) ; ( a)(2 ) ; ( b)(a ) ; ( b)(3 ) ; ( c)(5 ) ; ( c)(4 ) ; ( d)(b ) ; ( d)(c ) ;       ( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 2,0 ) node [ tre ] ( 2 ) ; 2 ( 4,0 ) node [ tre ] ( 3 ) ; 3 ( 6,0 ) node [ tre ] ( 4 ) ; 4 ( 8,0 ) node [ tre ] ( 5 ) ; 5 ( 10,0 ) node [ tre ] ( 6 ) ; 6 ( 1,2 ) node[tre ] ( a ) ; ( 9,2 ) node[tre ] ( c ) ; ( 2,4 ) node[tre ] ( b ) ; ( 8,4 ) node[tre ] ( d ) ; ( 5,6 ) node[tre ] ( r ) ; ( a)(1 ) ; ( a)(2 ) ; ( b)(a ) ; ( b)(3 ) ; ( c)(5 ) ; ( c)(6 ) ; ( d)(4 ) ; ( d)(c ) ; ( r)(b ) ; ( r)(d ) ;    let @xmath29 ( resp . ,",
    "@xmath30 ) be the set of isomorphism classes of phylogenetic trees ( resp , binary phylogenetic trees ) with @xmath6 leaves .",
    "it is well known ( * ? ? ?",
    "3 ) that @xmath31 and , for every @xmath32 , @xmath33 no closed formula is known for the cardinal @xmath34 , only recurrences or generating functions ( see again ( * ? ? ?",
    "3 ) and the references therein ) .    an _ ordered @xmath35-forest _ on a set @xmath5 is an ordered sequence of @xmath35 phylogenetic trees @xmath36 , each @xmath37 on a set @xmath38 of taxa , such that these sets @xmath38 are pairwise disjoint and their union is @xmath5 .",
    "an ordered forest is _ binary _ when it consists of binary trees .",
    "let @xmath39 ( resp . , @xmath40 ) be the set of isomorphism classes of ordered @xmath35-forests ( resp . , binary ordered @xmath35-forests ) on a set @xmath5 with @xmath41 .",
    "it is known ( see , for instance , ( * ? ? ?",
    "1 ) ) that for every @xmath42 , @xmath43 again , no closed formula is known for @xmath44 .",
    "several balance indices have been proposed so far in the literature @xcite .",
    "the two most popular ones are the _ sackin index _ @xcite and the _ colless index _ @xcite . the sackin index of a phylogenetic tree @xmath45 is defined as the sum of the depths of its leaves : @xmath46 alternatively @xcite , @xmath47 on the other hand , the colless index of a _ binary _ phylogenetic tree @xmath9 is defined as @xmath48 this colless index has been extended to non - binary trees by defining @xmath49 for every non - bifurcating internal node @xcite .    it is straightforward to notice that these two indices depend only on the topology of the tree , and they are invariant under isomorphisms and relabelings of leaves .",
    "this is desirable in a balance index , because the degree of symmetry of a tree depends only on its shape .",
    "both sackin s and colless s indices reach their maximum value exactly at caterpillars , which are clearly the more imbalanced trees , and they reach their minimum on @xmath30 at the maximally balanced trees @xcite . in both cases , the maximum value is in @xmath3 .",
    "but they may also reach their minimum on @xmath30 at other trees .",
    "for instance , for @xmath50 , both indices take their minimum value at the two trees @xmath51 depicted in fig . [",
    "fig : minind ] .",
    "@xmath52 is maximally balanced , but @xmath9 is not so . actually , it is easy to check that sackin s index is invariant under interchanges of cousins , which may produce trees with different degrees of symmetry but the same sackin index .",
    "( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 10,0 ) node[tre ] ( 6 ) ; 6 ( 1,2 ) node[tre ] ( a ) ; ( 5,2 ) node[tre ] ( b ) ; ( 9,2 ) node[tre ] ( c ) ; ( 3,4 ) node[tre ] ( d ) ; ( 5,6 ) node[tre ] ( r ) ; ( r)(d ) ; ( r)(c ) ; ( d)(a ) ; ( d)(b ) ; ( a)(1 ) ; ( a)(2 ) ; ( b)(3 ) ; ( b)(4 ) ; ( c)(5 ) ; ( c)(6 ) ; ( 5,-1.5 ) node @xmath9 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 10,0 ) node[tre ] ( 6 ) ; 6 ( 1,2 ) node[tre ] ( a ) ; ( 2,4 ) node[tre ] ( b ) ; ( 9,2 ) node[tre ] ( c ) ; ( 8,4 ) node[tre ] ( d ) ; ( 5,6 ) node[tre ] ( r ) ; ( r)(d ) ; ( r)(b ) ; ( b)(a ) ; ( b)(3 ) ; ( a)(1 ) ; ( a)(2 ) ; ( d)(c ) ; ( d)(4 ) ; ( c)(5 ) ; ( c)(6 ) ; ( 5,-1.5 ) node @xmath52 ;    the main drawback with colless index is its difficult meaningful generalization to non - binary trees .",
    "moreover , as fig .",
    "[ fig : minind ] shows , although not every interchange of cousins yields trees with the same colless index , there are still interchanges of cousins that modify the symmetry of the trees but preserve this index .",
    "the expected values of these indices on @xmath30 have been studied under the yule and the uniform models .",
    "recall that , under the yule model , different trees in @xmath30 may have different probabilities : namely , a tree @xmath9 with @xmath6 leaves has probability @xcite @xmath53 under the uniform model , all trees in @xmath30 are equiprobable , and thus they have probability @xmath54    let @xmath55 and @xmath56 be the random variables defined by choosing a tree @xmath57 and computing @xmath58 or @xmath59 , respectively .",
    "the following facts are known about the expected values of these random variables :    * under the yule model , * * @xmath60 @xcite . *",
    "* @xmath61 @xcite .",
    "* under the uniform model , @xmath62 we shall actually prove in this paper ( see theorem [ th : sackin ] ) that @xmath63 1,\\   4 - 2n\\end{array};2\\bigg),\\ ] ] where @xmath64 is a _",
    "hypergeometric function _",
    "for every pair of leaves @xmath65 in a phylogenetic tree @xmath9 , their _ cophenetic value _ @xcite is the depth of their least common ancestor : @xmath66    the _ total cophenetic index _ of a phylogenetic tree @xmath67 is the sum of the cophenetic values of its pairs of different leaves : @xmath68    this index can be seen as an extension of sackin s : instead of adding up the depths of the leaves ( that is , the depths of the lca of every leaf and itself ) , @xmath69 adds up the depths of the lca of every pair of leaves in @xmath9 .",
    "notice also that , as sackin s and colless indices , @xmath69 only depends on the topology of @xmath9 , and in particular it is invariant under permutations of its labels .",
    "[ fig : ex1 ] shows all possible topologies of phylogenetic trees with 5 leaves , and their total cophenetic indices .",
    "although we shall return on it later for trees with an arbitrary number @xmath6 of leaves , notice that the rooted star has the smallest total cophenetic value , 0 ; the binary tree with the smallest total cophenetic value is the maximally balanced ; and the tree with the largest total cophenetic value is the caterpillar .",
    "( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 4,5 ) node[tre ] ( r ) ; ( r)(1 ) ; ( r)(2 ) ; ( r)(3 ) ; ( r)(4 ) ; ( r)(5 ) ; ( 3,-2 ) node @xmath70 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 1,3 ) node[tre ] ( z1 ) ; ( 3,5 ) node[tre ] ( r ) ; ( z1)(1 ) ; ( z1)(2 ) ; ( r)(3 ) ; ( r)(4 ) ; ( r)(z1 ) ; ( r)(5 ) ; ( 3,-2 ) node @xmath71 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 1,2 ) node[tre ] ( z1 ) ; ( 5,2 ) node[tre ] ( z2 ) ; ( 4.5,5 ) node[tre ] ( r ) ; ( z1)(1 ) ; ( z1)(2 ) ; ( z2)(3 ) ; ( z2)(4 ) ; ( r)(z1 ) ; ( r)(z2 ) ; ( r)(5 ) ; ( 3,-2 ) node @xmath72 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 2,2 ) node[tre ] ( z1 ) ; ( 4.5,5 ) node[tre ] ( r ) ; ( z1)(1 ) ; ( z1)(2 ) ; ( z1)(3 ) ; ( r)(4 ) ; ( r)(z1 ) ; ( r)(5 ) ; ( 3,-2 ) node @xmath73 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 1,2 ) node[tre ] ( z1 ) ; ( 2.5,4 ) node[tre ] ( z2 ) ; ( 5,6 ) node[tre ] ( r ) ; ( z1)(1 ) ; ( z1)(2 ) ; ( z2)(3 ) ; ( r)(4 ) ; ( r)(z2 ) ; ( z2)(z1 ) ; ( r)(5 ) ; ( 3,-2 ) node @xmath74 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 2,3 ) node[tre ] ( z1 ) ; ( 4.5,6 ) node[tre ] ( r ) ; ( 7,3 ) node[tre ] ( z2 ) ; ( z1)(1 ) ; ( z1)(2 ) ; ( z1)(3 ) ; ( z2)(4 ) ; ( r)(z1 ) ; ( r)(z2 ) ; ( z2)(5 ) ; ( 3,-2 ) node @xmath74 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 1,2 ) node[tre ] ( z1 ) ; ( 2.5,4 ) node[tre ] ( z2 ) ; ( 5,6 ) node[tre ] ( r ) ; ( 7,3 ) node[tre ] ( z3 ) ; ( z1)(1 ) ; ( z1)(2 ) ; ( z2)(3 ) ; ( z3)(4 ) ; ( r)(z3 ) ; ( z2)(z1 ) ; ( r)(z2 ) ; ( z3)(5 ) ; ( 3,-2 ) node @xmath75 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 4,6 ) node[tre ] ( r ) ; ( 3,3 ) node[tre ] ( z ) ; ( z)(1 ) ; ( z)(2 ) ; ( z)(3 ) ; ( z)(4 ) ; ( r)(z ) ; ( r)(5 ) ;    ( 3,-2 ) node @xmath76 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 1,2 ) node[tre ] ( z ) ; ( 2.5,4 ) node[tre ] ( r ) ; ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 4,6 ) node[tre ] ( r0 ) ; ( z)(1 ) ; ( z)(2 ) ; ( r)(3 ) ; ( r)(4 ) ; ( r)(z ) ; ( r0)(r ) ; ( r0)(5 ) ; ( 3,-2 ) node @xmath77 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 1,2 ) node[tre ] ( z ) ; ( 5,2 ) node[tre ] ( x ) ; ( 2.5,4 ) node[tre ] ( r ) ; ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 4,6 ) node[tre ] ( r0 ) ; ( z)(1 ) ; ( z)(2 ) ; ( x)(4 ) ; ( x)(3 ) ; ( r)(z ) ; ( r)(x ) ; ( r0)(r ) ; ( r0)(5 ) ; ( 3,-2 ) node @xmath78 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 2,2 ) node[tre ] ( z ) ; ( 3,4 ) node[tre ] ( r ) ; ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 4,6 ) node[tre ] ( r0 ) ; ( z)(1 ) ; ( z)(2 ) ; ( z)(3 ) ; ( r)(4 ) ; ( r)(z ) ; ( r0)(r ) ; ( r0)(5 ) ; ( 3,-2 ) node @xmath79 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,0 ) node[tre ] ( 2 ) ; 2 ( 4,0 ) node[tre ] ( 3 ) ; 3 ( 6,0 ) node[tre ] ( 4 ) ; 4 ( 1,2 ) node[tre ] ( z ) ; ( 2.5,3.33 ) node[tre ] ( x ) ; ( 4,4.66 ) node[tre ] ( r ) ; ( 8,0 ) node[tre ] ( 5 ) ; 5 ( 5.5,6 ) node[tre ] ( r0 ) ; ( z)(1 ) ; ( z)(2 ) ; ( x)(z ) ; ( x)(3 ) ; ( r)(4 ) ; ( r)(x ) ; ( r0)(r ) ; ( r0)(5 ) ; ( 3,-2 ) node @xmath80 ;    the following alternative expression for @xmath69 will be useful in many proofs .",
    "[ lem : alt1 ] let @xmath45 be a phylogenetic tree with root @xmath19 .",
    "then , @xmath81    for every @xmath82 and for every @xmath83 , let @xmath84 then , @xmath85 and thus @xmath86 & \\displaystyle = \\sum_{v\\in v_{int}(t)-\\{r\\}}\\binom{|c_t(v)|}{2}.   \\end{array}\\ ] ]    for every @xmath45 , @xmath69 can be computed in time @xmath87 .",
    "the vector @xmath88 can be computed in linear time by traversing in post order the tree @xmath9 @xcite , and then , by the last lemma , @xmath69 is computed in linear time from this vector .",
    "[ lem : rec ] let @xmath45 be a phylogenetic tree with root @xmath19 , and let @xmath89 , @xmath90 , be the subtrees rooted at the children of @xmath19 ; cf .",
    "fig [ fig : rec ] .",
    "then , @xmath91    ( 0,0 ) node[tre ] ( z1 ) ; ( z1)(-2,-3)(2,-3)(z1 ) ; ( 0,-2 ) node @xmath92 ; ( 5,0 ) node[tre ] ( z2 ) ; ( z2)(3,-3)(7,-3)(z2 ) ; ( 5,-2 ) node @xmath93 ; ( 8,-2.8 ) node . ;",
    "( 8.4,-2.8 ) node . ; ( 8.8,-2.8 ) node . ;",
    "( 11.5,0 ) node[tre ] ( z3 ) ; ( z3)(9.5,-3)(14.5,-3)(z3 ) ; ( 11.5,-2 ) node @xmath94 ; ( 7.25,4 ) node[tre ] ( z ) ; ( z)(z1 ) ; ( z)(z2 ) ; ( z)(z3 ) ;    let @xmath95 be the root of @xmath37 , @xmath96 , and @xmath19 the root of @xmath9 . then ,",
    "by lemma [ lem : alt1 ] , @xmath97    this shows that the total cophenetic index is a _ recursive tree shape statistic _ in the sense of @xcite .",
    "next lemma shows that the total cophenetic index is local , in the sense that if two trees differ only on a rooted subtree , then the difference between their total cophenetic values is equal to that of these subtrees .",
    "sackin s and colless indices also satisfy this property .    [",
    "lem : basic ] let @xmath98 and @xmath99 be two phylogenetic trees with @xmath100 , let @xmath45 be such that its subtree rooted at some node @xmath101 is @xmath98 , and let @xmath102 be the tree obtained from @xmath9 by replacing @xmath98 by @xmath99 as its subtree rooted at @xmath101 . then @xmath103    without any loss of generality , assume that @xmath104 , with @xmath105 .",
    "let @xmath106 . then , for every @xmath107 , @xmath108 on the other hand , @xmath109 if @xmath110 or @xmath111",
    ". therefore @xmath112    the _ nodal distance _ @xmath113 between a pair of leaves @xmath65",
    "is the length of the unique undirected path connecting them ; equivalently , it is the sum of the lengths of the paths from @xmath114 to @xmath115 and @xmath116 . the _ total area",
    "_ @xcite of a tree @xmath45 is defined as @xmath117 there is an easy relation between @xmath69 , @xmath59 and @xmath118 , which will be used several times in this paper .",
    "[ lem : total ] for every @xmath45 , @xmath119    it is straightforward to check that , for every @xmath83 , @xmath120 therefore , @xmath121",
    "in this section we determine which trees in @xmath29 and @xmath30 have the largest and smallest total cophenetic indices .",
    "we begin by establishing two lemmas that will allow us to find the trees with the maximum @xmath4 on @xmath29 .",
    "[ lem : basic1 ] let @xmath122 , with @xmath123 , be an ordered forest on @xmath124 .",
    "consider the trees @xmath125 described in fig .",
    "[ fig:1 ] .",
    "then , @xmath126 .",
    "( 0,0 ) node[tre ] ( z1 ) ; ( z1)(-2,-3)(2,-3)(z1 ) ; ( 0,-2 ) node @xmath92 ; ( 5,0 ) node[tre ] ( z2 ) ; ( z2)(3,-3)(7,-3)(z2 ) ; ( 5,-2 ) node @xmath93 ; ( 8,-2.8 ) node . ;",
    "( 8.4,-2.8 ) node . ;",
    "( 8.8,-2.8 ) node . ; ( 11.5,0 ) node[tre ] ( z3 ) ; ( z3)(9.5,-3)(14.5,-3)(z3 ) ; ( 12,-2 ) node @xmath127 ; ( 17.5,0 ) node[tre ] ( z4 ) ; ( z4)(15.5,-3)(20.5,-3)(z4 ) ; ( 17.5,-2 ) node @xmath128 ; ( 8.75,4 ) node[tre ] ( r ) ; ( r)(z1 ) ; ( r)(z2 ) ; ( r)(z3 ) ; ( r)(z4 ) ; ( 8,-4 ) node @xmath98 ;    ( 0,0 ) node[tre ] ( z1 ) ; ( z1)(-2,-3)(2,-3)(z1 ) ; ( 0,-2 ) node @xmath92 ; ( 5,0 ) node[tre ] ( z2 ) ; ( z2)(3,-3)(7,-3)(z2 ) ; ( 5,-2 ) node @xmath93 ; ( 8,-2.8 ) node . ; ( 8.4,-2.8 ) node . ; ( 8.8,-2.8 ) node . ; ( 11.5,0 ) node[tre ] ( z3 ) ; ( z3)(9.5,-3)(14.5,-3)(z3 ) ; ( 12,-2 ) node @xmath127 ; ( 17.5,0 ) node[tre ] ( z4 ) ; ( z4)(15.5,-3)(20.5,-3)(z4 ) ; ( 17.5,-2 ) node @xmath128 ; ( 6,2 ) node[tre ] ( x ) ; x ( 12,4 ) node[tre ] ( r ) ; ( x)(z1 ) ; ( x)(z2 ) ; ( x)(z3 ) ; ( r)(x ) ; ( r)(z4 ) ; ( 8,-3.9 ) node @xmath99 ;    with the notations of fig .",
    "[ fig:1 ] , notice that @xmath129    [ cor : basic1 ] for every non - binary phylogenetic tree @xmath45 , there always exists a binary phylogenetic tree @xmath52 such that @xmath130 .",
    "let @xmath45 be a non - binary phylogenetic tree .",
    "then it contains an internal node @xmath101 whose rooted subtree looks like the tree @xmath98 in the previous lemma , for some @xmath123 . by lemma [ lem : basic ] and the last lemma , if @xmath102 is the tree obtained from @xmath9 by replacing @xmath98 by @xmath99 as its subtree rooted at @xmath101 , then @xmath131 .",
    "therefore , the maximum total cophenetic index is reached at a binary tree .",
    "[ lem : basic2 ] let @xmath132 , let @xmath133 , let @xmath92 be any binary tree on @xmath134 , and let @xmath98 and @xmath99 be the phylogenetic trees in @xmath135 depicted in fig .",
    "[ fig:2 ] .",
    "then , @xmath136 .",
    "( 0,0 ) node[tre ] ( z ) ; ( z)(-2,-3)(2,-3)(z ) ; ( 0,-2 ) node @xmath92 ; ( 2,6 ) node[tre ] ( x ) ; ( x)(z ) ; ( 4,4.6 ) node[tre ] ( a ) ; ( x)(a ) ; ( 6,3.2 ) node[tre ] ( b ) ; ( a)(b ) ; ( 4,-2.5 ) node [ tre ] ( 1 ) ; 1 ( 6,-2.5 ) node [ tre ] ( 2 ) ; 2 ( b)(8,1.8 ) ; ( 8.3,1.8 - 0.7 * 0.3 ) node . ;",
    "( 8.6,1.8 - 0.7 * 0.6 ) node . ; ( 8.9,1.8 - 0.7 * 0.9 ) node . ; ( 11,-0.3 ) node[tre ] ( c ) ; ( 9.2,1.8 - 0.7 * 1.2)(c ) ; ( 9,-2.5 ) node [ tre ] ( k-1 ) ; ( k-1 ) node @xmath137 ; ( 13,-2.5 ) node [ tre ] ( k ) ; ( k ) node @xmath0 ; ( x)(a ) ; ( a)(1 ) ; ( b)(2 ) ; ( c)(k ) ; ( c)(k-1 ) ; ( 6,-4 ) node @xmath98 ;    ( 0,0 ) node[tre ] ( z ) ; ( z)(-2,-3)(2,-3)(z ) ; ( 0,-2 ) node @xmath92 ; ( 2,1 ) node[tre ] ( a ) ; ( 3,-2.5 ) node [ tre ] ( 1 ) ; ( 1 ) node @xmath0 ; ( 4,2 ) node[tre ] ( b ) ; ( 5,-2.5 ) node [ tre ] ( 2 ) ; ( 2 ) node @xmath137 ; ( b)(5,2.5 ) ; ( 5.3,2.65 ) node . ;",
    "( 5.6,2.8 ) node . ;",
    "( 5.9,2.95 ) node . ; ( 7.5,3.75 ) node[tre ] ( c ) ; ( 6.2,3.1)(c ) ; ( 8.5,-2.5 ) node [ tre ] ( k ) ; ( k ) node @xmath138 ; ( 9.5,4.75 ) node[tre ] ( r ) ; ( 10.5,-2.5 ) node [ tre ] ( k0 ) ; ( k0 ) node @xmath139 ; ( r)(k0 ) ; ( r)(c ) ; ( a)(z ) ; ( a)(1 ) ; ( b)(a ) ; ( b)(2 ) ; ( c)(k ) ; ( 6,-4 ) node @xmath99 ;    by lemma [ lem : alt1 ] , and recalling that @xmath140 , we have that @xmath141 and hence , since @xmath142 , @xmath143    [ ref : largest ] the trees in @xmath29 with maximum total cophenetic index are exactly the rooted caterpillars @xmath144 , and this maximum is @xmath145 .    by corollary [ cor : basic1 ] , any tree in @xmath29 with maximum total cophenetic index will be binary .",
    "let now @xmath146 and assume that it is not a caterpillar .",
    "therefore , it has an internal node @xmath101 of largest depth without any leaf child ; in particular , all internal descendant nodes of @xmath101 have some leaf child .",
    "thus , and up to a relabeling of its leaves , the subtree of @xmath9 rooted at @xmath101 has the form of the tree @xmath98 in fig .",
    "[ fig : larg1 ] , for some @xmath90 and some @xmath147 .",
    "but then , by lemma [ lem : basic2 ] ( taking as @xmath92 the caterpillar subtree rooted at the parent of the leaf @xmath0 ) , the tree @xmath99 also depicted in fig .",
    "[ fig : larg1 ] has a strictly larger total cophenetic index .",
    "then , by lemma [ lem : basic ] , if we replace in @xmath9 the subtree rooted at @xmath101 by this tree @xmath99 , we obtain a new tree @xmath52 with @xmath148 .",
    "this implies that no tree other than a caterpillar can have the largest total cophenetic index .",
    "( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,2 ) node[tre ] ( a ) ; ( 3,0 ) node [ tre ] ( 2 ) ; 2 ( 4,4 ) node[tre ] ( b ) ; ( 5,2 ) node [ tre ] ( 3 ) ; 3 ( b)(5,5 ) ; ( 5.3,5.3 ) node . ;",
    "( 5.6,5.6 ) node . ;",
    "( 5.9,5.9 ) node . ;",
    "( 7.5,7.5 ) node[tre ] ( c ) ; ( 6.2,6.2)(c ) ; ( 8.5,4.5 ) node [ tre ] ( k ) ; k ( 9.5,9.5 ) node[tre ] ( d ) ; ( d ) node @xmath101 ; ( 19,0 ) node[tre ] ( l ) ; l ( 17,2 ) node[tre ] ( a1 ) ; ( 16,0 ) node [ tre ] ( l-1 ) ; ( l-1 ) node @xmath149 ; ( 15,4 ) node[tre ] ( b1 ) ; ( 14,2 ) node [ tre ] ( l-2 ) ; ( l-2 ) node @xmath150 ; ( b1)(14,5 ) ; ( 13.7,5.3 ) node . ; ( 13.4,5.6 ) node . ;",
    "( 13.1,5.9 ) node . ; ( 11.5,7.5 ) node[tre ] ( c1 ) ; ( 12.8,6.2)(c1 ) ; ( 10.5,4.5 ) node [ tre ] ( k+1 ) ; ( k+1 ) node @xmath151 ; ( a)(1 ) ; ( a)(2 ) ; ( b)(a ) ; ( b)(3 ) ; ( c)(k ) ; ( d)(c ) ; ( a1)(l ) ; ( a1)(l-1 ) ; ( b1)(a1 ) ; ( b1)(l-2 ) ; ( c1)(k+1 ) ; ( d)(c1 ) ; ( 9.5,-2 ) node @xmath98 ;    ( 0,0 ) node[tre ] ( 1 ) ; 1 ( 2,2 ) node[tre ] ( a ) ; ( 4,0 ) node[tre ] ( 2 ) ; 2 ( 4,3 ) node[tre ] ( b ) ; ( 6,0 ) node[tre ] ( 3 ) ; 3 ( b)(5,3.5 ) ; ( 5.3,3.65 ) node . ; ( 5.6,3.8 ) node . ;",
    "( 5.9,3.95 ) node . ; ( 7.5,4.75 ) node[tre ] ( c ) ; ( 6.2,4.1)(c ) ; ( 10,0 ) node[tre ] ( k ) ; k ( 9.5,5.75 ) node[tre ] ( d ) ; ( 12,0 ) node[tre ] ( k+1 ) ; ( k+1 ) node @xmath152 ; ( d)(10,6 ) ; ( 10.3,6.15 ) node . ; ( 10.6,6.3 ) node . ; ( 10.9,6.45 ) node . ; ( 12.5,7.25 ) node[tre ] ( e ) ; ( 11.2,6.6)(e ) ; ( e ) node @xmath101 ; ( 16,0 ) node[tre ] ( l ) ; ( l ) node @xmath151 ; ( a)(1 ) ; ( a)(2 ) ; ( b)(a ) ; ( b)(3 ) ; ( c)(k ) ; ( d)(c ) ; ( d)(k+1 ) ; ( e)(l ) ; ( 9.5,-2 ) node @xmath99 ;    as far as the total cophenetic index of the rooted caterpillar @xmath144 with @xmath6 leaves depicted in fig .",
    "[ fig : exs].(a ) goes , since the parent of the leaf labelled @xmath116 , for @xmath153 , has @xmath116 descendant leaves , by lemma [ lem : alt1 ] we have that @xmath154 .",
    "it is obvious that minimum total cophenetic index is 0 , and it is attained only at the rooted star trees , depicted in fig .",
    "[ fig : exs].(b ) .",
    "therefore , the range of @xmath4 on @xmath29 goes from 0 to @xmath155 .",
    "this is one order of magnitude larger than the range of sackin s and colless indices , whose maximum value , reached also at the rooted caterpillars , has order @xmath3 @xcite .",
    "let us characterize now those _ binary _ phylogenetic trees with smallest total cophenetic index .",
    "[ lem : min ] let @xmath156 be an ordered binary forest on @xmath124 , let @xmath157 , for @xmath158 , and assume that @xmath159 , @xmath160 and @xmath161 .",
    "let @xmath98 the phylogenetic tree depicted in fig [ fig : min1].(a ) , and let @xmath57 ( @xmath162 ) be a binary phylogenetic tree having @xmath98 as a subtree rooted at some node . if @xmath69 is minimum in @xmath30 , then @xmath163 .",
    "( 0,2 ) node[tre ] ( v1 ) ; ( 6,2 ) node[tre ] ( v2 ) ; ( 12,2 ) node[tre ] ( v3 ) ; ( 18,2 ) node[tre ] ( v4 ) ; ( 3,4 ) node[tre ] ( a ) ; a ( 15,4 ) node[tre ] ( b ) ; b ( 9,6 ) node[tre ] ( z ) ; z ( z)(a ) ; ( z)(b ) ; ( a)(v1 ) ; ( a)(v2 ) ; ( b)(v3 ) ; ( b)(v4 ) ; ( v1)(-2,-1)(2,-1)(v1 ) ; ( 0,0 ) node @xmath92 ; ( v2)(4,-1)(8,-1)(v2 ) ; ( 6,0 ) node @xmath93 ; ( v3)(10,-1)(14,-1)(v3 ) ; ( 12,0 ) node @xmath164 ; ( v4)(16,-1)(20,-1)(v4 ) ; ( 18,0 ) node @xmath165 ; ( 9,-2.5 ) node ( a ) @xmath98 ;    ( 0,2 ) node[tre ] ( v1 ) ; ( 6,2 ) node[tre ] ( v2 ) ; ( 12,2 ) node[tre ] ( v3 ) ; ( 18,2 ) node[tre ] ( v4 ) ; ( 3,4 ) node[tre ] ( a ) ; a ( 15,4 ) node[tre ] ( b ) ; b ( 9,6 ) node[tre ] ( z ) ; z ( z)(a ) ; ( z)(b ) ; ( a)(v1 ) ; ( a)(v2 ) ; ( b)(v3 ) ; ( b)(v4 ) ; ( v1)(-2,-1)(2,-1)(v1 ) ; ( 0,0 ) node @xmath92 ; ( v2)(4,-1)(8,-1)(v2 ) ; ( 6,0 ) node @xmath165 ; ( v3)(10,-1)(14,-1)(v3 ) ; ( 12,0 ) node @xmath164 ; ( v4)(16,-1)(20,-1)(v4 ) ; ( 18,0 ) node @xmath93 ; ( 9,-2.5 ) node ( b ) @xmath166 ;    assume that @xmath167 .",
    "we shall show that , in this case , a suitable interchange of cousins in @xmath98 produces a tree with smaller total cophenetic index , which in particular will imply that @xmath69 can not be the minimum in @xmath30 .",
    "assume that the tree @xmath9 in the statement has the subtree @xmath98 rooted at a node @xmath101 .",
    "consider the tree @xmath99 obtained by interchanging in @xmath98 the subtrees @xmath93 and @xmath165 ( see fig .",
    "[ fig : min1].(b ) ) and let @xmath52 be the tree obtained from @xmath9 by replacing @xmath98 by @xmath99 as its subtree rooted at @xmath101 .",
    "then , by lemma [ lem : alt1 ] , @xmath168 which shows that @xmath169 .    from the proof of the last lemma",
    "we deduce that if , in the tree @xmath98 in fig .  [ fig : min1].(a ) , @xmath170 and @xmath171 , and if we interchange @xmath93 and @xmath165 , then the resulting tree has always a different total cophenetic index .",
    "[ lem : min2 ] let @xmath172 be an ordered binary forest on @xmath173 , let @xmath157 , for @xmath174 , and assume that @xmath159 .",
    "let @xmath98 the phylogenetic tree depicted in fig [ fig : min3].(a ) , and let @xmath57 be a binary phylogenetic tree having @xmath98 as a subtree rooted at some node . if @xmath69 is minimum in @xmath30 , then @xmath175 .",
    "( 0,2 ) node[tre ] ( v1 ) ; ( 6,2 ) node[tre ] ( v2 ) ; ( 3,4 ) node[tre ] ( a ) ; a ( 15,-0.5 ) node[tre ] ( m ) ; m ( 9,6 ) node[tre ] ( z ) ; z ( z)(a ) ; ( z)(m ) ; ( a)(v1 ) ; ( a)(v2 ) ; ( v1)(-2,-1)(2,-1)(v1 ) ; ( 0,0 ) node @xmath92 ; ( v2)(4,-1)(8,-1)(v2 ) ; ( 6,0 ) node @xmath93 ; ( 7.5,-2.5 ) node ( a ) @xmath98 ;    ( 0,2 ) node[tre ] ( v1 ) ; ( v1)(-2,-1)(2,-1)(v1 ) ; ( 0,0 ) node @xmath92 ; ( 8,6 ) node[tre ] ( z ) ; z ( z)(v1 ) ; ( 6,2 ) node[tre ] ( v2 ) ; ( v2)(4,-1)(8,-1)(v2 ) ; ( 6,0 ) node @xmath93 ; ( 11,4 ) node[tre ] ( b ) ; b ( 16,-0.5 ) node[tre ] ( m ) ; m ( z)(b ) ; ( b)(m ) ; ( b)(v2 ) ; ( 7.5,-2.5 ) node ( b ) @xmath166 ;    assume that @xmath176 .",
    "we shall show that , again in this case , a suitable interchange of cousins in @xmath98 produces a tree with smaller total cophenetic index .",
    "assume that the tree @xmath9 in the statement has the subtree @xmath98 rooted at a node @xmath101 .",
    "let @xmath52 by the tree obtained from @xmath9 by replacing @xmath98 by the subtree @xmath99 described in fig .",
    "[ fig : min3].(b ) . then : @xmath177 which shows that @xmath169 .",
    "the last two lemmas show that , unlike what happens with sackin s and colless indices , any interchange of cousins that changes the balance of their grandparent always changes the total cophenetic index of a tree .",
    "[ th : min ] for every @xmath57 , @xmath69 is minimum on @xmath30 if , and only if , @xmath9 is maximally balanced .",
    "assume that @xmath57 is not maximally balanced , and let @xmath101 be a non - balanced internal node in @xmath9 with largest depth .",
    "assume that @xmath178 and @xmath179 are its children , with @xmath180 .    if @xmath179 is a leaf , then , by lemma [ lem : min2 ] , @xmath181 and therefore @xmath182 .",
    "therefore , @xmath178 and @xmath179 are internal , and hence balanced .",
    "let @xmath98 be the subtree of @xmath9 rooted at @xmath101 , represented in fig .",
    "[ fig : min1].(a ) , and let @xmath157 , for @xmath158 ; without any loss of generality , we shall assume that @xmath159 and @xmath160 and thus , since @xmath178 and @xmath179 are balanced , @xmath183 or @xmath184 and @xmath185 or @xmath186 . then , @xmath187 implies that @xmath188 , and hence that @xmath189 .    therefore , by lemma [ lem : min ] , if @xmath69 is minimum in @xmath30 , it must happen that @xmath190 .",
    "since it forbids the equality @xmath191 , it implies that @xmath192 and therefore @xmath193 .",
    "but then @xmath194 , against the assumption that @xmath101 is not balanced .",
    "so , the only binary trees with minimum @xmath4 are the maximally balanced .",
    "let us compute now this minimum value of @xmath4 on @xmath30 .",
    "[ lem : recmin ] for every @xmath6 , let @xmath195 be the minimum of @xmath4 on @xmath30 .",
    "then , @xmath196 and @xmath197    this recurrence for @xmath195 is a direct consequence of lemma [ lem : rec ] and the fact that the root of a maximally balanced tree in @xmath30 is balanced and the subtrees rooted at their children are maximally balanced .    for every @xmath198 ,",
    "let @xmath199 is the highest power of 2 that divides @xmath200 .",
    "then , for every @xmath201 , @xmath202    the sequence @xmath203 is sequence a011371 in sloane s _ on - line encyclopedia of integer sequences _",
    "@xcite , where we learn that it satisfies the recurrence @xmath204 let now @xmath205 denote the sequence of partial sums of @xmath203 , which is sequence a174605 in sloane s encyclopedia .",
    "then , the sequence @xmath205 starts with @xmath206 and it satisfies the recurrence @xmath207    we want to prove that @xmath208 , for every @xmath198 .",
    "since @xmath196 , it remains to check the equality @xmath209 we prove this equality with the help of lemma [ lem : rec ] and by distinguishing four cases , depending on the residue of @xmath6 mod 4 .    *",
    "if @xmath210 , then @xmath211 * if @xmath212 , then @xmath213 * if @xmath214 , then @xmath215 * if @xmath216 , then @xmath217    this completes the proof .",
    "in particular , this yields a new meaning and a new recurrence for sequence a174605 in sloane s encyclopedia .",
    "let @xmath218 be the random variable that chooses a tree @xmath57 and computes its total cophenetic index @xmath69 . in this section",
    "we determine the expected value of @xmath218 under the yule model . to do this ,",
    "we shall make use of the following lemma , which can be useful to study the expected value under the yule model of other _ binary recursive tree shape statistics _ in the sense of @xcite .",
    "[ lem : yi ] let @xmath219 be a mapping that associates to each phylogenetic tree a real number @xmath220 satisfying the following two conditions :    1 .",
    "it is invariant under tree isomorphisms and relabelings of leaves .",
    "2 .   there exists a mapping @xmath221 such that , for every phylogenetic trees @xmath51 on disjoint sets of taxa @xmath222 , respectively , @xmath223    for every @xmath201 , let @xmath224 be the random variable that chooses a tree @xmath57 and computes @xmath225 , and let @xmath226 be its expected value under the yule model .",
    "then , @xmath227    first of all , notice that if @xmath228 , with @xmath229 with @xmath230 , and @xmath231 , then @xmath232 where @xmath233 denotes the probability of a phylogenetic tree under the yule model .",
    "this assertion is a direct consequence of the explicit probabilities of @xmath94 , @xmath234 and @xmath235 under the yule model given in  2.2 , and the fact that @xmath236 ( where @xmath19 denotes the root of @xmath235 ) , these unions being disjoint .",
    "let us compute now @xmath226 using its very definition : @xmath237    under the yule model , the expected value of @xmath218 is @xmath238    lemma [ lem : rec ] implies that @xmath4 satisfies the hypothesis of lemma [ lem : yi ] with @xmath239 .",
    "therefore @xmath240 and hence @xmath241 then , @xmath242 to solve this equation , rewrite it as @xmath243 setting @xmath244 , the sequence @xmath245 satisfies @xmath246 therefore @xmath247 and thus , finally , @xmath248    let @xmath56 stand for the random variable that chooses a tree @xmath249 and computes its sackin index @xmath250 ; cf .",
    "notice that , since @xmath61 @xcite , we have that @xmath251 we have not been able to find a direct reason for this equality .    @xmath252 .",
    "so , the order @xmath3 of the expected value under the yule model of the total cophenetic index on @xmath30 is larger than the order @xmath253 of the expected values of sackin s and colless indices @xcite .    from the expected values of the sackin and the total cophenetic indices",
    ", we can deduce the expected value of the total area @xmath254 on @xmath30 under the yule model .",
    "let @xmath255 be the random variable that chooses a tree @xmath57 and computes its total area @xmath118 . under the yule model ,",
    "its expected value is @xmath256    from lemma [ lem : total ] we deduce that @xmath257 and therefore @xmath258    in ( * ? ? ?",
    "( 35 ) ) , it is claimed that @xmath259 which can not be correct : since all three trees @xmath260 have @xmath261 , it must happen that @xmath262 , while the expression given in _ loc .",
    "_ yields @xmath263 . and",
    "incidentally , our formula does yield the correct value in this case .",
    "in this section we determine the expected value of @xmath218 under the uniform model . this expected value of @xmath218 will be easily deduced , through lemma [ lem : total ] , from the expected value of the total area , which was obtained in @xcite , and the expected value of the sackin index , which we obtain in theorem [ th : sackin ] below .",
    "this last formula is , to our knowledge , new .",
    "since , under the uniform model , all trees in @xmath29 have the same probability , @xmath264 , the expected value of @xmath56 under the uniform model is @xmath265 so , we need to compute the numerator in this fraction .    for every @xmath266 , @xmath267 .    for every @xmath268 ,",
    "let @xmath269 then @xmath270 it remains to compute @xmath271 for @xmath272 .",
    "to do so , notice that every tree @xmath57 such that @xmath273 will have the form described in fig .",
    "[ fig : forests ] .",
    "therefore , it is determined by the ordered @xmath0-forest @xmath274 on @xmath275 , and thus @xmath276 from which the expression in the statement follows .",
    "( -1,3 ) node[tre ] ( 1 ) ; 1 ( 2,4 ) node[tre ] ( x1 ) ; ( x1)(1 ) ; ( x1)(3,5 ) ; ( 3.3,5.3 ) node . ;",
    "( 3.6,5.6 ) node . ;",
    "( 3.9,5.9 ) node . ;",
    "( 5,7 ) node[tre ] ( x2 ) ; ( 4.2,6.2)(x2 ) ; ( 7,9 ) node[tre ] ( r ) ; ( x2)(r ) ; ( 5,3 ) node[tre ] ( tk ) ; ( tk)(3.6,0)(6.4,0)(tk ) ; ( 5,1 ) node @xmath128 ; ( x1)(tk ) ; ( 8,6 ) node[tre ] ( t2 ) ; ( t2)(6.6,3)(9.4,3)(t2 ) ; ( 8,4 ) node @xmath277 ; ( x2)(t2 ) ; ( 10,8 ) node[tre ] ( t1 ) ; ( t1)(8.6,5)(11.4,5)(t1 ) ; ( 10,6 ) node @xmath278 ; ( r)(t1 ) ;    now , recall that the ( _ generalized _ ) _ hypergeometric function _",
    "@xmath279 is defined @xcite as @xmath280 b_1 , & \\ldots ,   & b_q\\end{array};z\\bigg)=\\sum_{k{\\geqslant}0 } \\frac{(a_1)_k\\cdots ( a_p)_k}{(b_1)_k\\cdots ( b_q)_k}\\cdot \\frac{z^k}{k!},\\ ] ] where @xmath281 .",
    "many popular software systems , like mathematica or r , have implementations of these functions .",
    "[ th : sackin ] the expected value of the random variable @xmath56 under the uniform model is @xmath282 1,\\   4 - 2n\\end{array};2\\bigg)\\ ] ]    by the last lemma , we have that @xmath283 now @xmath284 & \\displaystyle=    \\frac{nk^2(2n - k-3)!2^{n-2}(n-2)!k!}{(2n-3)!(n - k-1)!2^{n - k-1}k ! } \\\\[2ex ] & \\displaystyle=   \\frac{nk^22^{k-1}\\binom{n-1}{k}}{(n-1)\\binom{2n-3}{k } } \\end{array}\\ ] ] and thus @xmath285 1,\\   4 - 2n\\end{array};2\\bigg ) \\end{array}\\ ] ] as we claimed .",
    "we have now the following result .    under the uniform model ,",
    "the expected value of @xmath218 is @xmath286 1,\\   4 - 2n\\end{array } ; 2\\bigg)-\\frac{1}{2}\\cdot \\frac{(2n-2)!!}{(2n-3)!!}\\bigg)\\sim \\frac{\\sqrt{\\pi}}{4}n^{5/2}\\ ] ]    the expected values under the uniform model of @xmath56 and @xmath255 are : @xmath287 1,\\   4 - 2n\\end{array};2\\bigg ) &   \\quad   \\mbox { by theorem \\ref{th : sackin } } \\\\ \\displaystyle e_u(d_n)=\\binom{n}{2 } \\cdot\\frac{(2n-2)!!}{(2n-3 ) ! ! }",
    "&    \\quad   \\mbox{\\cite { mirr10 } } \\end{array}\\ ] ] then , by lemma [ lem : total ] , @xmath288 1,\\   4 - 2n\\end{array};2\\bigg ) -\\frac{1}{2}\\binom{n}{2 } \\cdot\\frac{(2n-2)!!}{(2n-3)!!}\\\\ & \\displaystyle = \\binom{n}{2}\\bigg(\\frac{1}{2n-3 } { } _ 3 f_2 \\bigg(\\begin{array}{l } 2,\\ 2,\\ 2-n \\\\[-0.5ex ] 1,\\   4 - 2n\\end{array } ; 2\\bigg)-\\frac{1}{2}\\cdot \\frac{(2n-2)!!}{(2n-3)!!}\\bigg ) \\end{array}\\ ] ] the assertion @xmath289 comes easily from lemma [ lem : total ] , and the facts that @xmath290 @xcite , and that , using stirling s approximation for large factorials , @xmath291 @xcite .",
    "in this paper we have introduced a new balance index for phylogenetic trees , the total cophenetic index @xmath4 .",
    "this index makes sense for arbitrary phylogenetic trees , it can be computed in linear time , and it has a larger range of values than sackin s or colless indices .",
    "we have computed its maximum and minimum values for binary and arbitrary phylogenetic trees , and its expected value under the yule and the uniform models . in a future work we plan to study other statistical properties of @xmath4 , like its variance , its limiting distribution or its correlation to other balance indices .    from the point of view of the measurement of the degree of symmetry of a tree ,",
    "our index outperforms the resolution power of sackin s and colless indices .",
    "we already saw some hints of this property in the previous sections : for instance , in theorem [ th : min ] , where we proved that the only trees @xmath57 that have minimum @xmath69 are the maximally balanced , something that is not true in general for sackin s and colless indices ( recall fig . [ fig : minind ] ) ; or in the lemmas previous to the proof of this theorem , where we saw that any interchange of cousins that modifies the balance of their grandparent also modifies the value of @xmath4 . as a further evidence of this greater resolution power",
    ", we have estimated the probability that a pair of trees @xmath292 have @xmath293 , for @xmath294 .",
    "to do so , for every @xmath295 we have chosen randomly a number @xmath296 of pairs of trees in @xmath30 ( for the first few values of @xmath6 , @xmath296 was taken to be @xmath297 , but starting at @xmath298 , we took @xmath299 ) , and computed , for @xmath294 , @xmath300 fig . [ ties ]",
    "summarizes the results .",
    "it plots @xmath301 for the three balance indices as a function of @xmath302 .",
    "we can see that that the total cophenetic index has the lowest such estimated probability of a tie .",
    "we plan to perform a deeper study of the probability of ties for the different balance indices in a future paper .",
    "@xmath303 sackin    @xmath303 colless    @xmath303 @xmath4    [ ties ]    this greater resolution power of @xmath4 makes it a better candidate to be used to test evolutionary hypotheses .",
    "we have performed a preliminary such test on the treebase database @xcite .",
    "we have considered the numbers @xmath6 of leaves for which the treebase contains at least 20 binary phylogenetic trees with @xmath6 leaves , and for each such @xmath6 we have computed the mean of the total cophenetic indices of the corresponding binary trees .",
    "[ means ] plots the log of these means as a function of @xmath302 .",
    "we have added the curves of the log of the expected values of @xmath218 under the yule distribution ( lower curve ) and under the uniform distribution ( upper curve ) , again as a function of @xmath302 .",
    "this figure shows that the total cophenetic indices of the binary phylogenetic trees in treebase are better explained by the uniform model than by the yule model .",
    "we also plan to report in a future paper on more extensive tests on stochastic models of evolutionary processes using the total cophenetic index .     of leaves , of @xmath304 ( lower curve ) and @xmath305 ( upper curve).,title=\"fig:\",height=226 ] [ means ]",
    "the research reported in this paper has been partially supported by the spanish government and the ue feder program , through projects mtm2009 - 07165 and tin2008 - 04487-e / tin .",
    "we thank g. cardona , e. hernndez - garca , and j. mir for several comments on previous versions of this work ."
  ],
  "abstract_text": [
    "<S> several indices that measure the degree of balance of a rooted phylogenetic tree have been proposed so far in the literature . in this work </S>",
    "<S> we define and study a new index of this kind , which we call the _ total cophenetic index _ : the sum , over all pairs of different leaves , of the depth of their least common ancestor . </S>",
    "<S> this index makes sense for arbitrary trees , can be computed in linear time and it has a larger range of values and a greater resolution power than other indices like colless or sackin s . </S>",
    "<S> we compute its maximum and minimum values for arbitrary and binary trees , as well as exact formulas for its expected value for binary trees under the yule and the uniform models of evolution . as a byproduct of this study </S>",
    "<S> , we obtain an exact formula for the expected value of the sackin index under the uniform model , a result that seems to be new in the literature .    </S>",
    "<S> phylogenetic tree , imbalance index , cophenetic value , sackin index </S>"
  ]
}