{
  "article_text": [
    "the epic pn camera on  board xmm ",
    "newton is currently the most sensitive instrument in space for detecting soft x  rays . in order to fully utilize this unique capability ,",
    "we have developed methods which improve the data quality in particular at low energies .",
    "these methods are generally available in sass  v6.0 , the most recent version of the xmm  newton science analysis system , in the task epreject .",
    "in section  [ sect : offset ] we describe a method which removes bright patches that become visible in low  energy images .",
    "this is achieved by correcting the energy of events which are detected in the corresponding pixels .",
    "thus , this method does not only improve the cosmetic quality of low ",
    "energy images , but does also improve the spectral quality thoughout the whole bandpass of epic pn .",
    "although the most straightforward application of this method requires the presence of the offset map for the corresponding exposure , we have extended this method so that it can also be applied if only the event file is available .",
    "another improvement , described in section  [ sect : detnoise ] , concerns the suppression of detector noise , which becomes significant at energies below @xmath5 .",
    "this is done by computing the probability that a specific event may be a noise event and by assigning , on a statistical basis , appropriate flags to individual events .",
    "subsequent removal of events which were flagged as due to detector noise leads to a conspicuous improvement of the data quality below @xmath6 and makes the background subtraction in this energy range more reliable .",
    "additionally , as a by  product , the event files become considerably smaller and easier to handle .    in section  [",
    "sect : vela ] , we demonstrate these methods on the example of an xmm epic pn observation of an area within the vela supernova remnant . in particular we show how the noise suppression method reveals the presence of soft diffuse emission at energies below @xmath5 which would otherwise be hidden in the detector noise .",
    "the usual mode of operating the epic pn camera consists of taking an offset map immediately before the beginning of an exposure .",
    "ideally , this map contains for each pixel the energy offset ( expressed in analog  to  digital units , adu ) . during the subsequent exposure ,",
    "these offsets are subtracted on  board from the measured signals , and only events where the difference signal exceeds a lower threshold ( usually 20  adu ) are transmitted to earth .",
    "the offset map is calculated in the following way : the charge in each pixel is read out one hundred times , the three smallest and the three highest adu values are ignored , and the sum of the remaining values , divided by 94 and truncated to the nearest integer , is computed as the offset of that pixel .",
    "this procedure is applied subsequently to regions of @xmath7 along each ccd .",
    "the reason for excluding the extreme values is to minimize the influence of energetic particles on the offset calculation .",
    "the highest adu values are ignored because the charge deposited by _ minimum _ ionizing particles is usually close to the upper end of the dynamic adu range . however , the charge deposited by a _",
    "highly _ ionizing particle may show up as a very small charge , because the large amount of charge generated by such a particle takes a long time to be cleared from the anode . depending on the number of signal electrons , the clearing goes on during the readout of the next pixels , and",
    "the measured adu value is thus slighly reduced .",
    "therefore , also the smallest adu values are ignored .    to    there are cases where so much charge is deposited by highly ionizing particles that it takes several frames until the original state is restored .",
    "it may also happen that several minimum ionizing particles are hitting the same pixels during the one hundred readouts . at such occasions",
    "the technique of rejecting the three smallest and the three highest adu values before computing the mean offset is not sufficient , and the offset is not computed correctly . as the erroneous adu values are predominantly too low , the computed mean offset becomes too small .",
    "this effect introduces in the affected pixels deviations from the correct offsets which range typically from @xmath8 to @xmath9 , corresponding to energy shifts from @xmath10 to @xmath11 . as a consequence ,",
    "the energies of all events in these pixels appear to be shifted by the same amount .",
    "the number of affected pixels scales with the intensity of the particle background during the calculation of the offset map and depends also on the readout mode . from our analysis of full frame mode ( ff )",
    "data , we find that 54% of all pixels contain correct offsets , while for 26% the offset is by 5  ev too high and for 12% it is by 5  ev too small . deviations of this amount ( @xmath12 ) are not necessarily all caused by energetic particles , as they may also reflect statistical and numerical fluctuations in the computation of the offset map .",
    "larger deviations , however , can clearly be attributed to energetic particles , as can be seen by their characteristic pattern ( e.g.  fig.[offset_prep_526]c ) . for 5%",
    "the offset is by 10  ev too high and for 2% it is by 10  ev too small .",
    "offsets of 15  ev and more were found for 1% of the pixels . for @xmath13 of them ,",
    "the offset was too small .    to    to    to",
    "if the offset subtracted on  board was too small , then the adu values which are assigned to events in such pixels became too high .",
    "thus , events which have adu values below the lower threshold and which would normally have been rejected , may show up in the data set .",
    "as most of such events are due to detector noise , which is steeply increasing towards lower energies ( fig.[offmp1a ] ) , any reduction of the lower energy threshold leads to a considerable increase in the number of events .",
    "thus , pixels where the offset is too small show up as bright patches in images accumulated in the lowest transmitted adu range . due to the specific pixel block sampling applied for the offset map calculation ( see above ) ,",
    "these patches appear as rectangular areas , which are characterized by a brightening in four consecutive pixels along readout direction .",
    "depending on the width of the trail caused by the energetic particles and its orientation with respect to the ccd , the patches may also extend over several consecutive pixels perpendicularly to the readout direction .",
    "pixels with too high offsets are less obvious in low ",
    "energy images , as they are only somewhat darker than their environment .",
    "while the occurrence of bright patches in epic pn images which are accumulated at low energies ( e.g.fig.[ima20adu_comp ] ) is immediately obvious , there is also another consequence : a shift in the energy scale over the whole spectral bandpass .",
    "this shift degrades the energy resolution for extended objects . for point sources , the x ",
    "ray spectrum may be shifted by some 10  ev , in most cases towards higher energies , if the position of the source happens to coincide with one of these patches . here",
    "we describe a method for restoring the correct energy scale and for removing the bright patches in the soft energy images .",
    "although this paper concentrates on the low energy properties of epic pn data , we note that the correction of the offset shifts improves the energy calibration throughout the full spectral bandpass of the epic pn detector .",
    "the correction is more straightforward if the offset map is available .",
    "if this is not the case , then the offsets have to be reconstructed from the spatial and spectral distribution of the transmitted events .",
    "these two cases are described in the next sections .",
    "the offset map contains for each pixel the adu value which was subtracted from all events in the particular pixel before transmitting this information to ground . as it contains both correct and incorrect offsets , the main goal is to distinguish between both cases .",
    "such a distinction is possible under the assumption that the generic offsets of all pixels ( not affected by electronic effects during readout ) are very similar and that the areas where incorrect offsets were computed occur in isolated patches .",
    "the most obvious property of the offset map is a pattern of vertical stripes ( fig.[offset_prep_526]a ) .",
    "this is caused by the fact that each of the 768 readout columns has its own amplifier , and the amplification varies by @xmath14 ( rms ) from column to column . in order to spot the patches where wrong offsets have been applied , the column to column variation has to be removed .",
    "this can be achieved by subtracting the median value from each column",
    ". the resulting map ( fig.[offset_prep_526]b ) is dominated by row to row variations , which are mainly caused by the ",
    "common mode \" effect : a temporal change of the offsets of all the pixels in a ccd row , occurring in a predominantly irregular way .",
    "this effect is present during the calculation of the offset map as well as during the subsequent exposure . during the exposure",
    ", it is suppressed on ",
    "board by subtracting first the adu offsets contained in the offset map , and then the median of all the adu values in a ccd row from these values , individually for each readout frame .",
    "concerning the further processing of the offset map , this implies that the median value of each row should also be subtracted from the corresponding row , in order to remove the row to row variation .",
    "this leads to a  residual offset map \" ( fig.[offset_prep_526]c ) , which is close to zero except for the pixels where specific offsets were applied .",
    "to to    to    however , not all of the offsets in the residual offset map are artefacts caused by energetic particles .",
    "comparison of such maps ( e.g.figs.[offset_prep_526]c and [ offset_comp]a ) indicates that they consist of a superposition of both persistent and temporally variable patterns . by computing for each pixel the median value of several such maps , only the persistent patterns remain ( fig.[offset_comp]b ) .",
    "subtraction of such a `` residual offset reference map '' from an individual residual offset map reveals then the temporally variable content of this  cleaned offset map \" .",
    "comparison of such maps with images accumulated from the low  energy events in the subsequent exposure ( see fig.[offset_comp]a and sect.[sect : without_offset_map ] ) shows a clear correlation between the position of the bright patches in the low  energy image and the pixels which have a non ",
    "zero value in the cleaned offset map .",
    "this shows that the patches seen in the cleaned offset maps reflect incorrect offsets caused by energetic particles .",
    "as the processed offset maps contain directly the adu shifts which have to be subtracted from all events in the corresponding pixels in order to reconstruct the correct energy scale , an implementation of this algorithm is straightforward .",
    "however , while the correct energy scale can be reconstructed , there is no possibility to recover events which were not transmitted to ground because a too high offset was subtracted so that they fell below the lower energy threshold . on the other hand , events where a too low offset was subtracted will show up after the correction with adu values below the lower threshold . in order to restore a homogeneous data set",
    ", these events should be removed afterwards .",
    "then the gain and cti correction should be repeated for the whole data set .",
    "even if the offset map is not available ( this was the general situation in the past ) , the correction described above can be achieved , by extracting the necessary information directly from the event file .",
    "this is possible because the amount of noise events is a monotonically and steeply increasing function towards lower energies ( fig.[offmp1a ] ) .",
    "as this function is also fairly stable in time , the intensity of a pixel in the lowermost energy channel transmitted ( 20  adu ) is expected to be correlated with the shift in the energy scale : if the energy scale in a pixel is shifted by only 1  adu towards higher energies , i.e. , if the 20  adu bin contains 19  adu events , then this pixel should contain @xmath15 times more events .    however , this correlation is disturbed by the fact that the brightness of a pixel at 20  adu is also influenced by other factors , in particular by its individual noise properties . in fig.[ima20adu_comp]a ,",
    "the lower half of the detector ( q2 and q3 ) are brighter than the upper one ( q0 and q1 ) .",
    "comparison with fig.[offmp1a ] shows that this behaviour is caused by the fact that there are more noise events at 20  adu in q2 and q3 than in q0 and q1 .",
    "in addition to the brightness differences from quadrant to quadrant , brightness variations can also be seen within the quadrants and even within the ccds ( fig.[ima20adu_comp]a ) .",
    "separation of brightness variations caused by shifts in the energy scale from variations caused by other effects can be achieved with a similar method as applied to the residual offset maps ( sect.[sect : with_offset_map ] ) : from a set of 20  adu images , derived from long exposures with no bright sources in the field of view and normalized to the same exposure time , a reference image can be computed , containing for each pixel the median value , i.e. , its nominal , temporally constant , 20  adu brightness ( fig.[ima20adu_comp]b ) .",
    "this reference image can then be subtracted from an individual 20  adu image , in order to derive the brightness variations characteristic for that particular exposure .",
    "the resulting  cleaned 20  adu image \" ( fig.[ima20adu_comp]c ) shows a clear spatial correlation with the cleaned offset map of the same exposure ( fig.[offset_comp]c ) .",
    "in addition to the spatial correlation , there is also a direct correlation between the brightness of the pixels in the cleaned 20  adu images ( normalized to the same exposure time ) and the cleaned offset maps , as expected .",
    "this correlation ( fig.[offmp9_3 _ ] ) is different between the four quadrants , due to their different noise properties .",
    "no such differences were found among the ccds within a quadrant .",
    "the correlation shown in fig.[offmp9_3 _ ] was derived from seven long observations of the lockman hole ( @xmath16 in total ) .",
    "this region contains only faint sources , which can not disturb the offset maps or the 20  adu images . due to the long exposure times , the statistical uncertainties in the number of excess counts at 20  adu are minimized .",
    "the statistical quality is good enough to deduce the energy shifts to be applied from the number of excess counts for the range from @xmath17 to @xmath18 .",
    "as larger shifts do not occur frequently enough for a direct determination of the correlation function , they were determined by extrapolation ( fig.[offmp9_4 ] ) .    with the correlation derived above ,",
    "it becomes possible to reconstruct the offset shifts directly from the event file , at least in an approximate way : while offset shifts can occur only at discrete adu steps , the correspondence between the 20  adu brightness and the value of the offset shift is not always unique ( fig.[offmp9_3 _ ] ) .",
    "in addition , the presence of poissonian noise in the 20  adu images , in particular for short exposures , limits the sensitivity for locating the pixels where a correction of the energy scale should be applied .",
    "the sensitivity of locating such pixels can be increased by rebinning four consecutive rows of the 20  adu image into one row each , in order to utilize the information about how the offset map was calculated on  board .",
    "nevertheless , this method is less accurate than the technique described in the previous section , but it does improve the overall data quality and can be applied if no offset map is available .    to",
    "while there is practically no detector noise present at energies above @xmath19 ( @xmath20 ) , x - ray data below this energy , in particular below 40  adu ( @xmath5 ) , are considerably contaminated by noise events , which become more and more dominant towards the lowest transmitted energy channels ( fig.[offmp1a ] ) .",
    "investigations of 40  hours of in ",
    "orbit calibration data with the filter wheel closed , taken over a period of more than two years , show that the noise properties vary with position and energy , but are fairly stable in time for most areas on the detector .",
    "this property enables a statistical approach for suppressing the detector noise : with the information about the spatial and spectral dependence of the detector noise , the amount of events which correspond to the expected noise can be flagged and suppressed .",
    "the noise properties were derived from 10 exposures in fullframe mode , with the filter wheel closed , between xmm ",
    "newton revolutions # 129 and # 532 , yielding a total exposure time of 144  ks .",
    "these measurements were first corrected for offset shifts ( see sect.[sect : offset ] ) and then used for accumulating raw spectra below 65  adu , individually for each ccd row ( fig.[noise_3d ] ) .",
    "the fine spacing along readout direction was chosen because the noise properties change considerably with distance from the readout node , in particular close to the node . in order to get a sufficient number of events",
    ", no subdivision was made along the ccd rows .",
    "this approach was motivated by the fact that the noise properties do not show a pronounced dependence along this direction ( unless there is a bright column ) .",
    "as the resulting spectra suffered somewhat from low count rate statistics , they were smoothed along readout direction with a running median filter extending over @xmath21 rows .",
    "this smoothing was not applied to the 20 rows closest to the readout nodes , where the spectra contained more counts and where the dependence of the spectra on the distance from the readout nodes is high .    with this information ,",
    "potential noise events in a specific observation can be suppressed , on a statistical basis , in the following way : for each ccd row and adu bin , the number of events is compared with the corresponding value in the noise data ( scaled to the same exposure ) . according to the ratio between the actual number of events and the expected noise contribution , individual events can then be randomly flagged . in order to improve the statistics somewhat , the spectra from the observation to be corrected are internally smoothed by a running median filter along readout direction before the noise contribution is computed .",
    "this method extends the usable energy range down to the lowest energies transmitted , i.e. @xmath22 , depending on the position on the ccd .",
    "below this energy , parts of the detector become essentially insensitive due to the low energy threshold applied on  board and the combined effect of charge transfer loss and gain variations within the 768 amplifiers in the epic pn camera .",
    "in addition to the improvement of the data quality , a removal of events which were flagged as noise events also makes the files considerably smaller and easier to handle .    suppressing the detector noise by this method has not only advantages for images , but leads also to a more reliable subtraction of detector noise in the spectra and thus to an improved spectral quality .",
    "a large part of the instrumental background can be taken into account by the unusal technique of background subtraction , i.e. , by determining the background spectrum from a different region on the detector and subtracting it , appropriately scaled , from the spectrum to be analysed .",
    "however , as the detector noise is not vignetted ( in contrast to background coming through the x  ray telescope ) and not distributed homogeneously across the detector ( fig.[noise_3d ] ) , the usual background subtraction technique may lead to a systematic error in the normalization of the low  energy part of the spectrum .",
    "another interesting consequence of the noise suppression method described here for spectral studies is that the detector noise can be separated from other background components .    to    to    to",
    "here we apply the methods described in sections [ sect : offset ] and [ sect : detnoise ] to a 33  ks observation of the vela supernova remnant , performed in december 2001 ( xmm rev.367 ) in fullframe mode with the medium filter . the observed region ( fig.[vela_rosat_xmm ] ) contains the north  west rim of another supernova remnant , rxj0852.0 - 4622 , which was discovered in the rosat all  sky survey@xcite . compared to the vela snr , which is @xmath23 old , rxj0852.0 - 4622 is considerably younger ( less than @xmath24 , with @xmath25 as the most probable value@xcite ) and is emitting more energetic x  rays . in the rosat data ,",
    "it becomes visible only above 1.3  kev . at lower energies ,",
    "it is outshone by the bright emission of the vela snr ( fig.[vela_rosat_xmm ] ) .",
    "figure  [ pn0367ff_med_0]a shows the epic pn data of this observation accumulated at 20  adu , the lowest energies transmitted .",
    "white patches resulting from erroneous energy offsets are clearly seen . after applying the local corrections of the energy scale described in section  2 ,",
    "these patches disappear ( fig.[pn0367ff_med_0]b ) . the data , however , are still dominated by detector noise .",
    "this noise can be suppressed by more than one order of magnitude at 20  adu ( fig.[pn0367ff_med_0]c ) with the method described in section  3 .",
    "although the 20  adu images are well suited for performing and verifying the corrections , the spectral bandwidth is too small to see diffuse x  ray emission from the vela region . in order to demonstrate",
    "the improvement in the low  energy x  ray data , figs.[pn0367ff_med_1]a - c show images for the 120200  ev energy band , corresponding to the steps illustrated in figs.[pn0367ff_med_0]a - c , the cleaned image ( fig.[pn0367ff_med_1]c ) reveals that there is indeed diffuse x  ray emission present , which is , however , lost in the detector noise if no correction is applied ( fig.[pn0367ff_med_1]a ) .",
    "the cleaning in this energy range is substantial : 2/3 of the original events at 120200  ev were suppressed as due to detector noise .",
    "fig.[pn0367ff_med_2]a shows an image of all the events which were been removed , in the same intensity scale as fig.[pn0367ff_med_1]c .",
    "while these methods make it possible to extend the useful energy range down to @xmath26 , there is a constraint which can not be avoided : the combined effects of charge transfer losses and variations in the gain of the 768 amplifiers cause an increase of the local low energy threshold ( 20  adu at readout , corresponding to an instrumental energy of 100  ev ) for specific areas on the detector .",
    "this is illustrated in fig.[pn0367ff_med_2]b , which demonstrates that not all areas of the detector are sensitive to energies below 120  ev .",
    "homogeneous sensitivity across the whole detector is reached at energies above @xmath27 ( fig.[pn0367ff_med_2]c ) .",
    "all the images shown so far were obtained at energies below 200  ev . however , the improvement in data quality is not restricted to this energy range .",
    "comparison of the spectra obtained before and after the correction ( fig.[plspc7 ] ) indicates that the detector noise is suppressed up to @xmath20 ( corresponding to 80  adu ) , where it becomes negligible ( cf.fig.[offmp1a ] ) .",
    "the high sensitivity of xmm epic pn makes it possible to produce several narrow  band images of the vela snr region below 1  kev .",
    "figure [ vela_samples ] shows exposure corrected images derived from the corrected and cleaned data set in the energy bands indicated in fig.[plspc7]a .",
    "these images reveal a stunning variety of complex x  ray emission , which changes considerably with energy , even in this small 0.11 .",
    "kev spectral range . due to the improved spectral resolution of xmm compared to rosat , emission from the north ",
    "west rim of the young supernova remnant rxj0852.0 - 4622 , which is visible in the rosat data only above 1.3  kev , is already obvious at energies above @xmath28 .",
    "r.  hartmann , g.  d. hartner , u.  g. briel , k.  dennerl , f.  haberl , l.  strueder , j.  truemper , e.  bihler , e.  kendziorra , j.  e. hochedez , e.  jourdain , p.  dhez , p.  salvetat , j.  m. auerhammer , d.  schmitz , f.  scholze , and g.  ulm , `` quantum efficiency of the xmm pn - ccd camera , '' in _ proc .",
    "3765 , p. 703 - 713 , euv , x - ray , and gamma - ray instrumentation for astronomy x , oswald h. siegmund ; kathryn a. flanagan ; eds .",
    "_ , pp .  703713 , oct . 1999 .",
    "f.  jansen , d.  lumb , b.  altieri , j.  clavel , m.  ehle , c.  erd , c.  gabriel , m.  guainazzi , p.  gondoin , r.  much , r.  munoz , m.  santos , n.  schartel , d.  texier , and g.  vacanti , `` xmm - newton observatory . i. the spacecraft and operations , '' a&a * 365 * , pp .",
    "l1l6 , jan ."
  ],
  "abstract_text": [
    "<S> high quantum efficiency over a broad spectral range is one of the main properties of the epic pn camera on  board xmm - newton . </S>",
    "<S> the quantum efficiency rises from @xmath0 at 0.2  kev to @xmath1 at 1  kev , stays close to 100% until 8  kev , and is still @xmath2 at 10  kev @xcite . </S>",
    "<S> the epic pn camera is attached to an x  ray telescope which has the highest collecting area currently available , in particular at low energies ( more than 1400  @xmath3 between 0.1 and 2.0  kev)@xcite . </S>",
    "<S> thus , this instrument is very sensitive to the low  energy x  ray emission . </S>",
    "<S> however , x  ray data at energies below @xmath4 are considerably affected by detector effects , which become more and more important towards the lowest transmitted energies . </S>",
    "<S> in addition to that , pixels which have received incorrect offsets during the calculation of the offset map at the beginning of each observation , show up as bright patches in low  energy images . here </S>",
    "<S> we describe a method which is not only capable of suppressing the contaminations found at low energies , but which also improves the data quality throughout the whole epic pn spectral range . </S>",
    "<S> this method is then applied to data from the vela supernova remnant . </S>"
  ]
}