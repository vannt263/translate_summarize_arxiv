{
  "article_text": [
    "time - dependent density - functional theory ( tddft ) calculations are currently enjoying a large popularity due to their efficiency and success in describing low - lying excitation energies in molecular systems @xcite .",
    "in addition , many applications have been investigated with tddft .",
    "examples include electronic transport @xcite , nonlinear optical response @xcite , or atoms and molecules in strong laser fields @xcite . in the latter cases ,",
    "the time - dependent kohn - sham ( tdks ) equations are usually evolved in real - time",
    ". however , the majority of these studies pertains to the description of closed quantum systems , since the corresponding tdks equations describe a set of n particles evolving coherently in time .",
    "on the other hand , most experimental situations involve some level of energy dissipation and/or decoherence induced by either some environments to which the given system is coupled , or the measurement apparatus itself which necessarily projects non - unitarily the state of the system onto states of the observables .",
    "this is generally true for both electrons and ions , so that a first - principles description of their coupled dynamics in the presence of one or more environments is of fundamental importance in order to describe phenomena and compare with experiments . at this point , it is worth noting that present quantum molecular dynamics ( qmd ) approaches , ( e.g. , the born - oppenheimer , ehrenfest or car - parrinello methods ) either do not allow excited states dynamics ( born - oppenheimer and car - parrinello methods ) or , if they do ( e.g. , ehrenfest qmd ) , they do not permit electronic coupling to external environments . indeed , in all these approaches , energy dissipation and thermal coupling to the environment are usually described with additional thermostats coupled directly to the classical nuclear degrees of freedom , which fall short of describing the numerous physical phenomena associated with decoherence and energy dissipation . in order to overcome these shortcomings ,",
    "we have recently introduced a novel time - dependent density functional approach based on stochastic time - dependent kohn - sham equations @xcite , where we allow the coupling of both electrons and ( in principle quantum ) ions with external baths .",
    "this approach - we have named stochastic quantum molecular dynamics ( sqmd ) - extends the previously introduced stochastic time - dependent - current density - functional theory ( stdcdft )  @xcite to the coupled dynamics of electrons and ions .",
    "the latter was formulated to account for electrons interacting with external environments , without however including atomic motion .",
    "therefore , sqmd combines and improves on the strengths of stdcdft and present qmd methods by greatly expanding the physical range of applications of these methods .",
    "clearly , from a practical point of view the present approach suffers - like all density - functional theory ( dft ) based methods - from our limited knowledge of the properties of the exact exchange - correlation functional .",
    "furthermore , in the present case , the exact functional depends not only on the electronic degrees of freedom , but also on the ionic and bath(s ) degrees of freedom @xcite .",
    "nevertheless , due to the weak system - bath(s ) coupling assumption of the present theory , as well as the limited number of systems where quantum nuclear effects are of disproportionate importance , we may start by considering the limit of sqmd to classical nuclei and adopt the available functionals of standard closed - system tddft . like in any other practical application of dft , it is the predictions that we obtain and comparison with experiments that will be the ultimate judge of the range of validity of the approximate functionals used .    in ref .",
    "@xcite we have outlined the details of the proof of the theorem at the core of sqmd , and provided a simple example of the relaxation dynamics of a finite system ( a molecule ) prepared in some excited state and embedded in a thermal bath . however , there are some technical details behind an actual implementation of this approach we have not reported yet , and which are nonetheless important if one is interested in using this method for practical computations . in this work we then present all the technical aspects for a practical implementation and use of sqmd . in addition",
    ", we present the theory behind its applicability to extended systems which is of great importance in the study of decoherence and energy relaxation in bulk systems and surfaces .",
    "we are in the process of implementing sqmd for extended systems and we will report these results in a forthcoming publication @xcite .    the paper is organized as follows . in section [ sec : theory ] we give an introduction to the theory of stochastic quantum molecular dynamics . for completeness , this includes general aspects of open quantum systems as well as the basic theorem of sqmd . in section [ sec : simulation_algorithms ]",
    "we discuss the aspects of a practical implementation of sqmd .",
    "finally , in section [ sec : applications ] we illustrate with some examples the application of sqmd to finite systems with and without ionic motion , and outline its extension to periodic systems .",
    "conclusions are reported in section [ sec : conclusions ] .",
    "in the following , we consider an electron - ion many - body system coupled to a bosonic bath . for simplicity , we will consider only a single bath , but the formulation is trivially extended to the case of several environments .",
    "the total hamiltonian of the entire system is then    @xmath0    our system of interest is described by the many - body hamiltonian @xmath1 and the environment degrees of freedom are given in terms of @xmath2 .",
    "the interaction of the system with the environment is given by the hamiltonian @xmath3 and is assumed to be weak in the sense that a perturbation expansion in terms of this coupling can be performed .",
    "with @xmath4 we denote the corresponding coupling parameter for the system - bath interaction .    the total system described by the hamiltonian @xmath5 follows a unitary time - evolution , which can be formulated for pure states either in terms of the time - dependent schrdinger equation ( tdse ) , with @xmath6 @xmath7 or , alternatively for mixed states , in terms of the liouville - von neumann equation @xmath8,\\ ] ] where @xmath9 is the statistical operator .",
    "since @xmath5 is a many - body hamiltonian and we have to deal , in principle , with infinitely many degrees of freedom ( due to the bath ) it is not possible to solve eq .",
    "( [ eq : tdse ] ) or ( [ eq : lvn ] ) in practice , except for a few simple model cases .",
    "in addition , in most cases of interest the microscopic knowledge about the bath is limited and only its macroscopic thermodynamic properties are known , e.g. , one typically assumes that the bath is in thermal equilibrium .",
    "however , we are only interested in the dynamics of the system degrees of freedom .",
    "it is therefore desirable to find an effective description for the system only .    to accomplish this",
    "we may trace out the bath degrees of freedom at the level of the statistical operator , namely we perform the operation @xmath10 , where @xmath11 is called the reduced statistical operator of system @xmath12 .",
    "it is worth pointing out here that this procedure does not generally lead to a closed equation of motion for the reduced statistical operator and one needs further approximations .",
    "depending on the approximations involved , one may arrive at an effective quantum master equation for the reduced density operator @xmath11 @xcite . as we will discuss later",
    ", this approach has some drawbacks when used within a density - functional formulation , both fundamental - in view of the theorems of dft - and practical , since solving for the density matrix is computationally more demanding than solving directly for state vectors .",
    "we therefore take here a different route . instead of working with a derived / composite quantity like the statistical operator ,",
    "we summarize briefly how the bath degrees of freedom can be traced out directly at the level of the wavefunction .",
    "the derivation that follows has been reported elsewhere in the literature ( see , e.g. , ref .",
    "we repeat some steps here for completeness and to clarify our starting point .    to this end",
    "let us consider the set of eigenfunctions @xmath13 of the bath hamiltonian @xmath14 with @xmath15 the bath s coordinates ( including possibly spin ) , and expand the total wavefunction of eq .",
    "( [ eq : tdse ] ) in the complete set of orthonormal states formed by @xmath13 , namely  ) is such that expansion ( [ eq : totalwavefunctionexpansion ] ) becomes exact . ]",
    "@xmath16    with @xmath17 some functions ( not necessarily normalized ) in the hilbert space of the system @xmath12 .",
    "in order to see that in the presence of a bath the functions @xmath17 form a statistical ensemble describing the properties of the subsystem @xmath12 , let us proceed as follows . for a general observable @xmath18 of the system @xmath12",
    "we find after simple algebra ( and using the orthonormality of the bath states @xmath19 ) @xmath20 let us now normalize the functions @xmath17 by writing @xmath21 with @xmath22 which , according to eq .",
    "( [ eq : totalwavefunctionexpansion ] ) , is nothing other than the probability for the bath to be in the state @xmath19 .",
    "we can now define the following statistical operator @xmath23 and immediately recognize that the average  ( [ averageas ] ) can be re - written as @xmath24 namely , due to the interaction with the bath , the system @xmath12 is necessarily in a mixture of states defined by the macrostate @xmath25 .",
    "we thus expect that the equation of motion for the representative wave - function @xmath26 of the subsystem @xmath12 to be `` naturally '' stochastic , namely we expect to find an equation of motion that provides the macrostate @xmath25 .    in order to show this we follow the feshbach projection - operator method @xcite and define the following projection operators @xmath27 where @xmath28 is the identity in the hilbert space of the system .",
    "the rationale behind the choice of the above operators is to obtain the equation of motion of a representative coefficient @xmath17 .    by acting with these projection operators on the many - body tdse for the combined system and bath in eq .",
    "( [ eq : tdse ] ) we arrive at @xmath29 @xmath30 equation  ( [ qproj ] ) can be formally solved . inserting the result back into eq .",
    "( [ pproj ] ) we obtain @xmath31 where we have omitted the index @xmath32 for brevity . the first term on the right hand side of eq .",
    "( [ eq : effectivesystemwavefunction ] ) contains only projections on the system manifold , and describes the coherent evolution of the system degrees of freedom .",
    "the second term is a source term that carries a dependence on initial conditions ( @xmath33 are the initial conditions of all system s states except the one we are considering ) , and the third term on the right hand side is a memory term that is recording the history of the time evolution .",
    "note that , up to this point , we have made no approximations , i.e. , the time evolution given by eq .",
    "( [ eq : effectivesystemwavefunction ] ) is still fully coherent .",
    "however , the solution of eq .",
    "( [ eq : effectivesystemwavefunction ] ) is very involved and , apart from model systems , not feasible in practice .",
    "furthermore , a solution would require the initial conditions for all the microscopic degrees of freedom of the bath .",
    "these can not all be determined simultaneously by a measurement . in practice ,",
    "one rather has only knowledge about macroscopic thermodynamic properties of the bath , like temperature and pressure .",
    "it is therefore common to perform the following additional approximations which are motivated by the form of the system - bath interaction and the thermodynamic properties of the bath : ( i ) due to the assumed weak coupling between system and bath the source and memory terms are expanded up to second order in the system - bath coupling parameter @xmath4 , ( ii ) the bath and subsystem @xmath12 are assumed to be uncorrelated at the initial time , ( iii ) a random phase approximation is performed for the phases in the source and memory terms ) . ] , and ( iv ) it is assumed that the bath degrees of freedom form a dense energy spectrum and are in local thermal equilibrium characterized by @xmath34 where @xmath35 .",
    "let us then write the interaction hamiltonian as @xmath36 where @xmath37 and @xmath38 are - in the most general case - many - body operators that act on the hilbert spaces of the system and bath , respectively . in the following",
    "we will also assume that the average of the operators @xmath38 vanishes on the n - th eigenstate of the bath , namely @xmath39 if this is not the case we simply redefine the system hamiltonian via @xmath40 and the interaction hamiltonian as @xmath41 .",
    "the term @xmath42 thus contributes to the unitary evolution of the system by renormalizing its eigenvalues ( a typical example of this is the lamb shift @xcite ) .    with these approximations in place ,",
    "the source term can be regarded as a stochastic driving term .",
    "this is because , the system s state we have singled out in eq .",
    "( [ eq : projectionoperators ] ) now interacts with a ( practically infinite ) large set of bath states densely distributed in energy .",
    "the previously coherent equation eq .",
    "( [ eq : effectivesystemwavefunction ] ) then has to be regarded as a non - markovian stochastic schrdinger equation for the general state vector @xmath43 @xcite @xmath44    & -i\\lambda^2 \\sum_{\\alpha\\beta } \\int_0^t c_{\\alpha\\beta}(t-\\tau )      \\hat s^\\dagger_\\alpha e^{-i \\hat h_s(t-\\tau ) } \\hat s_\\beta \\psi(\\tau ) d\\tau \\\\   & + { \\cal o}(\\lambda^3 ) , \\end{split}\\ ] ] where @xmath45 are stochastic processes with zero ensemble average , @xmath46 , and correlation functions @xmath47 @xmath48 equation  ( [ eq : nonmarkovianstochastictdse ] ) is a general non - markovian stochastic schrdinger equation .",
    "indeed , it still contains a time - integral over the past dynamics which is originating from the memory term of eq .",
    "( [ eq : effectivesystemwavefunction ] ) .",
    "even though the theorem of sqmd could be formulated with non - markovian baths we will focus in the following only on the markovian limit @xmath49 namely , we consider baths that are @xmath50-correlated .",
    "physically , this means that the bath does not retain memory of the interaction with the system which is valid when the typical thermalization time - scales inside the bath are much faster than the thermalization time - scales of the system .",
    "this approximation is well justified for a large number of bath degrees of freedom .",
    "if this assumption does not hold , one has to resort to the solution of the more involved eq .",
    "( [ eq : nonmarkovianstochastictdse ] ) .    by inserting the markov approximation , eq .",
    "( [ eq : markovianapproximation ] ) , into eq .",
    "( [ eq : nonmarkovianstochastictdse ] ) we then arrive at the stochastic schrdinger equation in the born - markov limit @xmath51 where the parameter @xmath4 has been absorbed in the operators @xmath52 . the first term on the right hand side of eq .",
    "( [ eq : markoviantdse ] ) is the usual unitary evolution of the system under the action of the system hamiltonian @xmath1 , the second term describes the dissipation effects introduced by the bath and would indeed make the probability density generated by @xmath26 decay in time .",
    "the last term , however , introduces fluctuations so that the norm of the state vector @xmath26 averaged over the ensemble is conserved , namely @xmath53 .    due to the stochastic nature of this equation , the stochastic process described by eq .",
    "( [ eq : markoviantdse ] ) has to be simulated in terms of an ensemble of state vectors @xmath26 .",
    "each member @xmath26 of the ensemble evolves differently in time due to the random variables @xmath54 in the third term on the rhs .",
    "( [ eq : markoviantdse ] ) .",
    "if we consider an initial mixed state @xmath55 where @xmath56 are the probabilities ( with @xmath57 ) of finding the state @xmath58 in the ensemble , the statistical average over all members of the ensemble allows us to construct the reduced density operator for the system degrees of freedom @xmath59 here , we use the symbol @xmath60 to indicate the statistical average over all members of the ensemble of state vectors @xmath61 , namely the ensemble @xmath62 of state vectors with initial conditions @xmath58 .    the expectation value of a general physical observable of the system @xmath12 , @xmath18 ,",
    "can then be computed as in eq .",
    "( [ averageas1 ] ) , i.e. , @xmath63 where the last step shows that the construction of @xmath64 is not actually required : we can compute expectation values of observables directly from the wave - functions in the usual way , followed by a statistical average over all members of the ensemble of state vectors .",
    "it is also important to note that this approach provides _ directly _ the _ full _ distribution of the given observable at any given time , provided we can compute a large enough set of realizations of the stochastic processes @xmath45 ( for an example of this see , e.g. , ref .",
    "@xcite ) . from this distribution",
    "we can then compute all higher moments and/or cumulants ( e.g. , the variance , skewness , etc . )",
    "some of which are directly accessible experimentally .      for many - body hamiltonians which are not _ stochastic",
    "_ , namely they do not depend on internal degrees of freedom - hamiltonians @xmath65 $ ] - or do not depend explicitly on some stochastic field , like e.g. , a stochastic thermostat @xcite , it is possible to derive the lindblad equation @xcite from the stochastic schrdinger equation ( [ eq : markoviantdse ] ) .    for notational clarity , let us denote in the following discussion with @xmath66 a _ single member _ of the stochastic ensemble @xmath67 . if we consider for simplicity the case of a single bath operator in eq .",
    "( [ eq : markoviantdse ] ) , and observe that in the markovian limit @xmath68 is a wiener process @xcite with properties @xmath69 and @xmath70 , we can formulate the stochastic schrdinger equation ( [ eq : markoviantdse ] ) for a single bath in differential form according to @xmath71dt -i \\hat s |\\psi \\rangle dw .",
    "\\label{eq : stochasticse - fin}\\ ] ]    next , we employ it stochastic calculus in order to compute the following differential @xmath72 unlike in normal calculus , we also have to keep the third term in the product rule above .",
    "this becomes necessary , since a statistical average over the wiener increment @xmath73 is proportional to @xmath74 , which will cause terms quadratic in @xmath75 to contribute to _ first _ order in @xmath74 .",
    "inserting eq .",
    "( [ eq : stochasticse - fin ] ) and its hermitian conjugate into eq .",
    "( [ eq : differential_product ] ) we arrive after elementary algebra at @xmath76 dt      - \\frac{1}{2 } \\big\\ { \\hat s^\\dagger \\hat s , |\\psi\\rangle\\langle\\psi| \\big\\ } dt \\nonumber \\\\    & + \\hat s |\\psi\\rangle\\langle\\psi| \\hat s^\\dagger",
    "dw^\\dagger dw \\nonumber \\\\    & + \\hat s |\\psi\\rangle\\langle\\psi|",
    "\\hat h_s\\ , dwdt + \\mbox{h.c . } \\\\    & + \\frac{i}{2 } \\hat s |\\psi\\rangle\\langle\\psi|\\hat s^\\dagger \\hat s\\ , dwdt      + \\mbox{h.c . }",
    "\\\\    & + \\hat h_s|\\psi\\rangle\\langle\\psi| \\hat h_s dt^2      + \\frac{1}{4 } \\hat s^\\dagger \\hat s |\\psi\\rangle\\langle\\psi|",
    "\\hat s^\\dagger \\hat s dt^2 \\nonumber \\\\    &   + \\frac{i}{2 } \\big\\ { \\hat h_s , |\\psi\\rangle\\langle\\psi|\\hat s^\\dagger \\hat s \\big\\ } dt^2 . \\nonumber\\end{aligned}\\ ] ]    in order to construct the statistical operator from the state vectors of the statistical ensemble @xmath67 , we perform in the next step the statistical average over all members in the ensemble , i.e. @xmath77 taking the properties @xmath69 , @xmath78 and @xmath70 of the stochastic process @xmath79 into account , we see that only the second and third line in eq .",
    "( [ eq : lindblad_differential ] ) contribute to first order in @xmath74 and we arrive at @xmath80 } dt     - \\frac{1}{2 }   \\big\\ { \\hat s^\\dagger \\hat s , \\overline{|\\psi\\rangle\\langle\\psi| } \\big\\ } dt \\nonumber \\\\   & + \\hat s \\overline{|\\psi\\rangle\\langle\\psi| } \\hat s^\\dagger dt + o(dt^{2}).\\end{aligned}\\ ] ] at this point , note that this equation of motion is not necessarily closed for @xmath81 because the first term on the right hand side of eq .",
    "( [ eq : average_dm ] ) is not equal to the commutator @xmath82 $ ] _ unless _",
    "@xmath83 $ ] , or @xmath1 does not depend on any stochastic field , or the system is in a pure state at all times - which would amount to the case @xmath84 . depended on internal degrees of freedom ,",
    "i.e. , @xmath85 $ ] . in that case , the average over the statistical ensemble in the second and third terms on the right hand side of eq .",
    "( [ eq : average_dm ] ) has to be performed over the operators @xmath86 as well .",
    "] however , if the hamiltonian is stochastic , one has to deal with an _ ensemble of hamiltonians _ , and the statistical average of the first term on the right hand side of eq .",
    "( [ eq : average_dm ] ) involves also a statistical average over these hamiltonians ( see , e.g. , refs .",
    "@xcite ) .    for the moment",
    "being , let us assume that @xmath65 $ ] and furthermore that the hamiltonian @xmath1 does not depend on some external stochastic field .",
    "in this case we find @xmath87 -\\frac12 \\left\\ { \\hat s^\\dagger",
    "\\hat s , \\hat \\rho_s \\right\\ } + \\hat s \\hat \\rho_s\\hat s^\\dagger \\label{density - matrix}\\ ] ] which is the well - known quantum master equation in born - markov limit ( or lindblad equation if the bath operators and the hamiltonian , do not depend on time )  @xcite .",
    "we have thus shown that the stochastic schrdinger equation of eq .",
    "( [ eq : markoviantdse ] ) and the master equation ( [ density - matrix ] ) lead to the same statistical operator , if and only if the hamiltonian is not stochastic .",
    "however , in order to prove any dft theorem one is led to consider the dynamics of the actual many - body system and that of any _ auxiliary _ one ( including the kohn - sham system ) with different interaction potentials , but reproducing the exact many - body density or current density .",
    "it is then at this stage that a choice has to be made - in the case of a many - body system open to one or more environments - regarding the basic equation of motion to work with .",
    "if we choose to work with a quantum master equation of the type ( [ density - matrix ] ) , then we are _ assuming _ from the outset that the kohn - sham hamiltonian is not stochastic .",
    "but this is an hypothesis that constitutes part of the final thesis , namely we have to prove that this statement is correct , not assume it _ a priori _ @xcite .",
    "this issue does not arise with the stochastic schrdinger equation ( [ eq : markoviantdse ] ) , because in that case we can consider all possible hamiltonians , including those that are stochastic .",
    "in addition to the above important point , we also recall that for arbitrary time - dependent operators @xmath88 and @xmath89 , eq .",
    "( [ density - matrix ] ) may not yield a positive - definite statistical operator at all times ( see , e.g. , ref .",
    "this is a major limitation in practical calculations , since loss of positivity ( which precludes a statistical interpretation of physical observables ) should then be checked at every instant of time .",
    "note that such a limitation does not pertain to the stochastic schrdinger equation which can be equally applied to arbitrary time - dependent operators without possible loss of positivity of the ensuing statistical operator .",
    "therefore , the above two issues make the equation of motion of the statistical operator a less solid starting point for a dft theory of open quantum systems .",
    "we are now in a position to state the basic theorem of sqmd . before doing this",
    "let us define the basic quantities we work with .",
    "the many - body system we are interested in consists of @xmath90 electrons with coordinates @xmath91 and @xmath92 nuclei , where each nuclear species @xmath93 comprises @xmath94 particles with charges @xmath95 , masses @xmath96 , @xmath97 , and coordinates @xmath98 , respectively .",
    "their dynamics - subject to an arbitrary classical electromagnetic field , whose vector potential is @xmath99 - is described by the hamiltonian @xmath100 where @xmath101 and @xmath102 are the kinetic energies of electrons and ions , with velocities @xmath103/m$ ] and @xmath104/m_\\alpha$ ] , respectively and @xmath105 , @xmath106 the external potentials acting on electrons and ions .",
    "the particle - particle interactions are given by @xmath107 we then define the charge current operator @xmath108 for the electrons , and @xmath109 for the ions .",
    "the total particle and current density operators of the system can then be written as @xmath110 for the particle number , and @xmath111 for the current density . to simplify the notation we have also denoted with @xmath112 the combined set of electronic and nuclear coordinates , and we use the combined index @xmath113 for the nuclear species .",
    "we now formulate the theorem for a single bath operator .",
    "it trivially extends to many operators .",
    "_ theorem. _ for a given bath operator @xmath86 , many - body initial state @xmath114 ( not necessarily pure ) and external vector potential @xmath115 , the dynamics of the stochastic schrdinger equation in eq .",
    "( [ eq : markoviantdse ] ) generates ensemble - averaged total particle and current densities @xmath116 and @xmath117 . under reasonable physical assumptions , any other vector potential @xmath118 ( but same initial state and bath operator ) that leads to the same ensemble - averaged total particle and current density ,",
    "has to coincide , up to a gauge transformation , with @xmath115 .",
    "a sketch of the proof of this theorem can be found in the original paper  @xcite .",
    "we thus refer the reader to this publication for more details . here",
    ", we just mention an important point . as in ref .",
    "@xcite we are implicitly assuming that given an initial condition , bath operator , and ensemble - averaged current density , a unique ensemble - averaged density can be obtained from its equation of motion : @xmath119 if we write this equation in the compact form @xmath120 the above amounts to saying that @xmath121 is a functional of @xmath116 and @xmath117 , or better of @xmath117 alone , and that eq .",
    "( [ eq : contopena ] ) admits a unique physical solution .",
    "therefore , unlike what has been recently argued  @xcite , the density is not independent of the current density , and our theorem establishes a one - to - one correspondence between current density and vector potential . if this were not the case , namely that the particle and current densities were _ independent _ functions , then @xmath121 would not be completely determined by the sole knowledge of @xmath116 and @xmath117 @xcite .      at this stage",
    "we may formulate a kohn - sham ( ks ) scheme of sqmd where an exchange - correlation ( xc ) vector potential @xmath122 - functional of the initial states , bath operator(s ) , and ensemble - averaged current density - acting on non - interacting species , allows to reproduce the exact ensemble - averaged density and current densities of the original interacting many - body system .",
    "the ensuing charge and current densities would contain _ all _ possible correlations in the system - if the exact functional were known .",
    "however , in the present case , we could construct several schemes - based on corresponding theorems - by defining different densities and current densities .",
    "for instance , we could collect all nuclear densities into one quantity as done in ref .",
    "this , by no means is a limitation of this approach .",
    "rather , it allows us to  specialize \" the given schemes to specific physical problems .",
    "instead , a much more serious limitation relates to the construction of xc functionals for the chosen scheme .",
    "therefore , as anticipated in the introduction , we will restrict ourselves here to the limit of classical nuclei .",
    "let us then assume that we know the vector potential @xmath123 that generates the exact current density in the non - interacting system . by construction ,",
    "the system follows the dynamics induced by the stochastic schrdinger equation ( for a single bath operator ) @xmath124 where @xmath125 is a slater determinant of single - particle wave - functions and @xmath126 ^ 2}{2 m } \\label{ksh}\\ ] ] is the hamiltonian of non - interacting particles with @xmath127 where @xmath128 is the vector potential applied to the _ true _ many - body system , and @xmath129 is the vector potential whose only scope is to mimic the correct dynamics of the ensemble - averaged current density , and we have lumped in it also the hartree interaction potential in addition to the xc one .",
    "all these potentials depend on the instantaneous classical nuclear coordinates @xmath130 .",
    "we immediately note that for a general many - body bath operator acting on many - body states one can not reduce eq .",
    "( [ ksse ] ) to a set of independent single - particle equations , as done in the usual dft schemes for closed systems .",
    "in other words , this would generally require the solution of an equation of motion of slater determinants , which is still computationally quite demanding . to see this point , suppose we have @xmath131 particles and retain @xmath132 single - particle states .",
    "we then need to solve for @xmath133 elements of the state vector ( with @xmath134 and the @xmath135 comes from the normalization condition ) .",
    "in addition , one has to average over an amount , call it @xmath136 , of different realizations of the stochastic process .",
    "the problem thus scales exponentially with the number of particles .",
    "if this seems prohibitive let us also recall that a density - matrix formalism would be even more computationally demanding , requiring the solution of @xmath137 coupled differential equations , even after taking into account the constraints of hermiticity and unit trace of the density matrix .",
    "it was recently suggested in ref .",
    "@xcite that for operators of the type @xmath138 , namely operators that can be written as sum over single - particle operators ( like the density or current density ) , the expectation value of @xmath139 over a many - particle non - interacting state with dissipation can be approximated as a sum of single - particle expectation values of @xmath140 over an ensemble of @xmath131 single - particle systems with specific single - particle dissipation operators .",
    "in particular , it was found that the approximate single - particle scheme provides an excellent approximation for the current density compared to the exact many - body calculation .",
    "@xcite we refer the reader to ref .",
    "@xcite for the numerical demonstration of this scheme and its analytical justification .    from now on , for numerical convenience , we will then adopt the same _ ansatz _ which in the present case reads , @xmath141 with @xmath142 single - particle ks states solutions of @xmath143 with @xmath144 an operator acting on single particle states .",
    "+      the single - particle operators @xmath145 in eq .",
    "( [ eq : kssesp ] ) that we employ in the present work are given by the following time - independent projectors @xmath146 where @xmath147^{-1}$ ] denotes the usual fermi - dirac distribution and @xmath148 denote pauli blocking factors .",
    "the projectors in eq .",
    "( [ eq : bath_operators ] ) cause a relaxation of the system back to the ground - state orbitals @xmath149 with a rate given by the rate constants @xmath150 ( generally space and orbital dependent ) , while the temperature in the fermi factor is modeling the temperature of the bath .    for the present paper ,",
    "we further assume that the rates are independent of space and orbital indexes , i.e , @xmath151 , where @xmath152 is a relaxation time .",
    "the bath operators of this model are sufficient for the illustration purposes of the present work but they clearly provide only a simplified picture of the full system - bath interaction .",
    "we emphasize here , that a rigorous form of the bath operators and the associated relaxation rates can always be derived from the microscopic form of the complete hamiltonian of system and bath and their mutual interaction , eq .",
    "( [ eq : totalhamiltonian ] ) .",
    "for example , in the case of a phonon bath , the system - bath interaction hamiltonian could be taken into account in terms of e.g. , a frhlich interaction . in that case",
    "the relaxation rates can be extracted from the electron - phonon coupling matrix elements .",
    "the situation is much simpler is the case of a photon bath , where the einstein rates of stimulated and spontaneous emmission can be used .",
    "once we have the single - particle ks states and the corresponding slater determinant @xmath153 at hand we can compute the forces on the nuclei as @xcite @xmath154 for each realization of the stochastic process .  )",
    "is _ not _ the expression for the force one would obtain from the hellmann - feynman theorem .",
    "this is because we are considering a system out of equilibrium .",
    "rather , eq .  ( [ force ] ) is the total time derivative of the average of the ion momentum operator over the state of the system ( see , e.g. , ref .",
    "@xcite ) . ]",
    "note , that this force is stochastic in nature since the wavefunctions in the above expectation value are solutions of a stochastic schrdinger equation .",
    "since approximations to the xc functional of the kohn - sham hamiltonian may make the latter stochastic then the force one would obtain using a density matrix approach - e.g. , by solving the quantum master equation  ( [ density - matrix ] ) - would not be necessarily equal to the average force obtained from eq .",
    "( [ force ] ) by averaging over the ensemble of realizations .",
    "we have now outlined the general theory behind sqmd and we are ready to move on to the description of its actual implementation .",
    "the standard real - time propagation of the kohn - sham orbitals for a closed quantum system is based on numerical approximations for the time - ordered evolution operator @xmath155 there are several approaches employed in standard tddft computer packages , like , e.g. , octopus @xcite to evaluate eq .",
    "( [ eq : time_evolution_operator ] ) numerically . here",
    ", we have chosen the magnus propagator as basic building block for our stochastic simulations .",
    "@xcite the magnus series @xcite provides an exact expression for the time - evolution operator ( [ eq : time_evolution_operator ] ) as a _ time - unordered _ exponential of so called magnus operators @xmath156 in the form @xmath157 where the @xmath158 are given in terms of time - integrals over nested commutators of the hamiltonian at different points in time @xmath159",
    "d\\tau_2 d\\tau_1 \\\\ & \\vdots \\end{split}\\ ] ] the time - integrals can be evaluated numerically with e.g. , a gauss - legendre quadrature . in the simplest case , which is accurate up to second order in the time - step ,",
    "one arrives at the exponential midpoint rule @xmath160 higher - order approximations can be easily derived from the magnus series and appropriate quadrature points and weights , but experience shows that the second order gives a good balance between speed and accuracy for many applications . in the present work we use this approximation for the piecewise deterministic evolution that we are going to introduce in the next section .",
    "we are now left with the actual solution of the stochastic schrdinger equation ( [ eq : markoviantdse ] ) . in past work ,",
    "this has been done by directly integrating this equation with standard approaches - e.g. , with appropriately modified runge - kutta methods ( see e.g.  @xcite and references therein ) .",
    "these approaches are reasonable when we deal with a small number of accessible states or short propagation times .",
    "however , they become increasingly unstable with an increasing number of states or for very long timescales , which is the case for realistic systems , like molecular structures , surfaces or solids . as an alternative ,",
    "we have thus adopted the quantum jump algorithm pioneered in the work of disi @xcite , dalibard @xcite , zoller and gardiner and collaborators @xcite as well as carmichael @xcite . at the price of introducing the propagation of auxiliary states ,",
    "the quantum jump algorithm provides improved stability for systems with a large number of states / particles and , due to the piecewise deterministic evolution , also a stable propagation scheme for long timescales .",
    "this algorithm works as follows .",
    "consider the deterministic time - evolution given by the follwing norm - preserving non - linear schrdinger equation @xmath161 where the non - hermitian hamiltonian @xmath162 is given by @xmath163 as before , the operators @xmath1 and @xmath164 denote the hermitian system hamiltonian and the bath operator of eq .",
    "( [ eq : markoviantdse ] ) .",
    "the main objective of the quantum jump algorithm is to sample the stochastic process given by eq .",
    "( [ eq : markoviantdse ] ) in terms of a piecewise deterministic evolution , i.e. a set of deterministic time intervals generated by the evolution of eq .",
    "( [ eq : deterministictimeevolution ] ) and action of the bath operator @xmath86 between two consecutive time intervals . a central ingredient of the algorithm is a waiting - time distribution which determines when the jumps ( i.e. , actions of the bath operator ) appear throughout the simulation .    in order to sample the unknown waiting - time distribution , an auxiliary set of wavefunctions @xmath165",
    "is introduced .",
    "the wavefunctions @xmath165 are propagated with the non - hermitian hamiltonian @xmath166 alongside the actual states @xmath167 .",
    "since the auxiliary system evolves with a non - hermitian hamiltonian , the norm of the states @xmath165 is not preserved .",
    "it can be shown @xcite that the decay of the norm of the auxilary wavefunctions is related to the waiting - time distribution .",
    "the algorithm makes use of this fact and directly samples the waiting - time distribution on the fly from the norm decay .    in terms of the kohn - sham system ,",
    "the steps of the algorithm can then be summarized as follows    * draw a uniform random number @xmath168 $ ] for the kohn - sham slater determinant * propagate @xmath131 auxiliary orbitals @xmath165 under the non - hermitian dynamics @xmath169   \\phi_j^{\\rm aux } , \\qquad j=1\\ldots n \\nonumber\\ ] ] * propagate the orbitals @xmath170 , @xmath171 of the kohn - sham system with a norm - conserving dynamics according to @xmath172 \\psi_j^{\\rm ks } \\nonumber\\ ] ] * if the norm of the kohn - sham slater determinant drops below the drawn random number @xmath173 , act with the bath operator(s ) on the kohn - sham orbitals and update the auxiliary orbitals @xmath174 * go to step 1 )    the piecewise deterministic evolution that is generated by the steps of this algorithm is illustrated schematically in fig .",
    "[ fig : quantum_jump_algorithm ] .    averaging at any given time over an ensemble of stochastic realizations allows then to obtain mean values of any physical observable .",
    "it is also important to realize that we have a full statistical ensemble at hand .",
    "this allows to compute _ distributions _ of observables , higher order moments , cumulants , etc . in this sense",
    "the ensemble of stochastic realizations generated by the stochastic schrdinger equation carries more information than the statistical operator , since the latter is merely a first order moment and higher order moments and cumulants can not be computed easily from the first order moment ( if at all ) .",
    "we also emphasize here , that the interpretation of a single stochastic trajectory is not meaningful : the stochastic realizations have to be considered always as an ensemble .",
    "when averages over the stochastic ensemble are performed , the `` convergence '' of all observables of interest has to be checked carefully by increasing the number of realizations of the stochastic process .",
    "note that without further constraints the action of the bath operator in step 4 ) of the algorithm can in principle lead to a loss of orthogonality .",
    "for example , all orbitals of the slater determinant could relax to the same orbital shape .",
    "the system could loose in this way its fermionic character . in order to maintain the fermionic nature of the kohn - sham state vector",
    ", we have to ensure that the orbitals of the kohn - sham slater determinant remain orthogonal .",
    "to achieve this , we perform an orthogonalization of the orbitals after each action of the bath operators .",
    "this orthogonalization can be thought of as being part of the definition of the action of the operator @xmath86 .    from our numerical experience",
    "so far , the waiting - time distribution seems to follow mainly a single exponential distribution .",
    "it would therefore appear appealing to parametrize this distribution and to draw the waiting times from the analytical expression of the parametrization . in this way",
    "the propagation of the auxiliary states could be avoided and a speedup of the propagation by a factor of two could be gained .",
    "however , it is not clear if the waiting times of the kohn - sham system follow always an exponential distribution . in particular , the shape of the distribution is unknown , when , e.g. , ionic motion is involved , or when the system is subject to strong external electric or magnetic fields .",
    "therefore , to be on the safe side , in the present work we always sample the waiting - time distribution by propagating the auxiliary system .",
    "it is also worth noting that the average over stochastic realizations of the ensemble generally converges faster when the system - bath interaction increases . in the opposite limit",
    "the convergence is slow .",
    "when the system - bath interaction is very weak , only a small damping will be exerted by the @xmath175 term in eq .",
    "( [ phieq ] ) , and hence it takes longer for the norm of the auxiliary wave functions to drop below their waiting times .",
    "this in turn implies that fewer jumps occur and hence more stochastic realizations are required to converge to a smooth observable distribution .",
    "in the last section we have introduced technical details for the quantum jump algorithm that we use to simulate the stochastic process associated with the stochastic kohn - sham equation , eq .",
    "( [ eq : kssesp ] ) . in this section",
    "we apply the algorithm to molecular systems with and without clamped ions . as first example",
    "we consider a situation of clamped ionic coordinates .",
    "as testcase we investigate a ( 1,4)-phenylene - linked zincbacteriochlorin - bacteriochlorin complex . due to an extra mg atom in the left porphyrin ring of the complex",
    "the molecule is not fully symmetric . as a result , the highest - occupied molecular orbital ( homo ) of this molecule",
    "is located on the left porphyrin ring , whereas the lowest - unoccupied molecular orbital ( lumo ) is located on the right porphyrin ring , cf .",
    "[ fig : bacteriochlorin_homo_lumo ] .",
    ", title=\"fig : \" ] , title=\"fig : \" ]     a.u . has been used for the bath operator in the open quantum system case .",
    "[ fig : bacteriochlorin ] ]    this system has been used as a model to study charge - transfer excitations in linear response tddft @xcite . here",
    "instead we consider open and closed system real - time propagation .",
    "we prepare the zincbacteriochlorin - bacteriochlorin complex in an entangled initial - state , where the orbital of the homo is replaced by @xmath176 , \\label{eq : entangled_initial_state}\\ ] ] where @xmath177 and @xmath178 denote the ground - state homo and lumo , respectively . for all other orbitals",
    "the ground - state configuration is used at the initial time .",
    "starting from this excited initial slater determinant the system is then evolved freely in time without any external fields . for the bath operators we employ the model of eq .",
    "( [ eq : bath_operators ] ) introduced in section [ sec : system_bath_interaction_model ] at zero temperature .",
    "the dynamics of the system is illustrated in fig .",
    "[ fig : bacteriochlorin ] where we plot the real part of the homo orbital for different snapshots in time .",
    "the left panel summarizes the closed system evolution and the right panel an ensemble average over 100 stochastic realizations in the open system case .",
    "let us first focus on the closed quantum system case .",
    "due to the entangled initial state in eq .",
    "( [ eq : entangled_initial_state ] ) , the time - dependence of the orbital @xmath179 has mainly oscillatory phase contributions @xmath180 and @xmath181 from the ground - state homo and lumo , respectively .",
    "only small nonlinearities arise due to the dependence of the kohn - sham hamiltonian on the time - dependent density .",
    "since the system is propagated as closed quantum system , the phase oscillations would continue indefinitely .    on the other hand , the open quantum system evolution in the right panel of fig .",
    "[ fig : bacteriochlorin ] shows for @xmath179 a fast relaxation from the entangled initial state back to the homo which is localized on the left porphyrin ring .",
    "if we now imagine computing ehrenfest forces from these orbital contributions , it is clear that the forces will differ qualitatively in the closed and open quantum system cases .",
    "while in the closed quantum system case the forces will be oscillatory , they will show relaxation behavior similar to the orbitals in the open quantum case .",
    "this example emphasizes that the coupling of electronic degrees of freedom to a thermal bath yields _ qualitatively _ different forces compared to standard qmd approaches .",
    "this observation motivates our second example , where we consider a stochastic qmd simulation for a neon dimer . in this case",
    "the ions are not clamped at the equilibrium configuration . instead we use stretched initial positions for the ions of the dimer as initial state for the open and closed system propagation .",
    "if we would treat the ions quantum mechanically , then the bath operators would also act on the nuclear wavefunctions .",
    "however , since we have restricted ourselves here to the limit of classical ions we replace this action of the bath operators by modifying the velocities of the ions . at every occasion when the bath operators act on the electronic wavefunctions we draw new velocities for the ions from a maxwell - boltzmann distribution .",
    "this is a simple approach but can be improved with e.g. , recently introduced stochastic thermostats for the ions @xcite .    in the left panel of figure fig .",
    "[ fig : ion - damping - closed ] we show the ionic positions of the dimer as function of time for a standard ehrenfest tddft closed quantum system evolution . in the right panel",
    "we display for the same initial conditions the open quantum system evolution within sqmd . for the sqmd simulation",
    "we have employed a relaxation time of @xmath182 fs and an average over 100 stochastic trajectories has been performed which results in a smooth decay of the nuclear oscillations .",
    "so far we have considered only finite molecular systems .",
    "however , a large class of applications requires also the treatment of periodic boundary conditions in one , two or three dimensions .",
    "this includes for example decoherence and dissipation in nanowires , electronic relaxation on surfaces , or hot electron thermalization in bulk systems .",
    "for these cases it is desirable to extend our approach to periodic systems . in this section",
    "we briefly discuss the necessary steps in order to apply sqmd to extended systems .",
    "there are some extra details and conditions that have to be satisfied in order to treat periodic systems with sqmd . as a first step we expand the stochastic kohn - sham orbitals of the periodic system of interest in the complete set of the corresponding ground - state bloch - orbitals @xmath183 @xmath184 this gives rise to stochastic expansion coefficients @xmath185 which are then propagated in time using , e.g. , the quantum jump algorithm that we have presented in section  [ qja ] .",
    "similar to the case of molecules , the fermionic nature of the electronic subsystem needs to be taken into account by orthogonalizing the occupied states after each application of the bath operator ( cf .",
    "step ( 4 ) of the quantum jump algorithm ) .",
    "in addition , care has to be taken for the choice of gauge for the vector and scalar potentials in the hamiltonian of the extended system . here",
    ", the same restrictions apply as in standard closed - system tddft simulations . in practice , we consider only purely time - dependent vector potentials which retain the periodicity of the considered system at all times . in the present context we have to assume in addition that the bath operators retain the periodicity of the extended system as well .",
    "this restricts the choice of baths represented by local operators that satisfy the condition @xmath186 where @xmath187 denotes the usual displacement vector of the unit cell .",
    "this may exclude certain relaxation mechanisms .",
    "however , the importance of these relaxation and dephasing channels can always be checked by increasing the size of the supercell that is used in the simulation .",
    "while we do not have fully implemented this scheme yet , we want to argue about important physical processes that can be studied with this approach .",
    "for instance , one could study adsorption of molecules on surfaces whose opposite side is set on a thermal stage that keeps the electron and/or ion temperatures fixed .",
    "again , this could be accomplished in a supercell geometry by coupling some `` bulk '' layers away from the surface with a local operator that maintains energy equilibrium in that region ( an example of such operator is given in ref .",
    "the rest of the system is let to follow its own dynamics .",
    "if we excite the molecules and/or surface - e.g. , by application of a short electromagnetic field - electrons and ions can then distribute energy and momentum first in the layers adjacent to the surface and then relax energy into the bath , where they would thermalize to the appropriate canonical distributions .",
    "analogously , we could monitor energy relaxation of electrons and ions in a bulk exited either thermally or electrically and kept at a given temperature by a thermal stage .",
    "important phenomena that are then accessible would be , e.g. , phase transitions driven by dissipative effects .",
    "in summary , we have presented a detailed account of stochastic quantum molecular dynamics .",
    "the approach is based on a stochastic schrdinger equation , which may or may not describe markovian dynamics - although we have focused the discussion to the markovian case .",
    "our approach allows us to describe the dynamics of electrons and ions coupled to one or many external environments . for simplicity",
    "we have restricted our examples to the situation of classical ions , but the approach is , in principle , valid also for quantum ions .",
    "although we have not reported any actual implementation of sqmd for periodic systems , we have outlined the theory behind its extension to this important case .",
    "work along these lines is in progress and will be reported elsewhere @xcite .",
    "this approach is thus amenable to studying many interesting phenomena related to energy relaxation and dephasing of the electronic subsystem in the presence of ionic dynamics , such as local ionic and electronic heating in laser fields , relaxation processes in photochemistry , etc .",
    ", a feature that is lacking in any `` standard '' molecular dynamics approach .",
    "s.  kurth , g.  stefanucci , e.  khosravi , c.  verdozzi , e.  k.  u. gross , dynamical coulomb blockade and the derivative discontinuity of time - dependent density functional theory , phys . rev .",
    "104 ( 2010 ) 236801 .",
    "f.  d. vila , d.  a. strubbe , y.  takimoto , x.  andrade , a.  rubio , s.  g. louie , j.  j. rehr , basis set effects on the hyperpolarizability of chcl[sub 3 ] : gaussian - type orbitals , numerical basis sets and real - space grids , j. chem .",
    "( 2010 ) 034111 .",
    "m.  di  ventra , r.  dagosta , comment on `` time - dependent current - density functional theory for generalized open quantum systems '' by j. yuen - zhou , c. rodriiguez - rosario and a. aspuru - guzik , arxiv http://arxiv.org/abs/0911.3932 ( 2009 ) 3 .",
    "s.  maniscalco , f.  intravaia , j.  piilo , a.  messina , misbeliefs and misunderstandings about the non - markovian dynamics of a damped harmonic oscillator , journal of optics b : quantum and semiclassical optics 6 ( 2004 ) s98 .",
    "a.  dreuw , m.  head - gordon , failure of time - dependent density functional theory for long - range charge - transfer excited states : the zincbacteriochlorin - bacteriochlorin and bacteriochlorophyll - spheroidene complexes , j. am .",
    "( 2004 ) 4007 ."
  ],
  "abstract_text": [
    "<S> we present a detailed account of the technical aspects of stochastic quantum molecular dynamics , an approach introduced recently by the authors [ h. appel and m. di ventra , phys . </S>",
    "<S> rev . </S>",
    "<S> b * 80 * 212303 ( 2009 ) ] to describe coupled electron - ion dynamics in open quantum systems . as example applications of the method we consider both finite systems with and without ionic motion , as well as describe its applicability to extended systems in the limit of classical ions . </S>",
    "<S> the latter formulation allows the study of important phenomena such as decoherence and energy relaxation in bulk systems and surfaces in the presence of time - dependent fields . </S>"
  ]
}