{
  "article_text": [
    "the diffusive shock acceleration ( dsa ) process @xcite is considered as the principal mechanism for production of galactic cosmic rays ( cr ) in supernova remnants ( snrs ) .",
    "a significant theoretical progress in the investigation of this mechanism was achieved ( see e.g. malkov & drury @xcite for a review ) .",
    "however only during the last decade the excellent results of x - ray and gamma - ray astronomy supplied the observational evidence of the presence of multi - tev energetic particles in these objects ( see e.g. aharonian et al .",
    "@xcite ) .",
    "two shocks are produced by super - sonically moving supernova ejecta after an explosion .",
    "a forward shock propagates in the circumstellar medium while a reverse shock propagates in the gas of ejecta .",
    "generally it is believed that some part of thermal particles is injected at the shock fronts into acceleration .    in this paper",
    "we present a new numerical model of nonlinear diffusive shock acceleration .",
    "this model is a natural development of the existing models @xcite .",
    "the solution of spherically symmetric hydrodynamic equations is combined with the energetic particle transport and acceleration at the forward and reverse shocks of a supernova remnant .",
    "nonlinear response of energetic particles via their pressure gradient results in the self - regulation of acceleration efficiency .    our previous studies that used this model dealt with the cr spectra produced by snrs @xcite .",
    "the input of the reverse shock was not taken into account there while the acceleration by both shocks was considered for modeling of non - thermal electromagnetic emission from the snr rx j1713.7 - 3946 @xcite .",
    "the paper is organized as follows .",
    "the short description of the model is given in sect .",
    "the results of modeling of evolution of a supernova remnant in the interstellar medium are presented in sect .",
    "4 contains the discussion of our results .",
    "our conclusions are given in the last section .",
    "the numerical code is described in appendix .",
    "hydrodynamical equations for the gas density @xmath0 , gas velocity @xmath1 , gas pressure @xmath2 , and the equation for isotropic part of the cr proton momentum distribution @xmath3 in the spherically symmetrical case are given by    @xmath4    @xmath5    @xmath6    @xmath7 @xmath8 @xmath9 here @xmath10 is the cr pressure , @xmath11 is the advective velocity of crs , @xmath12 is the adiabatic index of the gas , and @xmath13 is the cr diffusion coefficient .",
    "it was assumed that the diffusive streaming of crs results in the generation of magnetohydrodynamic ( mhd ) waves .",
    "cr particles are scattered by these waves .",
    "that is why the cr advective velocity @xmath14 may differ from the gas velocity @xmath15 .",
    "damping of these waves results in an additional gas heating .",
    "it is described by the last term in eq .",
    "two last terms in eq .",
    "( 4 ) correspond to the injection of thermal protons with momenta @xmath16 , @xmath17 and mass @xmath18 at the fronts of the forward and reverse shocks at @xmath19 and @xmath20 respectively and @xmath21 for quantities corresponding to the forward and reverse ( backward ) shock respectively . ] .",
    "the dimensionless parameters @xmath22 and @xmath23 determine the injection efficiency .",
    "the equation for ions is similar to eq .",
    "( 4 ) . for ions with the mass @xmath24 and",
    "the mass number @xmath25 it is convenient to use the momentum per nucleon @xmath26 and the normalization of the ion spectra @xmath27 to the baryonic number density .",
    "then the number density of ions @xmath28 is @xmath29 .",
    "the ion pressure @xmath30 is also taken into account in the cosmic ray pressure @xmath31",
    ".    we shall neglect the pressure of energetic electrons .",
    "in other words they are treated as the test particles .",
    "the evolution of electron distribution is described by equation similar to eq .",
    "( 4 ) with additional terms describing synchrotron and inverse compton ( ic ) losses .",
    "cr diffusion is determined by magnetic inhomogeneities .",
    "strong streaming of accelerated particles changes medium properties in the shock vicinity .",
    "cr streaming instability results in the high level of mhd turbulence @xcite and even in the amplification of magnetic field in young snrs @xcite . due to this effect",
    "the maximum energy of accelerated particles may be higher in comparison with previous estimates of lagage and cesarsky @xcite .    according to the numerical modeling of this non - resonant instability , the magnetic field",
    "is amplified by the flux of run - away highest energy particles in the relatively broad region upstream of the shock @xcite .",
    "magnetic energy density is a small fraction ( @xmath32 ) of the energy density of accelerated particles .",
    "this amplified almost isotropic magnetic field can be considered as a large - scale magnetic field for lower energy particles which are concentrated in the narrow region upstream of the shock .",
    "resonant streaming instability of these particles produces mhd waves propagating in the direction opposite to the cr gradient .",
    "strong nonlinear damping of these waves results in the gas heating ( see the last term in eq.(3 ) ) .",
    "cr gradient is negative upstream of the forward shock and mhd waves propagate in the positive direction .",
    "the situation changes downstream of the forward shock where cr gradient is as a rule positive and mhd waves propagate in the negative direction .",
    "this effect is mostly pronounced downstream of the forward shock of snr because the magnetic field is additionally amplified by the shock compression and the alfvn velocity @xmath33 can be comparable with the gas velocity in the shock frame @xmath34 .",
    "as for cr diffusion coefficient , it is probably close to the bohm value @xmath35 , where @xmath36 is the electric charge of particles .",
    "we apply a finite - difference method to solve eqs ( 1 - 4 ) numerically upstream and downstream of the forward and reverse shock ( see appendix ) .",
    "a non - uniform numerical grid upstream of the shocks at @xmath37 and @xmath38 allows to resolve small scales of hydrodynamical quantities appearing due to the pressure gradient of low - energy crs .",
    "the gases compressed at the forward and reverse shocks are separated by a contact discontinuity at @xmath39 that is situated between the shocks .",
    "an explicit conservative tvd scheme @xcite for hydrodynamical equations ( 1 - 3 ) and uniform spatial grid were used between the shocks .    because of synchrotron losses the spacial scale of the high - energy electrons can be rather small downstream of the shocks .",
    "that is why we use a non - uniform numerical spacial grid for accelerated electrons downstream of the shocks .",
    "the magnetic field plays no dynamical role in the model .",
    "since we have not perform the modeling of the amplification and transport of magnetic field here , its coordinate dependence should be specified for determination of cosmic ray diffusion and for calculation of synchrotron emission and losses .",
    "we shall assume below that the coordinate dependencies of the magnetic field and the gas density coincide upstream and downstream of the forward shock : @xmath40 here @xmath41 is the gas density and @xmath42 is the alfvn velocity of the circumstellar medium .",
    "the parameter @xmath43 determines the value of the amplified magnetic field strength . for low shock velocities",
    "@xmath44 the magnetic field is not amplified .",
    "the magnetic energy is about 3.5 percent of the dynamical pressure @xmath45 according to estimates from the width of x - ray filaments in young snrs @xcite .",
    "this number and characteristic compression ratio of a modified snr shock @xmath46 correspond to @xmath47 .",
    "since the plasma density @xmath48 decreases towards the contact discontinuity downstream of the forward shock , the same is true for the magnetic field strength according to eq .",
    "this seems reasonable because of a possible magnetic dissipation in this region .",
    "situation is different downstream of the reverse shock at @xmath49 .",
    "the plasma flow is as a rule strongly influenced by the rayleigh - taylor instability that occurs in the vicinity of the contact discontinuity and results in the generation of mhd turbulence in this region .",
    "we shall assume that the magnetic field does not depend on radius downstream of the reverse shock while the dependence in the upstream region is described by the equation similar to eq .",
    "( 5 ) :    @xmath50    here @xmath51 is the radius where the ejecta density has a minimum and equals @xmath52 .",
    "this radius @xmath53 is generally close to the reverse shock radius @xmath54 and is equal to it if the reverse shock is not modified by the cosmic ray pressure .",
    "( thick solid line ) , the reverse shock radius @xmath54 ( thick dashed line ) , the forward shock velocity @xmath55 ( thin solid line ) and the reverse shock velocity @xmath56 ( thin dashed line ) . the ratio of cr energy and energy of supernova explosion @xmath57 ( dotted line ) is also shown.,width=302 ]     yr . at this epoch",
    "the forward shock velocity is 3300 km s@xmath58 , its radius is 6.5 pc , the reverse shock velocity is 1650 km s@xmath58 , its radius is 5.1 pc , the magnetic field strength downstream of the forward shock is 160 @xmath59 g while the magnetic field strength downstream the reverse shock is 56 @xmath59 g . , width=302 ]",
    "cr advective velocity may differ from the gas velocity on the value of the radial component of the alfvn velocity @xmath60 calculated in the isotropic random magnetic field : @xmath61 . here",
    "the factor @xmath62 describes the possible deviation of the cosmic ray drift velocity from the gas velocity .",
    "the similar expression for the cosmic ray drift velocity is used upstream of the reverse shock at @xmath38 . we shall use values @xmath63 and @xmath64 upstream of the forward and reverse shocks respectively , where alfvn waves are generated by the cosmic ray streaming instability and propagate in the corresponding directions .",
    "the damping of these waves heats the gas upstream of the shocks @xcite and limits the total compression ratios by a number close to 6 .",
    "this alfvn heating produce a more efficient limitation of the shock modification in comparison with the dynamical effects of the magnetic field considered by caprioli et al .",
    "@xcite which are neglected in our study . in the downstream region of the forward and",
    "reverse shock at @xmath65 we set @xmath66 and therefore @xmath67 in the major part of this paper except the consideration of the alfvn drift effects downstream of the shocks at the end of sect.3 and in fig.10 .",
    "we shall use the following diffusion coefficient    @xmath68    here the parameter @xmath69 depends on the type of nonlinear wave damping which is relevant only for low velocity shocks @xmath44 when the magnetic field is not amplified .",
    "the parameter @xmath70 describes the possible deviations of diffusion coefficient from the bohm value @xmath71 for high - velocity shocks .",
    "since the highest energy particles are scattered by small - scale magnetic fields , their diffusion is faster than the bohm diffusion @xcite .",
    "the same is true for smaller energy particles because they can be resonantly scattered only by a fraction of the magnetic spectrum .",
    "we shall use the value @xmath72 throughout the paper .",
    "we shall use the value of parameter @xmath73 below .",
    "it corresponds to the nonlinear wave damping of the weak turbulence theory .",
    "note that a stronger kolmogorov - type nonlinear damping used by ptuskin & zirakashvili @xcite for estimate of maximum energy in snrs corresponds to @xmath74 .",
    "in real situation the level of mhd turbulence drops with distance upstream of the shock and diffusion may be even faster there .",
    "this is qualitatively taken into account by the exponential factors in eq .",
    "the characteristic diffusive scale of highest energy particles is a small fraction @xmath75 of the shock radius @xcite and is determined by the generation and transport of mhd turbulence in the upstream region @xcite .",
    "the value @xmath76 is determined by ratio of diffusion coefficient @xmath77 in the circumstellar medium and diffusion coefficient @xmath78 in the vicinity of the shock .",
    "the mhd turbulence is amplified exponentially in time before the shock arrival from the background level by cosmic ray streaming instability .",
    "the characteristic range of @xmath79 is @xmath80 @xcite .",
    "we shall use the value @xmath81 below .",
    "yr . the proton spectrum at the forward shock ( thick solid ) , ion spectrum at the reverse shock ( thick dashed ) , electron spectrum at the forward shock ( multiplied to the factor of 100 , thin solid ) and positron spectrum at the reverse shock ( multiplied to the factor of 100 , thin dashed ) are shown .",
    "spectrum of ions is shown as the function of momentum per nucleon and normalized to the baryonic number density.,width=302 ]     yr . at this epoch",
    "the forward shock velocity is 660 km s@xmath58 , its radius is 17 pc , magnetic field strength downstream of the forward shock is 40 @xmath59 g . , width=302 ]     yr . the spectrum of protons ( thick solid line ) and electrons ( multiplied to the factor of 100 , thin solid line ) at the forward shock , ion spectrum ( thick dashed line ) and positron spectrum ( multiplied to the factor of 100,thin dashed line ) in the central part of the remnant are shown .",
    "spectrum of ions is shown as the function of momentum per nucleon and normalized to baryonic number density.,width=302 ]    it is believed that the supernova ejecta has some velocity distribution @xmath82 just after the supernova explosion @xcite    @xmath83    here the index @xmath84 characterizes the steep power - low part of this distribution .",
    "the radial distribution of ejecta density is described by the same expression with @xmath85 .",
    "the characteristic ejecta velocity @xmath86 can be expressed in terms of energy of supernova explosion @xmath87 and ejecta mass @xmath88 as    @xmath89",
    "figures ( 1)-(9 ) illustrate the numerical results that are obtained for the snr shock propagating in the medium with a hydrogen number density @xmath90 @xmath91 , magnetic field strength @xmath92 @xmath59 g and temperature @xmath93 k. the fraction @xmath94 of helium nuclei was assumed .",
    "the gas of ejecta does not contain hydrogen in the case considered .",
    "we use the ejecta mass @xmath95 , the energy of explosion @xmath96 erg and the parameter of ejecta velocity distribution @xmath97 .",
    "the value of the parameter @xmath98 was assumed .",
    "the initial forward shock velocity is @xmath99 km s@xmath58 .",
    "the injection efficiency is taken to be independent on time @xmath100 , and the injection momenta are @xmath101 , @xmath102 .",
    "protons with a mass @xmath18 are injected at the forward shock while ions with mass number @xmath25 and charge number @xmath103 are injected at the reverse shock .",
    "this high injection efficiency results in the significant shock modification already at early stages of snr expansion while the thermal sub - shock compression ratio is close to 2.5 during the simulation .",
    "this is in agreement with the radio - observations of young extragalactic snrs @xcite and with the modeling of collisionless shocks @xcite .",
    "similar values of the injection efficiency were found in hybrid modeling ( see e.g. @xcite ) and at the earth bow shock in the solar wind @xcite .    as for the electron injection",
    "we assume a rather high injection energy of electrons @xmath104 mev .",
    "this qualitatively corresponds to some models of suprathermal electron injection .",
    "partially ionized ions accelerated at the shocks up to relativistic energies can produce multi - mev electrons in the upstream region in the course of photo - ionization by galactic optical and infrared radiation @xcite .",
    "mev electrons and positrons are also present in the radioactive supernova ejecta while gamma - rays from @xmath105co decay in ejecta produce energetic electrons via compton scattering in the circumstellar medium @xcite .",
    "these energetic particles may be additionally pre - accelerated via stochastic acceleration in the turbulent upstream regions of the shocks .",
    "below we assume that electrons are injected at the forward shock with efficiency @xmath106 while positrons are injected at the reverse shock with efficiency @xmath107 .",
    "these numbers are expected for the injection mechanisms mentioned above ( see sect.4 for details ) . since electrons are considered as test particles our results can be easily rescaled for any other injection efficiency . the chosen injection rate at forward shock maintains the electron to proton ratio @xmath108 of the order of @xmath109 throughout the simulation while time - independent positron injection at the reverse shock results in positron to ion ratio @xmath110 increase from @xmath111 in the very beginning of snr evolution up to @xmath112 at several thousand years shortly before the disappearance of the reverse shock .",
    "in the real snr the ions are also injected at the forward shock .",
    "we do not consider this process here in order to find the spectra of ions produced by the reverse shock . because of the same reason we assumed the absence of hydrogen in the ejecta .",
    "although this is the case for ia / b / c and iib supernovae it is not true for iip supernovae .",
    "it is expected that the spectra of ions injected at the forward and reverse shock are similar to the spectra of protons .",
    "the production of cr ions at the forward shock was recently considered by caprioli et al .",
    "@xcite .",
    "the dependencies on time of the shock radii @xmath113 and @xmath54 , the forward and reverse shock velocities @xmath114 and @xmath115 , cr energy @xmath57 are shown in fig.1 .",
    "the calculations were performed until @xmath116 yr , when the value of the forward shock velocity drops down to @xmath117 km s@xmath58 and the forward shock radius is @xmath118 pc .    at early times of snr evolution",
    "the distance between reverse and forward shocks is only 10@xmath119 of the remnant radius .",
    "this is less than 23@xmath119 thickness for automodel chevalier - nadezhin solution with @xmath97 @xcite and should be attributed to a strong modification of both shocks by cr pressure .",
    "the reverse shock is strongly decelerated only when the forward shock sweeps the gas mass comparable with the ejecta mass at @xmath120 yr and when the transition to the sedov phase begins .",
    "radial dependencies of physical quantities at @xmath121 yr are shown in fig.2 .",
    "the contact discontinuity between the ejecta and the interstellar gas is at @xmath122 pc .",
    "the reverse shock in the ejecta is situated at @xmath123 pc . at the sedov stage",
    "the reverse shock moves in the negative direction and reach the center after seven thousand years after the supernova explosion .",
    "we stop the calculations in the region @xmath124 when the reverse shock radius @xmath125 .",
    "yr . at this epoch",
    "the forward shock velocity is 164 km s@xmath58 , its radius is 42 pc , magnetic field strength downstream of the forward shock is 23 @xmath59 g . , width=302 ]",
    "the spectrum of protons ( thick solid line ) and electrons ( multiplied to the factor of 100 , thin solid line ) at the forward shock , ion spectrum ( thick dashed line ) and positron spectrum ( multiplied to the factor of 100 , thin dashed line ) in the central part of the remnant are shown .",
    "spectrum of ions is shown as the function of momentum per nucleon and normalized to baryonic number density.,width=302 ]     yr .",
    "spectrum of protons injected at the forward shock ( thick solid line ) , spectrum of electrons injected at the forward shock ( thin solid line ) , spectrum of ions injected at the reverse shock ( thick dashed line ) and the spectrum of positrons injected at the reverse shock ( thin dashed line ) are shown .",
    "spectrum of ions is shown as the function of momentum per nucleon and normalized to the baryonic number density.,width=302 ]     ( dotted line ) are also shown.,width=302 ]     yr in the model including the alfvn drift downstream of the shocks",
    ". spectrum of protons injected at forward shock ( thick solid line ) , spectrum of electrons injected at the forward shock ( thin solid line ) , spectrum of ions injected at the reverse shock ( thick dashed line ) and the spectrum of positrons injected at the reverse shock ( thin dashed line ) are shown .",
    "spectrum of ions is shown as the function of momentum per nucleon and normalized to the baryonic number density.,width=302 ]    it should be noted that our one - dimensional calculations can not adequately describe the development of the rayleigh - taylor instability of the contact discontinuity . in the real situation",
    "the supernova ejecta and the circumstellar gas are mixed by turbulent motions in this region ( see e.g. mhd modeling of jun & norman @xcite ) .",
    "spectra of accelerated protons and electrons at @xmath121 yr are shown in fig.3 . at this epoch maximum energy of protons",
    "accelerated in this snr is about 100 tev , while higher energy particles have already left the remnant .",
    "radial dependencies of physical quantities at later epoch @xmath126 yr are shown in fig.4 .",
    "the reverse shock has reached the center of the remnant earlier .",
    "a weak reflected shock is clearly visible at @xmath127 pc .",
    "the spectra of particles ar @xmath126 yr are shown in fig.5 .",
    "radial dependencies of physical quantities at the end of simulation at @xmath116 yr are shown in fig.6 . at this epoch",
    "the remnant is deeply in sedov stage .",
    "the contact discontinuity is at @xmath128 pc .",
    "the spectra of particles at @xmath116 yr are shown in fig.7 .",
    "the shock modification is not strong because the alfvnic mach number is close to 6 and the corresponding alfvn heating upstream of the forward shock results in the lower compression ratio and acceleration efficiency .",
    "that is why the spectra of particles are steeper in comparison with ones at earlier epochs .",
    "the spectra of particles produced during the whole evolution of the remnant are shown in fig.8 .",
    "they are obtained as the sum of the spectra integrated throughout simulation domain and of the time - integrated diffusive flux at the simulation boundary at @xmath129 . at @xmath116",
    "yr the maximum energy of currently accelerated particles drops down to 100 gev because of nonlinear damping .",
    "higher energy particles have already left the remnant .",
    "note that stronger kolmogorov - type damping with @xmath74 will result even in lower energies of the order of 1 gev .",
    "however we found that the spectra do not change in this case .",
    "we found that the maximum energy of cr protons is somewhat less than @xmath130 ev .",
    "it is almost an order of magnitude lower in comparison with the results of ptuskin et al .",
    "@xcite where more optimistic assumptions @xmath131 and the spatially - uniform cr diffusion coefficient upstream of the forward shock were used ( cf .",
    "eq.(7 ) ) .",
    "note that the synchrotron losses of run - away electrons and positrons were taken into account in our modeling .",
    "the cut - off energy of the leptonic spectra @xmath132 tev shown in fig.8 is determined by the magnetic field strength @xmath133 g in the circumstellar medium and by the remnant age @xmath116 yr .",
    "evolution of non - thermal emission produced in the snr at distance 4 kpc is shown in fig.9 .",
    "it is worth noting that a significant part of the ic emission is produced in the central region of the remnant at late epochs when the reverse shock have disappeared .",
    "this is because the magnetic field is rather weak in these regions .",
    "although only about @xmath134 of supernova energy is transferred to the particles accelerated at the reverse shock , they can not be neglected .",
    "first of all the ejecta has absolutely different composition in comparison with interstellar medium where the forward shock propagates .",
    "since the solar abundance corresponds to @xmath135 in the mass of heavy elements while the ejecta can contain up to 50@xmath119 of heavy elements it is clear that the reverse shock will dominate in the production of heavy high - energy cr nuclei .",
    "the relative input of the reverse shock at high energies is determined by the relative energetics of the reverse and forward shocks that is of the order of 1/10 for snrs expanding in the uniform circumstellar medium .    according to our results , approximately @xmath136 of supernova energy",
    "is transferred to particles accelerated by forward shock .",
    "it is significantly higher than the estimate of 10 - 20 @xmath119 needed to maintain cr density in the galaxy if the supernova rate is 1/30 yr .",
    "one of possibilities to resolve this contradiction is the assumption that crs are accelerated only at small part of the forward shock surface .",
    "this can be due to the dependence of the proton and ion injection on the shock obliqueness @xcite .",
    "this effect is observed in sn 1006 and in the interplanetary medium",
    ".    this effect does not influence strongly the ion injection at the reverse shock .",
    "it is expected that the random magnetic field is the main component of the field in the expanded ejecta .",
    "this is because the magnetic field of ejecta originates from the magnetic field of the exploded star .",
    "thus the random magnetic field strength of the red super giant progenitor of iip supernovae is of the order of @xmath137 g similar to the magnetic field strength in the sun interior while the regular field is of the order of 1 g. after a homogenous expansion from the initial stellar radius @xmath138 cm up to the radius @xmath139 cm of a young snr the frozen - in magnetic field drops down to @xmath140 g. although this value is significantly lower than the magnetic field in the interstellar medium it is strong enough for acceleration of particles up to 100 gev in snrs . a more realistic non - homogenous expansion will result in the stretching of the field in the radial direction .",
    "this can increase the magnetic field strength and ion injection efficiency at the reverse shock .",
    "magnetic fields can be also amplified by non - resonant cr streaming instability suggested by bell @xcite . if so the relative contribution of the reverse shock to the over - all cr spectrum increases .",
    "the effect also depends on the type of the supernova explosion .",
    "it is known that acceleration at the reverse shock occurs in cas a snr @xcite .",
    "the progenitor of the core - collapse cas a supernova had the radius of the order of @xmath141 cm . on the other hand white dwarfs that are progenitors of ia supernova explosions have small radii of the order of @xmath142 cm .",
    "interior magnetic field @xmath143 g of the white dwarf will drop down to @xmath144 g after the homogenous expansion of the young snr .",
    "such a weak magnetic field can result in the ineffective dsa at the reverse shock of ia supernovae .",
    "this effect is probably observed in tycho snr ( see warren et al .",
    "@xcite for details ) .",
    "another possibility to suppress the cr production is related with the alfvn drift downstream of the forward shock @xcite .",
    "it results in the steeper spectrum of crs accelerated at the forward shock . on the other hand",
    "the alfvn drift downstream of the reverse shock may produce even an opposite effect because the cr gradient is positive in this region ( see fig.2 ) . as a result",
    "the input of the reverse shock will be significant at tev energies .",
    "the over - all spectrum according to this model is shown in fig.10 .",
    "the value of @xmath64 instead of @xmath66 is used downstream of the shocks .",
    "because of the alfvn drift the positron spectrum at reverse shock is significantly harder than the electron spectrum at the forward shock .",
    "it should be noted that the spectra of ions accelerated at the reverse shock are harder than the proton spectra at the forward shock ( see figs 3,8 ) in spite of the same level of the shock modification for both shocks .",
    "this is because the shocks propagate in the media with different properties .",
    "when the reverse shock reach the flat part of the ejecta density distribution it propagates in the medium with decreasing in time density . that is why the number of freshly injected ions is low in comparison with higher energy particles accelerated earlier .",
    "it results in the spectral hardening .",
    "this effect is absent at the forward shock propagating in the medium with a constant density .",
    "the alfvn drift strengthens this effect ( see fig.10 ) .",
    "we adjust the electron ( positron ) injection to produce a sufficient number of electrons and positrons . the spectra shown in figs 8 and 10",
    "can explain cr galactic electrons and positrons .",
    "the expected positron injection efficiency from the radioactive decay of @xmath145ti is estimated as @xmath146 @xcite for @xmath145ti mass of the order of @xmath147 as observed in snrs @xcite .",
    "we used this number in our simulation .",
    "as for the electron injection at the forward shock the relative number of energetic electrons from photo - ionization of accelerated single charged he ions is of the order of @xmath148 . here",
    "@xmath149 is the gamma - factor of single - charged he ion photo - ionized by galactic ultra - violet photons with energy @xmath150 ev and @xmath151 ev is the ionization potential of helium .",
    "this slightly overestimates the electron injection in young snrs where the acceleration is fast enough , @xmath152 is closer to @xmath153 and the ionization is provided by ev optical photons .",
    "however we used this crude estimate that is justified in old snrs for electron injection in our simulations .",
    "this injection mechanism suggested by morlino @xcite produces one order of magnitude higher number of energetic electrons in comparison with the number @xmath154 of compton scattered electrons energized by gamma - photons from @xmath105co radioactive decay in supernova ejecta @xcite . here",
    "@xmath155 is the forward shock radius expressed in parsecs .",
    "the efficiency of electron ( positron ) acceleration at the reverse shock in snrs can be observationally checked in the gamma - ray band .",
    "young and middle - age ( @xmath156 yr ) snrs can be bright in tev energies ( see fig.9 ) .",
    "the electrons ( positrons ) accelerated before at the reverse shock do not strongly influenced by synchrotron losses in the weak magnetic field of the central part of the snr and emit ic gamma - rays .",
    "the main purpose of the present paper was the presentation of a new numerical code for the modeling of hydrodynamics and nonlinear shock acceleration in snr .",
    "the code is described in details in five appendixes .",
    "it develops the modeling of particle acceleration by spherical shocks fulfilled earlier by other authors @xcite .",
    "besides some important technical details , the main novel features of our code include the particle acceleration by two shocks - forward and reverse , the evolving with a snr age magnetic field , which determines the cosmic ray transport , the account for the alfvn drift effects both upstream and downstream of the forward and reverse shocks .",
    "the first version of the model of acceleration @xcite and a number of important applications including the explanation of the overall spectrum of galactic cosmic rays @xcite , and the modeling of particle acceleration and nonthermal radiation in snr rx j1713.7 - 3946 @xcite were developed upon our code refinements .",
    "the special attention in the astrophysical applications of the modeling discussed in the present work was focused on the particle acceleration by the reverse snr shock .",
    "it was shown that the reverse shock can give a non - negligible contribution to the production of cr ions and positrons as compared to the contribution of the forward shock .",
    "the spectra of particles accelerated at the reverse shock can be harder than the spectra at the forward shock , see figures 8 and 10 .",
    "it may offer a new interpretation of cosmic ray data @xcite that suggests the presence of high energy primary positrons .",
    "the acceleration of positrons by the reverse shock moving through the ejecta material , which contains the positrons from @xmath145ti radioactive decays , was proposed in @xcite .",
    "it is also possible @xcite that the hard spectrum of accelerated nuclei and the low abundance of hydrogen in the material of supernova ejecta accelerated by the reverse shock may explain the difference in the energy spectra of hydrogen and helium in cosmic rays .",
    "we plan detailed study of all these effects in a future work .    in the light of the problem of electron injection it is of interest that the models of suprathermal electron injection @xcite reproduce the required amount of galactic cr electrons and positrons if the leptons are pre - accelerated up to @xmath157 mev in the upstream regions of supernova shocks .",
    "the work was supported by the russian foundation for basic research grant 10 - 02 - 00110a .",
    "we thank the anonymous referee for a number of valuable comments .",
    "we used the following change of variables upstream of the shocks :    @xmath158    and downstream of the shocks :    @xmath159    we shall use the dimensionless parameters @xmath160 instead of time @xmath161 and @xmath162 instead of momentum @xmath26 .",
    "it is convenient to use the new variable @xmath163 instead of momentum distribution @xmath164 . for the relativistic momenta @xmath165",
    "this variable corresponds to a partial energy density of cosmic rays .    in these new variables the equations ( 1)-(4 )",
    "have the following form upstream of the shocks :    @xmath166    @xmath167    @xmath168,\\ ] ]    @xmath169 \\frac { \\partial } { \\partial \\xi } \\xi ^2w,\\ ] ]    here indexes @xmath170 and @xmath21 are referred to the forward ( @xmath171 ) and reverse shock ( @xmath172 ) respectively .",
    "the equations ( 1)-(4 ) have the following form downstream of the shocks :    @xmath173    @xmath174    @xmath175    @xmath176 \\frac { \\partial } { \\partial \\eta } r^2w,\\ ] ]    here the speeds @xmath177 and @xmath178 are determined as @xmath179 and @xmath180 respectively .",
    "the corresponding cr advective speeds @xmath181 and @xmath182 are determined as @xmath183 and @xmath184 respectively .",
    "the quantities @xmath185 are the distances between the forward shock and the contact discontinuity @xmath186 and between the reverse shock and the the contact discontinuity @xmath187 .",
    "we introduced energy density of the gas @xmath188 .",
    "then the equations ( a7)-(a9 ) are written in the conservative form that is convenient for the numerical method .",
    "the radius @xmath189 in the last equations should be expressed using eq .",
    "( a2 ) :    @xmath190",
    "since the flow upstream of the shocks is supersonic the hydrodynamic equations can be solved using the following implicit numerical scheme in these regions .",
    "let introduce the grid @xmath191 .",
    "integration of equations ( a3)-(a5 ) on @xmath192 from @xmath191 to @xmath193 results in the following expressions for density @xmath194 , velocity @xmath195 and the gas pressure @xmath196 upstream of the forward shock ( @xmath171 ) at the grid knot with a number @xmath197 in terms of @xmath198 and @xmath199 :    @xmath200    @xmath201 ^{-1}\\ ] ]    @xmath202 \\times\\ ] ] @xmath203 ^{-1}\\ ] ]    here the superscript @xmath204 is referred to quantities at the previous time step and @xmath205 is the step in the dimensionless time @xmath206 .",
    "the quantity @xmath207 is given by the expression    @xmath208    in spite of implicity eqs ( b1-b3 ) are readily solved recurrently from @xmath209 down to @xmath210 corresponding to the position of the forward shock .",
    "the value of the forward shock radius @xmath113 is related with the forward shock radius @xmath211 at the previous time step as @xmath212 in eqs ( b1-b4 ) .    performing the integration of equations ( a3)-(a5 ) on @xmath192 from @xmath213 to @xmath191 upstream of the reverse shock we obtain the expressions for for density , velocity @xmath214 , @xmath195 and and the gas pressure @xmath196 upstream of the reverse shock ( @xmath215 ) in terms of @xmath216 and @xmath217 :    @xmath218    @xmath219 ^{-1}\\ ] ]    @xmath220 \\times\\ ] ] @xmath221 ^{-1}\\ ] ]",
    "the quantities @xmath222 and @xmath223 are given by expressions    @xmath224    eqs ( b5-b7 ) are solved recurrently from @xmath225 to @xmath226 corresponding to the position of the reverse shock .",
    "the value of the new reverse shock radius @xmath54 in eqs ( b5-b8 ) was extrapolated using the reverse shock radius @xmath227 and velocity @xmath228 as @xmath229 .",
    "hydrodynamical quantities are determined at the centers of the cells with the indexes @xmath230 in the downstream regions .",
    "we used an explicit numerical scheme of trac & pen @xcite for solution of eqs .",
    "( a7)-(a9 ) .",
    "in accordance with these equations we use the following variables    @xmath231    and fluxes @xmath232 @xmath233    the variables @xmath234 are introduced as @xmath235 here @xmath236 is the so called freezing speed .",
    "the values @xmath237 at the next instant of time are given by    @xmath238    @xmath239    @xmath240    here @xmath241 is the grid step downstream of the forward and reverse shock respectively .",
    "note that a uniform grid in the downstream region was used .",
    "the fluxes @xmath242 at the grid knots between discontinuities are given by    @xmath243    where the fluxes @xmath244 at the grid knots are given by    @xmath245    @xmath246    here the function @xmath247 is the nonlinear flux limiter .",
    "the numerical scheme is reduced to the first order godunov s one for @xmath248 in eqs .",
    "( c8 ) , ( c9 ) .",
    "such a scheme is very dissipative .",
    "the simplest second order scheme corresponds to @xmath249 .",
    "however it is unstable .",
    "one should use more complex flux limiters for stability .",
    "the different types of corresponding nonlinear limiters are available .",
    "trac & pen @xcite used a so - called van - leer limiter :    @xmath250    we used a more dissipative `` minmod '' limiter :    @xmath251    for calculations of fluxes @xmath252 near discontinuities we also use @xmath248 or @xmath249 .",
    "the fluxes @xmath253 and @xmath254 just downstream of the forward and reverse shock at the knots with numbers @xmath210 and @xmath226 are calculated using hydrodynamical quantities just upstream of the forward and reverse shocks :    @xmath255 @xmath256    the fluxes @xmath257 at the position of the contact discontinuity at the knot with number @xmath258 are given by    @xmath259 where the pressure @xmath260 is found from the approximate solution of the riemann problem for decay of an arbitrary discontinuity :    @xmath261    here @xmath262 .",
    "hydrodynamical quantities at the new time step are found using eq .",
    "( c1 ) after the calculation of new positions of the discontinuities ( see appendix d ) .    for a stability of the numerical scheme considered",
    "the freezing speed @xmath236 must be greater than the maximal sonic velocity .",
    "we use the following expression for @xmath236    @xmath263 } , r_b < r_{i+1/2}<r_f\\ ] ]    the time step @xmath205 was found from the relation @xmath264 .",
    "the velocities of discontinuities are found from the approximate solutions of the riemann problem describing a decay of an arbitrary discontinuity .",
    "for the forward and reverse shocks the solution for the shock velocities @xmath265 and @xmath266 are the following :    @xmath267    @xmath268    the shock velocities are determined by upstream values @xmath269 and downstream values @xmath270 of the gas pressure , velocity and density .",
    "the expression for the velocity of the contact discontinuity @xmath271 is given by    @xmath272    here @xmath262 .",
    "the new values for the radii @xmath54 , @xmath273 , @xmath274 and real time @xmath161 are now found :    @xmath275    @xmath276    @xmath277",
    "the finite difference scheme for eqs ( a6 ) and ( a10 ) can be written in the following form :    @xmath278    here @xmath279 are the values of @xmath280 at the new time step calculated in the grid knot @xmath191 or @xmath281 and at @xmath282 .",
    "we use the following coefficients upstream of the shocks    @xmath283    @xmath284    @xmath285    @xmath286    the corresponding coefficients downstream of the shocks are given by @xmath287 @xmath288    @xmath289    @xmath290    the forward and reverse shocks are situated at knots with numbers @xmath210 and @xmath226 respectively .",
    "the coefficients at these knots are given by    @xmath291    @xmath292    @xmath293    and    @xmath294    @xmath295    @xmath296    here @xmath297 is the kronecker s symbol while @xmath298 and @xmath299 are numbers of the momentum grid knots corresponding to injection momenta @xmath300 and @xmath301 respectively .",
    "the contact discontinuity is situated at the knot @xmath258 .",
    "the coefficients at this knot are given by    @xmath302    @xmath303    @xmath304    we use a standard method to solve the tridiagonal set of equations ( e1 ) ( e.g. godunov @xcite ) . at first",
    "the following coefficients @xmath305 and @xmath306 are recurrently calculated from @xmath225 up to @xmath307 :    @xmath308    the values @xmath309 and @xmath310 correspond to the boundary condition @xmath311 at the center of the remnant .",
    "the functions @xmath312 are calculated recurrently from @xmath307 down to @xmath313 as    @xmath314    we put @xmath315 at @xmath209 .",
    "this describes an absorbtion of particles at the boundary of the simulation domain .",
    "the equations ( e19 ) , ( e20 ) are recurrently used for all values of @xmath316 starting with the lowest energies at @xmath317 .",
    "we use a uniform spacial grid downstream of the shocks and the following non - uniform grids upstream of the forward shock          here the parameter @xmath320 describes the ratio of radii of the simulation domain and forward shock .",
    "this parameter is constant during the simulation .",
    "we use the value @xmath321 .",
    "the value of the parameter @xmath322 should be small enough to resolve the spacial variation scale of the lowest energy cosmic rays upstream of the shocks .        here @xmath325 and @xmath326 are the gas density and pressure in the circumstellar medium while @xmath327 is the initial radius of the flat part of the ejecta density distribution .",
    "the initial velocities of the reverse shock and contact discontinuity are @xmath328 and @xmath329 respectively .",
    "their initial radii can be chosen rather arbitrary .",
    "we use values @xmath330 and @xmath331 .",
    "it is important to note that we use the finite difference method for solution of cr transport equations even at the shock positions at grid knots @xmath210 and @xmath226 ( see eqs .",
    "( e10-e15 ) ) .",
    "these equations contain terms originating from the first derivative on time ( see terms containing @xmath205 in eqs.(e10-e15 ) ) .",
    "these terms will not appear if we use exact boundary conditions at the shock fronts which can be derived by integration of eq .",
    "( 4 ) in the vicinity of the shocks .",
    "our method permits to use relatively large time steps @xmath205 while the use of the exact boundary conditions results in a numerical instability for the large time steps .",
    "physically this is because the low energy particles have very small acceleration times in the case of bohm - like diffusion .",
    "this results in the numerical instabilities .",
    "it is possible to use many iterations at every time step @xcite or to use very small time steps near the shock front @xcite to avoid this problem .",
    "this results in significantly longer times of simulations .    the numerical scheme with eqs .",
    "( e10-e15 ) artificially increases acceleration time of low - energy particles and makes the calculations to be stable .",
    "this means that our method can not be used for simulations of fast varying processes .",
    "however if the shocks propagate in the smooth environment then the low - energy particles are accelerated in a quasi - steady regime and our method is well justified .",
    "the numerical results shown in figs ( 1)-(10 ) were obtained using the grid with 200@xmath332200 radius - momentum cells in the every of four regions ( two upstream and two downstream regions of the shocks ) .",
    "the initial radius of the flat part of the ejecta density distribution @xmath333 is @xmath334 .",
    "the calculation of the remnant evolution takes two hours at pc .",
    "the total energy is conserved with 5% accuracy .",
    "preliminary results can be obtained using ten times faster crude calculations with 100@xmath332100 grid ."
  ],
  "abstract_text": [
    "<S> a new numerical model of the nonlinear diffusive shock acceleration is presented . </S>",
    "<S> it is used for modeling of particle acceleration in supernova remnants . </S>",
    "<S> the model contains coupled spherically symmetric hydrodynamic equations and the transport equations for energetic protons , ions and electrons . </S>",
    "<S> the forward and reverse shocks are included in the consideration . </S>",
    "<S> the spectra of cosmic rays released into interstellar medium from a supernova remnant are determined . </S>",
    "<S> the role of the reverse shock in the production of cr ions and positrons is discussed .    </S>",
    "<S> cosmic rays , acceleration , supernova remnants </S>"
  ]
}