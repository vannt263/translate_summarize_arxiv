{
  "article_text": [
    "the cosmic microwave background radiation ( cmb ) occupies a central role in modern cosmology .",
    "it provides us with a unique record of conditions along our past lightcone back to the epoch of decoupling ( last scattering ) , when the optical depth to thomson scattering rises suddenly due to hydrogen recombination .",
    "accurate observations of the cmb anisotropy should allow us to distinguish between models of structure formation and , in the case of non - seeded models , to infer the spectrum of initial perturbations in the early universe .",
    "essential to this programme is the accurate and reliable calculation of the anisotropy predicted in viable cosmological models .",
    "such calculations have a long history , beginning with sachs & wolfe ( 1967 ) who investigated the anisotropy on large scales @xmath0 by calculating the redshift back to last scattering along null geodesics in a perturbed universe .",
    "on smaller angular scales one must address the detailed local processes occurring in the electron / baryon plasma prior to recombination , and the effects of non - instantaneous last scattering .",
    "these processes , which give rise to a wealth of structure in the cmb power spectrum on intermediate scales and damping on small scales ( see , for example , silk ( 1967 , 1968 ) ) , are best addressed by following the photon distribution function directly from an early epoch in the history of the universe to the current point of observation .",
    "this requires a numerical integration of the boltzmann equation , and has been carried out by many groups , of which peebles &  yu ( 1970 ) , bond &  efstathiou ( 1984 , 1987 ) , hu & sugiyama ( 1995 ) , ma &  bertshcinger ( 1995 ) , seljak &  zaldarriaga ( 1996 ) is a representative sample .    the calculation of cmb anisotropies is simple in principle , but in reality is plagued with subtle gauge issues ( stoeger , ellis , &  schmidt 1991 ; stoeger et al .",
    "1995 ; challinor &  lasenby 1998 ) .",
    "these problems arise because of the gauge - freedom in specifying a map @xmath1 between the real universe ( denoted by @xmath2 ) and the unperturbed background model(denoted by @xmath3 )  @xcite , which is usually taken to be a friedmann - robertson - walker ( frw ) universe .",
    "the map @xmath1 identifies points in the real universe with points in the background model , thus defining the perturbation in any quantity of interest .",
    "for example , for the density @xmath4 as measured by some physically defined observer , the perturbation at @xmath5 is defined to be @xmath6 , where @xmath7 is the equivalent density in the background model , and @xmath8 maps to @xmath9 under @xmath1 .",
    "the map @xmath1 is usually ( partially ) specified by imposing coordinate conditions in @xmath2 and @xmath3 . any residual freedom in the map @xmath1 after the imposition of the coordinate conditions ( gauge - fixing ) gives rise to the following gauge problems : ( i ) the map can not be reconstructed from observations in @xmath2 alone , so that quantities such as the density perturbation , which depend on the specific map @xmath1 , are necessarily not observable ; ( ii ) if the residual gauge freedom allows points in @xmath3 to be mapped to physically inequivalent points in @xmath3 in the limit that @xmath10 , then unphysical gauge mode solutions to the linearised perturbation equations will exist .",
    "there are several ways to deal with the gauge problems described above . in the earliest approach  @xcite ,",
    "one retains the residual gauge freedom ( in the synchronous gauge ) but keeps track of it so that gauge mode solutions can be eliminated .",
    "furthermore , the final results of such a calculation must be expressed in terms of the physically relevant , gauge - invariant quantities .",
    "although there is nothing fundamentally wrong with this approach if carried out correctly , it suffers from a long history littered with confusion and errors .",
    "the need to express results in terms of gauge - invariant variables suggests that it might be beneficial to employ such variables all along as the dynamical degrees of freedom in the calculation .",
    "a further advantage of such an approach is that gauge modes are automatically eliminated from the perturbation equations when expressed in terms of gauge - invariant variables .",
    "this is the approach adopted by bardeen ( 1980 ) , who showed how to construct gauge - invariant variables for scalar , vector and tensor modes in linearised perturbation theory , by taking suitable linear combinations of the gauge - dependent perturbations in the metric and matter variables .",
    "this approach has been used in several calculations of the cmb anisotropy ( see , for example , abbott &  schaefer ( 1986 ) and panek ( 1986 ) )",
    ". however , the bardeen variables are not entirely satisfactory .",
    "the approach is inherently linear , so that the variables are only defined for small departures from frw symmetry .",
    "furthermore , the approach assumes a non - local decomposition of the perturbations into scalar , vector and tensor modes at the outset , each of which is then treated independently . as a result ,",
    "the bardeen variables are only gauge - invariant for the restricted class of gauge - transformations that respect the scalar , vector and tensor splitting . finally , although the bardeen variables are gauge - invariant , they are not physically transparent , in that , in a general gauge , they do not characterise the perturbations in a manner that is amenable to simple physical interpretation .",
    "an alternative scheme for the gauge - invariant treatment of cosmological perturbations was given by ellis &  bruni ( 1989 ) ( see also , ellis , hwang , &  bruni ( 1989 ) ) who built upon earlier work by hawking ( 1966 ) . in this approach , which is derived from the covariant approach to cosmology / hydrodynamics of ehlers and ellis ( ehlers 1993 ; ellis 1971 ) , the perturbations are described by gauge - invariant variables that are covariantly defined in the real universe .",
    "this ensures that the variables have simple physical interpretations in terms of the inhomogeneity and anisotropy of the universe .",
    "since the definition of the covariant variables does not assume any linearisation , exact equations can be found for their evolution , which can then be linearised around the chosen background model .",
    "furthermore , the covariant approach does not employ the non - local decomposition into scalar , vector or tensor modes , at a fundamental level .",
    "if required , the decomposition can be performed at a late stage in the calculation to aid solving the equations . even if one denies that working with gauge - invariant variables is a significant advantage , the key advantage of the covariant approach , however ,",
    "is that one is able to work exclusively with physically relevant quantities , satisfying equations that make manifest their physical consequences .",
    "the covariant and gauge - invariant approach has already been applied to the line of sight calculation of cmb anisotropies under the instantaneous recombination approximation ( dunsby 1997 ; challinor &  lasenby 1998 ) , and has been used to obtain model - independent limits on the inhomogeneity and anisotropy from measurements of the cmb anisotropy on large scales  @xcite . in this paper , we extend the methodology developed in these earlier papers , to give a full kinetic theory calculation of cmb anisotropies valid on all angular scales . our motivation for reconsidering this problem is two - fold .",
    "firstly , it is our belief that the covariant and gauge - invariant description of cosmological perturbations provides a powerful set of tools for the formulation of the basic perturbation equations , and their subsequent interpretation , which are superior to the techniques usually employed in such calculations for the reasons discussed above .",
    "in particular , by applying covariant methods for the problem of the generation of cmb anisotropies , we can expect the same advantages of physical clarity and unification that have already been demonstrated in other areas , ( ellis et al .",
    "1989 ; bruni , ellis , &  dunsby 1992 ; dunsby , bruni , & ellis 1992 ; dunsby , bassett , &  ellis 1996 ; tsagas &  barrow 1997 ) .",
    "the approach described here brings the underlying physics to the fore , and can only help to consolidate our rapidly growing understanding of the physics of cmb anisotropies .",
    "furthermore , although we only consider the linearised calculation here , the extension of these methods to the full non - linear case is quite straightforward ( maartens , gebbie , &  ellis 1998 ) .",
    "our second motivation is to perform an independent verification of the results of other groups ( for example , ma &  bertschinger ( 1995 ) ) , with a methodology that is free from any of the gauge ambiguities that have caused problems and confusion in the past . given the potential impact on cosmology of the next generation of cmb data , we believe that the above comments provide ample justification for reconsidering this problem .    for definiteness we consider the cold dark matter ( cdm ) model , although the methods we describe are straightforward to extend to other models .",
    "we have endeavoured to make this paper reasonably self - contained , so we begin with a brief overview of the covariant approach to cosmology and define the key variables we use to characterise the perturbations in section  [ sec_cov ] .",
    "we then go on to present a complete set of frame - independent equations describing the evolution of the matter components and radiation in section  [ sec_eqs ] in an almost - frw universe ( with arbitrary spatial curvature ) .",
    "these equations , which employ only covariantly defined , gauge - invariant variables , are independent of any harmonic analysis ; they describe scalar , vector and tensor perturbations in a unified manner .",
    "many of the equations have simple newtonian analogues , and their physical consequences are far more transparent than the equations that underlie the metric - based approaches .",
    "equations pertinent to scalar modes , see section  [ sec_scal ] , and tensor modes , see section  [ sec_tens ] , can be obtained from the full set of equations with very little effort , and are useful at this late stage in the calculation as an aid to solving the linearised equations .",
    "a significant feature of this approach is that a covariant angular decomposition of the distribution functions is made early on in the calculation , before any splitting into scalar , vector and tensor modes .",
    "this allows scalar , vector and tensor modes to be treated in a more unified manner .",
    "in particular , the azimuthal dependence of the moments of the distribution functions does not have to be put in by hand ( after inspection of the azimuthal dependence of the other terms in the boltzmann equation ) , as happens in most metric - based calculations .",
    "this is particularly significant for tensor modes where the required azimuthal dependence is non - trivial and is different for the two polarisations of gravitational waves .",
    "we consider the equations for scalar modes in considerable detail .",
    "we present the integral solution of the boltzmann multipole equations in a @xmath11 almost - frw universe , and discuss the relation between line of sight methods ( which employ lightlike integrations along the lightcone ) and the boltzmann multipole approach ( where a timelike integration is performed ) .",
    "we derive analytic solutions for scalar modes in the early radiation dominated universe , that are used as initial conditions for the numerical solution of the scalar equations , the results of which we describe in section  [ sec_num ] . in section  [ sec_tens ]",
    "we give a brief discussion of the tensor equations in the covariant approach .",
    "the covariant angular decomposition naturally gives rise to a set of variables that describe the temperature anisotropy in a more direct manner than in the conventional metric - based approaches .",
    "this is particularly apparent for tensor perturbations , where the cmb power spectrum at a given multipole @xmath12 is determined by the @xmath13 , @xmath12 and @xmath14-th moments of the conventional decomposition of the photon distribution function , which obscures the physical interpretation of these moments .",
    "finally , we end with our conclusions in section  [ sec_conc ] . ultimately",
    ", our results confirm those of other groups ( for example , ma &  bertschinger ( 1995 ) ) who have performed similar calculations by working carefully in specific gauges , but are obtained here with a unified methodology that is more physically transparent and less prone to lead to confusion over subtle gauge effects .",
    "we employ standard general relativity and use a @xmath15 metric signature .",
    "our conventions for the riemann and ricci tensors are fixed by @xmath16 u^{c } = -{{{\\mathcal{r}}}_{abd}}^{c } u^{d}$ ] , and @xmath17 .",
    "round brackets around indices denote symmetrisation on the indices enclosed , and square brackets denote antisymmetrisation .",
    "we use units with @xmath18 throughout , and a unit of distance of @xmath19 for numerical work .",
    "in this section , we summarise the covariant approach to cosmology ( ehlers 1993 ; ellis 1971 ; hawking 1966 ) and the gauge - invariant perturbation theory of ellis &  bruni ( 1989 ) which is derived from it .",
    "we begin by choosing a velocity field @xmath20 which satisfies the following criterion : _ the velocity must be physically defined such that it reduces to the four velocity of the fundamental observers in the friedmann - robertson - walker ( frw ) limit_. this restriction on @xmath20 is essential to ensure gauge - invariance of the ellis &  bruni perturbation theory .",
    "note that , in a general perturbed spacetime , there is no unique choice for @xmath20 .",
    "acceptable choices for @xmath20 include the four velocity of a given matter component , and the timelike eigenvector of the stress - energy tensor . in the covariant approach to perturbations in cosmology , covariant variables are introduced that describe the inhomogeneity and anisotropy of the universe .",
    "these variables employ the velocity field @xmath20 in their definition , and so , in a given spacetime , their values depend on how we choose @xmath20 ( the exact transformation laws are given in maartens et al .",
    "( 1998 ) ) . for a given choice of @xmath20 , the covariant variables , defined below , describe the results of observations made by observers comoving with the velocity @xmath20 , and their frame - dependence",
    "reflects the fact that the observations depend on the velocity of the observer . it might be thought that the freedom in the choice of velocity would introduce similar ambiguities as the choice of map @xmath1 does in conventional approaches .",
    "however , this is not the case because of the restriction on @xmath20 that we emphasised above .",
    "it is certainly true that , with a suitable choice of @xmath20 , we can eliminate some aspect of the inhomogeneity and isotropy observed .",
    "for example , we can always choose @xmath20 so that the cmb dipole vanishes .",
    "however , in a given spacetime , the covariant variables can not be forced to take arbitrary values through some particular choice of @xmath20 . in particular ,",
    "if , for some timelike velocity field ( not necessarily restricted to satisfy the criterion emphasised above ) , _ all _ of the gauge - invariant variables defined below vanish identically , then the universe is necessarily frw .",
    "this gives a covariant condition which characterises the frw limit , but note that , if @xmath20 is unrestricted , we could have the situation where the universe is frw , but we are not viewing it from the perspective of the fundamental observers and so some of the variables would not vanish .",
    "( this is similar to the presence of gauge mode solutions in the metric - based approach . ) however , if we ensure that @xmath20 is defined physically , so that in the frw limit it necessarily reduces to the velocity of the fundamental observers , this situation can not arise , and the variables used to characterise the anisotropy and inhomogeneity are genuinely gauge - invariant .",
    "we refer to the choice of velocity as a frame choice . in this paper",
    ", we defer making a frame - choice until we have derived all the relevant equations , so that we have available a set of equations valid for any choice of @xmath20 .",
    "however , to actually solve the equations , we must make a definite choice for @xmath20 ( the system of equations is under - determined until such a choice is made ) . here",
    ", it will be convenient to choose @xmath20 to coincide with the velocity of the cdm component , since @xmath20 is then geodesic .",
    "the velocity @xmath20 defines a projection tensor @xmath21 which projects into the space perpendicular to @xmath20 ( the instantaneous rest - space of observers moving with velocity @xmath20 ) : @xmath22 where @xmath23 is the spacetime metric .",
    "since @xmath21 is a projection tensor it satisfies @xmath24 we employ the projection tensor to define a spatial covariant derivative @xmath25 which acting on a tensor @xmath26 returns a tensor which is orthogonal to @xmath20 on every index : @xmath27 where @xmath28 denotes the usual covariant derivative .",
    "if the velocity field @xmath20 has vanishing vorticity ( see later ) @xmath25 reduces to the covariant derivative in the hypersurfaces orthogonal to @xmath20 .",
    "the covariant derivative of the velocity decomposes as @xmath29 where @xmath30 is the acceleration , which satisfies @xmath31 , the scalar @xmath32 is the volume expansion rate ( @xmath33 is the local hubble parameter ) , @xmath34 } + w_{[a}u_{b]}$ ] is the vorticity tensor , which satisfies @xmath35}$ ] and @xmath36 , and @xmath37 is the shear tensor which satisfies @xmath38 , @xmath39 and @xmath40 . the non - trivial integrability condition @xmath41 } \\phi = -\\varpi_{ab } \\dot{\\phi } , \\label{eq_intcon}\\ ] ] for any scalar field @xmath42 , where an overdot denotes the action of the operator @xmath43 , follows from the ricci identity .",
    "note in particular that in an evolving universe ( @xmath44 ) , spatial gradients are necessarily non - vanishing in the presence of vorticity .",
    "this behaviour , which is a consequence of there being no global hypersurfaces which are everywhere orthogonal to @xmath20 if the vorticity does not vanish , is central to the discussion of vector perturbations . for vanishing vorticity",
    ", the 3-ricci scalar ( or intrinsic - curvature scalar ) @xmath45 in the hypersurfaces orthogonal to @xmath20 evaluates to @xmath46 where @xmath4 is the total energy density in the @xmath20 frame .    in an exact frw universe the vorticity ,",
    "shear and acceleration vanish identically . in an almost - frw universe , these variables , when suitably normalised to make them dimensionless , are regarded as first - order in a smallness parameter @xmath47 ( maartens et al .",
    "we use the convenient notation , @xmath48 to denote that a variable is @xmath49 .",
    "we assume that products of first - order variables can be neglected from any expression in the linearised calculation considered here .",
    "other first - order variables may be obtained by taking the spatial gradient of scalar quantities .",
    "such quantities are gauge - invariant by construction since they vanish identically in an exact frw universe .",
    "we shall make use of the comoving fractional spatial gradient of the density @xmath50 of a species @xmath51 , @xmath52 and the comoving spatial gradient of the expansion @xmath53 the scalar @xmath2 is a local scale factor satisfying @xmath54 which removes the effects of the expansion from the spatial gradients defined above .",
    "the vector @xmath55 is a manifestly covariant and gauge - invariant characterisation of the density inhomogeneity .",
    "the matter stress - energy tensor @xmath56 decomposes with respect to @xmath20 as @xmath57 where @xmath58 is the density of matter ( measured by a comoving observer ) , @xmath59 is the energy ( or heat ) flux and is orthogonal to @xmath20 , @xmath60 is the isotropic pressure , and the symmetric traceless tensor @xmath61 is the anisotropic stress , which is also orthogonal to @xmath20 . in an exact frw universe , isotropy restricts @xmath56 to perfect - fluid form , so that in an almost - frw universe the heat flux and isotropic stress may be treated as first - order variables .",
    "the final first - order gauge - invariant variables we require derive from the weyl tensor @xmath62 , which vanishes in an exact frw universe due to isotropy .",
    "the electric and magnetic parts of the weyl tensor , denoted by @xmath63 and @xmath64 respectively , are symmetric traceless tensors , orthogonal to @xmath20 , which we define by @xmath65 where @xmath66 is the covariant permutation tensor with @xmath67 .      exact equations describing the propagation of the total matter variables ( such as the total density @xmath4 ) , the kinematic variables , and the electric and magnetic parts of the weyl tensor , and the constraints between them , follow from the ricci identity and the bianchi identity .",
    "the riemann tensor is expressed in terms of @xmath63 , @xmath64 and the ricci tensor , @xmath68 , and the einstein equation is used to substitute for the ricci tensor in terms of the matter stress - energy tensor .",
    "on linearising the equations that result from this procedure ( bruni , dunsby , & ellis 1992 ) , one obtains five constraint equations : @xmath69 & = & 0 \\label{eq_cons2 } \\\\ { { } ^{(3)}\\nabla}^{b } { { \\mathcal{e}}}_{ab } - { { \\case{1}{6}}}\\kappa \\left(2 { { } ^{(3)}\\nabla}_{a } \\rho + 2 \\theta q_{a } + 3 { { } ^{(3)}\\nabla}^{b } \\pi_{ab } \\right ) & = & 0 \\label{eq_cons3 } \\\\ { { } ^{(3)}\\nabla}^{b } \\varpi_{ab } + { { } ^{(3)}\\nabla}^{b } \\sigma_{ab } - { { \\case{2}{3 } } } { { } ^{(3)}\\nabla}_{a } \\theta - \\kappa q_{a } & = & 0 \\label{eq_cons4 } \\\\ { { } ^{(3)}\\nabla}^{c } \\left ( \\eta_{abcd } u^{d } \\varpi^{ab}\\right ) & = & 0 , \\label{eq_cons5}\\end{aligned}\\ ] ] and seven propagation equations : @xmath70 & = & 0 \\label{eq_prop1}\\\\ \\dot{{{\\mathcal{b}}}}_{ab } + \\theta { { \\mathcal{b}}}_{ab } - \\left({{}^{(3)}\\nabla}^{c } { { \\mathcal{e}}}_{d(a } + { \\case{1}{2}}\\kappa { { } ^{(3)}\\nabla}^{c } \\pi_{d(a } \\right ) { \\eta_{b)ce}}^{d } u^{e } & = & 0 \\label{eq_prop2 } \\\\ \\dot{\\sigma}_{ab } + { { \\case{2}{3}}}\\theta \\sigma_{ab } - \\left({{}^{(3)}\\nabla}_{(a } w_{b ) } - { { \\case{1}{3 } } } h_{ab}{{}^{(3)}\\nabla}^{c } w_{c }",
    "\\right ) + { { \\mathcal{e}}}_{ab } + { \\case{1}{2}}\\kappa \\pi_{ab } & = & 0 \\label{eq_prop3 } \\\\ \\dot{\\varpi}_{ab } - { { } ^{(3)}\\nabla}_{[a}w_{b ] } + { { \\case{2}{3 } } } \\theta \\varpi_{ab } & = & 0 \\label{eq_prop4 } \\\\",
    "\\dot{q}_{a } + { \\case{4}{3 } } \\theta q_{a } + ( \\rho + p ) w_{a } + { { } ^{(3)}\\nabla}^{b } \\pi_{ab } - { { } ^{(3)}\\nabla}_{a } p & = & 0 \\label{eq_prop5 } \\\\",
    "\\dot{\\theta } + { { \\case{1}{3 } } } \\theta^{2 }   - { { } ^{(3)}\\nabla}^{a } w_{a } + { \\case{1}{2}}\\kappa ( \\rho + 3 p ) & = & 0 \\label{eq_prop6 } \\\\",
    "\\dot{\\rho } + \\theta ( \\rho + p ) + { { } ^{(3)}\\nabla}^{a } q_{a } & = & 0 , \\label{eq_prop7}\\end{aligned}\\ ] ] where @xmath71 .",
    "the constraint equations do not involve time derivatives , and so they serve to constrain initial data for the problem .",
    "the propagation equations are consistent with the constraint equations in the sense that the constraints are preserved in time by the propagation equations if they are satisfied initially .",
    "the consistency of the exact equations follows from their derivation from the exact field equations , and is preserved by the linearisation procedure . including a cosmological constant @xmath72 in the above equations is straightforward ; one adds a contribution @xmath73 to the total density @xmath4 , and subtracts the same term from the total pressure @xmath74 .",
    "many of the equations given above have simple newtonian analogues  @xcite , and thus are simple to interpret physically .",
    "the analogues arise because many of the covariantly defined variables have counterparts in ( self - gravitating ) newtonian hydrodynamics .",
    "an important exception is that there is no newtonian analogue of the magnetic part of the weyl tensor ( the electric part is analogous to the tidal part of the newtonian gravitational potential ) , and no equation analogous to the @xmath75 propagation equation  @xcite .",
    "these exceptions arise because of the instantaneous interaction in newtonian gravity , which excludes the possibility of gravitational wave solutions to the newtonian equations . however , there is a close analogy between the @xmath75 and @xmath76 propagation equations and the constraint equations  ( [ eq_cons2 ] ) and  ( [ eq_cons3 ] ) , and maxwell s equations split with respect to an arbitrary timelike velocity field ( see , for example , maartens &  bassett ( 1998 ) ) .",
    "there is some redundancy in the full set of linear equations .",
    "( see maartens ( 1997 ) for a discussion of the redundancy in the exact non - linear equations for an irrotational dust universe . ) for example , equation  ( [ eq_cons1 ] ) , which determines @xmath64 in terms of the vorticity and the shear , along with equation  ( [ eq_cons4 ] ) and the integrability condition given as equation  ( [ eq_intcon ] ) imply equation  ( [ eq_cons2 ] ) .",
    "similarly , equation  ( [ eq_prop2 ] ) follows from equation  ( [ eq_cons1 ] ) and the propagation equations for the shear ( eq .",
    "@xmath77 $ ] ) and the vorticity ( eq .  @xmath78 $ ] ) .",
    "it follows that @xmath64 may be eliminated from the equations in favour of the vorticity and the shear by making use of equation  ( [ eq_cons1 ] ) .",
    "this elimination is useful when discussing the propagation of vector and tensor modes ( see section  [ sec_tens ] ) .",
    "the usual friedmann equations describing homogeneous and isotropic cosmological models are readily obtained from the full set of covariant equations , since in an exact frw universe the only non - trivial propagation equations are the raychaudhuri equation ( eq .",
    "[ [ eq_prop6 ] ] ) and the energy conservation equation ( eq .  [ [ eq_prop7 ] ] ) , which reduce to the friedmann equation @xmath79 and the usual equation for the density evolution @xmath80 the second friedmann equation is obtained as a first integral of these two equations : @xmath81 where @xmath82 is the intrinsic curvature scalar of the surfaces of constant cosmic time .",
    "the fractional comoving spatial gradient of the density , @xmath83 , and the comoving spatial gradient of the expansion rate , @xmath84 , are the key variables in the covariant discussion of the growth of inhomogeneity in the universe ( ellis &  bruni 1989 ; ellis et al .",
    "it is useful to have available the propagation equations for these variables . for @xmath83 , we take the spatial gradient of the density evolution equation ( eq .  [ [ eq_prop7 ] ] ) and commute the space and time derivatives , to obtain @xmath85 for @xmath84 , we take the spatial gradient of the raychaudhuri equation ( eq .  [ [ eq_prop6 ] ] ) which gives @xmath86w_{a } + { { \\case{1}{2 } } } \\kappa s \\left ( { { } ^{(3)}\\nabla}_{a } \\rho + 3 { { } ^{(3)}\\nabla}_{a } p \\right)}\\hspace{+8 cm } \\nonumber \\\\ & & \\mbox { } - s { { } ^{(3)}\\nabla}_{a } { { } ^{(3)}\\nabla}^{b } w_{b } = 0,\\end{aligned}\\ ] ] for an ideal fluid ( @xmath87 when we choose @xmath20 to be the fluid velocity ) , with a barotropic equation of state @xmath88 , the propagation equations for @xmath83 and @xmath84 combine with the momentum conservation equation ( eq . ) and the integrability condition , given as equation  ( [ eq_intcon ] ) , to give an inhomogeneous second - order equation for @xmath83  @xcite . for a simple equation of state @xmath89 , where @xmath90 is a constant , the second - order equation is @xmath91 from this equation , it is straightforward to recover the usual results for the growth of inhomogeneities in an almost - frw universe  @xcite .",
    "the inhomogeneous term describes the coupling between the vorticity and the spatial gradient of the density , which arises from the lack of global hypersurfaces orthogonal to @xmath20 in the presence of non - vanishing vorticity . in reality , the universe can not be described by a barotropic perfect fluid .",
    "a more careful analysis of the individual matter components is required , which we present in the next section .",
    "in this paper we concentrate on cdm models , so the matter components that we must consider are the photons and neutrinos , which are the only relativistic species , and the tightly - coupled baryon / electron system and the cdm , which are both non - relativistic over the epoch of interest .",
    "we consider the description of each of these components separately in this section .      in relativistic kinetic theory ( see , for example , misner , thorne , & wheeler ( 1973 ) ) ,",
    "the photons are described by a scalar - valued distribution function @xmath92 .",
    "an observer sees @xmath93 photons at the spacetime point @xmath8 in a proper volume @xmath94 , with covariant momentum @xmath95 in a proper volume @xmath96 of momentum space .",
    "the photon momentum @xmath95 decomposes with respect to the velocity @xmath20 as @xmath97 where @xmath98 is the energy of the photon , as measured by an observer moving with velocity @xmath20 , and @xmath99 is a unit spacelike vector which is orthogonal to @xmath20 : @xmath100 which describes the propagation direction of the photon in the instantaneous rest space of the observer . with this decomposition of the momentum , we may write the photon distribution function in the form @xmath101 when convenient , where the dependence on spacetime position @xmath8 has been left implicit . the stress - energy tensor @xmath102 for the photons may then be written as @xmath103 where the measure @xmath104 denotes an integral over solid angles . the photon energy density @xmath105 , the heat flux @xmath106 , and the anisotropic stress @xmath107 are given by integrals of the three lowest moments of the photon distribution function : @xmath108 in the absence of scattering , the photon distribution is conserved in phase space .",
    "denoting the photon position by @xmath109 and the momentum by @xmath110 , the path in phase space is described by the equations @xmath111 where @xmath112 is an affine parameter along the null geodesic @xmath109 . denoting the liouville operator by @xmath113",
    ", we have @xmath114 in the absence of collisions . over the epoch of interest here ,",
    "the photons are not collisionless , but instead are interacting with a thermal distribution of electrons and baryons .",
    "the dominant contribution to the scattering comes from compton scattering off free electrons , which have number density @xmath115 in the baryon / electron rest frame . since the average energy of a cmb photon is small compared to the electron mass well after electron - positron annihilation , we may approximate the compton scattering by thomson scattering . furthermore , since the kinetic temperature of the electrons ( which equals the radiation temperature prior to recombination ) is small compared to the electron mass , the electrons are non - relativistic and we may ignore the effects of thermal motion of the electrons ( in the average rest frame of the baryon / electron system ) on the scattering . our final assumption is to ignore polarisation of the radiation .",
    "thomson scattering of an unpolarised but anisotropic distribution of radiation leads to the generation of polarisation , which then affects the temperature anisotropy because of the polarisation dependence of the thomson cross section @xmath116 . in this manner ,",
    "polarisation of the cmb is generated through recombination and its neglect leads to errors of a few percent  @xcite in the predicted temperature anisotropy .",
    "we hope to develop a covariant version of the radiative transfer equations including polarisation in the near future , which should simplify their physical interpretation .    in the presence of scattering ,",
    "the photon distribution function evolves according to the collisional boltzmann equation , @xmath117 where the collision operator for thomson scattering is @xmath118 , \\label{eq_clc}\\ ] ] where @xmath119 is the covariant velocity of the baryon / electron system and @xmath120 describes scattering into the phase space element under consideration : @xmath121 \\ , d\\omega_{e^{\\prime ( b)}},\\ ] ] where @xmath122 is the photon direction relative to @xmath123 , @xmath124 and @xmath125 is the initial direction ( relative to @xmath123 ) of the photon whose initial momentum is @xmath126 and final momentum is @xmath127 .",
    "we write the baryon velocity in the form @xmath128 where @xmath129 is the relative velocity of the baryons , which satisfies @xmath130 , and @xmath131 .",
    "note that to first - order we have @xmath132 since the relative velocities of the individual matter components are first - order in an almost - frw universe . multiplying the boltzmann equation by @xmath133 and integrating over energies , we find @xmath134^{-3 } \\int de^{(b)}\\ , { e^{(b)}}^{3 } f_{+}^{(\\gamma)}(x , p)\\nonumber \\\\ & & \\mbox { } - { n_{e}}\\sigma_{t}\\gamma^{(b ) } \\left(1+e^{a}v_{a}^{(b)}\\right ) \\int de\\ , e^{3 } f^{(\\gamma)}(e , e),\\end{aligned}\\ ] ] where we have used @xmath135 to replace the integral over @xmath136 by an integral over @xmath137 in the first - term on the right .",
    "this term can be rewritten as an integral over @xmath138 using the fact that there is no energy transfer in thomson scattering in the rest frame of the scattering electron , so that @xmath139 f^{(\\gamma)}(x , p).\\ ] ] using the definition of the radiation stress - energy tensor ( eq .  ( [ eq_radset ] ) ) in the right - hand side , we have @xmath140 where @xmath122 can be expressed as @xmath141^{-1 } ( u_{a } + e_{a } ) - \\gamma^{(b ) } \\left(u_{a } + v_{a}^{(b)}\\right).\\ ] ] it follows that the energy - integrated boltzmann equation reduces to @xmath142^{-3 } g^{ab}g^{cd}{{\\mathcal{t}}}_{bd}^{(\\gamma ) } \\left ( u_{a}^{(b)}u_{c}^{(b ) } + e_{a}^{(b ) } e_{c}^{(b)}\\right ) \\nonumber \\\\ & & \\mbox { } - { n_{e}}\\sigma_{t } \\gamma^{(b ) } \\left(1+e^{a}v_{a}^{(b)}\\right ) \\int de\\ , e^{3 } f^{(\\gamma)}(e , e ) .",
    "\\label{eq_bolex}\\end{aligned}\\ ] ] this equation is exact under the assumption of thomson scattering and the neglect of polarisation . here",
    ", we shall only require the linearised version of equation  ( [ eq_bolex ] ) ; for a covariant discussion of the second - order effects in this equation , see maartens et al .",
    "on linearising equation  ( [ eq_bolex ] ) around an almost - frw universe , we find @xmath143}\\hspace{8cm}\\nonumber \\\\ & & \\mbox { } - { n_{e}}\\sigma_{t } \\int de\\ , e^{3 } { f^{(\\gamma)}}(e , e ) .",
    "\\label{eq_boltz}\\end{aligned}\\ ] ] this covariant form of the boltzmann equation was used in challinor &  lasenby ( 1998 ) to discuss cmb anisotropies from scalar perturbations on angular scales above the damping scale .",
    "note that the equation is fully covariant with all variables observable in the real universe , is valid for arbitrary type of perturbation ( scalar , vector and tensor ) , employs no harmonic decomposition and is valid for any background frw model .    the numerical solution of the boltzmann equation ( eq .",
    "( [ eq_boltz ] ) ) is greatly facilitated by decomposing the equation into covariantly - defined angular moments .",
    "the majority of recent calculations ( for example , seljak & zaldarriaga ( 1996 ) ) perform an angular decomposition of the boltzmann equation after specifying the perturbation type and performing the appropriate harmonic expansions .",
    "the procedure is straightforward for scalar perturbations in a @xmath11 universe , where the fourier mode of the perturbation in the distribution function may be assumed to be axisymmetric about the wavevector @xmath144 ( this assumption is consistent with the evolution implied by the boltzmann equation ) , allowing an angular expansion in legendre polynomials alone .",
    "however , for tensor perturbations the situation is not so straightforward ( see , for example , kosowsky ( 1996 ) ) , since the boltzmann equation does not then support axisymmetric modes . instead",
    ", the necessary azimuthal dependence of the fourier components of the perturbation in the distribution function , which is different for the two polarisations of the tensor modes , must be put in by hand , prior to a legendre expansion in the polar angle .",
    "this procedure may be eliminated by performing a covariant angular expansion of @xmath92 prior to specifying the perturbation type or background frw model .",
    "the covariant ( tensor ) moment equations that result may then be solved for any type of perturbation ( and any background curvature @xmath145 ) by expanding in covariant tensors derived from the appropriate harmonic functions ( see section  [ sec_scal ] for the case of scalar perturbations and section  [ sec_tens ] for tensor perturbations ) .",
    "this procedure automatically takes care of the required angular dependencies of the harmonic components of the distribution function , allowing a streamlined and unified treatment of all perturbation types in background frw models with arbitrary spatial curvature .",
    "the covariant angular expansion of the photon distribution function takes the form ( ellis , matravers , &  treciokas 1983 , thorne 1981 ) @xmath146 where the tensors @xmath147 have an implicit dependence on spacetime position @xmath8 and energy @xmath136 , and are totally symmetric , traceless and orthogonal to @xmath20 : @xmath148 employing the expansion given in equation  ( [ eq_exp ] ) , the action of the liouville operator on @xmath101 reduces to @xmath149 e^{a_{2}}\\ldots e^{a_{l}}. \\label{eq_liou1}\\ ] ] using the geodesic equation , we find that @xmath150 which is first - order . in an exact frw universe",
    ", isotropy restricts @xmath151 for @xmath152 , so that in an almost - frw universe @xmath153 for @xmath12 not equal to zero .",
    "it follows that the last term in equation  ( [ eq_liou1 ] ) makes only a second - order contribution and may be dropped in the linear calculation considered here .    inserting the expansion given in equation  ( [ eq_exp ] ) into the boltzmann equation ( eq .  [ [ eq_boltz ] ] ) and performing a covariant angular expansion of the resulting equation gives a set of moment equations which are equivalent to the original boltzmann equation .",
    "the linearised calculation is straightforward , although a little care is needed for the first three moments since @xmath154 is a zero - order quantity .",
    "( the exact expansion of the left - hand side of the boltzmann equation , equation  ( [ eq_liou1 ] ) , is given in ellis et al .  ( 1983 ) and thorne ( 1981 ) . ) for @xmath155 , @xmath156 and @xmath157 , we find @xmath158 and , for @xmath159 , @xmath160 the tensors @xmath161 , which are traceless , totally symmetric and orthogonal to @xmath20 , are derived from the @xmath162 by integrating over energy : @xmath163 the constant factor is chosen to simplify algebraic factors in the moment equations . using equations  ( [ eq_mom1][eq_mom3 ] ) , the lowest three moments relate simply to the energy density , heat flux and anisotropic stress : @xmath164 it is straightforward to show that the tensor @xmath165 which appears in equation  ( [ eq_moml ] ) is traceless , symmetric , and orthogonal to @xmath20 , as required .    it will be observed that for @xmath166 , the moment equations link the @xmath167 , @xmath12 and @xmath168 angular moments of the ( integrated ) distribution function , while the @xmath169 equation also involves the density @xmath105 which is the @xmath155 moment . the exact moment equations that arise from expanding the liouville equation in covariant harmonics",
    "also couple the @xmath170 and @xmath13 moments to @xmath161 ( ellis et al .  1983 ) , but these terms are second - order for @xmath166 and so do not appear in the linearised equations presented here . in the exact expansion of the liouville equation , the coefficient of the @xmath170 angular moment in the exact propagation equation for @xmath161 is the shear @xmath171 , which leads to the result that the angular expansion of the distribution function for non - interacting radiation can only truncate ( @xmath172 for all @xmath12 greater than some @xmath173 ) if the shear vanishes  @xcite .",
    "this exact result , which is lost in linearised theory which permits truncated distribution functions with non - vanishing shear , is an example of a linearisation instability ( see ellis &  dunsby ( 1997b ) for more examples ) .",
    "however , this is not problematic for the linearised calculation of cmb anisotropies since it is never claimed that the higher - order moments of the photon distribution vanish exactly .",
    "instead , the series is truncated ( with suitable care to avoid reflection of power back down the series ) for numerical convenience .",
    "the truncation is performed with @xmath173 large enough so that there is no significant effect on the @xmath161 for the range of @xmath12 of interest .    finally , by taking the spatial gradient of equation  ( [ eq_rhogamdt ] ) , and commuting the space and time derivatives",
    ", we find the propagation equation for the comoving fractional spatial gradient of the photon density , @xmath174 , @xmath175 where @xmath84 is the comoving spatial gradient of the volume expansion .",
    "we consider only massless neutrinos , and these are non - interacting over the epoch of interest .",
    "it follows that their distribution function @xmath176 satisfies the liouville equation @xmath177 .",
    "expanding the neutrino distribution function in covariant angular harmonics , we arrive at the moment equations for the tensors @xmath178 , which are defined in the same manner as the @xmath161 , but with the photon distribution function replaced by the neutrino distribution .",
    "these moment equations are the same as the photon equations , but with the scattering terms omitted :    @xmath179    and for @xmath166 , @xmath180 the propagation equation for the comoving fractional spatial gradient of the neutrino density , @xmath181 , follows from equation  ( [ eq_rhonudt ] ) : @xmath182      over the epoch of interest here , the electrons and baryons are non - relativistic , and may be approximated by a tightly - coupled ideal fluid ( the coupling arising from coulomb scattering ) .",
    "the energy density of the fluid is @xmath183 , which includes contributions from both the baryonic species and the electrons , the fluid pressure is @xmath184 , and the velocity of the fluid is @xmath185 to first - order , where the @xmath186 relative velocity @xmath187 satisfies @xmath188 .",
    "the linearised baryon stress - energy tensor evaluates to @xmath189 which shows that there is a heat flux @xmath190 due to the baryon motion relative to the @xmath20 frame .",
    "the equations of motion for @xmath183 and @xmath187 follow from the conservation of baryon plus photon stress - energy ( the baryons and photons interact through non - gravitational effects only with themselves ) : @xmath191 using the @xmath155 and @xmath192 moment equations for the photon distribution , we find the propagation equation for the baryon energy density : @xmath193 and a propagation equation for @xmath187 : @xmath194 which must be supplemented by an equation of state linking @xmath184 and @xmath183 .",
    "the final term in equation  ( [ eq_vbdt ] ) describes the exchange of momentum between the radiation and the baryon / electron fluid as a result of thomson scattering .",
    "there is no such term in equation  ( [ eq_rhobdt ] ) since both the radiation drag force and the baryon velocity relative to the @xmath20 frame are first - order , which give only a second - order rate of energy transfer in the @xmath20 frame .",
    "energy transfer due to thermal motion of the electrons in the baryon rest frame has negligible effect on @xmath183 since the electrons are non - relativistic ; @xmath195 , where @xmath196 is the baryon kinetic temperature ( assumed equal to the electron kinetic temperature ) , and @xmath197 is the electron mass .    taking the spatial gradient of equation  ( [ eq_rhobdt ] ) gives the propagation equation for @xmath198 , the fractional comoving spatial gradient of the baryon energy density : @xmath199 we have retained all terms involving the baryon pressure @xmath184 in the equations of this section . in practice , over epochs where the baryons are non - relativistic ( @xmath200 ) , the only pressure term that need be retained is the term @xmath201 which appears in equation  ( [ eq_vbdt ] ) .",
    "this term appears as a small correction to the total sound speed in the tightly - coupled baryon / photon plasma , and is potentially significant during the acoustic oscillations in the plasma .",
    "we will only consider cold dark matter ( cdm ) here , which may be described as a pressureless ideal fluid .",
    "hot dark matter ( hdm ) , which requires a phase space description , is considered in ma &  bertschinger ( 1995 ) , where the calculations for scalar perturbations are performed in the synchronous and conformal newtonian gauges .",
    "the cdm has energy density @xmath202 in its rest frame , which has velocity @xmath203 , with the first - order relative velocity @xmath204 satisfying @xmath205 .",
    "the linearised cdm stress - energy tensor evaluates to @xmath206 which is conserved since the cdm interacts with other species only through gravity .",
    "the conservation of @xmath207 gives the propagation equations for @xmath202 and @xmath204 : @xmath208 since the cdm moves on geodesics , the velocity @xmath209 provides a convenient frame choice . with this choice",
    ", the acceleration @xmath210 vanishes .",
    "we use the cdm frame to define the fundamental velocity @xmath20 in section  [ sec_scal ] , where we discuss scalar perturbations in the cdm model . for the moment , however , we continue to leave the choice of frame unspecified for generality .",
    "the final equation that we require is the propagation equation for the fractional comoving spatial gradient of the density , @xmath211 .",
    "this follows from equation  ( [ eq_rhocdt ] ) on taking the spatial gradient : @xmath212 the equations for the matter components that we have described in this section combine with the covariant equations of section  [ sec_cov ] to give a complete description of the evolution of inhomogeneity and anisotropy in a fully covariant and gauge - invariant manner .",
    "the equations given in section  [ sec_cov ] make use of the total energy density and pressure , heat flux and anisotropic stress .",
    "these quantities are related to the individual matter components in the cdm model by @xmath213 the equations given here are both covariant and gauge - invariant . employing gauge - invariant variables",
    "ensures that the problem of gauge - mode solutions does not arise , and that all quantities are independent of the choice of map between the real universe and a background frw model .",
    "we have only considered the linearised equations here , but the linearisation procedure is not fundamental to the covariant and gauge - invariant approach .",
    "it is straightforward to extend the treatment to include non - linear effects ( maartens et al .",
    "1998 ) , which should provide a systematic footing for the discussion of second - order effects on the cmb . indeed , the simplicity with which exact , non - linear equations can be written down and manipulated is a significant virtue of the covariant approach .",
    "unlike in bardeen s gauge - invariant approach  @xcite , the definition of the variables employed here does not require that the perturbations be in the linear regime , and furthermore , the variables do not depend on the non - local decomposition of the perturbations into scalar , vector and tensor type and the associated harmonic analysis .",
    "the covariant approach describes scalar , vector and tensor modes in a unified manner , although decomposing the linear perturbations is useful to aid solution of the linearised equations late on in the calculation .",
    "a further advantage of the covariant and gauge - invariant approach over that introduced by bardeen , is that only covariantly defined variables are employed , which are simple to interpret physically . in contrast , the bardeen variables are constructed by taking linear combinations of ( gauge - dependent ) metric and matter perturbations in such a way that the resulting variable is gauge - invariant ( for small gauge - transformations which preserve the scalar , vector or tensor structure of the metric perturbation ) .",
    "these variables have simple physical interpretations only for certain specific gauge choices . finally , note that we have not yet had to specify whether the background frw model is open , flat or closed .",
    "however , we have made the implicit assumption that the universe is almost frw when specifying the zero and first - order variables in the linearisation procedure .",
    "the energy - integrated moments @xmath161 of the photon distribution function provide a fully covariant description of the cmb temperature anisotropy . in the @xmath20 frame , denote the average bolometric temperature on the sky at the point @xmath8 by @xmath214 , so that @xmath215 which is just the stefan - boltzmann law .",
    "we use the fractional temperature variation @xmath216 from the full - sky average @xmath217 to characterise the temperature perturbation along the spatial direction @xmath218 in a gauge - invariant and covariant manner ( maartens et al .",
    "1995 ; dunsby 1997 ) .",
    "it follows that @xmath219 so that to first - order @xmath220 the right - hand side of equation  ( [ eq_deltat ] ) is the covariant angular expansion of the temperature anisotropy .",
    "the tensors @xmath161 thus provide a natural covariant description of the cmb anisotropy .",
    "they may be related to the more familiar @xmath221 components in the spherical harmonic expansion of @xmath216 by introducing an orthogonal triad in the instantaneous rest space at @xmath8 , so that @xmath222",
    ". then the two expansions are related by @xmath223 squaring this expression and integrating over solid angles , we find the important rotational invariant @xmath224 the quantity on the left is a quadratic estimator for the cmb power spectrum ( the @xmath225 ) , which we see is related to the covariant tensors @xmath161 in a very simple manner .",
    "further properties of the covariant and gauge - invariant description of cmb temperature anisotropies are given by gebbie &  ellis ( 1998 ) .",
    "up to this point , we have treated the scalar , vector and tensor modes of linear theory in a unified manner . however , to obtain solutions to the covariant equations it proves useful to consider scalar , vector and tensor modes separately . in this section",
    "we consider scalar modes ; tensor modes are discussed briefly in section  [ sec_tens ] .",
    "( vector modes decay in an expanding universe in the absence of defects , and so are not likely to have a significant effect on the cmb in inflationary models . ) in the covariant approach to perturbations in cosmology , we characterise scalar perturbations by demanding that the magnetic part of the weyl tensor and the vorticity be at most second - order . setting @xmath226 ensures that gravitational waves are excluded to first - order , and demanding that @xmath227 ensures that the density gradients seen by an observer in the @xmath20 frame arise from clumping of the density , @xmath228 , and not from kinematic effects due to vorticity ( the absence of flow - orthogonal hypersurfaces ) , which give @xmath229 in an almost - frw universe .",
    "note that we do not classify scalar perturbations as having @xmath230 ( to all orders ) , which is only a highly restricted subset of the full set of scalar solutions .",
    "for example , in an ( exactly ) irrotational dust - filled universe ( a `` silent '' universe ) , it can be shown from the exact non - linear equations that demanding @xmath231 forces the solution into a very small class , which probably all have high symmetry  @xcite , and so can not represent a very general perturbation .",
    "this arises because requiring that @xmath231 be preserved along the flow lines introduces a series of complex constraints which reduce greatly the size of the solution set .",
    "however , requiring only that @xmath64 and @xmath232 be at most second - order gives a much larger class of solutions because only two new constraints are introduced , and these are necessarily preserved by the propagation equations .",
    "the solutions with @xmath64 and @xmath232 vanishing exactly comprise a very small subset of the larger class of exact solutions which we classify as scalar perturbations .    on setting @xmath231 and @xmath233 , ( equality to zero in the linearised theory",
    "should be taken to imply that the quantity is at most second - order ) we see from equation  ( [ eq_cons1 ] ) that @xmath234c } = 0 , \\label{eq_sigscalcons}\\ ] ] where the antisymmetrisation is on the indices @xmath235 and @xmath236 in the right - hand equation .",
    "this is a necessary condition for @xmath171 to be constructed from a scalar potential .",
    "it follows from equations  ( [ eq_cons4 ] ) and  ( [ eq_prop4 ] ) that @xmath237 } = 0,\\qquad { { } ^{(3)}\\nabla}_{[a}w_{b ] } = 0,\\ ] ] so that the heat flux and acceleration may be written as spatial gradients of scalar fields ( making use of the integrability condition given as equation  ( [ eq_intcon ] ) ) .",
    "consistency of @xmath238 } = 0 $ ] with equation  ( [ eq_prop5 ] ) for @xmath239 then requires that @xmath240c } = 0 \\quad \\rightarrow \\quad { { } ^{(3)}\\nabla}_{[a } { { } ^{(3)}\\nabla}^{c } { { \\mathcal{e}}}_{b]c } = 0,\\ ] ] with the implication following from equation  ( [ eq_cons3 ] ) .",
    "it follows that all vector variables , such as @xmath239 and @xmath241 , may be derived from scalar potentials . the new constraint , given as equation  ( [ eq_sigscalcons ] ) ,",
    "is only consistent with the propagation equations if @xmath63 and @xmath242 satisfy @xmath243 in the absence of anisotropic stress , we see that the left - hand side of equation  ( [ eq_clescalcons ] ) is constrained to be zero , which is consistent with the propagation equation for @xmath63 , given as equation  ( [ eq_prop1 ] ) , with @xmath244 .",
    "if the anisotropic stress does not vanish , we include the constraint @xmath245 in the definition of a scalar mode , which is easily shown to be consistent with the propagation equation for @xmath63 .",
    "requiring consistency of equation  ( [ eq_piscalcons ] ) with the propagation equation for @xmath242 implied by the photon and neutrino boltzmann hierarchy yields a series of constraints on the moments @xmath161 and @xmath246 , which are necessary conditions for them to be derived from scalar potentials .",
    "the new constraint equations that we have introduced , by restricting the solution to be a scalar mode , may be satisfied by constructing the covariant and gauge - invariant variables from tensors derived from scalar potentials by taking appropriate spatial covariant derivatives of the scalar functions .",
    "it proves convenient to separate the temporal and spatial aspects of the problem by expanding the scalar potentials in the eigenfunctions @xmath247 of the generalised helmholtz equation ( hawking 1966 ; ellis et al .",
    "1989 ) @xmath248 which are constructed to satisfy @xmath249 these equations are correct to zero - order only ; in such equations , equality should be understood to this order only . in general",
    ", we can not impose equation  ( [ eq_scalqk ] ) and @xmath250 exactly , since the constraint equation is inconsistent with the evolution implied by @xmath250 at first - order .",
    "the allowed values of the eigenvalues @xmath251 are determined by the scalar curvature of the background model ( since @xmath247 are only needed to zero - order ) . in a flat model , @xmath11 ,",
    "@xmath252 is a comoving continuous wavenumber @xmath253 . in closed models , @xmath254",
    ", @xmath252 takes only discrete values with @xmath255 where @xmath90 is a non - zero , positive integer . in open models , @xmath256",
    ", @xmath252 again takes continuous values , but with the restriction @xmath257 .",
    "more details may be found in harrison ( 1967 ) .",
    "the eigenfunctions @xmath247 are labelled by the lumped index @xmath252 .",
    "this index , which determines the eigenvalue @xmath251 , should be understood to distinguish implicitly the distinct degenerate eigenfunctions which all have the same eigenvalue @xmath251 .",
    "this multiple use of the symbol @xmath252 should not cause any confusion , since the lumped index will always appear as a superscript or subscript .",
    "a function of the eigenvalue @xmath252 will be denoted with the eigenvalue as an argument , for example @xmath258 , to distinguish it from the quantity @xmath259 which depends on the mode label @xmath252 and not just the eigenvalue . from the @xmath247",
    "we form a vector @xmath260 , @xmath261 which is orthogonal to @xmath20 and is parallel transported at zero - order along the flow lines : @xmath262 we define totally symmetric tensors of rank @xmath12 , @xmath263 , by the recursion formula ( for @xmath264 ) ( see also gebbie &  ellis ( 1998 ) ) @xmath265 these tensors satisfy the zero - order properties @xmath266 which are readily proved by induction .    the scalar functions @xmath247 are the covariant generalisations of the scalar eigenfunctions of the laplace - beltrami operator on the homogeneous spatial sections of the background frw model , which are usually employed in the harmonic decomposition of perturbed quantities ( see , for example , bardeen ( 1980 ) ) . in the covariant approach",
    ", attention is focused on a velocity field @xmath20 , rather than a spatial slicing of spacetime , so it is natural to employ harmonic functions defined by equation  ( [ eq_scalqk ] ) . some of the differential properties of the derived tensors @xmath267 ( for @xmath268 ) are given in the appendix to bruni et al .",
    "we add two more results to this list which will be useful later : @xmath269 { q^{(k)}}_{a_{2 } \\ldots a_{l } } \\\\ { { } ^{(3)}\\nabla}^{2 } { q^{(k)}}_{a_{1 } \\ldots a_{l } } & = & { { \\case{k^{2}}{s^{2 } } } } \\left[1- l(l+1 ) { { \\case{k}{k^{2 } } } } \\right ] { q^{(k)}}_{a_{1 } \\ldots a_{l}},\\end{aligned}\\ ] ] which may be derived from the recursion relation given as equation  ( [ eq_recurs ] ) and the definition in equation  ( [ eq_scalqk ] ) .",
    "further properties of the scalar harmonics are given by gebbie & ellis ( 1998 ) .",
    "to relate the timelike integration employed in the boltzmann multipole approach , adopted here , to the lightlike integration employed in line of sight methods  @xcite , which we consider in section  [ sec_int ] , it is convenient to note the following zero - order results for the variation of the @xmath263 along the line of sight through some point @xmath270 .",
    "let @xmath109 be a null geodesic with tangent vector parallel to @xmath271 , and @xmath112 satisfying @xmath272 .",
    "define a positive parameter @xmath273 along the past null geodesic by @xmath274 with @xmath275 at the point of observation @xmath270 .",
    "then the evolution of the quantities @xmath276 is given to zero - order by the hierarchy @xmath277",
    "{ q^{(k)}}_{a_{1}\\ldots a_{l-1 } } e^{a_{1}}\\dots e^{a_{l-1 } } , \\label{eq_qloshier}\\end{aligned}\\ ] ] which follows from the recursion relation given as equation  ( [ eq_recurs ] ) .",
    "we shall only consider the solution to this hierarchy in a @xmath11 universe , in which case we find the following variation of @xmath247 along the line of sight : @xmath278 where the @xmath279 are spherical bessel functions .",
    "equation  ( [ eq_qlos ] ) expresses @xmath247 a parameter distance @xmath280 down the line of sight in terms of the @xmath281 at the point of observation , @xmath270 .",
    "if required , the value of @xmath282 down the lightcone can be found from the solution for @xmath247 ( eq .  ( [ eq_qlos ] ) ) and the hierarchy ( eq .  ( [ eq_qloshier ] ) ) .",
    "the additional constraints introduced by the conditions for a scalar mode are satisfied identically if we construct the gauge - invariant variables in the following manner : @xmath283 where @xmath51 labels the particle species ( and we omit the label when referring to total fluid variables ) .",
    "the symbolic summation in these expressions is a sum over eigenfunctions of equation  ( [ eq_scalqk ] ) . for closed background models ,",
    "the sum is discrete , but in the flat and open cases the summation should be understood as an integral over the continuous label @xmath252 , which distinguishes distinct eigenfunctions .",
    "the scalar expansion coefficients , such as @xmath284 , are themselves first - order gauge - invariant variables , which satisfy @xmath285 they are labelled by the lumped index @xmath252 .",
    "finally , we assume that the higher - order angular moments of the photon and neutrino distribution functions may also be expanded in the @xmath286 harmonics . by considering the zero - order form of the scalar harmonics @xmath247 , and derived tensors ,",
    "it is straightforward to show that this condition is equivalent to the usual assumption that the fourier components of the distribution functions are axisymmetric about the wavevector @xmath144 ( see , for example , seljak ( 1996 ) ) . with this condition",
    ", we have @xmath287 for photons and",
    "neutrinos respectively .",
    "it is now a simple matter to substitute the harmonic expansions of the covariant variables into the constraint and propagation equations given in sections  [ sec_cov ] and  [ sec_eqs ] , to obtain equations for the scalar expansion coefficients that describe scalar perturbations in a covariant and gauge - invariant manner . to simplify matters , we assume that the variations in baryon pressure @xmath184 due to entropy variations are negligible compared to those arising from variations in @xmath183 , so",
    "that we may write @xmath288 where @xmath289 is the adiabatic sound speed in the baryon / electron fluid ( this is different to the total sound speed in the tightly - coupled baryon / photon fluid ) .    with this assumption , we obtain the following equations for scalar perturbations : for the spatial gradients of the densities , we find @xmath290 + \\left({{\\case{p^{(b)}}{\\rho^{(b ) } } } } - { c_{s}}^{2}\\right ) \\theta { { \\mathcal{x}}}^{(b)}_{k}\\label{eq_sec_scal_2},\\end{aligned}\\ ] ] for the spatial gradient of the expansion , we find @xmath291 \\nonumber \\\\ & & \\mbox { } + { { \\case{s}{k } } } w_{k } \\left [ { { \\case{3}{2 } } } \\kappa \\rho \\gamma - { { \\case{3k}{s^{2 } } } } \\right],\\end{aligned}\\ ] ] where @xmath90 is defined in terms of the total pressure @xmath74 and density @xmath4 by @xmath89 ( note that we do not assume that @xmath90 is constant ) .",
    "the heat fluxes satisfy @xmath292 and for the baryon and cdm peculiar velocities @xmath293 - { { \\case{k}{s } } } { c_{s}}^{2 } { { \\mathcal{x}}}^{(b)}_{k } & = & - { n_{e}}\\sigma_{t } { { \\case{\\rho^{(\\gamma)}}{\\rho^{(b ) } } } } \\left({{\\case{4}{3 } } } v^{(b)}_{k } - q^{(\\gamma)}_{k}\\right).\\end{aligned}\\ ] ] the propagation equations for the anisotropic stresses are @xmath294 and the remaining moment equations , for @xmath159 , are @xmath295 { j^{(l+1)}_{k } } - { { \\case{l}{2l+1 } } } { j^{(l-1)}_{k } } \\right\\ } & = & - { n_{e}}\\sigma_{t } { { j^{(l)}}_{k}}\\\\ \\dot{g}^{(l)}_{k } + { { \\case{k}{s}}}\\left\\ { { { \\case{l+1}{2l+1 } } } \\left[1-l(l+2 ) { { \\case{k}{k^{2}}}}\\right ] { g^{(l+1)}_{k } } - { { \\case{l}{2l+1 } } } { g^{(l-1)}_{k } } \\right\\ } & = & 0.\\end{aligned}\\ ] ] the propagation equations for @xmath63 and @xmath171 become @xmath296",
    "finally , the remaining constraint equations become @xmath297 - \\kappa \\rho \\theta q_{k } & = & 0\\\\ { { \\case{2}{3 } } } \\left({{\\case{k}{s}}}\\right)^{2 } \\left[{{\\mathcal{z}}}_{k } - \\left(1-{{\\case{3k}{k^{2}}}}\\right)\\sigma_{k}\\right ] + \\kappa \\rho q_{k } & = & 0.\\end{aligned}\\ ] ] the variables @xmath298 , @xmath299 and @xmath300 refer to the total matter , and are given in terms of the component variables by @xmath301 these equations give a complete description of the evolution of inhomogeneity and anisotropy from scalar perturbations in an almost - frw universe with any spatial curvature .",
    "the system closes up once a choice for the velocity @xmath20 is made , and it is straightforward to check that the constraint equations are consistent with the propagation equations .",
    "the equations for @xmath302 and @xmath303 for @xmath159 are equivalent to those usually found in the literature ( see , for example , ma &  bertschinger ( 1995 ) and set @xmath11 ) .",
    "this is because the moments of the perturbed distribution function , used in such gauge - dependent calculations , are gauge - invariant for @xmath304 .",
    "( the @xmath192 moment does depend on the choice of coordinates in the real universe , but is independent of the mapping onto the background model , since the background distribution function has no angular dependence . )",
    "gauge - invariant versions of the usual synchronous - gauge equations  @xcite are obtained by taking @xmath20 to coincide with the cdm velocity , so that @xmath210 and @xmath204 vanish .",
    "the integral solution to the boltzmann multipole equations is central to the line of sight integration method for the calculation cmb anisotropies .",
    "this method , which has been implemented in the cmbfast code of seljak &  zaldarriaga ( 1996 ) , provides a very fast route to calculating the cmb power spectrum .",
    "although we do not make use of this method for the numerical calculations presented in this paper , it may be useful to some readers to have available the integral solution to the covariant and gauge - invariant boltzmann hierarchy , not least because it provides the link between the lightlike integrations along the observational null cone , employed in line of sight methods ( which includes the original calculation by sachs &  wolfe ( 1967 ) ) , and the timelike integrations along the flow lines of the velocity field @xmath20 , employed in the boltzmann multipole approach . for simplicity ,",
    "we restrict attention to @xmath11 almost - frw universes .",
    "the ( linearised ) integral solution to the hierarchy of boltzmann multipole equations given in the previous subsection is , for @xmath305 , @xmath306 - \\left({{\\case{k}{s } } } w_{k } - { n_{e}}\\sigma_{t } v_{k}^{(b)}\\right ) { { \\case{d}{d\\tilde{y}}}}j_{l}(\\tilde{y } ) \\nonumber\\\\&&\\mbox { } - \\left[{{\\case{1}{3}}}\\left({{\\case{k}{s } } } { { \\mathcal{z}}}_{k } - \\theta w_{k}\\right ) - { { \\case{1}{4}}}{n_{e}}\\sigma_{t } { { \\mathcal{x}}}_{k}^{(\\gamma ) } \\right ] j_{l}(\\tilde{y } ) \\bigr\\ } \\ , d t ' , \\label{eq_intsol}\\end{aligned}\\ ] ] where @xmath307 denotes the quantity evaluated at @xmath270 , and the integral is taken along the flow line of @xmath20 through the point @xmath270 . here ,",
    "@xmath308 is proper time along the flow line ( with @xmath309 at @xmath270 ) , @xmath310 is @xmath252 times the conformal time difference along the flow line between @xmath311 and @xmath312 : @xmath313 , and @xmath314 is an `` optical depth '' along the flow line : @xmath315 . in deriving equation  ( [ eq_intsol ] )",
    "we have neglected any contribution from initial conditions , since these are exponentially suppressed by a factor @xmath316 $ ] .",
    "it is straightforward to verify by differentiating with respect to @xmath312 that equation  ( [ eq_intsol ] ) is the solution to the boltzmann hierarchy for scalar perturbations in a @xmath11 almost - frw universe .",
    "verification for the @xmath192 moment requires the following formal solution for @xmath317 : @xmath318 - \\left({{\\case{k}{s } } } w_{k } - { n_{e}}\\sigma_{t } v_{k}^{(b)}\\right ) { { \\case{d}{d\\tilde{y}}}}j_{0}(\\tilde{y } ) \\nonumber\\\\&&\\mbox { } - \\left[{{\\case{1}{3}}}\\left({{\\case{k}{s } } } { { \\mathcal{z}}}_{k } - \\theta w_{k}\\right ) - { { \\case{1}{4}}}{n_{e}}\\sigma_{t } { { \\mathcal{x}}}_{k}^{(\\gamma ) } \\right ] j_{0}(\\tilde{y } ) \\bigr\\ } \\ , d t ' , \\label{eq_intsolclx}\\end{aligned}\\ ] ] where again we have neglected the exponentially suppressed contribution from the initial conditions . in numerical applications , it is convenient to manipulate equation  ( [ eq_intsol ] ) further by integrating by parts  @xcite .",
    "the integral in equation  ( [ eq_intsol ] ) is taken along the flow line of @xmath20 through @xmath270 .",
    "however , in the linearised calculation considered here , the integral can be performed along ( any ) null geodesic through @xmath270 also . to see this , regard @xmath319 and @xmath320 as the restrictions to the flow line of ( zero - order ) fields in the past lightcone of @xmath270 , with @xmath321 and similarly for @xmath320 . replacing the measure @xmath322 by @xmath323 in the integral in equation  ( [ eq_intsol ] ) , and noting that @xmath324}={\\mbox{o}}(1)$ ] and , for example , @xmath325",
    ", it follows that the line integral of @xmath20 times the integrand in equation  ( [ eq_intsol ] ) is path - independent .",
    "the flow line and null geodesic through @xmath270 can be joined at early times by a spacelike curve with @xmath326 , which therefore makes only a second - order contribution to the integral around the closed loop . to zero - order , the restriction of the fields @xmath319 and @xmath320 to the null geodesic through @xmath270 define quantities @xmath327 and @xmath328 on the null curve , where @xmath329 and @xmath330 , so that @xmath331 is the optical depth along the line of sight .",
    "( the parameter @xmath112 along the null geodesic was defined in section  [ sec_scal ] . ) using the integral along the line of sight , we can now reassemble the gauge - invariant temperature perturbations from the mean , @xmath216 , at @xmath270 using equations  ( [ eq_deltat ] ) and  ( [ eq_gamharm ] ) . recalling equation  ( [ eq_qlos ] ) for the variation of the quantities @xmath281 down the line of sight",
    ", the temperature anisotropy from scalar perturbations in an almost - frw universe reduces to @xmath332 \\ , d\\lambda ' \\nonumber \\\\ & & \\mbox { } \\sum_{k } \\int^{\\lambda_{r } } { n_{e}}\\sigma_{t } { e^{\\mbox{\\footnotesize $ -\\tau$ } } } \\left[{{\\case{3}{16}}}\\pi_{k}^{(\\gamma ) } { q^{(k)}}_{ab}e^{a}e^{b } - v_{k}^{(b ) } { q^{(k)}}_{a}e^{a } + { { \\case{1}{4 } } } { { \\mathcal{x}}}_{k}^{(\\gamma ) } { q^{(k)}}\\right ] \\ , d\\lambda ' .",
    "\\label{eq_intsolk}\\end{aligned}\\ ] ] equation  ( [ eq_intsolk ] ) , first given in this covariant form in challinor &  lasenby ( 1998 ) , is valid for any value of the spatial curvature , even though the derivation given here considers the @xmath11 case only .",
    "equation  ( [ eq_intsolk ] ) is most easily obtained by a direct integration of the covariant boltzmann equation for the temperature anisotropy @xmath216 along the line of sight  @xcite .",
    "however , the route followed here makes clear the link between the lightlike and timelike integrations , employed in the line of sight and boltzmann multipole methods respectively .      in this subsection",
    ", we analytically extract the solution of the scalar perturbation equations in the radiation dominated era .",
    "we shall only consider modes with @xmath333 so that we may ignore terms involving @xmath145 in the scalar equations .",
    "associated with each mode there is a characteristic length scale , @xmath334 .",
    "the condition @xmath335 is equivalent to requiring that this length scale be small compared to the curvature radius of the universe . for such modes ,",
    "@xmath252 is effectively a comoving wavenumber .",
    "we shall also require that the mode be well outside the horizon scale @xmath336 , so that we consider only those modes satisfying @xmath337 where @xmath338 is the ratio of the characteristic length scale to the horizon scale , and @xmath339 is the ( squared ) ratio of the curvature radius to the horizon scale .",
    "if the universe may be approximated by a @xmath11 universe to zero - order , equation  ( [ eq_modecon ] ) reduces to @xmath340 .",
    "the approximate analytic solution may be used to provide initial conditions for a numerical integration of the scalar equations ( see section  [ sec_num ] ) .    at this point , it is convenient to make a choice of frame . in the cdm model , the rest frame of the cdm defines a geodesic frame , which provides a convenient choice for @xmath20 , since the acceleration then vanishes identically .",
    "we assume that this frame choice has been made in the rest of this paper .    well before decoupling , the baryons and photons are tightly - coupled because of the high opacity to thomson scattering .",
    "this scattering damps the photon moments for @xmath341 , but a dipole ( @xmath192 ) moment can survive if the baryon velocity does not coincide with the cdm velocity . to a good approximation , we may ignore the @xmath302 for @xmath341 , and set @xmath342 so that the radiation is isotropic in the rest frame of the baryons .",
    "this is the lowest - order term in the tight - coupling approximation ( see section  [ sec_tightcoup ] ) .",
    "similarly , we expect that the higher - order neutrino moments will also be small in the early universe , since the neutrinos were in thermal equilibrium prior to their decoupling",
    ". furthermore , the baryon and cdm densities , @xmath183 and @xmath202 , are negligible compared to the radiation and neutrino densities , @xmath105 and @xmath343 , in the radiation dominated era .    a useful first approximation to the full set of scalar equations is obtained by setting the neutrino moments , @xmath303 , to zero for @xmath341 .",
    "it is convenient to take the dependent variable to be @xmath344 instead of the proper time @xmath308 along the flow lines , so that the scalar propagation equations of the previous section reduce to the following set : @xmath345 & = & 0 \\label{eq_eu1}\\\\ x^{2 } \\phi_{k } ' + x\\phi_{k } + 2 \\sigma_{k } + { { \\case{3}{2 } } } \\left[(1-r)q^{(\\gamma)}_{k } + r q^{(\\nu)}_{k } \\right ] & = & 0\\\\ x \\sigma_{k } ' + \\sigma_{k } + x\\phi_{k } & = & 0\\\\ { { \\mathcal{x}}}^{(\\gamma)\\prime}_{k } + { { \\case{4}{3}}}{{\\mathcal{z}}}_{k } + q^{(\\gamma)}_{k } & = & 0\\\\ { { \\mathcal{x}}}^{(\\nu)\\prime}_{k } + { { \\case{4}{3}}}{{\\mathcal{z}}}_{k } + q^{(\\nu)}_{k } & = & 0\\\\ q^{(\\gamma)\\prime}_{k } - { { \\case{1}{3 } } } { { \\mathcal{x}}}^{(\\gamma)}_{k } & = & 0 \\\\ q^{(\\nu)\\prime}_{k } - { { \\case{1}{3 } } } { { \\mathcal{x}}}^{(\\nu)}_{k } & = & 0,\\end{aligned}\\ ] ] where a prime denotes differentiation with respect to @xmath8 , and we have used the zero - order friedmann equation in the form @xmath346 since the curvature term may be neglected by equation  ( [ eq_modecon ] ) .",
    "we have followed ma &  bertschinger ( 1995 ) by introducing the dimensionless quantity @xmath270 defined by @xmath347 after neutrino decoupling , @xmath270 is a constant which depends only on the number of neutrino species .",
    "the remaining equations that we require are the two scalar constraints which reduce to @xmath348 - 9\\left[(1-r ) q^{(\\gamma)}_{k } + r q^{(\\nu)}_{k } \\right ] & = & 0\\\\ 2x^{2 } ( { { \\mathcal{z}}}_{k } - \\sigma_{k } ) + 9 \\left[(1-r)q^{(\\gamma)}_{k } + r q^{(\\nu)}_{k}\\right ] & = & 0 . \\label{eq_eu9}\\end{aligned}\\ ] ] this set of equations gives a closed equation for @xmath349 : @xmath350 this equation should be compared to the fourth - order equation for the metric perturbation variable in the synchronous gauge ( see , for example , ma &  bershinger ( 1995 ) ) .",
    "the fourth - order equation admits four linearly - independent solutions , but two of the solutions are gauge modes that arise from mapping an exact frw universe to itself .",
    "the gauge - invariant approach adopted here ensures that such gauge modes do not arise .",
    "this is evident from equation  ( [ eq_phipropeu ] ) which is only a second - order equation .",
    "the two linearly - independent solutions of this equation both describe physical perturbations in the weyl tensor , which vanishes for an exact frw universe .",
    "it is now straightforward to find the general solution of equations  ( [ eq_eu1])([eq_eu9 ] ) .",
    "there are two solutions with non - vanishing weyl tensor ( @xmath351 ) , which we write as @xmath352 \\label{eq_eu20}\\\\ { { \\mathcal{z}}}_{k } & = & 3\\sqrt{3 } y^{-3 } [ 2(c+dy)\\cos\\!y + 2(cy - d ) \\sin\\!y - c(2 + y^{2 } ) ] \\\\",
    "\\sigma_{k } & = & 3\\sqrt{3 } y^{-2 } [ d \\cos\\!y + c \\sin\\!y - c y ] \\\\",
    "q^{(\\gamma)}_{k } & = & - 4\\sqrt{3 } y^{-1 } [ c \\cos\\!y - d \\sin\\!y - c ] \\\\",
    "q^{(\\nu)}_{k } & = & -{{\\case{2\\sqrt{3}}{r}}}y^{-1 } [ ( 2rc + dy)\\cos\\!y + ( cy - 2rd ) \\sin\\!y - 2rc ] \\\\ { { \\mathcal{x}}}^{(\\gamma)}_{k } & = & 12 y^{-2 } [ ( c+dy ) \\cos\\!y + ( cy - d ) \\sin\\!y - c ] \\\\ { { \\mathcal{x}}}^{(\\nu)}_{k } & = & { { \\case{6}{r } } } y^{-2 } [ ( 2rc - cy^{2 } + 2rdy ) \\cos\\!y + ( 2rcy -2 rd + d y^{2 } ) \\sin\\!y - 2 rc ] , \\label{eq_eu21}\\end{aligned}\\ ] ] where @xmath353 , and @xmath354 and @xmath355 are constants .",
    "there are also three solutions with vanishing weyl tensor ( @xmath356 ) , which we write as @xmath357 where @xmath358 , @xmath359 and @xmath360 are further constants .",
    "the solution with only @xmath360 non - zero describes a radiation dominated universe which is exactly frw except that the cdm has a peculiar velocity ( relative to the velocity of the fundamental observers ) @xmath361 , where @xmath362 is a first - order vector , orthogonal to the fundamental velocity , which is parallel transported along the fundamental flow lines : @xmath363 .",
    "this can be seen most clearly by adopting the energy frame , defined by the condition @xmath364 .",
    "this is arguably a better choice to make in the early universe , since @xmath20 is then defined in terms of the dominant matter components , rather than a minority component , such as the cdm , which has little effect on the gravitational dynamics . choosing the energy frame , and ignoring anisotropic stresses ( which are frame - independent in linear theory )",
    ", the cdm relative velocity evolves according to @xmath365 = 0 , \\label{eq_eucdm}\\ ] ] in the radiation dominated era .",
    "since the cdm interacts with the other matter components through gravity alone , and since the gravitational influence of the cdm on the dominant matter components may be ignored during radiation domination , equation  ( [ eq_eucdm ] ) is the only equation governing the evolution of the perturbations which makes reference to the cdm .",
    "it follows that any solution of equation  ( [ eq_eucdm ] ) , defines a valid solution to the linearised perturbation equations .",
    "the solution , which has @xmath361 in an otherwise frw universe corresponds to the solution labelled by @xmath360 in equations  ( [ eq_eu10])([eq_eu11 ] ) . note that this solution decays in an expanding universe .",
    "following standard practice , we assume that this mode may be ignored ( @xmath366 ) since it would require highly asymmetric initial conditions at the end of the inflationary epoch if the decaying mode was significant during the epoch of interest here",
    ". similar comments apply to the mode labelled by @xmath355 in equations  ( [ eq_eu20])([eq_eu21 ] ) .",
    "an important subclass of these solutions describe adiabatic modes .",
    "we assume that the appropriate covariant and gauge - invariant definition of adiabaticity is that @xmath367 for all species @xmath51 and @xmath368 ( bruni et al .",
    "this condition , which is frame - independent in linear theory , is the natural covariant generalisation of the ( gauge - invariant ) condition @xmath369 where @xmath370 is the usual gauge - dependent density perturbation , and overbars denote the background quantity . demanding adiabaticity between the photons and the neutrinos leaves only one free constant of integration , which we take to be @xmath354 .",
    "the remaining constants are @xmath371 and @xmath372 .",
    "note that the constants of integration will depend on the mode label @xmath252 , in general , so we have @xmath373 .",
    "this adiabatic solution may be developed further by including higher - moments of the neutrino distribution function , and finding a series expansion of the ( enlarged ) system in @xmath8 .",
    "to obtain solutions correct to @xmath374 , it is necessary to retain @xmath375 and @xmath376 .",
    "the series solution that results is @xmath377 \\nonumber\\\\ { { \\mathcal{x}}}^{(\\gamma)}_{k } & = & { \\case{(4r+15)c}{6(r+5 ) } } x^{2 }   \\nonumber\\\\ { { \\mathcal{z}}}_{k } & = & -{\\case{(4r+15)c}{4(r+5)}}\\left[x - { \\case{4r+5}{18(4r+15)}}x^{3 } \\right]\\nonumber\\\\ { { \\mathcal{x}}}^{(\\nu)}_{k } & = & { \\case{(4r+15)c}{6(r+5 ) } } x^{2 }   \\nonumber \\\\ \\sigma_{k } & = & -{\\case{5c}{2(r+5)}}\\left[x + { \\case{112r^{2 } - 16r - 1050}{2520(2r+25)}}x^{3}\\right]\\nonumber\\\\ q^{(\\gamma)}_{k } & = & { \\case{(4r+15)c}{54(r+5)}}x^{3 }   \\nonumber \\\\ \\pi^{(\\nu)}_{k } & = & -{\\case{2c}{3(r+5 ) } } x^{2 } \\nonumber \\\\   q^{(\\nu)}_{k } & = & { \\case{(4r+23)c}{54(r+5 ) } } x^{3 } \\nonumber \\\\ { g^{(3)}_{k } } & = & -{\\case{5c}{63(r+5 ) } } x^{3 } \\nonumber \\\\ { { g^{(l)}}_{k}}&= & { \\mbox{o}}(x^{l } ) \\quad \\mbox{for $ l > 3$}. \\label{eq_euser}\\end{aligned}\\ ] ] note that on large scales ( @xmath378 ) , the harmonic coefficient @xmath349 of @xmath63 is constant along the flow lines .",
    "it follows that on large scales , we may write @xmath379 , where @xmath380 . the series solution given in equation  ( [ eq_euser ] )",
    "is adiabatic between the photons and neutrinos to @xmath374 , but the adiabaticity is broken by the higher - order terms .",
    "this difference in the dynamic behaviour of radiation and neutrinos is due to their different kinetic equations ; the neutrinos are collisionless which allows higher - order angular moments in the distribution function to grow , but the radiation is tightly - coupled to the baryon fluid which prevents the growth of higher - order moments .",
    "the baryon relative velocity @xmath187 is determined by the condition that the radiation be nearly isotropic in the rest frame of the baryons : @xmath381 and the spatial gradients of the baryon and cdm follow from the adiabaticity condition : @xmath382 where we have neglected the small effect of baryon pressure . the series solution given as equation  ( [ eq_euser ] ) was used to provide adiabatic initial conditions for the numerical solution of the perturbation equations , discussed in the next section .",
    "in this section , we discuss the calculation of the cmb power spectrum from initially adiabatic scalar perturbations in an almost - frw universe with negligible spatial curvature .",
    "the evolution of anisotropy in the cmb and inhomogeneities in the density fields , resulting from scalar perturbations , may be found by solving numerically the equations presented in section  [ sec_scal ] , with initial conditions determined from the analytic solutions of the previous section . for adiabatic perturbations ,",
    "the specification of initial conditions is particularly simple ; there is a single function @xmath383 of the mode label @xmath252 to set .",
    "this function gives the ( constant ) amplitude of the harmonic component of the electric part of the weyl tensor on super - horizon scales .",
    "the gauge - invariant temperature perturbation from the mean , denoted by @xmath216 , is given by equation  ( [ eq_deltat ] ) .",
    "substituting for the harmonic expansion of the angular moments @xmath161 , we find @xmath384 , \\label{eq_ps1}\\ ] ] where we have introduced the radiation transfer function @xmath385 , which is a function of the eigenvalue @xmath252 only .",
    "the transfer function is defined to be the value of @xmath302 for the initial condition @xmath386 .",
    "since the dynamics of a scalar mode labelled by the index @xmath252 depends only on the eigenvalue of the eigenfunction @xmath247 , the transfer function is a function of the eigenvalue @xmath252 only . for the linearised theory considered here",
    ", we have @xmath387 .    we have come as far as we can without making a specific choice for the scalar harmonic functions @xmath247 . to proceed , we introduce an almost - frw coordinate system  @xcite as follows .",
    "if the perturbations in the universe are only of scalar type , then the velocity @xmath20 is hypersurface orthogonal , so that we may label the orthogonal hypersurfaces with a time label @xmath308 .",
    "furthermore , since we have chosen @xmath20 to be the cdm velocity , which is geodesic , the flow orthogonal hypersurfaces may be labelled unambiguously with proper time along the flow lines , so that @xmath388 .",
    "the orthogonal hypersurfaces depart from being spaces of constant curvature only at first - order , so we can introduce comoving spatial coordinates @xmath389 , in such a way that our ( synchronous ) coordinate system is almost - frw in form .",
    "( latin indices , such as @xmath51 , run from 1 to 3 . )",
    "it is then straightforward to show that the functions @xmath390 , where @xmath391 and @xmath392 are constants , satisfy the defining equations for the scalar harmonic functions , equations  ( [ eq_scalqk ] ) and  ( [ eq_scalqkdt ] ) , with @xmath393 , in an almost frw universe with negligible spatial curvature .",
    "it follows that we may take @xmath394 for the open and flat cases , the appropriate generalisations of the @xmath390  @xcite should be used for the @xmath247 .",
    "note that the expansion coefficients , such as @xmath302 , depend on the detailed choice of the scalar harmonics @xmath247 , but that covariant tensors , such as @xmath395 , are independent of this choice .",
    "if vector perturbations are also significant , we can not use the velocity @xmath20 to define a time coordinate in the manner described above .",
    "instead , an almost - frw coordinate system should be constructed using an irrotational and geodesic velocity field @xmath396 , which is close to our chosen fundamental velocity @xmath20 .",
    "( one possibility is to take @xmath397 . ) using this velocity field , almost - frw coordinates can be constructed by the above procedure  @xcite .",
    "the resulting @xmath247 will satisfy the defining ( zero - order ) properties of the scalar harmonics in the @xmath20 frame , since the relative velocity of @xmath396 is first - order .    since @xmath398 , and @xmath399",
    ", we can always choose the @xmath389 so that at our observation point @xmath400 , with @xmath401 ( for example , one can choose the @xmath389 so that @xmath402 are locally cartesian coordinates in the constant time hypersurface ) .",
    "then it follows that , to zero - order , @xmath403 where @xmath404 , and @xmath405 are the legendre polynomials .",
    "this result demonstrates that expanding the angular moments of the distribution function in the covariant tensors @xmath263 is equivalent to the usual legendre expansion of the fourier modes of the distribution function ( which are axisymmetric about the wave vector @xmath144 ) , in an almost - frw universe , where the spatial curvature may be neglected .",
    "following standard practice , we make the assumption that we inhabit one realisation of a stochastic ensemble of universes , so that the @xmath383 are random variables .",
    "( the physical basis on which this assumption rests is that initial fluctuations were generated from causal quantum processes in the early universe , such as during a period of inflation ; see for example , kolb &  turner ( 1990 ) . )",
    "given our chosen form for the @xmath247 , statistical isotropy of the ensemble demands that the covariance matrix for the @xmath383 takes the following form : @xmath406 where @xmath407 is the primordial power spectrum which is a function of the eigenvalue @xmath252 .",
    "the @xmath408 appearing in equation  ( [ eq_pscov ] ) is defined by @xmath409 , where @xmath259 is an arbitrary function of the mode label @xmath252 .",
    "the cmb power spectrum @xmath225 is defined by @xmath410 , where @xmath221 are the coefficients in the spherical harmonic expansion of the temperature anisotropy ( see section  [ sec_cmbtemp ] ) . substituting the harmonic expansion of the @xmath161 into equation  ( [ eq_pow ] ) , and using the zero - order result @xmath411 which follows from @xmath412 , we find the familiar expression for the cmb power spectrum in terms of the transfer functions and the primordial power : @xmath413^{2}.\\ ] ] we make the standard assumption that on large scales , the primordial power spectrum may be approximated by a power - law of the form @xmath414 .",
    "many inflationary models predict that the scalar index @xmath415 will be close to unity  @xcite .",
    "the case @xmath416 describes the scale - invariant spectrum .",
    "this term arises from considering the logarithmic power spectrum in fourier space of the ( gauge - dependent ) fractional density perturbation @xmath417 evaluated at horizon crossing .",
    "an analogous result can be found in the covariant and gauge - invariant approach : we evaluate the logarithmic power spectrum of the dimensionless scalar @xmath418 in the energy frame ( @xmath364 ) . making use of equation  ( [ eq_cons3 ] ) , with the contribution from anisotropic stress neglected , and the frame - invariance of @xmath419 in linear theory",
    ", we find that @xmath420 note that @xmath421 only receives a contribution at linear - order from scalar modes ( ellis et al .",
    "1990 ) . in deriving equation  ( [ eq_ps4 ] ) , which is valid before the modes labelled by @xmath252 reenter the hubble radius , we have assumed that only the fastest growing scalar mode is significant so that @xmath349 is constant before horizon crossing . for given @xmath252 ,",
    "the logarithmic power in @xmath421 evolves in time due to the presence of @xmath422 on the right - hand side of equation  ( [ eq_ps4 ] ) .",
    "however , at horizon crossing @xmath422 falls below some critical value of order unity which is independent of @xmath252 .",
    "it follows that for the scalar index @xmath416 , the logarithmic power in @xmath421 at horizon crossing is independent of scale .      at early times ,",
    "when the baryons and photons are tightly - coupled , the radiation is nearly isotropic in the frame of the baryons . in this limit",
    ", it is convenient to replace the propagation equations for the @xmath161 with @xmath423 , and for the baryon relative velocity @xmath187 , with approximate equations which may be developed by an expansion in the photon mean free path @xmath424 .",
    "the approximate equations are simpler to solve numerically than the exact equations since the former do not include the large thomson scattering terms present in the latter .    for scalar perturbations ,",
    "it is simplest to work directly with the harmonic expansion coefficients , @xmath302 and @xmath425 .",
    "the relevant time - scales in the problem are the photon mean free time @xmath426 , the expansion time - scale @xmath427 , and the light travel time across the wavelength of the mode under consideration , @xmath428 .",
    "in the tight - coupling approximation , we expand in the small dimensionless numbers @xmath429 and @xmath430 , so that the procedure is valid for @xmath431 . while a mode is outside the horizon , @xmath432 , whereas @xmath433 during the acoustic oscillations . in the cdm frame ( @xmath434 )",
    ", the procedure is similar to that usually employed ( peebles &  yu 1970 ; ma &  bertschinger 1995 ) in the synchronous - gauge .",
    "we combine the propagation equations given in section  [ sec_scal_eqs ] for the photon moments @xmath302 ( @xmath304 ) and the baryon relative velocity @xmath425 , to get the exact ( in linear theory ) equations : @xmath435 \\\\ \\pi^{(\\gamma)}_{k } & = & -{{\\case{10}{9 } } } t_{c } \\left [ \\dot{\\pi}^{(\\gamma)}_{k } + { { \\case{3}{5 } } } t_{k}^{-1 } { j^{(3)}_{k } } -{{\\case{2}{5 } } } t_{k}^{-1 } \\delta_{k } - { { \\case{8}{15 } } } t_{k}^{-1 } ( \\sigma_{k } + v^{(b)}_{k } ) \\right ] \\\\ { { j^{(l)}}_{k}}&= & - t_{c } \\left[{\\dot{j}^{(l)}_{k}}+ t_{k}^{-1 } \\left ( { { \\case{l+1}{2l+1 } } } { j^{(l+1)}_{k } } - { { \\case{l}{2l+1 } } } { j^{(l-1)}_{k } } \\right)\\right ] \\qquad l \\geq 3,\\end{aligned}\\ ] ] where @xmath436 , and for this section , @xmath437 . iterating these equations",
    "gives the tight - coupling expansions @xmath438 where the subscript on the variables on the right - hand side denotes the order in the expansion parameter @xmath439 . to avoid cluttering of indices ,",
    "we leave the mode label @xmath252 implicit .",
    "we shall only require the results to first - order in @xmath47 : @xmath440 \\\\ \\delta_{1 } & = & { { \\case{1}{3(1+r)}}}\\left[{{\\case{t_{c}}{t_{k}}}}\\left ( { { \\mathcal{x}}}^{(\\gamma)}_{k } - 4{c_{s}}^{2 } { { \\mathcal{x}}}^{(b)}_{k } \\right ) + 4 { { \\case{t_{c}}{t_{h } } } } v^{(b)}_{k } \\right]\\\\ \\pi^{(\\gamma)}_{1 } & = & { { \\case{16}{27}}}{{\\case{t_{c}}{t_{k } } } } \\left(\\sigma_{k } + v^{(b)}_{k } \\right).\\end{aligned}\\ ] ] the propagation equation for @xmath441 in the tight - coupling approximation may be obtained from the exact equation  ( [ eq_tc1 ] ) , with @xmath442 replaced by @xmath443 , and @xmath444 and @xmath445 replaced by their tight - coupling expansions .",
    "we are now in a position to evolve an initial set of perturbations from early times to the present in an almost - frw universe with negligible spatial curvature , and to calculate the power spectrum of the cmb anisotropies that result . in this section we present the results of a numerical simulation in the standard cdm model , with parameters @xmath446 , baryon fraction @xmath447 , cdm fraction @xmath448 , helium fraction @xmath449 , zero cosmological constant , and a scale - invariant spectrum of initially adiabatic conditions ( @xmath416 ) .    our code to solve the covariant and gauge - invariant perturbation equations in the cdm frame , including the boltzmann hierarchies for the photons and neutrinos , was based on the serial cosmics code developed by bertschinger and bode , and described in ma &  bertschinger ( 1995 ) . the cosmics package , including full documentation , is available at http://arcturus.mit.edu/cosmics .",
    "we modified the cosmics code to solve the covariant equations given in this paper , for the matter variables and for the spatial gradient of the expansion , @xmath84 .",
    "the shear , which is required to solve the boltzmann hierarchies for the photons and neutrinos , was determined from the equation  ( [ eq_cons4 ] ) .",
    "the electric part of the weyl tensor , @xmath63 , could then be determined from equation  ( [ eq_cons3 ] ) .",
    "our calculations of the zero - order ionisation history of the universe , which fully include the effects of helium and hydrogen recombination , followed ma &  bertschinger ( 1995 ) , as did our truncation schemes for the photon and neutrino boltzmann hierarchies .",
    "the first - order tight - coupling approximation was used at sufficiently early times that @xmath450 .",
    "( 222,525 ) ( -5,525 ) ( -5,345 ) ( -5,165 )    in figure  [ fig1 ] we show the variation of the harmonic coefficients @xmath284 of the comoving fractional spatial gradients in the cdm frame , against redshift in the standard cdm model .",
    "similar plots were given by ma &  bertschinger ( 1995 ) for the fourier components of the ( gauge - dependent ) density perturbations @xmath451 , where @xmath452 is the density of the species @xmath51 in the background model .",
    "our results , given in figure  [ fig1 ] , agree well with the synchronous - gauge results of ma &  bertschinger ( 1995 ) .",
    "this is because the constant time surfaces in this gauge are orthogonal to the cdm velocity , so that @xmath55 is a covariant measure of the density inhomogeneity in these surfaces .",
    "although @xmath453 is gauge - dependent in the synchronous gauge , the gauge - conditions restrict this gauge - dependence to transformations of the form @xmath454 , where @xmath455 is a first - order constant .",
    "it follows that the fourier coefficients of @xmath453 are gauge - invariant away from @xmath456 in fourier space .",
    "the qualitative behaviour of the comoving density gradients can be seen directly from their propagation equations . for scalar perturbations , it is simplest to work directly with the equations of motion  ( [ eq_sec_scal_1])([eq_sec_scal_2 ] ) for the harmonic coefficients @xmath284 in the cdm frame . eliminating the spatial gradients of the expansion , @xmath84 , we find the following second - order equations : @xmath457 where we have ignored baryon pressure except in the acoustic term @xmath458 , which can be significant on small scales . in the limiting case",
    "that the mode is well outside the hubble radius ( @xmath340 ) , the equations of motion for each component reduce to the common form @xmath459 for adiabatic initial conditions , it is clear that the adiabatic condition , given as equation  ( [ eq_eu_adiab ] ) , is maintained while the mode is outside the hubble radius . solving equation  ( [ eq_num1 ] ) for adiabatic perturbations gives growing modes proportional to @xmath308 and @xmath460 during radiation and matter domination respectively .",
    "if a mode enters the hubble radius prior to last scattering , the photon / baryon fluid , which is still tightly - coupled , undergoes acoustic oscillations .",
    "to lowest - order in the tight - coupling parameter , @xmath461 , the photon and baryon perturbations remain adiabatic , evolving according to @xmath462 where @xmath463 .",
    "the solution of the homogeneous equation describes acoustic oscillations in a fluid with sound speed squared @xmath464 , which are damped by the expansion of the universe .",
    "however , the oscillations are driven gravitationally by the gradient @xmath465 , which gives an almost constant amplitude oscillation in the radiation dominated era .",
    "the silk damping which is visible in figure  [ fig1 ] for @xmath466 at @xmath467 arises from photon diffusion ( which is not described by the lowest - order tight - coupling approximation ) so is not described by equation  ( [ eq_num2 ] ) .",
    "the neutrino perturbation also oscillates once inside the hubble radius in the radiation dominated region , while the power - law growth of the cdm is impeded by the gravitational attraction of the oscillating dominant component ( the inhomogeneous term in eq .",
    "[ [ eq_num0 ] ] ) . in the matter dominated era , the cdm becomes the dominant component , so we again see power - law growth of the cdm perturbation on all scales . before last scattering ,",
    "the photons and baryons remain tightly - coupled , but the character of the @xmath465 driving term in equation  ( [ eq_num2 ] ) changes from an oscillation to a power - law as the cdm becomes dominant . at last scattering , the photons and baryons decouple .",
    "the baryons no longer feel the pressure support provided by the photons ; the jeans length of the baryons is very small and the acoustic term in equation  ( [ eq_num01 ] ) is negligible .",
    "the @xmath465 driving term attracts the baryons into the potential wells caused principally by inhomogeneity of the cdm , so that @xmath468 relaxes to @xmath211 as a power - law .",
    "after last scattering , the photons and neutrinos continue to undergo driven oscillations , which decay towards the particular integral @xmath469 .",
    "in figure  [ fig2 ] we show the cmb power spectrum calculated from a simulation in the standard cdm model . on large scales ,",
    "the plateau arises from the usual potential fluctuations @xmath470 on the last scattering surface  @xcite .",
    "the oscillations in the cmb power spectrum on smaller scales ( the doppler peaks ) arise from the acoustic oscillations in the baryon / photon fluid .",
    "these oscillations give rise to strongly scale - dependent gradients of the photon energy density in the energy - frame , which in the approximation of instantaneous recombination can be interpreted as temperature variations across the last scattering surface , and a local scale - dependent distortion of the last scattering surface relative to the energy frame .",
    "since the last scattering surface is well approximated by a hypersurface of constant radiation temperature ( so that recombination does occur there ) , it is more correct to interpret the doppler peaks in terms of the local variations in redshift along null geodesics back to the last scattering surface , than in terms of temperature variations on the last scattering surface .",
    "( there is another significant contribution to the doppler peaks , which is of dipole nature on the last scattering surface , and tends to fill in the power spectrum near the first doppler peak ; see hu &  sugiyama ( 1995 ) and challinor &  lasenby ( 1998 ) for more details . ) on the smallest scales , the power spectrum is damped due to photon diffusion in the photon / baryon plasma prior to recombination .",
    "the covariant equations of section  [ sec_eqs ] are independent of any non - local splitting of the perturbations into scalar , vector and tensor modes . in the linear approximation , we have seen that the equations describing scalar perturbations can be obtained from the full set of equations in a straightforward manner .",
    "the same is also true for vector and tensor perturbations .",
    "vector perturbations are not expected to be important today in non - seeded models since the vorticity decays in an expanding universe  @xcite .",
    "however , most inflationary models do predict the generation of a primordial spectrum of gravitational waves ( tensor modes ) during an epoch of inflation ( see lidsey et al .",
    "( 1997 ) for a comprehensive review ) .",
    "the existence of such a background of relic gravitational waves would have a significant effect on the cmb anisotropy power spectrum on large scales  @xcite . for completeness",
    ", we give the tensor multipole equations in this section .",
    "we defer a detailed derivation of the equations , and a discussion of their relation to the multipole equations usually employed in calculations of the effects of tensor modes  @xcite to a future paper  @xcite .    in the covariant approach to cosmology",
    ", gravitational waves are characterised by requiring that the vorticity and all gauge - invariant vectors and scalars vanish at first - order ( dunsby et al .",
    "1997 ) , so that the spatial gradients of the density and expansion vanish , as well as the acceleration and the heat fluxes .",
    "the electric and magnetic parts of the weyl tensor , the shear tensor and the anisotropic stress are constrained to be transverse : @xmath471 it is straightforward to show that these conditions are consistent with the linearised propagation equations given in section  [ sec_cov ] ( see also maartens ( 1997 ) for a discussion of consistency of the exact equations for irrotational dust spacetimes ) . as with scalar perturbations , it is convenient to expand harmonically the first - order covariant variables in tensors derived from solutions of a generalised helmholtz equation . for tensor perturbations",
    ", we employ the tensor - valued solutions  @xcite @xmath472 ( note that we use the same symbol for the tensor harmonics and the second - rank tensors derived from the scalar harmonic functions to avoid cluttering formulae with additional labels ) , which satisfy the zero - order relations @xmath473 expanding @xmath63 , @xmath64 , @xmath171 and @xmath242 in these tensors ( as in section  [ sec_scal ] but with @xmath474 replaced by the tensor harmonics , and the scalar - valued variables @xmath349 replaced by @xmath475 ) , we obtain simple propagation equations for the electric part of the weyl tensor and the shear : @xmath476 note that we have used the constraint equation  ( [ eq_cons1 ] ) to eliminate the magnetic part of the weyl tensor from the propagation equation for the electric part .",
    "equations  ( [ eq_tens_edt ] ) and  ( [ eq_tens_sheardt ] ) close up , with the anisotropic stress treated as a known field , to give a second - order equation for the shear : @xmath477\\sigma_{k } = \\kappa\\rho { { \\case{s}{k}}}\\left[{{\\case{1}{3}}}(3\\gamma-2)\\theta \\pi_{k } - \\dot{\\pi}_{k } \\right],\\ ] ] which generalises the homogeneous equation derived in dunsby et al .",
    "( 1997 ) to include anisotropic stress .    for the photon and neutrino angular moments , @xmath478 and @xmath479 , we expand in tensors @xmath263 derived from the tensor harmonics using the same recursion relation as for scalar perturbations , @xmath480 for @xmath341 .",
    "this procedure gives the following covariant boltzmann multipole equations for tensor perturbations : for the anisotropic stress ( @xmath169 ) , @xmath481 and for @xmath166 , @xmath482 { j^{(l+1)}_{k } } - { { \\case{l}{2l+1}}}{j^{(l-1)}_{k } } \\right\\ } & = & - { n_{e}}\\sigma_{t } { j^{(l)}_{k } } \\\\ { \\dot{g}^{(l)}_{k}}+ { { \\case{k}{s } } } \\left\\ { { { \\case{(l+3)(l-1)}{(l+1)(2l+1 ) } } } \\left[1-\\left((l+1)^{2}-3\\right){{\\case{k}{k^{2 } } } } \\right ] { g^{(l+1)}_{k } } - { { \\case{l}{2l+1}}}{g^{(l-1)}_{k } } \\right\\ } & = & 0.\\end{aligned}\\ ] ] as we stressed earlier , by performing the covariant angular expansion before harmonically expanding the moments , the necessary angular dependence of the moments appears automatically , whereas in the metric - based approach , this ( azimuthal ) dependence must be put in by hand , and is different for the two polarisations of gravitational waves . it should be noted that the moment equations given here are not the same as those satisfied by the @xmath483 variables , where @xmath484 , @xmath485 labels the polarisation of the gravitational wave and @xmath486 denotes the intensity stokes parameter ( we follow the notation employed in kosowsky ( 1996 ) ) , that are usually employed in metric - based calculations of the effects of tensor modes .",
    "this is because the covariant angular expansion gives rise to a more natural set of variables , the @xmath487 , which are related to the temperature anisotropy in a simpler manner than the @xmath483 .",
    "in particular , the @xmath12-th multipole @xmath225 of the anisotropy power spectrum depends only on @xmath487 , whereas @xmath225 depends on the @xmath488 , @xmath12 and @xmath14-th moments , @xmath483 , thus obscuring the physical interpretation of these variables .",
    "the relation between the two sets of variables will be discussed further in challinor ( 1998 ) .",
    "the first - order propagation equations for the shear and electric part of the weyl tensor , along with the boltzmann multipole equations for the photons and neutrinos give a closed set of equations that can be solved to calculate the temperature anisotropy for given initial conditions .",
    "the numerical solution of these equations will be considered elsewhere  @xcite .",
    "we have shown how the full kinetic - theory calculation of the evolution of cmb anisotropies and density inhomogeneities can be performed in the covariant approach to cosmology ( ehlers 1993 ; ellis 1971 ) , using the gauge - invariant perturbation theory of ellis &  bruni ( 1989 ) . adopting",
    "covariantly - defined , gauge - invariant variables throughout ensured that our discussion avoided the gauge ambiguities that appear in certain gauges , and that all variables had a clear , physical interpretation .",
    "we presented a unified set of equations describing the evolution of photon and neutrino anisotropies and cosmological perturbations in the cdm model , which were independent of a decomposition into scalar , vector or tensor modes and the associated harmonic analysis .",
    "although we only considered the case of linear perturbations around an frw universe here , it is straightforward to extend the approach to include non - linear effects ( maartens et al .",
    "1998 ) , which should allow a physically transparent discussion of second - order effects on the cmb . indeed , the ease with which one can write down the exact equations for the physically relevant variables is one of the major strengths of the covariant approach .    the linear equations describing scalar modes and tensor modes were obtained from the full set of equations in a straightforward and unified manner , highlighting the advantage of having the full equations ( independent of the decomposition into scalar , vector and tensor modes ) available .",
    "for the scalar case , the boltzmann multipole equations for the moments of the distribution functions obtained here were equivalent to those usually seen in the literature .",
    "however , for tensor modes , the covariant approach led naturally to a set of moment variables that more conveniently describe the temperature anisotropy than those usually employed . for scalar modes",
    ", we discussed the solution of the perturbation equations in detail , including the integral solution of the boltzmann multipole equations and the relation between the timelike integrations performed in the multipole approach to calculating cmb anisotropies , and the lightlike integrations of the line of sight approach .",
    "the numerical solution of the scalar equations in a @xmath11 , almost - frw , cdm universe were also discussed .",
    "our numerical results provide independent confirmation of those of other groups , ( see , for example , ma &  bertschinger ( 1995 ) and seljak & zaldarriaga ( 1996 ) ) , who have obtained their results by employing non - covariant methods in specific gauges .",
    "typically , these methods require one to keep careful track of all residual gauge - freedom , both to enable identification of any gauge - mode solutions , and to ensure that the final results quoted are gauge - invariant ( and hence observable ) .",
    "fortunately , the isotropy of the photon distribution function in an exact frw universe ensures that the cmb power spectrum , as calculated from the gauge - dependent perturbation to the distribution function , is gauge - invariant for @xmath304 .",
    "we hope to have shown the ease with which the covariant approach to cosmology can be applied to the problem of calculating cmb anisotropies .",
    "the covariant and gauge - invariant method discussed here frees one from the gauge problems that have caused confusion in the past , and focuses attention on the physically relevant variables in the problem and the underlying physics .",
    "future work in this area will include the discussion of non - linear effects ( maartens at al .",
    "1998 ) , the inclusion of polarisation , and the effects of hot dark matter , all of which can be expected to bring the same advantages of physical clarity and transparency that we hope to have demonstrated here ."
  ],
  "abstract_text": [
    "<S> we present a fully covariant and gauge - invariant calculation of the evolution of anisotropies in the cosmic microwave background ( cmb ) radiation . </S>",
    "<S> we use the physically appealing covariant approach to cosmological perturbations , which ensures that all variables are gauge - invariant and have a clear physical interpretation . </S>",
    "<S> we derive the complete set of frame - independent linearised equations describing the ( boltzmann ) evolution of anisotropy and inhomogeneity in an almost friedmann - robertson - walker ( frw ) cold dark matter ( cdm ) universe . </S>",
    "<S> these equations include the contributions of scalar , vector and tensor modes in a unified manner . </S>",
    "<S> frame - independent equations for scalar and tensor perturbations , which are valid for any value of the background curvature , are obtained straightforwardly from the complete set of equations . </S>",
    "<S> we discuss the scalar equations in detail , including the integral solution and relation with the line of sight approach , analytic solutions in the early radiation dominated era , and the numerical solution in the standard cdm model . </S>",
    "<S> our results confirm those obtained by other groups , who have worked carefully with non - covariant methods in specific gauges , but are derived here in a completely transparent fashion . </S>"
  ]
}