{
  "article_text": [
    "since its first implementation by hybertsen and louie@xcite and by godby et al@xcite the so called @xmath1 method ( with @xmath2 being the green function in the local density approximation ( lda ) for the density functional theory , and @xmath3 being the screened interaction in the random phase approximation ( rpa ) ) has become a method of choice for relatively inexpensive and accurate calculations of the electronic structure of weakly correlated materials.@xcite as a disadvantage of the approach one can point out its dependence on the starting point .",
    "electronic spectra obtained in lda should already be sufficiently accurate in order to ensure that @xmath1 provides results close to the experiment . obviously , it is not always the case .",
    "one of the remedies is to switch from the lda to another starting point which suits better for the specific material .",
    "for example jiang et al.@xcite used lda+u method@xcite to study the electronic structure of lanthanide oxides . by adjusting the u parameter",
    "one can construct the lda+u spectra in decent agreement with experiment and correspondingly the @xmath1 approach performed on top of lda+u may work pretty well .",
    "one can use other starting points together with the @xmath1 approach : exact exchange approximation ( exx)@xcite or hybrid functional@xcite . generally one can say that the success of the g@xmath4w@xmath4 approach is based on the cancellation of error stemming for the lack of self - consistency on the one hand and the absense of the vertex corrections on the other hand . whereas different starting points followed by @xmath1 iteration may reproduce the experimental spectra with good accuracy for variety of materials , the approach can hardly be considered as a satisfactory one .    a logical way to eliminate",
    "the dependence on the starting point is to perform @xmath5 calculations self consistently ( sc ) .",
    "however , fully self consistent @xmath5 approach without vertex corrections has certain theoretical problems@xcite and corresponding calculations overestimate band gaps in semiconductors and insulators , and band widths in metals.@xcite it seems to be better justified for applications in the physics of atoms and molecules , as one can judge from the noticeable progress in the field.@xcite in the physics of solids , however , considerable requirements of the fully scgw method to the computer resources as well as intrinsic problems of the method itself@xcite have made it quite common to use partially scgw schemes . among such partially scgw approaches one can mention gw@xmath4 scheme@xcite where w is fixed at rpa level ( usually calculated with lda green s function ) and only g is iterated till convergence .",
    "another popular approach is the so called energy - only self - consistent gw@xcite where one - electron wave functions are fixed ( again , usually at lda level ) and only one - electron energies are renewed till consistency .",
    "the success of these partially sc schemes is based on the same cancellation of errors as in the case of g@xmath4w@xmath4 .",
    "partial sc usually makes the spectral features ( band widths / gaps ) a little wider and , thus , often improves the agreement with experiment .",
    "authors of the refs .",
    "[ ] and [ ] propose to apply diagonal ( in lda band states basis ) approximation for the self energy and green s function which makes the calculations much faster . in this case",
    "the success is based on the cancellation of error stemming from the neglect of non - diagonal terms in g and @xmath0 on the one hand and the neglect of vertex corrections on the other hand .",
    "considerable progress has been made by kotani et al.@xcite in their qsgw approach which essentially is equivalent to the fully scgw method but with special ( quasi - particle ( qp ) ) construction for the green function , which replaces the need to solve the dyson equation .",
    "the success of qsgw method relies on the fact that qp approximation cancels out in considerable degree the error associated with the absence of higher order diagrams in the self energy @xmath0 and the polarizability @xmath6 , as it has been explained in ref .",
    "[ ] in terms of z - factor cancelation .",
    "qsgw approach is computationally more expensive than @xmath1 but it does nt depend on a starting point .",
    "it usually gives the results similar to the lda - based @xmath1 results for simple metals and semiconductors , but often shows improvements for the materials where lda does nt provide a good starting point for the @xmath1 iteration ( nio is a good example , as it has been shown by faleev et al.@xcite ) .",
    "presently , qsgw approach is a very popular ab - initio method which provides reasonable one electron spectra for a wide class of materials.@xcite however , even for relatively weakly correlated materials , there is still enough room for improvements .",
    "looking at the results obtained with the qsgw method@xcite one can conclude that calculated band gaps are overestimated by about 5 - 15% for sp - semiconductots and insulators .",
    "for the materials with d- and f - electrons ( srtio@xmath7 , tio@xmath8 , ceo@xmath8 ) the error grows up to about 25%.@xcite similar error has been found in the calculated exchange splitting in gadolinium@xcite , whereas the calculated exchange splitting in nickel is almost twice too large as compared to the experimental one.@xcite besides , with qp construction for the green function the method is not diagrammatic anymore , which renders its improvement more complicated .",
    "an alternative way to improve the accuracy of the scgw method is to include skeleton diagrams of higher order ( vertex corrections ) in the self energy and the polarizability .",
    "however , direct diagrammatic extensions of this kind represent an extremely difficult problem in practice and , as a result , were not explored actively for solids .",
    "ummels et al.@xcite have applied first order vertex corrections to @xmath6 and @xmath0 combined with second order self - consistence diagrams for silicon and diamond .",
    "calculations have been performed with lda green s function and within plasmon pole approximation@xcite .",
    "it has been shown that vertex corrections and self - consistence diagrams cancel out to a high degree ( especially the correction to p ) which can be considered as a justification for the one - shot @xmath1 approach .",
    "bechstedt et al@xcite iterated the dyson equation for g and the bethe - salpeter equation for the irreducible polarizability simultaneously .",
    "certain approximations ( such as keeping only diagonal terms in bloch integrals and neglect of the local field effect ) have been made in the study .",
    "the principal conclusion of the work is that vertex correction in polarizability widely compensates the gw quasiparticle peaks renormalization , which can be considered as a support in favor of the qsgw approximation .",
    "considerable progress has been achieved , however , in studying the effect of vertex corrections following the ideas borrowed from the time dependent density functional theory ( tddft)@xcite , where the central role is played by the so called exchange - correlation kernel @xmath9 .",
    "the research along this line began in refs .",
    "[ ] where lda - based 2-point vertex function was proposed .",
    "model exchange - correlation kernels have also been introduced@xcite with improved ( as compared to lda - derived kernel ) properties .",
    "a very successful approach has been developed which recasts diagrammatically obtained polarizability ( usually of low order ) into an effective exchange - correlation kernel @xmath9.@xcite the kernel @xmath9 is a two - point object ( as opposed to the many - body kernel which is a four - point object ) .",
    "so the above recasting brings in a great efficiency .",
    "shishkin et al.@xcite have applied this approach to calculate the band gaps for a wide class of materials .",
    "the results obtained in ref . look promising .",
    "however , there were many simplifications involved in the calculations .",
    "first of all , the vertex correction has been included only in the polarizability , but not in the self energy .",
    "second , it was static , i.e. w in the diagrams has been approximated by its value at zero frequency . but may be most important of all is the fact that authors applied the vertex correction combined with quasi - particle self - consistence .",
    "the problem with this kind of approach is that the quasi - particle approximation itself can be considered as an effective vertex correction ( due to z - factor cancellation ) . if one applies the same arguments , as the authors of ref .",
    "[ ] did , to the approach which combines the qsgw and the vertex corrections one will realize that there is a double counting .",
    "the problems of combining the qsgw approach with vertex corrections have been studied for the two - site hubbard model recently.@xcite based on the above consideration , one can speculate that the static approximation for @xmath10 was actually needed to cancel out the error stemming from that double counting , because zero - frequency interaction is well enough screened and , correspondingly , its effect is much weaker than it would be had the authors of ref .",
    "applied full frequency - dependent interaction .",
    "as for the absence of the vertex correction in the self energy , authors say that their inclusion `` turned out to be numerically rather unstable and tended to bring the band gaps back to those obtained without vertex corrections '' , which can also be considered as a sign of inherent problems with the approach . a similar approach",
    "( combination of qsgw with static @xmath9 ) has been used recently by gruneis et al.@xcite to study the ionization potentials and band gaps of solids . in addition , authors of ref .",
    "[ ] have considered the correction to the self energy of the second order , but again , evaluated with static interaction .",
    "their observation was that vertex correction in the self energy actually increases the band gaps , making them worse than the ones with the vertex correction only in the polarizability .    in the present work",
    "the above simplifications in dealing with the vertex corrections are avoided .",
    "the approach is based on the hedin exact theory@xcite and approximations are introduced purely diagrammatically , without connection with tddft . also , there is no quasi - particle approximation involved .",
    "instead the green function is renewed on every iteration from dyson s equation .",
    "all diagrams take into account full frequency - dependence of the screened interaction , which also is updated on every iteration .",
    "third , the vertex corrections are studied for both the polarizability and the self energy .",
    "the principal goal of this study is to elucidate the effect of vertex corrections in fully self - consistent calculations . to make this research as clean as possible",
    ", one has to avoid the schemes which are based on the cancellation of errors .",
    "this makes the direct comparison of the methods being developed in this work with previous studies ( based on g@xmath4w@xmath4 , gw@xmath4 , qsgw , qsgw + vertex evaluated with static w ) not very useful for answering the main question of this research .",
    "comparison with earlier studies is very useful , however , to check the accuracy of numerical implementation of the code .",
    "the paper begins with a formal presentation of hedin s equations ( subsection [ hed_eq ] ) .",
    "the self - consistent schemes of solving them together with numerical approximations comprise the subsections [ vrt_appr ] , [ def_sc ] , and [ num_appr ] .",
    "section [ res ] provides the results obtained and a discussion .",
    "the conclusions are given afterwords .",
    "finally , the details of the practical solution of hedin s equations for solids are presented in the appendix .",
    "the approach which is used in this work is based on the hedin equations.@xcite for convenience , we remind the reader about how hedin s equations could be solved self - consistently in practice .",
    "matsubara s formalism is used throughout the work .",
    "suppose one has a certain initial approach for the green function @xmath11 and the screened interaction @xmath10 .",
    "then one calculates the following quantities :    three - point vertex function from the bethe - salpeter equation    @xmath12    where @xmath13 and @xmath14 are spin indexes , and the digits in the brackets represent space - matsubara s time arguments ,    polarizability    @xmath15    screened interaction    @xmath16    and the self energy    @xmath17    in the equation ( [ def_w2 ] ) v stands for the bare coulomb interaction . new approximation for the green function",
    "is obtained from dyson s equation    @xmath18    where @xmath2 is the green function in hartree approximation .",
    "( [ vert_0]-[d4 ] ) comprise one iteration .",
    "if convergence is not yet reached one can go back to the equation ( [ vert_0 ] ) to start the next iteration with renewed @xmath11 and @xmath10 .",
    "the system of hedin s equations formally is exact , but one has to introduce certain approximations when solving ( [ vert_0 ] ) for the vertex function @xmath19 in order to make the system manageable in practice .",
    "a convenient way to generate approximations for the vertex @xmath20 is to calculate the kernel @xmath21 in eqn.([vert_0 ] ) using a diagrammatic representation of the self energy up to a specific order in the screened interaction @xmath10 .",
    "the simplest non - trivial approach in this case is to use the famous @xmath5 approximation ( @xmath22 ) where @xmath10 is obtained from the polarizability ( @xmath23 ) which in turn is represented by the one - loop approximation ( @xmath24 ) . adapting this approach one gets for the kernel :    @xmath25,\\end{aligned}\\ ] ]    which is shown diagrammatically in fig.[theta_appr ] .    .",
    "direct lines represent green s function and wavy lines represent screened interaction w.,width=7 ]    approximation ( [ dsig_dg0 ] ) results in the following equation for the vertex function :    @xmath26\\nonumber\\\\&\\times g^{\\beta}(46)\\gamma^{\\beta}(673 ) g^{\\beta}(75).\\end{aligned}\\ ] ]         as the rung of the ladder.,width=8 ]     as the rung of the ladder.,width=8 ]    it is convenient to split the vertex into a trivial part and a correction ( @xmath27 ) . in this case one",
    "obtains an equation for the correction which might be solved iteratively :    @xmath28\\nonumber\\\\ \\times [ g^{\\beta}(43)&g^{\\beta}(35)+g^{\\beta}(46)\\triangle\\gamma^{\\beta}(673 ) g^{\\beta}(75)].\\end{aligned}\\ ] ]    in this work the following non - trivial approximations for the vertex are used : i ) first order approximation ( @xmath29 ) is obtained when one keeps only the first term on the right hand side of ( [ d_vert1 ] ) ( schematically @xmath30 ) , ii ) the vertex in `` gw '' approximation ( @xmath31 ) when all terms on the rhs of ( [ d_vert1 ] ) are kept intact , and iii ) the vertex @xmath32 , which is similar to the approximation @xmath31 , but corresponds to an additional approximation where one neglects the diagrams with possible spin flips ( i.e. the terms with @xmath33 in ( [ d_vert1 ] ) are not included ) .",
    "diagrammatic representations of the approximations i)-iii ) are shown in figures [ gamma_1 ] , [ gamma_theta ] , and [ gamma_w ] correspondingly .",
    "the abbreviation @xmath31 is particularly meaningful when the corresponding vertex is calculated with @xmath11 and @xmath10 from scgw calculation .",
    "the polarizability evaluated with this vertex ( and with @xmath11 in ( [ def_pol1 ] ) also taken from scgw ) is `` physical '' in a sense that it is an exact functional derivative of the electronic density ( calculated in scgw approximation ) with respect to the total electric field ( external plus induced ) and , as a result , respects the charge preservation . in the present work another variant of @xmath31",
    "is used - with @xmath11 and @xmath10 being fully self - consistent ( with vertex corrections included ) . in this case the corresponding polarizability is no more physical because the self energy and the polarizability include more diagrams than the approximation ( @xmath22 , @xmath24 ) assumed here in the bethe - salpeter equation .",
    "thus , in fully self - consistent calculations one has to trade between the improvements in spectra resulting from higher order diagrams on the one hand and the degree of charge preservation on the other hand .    in this",
    "study the vertex @xmath31 is calculated from eq.([d_vert1 ] ) iteratively , i.e. the calculation of the vertex function is achieved through a `` small '' loop of iterations as compared to the `` big '' loop of iterations of the self - consistent scheme depicted in the eqs.([vert_0]-[d4 ] ) .",
    "corresponding steps of the `` small '' loop of iterations are sketched below .",
    "full details are given in appendix .",
    "to simplify the formulae the following notations are introduced    @xmath34    @xmath35    @xmath36    so that the equation ( [ d_vert1 ] ) for the correction to the vertex takes the following form    @xmath37w(51).\\end{aligned}\\ ] ]    introducing yet more of notations    @xmath38,\\end{aligned}\\ ] ]    and @xmath39 one reduces the equation for the vertex correction to a formally very simple form    @xmath40    the iterations for the @xmath31 are performed as the following .",
    "one takes @xmath41 ( eqn . [ k0_def ] ) as an initial approach , then calculates @xmath42 ( eqn .",
    "[ q_def ] ) , @xmath43 ( eqn . [ t_def ] ) , and @xmath44 ( eqn . [ d_vert3 ] ) .",
    "then a correction to @xmath45 ( eqn . [ dk_def ] ) is evaluated and the process is repeated with a new @xmath46 .",
    "the iterations for the @xmath32 are simpler .",
    "they follow the same scheme but without @xmath42 and @xmath43 evaluation .",
    "finally , the approximation @xmath29 is obtained with just one step : @xmath47 .",
    "some of the above equations are easier to handle in the reciprocal space ( band representation ) and frequency , whereas other are simpler in the real space and imaginary time representation .",
    "so one switches from one to another representation and back on every iteration .",
    "the details about how it is done can be found in appendix .",
    "having defined the approximations for the vertex function one can proceed with the construction of iterative schemes of solving the hedin equations ( [ vert_0]-[d4 ] ) .",
    "the schemes differ by which approximation for the vertex function is used in the expression for the polarizability ( [ def_pol1 ] ) and in the expression for the self energy ( [ def_m8 ] ) . in this work",
    "seven sc schemes are studied .",
    "they have been collected in table [ sc_schemes ] which explains their diagrammatic representations .",
    ".diagrammatic representations of the polarizability and the self energy in sc schemes of solving the hedin equations .",
    "arguments in square brackets specify @xmath11 and @xmath10 which are used to evaluate the vertex function .",
    "other details are explained in the main text .",
    "[ cols=\"^,^,^\",options=\"header \" , ]     spectral functions of si and lif are presented in figures [ a_g_x_si ] and [ a_g_lif ] correspondingly .",
    "as it was explained before , for the k - mesh @xmath48 the band gap in silicon is measured between the highest occupied state at the @xmath20-point in the brillouin zone and the lowest unoccupied state at the @xmath49-point .",
    "correspondingly , the spectral function at these two @xmath50-points have been combined in the figure [ a_g_x_si ] .",
    "the band gap in lif corresponds to the direct transition between the highest occupied and the lowest unoccupied band at the @xmath20-point in the brillouin zone .",
    "tables [ b_gap_si ] and [ b_gap_lif ] present numerical data for the band gaps in si and lif compared with the experiment and with earlier calculations .",
    "first of all , one can check that for qsgw and qsgw@xmath4 methods the band gaps of si obtained in this study are within the range of results obtained in earlier studies .",
    "this confirms that numerical accuracy of the gw part of the code is sufficiently good .",
    "slight increase in the band gap of lif relative to the earlier results most likely is attributed to the fact that quasiparticle approach in this work involves linearization of self energy.@xcite this linearization is not a part of the fully sc methods ( a - g ) , studied in this work .",
    "comparison with experimental data shows that , similar to alkali metals , qsgw@xmath4 is superior in accuracy among quasiparticle - based sc schemes .",
    "considering fully sc approximations , one can conclude from tables [ b_gap_si ] and [ b_gap_lif ] that fully scgw is not very successful approach ( the deviation from experiment in this case is more than 30% for si and more than 10% for lif ) .",
    "however , this error can be reduced practically to zero ( within uncertainty of experiment ) in both cases if one applies appropriate vertex corrections ( schemes d , e , and g ) .",
    "it is interesting , that in case of lif ( wide gap insulator ) the vertex corrections to the self energy are not very important ( scheme c results in essentially the same band gap as the schemes d , e , and g ) . at the same time , the first order vertex correction in polarizability ( scheme b ) is not sufficient : it is essential to solve bethe - salpeter equation for the polarizability . as for the scheme f which includes higher order diagrams in the self energy , the calculation was stable ( as compared to alkali metals ) but",
    "the band gap obtained shows worse accuracy for lif than the results from d , e , and g schemes .",
    "in conclusion , a few self - consistent schemes of solving the hedin equations have been introduced .",
    "the combination of features which distinguishes these schemes from the previously published works on the subject is the following : they are diagrammatic and self - consistent , they do not apply the quasi - particle approximation for the green function , they threat full frequency dependence of the interaction w.    for the materials studied in this work ( na , k , si , and lif ) one can conclude that the vertex corrections both in the polarizability and in the self energy are important . however , the vertex function which should be used in p has to be found from the bethe - salpeter equation , whereas it is enough for the vertex function to be of the first order ( in w ) to make proper corrections in @xmath0 .",
    "inclusion of higher order diagrams in the self energy has to be supplemented with the corresponding increase in the complexity of kernel of the bethe - salpeter equation .",
    "otherways their inclusion can make the whole scheme unstable which was the case for na and k in this study .",
    "the importance of proper treatment of the frequency dependence of @xmath10 in the vertex correction diagrams for the self energy has been revealed . it explained the increase in the calculated band gaps obtained in earlier works where static @xmath10 was used to evaluate the second order diagrams for the self energy .",
    "the best schemes in this work allow to considerably improve the accuracy of the calculated band widths and band gaps : the error becomes 10 times ( or more ) smaller than in the self - consistent gw approximation .",
    "moreover , they show superior accuracy as compared to the commonly used nowadays qsgw approximation .    from the computational point of view",
    ", a few possible technical optimizations have been pointed out ( different k / time / frequency - meshes for gw and vertex parts ) .",
    "in addition , one can take an advantage of the fact that the scheme d is one of the best in this study , and , as compared to another successful scheme ( e ) , is far more efficient , because bethe - salpeter s equation should be solved only once in the scheme d , whereas in the scheme e it should be solved on every iteration .",
    "another simplification , which worked sufficiently well in this study for si and lif , is to neglect spin - flips diagrams in the kernel of the bethe - salpeter equation .",
    "it also saves computation time considerably .",
    "this work was supported by the u.s .",
    "department of energy , office of science , basic energy sciences as apart of the computational materials science program .",
    "the calculations have been performed on the dell hpc cluster elf i at the rutgers university .",
    "i thank koji tanaka for the help with adapting the code for the elf i. fruitful discussions of the parallelization strategies with viktor oudovenko are highly appreciated .",
    "in this appendix the details of the formulae are given in a form close to the implementation in the code .",
    "one notion should be mentioned here before proceeding .",
    "the functions ( @xmath51 ) which are evaluated in the course of iterations ( [ k0_def]-[d_vert3 ] ) are three - point functions .",
    "one of the three points can be considered as independent . in the representation accepted in this work , the independent point corresponds to the indexes @xmath52 , which are the reduced product basis index , the point in the brillouin zone , and matsubara s frequency ( see below for the specifications ) .",
    "the calculations for every triplet of these indexes are totally independent , which is used to perform the calculations in parallel .",
    "besides , one needs to do the calculations only for the irreducible set of @xmath53-points . having the iterations ( [ k0_def]-[d_vert3 ] )",
    "converged , one can proceed with the corrections to the polarizability and to the self energy . for the evaluation of the latter",
    ", however , one needs to combine the information from the above triplets of indexes .      in order to make the reading of the following sections easier ,",
    "the notations have been collected here :    * @xmath13 - spin index * @xmath54 - band indexes .",
    "bands obtained in the effective hartree - fock problem@xcite are used in the vertex part .",
    "see the section i in ref .",
    "[ ] for the details . * @xmath55 - points in the brillouin zone * @xmath56 - reduced product basis ( rpb ) index",
    "when it is used together with vector @xmath53 in the brillouin zone ( corresponding rpb function is @xmath57 ) , it runs over all rpb ( muffin - tins plus interstitial ) . when it is used together with atomic index @xmath58 ( corresponding rpb function in this case is @xmath59 ) it runs over the part of full rpb belonging to the given atom . *",
    "@xmath60 - fermionic matsubara s frequency * @xmath61 - bosonic matsubara s frequency * @xmath62 - matsubara s time * @xmath63 - chemical potential * @xmath64 - band energies * @xmath65 - band wave functions * @xmath14 - inverse temperature * @xmath66 - vectors of translations in real space * @xmath67 - coordinates ( or indexes ) of atoms in unit cell * @xmath68 - indexes combining orbital moment @xmath69 , its projection @xmath70 , and other quantum numbers distinguishing the orbitals @xmath71 for given spin @xmath13 and atom @xmath58 ( @xmath72-indexes also distinguish between @xmath73 and @xmath74 ) * @xmath75 - full number of @xmath50-points in the brillouin zone * @xmath76 - geometrical weight of the @xmath53-point in the brillouin zone , i.e. the ratio of the number of vectors in the star of @xmath53 and the full number of points in the brillouin zone * @xmath77 - the points on the regular real space mesh in the unit cell * @xmath78 - reciprocal lattice vectors * @xmath79 - reciprocal lattice vector associated with reduced product basis index @xmath80 .",
    "expanding @xmath11 in ( [ k0_def ] ) in the band states , one gets the formulae    @xmath81    and @xmath82 with @xmath57 representing the product basis functions defined on the reduced set of band states .",
    "as it will be clear from the equations below , one needs to evaluate ( [ k0_1 ] ) and ( [ k0_2 ] ) for @xmath83 only .",
    "two functions are needed to handle strong oscillations in @xmath84-dependence of @xmath85 ( see eqn .",
    "( [ k0_6 ] ) below ) .    equation ( [ d_vert3 ] ) is convenient to evaluate in real space and ( @xmath86)-representation . before transforming @xmath87 to the @xmath88-representation",
    ", the hartree - fock contributions are subtracted    @xmath89    and    @xmath90    after subtraction one uses ( [ tt_1 ] ) :    @xmath91    in the first term strong oscillations in @xmath87 as a function of @xmath84 originating from @xmath92 are damped by exponential factor which has weak @xmath84-dependence near @xmath93 . in the second term the oscillations come from @xmath94 , so one has to ensure the damping by rearranging the exponential factors as the following    @xmath95    at this point , it is convenient to introduce two functions    @xmath96    and @xmath97    now the following hartree - fock contribution in @xmath98-representation which was subtracted earlier in @xmath99-representation is added ( what is to be added to k1(k2 ) is clear from the structure of the formula ( [ k0_9 ] ) )    @xmath100    in case @xmath101 and @xmath102 the expression is different    @xmath103      specific formula to be used to transform the @xmath87-function to the real space depends on where its two space arguments belong ( mt - sphere or the interstitial region ) .",
    "correspondingly there are four different cases shown below :    mt - mt @xmath104    int - mt @xmath105    mt - int @xmath106    int - int @xmath107 with @xmath108    the coefficients @xmath109 represent the expansion of band states in plane waves in the interstitial region @xmath110 , and the coefficients @xmath111 represent the expansion of the band states in the orbital basis inside mt spheres @xmath112 .      the first term on the right hand side of the formula ( [ d_vert3 ] ) can be rewritten with explicit @xmath84- and frequency - dependencies as the following    @xmath114    for both @xmath115- and @xmath116-components one obtains the following formulae in the real space ( distinguishing again mt and the interstitial region ) :    mt - mt @xmath117    int - mt @xmath118    mt - int @xmath119    int - int @xmath120    in practical calculations one has to separate static and dynamic parts of the interaction @xmath121 .",
    "correspondingly , static and dynamic parts of the vertex correction are considered separately .",
    "particularly , there is no @xmath84-dependence in the static part .",
    "formulae ( [ dlam_wk_3]-[dlam_wk_6 ] ) are the same for dynamic parts @xmath122 ( @xmath115 is used instead of @xmath87 ) and @xmath123 ( @xmath116 is used instead of @xmath87 ) . for the static part @xmath124 , one replaces @xmath125 with @xmath126 and , correspondingly , @xmath127 is used instead of @xmath85 .",
    "equation ( [ dk_def ] ) can be used most efficiently with quantities in band / frequency representation .",
    "thus , @xmath128 , @xmath129 , and @xmath130 are transformed into the band representation first    @xmath131    with @xmath132    formula ( [ dlam_wk_6a ] ) is used for @xmath128 , @xmath129 , and @xmath130 with @xmath133 for the latter .",
    "then one transforms dynamic functions @xmath134 and @xmath135 into @xmath136 and @xmath137 using the formula ( [ ww_4 ] )    @xmath138\\nonumber\\\\ & + i\\sin(\\omega\\tau)\\nonumber\\\\&\\times[\\triangle \\gamma1^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\tau;\\nu ) + \\triangle \\gamma1^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\beta-\\tau;\\nu)]\\nonumber\\\\ & + \\cos((\\omega-\\nu)\\tau)\\nonumber\\\\&\\times[\\triangle \\gamma2^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\tau;\\nu ) -\\triangle \\gamma2^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\beta-\\tau;\\nu)]\\nonumber\\\\ & + i\\sin((\\omega-\\nu)\\tau)\\nonumber\\\\&\\times[\\triangle \\gamma2^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\tau;\\nu ) + \\triangle \\gamma2^{0\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\beta-\\tau;\\nu)]\\big\\},\\end{aligned}\\ ] ]    and @xmath139\\nonumber\\\\ & -i\\sin(\\omega\\tau)\\nonumber\\\\&\\times[\\triangle \\gamma2^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\tau;\\nu ) + \\triangle \\gamma2^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\beta-\\tau;\\nu)]\\nonumber\\\\ & + \\cos((\\omega-\\nu)\\tau)\\nonumber\\\\&\\times[\\triangle \\gamma1^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\tau;\\nu ) -\\triangle \\gamma1^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\beta-\\tau;\\nu)]\\nonumber\\\\ & -i\\sin((\\omega-\\nu)\\tau)\\nonumber\\\\&\\times[\\triangle \\gamma1^{\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\tau;\\nu ) + \\triangle \\gamma1^{0\\alpha\\mathbf{k}}_{\\lambda\\lambda'}(s\\mathbf{q};\\beta-\\tau;\\nu)]\\big\\}.\\end{aligned}\\ ] ]      equation ( [ dk_def ] ) can be rewritten with explicit @xmath84-dependence as the following    @xmath141    or , in frequency representation @xmath142    it is also convenient to evaluate it in the band representation    @xmath143    and @xmath144    the vertex in the eqs .",
    "( [ dk_3 ] ) and ( [ dk_4 ] ) represents the sum of dynamic @xmath145 and static @xmath124 parts .",
    "it is convenient to evaluate eq.([q_def ] ) in real space and @xmath98-representation .",
    "considering again four cases according to the mt geometry , one obtains :    mt - mt @xmath146    mt - int @xmath147    int - mt @xmath148    int - int @xmath149    to evaluate @xmath150 , the same expression is used with replacement @xmath151 . then follows the transformation to the @xmath53-space :    mt - mt @xmath152 int - mt @xmath153 mt - int @xmath154 int - int @xmath155 with @xmath156    finally , @xmath42-function is transformed to @xmath157-representation in order to be used in @xmath43-evaluation ( next subsection ) :",
    "@xmath158\\nonumber\\\\ & + i\\sin(\\nu'\\tau)\\nonumber\\\\&\\times\\big[q1^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};\\tau;\\nu)- q1^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};-\\tau;\\nu)\\big]\\nonumber\\\\ & + \\cos(\\nu'-\\nu)\\tau\\nonumber\\\\&\\times\\big[q2^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};\\tau;\\nu)+ q2^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};-\\tau;\\nu)\\big]\\nonumber\\\\ & + i\\sin(\\nu'-\\nu)\\tau\\nonumber\\\\&\\times\\big[q2^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};\\tau;\\nu)- q2^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};-\\tau;\\nu)\\big]\\big\\},\\end{aligned}\\ ] ]    and @xmath159\\nonumber\\\\ & -i\\sin(\\nu'\\tau)\\nonumber\\\\&\\times\\big[q2^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};\\tau;\\nu)- q2^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};-\\tau;\\nu)\\big]\\nonumber\\\\ & + \\cos(\\nu'-\\nu)\\tau\\nonumber\\\\&\\times\\big[q1^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};\\tau;\\nu)+ q1^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};-\\tau;\\nu)\\big]\\nonumber\\\\ & -i\\sin(\\nu'-\\nu)\\tau\\nonumber\\\\&\\times\\big[q1^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};\\tau;\\nu)- q1^{\\mathbf{q}'}_{s's''}(s\\mathbf{q};-\\tau;\\nu)\\big]\\big\\}.\\end{aligned}\\ ] ]      from the equation ( [ t_def ] ) one obtains the t - function in the rpb representation @xmath160 and @xmath161    in order to perform the transform @xmath162 the static contribution is subtracted first    @xmath163    and @xmath164    after that the transformation is accomplished straightforwardly :    @xmath165    where the following notations have been defined    @xmath166    and @xmath167    now one adds the static contribution which was subtracted before @xmath168 and @xmath169    finally , the @xmath43-function is transformed in the real space - representation to be used in ( [ d_vert3 ] ) :    mt - mt @xmath170 int - mt @xmath171 mt - int @xmath172 int - int @xmath173 with @xmath174      second term on the rhs of ( [ d_vert3 ] ) is evaluated in the real space and @xmath98-representation .",
    "again , there are four different cases according to the mt - geometry :    mt - mt @xmath176    mt - int @xmath177    int - mt @xmath178    int - int @xmath179    @xmath180 is evaluated similarly with the replacement @xmath181 in the formulae above .",
    "according to the eqs .",
    "( [ def_pol1 ] ) and ( [ dk_def ] ) the correction to the polarizability can be written as the following    @xmath182    it is represented in the rpb    @xmath183    where the coefficients are found from the band representation of @xmath184 @xmath185    after that the correction expressed in the full product basis ( @xmath186 ) can be found @xmath187",
    "in order to find the correction to the self energy , one can use general expression    @xmath188    and , according to the separation of the vertex into dynamic @xmath189 and static @xmath124 parts , and the separation of the screened interaction into coulomb @xmath126 and dynamic @xmath190 parts , one can divide the correction to the self - energy into dynamic , semi - dynamic , and static .",
    "they are considered below in this section .    in all cases",
    "the non - symmetrized self energy @xmath191 is evaluated first .",
    "it is obtained when the summation runs only over irreducible @xmath53-points with weights @xmath192 . in the end",
    ", the correction to the self energy is obtained according to the symmetrization procedure    @xmath193    where @xmath194 represents the symmetry operation , and @xmath195 is the number of symmetry operations .",
    "the formulae of this subsection are applied when eq.([sig_1 ] ) is used with dynamic vertex and dynamic part of the interaction @xmath190 . in this case",
    "the expression ( [ sig_1 ] ) reads as the following    @xmath196    where digits are used as space coordinates .    introducing @xmath197 through the relation    @xmath198",
    "one obtains    @xmath199    for the different locations of arguments @xmath200 and @xmath201 one gets :    mt - mt @xmath202 with obvious notations ,    int - mt @xmath203    mt - int @xmath204    int - int @xmath205    after that one has generally    @xmath206      semi - dynamic part of the self energy is divided as the following    @xmath207    where the vertex function was divided into the first order and the higher orders .    in the above expression the term",
    "@xmath208 is just the transposed of the term @xmath209 , so one needs to calculate only the term @xmath210 :    @xmath211    for the different locations of arguments @xmath200 and @xmath201 one gets :    mt - mt @xmath212    int - mt @xmath213    mt - int @xmath214    int - int @xmath215    the term @xmath216 in ( [ sig_10 ] ) is calculated using ( [ sig_5]-[sig_8 ] ) similarly to the totally dynamical part but with @xmath126 instead of @xmath190 .",
    "the term @xmath217 in ( [ sig_10 ] ) is calculated using ( [ sig_12]-[sig_15 ] ) similarly to the semi - dynamical part of the first order .",
    "totally static part of the self energy is evaluated as the following    @xmath218    again , for the different locations of arguments @xmath200 and @xmath201 one gets :    mt - mt @xmath219    int - mt @xmath220    mt - int @xmath221    int - int @xmath222      vertex of the first order as a function of @xmath84 ( @xmath223 ) should be calculated independently , because , as a function of @xmath61 , it is a slow decreasing function , and direct transform @xmath224 is not easy .",
    "corresponding formulae are obtained straightforwardly :    mt - mt @xmath225    int - mt @xmath226    mt - int @xmath227    int - int @xmath228 with    @xmath229",
    "for convenience , the definitions of the time - frequency transforms for the functions of two imaginary time arguments , accepted in this work , are collected below ."
  ],
  "abstract_text": [
    "<S> a few self - consistent schemes to solve the hedin equations are presented . </S>",
    "<S> they include vertex corrections of different complexity . </S>",
    "<S> commonly used quasiparticle approximation for the green function and static approximation for the screened interaction are avoided altogether . using alkali metals na and k as well as semiconductor si and wide gap insulator lif as examples , it is shown that both the vertex corrections in the polarizability p and in the self energy @xmath0 are important . </S>",
    "<S> particularly , vertex corrections in @xmath0 with proper treatment of frequency dependence of the screened interaction always reduce calculated band widths / gaps , improving the agreement with experiment . </S>",
    "<S> the complexity of the vertex included in p and in @xmath0 can be different . </S>",
    "<S> whereas in the case of polarizability one generally has to solve the bethe - salpeter equation for the corresponding vertex function , it is enough ( for the materials in this study ) to include the vertex of the first order in the self energy . </S>",
    "<S> the calculations with appropriate vertices show remarkable improvement in the calculated band widths and band gaps as compared to the self - consistent gw approximation as well as to the self - consistent quasiparticle gw approximation . </S>"
  ]
}