{
  "article_text": [
    "packet sampling is an integral part of passive network measurement on today s internet .",
    "the high traffic volumes on backbone networks and the pressure on routers has resulted in the need to control the consumption of resources in the measurement infrastructure .",
    "this has resulted in the definition and use of estimated statistics by routers , generated based on sampling packets in each direction of each port on the routers .",
    "the aims of this paper is to analyse the effects of the sampling process as operated by netflow , the dominant standard on today s routers .",
    "there are three constraints on a core router which lead to the use packet sampling : the size of the record buffer , the cpu speed and the record look - up time . in @xcite",
    ", it is noted that in order to manage and analyse the performance of a network , it is enough to look at the basic statistical measures and summary statistics such as average range , variance , and standard deviation .",
    "however , in this paper we analyse both analytically and practically the accuracy of the inference of original characteristics from the sampled stream when higher order statistics are used .",
    "this paper focuses on the inference of original network traffic characteristics for flows from a sampled set of packets and examines how the sampling process can affect the quality of the results . in this context , a flow is identified specifically , as the tuple of the following five key fields : source ip address , destination ip address , source port number , destination port number , layer 4 protocol type .      a router at the core of an internet link is carrying a large number of flows at any given time .",
    "this pressure on the router entails the use of strict rules in order to export the statistics and keep the router memory buffer and cpu resources available to deal with changes in traffic patterns by avoiding the handling of large tables of flow records .",
    "rules for expiring netflow cache entries include :    * flows which have been idle for a specified time are expired and removed from the cache ( 15 seconds is default ) * long lived flows are expired and removed from the cache ( 30 minutes is default ) * as the cache becomes full a number of heuristics are applied to aggressively age groups of flows simultaneously * tcp connections which have reached the end of byte stream ( fin ) or which have been reset ( rst ) will be expired      distributions studies have been done extensively in literature . in brief conclusion ,",
    "internet traffic is believed to have heavy - tailed distribution , self - similar nature , long range dependence @xcite .",
    "sampling has the following effects on the flows :    * it is easy to miss short flows @xcite * mis - ranking on high flows @xcite * sparse flow creation@xcite    _ packet sampling : _ + the inversion methods are of little to no use in practice for low sampling probability @xmath1 , such as @xmath2 ( 1 packet in 100 ) or smaller , and become much worse as @xmath1 becomes smaller still .",
    "for example , on the abilene network , 50% sampling was needed to detect the top flow correctly @xcite .",
    "_ flow sampling : _",
    "+ preserves flows intact and the sampling is done on the flow records . in practice , any attempt to gather flow statistics involves classifying individual packets into flows . all packet meta - data has to be organised into flows before sampling can take place .",
    "this involves more cpu load and more memory if one uses the traditional hash table approach with one entry per flow .",
    "new flow classification techniques , such as bitmap algorithms , could be applied but there is no practical usage in this manner currently .",
    "in this section we look at a more detailed analysis of the effect of sampling as performed by netflow on higher order statistics of the packet and flow size distributions . for the analysis of packet sampling application",
    "is used by netflow , we emulated the netflow operation on a 1 hour oc-48 trace , collected from the caida link on @xmath3 of april 2003 .",
    "this data set is available from the public repository at caida @xcite .",
    "the trace comprises of 84579462 packets with anonymised source and destination ip addresses . an important factor to rememberer in this work",
    "is the fact that the memory constraint on the router has been relaxed in generating the flows from the sampled stream .",
    "this means that there maybe more than tens of thousands of flow keys present at the memory at a given time , while in netflow , the export mechanism empties the buffer list regularly which can have a more severe impact on the resultant distribution of flow rates and statistics",
    ".      table [ tabledt ] illustrates the data rates @xmath4 per interval of measurement .",
    "inverted data rates , by dividing @xmath4 by the sampling probability @xmath1 , are shown as @xmath5 .",
    ".the statistical properties on data rates @xmath4 [ cols=\"^,^,^,^,^\",options=\"header \" , ]     [ tablept ]    the kurtosis decreases in all of the considered examples .",
    "this means that the reconstructed streams are more homogeneous and less prone to outliers when compared with the original traces .",
    "thus , more of the variance in the original traces in packet size can be attributed to infrequent packets that have inordinately big packets that were missed in the sampling process , and thus the variance in the reconstructed stream consists more of homogeneous differences and not large outliers . however , both the reconstructed and unsampled streams are leptokurtic and thus tend to have long , heavy tails .",
    "the two - sample ks test is one of the most useful and general non - parametric methods for comparing two samples , as it is sensitive to differences in both location and shape of the empirical cumulative distribution functions of the two samples .",
    "a cdf was calculated for the number of packets per flow and the number of octets per flow for each of the 120 sampling intervals of 30 seconds each , both for the sampled / inverted and unsampled streams .",
    "then , a two - sample kolmogorov - smirnov test with @xmath6 significance level was performed between the 120 unsampled and the 120 sampled & inverted distributions . in every case the distributions before and after sampling and inversion were found to be significantly different , and thus it is very clear that the sampling and inversion process significantly distorts the actual flow behaviour of the network .",
    "the effects of sampling on network traffic statistics can be measured from different perspectives . in this section",
    "we will cover the theories behind the sampling strategy and use some real data captures from caida in an emulation approach to demonstrate the performance constraints of systematic sampling .",
    "the great advantage of sampling is the fact that the first order statistics do not show much variation when the sampling is done at consistent intervals and from a large pool of data .",
    "this enables the network monitoring to use the sampled statistics to form a relatively good measure of the aggregate measure of network performance .",
    "figure [ compare ] displays the data rates @xmath4 , in number of bytes seen per 30 second interval , on the one hour trace .",
    "the inverted data @xmath4 is also shown with diamond notation , showing the statistics gathered after the sampled data is multiplied by the sampling rate .",
    "the black dots display the relative error per interval , @xmath7 .",
    "figure [ pktscompare ] displays the packet rates @xmath8 , the number of packets per 30 second interval , versus the sampled and inverted packet rates @xmath9 . in this figure",
    ", it can be observed that the inversion does a very good job at nearly all times and the relative error is negligible .",
    "this is a characteristics of systematic sampling and is due to the central limit theorem .",
    "it can be readily seen that the recovery of packet rates by simple inversion is much better than the recovery of data rates .",
    "this is because sampling one in a thousand packets deterministically can be trivially inverted by multiplying by the sampling rate ( 1000 ) : we focus on packet level measurement , as opposed to a flow level measurement . if the whole traffic flow is collapsed into a single link , then if we sample one packet out every thousand and then multiply that by the sampling rate , we will get the total number of packets in that time window .",
    "we believe that the small differences that we can see in figure [ pktscompare ] are due to the fact that at the end of the window some packets are lost ( because their ` representative ' was not sampled ) or overcounted ( a ` representative ' for 1000 packets was sampled but the time interval finished before they had passed ) .",
    "we believe these errors happen between measurement windows in time , i.e. they are window - edge effects .",
    "the inversion property described above does not hold for measuring the number of bytes in a sampling interval .",
    "simple inversion essentially assumes that all packets in a given flow are the same size , and of course this assumption is incorrect .",
    "it is to be expected that the greater the standard deviation of packet size over an individual flow , the more inaccurate the recovery by simple inversion will be regarding the number of bytes per measurement interval .",
    "figures [ dataerr ] and [ pkterror ] displays the standard error rate on data rate and packet rate recovery respectively , in different measurement intervals .",
    "figure [ pcktscdf ] , displays the cdf of packet size distribution in all the flows formed from the sampled and unsampled streams .",
    "the little variation in the packet size distribution conforms to the findings of the previous section where it was discussed that the packet sampling has low impact on the packet size distribution .",
    "figure [ flowpckts]:1 shows the effect that the distribution of packet lengths can have on the distribution of flow lengths when periodic packet sampling is applied . as flows reconstructed from a sampled packet stream are predominantly formed by just one packet",
    ", their length distribution follows that of single packets ( figure [ pcktscdf ] ) . that is the reason for the sharp jump near 1500 octets , as this characteristic originates from the maximum frame size in ethernet networks .",
    "& length in bytes [ right ] per flow , original vs inverted , title=\"fig:\",scaledwidth=45.0% ]   & length in bytes [ right ] per flow , original vs inverted , title=\"fig:\",scaledwidth=45.0% ]    from figure [ flowpckts]:2 , it can be readily seen that , in the sampled stream , more than 90 percent of flows consist of a single packet , whereas in the unsampled case a much grater diversity in flow lengths exists for small flows .",
    "this is due to the fact that simple packet - based deterministic sampling under - represents short flows , and those short flows that are indeed detected by the procedure after sampling usually consist of a single packet .",
    "thus , short flows are either lost or recovered as single packet flows , and long flows have their lengths reduced .",
    "in this paper we have reviewed the effects of sampling and flow record creation , as done by netflow , on the traffic statistics which are reported by such a process .",
    "it is inevitable that systematic sampling can no longer provide a realistic picture of the traffic profile present on internet links .",
    "the emergence of applications such as video on - demand , file sharing , streaming applications and even on - line data processing packages prevents the routers from reporting an optimal measure of the traffic traversing them . in the inversion process",
    ", it is a mistake to assume that the inversion of statistics by multiplication by the sampling rate is an indicate of even the first order statistics such as packet rates .",
    "an extension to this work and the inversion problem entails the use of more detailed statistics such as port numbers and tcp flags in order to be able to infer the original characteristics from the probability distribution functions of such variables .",
    "this will enable a more detailed recovery of original packet and data rates for different applications .",
    "the inference of such probabilities , plus use of methods such as bayesian inference , would enable a forecasting method which would enable the inversion of the sampled stream in near real time .    in a related work",
    ", we will be looking at alternative flow synthesis schemes , looking at techniques replacing the netflow , such as use of hashing techniques using bloom filters .",
    "the use of a light weight flow indexing system will allow for a larger number of flows to be present at the router , possibly increasing the memory constraints and allowing for a higher sampling rate , which will in turn lead to more accurate inversion .",
    "there has been a great deal of worked done on analysis of sampling process and inversion problem .",
    "choi et al . have explored the sampling error and measurement overhead of netflow in @xcite though they have not looked at inversion process .    in @xcite ,",
    "the authors have compared the netflow reports with those obtained from snmp statistics and packet level traces , but without using the sampling feature of netflow which is perhaps the dominant version in use nowadays .",
    "estan et al .",
    "@xcite have proposed a novel method of adapting the sampling rate at a netflow router in order to keep the memory resources at a constant level .",
    "this is done by upgrading the router firmware , which can be compromised by an attacker injecting varying traffic volume in order to take down the router .",
    "also this work has not considered the flow length statistics which are the primary focus of our work .",
    "hohn et al .",
    "@xcite have proposed a flow sampling model which can be used in an offline analysis of flow records formed from an unsampled packet stream . in this model",
    "the statistics of the original stream are recovered to a great extent .",
    "however the intensive computing and memory resources needed in this process prevents the implementation of such a scheme on highspeed routers .",
    "they prove it impossible to accurately recover statistics from a packet sampled stream , but based on the assumption of packets being independent and identically distributed    roughan at @xcite has looked at statistical processes of active measurement using poisson and uniform sampling and has compared the theoretical performance of the two methods .",
    "papagiannaki et al . at @xcite have discussed the effect of sampling on tiny flows when looking at generation of traffic matrices .",
    "authors at @xcite have been looking at anomaly detection using flow statistics , but without sampling . in @xcite and @xcite , authors have looked at inferring the numbers and lengths of flows of original traffic that evaded sampling altogether .",
    "they have looked at inversion via multiplication .",
    "the authors would like to acknowledge caida@xcite for providing the trace files .",
    "this work is conducted under the masts ( epsrc grant gr / t10503 ) and the 46paq project ( epsrc grant gr / s93707 ) .",
    "will leland , murad taqqu , walter willinger , and daniel wilson , on the self - similar nature of ethernet traffic ( extended version ) , ieee / acm transactions on networking , vol .",
    "1 , pp . 1 - 15 , february 1994 .    sommer , r. and feldmann , a. 2002 .",
    "netflow : information loss or win ? . in proceedings of the 2nd acm sigcomm workshop on internet measurment ( marseille , france , november 06 - 08 , 2002 ) .",
    "acm press , new york , ny , 173 - 174 .",
    "doi= http://doi.acm.org/10.1145/637201.637226    barakat , c. , iannaccone , g. , and diot , c. 2005 .",
    "ranking flows from sampled traffic . in proceedings of the 2005 acm conference on emerging network experiment and technology ( toulouse , france , october 24 - 27 , 2005 ) .",
    "acm press , new york , ny , 188 - 199 .",
    "performance and fault management ( cisco press core series ) by paul l della maggiora ( author ) , james m. thompson ( author ) , robert l. pavone jr .",
    "( author ) , kent j. phelps ( author ) , christopher e. elliott ( editor ) , publisher : cisco press ; 1st edition , isbn : 1578701805                    brauckhoff , d. , tellenbach , b. , wagner , a. , may , m. , and lakhina , a. 2006 .",
    "impact of packet sampling on anomaly detection metrics . in proceedings of the 6th acm sigcomm on internet measurement ( rio de janeriro , brazil ,",
    "october 25 - 27 , 2006 ) .",
    "acm press , new york , ny , 159 - 164 ."
  ],
  "abstract_text": [
    "<S> _ the high volume of packets and packet rates of traffic on some router links makes it exceedingly difficult for routers to examine every packet in order to keep detailed statistics about the traffic which is traversing the router . </S>",
    "<S> sampling is commonly applied on routers in order to limit the load incurred by the collection of information that the router has to undertake when evaluating flow information for monitoring purposes . </S>",
    "<S> the sampling process in nearly all cases is a deterministic process of choosing 1 in every @xmath0 packets on a per - interface basis , and then forming the flow statistics based on the collected sampled statistics . </S>",
    "<S> even though this sampling may not be significant for some statistics , such as packet rate , others can be severely distorted . </S>",
    "<S> however , it is important to consider the sampling techniques and their relative accuracy when applied to different traffic patterns . </S>",
    "<S> + the main disadvantage of sampling is the loss of accuracy in the collected trace when compared to the original traffic stream . to date there has not been a detailed analysis of the impact of sampling at a router in various traffic profiles and flow criteria . in this paper , we assess the performance of the sampling process as used in netflow in detail , and we discuss some techniques for the compensation of loss of monitoring detail . _ </S>"
  ]
}