{
  "article_text": [
    "the matrix elements of the rotation operator between angular - momentum eigenstates are called the wigner @xmath1 function @xcite . when the rotation is specified with the three euler angles (",
    "@xmath2 , @xmath3 , @xmath4 ) , and the eigenstates are labeled with the magnitude ( @xmath5 = @xmath6 ) and the @xmath7 component ( @xmath8 or @xmath9 = @xmath10 ) of the angular momentum vector , the @xmath1 function can be decomposed into three factors , @xmath11 where @xmath12 is the nontrivial part which needs some method to evaluate .",
    "it is called the wigner ( small ) @xmath0 function . in the standard phase convention for angular - momentum eigenstates ,",
    "the matrix elements of @xmath13 are purely imaginary and thus @xmath14 takes on real numbers",
    ".    one may be anxious about the fact that bohr and mottelson@xcite define the rotation matrix @xmath15 as the complex conjugate of the right - hand side ( r.h.s . ) of eq.([eq : dfunc ] ) .",
    "however , their definition for @xmath16 is identical with wigner s and the definition of the @xmath0 function is unique .    the wigner @xmath1 function is used in various fields of physics . in some applications ,",
    "those for large values of @xmath5 ( say , @xmath17 ) are necessary .",
    "an example in nuclear structure physics is the projection from spatially deformed solutions of modern realistic mean - field models to eigenstates of large angular momentum . for toy models ,",
    "too , one occasionally needs @xmath0 functions for very large @xmath5 to confirm the validity of one s picture under extreme conditions .",
    "( e.g. , a two - rotor model of refs .",
    "@xcite and @xcite ) .    the explicit form of the @xmath0 function is given by the wigner formula@xcite , which can be written as",
    ", @xmath18 where @xmath19 and @xmath20 are zero or positive integers , @xmath21 and @xmath22 @xmath23 however , this formula suffers from a serious loss of precision at high spins ( i.e. , for large @xmath5 ) except in the neighborhood of @xmath24 .",
    "for example , assuming that @xmath5 is a positive integer , @xmath25 , and @xmath26 , one obtains @xmath27 ^ 2,\\ ] ] which , if @xmath5 is even , becomes maximum at @xmath28 , @xmath29 ^ 2 } \\approx \\sqrt{\\frac{2}{\\pi j } } 2^j .\\ ] ] ( the stirling s formula is used in the last approximation . )",
    "the absolute value of the @xmath0 function is not greater than one because it is a matrix element of a unitary operator between normalized states .",
    "wigner s formula expresses the @xmath0 function as a result of cancellation among terms of possibly huge size , @xmath30 . for @xmath31 ,",
    "the precision of double - precision floating - point numbers ( 53-bit mantissa ) is lost completely , and even quadruple precision float numbers ( 113-bit mantissa ) is lost completely for @xmath32 .",
    "a few remedies have been proposed @xcite but the results are not completely free of the precision loss . in this paper ,",
    "i investigate the details of this loss of significance , and then present a perfect remedy to avoid such numerical difficulty .",
    "one can see easily that terms like @xmath33 appearing in the r.h.s .  of eq .",
    "( [ eq : wigner_formula_term ] ) , where @xmath34 and @xmath35 are zero or positive integers such that @xmath36 , can be expressed as linear combinations of terms @xmath37 ( when @xmath35 is odd ) and @xmath38 ( when @xmath35 is even ) with integers @xmath39 in @xmath40 and @xmath41 ( mod 2 ) , by means of repeated applications of the elementary trigonometric identities called the product - to - sum identities or the prosthaphaeresis formulas .    because the power of @xmath42 is @xmath43 in eq .",
    "( [ eq : wigner_formula_term ] ) , one can see that @xmath44 ( mod 2 ) and that the @xmath0 function is an even ( odd ) function if @xmath45 is even ( odd ) , which can be expanded only with cos ( sin ) function .",
    "this may also be deduced from eq .",
    "( [ eq : mk_km_minus_t ] ) , one of the properties of the @xmath0 function which i have enumerated in the appendix [ sec : dfunctionproerties ] .    from these considerations",
    ", one can conclude that the fourier expansion of the @xmath0 function has the following form : @xmath46 where @xmath47 and the summation runs over @xmath48 with the values of @xmath49 given in table  [ tab : nmin ] .",
    ".[tab : nmin ] the values of @xmath49 appearing in eq .",
    "( [ eq : dfuncfourierseries ] ) [ cols=\"^,^,^\",options=\"header \" , ]     for example , for @xmath50 and @xmath51 , the wigner formula ( [ eq : wigner_formula ] ) gives an expression ,    @xmath52    which can be rewritten in the form ( [ eq : dfuncfourierseries ] ) as @xmath53    by utilizing the orthogonality of @xmath54 and @xmath55 over @xmath56 ( considering that @xmath57 can take both integer and half - integer values ) , one can express the coefficients @xmath58 by an integral @xmath59 where @xmath60 for @xmath61 and @xmath62 for @xmath63 .    by substituting the @xmath0 function in eq .",
    "( [ eq : dfuncfourierseriescoef ] ) with eqs .",
    "( [ eq : wigner_formula]-[eq : small_w_jmkn ] ) , i have derived a more useful expression for @xmath58 containing only four elementary operations of arithmetic , @xmath64 } ( -1)^{r }   \\mbox{\\footnotesize $    \\left (      \\begin{array}{c }        2 \\nu \\\\",
    "2r+p      \\end{array }    \\right ) $ } \\nonumber \\\\   & \\times & \\frac{1}{2\\pi}i_{2(j+\\nu - n - r)-m+k - p,2(n+r)+m - k+p }   \\label{eq : tcoefanal}\\end{aligned}\\ ] ] where @xmath19 and @xmath20 are those already defined by eqs .",
    "( [ eq : nmin ] ) and ( [ eq : nmax ] ) , the square brackets are the floor function , i.e. , @xmath65=l$ ] for integer @xmath66 and real @xmath67 in @xmath68 , @xmath69 i.e. , @xmath70 and @xmath71 with zero or positive integers for @xmath34 and @xmath35 . if both @xmath34 and @xmath35 are even , @xmath72 while @xmath73 otherwise .    unlike the r.h.s .  of eq .",
    "( [ eq : wigner_formula ] ) , where the terms can have huge sizes and thus the numerical error is a serious problem , the r.h.s .  of eq .",
    "( [ eq : dfuncfourierseries ] ) is a summation of terms of order one or less and hence the problem is expected to disappear .",
    "this can be seen by calculating the integrals of the squares of the both sides of eq .",
    "( [ eq : dfuncfourierseries ] ) , @xmath74 because the absolute values of @xmath0 functions are @xmath75 , the left - hand side is @xmath76 and , consequently , it holds @xmath77 .",
    "a further study from the numerical point of view has indicated that the maximum ( among all the possible combinations of @xmath8 , @xmath9 , and @xmath57 ) value of @xmath78 is @xmath79 for @xmath80 , decreases as @xmath5 increases from an integer to the next half integer , and does not change as @xmath5 increases from a half integer to the next integer . for the interval @xmath81 , the maximum value for integer @xmath5 behaves as @xmath82 .",
    "unfortunately , eq .  ( [ eq : tcoefanal ] ) also suffers from a serious loss of significant digits in ordinary floating - point numerical calculations . indeed , for even integer @xmath5 , the term having the maximum magnitude among those in the r.h.s .  of eq .",
    "( [ eq : tcoefanal ] ) occurs at @xmath26 , @xmath83 , @xmath84 , with the maximum value of @xmath85 which is roughly @xmath86 times as large as the value given by eq .",
    "( [ eq : maxwigterm ] ) .    to avoid this problem",
    ", i first evaluated the r.h.s .  of eq .",
    "( [ eq : tcoefanal ] ) rigorously as rational numbers or square root of rational numbers by means of a formula - manipulation software maxima .",
    "numerical values to be used in programs coded in fortran , c , etc .",
    ", can be calculated from such rigorous numbers to the full precision of the 64-bit floating - point number .    however , the computation time turned out to be excessively long for large values of @xmath5 . to speed up the computation ,",
    "i have changed the method to evaluate eq .",
    "( [ eq : tcoefanal ] ) not rigorously but in terms of high - precision floating - point numbers ( of maxima ) .",
    "this does not seem to be a major drawback because numerical values are sufficient for most of practical purposes .",
    "i change the precision of floating - point numbers depending on @xmath5 in such a way that the number of digits equals the common logarithm of the value of eq .",
    "( [ eq : maxfsterm ] ) divided by @xmath87 .",
    "it increases with @xmath5 , reaching 74 digits for @xmath88 .",
    "precise 64-bit floating - point numbers can be obtained simply by truncating the high - precision results .",
    "empirically , the time necessary to compute all the coefficients @xmath89 for each @xmath5 increases as @xmath90 .",
    "the new method takes 43 h for @xmath88 with a personal computer with a cpu intel core - i7 3960x running at 3.3ghz , using one physical core .",
    "i use the obtained 64-bit floating - point number coefficients to evaluate the fourier - series formula for @xmath0 functions .",
    "i provide data files of the numerical values of the coefficients , together with a sample fortran90 program to read the data and calculate the values of the @xmath0 function , as supplemental material @xcite .    for each value of @xmath5",
    ", there are @xmath91 possible combinations of the values of @xmath8 and @xmath9 ( because @xmath92 , @xmath93 ) . only about a quarter of them are independent , however , because of the properties of the @xmath0 function expressed by eqs .",
    "( [ eq : mk_minus_km ] ) , ( [ eq : mk_km ] ) , and ( [ eq : mk_minus_mk ] ) in the appendix [ sec : dfunctionproerties ] .",
    "therefore , i consider only such combinations as @xmath94 and @xmath95 in the following analysis of the numerical precision .    in other words , the coefficients",
    "@xmath58 have the following symmetry , @xmath96 hence , the numerical data for @xmath58 in the supplemental material are given only for @xmath94 and @xmath95 .",
    "there are @xmath97 coefficients for @xmath98 .",
    "the size of the memory to store them as 64-bit floating - point numbers amounts to 27 ( 404 ) mib for @xmath99=50 ( 100 ) .",
    "my data are given as text files for the sake of compatibility , whose sizes are not very different from the above memory sizes after they are compressed ( with the software gzip ) .    the magnitude of the coefficient @xmath89 becomes smaller for larger values of @xmath5 .",
    "however , even at @xmath88 , 80% ( 90% ) of the coefficients are larger than @xmath100 ( @xmath101 ) .",
    "some of the coefficients vanish according to rules unmentioned so far .",
    "for example , @xmath102 if @xmath5 is an integer , @xmath103 and/or @xmath104 , and @xmath105 ( mod 2 )",
    ". one can prove this vanishment by using eq .",
    "( [ eq : pi_plus_theta ] ) .",
    "i do not use these additional rules but simply give zero values in the data files .",
    "the evaluations of @xmath106 and @xmath107 should be calculated by means of a recursion relation , @xmath108 which is nothing but the trigonometric ( angle ) addition theorem . for integer @xmath5 ,",
    "the initial values are @xmath109 and @xmath110 . for half integer @xmath5 , one has to calculate , first , the initial values @xmath111 and @xmath112 and , second , @xmath113 and @xmath114 using identities @xmath115 and @xmath116 .",
    "maximum and root - mean - square errors in the values of @xmath54 and @xmath55 , numerically calculated with 64-bit floating - point numbers , over @xmath117 .",
    "the values of @xmath3 are sampled with a uniform spacing of @xmath100 degree .",
    "the abscissa is @xmath118 .",
    "recursion means the usage of eq .",
    "( [ eq : cossinnutheta ] ) together with the initial values described in the following sentences . ]",
    "straightforward evaluation of @xmath106 and @xmath119 ( i.e. , passing the value of @xmath120 to the internal functions cos and sin ) requires about @xmath5 calls to the functions and is computationally very inefficient .",
    "moreover , as shown in fig .",
    "[ fig : sin_cos_n_theta ] , such straightforward evaluation causes slightly larger numerical errors probably due to the loss of significant digits in reducing the value of @xmath121 to an interval such as @xmath122 $ ] , especially when the value of @xmath123 is large .",
    "the reason why the recursion formula ( [ eq : cossinnutheta ] ) does not suffer from large errors even after hundred steps may be attributed to the fact that the magnitudes of cos and sin functions are always not greater than one .",
    "the common logarithm of the error in the 64-bit floating - point numerical value of the @xmath0 function @xmath14 as a function of @xmath8 and @xmath9 for @xmath124 and @xmath125 .",
    "the value of the @xmath0 function is calculated by means of the wigner formula in part ( a ) and the fourier series expression in part ( b ) .",
    "only a quarter of the possible combinations of @xmath8 and @xmath9 are plotted because the error is symmetric in the lines @xmath126 .",
    "errors smaller than @xmath127 are painted with the same color as that for the error of @xmath127 . ]    in this section , i compare the errors of the values of @xmath14 calculated with 64-bit floating - point numbers according to the wigner formula ( [ eq : wigner_formula ] ) and the fourier series expression ( [ eq : dfuncfourierseries ] ) .",
    "the errors have been calculated as the differences from the exact values calculated by applying a formula - manipulation software maxima to the wigner formula .     the same as in fig .",
    "[ fig : km_j40_t30 ] but for @xmath128 . ]    figures  [ fig : km_j40_t30 ] ,  [ fig : km_j40_t60 ] , and [ fig : km_j40_t90 ] show the errors for @xmath129 , @xmath130 , and @xmath131 , respectively .",
    "the errors are expressed as a function of @xmath132 while @xmath5 is fixed at 40 .",
    "i have found that similar plots for @xmath133 look almost indistinguishable from those for @xmath134 except that the sign of @xmath9 is reversed , as could be foreseen from eq .",
    "( [ eq : pi_minus_theta ] ) .     the same as in fig .",
    "[ fig : km_j40_t30 ] but for @xmath135 . ]",
    "one can see that the wigner formula results in very large errors , up to @xmath136 for @xmath137 and @xmath138 , while the fourier series expression gives precisely 15 digits irrespective of the values of @xmath3 , @xmath5 , @xmath8 , and @xmath9 .",
    "i confidently recommend the fourier series expression over the winger formula already at @xmath139 .    for a special purpose",
    ", however , the wigner formula still has an advantage . for regions of the arguments @xmath140 ( @xmath141 ) and @xmath142 ( @xmath143 ) , the wigner formula has smaller errors than @xmath144 , i.e. , than the level of the almost constant error of the fourier series expression . in such regions of the arguments ,",
    "the magnitude of @xmath14 is very small and a small number of terms dominate in the summation of the wigner formula , while many terms of order 1 cancel among themselves to give the small value in the fourier series expression .",
    "therefore , if one needs such high precision at those regions , it would be a good idea to develop a program which switches between the two formulas depending on the values of @xmath3 , @xmath5 , @xmath8 , and , @xmath9 .",
    "the common logarithm of the maximum error in the numerical value of the @xmath0 function @xmath14 versus @xmath5 calculated with the wigner formula ( blue solid line ) and the fourier series expression ( red dashed line ) .",
    "the maximum is taken over the values of @xmath8 , @xmath9 , and @xmath3 for each @xmath5 . ]    in fig .",
    "[ fig : maxerr_vs_j ] , i compare the maximum errors of @xmath14 as functions of @xmath5 .",
    "the maximum is taken over the values of @xmath3 from @xmath145 to @xmath146 with an increment of @xmath147 and all possible combinations of @xmath8 and @xmath9 . for both formulas , the maximum error increases as exponential functions of @xmath5 .",
    "the wigner formula increases its error , however , far faster than the fourier series expression . for the interval @xmath148 , the error of the wigner formula can be approximated by @xmath149 while that of the fourier series expression can be approximated by @xmath150 .",
    "in other words , by increasing @xmath5 by one , the error of the wigner formula is doubled , while that of the fourier series expression increases only by 1.4% .",
    "i have shown that the wigner formula for the @xmath0 function results in intolerable large numerical errors for large values of the angular momentum quantum number @xmath5 . on the other hand , the fourier series expression for the @xmath0 function",
    "is shown to be free of such errors , providing precision of @xmath151 even at @xmath88 .",
    "an analytic expression for the coefficients of the fourier series is given .",
    "their numerical values , which are precise as far as 64-bit floating - point numbers can express , are provided as electric files in supplemental material .",
    "sample programs in fortran90 to use the data files are also provided .",
    "i enumerate the symmetries of the @xmath0 function to be referred to in this paper .",
    "first , the unitarity of rotations ( i.e , the hermite conjugate operator is the inverse operator ) means @xmath152 second , the composition of two rotations can be rewritten as multiplication of matrices to represent them , @xmath153 i need three more relations , whose easiest derivation may be to use the wigner formula ( [ eq : wigner_formula ] ) as in ref .",
    "@xcite , @xmath154 from eqs .",
    "( [ eq : unitarity ] ) and ( [ eq : mk_km_minus_t ] ) , one can prove @xmath155 from eqs .",
    "( [ eq : mk_minus_km ] ) and ( [ eq : mk_km ] ) , @xmath156 and from eqs .",
    "( [ eq : composition ] ) , ( [ eq : pi_rotation ] ) , and ( [ eq : mk_km ] ) , @xmath157 @xmath158    7ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop _ _  ( ,  ,  ) @noop _ _  ( ,  ,  ) http://stacks.iop.org/1742-6596/445/i=1/a=012014 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevc.84.064316 [ * * ,   ( ) ] link:\\doibase    10.1063/1.480229 [ * * ,   ( ) ] link:\\doibase 10.1063/1.2194548 [ * * , ( ) ] see supplemental material at http://link.aps.org/ + supplemental/10.1103/physrevc.91.014320 for the numerical values of the coefficients of the fourier series of the @xmath0 functions and sample programs to use the data ."
  ],
  "abstract_text": [
    "<S> the wigner @xmath0 function , which is the essential part of an irreducible representation of su(2 ) and so(3 ) parameterized with euler angles , has been know to suffer from a serious numerical errors at high spins , if it is calculated by means of the wigner formula as a polynomial of cos and sin of half of the second euler angle . </S>",
    "<S> this paper shows a way to avoid this problem by expressing the @xmath0 functions as the fourier series of the half angle . </S>",
    "<S> a precise numerical table of the coefficients of the series is provided as supplemental material . </S>"
  ]
}