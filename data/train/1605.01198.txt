{
  "article_text": [
    "model - checking is one of the core algorithmic problems in finite model theory : given a sentence @xmath1 in some logic @xmath2 and a finite structure @xmath3 , decide whether @xmath4 .",
    "the problem can be generalised by allowing @xmath1 to have free variables , in which case we would like to find instances @xmath5 for which @xmath6 $ ] , or count the number of such instances .",
    "one important application of this is the case where @xmath1 is a database query and @xmath3 the datebase to be queried .",
    "the logic @xmath2 from which @xmath1 is drawn then serves as an abstract model of the database query language .",
    "commonly studied logics @xmath2 include first - order logic ( @xmath0 ) and monadic second - order logic ( @xmath7 ) . even for first - order logic the model - checking problem is pspace complete already when restricted to structures @xmath3 with two elements . on the other hand , for every fixed @xmath0-formula @xmath1 , checking whether @xmath4 can be done in time polynomial in the size of @xmath3 .",
    "this discrepancy between the _ query complexity _ , i.e. the complexity depending on the size of the query @xmath1 on the one hand and the _ data complexity _",
    ", i.e. the complexity depending on the size of the structure @xmath3 , on the other hand suggests that the complexity of model - checking problems is best studied in the framework of _ parameterised complexity _  @xcite",
    ".    in parameterised complexity , apart from the size @xmath8 of the input problem ( commonly the length of an appropriate binary representation of @xmath1 and @xmath3 ) a _ parameter _",
    "@xmath9 is introduced . for model - checking problems",
    "the size of the input formula is a common choice of parameter .",
    "the role of ptime as the class of problems commonly considered to be tractable is played by the parameterised complexity class of _ fixed - parameter tractable ( fpt ) _ problems , i.e. problems which can be solved in time @xmath10 for some computable function @xmath11 and a constant @xmath12 .",
    "note that the constant @xmath12 must not depend on @xmath9 , and indeed the model - checking problem for first - order logic is unlikely to be fixed - parameter tractable .    in order to obtain tractable instances of model - checking problems",
    ", one can restrict the space of admissible input structures @xmath3 , e.g. by requiring the gaifman graph of @xmath3 to possess certain graph theoretic properties such as bounded degree or planarity . a long list of results",
    "have been obtained , starting with courcelle s famous result that model - checking for monadic second - order logic is fixed - parameter tractable on structures @xmath3 with bounded tree - width  @xcite .",
    "results of this form are often referred to as _",
    "algorithmic meta - theorems _ because many classical problems can be rephrased as model - checking problems by formalising them as a sentence @xmath1 in a suitable logic .",
    "for example , since the existence of a hamiltonian cycle in a graph @xmath13 of bounded tree - width can be expressed by a sentence @xmath1 of monadic second - order logic , courcelle s theorem immediately implies that hamiltonicity can be checked in polynomial time on such graphs . besides giving a mere proof of tractability , algorithmic",
    "meta - theorems provide a unified treatment of how structural properties can be used in algorithm design .",
    "@xcite and @xcite for excellent surveys of the field of algorithmic meta - theorems .",
    "the model - checking problem for first - order logic is particularly well studied and has been shown to be fixed - parameter tractable on a large number of graph classes : starting with seese s result  @xcite for graphs of bounded degree , frick and grohe showed tractability on classes of graphs with bounded tree - width and , more generally , locally bounded tree - width  @xcite , which in particular includes planar graphs .",
    "this has been generalised to graph classes with excluded minors  @xcite and locally excluded minors  @xcite . using rather different techniques , dvov rk et al .",
    "gave a linear fpt model - checking algorithm for first - order logic on graphs of bounded expansion  @xcite .",
    "as a generalisation of all the graph classes mentioned so far , grohe et al . have shown in  @xcite that model - checking for first - order logic is possible in near - linear fpt on all nowhere dense graph classes .",
    "while the tractability of model - checking for first - order logic on sparse graphs is well understood , few results are available for classes of dense graphs .",
    "recently , gajarsk et al . gave an fpt algorithm for @xmath14 model - checking on posets of bounded width , which we extend to order - invariant @xmath0 in section  [ sec : dense ] .",
    "a more general concept than that of a class of graphs excluding some graph @xmath15 as a minor is that of graphs which exclude @xmath15 as a _",
    "topological subgraph_. this is the concept originally used by kuratowski in his famous result that a graph is planar if , and only if , it does not contain @xmath16 nor @xmath17 as a topological subgraph ( cf .",
    "section 4.4 in  @xcite ) .",
    "recently , grohe and marx have extended robertson and seymour s graph structure theorem to classes of graphs excluding a fixed graph @xmath15 as a topological subgraph  @xcite : these graphs can be decomposed along small separators into parts which exclude @xmath15 as a minor and parts in which all but a bounded number of vertices have small degree .",
    "since every topological subgraph of a graph @xmath13 is also a minor of @xmath13 , if a class @xmath18 of graphs excludes some graph @xmath15 as a topological subgraph then it also excludes @xmath15 as a minor .",
    "the converse is not true , however , since every @xmath19-regular graph excludes @xmath16 as a topological subgraph , but for every @xmath20 there is a @xmath19-regular graph containing @xmath21 as a minor . on the other hand , graph classes with excluded topological subgraphs have bounded expansion , so",
    "model - checking for first - order logic is tractable on these classes by dvok et al.s result .",
    "figure  [ fig : sparseclasses ] shows an overview of sparse graph classes on which model - checking for first - order logic is tractable .",
    "note that a class @xmath18 of graphs excludes some finite graph @xmath15 as a topological subgraph if , and only if , there is an @xmath22 such that @xmath18 excludes the clique @xmath21 as a topological subgraph .",
    "we investigate the question in how far tractability results for first - order model - checking carry over to _ successor - invariant first - order logic _ ,",
    "i.e. first - order logic enriched by a binary successor relation , restricted to formulae whose truth value does not depend on the specific choice of successor relation .",
    "linear representations of an input structure @xmath3 to a model - checking algorithm usually induce some linear order on the elements of @xmath23 , and it seems natural to make this linear order ( or at least its successor relation ) accessible to the query formula .",
    "this may , however , break the structural properties of the gaifman graph of @xmath3 needed by the model - checking algorithm .    having access , even invariantly , to a successor relation provably increases the expressive power of @xmath0 on finite structures , as shown in  @xcite .",
    "however , all known classes of structures separating @xmath0 from order - invariant or successor - invariant @xmath0 contain large cliques , and in fact on trees  @xcite and on structures of bounded tree - depth  @xcite even order - invariant @xmath0 has the same expressive power as plain @xmath0 .",
    "on all the classes depicted in figure  [ fig : sparseclasses ] , this question is still open , prompting for tractability results for successor - invariant or even order - invariant @xmath0 on these classes .",
    "previous work investigating the complexity of model - checking for successor - invariant first - order logic to that of plain first - order logic has been carried out by @xcite , who showed tractibility on planar graphs , and @xcite , who showed tractability on graph classes with excluded minors .",
    "here we extend these results further by generalising from excluded minors to excluded topological subgraphs , further narrowing the gap between what is known for first - order logic and succesor - invariant first - order logic .",
    "note that for first - order logic , the result of @xcite is optimal if one restricts attention to classes of graphs which are closed under taking subgraphs .",
    "in fact , kreutzer has shown in  @xcite that under the complexity theoretic assumption that @xmath24 $ ] , if model - checking for @xmath0 on some subgraph - closed class @xmath18 of graphs is fixed - parameter tractable , then @xmath18 is nowhere dense ( see also  section  1.4 of  @xcite ) .",
    "examples of classes of graphs on which model - checking is fpt even for monadic second - order logic but which are not nowhere dense are graphs of bounded clique - width  @xcite .",
    "for a natural number @xmath8 we let @xmath25 $ ] denote the interval @xmath26 .",
    "we will be dealing with finite simple ( i.e. loop - free and without multiple edges ) graphs , cf .",
    "@xcite for an in - depth introduction .",
    "thus a _ graph _ @xmath27 consists of some finite set @xmath28 of _ vertices _ and a set @xmath29 of _ edges_. we write @xmath30 for @xmath31 . for a set @xmath32",
    "we denote the _ induced subgraph _ on @xmath33 by @xmath34 $ ] , i.e. the graph @xmath35 with @xmath36 for ease of notation we occasionally blur the distinction between a set @xmath33 of vertices and the subgraph induced on this set .",
    "the union @xmath37 of two graphs @xmath27 and @xmath38 is defined as the graph @xmath39 . for",
    "a set @xmath33 of vertices , @xmath40 $ ] denotes the complete graph ( or _ clique _ ) with vertex set @xmath33 . for @xmath41 ,",
    "we denote the @xmath9-clique @xmath42 $ ] by @xmath43 .",
    "a _ walk _ is a sequence of vertices @xmath44 , alternatively written as a function @xmath45 \\to v$ ] , such that @xmath46 for all @xmath47 .",
    "a _ path _ is a walk in which @xmath48 for @xmath49 , except possibly @xmath50 , in which case the path is called a _",
    "cycle_. the vertices @xmath51 are called _",
    "inner vertices_. two paths @xmath52 and @xmath53 are called _ independent _ if neither of them contains an inner vertex of the other , i.e. if @xmath54 implies @xmath55 and @xmath56 .    for @xmath57 , a _",
    "@xmath9-walk through _ a graph @xmath27 is a walk @xmath58 \\to v$ ] such that @xmath59 { \\mathbin |}w(i ) = v \\ }   \\right\\vert } \\leq k\\ ] ] for all @xmath60 .",
    "a @xmath61-walk is also called a _",
    "hamiltonian path_.      a _ tree _ is a connected acyclic graph .",
    "tree - decomposition _ of a graph @xmath27 is a pair @xmath62 consisting of a tree @xmath63 and a mapping @xmath64 such that    * @xmath65 , * for every edge @xmath30 there is a @xmath66 with @xmath67 , and * for every @xmath60 the set @xmath68 is a subtree of @xmath69 ( i.e. it is connected ) .",
    "the sets @xmath70 are called the _ bags _ of the tree - decomposition .",
    "let @xmath71 have neighbours @xmath72 .",
    "the _ torso _",
    "@xmath73 of @xmath70 is the graph @xmath74 \\cup \\bigcup_{u \\in { \\mathcal{n}}(t ) } k[{\\mathcal{v}}_t \\cap { \\mathcal{v}}_u].\\ ] ]    rather than decomposing a graph @xmath13 into small parts we are interested in decompositions @xmath62 for which ( the torsos of ) all bags @xmath70 have nice structural properties and for which @xmath75 is small for all @xmath76 .",
    "( maximal ) adhesion _ of @xmath62 is the maximum of @xmath77 for all @xmath78 .",
    "let @xmath27 and @xmath79 be graphs .",
    "if @xmath80 and @xmath81 then we call @xmath15 a _ subgraph _ of @xmath13 and write @xmath82 . in other words , @xmath15 can be obtained from @xmath13 be removing vertices and edges .",
    "we say that @xmath15 is a _",
    "minor _ of @xmath13 , written @xmath83 , if there are disjoint connected nonempty subgraphs @xmath84 in @xmath13 such that for every edge @xmath85 there is an edge @xmath86 for some @xmath87 and @xmath88 .",
    "the sets @xmath84 are called _ branch sets _ of the minor @xmath15 .",
    "equivalently , @xmath89 if @xmath15 can be obtained by repeatedly contracting edges in a subgraph of @xmath13 .",
    "a graph @xmath90 is a _ subdivision _ of a graph @xmath15 if it can be obtained from @xmath15 be replacing edges with paths .",
    "if @xmath91 for some subdivision @xmath90 of @xmath15 we say that @xmath15 is a _ topological subgraph _ of @xmath13 and write @xmath92 . in this case",
    "there is an injective mapping @xmath93 and independent paths @xmath94 connecting @xmath95 to @xmath96 in @xmath13 for @xmath97 .",
    "the vertices in the image of @xmath98 are called _",
    "branch vertices_. obviously @xmath92 implies @xmath83 , but the converse is not in general true .",
    "we will be dealing with finite structures over finite , relational vocabularies .",
    "thus a _ vocabulary _",
    "@xmath99 is a finite set of relation symbols @xmath100 ,",
    "each with an associated _ arity _ @xmath101 , and a @xmath99-_structure _ @xmath3 consists of a finite set @xmath23 ( the _ universe _ ) and relations @xmath102 for all @xmath103 . for vocabularies @xmath104 and a @xmath99-structure @xmath3 , a @xmath105-_expansion _",
    "@xmath106 is a @xmath105-structure with @xmath107 and @xmath108 for all @xmath109 .",
    "the _ gaifman graph _ of a structure @xmath3 is the graph with vertex set @xmath23 and edge set @xmath110 when applying graph - theoretic notions such as planarity to relational structures , we mean that the corresponding gaifman graph has the said property .",
    "we use standard definitions for first - order logic ( fo ) , cf .  @xcite . in particular , @xmath111 and @xmath112 denote false and true , respectively .",
    "let @xmath99 be a vocabulary and @xmath113 a new binary relation symbol .",
    "we set @xmath114 and say that @xmath115 is interpreted by a _ successor relation _ in a @xmath116-structure @xmath106 if @xmath117 is the graph of a cyclic permutation on @xmath118 .",
    "an @xmath119$]-formula @xmath1 is called _ successor - invariant _ if for all @xmath99-structures @xmath3 and all @xmath116-expansions @xmath120 of @xmath3 in which @xmath115 is interpreted by a successor relation we have @xmath121 when all free variables of @xmath1 are interpreted identically in @xmath106 and @xmath122 . in this case",
    "we say that @xmath4 if @xmath123 for one such expansion @xmath106 ( equivalently for all such expansions ) .",
    "note that another common definition of successor relation is to require @xmath124 to be of the form @xmath125 for some enumeration @xmath126 of the elements of @xmath23 .",
    "this differs from our definition in that we require @xmath127 as well , eliminating the somewhat artificial status of the first and last element .",
    "the expressive power of successor - invariant fo is not affected by this , though the quantifier rank of formulas may change .",
    "order - invariant first - order logic is defined analogously to successor - invariant @xmath0 , by allowing the use of a binary relation @xmath128 which is interpreted as a linear order and demanding the truth value of a formula to be independent of the chosen linear order .",
    "the main result of this paper is the following :    [ thm : mainthm ] there is an algorithm @xmath129 with the following properties : let @xmath15 be a finite graph , @xmath99 a relational vocabulary , @xmath130 $ ] a successor - invariant formula , and @xmath3 a @xmath99-structure whose gaifman graph does not contain @xmath15 as a topological subgraph . then on input @xmath15 , @xmath3 and @xmath1 the algorithm @xmath129 checks whether @xmath131 in time @xmath132 for some computable function @xmath11 and @xmath133 .    note that model - checking for first - order logic on nowhere dense classes of graphs is possible in time @xmath134 for arbitrarily small @xmath135 by a result of grohe et al .  @xcite .",
    "even though a representation of a structure @xmath3 in computer memory is likely to induce a linear order on the elements of @xmath23 , making this linear order or its successor relation accessible to the formula @xmath1 potentially complicates the model - checking problem .",
    "in particular , adding the cycle corresponding to this linear order ( or any other cycle through the whole graph ) to @xmath3 may introduce new shallow minors .",
    "the proof of theorem  [ thm : mainthm ] is based on the following two lemmas :    [ lem : kwalktopsub ] for every finite graph @xmath15 there are constants @xmath136 and @xmath137 such that for every graph @xmath13 which does not contain @xmath15 as a topological subgraph there is a graph @xmath138 and a @xmath9-walk @xmath139 \\to v(g')$ ] through @xmath138 such that @xmath138 is obtained from @xmath13 by only adding edges and @xmath138 does not contain @xmath140 as a topological subgraph .",
    "furthermore , @xmath9 , @xmath12 , @xmath138 and @xmath141 can be computed , given @xmath13 and @xmath15 , in time @xmath142 for some computable function @xmath11 and @xmath143 .",
    "[ lem : succfromkwalk ] let @xmath99 be a finite relational vocabulary , @xmath3 a finite @xmath99-structure , and @xmath144 \\to v(a)$ ] a @xmath9-walk through the gaifman graph of @xmath3 .",
    "then there is a finite relational vocabulary @xmath145 and a first - order fomula @xmath146 , both depending only on @xmath9 , and a @xmath147-expansion @xmath148 of @xmath3 which can be computed from @xmath3 and @xmath141 in polynomial time , such that    * the gaifman - graphs of @xmath148 and @xmath3 are the same , * @xmath149 defines a successor relation on @xmath148 .",
    "lemma  [ lem : succfromkwalk ] is taken from  ( * ? ? ?",
    "* lemma  4.4 ) and has been proved there .",
    "we will prove lemma  [ lem : kwalktopsub ] in section  [ sec : kwalktopsub ] .",
    "the proof of theorem  [ thm : mainthm ] then is a combination of the above lemmas :    given a @xmath99-structure @xmath3 , a successor - invariant @xmath116-formula @xmath1 and a graph @xmath15 which is not a topological subgraph of the gaifman graph of @xmath3 , we first compute the gaifman graph @xmath13 of @xmath3 . using the algorithm of lemma  [ lem : kwalktopsub ]",
    "we then compute a @xmath9-walk @xmath58    \\to v(a)$ ] through a supergraph @xmath138 of @xmath13 which excludes some clique @xmath150 as a topological subgraph .",
    "let @xmath151 be a binary relation symbol .",
    "we expand @xmath3 to a @xmath152-structure @xmath148 by setting @xmath153 \\ } \\cup \\ {    ( w(\\ell),w(1 ) ) \\}.\\ ] ] then @xmath138 is the gaifman graph of @xmath148 , which by lemma  [ lem : kwalktopsub ] excludes @xmath140 as a topological subgraph .    using lemma  [ lem : succfromkwalk ] we compute , for a suitable @xmath154 , a @xmath105-expansion @xmath155 of @xmath148 and an @xmath156$]-formula @xmath157 which defines a successor relation on @xmath155 .",
    "we substitute @xmath157 for @xmath158 for all occurences of @xmath159 in @xmath1 , obtaining an @xmath156$]-formula @xmath160 such that @xmath161 where @xmath162 the successor relation defined by @xmath163 .",
    "note @xmath163 and @xmath105 depend only on @xmath15 .    since the gaifman graph @xmath164 of @xmath155 excludes @xmath15 as a topological subgraph",
    ", there is a class @xmath18 of graphs of bounded expansion such that @xmath165 .",
    "we can therefore use dvok et al.s model - checking algorithm for @xmath0 on @xmath18 to check whether @xmath166 in time linear in @xmath167 .",
    "in this section we will prove lemma  [ lem : kwalktopsub ] .",
    "given a graph @xmath13 which excludes a graph @xmath15 as a topological subgraph , as a first step towards constructing a supergraph @xmath138 with a @xmath9-walk we compute a tree - decomposition of @xmath13 into graphs which exclude @xmath15 as a minor and graphs of almost bounded degree :    [ thm : topminstructure ] for every @xmath136 there exists a constant @xmath168 such that the following holds : if @xmath15 is a a graph on @xmath9 vertices and @xmath13 a graph which does not contain @xmath15 as a topological subgraph , then there is a tree - decomposition @xmath62 of @xmath13 of adhesion at most @xmath12 such that for all @xmath71    * @xmath169 has at most @xmath12 vertices of degree larger than @xmath12 , _ or _ *",
    "@xmath169 excludes @xmath140 as a minor .",
    "furthermore , there is an algorithm that , given graphs @xmath13 of size @xmath8 and @xmath15 of size @xmath9 computes such a decomposition in time @xmath170 for some computable function @xmath171 .",
    "for the rest of this section we assume a graph @xmath27 together with a tree - decomposition @xmath62 satisfying the properties of theorem  [ thm : topminstructure ] as given .",
    "we will construct @xmath9-walks through each of the bags of this decomposition , for a suitable @xmath9 depending only on @xmath15 , suitably adding edges within the bags in a way that will not create large topological subgraphs .",
    "we will then connect these @xmath9-walks to obtain a @xmath172-walk through all of @xmath13 , carefully adding further edges where necessary .",
    "if @xmath173 are neighbours in @xmath69 we will connect the @xmath9-walk through @xmath174 and the @xmath9-walk through @xmath70 by joining them along a suitably chosen vertex @xmath175 . since the resulting walk may visit @xmath176 a total of @xmath177 times , we must be careful not to select the same vertex @xmath176 more than a bounded number of times .",
    "we first pick an arbitrary tree node @xmath178 as the root of the tree - decomposition .",
    "notions such as parent and sibling nodes are meant with respect to this root node @xmath179 . for a node @xmath71",
    "we define its adhesion @xmath180 as @xmath181 by adding the necessary edges within the bags we may assume that each @xmath70 is identical to its torso , in other words we may assume that @xmath182 $ ] is a clique for each @xmath71 .",
    "let @xmath173 be nodes such that @xmath184 is the parent of @xmath185 .",
    "it may happen that @xmath186 , and that in fact some vertex @xmath60 appears in an unbounded number of bags . since we are only allowed to visit each vertex a bounded number of times , we first compute , for @xmath71 , a @xmath9-walk @xmath183 through a suitable supergraph of @xmath187 .    if @xmath169 contains only @xmath12 vertices of degree larger than @xmath12 we choose an arbitrary enumeration @xmath52 of @xmath188 and add edges @xmath189 to @xmath13 .",
    "this will increase the degree of each vertex by at most @xmath190 , so there are still at most @xmath12 vertices of degree larger than @xmath191 .",
    "we set @xmath192 & \\to { \\mathcal{v}}_t \\\\ i & \\mapsto v_i \\end{split}\\ ] ] for these bags .",
    "if , on the other hand , @xmath169 exludes a clique @xmath140 as a minor , we invoke the following lemma on the graph @xmath193 :    [ lem : kwalkexcl ] for every natural number @xmath12 there are @xmath194 such that : if @xmath195 is a graph which does not contain a @xmath140-minor , then there is a supergraph @xmath196 obtained from @xmath13 by possibly adding edges such that @xmath138 does not contain a @xmath150-minor and there is a @xmath9-walk @xmath141 through @xmath138 .",
    "moreover , @xmath138 and @xmath141 can be found in polynomial time for fixed @xmath12 .",
    "since we ignore the vertices in @xmath197 when computing the @xmath9-walk @xmath183 , it may happen that the resulting supergraph of @xmath169 _ does _ contain a @xmath150-minor .",
    "however , the largest possible clique minor is still of bounded size , because @xmath198 :    let @xmath27 be a graph such that @xmath199 , and let @xmath200 be the graph with vertex set @xmath201 $ ] and edge set @xmath202}{2 } \\cup \\ { va { \\mathbin |}v \\in v , a \\in [ c ] \\}.\\ ] ] in other words , @xmath203 is the disjoint sum of @xmath13 and @xmath140 plus edges between all vertices of @xmath13 and all vertices of @xmath140 . then @xmath204 .    otherwise let @xmath205 be the branch sets of a @xmath206-minor in @xmath203 . at",
    "most @xmath12 of the sets contain vertices of the added @xmath140-clique .",
    "the remaining sets form the branch sets of a @xmath140-minor in @xmath13 , contradicting the assumption that @xmath207 .      we still need to connect the @xmath9-walks through the individual bags of @xmath62 to obtain a single @xmath172-walk through the whole graph , for some @xmath172 to be determined below .",
    "this is the most complicated part of our construction , since we must guarantee that no vertex is visited more than @xmath172 times by the resulting walk , and that no large topological subgraphs are created .    in the case of graphs excluding some fixed minor",
    ", the graph structure theorem guarantees the existence of a tree - decomposition into nearly embeddable graphs such that neighbouring bags intersect only in apices and vertices lying on some face or vortex of their near embeddings , and this was used in  @xcite to select vertices from the adhesion sets of bags in a suitable way . since the decomposition theorem for graphs excluding a topological minor does not provide this kind of information , we need a different approach here . our method for selecting vertices along which to connect the @xmath9-walks relies on the fact that sparse graphs are _ degenerate _",
    ", i.e. every subgraph of a sparse graph contains some vertex of small degree .    in connecting the walks @xmath183",
    ", we will proceed down the tree @xmath69 . at any point in the process",
    "we keep a set @xmath208 and a walk @xmath141 such that    * @xmath209 is a connected subset of @xmath69 , * the @xmath172-walk has been constructed in @xmath210 , * if @xmath211 and @xmath212 is a sibling of @xmath209 then also @xmath213 , * @xmath141 is a @xmath172-walk through @xmath210 , and if @xmath214 has a child @xmath215 , then the vertices in @xmath216 are visited at most @xmath177 times by @xmath141 .",
    "we start with @xmath217 and @xmath218 , where @xmath179 is the root of @xmath69 .",
    "this is easily seen to satisfy all of the above conditions .",
    "now let @xmath214 be a node whose children @xmath219 are not in @xmath209 .",
    "we let @xmath220 be the adhesion set of @xmath221 with all vertices of the adhesion set of @xmath185 removed .",
    "if @xmath222 then @xmath221 can be made a sibling of @xmath185 ( rather than a child ) , so we assume that all @xmath223 are nonempty .",
    "since the properties of @xmath62 are guaranteed for the torsos of the bags we may assume that @xmath224 $ ] is a clique for each @xmath225 and that @xmath141 visits the vertices of @xmath226 at most @xmath177 times .",
    "it may happen that @xmath227 for some @xmath49 . to deal with this ,",
    "assume that @xmath228 for each @xmath229 we choose an edge @xmath230 which is traversed by the walk @xmath231 in the direction from @xmath232 to @xmath233 at some point . we add edges @xmath234 and connect the walks @xmath235 along these edges . because @xmath231 is a walk through @xmath236 , we have @xmath237 for @xmath238 . to accomodate for the extra edges ,",
    "we add the vertices @xmath232 and @xmath233 to @xmath70 , and therefore to @xmath239 and @xmath223 .",
    "since these vertices together with the added edges form an isolated cycle @xmath240 in @xmath70 , no new topological subgraphs are created by this .",
    "the maximal adhesion of @xmath62 is still bounded by @xmath191 .",
    "therefore we now assume that the cliques @xmath241 are all distinct .",
    "it remains to find a function @xmath242 \\to v\\ ] ] such that    * @xmath243 for all @xmath225 , and * @xmath244 for all @xmath60 and some constant @xmath245 depending only on @xmath15 .",
    "we define the function @xmath11 iteratively on larger subsets of @xmath25 $ ] as follows : let @xmath246 be the subgraph of @xmath13 induced on the union of all @xmath223 : @xmath247.\\ ] ] we show that @xmath246 contains a vertex of degree ( in @xmath246 ) at most @xmath248 , for some constant @xmath248 depending only on the constant @xmath12 from theorem  [ thm : topminstructure ] ( and therefore only on the excluded topological subgraph @xmath15 we started with ) .",
    "if @xmath70 contains only @xmath12 vertices of degree larger than @xmath12 then this is true with @xmath249 . if @xmath70 excludes some clique @xmath140 as a minor we use the fact that these graphs are @xmath248-degenerate for some @xmath248 depending only on @xmath12",
    "in fact , by theorem  7.2.1 in @xcite there is a constant @xmath248 such that if the average degree of @xmath246 is at least @xmath248 , then @xmath250 and therefore @xmath251 .    in both cases there",
    "is a @xmath252 which has degree at most @xmath248 in @xmath246 .",
    "but any such @xmath176 can only be in at most @xmath253 of the cliques @xmath223 , which all satisfy @xmath254 .",
    "it is therefore safe to define @xmath255\\text { such that } v \\in c_i.\\ ] ] we remove these cliques and iterate until no cliques remain .",
    "once the function @xmath11 has been found we connect the walk @xmath183 through @xmath70 with the walks @xmath231 through the bags @xmath256 .",
    "let @xmath257 \\to v$ ] be the walk constructed so far . for",
    "each @xmath258 $ ] let @xmath259 be the vertex chosen by @xmath11 , and let @xmath260 be a neighbour of @xmath233 .",
    "if no such neighbour exists it is safe to create one by adding an edge between @xmath233 and an arbitrary vertex of @xmath236 .",
    "we now extend the walk @xmath141 by inserting the @xmath9-walk @xmath231 along the edge @xmath261 when @xmath233 is first visited by @xmath141 .",
    "this increases the number of times @xmath233 and @xmath232 are visited by one each ( cf .",
    "figure  [ fig : connect ] ) .    after inserting all walks @xmath262 we set @xmath263 and repeat the process until @xmath264 .",
    "note that the resulting walk is a @xmath265-walk through the supergraph @xmath138 of @xmath13 obtained by adding edges to @xmath13 .",
    "by now we have a supergraph @xmath138 of @xmath13 , obtained by only adding edges , and a @xmath266-walk @xmath58 \\to v(g')$ ] through this supergraph .",
    "furthermore , there is a @xmath267 depending only on ( the size of ) @xmath15 and a tree - decomposition @xmath62 of @xmath138 such that if @xmath173 then @xmath268 and for all @xmath71    * @xmath169 has at most @xmath269 vertices of degree larger than @xmath269 or * @xmath169 excludes @xmath150 as a minor .",
    "we show that this implies @xmath270 : assume for a contradiction that @xmath271 , and let @xmath272 be the branch vertices of a @xmath273-subdivision in @xmath13 .",
    "then there is a @xmath71 such that @xmath274 : otherwise choose @xmath275 and @xmath276 so that @xmath277 then , since the adhesion of @xmath62 is at most @xmath269 , there is a set @xmath278 of size at most @xmath269 separating two branch vertices , which is not possible in a @xmath279-clique .",
    "now let @xmath71 be a tree node for which @xmath70 contains all branch vertices .",
    "for @xmath275 , let @xmath280 be the path in @xmath13 connecting @xmath233 and @xmath281 .",
    "if all vertices on this path are in @xmath70 we are done .",
    "otherwise we may shorten this path to get a path @xmath282 connecting @xmath233 and @xmath281 in the torso of @xmath70 .",
    "thus @xmath283    but none of the bags @xmath70 can contain @xmath273 as a topological subgraph : since @xmath284 implies @xmath285 which in turn implies @xmath286 , none of the bags excluding @xmath150 as a minor can contain @xmath273 as a topological subgraph .",
    "but if @xmath284 then there must be at least @xmath287 vertices of degree at least @xmath288 , namely the branch vertices of the image of a subdivision of @xmath273 .",
    "we conclude that @xmath289 .",
    "while model - checking for first - order logic has been studied rather thoroughly for sparse graph classes , few results are known for dense graphs :    * on classes of graphs with bounded clique - width ( or , equivalently , bounded rank - width ; cf .",
    "@xcite ) , model - checking even for monadic second - order logic has been shown to be fpt by courcelle et al",
    ".  @xcite . *",
    "more recently , model - checking on coloured posets of bounded width has been shown to be in fpt for existential @xmath0 by bova et al .",
    "@xcite and for all of @xmath0 by gajarsk et al .",
    "@xcite .    both of these results extend to order - invariant @xmath0 , and therefore also to successor - invariant @xmath0 . for bounded clique - width ,",
    "this has already been shown by engelmann et al . in  (",
    "4.2 ) . for posets of bounded width",
    "we give a proof here .",
    "we first review the necessary definitions :    a _ partially ordered set ( poset ) _",
    "@xmath290 is a set @xmath291 with a reflexive , transitive and antisymmetric binary relation @xmath292 .",
    "a _ chain _",
    "@xmath293 is a totally ordered subset , i.e. for all @xmath294 one of @xmath295 and @xmath296 holds . an _",
    "antichain _ is a set @xmath297 such that if @xmath295 for @xmath298 then @xmath299 .",
    "the _ width _ of @xmath290 is the maximal size @xmath300 of an antichain @xmath301 .",
    "a _ coloured _ poset is a poset @xmath290 together with a function @xmath302 mapping @xmath291 to some set @xmath303 of _ colours_. by @xmath304 we denote the length of a suitable encoding of @xmath290",
    ".    we will need dilworth s theorem , which relates the width of a poset to the minimum number of chains needed to cover the poset :    let @xmath290 be a poset .",
    "then the width of @xmath290 is equal to the minimum number @xmath9 of disjoint chains @xmath305 needed to cover @xmath291 , i.e. such that @xmath306 .",
    "a proof can be found in  ( * ? ? ?",
    "2.5 ) . moreover , by a result of felsner et al .",
    "@xcite , both the width @xmath141 and a set of chains @xmath307 covering @xmath291 can be computed from @xmath308 in time @xmath309 .    with this",
    ", we are ready to prove the following :    there is an algorithm which , on input a coloured poset @xmath290 with colouring @xmath302 and an order - invariant first - order formula @xmath1 , checks whether @xmath310 in time @xmath311 where @xmath141 is the width of @xmath290 .    using the algorithm of  @xcite , we compute a chain cover @xmath307 of @xmath290 . to obtain a linear order on @xmath291",
    ", we just need to arrange the chains in a suitable order , which can be done by colouring the vertices with colours @xmath312 $ ] via @xmath313 then @xmath314 } } \\lambda'(x )    = ( \\lambda_x , i )    \\wedge    \\lambda'(y ) = ( \\lambda_y , i )    \\wedge    x \\leq y    \\bigg )    \\end{gathered}\\ ] ] defines a linear order on @xmath308 with colouring @xmath315 .",
    "after substituting @xmath316 for @xmath128 in @xmath1 we may apply gajarsk et al.s algorithm to check whether @xmath310 .",
    "we have shown that model - checking for successor - invariant first - order logic is fixed - parameter tractable on classes of graphs excluding some fixed graph @xmath15 as a topological subgraph .",
    "this extends previous results showing tractibility on planar graphs  @xcite and graphs with excluded minors  @xcite . for dense graphs",
    ", we showed how the recent model - checking algorithm by gajarsk et al .",
    "@xcite can be adapted to order - invariant @xmath0 .",
    "this prompts for further generalisation in two ways : first , can we close the gap between plain first - order logic and its successor - invariant counterpart ? next steps could be graph classes with bounded expansion or with locally excluded minors . however , no structure theorem comparable to those of robertson and seymour and of grohe and marx are known for these graph classes .",
    "another interesting open question is whether model - checking for order - invariant first - order logic is tractable on any of the classes depicted in figure  [ fig : sparseclasses ] . since the gaifman graph of a linearly ordered structure is a clique ,",
    "there is no hope of finding a `` good '' linear order which can be added to the input structure without destroying the desirable properties of its gaifman graph .",
    "as shown in  @xcite , order - invariant first - order logic has a gaifman - style locality property ( see also  @xcite ) .",
    "it is , however , not at all clear how this could be turned into an efficient model - checking algorithm . in particular , no variant of gaifman normal form is known for this logic .",
    "kord eickmeyer , michael elberfeld , and frederik harwath . expressivity and succinctness of order - invariant logics on depth - bounded structures . in _",
    "mathematical foundations of computer science 2014 - 39th international symposium , mfcs 2014 , budapest , hungary , august 25 - 29 , 2014 . proceedings , part i _ , pages 256266 , 2014 .",
    "kord eickmeyer , ken - ichi kawarabayashi , and stephan kreutzer .",
    "model checking for successor - invariant first - order logic on minor - closed graph classes . in _ proceedings of the 2013 28th annual acm / ieee symposium on logic in computer science _ , lics 13 , pages 134142 .",
    "ieee computer society , 2013 .",
    "jakub gajarsk , petr hlinn , daniel lokshtanov , jan obdrlek , sebastian ordyniak , ms  ramanujan , and saket saurabh .",
    "fo model checking on posets of bounded width . in _ foundations of computer science ( focs ) , 2015 ieee 56th annual symposium on _ , pages 963974 .",
    "ieee , 2015 .",
    "martin grohe , stephan kreutzer , and sebastian siebertz .",
    "deciding first - order properties of nowhere dense graphs . in _ proceedings of the 46th annual acm symposium on theory of computing _",
    ", stoc 14 , pages 8998 .",
    "acm , 2014 .",
    "stephan kreutzer .",
    "algorithmic meta - theorems . in javier esparza ,",
    "christian michaux , and charles steinhorn , editors , _ finite and algorithmic model theory _ , london mathematical society lecture note series , chapter  5 , pages 177270 .",
    "cambridge university press , 2011 .",
    "a preliminary version is available at electronic colloquium on computational complexity ( eccc ) , tr09 - 147 , http://www.eccc.uni-trier.de/report/2009/147 ."
  ],
  "abstract_text": [
    "<S> we show that the model - checking problem for successor - invariant first - order logic is fixed - parameter tractable on graphs with excluded topological subgraphs when parameterised by both the size of the input formula and the size of the exluded topological subgraph . </S>",
    "<S> furthermore , we show that model - checking for order - invariant first - order logic is tractable on coloured posets of bounded width , parameterised by both the size of the input formula and the width of the poset .    results of this form , i.e. showing that model - checking for a certain logic is tractable on a certain class of structures , are often referred to as algorithmic meta - theorems since they give a unified proof for the tractability of a whole range of problems . </S>",
    "<S> first - order logic is arguably one of the most important logics in this context since it is powerful enough to express many computational problems ( e.g. the existence of cliques , dominating sets etc . ) and yet its model - checking problem is tractable on rich classes of graphs . </S>",
    "<S> in fact , grohe et al .  </S>",
    "<S> @xcite have shown that model - checking for @xmath0 is tractable on all nowhere dense classes of graphs .    </S>",
    "<S> successor - invariant @xmath0 is a semantic extension of @xmath0 by allowing the use of an additional binary relation which is interpreted as a directed hamiltonian cycle , restricted to formulae whose truth value does not depend on the specific choice of a hamiltonian cycle . while this is very natural in the context of model - checking ( after all , storing a structure in computer memory usually brings with it a linear order on the structure ) , the question of how the computational complexity of the model - checking problem for this richer logic compares to that of plain @xmath0 is still open .    </S>",
    "<S> our result for successor - invariant @xmath0 extends previous results for this logic on planar graphs @xcite and graphs with excluded minors @xcite , further narrowing the gap between what is known for @xmath0 and what is known for successor - invariant @xmath0 . </S>",
    "<S> the proof uses grohe and marx s structure theorem for graphs with excluded topological subgraphs @xcite . for order - invariant @xmath0 </S>",
    "<S> we show that gajarsk et al.s recent result for @xmath0 carries over to order - invariant @xmath0 .    = * * * * * * </S>"
  ]
}