{
  "article_text": [
    "the detection and characterization of astronomical sources becomes increasingly difficult as we attempt to observe these sources in the euv , x - ray , and gamma - ray spectral regimes .",
    "there are several reasons for this .",
    "first , in these high - energy regimes , source data may consist of only a few counts , so that we must rely on the poisson distribution when making statistical inferences rather than using gaussian statistics that are considerably easier to apply , but that are strictly applicable only in the high - counts limit .",
    "second , spatially extended sources , such as supernova remnants and galaxy clusters , exhibit bright diffuse emission at high energies which may overlap with point sources , rendering the latter more difficult both to detect and characterize . and third , the present generation of broad - band high - energy telescopes , unlike optical telescopes , have spatially non - uniform point spread functions ( psfs ) as an unavoidable by - product of their design .",
    "for instance , the psf of the wolter i - type high resolution mirror assembly ( hrma ) on the _ chandra x - ray observatory _",
    "( cxo ) has a 50% encircled energy radius that varies in width from @xmath0 0.3@xmath1 on - axis to @xmath2 10@xmath1 near the outer edges of an acis - i chip ( @xmath0 10@xmath3 off - axis ) .    a standard method for the analysis of poisson count data involves the application of the so - called `` sliding cell '' ( harnden et al .  1984 )",
    ". in sliding - cell analysis , two co - aligned but differently sized square cells are placed at each image pixel , with the number of counts in the annular region between cells providing an estimate of the local background amplitude at the pixel .",
    "this amplitude is then used to compute the poisson significance of the observed number of counts in the inner cell .",
    "the usefulness of a sliding - cell algorithm is limited both when the field - of - view ( fov ) is crowded , since overlapping sources can not be handled and/or nearby sources contributing counts to the estimated background may decrease detection sensitivity , and when sources are observed off - axis , since uncertainties in the model of the psf , which generally increase with off - axis angle , can greatly affect source property estimates ( see , e.g. , kashyap et al .",
    ". the sliding cell also may not provide accurate source property estimates for extended sources .",
    "source characterization can be improved by fitting the detected sources using maximum likelihood methods ( as in the algorithm of hasinger , johnston , & verbunt  1994 ) , but the accuracy of this method is still limited by uncertainties in the psf .    within the last decade , astronomers have begun to apply wavelet functions to the problem of source detection .",
    "( for an introduction to the theory of wavelet functions , see , e.g. , mallat 1998 and references therein . ) these functions are scaleable , oscillatory , have a finite support ( i.e. , are non - zero within a limited spatial regime ) , and have an average value of zero ; they can be used to define a set of basis functions that act as highly localized filters in both the spatial and frequency domains , and thus are superior source characterizers .",
    "certain wavelet functions also exhibit the property of vanishing moments , which is important for source detection : the integral of the product of a wavelet with @xmath4 vanishing moments and a polynomial of degree @xmath5 is zero .",
    "thus the correlation of a suitably chosen wavelet function with a photon counts image will yield correlation coefficients which are significantly large only in the vicinity of localized high - order variations in the data , e.g.  in the vicinity of astronomical sources , which appear as psf - broadened bumps with infinite power - series representation .",
    "wavelet - based source detection thus boils down to the statistical problem of identifying image pixels with  significantly large \" correlation coefficients .",
    "damiani et al .",
    "( 1997a ) were the first to present a wavelet - based generalized method for source detection and characterization , which they apply to _ rosat _ pspc data in a subsequent work ( damiani et al .",
    "1997b ) . among its features , this method , unlike the others , uses exposure maps to handle situations in which , e.g. , support rib shadows or the edge of the fov lie within the wavelet support , allowing the analysis of the entire fov .",
    "their algorithm is , however , instrument - dependent in that they must make significant changes to it in order to account for qualitative differences between exposure maps of different detectors ( e.g.  between the exposure maps of the _ rosat _ pspc and _ rosat _ hri ; micela et al .",
    "1999 , provide a short description of the changes that are necessary to perform hri image analysis ) .",
    "in addition , while one can apply the damiani et al .  method to data from other photon - counting detectors , the psfs must be very nearly gaussian .",
    "last , they publish a function for the computation of source detection thresholds which is strictly valid only when the mean background amplitude per image pixel is @xmath6 , where @xmath7 is the wavelet scale size .    in this paper ( and in freeman",
    "et al .  2001 ) we describe our own algorithm for wavelet source detection and characterization that has been developed for a generic detector and implemented in the _ chandra interactive analysis of observations ( ciao ) _ routine wavdetect . in subsequent papers ( e.g.  kashyap et al .",
    "2001 , in preparation ) we will discuss the application of this algorithm to specific scientific problems .",
    "our algorithm is considerably more general and flexible than others that have been developed , in that it can : ( 1 ) operate effectively in the low background counts regime , which is crucial because of the expected low particle and cosmic background count rates for the _ chandra _ detectors ( the overall rate being @xmath8 10@xmath9 and 10@xmath10 ct sec@xmath11 pix@xmath11 for the _ chandra _ acis and hrc detectors , respectively ) ; and ( 2 ) operate effectively regardless of the psf _ shape _ , also crucial because of the ( non - gaussian ) nature of the off - axis _ chandra _ psfs .",
    "it also ( 3 ) corrects for the effect of exposure variations in a general , non - detector - specific manner .",
    "thus our algorithm may be immediately adapted for the analysis of data from virtually any other photon - counting detector .",
    "in  [ sect : wave ] , we provide a brief description of wavelet functions , and define the marr , or ",
    "mexican hat \" ( mh ) wavelet function which we use in our algorithm .",
    "we then present a simple example in which we apply the mh function to idealized data , in order to build the reader s intuition about how to interpret the results .",
    "the mh function has been used often in astronomical wavelet analyses , in for example : the analysis of @xmath12co spectral maps of the molecular cloud l1551 ( gill & henrikson 1990 ; see also langer , wilson , & anderson 1993 , who apply laplacian pyramid transforms to a @xmath12co image map of barnard 5 ) ; the analysis of galaxy cluster structure in optically derived catalogs ( slezak , bijaoui , & mars 1990 ) ; the detection and localization of features in optical ccd images of galaxies ( coupinot et al .  1992 ) ; the analysis of substructures observed in _ rosat _ pspc images of the coma cluster ( vikhlinin , forman , & jones 1994 ) ; the examination of _ einstein _ hri and _ rosat _ pspc images of abell 1367 ( grebenev et al .",
    "1995 ) ; the detection of serendipitous x - ray clusters in archival _ rosat _ pspc data ( sharc ; cf .",
    "ulmer et al .",
    "1995 , freeman et al .",
    "1996 , nichol et al .  1997 ) ; and the analysis and modeling of x - ray emission in abell clusters ( lazzati & chincarini 1998 ; see also lazzati et al .  1998 ) and stellar clusters ( damiani et al .",
    "1997b ) .",
    "in  [ sect : alg ] we describe the basic steps of our algorithm , in which sources are detected and characterized .",
    "the basic steps of _ source detection _ include : the correlation of the wavelet function with the data to create the correlation image ; the estimation of the local background ( if necessary ) in each pixel ; the computation of the source detection threshold in each pixel ; accounting for the effects of exposure variations within the fov on the correlation value ; and the identification and  cleansing \" of source counts from the image .",
    "source count cleansing is done iteratively , first by analyzing the raw data , then the first version of the cleansed data , etc .",
    ", until the background is estimated .",
    "this final background is used to compute source detection thresholds , which are subsequently used to identify putative sources .",
    "_ source characterization _ involves the combination of outputs from a number of wavelet scales , and the creation of source cells on the initial image within which source properties ( positions , count rates , etc . ) are estimated .",
    "in  [ sect : ver ] we demonstrate the efficacy of the algorithm by applying it to a large variety of cases , such as : an idealized image containing simulated extended and point sources , with spatially invariant gaussian psf and an exposure map similar to that of the _ einstein _ ipc ; a 32-ksec _ rosat _ pspc observation of the pleiades cluster ( cf .",
    "micela et al .  1996 ) ; and a simulated 30-ksec _",
    "acis - i observation of the lockman hole region ( t.  gaetz , private communication ) .",
    "we then describe the differences between our method and previously published methods , especially that of damiani et al .",
    ", in  [ sect : comp ] , and provide our summary and conclusions in ",
    "[ sect : sum ] . in future works",
    ", our algorithm will be applied to the analysis of specific scientific problems , e.g.  observed spatial variations in the diffuse x - ray background of the pleiades cluster ( see kashyap et al .",
    "1996 and kashyap et al .",
    "2001 , in preparation ) .",
    "wavelets can be used to filter an image at a given length - scale .",
    "this can be seen by considering the difference between two smoothed functions : one formed by convolving an ( arbitrary ) function @xmath13 with a real - valued , non - negative , infinitely differentiable smoothing function @xmath14 whose size is characterized by a scale @xmath7 and satisfies the condition @xmath15 1 ( e.g. , the gaussian function ) , and one formed by the convolution of @xmath13 with the same smoothing function with scale size @xmath16 ( holschneider 1995 ) . because all structure at length - scales smaller than the smoothing scales",
    "would be suppressed , the difference of these two smoothed functions will provide information about the details of @xmath13 that are introduced at the scale @xmath7 itself .",
    "in the situation of interest to us , the analysis of two - dimensional images , the relationship between @xmath17 and the wavelet function @xmath18 is , in the limits @xmath19 0 , @xmath20 ( the reason for our use of a prime symbol will become apparent below . ) this is an analyzing wavelet , or mother wavelet ( hence the subscript @xmath21 ) .",
    "other members of the same wavelet family ( so - called `` atoms '' ) can be generated from this mother wavelet via dilations and translations : @xmath22 @xmath23 and @xmath24 are the dilation parameters , and @xmath25 and @xmath26 are the translation parameters .",
    "there are many functions @xmath17 that can be used to create a mother wavelet .",
    "one example is the two - dimensional gaussian function : @xmath27 from which is created the marr , or ",
    "mexican hat \" ( mh ) , wavelet function : @xmath28e^{-\\frac{x^2}{2\\sigma_x^2}-\\frac{y^2}{2\\sigma_y^2 } } \\label{eqn : wave1 } \\\\ & = & \\frac{1}{2{\\pi}\\sigma_x\\sigma_y } w_m(\\frac{x}{\\sigma_x},\\frac{y}{\\sigma_y } ) \\ , .",
    "\\label{eqn : wave}\\end{aligned}\\ ] ] this is the wavelet function we use in our source detection algorithm .",
    "( note that we use the function @xmath29 instead of @xmath30 , to be consistent with damiani et al .",
    "the mh function has a positive kernel with shape similar to a canonical psf ( @xmath31 ) , surrounded by a negative annulus ( @xmath32 ; figure [ fig : wave ] ) .",
    "ellipses with semi - axes of length @xmath33 , 2@xmath34 , and 5@xmath34 describe the boundary between @xmath31 and @xmath32 , the minimum of the mh function , and the effective support of the mh function , respectively .",
    "the mh function offers several advantages which motivate its use for source detection : ( 1 ) it has two vanishing moments ( i.e.  the correlation of the mh function with constant or linear functions is zero ) , so that it acts to suppress the contribution of the ( generally spatially constant ) background to the correlation coefficients ; ( 2 ) while it does not have compact support , and can not be used to construct a set of orthogonal basis functions , a dyadic sequence of mh functions ( i.e. , with mh functions with scales separated by factors of two ) is sufficient to sample the entire frequency domain , because of the limited extent of an mh function s fourier transform ; ( 3 ) its limited extent in both spatial and fourier domains helps to minimize effects of aliasing ; and ( 4 ) it is analytically manipulable , so that many numerical operations may be performed using analytically derivable functions ( see appendix [ sect : mh ] ) , which can reduce computation time significantly .      before describing our algorithm in detail",
    ", we present a simplified example to help build the reader s intuition .",
    "we assume that we are analyzing a subset of an evenly exposed image with the mh wavelet function , far from any edge of the fov . within this image ,",
    "the counts in each pixel , @xmath35 , are sampled from a function which has a constant , relatively large ( @xmath36 1 ) amplitude , which we denote @xmath37 .",
    "these assumptions allow us to build intuition with a minimum of unnecessary detail ( such as correcting for exposure variations , etc . ) , and should not be construed as being reflective of limitations on the applicability of our algorithm .    as will be described in ",
    "[ sect : alg ] , the first step in our algorithm is to correlate the wavelet function @xmath38 and the binned image data @xmath39 .",
    "we denote correlation using the symbol @xmath40 ; in this case , we would write @xmath41 , or for a particular pixel , @xmath42 .",
    "would be written @xmath43 $ ] ; however , we feel our notation makes complicated expressions in the remainder of this work more easily interpretable . ]",
    "because the average value of the wavelet is zero and the data are sampled from a constant amplitude function , the mean correlation value will tend asymptotically to zero , with statistical sampling causing positively and negatively valued deviations from zero in individual pixels .",
    "indeed , for our simple situation , the resulting probability sampling distribution ( psd ) of correlation values , denoted @xmath44 , will tend asymptotically to a zero - mean gaussian , with width @xmath45 ( freeman et al .",
    "1996 , damiani et al .  1996 ,",
    "damiani et al .",
    "1997a ) .",
    "we now assume that there is a tightly bunched clump of counts in our otherwise source - free subset image , which could be caused by a poisson sampling fluctuation or by an astronomical source .",
    "we assume the clump has gaussian shape with amplitude @xmath46 and width @xmath47 , which is comparable to the size of the psf of the instrument .",
    "the correlation of the mh function with a gaussian yields a mh function that has its centroid at the gaussian centroid , and has centroid amplitude @xmath48 proportional to @xmath46 : @xmath49 .",
    "\\label{eqn : cmax}\\ ] ] for our simple example , @xmath50 0 , i.e.  @xmath51 is always greater than the mean of the psd . to determine whether we should associated the clump with an astronomical source",
    ", we would compute the integral of the psd from @xmath51 to @xmath52 ; if this quantity is smaller than a predefined significance threshold ( e.g.  @xmath53 10@xmath9 , or @xmath54 ) , then we associate the clump with a source .    because @xmath55 , source detectability will vary as a function of wavelet scale size . in the limits",
    "@xmath56 0 and @xmath57 , the ratio @xmath58 goes to zero , i.e.  the source becomes undetectable .",
    "if we apply symmetric wavelets in our analysis , the maximum value of this ratio occurs at @xmath59 .",
    "hence sources are most easily detected when one analyzes the image with a wavelet function that has a size similar to that of the source .",
    "since such a function acts to  filter , \" or selectively enhance , structures of similar scale , this behavior is to be expected .",
    "if the clump is associated with a previously known source , but is not detected , we can use eq .",
    "( [ eqn : cmax ] ) to determine the upper limit on source counts , by substituting the source detection threshold for @xmath51 , and solving for @xmath46 ( see , e.g. , ",
    "[ sect : ver1 ] ) .",
    "( because the gaussian is normalized , @xmath46 is identically the number of source counts . )",
    "we stress that the use of this method to place upper limits on source counts is limited to cases where the psf shape is that of a two - dimensional gaussian function , and should not be used in the place of simulations if the psf has arbitrary shape .",
    "our first objective is _ source detection _ : the identification of putative source pixels in binned , two - dimensional image data .",
    "this identification is normally done by carrying out the steps in the algorithm described below separately with each of a number of wavelet functions ( see also figure [ fig : flow ] ) .",
    "the basic steps in this algorithm include ( 1 ) the correlation of the data with the given wavelet function (  [ sect : wcor ] ) , and ( 2 ) the identification of image pixels with correlation values larger than pre - defined thresholds for source detection (  [ sect : thresh ] ) .",
    "the second step requires knowledge of the local background in each pixel ( due to unresolved point sources , diffuse astrophysical emission , particle background , etc . ) .",
    "if the background has not been determined previously , then it must be estimated , e.g.  via the method described in ",
    "[ sect : back ] .",
    "also , instrumental artifacts such as support rib structures , hot spots , and the edge of the fov can adversely affect the second step , resulting in the detection of instrumental features in the image , which are astrophysically uninteresting . in ",
    "[ sect : wexp ] , we describe a method for rejecting such ",
    "instrumental sources . \" finally , in ",
    "[ sect : werror ] we describe how the variances of the correlation and local background amplitudes are estimated .",
    "the first step in the source detection process at a given scale is to compute the correlation of the wavelet function @xmath60 with the binned , two - dimensional image data @xmath39 .",
    "the translation parameters @xmath25 and @xmath26 shown in eq .",
    "( [ eqn : trans ] ) correspond to image pixel indices @xmath61 and @xmath62 ; for a given pixel , the correlation value is @xmath63 ( henceforth , if a quantity is given with subscripts , we are referring to its value at pixel @xmath64 ; otherwise , we are referring to the quantity s array of values . ) the interested reader may find details about how @xmath65 is computed in appendix [ sect : mh ] .      to determine whether pixel @xmath64 should be associated with a source , we compute the probability of observing the correlation value @xmath66 if there are only background counts present within the support of @xmath38 : @xmath67 @xmath68 is dubbed the significance ( or the type i error ; see , e.g. , eadie et al .",
    "1971 , pp .  215 - 216 ) , and it is the estimated probability that we would erroneously identify pixel @xmath64 with a source . in  [ sect : simp ] , we indicated how @xmath68 could be determined analytically in the high - counts limit , where @xmath69 tends asymptotically to a zero - mean gaussian of width @xmath70 .",
    "in general , however , @xmath69 must be determined via simulations ( see appendix b ) . because the number of simulations we carried out is only sufficient to directly determine significances @xmath71 10@xmath10 , and because strong sources may have much greater significances ( in a qualitative sense )",
    ", we instead compute a source detection threshold @xmath72 via the equation @xmath73 where @xmath74 is the user - specified threshold significance .",
    ", where @xmath75 is the number of analyzed pixels in the image ; with this choice , the average number of false detections is one per image . ] if @xmath76 , we associate the pixel @xmath64 with a source .      in this section ,",
    "we describe how the local background counts amplitude @xmath77 is estimated if it is unknown _ a priori _ ( see also figure [ fig : bgflow ] ) . while there is no unique way to make this estimate , we seek a method that does not depend on a detector s psf , both for increased generality and computational speed , and also because we want our algorithm to be able to detect and analyze sources of arbitrary size , not just point sources .",
    "we can fulfill this condition by creating background maps _ at each wavelet scale _ , . ] using a localized function that is wavelet - scale , and not psf - scale , dependent : the wavelet negative annulus @xmath78 ( i.e. , @xmath38 with positive values reset to zero ) . while the function @xmath32 is related to a wavelet function , _ we stress that it itself is not a wavelet function , and that its use in background estimation does not constitute a transform .",
    "_    if the exposure within the support of @xmath32 is constant , and if @xmath23 and @xmath24 are sufficiently large such that the integral of the source counts distribution ( i.e.  the psf for a point source ) over the @xmath32 is insignificant with respect to the integrated background , then one can estimate the background using the formula @xmath79 where @xmath80 is the integrated volume of @xmath78 ( see appendix [ sect : negann ] for derivation ) .",
    "if on the other hand the exposure is not constant , the exposure map can be used as a weighting function : @xmath81 where @xmath82 is the normalized ( i.e.  flat - fielded ) number of expected background counts at pixel @xmath64 .",
    "we ignore the distinction between vignetted and non - vignetted components of the background ( e.g. , the particle background ) in our estimate , because of degeneracy .",
    "we note that if the amplitude of the non - vignetted background component @xmath83 is known , then one could in principle estimate the background using a variation of eq .",
    "( [ eqn : back ] ) : @xmath84    there are three situations in which counts from sources may bias the local background estimate : ( 1 ) if the estimate is being made within diffuse extended emission ; ( 2 ) if the pixel in which the estimate is being made is a source pixel , but @xmath23 and/or @xmath24 is smaller than the source size @xmath85 ; or ( 3 ) if sources are located within the @xmath32 .",
    "the first situation is a non - issue , because if the analysis goal is detection , say of a source within a supernova remnant , then the diffuse emission should be treated as a local background component : for instance , should a clump of counts be associated with a source , or with poisson fluctuations in the background _ and _ the diffuse emission ?    in the second situation",
    ", the background map will exhibit a  bump \" at the location of the source , whose amplitude is greatest where the number of source counts within the support of the @xmath32 is maximized , generally at the source centroid ( figure [ fig : bgbump ] ) . within the bump",
    ", the source detection threshold is overestimated , and thus this perhaps - otherwise - detectable source may remain undetected _ at the given scale_. however , this is not a critical problem , since if the source is detectable , it will be detected when ( @xmath23,@xmath24 ) @xmath86 , a scale regime where the bump is minimized , and the issue becomes moot .",
    "note that these bumps do not adversely affect source property estimation , since they are eliminated when the background map that is used for source property estimates is computed (  [ sect : nbkg ] ) .",
    "the third situation can be more problematic for source detection .",
    "if there are sources in the fov , then there will _ always _ be some image pixels for which the background amplitude is overestimated : for instance , for a symmetric wavelet function , these pixels will surround sources in circular  rings \" of radius @xmath0 2@xmath7 ( the radius at which @xmath32 achieves its minimum value ; see figure [ fig : bgring ] ) .",
    "in these rings , @xmath87 is overestimated , so that otherwise - detectable sources whose locations coincide with these rings may go undetected .",
    "rings can appear regardless of the scale or source size , and thus can impede source detection at all scales .",
    "they can also adversely affect the computation of source properties , as a background that is overestimated in the vicinity of a source can lead to underestimated count rates , etc .",
    ", in the final source list .",
    "( this last point is demonstrated below in figure [ fig : spropest ] , which shows the effect of rings on the estimation of pleiades cluster source properties .",
    "[ sect : ver3 ] . )",
    "one way to remove the rings is to remove source counts iteratively from the raw data , via the following algorithm :    1 .",
    "identify pixels to be  cleansed \" using @xmath44 and the initial background map , which we will dub @xmath88 ; 2 .",
    "mask out these pixels or replace their data with other values , creating a new image we denote @xmath89 ; 3 .",
    "estimate @xmath90 , where @xmath91 is the iteration number ( @xmath92 2 ) ; and 4 .",
    "if the background map is to be refined yet again , determine @xmath93 , identify pixels to be cleansed using @xmath94 , and return to step ( 2 ) .",
    "then , when the final background map @xmath95 is determined , compare the original values @xmath96 with @xmath97 to create a final list of putative source pixels .",
    "regarding steps ( 1 ) and ( 4 ) , since the goal of this iterative approach is to remove as many source counts as possible from the raw data , we advocate an aggressive approach to identifying the pixels to be cleansed : the threshold significance should be set high , e.g.  to @xmath98 ( although never higher than 0.05 , which corresponds to the oft - used 95% rejection level of statistics ) . regarding step ( 2 ) , while masking is used by damiani et al .",
    "( 1997a ) in their two - iteration approach to source detection , it would preclude us from using ffts to calculate @xmath99 .",
    "thus we replace the data in cleansed pixels with the inferred background amplitude .",
    "there are no rigorous quantitative rules governing how one should specify the number of iterations , as that can depend on the crowdedness of the field , the source distribution , the source strengths , and the wavelet scale size .",
    "we do note that iterative cleansing will cease if the background map does not change from one iteration to the next , i.e. , if no new pixels are marked for cleansing .",
    "in  [ sect : thresh ] , we describe how we use probability sampling distributions @xmath69 to identify sources .",
    "these distributions are derived assuming a spatially constant exposure .",
    "if , for instance , the exposure map exhibits localized high - order variations , then the list of detected sources may contain a mixture of astrophysically interesting sources and `` instrumental sources '' aligned near support rib shadows , near the edge of the fov , at the location of hot pixels , etc .",
    "e.g. _ , figure 1 of damiani et al .  1997b . )",
    "thus , an efficacious source detection algorithm should include additional calculations that act to decrease the detectability of instrumental sources , while leaving the detection efficiency of astrophysical sources unchanged .",
    "are also derived assuming a spatially constant background map , from which simulated data are sampled .",
    "thus an efficacious source detection algorithm should also include calculations that mitigate the effect of background variations caused by , _",
    "e.g. _ , x - ray shadows .",
    "the current algorithm does not take such variations into account ; anecdotal evidence ( e.g.  in  [ sect : ver3 ] ) indicates that they have little effect , possibly because they are far less  sharp \" than variations induced by support rib shadows , etc .",
    "note that if the background is known _ a priori _ , one can in principle remove the effect of high - order background variations on correlation values using a transformation similar to the one described below.]@xmath100    one possibility is to construct new sampling distributions @xmath101 for each observation , taking into account all the exposure variations that can appear within the wavelet support ; however , this is not computationally practical .",
    "instead , we estimate the systematic effect that exposure variations have on the correlation coefficients .",
    "assuming the null hypothesis , we may write the observed correlation coefficient as @xmath102 where @xmath77 is the estimated ( noise - free ) background intensity and @xmath103 is the noise ( and possibly source count ) contribution to @xmath66 .",
    "we ignore the latter term ( see the caveats below ) and rewrite the former so that its dependence on exposure variations is explicit : @xmath104 the quantity @xmath105 encapsulates exposure variability within the wavelet support , and thus the last term in eq .",
    "( [ eqn : expcor_deriv ] ) encapsulates the effect of exposure variability upon @xmath66 ; subtracting this term from @xmath66 yields an  exposure - corrected \" quantity that contains only information of astrophysical value : @xmath106 it is this quantity that is compared with the distribution @xmath69 to determine whether @xmath64 is a source pixel .    if @xmath107 is constant ( or linear ) within the wavelet support , then eq .",
    "( [ eqn : fullcor ] ) reduces to @xmath108 because @xmath109 is computed only once , we dub this the  fast \" exposure correction , as opposed to the  full \" exposure correction of eq .",
    "( [ eqn : fullcor ] ) .",
    "one should not use the  fast \" correction if non - linear structures ( caused , e.g. , by x - ray shadows ) are apparent in the background map .",
    "one should keep the following caveats in mind :    1 .   strictly speaking ,",
    "@xmath110 still can not be directly compared with the probability sampling distribution @xmath69 because the noise term @xmath103 is itself uncorrected .",
    "if we concentrate on the issue of false positives ( _ i.e. _  assume that there is no source count contribution to @xmath103 ) , the important question is : is the asymptotic width of the distribution from which @xmath111 is sampled _ smaller _ than the width of the distribution from which @xmath103 is sampled ?",
    "if so , then the rate of false detections will still be greater than expected .",
    "this is a problem if and only if for a given pixel , @xmath112 is smaller than the average exposure @xmath113 over the wavelet support @xmath64 , i.e.  this is only a problem within troughs or beyond the edge of the fov . to see this , harken back to the simple example of  [ sect : simp ] : what would happen to the width of @xmath114 if we were to reduce the exposure ? fewer counts would be detected , so @xmath77 would decrease , and the width of the noise distribution , which is @xmath115 , would also decrease . thus we suggest that one should carefully scrutinize all sources detected in low - exposure regions ( @xmath116 ) .",
    "2 .   note the distinction between the correlation maps @xmath96 and @xmath117 , especially if the analysis goal is not just source detection , but also image decomposition ( the scale - by - scale characterization of sources in correlation space ) . ) .",
    "thus this caveat is only an issue if the user desires to analyze correlation maps _ outside _ of wavdetect . ]",
    "the quantity @xmath117 represents a _",
    "pixel - by - pixel _ wavelet filtering not of the raw data @xmath39 , but of the quantity @xmath118 ( eq .  [ eqn : fullcor ] ) . because @xmath107 may be estimated using the @xmath32 , which is most sensitive to low - frequency components of the data ( see figure [ fig : pow ] ) , these modified data may be  contaminated \" with low - frequency information ( although wavelet filtering [ eq .",
    "[ eqn : fullcor ] ] mitigates the effect of the contamination ) .",
    "we note that while systematic overestimates of @xmath107 ( caused for reasons discussed in  [ sect : back ] ) adversely affect the computation of @xmath117 , they will not lead to an increased number of false detections .",
    "this is because the only situation where such a systematic overestimate affects _ non - source _ pixels in the _ final _ , refined background image is when the background is computed in regions of extended diffuse emission .",
    "in this situation , the algorithm treats the sum of the real background and the diffuse emission as the  background , \" so the rate of false detections ( which is independent of background amplitude ) will be unchanged .",
    "we estimate the variances of @xmath77 ( if one does not provide a background map ) , and of @xmath66 ( or @xmath110 or @xmath119 ) , using the standard formula ( eadie et al .",
    "1971 , p. 23 ) @xmath120~&=&~v[\\sum_i \\sum_j a_{i , j } x_{i , j } ] \\nonumber \\\\ & = & ~\\sum_i \\sum_j a_{i , j}^2 v[x_{i , j } ] + 2 \\sum_i \\sum_{i ' > i } \\sum_j \\sum_{j ' > j } a_{i , j } a_{i',j ' } { \\rm cov}[x_{i , j},x_{i'j ' } ] \\label{eqn : covar }   % % % & \\approx&~\\sum_i \\sum_j a_{i , j}^2 v[x_{i , j } ] \\nonumber \\ , , \\label{eqn : var}\\end{aligned}\\ ] ] where @xmath121 is quantity of interest and @xmath122 are random variables ( either @xmath35 or functions of @xmath35 ) .",
    "for instance , @xmath123~&=&~v[\\sum_{i ' } \\sum_{j ' } w_{i - i',j - j'}d_{i',j ' } ] \\nonumber \\\\ & = & ~\\sum_{i ' } \\sum_{j ' } w_{i - i',j - j'}^2 v[d_{i',j ' } ] \\nonumber \\\\ & = & ~\\sum_{i ' } \\sum_{j ' } w_{i - i',j - j'}^2 d_{i',j'}\\label{eqn : corerr2 } \\\\ & = & ~<w^2{\\star}d>_{i , j } \\ , .",
    "\\label{eqn : corerr3}\\nonumber\\end{aligned}\\ ] ] note that we make two assumptions when deriving this formula : ( 1 ) the datum @xmath124 is sampled from a poisson distribution with variance @xmath124 ; and ( 2 ) each pixel s raw datum is independently sampled ( so covariance terms do not contribute to @xmath125 $ ] ) .",
    "we list variance formulae related to source detection in table [ tab : sderr ] .",
    "the reader should keep in mind two important caveats about them :    1 .",
    "these formulae ignore the contribution of the covariance terms , which are non - zero for @xmath126 $ ] , @xmath127 $ ] , and @xmath128 $ ] if the data are iteratively cleansed , i.e.  if @xmath37 is a not just a function of the raw data @xmath39 only .",
    "we ignore these terms because even the simplest covariance computation , that for a two - iteration background map ( see appendix [ sect : covar ] ) , has a staggeringly high computational cost : we find that the cpu time needed to compute the variance increases by a factor @xmath129 , where @xmath130 and @xmath131 are the x- and y - axis lengths in pixels , respectively .",
    "also , additional arrays containing information needed to compute the covariance terms must be kept in memory , so there is a resource cost as well .",
    "we find that including covariance terms increases the variance by a median value of @xmath0 7% , and at most by only @xmath0 30% adjacent to strong sources , although this is a source - strength- and source - geometry - dependent result that obviously can not be blindly applied to all fields .",
    "ultimately it is up to the user to judge whether adding the computation of covariance to our base algorithm is worthwhile .",
    "when computing @xmath132 $ ] for the final background map , we make the simplifying assumption that the variance of a cleansed datum is equal to the cleansed datum itself ; for instance , for a two - iteration background map , @xmath133~&=&~\\sum_{i'}\\sum_{j ' } a_{i , i',j , j'}^2 v[d_{2,i',j ' } ] \\nonumber \\\\ & = & ~\\sum_{i'}\\sum_{j ' } a_{i , i',j , j'}^2 d_{2,i',j ' } \\label{eqn : bvar } \\,,\\end{aligned}\\ ] ] where @xmath134 we make this assumption because if the data are a mixture of raw data and background estimates , the variance estimates become increasingly complicated : for one iteration , @xmath135~&=&~d_{i , j } \\ , , \\nonumber\\end{aligned}\\ ] ] for two iterations , @xmath136~&=&~\\cases { d_{i , j } & { \\rm uncleansed pixel } \\cr \\sum_{i'}\\sum_{j ' } a_{i , i',j , j'}^2 d_{i',j ' } & { \\rm cleansed pixel } } \\label{eqn : twoiter}\\end{aligned}\\ ] ] etc .",
    "once we have identified putative source pixels at each of a number of wavelet scale size pairs @xmath137 , our next objective is _ source characterization _ , wherein we combine information derived at each scale pair to generate a final source list and to estimate source properties ( see figure [ fig : wrflow ] ) . unlike source detection",
    ", source characterization algorithms can be arbitrarily complex , depending , for instance , upon whether one wishes to use detailed psf information .",
    "our method is particularly simple , in that we use only the characteristic psf size at a given pixel , @xmath138 .",
    "this size may be associated with , e.g. , 50% encircled energy ; we find that smaller values , such as 39.3% ( which corresponds to the integral of a symmetric normalized two - dimensional gaussian to radius @xmath47 ) , work better than large values .",
    "while using the detailed psf shape may allow for more accurate estimates of source properties , the simplicity of our scheme makes it more immediately applicable to images from virtually any counts detector ( including those for which calibration is on - going or is for other reasons incomplete ) .",
    "in  [ sect : back ] , we describe how we calculate a scale - dependent normalized local background estimate @xmath107 , by assuming that there are no source counts in the negative annulus , @xmath32 . source detection itself is not markedly affected if this assumption is violated and the background overestimated , for reasons given in  [ sect : back ] , but an overestimated background will adversely affect the computation of source properties . we create a new , corrected , background estimate by combining information across scales ( denoted with a subscript @xmath139 ) , noting that the assumption that there no source counts in @xmath32 is always violated around sources if either @xmath140 or @xmath141 is less than the source size : @xmath142 @xmath4 is the number of scale pairs used , and @xmath143 @xmath21 is a multiplicative factor , set to one when estimating the properties of point sources , and to larger values when extended sources are analyzed .",
    "we use eq .",
    "( [ eqn : covar ] ) to estimate the variance of @xmath144 , with covariance terms ignored : @xmath145 \\ , .",
    "\\label{eqn : corbvar}\\ ] ] @xmath146 $ ] is estimated using the approximate equation listed in table [ tab : sderr ] .",
    "the next step in source characterization is to determine which pixels of the original image @xmath39 are to be associated with each detected source .",
    "we term contiguous pixels which are associated with a particular source a _ source cell _ , and as we describe below in  [ sect : sprop ] , we use the raw data in a source cell to determine a source s properties .",
    "we need to create source cells because , as noted above , we do not use psf shape information in our algorithm , and because we want an algorithm that is applicable to both point and extended sources .",
    "source cells are not computed in algorithms such as the sliding cell , where the integrated psf volume and sum of ( point ) source counts for a given user - defined cell can be used to estimate the total number of ( point ) source counts , etc .    to create source cells ,",
    "we first compute source count images , smoothing the raw data with the positive kernel of the wavelet function , @xmath31 , at user - specified scales , and then subtracting the corrected background image , @xmath147 : @xmath148 ( we denote these images @xmath149 to avoid confusion with either the significance @xmath150 or the correlation image @xmath96 . )",
    "we use @xmath31 as the smoothing function because it has the desirable properties of being localized , and , for the particular case of a symmetric mh function , of mimicking the shape of a canonical gaussian psf . in regions where there are no sources , source count image values are either zero , or positive and nearly zero",
    "; only in the vicinity of sources do the values deviate markedly from zero .",
    "thus the source count images appear to contain numerous  islands \" of non - zero flux in a sea of zero values , with their relative size increasing with size of the smoothing function @xmath31 ( see figure [ fig : scounts ] ) .",
    "each island contains one or more peaks , and sub - islands may be defined using each peak , with saddle points providing the boundaries between them .",
    "( sub-)islands observed in selected source count images define the source cells .    to define a source cell , we must select a source counts image and then determine to which ( sub-)island the putative source belongs .",
    "the selection proceeds as follows .",
    "the location of a putative source in correlation - space is assumed to be the location of the correlation maximum , @xmath151 . at this location",
    ", we compute the psf size , in pixels , @xmath152 .",
    "( this introduces a bias towards point sources ; we return to this point below . )",
    "we then select the source count image with smoothing scale ",
    "closest \" to @xmath152 by minimizing @xmath153 , where @xmath154 is defined for each scale pair : @xmath155 \\ , .",
    "\\nonumber\\end{aligned}\\ ] ] on the selected source count image , we examine pixel @xmath151 : the ( sub-)island to which this pixel belongs defines the source cell .    a source cell defined in this manner",
    "has advantageous properties : ( 1 ) if @xmath156 , then nearly all isolated point source counts should lie within a source cell ( figure [ fig : scex1 ] ) ; ( 2 ) exposure variations are taken into account via the use of @xmath157 in eq .",
    "( [ eqn : flux ] ) , so that source cells are not truncated near , e.g. , support rib shadows ; and ( 3 ) , as noted above , saddle points in the source count images provide natural boundaries between sources in crowded fields ( figure [ fig : scex2 ] ) .",
    "we note two situations where care must be exercised when interpreting results .",
    "first , the source cell for an extended source may be too small if the smoothing scale is @xmath158 .",
    "the steps one must take to deal with this situation will vary depending upon analysis circumstances , but one possible step is to create only one source count image , with @xmath159 , and to use this image to define the cell , while being careful to note whether previously detected point sources are located within it .",
    "( see , e.g. , ",
    "[ sect : ver1 ] . )",
    "another situation for which care must be exercised is when the psf is bimodal or otherwise strangely behaved ( such as the off - axis _",
    "chandra _ psf ) ; two or more source cells could be created for one detected source . the necessary steps to deal with",
    "this situation depend upon the details of the detector itself , and thus we will not discuss this particular situation further here .      because the same source will generally be detected at multiple scales , and to further decrease the possibility of finding false sources , it is necessary to reject sources from the lists of correlation maxima generated at each scale .",
    "a maximum observed at @xmath151 , for the scale pair @xmath160 , is rejected from further consideration if any of the following conditions are met : ( 1 ) @xmath151 lies in a previously defined source cell ; ( 2 ) @xmath161 0 ; ( 3 ) the ellipse defined by @xmath162 contains one or more previously defined sources detected at smaller scales ( this can occur when @xmath140 or @xmath141 is @xmath163 , since previously identified sources will eventually merge if the field is crowded , creating  new \" sources at new locations ) ; and ( 4 ) if , after the source cell is defined for a particular scale , it is found not to contain any correlation maxima _ at that scale_. this last check is aimed at rejecting small - scale poisson fluctuations that may be observed in the background data .",
    "we present the formulae we use to estimate source properties and their variances in tables [ tab : prop ] and [ tab : error ] respectively .",
    "the summations performed when making these estimates are carried out over the pixels within the source cell .",
    "we use the raw counts data , @xmath35 , as a weighting function , instead of the source fluence @xmath164 , because the use of the latter can greatly complicate the estimation of variances . using the data rather than",
    "the source fluence will lead to similar estimates when the background amplitude is small relative to source amplitude .",
    "we can use the information present in the correlation images and the source cell image to create a ",
    "noise - free \" rendering of the observed source data , @xmath165 , with the effect of exposure variations removed : @xmath166 dividing the correlation value by @xmath140 and @xmath141 restores the normalization contained in eq .",
    "( [ eqn : wave ] ) , allowing a scale - by - scale summation .",
    "the quantity @xmath167 = 1 if ( 1 ) @xmath168 0 , ( 2 ) the local maximum corresponding to @xmath64 has been identified as a source pixel , and ( 3 ) the associated local correlation maximum is contained within a source cell ( the second condition ensures that random maxima which are not associated with a source but which happen to lie within a source cell are not included in the source image ; the last condition ensures that rejected sources are not included ) ; otherwise , @xmath167 = 0 .",
    "to verify its source detection and characterization capabilities , we apply our algorithm to : ( 1 ) 1 and 10 ksec observations by an idealized detector with a spatially invariant psf ; ( 2 ) a 32-ksec _ rosat _ pspc observation of the pleiades cluster ; and ( 3 ) a simulated 30-ksec _ chandra _",
    "acis - i observation of the lockman hole region .",
    "these tests allow us to demonstrate that our algorithm can efficiently detect and accurately describe well - sampled sources in an uncrowded field , and can effectively analyze crowded fields , even in the low - background limit of the _ chandra _ detectors .",
    "we first demonstrate that our algorithm can efficiently detect , and accurately describe , well - sampled sources in an uncrowded field .",
    "we apply it to two 512@xmath169512 images , hereafter images a and b , that represent 1 and 10 ksec observations by an idealized detector with an effective area 1000 @xmath170 and a spatially invariant gaussian psf of width @xmath171 2.56 pixels ( figure [ fig : simdata ] ) .",
    "the exposure map for this detector is similar to that of the _ einstein _ ipc . within each image",
    "we randomly place 42 point sources , and 4 extended sources with elliptical shape .",
    "the fluxes of the point sources were sampled from a @xmath172 distribution with slope @xmath173 , above 10@xmath174 erg @xmath175 sec@xmath11 .",
    "we also simulate a locally variable background ( amplitude @xmath8 10@xmath176 ct sec@xmath11 pix@xmath11 ) by setting the background amplitude at five reference points , performing minimum - curvature - surface interpolation , and sampling background data in each pixel .",
    "we analyze the images assuming the input parameters listed for test 1 in table [ tab : numdet ] . in figure",
    "[ fig : counts ] , we plot the source counts for detected sources , and the upper limits for undetected sources , against the number of predicted counts .",
    "upper limits are defined using the source detection threshold values at the correlation maxima nearest the location of the undetected sources , and are computed using eq .",
    "( [ eqn : cmax ] ) , with @xmath177 4.43 pixels .",
    "we conclude that our algorithm efficiently detects and describes point sources with @xmath2 10 counts .",
    "this is not an absolute quantity : the minimum number of counts needed for source detection varies as a function of the background amplitude and source size ( see  [ sect : simp ] ) .",
    "hence while we may conclude that a 1 ksec observation is sufficient for the detection by _",
    "chandra _ of nearly on - axis point sources with fluxes @xmath2 10@xmath174 erg @xmath175 sec@xmath11 , since it has a similar effective area as , and lower expected background count - rates than , our idealized detector , it may not be sufficient far off - axis , or for detectors that have higher rates of background accumulation .    in figure",
    "[ fig : cell ] , we show the cells for the detected sources , along with the input source locations",
    ". we use a wavelet scale of 2@xmath178 pixels to create the source counts image that is in turn used to delineate the source cells .",
    "this scale is the closest",
    " standard \" scale to the assumed psf size ( if we assume scale sizes separated by factors of @xmath178 rather than 2 for greater source detection efficiency ) . in both images ,",
    "our algorithm detects one false source , which is consistent with the assumption of @xmath179 for a 512@xmath169512 image .",
    "creating source cells by using information derived at a wavelet scale close to the psf size is not optimal when one wishes to analyze and describe extended sources , as discussed in ",
    "[ sect : cell ] , and indeed by examining figure [ fig : cell ] we can see that the extended source cells are undersized .",
    "there are many ways by which an analyst may wish to treat extended sources ; here , we show how one could derive an image showing the ( normalized ) number of counts per pixel within the extended source .",
    "we use as our example the largest extended object in image b. first , we must expand the source cell so that it just encloses the extended source . to do this",
    ", we increase the minimum scale size at which a source counts image is to be computed ( in this example , from 2@xmath178 pixels to 8@xmath178 pixels ; see figure [ fig : ext]a - b ) .",
    "( note that the parameter @xmath21 in eq .",
    "[ eqn : bsumm ] must also be increased so that the background is not overestimated within the source . )",
    "second , we would use the new source cell as a spatial filter , applying it to the original source counts image created at the psf scale ( e.g.  figure [ fig : ext]c ) , or to the data , etc .",
    "( if one outputs source count image data , one can then , in principle , fit directly to them .",
    "for instance , the image may be of a galaxy cluster , and one may wish to assess the detectability of its constituent galaxies .",
    "however , care must be exercised since the data in contiguous pixels are not independent . taking into account the width of the @xmath31 used to smooth the raw image data , we can state that data @xmath180 pixels apart are independent .",
    "thus simple statistical fitting can be done to a sparse grid of data .",
    "this process of fitting would be essentially equivalent to the  decimation \" method described by lazzati et al .",
    "1998 , except that they fit to correlation image data . )",
    "next , we demonstrate that our algorithm outperforms the sliding cell in efficiently detecting sources in a crowded field , by applying it to the deep ( 32 ksec ) _ rosat _ pspc observation of the core of the pleiades cluster ( rp200068 , cf",
    ".  micela et al .  1996 ) .",
    "these data were obtained in two segments separated by roughly six months , and the slight boresight offset between the two segments has been corrected using a method described by micela et al .",
    "the data were also filtered to exclude times of high background contamination , and to exclude pulse - height - invariant ( pi ) channels at both the low - energy ( pi@xmath5320 , to avoid the so - called `` ghost image '' problem ; nousek & lesser 1993 ) and high - energy ( pi@xmath181201 , where no instrument map is available to determine exposure variations ) ends of the spectral response .",
    "we have computed exposure maps taking into account these changes using software developed by snowden & kuntz ( 1998 ) .    in table [ tab : numdet ] , we show how the number of detected sources varies as a function of the number of iterations , the spacing of scales , the exposure correction method , and the source detection significance . comparing tests 1 through 6 ,",
    "for which @xmath74 is constant , we find that the number of detected sources changes little if the number of iterations is increased beyond two , or if the full exposure correction method ( eq .  [ eqn : fullcor ] ) is used instead of the fast one ( eq .  [ eqn : fastcor ] ) . however , there is an @xmath0 5% increase in source yield by analyzing the image with the scale sizes spaced by factors of @xmath178 instead of @xmath182 .",
    "the extra sources are relatively weak sources whose probability of detection is maximized around the scales @xmath178 pixels , @xmath183 pixels , etc .",
    "it is the decision of the user as to whether the increase in weak - source detection efficiency is worth nearly doubling the computation time .",
    "we compare the source detection results for our test 8 with those shown in the wgacat and rosatsrc catalogs ( white , giommi , & angelini 1994 , and voges et al .  1994 , respectively ) , as well as those shown in micela et al .  and damiani et al .  ( 1997b ) .",
    "( the wgacat and rosatsrc catalog teams , and micela et al . ,",
    "use variants of the sliding - cell algorithm . ) we choose test 8 because it most closely resembles the analysis of damiani et al .",
    ", who perform a two - iteration analysis of the pleiades image with wavelet functions of scale sizes 1 , @xmath178 , ... , 16 pixels , and with threshold significance @xmath184 ( 4.2@xmath7 ) .",
    "our result is nearly equal to that of damiani et al .",
    ", as we detect 148 sources , while they detect 150 .",
    "we can not directly compare our numerical results with those of damiani et al .",
    ", who only publish figures showing the performance of their algorithm on a subset of the pleiades field .",
    "however , we can emulate damiani et al .  by showing how our results compare with those of the wgacat and rosatsrc catalogs ( table [ tab : compare ] , cf .",
    "damiani et al .",
    "table 1 ) .",
    "our results are virtually identical to those of damiani et al . ,",
    "in , e.g. , how many sources are detected only by our algorithm , etc .",
    "we thus may conclude that our algorithm and that of damiani et al .",
    "generate a largely similar source list .",
    "a large fraction of the sources that we detect , but that are not included in the wgacat or rosatsrc catalogs , are located either near the inner telescope support ring ( @xmath0 20@xmath3 off - axis ) or near the precipitous drop - offs in exposure caused by telescope vignetting near the edge of the fov ( figure [ fig : ple ] ; see also figure [ fig : spropest ] ) .",
    "a visual examination of these sources indicates that they are not spurious .",
    "we further examine in detail the two sources near the edge of the fov that were not included in either the wgacat or rosatsrc catalogs , but are in regions covered by other _ rosat _",
    "pspc pointings described by stauffer et al .  (",
    "we find that these sources lie within @xmath185 pixels of the stauffer et al .",
    "sources 159 and 197 ( see their table 2 ) , which have reported count rates @xmath0 0.023 and 0.016 ct sec@xmath11 respectively .",
    "these rates are consistent with our derived count rates .",
    "this demonstrates the robustness of our simple exposure correction method .",
    "we also note the intriguing result that the local background map computed by our algorithm indicates the presence of an x - ray shadow in the core of the cluster ( figure [ fig : ple_bkg ] ; kashyap et al .",
    "2001 , in preparation ) .",
    "because the pleiades cluster is located beyond the edge of the local bubble of hot gas ( frisch 1995 ) , this shadow , which is most pronounced at low energies , is of more distant sources of the diffuse x - ray background ( dxbg ) , such as the extragalactic component and obscured stars in the pleiades cluster itself .",
    "the depth of the shadow places constraints on the nature of the stellar mass - function at low masses , and in particular rules out models where the mass - function is extrapolated at a constant slope from higher masses , thus providing independent , x - ray observational support for optical observations that report drops in the mass - function at low masses ( @xmath186 ; see , e.g. , tinney , mould , & reid 1992 , bahcall et al .",
    "1994 ) .",
    "finally , we demonstrate that our algorithm can handle the low background amplitudes which are characteristic of _ chandra _ observations , while continuing to outperform the sliding cell , by applying it to a simulated 30 ksec _",
    "acis - i image of the lockman hole ( t.  gaetz , private communication ; figure [ fig : lh_data ] ) .",
    "the acis - i is comprised of four 1024@xmath1691024 pixel ccds configured in a 2@xmath1692 square , with fov @xmath0 17@xmath18717@xmath3 ( @xmath0 50 times smaller than that of the _ rosat _ pspc ) . within the acis - i field",
    "are placed : ( 1 ) 12 optically identified _",
    "pspc x - ray sources catalogued by schmidt et al .",
    "( 1998 ) , including one extended cluster source ; ( 2 ) @xmath0 6000 point sources sampled from the hasinger et al .",
    "( 1998 ) @xmath172 distribution between 10@xmath188 and 5@xmath16910@xmath189 erg @xmath175 sec@xmath11 ; and ( 3 ) 19500 particle background counts ( corresponding to a particle background rate of 1.5@xmath16910@xmath10 ct pix@xmath11 sec@xmath11 ) .",
    "if we assume the input parameters listed for test 1 in table [ tab : numdet ] , and do not use an exposure map , we detect 171 sources in the full acis - i field , of which four are directly associated with the extended galactic cluster ( figure [ fig : lh_data ] ) . in figure",
    "[ fig : logn ] , we show differential @xmath172 distributions for both detected , and all , points sources in the fov . on the basis of this figure , we may conclude that our algorithm will efficiently detect sources in acis - i images with fluxes @xmath2 10@xmath189 erg @xmath175 sec@xmath11 ( 0.5 - 2 kev ) , and has the ability to detect poisson sampling fluctuations for sources with fluxes @xmath190 10@xmath191 erg @xmath175 sec@xmath11 .",
    "our result compares very favorably with the performance of celldetect , which detects 51 sources with @xmath192 3 .",
    "( further comparison of the source detection efficiencies of wavdetect and celldetect is provided by kim et al .",
    "2001 , in preparation . )",
    "we conclude that the relative superiority of our wavelet detection algorithm , with respect to the sliding cell , is inversely proportional to the background amplitude .    in figure",
    "[ fig : offax ] , we plot the offsets of the locations of detected sources from their actual locations within the fov .",
    "( these offsets are caused by the asymmetry of the _ chandra _ psf , and their magnitude increases with off - axis angle . )",
    "we note two characteristics of these offsets .",
    "first , the variation in the offsets does not depend on source strength , signifying that the source - locating process is insensitive to the strength of the source .",
    "second , the observed offsets are significantly smaller than the expected mean separation between sources ( @xmath193 pix ) , implying that the observed offsets are due to the asymmetries inherent in the psf and not due to source misidentifications .",
    "we thus find that the weak sources are as `` well - behaved '' as strong sources ( about whose detection and identification there can be little doubt ) , and hence infer that even the weakest detected sources are real .",
    "the source detection algorithm which we present in this work resembles algorithms published previously by vikhlinin et al .",
    "( 1994 ) , rosati et al .",
    "( 1995 ) , grebenev et al .",
    "( 1995 ) , damiani et al .",
    "( 1997a ) , and lazzati et al .",
    "( 1998 ) . in this section ,",
    "we highlight important differences between our algorithm and these other algorithms , all of which , having been developed for analyzing _",
    "pspc data , suffer from inherent limitations that do not allow them to be directly applied to data from , e.g. , _",
    "chandra_. we do not discuss how our method of source characterization differs from those described previously , because these other methods are built upon the premise that the psf has gaussian shape .",
    "thus they are simply not directly applicable in situations where the psf has a more complex shape .",
    "our basic method for computing the correlation images is the same as that used by vikhlinin et al . , rosati et al . , grebenev et al . , and lazzati et al . , with the exception that rosati et al .",
    "use the symmetric morlet wavelet function @xmath194\\ ] ] instead of the mh function .",
    "however , these authors do not attempt to correct for exposure variations , as they focus their attention upon the center of the _ rosat _ pspc fov , and they use a fundamentally different method to determine source detection thresholds ( see below )",
    ".    the method by which damiani et al .  correct for exposure and",
    "detect sources differs substantially from ours .",
    "they first divide the raw data image ( which they refer to as the  photon image \" ) by an exposure map on a pixel - by - pixel basis , to create the so - called  count - rate image . \"",
    "pixels with relative exposure less than a certain amount ( e.g.  0.2 ) are not included , which introduces a sharp edge in the count - rate image where telescope vignetting becomes important .",
    "damiani et al .",
    "correlate the wavelet function with this image , applying an analytic correction to correlation values near the edge ( as given in their eq .",
    "12 ) . because the data in the count - rate image are not poisson - distributed , damiani et al .",
    "must convert source detection threshold values , derived from their background map in the photon image , to values appropriate for the count - rate image .",
    "they accomplish this by dividing the photon - image detection thresholds by an effective exposure time @xmath195 , which is not a source exposure time that can be used to convert estimated source counts to count rates . because damiani et al .",
    "derive the equation with which they compute effective exposure time in the gaussian limit ( see their appendix b ) , their exposure correction method is effectively limited to the high - counts regime : it can not be applied as is to , e.g. , typical _ chandra _ data .      as described in ",
    "[ sect : alg ] , we estimate the local background counts amplitude in each pixel by assuming that within the negative annulus of the wavelet , @xmath32 , there are no source counts ( eq .",
    "[ eqn : back2 ] ) .",
    "we then use that inferred amplitude to determine source detection thresholds .",
    "this is a generalization of the approach used by vikhlinin et al .",
    ", rosati et al . , grebenev et al . , and lazzati et al . , in which the correlation variance @xmath196 is used to determine thresholds ( e.g. , @xmath197 3.5 ) . this approach will work if the background is locally flat or has a locally constant gradient , in which case the correlation of wavelet and background is zero .",
    "such an approach is obviously insufficient for use with the whole fov of x - ray detector , where support rib shadows and vignetting will affect the background , and/or in situations where the non - instrumental background varies markedly ( such as in the pleiades ; see figure [ fig : ple_bkg ] ) .",
    "damiani et al .",
    "use the same basic approach to source detection as we do , in that they compute a local background amplitude , and use it to compute source detection thresholds .",
    "damiani et al .",
    "compute the background map by first smoothing the raw data with a gaussian with width @xmath198 .",
    "they then interpolate background estimates within support rib shadows . at each scale , they compute the median value of the smoothed background within a square region with side - length @xmath199 centered on the given pixel .",
    "( we explicitly use @xmath200 instead of @xmath201 to highlight their assumption of gaussian psf shape . )",
    "after point sources are detected ( using a source cleansing significance that is 0.2@xmath7 smaller than their source detection significance ) , regions around them containing 95% of the counts are masked out , and a refined background estimate is made by interpolating over the masked regions .",
    "in this work , we present a generalized wavelet - based source detection algorithm that , in principle , can be applied immediately to image data collected by any photon counts detector , although it was developed specifically for the analysis of _ chandra x - ray observatory _ image data .",
    "we exclusively use the marr , or mexican hat , wavelet function in this paper , but the basic details of our algorithm would be unchanged if we use other wavelet functions , such as the haar or morlet wavelet functions",
    ". aspects of our algorithm include : ( 1 ) the computation of the correlation of the wavelet function and the data image using either analytic or fft methods ; ( 2 ) the computation of a local , exposure - corrected normalized ( i.e.  flat - fielded ) background in each pixel ; ( 3 ) its applicability within the low - counts regime , as it does not require a minimum number of background counts per pixel for the accurate computation of source detection thresholds ; ( 4 ) the correction of those correlation values which are affected by large exposure variations within the wavelet support ( due to , e.g. , telescope support ribs or the edge of the field of view ) , using either one of two methods given by eq .",
    "[ eqn : fullcor ] and eq .",
    "[ eqn : fastcor ] ; ( 5 ) the generation of a source list in a manner that does not depend upon the details of the psf shape , including the creation of general , data - dependent source cells for the estimation of source properties and filtering of extended source data ; and ( 6 ) full error analysis . in these respects ,",
    "our algorithm is considerably more general than the similar wavelet - based methods developed by vikhlinin et al .",
    "( 1994 ) , rosati et al .",
    "( 1995 ) , grebenev et al .",
    "( 1995 ) , damiani et al .",
    "( 1997a , b ) , starck & pierre ( 1998 ) , and lazzati et al .",
    "nearly all of these methods were developed specifically for treating data collected by the _",
    "rosat _ pspc ( starck & pierre 1998 apply their method to data from the _ rosat _ hri ) ; none except damiani et al .  attempt to correct for variations in exposure within the fov ; and all except for damiani et al .",
    "assume a flat background across the region of interest .",
    "the relatively more general method of damiani et al .  is limited to analyzing data from detectors which have psfs with gaussian shape , and which have high rates of background accumulation .",
    "these limitations make the damiani et al .",
    "approach , as published , inappropriate for use with , e.g. , _ chandra _ data .",
    "in  [ sect : ver ] , we demonstrate the robustness of our algorithm by applying it , _ without algorithmic changes _ , to data collected by an idealized detector with a spatially invariant gaussian psf ; to _ rosat _ pspc data of the crowded field of the pleiades cluster ; and to a simulated _ chandra _ acis - i image of the lockman hole region .",
    "collectively , these test cases indicate that our algorithm : ( 1 ) effectively detects and describes point sources , and can be applied to the study of extended sources ; ( 2 ) does not detect more spurious sources than expected ; ( 3 ) is more sensitive than sliding - cell methods ; and ( 4 ) has equal sensitivity to the damiani et al .",
    "method for the specific case of _ rosat _ pspc data .",
    "we find that while we can use the algorithm as presented to analyze extended sources , such analysis requires careful monitoring on the part of the analyst .",
    "work on generalizing this analysis is on - going , and will be reported in a future work .",
    "the authors acknowledge the support of the cxc beta test site grant and nasa grants nag5 - 3173 , nag5 - 3189 , nag5 - 3195 , nag5 - 3196 , nag5 - 3831 , nag5 - 6755 , and nag5 - 7226 .",
    "we are grateful to t.  gaetz and a.  vikhlinin for making available the simulated acis - i image of the lockman hole , analyzed in  [ sect : ver2 ] .",
    "we would like to thank r.  c.  nichol , b.  holden , j.  flanagan , t.  calderwood , and a.  dobryzcki for their assistance with coding issues , e.  kolaczyk for useful discussions regarding the computation of covariance , and f.  damiani , s.  sciortino , and a.  bijaoui for useful discussions .",
    "finally , we would like to thank the anonymous referees for their detailed comments and suggestions , which greatly helped the preparation of this manuscript .",
    "in particular , our description of the vanishing moments property of wavelets and its relationship to source detection owes much to one of these referees .",
    "the source detection algorithm that we have presented does not explicitly depend on the details of wavelet function itself , and thus should be applicable with other , simple , wavelet functions which have one central positive mode .",
    "hence we have deferred to this appendix and the next the derivation of various formulae that we use in our algorithm which are valid specifically when using the marr , or mexican hat ( mh ) , wavelet function .      before carrying out source detection at given scales ( @xmath23,@xmath24 ) , we must determine the grid of values @xmath202 ( see [ eqn : coranal ] ) .",
    "this is accomplished by integrating the function @xmath203 , defined in eqs .",
    "( [ eqn : wave1]-[eqn : wave ] ) , on a pixel - by - pixel basis within an ellipse with axes with full lengths 10@xmath23 and 10@xmath24 , with values farther from the origin set to zero : @xmath204 \\exp\\left(-\\frac{x^2}{2\\sigma_{x}^2}\\right ) \\exp\\left(-\\frac{y^2}{2\\sigma_{y}^2}\\right ) \\ , .",
    "\\label{eqn : anal}\\end{aligned}\\ ] ] @xmath205 represent coordinates relative to the center of pixel @xmath64 , and and @xmath206 and @xmath207 denote the limits of integration over pixel @xmath208 ( figure [ fig : coord ] ) : @xmath209    we expand eq .",
    "( [ eqn : anal ] ) and perform each integral separately .",
    "the first integral in the expansion is computed using @xmath210 \\nonumber \\\\ & = & \\sqrt{\\frac{\\pi}{2 } } \\sigma_x x_{\\rm erf } \\ , , \\nonumber\\end{aligned}\\ ] ] where the substitution @xmath211 is made , and @xmath212 is the error function . performing the same integration over @xmath213 , we determine that the first term is @xmath214 .    to compute the second and third integrals , we must determine , e.g. , @xmath215 this integral can be solved by parts , by taking the derivative of @xmath216 and the integral of @xmath217 .",
    "we present the solution : @xmath218    the final solution is @xmath219      analytic computation of correlation values ( eq .  [ eqn : coranal ] ) may be too computationally intensive if the image and/or wavelet scale sizes are too large .",
    "so in wavdetect , for instance , fast fourier transforms ( ffts ) are used if scale sizes are @xmath220 2 pixels : @xmath221 .\\ ] ] to mitigate the effect of the  wrap - around , \" any image that is to be transformed is padded with zeros ; the minimum width of the padding is 10@xmath222 .    in our own fortran code , we use the analytic fourier transform of the mh function , which we denote @xmath223 : @xmath224 \\int_{-\\infty}^{+\\infty } dx w(x , y ) \\cos(2{\\pi}k_{x}x ) \\label{eqn : evodd2 } \\nonumber \\\\ & = & ~\\int_{-\\infty}^{+\\infty } dy \\cos(2{\\pi}k_{y}y ) \\int_{-\\infty}^{+\\infty } dx w(x , y ) \\cos(2{\\pi}k_{x}x ) \\nonumber \\\\ & = & ~\\int_{-\\infty}^{+\\infty } dy \\cos(2{\\pi}k_{y}y ) \\times c_{\\rm w } \\label{eqn : cw } \\,.\\end{aligned}\\ ] ] the wave - number @xmath139 equals @xmath225 , where @xmath226 is the pixel number in fourier space , @xmath227 is the nyquist wave - number , and @xmath228 is half the length of the relevant axis in the padded image .",
    "the fourth integral in eq .",
    "( [ eqn : evodd ] ) and the second integral in eq .",
    "( [ eqn : evodd2 ] ) are zero , as the integrands are products of even and odd functions .",
    "@xmath229 \\exp\\left(-\\frac{x^2}{2\\sigma_x^2}\\right)\\cos(2{\\pi}k_xx ) \\nonumber \\\\ & = & ~\\exp\\left(-\\frac{y^2}{2\\sigma_y^2}\\right ) \\left [ \\left(2 - \\frac{y^2}{\\sigma_y^2 } \\right ) \\psi_{\\rm 0,c}(2{\\pi}k_x,\\frac{1}{\\sqrt{2}\\sigma_x},0 ) - \\frac{1}{\\sigma_x^2 } \\psi_{\\rm 2,c}(2{\\pi}k_x,\\frac{1}{\\sqrt{2}\\sigma_x } ) \\right ] \\label{eqn : c2 } \\,.\\end{aligned}\\ ] ] @xmath230 and @xmath231 represent two integral solutions which one may find , e.g. , in gradshteyn & ryzhik  ( 1980 ; formulae 3.896 - 2 and 3.952 - 4 respectively ) : @xmath232 and @xmath233 substituting these quantities into eq .",
    "( [ eqn : c2 ] ) , one finds that @xmath234 \\label{eqn : cw2}\\ ] ] substituting eq .",
    "( [ eqn : cw2 ] ) into eq .",
    "( [ eqn : cw ] ) and solving , we find : @xmath235 \\nonumber \\\\ & = & ~\\exp(-2{\\pi}^2k_{x}^2\\sigma_{x}^2 ) \\sigma_{x } \\sqrt{2{\\pi } } \\left [ ( 4{\\pi}^2k_{x}^2\\sigma_{x}^2 + 1)\\psi_{\\rm 0,c}(2{\\pi}k_{y},\\frac{1}{\\sqrt{2}\\sigma_{y}},0 ) - \\frac{1}{\\sigma_{y}^2}\\psi_{\\rm 2,c}(2{\\pi}k_{y},\\frac{1}{\\sqrt{2}\\sigma_{y}})\\right ] \\nonumber \\\\ & = & ~(2{\\pi})^3\\sigma_{x}\\sigma_{y}(k_{x}^2\\sigma_{x}^2 + k_{y}^2\\sigma_{y}^2)\\exp[-2{\\pi}^2(k_{x}^2\\sigma_{x}^2+k_{y}^2\\sigma_{y}^2 ) ] \\ , .",
    "\\label{eqn : ftw}\\end{aligned}\\ ] ]    by using @xmath223 instead of @xmath236 , we reduce computation time , but numerical estimates are less accurate ( with respect to estimates derived analytically ) .",
    "we quantify the discrepancy between any two of our three methods ( @xmath223 , @xmath236 , or analytic ) using @xmath237 we use the analytically derived detection threshold @xmath238 in the denominator because the expectation value of @xmath96 is zero .",
    "it also provides an intuitive way to describe the discrepancy at the detection threshold .",
    "we find @xmath239 , while @xmath240 , increasing with @xmath241 .",
    "( see figure [ fig : ftan ] . )",
    "the discrepancy results from the fact that we analyze binned images . because the data are binned , we should actually compute @xmath223 using the equation @xmath242",
    "if @xmath243 exhibits significant curvature in a bin , then @xmath244 within that bin ; the effect of this discrepancy in the final correlation value is proportional to the number of counts in the bin .",
    "thus @xmath245 will increase with source strength , as shown in the right panel of figure [ fig : ftan ] .",
    "if we wish to compute the error of the correlation value in a pixel , we calculate @xmath246 , saving computation time by using the analytic fourier transform @xmath247 .",
    "the derivation of this function is similar to the derivation of @xmath223 . a new integral which appears is : @xmath248 one may solve this integral by parts , differentiating the term @xmath249 and integrating the term @xmath250 .",
    "the integral @xmath251 has solution ( see , e.g. , gradshteyn & ryzhik 1980 , formula 3.952 - 5 ) : @xmath252    the final solution is @xmath253\\exp[-{\\pi}^2(k_{x}^2\\sigma_{x}^2+k_{y}^2\\sigma_{y}^2 ) ] .\\ ] ]    use of @xmath247 instead of @xmath254 leads to a less accurate accounting of the errors as derived using purely analytic methods , for reasons given above .",
    "we find the magnitude of the discrepancy in error estimates , as a fraction of the detection threshold , to be similar to that seen above ( @xmath8 10@xmath255 ) ; if we use the analytic error in the denominator instead of the detection threshold , we find that the discrepancy is constant as a function of @xmath256 , at @xmath8 10@xmath255 .      if exposure variations and the fov edge may be ignored in the computation of the background , then we may replace @xmath257 in eq .",
    "( [ eqn : back2 ] ) with a background normalization factor , @xmath258 , which we derive here .",
    "the average value of the mh function is zero .",
    "hence @xmath258 may be derived by integrating the mh function over either @xmath31 or @xmath32 .",
    "we choose the former : @xmath259^{\\frac{1}{2}}\\sigma_y}^{[2-\\frac{x^2}{\\sigma_{x}^2}]^{\\frac{1}{2}}\\sigma_y } dy \\left [ 2 - \\frac{x^2}{\\sigma_{x}^2 } - \\frac{y^2}{\\sigma_{y}^2 } \\right ] \\exp\\left(-\\frac{x^2}{2\\sigma_{x}^2}\\right ) \\exp\\left(-\\frac{y^2}{2\\sigma_{y}^2 } \\right ) .\\ ] ] the limits of integration reflect that the core extends over an ellipse with axes @xmath260 and @xmath261 .",
    "we reparametrize the integral using polar coordinates @xmath262 , after first mapping the boundary ellipse to a boundary circle using the transformation @xmath263 : @xmath264 \\exp\\left(-\\frac{x^2+y'^2}{2\\sigma_{x}^2}\\right ) \\\\ & = & ~\\frac{\\sigma_{y}}{\\sigma_{x}}\\int_0^{2{\\pi } } d\\theta \\int_0^{\\sqrt{2}\\sigma_{x } } dr r \\left[2 - \\frac{r^2}{\\sigma_{x}^2}\\right ] \\exp\\left(-\\frac{r^2}{2\\sigma_{x}^2}\\right ) \\\\ & = & ~2{\\pi}\\frac{\\sigma_{y}}{\\sigma_{x } } \\left[\\int_0^{\\sqrt{2}\\sigma_{x } } dr 2 r \\exp\\left(-\\frac{r^2}{2\\sigma_{x}^2}\\right ) - \\int_0^{\\sqrt{2}\\sigma_{x } } dr \\frac{r^3}{\\sigma_{x}^2 } \\exp\\left(-\\frac{r^2}{2\\sigma_{x}^2}\\right)\\right ] \\ , .",
    "\\label{eqn:1back}\\end{aligned}\\ ] ] the determinant of the jacobian of the transformation from @xmath265 is @xmath266 .",
    "we evaluate the second integral using integration by parts : @xmath267 + \\int_0^{\\sqrt{2}\\sigma_{x } } dr 2 r \\exp\\left(-\\frac{r^2}{2\\sigma_{x}^2}\\right ) .",
    "\\label{eqn:2back}\\ ] ] the second integral in eq .",
    "( [ eqn:2back ] ) cancels with the first integral in eq .",
    "( [ eqn:1back ] ) , leaving : @xmath268 \\nonumber \\\\ & = & ~2{\\pi}\\frac{\\sigma_{y}}{\\sigma_{x } } \\frac{2\\sigma_{x}^2}{\\exp(1 ) } \\nonumber \\\\ & = & ~\\frac{4{\\pi}\\sigma_{x}\\sigma_{y}}{\\exp(1 ) } \\,.\\end{aligned}\\ ] ]",
    "we associate an image pixel @xmath64 with a source if the significance @xmath68 of its correlation value @xmath66 is greater than a user - defined detection threshold significance @xmath74 : @xmath269 where @xmath77 is either @xmath270 , the convolution of the wavelet negative annulus @xmath32 with ( possibly cleansed ) image data @xmath39 , or the amplitude in an input background map .",
    "@xmath69 is the probability sampling distribution ( psd ) for @xmath96 given @xmath77 .",
    "( we are assuming here that the field of view is evenly exposed , which is true for the simulations we describe below . in a more general expression",
    ", we would replace @xmath270 with @xmath271 . ) by defining the significance in this manner , we are making the assumption that the expected background counts amplitude is constant throughout the wavelet support , and that if we are computing the background , there are no source counts in the negative annulus . since the psd is dimensionless , it is independent of scale size ( e.g.  the psd for @xmath77 would be the same if we were to double @xmath23 and @xmath24 and reduce the count rate by a factor of four ) .    we replace @xmath77 with the equivalent quantity @xmath272 , the expected number of background counts within the spatial region spanned by the positive kernel of the wavelet , @xmath31 .",
    "( @xmath272 is related to @xmath77 by multiplicative factors . )",
    "the psd does not have analytic form when the total number of expected counts within the positive kernel of the wavelet , @xmath272 , is small ( @xmath190 1 ) ; this is demonstrated by damiani et al .",
    "( 1997a ) .",
    "like damiani et al . , we use simulations to estimate significances and detection thresholds ; we carry these simulations out both within the regime they examine and also for lower expected counts values . because this is a computationally intensive problem , we can not accurately estimate significances for each pixel if @xmath273 .",
    "instead , we compare the value of @xmath66 in each pixel with the detection threshold @xmath274 , defined by @xmath275 here , we recast the equation using the variable @xmath272 , the number of expected counts in @xmath31 , as its use clarifies our description below of how we estimate @xmath276 .",
    "to determine @xmath277 , we simulated over 50,000 1024@xmath1691024 flat - field images .",
    "for each image , we :    * randomly selected values @xmath278 from the range -10 @xmath279 3.25 ( we describe why we chose this upper limit below ) ; * determined the expected background amplitude @xmath280 in each image pixel ( @xmath281 pixels ) ; * sampled data in each pixel from the appropriate poisson distribution given rate @xmath282 ; * computed @xmath66 and @xmath272 for each image pixel ; * and recorded @xmath66 in bins of size @xmath283 = 0.2 , for -6.9 @xmath284 3.1 , with one bin being used for all values of @xmath285 -6.9 . from these distributions",
    "@xmath286 , we can determine @xmath276 .    because there is an inverse correlation between observed values of @xmath66 and @xmath272",
    ", it is important to record @xmath286 and _ not _ @xmath287 .",
    "use of the latter distribution leads to underestimated detection thresholds , and thus to larger numbers of false source detections than one would expect , given @xmath74 .",
    "we determined 25 values of @xmath288 in each @xmath289 bin , for values of @xmath290 10@xmath10 , using the central 68% ( 17 values ) to estimate ",
    "one-@xmath7 \" errors on @xmath87 .",
    "we then fit these data with simple functions , minimizing the @xmath291 statistic .",
    "these functions we use describe the observed detection thresholds well , except in the regime @xmath292 and @xmath293 , where we use a look - up table instead .",
    "these fits allow us in principle to compute detection threshold for significances below our computational lower limit @xmath294 10@xmath10 ( such as for @xmath294 10@xmath295 , the significance corresponding to one false source pixel in an _ chandra _ hrc image ) .    in the regime @xmath292 and @xmath296 , we compute @xmath297 using the function @xmath298 where @xmath299    in the regime @xmath300 , we compute @xmath301 using the function @xmath302 where @xmath303 this function is also used by damiani et al .  to fit detection thresholds in this",
    "counts regime , though their derived coefficients differ from ours .    for values @xmath304",
    ", we find that we must use the formula @xmath305 to compute the detection threshold , with @xmath306 and @xmath307    for our simulations , we chose @xmath308 3.25 as a upper limit because of the contention of damiani et al .  that if @xmath309 3 , the psd probability sampling distribution is analytically representable as a gaussian with width @xmath310 .",
    "( note that the value of @xmath272 that we use in this work is larger than that used by damiani et al .  by a factor of @xmath311 . )",
    "if this is the case , the significance is given by : @xmath312 \\ , .",
    "\\label{eqn : anl}\\end{aligned}\\ ] ] we find , however , that if we use this formula in the regime @xmath309 3 , the derived values of @xmath276 are smaller than those predicted by eq .",
    "( [ eqn : hi ] ) above .",
    "thus , because it is more conservative , we use eq .",
    "( [ eqn : hi ] ) to compute detection thresholds for all values @xmath309 0 .",
    "if the data are cleansed ( see  [ sect : back ] ) , then an exact calculation of @xmath132 $ ] will include non - zero covariance terms . in this section",
    ", we derive these terms assuming that the data are cleansed only once , i.e.  we compute the variance for @xmath313 , a background estimate made by convolving the wavelet negative annulus with data @xmath89 that are a mixture of raw data @xmath39 and first - iteration background estimates @xmath88 : @xmath314 where @xmath315 = @xmath316 .    using eq .",
    "( [ eqn : covar ] ) , @xmath317~&=&~\\sum_{i ' } \\sum_{j ' } ( n_{i , j}nw_{i - i',j - j'})^2 v[d_{i',j ' } ' ] \\nonumber \\\\ & & + 2 \\sum_{i ' } \\sum_{i '' > i ' } \\sum_{j ' } \\sum_{j '' > j ' } ( n_{i , j}nw_{i - i',j - j ' } ) ( n_{i , j}nw_{i - i'',j - j '' } ) { \\rm cov}[d_{i',j'}',d_{i'',j '' } ' ] \\ , .",
    "\\nonumber\\end{aligned}\\ ] ] to calculate the variance , we must estimate both @xmath318 $ ] and @xmath319 $ ] .",
    "the estimate of the former is given in eq .",
    "( [ eqn : twoiter ] ) , derived assuming that the raw datum @xmath124 is sampled from a poisson distribution with variance @xmath124 , and that each pixel s raw datum is independently sampled .",
    "estimation of @xmath319 $ ] is more complicated .",
    "for the two - iteration background case , there are three possibilities : @xmath320 and @xmath321 ; @xmath320 and @xmath322 ( or vice - versa ) ; or @xmath323 and @xmath322 . assuming that the raw data are independently sampled , in the first case the covariance is zero . in the second case",
    ", we can estimate the covariance using the approximation ( eadie et al .",
    "p.  27 ) : @xmath324~&=&~\\sum_k \\sum_l \\sum_{k ' } \\sum_{l ' } \\left(\\frac{{\\partial}d_{i',j'}}{{\\partial}\\mu_{k , l}}\\right )",
    "\\left(\\frac{{\\partial}b_{1,i'',j''}}{{\\partial}\\mu_{k',l'}}\\right ) cov[d_{k , l},d_{k',l ' } ] \\nonumber \\\\ & = & ~\\sum_k \\sum_l \\left(\\frac{{\\partial}d_{i',j'}}{{\\partial}\\mu_{k , l}}\\right ) \\left(\\frac{{\\partial}b_{1,i'',j''}}{{\\partial}\\mu_{k , l}}\\right ) v[d_{k , l } ] \\nonumber \\\\ & = & ~\\sum_k \\sum_l \\left(\\frac{{\\partial}d_{i',j'}}{{\\partial}d_{k , l}}\\right ) \\left(\\frac{{\\partial}b_{1,i'',j''}}{{\\partial}d_{k , l}}\\right ) v[d_{k , l } ] \\nonumber \\\\ & = & ~\\left(\\frac{{\\partial}b_{1,i'',j''}}{{\\partial}d_{i',j'}}\\right ) v[d_{i',j ' } ] \\nonumber \\\\ & = & ~v[d_{i',j ' } ] \\frac{\\partial}{{\\partial}d_{i',j ' } } n_{i'',j '' } \\sum_{i ' '' } \\sum_{j ' '' } nw_{i''-i''',j''-j ' '' } d_{i''',j ' '' } \\nonumber \\\\ & = & ~v[d_{i',j ' } ] n_{i'',j '' } nw_{i''-i',j''-j ' } \\nonumber \\\\ & = & ~d_{i',j ' } n_{i'',j '' } nw_{i''-i',j''-j ' } \\nonumber \\,.\\end{aligned}\\ ] ] in the above equations , @xmath325 represents the expectation value of the sampling distribution for @xmath39 ; for a poisson distribution with variance equal to the datum , @xmath325 will be equal to the datum . in the third case ,",
    "we find ( while skipping some steps ) : @xmath326~&=&~\\sum_k \\sum_l \\left(\\frac{{\\partial}b_{1,i',j'}}{{\\partial}d_{k , l}}\\right ) \\left(\\frac{{\\partial}b_{1,i'',j''}}{{\\partial}d_{k , l}}\\right ) v[d_{k , l } ] \\nonumber \\\\ & = & ~\\sum_k \\sum_l n_{i',j ' } nw_{i'-k , j'-l } n_{i'',j '' } nw_{i''-k , j''-l } v[d_{k , l } ] \\nonumber \\\\ & = & ~\\sum_k \\sum_l n_{i',j ' } nw_{i'-k , j'-l } n_{i'',j '' } nw_{i''-k , j''-l } d_{k , l } \\nonumber \\,.\\end{aligned}\\ ] ]    to demonstrate the effect of including covariance terms , we compute @xmath327 $ ] for a 50@xmath16950 subfield of the _ rosat _ pspc pleiades image , with @xmath23 = @xmath24 = 4 pixels . in figure",
    "[ fig : covar ] , we show the ratio @xmath327_{\\rm covar}{\\slash}v[b_2]_{\\rm no covar}$ ] .",
    "we infer the following from this computation : ( 1 ) it is quantitatively unimportant at the location of sources and within voids , where the change in variance is @xmath190 1% ; ( 2 ) in the vicinity of a strong sources , the change in variance is @xmath8 10% ( with maximum",
    "@xmath0 30% for this particular field , in the vicinity of an 800-count source ) , and is affected by source crowding ; and ( 3 ) including covariance terms increases the cpu time needed to compute @xmath327 $ ] by a factor @xmath129 , where @xmath130 and @xmath131 are the x- and y - axis lengths , respectively , in pixels .",
    "snowden , s.  l. , & kuntz , k.  d.  1998 , cookbook for analysis procedures for rosat xrt observations of extended objects and the diffuse background , part i : individual observations ( nasa / gsfc : us rosat science data center )                        , as carried out at selected scales @xmath137 .",
    "parantheses indicate optional input or computations .",
    "the local background map may be estimated or provided by the user ; a flow chart illustrating how it can be iteratively estimated using the input data ( and exposure map ) is given in figure [ fig : bgflow ] . ]      ) , causing  bumps \" if the wavelet scale sizes @xmath328 , the characteristic psf size at a given pixel .",
    "we use a 50@xmath16950 subfield of the _ rosat _ pspc pleiades cluster image in which @xmath329 3 pixels .",
    "top : image and surface plot of the background estimate for @xmath23 = @xmath24 = 1 pixel .",
    "middle : same as top , but for @xmath23 = @xmath24 = 2@xmath178 pixels .",
    "bottom : same as top , but for @xmath23 = @xmath24 = 8 pixels . ]    ) , causing  rings \" if sources are located within the negative annulus of the wavelet .",
    "we use a 50@xmath16950 subfield of the _ rosat _ pspc pleiades cluster image .",
    "top : image and surface plot of the background estimate after one iteration ( i.e.  no  cleansing \" ) .",
    "middle : same as top , but after two iterations .",
    "bottom : same at top , but after three iterations . ]      ) , created by first smoothing the data in a 50@xmath16950 subfield of the _ rosat _ pspc pleiades cluster image with a @xmath31 function of size @xmath23 = @xmath24 = 2 pixels , then subtracting the estimated background .",
    "pixels associated with the strongest local maxima comprise the source cells that are used for source property estimation .",
    "see figures [ fig : scex1 ] and [ fig : scex2 ] . ]",
    "function of size @xmath23 = @xmath24 = 2 pixels , then subtracting the estimated background .",
    "bottom : the source cell defined using the source counts image data (  [ sect : cell ] ) .",
    "this cell , used in the estimation of source properties , contains nearly all , if not all , of the counts from this source . ]",
    "function of size @xmath23 = @xmath24 = 2 pixels , then subtracting the estimated background . bottom : the source cells defined using the source counts image data .",
    "the saddle point seen in the middle image defines the boundary between the cells (  [ sect : cell ] ) . ]",
    "512 pixel image ( image a ) showing a 1-ksec observation by an idealized detector with effective area 1000 @xmath170 , a spatially invariant gaussian psf of width @xmath330 = 2.56 pixels , and an exposure map similar to that of the _ einstein _ ipc (  [ sect : ver1 ] ) . within this image",
    "were placed 42 point and 4 extended sources .",
    "the background is assumed to be locally variable , with amplitude @xmath8 10@xmath176 ct sec@xmath11 pix@xmath11 .",
    "bottom : same as top , except the observation time is 10 ksec ( image b ) . ]      , showing the cells generated in the vicinity of the largest extended source in image b. middle : same as top , except that now the source cells are defined using a source counts image with smoothing size 8@xmath178 pixels instead of 2@xmath178 pixels .",
    "bottom : the normalized count - rate image for the extended source ( and three point sources ) , generated by creating a source counts image with smoothing size 2 pixels , then filtering out all pixels not contained in the source cell shown immediately above .",
    "if this source were a galaxy cluster , the analyst could proceed to fit to these data ( respecting the caveats discussed in ",
    "[ sect : ver1 ] ) . ]     principal axes and rotation angle for each source .",
    "middle left and right : same as top left and right , with only the central 1@xmath3311@xmath332 portion of the image shown .",
    "bottom left and right : same as top left and right , with only the central 30@xmath33330@xmath3 portion of the image shown . note : this is a bitmap image .",
    "the original image may be downloaded from http://hea-www.harvard.edu/~pfreeman/f15.eps.gz . ]    ) via the method of  [ sect : nbkg ] .",
    "the contour levels are 0 , 0.9 , 1.05 , 1.2 , 1.35 , and 1.5 counts , with darker areas having more counts .",
    "since the estimated error in each pixel is @xmath8 0.01 counts , the perceived structure is real and is indicative of x - ray shadowing ( kashyap et al .",
    "2001 , in preparation ) .",
    "note : this is a bitmap image .",
    "the original image may be downloaded from http://hea-www.harvard.edu/~pfreeman/f17.eps.gz . ]",
    "15 pixels .",
    "bottom : ellipses representing the 171 sources detected by our algorithm .",
    "the ellipses , whose sizes are normally set by deriving the 1@xmath7 principal axes and rotation angle for each source , have minimum axis lengths of 10 pixels for greater visual clarity . ]     and @xmath213 are continuous variables describing the wavelet function centered in pixel @xmath64 . the correlation value for pixel @xmath64 is computed by summing the product of the data in pixels @xmath208 and the integral of the wavelet function in those pixels .",
    "the dotted line shows the boundary between the positive kernel @xmath31 and negative annulus @xmath32 of a mexican hat wavelet with @xmath334 1 pixel , while the solid line shows the extent over which the summation is carried out ; beyond this line , the amplitude of wavelet function is @xmath0 0 . ]     for details ) . left : ratio of variances @xmath327_{\\rm",
    "covar}{\\slash}v[b_2]_{\\rm no~covar}$ ] , for a 50@xmath16950 subfield of the _ rosat _ pspc pleiades cluster image , analyzed with a wavelet with scale sizes @xmath23 = @xmath24 = 4 pixels .",
    "light regions have values @xmath0 1 , while dark regions have values up to @xmath0 1.3 .",
    "right : the 50@xmath16950 subfield of the _ rosat _ pspc pleiades image for which the ratio of variances shown at left was computed .",
    "sources in this field correspond with light ( low - amplitude ) regions in the ratio image . ]",
    "ll correlation ( @xmath66 ) & @xmath246 +   + exposure - corrected & @xmath125i + $ ] + correlation ( @xmath110 ) & @xmath335)>_{i , j } + $ ] + & 2 @xmath336)>_{i , j}$ ] + + & @xmath337)>_{i , j}$ ] +   + approximate & @xmath125 + b_{{\\rm norm},i , j } < w^2{\\star}e^2>_{i , j}$ ] + exposure - corrected & + correlation ( @xmath119 ) & +   + normalized background ( @xmath82 ) & @xmath338 + [ tab : sderr ]    lll x location & pix & @xmath339 +   + y location & pix & @xmath340 +   + bkg counts & ct & @xmath341 +   + counts & ct & @xmath342 +   + exposure & varies & @xmath343 +   + count rate & ct @xmath344 exp unit & @xmath345 +   + bkg count rate & ct @xmath344 exp unit & @xmath346 + [ tab : prop ]    lll x location ( @xmath347 ) & pix & @xmath348 +   + y location ( @xmath349 ) & pix & @xmath350 +   + bkg counts ( @xmath351 ) & ct & @xmath352 $ ] +   + counts ( @xmath353 ) & ct & @xmath354 $ ] +   + exposure ( @xmath355 ) & sec & @xmath356 +   + count rate ( @xmath357 ) & ct @xmath344 exp unit & @xmath358 + r_{s , c}^2 v[t_s])$ ] +   + bkg count rate ( @xmath359 ) & ct @xmath344 exp unit & @xmath360 + r_{s , b}^2 v[t_s])$ ] + [ tab : error ]    cccccc 1 & 2 & 10@xmath9 & 2 & fast ( eq .  [ eqn : fastcor ] ) & 129 + 2 & 2 & 10@xmath9 & @xmath178 & fast & 136 + 3 & 3 & 10@xmath9 & 2 & fast & 130 + 4 & 3 & 10@xmath9 & @xmath178 & fast & 137 + 5 & 3 & 10@xmath9 & 2 & full ( eq .  [ eqn : fullcor ] ) & 132 + 6 & 3 & 10@xmath9 & @xmath178 & full & 138 + 7 & 2 & 10@xmath176 & 2 & fast & 144 + 8 & 2 & 10@xmath176 & @xmath178 & fast & 148 + [ tab : numdet ]    lc our algorithm ( test",
    "8) & 148 + damiani et al .",
    "( 1997b ) & 150 + micela et al .",
    "( 1996 ) & 99 + wgacat & 127 + mpe & 100 +   + common to : +  all methods & 81 +  our algorithm & wgacat & 27 +  our algorithm & mpe & 12 +  wgacat & mpe & 3 +  our algorithm only & 28 +  wgacat only & 16 +  mpe only & 4 + [ tab : compare ]"
  ],
  "abstract_text": [
    "<S> wavelets are scaleable , oscillatory functions that deviate from zero only within a limited spatial regime and have average value zero , and thus may be used to simultaneously characterize the shape , location , and strength of astronomical sources . </S>",
    "<S> but in addition to their use as source characterizers , wavelet functions are rapidly gaining currency within the source detection field . </S>",
    "<S> wavelet - based source detection involves the correlation of scaled wavelet functions with binned , two - dimensional image data . </S>",
    "<S> if the chosen wavelet function exhibits the property of vanishing moments , significantly non - zero correlation coefficients will be observed only where there are high - order variations in the data ; e.g. , they will be observed in the vicinity of sources . </S>",
    "<S> source pixels are identified by comparing each correlation coefficient with its probability sampling distribution , which is a function of the ( estimated or _ a priori_-known ) background amplitude .    in this paper </S>",
    "<S> , we describe the mission - independent , wavelet - based source detection algorithm wavdetect , part of the freely available _ chandra interactive analysis of observations ( ciao ) _ software package . </S>",
    "<S> our algorithm uses the marr , or  </S>",
    "<S> mexican hat \" wavelet function , but may be adapted for use with other wavelet functions . </S>",
    "<S> aspects of our algorithm include : ( 1 ) the computation of local , exposure - corrected normalized ( i.e.  flat - fielded ) background maps ; ( 2 ) the correction for exposure variations within the field - of - view ( due to , e.g. , telescope support ribs or the edge of the field ) ; ( 3 ) its applicability within the low - counts regime , as it does not require a minimum number of background counts per pixel for the accurate computation of source detection thresholds ; ( 4 ) the generation of a source list in a manner that does not depend upon a detailed knowledge of the point spread function ( psf ) shape ; and ( 5 ) error analysis . </S>",
    "<S> these features make our algorithm considerably more general than previous methods developed for the analysis of x - ray image data , especially in the low count regime . </S>",
    "<S> we demonstrate the robustness of wavdetect by applying it to an image from an idealized detector with a spatially invariant gaussian psf and an exposure map similar to that of the _ einstein _ ipc ; to pleiades cluster data collected by the _ rosat _ </S>",
    "<S> pspc ; and to simulated _ chandra _ acis - i image of the lockman hole region . </S>"
  ]
}