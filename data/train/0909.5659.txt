{
  "article_text": [
    "+   +    the numerical solution of hamiltonian problems is a relevant issue of investigation since many years : we refer to the recent monographs @xcite for a comprehensive description of this topic , and to the references therein .    in a certain sense ,",
    "the use of a numerical method acts as introducing a small perturbation in the original system which , in general , destroys all of its first integrals .",
    "the study of the preservation of invariant tori in the phase space of nearly integrable hamiltonian systems has been a central theme in the research since the pioneering work of poincar , the final goal being to asses the stability of the solar system . from a numerical point of view",
    ", results in this respect are still poor , and this is justified by considering the delicacy of the problem : as testified by kam theory , even small hamiltonian perturbations of completely integrable systems , do not prevent the disappearance of most of the tori , unless a diophantine condition on the frequencies of the unperturbed system is satisfied .    at the times",
    "when research on this topic was started , there were no available numerical methods possessing such conservation features .",
    "a main approach to the problem was the devising of symplectic methods .",
    "however , though the numerical solution generated by symplectic ( and/or symmetric ) methods shows some interesting long - time behavior ( see , for example , ( * ? ? ?",
    "* theorems x.3.1 and xi.3.1 ) ) , it was observed that symplecticity alone can only assure , at most , the conservation of quadratic hamiltonian functions , unless they are coupled with some projection procedure . in the general case ,",
    "conservation can not be assured , even though a quasi - preservation can be expected for reversible problems , when symmetric methods are used ( see , e.g. , @xcite ) . on the other hand , a numerical `` drift '' can be sometimes observed in the discrete solution @xcite .",
    "one of the first successful attempts to solve the problem of loss of conservation of the hamiltonian function by the numerical solution , is represented by _ discrete gradient methods _ ( see @xcite and references therein ) .",
    "purely algebraic approaches have been also introduced ( see , e.g. , @xcite ) , without presenting any energy - preserving method .",
    "a further approach was considered in @xcite , where the _ averaged vector field method _ was proposed and shown to conserve the energy function of canonical hamiltonian systems . as was recently outlined ( see @xcite ) , approximating the integral appearing in such method by means of a quadrature formula ( based upon polynomial interpolation ) yields a family of second order runge - kutta methods .",
    "these latter methods represent an instance of energy - preserving runge - kutta methods for polynomial hamiltonian problems : their first appearance may be found in @xcite , under the name of _ @xmath1-stage trapezoidal methods_. additional examples of fourth and sixth - order runge - kutta methods were presented in @xcite and @xcite .    in @xcite ,",
    "the derivation of such energy preserving runge - kutta formulae relies on the definition of the so called `` discrete line integral '' , first introduced in @xcite .",
    "however , a comprehensive analysis of such methods has not been carried out so far , so that their properties were not known and , moreover , their practical construction was difficult .",
    "in this paper we provide such an analysis , which allows us to derive symmetric methods , of arbitrarily high order , able to preserve hamiltonian functions of polynomial type , of any specified degree .",
    "such methods are here named _",
    "hamiltonian boundary value methods ( hbvms ) _",
    ", since the above approach has been , at first , studied ( see , e.g. , @xcite ) in the framework of _ block boundary value methods_. the latter are block one - step methods @xcite .",
    "however , for the sake of clarity , and later reference , the equivalent runge - kutta formulation of hbvms will be here also considered .    in the remaining part of this section ,",
    "we introduce the background information concerning the approach .",
    "let then    @xmath2    be a hamiltonian problem in canonical form , where , by setting as usual @xmath3 the identity matrix of dimension @xmath4 , @xmath5    and where the hamiltonian function , @xmath6 , is a polynomial of degree @xmath7 .",
    "it is well known that , for any @xmath8 , @xmath9    where @xmath10 \\rightarrow r^{2m}$ ] is any smooth function such that @xmath11    in particular , over a trajectory , @xmath12 , of ( [ hampro ] ) , one has @xmath13    due to the fact that matrix @xmath14 in ( [ j ] ) is skew - symmetric .",
    "here we consider the case where @xmath15 is a polynomial of degree @xmath1 yielding an approximation to the true solution @xmath12 in the time interval @xmath16 $ ] which , without loss of generality , is hereafter normalized to @xmath17 $ ] .",
    "more specifically , given the @xmath18 abscissae @xmath19 and the approximations @xmath20 , @xmath15 is meant to be defined by the interpolation conditions @xmath21    actually , the approximations @xmath22 will be unknown , until the new methods will be fully derived .",
    "a different , though related concept , is that of collocating polynomial for the problem , at the abscissae ( [ ci ] ) .",
    "such a polynomial is the unique polynomial @xmath23 , of degree @xmath18 , satisfying @xmath24    it is well known that ( [ coll ] ) define a runge - kutta _",
    "collocation method_. moreover , the set of abscissae ( [ ci ] ) defines a corresponding quadrature formula with weights @xmath25    which has degree of precision ranging from @xmath1 to @xmath26 , depending on the choice of the abscissae ( [ ci ] ) .",
    "in particular , the highest precision degree is obtained by using the lobatto abscissae , which we shall consider in the sequel .",
    "the underlying collocation method has , then , order @xmath27 .",
    "[ rs ] choosing a gauss distribution of the abscissae @xmath28 raises the degree of precision of the related quadrature formula to @xmath29 .",
    "in such a case , it is interesting to observe that applying ( [ hy ] ) along the trajectory @xmath23 and exploiting the collocation conditions , one gets @xmath30    where @xmath31 is the error in the approximation of the line integral .",
    "therefore , @xmath32 if and only if @xmath33 , which is implied by assuming that the quadrature formula with abscissae @xmath28 and weights @xmath34 is exact when applied to the integrand @xmath35 .",
    "however , since the integrand has degree @xmath36    it follows that the maximum allowed value for @xmath7 is 2 .",
    "indeed , it is well known that quadratic invariants are preserved by symmetric collocation methods . on the other hand , when @xmath37 , in general @xmath31 does not vanish , so that @xmath38 .",
    "the above remark gives us a hint about how to approach the problem .",
    "note that in demanding that each term of the sum representing the quadrature formula is null ( i.e. , the conditions ( [ coll ] ) ) , is an excessive requirement to obtain the conservation property , which causes the observed low degree of precision . a weaker assumption , that would leave the result unchanged , is to relax conditions so as to devise a method whose induced quadrature formula , evaluated on a suitable line integral that links two successive points of the numerical solution , is exact and , at the same time , makes the corresponding sum vanish , without requiring that each term is zero . ,",
    "which resemble a sort of _ extended collocation condition _",
    "( see also ( * ? ? ?",
    "* section2 ) ) since @xmath39 brings information from the global behavior of the problem in the time interval @xmath16 $ ] ( see  in section  [ colloc ] and the analogues in section [ derive ] ) . ]",
    "if we use @xmath15 instead of @xmath23 , the integrand function in has degree @xmath40 so that , in order for the quadrature formula to be exact , one would need say , @xmath41 points , where @xmath42    if the corresponding lobatto abscissae are used . of course , in such a case , the vanishing of the quadrature formula is no longer guaranteed by conditions and must be obtained by a different approach . for this purpose ,",
    "let @xmath43    be the number of the required additional points , and let @xmath44    be @xmath45 additional abscissae distinct from ( [ ci ] ) .",
    "moreover , let us define the following _ silent stages _",
    "@xcite , @xmath46    consequently , the polynomial @xmath15 , which interpolates the couples @xmath47 , @xmath48 , also interpolates the couples @xmath49 , @xmath50 .",
    "that is , @xmath15 interpolates at @xmath41 points , even though it has only degree @xmath1 .",
    "if we define the abscissae @xmath51    and dispose them according to a lobatto distribution in @xmath17 $ ] in order to get a formula of degree @xmath52 , we have that @xmath53    and , consequently , the conservation condition becomes @xmath54    where , now , @xmath55    the left - hand side of is called `` discrete line integral '' because , as will be clear in the sequel , the choice of the path @xmath15 is dictated by the numerical method by which we will solve problem ( see @xcite for details ) .    with these premises , in section  [ derive ] ,",
    "we devise such a method , able to fulfill ( [ intexk ] ) , after having set some preliminary results in section  [ colloc ] . before that , in section  [ legendre ] we state a few facts and notations concerning the shifted legendre polynomials , which is the framework that we shall use to carry out the analysis of the methods .",
    "a few numerical tests are then reported in section  [ tests ] and , finally , a few conclusions are given in section  [ fine ] .",
    "for sake of completeness , some properties of shifted legendre polynomials are listed in the appendix .",
    "the _ shifted legendre polynomials _ , in the interval @xmath17 $ ] , constitute a family of polynomials , @xmath56 , for which a number of known properties , named * p1**p12 * , are reported in the appendix .",
    "we now set some notations and results , to be used later .",
    "with reference to the abscissae ( [ ci ] ) , let : @xmath57 @xmath58 @xmath59    [ ris ] observe that , from * p11 * , one obtains : @xmath60    furthermore , we set : @xmath61 @xmath62 and @xmath63 by virtue of * p3 * and * p9 * , we deduce that @xmath64,\\qquad j=1,\\dots , s,\\ ] ] and @xmath65    [ gram ] the matrix @xmath66 is nonsingular .",
    "moreover @xmath67 with @xmath68 a nonsingular matrix .",
    "@xmath69 is the transpose of the gramian matrix defined by the linearly independent polynomials @xmath70 at the distinct abscissae @xmath71 and is , therefore , nonsingular .",
    "the structure of @xmath72 follows from ( [ is ] ) .",
    "the matrix @xmath73 is nonsingular since , from ( [ intgram ] ) , @xmath69 is nonsingular , and @xmath74 .",
    "in this section we deliberately do not care of the exactness of the discrete line integral , as stated by , and in fact we choose @xmath75 ( and hence @xmath76 , @xmath77 ) .",
    "we show that imposing the vanishing of the discrete line integral ( condition ) leads to the definition of the classical lobatto iiia methods .",
    "the reason why we consider this special situation is that the technique that we are going to exploit is easier to be explained , but at the same time is straightforwardly generalizable to the case @xmath78 . as a by - product",
    ", we will gain more insight about the link between the new methods and the lobatto iiia class .",
    "for example , we will deduce that lobatto iiia methods ( and , in general , all collocation methods ) may be defined by means of a polynomial @xmath15 of degree not larger than that of the collocation polynomial @xmath23 ( indeed , in the present case , @xmath79 ) .    to begin with ,",
    "let us consider the following expansion of @xmath80 : @xmath81    where the ( vector ) coefficients @xmath82 are to be determined .",
    "then , ( [ intexk ] ) becomes @xmath83    which will clearly hold true , provided that the following set of orthogonality conditions are satisfied : @xmath84    where @xmath85 are suitable scaling factors .",
    "we now impose that the polynomial @xmath86    satisfies ( [ yi ] ) . by setting @xmath87    one obtains ( see ( [ ij])([integ ] ) ) @xmath88    consequently , @xmath89\\otimes i_{2m}\\ , \\hbfy.\\ ] ]    on the other hand , the vector form of relations ( [ ortcon ] ) reads @xmath90    where @xmath91 and @xmath92    since @xmath93 contains free parameters , we set @xmath94    comparing and , we arrive at the following block method , where now @xmath95 denotes , in general , the used stepsize , @xmath96    with ( see ( [ integ ] ) ) @xmath97    the following noticeable result holds true .",
    "[ ordth ] each row of the block method ( [ ab])-([abeq ] ) defines a lmf of order @xmath18 .",
    "the last row corresponds to the lobatto quadrature formula of order @xmath27 .    for the first part of the proof , it suffices to show that the method is exact for polynomials of degree @xmath18 . clearly , it is exact for polynomials of degree 0 , due to the form of the matrix @xmath0 .",
    "we shall then prove that @xmath98 , that is ( see ( [ ij ] ) , ( [ i ] ) , and ( [ abeq ] ) ) , @xmath99 . by virtue of ( [ abeq ] ) , ( [ orto ] ) , and ( [ is ] ) , we have @xmath100 = \\left[\\ci_{s-1}~\\bfi_s\\right ] = \\ci_s,\\ ] ] which completes the first part of the proof . for the second part",
    ", one has to show , by setting as usual @xmath101 the @xmath102th unit vector , that @xmath103    the vector containing the coefficients of the quadrature formula . from ( [ abeq ] ) , exploiting property * p7 * ( see also ( [ g ] ) )",
    ", we obtain @xmath104    as an immediate consequence , the following result follows .",
    "[ collcor ] the block method ( [ ab])-([abeq ] ) collocates at the lobatto abscissae ( [ ci ] ) and has global order @xmath27 .",
    "the proof follows from known results about collocation methods ( see , e.g. , ( * ? ? ?",
    "* theorem  ii.1.5 ) ) .",
    "[ lobattoiiia ] in conclusion , the method corresponding to the pencil @xmath105 , as defined by ( [ abeq ] ) , is nothing but the lobatto iiia method of order @xmath27 .",
    "an important consequence of theorem [ ordth ] and corollary [ collcor ] is that the lobatto iiia method of order @xmath27 may be also defined by means of an underlying polynomial , namely @xmath106 , of degree @xmath1 instead of @xmath18 , as is the collocation polynomial associated with the method .",
    "the main aim of the present subsection is to elucidate the relation between these two polynomials . in what follows ,",
    "we deliberately ignore the result obtained in theorem [ ordth ] and corollary [ collcor ] , so as to provide , among other things , an alternative proof of part of the statements they report",
    ". turns out to be crucial to deduce the new methods presented in the next section . ]",
    "let @xmath107 be the polynomial ( [ coll ] ) ( of degree @xmath18 ) that collocates problem at the abscissae ( [ ci ] ) .",
    "the expansion of @xmath108 along the shifted legendre polynomials basis reads @xmath109    consequently , by setting @xmath110   \\zeta_{s}\\endpmatrix,\\ ] ]    one obtains that ( [ coll ] ) may be recast in matrix notation as @xmath111 , or @xmath112    we get the expression of @xmath107 by integrating both sides of ( [ udot ] ) on the interval @xmath113 $ ] : @xmath114    by virtue of property * p11 * , we get @xmath115    setting @xmath116 ,  @xmath117 , @xmath118 , and @xmath119 , allows us to recast ( [ uci ] ) in matrix form",
    ". this is done by exploiting a similar argument used to get ( [ inter ] ) starting from ( [ expan1 ] ) : @xmath120 \\right ) \\otimes i_{2 m } \\bhzeta .",
    "\\label{uci1}\\end{aligned}\\ ] ]    inserting ( [ collocation1 ] ) into ( [ uci1 ] ) , and exploiting ( [ orto ] ) , yields @xmath121 \\hp_s^{-1 }   \\otimes i_{2 m }   \\hbfg = \\frac{1}{2 } \\p_s g_s \\hp_{s-1}^{t } \\omega \\otimes i_{2 m }    \\hbfg \\\\&= & b \\otimes i_{2 m } \\hbfg.\\end{aligned}\\ ] ]    thus , the collocation problem ( [ coll ] ) defines the very same method arising from the polynomial @xmath106 ( see ( [ ab])([abeq ] ) ) with @xmath122 .",
    "this implies that system ( [ ab ] ) is a collocation method defined on the lobatto abscissae @xmath123 , @xmath77 , ( therefore , a lobatto iiia method ) , and provides an alternative proof of corollary [ collcor ] .",
    "in particular , we deduce that @xmath124    it follows that ( [ uc ] ) becomes @xmath125    and , after differentiating , @xmath126    we can obtain the expression of the unknown @xmath127 by imposing a collocation condition at any of the abscissae @xmath123 .",
    "for example , choosing @xmath128 , yields @xmath129    this latter expression can be slightly simplified by considering that :    * @xmath130 , which comes from the fact that the system @xmath131 has solution @xmath132 ( the nonsingularity of @xmath133 being assured by lemma  [ gram ] ) ; * from ( [ gammay ] ) and ( [ ab])([abeq ] ) , one has @xmath134",
    "thus , from ( [ zs ] ) we get @xmath135 \\hp_{s}^{-1 } \\otimes i_{2 m } \\hbff = e_{s+1}^t \\hp_{s}^{-1 } \\otimes i_{2 m } \\hbff.\\ ] ]    the remaining collocation conditions , @xmath136 , are clearly satisfied since the collocation polynomial @xmath107 is uniquely identified by the @xmath137 linearly independent conditions in ( [ coll ] ) .",
    "nonetheless , they can be easily checked after observing that , from ( [ usig ] ) , ( ii ) , and ( [ zeta_last ] ) , @xmath138    therefore , from ( [ udot ] ) , ( [ collocation1 ] ) , and ( [ usig ] ) , one obtains , @xmath139    that is ( see ( [ ff ] ) ) ,   @xmath140 ,   @xmath77 .",
    "the arguments for deriving the methods in the general case where @xmath141 ( which makes the discrete line integral exact ) are a straightforward extension of what stated above .",
    "in particular , let us consider again the expansion ( [ expan])([expan1 ] ) of the polynomial @xmath106 .",
    "then , condition ( [ intexk ] ) can be recast as ( compare with ( [ orto0 ] ) ) @xmath142    which will clearly hold true , provided that the following set of orthogonality conditions are satisfied ( compare with ( [ ortcon ] ) , see also ( [ bik ] ) ) : @xmath143    where @xmath85 are suitable scaling factors . according to ( [ gamma ] ) ,",
    "we choose them as @xmath144 , @xmath145 .",
    "the vector @xmath146 ( see ( [ y ] ) ) is then obtained by imposing that the polynomial @xmath106 in ( [ expan1 ] ) satisfies the interpolation constrains ( [ yi ] ) and ( [ hyi ] ) . in so doing ,",
    "one obtains a block method characterized by the pencil @xmath105 , where the two @xmath147 matrices @xmath0 and @xmath148 are defined as follows . in order to simplify the notation , we shall use a `` matlab - like '' notation : let @xmath149 and @xmath150 be the vectors whose entries are the indexes of the main abscissae @xmath151 in ( [ ci ] ) and of the silent ones @xmath152 in ( [ hci ] ) , respectively , within the lobatto abscissae @xmath153 , as defined in ( [ ti ] ) .",
    "then , the orthogonality conditions ( [ ortcon1 ] ) will define the first @xmath1 rows of @xmath0 and @xmath148 ( compare with ( [ abeq ] ) ) : @xmath154    where ( see ( [ i])([dom ] ) and ( [ ti ] ) ) @xmath155    and ( see ( [ bi ] ) ) @xmath156    on the other hand , the interpolation conditions for the silent stages ( [ hyi ] ) define the last @xmath45 rows of the matrix @xmath0 ( the corresponding rows of @xmath148 are obviously zero ) : @xmath157 - \\bar{e}\\cdot e_1^t,\\end{aligned}\\ ] ]    where @xmath158 is the identity matrix of dimension @xmath45 , @xmath159 , @xmath160 is the first unit vector ( of dimension @xmath18 ) , and @xmath161    the following result generalizes theorem  [ ordth ] to the present setting ( the proof being similar ) .",
    "[ ordth1 ] each row of the block method ( [ hbvmks])([hbvmks1 ] ) defines a lmf of order at least @xmath1 .",
    "the @xmath1-th row corresponds to the lobatto quadrature formula of order @xmath52 .",
    "we call the method defined by the pencil @xmath105 in ( [ hbvmks])([hbvmks1 ] ) a _ `` hamiltonian bvm with @xmath162 steps and degree @xmath1 '' _ , hereafter _",
    "hbvm(@xmath162,@xmath1)_. perfectly fits the framework of block bvms ( see , e.g. , @xcite ) . ]",
    "the structure of the nonlinear system associated with the hbvm@xmath163 is better visualized by performing a permutation of the stages that splits , into two block sub - vectors , the fundamental stages and the silent ones .",
    "more precisely , the permuted vector of stages , say @xmath164 , is required to be : @xmath165^t \\equiv [ y_0^t , \\bfy^t,\\bfw^t]^t .",
    "\\\\ \\hspace*{.5 cm } \\mbox{\\footnotesize fundamental stages } \\hspace*{.5 cm } \\mbox{\\footnotesize silent stages } \\end{array}\\ ] ] this is accomplished by introducing the permutation matrices @xmath166 and @xmath167 , such that @xmath168 it is easy to realize that @xmath169 where @xmath170 $ ] coincides with @xmath171 in , while @xmath172 $ ] matches the matrix @xmath173 in .",
    "the hbvm@xmath163 then takes the form : @xmath174 the presence of the null blocks in the lower part of @xmath175 clearly suggests that the ( generally nonlinear ) system of ( block ) size @xmath162 is actually equivalent to a system having ( block ) size @xmath1 .",
    "indeed , we can easily remove the silent stages , @xmath176 and obtain @xmath177 we refer to @xcite for an alternative technique to reduce the dimension of system .",
    "[ rk ] as was shown in the previous section , when @xmath75 , the hbvm(@xmath1,@xmath1 ) coincides with the lobatto iiia method of order @xmath27 .",
    "more in general , for @xmath141 , by summing up ( [ hbvmks])([hbvmks1 ] ) , we can cast hbvm@xmath163 as a runge - kutta method with the following tableau : @xmath178 where @xmath179 we observe that the @xmath180 matrix @xmath181 appearing in ( [ tableau ] ) has rank @xmath1 , thus confirming that the computational cost per iteration depends on @xmath1 , rather than on @xmath162 ( see @xcite for more details and a practical example of butcher tableau concerning the method hbvm(6,2 ) ) .    by the way",
    ", we observe that , when @xmath182 , hbvm@xmath183 are nothing but the `` @xmath1-stage trapezoidal methods '' , defined in @xcite , based on the lobatto abcissae .",
    "in such a case , the matrix @xmath184 becomes @xmath185 similarly , for @xmath186 and @xmath187 , hbvm(4,2 ) coincides with the fourth - order method presented in ( * ? ? ?",
    "* section4.2 ) , able to preserve polynomial hamiltonians of degree four .    concerning the order of convergence , the following result generalizes that of corollary  [ collcor ]",
    ".    [ ordine ] the hbvm(@xmath162,@xmath1 ) ( [ hbvmks])([hbvmks1 ] ) has order of convergence @xmath188 .    by virtue of theorem  [ ordth1 ] , the corresponding runge - kutta method ( [ tableau ] )",
    "satisfies the usual simplifying assumptions @xmath189 and @xmath190 .",
    "if we are able to prove @xmath191 , from the classical result of buthcher ( see , e.g. , ( * ? ?",
    "* theorem5.1 ) ) , it will follow that the method has order @xmath188 . with reference to ( [ tableau ] ) , the condition @xmath191 can be cast in matrix form , by introducing the vectors @xmath192 , @xmath193 , and the matrices @xmath194 as @xmath195 i.e. ,    @xmath196    since the quadrature is exact for polynomials of degree @xmath197 , one has    @xmath198    where the last equality is obtained by integrating by parts , with @xmath199 the kronecker symbol .",
    "consequently , @xmath200 that is , ( [ finito ] ) , where the last equality follows from the fact that @xmath201    an additional , remarkable property of such methods is gained , provided that the abscissae @xmath202 ( [ ti ] ) are symmetrically distributed ( as is the case of the lobatto abscissae here considered ) . for this purpose , we need to introduce some notations and preliminary results .",
    "let us define the matrix @xmath203    which , when applied to a vector of length @xmath204 , reverses the order of its entries .",
    "we also set @xmath205    the following preliminary result holds true .",
    "[ sim1 ] if the abscissae ( [ ti ] ) are symmetric , then matrix ( [ c ] ) satisfies : @xmath206    from the symmetry of the abscissae it easily follows that ( see ( [ bik ] ) and ( [ barom ] ) ) @xmath207 from property * p6 * , we have that ( see ( [ bps1 ] ) ) @xmath208    moreover , by considering that ( see ( [ ci]))@xmath209 again from * p6 * we see that @xmath210 finally , from ( [ c ] ) we obtain @xmath211    as a consequence , we have the following result .",
    "[ simmetrico ] if the abscissae ( [ ti ] ) are symmetric , then the method ( [ hbvmks])([hbvmks1 ] ) ( i.e. , ( [ tableau ] ) ) is symmetric , that is , it is self - adjoint .",
    "indeed , the discrete solution , @xmath212 , satisfies the equation ( see ( [ tableau])([c ] ) and ( [ lf ] ) ) @xmath213    considering that @xmath214 and , from lemma  [ sim1 ] , @xmath215 , one then obtains @xmath216 the thesis then follows by observing that the vector @xmath217 contains the time - reversed discrete solution .",
    "the next theorem summarizes the results about hbvm@xmath163 .",
    "[ main ] for all @xmath218 , and @xmath141 , the hbvm(@xmath162,@xmath1 ) method :    1 .",
    "has order of accuracy @xmath27 ; 2 .",
    "is energy - preserving for polynomial hamiltonians of degree not larger than @xmath219 ; 3 .   for general @xmath220 hamiltonians ,",
    "the energy error at each integration step is @xmath221 , if @xmath95 is the used stepsize;. ] 4 .",
    "is symmetric and , therefore , precisely @xmath0-stable .",
    "item 1 follows from corollary  [ ordine ] .",
    "item 2 follows from the fact that , for such polynomial hamiltonians , the vanishing discrete line integral equals the continuous line integral ( see ( [ exactness ] ) and ( [ intexk ] ) ) .",
    "similarly , item 3 follows from the fact that , by using arguments similar to those used in remark  [ rs ] ( see ( [ intex ] ) ) , the energy error per integration step equals the quadrature error of the gauss - lobatto formula of order @xmath52 .",
    "finally , item 4 follows from theorem  [ simmetrico ] , since the lobatto abscissae @xmath222 are symmetrically distributed .    from the result of theorem  [ main ]",
    ", we can then concude that hbvm@xmath163 is optimal , both from the point of view of the order and stability properties .",
    "moreover , its computational cost , as observed in remarks  [ snotk ] and [ rk ] , is seen to depend on @xmath1 , rather than on @xmath162 .",
    "we here report a few numerical tests , in order to show the potentialities of hbvm@xmath163 .",
    "let then consider , at first , the hamiltonian problem characterized by the polynomial hamiltonian ( 4.1 ) in @xcite , @xmath223    having degree @xmath224 , starting at the initial point @xmath225 .",
    "for such a problem , in @xcite it has been experienced a numerical drift in the discrete hamiltonian , when using the fourth - order lobatto iiia method with stepsize @xmath226 .",
    "this is confirmed by the plot in figure  [ faoufig ] , where a linear drift in the numerical hamiltonian is clearly observable . on the other hand , by using the fourth - order hbvm(6,2 ) with the same stepsize , the drift disappears , as shown in figure  [ faoufig1 ] , since such method exactly preserves polynomial hamiltonians of degree up to 6 .",
    "moreover , the order of convergence @xmath227 is ( numerically ) confirmed by the results listed in table  [ tab1 ] , where the used stepsizes @xmath95 , the maximum estimated error ( obtained as the difference of two consecutive solutions ) , and the estimated order of convergence are listed .",
    "fourth - order hbvm(6,2 ) method , @xmath226 , problem ( [ fhp]).,scaledwidth=90.0% ]     fourth - order hbvm(6,2 ) method , @xmath226 , problem ( [ fhp]).,scaledwidth=90.0% ]    the second test problem is the fermi - pasta - ulam problem ( see ( * ? ? ?",
    "* sectioni.5.1 ) ) , defined by the hamiltonian @xmath228    with @xmath229 , @xmath230 , @xmath231 , and starting vector @xmath232 in such a case , the hamiltonian function is a polynomial of degree 4 , so that the fourth - order hbvm(4,2 ) method , which is used with stepsize @xmath233 , is able to exactly preserve the hamiltonian , as confirmed by the plot in figure  [ fpufig1 ] , whereas the fourth - order lobatto iiia method provides the result plotted in figure  [ fpufig ] .",
    "moreover , in table  [ tab2 ] we list corresponding results as in table  [ tab1 ] , again confirming the fourth - order convergence .",
    "fourth - order hbvm(4,2 ) method , @xmath233 , problem ( [ fpu]).,scaledwidth=90.0% ]     fourth - order hbvm(4,2 ) method , @xmath233 , problem ( [ fpu]).,scaledwidth=90.0% ]    .[tab3 ] numerical order of convergence for the hbvm(6,2 ) method , problem ( [ biot ] ) . [ cols=\"^,<,<,<,<,<\",options=\"header \" , ]     in the previous examples , the hamiltonian function was a polynomial . nevertheless ,",
    "as is easily argued from theorem  [ main ] , hbvm(@xmath162,@xmath1 ) are expected to produce a _",
    "practical _ conservation of the energy when applied to systems defined by a non - polynomial hamiltonian function which are sufficiently differentiable . as an example",
    ", we consider the motion of a charged particle in a magnetic field with biot - savart potential .",
    "it is defined by the hamiltonian @xmath234,\\nonumber\\end{aligned}\\ ] ]    with @xmath235 , @xmath236 , @xmath4 is the particle mass , @xmath237 is its charge , and @xmath238 is the magnetic field intensity . we have used the values @xmath239with starting point @xmath240    in figure  [ biotfig0 ] , the trajectory of the particle in the interval @xmath241 $ ] is plotted in the phase space . as one can see , it is a helix that wings downward . by using the fourth - order lobatto iiia method with stepsize @xmath242 , a drift in the numerical hamiltonian",
    "can be again observed ( see figure  [ biotfig ] ) , so that the method does introduce a friction .",
    "when using the hbvm(4,2 ) method with the same stepsize , the drift disappears and the hamiltonian turns out to be almost preserved ( see figure  [ biotfig1 ] ) .",
    "as expected , the result improves if we increase @xmath162 : the plot in figure  [ biotfig2 ] has been obtained by using the hbvm(6,2 ) , from which one realizes that a practical preservation of the hamiltonian is reached .",
    "finally , the data listed in table  [ tab3 ] confirm the fourth - order convergence of the latter method .",
    "fourth - order lobatto iiia method , @xmath242 , problem ( [ biot]).,scaledwidth=90.0% ]     fourth - order lobatto iiia method , @xmath242 , problem ( [ biot]).,scaledwidth=90.0% ]     fourth - order hbvm(6,2 ) method , @xmath242 , problem ( [ biot]).,scaledwidth=90.0% ]     fourth - order hbvm(6,2 ) method , @xmath242 , problem ( [ biot]).,scaledwidth=90.0% ]",
    "in this paper a new class of numerical methods , able to preserve polynomial hamiltonians , has been studied in details . from the analysis",
    ", it turns out that such methods can be regarded as a generalization of collocation runge - kutta lobatto iiia methods .",
    "nevertheless , the fact of being characterized by a matrix pencil , perfectly fits the framework of block bvms , so that we have named them hamiltonian bvms ( hbvms ) .",
    "a number of numerical tests prove their effectiveness in preserving the hamiltonian function when evaluated along the numerical solution , as well as confirm the predicted order of convergence .",
    "possible different choices of the abscissae , as well as the actual efficient implementation of the methods , will be the subject of future investigations .",
    "we wish to thank prof.mario trigiante for providing us with problem ( [ biot ] ) .",
    "we are grateful to ernst hairer , for his comments on the proof of corollary  [ ordine ] .",
    "we also thank the referees , for their useful comments and suggestions .",
    "a number of useful properties of shifted legendre polynomials are here summarized : for their proof see any book on special functions ( e.g. , @xcite ) .",
    "lobatto quadrature : the lobatto abscissae @xmath28 ( [ ci ] ) , of the formula of degree @xmath27 , are the zeros of the polynomial @xmath246 where @xmath247 denotes the derivative of @xmath248 .",
    "the corresponding weights ( [ bi ] ) are given by : @xmath249 which are , therefore , all positive ."
  ],
  "abstract_text": [
    "<S> one main issue , when numerically integrating autonomous hamiltonian systems , is the long - term conservation of some of its invariants , among which the hamiltonian function itself . </S>",
    "<S> for example , it is well known that classical symplectic methods can only exactly preserve , at most , quadratic hamiltonians . in this paper , a new family of methods , called _ hamiltonian boundary value methods ( hbvms ) _ , is introduced and analyzed . </S>",
    "<S> hbvms are able to _ exactly _ preserve , in the discrete solution , hamiltonian functions of polynomial type of arbitrarily high degree . </S>",
    "<S> these methods turn out to be symmetric , precisely @xmath0-stable , and can have arbitrarily high order . </S>",
    "<S> a few numerical tests confirm the theoretical results .    </S>",
    "<S> example.eps gsave newpath 20 20 moveto 20 220 lineto 220 220 lineto 220 20 lineto closepath 2 setlinewidth gsave .4 setgray fill grestore stroke grestore </S>"
  ]
}