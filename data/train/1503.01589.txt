{
  "article_text": [
    "structural nested models ( snms ) were designed in part to deal with confounding by variables affected by treatment ( @xcite ) .",
    "the problem arises when one is interested in estimating the joint effect of a sequence of treatments in the presence of a variable @xmath0 with three characteristics , depicted in figure  [ fig1 ] :    1 .",
    "it is independently associated with the outcome @xmath1 of interest .",
    "this can happen because ( a ) it is a direct cause of the outcome , or because ( b ) it shares unmeasured common causes with the outcome of interest .",
    "2 .   it predicts subsequent levels ( @xmath2 ) of the treatment ; 3 .",
    "it is affected by earlier treatment ( @xmath3 ) .    as a motivating example , consider an observational study of the effect of erythropoietin alpha ( epo ) on mortality in a population with end - stage renal disease ( esrd ) receiving hemodialysis .",
    "patients on dialysis tend to be anemic , as commonly measured via hematocrit ( hct ) or hemoglobin levels .",
    "epo is used to treat the anemia and stimulate the body s production of red blood cells ; hct ( @xmath0 ) thus satisfies covariate characteristic 3 .",
    "furthermore , patients with more severe anemia ( lower hct ) typically receive higher doses of epo ( characteristic 2 ) , and sicker patients tend to be more anemic [ characteristic 1(b ) ] .",
    "both these characteristics 1 and 2 make hct a confounder of the effect of later treatment , requiring adjustment to estimate the effect of epo @xmath4 .",
    "observational studies of the effect of extended epo dosing on mortality will thus be characterized by confounding by a variable ( hct ) affected by treatment .        in settings like the above , where the interest lies in estimating the joint effect of a sequence of treatments , standard methods which attempt to estimate these effects simultaneously ( e.g. , regression of @xmath1 on @xmath5 and @xmath4 or some function of both ) will be inappropriate , whether or not one adjusts for or conditions on the confounder @xmath0 .",
    "characteristics 1(a ) and 3 make hct ( @xmath0 ) an intermediate variable on the pathway from early epo treatment @xmath5 to outcome @xmath1 ; adjustment for it blocks the path @xmath6 , making it impossible to find the part of the effect of early epo treatment ( @xmath5 ) mediated by hct . characteristics 1(b ) and 3 make hct ( @xmath0 ) a so - called collider ( @xcite ) on the path @xmath7 ; conditioning on or adjusting for it induces associations between @xmath5 and @xmath1 even if no effect of @xmath3 on @xmath1 exists .    over an extended period of time , james robins ( with some help from collaborators ) introduced three basic approaches for dealing with such confounding : the parametric g - formula ( @xcite ) , structural nested models ( @xcite ; @xcite ) with the associated method of g - estimation and marginal structural models ( robins , hernan and brumback , @xcite ) with the associated method of inverse probability of treatment weighting . as we will argue throughout this paper , snms and g - estimation are , in principle , better tailored for dealing with failure of the usual assumptions of no unmeasured confounders or sequential ignorability often used to justify the application of all of these methods , as well as with ( near ) positivity violations whereby certain strata contain ( nearly ) no treated or untreated subjects ( @xcite ) . despite these advantages",
    ", the application of these methods in applied research has been relatively infrequent .",
    "broadly speaking , there are two types of snms : models for the effect of a treatment or sequence of treatments on the mean of an outcome , and models for the effect of a treatment on the entire distribution of the outcome(s ) .",
    "the former include structural nested mean models ( snmms ) , which have close links to structural nested cumulative failure time models ( sncftms ) for survival outcomes ; the latter include structural nested distribution models ( sndms ) , which have close links to structural nested failure time models ( snftms ) for survival outcomes . for pedagogic purposes , we will introduce these models first for point treatments ( i.e. , treatments which are administered at one specific time point ) in section  [ sec : snm ] .",
    "we then discuss identifying assumptions and the associated g - estimation method in section  [ sec : assest ] , and contrast it with alternative estimation methods for the effect of a point treatment in section  [ sec : prop ] .",
    "these results are extended to time - varying treatments in sections  [ sec : seqsnm ] and [ sec : seqass ] .",
    "we show how to predict the effects of interventions in section  [ sec : pred ] , examine extensions to mediation analysis in section  [ sec : direct ] and conclude with a discussion .",
    "let @xmath8 denote the outcome in a given subject that would be seen were the subject to receive treatment @xmath9 .",
    "this variable is a potential outcome , which we connect to the observed outcome through the consistency assumption that @xmath10 if the observed treatment @xmath11 ; otherwise , @xmath8 is counterfactual .",
    "causal effects can now be defined as comparisons of potential outcomes @xmath8 and @xmath12 for the same individual subject or group of subjects for different treatments @xmath9 and @xmath13 ( @xcite ; @xcite ) . in particular , letting @xmath14 for notational convenience , average causal effects can be defined in terms of comparisons of average potential outcomes , for example , @xmath15 or @xmath16 .",
    "structural mean models ( smms ) ( @xcite , @xcite ) parameterize average causal effects in subjects receiving level @xmath9 of treatment as @xmath17\\\\[-8pt ] & & \\quad { } -g \\bigl\\{e\\bigl(y^0 \\mid",
    "l = l , a = a\\bigr ) \\bigr\\}=\\gamma^ * \\bigl(l , a;\\psi^*\\bigr),\\nonumber\\end{aligned}\\ ] ] for all @xmath18 and @xmath9 . here",
    ", @xmath19 is a known link function ( e.g. , the identity , log or logit link ) , @xmath20 is a known function , smooth in @xmath21 and satisfying @xmath22 for all @xmath18 and @xmath21 . here and throughout , @xmath23 is the true unknown finite - dimensional parameter . with @xmath24 encoding absence of treatment  as we will assume throughout  smms thus express the effect of removal of treatment on the outcome mean .",
    "typically , the parameterization is chosen to be such that @xmath25 for all @xmath9 and @xmath18 , so that @xmath26 encodes the null hypothesis of no treatment effect .",
    "for instance , for scalar covariate @xmath0 one may consider the additive or linear smm [ which uses the identity link @xmath27 : @xmath28\\\\[-8pt ] & & \\quad= \\bigl(\\psi_0^*+\\psi_1^*l\\bigr)a,\\nonumber\\end{aligned}\\ ] ] for unknown @xmath29 .",
    "with @xmath30 a binary exposure coded as 1 for treatment and 0 for no treatment , @xmath31 thus encodes the average treatment effect in the treated with covariate value @xmath32 , and @xmath33 measures how much the average treatment effect in the treated differs between subgroups with a unit difference in @xmath0 .",
    "likewise , the multiplicative or loglinear smm uses the log link @xmath34 , for example , @xmath35 and the logistic smm uses the logit link @xmath36 , for example , @xmath37 where @xmath38 for random variables @xmath39 and @xmath40 .",
    "if treatment @xmath30 can take on more than two values , then  without additional assumptions ",
    "the function @xmath41 can not be interpreted simply as a dose response function .",
    "this is because a dose response would contrast outcomes in the same subset at different levels of @xmath9 [ i.e. , contrast @xmath42 with @xmath43 for @xmath44 , whereas the functions @xmath45 and @xmath46 for @xmath47 contrast causal effects for two different groups ( namely , those with @xmath11 versus @xmath48 , but the same @xmath49 ) .",
    "we will revisit this subtlety in section  [ sec : pred ] .",
    "one can use a smm to construct a variable @xmath50 whose mean value ( in a subset of individuals with given covariates and treatment ) equals the mean outcome that would have been seen had treatment been removed from that subset .",
    "let @xmath51 if @xmath19 is the identity link , @xmath52 if @xmath19 is the log link and @xmath53\\\\[-8pt ] & & \\quad \\equiv{\\operatorname{expit}}\\bigl [ { \\operatorname{logit}}\\bigl\\{e ( y \\mid l , a ) \\bigr\\}-\\gamma ^*(l , a;\\psi ) \\bigr],\\nonumber\\end{aligned}\\ ] ] if @xmath19 is the logit link . then @xmath54 this identity will be central to the estimation methods for @xmath23 that we will describe in section  [ sec : assest ] .",
    "we could have defined @xmath50 in general  and in particular for the identity and log link  as @xmath55 $ ] .",
    "we have avoided doing this for the identity and log links as it makes the definition of @xmath50 dependent on the expectation @xmath56 , which can be undesirable when this demands additional modeling . however",
    ", this ( or some alternative ) is unavoidable for the logit link .",
    "special estimation methods will therefore be required for logistic smms .",
    "smms can also be used to describe the effect of a multivariate point treatment .",
    "for instance , for a bivariate treatment @xmath57 , one may use a smm with @xmath58 to describe the effect of setting both treatments to zero .",
    "when primary interest lies in the interaction ( @xmath59 ) between @xmath60 and @xmath61 in their effect on the outcome , then one may instead consider the class of less restrictive structural mean interaction models ( @xcite ; @xcite ) . to guard against misspecification of the main treatment effects ,",
    "these further relax the smm restrictions by merely parameterising the contrast between the effects of @xmath60 when @xmath61 is set to some value @xmath62 versus zero ( or of the effects of @xmath61 when @xmath60 is set to some value @xmath63 versus 0 ) : @xmath64 for @xmath65 ; here , @xmath66 is a known function which encodes the interaction between both treatments , and which must be smooth in @xmath21 and satisfy @xmath67 for all @xmath68 and @xmath21 .",
    "for instance , the natural choice @xmath69 imposes that the interaction between both exposures is the same at all levels of @xmath18 .",
    "when the outcome mean does not adequately summarize the data or the interest lies more broadly in evaluating treatment effects on the outcome distribution , then structural distribution models ( sdms ) can be used instead .",
    "these are closely related to smms , but instead map percentiles @xmath70 of the conditional distribution of @xmath8 , given @xmath49 and @xmath11 , into percentiles @xmath71 of the conditional distribution of @xmath72 , given @xmath49 and @xmath11 .",
    "in particular , they postulate that @xmath73 for all @xmath18 and @xmath9 . as with smms , @xmath74 is a known function , smooth in @xmath21 and satisfying @xmath75 for all @xmath76 . with @xmath24 encoding the absence of treatment , sdms",
    "thus express the effect of removing treatment on the outcome distribution rather than the outcome mean .",
    "typically the parameterisation of a sdm is chosen to be such that @xmath77 , so that @xmath78 encodes the null hypothesis of no treatment effect .",
    "for instance , for scalar covariate @xmath0 , one could assume that @xmath79\\\\[-8pt ] & & \\quad = f_{y^a \\mid l",
    "= l , a = a } ( y ) , \\nonumber\\end{aligned}\\ ] ] for all @xmath18 and @xmath9 .",
    "this characterizes a location shift model following which the conditional distribution of @xmath72 , given @xmath0 and @xmath30 , can be obtained by shifting the conditional distribution of @xmath1 , given @xmath0 and @xmath30 , by @xmath80 .",
    "one can use this to construct a variable @xmath81 whose distribution ( in a subset of individuals with given covariates and treatment ) is the same as that of the outcome that would have been seen had treatment been removed from that subset , in the sense that @xmath82 for example , @xmath83 in the location shift example .",
    "this will be useful for the estimation of @xmath23 .",
    "sdms have a stronger variant called rank preserving sdms ( @xcite ) , which postulate that @xmath84 for instance , a stronger variant of the location shift model of the previous paragraph assumes that @xmath85 . by making a mapping between the potential outcomes themselves ( rather than between distributions ) , such rank preserving sdms",
    "are easier to understand and communicate .",
    "however , they are seldom plausible because they impose that the rankings of two subjects with different outcome values but identical treatment and covariates are preserved after mapping into @xmath72 ( hence the term `` rank preserving '' ) . in particular , they assume that subjects with identical outcome , treatment and covariate values experience identical treatment effects .",
    "location shift sdms like ( [ ex:2 ] ) make substantially stronger assumptions than correspondingly parameterized smms .",
    "the distribution models assume that treatment level @xmath9 shifts each percentile of the conditional distribution of @xmath1 , given @xmath86 by a value @xmath45 constant for all @xmath70 [ i.e. , @xmath87 , whereas the mean model assumes only a mean shift of @xmath20 .",
    "when location shift is implausible , it can sometimes be made more plausible by transforming @xmath70 .",
    "for instance , for strictly positive @xmath70 , one might obtain a location shift sdm by defining @xmath88 .",
    "there will then be a correspondence between the parameters of the sdm and those of a smm for @xmath89 .",
    "the parameterization and interpretation of sdms that are not simply shift models can be tricky .",
    "this is because , by the nature of the cumulative distribution function , the function @xmath74 must be increasing in @xmath70 for each @xmath90 and @xmath21 , and it may be difficult to impose that .",
    "for instance , the function @xmath91 may appear natural , but is not guaranteed increasing in @xmath70 .",
    "an alternative function which is naturally increasing in @xmath70 is @xmath92 . here ,",
    "interpretation is somewhat subtle ; while @xmath93 expresses the effect of treatment @xmath30 on the residual variability of @xmath1 , it also has implications for the effect of treatment on the mean of @xmath1 , and so @xmath94 can not be interpreted simply as the effect of treatment on the mean outcome , unless @xmath95 .",
    "sdms lend themselves naturally to the analysis of failure times .",
    "for instance , consider model ( [ sdm ] ) with @xmath96 and @xmath97 substituting for @xmath98 and @xmath70 .",
    "then the choice @xmath99 implies the failure time model defined by @xmath100 for all @xmath18 and @xmath9 , where @xmath101 denotes the survival function .",
    "this model , which is an example of a structural accelerated failure time model ( saftm ) ( @xcite ; @xcite ; @xcite ; @xcite ) , expresses that treatment lengthens lifetime by a factor @xmath102 ( in distribution ) among subjects with treatment @xmath9 and covariate @xmath18 .",
    "structural mean and distribution models require some modification for repeated measures outcomes .",
    "the modifications for smms are simpler , but also allow a new class of models for discrete - time failures .",
    "extension of sdms is more complicated .",
    "we consider these in order .",
    "we begin with some notation common to both types of models .",
    "suppose that measurements on exposure and confounders are collected at time point @xmath103 and that outcome measurements are recorded at fixed later time points @xmath104 .",
    "let for a variable @xmath105 , @xmath106 denote the level of the variable that one obtains at time @xmath107 .",
    "we use overbars to denote the history of a variable ; thus , @xmath108 denotes the history of @xmath105 through @xmath107 .",
    "we use underbars to denote the future of a variable ; thus , @xmath109 .",
    "finally , we use @xmath110 as shorthand notation for @xmath111 and @xmath112 for @xmath113 to denote @xmath114 .",
    "extension of smms to repeated measures is relatively straightforward , because they model separately the effect of a treatment on each component outcome .",
    "smms parameterize contrasts of @xmath115 and @xmath116 as @xmath117 for all @xmath18 and @xmath9 . here , @xmath19 is a known @xmath118-dimensional link function , @xmath20 is a known @xmath118-dimensional function with components@xmath119 , that parameterize the effect of treatment on @xmath120 .",
    "these components are smooth in @xmath21 and satisfy @xmath121 for all @xmath18 and @xmath21 .",
    "for instance , the smm defined by @xmath122 for @xmath123 , expresses that the effect of treatment @xmath9 may depend on covariates @xmath18 and changes linearly over time , being zero at the baseline time @xmath103 .    under this repeated measures",
    "smm , as in section  [ subsec : smm ] , it is possible to define a transformation @xmath50 of the observed outcome vector @xmath124 so that @xmath125 here , @xmath50 is a vector with components @xmath126 for @xmath123 if @xmath19 is the identity link , @xmath127 if @xmath19 is the log link , and @xmath128 $ ] if @xmath19 is the logit link .",
    "structural cumulative failure time models(scftms ; @xcite ) are a variant of repeated measures loglinear smms for the modeling of cumulative failure time probabilities : @xmath129 for all @xmath90 and @xmath123 .",
    "a limitation of this class of models is that their parameterization can be tricky when the cumulative probability of failure becomes large , because the model does not restrict the outcome probabilities to stay below 1 .",
    "@xcite independently proposed a continuous - time version of this model and lay out connections with additive hazard models .      for multivariate outcomes , sdms parameterize the effect of a treatment @xmath30 on the marginal distribution of the vector of future potential outcomes @xmath115 .",
    "this mapping is typically done recursively , taking the components @xmath130 and @xmath120 in forward sequence .",
    "these models are therefore most easily understood by first considering the class of more restrictive rank - preserving sdms , which postulate that , for subjects with @xmath11 and @xmath49 : @xmath131 for @xmath123 .",
    "here , @xmath132 is a known function , smooth in @xmath21 and monotonic in @xmath133 , and @xmath134 for all @xmath135 , and @xmath21 .",
    "for instance , with two time points ( @xmath136 ) , a rank preserving sdm may be given by the following set of restrictions : @xmath137\\\\[-8pt ] y_1 ^ 0&=&y_1-\\psi^*_3a .",
    "\\nonumber\\end{aligned}\\ ] ] if the effect of @xmath30 on @xmath138 varies with @xmath139 , as in this example , then one must model this explicitly since the model would otherwise  perhaps unrealistically  assume that treatment does not affect the correlation between repeated outcomes ( conditional on @xmath140 ) .",
    "this is unlike in smms where one can average the effect of @xmath30 on @xmath138 over all @xmath139-values .",
    "this makes it substantially more difficult to parameterize sdms than smms .",
    "it moreover complicates the interpretation of effects ; for example , @xmath33 in ( [ eq : repsndm ] ) is difficult to interpret when @xmath141 since it expresses the effect of treatment on @xmath138 in subjects with @xmath142 and @xmath143 , where @xmath139 may itself be affected by treatment .",
    "equation ( [ eq : repsndm ] ) may hence by easier to interpret upon re - expressing it as @xmath144    a sdm relaxes the restrictions of the rank - preserving sdm by demanding that the equality ( [ ranksdmrep ] ) merely holds in distribution , conditional on @xmath49 and @xmath11 .",
    "assuming that given @xmath0 and @xmath30 , @xmath124 has a continuous multivariate distribution with probability 1 , a sdm can thus be defined by the set of restrictions @xmath145 for all @xmath146 , where @xmath147 is given by ( @xcite ) : @xmath148 for @xmath149 .",
    "for instance , the sdm corresponding to ( [ eq : repsndm ] ) may be written : @xmath150\\\\[-8pt ] & & f_{{y}_2 ^ 0 \\mid",
    "l = l , a = a , y_1 ^ 0=y_1-\\psi_3^*a } \\bigl\\{y_2-\\bigl(\\psi ^*_1+\\psi_2^*y_1\\bigr)a \\bigr \\}\\nonumber\\\\ & & \\quad = f_{{y}_2",
    "\\mid l = l , a = a , y_1=y_1 } ( y_2 ) .\\nonumber\\end{aligned}\\ ] ] the decomposition of the causal effects in the blip functions @xmath151 is recursive because one must model not merely average effects but instead the full mapping between distributions . in particular , the effect of treatment on the first potential outcome is modeled first ; then , mapping between distributions is done successively for the outcome at successive times .",
    "the overall blip function encoded by @xmath152 and the first element of this function has the usual structure and interpretation of causal estimands ; that is , as a comparison of distributions of potential outcomes under different interventions for the same group of subjects .",
    "however , the component functions @xmath153 do not in general have this interpretation , since the conditioning in these mapping functions is not common between @xmath154 and @xmath120 ; for instance , the left - hand side of ( [ eq : repsndm2 ] ) conditions on @xmath155 , whereas the right - hand side conditions on @xmath139 .",
    "nonetheless , these component functions are causal in the sense that they represent the impact of treatment on the conditional distribution of a variable .",
    "this feature is shared with the causal rate or hazard ratio ( hernan , @xcite ) . under the strong assumption of rank preservation ,",
    "the conditioning is on a common variable , and so then the components of the blip function do have a standard causal interpretation .",
    "for repeated measures outcomes , sdms correspond with similarly parameterized smms if the sdms are shift models . in a shift sdm , the component functions @xmath156 may be written as @xmath157 .",
    "these require that the shift in percentiles of the distribution of @xmath133 not only be independent of @xmath133 but also of @xmath158 .",
    "thus , shift sdms make substantially stronger assumptions than similarly parameterized smms .    under the sdm ,",
    "a ( @xmath159)-dimensional variable @xmath160 can be constructed with components @xmath161 .",
    "this vector mimics the counterfactual outcome vector @xmath116 in the sense that @xmath162 this result will be useful for estimation .",
    "the blip functions and causal models discussed above largely consider the effect of a blip of treatment conditional only on treatment and baseline covariates ; the sole exception has been sdms for measures outcomes , where the effect of treatment on later outcomes is modeled additionally conditional on earlier outcomes , and where the interpretation of the model parameters is not clear as a usual causal contrast .",
    "this focus is consistent with an orientation of the models to be more directly useful for making decisions , where the effect of treatment is modeled conditional only on information available at the time of the decision .    for explanatory purposes",
    ", one can construct structural models for the effect of a treatment conditional on information not available at the time of treatment .",
    "such models may have explanatory uses even though the quantities they model are less directly relevant for making decisions .",
    "consider modeling the effect of screening mammography on breast cancer mortality ( @xcite ) . to a first approximation",
    ", one might assume that the mammogram has an effect on death only among subjects for whom it detects a tumor .",
    "suppose that some subjects undergo screening at the start of the study ( @xmath142 ; @xmath163 otherwise ) .",
    "let @xmath164 indicate 1 if cancer is detected at time @xmath165 after the start of the study and 0 otherwise .",
    "it is of interest to know how much the screening mammogram affects mortality for subjects for whom it is effective in detecting cancer .",
    "we can then model the effect of the treatment on the outcome using a retrospective sdm ( rsdm ) or sftm , which conditions on @xmath164 in addition to treatment and baseline covariates : @xmath166\\\\[-8pt ] & & \\quad = f_{y \\mid l_0=l_0,l_1=l_1,a = a } ( y ) .\\nonumber\\end{aligned}\\ ] ] in this example , we might assume that @xmath167 to reflect that screening has no effect in subjects for whom no tumor is detected . note that though @xmath164 may be affected by @xmath30 , conditioning on it does not distort the interpretation of the parameters as encoding a causal effect because identity ( [ retro ] ) still involves a comparison of the same subjects ( those with @xmath168 ) under different interventions .",
    "models of this sort might also be useful in determining whether the effect of a treatment given at baseline is modified by post - treatment covariates and so whether there are identifiable subgroups of subjects for whom treatment appears not to be working ( @xcite ) .",
    "changes or additions to treatment might then be proposed in such subgroups after baseline . @xcite",
    "consider the relation between these retrospective models and the popular approach of principal stratification ( @xcite ) .",
    "these models can generalize to a sequence of time - varying treatments , where there are additional justifications for their use ( see section  [ sec5.3 ] ) .",
    "two kinds of assumptions have been proposed for use in most of the literature on estimation in smms and sdms : no unmeasured confounders and instrumental variables type assumptions . in this section , we will focus on the former , and defer discussion of the latter to section  [ subsec : iv ] .      the required no unmeasured confounders assumption for the identification of the parameter @xmath23 indexing smms and sdms can be formulated as @xmath169 where @xmath170 for random variables @xmath171 denotes that @xmath172 is conditionally independent of @xmath39 , given @xmath40 .",
    "this assumption , which is empirically unverifiable , expresses that @xmath0 is sufficient to adjust for confounding of the association between @xmath30 and @xmath1 .",
    "assumption ( [ sra1 ] ) , which is also referred to as the weak ignorability or exchangeability assumption , is weaker than the strong ignorability assumption of @xcite which , for binary treatments , states that @xmath173 .",
    "however , it is generally difficult to imagine settings where assumption ( [ sra1 ] ) holds , but strong ignorability fails ( one exception might be settings where individuals choose treatment on the basis of their perceived belief of benefit , which may be correlated with actual benefit @xmath174 ) .",
    "that ( [ sra1 ] ) is a weaker assumption is exhibited in the fact that , for binary treatments , it only identifies the effect of treatment on the treated  a contrast that has been of interest in econometrics and epidemiology ( @xcite ) : @xmath175 the second equality follows due to ignorability ( [ sra1 ] ) and the third due to the consistency assumption .",
    "the parameters of smms , sdms and scftms represent the effect of treatment in the treated ( or , more generally , the effect of receiving treatment level @xmath9 for subjects who received level @xmath9 of treatment ) , and so this weaker assumption is sufficient for identification .",
    "it follows by a similar reasoning that the blip functions in the smms and sdms discussed in sections  [ subsec : smm][sec2.3 ] are nonparametrically just identified under ignorability ( @xcite ) .",
    "that is , the contrast of the outcomes under the observed treatment and the outcomes that would have been seen in the absence of treatment is computable for each level of @xmath9 and @xmath18 ( and , for sdms , of @xmath70 ) from the law of the observables without assuming any restrictions or parameterization on these functions . while such nonparametric identification is of limited use in complex settings ( especially with time - varying treatments considered subsequently ) , due to the curse of dimensionality ( @xcite ) , it does ensure the ability to check the assumptions in any assumed causal model ( provided a sufficient sample size ) .",
    "in contrast , the retrospective blip functions considered in section  [ sec2.4 ] are not identified nonparametrically ( @xcite ; @xcite ) .",
    "multiple retrospective blip models may thus explain the same law of the observables equally well even under ignorability .",
    "the smm together with the ignorability assumption ( [ sra1 ] ) implies that @xmath176 estimation of @xmath23 in a smm can thus be based on solving estimating equations : @xmath177 \\nonumber\\\\[-8pt]\\\\[-8pt ] & & \\hspace*{29pt}{}\\cdot\\bigl[u^*_i(\\psi)-e \\bigl\\{u^*_i(\\psi )   \\mid l_i \\bigr\\ } \\bigr],\\nonumber\\end{aligned}\\ ] ] which essentially set the empirical conditional covariance between @xmath50 and arbitrary functions @xmath178 of the dimension of @xmath179 , given @xmath0 , to zero .",
    "for instance , for model ( [ ex:1 ] ) , the choice @xmath180 results in estimating equations @xmath181,\\nonumber\\end{aligned}\\ ] ] from which estimates for @xmath182 can be solved .",
    "a  locally efficient estimator of @xmath23 [ under the smm together with the ignorability assumption ( [ sra1 ] ) ] can be attained by setting @xmath183 when the variance of @xmath184 given @xmath140 is constant ; local here means that the efficiency is only attained when this constant variance assumption is met and models for all conditional expectations involved in ( [ eesmm ] ) are correctly specified .",
    "the sdm together with the ignorability assumption ( [ sra1 ] ) implies the more restrictive constraint that @xmath185 this motivates estimating @xmath23 by picking the value @xmath21 that makes this conditional independence hold .",
    "this forms the default approach in saftms , where estimation is based on a grid search whereby the independence ( [ sdmsra ] ) is tested for different values of @xmath186 using a ( standard ) statistical test until it is found to be satisfied ( @xcite ) .",
    "equivalently , estimation can be based on solving an estimating equation of the form @xmath187\\nonumber\\\\[-8pt]\\\\[-8pt ] & & { } -e \\bigl(d \\bigl\\{u_{i}(\\psi),a_i , l_i \\bigr\\}\\nonumber\\\\ & & \\hspace*{20pt}{}-e \\bigl[d \\bigl\\ { u_{i}(\\psi ) , a_i , l_i \\bigr\\ } \\mid l_i , u_{i}(\\psi ) \\bigr ] \\mid a_i , l_i \\bigr ) , \\nonumber\\end{aligned}\\ ] ] for @xmath21 , where @xmath188 is an arbitrary index function of the dimension of @xmath21 ; for example , @xmath189 . a locally efficient estimator of @xmath23 [ under the sdm together with the ignorability assumption ( [ sra1 ] ) ] can be obtained by solving ( [ eesdm ] ) with @xmath190 , where @xmath191 is the score for @xmath21 under the observed data likelihood @xmath192 with all components substituted by suitable parametric models ( @xcite ) .",
    "for instance , under model ( [ ex:2 ] ) with @xmath193 given @xmath0 following a normal distribution with mean linear in @xmath0 and constant variance , @xmath194 for certain constants @xmath195 , so that a locally efficient estimator is obtained by solving ( [ ex:3 ] ) .    estimating equations of form ( [ eesmm ] ) and ( [ eesdm ] )",
    "may also be used for repeated measures outcomes . in ( [ eesmm ] )",
    ", @xmath196 now becomes a @xmath197-dimensional matrix , with @xmath198 the dimension of @xmath21 . in ( [ eesdm ] ) , @xmath199 remains an arbitrary index function of the dimension of @xmath21 ; for example , @xmath200 .    note that the smm together with assumption ( [ sra1 ] ) is the same model for the observables as the semiparametric regression model ( @xcite ) : @xmath201 with @xmath202 unspecified .",
    "likewise , the saftm [ with , e.g. , @xmath203 together with assumption ( [ sra1 ] ) can be viewed as a semiparametric generalization of the accelerated failure time model ( @xcite ) , defined by @xmath204 with @xmath205 .    because of the curse of dimensionality , evaluating the conditional expectations appearing in equations ( [ eesmm ] ) and ( [ eesdm ] ) requires a parametric working model @xmath206 for the conditional distribution of the exposure  @xmath30 : @xmath207 here @xmath208 is a known density function , smooth in @xmath209 , and @xmath210 is an unknown finite - dimensional parameter .",
    "for instance , for dichotomous exposure , one could assume that @xmath211 with @xmath212 . here , @xmath210 can be estimated via standard ( maximum likelihood ) methods . evaluating ( [ eesmm ] ) and ( [ eesdm ] ) moreover requires a parametric working model @xmath213 for the conditional distribution of @xmath193 or the conditional expectation of @xmath214 . for ( [ eesdm ] ) , we model : @xmath215 where @xmath216 is a known density function , smooth in @xmath217 , and",
    "@xmath218 is an unknown finite - dimensional parameter ; to evaluate equations ( [ eesmm ] ) , specification of the conditional mean of @xmath184 , given @xmath0 , suffices .",
    "for instance , for a continuous outcome , one could assume that conditional on @xmath0 and for given @xmath23 , @xmath219 is normally distributed with mean @xmath220 and variance @xmath221 , with @xmath222 .",
    "for each fixed value of @xmath23 , @xmath218 can be estimated using standard regression methods .",
    "a consistent estimator of @xmath23 indexing the smm or sdm can now be obtained by solving equations ( [ eesmm ] ) or ( [ eesdm ] ) , respectively , with @xmath210 and @xmath218 substituted by consistent estimators under models @xmath206 and @xmath213 , respectively .",
    "the resulting estimator of @xmath23 is called a g - estimator . in sdms and linear or loglinear smms",
    ", it has the attractive property of being doubly robust ( robins and rotnitzky , @xcite ) : consistent when either model @xmath206 or model @xmath213 is correctly specified ( in addition to a correctly specified structural model and ignorability ) ; it does not require both to be correctly specified , nor does it require specifying which of both is correctly specified . that the solution to equation ( [ eesmm ] ) is doubly robust",
    "can be seen because this equation has mean zero at @xmath223 when either model @xmath206 or model @xmath213 is correctly specified , even if one of them is misspecified .",
    "equation ( [ eesdm ] ) is likewise seen to have mean zero at @xmath223 under model @xmath213 ; that it also has mean zero under model @xmath206 at @xmath223 is seen by rewriting the equation as @xmath224 \\\\ & & \\hspace*{-4pt}{}-e \\bigl(d \\bigl\\{u_{i}(\\psi),a_i , l_i \\bigr\\}\\\\ & & \\hspace*{20pt}{}-e \\bigl[d \\bigl\\ { u_{i}(\\psi),a_i , l_i \\bigr\\ } \\mid l_i , a_i \\bigr ] \\mid u_{i}(\\psi ) , l_i \\bigr).\\end{aligned}\\ ] ] the result now follows , provided that the parameters @xmath209 and @xmath225 are variation - independent ( i.e. , not functionally related ) , so that a consistent estimator of @xmath210 does not require consistent estimation of @xmath218 and vice versa .",
    "sandwich standard errors are obtained via the usual estimating equations theory.=1    in logistic smms , to the best of our knowledge , no estimators of @xmath186 have been found that are root-@xmath226 consistent under model @xmath227 and the ignorability assumption .",
    "this is because the evaluation of @xmath50 is anyway dependent upon a model for the conditional mean @xmath228 [ see ( [ ulogit ] ) ] .",
    "@xcite show that double robustness can instead be attained against misspecification of either a model for the density @xmath229 or a model for the density @xmath230 .",
    "their key to estimation of @xmath23 is that the parameterized association @xmath231 between @xmath30 and @xmath1 , when evaluated at @xmath223 , can be used to render @xmath30 and @xmath1 conditionally independent ( given @xmath0 ) via inverse probability weighting .",
    "their results apply equally to case - control designs ( @xcite ) . for structural mean interaction models ,",
    "inference is developed in @xcite when @xmath19 is the identity or log link and in @xcite when @xmath19 is the logistic link .",
    "@xcite focus on case - only designs and note that when @xmath19 is the log link , the multiplicative interaction ( [ int ] ) is identical to the conditional odds ratio between @xmath60 and @xmath61 , given @xmath0 within the subgroup of cases .",
    "this enables the use of results on logistic smms ( @xcite ) for robust estimation of multiplicative interactions under outcome - dependent sampling .      censoring presents additional challenges for the analysis of failure - time outcomes @xmath232 .",
    "random censoring or loss to follow - up can be dealt with through inverse probability of censoring weighting ( @xcite ) .",
    "type i censoring , also known as censoring by end of follow - up , can be ignored in the analysis of scftms , but must be dealt with in a different fashion in the analysis of saftms .",
    "this is because @xmath193 involves the failure - time itself , which is missing for all subjects who fail after planned end - of - follow - up ; the coarsening process is informative here as it depends on the actual failure time .",
    "we will next describe how type i censoring can be dealt with in the analysis of saftms .",
    "let @xmath233 denote the planned end of follow - up time for given individual .",
    "@xmath233 is known for all subjects , even those observed to fail .",
    "however , @xmath234 can not be evaluated for those who do not fail prior to time @xmath233 .",
    "knowing that @xmath235 under ignorability , the aim is then to find a function @xmath236 which is observable for all individuals and for which @xmath237 if such function is found , then @xmath23 can be estimated by solving the original estimating equations for sdms with @xmath238 replacing @xmath234 .",
    "a natural choice would be @xmath239 with @xmath240 the blipped - down censoring time , which is defined like @xmath234 but with @xmath232 substituted by @xmath233 .",
    "however , this choice would not satisfy the required conditional independence property .",
    "the reason is that since @xmath233 is fixed by design , @xmath240 will in general be a function of @xmath30 when @xmath241 and so will generally fail to be conditionally independent of @xmath30 , given  @xmath0 .",
    "@xcite thus propose to eliminate the dependence of @xmath240 on @xmath30 by redefining it to be @xmath242 . by thus minimizing over all feasible treatments @xmath9 , any dependence on the observed treatment",
    "is broken so that @xmath243 and @xmath244 become always observable quantities that are independent of @xmath30 given @xmath0 under ignorability , when evaluated at @xmath23 .",
    "we may thus choose @xmath245 to be an arbitrary function of @xmath246 and @xmath247 .    with each choice of @xmath236 ,",
    "some subjects who are observed to fail may be treated as censored when @xmath248 .",
    "this can happen because for some subjects , @xmath249 may be smaller than @xmath250 even though @xmath251 . such subjects are called artificially censored .",
    "artificial censoring has several consequences . besides decreasing information",
    "about @xmath23 as more subjects are artificially censored , the estimating equations are not , in general , continuous in @xmath21 .",
    "this is because the functions @xmath236 are not generally continuous in @xmath21 , which happens in part because @xmath247 is not a smooth function of @xmath21 .",
    "this can present problems for optimization , especially when @xmath21 is a vector , and may moreover imply that the estimating equations have no solution in finite samples .",
    "this problem may be mitigated by choosing @xmath236 to be a smooth function of @xmath21 , for example , @xmath252 , where @xmath253 ( joffe , yang and feldman , @xcite ) .",
    "@xcite consider functions @xmath254 whose first derivatives exist for all @xmath21 ; they appear to have had better success in convergence for their optimization algorithm.=1",
    "insight into the behavior of g - estimators can be garnered by focusing on the simple model @xmath255 defined by the ignorability assumption that @xmath256 for @xmath257 , known treatment mechanism @xmath258 and the smm @xmath259 under homoscedasticity ( i.e. , when the conditional variance of the outcome , given @xmath30 and @xmath0 , is a constant @xmath260 ) , the locally efficient g - estimator of @xmath23 under model @xmath255 has influence function ( @xcite ) @xmath261\\\\[-8pt ] & & \\quad { } \\cdot\\bigl\\{y-\\psi^ * a - e\\bigl(y-\\psi^ * a \\mid l\\bigr ) \\bigr\\};\\nonumber\\end{aligned}\\ ] ] it can thus in particular be obtained by setting the sample average of these influence functions to zero and solving for @xmath23 . for binary treatment @xmath30 , linear regression adjustment for the propensity score ( @xcite ) results in an estimator of @xmath23 with influence function of the same form ( [ eq : ifsmm ] ) , but with @xmath262 substituted by the population least squares fit from a regression of @xmath263 on the propensity score @xmath264 .",
    "linear regression adjustment for the propensity score can therefore be viewed as an inefficient and nondoubly robust g - estimation approach ( @xcite ) . the close relation between g - estimation and regression adjustment for the propensity score",
    "is not maintained in nonlinear models , where propensity score adjustment may not only demand correct models for the propensity score , but also for its association with outcome ( vansteelandt and daniel , @xcite ) . in nonlinear models , due to non - collapsibility of the treatment effect parameter ( @xcite ) , its meaning may also change depending on whether covariates are adjusted for in addition to the propensity score .",
    "ordinary regression estimators [ in particular , maximum likelihood estimators obtained by fitting model ( [ eq : semiparregr ] ) under a finite - dimensional parameterization of @xmath202 ] are at least as efficient as the previously considered g - estimators , provided correct model specification . from the variance of the influence functions , we can deduce that the asymptotic variance of the locally efficient g - estimator is @xmath266 when there is homoscedasticity and the conditional mean @xmath267 is correctly specified .",
    "the ordinary least squares ( ols ) estimator under the linear regression model @xmath268 has an asymptotic variance which is smaller but , interestingly , usually not much smaller : @xmath269}.\\ ] ] this follows from its influence function , which is of the same form ( [ eq : ifsmm ] ) , but with @xmath264 substituted by @xmath270 , the population least squares fit from a regression of @xmath30 on @xmath0 .    despite their greater efficiency ,",
    "ordinary regression estimators have a number of limitations not shared by g - estimators , an important one being their lack of extensibility to the analysis of sequential treatments ( see section  [ sec : seqsnm ] ) .",
    "furthermore , their explicit reliance on a model for the association between outcome and covariates can be disadvantageous when the treated and untreated subjects are very different in their covariate distributions , for then even well - fitting models for the outcome may be prone to extrapolation bias ( @xcite ) .",
    "this is not the case for g - estimators when they are based on a correctly specified model ( @xmath206 ) for the treatment process .",
    "this is also seen from the form of the influence functions ( [ eq : ifsmm ] ) , following which individuals in regions of little or no overlap [ i.e. , at covariate values @xmath0 where @xmath271 is small ] will hardly contribute in the calculation of the g - estimator because @xmath272 for such individuals . as with other estimation approaches based on propensity score adjustment ( e.g. , matching ) ,",
    "the information about @xmath23 will thus come primarily from regions with sufficient overlap , which we view as desirable .",
    "in contrast , ols estimators are more susceptible to extrapolation bias since the leading term @xmath273 in their influence functions may be far from zero for individuals in regions of little or no overlap . finally , an advantage of g - estimation methods is that they can incorporate a priori knowledge on the exposure distribution .",
    "for instance , @xcite exploit knowledge on the distribution of offspring genotypes given parental genotypes ( based on mendel s law of segregation ) , by using g - estimators to develop gene - environment interaction tests that are robust against misspecification of the effect of environmental exposures on the outcome .      for the analysis of sequential treatments ( see section  [ sec : seqsnm ] ) , marginal structural models ( msm ) ( robins , hernan and brumback , @xcite ) and inverse probability weighted ( ipw ) estimators are much more popular than smms and sdms and g - estimators .",
    "this is related to g - estimation being computationally more demanding by the lack of off - the - shelf software .",
    "it is thus of interest to compare the behaviour of these estimators in a simple setting with dichotomous treatment .",
    "consider therefore model @xmath274 , which is defined by the ignorability assumption that @xmath256 for @xmath257 , known propensity score @xmath275 and the nonparametric msm @xmath276 note , since @xmath256 for @xmath257 , that @xmath277 in both models @xmath255 and @xmath274 , and thus defines the same parameter .",
    "nonetheless , model @xmath274 is less restrictive than model @xmath255 in that it does not postulate that the treatment effect is homogeneous ( i.e. , constant over levels of @xmath0 ) .",
    "this explains why the asymptotic variance of the locally efficient ipw estimator under model @xmath274 , which has influence function ( @xcite ) @xmath278 is strictly larger than the variance of the locally efficient g - estimator ( unless @xmath30 and @xmath0 are independent , as may be the case when @xmath30 refers to a randomized treatment , in which case they are equally efficient ) .",
    "in particular , the asymptotic variance of the locally efficient ipw estimator equals @xmath279 when the treatment effect is homogeneous .",
    "the difference between ( [ eq : varsmm ] ) and ( [ eq : varmsm ] ) can be sizeable when the propensity score is close to zero or 1 for some values of @xmath0 for then @xmath271 is close to zero and thus @xmath280 can take on large values . in our opinion , this difference is not usually offset by the weaker restrictions imposed by the msm .",
    "indeed , the marginal treatment effect would seldom be of scientific interest when certain subjects are almost precluded from receiving treatment or no treatment .",
    "moreover , the g - estimator retains a useful interpretation even when the assumption of constant treatment effects fails in the sense that @xmath281 for some function @xmath282 .",
    "indeed , in that case the locally efficient g - estimator converges to @xmath283 which continues to be useful as a weighted average of treatment effects @xmath282 , with most weight given to strata with most information about the treatment effect .",
    "this difference in asymptotic variance between both estimators becomes even more pronounced in the likely event that the model for @xmath284 is misspecified .",
    "let @xmath285 denote the degree of misspecification at covariate value @xmath0 , with @xmath286 the true expectation and @xmath287 the expectation used for evaluating the locally efficient g - estimator .",
    "furthermore , assume that in truth the treatment effect is homogeneous .",
    "then the asymptotic variance of the g - estimator becomes @xmath288 and the asymptotic variance of the previously considered ipw estimator becomes @xmath289.\\end{aligned}\\ ] ] consider now that model misspecification is more likely in regions of little overlap .",
    "then because @xmath290 in these regions , model misspecification in these regions will only have a minor impact on the variance of the g - estimator , but a particularly strong impact on the variance of the locally efficient ipw estimator .",
    "similar findings have been noted concerning the asymptotic bias of these estimators ( @xcite ) .    while this contrast between g - estimation and ipw - estimation under misspecification of the outcome model could turn out to be somewhat less dramatic",
    "when the propensity score is not considered as fixed and known , we believe that the above findings more likely understate the factual differences if one considers that mainstream applications are based on sequential treatments ( and thus even more variable inverse probability weights ) and on simple , inefficient inverse probability weighting methods .",
    "the latter can be viewed as inducing extreme misspecification in the outcome model as they amount to setting @xmath291 .",
    "we thus believe that more routine application of g - estimation is warranted .",
    "before introducing snms for time - varying or sequential treatments , we consider the structure of observed data in observational studies with repeated treatments and covariates , as well as definitions of causal effects in such setting .",
    "suppose that measurements are collected at fixed time points @xmath292 .",
    "let @xmath293 denote the treatment provided at time @xmath294 , and @xmath295 denote other covariates measured at that time ; @xmath120 , the outcome measured at time @xmath296 , is part of @xmath297 .",
    "we presume the variables are ordered @xmath298 , @xmath3 , @xmath164 , @xmath2 , etc . ; thus , covariates and outcome at @xmath107 precede treatment at @xmath107 .",
    "let @xmath299 denote the outcome that would be seen at time @xmath300 in a given individual were ( s)he to receive treatment history @xmath301 through time @xmath302 .",
    "the variables @xmath303 are potential outcomes , which are again linked to the observed data via the consistency assumption that @xmath304 if @xmath305 .",
    "we presume that treatment at or after @xmath300 can not affect outcome at times up to @xmath300 ; thus , @xmath306 for @xmath307 .",
    "causal effects can now be defined as comparisons of potential outcomes @xmath308 for the same group of subjects for different treatment histories @xmath309 , @xmath310 , @xmath311 ( @xcite ) .",
    "if the outcome is measured only at the end of a fixed follow - up period , or only at a subset of the follow - up times , we can let @xmath312 , where `` @xmath313 '' denotes missing or undefined values for the times where the outcome is not measured .",
    "most of the subsequent presentation then applies to those settings .",
    "structural nested mean models ( snmms ) ( @xcite ; @xcite ) simulate the sequential removal of an amount ( `` blip '' ) of treatment at @xmath300 on subsequent average outcomes , after having removed the effects of all subsequent treatments .",
    "given a history @xmath314 , define the counterfactual history @xmath315 as the history @xmath316 that agrees with @xmath314 through time @xmath300 and is 0 thereafter .",
    "snmms then model the effect of a blip of treatment at @xmath300 on the subsequent outcome means when holding all future treatments fixed at their reference level 0 ; thus , they parameterize contrasts of @xmath317 and @xmath318 conditionally on treatment and covariate histories through @xmath300 as @xmath319 & & \\qquad { } -g \\bigl\\{e \\bigl(\\underline{y}_{m+1}^{\\overline { a}_{m-1},0 } \\mid \\overline{l}_m=\\overline{l}_m,\\overline { a}_m=\\overline{a}_m \\bigr ) \\bigr\\ } \\\\[-1pt ] & & \\quad = \\gamma^*_m\\bigl(\\overline { l}_m,\\overline { a}_m;\\psi^*\\bigr),\\end{aligned}\\ ] ] for each @xmath320 and @xmath321 , where @xmath322 is a known @xmath323-dimensional function , smooth in @xmath21 , and for each @xmath324 and @xmath21 it is by definition required that @xmath325 .",
    "alternatively , one may focus on the effect of treatment on the end - of - study outcome @xmath326 only , in which case one obtains a snmm of the form @xmath327 & & \\qquad { } -g \\bigl\\{e \\bigl(y^{\\overline{a}_{m-1},0 } \\mid \\overline { l}_m= \\overline{l}_m,\\overline{a}_m=\\overline{a}_m \\bigr ) \\bigr\\ }   \\\\[-1pt ] & & \\quad = \\gamma ^*_m\\bigl(\\overline{l}_m , \\overline{a}_m;\\psi^*\\bigr),\\end{aligned}\\ ] ] for each @xmath320 and @xmath321 , where @xmath322 is now @xmath328-dimensional .",
    "the above contrasts generalize the notion of the effect of treatment on the treated to the setting of a sequence of treatments .",
    "the name `` nested '' refers to the nesting across time , of the subgroups defined by @xmath329 and @xmath330 within which the effects are evaluated .",
    "typically , the parameterization is chosen to be such that @xmath331 for all @xmath332 so that @xmath333 encodes the null hypothesis of no treatment effect .",
    "for instance , with 2 time points ( @xmath136 ) a linear snmm may be given by @xmath334 & & \\quad = \\bigl ( \\psi^*_0+\\psi^*_1l_1+\\psi ^*_2a_0 \\bigr)a_1 , \\\\[-1pt ] & & e\\bigl(y_2^{(a_0,0)}-y_2^{0 } \\mid l_0=l_0,a_0=a_0\\bigr ) \\\\[-1.5pt ] & & \\quad   = \\bigl(\\psi ^*_3+\\psi ^*_4l_0 \\bigr)a_0 , \\\\[-1pt ] & & e\\bigl(y_1^{(a_0,0)}-y_1^{0 } \\mid l_0=l_0,a_0=a_0\\bigr ) \\\\[-1.5pt ] & & \\quad   = \\bigl(\\psi ^*_0+\\psi ^*_1l_0 \\bigr)a_0.\\end{aligned}\\ ] ] here , the first equation models the effect of @xmath2 on @xmath138 , the second models the effect of @xmath3 on @xmath138 and the third models the effect of @xmath3 on @xmath139 , all within levels of variables defined prior to the considered exposure .",
    "thus , @xmath29 and @xmath335 encode short - term treatment effects , which are here assumed to be constant at all time points , and @xmath336 and @xmath337 encode long - term treatment effects .",
    "these effects are visualised in figures  [ fig2 ] and [ fig3 ] below . when interest merely lies in the effect on the end - of - study outcome , then the above model for @xmath139",
    "can be ignored .    under the snmm , as in section  [ subsec",
    ": smm ] , it is possible to define a transformation @xmath338 of @xmath339 , whose mean value equals the mean that would be observed if treatment were suspended from time @xmath300 onward , in the sense that @xmath340\\\\[-8pt ] & & \\quad = e \\bigl(\\underline{y}_{m+1}^{\\overline{a}_{m-1},0 } \\mid \\overline { l}_m,\\overline{a}_{m-1}=\\overline{a}_{m-1},a_m \\bigr),\\nonumber\\end{aligned}\\ ] ] for @xmath320 . here , @xmath341 is a vector with components @xmath342 for @xmath343 ( or for @xmath344 only if interest merely lies in the effect on the end - of - study outcome ) if @xmath19 is the identity link , and @xmath345 if @xmath19 is the log link .",
    "these equations formalize the notion of peeling off or blipping down the treatment effects over the treatment period from @xmath300 to @xmath346 .",
    "for instance , in the previous example for 2 time points , @xmath347 for link functions other than the identity and log link , such a transformation can still be defined , but depends on the observed data distribution in a complicated and contrived way .",
    "for instance , when @xmath19 is the logit link and there are 2 time points ( @xmath136 ) , then under the snmm we have that @xmath348\\\\ & & \\hspace*{127pt}{}\\mid l_0=l_0,a_0=a_0 \\bigr ) \\bigr\\}\\\\ & & \\hspace*{142pt } { } -\\gamma ^*_{0}\\bigl(l_0,a_0;\\psi^ * \\bigr ) \\bigr].\\end{aligned}\\ ] ] the calculation of @xmath349 thus not only demands knowledge of @xmath350 , but also of the distribution of @xmath351 , given @xmath352 .",
    "the effect of a sequential treatment on the failure time distribution can be parameterized through a collection of snmms with log link , one for each time point ( robins and hernan , @xcite ; picciotto et al . , @xcite ) . in continuous time ( @xcite ) , such structural nested cumulative failure time models are defined by restrictions of the form : @xmath353 for all @xmath97 and @xmath320 , where @xmath354 is a known function , smooth in @xmath21 and monotonic in @xmath97 , and @xmath355 for all @xmath356 and @xmath21 .",
    "structural nested distribution models ( sndms ) are closely related to snmms , but parameterize a map between percentiles of the distribution of @xmath357 and percentiles of the distribution of @xmath358 .",
    "they are most easily understood by first considering the class of more restrictive rank - preserving sndms .",
    "in particular , for each exposure @xmath359 , let us first consider a rank - preserving sndm to parameterize its effect on the end - of - study outcome @xmath1 : @xmath360 for subjects with @xmath361 and @xmath362 , @xmath363 . here",
    ", @xmath364 is a known function , smooth in @xmath21 and a smooth , monotonic function of @xmath365 , which contrasts the counterfactuals @xmath366 and @xmath367 , and must satisfy @xmath368 for all @xmath70 and @xmath21 .",
    "for instance , with 2 time points ( @xmath136 ) a rank preserving sndm may be given by the following set of restrictions : @xmath369 a sndm relaxes these restrictions by demanding that they merely hold in distribution , conditional on the observed history ( i.e. , @xmath370 and @xmath371 ) .    to describe the effect on a repeated counterfactual future @xmath317 , we can borrow ideas from section  [ subsub : sdm ] .",
    "in particular , upon substituting @xmath30 by @xmath372 , @xmath0 by @xmath373 and @xmath120 by @xmath374 in the rank - preserving model ( [ ranksdmrep ] ) , we obtain the identity : @xmath375 for subjects with @xmath361 and @xmath362 , @xmath320 and @xmath376 .",
    "here,@xmath377 is a known function , smooth in @xmath21 and a smooth , monotonic function of @xmath378 , which contrasts the counterfactuals @xmath379 and @xmath380 , and must satisfy @xmath381 for all @xmath382 and @xmath21 . for instance , with 2 time points ( @xmath136 ) a rank preserving sndm may be given by the following set of restrictions : @xmath383\\\\[-8pt ] y_2^{a_0,0}&=&\\gamma_{1,2}\\bigl(y_2 , \\overline{l}_1,\\overline{a}_1;\\psi ^*\\bigr)\\nonumber\\\\ & = & y_2- \\bigl(\\psi^*_1+\\psi^*_2l_1 \\bigr)a_1 , \\nonumber \\\\",
    "y_2 ^ 0&=&\\gamma_{0,2}\\bigl(y_1,y_2^{a_0,0},l_0,a_0 ; \\psi ^*\\bigr)\\nonumber\\\\ & = & y_2^{(a_0,0)}-\\bigl(\\psi ^*_3 + \\psi^*_4y_1\\bigr)a_0\\nonumber\\\\[-8pt]\\\\[-8pt ] & = & y_2-\\bigl(\\psi^*_1+\\psi^*_2l_1 \\bigr)a_1\\nonumber\\\\ & & { } -\\bigl(\\psi^*_3+\\psi^*_4y_1 \\bigr)a_0.\\nonumber\\end{aligned}\\ ] ] here , the first two equations express short - term exposure effects , that is , the effect of @xmath3 on @xmath139 and of @xmath2 on @xmath138 .",
    "the third equation expresses the effect of @xmath3 on @xmath138 ( more precisely , its effect on @xmath384 ) . as in section  [ subsub : sdm ] , this equation must take into account that the effect may be different depending on the outcome level at time @xmath165 ; this allows for @xmath3 to also affect the dependence between @xmath139 and @xmath138 , but evidently complicates interpretation .",
    "more generally , rank - preserving sndms allow for the effect of @xmath385 on @xmath386 , as encoded by a contrast of @xmath380 and @xmath387 , to depend on the history of treatments and covariates up to time @xmath300 , but additionally on the potential outcome history under the treatment regime @xmath388 , up to time @xmath389 .",
    "a sndm relaxes the restrictions of a rank preserving sndm by demanding that the equality ( [ rpsndm ] ) merely holds in distribution , conditional on @xmath390 and @xmath391 . assuming that for given @xmath392 , @xmath339 has a continuous multivariate distribution with probability 1 , a sndm can thus be defined by @xmath393\\\\[-8pt ] & & \\quad   = f_{\\underline{y}_{m+1}^{\\overline{a}_{m},0 } \\mid \\overline { l}_m=\\overline{l}_m,\\overline{a}_m=\\overline{a}_m } ( \\underline { y}_{m+1 } ) , \\nonumber\\end{aligned}\\ ] ] for all @xmath394 , where @xmath395 is a vector with components @xmath396 for @xmath376 , where the components @xmath397 are defined in recursive fashion similar to in section  [ subsub : sdm ] .    under the sndm",
    ", a variable @xmath398 can be constructed which predicts how the outcomes past time @xmath300 would look like if treatment were suspended from time @xmath300 onward , in the sense that @xmath399\\\\[-8pt ]   & & \\hspace*{10pt}\\quad = p \\bigl(\\underline { y}_{m+1}^{\\overline{a}_{m-1},0 } > \\underline{y}_{m+1 } \\mid \\overline{l}_m , \\overline{a}_m=\\overline{a}_m \\bigr).\\nonumber\\end{aligned}\\ ] ] this variable can be recursively obtained for @xmath400 from @xmath401\\\\[-8pt ] & & \\hspace*{15pt}\\quad \\equiv\\gamma_{m , m+k } \\bigl\\ { \\bigl({y}_{m+1},u_{m+1:m+k}(\\psi ) \\bigr),\\overline{l}_m , \\overline{a}_m;\\psi \\bigr\\},\\nonumber\\end{aligned}\\ ] ] for @xmath376 , where we define @xmath402 to be empty for @xmath403 .",
    "for instance , in the sndm that assumes the identities in ( [ sndm : ex ] ) hold in distribution ( conditional on the observed history ) , we have that @xmath404 the identity ( [ keysndm ] ) will be useful in estimation and for predicting the effect of specific interventions on the outcome distribution",
    ".    structural nested failure time models ( snftms ) are a variant of sndms which have seen most applications to date .",
    "these link percentiles from the conditional distributions of @xmath405 and @xmath406 , conditional on @xmath407 , and for subjects who are still in the risk set ( say , alive ) at time @xmath300 : @xmath408 for @xmath409 , where @xmath101 denotes a survival function . here , @xmath410 is a known function , smooth in @xmath21 and monotonic in @xmath97 , and @xmath411 for all @xmath412 and @xmath21 .",
    "for instance , the choice @xmath413 for @xmath409 expresses that the effect of suspending treatment @xmath385 at time @xmath300 is to change the residual lifetime @xmath414 with a factor @xmath415 . for this choice of model , one can predict among individuals who survive to ( or through , or until ) time @xmath300 what their lifetime would be had treatment been suspended from time @xmath300 onward , as @xmath416 where @xmath417 denotes the largest time point in @xmath418 less than @xmath232 and @xmath419 is a random variable for which ( for @xmath409 ) @xmath420      retrospective blip models have been extended to model the effect of a sequential treatment on a scalar end - of - study outcome @xmath326 conditional on the treatment and covariate history up to end - of - study .",
    "mean models take the form @xmath421 where @xmath422 is a known function , smooth in @xmath21 and equaling zero for all @xmath423 and @xmath424 with @xmath425 .",
    "distribution models take the form : @xmath426 where @xmath427 is a known function , smooth in @xmath21 and equaling @xmath70 for all @xmath428 and @xmath424 with @xmath425 ; a rank - preserving version of this was proposed by joffe , small and hsu ( @xcite ) . for nonparametric identifiability ,",
    "restrictions are needed on the functions @xmath429 and @xmath427 , for example , that they do not involve the future @xmath430 and @xmath431 ( @xcite ) .",
    "retrospective blip models can be useful for modeling a dichotomous outcome ( @xcite ) . under these models ,",
    "identity ( [ key ] ) is satisfied with @xmath432 being a vector with components @xmath433.\\ ] ] evaluation of @xmath432 ( which is needed to make estimation of @xmath186 manageable ) then merely requires a model for @xmath434 , but not for the distribution of treatment and covariates at each time .",
    "the parameters indexing these models are nonetheless more limited than the parameters indexing snmms in that they can not be used by themselves for making treatment decisions prior to the end - of - study time , unless one integrates over the distribution of covariates subsequent to @xmath435 ( see , e.g. , @xcite ) .",
    "this section sketches identifying assumptions and inferential methods for sequential treatments . under instrumental variables assumptions sketched in section  [ subsec : iv ] and under the future ignorability assumptions sketched in section  [ sec6.2 ] ,",
    "inferential methods have been developed for snms , but these assumptions do not suffice for the identification of marginal treatment effects , and hence parameters indexing msms .",
    "the broader array of useful identifying assumptions thus constitutes an important advantage of snms .",
    "the assumption of ignorable treatment assignment can be generalised to sequential treatments as follows : @xmath436 for @xmath320 .",
    "this assumption has been called variously `` no unmeasured confounders assumption , '' `` sequential ignorability , '' `` sequential randomization '' or `` exchangeability . ''",
    "it expresses that at each time @xmath300 , the observed history of covariates @xmath329 and exposures @xmath437 includes all risk factors of @xmath372 that are also associated with future outcomes .",
    "this assumption together with identity ( [ key ] ) imply that @xmath438 for all @xmath435 under a snmm .",
    "the parameter @xmath23 indexing a snmm can therefore be estimated by solving @xmath439 \\\\ & & \\hspace*{28pt}{}\\times \\bigl[u_{im}(\\psi)-e \\bigl\\{u_{im}(\\psi ) \\mid \\overline { l}_{im},\\overline{a}_{i , m-1 } \\bigr\\ } \\bigr],\\nonumber\\end{aligned}\\ ] ] where @xmath440 is an arbitrary @xmath441-dimensional function , with @xmath198 the dimension of @xmath21 .",
    "this estimating equation essentially sets the sum across time points @xmath435 of the conditional covariances between @xmath442 and the given function @xmath443 , given @xmath444 , to zero .",
    "when the previous outcome is included in the confounder history ( i.e. , @xmath445 includes @xmath446 ) and there is homoscedasticity [ i.e. , when the conditional variance of @xmath447 given @xmath448 is constant for @xmath320 ] , then local semiparametric efficiency under the snmm is attained upon choosing @xmath450    sequential ignorability ( [ sra2 ] ) together with identity ( [ key2 ] ) moreover implies that @xmath451 for all @xmath435 under the sndm .",
    "this conditional independence restriction suggests that the parameter indexing a sndm can be solved from @xmath452 \\nonumber \\\\ & & { } -e \\bigl ( d_m \\bigl\\{u_{im}(\\psi),\\overline{a}_{im } , \\overline { l}_{im } \\bigr\\}\\\\ & & \\hspace*{23pt } { } -e \\bigl[d_m \\bigl \\{u_{im}(\\psi),\\overline{a}_{im},\\overline { l}_{im } \\bigr\\ } \\mid \\overline{l}_{im},\\overline{a}_{im } \\bigr]\\mid\\nonumber \\\\ \\eqntext {   u_{im}(\\psi),\\overline{l}_{im } , \\overline { a}_{i , m-1 } \\bigr),}\\end{aligned}\\ ] ] where the index functions @xmath453 must be of the dimension of @xmath21 .",
    "when the previous outcome is included in the confounder history ( i.e. , @xmath445 includes @xmath446 ) , then local semiparametric efficiency is obtained upon choosing @xmath454 where @xmath191 is the score for @xmath21 under the observed data likelihood @xmath455,\\end{aligned}\\ ] ] with all components substituted by suitable parametric models ( @xcite ) ; here , the term @xmath456 under sequential igorability , and thus can be ignored .",
    "this likelihood formulation is of interest in itself because it enables specifying the joint distribution of the variables in a way that is consistent with the sharp null hypothesis of no effect under the assumption of sequential ignorability , even in the presence of confounding by variables affected by treatment , which turns out more difficult with standard parameterisations ( @xcite ) .",
    "solving estimating equations ( [ eesnmm ] ) and ( [ eesndm ] ) requires a parametric model @xmath206 for the conditional distribution of the exposure @xmath372 for @xmath320 : @xmath457 where @xmath458 is a known density function , smooth in @xmath209 , and @xmath210 is an unknown finite - dimensional parameter which can be estimated via standard maximum likelihood .",
    "in addition , it requires a parametric model @xmath213 for the conditional mean ( or distribution ) of @xmath338 [ or @xmath459 for @xmath320 : @xmath460 where @xmath461 is a known density function , smooth in @xmath462 and @xmath463 is an unknown finite - dimensional parameter . as before , when the parameters @xmath209 and @xmath464 are variation - independent , then so - called g - estimators that solve ( [ eesnmm ] ) and ( [ eesndm ] ) , obtained upon substituting @xmath210 and @xmath463 by consistent estimators , are doubly robust ( robins and rotnitzky , @xcite ) : consistent when the snm and either model @xmath206 or model @xmath213 is correctly specified , regardless of which .",
    "this double robustness property of the g - estimator is desirable for various reasons .",
    "first , it provides justification for using simple models for the multivariate distribution @xmath465 or even setting @xmath466 in ( [ eesnmm ] ) for computational convenience .",
    "second , while alternative proposals that rely on correct specification of model @xmath213 ( see , e.g. , @xcite ; @xcite ) tend to give more efficient estimators ( under correct model specification ) , the concern for misspecification of model @xmath213 may be considerable in view of the aforementioned difficulty of postulating this model",
    ". this distribution can indeed be difficult to specify in view of its multivariate nature , the fact that @xmath467 represents a transformation of the observed data and that it may moreover share the same outcome over multiple time points , so that the models for @xmath468 corresponding to different time points may not be congenial at all times .",
    "this concern can be overcome by inferring the conditional expectations @xmath469 from models for the conditional distribution of @xmath470 given @xmath471 at each time @xmath435 ( @xcite ; @xcite ) .",
    "however , when the covariate @xmath329 is high - dimensional and/or strongly associated with treatment @xmath372 , specifying such models can be a thorny and nontrivial task .",
    "specified departures from ( [ sra2 ] ) can also yield identification .",
    "for instance , one can allow dependence of treatment on a specified portion of the future potential outcomes , by relaxing ( [ sra2 ] ) to ( @xcite ; @xcite ) @xmath472 for some integer @xmath473 ; such assumptions have been termed future ignorability , since the independence at @xmath435 is conditional on potential outcomes referring to times after @xmath435 .",
    "this assumption can sometimes eliminate residual confounding bias , for instance , because the treatment process occurs in continuous time but confounding covariates are only measured intermittently , as is common in observational studies ( @xcite ) , or when the future potential outcomes serve as proxies for other unmeasured confounding variables ( @xcite ) .",
    "however , it does not lead to nonparametric identification of the snm parameters , so that inference becomes more dependent on correct specification of the causal model .",
    "alternatively , deviations from sequential ignorability can be parameterized as @xmath474\\\\[-8pt ] & & \\quad\\hspace*{8pt } { } \\cdot\\exp \\bigl\\{q_m(\\underline { y}_{m+1},\\overline{l}_m,\\overline{a}_m ) \\bigr\\}\\nonumber\\\\ & & \\hspace*{21pt } { } \\cdot \\biggl(\\int t\\bigl(a_m = a_m^{\\dagger } \\mid \\overline{l}_m=\\overline { l}_m,\\overline { a}_{m-1}=\\overline{a}_{m-1}\\bigr)\\nonumber\\\\ & & \\hspace*{25pt}\\qquad { } \\cdot\\exp\\bigl \\{q_m\\bigl(\\underline { y}_{m+1},\\overline{l}_m,\\bigl(\\overline{a}_{m-1},a_m^{\\dagger}\\bigr)\\bigr ) \\bigr\\ } da_m^{\\dagger}\\biggr)^{-1 } , \\nonumber\\end{aligned}\\ ] ] with @xmath475 known , satisfying @xmath476 for all @xmath477 and with @xmath478 an unknown conditional density . with @xmath479 encoding the assumption of sequential ignorability , the function @xmath475 thus expresses the degree of departure from that assumption . as the data carry no genuine information about it , progress must be made by repeating the analysis with @xmath475 fixed at different values , which are then varied over some plausible range ( @xcite ) ; for example , by setting @xmath480 , where @xmath464 is varied between @xmath481 and 1 .      when the assumption of sequential ignorability fails , progress can sometimes be also made using an instrumental variable ( iv ) .",
    "such variable @xmath3 is assumed to satisfy @xmath482 and @xmath483 for all @xmath484 ( @xcite ) .",
    "both these assumptions together imply that the instrument @xmath3 is not associated with the outcome , except through its association with subsequent treatments @xmath485 , which may affect outcome .",
    "these or similar assumptions have been used in adjusting for noncompliance in randomized trials ( @xcite ; @xcite ; @xcite ) . with @xmath485 denoting actual treatment and @xmath3 denoting randomized treatment , these assumptions are plausible when randomization does not affect the outcome other than by influencing the actual treatment .",
    "estimation under the iv assumptions can be based on estimating equations ( [ eesnmm ] ) and ( [ eesndm ] ) , but requires setting @xmath486 and @xmath487 for @xmath488 .",
    "because of these restrictions , root-@xmath226 estimation of @xmath23 typically requires additional assumptions on @xmath489 and @xmath490 .",
    "in particular , it is commonly assumed that these functions are linear in @xmath385 and do not involve @xmath491 ; moreover , time - varying covariates are commonly ignored , that is , @xmath492 is set empty for @xmath488 .",
    "for instance , in linear smms for a single treatment @xmath2 ( i.e. , when @xmath136 ) and dichotomous instrument , @xmath493 in @xmath494 is just identified .",
    "thus residual dependencies on @xmath491 or nonlinear dependencies on @xmath495 can not be identified unless other untestable assumptions are imposed .",
    "the resulting class of g - estimators contains the popular two - stage least squares estimator as a special case ( @xcite ) .",
    "however , the framework of g - estimation for snmms and sndms has the advantage that it extends immediately to outcomes that do not lend themselves to linear modeling , for example , censored failure - time outcomes ( @xcite ) and dichotomous outcomes ( @xcite ; @xcite ) , as well as to sequential treatments ( robins and hernan , @xcite ) . for instance ,",
    "when @xmath136 and @xmath164 is empty , the logistic smm @xmath496 can be fitted by solving the smm estimating equations with @xmath50 given by @xmath497 [ cfr .",
    "( [ ulogit ] ) ] and @xmath498 substituted by the fitted value under a parametric model ( @xcite ; @xcite ) .",
    "this additional model may sometimes not be congenial with the smm and instrumental variables assumptions in the sense that there may be no choice of parameter values indexing this model that satisfies these assumptions .",
    "this can be overcome by avoiding parameterization of the main effect of @xmath3 ( conditional on @xmath298 ) in the model for @xmath499 and instead modeling the distribution of @xmath2 , given @xmath3 and @xmath298 ( @xcite ) , or by completely saturating the parameterization of the main effect of @xmath3 ( conditional on @xmath298 ) ( @xcite ) .",
    "@xcite abandon logistic smms in favor of an interesting , but difficult to interpret relative risk parameterization .",
    "alternatively , multiplicative smms can be used ; under such models , case - only estimators have been constructed , which remain valid under case - control sampling ( @xcite ) .",
    "variant assumptions have been proposed that allow use of time - varying instruments along with snmms and g - estimation .",
    "robins and hernan ( @xcite ) consider settings in which , at each time point , there is a variable whose association with the outcome of interest may be explained solely by its association with prior history and its effect on some treatment of interest . @xcite ( @xcite ) consider settings in which the conditional independence of treatment and future potential outcomes in ( [ sra2 ] ) holds for only an identifiable subset @xmath500 of the person - observations in the population rather than for all such observations .",
    "treatment assignment in that subset may thus be considered an instrument for its effect and the effect of subsequent treatments .",
    "iv analyses have several drawbacks relative to those based on sequential ignorability : ( 1 ) nonparametric identification is lost , and so inference is more dependent on correct specification of the causal model ; ( 2 ) decreased power and precision ; and ( 3 ) larger finite - sample bias .      in snftms ,",
    "type i censoring can be dealt with as previously explained by substituting @xmath501 by an arbitrary function of @xmath502 and @xmath503 , where @xmath504 where @xmath505 is a given set of @xmath506 histories which agree with the observed history of @xmath0 through time @xmath300 or @xmath233 , whichever comes first , and @xmath30 through time @xmath302 or @xmath233 , whichever comes first , and where @xmath507 is defined like @xmath419 in section [ subsec : sndm ] , but with @xmath233 replacing @xmath232 and @xmath508 and @xmath509 replacing @xmath510 and @xmath511 .",
    "identities ( [ key ] ) and ( [ keysndm ] ) suggest using @xmath512 and @xmath467 , respectively , as a prediction of @xmath513 among individuals with observed history @xmath371 .",
    "in particular , @xmath514 in snmms and @xmath515 in sndms , so that the expected outcome in the absence of treatment can be estimated as the sample average of @xmath516 in snmms and of @xmath517 in sndms . to estimate @xmath518 for a different treatment regime @xmath424 , one could use a different structural nested model ( snm ) with @xmath519 as the reference treatment regime .",
    "however , when  as often  the interest lies in comparing the expected counterfactual outcomes between different treatment regimes , then a concern is that these different snms may fail to imply a coherent model .",
    "further complications arise when the goal is to evaluate the expected counterfactual outcome following a dynamic treatment regime whereby the treatment at each time @xmath300 is assigned as a function of the treatment and covariate history up to that time ; that is , for each @xmath435 , @xmath520 .",
    "these complications can be overcome by supplementing the snm with so - called current treatment interaction functions ( @xcite ) about which the data carry no information , but which enable one to transport treatment effects in the treated to population - averaged treatment effects .",
    "for instance , let @xmath136 and suppose that a snmm has been fitted with @xmath19 the identity link .",
    "for simplicity , we focus here only on the effect of a nondynamic regime @xmath521 at an end - of - study outcome @xmath522 ; results for dynamic treatment regimes are recovered upon making the substitutions @xmath523 for @xmath521 .",
    "two current treatment interaction functions can be defined , one for each sequential treatment : @xmath524 these express how much the effects of subsequent treatment at @xmath435 [ i.e. , @xmath495 and @xmath521 at times 1 and 0 , resp . ]",
    "differ between groups that received that level of treatment at @xmath435 and those that did not . under the snmm",
    ", it is easily deduced from knowledge of @xmath525 and @xmath526 that @xmath527 equals @xmath528 because @xmath529 moreover equals @xmath530 we thus obtain that @xmath531 equals @xmath532.\\end{aligned}\\ ] ] when there is no current treatment interaction [ i.e. , @xmath533 for all @xmath534 , we thus have that @xmath535.\\end{aligned}\\ ] ] while the components @xmath536 , @xmath537 and @xmath538 can be estimated along the lines described in previous sections , a complication is that a model for the distribution of @xmath164 , conditional on @xmath539 , is needed to evaluate this ; this can be cumbersome when @xmath164 is high - dimensional .",
    "this complication is avoided in simple structural models in which there is no effect modification by post - treatment variables [ i.e. , @xmath540 is not a function of @xmath164 ] and nondynamic regimes are considered .",
    "the assumption of no current treatment interaction is satisfied under a mild strengthening of sequential ignorability such that @xmath542 for all @xmath435 and all treatment histories @xmath543 .",
    "it is likewise sometimes satisfied under a mild strengthening of the instrumental variables assumption ( [ iv ] ) such that for all treatment histories @xmath543 : @xmath544 and a mild strengthening of the structural model such that , for instance , for binary @xmath2 ( @xmath545 ) : @xmath546 for all @xmath547 . following the instrumental variables assumptions , @xmath548 and @xmath549",
    "should then be independent of @xmath3 , given @xmath298 , which respectively implies that @xmath550 it follows from this that @xmath551 , and thus again that the no current treatment interaction assumption is satisfied ( hernan and robins , @xcite ) .",
    "snms parameterize the effects of treatment at each time with subsequent treatments set to some reference level .",
    "these effects can be viewed as controlled direct effects ( @xcite ) , controlling all subsequent treatments at their reference levels .",
    "the formalism of snms is therefore more widely applicable for inferring the controlled direct effect of some target exposure @xmath3 on an outcome @xmath1 , other than through some mediator @xmath2 ( e.g. , the direct effect of the fto gene on the risk of myocardial infarction other than via body mass ) . in particular , in the snmm @xmath552 @xmath553 encodes the controlled direct effect of setting @xmath3 to zero , controlling @xmath2 at zero uniformly in the population .",
    "however , caution is warranted because @xmath554 may not encode the controlled direct effect of setting @xmath3 to zero , when controlling @xmath2 at some value @xmath555 ( @xcite ) . from knowledge that @xmath556 for all @xmath484 , one thus can not deduce that @xmath3 has no direct effect on @xmath1 ( other than via @xmath2 ) .",
    "@xcite therefore proposed directly parameterizing the controlled direct effect as @xmath557\\\\[-8pt ] & & \\quad = m\\bigl(a_0,a_1,l_0 ; \\psi^*\\bigr),\\nonumber\\end{aligned}\\ ] ] where @xmath558 is a known function , smooth in @xmath21 , which satisfies @xmath559 .",
    "in contrast to snmms , ( [ cdemodel ] ) parameterizes only the effect of @xmath491 ; in ( [ cdemodel ] ) , @xmath495 may , however , be a modifier of the effect of @xmath491 .",
    "since model ( [ cdemodel ] ) for fixed @xmath495 is a smm for the counterfactual outcome @xmath560 , the techniques of section  [ sec : assest ] would be applicable to estimate @xmath23 if @xmath560 were observed for each subject .",
    "since @xmath560 is only observed for individuals with exposure level @xmath495 , @xcite proposed treating subjects who receive a level of @xmath2 other than @xmath495 as censored and , assuming sequential ignorability , to inversely weight the data by the density @xmath561 to control resulting selection bias .",
    "this amounts to solving @xmath21 from an estimating equation of the form @xmath562\\nonumber\\\\[-8pt]\\\\[-8pt ] & & { } \\times \\bigl[y_i - m(\\overline{a}_{i1},l_{i0 } ; \\psi)\\nonumber\\\\ & & \\hspace*{14pt}{}-e \\bigl\\ { y_i - m(\\overline{a}_{i1},l_{i0 } ; \\psi ) \\mid l_{i0 } \\bigr\\ } \\bigr ] , \\nonumber\\end{aligned}\\ ] ] where @xmath563 is an arbitrary index function .",
    "more efficient and doubly robust estimators have been reported elsewhere ( @xcite ) , as well as extensions to time - varying treatments ( @xcite ) .",
    "ignorability assumptions can be violated even in randomized trials ( and mendelian randomization studies ) , where assumption ( [ iv ] ) is guaranteed by design , but the processes underlying the evolution of subsequent mediators may be poorly understood . @xcite",
    "avoid ignorability assumptions concerning the mediators by using initial randomization ( or more generally , instrumental variables assumptions ) to estimate controlled direct effects with snftms .",
    "one can also use these approaches with snmms or sndms ( e.g. , @xcite ) and , in principle , in the presence of multiple mediators .",
    "smms have also been developed for so - called natural direct effects ( @xcite ; @xcite ) . with @xmath564 denoting the counterfactual outcome if @xmath3 were set to @xmath491 and @xmath2 to the counterfactual level @xmath565 that @xmath2 would take if @xmath3 were set to zero , these are defined by contrasts between @xmath564 and @xmath566 for some @xmath567 . because @xmath565 may often reflect a natural level of @xmath2 ( as in the absence of treatment ) which differs between subjects , natural direct effects may have a more appealing interpretation than controlled direct effects .",
    "they moreover correspond with a measure of natural indirect effect in terms of contrasts between @xmath568 and @xmath564 for some @xmath567 .",
    "smms for natural direct effects have been considered @xcite and @xcite .",
    "such models are defined by @xmath569\\\\[-8pt ] & & \\quad = m \\bigl(a_0,l_0;\\psi^*\\bigr),\\nonumber\\end{aligned}\\ ] ] for each @xmath484 , where @xmath570 is a known function , smooth in @xmath21 , which satisfies @xmath571 .",
    "extensions to sequential treatments or mediators have so far not been developed in view of difficulties of identification in such settings .",
    "structural nested models were designed in part to deal with confounding by variables affected by treatment .",
    "these models maintain close resemblance to ordinary regression models by parameterizing conditional treatment effects .",
    "however , in contrast to these , they avoid conditioning on post - treatment variables by modeling the outcome at each time conditional on the treatment and covariate history up to that time ; they do this after having removed the effects of later treatments so as to disentangle the unique contributions of each treatment at each time . the associated method of g - estimation has close resemblance to ordinary regression methods because it realizes control for measured confounders through conditioning . in spite of these strong connections with popular estimation methods , snms and g - estimation have not become quite as popular as msms and the associated ipw methods ( robins , hernan and brumback , @xcite ) .",
    "the lack of popularity of g - estimation is largely related to the fact that it can not usually be performed via off - the - shelf software ; however , note that sas and stata macros for snftms and sncftms are available at http://www.hsph.harvard.edu / causal / software/. this lack of popularity is additionally related to difficulties in solving the estimating equations in the analysis of censored survival times using snftms .",
    "these difficulties can now be overcome by using the newer class of sncftms instead ( picciotto et al .",
    ", @xcite ; @xcite ) .    in spite of these limitations , snms and g - estimation allow for greater flexibility than msms and typically yield better performing estimators ( see section  [ subsec : prop ] ) .",
    "this is especially so when handling continuous exposures or when handling a binary exposure that is strongly correlated with subject characteristics ( e.g. , when the treated and untreated are very different in terms of subject characteristics ) . in the latter case",
    ", ipw estimators will typically have a poor performance , reflecting the lack of information about the treatment effect in strata where most / all subjects are treated or untreated .",
    "in contrast , because snms parameterize treatment effects conditionally on covariates , nonsaturated models allow for borrowing of information , so that g - estimators can pool the treatment effects across strata , as in expression ( [ pooling ] ) , downweighing those strata where information on treatment effect is lacking .",
    "snms can also incorporate effect modification by time - varying covariates .",
    "as such , a saturated snm encodes all possible causal contrasts on the considered scale , in contrast to msms which average the effects across ( time - varying ) covariates , thereby diluting the effects when effect heterogeneity exists on the considered scale .",
    "snms can moreover make use of instrumental variables .",
    "g - estimation is not to be confused with g - computation ( @xcite ) , which involves standardizing the predictions from an outcome model corresponding to the considered treatment regime , relative to the confounder distribution in the population . up to",
    "recently , also this approach has received little attention in practice because it is computationally intensive and because correct specification of models for the distribution of the ( possibly high - dimensional ) confounders can be a thorny issue in practice .",
    "these concerns , which also relate to likelihood - based inference under sndms ( @xcite ) , can be somewhat mitigated by summarising the confounders at each time by a longitudinal propensity score defined as the probability of treatment at that time , given the history of confounders at that time ( @xcite ) .",
    "however , this may demand correct specification of propensity score models in addition to a model for the outcome at each time .",
    "g - computation moreover does not enable a transparent parameterization of the effect of a particular treatment regime on the outcome and may thereby imply a null paradox ( robins and wasserman , @xcite ) according to which tests of the null hypothesis of no effect may be guaranteed to reject in large samples ( @xcite ) .",
    "however , recent empirical applications have turned out to be rather successful ( @xcite ) . we have attempted to make the literature on structural nested models and g - estimation more accessible , while also giving pointers to the related literatures on effect modification and mediation .",
    "variants of snms have also been developed to help identify optimal sequences of treatments when treatments may be assigned dynamically as a function of previous treatment and covariate history . in such settings ,",
    "it is more natural to model the effect of a blip of treatment at @xmath435 on a particular utility function @xmath1 , such as the outcome at the end - of - study time , if all subsequent treatments are optimal ; that is , @xmath572 for @xmath573 .",
    "this can be done by parameterizing the so - called regrets : contrasts of @xmath574 and @xmath575 ( @xcite ) . alternatively , since the optimal treatment is unknown , it may be easier to parameterize the effect of a blip of treatment at @xmath435 _ relative to no treatment _ when all future treatments are optimal",
    ". this amounts to contrasting @xmath574 and @xmath576 ( @xcite ) .",
    "we refer the reader to other papers in this issue for detailed accounts of such models .",
    "we conclude by expressing our hope that efforts will be continued to develop computational algorithms and corresponding software programs for snms , so as to make these methods accessible to a wider audience .",
    "the authors are grateful to the editors and reviewers for very detailed feedback which substantially improved an earlier version of this manuscript .",
    "the first author acknowledges support from the flemish research council ( fwo ) research grant g.0111.12 and iap research network grant no .",
    "p07/05 from the belgian government ( belgian science policy ) .",
    "the second author acknowledges support from the us nih ( grants # r01-dk090385 , rc4-mh092722 and r01-mh078016 ) ."
  ],
  "abstract_text": [
    "<S> structural nested models ( snms ) and the associated method of g - estimation were first proposed by james robins over two decades ago as approaches to modeling and estimating the joint effects of a sequence of treatments or exposures . </S>",
    "<S> the models and estimation methods have since been extended to dealing with a broader series of problems , and have considerable advantages over the other methods developed for estimating such joint effects . despite these advantages , </S>",
    "<S> the application of these methods in applied research has been relatively infrequent ; we view this as unfortunate . </S>",
    "<S> to remedy this , we provide an overview of the models and estimation methods as developed , primarily by robins , over the years . we provide insight into their advantages over other methods , and consider some possible reasons for failure of the methods </S>",
    "<S> to be more broadly adopted , as well as possible remedies . </S>",
    "<S> finally , we consider several extensions of the standard models and estimation methods . </S>"
  ]
}