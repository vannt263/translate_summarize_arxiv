{
  "article_text": [
    "modeling the circumstellar envelopes of o and b stars is a complex nonlinear problem .",
    "the non - lte level populations , the ( magneto- ) hydrodynamics , and the radiation field are strongly coupled .",
    "thus , an iterative procedure is needed to achieve a consistent solution .",
    "an essential constituent of this procedure is the availability of an accurate and fast radiative transfer code .",
    "progress in computer technology and the availability of fast numerical methods now allow the development of such codes for detailed study of 2d and 3d envelopes .",
    "there are several possible avenues to follow .",
    "the most straightforward is to solve the general radiative transfer equation @xmath0\\ ] ] and calculate the radiative transition rates using the solution . in the above",
    "@xmath1 is the direction of the radiation , @xmath2 is the specific intensity , @xmath3 is the opacity , and @xmath4 is the source function ( functional dependence is not indicated for clarity ) .",
    "alternatively , one could also use the moment equations , derived from eq .",
    "[ eq : rt ] , and solve directly for the moments @xcite which set the transition rates ; or use monte - carlo simulation to solve the radiative transfer equation and calculate estimators of the transition rates @xcite .",
    "we decided to use the first approach because of its simplicity and since it provides a reasonable compromise between numerical efficiency and flexibility .",
    "a simple iteration between the radiative transfer and the rate equations is not a wise choice for the iterative procedure .",
    "this is the so - called `` @xmath5-iteration '' which is notorious for convergence difficulties when the optical depth is large .",
    "convergence is ensured , however , by using the approximate lambda iteration ( ali , see e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) which takes some coupling of the radiation and populations into account by using an invertible approximate lambda operator ( alo ) . in our 2d code",
    "we use the local contribution at every spatial point to construct the alo because it is easy to calculate and has acceptable convergence characteristics .",
    "the actual implementation of the ali procedure into our full non - lte model atmosphere will be discussed in @xcite .",
    "the optical depth and the formal solution of eq .",
    "[ eq : rt ] at any position , @xmath6 , along a ray are @xmath7 respectively .",
    "the intensity can be calculated by specifying i@xmath8 at the up - stream end of the ray ( or characterisitic ) and by evaluating two integrals . for this purpose",
    ", we use the `` short characteristic '' ( sc ) method , first explored by @xcite and @xcite .",
    "this method requires the evaluation of the integrals only between the point of interest and the closest cell boundary and uses the calculated intensities at other grid points to interpolate @xmath9 . in the spherical coordinate system the directional variation of the intensity is normally described by the radiation coordinates @xmath10 and @xmath11 , which are defined by @xmath12 \\cdot \\left [ \\underline{\\bf r } \\times \\underline{\\bf z } \\right ]    \\ ; , \\end{aligned}\\ ] ] respectively ( see fig .",
    "[ fig1 ] for definitions ) .",
    "unfortunately , @xmath10 and @xmath11 vary along a characteristic so using the same @xmath10 and @xmath11 grid for all spatial points would require interpolations in these angles . to avoid this additional interpolation",
    "we describe a characteristic with @xmath13 which we call the `` impact parameter vector '' ( see fig .",
    "[ fig1 ] ) .",
    "this vector describes all essential features of a characteristic and can be considered as an analog of the orbital momentum vector in two body problems .",
    "its absolute value p= @xmath14*p*@xmath14 is the traditional impact parameter while its orientation defines the `` orbital plane '' of the radiation ( the plane that contains the characteristic and the origin ) .",
    "following the analogy one can define an `` inclination '' angle for this plane by @xmath15 in our code we set up a universal grid in impact parameters and in inclination angles and calculate the radiation coordinates by @xmath16 for each grid point ( see fig  [ fig1 ] for definitions ) .",
    "we evaluate eq .",
    "[ eq : fs ] in the comoving frame of the point of interest which is the proper frame for solving the rate equations . to ensure that the spatial and frequency variations of the opacity and source function are mapped properly in the integrations , we add extra integration points to the characteristics .",
    "the number of the extra points ( at least one ) depends on the ratio of the line of sight velocity difference between the endpoints and a `` maximum allowed velocity difference '' which is a free parameter in the code .",
    "the opacities and source terms at every comoving frequency are then interpoleted onto the integration points by bi - linear approximations using the four closest spatial grid points .",
    "it is relatively easy to construct a diagonal alo in this evaluation scheme .",
    "with the exception of the intensity we interpolate all quantities in first order .",
    "however , the accuracy of this approximation is insufficient in many cases ; therefore , we introduced a rudimentary multi - grid approach . before evaluating eq .",
    "[ eq : fs ] , we calculate opacity and source function on a dense grid by using a sophisticated 3@xmath17 order approximation . then , the transfer equation is solved on the original grid using the dense grid for opacity and source term interpolations .",
    "we tested our code by reproducing spherical symmetric cmfgen models @xcite , as well as the results of an accurate 2d long characteristic program ( see * ? ? ?",
    "the 2d models were static with schuster - type inner boundary conditions and included electron scattering iterations .",
    "we were able to reproduce all test cases within @xmath185% accuracy . in figs .",
    "[ fig2 ] and [ fig3 ] we demonstrate the capabilities of our code by showing the results for a rotating stellar envelope .",
    "the model was produced by using the opacities and emissivities from the results of a realistic cmfgen simulation and by introducing a rotational velocity field .",
    "as expected the spectral lines show the rotational broadening ."
  ],
  "abstract_text": [
    "<S> we discuss work toward developing a 2.5d non - lte radiative transfer code . </S>",
    "<S> our code uses the short characteristic method with modifications to handle realistic 3d wind velocities . </S>",
    "<S> we also designed this code for parallel computing facilities by representing the characteristics with an impact parameter vector * p*. this makes the interpolation in the radiation angles unnecessary and allows for an independent calculation for characterisitcs represented by different * p * vectors . </S>",
    "<S> the effects of the velocity field are allowed for by increasing , as needed , the number of grid points along a short characteristic . </S>",
    "<S> this allows us to accurately map the variation of the opacities and emissivities as a function of frequency and spatial coordinates . in the future we plan to use this transfer code with a 2d non - lte stellar atmosphere program @xcite to self - consistently solve for level populations , the radiation field and temperature structure for stars with winds and without spherical symmetry </S>"
  ]
}