{
  "article_text": [
    "the firing rate characterizes the behavior of spiking neurons and it is often used to evaluate the information encoded in neural responses .",
    "its use dates back to @xcite who first assumed that information sent by a neuron is encoded in the number of spikes per observation time window .",
    "the frequency transfer function is then often studied to illustrate the relationship between input signal and firing rate , taken as constant for a fixed signal . typically , the firing rate increases , generally non - linearly , with an increasing stimulus intensity @xcite .",
    "the main objection to the use of the transfer function is that it ignores any information possibly encoded in the temporal structure of the spike train .",
    "furthermore , different definitions of _ rate _ give rise to different shapes of the frequency transfer function .",
    "they are equivalent under specific conditions and differ in other instances ( see @xcite ) .",
    "when the firing rate is not constant , specific techniques are necessary to estimate the instantaneous firing rate avoiding artifacts ( see @xcite for a review ) .",
    "an important tool in this framework is the kernel method .",
    "optimizing the choice of kernels and of bins becomes necessary in the case of a time dependent input ( see @xcite , @xcite ) .",
    "a method to estimate the firing rate in presence of non - stationary inputs was recently proposed in @xcite for the case of slowly varying signals while @xcite consider also the latency to improve the firing rate estimation .",
    "a time dependent instantaneous firing rate is often related to a time dependent input but in fact appears anytime the isis are not exponentially distributed .",
    "the case of independent identically distributed isis can be studied in the framework of renewal theory for point processes ( see e.g.  @xcite ) . however",
    ", neuronal spike trains rarely verify the renewal hypothesis .",
    "even those spike trains that can be described as stationary often exhibit serial dependence among interspike intervals as already noted in , @xcite and more recently showed in @xcite .",
    "the presence of an external signal is a further cause of dependence between isis . in this case , beside the renewal property ,",
    "the process may lose also the stationarity .",
    "for example , adaptivity in presence of an external input determines non stationary dependent isis .",
    "@xcite enlighten important features of neural code determined by this phenomenon : decrease of the noise in the population rate code , faster and more reliable transmission of modulated input rate signals and the fact that a postsynaptic neuron can better decode a small change in its input if the presynaptic neurons are adaptive .",
    "@xcite propose a markov model to describe adaptivity .",
    "their study is performed on a group of neurons by considering the ensemble firing rate in the framework of inhomogeneous renewal processes theory through inhomogeneous hazard rate functions .",
    "dependent isis are observed also in absence of external input .",
    "@xcite report experimental findings of negative serial correlation in isis observed in the sensory periphery as well as in central neurons in spontaneous activity .",
    "these observations can not be related to input features and arise in stationary conditions .",
    "poisson and gamma renewal processes are used extensively to model isis of cortical neurons ( see for example @xcite ) . for these neurons the instantaneous firing rate",
    "is generally estimated assuming the independence of isis . however ,",
    "when the isis are dependent , the instantaneous firing rate is no longer the correct tool to analyze the data .",
    "indeed it does not change for independent or dependent isis when the common marginal distribution is the same ( think for example of exponentially or gamma distributed but dependent isis ) .",
    "the use of the hypothesis of stationarity allows us to introduce the necessary statistical tools for the study of identically distributed dependent isis .    to enlighten the role of the isis dependencies on the firing rate , a conditional instantaneous firing rate is considered . indeed by using conditional distributions",
    "it is possible to remove the classical renewal hypothesis @xcite .",
    "the instantaneous conditional firing is updated after each isi , thus accounting for the dependency between isis .",
    "@xcite computed the conditional firing time of isis following an isi of specified duration .",
    "estimators for the conditional spiking intensity exist in the literature in the framework of maximum likelihood methods ( see @xcite .",
    "advantages of such estimators include the possibility to perform tests of hypotheses , to evaluate efficiency features or to compute standard errors . however , these advantages are based on the assumption that a specific model fits the data and no result holds when the model is not true or is unknown .",
    "unfortunately , the model is known in a relative small number of cases and often its choice introduces non controllable approximations .",
    "regression modeling of conditional intensity was considered by @xcite .",
    "recent works in this framework concern seismologic analysis and perform non parametric regression using kernel methods to consider space - time dependencies @xcite .",
    "aim of this paper is to determine a conditional firing rate estimator for dependent isis avoiding to introduce a model to describe their distribution .",
    "we suggest a non parametric estimator for the instantaneous firing rate , conditioned on the past history of the spike train . under suitable hypotheses",
    "we prove the consistency of the proposed estimator .",
    "the paper is organized in the following way . in section [ s2 ]",
    "we recall different definitions of the firing rate taking care to enlighten their features if the isis are dependent . in section [ s3 ]",
    "we propose an estimator of the conditional instantaneous firing rate of a neuron characterized by an isi sequence that can be modeled as a markov , ergodic and stationary process .",
    "the consistency of this estimator is proved in the appendix .",
    "the direct check of markov , ergodic and stationary hypotheses on the available data is not easy but it is necessary to make reliable the estimates .",
    "hence in section [ s5 ] we develop a statistical algorithm to validate _ a posteriori _ our estimation by checking the underlying hypotheses by means of the obtained estimate . in section [ s6 ]",
    "we apply the proposed method to estimate the conditional firing rate of simulated dependent isis . for this aim",
    "we resort to the stochastic two compartment model proposed in @xcite .",
    "indeed @xcite recently showed that suitable choices of the parameters of this simple model allow to generate sequences of isis that are statistically markov , ergodic and stationary .",
    "finally , in section [ s7 ] we apply our results to in vitro experimental data .",
    "the firing rate can be defined in many different ways . here",
    "we report the most usual ones , their relationships and which spike train features best enlighten each of them .",
    "the ability of each definition to catch the nature of neural code strongly depends on the nature of the observed spike train .",
    "specifically we distinguish the case of independent identically distributed isis from the case with dependent isis .",
    "let us describe the spike train through the isis and let @xmath0 be a random variable with the same distribution of the isis , shared by the entire spike train .",
    "the most used definitions ( see among others * ? ? ?",
    "* ; * ? ? ?",
    "* ) are the inverse of the average isi @xmath1 which is commonly called _ firing rate _ , and the expectation of the inverse of an isi @xmath2 called the _ instantaneous mean firing rate_. values obtained with the second definition are always larger than those computed on the considered interval through @xmath3 @xcite .",
    "identical distribution of isis is required to give sense to these definitions .",
    "a different description of spike trains makes use of the number of spikes occurred up to time @xmath4 , i.e.  the counting process @xmath5 , @xmath6 ( see e.g. * ? ? ?",
    "the quantity @xmath7 , is a measure of the instantaneous firing rate accounting for the total number of spikes @xmath5 up to time @xmath4 .",
    "the firing rate and the quantity @xmath7 are connected through the well - known asymptotic formula @xmath8 @xcite .",
    "an alternative definition of the instantaneous firing rate is ( e.g. * ? ? ?",
    "* ) @xmath9}{\\delta t}.\\ ] ] this last expression does not consider the cumulative property of @xmath7 that involves the whole history of the spike train . when the isis have a common distribution , it can be expressed in terms of the isis distribution through @xmath10 where @xmath11 is the probability density function of the random isi @xmath0 ( * ? ? ?",
    "* chapter 6 ) .    to illustrate the use of these quantities",
    "let us consider a spike train with exponentially distributed isis , which can not be shorter than a constant @xmath12 .",
    "this constant @xmath12 models the refractory period of a neuron @xcite .",
    "then the isi distribution is @xmath13 , for every @xmath14 . in this case",
    "the firing rate and the mean instantaneous firing rate are , respectively , @xmath15 where @xmath16 is the incomplete gamma function . on the other hand",
    "if we compute the instantaneous firing rate by or , equivalently , by , we get @xmath17 we explicitly remark that we would obtain the same firing rates in the case of dependent isis with the same common distribution , as , and do not consider any possible dependence on spike train history .",
    "more realistic instances should consider either dependent and/or not identically distributed random variables .",
    "in particular , defining the firing rate as the instantaneous firing rate ( [ tfr ] ) , conditioned on the spike train history @xcite , @xmath18}{\\delta t},\\ ] ] makes possible to account for isis dependencies .",
    "mathematically , function ( [ ctfr ] ) is known as the conditional intensity function of the underlying counting process @xmath5 .",
    "it measures the probability of a spike in @xmath19 when the presence of a spike depends on the history of the spike train .",
    "if the process is an inhomogeneous poisson process , @xmath20 coincides with the rate of the process .",
    "it can also be defined in terms of the isis @xmath21 given the past sequence of the isis @xmath22 .",
    "consider a fixed time interval @xmath23 $ ] , @xmath24 and denote by @xmath25 the ordered set of the firing epochs until time @xmath26 .",
    "then the isis sequence can be expressed as @xmath27 and the conditional probability density is @xmath28 it is now possible to introduce the alternative definition ( * ? ? ?",
    "* section 7.2 ) , @xmath29 this definition can be proven equivalent to ( [ ctfr ] ) . here",
    "the functions    @xmath30=\\frac{f(t)}{s(t)},\\ ] ]    @xmath31 \\notag \\\\                  & = \\frac{f_i(t| t_j , j=1,\\dots , i-1)}{s_i(t|t_j , j=1,\\dots , i-1 ) } ,                  \\qquad i\\geq2 ,              \\end{aligned}\\ ] ]    are the isi hazard rate function and the conditional isi hazard rate function , respectively",
    ". furthermore , @xmath32 and @xmath33 are the corresponding survival functions .",
    "next in order of complexity to renewal processes , are point processes characterized by successive inter - events intervals that form a first order markov chain . for a renewal process",
    "the instantaneous firing rate depends only on the time elapsed since the last spike occurred , while for a first order markov point process it depends also on the previous isi . in the following we determine the conditional instantaneous firing rate for a model with this property .",
    "note that the idea to consider inter - events models according with a first order markov chain is not new . a first example in this direction",
    "is discussed in @xcite where a marked poisson process characterized by markov inter - event times is discussed .",
    "other classical examples of first order markov inter - event times for point processes are discussed in @xcite . here",
    "we introduce an alternative example illustrating also the use of copulas to generate inter - event times with assigned marginal distribution that determine a markov chain .",
    "[ ued ] let us reconsider the example with exponential isis in presence of a refractory period .",
    "it is obvious that the conditional instantaneous firing rate coincides with the unconditional instantaneous firing rate ( [ exfr ] ) when we have independent isis .    then let us assume the presence of dependence between isis . avoiding any attempt to give a biological significance to our example let us here hypothesize that    * the isi sequence is markov , i.e.  in , we have @xmath34 , * the isis @xmath35 and @xmath36 , @xmath37 , are dependent with joint distribution function @xmath38[1-f(\\vartheta)]\\rbrace ,                  \\end{aligned}\\ ] ] where @xmath39 , @xmath40 , that corresponds to considering a copula distribution of the farlie ",
    "morgenstern family ( see @xcite , formula 3.2.10 ) , @xmath41 with @xmath42",
    ".    if we compute the conditional instantaneous firing rate ( [ ctfr ] ) , according to equation ( [ lambda ] ) , we get @xmath43 for @xmath44 , @xmath45 , for @xmath46 , and @xmath47 with @xmath48 . despite the exponential distribution of the isis",
    ", we note that dependent isis determine a time dependent instantaneous firing rate ( see fig .",
    "[ mouse ] for an example ; in grey , for comparison , the instantaneous firing rate ) .    a realization of the theoretical conditional instantaneous firing rate ( black ) together with the corresponding instantaneous firing rate ( grey ) . here",
    "the parameters are fixed at @xmath49 and the recorded isis are indicated by successive dashed vertical lines .",
    "note that the conditional instantaneous firing rate is _ updated _ after each recorded spike . except the initial period of time after each spike where the conditional instantaneous firing rate is zero ( due to presence of refractoriness through the parameter @xmath12 ) ,",
    "in general it is not constant .",
    "note that the unconditional and conditional firing rates coincide for @xmath50 . in order to clarify the contribution of the dependence between consecutive isis to the behavior of the conditional instantaneous firing rate , note that after a very short isi ( such as the one starting right after time @xmath51 ) the conditional instantaneous firing rate becomes very high ( after the time lapse @xmath12 during which is zero ) .",
    "viceversa , the isi recorded around time @xmath52 , which is quite long , implies a succeeding low conditional instantaneous firing rate .",
    "furthermore notice how the conditional instantaneous firing rate exhibits a relaxation towards the instantaneous firing rate ( grey ) as time passes ( see for instance the isi starting around @xmath53 ) .",
    "this is connected to the fact that memory ( dependence ) is less and less important as time flows . ]",
    "the estimation of the firing rate makes use of the observed isis or of the observed counting process .",
    "usually the estimators @xmath54 are used for the inverse of the average isi and for the instantaneous mean firing rate , respectively .",
    "the ratio between the number of spikes in @xmath55 and @xmath4 can be used to estimate @xmath7 .",
    "while the considered estimators have a very intuitive meaning if the isis are independent and identically distributed they lose their significance for dependent or not identically distributed isis .",
    "when the process is not stationary these estimators are applied on successive suitable time windows in order to detect the time evolution of the observed firing rate .",
    "estimation techniques for equations and depend upon the knowledge of @xmath11 and @xmath56 , @xmath57 , respectively .",
    "when these densities are given or hypothesized from data , classical parametric methods can be applied @xcite .",
    "hazard rate function estimators assuming the independence of the sample random variables have good convergence properties , but their application to dependent neural isis is not legitimate . a contribution to the study of hazard rate function estimation in presence of dependence",
    "is considered in @xcite in the framework of adaptation analysis . in the same framework ,",
    "@xcite discuss a quasi - renewal approach to conditional firing rate estimation ( see also the references therein ) . a contribution to the study of the stationary case",
    "is the subject of the following sections .",
    "the definition ( [ lambda ] ) of the conditional instantaneous firing rate depends on the hazard rate functions ( [ hazard1a ] ) and ( [ hazard1b ] ) of the underlying isi process .",
    "hence our firing rate estimation problem is strictly connected to the estimation of these hazard rate functions .",
    "we model the isis as a markov , ergodic and stationary process .",
    "hence the isis are identically distributed random variables with shared unconditional probability density function @xmath11 . furthermore ,",
    "due to the markov hypothesis , the conditional probability density functions ( [ hazard2b ] ) become @xmath58 therefore , the conditional hazard rate function ( [ hazard1b ] ) simplifies to @xmath59 where @xmath60 is the associated conditional survival function .    in order to estimate the instantaneous conditional firing rate we propose the following non - parametric estimator for the isi conditional hazard rate function : @xmath61 where @xmath62 and @xcite @xmath63 with @xmath64 @xmath65 the estimator is a uniform strong consistent estimator for the isi conditional probability density function on any compact interval @xmath66 \\subseteq { \\mathbb{r}}_+$ ] . here",
    "@xmath67 is a sequence of positive real numbers satisfying @xmath68 and @xmath69 , @xmath70 , are real - valued kernel functions verifying @xmath71 moreover , we assume that the kernels have bounded variation and that @xmath72 is strictly positive .    note that , in order to estimate , the use of a sample of @xmath73 implies to start the observation in correspondence of a spike time , i.e. an arbitrary event .",
    "hence , according with @xcite we perform a _",
    "synchronous sampling_. a different approach could consider an arbitrary starting time ; relations between these two cases were discussed in @xcite .",
    "we do not consider the value of the instantaneous firing rate on the first isi because of the lack of knowledge on the preceding isi .",
    "however , it is possible to estimate the unconditional firing rate through @xmath74 where @xmath75 .    in figure [ figfig ]",
    "we reconsider example [ ued ] for which we compare the theoretical conditional instantaneous firing rate with its conditional estimator .",
    "two different realizations of the theoretical conditional instantaneous firing rate ( black line ) together with its estimate ( grey line ) .",
    "the parameters are @xmath76.,title=\"fig : \" ] + two different realizations of the theoretical conditional instantaneous firing rate ( black line ) together with its estimate ( grey line ) .",
    "the parameters are @xmath76.,title=\"fig : \" ]    note furthermore that the use of to estimate in is an approximation because the sampling does not start at time zero of the theoretical model .",
    "we have the following theorem .    [ hazarda ]",
    "let us consider a simple point process @xmath5 ( i.e.  a point process admitting at most one single event at any time ) , with markov , ergodic and stationary inter - event intervals @xmath35 , @xmath37 . under some regularity conditions on the isi probability density functions and the kernels @xmath72 and @xmath77 , for all sequences @xmath78 satisfying @xmath79 ( see appendix [ baba ] for complete details )",
    "the estimators ( [ hazardl ] ) and ( [ hazardc ] ) are uniform strong consistent estimators of the hazard rate functions ( [ hazard1a ] ) and ( [ h2 ] ) on @xmath80 $ ] , @xmath81 , i.e. @xmath82}\\left|\\hat{h}_n(t)-h(t)\\right|=0 \\qquad \\text{a.s.}\\ ] ] @xmath83 ^ 2}\\left|\\hat{h}_n(t| \\tau)-h(t| \\tau)\\right|=0 \\qquad \\text{a.s.}\\ ] ]    first , note that since on each observed bin it is impossible to record more than a single spike , it is reasonable to model the spike train through a simple point process .",
    "second , an estimator for @xmath84 can be given as @xmath85 formula holds for @xmath86 , because for an ergodic and stationary process , the estimation of @xmath87 in the first isi can not be performed in the lack of knowledge on the preceding isi .",
    "the markov , the ergodic and the stationary hypotheses concern the isis processes , i.e.  the times @xmath88 . if the isis fulfill these hypotheses holds .",
    "note that the index set of the process @xmath89 is discrete and coincides with the positives integers .",
    "this hypothesis does not imply any stationary hypothesis on the process @xmath5",
    ", @xmath90 , that is an increasing process counting the number of spikes up to time @xmath4 .",
    "note that this last process has a continuous time index set . despite these facts",
    "the two processes are related .",
    "indeed it holds @xmath91",
    "the firing rate estimator has good asymptotic properties when isis can be modeled through stationary ergodic processes . having a sample of isis",
    ", specific tests of stationarity can be performed , checking the behavior of their mean or of higher moments or even using _ ad - hoc _ techniques as in @xcite .",
    "these checks can not guarantee strong stationarity of isis but can help to detect time dependencies .",
    "more difficult is the check of ergodicity .",
    "this is a model feature that can not be tested from a single time record of isis . wishing to analyzing the reliability of the proposed estimator , we present here an",
    "_ a posteriori _ validation algorithm .",
    "the idea of such procedure is the following .",
    "we know that , due to the time - rescaling theorem , any simple point process with an integrable conditional intensity function @xmath20 may be transformed into a unit - rate poisson process , by the random time transformation @xmath92 ( see appendix [ resc ] for the complete statement of the theorem ) .",
    "hence , we perform such transformation and we check whether the obtained point process is a unit - rate poisson process . if we can not reject the poisson characterization of the transformed process , we conclude that our estimator is reliable , having correctly acted as a firing rate .    formalizing , we first compute the conditional firing rate estimator @xmath93 , defined by equation ( [ est ] ) .",
    "then , we perform the following time transformation @xmath94 under this time - change , the isis @xmath95 , @xmath37 and @xmath96 , become @xmath97 if the firing rate estimator ( [ est ] ) is reliable , i.e.  if the hypotheses supporting its computation are verified , the transformed isis ( [ tildet ] ) should be independent and identically distributed ( i.i.d . )",
    "exponential random variables with mean 1 , according to the time - rescaling theorem .",
    "hence , a way to validate our estimator on sample data is to check the independence and exponential distribution of the transformed isis .",
    "we can perform a goodness - of - fit test to verify whether the sequence @xmath98 follows the exponential distribution with mean 1 .",
    "then we can compute any dependence index , like the correlation coefficient @xmath99 @xcite or the kendall s tau @xcite , of the couples @xmath100 , @xmath101 , to check whether the successive transformed isis are independent .    here",
    "we propose also another alternative test of the hypotheses on the transformed isis , based on the concept of independent copula .",
    "intuitively the independent copula is the joint probability distribution of two independent uniform random variables .",
    "any group of independent random variables is characterized by the independent copula ( see appendix [ cop ] ) . having a sample of random variables following a distribution @xmath102",
    "it can be transformed into a sample of uniform random variables through the transformation @xmath103 @xcite .",
    "when our estimation of @xmath87 is reliable , the sample obtained through transformation should contain independent exponential random variables of parameter @xmath104 .",
    "in particular it should be characterized by the independent copula . to verify this , we consider the further isi transformation , based on the exponential distribution assumption , @xmath105 when @xmath106",
    ", @xmath107 is a collection of i.i.d .",
    "uniform random variables on @xmath108 $ ] .",
    "therefore , the copula of @xmath109 and @xmath110 , @xmath111 , should be the independent copula with uniform marginals .",
    "hence , another way to verify the reliability of on the transformed isis is to perform a uniformity test ( goodness - of - fit test for the uniform distribution on @xmath108 $ ] ) and a goodness - of - fit test for the independent copula on the collection @xmath107 . in particular , we apply the goodness - of - fit test for copulas proposed in @xcite .",
    "see appendix [ lavagna2 ] for a description of the steps of the proposed algorithm .",
    "various first order markov models could be used to exemplify the proposed technique ( see @xcite and the papers cited therein ) .",
    "we consider here the stochastic two - compartment model proposed in @xcite .",
    "it is a two - dimensional leaky integrate and fire type model that generalizes the one - dimensional ornstein  uhlenbeck model @xcite .",
    "the two - compartment , for specific choices of the parameters , can exhibit independence or markov property of different orders .",
    "the rationale for choosing this model lies in the fact that we wanted to deal with samples eventually not verifying assumptions supporting the reliability of our estimator .",
    "in fact , this example gives us the opportunity to illustrate the use of our `` a posteriori validation algorithm '' .",
    "the introduction of the second component allows us to relax the resetting rule of the membrane potential . in a recent paper we showed that spike trains generated by this model exhibit dependent isis for suitable ranges of the parameters @xcite .",
    "here we use isis generated by this model to estimate the conditional firing rate through the estimator proposed in this paper .    in the stochastic two compartment model the neuron is described by two interconnected compartments , modeling the membrane potential dynamics of the dendritic tree and the soma , respectively .",
    "the dendritic component is responsible for receiving external inputs , while the somatic component emits outputs .",
    "hence , external inputs reach indirectly the soma by the interconnection between the two compartments .    the model is then described by a bivariate diffusion process @xmath112 , whose components @xmath113 and @xmath114 model the membrane potential evolution in the dendritic and somatic compartment , respectively . assuming that external inputs have intensity @xmath115 and variance @xmath116 , the process obeys to the system of stochastic differential equations @xmath117+\\mu\\rbrace dt+\\sigma db(t ) , \\vspace*{3mm}\\\\                  dx_2(t ) = \\lbrace -\\alpha x_2(t)+\\alpha_r\\left[x_1(t)-x_2(t)\\right]\\rbrace dt",
    ".              \\end{cases}\\ ] ] here @xmath118 accounts for the strength of the interconnection between the two compartments , while @xmath119 is the leakage constant that models the spontaneous membrane potential decay in absence of inputs .    .",
    "in the upper and middle figures , the membrane potential respectively in the dendritic and somatic compartment is depicted .",
    "the lower figure shows the corresponding estimated conditional instantaneous firing rate @xmath120 . here",
    "the parameters are set to @xmath121 .",
    "the estimation is performed by means of gaussian kernels with standard deviation set at @xmath122 .",
    "the isis here are rather short and the instantaneous firing rate rather high ( but unknown ) .",
    "this can be understood by noticing that the conditional instantaneous firing rate is still growing when a new spike ( and therefore a new conditioning event ) occurs .",
    "the faster the instantaneous firing rate is , the sooner a conditioning event happens but still the presence of dependence between consecutive isis can be appreciated by considering the fact that after each recorded isi the conditional instantaneous firing rate grows differently.,title=\"fig : \" ] + . in the upper and middle figures , the membrane potential respectively in the dendritic and somatic compartment is depicted .",
    "the lower figure shows the corresponding estimated conditional instantaneous firing rate @xmath120 . here",
    "the parameters are set to @xmath121 .",
    "the estimation is performed by means of gaussian kernels with standard deviation set at @xmath122 .",
    "the isis here are rather short and the instantaneous firing rate rather high ( but unknown ) .",
    "this can be understood by noticing that the conditional instantaneous firing rate is still growing when a new spike ( and therefore a new conditioning event ) occurs .",
    "the faster the instantaneous firing rate is , the sooner a conditioning event happens but still the presence of dependence between consecutive isis can be appreciated by considering the fact that after each recorded isi the conditional instantaneous firing rate grows differently.,title=\"fig : \" ] + . in the upper and middle figures , the membrane potential respectively in the dendritic and somatic compartment is depicted .",
    "the lower figure shows the corresponding estimated conditional instantaneous firing rate @xmath120 . here",
    "the parameters are set to @xmath121 .",
    "the estimation is performed by means of gaussian kernels with standard deviation set at @xmath122 .",
    "the isis here are rather short and the instantaneous firing rate rather high ( but unknown ) .",
    "this can be understood by noticing that the conditional instantaneous firing rate is still growing when a new spike ( and therefore a new conditioning event ) occurs .",
    "the faster the instantaneous firing rate is , the sooner a conditioning event happens but still the presence of dependence between consecutive isis can be appreciated by considering the fact that after each recorded isi the conditional instantaneous firing rate grows differently.,title=\"fig : \" ]    whenever @xmath114 reaches a characteristic threshold @xmath123 the neuron emits an action potential .",
    "then @xmath114 restarts from a resetting potential value that we assume equal to zero ( a shift makes always possible this choice ) while @xmath113 continues its evolution .",
    "the absence of dendritic resetting makes the isis dependent on the past evolution of the neuron dynamics .",
    "sensitivity analysis was applied in @xcite to determine the model values of parameters that make its isis stationary but dependent .",
    "here we simulate samples of 1000 isis from this model for different choices of the parameters , we determine the conditional firing rate corresponding to each choice and we check the reliability of the obtained results by means of the algorithm proposed in the previous section . according to the hypotheses of theorem [ hazarda ] ( see appendix [ baba ] ) for our study we use :    1 .",
    "gaussian kernels @xmath72 and @xmath77 with mean zero and standard deviation equal to @xmath124 ; 2 .",
    "kernel weights @xmath125 where @xmath126 is the sample size and @xmath127 .",
    "we report the results of the algorithm in table [ tab2 ] .",
    "the first three cases in table [ tab2 ] correspond to markov dependent isis as shown in @xcite .",
    "the proposed estimator can not be safely applied in the fourth case of table [ tab2 ] .",
    "indeed the use of algorithm of section [ s5 ] shows that the hypotheses for its use are not verified . in this case , successive isis exhibit longer memory , as suggested in @xcite .",
    "a variant of the proposed estimator can be easily developed to account for this longer memory .",
    "for example one should consider a rate intensity conditioned on the two previous isis .",
    ".results of the uniformity test and the copula goodness - of - fit test of algorithm [ alg ] , applied on isis simulated by the two - compartment model ( [ bicomp ] ) . in the last case",
    "the copula goodness - of - fit test fails , as the isi process is statistically a markov process of order 2 .",
    "indeed for values of @xmath115 close to the threshold @xmath123 , the isis become very short and the evolution of the two - compartment model is more dependent on its past history ( see @xcite for details ) . [ cols=\"^,^,^ \" , ]",
    "we analyze here experimental data taken from the internet ` gerstner / quantneuronmod2007/ ` ] .",
    "this data were recorded and discussed by @xcite and correspond to single electrode in vitro recordings from rat neocortical pyramidal cells under random in vivo - like current injection .",
    "we limit our discussion to the analysis of the dataset file ` 07-1.spiketimes ` .",
    "the injected colored noise current ( ornstein  uhlenbeck process ) determines dependencies between isis . for the analyzed dataset",
    ", the colored noise has a mean of 320 pa and a standard deviation of 41 pa . according to @xcite",
    ", cells responded with an action potential activity with stationary statistics that could be sustained throughout long stimulation intervals .",
    "the kendall s tau test on adjacent isis reveals a negative dependence ; indeed @xmath128 and the independence test furnishes us with a p - value equal to @xmath129 . note that the lack of independence may be due both to the colored noise and to causes internal to the neuron s dynamics . due to this fact it becomes interesting to estimate the conditional instantaneous firing rate ( see fig .",
    "[ datidati ] ) .",
    "the _ a posteriori _",
    "test for ergodicity ( see algorithm  [ alg ] ) confirms the reliability of our estimation . indeed the uniformity test on the transformed isis gives a p - value equal to 0.92 and",
    "the independence of the time - changed isis is confirmed by a test on the kendall s tau ( @xmath130 , @xmath131 ) .",
    "furthermore , the goodness - of - fit copula test for independence copula gives a p - value equal to @xmath132 .",
    "an example of the estimated conditional instantaneous firing rate for real data as described in section [ s7 ] . the estimation is performed with gaussian kernels with standard deviation set at @xmath122 .",
    "time is measured in milliseconds . ]",
    "the analysis of the features exhibited by recorded isis often ground on the study of their statistics .",
    "the most used quantities in this framework are the firing rate and the instantaneous firing rate .",
    "tipically its estimation is performed assuming that isis are independent despite experimental evidence on dependencies between successive isis .",
    "this choice may influence analysis results .",
    "here we stressed consequences of ignoring dependencies on the the instantaneous rate estimation and we propose a non parametric estimator for the case of ergodic stationary isis with successive isis characterized by the markov property .",
    "the use of such estimator could improve data analysis .",
    "we illustrated the use of the proposed estimator on simulated  and on in vitro recorded data .",
    "furthermore we proved its consistency property and we gave an algorithm to check the markov ergodic stationary hypothesis on data .",
    "a natural extension of the proposed approach refers to data exhibiting memory also between non contiguous isis .",
    "furthermore we plan to apply the method to non stationary data introducing their preliminary cleaning from possible periodicity or presence of trends .",
    "work supported in part by university of torino grant 2012 _ stochastic processes and their applications _ and by project amalfi ( universit di torino / compagnia di san paolo ) .",
    "for the sake of completeness we recall here the time - rescaling theorem that is a well - known result in probability theory . in neuroscience",
    "it is applied for example in @xcite and @xcite to develop goodness - of - fit tests for parametric point process models of neuronal spike trains .",
    "[ t - resc - theo ] let @xmath5 be a point process admitting only unitary jumps , with integrable conditional intensity function @xmath20 , modeling a spike train with interspike intervals @xmath95 , @xmath37 , where @xmath96 and @xmath133 , @xmath37 , are the spiking epochs .",
    "we define @xmath134 then , under the random time transformation @xmath135 , the transformed process @xmath136 is a unit - rate poisson process .",
    "moreover the transformed isis @xmath137 are i.i.d .",
    "exponential random variables with mean 1 , as they are waiting times of a unit - rate poisson process .",
    "let us consider two uniform random variables @xmath138 and @xmath139 on @xmath108 $ ] .",
    "assume that they are not necessary independent .",
    "they are related by their joint distribution function @xmath140 the function @xmath141\\times[0,1]\\rightarrow[0,1]$ ] is called bivariate copula .",
    "consider now the marginal cumulative distribution functions @xmath142 and @xmath143 of two random variables @xmath144 and @xmath145 .",
    "it is easy to check that @xmath146 defines a bivariate distribution with marginals @xmath102 and @xmath147 .",
    "a celebrated theorem by @xcite establishes that any bivariate distribution can be written as in ( [ copula ] ) .",
    "furthermore , if the marginals are continuous then the copula representation is unique @xcite .",
    "copulas contain all the information related to the dependence between the random variables and do not involve marginal distributions .",
    "hence , by means of copulas we can separate the study of bivariate distributions into two parts : the marginal behavior and the dependency structure between the random variables .",
    "the simplest bivariate copula is the independent copula .",
    "it is defined as @xmath148 ^ 2,\\ ] ] and it represents the joint distribution of two independent uniform random variables on @xmath108 $ ] .",
    "here we write @xmath149 for the joint conditional density function of the couple @xmath150 given the joint past history of an isi and its subsequent until the couple @xmath151 .",
    "the convergence properties of the estimator ( [ hazardc ] ) depend on the following hypotheses .    1 .",
    "the joint densities @xmath152 and @xmath153 belong to the space @xmath154 of real - valued continuous functions on @xmath155 approaching zero at infinity .",
    "2 .   the marginal densities @xmath11 and @xmath156 belong to the space @xmath157 of real - valued continuous functions on @xmath158 approaching zero at infinity .",
    "the conditional density functions @xmath153 and @xmath156 are lipschitz with ratio 1 , @xmath159 4 .",
    "let @xmath80\\subseteq{\\mathbb{r}}_+$ ] be a compact interval .",
    "we assume that for all @xmath4 in an @xmath160-neighborhood @xmath80_\\epsilon$ ] of @xmath80 $ ] there exists @xmath161 such that @xmath162 .",
    "the kernels @xmath69 , @xmath163 , are hlder with ratio @xmath164 and order @xmath165 $ ] , @xmath166    these assumptions are satisfied by any ergodic process with sufficiently smooth probability density functions ( see @xcite ) .    to prove theorem [ hazarda ] we first recall that the estimator is a uniform strong consistent estimator for @xmath11 on any compact interval @xmath66\\subseteq{\\mathbb{r}}_+$ ] @xcite ( see also @xcite ) , and then we need the following auxiliary lemma .    [ survival ] under the hypotheses and notations of theorem [ hazarda ] , @xmath167 are uniform strong consistent estimator on @xmath80 $ ] of the survival functions @xmath168 and @xmath169 , i.e. @xmath170}\\left|s(t)-\\hat{s}_n(t)\\right|=0,\\qquad \\text{a.s.}\\\\                  & \\label{arar } \\lim_{n\\rightarrow\\infty}\\sup_{t\\in[0,m]}\\left|s(t|\\tau)-\\hat{s}_n(t|\\tau)\\right|=0,\\qquad \\text{a.s . }              \\end{aligned}\\ ] ]",
    "we report only the proof for @xmath171 , as the proof for @xmath172 is analogous ( see @xcite and @xcite for the necessary results on @xmath173 ) .",
    "@xmath174}\\left|s(t)-\\hat{s}_n(t)\\right|                  & =    \\sup_{t\\in[0,m]}\\left|\\int_0^t\\hat{f}_n(s)\\,ds-\\int_0^t f(s)\\,ds\\right|                        \\nonumber\\\\                  & \\leq \\sup_{t\\in[0,m]}\\int_0^t\\left|\\hat{f}_n(s)-f(s)\\right|ds \\nonumber\\\\                  & \\leq \\sup_{t\\in[0,m]}\\int_0^t\\sup_{s'\\in[0,m]}\\left|\\hat{f}_n(s')-f(s')\\right|ds                        \\nonumber\\\\                  & =    \\sup_{s'\\in[0,m]}\\left|\\hat{f}_n(s')-f(s')\\right|\\sup_{t\\in[0,m]}\\int_0^t ds \\nonumber\\\\                  & =   t\\sup_{s'\\in[0,m]}\\left|\\hat{f}_n(s')-f(s')\\right| .",
    "\\end{aligned}\\ ] ] finally , by applying the convergence properties of the estimator ( [ kernel ] ) ( or of the estimator if we are concerned with @xmath172 ) , we obtain the thesis .",
    "observe that @xmath175 , @xmath176 , @xmath171 and @xmath177 are bounded and strictly positive functions on @xmath80 $ ] , as they are survival functions or sums of survival functions associated to strictly positive kernel functions .",
    "now we have all the tools to prove theorem [ hazarda ] .",
    "we report only the proof for the estimator @xmath178 , as the proof for @xmath179 is analogous ( see again @xcite and @xcite for the necessary results for the proof of the estimator of the conditional hazard rate function ) . under the hypotheses",
    "h1h5 , we get @xmath174}\\left|\\hat{h}_n(t)-h(t)\\right|                  = { } & \\sup_{t\\in[0,m]}\\left|\\frac{\\hat{f}_n(t)s(t)-f(t)\\hat{s}_n(t ) }                  { \\hat{s}_n(t)s(t)}\\right| \\nonumber\\\\                  = { } & \\sup_{t\\in[0,m ] }                  \\left|\\frac{\\hat{f}_n(t)s(t)-f(t)s(t)+f(t)s(t)-f(t)\\hat{s}_n(t ) }                  { \\hat{s}_n(t)s(t)}\\right| \\nonumber\\\\                  \\leq { } & \\sup_{t\\in[0,m ] }                  \\frac{\\left|\\hat{f}_n(t)-f(t)\\right| }                         { \\left|\\hat{s}_n(t)s(t)\\right|}\\left| s(t ) \\right|                  + \\sup_{t\\in[0,m ] }                     \\frac{\\left| s(t)-\\hat{s}_n(t)\\right| }                        { \\left|\\hat{s}_n(t)s(t)\\right|}\\left| f(t)\\right| \\\\                  \\le { } & \\frac{\\sup_{t\\in[0,m]}\\left|\\hat{f}_n(t)-f(t)\\right|}{\\inf_{t\\in[0,m]}\\left|\\hat{s}_n(t)s(t)\\right| }                  \\sup_{t\\in[0,m]}\\left| s(t ) \\right| \\\\                  & + \\frac{\\sup_{t\\in[0,m]}\\left|s(t)-\\hat{s}_n(t)\\right|}{\\inf_{t\\in[0,m]}\\left|\\hat{s}_n(t)s(t)\\right| }                  \\sup_{t\\in[0,m]}\\left| f(t ) \\right|              \\end{aligned}\\ ] ] applying the convergence properties of the estimator ( [ kernel ] ) and lemma [ survival ] we get the thesis , as @xmath175 and @xmath171 are bounded and strictly positive functions and @xmath180 .",
    "summarizing , an _ a posteriori _ validation test for the proposed firing rate estimator ( [ est ] ) follows this algorithm .      1 .   estimate the firing rate through ( [ est ] ) .",
    "2 .   compute the transformed isis @xmath181 3 .",
    "test the hypothesis that @xmath182 are i.i.d .",
    "exponential random variables of mean 1 : 1 .",
    "apply the transformation @xmath183 , and test that these transformed random variables are uniform on @xmath108 $ ] .",
    "2 .   perform a goodness - of - fit test for the independent copula on the couples @xmath184 , @xmath185 .",
    "note that testing that @xmath109 , @xmath111 , are i.i.d .",
    "uniform random variables on @xmath108 $ ] is equivalent to test that @xmath182 , @xmath111 , are i.i.d .",
    "exponential random variables with mean 1 , i.e.  that the transformed process is a unit - rate poisson process .    in algorithm [ alg ]",
    "we perform a goodness - of - fit test for copulas to verify the independence between @xmath109 and @xmath110 .",
    "however any other test of independence can be applied , like a classical chi - squared test .",
    "engel , t.a .",
    ", schimansky - geier , l. , herz , a.v . , schreiber , s. & erchova , i. ( 2008 ) subthreshold membrane - potential resonances shape spike - train patterns in the entorhinal cortex .",
    "_ journal of neurophysiology _ , _ 100 _ , 15761589 .",
    "iolov , a. , ditlevsen , s. & longtin , a. ( 2013 ) fokker - planck and fortet equation - based parameter estimation for a leaky integrate - and - fire model with sinusoidal and stochastic forcing . to appear in _ journal of mathematical neuroscience_.      johnson , d.h . ,",
    "tsuchitani c. , linebarger d. & johnson m.j .",
    "( 1986 ) application of a point process model to responses of cat lateral superior olive units to ipsilateral tones . _ hearing research _ , _ 21 _",
    ", 135159 .",
    "kalbfleisch , j.d . & prentice , r.l .",
    "( 2011 ) _ the statistical analysis of failure time data _ john wiley & sons , new york .",
    "lawrance a.j .",
    "( 1972 ) some models for stationary series of univariate events . in : _",
    "stochastic point processes : statistical analysis , theory and applications .",
    "_ lewis p.a.w .",
    "editor , 99 - 256 , wiley & sons , new york .",
    "rauch , a. , la camera , g. , lscher , h .-",
    "r . , senn , w. & fusi s. ( 2003 ) neocortical pyramidal cells respond as integrate - and - fire neurons to in vivo - like input currents .",
    "_ journal of neurophysiology _ , _ 90 _ , 15981612 ."
  ],
  "abstract_text": [
    "<S> if interspike intervals are dependent the instantaneous firing rate does not catch important features of spike trains . in this case </S>",
    "<S> the conditional instantaneous rate plays the role of the instantaneous firing rate for the case of samples of independent interspike intervals . </S>",
    "<S> if the conditional distribution of the interspikes intervals is unknown , it becomes difficult to evaluate the conditional firing rate . </S>",
    "<S> we propose a non parametric estimator for the conditional instantaneous firing rate for markov , stationary and ergodic isis . </S>",
    "<S> an algorithm to check the reliability of the proposed estimator is introduced and its consistency properties are proved . </S>",
    "<S> the method is applied to data obtained from a stochastic two compartment model and to in vitro experimental data .    _ </S>",
    "<S> keywords : _ firing rate ; non parametric estimator ; markov isis . </S>"
  ]
}