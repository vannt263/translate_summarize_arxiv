{
  "article_text": [
    "it is common to say that encryption and watermarking ( or information hiding ) are related but they are substantially different in the sense that in the former , the goal is to protect the secrecy of the _ contents _ of information , whereas in the latter , it is the very _ existence _ of this information that is to be kept secret .    in the last few years , however , we are witnessing increasing efforts around the _ combination _ of encryption and watermarking , which is motivated by the desire to further enhance the security of sensitive information that is being hidden in the host signal .",
    "this is to guarantee that even if the watermark is somehow detected by a hostile party , its contents still remain secure due to the encryption .",
    "this combination of watermarking and encryption can be seen both in recently reported research work ( see , e.g. , @xcite,@xcite,@xcite,@xcite,@xcite,@xcite and references therein ) and in actual technologies used in commercial products with a copyright protection framework , such as the cd and the dvd .",
    "also , some commercial companies that provide internet documents , have in their websites links to copyright warning messages , saying that their data are protected by digitally encrypted watermarks ( see , e.g. , http://genealogy.lv/1864lancaster/copyright.htm ) .    this paper is devoted to the information  theoretic aspects of joint watermarking and encryption together with lossless compression of the composite signal that contains the encrypted watermark .",
    "specifically , we extend the framework studied in @xcite and @xcite of joint watermarking and compression , so as to include encryption using a secret key .",
    "before we describe the setting of this paper concretely , we pause then to give some more detailed background on the work reported in @xcite and @xcite .    in @xcite ,",
    "the following problem was studied : given a covertext source vector @xmath0 , generated by a discrete memoryless source ( dms ) , and a message @xmath1 , uniformly distributed in @xmath2 , independently of @xmath3 , with @xmath4 designating the embedding rate , we wish to generate a composite ( stegotext ) vector @xmath5 that satisfies the following requirements : ( i ) similarity to the covertext ( for reasons of maintaining quality ) , in the sense that a distortion constraint , @xmath6 , holds , ( ii ) compressibility ( for reasons of saving storage space and bandwidth ) , in the sense that the normalized entropy , @xmath7 , does not exceed some threshold @xmath8 , and ( iii ) reliability in decoding the message @xmath1 from @xmath9 , in the sense that the decoding error probability is arbitrarily small for large @xmath10 . a single  letter characterization of the best achievable tradeoffs among @xmath8 , @xmath4 , and @xmath11 was given in @xcite , and was shown to be achievable by an extension of the ordinary lossy source coding theorem , giving rise to the existence of @xmath12 _ disjoint _ rate  distortion codebooks ( one per each possible watermark message ) as long as @xmath4 does not exceed a certain fundamental limit . in @xcite ,",
    "this setup was extended to include a given memoryless attack channel , @xmath13 , where item ( iii ) above was redefined such that the decoding was based on @xmath14 rather than on @xmath9 , and where , in view of requirement ( ii ) , it is understood that the attacker has access to the compressed version of @xmath9 , and so , the attacker decompresses @xmath9 before the attack and re  compresses it after .",
    "this extension from [ 8 ] to [ 9 ] involved an different approach , which was in the spirit of the gelfand ",
    "pinsker coding theorem for a channel with non  causal side information ( si ) at the transmitter @xcite .",
    "the role of si , in this case , was played by the covertext .    in this paper",
    ", we extend the settings of @xcite and @xcite to include encryption . for the sake of clarity of the exposition",
    ", we do that in several steps .    in the first step ,",
    "we extend the attack  free setting of @xcite : in addition to including encryption , we also extend the model of the watermark message source to be an arbitrary dms , @xmath15 , independent of the covertext , and not necessarily a binary symmetric source ( bss ) as in @xcite and @xcite .",
    "specifically , we now assume that the encoder has three inputs ( see fig .",
    "[ gen ] ) : the covertext source vector , @xmath3 , an independent ( watermark ) message source vector @xmath16 , where @xmath17 may differ from @xmath10 if the two sources operate in different rates , and a secret key ( shared also with the legitimate decoder ) @xmath18 , which , for mathematical convenience , is assumed to operate at the same rate as the covertext .",
    "it is assumed , at this stage , that @xmath19 is independent of @xmath20 and @xmath3 .",
    "now , in addition to requirements ( i)-(iii ) , we impose a requirement on the equivocation of the message source relative to an eavesdropper that has access to @xmath9 , but not to @xmath19 . specifically , we would like the normalized conditional entropy , @xmath21 , to exceed a prescribed threshold , @xmath22 ( e.g. , @xmath23 for perfect secrecy ) .",
    "our first result is a coding theorem that gives a set of necessary and sufficient conditions , in terms of single ",
    "letter inequalities , such that a triple @xmath24 is achievable , while maintaining reliable reconstruction of @xmath20 at the legitimate receiver .    in the second step",
    ", we relax the requirement of perfect ( or almost perfect ) watermark reconstruction , and assume that we are willing to tolerate a certain distortion between the watermark message @xmath20 and its reconstructed version @xmath25 , that is , @xmath26 . for example",
    ", if @xmath27 is the hamming distortion measure then @xmath28 , of course , designates the maximum allowable bit error probability ( as opposed to the block error probability requirement of @xcite and @xcite ) .",
    "also , in this case , it makes sense to impose a requirement regarding the equivocation of the _ reconstructed _ message , @xmath25 , namely , @xmath29 , for some prescribed constant @xmath30 .",
    "the rationale is that it is @xmath25 , not @xmath20 , that is actually conveyed to the legitimate receiver , and hence there is an incentive to protect the secrecy of @xmath25 .",
    "we will take into account both equivocation requirements , with the understanding that if one of them is superfluous , then the corresponding threshold ( @xmath22 or @xmath30 accordingly ) can always be set to zero .",
    "our second result then extends the above  mentioned coding theorem to a single ",
    "letter characterization of achievable quintuples @xmath31 .",
    "as will be seen , this coding theorem gives rise to a threefold separation theorem , that separates , without asymptotic loss of optimality , between three stages : rate  distortion coding of @xmath20 , encryption of the compressed bitstream , and finally , embedding the resulting encrypted version using the embedding scheme of @xcite .",
    "the necessary and sufficient conditions related to the encryption are completely decoupled from those of the embedding and the stegotext compression .    in the third and last step ,",
    "we drop the assumption of an attack  free system and we assume a given memoryless attack channel , in analogy to @xcite .",
    "again , referring to fig .",
    "[ gen ] , it should be understood that the stegotext @xmath9 is stored ( or transmitted ) in compressed form , and that the attacker decompresses @xmath9 before the attack and decompresses after ( the compression and decompression units are omitted from the figure ) . as it will turn out , in the case of a memoryless attack",
    ", there is an interaction between the encryption and the embedding , even if the key is still assumed independent of the covertext . in particular",
    ", it will be interesting to see that the key , in addition to its original role in encryption , serves as si that is available to both encoder and decoder ( see fig .",
    "[ dir ] ) .",
    "also , because of the dependence between the key and the composite signal , and the fact that the key is available to the legitimate decoder as well , it is reasonable to let the compressibility constraint correspond also to the conditional entropy of @xmath9 given @xmath19 , that is , _ private _ compression as opposed to the previously considered _ public _ compression , without the key , which enables decompression but not decryption ( when these two operations are carried out by different , remote units ) .",
    "accordingly , we will consider both the conditional and the unconditional entropies of @xmath9 , i.e. , @xmath32 and @xmath33 .",
    "our final result then is a coding theorem that provides a single ",
    "letter characterization of the region of achievable six ",
    "tuples @xmath34 .",
    "interestingly , this characterization remains essentially unaltered even if there is dependence between the key and the covertext , which is a reasonable thing to have once the key and the stegotext interact in the first place .",
    "is a degree of freedom that can be optimized subject to the given randomness resources .",
    "] in this context , the system designer confronts an interesting dilemma regarding the desirable degree of statistical dependence between the key and the covertext , which affects the dependence between the key and the stegotext . on the one hand",
    ", strong dependence can reduce the entropy of @xmath9 given @xmath19 ( and thereby reduce @xmath35 ) , and can also help in the embedding process : for example , the extreme case of @xmath36 ( which corresponds to _ private _ watermarking since the decoder actually has access to the covertext ) is particularly interesting because in this case , for the encryption key , there is no need for any external resources of randomness , in addition to the randomness of the covertext that is already available . on the other hand , when there is strong dependence between @xmath19 and @xmath9 , the secrecy of the watermark might be sacrificed since @xmath37 decreases as well .",
    "an interesting point , in this context , is that the slepian ",
    "wolf encoder @xcite ( see fig .  [ dir ] ) is used to generate , from @xmath19 , random bits that are essentially independent of @xmath9 ( as @xmath9 is generated only after the encryption ) .",
    "these aspects will be seen in detail in section 4 , and even more so , in section 6 .",
    "the remaining parts of this paper are organized as follows : in section 2 , we set some notation conventions .",
    "section 3 will be devoted to a formal problem description and to the presentation of the main result for the attack ",
    "free case with distortion  free watermark reconstruction ( first step described above ) . in section 4",
    ", the setup and the results will be extended along the lines of the second and the third steps , detailed above , i.e. , a given distortion level in the watermark reconstruction and the incorporation of an attack channel .",
    "finally , sections 5 and 6 will be devoted to the proof of the last ( and most general ) version of the coding theorem , with section 5 focusing on the converse part , and section 6  on the direct part .",
    "we begin by establishing some notation conventions . throughout this paper , scalar random variables ( rv s )",
    "will be denoted by capital letters , their sample values will be denoted by the respective lower case letters , and their alphabets will be denoted by the respective calligraphic letters .",
    "a similar convention will apply to random vectors and their sample values , which will be denoted with same symbols superscripted by the dimension .",
    "thus , for example , @xmath38 ( @xmath39  positive integer ) will denote a random @xmath39-vector @xmath40 , and @xmath41 is a specific vector value in @xmath42 , the @xmath39-th cartesian power of @xmath43 .",
    "the notations @xmath44 and @xmath45 , where @xmath46 and @xmath47 are integers and @xmath48 , will designate segments @xmath49 and @xmath50 , respectively , where for @xmath51 , the subscript will be omitted ( as above ) . for @xmath52 , @xmath44 ( or @xmath45 ) will be understood as the null string .",
    "sequences without specifying indices are denoted by @xmath53 .",
    "sources and channels will be denoted generically by the letter @xmath54 , or @xmath55 , subscripted by the name of the rv and its conditioning , if applicable , e.g. , @xmath56 is the probability function of @xmath57 at the point @xmath58 , @xmath59 is the conditional probability of @xmath60 given @xmath61 , and so on . whenever clear from the context , these subscripts will be omitted .",
    "information theoretic quantities like entropies and mutual informations will be denoted following the usual conventions of the information theory literature , e.g. , @xmath62 , @xmath63 , and so on .",
    "for single ",
    "letter information quantities ( i.e. , when @xmath64 or @xmath65 ) , subscripts will be omitted , e.g. , @xmath66 will be denoted by @xmath67 , similarly , @xmath68 will be denoted by @xmath69 , and so on .",
    "we now turn to the formal description of the model and the problem setting for step 1 , as described in the introduction .",
    "a source @xmath70 , henceforth referred to as the _ covertext source _ or the _ host source _",
    ", generates a sequence of independent copies , @xmath71 , of a finite  alphabet rv , @xmath72 . at the same time and",
    "independently , another source @xmath73 , henceforth referred to as the _ message source _ , or the _ watermark source _ , generates a sequence of independent copies , @xmath74 , of a finite  alphabet rv , @xmath75 .",
    "the relative rate between the message source and the covertext source is @xmath76 message symbols per covertext symbol .",
    "this means that while the covertext source generates a block of @xmath10 symbols , say , @xmath0 , the message source generates a block of @xmath77 symbols , @xmath16 ( assuming , without essential loss of generality , that @xmath78 is a positive integer ) .",
    "in addition to the covertext source and the message source , yet another source , @xmath79 , henceforth referred to as the _ key source _ , generates a sequence of independent copies , @xmath80 , of a finite  alphabet rv , @xmath81 , independently and @xmath82 is temporary and made now primarily for the sake of simplicity of the exposition .",
    "it will be dropped later on .",
    "] of both @xmath82 and @xmath83 .",
    "the key source is assumed to operate at the same rate as the covertext source , that is , while the covertext source generates the block @xmath3 of length @xmath10 , the key source generates a block of @xmath10 symbols as well , @xmath18 .",
    "given @xmath10 and @xmath76 , a block code for _ joint watermarking , encryption , and compression _ is a mapping @xmath84 , @xmath77 , whose output @xmath85 is referred to as the _ stegotext _ or the _ composite signal _ , and accordingly , the finite alphabet @xmath86 is referred to as the _ stegotext alphabet_. let @xmath87 denote a single  letter distortion measure between covertext symbols and stegotext symbols , and let the distortion between the vectors , @xmath88 and @xmath89 , be defined additively across the corresponding components , as usual .",
    "an @xmath90 code is a block code for joint watermarking , encryption , and compression , with parameters @xmath10 and @xmath76 , that satisfies the following requirements :    * the expected distortion between the covertext and the stegotext satisfies @xmath91 * the entropy of the stegotext satisfies @xmath92 * the equivocation of the message source satisfies @xmath93 * there exists a decoder @xmath94 such that @xmath95    for a given @xmath76 , a triple @xmath24 is said to be _ achievable _ if for every @xmath96 , there is a sufficiently large @xmath10 for which @xmath97 codes exist .",
    "the _ achievable region _ of triples @xmath24 is the set of all achievable triples @xmath24 . for simplicity",
    ", it is assumed ) is dropped . ]",
    "that @xmath98 as this upper limit on @xmath99 suffices to achieve perfect secrecy .    our first coding theorem is the following :    a triple @xmath24 is achievable if and only if the following conditions are both satisfied :    * @xmath100 . *",
    "there exists a channel @xmath101 such that : ( i ) @xmath102 , ( ii ) @xmath103 , and ( iii ) @xmath104 .",
    "as can be seen , the encryption , on the one hand , and the embedding and the compression , on the other hand , do not interact at all in this theorem .",
    "there is a complete decoupling between them : while condition ( a ) refers solely to the key and the secrecy of the watermark , condition ( b ) is only about the embedding ",
    "compression part , and it is a replica of the conditions of the coding theorem in @xcite , where the role of the embedding rate , @xmath4 ( see introduction above ) , is played by the product @xmath105 .",
    "this suggests a very simple separation principle , telling that in order to attain a given achievable triple @xmath24 , first compress the watermark @xmath20 to its entropy , then encrypt @xmath106 bits ( out of the @xmath107 ) of the compressed bit  string ( by bit  by  bit xoring with the same number of compressed key bits ) , and finally , embed this partially encrypted compressed bit  string into the covertext , using the coding theorem of @xcite ( again , see the introduction above for a brief description of this ) .",
    "moving on to step 2 , we now relax requirement no .  4 in the above definition of an @xmath90 code , and allow a certain distortion between @xmath20 and its reconstruction @xmath25 at the legitimate decoder .",
    "more precisely , let @xmath108 denote a finite alphabet , henceforth referred to as the _ message reconstruction alphabet_. let @xmath109 denote a single  letter distortion measure between message symbols and message reconstruction symbols , and let the distortion between vectors @xmath110 and @xmath111 be again , defined additively across the corresponding components .",
    "finally , let @xmath112 denote the rate  distortion function of the source @xmath73 w.r.t .",
    "@xmath27 , i.e. , @xmath113 it will now be assumed that @xmath114 , for the same reasoning as before .",
    "requirement no .",
    "4 is now replaced by the following requirement : there exists a decoder @xmath115 such that @xmath116 satisfies : @xmath117 in addition to this modification of requirement no .  4 , we add , to requirement no .  3 , a specification regarding the minimum allowed equivocation w.r.t .",
    "the reconstructed message : @xmath118 in order to guarantee that the secrecy of the reconstructed message is also secure enough .",
    "accordingly , we modify the above definition of a block code as follows : an @xmath119 code is a block code for joint watermarking , encryption , and compression with parameters @xmath10 and @xmath76 that satisfies requirements 14 , with the above modifications of requirements 3 and 4 . for a given @xmath76 ,",
    "a quintuple @xmath31 is said to be _ achievable _ if for every @xmath96 , there is a sufficiently large @xmath10 for which @xmath120 codes exist .",
    "our second theorem extends theorem 1 to this setting :    a quintuple @xmath31 is achievable if and only if the following conditions are all satisfied :    * @xmath121 .",
    "* @xmath122 .",
    "* there exists a channel @xmath101 such that : ( i ) @xmath123 , ( ii ) @xmath124 , and ( iii ) @xmath104 .",
    "as can be seen , the passage from theorem 1 to theorem 2 includes the following modifications : in condition ( c ) , @xmath67 is simply replaced by @xmath112 as expected .",
    "this means that the lossless compression code of @xmath20 , in the achievability of theorem 1 , is now replaced by a rate  distortion code for distortion level @xmath28 .",
    "conditions ( a ) and ( b ) now tell us that the key rate ( in terms of entropy ) should be sufficiently large to satisfy both equivocation requirements . note that the condition regarding the equivocation w.r.t .  the clean message source is softer than in theorem 1 as @xmath125 .",
    "this is because the rate  distortion code for @xmath20 already introduces an uncertainty of @xmath126 bits per symbol , and so , the encryption should only complete it to the desired level of @xmath22 bits per symbol .",
    "this point is discussed in depth in @xcite .",
    "of course , by setting @xmath127 ( and hence also @xmath128 ) , we are back to theorem 1 .",
    "we also observe that the encryption and the embedding are still decoupled in theorem 2 , and that an achievable quintuple can still be attained by separation : first , apply a rate  distortion code to @xmath20 , as mentioned earlier , then encrypt @xmath129 bits of the compressed codeword ( to satisfy both equivocation requirements ) , and finally , embed the ( partially ) encrypted codeword into @xmath3 , again , by using the scheme of @xcite . note that without the encryption and without requirement no .",
    "2 of the compressibility of @xmath9 , this separation principle is a special case of the one in @xcite , where a separation theorem was established for the wyner ",
    "ziv source ( with si correlated to the source at the decoder ) and the gelfand  pinsker channel ( with channel si at the encoder ) . here ,",
    "there is no si correlated to the source and the role of channel si is fulfilled by the covertext .",
    "thus , the new observation here is that the separation theorem continues to hold in the presence of encryption and requirement no .  2 .",
    "finally , we turn to step 3 , of including an attack channel ( see fig .",
    "[ gen ] ) .",
    "let @xmath130 be a finite alphabet , henceforth referred to as the _ forgery alphabet _ , and let @xmath131 denote a set of conditional pmf s from the stegotext alphabet to the forgery alphabet .",
    "we now assume that the stegotext vector is subjected to an attack modelled by the memoryless channel , @xmath132 the output @xmath14 of the attack channel will henceforth be referred to as the _ forgery_.    it is now assumed and that the legitimate decoder has access to @xmath14 , rather than @xmath9 ( in addition , of course , to @xmath19 ) .",
    "thus , in requirement no .  4 , the decoder is redefined again , this time , as a mapping @xmath133 such that @xmath134 satisfies the distortion constraint ( [ distp ] ) . as for the equivocation requirements",
    ", the conditioning will now be on both @xmath9 and @xmath14 , i.e. , @xmath135 as if the attacker and the eavesdropper are the same party ( or if they cooperate ) , then s / he may access both .",
    "in fact , for the equivocation of @xmath20 , the conditioning on @xmath14 is immaterial since @xmath136 is always a markov chain , but it is not clear that @xmath14 is superfluous for the equivocation w.r.t .",
    "@xmath137 since @xmath14 is one of the inputs to the decoder whose output is @xmath137 .",
    "nonetheless , for the sake of uniformity and convenience ( in the proof ) , we keep the conditioning on @xmath14 in both equivocation criteria .    redefining block codes and achievable quintuples @xmath138 according to the modified requirements in the same spirit , we now have the following coding theorem , which is substantially different from theorems 1 and 2 :    a quintuple @xmath31 is achievable if and only if there exist rv s @xmath139 and @xmath140 such that @xmath141 , where the alphabet size of @xmath139 is bounded by @xmath142 .",
    "* @xmath143 .",
    "* @xmath144 .",
    "* @xmath145 .",
    "* @xmath146 .",
    "first , observe that here , unlike in theorems 1 and 2 , it is no longer true that the encryption and the embedding ( along with stegotext compression ) are decoupled , yet the rate  distortion compression of @xmath20 is still separate and decoupled from both . in other words",
    ", the separation principle applies here in partial manner only .",
    "note that now , although @xmath147 is still assumed independent of @xmath148 , it may , in general , depend on @xmath140 . on the negative side ,",
    "this dependence causes a reduction in the equivocation of both the message source and its reconstruction , and therefore @xmath149 replaces @xmath99 in conditions ( a ) and ( b ) . on the positive side , on the other hand , this dependence introduces new degrees of freedom in enhancing the tradeoffs between the embedding performance ( condition ( c ) ) and the compressibility ( condition ( d ) ) .",
    "the achievability of theorem 3 involves essentially the same stages as before ( rate  distortion coding of @xmath20 , followed by encryption , followed in turn by embedding ) , but this time , the embedding scheme is a conditional version of the one proposed in @xcite , where all codebooks depend on @xmath19 , the si given at both ends ( see fig .",
    "[ dir ] ) . an interesting point regarding the encryption",
    "is that one needs to generate , from @xmath19 , essentially @xmath150 random bits that are _ independent _ of @xmath9 ( and @xmath14 ) , in order to protect the secrecy against an eavesdropper that observes @xmath9 and @xmath14 . clearly ,",
    "if @xmath9 was given in advance to the encrypting unit , then the compressed bitstring of an optimal lossless source code that compresses @xmath19 , given @xmath9 as si , would have this property ( as if there was any dependence , then this bitstring could have been further compressed , which is a contradiction ) .",
    "however , such a source code can not be implemented since @xmath9 itself is generated from the encrypted message , i.e. , _",
    "after _ the encryption .",
    "in other words , this would have required a circular mechanism , which may not be feasible .",
    "a simple remedy is then to use a _ slepian  wolf encoder _",
    "@xcite , that generates @xmath150 bits that are essentially independent of @xmath9 ( due to the same consideration ) , without the need to access the vector @xmath9 to be generated . for more details ,",
    "the reader is referred to the proof of the direct part ( section 6 ) .",
    "observe that in the absence of attack ( i.e. , @xmath151 ) , theorem 2 is obtained as a special case of theorem 3 by choosing @xmath152 and letting both be independent of @xmath147 , a choice which is simultaneously the best for conditions ( a)(d ) of theorem 3 . to see this ,",
    "note the following simple inequalities : in conditions ( a ) and ( b ) , @xmath153 .",
    "in condition ( c ) , by setting @xmath151 , we have @xmath154 finally in condition ( d ) , clearly , @xmath155 and since @xmath148 is independent of @xmath147 , then @xmath156 .",
    "thus , for @xmath151 , the achievable region of theorem 3 is a subset of the one given in theorem 2 .",
    "however , since all these inequalities become equalities at the same time by choosing @xmath152 and letting both be independent of @xmath147 , the two regions are identical in the attack ",
    "free case .",
    "returning now to theorem 3 , as we observed , @xmath19 is now involved not only in the role of a cipher key , but also as si available at both encoder and decoder .",
    "two important points are now in order , in view of this fact .",
    "first , one may argue that , actually , there is no real reason to assume that @xmath19 is necessarily independent of @xmath3 ( see also @xcite ) .",
    "if the user has control of the mechanism of generating the key , then s / he might implement , in general , a channel @xmath157 using the available randomness resources , and taking ( partial ) advantage of the randomness of the covertext .",
    "let us assume that this channel is stationary and memoryless , i.e. , @xmath158 with the single  letter transition probabilities @xmath159 left as a degree of freedom for design . while so far , we assumed that @xmath147 was independent of @xmath148 , the other extreme is , of course , @xmath160 ( corresponding to private watermarking ) .",
    "note , however , that in the attack  free case , in the absence of the compressibility requirement no .  2 ( say , @xmath161 ) , no optimality is lost by assuming that @xmath147 is independent of @xmath148 , since the only inequality where we have used the independence assumption , in the previous paragraph , corresponds to condition ( d ) .",
    "the second point is that in theorems 13 , so far , we have defined the compressibility of the stegotext in terms of @xmath162 , which is suitable when the decompression of @xmath9 is _ public _ ,",
    "i.e. , without access to @xmath19 .",
    "the legitimate decoder in our model , on the other hand , has access to the si @xmath19 , which may depend on @xmath9 . in this context",
    ", it then makes sense to measure the compressibility of the stegotext also in a _ private _ regime , i.e. , in terms of the _ conditional _ entropy , @xmath163 .",
    "our last ( and most general ) version of the coding theorem below takes these two points in to account .",
    "specifically , let us impose , in requirement no .  2 , an additional inequality , @xmath164 where @xmath35 is a prescribed constant , and let us redefine accordingly the block codes and the achievable region in terms of six ",
    "tuples @xmath34 .",
    "we now have the following result :    a six ",
    "tuple @xmath34 is achievable if and only if there exist rv s @xmath139 and @xmath140 such that @xmath165 , where the alphabet size of @xmath139 is bounded by @xmath142 .",
    "* @xmath143 .",
    "* @xmath144 .",
    "* @xmath145 .",
    "* @xmath166 .",
    "* @xmath146 .",
    "note that the additional condition , ( e ) , is similar to condition ( d ) except for the term @xmath167 .",
    "also , in the joint pmf of @xmath168 we are no longer assuming that @xmath147 and @xmath148 are independent .",
    "it should be pointed out that in the presence of the new requirement regarding @xmath163 , it is more clear now that introducing dependence of @xmath169 upon @xmath147 is reasonable , in general . in the case",
    "@xmath160 , that was mentioned earlier , the term @xmath170 , in condition ( c ) , and the term @xmath171 , in conditions ( d ) and ( e ) , both vanish .",
    "thus , both embedding performance and compression performance improve , like in private watermarking .",
    "finally , a comment is in order regarding the assumption @xmath114 , which implies that @xmath149 can not exceed @xmath172 either .",
    "if this assumption is removed , and even @xmath149 is allowed to exceed @xmath172 , then theorem 4 can be somewhat further extended . while @xmath22 can not be further improved if @xmath149 is allowed to exceed @xmath172 ( as it already reaches the maximum possible value , @xmath23 , for @xmath173 ) , it turns out that there is still room for improvement in @xmath30 .",
    "suppose that instead of one rate ",
    "distortion codebook for @xmath20 , we have many _ disjoint _ codebooks .",
    "in fact , it has been shown in @xcite that there are exponentially @xmath174 disjoint codebooks , each covering the set of typical source sequences by jointly typical codewords .",
    "now , if @xmath175 , we can use the @xmath176 excess bits of the compressed key ( beyond the @xmath177 bits that are used to encrypt the binary of representation of @xmath137 ) , so as to select one of @xmath178 codebooks ( as long as @xmath179 ) , and thus reach a total equivocation of @xmath150 as long as @xmath180 , or equivalently , @xmath181 .",
    "the equivocation level @xmath182 is now the `` saturation value '' that can not be further improved ( in analogy to @xmath23 for the original source ) .",
    "this means that condition ( b ) of theorem 4 would now be replaced by the condition @xmath183 but with this condition , it is no longer clear that the best test channel for lossy compression of @xmath20 is the one that achieves @xmath112 , because for the above modified version of condition ( b ) , it would be best to have @xmath184 as large as possible ( as long as it is below @xmath185 ) , which is in partial conflict with the minimization of @xmath186 that leads to @xmath112 .",
    "therefore , a restatement of theorem 4 would require the existence of a channel @xmath187 ( in addition to the existing requirement of a channel @xmath188 ) , such that the random variable @xmath189 takes now part in the compromise among _ all _ criteria of the problem .",
    "this means that in conditions ( a),(c),(d ) , and ( e ) of theorem 4 , @xmath112 should be replaced by @xmath186 , and there would be an additional condition ( g ) : @xmath190 .",
    "condition ( a ) , in view of the earlier discussion above , would now be of the form : @xmath191_+,\\ ] ] where @xmath192_+{\\stackrel{\\delta } { = } } \\max\\{0,z\\}$ ] .",
    "of course , under the assumption @xmath114 , that we have used thus far , @xmath193 in other words , @xmath194 is always attained by @xmath185 , and so , the dependence on @xmath184 disappears , which means that the best choice of @xmath189 ( for all other conditions ) is back to be the one that minimizes @xmath186 , which gives us theorem 4 as is .",
    "it is interesting to point out that this additional extension gives rise to yet another step in the direction of invalidating the separation principle : while in theorem 4 only the encryption and the embedding interacted , yet the rate  distortion coding of @xmath20 was still independent of all other ingredients of the system , here even this is no longer true , as the choice of the test channel @xmath195 takes into account also compromises that are associated with the encryption and the embedding .",
    "note that this discussion applies also to the _ classical _ joint source  channel coding , where there is no embedding at all : in this case , @xmath148 is a degenerate rv ( say , @xmath196 , if @xmath197 ) , and so , the mutual information terms depending on @xmath148 in conditions ( c ) , ( d ) and ( e ) , all vanish , the best choice of @xmath139 is @xmath152 ( thus , the r.h.s in condition ( c ) becomes the capacity of the channel @xmath198 with @xmath147 as si at both ends ) , and condition ( f ) may be interpreted as a ( generalized ) power constraint ( with power function @xmath199 ) .",
    "nonetheless , the new versions of conditions ( a ) and ( b ) remain the same as in eqs .",
    "( [ 13 ] ) and ( [ 14 ] ) .",
    "this is to say that the violation of the separation principle occurs even in the classical model of a communication system , once security becomes an issue and one is interested in the security of the reconstructed source .",
    "let an @xmath200 code be given .",
    "first , from the requirement @xmath201 , we have : @xmath202 where the second inequality comes from the data processing theorem ( @xmath136 is a markov chain given @xmath19 ) and the last equality comes from the chain rule and the fact that @xmath20 and @xmath19 are independent .",
    "define @xmath203 , @xmath204  as a uniform rv over @xmath205 , @xmath206 , @xmath207 , @xmath208 , @xmath209 , and @xmath210 .",
    "now , the first term on the right  most side of eq .",
    "( [ 2nd ] ) is further lower bounded in the following manner . @xmath211\\nonumber\\\\ & = & n[i(x;k , y , v',j)-i(x;k)]\\label{xp4}\\\\ & = & ni(x;y , v|k)\\label{4th}\\end{aligned}\\ ] ] where ( [ xp1 ] ) is due to the chain rule and fact that @xmath212 is independent of @xmath20 ( hence @xmath213 is trivially a markov chain ) , ( [ xp2 ] ) is due to the memorylessness of @xmath214 , ( [ xp3 ] ) is due to the data processing theorem , and ( [ xp4 ] ) follows from the fact that @xmath82 is stationary and so , @xmath206 is independent of @xmath204 .",
    "the second term on the right  most side of eq .  ( [ 2nd ] ) is in turn lower bounded following essentially the same ideas as in the proof of the converse to the rate ",
    "distortion coding theorem ( see , e.g. , @xcite ) : @xmath215\\nonumber\\\\ & = & \\sum_{i=1}^n i(u_i;u^{i-1},z^n , k^n)\\nonumber\\\\ & \\ge&\\sum_{i=1}^n i(u_i;[g_n(z^n , k^n)]_i)\\nonumber\\\\ & \\ge&\\sum_{i=1}^n r_u(ed'(u_i,[g_n(z^n , k^n)]_i))\\nonumber\\\\ & \\ge&nr_u\\left(\\frac{1}{n}\\sum_{i=1}^n ed'(u_i,[g_n(z^n , k^n)]_i)\\right)\\nonumber\\\\ & \\ge&nr_u(d'+\\epsilon),\\label{5th}\\end{aligned}\\ ] ] where @xmath216_i$ ] denotes the @xmath46-th component projection of @xmath217 , i.e. , @xmath218 as a function of @xmath219 . combining eqs .",
    "( [ 2nd ] ) , ( [ 4th ] ) , and ( [ 5th ] ) , we get @xmath220 dividing by @xmath10 , we get @xmath221 using the arbitrariness of @xmath222 together with the continuity of @xmath223 , we get condition ( e ) of theorem 4 .    condition ( d ) is derived in the very same manner except that the starting point is the inequality @xmath224 , and when @xmath162 is further bounded from below , in analogy to the chain of inequalities ( [ 2nd ] ) , there is an additional term , @xmath225 , that is in turn lower bounded in the following manner : @xmath226\\nonumber\\\\ & \\ge&n[h(k)-h(k|y)]\\nonumber\\\\ & = & ni(k;y),\\end{aligned}\\ ] ] where the first inequality is because of the memorylessness of @xmath227 , and the second inequality comes from the facts that conditioning reduces entropy ( in the second term ) and that @xmath147 is independent of @xmath204 ( again , due to the stationarity of @xmath227 ) .",
    "this gives the additional term , @xmath167 , in condition ( d ) .",
    "condition ( c ) is obtained as follows : @xmath228\\\\ & = & n[i(v';k ,",
    "z|j)-i(v';k , x|j)]\\nonumber\\\\ & \\le&n[i(v',j;k , z)-i(v',j;k , x)]\\\\ & = & n[i(v;k , z)-i(v;k , x)]\\nonumber\\\\ & = & n[i(v;z|k)-i(v;x|k)],\\end{aligned}\\ ] ] where the first inequality is ( [ 5th ] ) , the first equality is due to the independence between @xmath20 and @xmath229 , the second inequality is an application of ( * ? ? ?",
    "* lemma 4 ) , the third inequality is due to the fact that @xmath230 and @xmath231 ( due to the stationarity of @xmath232 ) , and the last equality is obtained by adding and subtracting @xmath233 .",
    "again , since this is true for every @xmath96 , it holds also for @xmath234 , due to continuity .    as for condition ( f )",
    ", we have : @xmath235 and we use once again the arbitrariness of @xmath222 . regarding condition ( b ) , we have : @xmath236 where the last equality is due to the fact that @xmath25 is , by definition , a function of @xmath219 , and the last inequality is by the hypothesis that the code achieves an equivocation of at least @xmath237 . dividing by @xmath17 and taking the limit @xmath238 , leads to @xmath143 , which is condition ( b ) . finally , to prove condition ( a ) , consider the inequality @xmath239 , that we have just proved , and proceed as follows ( see also @xcite ) : @xmath240+\\nonumber\\\\ & & [ i(u^n;y^n , z^n)-i(\\hat{u}^n;y^n , z^n)+h(\\hat{u}^n|u^n)],\\end{aligned}\\ ] ] where the second inequality follows from the hypothesis that the code satisfies @xmath241 , and the third inequality is due to the memorylessness of @xmath83 , the hypothesis that @xmath242 , and the converse to the rate  distortion coding theorem .",
    "now , to see that the second bracketed term is non  negative , we have the following chain of inequalities : @xmath243 combining this with eq .",
    "( [ 8th ] ) , we have @xmath244.\\ ] ] dividing again by @xmath17 , and letting @xmath222 vanish , we obtain @xmath245 , which completes the proof of condition ( a ) .",
    "to complete the proof of the converse part , it remains to show that the alphabet size of @xmath139 can be reduced to @xmath246 .",
    "to this end , we extend the proof of the parallel argument in @xcite by using the support lemma ( cf .",
    "@xcite ) , which is based on carathodory s theorem . according to this lemma , given @xmath204 real valued continuous functionals @xmath247 , @xmath248 on the set @xmath249 of probability distributions over the alphabets @xmath250 , and given any probability measure @xmath251 on the borel @xmath252-algebra of @xmath249 , there exist @xmath204 elements @xmath253 of @xmath249 and @xmath204 non - negative reals , @xmath254 , such that @xmath255 and for every @xmath248 @xmath256 before we actually apply the support lemma , we first rewrite the relevant mutual informations of theorem 4 in a more convenient form for the use of this lemma . first , observe that @xmath257 and @xmath258 for a given joint distribution of @xmath259 , and given @xmath198 , @xmath260 and @xmath261 are both given and unaffected by @xmath139 .",
    "therefore , in order to preserve prescribed values of @xmath262 and @xmath263 , it is sufficient to preserve the associated values @xmath264 and @xmath265",
    ". let us define then the following functionals of a generic distribution @xmath55 over @xmath266 , where @xmath267 is assumed , without loss of generality , to be @xmath268 , @xmath269 : @xmath270 next define @xmath271 applying now the support lemma , we find that there exists a random variable @xmath139 ( jointly distributed with @xmath259 ) , whose alphabet size is @xmath272 and it satisfies simultaneously : @xmath273 @xmath274 and @xmath275 it should be pointed out that this random variable maintains the prescribed distortion level @xmath276 since @xmath277 is preserved . by the same token , @xmath149 and @xmath167 , which depend only on @xmath278 ,",
    "are preserved as well .",
    "this completes the proof of the converse part of theorem 4 .",
    "in this section , we show that if there exist rv s @xmath169 that satisfy the conditions of theorem 4 , then for every @xmath96 , there is a sufficiently large @xmath10 for which @xmath200 codes exist .",
    "one part of the proof is strongly based on a straightforward extension of the proof of the direct part of @xcite to the case of additional si present at both encoder and decoder .",
    "nonetheless , for the sake of completeness , the full details are provided here .",
    "it should be pointed out that for the attack ",
    "free case , an analogous extension can easily be offered to the direct part of @xcite .",
    "we first digress to establish some additional notation conventions associated with the method of types @xcite . for",
    "a given generic finite ",
    "alphabet random variable ( rv ) @xmath279 ( or a vector of rv s taking on values in @xmath43 ) , and a vector @xmath280 ( @xmath39  positive integer ) , the empirical probability mass function ( epmf ) is a vector @xmath281 , where @xmath282 is the relative frequency of the letter @xmath283 in the vector @xmath284 .",
    "given @xmath285 , let us denote the set of all @xmath286-typical sequences of length @xmath39 by @xmath287 , or by @xmath288 ( if there is no ambiguity regarding the pmf that governs @xmath289 ) , i.e. , @xmath288 is the set of the sequences @xmath290 such that @xmath291 for every @xmath283 . for sufficiently large @xmath39 ,",
    "the size of @xmath288 is well  known @xcite to be bounded by @xmath292 } \\leq      |t_a^\\delta| \\leq 2^{\\ell(1+\\delta)h(a)}.\\ ] ] it is also well  known ( by the weak law of large numbers ) that : @xmath293 for all @xmath39 sufficiently large . for a given generic channel @xmath294 and for each @xmath295 , the set of all sequences @xmath296 that are jointly @xmath286-typical with @xmath284 , will be denoted by @xmath297 , or by @xmath298 if there is no ambiguity , i.e. , @xmath298 is the set of all @xmath299 such that : @xmath300 for all @xmath301 , where @xmath302 denotes the fraction of occurrences of the pair @xmath303 in @xmath304 .",
    "similarly as in eq .",
    "( [ px ] ) , for all sufficiently large @xmath39 and @xmath305 , the size of @xmath298 is bounded as follows : @xmath306 } \\leq      |t_{b|a}^\\delta(a^\\ell)| \\leq 2^{\\ell(1+\\delta)h(b|a)}.\\ ] ] finally , observe that for all @xmath305 and @xmath307 , the distortion @xmath308 is upper bounded by : @xmath309    let @xmath168 be a given random vector that satisfies the conditions of theorem 4 .",
    "we now describe the mechanisms of random code selection and the encoding and decoding operations . for a given @xmath96 , fix @xmath286 such that @xmath310 .",
    "define also @xmath311,\\ ] ] @xmath312,\\ ] ] and @xmath313.\\ ] ] +   + _ generation of a rate  distortion code _ :",
    "+ apply the type  covering lemma @xcite and construct a rate  distortion codebook that covers @xmath314 within distortion @xmath315 w.r.t .",
    "@xmath27 , using @xmath316 codewords .",
    "+   + _ generation of the encrypting bitstream _ : + for every @xmath317 , randomly select an index in the set @xmath318}-1\\}$ ] with a uniform distribution . denote by @xmath319 , @xmath320 , @xmath321 , the binary string of length",
    "@xmath322 $ ] that represents this index .",
    "( note that @xmath323 can be interpreted as the output of the slepian ",
    "wolf encoder for @xmath19 , where @xmath9 plays the role of si at the decoder @xcite . ) +   + _ generation of an auxiliary embedding code _",
    ": + we first construct an auxiliary code capable of embedding @xmath316 watermarks by a random selection technique .",
    "first , @xmath324 , @xmath325 , sequences @xmath326 , @xmath327 , are drawn independently from @xmath328 for every @xmath329 .",
    "for every such @xmath330 , let us denote the set of these sequences by @xmath331 .",
    "the elements of @xmath331 are evenly distributed among @xmath332 bins , each of size @xmath333 , @xmath334 ( this is possible thanks to condition ( c ) of theorem 4 , provided that the inequality therein is strict ) . a different ( encrypted ) message of length @xmath335 bits is attached to each bin , identifying a sub - code that represents this message .",
    "we denote the codewords in bin number @xmath1 ( @xmath336 ) , by @xmath337 , @xmath338 .",
    "+   + _ stegotext sequence generation _ : + for each auxiliary sequence ( in the above auxiliary codebook of each @xmath286typical @xmath330 ) , @xmath339 , a set of @xmath340 , @xmath341 , stegotext sequences @xmath342 , @xmath343 , are independently drawn from @xmath344 .",
    "we denote this set by @xmath345 .",
    "+   + _ encoding _ : + upon receiving a triple @xmath346 , the encoder acts as follows :    1 .   if @xmath347 , let @xmath348 , @xmath349 , @xmath350 be the binary representation of the index of the rate ",
    "distortion codeword for the message source . for @xmath317 ,",
    "let @xmath319 denote binary representation string of the index of @xmath330 .",
    "let @xmath351 , where @xmath352 , @xmath321 , and @xmath353 , @xmath354 , and where @xmath355 denotes modulo 2 addition i.e. , the xor operation",
    ". is assumed smaller than @xmath172 , then so is @xmath149 , and therefore @xmath356 . ]",
    "the binary vector @xmath357 is the ( partially ) encrypted message to be embedded .",
    "let @xmath358 denote the index of this message .",
    "if @xmath359 or @xmath360 , an arbitrary ( error ) message @xmath357 is generated ( say , the all  zero message ) .",
    "2 .   if @xmath361 find , in bin number @xmath1 , the first @xmath47 such that @xmath339 is jointly typical , i.e. , @xmath362 , and then find the first @xmath363 such that @xmath364 is jointly typical , i.e. , @xmath365 .",
    "this vector @xmath366 is chosen for transmission .",
    "if @xmath367 , or if there is no @xmath339 and @xmath368 such that @xmath365 , an arbitrary vector @xmath89 is transmitted .",
    "_ decoding _ : + upon receiving @xmath369 and @xmath370 , the decoder finds all sequences @xmath371 in @xmath331 such that @xmath372 .",
    "if all @xmath371 found belong to the same bin , say , @xmath373 , then @xmath373 is decoded as the embedded message , and then the binary representation vector @xmath374 corresponding to @xmath373 is decrypted , again , by modulo 2 addition of its first @xmath204 bits with @xmath323 .",
    "this decrypted binary @xmath375vector is then mapped to the corresponding reproduction vector @xmath376 of the rate ",
    "distortion codebook for the message source .",
    "if there is no @xmath377 such that @xmath378 or if there exist two or more bins that contain such a sequence , an error is declared .",
    "+   + we now turn to the performance analysis of this code in all relevant aspects . for each triple @xmath379 and particular choices of the codes ,",
    "the possible causes for incorrect watermark decoding are the following :    1 .",
    "let the probability of this event be defined as @xmath381 .",
    "2 .   @xmath382 , but in bin no .",
    "@xmath1 there is no @xmath383 s.t .",
    "@xmath362 . let the probability of this event be defined as @xmath384 .",
    "3 .   @xmath382 and in bin no .",
    "@xmath1 there is @xmath383 s.t .",
    "@xmath362 , but there is no @xmath385 s.t .",
    "@xmath365 . let the probability of this event be defined as @xmath386 .",
    "@xmath382 and in bin no .",
    "@xmath1 there is @xmath383 and @xmath387 such that @xmath365 , but @xmath388 . let the probability of this event be defined as @xmath389 .",
    "@xmath382 and in bin no .",
    "@xmath1 there is @xmath383 and @xmath387 such that @xmath365 , and @xmath378 , but there exists another bin , say , no .",
    "@xmath390 , that contains @xmath391 s.t .",
    "@xmath392 . let the probability of this event be defined as @xmath393 .",
    "if none of these events occur , the message @xmath357 ( or , equivalently , @xmath1 ) is decoded correctly from @xmath394 , the distortion constraint between @xmath395 and @xmath366 is within @xmath396 ( as follows from ( [ d_theoretic ] ) ) , and the distortion between @xmath397 and its rate  distortion codeword , @xmath398 , does not exceed @xmath315 .",
    "thus , requirements 1 and 4 ( modified according to eq .",
    "( [ distp ] ) , with @xmath399 replacing @xmath28 ) are both satisfied .",
    "therefore , we first prove that the probability for none of the events 15 to occur , tends to unity as @xmath400 .",
    "the average probability of error @xmath401 in decoding @xmath1 is bounded by @xmath402 the fact that @xmath403 follows immediately from ( [ prtgx ] ) . as for @xmath384",
    ", we have : @xmath404 now , by ( [ tgxsize ] ) , for every @xmath47 and every @xmath405 : @xmath406 } } { 2^{n(1+\\delta)h(v|k ) } } \\nonumber\\\\      & = & 1 - 2^{-n[i(x;v|k)+\\epsilon_1]}.\\end{aligned}\\ ] ] substitution of ( [ p_e2i ] ) into ( [ p_e2a ] ) provides us with the following upper bound : @xmath407}\\big]^{m_2 } \\leq \\exp\\bigg\\{-2^{nr_2}\\cdot2^{-n[i(x;v|k)+\\epsilon_1]}\\bigg\\ } \\rightarrow 0,\\ ] ] double  exponentially rapidly since @xmath408 .",
    "to estimate @xmath386 , we repeat the same technique : @xmath409 again , by the property of the typical sequences , for every @xmath363 and @xmath410 : @xmath411},\\end{aligned}\\ ] ] and therefore , substitution of ( [ p_e3cu ] ) into ( [ p_e3a ] ) gives @xmath412}\\big]^{m_3 } \\leq \\exp\\bigg\\{-2^{nr_3}\\cdot2^{-n[i(x;y|v , k)+ \\epsilon_2]}\\bigg\\ } \\rightarrow 0,\\ ] ] double  exponentially rapidly since @xmath341 .",
    "the estimation of @xmath389 is again based on properties of typical sequences . since @xmath14 is the output of a memoryless channel @xmath198 with input @xmath413 and by the assumption of this step @xmath365 , from ( [ prtgx ] ) and the markov lemma ( * ? ? ?",
    "* lemma 14.8.1 ) , we obtain @xmath414 and similarly to @xmath381 , @xmath415 can be made as small as desired by an appropriate choice of @xmath286 .",
    "finally , we estimate @xmath393 as follows : @xmath416}.\\end{aligned}\\ ] ] now , since @xmath417 , @xmath418 .",
    "since @xmath419 for @xmath420 , their sum tends to zero as well , implying that there exist at least one choice of an auxiliary code and related stegotext codes that give rise to the reliable decoding of @xmath421 .",
    "now , let us denote by @xmath422 the total number of composite sequences in a codebook that corresponds to a @xmath286typical @xmath330 .",
    "then , @xmath423}\\nonumber\\\\ & = & 2^{n[\\lambda r_u(d')+i(x;y , v|k)+\\epsilon_1+\\epsilon_2 + 2\\delta]}.\\end{aligned}\\ ] ] thus , @xmath424\\nonumber\\\\ & \\le & n(r_c'+\\epsilon_1+\\epsilon_2 + 2\\delta),\\end{aligned}\\ ] ] where in the last inequality we have used condition ( e ) . for sufficiently small values of @xmath286 ( and hence of @xmath425 and @xmath426 ) @xmath427 and so , the compressibility requirement in the presence of @xmath19 is satisfied .",
    "we next prove the achievability of @xmath8 .",
    "let us consider the set of @xmath286typical key sequences @xmath428 , and view it as the union of @xmath429typical sets ( i.e. , @xmath286typical sets with @xmath430 ) , @xmath431 , where @xmath432 exhausts the set of all rational pmf s with denominator @xmath10 , and with the property @xmath433 suppose that we have already randomly selected a codebook for one _ representative _ member @xmath434 of each type class @xmath435 using the mechanism described above .",
    "now , consider the set of all permutations from @xmath434 to every other member of @xmath436 .",
    "the auxiliary codebook and the stegotext codebooks for every other key sequence , @xmath437 will be obtained by permuting all ( auxiliary and stegotext ) codewords of those corresponding to @xmath434 according to the same permutation that leads from @xmath434 to @xmath330 ( thus preserving all the necessary joint typicality properties ) .",
    "now , in the _ union _ of all stegotext codebooks , corresponding to all typical key sequences , each codeword will appear at least @xmath438}$ ] times , which is a lower bound to the number of permutations of @xmath434 which leave a given stegotext codeword @xmath366 unaltered .",
    "the total number of stegotext codewords , @xmath439 , in all codebooks of all @xmath286typical key sequences ( including repetitions ) is upper bounded by @xmath440}\\cdot   2^{n[\\lambda r_u(d')+i(x;y , v|k)+\\epsilon_1+\\epsilon_2 + 2\\delta]}\\nonumber\\\\ & = & 2^{n[h(k)+ \\lambda r_u(d')+i(x;y , v|k)+\\epsilon_1+\\epsilon_2+\\delta(h(k)+3)]}.\\end{aligned}\\ ] ] let @xmath441 denote the union of all stegotext codebooks , namely , the set of all _ distinct _ stegotext vectors across all codebooks corresponding to all @xmath317 , and let @xmath442 denote the number of occurrences of a given vector @xmath89 in all stegotext codebooks .",
    "then , in view of the above combinatorial consideration , we have @xmath443}.\\ ] ] combining eqs .",
    "( [ nyu ] ) and ( [ nyl ] ) , we have @xmath444,\\ ] ] where latexmath:[\\[\\delta'=\\epsilon_1+\\epsilon_2+\\delta(h(k)+h(k|y)+4)+    arbitrarily small provided that @xmath286 is sufficiently small and @xmath10 is sufficiently large .",
    "thus , the rate required for public compression of @xmath9 ( without the key ) , which is @xmath446 , is arbitrarily close to @xmath447 $ ] , which in turn is upper bounded by @xmath8 , by condition ( d ) of theorem 4 .    before we proceed to evaluate the equivocation levels ,",
    "an important comment is in order in the context of public compression ( and a similar comment will apply to private compression ) : note that a straightforward ( and not necessary optimal ) method for public compression of @xmath9 is simply according to its index within @xmath448 , which requires about @xmath449 bits . on the other hand",
    ", the converse theorem tells us that the compressed representation of @xmath9 can not be much shorter than @xmath450 $ ] bits ( cf .",
    "the necessity of condition ( d ) of theorem 4 ) .",
    "thus , contradiction between these two facts is avoided only if @xmath451 or , equivalently , @xmath452 this means that any achievable point @xmath34 corresponds to a choice of random variables @xmath453 that must inherently satisfy eq .",
    "( [ inherent2 ] ) .",
    "this observation will now help us also in estimating the equivocation levels .",
    "consider first the equivocation w.r.t .",
    "the reproduction , for which we have the following chain of inequalities : @xmath454-\\nonumber\\\\ & & -n[\\lambda r_u(d'+\\epsilon)+i(x;y , v|k)-\\epsilon]-ni(k;y)\\label{bb}\\\\ & = & h(k^n|y^n , z^n)+n\\lambda[r_u(d')-r_u(d'+\\epsilon)]+n\\epsilon\\nonumber\\\\ & { \\stackrel{\\delta } { = } } & h(k^n|y^n , z^n)+n\\epsilon'\\nonumber\\\\ & = & i(k^n;{\\hat{u}}^n|y^n , z^n)+h(k^n|y^n , z^n,{\\hat{u}}^n)+n\\epsilon'\\nonumber\\\\ & \\le&h({\\hat{u}}^n|y^n , z^n)+h(k^n|y^n , z^n,{\\hat{u}}^n)+n\\epsilon'\\label{last}\\end{aligned}\\ ] ] where ( [ cc ] ) is based on condition ( b ) , ( [ dd ] ) is due to the memorylessness of @xmath19 , ( [ aa ] ) follows from the fact that @xmath455 is a markov chain , ( [ bb ] ) is due to the sufficiency of condition ( d ) ( that we have just proved ) and the necessity of condition ( e ) , and @xmath456 vanishes as @xmath238 due to the continuity of @xmath223 . comparing the left  most side and the right  most side of the above chain of inequalities , we see that to prove that @xmath457 is essentially at least as large as @xmath458 , it remains to show that @xmath459 is small , say , @xmath460 for large @xmath10 . we next focus then on the proof of eq .",
    "( [ small ] ) .",
    "first , consider the following chain of inequalities : @xmath461 where the second inequality follows from the fact that @xmath462 is function of @xmath25 and the fact that conditioning reduces entropy .",
    "as for the second term of the right  most side , we have by fano s inequality @xmath463 as @xmath464 is the probability of error associated with the slepian  wolf decoder that estimates @xmath19 from its compressed version , @xmath465 , and the `` side information , '' @xmath9 . as for the first term of the right",
    " most side of ( [ equivbound ] ) , we have @xmath466 it remains to show that @xmath467 as well . in order to show this",
    ", we have to demonstrate that for a good code , once @xmath9 is given , there is very little uncertainty with regard to @xmath421 , which is the index of the bin .    to this end , let us suppose that the inequality in ( [ inherent2 ] ) is strict ( otherwise , we can slightly increase the allowable distortion level @xmath28 and thus reduce @xmath112 ) . as we prove in the appendix , for any given ( arbitrarily small ) @xmath468 , @xmath469 that is , a double  exponential decay .",
    "the probability of the union of these events across all representatives @xmath470 of all @xmath471 will just be multiplied by the number of @xmath431 in @xmath428 , which is polynomial , and hence will continue to decay double  exponentially .",
    "let us define then the event @xmath472 as yet another error event ( like the error events 15 ) that occurs with very small probability .",
    "assume then , that the randomly selected codebook is `` good '' in the sense that no stegovector appears in more than @xmath473 bins , for any of the representatives @xmath470 .",
    "now , given @xmath366 , how many candidate bins ( corresponding to encrypted messages @xmath474 ) can be expected at most ? for a given @xmath366 ,",
    "let us confine attention to the @xmath286conditional type class @xmath475 ( key sequences outside this set can not have @xmath366 in their codebooks , as they are not jointly @xmath286typical with @xmath366 ) .",
    "the conditional @xmath286type class @xmath475 can be partitioned into conditional @xmath429type classes @xmath476 , where @xmath477 exhausts the allowed @xmath286tolerance in the conditional distribution around @xmath478 , in the same spirit as before .",
    "now , take an arbitrary representative @xmath479 from a given @xmath480 , and consider the set of all permutations that lead from @xmath479 to all other members @xmath481 of @xmath480 .",
    "obviously , the stego  codebooks of all those @xmath481 have exactly the same configuration of occurrences of @xmath366 as that of @xmath479 ( since these permutations leave @xmath366 unaltered ) , therefore they belong to exactly the same bins as in the codebook of @xmath479 , the number of which is at most @xmath482 , by the hypothesis that we are using a good code . in other words , as @xmath330 scans @xmath480 , there will be no new bins that contain @xmath366 relative to those that are already in the codebook of @xmath479 .",
    "new bins that contain @xmath366 can be seen then only by scanning the other conditional @xmath429types @xmath476 within @xmath475 , but the number such conditional @xmath429types does not exceed the total number of conditional @xmath429types , which is upper bounded , in turn , by @xmath483 @xcite .",
    "thus , the totality of stego  codebooks , for all relevant @xmath481 can not give more than @xmath484 distinct bins altogether . in other words , for a good codebook : @xmath485= n\\left[\\gamma+|{{\\cal k}}|\\cdot|{{\\cal y}}|\\cdot\\frac{\\log(n+1)}{n}\\right]\\ ] ] which is less than @xmath486 for an appropriate choice of @xmath487 and for large enough @xmath10 .",
    "finally , for the equivocation w.r.t .   the original message source , we have the following : @xmath488-\\nonumber\\\\ & & [ i(u^n;y^n , z^n)+ h(\\hat{u}^n|u^n)-i(\\hat{u}^n;y^n , z^n)],\\end{aligned}\\ ] ] where first inequality is due to the fact that @xmath489 $ ] , that we have just shown , and the third is due to the memorylessness of @xmath83 and the fact that the rate  distortion codebook size is @xmath316 and so , @xmath490 .",
    "now , the second bracketed expression on the right  most side is the same as in eq .",
    "( [ bra ] ) , where in the case of this specific scheme , both inequalities in ( [ bra ] ) become equalities , i.e. , this expression vanishes .",
    "this is because in our scheme , @xmath491 is a markov chain ( and so , the first inequality of ( [ bra ] ) is tight ) and because @xmath492 ( as @xmath25 is a deterministic function of @xmath20 ) , which makes the second inequality of ( [ bra ] ) tight . as a result , we have @xmath493\\nonumber\\\\ & \\ge&n[h+r_u(d')-h(u)+h(u)-r_u(d')-2\\epsilon/\\lambda]\\nonumber\\\\ & = & n(h-2\\epsilon'/\\lambda),\\end{aligned}\\ ] ] where we have used condition ( a ) .",
    "this completes the proof of the direct part .",
    "the author would like to thank dr .",
    "yossi steinberg for interesting discussions .",
    "useful comments made by the anonymous referees are acknowledged with thanks .",
    "_ proof of eq .",
    "( [ doubleexp])_. the probability of obtaining @xmath366 in a single random selection within the codebook of @xmath434 is given by @xmath494 } } \\cdot\\frac{1}{2^{n[(1-\\delta)h(y|k , v)-\\delta]}}\\nonumber\\\\ & = & 2^{-n[h(y|k)-\\delta'']},\\end{aligned}\\ ] ] where the first factor in the right  hand side of ( [ tt ] ) is the probability of having a @xmath495 that is typical with @xmath366 and @xmath434 ( a necessary condition for this @xmath383 to generate the given @xmath366 ) , the second factor is the probability of selecting a given @xmath366 in the random selection of the steogtext code , and where @xmath496.\\ ] ] it now follows that the probability @xmath497 for at least one occurrence of @xmath366 among the stegowords corresponding to a certain bin , in the codebook of @xmath434 , is upper bounded ( using the union bound ) by @xmath498}\\nonumber\\\\ & = & 2^{-n[h(y|k)-i(x;v|k)-i(x;y|v , k)- \\delta''-2\\delta-\\epsilon_1-\\epsilon_2]}\\nonumber\\\\ & = & 2^{-n[h(y|k)-i(x;v , y|k)- \\delta''-2\\delta-\\epsilon_1-\\epsilon_2]}\\nonumber\\\\ & { \\stackrel{\\delta } { = } } & 2^{-n[h(y|k)-i(x;y , v|k)-\\delta_1]}.\\end{aligned}\\ ] ] we are interested to upper bound the probability that a given @xmath366 appears as a stegoword in more than @xmath473 bins in the codebook of @xmath434 , for a given @xmath468 . for @xmath499 ,",
    "let @xmath500 be the indicator function of the event @xmath501 then , clearly @xmath502 are i.i.d .  with @xmath503 .",
    "therefore , @xmath504}\\|q\\right)\\right\\},\\end{aligned}\\ ] ] where for @xmath505 $ ] , the function @xmath506 designates the binary divergence @xmath507 now , referring to eq .",
    "( [ inherent2 ] ) , suppose that @xmath508 then , clearly , @xmath509 } > 2^{-n[h(y|k)-i(x;y , v|k)-\\delta_1 ] } \\ge q\\ ] ] and so , @xmath510 is further upper bounded by @xmath511}\\|2^{-n[h(y|k)-i(x;y , v|k)-\\delta_1]}\\right)\\right\\}.\\ ] ] to further bound this expression from above , we have to get a lower bound to an expression of the form @xmath512 for @xmath513 . applying the inequality @xmath514 , for @xmath515",
    ", we have : @xmath5162^{-na}.\\end{aligned}\\ ] ] applying this inequality with @xmath517 and @xmath518 , we get @xmath519}\\|2^{-n[h(y|k)-i(x;y , v|k)-\\delta_1]}\\right)\\ge ( n\\gamma-\\log e)2^{-n[\\lambda r_u(d')-\\gamma]}\\ ] ] and so , @xmath520 which decays double  exponentially rapidly with @xmath10 . while , this inequality holds for a _ given _",
    "@xmath366 , the probability that @xmath521 for _ some _ @xmath89 would be upper bounded , using the union bound , by @xmath522 , which still decays double  exponentially . thus , with very high probability",
    "the random selection of stegovectors , for @xmath434 , is such that no stego codevector @xmath366 appears in more than @xmath473 bins .",
    "aa a.  adelsbach , s.  katzenbeisser , and a .-",
    "sadeghi , `` cryptography meets watermarking : detecting watermarks with minimal or zero knowledge disclosure , '' preprint 2002 .",
    "available on  line at [ www-krypt.cs.uni-sb.de/download/papers ] s.  c.  cheung and d.  k.  w.  chiu , `` a watermark infrastructure for enterprise document management , '' _ proc .",
    "36th hawaii international conference on system sciences ( hicss03 ) _ , hawaii , 2003 .",
    "t.  m.  cover and j.  a.  thomas , _ elements of information theory _ , wiley , new york , 1991 .",
    "i.  csiszr and j.  krner , _ information theory : coding theorems for discrete memoryless systems _ , academic press , 1981 .",
    "s.  i.  gelfand and m.  s.  pinsker , `` coding for channel with random parameters , '' _ problems of information and control _ , vol .",
    "9 , no .  1",
    "19 - 31 , 1980 .",
    "a.  jayawardena , b.  murison , and p.  lenders , `` embedding multiresolution binary images into multiresolution watermark channels in wavelet domain , '' preprint 2000 .",
    "available on  line at [ www.tsi.enst.fr/@xmath523maitre/tatouage/icassp00/articles ] .",
    "k.  kuroda , m.  nishigaki , m.  soga , a.  takubo , and i.  nakamura , `` a digital watermark using public ",
    "key cryptography for open algorithm , '' _ proc .",
    "icita 2002_. also , available on  line at [ http://charybdis.mit.csu.edu.au/@xmath523mantolov/cd/icita2002/papers/131-21.pdf ] .",
    "a.  maor and n.  merhav ,",
    "`` on joint information embedding and lossy compression , '' submitted to _",
    "ieee trans .  inform .",
    "theory _ , july 2003 .",
    "available on  line at [ www.ee.technion.ac.il/people/merhav ] .",
    "a.  maor and n.  merhav , `` on joint information embedding and lossy compression in the presence of a stationary memoryless attack channel , '' submitted to _",
    "ieee trans .  inform .",
    "theory _ , january 2004 .",
    "available on  line at [ www.ee.technion.ac.il/people/merhav ] .",
    "n.  merhav and s.  shamai ( shitz ) , `` on joint source  channel coding for the wyner ",
    "ziv source and the gelfand  pinsker channel , '' _ ieee trans .",
    "theory _ , vol .",
    "49 , no .  11 , pp .  28442855 ,",
    "november 2003 .",
    "p.  moulin and j.  a.  osullivan , `` information  theoretic analysis of information hiding , '' _ ieee trans .",
    "theory _ , vol .",
    "563593 , march 2003 .",
    "moulin and y.  wang , `` new results on steganographic capacity , '' _ proc .",
    "ciss 2004 _ , pp .  813818 , princeton university , march 2004 .",
    "d.  slepian and j.  k.  wolf , `` noiseless coding of correlated information sources , '' _ ieee trans .",
    "theory _ , vol .",
    "it19 , pp .  471480 , 1973 . m.  steinder , s.  iren , and p.  d.  amer , `` progressively authenticated image transmission , '' preprint 1999 .",
    "available on  line at [ www.cis.udel.edu  /amer",
    "/ pel / poc / pdf / milcom99-steiner.pdf ] .",
    "h.  yamamoto , `` rate  distortion theory for the shannon cipher system , '' _ ieee trans .  inform .",
    "theory _ , vol .",
    "43 , no .  3 , pp .",
    "827835 , may 1997 ."
  ],
  "abstract_text": [
    "<S> in continuation to earlier works where the problem of joint information embedding and lossless compression ( of the composite signal ) was studied in the absence @xcite and in the presence @xcite of attacks , here we consider the additional ingredient of protecting the secrecy of the watermark against an unauthorized party , which has no access to a secret key shared by the legitimate parties . </S>",
    "<S> in other words , we study the problem of joint coding for three objectives : information embedding , compression , and encryption . </S>",
    "<S> our main result is a coding theorem that provides a single  </S>",
    "<S> letter characterization of the best achievable tradeoffs among the following parameters : the distortion between the composite signal and the covertext , the distortion in reconstructing the watermark by the legitimate receiver , the compressibility of the composite signal ( with and without the key ) , and the equivocation of the watermark , as well as its reconstructed version , given the composite signal . in the attack  </S>",
    "<S> free case , if the key is independent of the covertext , this coding theorem gives rise to a _ </S>",
    "<S> threefold _ separation principle that tells that asymptotically , for long block codes , no optimality is lost by first applying a rate  distortion code to the watermark source , then encrypting the compressed codeword , and finally , embedding it into the covertext using the embedding scheme of @xcite . in the more general case , however , this separation principle is no longer valid , as the key plays an additional role of side information used by the embedding unit .    </S>",
    "<S> * index terms : * information hiding , watermarking , encryption , data compression , separation principle , side information , equivocation , rate  distortion .    </S>",
    "<S> department of electrical engineering + technion - israel institute of technology + haifa 32000 , israel + merhav@ee.technion.ac.il </S>"
  ]
}