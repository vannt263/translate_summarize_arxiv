{
  "article_text": [
    "the international trade network ( itn ) is the complex network of trade relationships existing between pairs of countries in the world .",
    "the nodes ( or vertices ) of the itn represent nations and the edges ( or links ) represent their ( weighted ) trade connections . in a global economy extending across national borders , there is increasing interest in understanding the mechanisms involved in trade interactions and how the position of a country within the itn may affect its economic growth and integration @xcite .",
    "moreover , in the wake of recent financial crises the interconnectedness of economies has become a matter of concern as a source of instability  @xcite .",
    "as the modern architecture of industrial production extends over multiple countries via geographically wider supply chains , sudden changes in the exports of a country ( due e.g. to unpredictable financial , environmental , technological or even political circumstances ) can rapidly propagate to other countries via the itn .",
    "the assessment of the associated trade risks requires detailed information about the underlying network structure @xcite . in general , among the possible channels of interaction among countries , trade plays a major role @xcite .",
    "the above considerations imply that the empirical structure of the itn plays a crucial role in increasingly many economic phenomena of global relevance .",
    "it is therefore becoming more and more important to characterize the itn via simple but accurate models that identify both the basic ingredients and the mathematical expressions required to accurately reproduce the details of the empirical network structure .",
    "reliable models of the itn can better inform economic theory , foreign policy , and the assessment of trade risks and instabilities worldwide .    in this paper , we emphasize that current models of the itn have strong limitations , and that none of them is satisfactory , from either a theoretical or a phenomenological point of view .",
    "we point out equally strong ( and largely complementary ) problems affecting on one hand traditional macroeconomic models , which focus on the local _ weight _ of the links of the network , and on the other hand more recent network models , which focus on the _ existence _ of links , i.e. on the global topology of the itn .",
    "we then introduce a new model of the itn that preserves all the good ingredients of the models proposed so far , while at the same time improving upon the limitations of such approaches .",
    "the model can be easily generalized to any ( economic ) network and provides an explicit specification of the full probability distribution that a given pair of countries is connected by a certain volume of trade , fixing an otherwise arbitrary choice in previous approaches .",
    "this distribution is found to be either geometric ( for discrete volumes ) or exponential ( for continuous volumes ) , with an additional point mass at zero volume .",
    "this feature , which is different from all previous specifications of international trade models , is shown to replicate both the local trade volumes and the global topology of the empirical itn remarkably well .",
    "before we fully specify our model , we preliminarily identify its building blocks by reviewing the strengths and weaknesses of the two main modelling frameworks adopted so far .",
    "we start by discussing traditional macroeconomic models of international trade .",
    "these models have mainly focused on the _ volume _",
    "( i.e. the value e.g. in dollars ) of trade between countries , largely because economic theory perceives trade volumes as being _ a priori _ more informative than the topology of the itn : the striking heterogeneity of trade volumes observed between different pairs of countries is clearly not captured by a purely ` binary ' description where all connections are effectively given the same weight .",
    "based on this argument , emphasis has been put on explaining the ( expected ) volume of trade between two countries , given certain dyadic and country - specific macroeconomic properties .",
    "jan tinbergen , the physics - educated dutch economist who was awarded the first nobel memorial prize in economics , introduced the so - called gravity model ( gm ) of trade @xcite .",
    "the gm aims at inferring the volume of trade from the knowledge of gross domestic product , mutual geographic distance , and possibly additional dyadic factors of macroeconomic relevance @xcite . in one of its simplest forms ,",
    "the gravity model predicts that , if @xmath0 and @xmath1 label two different countries ( @xmath2 where @xmath3 is the total number of countries in the world ) , then the expected volume of trade from @xmath0 to @xmath1 is @xmath4 where @xmath5 is the gross domestic product of country @xmath6 , @xmath7 is the geographic distance between countries @xmath0 and @xmath1 , and @xmath8 are free global parameters to be estimated . in the above",
    "_ directed _ specification of the gm , the flows @xmath9 and @xmath10 can be different .",
    "an analogous _ undirected _ specification exists , where the volumes of trade from @xmath0 to @xmath1 and from @xmath1 to @xmath0 are added together into a single value @xmath11 of bilateral trade . in the latter case , [ eq_gravity ] still holds but with the symmetric choice @xmath12 . with this in mind , we will keep our discussion entirely general throughout the paper and , unless otherwise specified , allow all quantities to be interpreted either as directed or as undirected . only in our final empirical analysis",
    "we will adopt an undirected description for simplicity .",
    "more complicated variants of [ eq_gravity ] use additional factors ( with associated free parameters ) either favoring or resisting trade  @xcite . like the gdp and geographic distances",
    ", these factors can be country - specific ( e.g. population ) or dyadic ( e.g. common currency , trade agreements , shared borders , common language , etc . ) .",
    "in general , if we collectively denote with @xmath13 the set of _ node - specific _ factors and with @xmath14 the set of _ dyad - specific _ factors used , [ eq_gravity ] can be generalized to @xmath15 where the functional form of @xmath16 need not be of the same type as in [ eq_gravity ] , and @xmath17 is a vector containing all the free parameters of the model ( like @xmath18 for the particular case above ) . indeed , although in this paper we focus on the gm applied to the international trade network , our discussion equally applies to many other models of ( socio - economic ) networks as well .",
    "for instance , the recently proposed radiation model ( rm )  @xcite is also described by [ eq_gravityf ] , where @xmath13 and @xmath14 include certain geographical and demographical variables .",
    "our following discussion applies to both the gm and the rm , as well as any other model described by [ eq_gravityf ] .",
    "similarly , it does not only apply to trade networks , since both the gm and the rm have been successfully applied to other systems as well , including mobility and traffic flows  @xcite , communication networks  @xcite , and migration patterns  @xcite ( the latter representing - to our knowledge - the earliest application of the gm to a socio - economic system , dating back to 1889  @xcite ) .",
    "it is generally accepted that the expected trade volumes postulated by the gm , already in its simplest form given by [ eq_gravity ] , are in good agreement with the observed flows between trading countries . to illustrate this result , in fig .",
    "[ fig-1 ] we show a typical log - log plot comparing the empirical volume of the realized ( bilateral ) international trade flows with the corresponding expected values calculated under the gm as defined in [ eq_gravity ] .",
    "the figure shows the typical good agreement between the gm and the empirical non - zero trade volumes .",
    "however , it should be noted that , while [ eq_gravity ] and [ eq_gravityf ] define the expected value of @xmath9 , the full probability distribution from which this expected value is calculated is not specified , and actually depends on how the model is implemented in practice . in the gm case ,",
    "the distribution is chosen to be either gaussian ( corresponding to additive noise , in which case the expected weights can be fitted to the observed ones via a simple linear regression ) , log - normal ( corresponding to multiplicative noise and requiring a linear regression of log - transformed weights  ) , poisson , or more sophisticated ( see @xcite for a review ) .",
    "the arbitrariness of the weight distribution already highlights a fundamental weakness of the traditional formulation of the model .",
    "moreover , for both additive and multiplicative gaussian noise , the model can produce undesired negative values .",
    "a related and more important limitation of the gm is that , at least in its simplest and most natural implementations , it can not generate zero volumes  thereby predicting a fully connected network  @xcite .",
    "this means that the gm can be fitted only to the _ non - zero _ weights , i.e. the volumes existing between pairs of _ connected _ countries .",
    "if used in this way , the model effectively disregards the empirical structure of the network , both as input ( thus making predictions on the basis of incomplete data ) and as output ( thus failing to reproduce the topology ) .",
    "operatively , the gm can be used only _",
    "after _ the presence of a trade link has been established independently @xcite .",
    "as observed in  , _ `` omitting zero - flow observations implies that we loose information on the causes of ( very ) low trade '' _ , because any fit to positive - only flows would significanlty underestimate the effects of factors that diminish trade .",
    "this problem is particularly critical since roughly half of the possible links are found to be _ not _ realized in the real itn @xcite .",
    "clearly , the same problem holds for the rm and any more general model of the form specified in [ eq_gravityf ] .",
    "while there are variants and extensions of the gm that do generate zero weights and a realistic link density ( e.g. the so - called poisson pseudo - maximum likelihood models and ` zero - inflated ' gravity models ) , these variants systematically fail in reproducing the observed topology @xcite .",
    "in other words , while these models can generate the correct number of connections , they tend to put many of the latter in the ` wrong place ' in the network .",
    "indeed , even in its generalized forms , the gm predicts a largely homogeneous network structure , while the empirical topology of the itn is much more heterogeneous and complex @xcite .",
    "established empirical signatures of this heterogeneity include a broad distribution of the degree ( number of connections ) and the strength ( total trade volume ) of countries  @xcite , the rich - club phenomenon ( whereby well - connected countries are also connected to each other )  @xcite , strong clustering and ( dis)assortative patterns  @xcite .",
    "these highly skewed structural properties are remarkably stable over time . however , their are not replicated by any current version of the gm  @xcite .",
    "as we mentioned at the beginning , many processes of great economic relevance crucially depend on the large - scale topology of the itn . in light of this result ,",
    "the sharp contrast between the observed topological complexity of the itn and the homogeneity of the network structure generated by the gm ( including its extensions ) calls for major improvements in the modelling approach . in particular , in assessing the performance of a model of the itn , emphasis should be put on how reliably the ( global ) empirical network structure , besides the ( local ) volume of trade , is replicated . in the network science literature ,",
    "successful models of the itn have been derived from the _ maximum entropy _",
    "principle  @xcite .",
    "these models construct ensembles of random networks that have some desired topological property ( taken as input from empirical data ) and are maximally random otherwise .",
    "typically , the constrained properties are chosen to be the degrees and/or the strenghts of all nodes . in this way the models can perfectly replicate the observed strong heterogeneity of these purely local properties , and at the same time illustrate its immediate ( i.e. prior to invoking any other more complicated network formation mechanism ) structural effects on any higher - order topological property of the network .    in general",
    ", different choices of the constrained properties lead to different degrees of agreement between the model and the data .",
    "this can generate intriguing and counter - intuitive insight about the structure of the itn .",
    "for instance , contrary to what naive economic reasoning would predict , it turns out that the knowledge of purely binary local properties ( e.g. node degrees ) can be _ more informative _ than the knowledge of the corresponding weighted properties ( e.g. node strengths ) . indeed , while the binary network reconstructed only from the knowledge of the degrees of all countries is found to be topologically very similar to the real itn , the weighted network reconstructed only from the strengths of all countries is found to be much denser and very different from the real network @xcite .",
    "this is somewhat surprising , given that economic theory postulates that weighted properties are _ per se _ more informative than the corresponding binary ones .",
    "the solution to this apparent paradox lies in the fact that , while the knowledge of the _ entire _ weighted network is necessarily more informative than that of its binary projection ( in accordance with economic postulates ) , the knowledge of certain _ marginal _ properties of the weighted network can be unexpectedly less informative than the knowledge of the corresponding marginal properties of the binary network .",
    "in fact , it turns out that if the degrees of countries are ( not ) specified in addition to the strengths of countries , the resulting maximum - entropy model can(not ) reproduce the empirical weighted network of international trade satisfactorily  @xcite .",
    "an important take - home message is that , in contrast with the mainstream literature , models of the itn should aim at reproducing not only the strength of countries ( as the gm automatically does by approximately reproducing all non - zero weights ) , but also their degree ( i.e. the number of trade partners ) @xcite . in order to devise improved models of the itn",
    ", one should therefore include the degrees , which are purely topological properties , among the main target quantities to replicate .",
    "this is the guideline we will follow in this paper .    unlike the gm ,",
    "maximum - entropy models of trade are _ a priori _ non - explanatory , i.e. they take as input structural properties ( as opposed to explanatory economic factors ) to explain other structural properties .",
    "however , they can in fact be used to select _ a posteriori _ an explicit , empirically validated functional dependence of the structure of the itn on underlying explanatory factors . for models with country - specific constraints ,",
    "this operation can be carried out as follows .",
    "mathematically , controlling for node - specific properties is realized by assigning one or more lagrange multipliers , also known as ` hidden variables ' or ` fitness parameters ' @xmath19 , to each node .",
    "if a certain choice of local constraints is found to replicate the higher - order properties of the real - world network satisfactorily , then one can look for an empirical relationship between the values of the associated hidden variables and those of candidate non - topological , country - specific factors of the type @xmath13 , like the gdp or total import / export .",
    "if the hidden variables are indeed ( at least approximately ) found to be functions of some country - specific factors ( i.e. if @xmath20 ) , then one can replace @xmath19 with @xmath21 in the maximum - entropy model , thus reformulating the latter as a model with explanatory variables ( i.e. ` regressors ' ) of trade , precisely like the gm . already more than a decade ago , the approach outlined above led to the definition of a gdp - driven model for the binary topology of the itn , where @xmath22 .",
    "the model , which is a reformulation of a maximum - entropy model for binary networks with given degrees , predicts that the probability of a trade connection existing from country @xmath0 to country @xmath1 is @xmath23 where @xmath24 is a free parameter that allows to reproduce the empirical link density .",
    "the model has been tested successfully in multiple ways  @xcite .",
    "the gm in [ eq_gravity ] and the maximum - entropy model in [ eq : fermi ] have complementary strengths and weaknesses , the former being a good model for non - zero volumes ( while being a bad model for the topology ) and the latter being a good model for the topology ( while providing no information about trade volumes ) .",
    "an attempt to reconcile these two complementary and currently incompatible approaches has been recently proposed via the definition of an extension of the maximum - entropy model to the case of weighted networks  @xcite . since",
    ", as we mentioned , a maximum - entropy model of weighted networks with given strengths and degrees  @xcite can correctly replicate many structural properties of the itn  @xcite , it makes sense to reformulate such model as an economically inspired model of the itn .",
    "indeed , like in the binary case , the hidden variables enforcing the constraints are found to be strongly correlated with the gdp , thus allowing to express both @xmath25 and @xmath26 as functions of the gdp  @xcite .",
    "the resulting model is confirmed to be in good accordance with both the topology and the volumes observed in the real itn .",
    "unfortunately , in the above approach the choice of country - specific constraints ( degrees and strengths ) only allows for regressors that have a corresponding country - specific nature .",
    "this makes the model incompatible with the inclusion of dyadic variables of the type @xmath14 and represents a strong limitation for ( at least ) two reasons .",
    "firstly , one of the main lessons learnt from the traditional gm is that the addition of geographic distances improves the fit to the empirical volumes significantly . indeed , in the light of the large body of knowledge accumulated in the international economics literature",
    ", it is hard to imagine a realistic and economically meaningful model of international trade that does not allow for simple pair - wise quantities controlling for trade ` costs ' and ` incentives ' , including geography  @xcite .",
    "secondly , even if the structure of the itn can be replicated satisfactorily in terms of the ` gdp - only ' model defined in [ eq : fermi ]  @xcite , recent analyses have found evidence that certain metric ( although not necessarily geographic appearing in the gm and measured as geodesics on our spherical tridimensional world . ] ) distances do also play a role in determining the topology of the itn  @xcite .",
    "together , these two pieces of evidence call for an inclusion of dyadic factors in @xmath26 and @xmath25 , and highlight a limitation of current maximum - entropy models based only on country - specific constraints .    combining all the above considerations ,",
    "it is clear that an improved model of the itn should aim at retaining the realistic trade volumes postulated by models based on [ eq_gravityf ] ( including the gm , the rm , and possibly many more ) , while combining them with a realistic network topology generated by ( extensions of ) maximum - entropy models .",
    "such a model should also aim at providing the full probability distribution , and not only the expected values as in [ eq_gravity ] , of trade flows and , unlike the gdp - only model in [ eq : fermi ]  @xcite or its current weighted extension  @xcite , allow for the inclusion of both dyadic and node - specific macroeconomic factors .",
    "in this section , we introduce what we call the enhanced gravity model ( egm ) of trade . the egm mathematically formalizes the two ingredients that , in the light of the previous discussion , any ` good ' model of economic networks should feature : namely , realistic ( trade ) volumes and a realistic topology , both controllable by macroeconomic factors .",
    "the first lesson we have learnt is that [ eq_gravityf ] is successful in reproducing link weights only _ after _ the existence of the links themselves has been preliminarly established .",
    "this implies that [ eq_gravityf ] , as a model of real - world trade flows , is actually unsatisfactory and should rather be reformulated as a _ conditional expectation _ of the weight @xmath9 , given that @xmath27 . in other words , if @xmath28 denotes the entry of the adjacency matrix of the itn ( defined as @xmath29 if @xmath27 and @xmath30 if @xmath31 )",
    ", an improved model should be such that [ eq_gravityf ] is replaced by @xmath32 where @xmath33 is the _ conditional expected weight _ of the trade link from country @xmath0 to country @xmath1 , _ given that such link exists_. this operation ensures that , whatever the new model looks like , its predictions for the expected trade volume between connected pairs of countries remain identical to the ones proposed in more traditional macroeconomic models . for instance",
    ", choosing @xmath34 as in [ eq_gravity ] allows us to retain ( in almost intact form ) all the empirical knowledge that has accumulated in the econometrics literature since jan tinbergen s introduction of the gm .",
    "an important difference , however , is that in our model the trade volumes will be drawn from a different probability distribution .",
    "the second lesson we have learnt is that , in analogy with [ eq_gravityf1 ] , [ eq : fermi ] should be generalized to allow for both dyadic ( @xmath14 ) and node - specific ( @xmath13 ) factors as follows : @xmath35 where a crucial requirement is that @xmath36 can in general be different from @xmath37 in [ eq_gravityf1 ] and , correspondingly , the vector @xmath38 of parameters can be different from @xmath39 .",
    "note that , since @xmath25 is monotonic in @xmath36 , the above expression is entirely general , i.e. we have put no restriction on the functional form of @xmath25 .",
    "it is also worth noticing that the explanatory factors used in [ eq_gravityf1 ] and [ eq : fermig ] need not coincide . however , to avoid using different symbols for the arguments of the two functions , we adopt the convention that @xmath14 and @xmath13 denote the sets of all factors used as arguments of either @xmath37 or @xmath36 , and that these functions can have flat ( i.e. no ) dependence on some of their arguments .",
    "for instance , [ eq : fermig ] reduces to [ eq : fermi ] by setting @xmath40 and assuming flat dependence on @xmath14 , or it reduces to the hyperbolic model in ref .",
    "@xcite by setting @xmath14 equal to the hyperbolic distance and assuming flat dependence on @xmath13 .",
    "we want our model to produce both [ eq_gravityf1 ] as the desired ( gravity - like ) conditional expectation for link weights and [ eq : fermig ] as a realistic expected topology . to do so",
    ", we introduce the full probability @xmath41 that the model produces a weighted network specified by the @xmath42 matrix @xmath43 with entries @xmath44 . without loss of generality , we assume that @xmath9 is a non - negative integer number ( allowing for non - negative real numbers is straightforward , upon taking the limit of a vanishing unit of weight , as we briefly discuss later ) .",
    "the probability @xmath41 is the key quantity that fully specifies the model and determines both the topology and the link weights of the itn . from @xmath41",
    ", we can define the dyadic ( marginal ) probability @xmath45 that @xmath9 takes the particular value @xmath46 .",
    "note that the event @xmath47 indicates the absence of a trade link and is included as a possible outcome in @xmath45 .",
    "the normalization condition is therefore @xmath48 for all @xmath49 .",
    "note that we are _ not _ assuming independence of the trade volumes @xmath9 and @xmath50 between two distinct country pairs , or equivalently the factorization of @xmath41 into the product @xmath51 of dyadic probabilities .",
    "however , we will later find that the desired model has precisely this independence property .",
    "importantly , unlike the traditional gm , in our approach dyadic independence is a consequence and not a postulate .",
    "we now look for the form of @xmath45 that enforces both [ eq_gravityf1 ] and [ eq : fermig ] .",
    "let us consider the latter first . in terms of @xmath45 , the probability @xmath25 that @xmath0 and @xmath1 are connected ( irrespective of the volume of trade )",
    "is given by the complement of the probability @xmath52 that they are not connected , i.e. @xmath53 imposing that [ eq:1-q ] has the form dictated by [ eq : fermig ] leads to the following unique choice for @xmath52 : @xmath54 we now relate @xmath45 to [ eq_gravityf1 ] in a similar manner .",
    "the expected trade volume , irrespective of whether a link exists , is @xmath55 while the conditional expectation , given that the link exists , is @xmath56 where @xmath57 is the _",
    "conditional _ probability that @xmath9 equals @xmath46 , given that the link is realized . setting [ eq : condw ] equal to [ eq_gravityf1 ] leads to @xmath58    [ eq : limit2 ] carries an important message .",
    "it reveals us that , while a superficial inspection of [ eq : expw ] might suggest that the expected trade volume @xmath26 is independent on the topology of the itn , i.e. on @xmath52 or equivalently @xmath36 , this is actually not the case . in fact , @xmath52 is coupled to the other values @xmath45 ( with @xmath59 ) through the normalization condition manifest in [ eq:1-q ] .",
    "this necessarily implies that _ the topology of the itn must have an immediate effect on the expected volume of trade between any two countries .",
    "_ this effect is rigorously quantified in [ eq : limit2 ] , which shows that @xmath26 depends on both @xmath37 and @xmath36 .",
    "this result confirms the inconsistency of the traditional gm defined in terms of [ eq_gravity ] and of any of its extensions of the form [ eq_gravityf ] .",
    "by contrast , _ the expected topology of the itn is independent on the expected volumes of trade _",
    ", since @xmath25 depends on @xmath36 but not on @xmath37 .",
    "this simple but , to the best of our knowledge , previously unrecognized result highlights a nontrivial asymmetry between weights and topology in the itn and , by extension , in any ( economic ) network described by our generic expressions involving @xmath37 and @xmath36 .",
    "this basic finding provides a natural explanation for the aforementioned empirical observation that the topology of the itn and several other networks can be satisfactorily reconstructed from aggregate local constraints  @xcite , while the same result does not hold for the weighted structure of the same network(s )  @xcite , unless topological information is explicitly included as an additional constraint  @xcite .",
    "[ eq : limit1 ] and [ eq : limit2 ] fix two important properties we require for @xmath45 and ultimately @xmath41 , but they do not specify these probability distributions uniquely .",
    "to do so , we take the maximum - entropy approach and look for the form of @xmath41 that maximizes the entropy @xmath60 where the sum extends over all weighted graphs with @xmath3 nodes and non - negative integer edge weights , subject to the constraints specified by [ eq : limit1 ] and [ eq : limit2 ] .",
    "the maximum - entropy method ensures that the resulting functional form of @xmath41 is maximally random , given the desired constraints .",
    "as well known , this procedure is guaranteed to lead to the least biased inference , i.e. to introduce no unjustified ` hidden ' assumption in picking a specific form of @xmath41 .    since [ eq : limit1 ] is equivalent to [ eq : fermig ]",
    ", we select @xmath61 and @xmath26 as the two sets of constraints specifying our model . in this way ,",
    "if we introduce @xmath62 and @xmath63 as the ( real - valued ) lagrange multipliers required to enforce the expected value of @xmath64 and @xmath9 respectively ( where @xmath65 if @xmath66 and @xmath67 otherwise ) , then the maximum - entropy problem becomes equivalent to one solved exactly in ref .",
    "there , it was shown that upon introducing the so - called _ hamiltonian _ @xmath68 , \\label{eq : h}\\ ] ] ( representing a linear combination of the quantities whose expected value is being constrained ) and the _ partition function _",
    "@xmath69 , the maximum - entropy probability @xmath70 with constraints @xmath61 and @xmath26 is found to be @xmath71 where , given @xmath72 and @xmath73 , @xmath74 is the resulting ( maximum - entropy ) probability that the link from node @xmath0 to node @xmath1 carries a weight @xmath46 .",
    "this probability is called the bose - fermi distribution , as it unifies the bose - einstein and fermi - dirac distributions encountered in quantum statistical physics  @xcite .",
    "we stress again that all our formulas apply to both directed and undirected representations of the network and , correspondingly , the sums and products over @xmath49 should be interpreted as @xmath75 in the directed case ( where the pairs @xmath49 and @xmath76 are different ) and as @xmath77 in the undirected one ( where the pair @xmath49 is the same as the pair @xmath76 ) .",
    "as we had anticipated , the factorization of @xmath70 in terms of products of @xmath78 shows that , for this particular choice of the constraints , pairs of nodes turn out to be statistically independent as in the standard gm approach , even if we have not assumed this independence as a postulate in our approach .",
    "importantly , while the constraints used in the maximum - entropy models of the itn considered so far in the literature are observed topological properties ( e.g. the degrees and/or the strengths of nodes ) , the constraints considered here are economically - driven expectations , namely [ eq : fermig ] and [ eq : limit2 ] . this key step allows us to reconcile macroeconomic and network approaches within a generalized framework , and represents an important difference with respect to previous models .",
    "in particular , we use [ eq:1-q ] , [ eq : expw ] and [ eq : condw ] to express @xmath25 , @xmath26 and @xmath33 in terms of @xmath79 and @xmath80  @xcite : @xmath81 now , equating [ eq_ppp * ] to [ eq : fermig ] and [ eq_w * ] to [ eq : limit2 ] ( or , equivalently , [ eq_ww * ] to [ eq_gravityf1 ] ) allows us to find the values of @xmath79 and @xmath80 solving the original problem : @xmath82 inserting [ eq_x ] and [ eq_y ] into [ probq ] , we finally get the explicit probability of any two countries trading a volume @xmath46 , as a function of any choice of the factors @xmath13 and @xmath14 .    in terms of conditional probabilities ,",
    "our model becomes extremely simple : establishing a link from country @xmath0 to country @xmath1 is a bernoulli trial with success probability @xmath25 given by [ eq : fermig ] ; if realized , this link acquires a weight @xmath46 with probability @xmath83^{w-1}}{\\left[f_{\\mathbf{\\phi}}(\\mathbf{n}_i,\\mathbf{n}_j,\\mathbf{d}_{ij})\\right]^{w}}\\qquad w > 0 , \\label{probq**}\\ ] ] which is a geometric distribution representing the chance of @xmath84 consecutive successes , each with probability @xmath80 , followed by a failure with probability @xmath85 .",
    "the above result provides an insightful interpretation of the realized volumes in the model in terms of processes of link establishment and link reinforcement ( see discussion ) .",
    "we now take an econometric perspective and discuss how the model parameters can be chosen to optimally fit a specific empirical instance of the network . to this end , we use the maximum likelihood principle applied to network models  @xcite . if @xmath86 denotes the weight matrix ( with entries @xmath87 ) of the empirical network , our model generates this particular matrix with probability @xmath88 .",
    "we therefore define the log - likelihood function as @xmath89 ( where we have dropped the dependence of @xmath37 and @xmath36 on @xmath13 , @xmath90 and @xmath14 ) and look for the parameter values @xmath91 that maximize @xmath92 by requiring that all the first derivatives with respect to @xmath39 and @xmath38 vanish simultaneously : @xmath93\\vec{\\nabla}_\\mathbf{\\phi}f_\\mathbf{\\phi}=\\vec{0}\\label{eq : maxphi}\\\\ \\vec{\\nabla}_\\mathbf{\\psi}\\mathcal{l}(\\mathbf{\\phi},\\mathbf{\\psi})&=&\\sum_{i , j}\\left[\\frac{a^*_{ij}}{g_\\mathbf{\\psi}}-\\frac{1}{1+g_\\mathbf{\\psi}}\\right]\\vec{\\nabla}_\\mathbf{\\psi}g_\\mathbf{\\psi}=\\vec{0}.\\label{eq : maxpsi}\\end{aligned}\\ ] ] upon checking that the second derivatives have the correct sign , i.e. that @xmath94 is indeed a maximum for @xmath92 , the solution @xmath95 to the above equations yields the optimal parameter values in our model .",
    "selecting these values into [ eq_x ] and [ eq_y ] yields the values @xmath96 and @xmath97 that , when inserted into [ probq ] , fully specify the model .",
    "the above expressions , which are valid _ any _ specification of the egm , show that the estimation of the parameter @xmath98 nicely separates from that of @xmath99 .",
    "this result solves , in a single shot , two major problems encountered in previous econometric approaches : on one hand , in most alternative models the estimation of the parameters determining the expected weights is badly affected by the presence of the zeroes ; on the other hand , the expected number of zeroes may paradoxically depend on the ( arbitrary ) units of measure for the weights .",
    "for instance , if @xmath45 is a poisson distribution as in zero - inflated gms  , then its only parameter ( the mean ) determines both the magnitude of link weights and the connection probability @xmath25 . as the units of money in the data",
    "are changed arbitrarily ( e.g. from dollars to thousands of dollars ) , so will the estimated mean and the resulting expected number of zeroes . by contrast , in our model the zeroes affect @xmath100 but not @xmath98 and the money units affect @xmath100 but not @xmath101 .",
    "we can finally test the predictions of our model against empirical international trade data .",
    "these predictions are found to improve dramatically upon those of the traditional gm .",
    "we adopt an undirected network description ( where the connection between two countries carries a weight equal to the total trade in either direction ) to facilitate the definition of the topological properties characterizing the itn .",
    "previous work has shown that , given the highly symmetric structure of the itn , the undirected representation retains all the basic properties of the network  @xcite .",
    "we choose @xmath16 in such a way that the expected non - zero trade flow @xmath33 is the same as in the gm defined by [ eq_gravity ] ( now interpreted as a conditional expectation ) .",
    "this means choosing @xmath40 , @xmath102 , @xmath103 and @xmath104 where we have set @xmath105 due to undirectedness .",
    "similarly , we choose @xmath106 in such a way that the probability @xmath25 is the same as in the model defined in [ eq : fermi ] , i.e. @xmath107 and @xmath108 with the above specification , the expected topology does not depend on any dyadic factor .",
    "this is the simplest choice that is found to reproduce the topology of the itn very well  @xcite and is supported by empirical evidence that dyadic factors like geographic distances  @xcite and trade agreements  @xcite have a much weaker effect on the purely binary topology of the itn than on trade volumes .",
    "of course our formalism has been designed in such a way that we can immediately add dyadic factors , and is therefore much more general .",
    "for instance , we might easily add ` hidden ' metric distances inferred via an optimal geometric embedding  @xcite ( although they would not be identifiable with some empirically measurable , ` external ' macroeconomic factors like those used elsewhere in our model ) .",
    "given the above model specification , for a given instance @xmath86 of the empirical network we find the optimal parameter values @xmath109",
    ", @xmath110 , @xmath111 and @xmath112 through the maximum likelihood conditions given by [ eq : maxphi ] and [ eq : maxpsi ] .",
    "importantly , [ eq : maxpsi ] reads in this case @xmath113 and yields a value @xmath112 that ensures that the expected number of links @xmath114 is exactly equal to the empirical number @xmath115 , irrespective of the volumes of trade .",
    "this result , which is equivalent to what is found for the purely binary model defined by [ eq : fermi ]  @xcite , shows that , unlike the standard gm , our model always generates the correct number of links and , unlike some more complicated variants of the gm , it does so independently of the money units chosen for the volumes .",
    "we first test the performance of the egm in replicating the empirical trade volumes , i.e. the purely local structure of the itn . in fig .",
    "[ fig-1 ] , superimposed to the previous results for the standard gm given by [ eq_gravity ] , the empirical non - zero link weights @xmath87 are also compared with their conditional expected value @xmath33 under the egm given by [ eq : f ] .",
    "as expected , the two sets of points largely overlap , confirming that , in terms of trade volumes , the egm can not do worse than the gm . moreover , the egm is more parsimonious than the gm as it achieves a narrower scatter of points while having no dedicated free parameter to tune the variance .",
    "we then check the performance of the egm in replicating the purely binary topology of the itn . as a first illustration , in fig .",
    "[ fig - world ] we show all the trade links of the country with maximum degree ( usa ) , the one with minimum degree ( western sahara ) and one with intermediate degree ( vanuatu ) .",
    "we also show the corresponding predictions under the standard gm ( where [ eq_gravity ] is first fitted to the non - zero flows and then extended to all pairs of countries ) and the egm . since the traditional gm predicts a fully connected network , i.e. an expected degree @xmath116 for all @xmath0 , its prediction is correct only for the country with maximum degree and deteriorates dramatically as the degree decreases .",
    "by contrast , the egm gives an expected degree @xmath117 ( see materials and methods ) which is in good agreement with the empirical one for the entire range of connectivity .",
    "we now consider higher - order topological properties as a more stringent and quantitative test . in the top left panel of fig .",
    "[ fig : topology ] we plot the average degree ( @xmath118 ) of the trade partners of each country @xmath0 versus the number of such partners ,",
    "i.e. the degree ( @xmath119 ) of country @xmath0 itself .",
    "similarly , in the top right panel of fig .",
    "[ fig : topology ] we plot the clustering coefficient ( @xmath120 ) , i.e. the fraction of trade partners of country @xmath0 that trade with each other , again versus the number ( @xmath119 ) of such partners .",
    "the empirical quantities are compared with the expected quantities under the gm and the egm .",
    "the exact expressions for both empirical and expected quantities are provided in materials and methods .",
    "the decreasing empirical trends observed in both plots shows that the trade partners of poorly connected countries ( small @xmath119 ) are on average highly connected , both to the rest of the world ( large @xmath118 ) and among themselves ( large @xmath120 ) . by contrast , countries that trade with a high - degree country ( large @xmath119 ) are on average poorly connected , both to the rest of the world ( small @xmath118 ) and among themselves ( small @xmath120 ) . for both properties , we find that the egm is in excellent agreement with the empirical itn , as opposed to the classical gm which systematically generates nearly constant and much higher values , as a result of predicting a complete network .",
    "having checked that the egm does very well in separately replicating both the local link weights and the global topology of the itn , we now perform a last and most severe test monitoring properties that combine topological and weighted information together . in the bottom left panel of fig .",
    "[ fig : topology ] we plot the average strength ( @xmath121 ) , i.e. the average traded volume , of the trade partners of each country @xmath0 versus the strength ( @xmath122 ) of country @xmath0 itself . in the bottom right panel , we plot a weighted version of the clustering coefficient ( @xmath123 ) of country @xmath0 , again versus the strength ( @xmath122 ) of country @xmath0 .",
    "the empirical trends are compared with the predictions of the gm and egm ( see materials and methods for all definitions ) .",
    "these two plots are in some sense the weighted counterparts of the purely binary plots considered above .",
    "we find that , on average , countries connected to countries with a low trade activity ( small @xmath122 ) trade a lot with the rest of the world ( large @xmath121 ) but relatively less among themselves ( small @xmath123 ) .",
    "countries connected to countries with a large volume of trade ( large @xmath122 ) have instead a small trade activity with the rest of the world ( small @xmath121 ) , but trade relatively strongly with each other ( large @xmath123 ) .",
    "again , we find that both trends are replicated very well by the egm , while the standard gm fails systematically .",
    "in this paper we have introduced the egm as a novel , advanced model for the itn and economic networks in general .",
    "phenomenologically , the egm allows us to reconcile two very different approaches that have remained incompatible so far : on one hand , the established gm which successfully reproduces non - zero trade volumes in terms of gdp and distance , while failing in predicting the correct topology  @xcite ; on the other hand , network models which have been successful in reproducing the topology  @xcite but are more limited in predicting link weights  @xcite . to our knowledge",
    ", the egm is the first model that can successfully reproduce the binary and the weighted empirical properties of the itn simultaneously . just like the standard gm , the rm  @xcite or similar models",
    ", the egm can accomodate additional economic factors in terms of extra dyadic and country - specific properties .",
    "the agreement between the egm and trade data calls for an interpretation of the process generating the network in the model . in this respect",
    ", we notice that [ probq ] and [ probq * * ] allow us to interpret the realized trade volumes in the egm as the outcome of two equivalent processes ( a serial and a parallel one ) of link creation and link reinforcement . in the serial process , for a given pair of countries @xmath49 a trade link of unit weight",
    "is first established with success probability @xmath25 and its volume is then incremented in unit steps , each with success probability @xmath80 .",
    "after the first failure , the process stops and starts again for a different pair of countries , and so on for all pairs . in the equivalent parallel process ,",
    "all pairs of countries simultaneously explore the mutual benefits of trade and engage in a first connection , each with its probability @xmath25 .",
    "then , all pairs of nodes for which the previous event has been successful reinforce their existing connection by a unit weight , each with its probability @xmath80 .",
    "the process stops as soon as there are no more successful events . in either case ,",
    "[ probq ] is the resulting probability that the realized volume is @xmath46 .",
    "importantly , [ probq ] implies that @xmath78 is a geometric distribution with an extra point mass @xmath124 at zero volume , i.e. the first event has a probability @xmath25 which is in general different from the probability @xmath80 of all subsequent events .",
    "this distinguishing property of the bose - fermi distribution  @xcite ensures a realistic network formation mechanism where the establishment of a trade connection for the first time is intrinsically different ( and therefore associated to a different ` cost ' ) from the reinforcement of an already existing trade connection .",
    "this desirable distinction , interpretable for instance in terms of profitability of trade , has been advocated in previous studies  . here",
    ", it is implemented naturally within the maximum - entropy framework via [ eq : h ] , where the ( expected ) binary topology is enforced separately from the ( expected ) link weights .",
    "notice that the distinction disappears if the parameter @xmath62 in [ eq : h ] is set to zero , i.e. if the constraint on the expected value of @xmath125 ( the expected topology ) is removed as in the standard gm .",
    "in such a case , @xmath25 becomes equal to @xmath80 ( i.e. link creation and link reinforcement become equally likely ) and therefore @xmath126 , not only @xmath127 , becomes a geometric distribution .",
    "consistently with the fact that trade volumes are always reported as integer multiples of some indivisible money unit ( e.g. dollars ) , we have assumed non - negative integer weights .",
    "it is easy to show that , if we take the limit of a vanishing money unit , trade volumes become non - negative real numbers and @xmath78 becomes an exponential density with an extra point mass at zero volume , while @xmath128 becomes a purely exponential density .",
    "crucially , the extra point mass @xmath124 ensures that , even in this continuous limit , @xmath25 is unchanged and the topology is still described by [ eq : fermig ] . in absence of @xmath62 , in this limit the network would become fully connected as in all specifications of the gm with continuous volumes  @xcite .",
    "our results may have strong implications for the theoretical foundations of trade models and for the resulting policy implications .",
    "it is known that the traditional gm is consistent with a number of ( possibly conflicting ) micro - founded model specifications .",
    "for instance , a gravity - like relation can emerge as the equilibrium outcome of models of trade specialization and monopolistic competition with intra - industry trade @xcite .",
    "the empirical failure of the standard gm highlights a previously unrecognized limitation of these micro - founded models , at least in their current form , and indicates the need for an appropriate reformulation that makes these model consistent with the egm , i.e. with a realistic topology of the itn .",
    "how policy implications change as the result of such a reformulation of current micro - founded models is an important point to add to the future research agenda .",
    "we therefore believe that the egm can represent a novel benchmark supporting improved theories of trade and refined policy scenarios .",
    "we have used international trade and gdp data from the database curated by gleditsch  @xcite for the years 1950 , 1960 , 1970 , 1980 , 1990 and 2000 .",
    "this database includes yearly trade volumes @xmath9 ( which we have symmetrized by taking the sum of @xmath129 ) , yearly gdp values , and the ( time - independent ) distance matrix @xmath7 .",
    "the numer @xmath3 of countries increases over time from roughly 85 in 1950 to approximately 200 in 2000 .",
    "both gdp and trade date are reported in u.s .",
    "dollars . to produce fig .",
    "[ fig - world ] , we have used the baci database  @xcite , which reports imports and exports between @xmath130 countries in 2011 .",
    "the baci data were originally in disaggregated form , where total trade was resolved into 96 different non - overlapping commodity classes .",
    "we have aggregated all these commodity classes together , and again symmetrized , to obtain a dataset consistent with the gleditsch data used for the earlier years .      given a weighted undirected network with weight matrix @xmath43 and adjacency matrix @xmath131 , with entries related through @xmath64 , the _ degree _ of node @xmath0 is defined as @xmath132 the _ average nearest - neighbor degree _ of node @xmath0 is defined as @xmath133 and the _ ( binary ) clustering coefficient _ of node @xmath0 is defined as @xmath134 the _ average nearest neighbor strength _ of node @xmath0 is defined as @xmath135 ( where @xmath136 is the _ strength _ of node @xmath0 ) and the _ weighted clustering coefficient _ of node @xmath0 is defined as @xmath137      the expected value ( under the egm ) of each of the network properties defined above can be calculated either numerically , by averaging over many network realizations sampled independently from the probability @xmath70 in [ probp ] , or analytically , using the following approach .",
    "first of all , in this model the expected value of all ratios can be approximated by the ratio of the expected values  @xcite .",
    "secondly , all numerators and denominators involve only products over distinct pairs of nodes , which are statistically independent in the model . using [ probq ]",
    ", the expected values of such products can therefore be calculated exactly in terms of @xmath79 and @xmath80 as follows : @xmath138 where @xmath139 , as given by [ eq_ppp * ] , and @xmath140 @xmath141 denoting the so - called @xmath142th polylogarithm of @xmath143 . from the above two considerations",
    ", it follows that the expected properties of all quantities of interest can be approximated with entirely analytical expressions obtained by simply replacing @xmath28 with @xmath25 and @xmath144 with @xmath145 in [ eq : k ] , [ eq : knn ] , [ eq : cbin ] , [ eq : snn ] and [ eq : cwei ] . via @xmath79 and @xmath80 ,",
    "the expected values are ultimately a function of only the gdps and distances . in our analysis ,",
    "after preliminary checking that the analytical expressions matched extremely well with the numerical averages over realizations , we have systematically adopted the analytical approach , which requires no sampling of networks and is therefore extremely efficient .",
    "aa and dg acknowledge support from the dutch econophysics foundation ( stichting econophysics , leiden , the netherlands ) .",
    "this work was also supported by the netherlands organization for scientific research ( nwo / ocw ) .",
    "d. balcan , v. colizza , b. gonalves , h. hu , j. j. ramasco , a. vespignani , _ multiscale mobility networks and the spatial spreading of infectious diseases _ , proc .",
    "usa * 106*(51 ) , 21484 - 21489 ( 2009 ) .",
    "t. squartini and d. garlaschelli , _ jan tinbergen s legacy for economic networks : from the gravity model to quantum statistics _ , in econophysics of agent - based models ,",
    "161 - 186 ( springer international publishing , 2014 ) .",
    "f. picciolo , t. squartini , f. ruzzenenti , r. basosi , d. garlaschelli , _ the role of distances in the world trade web _ , proceedings of the eighth international conference on signal - image technology & internet - based systems ( sitis 2012 ) , pp .",
    "784 - 792 ( edited by ieee ) ( 2013 ) ."
  ],
  "abstract_text": [
    "<S> the structure of the international trade network ( itn ) , whose nodes and links represent world countries and their trade relations respectively , affects key economic processes worldwide , including globalization , economic integration , industrial production , and the propagation of shocks and instabilities . characterizing the itn via a simple yet accurate model </S>",
    "<S> is an open problem . </S>",
    "<S> the traditional gravity model successfully reproduces the volume of trade between connected countries , using macroeconomic properties such as gdp , geographic distance , and possibly other factors . </S>",
    "<S> however , it predicts a network with complete or homogeneous topology , thus failing to reproduce the highly heterogeneous structure of the itn . on the other hand , </S>",
    "<S> recent maximum - entropy network models successfully reproduce the complex topology of the itn , but provide no information about trade volumes . here </S>",
    "<S> we integrate these two currently incompatible approaches via the introduction of an enhanced gravity model ( egm ) of trade . </S>",
    "<S> the egm is the simplest model combining the gravity model with the network approach within a maximum - entropy framework . via a unified and principled mechanism that is transparent enough to be generalized to any economic network , </S>",
    "<S> the egm provides a new econometric framework wherein trade probabilities and trade volumes can be separately controlled by any combination of dyadic and country - specific macroeconomic variables . </S>",
    "<S> the model successfully reproduces both the global topology and the local link weights of the itn , parsimoniously reconciling the conflicting approaches . </S>",
    "<S> it also indicates that the probability that any two countries trade a certain volume should follow a geometric or exponential distribution with an additional point mass at zero volume . </S>"
  ]
}