{
  "article_text": [
    "convection in stars is the most important mixing process .",
    "it is essential for heat transport and mixing of elements .",
    "therefore , convection is an essential ingredient in the evolution of stars and in the formation of the elements in stars and stellar explosions @xcite .",
    "the treatment of convective boundaries is a key uncertainty in present stellar evolution calculations . in particular , mixing at the rather stiff ( see below ) boundaries of convection in the deep stellar interior has been related to numerous observational properties of stars . determining reliable quantitative mixing properties of convection boundaries remains an unsolved problem .",
    "overshooting at the boundary of h - core convection has been investigated for the past 40 years ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "evidence for convective boundary mixing ( cbm ) at the bottom of the solar convection zone has been presented based on helioseismology @xcite and hydrodynamic simulations ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) . for thermal - pulse asymptotic giant branch ( agb ) stars",
    "cbm is important for the occurrence of the third dredge - up ( for example * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , the reproduction of observed properties of agb stars @xcite , and in post - agb stars @xcite .",
    "more recently it has been shown that cbm can explain the observed enrichment of nova ejecta @xcite .",
    "furthermore , cbm at the bottom of c- and ne - burning shells in super - agb stars and transition mass objects is critical for the progenitors of supernova ia and possible core - collapse supernova @xcite .    in this paper we present results for simulations of he - shell flash convection in agb stars , including convective boundary mixing at the upper boundary .",
    "we would like to investigate the global properties of convective flows in this type of convection , and the convective boundary mixing in general for a case in which the boundary is very stiff .",
    "specifically we focus here upon the entrainment of hydrogen - rich material into the convection zone above a helium burning shell .",
    "such situations have been addressed by @xcite .",
    "@xcite and @xcite , and similar entrainment events by the convection zone above an oxygen burning shell and the h - burning core convection have been treated by @xcite .",
    "@xcite also discuss such simulation results with a goal of producing improved mixing length models for use in 1-d stellar evolution simulations .",
    "our own work has to this point focused on the entrainment problem @xcite , separated from the complicating factors of nuclear burning of the ingested fuel .",
    "we wish to establish that our computational methods are capable of accurately simulating the entrainment process before we add in the nuclear burning and back reaction on the flow of the energy liberated in that process .",
    "nevertheless , we have produced a detailed analysis using 1-d stellar evolution techniques with a parameterized treatment of convective boundary mixing that indicates the dynamical behavior that a proper 3-d analysis of hydrogen ingestion and burning is likely to yield in the specific , well observed case of sakurai s object @xcite .",
    "a follow - on to this article will present results obtained using our ppmstar code for that particular case ( see * ? ? ? * for preliminary results ) .",
    "the present paper is intended to describe the challenges that convective boundary mixing poses to numerical simulation , set out in the context of a representative hydrogen ingestion problem .",
    "the upper convective boundary of a he - shell flash convection zone about to make contact with the h - rich layer above is much stiffer compared , for example , to the cases investigated by @xcite , and consequently we find a much smaller entrainment rate in this situation .",
    "we describe how we meet the challenge of converged entrainment simulations for a very stiff convective boundary by a combination of advanced numerical techniques and high grid resolution .",
    "we present evidence that for the aspect of these problems that we judge to be the most critical  the hydrogen entrainment rate at the upper convective boundary  our simulations are able to produce results that converge upon grid refinement . because this ingestion is expected to have dramatic effects upon the star by releasing more energy than the shell - burning source producing the convection that causes it",
    ", it is very important that it be computed accurately .",
    "we can not comment upon the accuracy of simulations by others , but we note that the results that are obtained vary greatly . in work by others ,",
    "the conditions of the convective boundary mixing differ substantially from our own and from each other , so that direct comparisons are not possible .",
    "nevertheless , we have observed in our own work that the all - important entrainment rate depends strongly upon the grid resolution until a sufficiently fine grid is used .",
    "all investigators have of course reported results obtained on different grids .",
    "@xcite find luminosities that differ by 3 orders of magnitude for simulations of the same problem performed on grids differing in linear resolution by a factor of 2 .",
    "@xcite present results for only a single 3-d grid .",
    "it is arranged in a @xmath4 wedge geometry that precludes the development of large - scale or global modes .",
    "they establish their grid requirement from simulations performed at different resolutions in 2-d .",
    "@xcite present results for a series of simulations on progressively finer grids , which cover a sector of the convection zone above an oxygen burning shell .",
    "they state that they do not observe convergence under grid refinement in the mean fields in the narrow region of steep gradients at the base of their oxygen burning shell . because we will base our subsequent studies of hydrogen ingestion flash events upon our ppmstar code , discussed here , and because previously reported results establish the difficulty of accurate simulation of such events , our goals in this paper are twofold .",
    "in addition to presenting our quantitative results on entrainment for our particular problem and the general properties of he - shell flash convection in @xmath0 geometry , we set out in this paper our computational techniques and the evidence that they are equal to the task we have set for ourselves in our subsequent work .",
    "regions in stars are convectively unstable if the radiative energy transport is less efficient than convective transport @xcite .",
    "the schwarzschild condition determines instability against convection if the radiative temperature gradient is larger than the adiabatic temperature gradient .",
    "the radiative temperature gradient is given by @xmath5 where @xmath6 is the rosseland mean opacity or the electron conduction coefficient , @xmath7 is the luminosity , @xmath8 the temperature , @xmath9 the radius , @xmath10 the density , @xmath11 is the radiation - density constant and @xmath12 the speed of light .",
    "eq.([eq : trad ] ) shows that convective instability can be caused by either large opacity or by large luminosity ( see , for example , fig.3 in * ? ? ?",
    "the former is the case for surface convection , for example in the shallow surface convection of a - type stars and white dwarfs @xcite , in the sun ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , or in the deep convective envelopes of giant stars @xcite .",
    "convection in the deep interior is usually driven by high luminosity , as for example in he - shell flashes in thermal pulse asymptotic giant branch stars @xcite , in oxygen and carbon shell burning in the advanced evolution phases of massive stars @xcite or in he - core flashes @xcite .",
    "convection in the deep interior at high densities is usually very efficient and the temperature gradient is therefore nearly adiabatic .",
    "however , in surface convection , where in some cases a significant fraction of the energy is transported by radiation , the actual temperature stratification is often super - adiabatic , reflecting the inefficiency of convection .",
    "along with this difference between near - surface and envelope convection on the one side , and deep interior convection on the other side goes generally speaking a marked difference in stiffness of the convective boundary .",
    "this stiffness reflects the ratio of the degree of acceleration in the convectively unstable region to the degree of deceleration in the stable region .",
    "the stratification can be approximated piecewise by polytropes with @xmath13 where @xmath14 is a constant , @xmath15 and @xmath10 are the pressure and the density and @xmath16 is given by the polytropic index @xmath17 .",
    "the stiffness @xmath18 , or relative stability , can then be expressed in terms of the polytropic index for the adiabatic stratification ( @xmath19 for @xmath20 ) , the convectively stable ( @xmath21 ) and the convectively unstable ( @xmath22 ) stratification by @xcite : @xmath23 the stability of the stratification of a monatomic ideal gas in terms of the polytropic index @xmath24 follows from the definition of the entropy @xmath25 considering that the entropy gradient @xmath26 is zero for an adiabatic stratification , @xmath27 for a stable ( subadiabatic ) and @xmath28 for an unstable ( superadiabatic ) stratification .    as may be expected ,",
    "the degree of penetration and overshooting of flows across the convective boundary and the associated degree of mixing of thermodynamic quantities and species concentrations is larger for smaller stiffness @xcite . at small stiffness , such as in shallow surface convection @xcite",
    ", coherent convective systems will cross the convective boundary and only start to decelerate on the stable side due to buoyancy effects .    in the deep stellar interior convection zones",
    ", high density implies effective convective transport .",
    "the denominator in eq.([eq : stiffness ] ) is small ( @xmath29 ) and therefore @xmath30 . in this situation",
    "the convective flows nearing the boundary are `` feeling '' via the building pressure the almost impenetrable boundary already from a distance @xcite , and in order to obey mass continuity will start to turn around already inside the convectively unstable layer .",
    "a requirement for this behavior is also of course convective velocities well below the local speed of sound . in the he - shell flash convection situations of interest to us ,",
    "this requirement is certainly fulfilled , at least in the absence of positive feedback from the burning of ingested hydrogen . even while no coherent convective systems cross the convective boundary , mixing at the boundary",
    "will still occur . in this case",
    "the shear flows induced by turning - around convection flows will induce entrainment @xcite , mostly via the kelvin - helmholtz instability in the boundary layer .    in summary ,",
    "a range of hydrodynamic processes and instabilities contribute to mixing and entrainment at convective boundaries ( see * ? ? ? * for a similar but more detailed discussion ) . for deep stellar interior mixing the cbm layer",
    "is very small .",
    "another example of this type of cbm is found in the context of the thermonuclear - runaway - driven convection in novae @xcite . while averaged properties pertaining to the inside of the convection zone seem to converge already at modest numerical resolutions ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) the narrow convective boundary layers constitute a challenge in terms of reaching numerical convergence @xcite .",
    "a narrow and very stiff convective boundary layer can be found at the top of the he - shell flash convection zone in agb and post - agb stars at the moment when they make contact with the h - rich material above .",
    "such a situation has been encountered in stellar evolution simulations of agb stars with very low metal content with [ fe / h]@xmath31 ( e.g. * ? ? ?",
    "* ) , post - agb stars @xcite .",
    "it leads to violent convective - reactive events involving rapid nuclear energy release from @xmath32 reactions in convective regions with large mass fractions of primary @xmath33 .",
    "numerous investigations of this scenario have been subsequently carried out in the spherically symmetric stellar evolution framework ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "however , protons ingested into the he - shell flash convection zone on the convective time scale will be advected downward to increasing temperatures until the nuclear reaction time scale of the @xmath34 rate equals the hydrodynamic flow time scale .",
    "the resulting significant energy feedback on the convective flow time scale violates the assumptions of the mixing length theory , concerning time and spatial averages , and a treatment in spherical symmetry adopted in one - dimensional stellar evolution codes may become problematic .",
    "evidence for the failure of mixing - length theory based stellar evolution models arises from the analysis of the light - curve @xcite and the highly non - solar , anomalous abundance distribution @xcite in the h - ingestion , very - late thermal pulse post - agb object sakurai s object .",
    "this post - agb star belongs to the @xmath35 of all single post - agb stars that suffer a final he - shell flash after they have already left the agb . among those",
    ", the very - late thermal pulse stars @xcite , but especially sakurai s object , provide a unique opportunity to investigate the h-@xmath33-combustion regime in stellar evolution , because it is a nearby object that has been observed in real - time ( * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) so that detailed information about the light curve is available . even more importantly",
    ", abundance information of the post - flash evolution has been obtained at a time after the outburst @xcite and this has been shown to provide strong constraints on the hydrodynamic processes of combined convection and rapid nuclear burning , i.e.  the physics of h-@xmath33-combustion in stellar evolution @xcite .",
    "we are therefore fortunate to have a very powerful validation case for simulations of h-@xmath33  combustion , and therefore our attention is directed to carefully check if our simulations pass this validation test .    as mentioned earlier ,",
    "hydrodynamic simulation results of h - ingestion presented so far are either unlikely to be converged and therefore must be considered questionable @xcite , or it is not clear if they indeed constitute a convective - reactive h - ingestion case .",
    "we suspect the latter to be the case for the simulations presented by @xcite who adopt an initial setup with an artificially shifted h - profile .",
    "the emerging h - burning convection features a long nuclear time scale for the @xmath34 reaction due to the relatively low temperature in that zone .",
    "the resulting damkhler number is @xmath36 , much lower than the value around unity that characterizes a convective - reactive regime .",
    "we may therefore conclude that previous work on convective boundary mixing as it pertains to the h - ingestion events , which are our interest in this paper , provides only limited guidance .",
    "our strategy is to attack the problem of h - ingestion into he - shell flash convection zones by constructing accurate 3-d hydrodynamic simulations . to verify these simulations",
    "we show that they converge upon grid refinement in important respects , such as the entrainment rate studied here . in the future",
    "we will take advantage of the validation opportunity provided by sakurai s object to compare simulation results with observations .",
    "our goal at this point is not to develop models of mixing and burning in h - ingestion that can be applied in stellar evolution calculations to all possible realizations of the h - ingestion regime . as a first step to improve upon the rather qualitative simulations presented in @xcite",
    ", we would rather like to investigate specifically the entrainment process at the upper boundary of he - shell flash convection that is just about to connect to the h - rich envelope .",
    "in h - ingestion cases , like in sakurai s object , the onset of the he - shell flash expands the shell layers before the upper boundary reaches the h - rich layers .",
    "typically the aspect ratio @xmath37 , where @xmath38 is the geometric width of the convection zone and @xmath39 is the radius of the bottom of the convection zone .",
    "we found in our previous studies @xcite that the convective flows are dominated by large scale and global modes for such large aspect ratios .",
    "we therefore consider it necessary to choose a full @xmath0 geometry for our simulations .",
    "one may also expect that the interaction of h - enriched downflows with high - temperature conditions and the ensuing nuclear burning will depend on the entrainment process and vice versa .    for this study we set up our initial conditions to produce shell convection that is typical of the conditions encountered during initial mixing of h - rich material from above the he - shell flash convection zone into the material of the convection zone .",
    "we expect the entrainment rate that develops in such a simulation to depend upon this initial base state , on the heating rate corresponding to the he - burning driving the convection , as well as , of course , on the grid resolution of the simulation .",
    "we might expect the size of the velocity of the fluid of the convection zone near the location of h - rich material entrainment to play an important role in determining the entrainment rate .",
    "therefore , we also investigate the dependence of these velocities in our simulations upon the grid resolution .    with this study",
    "we wish to introduce our updated star simulation methodology and establish that simulations of this type can provide good estimates of the entrainment rate at affordable cost before we proceed to augment these simulations with a treatment of the burning of the ingested h - rich material and the back reactions upon the flow dynamics that this burning produces ( see * ? ? ?",
    "* for preliminary results ) .",
    "this paper is organized as follows . in sect.[sec : method ] we will briefly describe the numerical techniques of the ppmstar hydrodynamics code and the initial setup used for the simulations presented here .",
    "the properties of the hydrodynamic flow and results for entrainment as a function of grid size will be described in sect.[sec : results ] .",
    "we close with a discussion ( sect.[sec : concl ] ) .",
    "the results presented in this paper depend critically on the deployment of the ppb multifluid advection scheme , which is described in detail in the appendix ( sect.[sec : app_method ] ) .",
    "is defined in eq.([eq : entropy - like]).,scaledwidth=50.0% ]",
    "to properly simulate the hydrogen ingestion flash , our numerical techniques must be capable of very accurately treating the dynamics within the small range in radius where the kelvin - helmholtz shear instabilities act to entrain the stably stratified , more buoyant gas above the helium shell flash convection zone into the convection flow .",
    "these instabilities result in breaking waves that cause small puffs of more buoyant gas to become incorporated into the convection flow and subsequently dragged downward into the convection zone .",
    "these breaking waves are observed as trains of small eddies near the top of the convection zone .",
    "these trains of eddies turn downward where opposing horizontal flows associated with adjacent large - scale convection cells meet ( see also the detailed discussion of the entrainment process in sect.[sec : entrainment ] ) . here",
    "buoyant fluid from above the convection zone that has become incorporated into the eddies is pulled downward into the convection zone with the descending sheets of cooler gas ( cf .",
    "sect.[sec : general_properties ] ) .",
    "the final panel of fig.[fig : fv_half ]             shows these large convection cells separated by regions shown in blue of descending gas carrying entrained , buoyant fluid along with it .",
    "trains of eddies peeling off from the top of the convection zone can also be seen in fig.[fig : vort_480 ] , which shows the magnitude of the vorticity in a thin slice through the star .        not only must our method be able to describe the growth and breaking of these kelvin - helmholtz waves at the top of the convection zone , but it must also be capable of carefully tracking the entrained buoyant fluid as it is dragged downward and progressively mixed into the surrounding gas of the convection zone due to turbulence .",
    "this is no small feat , because the boundary between the convectively unstable and stable gas at the top of the convection zone is quite thin .",
    "this is clear from fig.[fig : vort_480 ] , where this transition region appears as an almost perfectly circular line , at which the behavior of the flow changes suddenly and radically , for reasons that were discussed earlier . although the wavelengths of kelvin- helmholtz shear modes will generally be much larger than the thickness of this transition layer , the incorporation of buoyant material at this transition is hard to describe accurately in a numerical treatment unless the thickness of the layer can be resolved on the computational grid . but even deciding what the thickness of this layer would be is not straightforward .",
    "the physical thickness of the transition region where the concentration of hydrogen falls to essentially zero is initially determined by the character of hydrogen burning in the star before the helium shell flash occurs .",
    "as an example that we have adopted here , based on 1-d simulations @xcite this thickness is found to be about @xmath40 ( fig.[fig : entrained_profiles ] ) for the post - agb model before the h - shell flash convection zone . in the lower panel of that figure , the transition region",
    "is shown in a zoomed - in view , and individual grid cell intervals are also indicated . on our finest grid of @xmath2 cells ,",
    "this transition occurs over @xmath41 grid cell widths ( along the grid direction  we use a uniform cartesian grid to describe this region , which has the topology of a thin spherical shell ) .",
    "however , the hydrodynamic properties are not only described by the mean - molecular weight gradient .",
    "the entropy profile matters as well . this can not be known for the convective boundary region from one - dimensional stellar evolution calculations .",
    "our initialization strategy is described in sect.[sec : setup ] .",
    "this is an important point because of the concern that our initial setup may somehow be special and not representative of the conditions in a real star .",
    "star time .",
    "the markers correspond to grid zones .",
    "@xmath1-grid simulation for the entire convection zone .",
    "_ bottom : _ spherically averaged abundance profiles at top convection boundary for the @xmath2-grid simulation , at different times , line labels correspond to minutes of simulated time .",
    "minute @xmath42 represents the initial profile reflecting the smooth transition according to the former h - shell burning at that location ( see text ) . ,",
    "title=\"fig:\",scaledwidth=50.0% ]   star time .",
    "the markers correspond to grid zones . _",
    "@xmath1-grid simulation for the entire convection zone .",
    "_ bottom : _ spherically averaged abundance profiles at top convection boundary for the @xmath2-grid simulation , at different times , line labels correspond to minutes of simulated time .",
    "minute @xmath42 represents the initial profile reflecting the smooth transition according to the former h - shell burning at that location ( see text ) .",
    ", title=\"fig:\",scaledwidth=50.0% ]    we face an additional computational challenge , because our simulations lie in a regime that is right about at the break - even cost mach number for implicit relative to explicit numerical methods .",
    "the peak mach numbers in our flows range around @xmath43 .",
    "we have addressed this flow regime with an explicit gas dynamics scheme , relying on the high computational efficiency of explicit schemes and the @xmath44 to @xmath45 of the machine s peak floating point computation rate ( depending upon the machine ) that our code achieves @xcite to make this approach competitive with implicit methods .      because the entropy plays such a key role in the convective stability or instability of the gas in our problem , we find that to obtain accurate results , it is necessary to solve a conservation equation for the entropy rather than for the total energy . in the absence of shocks and nuclear reactions , the entropy of our gas is conserved along streamlines . at our low flow mach numbers",
    "we do not expect shocks , and we can represent nuclear reactions by source terms in an entropy conservation law . with our gamma - law equation of state , with @xmath46 , we use a conservation law for the adiabatic constant @xmath47 ( eq.[eq : entropy - like ] ) .",
    "this is a technique employed in meteorological codes , where a quantity called the potential temperature takes the place of the entropy . in weather prediction ,",
    "mach numbers in our same general range are typically encountered , so it is natural that similar numerical techniques are useful .",
    "the explicit gas - dynamics code is the same as the one we used in ( * ? ? ?",
    "* appendix a.2 ) and is described in full in @xcite . of particular importance for the entrainment properties at the stable - unstable interface at the top of the convection zone with a mean - molecular weight gradient is the ppb moment - conserving advection scheme ( see * ? ? ?",
    "details of the features of our version of the piecewise - parabolic method ( ppm ) @xcite that make this explicit scheme highly accurate in this flow regime are given in sect.[sec : app_method ] .",
    "we also describe the piecewise - parabolic boltzmann ( ppb ) scheme @xcite as well as the features that enable our ppm scheme to be coupled in a natural way to the ppb scheme to describe multifluid fractional volume advection there .    as in previous work",
    "( e.g. * ? ? ? * ; * ? ? ?",
    "* ) we adopt a monatomic ideal gas equation of state , which represents the conditions in advanced he - shell flash convection at high densities well .",
    "in particular , this equation of state provides a good representation of the conditions in the post - agb he - shell flash that has occurred in sakurai s object . in some other cases ,",
    "such as he - shell flashes in the first thermal pulse of low - mass and low metallcity stars , radiation pressure may be important .",
    "the code uses appropriately scaled code units for all physical quantities .",
    "we consider a two - fluid setup of a convectively unstable shell and a stable layer below with initially one fluid , and a stable layer above the convection zone with a second fluid with lower mean molecular weight .",
    "the simulations are performed on a uniform cartesian grid with a range of grid sizes up to @xmath2 .",
    "the full @xmath0 shell of the convectively unstable layer is included in the simulation , which ensures that any global or large - scale motions can be captured .",
    "the stratification described below covers @xmath48 pressure scale heights in the entire simulation domain , and @xmath49 pressure scale heights in the convection zone .",
    "as in many other multi - dimensional investigations of the hydrodynamics of convection ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* and many of the works mentioned in sect.[sec : intro ] ) , we construct the radial stratification with a set of connected , piecewise polytropic layers in which the polytropic constant and the polytropic index are chosen in such a way that the overall representation resembles a typical situation of a luminosity - driven shell convection layer bounded by a stable layer above and below , just like he - shell flash convection .",
    "this approach has the advantage that the initial state is in very good numerical hydrostatic equilibrium , and initial transients are minimized . mapping a 1-d profile from a stellar evolution code ( as done , e.g.  by * ? ? ?",
    "* ) would provide little in additional accuracy in our case where the microphysics is exceptionally simple . in fig.[fig :",
    "initial_star ] we show the resulting initial stratification in terms of @xmath10 and in terms of the adiabatic constant @xmath50 , which is related to the entropy ( eq.[eq : entropy ] ) @xmath51 with @xmath52 for the monatomic ideal gas . the sound speed decreases from @xmath53 at the bottom of the convection zone to @xmath54 at the top of the convection zone .    the dimension and stratification details of he - shell flash convection in agb stars are variable , as a function of mass , metallicity , early vs.  late thermal pulse and agb vs.  post - agb thermal pulse .",
    "in addition , and quite obviously , the conditions also change dramatically for a given thermal pulse as a function of time due to the large energy deposit from the he - shell flash ( see , for example , fig.1 and 2 in * ? ? ?",
    "the variety of conditions is also reflected in the degree in which radiation pressure contributes to the total pressure .",
    "initially , when the flash starts , the density is so high that the entire pressure is provided by the gas . as the he - shell layer absorbs the peak - flash luminosity of several @xmath55 it rapidly expands .",
    "the temperature decreases more slowly and the radiation pressure contribution increases .",
    "the lowest value for the gas pressure fraction @xmath56 is found at the bottom of the he - shell flash convection zone where it decreases to @xmath57 at the time when the he - burning luminosity reaches its maximum for thermal pulses in a stellar evolution sequence of @xmath58 and @xmath59 with core masses ranging from @xmath60 to @xmath61 .",
    "@xcite adopted a plane - parallel modeling approach , which is appropriate only for a small ratio of the geometric thickness of the convection shell and the radius of the underlying core .",
    "they have therefore chosen a time of the flash just before the peak luminosity is reached .",
    "we simulate the full @xmath0 geometry of the shell .",
    "this is necessary , because the entrainment starts only when the peak luminosity has been reached , or just passed . at that later time in the thermal pulse the convection zone has already greatly expanded and is now thicker than the radius of the underlying core .",
    "we have therefore chosen to reproduce in our setup the geometric dimensions encountered at @xmath62 of the model sequence in fig.1 and 2 shown in @xcite where @xmath63 corresponds to the time when he - burning has reached the flash - peak luminosity . at this time",
    "the density would have further decreased , but still @xmath64 .",
    "thus , we are not simulating here a specific metal - poor agb star , or a post - agb star . rather than trying to reproduce the specific conditions of a particular case we investigate more generally the typical behavior of shell flash convection with very stiff convective boundaries , which do not depend on the exact numerical value of any of the setup parameters .",
    "[ [ the - unstable - layer ] ] the unstable layer + + + + + + + + + + + + + + + + + +    the density , the pressure , the gravity and the radius at the bottom of the convection zone are @xmath65 , @xmath66 , @xmath67 and @xmath68 which imply a core mass below the convection zone of @xmath69 .",
    "this mass is lower than the typical core mass of thermal pulse agb stars , but it allows us to accommodate our choice of an ideal gas equation of state and the geometric dimension of the convection zone while ignoring for the moment a moderate fraction of radiation pressure .",
    "the top of the convection zone is located at @xmath70 .",
    "the equations for hydrostatic equilibrium , mass conservation and eq.([eq : poly ] ) with @xmath71 and @xmath72 given by @xmath73 and @xmath74 , are numerically integrated to provide the density and pressure stratification in the convection zone .",
    "[ [ the - upper - boundary - and - the - stable - layers ] ] the upper boundary and the stable layers + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the layer above the convection zone is stable with @xmath75 .",
    "this region is populated by a fluid representing the h- and he - dominated envelope of agb and post - agb stars with a mean molecular weight @xmath76 similar to a mostly unprocessed envelope abundance distribution that consists predominantly of h and he .",
    "this fluid is therefore labeled h+he. this compares to @xmath77 of the fluid in the convection zone ( labeled conv ) which contains a mix of @xmath78 , @xmath33  and @xmath79that is typical for the he - shell flash convection zone in agb or post - agb stars .",
    "the abundance interface between these two layers is not a discontinuity , but instead it reflects the smooth transition resulting from h - shell burning with varying efficiency across the temperature profile at that location .",
    "the resulting h - profile of a post - agb stellar evolution model shown in fig .",
    "5 in @xcite is representative for this situation .",
    "therefore , the h - profile at the bottom of the h - rich envelope in a radiative layer , before the he - shell flash convection approaches from below , will vary smoothly from a mass fraction of @xmath80 to zero over a width of the former h - burning shell of @xmath81 ( bottom panel , fig.[fig : entrained_profiles ] ) .",
    "the width of this gradual transition from h - rich to h - free depends on the temperature gradient in the h - burning shell , and may vary depending on the particular type of thermal pulse as well as the mass of the underlying degenerate core and the metallicity .    when continuing the integration of the stratification into the stable layer we let both @xmath82 and the concentration of the two fluids vary smoothly over a width of @xmath83 centered at @xmath84 .",
    "that means that the constant entropy region of the convective unstable zone ends at @xmath85 where the entropy gradient becomes positive . in the @xmath2 grid simulation",
    "the interface width @xmath86 corresponds to @xmath41 cells along a grid axis .",
    "the shape of the resulting profile is shown in the bottom panel of fig.[fig : entrained_profiles ] .",
    "when integrating the initial stratification downward from the bottom of the convection zone into the lower stable layer we adopt @xmath87 and a transition layer of @xmath88 centered at @xmath89 .",
    "the fluid type is the same as in the convection zone .",
    "[ [ luminosity - driving - the - convection ] ] luminosity driving the convection + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the flash constitutes a thermonuclear runaway that is the result of an unstable balance between thermodynamic , hydrodynamic and nuclear physics components .",
    "when mapping a 1-d profile into a 3-d code we can not expect the thermonuclear runaway to continue on the same trajectory as in 1-d , with a multitude of small differences between the two simulation approaches .",
    "instead , we use the piecewise - polytropic stratification as a background and add a constant volume heating at the bottom of the he - shell flash convection zone , that has a total luminosity equivalent to the he - burning luminosity in a 1-d stellar evolution model .     and",
    "@xmath90 ) as a function of time for runs with different grid sizes @xmath91 .",
    "the number of grid points @xmath92 in one direction is shown in the legend.,scaledwidth=50.0% ]    the constant heating is applied over a heating region of width @xmath93 , the lower boundary of which is offset from the bottom of the convection zone by @xmath94 to avoid any entrainment of low - entropy material from below the convection zone .",
    "the heating is applied in the @xmath0 shell with a smooth bell - shaped radial intensity distribution .",
    "this arrangement is providing a robust heat source that is independent of the resolution and represents the he - burning luminosity from the triple-@xmath95 reaction .",
    "the heating rate in the standard case corresponds to @xmath96 .",
    "[ [ on - the - absence - of - radiation - in - our - simulations ] ] on the absence of radiation in our simulations + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    unlike in envelope convection and shallow surface convection simulations , the convection is not driven by a subtle degree of superadiabaticity that is only reached in a quantitatively correct sense over the rather long thermal time scale due to the effect of radiative transport at the bottom and top layer of the convection zone . instead",
    ", the convection is very efficient and driven by the large luminosity from the underlying thermonuclear runaway .    in the deep interior case of",
    "he - shell flash convection , radiation transport is not important on the dynamic or convection turn - over time scale ( but radiation pressure may be ) .",
    "the mean free path of a photon is @xmath97 where the @xmath98 to @xmath99 in the convection zone .",
    "the opacity is of order unity , which means that @xmath100 .",
    "the characteristic length scale for radiation transport can be expressed as @xmath101 where @xmath102 . with a radial domain size of @xmath103 the highest resolution runs presented in this paper ( with @xmath104 radial zones ) have a grid size of @xmath105 . if we take as a convective timescale the radial extent of the convection zone divided by the typical velocity in the convection zone ( fig.[fig : ekmax ] ) we obtain @xmath106 and @xmath107 .",
    "therefore @xmath108 , or in other words , within the time that it takes convection flow radially across the entire convection zone radiation transport crosses one simulation cell in the highest resolution case .",
    "however , in outermost layers of the simulation domain the density decreases to @xmath109 and here indeed radiation diffusion will eventually become relevant over the entire course of the simulated time ( typically @xmath110 ) . if these lowest density regions will become important in future simulations , or if the simulated time will further increase or if we further increase the resolution , then indeed diffusive radiation transport should be included .",
    "for the present set of simulations this physics aspect can , however , safely be neglected ( see * ? ? ?",
    "* for a similar conclusion for their o - shell burning simulations ) .",
    "we started this investigation with numerous test simulations at various resolutions , experimenting , for example , with different assumptions for the treatment of the convection boundaries , the properties of the heating zone , peculiarities of different fortran compilers , and the effect of using single vs.  double precision arithmetic .",
    "for the simulations shown here we are adopting the intel 12 fortran compiler and double precision arithmetic .",
    "we have also run test simulations on different hardware platforms .",
    "after we were satisfied with the results of these tests , we performed a grid of simulations for the following grid resolutions grid , which however showed obvious numerical artefacts and were not further considered .",
    "a particularly troublesome feature were entropy - shelves that formed above and below the proper convection zone .",
    "these were small constant - entropy spheres , detached from the big convection zone that formed and survived in the initially stable layers .",
    "these features went entirely away once we adopted higher grid resolutions and double - precision arithmetic . ] : @xmath111 , @xmath112 , @xmath1 , @xmath2 .",
    "movies of these simulations can be found at http://www.lcse.umn.edu/movies .",
    "the simulations on the coarsest grids were performed on the 25-node workstation cluster at the laboratory for computational science & engineering ( lcse ) at the university of minnesota .",
    "those on @xmath112 grids were performed at either the minnesota supercomputing institute ( msi ) or on the canadian westgrid orcinus and lattice high - performance computers , runs on @xmath1 grids were performed at msi , while runs at the highest resolution were performed on the nsf s kraken supercomputer at the national institute for computational sciences ( nics ) .",
    "our run on a grid of @xmath2 cells used 98,312 cpu cores on kraken and consumed 5.2 million cpu - core hours .",
    "the delivered performance was about 120 tflop / s in 64-bit precision .",
    "we will demonstrate in the next section that the @xmath111 grid gives an entrainment rate that is a factor of almost ten larger than the asymptotic entrainment rate , while the @xmath112 grid provides enough resolution to reproduce the asymptotic entrainment almost within a factor of two .",
    "we therefore consider the latter grid size the absolute minimum to perform , for example , differential investigations of the effects of various input assumptions .",
    "[ [ initial - transients - and - grid - effects ] ] initial transients and grid effects + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we do not seed the initial setup with perturbations . instead , the grid provides asymmetries that allow initial perturbations , fueled by the continuous heating at the bottom of the convection zone , to form and grow along the axis directions of the grid ( fig.[fig : vort_inital ] ) .",
    "the initial start - up phase of any simulation like this is prone to artificial , initial transients that are also observed in the time evolution of global properties , such as the spherically and radially averaged rms velocity ( fig.[fig : ekmax ] ) .",
    "the velocity maximum at early times is due to preferential rise of the first plumes along the grid axis .",
    "these initial transients do not matter since we run the simulations for long enough , until we reach a convective steady - state , which is dominated by the physically relevant and realistic fluid motions .",
    "the amount of h - rich material entrained during the initial transients is also very small .",
    "even if its burning were to be included in the simulation , this small amount of entrainment would not generate a dynamically relevant amount of energy .    ) of the run with @xmath2 grid .",
    "same view as in fig.[fig : vort_480 ] except that a smaller portion of the simulation domain is shown .",
    "the heads of the upwelling plumes along the grid axis have advanced approximately half the distance between the bottom and top of the convection zone.,scaledwidth=48.0% ]    during the initial transient the first convective plumes are launched along the grid directions .",
    "this is shown in fig.[fig : vort_inital ] , which shows that at time @xmath113 these plumes have traveled through about half of the radial distance to the upper convective boundary . in all cases",
    "an initial peak of the transient velocity subsides within @xmath114 , shortly after the first plumes have first reached the upper convection boundary ( bottom , left panel fig.[fig : fv_half ] ) .",
    "velocities adopt a local minimum before the heating luminosity takes over the fluid flow dynamics and the rms velocities increase again .",
    "abundance profiles at @xmath115 ( fig.[fig : entrained_profiles ] ) show the action of the initial convective turn - overs    in some previous investigations such initial transients have been damped before or while the convection driving luminosity was turned on ( e.g. * ? ? ?",
    "we do not do anything in particular to dampen the initial transients , but instead study how they become smaller in magnitude with increasing resolution .",
    "indeed , close inspection of fig.[fig : ekmax ] shows that for the highest resolution run ( @xmath2 ) , the peak rms velocity of the initial transient is about as high as the steady - state value approached after @xmath116 .",
    "another concern may be that the initial transient is shaking the interface so much that we get artificial smearing .",
    "the profile evolution at the top convection boundary ( bottom panel , fig.[fig : entrained_profiles ] ) shows that this is not the case .",
    "the initial transients can also be observed in the entrainment visualization shown in fig.[fig : fv_half ] .",
    "these images show the h+he fluid that initially occupies only the region above the convection zone ( see bottom panel , fig.[fig : entrained_profiles ] ) .",
    "abundances @xmath117 are assigned to be transparent in the volume rendering .",
    "levels down to @xmath118 are assigned with opacities of different color , from red to yellow to blue in decreasing order of concentration .",
    "the upper left panel in fig.[fig : fv_half ] shows the initial state in which by design the visible interface is represented by only about one grid zone ( cf.fig.[fig:entrained_profiles ] ) because we only show concentrations below @xmath119 . because the thickness of the visible interface is comparable with the size of a grid zone interference , rings and patterns appear at the location of the cartesian grid directions .    during the initial transient phase ( top - right and bottom left panel , fig.[fig : fv_half ] ) rectangular grid imprint patterns are clearly visible .",
    "they correspond to very small perturbations at this interface when the convectively driven motions at that boundary are not fully established yet .",
    "however , already at @xmath120 any evidence of grid - imposed patterns has vanished .",
    "this time corresponds to the end of the initial transient phase when the radially and spherically averaged rms velocities have a minimum ( fig.[fig : entrained_profiles ] ) .",
    "from this point onward the luminosity - driven convective motions are strong enough to dominate any grid - imposed numerical noise in our simulations .",
    "once the convective motions dominate the flow in the entire constant - entropy shell the patterns at the upper boundary imply large - scale features .",
    "typically two to four coherent patches ( or granules ) can be identified per hemisphere .",
    "these represent areas in which fluids are collectively upwelling .",
    "the situation shown in the lower - right panel in fig.[fig : entrained_profiles ] is representative for later stages ( see also fig.[fig : fv_ring ] ) , which rather tend to show fewer coherent systems and therefore a more global nature of the convection flows .",
    "these global modes have as their limit the global dipole mode reported for non - rotating , fully convective configurations @xcite and are correlated with the aspect ratio @xmath121 of shell convection .",
    "large aspect ratios lead to larger cells , while small aspect ratios have smaller cells . in any case ,",
    "convection cells fill the entire radial extent of the convection zone , and approximately the radial extent determines the horizontal extent .             [ [ aspect - ratio - and - geometry - of - simulation - domain ] ] aspect ratio and geometry of simulation domain + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    shell - flash convection typically starts out with a small aspect ratio .",
    "this regime is suitable even for plane - parallel simulations @xcite . as the thermo - nuclear runaway proceeds ,",
    "much of the energy released goes into expansion work and lifts the outer layers of the convection zone and above leading to an increasing aspect ratio .",
    "stellar evolution models suggest that the energy release from ingested hydrogen may induce a further dramatic expansion of the convection zone and increase of the aspect ratio . for large aspect ratios geometric properties of the simulation domain",
    "become important .",
    "we would expect that entrainment processes be driven by the velocity field at the upper convective boundary , which depends on the realistic simulation of the large - scale cells .",
    "in this situation a 3-d 4@xmath122 simulation domain is therefore likely to give the most realistic representation of convection flows and therefore entrainment .",
    "[ [ scales - and - turbulence ] ] scales and turbulence + + + + + + + + + + + + + + + + + + + + +    images of the abundance distribution clearly show the large - scale nature of convectively - driven entrainment shear flows at the upper convective boundary ( bottom - right panel , fig.[fig : fv_half ] ) and the subsequent downward advection in coherent cloud systems ( fig.[fig : fv_ring ] ) . the picture of convective cells , however , has limits .",
    "the downward directed h - rich plumes are highly turbulent and have significant substructure .",
    "this is supported by the vorticity visualization ( fig.[fig : vort_480 ] ) , which shows that the convection zone is highly turbulent throughout , and that the large - scale features that can be identified in the mixing images ( fig.[fig : fv_ring ] ) carry along with them a full range of smaller - scale motions .",
    "vorticity , arising from derivatives of the velocity field , accentuates the smallest scales , and therefore , looking at the vorticity alone would make the notion of dominant large - scale structures less assertive .",
    "nevertheless , the largest features are those corresponding to the bulk convective motion from the bottom to the top of the convection zones , and can be identified to span the radial extent of the convection zone ( @xmath123 ) .",
    "the largest turbulent scale can be determined by finding the largest scale at which the direction of the convective large - scale motions can not be identified .",
    "this scale is @xmath124 .     to @xmath125 , for two resolutions .",
    "the dashed vertical lines are placed at the convective boundaries according to the initial setup.,title=\"fig:\",scaledwidth=50.0% ]   to @xmath125 , for two resolutions .",
    "the dashed vertical lines are placed at the convective boundaries according to the initial setup.,title=\"fig:\",scaledwidth=50.0% ]    [ [ the - velocity - field - and - the - lower - convective - boundary ] ] the velocity field and the lower convective boundary + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we return to the discussion of velocities in our simulations .",
    "we follow the simulations for several hundred minutes past the initial transient phase ( see above ) , where the convection time scale is @xmath126 ( fig.[fig : ekmax ] ) . from the spherically and radially averaged rms velocity , we obtain an overall velocity scale for our particular convection setup of @xmath127 to @xmath128 depending on resolution .",
    "the spherically averaged profiles of the rms velocity , as well as the vertical and horizontal components ( fig.[fig : profiles_velocity_averaged ] ) , reveal the dominance of the horizontal over the vertical convective velocities near the convective boundary .",
    "this was described for the upper convection zone in the previous paragraph , but it applies equally to the bottom convection zone for the same reasons . also here",
    "the radial velocities decrease well inside the convective boundaries while the horizontal velocities that are associated with the turn - around of fluid elements peak right above the convective boundaries .     and",
    "@xmath129 ( not averaged in time ) , and just the radial component for @xmath130 , for all four grid size simulations .",
    "the dashed vertical lines are placed at the convective boundaries according to the initial setup.,title=\"fig:\",scaledwidth=50.0% ]   and @xmath129 ( not averaged in time ) , and just the radial component for @xmath130 , for all four grid size simulations .",
    "the dashed vertical lines are placed at the convective boundaries according to the initial setup.,title=\"fig:\",scaledwidth=50.0% ]   and @xmath129 ( not averaged in time ) , and just the radial component for @xmath130 , for all four grid size simulations .",
    "the dashed vertical lines are placed at the convective boundaries according to the initial setup.,title=\"fig:\",scaledwidth=50.0% ]      we noted above the importance of the large - scale motions for the entrainment process .",
    "our simulations show for this setup consistently that large upwelling features occupy a full quadrant or a larger fraction of an entire hemisphere . when these upwelling fluid elements approach the upper boundary they are turning around .",
    "the vertical velocities are decreasing while the horizontal motions increase ( top panels fig.[fig : profiles_velocity_averaged ] ) .",
    "the contniuity equation demands that fluid elements start turning around some distance away from the convection boundary ( which they can not cross in highly efficient convection in the deep stellar interior , cf .",
    "sect.[sec : intro ] ) . thus , the large - scale flows cause convection - induced shear flows at the convective boundary .",
    "the richardson number is @xmath131 where for our case @xmath132 is the horizontal velocity , @xmath133 is the radial coordinate and @xmath134 and @xmath10 have their usual meaning . for shear flows to be unstable against kelvin - helmholtz instabilities it is necessary that @xmath135 @xcite . from a 1d profile",
    "it is not obvious how large the transition region should be assumed to be . in the region of the upper convection boundary a pressure scale height is @xmath136 .",
    "the actual velocities of the shear flows will have a range around the value given by the spherically averaged 1d profile .",
    "therefore , we show in fig.[fig : ri - number ] the richardson number as a function of an assumed shear velocity difference @xmath137 for positions @xmath9 within the region of a pressure scale height below the upper convective boundary at @xmath138 .",
    "we approximate @xmath139 in eq.([eqn : ri ] ) with @xmath140 ( where @xmath9 is the radius ) , @xmath141 with @xmath142 , @xmath143 with @xmath144 .",
    "we also provide the profile of the spherically averaged velocities at time @xmath130 . even taking into account that the local horizontal velocities are fluctuating around the spherical average",
    "the richardson number indicates that the convectively - driven horizontal shear flows are stable against kelvin - helmholtz instabilities .",
    "this is consistent with the flow images of the convective boundary where the horizontal flows take the form of coherent gusts that sweep along over the inside of the large upwelling patches visible at the top convection boundary .",
    "larger patches of such apparently stable and very thin boundary layers can be seen in fig.[fig : fv_compare ] in locations ( here , e.g. the lower left ) where radially upwelling flows first encounter the convective boundary , and then are deflected .",
    "fig.[fig : composite ] shows at the bottom left a sliced view of another kelvin - helmholtz stable part of the horizontal flow . in the region near the center of this image ,",
    "two such horizontal flows directed toward each other meet and are deflected downward .",
    "this is the region where the entrainment of h - rich fluid occurs .",
    "the deflection of the flow downward , away from the top of the convection zone , is akin to the well - known phenomenon of boundary - layer separation .",
    "however , in this instance , we do not have a solid wall , as in engineering flows , but a strongly stable transition layer from one fluid to another .",
    "boundary - layer separation flows are highly non - linear and can not be described by simple relations ( e.g * ? ? ?",
    "quantitative characterizations of such flows do therefore rely entirely on sufficiently resolved simulations or suitable experiments .    in fig.[fig :",
    "boundarykhzoomed ] we see zoomed - in views of the vorticity magnitude in the flow near the top of the convection zone , taken from the larger images in fig.[fig : composite ] . in these zoomed - in views , we indicate with prominent white double arrows the 500 km thickness ( 11 grid cell widths ) of the initial transition region from the fluid of the convection zone to the more buoyant , stably stratified h+he fluid above it . in visualizing the concentration of the h+he fluid in the images at the bottom of fig.[fig : boundarykhzoomed ] , we have used the 10 moments of this variable ( see appendix ) that are updated by the ppb advection scheme to generate 8 octant averages in each grid cell .",
    "this permits the full resolution of the ppb scheme , with its subcell information , to be seen in this double resolution visualization process . for the image of the h+he fluid concentration ,",
    "the white double arrow is thus 22 voxels wide . in both",
    "zoomed - out and zoomed - in views we see that the transition layer at the top of the convection zone is strongly stable to the kelvin - helmholtz instability .",
    "this is due to the great strength of gravity and the rayleigh - taylor stable stratification of this layer .",
    "nevertheless , at the tip of the wedge of turbulent gas that separates the two large convection cells and that serves to deflect their flows downward , we clearly see that kelvin - helmholtz roll - up indeed occurs .    at these locations ,",
    "we no longer have the parallel flow in a single direction assumed in the text - book kelvin - helmholtz stability analysis .",
    "instead we have two colliding flows that must , at these locations , generate vertical motions perpendicular to the transition layer that marks the top of the convection zone , in order to satisfy the continuity equation for this essentially incompressible flow .",
    "a classic series of breaking kelvin - helmholtz waves is formed at each tip of this wedge of relatively stagnant gas between the large convection cells . not only is low - concentration h - rich gas entrained into the gas of this wedge , but also along the shear layer between the wedge and convection cell gases entrainment into the rapidly moving convection cell gas occurs .",
    "this process is perhaps more clearly seen in the zoomed - in views of the concentration of h - rich gas in fig.[fig : boundarykhzoomed ] . in these",
    "zoomed - in images of the h - rich gas concentration , the slice through the domain is 3 times thicker , namely @xmath145 of the domain , and therefore the thickness of the red region in these images of more concentrated h - rich gas is exaggerated slightly by being seen in projection through the transparent region of pure h - rich gas .",
    "these images clearly show the strong decrease in h - rich gas concentration as we go away from the wedge tip and away from the top of the convection zone .",
    "nevertheless , the turbulent eddies in this region bring about mixing , and there is also some small amount of entrainment from the transition layer even well away from the wedge tip . further down , as the horizontal velocity further decreases and the inward radial velocity component further increases , this leads to elongated downward entrainment curtains that carry clouds of material somewhat enriched with the h+he fluid from above down into the convection zone ( fig.[fig : fv_ring ] ) .",
    "the results of our measured amounts of entrainment in our series of runs with increasing grid resolution , given in sect.[sec : entrain_grids ] , indicates that the extent to which we have resolved this process in the highest resolution simulation that is shown in fig.[fig : boundarykhzoomed ] is likely to be sufficient to compute the time and space averaged entrainment rate with reasonable precision .     as a function of distance from the boundary and assumed velocity difference @xmath132 between that distance and the midpoint of the boundary at @xmath146 .",
    "the line with triangle markers shows the spherically averaged profile of the horizontal velocity component . for stratified shear flow that is unstable against kelvin - helmholtz instabilities @xmath147",
    "( see text ) .",
    ", scaledwidth=50.0% ]             as the fluid elements enriched with h+he fluid are dragged down inside the entrainment curtain , horizontal turbulence soon disperses and dilutes the h+he fluid , and its fractional volume falls below the rendering cut - off chosen for the visualization . at that point",
    "the h+he fluid becomes invisible in fig.[fig : fv_ring ] .",
    "the cumulative entrainment evolution is shown by means of spherically averaged abundance profiles in fig.[fig : entrained_profiles ] and by zoomed in views of spherically averaged entropy profiles in fig.[fig : a - top - boundary ] . in fig.[fig : entrained_profiles ] we have transformed the fractional volume , which is the primary quantity to express abundances in the hydrodynamics code , into mass fractions , which are customary in stellar evolution codes . even at the end of the simulation , after 12 convective turn - over times ( 24 convection time scales ) , the abundance profiles show significant variations in the lower part of the convection zone .",
    "these features are also highly variable in time and represent individual clouds of h+he-enriched material to arrive at the still mostly pristine lower part of the convection zone .",
    "we can summarize that the entrainment process in our simulations consists of three closely interacting components .",
    "large - scale convective upwelling motions create fast horizontal flows over big patches of the convective boundary surface .",
    "the horizontal convective flows are initially stable against kelvin - helmholtz instabilities .",
    "however , where such opposing flows meet , the boundary layer separates from the stiff convective boundary and kelvin - helmholtz instabilities are encountered in this highly unstable environment .",
    "finally , the interacting and colliding horizontal gusts lead to coherent downward flows that contain h+he fluid .",
    "therefore , the entrainment process is a combination of the local properties at the convective boundaries and the global properties of the convection that depend on all aspects of the particular situation throughout the convection zone .    )",
    "evolution at the top of the convection zone for the @xmath2 simulation .",
    "logarithm of entropy in the transition layer for the initial setup ( dump 0 ) and subsequent evolution ( labels in minutes simulated time ) .",
    "a line mark is placed every third grid point.,scaledwidth=50.0% ]      an important concern in any multi - dimensional simulation is the dependence of results on the adopted grid resolution . here",
    "we focus on a qualitative discussion of the velocity field and a more quantitative analysis of the entrainment process .",
    "but first we would like to comment on the effect of numcerical viscosity .",
    "[ [ numerical - viscosity ] ] numerical viscosity + + + + + + + + + + + + + + + + + + +    one might expect the numerical viscosity in the simulation to affect the details of the entrainment process . the image shown in fig.[fig : vort_480 ]",
    "has @xmath148 pixels , and the underlying simulation has a @xmath2 grid .",
    "smallest features that can be identified have a scale of @xmath149 , which corresponds to only a few grid zones .",
    "the train of kelvin - helmoltz waves in the boundary - separation layer ( sect.[sec : entrainment ] ) has a typical length of @xmath150 but the width of this feature is only a fraction of that . in fig.[fig : boundarykhzoomed ] we show zoomed - in views of such boundary - separation layers .",
    "the double - arrows indicate @xmath151 , the width of the transition layer over which the mixing fraction of hydrogen - rich gas changes from nearly zero to nearly unity . from these close - up views",
    "we can see that the simulation s @xmath2 grid is resolving vorticity features that are considerably smaller than @xmath41 grid cells .",
    "the double resolution views of the h+he concentration , made possible by the subcell resolution of the ppb advection scheme ( see appendix ) show that still smaller features in the advected concentration can be made out .",
    "this subcell resolution feature of ppb advection can be seen in the simple advection test problem shown in fig.2 in @xcite .",
    "detailed simulations of shear layer instability in isolation , as well as our earlier simulations of this sort of convection - driven shear in small sections of such a flow @xcite indicate that the development of the unstable layer tends to converge when we are able to resolve the largest relevant scales as well as scales of wavelengths smaller by about a factor of three .",
    "this is just a rule of thumb , of course .",
    "only quantitative convergence under grid refinement of a quantity of interest , which in our present investigation is the entrainment rate for the hydrogen - rich gas , can be our guide to the adequacy or inadequacy of our computational grid .",
    "the appearance of resolved swirls on multiple scales in the figure is an indication that our grid may be fine enough , but it is the actual observed convergence of the entrainment rate that is our more reliable guide .",
    "the principal causes of error in the entrainment in our numerical simulation are the limitations imposed by the grid cell size on the smallest resolvable overturning waves that can produce mixing .",
    "the behavior of ppm gas dynamics simulations of such complex , nonlinear , turbulent flows , with and without ppb advection of multifluid volume fractions , has been studied in comparison to matching simulations with navier - stokes viscosity terms added in @xcite and @xcite .",
    "@xcite carefully investigated the numerical viscosity of our ppm gas dynamics scheme and quantified it as consisting of two terms , the effects of each of which tend toward zero as a disturbance wavelength increases .",
    "the effects of physical , navier - stokes viscosity tend toward zero as @xmath152 , where @xmath153 is the disturbance wavelength .",
    "the actual viscosity in the star is smaller than could be represented in our simulation .",
    "instead , it is the numerical viscosity of ppm that is dominant in the simulation .",
    "this numerical viscosity tends to zero as @xmath154 or @xmath155 , depending upon which of our two numerical terms is larger under the particular circumstances . for the numerical viscosity , it is the disturbance wavelength measured in grid cell widths that matters .",
    "when doubling the grid resolution the impact of the numerical viscosity on the flow , as measured by effective reynolds numbers for wavelengths of physical importance , is diminished by a factor of four or a factor of eight , depending upon which of our two terms dominates .",
    "therefore , when our results converge under grid refinement , it must be true that our numerical viscosity no longer matters .",
    "the physical reason why this can happen is that the entrainment due to breaking kelvin - helmholtz waves ( sect.[sec : entrainment ] ) is not a viscous phenomenon .",
    "viscosity determines the wavelengths at which shear instabilities are damped away , but it is the largest wavelengths , largely unaffected by viscous damping , that are chiefly responsible for the entrainment .",
    "these we may hope to capture in a well - resolved simulation . our results in sect.[sec : entrain_grids ] indicate that our finest grid of @xmath2 cells has just marginally captured these important waves accurately .",
    "one could attempt to double the grid resolution once more to lay any doubt on this point to rest , but we have judged that the cost of doing this on present computing equipment makes this more definite demonstration of convergence impractical .    [",
    "[ radial - profiles - of - velocity ] ] radial profiles of velocity + + + + + + + + + + + + + + + + + + + + + + + + + + +    the overall velocity scale , shown for the total rms velocity in fig.[fig : ekmax ] increases somewhat with resolution .",
    "inspection of the separate components of spherically averaged velocities reveals that this difference is mostly in the horizontal velocities that span a range between @xmath156 for the @xmath111 grid and @xmath157 for the highest resolution , while the radial velocities for all resolutions fall in a narrow band between @xmath158 and @xmath159 ( fig.[fig : profiles_velocity_resolution ] ) . the overall difference between horizontal and vertical velocity components is larger for higher resolution .",
    "however , as fig.[fig : profiles_velocity_averaged ] shows , the difference between the horizontal and radial velocity profile shape is larger for lower resolution . in particular",
    ", the @xmath112 grid horizontal velocity profile shows a much more pronounced peak at the lower convective boundary and a significant depression just above the heating zone where the radial velocities have a maximum .",
    "fig.[fig : profiles_velocity_averaged ] also shows that the gradient of the horizontal velocities becomes steeper for the higher resolution runs .",
    "in the upper part of the convection zone the total rms velocity is dominated by the horizontal component .",
    "this steeper horizontal velocity gradient can therefore also be seen in fig.[fig : profiles_velocity_resolution ] at different times . in the inner part of the convection zone the velocities at a given radius",
    "are not always strictly correlated with resolution .",
    "this is partly due to long - term convective breathing modes that are out of phase for the different runs , as well as chaotic fluctuations .",
    "however , near the top boundary , where the horizontal velocity drops sharply , we always found velocity profiles to be strictly ordered by resolution , with the highest velocity and the steepest velocity gradients found for the highest resolution runs .",
    "[ [ entrainment - process - and - rate ] ] entrainment process and rate + + + + + + + + + + + + + + + + + + + + + + + + + + + +    eventually we are interested to study the burning of the entrained h - rich fuel via the @xmath34 reaction and the feedback of energy from that process into the hydrodynamic flow .",
    "the amount of entrainment will determine the time - scale and type of feedback from the energy release of the nuclear burning .",
    "this , in turn , will determine the nucleosynthesis in reactive - convective environments , including the n - capture process in  conditions @xcite .",
    "the entrainment rates will be affected by the hydrodynamic feedback from the ingested h. the entrainment rate and the way in which the entrained h will be advectively distributed throughout the he - shell flash convection zone will determine the properties of the subsequent convective - reactive h - combustion , its feedback into the convective flow and the conditions for nucleosynthesis .",
    "a first test is the visual inspection and comparison of 3-d images of the entrainment process for simulations with different resolutions .",
    "we find no obvious artefacts or differences in scales or patterns when comparing a @xmath112 and @xmath2 simulation ( fig.[fig : fv_compare ] ) . in both cases",
    "the large - scale upwelling flows that turn around at the upper boundary of the convection zone cover large fractions of a hemisphere , just as described in the previous section .",
    "also the scraping horizontal motions associated with boundary - layer separation of converging horizontal flow at the convective boundary are evident in both cases in very similar patterns .",
    "if anything , the interfacial structures and the entrainment curtains have a somewhat smaller scale in the higher resolution case .",
    "this is consistent with the steeper gradient of the horizontal velocity found in the higher resolution runs ( see above ) .    , @xmath160 and @xmath161 minutes .",
    ", title=\"fig:\",scaledwidth=50.0% ] , @xmath160 and @xmath161 minutes . ,",
    "title=\"fig:\",scaledwidth=50.0% ] , @xmath160 and @xmath161 minutes .",
    ", title=\"fig:\",scaledwidth=50.0% ]    we have described above how the entrained h+he fluid is cumulatively filling the convection zone ( fig.[fig : entrained_profiles ] ) . in fig.[fig : profiles_resolution ] we show the spherically averaged fractional volumes is the primary variable to represent concentration of fluid 1 in the ppmstar hydrodynamics code .",
    "it is related to the mass fraction @xmath162 by @xmath163 , where @xmath164 is the density of fluid 1 and @xmath10 is the density . ]",
    "for all four grids at three times . the entrained mass can be determined from these spherically averaged abundance profiles by integrating over the convection zone .",
    "the profiles already reveal that the entrained mass is similar in the two highest resolution runs , and that the lowest grid case ( @xmath111 ) has at all times a significantly larger entrained mass .",
    "this pattern prevails through all times , which is evident from the animation view of these profiles available at http://www.lcse.umn.edu/3dstar-convection-entrainment .",
    "the profiles , especially in the animated presentation , are perhaps the strongest indication of convergence of the entrainment rate in our simulations .",
    "we can attempt to summarize this finding in the following way .     and",
    "@xmath165 , as a function of time .",
    "simulations for different grid sized @xmath91 are shown .",
    "the number of grid points @xmath92 in one direction is shown in the legend.,scaledwidth=50.0% ]    the entrainment rate is just the amount of mass of fluid h+he mixed into the convection zone per unit time .",
    "the entrained mass is shown for the four grid choices as a function of time in fig.[fig : entrained_mass ] .",
    "the entrainment rate is therefore the slope of these lines .",
    "fig.[fig : entrained_mass ] is showing in another form the same result as the profile evolution .",
    "with the two smaller grids the entrainment rate is much higher compared to the high - resolution runs . a larger amount of entrained h would lead to a large h - burning luminosity , and this seems to be the case in the simulations presented by ( * ?",
    "3 ) in which the low - resolution run has a 1000 times higher h - burning luminosity compared to the high - resolution case .",
    "the entrainment proceeds in a gusty or intermittent manner , with episodes of larger than average entrainment for periods of @xmath166 to @xmath167 followed by phases of smaller entrainment rates .",
    "the irregular periodicity of the entrainment fluctuation is of the order of @xmath168 . when subtracting the first @xmath169 to @xmath170 which represent the initial transient and the settling into a steady - state convective flow , we are only left with @xmath171 that can be used for the entrainment analysis , since the highest - resolution run ( @xmath2 ) has been computed only to @xmath172 .",
    "therefore , the time averaging of the entrainment rate can be performed only over a small multiple of the typical period over which the entrainment rate fluctuates , which introduces a statistical error in determining the entrainment rates for each grid size .",
    "one of the simulations , the @xmath1 run , has a particularly strong entrainment gust from @xmath173 to @xmath174 preceded and followed by a period of lower than average entrainment . such individual events , and the way in which they are included or excluded in the integration will inevitably introduce some error .",
    "confidence intervals ( see text ) as a function of grid size .",
    "the mean entrainment rates have been fitted with a power law and an exponential according to eq.([eq : exp]).,scaledwidth=50.0% ]    this error is estimated by performing 12 fits of the entrainment rates with different assumptions on the selection of the range of cycles over which a linear least - square fit of the entrained mass as a function of time is performed to determine the entrainment rate , the choice of the weight of the zero - point of the entrainment evolution as well as the upper boundary of the integration ( see discussion at the end of this section ) .",
    "together these 12 cases represent the range of reasonable choices that could be made when integrating the entrained mass , and they represent the sample of measurements on which the measurement error is based .",
    "the resulting entrainment rates are provided in table [ tab : entrain_rate ] and plotted in fig.[fig : entrain_fit ] .",
    "llll @xmath175 & @xmath176&@xmath177&@xmath178 + @xmath179 & @xmath180&@xmath181&@xmath182 + @xmath183 & @xmath184&@xmath185&@xmath186 + @xmath187 & @xmath188&@xmath189&@xmath190 + @xmath191&@xmath192&@xmath193&@xmath194 +    we adopt two simple expressions that represent the non - convergence and the convergence case . if the entrainment rate does not converge for the range of grids adopted here it may follow a power - law @xmath195 as a function of the number of grid points in one direction @xmath196 .",
    "however , if the entrainment does converge , the entrainment rate would instead show signs of approaching an asymptotic limit . in this case",
    ", the dependence of the entrainment rate on the grid may be represented by an exponential plus a constant of the form @xmath197 in that case the constant @xmath198 would represent an estimate of the true entrainment rate based on the assumed functional form of eq.([eq : exp ] ) .",
    "fig.[fig : entrain_fit ] shows both alternatives fitted to the entrainment rate data provided in table[tab : entrain_rate ] .",
    "the data is better represented by the exponential function , and the asymptotic limit approximated by @xmath198 agrees within the adopted uncertainty with the entrainment rate of the @xmath199 simulation , and represents the converged entrainment rate ( for our assumption on the integration boundaries ) .",
    "we repeated the same procedure just with the three lower resolution runs , and find in that case @xmath200 .",
    "this is within the @xmath201 ci of the asymptotic entrainment .",
    "but the fits do not convincingly show convergence by a clear preference for the exponential fit .",
    "however , if we use the knowledge that the simulations do converge we could obtain , for a similar case , a very good result with @xmath202 of the computational cost , which is the fraction of the cost of the three lower resolution runs combined compared to the cost of all runs .",
    "[ [ limitations - of - the - convergence - analysis ] ] limitations of the convergence analysis + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the entrained mass shown in fig.[fig : entrained_mass ] is determined by integrating up to @xmath203 .",
    "this is @xmath204 below the formal convection boundary defined as where in the initial setup the entropy gradient becomes positive .",
    "this choice is necessary to exclude the actual entrainment interface from the integration .",
    "this interface is not resolved sufficiently in the lower - resolution runs . the horizontal velocity profile , for example , depends on the resolution ( fig.[fig : profiles_velocity_resolution ] ) . at the same time",
    "the region nearest to the formal convection zone has the highest abundance of the h+he material from the stable layer , and would therefore dominate the integration of the entrained material . including the boundary layers would therefore rather measure the amount of material present in the @xmath204 or so within the range of the boundary .",
    "we can not show convergence in the way described above for the material in the @xmath204-layer inside the convection boundary .",
    "however , that material will not react with @xmath33  and release energy .",
    "we are therefore not interested whether or not the amount of material in the boundary layer is converged .",
    "instead , we only ask if the material that actually enters the region below this boundary layer , i.e.  below @xmath203 can be quantitatively simulated .",
    "that , indeed , can be accomplished with simulations at the resolutions used here .",
    "the main goals of this paper are to investigate the properties of he - shell flash convection in @xmath0 geometry and determine the entrainment properties of h - rich material at the top of the convection zone .",
    "this entrainment process is the basis of the h - ingestion flash in low - z agb stars and in post - agb stars , and the results of this investigation are the foundation of our future work on this topic ( see * ? ? ? * for preliminary results ) .",
    "the top convection boundary in this he - shell flash convection situation is much stiffer compared to the o - shell burning convection or the core convection investigated by @xcite , as visual comparison of their fig.3 & 10 and our fig.[fig : fv_ring ] immediately reveals .",
    "it is therefore very consistent that their entrainment rates for o shell burning ( @xmath205 ) and core convection ( @xmath206 , with a driving luminosity @xmath207 natural ) are much larger compared to our converged entrainment rate of @xmath208 .",
    "there exists a significant range of entrainment rates , even between convection boundaries of different deep stellar interior convection regimes .",
    "he - shell flash convection boundaries with h - ingestion are much stiffer compared to core convection and in turn o shell burning .",
    "large entrainment rates have been reported as well by @xcite based on a single 3-d simulation .    in order to demonstrate that the fidelity of our approach matches the challenge of the problem",
    ", we describe key elements of our method that we will apply in future work .",
    "the key capability that we demand from a simulation is to reproduce the total amount and rate of entrainment of material from above the convection zone into the unstable layer",
    ". it will be this entrainment amount that , through the nuclear reactions between protons and @xmath33 generates energy at a rate that is large enough to alter the global flow properties .",
    "the accretion of unburned material through the upper convection boundary of the he - shell flash convection zone will therefore determine all subsequent h - ingestion flash simulation steps .",
    "our simulations show that , despite the enormously small entrainment rate , the h - rich material that enters the he - shell flash convection zone is advected into the deeper layer in distinct and coherent clouds .",
    "the visual inspection of the fractional volume images demonstrate that these clouds reach the burning layer where protons will react with @xmath33 .",
    "this is an important result , as without our simulations one may have plausibly assumed that strong horizontal turbulence would shred any downward directed h - rich advection . in such a case , a spherically symmetric simulation approach of the h - ingestion flash may have seemed justifiable .",
    "our simulations , however , show significant inhomogeneities in the depth of the convection zone where the @xmath32 reaction would take place . our results therefore provide evidence that global @xmath0 simulations are indeed needed to simulate the h - ingestion flash accurately .",
    "how does the entrainment rate we obtain compare to the h - ingestion flash constraints we already have established for sakurai s object ?",
    "@xcite demonstrated that the anomalous observed abundance distribution could be reproduced in the 1-dimensional multi - zone nucleosynthesis models with a static mixing - length based convective diffusion parameter if an entrainment rate of @xmath209 is assumed .",
    "the hydrodynamic entrainment rate that we have determined is significantly smaller than the nucleosynthesis - constrained entrainment rate .",
    "we may therefore conclude that the hydrodynamic feedback from the nuclear energy release due to h ingestion will lead to enhanced entrainment rates .",
    "@xcite did also find that the neutron flux must be terminated at some point , and speculated that this would be due to the hydrodynamic feedback mechanism induced by the nuclear energy release from the ingested protons .",
    "the ingestion rate of protons that is necessary to cause significant flow variations to the convective velocity field established by the underlying he - burning luminosity can be estimated by noticing that for this to happen the luminosity from @xmath32 reactions must equal or exceed the he - burning luminosity @xmath210 .",
    "this is the case if @xmath211 where @xmath212 is the mass of the proton and @xmath213 is the energy released in each @xmath34 reaction .",
    "our entrainment rate is significantly lower than this limit , and we therefore do not expect an immediate and dramatic effect of the burning of the ingested protons .",
    "in fact , one may wonder how any relevant hydrodynamic feedback can arise with such a low entrainment rate .",
    "as we will demonstrate in detail in a forthcoming publication h - ingestion entrainment simulations for sakurai s object with energy feedback from h ingestion taken into account show a long quiescent phase of entrainment and nuclear burning initially without noticeable effect on the hydrodynamic flow pattern , followed eventually by violent and non - spherical eruptions that significantly elevate the entrainment rate .",
    "the details of these events will be reported elsewhere .",
    "a key property of the convective boundary layer is the entropy profile immediately above the schwarzschild boundary . in fig.[fig : a - top - boundary ] we observe a self - similar evolving entropy profile .",
    "thus , the numerical method is able after a short while to establish an entropy profile that does not appreciably change shape as it translates in response to the entrainment .",
    "we give evidence that the entrainment rate is a quantitative simulation property that shows convergence .",
    "however , some other quantities can not be considered to be converged .",
    "it seems that the spherically averaged radial velocity components are rather similar for all resolutions , while the horizontal velocity components still show some dependence on resolution .",
    "depending on how the horizontal component is averaged , we roughly estimate that horizontal velocity components may differ by @xmath214 between our runs with lowest vs.  the highest resolution .",
    "although it would be desirable to get rid of these differences as well , one should keep in mind that the modeling uncertainties introduced by the traditional 1-d spherically symmetric simulation approach based on the mlt and some convective boundary mixing algorithm have been shown to be much larger and even qualitative in some instances , as demonstrated via a nucleosynthesis - based validation analysis by @xcite .",
    "the fact that there are aspects of the simulations that are not fully converged is interesting but not important , as long as we can show that convergence is or can be obtained for those quantities that do matter . in our case",
    "this is the entrainment rate .",
    "based on this result , we may now move ahead and include the nuclear burn of h with @xmath33  and the associated energy release .",
    "prw acknowledges support from contracts from the los alamos ( lanl ) and sandia national laboratories and nsf prac grant oci-0832618 .",
    "the development of the ppb scheme for multifluid fractional volume advection was supported by prw s lanl contract and doe grant defg02 - 03er25569 .",
    "fh acknowledges nserc discovery grant funding .",
    "the hydrodynamics simulations were performed on the lcse workstation cluster , supported by nsf cri grant cns-0708822 , on nsf s kraken supercomputer at the national institute for computational sciences ( nics ) , on the itasca machine at the minnesota supercomputing institute ( msi ) , and the canadian westgrid lattice and orcinus high - performance computers .",
    "our simulation code for the hydrogen ingestion flash is based on the piecewise - parabolic method ( ppm * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "we use a version of this numerical scheme that has been modified in a few minor , yet substantive , ways over the years .",
    "it is described in complete detail in @xcite , and the effective numerical viscosity of ppm has been quantitatively characterized by @xcite .",
    "the most relevant modification of this scheme from the present perspective is that in the interpolation process that determines the parabolae we use to describe the subcell structure , monotonicity constraints are applied only if the local behavior of the function to be interpolated is judged not to be sufficiently smooth .",
    "a measure of function smoothness is constructed that has a 5-cell stencil in the direction of the present 1-d pass . in our low - mach - number flows",
    ", we do not expect to find shocks , so that we expect the flow to be smooth under most conditions . in this case",
    ", we do not expect the elaborate interpolation of the values of the function at each of the two interfaces of the cell with its nearest neighbors in the direction of the 1-d pass to be modified in any way by monotonicity constraints .",
    "these cell interface values are interpolated by evaluating at these points the unique cubic polynomials that assume the prescribed cell averages in the 2 grid cells to the left and the 2 to the right of the interface in question .",
    "these interface values are therefore one full formal order more accurate than the parabola used to describe the distribution of the interpolated variable inside the grid cell .",
    "that parabola , when not modified by monotonicity constraints , passes through the two cell interface values and has the prescribed cell - averaged value . to find the amount of this variable that is advected across an interface of the grid cell",
    ", we use this parabola in the upstream cell . for low mach number flows",
    ", only a thin sliver of the cell is advected across the interface .",
    "therefore the average value of the interpolated variable within this sliver is nearly equal to the value of the variable at the interface .",
    "because this value is one order more accurate than the parabola as a whole , the ppm scheme in low mach number flow regimes has the very important property that it becomes more accurate as the mach number , and hence the courant number , is decreased .",
    "even though more time steps are then required to arrive at a given time level , the higher formal accuracy completely offsets the loss in accuracy that we would have expected at low courant numbers .",
    "this behavior is counter to the behavior of most numerical schemes .",
    "it is a feature of ppm that is a result of its history .",
    "ppm was developed from an earlier , more accurate numerical scheme in which the cell interface values were stored and updated as primary data for the method .",
    "because this data structure was incompatible with large production codes at the lawrence livermore national lab in the late 1970s , the ppm scheme was designed as a replacement .",
    "it generated the previously independent cell interface data by interpolation from the cell averages .",
    "to retain as much of the earlier method s accuracy as possible , this interpolation of cell interface values was made as accurate as seemed practical or necessary at the time .    in our stellar hydrodynamic flows , we are concerned that structure in the flow with a characteristic scale size of 20 to 40 grid cells can be advected in our circulating convection zone for , say , 100 scale lengths with minimal amplitude damping and acceptable phase error .",
    "we can assess this capability using 1-d advection of a sine wave of 40 cells . using a courant number of 0.03125 , advecting this sine wave for 100 wavelengths with our ppm scheme , we find that the wave amplitude is damped by a factor of 0.9985 , while the final phase is off by 0.078 cell widths , which is just 1 part in 50,000 .",
    "a more stringent test is to advect a gaussian pulse with a full width at half maximum of 10 grid cells a distance of 100 times this width , or 1000 cell widths , with a courant number of 0.03125 . doing this results in a pulse with height damped by a factor of 0.9383 and with a phase error of just 0.723 grid cell widths , which is just 1 part in 1384 .",
    "the behavior of the scheme with a courant number of 1/3 has slightly greater amplitude error but less phase error . running the same sine wave and gaussian advection tests at this courant number , we find amplitude damping by factors of 0.9923 and 0.9320 with phase errors of 0.02 and 0.234 grid cell widths .",
    "it should therefore be clear that with ppm advection we suffer very little accuracy loss in going from the typical range of courant numbers encountered in explicit gas dynamics simulations to those we encounter in our present simulations of the hydrogen ingestion flash .",
    "our multifluid ppm code uses the much more accurate piecewise - parabolic boltzmann ( ppb , described below ) scheme to advect the critically important cell volume fraction occupied by the hydrogen - rich fluid , which is located initially just above the top boundary of the helium shell flash convection zone . for comparison with ppm , ppb running the same advection experiments just mentioned at a courant number of 0.03125 for the same sine wave and gaussian produces damping by factors of 0.999937 and 0.99961 with phase errors of 0.938 and 0.02 cell widths .",
    "the ppb phase error may seem large until one realizes that , as discussed in @xcite , ppb incurs one - time errors related to going over to the piecewise - parabolic representation , after which there is extremely little error accumulation . consequently , advecting the same sine wave at the same small courant number for an additional 100 wavelengths causes the phase error to increase from 0.938 cell widths after 100 wavelengths to only 1.066 cell widths after a second 100 wavelengths . as a general rule of thumb , ppb",
    "advection is about as accurate as ppm advection if ppm is given 3 times more grid cells ( and 3 times more time steps ) to work with .",
    "this is because , in 1-d , ppb has 3 times as much independent information on any given grid .",
    "ppb advection has fifth - order formal accuracy @xcite , while ppm advection is only third - order accurate .",
    "nevertheless , our rule of thumb holds for practical problems , since we are then essentially never in the range of grid resolutions where strict formal convergence rates hold . for the advection of sharp jumps",
    ", ppb can not yield a thinner numerical representation of the jump than ppm , with its contact discontinuity detection and steepening , because ppm s representation is the thinnest possible when parabolae are used for the subgrid structures .",
    "nevertheless , ppb advection is still superior even in this case , because ppb generates far fewer numerical glitches in rare pathological circumstances .",
    "once again , this result is due to ppb having much more independent data to work with .",
    "ppb achieves its very high accuracy by conserving to machine accuracy the 10 lower - order moments ",
    "@xmath215 , @xmath216 , @xmath217 , @xmath218 , @xmath219 , @xmath220 , @xmath221 , @xmath222 , @xmath223 , @xmath224  of the fractional volume , @xmath225 , of a tracked fluid within a local volume element .",
    "we define these moments with respect to a set of cartesian coordinates , @xmath226 , @xmath227 , and @xmath228 , centered on the grid cell of interest , aligned with our grid directions , and for which the width of the cell in each dimension is unity .",
    "using these cell - centered coordinates , we define the moments as : @xmath229    our use of the cell - centered and normalized coordinates restricts us to the use of cubical grid cells .",
    "however , given the proliferation of adaptive mesh refinement ( amr ) techniques , we view this restriction as entirely acceptable for all practical calculations . for our work with stars ,",
    "cubical grid cells provide the least distortion of the underlying flow geometry that is possible with a cartesian mesh .",
    "the centered and normalized coordinates give us a tremendous advantage ; they allow us to perform our calculations at double speed in 32-bit precision . on the very fine grids permitted by the tremendous power of today s computing systems ( we have run problems related to inertial confinement fusion on over one trillion grid cells * ? ? ?",
    "* ) , it can easily consume 4 digits of precision just for a grid cell to know where it is located in a global sense . injecting this global location through moments of _",
    "x _ , _ y _ , and _ z _ in place of @xmath226 , @xmath227 , and @xmath228 is simply wasteful .",
    "it forces the machine to do twice as much work for no good reason , since the global location of a grid cell is irrelevant in specifying the distribution of a variable within it .",
    "one might ask if the fifth - order formal accuracy of the scheme , to whatever extent it really matters in a practical computation , is preserved in 32-bit precision .",
    "our experience indicates that it is , with the single exception of the ibm cell processor , which did not perform rounding in its 32-bit arithmetic .",
    "our ppm scheme is directionally split .",
    "we update the flow for each time step in three 1-d passes , using a symmetrized sequence _",
    "xyzzyx _ in each time step pair .",
    "we therefore require a directionally split version of the ppb advection scheme .",
    "this delivers an immense simplification .",
    "the ppb scheme is built upon van leer s scheme vi @xcite , which is a 1-d scheme with no monotonicity or other constraints . in the early 1980s ,",
    "this scheme was made into a 2-d , directionally split , and constrained scheme , described in @xcite .",
    "the version of ppb that we use in our work is simplified from this early work , with a minimal set of moments and a simplified method of updating them , described below .",
    "it is also enhanced by a more elaborate and useful method of constraining each 1-d pass of the algorithm .",
    "this scheme has only been described in detail in internal reports @xcite and in broad terms @xcite to this date .",
    "a code module containing this ppb scheme for 3-d computation was delivered to the los alamos xrage code in 2004 , and this module , combined with our version of ppm , was included in the official 2005 release of the los alamos xrage code . here",
    "we give a complete , but brief , description of the ppb advection scheme , adapted for use in the advection of a fluid concentration , so that _ f _ is forced to remain within the range of values from 0 to 1 . a more voluminous description",
    "can be found in the lcse internal report @xcite .",
    "the antecedents of this ppb scheme go back to the 1970s and 1980s , and woodward has taught it in his course on numerical methods at the university of minnesota in the late 1980s and 1990s .",
    "a parallel development of numerical schemes , beginning around the same time as the work of van leer but in the finite element community , has been given the name discontinuous galerkin ( cf .",
    "recent books , * ? ? ?",
    "* ; * ? ? ?",
    "these schemes are similar , but they involve more computational labor as a result of their use of runge kutta techniques .",
    "they also apply the methodology over the full set of hydrodynamical equations , although there is little evidence of which we are aware that this yields any significant benefit for flows in which shocks and contact discontinuities are involved , so that the very high formal order of these techniques might be justified . here",
    "we apply a simpler form stemming from van leer s original work @xcite , and we cut to the bone the computational labor involved .",
    "we also apply an elaborate set of constraints that address the special problem of multifluid flow . despite the complexity of these constraints",
    ", our formulation in 1-d passes allows us to apply these constraints only to the 3 moments @xmath215 , @xmath230 , and @xmath231 , where _ x _ is the direction of our 1-d pass .",
    "this delivers an enormous simplification of the scheme , to the extent that it now involves only about 3 times the computational labor of the much less accurate ppm advection scheme .",
    "we can use the 10 moments of _ f _ to construct a quadratic polynomial describing the subgrid behavior of _ f _ within a grid cell : @xmath232 where : @xmath233 from this single polynomial , we can construct the following separate functions of @xmath226 : @xmath234 in a 1-d pass , we perform separate advection operations on the above functions of @xmath226 . only the first of these 6 functions , @xmath235 , requires the application of any constraints .",
    "the other 5 functions can be advected without concern for constraints , because the results will be constrained in later 1-d passes in the @xmath227 and @xmath228 directions .",
    "we will discuss the constraints last , and first give the formulae for updating the 10 moments of _ f _ in the cell during an _ x_-pass .",
    "we begin with the most difficult formulae , which result from the advection of @xmath235 .",
    "once we see how to advect @xmath235 , all the remaining functions will be trivial by comparison , although a slight complication results from the dependence of @xmath236 and @xmath237 upon @xmath238 .",
    "a further complication arises from changes in volume of the grid cells during the time step .",
    "conceptually , we draw each of our 6 functions of @xmath226 in the grid cells according to the values of the coefficients in their polynomial representations given above",
    ". then we demand that the value of each function at a particular point must remain unchanged as that point moves with its time - averaged velocity in _ x _ over the time step .",
    "this construction is illustrated for @xmath235 in the left panel of fig.[fig : ppb ] .",
    "finally , we integrate the resulting function segments over the new grid cell volume to obtain the new _ x_-moments for each of our 6 functions , which are then the new 10 low - order moments of _ f _ in the new grid cell .    , for 3 grid cells are shown at the beginning of the x - pass in the upper part of the figure .",
    "the motion of the cell interfaces is indicated , and the new stretched or squashed parabolae are shown in the lower part of the figure .",
    "the two portions of the central cell that become parts of the new central cell and of its neighbor on the right are indicated by the diagonal and cross - hatched shading patterns in both parts of the figure . to obtain the new interpolation parabola for the central cell",
    ", we must evaluate the moment integrals over the cell domain in x , which is indicated by the bracket at the bottom of the figure . _ right panel : _ space - time diagram showing time levels , moving grid trajectories and fluid streamlines , with coordinate and speed values indicated that are used in the evaluation of moment integrals over the advected portions of grid cells , which are marked with brackets.,title=\"fig:\",scaledwidth=45.0% ] , for 3 grid cells are shown at the beginning of the x - pass in the upper part of the figure .",
    "the motion of the cell interfaces is indicated , and the new stretched or squashed parabolae are shown in the lower part of the figure .",
    "the two portions of the central cell that become parts of the new central cell and of its neighbor on the right are indicated by the diagonal and cross - hatched shading patterns in both parts of the figure . to obtain the new interpolation parabola for the central cell",
    ", we must evaluate the moment integrals over the cell domain in x , which is indicated by the bracket at the bottom of the figure . _ right panel : _ space - time diagram showing time levels , moving grid trajectories and fluid streamlines , with coordinate and speed values indicated that are used in the evaluation of moment integrals over the advected portions of grid cells , which are marked with brackets.,title=\"fig:\",scaledwidth=55.0% ]    many applications require a moving ( radially collapsing or expanding ) eulerian grid , such as the rapid expansion of the outer convection zone in a h - ingestion flash during the first thermal pulse of a low - z agb star .",
    "although we have not used this feature in the entrainment simulations presented here , it is an integral part of our ppb implementation and we prefer to describe here the general formalism that allows for a co - moving grid , and that will be used in future stellar convection simulations .",
    "the diagram in the right panel of fig.[fig : ppb ] is intended to clarify the coordinates that we use .",
    "each grid cell interface has a constant velocity proportional to its distance from the origin .",
    "this is indicated in the diagram .",
    "our ppm gas dynamics scheme computes the time - averaged velocity , @xmath239 , of the fluid at each moving grid cell interface _",
    "l_. this is indicated in the diagram by the slopes of the fluid streamlines crossing the cell interfaces at the time level half - way through the time step ( subscript `` h '' ) .",
    "we denote the new time level , at the end of the time step , by the subscript `` n. ''    we perform these moment integrals with respect to the new grid cell s own cell - centered and scaled coordinates . to do this",
    ", we relate the new cell s coordinates to those in the old cell . @xmath240\\ /\\",
    "\\delta x_n\\ ] ] here we have used the subscript `` m '' to denote the middle of the cell , so that @xmath241 and @xmath242",
    ". also we denote the difference in the time - averaged fluid velocity across the cell by @xmath243@xmath244 the difference across the cell for the grid velocity is @xmath245 .",
    "we approximate each streamline as having a constant velocity equal to its time average , interpolated linearly in space at the half - time level .",
    "therefore , @xmath246 . after some algebra ,",
    "we write : @xmath247 where @xmath248\\ /\\",
    "\\left[1+\\left(\\delta u_{xg}-\\delta { \\overline{u}}_x/2\\right)\\left(\\delta t/\\delta x\\right)\\right]\\ ] ] and @xmath249 { \\mathrm { \\hspace*{0.1cm}.}}\\ ] ]    in the spirit of conservation laws , we generate fluxes at the interfaces of the grid cells .",
    "extra terms arise , because each cell has its own set of coordinates .",
    "we assume a uniform grid of cells with widths @xmath250 .",
    "thus for streamlines such as those shown in the right panel of fig.[fig : ppb ] that cross grid cell interfaces , we must either add or subtract 1 from the expression for @xmath251 ( eq.[eqn : tildexn ] ) . as stated earlier , this extra complexity is necessary to permit us to use 32-bit arithmetic in the computation .",
    "we now focus our attention on the cell interface _",
    ", which is the left - hand interface of our cell of interest .",
    "the velocity @xmath252 at the cell interface that is _ upstream _ from interface _",
    "l _ is @xmath253 , and the sign of the velocity @xmath239 is @xmath254 .",
    "thus , @xmath255 if @xmath256 , and @xmath257 otherwise . in the cases",
    "@xmath258 , the streamline that reaches the cell interface at the end of the time step begins at @xmath259 .",
    "here we have used the subscript _ lup _ to denote more clearly that @xmath260 is evaluated using the scaled coordinate at the beginning of the time step in the grid cell upstream from interface _",
    "l_. to denote the cell downstream from interface _",
    "l _ we will use the subscript _",
    "ldn_. we run subscripts together in a germanic style , because they translate naturally into suffixes for variable names in a code .",
    "we will need to evaluate moment increments that result from advection of the segments indicated in figure 2 into adjacent cells .",
    "we denote these moment increments by @xmath261 .",
    "these will be integrals over the indicated segments of the upstream cells at the beginning of the time step , but using weight factors corresponding to the new grid cell s scaled coordinates at the new time .",
    "thus : @xmath262 we now recognize that @xmath263 is just @xmath264 and that @xmath265 we define the courant number for the cell interface _",
    "l _ as @xmath266",
    ". we should be careful to advect this same fraction of the upstream cell across the interface when , in the ppm algorithm , computing the fluxes of conserved quantities .",
    "we now write for the moment contributions : @xmath267 it is easy to express these integrals in terms of simpler ones that are more readily evaluated : @xmath268 the @xmath269 , @xmath270 , and @xmath271 are the coefficients of the parabola representing _ f _ as a function of @xmath272 , and the constants @xmath273 can be evaluated recursively via @xmath274 and @xmath275\\ /\\",
    "\\left[k+1\\right]\\ ] ] we may now express the desired moment integrals as follows : @xmath276 in these formulae we take special care to expose a highly efficient strategy for evaluating these quantities in a computer code .",
    "we are evaluating contributions to conservation laws , even though this is somewhat obscured by our use of different coordinates in different cells and at different times . nevertheless , it is easiest to evaluate the moment integrals corresponding to the portions of the fluid that remain in their original cells by instead evaluating total moment integrals over these cells and then subtracting off the advected portions .",
    "we denote these total moment integrals by @xmath277 : @xmath278 these are quite easily evaluated . expressing the results recursively ,",
    "we find : @xmath279 to obtain the contributions to the new moments in this original cell from the fluid that remains there , we need to subtract from the above total moment integrals the portions corresponding to the fluid that is advected into neighboring cells .",
    "these integrals are very closely related to those , @xmath280 , evaluated above .",
    "they only lack the term @xmath281 in the bracket in the integrand that is raised to the _ _ k__@xmath282 power .",
    "thus : @xmath283 because we have done most of the work in evaluating these slightly different integrals already , we find : @xmath284 there are now 4 cases to consider in evaluating the moments in the cells at the new time level : @xmath285 all these computations are easily implemented in 100% vectorized loops making use of vector logic ( the _ cvmgm _ or conditional move hardware instructions ) .",
    "we have now described the most difficult of the 6 advection calculations .",
    "it is easy to see how the moments of the functions @xmath286 and @xmath286 , defined earlier , are computed .",
    "we use the same method that was just described for the function @xmath235 , but we simply drop the highest - order terms . updating the moments of the functions",
    "@xmath287 , @xmath288 , and @xmath289 is simpler still , but we must take care to handle the dependence of the last 2 of these functions on @xmath215 .",
    "we now discuss the very important topic of how we constrain the initial functions that we advect as described above . because we will perform 1-d passes in all 3 grid dimensions ,",
    "there is no need to constrain any of the functions in the _ x_-pass except for @xmath235 .",
    "since van leer introduced the 1-d unconstrained version of this advection scheme in the mid 1970s , we have learned a great deal about constraining interpolation parabolae .",
    "the constraints that were introduced for the ppb scheme @xcite have been augmented and improved over many years of using ppb advection .",
    "the modifications have sought to eliminate the generation of tiny bits of a fluid that can otherwise precede or follow a moving region of a given fluid . the modifications also seek to keep a sharp multifluid interface sharp when it moves perpendicular to itself while letting the interface spread when that is appropriate .",
    "behavior of the numerical representation of the interface between two fluids when that interface is physically unstable is particularly important .",
    "this is a delicate business , and that is why the algorithm described below is complex .",
    "constraints that we apply take two general forms . the first , and the simplest , is blending with @xmath235 a fraction of the constant function @xmath290 ,",
    "so that an extremum of the composite function that was negative or exceeded unity before this blending operation just attains the value 0 or 1 after blending .",
    "we never blend in the constant function @xmath291 for any other reason or in any other circumstances .",
    "this is very important .",
    "the ppb advection scheme is so accurate that any degradation arising from tampering with the functions it advects can be devastating , removing essentially all benefit of its elaborate advection computation .",
    "therefore we only blend in constant functions in order to remove unphysical implied values inside a grid cell . because we use ppb to advect multifluid concentrations , values outside the interval from 0 to 1",
    "must be eliminated . however , blending in portions of the constant function is not the only way , and is often not the best way , to enforce the specialness of the values 0 and 1 .",
    "nevertheless , if @xmath291 is negative or exceeds unity , we must set the function @xmath235 to a constant at either the value 0 or 1 as appropriate .",
    "this is the first constraint that we apply , and we can see no alternative to it .",
    "second , we reset edge values that lie outside the allowed range from 0 to 1 ( 0.000002 to 0.999998 when using 32-bit arithmetic ) , and we mark cells where we have done this .",
    "we also reset the edge values to 0 or 1 if in the cell right across this cell interface we have pure fluid , with @xmath215 equal to 0 or 1 , and we mark these cells along with the previous set . we need to keep track of these marked cells , because in these cells and these cells only we will constrain the implied parabolae in the cells so that they do not assume minimum or maximum values within the cell . a difficulty in treating cells adjacent to pure fluid regions arises from the scheme s tendency to insert in such cells interpolation parabolae that have extrema in those cells .",
    "even if we flatten these parabolae to the point that these extrema are constrained to lie in the allowed range of values , we will have directly adjacent to the pure fluid region a tiny pocket of ever so slightly mixed fluid .",
    "when this tiny pocket translates , the ppb scheme can begin to treat it with an interpolation parabola having a permitted extremum within the cell .",
    "in such an event , the little pocket of mixed fluid will be preserved , which is an undesired behavior .",
    "we therefore wish to detect such cells and force the scheme to use monotone interpolation parabolae in them for which , if possible , the edge value adjacent to the pure fluid region is unity or zero",
    ". our detection must be very carefully done , or else we will mistakenly find such cells all over the grid , apply monotone interpolations in them , and destroy the resolving power of the ppb scheme . ideally , we would like the scheme to treat physical diffusion of edges properly , while still keeping non - diffusing edges sharp .",
    "this implies that we would like the scheme to sense the difference between physical and numerical diffusion , allowing the former and disallowing the latter .",
    "this is a tall order .",
    "we will assume that edges , as opposed to truly smooth transitions , are sharper than the gaussian curve in their approach to either special value 0 or 1 .",
    "this is a property that we can successfully detect .",
    "we test this by demanding that our constraints do not introduce sharp jumps artificially into a gaussian pulse of height unity and with full width at half maximum that is 25% of a periodic domain resolved by between 9 and 27 grid cells when this gaussian is advected for 100 transits of this periodic domain at a courant number of 0.15 or more .",
    "this is not an empty requirement .",
    "the ppm advection scheme , with its contact discontinuity and steepening feature enabled , will turn such a gaussian pulse into a square wave under these circumstances .",
    "higher grid resolution than this ( 6 cells across the pulse at half maximum ) is needed to distinguish the gaussian from a square wave using ppm .",
    "disabling the discontinuity detection and steepening in ppm leaves the gaussian a gaussian , but diminishes its amplitude substantially at low grid resolutions .",
    "ppb advection , with the constraints laid out below , easily distinguishes gaussians from square waves , and vice versa , and performs the appropriate interpolations for each .",
    "ppb needs only as few as 6 cells across a square wave pulse to preserve its full amplitude while advecting it 400 times its width .",
    "square waves with widths of only 2 or 3 cells are turned into gaussian - type pulses by the ppb scheme .",
    "this seems a more benign behavior than performing the reverse metamorphosis , so long as the pulse amplitude is adequately maintained . for ppb",
    "this is the case , due to its subcell resolution provided through its moment data . in marginal cases ,",
    "where grid resolution is insufficient , we are forced to make a choice between square and gaussian - type pulse shapes .",
    "our constraints will choose the square pulse shape in cases that can not be clearly decided from the data provided , but the subcell information ppb maintains allows us to apply such arbitrary decisions exclusively on very highly under - resolved signals .",
    "also , we arbitrarily favor sharp interpolated features only when we have transitions to one of the special function values of 0 or 1 .",
    "the design of our constraints below therefore means that an interface that is originally sharp will remain so unless sufficiently strong physical diffusion is applied in a single time step .",
    "we assume that this is a desired behavior .",
    "originally smooth multifluid interface transitions will become sharp only if they are stretched in the dimensions parallel to the transition surface , so that liouville s theorem implies that the transition region must become thinner .",
    "this , we believe , is also a highly desirable behavior .",
    "we note that our experience with many multifluid applications of the ppb advection scheme indicates that very few numerical glitches arise from the scheme s switching between constrained and unconstrained behaviors ( cf .",
    "* ; * ? ? ?",
    "* ) , since this occurs only when the multifluid interfaces involved have numerical representations of about 3 cells in thickness or less .",
    "we will perform our testing and resetting of the left and right interface values , @xmath292 and @xmath293 , in a given cell according to the following logical tree . note that because this resetting of both values causes a monotone interpolation parabola to result , we can avoid unnecessary later work in these cells by flagging them as already handled . using subscripts _ zl _ and _ zr _ to denote the zone ( or grid cell ) to the left or right of the cell of interest , we execute the following logical tree : @xmath294    we now locate cells containing extrema . at this point in our sequence of operations , we are working with the 3 quantities @xmath292 , @xmath293 , and @xmath215 , which together are sufficient to define our interpolation parabola .",
    "we now compute the coefficients , @xmath295 , @xmath296 and @xmath297 , of the interpolation parabola s terms in @xmath298 , @xmath299 , and @xmath300 : @xmath301 it is easily shown that we must have a minimum inside the cell if @xmath302 , and that we must have a maximum inside the cell if @xmath303 .",
    "such an extremum must occur at @xmath304 , where the parabola assumes the value",
    "@xmath305 { \\mathrm { \\hspace*{0.1cm}.}}\\ ] ] the reduction factor that we apply to @xmath296 and @xmath297 in these cells in order to bring @xmath306 to the desired , allowed value @xmath307 is then @xmath308\\right ) { \\mathrm { \\hspace*{0.1cm}.}}\\ ] ] we can make this process of testing computationally efficient , avoiding unnecessary divisions and evaluations by first computing only @xmath296 and @xmath297 from our values of @xmath292 and @xmath293 , and testing and resetting according to the following : @xmath309 the reduction factor @xmath310 is applied to @xmath296 and @xmath297 only in these cells .",
    "we can see that we do not actually need to evaluate the coefficient @xmath295 .",
    "we note that in the set of cells that we have already marked for the application later of constraints forcing the parabolae within these cells to be monotone , we must take care to assure that @xmath310 is set to unity . for these cells",
    ", we will keep @xmath225 inside the range from 0 to 1 in a different fashion .",
    "the idea here is that we reduce the magnitudes of @xmath296 and @xmath297 together , flattening the interpolation parabola , in cases where our grid cell is likely to be located in between regions where @xmath225 is either 0 or 1",
    ". then we are likely to have in our cell a segment of a thin , unresolved strip in which the distribution @xmath225 is either 1 or 0 ( respectively ) .",
    "it is entirely appropriate to describe this unresolved strip segment using a parabola that has an extremum inside our grid cell",
    ". we must however be careful not to let the extreme value poke outside of our allowable range .",
    "if , however , we have reset either edge value to one of our limiting allowable values , that is , to either 0 or 1 , then we expect that our cell is located next to a region in which the distribution @xmath225 is either 0 or 1 ( respectively ) . in this case",
    ", it would be inappropriate to simply flatten our interpolation parabola , which would cause the value at the cell edge to move away from the limiting value shared by the region adjacent to it . instead",
    ", we would like to keep the edge value at this limit , if that is possible .    in order to prevent the generation of inappropriate subcell extrema in cells located next to regions of roughly constant @xmath225 where this constant value is neither 0 nor 1",
    ", we will additionally demand that @xmath310 be set to unity unless the cell average , @xmath215 , is an extremum relative to those on the left and right , @xmath311 and @xmath312 , or the inferred extremum within the grid cell was within the allowable range . here again the subscripts _ zl _ and _ zr _ signify `` zone on the left '' and `` zone on the right . ''",
    "thus we demand that : @xmath313 we add cells reset in this way and where @xmath310 had previously been set to a value less than unity to the cells we have been marking as candidates for the application of ppm - style constraints that force the parabolae within these cells to be monotone .",
    "we may now safely apply the factor @xmath310 to the present values of @xmath296 and @xmath297 .",
    "we will not need to evaluate @xmath295 .",
    "finally , we apply the constraint that the parabolae in cells that we have been marking must be monotone inside those cells .",
    "since our constraint procedures are so complicated , it is worthwhile at this point to remember which cells are now marked .",
    "first , all cells for which an implied edge value , either @xmath292 or @xmath293 , was outside the allowable range and which , after these edge values were reset , had extrema inside the cell have been marked .",
    "second , all cells with internal extrema outside the allowable range and for which the cell averages are not corresponding extrema relative to the cell averages in neighboring cells have been marked .",
    "thus in all marked cells , the parabola describing the subcell structure is not monotone , but we will demand that it be monotone . in the marked cells ,",
    "we therefore apply : @xmath314 at the end of this resetting procedure , we recompute the moments of the distribution via : @xmath315 with this final operation , the application of our constraints is complete .    one may compare the above ppb advection scheme with multiple other variants of the scheme as well as with variations on ppm advection in both 1-d and 2-d by experimenting with the ms windows applications provided on the lcse web site at http://www.lcse.umn.edu/two-stream-test , http://www.lcse.umn.edu/gas1d , and http://www.lcse.umn.edu/windtunnel .",
    "these web urls contain example applications , executable on any windows pc , that were generated in support of courses taught in the 1990s .",
    "the first solves a 1-d gravitational two - stream instability problem in a 2-d phase space .",
    "multiple variations on ppb , several more accurate than the version we have described above and that we have used for the last several years , are enabled in this windows program .",
    "the behavior of ppb can be compared with that of ppm , in multiple flavors , as well as a high - order runge - kutta advection scheme used in meteorological codes .",
    "the gas1d and windtunnel urls host windows applications that combine ppb multifluid fractional volume advection with ppm gas dynamics in much the way that they are combined in our present codes .",
    "the windtunnel code performs a multifluid variation on the classic 2-d wind tunnel test problem @xcite .",
    "we do not guarantee that these downloadable applications will work on any pc , although they might , nor that we will maintain them forever , nor that we will answer inquiries concerning them .",
    "we also assert that one downloads these applications at his or her own risk , and they are provided `` as is . '' nevertheless",
    ", they do now work for us , and they are both instructive and fun to experiment with",
    ". examples of the use of our ppb scheme for large - scale multifluid gas dynamics simulations with the ppm code can be found in @xcite .",
    "once we have computed the time - and - space averaged velocities at the grid cell interfaces using our version of ppm , we perform the ppb advection computation to obtain the new values of the 10 moments of @xmath225 without reference to the values of any other variables .",
    "this computation gives us advected volumes of the two fluids , but not advected masses .",
    "we obtain from ppb volumes of the two gases within the cells _ at the beginning of the time step _ that cross the cell interfaces into neighboring cells . to convert these advected volumes into advected masses , needed for strict mass conservation",
    ", we must introduce interpolations of the individual fluid densities as functions of cell volume coordinates at the beginning of the time step .",
    "we find these interpolation parabolae using our standard ppm procedure .    here",
    "we invoke an important assumption .",
    "we assume strict pressure and temperature equilibrium inside each cell .",
    "this implies that the two fluids must have at each point in the cell a ratio of their densities that is given by that of their mean molecular weights  which we assume is constant over the entire duration of the problem . in our hydrogen ingestion flash simulations",
    "@xcite , we take this ratio to be @xmath316",
    ". the pressure and temperature equilibrium assumption permits us to derive the individual densities of the two fluids given only the averaged density of the mixture plus the mixing fraction , @xmath225 .",
    "this is a huge simplification , because we need not store densities and internal energies for each fluid .",
    "when we interpolate a parabola to represent the variation of the density of one of the fluids across a cell , this implies such a parabola for the other fluid .",
    "together with our moments for the distribution of the mixing fraction , @xmath225 , we can derive the implied distribution of density for the mixture . because careful interpolation is very expensive , this represents a great saving in computational labor .",
    "there is still another advantage .",
    "our equilibrium assumption means that even in a cell containing no gas of one type , a reasonable average density for that gas is implied .",
    "consequently , we have no need to interpolate gas density across a discontinuity at a multifluid boundary : the density of each gas is well - behaved across such a boundary .",
    "it is instead the mixing fraction , _ f _ , that jumps suddenly across this boundary .",
    "however , we have for _ f _ our very much more accurate ppb description , with its 10 moments in each cell .",
    "this allows , as a practical matter , a smooth description of _ f _ across a multifluid boundary that is only about 2 grid cells thick .",
    "this representation is prevented from becoming too sharp , which would introduce numerical oscillations or glitches , because it is forced to consist of a parabola extending all the way across each grid cell .",
    "our interpolated distribution of _ f _ is therefore very sharp  only a couple of grid cells in thickness  and at the same time very smooth , because it is defined by parabolae in these cells that are determined by subcell information that is operationally equivalent , as a rule of thumb , to a two- or three - fold grid refinement for ppm ( cf .",
    "* ) for just this single , all - important variable .    in slow - flow , rayleigh - taylor instability problems ( cf",
    "* ; * ? ? ?",
    "* ) , we find that the elaborate approach of the ppb scheme is sufficient to essentially eliminate the appearance of certain bad behaviors familiar to us from the ppm advection scheme when applied to multifluid problems ( cf .  for example * ? ? ?",
    "* ; * ? ? ?",
    "ppb advection , with its formal fifth - order accuracy , is capable of moving multifluid interfaces with very detailed structure great distances through the mesh with no noticeable diffusion .",
    "this behavior is possible , because ppb consistently treats the internal structure of the multifluid interface transition from 0 to 1 in the mixing fraction , _ f _ , as a smooth transition . unlike ppm advection",
    ", it does not switch between fundamentally different interpolation strategies dynamically .",
    "switching strategies in this way can cause ppm to introduce small glitches , which can later become amplified by a physical instability to form large glitches .",
    "we have been using multifluid ppm+ppb for rayleigh - taylor problems in the weakly compressible regime since 2004 , and find it very much superior to ppm alone for these problems , as the results reported in @xcite attest .",
    "@xcite reported similar experience with high - order advection and rayleigh - taylor problems using their castro code .",
    "this experience , we find , does not carry over to the much more violent inertial confinement fusion problems considered in @xcite .",
    "this can be seen in 2-d for both our code and for castro in code comparison work @xcite .",
    "we find that the interaction of strong shocks , as they are handled in ppm , with our very carefully treated multifluid interfaces produce familiar sorts of glitches , whose causes were explained decades ago @xcite .",
    "these issues are addressed and largely resolved by @xcite , which also describes our multifluid ppm code s highly scalable parallel implementation in some detail .                                                              , f. , freytag , b. , fuchs , t. , et  al .",
    "2007 , in astronomical society of the pacific conference series , vol .",
    "378 , why galaxies care about agb stars : their importance as actors and probes , ed",
    ". f.  kerschbaum , c.  charbonnel , & r.  f. wing , 43                                                              , d.  h. , woodward , p.  r. , & jacobs , m.  l. 2000 , in new york academy sciences annals , vol .",
    "898 , astrophysical turbulence and convection , ed .",
    "j.  r. buchler & h.  kandrup , 1+ , online at http://www.lcse.umn.edu/convsph                                            woodward , p.  r. 2005 , ppb : the piecewise - parabolic boltzmann scheme for moment - conserving advection in 2 and 3 dimensions , lcse internal report , university of minnesota , available at http://www.lcse.umn.edu/ppbdocs    , p.  r. 2006 , in implicit large eddy simulation , computing turbulent fluid dynamics , ed .",
    "l.  m. f.  grinstein & w.  rider , cambridge university press , available at http://www.lcse.umn.edu/iles/ppm-for-iles-turb-appls-2-26-05-cup6a-10.pdf        woodward , p.  r. , porter , d.  h. , dai , w. , et  al .",
    "2010 , the piecewise - parabolic boltzmann advection scheme ( ppb ) applied to multifluid hydrodynamics , los alamos natl . lab .",
    "report la - ur 10 - 01823 , available at http://www.lcse.umn.edu/ppmplusppb"
  ],
  "abstract_text": [
    "<S> we present the first 3-dimensional , fully compressible gas - dynamics simulations in @xmath0 geometry of he - shell flash convection with proton - rich fuel entrainment at the upper boundary . </S>",
    "<S> this work is motivated by the insufficiently understood observed consequences of the h - ingestion flash in post - agb stars ( sakurai s object ) and metal - poor agb stars . </S>",
    "<S> our investigation is focused on the entrainment process at the top convection boundary and on the subsequent advection of h - rich material into deeper layers , and we therefore ignore the burning of the proton - rich fuel in this study . </S>",
    "<S> we find that , for our deep convection zone , coherent convective motions of near global scale appear to dominate the flow . at the top boundary convective shear flows are stable against kelvin - helmholtz instabilities . </S>",
    "<S> however , such shear instabilities are induced by the boundary - layer separation in large - scale , opposing flows . </S>",
    "<S> this links the global nature of thick shell convection with the entrainment process . </S>",
    "<S> we establish the quantitative dependence of the entrainment rate on grid resolution . with our numerical technique simulations with @xmath1 cells or more </S>",
    "<S> are required to reach a numerical fidelity appropriate for this problem . </S>",
    "<S> however , only the result from the @xmath2 simulation provides a clear indication that we approach convergence with regard to the entrainment rate . </S>",
    "<S> our results demonstrate that our method , which is described in detail , can provide quantitative results related to entrainment and convective boundary mixing in deep stellar interior environments with very stiff convective boundaries . for the representative case we study in detail , </S>",
    "<S> we find an entrainment rate of @xmath3 . </S>"
  ]
}