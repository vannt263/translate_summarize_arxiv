{
  "article_text": [
    "let @xmath6 be a simple graph with vertices @xmath7 and edges @xmath8 , and let @xmath9 denote the positive integers .",
    "a _ ( proper ) coloring _ of @xmath6 is a function @xmath10 such that @xmath11 whenever the vertices @xmath12 are adjacent .",
    "stanley ( @xcite ; see also @xcite ) defined the _ chromatic symmetric function _ of @xmath6 as @xmath13",
    "the sum over all colorings @xmath14 , where @xmath15 are countably infinitely many commuting indeterminates .",
    "this definition is invariant under permutations of @xmath16 , so @xmath17 is a symmetric function , homogeneous of degree @xmath18 .",
    "the chromatic symmetric function is a much stronger isomorphism invariant than the well - known _",
    "chromatic polynomial _",
    "@xmath19 , a polynomial function of  @xmath20 that gives the number of colorings of @xmath6 using at most @xmath20 colors .",
    "indeed , for any integer  @xmath20 , the number @xmath19 can be obtained from @xmath17 by setting @xmath21 and @xmath22 for all @xmath23 .",
    "it is natural to ask whether @xmath17 is a complete isomorphism invariant ; that is , whether two non - isomorphic graphs must have different chromatic symmetric functions .",
    "the answer is no ; the smallest example , shown in figure  [ samexg - figure ] , was given by stanley in @xcite .",
    "brylawski @xcite introduced a graph invariant called the _ polychromate _ and constructed an infinite family of pairs of nonisomorphic graphs with the same polychromate .",
    "sarmiento @xcite proved that the polychromate is equivalent to the _",
    "@xmath24-polynomial _ studied by noble and welsh @xcite , a stronger invariant than @xmath25",
    "; therefore , each pair in brylawski s construction shares the same chromatic symmetric functions .",
    "( we thank anna de  mier for directing our attention to these results . ) in another direction , the non - commutative version of the chromatic symmetric function , studied by gebhard and sagan @xcite , is easily seen to be a complete invariant .",
    "stanley s question of whether @xmath17 is a complete isomorphism invariant for _ trees _ remains open .",
    "this is equivalent to the problem of whether a tree is determined by its @xmath24-polynomial , since the formula for @xmath17 in terms of the @xmath24-polynomial ( * ? ? ?",
    "* theorem  6.1 ) is easily seen to be reversible for trees .",
    "stanley s question was answered in the affirmative for certain special kinds of trees by fougere  @xcite and the second author  @xcite , both of whom listed several other tree invariants that can be extracted from the chromatic symmetric function .",
    "additionally , tan  @xcite has verified computationally that the answer is `` yes '' for trees with 23 or fewer vertices .",
    "( in contrast , the chromatic polynomial is nearly useless for distinguishing trees , because @xmath26 for every tree  @xmath0 with  @xmath27 vertices . )",
    "our main tool is stanley s expansion of the chromatic symmetric function in the basis of power - sum symmetric functions @xmath28 ( * ? ? ?",
    "* theorem  2.5 ) ; see equation below .",
    "when @xmath0 is a ( possibly trivial ) tree , the coefficient @xmath29 of @xmath28 in @xmath1 has a particularly simple combinatorial interpretation . for @xmath30 , define the _ type _ of @xmath31 to be the partition whose parts are the sizes of the vertex sets of the graph with vertices @xmath32 and edges @xmath31 ( see figure  [ type - figure ] for an example ) .",
    "then , up to a sign , @xmath29 is the number of edge sets @xmath31 of type  @xmath33 .",
    "as we will see , many other invariants of  @xmath0 can be recovered from @xmath1 .",
    "recall that the _ degree _ of a vertex is the number of edges incident to it .",
    "a _ leaf _ of a tree is a vertex of degree  1 , and the unique incident edge is called a _",
    "leaf edge_. we define the _ subtree polynomial _ of @xmath0 by @xmath34 where the sum runs over all subtrees @xmath35 of  @xmath0 with at least one edge , and @xmath36 denotes the set of leaf edges of  @xmath35 . setting @xmath37 and @xmath38 in @xmath2 recovers the polynomial @xmath39 studied by chaudhary and gordon in ( * ? ? ?",
    "* section  3 ) .",
    "conversely , @xmath40 , so the two polynomials provide identical information about @xmath0 .    for every non - empty set @xmath30 , there is a unique minimal subset @xmath41 , called the _ connector _ of @xmath31 , such that @xmath42 is a tree .",
    "( so @xmath43 if and only if @xmath31 is itself a subtree of  @xmath0 . )",
    "the _ connector polynomial _ of @xmath0 is then defined as @xmath44    the polynomials @xmath2 and @xmath45 provide equivalent information about @xmath0 ; we will prove in proposition  [ subt - conn - equivalence ] below that each of these invariants can be obtained from the other .",
    "moreover , the path sequence and degree sequence of @xmath0 can easily be recovered from @xmath46 , as observed by chaudhary and gordon ( * ? ? ?",
    "* proposition  18 )",
    ".    for a partition @xmath47 , and integers @xmath48 , define @xmath49 we can now state our main theorem , which asserts that the subtree and connector polynomials can be recovered from the chromatic symmetric function @xmath1 .",
    "[ main - thm ] for every @xmath50 , and for every tree @xmath0 with @xmath27 vertices , @xmath51 and @xmath52    it follows that the chromatic symmetric function is at least as strong an invariant as the subtree and connector polynomials .",
    "in particular , the path and degree sequences of  @xmath0 can be recovered from @xmath1 , as announced previously in  @xcite ; this generalizes a earlier result of fougere  ( * ? ? ?",
    "* theorem  3.3.1 ) .",
    "section  [ main - thm - section ] contains the proof of theorem  [ main - thm ] , as well as explicit formulas for the path and degree sequences , and a reinterpretation of and in terms of the usual scalar product on the space of symmetric functions .",
    "theorem  [ main - thm ] implies that @xmath1 is a stronger invariant than @xmath2 .",
    "in fact , it is _ strictly _ stronger : the two trees shown in figure  [ counterexample - figure ] have different chromatic symmetric functions , but the same subtree polynomial .",
    "( eisenstat and gordon @xcite constructed an infinite family of pairs of non - isomorphic trees with the same subtree polynomials , of which figure  [ counterexample - figure ] is the smallest example . )",
    "thus stanley s question remains open .    as another application of the combinatorial interpretation of the coefficients @xmath29 , we identify some classes of trees for which the chromatic symmetric function is in fact a complete invariant .",
    "these trees include all _ spiders _ ( trees having exactly one vertex of degree @xmath53 ) and some _ caterpillars _ ( trees from which deleting all leaves yields a path , such as those in figure  [ counterexample - figure ] ) .",
    "we prove in section  [ spider - section ] that every spider can be reconstructed from its subtree polynomial , hence from its chromatic symmetric function ( generalizing results of fougere @xcite ) .",
    "the corresponding problem for caterpillars is more difficult ; however , certain special kinds of caterpillars can indeed be reconstructed from their chromatic symmetric functions , and the methods we use to prove this may be extendible to all caterpillars .",
    "a _ unicyclic graph _ is a graph with one cycle .",
    "connected unicyclic graphs can be recognized as such from their chromatic symmetric functions . while the combinatorial data provided by stanley s expansion is not as fine for unicyclic graphs",
    "as it is for trees , we can still obtain some uniqueness results for special unicyclic graphs by mimicking our results for spiders and caterpillars .",
    "in particular , we show in section  [ squid - section ] that no two _ squids _ ( unicyclic graphs with at most one vertex of degree two or more ) can have the same chromatic symmetric function , although it is not clear whether membership in the class of squids can be determined from @xmath17 .",
    "an analogous result holds for _ crabs _ ( unicyclic graphs in which every vertex not on the cycle is a leaf ) satisfying an additional technical condition .",
    "our collaboration began at the graduate student combinatorics conference held at the university of minnesota on april 16 and 17 , 2005 .",
    "we thank the organizers of the conference for their efforts , and we thank franois  bergeron , tom  enkosky , gary  gordon , brandon  humpert , rosa  orellana , victor  reiner , bruce  sagan , and stephanie  van  willigenburg for many helpful conversations .",
    "the database of trees constructed by piec , malarz , and kulakowski @xcite , and john  stembridge s freely available maple package sf , were invaluable for calculating examples and formulating ( and checking small cases of ) conjectures  [ positivity - conjecture ] and  [ integrality - conjecture ] .",
    "finally , we thank two anonymous referees for their suggestions , and in particular for making us aware of fougere s undergraduate thesis @xcite .",
    "we assume that the reader is familiar with basic facts about graphs and trees ( see , e.g. , ( * ? ? ?",
    "* chapter  i ) ) .",
    "we denote a graph @xmath6 by an ordered pair @xmath54 , where @xmath55 is the set of vertices and @xmath56 is the set of edges .",
    "all our graphs are _",
    "simple _ ; that is , we forbid loops and parallel edges .",
    "the _ order _ of a graph is its number of vertices .",
    "a _ tree _ is a graph @xmath6 which is acyclic and connected and for which @xmath57 ; any two of these conditions together imply the third .",
    "we consider the graph with one vertex and no edges to be a tree , the _",
    "trivial tree _ ;",
    "unless otherwise specified , all our statements about trees include this possibility .",
    "a _ leaf _ of a tree is a vertex of degree  1 , that is , with exactly one incident edge .",
    "every nontrivial tree has at least two leaves @xcite .",
    "it is often notationally convenient to ignore the distinction between a graph and its edge set .",
    "we now review some facts about symmetric functions ( for which the standard references are @xcite and ( * ? ? ?",
    "* chapter  7 ) ) and about the chromatic symmetric function ( introduced by stanley in  @xcite ) .",
    "a _ partition _ is a sequence @xmath58 of positive integers in weakly decreasing order .",
    "the numbers @xmath59 are called the _ parts _ of @xmath33 .",
    "we say that @xmath33 is a partition of @xmath27 , written @xmath60 , if @xmath61 . the number @xmath62 is called the _ length _ of @xmath33 .",
    "let @xmath15 be a countably infinite set of commuting indeterminates .",
    "for @xmath63 , the _",
    "@xmath64 power - sum symmetric function _ is @xmath65 and for a partition @xmath33 we define @xmath66 it is well known that @xmath67 is a basis for the @xmath68-vector space @xmath69 consisting of all symmetric functions that are homogeneous of degree  @xmath27 .",
    "let @xmath6 be a graph of order  @xmath27 .",
    "stanley ( * ? ? ?",
    "2.5 ) proved that @xmath70 where @xmath71 is the partition whose parts are the orders of the connected components of the subgraph of @xmath6 induced by  @xmath31 ( see figure  [ type - figure ] for an example ) .",
    "note that @xmath71 depends upon @xmath31 and @xmath7 , but not on @xmath8 .",
    "we write @xmath72 for the coefficient of @xmath28 in the expansion ; that is , @xmath73 we will abbreviate @xmath74 when no confusion can arise .",
    "the chromatic symmetric function of a graph provides much more combinatorial information when that graph is a tree . in general",
    ", the coefficient @xmath75 does not count edge sets of type @xmath33 , because @xmath76 is not constant for all such sets  @xmath31 . on the other hand ,",
    "if @xmath77 is a tree of order  @xmath27 , then every @xmath78 is acyclic , so its induced subgraph has @xmath79 connected components .",
    "hence @xmath80 , and we obtain a useful combinatorial interpretation for the numbers @xmath75 : @xmath81 the invariants @xmath75 are far from independent ; in particular , implies that @xmath82    we next list some basic invariants of graphs that can be recovered from its chromatic symmetric function .",
    "several of these facts were previously observed by the second author in @xcite . for notational simplicity",
    ", we shall often omit the parentheses and singleton parts of a partition , for instance , writing @xmath83 rather than @xmath84 .",
    "[ basic - facts ] for every graph @xmath85 ,    * the symmetric function @xmath17 is homogeneous of degree @xmath86 ; * @xmath87 ; and * the number @xmath20 of connected components of @xmath6 is @xmath88 .",
    "if @xmath6 is a tree , then in addition    * for @xmath89 , @xmath90 is the number of subtrees of @xmath6 with @xmath91 vertices ; and * @xmath92 is the number of leaves of @xmath6 .",
    "assertion ( i ) is immediate from the definition of @xmath17 , and ( ii ) follows easily from . for ( iii ) , implies that @xmath93 whenever @xmath94 . on the other hand , @xmath95 , the sum over all @xmath96 with @xmath97 , where @xmath98 is the tutte polynomial of @xmath6 ( see ( * ? ? ?",
    "x ) ) . up to sign",
    ", this formula counts acyclic orientations of @xmath6 with exactly one sink in each component ( this follows from ( * ? ? ?",
    "8 , p.  348 ) ) .",
    "in particular , @xmath99 .",
    "assertion ( iv ) holds because @xmath96 is the set of edges of a @xmath91-vertex subtree if and only if @xmath100 , and ( v ) follows because every subtree of order @xmath101 is of the form @xmath102 , where @xmath103 is a leaf .    by ( i ) , ( ii ) and ( iii ) of proposition  [ basic - facts ] , trees can be distinguished from non - trees by their chromatic symmetric functions .",
    "moreover , part ( v ) implies that paths ( trees with exactly two leaves ) and stars ( trees with exactly one non - leaf ) are determined up to isomorphism by their chromatic symmetric functions .",
    "the _ girth _ of a graph @xmath6 is defined as the length of the smallest cycle in @xmath6 , or @xmath104 if @xmath6 is acyclic . with a little more work",
    ", we can compute the girth of @xmath6 from @xmath17 .",
    "the idea is to find the smallest edge set for which fails .",
    "[ girth - prop ] let @xmath85 be a graph with @xmath27 vertices and @xmath105 edges .",
    "let @xmath20 be the largest number such that @xmath106 then the girth of @xmath6 is @xmath107 .",
    "let @xmath108 be the girth of @xmath6 .",
    "suppose first that @xmath109 . then @xmath110 , so every subset @xmath78 with @xmath111 edges is acyclic and hence has @xmath20 connected components . on the other hand , if @xmath112 , then the maximum size of a component of @xmath31 is @xmath113 , so @xmath31 must be acyclic and hence must have @xmath111 edges . therefore @xmath114    now suppose that @xmath115 .",
    "we claim that @xmath78 has @xmath20 components if and only if it either has @xmath111 edges ( hence is acyclic ) or is precisely a cycle of length  @xmath108 .",
    "the `` if '' direction is evident . for",
    "the `` only if '' direction , suppose that @xmath31 has @xmath20 components and is not acyclic , hence contains a cycle @xmath116 . by definition of @xmath6 , the length of @xmath116 can not be less than @xmath108 ; on the other hand , there are at least @xmath117 vertices that do not belong to @xmath116 ( one for each other component of @xmath31 ) , so @xmath118 .",
    "thus @xmath116 has length exactly  @xmath108 .",
    "moreover , @xmath119 can not contain any other edge with an endpoint outside @xmath116 ( because then it would have fewer than @xmath20 components ) or an edge joining two vertices of  @xmath116 ( because then @xmath6 would contain a cycle of length @xmath120 ) .",
    "hence @xmath121 as desired .",
    "denoting by @xmath122 the set of @xmath108-cycles of @xmath6 , we have @xmath123 as desired .",
    "theorem  [ main - thm ] expresses the subtree polynomial @xmath2 and connector polynomial @xmath45 of a tree  @xmath0 in terms of the chromatic symmetric function @xmath1 . the first step is to show that @xmath2 and @xmath45 are interchangeable . in what follows , we will often abuse notation by ignoring the distinction between a tree  @xmath77 and its edge set @xmath124 .",
    "[ subt - conn - equivalence ] let @xmath0 be a tree .",
    "then :    1 .   @xmath125 .",
    "2 .   @xmath126 .    for each nontrivial subtree @xmath127 , write @xmath36 for the set of leaf edges of @xmath35 .",
    "note that @xmath128 , with equality if and only if @xmath35 consists of a single edge .",
    "moreover , observe that @xmath129 if and only if @xmath130 . hence @xmath131 giving the first equality .",
    "meanwhile , solving the equations @xmath132 for @xmath133 and @xmath134 yields @xmath135 , @xmath136 , giving the second equality .",
    "we now prove the main theorem .",
    "to do so , we establish a formula for the connector polynomial of a tree in terms of its chromatic symmetric function , then apply proposition  [ subt - conn - equivalence ] to obtain a formula for the subtree polynomial .    by definition ,",
    "the coefficient of @xmath137 in @xmath138 is @xmath139 because the innermost sum vanishes unless @xmath140 , when it is @xmath141 . setting @xmath142",
    ", we may rewrite this expression as @xmath143 and setting @xmath144 yields @xmath145 where @xmath146 the set @xmath42 is connected , so if it is a subset of @xmath147 then it must be a subset of some component of @xmath147 .",
    "on the other hand , if @xmath148 is a ( possibly trivial ) component of @xmath147 and @xmath149 , then @xmath150 , because @xmath148 is a tree containing @xmath31 and @xmath42 is the unique minimal such tree . thus if @xmath151 then @xmath152 note that this formula is valid only if @xmath153 . substituting into",
    ", we obtain @xmath154 ( where @xmath155 is defined by ) , giving the desired formula .",
    "we now turn to the proof of . by proposition",
    "[ subt - conn - equivalence ] , we have @xmath156 setting @xmath157 , we may rewrite the last expression as @xmath158 applying the binomial expansion to @xmath159 yields @xmath160 now setting @xmath161 gives @xmath162 and setting @xmath163 and rearranging gives @xmath164 which is the desired formula .",
    "two basic invariants of a tree are its _ path sequence _ and its _ degree sequence_. the path sequence of @xmath0 is defined as @xmath165 , where @xmath166 is the number of @xmath167-edge paths in @xmath0 . the degree sequence of @xmath0 is defined as @xmath168 , where @xmath169 is the number of degree-@xmath91 vertices in @xmath0 . knowing the degree sequence is equivalent to knowing the _ star sequence _",
    "@xmath170 , where @xmath171 is the number of @xmath20-edge stars in @xmath0 .",
    "indeed , it is not hard to see that @xmath172 for every @xmath173 , and so @xmath174    [ degree - and - path - sequences ] the degree and path sequences of a tree @xmath0 can be recovered from its chromatic symmetric function .    the key observation , due to chaudhary and gordon ( * ? ? ?",
    "* proposition  18 ) , is that the path and star sequences of  @xmath0 can be recovered from @xmath2 .",
    "indeed , @xmath175 is the number of edges of  @xmath0 , and for every @xmath176 , @xmath177 is just the coefficient of @xmath178 in @xmath46 .",
    "meanwhile , for every @xmath179 , @xmath180 is the coefficient of @xmath181 .",
    "we note that fougere had proved  ( * ? ? ?",
    "* theorem  3.3.1 ) that the sum of the squared vertex degrees , @xmath182 , could be obtained from the coefficient of the monomial symmetric function @xmath183 in @xmath1 .",
    "we can rephrase the formulas for @xmath45 and @xmath2 in terms of the usual scalar product @xmath4 on the space @xmath69 of degree-@xmath27 symmetric functions ( see @xcite or @xcite ) , where @xmath27 is the order of  @xmath0 . define symmetric functions @xmath184 and @xmath185 by @xmath186 then the formulas and are respectively equivalent to @xmath187    the symmetric function @xmath188 appears to have certain positivity and integrality properties , as we now explain .",
    "the _ @xmath189 homogeneous symmetric function _",
    "@xmath190 in indeterminates @xmath15 is the sum of all monomials of degree  @xmath167 , and for a partition @xmath58 we define @xmath191 . the symmetric functions @xmath192 form a vector space basis for @xmath69 @xcite , so there is a unique list of rational numbers @xmath193 such that @xmath194    [ positivity - conjecture ] let @xmath195 be a partition , and let @xmath196 be the number of parts of @xmath197 of even length . then , for all integers @xmath198 , @xmath199    [ integrality - conjecture ] let @xmath195 be a partition .",
    "then , for all integers @xmath198 , the number @xmath200 is an integer .",
    "we have verified conjectures  [ positivity - conjecture ] and  [ integrality - conjecture ] computationally for all @xmath201 , which we think is strong evidence that they hold for all  @xmath27 .",
    "a formula for @xmath202 can be written out explicitly using the known transition matrices between bases of symmetric functions ( see  @xcite ) . however , we do not know a direct combinatorial interpretation for @xmath202 or for @xmath200 .",
    "one might hope that for every two trees @xmath203 with @xmath204 , the number of subtrees of  @xmath0 isomorphic to  @xmath24 might be given by a scalar product @xmath205 , where @xmath206 is some symmetric function independent of  @xmath0 .",
    "such a result would generalize corollary  [ degree - and - path - sequences ] ( which covers only the case that  @xmath24 is a path or a star ) and , by a theorem of harary and palmer @xcite , would imply that every tree is distinguished by its chromatic symmetric function .",
    "in fact , it appears that such a function @xmath206 exists _ only if _ @xmath24 is a star or a path , as we have verified computationally for all @xmath24 of order  @xmath207 , with one trivial exception . , the path @xmath208 , and another tree  @xmath24 . since the number of four - edge subtrees of  @xmath0 is just @xmath209 , we have @xmath210 . ]",
    "theorem  [ main - thm ] does not resolve stanley s question , because @xmath2 is not a complete isomorphism invariant .",
    "indeed , the two trees @xmath211 shown in figure  [ counterexample - figure ] share the same subtree polynomial ; this is a special case of a theorem of eisenstat and gordon  @xcite . on the other hand , @xmath212",
    "this inequality follows from tan s calculations @xcite , and also for the following elementary reason .",
    "let @xmath213 be the edge set obtained by deleting the two rightmost horizontal edges in figure  [ counterexample - figure ] ; then @xmath214 .",
    "on the other hand , no subset of @xmath215 has that type .",
    "therefore @xmath216 and @xmath217 .",
    "the remainder of the article is devoted to identifying special classes of trees  @xmath0 for which the invariants @xmath75 suffice to reconstruct  @xmath0 up to isomorphism .",
    "a tree is a _ spider _ ( or _ starlike tree _ ) if exactly one of its vertices has degree @xmath53 . by corollary  [ degree - and - path - sequences ] , whether or not a tree is a spider can be determined from its subtree polynomial .",
    "a spider may equivalently be defined as a collection of edge - disjoint paths ( the _ legs _ ) joined at a common endpoint @xmath218 ( the _ torso _ ) .",
    "up to isomorphism , every spider on  @xmath27 vertices can be described by a partition @xmath219 whose parts are the lengths of its legs ( so @xmath220 ) .",
    "we denote the corresponding spider by @xmath221 .",
    "note that @xmath222 equals both the number of leaves of @xmath221 and the degree of its torso .",
    "we will show that the isomorphism type of a spider can be determined from its subtree polynomial , hence from its chromatic symmetric function .",
    "fougere ( * ? ? ?",
    "* chapter  2 ) had previously shown that _ forks _ ( spiders with exactly one leg of length @xmath223 and _ extended stars _ ( spiders in which every leg has length @xmath20 or @xmath224 for some @xmath20 ) could be reconstructed from their chromatic symmetric functions .    before continuing ,",
    "we describe a combinatorial problem whose solution will play a role in the proof .",
    "let @xmath225 be nonnegative integers with @xmath226 .",
    "suppose that we have @xmath227 distinguishable boxes , of which @xmath228 have capacity  @xmath167 for each @xmath229 $ ] .",
    "let @xmath230 be the number of ways of distributing @xmath20 indistinguishable balls among these boxes so that no box is filled beyond its capacity .",
    "in general , it is not easy to write down a closed formula for @xmath230 , although individual instances can be computed using an inclusion - exclusion argument ( for example ) .",
    "[ spider - thm:1 ] let @xmath219 be a partition with @xmath231 , and let @xmath232 be the corresponding spider .",
    "then @xmath0 can be reconstructed from its subtree polynomial .",
    "first , suppose that @xmath233 .",
    "then @xmath234 , @xmath235 , and @xmath236 are respectively the diameter , number of edges , and number of three - leaf subtrees of @xmath221 . these invariants can be recovered from @xmath237 , and together they determine @xmath33 .",
    "now suppose that @xmath238 .",
    "let @xmath239 denote the number of parts of size @xmath20 in @xmath33 , and let @xmath240 denote the number of subtrees of the spider @xmath0 with @xmath167 edges and @xmath91 leaf edges ( that is , the coefficient of @xmath241 in @xmath46 ) .",
    "we will show by induction on  @xmath20 that @xmath239 can be calculated from the numbers @xmath240 .",
    "first , suppose @xmath242 . since there is a bijection between legs of @xmath0 of length 1 ( i.e. , consisting of a single edge ) and subtrees with @xmath243 edges and @xmath244 legs ( which are formed by deleting such an edge ) .",
    "hence @xmath245 .    for @xmath246",
    ", we can choose a subtree @xmath127 with @xmath247 edges and @xmath244 leaves as follows .",
    "first , fix @xmath248 $ ] and delete a leg of length @xmath91 ; there are @xmath249 ways to do this .",
    "if @xmath250 , then we still need to delete @xmath251 more edges .",
    "it suffices to specify how many edges to delete from the end of each of the other @xmath244 legs , so the number of ways to do this is the solution to the balls - in - boxes problem described above , regarding the @xmath251 edges to be deleted as balls and each remaining leg of length @xmath167 as a box of capacity @xmath252 ( since deleting the entire leg will result in a tree with fewer than @xmath244 leaves ) .",
    "therefore @xmath253 is given by the formula @xmath254 by induction , the @xmath240 determine @xmath255 , and equation implies that they determine @xmath239 as well .",
    "another way of reconstructing a spider from its chromatic symmetric function will be useful in section  [ squid - section ] .",
    "define the _ two - part portion _ @xmath256 of @xmath17 by @xmath257 while @xmath258 is evidently a much weaker invariant than @xmath17 , it contains enough information to distinguish among spiders .    [ spider - thm:2 ] let @xmath0 be a spider of order @xmath27 .",
    "let @xmath259 , let @xmath260 , let @xmath261 for @xmath262 , and let @xmath263 .",
    "then one of the following conditions holds :    1 .",
    "the sequence @xmath264 is a partition , that is , @xmath265 .",
    "2 .   there is a number @xmath266 such that @xmath267 .",
    "moreover , @xmath268 , and @xmath269 .    in the first case ,",
    "let @xmath270 . in the second case",
    ", define a partition @xmath197 from @xmath264 by replacing all 2 s after the @xmath271 place with two 1 s",
    ".    then @xmath232 , where @xmath33 is the conjugate partition to @xmath197 .",
    "for each edge @xmath272 , denote by @xmath273 the minimum of the orders of the components of @xmath274 , so that @xmath275 .",
    "if we label the legs of @xmath0 as @xmath276 , where @xmath277 has @xmath278 edges , and label the edges of each @xmath277 as @xmath279 , starting from the leaf and reading in toward the torso , then @xmath280 .",
    "* case  1 : *  @xmath281 .",
    "then @xmath282 for every edge @xmath283 . in this case @xmath284 , and @xmath264 is just the conjugate partition of @xmath33 .",
    "* case  2 : *  @xmath285 .",
    "if @xmath286 , then @xmath287 , and @xmath288 for every @xmath91 .",
    "so we can give a formula for @xmath264 in terms of @xmath33 : @xmath289    note that @xmath290 , because @xmath291 is the unique edge whose deletion contains a component of order @xmath292 .",
    "on the other hand , @xmath293 , so @xmath294 whether @xmath27 is odd or even .",
    "therefore , @xmath264 is not a partition , but has the form described in case  ( 2 ) of the theorem .",
    "formula   implies that if we `` iron out '' @xmath264 by replacing every 2 after the @xmath295 entry with two 1 s , we will obtain the conjugate partition to @xmath33 .",
    "we now see how to recover @xmath33 , and thus the isomorphism type of the spider @xmath221 , from the data @xmath296 .",
    "either @xmath296 is a partition , in which case it is the conjugate of @xmath33 , or it has the form just described , in which case the `` ironing - out '' operation yields the conjugate of @xmath33 .",
    "this is precisely the statement of the theorem .",
    "a _ caterpillar _ is a tree @xmath0 with the property that the induced subgraph on the non - leaf vertices is a nontrivial path , called the _ spine _ of @xmath0 .",
    "that is , every vertex of @xmath0 either lies on the spine , or is a leaf whose unique neighbor lies on the spine .",
    "since the spine is nontrivial , a caterpillar must have at least four vertices . while eisenstat and gordon s result in @xcite rules out the possibility of distinguishing caterpillars by their subtree polynomials , there is still reason to hope that the additional information provided by the chromatic symmetric function of a caterpillar may suffice to reconstruct it up to isomorphism .",
    "our first result is that the chromatic symmetric function distinguishes caterpillars from non - caterpillars .",
    "the number of leaves and the diameter of a tree  @xmath0 ( the maximum length of a path in  @xmath0 ) can be recovered from @xmath1 by corollary  [ degree - and - path - sequences ] , so it suffices to prove the following fact .",
    "let @xmath0 be a tree with  @xmath297 vertices .",
    "then @xmath0 is a caterpillar if and only if @xmath298 .",
    "if @xmath0 is a caterpillar , then every path of maximum length consists of the spine together with a leaf attached to each of its endpoints , hence contains all the non - leaf vertices and two other ( leaf ) vertices .",
    "in particular , the number of edges in such a path is one more than the number of non - leaf vertices . on the other hand , if @xmath299 is a path of maximum length in @xmath0 , then the internal vertices of @xmath299 are not leaves of @xmath0 ( because each has two neighbors in @xmath299 ) but its endpoints are ( otherwise @xmath299 could be lengthened ) .",
    "if @xmath298 , then all the vertices not lying on @xmath299 must be leaves , which is to say that @xmath0 is a caterpillar .",
    "let @xmath0 be a caterpillar with spine vertices @xmath300 .",
    "for each  @xmath167 , let @xmath301 , where @xmath302 denotes the degree of the vertex @xmath303 .",
    "gordon and mcdonnell ( * ? ? ?",
    "* lemma  2 ) showed that the numbers @xmath304 are almost determined by the path sequence of @xmath0 , and are indeed determined by the path sequence when the caterpillar is _ symmetric _ ( that is , @xmath305 for @xmath306 ) .",
    "therefore , every symmetric caterpillar is determined up to isomorphism by its chromatic symmetric function , a result proved in another way by the second author ( * ? ? ?",
    "* theorem  4.3.1 ) .",
    "we now describe another class of caterpillars that can be reconstructed from their chromatic symmetric functions .",
    "we retain the labeling of the vertices of @xmath0 as @xmath300 .",
    "let @xmath307 be the number of _ leaves _ adjacent to @xmath303 , so that @xmath308 for @xmath309 and @xmath310 for @xmath311 .",
    "call @xmath307 the @xmath189 _ leaf number _ of @xmath0 .",
    "in addition , call a partition @xmath33 _ singleton - free _ if all its parts are at least 2 .",
    "[ distinct - caterpillar - thm ] let @xmath0 be a caterpillar whose leaf numbers @xmath307 are strictly positive and distinct .",
    "then @xmath0 can be reconstructed from its chromatic symmetric function .",
    "let @xmath312 be the set of leaf edges of @xmath0 .",
    "since @xmath313 for all @xmath167 , every spine vertex is adjacent to at least one leaf . therefore , the edge sets @xmath314 such that @xmath71 is singleton - free are precisely those that contain @xmath312 .",
    "in particular , @xmath315 is the unique singleton - free partition with @xmath316 parts whose coefficient @xmath29 is non - zero .",
    "up to reordering , the parts of @xmath33 are the numbers @xmath317 .",
    "furthermore , for each spine edge @xmath318 , the edge set @xmath319 contributes @xmath320 to @xmath321 , where @xmath322 note that the partitions @xmath323 are all distinct .",
    "moreover , @xmath323 has @xmath324 of its parts in common with @xmath33 ; the remaining two parts of @xmath33 must be the leaf numbers of adjacent spine vertices of @xmath0 .",
    "( this statement is valid even if the parts of @xmath323 are not all distinct . ) in this way we can recover the leaf numbers of the endpoints of every edge of  @xmath0 , and this data specifies the caterpillar up to isomorphism .    using the same argument",
    ", we can relax the condition of the theorem slightly : we need only require that all leaf numbers are positive and that for each  @xmath20 , the set of spine vertices with leaf number  @xmath20 form a subpath of the spine .",
    "despite the title of this article , we devote the last section to a family of graphs @xmath6 that are not trees , but rather _ unicyclic _ ; that is , @xmath6 contains a unique cycle .",
    "equivalently , @xmath325 , where @xmath326 are the numbers of components , vertices and edges respectively , so unicyclicity can be detected from @xmath25 by proposition  [ basic - facts ] .",
    "while we can no longer interpret the coefficients @xmath75 as in , we can use stanley s expansion of @xmath17 in terms of broken circuits ( * ? ? ?",
    "a special case of that result is the following : if @xmath6 has a unique cycle @xmath116 and @xmath327 is an edge of @xmath116 , then @xmath328      a _ squid _ is a connected unicyclic graph with a single vertex @xmath103 of degree greater than 2 .",
    "note that @xmath103 must lie on the cycle .",
    "a squid is described up to isomorphism by the length of its cycle and of the _ tentacles _ ( the paths from the leaf vertices to  @xmath103 ) .",
    "for example , if @xmath221 is the spider whose leg lengths are given by the parts of @xmath33 , then adding an edge between the leaves at the ends of the two longest legs produces a squid with cycle length @xmath234 and tentacle lengths @xmath329 .",
    "it is not clear how to determine from @xmath17 whether or not a unicyclic graph @xmath6 is a squid ( for instance , we can not recover the degree sequence of an arbitrary graph from its chromatic symmetric function as we can for a tree ) .",
    "nevertheless , the following uniqueness result does hold .",
    "let @xmath35 be a squid with unique cycle  @xmath116 .",
    "let @xmath224 be the length of  @xmath116 ; this number can be recovered from @xmath330 by proposition  [ girth - prop ] .",
    "let @xmath103 be the unique vertex of @xmath35 of degree @xmath331 , and let @xmath197 be the partition whose parts are the edge lengths of the tentacles .",
    "label the edges of @xmath116 as @xmath332 , starting at @xmath103 and proceeding around the cycle . by and inclusion - exclusion ,",
    "we obtain @xmath333 where the omitted terms involve edge sets @xmath31 lacking three or more edges from @xmath334 . deleting three or more edges from @xmath35",
    "produces a graph with three or more connected components , so passing to two - part portions as in yields @xmath335 each graph @xmath336 has exactly two components , of sizes @xmath337 and @xmath338 .",
    "removing additional edges will strictly increase the number of components , so @xmath339 where @xmath340 is the spider with legs whose lengths are @xmath167 , @xmath341 , and the parts of @xmath197 .",
    "therefore , @xmath330 determines the quantity @xmath342    leaving the foregoing calculations aside for the moment , we note that if @xmath0 is a tree with @xmath101 edges , then to calculate @xmath343 we need only consider the edge subsets of cardinality @xmath243 .",
    "in particular , if @xmath232 is a spider , then @xmath344 it follows that for any partition @xmath197 and numbers @xmath345 , we have @xmath346 which can be computed from @xmath330 using .",
    "meanwhile , by theorem  [ spider - thm:2 ] , we can reconstruct the spider @xmath347 from @xmath348 .",
    "in particular , we can reconstruct the partition @xmath197 , which gives the tentacle lengths of the squid @xmath35 .    just as squids can be regarded as the unicyclic analogues of spiders , the unicyclic analogues of caterpillars are _ crabs _ : connected unicyclic graphs in which every vertex not lying on the cycle",
    "is a leaf . in analogy",
    "to theorem  [ squid - thm ] and its proof , we ask whether is it possible to use the results of section  [ caterpillar - section ] to classify the chromatic symmetric functions of ( some ) crabs . as a starting point",
    ", we prove the following analogue of theorem  [ distinct - caterpillar - thm ] .        the girth @xmath108 of @xmath6 can be recovered from @xmath17 by proposition  [ girth - prop ] .",
    "let @xmath116 be the unique cycle of @xmath6 , and label its vertices in cyclic order as @xmath352 .",
    "let @xmath310 be the number of leaves adjacent to @xmath303 .",
    "note that @xmath6 can be specified up to isomorphism by the cyclically ordered list of numbers @xmath353 .",
    "let @xmath312 denote the set of leaf edges of @xmath6 .",
    "the subsets of @xmath8 whose type is singleton - free are precisely those that contain @xmath312 as a subset . in particular , @xmath312 itself is the unique edge set whose type is a singleton - free partition of length  @xmath108 .",
    "thus @xmath354 can be recovered from @xmath17 .",
    "moreover , there are precisely @xmath108 edge sets whose type is a singleton - free partition of length  @xmath355 ; these edge sets are of the form @xmath356 for some @xmath357 . just as in theorem  [ distinct - caterpillar - thm ] , the types of these edge sets are all distinct , and they specify which pairs of the @xmath307 correspond to adjacent vertices of the cycle",
    ".                          jeremy l.  martin and jennifer wagner , _ on the chromatic symmetric function of a tree _ , extended abstract for 18th annual conference on formal power series and algebraic combinatorics ( san  diego , 2006 ) .",
    "li - yang tan , _ computational verification that the chromatic symmetric function determines up to isomorphism trees of order at most 23 _ , http://www.cs.wustl.edu/~lt1/csf.html , retrieved on may 14 , 2007 ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be an unrooted tree . </S>",
    "<S> the _ chromatic symmetric function _ </S>",
    "<S> @xmath1 , introduced by stanley , is a sum of monomial symmetric functions corresponding to proper colorings of @xmath0 . </S>",
    "<S> the _ subtree polynomial _ </S>",
    "<S> @xmath2 , first considered under a different name by chaudhary and gordon , is the bivariate generating function for subtrees of @xmath0 by their numbers of edges and leaves . </S>",
    "<S> we prove that @xmath3 , where @xmath4 is the hall inner product on symmetric functions and @xmath5 is a certain symmetric function that does not depend on @xmath0 . thus the chromatic symmetric function is a stronger isomorphism invariant than the subtree polynomial . as a corollary </S>",
    "<S> , the path and degree sequences of a tree can be obtained from its chromatic symmetric function . as another application , </S>",
    "<S> we exhibit two infinite families of trees ( _ spiders _ and some _ caterpillars _ ) , and one family of unicyclic graphs ( _ squids _ ) whose members are determined completely by their chromatic symmetric functions . </S>"
  ]
}