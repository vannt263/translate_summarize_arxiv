{
  "article_text": [
    "exo - planetary systems that are directly imaged using existing facilities @xcite give a unique laboratory to constrain planetary formation at wide separations @xcite , to study the planetary luminosity distribution at critical young ages @xcite and the atmospheric properties of low surface gravity objects @xcite .",
    "upcoming surveys , conducted with instruments specifically designed for high - contrast @xcite , will unravel the bulk of this population of self - luminous jovian planets and provide an unprecedented understanding of their formation history .",
    "such instruments will reach the contrast required to achieve their scientific goals by combining extreme adaptive optics systems ( ex - ao , @xcite ) , optimized coronagraphs and nanometer class wavefront calibration @xcite . in the future , high - contrast instruments on",
    "extremely large telescopes will focus on probing planetary formation in distant star forming regions @xcite , characterizing both the spectra of cooler gas giants @xcite and the reflected light of planets in the habitable zone of low mass stars .",
    "the formidable contrast necessary to investigate the presence of biomarkers at the surface of earth analogs ( @xmath1 ) can not be achieved from the ground beneath atmospheric turbulence and will require dedicated space - based instruments @xcite .    the coronagraphs that will equip upcoming ex - ao instruments on 8 meter class telescopes have been designed for contrasts of at most @xmath2 .",
    "secondary support structures ( or spiders : 4 struts each @xmath3 cm wide , @xmath4 of the total pupil diameter in the case of gemini south ) have a small impact on starlight extinction at such levels of contrasts . in this case , coronagraphs have thus been optimized on circularly symmetric apertures , which only take into account the central obscuration @xcite .",
    "however , high - contrast instrumentation on future observatories will not benefit from such gentle circumstances .",
    "elts will have to support a substantially heavier secondary than 8 meter class observatories do , and over larger lengths : as a consequence the relative area covered by the secondary support will increase by a factor of 10 ( @xmath5 cm wide spiders , occupying @xmath6 of the pupil diameter in the case of tmt ) .",
    "this will degrade the contrast of coronagraphs only designed for circularly obscured geometries by a factor @xmath7 , when the actual envisioned contrast for an elt exo - planet imager can be as low as @xmath8 @xcite . while the trade - offs associated with minimization of spider width in the space - based case have yet to be explored",
    ", secondary support structures will certainly hamper the contrast depth of coronagraphic instruments of such observatories at levels that are well above the @xmath9 contrast requirement . as a consequence , telescope architectures currently envisioned for direct characterization of exo - earths consist of monolithic , off - axis , and thus un - obscured , telescopes @xcite .",
    "coronagraphs for such architectures take advantage of the pupil symmetry to reach a theoretical contrast of ten orders of magnitude . however , using obscured on - axis and/or segmented apertures take full advantage of the limited real estate associated with a given launch vehicle and can allow larger apertures that increase the scientific return of space - based direct imaging survey .",
    "recent solutions can mitigate the presence of secondary support structures in on - axis apertures .",
    "however these concepts present practical limitations : aplcs on arbitrary apertures @xcite and shaped pupils @xcite suffer from throughput loss for very high contrast designs , and piaamcm @xcite rely on a phase mask technology whose chromatic properties have not yet been fully characterized .",
    "moreover segmentation will further complicate the structure of the telescope s pupil : both the amplitude discontinuities created by the segments gaps and the phase discontinuities resulting from imperfect phasing will thus further degrade coronagraphic contrast . devising a practical solution for broadband coronagraphy on asymmetric , unfriendly apertures",
    "is an outstanding problem in high contrast instrumentation .",
    "the purpose of the present paper is to introduce a family of practical solutions to this problem . as their ultimate performances depend strongly on the pupil structure we limit the scope of this paper to a few characteristic examples .",
    "full optimization for specific telescope geometries can be conducted as needed .",
    "the method proposed here takes advantage of state - of - the art deformable mirrors in modern high - contrast instruments to address the problem of pupil amplitude discontinuities for on - axis and/or segmented telescopes .",
    "indeed , coronagraphs are not sufficient to reach the high contrast required to image faint exo - planets : wavefront control is needed to remove the light scattered by small imperfections on the optical surfaces @xcite . over the past eight years , significant progress has been made in this area , both in the development of new algorithms @xcite and in the experimental demonstration of high - contrast imaging with a variety of coronagraphs @xcite .",
    "these experiments rely on a system with a single deformable mirror which is controlled based on diagnostics downstream of the coronagraph , either at the science camera or as close as possible to the end detector @xcite .",
    "such configurations are well suited to correct phase wavefront errors arising from surface roughness but have limitations in the presence of pure amplitude errors ( reflectivity ) , or phase - induced amplitude errors , which result from the propagation of surface errors in optics that are not conjugate to the telescope pupil @xcite .",
    "indeed a single dm can only mimic half of the spatial frequency content of amplitude errors and compensate for them only on one half of the image plane ( thus limiting the scientific field of view ) over a moderate bandwidth . in theory",
    ", architectures with two sequential deformable mirrors , can circumvent this problem and create a symmetric broadband high contrast psf @xcite .",
    "the first demonstration of symmetric dark hole was reported in @xcite and has since been generalized to broadband by @xcite . in such experiments",
    "the coronagraph has been designed over a full circular aperture , the dm control strategy is based on a linearization of the relationship between surface deformations and electrical field at the science camera , and the modeling tools underlying the control loop consist of classic fourier and fresnel propagators .",
    "this is illustrated on the left panel of fig .",
    "[ fig : state ] . as a consequence ,",
    "a wavefront control system composed of two sequential deformable mirrors is currently the baseline architecture of currently envisioned coronagraphic space - based instruments @xcite and elt planet imagers @xcite .",
    "one can thus naturally be motivated to investigate if such wavefront control systems can be used to cancel the light diffracted by secondary supports and segments in large telescopes , since such structures are amplitude errors , albeit large amplitude errors .",
    "the purpose of our study is to demonstrate that indeed a two deformable mirror ( dm for the remainder of this paper ) wavefront control system can mitigate the impact of the pupil asymmetries , such as spiders and segments , on contrast and thus enable high contrast on unfriendly apertures . in  .",
    "[ sec : centralobsc ] we first present a new approach to coronagraph design in the presence of a central obscuration , but in the absence of spiders or segments .",
    "we show that for coronagraphs with a pupil apodization and an opaque focal plane stop , contrasts of @xmath10 can be reached for any central obscuration diameter , provided that the inner working angle is large enough .",
    "naturally the secondary support structures , and in the segmented cases , segment gaps , will degrade this contrast . as our goal is to use two dms as an amplitude modulation device",
    ", we first briefly review in  .",
    "[ sec : physicsofam ] the physics of such a modulation . in  .",
    "[ sec : madm ] we introduce a solution to this problem : we show how to compute dm surfaces that mitigate spiders and segment gaps .",
    "current algorithms used for amplitude control operate under the assumption that amplitude errors are small , and thus they can not be readily applied to the problem of compensating aperture discontinuities , which have inherently large reflectivity non - uniformities .",
    "[ fig : state ] illustrates how the present manuscript introduces a control strategy for the dms that is radically different from previously published amplitude modulators in the high - contrast imaging literature .",
    "our technique , which we name active compensation of aperture discontinuities ( hereafter acad ) , finds the adequate dm shapes in the true non - linear large amplitude error regime . in this case",
    "the dms surfaces are calculated as the solution of a non - linear partial differential equation , called the monge - ampere equation .",
    "we describe our methodology to solve this equation in  .",
    "[ sec : madm ] and illustrate each step using an obscured and segmented geometry similar to jwst . as acad",
    "dm surfaces are prescribed in the ray - optics approximation this is a fundamentally broadband technique provided that chromatic diffractive artifacts , edge ringing in particular , do not significantly impact the contrast .",
    "this is what we discuss in  .",
    "[ sec : chrom ] .",
    "we find that when remapping small discontinuities with deformable mirrors , the spectral bandwidth is only limited by wavelength - dependent edge - diffraction ringing in the fresnel approximation ( as discussed in @xcite for instance ) .",
    "high - contrast instruments where this ringing is mitigated have already been designed ; while future work in high precision optical modeling is necessary to fully quantify the true chromatic performances of acad , we do not expect these effects to be a major limitation to broadband operations . in  .",
    "[ sec : resuls ] we present the application of our method to various observatory architectures .",
    "note that the contrast levels stated in  .",
    "[ sec : resuls ] represent a non - optimal estimate of acad performances with on - axis and/or segmented apertures .",
    "our calculations are carried out in the absence of atmospheric turbulence , quasi - static wavefront errors or coronagraphic manufacturing defects .",
    "we discuss these limitations in  .",
    "[ sec : discuss ] , with a specific emphasis on quasi - static phase errors in a segmented telescope .",
    "we show that when the aperture discontinuities are thin enough field distortion is negligible for spatial frequencies within the field of view defined by the dms controllable spatial frequencies .",
    "we then discuss issues associated with phase discontinuities when applying acad to a segmented telescope .",
    "we show that they can be corrected by superposing single dm classical wavefront control solutions to the acad shape of the second dm .",
    "we finally argue , that should high precision diffractive models be developed , then the solutions presented herein can be used as the starting point of dual dms iterative algorithms relying on an image - plane based metric and thus lead to higher contrast than reported herein .",
    "most of the future exo - planet imagers , either on elts or on future space missions , are envisioned to control their wavefront in real time with two sequential dms .",
    "the method presented in this manuscript thus renders high contrast coronagraphy possible on _ any _ observatory geometry without adding any new hardware .",
    "because the pupil obscuration in an on - axis telescope is large it will be very difficult to mitigate its impact with dms with a limited stroke .",
    "indeed , the main hindrance to high - contrast coronagraphy in on - axis telescope is the presence of the central obscuration : it often shadows much more than @xmath11 of the aperture width while secondary supports and segments gaps cover @xmath12 .",
    "we thus first focus of azimuthally symmetric coronagraphic designs in the presence of a central obscuration .",
    "this problem ( without the support structures ) has been addressed in previous publications either using circularly symmetric pupil apodization @xcite or a series of phase masks @xcite .",
    "both solutions however are subject to limitations .",
    "the singularity at the center of the optical vector vortex coronagraph might be difficult to manufacture and a circular opaque spot thus lies in the central portion of the phase mask ( @xmath13 ) which results in a degradation of the ideal contrast of such a coronagraph @xcite .",
    "the solutions in @xcite result from an optimization seeking to maximize the off - axis throughput for a given focal plane stop diameter : the final contrast is absent from the optimization metric and is only a by - product of the chosen geometry .",
    "higher contrasts are then obtained by increasing the size of the focal plane mask , and thus result in a loss in iwa .      here",
    "we revisit the solution proposed by @xcite in a slightly different framework .",
    "we recognize that , in the presence of wavefront errors , high contrast can only be achieved in an area of the field of view that is bounded by the spatial frequency corresponding to the dm s actuator spacing .",
    "we thus consider the design of an apodized pupil lyot coronagraph which only aims at generating high contrast between the inner working angle ( iwa ) and outer working angle ( owa ) . in order to do so , we rewrite coronagraphs described by as an operator @xmath14 which relates the entrance pupil @xmath15 to the electrical field in the final image plane .",
    "we first call @xmath16 the hankel transform of the entrance pupil : @xmath17 where @xmath18 is the pupil diameter , @xmath19 the diameter of the secondary and @xmath20 the coordinate at the science detector expressed in units of angular resolution ( @xmath21 ) .",
    "@xmath22 is the design wavelength of the coronagraph chosen to translate the actual physical size of the focal plane mask in units of angular resolution ( often at the center of the bandwidth of interest ) .",
    "@xmath23 is then the wavelength at which the coronagraph is operating ( e.g. the physical size of the focal plane mask remains constant as the width of the diffraction pattern changes with wavelength ) . for the purpose of the monochromatic designs presented herein @xmath24 .",
    "then the operator is given by : @xmath25(\\xi ) = \\hat{p}(\\xi ) - \\frac{\\lambda^2}{\\lambda_0 ^ 2 } \\int_{d_{s}/2}^{d/2 } \\hat{p}(\\eta ) k(\\xi,\\eta ) \\eta",
    "d \\eta    \\label{eq : transfercorono}\\ ] ] where @xmath26 is the convolution kernel that captures the effect of the focal plane stop of diameter @xmath27 : @xmath28 an analytical closed form for this kernel can be calculated using lommel functions .",
    "note that this eq .",
    "[ eq : transfercorono ] assumes that the lyot stop is not undersized .",
    "since we are interested in high contrast regions that only span radially all the way up to a finite owa , we seek pupil apodization of the form : @xmath29 where @xmath30 denotes the bessel function of the first kind of order @xmath31 and @xmath32 the @xmath33th zero of this bessel function . in order to devise optimal apodizations over - obscured pupils , @xmath31 ,",
    "can be chosen to be large enough so that @xmath34 for @xmath35 ( in practice we choose @xmath36 ) .",
    "the @xmath32 corresponds to the spatial scale of oscillations in the coronagraph entrance pupil , and such a basis set yields high contrast regions all the way to @xmath37 . since the operator in eq .",
    "[ eq : transfercorono ] is linear , finding the optimal @xmath38 can be written as the following linear programming problem :    @xmath39   \\mbox{under the constraints : }    \\\\   & |\\mathcal{c } \\left [ ( p(r ) )",
    "\\right](\\xi)| < 10^{-\\sqrt{c } } \\ ; \\mbox{for}\\ ; iwa < \\xi",
    "< owa    \\\\   & \\max_{r}(p(r))= 1   \\\\   & |\\frac{d}{dr } [ p(r ) ] | < b \\label{eq : linprog}.\\end{aligned}\\ ] ]    our choice of cost function and constraints has been directed by the following rationale :    * we maximize the smallest value on the apodization function in an attempt to maximize throughput .",
    "the actual throughput is a quadratic function of the @xmath38 .",
    "maximizing it requires the solution of a non - linear optimization problem ( as described in @xcite ) * the contrast constraint is enforced between the iwa and the owa ( @xmath40 ) . * the maximum of the apodization function is set to one ( otherwise the @xmath38 will be chosen to be sufficiently small so that the contrast constraint is met ) .",
    "* the absolute value of the derivative across the pupil can not be larger than a limit , denoted as @xmath41 here .",
    "as the natural solutions of such problem are very oscillatory ( or `` bang bang '' , @xcite ) , a smoothness constraint has to be enforced ( see @xcite for a similar case ) .",
    "note that the linear transfer function in eq .",
    "[ eq : transfercorono ] can also be derived for other coronagraphs , with grayscale and phase image- plane masks , or for the case of under - sized lyot stops . as general coronagraphic design in obscured circular geometries is not our main purpose , we limit the scope of the paper to coronagraphs represented by eq .  [ eq : transfercorono ] .",
    "typical results of the monochromatic optimization in eqs .",
    "[ eq : linprog ] , with @xmath24 , are shown in fig .  [",
    "fig : corono ] for central obscurations of @xmath42 , @xmath43 and @xmath44 . in the first two cases",
    "the size of the focal plane stop is equal to @xmath45 , the iwa is @xmath46 and the owa is @xmath47 .",
    "as the size of the central obscuration increases the resulting optimal apodization becomes more oscillatory and the contrast constraint has to be loosened in order for the linear programming optimizer to converge to a smoother solution . alternatively increasing the size of the focal plane stop yield smooth apodizers with high contrast , at cost in angular resolutions ( bottom panel with a central obscuration of @xmath44 , a focal plane mask of radius @xmath46 , an iwa of @xmath48 and an owa of @xmath47 ) .",
    "these trade - offs were described in @xcite , however our linear programming approach to the design of pupil apodizations now imposes the final contrast instead of having it be a by product of fixed central obscuration and focal plane stop .",
    "these apodizations can either be generated using grayscale screen ( at a cost in throughput and angular resolution ) or a series of two aspherical piaa mirrors ( for better throughput and angular resolution ) . in order not to lose generality , we present our results on fig .  [",
    "fig : corono ] considering the two types of practical implementations ( classical apodization and piaa apodization ) . in the case of a grayscale amplitude screen",
    "the angular resolution units are as defined in eq .",
    "[ eq : transfercorono ] and the throughput is smaller than unity . in the case of piaa apodisation",
    "the throughput is unity and the angular resolution units have been magnified by the field independent centroid based angular magnification defined in @xcite .",
    "we adopt this presentation for the remainder of the paper where one dimensional psfs will be presented with `` aplc angular resolution units '' in the bottom horizontal axis and``piaac angular resolution units '' in the top horizontal axis .    note that this linear programming approach only optimizes the contrast for a given wavelength . however , since the solutions presented in fig .",
    "[ fig : corono ] feature contrasts below @xmath9 , we choose not to focus on coronagraph chromatic optimizations . instead , in order to account for the chromatic behavior of the coronagraph , the monochromatic simulations in  .",
    "[ sec : resuls ] are carried out under the _ conservative _ assumption that the physical size of the focal plane stop is somewhat smaller than optimal ( or that the operating wavelength of the coronagraph is slightly off , @xmath49 ) . as a consequence the raw contrast of the coronagraphs presented in  .",
    "[ sec : resuls ] is @xmath50 . note that this choice is not representative of all possible apodized pupil coronagraph chromatic configurations .",
    "it is merely a shortcut we use to cover the variety of cases presented in  .",
    "[ sec : resuls ] . in  .",
    "[ sec : wavefrontcontrol ] we present a set of broadband simulations that include wavefront errors and the true coronagraphic chromaticity for a specific configuration and show that bandwidth is more likely to be limited by the spectral bandwidth of the wavefront control system than by the coronagraph .",
    "however , future studies aimed at defining the true contrast limits of a given telescope geometry will have to rely on solutions of the linear problem in eqs .",
    "[ eq : linprog ] which has been augmented to accommodate for broadband observations . in theory",
    ", the method presented here can also be applied to asymmetric pupils .",
    "however , the optimization quickly becomes computationally intensive as the dimensionality of the linear programming increases ( in particular when the smoothness constraint and the bounds on the apodization have to be enforced at all points of a two dimensional array ) .",
    "this problem can be somewhat mitigated when seeking for binary apodizations , as shown in @xcite , at a cost in throughput and angular resolution .",
    "we have shown in  .",
    "[ sec : centralobsc ] that by considering the design of pupil apodized coronagraphs in the presence of a circular central obscuration as a linear optimization problem , high contrast can be reached provided that the focal plane mask is large enough . in practice , the secondary support structures and the other asymmetric discontinuities in the telescope aperture ( such as segment gaps ) will prevent such levels of starlight suppression .",
    "we demonstrate that well controlled dms can circumvent the obstacle of spiders and segment gaps . in this section ,",
    "we first set - up our notations and review the physics of phase to amplitude modulation .",
    "we consider the system represented on fig .",
    "[ fig : layout ] where two sequential dms are located between the telescope aperture and the entrance pupil of the coronagraph . in this configuration ,",
    "the telescope aperture and the pupil apodizer are not in conjugate planes .",
    "this will have an impact on the chromaticity of the system and is discussed in  .",
    "[ sec : chrom ] . without loss of generality",
    "we work under the `` folded '' assumption illustrated on fig .  [",
    "fig : coordinates ] where the dms are not tilted with respect to the optical axis and can be considered as lenses of index of refraction @xmath51 ( as discussed in @xcite . in the scalar approximation",
    "the relationship between the incoming field , @xmath52 , and the outgoing field , @xmath53 , is given by the diffractive huygens integral : @xmath54 where @xmath55 corresponds to the telescope aperture and @xmath56 stands for the optical path length between any two points at dm1 and dm2 : @xmath57 @xmath58 is the free space propagation between the dms : @xmath59    where @xmath60 is the distance between between the two dms , @xmath61 and @xmath62 are the shapes of dm1 and dm2 respectively ( as shown on fig .",
    "[ fig : coordinates ] ) and @xmath23 is the wavelength .",
    "we recognize that two sequential dms act as a pupil remapping unit similar to piaa coronagraph whose ray optics equations were first derived by @xcite .",
    "we briefly state the notation used to describe such an optical system as introduced in @xcite :    * for a given location at dm2 , @xmath63 , the location at dm1 of the incident ray according to ray optics is given by : + @xmath64 * conversely , for a given location at dm1 , @xmath65 , the location at dm2 of the outgoing ray according to geometric optics is given by : + @xmath66 * fermat s principle dictates the following relationships between the remapping functions and the shape of dm1 : + @xmath67 * conversely , if we choose the surface of dm2 to ensure that the outgoing on - axis wavefront is flat , we then find : + @xmath68          in @xcite we showed that one could approximate the propagation integral in eq .",
    "[ huygens ] by taking in a second order taylor expansion of @xmath56 around the rays that trace @xmath69 to @xmath63 . in this case",
    "the relationship between the fields at dm1 and dm2 is :    @xmath70}dx dy \\right \\ }",
    "\\bigg|_{(x_1,y_1 ) } \\label{eq::secondexp}\\ ] ]    when the mirror s deformations are very small compared to both the wavelength and @xmath71 , the net effect of the wavefront disturbance created by dm1 can be captured in @xmath52 and the surface of dm2 can be factored out of eq .",
    "[ huygens ] . in this case",
    "@xmath72 , @xmath73 , @xmath74 , @xmath75 , @xmath76 .",
    "then , eq .  [ eq::secondexp ] reduces to : @xmath77    which is the fresnel approximation .",
    "if moreover @xmath78 , @xmath79 , with @xmath80 , then the outgoing field is to first order : @xmath81 this phase - to - amplitude coupling is a well known optical phenomenon called talbot imaging and was introduced to the context of high contrast imaging by @xcite . in the small deformation regime , the phase on dm1 becomes an amplitude at dm2 according to the coupling in eq .",
    "[ eq::talbot ] .",
    "when two sequential dms are controlled to cancel small amplitude errors , as in @xcite , they operate in this regime . note , however , that the coupling factor scales with wavelength ( the resulting amplitude modulation is wavelength independent , but the coupling scales as @xmath23 ) : this formalism is thus not applicable to our case , for which we are seeking to correct large amplitude errors ( secondary support structures and segments ) with the dms . in practice , when using eq .",
    "[ eq::talbot ] in the wavefront control scheme outlined in @xcite to correct aperture discontinuities , this weak coupling results in large mirror shapes that lie beyond the range of the linear assumption made by the dm control algorithm .",
    "for this reason , methods outlined on the left panel of fig .  [ fig : state ] to correct for aperture discontinuities do not converge to high contrast . because phase to amplitude conversion is fundamentally a very non - linear phenomena , these descending gradient methods @xcite are not suitable to find dm shapes that mitigate apertures discontinuities .",
    "we circumvent these numerical limitations by calculating dms shapes that are based on the full non - linear problem , right panel of fig .",
    "[ fig : state ] .      in the general case , starting from eq .",
    "[ eq::secondexp ] and following the derivation described in  .",
    "[ sec : chrom ] , the field at dm2 can be written as follows :    @xmath82| }    \\int_{\\mathcal{f}\\mathcal{p } }   \\widehat { e_{dm1}}(\\xi,\\eta )   e^{i 2 \\pi ( \\xi f_1+\\eta g_1)}e^{- i\\frac{\\pi \\lambda z}{\\det[j]}\\left ( \\frac{\\partial g_1}{\\partial y } \\xi^2 + \\frac{\\partial f_1}{\\partial x}\\eta^2 \\right ) } \\ ; d\\xi d \\eta \\right \\}\\bigg|_{(x_2,y_2)}\\label{eq::propint}\\ ] ]    where @xmath83 is the fourier transform of the telescope aperture , @xmath84 and stands for the fourier plane .",
    "we call this integral the stretched - remapped fresnel approximation ( sr - fresnel ) .",
    "moreover @xmath85 $ ] is the determinant of the jacobian of the change of variables that maps @xmath63 to @xmath65 : @xmath86 = \\left \\{\\frac{\\partial f_1}{\\partial x}\\frac{\\partial g_1}{\\partial y}- \\left(\\frac { \\partial g_1}{\\partial x}\\right)^2 \\right \\}\\bigg|_{(x_2,y_2)}.\\ ] ] in the ray optics approximation , @xmath87 , the non linear transfer function between the two dms becomes : @xmath88| }",
    "e_{dm1}\\left(f_1,g_1\\right ) \\right \\}\\bigg|_{(x_2,y_2 ) } \\\\ \\left[e_{dm2}(x_2,y_2)\\right]^{2 } & = & \\left \\{\\det[j ] \\left [ e_{dm1}\\left(f_1,g_1\\right ) \\right]^2 \\right \\}\\bigg|_{(x_2,y_2)}\\label{eq::mongeremap}\\end{aligned}\\ ] ] the square form ( e.g eq .  [ eq::mongeremap ] ) of this transfer function can also be derived based on conservation of energy principles and is a generalization to arbitrary geometries of the equation driving the design of piaa coronagraphs @xcite .",
    "a full diffractive optimization of the dm surfaces requires use of the complete transfer function shown in eq .",
    "[ eq::propint ] .",
    "however , there do not exist yet tractable numerical method to evaluate eq .",
    "[ eq::propint ] efficiently enough in order for this model to be included in an optimization algorithm .",
    "moreover even solving the ray optics problem is extremely complicated : it requires to find the mapping function @xmath89 which solves the non - linear partial differential equation in eq .",
    "[ eq::mongeremap ] . substituting for@xmath89 and using eqs .",
    "[ eq : dm2equadiff ] yields a second order non - linear partial differential equation in @xmath62 .",
    "this is the problem that we set ourselves to tackle in the next section , and is the cornerstone of our adpative compensation of aperture discontinuities . as a check",
    ", one can verify that in the small deformation regime ( e.g. if @xmath78 and @xmath79 ) eq .",
    "[ eq::mongeremap ] yields the same phase - to - amplitude coupling as in talbot imaging @xcite .",
    "[ eq::mongeremap ] is a well know optimal transport problem @xcite , which has already been identified as underlying optical illumination optimizations @xcite . while the existence and uniqueness of solutions in arbitrary dimensions have been extensively discussed in the mathematical literature ( see @xcite for a review ) , there was no practical numerical solution published up until recently . in particular , to our knowledge , not even a dimensional solution for which the dm surfaces can be described using a realistic basis - set has been published yet .",
    "we now introduce a method that calculates solutions to eq .",
    "[ eq::mongeremap ] which can be represented by feasible dm shapes .",
    "presents an implicit dependence on the solution @xmath62 . *",
    "bottom * : we circumvent this problem by solving the reverse problem , where the the input beam is now uniform and the implicit dependence drops out",
    ". moreover we taper the edges of the discontinuities by convolving the target field @xmath90 by a gaussian of full width at half maximum @xmath91 ( @xmath92 cycles per aperture in this figure).,width=336 ]",
    "ideally , we seek dm shapes that fully cancel all the discontinuities at the surface of the primary mirror and yield a uniform amplitude distribution , as shown in the top panel of fig .  [",
    "fig : reverse ] .",
    "a solutions for a particular geometry with four secondary support has been derived by @xcite .",
    "it relies on reducing the dimensionality of the problem to the direction orthogonal to the spiders .",
    "it is implemented using a transmissive correcting plate that is a four - faced prism arranged such that the vertices coincides with the location of the spiders .",
    "the curvature discontinuities at the location of the spiders are responsible for the local remapping that removes the spiders in the coronagraph pupil .",
    "however such a solution can not be readily generalized to the case of more complex apertures , where the secondary support structures might vary in width , or in the presence of segment gaps .",
    "moreover it is transmissive and thus highly chromatic .",
    "here we focus on a different class of solutions and seek to answer a different question . how well can we mitigate the effect of pupil discontinuities using dms with smooth surfaces , a limited number of actuators ( e.g a limited maximal curvature ) , and a limited stroke ? under these constraints directly solving eq .  [ eq::mongeremap ] ( e.g. solving the forward problem illustrated in the top panel of fig .  [ fig : reverse ] ) is not tractable as both factors on the left hand side of eq .",
    "[ eq::mongeremap ] depend on @xmath62 .",
    "more specifically , the implicit dependence of @xmath93 on @xmath62 can only be addressed using finite elements solvers , whose solutions might not be realistically representable using a dm .",
    "however this can be circumvented using the reversibility of light and solving the reverse problem , where the two mirrors have been swapped .",
    "indeed , since @xmath94 then we have the following relationship between the determinants of the forward and reverse remappings : @xmath95 we thus focus on the inverse problem , bottom panel of fig .",
    "[ fig : reverse ] , that consists of first finding the surface of @xmath61 as the solution of : @xmath96 ^ 2   \\left [ \\frac{\\partial f_2}{\\partial x}\\frac{\\partial g_2}{\\partial y}- \\left(\\frac { \\partial g_2}{\\partial x}\\right)^2\\right ] \\right \\}\\bigg|_{(x_1,y_1 ) } \\nonumber \\\\ & = & \\left [ e_{dm1}(x_1,y_1 ) \\right]^2 \\end{aligned}\\ ] ] since our goal is to obtain a pupil as uniform a possible we seek a field at dm2 as uniform as possible : @xmath97 moreover we are only interested in compensating asymmetric structures located between the secondary and the edge of the primary .",
    "we thus only seek to find @xmath98 such that : @xmath99 \\ast e^{- \\frac{x^2+y^2}{\\omega^2 } } \\right ) \\big|_{(x_1,y_1)}\\end{aligned}\\ ] ] where @xmath100 is the obscured pupil , without segments or secondary supports . finally , we focus on solutions with a high contrast only up to a finite owa .",
    "we artificially taper the discontinuities by convolving the control term in the monge ampere equation , @xmath101 $ ] , with a gaussian of width @xmath91 .",
    "note that this tapering is only applied when calculating the dm shapes via solving the reverse problem . when the resulting solutions are propagated through eq .",
    "[ eq::mongeremap ] we use the true telescope pupil for @xmath102 .",
    "the parameter @xmath91 has a significant impact on the final post - coronagraphic contrast .",
    "indeed we are here working with a merit function that is based on a pupil - plane residual , while ideally our cost function should be based on image - plane intensity . by convolving the control term in the reverse monge ampere equation , we low pass filter the discontinuities .",
    "this is equivalent to giving a stronger weight to low - to - mid spatial frequencies of interest in the context of exo - planets imaging . for each case presented in  .",
    "[ sec : resuls ] we calculate our dm shapes over a grid of values of @xmath91 which correspond to low pass filters with cutoff frequencies ranging from @xmath103 owa to @xmath104 owa and we keep the shapes which yield the best contrast .",
    "this somewhat ad - hoc approach can certainly be optimized for higher contrasts .",
    "however such an optimization is beyond the scope of the present manuscript .    ,",
    "@xmath105 , @xmath106 , where @xmath107 , @xmath18 is the aperture diameter and @xmath60 the separation between dms .",
    "we solve monge ampere equation in normalized coordinates and then apply the scalings in order to find the true dm shapes.,width=336 ]    the problem we are seeking to solve is illustrated in the second panel of fig .",
    "[ fig : reverse ] . in this configuration the full second order monge ampere equation can be written as : @xmath108 where we have dropped the @xmath65 dependence for clarity .",
    "since we are interested in surface deformations which can realistically be created using a dm , we seek for a fourier representation of the dms surface : @xmath109 with @xmath110 , where @xmath111 is the limited number of actuators across the dm . note",
    "that we have normalized the dimensions in the pupil plane @xmath112 , @xmath113 .",
    "the normalized second order monge ampere equation is then : @xmath114 for each configuration in this paper we first solve eq .",
    "[ eq::normma ] and then transform the normalized solution in physical units , which depends on the dms diameter @xmath18 and their separation @xmath60 .      over the past few years a number of numerical algorithms aimed at solving eq .",
    "[ eq::normma ] have emerged in the literature @xcite . here",
    "we summarize our implementation of two of them : an explicit newton method @xcite , and a semi - implicit method @xcite .",
    "we do not delve into the proof of convergence of each method , they can be found in @xcite . note that @xcite discussed both approaches in a cosmological context and devised fourier based solutions .",
    "here we are interested in a two dimensional problem and we outline below the essence of each algorithm .",
    "this method was first introduced by @xcite and relies on the fact that eq .",
    "[ eq::normma ] can be re - written as @xmath116 = \\det[id+\\mathcal{h}(h_1(x , y))]\\ ] ] where @xmath117 is the two dimensional hessian of a scalar field and @xmath118 the identity matrix . if one writes @xmath119 with @xmath120 then",
    ":    @xmath121 = \\det[id+\\mathcal{h}(u ) ] + \\delta \\ ;   tr\\left [ \\left (   id+\\mathcal{h}(u)\\right)^{\\dagger^t } \\mathcal{h}(v )   \\right ] + o(\\delta^2)\\ ] ]    where @xmath122 denotes the transpose of the comatrix .",
    "[ eq::normma ] can thus be linearized as : @xmath123 \\right ) \\label{eq : linearizedma}\\ ] ] the explicit newton algorithm relies on eq .",
    "[ eq : linearizedma ] and can then be summarized as carrying out the following iterations :    * choose a first guess @xmath124 .",
    "* at each iteration @xmath33 we seek for a solution of the form @xmath125 , where @xmath126 is the dm shape update .",
    "* in order to find @xmath126 we write : @xmath127 \\right)\\end{aligned}\\ ] ] and solve @xmath128 eq .  [ eq : linloeper ] is a linear partial differential equation in @xmath126 .",
    "since we are interested in a solution which can be expanded in a fourier series we write @xmath126 as : @xmath129 both the right hand side and the left hand side of eq .",
    "[ eq : linloeper ] can be written as a fourier series , with a spatial frequency content between @xmath130 and @xmath111 cycles per aperture .",
    "equating each fourier coefficient in these two series yields the following linear system of @xmath131 equations with @xmath132 unknowns .",
    "@xmath133 \\mbox { : } \\int_{dm } e^{i 2 \\pi ( m_0 x+n_0 y ) } \\left [ l_{e } ( h_1^{k},v^{k } )   - r_{e } ( h_1^{k } ) \\right ]   dx \\;dy   = 0   \\label{eq : inverseloeper}\\ ] ] when searching for @xmath126as a fourier series over the square geometry chosen here , this inverse problem is always well posed .",
    "* update the solution @xmath134    the convergence of this algorithm relies on the introduction of a damping constant @xmath135 .",
    "@xcite showed that as long as @xmath136 remains convex , which is always true for acad with reasonably small aperture discontinuities , there exists a @xmath137 large enough so that this algorithm converge towards a solution of eq .",
    "[ eq::normma ] .",
    "however since this algorithm is gradient based , it is not guaranteed that it converges to the global minimum of the underlying non - linear problem . in order to avoid having this solver stall in a local minimum",
    "we follow the methodology outlined by @xcite and first carry out a series of implicit iterations to get within a reasonable neighborhood of the global minimum .",
    "this algorithm , along with its convergence proof , is thoroughly explained in @xcite .",
    "it relies on rewriting eq .",
    "[ eq::normma ] as : @xmath138 ^ 2 + 2 a(x , y)^2}\\ ] ]    the implicit method consists of carrying out the following iterations :    * choose a first guess @xmath124 * in order to find @xmath139 we write : @xmath140 ^ 2 + 2 a(x , y)^2 } \\nonumber\\end{aligned}\\ ] ] and solve @xmath141 this problem is a linear system of @xmath132 equations with @xmath132 unknowns and can be solved using projections on a fourier basis : @xmath133 \\mbox { : } \\int_{dm } e^{i 2 \\pi ( m_0 x+n_0 y ) } \\left [ l_{i } ( h_1^{k},v^{k } )   - r_{i } ( h_1^{k } ) \\right ]   dx \\;dy   = 0   \\label{eq : inversepoisson}\\ ] ] note that the term under the square root in @xmath142 is guaranteed to be positive at each iteration . *",
    "iterate over @xmath33    the inverse problem in eq .",
    "[ eq : inversepoisson ] is _ always _ well posed , for any basis set or pupil geometry , while the explicit newton method runs into convergence issues when not using a fourier basis over a square . when seeking to use a basis set that is more adapted to the geometry of the spiders and segments or when using a trial influence function basis for the dm , the implicit method is the most promising method . in this paper",
    "we have limited our scope to solving the reverse problem in the bottom panel of fig .",
    "[ fig : reverse ] , and used a fourier representation for the dm , we are able to use both methods . in order to make sure that the algorithm converges towards the true solution of eq .  [ eq::normma ]",
    "we first run a few tens of iterations of the implicit method and , once it has converged , we seek for a more accurate solutions using the newton algorithm .",
    "typical results are shown in fig .",
    "[ fig : results ] where most of the residual error resides in the high spatial frequency content ( e.g. above @xmath111 cycles per aperture ) .",
    "our solutions are limited by the non- optimality of the fourier basis to describe the mostly radial and azimuthal structures present in telescopes s apertures .",
    "moreover the dm shape is the result of the minimization of a least squares residual in the virtual end - plane of the reverse problem , with little regard to the spatial frequency content of the solution in the final image plane of the coronagraph . while this method yields significant contrast improvements , as reported in  .",
    "[ sec : resuls ] , we discuss in  .",
    "[ sec : discuss ] how it can be refined for higher contrast .",
    ", @xmath143 , @xmath144 , @xmath145 .",
    "the remapping function obtained with our solutions are very close to these theoretical boundary conditions and the residuals can easily be mitigated by sacrificing the edge rows and columns of actuators on each dm.,width=336 ]      once the surface of dm1 has been calculated as a solution of eq .",
    "[ eq::mongeremap ] , we compute the surface of dm2 based on eqs .  [",
    "eq : dm2equadiff ] , which stem from enforcing flatness of the outgoing on - axis wavefront .",
    "we seek a fourier representation for the surface of dm2 : @xmath146 plugging the solution found in the previous step for @xmath61 into eqs .",
    "[ eq : dm1equadiff ] yields a closed form for the normalized remapping functions , @xmath147 : @xmath148 then the normalized version of eqs .",
    "[ eq : dm2equadiff ] can be rewritten as : @xmath149",
    "we then multiply each side of eq .",
    "[ eq : invremap1 ] and eq .",
    "[ eq : invremap2 ] by : @xmath150 \\nonumber\\ ] ] where @xmath151 corresponds to a given dm spatial frequency .",
    "integrating over the square area of the dm and using the orthogonality of the fourier basis yields the following system of @xmath152 equations with @xmath132 real unknowns : @xmath153   e^{i 2 \\pi ( m_0 f_2(x , y )   + n_0 f_2(x , y ) ) } \\ ; dx dy \\nonumber \\\\ & & \\mbox { for all } \\ ; ( m_0,n_0 ) \\mbox { : } \\nonumber \\\\   & & i 2 \\pi i \\ ;   n_0 b_{m_0,n_0 } = \\int_{dm } r_{x}(x , y ) \\det[id + \\mathcal{h } ( h_1^{k}(x , y ) ) ]   e^{i 2 \\pi ( m_0 f_2(x , y )   + n_0 f_2(x , y ) ) } \\ ; dx dy \\nonumber\\end{aligned}\\ ] ] we then find @xmath154 , the normalized surface of dm2 , by solving this system in the least squares sense .    once the monge ampere equation has been solved , the calculation of the surface of the second mirror is a much easier problem .",
    "indeed , by virtue of the conservation of the on - axis optical path length , finding the surface of dm2 only consists of solving a linear system ( see @xcite ) .    , @xmath155 , @xmath156 , @xmath157 .",
    "the remapping function obtained with our solutions are very close to these theoretical boundary conditions and the residuals can easily be mitigated by sacrificing the edge rows and columns of actuators on each dm.,width=336 ]      the method described above does not enforce any boundary conditions associated with eq .",
    "[ eq::normma ] .",
    "one practical set of boundary conditions consists of forcing the edges of each dm to map to each other : @xmath158 with @xmath159 .",
    "these correspond to a set of neumann boundary conditions in @xmath160 and @xmath161 .",
    "these boundary conditions can be enforced by augmenting the dimensionality of the linear systems on eq .",
    "[ eq : inverseloeper ] and eq .",
    "[ eq : inversepoisson ] , however doing so increases the residual least squares errors and thus hampers the contrast of the final solution",
    ". moreover fig .",
    "[ fig : bcx ] and fig .",
    "[ fig : bcy ] show that , because of the one to one remapping near the dm edges in the control term of the reverse problem , the boundary conditions are almost met in practice . for the remainder of this paper",
    "we thus do not include boundary conditions when calculating the dm shapes , when solving for @xmath160 in eq .",
    "[ eq::normma ] since , in the worse case , only the edge rows and columns of the dms actuator will have to be sacrificed in order for the edges to truly map to each other .      for a given pupil geometry we have calculated @xmath162 .",
    "we then convert the dm surfaces to real units , @xmath163 , by multiplication with @xmath71 .",
    "we evaluate the remapping functions using eqs .",
    "[ eq : dm1equadiff ] and [ eq : dm2equadiff ] and obtain the field at the entrance of the coronagraph in the ray optic approximation    @xmath164 } e_{dm1}\\left(f_1,g_1\\right ) e^{i \\frac{2 \\pi } { \\lambda } \\left ( s(f_1,g_1 )",
    "+ h_{1}(f_1,g_1 ) - h_{2 } \\right ) } \\right \\}\\bigg|_{(x_2,y_2 ) } \\label{eq : remappedfield}\\ ] ]    where the exponential factor corresponds to the optical path length through the two dms .",
    "even if the surface of the dms has been calculated using only a finite set of fourier modes , we check that the optical path length is conserved .",
    "[ fig : repammedjwstpupil ] shows that since the curvature of the dms is limited by the number of modes @xmath111 , our solution does not fully map out the discontinuities induced by the secondary supports and the segments .",
    "however , they are significantly thinner and one can expect that their impact on contrast will be attenuated by orders of magnitude . in order to quantify the final coronagraphic contrasts of our solution",
    "we then propagate it through an aplc coronagraph designed using the method in  .",
    "[ sec : centralobsc ] . in the case of a hexagon based primary ( such as jwst ) , we use a coronographic apodizer with a slightly oversized secondary obscuration and undersize outer edge in order to circularize the pupil . note that this choice is mainly driven by the type of coronagraph we chose in  .",
    "[ sec : centralobsc ] to illustrate our technique .",
    "since the dm control strategy presented in this section is independent of the coronagraph , it can be generalized to any of the starlight suppression systems which have been discussed in the literature .",
    "for succinctness we present our results using coronagraph solely based on using pupil apodization ( either in an aplc or in a piaac configuration ) .",
    "results for a jwst geometry are shown on fig .",
    "[ fig : resultsjwst ] and fig .",
    "[ fig : slicesjwst ] and discussed in  .",
    "[ sec : resuls ] .",
    "[ eq : remappedfield ] assumes that the propagation between the two dms occurs according to the laws of ray optics . in the next section",
    "we derive the actual diffractive field at dm2 , e.g eq .",
    "[ eq::propint ] , and show that in the pupil remapping regime of acad , edge ringing due to the free space propagation is actually smaller than in the fresnel regime .",
    "acad is based on ray optics .",
    "it is an inherently broadband technique , and provided that the coronagraph is optimized for broadband performance acad will provide high contrast over large spectral windows .",
    "however , when taking into account the edge diffraction effects that are captured by the quadratic integral in eq .  [ eq::propint ] , the true propagated field at dm2 becomes wavelength dependent . more specifically , when @xmath23 is not zero then the oscillatory integral superposes on the ray optics field a series of high spatial frequency oscillations . in theory",
    ", it would be best to use this as the full transfer function to include chromatic effects in the computation of the dms shapes .",
    "however , as discussed in s.  [ sec : madm ] , solving the non - linear monge - ampere equation is already a delicate exercise , and we thus have limited the scope of this paper to ray optics solutions .",
    "nonetheless , once the dms shapes have been determined using ray optics , one should check whether or not the oscillations due to edge diffraction will hamper the contrast .",
    "this approach is reminiscent of the design of piaa systems where the mirror shapes are calculated first using geometric optics and are then propagated through the diffractive integral in order to check a posteriori whether or not the chromatic diffractive artifacts are below the design contrast @xcite . in this section",
    "we detail the derivation of eq .",
    "[ eq::propint ] that is the diffractive integral for the two dms remapping system and use this formulation to discuss the diffractive properties of acad .",
    "we start with the expression of the second order diffractive field at dm2 as derived in @xcite , eq .  [ eq::secondexp ]",
    ". @xmath165}dx dy   \\right \\}\\big|_{(x_1,y_1)}\\nonumber\\ ] ] we write @xmath166 as its inverse fourier transform @xmath167    and insert this expression in eq .",
    "[ eq::secondexp ] . completing the squares in the quadratic exponential factor",
    "then yields : @xmath168}e^{- i \\pi \\lambda z \\left ( \\frac{\\partial f_2}{\\partial y}|_{(f_1,g_1 ) }",
    "\\xi^2 + \\frac{\\partial g_2}{\\partial x}|_{(f_1,g_1 ) } \\eta^2 \\right ) }   \\ ; d \\xi d",
    "\\eta \\right \\}\\bigg|_{(x_2,y_2)}\\ ] ] with @xmath169 } dx dy \\right \\}\\bigg|_{(x_1,y_1)}.\\ ] ]    the integral over space , @xmath170 , is the integral of a complex gaussian and can be evaluated analytically .",
    "this yields : @xmath171}e^{- i \\pi \\lambda z \\left ( \\frac{\\partial f_2}{\\partial y}\\xi^2 + \\frac{\\partial g_2}{\\partial x } \\eta^2 \\right ) } d \\xi d \\eta \\right \\}\\bigg|_{(x_1,y_1)}.\\ ] ] we thus have expressed @xmath53 as a function of @xmath172 . this expression can be further simplified : using eqs .",
    "[ eq : x2self ] to [ eq : remapunity ] one can derive @xmath173 } \\frac{\\partial g_1}{\\partial y}|_{(x_2,y_2 ) } $ ] and @xmath174}\\frac{\\partial f_1}{\\partial x}|_{(x_2,y_2)}$ ] . which finishes to prove eq .",
    "[ eq::propint ] : @xmath82| }    \\int_{\\mathcal{f}\\mathcal{p } }   \\widehat { e_{dm1}}(\\xi,\\eta )   e^{i 2 \\pi ( \\xi f_1+\\eta g_1)}e^{- i\\frac{\\pi \\lambda z}{\\det[j]}\\left ( \\frac{\\partial g_1}{\\partial y } \\xi^2 + \\frac{\\partial f_1}{\\partial x}\\eta^2 \\right ) } \\ ; d\\xi d \\eta \\right \\}\\bigg|_{(x_2,y_2)}\\ ] ] this expression is very similar to a modified fresnel propagation and can be rewritten as such : @xmath175 } { \\lambda z } \\left ( ( \\frac{\\partial g_1}{\\partial y})^{-1 }   ( x - f_1)^2 + ( \\frac{\\partial f_1}{\\partial x})^{-2}(y - g_1)^2 \\right ) } \\ ; dx d y \\right \\}\\bigg|_{(x_2,y_2)}\\ ] ] because of this similarity we call this integral the stretched- remapped fresnel approximation ( sr - fresnel ) .",
    "indeed in this approximation the propagation distance is stretched by @xmath176},\\frac{\\frac{\\partial f_1}{\\partial x } } { det[j]})$ ] and the integral is centered around the remapped pupil @xmath89 .",
    "the integral form provides physical insight about the behavior of the chromatic edge oscillations .",
    "if we write @xmath177 } { \\frac{\\partial g_1}{\\partial y}}\\bigg|_{(x_2,y_2 ) } \\\\ \\gamma_{y } = \\frac { det[j ] } { \\frac{\\partial f_1}{\\partial x}}\\bigg|_{(x_2,y_2)}\\end{aligned}\\ ] ] we can identify a several diffractive regimes :    1 .   when @xmath178 the @xmath53 reduces to a simple fresnel propagation .",
    "edge ringing can them be mitigated using classical techniques such as pre - apodization , or re - imaging into a conjugate plane using oversized relay optics .",
    "when @xmath179 then it is as if the effective propagation length through the remapping unit was _ increased_. this magnifies the edge chromatic ringing .",
    "when @xmath180 then it is as if the effective propagation length through the remapping unit was _ decreased_. this damps the edge chromatic ringing .",
    "when @xmath181 and @xmath182 , e.g. at a saddle point in the dm surface , then it is as if the effective propagation length through the remapping unit was _ decreased _ in one direction and _ increased _ in the other .",
    "the edge chromatic ringing can either be damped or magnified depending on the relative magnitude of @xmath183 and @xmath184 .    in the case of a piaa coronagraphs ,",
    "the mirror shapes are such that @xmath180 at the center of the pupil and @xmath185 at the edges of the pupil , where the discontinuities occur . as a consequence",
    "the edge oscillations are largely magnified when compared to fresnel oscillations ( see right panel of fig .",
    "[ fig : propcurvatures ] ) , and apodizing screens are necessary in order to reduce the local curvature of the mirror s shape ( as also discussed in @xcite ) . in the case of acad , where the x - axis is chosen to be perpendicular to the discontinuity",
    ", the surface curvature is such that @xmath186 , @xmath187 at the discontinuities inside the pupil and @xmath186 , @xmath188 elsewhere .",
    "this yields damped chromatic oscillations at the remapped discontinuities and fresnel oscillations at the edges of the pupil ( see right panel of fig .",
    "[ fig : propcurvatures ] ) . note that fig .",
    "[ fig : propcurvatures ] was generated using a one dimensional toy model that assumes eq .",
    "[ eq::propint ] is separable , e.g @xmath189 , as described in @xcite . in practice at the saddle points of the optical surfaces , near the junction of two spiders for instance , @xmath190 , @xmath191 and",
    "thus our separable model does not guarantee than in the true 2d case chromatic edge oscillations might not be locally amplified .",
    "however even near the saddle points acad provides a strong converging remapping in the direction perpendicular to the discontinuity and very little diverging re - mapping in the other direction . as a consequence @xmath192 and @xmath184 is smaller than but close to one .",
    "we thus predict that even at these locations chromatic ringing will not be amplified .",
    "even if acad based on pupil remapping , its diffraction properties are qualitatively very different from piaa coronagraphs since edge ringing is not amplified beyond the fresnel regime at the pupil edges , and is attenuated near the discontinuities .",
    "we conclude that in most cases acad operates in a regime where edge chromatic oscillations are not larger than classical fresnel oscillations , and sometimes actually smaller . as a consequence the chromaticity of this ringing",
    "can be mitigated using standard techniques developed in the fresnel regime and we do not expect this phenomenon to be a major obstacle to acad broadband operations .          .",
    "[ fig : resultsjwst ]    we have established that the diffractive chromatic oscillations introduced by the fact that dm1 and dm2 are not located in conjugate planes is no worse than classical fresnel ringing from the aperture edges and can be mitigated using well - know techniques which have been developed for this regime . while a quantitive tradeoff study of how to design a high contrast instrument which minimizes such oscillations regime is beyond the scope of this paper , we briefly remind their qualitative essence to the reader :    * the edges of the discontinuities in the telescope aperture can be smoothed via pupil apodization before dm1 .",
    "this solution is not particularly appealing as it requires the introduction of a transmissive , and thus dispersive , component in the optical train . *",
    "the distance between the two dms can be reduced .",
    "indeed the dms deformations presented herein , for @xmath193 cm dms separated by @xmath3 m , are all @xmath194 m while current technologies allow for deformations of several microns .",
    "as the edge ringing scales as @xmath195 chromatic oscillations will be reduced by decreasing @xmath60 . since the dm surfaces scale as @xmath71 reducing @xmath60 will increase the dm deformations but have little impact on the feasibility of our solution as current dm technologies can reach @xmath196 m strokes . *",
    "the coronagrahic apodizer can be placed in a plane that is conjugate to the dm1 .",
    "this can be achieved by re - imaging dm2 through a system of oversized optics ( the over - sizing factor increases steeply when the pupil diameter decreases ) . by definition",
    "there are no fresnel edge oscillations in such a plane",
    ". alternatively a coronagraph without a pupil apodization ( amplitude or phase mask in the image plane ) can be used , and in this configuration it is only sufficient for the optics to be oversized .",
    "note that these three solutions are not mutually exclusive and that only a full diffractive analysis , which uses robust numerical propagators that have been developed based on eq .",
    "[ eq::propint ] , can quantitatively address the trade - offs discussed above .",
    "the development of such propagators is our next priority .",
    "in @xcite we laid out the theoretical foundations of such a numerical tool in the case of circularly symmetric pupil remapping and this solution has been since then practically implemented , as reported by @xcite . generalizing this method to a tractable propagator in the case of arbitrary remapping",
    "is a yet unsolved computational problem . in the meantime",
    "we emphasize that while the spectral bandwidth of coronagraphs whose incoming amplitude has been corrected using acad will certainly be limited by edge diffraction effects , but these effects are _ no worse than fresnel ringing _ and can thus be mitigated using optical designs which are now routinely used in high contrast instruments ( see @xcite for such discussions ) .",
    "for the remainder of this paper we thus assume the diffractive artifacts have been adequately mitigated and we compute our results assuming a geometric propagation between dm1 and dm2 .",
    "m , well within the stroke limit of current dm technologies .",
    "acad yields a gain in contrast of two orders of magnitude , and provides contrasts levels similar to upcoming ex - ao instruments , which are designed on much friendlier apertures geometries .",
    "since acad removes the bulk of the light diffracted by the asymmetric aperture discontinuities , the final contrast can be improved by controlling the dms using and image plane based cost function , see fig .",
    "[ fig : wavecontrolacad],width=336 ]    .",
    "[ fig : slicesjwst ]",
    "we have illustrated each step of the calculation of the dm shapes in  .",
    "[ sec : madm ] using a geometry similar of jwst .",
    "this configuration is somewhat a conservative illustration of an on - axis segmented telescope as it features thick secondary supports and a `` small '' number of segments whose gaps diffract light in regions of the image plane close to the optical axis ( the first diffraction order of a six hexagons structure is located at @xmath197 ) . in order to assess the performances of acad on such an observatory architecture we chose to use a coronagraph designed around a slightly oversized secondary obscuration of diameter @xmath198 , with a focal plane mask of diameter @xmath199 , an iwa of @xmath48 and an owa of @xmath200 .",
    "the field at the entrance of the coronagraph after remapping by the dms is shown on the top right panel of fig .",
    "[ fig : resultsjwst ] . the dm surfaces , calculated assuming 64 actuators across the pupil ( @xmath201 in the fourier expansion ) and dms of diameter @xmath193 cm separated by @xmath202 m , are shown on the middle panel of fig .",
    "[ fig : resultsjwst ] .",
    "they are well within the stroke limit of current dm technologies .",
    "the surfaces were calculated by solving the reverse problem over an even grid of 10 cutoff low - pass spatial frequencies ranging between @xmath5 and @xmath203 cycles per apertures for the tapering kernel @xmath91 .",
    "the value yielding the best contrast was chosen .",
    "note that the optimal cutoff frequency depends on the spatial scale of the discontinuities , and that higher contrasts could be obtained by choosing a set of two convolution kernels for the reverse problem and finding the optimal solution using a finer grid .",
    "however , the results in the bottom row of fig .  [ fig : resultsjwst ] are extremely promising .",
    "[ fig : slicesjwst ] shows a contrast improvement of a factor of @xmath204 when compared to the raw coronagraphic psf , which is quite remarkable for an algorithm which is not based on an image - plane metric .",
    "these results illustrate that even with a very unfriendly aperture similar to jwst one can obtain contrasts as high as envisioned for upcoming ex - ao instruments , which have been designed for much friendlier apertures .",
    "while we certainly do not advocate to use such a technique on jwst , this demonstrates that acad is a powerful tool for coronagraphy with on - axis segmented apertures .",
    "m , well within the stroke limit of current dm technologies .",
    "the final contrast is below @xmath205 , in a regime favorable for direct imaging of exo - planets with elts .",
    "since acad removes the bulk of the light diffracted by the asymmetric aperture discontinuities , the final contrast can be enhanced by controlling the dms using and image plane based metric.,width=336 ]          we now discuss the case of extremely large telescopes and provide an illustration using the example of the thirty meter telescope .",
    "we considered the aperture geometry shown on the top left panel of fig .",
    "[ fig : resultstmt ] .",
    "it consists of a pupil 37 segments across in the longest direction and a secondary of diameter @xmath206 which is held by three main thick struts and six thin cables . as seen on the bottom left panel of fig .",
    "[ fig : resultstmt ] the impact of segment gaps is minor as they diffract light beyond the owa of the coronagraph .",
    "when using a coronagraph with a larger owa the segment gaps will have to be taken into account , and will have to be mitigated using dms with a larger number of actuators . in order to obtain first order estimates of the performances of acad on the aperture geometry shown on the top left panel of fig .",
    "[ fig : resultstmt ] , we chose to use a coronagraph designed around a slightly oversized secondary obscuration of diameter @xmath207 , with a focal plane mask of @xmath208 diameter , an iwa of @xmath46 and an owa of @xmath200 .",
    "the field at the entrance of the coronagraph after remapping by the dms is shown on the top right panel of fig .",
    "[ fig : resultstmt ] .",
    "the dm surfaces , calculated assuming 64 actuators across the pupil ( @xmath201 in the fourier expansion ) and dms of diameter @xmath193 cm separated by @xmath202 m , are shown on the middle panel of fig .",
    "[ fig : resultstmt ] .",
    "they are well within the stroke limit of current dm technologies .",
    "the surfaces were calculated by solving the reverse problem over an even grid of 10 cutoff low - pass spatial frequencies ranging between @xmath5 and @xmath203 cycles per apertures for the tapering kernel @xmath91 .",
    "the value yielding the best contrast was chosen .",
    "the final psf is shown on the bottom right panel of fig .",
    "[ fig : resultstmt ] and features a high contrast dark hole with residual diffracted light at the location of the spiders diffraction structures .",
    "the impact on coronagraphic contrast of secondary supports was thoroughly studied by .",
    "they concluded that under a @xmath209 strehl ratio , the contrast in most types of coronagraphs is driven by the secondary support structures to levels ranging from @xmath210 to @xmath211 .",
    "this , in turn , leads to a final contrast after post - processing ( called differential imaging ) of @xmath212 .",
    "[ fig : slicestmt ] shows that using acad on an elt pupil yields contrasts _ before any post - processing _ which are comparable to the ones obtained by after differential imaging .",
    "this demonstrates that should two sequential dms be integrated into a future planet finding instrument , setting their surface deformation according to the methodology presenting above would allow this instrument to perform its scientific program at a very high contrast .",
    "moreover the surface of the dms could be adjusted to mitigate for the effect of missing segments at the surface of the primary ( when for instance the telescope is operating while some segments are being serviced ) .",
    "greater than in the tmt example shown on fig .",
    "[ fig : resultstmt ] .",
    "as the spiders get thinner their impact on raw contrast becomes lesser and the starlight suppression after dm correction becomes greater . in the @xmath213 spiders example , at large separations , the average contrast is an order of magnitude higher than reported on fig .",
    "[ fig : slicestmt].,width=336 ]    in the case of elts with large number of small segments ( when compared to the aperture size ) , gaps diffract light far from the optical axis ( see fig .  [",
    "fig : resultstmt ] for an example ) .",
    "the secondary support structures are then the major source of unfriendly coronagraphic diffracted light . under the assumption that thick structures are necessary to support the heavy secondary over the very large elt pupils",
    ", one can use the aperture area covered by the spiders as a proxy of the secondary lift constraint .",
    "we have thus explored a series of geometries for which the number of spiders increases as they get thinner while the overall area covered by the secondary support structures remains constant . in the examples shown from fig .",
    "[ fig : resultsarea1 ] to fig .",
    "[ fig : slicesarea2 ] , the area covered by the secondary support structures is @xmath214 times greater than in the tmt geometry discussed above . in all cases",
    "we used a coronagraph with a central obscuration of @xmath215 , with a focal plane mask of @xmath208 diameter , and iwa of @xmath46 and an owa of @xmath200 .",
    "the surfaces were calculated by solving the reverse problem over an even grid of 10 cutoff low - pass spatial frequencies ranging between @xmath5 and @xmath203 cycles per apertures for the tapering kernel .",
    "the value yielding the best contrast was chosen .",
    "this exercise leads to several conclusions pertaining to the performances of acad with various potential elt geometries .",
    "the top two panels of fig .",
    "[ fig : resultsarea1 ] illustrate the importance of the clocking of the spiders with respect to the dms actuator grid ( or the fourier grid in our case ) .",
    "when the secondary support structures are clocked by @xmath216 with respect to the dm actuators they are much more attenuated by acad , thus yielding higher contrast .",
    "this is an artifact of the fourier basis set chosen and would be mitigated by using dms whose actuator placement presents circular and azimuthal symmetries @xcite .",
    "* annulus in the psf with a large number of spiders *    when the number of secondary support struts becomes very large ( @xmath217 ) , an interesting phenomena occurs in the raw psf : the spiders diffract light outside an annulus of radius @xmath218 , just as spiderweb masks do in the case of shaped pupil coronagraphs @xcite .",
    "the `` bump '' located beyond that spatial frequency is more difficult to attenuate using the dms ( see fig .  [",
    "fig : resultsarea1 ] for an illustration ) .",
    "acad creates small ripples at the edges of the remapped discontinuities and when too many discontinuities are in the vicinity of each other , then these ripples interfere constructively and hamper the starlight extinction level yielded by acad .",
    "* a lot of thin spiders is more favorable than a few thick spiders *    in general decreasing the width of the spiders while increasing their number is beneficial to the contrast obtained after acad as illustrated on the radial averages on fig .",
    "[ fig : slicesarea1 ] and fig .",
    "[ fig : slicesarea2 ] .",
    "when one increases the number of spiders while decreasing their width in a classical coronagraph , the peak intensity of the diffraction pattern of one spider decreases as the squared width of the spider .",
    "the radially averaged contrast improvement without acad is then somewhat lesser than the square of the spider thinning factor as it is mitigated by the increasing number of spiders .",
    "when using acad the spiders are seen by the coronagraph as much thinner than they actually are",
    "( by a factor @xmath137 ) and thus the peak intensity of their diffraction pattern is lower by a factor of @xmath219 .",
    "our numerical experiments show that @xmath137 increases when the spider width decreases . as consequence ,",
    "the overall contrast gain after acad when decreasing the width of the spiders while increasing their number is greater than in the case of a classical coronagraph . when designing elt secondary support structures and planning to correct for them using acad , increasing the number of spiders to 8 or even 12 has a beneficial impact on contrast as it enables each discontinuity to become thinner and thus to be corrected to higher contrast using the dms .",
    "the psfs of apertures with more than 12 spiders present diffraction structures which are poorly suited for correction with square dms . while the contrast resulting from applying acad to such apertures is still a decreasing function of the number of spiders , fig .",
    "[ fig : slicesarea2 ] shows that the net contrast gain brought by the dm based remapping is smaller than in the more gentle cases of 12 spiders .",
    "the study presented on fig .",
    "[ fig : resultsarea1 ] to fig .",
    "[ fig : slicesarea2 ] remains to be fully optimized for each potential design of an elt planet finding instrument ( in particular using a finer grid of cutoff spatial frequencies ) .",
    "it however demonstrates the flexibility of acad for various aperture geometries and provides a first order rule of thumb to design telescope apertures which are friendly to direct imaging of exo - planets : `` a lot of thin spiders is more favorable than a few thick spiders '' . in practice",
    "the number of spiders will be limited by effects not treated in our analysis such as the mechanical rigidity , requirements on the perfection of their periodic spacing and glancing reflections from the sides of multiple spiders .",
    "we thus advocate that , should future elts be built with high contrast exo - planetary science as a main scientific driver , then such effect ought to be thoroughly analyzed as a large numbers of thin spiders is more favorable from a contrast standpoint when using acad to mitigate for pupil amplitude asymmetries .",
    "greater than in the tmt example shown on fig .",
    "[ fig : resultstmt ] . with a large number of spiders",
    "the bright ring in the psf structure located at @xmath220 is difficult to correct with acad .",
    "however since the spiders becomes thinner its net effect on contrast after acad remains small.,width=336 ]          when discussing the case of jwst we stressed the complexity associated with the optimization of acad in the presence of aperture discontinuities of varying width .",
    "carrying out such an exercise would be extremely valuable to study the feasibility of the direct imaging of exo - earth with an on - axis segmented future flagship observatory such as atlast @xcite .",
    "however , such an effort is computationally heavy and thus beyond the scope of the present paper , which focuses on introducing the acad methodology and illustrating using key basic examples .    so far , none of the examples in this manuscript demonstrate that acad can yield corrections all the way down to the theoretical contrast floor that is set by the coronagraph design .",
    "when seeking to image exo - earths from space , future missions will need to reach this limit . in order to explore this regime",
    ", we conducted a detailed study of an hypothetical on - axis monolithic telescope with four secondary support struts . to establish the true contrast limits we varied the thickness of the spiders and for each geometries .",
    "the surfaces were calculated by solving the reverse problem over an even grid of 70 cutoff low - pass spatial frequencies ranging between @xmath5 and @xmath203 cycles per apertures for the tapering kernel .",
    "the value yielding the best contrast was chosen . in all cases",
    "we used a coronagraph with a central obscuration of @xmath215 , with a focal plane mask of @xmath208 diameter , and iwa of @xmath46 , and an owa of @xmath200 . note that when using coronagraphs relying on pupil apodization these results can be readily generalized to larger circular secondary obscurations , at a loss in iwa ( as shown on fig .",
    "[ fig : corono ] ) .",
    "moreover we clocked the telescope aperture by @xmath216 with respect to the grid of fourier modes .",
    "we found that , indeed , the theoretical contrast floor set by the coronagraph design is met for thin spiders ( @xmath221 ) and it is very close to be met for spiders only half the thickness of the the ones currently equipping the hubble space telecope ( @xmath222 ) , see fig .",
    "[ fig : resultsthickness ] and fig .",
    "[ fig : slicesthickness ] . even in the case of thick struts ( @xmath223 )",
    "we find contrasts an order of magnitude higher than in the similar configuration on the top panel of fig .",
    "[ fig : slicesarea1 ] , due to our thorough optimization of the cutoff frequency of the tapering kernel and careful clocking of the aperture with respect to the actuators .",
    "on - axis telescopes are thus a viable option to image earth - analogs from space : their secondary support structures can be corrected down to contrast levels comparable to the target contrast of recent missions concept studies @xcite . since the baseline wavefront control architecture for future space coronagraphs relies on two sequential dms , acad does not add any extra complexity to such missions and merely consists of controlling the dms in order to optimally compensate for the effects of asymmetric aperture discontinuities .",
    "was optimized on a very fine grid and the aperture we clocked in a favorable direction with respect to the fourier basis .",
    "even for spiders as thick as @xmath224 of the telescope aperture the designed contrast of the coronagraph is retrieved.,width=336 ]",
    "because acad relies on deforming the dms surfaces in an aspherical fashion , off - axis wavefronts seen through the two dms apparatus will be distorted , just as in a piaa coronagraph @xcite .",
    "however the asphericity of the surfaces in the case of acad operating on reasonably thin discontinuities , is much smaller than in a piaa remapping unit .",
    "[ fig : offaxispsfs ] shows the impact on off - axis psfs of such a distortion in the worse - case scenario of a geometry similar to jwst .",
    "we demonstrate that most of the flux remains in the central disk of radius @xmath225 for all sources in the field of view of the coronagraphs considered here ( all the way to @xmath5 cycles per capture ) .",
    "we conclude that , because of the small deformations of the dms , psf distortion will not be a major hindrance in exo - planet imaging instruments whose dms are controlled in order to mitigate for discontinuities in the aperture .",
    "so far we have treated primary mirrors segmentation as a pure amplitude effect . in reality",
    "the contrast floor in segmented telescopes will be driven by both phase and amplitude discontinuities : here we explore the impact of phase errors and discontinuities occurring before two dms whose surfaces have been set using acad .",
    "there are two main phenomena to be considered .",
    "the first is the conversion of the incident wavefront phase before dm1 : @xmath226 into amplitude at the second mirror .",
    "the second is the projection of this wavefront phase into a remapped phase errors at dm2 : @xmath227 .",
    "since the remapping unit is designed using deformable mirrors , both dm1 and dm2 a complete correction could be attained in principle .",
    "however , the deformable mirrors are continuous while @xmath228 presented discontinuities . thus , complete corrections for segmented mirrors",
    "might not be achieved in practice .",
    "below we discuss the following two main points .",
    "( 1 ) even if the phase wavefront error @xmath228 has discontinuities , the phase errors within in segment still drive the phase to amplitude conversion and thus the propagated amplitude at dm2 . in that case",
    "treatments of these phenomenons that have already been discussed in the literature for monolithic apertures are still valid for small enough phase errors eqs .",
    "[ eq : dm1equadifftilde1]-[eq : dm1equadifftilde ] and smooth enough remapping functions . for acad remapping this smoothness constraint",
    "is naturally enforced by the limited number of actuators across the dm surface . in this case phase to amplitude conversion between can in principle be corrected using dm1 .",
    "( 2 ) remapped phase discontinuities can be corrected for a finite number of spatial frequencies using a continuous phase sheet deformable mirror .",
    "we illustrate this partial correction over a @xmath229 bandwidth using numerical simulations of a post - acad half dark hole created by superposing a small perturbation , computed using a linear wavefront control algorithm , to the acad dm2 surface .",
    "+        if the incoming wavefront is written as @xmath228 and the solution of the monge ampere equation for dm1 as @xmath230 then one can conduct the analysis in eq .",
    "[ huygens ] to [ eq : dm2equadiff ] using @xmath231 . under the assumption that surface of dm2 is set as @xmath232 in order to conserve optical path length then one can re - write the remapping as @xmath233 defined by : @xmath234    moreover",
    "if edge ringing has been properly mitigated then the ray optics solution is valid and the field at dm2 can be written as : @xmath235          we first consider the amplitude profile in eq .",
    "[ eq : remappedfieldtilde ] : it is composed of two factors the remapped telescope aperture , @xmath236 , and the determinant of @xmath237 $ ] .",
    "the first condition necessary for the incoming wavefront not to perturb the acad solution is : @xmath228 is such that the remapping is not modified _ at the pupil locations where the telescope aperture is not zero @xmath238_. this results into the conditions @xmath239 at the locations where @xmath240 there is no light illuminating the discontinuous wavefront and thus the large local slopes at these location have no impact on the remapping functions @xmath89 .",
    "these conditions are not true in segmented telescopes that are not properly phased , for which the tip - tilt error over each segment can reach several waves . however under the assumption that the primary has been properly phased ( for instance the residual rms wavefront after phasing",
    "is expect to be @xmath241 th of a wave , similar to values expected for jwst nircam ) then these conditions are true within the boundaries of each segment .",
    "moreover , while the local wavefront slopes at the segment s discontinuities do not respect this condition the incident amplitude at these points is @xmath242 and they thus do not perturb the acad remapping solution .",
    "the second necessary condition resides in the fact that the determinant of @xmath243 is not equal to @xmath244 $ ] _ at the pupil locations where the telescope aperture is not zero _ ought not have a severe impact on contrast .",
    "one can use the linearization in @xcite to show that :    @xmath245 } & = & \\frac{1}{det[id + \\mathcal{h}(h_1^{0})](1+\\frac{(1+h_{1xx}^{0 } ) \\delta h_{1yy}+ ( 1+h_{1yy}^{0 } ) \\delta h_{1xx}- 2*h_{1xy}^{0}\\delta h_{1xy}}{det[id + \\mathcal{h}(h_1^{0 } ) ] } ) } \\\\",
    "\\frac{1}{det[id + \\mathcal{h}(\\tilde{h_1 } ) ] } & = & \\frac{1}{det[id + \\mathcal{h}(h_1^{0})](1+\\delta a(\\delta h_{1 } ) ) } \\end{aligned}\\ ] ]    the perturbation term @xmath246 corresponds to the full non - linear expression of the phase to amplitude conversion of wavefront errors that occurs in pupil remapping units . in @xcite",
    "we derived a similar expression in the linear case , when @xmath247 and showed that in the pupil regions where the the beam is converging this phase to amplitude conversion was enhanced when compared to the case of a fresnel propagation . in a recent study @xcite presented simulations predicting that this effect was quite severe in piaa coronagraphs and can limit the broadband contrast after wavefront control unless dms where placed before the remapping unit . in principle acad will not suffer from this limitation as the first aspherical surface of the remapping unit is actually a deformable mirror that can actually compensate for @xmath228 , before any phase to amplitude wavefront modulation occurs . devising",
    "a wavefront controller that relies on dm1 requires moreover a computationally efficient model to propagate arbitrary wavefronts thought acad .",
    "such a tool was developed in @xcite assuming azimuthally symmetric geometries . since devising such a tool in acad s case , in the asymmetric case , represents a substantial effort well beyond the problem of prescribing acad dm shapes , we chose not to include such simulations in the present manuscript .",
    "since we are using deformable mirrors with a limited number of actuators , acad remapping is in general less severe than in the case of piaa .",
    "we thus expect the results regarding the wavefront correction before the remapping unit reported in @xcite to hold .",
    "this is provided that the dm actuators can adequately capture the high spatial frequency content of @xmath228 to create a dark hole in the coronagraphic psf .",
    "we tackle this particular aspect next when discussing the case of phase errors , in the absence of wavefront phase to amplitude conversion .",
    "once again note that while the local wavefront curvatures are very large at the segment s discontinuities , the incident amplitude at these points is @xmath242 and they thus they do not have an impact on the acad phase to amplitude modulation . in practice",
    "if the dm is not exactly located at a location conjugate to the telescope pupil the actual wavefront discontinuities will be slightly illuminated and might perturb the remapping functions and the phase to amplitude conversion . while this might tighten requirements regarding the positioning of dm1 in the direction of the optical axis we do not expect this effect to be a major obstacle to successful acad implementations .",
    "in practice , when @xmath228 presents discontinuities , the surface of dm2 can not be set to the deformation @xmath232 that conserves optical path length , since we work under the assumption that the dms has a continuous phase - sheet .",
    "while this has no impact on the discussion above regarding the amplitude of @xmath248 , since dm1 is solely responsible for this part , it ought to be taken into account when discussing the phase at dm2 . under the assumption that @xmath228 does not perturb the nominal acad remapping function",
    "then one can show that the phase at dm2 is : @xmath249 = \\nonumber \\\\   & = & \\frac{2 \\pi}{\\lambda } ( \\delta h_1(f_1^{0}(x_2,y_2),g_1^{0}(x_2,y_2 ) ) + \\delta h_2 ( x_2,y_2))\\end{aligned}\\ ] ]    where @xmath250 is a small continuous surface deformation superposed to the acad shape of dm2 and @xmath251 is the telescope opd seen through the dm based remapping unit .",
    "this second term presents phase discontinuities whose spatial scale has been contracted by acad .",
    "when these discontinuities are very small then their high spatial frequency content does not disrupt the ability of dm2 to correct for low to mid - spatial frequency wavefront errors wavefront errors .",
    "however as the discontinuities become larger their high spatial frequency content can fold into the region of the psf that the dms seek to cancel .",
    "these `` frequency folding '' speckles are highly chromatic @xcite and can have a severe impact on the spectral bandwidth of a coronagraph whose wavefront is corrected using a continuous dm .    in order to assess the impact of this phenomenon , we conducted a series of simulations based on single dm wavefront control algorithm that seeks to create a dark hole in one half of the image plane at in as in @xcite .",
    "we use the example of a geometry similar to jwst and work under the assumption that the discontinuous wavefront incident to the coronagraph has the same spatial frequency content as a jwst nircam optical path difference that has been adjusted to @xmath252 nm rms in order to mimic a visible strehl similar to the near - infrared strehl of jwst . the non - linear wavefront and sensing and",
    "control problem associated with phasing a primary mirror to such level of precision is undoubtedly a colossal endeavor and is well beyond the scope of this paper . in this section",
    "we work under the assumption that the primary mirror either has been phased to such a level , that the wavefront discontinuities are no larger than @xmath253 nm peak to valley or that the wavefront has been otherwise corrected down to this specification using a segmented deformable mirror that is conjugate with the primary mirror .",
    "moreover we assume ( 1 ) that the residual post - phasing wavefront map has been characterized and can be used in order to build the linear model underlying the wavefront controller ( 2 ) the focal plane wavefront estimator ( carried using dm diversity as in @xcite for instance ) is capable to yield an exact estimate of the complex electrical field at the science camera .",
    "underlying this last assumption is the overly optimistic premise that wavefront will remain unchanged over the course of each high - contrast exposure . while this is not a realistic assumption one could envision the introduction of specific wavefront sensing schemes , with architectures similar to the one currently considered for low order wavefront sensors on monolithic apertures @xcite , or using a separate metrology system .",
    "the results presented here are thus limited to configurations for which segment phasing will be dynamically compensated using specific sensing and control beyond the scope of this paper . as this section merely seeks to address the controllability of wavefront errors in segmented telescopes we chose to conduct our simulations with a perfect estimator .",
    "finally we use the stroke minimization wavefront control algorithm presented in @xcite to ensure convergence for as many iteration as possible .",
    "we first tested the case of a segmented telescope in the absence of acad , using a azimuthally symmetric coronagraph and a single dm .",
    "we sough to create a dark hole between @xmath254 and @xmath255 under a @xmath229 bandwidth with @xmath256 nm .",
    "fig  [ fig : wavecontrolnoacad ] shows the results of such a simulation .",
    "the dm can indeed correct for the discontinuities over a broadband in one half of the image plane .",
    "however the wavefront control algorithm seeks to compensate for the diffractive artifacts associated with the secondary support structures : it attenuates them on the right side of the psf while it strengthens them on the left side of the psf . as a result",
    "the dm surface becomes too large at the pupil spider s location and the quasi - linear wavefront control algorithm eventually diverges for contrasts @xmath257 .",
    "we then proceeded to simulate the same configuration in the presence of two dms whose surface at rest was calculated using acad . since there",
    "does not exist a model yet to propagate arbitrary wavefronts through acad ( the models in @xcite only operate under the assumption of an azimuthally symmetric remapping ) we can only use the second dm for wavefront control .",
    "we work under the assumption that the incident wavefront does not perturb the nominal acad remapping ( which is true in the case of the surface map we chose for our example ) and that the arguments in @xcite hold so that phase to amplitude conversion in acad can be compensated by actuating dm1 .",
    "frequency folding will then be the phenomenon responsible for the true contrast limit . in this section",
    "we are interested in exploring how this impacts the controllability of wavefront discontinuities using continuous phase - sheet dms .",
    "we used a azimuthally symmetric coronagraph and superposed our wavefront control solution to dm2 .",
    "we sough to create a dark hole between @xmath254 and @xmath255 under a @xmath229 bandwidth with @xmath256 nm .",
    "fig  [ fig : wavecontrolnoacad ] shows the results of such a simulation .",
    "when the incident wavefront is small enough it is indeed possible to superpose a `` classical linear wavefront control '' solution to the non - linear acad dm shapes in order to carve psf dark holes .",
    "the wavefront control algorithm now yields a dm surface that does not feature prominent deformations at the location of the spiders .",
    "most of the dm stroke is located at the edge of the segments , at location of the wavefront discontinuities and seek to correct the frequency folding terms associated with such discontinuities . at these locations",
    "the dm surface eventually becomes too large and the linear wavefront control algorithm diverges .",
    "however this divergence occurs at contrast levels much higher than when the acad solution is not applied to the dms .",
    "these simulations show that indeed discontinuous phases can be corrected using the second dm of a acad whose surfaces have preliminary been set to mitigate the effects of spiders and segment gaps .     and fig .",
    "[ fig : wavecontrolacad ] . in the presence of wavefront discontinuities corrected using a continuous membrane dm , acad still yields , over a @xmath229 bandwidth around @xmath258 nm , psf with a contrast 100 larger than in a classical segmented telescope .",
    "moreover this figure illustrates that since it is based on a true image plane metric , the wavefront control algorithm can be used ( within the limits of its linear regime ) to improve upon the acad dm shapes derived solving the monge ampere equation.,width=336 ]      assuming that edge ringing has been properly mitigated , so that the ray optics approximation underlying the calculation of the dms shapes is valid , one can wonder about the ultimate contrast limitations of the results presented in this manuscript .",
    "increasing the number of actuators would have dramatic effects on contrast if the actuator count would be such that @xmath259 where @xmath260 is the scale of the aperture discontinuities .",
    "unfortunately current dm technologies are currently far from such a requirement and the solutions presented here are in the regime where @xmath261 . in this regime",
    "@xmath111 only has a marginal influence on contrast when compared to the impact of the cutoff frequency of the tapering kernel . in the regime",
    "described here varying the actuator count only changes the size of the corrected region .    the residual psf artifacts in figs .  [ fig : resultsjwst ] to [ fig : slicesthickness ] follow the direction of the initial diffraction pattern associated with secondary support structures and segments .",
    "when addressing the problem of aperture discontinuities by solving the monge - ampere equation , acad calculates the dm shapes based on a pupil plane metric and thus mostly focuses on attenuating these structures with little regard to the final contrast .",
    "it is actually quite remarkable that such a pupil - only approach yields levels of starlight extinction of two to three orders of magnitude .",
    "a more appropriate metric would be the final intensity distribution in the post - coronagraphic image plane .",
    "however , as discussed in  .",
    "[ sec : physicsofam ] classical wavefront control algorithms based on a linearization of the dms deformations around local equilibrium shapes ( such as the ones presented in @xcite in the one dm case or @xcite for one or two dms ) can not be used to compensate the full aperture discontinuities .",
    "this is illustrated in fig  [ fig : wavecontrolnoacad ] , where the dm surface in the vicinity of spiders becomes too large after a certain number of iterations , which leads the iterative algorithm to diverge .",
    "when attempting to circumvent this problem by recomputing the linearization at each iteration , we managed to somewhat stabilize the problem for a few iterations and reached marginal contrast improvements , but the overall algorithm remained unstable unless a prohibitively small step size was used .",
    "this is the problem which motivated our effort to calculate the dm shapes as the full non - linear solution of the monge - ampere equation .",
    "while doing so yields significant contrast improvements in both the case of jwst like geometries , tmt and on axis - monolithic apertures similar , this approach does not give a proper weight to the spatial frequencies of interest for high contrast imaging .",
    "we mitigated this effect by giving a strong weight to the spatial frequencies of interest ( in the dark hole ) when solving the monge ampere equation .",
    "+    . in brown",
    "are listed the potential avenues to further the contrasts presented herein : 1 ) combining acad with coronagraphs designed on segmented and/or on - axis apertures , 2 ) using diffractive models to close a quasi - linear focal plane based loop using a metric whose starting point corresponds to the dm shapes calculated in the non - linear regime . , width=336 ]",
    "the next natural step is thus to use non - linear solutions presented herein to correct for the _ bulk _ of the aperture discontinuities and to serve as a starting point for classical linearized waveform control algorithms , as illustrated on fig .",
    "[ fig : future ] . fig .",
    "[ fig : wavecontroslices ] indeed illustrates that when superposing an image plane based wavefront controller to the monge ampere acad solution , the contrast can be improved beyond the floor shown on fig .",
    "[ fig : slicesjwst ] .",
    "however one dm solutions , are of limited interest as they only operate efficiently over a finite bandwidth and over half of the image plane .",
    "acad yields a true broadband solution , and consequently it would be preferable to use the two dms in the quasi - linear regime to quantify the true contrast limits of acad .",
    "in such a scheme the dm surfaces are first evaluated as the solution of the monge - ampere equation and then adjusted using the image plane based wavefront control algorithm presented in @xcite .",
    "however such an exercise requires efficient and robust numerical algorithms to evaluate eq .",
    "[ eq::propint ] .",
    "such tool only exist so far in the case of azimuthally symmetric remapping units @xcite .",
    "developing such numerical tools is thus of primary interest to both quantifying the chromaticity and the true contrast limits achievable with on - axis and/or segmented telescopes .",
    "we have introduced a technique that takes advantage of the presence of deformable mirrors in modern high - contrast coronagraph to compensate for amplitude discontinuities in on - axis and/or segmented telescopes .",
    "our calculations predict that this _ high throughput _ class of solutions operates _ under broadband illumination _ even in the presence of reasonably small wavefront errors and discontinuities .",
    "our approach relies on controlling two sequential deformable mirrors in a non - linear regime yet unexplored in the field of high - contrast imaging .",
    "indeed the mirror s shapes are calculated as the solution of the two - dimensional pupil remapping problem , which can be expressed as a non - linear partial differential equation called monge ampere equation .",
    "we called this technique active compensation of aperture discontinuities .",
    "while we illustrated the efficiency of acad using apodized pupil lyot and phase induced amplitude coronagraph , it is is applicable to all types of coronagraphs and thus enables one to translate the past decade of investigation in coronagraphy with unobscured monolithic apertures to a much wider class of telescope architectures . because acad consists of a simple remapping of the telescope pupil , it is a true broadband solution .",
    "provided that the coronagraph chosen operates under a broadband illumination , acad allows high contrast observations over a large spectral bandwidth as pupil remapping is an achromatic phenomenon .",
    "we showed that wavelength edge diffraction artifacts , which are the source of spectral bandwidth limits in piaa coronagraphs ( also based on pupil remapping ) , are no larger than classical fresnel ringing .",
    "we thus argued that they will only marginally impact the spectral bandwidth of a coronagraph whose input beam has been corrected with acad .",
    "the mirror deformations we find can be achieved , both in curvature and in stroke , with technologies currently used in ex - ao ground based instruments and in various testbeds aimed at demonstrating high - contrast for space based applications .",
    "implementing acad on a given on - axis and/or segmented thus does not require substantial technology development of critical components .    for geometries analogous to jwst",
    "we have demonstrated that acad can achieve at least contrast @xmath262 , provided that dynamic high precision segment phasing can be achieved . for tmt and elt",
    ", acad can achieve at least contrasts @xmath263 . for on - axis monolithic observatories the design contrast of the coronagraph can be reached with acad when the secondary support structures are @xmath254 times thinner than on hst .",
    "when they are just as thick as hst contrasts as high as @xmath264 can be reached .",
    "these numbers are , however , conservative : an optimal solution can be obtained by fine tuning the control term in the monge ampere equation to the characteristic scale of each discontinuity . as our goal was to introduce this technique to the astronomical community and emphasize its broad appeal to a wide class of architectures ( jwst , atlast , hst , tmt , e - elt ) we left this observatory specific exercise for future work .",
    "the true contrast limitation of acad resides in the fact that the deformable mirrors are controlled using a pre - coronagraph pupil based metric .",
    "however , as illustrated in fig .",
    "[ fig : future ] , the solution provided by acad can be used as the starting point for classical linearized waveform control algorithms based in image plane diagnostics . in such a control strategy , the surfaces are first evaluated as the solution of the monge- ampere equation and then adjusted using the quasi - linear method presented in @xcite .",
    "this control strategy requires efficient and robust numerical algorithms to evaluate the full diffractive propagation in the remapped fresnel regime .",
    "all the contrasts reported here are achieved without aberrations and we showed that in practice , quasi - linear dm controls based on images at the science camera will have to be superposed to the acad solutions . finally ,",
    "as acad is broadly applicable to all types of coronagraphs , the remapped pupil can be used as the entry point to relax the design of coronagraphs that do operate on segmented apertures such as discussed in @xcite , also illustrated in fig .",
    "[ fig : future ] .",
    "acad is thus a promising tool for future high contrast imaging instruments on a wide range of observatories as it will allow astronomers to devise high throughput broadband solutions for a variety of coronagraphs .",
    "it only relies on hardware ( deformable mirrors ) that have been extensively tested over the past ten years . finally since acad can operate with all type of coronagraphs and it renders the last decade of research on high - contrast imaging technologies with off - axis unobscured apertures applicable to much broader range of telescope architectures .",
    "the authors thank dr bruce macintosh who steered our attention towards this problem and provided invaluable guidance in the early stages of this manuscript .",
    "the authors also thank the anonymous referee for insightful comments which greatly improved this manuscript , dr remi soummer , dr marshall perrin , prof .",
    "n. jeremy kasdin and prof .",
    "robert vanderbei for very helpful discussions and matt sheckells for his help coding the linear wavefront control algorithms .",
    "this material is partially based upon work supported by the national aeronautics and space administration under grant nnx12ag05 g issued through the astrophysics research and analysis ( apra ) program .",
    "this work was performed in part under contract with the california institute of technology funded by nasa through the sagan fellowship program executed by the nasa exoplanet science institute .          ,",
    "r. , pluzhnik , e. , witteborn , f.  c. , greene , t.  p. , lynch , d.  h. , zell , p.  t. , & guyon , o. 2011 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "8151 , society of photo - optical instrumentation engineers ( spie ) conference series                , k. , beuzit , j .- l . ,",
    "feldt , m. , mouillet , d. , puget , p. , antichi , j. , baruffolo , a. , baudoz , p. , berton , a. , boccaletti , a. , carbillet , m. , charton , j. , claudi , r. , downing , m. , fabron , c. , feautrier , p. , fedrigo , e. , fusco , t. , gach , j .- l . , gratton , r. , hubin , n. , kasper , m. , langlois , m. , longmore , a. , moutou , c. , petit , c. , pragt , j. , rabou , p. , rousset , g. , saisse , m. , schmid , h .- m . ,",
    "stadler , e. , stamm , d. , turatto , m. , waters , r. , & wildi , f. 2006 , in presented at the society of photo - optical instrumentation engineers ( spie ) conference , vol .",
    "6269 , ground - based and airborne instrumentation for astronomy . edited by mclean , ian s. ; iye , masanori .",
    "proceedings of the spie , volume 6269 , pp .",
    "62690q ( 2006 ) .                , t.  d. , carlotti , a. , & kasdin , n.  j. 2011 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol . 8151 , society of photo - optical instrumentation engineers ( spie ) conference series        , o. , angel , j.  r.  p. , backman , d. , belikov , r. , gavel , d. , giveon , a. , greene , t. , kasdin , j. , kasting , j. , levine , m. , marley , m. , meyer , m. , schneider , g. , serabyn , g. , shaklan , s. , shao , m. , tamura , m. , tenerelli , d. , traub , w. , trauger , j. , vanderbei , r. , woodruff , r.  a. , woolf , n.  j. , & wynn , j. 2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7010 , society of photo - optical instrumentation engineers ( spie ) conference series            , s. , oppenheimer , b.  r. , zimmerman , n. , brenner , d. , parry , i.  r. , crepp , j.  r. , vasisht , g. , ligon , e. , king , d. , soummer , r. , sivaramakrishnan , a. , beichman , c. , shao , m. , roberts , l.  c. , bouchez , a. , dekany , r. , pueyo , l. , roberts , j.  e. , lockhart , t. , zhai , c. , shelton , c. , & burruss , r. 2011 , , 123 , 74            , j.  e. , belikov , r. , pueyo , l. , mawet , d.  p. , moody , d. , trauger , j.  t. , & shaklan , s.  b. 2011 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol . 8151 ,",
    "society of photo - optical instrumentation engineers ( spie ) conference series              , b. , troy , m. , doyon , r. , graham , j. , baker , k. , bauman , b. , marois , c. , palmer , d. , phillion , d. , poyneer , l. , crossfield , i. , dumont , p. , levine , b.  m. , shao , m. , serabyn , g. , shelton , c. , vasisht , g. , wallace , j.  k. , lavigne , j .- f . ,",
    "valee , p. , rowlands , n. , tam , k. , & hackett , d. 2006 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "6272 , society of photo - optical instrumentation engineers ( spie ) conference series                        , m. , traub , w.  a. , krist , j. , stapelfeldt , k. , brown , r. , oegerle , w. , lo , a. , clampin , m. , soummer , r. , wiseman , j. , & mountain , m. 2010 , in astronomical society of the pacific conference series , vol .",
    "430 , pathways towards habitable planets , ed .",
    "v.  coud du foresto , d.  m. gelino , & i.  ribas , 361                          , s.  b. , green , j.  j. , & palacios , d.  m. 2006 , in presented at the society of photo - optical instrumentation engineers ( spie ) conference , vol .",
    "6265 , space telescopes and instrumentation i : optical , infrared , and millimeter . edited by mather , john c. ;",
    "macewen , howard a. ; de graauw , mattheus w. m .. proceedings of the spie , volume 6265 , pp .",
    "62651i ( 2006 ) .                ,",
    "j. , stapelfeldt , k. , traub , w. , krist , j. , moody , d. , mawet , d. , serabyn , e. , henry , c. , brugarolas , p. , alexander , j. , gappinger , r. , dawson , o. , mireles , v. , park , p. , pueyo , l. , shaklan , s. , guyon , o. , kasdin , j. , vanderbei , r. , spergel , d. , belikov , r. , marcy , g. , brown , r.  a. , schneider , j. , woodgate , b. , egerman , r. , matthews , g. , elias , j. , conturie , y. , vallone , p. , voyer , p. , polidan , r. , lillie , c. , spittler , c. , lee , d. , hejal , r. , bronowicki , a. , saldivar , n. , ealey , m. , & price , t. 2010 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7731 , society of photo - optical instrumentation engineers ( spie ) conference series              , c. , kasper , m. , beuzit , j. , gratton , r.  g. , mesa , d. , aller - carpentier , e. , fedrigo , e. , abe , l. , baudoz , p. , boccaletti , a. , bonavita , m. , dohlen , k. , hubin , n. , kerber , f. , korkiakoski , v. , antichi , j. , martinez , p. , rabou , p. , roelfsema , r. , schmid , h.  m. , thatte , n. , salter , g. , tecza , m. , venema , l. , hanenburg , h. , jager , r. , yaitskova , n. , preis , o. , orecchia , m. , & stadler , e. 2010 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "7736 , society of photo - optical instrumentation engineers ( spie ) conference series    wallace , j.  k. , burruss , r. , pueyo , l. , soummer , r. , shelton , c. , bartos , r. , fregoso , f. , nemati , b. , best , p. , & angione , j. 2009 , in proceedings of the spie conference 7440 , ed .",
    "s.  b. shaklan , vol .",
    "7440 ( spie )      , m. , oya , s. , hayano , y. , takami , h. , hattori , m. , minowa , y. , saito , y. , ito , m. , murakami , n. , iye , m. , guyon , o. , colley , s. , eldred , m. , golota , t. , & dinkins , m. 2008 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol . 7015 , society of photo - optical instrumentation engineers ( spie ) conference series"
  ],
  "abstract_text": [
    "<S> we present a new method to achieve high - contrast images using segmented and/or on - axis telescopes . </S>",
    "<S> our approach relies on using two sequential deformable mirrors to compensate for the large amplitude excursions in the telescope aperture due to secondary support structures and/or segment gaps . in this configuration </S>",
    "<S> the parameter landscape of deformable mirror surfaces that yield high contrast point spread functions is not linear , and non - linear methods are needed to find the true minimum in the optimization topology . </S>",
    "<S> we solve the highly non - linear monge - ampere equation that is the fundamental equation describing the physics of phase induced amplitude modulation . </S>",
    "<S> we determine the optimum configuration for our two sequential deformable mirror system and show that high - throughput and high contrast solutions can be achieved using realistic surface deformations that are accessible using existing technologies . </S>",
    "<S> we name this process active compensation of aperture discontinuities ( acad ) . </S>",
    "<S> we show that for geometries similar to jwst , acad can attain at least @xmath0 in contrast and an order of magnitude higher for both the future extremely large telescopes and on - axis architectures reminiscent of hst . </S>",
    "<S> we show that the converging non - linear mappings resulting from our deformable mirror shapes actually damp near - field diffraction artifacts in the vicinity of the discontinuities . </S>",
    "<S> thus acad actually lowers the chromatic ringing due to diffraction by segment gaps and strut s while not amplifying the diffraction at the aperture edges beyond the fresnel regime . </S>",
    "<S> this outer fresnel ringing can be mitigated by properly designing the optical system . </S>",
    "<S> consequently , acad is a true broadband solution to the problem of high - contrast imaging with segmented and/or on - axis apertures . </S>",
    "<S> we finally show that once the non - linear solution is found , fine tuning with linear methods used in wavefront control can be applied to further contrast by another order of magnitude . generally speaking </S>",
    "<S> , the acad technique can be used to significantly improve a broad class of telescope designs for a variety of problems . </S>"
  ]
}