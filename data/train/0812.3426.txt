{
  "article_text": [
    "in biomolecular folding problems , identification of intermediate or transition states connecting folded or unfolded states is crucial for understanding the folding pathways , but is difficult in both experiments due to the transient nature and computer simulations due to the low sampling population .",
    "we are motivated by recent debates over whether rna hairpins fold in a two - state or multi - state manner with intermediates on pathways . to address this issue",
    ", we develop a computational approach to explore the relatively low populated transition or intermediate states in biomolecular folding pathways , based on a topological data analysis tool , mapper , with simulation data from large - scale distributed computing .",
    "the method in this paper exploits a conditional density filter which effectively focuses on pathways , followed by clustering analysis on filter level sets which separates low populated intermediate states from others of high population .",
    "such a scheme , when applied to a rna hairpin system , successfully provides important structural evidence on the multiple intermediate states on folding pathways which may guide further experimental investigations .",
    "the methodology adds to the communities of simulation and informatics an exploratory tool to data mine large data sets and propose experimentally testable properties , such as folding pathways for biological macromolecules .",
    "the folding of biomolecules is a classic biophysical problem . proteins and nucleic acids are synthesized as linear polymer chains .",
    "they must then spontaneously and rapidly fold into their three - dimensional native states .",
    "the folding process is determined by the underlying free energy landscape .",
    "these landscapes are rugged , having many local minima corresponding to intermediates and misfolded states .",
    "characterizing these states is critical for a full understanding of biomolecular folding .",
    "experimental studies may point to the existence of such states but are usually unable to provide high resolution structural information due to the transience and/or heterogeneity of such states .",
    "computer simulations have proved useful for sampling this complex high - dimensional space while yielding structures at full - atom resolution .",
    "however , these simulations tend to generate millions of configurations .",
    "the volume and high - dimensional nature of the output make it extremely difficult to discern the structure of the data .",
    "one common approach to dealing with computer simulation results is to apply k - means clustering to the entire data set .",
    "however , k - means clustering suffers from a number of important limitations .",
    "first , it is limited by the need to specify the number of states from the beginning .",
    "second , it tends to create spherical states .",
    "the relevant states of the free energy landscape , on the other hand , may be non - convex . in this case , k - means clustering will tend to lump unrelated configurations together or split related configurations into separate states .",
    "this limitation may be overcome by splitting the configurations into many small states and grouping them together using various metrics that allow non - convex states , such as in @xcite .",
    "there is another widely used clustering method , single - linkage , which may overcome these issues in k - means .",
    "unfortunately , identifying sparsely populated intermediate states is still difficult .",
    "simulation data tends to be heavily dominated by the most stable states , such as the folded and unfolded states , and single - linkage clustering of the entire data set tends to pick up densest states only and hardly distinguish the intermediates from noise .",
    "recently , geometric embedding techniques , such as nonlinear dimensionality reduction [ 2 - 7 ] , have been explored as a means to overcome the dimensionality hurdle in complex biomolecular systems .",
    "for example , isomap @xcite has been applied to protein folding @xcite and laplacian eigenmap @xcite has been applied to the dynamics of biological networks @xcite .",
    "this class of techniques maps the data in high dimensional spaces to a low dimensional space by preserving some local / global metric relationship among neighboring data points . in this way",
    ", one can easily visualize data and possibly gain important insights .",
    "for instance , the new embedding coordinates may be biologically relevant reaction coordinates @xcite .",
    "however , the performance of these geometric embedding techniques will suffer from the high degree of heterogeneity in distribution and be sensitive to the choice of the distance metric .    one efficient strategy to address these issues",
    "is to stratify the data into density level sets and study its topological features such as clustering which are less sensitive to the metric than geometric methods .",
    "high density levels will contain the dominant states , such as the folded and unfolded states , while less populated states , such as intermediates , will occupy the low density levels .",
    "clustering on level sets of similar density , will be less affected by the distributional heterogeneity and thus effectively disclose structural information about intermediates .",
    "this idea of stratification is reminiscent of morse theory , which provides a general machinery for studying the topology of high dimensional manifolds by looking at level sets of some nicely - behaved function @xcite .",
    "inspired by morse theory , singh _ et al .",
    "_ recently introduced mapper @xcite , a topological data analysis tool for high dimensional data sets .",
    "mapper is a way to visualize and cluster high dimensional data . in its simple form",
    ", a filter function is used to decompose the data into overlapping level sets and clustering is then carried out in each of them .",
    "a graph is then generated by connecting clusters in neighboring level sets with an edge if they have non - empy overlapping . if an energy function is taken as the filter , such a graph in the limiting case will summarize the same kind of topological information as a disconnectivity graph of the energy landscape @xcite .",
    "but the flexibility of the filter design in mapper makes it applicable in non - equilibrium data as well . in its extended form ,",
    "mapper can return a simplicial complex with high dimensional topological information about the data .",
    "the method is computationally efficient and amenable to parallelization .    in this work",
    "we demonstrate the applicability of mapper in its simple form to the biomolecular folding problem .",
    "we begin with a discussion of mapper itself from a perspective of morse theory and then present the details of a filtering function that is well - suited for biomolecular folding problems , the conditional density filter .",
    "this filter weights configurations close to a state of interest more heavily , thus facilitating the identification of any intermediate state leading up to it .",
    "we then describe the use of single - linkage clustering within level sets to allow the identification of an unspecified number of non - convex states .",
    "finally , we discuss the application of mapper to the folding of a small rna hairpin , which gives some structural evidence from computer simulations in support of the multi - state hypothesis @xcite .",
    "the biological implications of the mapper results are discussed by @xcite elsewhere .",
    "we also briefly discuss the advantages of mapper over nonlinear dimensionality reduction techniques .",
    "in the future we hope to explore the combination of those geometric embedding techniques with mapper in order to take advantage of the strengths of both approaches .",
    "one way to reduce the computational complexity in the study of massive data sets is to decompose the data by classifying the data into groups and doing analysis on each of the group individually instead of performing analysis on the whole .",
    "this strategy is amenable for parallel computation , which is particular important for studies of biomolecular folding , where a great amount of configurations are normally generated .",
    "here we pursue this idea in the particular case where the decomposition is induced by the choice of some filter function on the data set , @xmath0 . in this paper",
    ", we will only consider filters that take values in the real line , though the mapper methodology is equally applicable for filter functions taking values in higher dimensional space , or even spheres , tori , or any other topological space . with this choice ,",
    "we introduce mapper from a perspective of morse theory , which differs from the original paper @xcite but discloses a deeper inspiration . _",
    "morse theory _",
    "@xcite tells us that when @xmath1 is some nicely - behaved function , topological information of @xmath2 can be inferred from the level sets @xmath3 .",
    "such nice functions are called morse functions in mathematics , which are those smooth functions with only nondegenerate critical points  in other words , the hessian at each critical point where the gradient vanishes has full rank .",
    "morse functions are generic in the sense that they are dense in the space of smooth functions , as well of continuous functions .",
    "hence every continuous function can be approximated arbitrarily well by morse functions .",
    "morse theory is an extremely powerful tool to analyze the topology of high dimensional manifolds , which lies in the heart of proving the celebrated poincare conjecture of dimension no less than five @xcite .",
    "the simplest example in this spirit may be _ reeb graph _",
    ", by contracting to points the connected components within level sets @xmath3 , illustrated as figure 1 ( a ) .",
    "this simple scheme turns out to be useful in various fields under different names , _",
    "e.g. _ contour trees in computational geometry @xcite and cluster trees in statistics @xcite .",
    "_ mapper _ @xcite extends this construction to incorporate the discrete setting where @xmath2 is a finite set of data points in high dimensional spaces or metric spaces .",
    "first , instead of working with the level set of a single value which is difficult to capture in discrete settings , mapper considers the preimage of subinterval @xmath4)$ ] .",
    "second , it replaces by clustering the contraction of connected components in continuous settings .",
    "specifically , the procedure of mapper used in this paper is as follows .    1 .",
    "* level - set formation*. cover the range of @xmath1 by a set of subintervals which overlap in neighbors , _",
    "i.e. _ @xmath5 $ ] with @xmath6 and @xmath7 , and stratify @xmath2 into level sets by taking inverse images @xmath8)$ ] ; 2 .",
    "* clustering*. on each level set @xmath8)$ ] , construct the connected components or point clusters ; 3 .",
    "* graph representation*. represent each component or cluster by a node .",
    "add an edge between a node pair whenever they have nonempty intersection .",
    "mapper thus returns an undirected graph representing the connectivity information between data clusters across level sets @xmath8)$ ] .",
    "see the example in figure  1 ( b ) .",
    "note that those degree - one nodes lie in the intervals containing local minima / maxima and the branching ( degree - three ) nodes lie in the intervals with saddle points , a sort of critical points .",
    "more generally , if the filter value range @xmath9 takes some higher dimensional space or other topological spaces , mapper may return a simplicial complex which is however not pursued in this paper .",
    "this construction can easily yield a multiresolution structure by choosing subintervals of different granularities , which helps handle noise .",
    "the key choice in mapper will be the filter map @xmath10 .",
    "in fact , the name , _ mapper _ , was coined to emphasize the importance of choosing such a map .",
    "there is no universal scheme for this choice , which may vary from application to application . in @xcite",
    "some examples are presented with the choice of density function and a certain eccentricity function measuring data depth as filters . in the following ,",
    "we will discuss it in detail in the setting of biomolecular folding problems , with a particular example in rna hairpin folding .",
    "simulation data in biomolecular systems produces massive data in high dimensional space , and exhibits heterogeneity in distributions .",
    "the general procedure of mapper above is adapted toward such challenges .",
    "the first crucial design is to construct filters based on conditional density functions estimated from data , which effectively enables us to focus on important local regions in configuration spaces and separate less populated pathways from the overwhelmed uninterested states . in clustering",
    "we choose the single - linkage method to capture possibly non - convex clusters .",
    "below we give a detailed description on these particular implementations .",
    "our key construction of filters here is based on conditional density functions estimated from data , conditioning on the states of interests .",
    "for example , in the study of folding process we extract configurations from folding events and focus on the region close to folded states , while in unfolding process we draw samples from unfolding events and pay more attention to the zone around extended states .",
    "simulation trajectories of those processes are often dominated by stochastic fluctuations around the initial states .",
    "it is near the target states that one may observe interesting structural information about pathways .",
    "the conditional density filters are chosen to reflect the localized free energy landscape around the states on pathways without being disturbed by off - pathway structures which are quite noisy and of high population in samples .",
    "although the simulation data of biomolecular systems often lie in a high dimensional configuration space , the degree of freedom are much less due to the constraints and cooperation among atoms in folding process .",
    "it is often expected that the pathway samples are concentrated around some low dimensional manifolds which can be described by a relatively small number of intrinsic reaction coordinates @xcite .",
    "the existence of multiple pathways as in the example of this paper may lead to holes in such manifolds with nontrivial topology . note that in the continuous case , the reeb graph of a ( unconditional ) density function defined on the euclidean space @xmath11 turns out to be trivially a tree .",
    "however conditional density functions adopted here may restrict on interesting regions where the loops in the reeb graph might shed light on the hole structures . reconstructing the low - dimensional topology of densely sampled regions ,",
    "thus may disclose the nature of multiple pathways . in theory , it is possible to efficiently recover the topology from samples of such low dimensional manifolds @xcite . in this paper , through conditional density filters we approach such manifolds via data level sets and extract some low - dimensional topological features which provide structural evidence on the existence of multiple pathways .    here",
    "we describe a general approach to construct conditional density filters , which will be specialized in the next section with the application to rna hairpin folding .",
    "* draw random samples @xmath12 from the folding events .",
    "choose importance weights on @xmath13 , @xmath14 , with higher values on interested states .",
    "* define the filter function by @xmath15 where the kernel function is defined by @xmath16 where @xmath17 is some distance function between configuration @xmath18 and @xmath19 , @xmath20 is the band - width , and @xmath21 is the exponent .",
    "for example the euclidean distance with @xmath22 is used in case of gaussian kernels , or the hamming distance between structural contact maps with @xmath23 is used later in this paper . *",
    "resample from @xmath13 according to the new distribution , @xmath24 to avoid the normalization in large data sets , we can use the rejection method or extended @xcite , _",
    "e.g. _ a sequential bernoulli experiments where a new configuration @xmath18 is accepted with probability @xmath25 .",
    "these configurations , together with the filter function , will be the inputs of mapper procedure shown in the last section .",
    "filter assumes a density function in boltzman form @xmath26 , with partition function @xmath27 .",
    "thus up to a constant filter approximates the free energy near the folded state . since",
    "only order information of @xmath28 will be used below , it leads to the same result choosing any monotone transform on @xmath29 , _",
    "e.g. _ @xmath30 .",
    "our construction is equivalent to a kernel density estimator which can be replaced by other methods @xcite .      to increase the robustness of mapper allowing more errors in density estimation , we only use the order information of filter to construct level sets .",
    "* * level - set formation*. order the samples according to values of @xmath28 , and classify the samples into @xmath31 consecutive overlapping groups of equal or similar size , whose filter value ranges @xmath32}$ ] cover the range of @xmath29 .    up to an arbitrary small perturbation , a real valued function @xmath33 induces a linear order on samples .",
    "therefore any monotone transform on @xmath28 , such as @xmath34 , leads to the same level sets .",
    "the graphical representation of mapper depends on the choice of clustering methods .",
    "mapper itself does not place any prerequisite on the clustering algorithm . in the study of biomolecular folding such as rna hairpins ,",
    "our purpose is to identify those connected components in free energy or density level sets , which might be of non - convex shapes and whose numbers are unknown to us beforehand .",
    "single - linkage clustering is the simplest choice to meet those two features .",
    "* on each level set , construct a weighted graph , with nodes for configurations and edge weights as pairwise distances . *",
    "find a minimal spanning tree ( mst ) of such a graph .",
    "* find a threshold value for edges .",
    "we construct a histogram of mst edge weights with @xmath35 bins .",
    "once some empty bins are found from top bins containing @xmath36 longest edges , we set the threshold to be the center of the first empty bin . otherwise , set the threshold the maximal edge ( diameter ) .",
    "* truncate the graph by breaking those edges greater than the threshold , dividing the graph into connected components .",
    "* prune those components of size no more than @xmath37 .",
    "single - linkage will separate those clusters where within each cluster two points can be joined by a path consisting of short edges , but relatively longer edges are required to merge the clusters . when we draw random samples from compact connected components in an euclidean space , the distances between configurations within the same components will drop down to zero as the sample size grows .",
    "hence the distances across components will be kept in the longest edges and can be separated from a large amount of short edges .",
    "thresholding above tries to capture such a gap .",
    "truncation may create several components / clusters of different sizes , where pruning helps reduce the noise and identify those dominant components .    in the continuous setting",
    ", single - linkage clustering will consistently locate those connected components when the samples are dense enough @xcite .",
    "such a feature makes it a desirable choice for mapper @xcite , as well as density cluster trees @xcite .",
    "however , in the latter part of this paper , we will meet a discrete configuration space , _ i.e. _ the space of contact maps as undirected graphs .",
    "thus we need to explain in what sense we extend the `` connected components '' in such a discrete setting .",
    "equipped with a metric , _",
    "e.g. _ hamming distance , the discrete configuration set can be viewed as a weighted complete graph , where each node represents a structure and the weight of an edge is the distance between its endpoints .",
    "single - linkage clustering firstly builds up a minimal spanning tree ( mst ) of this graph and then truncate the mst by keeping the edges with the length less than a given threshold , which breaks the mst into several connected components or clusters . in this way ,",
    "single - linkage compute the components where two nodes within a component are joined by a path consisting of the short edges , but relatively longer edges are required to merge different components .",
    "one may also consider other clustering schemes , such as @xmath35-means , which is widely used in clustering the configurations in the biomolecular folding simulations .",
    "in contrast to single - linkage , @xmath35-means attempts to find the clusters such that within cluster _ any _ two nodes are connected by a short edge , rather than by a path made up of short edges . therefore , roughly speaking , @xmath35-means attempts to find _ spherical - shape _ clusters while single - linkage can discover _ snake - shape _ clusters .",
    "both may provide useful but different kinds of information in biomolecular folding problems .",
    "however @xmath35-means needs one to specify the number of clusters _ a priori _ while the single - linkage does not .",
    "this is a short - coming for @xmath35-means since we do nt have such information in advance .",
    "so in this paper , single - linkage is chosen as the basic scheme and @xmath35-means is only used in comparative studies , when we already know the number of clusters from single - linkage .",
    "other choice of clustering methods includes average - linkage , complete - linkage , spectral clustering @xcite , _ etc .",
    "_ , which are however not pursued in this paper .",
    "recently , @xcite performed serial replica exchange molecular dynamics ( sremd)@xcite simulations of the gcaa tetraloop ( 5-gggcgcaagccu-3 ) on the folding@home distributed computing platform .",
    "the hairpin motif consists of a primarily watson - crick base - paired stem capped with a loop of unpaired or non - watson - crick base - paired nucleotides , as shown in figure  2 ( a ) . despite their simple structures ,",
    "there is some debate over whether or not there are intermediate states in the folding of hairpins , _",
    "e.g. _ see @xcite .    with the technique developed in this paper , we are able to disclose the structures of multiple intermediate states on the folding pathways , which in the first time provides structural evidence from computer simulations about rna hairpin folding pathways",
    ". the biological implications of this discovery are discussed in detail by bowman _",
    "_ @xcite . here",
    ", we only focus on details of data analysis .    the rna molecule examined here",
    "has @xmath38 atoms . including the solvent there are about @xmath39 atoms in the system , yielding @xmath40 parameters . to reduce the dimensionality of this large space we chose to represent each configuration with a contact map .",
    "contact maps can faithfully describe the base - pair interactions in the stem , which provides important structural information of rna hairpin folding .",
    "a contact map is a bit string specifying pairs of contacting residues that are not immediately adjacent in the sequence .",
    "thus , even this coarse - grained space is @xmath41 .",
    "following bowman _ et .",
    "@xcite , we define the _ native state _ as any conformation with all four stem base - pair contacts formed .",
    "each of these base - pair contacts is referred to as a native contact . for example , figure 2 ( a ) shows a native state whose contact map model is illustrated in ( b ) .",
    "an _ unfolding _ event is defined as the set of conformations between the first point with no contacts between any two residues on opposite sides of the stem and the first preceding point with four native contacts .",
    "a _ refolding _ event is defined as the set of conformations between the first point with no contacts between any two residues on opposite sides of the stem and the first subsequent point where the number of native contacts is four .",
    "mapper is an ideal tool for such a problem due to the enormous size of the simulation dataset , the high probability of non - convex states , and the need to identify folding intermediates with low populations relative to the folded and unfolded states .",
    "application of mapper to this data set revealed a number of intermediate states .",
    "the data generated from sremd simulations is normally dominated by the folded and unfolded structures .",
    "for example , a typical refolding trajectory starts from an unfolded state , undergoing a significant period of stochastic fluctuation around that , then proceeds gradually to the folded state .",
    "it is in the neighborhood of folded states that interesting structural information about folding pathways are exhibited .",
    "therefore , in the construction of the conditional density filters , we treat folding and unfolding separately . in the study of folding pathways , we take configurations from refolding events , and then weight heavily a neighborhood around the native states .",
    "however in the study of unfolding pathways , we sample from unfolding events , and focus on a neighborhood of the unfolded states .    the following parameters are used to produce the results in figure  3 .",
    "we use the hamming distance @xmath42 between a pair of contact maps in the conditional density function ( equation ) and choose @xmath43 in kernel . for simplicity ,",
    "the importance weights are set to one within the neighborhood of the state of interest and zero otherwise . in refolding events",
    ", we choose a neighborhood within 7-bit hamming distance from the native state in figure  2 . in unfolding events ,",
    "a neighborhood of the extended state is chosen as the set of configurations with no more than 6 non - adjacent contacts formed . in the level - set formation",
    ", the filter is divided into 8 levels of equal size with @xmath44 overlap . in the clustering ,",
    "a histogram with 5 bins is used , with thresholding from top bins consisting largest @xmath45 edges and the cluster pruning size @xmath46 of the level sample size .",
    "more details on parameter tuning will be provided in the supporting information .",
    "the graphical output of mapper with such parameters shows distinct pictures about folding and unfolding pathways .",
    "unfolding has a single dominant pathway characterized by unzipping from the end base - pair ( figure  3 ( a ) ) , while folding process has two dominant pathways , passing through either the formation of the closing base - pair or the end base - pair ( figure  3 ( b ) ) .",
    "such an observation reveals a number of intermediate states in the folding process , which supports the multi - state hypothesis .",
    "it is interesting to notice in figure  3 that conditional density filters seem good indicators of reaction coordinates , suggesting that the folding / unfolding processes start from the densest zone and become sparser as the reactions proceed .",
    "are the two pathways in refolding ( figure  3 ( b ) ) are truly separate pathways or just the artifact of noise ?",
    "this question can be answered from the kinetic information of simulation trajectories by computing the transition probability .",
    "note that our purpose here is not to create a markov model @xcite for metastable states , but investigate how the two intermediate states in refolding pathways are kinetically connected .",
    "therefore the shortest lag time , 2  ps , is chosen which provides the finest resolution in simulation trajectories .",
    "to simply the result , we merge the four nodes with extended structures as a single unfolded state , u , and collapse the three blue nodes with folded structures as folded state , f , leaving alone the two intermediates , i1 and i2 .",
    "this does not change the topology of mapper graph , but highlights the dynamics associated with intermediate states .",
    "configurations in simulations are mapped to such four - node states by nearest neighbor method .",
    "one - step ( 2 ps ) transition probability are then computed among the four states .",
    "the result is shown in figure  4 .",
    "it can be seen that the two intermediates , i1 and i2 , are kinetically well separated on folding pathways .",
    "once the simulation climb up the energy barrier i1 and i2 , the majority will either proceed to f or withdraw to u , while an ignorable minority will cross the intermediates from i1 to i2 .",
    "conditional density filters play a crucial role here , without which clustering methods like k - means or single - linkage tend to split the sparse intermediates and lump them with densest clusters .    to see this ,",
    "we make a comparison between mapper clusters found in figure  3 ( b ) and @xmath47-means clustering on the same data set .",
    "since the number of @xmath47-means clusters is not unknown _ a priori _ , we performed a series of experiments with @xmath35 varying from 1 to 80 , each of which has 20 repeated experiments . our first purpose is to locate the value of @xmath35 around which the mapper cluster with end base - pair formed becomes identifiable .",
    "hence for each @xmath47-means experiment , we count the number of the end base - pair clusters , defined as the clusters containing more than @xmath48 configurations with native contact 4 ( figure  2 ( b ) ) formed , and less than @xmath44 for any other native contact . figure  5 plots a rough distribution of the numbers of end base - pair clusters against the growth of @xmath35 .",
    "it can be seen that around @xmath49 this intermediate state becomes identifiable , in the sense that with more than 1/2 probability such clusters are found indicated by nonzero medians .",
    "notice that as @xmath35 grows , the variation range ( @xmath50 ) of such cluster numbers expands , showing a trend of increasing instability . particularly around @xmath51 ,",
    "such a state begins to split into several @xmath47-means clusters .",
    "we can further see how @xmath47-means clusters might split the intermediate states and lump them toward densest clusters .",
    "figure  6 illustrates this when @xmath52 for @xmath47-means clustering , on the same data set for the construction of mapper clusters on refolding pathways .",
    "single - linkage clustering is motivated by its ability to identify possibly non - convex clusters of unknown number .",
    "it is also interesting to explore other clustering methods such as k - means which tries to group data in _ spherical _ clusters and is widely used in the studies of biomolecular folding simulations . given the cluster number returned by single - linkage , comparisons with k - means of similar number of clusters on the same level sets might disclose how far the intermediate states deviate from spherical shapes . for this purpose , we perform k - means clustering on the same data set for refolding pathways in figure 3 ( b ) .",
    "we use the same number of clusters returned by single - linkage and especially on level five we set @xmath53 .",
    "it turns out that k - means finds two clusters on level five with similar structural features to single - linkage , _",
    "i.e. _ one with closing base - pair formed and the other with the end base - pair .",
    "however k - means has different partition : @xmath54 vs. @xmath55 , in contrast to @xmath56 vs. @xmath57 in single - linkage . clearly to form spherical clusters , k - means",
    "clusters mix more configurations from different single - linkage clusters , which can be shown by the percentage dropping of dominant end base - pair from @xmath58 to @xmath59 in the smaller cluster .",
    "however the structural similarity in both methods suggests that single - linkage clusters are not very far from spherical shapes .",
    "although a biomolecular system is typically described by a high dimensional configuration space , it is expected that those configurations often visited in a folding process may concentrate around some low - dimensional manifolds which might be described by a much smaller number of reaction coordinates .",
    "recently das _ et .",
    "@xcite shows that isomap can be applied to recover such reaction coordinates in simple folding processes with a single pathway .",
    "isomap tries to preserve both the local and global geodesic distance between configurations defined as shortest path distance on a neighborhood graph .",
    "however , isomap might not work in complex problems where multiple pathways exist .",
    "isomap requires that the data manifold are globally isometric to a convex domain of low dimensional space @xcite .",
    "the existence of more than two pathways connecting two metastates , may lead to holes in sampled regions which fails the convex domain assumption . moreover , isomap is too sensitive to the metric in choice . in this paper",
    "we use a coarse metric as hamming distance for contact maps , where the geodesic distance between configurations does not reflect the distance in folding process . moreover",
    ", the high heterogeneity in distribution is also a hurdle for isomap technique to identify useful intermediates .",
    "the last two issues also challenge other techniques for nonlinear dimensionality reduction , such as lle @xcite , laplacian eigenmap @xcite , hessian eigenmap @xcite , and diffusion map @xcite , _ etc .",
    "_ these geometric embedding techniques maps the data in high dimensional spaces to a low dimensional space by preserving some local metric relations among neighbors of data points , _",
    "e.g. _ see @xcite .",
    "they are thus sensitive to the metric in choice and heterogeneous distribution might distort local metrics . in applications to complex biomolecular systems ,",
    "successful examples are only found in simple settings such as with a single protein folding pathway @xcite or quasi - steady state in dynamics of signal transduction networks @xcite .",
    "however , as a topological tool mapper with density filters is shown efficient in dealing with heterogeneous distributions and less sensitive to the metric in choice . in this paper",
    "even with such a coarse metric as hamming distance , it efficiently discloses structural information in pathways which are difficult to other geometric embedding techniques .",
    "thus , one of our ongoing directions is to combine the topological tool mapper with those geometric embedding techniques , such as applying nonlinear dimensionality reduction separately on components or clusters discovered by mapper .",
    "in this paper we develop mapper , a topological data analysis tool , in the analysis of simulation data for biomolecular folding pathways . as an application , in the first time we are able to obtain structural evidence from computer simulations in support that rna hairpin folding has two dominant pathways with multiple intermediate states .",
    "it is thus a promising direction to explore with mapper such structural information in biomolecular folding problems .",
    "we have shown that with proper designs of conditional density filters and clustering schemes , mapper can address the heterogeneity issue in distribution , deal with multiple pathway data with nontrivial topology , and be less sensitive to the metric in choice .",
    "these features can be used to enhance traditional nonlinear dimensionality reduction methods , such as isomap , laplacian eigenmap , diffusion maps , etc .",
    "one of our ongoing direction is to explore the combinations of the topological tool mapper with those geometric tools for better characterizations of biomolecular systems .",
    "only a limited use of data has been pursued for mapper in this paper , where we ignore the kinetic information in simulation trajectories . since we did not take into account the kinetic information in building up the model , the intermediate states we identify are thermodynamically relevant states , but not necessarily to be kinetically relevant states .",
    "our future direction is to incorporate such kinetic information for developments of novel dynamical models .",
    "yy would like to thank wing - hung wong , nancy zhang , and qing zhou for helpful discussions , xh thanks michael levitt for his support .",
    "we also thank the world - wide folding@home users for providing computing resources .",
    "chodera , j. d. , singhal , n. , pande v. s. , dill , k. a. , and swope w. c. ( 2007 ) automatic discovery of metastable states for the construction of markov models of macromolecular conformational dynamics .",
    "_ j. chem .",
    "_ , * 126 * ( 15 ) , 155101 .            coifman , r. r. , lafon , s. , lee , a. b. , maggioni , m. , nadler , b. , warner , f. and zucker , s. w. ( 2005 ) geometric diffusions as a tool for harmonic analysis and structure definition of data : diffusion maps .",
    "usa _ * 102 * , 7426 - 7431 .",
    "das , p. , moll , m. , stamati , h. , kavraki , l. e. and clementi c. ( 2006 ) low - dimensional , free - energy landscapes of protein - folding reactions by nonlinear dimensionality reduction .",
    "usa _ * 102 * , 10141 - 10146 .",
    "barbano , p. , spivak , m. , flajolet , m. , nairn , a. c. , greengard , p. and greengard , l. ( 2007 ) a mathematical tool for exploring the dynamics of biological networks .",
    "usa _ * 104 * , 19168 - 19174 .",
    "huang , x. , bowman , g. r. and pande , v. d. ( 2008 ) convergence of folding free energy landscapes via application of enhanced sampling methods in a distributed computing environment .",
    "_ j. chem .",
    "_ preprint .           in both cases ,",
    "the top row graphs are the outputs from mapper , while the bottom row depicts the mean contact maps of the corresponding clusters . for clarity in mean contact maps we drop those mean contacts lower than @xmath60 .",
    "the node colors from red to blue indicate the density from high to low , and the labels ( _ e.g. _ @xmath61 ) show the percentage of configurations of the same level included in the cluster corresponding to the node .",
    "we dropped all the clusters of size smaller than @xmath62 of the level size .",
    "( a ) shows that unfolding has a single dominant pathway characterized by unzipping from the end base - pair .",
    "( b ) shows that folding process has two dominant pathways , passing through either the formation of the closing base - pair or the end base - pair .",
    "a noisy cluster consisting @xmath62 of the level size was also shown in ( b ) , which accounts for reptation , _",
    "i.e. _ sliding of the two strands of the stem . , scaledwidth=60.0% ]     transition probability from two intermediate states .",
    "lag time is @xmath63 .",
    "the left four nodes as extended structures ( figure  3 ( b ) ) are merged into node u , and the right three nodes as folded structures are collected in node f. the two intermediate states on pathways are denoted by i1 and i2 , respectively . the transition probability from i1 and i2 to other states",
    "are noted as numbers on the arrows .",
    "one can see that i1 and i2 are kinetically separated . ]",
    "the number of end base - pair clusters found by @xmath47-means . here",
    "@xmath35 ranges from 2 to 80 with step 2 . for each @xmath35",
    ", 20 experiments are repeated with @xmath47-means clustering . the number of clusters with end base - pair formed are recorded .",
    "the star is the median of such numbers and the bar delimits the distribution range from @xmath64 to @xmath65 . starting from around @xmath49 ,",
    "such clusters appear with at least 1/2 probability . around @xmath51 ,",
    "such clusters begin to split .",
    "the instability of @xmath47-means clusters is increasing as @xmath35 grows , indicated by the expanding ranges . ]",
    "k - means clustering fails to capture the low density intermediate states with one end base - pair formed .",
    "the illustration here chooses @xmath52 for @xmath47-means clustering .",
    "( a ) shows how end base - pair formed structures are distributed in different k - means clusters ; ( b ) illustrates the mean structures of the top eight k - means clusters ( gray ) which contain base - pair formed structures .",
    "@xmath47-means splits the mapper cluster and lumps them with densest clusters.,scaledwidth=60.0% ]"
  ],
  "abstract_text": [
    "<S> * characterization of transient intermediate or transition states is crucial for the description of biomolecular folding pathways , which is however difficult in both experiments and computer simulations . </S>",
    "<S> such transient states are typically of low population in simulation samples . even for simple systems such as rna hairpins , recently there are mounting debates over the existence of multiple intermediate states . in this paper </S>",
    "<S> , we develop a computational approach to explore the relatively low populated transition or intermediate states in biomolecular folding pathways , based on a topological data analysis tool , mapper , with simulation data from large - scale distributed computing . </S>",
    "<S> the method is inspired by the classical morse theory in mathematics which characterizes the topology of high dimensional shapes via some functional level sets . in this paper </S>",
    "<S> we exploit a conditional density filter which enables us to focus on the structures on pathways , followed by clustering analysis on its level sets , which helps separate low populated intermediates from high populated uninteresting structures . </S>",
    "<S> a successful application of this method is given on a motivating example , a rna hairpin with gcaa tetraloop , where we are able to provide structural evidence from computer simulations on the multiple intermediate states and exhibit different pictures about unfolding and refolding pathways . </S>",
    "<S> the method is effective in dealing with high degree of heterogeneity in distribution , capturing structural features in multiple pathways , and being less sensitive to the distance metric than nonlinear dimensionality reduction or geometric embedding methods . </S>",
    "<S> the methodology described in this paper admits various implementations or extensions to incorporate more information and adapt to different settings , which thus provides a systematic tool to explore the low density intermediate states in complex biomolecular folding systems . * </S>"
  ]
}