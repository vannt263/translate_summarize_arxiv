{
  "article_text": [
    "the wakefield forces from the interaction of electrons with external materials and from the interactions of electrons inside the beam through radiation have significant effects on the electron beam quality for next generation light sources .",
    "those wakefields can cause the loss of beam energy , increase the beam energy spread , increase beam emittance through the magnetic bunch compressor , and drive microbunching instability through the linac . including the wakefield effects in a beam dynamics tracking code is crucial for designing a beam delivery system for next generation light sources and",
    "has been included in a number of tracking codes  @xcite .",
    "the numerical calculation of the wakefield forces on electrons involves calculating a convolution between the wake function and the charge density of the beam .",
    "the direct numerical calculation of the convolution for the wakefield has a computational cost scaling as @xmath4 , where @xmath1 is the number of grid points in the computational domain .",
    "fortunately , such a discretized convolution summation on a uniform grid can be calculated using a cyclic summation on a doubled computational domain using an fft based method  @xcite .",
    "this reduces the computational cost from @xmath4 to @xmath0 . in our previous study , we have developed a high - order fft based method to numerically calculate the convolution with a smooth kernel  @xcite . in this paper , we extend the previous study by applying a high - order simpson quadrature rule to the wakefield convolution with finite discontinuity of the kernel .",
    "we then apply this method to the calculation of the wakefields from an external resonator wake function ( an approximation to the ac resistance wall wake function ) and from a steady - state csr wake function .",
    "the organization of the paper is as follows : after a brief introduction , we present the computational method in section 2 , application examples to calculate the wakefield forces from an external resonator wake function and from a steady - state csr wake function in section 3 , and final summary in section 4 .",
    "we consider the longitudinal wakefield on an electron at longitudinal location @xmath5 inside an electron beam can be written as @xmath6 where @xmath7 is the wake function from the interaction of electrons with external materials such as resistive wall wake or the interaction among electrons themselves such as the coherent synchrotron radiation ( csr ) inside a bending magnet , and @xmath8 is the beam line density distribution .",
    "for the external wake function , the variable @xmath5 stands for @xmath9 , where @xmath10 is the time of flight difference with respect to the head of the beam , and @xmath11 is the speed of light in vacuum . for the csr wake function , the variable @xmath5 stands for the longitudinal spatial position .",
    "the above convolution integral can be written as the summation of @xmath12 equal subinterval integrals : @xmath13 where @xmath14 .",
    "for the integral between @xmath15 and @xmath16 , the closed newton - cotes formula of degree @xmath17 at @xmath18 equally spaced points can be written as @xmath19 where @xmath20 , @xmath21 , and the weight @xmath22 is associated with integral of the @xmath23 lagrange basis polynomial . for @xmath24 ,",
    "this is known as the trapezoidal quadrature rule ; for @xmath25 , this is the simpson rule ; for @xmath26 , simpson s @xmath27 rule ; for @xmath28 , boole s rule , etc  @xcite . using the extended three - point simpson rule on a uniform grid , the above convolution integral can be approximated as @xmath29 where @xmath3 is the grid size , and @xmath30 is the numerical approximation of the convolution integral . for a grid point @xmath31 , if @xmath32 is an odd number , the simpson quadrature rule yields @xmath33 if @xmath32 is an even number , it yields @xmath34 where the kernel function @xmath35 is given by @xmath36 and @xmath37 with @xmath38 .",
    "the above numerical summation can be rewritten as @xmath39 with @xmath40 for odd grid number @xmath32 , and @xmath41 for even grid number @xmath32 , and the modified wake function @xmath42 is given by @xmath43    the direct calculation of the above summation requires @xmath44 operations for a single point @xmath31 , where @xmath45 . to obtain the convolution for all @xmath1 points on the grid , the total computational cost will be @xmath4 .",
    "fortunately , the above convolution summation can be replaced by a cyclic summation in the double - gridded computational domain : @xmath46 where @xmath47 ,  @xmath48 and @xmath49 where the new density function @xmath50 and the new wake function @xmath51 have the properties : @xmath52 where @xmath53 . from above definition",
    ", one can show that the cyclic summation gives the same value as the convolution summation within the original domain , i.e. @xmath54 in the cyclic summation , the kernel is a discrete periodic function in the doubled computational domain .",
    "this cyclic summation can be calculated using the fft method , i.e. @xmath55 here , @xmath56 denotes the inverse fft of the function @xmath57 that is given by @xmath58 where @xmath59 and @xmath60 denote the forward fft of the function @xmath61 and the @xmath62 respectively .",
    "the computational operations required to calculate cyclic summation using the above fft method is of @xmath63 .",
    "as an illustration , we use the above method to calculate the wakefields inside an electron beam from a resonator wake function and from the csr wake function . the resonator wake function is given as  @xcite @xmath64 where @xmath65 is the separation between the observation point and the source point , @xmath66 is the characteristic length of the wake , @xmath67 is the radius of the pipe , @xmath68 is the conductivity of the pipe material , @xmath69 is the vacuum impedance , @xmath70 is the normalized relaxation time , and @xmath71 is the relaxation time .",
    "this wake function provides a good approximation to the ac resistive wall wake function at large @xmath72  @xcite .",
    "figure  [ fig1 ] shows the normalized wakefield in an electron beam moving inside a copper pipe ( @xmath73 ) computed using the above algorithm .",
    "the beam has an rms bunch length of @xmath74 and a gaussian current distribution . the electron beam loses energy to the wall due to the resistance of the conducting pipe . to verify the accuracy of the above algorithm , figure  [ figrwkerr ] shows the errors of the calculated wakefield at the center of the bunch as a function of the number of grid points . as a comparison , we also give the errors using the trapezoidal quadrature rule .",
    "as expected , the above simpson rule method converges much faster than the trapezoidal rule based method .",
    "the accuracy of the simpson rule calculated wakefield increases by more than an order of magnitude as the number of grid points doubles .",
    "another application example of above numerical method is to calculate the wakefield force from the one - dimensional steady state csr wake .",
    "the one - dimensional csr wake function is given as  @xcite @xmath75 and @xmath76 where @xmath77 is the normalized longitudinal separation between the source point and the observation point , @xmath78 is the radius of the bending magnet , and @xmath79 is the relativistic factor of the electron beam .",
    "the direct application of the above method with different number of grid points is shown in fig .",
    "[ figcsrwkfld ] for a @xmath80 nc gaussian beam with @xmath81 micron rms bunch length at @xmath82 mev .",
    "it is seen that a few thousand grid points are needed in order to obtain a numerically converged wakefield .",
    "this large number of grid points is needed due to the sharp variation of the csr wake function around @xmath83 as shown in fig .",
    "[ figcsrwake ] .",
    "it is seen that outside this short range ( about a few micron in this example ) around zero , the csr wake function is much smoother and can be approximated by an asymptotic function @xmath84 .",
    "recently , an integrated green function method with linear basis was proposed to treat the csr wake function including the short range effect  @xcite . here , we propose a modified simpson rule method by separating the range of the original csr wake function into two regions : one small region around the zero covering the short range csr interaction , and the remainning region covering the long range interaction .",
    "the integral for the csr wakefield can be written as : @xmath85 where @xmath86 is a small distance around the zero to separate the long - range csr interaction from the short - range interaction .",
    "the first integral in the above equation can be calculated using a simpson quadrature rule as shown in the previous section .",
    "using the parameters in the above example with @xmath87 and the simpson quadrature rule , we calculated the errors at the center of the bunch as a function of the number of grid points for the first integral in eq .  [ csr ] .",
    "the results are shown in fig .",
    "[ figerr2 ] .     using the simpson rule . ,",
    "width=283 ]    as expected , the error of the integral decreases by more than an order of magnitude as the number of the grid points doubles .    the second integral in the eq .",
    "[ csr ] will be calculated using an integrated green s function method with constant current density basis functions given the fact that the csr wake function varies sharply while the line density changes slowly inside such a short - range interval . at each grid point",
    "@xmath31 , the interval @xmath88 $ ] is subdivided into @xmath89 number of sub - intervals with a length @xmath90 .",
    "this integral can now be rewritten as : @xmath91 where @xmath92 . since the @xmath86 is small ( o(@xmath93 ) ) ,",
    "only a small number of sub - intervals are needed .",
    "assuming that the current density is constant within each sub - interval , the above integral can be approximated as : @xmath94 the integral with respect to the wake function in above equation can be done numerically if an analytical solution is not available .",
    "fortunately , in the case of the steady - state csr wake function , there exists an analytical solution for the integral of the wake function  @xcite , i.e. @xmath95/a\\end{aligned}\\ ] ] where @xmath96 and @xmath97 , and @xmath98 . using this modified simpson rule",
    ", we recalculated the csr wakefield inside the electron beam using @xmath81 sub - intervals inside the short range around @xmath99 and @xmath100 grid points for the rest of the region .",
    "the results are shown in fig .",
    "[ figcsrfldcmp ] together with the direct simpson rule calculation using @xmath101 grid points .",
    "grid points ) and the direct simpson rule ( @xmath101 grid points).,width=283 ]    it is seen that the wakefield from the modified simpson rule agrees with the high resolution direct simpson rule very well even with only @xmath102 grid points .",
    "in this paper , we present a fast high - order method for numerical calculation of the wakefield on electrons inside an electron beam . using the simpson quadrature rule ,",
    "we present examples to calculate the wakefields from the resonator wake function and from the csr wake function . these examples can have @xmath2 accuracy with a @xmath0 computational cost .",
    "besides the fast speed and potential high numerical accuracy , the above csr wakefield calculation also uses the direct line density instead of the first derivative of the line density with numerical filtering of the density as suggested in reference  @xcite .",
    "this paper gives application examples to the calculation of the longitudinal wakefield for an electron beam .",
    "the same method can also be applied to the calculation of the transverse wakefields inside an electron beam using a modified density function .",
    "this research was supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 .",
    "this research used resources of the national energy research scientific computing center .",
    "9 j. qiang , r. d. ryne , s. habib , v. decyk , j. comp .",
    "163 , 434 , ( 2000 ) .",
    "j. qiang , r. d. ryne , m. venturini , a. a. zholents , i. v. pogorelov , phys .",
    "beams , 12 , 100702 ( 2009 ) .",
    "m. borland , anl advanced photon source report no .",
    "ls-287 , 2000 .",
    "k. bane , p. emma , in proc . of pac05 ,",
    "r. w. hockney and j. w. eastwood , _",
    "computer simulation using particles _ , adam hilger : new york , 1988 . w. h. press , b. p. flannery , s. a. teukolsky , and w. t. vetterling,_numerical recipes in fortran : the art of scientific computing _ ,",
    "cambridge , england : cambridge university press , 1992 . j. qiang , s. lidia , r. d. ryne , and c. limborg - deprey , phys . rev .",
    "beams * 9 * , 044204 ( 2006 ) .",
    "robert d. ryne , on fft - based convolutions and correlations , with application to solving poisson s equation in an open rectangular pipe , arxiv:1111.4971 ( 2011 ) .",
    "j. qiang , comp .",
    "18 , 313316 , ( 2010 ) .",
    "m. abramowitz and i. a. stegun , eds .",
    "_ handbook of mathematical functions with formulas , graphs , and mathematical tables _",
    ", new york : dover , 1972 .",
    ". k. l. f. bane , `` resistive wall wakefield in the lcls undulator beam pipe , '' slac - pub-10707 , revised october 2004 .",
    "e. l. saldin , e. a. schneidmiller , m. v. yurkov , nucl .",
    "res . a 398 , pp .",
    "373 - 394 , 1997 .",
    "r. d. ryne , b. carlsten , j. qiang , n. yampolsky , `` a model for one - dimensional coherent synchrotron radiation including short - range effects , '' arxiv:1202.2409 ( 2012 ) .",
    "j. b. murphy , s. krinsky , and r. l. gluckstern , particle accelerators , vol 57 , pp .",
    "9 - 64 , 1997 .",
    "m. borland , phys .",
    "sepecial topics - accel . beams 4 , 070701 ( 2001 ) ."
  ],
  "abstract_text": [
    "<S> in this paper we report on a high - order fast method to numerically calculate wakefield forces in an electron beam given a wake function model . </S>",
    "<S> this method is based on a newton - cotes quadrature rule for integral approximation and an fft method for discrete summation that results in an @xmath0 computational cost , where @xmath1 is the number of grid points . using the simpson quadrature rule with an accuracy of @xmath2 , where @xmath3 is the grid size </S>",
    "<S> , we present numerical calculation of the wakefields from a resonator wake function model and from a one - dimensional coherent synchrotron radiation ( csr ) wake model . </S>",
    "<S> besides the fast speed and high numerical accuracy , the calculation using the direct line density instead of the first derivative of the line density avoids numerical filtering of the electron density function for computing the csr wakefield force . </S>"
  ]
}