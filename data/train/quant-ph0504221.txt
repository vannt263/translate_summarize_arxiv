{
  "article_text": [
    "[ 1 ] n. gisin , g. ribordy , w. tittel , and h. zbinden , rev .",
    "mod . phys .",
    "74 , 145 - 195 ( 2002 ) .",
    "[ 2 ] d. gottesman , h .- k .",
    "lo , n. ltkenhaus , and j. preskill , quant .",
    "inf . comp .",
    ", 4(5 ) , 325 - 360 ( 2004 ) .",
    "[ 3 ] c. h. bennett , and g. brassard , in proceedings of the ieee international conference on computers , systems and signal processing , bangalore , india , ( ieee , new york , 1984 ) , pp.175 - 179 .",
    "[ 4]w .- y .",
    "huang , phys .",
    "91 , 057901 ( 2003 ) .",
    "[ 5 ] x .- b .",
    "wang , phys .",
    "94 , 230503 ( 2005 ) .",
    "[ 6 ] h .- k .",
    "lo , x. ma , k. chen , phys .",
    "94 , 230504 ( 2005 ) ; x. ma , b. qi , y. zhao , h .- k .",
    "lo , arxiv : quant - ph/0503005 ( pra , in press ) .",
    "[ 7 ] it has been proved that si attack is optimal when eve attacks on the single photon : n. ltkenhaus , phys . rev . a 61 , 052304 ( 2004 ) .",
    "[ 8 ] in this paper , the quantity @xmath53 includes imperfection of bob s single photon detectors .",
    "we assume that eve maybe has the ability to control the detection efficiency of bob s apparatus , e.g. , eve may change the wavelength of alice s photon to be more sensitive to bob s detectors .    [",
    "9 ] n. ltkenhaus , m. jahma , new j. phys . 4 , 44.1 - 44.9 ( 2002 ) .",
    "[ 10 ] from @xmath81 , we know that the probability @xmath18 decreases exponentially with the number @xmath14 increasing .",
    "so the probability that one signal pulse contains more than two photons is very small , i.e. , most multiphoton pulses only contain two photons . in this case",
    ", the photon number resolving power is @xmath33 .",
    "[ 11 ] in fact , we can get all @xmath43 uniquely as follow .",
    "the necessary and sufficient condition that eve can redistribution the photon number without being detected is that both @xmath82+\\sum_{j",
    "= n+1}^{\\infty } p^{\\mu } ( j)f(n)=p_{loss}^{\\mu } ( n)$ ] and @xmath83+\\sum_{j = n+1}^{\\infty } p^{\\mu ^{\\prime } } ( j)f(n)=p_{loss}^{\\mu ^{\\prime } } ( n)$ ] are satisfied for all @xmath14 , where @xmath84 is the probability that eve forwards @xmath85 photon(s ) to bob and captures @xmath86 photon(s ) when the photon number is @xmath14 . using the taylor series , we can get that @xmath87 and @xmath88 .",
    "when we apply such taylor series to these equations , we can get every @xmath89 uniquely .",
    "these @xmath84 just correspond to the case that eve captures every photon with the probability @xmath53 , without reference to the value of @xmath0 and @xmath50 . in principle , eve s attacks discussed above can be realized physically .",
    "eve only needs a lossless channel and a bs with the reflection efficiency @xmath53 and the transmission efficiency @xmath22 to split alice s photon .",
    "a detailed discussion will be presented soon .    [",
    "12 ] the @xmath64 comes from two parts , erroneous detections and background contribution .",
    "the background rate @xmath90 is 10@xmath91 typically .",
    "the probability that an arriving signal including two photons in bob s detection apparatus is about @xmath92 ( typically 10@xmath93 ) . in this case ,",
    "precision of @xmath64 will increase when the detector number @xmath32 in our detection apparatus increases .",
    "certainly , the background rate will increase when the number of detector increases .",
    "this requires that @xmath94 @xmath95 .    [ 13 ] on this occasion , we think the most general attack is the coherent multiphoton ( cmp ) attack .",
    "eve s si attack can be described by a unitary transformation with ancilla : u@xmath96 , u@xmath97 @xmath98 .",
    "both the information eve can gain and qber are determined by @xmath99 ( @xmath100u@xmath101 @xmath102 , u@xmath103u@xmath104 @xmath105 @xmath105 .",
    "then eve performs her measurement on ancilla .",
    "if her measurement outcome is @xmath106 , she guesses that state of alice s qubit is @xmath107 . or else , if she finds that her measurement outcome is @xmath108 , @xmath109 , or @xmath110 , she knows that alice prepares the qubit in state @xmath111 . clearly , information eve can gain is determined by the parameter @xmath112 because that @xmath113 are orthogonal to the other states of ancilla .",
    "qber in these attacks are identical because of the same u. thus , it seems that eve s cmp attack is equivalent to that she implements si attack on each photon in the pulse respectively .",
    "a detailed calculation will be presented soon .",
    "some correlative works can be found in : m. curty and ltkenhaus , phys .",
    "a 69 , 042321 ( 2004 ) ; armand niederberger , valerio scarani , nicolas gisin , phys . rev . a 71 , 042316 ( 2005 ) .",
    "[ 14 ] transmission of two - photon pulses can be described as follow : both two photon were blocked by eve .",
    "one was blocked and the other was detected by bob .",
    "both of them were detected in bob s detection apparatus .",
    "if both of two photons were detected in bob s detection apparatus , bob will discard this qubit .",
    "thus , we can obtain that @xmath114 .    c. a. fuchs , n. gisin , r. b. griffiths , c .- s .",
    "niu , and a. pere , phys .",
    "a 56 , 1163 - 1172 ( 1997 ) .",
    "p. shor and j. preskill , phys .",
    "85 , 441 - 444 ( 2000 ) .",
    "[ 17 ] in decoy - state protocols , such upper bound is dependent on both @xmath0 and @xmath41 , @xmath115 , ref.[4,5 ] .    [ 18 ] d. achilles @xmath116 @xmath117 .",
    "51 , 1499 ( 2004 ) .",
    "caption 1 . fig .",
    "1 . outline of bob s detection apparatus . in order to obtain the photon number of an arriving laser pulse ,",
    "bob first sets a group of parallel beam splitter ( bs ) behind the fiber .",
    "every bs was set at the output of the frontal bs . since there are two outputs of each bs , the number of bs increases exponentially as bob s photon number resolving power increases .",
    "assume the number of bs bob used is @xmath32 .",
    "then the photon number resolving power of bob s apparatus ( in a ) is approximate to @xmath33 . the apparatus in b",
    "will be used to obtain the states of the qubit alice sent .",
    "a group of parallel polarization beam splitter ( pbs ) was set in the output of each bs .",
    "there is a single - photon detector ( spd ) at each output of the pbs .",
    "using such apparatus , photon number of arriving signal can be resolved and a precise qber can be achieved .",
    "caption 2 .",
    "2 . eve s and bob s information vs the qber .",
    "@xmath74 is information bob can gain with the qber .",
    "@xmath118 is the information .",
    "the point at which privacy amplification can be implemented is that qber=13.5% ( @xmath119 ) , qber=12.1% ( @xmath120 ) , and qber=10.7% ( @xmath121 ) .",
    "thus , a bigger @xmath0 is allowable in our scheme .",
    "moreover , both the signal pulses and decoy pulses can be used to generate the raw key .",
    "although error - correcting can be performed as long as the qber is lower than 11% [ 16 ] , a small @xmath0 and a lower qber will improve the rate of generating the final key from the sifted key [ 2 ] ."
  ],
  "abstract_text": [
    "<S> it is the first scheme which allows the detection apparatus to achieve both the photon number of arriving signals and quantum bit error rate of the multiphoton pulses precisely . </S>",
    "<S> we show that the upper bound of the fraction of the tagged multiphoton pulses counts is @xmath0 , which is independent of the channel loss and the intensity of the decoy source . </S>",
    "<S> such upper bound is @xmath1 and can not be reduced any longer as long as the weak coherent scouces and high lossy channel are used . </S>",
    "<S> we show that our scheme can be implemented even if the channel loss is very high </S>",
    "<S> . a stronger intensity of the pulse source is allowable to improve the rate of quantum key distribution . </S>",
    "<S> both the signal pulses and decoy pulses can be used to generate the raw key after verified the security of the communication . </S>",
    "<S> we analyze that our scheme is optimal under today s technology .    </S>",
    "<S> quantum key distribution ( qkd ) is a physically secure method , by which private key can be created between two partners , alice and bob , who share a quantum channel and a public authenticated channel [ 1 ] . </S>",
    "<S> the key bits then be used to implement a classical private key cryptosystem , or more precisely called @xmath2 @xmath3 algorithm , to enable the partners to communicate securely .    </S>",
    "<S> an optical qkd system includes the photon sources , quantum channels , single - photon detectors , and quantum random - number generators . in principle , optical quantum cryptography is based on the use of single - photon fock states . however , perfect single - photon sources are difficult to realize experimentally . </S>",
    "<S> practical implementations rely on faint laser pulses in which photon number distribution obeys possionian statistics . </S>",
    "<S> so , eve can get benefits from the multiphoton pulses . </S>",
    "<S> if the quantum channel is high lossy , eve can obtain full information of the final key by using photon number splitting ( pns ) attack without being detected . in gllp </S>",
    "<S> [ 2 ] , it has been shown that the secure final key of bb84 protocol [ 3 ] can be extracted from sifted key at the asymptotic rate @xmath4 where @xmath5 is the quantum bit error rate ( qber ) found in the verification test and @xmath6 , where @xmath7 is the probability of detecting a multiphoton pulse and @xmath8 is the probability that an emitted photon is detected . </S>",
    "<S> this means that both the qber @xmath5 and the fraction of tagged signals @xmath9 are important to generate the secure final key . </S>",
    "<S> it has been shown that eve s pns attack will be limited when alice and bob use the decoy - state protocols [ 4 - 6 ] . in such decoy - state protocols , </S>",
    "<S> the detection apparatus can not resolve the photon number of arriving signals . </S>",
    "<S> thus , eve may use a photon number splitting and resending ( pnsr ) attack on the multiphoton pulses , i.e. , eve replaces one photon of the multiphoton pulses by a false one and forwards the pulses to bob , to eavesdrop alice s information . </S>",
    "<S> therefore , it requires that the communication partners should have the capacity to achieve the qbers of multiphoton pulses . as a matter of fact , </S>",
    "<S> eve s some other attacks , such as coherent multiphoton pulse attack , should also be considered or else security of the final key will be unreliable .    in this paper , we present an experimental detection apparatus which allows bob to achieve the photon number of arriving signals and qber of the multiphoton pulses precisely . </S>",
    "<S> the upper bound of the information eve can gain from channel loss is @xmath0 , no matter how high the channel loss is . </S>",
    "<S> we show that all the multiphoton pulses verified by bob should be discarded in the end . as a consequence , security of the qkd </S>",
    "<S> is only determined by the qber and the intensity of the pulse sources @xmath0 , irrespective of the channel loss efficiency and the intensity of the decoy sources . finally , we discuss and conclude that our scheme is optimal under today s technologies .    at present , </S>",
    "<S> practical `` single - photon '' sources rely on faint laser pulses in which photon number distribution obeys possionian statistics . </S>",
    "<S> most often , alice sends to bob a weak laser pulse in which she has encoded her bit . </S>",
    "<S> each pulse is a priori in a coherent state @xmath10 of weak intensity . since eve and bob </S>",
    "<S> have no information on @xmath11 , the state reduces to a mixed state @xmath12 outside alice s laboratory . </S>",
    "<S> this state is equivalent to the mixture of fock state @xmath13 , with the number @xmath14 of photons distributed as possionian statistics @xmath15 . </S>",
    "<S> the source that emits pulses in coherent states @xmath16 is equivalent to the representation as below : with probability @xmath17 , alice does nothing ; with probability @xmath18 @xmath19 , alice encodes her bit in @xmath14 photons . </S>",
    "<S> thus , eve can use two different eavesdropping strategies to gain information about alice s qubit . </S>",
    "<S> eve first performs a nondemolition measurement to gain the photon number of the laser pulses . </S>",
    "<S> when she finds there is only one photon in the pulses , she implements symmetric individual ( si ) attacks to gain alice s information [ 7 ] . otherwise , </S>",
    "<S> if there are two or more than two photons in the pulses , she will perform some multiphoton attacks on alice s qubit , e.g. , she may implement pns attack on alice s qubit . </S>",
    "<S> the probability of that a nonempty pulse contains more than one photon is that @xmath20 . </S>",
    "<S> it is a fact that the probability of @xmath21 can be made arbitrary small so that weak pulses are practical and have indeed been used in the vast majority of experiments [ 1 ] . </S>",
    "<S> however , in long distance qkd , the channel transmittance @xmath22 [ 8 ] can be rather small . </S>",
    "<S> if @xmath23 , eve can gain full information of bob s final key by using the pns attack [ 9 ] .    </S>",
    "<S> @xmath24 @xmath25 @xmath26 @xmath27 @xmath28 @xmath29 @xmath30 @xmath31 . </S>",
    "<S> in fig . 1 , we present a method to obtain the photon number of the multiphoton pulses . </S>",
    "<S> furthermore , qbers of different multiphoton pulses can also be achieved . in fig . </S>",
    "<S> 1(a ) , there are @xmath32 beam splitters ( bss ) at the end of the fiber . </S>",
    "<S> the probability that two photons were detected in one single - photon detector is approximate to @xmath33 [ 10 ] . </S>",
    "<S> bob can perfectly achieve the photon number of the multiphoton pulses by increasing the number of the bs . in fig . </S>",
    "<S> 1(b ) , there is a polarization beam splitter ( pbs ) at each output of each bs . </S>",
    "<S> obviously , these pbss should be parallel . using alice s public announcement , </S>",
    "<S> bob can obtain the qber with his statistic data . in an uncharacteristic channel , all qbers of different multiphoton pulses </S>",
    "<S> should be identical . </S>",
    "<S> thus , if either the photon number statistics results or the qber is abnormal , alice and bob will know that eve is in line .    </S>",
    "<S> @xmath34 @xmath35 @xmath36 @xmath37 @xmath38 . </S>",
    "<S> in order to detect eve s pns attack , alice and bob will use the @xmath39 decoy - state protocol to verify the security of their communication . suppose alice and bob select @xmath40 as signal source and @xmath41 as the decoy source in our scheme . without eve </S>",
    "<S> s presence , photon number distributions are also poissonian with the channel transmittance @xmath22 , @xmath42 in general , let us assume that eve has a lossless quantum channel . </S>",
    "<S> she implements pns attack on the photon pulses with probability @xmath43 . essentially , the idea of decoy - state is that [ 6 ] @xmath44 the sufficient condition that eve can redistribute the photon number without being detected is that @xmath45+p^{\\mu } ( n+1)p_{eve}(n+1 ) & = & p_{loss}^{\\mu } ( n ) , \\\\ p^{\\mu ^{\\prime } } ( n)[1-p_{eve}(n)]+p^{\\mu ^{\\prime } } ( n+1)p_{eve}(n+1 ) & = & p_{loss}^{\\mu ^{\\prime } } ( n)\\end{aligned}\\ ] ] are satisfied for all @xmath14 with @xmath46 . </S>",
    "<S> @xmath47 implies that eve blocks some single photon pulses to satisfy @xmath48 . </S>",
    "<S> clearly , @xmath49 should be independent of @xmath0 because of the decoy source @xmath50 , vice versa . </S>",
    "<S> solution of @xmath47 is that @xmath51 where we assumed that @xmath52 because @xmath0 is small . </S>",
    "<S> this implies that the distribution of photon number in bob s detection apparatus can be satisfied when eve blocks the single photon pulses with the probability @xmath53 , i.e. , transmittance efficiency of single photon pulses is @xmath22 on this occasion . from the equation @xmath54+p_{eve}(2)\\frac{\\mu ^{2}}{2}e^{-\\mu } = \\eta \\mu e^{-\\eta \\mu } , \\ ] ] we can obtain that @xmath55 which is also independent of @xmath0 . </S>",
    "<S> that is , if eve can perform the pns attack with the probability @xmath56 on the two - photon multiphoton pulses to satisfy the single - photon distribution on bob s detection apparatus . </S>",
    "<S> however , one can obtain that @xmath57>\\frac{(\\eta \\mu ) ^{2}}{2}e^{-\\eta \\mu } .\\ ] ] that is , even all the three - photon multiphoton pulses are blocked , the probability that bob detects two - photon multiphoton pulses will be abnormally higher . </S>",
    "<S> eve has to block both of the two photons of two - photon multiphoton pulses with the probability @xmath58 . </S>",
    "<S> thus , the probability that both of alice s two photons can be detected in bob s detection apparatus is @xmath59 . </S>",
    "<S> eve s such attacks are equivalent to that eve attacks every photon with the probability @xmath53 no matter which pulses it belongs to . in this way </S>",
    "<S> , we can obtain all @xmath43 @xmath60 [ 11 ] . </S>",
    "<S> moreover , such @xmath43 are independent of the intensity of the pulses sources . </S>",
    "<S> that is , decoy - state protocols are inefficient on this occasion . in this case , such attacks are inevitable as long as the channel is lossy . </S>",
    "<S> it is the @xmath61 property of the qkd with weak coherent source and lossy channel .    from the discussion above , we know that the fraction of the two - photon pulses that can be used by eve is that @xmath62 . </S>",
    "<S> since most of the multiphoton pulses are two - photon pulses , we can obtain that @xmath63 in practical long distance qkd , @xmath22 is very small . </S>",
    "<S> thus , the upper bound of the fraction of the multiphoton pulses that eve can gain information without being detected is @xmath0 , which is independent of the channel loss and the intensity of the decoy sources . </S>",
    "<S> consequently , our scheme can be applied no matter how high the channel loss is . if alice and bob verified the absence of eve , i.e. , both the qber and photon number distributions are normal , they can use both the decoy pulses and signal pulses to generate their raw key .    </S>",
    "<S> another question is that eve may use pnsr attack on the multiphoton pulses . without doubt , eve s pnsr attack would cause some additional bit error rate of the multiphoton pulses . fortunately , our scheme is sensitive to the bit error rate of multiphoton pulses @xmath64 [ 12 ] . therefore , our scheme is sensitive to eve s pnsr attack .    @xmath65 @xmath66 @xmath67 . </S>",
    "<S> in a general way , we will assume that eve s ability is only limited by the principles of quantum mechanics . </S>",
    "<S> it is allowable that eve holds a lossless channel and a perfect quantum memory . </S>",
    "<S> therefore , eve can get benefits from noises and channel loss . in order to avoid </S>",
    "<S> being detected , eve will hide all of her attacks in the qber or in the channel loss . </S>",
    "<S> on the other hand , with the same qber , eve can get more benefits from the multiphoton pulses than that from the single photon pulses [ 13 ] . if alice and bob can discard some of the multiphoton pulses , security of the communication will be enhanced . </S>",
    "<S> bob can find out which pulses are multiphoton pulses in our scheme . </S>",
    "<S> he labels such multiphoton pulses and discards them . </S>",
    "<S> the probability that bob detects a multiphoton pulse is @xmath68 @xmath69 . </S>",
    "<S> therefore , the optimal eavesdropping scheme eve may use can be described as follow . </S>",
    "<S> eve implements si attack on the single photon pulses . </S>",
    "<S> she captures every photon with probability @xmath53 in her perfect channel . in this case </S>",
    "<S> , the maximal information eve can gain is given by @xmath70 the probability of the fraction of tagged multiphoton is that @xmath71 . </S>",
    "<S> the probability that eve uses a si attack is that @xmath72 [ 14 ] . in this way </S>",
    "<S> , eve can attack on the communication optimally without being detected .    in one way communication , </S>",
    "<S> the final key is secure if and only if @xmath73 . </S>",
    "<S> in fact , @xmath74 is determined by the unique variable qber since @xmath75 , where @xmath76 . </S>",
    "<S> the maximal information eve can gain by using si attack is given by @xmath77 [ 15 ] . </S>",
    "<S> in general , security of the final key is determined by the parameter @xmath0 , @xmath50 , and @xmath5 . </S>",
    "<S> we give a numerical solution of the security with different @xmath0 and variational @xmath5 in fig . </S>",
    "<S> 2 .    @xmath78 @xmath27 @xmath79 . </S>",
    "<S> today , quantum key distribution over 150 km of commercial telcom fibers has been successfully performed . </S>",
    "<S> the crucial issue in qkd is its security . </S>",
    "<S> experimentally , the source is imperfect and the channel is lossy and noisy . in our experimental scheme , </S>",
    "<S> both photon number of arriving signals and qber can be achieved precisely . </S>",
    "<S> we showed that the upper bound of information eve can gain from in the channel loss is independent of @xmath22 and @xmath41 [ 17 ] , so that our scheme can be used even if the channel loss is very high . in our scheme , </S>",
    "<S> information eve can gain is only determined by qber and @xmath0 . as a matter of fact , eve s such information can not be reduced any longer as long as the weak coherent sources and imperfect quantum channel are used in long distance qkd , so that our scheme is optimal under today s technology .    in summary , </S>",
    "<S> we have discussed the security of practical bb84 qkd protocol with weak coherent sources , noises and high losses . </S>",
    "<S> we have presented a detection apparatus to resolve both the photon number of arriving signals and qber to beat eve s whatever pns attacks . </S>",
    "<S> our scheme is efficient even if the channel loss is very high . </S>",
    "<S> both the signal pulses and decoy pulses can be implemented to generate the raw key after verified the security of the qkd . </S>",
    "<S> a bigger @xmath0 is allowable to improve the rate of generating the raw key . </S>",
    "<S> we have discussed that our scheme is optimal under today s technology .    </S>",
    "<S> @xmath80.after finished our work , we find out the paper [ 18 ] which presented an experimental photon number resolving scheme using time - multiplex technique . </S>",
    "<S> however , our scheme not only can be used to resolve the photon number of multiphoton pulses , but also can be used to achieve the qber of multiphoton pulses .    the author wishes to thank yong - gang tan and qiang liu for their useful discussions and comments . </S>",
    "<S> yong li should be thanked specially . </S>",
    "<S> this work is supported by national nature science foundation of china under grant no . </S>",
    "<S> 10447140 . </S>"
  ]
}