{
  "article_text": [
    "the late - time acceleration of the universe is the most challenging problem in cosmology . within the framework of general relativity ( gr ) , the acceleration originates from dark energy with negative pressure . the simplest candidate for dark energy is the cosmological constant .",
    "however , in order to explain the current acceleration of the universe , the required value of the cosmological constant must be incredibly small .",
    "alternatively , there could be no dark energy , but a large scale modification of gr may account for the late - time acceleration of the universe .",
    "recently considerable efforts have been made to construct models for modified gravity as an alternative to dark energy , and to distinguish them from dark energy models by observations ( see @xcite for reviews ) .",
    "although fully consistent models have not been constructed yet , some indications of the nature of the modified gravity models have been obtained . in general",
    ", there are three regimes of gravity in modified gravity models @xcite . on the largest scales ,",
    "gravity must be modified significantly in order to explain the late time acceleration without introducing dark energy .",
    "on the smallest scales , the theory must approach gr because there exist stringent constraints on the deviation from gr at solar system scales",
    ". on intermediate scales between the cosmological horizon scales and the solar system scales , there can be still a deviation from gr .",
    "in fact , it is a very common feature in modified gravity models that gravity can deviate from gr significantly on large scales .",
    "this is due to the fact that , once we modify gr , there arises a new scalar degree of freedom in gravity .",
    "this scalar mode changes gravity even below the length scale where the modification of gravity becomes significant that causes the cosmic acceleration .    in order to recover gr on small scales ,",
    "it is required to suppress the interaction arising from this scalar mode .",
    "one of the well known mechanisms is the so - called chameleon mechanism @xcite .",
    "a typical example is @xmath0 gravity where the einstein - hilbert action is replaced by an arbitrary function of ricci curvature ( see @xcite for a review ) .",
    "this model is equivalent to the brans - dicke ( bd ) theory with a non - trivial potential .",
    "the bd scalar mediates an additional gravitational interaction , which enhances the gravitational force below the compton wavelength of the bd scalar .",
    "if the mass of the bd scalar becomes larger in a dense environment like in the solar system , the compton wavelength becomes short and gr can be recovered .",
    "this is known as the chameleon mechanism @xcite . in the context of @xmath0 gravity , by tuning the function @xmath2 ,",
    "it is possible to make the compton wavelength of the bd scalar short at solar system scales and screen the bd scalar interaction @xcite .",
    "this mechanism affects the non - linear clustering of dark matter .",
    "we naively expect that the power - spectrum of dark matter perturbations approaches the one in the @xmath3cdm model with the same expansion history of the universe because the modification of gravity disappears on small scales .",
    "then the difference between a modified gravity model and a dark energy model with the same expansion history becomes smaller on smaller scales .",
    "this recovery of gr has important implications for weak lensing measurements because the strongest signals in weak lensing measurements come from non - linear scales .",
    "one must carefully take into account this effect when constraining the model in order not to over - estimate the deviation from gr .    using a concrete example in @xmath0 gravity , refs .",
    "@xcite performed n - body simulations to confirm this expectation .",
    "they showed that , due to the chameleon effect , the deviation of the non - linear power spectrum from gr is suppressed on small scales .",
    "it was also shown that the fitting formula developed in gr such as halofit @xcite failed to describe this recovery of gr and it overestimated the deviation from gr .",
    "@xcite used a multi - grid technique to solve the non - linear equation for the scalar field . to make predictions for weak lensing ,",
    "it is necessary to model the power spectrum on smaller scales .",
    "@xcite derived a fitting formula for the non - linear power spectrum in the so - called post parametrised friedmann ( ppf ) framework @xcite based on perturbation theory and n - body simulations .",
    "@xcite calculated weak lensing signals for the future experiments using this fitting formula .",
    "it was shown that the constraints on the model crucially depend on the modeling of the non - linear power spectrum .",
    "the resolution of n - body simulations performed in refs .",
    "@xcite is limited to @xmath4 a few h mpc@xmath5 for the power spectrum mainly due to that fact that they used a fixed grid size . in this paper",
    ", we exploit a technique to recursively refine a grid to solve the scalar field equation and the poisson equation aiming to probe the power spectrum down to @xmath6 h mpc@xmath5 .",
    "we modify the publicly available n - body simulation code mlapm and add a scalar field solver .",
    "we also study properties of halos in our simulations .",
    "the chameleon mechanism depends on local densities thus its effect depends on the mass of halos .",
    "it is important to quantify the effectiveness of the chameleon mechanism to maximise our ability to distinguish between models .",
    "this paper is organised as follows . in section",
    "ii , we describe our @xmath0 gravity models and present basic equations to be solved . in section iii",
    ", we explain the details of our n - body simulations and how we analyse the simulation data to obtain the power spectrum and halo properties . in section iv , we present the matter power spectrum and properties of halos .",
    "we first use a conservative cut - off for the matter power spectrum to check the consistency of our results with linear predictions on large scales and previous results in refs .",
    "@xcite . then using the high resolution simulations , we present the power spectrum on small scales and develop the fitting formula that captures the effect of the chameleon effects based on the ppf formalism .",
    "we then study the properties of halos by measuring the mass functions and halo density profiles .",
    "we also measure the profiles of the scalar field inside halos to quantify the effects of the chameleon mechanism .",
    "section v is devoted to conclusions .",
    "in this section we briefly summarise the main ingredients of the @xmath0 gravity theory and its properties , which are essential for the simulations and discussions below .",
    "a possible generalisation of gr is to add a term , which is a function of the scalar curvature @xmath7 , to the einstein - hilbert action @xmath8 ( see @xcite for a review and references therein ) [ eq : action ] s=^4x , in which @xmath9 is the newtonian constant and @xmath10 is the lagrangian density for matter fields ( radiation , baryons and dark matter , which in this paper is assumed to be cold ) .",
    "taking a variation of the above action with respect to metric yields the modified einstein equations [ eq : eins ] g_+x_=8t_. here the extra term @xmath11 denotes the modification of gr , [ eq : xab ] x_=f_rr_-(-f_r)g_-d_d_f_r , where @xmath12 denotes an extra scalar degree of freedom , dubbed _ scalaron _ , @xmath13 denotes the covariant derivative with respect to metric and @xmath14 is the laplacian operator . taking the trace of the modified einstein equation eq .",
    "( [ eq : eins ] ) yields [ eq : trace ] f_r=(r - f_r r+2f-8g)=0 , which governs the time evolution and spatial configuration of @xmath15 .",
    "given the function form of @xmath0 , a complete set of equations governing the dynamics of the model is obtained .",
    "we shall work here in an almost friedman - robertson - walker ( frw ) universe with the line element given as , [ eq : ds2 ] ds^2=a^2()\\{[1 + 2(,)]d^2-[1 - 2(,)d^2 ] } , in which @xmath16 is the conformal time , @xmath17 is the scale factor , @xmath18 is the gravitational potential and @xmath19 is the spatial curvature perturbation . subtracting off the background part of this equation ,",
    "we obtain a dynamical equation for the perturbation of the scalaron , [ eq : scalaron ] ^2f_r=-[(f_r)+8_m ] , where @xmath20 , @xmath21 is the three dimensional gradient operator and we work in the quasistatic limit , meaning that we assume the spatial variation of the scalaron is much larger than the time variation , so that we could neglect the time directives of @xmath22 and approximate @xmath23 as @xmath24 . at all redshifts .",
    "we also checked the validity of the quasistatic assumption with our simulations , and found a good consistency with ref . @xcite .",
    "] here the quantities with a bar denotes those evaluated in the cosmological background .",
    "notice that @xmath25 and @xmath26 are not necessarily small , and we call them perturbations just for convenience .",
    "we can also obtain the counterpart of poisson equation for the gravitational potential @xmath18 by adding up the @xmath27 and @xmath28 components of the modified einstein equation eq .",
    "( [ eq : eins ] ) ( see appendix a of @xcite for some useful expressions using the above metric convention ) [ eq : poisson ] ^2 = a^2_m+(f_r ) , in which we have neglected terms such as @xmath29 and @xmath30 as we are working in the quasistatic limit , and used eq .",
    "( [ eq : scalaron ] ) to eliminate @xmath31 .    given the density field , a functional form of @xmath0 and the knowledge of the background evolution , eqs .",
    "( [ eq : scalaron ] ) and ( [ eq : poisson ] ) are closed for the scalaron and the gravitational potential .",
    "these are thus the starting point for our @xmath32-body simulations .",
    "note that the remaining modified einstein equations give a relation between two metric perturbations @xmath18 and @xmath19 [ eq : franiso]^2(-)=^2f_r , where we assumed @xmath33 in the background .",
    "then combining eqs .",
    "( [ eq : scalaron ] ) , ( [ eq : poisson ] ) and ( [ eq : franiso ] ) , we find that the relationship between the lensing potential @xmath34 and the matter overdensity is the same in both gr and @xmath0 scenarios , which is , [ eq : lenspot ] ^2 ( + ) = 8 g a^2 _ m.      it is well known that @xmath0 gravity models can incorporate the so - called chameleon mechanism @xcite , which are vital for their cosmological and physical viability @xcite .",
    "the chameleon mechanism was first proposed in the context of coupled scalar field theories , and used to give the scalar field an environment - dependent effective mass @xmath35 so that @xmath35 is very heavy in dense regions and thus the scalar - mediated fifth force is suppressed locally so as to avoid conflicts with experiments and observations . because the @xmath0 gravity is equivalent to a coupled scalar field theory in the einstein frame with the functional form of @xmath0 related to the potential of the scalar field",
    ", a similar mechanism is needed to ensure that the fifth force in @xmath0 gravity is well within the limits set by experiments .    to see how the chameleon mechanism works in @xmath0 gravity models ,",
    "let us consider their difference from gr . for eq .",
    "( [ eq : scalaron ] ) , @xmath36 vanishes identically in gr , and we have @xmath37 which , substituted into eq .",
    "( [ eq : poisson ] ) , recovers the usual poisson equation for gr,^2=4ga^2_m.therefore , to make chameleon mechanism work , we have to ensure that in eq .",
    "( [ eq : scalaron ] ) @xmath38 is close to zero is only sensitive to the local matter density distribution , which is merely a reflection of the fact that the extra scalar degree of freedom @xmath36 has a heavy mass ( in dense regions ) and can not propagate away from the source ( and as such the fifth force is severely suppressed ) . ] , meaning that @xmath22 must depend on @xmath7 very weakly ( , be nearly constant ) in high curvature region .",
    "furthermore , if @xmath22 deviates significantly from zero , then eq .  ( [ eq : xab ] ) means that the theory will become one with a modified newtonian constant , which is not of our interest .",
    "a necessary condition for the chameleon mechanism to work here is thus @xmath39 at least in the high curvature region to avoid instability in the perturbation growth @xcite . ] .",
    "the functional form of @xmath0 must be carefully designed so that it can give rise to the late time cosmic acceleration of the universe without any conflict with the solar system tests by virtue of the chameleon mechanism .",
    "one such model was studied in @xcite , where @xmath40 with @xmath41 ( @xmath42 corresponds to a cosmological constant ) .",
    "a more interesting model was proposed in @xcite , namely , f(r)= -m^2 , where @xmath43 ; note the minus sign in front of @xmath7 is due to our different sign convention from @xcite . to evade the solar system test",
    ", the absolute value of the scalaron today , @xmath44 , should be sufficiently small .",
    "however the constraint is fairly weak ( @xmath45 ) @xcite and it is satisfied in our models . in this scenario , the scalaron always sits at the minimum of the effective potential defined in eq ( [ eq : trace ] ) , thus , -[r ] |r8g|_m-2|f= 3m^2(a^-3 + ) . to match the @xmath3cdm background evolution",
    ", we need to have = 6 . plugging in the numbers @xmath46 into eq  ( [ r ] ) , we have @xmath47 , which can be used to simplify the expression for the scalaron , [ fr ] f_r=--()^n+1",
    ". therefore we can see that the two free model parameters are @xmath48 and @xmath49 , and the latter is related to the value of the scalaron today via [ eq : fr0 ] = -^n+1f_r0 , we shall concentrate on the models with @xmath50 and @xmath51 in this paper , as in @xcite .    in the linear regime where @xmath52 , we can linearised the scalaron equation by linearsing eq .",
    "( [ r ] ) with respect to a cosmological background [ eq : deltafr ] f_r= - ( n+1 ) |f_r0 ( ) ^n+1 , where @xmath53 is the background curvature and the subscript 0 implies that the quantity is evaluated today .",
    "then the scalaron equation ( [ eq : scalaron ] ) becomes [ eq : linearscalaron ] ^2 f_r= a^2 |^2 f_r - a^2 _ m , where | = _ c^-1= ( ( ) ^n+1 ) ^1/2 . in fourier space",
    ", the solution can be easily obtained as [ eq : dfrfourie ] f_r = .",
    "then it is easy to show that we recover gr above the compton wavelength @xmath54 as @xmath55 is suppressed by the mass term compared with the gravitational potential , @xmath56 .",
    "this is because the scalaron can not propagate beyond the compton wavelength . below the compton wavelength , @xmath57",
    "and we get ^2 = a^2 _ m , which implies that the gravitational constant is enhanced by @xmath58 .",
    "this leads to the scale - dependent enhancement of the linear growth rate .",
    "this linearisation around the cosmological background fails when @xmath55 becomes larger compared with the background field @xmath59 , @xmath60 .",
    "this happens in the dense region because @xmath55 is driven by the matter perturbations @xmath61 . in these dense regions ,",
    "the curvature is large and eq .",
    "( [ eq : deltafr ] ) ensures that @xmath15 is suppressed and gr is recovered , realising the chameleon mechanism . in fig .  1",
    ", we plot the time evolution of the compton wavelength and the background @xmath15 field with @xmath50 and @xmath51 , which is useful to understand the recovery of gr in our simulations .",
    "( upper panel ) and the absolute value of the background scalar field @xmath62 as a function of redshift @xmath63 .",
    "the @xmath0 models of @xmath51 are illustrated using black solid , red dashed and green dash - dot curves respectively . ]",
    "in the model of @xcite , the fifth force due to the propagation of @xmath36 is suppressed by many orders of magnitudes than gravity only in very dense regions , while in less dense regions it has similar strength as gravity .",
    "such a dramatic change of the amplitude of the fifth force across space indicates that eq .",
    "( [ eq : scalaron ] ) should be highly nonlinear , which the readers can convince themselves by appreciating the nonlinearity of @xmath22 [ cf .",
    "( [ fr ] ) ] .",
    "consequently treatments involving linearisation fails to make correct predictions , and @xmath32-body simulations which explicitly solve the nonlinear equation for @xmath36 are needed .    in a series of papers @xcite ,",
    "oyaizu  pioneered in this direction , by solving eq .",
    "( [ eq : scalaron ] ) on a regular mesh to compute the total force on particles .",
    "their results show some interesting and cosmologically testable predictions of the @xmath0 gravity .",
    "however , the resolution of their simulations was limited by their regular mesh . here ,",
    "we perform similar simulations , but with an adaptive grid which self - refines in the high density regions .",
    "this technique has been applied previously in @xcite and works well .",
    "as we are interested in how well the chameleon mechanism actually works , besides the full @xmath0 simulations , we also perform some non - chameleon runs with the chameleon effect artificially suppressed ( see below ) . for clarity we shall refer to these two classes of simulations respectively as full @xmath0 and non - chameleon simulations .",
    "we have modified the publicly available @xmath32-body simulation code mlapm @xcite , which is a self - adaptive particle mesh code , for our @xmath32-body simulations .",
    "it has two sets of meshes : the first mesh includes a series of increasingly refined regular meshes covering the whole cubic simulation box , with respectively @xmath64 cells on each side , where @xmath65 is the size of the domain grid , which is the most refined of these regular meshes .",
    "this set of meshes are needed to solve the poisson equation using multigrid method or fast fourier transform ( for the latter only the domain grid is necessary ) .",
    "when the particle density in a cell exceeds a predefined threshold , the cell is further refined into eight equally sized cubic cells ; the refinement is done on a cell - by - cell basis and the resulted refinement could have arbitrary shape which matches the true equal - density contours of the matter distribution .",
    "this second set of meshes are used to solve the poisson equation using a linear gauss - seidel relaxation .",
    "our core change to the mlapm code is the addition of the routines which solve eq .",
    "( [ eq : scalaron ] ) , which is similar to that in @xcite .",
    "these include :    1 .",
    "we have added a solver for @xmath36 , based on eq .",
    "( [ eq : scalaron ] ) , which uses a nonlinear gauss - seidel relaxation iteration and the same convergence criterion as the default poisson solver of mlapm .",
    "it adopts a v - cycle instead of the default self - adaptive scheme in arranging the gauss - seidel iterations , because the latter is found to be plagued by the problem of oscillations between adjacent multigrid levels , and the convergence is too slow .",
    "the value of @xmath36 solved from the above step is used to complete the computation of the source term for the poisson equation eq .",
    "( [ eq : poisson ] ) , which is solved using a fast fourier transform on the regular domain grids and gauss - seidel relaxation on the irregular refinements .",
    "the value of @xmath18 solved from the above step is used to compute the total force on the particles by a finite difference , and then the particles are displaced and accelerated as in usual @xmath32-body simulations , according to @xmath66    where a subscript @xmath67 denotes code unit .",
    "more details about the code could be found in @xcite .      to implement eqs .",
    "( [ eq : scalaron ] , [ eq : poisson ] ) into our numerical code , we have to rewrite them using code units , which are given by _ c  =  ,  _ c  =  ,  t_c  =  th_0 , + _ c  =  ,  _ c  =  ,  _",
    "c  =  b , where @xmath68 is the size of the simulation box and @xmath69  km / s / mpc .",
    "we also need to choose a code unit for @xmath36 ( or @xmath22 ) , but this is done in different ways for the chameleon and non - chameleon simulations for convenience , and here we shall discuss them separately .      in our full @xmath0 simulations , the quantity @xmath70 in eq .",
    "( [ eq : scalaron ] ) is written in its exact form @xmath71 with @xmath72 where @xmath73 and @xmath74 are respectively the present fractional energy densities for matter and dark energy , and @xmath75 . with the aid of these",
    ", we can rewrite eq .",
    "( [ eq : scalaron ] ) using code units as @xmath76 note that we will drop the subscript of @xmath77 for simplicity from now on .    in the simulations",
    ", @xmath78 spans a range of many orders of magnitude , from @xmath79 in the very dense regions to @xmath80 in the low density regions .",
    "obviously , the above equation is very sensitive to numerical errors in the trial solution to @xmath22 , making it difficult to solve @xmath22 accurately .",
    "furthermore , eq .  ( [ eq : r ] ) indicates that @xmath81 would lead to unphysical ( imaginary ) @xmath7 , and if this happens by accident in the simulations due to the numerical errors ( which is very likely because @xmath39 ) then the computation can not carry on further . to solve these problems ,",
    "we introduce a new variable @xmath82 ( which is slightly different from the choice of @xcite ) .",
    "then , typically @xmath83 , which does not vary much across the simulation box and @xmath84 no matter which value @xmath85 takes .    replacing @xmath22 with @xmath85",
    ", we can rewrite eq .",
    "( [ eq : dfrcode ] ) as ( after some rearrangement ) , @xmath86    similarly , in terms of @xmath85 and using the code units , we can rewrite the poisson equation as , @xmath87    eqs .",
    "( [ eq : sf_codeunit_cham ] , [ eq : poi_codeunit_cham ] ) , after discretisation ( appendix  [ appen : discrete ] ) , can be implemented in the modified mlapm code straightforwardly .      as mentioned above ,",
    "because the chameleon effect is one of the most important features of our @xmath0 model , we also would like to see what happens if we artificially suppress it .",
    "unlike @xcite , in our simulations we achieve this by explicitly linearising the equation for @xmath22 without using the solution for @xmath55 given in eq .",
    "( [ eq : dfrfourie ] ) .",
    "since the chameleon effect originates from the nonlinearity of @xmath22 , the linearisation will largely weaken it , justifying the name non - chameleon simulations .",
    "the linearisation is easily done by simply setting @xmath88 , which changes eq .",
    "( [ eq : scalaron ] ) to c^2 ^ 2f_r= c^2 ^ 2f_r= -_ma^2 - f_ra^2 . in this case",
    ", we find it more convenient to choose @xmath36 as our variable , then using the relation = -m^2^n+2 , we can rearrange the above equation to obtain @xmath89^{n+2}{{\\delta}f_{r}}.\\end{aligned}\\ ] ] note that after the linearisation the mass of the scalaron depends only on the background matter density ; but if @xmath44 is chosen to be small enough ( such that @xmath90 ) the mass can be very heavy , and thus the fifth force still gets suppressed , even though the suppression is not as strong as in the full @xmath0 simulations .",
    "furthermore , the suppression of the fifth force in this case is universal and independent of the local matter density , again justifying its name  non - chameleon model .",
    "similarly , the modified poisson equation appears to be @xmath91^{n+2}{{\\delta}f_{r}}.\\end{aligned}\\ ] ]    eqs .",
    "( [ eq : sf_codeunit_nc ] , [ eq : poi_codeunit_nc ] ) , after discretisation ( appendix  [ appen : discrete ] ) , can be implemented in the modified mlapm code directly .      as the major modification to the mlapm code is for the @xmath36 solver , we have to check carefully whether it works correctly . for this purpose",
    "we have solved eq .",
    "( [ eq : sf_codeunit_cham ] ) around a point - like mass @xcite and compared the result with the analytic solution ; we find that the numerical and analytic solutions agree as well as in @xcite ( fig .  2 there ) .",
    "to avoid repetition we shall not display the results here .",
    "other , indirect , tests of our code include comparing the predicted matter power spectrum to the linear perturbation results to see whether they agree on large scales .",
    "we shall discuss these in turn as the paper unfolds .",
    ".technical indices for the simulations presented in this work .",
    "the quantity @xmath92 denotes the number of realisations we run for each model , @xmath93 is the total number of particles , @xmath94 is the number of domain grids one each side , and @xmath95 and @xmath96 , which are defined in eq .",
    "( [ eq : kcutoff ] ) , show the half nyquist scale and the @xmath97-cutoff we actually used in this work respectively . [ cols=\"^,^,^,^,^ \" , ]      [ [ gr ] ] gr ^^     stacked using @xmath98 mpc / h ( black blocks ) , @xmath99 mpc / h ( red circle ) and @xmath100 mpc / h ( green triangle ) overplotted with the theoretical predications from sheth - tormen ( black dash ) and from tinker _",
    "( blue solid ) ; lower panel : relative difference of the simulation result with respect to the tinker _",
    "_ prediction . ]",
    "we test our mass function in gr firstly by comparing it to the theoretical predictions proposed by sheth and tormen @xcite , and by tinker @xcite .",
    "the comparison is shown in fig .",
    "[ fig : grmf ] .",
    "we stack our results from different boxes to extend the mass range , and we see an agreement with theoretical predictions .",
    "it seems that our simulation underestimates the number of small halos ( halos in the first bin ) because of the lack of particles , but this problem can be alleviated to some extent when taking the ratio of the mass function of @xmath0 with respect to that in gr .",
    "the result for the halo mass function is presented in fig .",
    "[ fig : mf ] .",
    "as one can see , our result at @xmath101 is consistent with that in ref .",
    "@xcite ( cf fig .",
    "2 ) . let us understand our result by looking at the non - chameleon result first . in this case ,",
    "the strength of gravity is enhanced by @xmath58 below the compton wavelength @xmath102 , regardless of the value of @xmath44 .",
    "meanwhile , @xmath102 increases with @xmath44 , making the enhancement on the mass function more pronounced for large @xmath44 models .",
    "this is what we see in fig .",
    "[ fig : mf ] . also , at redshift @xmath101 , the enhancement for larger halos is more significant , while at redshift @xmath103 , smaller halos are more populated .",
    "this is because the stronger gravity in @xmath0 models create more small halos at high redshift and assemble them to make more large halos at low redshift compared with @xmath3cdm models .    for the full @xmath0 simulations at @xmath101 , the number of massive halos",
    "is generally reduced compared to the non - chameleon model predictions , because the suppression of the fifth force due to the chameleon mechanism is stronger in high density regions , where massive halos most likely reside . for the case of @xmath104 , in which chameleon does not work , the full and non - chameleon results agree well , while for the @xmath105 case , the number of large halos is almost the same as the gr prediction due to the chameleon effect . at redshift @xmath103 ,",
    "the suppression starts from lower mass bins simply because chameleon was working more efficiently at higher redshift .",
    "we show the halo profile for the overdensity and for @xmath106 at redshift @xmath103 and @xmath101 in figs .",
    "[ fig : prof - z1 ] and [ fig : prof ] respectively .",
    "we show the results for the halos in three mass ranges : @xmath107 , @xmath108 and @xmath109 m_{\\odot}$]/h , taken from the @xmath110 and @xmath100 simulation boxes respectively .",
    "a quick observation of the result is that on average , the profiles of the overdensity for @xmath0 gravity are similar to that in gr , namely , the relative difference is smaller than 20% in all cases .",
    "this is consistent with the analysis in ref .",
    "the complex patterns of the relative difference of @xmath0 and gr halo density profiles can be understood qualitatively as follows .    1 .   for the f6 simulation ,",
    "the chameleon effect is very efficient throughout the cosmic history and so the fifth force has always been strongly suppressed , so that the predicted halo density profile should be very close to the gr result , which is what we see from figs .",
    "[ fig : prof - z1 ] and [ fig : prof ] ( the only exception is the case of low mass halos at @xmath101 , which is because these halos have lower density and so the chameleon effect is weaker , especially at late times ) .",
    "2 .   for the n6 simulation ,",
    "the fifth force is only weakly suppressed ( especially at late times ) , and the central attractive potential towards the halo centre is stronger than in gr , which means that particles tend to fall towards the halo centres , producing higher density profiles than the latter .",
    "the n5 and n4 results follow the same pattern as n6 , but are more complicated as in some cases the density profile can be even lower than in gr . this is perhaps because the central attractive potential is not the only thing affecting the halo density profile . as the fifth force is unsuppressed from early times , the particles are typically faster than they are in gr , and tend to escape the halo , flattening the density profile .",
    "note that fifth force both deepens the central potential and speeds up the particles , and the latter is an accumulative effect , which makes it difficult to see which effect is dominating .",
    "the f4 simulation agrees with n4 simulation very well at late time , because chameleon effect is insignificant .",
    "but at early times it produces higher density profile than n4 , except for the small halos ( for which chameleon effect is again unimportant ) , which seems to indicate that the particles in the f4 halos are still relatively slow , because the fifth force has not become strong enough for long .",
    "the case of f5 is further complicated by the fact that @xmath111 is a critical point for our @xmath0 models .",
    "for the small halos , the fifth force has just become unsuppressed at @xmath103 , and we see that their density profiles are higher than n5 results for the same reason as above , while at @xmath101 the f5 and n5 simulations agree very well . for the medium - sized halos , at @xmath103",
    "the fifth force is still strongly suppressed and their density profiles are lower than n5 results because the central attractive potential is weaker , while at @xmath101 the fifth force becomes unsuppressed and the density profiles are higher than n5 results again for the same reason as above . for the most massive halos ,",
    "the fifth force is strongly suppressed even at present , and the halo density profiles are lower than in n5 for both @xmath103 and @xmath101 .",
    "therefore we see the following general evolution pattern when comparing the halo density profiles from f and n simulations : at early times the fifth force is strongly suppressed in f simulations , and so the central potential is weaker there , producing lower density profiles ; then the fifth force becomes unsuppressed and the central potential becomes as strong as in n simulations , while the particles are still moving relatively slowly , producing higher density profiles .",
    "this happens at @xmath103 in f4 simulations and @xmath101 in f5 simulations .",
    "finally the particles move fast due to the fifth force , and the density profiles approach the non - chameleon results as is seen in f4 simulations at @xmath101 . the transition happens earlier for models with larger @xmath44 and for smaller halos ( in both cases the fifth force becomes unsuppressed earlier ) . what we see in figs .",
    "[ fig : prof - z1 ] and [ fig : prof ] are just different stages of the above evolution pattern .",
    "this picture is consistent with the behaviour of the power spectrum shown in fig [ fig : pk-64 ] .",
    "once the chameleon mechanism fails and the density profile becomes higher than those in n simulations , the power spectrum in f simulations tend to be higher on smaller scales ( at @xmath103 in f4 simulations and at @xmath101 in f5 simulations ) .",
    "then it approaches non - chameleon results later ( at @xmath101 in f4 simulations ) .",
    "we expect to see the same evolution pattern in f5 and f6 simulations if we would continue our simulations in the future .    in figs .",
    "[ fig : prof - z1 ] and [ fig : prof ] we have also shown the efficiency @xmath106 of the chameleon effect . for the n4 and f4 simulations , we see that @xmath112 almost perfectly for both @xmath103 and @xmath101 , indicating that the chameleon mechanism does not work for @xmath104 .",
    "note that the agreement between n4 and f4 serves as an independent test of our code , as the treatments for these simulations are very different . for the n5 and f5 simulations",
    ", we see that @xmath106 is close to one for the small and medium - sized halos at both redshifts , while it is significantly less than @xmath113 for the massive halos , especially at @xmath103 , which are all as expected because the chameleon effect is stronger in high density regions and at early times .",
    "@xmath106 is not perfectly equal to @xmath113 even at late times and in small halos , because there _ is _ a suppression of the fifth force and @xmath114 even in the linearised treatment above the compton wavelength . in the n6 and f6 simulations , we see that @xmath115 for all halos and at all times , showing a strong chameleon effect .",
    "interestingly , in the f simulations @xmath106 increases with the distance from the halo centre , while in n simulations the trend is just opposite ( this is clearest in the f6/n6 simulations at @xmath101 ) .",
    "the former is because the chameleon effect gets weaker as one moves from the halo centre ( highest density region ) and so @xmath106 tends to @xmath113 ; the latter is because the value of @xmath55 is only affected by particles lying within the compton wavelength from the considered position and as one moves from the halo centre more and more particles in the central region of the halo become unable to affect @xmath55 , while this does not happen to @xmath18 as gravity is a long - range force .    in summary , we find that the halo density profiles in the @xmath0 gravity model show complicate but interesting features , which could be understood qualitatively .",
    "we would like to study these in more details in future works , perhaps with the aid of even - higher - resolution simulations .",
    "modified gravity scenario , especially the @xmath0 gravity , attracts more and more attention as an alternative to dark energy to explain the origin of the cosmic acceleration at low redshifts .",
    "much efforts have been made to investigate the phenomenology of @xmath0 theories on linear scales @xcite .",
    "unfortunately , the current observational data on linear scales , including weak lensing , integrated sachs - wolfe ( isw ) and cosmic microwave background ( cmb ) , , can only weakly constrain @xmath0 gravity @xcite . and",
    "even futuristic observations on linear scales can hardly prove , or falsify the @xmath0 scenario @xcite .    on nonlinear scales , @xmath0 gravity can be much better tested by cosmological observations @xcite because the scale dependent enhancement of the growth rate makes deviations from gr larger and larger on smaller scales .",
    "however , we should take into account the mechanism to recover gr that is necessary to evade the strong constraints in the solar system . in @xmath0 gravity models ,",
    "this recovery of gr is accomplished by the chameleon mechanism . in order to realise the chameleon mechanism ,",
    "the scalar mode in @xmath0 gravity should satisfy a highly non - linear evolution equation . in this work",
    ", we implement the newton - gauss - seidel relaxation solver into the ` mlapm ` code , an adaptive particle mesh simulation code , and obtain high resolution simulation results ( up to @xmath1 h / mpc for the matter power spectrum ) .",
    "we independently confirmed the results , including the power spectrum and halo statistics , presented in refs . @xcite and @xcite , and extended the resolution by a factor of @xmath116 .",
    "deviations from gr in the power spectrum are highly suppressed at early times when the chameleon mechanism works very well .",
    "later the chameleon starts to fail once the background @xmath15 field becomes comparable to its fluctuations , @xmath55",
    ". then the power spectrum approaches the one in the case without the chameleon mechanism .",
    "this transition happens at a higher redshift for a larger @xmath44 simply because the background field is larger for larger @xmath44 .",
    "we found an interesting behavior that the power spectrum in full chameleon simulations has higher amplitude than the one in non - chameleon simulations during this transition .",
    "we observed a similar behavior in the density profile .",
    "the density profile in full simulations becomes higher than the one in non - chameleon simulations on small scales once the chameleon has started to fail .",
    "qualitatively , this is due to the fact that , once the chameleon mechanism fails , the fifth force becomes unsuppressed and the central potential of halos becomes as strong as in the non - chameleon simulations but the particles are moving still relatively slowly",
    ". then dark matter particles are temporarily trapped at the central region of halos .",
    "later particles velocities catch up and the density profile and the power spectrum approach those in non - chameleon simulations . in order to confirm this picture , we would need higher resolution simulations and study the behavior of dark matter particles in halos carefully .",
    "we can also make the connection between the halo density profile and the power spectrum using the halo model approach .",
    "we leave the study of these issues in a separate paper .",
    "we measured the profile of the scalaron field inside halos and studied the efficiency of the chameleon mechanism as expected , we found that the chameleon mechanism works better for heavier halos because the density is high in these halos .",
    "the halo mass function also shows the same tendency  the number of heavier halos approaches that in gr simulations if the chameleon mechanism works as in the @xmath105 case . for the @xmath104 case ,",
    "the chameleon no longer works at @xmath101 , which results in more and more heavier halos compared with gr .    in conclusion",
    ", we studied the effect of the chameleon mechanisms in details in our high resolution simulations .",
    "it was found that once the chameleon mechanism stated to fail , the power spectrum and halo properties showed very interesting behaviours before they approach those in non - chameleon simulations .",
    "for the power spectrum , we showed that this transition can be described by extending the post - parametrised - friedmann ( ppf ) formalism that interpolates between the power spectrum in non - chameleon models and gr models .",
    "this kind of fitting formulae will be useful when we confront our predictions to observations as it is far easier to run non - chameleon simulations with different cosmological parameters .",
    "our results indicate that @xmath111 is the critical case where the chameleon mechanism fails to work today .",
    "it becomes significantly harder to detect deviations from gr once @xmath44 becomes smaller than @xmath117 . in this case , we need to look into the places where the chameleon still fails to work , _",
    "i.e. _ smaller halos .",
    "we leave a study of observational constraints on @xmath0 gravity using non - linear clustering such as weak lensing and cluster and voids abundance in a forthcoming paper .",
    "we thank fabian schmidt for enlightening discussions .",
    "gbz thanks damtp of university of cambridge for hospitality . gbz and kk",
    "are supported by stfc grant st / h002774/1 .",
    "kk also acknowledges support from the european research council , the leverhulme trust and rcuk .",
    "bl is supported by queens college at university of cambridge and stfc .",
    "the last thing we are going to do before implementing the @xmath0 equations into the @xmath32-body code is to discretise them , such that they fit to the philosophy of the numerical computations  solving the equations on meshes with finite grid sizes .",
    "this appendix displays the discretised equations , and again we discuss the chameleon and non - chameleon cases separately .",
    "we shall only write down the discrete equations for @xmath85 or @xmath36 , as those for @xmath118 as simple .      the full equation for @xmath85 , eq .",
    "( [ eq : sf_codeunit_cham ] ) , contains the quantity @xmath119 . to discretise it ,",
    "let us define @xmath120 , and assumed that the discretisation is performed on a grid with grid spacing @xmath121 .",
    "we shall require second order precision which is the same as the default poisson solver in mlapm , and then @xmath122 in one dimension can be written as u  ^h u_j  =  , where a subscript @xmath123 means that the quantity is evaluated on the @xmath123-th point .",
    "the generalisation to three dimensional case is straightforward .",
    "the factor @xmath124 in @xmath125 makes this a standard variable coefficient problem .",
    "we need also discretise @xmath124 , and do it in this way ( again for one dimension ) @xcite : @xmath126 , \\ \\",
    "\\\\end{aligned}\\ ] ] in which @xmath127 .",
    "generalising this to three dimensions , we have    @xmath128\\nonumber\\\\ & & + \\frac{1}{h^2}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k } - u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right ) + b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^2}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1 } - u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right ) + b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right].\\end{aligned}\\ ] ]      @xmath130\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\frac{ac^2}{(bh_0)^2}\\left[b_{i , j+\\frac{1}{2},k}u_{i , j+1,k } - u_{i , j , k}\\left(b_{i , j+\\frac{1}{2},k}+b_{i , j-\\frac{1}{2},k}\\right ) + b_{i , j-\\frac{1}{2},k}u_{i , j-1,k}\\right]\\nonumber\\\\ & & + \\frac{1}{h^{2}}\\frac{ac^2}{(bh_0)^2}\\left[b_{i , j , k+\\frac{1}{2}}u_{i , j , k+1 } - u_{i , j , k}\\left(b_{i , j , k+\\frac{1}{2}}+b_{i , j , k-\\frac{1}{2}}\\right ) + b_{i , j , k-\\frac{1}{2}}u_{i , j , k-1}\\right]\\nonumber\\\\ & & -\\omega_{m}\\rho_{c , i , j , k}-4a^3\\omega_{\\lambda}+\\frac{1}{3}\\omega_{m}a^3",
    "\\big(n\\frac{c_1}{c_2 ^ 2}\\big)^{\\frac{1}{n+1}}e^{-\\frac{u_{i , j , k}}{n+1}}.\\end{aligned}\\ ] ]    then the newton - gauss - seidel iteration says that we can obtain a new ( and usually more accurate ) solution of @xmath85 , @xmath131 , using our knowledge about the old ( and less acurate ) solution @xmath132 as @xmath133 the old solution will be replaced with the new one once the latter is ready , using a red - black gauss - seidel sweeping scheme .",
    "note that    @xmath134\\nonumber\\\\ & & -\\frac{1}{2h^{2}}\\frac{ac^2}{(bh_0)^2}\\left[b_{i+1,j , k}+b_{i-1,j , k}+b_{i , j+1,k } + b_{i , j-1,k}+b_{i , j , k+1}+b_{i , j , k-1}+6b_{i , j , k}\\right]\\nonumber\\\\ & & -\\frac{1}{3(n+1)}\\omega_{m}a^3\\big(n\\frac{c_1}{c_2 ^ 2}\\big)^{\\frac{1}{n+1}}e^{-\\frac{u_{i , j , k}}{n+1}}.\\end{aligned}\\ ] ]    in principle , if we start from some high redshift , then the initial guess of @xmath135 could be chosen as the background value because we expect that any perturbations should be small then .",
    "for subsequent time steps we can use either the solution at the last time step or some analytical approximated solution as the initial guess ( for chameleon simulations we find the latter more convenient while for non - chameleon simulations it is just the opposite ) .",
    "@xmath137 \\nonumber\\\\ & & + \\omega_{m}(\\rho_{c , i , j , k}-1)-\\frac{1}{3n(n+1)}\\frac{c_2 ^ 2}{c_1 } \\omega_{m}a^3\\left[3\\left(\\frac{1}{a^3}+4\\frac{\\omega_\\lambda}{\\omega_{m}}\\right)\\right]^{n+2}v_{i , j , k},\\end{aligned}\\ ] ]          s.  nojiri and s.  d. odintsov , econf * c0602061 * , 06 ( 2006 ) , hep - th/0601213 .",
    "k.  koyama , gen .",
    ". grav . * 40 * , 421 ( 2008 ) , 0706.1557 .",
    "r.  durrer and r.  maartens , ( 2008 ) , 0811.4132 .",
    "r.  durrer and r.  maartens , gen .",
    "* 40 * , 301 ( 2008 ) , 0711.0077 . b.  jain , j.  khoury , annals phys .   * 325 * , 1479 - 1516 ( 2010 ) .",
    "[ arxiv:1004.3294 [ astro-ph.co ] ] .",
    "t.  p. sotiriou and v.  faraoni , ( 2008 ) , 0805.1726 .",
    "a.  de felice and s.  tsujikawa , living rev .",
    "* 13 * , 3 ( 2010 ) [ arxiv:1002.4928 [ gr - qc ] ] .",
    "w.  hu and i.  sawicki , phys . rev . *",
    "d76 * , 064004 ( 2007 ) , 0705.1158 .",
    "a.  a. starobinsky , jetp lett . * 86 * , 157 ( 2007 ) , 0706.2041 .",
    "s.  a. appleby and r.  a. battye , phys .",
    "b654 * , 7 ( 2007 ) , 0705.3199 . g.  cognola , e.  elizalde , s.  nojiri , s.  d.  odintsov , l.  sebastiani and s.  zerbini , phys .  rev .",
    "d * 77 * , 046009 ( 2008 ) [ arxiv:0712.4017 [ hep - th ] ] .",
    "h.  oyaizu , phys . rev .",
    "* d78 * , 123523 ( 2008 ) , 0807.2449 . h.  oyaizu , m.  lima , and w.  hu , phys . rev . * d78 * , 123524 ( 2008 ) , 0807.2462 . f.  schmidt , m.  v. lima , h.  oyaizu , and w.  hu , ( 2008 ) , 0812.0545 .",
    "r.  e.  smith _ et al .",
    "_ [ the virgo consortium collaboration ] , mon .  not .",
    "* 341 * ( 2003 ) 1311 [ arxiv : astro - ph/0207664 ] .",
    "k.  koyama , a.  taruya and t.  hiramatsu , phys .  rev .",
    "d * 79 * ( 2009 ) 123512 [ arxiv:0902.0618 [ astro-ph.co ] ] .",
    "e.  beynon , d.  j.  bacon and k.  koyama , mon .  not .",
    "soc .   * 403 * , 353 ( 2010 ) [ arxiv:0910.1480 [ astro-ph.co ] ] .",
    "b.  li , d.  f.  mota and j.  d.  barrow , arxiv:1009.1400 [ astro-ph.co ] .",
    "d.  f.  mota and d.  j.  shaw , phys .",
    "d * 75 * , 063501 ( 2006 ) .",
    "b.  li and j.  d.  barrow , phys .",
    "d * 75 * , 084010 ( 2007 ) [ arxiv : gr - qc/0701111 ] . y.  -s .",
    "song , w.  hu and i.  sawicki , phys .",
    "d * 75 * , 044004 ( 2007 ) [ arxiv : astro - ph/0610532 ] .",
    "b.  li and h.  zhao , phys .  rev .",
    "d * 80 * , 044027 ( 2009 ) [ arxiv:0906.3880 [ astro-ph.co ] ] . b.  li and h.  zhao , phys .",
    "d * 81 * , 104047 ( 2009 ) arxiv:1001.3152 [ astro-ph.co ] . b.  li and j.  d.  barrow , arxiv:1005.4231 [ astro-ph.co ] .                l.  pogosian and a.  silvestri , phys .",
    "d * 77 * ( 2008 ) 023503 [ erratum - ibid .",
    "d * 81 * ( 2010 ) 049901 ] [ arxiv:0709.0296 [ astro - ph ] ] .",
    "g.  b.  zhao , l.  pogosian , a.  silvestri and j.  zylberberg , phys .",
    "d * 79 * ( 2009 ) 083513 [ arxiv:0809.3791 [ astro - ph ] ] .",
    "y.  s.  song , h.  peiris and w.  hu , phys .",
    "d * 76 * ( 2007 ) 063517 [ arxiv:0706.2399 [ astro - ph ] ] .",
    "t.  giannantonio , m.  martinelli , a.  silvestri and a.  melchiorri , jcap * 1004 * ( 2010 ) 030 [ arxiv:0909.2045 [ astro-ph.co ] ] .",
    "l.  lombriser , a.  slosar , u.  seljak and w.  hu , arxiv:1003.3009 [ astro-ph.co ] . f.  schmidt , a.  vikhlinin and w.  hu , phys .  rev .",
    "d * 80 * ( 2009 ) 083505 [ arxiv:0908.2457 [ astro-ph.co ] ] ."
  ],
  "abstract_text": [
    "<S> we perform high resolution n - body simulations for @xmath0 gravity based on a self - adaptive particle - mesh code mlapm . </S>",
    "<S> the chameleon mechanism that recovers general relativity on small scales is fully taken into account by self - consistently solving the non - linear equation for the scalar field . </S>",
    "<S> we independently confirm the previous simulation results , including the matter power spectrum , halo mass function and density profiles , obtained by oyaizu  ( phys.rev.d * 78 * , 123524 , 2008 ) and schmidt  ( phys.rev.d * 79 * , 083518 , 2009 ) , and extend the resolution up to @xmath1 h / mpc for the measurement of the matter power spectrum . based on our simulation results , </S>",
    "<S> we discuss how the chameleon mechanism affects the clustering of dark matter and halos on full non - linear scales . </S>"
  ]
}