{
  "article_text": [
    "here we will go through some details of the matrix product state method , including the single photon state preparation and mps update of this state .",
    "we will also present results of fidelity simulations not included in the main text .",
    "the system - bath hamiltonian @xmath136 , where @xmath137 the operators @xmath138 , @xmath139 and @xmath140 are annihilation operators for photons in the cavity , phonons of mechanical system , and photons in the waveguide with mode index @xmath141 . note that in writing this hamiltonian , we are already in the rotating frame of the optical cavity frequency @xmath142 .",
    "we can further go into the rotating frame with respect to the bath hamiltonian @xmath143 and the interaction term becomes @xmath144 where we have defined @xmath145    to calculate the evolution of the whole system , it is convenient to discretize time in small steps of @xmath45 . define the quantum noise increments in the time domain for the input field as : @xmath146 where @xmath147 and @xmath47 is an integer .",
    "it is straightforward to verify that @xmath49 = \\delta_{nm } $ ] from the commutation relation @xmath148 = \\delta ( \\omega - \\omega^\\prime ) $ ] of the field mode , which means all the time - bins can be interpreted as independent harmonic oscillators .",
    "thus the hilbert space for the whole system is a tensor product space , including contributions from optomechanical system and quantum field in the waveguide , which can be modeled as a series of harmonic oscillators .",
    "generally speaking , two things are required for the mps simulation : preparing the many - body state @xmath150 in mps form and updating this state step by step to evolve @xmath150 . in this and the next section",
    ", we consider these two operations .    as usual , at @xmath151 the state of the optomechanical system and the quantum field in the waveguide",
    "are assumed to be completely uncorrelated and separable .",
    "the state of the waveguide is composed of two temporal modes that are spaced apart from each other .",
    "a large separation in time means that the state of the quantum field is very nearly the product state of two single photon states in two independent temporal modes .",
    "a single photon in a temporal mode has a wavefunction given by @xmath152 .",
    "this can be rewritten in the time - bin representation as _",
    "n f_n _ = _ .",
    "more generally , the joint state of the waveguide with two temporal modes each in their 0 or 1 state can be described by the linear combination of state vectors @xmath55 for @xmath56 or 1 .    to put this state in an mps form , a sequence of singular value decompositions ( svd ) are required .",
    "note that for separated temporal modes each being in the 0 or 1 photon states , the dimension of hilbert space for any of the time - bins can be chosen to be 2 .",
    "in addition , we are operating in the polynomial @xmath153 subspace of the @xmath154 dimensional hilbert space of the waveguide  only states @xmath155 are used since we ignore the possibility of two photons localizing at the same time - bin .",
    "considering @xmath156 to be the dimension of the truncated hilbert space for the optomechanical system , the state of the full system would require @xmath157 parameters .",
    "the mps representation takes advantage of this reduction in problem size in an implicit way .",
    "in addition , we note that though we are limited to this subspace due to the photon number conserving symmetry of the hamiltonian and our selection of the initial state , our implementation of the mps method is capable of simulating the dynamics for a more complex input state in an efficient and automatic way , since the hilbert space is never explicitly reduced .      1 .   for the first step , calculate the density matrix for the first time - bin as well as its eigenvalues and eigenvectors . use the eigenvalues to get the schmidt vector @xmath158 } $ ] and",
    "expand the eigenvectors @xmath159}\\rangle$ } } $ ] in the local basis \\{@xmath160 } to get @xmath161 } $ ] , _ i.e. _ , @xmath162}\\rangle$ } } = \\gamma^{[1]i_1}_{\\alpha_1 } $ ] .",
    "2 .   for the @xmath163th ( @xmath164 ) step , calculate the density matrix for the composite system of @xmath165 time - bins as well as its eigenvalues and eigenvectors . use the eigenvalues to get the schmidt vector @xmath166 } $ ] .",
    "take the inner product @xmath167}|$ } } \\langle i_k{\\mbox{$|\\psi_{\\alpha_k}^{[k]}\\rangle$ } } $ ] to give the element @xmath168i_k}_{\\alpha_{k-1}\\alpha_{k } } $ ] of @xmath168 } $ ] , where @xmath169 is the local basis \\{@xmath160 } of the @xmath163th time - bin .      to evolve the many body state , a sequence of unitary operators @xmath170",
    "are applied to update the mps . here",
    "@xmath171 as already mentioned in the main text , the mps used for simulation of our protocol keeps track of a waveguide of finite length equivalent to a delay time of @xmath61 and also the optomechanical system .      1 .",
    "for @xmath47 from 1 to @xmath172 , apply @xmath173 to the optomechanical system and the @xmath47th time - bin . then use a swap gate to permute the order of them , so that @xmath174 can be applied in the same local way as @xmath60 . by the end of this step ,",
    "the optomechanical system is at the last site of the mps .",
    "2 .   for @xmath47 from @xmath172 to 1 , perform swap gate to the optomechanical system and the @xmath47th time - bin .",
    "note that in this step the many - body state is not evolved in time since it stays the same under swap gates .",
    "repeat steps 1 and 2 to complete one repetition of the protocol",
    ". the full evolution may be over multiple repetitions , @xmath63 .",
    "the canonical mps form provides a convenient way to extract many properties of the system , like average values during evolution , correlation functions of the quantum field and so on .",
    "in addition to the phase and fidelity that can be directly calculated from the wavefunction , we are particularly interested in the entanglement entropy of various bipartitions of the whole system .",
    "these can be directly calculated from the @xmath166 } $ ] , the schmidt vector at time @xmath175 , in the mps representation .",
    "we calculate @xmath1762}_\\alpha \\log_2 \\lambda^{[k]2}_\\alpha , \\ ] ] which gives us the entanglement between part of the system , containing time - bins @xmath177 , and another part , with time - bins @xmath178 .",
    "to simulate the effect of many reflections by the mirror , we use a series of swap gates to move the optomechanical system back every time it reaches the last site of the mps .",
    "this scheme seems reasonable , and we justify it here in a more rigorous way .",
    "the system as modelled is simply a closed system without losses . here",
    "we wish to show formally the equivalence between our simulation scheme and the dynamics of the closed system .    consider a long waveguide of length @xmath179 with linear dispersion , then @xmath180 where @xmath181 is the frequency of the fundamental mode and @xmath182 is the speed of light .",
    "the summation starts from @xmath183 since we are in a rotating frame of cavity frequency . in this model",
    "the delay time of the coherent feedback is @xmath184 .    after going into the rotating frame of @xmath185 ,",
    "the interaction term is @xmath186 where we have defined @xmath187 .",
    "it is important to note that @xmath188 which is a direct result of the coherent feedback .",
    "next let us discretize time in small steps of @xmath189 , where @xmath172 is a large integer and also the number of time - bins .",
    "we define in the time domain @xmath190 , where @xmath191 is an integer and @xmath192 .",
    "since @xmath193 for any @xmath191 , all the independent operators are @xmath194 .",
    "as before , it is straightforward to show that @xmath195 = \\delta_{ij } , \\forall 1\\leqslant i , j \\leqslant n $ ] . therefore we have @xmath172 independent harmonic oscillators as time - bins .    to describe the evolution of this state , we start again with the single - step evolution @xmath171 here @xmath196 is the operator defined in the time domain and @xmath197 .",
    "this cyclic property of these unitary matrices evolving the state means that the total evolution operator @xmath198 over many steps can be written as @xmath199 for @xmath200 where @xmath201 are two integers and @xmath202 .",
    "when @xmath203 goes from 1 to @xmath172 , the optomechanical system moves through the mps and interacts with the photons .",
    "when @xmath203 becomes 1 again , a series of swap gates are required to move the optomechanical system back to the first site of the mps , so that @xmath204 can be applied on the mps in a local way .",
    "this is exactly the simulation scheme we have implemented as described above .",
    "the cutoff of the singular values in the singular value decomposition calculation is set to be @xmath205 . since the coupling between the cavity and the waveguide is the fastest process in the rotating frame ,",
    "we choose @xmath206 .",
    "the temporal width of the photon is chosen to be @xmath207 , _",
    "i.e. _ , most of the photon is spread across @xmath208 time - bins to ensure that it can fully enter the cavity .",
    "we choose the cutoff of the fock space to be @xmath209 for the optical cavity , @xmath210 for the mechanical oscillator and @xmath209 for each time bin .",
    "the total waveguide is composed of @xmath211 time - bins , which is @xmath212 for @xmath108 .",
    "the quantum optomechanical nonlinearity can cause the state of the quantum field in the waveguide to move outside of the subspace defined by the four state vectors @xmath98 , where there are @xmath213 photons in the temporal modes @xmath214 and @xmath26 of the waveguide .",
    "there are three effects that cause this .",
    "one is the change in the temporal mode after each bounce from the cavity .",
    "the other is leakage due to the nonlinearity .",
    "finally there is the effect of residual entanglement with the mechanical system after a repetition of the protocol .",
    "we are interested in the latter two since the first can be in principle reversed with linear optical components .",
    "we calculate the change in the overlaps @xmath215 starting from the initial state @xmath85 as defined in the main text , and with @xmath98 evolved separately with @xmath93 .",
    "the results are plotted in figure  [ fig : si_fig ] .",
    "nominally , @xmath216 in the perfect case for every @xmath214 and @xmath26 , and so the infidelity is @xmath217 ."
  ],
  "abstract_text": [
    "<S> we show that the effective optical nonlinearity of a cavity optomechanical system can be used to implement quantum gates between propagating photons . by using quantum feedback </S>",
    "<S> , we can enhance a slow and small optical nonlinearity to generate a large nonlinear phase shift between two spatially separated temporal modes of a propagating electromagnetic field . </S>",
    "<S> this allows us to implement a gate between the two modes . after presenting a semiclassical derivation of the operation of the gate </S>",
    "<S> , we verify the result by a full simulation of the state of the quantum field in the waveguide coupled to a cavity . to efficiently solve the schrdinger equation of the full system , </S>",
    "<S> we develop a matrix product state approach that keeps track of the entangled full quantum state of the coupled system . </S>",
    "<S> these simulations verify the operation of the gate in the weak coupling regime where the semiclassical approximation is valid . </S>",
    "<S> in addition , we observe a major reduction in gate fidelity as we approach the vacuum strong coupling regime of optomechanics where quantum fluctuations that are not accounted for in the semiclassical picture start to play a major role . </S>",
    "<S> we consider possible experimental implementations of the gate with current technology .    </S>",
    "<S> the interaction between light and motion in cavity - optomechanical systems has enabled sensitive measurements of force and displacement , as well as quantum - optical control over the state of mechanical resonators  @xcite . </S>",
    "<S> conversely , an optically - coupled mechanical degree of freedom can lead to interactions between photons mediated by motion . </S>",
    "<S> nonlinear optical effects such as wavelength conversion  @xcite , generation of squeezed light  @xcite , and electromagnetically induced transparency  @xcite are manifestations of this optical nonlinearity and have been demonstrated in recent experiments . </S>",
    "<S> nonetheless , a central goal of quantum optics and information is to generate nonlinearities that are large at the single - photon level  @xcite . </S>",
    "<S> it has been shown theoretically that it is possible to generate single - photon effective optical nonlinearities with optomechanics , but only with system parameters well outside of our current experimental reach  @xcite . </S>",
    "<S> the essential difficulty is that for a mechanically - induced optical nonlinearity to act on the incident light , the response of the mechanical system must be fast compared to the amount of time the photon spends inside the optical cavity . </S>",
    "<S> moreover , the mechanical system should display a large response to the force induced by a single photon  so that the cavity properties change significantly due to the presence of the photon  requiring a highly compliant mechanical system . </S>",
    "<S> these two contradicting needs , fast response and large compliance , are fundamentally at odds with each other and make strong effective photon - photon interactions extremely difficult to achieve in realistic cavity optomechanical systems .    </S>",
    "<S> in addition to the difficulty of generating the large kerr nonlinearities needed , it has been pointed out that in principle , subtle effects due to the multimode nature of a propagating light field make implementation of high - fidelity gates operating on flying photons using large instantaneous kerr nonlinearities impossible  @xcite . here </S>",
    "<S> we show that by introducing a _ coherent delay _ to a cavity - optomechanical system with a small and slow effective kerr nonlinearity , large photon - photon interactions between two spatially separated photons propagating in an optical fiber can be achieved . </S>",
    "<S> moreover , we demonstrate using both a semiclassical argument and full quantum simulations taking into account the propagating quantum field with its many degrees of freedom , that a gate between two temporal modes of this field can be implemented with a cavity - optomechanical system that is in the bad - cavity regime . </S>",
    "<S> the coherent delay allows a slow optomechanical system to induce a large effective interaction between the separated photons , greatly relaxing the optomechanical system requirements needed to implement such a gate . </S>",
    "<S> the nonlocal nature of the gate also sidesteps a key assumption in the aforementioned impossibility arguments  @xcite .    </S>",
    "<S> we consider an optomechanical system coupled to a long waveguide with an end mirror , so that photons can propagate back and forth inside the waveguide , and interact repeatedly with the mechanical resonator by entering the optical cavity . </S>",
    "<S> these interactions and the slow internal dynamics of the mechanical system lead to an effective nonlinear interaction between the photons that is nonlocal and leads to a build - up of entanglement in the quantum fields inside the waveguide . </S>",
    "<S> remarkably , quantum photonic operations can be implemented in such a scheme . </S>",
    "<S> the protocol for the gate between two temporal modes of the light field is shown in figure  [ fig : protocol ] . </S>",
    "<S> the center frequencies of these two modes are chosen to be at the cavity frequency and each have a bandwidth much smaller than the cavity linewidth . </S>",
    "<S> they are also separated by a time @xmath0 , where @xmath1 is the period of the mechanical oscillation and @xmath2 is the temporal extent of the photon . </S>",
    "<S> our system is similar to and inspired by pulsed optomechanical experiments  @xcite with the distinction that no measurement occurs in our feedback network  </S>",
    "<S> the photons are fed back to the system coherently . </S>",
    "<S> the choice of delay time is essential for disentangling the mechanical system from the photons at the end of the protocol . </S>",
    "<S> the mechanical system must return to its initial state regardless of the state of the input temporal modes , since any residual entanglement between the temporal modes and the mechanical system will reduce the fidelity of the gate . </S>",
    "<S> as shown in figure  [ fig : protocol ] and is justified below , this is the case for the temporal mode spacing we have chosen .    . </S>",
    "<S> the modes can be in states @xmath3 and @xmath4 . </S>",
    "<S> ( 1 ) the first photon mode interacts and is entangled with the mechanical oscillator since @xmath5 and @xmath6 will lead to different changes in the mechanical momentum and cause a state - dependent change in the mechanical state . after the mechanical system evolves for @xmath7 , ( 2 ) </S>",
    "<S> the second photon mode interacts with the mechanical oscillator and the mechanical system s state become entangled with both photons . </S>",
    "<S> after the mechanical system evolves again for another @xmath8 , ( 3 ) the first photon temporal mode interacts again with the mechanical system causing its state to be disentangled from the mechanical oscillator . </S>",
    "<S> after another @xmath8 of evolution , ( 4 ) the second photon mode comes back again and the mechanical system is decoupled from both temporal modes since it goes back to its ground state regardless of the initial states of the photon modes . </S>",
    "<S> the blue lines signify the entanglement in the system and on the right the state - dependent evolution of mechanical state is shown in phase space.,scaledwidth=50.0% ]    _ semiclassical model . </S>",
    "<S> _ we consider a cavity - optomechanical system composed of an optical resonator at frequency @xmath9 with annihilation operator @xmath10 , coupled to a mechanical resonator with frequency @xmath11 and annhililation operator @xmath12 . </S>",
    "<S> the waveguide coupling the the optomechanical system is terminated at the opposite end with a reflector . </S>",
    "<S> the initial state of the waveguide consists of two temporal modes of the light field , each with extent @xmath13 . </S>",
    "<S> we assume that @xmath14 so that each photon fully interacts with the cavity , exerting a significant impulse onto the mechanical system and obtaining a large uniform phase shift related to the internal state of the mechanical system , before propagating away in the waveguide . </S>",
    "<S> each impulse is assumed to be nearly instantaneous on time scales relevant to the mechanical oscillator s motion , _ </S>",
    "<S> i.e. _ , @xmath15 . taken together , these conditions imply that we are operating in the bad cavity regime @xmath16 . </S>",
    "<S> we can use a simplified semiclassical model to understand some of the behavior of this system .    </S>",
    "<S> the optomechanical system s hamiltonian is given by @xmath17 the radiation pressure force on the optomechanical system ( @xmath18 ) integrated over the interaction time of the photon with the cavity ( @xmath19 ) causes a rapid change in the momentum of the mechanical system by @xmath20 . </S>",
    "<S> if we assume that the cavity can be eliminated adiabatically ( @xmath21 is large ) , the field in the cavity and waveguide may be related as @xmath22 , so after the interaction with the propagating photon , an impulse of @xmath23 is imparted onto the mechanical system . </S>",
    "<S> we define a photon number operator @xmath24 , which counts the number of excitations in a window of size @xmath13 around the @xmath25 temporal mode ( @xmath13 and @xmath26 only set the limits of integration over the field operators ) . </S>",
    "<S> the interaction between the @xmath25 temporal mode and the mechanical system is given by the unitary operator & = & ( -i/ ) + & = & ( -4i g_0 /x _ ) , with position @xmath27 . </S>",
    "<S> the mechanical free evolution operator is @xmath28 . </S>",
    "<S> our protocol can then be compactly stated as @xmath29 , with = . </S>",
    "<S> this sequence of interactions is shown schematically in figure  [ fig : protocol ] . </S>",
    "<S> we can now calculate the result of these operations on the joint state of the optomechanical systems and photonic waveguide , given that the waveguide s photonic states are initialized as @xmath30 , @xmath31 , @xmath32 , and @xmath33 , and the mechanical mode is in its ground state . </S>",
    "<S> for the first three of these states , @xmath34 , while for the last one , @xmath35 . </S>",
    "<S> this demonstrates that the internal dynamics of the optomechanical system executes a controlled - phase gate on to the joint state of the two photons .    </S>",
    "<S> following this calculation through , we find the phase shift imparted on the @xmath33 state after one run of the protocol is given by _ 1 = 32 ( g_0/)^2 . according to this simplified model , obtaining a total phase shift of @xmath36 </S>",
    "<S> can be accomplished either by going to a large enough coupling @xmath37 , or by running the protocol multiple times , @xmath38 , for a smaller @xmath37 so that a total phase shift builds up over several bounces . to distinguish between these two approaches , it is important to realize that in any real system , in addition to the coupling between the cavity and the waveguide , there are other fixed intrinsic optical loss channels characterized by a loss rate @xmath39 leading to a probability @xmath40 that a photon is lost on each bounce . according to the semiclassical model , </S>",
    "<S> since the chance of photon loss in multiple runs is proportional to @xmath41 , and @xmath42 , it is always advantageous to make @xmath21 as small as possible . </S>",
    "<S> this conclusion however neglects another source of decoherence which arises due to quantum fluctuations .    </S>",
    "<S> as we will see below , the semiclassical model fails to capture some of the essential physics of the problem . at the most basic level </S>",
    "<S> , the model assumes that the cavity field follows adiabatically the input field from the waveguide , since they are resonant and the photon has a spectrum that is much narrower than that of the cavity . </S>",
    "<S> however , at large @xmath37 , the quantum motion of the mechanical system imposes a jitter on the optical cavity frequency that is comparable to the optical cavity linewidth  @xcite . </S>",
    "<S> this extra noise prevents the protocol from operating as intended . </S>",
    "<S> in fact , the final state of the system will exhibit significant entanglement between the photons and mechanical resonator preventing the protocol from functioning as a photon - photon gate . as described below , smaller @xmath37 </S>",
    "<S> are required , leading to a trade - off between the quantum - fluctuation - induced loss in fidelity , and the effect of intrinsic optical losses . </S>",
    "<S> for a quantitative understanding of this trade - off we consider a full quantum model of the system .    _ </S>",
    "<S> quantum dynamics . </S>",
    "<S> _ most theoretical methods of quantum optics are best suited for modeling coupling between a system and a reservoir that is markovian in nature . </S>",
    "<S> the protocol we are considering utilizes a waveguide that reflects the light back onto the system realizing a quantum feedback network and dynamics that are highly non - markovian . </S>",
    "<S> many methods for understanding feedback networks have been developed in recent years  @xcite , applied to optomechanical systems  @xcite , and experimentally realized  @xcite . </S>",
    "<S> the feedback network we are considering requires a long delay due to the slow dynamics of the mechanical oscillator , and recently methods for understanding dynamics of systems in such quantum feedback networks have been proposed  @xcite . in addition , we are interested in understanding the evolution of the state of the photons in the waveguide over many bounces , so tracing out the bath would be akin to throwing the photons out with the bath degrees of freedom . </S>",
    "<S> one approach  @xcite to solving the full dynamics of the waveguide and system together is to discretize the waveguide into time steps @xmath43 that are much smaller than any of the relevant dynamics of the system and evolve what is now effectively the interaction between a 1d chain of harmonic oscillators and an optomechanical system . in principle , keeping track of the state of such a 1d chain is daunting due to the exponentially large hilbert space  , where @xmath44 is the truncated dimension of each bin s fock space . ] </S>",
    "<S> required for its full representation . </S>",
    "<S> luckily , the states of the waveguide we are considering have far less entanglement than general states in the full hilbert space , so efficient methods for storing and evolving the states can be utilized  @xcite . </S>",
    "<S> our full quantum simulation is based on the matrix product state ( mps ) representation of the quantum field . </S>",
    "<S> mps as well as the related time - dependent density matrix renormalization group ( tdmrg ) techniques have already been well - established in condensed matter physics for simulating 1d quantum many - body systems . </S>",
    "<S> the success of these methods comes from their efficient description of quantum system with moderate amounts of entanglement  @xcite . </S>",
    "<S> it was realized that matrix product states are also closely related to entangled fields at the output of photonic systems  @xcite . </S>",
    "<S> more recently , pichler and zoller  @xcite implemented an mps - based simulation of photonic delayed quantum feedback networks .    here </S>",
    "<S> we will use a method similar to that presented in ref .  </S>",
    "<S> @xcite and outlined in the appendix . to implement mps method for the continuous quantum field of the waveguide , we discretize time in small steps @xmath45 and define operator @xmath46 for the @xmath47th time - bin , where @xmath48 and @xmath47 is an integer . </S>",
    "<S> it is straightforward to verify that @xmath49 = \\delta_{nm } $ ] which means the time - bins can be interpreted as independent harmonic oscillators . </S>",
    "<S> the state of this quantum many body system can be represented in the canonical mps form  @xcite . </S>",
    "<S> a spatially distributed single photon state of the waveguide is then @xmath50 , where @xmath51 . </S>",
    "<S> we consider an initial state where the optomechanical system s optical and mechanical modes are both in their ground states , and consider two temporal modes of the photon with annihilation operators @xmath52 and @xmath53 separated by a time interval @xmath54 . </S>",
    "<S> we identify the states @xmath55 for @xmath56 or 1   are to an extremely good approximation orthogonal given a temporal separation that is much larger than their width . </S>",
    "<S> ] , and assume an initial state of the whole system _ & = & ( 1 + ) ( 1 + ) _ _ _ /2,[eqn : initstate ] + & = & ( + + + ) . </S>",
    "<S> initially , the optomechanical system is at the first site of the mps . to evolve the many - body state , we sequentially update the mps by applying the unitary @xmath57 as a local gate on the @xmath58 time - bin and the optomechanical system . </S>",
    "<S> then a swap gate is used to permute the order of them so that @xmath59 can be applied in the same way as @xmath60 . </S>",
    "<S> this process effectively simulates a discrete representation of the quantum stochastic schrdinger equation ( qsse )  @xcite and is continued until the optomechanical system reaches the last site of the mps . </S>",
    "<S> in contrast to ref .  </S>",
    "<S> @xcite where the number of sites in the mps is proportional to the total simulation time , here our waveguide and therefore our mps representation are of finite length due to the feedback . </S>",
    "<S> after every @xmath61 time interval , the system has interacted with the whole waveguide and reaches the last site of the mps . </S>",
    "<S> we simulate the reflection due to the far mirror by moving the optomechanical system through the mps back to the first site via a series of swap gates . at this point </S>",
    "<S> , the evolution can be continued as before to simulate interaction after one bounce . </S>",
    "<S> this process is repeated @xmath62 times for @xmath63 runs of the protocol . </S>",
    "<S> a more detailed description and justification can be found in the appendix .     of the fully coupled waveguide - optomechanical system for @xmath64 . </S>",
    "<S> ( b ) evolution of the entangelment entropy @xmath65 between the two localized photons over many repetitions of the protocol . </S>",
    "<S> the first four points are the same as those in ( a ) . </S>",
    "<S> ( c ) simulated phase shift @xmath66 after @xmath67 . </S>",
    "<S> the dashed line is comparison with the semiclassical @xmath68 . </S>",
    "<S> the mps simulations in ( a ) and ( b ) were done for @xmath69 , @xmath70 , while in ( c ) @xmath37 was varied . </S>",
    "<S> ( d ) the simulated phase shift over multiple repetitions of the protocol for @xmath69 is plotted . </S>",
    "<S> the circles use @xmath65 to infer @xmath71 , while the black trace is calculated directly by taking the argument of @xmath72 . </S>",
    "<S> there is good agreement between the two and the phase increases linearly as @xmath73 . </S>",
    "<S> , scaledwidth=45.0% ]    in the mps representation we decompose the state vector of the @xmath74-site system , @xmath75 , into a product of tensors @xmath76i_n}_{\\alpha_{k-1}\\alpha_{k}}$ ] and vectors @xmath77}_{\\alpha_k}$ ] for @xmath78 , such that a bipartition of the state at bond @xmath79 can be written as a schmidt decomposition @xmath80}_{\\alpha_l } { \\mbox{$|\\phi^{[1\\ldots l]}_{\\alpha_l}\\rangle$}}{\\mbox{$|\\phi^{[(l+1)\\ldots n]}_{\\alpha_l}\\rangle$}}$ ] . </S>",
    "<S> this allows us to calculate the entanglement entropy between the two halves of the system by simply reading off the values of the @xmath81 vector at bond @xmath79 , and calculating @xmath822}_{\\alpha_l } \\log_2 \\lambda^{[l]2}_{\\alpha_l}$ ] . the black line in figure  [ fig : result1](a ) </S>",
    "<S> is a plot of the @xmath83 as a function of time @xmath84 for the initial state @xmath85 . </S>",
    "<S> the two peaks at the positions of the two photons correspond to the finite width photon excitations in the waveguide , since one excitation is spread across multiple local sites and detecting the photon at a particular bin tells us that there are no photons in the nearby bins . </S>",
    "<S> stated more concisely , @xmath86 can not be written as a product state of time - bin localized photon excitations . </S>",
    "<S> in addition to the localized peaks , two other interesting regions are that between the photons , and the region between the photons and the optomechanical system . </S>",
    "<S> we call the amount of entanglement entropy between the photons and mechanical resonator @xmath87 and call the entanglement entropy between the two photons @xmath65 . </S>",
    "<S> as expected , both @xmath87 and @xmath65 are zero since the initial state can be written as a product state of separated temporal modes of the optical field in the waveguide and the optomechanical system , c.f . </S>",
    "<S> equation  ( [ eqn : initstate ] ) .    </S>",
    "<S> the entanglement entropy throughout the waveguide is plotted after a few subsequent runs of the protocol and shown in dashed lines in figure  [ fig : result1](a ) . for the system parameters in figure  [ fig : result1](a ) , @xmath65 increases on each run of the protocol while @xmath87 remains close to zero . </S>",
    "<S> the evolution of @xmath65 for more runs of the protocol is plotted in fig .  [ </S>",
    "<S> fig : result1](b ) and shows clear oscillatory behavior . </S>",
    "<S> this can be attributed to the evolving phase shift of the @xmath88 state with respect to the other states , since for a state @xmath89 the entanglement entropy is @xmath90/2 $ ] , where @xmath91 . to verify that this is in fact the correct interpretation </S>",
    "<S> , we calculate the phase shift directly from the wavefunctions by taking the overlap between a vector @xmath92 evolved on a system with @xmath93 , and the result of our simulation with larger @xmath94  . </S>",
    "<S> we compare this phase to the semiclassically predicted results @xmath95 , and find good agreement at smaller @xmath37 as shown in figure  [ fig : result1](c ) . </S>",
    "<S> the agreement becomes progressively worse at higher coupling . </S>",
    "<S> the total phase shift @xmath96 increases linearly as @xmath97 in fig .  [ fig : result1](d ) , which explains the oscillatory behavior of entanglement entropy .    </S>",
    "<S> in addition to calculating the phase , we must verify that the state of the electromagnetic field after interaction with the optomechanical system remains within the subspace of states @xmath98 , modulo the linear optical response of cavity . </S>",
    "<S> we calculate the fidelity @xmath99 after one and two bounces of the photons from the cavity . </S>",
    "<S> nominally , after two bounces , _ </S>",
    "<S> i.e. _ , @xmath67 , we expect @xmath100 for the input state in equation ( [ eqn : initstate ] ) . in figure  </S>",
    "<S> [ fig : result2](a ) a plot of the infidelity @xmath101 against the interaction rate is shown for one and two bounces of the waveguide photons from the cavity . </S>",
    "<S> after one bounce , the significant entanglement between the mechanical system and waveguide photons leads to higher infidelity . </S>",
    "<S> after two bounces , _ </S>",
    "<S> i.e. _ , a full run of the protocol , the entanglement between the mechanics and waveguide photons is largely erased , causing an increase in the overlap @xmath102 . </S>",
    "<S> larger interactions cause a breakdown of this picture and lead to residual entanglement with the mechanical system and lower fidelity . for @xmath103 , we simulate a fidelity of @xmath104 after two bounces , and @xmath105 after the @xmath106 required to implement the gate with @xmath63 is shown in the supplementary materials . ] . </S>",
    "<S> in other words the photon wavefunction is not significantly distorted in the interaction , as would be expected for large instantaneous kerr nonlinearities  @xcite . </S>",
    "<S> this is clear evidence that a gate between the two spatially separated photons can been implemented with this protocol .     as a function of coupling strength @xmath37 . </S>",
    "<S> the infidelity is very low after two bounces and increases with coupling strength . after only one bounce , </S>",
    "<S> the infidelity is much larger , since the mechanical system is no longer in its ground state . </S>",
    "<S> ( b ) @xmath87 between photons and the mechanical system for different values of @xmath107 and @xmath63 . here </S>",
    "<S> @xmath108 . </S>",
    "<S> a transition to the quantum regime is visible at @xmath109 , leading to large entanglement between the mechanical system and the waveguide photon.,scaledwidth=45.0% ]    another signature of the failure of the gate is the presence of residual entanglement between the photons and the mechanical system after running the protocol , _ </S>",
    "<S> i.e. _ , a non - zero value for @xmath87 . in fig .  </S>",
    "<S> [ fig : result2](b ) , the evolution of @xmath87 is plotted against @xmath37 and @xmath63 of the protocol . </S>",
    "<S> an interesting _ threshold _ feature is visible at a critical value of @xmath110 . </S>",
    "<S> this establishes a clear breakdown of the semiclassical regime , and a boundary between two different regimes , with the semiclassical regime being more relevant for the gate . </S>",
    "<S> we note that this critical value of @xmath37 occurs close to the value where the displacement due to the momentum imparted by a single photon , @xmath111 becomes equal with the zero - point fluctuations in the mechanical motion @xmath112 .    </S>",
    "<S> _ dissipation and experimental prospects . </S>",
    "<S> _ we have shown that strong photon - photon interactions can be obtained with an optomechanical system that is outside the strong coupling regime ( @xmath113 ) . </S>",
    "<S> we estimate the effect of five sources of decoherence ; ( 1 ) the mechanical coupling to the thermal bath , ( 2 ) the effect of other weakly - coupled mechanical modes and sources of phase fluctuations , ( 3 ) the intrinsic optical loss @xmath39 , ( 4 ) insertion loss , and ( 5 ) the propagation losses in the long waveguide . </S>",
    "<S> the important parameter in understanding the mechanical decoherence ( 1 ) is the thermalization rate @xmath114 , where @xmath115 is the mechanical linewidth and @xmath116 is the thermal occupation at the mechanical frequency . in the high temperature limit , @xmath117 and @xmath118 </S>",
    "<S> as long as the @xmath119 , the chance of a phonon entering the system from the bath during the time that protocol is being run for remains small . </S>",
    "<S> this is equivalent to having @xmath120 . </S>",
    "<S> such @xmath121 products have been obtained at cryogenic tempeatures  @xcite , and more recently at room temperature with silicon nitride membranes  @xcite . </S>",
    "<S> the effect of competing mechanical modes ( 2 ) has long been an issue in pulsed optomechanics experiments  @xcite . </S>",
    "<S> recent experiments  @xcite have been successful at reducing the coupling to these modes to a few percent of the primary mode by careful engineering of structures and positioning of the optical beam . sources ( 3)-(5 ) affect the protocol in a similar way , in the sense that they introduce a finite probability @xmath122 that a photon can be lost to the environment during the execution of the gate . </S>",
    "<S> for the intrinsic losses ( 3 ) , this means requiring @xmath123   is composed of the intrinsic and extrinsic parts @xmath124 , with @xmath125 . ] </S>",
    "<S> be close to @xmath126 . </S>",
    "<S> in other words , the coupling ratio @xmath127 . since @xmath128 , it is best to reduce @xmath21 to smallest value allowable by the full quantum model . </S>",
    "<S> this leads to @xmath106 , meaning that @xmath129 for a @xmath130 . for insertion losses ( 4 ) </S>",
    "<S> , it is important to keep @xmath131 also small for similar reasons . finally ( </S>",
    "<S> 5 ) , the chance of a photon being absorbed in the long delay is related to the loss rate of the fiber ( on the order of @xmath132 in the telecom c - band ) and the required delay @xmath133 . to achieve a more than @xmath134 chance for the photon to survive propagation in the delay for the @xmath106 case shown in figure  [ fig : result1 ] , we require a mechanical frequency greater than @xmath135 . </S>",
    "<S> currently , these parameters remain outside our experimental reach , though progress in experimental quantum optomechanics is expected to bring us closer to the required parameters in a few platforms in the coming years .    in conclusion , we have demonstrated that a gate between propagating photons can be implemented with the slow and weak nonlinearity of an optomechanical resonator under the correct quantum feedback conditions . </S>",
    "<S> in addition to opening up a new part of the optomechanical parameter space to quantum experiments , the approach shows that quantum feedback has the potential to enhance quantum nonlinear phenomena . in the future , it is interesting to consider the evolution of entanglement in quantum feedback networks using the mps method , to better understand how interesting quantum many - body states with nontrivial correlations can be generated .    </S>",
    "<S> * acknowledgements . </S>",
    "<S> * this work was supported by nsf eccs-1509107 and the stanford terman fellowship , tshinghua university undergraduate research program , onr muri qomand , as well as start - up funds from stanford university . </S>",
    "<S> we thank jeff hill for his comments on the manuscript .    </S>",
    "<S> 46ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ] </S>",
    "<S>  + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty link:\\doibase 10.1103/revmodphys.86.1391 [ * * ,   ( ) ] link:\\doibase    10.1126/science.1228370 [ * * ,   ( ) ] ,   http://dx.doi.org/10.1038/ncomms2201    http://www.nature.com/ncomms/journal/v3/n11/suppinfo/ncomms2201{_}s1.html [ * * ,   ( ) ] link:\\doibase    10.1038/nphys2911 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.116.043601 [ * * ,   ( ) ] ,   link:\\doibase    10.1038/nature11325 [ * * ,   ( ) ] ,   link:\\doibase    10.1038/nature12307 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevx.3.031012 [ * * ,   ( ) ] ,   link:\\doibase    10.1126/science.1195596 [ * * ,   ( ) ] http://arxiv.org/abs/1012.1934 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.52.3489 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevlett.107.063601 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.107.063602 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.063601 [ * * ,   ( ) ] link:\\doibase    10.1103/physrevlett.109.013603 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physreva.73.062305 [ * * ,   ( ) ] link:\\doibase 10.1103/physreva.81.043823 [ * * ,   ( ) ] , link:\\doibase 10.1103/physreva.89.052327 [ * * ,   ( ) ] link:\\doibase 10.1073/pnas.1105098108 [ * * ,   ( ) ] link:\\doibase 10.1038/ncomms3295 [ * * ,   ( ) ] link:\\doibase 10.1109/tac.2009.2031205 [ * * ,   ( ) ] ,   link:\\doibase 10.1088/1367 - 2630/16/6/065004 [ * * ,   ( ) ] , link:\\doibase    10.1103/physrevapplied.1.054005 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.109.173602 [ * * ,   ( ) ] , link:\\doibase 10.1103/physreva.87.013815 [ * * ,   ( ) ] , link:\\doibase    10.1103/physrevx.3.021013 [ * * ,   ( ) ] ,   link:\\doibase    10.1364/oe.21.018371 [ * * ,   ( ) ] ,   @noop ph.d . </S>",
    "<S> thesis ,   ( ) link:\\doibase 10.1103/physrevlett.115.060402 [ * * ,   ( ) ] , link:\\doibase 10.1103/physrevlett.116.093601 [ * * ,   ( ) ] , link:\\doibase 10.1140/epjqt / s40507 - 016 - 0041 - 9 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevlett.91.147902 [ * * ,   ( ) ] , link:\\doibase 10.1103/physrevlett.93.040502 [ * * ,   ( ) ] , link:\\doibase 10.1016/j.aop.2010.09.012 [ * * ,   ( ) ] ,   link:\\doibase    10.1103/physrevlett.95.110503 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physreva.75.032311 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevlett.104.190405 [ * * ,   ( ) ] , link:\\doibase    10.1038/nature10461 [ * * ,   ( ) ] link:\\doibase 10.1103/physrevlett.116.147202 [ * * ,   ( ) ] ,   link:\\doibase 10.1103/physrevx.6.021001 [ * * , ( ) ] ,   http://arxiv.org/abs/1608.00937 [   ( ) ] , </S>"
  ]
}