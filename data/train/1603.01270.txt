{
  "article_text": [
    "quantum key distribution ( qkd ) @xcite is today one of the most advanced quantum technologies among those emerged from the fundamental research in quantum information . rapidly progressing towards practical implementations @xcite , the interest in qkd",
    "is motivated by the promise of achieving efficient distribution of cryptographic keys over insecure channels .",
    "in fact its main goal is to provide an information - theoretic secure strategy to share cryptographic keys in order to replace the current computationally - secure solution @xcite , which has been proved to be vulnerable @xcite to attacks by quantum computers .",
    "the typical scenario involves two parties , alice and bob , who want to share a secret message over an insecure channel @xcite  . to achieve this goal",
    "they encode classical information in non - orthogonal quantum states , which are sent over a noisy quantum channel under control of an eavesdropper , eve .",
    "the standard assumptions to analyze the security of qkd protocols are the following : eve is computationally unbounded , but has no - access to the parties private spaces @xcite and , most importantly , she is restricted by the no - cloning theorem @xcite . the distribution of private keys is possible because any attempt to extract the encoded information unavoidably introduces noise on the quantum states . monitoring this noise",
    "the parties can quantify how much eve has learnt on the secret key and , consequently , apply classical error correction and privacy amplification protocols reducing eve s information to a negligible amount .",
    "once they have distilled such a key , the parties can safely use the one - time pad protocol . in case",
    "the level of noise is too high , above the security threshold , they can abort the protocol ( denial of service ) .",
    "the first theoretical proposals for qkd protocols have been designed for discrete variables ( dv ) @xcite systems .",
    "today several remarkable implementation of dv - qkd have been achieved in both fibers @xcite and free space @xcite . beside this approach ,",
    "several protocols exploiting quantum continuous - variable ( cv ) systems have been put forward @xcite . in cv - qkd @xcite the information is encoded in quantum systems with continuous spectra ( infinite - dimensional hilbert space ) , and a special attention has been devoted to gaussian cv systems @xcite .",
    "gaussian cv - qkd has been achieved in _ in - field _",
    "implementations @xcite , with practical performances comparable to those of dv - qkd , despite the latter appears to be more robust for long - distances .",
    "the result of ref .",
    "@xcite has been possible combining efficient reconciliation protocols @xcite , post - selection @xcite techniques and efficient classical compression codes @xcite .",
    "the interest in optical cv systems , for quantum information purposes , is now growing , boosted mainly by the natural properties of these systems : relatively cheap experimental implementation , higher rates , broadband detection techniques @xcite , and the possibility of exploiting a wide range of frequencies @xcite .",
    "these natural properties make cv - qkd a promising candidate for future practical real - world implementations , especially in the mid - range distances like the metropolitan areas where high rates are desirable @xcite .    today",
    ", many theoretical efforts are devoted to the design of device independent ( di ) qkd protocols @xcite . despite recent remarkable results ,",
    "the practical implementation of this approach remains still difficult @xcite .",
    "very likely the next generation of end - to - end quantum networks will use the recently introduced @xcite measurement device independent qkd ( mdi - qkd ) which allows the distribution of cryptographic keys preserving the protection against the most typical side - channel attacks , without the need to pass a bell test ( see ref .",
    "@xcite for a general security analysis ) .",
    "recently a very high - rate cv - mdi qkd protocol has been proposed and tested in a proof of principle experiment @xcite .    alongside the study of end - to - end qkd , it is also of great interest the design of more robust _ point - to - point _",
    "qkd schemes improving the security performances of cv - qkd in noisier environments @xcite or able to exploit trusted noise  @xcite to implement qkd at different frequencies @xcite . in this regard ,",
    "the two - way protocols  @xcite , where the parties make a double use of the quantum channel to improve the tolerance to noise , show higher security thresholds than the one - way counterparts .",
    "this idea has been also extended to thermal qkd @xcite .",
    "also note that the two - way protocols have been developed for dv - qkd @xcite and can be used for direct quantum communication @xcite .",
    "the main result in this work is the explicit study of the asymptotic security of two - way gaussian protocols against coherent attacks , and the proof that these schemes are in fact immune to this eavesdropping .",
    "the general strategy to achieve this goal follows a previous insight @xcite and can be summarized as follows ( see fig .  [ 2wayscheme ] ) : the parties randomly switch on or off the two - way communication line , and they post - select the off  instances if they detect the presence of coherent attacks , otherwise they use the on instances .",
    "we explicitly study the security threshold of the off configuration against two - mode coherent attacks , which are the residual eavesdropping after de finetti reduction .",
    "our approach allows us to prove that the superadditivity of the two - way thresholds is a general feature .",
    "this result can also be understood noting that the on / off switching activates an additional degree of freedom , exclusive to the parties , which can be used to convert ( a - posteriori ) eve s correlations into a noise on which eve has no control .     and",
    "density matrix @xmath0 and sends them through the noisy channel . using the circuit in on configuration",
    ", alice applies a random displacement @xmath1 on @xmath0 encoding information in the amplitude @xmath2 . _",
    "backward _ , alice then sends the quantum state @xmath3 to bob who applies heterodyne detection with outcome @xmath4 , and applies classical post - processing to subtract the reference amplitude @xmath5 to recover @xmath2 . in off configuration , the circuit is opened at alice s station .",
    "she applies heterodyne detection on the reference state , obtaining the variable @xmath2 .",
    "she then prepares a new coherent state @xmath6 which is sent back to bob who heterodynes this state obtaining the variable @xmath7 . during the quantum communication eve , as well as bob , does not know which setup of the circuit has been adopted . for this reason , she is forced to attack both communication steps , and can not adapt her attack to the on / off setup.,scaledwidth=45.0% ]",
    "in fig .  [ 2wayscheme ] we describe a two - way quantum communication protocol .",
    "we focus on use of coherent states , for the encoding , and heterodyne detections for the decoding @xcite .",
    "bob prepares a gaussian - modulated reference coherent state with density matrix @xmath0 , and use the quantum channel to transmit it to alice who , randomly , decides to close ( case on ) or open ( case off ) the quantum communication .",
    "let discuss the two cases in detail .",
    "_ case on _ : alice encoding is performed by applying a gaussian - modulated displacement @xmath8 on the reference state @xmath0 , obtaining  a new coherent state with density matrix @xmath3 . this is sent back to bob who performs heterodyne detection on the received state @xmath3 , and applies classical post - processing in order to subtract the reference variable @xmath5 and derive bob s estimate @xmath9 of alice s variable @xmath2 .    _ case off_. alice applies heterodyne detection on the reference state @xmath0 with outcome @xmath2 .",
    "then , she prepares a new gaussian - modulated coherent state @xmath6 which is sent back to bob , who heterodynes it with outcome @xmath7 .",
    "after this , the parties can use the two pairs of variables @xmath10 and @xmath11 to prepare the key .",
    "we note that , during the quantum communication , both bob and eve do not know the configuration adopted .",
    "this information is shared during the phase of parameter estimation and is part of the classical communication performed by alice over the public channel . in the following we focus on the use of reverse reconciliation ( rr )",
    "@xcite ( direct reconciliation is discussed in the supplemental material ) . with the quantum communication in on",
    ", the rr corresponds to alice inferring bob s final outcome variable @xmath9 . with the circuit in off , the rr corresponds to bob estimating alice s variable @xmath2 during the forward stage , followed by alice estimating bob s detection variable @xmath7 .    as described in ref .",
    "@xcite the advantage of having the on / off switching is that this degree of freedom can be used to post - select the data in order to prepare the key .",
    "after the channel tomography they can determine which attack has been performed and in which status of the circuit .",
    "then they keep data from case on when they detect a collective attack , while they use data exchanged with the circuit in off when the attack is coherent .",
    "we study the security of the scheme assuming the asymptotic limit of many uses of the quantum channel , @xmath12 . in the worst - case scenario",
    "the eavesdropper attaches ancillary quantum systems , @xmath13 to each exchanged signal , and process the @xmath14 s by a global coherent unitary operation .",
    "the ancillary output modes are stored in a quantum memory ( qm ) , and coherently measured after the classical communication between alice and bob at the end of the protocol .",
    "such an eavesdropping defines a general coherent attack .",
    "the parties can now reduce the complexity of the previous scenario , by applying symmetric random permutations @xcite of their classical data .",
    "this allows them to get rid of all the correlations between distinct instances of the protocol .",
    "it is then clear that , in the case of two - way communication , the de finetti symmetrization provides a residual two - mode coherent attack , where the only surviving correlations are those between @xmath15 and @xmath16 , used by eve in each single round - trip .",
    "these ancillary modes are mixed with the forward and backward signals by means of beam splitters .",
    "note that we can rid of additional modes @xmath17 because we work in the asymptotic limit and we bound eve s accessible information using the holevo function @xcite .",
    "finally , a further simplification comes from the extremality of gaussian states @xcite , which means that we can restrict eve s input @xmath18 to be a gaussian state .",
    "the gaussian attack is collective , when @xmath15 , @xmath16 are uncorrelated , or two - mode coherent when they are correlated . studying this second case with the circuit in on and in dr , ref .",
    "@xcite found that optimal two - mode attacks exist which can reduce the security performances of the two - way protocol below the one - way threshold .",
    "here we show that , using the scheme with the on / off switching , and post - selecting the optimal key - rate accordingly to the attack detected , the parties can overcome this problem .",
    "the security analysis is performed according to the setup shown in fig .",
    "[ fig:2wayonandoff ] , where fig .",
    "[ fig:2wayonandoff](a ) refers to collective attacks , while fig .",
    "[ fig:2wayonandoff](b ) refers to two - mode coherent attacks . in the latter case",
    ", the security analysis is performed in the entanglement based ( eb ) representation @xcite .      in eb representation",
    "both bob and alice remotely prepare coherent states on the travelling modes @xmath19 and @xmath20 by using two - mode squeezed vacuum states , described by covariance matrices ( cms ) of the following form@xmath21{cc}% \\mu_{b}\\mathbf{i } & \\sqrt{\\mu_{b}^{2}-1}\\mathbf{z}\\\\ \\sqrt{\\mu_{b}^{2}-1}\\mathbf{z } & \\mu_{b}\\mathbf{i}% \\end{array } \\right )   , \\label{bob - epr}\\\\ v_{a_{2}a_{2}^{\\prime } }   &   = \\left ( \\begin{array } [ c]{cc}% \\mu_{a}\\mathbf{i } & \\sqrt{\\mu_{a}^{2}-1}\\mathbf{z}\\\\ \\sqrt{\\mu_{a}^{2}-1}\\mathbf{z } & \\mu_{a}\\mathbf{i}% \\end{array } \\right )   , \\label{alice - epr}%\\end{aligned}\\ ] ] on which they apply heterodyne detections on the respective local modes @xmath22 and @xmath23 . the parameters @xmath24 , and @xmath25 describe the variance of the thermal state injected by alice and bob , respectively . the two travelling modes , @xmath19 and @xmath20 , are mixed with eve s modes , @xmath15 and @xmath16 , on two identical beam splitters , with transmissivity @xmath26 .",
    "eve s input state @xmath18 is a zero mean , two - mode correlated thermal state , with cm@xmath27{cc}% \\omega\\mathbf{i } & \\mathbf{g}\\\\ \\mathbf{g } & \\omega\\mathbf{i}% \\end{array } \\right )   , \\text { with } \\mathbf{g=}\\left ( \\begin{array } [ c]{cc}% g & \\\\ & g^{\\prime}% \\end{array } \\right )   , \\label{cmattack}%\\ ] ] where @xmath28 gives the variance of the thermal noise injected , while @xmath29 and @xmath30 describe the correlations between the two ancillas .",
    "note that the double use of the channel corresponds to a sequential use of the same communication line ( optical fibre ) , so it is reasonable to consider a symmetric channel ( @xmath26 and @xmath31 are the same during the forward and backward communication ) .",
    "the correlation parameters @xmath29 and @xmath30 must fulfill the following constraints@xmath32 in order to certify that @xmath33 is a bona fide cm . if @xmath34 , we must have @xmath35 , with the two extremal conditions corresponding to @xmath15 and @xmath16 sharing maximal separable correlations @xcite . if @xmath36 the ancillas share non - separable correlations .",
    "( [ cmconstraints ] ) provides the bound @xmath37 , with the extremal values corresponding to maximally entangled states . finally , if @xmath38 , the two ancillas are not correlated , and the two - mode attack collapses to a standard collective one , based on two independent entangling cloners .",
    "we compute now the secret - key rate @xmath39 , where @xmath40 is alice - bob mutual information , and @xmath41 is eve s accessible information . in the asymptotic case @xmath12 ,",
    "@xmath41 can be replaced by the holevo information @xmath42 .",
    "hence we write@xmath43 the goal of the security analysis is the computation of the bound @xmath42 , which is defined as @xmath44 the functional @xmath45 is the von neumann entropy , relative to eve s quantum state @xmath46 , and @xmath47 is that corresponding to @xmath48 , which describes eve s sate conditioned on the outcomes of the measurements performed by the parties .    against collective attacks ,",
    "the parties use the protocol in on , and we have the following on key - rate @xmath49 by contrast , against coherent attacks , they use the circuit in off , for which we have the following off key - rate @xmath50 where@xmath51 is the mutual information averaged over the forward and backward use , and@xmath52 is computed on alice and bob s output state @xmath53 .    thus , for collective attacks we select the on key - rate @xmath54 , while for coherent attacks we select the off key - rate @xmath55 . both these key - rates are function of channel parameters , i.e. , transmissivity @xmath26 and excess noise @xmath56 ( which gives the extra noise on the channel with respect the vacuum shot - noise )",
    ". the off key - rate , @xmath55 , is also function of the correlation parameters @xmath29 and @xmath30 .",
    "therefore , once we have @xmath57 , we find the security thresholds solving the following equation @xmath58 this condition provides threshold curves of the type @xmath59 which simplifies to @xmath60 for collective attacks",
    ".      the computation of the secret - key rates can be performed using the mathematical tools described in ref .",
    "@xcite . from the knowledge of the cm describing the total and conditional states",
    ", we can compute the von neumann entropies and finally the key rates .",
    "for the protocol with coherent states and heterodyne detection we find the following key - rates@xmath61 where @xmath62    in the previous formulas , the symplectic eigenvalues @xmath63 are computed numerically and we define @xmath64 and @xmath65 .",
    "it is of particular interest the off key - rate of eq .",
    "( [ rate - off ] ) , from which we notice that one can recover the one - way key - rate in the case of collective attacks ( @xmath38 ) .",
    "the expressions of the total and conditional symplectic eigenvalues can be computed analytically for large modulation , being equal to @xmath66[\\lambda_{\\pm}^{\\prime}+1-t)]}}{t } , \\label{spectrum - het2-cond - rr - off}%\\end{aligned}\\ ] ] where @xmath67 and @xmath68 .",
    "here we give the key - rate @xmath69 for the two - way protocol with coherent states and homodyne detection . the only change with respect to the previous scheme is clearly the use of homodyne detection for decoding . with the circuit in on ,",
    "bob prepares coherent states , randomly displaced by alice and finally homodyned by bob . with the protocol in off ,",
    "bob prepares coherent states and alice performs homodyne detection . then she sends back newly prepared coherent states which are homodyned by bob .",
    "after some algebra , we obtain the following analytical expressions for the key - rates @xmath70{(\\omega^{2}-g^{2}% ) ( \\omega^{2}-g^{\\prime2})}}{(1-t)\\tilde{\\lambda}}-\\sum_{i=\\pm}\\frac{h(\\nu _ { i})}{2}. \\label{rate - het - hom - rr - off}%\\end{aligned}\\ ] ]    in the on key - rate of eq .",
    "( [ rate - het - hom - rr - on ] ) , used against collective attacks , the asymptotic symplectic eigenvalue @xmath71 can be computed analytically as @xmath72}{t^{2}% + \\omega+t^{3}(\\omega-1)}}.\\ ] ] by contrast , the off key - rate of eq .",
    "( [ rate - het - hom - rr - off ] ) is exploited under coherent attacks , and the total symplectic eigenvalues @xmath73 are the same as given in eq .",
    "( [ spectrum - het2-tot - off ] ) .",
    "the details to obtain eqs .",
    "( [ rate - het - hom - rr - on ] ) and ( [ rate - het - hom - rr - off ] ) can be found in the supplemental material , where we also include the secret - key rates computed in dr .",
    "the security analysis of the thresholds coming from eqs .",
    "( [ rate ] ) and ( [ rate - off ] ) is summarized in fig .",
    "[ fig:2wayvs1way ] . in particular , the security threshold for the on configuration is confirmed  @xcite to be superadditive in fig .",
    "[ fig:2wayvs1way](top - left ) .",
    "the black - solid line corresponds to the on threshold , which is clearly above the threshold of the one - way protocol ( dashed line ) .",
    "this comparison is done against collective attacks .    ) and ( [ rate - off ] ) .",
    "the top panels describe the security thresholds , in terms of tolerable excess noise @xmath74 versus transmissivity @xmath26 . in the top - left panel ,",
    "we consider collective attacks and we compare the on two - way threshold @xmath75 ( black solid line ) with the threshold of the one - way protocol ( dashed line ) . in the pink region",
    "the two - way protocol is secure , while the one - way counterpart is not . in the top - right panel",
    ", we consider coherent attacks and we compare the off two - way threshold ( a)-(c ) with respect to the one - way threshold ( d ) .",
    "in particular , curve ( a ) is obtained for @xmath76 , i.e. , eve using maximally entangled states ; curve ( b ) considers the case @xmath77 with @xmath78 ; and curve ( c ) refers to @xmath36 and @xmath79 .",
    "note that curve ( d ) coincides with the off threshold against collective attacks , in which case the protocol is used in on .",
    "the same labels ( a)-(d ) are used in the bottom - left panel , which describes the various attacks on the correlation plane @xmath80 , obtained setting @xmath81 in the constraint of eq .",
    "( [ cmconstraints ] ) .",
    "finally , in the bottom - right panel , we plot the off key - rate against coherent attacks ( red lines ) , compared to the quantum mutual information ( black lines ) describing the correlations of eve s ancillas .",
    "we set @xmath82 and @xmath83 , so that the one - way rate is @xmath84 zero .",
    "we see that the off key - rate is always strictly positive and it increases for increasing correlations in the attack.,scaledwidth=45.0% ]    the top - right panel of fig .",
    "[ fig:2wayvs1way ] , shows the security threshold for the off configuration in the presence of several two - mode attacks with different values of the correlation parameters @xmath85 .",
    "the curves labeled ( a)-(d ) corresponds to the points in fig .",
    "[ fig:2wayvs1way ] ( bottom - left ) .",
    "for example , the red curve ( a ) describes coherent attacks performed with maximally entangled states .",
    "the curve ( b ) describes attacks with @xmath86 , and the curve ( c ) corresponds to @xmath87 .",
    "finally , the dashed curve ( d ) corresponds to the center of the correlation plane , where the off  threshold coincides with the one - way threshold .",
    "thus , we see that for any value of eve s correlation parameters , @xmath29 and @xmath30 , alice and bob can always post - select an instance of the two - way protocol ( on or off ) whose threshold is strictly greater than that of the corresponding one - way protocol .    finally , fig .",
    "[ fig:2wayvs1way ] ( bottom - right ) describes the connection between the off key rate and the amount of correlations in eve s ancillas , as quantified by the quantum mutual information .",
    "we can see that the off key rate not only is positive ( while the one - way rate is always zero ) but it also increases with eve s correlations , which are converted into noise by the off configuration .",
    "thus , the on / off switching , together with the post - selection of the correct instances , allows one to implement two - way cv - qkd in a way which is not only secure , but also more robust to excess noise with respect to one - way protocols under completely general attacks .",
    "a detailed description of the methods can be found in the supplementary material .",
    "the security analysis of the protocol has been performed in the entanglement based representation for the case off , so that we could compute the holevo bound from the study of alice - bob cm . for the case on in rr",
    ", we started from the output covariance matrix of eve , to compute the total von neumann entropy .",
    "we then computed the conditional von neumann entropy completing eve s covariance matrix with the bob s mode on which we applied the heterodyne or the homodyne measurement , accordingly with the case studied .",
    "in this work we have studied the security of two - way cv - qkd addressing , explicitly , the superadditivity of its security threshold against coherent attack . to the best of our knowledge",
    "this represents the first attempt of such a complete study for direct point - to - point two - way protocols .",
    "our security analysis is obtained assuming the asymptotic limit , i.e. , large number of signals exchanged and large modulation .",
    "this allowed us to find closed formulas for the secret - key rates , from which we have proved that the two - way gaussian protocols are more robust to excess noise than their one - way counterparts in both collective and coherent attacks .    for this property ,",
    "it is crucial the random on / off switching of the protocol , so that the eavesdropper s correlations are under control of the parties and they are transformed , if needed , into useless noise .",
    "our analysis contributes to the general understanding of the security properties of two - way protocols and is useful to extend cv - qkd  to regime with high excess noise .",
    "future developments could involve the study of this on / off switching strategy in more complex quantum communication scenarios .",
    "we acknowledge financial support from the epsrc via the ` uk quantum communications hub ' ( grant no .",
    "ep / m013472/1 ) .",
    "bennet , c.h . &",
    "brassard g. quantum cryptography : public key distribution and coin tossing , proceedings of the ieee international conference on computers , systems , and signal processing , bangalore , p. 175",
    "( 1984 )                                                                ottaviani , c. , spedalieri g. , braunstein s.l . &",
    "pirandola s. continuous - variable quantum cryptography with an untrusted relay : detailed security analysis of the symmetric configuration , phys . rev . a * 91 * , 022320 ( 2015 ) .",
    "this supplemental material gives the details of the calculations for the security analysis of the protocols described in this work , and includes also the key - rates calculated for two - way protocol used in direct reconciliation ( dr ) , which has not been discussed in the main body .",
    "we underline that compared to the one - way protocol , the two - way presents a richer number of cases which need to be analyzed .",
    "the protocols are named with respect to the _ preparation _ and _ detection _ scheme adopted . here",
    "we discuss the protocol with coherent states and heterodyne detection , and with coherent states and homodyne detection .",
    "each one of previous cases can be implemented in dr as well as reverse reconciliation ( rr ) , and here we give the results for both reconciliation schemes .",
    "the secret - key rate quantifies the gap between alice and bob s mutual information and the information shared between eve and the parties . which parties variable(s ) has(have ) to be considered depends on the setup of the protocol ( one - way , two - way , on or off ) and , in general , from the reconciliation protocol employed .    for instance",
    "consider the one - way protocol .",
    "we assume that alice sends a modulated coherent state with amplitude @xmath2 to bob , who receives a noisy version of this state , whose amplitude is @xmath5 .",
    "the parties can then obtain two distinct secret - key rates defined as follows @xmath88 the first describes the key - rate in dr , while the second the rr .",
    "the function @xmath40 is the classical mutual information quantifying correlations between alice s variable , @xmath2 , and bob s variable , @xmath5 . for each quadrature",
    "measured , and used to encode information , the mutual information is given by the following general signal - to - noise ratio@xmath89 where @xmath90 is the variance of the variable used to prepare the key , and @xmath91 the conditioned variance of this statistical variable after the measurement performed by the parties .    in the asymptotic limit of many uses of the quantum channel",
    "we can bound eve s accessible information by the holevo function , which is given by @xmath92 the function @xmath93 describes the von neumann entropy which , for gaussian quantum systems , has a simple form given by @xmath94 with the entropic function @xmath95 is defined as follows@xmath96 and where the @xmath97 s are the symplectic eigenvalues of the cm which describes the dynamics of the studied gaussian quantum system @xcite .",
    "the expression of the von neumann entropy of eq .",
    "( [ h - func ] ) can be further simplified exploiting the limit of large signal modulation , in which case we can write @xcite @xmath98 the computation of the symplectic spectra can be done in prepare and measure configuration , in which case the @xmath97 s are obtained from the symplectic analysis of eve s output cm or , in case we use the equivalent eb representation , from alice - bob s cm .",
    "this second approach is used in the following , to study the off configurations , i.e. , when we consider coherent attacks .    to compute the symplectic spectrum",
    ", we first compute the appropriate cm @xmath99 and then , from matrix @xmath100 where @xmath101 with @xmath102 the single - mode symplectic form given by @xmath103{cc}0 & 1\\\\ -1 & 0 \\end{array } \\right )   , \\ ] ] we compute the ordinary eigenvalues , which come in pairs .",
    "the symplectic spectrum is obtained taking their absolute value .",
    "we start showing how we obtain the on key - rate for the protocol with coherent states and heterodyne detection , which is described in fig .  2  ( a ) of the main text .",
    "the security analysis is performed using eve s cm , obtained from the outputs @xmath104 . from this",
    "we obtain the total von neumann entropy and , by simple conditioning procedure , one can also compute eve s conditional cm .",
    "this describes the conditional state @xmath105 , for the protocol in dr .",
    "by contrast , to study the protocol in rr , we complete eve s output cm with bob s post - processed output mode @xmath106 , on which we apply the heterodyne detection in order to obtain the conditional cm for this case .",
    "bob sends modulated coherent states to alice providing , on average , a thermal state with variance @xmath25 , where @xmath107 accounts for the classical gaussian modulation on the top of the vacuum shot - noise .",
    "alice applies an additional random displacement , @xmath1 , on the states received from bob with modulation variance @xmath108 .",
    "alice - bob mutual information can be computed from the expression of the variance of post - processed mode @xmath109 , given by @xmath110i , \\label{b2}\\ ] ] from which , in the limit of large modulation @xmath111 , we obtain the signal variance @xmath112 we then compute the conditional variance from eq .",
    "( [ b2 ] ) by setting alice modulation @xmath113 , obtaining @xmath114 finally , using eqs .",
    "( [ variance  bob ] ) and ( [ variance  bob - conditional ] ) with the expression of the mutual information in case of heterodyne detection @xmath115 we obtain the following alice - bob mutual information in the limit of large modulation @xmath116      we compute now the cm of eve s output quantum state @xmath117 .",
    "we arrange it in the following normal form @xmath118{cc}\\mathbf{a } & \\mathbf{c}\\\\ \\mathbf{c}^{t } & \\mathbf{b}\\end{array } \\right )   , \\label{vevetot}\\ ] ] where @xmath119{cc}\\omega\\mathbf{i } & \\sqrt{t(\\omega^{2}-1)}\\mathbf{z}\\\\ \\sqrt{t(\\omega^{2}-1)}\\mathbf{z } & \\psi\\mathbf{i}\\end{array } \\right )   , \\nonumber\\\\ \\mathbf{b }   &   \\mathbf{:}=\\left ( \\begin{array } [ c]{cc}\\omega\\mathbf{i } & \\sqrt{t(\\omega^{2}-1)}\\mathbf{z}\\\\ \\sqrt{t(\\omega^{2}-1)}\\mathbf{z } & \\tilde{\\psi}\\mathbf{i}\\end{array } \\right )   , \\nonumber\\\\ \\mathbf{c }   &   \\mathbf{:}=\\left ( \\begin{array } [ c]{cc}0 & \\xi\\mathbf{z}\\\\ 0 & \\phi\\mathbf{z}\\end{array } \\right )   , \\end{aligned}\\ ] ] with @xmath120+(1-t)\\mu _",
    "{ on},\\nonumber\\\\ \\psi &   = t(\\omega-\\mu_{b})+\\mu_{b},\\nonumber\\\\ \\phi &   = ( 1-t)\\sqrt{t}(\\mu_{b}-\\omega),\\nonumber\\\\ \\xi &   = -(1-t)\\sqrt{(\\omega^{2}-1)}. \\label{mode - b}\\ ] ]    from eq .",
    "( [ vevetot ] ) we easily obtain the total symplectic spectrum by taking the limits for @xmath111 and @xmath121 @xmath122 the latter , used with eqs .",
    "( [ vonneumann - def ] ) and ( [ vonneumann - def - asy ] ) , gives the total von neumann entropy @xmath123      for the dr the conditional cm can be obtained straightforwardly from eq .",
    "( [ vevetot ] ) setting @xmath113 on both quadratures in the block describing eve s output @xmath124 , i.e. , @xmath125 in eq .",
    "( [ mode - b ] ) .",
    "the resulting conditional cm has the following asymptotic symplectic spectrum @xmath126 using eq .",
    "( [ spectrumcond - on - het2-dr ] ) with eq .",
    "( [ vonneumann - def ] ) and ( [ vonneumann - def - asy ] ) , we compute the conditional von neumann entropy @xmath127 now , using eqs .",
    "( [ se - het2 ] ) and ( [ se - cond - het2 ] ) in eq .",
    "( [ chi - supp - mat ] ) , one obtains the expression of the holevo bound @xmath128 finally , by subtracting the holevo function of eq .",
    "( [ chi - dr - on - het2 ] ) from the mutual information of eq .",
    "( [ iabhet2 ] ) we get the on key - rate in dr @xmath129}-h(\\omega).\\ ] ]      to study the security of the protocol in rr , we need to re - compute the conditional von neumann entropy for this case .",
    "we complete the cm of eq .",
    "( [ vevetot ] ) adding the blocks describing bob s output mode @xmath106 and its correlations with the rest of eve s modes",
    ". then we apply a heterodyne detection on @xmath106 obtain eve s conditional cm after bob s measurements .",
    "we then write @xmath130{cc}\\mathbf{v}_{e } & \\mathbf{\\bar{c}}\\\\ \\mathbf{\\bar{c}}^{t } & \\mathbf{\\bar{b}}\\end{array } \\right )   , \\label{v - eve - and - bob - on - rr}\\ ] ] where @xmath131\\mathbf{i,}\\\\ \\mathbf{\\bar{c } }   &   \\mathbf{=}\\sqrt{1-t}\\left ( \\begin{array } [ c]{c}\\sqrt{t(\\omega^{2}-1)}\\mathbf{z}\\\\",
    "t(\\omega-1)\\mathbf{i}\\\\ \\sqrt{(\\omega^{2}-1)}\\mathbf{z}\\\\ \\sqrt{t}[t(\\omega-1)-\\mu]\\mathbf{i}\\end{array } \\right )   .\\end{aligned}\\ ] ] we then apply the formula for heterodyne detection @xcite obtaining the following conditional cm @xmath132 which gives the following conditional symplectic spectrum @xmath133 notice that the eigenvalues @xmath134 are asymptotically depending only on the channel parameters @xmath135 , and are related by the following expression @xmath136\\omega}{t(1+t)}.\\ ] ] from the eigenvalues of eq .",
    "( [ spectrum - cond - het2-on ] ) , used with eqs .",
    "( [ chi - supp - mat ] ) , ( [ vonneumann - def ] ) and ( [ vonneumann - def - asy ] ) we obtain the holevo bound for the rr @xmath137 which , used with eq .",
    "( [ iabhet2 ] ) in the definition of eq .",
    "( [ key - rate - def - on ] ) in the main text , gives the secret - key rate for the protocol used in rr given in eq .",
    "( [ rate ] ) of the main text .",
    "we now describe the details of the calculations for the protocol used in off , as described in fig .",
    "2-(b ) of the main text .",
    "in this case we perform the security analysis considering two - mode coherent attacks , in the eb representation .",
    "bob starts from a two - mode squeezed vacuum state , described by the cm of eq .",
    "( [ bob - epr ] ) in the main text . applying a local heterodyne detection on mode @xmath22 ,",
    "he projects the traveling mode @xmath19 in a coherent state . in the same way",
    ", alice applies a local heterodyne detection on mode @xmath23 , projecting the traveling mode @xmath20 in a coherent state .",
    "finally , we assume that eve injects the general gaussian state described by eq .",
    "( [ cmattack ] ) in the main text .",
    "since the total state of alice , bob and eve is pure , we can reduce ourselves to compute alice and bob s state ( having the same entropy of eve s ) .",
    "we then order alice s and bob s the output modes as follows @xmath138 @xmath139 @xmath140 @xmath141 , and obtain the following expression @xmath142{cc}\\mathbf{\\tilde{a } } & \\mathbf{\\tilde{c}}\\\\ \\mathbf{\\tilde{c}}^{t } & \\mathbf{\\tilde{b}}\\end{array } \\right )   , \\label{vevetot - off - het2}\\ ] ] where the matrix blocks have been defined as follows,@xmath143{ccc}\\mu_{b}\\mathbf{i } &   & \\tilde{\\delta}\\mathbf{i}\\\\ & \\mu_{a}\\mathbf{i } & \\\\ \\tilde{\\delta}\\mathbf{i } &   & \\tilde{\\tau}(\\mu_{b})\\mathbf{i}\\end{array } \\right )   \\mathbf{,}\\\\ \\mathbf{\\tilde{b } }   &   = \\tilde{\\tau}(\\mu_{a})\\mathbf{i},\\\\ \\mathbf{\\tilde{c } }   &   = \\left ( \\begin{array } [ c]{c}\\mathbf{0}\\\\ \\tilde{\\delta}\\mathbf{i}\\\\ ( 1-t)\\mathbf{g}\\end{array } \\right )   , \\end{aligned}\\ ] ] where @xmath144{cc}g & \\\\ & g^{\\prime}\\end{array } \\right )   , \\ ] ] the coefficients @xmath145 and @xmath146 have been defined as follows , @xmath147},\\nonumber\\\\ \\tilde{\\tau}(y )   &   : = ( 1-t)\\omega+ty .",
    "\\label{tau - tilde}\\ ] ]    we compute the symplectic spectrum of cm ( [ vevetot - off - het2 ] )  and taking the asymptotic limit , @xmath148 , we obtain the following analytical expressions @xmath149 which gives the total von neumann entropy for the case off @xmath150      to obtain the conditional cm in dr we set @xmath151 , in modes @xmath22 and @xmath23 .",
    "it is easy to verify that the resulting cm has the following symplectic spectrum @xmath152 where , @xmath67 and @xmath68 . using these eigenvalues , we compute the following conditional von neumann entropy @xmath153 the previous equation and eq .",
    "( [ vonneumann - tot - het2-off ] ) are then used to obtain the asymptotic expression of the holevo function in dr , which is given by @xmath154   .\\label{holevo - off - het2-dr}\\ ] ]    the conditional cm corresponding to the rr , is obtained by applying two consecutive heterodyne detections , starting from cm of eq .",
    "( [ vevetot - off - het2 ] ) .",
    "we first measure mode @xmath155 and then we apply another heterodyne detection on mode @xmath23 ( the order of these two local measurements is of course irrelevant ) .",
    "the resulting conditional cm has the symplectic spectrum @xmath156[\\lambda_{\\pm}^{\\prime}+1-t)]}}{t}.\\ ] ] these are used to compute the holevo bound which is given by @xmath157      alice - bob mutual information is easily computed from the coefficient @xmath158 , given in eq .",
    "( [ tau - tilde ] ) . taking the limit of large modulation , using the formula defining the mutual information for heterodyne detections ( [ iab - het ] ) , and averaging over the double use of the quantum channel we obtain the following expression @xmath159 where @xmath160 notice that , differently from the holevo bound , the mutual information is independent from the correlation parameters described by the matrix @xmath161 .    using eq .",
    "( [ holevo - off - het2-dr ] ) and eq .",
    "( [ iabhet2-off ] ) , and after some simple algebra , we get the analytical expression of the key - rate in dr @xmath162 , \\label{r - dr - het2-off}\\ ] ] the key - rate in rr of eq .",
    "( [ rate - off ] ) in the main text , is obtained using previous eq .",
    "( [ holevo - off - het2-rr ] ) and eq .",
    "( [ iabhet2-off ] ) .      ) and ( [ rate - het - hom - rr - off - si ] ) which are the same of eqs .",
    "( 16 ) and ( 17 ) in the main text .",
    "the top panels give the security thresholds in terms of tollerable excess noise @xmath74 versus transmissivity @xmath26 . in the top - left panel ,",
    "we consider collective attacks and we compare the on two - way threshold @xmath163 ( black solid line ) with the threshold of the one - way protocol ( dashed line ) . in the pink region",
    "the two - way protocol is secure , while the one - way counterpart is not . in the top - right panel , we consider coherent attacks and we compare the off two - way threshold ( a)-(c ) with respect to the one - way threshold ( d ) . in particular , curve ( a ) is obtained for @xmath76 , i.e. , eve using maximally entangled states ; curve ( b ) considers the case @xmath77 with @xmath78 ; and curve ( c ) refers to @xmath36 and @xmath78 .",
    "note that curve ( d ) coincides with the off threshold against collective attacks , in which case the protocol is used in on .",
    "the same labels ( a)-(d ) are used in the bottom - left panel , which describes the various attacks on the correlation plane @xmath80 , obtained setting @xmath164 in the constraint of eq .",
    "( [ cmconstraints ] ) in the main text .",
    "finally , in the bottom - right panel , we plot the off key - rate against coherent attacks ( red lines ) , compared to the quantum mutual information ( black lines ) describing the correlations of eve s ancillas .",
    "we set @xmath165 and @xmath166 , so that the one - way rate is @xmath84 zero .",
    "we see that the off key - rate is always strictly positive and it increases for increasing correlations in the attack.,scaledwidth=45.0% ]    in contrast to the protocol analysed in previous section , here the decodings are performed by means of homodyne detections .",
    "this modifies the expression of the mutual information and these of the conditional von neumann entropies .",
    "the conditional cm in dr is obtained as before .",
    "we start from the total cm of eq .",
    "( [ vevetot ] ) and we apply the following conditioning procedure @xmath167 which describes alice s effective modulation in order to describe the measurement of only one quadrature during the decoding stage ( homodyne detection ) .    [",
    "[ direct - reconciliation - mutual - information - holevo - bound - and - key - rate ] ] direct reconciliation : mutual information , holevo bound and key - rate + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the conditioning procedure , described by eqs .",
    "( [ conditioning - hom ] ) , can clearly also used to determine alice - bob mutual information . in the present case only one - quadrature",
    "is used to encode the key so alice - bob mutual information is given by the following expression @xmath168    eve s conditional cm is obtained from eq .",
    "( [ vevetot ] ) applying recipe of eqs .",
    "( [ conditioning - hom ] ) .",
    "one easily obtains the conditional symplectic spectrum which , in the asymptotic limit , is given by @xmath169 after some algebra we obtain the following holevo bound @xmath170 which , used with eq .  ( [ iab - het - hom - on ] ) , provides the on key - rate for the protocol in dr @xmath171}-h(\\omega ) .",
    "\\label{r - on - het - hom - dr}\\ ] ] it is interesting to note that plotting the security threshold of the key - rate of eq .",
    "( [ r - on - het - hom - dr ] ) , one finds that it provides a positive key - rate even below @xmath172 db , which sets the limit performance of the one - way version of this protocol in dr .",
    "the security of the protocol is performed repeating the steps described in previous sections , replacing the heterodyne detections with homodyne measurements on @xmath106 .",
    "indeed , we apply the following formula @xmath173 to eq .",
    "( [ v - eve - and - bob - on - rr ] ) .",
    "note that @xmath174diag@xmath175 @xmath176diag@xmath177 for heterodyne on quadrature @xmath178 @xmath179 .",
    "we then compute the symplectic spectrum of cm @xmath180 , which we rewrite here in the following form @xmath181}{t^{2}+\\omega+t^{3}(\\omega-1)}},\\label{spectrum - het - hom - on - rr}\\\\ \\nu_{2}^{\\blacktriangleleft }   &   \\rightarrow\\omega,\\nonumber\\\\ \\nu_{3}^{\\blacktriangleleft}\\nu_{4}^{\\blacktriangleleft }   &   \\rightarrow \\sqrt{\\frac{(1-t)^{3}[t^{2}+\\omega+t^{3}(\\omega-1)]\\mu^{3}}{t}}.\\nonumber\\end{aligned}\\ ] ] we then obtain the holevo bound @xmath182 @xmath183 which combined with the mutual information of eq .",
    "( [ iab - het - hom - on ] ) gives the on key - rate in rr of eq .",
    "( [ rate - het - hom - rr - on ] ) of the main text , i.e. , @xmath184 with @xmath64 .",
    "this case is studied in the eb representation , following the same steps of the previous off case , for both the dr and rr , replacing the final heterodyne with homodyne detections .",
    "the mutual information is computed averaging over the double use of the quantum channel , i.e. , using the following definition of the mutual information @xmath185 where @xmath65 .",
    "the steps to compute the conditional cm have been discussed previously , so here we just provide the analytical expressions of the conditional symplectic spectra @xmath186}{\\gamma_{\\pm}}},\\end{aligned}\\ ] ] where we define @xmath187 notice that , in previous spectra , the role of the correlation parameters depends on the quadrature measured by the homodyne detection of the decoding stage .",
    "we obtain the following holevo bound for the dr @xmath188^{2}-t^{2}g^{2}}},\\ ] ] and the key - rate in direct reconciliation is given by @xmath189^{2}-t^{2}g^{2}}}{(1-t)[t+(1-t)\\omega]}\\\\ &   -{\\sum\\limits_{k=\\pm}}\\frac{h(\\tilde{\\eta}_{k}^{\\blacktriangleright } ) -h\\left (   \\nu_{k}\\right )   } { 2},\\end{aligned}\\ ] ] where the eigenvalues @xmath190 are defined in eq .",
    "( [ spectrumtot - off ] ) .      for the rr ,",
    "when the homodyne detection is performed on the quadrature @xmath178 , we obtain the following conditional symplectic eigenvalues @xmath191 by contrast , in case of homodyne detection on @xmath192 , the corresponding eigenvalues can be obtained from eq .",
    "( [ symp - eig - cond - rr - het - hom - off ] ) by exchanging @xmath193 .",
    "averaging over the two detections , we find the following holevo bound @xmath194{(\\omega^{2}-g^{\\prime2})(\\omega ^{2}-g^{2})}},\\ ] ] which subtracted to the mutual information of eq .",
    "( [ i - off - het - hom ] ) gives the key - rate of eq .",
    "( [ rate - het - hom - rr - off ] ) of the main text , i.e. , @xmath195{(\\omega ^{2}-g^{2})(\\omega^{2}-g^{\\prime2})}}{(1-t)\\tilde{\\lambda}}-\\sum_{k=\\pm}\\frac{h(\\nu_{k})}{2}.\\label{rate - het - hom - rr - off - si}\\ ] ]"
  ],
  "abstract_text": [
    "<S> we consider two - way continuous - variable quantum key distribution , studying its security against general eavesdropping strategies . assuming the asymptotic limit of many signals exchanged , we prove that two - way gaussian protocols are immune to coherent attacks . more precisely we show the general superadditivity of the two - way security thresholds , which are proven to be higher than the corresponding one - way counterparts in all cases . </S>",
    "<S> we perform the security analysis first reducing the general eavesdropping to a two - mode coherent gaussian attack , and then showing that the superadditivity is achieved by exploiting the random on / off switching of the two - way quantum communication . </S>",
    "<S> this allows the parties to choose the appropriate communication instances to prepare the key , accordingly to the tomography of the quantum channel . </S>",
    "<S> the random opening and closing of the circuit represents , in fact , an additional degree of freedom allowing the parties to convert , a posteriori , the two - mode correlations of the eavesdropping into noise . </S>",
    "<S> the eavesdropper is assumed to have no access to the on / off switching and , indeed , can not adapt her attack . we explicitly prove that this mechanism enhances the security performance , no matter if the eavesdropper performs collective or coherent attacks . </S>"
  ]
}