{
  "article_text": [
    "classical asset pricing theory assumes that traders act as price takers , that is , they have no impact on the prices paid or received .",
    "the relaxation of this assumption and its impact on realized returns in asset pricing models is called liquidity risk .",
    "consistent with this discussion , most of the option pricing models assume that an option trader can not affect the price in trading the underlying asset to replicate the option payoff , regardless of her trading size .",
    "the papers of black and scholes @xcite , and much of the work undertaken in mathematical finance has been done under this underlying assumption ( which is reasonable only in a perfectly liquid market ) .",
    "+ in presence of a price impact , the replication of an option becomes more involved .",
    "the first issues is whether or not the option is perfectly replicable .",
    "second , one has to find out how the presence of price impact affects the the replicating costs .",
    "this encouraged researchers to develop a black - scholes model with price impact due to a large trader who is able to move the price by his / her actions .",
    "an excellent survey of these research can be found in @xcite .",
    "most of these research works discussed how the price impact affects the replication of an option written on a single stock .",
    "the purpose of our paper is to investigate the effects of imperfect liquidity on the replication of an european spread option by a typical option trader in a full - feedback model ( any trade will impact the prices of the underlyings ) .",
    "spread option is a simple example of multi - assets derivative , whose payoff is the difference between the prices of two or more assets ; for instance let the prices of two underlying assets at time @xmath2 $ ] be @xmath3 and @xmath4 , then the payoff function of an european spread option with maturity @xmath5 is @xmath6^+$ ] ( here @xmath7 is the strike of the option and the function @xmath8 is defined as @xmath9 ) .",
    "therefore the holder of an european spread option has the right but not the obligation to buy the spread @xmath10 at the prespecified price @xmath7 and maturity @xmath5 . in general , there is no any analytical formula for the price of multi - assets options ( even in models with perfect liquidity ) .",
    "the only exception is margrabe formula for exchange options ( spread options with a strike of zero)@xcite .",
    "margrabe derived a black and scholes type solution for this class of options as follows @xmath11 where @xmath12 is the standard normal cumulative distribution function and @xmath13 since that a linear combination of correlated lognormals is not lognormal , for non - zero strikes , there is no closed form spread option valuation formula under the multivariate lognormal model .",
    "people rely on approximation formulas and numerical methods for spreads valuation .",
    "kirk@xcite suggested the following analytical approximation for a spread option with payoff @xmath14 @xmath15 where @xmath16 this formula provides a good approximation of spread option prices when the strike @xmath7 is not far from zero .",
    "all these works on spread options assume a model with perfect liquidity .",
    "several spread options are traded in the markets .",
    "some popular spread option products are : fixed income spread options and commodity spread options ( including crush spread options , crack spread options , spark spread options ) . in this work , we will focus our interest on oil markets and more specifically one of the most frequently quoted spread options which are crack spreads .",
    "a crack spread represents the differential between the price of crude oil and petroleum products ( gasoline or heating oil ) .",
    "the underlying indexes comprise futures prices of crude oil , heating oil and unleaded gasoline .",
    "details of crack spread options can be found in the new york mercantile exchange ( nymex ) crack spread handbook @xcite . in the oil markets with finite liquidity , trading does affect the underlying assets price . in our study",
    ", we are going to investigate the effects of impact price on spread option pricing in oil markets , when trading affects only the crude oil price and not petroleum products .",
    "this paper is organized as follows : section[section2 ] discusses the general framework . in section[section3 ] we apply an asymptotic expansion for the full nonlinear partial differential equation which characterizes the spread option price . in section[section4 ] , we propose a numerical method for the linearized equation .",
    "( the peaceman and rachford numerical scheme @xcite is employed ) .",
    "we discuss the stability and convergence of this scheme . in section[section5 ] , we carry out several numerical experiments and provide a numerical analysis of the model for european spread calls .",
    "section[section6 ] contains the concluding remarks .",
    "in this section we describe the setup used for pricing spread options .",
    "our model of a financial market , based on a filtered probability space @xmath17},\\mathbf{p } ) $ ] that satisfies the usual conditions , consists of two assets .",
    "their prices are modeled by a two  dimensional diffusion process @xmath18 .",
    "all the stochastic processes in this work are assumed to be @xmath19-adapted .",
    "their dynamics are given by the following stochastic differential equations , in which @xmath20 is defined a two  dimensional standard correlated brownian motion with correlation @xmath21 , and @xmath22}$ ] being its natural filtration augment by all @xmath23-null sets : @xmath24 here @xmath25 and @xmath26 are the expected return and the volatility of stock @xmath27 in the absence of price impact .",
    "it is possible to add a forcing term , @xmath28i.e .",
    "[ 2 - 1 ]    ds_1(t)&=_1(t , s_1(t))s_1(t ) dt+_1(t , s_1(t))s_(t)dw_1(t)+(t , s_1)d_1(t ) , + ds_2(t)&=_2(t , s_2(t ) ) s_2(t)dt+_2(t , s_2(t))s_2(t)dw_2(t ) ,    ( @xmath29 is the price impact function on the first stock ) .",
    "the term @xmath30 represents the price impact of the trading strategy @xmath31 we note that the classical black - scholes model is a special case of this model with @xmath32 .",
    "our aim is to price a spread option in this illiquid market model .",
    "the option s payoff at maturity @xmath5 ( a call at this case ) is :    [ 2 - 2 ] h(s_1(t),s_2(t))=(s_1(t)-s_2(t)-k)^+ ,    where @xmath7 is the strike price . the well - known generalized black - scholes equation ( more details @xcite )",
    "is used to characterize the spread option price within our full - feedback model for @xmath33 this leads to the nonlinear pde @xmath34 with the terminal condition in @xmath5 .",
    "notice that the classical black - scholes model for spread option is a special case of this model with @xmath35 .",
    "in this section we use a matched asymptotic expansion technique to linearize ( [ 2 - 3 ] ) . for this purpose we let @xmath36 so that ( [ 2 - 3 ] ) becomes    [ 5 - 0 ]    & + ( _ 1 ^ 2s_1 ^ 2+()^2_2 ^ 2s_2 ^ 2()^2 + 2_1_2s_1s_2 ) + & + _ 2 ^ 2s_2 ^ 2+(_1_2s_1s_2 + _ 2 ^ 2s_2 ^ 2 ) + r(s_1+s_2)-rv=0 .    by replacing @xmath37 in the equation ( [ 5 - 0 ] ) with    [ 5 - 2 ] v(t , s_1,s_2)~v^0(t , s_1,s_2)+v^1(t , s_1,s_2)+o(^2 )",
    ",    we get    [ 5 - 3 ]    & + ( _ 1 ^ 2s_1 ^ 2+()^2_2 ^ 2s_2 ^ 2()^2 + & + 2_1_2s_1s_2 ) + ( _ 1_2s_1s_2 + _ 2 ^ 2s_2 ^ 2 ) + & + _ 2 ^ 2s_2 ^ 2+r(s_1+s_2)-r ( v^0+v^1)+o(^2)=0 .",
    "using maclaurin series expansion on some terms of above equation , we have :    [ 5 - 4 ]    & = + + o(^2 ) + & = 1++o(^2 )",
    ".    therefore we get the following linear equation for @xmath38    [ 5 - 5 ]    & + + + _ 1_2s_1s_2+r[s_1+s_2]-rv^0= 0 , + & v^0(t , s_1,s_2)=h(s_1,s_2 ) ,   0<s_1,s_2 < ,",
    "in this section , we present a numerical method for solving the partial differential equations :    [ 6 - 0 ]    & + + + _ 1_2xy + r[s_1+s_2]-rv^0= 0 , + & v^0(t , x , y)=h(x , y ) ,   0<x , y < ,      @xmath87    where a discrepancy of order @xmath75 may be allowed with reference to a similar term in ( [ 6 - 9 ] ) . one of the possible choices for @xmath85 and @xmath86 is @xmath88 finally , the peaceman - rachford scheme for @xmath89 in ( [ 6 - 0 ] ) is obtain as follows @xmath90 in a first step we calculate @xmath84 using @xmath91 .",
    "this step is implicit in direction @xmath92 . in a second step , defined by equations ( [ 6 - 14 ] )",
    ", we use @xmath84 to calculate @xmath93 .",
    "this step is implicit in the direction of @xmath94 .",
    "the peaceman - rachford scheme for @xmath95 in ( [ 6 - 1 ] ) is obtained as follows : @xmath96 where auxiliary function @xmath97 links above equations . to align ( [ 6 - 15 ] ) with ( [ 6 - 10 ] )",
    "we require that @xmath98 one of the possible choices for @xmath85 and @xmath86 is @xmath99 the peaceman - rachford scheme for @xmath95 of ( [ 6 - 1 ] ) is obtained as follows : @xmath100 in a first step calculate @xmath97 using @xmath101 .",
    "this step is implicit in direction @xmath92 . in ta second step , defined by equations ( [ 6 - 18 ] )",
    ", we use @xmath97 to calculate @xmath102 .",
    "this step is implicit in the direction of @xmath94 .",
    "+ notice that due to the use of centered approximations of the derivatives , at @xmath103 , @xmath104 and @xmath105 , there appear external fictitious nodes @xmath106 , @xmath107 , @xmath108 and @xmath109 . the approximations in these nodes are obtained by using linear interpolation .",
    "thus we have the following relations @xmath110 similarly , we can write the same relations in terms of @xmath102 . now all values @xmath111 and @xmath112 are available . by repeating this procedure for @xmath113",
    "we obtain @xmath114 and @xmath115at all time points . the price of a spread option at time @xmath116 can be approximated as : @xmath117      in this section , we discuss stability and convergence of the numerical schemes introduced in section 4.1 .",
    "first we analyze the stability of the peaceman - rachford . in this case , we can use the von neumann analysis to establish the conditions for stability .",
    "this approach was described in @xcite(chapter 2.2 ) .",
    "the von neumann analysis is based on calculating the amplification factor of a scheme ( @xmath118 ) , and deriving conditions under which @xmath119 .",
    "a one - step finite difference scheme ( with constant coefficients ) is stable in a stability region @xmath120(any bounded nonempty region of the first octant of @xmath121 that has the origin as an accumulation point ) if and only if there is a constant @xmath122 ( independent of @xmath123 , @xmath124 , @xmath125 , @xmath126 and @xmath127 ) such that @xmath128 here @xmath129 is amplification factor of scheme with @xmath130 . if @xmath131 is independent of @xmath126 , @xmath127 and @xmath125 , the above stability condition can be replaced with the restricted stability condition latexmath:[\\[\\label{8 - 1 }     see @xcite .",
    "this theorem shows that to determine the stability of a finite difference scheme with the constant coefficient , we only need to consider the amplification factor @xmath118",
    ". this theorem does not apply directly to problems with variable coefficients .",
    "nonetheless , the stability conditions obtained for constant coefficient schemes can be used to give stability conditions for the same scheme applied to equations with variable coefficients .",
    "the general procedure is that one considers each of the frozen coefficient problems arising from the scheme .",
    "the frozen coefficient problems are the constant coefficient problems obtained by fixing the coefficients at their values attained at each point in the domain of the computation . if each frozen coefficient problem is stable , then the variable coefficient problem is also stable .",
    "the interest reader can see the proof of this result in @xcite .    for finding the amplification factor",
    ", a simpler and equivalent procedure is to replace @xmath133 and @xmath134 in the scheme by @xmath135 for each value of @xmath136 and @xmath137 .",
    "then , the resulting equation can be solved for the amplification factor .",
    "+ replacing @xmath138 and @xmath133 by @xmath139 and @xmath135 respectively , one gets @xmath140 here @xmath141 also , by replacing @xmath142 and @xmath134 by @xmath139 and @xmath135 respectively , we have that @xmath143 according to `` duhamel s principle '' we ignore the @xmath144 and @xmath145 terms in stability analysis ( more details @xcite )",
    ". we obtain the amplification factor @xmath146 where @xmath147 by arranging , one gets @xmath148[1-a_2sin^2\\frac{1}{2}\\phi -c_1-c_2sin\\theta sin\\phi + ( b_2 sin\\phi)i]}{[1+a_1sin^2\\frac{1}{2}\\theta -(b_1sin\\theta)i][1+a_2sin^2\\frac{1}{2}\\phi + c_1 -(b_2sin\\phi)i]}.\\ ] ] thus @xmath149 ) , we can write @xmath150 , @xmath151where @xmath152 and @xmath153 are constants .",
    "moreover @xmath154 so @xmath155 as @xmath156 , and @xmath157 , @xmath158",
    ". therefore by replacing in ( [ 8 - 8 ] ) , one gets @xmath159[(1-a_2sin^2\\frac{1}{2}\\phi",
    "-c_1-c_2sin\\theta sin\\phi)^2 + b_2 ^ 2 sin^2\\phi]}{[(1+a_1sin^2\\frac{1}{2}\\theta)^2 + b_1 ^ 2sin^2\\theta][(1+a_2sin^2\\frac{1}{2}\\phi + c_1)^2 + b_2 ^ 2sin^2\\phi]}\\\\ & = \\dfrac{(1-a_1sin^2\\frac{1}{2}\\theta -\\widehat{c } a_1 sin\\theta",
    "sin\\phi ) ^2(1-ca_1sin^2\\frac{1}{2}\\phi -\\widehat{c } a_1sin\\theta sin\\phi)^2}{(1+a_1sin^2\\frac{1}{2}\\theta)^2(1+ca_1sin^2\\frac{1}{2}\\phi ) ^2 } . \\end{split}\\ ] ] it is enough to find conditions so that @xmath160 notice that @xmath161\\\\ & \\leq a_1[1 + 2\\widehat{c } ] .",
    "\\end{split}\\ ] ] thus @xmath162 , provided that @xmath163\\leq 1 $ ] . and",
    "also we have @xmath164 .",
    "\\end{split}\\ ] ] then @xmath165 , provided that @xmath166\\leq 1 $ ] .",
    "therefore we should find conditions so that @xmath167 or equivalently @xmath168 since @xmath169 , then for any @xmath170 , @xmath171 , and by @xmath172 , we have that @xmath173 thus ( [ 8 - 13 ] ) is satisfied if @xmath174 and @xmath175 if @xmath176 since @xmath59 and @xmath177 a sufficient condition for stability of the scheme is @xmath178 thus , the peaceman - rachford scheme is stable if the number of steps in the time interval , @xmath179 , and in the spatial domain , @xmath180 , satisfy inequality ( [ 8 - 17 ] ) .",
    "this condition is a consequence of the cross - derivative terms . in the absence of these terms",
    ", the scheme would be unconditionally stable .",
    "the remaining issue we need to address is the convergence of the numerical method to the true value of the problem . according to @xcite ,",
    "this scheme is first - order accurate in time and space and due to stability the scheme is convergent .",
    "results of this convergence are summarized in the next section .",
    "let us fix the values of the parameters of the marginal dynamical equations according to table[table1 ] .",
    "we also assume the following form for price impact @xmath181 where @xmath182 is a constant price impact coefficient , @xmath183 is time to expiry , @xmath86 is a decay coefficient , @xmath184 and @xmath185 represent respectively , the lower and upper limit of the stock price within which there is a impact price .",
    "+ we consider @xmath186 and @xmath187 for the subsequent numerical analysis . choosing a different value",
    "for @xmath188 and @xmath185 will change the magnitude of the subsequent results , however , the main qualitative results remain valid .    .",
    "[ cols=\"^,^,^,^,^\",options=\"header \" , ]     * replicating cost . *",
    "next investigate the effects of the price impact ( full feedback model ) on the replication cost of spread option .",
    "we investigate the excess price which is the difference between the call price in the full feedback model and the corresponding black - scholes price .",
    "these figures indicate that the spread option price in the full feedback model is higher than the classical spread option price .",
    "as the option becomes more and more in the money and out of the money , the excess price converges monotonically to zero .",
    "in this work , we have investigated a model which incorporates illiquidity of the underlying asset into the classical multi - asset black - scholes - merton framework .",
    "we considered the full feedback model in which the hedger is assumed to be aware of the feedback effect and so would change the hedging strategy accordingly .",
    "since there is no analytical formula for the price of an option within this model , we applied the matched asymptotic expansions technique to linearize the partial differential equation characterizing the price .",
    "we applied a standard alternating direction implicit method ( peaceman - rachford scheme ) to solve the corresponding linear equations numerically .",
    "we also discussed the stability and the convergence of the numerical scheme . by running a numerical experiment , we investigated the effects of liquidity on the spread option pricing in the full feedback model .",
    "finally , we found out that the spread option price in the market with finite liquidity ( full feedback model ) , is more than the spread option price in the classical black - scholes - merton framework .    a black . f and scholes .",
    "m , the pricing of options and corporate liabilities j. political economy 81 ( 1973 ) , pp 637 - 654 .",
    "frey , perfect option replication for a large trader , finance stoch . , 2 ( 1998 ) ,",
    "115 - 142 .",
    "j. schonbucher and p. wilmott , the feedback effect of hedging in illiquid markets , siam j. appl .",
    "math . , 61(2000 ) , pp .",
    "232 - 272 .",
    "liu and j. yong ( 2005 ) , option pricing with an illiquid underlying asset market , j. econom .",
    "control , 29 , pp .",
    "2125 - 2156 .",
    "kristoffer j. glover , peter w. duck , david p. newton . on nonlinear models of markets with finite liquidity : some cautionary notes .",
    "siam journal on applied mathematics 70:8,(2010 ) , 3252 - 3271 .",
    "w , the value of an option to exchange one asset for another , j. finance 33 ( 1978 ) pp 177 - 86 . kirk .",
    "e , correlation in the energy markets , managing energy price risk 1st edn ( risk publications ) 1995 , pp 71 - 8 .",
    "new york mercantile exchange , `` crack spread handbook . '' + partners.futuresource.com/marketcenter/pdfs/crack.pdf , 2011 .",
    "strikwerda , j. c. finite difference schemes and partial differential equations , chapman @xmath189 hall , 1989 .",
    "duffy , d. j , finite difference methods in financial engineering , wiley finance 2006 .",
    "peaceman , d. w. and h. h. rachford , the numerical solution of parabolic and elliptic differential equations , journal of the society for industrial and applied mathematics , vol .",
    "3 , no . 1 , 1955 , 28 - 41 .",
    "duffie , dynamic asset pricing theory , 2nd ed . , princeton university press , princeton , nj .",
    "lax , p.d . , and l. nirenberg , on stability of difference schemes ; a sharp form of gdrding s inequality , cornm .",
    "pure appl .",
    ", 19 ( 1966 ) , pp .",
    "473 - 492 .",
    "wade , b. a. , stability and sharp convergence estimates for symmetrizable difference operators , ph.d .",
    "thesis , university of wisconsin - madison , 1987 ."
  ],
  "abstract_text": [
    "<S> this paper performs the numerical analysis and the computation of a spread option in a market with imperfect liquidity . </S>",
    "<S> the number of shares traded in the stock market has a direct impact on the stock s price . </S>",
    "<S> thus , we consider a _ full - feedback model _ in which price impact is fully incorporated into the model . </S>",
    "<S> the price of a spread option is characterize by a nonlinear partial differential equation . </S>",
    "<S> this is reduced to linear equations by asymptotic expansions . </S>",
    "<S> the peaceman - rachford scheme as an alternating direction implicit method is employed to solve the linear equations numerically . </S>",
    "<S> we discuss the stability and the convergence of the numerical scheme . </S>",
    "<S> illustrative examples are included to demonstrate the validity and applicability of the presented method . </S>",
    "<S> finally we provide a numerical analysis of the illiquidity effect in replicating an european spread option ; compared to the black - scholes case , a trader generally buys more stock to replicate this option .    _ </S>",
    "<S> @xmath0 faculty of mathematics , statistics and computer science , semnan university , tehran , iran . </S>",
    "<S> _    _ @xmath1 department of mathematics and statistics , mcmaster university , hamilton , canada . </S>",
    "<S> _    * keywords : * spread option pricing , price impact , illiquid markets , nonlinear finance , asymptotic analysis , peaceman - rachford scheme . </S>"
  ]
}