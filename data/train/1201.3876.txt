{
  "article_text": [
    "in hierarchical clustering models , to estimate cluster abundances at any given time one must estimate the abundance of sufficiently overdense regions in the initial conditions ( press & schechter 1974 ) .",
    "the problem is to find those regions in the initial conditions that are sufficiently overdense on a given smoothing scale , but not on a larger scale .",
    "the framework for not double - counting smaller overdense regions that are embedded in larger ones is known as the excursion set approach ( epstein 1983 ; bond et al .",
    "1991 ; lacey & cole 1993 ; sheth 1998 ) .    in this approach , one looks at the overdensity around any given random point in space as a function of smoothing scale .",
    "the resulting curve resembles a random walk , whose height tends to zero on very large smoothing scales . in this overdensity versus scale plane ,",
    "the critical density for collapse defines another curve , which we will call the barrier .",
    "the double - counting problem is solved by asking for the largest smoothing scale on which the walk first crosses the barrier .",
    "it is fairly straightforward to solve this problem numerically , by direct monte - carlo simulation of the path integrals ( bond et al .",
    "this is particularly simple if the steps in the walk are independent , but one can also include correlations between the steps , whose nature depends on the underlying fluctuation field ( i.e. , for a gaussian field , on the power spectrum ) and the form of the smoothing filter .    when the steps are independent , exact solutions for constant ( bond et al .",
    "1991 ) or linear ( sheth 1998 ) barriers are known .",
    "exact solutions for more general barrier shapes are not known , but good analytic approximations are available ( sheth & tormen 2002 ; lam & sheth 2009 ) . in the appropriate units ,",
    "these solutions are self - similar , i.e.  independent of the form of the power spectrum ( of course , they depend strongly on the barrier shape ) . however , an exact solution of the first crossing problem for correlated steps is still unknown .",
    "the main goal of the present work is to provide a simple formula which works for a wide variety of barrier shapes , smoothing filters , and power spectra .",
    "this is done in section  [ main ]  our main result is equation  ( [ sfs ] ) , and it is explicitly not self - similar . section  [ extend ] describes a number of extensions of this calculation  having to do with walks conditioned to pass through a certain point in a certain way , or with barriers whose height depends on hidden variables .",
    "a final section summarizes our results , indicating how we expect our work to be used when fitting to the halo abundances which , recent simulations indicate , are not quite self - similar .",
    "in what follows , we will assume that the underlying fluctuation field is gaussian .",
    "we comment on non - gaussian field in the discussion section . in hierarchical models ,",
    "the variance of the fluctuation field is a monotonic function of the smoothing scale ( the exact relation depending on the shape of the power spectrum and the smoothing window . )",
    "therefore we can use the terms smoothing scale and variance interchangeably , and we will use @xmath0 to denote the variance .    let @xmath1 denote the height of the barrier on ` scale ' @xmath0 , and @xmath2 the probability that the walk has height @xmath3 on this scale .",
    "we will assume that @xmath4 , so that @xmath5 .",
    "we would like to write down the probability @xmath6 that @xmath7 for all @xmath8 and @xmath9 at @xmath0 .",
    "when the steps in the walk are uncorrelated the two conditions separate , simplifying the analysis . for correlated steps , this simplicity is lost .",
    "recently paranjape et al .",
    "( 2012 ) have argued that there is considerable virtue in thinking of the limiting case in which the steps in the walk are completely correlated . in this case , if the walk had height @xmath10 on scale @xmath11 , then it has height @xmath12 on scale @xmath0 , so @xmath3 is a smooth monotonic function of @xmath0 .",
    "therefore , if @xmath3 first exceeds @xmath1 on scale @xmath0 , it was certainly below @xmath1 on all @xmath8 , and one need not account for this requirement explicitly .",
    "hence , the first crossing distribution is just @xmath13 where @xmath14 is the scale on which @xmath15 is minimum ( in many cases of interest @xmath16 ) .",
    "note that this relates the shape of @xmath6 to that of @xmath2 on the same scale .",
    "paranjape et al .",
    "( 2012 ) show that , despite the strong assumption about the deterministic smoothness of the walks , this expression provides a very good description of the first crossing distribution ( at small @xmath0 ) even when the steps are not completely correlated .",
    "physically , this is because if one thinks of real walks as stochastic zig - zags superimposed on smooth completely correlated trajectories , at small @xmath0 a walk has not fluctuated enough to depart significantly from its deterministic counterpart .",
    "one might thus expect that there is danger of double counting trajectories with two or more crossings only when @xmath0 becomes large .",
    "in cosmology the large @xmath0 regime is not nearly as interesting as the small .",
    "the discussion above suggests that it will be useful to construct an expansion in terms of the number of times walks cross the barrier .",
    "the first step in this program is to assume that no walks double - cross , but the actual correlation structure scatters their crossing scale around the completely correlated prediction .",
    "accounting for this fact alone should allow to estimate @xmath6 with a greater regime of accuracy than equation  .",
    "accounting for one earlier crossing should be even more accurate , and so on .      to proceed",
    ", we assume that when steps are strongly correlated one can replace the requirement that @xmath17 for all @xmath8 , which is a condition on all the steps in the walk prior to @xmath0 , with the milder requirement that @xmath18 for @xmath19  a condition on the one preceding step . because now the walk values on the two scales are independent , the analysis is more involved than when the steps were completely correlated , but the increase in complexity is relatively minor because we only require a bivariate distribution .    for small @xmath20 we can expand both @xmath3 and @xmath21 in a taylor series .",
    "the condition on the walk height at the previous step means that @xmath22 .",
    "if we use primes to denote derivatives with respect to @xmath0 , then the first crossing distribution of interest is given by the fraction of walks which have @xmath23 that is to say , @xmath24    for a gaussian field @xmath25 is gaussian , and the conditional distribution in the integral is also gaussian , with shifted mean and reduced variance . if we define @xmath26 the mean of @xmath27 is @xmath28 and the variance is @xmath29 .",
    "( our notation was set by the fact that , for gaussian smoothing filters , @xmath30 equals the quantity spectral quantity @xmath31 which bardeen et al .",
    "1986 called @xmath30 . for tophat filters ,",
    "the integrals over the power spectrum which define our @xmath30 are given by paranjape et al .",
    "note that @xmath32 , and thus @xmath33 .    before we evaluate the integral , note that the completely correlated approximation corresponds to the limit",
    "in which @xmath34 and @xmath27 becomes a delta function centered on @xmath35 .",
    "the integral then yields @xmath36 , and the resulting expression is consistent with equation  .",
    "notice that our analysis has indeed extended the completely correlated solution by replacing the delta function with a gaussian whose width depends explicitly on the underlying power spectrum .",
    "in the generic case , one still has an integral over a single gaussian distribution .",
    "if we define @xmath37 ( the reason for our choice of sign for @xmath38 will become clear later ) , then equation   gives @xmath39 evaluating the integral yields @xmath40 \\label{sfs}\\ ] ] ( recall @xmath38 depends on @xmath0 ) ; this is our main result .",
    "comparison with equation  ( [ fcc ] ) shows that the term in square brackets above represents the correction to the completely correlated solution .",
    "there are two points to be made here .",
    "first , this correction term depends on @xmath41 , indicating that the shape of the first crossing distribution depends explicitly on the form of the underlying power spectrum . in this respect",
    ", walks with correlated steps are fundamentally different from walks with uncorrelated steps .",
    "second , when @xmath42 then this term tends to unity so the first crossing distribution reduces to that for completely correlated walks . to see what large @xmath38 implies , it is useful to consider some special cases .",
    "on which walks first cross the barrier @xmath43 .",
    "histograms show numerical monte carlo results for gaussian smoothing of @xmath44 , for which @xmath45 ; top to bottom are for barriers with @xmath46 and @xmath47 .",
    "for comparison , the two dotted curves show the corresponding distributions for @xmath48 and @xmath49 when steps are uncorrelated .",
    "smooth curves show eq .",
    "( [ sfs ] ) with @xmath50 and the appropriate values of @xmath51 ; the agreement indicates that our formula works well for a wide variety of barrier shapes .",
    "symbols with error bars show results for a constant barrier ( @xmath48 ) and tophat smoothing of a @xmath52cdm @xmath53 .",
    "this shows that , in contrast to when steps are uncorrelated , the first crossing distribution does indeed depend ( weakly ) on @xmath53 .",
    "the solid curve shows eq .",
    "( [ sfsconstant ] ) with @xmath54 for which @xmath55 ; the agreement shows that our formula works well for a wide range of @xmath41 . ]      for a constant barrier , @xmath56 and @xmath57 .",
    "the latter is conventionally denoted as @xmath58 , so that @xmath42 corresponds to large @xmath58 . in terms of @xmath58 , equation   is @xmath59 . \\label{sfsconstant}\\ ] ] in this form , it is clear that @xmath60 acts as the @xmath58-scale below which the correction to the completely correlated distribution becomes important .",
    "( note however that our @xmath41 is not the same parameter defined by peacock & heavens 1990 and used in paranjape et al .",
    "2012 . )    figure  [ comparemc ] compares this formula to distributions generated via monte - carlo simulation of the walks ( following bond et al .",
    "we present results for two rather different power spectra and smoothing filters , with two different values of @xmath41 .",
    "our first choice is gaussian smoothing of @xmath61 with @xmath62 , for which @xmath63 .",
    "our second is tophat smoothing of a @xmath52cdm power spectrum ; in this case @xmath30 itself depends on scale , with @xmath64 ( and hence @xmath65 ) on the scales where @xmath66 .",
    "the figure shows that equation  ( [ sfsconstant ] ) , with @xmath45 and @xmath67 respectively , provides an excellent approximation to the monte - carlo distributions .",
    "note in particular that , for @xmath52cdm , ignoring the scale dependence of @xmath41 ( by simply using @xmath67 on all scales ) works very well .",
    "this demonstrates that eq .",
    "( [ sfsconstant ] ) is a simple and accurate approximation for the cdm family of models .      for linear barriers @xmath68 , making @xmath69 and @xmath70 .",
    "figure  [ comparemc ] shows results for @xmath71 and @xmath72 , both for gaussian smoothing of @xmath44 ; equation  ( [ sfs ] ) with @xmath45 works very well .",
    "note in particular that our formula is quite different from the inverse gaussian distribution associated with uncorrelated steps .",
    "the analysis above has been so simple , and its results so accurate , that it is interesting and natural to extend it to a variety of other problems , some of which we outline below .",
    "the excursion set approach is often used to quantify the correlation between halo abundances and their environment .",
    "this is done by computing the ratio of @xmath73 , the first crossing distribution subject to the additional constraint that the walks passed through some @xmath10 on some large scale @xmath11 before first crossing @xmath74 on scale @xmath75 , to @xmath6 .",
    "motivated by the previous section , we now set @xmath76 in the limit where @xmath19",
    ". this will give @xmath77 which is very similar to equation  , only with modified mean values and variances .",
    "the gaussian outside the integral has mean @xmath78 and variance @xmath79 , where @xmath80 .",
    "the one inside has mean @xmath81 , where @xmath82/s$ ] and @xmath83/s_0 $ ] .",
    "the first gaussian obeys the scaling assumed by paranjape et al .",
    "( 2012 ) , who showed it was a good approximation to their conditional monte carlo distributions . therefore , it is interesting to see if this scaling also holds for the integral .    if @xmath84 ( or , more carefully stated , if the term containing this quantity is smaller than the other ) then @xmath85 and @xmath86 , so @xmath87 .",
    "since this is the same rescaling of @xmath21 as for the first gaussian , in this approximation @xmath73 follows the scaling with @xmath10 that was assumed by paranjape et al .",
    "therefore , the conclusions of paranjape & sheth ( 2012 ) about the difference between real and fourier space bias factors also hold for our calculation .",
    "in particular , the fourier space bias @xmath88 will be simply given by differentiating @xmath89 with respect to @xmath90 , whereas the real space cross correlation will carry an additional factor of @xmath91 .",
    "for a constant barrier @xmath92 yields @xmath93^{-1}. \\label{bias1}\\ ] ] the first term on the right hand side is the bias associated with completely correlated walks .",
    "the correction term is negligible for @xmath94 , and it tends to @xmath95 when @xmath96 .",
    "the expression above assumes that @xmath97 is negligible .",
    "this is reasonable when @xmath98 ; e.g. for gaussian smoothing filters , @xmath99 falls to zero faster than @xmath100 .",
    "but at intermediate scales it is not , and @xmath73 will have additional dependence on @xmath10 . in musso , paranjape & sheth ( 2012 ) we show that this will generically introduce scale dependence into the fourier space bias factors , even at the linear level .",
    "the excursion set theory can also be used to compute halo progenitor mass functions and merger rates ( lacey & cole 1993 ) . for this , we need the joint distribution @xmath101 of walks that first cross the barrier @xmath21 on scale @xmath102 , and first cross the barrier @xmath103 on scale @xmath104 . dividing by @xmath105 , which we already have , will give the conditional distribution @xmath106 . the most natural way to estimate",
    "it is to set @xmath107 ( strictly speaking , we should adjust the limits on the integrals over @xmath108 to ensure that @xmath109 . )",
    "we have written the final expression in a suggestive form , to show that the left hand side should be thought of as a weighted average over first crossing distributions , each with its own value of @xmath110 .    in the limit where the scales are very different , @xmath111",
    ", it should be a good approximation to ignore the @xmath112 , @xmath113 and @xmath114 correlations .",
    "this makes @xmath115 where @xmath116 is the same quantity as @xmath30 , but on scale @xmath102 .",
    "this means there is some dependence on @xmath110 .",
    "note that if there were no correlation with @xmath110 ( in effect @xmath117 ) then the conditional distribution would have the same form as the unconditional one , except that @xmath118 , and @xmath119 , where we have defined @xmath120 .",
    "this is similar to the rescaling for sharp-@xmath121 filtering , for which @xmath122 .",
    "however , for gaussian smoothing of a power law @xmath53 , @xmath123 , so one may not set @xmath117 if one does not also set @xmath124 .",
    "therefore , the case with @xmath125 may be more relevant . in this case @xmath126 . since this same term appears in the exponential of @xmath127 , we have that @xmath128 has the same form as equation  , except for the shift @xmath129 .",
    "therefore , except for the erf piece , the final integral over @xmath110 can also be done analytically .",
    "we leave a comparison of this approximation , and the full expression ( in which we have not ignored @xmath113 etc . ) , with the numerical monte - carloed distributions , to future work .    that @xmath128 depends explicitly on @xmath110 , even in this approximation , is significant , since it shows that the conditional distribution for first crossing @xmath130 depends not just on the fact that @xmath21 was crossed , but on how @xmath21 was crossed .",
    "if we interpret ` how @xmath21 was crossed ' as a statement about the mass distribution on smoothing scales larger than @xmath102 , then the fact that @xmath128 depends on @xmath110 indicates that the formation history of the mass within @xmath102 depends on the surrounding environment .",
    "this shows that our formalism will naturally give rise to ` assembly bias ' effects of the sort identified by sheth & tormen ( 2004 ) , and studied since by many others .      in triaxial collapse models ,",
    "the barrier is a function of the values of the initial deformation tensor ( rather than just its trace ) .",
    "this makes @xmath131 where @xmath132 .",
    "if the scale dependence of @xmath133 and @xmath134 can be neglected , then this will simplify to @xmath135 further , if the correlation between @xmath136 and @xmath133 and @xmath134 can be neglected , then @xmath137 and the first crossing distribution is that for @xmath138 , weighted by the probability of having @xmath133 and @xmath134 . if we use equation  ( a3 ) of sheth et al .",
    "( 2001 ) for the distribution of @xmath133 and @xmath134 given @xmath3 , then our analysis should be thought of as generalizing their equation  ( 9 ) . in particular , because the result is a weighted sum of first crossing distributions , it exhibits exactly the sort of stochasticity discussed in appendix c of paranjape et al .",
    "( 2011 ) . performing this calculation",
    "more carefully is the subject of ongoing work .",
    "one of the great virtues of our approach is that it provides a simple way to compare the excursion set description with that for peaks .",
    "the relation is particularly simple for gaussian smoothing filters , since then @xmath30 of our equation   is the _ same _ parameter which plays an important role in peaks theory .",
    "this correspondence means that our parameter @xmath139 is essentially the same as the peak curvature parameter ; the only difference is that we define the derivative with respect to the variance @xmath0 , whereas peaks theory derivatives are with respect to smoothing scale @xmath140 .",
    "this means that our integrals over @xmath136 are really just integrals over curvature , which makes intuitive sense .",
    "hence , to implement our prescription for peaks , we only need to account for the fact that the distribution of curvatures around a peak position differs from that around random positions .",
    "if we write our equation   as @xmath141 times @xmath142 , then we need only replace @xmath143 , where @xmath144 is given by equation  ( a15 ) of bardeen et al .",
    "( 1986 ) .    for a constant barrier",
    ", our @xmath145 equals their @xmath146 , so our expression is simply their equation  ( a14 ) weighted by @xmath147 and integrated over @xmath139 .",
    "( their additional factor of @xmath148 is just the usual @xmath149 factor in excursion set theory , which converts from mass fractions to halo abundances . )",
    "omitting the @xmath147 factor when performing the integral over @xmath139 yields the usual expression for peaks ( their equation  a18 ) .",
    "therefore , one might think of their  ( a18 ) as representing the ` completely correlated limit ' for peaks , whereas our analysis yields what should be thought of as the moving barrier excursion set model for peaks .",
    "we presented a formula , equation  , which provides an excellent description ( see fig .",
    "[ comparemc ] ) of the first crossing distribution of a large variety of barriers , by walks exhibiting a large range of correlations ( i.e. , it is valid for a wide class of power spectra and smoothing filters ) . as we discuss below",
    ", we expect a special case of it ",
    "equation    to be a good physically motivated fitting formula for halo abundances .",
    "we then showed that our approach provides a simple expression for the first crossing distribution associated with walks conditioned to pass through a certain point , and hence a simple expression for how halo bias factors are modified because of the correction term ( equation  [ bias1 ] ) .",
    "we sketched why a generic feature of this approach is that even the linear bias factor should be scale dependent .",
    "we also showed how to approximate the first crossing distributions associated with two non - intersecting barriers : the probability that a walk first crosses barrier @xmath21 on some scale @xmath102 and then @xmath103 on scale @xmath104 ( equation  [ sfss ] ) .",
    "this exhibit ` assembly bias ' so they may provide useful approximations for halo progenitor mass functions and merger rates .    finally , we argued that our approach makes it particularly easy to see how the first crossing distribution is modified if the barrier depends on hidden parameters , such as those associated with the triaxial collapse model ( section  [ dcep ] ) or peaks ( section  [ peaks ] ) . in our approach , peaks differ from random positions only in that the integral over @xmath139 in equation   is modified . a similar integral in the expression for peak abundances",
    "leads to scale dependent bias even at the linear level ( desjacques et al .",
    "2010 ) , and is why we now expect @xmath121-dependent bias even for random positions .",
    "we are not the first to have considered the correlated steps problem .",
    "peacock & heavens ( 1990 ) identified @xmath41 ( our equation  [ gammas ] ) as the key parameter .",
    "their approximation for @xmath6 is more accurate than more recent approximations ( maggiore & riotto 2010 ; achitouv & corasaniti 2011 ) which are , in any case , restricted to special combinations of power spectra and smoothing filter ( paranjape et al . 2012 ) .",
    "however , our equation   is simpler and more accurate for a wider range of barrier shapes , power spectra and smoothing filters than any of these previous studies , and it can be easily extended .",
    "besides the problems outlined above , an obvious direction would be to include non - gaussianity , along the lines of musso & paranjape ( 2012 ) .",
    "this extension is conceptually straightforward  equations will hold also for a non - gaussian field  and is currently being investigated .",
    "we argued that this accuracy stems from the small @xmath0 behavior of the walks . in this regime , which is of most interest in cosmology , @xmath6 is well - described by equation   for completely correlated walks ( paranjape et al .",
    "these walks are deterministic : the distribution of their heights is a delta function . for real walks , instead",
    ", it has a width that increases with @xmath0 .",
    "equation  ( [ sfs ] ) was obtained by allowing for this broader distribution of heights in the one step prior to the crossing .",
    "however , it does not explicitly account for walks which may have criss - crossed the barrier more than once .",
    "musso et al .",
    "( 2012 ) discuss how accounting for more zigs and zags may yield even greater accuracy at larger @xmath0 .",
    "equation  ( [ sfs ] ) is explicitly the completely correlated first crossing rate times a correction factor .",
    "it depends on power spectrum only because this factor depends on @xmath41 .",
    "since this factor is small at small @xmath0 , in this regime ( which is the usual one in cosmology ) one should expect to see departures from self - similarity , but they should be small .",
    "e.g. , for a barrier of constant height , the first crossing distribution becomes equation  , and the correction factor becomes important at @xmath150 , with @xmath151 for the @xmath52cdm family of @xmath53 .    in cosmology",
    "the first crossing distribution is often used as a fitting formula . for this purpose",
    ", one might treat either @xmath74 or @xmath41 or both as free parameters ( even though equation  [ sfsconstant ] describes the first crossing distribution very well with no free parameters ) . in this case",
    ", the value of @xmath74 will depend on a variety of factors ( sheth et al .",
    "2001 ; maggiore & riotto 2010b ; paranjape et al .",
    "2012 ) , and we expect @xmath41 to depend on the effective slope of the power spectrum . in this sense , our formula provides a simple way to understand , interpret and quantify the departures from self - similarity which simulations are just beginning to show .",
    "it is a pleasure to thank aseem paranjape for helpful comments on the draft .",
    "rks is supported in part by nsf - ast @xmath152 .      99 bardeen j. m. , bond j. r. , kaiser n. , szalay a. s. , 1986 , apj , 304 , 15 bond j.  r. , cole s. , efstathiou g. , kaiser n. , 1991 , apj , 379 , 440 corasaniti p. s. , achitouv i. , 2011 , prl , 106 , 241302 desjacques v. , crocce m. , scoccimarro r. , sheth r. k. , 2010 , prd , 82 , 103529 epstein r.  i. , 1983 , mnras , 205 , 207 lacey c. , cole s. , 1993 , mnras , 262 , 627 lam t.  y. , sheth r.  k. , 2009 , mnras , 398 , 2143 maggiore m. , riotto a. , 2010a , apj , 711 , 907 maggiore m. , riotto a. , 2010b , apj , 717 , 515 musso m. , paranjape a. , arxiv:1108.0565 , mnras , online early paranjape a. , sheth r. k. , 2012 , mnras , 419 , 132 paranjape a. , lam t .- y . , sheth r. k. , mnras , online early peacock j. a. , heavens a. f. , 1990 , mnras , 243 , 133 press w. h. , schechter p. , 1974 ,",
    "apj , 187 , 425 sheth r.  k. , 1998 , mnras , 300 , 1057 sheth r.  k. , mo h.  j. , tormen g. , 2001 , mnras , 323 , 1"
  ],
  "abstract_text": [
    "<S> we provide a simple formula that accurately approximates the first crossing distribution of barriers having a wide variety of shapes , by random walks with a wide range of correlations between steps . </S>",
    "<S> special cases of it are useful for estimating halo abundances , evolution , and bias , as well as the nonlinear counts in cells distribution . </S>",
    "<S> we discuss how it can be extended to allow for the dependence of the barrier on quantities other than overdensity , to construct an excursion set model for peaks , and to show why assembly and scale dependent bias are generic even at the linear level .    </S>",
    "<S> [ firstpage ]    large - scale structure of universe </S>"
  ]
}