{
  "article_text": [
    "in nuclear magnetic resonance ( nmr ) one often encounters a free induction decay ( fid ) signal @xmath8 which takes the form of a sinusoidal function multiplied by a decaying exponential : @xmath9 where @xmath10 is time , @xmath1 is the signal amplitude , @xmath11 is the resonance frequency , @xmath12 is the signal phase , and @xmath2 is the transverse spin relaxation time . in practice ,",
    "parameters , like @xmath3 , @xmath12 , etc .",
    ", can not be determined without error even in the absence of noise , since @xmath8 can not neither be digitized with infinitesimal time intervals nor observed for an infinitely long time .",
    "it is of a general interest to determine these parameters using various types of analysis .",
    "in particular , the determination of the resonance frequency precisely for a digitized fid signal @xmath8 observed over a finite time is crucial for recent experiments@xcite searching for possible new spin dependent interactions which , if present , would cause a tiny shift of the resonance frequency .",
    "+ when @xmath13 , eqn.([eq1 ] ) can be simplified to : @xmath14 in this case , many different algorithms using fast fourier transform(fft ) or digital fourier transform ( dft )  @xcite were developed for frequency and spectra estimation in power systems . for sinusoidal signals , by using @xmath15 , one can obtain @xmath16  @xcite from a linear fit of @xmath17 to @xmath8 , where @xmath17 is derived by finite differentiation of the digitized signal @xmath8 , but extra noise filtering is needed since the second derivative is susceptible to high frequency noise .",
    "+        to determine the frequency precisely and to reduce the noise without filtering , we propose a different approach in this paper based on integration .",
    "we argue that our approach is especially valuable in situations when the shape of the signal in frequency space possesses bias .",
    "the structure of this paper is as follows .",
    "we first describe the basic principle of the method with an example .",
    "we then thoroughly analyze the method and derive its precision .",
    "the effect of noise is discussed in the following section .",
    "possible improvements are discussed in the conclusion .",
    "consider a pure sinusoidal signal @xmath18 observed for a finite time @xmath5 . by multiplying @xmath8 by another sinusoidal function of frequency @xmath19 and integrating over a time interval of length @xmath5",
    ", a function @xmath20 of @xmath19 can be defined as : @xmath21 if the observing time @xmath5 is long enough , @xmath22 will be maximized at @xmath23 .",
    "the frequency determination problem becomes a maximization problem which can be solved by various standard methods , and the remaining problem of the integration with high precision can be addressed using many techniques . for digitized real time signal over an interval @xmath24 ,",
    "the error of the integration using a trapezoidal method is @xmath25 .",
    "an improvement on the integration precision can be achieved by using richardson s extrapolation strategy  @xcite , and the precision of @xmath26 can be obtained by using simpson s method .",
    "higher precision as @xmath27,@xmath28 can be obtained if necessary by applying the same strategy . in  @xcite , @xmath29 and @xmath30 .",
    "the precision would be @xmath31 so that simpson s method is accurate enough for our purposes .",
    "therefore from now on in this paper , we ignore the error caused by numerical integration and assume it is zero .",
    "+      we will next analyze the integration and maximization method for precise frequency determination .",
    "if only the frequency is to be determined , the function of @xmath19 can be defined as follows : @xmath32^{2}+[\\int^{t}_{0}s(t)\\sin{(\\omega t)}dt]^{2}\\}\\ ] ] or , in the complex notation : @xmath33 where @xmath34 is the transverse relaxation time .",
    "a brute force calculation of the above integration gives :    @xmath35 + 4\\exp{(-\\gamma_{2}t)}\\sin{\\frac{(\\omega+\\omega_{0})t}{2}}\\sin{\\frac{(\\omega-\\omega_{0})t}{2}}\\cos{(\\omega_{0}t-2\\phi_{0})}\\}}{[(\\omega+\\omega_{0})^{2}+\\gamma_{2}^{2}][(\\omega-\\omega_{0})^{2}+\\gamma_{2}^{2}]}\\\\\\end{aligned}\\ ] ]    @xmath36 + 4\\exp{(-\\gamma_{2}t)}\\sin{\\frac{(\\omega+\\omega_{0})t}{2}}\\sin{\\frac{(\\omega-\\omega_{0})t}{2}}\\sin{(\\omega_{0}t-2\\phi_{0})}\\}}{[(\\omega+\\omega_{0})^{2}+\\gamma_{2}^{2}][(\\omega-\\omega_{0})^{2}+\\gamma_{2}^{2}]}\\}\\end{aligned}\\ ] ]    if we assume that @xmath16 is large and @xmath2 is not too short then @xmath37 is small and the second term on the right hand side of eqn.([eq7 ] ) contributes the most to @xmath38 .",
    "or if we let @xmath39,@xmath40 and @xmath41 , only the second term survives which yields @xmath42 . in practice",
    "the condition @xmath43 is often satisfied , ( in  @xcite , for example , @xmath11 and @xmath44 , while @xmath34 is not close to @xmath45 , @xmath46 ) . defining @xmath47",
    ", we expand @xmath38 around @xmath48 to second order in @xmath49 and @xmath50 to get @xmath51 where @xmath52 are constants depending on @xmath53 and @xmath5 :    @xmath54\\\\ b=2{t_{2}^{2}}[\\frac{\\cos{2\\phi}(1-e^{-2x})}{\\omega_{0}}+\\frac{te^{-x}\\sin{\\omega_{0}t}\\sin{(\\omega_{0}t-2\\phi)}}{\\omega_{0}}]\\\\ c = t_{2}^{2}(1-e^{-x})^{2}+\\frac{1+e^{-2x}-2e^{-x}\\cos{2\\omega_{0}t}}{4\\omega_{0}^{2}+1/t_{2}^{2}}+\\frac{\\cos{2\\phi}(1-e^{-2x})}{2\\omega_{0}^{2}}-\\frac{\\sin{2\\phi}(1-e^{-2x})}{\\omega_{0}/t_{2 } } \\approx t_{2}^{2}(1-e^{-x})^{2}\\end{aligned}\\ ] ]    obviously if @xmath55 and @xmath56 , @xmath57,@xmath58 is maximized at @xmath59 , i.e. , @xmath23 .",
    "however in practice @xmath60 is usually not @xmath45 and it will cause a small shift of @xmath19 around @xmath16 :    @xmath61    it is easy to show that @xmath55 and @xmath56 which proves @xmath62 is maximized around @xmath63 . substituting @xmath64 and @xmath34 , we have :    @xmath65    @xmath66    using @xmath67 we obtain @xmath68 is plotted in figure 1 . when @xmath69 and @xmath70 the observation time @xmath5 is very short in comparison to @xmath2 and the error for the frequency determination is infinitely large even though @xmath3 is large and @xmath2 is finite .",
    "when @xmath71 exceeds @xmath72 , @xmath73 decreases quickly to its asymptotic value of @xmath72 .",
    "once @xmath2 and @xmath3 are roughly known , the precision of the method can be estimated from @xmath73 .",
    "assuming @xmath5 is large enough , @xmath71 can be assumed infinite and @xmath74 in this case : @xmath75 ) @xmath2 is assumed to be finite .",
    "@xmath2 could be nearly infinite as often encountered in power system applications : in this case by similar reasoning the error for this method is found to be : @xmath76\\approx t^{2}\\end{aligned}\\ ] ]",
    "when noise @xmath77 is included , the function @xmath78 can be defined : @xmath79\\exp{(i\\omega",
    "t)}dt|^{2}%\\leq \\frac{1}{t}|\\int^{t}_{0}s(t)\\exp{(i\\omega t)}dt|+\\frac{1}{t}|\\int^{t}_{0}n(t)\\exp{(i\\omega t)}dt|\\\\ % = \\mathcal{l}_{s}(\\omega)+\\frac{1}{t}|\\int^{t}_{0}n(t)\\exp{(i\\omega t)}dt|\\end{aligned}\\ ] ] for the experiments under consideration the signal to noise ratio ( snr ) of the final signal is usually @xmath80 , thus the second term of eqn.([eq.16 ] ) is much smaller than the first term . how to estimate @xmath81 is the key to solving the noise problem .",
    "according to  @xcite we have : @xmath82 where @xmath83 is the noise variance , @xmath84 is the sampling rate limited bandwidth , and @xmath85 is the measurement bandwidth . as discussed  @xcite for the noise the integration according to eqn.([eq.17 ] ) is equivalent to reducing the bandwidth in the frequency domain to @xmath85 .",
    "this is also the principle of how lock - in amplifiers reduce noise , and it is not a surprise that the same noise reduction principle would also work for the algorithm presented in the previous section .    for a sinusoidal signal , according to ref.@xcite , the cramer - rao lower bound(crlb ) sets the lower limit of the frequency error for any method as : @xmath86 for the damped sinusoidal case , by the standard approach described in  @xcite after some manipulation the crlb bound derived in ref.@xcite can be expressed as : @xmath87        since the method can reduce noise by integration , the estimation of the frequency error is expected to be close to the crlb .",
    "numerical simulations are done to verify this noise reduction characteristic of the method . a signal with known input frequency",
    "is first generated then white gaussian noise(wgn ) is added with a predetermined snr .",
    "the frequency determination method presented is then applied to obtain an output frequency as the approximation of the input . for the same input signal and measurement time",
    ", the same procedure is repeated for many times(1000 for each measurement time ) , and each time independent wgn is added . over many trials the standard deviation of the output frequencies gives the error if the difference between the output mean and input frequency is much smaller .",
    "a small snr(=1 ) is chosen when generating the noise so that the numerical error is negligible compare to the noise induced error , according to eqn.([errd]),([errs]),([crlb_d ] ) and ( [ crlb_s ] ) .",
    "for this small snr , the method works well . for the pure sinusoidal case ,",
    "the result is shown as fig.2 .",
    "the errors obtained from simulations match the crlb very well . for the damped sinusoidal case shown by fig.3 , the errors found by simulation are slightly larger(@xmath88 ) than crlb when x@xmath89 is smaller than 3 , and increases quickly as x increased to 5 .",
    "this is not surprising since the actual snr decreases exponentially as x increases .",
    "we present to our knowledge a previously unrecognized method for frequency determination for fid nmr signals . the method is based on numerical methods of high precision integration and maximum value location .",
    "the same principle works both for sinusoidal and damped sinusoidal signals . for the damped sinusoidal wave ,",
    "the precision is @xmath4 which is limited by @xmath2 and the signal frequency if the observation time is long enough . for a pure sinusoidal wave",
    "the precision is limited by observation time and signal frequency , and it can be expressed as @xmath7 . the precision is one order of magnitude better than a frequency counter which has precision of @xmath90  @xcite .",
    "the proposed algorithm is not hard to realize with digital electronics , thus it is possible to build a more precise frequency counter based on this method .",
    "we expect that this method will be especially useful in situations when the shape of the fourier transformed signal is not well defined . + it is possible to further improve the precision . for the pure sinusoidal case",
    "once the frequency is obtained the phase factor @xmath12 can be obtained by locating the maximum from the following integration :    @xmath91    once the phase and frequency are determined for a pure sinusoidal signal , the frequency shift from the numerical method can be predicted using eqn.([errs ] ) and better precision can be achieved since part of the undesired frequency shift is eliminated .",
    "this precision improvement was verified by computer simulations . for",
    "the damped signal the same strategy could also work except in this case @xmath2 has to be determined precisely by an independent method .",
    "+ when taking into account noise the integration method works as a narrow bandwidth filter around the signal frequency like a lock - in amplifier . for pure sinusoidal signal the estimated error caused by noise",
    "is found to reach the cramer - rao lower bound  @xcite .",
    "for the damped sinusoidal case the estimated error is within factor of 2 of the crlb derived in literature when x(@xmath92 ) is less than 5 .",
    "the method works well for strong white noise case as snr=1 .",
    "this work was supported by the department of energy and by nsf grant phy-1068712 .",
    "w. m. snow , h , yan , k.li , r.khatiwada , and e.smith acknowledge support from the indiana university center for spacetime symmetries and the indiana university collaborative research grant program .",
    "10 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2 w. zheng , h. gao , b. lalremruata , y. zhang , g. laskaris , c.b .",
    "fu , and w.m .",
    "snow , phys .",
    "d * 85 * , 031505(r ) ( 2012 ) .",
    "m. bulatowicz , m .",
    "larsen , j .",
    "mirijanian , t .",
    "g. walker , c.b .",
    "fu , e . smith , w",
    ". m. snow , h.yan , to be published .",
    "h.chu , c.h.fu , h.gao , r.khaiwada , g.laskaris , k.li , e.smith , w.m.snow , h.yan and w.zheng,arxiv:1211.2644 .",
    "j .- z.yang and c .- w.liu , ieee transactions on power delivery , * 16*,361(2001 ) .",
    "v.v.terzija,ieee transactions on instrumentation and measurement , * 52*,1654(200 ) .",
    "y.obukhov,k.c.fong,d.daughton and p.c .",
    "hammel , journal of applied physics,*101*,034315(2007 ) j.dabek , j.o .",
    "nieminen , p.t .",
    "vesanen , r. sepponen , r. j. ilmoniemi , journal of magnetic resonance , * 205 * , 148 ( 2010 ) w.h.press , b.p.flannery , s.a.teukolsky , w.t.vetterling , numerical recipes , cambridge university press , ( 1989 ) c. gemmel , et al the european physical journal d,*57*,303(2010 ) k.g.libbrecht , e.d.black , and c.m.hirta , am . j. phys .",
    "* 71 * , 1208 ( 2003 ) s.m.kay , fundamentals of statistical signal processing : estimation theory , pearson(2011 ) agilent technologies , fundamentals of the electronic counters ."
  ],
  "abstract_text": [
    "<S> we present a high precision frequency determination method for digitized nmr fid signals . </S>",
    "<S> the method employs high precision numerical integration rather than simple summation as in many other techniques . with no independent knowledge of the other parameters of a nmr fid signal ( phase @xmath0 , amplitude @xmath1 , and transverse relaxation time @xmath2 ) this method can determine the signal frequency @xmath3 with a precision of @xmath4 if the observation time @xmath5 is long enough . </S>",
    "<S> the method is especially convenient when the detailed shape of the observed ft nmr spectrum is not well defined . </S>",
    "<S> when @xmath2 is @xmath6 and the signal becomes pure sinusoidal , the precision of the method is @xmath7 which is one order more precise than a typical frequency counter . </S>",
    "<S> analysis of this method shows that the integration reduces the noise by bandwidth narrowing as in a lock - in amplifier , and no extra signal filters are needed . for a pure sinusoidal signal </S>",
    "<S> we find from numerical simulations that the noise - induced error in this method reaches the cramer - rao lower band(crlb ) on frequency determination . </S>",
    "<S> for the damped sinusoidal case of most interest , the noise - induced error is found to be within a factor of 2 of crlb when the measurement time @xmath5 is a few times larger than @xmath2.we discuss possible improvements for the precision of this method . </S>"
  ]
}