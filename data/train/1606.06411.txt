{
  "article_text": [
    "the first exit event of a process is an intensively studied subject in probability @xcite . despite numerous deep theoretical results on the subject , exact sampling of the first passage event remains challenging especially for processes with infinite measures .",
    "recently , in @xcite , it was shown that exact sampling can be done for a wide range of processes with bounded variation .",
    "the methods of @xcite rely on the decomposition of a process as the difference of two independent subordinators .",
    "however , no such decomposition exists for processes with unbounded variation . in this paper , we show that exact sampling of the first exit event can be achieved for several important classes of such processes , a primary example being those that have a symmetric truncated @xmath0-stable measure with @xmath1 and with or without a brownian component .",
    "one of the main ingredients of the method is the sampling of the time when a brownian motion first exits an interval and a pre - exit location of the brownian motion , which may be of interest in its own right .",
    "the processes covered by the paper are among those that can be embedded into a subordinated brownian motion ( @xcite , chapter 30 ) . similar to @xcite ,",
    "the general idea is to sample certain first exit events of the subordinated brownian motion and extract from them the part that belong to the process under consideration .",
    "however , care is required to deal with unbounded variation . due to the structure of the subordinated brownian motion ,",
    "the sampling of the first exit event can be addressed by attacking two issues in tandem .",
    "the first one is the sampling of the first passage event of the subordinator underlying the subordinated brownian motion . for this",
    ", the results in @xcite can be directly used .",
    "the second issue is the sampling of the first exit time of a brownian motion and its value at a pre - exit time point given the time and location of the first exit . for this",
    ", a huge number of known results can be used ( cf .",
    "@xcite ) .",
    "section [ s : main ] presents the main sampling procedure .",
    "first , the scheme of the procedure is illustrated in section [ ss : description ] .",
    "then , in section [ ss : formal ] , the procedure is formalized as algorithm [ a : fet ] . in section [ ss : example ] ,",
    "some examples are given .",
    "since the sampling of the first passage time of the subordinator involved was addressed previously @xcite , after section [ s : main ] , the discussion is mostly dedicated to the sampling for the brownian motion . in section [ s : bm - fet ] , we consider the sampling of the first exit time of the brownian motion by exploiting its well known distributional properties @xcite .",
    "we then consider the sampling of the value of the brownian motion at a time point before its first exit .",
    "in section [ s : pre - exit ] , we obtain some useful results on the distribution of the pre - exit value of the brownian motion , which we have not been able to find in the literature . in section [",
    "s : sampling - pre - exit ] , the sampling of the pre - exit value is considered .",
    "the subtlety here is the handling of the many negative terms in the series expansion of the density function of the pre - exit value .",
    "finally , some comments are made in section [ s : comments ] .",
    "for @xmath2 , denote by @xmath3 the geometric distribution on @xmath4 with probability mass function ( ) @xmath5 . for @xmath6 ,",
    "denote by @xmath7 the gamma distribution on @xmath8 with probability density function ( ) @xmath9 .",
    "denote by @xmath10 the  of @xmath11 , the normal distribution with mean 0 and variance @xmath12 .",
    "let @xmath13 be a process . then @xmath14 = e^{-t\\che_x(\\lambda)}$ ] , @xmath15 , @xmath16 , where for some @xmath17 and measure @xmath18 on @xmath19 which satisfies @xmath20 , @xmath21 @xmath22 , @xmath12 , @xmath23 , and @xmath18 are called the , linear coefficient , brownian coefficient , and measure of @xmath24 , respectively .",
    "the radon - nikodym derivative @xmath25 , provided it exists , is called the density of @xmath24 .",
    "if @xmath26 or @xmath27 , then @xmath24 is said to have infinite variation , otherwise it is said to have finite variation . in the latter case @xmath22 can be written as @xmath28 with @xmath29 called the drift coefficient of @xmath24 . a necessary and sufficient condition for @xmath24 to",
    "be nondecreasing is that it has finite variation with @xmath30 and @xmath31 . in this case , @xmath24 is called a subordinator .",
    "furthermore , if @xmath32 is a process independent of @xmath24 , then @xmath33 is called a subordinated process . in particular ,",
    "if @xmath34 is a standard brownian motion , i.e. , a process with @xmath35 , then @xmath36 is a process with linear coefficient 0 , brownian coefficient @xmath37 , and density @xmath38 ( @xcite , theorem 30.1 ) .    for any open or closed set @xmath39 , according to blumenthal 0 - 1 law , either 0 is regular for @xmath40 ( with respect to @xmath24 ) , i.e. , @xmath41 , or 0 is irregular for @xmath40 , i.e. , @xmath42  ( @xcite , p.  313 ) .",
    "it is easy to see that if @xmath24 is not a compound poisson process and is symmetric , i.e. , @xmath43 , then 0 is regular for both half - lines @xmath44 and @xmath45 . as a passing remark , if @xmath24 has infinite variation , then 0 is regular for both half - lines ( @xcite , p.  167 ) , while if @xmath24 has finite variation , bertoin s test provides a necessary and sufficient condition for 0 to be regular for a half - line ( @xcite ; @xcite , theorem 6.22 ) .",
    "let @xmath46 such that @xmath47 is a standard brownian motion .",
    "for @xmath48 , let @xmath49 while for @xmath50 , let @xmath51 given @xmath52 , denote by @xmath53 the probability measure under which @xmath54 and by @xmath55 the associated expectation .",
    "it is well known that under @xmath53 the  of @xmath56 is @xmath57 , where @xmath58 while for @xmath50 and @xmath59 , the  of @xmath60 , denoted by @xmath61 , has series expressions @xmath62 .",
    "\\\\\\label{e : b - fet2 }    &    =    \\frac \\pi{2 a^2 }    \\sumzi k ( -1)^k ( 2k+1)\\exp\\cbr {      -\\frac{(2k+1)^2 \\pi^2 t}{8 a^2}}\\cos\\frac{(2k+1)\\pi x}{2a}.\\end{aligned}\\ ] ] the series in converges rapidly for small @xmath63 but slowly for large @xmath63 , while the one in has the opposite property .",
    "is due to the following fact ( @xcite ,  7.4 ) .",
    "let @xmath64 be a bounded and connected open set and @xmath65 .",
    "if @xmath66 is a bounded solution to the heat equation @xmath67 with initial condition @xmath68 for all @xmath69 and dirichlet boundary condition @xmath70 for all @xmath71 and @xmath72 , then @xmath73 , \\quad    \\text{where}\\    \\fet u = \\inf\\{t : \\bm t\\not\\in u\\}.\\end{aligned}\\ ] ] calculating @xmath74 $ ] then boils down to solving the heat equation with the specified initial and boundary conditions .",
    "in particular , if @xmath75 , by separating the variables @xmath76 and @xmath77 and considering the eigenfunctions of @xmath78 and those of @xmath79 with the same eigenvalues , @xmath80 where @xmath81 is @xmath82 for odd @xmath83 and @xmath84 for even @xmath83 , and @xmath85 . to get eq .  , apply to @xmath86 to yield @xmath87 , and then differentiate the result in @xmath76 .",
    "let @xmath24 be a symmetric process .",
    "suppose the brownian coefficient of @xmath24 is @xmath30 and its density is @xmath88 such that @xmath89 is the density of a subordinated process @xmath90 , where @xmath91 is a standard brownian motion and @xmath92 a subordinator with drift coefficient @xmath93 independent of @xmath91",
    ". then @xmath94 is symmetric and its brownian coefficient is @xmath29 as well .",
    "given interval @xmath95 with @xmath96 , the first exit time of @xmath24 out of @xmath97 is @xmath98 the value and jump of @xmath24 at the time of exit are also important information .",
    "we shall consider the sampling of the triplet @xmath99 , where for @xmath63 , @xmath100 is the left limit of @xmath24 at @xmath76 .    by right - continuity of @xmath101 , @xmath102 .",
    "as long as @xmath103 and @xmath104 , @xmath105 is finite .",
    "this is because either i ) @xmath106 , or ii ) @xmath107 , or iii ) @xmath108  ( @xcite , theorem vi.16 ) .",
    "since @xmath24 is symmetric , iii ) must hold , so @xmath109 . as a passing remark , for any process",
    ", erickson s test provides a necessary and sufficient condition on which of the three cases holds ( @xcite , theorem 4.15 and p.  64 ) .    in this section",
    ", it is always assumed that @xmath110 which is equivalent to @xmath92 not being a compound poisson subordinator .",
    "since @xmath24 is symmetric , then with respect to @xmath24 , @xmath12 is regular for @xmath111 and @xmath112 is regular for @xmath113 , so @xmath114\\}.\\end{aligned}\\ ] ] in particular , if @xmath115 , @xmath116 is the first passage time of @xmath24 across @xmath12 , i.e. , @xmath117    by definition , @xmath118 . under assumption , @xmath119 indeed , as @xmath120 , since @xmath92 is not a compound poisson process and hence strictly increasing , @xmath121 , given @xmath122 by continuity of @xmath91 . then follows .",
    "( 105,58)(-1,10 ) ( 0,5)[.72 ] .",
    "( a ) @xmath123 , so @xmath124 and @xmath125 is the first exit time of @xmath24 and @xmath94 out of @xmath126 ; ( b ) @xmath127 , so @xmath124 , but @xmath125 is not an exit time of @xmath24 out of @xmath126 ; ( c ) @xmath128 , so @xmath129 , @xmath125 is not the first exit time of @xmath24 out of @xmath126 but is that of @xmath94 ( from the top ) ; ( d ) @xmath130,title=\"fig : \" ] ( 0.3,5)(0,1)63 ( 0.3,26.5)(1,0)105    ( 1,11)@xmath131 ( 1,40)@xmath132 ( -2.5,25)@xmath133    ( 31 , 31)@xmath134 ( 46 , 34)@xmath135 ( 61 , 35)(1,0)4    ( 65 , 5)(0,2)31(0,1)1 ( 80 , 5)(0,2)31(0,1)1 ( 99.5 , 5)(0,2)31(0,1)1    ( 65,23.8)@xmath136 ( 81,24.3)@xmath137 ( 100,23.8)@xmath138    ( 100 , 45)(a ) ( 100 , 32)(b ) ( 100 , 65)(c ) ( 100 , 8)(d )    to sample @xmath139 , the approach is to embed @xmath24 into @xmath90 and exploit a sequence of hitting or passage events of @xmath91 and @xmath92 . by embedding",
    "it means that , by identifying @xmath94 with @xmath140 , @xmath24 is a part of @xmath94 , where @xmath141 is a compound poisson process with density @xmath142 independent of @xmath24 .",
    "equivalently , @xmath143 where @xmath144 is the jump of @xmath94 at @xmath145 .",
    "the issue is how to identify the jumps of @xmath141 so that random variables purely due to @xmath24 can be extracted from those of @xmath94 .",
    "figure [ f : fet ] illustrates the idea .",
    "suppose @xmath146 . at time @xmath147 , @xmath91 hits the boundary of @xmath148 , say at @xmath132",
    ". then @xmath149 let @xmath150 from and , it follows that for @xmath151 , @xmath152 .",
    "thus , in @xmath153 , @xmath94 only has jumps of size strictly less than @xmath154 .",
    "then @xmath155 on @xmath156 and the first jump in @xmath141 can only appear at @xmath125 .",
    "figure [ f : fet ] shows a scenario where @xmath92 has a jump at @xmath147 . because the potential measure of @xmath92 is diffuse , @xmath157 ( @xcite , propositions i.15 and iii.2 )",
    ". then @xmath158 and by , @xmath159 .",
    "if @xmath160 , then the jump belongs to @xmath24 , giving @xmath124 .",
    "this is the case in ( a ) and ( b ) in figure [ f : fet ] . in ( a ) , since @xmath161 , @xmath125 is the first time of @xmath24 out of @xmath148 , whereas in ( b ) , it is not . if @xmath162 , then the jump belongs to @xmath141 , giving @xmath129 .",
    "this is the case in ( c ) in figure [ f : fet ] , where @xmath125 is the first exit time of @xmath94 out of @xmath163 but not that of @xmath24 .",
    "also , as ( d ) shows , even if @xmath91 first exits @xmath126 at the top boundary point , @xmath94 and @xmath24 may first exit at the lower boundary .    from the above description , it is seen that the following quantities have to be sampled in sequel ,    1 .",
    "@xmath147 , the first hitting time of @xmath91 at @xmath164 ; 2 .",
    "the triplet @xmath165 , where @xmath125 the first passage time of @xmath92 across @xmath147 ; and 3 .",
    "@xmath166 and @xmath167 .",
    "because @xmath92 and @xmath91 are independent , b ) boils down to the sampling of the first passage of @xmath92 across any fixed level .",
    "this is addressed in @xcite for several important classes of subordinators .",
    "items a ) and c ) will be considered in following sections .",
    "the sampling of @xmath166 boils down to that of @xmath168 conditional on @xmath169 for fixed @xmath170 . on the other hand , by the strong markov property of brownian motion",
    ", @xmath167 can be simply sampled from a normal distribution .",
    "figure [ f : fet ] just illustrates a single iteration of the sampling procedure .",
    "if at the end of the iteration , @xmath24 has yet exited @xmath97 , then the procedure is renewed at time @xmath125 .",
    "the iteration continues until an exit occurs .",
    "note that @xmath125 is not a stopping time of @xmath24 or @xmath94 as it depends on @xmath147 , information not available via @xmath24 or @xmath94 .",
    "however , conditional on @xmath91 , @xmath125 is a stopping time of @xmath92 , justifying iterating by renewal .",
    "indeed , the procedure can be thought of as one with the entire path of @xmath91 being sampled in advance and @xmath92 being the only random process during the run . in this",
    "setting , the sampling of @xmath147 , @xmath171 and @xmath172 can be regarded as a subroutine to retrieve data from the path of @xmath91 .",
    "there are two simpler cases not covered so far .",
    "first , if @xmath92 has a positive drift , then it may creep across @xmath147 , i.e. , @xmath173 ( @xcite , theorem iii.5 ) .",
    "clearly in this case @xmath174 is equal to the point where @xmath91 exits @xmath148 .",
    "second , suppose we wish to sample @xmath175 instead , where @xmath176 with @xmath177 a fixed terminal point .",
    "this allows , for example , the sampling of @xmath178 when @xmath179 . if @xmath180 , then @xmath181 instead of @xmath136 and @xmath138 should be sampled conditional on @xmath182 ( cf .",
    "@xcite ) and then @xmath183 is sampled conditional on @xmath184 .",
    "the description in section [ ss : description ] is formalized as algorithm [ a : fet ] with additional detail taken into account . in the procedure",
    ", @xmath95 and @xmath185 is defined at the end of section [ ss : description ] .",
    "it is quite routine to extend the procedure to sample the first exit event of @xmath186 , where @xmath34 is a compound poisson process independent of @xmath24 ( cf .",
    "@xcite ) . for brevity ,",
    "the detail of the extension is omitted .",
    "@xmath187 all in @xmath188 $ ] such that if @xmath189 then @xmath190 and @xmath177    @xmath191 , @xmath192    @xmath193 [ a : fet - a ]    sample @xmath194 from the distribution of @xmath60 and sample @xmath195 from @xmath196 uniformly [ a : fet - y ]    sample @xmath197 from the distribution of @xmath198 , where @xmath199 with @xmath200 [ a : fet - fpt ]    sample @xmath77 from the conditional distribution of @xmath201 given @xmath202 [ a : fet - x ]    sample @xmath203 from @xmath204 [ a : fet - zeta ]    @xmath205 , @xmath206 [ a : fet - d ]    @xmath207 [ a : fet - d0 ]    @xmath208 , @xmath209 [ a : fet - update ]    @xmath210 or @xmath211    @xmath212    in algorithm [ a : fet ] , @xmath213 is a value such that @xmath214 for all @xmath215 and @xmath216 . in each iteration @xmath217 is updated following the description in section [ ss : description ] .",
    "some explanations are in order .",
    "the value of @xmath218 on line [ a : fet - a ] makes sure the interval @xmath219 is in @xmath220 . since @xmath91 is a standard brownian motion , @xmath195 on line [ a : fet - y ] follows the distribution of @xmath221 conditional on @xmath60 .",
    "if @xmath222 , then as explained in section [ ss : description ] , @xmath223 and @xmath224 . by the strong markov property of @xmath91 and the independence between @xmath91 and @xmath92 , conditional on @xmath225 ,",
    "@xmath226 is independent of @xmath227 and follows @xmath228 .",
    "thus @xmath203 on line [ a : fet - zeta ] follows the distribution of @xmath229 , and @xmath230 and @xmath231 on line [ a : fet - d ] follow the joint distribution of @xmath232 and @xmath233 . on the other hand , if @xmath234 , then either @xmath235 or @xmath236 , resulting in no jump and line [ a : fet - d0 ] .",
    "line [ a : fet - update ] updates the values of @xmath213 and @xmath237 .",
    "it is clear that the iteration stops only when @xmath210 or @xmath238 , i.e.@xmath239 .",
    "when the iteration stops , since @xmath240 , @xmath241 follows the distribution of @xmath242 .",
    "[ t : fet ] the iteration in algorithm [ a : fet ] eventually stops  and its output follows the distribution of @xmath243 .    it suffices to show that the iteration eventually stops .",
    "let @xmath244 , @xmath245 , and for @xmath246 , @xmath247 and @xmath248 the values of @xmath213 and @xmath237 at the end of the @xmath249 iteration , respectively .",
    "let @xmath250 and @xmath251 .",
    "it is easy to see that both @xmath247 and @xmath252 are strictly increasing and @xmath253 .",
    "define event @xmath254 in @xmath255 , there are infinitely many @xmath247 .",
    "let @xmath256 and @xmath257 .",
    "since conditional on @xmath91 , @xmath247 are stopping times of @xmath92 , @xmath258  ( @xcite , proposition i.7 ) .",
    "then by continuity of @xmath91 , @xmath259 as a result , @xmath260 and there is @xmath261 such that @xmath262 on @xmath263 $ ] . by renewal argument",
    ", we can assume @xmath264 without loss of generality .",
    "then @xmath155 on @xmath265 $ ] , in particular , @xmath266 on the other hand , let @xmath267 , @xmath268 , and @xmath269 be the values of @xmath218 , @xmath194 , and @xmath125 in the @xmath249 iteration , respectively . then @xmath270 . in @xmath255 , @xmath271 . then @xmath272 .",
    "since @xmath273 , then @xmath274 . since @xmath275 , then @xmath276 .",
    "consequently , @xmath277 . combined with , this yields @xmath278",
    "either converges to @xmath112 or to @xmath12 . without loss of generality ,",
    "suppose the limit is @xmath12 . by using renewal argument again",
    ", we can assume that @xmath279 for all @xmath280 .",
    "note that by renewing @xmath281 at @xmath282 , @xmath134 is renewed at @xmath283 .",
    "it follows that @xmath284 is the first @xmath285 such that @xmath286 hits the boundary of @xmath287 and , with @xmath92 being non - compound poisson , @xmath247 is the first @xmath288 such that @xmath289 .",
    "now @xmath290 is either @xmath291 or @xmath12 , each with probability @xmath292 . if @xmath293 , then @xmath294 . by strong markov property of @xmath91 , @xmath295",
    "are independent normal random variables with mean 0 , possibly degenerate , so the probability that the procedure does _ not _ stop at the @xmath249 iteration is at most @xmath296 .",
    "it follows that the probability to have infinite iterations is 0",
    ". then @xmath297 .",
    "let @xmath24 be a symmetric process with density @xmath298 , @xmath299 . if @xmath300 and the brownian coefficient @xmath29 of @xmath24 is 0 , then @xmath24 has finite variation . in this case",
    ", it has been shown that @xmath175 can be sampled exactly @xcite . on the other hand ,",
    "if @xmath301 or @xmath1 , @xmath24 has infinite variation . in this case , @xmath24 can be embedded into @xmath302 as in , where @xmath92 is a subordinator with drift coefficient @xmath93 and density @xmath303 , where for @xmath304 , @xmath305 .",
    "the first passage event of @xmath92 can be sampled exactly @xcite . by combining this with the results in following sections ,",
    "algorithm [ a : fet ] can sample @xmath175 .",
    "suppose instead that @xmath92 is a subordinator with exponentially tilted density @xmath306 , where @xmath307 and @xmath308 .",
    "the first passage event of @xmath92 can be sampled exactly @xcite . on the other hand ,",
    "the density of @xmath309 is @xmath310 where the implicit constant in @xmath311 only depends on @xmath312 . by variable substitute @xmath313 , @xmath314 therefore , if @xmath315 and @xmath24 has density @xmath316 , where @xmath317 , then by choosing @xmath307 large enough and @xmath318 $ ] small enough , @xmath319 can be written as @xmath320 , where @xmath321 is the density of a compound poisson process . then , as noted just before algorithm [ a : fet ] , a routine extension of the procedure is able to sample @xmath322 .",
    "the case @xmath323 can be similarly dealt with .",
    "let @xmath24 be a symmetric process with @xmath324 and brownian coefficient @xmath29 .",
    "it has been shown that if @xmath325 , then @xmath243 can be sampled exactly @xcite .",
    "note that @xmath319 is a truncated version of the density of @xmath326 , where @xmath64 and @xmath231 are independent gamma processes with density @xmath327 .",
    "it is well known that @xmath328 , where @xmath141 is a gamma process with density @xmath329 ( cf .",
    "@xcite , p.  143 - 144 ) .",
    "assume now that @xmath330 .",
    "then @xmath24 can be embedded in @xmath90 , where @xmath331 .",
    "the exactly sampling of the first passage event of @xmath92 has been shown in @xcite .",
    "then algorithm [ a : fet ] can be used to sample @xmath243 .",
    "in this section , denote @xmath332 then @xmath333 for all @xmath77 , @xmath334 , in particular , @xmath335    for @xmath307 and @xmath336 , denote @xmath337 given @xmath50 , for @xmath63 , by , @xmath338 and by , @xmath339    let @xmath340",
    ". then by , the  of @xmath24 is @xmath341 where @xmath342 and @xmath343 for @xmath344 , @xmath345 , so @xmath346 is the  of @xmath347 at @xmath77 conditional on @xmath348 and @xmath349 .",
    "next , @xmath350 for @xmath351 . finally , since @xmath352 and @xmath353 is positive and strictly decreasing on @xmath354 , @xmath355 where the second inequality uses . as a result , implies that rejection sampling can be used to sample @xmath24 conditional on @xmath356 , and hence to sample @xmath60 conditional on @xmath357 .    likewise , by , the  of @xmath358 is @xmath359 where @xmath360 and @xmath361 as a result",
    ", rejection sampling can be used to sample @xmath34 conditional on @xmath362 , and hence to sample @xmath60 conditional on @xmath363 .",
    "recall that @xmath53 denotes probability measure under which @xmath364 .",
    "the above results lead to the rejection sampling algorithm [ a : bfet ] .",
    "@xmath365 , @xmath366 , @xmath367 as in , @xmath40 and @xmath368 as in and , respectively sample @xmath369  @xmath370 sample @xmath371 conditional on @xmath348 , then sample @xmath372 @xmath373 sample @xmath360 conditional on @xmath374 , then sample @xmath375 @xmath376",
    "we need a few more properties of the first exit event of a brownian motion . for @xmath63 and @xmath59 ,",
    "it is known that @xmath377 where @xmath378\\end{aligned}\\ ] ] ( @xcite , p.  212 , 3.0.6 ) .",
    "we also have the following .    [",
    "p : b - fet ] for all @xmath63 and @xmath59 @xmath379 furthermore , @xmath380 .    to start with , by the markov property of @xmath91 , @xmath381      =      \\mean^x[\\cf{t<\\fet a } \\pr^{\\bm t}\\{\\bm{\\fet a}'=a\\ } ] ,    \\end{aligned}\\ ] ] where @xmath382 is an  copy of @xmath91 . by @xmath383 , @xmath384 ( @xcite , p.  212 , 3.0.4 ) , @xmath385      =      \\frac 1 2 \\pr^x\\{t<\\fet a\\ } +      \\frac1{2a}\\mean^x[\\bm t\\cf{t<\\fet a } ] .    \\end{aligned}\\ ] ] put @xmath386 $ ] . using and the fact that @xmath77 is antisymmetric on @xmath387 , @xmath388 where @xmath389 then @xmath390 differentiating both sides in @xmath76 then yields .    to show @xmath391 for all @xmath59 , regard @xmath77 as a parameter while @xmath76 the only variate .",
    "then denote @xmath392 . by ,",
    "@xmath393 , @xmath394 .",
    "then @xmath395 , so @xmath396 . from",
    ", it follows that @xmath397 for all small @xmath63 .",
    "likewise , @xmath398 for all small @xmath63 .",
    "assume @xmath399 and let @xmath400 be the infimum of the set . then @xmath71 . since @xmath401 is smooth , @xmath402 .",
    "fix @xmath403 . under @xmath53 , in order for @xmath91 to reach @xmath218 before reaching @xmath404 , it may first reach @xmath12 before reaching @xmath404 , then starting at @xmath12 , return to @xmath77 before reaching @xmath218 , and finally , starting at @xmath77 again , reach @xmath218 before reaching @xmath404 . as a result , @xmath405 , where @xmath406 , @xmath407 , @xmath408 , @xmath409 .",
    "since @xmath410 for all @xmath411 , it follows that @xmath412 for all @xmath413 .",
    "however @xmath414 and @xmath415 for all small @xmath76 .",
    "the contradiction shows @xmath401 is strictly positive .",
    "likewise , @xmath416 is strictly positive .",
    "[ p : b - fet - dx ] fix @xmath63 and @xmath50 . then for @xmath59 , @xmath417 where @xmath418 furthermore , @xmath419 and @xmath420    recall @xmath421 . let @xmath422 . then by , @xmath423 , where @xmath424 .",
    "\\end{aligned}\\ ] ] by @xmath425 , @xmath426 for some @xmath427 . then @xmath428 $ ] .",
    "by @xmath429 , @xmath430 since @xmath431 , for @xmath432 , @xmath433 and @xmath434 . also , for any @xmath435 , @xmath436 .",
    "then @xmath437 it follows that @xmath438 .    let @xmath439 . then by , @xmath440 , where @xmath441 .",
    "\\end{aligned}\\ ] ] since @xmath442 , there is @xmath443 such that @xmath444 .",
    "similar to the above argument , @xmath445 \\dn_t(2a - z ) + i_1 + i_2 ,    \\end{aligned}\\ ] ] where @xmath446 then @xmath447\\dn_t(a - x ) z +    ( c_{\\dfe{}}/2)\\dn_t(z ) z\\le c_{\\dfe { } } \\dn_t(a-|x| ) ( a+x)$ ] .",
    "the equalities in and can be shown by direct calculation using and .",
    "then it is clear that @xmath448 is strictly negative and finite and @xmath449 is finite . to show that the latter partial derivative is strictly positive , first ,",
    "write it as @xmath450 ,    \\end{aligned}\\ ] ] where @xmath451 with @xmath452 .",
    "if @xmath453 , i.e. , @xmath454 , then @xmath455 is strictly decreasing on @xmath354 and hence @xmath456 . to cover the case @xmath457 , differentiate instead",
    "using the expressions in , @xmath458 where @xmath459 with @xmath460 .",
    "it is seen that if @xmath461 , in particular , if @xmath457 , then the sum on the right hand side is strictly positive .    from the proof of it",
    "is seen that the following is actually true .",
    "[ c : fet - dx ] fix @xmath63 and @xmath50 .",
    "let @xmath462 be as in .",
    "then for @xmath59 and @xmath280 , @xmath463        + \\dfh { 4(n+1)a+a - x}(t )      } \\le c_{\\dfe { } } \\dn_t(a - x)(a - x )    \\end{aligned}\\ ] ] and @xmath463      } \\le c_{\\dfe { } } \\dn_t(a-|x|)(a+x ) .",
    "\\end{aligned}\\ ] ]    [ p : x ] given @xmath50 , @xmath464 where @xmath465 in addition , for all @xmath59 , @xmath466 and @xmath467 where @xmath468 .",
    "finally , @xmath469    the assertion is trivial if @xmath470 . for @xmath471 , @xmath472 by the strong markov property , @xmath473 by and the strong markov property again , @xmath474 where the last equality is due to the reflection principle . for each @xmath83 , @xmath475 .",
    "a similar formula holds for @xmath476 .",
    "combining the results , follows . by , for any @xmath477)$ ] , @xmath478      \\\\      & =      \\sum_{k\\ge 1 , k\\text { odd } }      \\frac 1 a      \\exp\\cbr{-\\frac{k^2\\pi^2 t}{8 a^2 } }       \\int^a_{-a } g(x ) \\cos\\frac{k\\pi x}{2a } \\,\\dd x.    \\end{aligned}\\ ] ] comparing the measures on both sides yields .    to show @xmath466 for @xmath471 , fix @xmath479 and @xmath480 .",
    "then @xmath481 , so by the markov property , @xmath482 where the second inequality is due to @xmath483\\subset    [ -a - u , a - u]$ ] for all @xmath484 $ ] .",
    "as a result , @xmath485 if @xmath486 , then @xmath487 for all @xmath488 .",
    "however , by , @xmath489 is analytic on @xmath490 .",
    "this leads to @xmath491 , implying either @xmath492 or @xmath493 , which is impossible , as @xmath494 by .",
    "the contradiction shows @xmath495 .",
    "to show , since @xmath496 , it suffices to consider @xmath497 .",
    "let @xmath498 .",
    "then @xmath499 and by , @xmath500 : = g(z ) .",
    "\\end{aligned}\\ ] ] since @xmath425 , there is @xmath443 , such that @xmath501 .",
    "by @xmath502 @xmath503      \\\\      & \\le      2 t^{-1 } \\sumzi k ( 2ka+a+z ) [ \\dn_t(2ka+a - z ) + \\dn_t(2ka+a+z ) ]      \\\\      & \\le      8 a t^{-1 }   \\sumzi k ( k+1 ) \\dn_t(2ka+a - z )      \\\\      & \\le      8 a t^{-1 } \\sumzi k ( k+1 ) e^{-2k^2a^2/t } \\dn_t(a - z ) .",
    "\\end{aligned}\\ ] ] then follows .    it is straightforward to check the first equation in . by differentiating each term in at @xmath504 and comparing the resulting series to , the second equation in obtains",
    "the inequality in is just the last assertion of proposition [ p : b - fet ] .    given @xmath50 and @xmath505 , for @xmath63 and @xmath59 ,",
    "@xmath506 as a result , under @xmath507 , conditional on @xmath508 and @xmath509 , the  of @xmath168 at @xmath59 is in proportion to @xmath510 and conditional on @xmath511 and @xmath512 , the  of @xmath168 at @xmath513 is in proportion to @xmath514 .    since @xmath515 , the markov property of @xmath91 yields @xmath516",
    ". then the case @xmath509 of follows from propositions [ p : b - fet ] and [ p : x ] .",
    "the case @xmath517 is similarly proved . finally , note @xmath518 .",
    "fix @xmath63 , @xmath505 , and @xmath50 .",
    "the objective now is to sample @xmath519 conditional on @xmath520 and @xmath521 . by symmetry",
    ", it suffice to consider the case where @xmath509 .",
    "we shall construct an envelope function for @xmath522 and one for @xmath523 , respectively .",
    "consider @xmath522 first . to emphasize that @xmath77 is the ( only ) variate , write @xmath524",
    ". let @xmath525 by , for each @xmath59 , @xmath526 let @xmath527 since @xmath391 ( proposition [ p : b - fet ] ) , the set on the right hand side is nonempty , so @xmath528 is well defined .",
    "[ p : p * ] fix @xmath63 and @xmath50 .",
    "then for @xmath59 , 1 ) @xmath529 and @xmath530 for all @xmath531 , 2 ) as @xmath532 , @xmath533 and 3 ) as @xmath534 , @xmath535 .",
    "\\1 ) by definition of @xmath528 , for @xmath59 , @xmath529 , i.e. , @xmath536 . since @xmath537 is strictly increasing on @xmath538 $ ] and strictly decreasing on @xmath539 , @xmath540 . then for @xmath531 , @xmath541",
    ", so @xmath530 .",
    "\\2 ) put @xmath542 . by corollary",
    "[ c : fet - dx ] @xmath543 on the other hand , by definition of @xmath528 , @xmath544 since @xmath545 , there is @xmath546 such that @xmath547 . as @xmath548 , @xmath549 by .",
    "then by proposition [ p : b - fet - dx ] and uniform convergence , @xmath550 . as a result , @xmath551 .",
    "this combined with yields the claimed asymptotic of @xmath528 .",
    "\\3 ) put @xmath439 and @xmath552    \\end{aligned}\\ ] ] if @xmath280 and @xmath553 if @xmath554 .",
    "since @xmath555 , there is @xmath556 such that @xmath557 .",
    "it is not hard to show that as @xmath558 , @xmath559 , where @xmath560 . since @xmath561 , which by proposition [ p : b - fet - dx ] is strictly positive , there is @xmath562 such that @xmath563 for all @xmath564 .",
    "since @xmath565 , this implies @xmath566 for all @xmath304 small enough .",
    "thus @xmath567 .",
    "the asymptotics of @xmath528 in proposition [ p : p * ] suggest that for rejection sampling involving @xmath522 , @xmath568 should be handled more carefully than @xmath569 . letting @xmath542 , for @xmath570 , @xmath571 where the second inequality is due to @xmath572 for all @xmath195 , @xmath304 . from the proof of proposition [ p : p * ] , @xmath573 and @xmath574 is strictly decreasing on @xmath575 .",
    "thus @xmath576 and by , @xmath577 and meanwhile @xmath578 we will use  to construct an envelope for @xmath522 .    to construct an envelope for @xmath523 ,",
    "for each @xmath59 , the series in converges absolutely .",
    "let @xmath579 noting @xmath580 , @xmath581 let @xmath582 since @xmath583 by proposition [ p : x ] , @xmath584 is well defined .",
    "[ p : q * ] fix @xmath505 and @xmath50 .",
    "then for @xmath59 , 1 ) @xmath585 , @xmath586 for all @xmath587 , and 2 ) as @xmath588 , @xmath589 .",
    "indeed , since @xmath590 is strictly concave on @xmath591 $ ] and strictly convex on @xmath592 , 1 ) follows by similar argument for 1 ) of proposition [ p : p * ] . on the other hand , 2 ) follows from and similar argument for 3 ) of proposition [ p : p * ] .",
    "the detail of the proof is omitted for brevity .",
    "since @xmath590 is strictly decreasing on @xmath593 , for each @xmath594 , @xmath595 , where @xmath596 .",
    "by @xmath597 , @xmath598 meanwhile , @xmath599    now  can be combined as follows .",
    "define @xmath600 for @xmath336 , define @xmath601 and @xmath602 for @xmath59 and @xmath336 , define @xmath603      \\displaystyle      \\frac{p_{m+k}(x)}{c_{\\dfe { } } \\dn_t(a - x)(a - x ) a_k }      &      \\text{else }     \\end{cases}\\end{aligned}\\ ] ] and @xmath604      \\displaystyle      \\frac{q_k(x)}{4 a t^{-1 } \\dn_t(x)(a-|x| ) b_k } &      \\text{else }    \\end{cases}\\end{aligned}\\ ] ] then @xmath605 , @xmath606 for all @xmath336 and @xmath607 the rejection sampling of the  @xmath608 is quite routine , although for efficiency , the detail has to depend on @xmath218 , @xmath76 , and @xmath213 ( more precisely , on @xmath609 and @xmath610 ) . on the other hand , note that both @xmath611 and @xmath612 are log - concave , i.e. , @xmath613 and @xmath614 .",
    "it was shown in @xcite that a log - concave distribution on integers can be sampled efficiently by rejection sampling .",
    "the only minor issue here is that the values of the normalizing constants for @xmath611 and @xmath612 in general are not available exactly .",
    "however , it is easy to find positive lower and upper bounds for the sequences .",
    "when these bounds are used in place of the exact normalizing constants , the rejection sampling in @xcite still works with some minor modifications and loss of efficiency .",
    "@xmath365 , @xmath615 , @xmath616 sample @xmath617 , where @xmath618 is defined in compute @xmath619 by and @xmath620 by sample @xmath621 with  @xmath622 , where @xmath623 is defined in sample @xmath624 with  @xmath625 , where @xmath626 is defined in sample @xmath627 @xmath628 , where @xmath629 and @xmath630 are defined in and , respectively @xmath24    the above results lead to the rejection sampling algorithm [ a : bm - x ] .",
    "this paper only considers processes that can be embedded into a subordinated standard brownian motion . in principle , the scheme illustrated in figure [ f : fet ] can be applied to any process , for example , a spectrally negative @xmath0-stable process with @xmath631 . indeed , without subordination being involved , the scheme can be somewhat simplified .",
    "however , even for the spectrally negative @xmath0-stable process , which has many remarkable properties , there are few close form formulas for its first exit event ( cf .",
    "since all processes are differences of independent spectrally negative processes , it would be interesting to find exact sampling methods for the first exit event of the latter .",
    "the procedure in algorithm [ a : fet ] in principle may also be applied to a subordinated brownian motion that has a drift or takes values in @xmath632 with @xmath633 .",
    "for example , in each iteration , intead of an interval centered at the current value of a brownian motion ( cf .",
    "step [ a : fet - a ] ) , use a sphere of small radius so that jumps of large size can be detected and removed .",
    "one potential problem is that for @xmath633 , when there is a positive chance for the process to creep across the boundary of a region , the iteration in algorithm [ a : fet ] may not be able to stop .",
    "this is because the chance for the brownian motion to hit the `` right spots '' on the sphere , namely , the intersection between the sphere and the boundary of the region , can be 0 ; at any other spot on the sphere , a new sphere has to be constructed , possibly with a smaller radius . as a result",
    ", the iteration will approach infinitely but never reach the location of the first exit .",
    "regardless , there is no extra work on the sampling for the subordinator .",
    "also , the first exit time out of a sphere by a brownian motion is well understood . on the other hand ,",
    "the distribution of the pre - exit value of the brownian motion becomes substantially subtle .",
    "provided the distribution is available in close form , the procedure of the paper can be extended straightforwardly .",
    "mrters , p. and peres , y. ( 2010 ) .",
    "_ brownian motion_. cambridge series in statistical and probabilistic mathematics , cambridge university press , cambridge . with an appendix by oded schramm and wendelin werner .",
    "sato , k .-",
    "( 1999 ) . _ lvy processes and infinitely divisible distributions _ , vol .  68 of _ cambridge studies in advanced mathematics_. cambridge university press , cambridge . translated from the 1990 japanese original , revised by the author"
  ],
  "abstract_text": [
    "<S> we show that exact sampling of the first passage event can be done for a process with unbounded variation , if the process can be embedded in a subordinated standard brownian motion . by sampling a series of first exit events of the brownian motion and first passage events of the subordinator , the first passage event of interest </S>",
    "<S> can be obtained . </S>",
    "<S> the sampling of the first exit time and pre - exit location of the brownian motion may be of independent interest .    </S>",
    "<S> _ keywords and phrases . </S>",
    "<S> _ first exit ; process ; unbounded variation ; subordinator    2000 mathematics subject classifications : primary 60g51 ; secondary 60e07 .    </S>",
    "<S> * exact sampling of first passage event of certain symmetric processes with unbounded variation * + zhiyi chi + department of statistics + university of connecticut + storrs , ct 06269 , usa , + e - mail : zhiyi.chi@uconn.edu + </S>"
  ]
}