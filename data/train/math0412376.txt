{
  "article_text": [
    "in two extraordinary papers , hatayama et al .",
    "@xcite recently conjectured the equality between the one - dimensional configuration sum @xmath1 and the fermionic formula @xmath2 for all affine kac ",
    "moody algebras .",
    "the one - dimensional configuration sum @xmath1 originates from the corner - transfer - matrix method  @xcite used to solve exactly solvable lattice models in statistical mechanics .",
    "it is the generating function of highest weight crystal paths graded by the energy statistic .",
    "the fermionic formula @xmath2 comes from the bethe ansatz  @xcite and exhibits the quasiparticle structure of the underlying model . in combinatorial terms",
    ", it can be written as the generating function of rigged configurations .",
    "the one - dimensional configuration sum depends on the underlying tensor product of crystals . in  @xcite ,",
    "the @xmath0 conjecture was formulated for tensor products of kirillov  reshetikhin ( kr ) crystals @xmath4 .",
    "reshetikhin crystals are crystals for finite - dimensional irreducible modules over quantum affine algebras .",
    "the irreducible finite - dimensional @xmath5-modules were classified by chari and pressley  @xcite in terms of drinfeld polynomials .",
    "the kirillov  reshetikhin modules @xmath6 , labeled by a dynkin node @xmath7 of the underlying classical algebra and a positive integer @xmath8 , form a special class of these finite - dimensional modules .",
    "they naturally correspond to the weight @xmath9 , where @xmath10 is the @xmath7-th fundamental weight of @xmath11 .",
    "it was conjectured in  @xcite , that there exists a crystal @xmath4 for each @xmath6 . in general , the existence of @xmath4 is still an open question . for type",
    "@xmath12 the crystal @xmath4 is known to exist  @xcite and its combinatorial structure has been studied  @xcite .",
    "the crystals @xmath3 for nonexceptional types , which are relevant for this paper , are also known to exist and their combinatorics has been worked out  @xcite .    the purpose of this paper is to establish the @xmath0 conjecture for tensor products of kr crystals of the form @xmath3 for nonexceptional affine algebras .",
    "this extends  @xcite , where @xmath0 is proved for tensor powers of @xmath13 , and  @xcite , where @xmath0 is proved for type @xmath12 .",
    "our method to prove @xmath0 for symmetric powers combines various previous results and techniques .",
    "@xmath0 is first proved for @xmath11 such that @xmath14 is simply - laced ( see corollary  [ cor : x = m ad ] ) .",
    "this is accomplished by exhibiting a grade - preserving bijection from @xmath15-highest weight vectors ( paths ) to rigged configurations ( rcs ) .",
    "this was already proved for the root system @xmath12 @xcite . for type @xmath16",
    "we exhibit such a path - rc bijection .",
    "the proof essentially reduces to the previously known @xmath17 case @xcite using the  splitting \" maps @xmath18 which are @xmath19-equivariant grade - preserving embeddings .    to prove that the bijection preserves the grading",
    ", we consider an involution denoted @xmath20 on crystal graphs that combines contragredient duality with the action of the longest element @xmath21 of the weyl group of @xmath14 .",
    "this duality on the crystal graph , corresponds under the path - rc bijection to the involution on rcs given by complementing the quantum numbers with respect to the vacancy numbers .",
    "we then reduce to the case that @xmath14 is simply - laced .",
    "this is achieved using the embedding of an affine algebra @xmath11 into one ( call it @xmath22 ) whose canonical simple lie subalgebra is simply - laced . on the @xmath1 side we use the virtual crystal construction developed in @xcite .",
    "it is shown in @xcite that the kr @xmath5-crystals @xmath3 embed into tensor products of kr @xmath23-crystals such that the grading is respected .",
    "one may define the @xmath24 (  virtual x \" ) formula in terms of the image of this embedding and show that @xmath25 ( see section  [ ss : vx = v ] ) .",
    "this is proved for tensor products of crystals @xmath3 in  @xcite . on the @xmath2 side",
    ", it is observed in @xcite that the rcs giving the fermionic formula @xmath2 for type @xmath11 , embed into the set of rcs giving a fermionic formula for type @xmath22 .",
    "let us denote by @xmath26 (  virtual @xmath2 \" ) the generating function over the image of this embedding of fermionic formulas .",
    "it is shown in @xcite that @xmath27 .",
    "it then suffices to prove @xmath28 .",
    "that is , one must show that the path - to - rc bijection that has already been established for the simply - laced cases , restricts to a bijection between the subsets of objects in the formulas @xmath24 and @xmath26 .",
    "this is shown in theorem  [ th : virtualbij ] and as a corollary proves @xmath0 for nonsimply - laced algebras , as stated in corollary  [ cor : x = vx = vm = m ] .    in section",
    "[ s : x ] we review the crystal theory , the definition of the one - dimensional configuration sum @xmath1 , contragredient duality and the @xmath20 involution .",
    "virtual crystals are reviewed in section  [ s : virtual ] .",
    "right and left splitting of crystals are discussed in sections  [ s : right ] and  [ s : left ] , respectively .",
    "rigged configurations and the analogs of the splitting maps are subject of section  [ sec : rc ] .",
    "the fermionic formulas @xmath2 and their virtual counterparts @xmath26 are stated in section  [ s : fermionic ] . the @xmath0 conjecture for types @xmath12 and @xmath16",
    "is proven in section  [ sec : bij ] by establishing a statistics preserving bijection .",
    "finally , in section  [ sec : virtualbij ] the equality @xmath29 is established for nonsimply - laced types .",
    "let @xmath30 be a nonexceptional affine kac - moody algebra , its derived subalgebra and canonical simple lie subalgebra @xcite .",
    "denote the corresponding quantized universal enveloping algebras by @xmath31 @xcite .",
    "let @xmath32 ( resp .",
    "@xmath33 ) be the vertex set of the dynkin diagram of @xmath11 ( resp .",
    "@xmath14 ) . for @xmath34 ,",
    "let @xmath35 , @xmath36 , @xmath37 be the simple roots , simple coroots , and fundamental weights of @xmath11 .",
    "let @xmath38 be the fundamental weights of @xmath14 .",
    "let @xmath39 be the smallest tuple of positive integers giving a dependency relation on the columns of the cartan matrix of @xmath11 .",
    "write @xmath40 for the corresponding integers for the langlands dual lie algebra , the one whose cartan matrix is the transpose of that of @xmath11 .",
    "let @xmath41 be the canonical central element and @xmath42 the generator of null roots .",
    "let @xmath43 be the root , coroot , and weight lattices of @xmath11 .",
    "let @xmath44 be the pairing such that @xmath45 .",
    "let @xmath46 be the natural surjections of weight lattices of @xmath47 .",
    "let @xmath48 be the dominant weights for @xmath14 .",
    "let @xmath49 and @xmath50 be the weyl groups of @xmath11 and @xmath14 respectively .",
    "let @xmath2 be a finite - dimensional @xmath5-module .",
    "such modules are not highest weight modules ( except for the zero module ) and therefore need not have a crystal base .",
    "suppose @xmath2 has a crystal base @xmath51 .",
    "this is a special basis of @xmath2 ; it possesses the structure of a colored directed graph called the * crystal graph*. by abuse of notation the vertex set of the crystal graph is also denoted @xmath51 .",
    "the edges of the crystal graph are colored by the set @xmath52 .",
    "it has the following properties ( that of a regular @xmath53-weighted @xmath52-crystal ) :    1 .",
    "fix an @xmath34 . if all edges are removed except those colored @xmath54 , the connected components are finite directed linear paths called the * @xmath54-strings * of @xmath51 . given @xmath55 ,",
    "define @xmath56 ( resp .",
    "@xmath57 ) to be the vertex following ( resp .",
    "preceding ) @xmath58 in its @xmath54-string ; if there is no such vertex , declare the result to be the special symbol @xmath59 .",
    "define @xmath60 ( resp .",
    "@xmath61 ) to be the number of arrows from @xmath58 to the end ( resp . beginning ) of its @xmath54-string .",
    "2 .   there is a function @xmath62 such that @xmath63    a * morphism * @xmath64 of @xmath53-weighted @xmath52-crystals is a map @xmath65 such that @xmath66 and for any @xmath55 and @xmath34 , @xmath67 and @xmath68 .",
    "an isomorphism of crystals is a morphism of crystals which is a bijection whose inverse bijection is also a morphism of crystals .",
    "if @xmath69 is the crystal base of the @xmath5-module @xmath70 for @xmath71 then the * tensor product * @xmath72 is a @xmath5-module with crystal base denoted @xmath73 .",
    "its vertex set is just the cartesian product @xmath74 .",
    "its edges are given in terms of those of @xmath75 and @xmath76 as follows .",
    "we use the opposite of kashiwara s tensor product convention .",
    "one has @xmath77 and @xmath78 where the result is declared to be @xmath59 if either of its tensor factors are .",
    "the tensor product construction is associative up to isomorphism .",
    "define @xmath79 by @xmath80    every irreducible integrable finite - dimensional @xmath19-module is a highest weight module with some highest weight @xmath81 ; denote its crystal graph by @xmath82 .",
    "it is a @xmath53-weighted @xmath33-crystal with a unique classical highest weight vector .",
    "a * classical component * of the crystal graph @xmath51 of a @xmath5-module is a connected component of the graph obtained by removing all @xmath83-arrows from @xmath51 .",
    "the vertex @xmath55 is a * classical highest weight vector * if @xmath84 for all @xmath85 .",
    "each classical component of a @xmath5-module has a unique classical highest weight vector .",
    "let @xmath86 be the category of * finite * crystals as defined in @xcite .",
    "every @xmath87 has the following properties .    1 .",
    "@xmath51 is the crystal base of an irreducible @xmath5-module and is therefore connected . 2 .",
    "there is a weight @xmath88 such that there is a unique @xmath89 with @xmath90 and for all @xmath55 , @xmath91 is in the convex hull of @xmath92 .",
    "@xmath86 is a tensor category @xcite . if @xmath93 then @xmath94 is connected and @xmath95 . due to the existence of the universal @xmath96-matrix for @xmath15",
    "it follows from @xcite that :    1 .   there is a unique @xmath5-crystal isomorphism @xmath97 called the * combinatorial @xmath96-matrix*. 2 .",
    "there is a unique function ( the * local coenergy * ) @xmath98 that is constant on classical components , zero on @xmath99 , and is such that if @xmath100 then @xmath101    the combinatorial @xmath96-matrices satisfy @xmath102 and the yang baxter equation , the equality of isomorphisms @xmath103 given by @xmath104 we shall abuse notation and write @xmath105 ( resp .",
    "@xmath106 ) to denote the application of an appropriate combinatorial @xmath96-matrix ( resp . local coenergy function ) on the @xmath107-th and @xmath108-th tensor factors _ from the right_. then reads @xmath109 .",
    "one has the following identities on a three - fold tensor product : @xmath110    [ pp : hbraided ] @xcite let @xmath111 and @xmath112 .    1 .",
    "@xmath113 is equal to any composition of @xmath96-matrices of the form @xmath114 which shuffle the @xmath69 to the right , past the @xmath115 .",
    "2 .   for @xmath116 ,",
    "the value of @xmath117 is the sum of the values @xmath118 evaluated at the pairs of elements in @xmath119 that must be switched by an @xmath96-matrix @xmath120 in the computation of @xmath121 .",
    "we work with two categories of crystals .",
    "let @xmath11 be of nonexceptional affine type .",
    "the kr modules @xmath124 and their crystal bases @xmath125 were constructed in @xcite .",
    "see also @xcite for an explicit description of @xmath126 .",
    "let @xmath122 be the category of tensor products of kr crystals of the form @xmath126 .",
    "one has that @xmath127 .",
    "the crystal @xmath126 has the @xmath19-decomposition @xmath128 in particular @xmath129 is the unique vector of weight @xmath130 in @xmath126 .    let @xmath123 be the category of all tensor products of kr crystals @xmath4 in type @xmath12 . here",
    "so @xmath132 is the unique vector in @xmath4 of weight @xmath133 .",
    "@xmath4 consists of the semistandard young tableaux of shape given by an @xmath134 rectangle , with entries in the set @xmath135 @xcite .",
    "the structure of @xmath4 as an affine crystal was given explicitly in @xcite .",
    "we fix some notation for @xmath136 or @xmath137 .",
    "let @xmath138 where recall that @xmath139 is the set of dynkin nodes for @xmath14 .",
    "the multiplicity array of @xmath51 is the array @xmath140 such that @xmath141 is the number of times @xmath142 occurs as a tensor factor in @xmath51 for all @xmath143 . up to reordering of tensor factors",
    ".      for @xmath145 , say that @xmath146 is an * intrinsic coenergy * function for @xmath51 if @xmath147 , @xmath148 is constant on @xmath19-components , and @xmath149 a * graded crystal * is a pair @xmath150 where @xmath87 and @xmath148 is an intrinsic coenergy function on @xmath51 .",
    "we shall give each @xmath151 a particular graded crystal structure .",
    "for @xmath152 define @xmath153 one may verify that there is a unique element @xmath154 such that @xmath155 define the intrinsic coenergy function @xmath156 by @xmath157    [ ex : dkr ] @xmath158 has value @xmath7 on the @xmath7-th summand in .",
    "[ pp : tensor ] @xcite graded crystals form a tensor category as follows . if @xmath159 is a graded crystal for @xmath160 , then their tensor product @xmath111 is a graded crystal with @xmath161 where @xmath162 acts on the rightmost tensor factor .",
    "let @xmath150 be a graded crystal .",
    "for @xmath81 let @xmath163 be the set of classical highest weight vectors in @xmath51 of weight @xmath164 .",
    "define the one - dimensional sum @xmath165 recall that @xmath166 unless @xmath167 in which case @xmath168 .",
    "given a @xmath5-module @xmath2 with crystal base @xmath51 , the contragredient dual module @xmath169 has a crystal base @xmath170 such that @xmath171 for @xmath34 and @xmath55 such that @xmath172 .",
    "[ pp : dualtensor ] @xmath173    [ ex : duala ] assume type @xmath12 .",
    "we have @xmath174 the composite map @xmath175 is given explicitly as follows .",
    "let @xmath176 .",
    "replace each column of @xmath58 , viewed as a subset of @xmath135 of size @xmath7 , by the column of size @xmath177 given by its complement . then reverse the order of the columns . for @xmath178 , @xmath179 , and @xmath180 , a tableau @xmath176 and its image in @xmath181",
    "are given below : @xmath182    [ ex : dualarow ] by definition @xmath183 is defined by replacing each element of @xmath184 by an element @xmath185 and reversing arrows .",
    "@xmath186 can be realized by the weakly increasing words of length @xmath8 in the alphabet @xmath187 .",
    "the arrow - reversing map from @xmath126 to @xmath188 is given by taking a word of length @xmath8 , replacing each symbol @xmath54 with @xmath189 , and reversing .",
    "let @xmath190 be an automorphism of the dynkin diagram of @xmath11 .",
    "this induces isometries @xmath191 and @xmath192 given by @xmath193 for @xmath34 , @xmath194 , and @xmath195 for @xmath85 .",
    "if @xmath2 is a @xmath5-module with crystal base @xmath51 , then by carrying out the construction of @xmath2 but with @xmath54 replaced everywhere by @xmath196 , there is a @xmath5-module @xmath197 with crystal base @xmath198 and a bijection @xmath199 such that @xmath200 for all @xmath55 and @xmath34 .",
    "in particular , if the appropriate kr modules have been constructed then @xmath201      we fix a canonical dynkin automorphism @xmath202 of the affine dynkin diagram in the following manner .",
    "there is a length - preserving involution on @xmath50 given by conjugation by the longest element @xmath203 . restricting this involution to elements of length one ,",
    "one obtains an involution @xmath202 on the set of simple reflections @xmath204 of @xmath50 . for simplicity of notation",
    "this can be written as an involution on the index set @xmath33 .",
    "this gives an automorphism of the dynkin diagram of @xmath202 .",
    "call the resulting dynkin automorphism @xmath202 .",
    "explicitly , @xmath202 is the identity except when @xmath205 where @xmath202 exchanges @xmath54 and @xmath206 , and @xmath207 with @xmath208 odd , where @xmath202 exchanges @xmath209 and @xmath208 and fixes all other dynkin nodes .",
    "@xmath202 may be extended to the dynkin diagram of @xmath11 by fixing the @xmath83 node .",
    "it satisfies @xmath210 for all @xmath34 .",
    "the automorphism @xmath202 induces the following action on the weight lattice @xmath211 : @xmath212 one may show that this is equivalent to @xmath213 in particular @xmath214      let @xmath2 be a @xmath5-module with crystal base @xmath51 . with @xmath202 as above , define the module @xmath215 it has crystal base @xmath216 , with elements @xmath217 for @xmath55 such that @xmath218 and @xmath219 for all @xmath34 .",
    "[ rem : starcomp ] by for @xmath220 it follows that the map @xmath20 sends classical components of @xmath51 to classical components of @xmath216 , which by must have the same classical highest weight .",
    "[ pp : star ] @xmath221 with @xmath222 .",
    "[ conj : crystalstar ] let @xmath223 .",
    "then there is a unique involution @xmath224 such that and hold .",
    "uniqueness follows from the connectedness of @xmath51 and the fact that @xmath225 is the unique vector in @xmath51 of its weight .",
    "[ rem : rstar ] the crystals satisfying conjecture [ conj : crystalstar ] form a tensor category . given involutions @xmath20 on @xmath75 and @xmath76 satisfying conjecture [ conj : crystalstar ] , define @xmath20 on @xmath226 by @xmath227 .",
    "[ rem : starclass ] for @xmath81 define the involution @xmath20 on @xmath82 to be the unique map that sends the highest weight vector @xmath228 to the lowest weight vector ( the unique vector of weight @xmath229 ) and satisfies for @xmath85 . by it follows that @xmath230 for all @xmath231 .",
    "explicitly , the involution @xmath20 on the @xmath19-crystal @xmath232 is given by @xmath233 & & i&\\leftrightarrow \\bar{i }   \\\\ & & { \\circ}&\\leftrightarrow{\\circ}\\end{aligned}\\ ] ] except for @xmath233 \\text{${\\overline{{\\mathfrak{g}}}}=a_{n-1}$ : } & & i&\\leftrightarrow n+1-i \\\\ \\text{${\\overline{{\\mathfrak{g}}}}=d_n$ , $ n$ odd : } & & n&\\leftrightarrow n \\qquad \\bar{n}\\leftrightarrow\\bar{n}. \\end{aligned}\\ ] ] here we use that the crystal of @xmath232 has underlying set  @xcite @xmath234      we wish to determine the map @xmath20 of conjecture [ conj : crystalstar ] explicitly for @xmath235 and @xmath236 . the map @xmath237 must stabilize classical components by remark [ rem : starcomp ] and the multiplicity - freeness of @xmath126 as a classical crystal .",
    "on each classical component @xmath238 of @xmath126 , @xmath20 is uniquely defined by remark [ rem : starclass ] .",
    "using the @xmath19-embedding @xmath239 and proposition [ pp : star ] , we have @xmath240 . for @xmath241 and @xmath176",
    ", @xmath217 is the tableau obtained by replacing every entry @xmath242 of @xmath58 by @xmath243 and then rotating by 180 degrees .",
    "the resulting tableau is sometimes called the * antitableau * of @xmath58 .    for type @xmath244",
    "we have @xmath245 for type @xmath246 @xmath247    [ pp : srstar ] with @xmath20 defined as above , conjecture [ conj : crystalstar ] holds for @xmath248 and @xmath241 .",
    "[ rem : star ] from now on the notation @xmath20 will only be used in the following way .",
    "let @xmath111 be a tensor product of factors @xmath249 .",
    "since @xmath20 may be regarded as an involution on @xmath126 , by proposition [ pp : star ] we may write @xmath250 for the * reversed * tensor product .",
    "then @xmath251 is defined by @xmath252 .",
    "[ pp : r * ] let @xmath105 be the @xmath96-matrix acting at the @xmath253 and @xmath254 tensor positions from the right . on an @xmath255-fold tensor product of crystals of the form @xmath126 , @xmath256 for @xmath257 .",
    "one may reduce to the case @xmath258 .",
    "since @xmath73 is connected , @xmath96 is an isomorphism , and since holds , it suffices to check on @xmath259 . but",
    "this holds by weight considerations .",
    "we review the virtual crystal construction @xcite .",
    "this allows one to reduce the study of affine crystal graphs to those of simply - laced type .",
    "any affine algebra @xmath11 of type @xmath1 can be embedded into a simply - laced affine algebra @xmath22 of type @xmath260 @xcite . for @xmath11 nonexceptional",
    "the embeddings are listed below .",
    "the notation @xmath261 and @xmath262 is used for two different vertex labelings of the same dynkin diagram , in which @xmath263 is respectively the extra short and extra long root .",
    "let @xmath265 be the following automorphism of the dynkin diagram of @xmath260",
    ". for @xmath266 , @xmath267 ( mod @xmath268 ) . for type @xmath269 , @xmath265 exchanges the nodes @xmath208 and @xmath270 and fixes all others .",
    "let @xmath271 and @xmath272 be the vertex sets of the diagrams @xmath1 and @xmath260 respectively , @xmath273 the set of orbits of the action of @xmath265 on @xmath272 , and @xmath274 a bijection which preserves edges and sends @xmath83 to @xmath83 .    if @xmath275 , then @xmath276 , @xmath277 for @xmath278 and @xmath279 .    if @xmath280 , then @xmath281 for @xmath282 and @xmath283 .      for @xmath284",
    "define @xmath285 as follows .    1 .",
    "let @xmath280 .",
    "1 .   suppose the arrow points towards the component of @xmath83 .",
    "then @xmath286 for all @xmath284 .",
    "2 .   suppose the arrow points away from the component of @xmath83 .",
    "then @xmath285 is the order of @xmath265 for @xmath54 in the component of @xmath83 and is @xmath287 otherwise .",
    "2 .   let @xmath275 .",
    "then @xmath286 for @xmath288 . for @xmath289 , @xmath290 ( which is the order of @xmath265 ) if the arrow incident to @xmath54 points away from it and is @xmath287 otherwise .    for @xmath291 and @xmath280",
    "we have @xmath290 if @xmath292 and @xmath293 . for @xmath294 and @xmath280",
    "we have @xmath286 for all @xmath54 .",
    "the embedding @xmath295 of weight lattices is defined by @xmath296 as a consequence we have @xmath297      fix an embedding @xmath298 in .",
    "let @xmath299 be a @xmath260-crystal .",
    "for @xmath284 define the virtual crystal operators @xmath300 on @xmath299 , as the composites of @xmath260-crystal operators @xmath301 given by @xmath302    a * virtual crystal * ( aligned in the sense of @xcite ) is an injection @xmath303 from an @xmath1-crystal @xmath51 to a @xmath260-crystal @xmath299 such that :    1 .   for all @xmath55 , @xmath284 , and @xmath304 , @xmath305 and @xmath306 .",
    "2 .   @xmath307 and @xmath308 for all @xmath309 .    a virtual",
    "crystal realizes the @xmath1-crystal @xmath51 as the subset of the @xmath260-crystal @xmath299 given by its image under @xmath310 , equipped with the virtual kashiwara operators @xmath311 and @xmath312 .    a morphism @xmath313 of virtual crystals @xmath314 and @xmath315 consists of a morphism @xmath316 of @xmath1-crystals and a morphism @xmath317 of @xmath260-crystals , such that the diagram commutes : @xmath318 an isomorphism @xmath313 of virtual crystals is a morphism @xmath319 such that @xmath320 ( resp .",
    "@xmath321 ) is an isomorphism of @xmath1- ( resp .",
    "@xmath260- ) crystals .",
    "let @xmath303 and @xmath315 be virtual crystals .",
    "it is straightforward to verify that @xmath322 is a virtual crystal .",
    "virtual crystals form a tensor category @xcite .",
    "we recall from @xcite the virtual crystal construction of @xmath323 for @xmath11 of nonexceptional affine type .",
    "let @xmath324 be given by @xmath325    [ th : v ] @xcite there is a unique virtual crystal @xmath326 such that @xmath327 .",
    "let @xmath328 and @xmath329 .",
    "then @xmath330 . let @xmath331 . then @xmath332 and @xmath333 . furthermore @xmath334      [ pp : vr ] @xcite let @xmath335 be the composition of combinatorial @xmath96-matrices of type @xmath260",
    ". then the diagram commutes : @xmath336 that is , the pair @xmath337 is an isomorphism of virtual crystals @xmath338 and @xmath339 .",
    "[ pp : vh ] @xcite let @xmath314 and @xmath315 be virtual crystals where @xmath340 both of type @xmath1 .",
    "then @xmath341      [ pp : vd ] @xcite let @xmath136 be a crystal of type @xmath1 and @xmath303 the corresponding virtual crystal .",
    "then @xmath342      let @xmath136 be a crystal of type @xmath1 .",
    "let @xmath314 be the corresponding virtual crystal .",
    "for @xmath81 let @xmath343 be image under @xmath310 of the set @xmath163 .",
    "define the virtual x formula by @xmath344    [ th : x = vx ] ( @xmath25 ) @xcite for @xmath11 of nonexceptional affine type @xmath1 and @xmath151 a crystal of type @xmath1 , one has @xmath345 .",
    "we believe that the following is true for any virtual crystal , namely , that up to @xmath96-matrices , @xmath310 takes the @xmath20 involution of type @xmath1 to the @xmath20 involution of type @xmath260 .",
    "[ pp:*emb ] let @xmath235 and let @xmath346 be a virtual crystal .",
    "then the following diagram commutes , where @xmath347 is either a composition of @xmath96-matrices or the identity : @xmath348    note that for the non - simply - laced types @xmath1 the dynkin involution @xmath349 is the identity .",
    "the virtual raising and lowering operators are invariant under @xmath350 .",
    "it is therefore sufficient to check the above commutation on @xmath351 , where @xmath352 is the set of classical highest weight vectors in @xmath126 . but @xmath126 and @xmath324 are multiplicity - free as a classical crystals and @xmath20 stabilizes classical components and modifies the weight of a crystal element by applying @xmath21 .",
    "the following are equivalent :    1 .",
    "@xmath353 is a classical lowest weight vector and @xmath354 .",
    "2 .   @xmath355 and @xmath356 .",
    "3 .   @xmath351 and @xmath357 .",
    "4 .   @xmath358 is a classical lowest weight vector and @xmath359 .",
    "5 .   @xmath360 is a classical lowest weight vector and @xmath361 .",
    "one may verify that @xmath362 using linearity , to reduce to the case @xmath363 for @xmath220 .",
    "it follows that @xmath364 and @xmath360 are classical lowest weight vectors in @xmath324 of the same weight .",
    "but then they must be equal .",
    "let @xmath11 be of nonexceptional affine type .",
    "we define a family of @xmath19-crystal embeddings which is well - behaved with respect to intrinsic coenergy . they are denoted @xmath365 which stands for  right - split \" , because when @xmath366 , the map splits off the rightmost column of an element in @xmath4 .",
    "[ conj : split ] let @xmath367 .",
    "suppose @xmath368 is a set of kr crystals whose modules have been constructed , which contains @xmath4 for a particular @xmath369 and all @xmath370 .",
    "then there is an injective @xmath19-crystal morphism @xmath371 such that for any crystal @xmath51 which is the tensor product of crystals in @xmath368 , the map @xmath372 is an injective @xmath19-crystal morphism which preserves intrinsic coenergy .",
    "[ th : asplit ] conjecture [ conj : split ] holds for @xmath373 for all @xmath369 and the set @xmath368 of all kr crystals .",
    "this follows from @xcite .",
    "[ th : splitrow ] conjecture [ conj : split ] holds for any nonexceptional affine algebra @xmath11 for @xmath374 and @xmath368 the set of kr crystals of the form @xmath3 .",
    "the proof of theorem [ th : splitrow ] occupies the remainder of this section .",
    "this paper only requires the case @xmath366 for the map @xmath375 . except for type @xmath12 only the case @xmath374 is needed . for @xmath376 define the map @xmath377 as follows . for types @xmath12 , @xmath16 , @xmath378 , and @xmath379 ,",
    "define @xmath380 by @xmath381 for @xmath382 and @xmath383 such that @xmath384 . for the other types , in addition to the above rules we have @xmath385 for @xmath386 , and @xmath387 . for",
    "@xmath241 and @xmath176 , let @xmath388 , where @xmath389 is the rightmost column of the rectangular tableau @xmath58 and @xmath390 is the rest of @xmath58 .",
    "[ rem : rs ] suppose @xmath391 . here",
    "@xmath374 for @xmath122 . for @xmath392 ( or @xmath123 ) we write @xmath375 for the map @xmath393 on @xmath394 and write @xmath395 .      @xmath373 is covered by theorem [ th : asplit ] .",
    "the other simply - laced nonexceptional family is @xmath396 .",
    "it is straightforward to check directly using the explicit description of @xmath126 in @xcite that @xmath375 is an injective @xmath19-crystal morphism .",
    "let @xmath51 be the tensor product of crystals in @xmath368 .",
    "to check that @xmath397 preserves intrinsic coenergy , by it suffices to check this property for @xmath51 the trivial crystal and for @xmath398 . since @xmath399 is a @xmath19-crystal morphism , it is sufficient to prove that intrinsic coenergy is preserved for classical highest weight vectors .",
    "suppose @xmath51 is trivial .",
    "by @xmath126 has a single classical highest weight vector , namely , @xmath400 .",
    "by example [ ex : dkr ] @xmath401 .",
    "on the other hand @xmath402 so its intrinsic energy is also zero . for @xmath398",
    "we require the following lemma , which is easily verified directly .",
    "[ lem : d2p ] for @xmath396 and @xmath403 , @xmath404 consists of the elements @xmath405 where @xmath406 .",
    "in particular @xmath407 is multiplicity - free as a @xmath408-crystal .",
    "recall that @xmath409 and @xmath158 are identically zero by example [ ex : dkr ] . by and",
    "explicit calculation , @xmath410 since @xmath96 is a @xmath411-crystal isomorphism , lemma [ lem : d2p ] implies that @xmath412 we compute @xmath413 on @xmath414 using proposition [ pp : hbraided ] .",
    "we have @xmath415 by we have @xmath416 by we have @xmath417 , @xmath418 , and @xmath419 .",
    "it follows in any case that @xmath420 preserves intrinsic coenergy .",
    "suppose @xmath11 is not simply - laced .",
    "let @xmath421 be as in .",
    "it is not hard to show that @xmath422 is a @xmath19-crystal injection . to show that the map preserves intrinsic coenergy ( and",
    "thereby complete the proof of theorem [ th : splitrow ] ) , by proposition [ pp : vd ] the following result suffices .",
    "[ pp : vrs ] there is an injective @xmath423-crystal map @xmath424 such that :    1 .",
    "[ it : vrsdiag ] the following diagram commutes : @xmath425 2 .",
    "[ it : vd ] for any @xmath151 , let @xmath314 be its virtual crystal embedding .",
    "then @xmath426 preserves intrinsic coenergy .",
    "[ it : vres ] if @xmath427 and @xmath428 then @xmath429 .",
    "suppose first that @xmath275",
    ". then @xmath430 .",
    "define the map @xmath431 by the composition @xmath432 here @xmath433 where @xmath434 , @xmath435 and @xmath436 .",
    "note that is a composition of combinatorial @xmath96-matrices and @xmath375 maps for type @xmath437 .",
    "point [ it : vd ] holds by theorem [ th : asplit ] .",
    "one need only verify [ it : vrsdiag ] on classical highest weight vectors , by the definition of @xmath438 and the fact that @xmath439 and @xmath440 ( resp .",
    "@xmath422 ) are morphisms of @xmath441- ( resp .",
    "@xmath442- ) crystals .",
    "let @xmath443 .",
    "the classical highest weight vectors in @xmath444 have the form @xmath445 for @xmath446 ; if @xmath11 is @xmath447 or @xmath262 then @xmath448 must also be even .",
    "for @xmath449 the element @xmath450 is sent to the following elements under the maps in : @xmath451 where the intermediate results under the maps in are given by @xmath452 , @xmath453 , @xmath454 , and @xmath455 .    under the maps in ,",
    "the element @xmath456 is sent to @xmath457 with intermediate values in given by @xmath458 , @xmath459 , @xmath460 , and @xmath461 .",
    "since these are all the possible classical highest weight vectors , point [ it : vrsdiag ] follows .    for point",
    "[ it : vres ] , let @xmath427 and @xmath462 . without loss of generality",
    "we may assume that @xmath463 since @xmath464 is a @xmath441-morphism .",
    "now @xmath465 must have the form @xmath466 for @xmath446 . by computations similar to those above , @xmath467 if @xmath449 and @xmath468 if @xmath469 .",
    "but @xmath462 means that @xmath470 if @xmath449 and @xmath471 if @xmath469 . the parity condition for this to occur implies the parity condition that guarantees that @xmath472 .",
    "suppose next that @xmath280 and @xmath294",
    ". then @xmath473 .",
    "define @xmath474 .",
    "point [ it : vd ] follows by the simply - laced @xmath16 case .",
    "point [ it : vres ] is trivial . for point",
    "[ it : vrsdiag ] it is enough to consider elements of @xmath475 . under the maps in , @xmath476 goes to @xmath477 and commutes .",
    "suppose that @xmath280 and @xmath291",
    ". then @xmath330 .",
    "define @xmath478 by @xmath479 where @xmath480 , @xmath481 , and @xmath482 .",
    "this map is clearly injective and @xmath441-equivariant .",
    "point [ it : vres ] is obvious . for point",
    "[ it : vrsdiag ] it is enough to consider the unique element @xmath483 . under @xmath476 goes to @xmath484 so that commutes . for point",
    "[ it : vd ] define @xmath485 by the composite map @xmath486 since @xmath487 is the composition of @xmath439 maps and @xmath96-matrices , it preserves intrinsic coenergy by the simply - laced case .",
    "it suffices to show that @xmath488^{{\\widehat{{\\mathrm{rs } } } } } \\ar[dr]^{{\\widehat{{\\mathrm{rs } } } } ' } & \\\\    { } & { b_y^{2s-2 } \\otimes b_y^1 \\otimes b_y^1 } \\\\",
    "{ b_y^{2s-2 } \\otimes b_y^2 } \\ar[ur]_{1\\otimes { \\mathrm{rs}}_y } & } \\ ] ] commutes since @xmath487 and @xmath489 both preserve intrinsic coenergy .",
    "it suffices to check this for the lone classical highest weight vector @xmath490 .",
    "clearly @xmath491 , while @xmath492 and this is sent by @xmath493 to @xmath494 , as desired .",
    "we define dual analogues of the intrinsic coenergy @xmath148 and right splitting .      for @xmath248 define @xmath495 . for @xmath241 , define @xmath496 .",
    "if @xmath497 ( or @xmath123 ) and @xmath111 are such that @xmath498 are given , then define @xmath499 with @xmath500 acting on the leftmost tensor position .",
    "this is a different associative tensor product on graded crystals than the one given in subsection [ ss : d ] .",
    "recall the notation @xmath216 of remark [ rem : star ] .",
    "[ pp : tail ] let @xmath136 ( or @xmath501 ) and @xmath55",
    ". then @xmath502 .    for @xmath51 a single kr crystal ,",
    "the result follows from the fact that the involution @xmath20 on @xmath51 stabilizes classical components . by proposition [ pp : r * ] and comparing with it suffices to show that @xmath503 for @xmath504 kr crystals .",
    "since @xmath73 is connected , the proof may proceed by induction on the number of steps ( either of the form @xmath505 or @xmath506 ) in @xmath73 from @xmath259 to @xmath58 .",
    "suppose first that @xmath507 . by the definition of @xmath225 in subsection [ ss : fin ] , @xmath508 ( and",
    "therefore @xmath509 contain a unique classical component isomorphic to @xmath82 where @xmath510 .",
    "and @xmath82 contains a unique vector of the extremal weight @xmath511 . since @xmath230 it follows that @xmath217 and @xmath512 are in the same classical component , so that @xmath513 by the definition of @xmath514 .",
    "now suppose @xmath515 where @xmath242 is closer to @xmath259 than @xmath58 is . if @xmath516 then we are done since both sides of do not change under passing from @xmath242 to @xmath58 , by the definition of @xmath514 and .",
    "so assume @xmath517 .",
    "by @xmath518 .",
    "but then one may conclude the validity of for @xmath58 from that of @xmath242 using rules for the kashiwara operators on the tensor product and .",
    "define @xmath519 just like the one - dimensional sum @xmath1 but use @xmath520 instead of @xmath521 .",
    "proposition [ pp : tail ] has this corollary .",
    "@xmath522 .",
    "whenever the right splitting map @xmath523 is defined , we may define the left - splitting map @xmath524 by the commutation of the diagram @xmath525 in particular , it is defined for @xmath248 and @xmath526 .",
    "[ cor : lsplitdef ] here @xmath374 for the category @xmath122 .",
    "@xmath527 is a @xmath19-crystal embedding such that , for any @xmath392 ( or @xmath123 ) and for any @xmath136 ( or @xmath123 ) , the map @xmath528 is injective and preserves @xmath529 .",
    "@xmath527 is a @xmath19-crystal embedding since @xmath375 is , by theorem [ th : splitrow ] , the definition of @xmath20 and . for the preservation of @xmath529 ,",
    "let @xmath530 .",
    "we have @xmath531 by proposition [ pp : tail ] and .",
    "[ rem : splitnote ] suppose @xmath391 . here",
    "@xmath374 for @xmath122 as usual . for @xmath392 ( or @xmath123 ) we write @xmath527 for the map @xmath532 on @xmath533 . also we write @xmath534 .",
    "[ lem : lsplitrow ] for @xmath248 the map @xmath535 is given explicitly by @xmath536 for @xmath382 and @xmath383 such that @xmath537 , @xmath538 for @xmath539 , @xmath540 . for @xmath241 and @xmath541 , @xmath542 where @xmath390 is",
    "the leftmost column in the @xmath134 semistandard tableau @xmath58 and @xmath389 is the rest of @xmath58 .",
    "let @xmath543 with @xmath544 .",
    "there is a @xmath19-crystal embedding @xmath545 given by @xmath546 where @xmath390 is the bottommost entry in the column tableau @xmath58 of height @xmath7 , and @xmath389 is the remainder of @xmath58 . there is a @xmath19-crystal embedding @xmath547 given by @xmath548 where @xmath389 is the topmost entry in the column @xmath58 and @xmath390 is the rest of @xmath58 .",
    "the map @xmath549 is only used to define the path - rc bijection for @xmath137 in section  [ sec : bij ] .",
    "in general the morphism @xmath550 does not preserve intrinsic coenergy , but another grading called intrinsic energy .",
    "it was proved in @xcite that the path - rc bijection preserves the grading for @xmath123 using a different method , namely , the rank - level duality for type @xmath551 .",
    "define the (  left - hat \" ) map @xmath552 by @xmath553 .",
    "it just removes the left tensor factor .",
    "define the ",
    "right - hat \" map @xmath554 by @xmath555 .",
    "it is immediate that the following diagram commutes : @xmath556    let @xmath557 be the set of classical highest weight vectors in @xmath51 , or equivalently , the set of classical components of @xmath51 .",
    "[ lem : hwvhat ] the maps @xmath552 and @xmath558 induce maps @xmath559 and @xmath560 .",
    "if @xmath561 is a classical highest weight vector of @xmath73 then by the definitions , @xmath389 is a classical highest weight vector of @xmath75 . thus @xmath562 is well - defined on components .    for @xmath563",
    "we work with classical components . by the map @xmath20",
    "takes classical components to classical components .",
    "but then @xmath563 is well - defined on components since @xmath562 is , by .",
    "let @xmath564 of type @xmath565 .",
    "then @xmath566 and @xmath567 .",
    "the induced map on highest weight vectors yields @xmath568    one has the commutation of induced maps on classical highest weight vectors : @xmath569    [ rem : hatnote ] from now on , unless explicitly indicated otherwise , we only consider the map @xmath562 ( resp .",
    "@xmath563 ) on tensor products whose left ( resp .",
    "right ) factor is @xmath570 . in these cases",
    ", we use the notation @xmath571 and @xmath572 .    for @xmath81 let @xmath573 where @xmath570 is regarded as a @xmath19-crystal by restriction .    by lemma",
    "[ lem : hwvhat ] there are well - defined bijections @xmath574 except in the case @xmath575 .",
    "note that @xmath570 has at most one vector of each weight except when @xmath575 , which has two vectors @xmath83 and @xmath576 of weight @xmath83 .",
    "if @xmath577 , then there can be elements @xmath578 such that both @xmath579 and @xmath580 are in @xmath163 .",
    "if so , then the right hand side of must be modified to include two copies of @xmath58 , one coming from @xmath580 and the other from @xmath579 .",
    "there is no analogous problem for @xmath563 since @xmath581 .",
    "[ pp : cryscomm ]",
    "let @xmath582 for @xmath122 .    1 .",
    "[ pt : lhrh ] @xmath583=0 $ ] on @xmath584 .",
    "[ pt : lhrs ] @xmath585=0 $ ] on @xmath586 for @xmath376 .",
    "[ pt : rhls ] @xmath587=0 $ ] on @xmath588 for @xmath376 .",
    "[ pt : lsrs ] @xmath589=0 $ ] on @xmath590 for @xmath591 .",
    "[ pt : hat * ] @xmath592 on @xmath593 .",
    "moreover , these commutations also hold for the induced maps on sets of classical highest weight vectors .",
    "the operators on the entire crystals commute more or less by definition .",
    "we now prove that these identities hold for the induced maps between sets of classical highest weight vectors .",
    "the proof is again trivial except for cases involving @xmath563 .",
    "point [ pt : lhrh ] follows from lemma [ lem : hwvhat ] .",
    "point [ pt : rhls ] follows from lemma [ lem : hwvhat ] and the @xmath19-equivariance of @xmath527 given in corollary [ cor : lsplitdef ] .",
    "finally , point [ pt : hat * ] follows from lemma [ lem : hwvhat ] and the fact that the map @xmath20 respects classical raising and lowering operators .",
    "we need to know precisely how the highest weights change when passing from an element of @xmath594 to @xmath557 via either @xmath595 or @xmath596 . in this section",
    "we assume type @xmath597 .",
    "the answer is given by van leeuwen @xcite .",
    "we translate his answer into the language of partitions .",
    "let @xmath211 be the set of dominant weights that can occur in a tensor product of crystals of the form @xmath232 .",
    "a dominant weight @xmath598 is in @xmath211 if and only if @xmath599 and @xmath600 have the same parity .",
    "we put a graph structure on @xmath211 by declaring that weights @xmath164 and @xmath601 are adjacent if there is an element @xmath602 such that @xmath603 .",
    "we realize @xmath211 as a subset of @xmath604 by letting @xmath605 for @xmath606 , @xmath607 and @xmath608 . as such @xmath211",
    "is given by the tuples @xmath609 with @xmath610 .",
    "we modify this notation slightly in order to use partitions .",
    "let @xmath260 be the lattice of partitions @xmath611 with at most @xmath208 parts . a graph structure on @xmath260",
    "is given by declaring that two partitions are connected with an edge if their partition diagrams differ by one cell .",
    "define the graph @xmath612 by glueing two copies @xmath613 and @xmath614 of @xmath260 together such that , if @xmath615 is such that @xmath616 , then @xmath617 and @xmath618 are identified .",
    "then @xmath619 where the weight @xmath620 is identified with the partition @xmath621 if @xmath622 , with the  positive \" partition @xmath623 if @xmath624 , and with the  negative \" partition @xmath625 if @xmath626 .",
    "let @xmath601 and @xmath164 be adjacent in @xmath211 , and @xmath602 such that @xmath603 .",
    "we think of this as walking from @xmath601 to @xmath164 by the step @xmath627 . in terms of partitions ,",
    "if @xmath628 for @xmath629 then a cell is added to the @xmath54-th row . if @xmath630 for @xmath288 then a cell is removed from the @xmath54-th row . if @xmath631 then the above rules hold provided that @xmath632 . if @xmath633 then the roles of @xmath208 and @xmath634 are reversed .",
    "let @xmath635 .",
    "let @xmath636 with @xmath637 .",
    "in the usual way , @xmath58 can be regarded as a path in the set of dominant weights : the @xmath54-th weight is given by the weight of @xmath638 . alternatively @xmath58 describes a walk in @xmath612 from the empty partition to the element of @xmath612 corresponding to the weight of @xmath58 .",
    "[ ex : path ] let @xmath639 .",
    "consider @xmath640 where @xmath641 .",
    "the element @xmath58 corresponds to the walk in @xmath612 given by    @xmath642    where the @xmath643 and @xmath644 markings on a partition indicate membership in @xmath613 and @xmath614 respectively .    in the following proposition , for weights @xmath645",
    ", we write @xmath646 if the corresponding elements of @xmath612 are both in @xmath613 or both in @xmath614 and the diagram of the partition associated with @xmath601 is contained in that of @xmath164 .",
    "[ pp : weight ] suppose @xmath647 , @xmath648 , @xmath649 and @xmath650 .",
    "then @xmath651 is uniquely determined by @xmath164 , @xmath652 , and @xmath653 .",
    "more precisely ,    1 .   if @xmath654 : 1 .   if the cells @xmath655 and @xmath656 are in different rows and different columns , then @xmath657 .",
    "if @xmath658 and @xmath656 are in the same row or in the same column , then @xmath659 .",
    "if @xmath660 : 1 .   if the cells @xmath661 and @xmath662 are in different rows and different columns , then @xmath663 .",
    "2 .   if @xmath664 and @xmath662 are in the same row or the same column , then @xmath659 .",
    "3 .   if @xmath665 and @xmath666 : 1 .   if @xmath667 then @xmath663 .",
    "2 .   if @xmath668 then @xmath657 .",
    "4 .   if @xmath669 : 1 .",
    "if @xmath668 : 1 .",
    "if @xmath661 is in the first column of @xmath164 : 1 .   if @xmath661 is in the @xmath208-th row , for @xmath670 let @xmath671 be the corresponding partition .",
    "2 .   otherwise let @xmath659 .",
    "@xmath672 and @xmath651 is obtained from @xmath164 by removing the corner cell in the column to the left of @xmath661 .",
    "2 .   if @xmath673 then @xmath651 is obtained from @xmath164 by adjoining a cell to the column to the right of @xmath658 .",
    "the rule for the weight @xmath651 is given by van leeuwen ( * ? ? ?",
    "* rule 4.1.1 ) : @xmath651 is the unique dominant element in the weyl group orbit of the weight @xmath674 . using this rule the proof is straightforward .",
    "[ rem : rhshape ] the two operations @xmath595 and @xmath596 define a pair of two - step walks in the graph @xmath612 from @xmath164 to @xmath653 , whose intermediate vertices are @xmath652 and @xmath651 respectively . if there is only one such walk then @xmath659",
    "; this occurs in cases ( 1b ) and ( 2b ) .",
    "if there are exactly two such walks then @xmath651 is always chosen to be the intermediate vertex not equal to @xmath652 ; this occurs in cases ( 1a ) , ( 2a ) , ( 3a ) , and ( 3b ) . in the case",
    "that @xmath669 there may be many such walks ; the proper choice of @xmath651 given @xmath652 is described in the proposition .",
    "let @xmath58 be as in example [ ex : path ] .",
    "then @xmath675 , @xmath676 , and @xmath677 .",
    "therefore @xmath164 is the weight @xmath678 or the partition @xmath679 , @xmath652 is the weight and partition @xmath680 , @xmath651 is the weight @xmath681 and the partition @xmath682 , and @xmath653 is the weight @xmath678 and the partition @xmath679 . since @xmath669 ( as elements of @xmath211 or @xmath612 ) and @xmath683 as partitions , case ( 4b ) applies .",
    "the cell @xmath658 is in the first column ; therefore @xmath651 should be obtained from @xmath653 by adjoining a cell at the end of the second column , which agrees with the example .",
    "in @xmath565 let @xmath684 .",
    "then @xmath685 , @xmath686 , @xmath687 .",
    "therefore @xmath688 , @xmath652 is the weight @xmath689 or the partition @xmath690 , @xmath691 , and @xmath651 is the weight @xmath692 or the partition @xmath693 .",
    "this is case ( 4a1a ) .",
    "in this section it is assumed that @xmath11 is nonexceptional and simply - laced , that is , @xmath373 or @xmath396 .",
    "let @xmath136 for type @xmath16 and @xmath501 for type @xmath12 .",
    "recall the notation in subsection [ ss : tensorcats ] , where @xmath694 is the multiplicity array of @xmath51 .",
    "the sequence of partitions @xmath695 is a * @xmath696-configuration * if @xmath697 where @xmath698 is the number of parts of length @xmath54 in partition @xmath699 .",
    "a @xmath696-configuration is * admissible * if @xmath700 for all @xmath701 , where @xmath702 is the * vacancy number * @xmath703 here @xmath704 is the normalized invariant form on @xmath211 such that @xmath705 is the cartan matrix . let @xmath706 be the set of admissible @xmath696-configurations .",
    "a * rigged configuration * @xmath707 consists of a configuration @xmath708 together with a double sequence of partitions @xmath709 such that the partition @xmath710 is contained in a @xmath711 rectangle .",
    "the set of rigged configurations is denoted by @xmath712 .",
    "the partition @xmath710 is called * singular * if it has a part of size @xmath702 .",
    "the partition @xmath710 is called * cosingular * if it has a part of size zero , or equivalently , its complement in the rectangle of size @xmath711 has a part of size @xmath702 .",
    "it is often useful to view a rigged configuration @xmath707 as a sequence of partitions @xmath713 where the parts of size @xmath54 in @xmath699 are labeled by the parts of @xmath710 .",
    "the pair @xmath714 where @xmath54 is a part of @xmath699 and @xmath627 is a part of @xmath710 is called a * string * of the @xmath715-th rigged partition @xmath716 .",
    "the label @xmath627 is called a * rigging * or * quantum number*. the corresponding * coquantum number * is @xmath717 .",
    "[ ex : rc ] let @xmath718 , @xmath719 and @xmath720 .",
    "then the following three sequences of partitions are admissible @xmath696-configurations @xmath721 & \\yngrc(2,1,2,1,1,0,1,0 ) \\quad \\yngrc(2,0,2,0,1,0,1,0 )    \\quad \\yngrc(2,0,1,0 ) \\quad \\yngrc(2,0,1,0)\\\\[2 mm ] & \\yngrc(3,2,3,2 ) \\quad \\yngrc(3,0,3,0 ) \\quad \\yngrc(3,0 ) \\quad \\yngrc(3,0)\\end{aligned}\\ ] ] where the corresponding vacancy numbers are written next to each part .",
    "hence , writing the parts of @xmath710 next to the parts of size @xmath54 of partition @xmath699 the following would be a particular rigged configuration @xmath722      let @xmath723 be the involution that preserves configurations and complements riggings with respect to the vacancy numbers . more precisely ,",
    "each partition @xmath710 is replaced by the partition that is complementary to it within the @xmath711 rectangle .",
    "suppose @xmath726 .",
    "let @xmath727 and @xmath728be obtained from @xmath255 by removing one tensor factor @xmath570 .",
    "in particular , if @xmath51 has @xmath570 as its left ( resp .",
    "right ) tensor factor , then @xmath727 ( resp .",
    "@xmath728 ) is the multiplicity array for @xmath729 ( resp .",
    "@xmath730 ) . in @xcite",
    "a quantum number bijection @xmath731 was defined when @xmath51 is a tensor power of @xmath570 .",
    "the key step in the definition of @xmath732 is an algorithm that defines a map @xmath733 .",
    "the same algorithm defines such a map for the current case .    for @xmath734 ,",
    "the algorithm produces a smaller rigged configuration @xmath735 for some @xmath736 and an element @xmath737 such that @xmath738    we recall the algorithm for @xmath724 explicitly for type @xmath12 and @xmath16 .",
    "although we do not use them here , the explicit algorithms exists for the other nonexceptional affine types and can be found in  @xcite .",
    "set @xmath739 and repeat the following process for @xmath740 or until stopped . find the smallest index @xmath741 such that @xmath710 is singular .",
    "if no such @xmath54 exists , set @xmath742 and stop . otherwise set @xmath743 and continue with @xmath744 .",
    "set @xmath739 and repeat the following process for @xmath745 or until stopped . find the smallest index @xmath746 such that @xmath710 is singular .",
    "if no such @xmath54 exists , set @xmath742 and stop . otherwise set @xmath743 and continue with @xmath744 . set all yet undefined @xmath747 to @xmath748 .",
    "if the process has not stopped at @xmath749 , find the minimal indices @xmath750 such that @xmath751 and @xmath752 are singular .",
    "if neither @xmath54 nor @xmath108 exist , set @xmath753 and stop .",
    "if @xmath54 exists , but not @xmath108 , set @xmath754 , @xmath755 and stop .",
    "if @xmath108 exists , but not @xmath54 , set @xmath756 , @xmath757 and stop .",
    "if both @xmath54 and @xmath108 exist , set @xmath754 , @xmath756 and continue with @xmath749 .",
    "now continue for @xmath758 or until stopped .",
    "find the minimal index @xmath759 where @xmath760 such that @xmath710 is singular ( if @xmath761 then there need to be two parts of size @xmath702 in @xmath710 )",
    ". if no such @xmath54 exists , set @xmath762 and stop .",
    "if the process did not stop , set @xmath763 . set all yet undefined @xmath747 and @xmath764 to @xmath748 .",
    "the rigged configuration @xmath765 is obtained by removing a box from the selected strings and making the new strings singular again . explicitly ( ignoring the statements about @xmath764 for type @xmath12 ) @xmath766 the partition @xmath767 is obtained from @xmath710 by removing a part of size @xmath768 for @xmath761 and @xmath769 , adding a part of size @xmath770 for @xmath771 and @xmath772 , and leaving it unchanged otherwise .    for the rigged configuration @xmath707 of example  [ ex : rc ]",
    ", we have @xmath773 with @xmath774 .",
    "the next proposition was proved in  @xcite .",
    "[ pp : boxbij ] the map @xmath775 is injective",
    ".    note that for simply - laced type , knowing @xmath164 and @xmath601 uniquely determines @xmath776 by .",
    "we may define the inverse of @xmath724 . to this end , let @xmath777 denote by @xmath778 the subset of @xmath779 given by @xmath780 such that @xmath781 . by abuse of notation",
    "define @xmath782 by the following algorithm , where @xmath783 is obtained from @xmath255 by replacing @xmath784 by @xmath785 .      in this case",
    "@xmath786 for some @xmath787 , where @xmath788 is the @xmath7-th canonical unit vector in @xmath789 . set @xmath790 and",
    "repeat the following process for @xmath791 . find the largest index @xmath792 such that @xmath710 is singular and set @xmath793 ; if no such @xmath54 exists set @xmath794 .",
    "set all undefined @xmath795 to infinity .      in this case @xmath786 or @xmath796 for @xmath797 , where @xmath788 is the @xmath7-th canonical unit vector in @xmath798 . in the first case proceed exactly as for type @xmath12 .",
    "throughout the whole algorithm , if an index @xmath54 does not exist , set @xmath517 .",
    "if @xmath799 , find the largest index @xmath54 such that @xmath800 is singular and set @xmath801 .",
    "find the largest index @xmath802 such that @xmath803 is singular and set @xmath804 .",
    "then proceed as in type @xmath12 .",
    "if @xmath805 , find the largest indices @xmath54 and @xmath108 such that @xmath751 and @xmath752 are singular and set @xmath806 and @xmath807 . then find the largest index @xmath808 such that @xmath803 is singular and set @xmath804 .",
    "after this proceed as in type @xmath12 .",
    "finally , if @xmath796 for @xmath809 , set @xmath810 and proceed for @xmath811 as follows .",
    "find the largest index @xmath812 such that @xmath710 is singular and set @xmath813 . then find the largest indices @xmath814 and @xmath815 such that @xmath751 and @xmath752 are singular and set @xmath806 and @xmath807 .",
    "after this proceed as for the case @xmath805 .",
    "set all yet undefined @xmath795 and @xmath816 to @xmath748 .      the rigged configuration @xmath817 is obtained by adding a box to the selected strings and making the new strings singular again .",
    "define @xmath818 by @xmath819 .",
    "alternatively , @xmath725 is defined by a coquantum number version of the map @xmath724 . instead of selecting singular strings",
    "it selects cosingular strings and keeps coquantum numbers constant for unselected strings .",
    "it also produces an element @xmath820 .",
    "if @xmath734 and @xmath821 then @xmath822      let @xmath376 .",
    "suppose @xmath51 contains a distinguished tensor factor @xmath4 , which is the case when we consider the maps @xmath527 and @xmath375 .",
    "let @xmath255 be the multiplicity array of @xmath51 and @xmath823 that which is obtained from @xmath255 by replacing @xmath4 by @xmath824 and @xmath825 .",
    "[ pp : ljdef ] let @xmath255 be such that @xmath826 for a particular @xmath827 with @xmath376 and let @xmath823 be defined with respect to @xmath828 . then @xmath829 .",
    "under this inclusion map , the vacancy number @xmath702 for @xmath713 increases by @xmath830 where @xmath831 if @xmath211 is true and @xmath832 otherwise .",
    "hence there are well - defined injective maps @xmath833 given by :    1 .",
    "2 .   @xmath835 where @xmath836 is obtained from @xmath837 by adding @xmath287 to the rigging of each string in @xmath838 of length strictly less than @xmath8 .    in particular , @xmath839 preserves quantum numbers , @xmath840 preserves coquantum numbers , and @xmath841    immediate from the definitions .",
    "suppose @xmath544 and @xmath137 has a distinguished tensor factor @xmath824 .",
    "let @xmath255 be the multiplicity array for @xmath51 and @xmath842 that for the crystal obtained from @xmath51 by replacing @xmath824 by @xmath13 and @xmath843 .",
    "[ pp : rcbs ] let @xmath255 be such that @xmath844 for some @xmath544 .",
    "let @xmath842 be defined with respect to @xmath7 .",
    "then there are injections @xmath845 defined by adding singular ( resp .",
    "cosingular ) strings of length @xmath287 to @xmath716 for @xmath846 .",
    "moreover the vacancy numbers stay the same .",
    "in this section we state the fermionic formula @xmath2 associated with rigged configurations for simply - laced algebras as introduced in  @xcite and virtual fermionic formulas for nonsimply - laced algebras ( see @xcite ) .",
    "let @xmath847 and define the @xmath848-binomial coefficient for @xmath849 as @xmath850}{0pt}{}{m+p}{m}}=\\frac{(q)_{m+p}}{(q)_m(q)_p}.\\ ] ] the fermionic formula for types @xmath12 and @xmath16 is given by  @xcite @xmath851}{0pt}{}{m_i^{(a)}+p_i^{(a)}}{m_i^{(a)}}}\\ ] ] with @xmath698 , @xmath702 and @xmath706 as in section  [ sec : rc def ] and @xmath852 the fermionic formula can be restated solely in terms of rigged configurations . to this end recall",
    "that the @xmath848-binomial coefficient @xmath853}{0pt}{}{m+p}{m}}$ ] is the generating function of partitions in a box of width @xmath448 and height @xmath854 .",
    "hence @xmath855 where @xmath856 .",
    "fermionic formulae for nonsimply - laced algebras were defined in  ( * ? ? ?",
    "* section 4 ) .",
    "for @xmath262 it was defined in @xcite . here",
    "we recall virtual rigged configurations in analogy to virtual crystals as defined in  @xcite .",
    "[ def : vrc ] let @xmath1 and @xmath260 be as in section  [ ss : vx ] , and @xmath164 , @xmath51 and @xmath255 as in section [ sec : rc def ] for type @xmath1 .",
    "let @xmath857 be the corresponding virtual @xmath260-crystal and @xmath858 the multiplicity array corresponding to @xmath299 . for @xmath859",
    ", @xmath860 is the set of elements @xmath861 such that :    1 .   for all @xmath862 , @xmath863 and @xmath864 if @xmath715 and @xmath58 are in the same @xmath265-orbit in @xmath272 .",
    "2 .   for all @xmath862 , @xmath865 , and @xmath866",
    ", we have @xmath867 if @xmath868 and the parts of @xmath869 are multiples of @xmath870 .",
    "for @xmath871 the following changes must be made :    1 .",
    "@xmath872 may be positive for any @xmath873 .    for @xmath874 one",
    "makes the exception ( a2 ) and the additional condition that    1 .",
    "the parts of @xmath875 must have the same parity as @xmath54 .",
    "* theorem 4.2 ) [ th : m = vm ] there is a bijection @xmath876 sending @xmath877 given as follows . for all @xmath878 , @xmath879 , and @xmath880 , @xmath881 except when @xmath871 or @xmath874 and @xmath882 , in which case @xmath883 the cocharge changes by @xmath884 .    defining the virtual fermionic formula as @xmath885 we obtain as a corollary :    [ cor : m = vm ] ( @xmath27 ) @xmath886 .",
    "the following result defines the bijection from paths to rigged configurations .",
    "it is valid for both @xmath136 and @xmath501 .",
    "[ pp : phi ] there exists a unique family of bijections @xmath887 such that the empty path maps to the empty rigged configuration , and :    1 .",
    "suppose @xmath888 .",
    "let @xmath889 with multiplicity array @xmath727 .",
    "then the diagram @xmath890 commutes .",
    "2 .   suppose @xmath891 with @xmath391 ( and @xmath374 for @xmath122 ) .",
    "let @xmath892 with multiplicity array @xmath823 .",
    "then the following diagram commutes : @xmath893",
    "3 .   for @xmath123 ,",
    "suppose @xmath894 with @xmath544 .",
    "let @xmath895 and @xmath842 its multiplicity array .",
    "then the following diagram commutes : @xmath896    for type @xmath12 the existence of @xmath732 was proven in  @xcite . the proof in case ( 1 ) for other nonexceptional types is essentially done in  @xcite .",
    "it remains to prove case ( 2 ) for type @xmath16 .",
    "[ lem : resls ] let @xmath897 with @xmath391 . for type @xmath16 , the map @xmath898 restricts to a bijection @xmath899 .",
    "let @xmath900 and @xmath901",
    ". then @xmath902 if and only if @xmath903 .",
    "( note that this implies in particular that @xmath208 and @xmath904 can not appear in the same one - row crystal element ) .    by proposition  [ pp : ljdef ]",
    ", @xmath905 is in the image of @xmath839 if and only if @xmath906 has no singular strings of length smaller than @xmath8 .",
    "let us first show that if @xmath907 then @xmath908 .",
    "hence assume that @xmath909 with @xmath903 with @xmath910 as defined above .",
    "by induction @xmath911 has no singular strings in the first rigged partition of length smaller than @xmath912 .",
    "denote the lengths of the strings selected by @xmath724 associated with the letter @xmath910 by @xmath913 and @xmath914 .",
    "then in particular @xmath915 .",
    "`` unsplitting '' yields on the paths side @xmath916 and on the rigged configuration side @xmath917 with a change in the vacancy numbers by @xmath918 . since @xmath903 it follows that @xmath919 and @xmath920 , where @xmath921 and @xmath922 are the lengths of the strings selected by @xmath724 associated with @xmath627 .",
    "this shows in particular that @xmath923 , and from the change in vacancy numbers from @xmath924 to @xmath925 it follows that there are no singular strings in the first rigged partition of @xmath925 of length smaller than @xmath8 .",
    "conversely , assume that @xmath905 is in the image if @xmath839 .",
    "we need to show that then @xmath926 has the property that @xmath903 in the above notation .",
    "call the strings selected by @xmath724 in @xmath707 @xmath921 and @xmath922 . by assumption @xmath906",
    "has no singular string of length smaller than @xmath8 .",
    "hence @xmath923 . by the definition of @xmath839",
    ", we have that the first rigged partition of @xmath927 has no singular strings of length smaller than @xmath912 .",
    "hence @xmath928 , where @xmath913 and @xmath914 are the lengths of the strings selected by @xmath724 on @xmath917 .",
    "the algorithm of @xmath724 implies that @xmath929 and @xmath930 , so that @xmath903 as desired",
    ".      let @xmath931 ; it can be characterized as follows .",
    "there exists a unique family of bijections @xmath932 with the same properties as in proposition  [ pp : phi ] except that @xmath724 , @xmath839 and @xmath933 are replaced by @xmath725 , @xmath840 and @xmath934 in , and , respectively .",
    "we record the commutations among the basic steps of the path - rc bijection . here",
    "@xmath374 for @xmath122 .",
    "[ th : rccomm ]    1 .",
    "[ pt : dbdt ] @xmath935=0 $ ] .",
    "[ pt : jdelta ] @xmath936=0 $ ] and @xmath937=0 $ ] .",
    "[ pt : ljrj ] @xmath938=0 $ ] .",
    "[ pt : bsdelta ] @xmath939=0 $ ] and @xmath940=0 $ ] .",
    "[ pt : bslj ] @xmath941=0 $ ] and @xmath942=0 $ ] .",
    "the proof of part [ pt : dbdt ] for type @xmath12 is given in  ( * ? ? ?",
    "* appendix a ) .",
    "the proof of part  [ pt : dbdt ] for type @xmath16 is quite technical and follows similar arguments as  ( * ? ? ?",
    "* appendix a ) ( see also  ( * ? ? ?",
    "* appendix c ) ) .",
    "details are available upon request",
    ". parts [ pt : jdelta ] and [ pt : ljrj ] follow easily from the definitions",
    ". parts [ pt : bsdelta ] through [ pt : bslj ] only apply for @xmath123 and follow from @xcite .    for type @xmath16",
    ", there is an analogue of proposition  [ pp : weight ] for the commutation of @xmath724 and @xmath725 .",
    "let @xmath943 , @xmath944 , @xmath945 and @xmath946",
    ". then @xmath651 is uniquely determined by @xmath164 , @xmath652 , and @xmath653 .",
    "[ pp : weight rc ] for @xmath164 , @xmath651 , @xmath652 , and @xmath653 as above the statements of proposition  [ pp : weight ] hold .",
    "the proof is an easy consequence of the commutation @xmath935=0 $ ] and is available upon request .",
    "[ th : bijops ] under the family of bijections @xmath732 the following operations correspond :    1 .",
    "[ pt : ls ] @xmath527 with @xmath839 .",
    "[ pt : lh ] @xmath562 with @xmath724 .",
    "[ pt : rs ] @xmath375 with @xmath840 .",
    "[ pt : rh ] @xmath563 with @xmath725 .",
    "[ pt : * ] @xmath20 with @xmath947 . 6 .",
    "[ pt : r ] @xmath96 with the identity",
    "[ pt : bs ] @xmath549 with @xmath933 and @xmath550 with @xmath934 .    to illustrate point  [ pt : rh ] of the above theorem ,",
    "take @xmath948 of type @xmath565 .",
    "then @xmath949 and @xmath950 { \\overline{\\phi}}({\\mathrm{rh}}(b))={\\widetilde{\\delta}}({\\overline{\\phi}}(b))&= \\quad \\yngrc(2,0,1,0 ) \\quad \\yngrc(1,0 ) \\quad { \\varnothing}\\quad \\qquad { \\varnothing}.\\end{aligned}\\ ] ]    everything is proved for @xmath123 in @xcite , including part [ pt : bs ] , which only applies in that case .",
    "we assume that @xmath151 for type @xmath16 .",
    "parts [ pt : ls ] and [ pt : lh ] hold by proposition [ pp : phi ] .",
    "we prove parts [ pt : rs ] , [ pt : rh ] , and [ pt : * ] simultaneously by induction .",
    "the induction is based first on the quantity @xmath951 for the crystal @xmath952 , and then by decreasing induction on the number of tensor factors .",
    "consider part [ pt : rs ] .",
    "suppose first that @xmath953 for some @xmath954 .",
    "then @xmath557 has only one element @xmath476 .",
    "it is easy to show that @xmath955 is the empty rc and that [ pt : rs ] holds .",
    "suppose next that @xmath956 .",
    "consider the diagram @xmath957^{{\\mathrm{rs } } } \\ar[dr]_{{\\overline{\\phi } } } \\ar[ddd]_{{\\mathrm{lh } } } & & & p({\\mathrm{rs}}(b ) ) \\ar[dl]^{{\\overline{\\phi } } } \\ar[ddd]^{{\\mathrm{lh } } } \\\\ & { \\mathrm{rc}}(l ) \\ar[r]^{{\\widetilde{j } } } \\ar[d]_{{\\overline{\\delta } } } & { \\mathrm{rc}}({{\\mathrm{rs}}(l ) } ) \\ar[d]^{{\\overline{\\delta } } } & \\\\ & { \\mathrm{rc}}({{\\mathrm{lh}}(l ) } ) \\ar[r]_{{\\widetilde{j } } } & { \\mathrm{rc}}({\\mathrm{rs}}({{\\mathrm{lh}}(l ) } ) ) & \\\\ p({\\mathrm{lh}}(b ) ) \\ar[ur]^{{\\overline{\\phi } } } \\ar[rrr]_{{\\mathrm{rs } } } & & & p({\\mathrm{rs}}({\\mathrm{lh}}(b ) ) ) \\ar[ul]_{{\\overline{\\phi } } } } \\ ] ] here @xmath255 , @xmath958 , @xmath727 , @xmath959 are the multiplicities arrays corresponding to @xmath51 , @xmath960 , @xmath729 , @xmath961 , respectively .",
    "we shall view such a diagram as a cube in which the small square is in the background .",
    "the left and right faces commute by proposition [ pp : phi ] .",
    "the front and back faces commute by proposition [ pp : cryscomm ] part [ pt : lhrs ] and theorem [ th : rccomm ] part [ pt : jdelta ] respectively .",
    "the bottom face commutes by induction .",
    "it follows that the top face  commutes up to @xmath724 \" , that is , @xmath962 .",
    "but all maps in the top face preserve the highest weight . by proposition [ pp : boxbij ]",
    "it follows that the top face commutes .",
    "the remaining case is @xmath963 for @xmath964 .",
    "consider the diagram below , where @xmath965is obtained from @xmath823 by splitting a @xmath966 into @xmath967 and @xmath570 .",
    "@xmath957^{{\\mathrm{rs } } } \\ar[dr]_{{\\overline{\\phi } } } \\ar[ddd]_{{\\mathrm{ls } } } & & & p({\\mathrm{rs}}(b ) ) \\ar[dl]^{{\\overline{\\phi } } } \\ar[ddd]^{{\\mathrm{ls } } } \\\\ & { \\mathrm{rc}}(l ) \\ar[r]^{{\\widetilde{j } } } \\ar[d]_{{\\overline{j } } } & { \\mathrm{rc}}({\\mathrm{rs}}(l ) ) \\ar[d]^{{\\overline{j } } } & \\\\ & { \\mathrm{rc}}({\\mathrm{ls}}(l ) ) \\ar[r]_{{\\widetilde{j } } } & { \\mathrm{rc}}({\\mathrm{rs}}({\\mathrm{ls}}(l ) ) & \\\\",
    "p({\\mathrm{ls}}(b ) ) \\ar[ur]^{{\\overline{\\phi } } } \\ar[rrr]_{{\\mathrm{rs } } } & & & p({\\mathrm{rs}}({\\mathrm{ls}}(b ) ) ) \\ar[ul]_{{\\overline{\\phi } } } } \\ ] ] the left and right faces commute by proposition [ pp : phi ] .",
    "the front and back faces commute by proposition [ pp : cryscomm ] part [ pt : lsrs ] and theorem [ th : rccomm ] part [ pt : ljrj ] respectively .",
    "the bottom face commutes by induction .",
    "since @xmath839 is injective , it follows that the top face commutes .",
    "this finishes the proof of part [ pt : rs ] .",
    "we now prove part [ pt : rh ] .",
    "the proof is trivial for the base case @xmath968 .",
    "suppose next that @xmath969 .",
    "@xmath957^{{\\mathrm{rh } } } \\ar[dr]_{{\\overline{\\phi } } } \\ar[ddd]_{{\\mathrm{lh } } } & & & p({\\mathrm{rh}}(b ) ) \\ar[dl]^{{\\overline{\\phi } } } \\ar[ddd]^{{\\mathrm{lh } } } \\\\ & { \\mathrm{rc}}(l ) \\ar[r]^{{\\widetilde{\\delta } } } \\ar[d]_{{\\overline{\\delta } } } & { \\mathrm{rc}}({{\\mathrm{lh}}(l ) } ) \\ar[d]^{{\\overline{\\delta } } } & \\\\ & { \\mathrm{rc}}({{\\mathrm{lh}}(l ) } ) \\ar[r]_{{\\widetilde{\\delta } } } & { \\mathrm{rc}}({\\mathrm{rh}}({{\\mathrm{lh}}(l ) } ) ) & \\\\",
    "p({\\mathrm{lh}}(b ) ) \\ar[ur]^{{\\overline{\\phi } } } \\ar[rrr]_{{\\mathrm{rh } } } & & & p({\\mathrm{rh}}({\\mathrm{lh}}(b ) ) ) \\ar[ul]_{{\\overline{\\phi } } } } \\ ] ] the left and right faces commute by proposition [ pp : phi ] .",
    "the front and back faces commute by proposition [ pp : cryscomm ] part [ pt : lhrh ] and theorem [ th : rccomm ] part [ pt : dbdt ] respectively .",
    "the bottom face commutes by induction .",
    "thus the top face commutes up to @xmath724 . by proposition",
    "[ pp : boxbij ] it suffices to show that both ways around the top face , result in elements with the same highest weight .",
    "this follows from propositions  [ pp : weight ] and  [ pp : weight rc ] .",
    "the remaining case is @xmath970 .",
    "consider the diagram @xmath957^{{\\mathrm{rh } } } \\ar[dr]_{{\\overline{\\phi } } } \\ar[ddd]_{{\\mathrm{ls } } } & & & p({\\mathrm{rh}}(b ) ) \\ar[dl]^{{\\overline{\\phi } } } \\ar[ddd]^{{\\mathrm{ls } } } \\\\ & { \\mathrm{rc}}(l ) \\ar[r]^{{\\widetilde{\\delta } } } \\ar[d]_{{\\overline{j } } } & { \\mathrm{rc}}({{\\mathrm{rh}}(l ) } ) \\ar[d]^{{\\overline{j } } } & \\\\ & { \\mathrm{rc}}({{\\mathrm{ls}}(l ) } ) \\ar[r]_{{\\widetilde{\\delta } } } & { \\mathrm{rc}}({\\mathrm{rh}}({{\\mathrm{ls}}(l ) } ) ) & \\\\",
    "p({\\mathrm{ls}}(b ) ) \\ar[ur]^{{\\overline{\\phi } } } \\ar[rrr]_{{\\mathrm{rh } } } & & & p({\\mathrm{rh}}({\\mathrm{ls}}(b ) ) ) \\ar[ul]_{{\\overline{\\phi } } } } \\ ] ] the left and right faces commute by proposition [ pp : phi ] .",
    "the front and back faces commute by proposition [ pp : cryscomm ] part [ pt : rhls ] and theorem [ th : rccomm ] part [ pt : jdelta ] respectively .",
    "the bottom face commutes by induction .",
    "since @xmath839 is injective it follows that the top face commutes .",
    "this proves part [ pt : rh ] .    for part [ pt : * ]",
    "the proof of the base case @xmath953 is trivial .",
    "suppose next that @xmath969 .",
    "consider the diagram @xmath957^ { * } \\ar[dr]_{{\\overline{\\phi } } } \\ar[ddd]_{{\\mathrm{rh } } } & & & p(b^ * ) \\ar[dl]^{{\\overline{\\phi } } } \\ar[ddd]^{{\\mathrm{lh } } } \\\\ & { \\mathrm{rc}}(l ) \\ar[r]^{{\\theta } } \\ar[d]_{{\\widetilde{\\delta } } } & { \\mathrm{rc}}(l ) \\ar[d]^{{\\overline{\\delta } } } & \\\\ & { \\mathrm{rc}}({{\\mathrm{rh}}(l ) } ) \\ar[r]_{{\\theta } } & { \\mathrm{rc}}({{\\mathrm{rh}}(l ) } ) & \\\\ p({\\mathrm{rh}}(b ) ) \\ar[ur]^{{\\overline{\\phi } } } \\ar[rrr ] _ { * } & & & p({\\mathrm{rh}}(b)^ * ) \\ar[ul]_{{\\overline{\\phi } } } } \\ ] ] the right face commutes by proposition  [ pp : phi ] .",
    "the left commutes by part [ pt : rh ] which was just proved above .",
    "the back face commutes by the definition of @xmath725 .",
    "the commutation of the front face is given by proposition [ pp : cryscomm ] part [ pt : hat * ] .",
    "the bottom face commutes by induction .",
    "it follows that the top face commutes up to @xmath724 .",
    "again it suffices to show that both ways around the top face produce elements of the same highest weight .",
    "but this holds since @xmath732 , @xmath947 , and @xmath20 preserve the highest weight .",
    "here we are using the fact that for @xmath88 , @xmath971 .",
    "next let @xmath972 with @xmath376 .",
    "@xmath957^ { * } \\ar[dr]_{{\\overline{\\phi } } } \\ar[ddd]_{{\\mathrm{rs } } } & & & p(b^ * ) \\ar[dl]^{{\\overline{\\phi } } } \\ar[ddd]^{{\\mathrm{ls } } } \\\\ & { \\mathrm{rc}}(l ) \\ar[r]^{{\\theta } } \\ar[d]_{{\\widetilde{j } } } & { \\mathrm{rc}}(l ) \\ar[d]^{{\\overline{j } } } & \\\\ & { \\mathrm{rc}}({{\\mathrm{ls}}(l ) } ) \\ar[r]_{{\\theta } } & { \\mathrm{rc}}({{\\mathrm{ls}}(l ) } ) & \\\\",
    "p({\\mathrm{rs}}(b ) ) \\ar[ur]^{{\\overline{\\phi } } } \\ar[rrr ] _ { * } & & & p({\\mathrm{rs}}(b)^ * ) \\ar[ul]_{{\\overline{\\phi } } } } \\ ] ] the right face commutes by proposition [ pp : phi ] .",
    "the left face commutes by part [ pt : rs ] which was proved above .",
    "the back face commutes by the definition of @xmath840 .",
    "the commutation of the front face is given by the definition of @xmath527 in .",
    "the bottom face commutes by induction .",
    "since @xmath839 is injective , the top face commutes .    for @xmath973 with @xmath376",
    "the proof is similar to the previous case .",
    "this concludes the proof of part [ pt : * ] .    for the proof of part [ pt : r ] ,",
    "let @xmath974 .",
    "we may assume that @xmath975 is the r - matrix being applied at tensor positions @xmath108 and @xmath976 ( from the right ) .",
    "by induction we may assume that @xmath977 , that is , @xmath96 acts at the leftmost two tensor positions .",
    "by part [ pt : * ] and proposition [ pp : r * ] we may assume that @xmath978 .",
    "again by induction we may assume that @xmath979 .",
    "let @xmath980 ( of type @xmath16 ) . by lemma [ lem : d2p ]",
    "@xmath51 is multiplicity - free as a @xmath408-crystal . since @xmath96 preserves weights it follows that @xmath981 .",
    "a direct computation shows that @xmath982 .",
    "in this subsection we will show that @xmath983 for @xmath137 for type @xmath12 and @xmath151 for type @xmath16 . by proposition  [ pp : phi ]",
    "there is a bijection between the sets @xmath163 and @xmath712 .",
    "hence it remains to show that the statistics is preserved .",
    "[ th : statistics ] let @xmath137 be a crystal of type @xmath12 or @xmath151 a crystal of type @xmath16 and @xmath164 a dominant integral weight .",
    "the coquantum number bijection @xmath984 preserves the statistics , that is @xmath985 for all @xmath986 .",
    "for type @xmath12 the theorem follows from  ( * ? ? ?",
    "* theorem 9.1 ) .",
    "hence assume that @xmath151 of type @xmath16 .",
    "by theorem  [ th : bijops ] part [ pt : rs ] and equations   and   the maps @xmath375 and @xmath839 correspond under @xmath984 . by theorem",
    "[ th : splitrow ] we have @xmath987 .",
    "similarly , it follows immediately from the definition of @xmath839 in proposition  [ pp : ljdef ] that @xmath988 .",
    "the maps @xmath96 and the identity also correspond under @xmath984 by theorem  [ th : bijops ] part [ pt : r ] , and neither of them changes the statistics .",
    "there exists a sequence @xmath989 of maps @xmath375 and @xmath96 which transforms a path @xmath986 into a path of single boxes . by theorem",
    "[ th : bijops ] there exists a corresponding sequence @xmath990 of maps @xmath839 and the identity . since neither of these maps changes the statistics it follows that @xmath991 the theorem for the case @xmath992 has already been proven in  @xcite .",
    "[ cor : x = m ad ] for @xmath137 of type @xmath12 or @xmath151 of type @xmath16 , @xmath255 the corresponding multiplicity array and @xmath164 a dominant integral , we have @xmath993    this follows from theorem  [ th : statistics ] , and .",
    "for this section we assume type @xmath12 . we define and study the properties of a dual analogue @xmath994 of the @xmath724 map that corresponds to removing a tensor factor @xmath995 from the left .",
    "this is used to prove a duality symmetry ( theorem [ th : dualpath ] ) for the path - rc bijection in type @xmath12 .",
    "this in turn is useful for establishing the virtual bijections in section  [ sec : virtualbij ] .",
    "let @xmath996 be the category of tensor products of crystals of the form @xmath3 and @xmath186 .",
    "one goal of this section is to give a simpler way to compute @xmath732 for @xmath997 . since @xmath998 , proposition [ pp : phi ] gives the definition of @xmath732 .",
    "by @xmath186 is isomorphic to @xmath999 .",
    "the definition of @xmath732 involves left - splitting @xmath999 , which produces columns @xmath1000 , each of which have to be  box split \" into boxes @xmath13 and removed by @xmath562 .",
    "we introduce a dual analogue @xmath994 of @xmath724 , which removes an entire column @xmath1000 in a single step whose computation is entirely similar to a single @xmath724 ( rather than @xmath208 of them ) .",
    "using @xmath994 , we can compute @xmath732 for @xmath1001 using essentially single row techniques .",
    "suppose that @xmath1002 .",
    "in this particular case we write @xmath1003 . by lemma [",
    "lem : hwvhat ] there is a map @xmath1004 given by removing the left tensor factor .",
    "let @xmath1005 be the multiplicity array of @xmath1006 .",
    "the following algorithm is the same as @xmath724 except that it starts from large indices instead of small .",
    "the map @xmath1007 is defined as follows .",
    "let @xmath1008 .",
    "initialize @xmath1009 and @xmath1010 . for @xmath54 from @xmath208",
    "down to @xmath287 , assuming that @xmath1011 has already been defined , let @xmath1012 be the smallest integer such that @xmath1013 has a singular string of length @xmath1012 and @xmath1014 .",
    "if no such singular string exists , let @xmath1015 for @xmath1016 .",
    "let @xmath1017 where @xmath54 is the maximum index @xmath54 such that @xmath1018 .",
    "for @xmath1019 of type @xmath1020 and @xmath1021 the rigged configuration @xmath1022 is in @xmath712 with @xmath255 the multiplicity array corresponding to @xmath51 .",
    "the same configuration now written with the vacancy number next to each part is @xmath1023 then @xmath1024 and @xmath1025 .",
    "given @xmath736 , there is also an inverse of the dual algorithm @xmath994 associated with the weight @xmath1026 similar to the inverse of @xmath724 as defined in section  [ ss : deltas ] .",
    "[ pp : dbv ] @xmath1027 is a well - defined injective map such that the diagram commutes : @xmath1028 moreover , if @xmath1029 then @xmath1030 and @xmath1031 .",
    "the map @xmath1032 removes @xmath1033 .",
    "this may be achieved by @xmath208 applications of @xmath1034 , which splits a box from a column and then removes it .",
    "let @xmath1035 be the corresponding @xmath208-fold composition of maps @xmath1036 .",
    "it must be shown that @xmath1037 .",
    "let @xmath1038 .",
    "the letters @xmath1039 in @xmath389 ( where @xmath389 is viewed as an element of @xmath1000 ) satisfy @xmath1040 it is clear from proposition  [ pp : rcbs ] and the algorithm for @xmath724 of section  [ ss : deltas ] that the composition @xmath1041 corresponding to the letter @xmath1042 for @xmath1043 in @xmath389 removes a box from one string of length @xmath1044 in the @xmath54-th rigged partition and leaves all other strings unchanged .",
    "it also follows from the algorithms and change of vacancy numbers that @xmath1045 and that @xmath1044 is the length of the smallest singular string in @xmath1013 with this property . for @xmath1046",
    "the composition @xmath1036 leaves the rigged configuration unchanged with @xmath1047 .",
    "it follows by induction that @xmath1048 , where @xmath1012 as in the definition of @xmath994 , and hence that @xmath1037 .",
    "we restate left splitting for a special case .",
    "suppose @xmath1049 for @xmath391 .",
    "define @xmath1050 to be the composite map @xmath1051 by example [ ex : dualarow ] we may write @xmath1052 as a word of length @xmath8 in the dual alphabet .",
    "computing @xmath1053 using example [ ex : duala ] , it is seen that @xmath1054 where @xmath390 is the leftmost dual letter in @xmath58 and @xmath389 is the remaining word of length @xmath912 in the dual alphabet .",
    "let @xmath1055 be the multiplicity array for @xmath1056 .",
    "let us denote by @xmath1057 the map on rcs which corresponds to @xmath1053 under the path - rc bijection @xmath732 .",
    "it is the map @xmath839 with respect to @xmath999 and is therefore inclusion ( with some changes in vacancy numbers ) . with these definitions the following diagram commutes by proposition [ pp : phi ] for @xmath12 : @xmath1058      the results of this section to this point may be summarized as follows .",
    "[ pp : singledualbij ] there is a unique bijection @xmath731 satisfying the following properties .",
    "it sends the empty path to the empty rigged configuration , and if the leftmost tensor factor in @xmath51 is :    1 .",
    "@xmath570 : holds .",
    "@xmath126 for @xmath376 : holds .",
    "@xmath995 : holds .",
    "4 .   @xmath188 for @xmath376 : holds .",
    "let @xmath1001 .",
    "let @xmath255 and @xmath1060 be the multiplicity arrays for @xmath51 and @xmath1061 respectively .",
    "explicitly , @xmath1062 for @xmath1063 . given a classical highest weight @xmath164 , let @xmath1064 be the highest weight of the contragredient dual module to the @xmath1065-module highest weight @xmath164 .",
    "there is a bijection @xmath1066 given by @xmath1067 where @xmath1068 and @xmath1069 is obtained from @xmath1070 by complementation within the @xmath1071 rectangle .",
    "[ th : dualpath ] @xcite let @xmath137 , @xmath1061 its contragredient dual , and @xmath255 and @xmath1060 their respective multiplicity arrays .",
    "the diagram commutes : @xmath1072",
    "in this section we will prove @xmath0 for the category @xmath122 for the nonsimply - laced algebras .",
    "for the simply - laced types @xmath12 and @xmath16 this was proved in corollary  [ cor : x = m ad ] . for the non - simply - laced affine families",
    "it suffices to prove the following theorem .",
    "[ th : virtualbij ] for @xmath136 , let @xmath1073 be the virtual crystal embedding , @xmath255 and @xmath1074 the multiplicity arrays for @xmath51 and @xmath299 respectively . then the simply - laced bijection @xmath1075 restricts to a bijection @xmath1076 .                1 .   if @xmath275 then @xmath1083 is defined by @xmath1084 , which drops the two leftmost factors in @xmath299 .",
    "if @xmath280 and @xmath291 then @xmath1085 is defined by @xmath1086 .",
    "this accomplishes the same thing as deleting the tensor factor @xmath1087 .",
    "if @xmath280 and @xmath294 then @xmath1088 is defined by @xmath1089 .            1 .",
    "if @xmath275 then @xmath1097 is the composition @xmath1098 2 .   if @xmath280 and @xmath291 then @xmath1099 is the map that splits off the first two symbols , that is , @xmath1100 where @xmath1101 , @xmath1102 , and @xmath1103 .",
    "3 .   if @xmath280 and @xmath294 then define @xmath1104 .      [ rem : vls ] let @xmath1105 and let @xmath1073 and @xmath1106 be the virtual crystal realizations . by abuse of notation",
    "we write @xmath1107 .",
    "we also use the notation @xmath1108 for the map @xmath1109 .",
    "it also satisfies .",
    "given the virtual crystal embedding @xmath1110 , let @xmath255 and @xmath858 be the multiplicity arrays for @xmath1111 and @xmath299 respectively .",
    "the maps @xmath1112 and @xmath1113 are defined to be the maps on rigged configurations which correspond under @xmath732 to the maps @xmath1114 and @xmath1108 .",
    "more precisely , since @xmath732 is a bijection for type @xmath260 there are unique maps @xmath1112 and @xmath1113 defined by the commutation of the diagrams @xmath1115 where @xmath1116 and @xmath1117 are the multiplicity arrays for @xmath1118 and @xmath1119 respectively .                from and proposition  [ pp : dbv ]",
    "it is clear that @xmath1131 .",
    "it must be shown that @xmath1132 also possesses the three properties - .",
    "let @xmath1133 the lengths of the strings selected by @xmath994 and @xmath747 be the lengths of the strings selected by the subsequent application of @xmath724 .",
    "let @xmath1134 for some @xmath1135 . if @xmath1136 , it is clear from the definitions that @xmath1137 for @xmath1138 , so that points - still hold . here",
    "for @xmath1140 , we must have @xmath1141 since otherwise by the symmetry @xmath1142 which contradicts the assumption that @xmath1140 .",
    "however , this implies that @xmath1143 for @xmath1144 and @xmath1145 .",
    "since the vacancy numbers are all even - remain valid .",
    "one has @xmath1146 . finally let @xmath1147 and let @xmath1148 be minimal such that @xmath1149 .",
    "by symmetry we have @xmath1150 for all @xmath1151 . by the algorithms for @xmath994 and @xmath724 and properties - for @xmath1152 it follows that @xmath1137 for @xmath1153 and @xmath1154 , and @xmath1155 for @xmath1151 .",
    "again this implies that properties - hold for @xmath1132",
    ". then @xmath1156 .",
    "the elements in @xmath1122 are characterized by points and .",
    "everything goes through as for the case @xmath1126 except that , since @xmath1157 may contain odd parts , it is possible that @xmath1158 . in this case",
    "@xmath1159 for all @xmath1160 by point .",
    "then @xmath1161 for all @xmath1162 , so that @xmath1132 again satisfies and . then @xmath1163 .",
    "the elements in @xmath1122 are characterized by point .",
    "the proof goes through as before except that @xmath875 could have an odd part .",
    "this could only change the computation of @xmath1165 if such an odd part were selected . recall that @xmath1166 is even for all @xmath54 .",
    "therefore the odd part can not be selected by @xmath994 .",
    "it can only be selected by @xmath724 if @xmath1167 and the odd part has size @xmath1168 for some @xmath1169 . by point and the fact that @xmath1170 is unchanged by @xmath994 for @xmath1171",
    ", we have @xmath1172 for @xmath1173 and @xmath1174 is the odd ( now singular ) part .",
    "thus after applying @xmath1165 point still holds .",
    "@xmath1175 . note that @xmath1176 since @xmath994 caused the strings in the @xmath1177-th rigged partition that were longer than @xmath1178 , to become nonsingular .",
    "if @xmath1140 , note that @xmath1181 since all vacancy numbers @xmath1166 are even , so that by ( 3 ) only the riggings for @xmath54 even can possibly be singular . as in case",
    "@xmath447 we must have @xmath1141 . by symmetry",
    "we have @xmath1172 for @xmath1144 .",
    "the application of @xmath994 changes the vacancy numbers in the @xmath208-th rigged partition corresponding to the strings of length @xmath54 for @xmath1182 by @xmath1183 , which makes these vacancy numbers odd .",
    "in particular , the rigging of the new string of length @xmath1184 is odd .",
    "in addition , @xmath1185 and by ( 3 ) @xmath1174 must be odd . by the change in vacancy number after the application of @xmath724 , the new rigging of the string of length @xmath1186",
    "must be even . hence and ( 3 ) hold for @xmath1132 and @xmath1175",
    "if @xmath1147 , let @xmath1148 be defined as for the case @xmath447 . as before @xmath1150 for @xmath1151 .",
    "if @xmath1187 everything goes through as in case @xmath447 .",
    "if @xmath1188 ( which means that @xmath1141 ) , by the same arguments as for @xmath1140 , we have @xmath1172 for @xmath1189 , @xmath1190 and ( 3 ) holds for the new riggings . hence properties and ( 3 ) hold for @xmath1132 and @xmath1191 .          by section  [ sec : virtual lh ]",
    "and we have @xmath1195 .",
    "let @xmath747 and @xmath764 ( resp . @xmath795 and @xmath816 ) be the length of the selected strings for the right ( resp .",
    "left ) @xmath724 .",
    "then it follows from the definition of @xmath839 , @xmath724 and point that @xmath1196 for @xmath1144 .",
    "furthermore from point we obtain that @xmath1197 , and again by point that @xmath1198 for @xmath1144 .",
    "this implies that points and hold for @xmath1132",
    ". moreover , let @xmath1199 and @xmath1200 .",
    "note that @xmath1201 because of point ( 1 ) .",
    "also @xmath1202 except possibly @xmath1203 and @xmath1204 . then @xmath1205",
    "if @xmath1202 or @xmath1206 if @xmath1207 .",
    "the elements in @xmath1122 are characterized by point .",
    "it is obvious from its definition that @xmath1208 preserves this property .",
    "let @xmath1199 .",
    "as before @xmath1209 because of point ( 1 )",
    ". then @xmath1210 .        for the proof of theorem [ th : virtualbij ]",
    "we also need the inverse to lemma  [ lem : vdb ] which involves the inverse of @xmath1112 .",
    "let @xmath1215 , @xmath1216 a multiplicity array and @xmath1217 . denote by @xmath1218 the subset of @xmath1219 given by @xmath780 such that @xmath1220 and if @xmath366 then also @xmath1221 .",
    "let @xmath1222 . by abuse of notation",
    "we define @xmath1223 if @xmath275 , let @xmath1224",
    ". then @xmath1225 , with @xmath1226 as defined in section  [ ss : deltas ] and @xmath1227 as defined in section  [ ss : dual left hat ] .",
    "if @xmath280 and @xmath291 , let @xmath1228 . then @xmath1229 .",
    "finally for @xmath280 and @xmath294 , let @xmath1230 . then @xmath1231 .",
    "let @xmath275 .",
    "by and section  [ sec : virtual ls ] we have @xmath1236 .",
    "both @xmath839 and @xmath1237 are inclusions that do not change the rigged configuration ( only certain vacancy numbers ) .",
    "hence if @xmath1127 has the characterization as stated in the previous lemma , then so does @xmath1238 .",
    "let @xmath280 .",
    "if @xmath294 , we have @xmath1239 . for @xmath291 ,",
    "let @xmath897 for @xmath376 and embeddings @xmath1240 and @xmath1241 with @xmath1242 .",
    "it can be shown ( using @xmath20 and properties of @xmath375 ) that if @xmath1243 and @xmath1244 are such that @xmath1245 then for any @xmath1246 one has @xmath1247 .",
    "one may show that the corresponding operation on rcs is inclusion .",
    "this may be seen by observing that @xmath1248 , which sends @xmath1249 to @xmath1250 , can also be computed by a composition of @xmath527 maps and @xmath96-matrices , whose corresponding maps on rcs are inclusions .",
    "this proves that @xmath1251 .          for ( 1 )",
    "consider a typical element of @xmath343 , given by @xmath1256 with @xmath986 .",
    "write @xmath1257 with @xmath1258 and @xmath1259 .",
    "then @xmath1260 . let @xmath1261 .",
    "it must be shown that @xmath1262 . by and induction one",
    "has @xmath1263 and @xmath1264 . by lemma  [ lem : vdb inv ]",
    "we can conclude that @xmath1265 .    for ( 2 )",
    "let @xmath1127 .",
    "let @xmath1266 ( with @xmath1267 and @xmath1268 ) be such that @xmath1269 .",
    "it must be shown that @xmath1270 . by",
    "we have @xmath1271 . by induction @xmath1272 ; write @xmath1273 for some @xmath1274 . by lemma [ lem : vdb ] and , @xmath1275 for @xmath1276 .",
    "let @xmath1277 . by definition @xmath1278 .",
    "therefore @xmath1279 as desired",
    ".      for ( 1 ) , a typical element of @xmath1252 has the form @xmath1256 for @xmath1280 .",
    "let @xmath1281 .",
    "it must be shown that @xmath1282 .",
    "note that @xmath1283 by and induction .",
    "but @xmath1284 and @xmath1285 .",
    "it follows that @xmath1127 .    for ( 2 ) ,",
    "let @xmath1127 .",
    "let @xmath1286 be such that @xmath1269 .",
    "it must be shown that @xmath1270 . by and induction , @xmath1287 .",
    "therefore @xmath1288 .",
    "we conclude that @xmath1279 by , proposition [ pp : vrs ] point [ it : vres ] , and proposition [ pp:*emb ] .",
    "g.  hatayama , y.  koga , a.  kuniba , m.  okado , t.  takagi , _ finite crystals and paths _ , combinatorial methods in representation theory ( kyoto , 1998 ) , 113132 , adv . stud .",
    "pure math .",
    ", * 28 * , kinokuniya , tokyo , 2000 .",
    "g.  hatayama , a.  kuniba , m.  okado , t.  takagi , y.  yamada , _",
    "remarks on fermionic formula _ , recent developments in quantum affine algebras and related topics ( raleigh , nc , 1998 ) , 243291 , contemp . math . ,",
    "* 248 * , amer .",
    "soc . , providence , ri , 1999 .",
    "kang , m.  kashiwara , k.  c.  misra , t.  miwa , t.  nakashima , a.  nakayashiki , _ affine crystals and vertex models _ , infinite analysis , part a , b ( kyoto , 1991 ) , 449484 , adv .",
    ", * 16 * , world sci .",
    "publishing , river edge , nj , 1992 .",
    "m.  okado , a.  schilling , m.  shimozono , _ a crystal to rigged configuration bijection for nonexceptional affine algebras _ , algebraic combinatorics and quantum groups , 85124 , world sci .",
    "publishing , river edge , nj , 2003 ."
  ],
  "abstract_text": [
    "<S> the @xmath0 conjecture of hatayama et al . </S>",
    "<S> asserts the equality between the one - dimensional configuration sum @xmath1 expressed as the generating function of crystal paths with energy statistics and the fermionic formula @xmath2 for all affine kac  moody algebra . in this paper </S>",
    "<S> we prove the @xmath0 conjecture for tensor products of kirillov  reshetikhin crystals @xmath3 associated to symmetric powers for all nonexceptional affine algebras . </S>"
  ]
}