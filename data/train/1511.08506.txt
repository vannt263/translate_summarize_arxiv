{
  "article_text": [
    "contextuality @xcite - @xcite has recently been established as a necessary resource for quantum computation by injection of magic states ( qcsi ) .",
    "this was first achieved for the case of qudits @xcite , where the hilbert space dimension of the local systems is an odd prime or a power of an odd prime , and subsequently for the case of rebits @xcite , where the hilbert space dimension of the local systems is 2 , but the density matrix is constrained to be real .",
    "the scheme of qcsi @xcite deviates from the standard circuit model in that the allowed state preparations , unitary transformations and measurements are restricted to non - universal and , in fact , efficiently classically simulable operations .",
    "computational universality is restored by the capability to inject so - called magic states .",
    "the source of computational power thus shifts from the gates to the magic states .    before the analysis of the magic states",
    "as resources can begin , it needs to be clarified in which sense the restricted state - preparations , unitaries and measurements available in qcsi are not quantum resources",
    ". these operations are certainly not entirely classical .",
    "for example , highly entangled states can be created by them .",
    "the near - classicality of these operations is explained in terms of a wigner function ; see @xcite , @xcite , @xcite - @xcite .",
    "wigner functions @xcite - @xcite describe quantum states in phase space .",
    "they are quasi - probability distributions , and as such the closest quantum analogue to joint probability distributions of position and momentum in classical statistical mechanics .",
    "the difference is that wigner functions can take negative values , and this negativity is a signature of quantumness @xcite , @xcite .    for qcsi on qudits or rebits ,",
    "wigner functions provide a computational notion of classicality @xcite , @xcite , @xcite .",
    "namely , if the initial quantum state has a non - negative wigner function , then the entire quantum computation can be efficiently classically simulated .",
    "wigner function negativity is thus necessary for quantum speedup .",
    "after the roles of wigner function negativity and contextuality have been clarified for qudits and rebits , in this paper we investigate them for the yet unresolved case of qubits .",
    "this case , into which the rebit scenario @xcite forays , is complicated by the fact that the wigner function for infinite dimension @xcite can not be adapted to it @xcite , @xcite , @xcite , @xcite .",
    "this is related to the presence of state - independent contextuality with pauli observables @xcite ( also see bell inequalities based on stabilizer operators @xcite-@xcite ) .",
    "we impose the following three constraints on the qcsi schemes we discuss : ( p1 ) _ the computational scheme is tomographically complete . _",
    "that is , with the available operations the density matrix @xmath0 of any @xmath1-qubit quantum state can be fully measured , and that ( p2 ) _ the wigner function describing the computational scheme is informationally complete _ , i.e. , any @xmath1-qubit quantum state @xmath0 can be unambiguously reconstructed from its wigner function @xmath2 .",
    "finally , ( p3 ) _ the measurements available in qcsi must not introduce negativity into the wigner function of the processed quantum state_.    requirement ( p3 ) is the very basis for the usefulness of wigner functions in the description of qcsi , namely to reveal the near - classicality of qcsi without the magic states .",
    "it is certainly in line with the approach taken for qudits and rebits .",
    "however , ( p3 ) is trickier than might at first appear . for a start",
    ", we do not require a counterpart of ( p3 ) for the unitary operations available in qcsi , and imposing it would indeed be too restrictive .",
    "those unitaries may introduce large amounts of negativity into the wigner function without compromising efficient classical simulability .    in this paper , we provide a common structural framework for qcsi schemes on qubits which satisfy the above postulates , and demonstrate that there are such qcsi schemes . for those , we establish contextuality in the magic states as a necessary quantum resource .",
    "our main results are the following :    1 .   for all qcsi schemes on qubits satisfying the postulate ( p3 ) ,",
    "contextuality is necessary for quantum computational universality ( theorem  [ univcon ] ) .",
    "2 .   for @xmath1-qubit qcsi schemes which satisfy the postulate ( p3 ) and for which the value assignments for all states of the corresponding non - contextual hidden variable model can be efficiently evaluated ,",
    "contextuality is necessary for speedup ( theorem  [ effsimgen ] ) .",
    "3 .   there is at least one family of qcsi schemes and matching wigner function which satisfies the postulates ( p1)-(p3 ) .",
    "4 .   for qubits , two notions of classicality in qcsi agree , namely the notion based on the existence of a non - contextual hvm and the notion based on efficient classical simulation by sampling ( theorem  [ effsimgen ] ) .",
    "( the same condition as in point 2 applies . )",
    "5 .   for qubits ,",
    "the unitary gates allowed in qcsi do in general not preserve positivity of wigner functions and do not transform wigner functions covariantly .",
    "this does not affect efficient classical simulability .",
    "6 .   as for qudits ,",
    "the wigner function is a critical tool for endowing the operations of qcsi ( not invoking magic states ) with a notion of near - classicality .",
    "the last three points require explanation . to begin",
    ", we observe that three notions of classicality are considered in the literature to describe the limitations of qcsi without magic states , namely ( i ) non - contextuality , ( ii ) efficient classical simulation by sampling from a non - negative wigner function @xcite , and ( iii ) efficient classical simulation via the stabilizer formalism @xcite .",
    "regarding point 4 , for qudits in odd prime ( power ) dimension , the first two of these notions turn out to be the same @xcite , and the third notion is strictly included @xcite .",
    "there is thus a robust notion of classicality in qcsi .    for qu_bits",
    "_ , the situation is more complicated .",
    "for example , the phenomenon of state - independent contextuality w.r.t .",
    "pauli observables @xcite arises , which is not present in qudits @xcite .",
    "also , classical simulability by sampling from a wigner function is a more restricted notion of classicality than the existence of a non - contextual hvm .    to close the gap between those two notions of classicality , in section  [ gsa ] we describe a general sampling algorithm which is based on an hvm rather than a non - negative wigner function",
    "this algorithm has the same range of applicability as the non - contextual hvms themselves .",
    "we thus find that the fundamental classical object , both from the perspective of non - contextuality and from the perspective of efficient classical simulation by sampling , is the non - contextual hvm , and not a positive wigner function .",
    "regarding point 5 , the situation is in stark contrast to the previously considered cases of qudits @xcite and rebits @xcite , where the wigner function in question is transformed covariantly and positivity is preserved . as a consequence , for all qcsi schemes on qubits",
    "where positivity of the wigner function is indeed not preserved , positivity can not be a sufficient resource for speedup ( the question is presently open in the qudit case ) .",
    "after the above - mentioned general simulation algorithm based on an hvm , the failure of the considered wigner functions to transform covariantly and to preserve positivity under the unitary qcsi - gates deals a second blow to the perceived centrality of wigner functions for the description of qcsi @xcite , @xcite , @xcite , @xcite .    regarding point 6 , the above limitations notwithstanding , wigner functions hold up as an organizing principle for near - classicality in qcsi .",
    "specifically , the critical postulate ( p3 ) is formulated in terms of a wigner function , and this formulation remains adequate .",
    "that is , the wigner function imposes the same constraints on the corresponding qcsi scheme as a more general non - contextual hvm .",
    "how can this be ?",
    "the answer to this question is that if an input state @xmath0 can be described in terms of a non - contextual hvm , then it corresponds to an ensemble @xmath3 of states , @xmath4 such that there are wigner functions @xmath5 with the property that @xmath6 , for all @xmath7 .",
    "( the set @xmath8 will be specified later . )",
    "the reason it remains meaningful to formulate the postulate ( p3 ) in terms of wigner functions is that for all the above @xmath5 , @xmath9 , the constraints placed by ( p3 ) on the qcsi scheme in question are the same .",
    "this is explained in detail in section  [ algocomp ] .",
    "_ remark : _ in our results on efficient simulation by sampling ( theorems  [ simul ] and [ effsimgen ] ) , we assume the sampling sources as given , and only count the operational cost of processing the samples in the simulation .",
    "this assumption holds , for example , when each magic state injected to the computation has support only on a bounded number of qubits @xcite,@xcite . however , there is strong indication that probability distributions exist which can be efficiently prepared by quantum means but are hard to sample from classically @xcite - @xcite . in view of those , theorems  [ simul ] and [ effsimgen ]",
    "specify the computational cost of classical simulation relative to a sampling source , similar to the complexity of an algorithm relative to an oracle .",
    "the role of positive wigner functions for qcsi has previously been discussed in @xcite , @xcite , @xcite and @xcite . of those works , @xcite , @xcite and @xcite",
    "address 2-level systems . in @xcite and @xcite ,",
    "multiple wigner functions are considered simultaneously , and for ( near- ) classicality it is required that the processed quantum states are positive w.r.t . _ all _ those wigner functions .",
    "this requirement severely limits the scope of the free operations of qcsi .",
    "by contrast , in our approach a sufficient requirement for near - classicality is that the initial state is positive w.r.t .",
    "single _ wigner function , and this requirement is relaxed even further ( see the discussion in section  [ sum ] , and section  [ algocomp ] ) .    from the perspective of wigner functions ,",
    "the present work is an extension of @xcite an @xcite . in @xcite ,",
    "systems of qudits in odd prime power dimension are discussed . while @xcite addresses 2-level systems , the density matrices",
    "therein are constrained to be real . here",
    "we lift that restriction .",
    "the present work differs from all above works in one critical respect .",
    "namely , in @xcite , @xcite , @xcite and @xcite , positivity of the considered wigner function is preserved under all operations of qcsi which do not invoke magic states . for the present discussion of qubits ,",
    "this is not the case .",
    "positivity of the wigner function remains preserved under the measurements available in qcsi , but not necessarily under the unitaries .    from the perspective of contextuality ,",
    "the present work is an extension of @xcite ( qudits of odd prime power dimension ) and @xcite ( rebits ) . in @xcite ,",
    "contextuality was first established as a necessary resource for qcsi .",
    "the present work generalizes the approach of operational restrictions previously applied to the rebit case @xcite . here ,",
    "those operational restrictions derive from the postulate ( p3 ) .",
    "we also refer to a companion paper @xcite of this article which focuses solely on the role of contextuality in qcsi .",
    "wigner functions  and all the conceptual puzzles they give rise to in the multi - qubit setting  are bypassed .",
    "the flip side of this approach is that wigner functions can no longer be used to characterize the near - classical `` free '' sector of operations in qcsi . instead",
    ", the free sector is specified by the set of available measurements , and the postulate ( p3 ) is replaced by the requirement that the available measurements do not exhibit state - independent contextuality .",
    "@xcite provides a shorter approach for those readers whose main interest is in contextuality .",
    "this paper is structured as follows . in sections",
    "[ set ] - [ context ] we analyze the general structure of qcsi schemes defined by the postulates ( p1 ) - ( p3 ) , and in section  [ qubitqcsi ] we explicitly construct a qcsi scheme on qubits for which contextuality in the magic states is a necessary quantum mechanical resource . regarding the former part , in section  [ set ] , we work out the implications of the postulates ( p1 ) - ( p3 ) for qcsi schemes .",
    "we give a prescription for how to construct qcsi schemes starting from the phase convention @xmath10 for the heisenberg - weyl operators .",
    "section [ effsim ] discusses the role of wigner functions for qcsi . in particular , we present an efficient classical simulation of qcsi for magic states with non - negative wigner function ( algorithm 1 ) .",
    "section  [ context ] is on the role of contextuality .",
    "we show that state - independent contextuality is absent from all qcsi schemes satisfying the postulates ( p1)-(p3 ) , clarify the relation between wigner function negativity and state - dependent contextuality , and establish the latter as a necessary resource for qcsi with magic states .",
    "finally , we describe an efficient classical simulation algorithm for qcsi for magic states with a non - contextual hvm ( algorithm 2 ) .",
    "it contains algorithm 1 as a special case .",
    "we conclude in section  [ concl ] .",
    "in this section we demonstrate that , given the postulates ( p1 ) - ( p3 ) , the choice of wigner function largely determines the corresponding qcsi scheme . in section  [ setrev ] ,",
    "we briefly review the model of qcsi . in section  [ or ] , we discuss the general concept of an operational restriction , how it overcomes the phenomenon of state - independent contextuality , and why that is necessary for establishing contextuality of the magic states as a resource for qcsi . in sections  [ constr1 ] - [ conscond ] , we describe the the compatibility constraints between the constituents of qcsi . in section  [ ps ] , we provide an algorithm for constructing the free part of the corresponding qcsi scheme , i.e. the allowed clifford unitaries , pauli measurements and stabilizer state preparations .",
    "every qcsi scheme consists of four constituents , namely ( i ) a set @xmath11 of states that can be prepared within the scheme ( the `` free '' states ) , ( ii ) the set @xmath12 of observables which can be directly measured , and which in the present discussion always consists solely of pauli operators , ( iii ) a group @xmath13 of unitary gates ( the `` free gates '' ) , typically taken as the clifford group or a subgroup thereof , and ( iv ) the set @xmath14 of magic states which render the scheme computationally universal . a general qcsi scheme is thus characterized by the quadruple @xmath15 .",
    "the first three of these four constituents are considered `` free '' .",
    "the justification for this terminology is that quantum computations built solely from the free operations can not have a quantum speedup .",
    "this near - classicality of the free operations is made precise by an efficient classical simulation algorithm ( see section  [ effsim ] ) .",
    "it states that if the wigner function of the initial quantum state @xmath16 can be efficiently sampled from then so can the outcome distribution resulting from evolving @xmath16 under the free unitary gates and measurements .",
    "this simulation result is the very justification for invoking a wigner function in the description of qcsi .",
    "when transitioning from local systems of odd prime hilbert space dimension ( qudits ) to local systems of hilbert space dimension 2 ( qubits ) , one encounters a new phenomenon : state - independent contextuality among pauli - observables @xcite , @xcite .",
    "it is incompatible with viewing contextuality as a resource injected into the computation along with the magic states .",
    "the reasons are two - fold .",
    "first , within the framework of qcsi , pauli - measurements are supposed to be free , and if contextuality is already present in those operations , how can it be a resource ? perhaps even worse , for systems of two or more qubits , a contextuality witness can be constructed that classifies _ all _ quantum states of @xmath17 qubits as contextual @xcite , including the completely mixed state .",
    "again , how can contextuality be a resource if it is generic ?    in this paper , the strategy for coping with state - indepenendent contextuality is to place operational restrictions on the pauli observables that can be measured in a qcsi scheme .",
    "the very concept of qcsi already invokes the notion of an operational restriction , since the operations in qcsi are non - universal by design . here",
    ", additional constraints are placed by the postulate ( p3 ) .",
    "the rebit case @xcite shall serve as a model scenario for the concept of operational restrictions , and we briefly review it for illustration .",
    "the mermin - peres square @xcite , @xcite , @xcite embeds into real quantum mechanics ( see fig .  [ mermsq ] ) , and confining to rebit quantum states does therefore not remove state - independent all by itself . rather , the following operational restriction is put in place .",
    "the directly measurable observables are restricted from the set of real pauli operators to tensor products of pauli operators @xmath18 only or @xmath19 only .",
    "accordingly , the free unitaries are restricted from all real clifford gates to those which preserve the set of calderbank - shor - steane ( css ) stabilizer states @xcite,@xcite .",
    "mermin - peres square . for the restriction to css - ness preserving operations , the six observables in the top two rows are in the set @xmath12 while the observables in the bottom row are in @xmath20 but not in @xmath12 . in rebit",
    "qcsi they can be measured individually but not jointly .",
    "the figure is adapted from @xcite.,width=132 ]    let us analyze the free measurements , for the case of @xmath21 rebits , with the css restriction .",
    "the set @xmath12 of directly measurable observables is @xmath22 by directly measuring observables from the above set , measurement outcomes of further pauli observables can be inferred .",
    "for example , @xmath23 .",
    "yet , a value for @xmath24 can be inferred by measuring the commuting observables @xmath25 and @xmath26 separately , and multiplying the outcomes . applying this construction to all possible pairs of commuting observables in @xmath12",
    ", we find the set @xmath20 of observables whose value can be inferred , namely @xmath27 @xmath20 is thus the set of all real and hermitian two - qubit pauli operators . by measurement of observables in the smaller set @xmath12",
    "it is thus possible to fully reconstruct all two - rebit density operators .",
    "the next question of interest is which pauli operators can be measured _",
    "jointly_. for example , while both the observables @xmath24 and @xmath28 are in @xmath20 and even though they commute , in rebit qcsi they can not have their values inferred simultaneously . inferring the value of @xmath24 necessitates the physical measurement of the observables @xmath25 and @xmath26 , and inferring the value for @xmath28 requires the physical measurement of @xmath29 and @xmath30 .",
    "however , the four observables @xmath25 , @xmath26 , @xmath29 and @xmath30 do not all commute .",
    "the measurement of @xmath29 and @xmath30 to infer the outcome of @xmath28 wipes out the value of @xmath24 , and vice versa .",
    "the fact that the observables @xmath24 and @xmath28 can not have their values inferred simultaneously is critical for state - independent contextuality .",
    "namely , the consistency constraint among measurement outcomes for observables in the bottom row of the mermin peres square can no longer be experimentally checked , and is thus effectively removed from the square . as a consequence ,",
    "the remaining available measurements can be described by a non - contextual hidden variable model ( hvm ) .",
    "for example , the value assignment @xmath31 for all observables in the mermin - peres square becomes consistent . in this way , by imposing an operational restriction , state - independent contextuality disappears from qcsi .",
    "this concludes the review of the rebit case . in the subsequent sections we generalize the notions introduced above and apply them to a wider range of settings . as a final remark ,",
    "earlier in this section we stated that the operational restrictions must obey certain consistency conditions .",
    "the above discussion points to two of them : to give rise to a tomographically complete scheme of qcsi on qubits , the set @xmath12 of directly measurable observables must be large enough for the derived set @xmath20 to comprise all pauli operators . at the same time",
    ", @xmath12 must be small enough to dispense with state - independent contextuality .",
    "we now begin to describe the consistency conditions which must hold between the group @xmath13 of free unitary gates in qcsi , the set @xmath12 of directly measurable observables , and the set @xmath11 of free states .",
    "we require that these constituents of qcsi satisfy two constraints , namely @xmath32 and @xmath33 regarding eq .",
    "( [ og ] ) , if @xmath34 can be measured , so can @xmath35 , namely by first applying @xmath36 , then measuring @xmath34 and then applying @xmath37 . likewise",
    ", if @xmath38 can be prepared , so can @xmath39    we regard the set @xmath12 of directly measurable observables as primary among the constituents of the free sector of qcsi , and define the group @xmath13 of free gates and the set @xmath11 of free states in reference to it .",
    "namely , @xmath13 is the largest subgroup of the @xmath1-qubit clifford group @xmath40 that satisfies the property eq .",
    "( [ og ] ) , @xmath41 the free states are those that can be prepared by measurement of observables in @xmath12 .",
    "all other states are considered resources , and must be provided externally if needed .",
    "that is , @xmath42 if and only if there exists an ordered set @xmath43 such that @xmath44 ) do not necessarily commute .",
    "their temporal order is specified by the ordering in @xmath45 .",
    "the angular brackets denote superoperators . with eq .",
    "( [ g ] ) , @xmath46 always holds .",
    "therefore , a totally depolarizing twirl may be implemented , producing @xmath47 from any @xmath1-qubit state .",
    "the free sector of a qcsi scheme is thus fully specified via eqs .",
    "( [ g ] ) and ( [ om ] ) by the set @xmath12 of directly measurable observables . in section  [ conscond ]",
    "we turn to the question of how @xmath12 itself is constructed .",
    "a wigner function is a means of description of qcsis .",
    "the reason for invoking wigner functions is to characterize the near - classicality of the sector of free operations in qcsi .",
    "this proceeds by way of the efficient classical simulation algorithm described in section  [ simulalg ] .",
    "the wigner functions considered here are defined on a phase space @xmath48 , starting from the heisenberg - weyl operators @xmath49 therein , @xmath50 , @xmath51 .    the possible phase conventions @xmath52 are constrained only by the requirement that all @xmath53 , @xmath54 , are hermitian . as we show later , the qcsi schemes considered here and the wigner functions describing them are both fully specified by @xmath10 .",
    "we consider wigner functions of the form @xmath55 , for all @xmath56 , where @xmath57 , @xmath58    this definition satisfies the minimal conditions required of a wigner function @xcite , namely that ( i ) @xmath59 is a quasi - probability distribution defined on a state space @xmath60 , ( ii ) @xmath59 transforms covariantly under the pauli group , @xmath61 , for all @xmath62 , and ( iii ) there is a suitable notion of marginals .    _",
    "remark : _ to simplify the notation , we subsequently omit the superscript @xmath10 in the wigner functions , unless the precise choice of @xmath10 matters .    all previous works on the role of positive wigner functions for qcsi@xcite , @xcite , @xcite , @xcite  are based on a particular family of wigner functions for finite - dimensional state spaces introduced by gibbons _",
    "this is , indirectly , also the case for the present wigner function , and we therefore briefly describe its genealogy .",
    "_ introduced a family of wigner functions for finite - dimensional state spaces based on the concepts of mutually unbiassed bases and lines in phase space . among this family ,",
    "for the special case of odd local dimension , gross @xcite identified a wigner function which is the most sensible finite - dimensional analogue of the infinite - dimensional case @xcite .",
    "this wigner function was written in the form of eqs .",
    "( [ tdef]),([adef ] ) in @xcite , with a special phase convention @xmath10 . for local hilbert space dimension 2",
    ", this special function @xmath10 does not exist , and in the present approach @xmath10 is left as a parameter to vary .",
    "the freedom of choosing the function @xmath10 replaces the freedom of choosing quantum nets in @xcite .",
    "in addition to the above properties ( i ) - ( iii ) , the wigner functions defined in eqs .",
    "( [ tdef ] ) , ( [ adef ] ) have two further relevant properties .",
    "first , for any pair @xmath0 and @xmath63 of operators acting on the hilbert space @xmath64 , it holds that @xmath65 second , for any admissible function @xmath10 , we have the following relation between a quantum state @xmath0 and its wigner functions @xmath2 , @xmath66      now that we have defined our computational setting of qcsi and a class of wigner functions , we state the three postulates we are going to impose , and discuss their roles .",
    "the postulates are :    * the available measurements are tomographically complete for @xmath1-qubit states . *",
    "any @xmath1-qubit state @xmath0 can be reconstructed from the corresponding wigner function @xmath2 . * if @xmath67 then @xmath68 , for all @xmath69 .",
    "we note that ( p1 ) is a constraint on a given qcsi scheme , ( p2 ) a constraint on the corresponding wigner function , and ( p3 ) links the qcsi scheme with its corresponding wigner function .",
    "( p1 ) : as it will turn out , the postulate ( p1 ) is independent of the other two in the sense that it can be excised without harm .",
    "our main results on the hardness of simulating qcsi and on quantum computational universality , theorems  [ simul ] , [ res1 ] - [ effsimgen ] , do not require it as an assumption .",
    "however , we will enforce ( p1 ) in order to obtain true @xmath1-qubit qcsi schemes .",
    "we construct an explicit family of such schemes in section  [ qubitqcsi ] .",
    "( p2 ) : the wigner functions defined through eqs .",
    "( [ tdef ] ) and ( [ adef ] ) all satisfy the postulate ( p2 ) .",
    "( p3 ) : the postulate ( p3 ) is the reason why qcsi schemes and wigner functions come in matching pairs , as will be described in section  [ ps ] .",
    "the motivation for enforcing ( p3 ) is that it gives rise to a notion of classicality based on efficient classical simulation of the free sector of qcsi , as will be discussed in section  [ effsim ] .",
    "this feature is shared with the previously discussed cases of qudits @xcite , @xcite and rebits @xcite .",
    "positivity of a wigner function is generally associated with classicality ; however , we can not refer to this viewpoint for motivation .",
    "the reason is that we do not require a counterpart of ( p3 ) for the free unitaries .",
    "the unitaries in @xmath13 _ may _ introduce negativity into the wigner function , without affecting efficient classical simulability .",
    "the set @xmath12 of directly measurable observables is , in the present setting , always a set of hermitian pauli operators , @xmath70 where @xmath71 is a subset of @xmath72 .    in section  [ constr1 ]",
    "we described how to construct the set @xmath11 of free states given the set @xmath12 of directly measurable observables . but how is the set @xmath12 itself constructed ? to answer this question , we return to the function @xmath10 in eq .",
    "( [ tdef ] ) from which everything follows in the present setting .",
    "the function @xmath52 specifies a function @xmath73 defined via @xmath74 the function @xmath75 is related to the function @xmath10 introduced in eq .",
    "( [ tdef ] ) via @xmath76 thus , @xmath75 is fully determined by @xmath10 .",
    "the converse is not true .",
    "every valid function @xmath75 ( i.e. , one that derives from a function @xmath10 ) determines @xmath10 only up to a translation in phase space .",
    "the function @xmath75 constrains the pauli operators that can possibly be contained in the set @xmath12 .",
    "namely , we have the following lemma .    [ ino ] for any @xmath54",
    ", the measurement of an observable @xmath77 does not introduce negativity into the wigner function if and only if @xmath78=0.\\ ] ]    in eq .",
    "( [ c1 ] ) , @xmath79 $ ] is the symplectic bilinear form defined by @xmath80:=\\textbf{a}_x\\cdot \\textbf{b}_z+ \\textbf{a}_z\\cdot\\textbf{b}_x \\mod 2 $ ] , for all @xmath81 .    _",
    "proof of lemma  [ ino ] .",
    "_ `` only if '' : assume that the condition eq .",
    "( [ c1 ] ) does not hold , i.e. , there exists a pauli operator @xmath82 such that @xmath80=0 $ ] and @xmath83 ( hermiticity ) .",
    "further assume that the system is in the mixed state @xmath84 , which has non - negative @xmath85 , and that @xmath86 is measured .",
    "assume that the outcome is -1 .",
    "the resulting state is @xmath87 .",
    "thus , @xmath88 .",
    "thus , if @xmath89 for some @xmath90 , the measurement of @xmath86 can introduce negativity into wigner functions , hence @xmath91 .",
    "negation of this statement proofs the result .",
    "`` if '' : we assume that the wigner function @xmath2 of the state @xmath0 before the measurement is non - negative , @xmath92 and that the measured observable @xmath86 is such that @xmath93 , for all @xmath90 .",
    "the state @xmath94 after the measurement of the observable @xmath86 with outcome @xmath95 is @xmath96 , and the value of the corresponding wigner function at the phase space point @xmath97 is @xmath98 therein , @xmath99 is the probability of obtaining the outcome @xmath100 in the measurement of @xmath86 .",
    "now , @xmath101 } t_\\textbf{b } \\right ) \\frac{i + ( -1)^s t_\\textbf{a}}{2}}\\\\ \\ ; =   \\displaystyle{\\frac{i + ( -1)^s t_\\textbf{a}}{2 } \\left(\\frac{1}{2^n } \\sum_{\\textbf{b}\\in v| [ \\textbf{b},\\textbf{a}]=0 }   ( -1)^{[\\textbf{u},\\textbf{b } ] } t_\\textbf{b } \\right)}\\\\ \\ ; =   \\displaystyle{\\frac{1}{2^{n+1 } } \\sum_{\\textbf{b}\\in v| [ \\textbf{b},\\textbf{a}]=0 }   ( -1)^{[\\textbf{u},\\textbf{b } ] } \\big(t_\\textbf{b}+(-1)^s t_\\textbf{a}t_\\textbf{b}\\big)}\\\\ \\ ; =   \\displaystyle{\\frac{1}{2^{n+1 } } \\sum_{\\textbf{b}\\in v| [ \\textbf{b},\\textbf{a}]=0 }   ( -1)^{[\\textbf{u},\\textbf{b } ] } \\big(t_\\textbf{b}+(-1)^s t_{\\textbf{a}+\\textbf{b}}\\big)}\\\\ \\ ; =   \\displaystyle{\\frac{1}{2^{n+1 } } \\sum_{\\textbf{b}\\in v| [ \\textbf{b},\\textbf{a}]=0 }   ( -1)^{[\\textbf{u},\\textbf{b } ] }   \\left(1+(-1)^{s+[\\textbf{a},\\textbf{u } ] } \\right ) t_\\textbf{b } } \\\\ \\ ; =   \\displaystyle{\\frac{\\delta_{s,[\\textbf{a},\\textbf{u}]}}{2^{n } } \\sum_{\\textbf{b}\\in v| [ \\textbf{b},\\textbf{a}]=0 }   ( -1)^{[\\textbf{u},\\textbf{b } ] }   t_\\textbf{b } } \\\\ \\ ; = \\displaystyle{\\frac{\\delta_{s,[\\textbf{a},\\textbf{u}]}}{2 } \\left(a_\\textbf{u } + a_{\\textbf{u } + \\textbf{a } } \\right)}. \\end{array}\\ ] ] above , we have used the assumption that @xmath102 for all @xmath90 when transitioning from line 4 to line 5 . applying the result to eq .",
    "( [ pw ] ) we find that @xmath103}}{2 } \\big(w_\\rho(\\textbf{u } ) + w_\\rho(\\textbf{u } + \\textbf{a } ) \\big).\\ ] ] by assumption , the r.h.s .",
    "is always non - negative . for the outcome @xmath100 to possibly occur",
    ", it is required that @xmath104 .",
    "hence , @xmath105 , for all @xmath97 .",
    "@xmath106    we define the set @xmath12 of directly measurable observables to be the largest possible set of pauli observables allowed by lemma  [ ino ] , @xmath107 with @xmath108=0\\}$ ] .",
    "_ example : _ to illustrate the usefulness of lemma  [ ino ] , consider the following choice for @xmath10 . for brevity ,",
    "we restrict to two rebits .",
    "@xmath59 is specified by@xmath109 arranging all observables in @xmath110 apart from the identity in the mermin - peres square , @xmath111{merminsquarefs}\\ ] ] it is evident that every observable @xmath86 is part of at least one commuting triple with @xmath112 .",
    "hence , apart from the identity , no observable is in @xmath12 , i.e. , @xmath113 .",
    "the corresponding qcsi scheme is thus the exact opposite of tomographically complete : nothing can be measured at all !",
    "we find that not for every function @xmath10 the wigner function @xmath59 can be paired with a matching qcsi scheme .    for further illustration of lemma  [ ino ] , we have the following implication .    [ notall ] consider a wigner function as defined in eqs .",
    "( [ adef ] ) , ( [ tdef ] ) , for @xmath17 qubits .",
    "then , there always exists a pauli observable whose measurement does not preserve positivity .    thus , no qcsi scheme in which all pauli observables are directly measurable can satisfy the property ( p3 ) .",
    "the original qcsi scheme @xcite on qubits is one of those schemes , and it is therefore out of scope of the present analysis .    _ proof of lemma  [ notall ] .",
    "_ consider the mermin - peres square as displayed in fig .",
    "[ mermsq ] .",
    "irrespective of the sign conventions of the pauli observables contained in it , there is always at least one context with @xmath114 .",
    "thus , by lemma  [ ino ] , for @xmath17 the measurement of at least three pauli observables introduces negativity into the wigner function .",
    "@xmath106    furthermore",
    ", regarding the free states , an immediate consequence of property ( p3 ) is that all free states @xmath115 are non - negatively represented by @xmath85 .",
    "all free states @xmath115 can be created from the completely mixed state @xmath47 , by measurement of observables in @xmath12 , and @xmath116 for any @xmath10 .",
    "then , with property ( p3 ) , @xmath117 , for all @xmath115 . by eq .",
    "( [ om1 ] ) , free states remain non - negatively represented upon action of free unitary gates @xmath118 .      we know from lemma  [ notall ] that for @xmath17 qubits",
    ", the set @xmath12 of directly measurable observables is always strictly smaller than the set of all pauli observables .",
    "how is that not in conflict with tomographic completeness ( p1 ) ?    the reason  as was already mentioned in section  [ or]is that some pauli observables , while not directly measurable , can nonetheless have their value inferred by measurement .",
    "for example , consider three pauli observables @xmath119 , @xmath120 , such that @xmath121=0 $ ] and @xmath122 .",
    "then @xmath123 can have its value inferred by measuring @xmath124 and @xmath125 , and multiplying the outcomes .",
    "for suitable sets @xmath12 , all pauli observables can have their value inferred , even if not directly measured .",
    "this suffices to satisfy ( p1 ) .",
    "[ mdef ] @xmath126 is the set of pauli observables whose value can be inferred from a _ single copy _ of the given quantum state , by measurement of other pauli observables from the set @xmath12 and classical post - processing .",
    "the set @xmath20 is typically larger than the set @xmath12 of observables which can be directly measured .",
    "this was illustrated by an example in section  [ or ] , namely @xmath127 , @xmath128 . in terms of @xmath129 ,",
    "the condition ( p1 ) of tomographic completeness reads @xmath130 we now provide a general characterization of the set @xmath20 generated by the set @xmath12 .",
    "[ vmchar ] for any @xmath10 , the set @xmath129 has the properties that ( i ) @xmath131 , and ( ii ) for any @xmath132 , @xmath90 with @xmath80=0 $ ] , it holds that @xmath133 if and only if @xmath134 .",
    "_ proof of lemma  [ vmchar ] .",
    "_ property ( i ) merely states that what can be directly measured can have its value inferred .",
    "regarding ( ii ) , the observable @xmath135 has its value inferred as follows .",
    "first , @xmath136 is measured directly .",
    "then , the procedure for inferring the value of @xmath82 is applied .",
    "since @xmath86 commutes with @xmath82 , the former measurement does nt interfere with the latter , and @xmath137 . finally , with eq .",
    "( [ c1 ] ) , @xmath138 .",
    "thus , if @xmath134 then @xmath139 . the reverse direction holds by symmetry in @xmath140 .",
    "@xmath106    _ example .",
    "_ assume that @xmath141 .",
    "the outcome of the observable @xmath28 can then be inferred by measurement , i.e. @xmath142 . the procedure for the measurement of the observable @xmath28 , given the above set @xmath12 of directly measurable observables , is the following .",
    "first , the observable @xmath143 is measured , and second the commuting observables @xmath25 and @xmath26 are measured .",
    "the measurement outcome @xmath144 then is @xmath145 the key point of this example is that not all pairs among the measured pauli observables @xmath25 , @xmath26 and @xmath143 commute ; yet in the above expression for @xmath146 we treated them as if they did .",
    "the reason that this is possible is the following .",
    "since @xmath143 does not commute with @xmath25 and @xmath26 , the measurements of @xmath25 and @xmath26 after the measurement of @xmath143if taken separately  do not reveal any information about the initial state .",
    "individually , their outcomes are completely random , whatever the state prior to the @xmath143-measurement is . however , @xmath25 and @xmath26 mutually commute , and hence the separate measurement of @xmath25 and @xmath26 implies a valid measurement outcome for the correlated observable @xmath24 , namely @xmath147 . furthermore , since @xmath24 does commute with @xmath143 , @xmath148 represents the outcome of a @xmath24-measurement on the initial state , and @xmath149 , as claimed .",
    "let us now verify that @xmath142 follows from the properties established in lemma  [ vmchar ] .",
    "first , with property ( i ) of lemma  [ vmchar ] , @xmath150 implies @xmath151 .",
    "then , using property ( ii ) with @xmath151 , @xmath152 , it follows that @xmath153 . finally , again with property ( ii ) , since @xmath154 and @xmath153 , it follows that @xmath142 .",
    "we note that the above procedure of inferring measurement outcomes by the physical measurement of non - commuting observables is reminiscent of the syndrome measurement in subsystem codes @xcite , @xcite , with the bacon - shor code @xcite , @xcite and topological subsystem codes @xcite as prominent examples .    back to the general scenario",
    ", an observable @xmath86 can have its value inferred , i.e. , @xmath155 , if there exists a resolution @xmath156 where all @xmath157 , and @xmath158=0,\\ ; \\forall i=1, .. ,n-1.\\ ] ] the resolution eq .",
    "( [ resol ] ) of @xmath159 represents a measurement sequence for inferring the value of @xmath86 , starting with the measurement of @xmath160 and ending with the measurement of @xmath161 .",
    "the inferred value is @xmath162 .",
    "finally , we introduce a generalization of the set @xmath20 of pauli observables whose value can be inferred .",
    "namely , we denote by @xmath163 , @xmath164 , a set of observables whose value can be inferred _ jointly _ in qcsi . for short ,",
    "we call such a set @xmath163 a `` set of jointly measurable observables '' .    [ defc ]",
    "a set @xmath163 , @xmath164 , of commuting pauli observables is jointly measurable if the outcomes for all observables in @xmath163 can be simultaneously inferred from measurement of observables in @xmath12 on a _ single copy _ of the given quantum state @xmath0 .",
    "the sets @xmath163 of simultaneously measurable observables will become important in section  [ nwnc ] , where we discuss the relation between contextuality and negativity of wigner functions .",
    "some examples for possible sets @xmath163 are ( i ) @xmath165 , for any @xmath166 , ( ii ) any commuting subset of @xmath12 , and ( iii ) @xmath167 , for @xmath168 , @xmath169 and @xmath170=0 $ ] .    we have the following characterization of the sets @xmath163 of simultaneously measurable observables .    [ c+ ]",
    "consider a set @xmath163 of simultaneously measurable observables , and @xmath171 .",
    "then , @xmath172 .",
    "we postpone the proof of lemma  [ c+ ] until section  [ nosic ] .",
    "once the phase convention @xmath10 for the @xmath1-qubit pauli operators is given ( cf .",
    "( [ tdef ] ) ) , the wigner function eq .",
    "( [ adef ] ) satisfying ( p2 ) and the free sector of the corresponding qcsi scheme satisfying ( p3 ) are fully specified .",
    "they are obtained through the following steps :    1 .",
    "construct the wigner function @xmath85 via its definition eqs .",
    "( [ tdef ] ) , ( [ adef ] ) .",
    "2 .   compute the function @xmath75 defined in eq .",
    "( [ 3 t ] ) from the function @xmath10 .",
    "construct the set @xmath12 of directly measurable observables via eq .",
    "( [ omax ] ) .",
    "3 .   construct the group @xmath13 of free unitary gates via eq .",
    "( [ g ] ) , and set @xmath11 of free states via eq .",
    "( [ om ] ) .",
    "in addition , for tomographic completeness ( p1 ) it needs to be checked that every pauli observable @xmath86 has a resolution eq .",
    "( [ resol ] ) .    to summarize , in this section we have stated minimal requirements for any qcsi scheme on qubits and its corresponding wigner function .",
    "we have shown that once the function @xmath10 is provided , the free sector of the corresponding qcsi scheme is fully specified . to reflect this fact in our notation ,",
    "we subsequently denote qcsi schemes by @xmath173 instead of @xmath174 .",
    "implicit in this notation is that matching pairs of a qcsi scheme @xmath173 and a wigner function @xmath59 satisfy ( p3 ) .",
    "the requirement ( p3 ) of positivity preservation of the wigner function has a bearing on classical simulation of qcsi , which we describe in this section .",
    "below we present an efficient classical simulation method based on sampling , which leads to the following result .",
    "[ simul ] for any qcsi scheme @xmath175 , if ( i ) the wigner function @xmath176 of the initial state @xmath16 can be efficiently sampled from , and ( ii ) the phase convention @xmath177 can be efficiently evaluated for all @xmath132 , then the distribution of measurement outcomes can be efficiently sampled from .      for the purpose of classical simulation , we make an alternation to the present qcsi scheme , which , however , does not affect its computational power .",
    "namely , we absorb the unitary gates in the measurements , such that only state preparations and measurements remain as free operations . here",
    "we take the viewpoint that all there is to simulate about a quantum computation is the joint outcome distribution of measurements performed in course of the computation . if the unitaries can be removed without altering the outcome distribution , then there is certainly no loss in removing them .",
    "but there is a gain : as is made explicit in section  [ disc ] , the simulation algorithm of section  [ simulalg ] can handle free unitaries @xmath178 that introduce negativity into the wigner function of the processed quantum state .",
    "the general procedure is outlined in fig .",
    "[ conj ] . consider a qcsi circuit which is an alternation of unitary gates @xmath179 and projective measurements represented by projectors @xmath180 , @xmath181 where the factors in the product are ordered from right to left .",
    "therein , @xmath182 is the binary vector of all measurement outcomes , and @xmath183 is @xmath182 restricted to the measurement outcomes obtained prior to the gate @xmath184 .",
    "we thus allow unitary gates and measurements to depend on previously obtained measurement outcomes .",
    "such conditioning is essential for the working of qcsi .",
    "the measurements of observables @xmath185 are propagated backwards in time to act on the initial state , by conjugation under the interspersed unitaries . since",
    "only the measurement statistics is of interest , the trailing unitaries may be removed from the resulting circuit.,width=302 ]    now denote by @xmath186 the unitaries accumulated up to step @xmath187 , @xmath188 therein , the ordering of operations is the same as in eq .",
    "( [ circ ] ) . the circuit @xmath189 of eq .",
    "( [ circ ] ) may then be rewritten as @xmath190 thus , if the measured observables in the original sequence of operations were @xmath191 , the corresponding observables in the equivalent sequence are @xmath192 by eq .",
    "( [ og ] ) , if @xmath193 , then @xmath194 . therefore , a qcsi scheme with set @xmath12 of measurable observables and group @xmath13 of unitary gates is equivalent to a qcsi scheme with set @xmath12 of measurable observables and no unitaries at all .",
    "the classical simulation algorithm for the setting of theorem  [ simul ] is given in table  [ algo1 ] .",
    "l * algorithm 1 * +   +    any sample @xmath97 from a non - negative wigner function has a definite value assignment for all observables in the pauli group .",
    "namely , for any @xmath54 , the measurement outcome for the pauli observable @xmath86 is @xmath195}.\\ ] ] the value assignment eq .",
    "( [ valass ] ) is a direct consequence of the update rule eq .",
    "( [ wigup ] ) .",
    "namely , in the l.h.s . of eq .",
    "( [ wigup ] ) assume that the probability @xmath99 for obtaining the outcome @xmath196 in a measurement of a pauli observable @xmath86 on a state @xmath0 is non - zero .",
    "then , the r.h.s . of eq .",
    "( [ wigup ] ) implies that @xmath197 $ ] , or , equivalently , @xmath198}$ ] .    for illustration of the state update rule in the above classical simulation algorithm , consider two measurement sequences for the state of one qubit , namely ( i ) repeated measurements of the pauli observable @xmath199 , and ( ii ) alternating measurements of the pauli observables @xmath200 and @xmath201 .",
    "assume that the sample from the wigner function of the initial state is @xmath97 . regarding ( i ) , according to the classical simulation algorithm , the ontic states after one or a larger number of measurements are @xmath202 or @xmath203 .",
    "either way , the reported measurement outcome is @xmath204}$ ] , since @xmath205=0 $ ] . for any sample @xmath202 from the input distribution ,",
    "the sequence of measurement outcomes is thus constant , as required . regarding ( ii ) , since @xmath206=1 $ ] , from the second measurement onwards the outcomes produced by the classical simulation are completely random and uncorrelated , as required",
    ".    _ proof of theorem  [ simul ] . _",
    "the theorem follows from the efficiency and the correctness of the above classical simulation algorithm .",
    "_ efficiency : _ both the pre - processing of removing the unitaries from the circuit and the classical simulation algorithm itself need to be considered .",
    "\\(1 ) pre - processing . we need to track the evolution of pauli observables @xmath86 under conjugation by gates @xmath118 , as described in eq .",
    "( [ obsrel ] ) . this can be done efficiently within the stabilizer formalism @xcite .",
    "however , the stabilizer formalism uses its own phase convention @xmath207 for the pauli operators , @xmath208 , such that @xmath207 can be efficiently evaluated .",
    "suppose , @xmath209 .",
    "then , @xmath210 , with @xmath211 by assumption , @xmath10 can be efficiently evaluated , and hence can @xmath212 , for any @xmath178 .",
    "\\(2 ) classical simulation algorithm .",
    "the efficiency of the above classical simulation algorithm is evident .    _ correctness : _ assume that the classical simulation algorithm samples correctly from the wigner function of the state @xmath213 after the @xmath214-th measurement in the sequence .",
    "we now show that under this assumption ( i ) the above classical simulation algorithm produces the correct probability distribution for the @xmath215-th measurement , and ( ii ) correctly samples from the wigner function of the conditional state @xmath216 after the @xmath215-th measurement .",
    "\\(i ) according to the value assignment eq .",
    "( [ valass ] ) of the classical simulation algorithm , the probability @xmath99 for obtaining the outcome @xmath95 in the measurement of the observable @xmath86 on the state @xmath213 is @xmath217,s } w_{\\rho_t}(\\textbf{u}).\\ ] ] as is easily verified by direct calculation , @xmath218,s}.\\ ] ] combining the last two equations , and using the property eq .",
    "( [ trip ] ) , we find that @xmath219 which is the quantum - mechanical expression .",
    "\\(ii ) consider the wigner function @xmath220 for the state @xmath213 after step @xmath214 in the expansion @xmath221 . at time @xmath222 , the observable @xmath86 is measured , with outcome @xmath95 .",
    "then , from the value assignment eq .",
    "( [ valass ] ) , only the phase space points @xmath97 with @xmath223 $ ] contribute to conditional density matrix @xmath224 .",
    "furthermore , per step 2b of the classical simulation algorithm , the update for @xmath225-distributions over phase space is @xmath226 .",
    "therefore , the wigner function for the ( normalized ) conditional state @xmath224 , according to the classical simulation algorithm , is @xmath227,s } w_{\\rho_t}(\\textbf{u } ) \\frac{\\delta_\\textbf{u } + \\delta_{\\textbf{u}+\\textbf{a}}}{2}.\\ ] ] hence , @xmath228,s}\\frac{w_{\\rho_t}(\\textbf{v } ) + w_{\\rho_t}(\\textbf{v}+\\textbf{a})}{2}$ ] , which is the quantum - mechanical expression eq .",
    "( [ wigup ] ) .    by assumption of theorem  [ simul ] ,",
    "the wigner function of the initial state @xmath229 is correctly sampled from .",
    "thus , with the above statements ( i ) and ( ii ) , it follows by induction that all sequences of measurement outcomes occur with the correct probabilities .",
    "@xmath106      a notable property of the above simulation method is that , for any wigner function employed therein , covariance and preservation of positivity under the group @xmath13 of free gates are not required .",
    "this is a consequence of the reformulation of qcsi in section  [ reform ] , where the free unitary gates were eliminated .",
    "it is in sharp contrast to the previously considered cases of qudits @xcite,@xcite and rebits @xcite , where covariance and preservation of positivity under @xmath13 were critical for the classical simulation by sampling .",
    "these points , and the roles remaining for covariance and positivity preservation in the present simulation method are discussed below .      as an example , consider a quantum circuit for a single qubit consisting of a hadamard gate followed by a measurement of the pauli observable @xmath200 .",
    "given is a source that samples from the non - negative wigner function of the initial state @xmath16 , and the task is to sample from the output distribution of the measurement .",
    "a classical simulation method based on wigner function covariance would , in the first step , convert the source that samples from @xmath230 into a source that samples from @xmath231 , using covariance . in the second step",
    ", it would , for each sample @xmath202 drawn from @xmath231 , output the value @xmath232}$ ] , with @xmath233 such that @xmath234 ; cf .",
    "( [ valass ] ) .",
    "but there is a problem :    [ noncov ] for any number @xmath1 of qubits , no wigner function of the type defined in eqs .",
    "( [ tdef ] ) , ( [ adef ] ) is covariant under a hadamard gate on a single qubit .",
    "step 1 of the above procedure can not be performed !    _ proof of lemma  [ noncov ] .",
    "_ we only discuss @xmath235 , the generalization to other @xmath1 is straightforward .",
    "consider the phase point operator @xmath236 .",
    "for @xmath85 to be covariant under @xmath237 , we require that @xmath238 , for some @xmath202 . now consider the sum of signs @xmath239 , and how it transforms under @xmath237 .",
    "since @xmath240 , @xmath241 , and @xmath242 , it follows that @xmath243 .",
    "however , under the transformation @xmath244 , the signs of an even number of @xmath245 are flipped , hence @xmath246 remains unchanged mod 4 .",
    "thus @xmath247 for any @xmath202 , for any @xmath10 .",
    "@xmath106      as an example , consider a quantum circuit for two qubits consisting of a hadamard gate @xmath248 on the first qubit followed by a measurement of the pauli observable @xmath29 .",
    "assume the initial state @xmath16 is the completely mixed state , for which each wigner function of the type eq .",
    "( [ adef ] ) is positive and can be efficiently sampled from .",
    "the task is to sample from the output distribution of the measurement .",
    "again , a classical simulation method based on the preservation of wigner function positivity under free unitaries again runs into a problem :    [ nonpospres ] for @xmath17 , for no wigner function of type eq .",
    "( [ adef ] ) positivity is preserved for all states under a hadamard gate on a single qubit .",
    "_ proof of lemma  [ nonpospres ] .",
    "_ consider a real stabilizer state @xmath0 of two qubits , @xmath249 , and w.l.o.g the hadamard gate @xmath248 on the first qubit . as a consequence of lemma  [ ino ] , @xmath67 if and only if @xmath250 .",
    "likewise , for the transformed state , @xmath251 if and only if @xmath252 . now consider the mermin - peres square",
    ". there are six contexts , i.e. , sets of commuting pauli observables such that within each set the observables multiply to the identity times @xmath253 .",
    "whatever the phase convention @xmath10 for the nine pauli operators in the square , there is always an odd number of contexts for which @xmath254 .",
    "namely , for the standard phase convention , there is one such context .",
    "if the sign of any of the pauli observables is flipped , then @xmath255 in the corresponding horizontal and vertical context .",
    "hence the number of contexts with @xmath256 remains odd .",
    "the action of @xmath248 subdivides the set of the six contexts into three orbits of size 2 .",
    "since the number of non - zero values of @xmath75 is odd , there must be at least one orbit in which one @xmath75 has the value 0 and the other has the value 2 . within this orbit ,",
    "choose @xmath257 such that @xmath250 .",
    "hence , @xmath258 .",
    "thus , positivity is not preserved under @xmath248 , for any phase convention @xmath10 . @xmath106    on the other hand , the simulation method of section  [ reform ] has no problem with the above example circuit .",
    "namely , there are wigner functions of the type eq .",
    "( [ adef ] ) for which the hadamard gate on a single ( the first ) qubit is in the group of free gates , @xmath259 , and @xmath29 is in the set of directly measurable observables , @xmath260 .",
    "an example for such a wigner function is given in section  [ qubitqcsi ] .",
    "we observe that the negativity which can be introduced into a wigner function by the free unitary gates @xmath13 is of a very special kind .",
    "namely , it can be lifted by redefinition of the wigner function according to @xmath261 , @xmath262 , for some @xmath178 .    to summarize , while in the present framework the free measurements are required to preserve positivity of the wigner function , no such constraint needs to be imposed on the free unitaries .",
    "the amount of negativity introduced into the wigner functions by the free unitaries can be large , as measured by sum negativity @xcite .",
    "however , it is always of a special kind . in this sense",
    ", our observation complements the recent finding @xcite that a small amount of sum negativity  of any kind  does not compromise the efficiency of a suitable classical simulation algorithm .",
    "the requirement ( p3 ) on measurements to preserve positivity of the wigner function has implications for contextuality in qcsi , which we discuss in this section . to begin ,",
    "we define the notion of `` non - contextual hidden variable model '' ( nchvm ) to which our results refer .",
    "recall that @xmath12 is the set of pauli observables which can be directly measured in qcsi , @xmath20 is the set of observables which can have their value inferred by measurement of observables in @xmath12 , and any @xmath164 is a set of pauli observables which can have their value inferred jointly , from a single copy of the given quantum state .",
    "[ hvm1 ] consider a quantum state @xmath0 and a set @xmath12 of observables grouping into contexts @xmath163 of simultaneously measurable observables .",
    "a non - contextual hidden variable model @xmath263 consists of a probability distribution @xmath264 over a set @xmath265 of internal states and a set @xmath266 of value assignment functions @xmath267 that meet the following criteria .    *",
    "each @xmath268 is consistent with quantum mechanics : for any set @xmath163 of jointly measurable observables there exists a quantum state @xmath38 such that @xmath269 * the distribution @xmath264 satisfies @xmath270    we say that a quantum state @xmath0 is contextual if no non - contextual hvm according to def .  [ hvm1 ] exists that correctly reproduces the probability distributions @xmath271 of measurement outcomes for all sets @xmath163 of jointly measurable observables .",
    "the states @xmath38 in eq .",
    "( [ eq : jointeigenvalue ] ) of def",
    ".  [ hvm1 ] are auxiliary . their purpose is to ensure that the value assignments @xmath272 correspond to compatible eigenvalues . as a direct consequence of eq .",
    "( [ eq : jointeigenvalue ] ) , the non - contextual value assignments @xmath273 must all satisfy a set of compatibility constraints .",
    "[ prodconstr ] for any triple @xmath274 of simultaneously measurable observables and any internal state @xmath275 of an nchvm @xmath263 it holds that @xmath276     returning to def .",
    "[ hvm1 ] , it may _ a priori _ seem that the condition ( ii ) is not sufficiently stringent , and that one should rather require all outcome distributions for sets @xmath163 of jointly measurable observables to be correctly reproduced by the hidden variable model . that is",
    ", @xmath277 therein , @xmath278 is the probability distribution for the measurement outcomes @xmath279 of the set @xmath163 of simultaneously measurable observables given the quantum state @xmath0 , and @xmath280 is the conditional probability for the measurement outcomes @xmath279 given the hvm internal state @xmath281 .",
    "however , eq .  ( [ cprob ] )",
    "is implied by eq .",
    "( [ aexpct ] ) .",
    "[ probs ] an nchvm according to def .",
    "[ hvm1 ] that correctly reproduces all expectation values of observables @xmath282 via eq .",
    "( [ aexpct ] ) also correctly reproduces the outcome probability distributions eq .",
    "( [ cprob ] ) for all sets @xmath283 of jointly measurable observables .",
    "_ proof of lemma  [ probs ] .",
    "_ assume the observables in @xmath163 are algebraically independent , i.e. , there are no non - trivial product relations among them , and denote by @xmath284 the set of all products of observables in @xmath163 .",
    "quantum mechanically , @xmath285 , where the effect @xmath286 is @xmath287 therein , in the last line we have used that the measured eigenvalues @xmath288 satisfy the same consistency relation eq .",
    "( [ valco ] ) as the non - contextual value assignments .",
    "then , @xmath289 in the last line above , we have used the fact that the value assignments @xmath290 are deterministic and that the conditional probabilities @xmath280 are thus @xmath225-functions .",
    "@xmath106      consider the value assignment @xmath291 first , by eq .",
    "( [ c1 ] ) , for any three commuting and directly measurable observables @xmath292 we have @xmath293 .",
    "thus , the above value assignment is compatible with all available direct measurements .",
    "second , the value of any observable @xmath294 is inferred by measuring a suitable observable @xmath136 for which @xmath295=0 $ ] , and then running a procedure to infer the value of @xmath82 . with eq .",
    "( [ c1 ] ) , for all such observables @xmath86 it holds that @xmath293 , and the assignment eq .",
    "( [ 1 ] ) is thus consistent .",
    "while the mermin - peres square and its cousins are present , the operational restriction enforced by condition eq .",
    "( [ c1 ] ) prevents obstructions to the assignment eq .",
    "( [ 1 ] ) from being established as experimental facts .",
    "hence at least one consistent assignment exists , and there is no state - independent contextuality in this setting .",
    "we are now in the position to prove lemma  [ c+ ] of section [ conscond ] .",
    "_ proof of lemma  [ c+ ] .",
    "_ if there is a set @xmath163 with @xmath171 such then @xmath296 then the value assignment @xmath297 , @xmath298 , is inconsistent .",
    "@xmath106    _ remark : _ in the companion paper @xcite , the postulate ( p3 )",
    "is replaced by the requirement that the set @xmath20 of observables with inferable values is free of state - independent contextuality , given the set @xmath12 of directly measurable observables .",
    "with the above , we find that all such qcsi schemes are included in the present classification .",
    "the converse also holds : for every qubit qcsi scheme in which the set @xmath20 of observables is free of state - independent contextuality , there is a wigner function @xmath59 such that the postulate ( p3 ) holds .",
    "this can be seen as follows .",
    "if @xmath20 is free of state - independent contextuality given the set @xmath12 of directly measurable observables , then there exists at least one consistent value assignment @xmath299 .",
    "we may now re - phase the inferable observables , @xmath300 , for all @xmath301 , such that the new observables @xmath302 have a consistent value assignment @xmath303 .",
    "this means that for all @xmath304 , @xmath305 with @xmath80=0 $ ] it holds that @xmath306 . with eq .",
    "( [ 3 t ] ) it thus follows that @xmath307 for all @xmath132 , @xmath308 with @xmath80=0 $ ] .",
    "thus , with lemma  [ ino ] , the measurement of any observable @xmath309 does not introduce negativity into the wigner function defined by @xmath310 .      in accordance with existing results @xcite , @xcite ,",
    "also for the present setting of qcsi on qubits it holds that a non - negative wigner function always implies the viability of a non - contextual hidden variable model .",
    "[ pwnc ] consider a quantum state @xmath0 with wigner function @xmath311 given by eq .",
    "( [ adef ] ) . if @xmath312 then the measurement of all pauli observables @xmath136 can be described by a non - contextual hidden variable model .",
    "_ proof of theorem  [ pwnc ] . _",
    "the wigner function itself constitutes a non - contextual hvm , with set of internal states @xmath313 , probability distribution @xmath314 over the internal states , and the conditional probabilities @xmath315 given by the wigner functions of the effects .",
    "using eq .",
    "( [ trip ] ) , the probability @xmath316 for measuring the context @xmath163 and obtaining the set @xmath279 of measurement outcomes is @xmath317 if @xmath318",
    "then @xmath2 may be regarded as a probability distribution over the space @xmath319 of internal states of a hidden variable model .",
    "if furthermore @xmath320 for all @xmath97 , then we may regard @xmath321 as the conditional probability for obtaining the outcome @xmath279 in the measurement of the observables in @xmath163 , given the hvm internal state @xmath97 .",
    "then , eq .  ( [ bayes ] ) is bayes rule for computing the probability @xmath316 .    it remains to check that the conditional probabilities @xmath315 assigned by the wigner functions of the effects @xmath286 are compatible with def .",
    "[ hvm1 ] of an nchvm .    item ( i ) of def .",
    "consider contexts wit a single observable @xmath86 .",
    "a definite value assignment for all internal states @xmath97 has already been established in eq .",
    "( [ valass ] ) .",
    "it corresponds to @xmath322}.\\ ] ] the conditional probabilities @xmath323 thus have values in the required range @xmath324 .",
    "consistency of the value assignments .",
    "( [ valass ] ) yields @xmath325 , for all @xmath81 . by lemma  [ c+ ] , if @xmath326 form a jointly measurable set , then @xmath327 .",
    "hence , @xmath328 for such pairs @xmath81 , as required by lemma  [ prodconstr ] .",
    "therefore , for all contexts @xmath163 , the observables @xmath329 have a joint eigenstate @xmath330 with @xmath331 , and thus , the state @xmath332 has eigenvalues @xmath333}$ ] for the observbles @xmath329 .",
    "the condition eq .",
    "( [ eq : jointeigenvalue ] ) is thus satisfied for the value assignment eq .",
    "( [ valass ] ) .    item ( ii ) of def .",
    "[ hvm1 ] . since all observables @xmath155 only have eigenvalues @xmath253 ,",
    "@xmath334}-\\delta_{1,[\\textbf{a},\\textbf{u}]}\\right)}\\vspace{1mm}\\\\ & = & \\displaystyle{\\sum_{\\textbf{u}\\in v } w_\\rho(\\textbf{u } ) ( -1)^{[\\textbf{a},\\textbf{u}]}}\\vspace{1mm}\\\\ & = & \\displaystyle{\\sum_{\\textbf{u}\\in v } q_\\rho(\\textbf{u})\\lambda_\\textbf{u}(\\textbf{a})}. \\end{array}\\ ] ] above , the second line follows by eq .",
    "( [ trip ] ) , the third by eq .",
    "( [ effwi ] ) and the fifth by eq .",
    "( [ valass ] ) .",
    "@xmath106     state space for the one - qubit states @xmath335 .",
    "the physical states lie within or on the bloch sphere ( bs ) .",
    "the two tetrahedra contain the states positively represented by the wigner functions @xmath85 and @xmath336 , respectively .",
    "the state space describable by a non - contextual hvm is a cube with corners @xmath337 ; also see @xcite .",
    "it contains the bloch ball.,width=283 ]    the converse of theorem  [ pwnc ] does not hold : there are quantum states with a non - contextual hvm description for which all considered wigner functions are negative .",
    "this is illustrated in fig .",
    "[ qubithvm ] for the example of a single qubit , where all physically allowed states have an hvm description @xcite .",
    "the one - qubit states are all of the form @xmath338 , and the physical such states are constrained by @xmath339 .",
    "the set of states describable in terms of a non - contextual hvm is a cube , @xmath340 , containing all physical states .",
    "the eight extremal states @xmath187 of this cube have definite value assignments @xmath341 for the observables @xmath342 , @xmath343 , @xmath200 .    up to equivalence under translation , there are two one - qubit wigner functions of type eq .",
    "( [ adef ] ) , namely the wigner function @xmath85 defined by the phase point operator at the origin @xmath344 , and the wigner function @xmath336 defined by @xmath345 .",
    "the phase space for these wigner functions is @xmath346 , and @xmath85 , @xmath336 thus have four extremal states each . if these extremal states are combined , the extremal states of the non - contextual hvm are recovered .",
    "each wigner function by itself has only half of the extremal states of the hvm , and the set of positively represented states is thus smaller .",
    "furthermore , there are physical states which are negatively represented by both @xmath85 and @xmath336 ; see fig .",
    "[ qubithvm ] .",
    "contextuality and negativity of the wigner functions eq .",
    "( [ adef ] ) are thus not the same .    _ remark : _ while there are physical one - qubit quantum states which are negatively represented by both @xmath85 and @xmath336 , every state @xmath338 , with @xmath347 , can be described by an ensemble @xmath348 such that @xmath349 and @xmath350 .",
    "a generalization of this fact to @xmath1-qubit systems will be of relevance in section  [ cr ] .",
    "[ res1 ] for any qcsi scheme @xmath175 , if the input magic state @xmath16 can be described by a non - contextual hvm , then the quantum state @xmath351 at time @xmath214 , conditioned on the prior measurement record @xmath352 , can be described by a non - contextual hvm , for any @xmath214 and any @xmath182 .    before we give the proof of theorem  [ res1 ] , we need to set up some more notation .",
    "we observe that the state space of a general non - contextual hvm is larger than the state space of an hvm deriving from a non - negative wigner function ; see the discussion of a single qubit in section  [ nwnc]/ fig .",
    "[ qubithvm ] .",
    "the enlarged state space @xmath353 is finite , yet maximal in the sense that , for every value assignment @xmath354 satisfying the consistency condions eq .",
    "( [ valco ] ) , there is a corresponding internal state @xmath275 such that @xmath355 .",
    "we choose to have this state space @xmath265 acted upon by the group @xmath319 , dividing @xmath265 into orbits .",
    "namely , given an element @xmath275 specified by the value assignment @xmath356 , there is another internal state @xmath357 , defined through the value assignment @xmath358},\\;\\forall \\textbf{a } \\in v,\\ ] ] for all @xmath97 . in eq .",
    "( [ transl ] ) , we have set @xmath359 for notational simplicity . it is easily seen that @xmath360 , for all @xmath97 .",
    "the condition to check is the consistency of the value assignment in item ( ii ) of def .",
    "( [ valco ] ) is preserved under the change @xmath361}$ ] , for any @xmath97 .",
    "the group action of @xmath319 on @xmath265 defined through eq .",
    "( [ transl ] ) labels the elements of @xmath265 in a fashion convenient for the subsequent discussion .",
    "_ proof of theorem  [ res1 ] . _",
    "the proof of theorem  [ res1 ] is by induction .",
    "we assume that there exists an hvm with probability distribution @xmath362 which describes the quantum state @xmath363 , conditioned on the previous measurement record @xmath352 .",
    "we then show that there is an hvm with probability distribution @xmath364 which describes the quantum state @xmath365 .",
    "to establish this result , we need the relation between @xmath364 and its precursor @xmath362 .",
    "denoting the observable measured in the @xmath214-th time step of the computation by @xmath366 and the corresponding measurement outcome by @xmath367 , the required relation is    [ hvmrelat ] @xmath368    therein , @xmath369 is the hvm prediction for the probability of obtaining the outcome @xmath370 in the measurement of @xmath371 , given a prior measurement record @xmath352 .",
    "( [ hvmrelat ] ) will be justified a posteriori .",
    "namely , with these assignments , the induction argument works out .    with eq .",
    "( [ aexpct ] ) in def .",
    "[ hvm1 ] , the induction assumption is @xmath372 therein , we have suppressed the dependence on the measurement record , to simplify the notation .",
    "we need to show that @xmath373 and that @xmath374 , with @xmath375 the quantum mechanical value for the probability of the outcome @xmath370 given the prior measurement record @xmath352 .",
    "first , regarding the probability of finding @xmath370 , @xmath376 we thus reproduce the quantum mechanical expression within the hvm . above , in transitioning from the second to the third line we have invoked the induction assumption .",
    "second , regarding the expectation values of the @xmath86 on @xmath365 , the hvm prediction is @xmath377 reordering the sum via the substitution @xmath378 , and using eq .",
    "( [ transl ] ) , the second term in the last line equals @xmath379}.}\\ ] ] we now distinguish between the case where @xmath380 commute and where they do nt .    case ( i ) : @xmath381=1 $ ] .",
    "then , @xmath382 , which is the correct quantum mechanical expression .",
    "case ( ii ) : @xmath381=0 $ ] .",
    "then , the expression for @xmath383 simplifies to @xmath384 here we have used the relation @xmath385 , which arises as follows . since @xmath386 , @xmath155 , and",
    "@xmath387=0 $ ] by the case assumption , @xmath388 is a jointly measurable set of observables ; cf .",
    "example ( iii ) after def .",
    "( the procedure is to measure @xmath386 first , and then run the measurement sequence for @xmath155 . ) thus , by property ( ii ) of def .",
    "[ hvm1 ] for non - contextual hvms , @xmath389 . finally , with lemma  [ ino ] , @xmath390 , which yields the stated relation .",
    "next we use the induction assumption , and obtain @xmath391 t_\\textbf{a } \\right)}{p_t(s_t|\\textbf{s}_{\\prec t})}}\\vspace{1mm}\\\\ & = & \\displaystyle{\\langle t_\\textbf{a } \\rangle_{\\rho_{t+1}}. } \\end{array}\\ ] ] we thus reproduce the quantum mechanical expression within the hvm . this completes the induction step .",
    "the induction starts at time @xmath392 , where @xmath393 has an hvm description , by assumption of theorem  [ res1 ] .",
    "thus , by induction , for every time @xmath394 and every history @xmath352 of measurement outcomes , the conditional state @xmath351 has a description in terms of a non - contextual hvm .",
    "@xmath106    [ probpredict ] for any qcsi scheme @xmath175 ,",
    "if the input magic state @xmath16 can be described by a non - contextual hvm , then for the measurement of any sequence of observables @xmath395 , the probability distribution @xmath396 of outcomes is fixed by the hvm for @xmath16 .",
    "the @xmath371 may be mutually non - commuting and dependent on previous measurement outcomes .",
    "_ proof of corollary  [ probpredict ] .",
    "_ by bayes rule , the joint probability of the outcomes @xmath182 can be written as @xmath397 by theorem  [ res1 ] , the conditional probabilities @xmath398 are all correctly obtained from the probability distributions @xmath362 , cf .",
    "( [ hvmp ] ) .",
    "the distributions @xmath362 , for @xmath399 , in turn follow from the distribution @xmath400 ( describing @xmath16 at @xmath392 ) , by eq .",
    "( [ hvmq ] ) .",
    "thus , @xmath401 is fully specified by the probability distribution @xmath400 over the state space @xmath265 of the hvm .",
    "we now discuss the implications of theorem  [ res1 ] with regards to universality of quantum computation .",
    "we want to capture in our analysis the case where a qcsi scheme running on @xmath1 qubits is universal only on a subspace supporting @xmath402 encoded qubits .",
    "( this does of course include the unencoded case , where every logical qubit is represented by one physical qubit . )",
    "we use the following notion of computational universality .",
    "we say that a qcsi scheme is encoded universal if the following operations can be performed .",
    "* _ encoded inputs .",
    "_ prepare a set of encoded orthonormal input states @xmath403 up to an arbitrarily small error @xmath404 , where @xmath405 is an isometry of @xmath402 logical qubits into @xmath1 physical qubits . * _ encoded gates .",
    "_ for any @xmath406 and any encoded input state @xmath407 prepare the encoded output state @xmath408 , up to an arbitrarily small error @xmath404 .",
    "* _ encoded outputs_. measure the value of any logical observable @xmath409 , i.e. , @xmath410 .",
    "requirement u3 means that it is possible to physically measure any logical qubit in the standard basis .",
    "we then have the following result .    [ univcon ] a qcsi scheme @xmath173 on @xmath411 ( possibly encoded )",
    "qubits satisfying u1 - u3 is universal only if its magic states are contextual .",
    "the full proof of theorem  [ univcon ] is given in appendix  [ univcp ] .",
    "here we prove theorem  [ univcon ] under the simplifying assumption that every encoded qubit can be measured in two complementary bases rather than one basis .",
    "that is , u3 is replaced by    * @xmath412 .    while more stringent than u3 , the condition @xmath413 is not unreasonable .",
    "it grants the measurement device the power to measure two complementary observables for each encoded qubit , and thus to be genuinely quantum .",
    "however , the main reason for invoking @xmath413 is that it removes a substantial amount of technical complication from the proof , while preserving its general structure .",
    "_ proof of theorem  [ univcon ] under @xmath414 .",
    "_ we consider a qcsi where the available initial ( magic ) states all have an nchvm description",
    ".    now assume that the qcsi scheme is universal for quantum computation .",
    "then , it must be possible to create an encoded greenberger - horne - zeilinger state @xmath415 , with @xmath416 , on a subset of the qubits from an initial state @xmath417 .",
    "now consider the expectation value @xmath418 @xmath419 is a contextuality witness . since the observables @xmath409 , @xmath420 , are directly measurable by assumption u@xmath421 , their product @xmath422 is inferable , and for any internal state @xmath281 of the nchvm it holds that @xmath423 the same holds for the other three measurement contexts @xmath424 , @xmath425 , and @xmath426 .",
    "since for all nchvm states @xmath281 , @xmath427 , for all states @xmath0 describable by an nchvm it holds that @xmath428 .",
    "however , @xmath429 .",
    "the encoded state @xmath415 is thus contextual . with theorem  [ res1 ] ,",
    "it can not be prepared by the given qcsi with a non - zero probability of success .",
    "contradiction .",
    "the indirect assumption is thus wrong .",
    "hence , if the initial ( magic ) states are non - contextual , the resulting qcsi scheme is not universal .",
    "@xmath106    _ remark : _ the same conclusion holds when an error @xmath404 is allowed in the quantum computation , due to the finite gap between of 2 between @xmath429 and @xmath430 .      [ effsimgen ] for any qcsi scheme @xmath175 , if ( i ) the input magic state @xmath16 can be described by a non - contextual hvm with state space @xmath265 and value assignments @xmath356 , for all @xmath275 , ( ii ) this hvm can be efficiently sampled from , and ( iii ) the value assignments @xmath431 and the phase convention @xmath177 can be efficiently evaluated for all @xmath132 , then any resulting qcsi can be efficiently classically simulated .",
    "theorem  [ effsimgen ] is proved constructively , i.e. , by providing a classical simulation algorithm .",
    "this algorithm is given in table  [ algo2 ] .",
    "it is an almost exact copy of the simulation algorithm encountered in section  [ simulalg ] , and we comment on the resemblance in section  [ algocomp ] .",
    "l * algorithm 2 * +   +    before we proceed to the proof of theorem  [ effsimgen ] , we briefly discuss what sampling from conditional probability distributions means for the above algorithm . for any sample @xmath281 drawn in step 1 ,",
    "while looping through step 2 , a measurement record @xmath182 is built up . in every iteration @xmath214 of step 2 ,",
    "the updated sample @xmath432 may be regarded as being drawn from a probability distribution @xmath433 , conditioned on the previous measurement record @xmath352 .",
    "so the above simulation algorithm definitely samples .",
    "the question is whether it samples from the _ correct _ distributions , i.e. , whether @xmath434 , for all @xmath435 and for all @xmath182 .",
    "_ proof of theorem  [ effsimgen ] . _",
    "the proof proceeds by demonstrating the correctness and efficiency of the above classical simulation algorithm .",
    "_ correctness .",
    "_ we first show that for each time @xmath214 and measurement record @xmath352 , the above classical simulation algorithm ( i ) produces the correct quantum - mechanical conditional probability @xmath375 of obtaining the outcome @xmath370 in the measurement of the observable @xmath386 , and ( ii ) samples from the correct conditional probability distribution @xmath362 of the hvm , which is given by eq .",
    "( [ hvmrelat ] ) .",
    "the proof is by induction .",
    "we assume that at time @xmath214 , the classical simulation algorithm samples from the correct distribution @xmath362 .",
    "re ( i ) : denote the conditional probabilities produced by the simulation algorithm as @xmath436 .",
    "a state @xmath275 contributes its probability weight @xmath437 to @xmath438 or @xmath439 if @xmath440 or @xmath441 , respectively .",
    "therefore , @xmath442 the second equality follows by comparison with eq .",
    "( [ hvmp ] ) .",
    "furthermore , @xmath443 was already demonstrated in the proof of theorem  [ res1 ] .",
    "thus , @xmath444 , as required .",
    "re ( ii ) : through the value assignment in step 2(a ) , an internal state @xmath445 contributes to @xmath446 the update rule for step 2(a ) is thus @xmath447 for all @xmath448 , and @xmath375 appears for normalization .    in step 2(b ) , with eq .",
    "( [ flip ] ) , the update rule is @xmath449 where `` @xmath450 '' stands for convolution . using eq .",
    "( [ transl ] ) , the resulting expression for @xmath451 matches the expression in eq .",
    "( [ hvmq ] ) , i.e. , @xmath452 , as required .",
    "this completes the induction step .",
    "the induction assumption is satisfied for @xmath392 , by the first assumption of theorem  [ effsimgen ] .",
    "thus , by induction , the above algorithm samples from the correct conditional outcome probabilities @xmath453 for measurement outcomes @xmath370 and from the correct hvm distributions @xmath362 describing @xmath351 , for all times @xmath214 and all outcome histories @xmath182 .    _ efficiency . _",
    "the classical preprocessing of removing the unitaries @xmath178 from the circuit is efficient if the function @xmath52 can be efficiently computed , which holds by assumption .",
    "see the proof of theorem  [ simul ] .    regarding the simulation algorithm itself , the critical step is 2(a ) , the evaluation of the function @xmath272 on some @xmath54 .",
    "again , the efficiency of this function evaluation is guaranteed by the assumption of the theorem .",
    "@xmath106      algorithms 1 and 2 are very similar .",
    "they only differ in the sampling source they have access to . by theorem  [ pwnc ] ,",
    "the sampling source for algorithm 2 , based on non - contextual hvms , is at least as powerful as the sampling source for algorithm 1 , based on non - negative wigner functions . by the 1-qubit example of section  [ nwnc ] ,",
    "the former source is indeed more powerful .    in the following ,",
    "we investigate the relation between the two sampling sources in greater detail .",
    "the result is that if the initial quantum state @xmath16 can be described by a non - contextual hvm , then it can be represented by an ensemble @xmath454 such that there are wigner functions @xmath5 for which ( i ) @xmath6 , @xmath455 , and ( ii ) the measurement of observables from the set @xmath12 preserves positivity of the @xmath5 , @xmath455",
    ".    therefore , algorithm 2 can be simulated by a master algorithm that merely draws samples @xmath275 from the non - contextual hvm , and then employs algorithm 1 as a subroutine for dealing with the samples .",
    "this interpretation of algorithm 2 is developed below .",
    "the state space @xmath265 of the hvm can be partitioned into orbits @xmath456 $ ] of @xmath319 , @xmath457 = \\{\\nu+\\textbf{u } , \\textbf{u } \\in v\\ } \\in { \\cal{s}}/v.\\ ] ] then there exists a special orbit @xmath458\\in { \\cal{s}}/v$ ] defined by the property that there is a @xmath459 } \\in [ 0]$ ] for which the value assignment is constant , @xmath460}}(\\cdot ) \\equiv 1 $ ] . with eq .",
    "( [ transl ] ) it then follows that @xmath461}+\\textbf{u}}(\\textbf{a } ) = ( -1)^{[\\textbf{u } , \\textbf{a}]},\\;\\forall \\textbf{a } \\in v.\\ ] ] comparing with eq .",
    "( [ valass ] ) , we find that the above value assignment @xmath460}+\\textbf{u}}(\\textbf{a})$ ] agrees with the value assignment made by a positive wigner function eq .",
    "( [ adef ] ) considered as an hvm , if we identify , for all @xmath97 , @xmath462}+\\textbf{u } ) \\in [ 0 ]   \\longleftrightarrow \\textbf{u } \\in v.\\ ] ] this motivates the definition of a quantum state @xmath463}$ ] associated with the orbit @xmath458 $ ] , via @xmath464}}(\\textbf{u } ) : = \\frac{q(\\tau_{[0]}+\\textbf{u})}{p_{[0]}},\\ ; \\forall \\textbf{u } \\in v,\\ ] ] where @xmath465}=\\sum_{\\textbf{u } \\in v } q(\\tau_{[0]}+\\textbf{u})$ ] to ensure proper normalization .",
    "the state @xmath463}(\\textbf{u})$ ] is not required to be a valid quantum state , i.e. , to be positive semi - definite .",
    "the only requirement is a non - negative wigner function , which is satisfied by definition .",
    "the fact that classical sampling algorithms can handle states which have a positive wigner function but are not proper quantum states is familiar from the qudit case @xcite .    in analogy with eq .",
    "( [ coset0rhodef ] ) , we will now define states @xmath466}$ ] for all orbits @xmath456\\in { \\cal{s}}/v$ ] .",
    "the state @xmath463}$ ] and its cousins will then be used in the interpretation of algorithm 2 .    for any @xmath456 \\in { \\cal{s}}/v$ ] ,",
    "pick a @xmath467 } \\in [ \\nu]$ ] and define @xmath468}}_\\textbf{a } : = \\lambda^{-1}_{\\tau_{[\\nu]}}(\\textbf{a } ) t_\\textbf{a},\\ ; \\forall \\textbf{a } \\in v,\\ ] ] where on the r.h.s .",
    "@xmath469 , as defined in eq .",
    "( [ tdef ] ) . denoting @xmath470}}(\\textbf{a})=(-1)^{s_{[\\nu]}(\\textbf{a})}$ ] , for all @xmath54 , we thus have the relation @xmath471 } \\equiv \\gamma + 2 s_{[\\nu ] } \\mod 4.\\ ] ] from the above definition of @xmath472}}_\\textbf{a}$ ] , @xmath470}}\\!\\left(t^{\\gamma_{[\\nu]}}_\\textbf{a}\\right)=1 $ ] , for all @xmath54 .",
    "we can thus reproduce for any orbit @xmath456 $ ] the previous argument for @xmath458 $ ] .",
    "first , with eq .",
    "( [ transl ] ) , @xmath473}+\\textbf{u}}\\!\\left(t^{\\gamma_{[\\nu]}}_\\textbf{a}\\right)=(-1)^{[\\textbf{a},\\textbf{u}]},\\ ; \\forall \\textbf{a},\\textbf{u } \\in v.\\ ] ] again by comparison with eq .",
    "( [ valass ] ) , the value assignments by the hvm and by the wigner function @xmath474}}$ ] match if we identify , for all @xmath97 , @xmath475}+\\textbf{u } ) \\in [ \\nu ]   \\longleftrightarrow \\textbf{u } \\in v.\\ ] ] a state @xmath466}$ ] associated with any orbit @xmath456\\in { \\cal{s}}/v$ ] can now be defined , via @xmath476}}_{\\rho_{[\\nu]}}(\\textbf{u } ) : = \\frac{q(\\tau_{[\\nu]}+\\textbf{u})}{p_{[\\nu]}},\\ ; \\forall \\textbf{u } \\in v.\\ ] ] therein , @xmath477}=\\sum_{\\textbf{u } \\in v } q(\\tau_{[\\nu]}+\\textbf{u})$ ] . as before with @xmath463}(\\textbf{u})$ ] , the state @xmath466}(\\textbf{u})$ ] is not required to be positive semi - definite .",
    "_ remark : _ for each @xmath456\\in { \\cal{s}}/v$ ] , the choice of the representative @xmath467}$ ] is arbitrary .",
    "different choices lead to different @xmath478}$ ] , which are , however , related in a simple way .",
    "namely , the corresponding wigner functions differ only by translation . by contrast , the wigner functions @xmath474}}$ ] and @xmath479}}$ ] , for any @xmath480\\neq [ \\nu]$ ] , are not equivalent under translation .    with the above , we can now re - interpret the sampling from the hvm as the following two - stage process . in the first stage , equivalence classes @xmath456\\in{\\cal{s}}/v$ ]",
    "are sampled from , according to the probabilities @xmath481}\\}$ ] . in the second stage ,",
    "given a particular class @xmath456 $ ] , the phase space @xmath319 is sampled from , according to the conditional probability distribution @xmath482}/p_{[\\nu]}$ ] .",
    "the conditional probability distributions @xmath482}/p_{[\\nu]}$ ] over @xmath319 are regarded as wigner functions @xmath474}}_{\\rho_{[\\nu]}}$ ] of states @xmath466}$ ] associated with the orbits @xmath456 $ ] , cf .",
    "( [ cosetrhodef ] ) . see fig .",
    "[ sampsim ] for illustration .",
    "relation between algorithms 1 and 2 .",
    "sampling from the probability distribution underlying a non - contextual hvm may be viewed as a two - stage process .",
    "stage 1 : sampling from a probability distribution @xmath483 over wigner functions , stage 2 : sampling from the phase space w.r.t . to the wigner function chosen in the first stage.,width=226 ]    algorithm 2 can thus be simulated by a master algorithm calling algorithm 1 as a subroutine , as follows .",
    "step 1 : a sample @xmath275 is drawn .",
    "this sample is converted into the into the pair @xmath484\\in { \\cal{s}},\\textbf{u}\\in v)$ ] , such that @xmath485}+\\textbf{u}$ ] . step 2 : algorithm 1 is called , with the sample @xmath486 being handed over .",
    "the orbit @xmath456 $ ] has no influence on how algorithm 1 runs , but needs to be taken into account when the simulated measurement outcomes are returned .",
    "namely , algorithm 1 returns the values for @xmath472}}_{\\textbf{a}_t}$ ] , not for the @xmath371 with the standard phase convention @xmath10 .",
    "a conversion of those values is thus necessary , which proceeds by eq .",
    "( [ tdef2 ] ) .",
    "there is one more item to check : to employ sampling from wigner functions @xmath474}}$ ] as a subroutine , the measurement of observables which leave positive wigner functions @xmath85 positive must also leave all wigner functions @xmath474}}$ ] positive .",
    "denote by @xmath487}$ ] the non - extendable set of directly measurable observables w.r.t . the phase convention @xmath478}$ ] ( i.e. , the set of pauli observables whose measurement preserves non - negativity of the wigner function @xmath474}}$ ] ) .",
    "then , we have the following result .    [ sameo ] for all @xmath456\\in { \\cal{s}}/v$ ]",
    ", it holds that @xmath487}={\\cal{o}}$ ] .",
    "in addition , we note that the states @xmath466}$ ] , defined in eq .",
    "( [ cosetrhodef ] ) have the following relation to the input state @xmath16 of the computation .    [ staterel ] for any qcsi scheme @xmath175 ,",
    "if the input state @xmath16 has a non - contextual hvm description , then the states @xmath466}$ ] provide an ensemble representation @xmath488},\\rho_{[\\nu ] } ) , [ \\nu]\\in { \\cal{s}}/v \\right\\}$ ] of @xmath16 , i.e. , @xmath489 \\in { \\cal{s}}/v } p_{[\\nu ] } \\rho_{[\\nu]}.\\ ] ]    multiple wigner functions have previously been discussed in the context of qcsi @xcite .",
    "therein , a quantum state is considered classical if _ all _ its wigner functions are positive .",
    "our viewpoint is the opposite . for a state to be considered classical ,",
    "not even a single one of its wigner functions has to be positive .",
    "_ proof of lemma  [ sameo ] .",
    "_ by eq .",
    "( [ 3 t ] ) , for any phase convention @xmath10 it holds that @xmath490 then , by eq .",
    "( [ gammashift ] ) , the function @xmath75 based on a specific @xmath10 and the functions @xmath491}$ ] based on the corresponding @xmath478}$ ] are related via @xmath492}(\\textbf{a},\\textbf{b } ) = \\beta(\\textbf{a},\\textbf{b } ) + 2\\left(s_{[\\nu]}(\\textbf{a})+s_{[\\nu]}(\\textbf{b})-s_{[\\nu]}(\\textbf{a}+\\textbf{b } ) \\right),\\ ] ] where the addition is again mod 4 .",
    "now assume that @xmath136 and that @xmath80=0 $ ] .",
    "then , @xmath326 is a jointly measurable set of observables , and thus , by property ( ii ) of def .",
    "[ hvm1 ] , @xmath493}(\\textbf{a})+s_{[\\nu]}(\\textbf{b})-s_{[\\nu]}(\\textbf{a}+\\textbf{b } ) \\mod 2=0 $ ] .",
    "hence , @xmath492}(\\textbf{a},\\textbf{b } ) = \\beta(\\textbf{a},\\textbf{b}),\\ ; \\forall\\ , [ \\nu ] \\in { \\cal{s}}/v,\\ ] ] for all above pairs @xmath494 , @xmath90 . thus , by lemma  [ ino ] , the measurement of @xmath86 preserves positivity of the wigner function @xmath59 if and only if it preserves positivity of the wigner function @xmath474}}$ ] , for any @xmath456 \\in { \\cal{s}}/v$ ] .",
    "@xmath106    _ proof of lemma  [ staterel ] .",
    "_ since the @xmath86 , @xmath54 , form a basis of hermitian operators on @xmath1 qubits , it suffices to show that @xmath495}p_{[\\nu]}\\rho_{[\\nu]}}$ ] , for all @xmath54 .",
    "@xmath496}p_{[\\nu]}\\rho_{[\\nu ] } } } & = \\displaystyle{\\sum_{[\\nu ] } p_{[\\nu ] } \\langle t_\\textbf{a } \\rangle_{\\rho_{[\\nu]}}}\\vspace{1mm}\\\\   & = & \\displaystyle{\\sum_{[\\nu ] } p_{[\\nu ] } \\lambda_{\\tau_{[\\nu]}}(\\textbf{a } ) \\langle t_\\textbf{a}^{\\gamma_{[\\nu ] } } \\rangle_{\\rho_{[\\nu]}}}\\vspace{1mm}\\\\ & = & \\displaystyle{\\sum_{[\\nu ] } p_{[\\nu ] } \\lambda_{\\tau_{[\\nu]}}(\\textbf{a } ) 2^n \\!\\!\\sum_{\\textbf{u } \\in v } w^{\\gamma_{[\\nu]}}_{\\rho_{[\\nu]}}(\\textbf{u } )    w^{\\gamma_{[\\nu]}}_{t_\\textbf{a}^{\\gamma_{[\\nu ] } } } ( \\textbf{u } ) } \\vspace{1mm}\\\\ & = & \\displaystyle{\\sum_{[\\nu ] }   \\lambda_{\\tau_{[\\nu]}}(\\textbf{a } ) \\!\\sum_{\\textbf{u } \\in v } q(\\tau_{[\\nu]}+\\textbf{u } ) ( -1)^{[\\textbf{a},\\textbf{u } ] } } \\vspace{1mm}\\\\ & = & \\displaystyle{\\sum_{\\nu \\in { \\cal{s } } }     q(\\nu ) \\lambda_{\\tau_{[\\nu]}}(\\textbf{a } ) \\lambda_\\nu\\left(t_\\textbf{a}^{\\gamma_{[\\nu]}}\\right ) } \\vspace{1mm}\\\\ & = & \\displaystyle{\\sum_{\\nu \\in { \\cal{s } } }     q(\\nu ) \\lambda_\\nu\\left(t_\\textbf{a}\\right ) } \\vspace{1mm}\\\\ & = & \\displaystyle{\\langle t_\\textbf{a } \\rangle_{\\rho_\\text{in } } } ,   \\end{array}\\ ] ] as required .",
    "we used eq .",
    "( [ tdef2 ] ) in line 2 above , eq .",
    "( [ cosetrhodef ] ) in line 4 , eq .",
    "( [ commval ] ) in line 5 , and eq .  ( [ tdef2 ] ) in line 6 .",
    "in this section we focus on the properties of a single wigner function .",
    "we make the choice @xmath497 which has the important and rare consequence that the corresponding wigner function factorizes , @xmath498 for all states @xmath0 , @xmath63 .",
    "in fact , the factorization property already holds on the level of the heisenberg - weyl operators eq .",
    "( [ tdef ] ) , @xmath499      [ mset ] for @xmath500 , the set @xmath12 of directly measurable observables is @xmath501    this means first of all that the corresponding wigner function @xmath502 _ has _ a corresponding qcsi scheme , and , perhaps surprisingly , spatial locality plays a role in it .",
    "below , we first prove lemma  [ mset ] , and then flesh out the qcsi scheme corresponding to @xmath502 .     _ proof of lemma  [ mset ] .",
    "_ we first show that the set @xmath503 satisfies the defining conditions eqs .",
    "( [ c1 ] ) , ( [ c2 ] ) .",
    "consider two commuting pauli observables @xmath82 , @xmath504 such that @xmath82 is local to qubit @xmath402 , and @xmath504 is written as @xmath505 , where @xmath506 acts nontrivially only on qubit @xmath402 , and @xmath507 acts nontrivially only on the complement of qubit @xmath402 .",
    "then , @xmath508 therein , in lines 1 and 3 we used the property eq .",
    "( [ tfact ] ) .",
    "since @xmath82 and @xmath504 are commuting , @xmath509 . since @xmath82 is local , by going through all the cases of local pauli operators we find that @xmath510 .",
    "thus , @xmath511 is the only choice that satisfies both constraints .",
    "therefore , @xmath512 whenever @xmath513=0 $ ] , and @xmath82 is local .",
    "condition  ( [ c1 ] ) is thus satisfied .",
    "next , since every multi - local pauli operator can be written as a tensor product of local pauli operators , and the local pauli operators in such an expansion trivially commute , it follows that @xmath514 , as required by condition  ( [ c2 ] ) .",
    "we have thus shown that @xmath515 is a possible set @xmath516 .",
    "it remains to prove that the above @xmath12 is maximal , i.e. , that @xmath12 can not contain any additional observable without violating the condition eq .",
    "( [ c1 ] ) . for @xmath235",
    "this is clear , and we only need to discuss the case of @xmath17 . to this end , consider the two - local pauli operators , beginning with @xmath517 .",
    "@xmath111{merminsquarepyy}\\ ] ] @xmath517 is part of a context with @xmath518 .",
    "therefore , with lemma  [ ino ] , @xmath519 .    now , conjugate the observables in the above diagram under a local clifford unitary , and readjust the signs such that only observables @xmath86 appear . in this way ,",
    "any two - local pauli observable can appear in the bottom left corner of the diagram .",
    "we observe that the four observables in the top left corner of the diagram will remain local under such a transformation . as we have shown , all local pauli operators @xmath82 satisfy eq .",
    "( [ c1pr ] ) for all commuting @xmath504 .",
    "hence , ( i ) the four @xmath75s involving local observables remain @xmath520 .",
    "( ii ) the six @xmath75 appearing in the square must sum to @xmath521 , as per mermin s argument .",
    "combining these two facts , we find that the two @xmath75 involving the observable in the bottom right corner of the diagram can not simultaneously be zero .",
    "hence this observable can not be in @xmath12 .",
    "thus , no two - local pauli observable is in @xmath12 .",
    "next , consider a pauli observable @xmath82 with a support of size greater than 2 .",
    "be @xmath522 a set of two sites in the support of @xmath82 , @xmath523 , and denote by @xmath524 the restriction of @xmath82 to @xmath522 , and by @xmath525 the restriction of @xmath82 to the complement of @xmath522 .",
    "then , with eq .",
    "( [ tfact ] ) , @xmath526 .",
    "now consider a second pauli operator @xmath504 that commutes with @xmath82 and has support on @xmath522 only .",
    "then , using the property eq .",
    "( [ tfact ] ) , @xmath527 by the previous argument for two - local operators , for any @xmath82 with support on two or more qubits , a commuting two - local pauli operator @xmath504 can be found such that @xmath528 .",
    "then , with lemma  [ ino ] , @xmath529",
    ". @xmath106    from eq .",
    "( [ om ] ) it follows that the set @xmath11 of free states are tensor products of one - qubit stabilizer states .",
    "the group of free unitary gates therefore is the local clifford gates .      from the perspective of computational universality of qcsi ,",
    "all we do nt know yet is what the magic states are .",
    "since all state preparations and measurements are local in the present situation , any entanglement needed in the computation must be brought in by the magic state .",
    "that is , there is only one big entangled magic state . factors of tensor product states can not be coupled by the free operations .",
    "in fact , one possibility is to use as magic state a slightly modified cluster state .",
    "we consider a set of qubits located on the vertices of a square lattice graph .",
    "we denote the set of its sites by @xmath530 and its adjacency matrix by @xmath531 .",
    "we single out a subset @xmath532 of sites which are sufficiently sparse .",
    "denote by @xmath533 the observable @xmath534 . with those definitions",
    "the resource state @xmath535 is the unique joint eigenstate with eigenvalue 1 of the stabilizer operators    @xmath536    that this leads to universal quantum computation is easily shown by standard arguments pertaining to measurement - based quantum computation ( mbqc ) .",
    "see fig .  [ cluster ] for illustration .    while being a valid scheme of qcsi , this is also mbqc .",
    "the distinction between mbqc and qcsi is thus blurred . by various equivalence transformations",
    ", we can make the above computational scheme look more like the known qcsi schemes , or more like standard mbqc .",
    "qcsi with modified cluster state of eqs .",
    "( [ kx ] ) , ( [ ka ] ) as magic state , which is subjected to measurements of local pauli operators @xmath19 , @xmath537 , @xmath538 , for all @xmath539 . the role of the @xmath200-measurements is to cut out of the plane a web corresponding to some layout of a quantum circuit , and the @xmath342-measurements drive the mbqc - simulation of this circuit @xcite .",
    "the qubit in @xmath540 is displayed in red . by `` re - routing '' a wire piece",
    ", one may choose between implementing and not implementing a non - clifford gate .",
    "( a ) identity operation on the logical state space , ( b ) logical gate @xmath541.,width=321 ]    _ equivalent scheme 1 .",
    "_ in all qcsi schemes worked out to date @xcite , @xcite , @xcite , @xcite , the magic states are local to single or at most 2 particles .",
    "although this is by no means necessary , we are used to those states being injected into the computation one by one .",
    "if desired , we may convert the above computational scheme into such a form , by conjugating it  the resource state , the measurable observables in @xmath12 , and the wigner function @xmath542under the unitary transformation @xmath543 in this way",
    ", we arrive at the following equivalent computational scheme .",
    "the resource state @xmath535 is converted into a tensor product state of individual qubits being in the state @xmath544 , defined by @xmath545 , for @xmath546 , and @xmath547 , defined by @xmath548 , for @xmath549 .",
    "the new magic states are thus the local states @xmath547 .",
    "the new set @xmath550 of directly measure observables is @xmath551 , where @xmath552 .    _",
    "equivalent scheme 2 .",
    "_ we note in eq .",
    "( [ ka ] ) that stabilizer operators @xmath553 of the magic state @xmath535 are not exactly stabilizer operators of cluster states .",
    "therefore , we may apply the equivalence transformation @xmath554 and obtain as the new magic state the standard cluster state .",
    "the new measurable observables are @xmath555 where @xmath556 .",
    "we note that the measurable observables which are not @xmath200s are of the form @xmath557 as standard in mbqc @xcite .",
    "a minor deviation from the standard remains .",
    "namely , for each site @xmath187 , only a single setting out of two is available for the measurement angle , either @xmath558 or @xmath559 . in standard mbqc ,",
    "any angle @xmath560 $ ] may be chosen .",
    "however , the present restriction does not affect computational universality .",
    "in this paper , we have constructed a tomographically and informationally complete qcsi scheme for qubits in which contextality of the magic states is necessary for quantum computational universality .",
    "this case had remained open after the previously described schemes for qudits @xcite and rebits @xcite .",
    "more generally , we have shown that for all qcsi schemes on qubits satisfying the postulate ( p3 ) , for @xmath411 qubits , contextuality is necessary for quantum computational universality .",
    "we also investigated the role of wigner functions for the qubit case .",
    "the purpose of the wigner function @xmath59 is to explain the near - classicality of the free sector of qcsi , i.e. the operations in qcsi which are not considered resources .",
    "we found the following features of interest :    \\(i ) in contrast to the qudit and the rebit case described in the literature , for general qcsi schemes on qubits , the free unitary gates may introduce negativity into wigner functions without compromising efficient classical simulability .",
    "the violation of positivity can be very large as measured by the sum negativity @xcite .",
    "\\(ii ) any choice eq .",
    "( [ tdef ] ) of the phase convention @xmath10 for the wigner function @xmath59 uniquely determines the free sector of a corresponding qcsi scheme .    to summarize , in this work we have used classical simulation of quantum computation as a tool to identify quantum resources required for a speed - up .",
    "more generally , determining the cost of simulating universal quantum computing classically is fascinating open question ; see e.g. @xcite , @xcite .",
    "_ acknowledgments .",
    "_ rr thanks terry rudolph and the horodecki family for discussion .",
    "this work has been funded by nserc ( nd , co and rr ) , siqs ( jbv ) , aqus ( jbv ) , cifar ( nd and rr ) , and iarpa ( rr ) .",
    "rr is fellow of the cifar quantum information program .",
    "before we give the proof , we need to set up some additional notation .",
    "namely , we extend the value assignments @xmath272 . as per eq .",
    "( [ flip ] ) in the simulation algorithm 2 of section  [ gsa ] , the update of the internal state @xmath281 in the measurement of an observable @xmath371 invokes a random bit @xmath561 , @xmath562 .",
    "assume , the measurement sequence representing a given quantum algorithm has a maximum length @xmath563 .",
    "since these values @xmath564 are random and uncorrelated with everything , it does not matter whether they are determined at runtime or before the computation , and we may include those values in the nchvm value assignments @xmath272 .",
    "that is , we extend the internal states @xmath275 to @xmath565 correspondingly , the set of internal states becomes @xmath566 .",
    "a consequence of this definition is that the function @xmath272 can now assign a value to a potentially larger set of observables than the inferable ones .",
    "namely , consider a unitary @xmath567 which can be implemented using free gates , free measurements and ancilla states that can be described by an nchvm , and an inferable observable @xmath166 .",
    "then , the observable @xmath568 can also be measured , namely by first implementing @xmath567 and then measuring @xmath34 .",
    "however , it is not _ a priori _ clear that @xmath569 . yet , by the general simulation algorithm  2 , given the initial internal state @xmath570 , a value @xmath571 can be assigned to the observable @xmath568 .",
    "an important point to note is that the value assignments involving quantum circuits are in general context dependent .",
    "that is , they depend on how the unitary @xmath567 is implemented as a circuit , and which acilla states are being consumed in the process .",
    "further , for two given observables @xmath572 , @xmath573 , related via @xmath574 , the unitary @xmath567 is not unique , and @xmath571 may again depend on the choice made .",
    "it is this potential contextuality of value assignments involving circuits that complicates the proof of theorem  [ univcon ] .",
    "let s illustrate this property in an example .",
    "suppose there is a qcsi setting where all observables @xmath19 can be directly measured but @xmath575 can not .",
    "further , assume that the unitary @xmath576 , with the property @xmath577 , can be implemented using only free operations and ancillas that have an nchvm description .",
    "the circuit for measuring @xmath575 in this example is to first implement @xmath576 and then measure @xmath578 .",
    "now the task is to measure @xmath575 after first measuring either @xmath25 or @xmath30 . are the corresponding values @xmath579 assigned by the internal state @xmath570 via the simulation algorithm  2 the same in those two situations ?",
    "this is in general not the case .",
    "suppose that @xmath570 is such that @xmath580 .",
    "then , if @xmath25 was measured first , the hvm state after the first measurement is @xmath581 .",
    "analogously , if @xmath30 was measured first , the hvm state after the first measurement is @xmath582 . with the second measurement in the sequence begins the implementation of the measurement of @xmath575 . by construction ,",
    "the measurement strategy does not depend on the outcome of the first measurement .",
    "therefore , the second measured observable is the same @xmath583 in both cases .",
    "however , the value assigned to this observable by the internal state @xmath570 through eq .",
    "( [ transl ] ) differs if @xmath584 \\neq [ \\textbf{a}_2 , \\textbf{a}_{x_2}]$ ] .",
    "in this situation , the hvm prediction for the outcome obtained in the second measurement depends on which observable was measured first . since the choice of observable in the third measurement may depend on the outcome of the second measurement , the two measurement sequences may now run down completely different tracks , and there is no guarantee whatsoever that the value assigned to @xmath575 will be the same .",
    "hence , the value assignments involving circuits are potentially contextual .",
    "_ proof of theorem  [ univcon ] . _",
    "the outline of the proof is as follows .",
    "suppose the statement is wrong , i.e. , it is possible that the initial magic state has a description of an nchvm and simultaneously gives rise to universal quantum computation .",
    "then , by assumptions u1 and u2 , universality implies that an encoded ghz - state can be prepared .",
    "further , by u2 and u3 it is possible to randomly measure in one of the four contexts @xmath585 , @xmath586 , @xmath587 , @xmath588 . in each such measurement ,",
    "the three outcomes are multiplied and it is verified whether the product matches the corresponding stabilizer eigenvalue of the ghz state .",
    "we will show below that if the initial ( magic ) state has an nchvm description , then the simulation algorithm 2 will fail to reproduce the quantum prediction for the stabilizer eigenvalues of the ghz - state with a probability @xmath589 .",
    "however , algorithm 2 has been proven to be correct ( see theorem  [ effsimgen ] ) , and therefore computational universality and availability of an nchvm description for the initial state can not simultaneously apply .",
    "we now describe the measurement procedures for the four measurement contexts . case ( i ) : @xmath585 .",
    "the three observables @xmath590 , @xmath591 , @xmath592 are jointly measured , which is guaranteed to be possible by u3 .      1 .",
    "measure the observable @xmath409 .",
    "2 .   implement the measurement sequence corresponding to the execution of the encoded gate @xmath595 , giving rise to a free unitary @xmath118 which is propagated out of the circuit ; see fig .",
    "3 .   measure the observables @xmath596 , for @xmath420 . the outcomes for @xmath597 , @xmath598 and @xmath599 are thereby obtained . among them , the value for @xmath600 is discarded .",
    "step 1 of this procedure is possible by u3 , step 2 is possible by u2 .",
    "regarding step 3 , the unitary @xmath36 is in general dependent on them measurement outcomes obtained in implementing the circuit for @xmath595 , but in all cases @xmath36 is free ( @xmath118 ) .",
    "thus , the observables @xmath596 are in @xmath12 and can be directly measured .",
    "from the perspective of the hidden variable model , for any internal state @xmath601 , the values @xmath602 , @xmath603 , @xmath420 are assigned to the corresponding observables via the simulation algorithm  2 applied to the above measurement procedure .",
    "we now show that these value assignments are non - contextual if @xmath604 .",
    "\\(ii ) @xmath600 .",
    "we show this by the example of @xmath597 , the other two cases are analogous .",
    "@xmath597 appears in two measurement contexts , namely @xmath587 and @xmath588 .",
    "the corresponding measurement procedure differ only in one respect . in the former context @xmath591",
    "is measured in the first step , and in the latter context @xmath592 is measured in the fist step .",
    "now , by the assumption of @xmath604 , the internal state @xmath281 remains unchanged under this first measurement in both cases , and in particular remains the same for both cases .",
    "after the first step , the procedures are thus identical , and the same value @xmath606 is assigned by the hvm in either context .",
    "thus , if @xmath604 , all values @xmath602 , @xmath603 , @xmath420 assigned by the hvm are thus non - contextual , as claimed . by mermin",
    "s argument , such non - contextual value assignments fail to reproduce the respective stabilizer eigenvalue of the encoded ghz - state in at least one of the contexts .",
    "thus , if the measurement contexts are randomly chosen , if @xmath604 then the hvm fails to match the quantum prediction with a probability of @xmath607 .    further , for any internal state @xmath608 , the conditional probability for @xmath604 in @xmath570 given @xmath281 equals 1/2 ( recall that @xmath609 is the result of an unbiassed coin flip ) .",
    "therefore , the hvm fails to match the quantum prediction with a probability @xmath589 .",
    "finally , universality only requires the preparation of an encoded ghz - state @xmath415 up to an arbitrarily small error @xmath610 , and likewise only the approximate realization of the gates @xmath611 , up to the same error @xmath404 .",
    "when taking such errors into account , the hvm prediction remains unchanged .",
    "if the initial state can be described by a non - contextual hvm , the measurement record will fail to reproduce the quantum mechanical prediction of the measurement record with a probability @xmath589 .",
    "the quantum prediction does now differ from the ideal scenario . with a slightly erroneous encoded ghz - state @xmath415 and slightly erroneous gates",
    "@xmath611 , the measurement record will differ from the measurement record for the ideal circuit with a probability @xmath612 .",
    "however , @xmath612 can be made arbitrarily small by decreasing @xmath404 .",
    "thus , even in the presence of a small error @xmath404 , the quantum prediction can be distinguished from the hvm prediction ."
  ],
  "abstract_text": [
    "<S> we describe a scheme of quantum computation with magic states on qubits for which contextuality is a necessary resource possessed by the magic states . </S>",
    "<S> more generally , we establish contextuality as a necessary resource for all schemes of quantum computation with magic states on qubits that satisfy three simple postulates . furthermore , we identify stringent consistency conditions on such computational schemes , revealing the general structure by which negativity of wigner functions , hardness of classical simulation of the computation , and contextuality are connected . </S>"
  ]
}