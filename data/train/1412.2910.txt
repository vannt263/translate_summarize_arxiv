{
  "article_text": [
    "the rapid development of experimental quantum optics in the past decades has led to the establishment of quantum key distribution ( qkd ) @xcite .",
    "this branch of quantum information science is aimed at the development and implementation of methods for the secure distribution of cryptographic keys so that the very laws of quantum physics provide the security of the key .",
    "the key can be then used in the one - time - pad classical cryptographic system , thus providing the possibility ideally for an unconditionally secure information transmission .    a recent addition to qkd",
    "is the use of homodyne detection of continuous - variable ( cv ) states @xcite .",
    "enforced by the gaussian security proofs @xcite , this allows the use of multiparticle quantum states in the typical photonic implementations of qkd in order to improve the applicability and stability of qkd protocols .",
    "cv qkd protocols were first suggested and studied on the basis of nonclassical squeezed states of light @xcite . an important step in cv qkd was made when the semiclassical coherent states were shown to be in principle sufficient for key distribution @xcite even at long distances , using gaussian modulation and reverse information reconciliation @xcite .",
    "the coherent - state protocol was successfully tested in mid - range ( 25 km ) @xcite and long - range ( 80 km ) @xcite optical fiber channels , while a proof - of - principle laboratory test of the squeezed - state protocol was performed recently @xcite .",
    "it was shown in particular that the squeezed - state protocol can potentially outperform its coherent - state counterpart in terms of robustness and range , especially if data processing efficiency is limited @xcite .",
    "for the security analysis of the cv qkd protocols the trusted parties need to know the correlation of their measurements . because of the optimality of gaussian states , that is equivalent to knowing the parameters of the channel , namely , its transmittance and excess noise .",
    "this knowledge allows one to estimate the maximum amount of information leaking to a potential eavesdropper from such a channel .",
    "the channel estimation is , however , a nontrivial task .",
    "indeed , the trusted parties need to estimate the channel based on probe pulses , which must be indistinguishable from the signal , otherwise the eavesdropper can recognize them and exploit that information .",
    "the accuracy of the estimation is typically limited by the intensity and number of estimation pulses ; however , more states used for estimation means a lower capacity to carry information .",
    "the effect of the limited ensemble size on the applicability of cv qkd was studied previously for modulated coherent - state @xcite and entanglement - based @xcite protocols .",
    "the channel estimation in the current state - of - the - art implementation @xcite is based on revealing half of the pulses publicly and estimating from that the channel noise and transmittance .",
    "however , the channel estimation strategy was not optimized for the given quantum - state resource and other parameters of the scheme , and information on the effect of channel estimation on the squeezed - state protocol appears to be lacking , which limits the performance of the standard protocol .    in the current paper",
    "we suggest a novel channel estimation strategy based on double gaussian modulation of the coherent or squeezed states of light .",
    "we show that this method can bypass the trade - off between estimation and information transfer and that the optimized protocol can approach the effectiveness of the ideal case .",
    "we also study the protocol based on nonclassical squeezed states and show the advantage of using such states in cv qkd when channel estimation and finite - size effects are considered . in summary",
    ", we present a cv qkd protocol that is practically applicable in long - distance channels thanks to the optimal use of the resources .",
    "the paper is organized as follows .",
    "first , we describe in sec .",
    "ii the basic concepts of cv qkd : the model used , the standard method for channel estimation , and the calculation of the achievable key rate . in sec .",
    "iii , we optimize the standard method of channel estimation used for cv - qkd incorporating finite - size effects . then in sec .",
    "iv , we calculate the theoretical limits of cv qkd .",
    "this leads us to the concept of a double - modulation protocol ( sec .",
    "v ) which can approach the optimal performance for long distances . finally , in sec .",
    "vi , we draw conclusions .",
    "we consider the generic cv qkd protocol , when alice sends cv quantum states of light to bob through a channel , that is under the control of a potential eavesdropper eve .",
    "the resource states are gaussian squeezed or coherent states ; alice applies a gaussian displacement operation to them , while bob performs homodyne detection on the other end of the channel using also an intense reference pulse sent by alice ( fig .",
    "[ method ] ) . after",
    "the transmission is done , they reveal a subset ( chosen randomly ) of their measurement data , estimate the channel parameters from that , and use that information to upper - bound the information eve could get .",
    "finally they use the other , unrevealed subset of data to extract the key , performing also error correction and privacy amplification .    , width=321 ]    in this case the transfer of quadrature variables through a lossy and noisy channel can be described in the heisenberg picture by the following evolution : @xmath0 where all variables are normally distributed with zero mean , except for the fixed transmittance parameter @xmath1 $ ] .",
    "the operator @xmath2 represents the measured quadrature at bob s side .",
    "the operator @xmath3 represents the quadrature of a state alice sent into the channel , where @xmath4 comes from the quantum fluctuation of the resource state [ with variance @xmath5 , while @xmath6 comes from the modulation of the state [ @xmath7 .",
    "note that @xmath8 ( shot noise unit ) for coherent states and @xmath9 for squeezed states . @xmath10 corresponds to the vacuum state [ @xmath11 , while @xmath12 is a gaussian excess noise with variance @xmath13 . in practice",
    "the values of @xmath4 , @xmath10 , and @xmath14 are all unknown to alice and bob , so they can treat all of them as a noise .",
    "so we can rewrite ( [ def_channel ] ) in a much simpler form : @xmath15 where @xmath16 is the aggregated noise with zero mean and variance @xmath17 .",
    "we suppose that the variance of the modulation ( @xmath18 ) is known , that is , the channel can be parametrized using two unknown parameters : @xmath19 and @xmath20 .",
    "let us suppose that the estimation is made using @xmath21 gaussian states .",
    "denote the realizations of @xmath6 and @xmath2 with @xmath22 and @xmath23 ( @xmath24 ) respectively .",
    "we know that the covariance of @xmath6 and @xmath2 is @xmath25 .",
    "we can estimate the value of @xmath19 from @xmath26 where we use the maximum likelihood estimator @xmath27    on the other hand , the estimator of @xmath28 can be expressed using the maximum likelihood estimator of @xmath29 substituting the real value of @xmath19 with its estimator from ( [ est_eta ] ) : @xmath30    let us notice that to estimate @xmath28 either alice or bob should reveal the measurement data , so these states can not be used for key distribution .",
    "we will use reverse reconciliation to obtain a secret key for large distances , i.e. , the common key is based on bob s state , which alice and eve try to guess .",
    "then in the asymptotical case the key rate is @xcite @xmath31 where @xmath32 $ ] is the reconciliation efficiency , @xmath33 is the mutual information of alice and bob , while @xmath34 is the maximal information eve can retain about bob s state .",
    "the true values of @xmath19 and @xmath28 are unknown , so for implementing a secure cv qkd protocol we need to set confidence intervals for both @xmath19 and @xmath28 with a low probability of error @xmath35(see appendix c ) . in order not to underestimate the eavesdropping ,",
    "the key rate must be minimized considering every possible combination of @xmath19 and @xmath28 from the given confidence intervals .",
    "numerical calculations ( and intuition ) suggest that in the most pessimistic case , we should use the lower bound ( @xmath36 ) of the confidence interval for @xmath19 and the upper bound ( @xmath37 ) for @xmath28 .",
    "we can obtain the following key rate incorporating finite - size effects @xcite : @xmath38,\\ ] ] where @xmath39 is the number of gaussian states used for secret key transmission and @xmath40 is a correction term for the achievable mutual information in the finite case @xcite . note that if we use @xmath41 states for estimation we will have @xmath42 states for key distribution .",
    "the mutual information reads @xmath43    we suppose that eve performs a collective gaussian attack on the signal pulse ( the reference pulse is usually much stronger than the signal pulse ) . in this case , the upper bound of the information which is available to eve on bob s measurement results is given by the holevo information , that is , the difference between two von neumann entropies : @xmath44 where @xmath45 is the von neumann entropy of the eavesdropper s state , while @xmath46 denotes the von neumann entropy of the eavesdropper s state conditioned on bob s measurement .    in the general case",
    "the channel noise is assumed to be under full control of eve , so in order to calculate these entropies we use an equivalent entanglement - based scheme ( fig .",
    "[ fig_entangled ] ) and purification method @xcite .",
    "it is equivalent in the sense that the states and conditional states ( conditioned on alice s measurements ) sent to bob through the channel have the same distribution as in the prepare - and - measure scheme .",
    "a generalized entanglement - based scheme is used , which corresponds to the preparation of arbitrarily squeezed states and arbitrary modulation applied to them .",
    "this scheme differs from the standard entanglement - based schemes by the presence of an additional squeezed state coupled to a signal prior to measurement on the sending side , and also by the unbalanced preparation of the entangled state .",
    ", width=321 ]    with this equivalence we can substitute a prepare - and - measure scheme with arbitrary squeezing of the signal states and modulation variances with an entanglement - based scheme .",
    "the calculation of the holevo information in the entanglement - based scheme is straightforward from here using purification .",
    "from the fact that eve is able to purify the state shared between alice and bob it follows that @xmath47 and @xmath48 .",
    "both entropies can be calculated from the symplectic eigenvalues of the covariance matrices of two - mode gaussian states .",
    "that is , we can express them as an ( enormously long ) analytic formula of parameters and we can use it efficiently for the numerical optimization of parameters .    finally , for the sake of simplicity we will use the approximate formula for @xmath40 obtained in @xcite : @xmath49 where @xmath50 is the probability of error during privacy amplification .",
    "the key rate ( [ key_rate ] ) can be calculated for fixed parameters : it depends only on the values of @xmath19 , @xmath28 , @xmath51 , @xmath52 , @xmath53 , @xmath18 , and @xmath54 .",
    "let us investigate thoroughly how the key rate depends on these parameters .",
    "the first two are given ; they are the parameters of the channel",
    ". one can estimate them with the estimators in eqs .",
    "( [ est_eta ] ) and ( [ hatveps ] ) .",
    "we can approximate their variances with ( see appendix a )    @xmath55    and @xmath56 from that we can calculate the expected values of @xmath36 and @xmath37 in eq .",
    "( [ key_rate ] ) , so we can calculate the key rate for any set of parameters in advance numerically .",
    "otherwise , for an optical fiber of length @xmath57 ( in km ) we will use @xmath58 . in the literature",
    "it is usually assumed that the excess noise in an optical fiber is proportional to the transmittance @xcite .",
    "so we used this assumption in our numerical calculation as well , having @xmath59 , with @xmath60 .",
    "@xmath51 is the size of the blocks ; it is in general predetermined , but for practical applications it is reasonable to assume short blocks . in the current state - of - the - art realization @xcite @xmath61 and @xmath62 were used .",
    "@xmath52 is the efficiency of the information reconciliation , which depends on the performance of the algorithms being used and on the achieved signal - to - noise ratio .",
    "recently efficient postprocessing algorithms were developed @xcite ; thus we will use a realistic @xmath63 .    ] , moderate squeezing [ orange ( medium gray ) , @xmath64 , and strong squeezing [ purple ( dark gray ) , @xmath65 , for optimized single - modulation ( dotted lines ) and double - modulation ( solid lines ) schemes as a function of distance @xmath57 for @xmath60 , @xmath63 , and @xmath66 . for comparison we plotted also the key rate yielded by the current state - of - the - art technique ( thick black dashed line ) and the best theoretically possible upper limit @xmath67 ( thick black dash - dotted line ) .",
    "[ dist],width=321 ]    from ( [ key_rate ] ) we can see that the key rate will be higher if more states are used for key distribution ( @xmath39 ) .",
    "but at the same time that means fewer states for estimation ( @xmath21 ) and results in an inaccurate estimation of channel parameters . in the case of perfect reconciliation @xmath18 should be as large as possible , but in a realistic case @xmath18 must be limited .",
    "in fact , there exist optimal values for @xmath53 and @xmath18 which maximize the key rate .",
    "but so far the variances of the parameter estimators have not been obtained in general , only for given measurement outcomes .",
    "this means that designing an experiment by optimizing the available parameters was impossible ; some fixed parameters were used instead , e.g. , @xmath68 @xcite and @xmath69 @xcite .",
    "however , since we know the variances of the estimators in advance , the optimal setting can be calculated by numerical optimization and a significant improvement is achieved in the key rate ( fig .",
    "[ dist ] , thick black dashed vs purple dotted line ) .",
    "the optimal @xmath18 will be close to the one obtained in the asymptotical case ( without any finite - size effects ) @xcite . while from fig .",
    "[ fig_r ] we can see that the optimal @xmath53 will be close to @xmath70 only if the key rate is close to zero .",
    "if that is not the case , the optimal ratio will be below @xmath70 and show a linear correlation with the block size ( @xmath51 ) on a log - log plot .",
    "that is , the optimal ratio @xmath71 will have the form of @xmath72 with the actual value of @xmath73 and @xmath74 depending on the parameters",
    ". in general @xmath73 will be lower for smaller distances and higher levels of squeezing , while @xmath75 ( the lines on fig .",
    "[ fig_r ] are nearly parallel ) .",
    "] , moderate squeezing [ orange ( medium gray ) , @xmath64 , and strong squeezing [ purple ( dark gray ) , @xmath65 , for a long distance @xmath76 ( @xmath77 76 km , dotted lines ) and a short distance @xmath78 ( @xmath77 26 km , solid lines ) as a function of block size @xmath51 with @xmath60 and @xmath63 .",
    "[ fig_r],width=321 ]    finally , @xmath54 is a squeezing parameter of the source , which can be set in state preparation .",
    "if we compare the performance using coherent states ( @xmath8 ) , moderately squeezed states ( @xmath79 , i.e. , 3 db squeezing ) and strongly squeezed states ( @xmath80 , i.e. , 10 db squeezing ) , we can see a substantial improvement due to squeezing ( fig .",
    "[ dist ] , dotted lines ) , even for the moderately squeezed states . with the use of squeezing the protocol",
    "can achieve reasonable distances for even values of @xmath51 as low as @xmath81 .",
    "one of the main limiting factors compared to the asymptotical case comes from the fact that there will be a security break if the asymptotical key rate drops below @xmath40 .",
    "this quantity is of order @xmath82 which results in a substantial restriction on achievable distance even for large values of @xmath39 . to get a higher key rate one can try to improve the coefficient @xmath83 using theoretical considerations @xcite . for a given function @xmath84",
    "the possible improvement comes from using as large @xmath39 as possible , i.e. , @xmath85 .",
    "actually , from the @xmath86 restriction one can easily obtain that the maximally achievable distance is in the best case a linear function of @xmath87 : if we take ten times larger block sizes , we can expect an improvement of about 25 km ( see fig .",
    "[ fig_max_dist ] and appendix d ) .",
    "( thick black solid line ) using optimal modulation and infinitely strong squeezing with @xmath60 and @xmath63 , its exponential approximation ( solid gray line ) , and the level of @xmath88 for @xmath66 ( dash - dotted ) , @xmath61 ( dotted ) , and @xmath89 ( dashed ) .",
    "if the asymptotical key rate drops below @xmath88 ( large circles ) , it is impossible to obtain a positive key rate .",
    "[ fig_max_dist],width=321 ]    in practical situations the transmittance @xmath19 can be estimated quite promptly , but that is not true for the excess noise @xmath28 . for large distances @xmath90 will be very small ; nevertheless @xmath37 will be large since the estimator @xmath91 will have a large standard deviation .",
    "simple calculations show that we have @xmath92 where @xmath93 is the conditional modulation of alice : @xmath94 if alice reveals the modulation data for bob ; @xmath95 if alice does not reveal the modulations .",
    "the theoretical lower bound is @xmath96 and is fulfilled if alice shares all the modulation for channel estimation and uses infinitely squeezed states .    from these two observations we can get the theoretical maximum for the key rate ( [ key_rate ] ) in the finite case : @xmath97    unfortunately , this is impossible to achieve since all states would have to be used for both optimal key distribution and optimal channel estimation at the same time ( the latter means revealing the modulation for all states ) .",
    "using the standard method we set @xmath94 in ( [ ve_up ] ) , that is , alice reveals the exact values of modulation .",
    "however , she uses only half of the states , which still results in a much higher value of @xmath98 .",
    "but for large distances @xmath19 becomes very small , so the term in parentheses in ( [ ve_up ] ) will not have a large effect .",
    "this observation has caused us to take a different approach to the problem : alice should not share the modulation data at all . in this case alice can use all the states for estimation , which for large distances results in a value much closer to the theoretical limit : @xmath99 , if @xmath100 .",
    "let us note that in this case , besides having a better estimate of @xmath28 , one can use twice as many states for key distribution , too .",
    ", width=321 ]    to actually achieve this effect , we also need a method to estimate @xmath19 without revealing the modulation data . that led us to using two consecutive modulations on alice s side ( see fig .",
    "[ method2 ] ) .",
    "after finishing the transmission alice reveals for each state the second modulation ( @xmath101 ) . then bob using these public data and his ( secret ) measurement data can estimate @xmath19 and @xmath28 ( attributing the first modulation of alice to the noise of the source ) . in this way",
    "the first modulation ( @xmath102 ) and bob s measurement remain secret , so they can be used for key distribution as in the standard case ( having an additional noise coming from the second modulation , but since that is revealed publicly it can be simply eliminated from the process ) .     [ standard method , purple ( dark gray ) dash - dotted line ) , @xmath103 [ double modulation , orange ( medium gray ) dotted line ) , and @xmath104 [ modified double modulation , cyan ( light gray ) dashed line ] for @xmath105 , @xmath106 , @xmath107 , @xmath108 , and @xmath60 using coherent states ( @xmath8 ) show a good match with the empirical standard deviation of different estimators of @xmath28 ( circles , squares , and diamonds , respectively ) averaged from @xmath109 different realizations . the theoretical lower limit from @xmath110 ( black solid line )",
    "is also plotted for comparison .",
    "[ fig_stdev],width=321 ]    then the evolution can be written in the form of @xmath111    since alice reveals only the values of the second modulations ( @xmath101 ) , the first modulation acts as a noise in the estimation process ; thus we can rewrite ( [ def_channel2 ] ) in the following form : @xmath112 where @xmath113 is the aggregated noise with variance @xmath114 .",
    "that means that it is the same evolution as for a single modulation [ see eq .",
    "( [ def_channel_simple ] ) ] , we need only to change the variance @xmath18 to @xmath115 , @xmath29 to @xmath116 , and @xmath21 to @xmath51 .",
    "so by substitution in eqs .",
    "( [ var_hatt ] ) and ( [ var_veps ] ) we can easily obtain the approximated variance for the estimator of @xmath19 :    @xmath117    and the approximated variance for the estimator of @xmath28 :    @xmath118    this formula shows the effects described above .",
    "the aggregated noise @xmath116 and the factor @xmath119 will be larger here than in the standard case .",
    "that results in a worse key rate for small distances .",
    "but if @xmath120 , then @xmath121 and @xmath122 , so these negative effects will disappear , thus from using more states for estimation , one can get an even better estimation ( see fig .",
    "[ fig_stdev ] , purple dash - dotted and orange dotted lines ) .",
    "moreover , for large distances the variance of the estimator gets close to the theoretical optimum ( see fig .",
    "[ fig_stdev ] , orange dotted and black solid lines ) .",
    "note that @xmath115 plays a role only in the estimation of @xmath19 .",
    "larger values of @xmath115 always produce lower values of @xmath123 ( so also lower values of @xmath103 ) , but the improvement saturates quickly .",
    "] , moderate squeezing [ orange ( medium gray ) , @xmath64 , and strong squeezing [ purple ( dark gray ) , @xmath65 , for the optimized single - modulation ( dotted lines ) and double - modulation ( solid lines ) schemes as a function of block size @xmath51 in the case of @xmath60 , @xmath63 , and @xmath76 ( @xmath124 km ) . for comparison we plotted also the key rate using the current state - of - the - art technique ( thick black dashed line ) , and the best theoretically possible upper limit @xmath67 using @xmath80 ( thick gray dash - dotted line ) , and infinitely strong squeezing ( thick black dash - dotted line ) .",
    "[ n_b],width=321 ]    that is , we obtained a method which estimates the excess noise efficiently .",
    "but in the meantime , besides using all the states for estimation , one can use all states for key distribution purposes too .",
    "that will result in a key rate ( fig .",
    "[ n_b ] ) approaching the theoretical limit described in ( [ key_rate_th ] ) .",
    "it is important to mention that even with a feasible level of squeezing we can obtain a key rate close to the theoretical optimum corresponding to infinitely strong squeezing .",
    "if @xmath19 is not close to zero , the above method will not be efficient .",
    "but in that case alice can share some data from the first modulation too . that is , in this case we will have the same situation as in the standard method ; there is only an additional layer of noise for every state , which will be revealed and used for better estimation ( see appendix b ) .",
    "we can optimize the ratio of shared modulation ( @xmath53 ) and get a slightly improved key rate compared to the single - modulation scheme ( fig .",
    "[ dist ] dotted vs solid lines ) .",
    "not surprisingly the improvement is higher for larger distances .",
    "the optimal ratio @xmath53 becomes zero between @xmath125 and @xmath78 ( that is between 25 and 50 km ) depending on the parameters .",
    "thus for large distances , to get the optimal performance one should indeed use each state for estimation and key distribution too .",
    "the implementation of this protocol is simple . from some rough estimation of channel parameters ( e.g. , from earlier results )",
    "alice chooses a modulation variance that is close to optimal .",
    "after bob received the states alice reveals all her data of the second modulations . from this they will have a proper estimation of the channel parameters and they can calculate the optimal ratio @xmath53 numerically . if it is positive , alice chooses @xmath126 states randomly and reveals their first modulation , which will be incorporated to obtain a more accurate estimation .",
    "then they continue the protocol as in the standard case .",
    "we proposed a feasible double modulation quantum key distribution scheme which uses each state for both channel estimation and key distribution purposes .",
    "we presented a simple theoretical maximum for the key rate and the achievable distance for cv - qkd protocols .",
    "we showed that our method can greatly improve the key rate and the maximal distance , moreover , it can approach the theoretical limit for long distances .",
    "the improvement comes from three factors : optimizing the parameters , using squeezed states , and using the double - modulation method ( see fig .",
    "[ n_b ] for the different effects ) .",
    "the full optimization for the finite - size case was feasible because we obtained formulas as a simple function of the model parameters for a good approximation of the standard deviation of the channel parameter estimators .",
    "using squeezed states instead of coherent states makes the largest improvement , which also theoretically clarifies that the result obtained in @xcite remains valid if we take finite - size effects into account ( this surviving effect is far from trivial in general ) . finally , there is the double modulation method , which allows us to approach the theoretical limit for large distances , proving that the above ideas are enough to realize a nearly optimal cv qkd scheme . for comparison",
    ", we obtained a key rate about ten times higher than the current state - of - the - art implementation @xcite even if we use ten times shorter block sizes ( fig .",
    "[ n_b ] , large circles ) .",
    "note that the results were obtained for a specific protocol ; however , the same concepts can be applied to different and more complex settings of cv qkd , which implies that they might produce a significant improvement in practical applications of quantum communication .",
    "v.c.u . and l.r .",
    "acknowledge the project no .",
    "13 - 27533j of gar .",
    "the research leading to these results has received funding from the eu fp7 under grant agreement no .",
    "308803 ( project brisq2 ) , co - financed by mmt r ( 7e13032 ) .",
    "on the other hand , we have @xmath131 @xmath132 @xmath133 where we used the definition of @xmath2 , the moments of a normal distribution and the fact that for independent random variables with zero mean the variance can be factorized .",
    "if we rearrange the second term : @xmath138 then the last expression will be noncentrally @xmath139 distributed : @xmath140 from that we can obtain the mean @xmath141 @xmath142 and the variance @xmath143 @xmath144 where we have used that @xmath145 is of order @xmath135 .",
    "we can rewrite the variance of @xmath146 in the following form : @xmath147    we can see that @xmath146 is not unbiased , only asymptotically unbiased .",
    "but the bias is of order @xmath135 , while its standard deviation @xmath148 is of order @xmath149 , meaning that the magnitude of the bias is negligible compared to it , so @xmath146 can be used to estimate @xmath19 .",
    "note that in further calculations it suffices to use only the first - order approximation , since typically @xmath150 , so the second term will be negligible .",
    "now we can calculate the properties of the estimator of the excess noise : @xmath151 .",
    "we can calculate its variance by substituting the definition of the estimator @xmath152 into the sum , but at the end there would not be much difference from using simply @xmath153 , i.e. , assuming that @xmath146 has negligible variance .",
    "the reason behind that is that for large values of @xmath21 , the estimator @xmath152 will be very close to its real value ; thus the main source of uncertainty in the sum comes from the random variables @xmath23 and @xmath22 .",
    "so for the sake of simplicity , we will present in the following the simpler analysis .",
    "then @xmath159 can be approximated by @xmath160 for large values of @xmath21 and we can obtain @xmath161 @xmath162 to calculate the variance we assume that @xmath146 and @xmath163 are independent .",
    "this is not exactly true , but numerical simulations show us that this assumption still gives us a good approximation in the current situation ( see fig .",
    "[ fig_stdev ] ) .",
    "hence we calculate the variances independently for each term :        let us note that @xmath167 is of order @xmath135 , so both terms in ( [ varveps ] ) will be of order @xmath168 , too . for coherent states",
    "@xmath169 will be constant , @xmath170 ( see fig .",
    "[ fig_stdev ] , purple dash - dotted line ) .      to get an accurate estimation for low distances in double - modulation settings",
    ", alice needs to share some of the first modulations too .",
    "let us suppose that alice reveals @xmath171 first modulations .",
    "then one can calculate an estimation of @xmath19 and @xmath28 from both subsets of the states independently .    for the @xmath172 states for which alice reveals only the second modulation we can use the same calculation as described in sec .",
    "[ double ] around eq .",
    "( [ varveps2 ] ) [ with the small difference that we should use @xmath172 instead of @xmath51 ] . while for the @xmath126 states for which alice reveals both modulations , the evolution is @xmath174 that is , it is the same situation as in the standard method , with the difference that there should be @xmath175 instead of @xmath18 in the appropriate formula .",
    "one can easily verify that if there are two different estimators @xmath176 and @xmath177 with variances @xmath178 and @xmath179 , then the best linear estimator @xmath180 is yielded by setting @xmath181 . in this case",
    "the minimal variance is @xmath182            this method combines the advantages of the single- and double - modulation methods ( see fig .",
    "[ fig_stdev ] , cyan dashed line ) .",
    "it provides the optimal estimation , converges to the standard method for low distances , while for large distances , converges to the double - modulation method .",
    "it is important to notice that in our calculations we have used approximated variances , but fig .",
    "[ fig_stdev ] shows us that these approximations are close to the empirical variances even for @xmath105 .",
    "therefore we can use these approximate formulas to numerically calculate the key rate .",
    "let us suppose that @xmath185 is an estimator of interest and it is normally distributed with mean @xmath186 and standard deviation @xmath187 .",
    "we are looking for a symmetric confidence interval ( around @xmath186 ) , and denote the significance level of the confidence interval with @xmath35 , that is , @xmath188    therefore the probability of an estimate above the upper bound is @xmath189 : @xmath190 @xmath191 where @xmath192 has the standard normal distribution and @xmath193 is the cumulative distribution function of the standard normal distribution . solving this equality ,",
    "we obtain @xmath194    the usual magnitude of error in studies is @xmath195 @xcite , so let us fix @xmath196 ; then @xmath197 .",
    "that means , for example , in the case of the standard method @xmath198 with an error probability of @xmath195 . in real - life applications one should use their estimated values : @xmath199",
    "one can approximate the asymptotical key rate as an exponentially decreasing function of distance ( see fig .",
    "[ fig_max_dist ] ) .",
    "that is , we have @xmath200 we can obtain a trivial upper bound for the key rate : @xmath201 if the right - hand side drops below zero , the key rate will be negative .",
    "the right - hand side is positive if @xmath202 , that is , if we use @xmath203 @xcite we have @xmath204 rearranging this , we obtain a necessary condition for the positivity of the key rate : @xmath205 for realistic parameters",
    "@xmath206 , so the coefficent of @xmath87 will be around 25 , as is stated in the main text .",
    "in the following we will show how the achievable distances for different methods change , if we vary the parameters of the protocol .",
    "we always optimize the modulation variance ( @xmath18 ) and the ratio of states used for estimation ( @xmath53 ) .",
    "we check the key rate for coherent states ( @xmath8 ) , moderately squeezed states ( @xmath79 ) , and strongly squeezed states ( @xmath80 ) , while the distance is a function of @xmath19 .",
    "so the only parameters remaining are @xmath207 , @xmath52 , and @xmath51 .    ] , moderate squeezing [ orange ( medium gray ) , @xmath64 , and strong squeezing [ purple ( dark gray ) , @xmath65 , for the optimized single - modulation ( dotted lines ) and double - modulation ( solid lines ) schemes as a function of distance @xmath57 for @xmath208 , @xmath63 , and @xmath66 . for comparison we plotted also the key rate yielded by the current state - of - the - art technique ( thick black dashed line ) and the best theoretically possible upper limit @xmath67 ( thick black dash - dotted line ) .",
    "[ fig_eps],width=321 ]    if the excess noise @xmath207 increases ( see fig . [ fig_eps ] ) the achievable distances become shorter in every case .",
    "but the difference for squeezed states will be much smaller than in the other cases ( with the largest difference in the nonoptimized case ) .",
    "so we can conclude that the proposed optimized single- and double - modulation squeezed - state protocols are much more robust against noise .",
    "] , moderate squeezing [ orange ( medium gray ) , @xmath64 , and strong squeezing [ purple ( dark gray ) , @xmath65 , for the optimized single - modulation ( dotted lines ) and double - modulation ( solid lines ) schemes as a function of distance @xmath57 for @xmath60 , @xmath209 , and @xmath66 . for comparison we plotted also the key rate yielded by the current state - of - the - art technique (",
    "thick black dashed line ) and the best theoretically possible upper limit @xmath67 ( thick black dash - dotted line ) .",
    "[ fig_beta],width=321 ]    the situation is similar if the reconciliation efficiency @xmath52 is reduced ( see fig .",
    "[ fig_beta ] ) .",
    "once again the distances are decreasing , but in this case the differences will be smaller .",
    "the nonoptimized version performs a little better than previously , because in this case the optimal @xmath18 becomes closer to the _ a priori _ fixed modulation .",
    "the advantage of using the double - modulation method is more visible even for relatively large values of @xmath19 ( i.e. , for small distances ) .",
    "] , moderate squeezing [ orange ( medium gray ) , @xmath64 , and strong squeezing [ purple ( dark gray ) , @xmath65 , for the optimized single - modulation ( dotted lines ) and double - modulation ( solid lines ) schemes as a function of distance @xmath57 for @xmath60 , @xmath63 , and @xmath61 . for comparison we plotted also the key rate yielded by the current state - of - the - art technique ( thick black dashed line ) and the best theoretically possible upper limit @xmath67 ( thick black dash - dotted line ) .",
    "[ fig7],width=321 ]    if we increase the block size @xmath51 ( see fig .",
    "[ fig7 ] ) then the achievable distances will increase too .",
    "note that the relation of the different methods is similar if @xmath51 is smaller ; the improvement is close to an additive function ( as we have seen for the theoretical limit in the main text ) .",
    "let us also note that for large distances there will be a fair improvement using the double modulation method compared to the single modulation case : we can achieve the same distance with many fewer sqeezed states ( e.g. , double modulation with 3 db squeezing produces a similar performance as single modulation with 10 db squeezing ) .",
    "the key rate closely approaches the theoretical limit for the given level of squeezing ."
  ],
  "abstract_text": [
    "<S> we investigate the main limitations which prevent the continuous - variable quantum key distribution protocols from achieving long distances in the finite - size setting . we propose a double - modulation protocol which allows using each state for both channel estimation and key distribution . as opposed to the standard method , we optimize the parameters of the protocol and consider squeezed as well as coherent states as a signal . by </S>",
    "<S> optimally combining the resources the key rate can approach the theoretical limit for long distances , and one can obtain about ten times higher key rate using ten times shorter block size than in the current state - of - the - art implementation . </S>"
  ]
}