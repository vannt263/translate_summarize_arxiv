{
  "article_text": [
    "topological data analysis ( tda ) @xcite refers to a combination of statistical , computational , and topological methods allowing to find shape - like structures in data .",
    "the tda has proven to be a powerful exploratory approach for complex multi - dimensional and noisy datasets .",
    "for tda to be applied , a dataset is encoded as a finite set of points in some metric space .",
    "the general and intuitive principle underlying tda is based on persistence of @xmath1-dimensional holes , e.g. , connected components @xmath2 , loops @xmath3 , etc .",
    ", in a topological space that is inferred from random samples for a wide range of scales ( resolutions ) at which data is looked at . accordingly",
    ", persistent homology is the key topological property under consideration @xcite .    the procedure to compute persistent homology associated to a point cloud data set involves the construction of a filtration of simplicial complexes , ordered with respect to some resolution ( scaling ) parameter .",
    "as the resolution parameter changes , some topological features appear in the corresponding simplicial complex while others disappear . thus , each topological feature is assigned a ` birth ' and a ` death ' value , and the difference between the two values represents the persistence of that feature . a topological feature that persists for a bigger range of scales",
    "can be viewed as a significant one , while a feature that persists for a smaller range can be viewed as a less significant , or a noisy feature .",
    "an important quality of the persistence homology method is that it does not require an artificial cutoff between ` signal ' and ` noise ' ; all topological features that emerge from the data are kept , and assigned ` weights ' according to their persistence .",
    "the output of the filtration procedure is captured in a concise form by a persistence diagram .",
    "the two coordinates of each point in the diagram represent the birth value and the death value of a @xmath1-dimensional hole .",
    "an alternative instrument to summarize the information contained in a persistence diagram is a persistence landscape @xcite .",
    "the latter consists of a sequence of continuous , piecewise linear functions defined in the rescaled birth - death coordinates , which are derived from the persistence diagram .",
    "persistence diagrams have a natural metric space structure whereas persistence landscapes are naturally embedded in a banach space .",
    "thus , one can study the statistical properties of persistence landscapes , e.g. , compute expectations and variances , among other properties @xcite .",
    "a remarkable property of persistence homology is that both persistence diagrams and persistence landscapes are robust under perturbations of the underlying data .",
    "that is , if the data set changes only little , the persistence diagrams / persistence landscapes move only by a small distance .",
    "this feature is a key ingredient for mathematically well - founded statistical developments using persistence homology .",
    "exploration of stable topological structures ( or ` shapes ' ) in nosy multidimensional datasets has led to new insights , including the discovery of a subgroup of breast cancers @xcite , is actively used in image processing @xcite , in signal and time - series analysis @xcite .",
    "the latter has primarily been applied to detect and quantify periodic patterns in data @xcite , to understand the nature of chaotic attractors in the phase space of complex dynamical systems @xcite , to analyze turbulent flows @xcite , and stock correlation networks @xcite .    motivated by these studies , in this paper , we investigate whether application of tda to financial time series could help to detect a growing systemic risk in financial markets . despite the obvious practical interest for policymakers and market participants , prediction of catastrophic market meltdowns",
    "is notoriously difficult due to complexity and non - stationarity of the financial system . during last decades",
    ", there has been a growing body of empirical and theoretical studies , inspired by analysis of abrupt transitions in complex natural systems , devising early warning signals ( ews ) in financial markets , see , e.g. , @xcite and references therein .",
    "observations on different markets show that financial crashes are preceded by a period of increasing variance of stock market indices , shifting of spectral density of time series towards low frequencies as well as growing cross - correlations . yet",
    ", there is no consensus regarding the mechanism of financial crises . moreover , even a relatively short - term forecasting of approaching financial disaster remains one of the open challenges .",
    "we analyze the time - series of daily log - returns of four major us stock market indices : s&p 500 , djia , nasdaq , and russel 2000 .",
    "collectively , these noisy @xmath4 signals form a multi - dimensional time series in @xmath5-space .",
    "we apply a sliding window of certain length @xmath6 along these time series , thereby obtaining a @xmath5-point cloud for each instance of the window .",
    "the sliding step is set to one day .",
    "then we compute the @xmath0-norms ( @xmath7 and @xmath8 ) of the persistence landscape of the loops ( @xmath4 persistent homology ) in each of the @xmath5-point clouds .",
    "the resulting time series of @xmath0-norms allows to track temporal changes in the state of the equity market .",
    "we find that the time series of @xmath0-norms exhibits strong growth prior to the primary peak , which ascends during a crash .",
    "remarkably , the average spectral density of the time series of the norms of the persistence landscapes demonstrates a strong rising trend at low frequencies for 250 trading days prior to either the dotcom crash on 03/10/2000 or to the lehman bankruptcy on 09/15/2008 .",
    "our study suggests that tda provides a qualitatively new type of econometric analysis that can be used to detect ews of imminent market crashes .",
    "the method is very general and can be applied to any asset - types and mixtures of time series .    in section [ sec : background ]",
    "we provide a concise and informal review of the tda background and key concepts employed in this paper . in section [ sec : turbulence ] we compare our method outlined above with the traditional time - delay coordinate embedding procedure .",
    "we test the proposed method on several multidimensional time series , generated by various non - linear and non - equilibrium models .",
    "these tests help to assess how the characteristics of the underlying process affect the persistence landscapes . in each case",
    ", we let the parameters of the underlying process change slowly , in specific ways , and observe which features of the signal makes the @xmath0-norms of the persistence landscapes grow .",
    "section [ sec : empirical ] presents our findings on financial data , which demonstrate that the time series of the norms of the persistence landscapes and its variability could be used as new ews of approaching market crashes .",
    "section [ sec : conclusions ] concludes the paper .",
    "tda uses topology to extract information from noisy data sets .",
    "an important step is to assign topological invariants that remain robust under small changes of the scale at which the data set is being considered .",
    "this is particularly relevant for analyzing complex systems , when there is no information available on the underlying stochastic process .",
    "the method of persistence homology , which we use in this paper , allows computing the topological features at all scales , and ranking these features according to the range of scales at which these features can be observed .",
    "here we provide a brief account of persistent homology , with an emphasis on the tools that we use directly . for a rigorous exposition",
    ", we refer the interested reader to the textbook @xcite .",
    "the input data that we analyze is a point cloud data set consisting , of a family of points @xmath9 in an euclidean space @xmath10 .",
    "we associate a topological space to such data set as follows . for each distance",
    "@xmath11 we define the so called vietoris - rips simplicial complex @xmath12 , or , simply rips complex , obtained as follows :    * for each @xmath13 , a @xmath1-simplex of vertices @xmath14 is part of @xmath15 if and only if the mutual distance between any pair of its vertices is less than  @xmath16 , that is @xmath17    if we think of @xmath16 as the resolution at which that data is looked at , then a @xmath1-simplex is included in @xmath15 for every set of @xmath1 data points that are indistinguishable from one another at resolution level @xmath16 .",
    "the rips simplicial complexes @xmath12 form a filtration , that is , @xmath18 whenever @xmath19 .",
    "for each such complex , we can compute its @xmath1-dimensional homology @xmath20 with coefficients in some field .",
    "informally , the generators of the @xmath21-dimensional homology group @xmath22 correspond to the connected components of @xmath15 , the generators of the @xmath23-dimensional homology group @xmath24 correspond to the ` independent loops ' in @xmath15 , the generators of the @xmath25-dimensional homology group @xmath26 correspond to ` independent cavities ' in @xmath15 , etc .    in the sequel",
    ", we will use only the @xmath23-dimensional homology . as an example of a loop at level @xmath16 ,",
    "consider a set of @xmath27 points @xmath28 in @xmath29 such that the distance @xmath30 , for @xmath31 , with @xmath32 computed mod @xmath27 , but no other pair of points in this set is within a distance of @xmath16 .",
    "we note that , by the definition of the rips complex , we can not have a loop consisting of only @xmath33-points .",
    "the filtration property of the rips complexes induces a filtration on the corresponding homologies , that is @xmath34 whenever @xmath19 , for each @xmath1 .",
    "these inclusions determine canonical homomorphisms @xmath35 , for @xmath19 . due to this family of induced mappings",
    ", for each non - zero @xmath1-dimensional homology class @xmath36 there exists a pair of values @xmath37 , such that @xmath38 but @xmath36 is not in the image of any @xmath39 , for @xmath40 , and the image of @xmath36 in @xmath41 is non - zero for all @xmath42 , but the image of @xmath36 in @xmath43 is zero . in this case",
    ", one says that @xmath36 is ` born ' at the parameter value @xmath44 , and ` dies ' at the parameter value @xmath45 , or that the pair @xmath46 represent the ` birth ' and ` death ' indices of @xmath36 .",
    "the multiplicity @xmath47 of the point @xmath48 equals the number of classes @xmath36 that are born at @xmath49 and die at @xmath50 .",
    "this multiplicity is finite since the simplicial complex is finite .",
    "the information on the @xmath1-dimensional homology generators at all scales can be encoded in a so called persistence diagram @xmath51 .",
    "such a diagram consists of :    * for each @xmath1-dimensional homology class @xmath36 one assigns a point @xmath52 together with its multiplicity @xmath47 ; * in addition , @xmath51 contains all points in the positive diagonal of @xmath53 .",
    "these points represent all trivial homology generators that are born and instantly die at every level ; each point on the diagonal has infinite multiplicity .",
    "the axes of a persistence diagram are birth indices on the horizontal axis and death indices on the vertical axis . for an example , see fig .",
    "[ fig : circles_persistence.png ] .    -dimensional persistence diagram and the corresponding persistence landscape are shown below .",
    ", scaledwidth=85.0% ]    the space of persistence diagrams can be endowed with a metric space structure .",
    "a standard metric that can be used is the _ degree @xmath54 wasserstein distance _ , with @xmath55 , defined by @xmath56^{1/p},\\ ] ] where the summation is over all bijections @xmath57 , and @xmath58 denotes the @xmath59 norm . since persistence diagrams include the diagonal set , the above summation includes pairing of points @xmath60 between off - diagonal points and diagonal points in @xmath61 , @xmath62 .",
    "when @xmath63 the wasserstein distance @xmath64 is known as the ` bottleneck ' distance .",
    "a remarkable property that makes persistence homology suitable to analyze noisy data is its _ robustness _ under small perturbations .",
    "informally , this property says that if the underlying cloud point data set changes only ` little ' , then the corresponding persistence diagrams moves only a ` small ' wasserstein distance from the persistence diagram corresponding to the unperturbed data ; see @xcite .",
    "the space of persistence diagrams @xmath65 endowed with the wasserstein distance forms a metric space @xmath66 .",
    "however , this metric space is not complete , hence not appropriate for statistical treatment .",
    "this is an inconvenience for our purposes , since we want to study time series of persistence diagrams with statistical tools .    to address this issue ,",
    "several works have been devoted to either modify the structure of the space of persistence diagrams endowed so that it has a more amenable structure ( e.g. , of a polish space , or geodesic space ) , or to embed the space of persistence diagrams into function spaces .",
    "one such an embedding is based on persistence landscapes , consisting of sequences of functions in the banach space @xmath67 ; see @xcite .",
    "we now define persistence landscapes . for each birth - death point @xmath68",
    ", we first define a piecewise linear function @xmath69 $ ; } \\\\",
    "-x+d_\\alpha , & \\hbox{if $ x\\in\\left(\\frac{b_\\alpha+d_\\alpha}{2},d_\\alpha\\right)$ ; } \\\\",
    "0 , & \\hbox{if $ x\\not\\in ( b_\\alpha , d_\\alpha)$. }                            \\end{array }                          \\right.\\ ] ]    to avoid confusion , we point out that in eq .",
    ", by @xmath48 we mean the open interval with endpoints @xmath70 and @xmath71 , while earlier we also denoted by @xmath48 a point in @xmath51 of coordinates @xmath70 and @xmath71 .    to a persistence diagram @xmath51",
    "consisting of a finite number of off - diagonal points , we associate a sequence of functions @xmath72 , where @xmath73 $ ] is given by @xmath74 where the @xmath75 denotes the @xmath1-th largest value of a function .",
    "we set @xmath76 if the @xmath1-th largest value does not exist . for an example of a persistence landscape , see fig .",
    "[ fig : circles_persistence.png ] .",
    "thus , persistence landscapes form a subset of the banach space @xmath67 .",
    "this consists of sequences of functions @xmath77 , where @xmath78 for @xmath79 .",
    "this set has an obvious vector space structure , given by @xmath80 , and @xmath81 , for all @xmath82 , and @xmath83 it becomes a banach space when endowed with the norm @xmath84 where @xmath85 denotes the @xmath0-norm , i.e. , @xmath86 , where the integration is with respect with the lebesgue measure on @xmath87 . in the sequel",
    ", we will use only the @xmath88 and @xmath89 norms .",
    "generally , it is not possible to go back and forth between persistence diagrams and landscapes .",
    "there exist landscapes that do not correspond to persistence diagrams , e.g. , if @xmath90 , @xmath91 are two persistence landscapes derived , via eq . , from corresponding persistence diagrams @xmath92 , respectively , the mean @xmath93 may not correspond , via eq . , to any persistence diagram @xmath94 ; see @xcite .",
    "however , the banach space structure makes persistence landscapes suitable for treatment via _ statistical methods_.",
    "in section [ sec : empirical ] we will analyze financial time series using persistence landscapes and their norms ( @xmath7 and @xmath8 ) .",
    "we will see that these norms exhibit substantial growth prior to financial crashes , while they exhibit a tame behavior when the market is stable . in this section",
    ", we will explain our method of analysis and test it on several synthetic multidimensional time series generated by various non - linear and non - equilibrium models .",
    "the objective is to assess how various features of the signal affect the growth of the @xmath0 -norms of the persistence landscapes .",
    "consider @xmath95 time series @xmath96 , where @xmath97 , and a sliding window of size @xmath6 .",
    "for each instance @xmath98 , we have a point @xmath99 .",
    "then for each time - window of size @xmath6 we have a point cloud data set consisting of @xmath6 points in @xmath10 , namely @xmath100 .",
    "algorithmically , the point cloud is formed by a @xmath101 matrix , where @xmath95 is the number of columns corresponding to the number of @xmath4 time series under study and @xmath6 is the size of the window , which determines the length of a column .",
    "then tda is applied on top of the time - ordered sequence of point clouds to study the time - varying topological properties of the multidimensional time series , from _ window _ to _",
    "window_. for each point cloud we compute the persistence diagram of the rips filtration , the corresponding persistence landscape , and its @xmath0-norms .",
    "we use efficient computational algorithms and the relevant tda libraries allowing computation of topological features from noisy observations @xcite . in our implementation",
    "we employ the r - package  tda \" @xcite , which greatly simplifies the application programming interface .    in the following subsection",
    "we illustrate our method to analyze a time series generated by a stochastic version of the hnon map .",
    "we now compare our approach with the well - known method based on time - delay coordinate embedding @xcite , which is broadly used in the conventional analysis and tda studies of @xmath4 signals .",
    "first , we describe the case when the underlying signal is stationary and represents the time series of a chaotic attractor ( hidden in a ` black box ' ) . a sliding window of size @xmath102",
    "is applied to this time series , with each instance of a window giving rise to a point in @xmath103 .",
    "the theory ensures the resulting set of points in @xmath103 represents ( approximately ) an embedding of the attractor in the @xmath102-dimensional space , provided the dimension @xmath102 is chosen large enough : at least twice the fractal dimension of the attractor @xcite .",
    "there are several methods to estimate , directly from the time series , the minimal dimension @xmath102 necessary to achieve the embedding @xcite .",
    "we should stress that this approach becomes increasingly difficult to apply when the dimension of the attractor is large , or in the presence of noise @xcite ; see also @xcite .",
    "the second case that we describe is when the @xmath4 time series is associated to a non - stationary process ; we follow @xcite .",
    "given a lengthy @xmath4 time - series , one takes a partition of it into multiple segments of a predefined size @xmath6 .",
    "within each segment , a sliding window of size @xmath102 is applied to the time series , where each instance of the window is consists of a sequence of @xmath102 consecutive data - points from the time series , where @xmath104 .",
    "again , @xmath102 has to be chosen suitably large .",
    "the time - ordered sequence of sliding windows for each segment forms a single point cloud of size @xmath105 in @xmath103 .",
    "thereby , one obtains a representation of each segment of length @xmath6 of the @xmath4 dataset in the @xmath102-dimensional space .",
    "then one applies tda on top of the embedded point clouds to study the time - varying topological properties of the time series , _ from segment to segment_.    we stress that our method is quite different from the time - delay embedding method . as we do not aim to obtain an embedding of the time series in some",
    "_ high dimensional space _  as such embedding might be practically impossible to realize , due to the a priori lack of an attractor , and to the intrinsic stochasticity of the time series  we choose to represent the time series in a low dimensional space , namely in @xmath10 , where @xmath106 , as we are dealing with a handful ( that is , @xmath95 ) separate time series .",
    "our approach has only one parameter , the size @xmath6 of the window sliding along the time series , as in contrast with the time - delay method , which has two parameters , the size @xmath6 of the segments , and the size @xmath102 of a sliding window along each segment .",
    "we stress that both the length of the segment @xmath6 in @xcite and the length of the sliding window @xmath6 in our method play the same role , namely to determine the size of the point cloud to which we apply tda , from one segment to another in the former , and from one window to another in the latter . the dimension @xmath102 of the point cloud",
    "is derived from the time - delay embedding procedure in the former , and is naturally given by the number @xmath95 of time series under consideration in the latter .",
    "first , we recall the hnon map @xcite , which can be viewed as a @xmath25-dimensional analogue of the well known logistic map . the latter has been used as a paradigm for economic cycles ( see , e.g. , @xcite ) .",
    "the evolution of stable states , bifurcations , periodic and chaotic regimes  displayed by both the logistic map and the hnon map  provides a useful analogy for the dynamics of economic oscillations and financial crashes ( see , e.g. , @xcite ) .",
    "a model for financial crashes based on bifurcations in dynamical systems appears in @xcite .",
    "the equations of the hnon map are : @xmath107 where @xmath108 , @xmath109 ar real parameters .",
    "it has been shown that , for some range of values of @xmath108 , @xmath109 , every initial condition @xmath110 in some appropriate region of the plane  the ` basin of attraction '  , the sequence @xmath111 approaches the same invariant set , known as the hnon attractor .",
    "for some values of @xmath108 and @xmath109 , the attractor is _",
    "let us fix the parameter @xmath112 and let @xmath113 .",
    "numerical experiments show that for fixed values of parameter the parameter @xmath108 with @xmath114 , there exists an attractor that undergoes period - doubling bifurcations , whereas at @xmath115 a chaotic attractor emerges ; for @xmath108 between @xmath116 and @xmath117 , there exist intervals of values of @xmath108 for which there is a chaotic attractor , which are interspersed with intervals of values of @xmath108 for which there is an attractive periodic orbit .",
    "we modify the equations of the hnon attractor by making one of the parameters change slowly in time ( analogous to an external forcing ) , and we also dress it with noise . for fixed values of the parameter @xmath109 ( @xmath118 , @xmath119 , @xmath120 , and @xmath112 ) , we let the parameter @xmath108 grow slowly and linearly in time , from @xmath121 to @xmath122 , and also add the gaussian noise .",
    "that is , we consider the system : @xmath123 where @xmath124 is a normal random variable , @xmath125 is a small step size , and @xmath126 is the noise intensity .",
    "the stochastic terms in eq . correspond to a diffusion process .",
    "the time changes according to @xmath127 , hence @xmath128 can be viewed as equivalent to the time variable .",
    "an realization of the @xmath129-time series for this system is shown in fig .",
    "[ fig : gen_henon_2_d_1.pdf ] .",
    "-time series corresponding to the system eq . .",
    "the horizontal axis corresponds to the values of the parameter @xmath108.,scaledwidth=85.0% ]    first , we generate @xmath130 realizations of the @xmath129-time series @xmath96 , where @xmath97 , one for each value of the parameter @xmath118 , @xmath119 , @xmath120 , @xmath112 .",
    "thus , for each time @xmath98 , we have a point @xmath131 . for a sliding windows @xmath132 ,",
    "we generate a sequence of point cloud data sets @xmath133 .",
    "hence each cloud consists of @xmath6 points in @xmath134 . in figure",
    "[ fig : slices ] , we show two - dimensional projections of point clouds corresponding to various instants of time ; as time progresses , the value of the parameter @xmath108 increases . around each point , we draw a blue circle of a small radius ( left column ) , and of a bigger radius ( right column ) , to illustrate how loops are born and die .",
    "the panels at the top correspond to low values of the parameter @xmath108 , when the deterministic hnon map eq .",
    "has a stable fixed point or a stable periodic orbit of low period ; the corresponding noisy hnon map eq .",
    "shows a cluster of points , or a few clusters apart from one another .",
    "the panels at the bottom correspond to larger values of the parameter @xmath108 , when the deterministic hnon map eq .",
    "undergoes a period doubling bifurcation that leads to a chaotic attractor ; the corresponding noisy hnon map eq .",
    "shows a complex structure .",
    "@xmath135{f_1_s_eps.pdf } & \\includegraphics[height=0.225\\textwidth]{f_1_l_eps.pdf}\\\\ \\includegraphics[height=0.225\\textwidth]{f_2_s_eps.pdf } & \\includegraphics[height=0.225\\textwidth]{f_2_l_eps.pdf}\\\\ \\includegraphics[height=0.225\\textwidth]{f_3_s_eps.pdf } & \\includegraphics[height=0.225\\textwidth]{f_3_l_eps.pdf}\\\\ \\includegraphics[height=0.225\\textwidth]{f_4_s_eps.pdf } & \\includegraphics[height=0.225\\textwidth]{f_4_l_eps.pdf}\\\\ \\includegraphics[height=0.225\\textwidth]{f_5_s_eps.pdf } & \\includegraphics[height=0.225\\textwidth]{f_5_l_eps.pdf } \\end{array}$ ]    next , for each cloud point @xmath136 we associate the corresponding rips filtration @xmath137 , @xmath11 , and we compute the @xmath4 persistence diagram @xmath138 , the corresponding persistence landscape @xmath139 , and the @xmath88 and @xmath89-norms : @xmath140 and @xmath141 , respectively . in fig .",
    "[ fig : henon_l1_l2_norm.pdf ] we show the normalized time series of @xmath140 ( in blue ) and @xmath141 ( in red ) .",
    "both graphs show sharp increase around the parameter value @xmath108 that marks the onset of chaotic behavior .",
    "the conclusion of this numeric experiment is that the @xmath0-norms of persistence landscapes have the ability to detect transitions from regular to chaotic regimes , in systems with slowly evolving parameters .",
    "passing from regular to chaotic dynamics determines significant changes in the topology of the attractor , which are picked up very clearly by the time series of @xmath0-norms . at the same time , the noise dressing added to the signal only plays a minor role .",
    "we stress that we only use this example to test out the proposed method .",
    "in the next subsection we consider a model that is more relevant to empirical financial time series .",
    "-norm ( blue ) and @xmath89-norm ( red ) of the persistence landscapes ; the horizontal axis corresponds to the steps in time , and the vertical axis to the norms ( see text for details).,scaledwidth=100.0%,scaledwidth=50.0% ]      the classic assumption made in theoretical quantitative finance is that a company s equity prices follow a geometric brownian motion . as a result , stock returns , defined as the difference in the logarithm of stock prices separated by a given time lag , are normally distributed . since the main objective of this paper is to explore the utility of tda in the analysis of the evolution of daily returns of four major us stock market indices , in the following we use this model and generate @xmath142 realizations of the series @xmath96 , @xmath143 , of normal random variables .",
    "we wish to test whether changes of the @xmath0-norms of persistence landscapes are related to merely growing variance of the underlining time series or they are also sensitive to more subtle and interesting topological structures appearing when noises become stronger .",
    "we design our numeric experiment as follows .",
    "first , _ we set the seed _ and generate four equivalent time series by the ordered sequence of @xmath144 sliding windows of size @xmath145 with the natural sliding step of @xmath23 . within each of these windows",
    "we generate a point cloud data set from the normal distribution @xmath146 , with @xmath147 that has been sequentially growing from @xmath23 to @xmath148 .",
    "for each generated point cloud @xmath136 we associate the corresponding rips filtration @xmath137 , @xmath11 , and compute the @xmath4 persistence diagram @xmath138 , the corresponding persistence landscape @xmath139 , and the @xmath88-norm @xmath140 , respectively .",
    "we repeat this procedure with _ no seed set _ and compare the outcomes , see fig .",
    "[ fig : white_noise.png ] .",
    "the @xmath89-norm behaves similarly ( not shown here ) .",
    "it is easy to see from this plot that in this scenario the effect is related to the combination of growing variance and new topological structures . additionally , it is interesting to see that very strong noises could lead to a drop in the value of @xmath88-norm .",
    "-norms of persistence landscapes in @xmath5 .",
    "time series are generated by equivalent ( red line ) and different white noises ( blue line ) with the same , but growing standard deviation marked on the horizontal axis ( see text for details ) .",
    ", scaledwidth=85.0%,scaledwidth=45.0% ]      since early 1960 s it has been known that pdfs of equity returns have  fat tails \" @xcite .",
    "the non - gaussian distributions of relative changes in value of different asset types and on multiple time scales is an established stylized fact , see , e.g. , @xcite and references therein .",
    "the fat tails indicate a high probability of extreme price fluctuations .",
    "moreover , there is strong evidence that a time evolution of the volatility of stock returns is determined by its own stochastic process @xcite .",
    "these observations and the turbulent nature of the markets were linked through models encompassing tsallis non - extensive statistics @xcite and ` superstatistics ' @xcite .",
    "the superstatistical approach @xcite significantly simplifies the description of a temporal evolution of the logarithm of asset returns , @xmath129 .",
    "briefly , the model is based on the assumption that the typical relaxation time of a local dynamics @xmath149 is much shorter than the time scale @xmath150 of externally driven fluctuations of its realized variance , @xmath151 .",
    "one assumes that a given discrete time series of @xmath129 containing @xmath152 data points can be divided into @xmath153 time slices with locally equilibrium gaussian distribution of @xmath129 and a distinct value of the realized local variance .",
    "consequently , for @xmath154 , the long - term , @xmath155 , unconditional probability distribution of @xmath129 is approximated by the superposition of two distributions ( therefore , superstatistics ) : locally normal distribution of @xmath129 and the probability distribution @xmath156 of the inverse variance @xmath157 marginalization over @xmath158 expressed by this formula has been originally proposed by praetz @xcite who has shown that an infinite mixture of gaussian pdfs of stock log - returns with the gamma distributed precision @xmath158 : @xmath159 yields the scaled student s @xmath160-distribution , which provides a much better fit to empirical data than the normal distribution . here",
    "@xmath161 is the gamma function , @xmath36 and @xmath162 are the shape and the rate parameters of the gamma distribution , respectively . for large @xmath36",
    "the gamma distribution converges to the gaussian distribution with mean @xmath163 and variance @xmath164 . in this limit , eq .",
    "recovers the normal distribution of log - returns , which follows from the classic geometric brownian motion model of equity prices . yet , for small values of the shape parameter corresponding to a high weight of realizations with high variance , see fig.[fig : gamma]-(a ) , eq",
    ". leads to fat - tailed distributions of @xmath129 .",
    "as praetz @xcite pointed out , by analogy with brownian motion , the variance of price changes over a unit time interval ( the diffusion coefficient ) is proportional to a slowly changing `` @xmath165 ` temperature ' of the share market , @xmath165 which represents the degree of activity or energy of the markets '' .",
    "his insight and formulation of the problem are still incredibly valuable .",
    "recent studies of the daily time series of djia and s&p 500 indices show that empirical distributions of @xmath158 are close to the gamma distribution @xcite .    since the main objective of this paper is to explore the utility of tda in forecasting an approaching financial crash , which is conventionally associated with a growing ` market temperature ' , in the following we use the model outlined above , and generate @xmath142 realizations of the series @xmath96 of normal random variables with gamma - distributed precision .",
    "specifically , each of these time series is generated by the ordered sequence of @xmath144 sliding windows of size @xmath145 with the natural sliding step of @xmath23 . within each of these windows",
    "we generate a point cloud data set from the normal distribution @xmath166 , with @xmath158 that has been randomly taken from the set of @xmath144 gamma - distributed variables . to imitate the transition from the ` cold ' ( low variance ) to the ` hot ' ( high variance ) state of a market",
    ", for the first @xmath167 sliding steps we keep the scale parameter relatively high @xmath168 .",
    "then we decrease this parameter by @xmath169 for each of the last @xmath170 steps .",
    "we keep the rate parameter fixed , @xmath171 . for each generated point cloud @xmath136 we associate the corresponding rips filtration @xmath137 , @xmath11 , and compute the @xmath4 persistence diagram @xmath138 , the corresponding persistence landscape @xmath139 , and the norms : @xmath140 and @xmath141 , respectively . in fig .",
    "[ fig : gamma]-(b ) we show the normalized time series of @xmath140 and @xmath141 , averaged over 10 realizations .",
    "-norm of persistence landscapes derived for the process with the gamma distributed inverse variance of the white noise .",
    "the horizontal axis corresponds to steps in time ( see text for details).,scaledwidth=100.0%,scaledwidth=50.0% ]    the plot shows sharp increase of the @xmath88-norm of persistence landscapes with the decrease of the shape parameter , which corresponds to the increase in variance and fattening of the tails of the distributions of @xmath129 .",
    "the @xmath89-norm behaves similarly ( not shown here ) .",
    "thus , the @xmath0-norms of persistence landscapes are very sensitive to transitions in the state of an underlining system from a regular to a ` heated ' regime .",
    "once again , we stress that the main goal of our numeric experiments is to check applicability of the proposed method to noisy multidimensional time series that are typical for complex systems .",
    "we certainly do not claim that these particular models are representative for how crashes occur in financial markets .",
    "we analyze the daily time series of four major us stock market indices : s&p 500 , djia , nasdaq , and russel 2000 between december 23 , 1987 and december 08 , 2016 ( @xmath172 trading days ) .",
    "the times series data were downloaded from yahoo finance . for each index and for each trading day",
    "we calculate log - returns defined as the forward daily changes in the logarithm of the ratio @xmath173 , where @xmath174 represents the adjusted closing value of the index @xmath32 at the day @xmath175 .",
    "we wish to explore the topological properties of this multi - dimensional time series . in our approach",
    ", the point cloud is formed by @xmath6 points in @xmath134 , where the coordinates of each point in @xmath134 represent the daily log - returns .",
    "that is , each point cloud is given by a @xmath176 matrix , where the number of columns @xmath142 is the number of @xmath4 time series involved in our analysis , and the number of rows @xmath6 is the size of the sliding window .",
    "we consider two sizes of the window : @xmath132 and @xmath177 trading days ; see fig .",
    "[ fig : scattered ] for an example of @xmath178 point clouds .",
    "the sliding step is set to one day , which in the case under consideration yields a @xmath179 time - ordered set of point clouds .",
    "homology ( loops ) at certain scale ( radius ) in the @xmath178 point cloud of @xmath180 data points .",
    ", scaledwidth=100.0% ]    figure [ fig : rips ] shows the rips persistence diagrams and the corresponding @xmath23-st landscape function @xmath181 , defined by eq .",
    ", calculated with the sliding window of 50 trading days at certain dates .",
    "the @xmath129 and @xmath182 coordinate of rips persistence diagrams correspond to the times of birth ( @xmath109 ) and death ( @xmath95 ) of a topological feature , respectively .",
    "the @xmath129 and @xmath182 coordinate of persistence landscapes correspond to the rescaled axes : @xmath183 , and @xmath184 . in plain words ,",
    "the x - coordinate of a persistence landscape is the average parameter value over which the feature exists , and the y - coordinate is the half - life of the feature .",
    "figure [ fig : rips ] demonstrates a visually clear separation of topological signals from a topological noise per point cloud .",
    "two of selected dates correspond to the date of the technology crash on march 10 , 2000 ( [ fig : rips]-(a ) , right column ) and the date of the lehman bankruptcy on 09/15/2008 ( fig .",
    "[ fig : rips]-(b ) , right column ) .",
    "it is clearly seen from these plots that as the stock market becomes more volatile loops in the relevant point clouds become much more pronounced .",
    "@xmath185{diagrams_landscapes_2000tif.pdf}\\\\ \\includegraphics[width=0.84\\textwidth]{diagrams_landscapes_2008tif.pdf } \\end{array}$ ]    to quantify this behavior , as a convenient summary of changes in topological features throughout filtration , we calculate the @xmath0 norms ( @xmath186 ) of the persistence landscapes @xmath187 for each rolling window .",
    "the set of these values forms the daily time series of these measures ; see fig .",
    "[ fig : crashes - c ] for an example .",
    "figure [ fig:1000days ] shows the normalized time series of the @xmath88 norms of persistence landscapes calculated with the sliding window of @xmath132 trading days around the date of the technology crash and the date of the lehman bankruptcy . for comparison",
    ", we also show the corresponding segments of the normalized time series of s&p 500 and the volatility index vix .",
    "the vix measures the implied volatility in the s&p 500 index over the next @xmath188 days and is often used for forecasting purposes .",
    "it is qualitatively clear from these plots that the time series of the @xmath88-norm demonstrates strong fore - shocks prior to the primary peak , which mounts during a crisis .",
    "the change of the size of the rolling window from @xmath180 to @xmath144 days as well as the temporal behavior of the @xmath89-norm closely resemble this picture ( not shown here ) .",
    "the only notable differences in the outcome related to the change of the window size are an overall flattening of spikes in the time series of the @xmath0-norms and a slight shift of the primary maximum of these time series towards the later dates .",
    "@xmath189{crashes_c } \\end{array}$ ]     trading - days prior to a crash .",
    "top - down , the daily time series of the normalized s&p 500 , the normalized @xmath88-norm of topological landscapes calculated with the sliding window of @xmath180 days , and vix . left column : proximity of the ` dotcom crash ' on 03/10/2000 .",
    "right column : proximity of the lehman bankruptcy on 09/15/2008.,scaledwidth=100.0% ]    having the time series of @xmath0 norms of persistence landscapes in place , we apply the standard technique and analyze the leading statistical indicators of these time series . in that way",
    ", we further quantify temporal variations in the persistence of loops in the time - ordered set of point clouds with a growing market stress .",
    "we follow guttal et.al .",
    "@xcite , and employ the @xmath190 days rolling window with the sliding step of one day to calculate the variance , the average spectral density at low frequencies , and the first lag of the auto - correlation function ( acf ) for @xmath191 trading days prior to the date of a market crash .",
    "this window should not be confused with the sliding window of @xmath132 days that has been used for encapsulation of point clouds throughout the computation of the time series of @xmath0-norms of persistence landscapes .",
    "figure [ fig : kendall ] shows the obtained results .",
    "it is clearly seen from the plots on this figure that the variance and the average spectral density at low frequencies of the time series of @xmath0-norms are substantially growing prior to any of the crashes .",
    "we quantify the observed trend with the mann - kendall test , which statistically assess a monotonic upward or downward movement of the variable over time @xcite .",
    "the strong trend of rising average spectral density at low frequencies for @xmath191 trading days prior to either dotcom crash on 03/10/2000 or to the lehman bankruptcy on 09/15/2008 is especially pronounced : kendall - tau rank correlation coefficients are @xmath192 and @xmath193 , respectively . on the other hand",
    ", the acf at lag-@xmath23 shows no trend prior to any of these events .",
    "we note that doubling the size of the point cloud to @xmath144 data points does not significantly change this picture ( not shown here ) . for comparison",
    ", we also present on fig .",
    "[ fig : kendall ] the temporal behavior of the same statistical indicators obtained with the same rolling window of @xmath190 days from the daily time series of the volatility index .",
    "interestingly , prior to the 2000 crash the time series of vix shows a declining variability . on the other hand , similarly to the norms of persistence landscapes , the average spectral density at low frequencies of the time series of vix demonstrates strong rising trend for @xmath191 trading days prior to the lehman bankruptcy ( kendall - tau @xmath194 ) .",
    "@xmath195{kendall_2000png.pdf}\\\\ \\includegraphics[width=0.72\\textwidth]{kendall_2008png.pdf } \\end{array}$ ]",
    "we apply tda for exploration of the temporal behavior of topological features in the well - known financial data as the state of the market is changing with time .",
    "the novelty of our approach to multi - source time series is twofold : ( i ) we use the single sliding window to enclose the point cloud in the @xmath95-dimensional space determined by the number of time series under consideration ; ( ii ) we employ the @xmath0-norm of persistence landscapes as a quantifier of stability of topological features .",
    "we believe that this approach can be used beyond the analysis of financial time series presented here .",
    "more specifically , we study persistence of loops ( @xmath4 persistence homology ) in a @xmath5 point cloud formed by a _ single _ sliding window and _ four _ @xmath4 time series of daily log - returns of the four stock - market indices .",
    "thus , contrary to the traditional two - parametric time - delay embedding method , our approach has only one parameter : the size of the window , @xmath6 .",
    "our study reveals that the _ shape _ of financial time series strongly depends on the state of the market .",
    "the empirical analysis shows that the time series of the @xmath0-norms exhibit strong growth around the primary peak emerging during a crisis .",
    "this behavior reflects an increased persistence of loops appearing in point clouds as the market undergoes transition from the ordinary to the  heated \" state .",
    "remarkably , the variability of the time series of the @xmath0-norms of persistence landscapes , quantified by the variance and the spectral density at low frequencies , demonstrates a strong rising trend for @xmath191 trading days prior to either dotcom crash on 03/10/2000 or to the lehman bankruptcy on 09/15/2008 .",
    "our study suggests that tda offers a novel econometric method , and is yielding the new category of early warning signals of an imminent market crash .",
    "research of m.g . was partially supported by nsf grant dms-0635607 and by the alfred p. sloan foundation grant g-2016 - 7320 .",
    "research of y.k . was supported by s&p global market intelligence .",
    "the first author is grateful to k.  mischaikow for useful discussions .",
    "the views expressed in this paper are those of the authors , and do not necessary represent the views of s&p global market intelligence .",
    "lum , g. singh , a. lehman , t. ishkanov , m. vejdemo - johansson , m. alagappan , j. carlsson , and g. carlsson , extracting insights from the shape of complex data using topology , scientific reports * 3 * ( 2013 ) 1236 .",
    "m. nicolau , a.j .",
    "levine , and g. carlsson , topology based data analysis identifies a subgroup of breast cancers with a unique mutational profile and excellent survival , proc .",
    "* 108 * ( 2011 ) 7265 .",
    "seversky , s. davis , and m. berger , on time - series topological data analysis : new data and opportunities , proceedings of the ieee conference on computer vision and pattern recognition workshops , ( 2016 ) 59 .",
    "m. kramar , r. levanger , j. tithof , b. suri , m. xu , m. paul , m.f .",
    "schatz , m. paul , m.f .",
    "schatz , k. mischaikow , analysis of kolmogorov flow and rayleigh - benard convection using persistent homology , physica d : nonlinear phenomena * 334 * ( 2016 ) 82 .",
    "m. gidea , topological data analysis of critical transitions in financial networks .",
    "e. shmueli et al .",
    "( eds . ) , 3rd international winter school and conference on network science , springer proceedings in complexity , doi 10.1007/978 - 3 - 319 - 55471 - 6_5 ( 2017 ) .",
    "v. guttal , s. raghavendra , n. goel , and q. hoarau , lack of critical slowing down suggests that financial meltdowns are not critical transitions , yet rising variability could signal systemic risk , plos one * 11 * ( 2016 ) e0144198 .",
    "dionysus : a c++ library for computing persistent homology , ( 2012 ) http://www .",
    "mrzv.org/software/dionysus/ ; c. maria , gudhi , simplicial complexes and persistent homology packages . ( 2014 ) https : //project.inria.fr / gudhi / software/ ; b. t. fasy , j. kim , f. lecci , and c. maria .",
    "introduction to the r package tda .",
    "arxiv:1411.1830 ( 2014 ) ."
  ],
  "abstract_text": [
    "<S> we explore the evolution of daily returns of four major us stock market indices during the technology crash of 2000 , and the financial crisis of 2007 - 2009 . </S>",
    "<S> our methodology is based on topological data analysis ( tda ) . </S>",
    "<S> we use persistence homology to detect and quantify topological patterns that appear in multidimensional time series . using a sliding window , </S>",
    "<S> we extract time - dependent point cloud data sets , to which we associate a topological space . </S>",
    "<S> we detect transient loops that appear in this space , and we measure their persistence . </S>",
    "<S> this is encoded in real - valued functions referred to as a persistence landscapes. we quantify the temporal changes in persistence landscapes via their @xmath0-norms . </S>",
    "<S> we test this procedure on multidimensional time series generated by various non - linear and non - equilibrium models . </S>",
    "<S> we find that , in the vicinity of financial meltdowns , the @xmath0-norms exhibit strong growth prior to the primary peak , which ascends during a crash . </S>",
    "<S> remarkably , the average spectral density at low frequencies of the time series of @xmath0-norms of the persistence landscapes demonstrates a strong rising trend for 250 trading days prior to either dotcom crash on 03/10/2000 , or to the lehman bankruptcy on 09/15/2008 . </S>",
    "<S> our study suggests that tda provides a new type of econometric analysis , which goes beyond the standard statistical measures . </S>",
    "<S> the method can be used to detect early warning signals of imminent market crashes . </S>",
    "<S> we believe that this approach can be used beyond the analysis of financial time series presented here .    </S>",
    "<S> topological data analysis , financial time - series , early warning signals 05.40.-a,05.45 </S>",
    "<S> . tp </S>"
  ]
}