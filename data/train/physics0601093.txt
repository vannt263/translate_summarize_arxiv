{
  "article_text": [
    "the results presented in this paper concern two distinct , recently introduced simulation methods@xcite .",
    "the first is resolution exchange , which allows exchange between simulations at different resolutions , and preserves canonical sampling .",
    "the second is top - down exchange , which allows unequal distribution of cpu time , maximizing the efficiency of an exchange simulation .",
    "in addition , we describe a general incremental coarsening strategy for building a ladder of models which improves exchange efficiency .",
    "resolution exchange ( resex ) is motivated by the effectiveness of coarse - grained models for sampling of protein conformations@xcite , and by the need for atomic - level resolution for many calculations .",
    "res - ex uses coarse - grained simulation to accelerate basin - hopping in more detailed models .",
    "in contrast with _",
    "ad hoc _ methods , resex guarantees canonical sampling of the atomic - resolution model .",
    "the basic idea , as in any exchange simulation , is to exchange conformations between two simulations .",
    "how are trial configurations constructed for an exchange between models with different numbers of degrees of freedom ?",
    "consider a pair of models : a coarse - grained model , a configuration of which is described by a set of coordinates @xmath2 , and an atomic resolution model described by a larger set , @xmath3 .",
    "note that the coarse model is built from a _ subset _ of the coordinates of the detailed model . before the exchange ,",
    "let the coarse - grained configuration be @xmath4 , and let the atomic - resolution coordinates be @xmath5 . by swapping only coarse variables ,",
    "the trial configuration for the coarse - grained model is simply @xmath6 , and for the atomic - resolution model is @xmath7 .",
    "the exchange criterion is derived by considering the two simulations to consitute a single system characterized by the combined coordinates @xmath8 .",
    "because the simulations  aside from the exchanges  run independently , the probability distribution of the combined system is the simple product of the individual distributions .",
    "let the potential functions of the high- and low - resolution simulations be @xmath9 and @xmath10 respectively , and denote the boltzmann factors as @xmath11 and @xmath12 , where @xmath13 and @xmath14 are the partition functions .",
    "then the exchange attempt is accepted with the metropolis rate : @xmath15 . \\label{resxrate}\\ ] ] the dependence on inverse temperature ( @xmath16 ) is made explicit , as a reminder that the method is naturally combined with temperature exchange , though this of course extends to any type exchange , such as hamiltonian exchange@xcite .",
    "note that in the case of ordinary ( temeprature based ) replica exchange , in which all the coordinates are swapped , eq .",
    "( [ resxrate ] ) reduces to the familiar expression @xmath17 $ ] .    in a parallel implementation , eq .",
    "( [ resxrate ] ) , together with the protocol for trial move construction , ensures that the algorithm satisifies the detailed balance condition . to see this ,",
    "consider `` old '' ( @xmath18 ) and trial/``new '' ( @xmath19 ) configurations of the combined system . in the construction of any boltzmann  preserving monte carlo move , two transition probabilites must be considered : the conditional probability @xmath20 of _ generating _ the move from configuration @xmath18 to @xmath19 , and the conditional probability @xmath21 of _ accepting _ the move@xcite .",
    "detailed balance insists that @xmath22 , where @xmath23 is the equilibrium probability of configuration @xmath24 . yet",
    "the acceptance criterion ( [ resxrate ] ) has the form @xmath25 implying that the generating probabilities @xmath26 are identical .",
    "this is indeed the case : given a pre - defined division into coarse and detailed coordinates , the conditional probability for the move @xmath27 , and its inverse , are both one .",
    "that is , given the old configuration of the combined system , there is a unique trial configuration .",
    "lwin and luo have constructed a similiar algorithm , except that _ before _ checking acceptance via eq .",
    "( [ resxrate ] ) , the high - resolution trial configuration is _ _ minimized__@xcite .",
    "such minimization ( even subject to constraints on the coarse coordinates @xmath28 , as in ref .",
    "@xcite ) violates the detailed balance condition by biasing the generating probability , @xmath20 , without any compensating correction in the acceptance criterion .",
    "put more simply , reverse moves into un - minimized configurations are impossible .",
    "the consequences of the violation are readily seen , as shown in sec .",
    "[ toymodel ] .",
    "an important practical issue is raised , however , by the construction of trial moves _ without _ minimization .",
    "the problem is that the degrees of freedom in the high resolution simulation @xmath29 are strongly coupled  for a protein , think of @xmath28 as backbone degrees of freedom ( dof ) and @xmath30 as side - chain dof .",
    "then it is clear that construction of trial moves by our method may lead to high rejection rates .",
    "we have solved this problem by noting that the rejection rate depends on the both the _ number and type _ of dof in the set @xmath31 .",
    "employing a ladder of incremental models at intermediate resolutions allows the acceptance rates to be tuned to reasonable values , as shown in fig .",
    "[ metenkladder ] .",
    "a ladder of incrementally coarsened models is straightforward to construct .",
    "consider coarsening from an all - atom representation of a protein to a united - atom representation .",
    "in the first model above the all - atom level , only one residue is described by the united - atom representation  the protein is described by a `` mixed model '' , with one united - atom residue and the rest all - atom",
    ". then , in the next level up , there are two united - atom residues , and so on , until the entire protein is described by the united - atom force field .",
    "a similiar procedure may then be used to go beyond the united - atom level to a united _ residue _ level .",
    "notice that it may be desirable to coarsen more than one residue at a time , since some residues have fewer degrees of freedom than others .",
    "of course , implementation of the incremental ladder just described requires the construction of a potential function which has both united- and all - atom groups . in this work ,",
    "we have built this mixed potential by combining the parameters for united and all - atom force fields into a single file .",
    "in other words , we created a larger parameter file , which contains both all - atom and united atom atom types .",
    "this file also includes all of the interactions for both united- and all - atom types , with the united - atom interactions modified as described in sec .",
    "[ resexsec ] . adding some parameters ( taken from the all - atom potential ) for the interfaces , where united and all - atom residues link ,",
    "the mixed potential describes the whole molecule",
    ". the parameters ( formatted for use in tinker ) are included as supplementary material .",
    "the incremental coarsening approach just described is rather general and not restricted to implementing exchange ladders spanning united- to all - atom resolutions .",
    "lower resolution models could also be considered , for which it may be desirable to coarsen several residues at once . a first quantitative analysis of the incremental coarsening procedure , suggesting how efficiency can be improved , is given in sec .",
    "[ dileucine ] and [ metenksection ] .      in many exchange simulations , whether they are temperature - based@xcite , hamiltonian - based@xcite , or use some other extended ensemble@xcite , the goal is to improve the sampling of a hard - to - sample model ( such as an all - atom protein model at native conditions ) by sampling a related model , which is _ presumed _ easier - to - sample ( such as the same all - atom model at higher temperature ) .",
    "information is swapped between the simulations by occasionally exchanging configurations , in a way which preserves canonical sampling of each distribution .",
    "usually there is little overlap between the hard - to - sample ( henceforth , `` bottom level '' ) and the easy - to - sample ( henceforth , `` top - level '' ) models , and therefore a ladder of intermediate models is required .",
    "a critical observation is that the accuracy which is ultimately attained in the hard - to - sample , bottom - level model is effectively limited by that which is obtained in the easy - to - sample , top - level model@xcite . in many cases ,",
    "the top level is still quite difficult to sample well , and will require considerable cpu time to reach an acceptable accuracy  much more than it would usually be allotted in a parallel implementation .",
    "it is this observation which motivates the top - down method .",
    "the top - down algorithm shown schematically in fig .",
    "[ topdown ] was developed previously for temperature - based simulation@xcite , though was not widely recognized as such .",
    "the procedure is as follows :    first , note that canonical sampling is maintained by eq .",
    "( [ accept])@xcite , just as in an ordinary parallel exchange simulation . on the other hand , detailed balance is not satisfied , as the trial configuration for the level @xmath19 simulation ( @xmath32 above ) is discarded  making reverse moves effectively impossible .",
    "the error is one of practice , not of principle , arising from the fact that the samples of @xmath33 and @xmath34 are finite , just as in any simulation .",
    "to see intuitively that canonical sampling is maintained by top - down exchange , imagine a pair of simulations undergoing ordinary parallel exchange .",
    "unbeknownst to the investigator , however , the top level simulation is running on a very fast processor , while the other is running on an old , slow processor . between neighboring exchange points , the trial conformations from the fast processor will be far more decorrelated than those of the slow simulation  which mimics the effect of the top - down protocol .",
    "however , these exchanges still satisfy detailed balance . in the limit of an infinitely fast top - level simulation , trial configurations",
    "are completely decorrelated , and one could equally well choose randomly from @xmath33 as in step ( iii ) .",
    "second , notice that because trial configurations are pulled _ at random _ from the sample of @xmath33 in step ( iii ) , transitions which are slow in the actual m@xmath35 trajectory occur rapidly among the trial configurations .",
    "maximum benefit is thus obtained from successful exchanges  in contrast with a parallel exchange simulation , where trial configurations are typically separated by only a few picoseconds , and remain highly correlated .",
    "third , good results may be obtained expending very little cpu time on all levels except the top one .",
    "this may be understood from an energy landscape perspective .",
    "the top level has been used to thoroughly sample the space ",
    "high barriers are crossed , and major sub - basins equilibrated . at lower levels ,",
    "only local equilibration need occur .",
    "for example , let @xmath36 be the time to cross high barriers , @xmath37 be the time to equilibrate locally , and say that @xmath38 successful exchanges are needed to sample the space well .",
    "then @xmath39 cpu time is needed to sample the lower level .",
    "the required condition to save time over a parallel simulation is that @xmath40 . the degree to which this condition is satisfied will depend on the system studied , but the top - down approach allows the flexibility to take advantage of a separation in time scales",
    "this idea is reminiscient of the `` dragging '' of fast degrees of freedom , suggested by neal@xcite , and the multiple time step approaches developed by berne and coworkers@xcite .",
    "finally , a major advantage of top - down simulation over parallel exchange protocols is that exchange attempts are nearly `` free '' , in the sense that no communication is required between processors@xcite .",
    "this means that exchanges may be attempted very frequently , and therefore much lower exchange rates may be accomodated . in the case of temperature exchange",
    ", this allows either for the steps in the temperature ladder to be more widely spaced , or for the treatment of larger systems with fewer replicas .      in ideal circumstances",
    ", low - resolution models used in resex simulations would be specifically optimized for resolution exchange .",
    "they would have maximal conformational overlap for the common degrees of freedom .",
    "here we work with an `` off the shelf '' low resolution model ( united atom ) which leads to some difficulties .",
    "consider , for example , a c@xmath41c@xmath42 bond which is parameterized in the two models by two slightly different natural bond lengths .",
    "in an exchange attempt , the configurations are swapped , and in each trial configuration the c@xmath41c@xmath42 bond is moved a bit from its preferred length .",
    "these small contributions add up for every harmonic term in the entire molecule , and have a noticeable effect on the acceptance of exchange moves .",
    "we have solved this problem by simply changing the harmonic parameters of the coarse model to match those of the detailed model .",
    "this makes the coarse model more `` exchangeable '' with the detailed model .",
    "since the coarse model is simply `` suggesting '' configurations for the atomic model , and since eq .",
    "( [ resxrate ] ) guarantees that no bias is introduced by the coarse model , we need not worry that the coarse model parameters are changed from their original values .",
    "we now describe in detail the two molecular systems which were studied in the present work .",
    "_ dileucine .",
    "_ we first studied dileucine peptide ( ace-(leu)@xmath43-nme ) using the same forcefield parameters as in ref .",
    "@xcite . here",
    ", we also carried out an incrementally coarsened resex simulation of dileucine in @xmath44 levels . the coarsest level ( @xmath45 )",
    "was the same as in @xcite , namely a modified version of oplsua@xcite . in lower levels ,",
    "the molecule was rendered in finer detail beginning at the n - terminus : in @xmath46 , the n - terminal methyl group , c@xmath41 , and c@xmath47 of the first residue were modelled in full atomistic detail ; in @xmath48 , c@xmath49 and both c@xmath50 s of the first residue were additionally modelled explicitly ; in @xmath51 , the c@xmath41 , c@xmath47 , c@xmath49 , and one c@xmath50 of the second residue were modelled explictly ; and finally in @xmath52 , the entire molecule was rendered in full atomic detail .",
    "the ladder of mixed models was chosen to keep approximately fixed the number of hydrogens by which neighboring levels differ , without splitting a methyl group .",
    "the top level ( @xmath45 ) was simulated first , for @xmath53 , @xmath54 , @xmath1 , or @xmath55 nsec .",
    "the different lengths of top - level simulation were used to generate the different data points in fig .",
    "[ dileufig ] .",
    "then the higher resolution models were run , as per the top - down protocol ( see sec .  [ topdownsec ] ) , attempting exchanges once per psec .",
    "a total of @xmath56 exchanges attempted between each level , for a total trajectory length per level of @xmath57 nsec .",
    "frames were stored every @xmath58 psec , for a total of @xmath59 frames in the sample at each level below the top .    _ met - enkephalin . _",
    "we next studied met - enkephalin ( nh@xmath60-phe - gly - gly - tyr - met - coo@xmath61 ) .",
    "the united atom force field was a modified version of oplsua@xcite .",
    "the force field was modified so that the bond length and and angle bending parameters matched those of the all - atom force field , which improves exchangeability ( or conformational overlap ) of the two models .",
    "the sample of the top level model was constructed from two independent @xmath1 nsec trajectories , both started from pdb structure 1plw(@xmath62 nmr model ) , generated by langevin dynamics as implemented in tinker v.  @xmath63@xcite .",
    "the friction coefficient was @xmath44 psec@xmath64 , and solvation was modelled with the gb / sa method@xcite .",
    "the first @xmath65 nsec of each trajectory was discarded and frames were stored every @xmath66 psec for a total of @xmath67 frames in the sample .    we then ran the next higher resolution simulation , as per the top - down algorithm ( see sec .",
    "[ topdownsec ] ) .",
    "this model was of mixed resolution , with the tyr@xmath68 residue represented by the oplsaa all - atom forcefield@xcite , and the remaining residues described by the oplsua force field .",
    "every @xmath65 psec , a random configuration was pulled from the top - level ( m@xmath69 ) trajectory , and a resolution exchange was attempted , with acceptance governed by eq .",
    "( [ resxrate ] ) .",
    "since the acceptance ratio for the m@xmath69 to m@xmath70 exchanges was approximately @xmath66% , the average length of m@xmath70 trajectory between exchanges was @xmath66 psec .",
    "a total of @xmath71 resex moves were attempted , for a total m@xmath70 trajectory length of @xmath66 nsec .",
    "frames were stored every @xmath58 psec for a sample of @xmath72 frames .",
    "this procedure was then repeated for each level shown in fig .",
    "[ metenkladder ] , with the exception that the attempt frequency of resex moves was adjusted for the acceptance ratios , so that the segments of the simulations between exchanges were kept approximately constant at @xmath66 psec .",
    "also , the total number of attempted exchanges was adjusted so that approximately @xmath73 successful exchanges were observed between each level , for a total trajectory length of @xmath66 nsec at each level .",
    "given that the top level is presumed to be well - sampled , @xmath73 exchanges should sample a large number of basins .",
    "in a previous short paper , we tested the resex algorithm on two small molecules : butane and dileucine peptide@xcite .",
    "it was shown that the method produced results in agreement with those obtained by standard simulation methods .",
    "for the sake of clarity , here we first demonstrate our approach on a two - dimensional toy model , consisting of two basins which differ only _",
    "entropically_. we also extend the method to two peptides , dileucine and met - enkephalin , in order to demonstrate the viability of incremental coarsening .      an important consideration in designing any sampling method",
    "is whether it will correctly account for entropy differences .",
    "we therefore designed the potential surface shown in fig .",
    "[ twodfig ] to compare three different sampling methods : a `` standard '' monte carlo simulation , the same monte carlo with resolution exchange , and the same monte carlo with the `` dual rem '' method of lwin and luo@xcite .    the surface @xmath74 in fig .",
    "[ twodfig ] is described by the function @xmath75 where @xmath76 , @xmath77 @xmath78 is the barrier height , and @xmath79 controls the width of the right well in the figure . notice that the profile of the surface at @xmath80 is symmetric about @xmath81 : @xmath82 , i.e. , the two minima are of equal depth .",
    "the parameters were chosen so that the equilibrium populations of the two wells differ greatly ",
    "we used @xmath83 , so that the right well holds @xmath84% of the population , as measured by standard techniques .    for both the resex and the dual rem simulations ,",
    "the `` coarse - grained '' potential was simply the one - dimensional potential @xmath85 , i.e. , a symmetric double well .    to describe the exchange moves explicitly , we denote @xmath86 configurations by @xmath87 and @xmath88 configurations by @xmath89 . for both algorithms , an exchange move consists of two parts : the construction of a @xmath88 trial configuration ( @xmath90 ) from a @xmath86 configuration ( @xmath91 ) , and vice versa : the construction of a @xmath86 trial configuration ( @xmath92 ) from a @xmath88 configuration ( @xmath93 ) .",
    "the construction of a @xmath88 configuration in each case is simple  the `` extra '' ( @xmath94 ) coordinate is dropped , i.e. , @xmath95 .",
    "the only difference between the two simulations is in the construction of trial configurations for the @xmath86 model from the @xmath88 model . in resex ,",
    "the trial configuration is the @xmath89 coordinate from the @xmath88 model , with the ( old ) @xmath94 coordinate from the @xmath86 model , i.e. , @xmath96 and @xmath97 . in dual rem ,",
    "on the other hand , the trial @xmath94 coordinate is chosen randomly , and then minimized . for the potential @xmath74 , this means that @xmath98 _ always _ ,",
    "i.e. , @xmath96 and @xmath99 .",
    "the resex simulation correctly samples the two wells , giving a population in the right well of @xmath100% . the dual rem simulation , on the other hand , yields a population of @xmath101% for the right well . what causes the error in the dual rem simulation ?",
    "the answer is that the construction of dual rem trial moves violates detailed balance .",
    "more specifically , the minimization of the @xmath94 coordinate means that the difference in _ width _ between the two wells is not accounted for correctly , since in dual rem @xmath98 _",
    "always_. notice that the it is not the random selection of the @xmath94 coordinate which intrinsically violates detailed balance , only the subsequent minimization .",
    "what is the analagous situation in molecular simulations ? in this case , both resex and dual rem construct trial moves in internal coordinates  the coarse - grained model is built from a subset of the degrees of freedom of the atomic model .",
    "for example , the coarse - grained model ( the @xmath102 coordinate above ) may be the backbone coordinates of a protein , and the remainder ( the @xmath94 coordinate above ) may be the sidechain degrees of freedom . in dual rem construction of trial moves ,",
    "the sidechains are minimized prior to exchange , and the therefore differences in entropy between different sidechain conformations are neglected . in resex , there is no minimization prior to exchange , and canonical sampling is maintained .",
    "we previously reported on resex results for dileucine , demonstrating successful exhange and significant speedup from a direct exchange between all - atom and united - atom models . here",
    ", show that dileucine may be coarsened incrementally , and that ( i ) the correct distribution is observed for the all - atom model and ( ii ) adding additional intermediate levels of resolution improves efficiency .",
    "the additional levels boost the exchange acceptance by two orders of magnitude : exchanges were successful between @xmath103 and @xmath104 @xmath105% of the time , between @xmath104 and @xmath106 @xmath107% of the time , between @xmath106 and @xmath108 @xmath109% of the time , and between and @xmath108 and @xmath110 @xmath111% of the time . by comparison , exchanging aa and ua dileucine in a single step is successful only @xmath112% of the time@xcite .",
    "however , we need to ask whether it is really more efficient to introduce additional levels of simulation in order to boost the acceptance of exchange moves .    in fact",
    ", it appears to be substantially more efficient to use incremental coarsening rather than abrupt coarsening .",
    "the cost for a given ladder of @xmath113 levels may be written @xmath114 where the cost of the top level is fixed , @xmath38 is the fixed number of successful exchanges which are desired , @xmath115 is the simulation cost for an interval between two exchange attempts at level @xmath116 , and @xmath117 is the acceptance rate between levels @xmath116 and @xmath118 .",
    "we have assumed that the sampling of level @xmath116 demands a fixed number of successful resolution exchanges , consistent with the motivation of the top - down protocol discussed in sec .",
    "[ topdownsec ] .",
    "( [ efficiency ] ) implies that the effective exchange rate for an incremental ladder is a reciprocal sum of the individual rates .",
    "if we assume the @xmath115 are equal for all levels ( which is exact for temperature exchange ) , then @xmath119 giving an effective rate for the @xmath44 level dileucine ladder of @xmath120% .",
    "this result suggests an improvement in efficiency relative to the single step ladder , where the rate was @xmath121%@xcite .    in fig .",
    "[ dileufig ] , we compare the sampling of dileucine by three different simulation protocols : standard langevin dynamics , resolution exchange with two levels , and resolution exchange with five levels .",
    "sampling is assessed by examining the relative populations of the @xmath26 and @xmath16 states ( @xmath122 ) considered in ref .",
    "the convergence of this relative population measure requires transitions between the two states , which occur infrequently in a standard simulation .",
    "the five - level ladder clearly outperforms the two - level ladder , as we are able to generate results both more accurate and more precise with the five - level ladder in an equal amount of cpu time .",
    "note that the total simulation time required for the entire ladder , including the top level , is included in the resex data points .",
    "the efficacy of the resex approach is underscored by the fact that , at the top level ( united atom ) , the sign of @xmath123 is wrong .",
    "that is , the exchange process corrects for a substantial bias in the coarse model .",
    "met - enkephalin is a flexible neurotransmitter which participates in immune responses and pain inhibition , among other roles@xcite . by virtue of its small size and biological interest ,",
    "it often is used to test new simulation methods@xcite and compare existing protocols@xcite .    using met - enkephalin",
    ", we demonstrate the efficacy of the incremental coarsening procedure for a ladder of decreasing resolution at constant temperature , and for a ladder of simultaneously decreasing resolution and increasing temperature .",
    "because quantifying the quality of sampling for met - enkephalin is considerably more difficult than is commonly appreciated , we will not present a detailed efficiency analysis .",
    "more will be said on this second topic in the discussion .",
    "we employed the resex algorithm in a top - down framework , as sketched in fig .",
    "[ topdown ] .",
    "first , the top - level simulation ( coarsest resolution  here , united - atom ) was run .",
    "we then ran an exchange simulation at the next highest resolution  here , one residue was represented at all - atom resolution , and the rest of the peptide was united - atom .",
    "this procedure was continued , `` de - coarsening '' one residue at a time , until the entire peptide was represented at the all - atom level .",
    "details are given in secs .",
    "[ incremental ] and [ simdetails ] .",
    "the incremental coarsening procedure substantially increases exchange acceptance .",
    "the five rates in the six - level ladder vary from @xmath124% to @xmath125% , as shown in fig .",
    "[ metenkladder ] . for comparison ,",
    "exchanging between all - atom and united - atom models of met - enkephalin , with no intermediate levels of resolution , results in an acceptance ratio of @xmath126% .",
    "the acceptance ratios vary , in part , according to the number of degrees of freedom by which the two levels differ .    for met - enkephalin , the principal results are the acceptance rates shown in fig .",
    "[ metenkladder ] , which are significant for several reasons .",
    "first , they demonstrate the first implementation of the incremental coarsening approach in a complex peptide .",
    "second , because they are well within the practical range of the top - down protocol ",
    "see sec .",
    "[ topdownsec ] and the discussion  they indicate that the resex algorithm could prove important for larger peptides .",
    "lastly , by comparing the effective exchange rate suggested by eq .",
    "( [ effrate ] ) , @xmath127% , with the rate of @xmath126% for direct exchanges between united- and all - atom models , one sees that a substantial speedup has been achieved .",
    "of course , the magnitude of the improvement is merely suggestive  without a rigorous quantification of the sampling quality , there can be no rigorous comparison of efficiency .",
    "such a quantification is beyond the scope of this work , as noted in the discussion .",
    "it is useful to understand the intuitive reason behind the advantage of incremental coarsening .",
    "if one writes the acceptance criteria ( [ resxrate ] ) and ( [ accept ] ) in the form @xmath128 $ ] , then for exchanges between models of greatly differing resolution , one typically finds the dimensionless `` energy '' is large , i.e , @xmath129 .",
    "it seems to be roughly true that this energy is proportional to the difference in the number of degrees of freedom in the models being exchanged .",
    "however , if the change is made incrementally using many models m@xmath130 , then between levels @xmath116 and @xmath118 there is a relatively small cost @xmath131 , with @xmath132 .",
    "it is clear that with enough increments , one can achieve @xmath133 , and thus create a high likelihood for exchange since the corresponding boltzmann factors are much larger : @xmath134 .",
    "this is exactly what is embodied in eq .",
    "( [ efficiency ] ) .",
    "the trade - off is that one pays the cost for simulating the additional intermediate levels .",
    "however , as has been stressed in sec .",
    "[ topdownsec ] , the intermediate - level simulations are very short compared to the top level . in the present context , for instance , the top level met - enkephalin trajectory is @xmath135 nsec , while all other levels were simulated for only @xmath66 nsec .",
    "the net savings can be quite substantial , especially considering that good sampling is achieved by increasing the number of exchanges . while we can not yet rigorously measure sampling quality , we can show that the results obtained with resex are consistent with those obtained by standard methods , by comparing ramachandran histograms ( fig .",
    "[ resex - rama ] ) from the resex simulation , to those obtained by standard simulation ( @xmath136 nsec of simulation with the @xmath52 parameters ) .",
    "overall , the agreement between the resex simulation and the @xmath136 nsec conventional simulation is quite good .",
    "however , a careful comparison reveals a region on the phe@xmath70 plot , labelled `` a '' , which is noticeably under - sampled by the resex simulation , as compared to the @xmath136 nsec langevin dynamics trajectory .",
    "the explanation is provided by an inspection of the phe@xmath70 histogram of the united - atom simulation : region `` a '' was not sampled by the top - level simulation .",
    "the failure points to a potential weakness of the resex ( or any exchange ) method  regions which are not sampled by the top level will be difficult to sample in any of the other levels .",
    "this is a specific instance of a general problem that occurs whenever auxiliary distributions are used to enhance sampling of some `` distribution of interest , '' namely the need to balance overlap with wider sampling via the auxiliary distribution@xcite . in other words , it is a failure of the top - level simulation rather than the algorithm .",
    "interestingly , fig .",
    "[ resex - rama ] also presents two counterexmples to the forgoing discussion .",
    "regions `` b '' of the gly@xmath137 and `` c '' of the met@xmath69 plots were both well - sampled by the resex simulation , despite being infrequently visited by the top - level .",
    "that is , the resex acceptance criterion ( [ resxrate ] ) correctly `` re - weights '' the conformation space of the all - atom model by allowing normal dynamics to continue when appropriate .",
    "nevertheless , we are in the process of experimenting with other `` schedules '' ( combinations of attempt frequency and number of exchange attempts ) to balance the normal and the exchange dynamics .    ideally , the coarse model distribution would have better overlap with the high - resolution distribution , and the balance could be adjusted to favor exchanges over normal dynamics .",
    "this would allow the same quality of sampling with less simulation at each level below the top .",
    "in the long term , we hope to design coarse models constructed to _ not _ eliminate _ any _ regions of configuration space in more detailed models .",
    "we have also explored the possibilty of combining resolution exchange with parallel tempering , so that the sampling of the reduced models is improved both by the reduction in resolution and by increased temperatures . in a standard parallel tempering simulation , the temperatures are roughly exponentially distributed , in order that the conformational overlap between neighboring temperatures is constant over the ladder .",
    "however , there is no simple relationship between the change in _ resolution _ and the acceptance of resolution exchanges .",
    "some care must therefore be taken with the assignment of the temperature ladder .",
    "we began with the ladder of models in fig .",
    "[ metenkladder ] .",
    "the acceptance ratios give an idea of the temperature gap which may be tolerated between two levels  a higher acceptance ratio will tolerate a larger jump in temperature .",
    "however , compared to standard parallel tempering simulations@xcite , it may seem that the acceptance ratios are already too low to accomodate tempering in addition to resolution exchange .",
    "after all , we may expect that any difference in temperature will lower the acceptance of exchange moves . in this regard",
    ", the top - down approach has an important advantage over a parallel implementation . since exchange attempts are `` free '' ( no commmunication between processors is required ) , they may be attempted much more frequently , and lower accptance ratios may be tolerated@xcite .",
    "indeed , in our original study of dileucine peptide with top - down resolution exchange , the acceptance ratio was much less than @xmath65%@xcite .",
    "see also sec .",
    "[ topdownsec ] .",
    "the ladder combining temperature and resolution is shown in fig .",
    "[ metenk - tres ] .",
    "the temperature gaps were chosen by trial and error , aiming for an acceptance of attempted exchanges of a few percent between neighboring levels . based upon this restriction",
    ", the top - level simulation was run at a temperature of @xmath138 k , which is comparable to previously published parallel tempering studies of met - enkephalin@xcite .",
    "we should expect , however , that fixed cpu cost sampling should be improved relative to ordinary replica exchange , by virtue of the reduction in resolution .",
    "the reduction in resolution confers an additional benefit when combined with tempering .",
    "since the overlap between neighboring levels in a parallel tempering simulation scales like @xmath139 , reducing resolution allows the temperature gaps to _ increase _ as the resolution is reduced .",
    "the overlap between neighboring levels in a combined resolution / tempering ladder is thus controlled both by the change in resolution , and the change in temperature , with the two effects compensating one another in an unknown way .",
    "indeed , we observed one puzzling case in our search for an appropriate resolution / temperature ladder . in one ladder ( data not shown ) , exchange between levels m@xmath140 and m@xmath137 was successful about @xmath141% of the time when both were at @xmath142 k , while exchange occurred approximately @xmath143% of the time when m@xmath140 was thermostatted to @xmath144 k , and m@xmath137 to @xmath145 k. we have not explained this result  though it should be remembered that different models have different landscapes , and therefore temperatures may not be directly compared",
    "we have extended our resolution exchange ( resex ) method@xcite using an incremental coarsening procedure for implicitly solvated peptides .",
    "after carefully testing the approach in the two - residue dileucine peptide , we applied it successfully to the five - residue met - enkephalin .",
    "incremental coarsening allows tuning of the conformational overlap between models of differing resolution , and therefore makes practical simulations which would otherwise be hampered by poor acceptance of exchange moves .",
    "we have also demonstrated that resolution exchange is naturally combined with parallel tempering , so that the reduced resolution models may be aided in their sampling of conformations by elevated temperatures .",
    "ramachandran histograms demonstrate that , for the most part , resex simulation is consistent with standard simulation techniques . in one case , however , they reveal a weakness of our method  a top - level simulation which eliminates important regions of conformation space will result in poor sampling at the bottom level .",
    "this weakness is shared by any simulation which relies upon auxiliary ensembles to sample among major sub - basins . in the future",
    "we hope to eliminate this problem by more careful construction of reduced models .    of course",
    ", we hope to treat still larger molecules with the resex method .",
    "since it is essential that the top - level be well - sampled , the treatment of larger molecules will require yet coarser top - level simulation .",
    "this will likely require incremental coarsening from the united - atom level to a model with one or two beads per residue .",
    "suitable models are under development .",
    "it appears that the resex approach can not be applied easily to explicitly solvated systems ; however , given the difficulty and importance of sampling implicitly solvated systems , resex may prove very valuable for biomolecular simulation .",
    "we have also developed an alternative rigorous algorithm which permits the use of coarse top - level simulations to generate atomically detailed canonical samples .",
    "it is essentially a `` decorating '' procedure , and it eliminates the potential issue of correlations between coarse coordinates @xmath28 and detailed coordinates @xmath30 , which could reduce acceptance rates in resolution exchange . specifically , after generating a low - resolution sample distributed according to @xmath146 , one can independently sample detailed coordinates @xmath30 according to an arbitrary distribution @xmath147 .",
    "( for example , @xmath148 could be based on harmonic terms in the full forcefield . )",
    "full configurations are thus generated according to the simple product @xmath149 and may be re - weighted to generate a fully detailed , high - resolution , distribution @xmath150 using standard methods@xcite . in the long term , the decorating approach may prove useful for adding explicit solvent .",
    "it may also be implemented in an incremental fashion .",
    "an `` auxiliary '' question which remains to be carefully addressed is the quantification of sampling efficiency .",
    "there are numerous proposals for judging whether a simulation is converged  some are based on principal components@xcite , others on energy - based ergodic measures@xcite , and our own work in progress uses structural histograms@xcite .",
    "which one provides an appropriate measure depends on what properties are of interest . for applications which depend on the relative populations of various conformations , such as calculation of binding affinities for small molecules , a measure which depends directly on the conformational distribution is needed .",
    "such a method is under development  for now we only mention that structural histograms provide a much more sensitive signal of non - convergence than energy - based methods@xcite .    _ acknowledgements . _",
    "the authors would like to thank marty ytreberg , bruce berne , michael deem , and angel garca for interesting discussions and insightful comments .",
    "this work was supported by the department of environmental and occupational health and the department of computational biology at the university of pittsburgh , and by the nih ( grants es007318 and gm070987 ) .    _ supporting information .",
    "_ parameter files for the modified oplsua force field and for the mixed ua - aa force field are provided .",
    "the files are formatted for use with the tinker molecular modelling simulation package .",
    "also included is a sample ` .key ' file for running the mixed forcefield simulations in tinker .",
    "this information is available free of charge via the internet at http:/pubs.acs.org .",
    "[ 1 ] + * referenced in : * # 1                                                                                          liu ,  j.  s. ;  sabatti ,  c. simulated sintering : markov chain monte carlo with spaces of varying dimensions . in _ bayesian statistics _ , vol .  6 ; bernardo ,  j. ;  berger ,  j. ;  dawid ,  a. ;  smith ,  a. ,  eds . ; oxford university press , new york : 1998 ."
  ],
  "abstract_text": [
    "<S> we previously developed an algorithm , called `` resolution exchange '' , which improves canonical sampling of atomic resolution models by swapping conformations between high- and low - resolution simulations@xcite . </S>",
    "<S> here , we demonstrate a generally applicable incremental coarsening procedure and apply the algorithm to a larger peptide , met - enkephalin . in addition </S>",
    "<S> , we demonstrate a combination of resolution and temperature exchange , in which the coarser simulations are also at elevated temperatures . </S>",
    "<S> both simulations are implemented in a `` top - down '' mode , to allow efficient allocation of cpu time among the different replicas .    </S>",
    "<S> atomic resolution simulations of proteins are currently limited to short durations ( less than one @xmath0sec)@xcite or small systems ( less than @xmath1 residues)@xcite . </S>",
    "<S> furthermore , accurate calculations involving large conformational changes are not possible for any system , as the cost of calculating entropic contributions is too great . </S>",
    "<S> indeed , the cost of such calculations is only going to increase , as empirical force fields are improved by including polarization effects , either in a classical way@xcite or in a semiclassical way@xcite .    thoroughly sampling </S>",
    "<S> the space of conformations is essential for a number of problems . from a purely biological perspective </S>",
    "<S> , there is a growing awareness of the importance of protein fluctuations  over and above the static picture  in the function of most proteins@xcite . </S>",
    "<S> allostery and conformational changes dramatic enough to be captured experimentally are just two examples of the existence of such fluctuations@xcite . in a computational context </S>",
    "<S> , careful validation of empirical forcefields requires confidence in the quality of conformational sampling , so that error may be attributed to the forcefield rather than undersampling . </S>",
    "<S> the calculation of free energy differences  as required for evaluation of binding affinities of small molecules@xcite , or the strength of protein - protein interactions@xcite  also requires reliable sampling@xcite .    </S>",
    "<S> the undersampling ( or `` quasi - ergodicity '' ) problem is widely recognized , and consequently there have been many attempts to improve upon standard simulation protocols . methods which aim to generate a canonical distribution of conformations include multiple time - step methods@xcite , nonlinear variable transformations@xcite , j - walking@xcite , inverse renormalization group approaches@xcite , and adaptive resolution methods@xcite . </S>",
    "<S> the most widely used class of methods , however , comprises the generalized ensemble approaches@xcite . of the generalized ensemble approaches , </S>",
    "<S> perhaps the simplest and most popular is parallel tempering , in which a number of copies of the system are evolved in parallel at different temperatures@xcite . </S>",
    "<S> occasionally , configurations are swapped between neighboring replicas , presumably allowing the low temperature replica to access more configuration space via high temperature conformations .    </S>",
    "<S> numerous@xcite , as well as extensive@xcite parallel tempering simulations have been published , including some which claim to demonstrate the superior efficiency of the method over standard molecular dynamics ( md ) simulation@xcite . </S>",
    "<S> regardless of the validity of those claims , there appears to be a limit to the utility of parallel tempering for the study of large proteins , nucleic acids , and macromolecular complexes : the number of replicas required to bridge a specified temperature gap increases as the square root of the number of degrees of freedom of the solution@xcite . </S>",
    "<S> in other words , if atomic resolution information is desired , then very many atomic resolution simulations are required . </S>",
    "<S> recent work by berne and coworkers partly addresses this problem for explicitly solvated systems , so that the number of replicas scales with the number of degrees of freedom of the solute only@xcite . </S>",
    "<S> solutes like proteins , of course , can be quite large . in this paper </S>",
    "<S> , we address the problem of insufficient sampling of implicitly solvated biomolecules using a different approach . </S>",
    "<S> we recently developed an algorithm , called resolution exchange , which uses a distribution generated by a coarse - grained model to improve the sampling of a higher - resolution simulation@xcite . </S>",
    "<S> the resolution exchange ( resex ) algorithm guarantees canonical sampling for each level of resolution , so that the coarse - grained simulation introduces no bias into the high - resolution simulation . </S>",
    "<S> the algorithm is similiar in spirit to other exchange simulations , in that conformations are swapped between otherwise independent simulations . </S>",
    "<S> however , by employing replicas of reduced resolution , resex has the potential for significant efficiency gains . </S>",
    "<S> other authors have recognized the value of improving sampling with reduced resolution representations . </S>",
    "<S> for example , iftimie _ et .  </S>",
    "<S> al . </S>",
    "<S> _ used a classical potential as an importance function to improve sampling of an _ ab initio _ potential@xcite . here </S>",
    "<S> , our goal is to sample a _ </S>",
    "<S> classical _ atomic resolution potential , which leads us to a different algorithm . </S>",
    "<S> also , liu and sabatti formally introduced a markov chain monte carlo method which allows jumps between spaces of different dimensions@xcite . </S>",
    "<S> their algorithm has apparently not been applied to the simulation of macromolecules . </S>",
    "<S> lwin and luo recently introduced an algorithm similiar to ours , but it does not generate canonical sampling@xcite .    we have also employed a modification of the usual parallel protocol used to carry out exchange simulations@xcite , generalizing the `` j - walking '' approach previously introduced by frantz _ _ et .  </S>",
    "<S> al .  _ </S>",
    "<S> _ @xcite . </S>",
    "<S> the j - walking ( or as we call it , `` top - down '' exchange ) method allows an unequal distribution of cpu time among the various replicas . </S>",
    "<S> we emphasize that any exchange simulation may be run in top - down mode . </S>",
    "<S> in contrast with other exchange methods , top - down exchange allows very little simulation time to be spent on the computationally expensive , high - resolution ( or low temperature ) replicas . </S>",
    "<S> substantial improvement in sampling efficiency is therefore possible , in principle .    </S>",
    "<S> we previously applied the resolution exchange algorithm to butane and dileucine peptide@xcite . here , we confront issues which arise in the study of larger molecules . </S>",
    "<S> we show that a molecule may be coarsened incrementally , so that the overlap between models of neighboring resolution may be adjusted for improved sampling efficiency . </S>",
    "<S> we also demonstrate that resolution and temperature exchange are easily combined in a single simulation , so that sampling may be improved by both increasing temperature and decreasing resolution simultaneously . </S>",
    "<S> the incremental coarsening procedure is first demonstrated on dileucine , where we check that the correct conformational distribution is attained . </S>",
    "<S> we then demonstrate successful exchange between an all - atom model and an united - atom model of met - enkephalin , using two different exchange ladders : a ladder of varying resolution only , and a ladder which combines resolution and temperature changes . </S>",
    "<S> we will finish with a discussion of the next logical steps toward larger peptides and proteins . </S>"
  ]
}