{
  "article_text": [
    "vlasov s equation is fundamental for numerous problems in plasma theory .",
    "this kinetic equation describes the behaviour of the single particle distribution functions of a collisionless plasma under the influence of electric and magnetic fields .",
    "coupled with the equations for the electromagnetic fields and the evaluation of the moments of the distribution functions one obtains a highly nonlinear system of differential and integral equations .",
    "only a few very simple problems can be solved analytically .",
    "for this reason numerical simulations of vlasov s equation have become an important tool for theoretical plasma physics .",
    "one type of computer simulation approach integrates the distribution function directly on a high  dimensional numerical grid in phase space . here",
    "one dimension is needed for every space component and for every velocity component . following",
    "the original work by cheng and knorr @xcite much progress has been made on improving the accuracy of the advection schemes .",
    "the integration of the distribution function can be carried out in a number of different ways : the simplest schemes are finite difference schemes .",
    "they are relatively easy to implement but suffer from numerical instabilities and nonpositivity of the distribution function .",
    "conservation laws such as the conservation of particle number can be implemented but complicate the scheme greatly @xcite .",
    "conservative methods , on the other hand , discretise the distribution function by integrating over the numerical grid cells @xcite .",
    "the advantage of these methods lies in the fact that the particle number is naturally conserved and no artificial sources or sinks of particles are introduced .",
    "semi - lagrangian methods ( e.g. @xcite ) follow the characteristics backwards and interpolate the distribution function at the origin of the characteristic . the interpolated value is then transported forward to the grid points .",
    "semi - lagrangian methods do not naturally conserve the particle number but can easily be made to preserve positivity .    most of the above methods are , however , developed for a one  dimensional advection problem . when used for a one  dimensional electrostatic system",
    "in which the physical phase space is two  dimensional , a time splitting method is employed which was already proposed in @xcite . although semi - lagrangian methods in principle allow to integrate the distribution function directly on the high  dimensional grid , the time splitting technique is also used to simplify the computation @xcite .",
    "the general idea is that in higher dimensions this time splitting can be generalised in a straightforward way @xcite .",
    "we will show in this paper that , when including a magnetic field , this simple time splitting  although second order  can cause dissipation due to errors which are always in the same direction .",
    "this implies that the temperature of the system will increase systematically .",
    "we will also present an alternative method which we named _ backsubstitution _ method .",
    "the backsubstitution method not only eliminates the problems of the time splitting method but is also computationally less expensive .    in section 2",
    "we will present the basic underlying equations .",
    "section 3 will describe the time splitting method and show how a systematic error develops . in section 4",
    "we will present the backsubstitution method which we will apply to boris scheme in section 5 .",
    "section 6 discusses simulations of bernstein waves using the different schemes to provide a comparison .",
    "section 7 gives some concluding remarks .",
    "the basis of the kinetic plasma description is the distribution function @xmath0 which expresses the particle density in phase space . here",
    "@xmath1 is the number of particles in a phase space volume @xmath2 located at @xmath3 at time @xmath4 . in a collisionless plasma the evolution of the distribution function",
    "is given by vlasov s equation @xmath5 where @xmath6 and @xmath7 are the electric and magnetic fields which have to be determined self - consistently .",
    "vlasov s equation describes the advection of values of the distribution function along particle characteristics given by newton s law of motion .    one central property of vlasov s equation is the conservation of the phase space density , which directly translates into a conservation of mass and charge in a closed system . for this reason it is natural to use a conservative scheme for simulating vlasov s equation ( for 1dimensional schemes ,",
    "see e.g. @xcite ) .",
    "today , a diversity of eulerian schemes , all with high accuracy and different advantages and disadvantages , are available ( see e.g. @xcite and references therein ) .",
    "these schemes normally solve the one  dimensional advection problem , @xmath8 by integrating over a finite time step one obtains @xmath9 here @xmath10 denotes the characteristic with parameter @xmath11 that satisfies .    for the one dimensional , electrostatic vlasov ",
    "problem @xmath12 a splitting technique is then usually employed .",
    "here one integrates the advection in the @xmath13direction by @xmath14 , then in @xmath15direction by @xmath16 and then again in @xmath13direction by @xmath14 .",
    "this produces a second order scheme which can be written as @xmath17 here @xmath18 denotes the numeric advection operator in the @xmath19dimension .",
    "the success of the time splitting for the one dimensional electrostatic problem motivates a common suggestion to extend the splitting technique to treat higher  dimensional systems . since the spatial dimensions are completely independent of each other this results in the following second order scheme for the full three dimensional system @xmath20    in each of these sub - steps a one dimensional transport equation of type ( [ transport1d ] ) is solved . for each of these equations",
    "the characteristics are calculated and then projected onto the corresponding direction .",
    "this implies that even for a hypothetical _ exact _ one  dimensional integration scheme the characteristics are still only approximated by a second order time splitting scheme . for the following discussion",
    ", we will consider only the velocity part of the integration scheme since this determines how well the particle temperatures are described .",
    "for a purely electrostatic system the above integration behaves well and errors only occur due to repeated application of the advection scheme .",
    "the reason for this is the independence of the change of the velocity component @xmath21 on the velocity @xmath22 . with a magnetic field , however , the change of velocity @xmath21 over a finite time step does depend on the velocity @xmath22 .",
    "here we assume that the integration scheme for the characteristics is at least second order . to investigate the error caused by this method , we take the exact characteristic in @xmath23space and approximate it using the time splitting scheme . during integration of the characteristic ,",
    "the electromagnetic fields are assumed to be constant . without loss of generality",
    "we let @xmath24 and move the origin in velocity space to @xmath25 . for simplicity",
    "we assume @xmath26 .",
    "@xmath27 would only add a constant acceleration in the @xmath28direction , and leads to the same result .    in this setup the characteristics in velocity space",
    "are simple concentric circles around the origin and we can neglect the @xmath28 coordinate completely . during the time interval @xmath16 the whole @xmath29,@xmath30plane rotates by an angle @xmath31 .",
    "taking a velocity @xmath32 we split the rotation into three steps according to the time ",
    "splitting scheme @xmath33 this results in the following @xmath34 inserting @xmath35 into @xmath36 and then @xmath36 into @xmath37 results in a lengthy expression for @xmath37 .",
    "taking the norm of @xmath37 and expanding this expression for small angles @xmath38 , i.e. small time steps @xmath16 , gives @xmath39 by construction this is , of course , second order in @xmath38 .",
    "however , one can see that the second order error is _ always _ negative and thus introduces a systematic error .",
    "the time splitting method ( [ timesplitting ] ) can also be interpreted as performing the individual steps ( [ schemea1])([schemea3 ] ) in first order in @xmath38 .",
    "this corresponds to @xmath40 with respect to equation ( [ transport1d ] ) this scheme is obtained by holding @xmath41 constant for each step . taking the square of this @xmath37 results in @xmath42 one can observe that in this case the second order disappears , and the third order error is not systematic , but depends on the signs of @xmath29 and @xmath30 . in the following",
    "we will refer to eqs ( [ schemea1])([schemea3 ] ) as _ scheme a _ and ( [ schemeb1])([schemeb3 ] ) as _ scheme b_.    in fig .",
    "[ figvelerrfull ] the error of the magnitude @xmath43 of the velocity after a quarter gyration is plotted against the rotation angle @xmath44 of the individual step .",
    "the error is normalised to the initial velocity .",
    "the solid line shows the result of scheme a while the dashed line shows the result of scheme b. the dotted line represents the result of scheme b with alternating order of the @xmath29@xmath30 integration . for scheme",
    "a , a total error of about 2.5% is accumulated after a quarter gyration when @xmath45 . after a full gyration",
    "the error sums up to 10% ( not shown ) .",
    "this value of @xmath46 corresponds to roughly 140 integration steps for the full circle . using less steps , i.e. larger @xmath44 results in even larger errors .    to understand the direction of the error we note , that in eq .",
    "( [ charactransportint ] ) the characteristics are integrated backwards from a grid point to obtain the source of the distribution function for that grid point . the distribution function is then transported from that source to the grid in some manner that depends on the numerical scheme .",
    "the negative sign in the second order of eq .",
    "( [ timesplitsecondorder ] ) implies that the source is always located closer to the rotation centre than the grid point .",
    "thus the values of the distribution function are transported outwards from the rotation centre .",
    "this results in an effective heating of the distribution function",
    ".    using scheme b the errors are smaller but not zero . here",
    "an error of 2% is observed when @xmath47 .",
    "this is equivalent to roughly 16 steps for a full gyration .",
    "because the direction of the error in scheme b depends on the values of @xmath29 and @xmath30 , one can further increase the accuracy by alternating the order of the splitting .",
    "in the two dimensional case considered here this simply implies alternating the roles of @xmath29 and @xmath30 . using the alternating scheme the overall error in the velocity magnitude",
    "is reduced to almost zero .",
    "however , when looking at the relative phase error after a quarter gyration ( fig",
    ". [ figphaseerrfull ] ) no significant improvement can be observed . while scheme a still shows the largest error , the errors for scheme b with and without alternating oder of integration are roughly comparable up to a @xmath44 of 0.5 . for this value of @xmath44",
    "the phase error is approximately 1% .",
    "when the vlasov equation is solved on a discretised grid errors are worse but the main sources of these errors are highlighted by the above analytical argument .     of the magnitude of the velocity after a quarter gyration depending on the angle of an individual step .",
    "curves are plotted for the schemes a , b and scheme b with alternating order of the @xmath29@xmath30 integration .",
    "[ figvelerrfull],width=415 ]     of the phase of the velocity after a quarter gyration depending on the angle of an individual step .",
    "curves are plotted for the schemes a , b and scheme b with alternating order of the @xmath29@xmath30 integration .",
    "[ figphaseerrfull],width=415 ]",
    "in this section we want to present an alternative method for integrating vlasov s equation that does not suffer from the above drawbacks . here",
    "we will present first the general idea of this _ backsubstitution method _ and then write down the equations for the general system described above .",
    "suppose we are given a one dimensional integration scheme for the transport eq .",
    "( [ transport1d ] ) . to create a scheme for the integration of the three  dimensional velocity space",
    "there is no other choice but to split the full three  dimensional problem into a number of one  dimensional substeps . for each of these substeps",
    "the characteristics will be calculated and then projected onto the direction of the advection step .",
    "we still have the freedom , which characteristics to integrate and in which order to integrate them .",
    "direction from the source point @xmath48 of the characteristic to the grid point @xmath49 .",
    "gray lines show corresponding characteristics in the other cells .",
    "the dashed line is the characteristic ending on @xmath49 which is important in the second step .",
    "[ figschematicbacksubs1],width=377 ]    direction from the intermediate point to the destination point @xmath49 of the characteristic .",
    "gray lines show corresponding characteristics in the other cells .",
    "[ figschematicbacksubs2],width=377 ]    to start with , let us again consider the standard case described in the last section . our aim is to formulate a splitting scheme in which the characteristics are integrated exactly , and which uses the minimum number of integration steps .",
    "since we can ignore the @xmath28direction , this means we want only two integration steps , one for @xmath29 , and one for @xmath30 .",
    "the distribution function is first shifted in the @xmath29 , and then in the @xmath30 direction .",
    "figure [ figschematicbacksubs1 ] illustrates the first step while figure [ figschematicbacksubs2 ] illustrates the second step .",
    "both shifts together should transport the value of the distribution function from a source point @xmath50 of a characteristic to its destination point @xmath51 with @xmath52 . here",
    "the indices @xmath13 , @xmath53 , and @xmath54 are used to denote the velocity components @xmath29 , @xmath30 and @xmath28 .",
    "this means that we aim to find a scheme such that @xmath55    in the first step the shift in @xmath29 has to transport @xmath56 from @xmath57 to an intermediate point @xmath58 . in the semi - lagrangian schemes which we are considering here ,",
    "the characteristics are integrated backward from the grid points .",
    "this implies that in the first step ( 1 ) the grid point @xmath49 has to coincide with the intermediate point @xmath59 , or equivalently @xmath60 and @xmath61 .",
    "we have displayed these characteristics in figure [ figschematicbacksubs1 ] . in this way",
    "the distribution function has been shifted along @xmath29 according to @xmath62    given a sufficiently smooth behaviour of the characteristics we can assume that the interpolation scheme causes all other points of the distribution function to be shifted accordingly .",
    "this is particularly true for the characteristic that ends in the grid point @xmath49 ( dashed line in figure [ figschematicbacksubs1 ] ) .",
    "this characteristic will be important in the following step .    in the second step ( figure [ figschematicbacksubs2 ] )",
    "we , therefore , need to choose the characteristic that ends in @xmath49 .",
    "then the source point @xmath63 is given by @xmath64 .",
    "the shift is performed in the @xmath30 direction so that @xmath65 since in the first step we had ( assuming again correct interpolation ) @xmath66 we finally have @xmath67    we now use this motivation to write down a general scheme for three  dimensional velocity space . for every grid point",
    "@xmath49 we perform the integration in three one  dimensional substeps , one for each component @xmath68 .",
    "for each integration a source coordinate @xmath69 and @xmath70 is calculated from a characteristic which does not necessarily pass through @xmath49 . to find @xmath71 for the @xmath29integration we demand @xmath72 in general",
    "this is a nonlinear system of equations for the components @xmath73 and @xmath74 .",
    "the details of this system depend on the way the characteristics are calculated .",
    "given @xmath75 one then has @xmath76 and the integration can be performed from @xmath77 to @xmath78 in the @xmath29direction .",
    "similarly we demand for the @xmath30integration @xmath79 @xmath80 differs from @xmath49 only in the @xmath28component .",
    "once @xmath81 is found we have @xmath82 again the integration is now performed from @xmath83 to @xmath84 in the @xmath30direction .",
    "the @xmath28integration finally is straightforward . since @xmath85 we have @xmath86 and the integration is performed from @xmath70 to @xmath87 in the @xmath28direction .",
    "we want to emphasise that this scheme integrates the characteristics exactly , which means that in terms of figs .",
    "[ figvelerrfull ] and [ figphaseerrfull ] the backsubstitution scheme has errors which are _ exactly zero_.",
    "the main task now is to calculate the characteristics or their approximations in the presence of a magnetic field .",
    "a commonly used approach is the boris scheme @xcite . here",
    "the integration step is formulated as an implicit finite difference scheme @xmath88 the electric and magnetic forces are separated , @xmath89 leading to @xmath90 the transformation from @xmath91 to @xmath92 is a pure rotation with an angle @xmath93 where @xmath94 for small angles @xmath93 this is close to the exact angle @xmath95 .",
    "in contrast to the original scheme of boris , we aim to trace the characteristics backward in time .",
    "this means we want to find @xmath91 in terms of @xmath92 .",
    "we thus reverse the original scheme and rotate @xmath92 by @xmath96 . to implement this rotation the vectors @xmath97 and",
    "@xmath98 are defined @xmath99 then the rotation is performed in two steps @xmath100 and @xmath101 this scheme now supplies @xmath102 in terms of @xmath103 . to facilitate the further calculations we insert ( [ eqdefvprime ] ) into ( [ eqcalcvminus ] ) and separate @xmath91 into it s components @xmath104    we now need to solve the systems of equations ( [ eqsystemx1 ]  [ eqsystemx3 ] ) and ( [ eqsystemy1 ]  [ eqsystemy3 ] ) for the first and the second backsubstitution step . as stated before , the third step is straightforward since @xmath105 is already known . the complete problem can be written in the form @xmath106 since the bijections between @xmath107 and @xmath108 , on one hand , and @xmath109 and @xmath110 , on the other hand , are trivial ( see eqs ( [ eqdefvplus ] ) and ( [ eqdefvminus ] ) ) it is sufficient to formulate the three steps @xmath111    to find ( [ eqborisbackx ] ) we take eqs ( [ eqcalcvminusy ] ) and ( [ eqcalcvminusz ] ) and solve for @xmath112 and @xmath113 giving @xmath114 where @xmath115 and @xmath116 .",
    "these can be inserted into ( [ eqcalcvminusx ] ) which then provides the expression ( [ eqborisbackx ] ) for the first step .",
    "for the second step ( [ eqborisbacky ] ) only eq ( [ eqcalcvminusz ] ) has to be solved for @xmath113 giving @xmath117 with this , @xmath113 can be substituted in eq ( [ eqcalcvminusy ] ) giving @xmath118 in the form ( [ eqborisbacky ] ) .    by virtue of equation ( [ eqcalcvminusz ] )",
    "the @xmath54component is already given in the form ( [ eqborisbackz ] ) .",
    "thus , no further calculation has to be done for the third step .",
    "finally we want to discuss the error of boris scheme combined with the backsubstitution method .",
    "we again investigate the same problem as formulated in section [ sectimesplit ] where the velocity vector is rotated around the origin . while boris scheme introduces a phase error in this rotation ,",
    "the magnitude of the velocity is preserved . using this combined scheme in a grid",
    "based vlasov solver implies that the only diffusion in the system originates from the reconstruction of the distribution function .",
    "we have applied the schemes described above to the simulation of bernstein waves in a periodic system .",
    "these are electrostatic waves propagating at a right angle to a given constant magnetic field @xcite .",
    "the ions are treated as a static neutralising background , while the electrons oscillate in the electrostatic field .",
    "we assume that @xmath119 and the wavevector @xmath120 .",
    "then the dispersion relation can be written as @xmath121 with @xmath122 here we used @xmath123 , @xmath124 , @xmath125 is the electron cyclotron frequency and @xmath126 is the electron plasma frequency .",
    "@xmath127 is the electron mass and @xmath128 is the electron charge .",
    "@xmath129 is the gamma function and @xmath130 is kummer s confluent hypergeometric function .",
    "we chose @xmath131 for all simulations .",
    "for a given @xmath132 , the above dispersion relation has an infinite number of solutions for @xmath133 .",
    "we performed the simulations in one space and three velocity dimensions , @xmath134 .",
    "although two velocity dimensions would be sufficient for this system , we keep the @xmath28dimension to make the results transferable to electromagnetic simulations in which the magnetic field is not fixed .",
    "the simulation box has a length @xmath135 which was resolved with 64 grid cells .",
    "the velocity space was sampled with 50 grid cells in each direction in the interval from @xmath136 to @xmath137 .",
    "the length of the box is chosen to @xmath138 so that exactly one wavelength of the bernstein mode fits into the system . in this way",
    "the size of a grid cell in space is @xmath139 .",
    "the timestep was chosen such that the cfl ",
    "condition is satisfied @xmath140 . for the integration of the distribution function on the grid we use a flux conservative and positive scheme @xcite .",
    ", width=377 ]    the first simulation was initialised with the bernstein wave of the lowest frequency mode @xmath141 .",
    "runs were performed for different values of @xmath132 and using the different integration schemes .",
    "the frequency of the wave was then determined using a fourier analysis .",
    "the results are shown in fig .",
    "[ figdispersion ] for the time - splitting scheme a , time - splitting scheme b , backsubstitution using the boris scheme and backsubstitution using the exact characteristics .",
    "we can observe that the time - splitting scheme a clearly shows the largest error in the dispersion of the waves .",
    "the errors of all the other schemes appear comparable and are very good for all values of @xmath142 .",
    "the larger errors for smaller wavenumbers are due to the choice of the timestep @xmath16 . inserting the definitions for @xmath143 and @xmath19 one finds that @xmath144 for @xmath145 this means @xmath146 or 16 steps for one gyration .    ,",
    "width=377 ]    in another simulation run , the second bernstein mode @xmath147 was initialised .",
    "[ figdispersion2 ] shows the result of the time - splitting scheme b and the backsubstitution method with exact integration of the characteristics .",
    "the dispersion relation is shown for values of @xmath148 , where the errors are largest due to the choice of the timestep .",
    "for this case we observe that the backsubstitution show superior results when compared to the time - splitting method .",
    ".computational time used for a typical run [ tabcomptime ] [ cols=\"^,^\",options=\"header \" , ]     finally , we want to look at the computational time used by the different schemes .",
    "table [ tabcomptime ] shows the times used for a typical run .",
    "the runs for the different schemes were carried out with exactly the same conditions on the same machine . here",
    "we find a clear advantage of the backsubstitution scheme over the splitting schemes .",
    "the backsubstitution scheme with boris integration of the characteristics reduces the computational effort by more than 50% when compared to the time splitting scheme a. with time - splitting scheme b this improvement is still approximately 43% .",
    "the timing for the exact backsubstitution shows less improvement due to the fact that trigonometric functions have to be evaluated .",
    "the reason for the speed  up is the fact that the backsubstitution method has to integrate the distribution function only once for each velocity dimension @xmath29 , @xmath30 and @xmath28 . the splitting schemes , on the other hand , have to integrate the distribution function 7 times .",
    "although the numerical effort of integrating the characteristics in each step is considerably smaller in the splitting scheme b , this is only a part of the computational time spent .",
    "other parts involve the interpolation of the distribution function and the calculation of fluxes across the cell boundaries .",
    "considering all the above results , the backsubstitution method together with the boris scheme can be taken as a good alternative to the traditional time splitting method if speed is the major issue . to obtain the most accurate results , the backsubstitution method together with the exact integration of the characteristics",
    "is the superior scheme .",
    "in addition it also is slightly faster than the time - splitting scheme .",
    "we have shown that the time splitting method for integrating vlasov s equation in higher dimensions can introduce systematic errors when used in the presence of a magnetic field .",
    "these errors originate from the effective splitting of the integration of the characteristics , when a higher order integration scheme is used .",
    "the errors cause the temperature of the distribution function to increase over time , and thus artificially feed energy into the system .",
    "the backsubstitution method presented here for the general case of arbitrary integration schemes of the characteristics eliminates this problem . here",
    "not those characteristics that pass through the grid point are integrated , but those characteristics that will give a consistent scheme when executed in sequence for the full timestep .",
    "this not only provides the best accuracy possible but also reduces the number of integration steps . while in three dimensional velocity space the time - splitting scheme consists of 7 steps , the backsubstitution method only uses 3 steps since each component needs to be integrated only once . due to this advantage the backsubstitution method together with the boris scheme typically decreases the computational effort by over 40% as compared to a simple time splitting method while the errors remain small . on the other hand ,",
    "highest accuracy can be achieved with the backsubstitution method together with the exact integration of the characteristics .",
    "access to the jump multiprocessor computer at the fz jlich was made available through project hbo20 .",
    "this work was supported by the sfb 591 of the deutsche forschungsgesellschaft .",
    "a.  arakawa , computational design for long - term numerical integration of the equations of fluid motion : two dimensional incompressible flow , part 1 , j. comp .",
    "* 1 * ( 1966 ) 119 . reprinted in j. comp .",
    "( 1997 ) 103"
  ],
  "abstract_text": [
    "<S> the standard approach for integrating the multidimensional vlasov equation using grid based , conservative schemes is based on a time splitting approach . here , we show that although the truncation error is of second order , time splitting can introduce systematic heating of the plasma . </S>",
    "<S> we introduce a backsubstitution method , which not only avoids this deficiency but also is computationally less expensive . </S>",
    "<S> the general approach is demonstrated in conjunction with boris scheme for evaluating the characteristics .    and    </S>",
    "<S> vlasov simulations , method of characteristics    02.70.-c , 52.25.dg , 52.65.ff , 52.25.xz </S>"
  ]
}