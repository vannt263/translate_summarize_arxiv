{
  "article_text": [
    "in statistical mechanics , the _ cluster variational method _ ( cvm ) , originally proposed by kikuchi in 1951  @xcite , is a well - established technique , which provides a systematic way to improve the accuracy of the simplest mean - field approximation .",
    "the classical scope of application is that of equilibrium thermodynamics of lattice models with discrete degrees of freedom , such as ising or potts  @xcite . the basic idea is to cut off correlations among site variables beyond the range of certain _ maximal clusters _",
    "( for instance , square `` plaquettes '' on a square lattice ) , so that the level of accuracy can be somehow `` tailored '' by means of a suitable choice of such clusters .",
    "the output of the calculation is the set of marginals of the boltzmann distribution over the maximal clusters . in particular , choosing single sites or nearest - neighbor pairs as maximal clusters , the cvm recovers , respectively , the ordinary mean - field ( bragg - williams ) approximation and the bethe - peierls approximation  @xcite .",
    "more generally , one can show that a number of generalized mean - field approximations , originally developed by heuristic arguments , can be incorporated into the cvm framework  @xcite .",
    "let us also mention the fact that the method has gained a renewed interest in recent years , because of the formal analogy between equilibrium statistical mechanics and a number of inference problems of high technological relevance ( error - correction decoding , pattern recognition , etc . ) , which ultimately require computing marginals of the boltzmann distribution for ( heterogeneous ) statistical - mechanical models defined on ( very large ) graphs  @xcite .    in the complementary field of non - equilibrium statistical mechanics ,",
    "a rigorous foundation from first principles is still lacking , so that a considerable part of research work is devoted to model systems in which the ( stochastic ) dynamics is assumed to be known , and properly defined to describe some kind of phenomena .",
    "this class of models includes , for instance , epidemic - spreading models  @xcite , kinetic ising or ising - like models  @xcite ( including models of neural - network dynamics )  @xcite , models of opinion formation and social dynamics ( voter model and its numerous variants )  @xcite , transport models ( exclusion processes )  @xcite and so on .",
    "increasing research efforts have also been oriented to investigating the aforementioned dynamics on complex networks , with special attention to the role played by the latter  @xcite .",
    "most of the stochastic processes involved in these models are of the markovian ( i.e. , memoryless ) type , fully characterized by a matrix of transition probabilities ( stochastic matrix ) .",
    "the problem can be generally rephrased in a variational form through a _ thermodynamic formalism _ , fully analogous to that of equilibrium statistical mechanics , where the transition probabilities play the role of interactions , and , within this formalism",
    ", one can develop mean - field - like approximation strategies along the lines of the cluster variational method .",
    "such a `` dynamical analog '' of the cvm was indeed put forward in the 1960s by kikuchi himself  @xcite , who named it _ path probability method _ ( ppm ) .",
    "the latter method has not become so popular as its equilibrium counterpart , so that in fact most mean - field - like approaches to stochastic dynamics are still recently conceived on the basis of traditional heuristic reasoning , without resorting to the cluster - variational machinery  @xcite .    at odds with the cited works ,",
    "a path - probability approach has been recently followed by one of the authors  @xcite , to develop a new type of approximation which , due to the peculiar `` shape '' of the maximal clusters , has been called the _ diamond approximation_. the latter has been applied to kinetic ising models ( with glauber dynamics , and either symmetric or asymmetric couplings ) , but it can be straightforwardly used for other markov - chain models as well , provided the transition matrix has a suitable factorized form , namely that ( the probability of ) the next - time configuration of each site variable depends only on the current - time configuration of its neighbors .",
    "the method has been the subject of a detailed testing work by an independent group  @xcite , still on various types of kinetic ising - like models , demonstrating a remarkable accuracy for both the transient and the steady state , with just a slight breakdown in the notoriously difficult case of spin glasses at low temperature .",
    "let us stress the fact that the derivation of the diamond approximation in reference  @xcite introduces a novelty item with respect to a `` standard '' ppm approach  @xcite , in that it removes an unnecessary constraint in the choice of maximal clusters , potentially opening the way to new approximation schemes .    in this paper",
    "we analyze different alternative approximations that can be worked out in the framework of a path - probability approach along the lines of reference  @xcite .",
    "this analysis leads in particular to generalizing the diamond approximation in such a way that the transition probability of a given site variable may also depend on the current configuration of the site itself .",
    "this step forward is necessary for the method to be applicable to models with this feature , such as , for instance , epidemic models or the like . we also trace a number of connections with different approximation schemes , previously derived either by the conventional `` heuristic '' approach or by the `` standard '' ppm approach . in the second part of the paper ,",
    "we evaluate the performance of these different approximations in terms of both accuracy and computational complexity , with respect to monte carlo simulations . as a test model",
    ", we consider a susceptible - infected - susceptible ( sis ) epidemic model on large random graphs , possibly with heterogeneous infection parameters .",
    "it turns out that the generalized diamond approximation outperforms simpler , previously known approximation schemes , with only a slight increase in the computational complexity .",
    "let us note that our investigation is carried out under the assumption of a discrete - time dynamics , but all the approximations can be applied as well to describe continuous - time processes .",
    "concerning this issue , we prove in particular that the ( generalized ) diamond approximation actually degenerates , in the continuous - time limit , into a simpler ( pairwise ) approximation . from the technical point of view",
    ", the latter result entails that , even though it is still possible to get a more accurate approximation for continuous - time models , one necessarily has to resort to even larger maximal clusters , which of course requires a larger computational effort .",
    "the paper is organized as follows .",
    "section  [ sec : cluster - variational_approach ] contains the main theoretical issues .",
    "sub  [ subsec : the_reference_model ] defines the most general model we can deal with , which we denote as the _ reference model_. in sub  [ subsec : thermodynamic_formalism ] we introduce the thermodynamic formalism and the basic concepts of the cluster variational method . in sub  [ subsec : specific_approximations ] we describe the specific approximations which are the subject of the present paper , in particular the one which generalizes the diamond approximation .",
    "most analytical details , along with a scheme of the resulting computation procedures , are reported in appendices [ app : details ] ( generalized diamond approximation ) and [ app : other_approximations ] ( other approximations ) .",
    "appendix  [ app : continuous_time ] deals with the special case of continuous - time processes , mentioned above .",
    "section  [ sec : test_models ] describes the numerical tests , whereas section  [ sec : conclusions ] contains a summary of the results and some concluding remarks .",
    "as mentioned above , we consider quite a generic model , made up of discrete random variables @xmath0 , associated with the vertices ( or _ sites _ ) @xmath1 of a given undirected graph , and depending on a discrete time index @xmath2 , where @xmath3 may possibly tend to infinity .",
    "this collection of random variables may be regarded as a multivariate stochastic process @xmath4 $ ] , whereas a particular realization of such a process @xmath5 may be denoted as a _",
    "path_. accordingly , we define the _ path probability _ as the probability of each given path , namely @xmath6 in the assumption of a markovian dynamics , the path probability takes the general form @xmath7 where @xmath8 is the initial condition ( i.e. , the probability of the initial configuration @xmath9 ) and @xmath10 are the transition probabilities from @xmath11 to @xmath12 ( i.e. , the conditional probability of the latter configuration at time @xmath13 , given the former at time @xmath14 ) .",
    "the graph structure defines which variables in the `` current - time '' configuration are actually relevant to determine the `` next - time '' configuration , and therefore the structure of the transition probabilities . in many physical models , such as those mentioned in the introduction ,",
    "the next - time configuration of each given site depends only on the current - time configuration of its neighbors and also possibly of the same site . in formulae",
    ", this statement means that the transition probabilities can be written in the following factorized form @xmath15 where the product runs over all sites , @xmath16 and @xmath17 ( respectively , @xmath18 and @xmath19 ) denote two generic configurations of the whole graph ( respectively , of the @xmath20 site ) and a next - time configuration by a letter @xmath17 . ] , and @xmath21 is a shorthand for a list of configuration variables @xmath22 ( i.e. , those associated with the @xmath20 site and its neighbors ) .",
    "we shall also assume that the initial configurations of different sites are statistically independent , namely that @xmath23 the latter assumption could also be partially relaxed , but usually there is no specific interest in doing so .",
    "let us now consider the following variational functional @xmath24 =    \\sum_{x^{(0)}\\!,\\dots , x^{(\\tau ) } }    { \\wp}\\,(x^{(0)}\\!,\\dots , x^{(\\tau ) } )    \\ln \\frac {    { \\wp}\\,(x^{(0)}\\!,\\dots , x^{(\\tau ) } )    } {    { p}^{(0)}(x^{(0 ) } )    \\prod_{t=0}^{\\tau-1 } { w}^{(t)}(x^{(t+1)}|\\,x^{(t ) } )    }    \\ , , \\ ] ] where the sum runs over all possible paths , the path probability @xmath25 is regarded as a variational parameter , and the initial distribution @xmath26 and the transition probabilities @xmath27 are assumed to be `` input parameters '' , incorporating our knowledge of the stochastic dynamics . from the mathematical point of view ,",
    "this functional is a so - called _ kullback - leibler divergence _ between the two sides of equation , and is known to have an absolute minimum ( zero ) where the two distributions are equal , that is when equation is verified . introducing the shannon information entropy associated with the path probability , namely @xmath28 = -    \\sum_{x^{(0)}\\!,\\dots , x^{(\\tau ) } }    { \\wp}\\,(x^{(0)}\\!,\\dots , x^{(\\tau ) } )    \\ln    { \\wp}\\,(x^{(0)}\\!,\\dots , x^{(\\tau ) } )    \\ , , \\ ] ] we can rewrite the variational functional as @xmath24 =    \\sum_{x^{(0)}\\!,\\dots , x^{(\\tau ) } }    \\wp\\,(x^{(0)}\\!,\\dots , x^{(\\tau ) } ) \\ ,    \\varepsilon\\,(x^{(0)}\\!,\\dots , x^{(\\tau ) }",
    ")    - \\mathcal{s}[{\\wp } ]    \\ , , \\label{eq : free_energy}\\ ] ] where we have also defined @xmath29 equation points out that the variational functional @xmath30 $ ] is analogous to a free energy for a system in which time plays the role of an extra dimension , and whose energy function @xmath31 is defined by .",
    "more precisely , such a system can be viewed as a `` stack '' of @xmath32 `` copies '' of the original graph , each one labeled by a time index @xmath33 , so that we shall denote it as a _ space - time thermodynamic system_. the path probability minimizing @xmath30 $ ] is analogous to a boltzmann distribution for the space - time thermodynamic system .",
    "up to this point , we have got just a reformulation of the problem , which is of no practical use in a fully general case .",
    "nevertheless , our assumptions and about , respectively , transition probabilities and initial conditions allow us to rewrite the energy function as @xmath34 the latter expression points out that ( the logarithm of ) the elementary factors of the transition probabilities and of the initial conditions play respectively the role of interaction energies and external fields , and that both kinds of term are _ local _ in both space and time . as a consequence , since the energetic term of the free energy is local , we expect that the ( inherently nonlocal ) entropic term could be effectively approximated by a truncation of its _ cumulant expansion _ , according to kikuchi s cluster - variational method  @xcite .",
    "each cumulant is associated to a given _ cluster _",
    "( i.e. , a given subset of lattice sites ) , so that different levels of approximation may be defined by the set of _ maximal clusters _ retained in the expansion .",
    "the approximate entropy can be finally recast into a linear combination of _ cluster entropies _ ,",
    "i.e. , information entropies of _ cluster distributions _ ( the latter being obviously defined as joint probability distributions for the random variables associated to all sites in the given cluster ) .",
    "thus , a generic cvm entropy takes the following form  @xcite @xmath35    = \\sum_{\\alpha \\in \\mathsf{r } } a_{\\alpha } \\mathcal{s}[{{\\wp}_{\\alpha } } ]    \\ , , \\label{eq : cvm - entropy}\\ ] ] where the sum runs over the set @xmath36 of all maximal clusters and their subclusters , @xmath37 denotes the cluster distribution for cluster @xmath38 ( i.e. , a particular marginal of @xmath25 ) , and @xmath39 $ ] is the corresponding information entropy .",
    "the coefficients @xmath40 of the combination , usually denoted as _ mbius numbers _",
    "@xcite , or _ ( over)counting numbers _",
    "@xcite , depend only on the graph geometry and the choice of maximal clusters .",
    "they can be determined by a simple sum rule , which can be stated as follows  @xcite @xmath41 where @xmath38 may be any maximal cluster or subcluster , and the sum runs over all ( maximal clusters or subclusters ) @xmath42 containing @xmath38 .",
    "the rule shows in particular that the coefficient of any maximal cluster is equal to @xmath43 , because in that case the sum contains only one term .",
    "let us finally note that the choice of maximal clusters is generally driven by physical intuition , since it defines the range of correlations that a given approximation will be able to take into account .",
    "therefore , in the framework of a space - time system like the one we are interested in , maximal clusters should necessarily extend over different time steps , in order to take into account time correlations .",
    "kikuchi s _ path probability method _ ( ppm ) can be regarded , in this framework , as a particular way of choosing the maximal clusters , namely , one first chooses maximal clusters for a one - time system , then every maximal cluster of the space - time system is the union of a maximal cluster at time @xmath44 with its translation at time @xmath13 . as already noticed in reference @xcite , different criteria for this choice are possible , and may be more convenient , depending on the structure of the transition probabilities . in the following",
    "we shall see on test models that indeed one can obtain a considerably better tradeoff between accuracy and computational complexity , with respect to the conventional ppm choice .      in this section",
    "we introduce the specific approximations ( i.e. , the different choices of maximal clusters ) , whose performance is analyzed in the following .",
    "first of all , let us define precisely the types of clusters ( either maximal or not ) that appear in at least one of the cvm entropies considered . looking at table  [ tab : clusters ] we see that each cluster extends over either a single timestep or two consecutive ones . of course , since we assume that the graph does not change with time , clusters at different timesteps are simply translations of one another .",
    "we introduce specific symbols ( letters ) to denote the different cluster types and the related probability distributions ; such symbols are defined in table  [ tab : clusters ] as well .    .the 1st column displays cluster type identifiers . the 2nd and 3rd columns report lists of sites that belong to each cluster at timesteps @xmath44 and @xmath13 , respectively ( as usual @xmath45 denotes all the nearest neighbors of @xmath20 , whereas @xmath46 denote a nearest neighbor pair ) . the 4th column displays the definition of the probability distribution function ( pdf ) of each cluster .",
    "of course @xmath47 is a shorthand for @xmath48 , whereas @xmath49 is a shorthand for @xmath50 ( and the same for @xmath13 ) .",
    "analogous shorthands are used for the `` dummy '' variables @xmath16 and @xmath17 . [ cols=\"^,<,<,<,^,<\",options=\"header \" , ]     making use of the sum rule , one can determine the mbius numbers , and therefore the approximate entropy functional , for each specific approximation .",
    "this is a rather standard calculation , whose results are summarized in table  [ tab : superposition_coefficients ] .",
    "note that , as previously mentioned , all ( though not only ) the mbius numbers associated to the maximal clusters are equal to unity . note also that , in the m approximation , p , q , and r clusters are not maximal , so their mbius numbers do not need to be ( and in fact they are not ) equal to unity . in the remainder of this section we report the entropy functionals in formulae .",
    "as far as the p approximation is concerned , we have @xmath51    = \\sum_{t=0}^{\\tau-1 }    \\left\\ {    \\sum_{i } \\mathcal{s}[{p_{i}}^{(t ) } ]    - \\sum_{ij } \\mathcal{s}[{z_{ij}}^{(t ) } ]    \\right\\ }    - \\sum_{t=1}^{\\tau-1 }    \\sum_{i } \\mathcal{s}[{a_{i}}^{(t ) } ]    \\ , , \\ ] ] where @xmath52 and @xmath53 denote sums over all sites and over all nearest neighbor pairs , respectively , and @xmath54}$ ] denotes the shannon entropy of each given probability distribution .",
    "the arguments @xmath55 mean that the functional @xmath56 depend on all p- , z- , and a - type cluster distributions , i.e. , @xmath57 is a shorthand for @xmath58 , and so on . with analogous notations",
    ", the pq entropy approximation reads @xmath59    & = \\sum_{t=0}^{\\tau-1 }    \\left\\ {    \\sum_{i } \\mathcal{s}[{p_{i}}^{(t ) } ]    + \\sum_{ij } \\mathcal{s}[{q_{ij}}^{(t ) } ]    - \\sum_{i , j \\in \\partial i } \\mathcal{s}[{t_{i , ij}}^{(t ) } ]    \\right\\ }    + \\nonumber \\\\ &    - \\sum_{t=1}^{\\tau-1 }    \\left\\ {    \\sum_{ij } \\mathcal{s}[{z_{ij}}^{(t ) } ]    - \\sum_{i } ( d_{i}-1 ) \\mathcal{s}[{a_{i}}^{(t ) } ]    \\right\\ }    \\ , , \\end{aligned}\\ ] ] where @xmath60 denotes a double sum over all sites and over all neighbors of each given site .",
    "furthermore , the pqr entropy reads @xmath61",
    "= \\sum_{t=0}^{\\tau-1 }    \\left\\ {    \\sum_{i }    \\left [    \\mathcal{s}[{p_{i}}^{(t ) } ]    + \\mathcal{s}[{r_{i}}^{(t ) } ]    + ( d_{i}-1 ) \\mathcal{s}[{v_{i}}^{(t ) } ]    \\right ]    + \\right .",
    "\\nonumber \\\\ & \\left .",
    "+ \\sum_{ij } \\mathcal{s}[{q_{ij}}^{(t ) } ]    - \\sum_{i , j \\in \\partial i }    \\left [    \\mathcal{s}[{t_{i , ij}}^{(t ) } ]    + \\mathcal{s}[{u_{ij , i}}^{(t ) } ]    \\right ]    \\right\\ }    - \\sum_{t=1}^{\\tau-1 }    \\left\\ {    \\sum_{i } \\mathcal{s}[{s_{i}}^{(t ) } ]    - \\sum_{ij } \\mathcal{s}[{z_{ij}}^{(t ) } ]    \\right\\ }    \\ , , \\label{eq : entropia - pqr}\\end{aligned}\\ ] ] whereas the m entropy reads @xmath62",
    "= \\sum_{t=0}^{\\tau-1 }    \\left\\ {    \\sum_{i } \\mathcal{s}[{m_{i}}^{(t ) } ]    - \\sum_{ij } \\mathcal{s}[{q_{ij}}^{(t ) } ]    \\right\\ }    - \\sum_{t=1}^{\\tau-1 }    \\left\\ {    \\sum_{i } \\mathcal{s}[{s_{i}}^{(t ) } ]    - \\sum_{ij } \\mathcal{s}[{z_{ij}}^{(t ) } ]    \\right\\ }    \\ , .\\ ] ] for each approximation , the free - energy functional is obtained from equation by replacing the entropic term @xmath63 with one of the approximate entropies .",
    "as previously mentioned , the energetic term does not require any further approximation , because the maximal clusters are properly chosen to `` contain '' the elementary coupling terms of the energy function .",
    "the minimization of the resulting functionals is far from being a straightforward problem .",
    "this is ultimately due to cluster overlapping , which entails that compatibility constraints between cluster distributions must be satisfied . in general",
    ", the constrained minimization problem for a generic cvm free energy can be solved iteratively by a message - passing procedure denoted as _ generalized belief propagation _",
    "@xcite ( which is not guaranteed to converge ) , or by more complex ( provably convergent ) methods  @xcite . nevertheless , the peculiar structure of the couplings , arising in a space - time system describing a markovian stochastic dynamics like that of our reference model , allows one to devise a much simpler procedure , which does not require iterative refinement , but only a `` natural '' sequence of iterations , starting from the initial conditions and following the ( probabilistic ) time evolution of the system .",
    "we report the details of such a procedure in appendix  [ app : details ] , only for the pqr approximation .",
    "the differences occurring in the other approximations ( which are indeed very much analogous ) are discussed in appendix  [ app : other_approximations ] .",
    "furthermore , analogous procedures can be used to investigate continuous - time processes ( in a discretized form ) , and , as mentioned in the introduction , in such a case one can argue that the pqr and pq approximations become equivalent .",
    "the latter issues are discussed in appendix  [ app : continuous_time ] .      before switching to a performance evaluation of the different approximations described above",
    ", we find it worth summarizing a number of connections with previous works , which emerge from our analysis .",
    "as mentioned in the introduction , in most cases equivalent approximations have been put forward without resorting to a variational scheme , but just on the basis of heuristic reasoning , and/or for specific model dynamics . in such cases , our approach retains some interest in that it offers a more general and unified view of the matter .",
    "first of all , it is possible to recognize that the p and pq schemes turn out to be respectively equivalent to the classical ( non - variational ) _ mean - field _ and _ pairwise _ approximations , which have been used , for instance , to investigate epidemic spreading phenomena on networks  @xcite .",
    "in such a context , the p approximation is customarily denoted as _ quenched mean field _",
    ", in order to distinguish it from a naive mean - field approach , in which the infection probability is assumed to be a node - independent quantity  @xcite , and from the popular _ heterogeneous mean - field approach _ by pastor - satorras and vespignani  @xcite , in which nodes are distinguished only on the basis of their degree .",
    "for epidemics on networks that are expected to be inherently homogeneous , such as random - regular graphs or regular lattices , the same approximations have been considered also by petermann and de los rios  @xcite , and other authors  @xcite .",
    "we point out these equivalences in appendix  [ subsec : pqandp ] along with some details about the respective iterative procedures .",
    "secondly , the m approximation turns out to be an instance of kikuchi s ( variational ) path - probability method , as we have mentioned in the previous subsection , but it has also been derived independently ( for the case of homogeneous epidemics ) again by petermann and de los rios  @xcite , who denoted it as _",
    "star approximation_. the latter equivalence is detailed in appendix  [ subsec : m ] .",
    "furthermore , let us note that , in the special case of a spatially one - dimensional system ( i.e. , when the graph is a linear chain ) , a recent analysis of nonlinear voter models carried out by schweitzer and behera  @xcite makes use of two different approximation schemes ( denoted as _ triplet _ and _ quintuplet _ approximations ) , which turn out to be special cases of the pq and m approximations , respectively .",
    "another special case of our reference model , which nonetheless includes several models of physical relevance ( such as the kinetic ising model , or the ordinary voter model ) , is that in which the elementary transition probability for a given site @xmath20 ( namely , @xmath64 ) does not depend on the current - time configuration of the site itself @xmath18 ( so that we can denote it as @xmath65 ) . in other words , the next - time configuration of each site",
    "is conditioned only by the current - time configurations of its neighbors .",
    "for this reason , we shall denote this case as a purely _ neighbor - conditioned _ dynamics . as mentioned in the introduction , the _ star _ and _ diamond _ approximations of reference  @xcite",
    "refer to this kind of dynamics .",
    "actually , it turns out that , for a generic purely - neighbor - conditioned dynamics , the pq and p approximations degenerate into each other , and both coincide with the star approximation of reference  @xcite .",
    "similarly , the m and pqr approximations degenerate into each other , and coincide with the diamond approximation .",
    "all these connections are detailed in appendices [ subsec : diamond ] and  [ app : other_approximations ] . as a further consequence",
    ", we can state that in this case the diamond approximation is itself an instance of kikuchi s path probability method .",
    "in this section we test our approximations against monte carlo simulations on specific instances of a sis epidemic model on ( sparse ) graphs drawn from well known random ensembles , namely the erds - rnyi ensemble and the random - regular ensemble . in the former case , the degree distribution is poissonian , whereas in the latter case all vertices have the same degree , so that we also denote the two kinds of graphs as _",
    "poissonian _ and _ uniform _ , respectively .",
    "we consider a sis model with parallel dynamics , whose definition is as follows .",
    "each site variable @xmath0 can take two possible values , @xmath66 , meaning that the @xmath20 site is susceptible or infected , respectively .",
    "an infected site @xmath20 has a probability @xmath67 to recover ( i.e. , to become susceptible ) at the next timestep .",
    "moreover , a susceptible site @xmath20 has a probability @xmath68 to become infected because of any of its neighbors @xmath69 , if the latter is infected at the current timestep , and @xmath70 otherwise . in other words , the probability of an infection event from @xmath69 to @xmath20 is @xmath71 .",
    "since infection events by different neighbors are not mutually exclusive , the _ total probability _ of a given site @xmath20 to become infected can be more easily computed via its complementary probability ( i.e. , the probability that @xmath20 remains susceptible ) , which is equal to the probability that none of the neighbors transmits the contagion .",
    "assuming independence among different infection events , the transition probability to a susceptible state can be finally written as @xmath72 whereas , by normalization , the transition probability to an infected state will be @xmath73    we consider two fixed graphs with @xmath74 vertices , a poissonian one with average degree @xmath75 and a uniform one with degree @xmath75 .",
    "as far as model parameters are concerned , in both cases we choose a uniform recovery probability , namely @xmath76 , whereas the infection probability is chosen to be homogeneous in the former case ( namely , @xmath77 ) and heterogeneous in the latter ( namely , @xmath68 drawn at random with uniform distribution between @xmath70 and @xmath78 ) .",
    "note that , as a result , both systems turn out to be heterogeneous : in the erds - rnyi system , heterogeneity arises from the random graph structure , whereas , in the random - regular system , heterogeneity arises from the randomness of infection probabilities .",
    "the initial conditions are chosen in such a way that both systems have on average 1% of infected sites , but with a slight difference . in the poissonian case ,",
    "we use `` quenched '' initial conditions , that is , 1% of ( randomly drawn ) sites are assigned the initial distribution @xmath79 whereas the remaining 99% are assigned the distribution @xmath80 in the uniform case we use `` annealed '' initial conditions , that is , all sites are assigned the distribution @xmath81 in the simulation , quenched conditions correspond to all histories initialized with exactly the same configuration ( with 1% of infected sites ) drawn at random at the beginning , whereas annealed conditions correspond to a different initial configuration ( still with 1% of infected sites ) drawn at random for each history .",
    "note that there is no specific reason for associating a particular type of initial condition to a particular type of graph .",
    "we simply observe that different initial conditions give rise to a slightly different ( probabilistic ) short - time behavior of the system , appearing independently of the graph type , and we are meant to analyze whether such a behavior is more or less accurately reproduced by the approximations .    for each approximation , each graph and parameters choice , and each site @xmath1 , we can compute the probability of the infected state ( infection probability ) as a function of time @xmath82 . in the simulations ,",
    "the same quantity @xmath83 is evaluated as an average over @xmath84 histories .",
    "the steady - state is easily identified in the approximations , since we observe that , as @xmath44 increases , @xmath82 tends to a well - defined plateau value @xmath85 .",
    "conversely , in the simulations @xmath83 exhibits a fluctuating behavior for large @xmath44 , so we compute the steady - state value @xmath86 as an average over @xmath87 timesteps .",
    "we then compute the relative errors between theory and simulation ( in the steady state ) as @xmath88 .",
    "we display all these data in figure  [ fig : ss ] , for each approximation , as a function of the corresponding data for the pqr approximation .",
    "note that , as a consequence , pqr data fall on a straight line .",
    "more importantly , this way of showing data allows us to argue at a glance that the m approximation is _ systematically _",
    "( i.e. , for all sites ) better than the pqr approximation , which is in turn systematically better than pq .",
    "let us also observe that , in the poissonian graph case ( left panel ) , the pq and p data are so separated that also pq clearly turns out to be systematically better than p. for the uniform graph case ( right panel ) , the boundary between the two data `` clusters '' appears a little more fuzzy , so that one might suspect that , at least for some sites , the p approximation could give a better approximation than pq",
    ". nevertheless , plotting as a function of the pq data ( right panel inset ) shows that this is not the case , i.e. , that pq is still _ systematically _",
    "better than p. from figure  [ fig : ss ] , one can also assess that the accuracy improvements that one can obtain by `` upgrading '' the approximation level from p , to pq , to pqr are , in relative terms , of the same order of magnitude , whereas a further upgrade to the m approximation achieves a minor improvement .    in order to assess also the transient behavior , we display in figure  [ fig : wc ] the whole time evolution of the infection probability @xmath82 for a specific site @xmath20 . in particular , we choose the site @xmath20 for which the pqr approximation gives the largest relative error ( worst case ) in the steady state .",
    "we can observe that the systematic accuracy improvement , already noticed for the steady state , also takes place in the short - time evolution .",
    "such a behavior is indeed common for all sites .",
    "we also note that the pqr and m results are almost indistinguishable at this scale , whereas they provide a noticeable improvement over the pq ( pair ) approximation .",
    "moreover , we can observe that , in the case of quenched initial conditions ( left panel ) , the infection probability remains sharply zero up to a given timestep ( the @xmath20 site being one of those initially susceptible ) .",
    "in such a case , even the simplest p approximation ( mean field ) correctly reproduces the very short time behavior ( including the precise timestep at which the @xmath20 site first exhibits a nonzero infection probability ) , but otherwise it rapidly deviates from the trend predicted by the simulations .",
    "one more test case we consider is that of a uniform graph ( still with @xmath89 ) , with homogeneous recovery probability ( @xmath90 ) and , as well , homogeneous infection probability ( @xmath91 ) .",
    "initial conditions are chosen to be of the annealed type ( as defined above ) .",
    "in such a system we expect a fully homogeneous infection probability ( i.e. , @xmath92 for all @xmath20 ) , so that in the simulation we can evaluate the latter by an extra average over the sites , thus obtaining much less noisy results . in order to enhance the `` noise - reduction '' effect , we also choose a larger graph size , namely @xmath93 .",
    "we display the results in figure  [ fig : uu ] for the specific cases @xmath94 and @xmath95 . in the former case ( left panel )",
    ", we can observe that almost all the approximations ( except possibly p ) give a rather accurate prediction of the steady - state infection probability .",
    "this may be partially ascribed to the fact that in this setting the steady state is expected to be an equilibrium state , at odds with the previously considered cases .",
    "it is remarkable that , even though the m , pqr , and pq approximations are all very accurate in the steady state , the pq approximation shows quite a relevant discrepancy during the transient .",
    "furthermore , upon decreasing @xmath42 ( right panel ) one can observe that the various approximations exhibit increasingly different results also in the steady state .",
    "this is related to the fact that the model approaches its critical point , at which the active ( endemic ) steady state disappears , and the long - time infection probability becomes rigorously zero . in analogy with equilibrium phase transitions ,",
    "different approximations give different predictions for the critical @xmath42 value , as already pointed out in the continuous - time case  @xcite .",
    "let us finally compare the different approximations in terms of computational complexity . in figure",
    "[ fig : tempi ] ( left panel ) we display the cpu time ( intel core  2 duo ) needed to perform @xmath96 evolution timesteps of a uniform graph with @xmath97 vertices , as a function of the ( fixed ) degree @xmath98 .",
    "of course , greater accuracy corresponds to larger computational effort , though not with a simple proportionality . in particular , we note that the m approximation entails a very large increase of the complexity , in spite of the fact that its accuracy is just slightly better than that of pqr ( at least for the specific epidemic model considered here ) .",
    "the scaling behavior with respect to @xmath99 is obviously linear , so that we do not need to report detailed results , whereas it turns out to be exponential with respect to @xmath98 . in principle",
    ", the complexity scales with the number of configurations of the largest cluster retained in the cvm expansion , so that the p , pq and pqr approximations are all exponential in @xmath98 , whereas the m approximation is exponential in @xmath100 . from the theoretical point of view of computational complexity , this is an irrelevant difference , but from the practical point of view this means that the computational cost of the m approximation may rapidly become similar to that of a simulation , upon increasing the degree , as shown in figure  [ fig : tempi ] . on the other hand , the p , pq and pqr approximations present an extra computational advantage , which can be stated as follows . if the transition probabilities can be written as a product of terms depending each on a single neighbor ( or , as well , as a sum of a few terms of this kind ) , simple dynamic programming precautions allow one to reduce the complexity scaling to be linear in the degree",
    ". details about this issue are beyond the scope of the current paper , but we only mention the fact that the transition probabilities of the sis model satisfy the above prescription .",
    "execution times of the optimized programs are reported in the right panel of figure  [ fig : tempi ] .",
    "in this paper we have performed a detailed investigation of different types of mean - field - like approximations for stochastic dynamics on graphs , within the unifying framework of a cluster - variational approach . in analogy with its equilibrium counterpart",
    ", this approach naturally opens the way to improving the approximation , by a suitable choice of the maximal clusters , which basically define the range of correlations that a given approximation scheme is able to take into account . on the one hand , we have pointed out that the simplest choices of maximal clusters ( namely , the p and pq approximations , according to our nomenclature ) coincide respectively with the ordinary mean - field and the pairwise approximations , previously derived in different contexts without resorting to a variational scheme . on the other hand ,",
    "we have proposed a slightly more complex cluster choice ( pqr in our nomenclature ) , which provides a generalization of the so - called diamond approximation , to dynamics that are _ not _ purely neighbor - conditioned ( i.e. , such that the transition probability of a given site variable may also depend on the current configuration of the site itself ) . furthermore , we have considered an even larger cluster choice ( m in our nomenclature ) , which turns out to be an instance of kikuchi s path - probability method .",
    "we have shown explicitly that , in the case of a purely neighbor - conditioned dynamics , the p ( mean - field ) and pq ( pairwise ) approximations become equivalent , and similarly the m approximation ( path - probability method ) degenerates into the pqr ( generalized diamond ) approximation .",
    "we have tested the different approximations on a ( discrete - time ) epidemic model of the sis type ( i.e. , with recurrent dynamics ) on random graphs , possibly with heterogeneous infection parameters .",
    "we have compared the results with monte carlo simulations , and demonstrated that increasing the maximal cluster size leads to a systematic improvement of the level of accuracy .",
    "such an improvement can obviously be obtained at the cost of a higher computational complexity , but not with a simple proportionality . in particular , the pqr approximation yields nearly the same accuracy as the m approximation , with a considerably lower complexity . we have also confirmed that the pqr approximation yields very good accuracy even in the transient regime , as previously reported for the diamond approximation in the case of kinetic ising models  @xcite .",
    "let us observe that our choice of a discrete - time dynamics is a bit artificial , as continuous time is the most typical setting of epidemic models ( even though with some exceptions  @xcite ) . in our comparative analysis , this choice is meant to point out the difference between the pqr and pq approximations , which we indeed prove to become equivalent in the continuous - time limit .",
    "let us finally mention an important alternative class of approximate methods for the same kind of problems , which go under the name of _ dynamic message - passing _",
    "( dmp ) or the like . basically , these methods rely on the so - called _ dynamic cavity _ equations  @xcite , which are exact on tree graphs ( and therefore likely accurate on treelike graphs ) , but require taking into account the whole time evolution of each given site variable",
    ". different approximations over the time dimension can then be worked out to make the problem computationally tractable .",
    "such alternative approximations include for instance the early `` dynamic cavity '' approximation by aurell and mahmoudi  @xcite , the _ markovian closure _ scheme by del ferraro and aurell  @xcite , and the very refined ( and computationally demanding ) matrix - product algorithm by barthel and coworkers  @xcite . an analogous ( but apparently different )",
    "dmp approach , directly formulated for the continuous - time sis model , has also been put forward recently  @xcite .",
    "interestingly , the latter method has been reported to perform slightly better than the pairwise ( pq ) approximation , but mainly in the stationary state , whereas it seems to be generally less accurate in transient states .",
    "on the other hand , the aforementioned markovian - closure scheme  @xcite ( which can in principle be applied to any kind of dynamics falling within our reference model ) has been thoroughly tested  @xcite on various ( glauber ) kinetic ising models , and reported to perform ( slightly but quite systematically ) worse than the diamond ( pqr ) approximation .",
    "note that , as in this case the dynamics is purely neighbor - conditioned , the pair approximation is no longer a good term of comparison , because it degenerates into the ordinary mean field , as we show in appendix  [ subsec : pqandp ] .",
    "we have not included in our paper a detailed comparative analysis with respect to dynamic - message - passing approaches , because , as previously mentioned , the main focus of our work is on the unifying framework of the cluster variational method .",
    "nevertheless , such an investigation might be in fact worth being performed , so that we shall consider it as a subject for future work .",
    "in this appendix we report in detail the method we have used to determine the minimum of the cluster - variational functional for the case of the pqr approximation .",
    "as we shall see , this method naturally leads to an `` iterative '' procedure ( the one we have implemented numerically ) , which , starting from the initial conditions , builds up the cluster distributions at subsequent timesteps , up to the eventual steady state .",
    "let us first discuss the issue of compatibility constraints , which will be of use in the following .",
    "the probability distributions for maximal clusters and subclusters ( which for the pqr approximations have been denoted as @xmath101 ) are of course not independent variational parameters , because they have to satisfy ( besides normalization ) a number of compatibility constraints . by _ compatibility _ we mean that the marginalization of probability distributions of overlapping maximal clusters must give , for the same subcluster , the same distribution . writing down these conditions for all subclusters of all maximal clusters , we obtain a sufficient ( indeed redundant ) set of constraint equations .",
    "let us group together these equations depending on the type of maximal cluster involved .",
    "we understand that all the equations must hold for @xmath102 .",
    "p - type maximal clusters :    [ eq : vinc - p ] @xmath103    q - type maximal clusters :    [ eq : vinc - q ] @xmath104    r - type maximal clusters :    [ eq : vinc - r ] @xmath105    this set of conditions also entails direct compatibility equations between subcluster distributions ( for overlapping subclusters ) .",
    "let us write explicitly some of these equations below .    from equations and , or equivalently and",
    ", we have @xmath106    from equations and , or equivalently and , we have @xmath107    from equations and , or equivalently and , we have @xmath108    from equations and , or equivalently and , we have @xmath109    from equations and , or equivalently and , we have @xmath110    let us finally remark that the largely redundant form , in which we have written the compatibility constraints , is not an end in itself . indeed , it will enable us to get a very compact proof of the fact that our method actually produces compatible solutions .",
    "this will be shown , along with the computation algorithm , in section  [ subsec : algo ] .      as mentioned in section  [ subsec : specific_approximations ] , we derive the pqr free - energy functional ( denoted as @xmath111 ) from equation , replacing the entropic term @xmath63 with @xmath112 ( equation ) . taking into account that we are interested in solutions respecting the constraint equations , specifically , , , , , it is possible to rewrite the functional in such a way that the subcluster distributions appear only in the logarithmic terms , that is in the following form @xmath113    = \\nonumber \\\\ &    = \\sum_{t=0}^{\\tau-1 } \\sum_{i } \\sum_{y_{i},x_{i,\\partial i } } { p_{i}}^{(t)}(y_{i},x_{i,\\partial i } )    \\ln \\frac {    { p_{i}}^{(t)}(y_{i},x_{i,\\partial i } )    } {    { w_{i}}^{(t)}(y_{i}|x_{i,\\partial i } )    { s_{i}}^{(t)}(x_{i,\\partial i } )    }    \\ , + \\nonumber \\\\ &    + \\sum_{t=0}^{\\tau-1 } \\sum_{ij } \\sum_{y_{i , j},x_{i , j } } { q_{ij}}^{(t)}(y_{i , j},x_{i , j } )    \\ln \\frac {    { q_{ij}}^{(t)}(y_{i , j},x_{i , j } )    { z_{ij}}^{(t)}(x_{i , j } )    } {    { t_{i , ij}}^{(t)}(y_{i},x_{i , j } )    { t_{j , ij}}^{(t)}(y_{j},x_{i , j } )    }    \\ , + \\nonumber \\\\ &    + \\sum_{t=0}^{\\tau-1 } \\sum_{i } \\sum_{y_{i,\\partial i},x_{i } } { r_{i}}^{(t)}(y_{i,\\partial i},x_{i } )    \\ln \\frac {    { r_{i}}^{(t)}(y_{i,\\partial i},x_{i } )    { { v_{i}}^{(t)}(y_{i},x_{i})}^{d_{i}-1 }    } {    \\prod_{j \\in \\partial i }    { u_{ij , i}}^{(t)}(y_{i , j},x_{i } )    }    \\ , , \\label{eq : funz - pqr}\\end{aligned}\\ ] ] where the inner sums run over all possible configurations of p- , q- , and r - clusters , respectively . recall that the terms @xmath114 are transition probabilities , so that by construction we assume they satisfy the following normalization conditions @xmath115 note also that , given the mbius numbers of the pqr approximation ( see table [ tab : superposition_coefficients ] and equation ) , the probability distributions @xmath116",
    "( i.e. the s - cluster distributions at time @xmath117 ) and @xmath118 ( i.e. the z - cluster distributions at time @xmath117 ) actually do not belong to the entropic term .",
    "we have nonetheless included them in the free - energy expression , to take into account the part of energetic term that represents initial conditions , assuming therefore    [ eq : iniz - sz ] @xmath119    now , a crucial observation is that the variational functional in the form is made up of a sum of kullback - leibler divergence terms , and therefore that the absolute minimum conditions ( in which every term equals @xmath70 ) are , for @xmath120 ,    [ eq : algo - pqr ] @xmath121    actually , the minimum condition of a kullback - leibler divergence holds provided its two arguments ( that is in our case the two sides of each equation ) are `` good '' ( i.e. normalized ) probability distributions .",
    "assuming of course the normalization of all cluster distributions , it is easy to see that the right - hand sides of equations , and are actually good distributions , if , respectively , the normalization condition and the compatibility conditions and are verified",
    ".    let us finally observe that equations are somehow `` weak '' , meaning that they do not define a point in the space of variational parameters , but rather a manifold . in order to determine completely the variational parameters , that is the cluster distributions @xmath122",
    ", we have to intersect the aforementioned manifold with that defined by the constraints , that is to solve simultaneously the minimum equations with the compatibility equations , , ( whence also , , , , ) and the normalizations .",
    "let us stress the fact that it is not necessary to resort to the lagrange multiplier method to solve the contrained minimum problem , just because it turns out that the intersection between the two manifolds is nonempty .",
    "in general , the latter is not a necessary condition for the existence of a constrained minimum . in our specific problem",
    ", such a condition arises from the fact that the exponentials ( boltzmann factors ) of the coupling terms are actually ( transition ) probabilities , and therefore that they enjoy the normalization property .      in this section",
    "we present an iterative procedure , which solves the problem described above .",
    "in particular we see that , starting with a set of @xmath123 and @xmath124 distributions satisfying at a given timestep @xmath44 ( initially @xmath117 , with the distributions defined by ) , one can determine all the other distributions @xmath125 and @xmath126 at timestep @xmath44 , as well as @xmath123 and @xmath124 at timestep @xmath13 , satisfying all the required equations at time @xmath44 and at time @xmath127 . moreover , all the computed distributions turn out to be correctly normalized",
    ". the steps of the procedure are described in detail below , and summarized as a flow chart in figure  [ fig : flow - chart ] .",
    "( 176,50)(-3,-25 ) ( 0,-3)(8,6)@xmath128 ( 8,0)(1,0)15 ( 8,0)(15,5 ) ( 0,-11.5)(8,5)input    ( 23,-9)(9,18)@xmath129 ( 32,6)(1,0)21 ( 32,6)(12,5 ) ( 53,3)(8,6)@xmath130 ( 53,-9)(8,6)@xmath131 ( 53,-21)(8,6)@xmath132 ( 32,-6)(1,0)12 ( 44,-6)(1,-1)9 ( 32,-6)(12,5 ) ( 44,-18)(1,1)9 ( 8,-18)(1,0)36 ( 0,-21)(8,6)@xmath131 ( 61,6)(1,-1)6 ( 61,-6)(1,1)6 ( 67,0)(1,0)12 ( 67,0)(12,5 )    ( 79,-9)(9,18)@xmath133 ( 88,6)(1,0)21 ( 88,6)(12,5 ) ( 109,3)(8,6)@xmath134 ( 109,-9)(8,6)@xmath132 ( 109,-21)(11,6)@xmath135 ( 88,-6)(1,0)12 ( 100,-6)(1,-1)9 ( 88,-6)(12,5 ) ( 100,-18)(1,1)9 ( 61,-18)(1,0)39 ( 117,6)(1,-1)6 ( 117,-6)(1,1)6 ( 123,0)(1,0)12 ( 123,0)(12,5 )    ( 135,-9)(9,18)@xmath136 ( 144,0)(1,0)15 ( 144,0)(15,5 ) ( 159,-3)(11,6)@xmath137 ( 159,-21)(11,6)@xmath135 ( 120,-18)(1,0)39 ( 159,-11.5)(11,5)output    ( 8,13)(0,9 ) ( 8,17)(53,5)step 2 ( 61,13)(0,9 ) ( 61,17)(56,5)step 3 ( 117,13)(0,9 ) ( 117,17)(53,5)step 4 ( 170,13)(0,9 )    1 .",
    "let us begin , at a given timestep @xmath44 ( initially @xmath117 ) with a set of ( normalized ) s - cluster distributions @xmath138",
    "( @xmath139 ) and z - cluster distributions @xmath140 ( @xmath141 ) , that we assume to be compatible , i.e. satisfying equations ( which is obviously verified by the initial distributions ) .",
    "2 .   we determine the p - cluster distributions at time @xmath44 by means of equations .",
    "thanks to , we see that such distributions satisfy equations .",
    "moreover , since and hold simultaneously , also turns out to be satisfied .",
    "we then determine the following marginals . * t - cluster distributions @xmath142 ( @xmath143 ) by equations . since and hold simultaneously",
    ", such distributions also satisfy . * v - cluster distributions @xmath144 ( @xmath139 ) by equations . since and hold simultaneously , also turns out to be satisfied .",
    "3 .   we determine the q - cluster distributions at time @xmath44 by means of equations .",
    "thanks to , we see that such distributions satisfy equations and . moreover , since and hold simultaneously , also turns out to be satisfied .",
    "we then determine the following marginals .",
    "* u - cluster distributions @xmath145",
    "( @xmath143 ) by equations .",
    "since and hold simultaneously , such distributions also satisfy . *",
    "z - cluster distributions ( at the next timestep ) @xmath146 ( @xmath147 ) by equations . since and hold simultaneously , also turns out to be satisfied .",
    "4 .   we determine the r - cluster distributions at time @xmath44 by means of equations .",
    "thanks to , we see that such distributions satisfy equations and . moreover , since and hold simultaneously , also turns out to be satisfied .",
    "we then determine the following marginals . * s - cluster distributions ( at the next timestep )",
    "@xmath148 ( @xmath139 ) by equations .",
    "since and hold simultaneously , such distributions also satisfy at time @xmath13 . 5 .",
    "we repeat the procedure from step 2 for the distributions at time @xmath13 .",
    "let us stress the fact that , in the above procedure , all the compatibility conditions stated in section  [ subsec : comp ] have been either used explicitly to compute the marginals or proved to be satisfied by the computed distributions .      in this section we show that , as mentioned in section  [ subsec : related_works ] , in the case of a pure neighbor - conditioned dynamics the pqr approximation coincides with the diamond approximation , previously proposed by one of us in reference  @xcite .",
    "first of all it is useful to define some auxiliary clusters , namely , the b - clusters , made up of two neighbor sites at subsequent timesteps @xmath44 and @xmath13 , for @xmath120 , and the c - clusters , made up of all the neighbors of a given site at a given timestep @xmath44 , for @xmath149 .",
    "the related distributions are denoted as @xmath150 these distributions can be written as marginals of maximal cluster distributions , so that they inherit all the required compatibility conditions .",
    "we shall use in particular the following relationship @xmath151 which , together with @xmath152 also imply @xmath153    let us now hypothesize that the s- and z - cluster distributions at a given timestep @xmath44 factor in the following fashion    [ eq : fatt - ipo ] @xmath154    obviously assuming also that c- and a - distributions are compatible , that is they satisfy @xmath155 retracing the steps of the algorithm described in the previous section , let us show that the hypothesized factorizations are stable along the time evolution ( i.e. , our hypotheses imply the same factorizations at timestep @xmath127 ) , and the evolution equations are identical to those of reference  @xcite .    1 .",
    "we easily see that the hypotheses and satisfy the compatibility between s- and z - distributions at time @xmath44 .",
    "2 .   equation with the factorization reads @xmath156 therefore , equation together with gives @xmath157 where @xmath158 whereas equation together with gives @xmath159 where @xmath160 3 .   equation with the factorizations and reads @xmath161 therefore , equation together with gives @xmath162 whereas equation together with gives @xmath163 we thus argue that the z - distributions at time @xmath13 take a factorized form analogous to .",
    "equation with the factorizations and reads @xmath164 therefore , equation proves that the s - distributions at time @xmath13 take a factorized form analogous to , namely @xmath165 where @xmath166    note that the `` diamond clusters '' of reference  @xcite never appear explicitly in the above discussion .",
    "nevertheless , we can see that , plugging equation into and , one obtains evolution equations for b- and a - cluster distributions , which exactly coincide with those one could obtain , in reference @xcite , replacing the diamond cluster distribution ( 26 ) into the marginalization equations ( 25 ) and ( 23 ) .",
    "in this appendix we discuss the other approximations we have introduced in the text , namely the pq and p approximations , and the m approximation .",
    "we do not go into the same level of detail , as done for the pqr approximation , because the derivations are in fact very much analogous .",
    "we only give the final results in terms of the respective computation procedures .",
    "the pq approximation can be regarded as a simplification of the pqr approximation , in which the s - cluster distributions are factorized in terms of z - cluster ( nearest - neighbor pair ) and a - cluster ( single site ) distributions , according to @xmath167 as a consequence , one can replace step  4 of the pqr procedure with the previous equation ( evaluated at timestep @xmath13 ) , where the z - cluster distributions have been determined at step  3 , and the a - cluster distributions , compatible with the former , i.e. satisfying @xmath168 can be written by the obvious marginalization . in conclusion ,",
    "as previously mentioned , the pq approximation turns out to be equivalent to the pairwise approximation , considered by different authors  @xcite .",
    "such an equivalence might indeed be not fully evident , because in the cited papers the approximations are immediately specialized to a particular model ( namely , the sis model ) and to the continuous - time limit , whereas our treatment is more general , at least under the assumptions of a discrete - time dynamics and a transition probability factorized according to .",
    "the p approximation can be regarded as a further simplification , in which also the pair distributions are factorized , as in equation , so that the s - cluster distributions read @xmath169 as a consequence , one can skip also step  3 of the pqr procedure , because there is no need to compute pair distributions at the next timestep , to be able to close the equations .",
    "indeed , replacing equation into and then into , one obtains a unique time - evolution equation for the single - site distributions , namely @xmath170 which coincides with the ( quenched ) mean - field approximation  @xcite .",
    "this argument also proves that , for a pure neighbor - conditioned dynamics , for which holds , the pq approximation degenerates into the p approximation , and therefore that both coincide with the _ star _ approximation of reference  @xcite , as previously stated in section  [ subsec : related_works ] .",
    "the iterative procedure for the m approximation turns out to coincide with that of the pqr approximation until step  3 .",
    "step  4 is modified in that the r - cluster distributions are no longer computed by equation , but rather as marginals of the m - cluster distributions , namely @xmath171 the latter being previously computed as @xmath172    in the simpler case of a pure neighbor - conditioned dynamics , we have shown for the pqr approximation that the factorizations , , and hold .",
    "these equations remain valid also for the m approximation , because they stay within step  3 of the procedure , so that we can plug them into and then into . taking into account also equation ( still valid ) ,",
    "we obtain exactly equation .",
    "this argument proves that , for a pure neighbor - conditioned dynamics , the m approximation degenerates into the pqr approximation , and therefore that both coincide with the _ diamond _ approximation of reference  @xcite , as previously stated in section  [ subsec : related_works ] .",
    "the approximation schemes we have presented in this paper can be used as well to analyze continuous - time processes ( in a discretized form ) , or equivalently discrete - time processes with sequential dynamics .",
    "this can be done by defining the following transition probabilities @xmath173 where it is understood that @xmath174 , whereas @xmath175 denotes a kronecker delta and @xmath176 are suitable conditional probabilities , normalized in the proper way @xmath177 equation can be interpreted as follows . with a large probability ( @xmath178 ) each vertex variable @xmath179 stays in its current value , and with a small probability ( @xmath3 ) it is allowed to undergo a transition , governed by the probabilities @xmath180 . for the case of sequential dynamics , @xmath181 is the probability of choosing one specific vertex out of @xmath99 .",
    "alternatively , for the case of continuous - time processes , one can think of @xmath3 as a small time interval , and of @xmath176 as the _ rate _ of the transition @xmath182 ( for @xmath183 ) , which is assumed to depend on the neighborhood configuration @xmath184 .    as mentioned in the text",
    ", we can show that , in the limit @xmath185 ( continuous - time limit ) , the pqr and pq approximations become equivalent . making use of equations and ( step 2 of the computation algorithm ) with the transition probabilities , and taking into account the compatibility equations , the t - cluster distributions can be written as      where we have defined is the t - cluster distribution one would get if the transition probabilities were barely @xmath187 . in the following we use the same notation as well for other cluster types . ]",
    "@xmath188 making use of equations and ( step 3 of the computation algorithm ) , still with the transition probabilities , the z - cluster distributions at the next timestep ( now denoted as @xmath189 rather than @xmath13 ) can be written as @xmath190    + \\mathcal{o}(\\tau^2 )    \\ , , \\label{eq : ct - zfwd}\\ ] ] where we have defined @xmath191 moreover , by and we get @xmath192 where @xmath193 in principle , taking the limit @xmath174 of equations and , one can obtain a system of ordinary differential equations for the pair and site distributions .",
    "indeed , equations and can be viewed as discretized forms thereof , which are directly suitable for numerical implementation .",
    "let us observe that equations and hold for both the pq and pqr approximations , since steps 2 and 3 of the computational procedure are identical , as mentioned in section [ subsec : pqandp ] .",
    "for the pq approximation , these equations are immediately closed , because the @xmath123 distribution ( appearing in the expressions of @xmath194 and @xmath195 ) directly depends on @xmath124 and @xmath196 , according to equation . as we shall see below",
    ", the reason why the pq and pqr approximations turn out to be equivalent is that the difference between the @xmath123 distributions for the two cases is @xmath197 for @xmath174 , so that , being multiplied by @xmath3 in both equations and , its contribution becomes irrelevant .",
    "let us first consider the pq approximation .",
    "equation at time @xmath189 reads @xmath198 plugging equations and into the latter , we easily get @xmath199 as far as the pqr approximation is concerned , the @xmath123 distribution is computed by equation as a marginal of the @xmath200 distribution , which in turn depends on the @xmath201 and @xmath202 distributions via equation ( step 4 of the numerical procedure ) . using equations and ( step 3 of the procedure ) with the @xmath203 distribution expressed by ,",
    "we can write @xmath204 hence , from equations and , @xmath205 plugging equations and into , we get @xmath206 the latter expression , marginalized via , yields again , which is equivalent to the pq result ."
  ],
  "abstract_text": [
    "<S> we investigate different mean - field - like approximations for stochastic dynamics on graphs , within the framework of a cluster - variational approach . in analogy with its equilibrium counterpart , this approach allows one to give a unified view of various ( previously known ) approximation schemes , and suggests quite a systematic way to improve the level of accuracy . </S>",
    "<S> we compare the different approximations with monte carlo simulations on a reversible ( susceptible - infected - susceptible ) discrete - time epidemic - spreading model on random graphs . </S>"
  ]
}