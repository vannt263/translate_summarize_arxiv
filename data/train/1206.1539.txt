{
  "article_text": [
    "( color online ) the photonic kagome lattice with three sites per unit cell @xmath0 .",
    "artificial fluxes can be threaded through the triangular plaquettes @xcite .",
    "top left : lattice periodic in the @xmath1 direction , with `` line '' boundaries composed of @xmath2 sites only .",
    "the blue parallelogram encloses a one - dimensional superunit cell which generates the entire lattice .",
    "top right : a projection of the brillouin zone onto the @xmath3 direction .",
    "bottom left : at @xmath4 the system exhibits a flat , topologically trivial middle band , while the lower and upper bands are characterized by finite chern numbers .",
    "bottom right : the middle band becomes dispersive if one deviates from @xmath5 , for @xmath6 . here , we have considered a cylinder geometry which allows for two chiral edge modes : right - moving at the lower edge ( purple ) , left - moving at the upper edge ( orange ) ; corresponding chiral currents depicted on the lattice . as discussed in secs .",
    "iv b and c , the chiral edge modes can also be detected in the square geometry @xcite.,title=\"fig : \" ]   ( color online ) the photonic kagome lattice with three sites per unit cell @xmath0 .",
    "artificial fluxes can be threaded through the triangular plaquettes @xcite .",
    "top left : lattice periodic in the @xmath1 direction , with `` line '' boundaries composed of @xmath2 sites only .",
    "the blue parallelogram encloses a one - dimensional superunit cell which generates the entire lattice .",
    "top right : a projection of the brillouin zone onto the @xmath3 direction .",
    "bottom left : at @xmath4 the system exhibits a flat , topologically trivial middle band , while the lower and upper bands are characterized by finite chern numbers .",
    "bottom right : the middle band becomes dispersive if one deviates from @xmath5 , for @xmath6 . here , we have considered a cylinder geometry which allows for two chiral edge modes : right - moving at the lower edge ( purple ) , left - moving at the upper edge ( orange ) ; corresponding chiral currents depicted on the lattice . as discussed in secs .",
    "iv b and c , the chiral edge modes can also be detected in the square geometry @xcite.,title=\"fig : \" ]   ( color online ) the photonic kagome lattice with three sites per unit cell @xmath0 .",
    "artificial fluxes can be threaded through the triangular plaquettes @xcite .",
    "top left : lattice periodic in the @xmath1 direction , with `` line '' boundaries composed of @xmath2 sites only .",
    "the blue parallelogram encloses a one - dimensional superunit cell which generates the entire lattice .",
    "top right : a projection of the brillouin zone onto the @xmath3 direction .",
    "bottom left : at @xmath4 the system exhibits a flat , topologically trivial middle band , while the lower and upper bands are characterized by finite chern numbers .",
    "bottom right : the middle band becomes dispersive if one deviates from @xmath5 , for @xmath6 . here , we have considered a cylinder geometry which allows for two chiral edge modes : right - moving at the lower edge ( purple ) , left - moving at the upper edge ( orange ) ; corresponding chiral currents depicted on the lattice . as discussed in secs .",
    "iv b and c , the chiral edge modes can also be detected in the square geometry @xcite.,title=\"fig : \" ]    phenomena associated with flat bands in fermionic and bosonic systems have drawn attention over the last three decades @xcite .",
    "the best known example is perhaps the fractional quantum hall effect @xcite .",
    "if a single - particle band is dispersionless in one direction , electrons are localized in that direction causing an element of the effective mass tensor to diverge .",
    "if the band is completely flat in the entire @xmath7-space , then heavy degeneracy appears and the density of states diverges .",
    "such singularities in the density of states are expected to produce anomalous behaviors in physical properties including transport phenomena and optical response .",
    "if a wavepacket is created in the flat band system , the group velocity will automatically vanish and very strong backscattering prevents the packet from moving .",
    "in fact , this scenario takes place on the kagome lattice where localized states on hexagon rings occur as a result of the alternating sign of the wavefunction amplitude @xcite .",
    "the topological properties of the band structure are now essential in approaching the problem of chern insulators @xcite or topological insulators @xcite .",
    "bandstructure topology has been first discussed in the context of the integer quantum hall effect by thouless _",
    "_ @xcite .",
    "more precisely , the set of energy eigenstates that form an isolated band is described by the first chern number @xcite , a topological invariant associated with the band .",
    "the chern number has direct physical consequences : for example , a completely filled ( electronic ) band has a quantized hall conductance , corresponding to the existence of chiral edge modes @xcite .",
    "it is possible to view this invariant as the flux of the berry curvature @xcite through the first brillouin zone @xcite .",
    "the berry curvature and the chern number have become important mathematical concepts to classify topological phases in connection with band structures .",
    "the chern number has previously been accessed through the conductance and chiral edge states of quantum hall systems , and the total berry phase associated with a single dirac point has been inferred from transport in graphene @xcite . measuring the local berry curvature constitutes an actual challenge in experiments .    in this paper , we investigate anomalous hall phases of light on a specific kagome lattice with artificial magnetic fluxes , which has been introduced in the context of photonic lattices @xcite ; see fig .",
    "[ fig : k_bs ] .",
    "the effect of time - reversal symmetry breaking in connection with this kagome photon lattice has been previously studied at the level of a few site geometry @xcite .",
    "we show below that this lattice with artificial gauge fields allows for the existence of an anomalous quantum hall phase , or a quantum hall phase without landau levels @xcite .",
    "photonic lattices based on arrays of circuit quantum electrodynamics ( cqed ) superconducting elements @xcite have been recently realized experimentally @xcite .",
    "such photon cavity lattices are predicted to exhibit interesting many - body phenomena @xcite including a superfluid - mott transition of light @xcite , bose - hubbard models with attractive interactions @xcite , fractional quantum hall physics @xcite and interesting dynamics @xcite in particular in ring geometries @xcite . recently",
    "a rabi model has been shown to present a @xmath8 ising universality class quantum phase transition between two gapped phases , which are not mott insulator phases @xcite .",
    "an anomalous quantum hall phase for light accompanied by unidirectional photonic chiral edge states has been predicted in photonic crystals @xcite and confirmed experimentally @xcite . in addition , two - dimensional photonic equivalents of topological insulators",
    "have been envisaged @xcite .",
    "topological properties of optical systems might help to implement robust photonic devices @xcite and to realize invisibility cloaks @xcite .",
    "artificial gauge fields in photonic systems have attracted growing attention @xcite .",
    "our primary goal is to investigate the effect of the topologically trivial flat band ( with a zero chern number ) on the robustness of photonic chiral edge modes . in our realization of the kagome lattice ,",
    "neighboring hexagons are subject to the same magnetic flux .",
    "the magnetic flux opens a gap at the dirac points and breaks time - reversal symmetry allowing to stabilize topological phases characterized by two bands acquiring non - zero chern numbers ( see fig .",
    "[ fig : k_bs ] ) . the middle band can be made flat or acquire a finite energy dispersion for certain values of the artificial gauge fields ( see fig .",
    "[ fig : k_bs ] ) or if disorder is present ; therefore , edge modes can coexist with extended bulk states at the same energy . in this situation edge modes are fragile towards leaking into the bulk resulting in an anomalous hall phase with a non - quantized chern number @xcite .",
    "a similar effect has occurred in a toy model on the honeycomb lattice @xcite .",
    "we investigate the evolution of unidirectional edge modes of light in the presence of a localized scatterer by tuning the artificial gauge fields and by introducing disorder .",
    "we present a manner to determine berry s phases of photon wavepackets through an interference experiment .",
    "there exists a previous proposal to access the berry curvature through a measurement of group velocities of wavepackets in optical lattices @xcite .",
    "we discuss a direct measurement of the chern number of a bloch band , which does not require summation of contributions across the brillouin zone .",
    "underlying these methods is the implementation of uniform synthetic gauge fields through tunable cavities with time - dependent frequencies , and the realization of landau levels in photon systems .",
    "it shall be noticed that a similar scheme has been recently realized in cold atom systems @xcite and that cavities with tunable resonances have been already implemented in cqed @xcite .",
    "in addition , the quest for exotic phases on the kagome lattice represents an active subject of research @xcite .",
    "topological phases and their supporting artificial gauge fields are potentially realizable in cold atom systems @xcite .",
    "the hofstadter spectrum @xcite on the related dice lattice has been realized in gaalas / gaas systems @xcite .",
    "the hofstadter spectrum for the kagome lattice has also been studied with superconducting wire networks @xcite .",
    "finally , the kagome structure naturally appears in real materials @xcite and recently it has been implemented in cold atom systems @xcite .",
    "the paper is organized as follows .",
    "we introduce the tight - binding model of a kagome lattice in the presence of artificial gauge fields in sec .",
    "[ k_tbmodel ] .",
    "explicit solutions for the edge mode wavefunctions in cylinder geometry and a brief discussion of the bulk - edge correspondence are the subjects of sec .",
    "[ k_edgemodes ] . following this , in sec .",
    "[ k_obs ] we present observables specific to the anomalous hall phase , namely the bulk polarization , the edge currents , and the local density of states .",
    "[ k_berryphaseobs ] further details on a method to measure berry s phases of wavepackets in both clean and disordered systems .",
    "the method requires a uniform synthetic magnetic field , on whose realization in a photonic lattice we elaborate .",
    "additionally , we show a method to directly find the topological chern number of a given bloch band by counting energy levels of the system in an artificial magnetic field . in sec .",
    "[ k_chern ] , we discuss in detail the anomalous hall effects of light in relation to chern numbers . in the particular case of disordered systems , we present a real - space calculation of the chern number which will reveal a close analogy between tuning the artificial gauge fields and the presence of disorder in the system ( in cqed lattices , disorder can appear either as an on - site scalar or as a vector potential ) . in sec .",
    "[ k_sym ] we discuss the role of symmetries and the local stability of dirac points in the three band system . in sec .",
    "[ k_int ] we study the effect of interactions in qed cavities @xcite , such as bose - hubbard @xcite and jaynes - cummings @xcite , on the topological phase . the appendices are dedicated to technical details .",
    "below , we introduce the kagome lattice with artificial gauge fields .",
    "an effective tight - binding hamiltonian for photons with the possibility to break time - reversal symmetry can be realized in a cqed system by coupling superconducting waveguides to nano - josephson circulators ( rings ) @xcite .",
    "the kagome lattice is formed by triangular and hexagonal plaquettes arranged as shown in fig . [",
    "fig : k_bs ] .",
    "the resulting structure has three sites per unit cell , which we denote by @xmath0 .",
    "letting @xmath9 be twice the length of a bond , we pick the following lattice vectors @xmath10 and reciprocal lattice vectors @xmath11 : @xmath12 the brillouin zone , see fig .",
    "[ fig : k_bs ] , is hexagonal and contains the common points of high symmetry @xmath13 and @xmath14 .",
    "we will use the following lattice coordinates : the directions along @xmath15 , @xmath16 in real - space corresponding to @xmath17 in momentum space ( top right panel of fig .",
    "[ fig : k_bs ] ) , where hats denote unit vectors . in this notation , @xmath18 coincides with the @xmath1 direction , @xmath19 .",
    "we denote sites on the lattice by a pair of integers @xmath20 , and coordinates on the lattice in terms of lattice vectors by @xmath21 .",
    "continuous coordinates are represented by a pair of real numbers @xmath22 in terms of unit vectors , @xmath23 ; momenta will be written as @xmath24 .    in a cqed system ,",
    "a given waveguide of length in the millimeter range typically supports a single photonic mode .",
    "furthermore , the photons which travel in these one - dimensional waveguides do not carry a polarization label and must be thought of as simply excitations of microwave resonators @xcite .",
    "the hopping of photons from one waveguide to another results in a translationally invariant tight - binding hamiltonian .",
    "following ref .",
    "@xcite , a honeycomb array of waveguides with nano - josephson circulators can be equivalently reformulated as the photonic kagome lattice of fig .",
    "[ fig : k_bs ] . the hamiltonian can be fourier transformed , and we obtain : @xmath25 and the spinor @xmath26 contains the creation operators on each sublattice , and    @xmath27    we have defined three dimensionless functions of momentum , @xmath28    in the effective tight - binding model particles hop between nearest - neighbor sites with a complex hopping integral @xmath29 .",
    "photons acquire a phase @xmath30 around a triangular plaquette and a phase of @xmath31 around the hexagonal plaquette , amounting to zero total flux in the parallelogram unit cell of area @xmath32 , which is characteristic of the anomalous quantum hall effect without landau levels as introduced by haldane @xcite .",
    "the particles are also subject to an artificial on - site potential induced by the ( electromagnetic superconducting resonator ) waveguide frequency @xmath33 , and an artifical gauge field giving rise to complex hopping integrals and breaking time - reversal symmetry .",
    "it shall be noted that both the effective on - site potential @xmath34 and the hopping strength @xmath35 should be obtained rigorously after integrating out coupling element degrees of freedom ( in our case , a josephson ring coupling three resonators ) @xcite . in a typical cqed experiment ,",
    "the energy of an incoming photon is much larger than the size of the energy gap between bands : @xmath35 is expected to lie below @xmath36 mhz and the frequency @xmath33 is in the ghz , or microwave , range .",
    "the rotational symmetry of the lattice is not strictly necessary and anisotropies are possible ; their effect on the bandstructure is discussed in sec .",
    "[ k_sym ] . in the rest of the paper we shall focus on the isotropic case .",
    "the hamiltonian of eq .",
    "[ eq : k_hk ] is a band hamiltonian obeying bloch s theorem . to determine the bloch energies @xmath37 for the three bands",
    "let us denote @xmath38 , and @xmath39 .",
    "we obtain the following equation for the eigenvalues @xmath40 for special values of the phase @xmath41 , destructive interference confines the wavefunction to the hexagonal plaquettes , which renders the respective band completely dispersionless .",
    "we obtain such a solution with energy @xmath42 whenever @xmath43 .",
    "the middle band is flat whenever @xmath44 , where @xmath45 is an integer .",
    "when @xmath46 , the upper or lower band is flat , touching the middle band at the @xmath47 point ; the other two bands form dirac cones at the six corners of the brillouin zone . for example , the bandstructure for the cases @xmath48 and @xmath49 ( which will be thoroughly discussed in the text ) is depicted in fig .",
    "[ fig : k_bs ] , along with edge modes arising from a finite geometry to be discussed below .",
    "the edge modes appear because by tuning the phase @xmath41 one breaks time - reversal symmetry at the dirac points .",
    "the bandstructure of eq .",
    "( [ eq : k_evals ] ) is invariant to a shift of @xmath50 in @xmath41 ; we then restrict to @xmath51 $ ] in the further discussion .     on the kagome lattice defined with hopping phase @xmath41 : by tuning @xmath52",
    "the photon system is either characterized by extended bulk states ( `` bulk band '' ) or by a `` band gap '' where the system exhibits unidirectional edge modes but no bulk states .",
    "the _ f _ points represent states in the flat band ( the blue points at @xmath53 correspond to a middle flat band separated by finite energy gaps from the lower and upper bands ; black points at @xmath54 correspond to flat upper or lower band ) .",
    "the _ d _ points are degeneracy points between pairs of bands at the dirac points @xmath55 .",
    "the dashed lines are explained in the main text .",
    "[ fig : k_phases ] ]    time - reversal symmetry is kept if the phases accumulated along any closed loop on the lattice amount to an integer multiple of @xmath56 @xcite .",
    "this condition is equivalent to requiring that @xmath57 and its time - reversed counterpart , @xmath58 , are the same up to a gauge transformation on the spinor @xmath59 in eq .",
    "( [ eq : k_h ] ) . in our case , if @xmath30 is an integer multiple of @xmath56 , then the hamiltonian is time - reversal symmetric .",
    "the bandstructure properties can be summarized in the @xmath52 phase diagram of fig .",
    "[ fig : k_phases ] .",
    "the phase diagram represented is periodic in @xmath41 .",
    "a particle created at energies in the `` band gap '' regions can not be in a two - dimensional bloch state of the hamiltonian .",
    "states exist in this energy interval only in a finite geometry with boundaries , as we show in detail in sec .",
    "[ k_edgemodes ] . such a state",
    "would be confined to the edges of the sample and propagate chirally ( chiral edge mode ) .",
    "the `` bulk band '' phase is embodied by bulk extended states .",
    "when photonic bulk extended states and chiral edge modes coexist at the same energy @xmath60 , the edge excitations may scatter into the bulk ; this situation coincides with an anomalous hall phase .",
    "f _ points in the diagram of fig .",
    "[ fig : k_phases ] correspond to flat bands .",
    "dashed lines from the @xmath61 points show the possible phase transitions : horizontal blue line - from the flat band to a band gap by changing the particle energy ; vertical blue line : from the flat band to a bulk band by changing the phase @xmath41 .",
    "the _ d _ points represent band degeneracies at the dirac points @xmath55 . moving along the vertical red line (",
    "a change in @xmath41 ) lifts the degeneracy and a finite band gap is opened . a particle with a slightly larger energy would be in a bulk band state .    at @xmath62 ,",
    "the system is gapless : there is a quadratic touching with a flat band at the @xmath47 point , corresponding to @xmath61 in fig .",
    "[ fig : k_phases ] , and dirac cones at the @xmath63 points , corresponding to @xmath64 .",
    "we will be focusing on the system in the vicinity of @xmath48 , at which the system exhibits a flat band . changing the energy of the particle at the @xmath61 points ( equivalent to moving along a horizontal line in the figure ) will take us from the flat band into a band gap .",
    "changing @xmath41 at the @xmath61 point ( equivalent to moving along the vertical line ) will take us from the flat band into a bulk - band with finite bandwidth .",
    "in this section we make explicit the correspondence between a bulk quantity , the chern number , and the chiral edge modes at the edges of a sample .",
    "it should be noted that even though we choose the cylindrical geometry below for mathematical convenience , the edge states can be detected in a square geometry ; this point will be illustrated below in figs .",
    "5 and 6 .    given a translationally invariant two - dimensional lattice hamiltonian whose eigenstates are the bloch states , the existence of chiral edge modes is signaled by the non - zero values of the chern number @xmath65 corresponding to the bloch band @xmath66 @xcite , @xmath67 where the vector field @xmath68 is the berry gauge potential associated to the @xmath69 bloch band , @xmath70 the integral in eq .",
    "( [ eq : k_chernkspace ] ) is over the entire surface of the brillouin zone , so it is a summation over all of the states enclosed in the @xmath69 band .",
    "when the bands are separated by an energy gap throughout the brillouin zone , the band chern numbers of the lower , middle , and upper bands , respectively , can be shown numerically to be @xmath71 and @xmath72 , where @xmath73 $ ] .",
    "the @xmath74 function was chosen to obey the @xmath75 periodicity of the bandstructure with respect to the phase @xmath41 .",
    "in particular , this is consistent with a recent result that implies that the flat band of the kagome lattice , if isolated from the other bands by energy gaps ( as is the case for @xmath48 ) , will be non - topological @xcite .    the chern number of eq .",
    "( [ eq : k_chernkspace ] ) is a topological index whose value can only change if by variation of parameters the bands touch at some degeneracy points in the brillouin zone and subsequently reopen the energy gap @xcite .",
    "as the parameter @xmath41 is varied , for values @xmath76 two bands touch at all corners of the brillouin zone forming dirac points ; the remaining pair has a degeneracy at the @xmath47 point . at the transition upper and lower bands exchange chern numbers leaving the middle band topologically trivial throughout .",
    "the stability of dirac points and the nature of the exchange of chern numbers is explained in sec .",
    "[ k_sym ] .",
    "we now make the correspondence between the bulk quantity and the edge modes explicit .",
    "consider an analogous fermion system at zero temperature : all states with energies lower than the chemical potential @xmath77 are occupied .",
    "if @xmath77 is set to an energy gap , the of band chern numbers for the occupied bands is an integer quantity , possibly zero , which is proportional to the hall conductivity @xcite .",
    "the principle of bulk - edge correspondence states that this sum counts the chiral edge modes @xcite supported at the given chemical potential .",
    "since the argument is independent of statistics , it applies equally well for photons ; we will then replace the notion of `` chemical potential '' by `` energy of injected particle ''",
    ".     effect of different boundary conditions on the dispersion of edge modes in the proximity of the dispersive middle band for a system with @xmath78 : left , two `` line '' boundaries ; middle , one `` line '' edge , the other `` armchair '' ; right , both boundaries are `` armchair '' .",
    "the bottom panels exhibit the minimal ladder lattices that exhibit the three boundary conditions .",
    "all three ladders shown support edge modes . ]",
    "let us place the kagome lattice in a cylinder geometry : a particle injected at an energy inside the energy gap can belong to one of two states localized at the edges .",
    "we now find an analytical solution of the edge wavefunctions .",
    "we consider a cylinder with line boundaries along the periodic @xmath15 direction ( boundaries containing @xmath2 sites only - see fig . [",
    "fig : k_bc ] ) .",
    "the cylinder is generated by translating the superunit cell ( blue parallelogram in fig .",
    "[ fig : k_bs ] ) along the lattice vector @xmath79 .",
    "the superunit cell is obtained by translating the triangular plaquette along @xmath80 .",
    "we number plaquettes along the superunit cell by integer @xmath81 , as in fig .",
    "[ fig : k_bs ] .",
    "we fourier transform the operators @xmath82 along the periodic @xmath83 direction @xmath84 where @xmath85 denotes the sublattice @xmath2 or @xmath86 ; @xmath87 is the number of repeated superunit cells making up the cylinder ; and integer @xmath88 indicates the triangular plaquette along the superunit cell , as shown in fig .",
    "[ fig : k_bs ] .",
    "the problem has become to diagonalize the one - dimensional hamiltonian describing a superunit cell : @xmath89 this form reduces to the one in eq .",
    "( [ eq : k_hk ] ) when fourier transformed around the remaining direction @xmath90 . to obtain the edge states ,",
    "let us take the general form of an eigenstate @xmath91 where @xmath92 is a ket localized on sublattice @xmath85 of the @xmath93 triangular plaquette along the super - unit cell .",
    "the schrdinger equation@xmath94 yields the following linear system for the components of the wavefunction @xmath95 and the energy dispersion @xmath96 ,    @xmath97    the first three of which hold for @xmath88 spanning the superunit cell `` bulk '' between @xmath98 and @xmath99 , and the other three are equations at the boundary",
    ". there exist solutions which are exponentially suppressed with distance from the boundary of the sample , which we put in the form ( @xmath85 denotes sublattice ) @xmath100 the condition that the two edges of the cylinder are line - shaped amounts to requiring @xmath101 a pair of chiral edge modes localized at the boundaries of the sample arises : @xmath102 if @xmath103 , then the state is confined to the top ( bottom ) boundary .",
    "the states identified to be at the top ( bottom ) travel in the @xmath104 direction , so `` chirally '' .",
    "the edge modes along with the bulk states for a flat band system with @xmath48 and for a dispersive middle band system at @xmath78 are plotted in the bottom panels of fig .",
    "[ fig : k_bs ] .",
    "the simple boundary condition chosen gives an energy dispersion similar to that of a one - dimensional tight - binding chain of lattice constant @xmath105 .",
    "the factors @xmath106 describing the spatial suppression of the wavefunction into the sample bulk can become singular or 0 , in which case the normalized wavefunction has 0 weight inside of the bulk and is pinned to one of the two edges ( see figs .",
    "[ fig : k_bs ] and [ fig : k_lambdas ] ) . for other boundary conditions ( see fig . [",
    "fig : k_bc ] for the equivalent `` armchair '' condition ) , one can arrange that the edge mode and the middle bulk band overlap in energy , but not in momentum , or in both energy and momentum .",
    "states overlapping in energy can scatter into each other : in the `` line '' boundary conditions , a spatially localized , @xmath107-function , impurity can scatter the edge mode into the bulk , as we show in sec .",
    "[ k_current ] .",
    "for the case of a kagome ladder , the counter - propagating edge modes exist as long as there are two distinct edges , of either the `` armchair '' or the `` line '' type .",
    "therefore , any ladder will need to have at least one row of hexagonal plaquettes .",
    "the configuration with the least sites that sustains edge modes is shown in the bottom left of fig . [",
    "fig : k_bc ] .",
    "this specific ladder with two `` line '' boundaries has the property that the flux per unit cell is 0 .",
    "an intriguing property related to the bulk - edge correspondence is the phenomenon of polarization in a topologically non - trivial system .",
    "we develop on this in the context of a photonic system in sec .",
    "[ k_polarization ] .",
    "in this section , we elaborate on observable quantities in the cqed based photon lattice exhibiting two different hall phases for light @xcite . in sec .",
    "[ k_polarization ] we discuss the polarization of a topologically nontrivial bulk in the context of photonic systems and draw connections to the local density of states in sec .",
    "[ k_ldos ] .",
    "[ k_current ] is dedicated to the lattice current density .",
    "let us emphasize that the local density of states and lattice current densities are in principle accessible in square geometries .",
    "the quantities @xmath108 ( solid line ) , and @xmath109 ( dashed line ) defined in eqs .",
    "( [ eq : k_edgestateenfn ] ) describe how the wavefunction of the edge mode decays into the bulk.the reference line is at @xmath110 . for @xmath111 the respective branch @xmath112",
    "is located at the bottom edge .",
    "conversely , if @xmath113 , it is located at the top edge .",
    "this results in the color scheme for the edge modes on fig . [",
    "fig : k_bs ] ]    .",
    "the phenomenon of polarization is a signature of the fact that it is impossible to choose a smooth gauge for the bloch wavefunctions across the brillouin zone in a topologically non - trivial system .",
    "polarization has been introduced in the context of electronic chern insulators in ref .",
    "@xcite , and it is related to the hall conductivity . in a photonic or cold atom system , polarization may be observed in the dynamics of wavepackets , as we are about to describe .",
    "let us consider the one - dimensional system described by the hamiltonian @xmath114 of eq .",
    "( [ eq : k_quasi1d ] ) .",
    "this time we close the cylinder around both directions @xmath15 and @xmath16 into a torus , such that @xmath114 now describes a periodic one - dimensional lattice along the @xmath16 direction , in terms of the periodic parameter @xmath83 .",
    "it is possible to find for this one - dimensional periodic system a set of bloch states @xmath115 with a smooth choice of gauge everywhere as a function of @xmath90 and for each value of @xmath83 .",
    "this is equivalent to the possibility to construct wannier states which are exponentially localized along the @xmath16 direction , which is a classic result of kohn @xcite .",
    "for now let us focus on a single band @xmath116 .",
    "the maximally localized wannier states take the following form @xcite : @xmath117 where @xmath118 is the number of triangular plaquettes in the quasi one - dimensional system ; @xmath119 is the real coordinate of the center of the wannier function along the @xmath16 direction , which is made precise below ; @xmath120 are the components along the directions @xmath15,@xmath16 of the berry gauge field introduced in eq .",
    "( [ eq : k_berrygauge ] ) , and @xmath121 since the bloch functions can and have been chosen periodic and smooth in the @xmath90 direction , both of the components of the berry gauge field @xmath120 are periodic functions of @xmath90 .",
    "the coordinate of the center of the wannier functions drifts depending on the parameter @xmath83 .",
    "the expectation value of the position operator @xmath122 is @xmath123 the net displacement of the center of the wannier state when the parameter @xmath83 winds around its period equals the chern number : @xmath124 in the last line we have used the fact that @xmath120 is periodic in @xmath90 to reexpress the drift of the center of the wannier state as the line integral of the berry gauge field around the boundary of the first brillouin zone @xmath125 , which is exactly the chern number @xmath126 .",
    "this condition summarizes the fact that a smooth gauge can not be chosen for the bloch functions in a band with non - zero @xmath126 .",
    "if this were true , then the berry gauge field would be periodic in both directions , and the chern number would vanish .",
    "we arrive at the following boundary condition for the wannier states , @xmath127 in particular , this tells us that if a wavepacket constructed out of such states is accelerated in the @xmath15 direction , then its center will drift along the @xmath16 direction .",
    "a wavepacket constructed within a band of @xmath98 chern number would return to its initial coordinate on the @xmath122 axis upon a complete revolution of @xmath83 .",
    "we shall come back to this point in sec .",
    "[ k_berryphase ] .",
    "the localization of chiral modes at the edges of the sample , the existence of a flat band , and the extended versus localized character of bulk states can be tested by measuring the local density of states . because phase information is absent from the density , it is not possible to measure the polarization of sec .",
    "[ k_polarization ] . given a complete set of states",
    "@xmath128 , each of which is an eigenstate of energy @xmath129 of the tight binding hamiltonian of eq .",
    "( [ eq : k_h ] ) , @xmath130 one can define the local density of states in terms of the energy @xmath60 and the two dimensional real coordinate on the lattice @xmath131 @xmath132 this quantity is by definition normalized to the number of sites in the system , @xmath133 where @xmath134 indexes the sites , @xmath135 , and @xmath136 denotes the number of unit cells and there are @xmath137 sites per unit cell . we plot the local density of states in the same cylinder geometry with `` line '' edges of sec .",
    "[ k_edgemodes ] .",
    "we have approximated the @xmath107-function by a lorentzian @xmath138 where the width is set to @xmath139 and a system of @xmath140 sites has been numerically diagonalized . in the flat band model with @xmath48 ,",
    "as shown explicitly in @xcite , there exists a highly degenerate band of zero - energy states localized in the hexagonal plaquettes due to destructive interference effects . when the flux @xmath41 is detuned from @xmath141 , the middle band becomes dispersive and the states leak out of the hexagonal plaquettes and become extended ( for @xmath142 , see fig .",
    "[ fig : k_ldos_pi4clean_mid_band_0.400 ] ) . finally , if disorder is introduced into the flat band system at @xmath143 , the states inside the middle band become delocalized due to disorder ( fig .",
    "[ fig : k_ldos_pi6_wphi0.94_mid_band_0.541 ] ) .",
    "intra - gap edge modes have non - zero spectral weight only close to the edges of the sample .      a measurement of the local density of states",
    "@xmath144 can not detect the chirality of edge modes . the simplest possible quantity that can show us an observable effect of chirality is the lattice current density .",
    "this operator is defined between two lattice sites indexed by two pairs of integers @xmath145 and @xmath146 , and situated at @xmath147 and @xmath148 .",
    "it measures the number of particles that flow from one site to another per unit time and takes the standard form @xcite @xmath149 using the notation of sec .",
    "[ k_ldos ] , the observable quantity of interest is the current expectation value for an eigenstate @xmath128 of the tight - binding hamiltonian @xmath150 is @xmath151 .    from the study of edge mode dispersion relations in sec .",
    "[ k_edgemodes ] , we have concluded that the introduction of a small impurity at the boundary can mix all momenta and the edge state can scatter into the bulk .",
    "we test this by introducing a @xmath107-function impurity at one of the sites on the boundary of the system .",
    "the expectation value @xmath152 is the familiar current density associated with the wavefunction @xmath153 .",
    "we consider a system containing one impurity localized in real space at a single site .",
    "this impurity couples all pairs of @xmath154-points , implying that whenever the edge mode and the bulk state are at the same energy , but separated in momentum , the edge mode will have a finite lifetime towards scattering into a bulk state .",
    "results for the current operator in the kagome system are plotted in fig .",
    "[ fig : k_currents ] . in the left panel ,",
    "we have plotted the current of an edge state whose energy is located in the gap just above and not overlapping with the middle band at @xmath78 ( see fig .",
    "[ fig : k_bs ] ) - the current ( in red ) will go around the @xmath107-function impurity without leaking into the bulk .",
    "this corresponds to the anomalous quantum hall phase and is reminiscent of the situation at @xmath143 .",
    "as soon as the edge mode and the bulk band overlap in energy , current at the edge has a probability to scatter into the bulk .",
    "a state at this energy will essentially live inside of the bulk ( current depicted in green ) .",
    "this corresponds to the anomalous hall phase . if instead of an impurity at the edge we had strong phase disorder @xmath155 for a system with flux @xmath78 , there would again be a finite probability to scatter into the bulk , as shown in the right panelof fig .",
    "[ fig : k_currents ] .",
    "( color online ) plots of the expectation value of the lattice current operator in two implementations of the @xmath78 system .",
    "left panel : the system has a dispersive middle band overlapping in energy with the edge mode ( see fig .",
    "[ fig : k_bc ] ) . in the presence of a @xmath107-function impurity",
    "the edge state current ( red ) will deviate around the impurity , maintaining its chirality , if the energy of the edge state lies in the gap and does not overlap with the middle band .",
    "this corresponds to the anomalous quantum hall phase .",
    "the current for a state whose energy is within the overlap region with the middle band is shown in green .",
    "right panel : in the presence of a dispersive middle band ( with @xmath78 ) and disorder , the edge state can leak into the bulk with a finite probability.,title=\"fig : \" ]   ( color online ) plots of the expectation value of the lattice current operator in two implementations of the @xmath78 system .",
    "left panel : the system has a dispersive middle band overlapping in energy with the edge mode ( see fig .",
    "[ fig : k_bc ] ) . in the presence of a @xmath107-function impurity",
    "the edge state current ( red ) will deviate around the impurity , maintaining its chirality , if the energy of the edge state lies in the gap and does not overlap with the middle band .",
    "this corresponds to the anomalous quantum hall phase .",
    "the current for a state whose energy is within the overlap region with the middle band is shown in green .",
    "right panel : in the presence of a dispersive middle band ( with @xmath78 ) and disorder , the edge state can leak into the bulk with a finite probability.,title=\"fig : \" ]",
    "when a system in an anomalous hall phase is placed in an external gauge field , it is possible to measure berry s phases around closed loops in the brillouin zone and band chern numbers .",
    "this section is dedicated to such observables .",
    "the treatment is applicable whenever the particles are neutral , and therefore suitable for cold atom systems as well . in sec .",
    "[ k_synthetic ] we explain a scheme to realize synthetic gauge fields on the kagome lattice that involves a time - modulated potential gradient in the cavity array , as suggested in ref . .",
    "in sec . [ k_berryphase ] , we present a way to measure the berry phases of wavepackets of photons at a given energy based on interference .",
    "we also present a manner in which the chern number can be directly extracted from level - counting in the spectrum of the system in a uniform synthetic magnetic field in sec .",
    "[ k_directchern ] .",
    "we discuss here how to simulate the effect of a magnetic field in a system of neutral particles .",
    "such artificial magnetic fields , including frustrated or staggered configurations , have been actively studied in recent years . in a cavity ,",
    "photons coupled to artificial atoms , such as in the rabi model , are subject to an effective gauge potential induced by the dipolar coupling @xcite . on a lattice ,",
    "gauge fields can in principle be simulated by creating effective peierls phases through time - periodic driving as proposed in refs .",
    "@xcite for cold atoms . in what follows",
    ", we shall follow the line of thought of ref .",
    "the method relies on adjusting the potential terms individually for each site in the trapping optical lattice of the cold atom system . in cqed systems , this is equivalent to adjusting the frequency of each resonator individually and time - dependently , which has become experimentally possible @xcite .",
    "@xcite has already proposed a means of realizing a synthetic gauge field in a square lattice array of coupled photonic cavities .    generally , a static gradient of the frequency @xmath156 of the resonator located at site @xmath145 yields an artificial electric field .",
    "additionally , it is possible to have time - varying frequencies @xmath157 , which produce complex hopping amplitudes and so mimic the effect of a gauge field .",
    "consider that that there is a driving frequency at site @xmath20 with the following dependence on the time @xmath158 : @xmath159 where the time - dependent hamiltonian is the original tight - binding hamiltonian of eq .",
    "( [ eq : k_h ] ) , to which we add a time - dependent perturbation . the perturbation amounts to a tilt along the @xmath15 direction , modulated in time .",
    "@xmath160 is the driving frequency , and for the following derivation we assume that the driving frequency is resonant with the on - site energy @xmath161 in the sense that @xmath162 .",
    "the details of this choice and the calculation are presented in appendix [ ap : synthetic ] . here",
    "we summarize the results .    in the rotating wave approximation , the time dependence of eq .",
    "( [ eq : k_htau ] ) has the following effects : photons acquire an additional phase @xmath163 along each bond in the @xmath15 direction ; they acquire no additional phase along the bonds in the @xmath16 direction .",
    "the following equations summarize the changes incured by the complex hopping amplitudes : @xmath164 the function @xmath165 is a bessel function of the first kind .",
    "there will be a total phase @xmath166 around the parallelogram plaquettes of area @xmath32 ( see fig .",
    "[ fig : k_bs ] ) . the artificial gauge field extracted from eq .",
    "( [ eq : k_htau ] ) gives rise to a uniform magnetic flux across the lattice , although the field itself is not uniform at the level of one unit cell due to the presence of the oblique bonds ; nevertheless , this non - uniformity can be removed by a gauge transformation ( see appendix [ ap : synthetic ] ) .",
    "this construction is equivalent to the peierls substitution : a particle in a gauge field @xmath167 acquires a phase @xmath168 between two sites located at @xmath169 and @xmath170 ( the choice of path does not matter if the vector potential is that of an infinitely thin solenoid at the center of the plaquette ) .",
    "we shall make the convention that the photon coupling to such artificial gauge fields has an effective synthetic charge @xmath171 , and all fields to be used below will have a subscript `` _ _ s _ _ '' to highlight the distinction from actual electromagnetic fields .",
    "the experimental realization of an artificial field would allow us to measure berry s phases around closed loops in the brillouin zone or directly access the chern number , as explained in sec .",
    "[ k_berryphase ] and [ k_directchern ] , respectively .",
    "the potential to create a magnetic field can make a measurement of landau levels of the kagome lattice accessible , see sec .",
    "[ k_directchern ] .      in this section",
    "we describe a method to measure berry s phases around closed constant energy contours in the brillouin zone . for this",
    "we draw upon the semiclassical dynamics of a wavepacket within a given band of a bloch hamiltonian .    in sec .",
    "[ k_polarization ] we have noted that , due to the polarization phenomenon , wavepackets accelerated in the @xmath15 direction drift in the @xmath16 direction .",
    "the motion of wavepackets subject to a uniform force is complicated due to bloch oscillations .",
    "proposals exist to access berry s phases in a cold atom system relying on a measurement of the group velocity of a wavepacket under an external scalar potential exhibiting bloch oscillations @xcite . here",
    "we present an alternative method to map berry s phases of wavepackets , based solely on interference , and without the need to measure the group velocity of wavepackets .",
    "the semiclassical dynamics of a wavepacket centered at momentum and coordinate @xmath172 and in a bloch band is given by @xcite @xmath173 where @xmath174 are synthetic classical fields , and @xmath171 is a synthetic effective charge , which is left as an explicit quantity in the equations in order to highlight the analogy with electronic systems .",
    "@xmath175 is the bloch band energy , and @xmath176 is the berry curvature @xcite associated with the berry gauge field introduced in eq .",
    "( [ eq : k_berrygauge ] ) ; we have dropped the band index @xmath177 , as we neglect transitions to other bloch bands ; @xmath178 only has a @xmath179 component . the semiclassical eqs .",
    "( [ eq : k_semicls ] ) are dual in the following sense : the second equation represents the electromagnetic force ; in the first equation , the band energy plays the role of a scalar potential in momentum space , while the second term is nonvanishing only when the wavepacket is accelerated , and the berry curvature acts like a magnetic field in momentum space .",
    "the group velocity @xmath180 is corrected by an `` anomalous '' contribution @xcite which is now known to be inherently connected to geometric phases of wavefunctions @xcite .",
    "the geometric phase of a wavepacket can be measured in a system subject to a uniform synthetic magnetic field perpendicular to the plane , @xmath181 , but no electric field .",
    "the semiclassical equations of motion for the wavepacket become @xmath182 and @xmath183 is a correction from the berry curvature : @xmath184 eq .",
    "( [ eq : k_kceq ] ) implies that the force @xmath185 is always perpendicular to the group velocity @xmath180 .",
    "consequently , the energy of the wavepacket is a constant of motion , @xmath186 the trajectory in momentum space follows a contour of constant energy in the brillouin zone .",
    "the trajectory in real - space described by eq .",
    "( [ eq : k_rceq ] ) , on the other hand , is related to the trajectory in momentum space by a @xmath187 rotation and a rescaling .",
    "a wavepacket evolving on a constant energy contour will return to the original point in @xmath154-space . if the orbit is closed in the first brillouin zone ( continuous lines in fig .",
    "[ fig : k_sclpaths ] ) , then the trajectory in real space will be a closed curve as well .",
    "alternatively , the orbit may be periodic in the extended brillouin zone and follow a separatrix ( dashed lines in fig .",
    "[ fig : k_sclpaths ] ) , in which case the trajectory in real space will not be closed . finally , the berry curvature correction in eq .",
    "( [ eq : k_berrycorr ] ) can only affect the rate at which the momentum @xmath188 varies , but not the form of the trajectory .",
    "the acceleration will be small in areas of strong berry curvature , typically close to the @xmath63 points .    .",
    "trajectories can be closed within the first brillouin zone resulting in closed real space trajectories or , if the initial momentum lies on the separatrix lines ( see , for example , the dashed lines ) , then the trajectory in momentum space can only close in the extended brillouin zone , and in real space the particle traces a straight line . [",
    "fig : k_sclpaths ] ]    it is possible to determine resonance conditions for those paths which close in the brillouin zone .",
    "let us assume that we are in the case in which the wavepacket traverses a closed curve in phase space .",
    "along a phase space loop of constant energy @xmath60 , denoted @xmath189 , the wavepacket will acquire a phase @xcite @xmath190 where the gauge field @xmath191 generates the magnetic field @xmath192 .",
    "this can be further simplified to @xmath193 where @xmath194 is the period of the motion .",
    "the first term of the integrand is the berry phase accumulated along the path , @xmath195 .",
    "the second term can be written entirely in momentum space , @xmath196 where @xmath197 is twice the surface area element for the surface enclosed by the curve @xmath189 in momentum space .",
    "collecting the two pieces , the full phase acquired by the wavepacket around a closed loop in momentum space is @xmath198 the arriving wavepacket will interfere with the emitted wavepacket and the amplitude will be maximal if @xmath199 where the maslov index @xcite is taken to be @xmath200 .",
    "there is an implicit energy dependence in the trajectory @xmath201 , therefore the phases in eq .",
    "( [ eq : k_gammac ] ) are energy dependent .",
    "this last equation is the onsager relation @xcite and can be viewed as a bohr - sommerfeld quantization condition for the closed trajectories in phase space .",
    "an analogous situation occurs in electronic systems , in the de haas - van alphen effect @xcite , where peaks in the magnetization as a function of the external magnetic field are a result of such a resonant behavior .    in a photon system ,",
    "the berry phases can be accessed as follows .",
    "suppose that a wavepacket of known energy @xmath60 and initial momentum @xmath202 can be produced .",
    "upon tracing a closed path in real space , the traveling wavepacket returns and interferes with the emitted signal .",
    "one can tune the external field @xmath203 such that the amplitude at the emitter is resonant .",
    "two consecutive resonances determine the area @xmath204 of the common closed path in momentum space , see eq .",
    "( [ eq : k_gammac ] ) .",
    "this allows for the determination of the berry phase along the path @xmath189 up to a multiple of @xmath205 . by keeping the energy",
    "@xmath60 fixed and changing initial momentum one can explore all curves at the given energy within the brioullin zone .",
    "two examples are given in fig .",
    "[ fig : k_sclpaths ] .",
    "what such a measurement would yield with and without disorder is presented in sec .",
    "[ k_chern ] in connection to a realization of the anomalous hall effect in the kagome photon system .",
    "we have shown that an interference experiment can be realized to measure the berry phase of a wavepacket injected at a specific energy and initial momentum .",
    "berry phases appear in measurements of a photonic equivalent of the anomalous hall effect , as explained in the next section .",
    "moreover , the measurement can be changed to probe landau levels . instead of keeping the energy fixed and varying the magnetic field",
    "@xmath203 , let us keep the field fixed and vary the energy .",
    "separations between resonant orbits discussed above correspond to transitions between landau levels .",
    "the analysis of level splitting in the presence of @xmath203 allows us to directly probe the chern number of a bloch band .",
    "this is the subject of sec .",
    "[ k_directchern ] .      in this section",
    "we present a way to directly determine the chern number of a bloch band from the spectrum in a synthetic magnetic field . in a magnetic field , the three original bloch bands will split into subbands , sometimes called magnetic bloch bands .",
    "the resonant semiclassical trajectories of sec .",
    "[ k_berryphase ] correspond to the magnetic subbands of the original bloch band under the influence of the synthetic magnetic field @xmath203 .",
    "the chern number influences how a bloch band splits into magnetic subbands @xcite .",
    "there exists a maximum number of closed resonant trajectories within the brillouin zone .",
    "this is obtained by observing that the maximal area of a single resonant closed trajectory @xmath86 , @xmath204 , has to be equal to the area of the first brillouin zone .",
    "this dictates , then , that the number of subbands obtained by splitting any one of the bloch bands is given by : @xmath206,\\ ] ] where @xmath126 is the chern number associated with the band , @xmath207 is the flux through the unit cell of a uniform synthetic magnetic field @xmath203 , in units of @xmath208 , and the square brackets indicate the integer part of the real number .",
    "the field @xmath203 has to be small enough such that the resulting subbands can not become degenerate .",
    "this is argued in more detail numerically in what follows .",
    "we are aiming to solve the hofstadter problem of a tight - binding system in a magnetic field @xcite .",
    "let us pick the landau gauge , @xmath209 , where the two components are cartesian .",
    "due to the presence of a magnetic field , the hamiltonian will couple different points in the brillouin zone .",
    "if the flux @xmath210 introduced above for the uniform synthetic field is a rational number expressed as @xmath211 with @xmath212 and @xmath213 non - negative integers which are relatively prime , then , in general , the resulting hamiltonian will couple @xmath214 to @xmath215 and to @xmath216 .",
    "this momentum space coupling can be removed by remarking that translational invariance is recovered if one reverts to a @xmath213 times larger unit cell in real space , and a @xmath213 times smaller brillouin zone , called the magnetic brillouin zone , defined for our lattice as @xmath217\\times \\left[0,\\frac{4\\pi}{a\\sqrt{3}}\\right]$ ] .",
    "the original @xmath137-band hamiltonian becomes a @xmath218-band problem defined on the reduced brillouin zone .",
    "folding of bands appears , and at a general level the @xmath218 bands are allowed to become degenerate within the magnetic brillouin zone .",
    "technical details are given in appendix [ ap_butterfly ] .",
    "for now we focus on counting the magnetic subbands obtained from a given bloch band , which provides a direct way of determining the chern number of the original ( zero field ) bands .",
    "assume for simplicity that the dimensionless flux per unit cell is @xmath219 for some positive integer @xmath220 .",
    "for large enough @xmath220 , the field is weak , and any one of the three original bloch bands will split , according to eq .",
    "( [ eq : k_splitting ] ) , into @xmath221 $ ] , where @xmath126 is the chern number on each of the three original bloch bands .",
    "this is consistent with the fact that the spectrum in a magnetic field at flux @xmath222 should exhibit @xmath223 levels . taking the band - structure at @xmath78 ( see fig .",
    "[ fig : k_bs ] ) as representative for our time - reversal symmetry broken phase with gapless edge modes , the formula in eq .",
    "( [ eq : k_splitting ] ) predicts that the lower , middle and upper bands will split into @xmath224 , @xmath220 and @xmath225 subbands , respectively .",
    "the caveat to this discussion is that for special fractions @xmath210 one can expect that the resulting subbands become degenerate even if the original system is non - degenerate @xcite .",
    "one can directly access the chern number of a specific band as follows ( see fig .",
    "[ fig : k_lowfieldspectrum ] ) : set the external synthetic field to a specific rational number dimensionless flux and count the resonant trajectories corresponding to each of the three original bloch bands ( they will be typically separated by gaps of order @xmath35 , as in the original system , if the field is weak ) . for example",
    "( see fig .",
    "[ fig : k_lowfieldspectrum ] ) , at @xmath226 , the lower , middle , and upper bloch bands split into @xmath227 = 4,5,6 $ ] subbands , consistent with their chern numbers @xmath228 , respectively .",
    "there are a total of 15 subbands , but the 5 subbands corresponding to the middle band are degenerate .",
    "importantly , at @xmath229 , the spectrum has no energy gaps , in which case chern numbers are exchanged between bands .",
    "we have proved numerically the requirement @xmath230 to probe the chern numbers of the original bloch bands .",
    "since the spectrum of the hofstadter problem is periodic in @xmath210 , this requirement actually translates to @xmath231 .",
    "when the external field is too strong , or varies too quickly , tunneling to a different band becomes possible . to be safe from landau - zener tunneling @xcite ,",
    "the magnetic field has to be small .",
    "this translates to a condition @xcite on the period of motion on a closed loop , @xmath194 , introduced in our calculation above , @xmath232 where @xmath233 is the size of the gap , which in our problem is of order the hopping energy , @xmath234 , and @xmath60 is the constant energy along the loop @xmath189 .",
    "the period of motion can be further reexpressed by making an estimate from eq .",
    "( [ eq_kcdot ] ) , @xmath235    where the averages are taken over the path @xmath86 , whose length in momentum space is denoted @xmath236 .",
    "collecting equations yields the following condition @xmath237 it turns out that this bound is independent of the lattice spacing @xmath9 or the absolute value of the hopping integral @xmath35 .",
    "for the typical values of the berry curvature etc . , the bound of eq .",
    "( [ eq_constrb1 ] ) is satisfied by taking the flux of @xmath203 , @xmath238 , which is consistent with the results in the sec . [ k_berryphase ] .",
    "in this section , we discuss the anomalous hall effects of light and evaluations of chern numbers for the clean and for the disordered case",
    ".      the experiment of sec . [ k_berryphase ] amounts to measuring line integrals of the berry gauge field @xmath239 @xcite : @xmath240    since @xmath189 is a constant energy curve in the brillouin zone , the phase can be reexpressed as a sum only over the states of the bloch band which lie below the given energy of the curve , @xmath60 , @xmath241 this value is , in general , not quantized : only after summing over the full bloch band can the phase become a multiple integer of @xmath205 .",
    "in electronic systems , the non - quantized part is the intrinsic contribution to the anomalous hall effect @xcite of a partially filled band ( non - quantized hall conductivity @xmath242 ) , and can be interpreted as a berry phase of quasiparticles at the fermi surface @xcite . in a bosonic system , we interpret this as the anomalous transport of a wavepacket whose energy overlaps with that of a bulk band .",
    "so far , we have dealt with a single bloch band . in a multiple band system",
    ", we can define the following quantity as a sum over states below some energy : @xmath243 where now the berry curvature @xmath244 is defined as in eqs .",
    "( [ eq : k_berrygauge ] ) and ( [ eq : k_berrycurvature ] ) but for the @xmath69 bloch band @xmath66 .",
    "@xmath245 is plotted in fig .",
    "[ fig : k_chern ] . when the energy @xmath60 lies in a gap",
    ", @xmath245 is an integer , and it is the sum of the chern numbers of all bands that lie below the given energy . we may rewrite this quantity in a form that is manifestly invariant under gauge transformations of bloch vectors , and will be useful as we tackle the disordered case in sec .",
    "[ k_disorder ] .",
    "we define the projector @xmath246 onto the bloch states of energy below @xmath60 .",
    "the projection operator is obtained from the bloch eigenvectors of the tight - binding problem , and is therefore @xmath154-dependent .",
    "we can rewrite eq .",
    "( [ eq : k_nue ] ) as @xmath247   \\right\\}.\\ ] ] the number @xmath245 is an integer only when the energy lies between two bulk bands without touching them , inside of a gap , and it takes non - universal values for the slightest overlap in energy with the bulk bands ( see fig .",
    "[ fig : k_chern ] ) .",
    "the quantization of this quantity corresponds to the existence of counter - propagating edge modes ( see sec .",
    "[ k_edgemodes ] ) .",
    "the detuning of the phase @xmath41 will make @xmath245 take a non - quantized value , which corresponds to edge modes that can decay into the bulk of the material .",
    "we corroborate that disorder is similar in effect to changes of the phase @xmath41 : it also spreads the middle band leading to non - quantized values of the chern number .",
    "this is explained in the next section and summarized in fig .",
    "[ fig : k_chern ] .      in this section",
    "we investigate the robustness of edge states in the disordered system .",
    "the bloch state formulation used so far can not be used since the system breaks translational invariance .",
    "to arrive at the formula for the chern number in real - space for disordered systems , we start from the clean case . the trace in eq .",
    "( [ eq : k_nue_tr ] ) can be taken with respect to the basis of states localized at each site , @xmath248 , where @xmath20 indexes a site on the lattice . in this section",
    "we return to the @xmath249 basis , as this is more useful for deriving formulae suitable for numerical computations . letting as usual @xmath250 , @xmath251 , -i[y , p(e ) ]   \\right ] | \\mathbf{r}_\\mathbf{m }",
    "\\rangle,\\nonumber \\\\ \\;\\end{aligned}\\ ] ] where @xmath252 is the fourier transform of the operator @xmath253 defined above , and projects onto states with energy below @xmath60 .",
    "the total number of sites in the system is denoted by @xmath136 . in the thermodynamic limit for a clean system , this formula is exactly that from eqs .",
    "( [ eq : k_nue ] ) and ( [ eq : k_nue_tr ] ) .",
    "its advantage is that it allows us to compute the chern number in a disordered system . in ref . @xcite it was shown that the chern number @xmath245 is an integer as long as the energy @xmath60 belongs to a gap in the spectrum .",
    "the integer value can change to a different one only if the energy @xmath60 crosses a region of extended states , such as traversing a bulk band .",
    "when the system is disordered and finite , the problem of averaging over disorder configurations arises along with that of taking the thermodynamic limit .",
    "the chern number can be defined as an ensemble average over disorder configurations @xcite @xmath254 where the disorder configurations @xmath107 are distributed according to a measure @xmath255 , and @xmath256 is the value of the chern number for the specific disorder configuration .",
    "one defines a hamiltonian @xmath257 for each disorder configuration @xmath107 , and associates the projector @xmath258 to it as in the clean case , which gives a formula for @xmath256 : @xmath259 , -i[y , p_\\delta ( e ) ]   \\right ] | \\mathbf{r}_\\mathbf{m } \\rangle , \\nonumber \\\\ & & \\;\\end{aligned}\\ ] ] where now @xmath249 are the position operators in cartesian coordinates .",
    "this equation has the property that the average over an ensemble of disorder configurations can replace the thermodynamic limit of a single system .",
    "the technical details , and reformulations suitable for numerics are reserved for the appendix [ ap : k_chern ] .",
    "we have computed the chern number for the kagome system with a flat middle band using the methods described in @xcite at @xmath48 , implemented on a lattice of @xmath260 sites , or 192 unit cells . at each point , the chern number was computed for @xmath261 disorder configurations and averaged .",
    "a white noise disorder potential ( uncorrelated from site to site ) was sampled on the lattice . for a disorder amplitude @xmath262",
    ", a random number between @xmath263 $ ] is produced .",
    "the two types of disorder that can appear on the lattice are scalar disorder , on the on - site frequencies , which we denote @xmath264 , and vector disorder on the hopping phases , denoted @xmath265 .",
    "[ fig : k_chern ] shows our results for @xmath264 between @xmath98 and @xmath266 and @xmath265 between @xmath98 and @xmath267 .",
    "the originally flat middle band spreads with disorder ; in view of sec . [ k_ldos ] , the broadening of the middle band is associated with states leaking out of the hexagonal plaquettes due to the detuning of the flux . comparatively , the role of scalar or vector disorder potentials is the same .",
    "we are not addressing here the interesting question of comparing the two types of disorder .",
    "recently it has become possible to realize , shift , and merge dirac cones in optical lattices @xcite .",
    "anisotropies on the honeycomb lattice have been studied @xcite . in the cqed realization of the kagome lattice ,",
    "anisotropies are inherent : the on - site energies @xmath268 and hopping amplitudes @xmath269 obtained after integrating passive circuit elements are generally distinct ( this is presented in detail in ref .",
    "small anisotropies leave the main features of the bandstructure intact .",
    "below is a quantiative analysis of the effects of anisotropies .",
    "dirac cones are stable due to discrete symmetries @xcite .",
    "the isotropic kagome lattice ( isotropic hopping amplitudes and site potentials ) , is symmetric under inversions with respect to the center of a hexagonal plaquette , and under rotations by @xmath75 , up to the permutation of the sublattice indices ( lattice geometry in fig . [",
    "fig : k_bs ] ) . additionally , for special values of the phase @xmath41 the system is invariant under time - reversal symmetry .",
    "these three symmetries fix the position of the dirac cones at the corners of the brillouin zone between two bands .",
    "two more dirac cones are merged at the @xmath47 point ( where the dispersion of one of the bands is flat , and of the other quadratic ) .",
    "if the rotational symmetry is broken due to anisotropy , then the dirac cones can be shifted in @xmath154-space . for strong enough anisotropy ,",
    "dirac cones meet at time - reversal invariant points in the brillouin zone , where they can annihilate .",
    "such points are the @xmath47 point and the @xmath270 points . in the example",
    "below , dirac points annihilate at the @xmath270 points .    using the notations introduced in sec .",
    "[ k_tbmodel ] , let us define @xmath271 . the hamiltonian including anisotropies is    @xmath272    which leads to the following equation for the three energy levels :    @xmath273    let us consider , for example , the case when the hopping integrals are isotropic , but there is an anisotropy between the on - site energies @xmath268 at the level of each triangular plaquette .",
    "the spectrum can become degenerate at the @xmath270 points defined by @xmath274 , @xmath275 .",
    "one has @xmath276 , @xmath277 , and @xmath278 .",
    "then for all @xmath41 , a degeneracy occurs if @xmath279 . at the other two pairs of @xmath270 points ,",
    "@xmath280 , @xmath281 and @xmath280 , @xmath282 the degeneracy occurs if the cyclic permutations of the condition above hold .",
    "this procedure allows us to produce a degeneracy between the upper and middle bands or the lower and middle bands ( although all three bands can not be degerate at the same @xmath154 ) .",
    "the values for @xmath283 necessary for this degeneracy are on the order of the hopping amplitude @xmath35 .",
    "the touching can not be lifted by varying the phase @xmath41 .",
    "the degeneracy at the @xmath270 points is quadratic in at least one direction in @xmath154-space , which is a feature of the fact that two dirac cones with linear dispersion annihilate at the time - reversal invariant point ( see , for example ref .",
    "@xcite ) . one can tune the anisotropy as to annihilate a pair of dirac cones between the lower and middle band , for example .",
    "as soon as the dirac cones have annihilated , the bands are no longer degerate and the respective gap no longer carries edge modes .    in an experiment it is plausible to consider the case of anisotropic phases @xmath284 and @xmath285 around the up - pointing and down - pointing triangular plaquettes , respectively .",
    "this arrangement maintains the requirement that there is zero flux per unit cell , and the effect will be to merely shift the dirac cones due to the anisotropy .",
    "in this section we address the stability of the topological phase in the presence of interaction effects .",
    "a host of methods have been used to show that the topological phases are stable even in the presence of interactions @xcite . at a simple perturbative level ,",
    "we show that interactions can not change the effective free particle dispersion bandstructure : they can not cause the bands to become degenerate and reopen the gap .",
    "the general argument goes as follows : if the system is in a topological phase with gaps between bulk bands , then it is enough to show that for weak enough interactions the shifts in the energy levels are smaller than the free particle spectrum gap size of order the hopping strength @xmath35",
    ".    the following are interaction hamiltonians which can be potentially implemented in arrays of resonators .",
    "the boson hubbard model was discussed , for example , in an important paper by m. p. a. fisher _ et al .",
    "the jaynes - cummings hamiltonian @xcite , on the other hand , models an interaction between lattice photons and quantum two - level systems situated at each site . both the boson hubbard model and the jaynes - cummings model exhibit a phase transition from a superfluid to a bosonic mott insulator state .",
    "both interactions are in principle realizable in a cqed experiment @xcite . for completeness",
    ", we add a brief analysis of fermionic interactions in appendix [ ap : k_fermions ] .",
    "we start with the unperturbed hamiltonian , the one presented in eq .",
    "( [ eq : k_hk ] ) , @xmath286 where the greek indices indicate the sublattice in the spinor @xmath26 . the interaction hamiltonian for the bose - hubbard model is quartic in the creation and annihilation operators @xmath287 where @xmath136 is the number of unit cells and we have used the fourier transform on each sublattice @xmath288 as @xmath289 .",
    "we would like to describe the spectrum of elementary excitations above the ground state .",
    "the minimum of the spectrum is at the @xmath47 point : the ground state of the bosonic system has all photons condensed at @xmath290 in the lowest band ( see fig . [",
    "fig : k_bs ] ) .",
    "let us denote the minimum single particle energy at the @xmath47 point by @xmath291 .",
    "in the following treatment we shall restrict to a subspace of constant particle number @xmath177 , where @xmath292 .",
    "we have denoted by @xmath136 the number of unit cells in the lattice , implying that there are @xmath293 sites , and by @xmath294 the number of condensate particles per unit cell .",
    "the spectrum of elementary excitations in the superfluid phase is determined by using the bogoliubov approximation @xcite , @xmath295 eq .",
    "( [ eq : k_bops ] ) defines the excited state operators @xmath296 .",
    "the full hamiltonian can be brought into the following form @xmath297 where @xmath298 is the total ground state energy , and the remainder describes the excitation spectrum .",
    "we shall only focus on the excitation spectrum and drop the ground state energy from our notation .",
    "the hamiltonian can be diagonalized by a bogoliubov transformation @xcite from the particle operators @xmath299 to a new set of quasiparticle operators @xmath300 , which annihilate a quasiparticle in the @xmath69 band .",
    "the details of the bogoliubov transformation are reserved for appendix [ ap : bogoliubov ] .",
    "the hamiltonian of eq .",
    "( [ eq : k_totalbh ] ) can be recast into a diagonal form from which one can extract the quasiparticle dispersions , which we denote by @xmath301 ,     ( color online ) the left panel shows the deviation of the effective quasiparticle dispersion @xmath302 ( black ) from the free particle dispersion @xmath303 ( dashed , red ) for the @xmath48 system with @xmath304 ( the plot is along the line @xmath305 ) .",
    "right panel : low energy quasiparticle spectrum exhibits linear dispersion ( magenta ) at the @xmath47 point @xmath290 ; plotted for comparison is the free particle dispersion ( light gray).,title=\"fig : \" ]   ( color online ) the left panel shows the deviation of the effective quasiparticle dispersion @xmath302 ( black ) from the free particle dispersion @xmath303 ( dashed , red ) for the @xmath48 system with @xmath304 ( the plot is along the line @xmath305 ) .",
    "right panel : low energy quasiparticle spectrum exhibits linear dispersion ( magenta ) at the @xmath47 point @xmath290 ; plotted for comparison is the free particle dispersion ( light gray).,title=\"fig : \" ]    @xmath306    in the following , we discuss the stability of the topological phase when the bose - hubbard interaction is introduced . in general ,",
    "if the interactions induce no band crossings , the chern numbers on individual bands will be conserved , and the topological phase is maintained .",
    "the hubbard interaction induced dispersion @xmath307 can only change significantly from the free particle dispersion @xmath303 of eq .",
    "( [ eq : k_evals ] ) in the vicinity of the band minimum at the @xmath47 point , where the quasiparticle has a linear dispersion ( the sound mode ) .",
    "[ fig : k_bhresult ] shows the quasiparticle dispersion in comparison to the free particle dispersion , in the flat band system at @xmath143 .",
    "as long as the bose - hubbard coupling @xmath308 is on the order of @xmath35 or smaller , the shift in the energy levels can not make the gap close and reopen , and the topological phase is protected . in the weak interaction regime , the middle flat band can acquire a dispersion : this situation is similar to the effect of detuning the hopping phase @xmath41 , or the effect of disorder .",
    "we proceed with the jaynes - cummings interaction @xcite which couples photons to quantum two - level systems at each site .",
    "the jaynes - cummings system exhibits a quantum phase transition of polaritons from a superfluid phase to a mott insulating phase @xcite , resembling that of the bose - hubbard model .",
    "the system is governed by the following hamiltonian which describes the tight - binding photons , the two - level systems , and the coupling between these @xmath309 where we have written the tight - binding hamiltonian in a more generic form as a sum over all pairs of sites , in terms of generic hopping integrals @xmath310 .",
    "note that here the on - site energies @xmath161 have been included in the diagonal terms @xmath311 . here",
    "@xmath312 are pauli ladder operators describing a two - level system at lattice coordinate @xmath145 .",
    "to characterize the stability of the anomalous hall phases in the presence of a weak ( finite ) jaynes - cummings interaction , in appendix [ ap_photoneffec ] , we find an effective low - energy hamiltonian for the photon sector @xmath313 .",
    "we consider the following limit of small conversion @xmath314 , @xmath315 this assumption is prompted by the following stability condition specific to the jaynes - cummings lattice @xcite .",
    "if the ground state energy of the single particle spectrum , @xmath291 , has a negative value , there is no mechanism to limit the number of photons that populate the ground state , and therefore the system becomes unstable .",
    "we therefore need @xmath316 , which translates to a condition that @xmath317 , where here @xmath318 is the coordination number of the kagome lattice . in a typical cqed experiment",
    ", we expect @xmath35 to not exceed @xmath36 mhz and @xmath33 to lie in the ghz range . additionally , under reasonable experimental conditions the two level system excitation energy @xmath319 and the ( renormalized ) resonator frequencies @xmath33 will both lie in the ( microwave ) ghz range .",
    "the condition that @xmath320 is sufficient to order the two - level systems in the ground state , and the determination of an effective photon - photon interaction is well motivated .",
    "this , as we show below , leads to a positive value of the hubbard coupling , i.e. a repulsive interaction .    to fourth order in the jaynes - cummings coupling @xmath314 , we obtain the following effective low - energy hamiltonian : @xmath321 where @xmath322 and @xmath323 are positive dimensionless factors which can be found in appendix [ ap_photoneffec ] and the operator @xmath324 creates a particle in the ground state of the photon tight - binding hamiltonian ( lower band at the @xmath47 point , @xmath325 ) . eq .",
    "( [ eq : effectiveqhq ] ) shows that to lowest order the interaction shifts the ( lowest ) band minimum by an amount @xmath326 .",
    "the next non - vanishing contribution appears at the quartic order .",
    "the repulsive character is obtainable under reasonable experimental conditions for the jaynes - cummings model , where both @xmath34 and @xmath319 would be in the microwave range . one way to understand",
    "the presence of a repulsive photon - photon interaction is by noting that the two - level systems are bosons with hard - core on - site repulsion .",
    "more precisely , if two - level systems are represented by bosons with interactions , the jaynes - cummings term can be absorbed by a shift of the bosonic two - level system field , and then the interaction term of the two - level systems also generates an on - site interaction for the photon in the shifted basis .",
    "the correspondence between the jaynes - cummings lattice and bose - hubbard model has also been demonstrated through a field theory approach close to the mott - superfluid transition of light @xcite . in the calculation that led to eq .",
    "( [ eq : effectiveqhq ] ) , we have considered the ground state with all photons at wavevector @xmath325 .",
    "this does not provide precise information about the range of the interaction , but it is telling that a hubbard - type repulsive photon - photon interaction can emerge . finally , as long as the perturbation @xmath314 is weak compared to the size of the gap , which is of order @xmath35 , the detuning @xmath319 , and the on - site energy @xmath34 , the interactions can not cause degeneracies , and the topological phase will be stable .",
    "motivated by the recent experimental progress in the context of arrays of electromagnetic superconducting resonators @xcite , we have investigated the anomalous hall effect of light on the kagome lattice with artificial gauge fields @xcite .",
    "the photonic system here exhibits equivalents of the quantum hall effect without landau levels , and the anomalous hall effect with a non - quantized chern number .",
    "in particular , we have shown that a topologically trivial band can affect the quantization of chern numbers as well as the robustness of the chiral edge modes .",
    "we have discussed observables which are accessible experimentally .",
    "we have introduced a method to measure berry s phases around loops of constant energy in the brillouin zone .",
    "the method is based solely on wavepacket interference and can be used to determine band chern numbers or the photonic equivalent of the anomalous hall response .",
    "it provides an alternative to a recent method proposed to measure line integrals of the berry gauge field in cold - atomic systems , which relies on the measurement of group velocities of wavepackets and a force - reversal protocol @xcite . in cqed systems",
    ", this is realized by adjusting the frequency of each resonator individually , which has become experimentally possible @xcite .",
    "it shall be noted that interference experiments can also be envisioned to probe the landau levels , emerging when placing the kagome lattice in a uniform magnetic field .",
    "an open and interesting question to investigate in the near future would be the influence of artificial gauge fields on the superfluid - mott transition of light in cqed photon - based lattices , following a similar line of thought to that used in recent theoretical investigations @xcite .",
    "recent progress in this direction has been realized in ref .",
    "@xcite where a chiral mott insulator with a gap to all excitations and staggered fluxes has been found .",
    "transport of microwave photons through cqed lattices with artificial gauge fields and disorder would be an interesting topic to explore .",
    "another relevant subject to consider more thoroughly both theoretically and experimentally is the realization of quantum impurity models exhibiting fingerprints of many - body physics such as the kondo model and spin - boson models @xcite .",
    "we acknowledge useful discussions with stephan rachel , peter orth and arun paramekanti .",
    "ap and klh are supported by the nsf through dmr-0803200 and dmr-0653377 .",
    "aah acknowledges support from the nsf grant dmr-0953475 .",
    "in this appendix we present a more detailed derivation of the results in sec .",
    "[ k_synthetic ] .",
    "this derivation starts from an idea used in ref .",
    "@xcite for square lattices .",
    "consider the time - dependent hamiltonian of eq .",
    "( [ eq : k_htau ] ) , which we reproduce here : @xmath327 we construct the solution to the schrdinger equation as follows .",
    "if the hopping is supressed , @xmath328 , then the following function solves the time - dependent schrdinger equation : @xmath329 the solution for @xmath330 is constructed from this as @xmath331 where the @xmath332 must now obey the following differential equation @xmath333 in this last equation , the @xmath310 is the tight - binding hopping integral , which takes the value @xmath334 for nearest - neighbors and zero otherwise , and @xmath335 are the phases computed in eq .",
    "( [ eq : k_phim ] ) .",
    "the perturbation has induced a time - dependent phase factor @xmath336 which we will now simplify by keeping only those parts that oscillate very slowly ( rotating wave approximation ) .",
    "we shall use the following expansion @xmath337 where @xmath338 are the bessel functions of the first kind . upon inspection of the expansion in eq .",
    "( [ eq : k_besselexpansion ] ) and of the phase @xmath335 in eq .",
    "( [ eq : k_phimtau ] ) we find that , in general , one must have the driving frequency @xmath160 be an integer multiple of the on - site frequency @xmath33 , i.e. @xmath339 , in order to obtain at least one time - independent term in the expansion .",
    "the largest contribution is obtained if we take @xmath340 .",
    "we obtain the following effective changes to the hopping amplitudes @xmath341 the ratio @xmath342 provides an additional experimental parameter to tune the hopping strength via the bessel functions of the first kind @xmath343 .",
    "the time - dependent perturbation has induced spatially dependent phases and a dressing of the hopping integral @xmath35 .",
    "these spatially dependent phases mimic the phases that would be produced by a gauge field in the minimal substitution .",
    "the fact that an additional phase is acquired along oblique bonds parallel to @xmath344 implies that at the level of each unit cell the phases will correspond to a field that is non - uniform across the unit cell .",
    "however , the total phase acquired by a photon traversing around a parallelogram unit cell of area @xmath32 , see fig . [ fig : k_bs ] , is going to be a constant equal to @xmath166 .",
    "since the uniformity of the field at the level of the unit cell can be recovered by a gauge transformation , we perform all of our calculations ( appendix [ ap_butterfly ] ) for a uniform field .      in this appendix",
    "we show the detailed calculations for the spectrum of the kagome system placed in a uniform magnetic field @xmath203 .",
    "the phase acquired by a particle along an elementary parallelogram unit cell of the kagome lattice ( see fig . [",
    "fig : k_bs ] ) is @xmath345 , where @xmath210 is dimensionless , and @xmath346 has units of inverse length .",
    "the phase acquired by a photon around the unit cell is eight times the phase acquired on a counter - clockwise loop around a triangular plaquette .",
    "let us for simplicity pick the following gauge field in the landau gauge , @xmath347 , where the two components are cartesian .",
    "due to the presence of a magnetic field , the hamiltonian will couple @xmath214 to @xmath348 and to @xmath349 . without loss of generality , we take @xmath350 .",
    "the hamiltonian reads    @xmath351    for rational values of @xmath352 , where @xmath353 are relatively prime integers , one can reduce the brillouin zone from the original @xmath354\\times \\left[0,\\frac{4\\pi}{a\\sqrt{3}}\\right]$ ] to the magnetic brillouin zone @xmath217\\times \\left[0,\\frac{4\\pi}{a\\sqrt{3}}\\right]$ ] .",
    "the couplings between different momenta disappear and we have replaced the original problem with that of a periodic one - dimensional chain of @xmath218 sites .",
    "let us take a generic wavefunction to be @xmath355 where @xmath356 creates a photon on sublattice @xmath85 at a given momentum .",
    "then the schrdinger equation is equivalent to the following set of three harper equations    @xmath357    the solution to these equations gives the spectrum of the system for every rational flux @xmath358 , and the pattern of splittings into magnetic subbands is known as the hofstadter butterfly @xcite .",
    "the spectrum of the problem is periodic in @xmath210 of period 2 , for example @xmath359 and @xmath360 systems have the same spectrum etc .",
    "this appendix is dedicated to presenting more rigorous statements behind the real - space chern number formulae of eqs .",
    "( [ eq : k_nue_r ] ) and ( [ eq : k_nuome_r ] ) .",
    "the general theory was introduced in @xcite . to keep our discussion generic and more suitable for numerics",
    ", we shall rescale our brillouin zone to @xmath354\\times \\left[0,\\frac{2\\pi}{a}\\right]$ ] .",
    "the results for the reciprocal unit cell of the kagome lattice can be adapted from the following by the introduction of the appropriate jacobian .",
    "consider a two - dimensional lattice with @xmath63 orbitals per site .",
    "we may take @xmath361 to be kets localized at each site @xmath20 , corresponding to each orbital .",
    "this amounts to a basis of the full hilbert space .",
    "the orbitals @xmath85 may represent actual orbitals , or spin , isospin due to more ions per unit cell etc .",
    "the bloch transformation is a unitary transformation that takes the hilbert space @xmath362 to a direct sum of @xmath363 spaces of @xmath63-tuples of complex numbers , @xmath364 .",
    "a ket localized at site @xmath145 transforms as @xmath365 where @xmath366 , and @xmath367 is the column vector of @xmath63 elements with the @xmath368 entry equal to @xmath369 , and the rest @xmath98 .",
    "the fourier transform of any operator @xmath370 is @xmath371    the momentum space derivatives of an operator transform as @xmath372,\\;\\ ; j = x , y,\\label{eq : noncommd}\\ ] ]    the following identity of traces has to hold for a clean infinite system @xmath373 where @xmath374 is the trace over orbitals , whereas @xmath375 is the trace over orbitals and over the sites included in a patch of the system of area @xmath376",
    ".    spatial disorder configurations @xmath107 are distributed according to a probability measure @xmath255 , which by assumption obeys the following properties .",
    "the probability measure for disorder configurations is invariant under spatial translations ( homogeneity ) ; any subset of the disorder configuration space invariant under translations is a set of measure @xmath98",
    ". these properties amount to requiring that the probability measure for disorder configurations is ergodic with respect to spatial translations .",
    "ergodicity implies that spatial and disorder configuration averages are interchangeable .",
    "the averaging in eq .",
    "( [ eq : k_nue_r ] ) can be performed over a small system with many disorder configurations to the same effect as on a system in the thermodynamic limit with a single disorder configuration ( self - averaging property ) .    for each disorder configuration @xmath107",
    ", one defines an operator @xmath377 ( for example , the hamiltonian @xmath257 ) .",
    "one can not define @xmath154-space calculus rules because the fourier transform is no longer defined , but one may replace calculus rules in the brillouin zone by the `` non - commutative '' rule @xmath378,\\;\\forall\\delta\\label{eq : ncderivative}\\ ] ]    and integration becomes @xmath379 where the trace at the origin is given by @xmath380 involving the projector @xmath381 onto quantum states at the origin @xmath382 .    with the help of such calculus rules ,",
    "the chern number in the disordered continuum becomes @xmath383,-i[y , p_{\\delta}(e)]]\\}.\\label{eq : cnprojectordisordered}\\ ] ] ref .",
    "@xcite contains a proof of the fact that this expression for an infinite system is the analytical index of a fredholm operator , and thus an _",
    "integer_. this integer can only change if the energy @xmath60 crosses a region of extended states in the spectrum , i.e. something like a bulk band . for our numerical calculations ,",
    "used the developments in ref .",
    "@xcite , which gives a fast converging formula for the chern number of eq .",
    "( [ eq : cnprojectordisordered ] ) .",
    "the brillouin torus is discretized into @xmath384 patches of momentum space area @xmath385 , and integration is approximated by riemann summation .",
    "derivatives in @xmath154-space are approximated by a finite - differences formula @xmath386,\\ ; i = x , y\\ ] ] where the coefficients @xmath387 are chosen to insure exponential convergence in the limit of large @xmath388 , and @xmath220 is an adjustable number of order @xmath388",
    ". then the chern number becomes @xmath389\\}\\delta^{2 } \\nonumber \\\\ & = & -2\\pi i\\text{tr}\\{\\oplus_{k_{n}\\in \\text{bz}}(p_{k_{n}}[\\delta_{k_{1}}p_{k_{n}},\\delta_{k_{2}}p_{k_{n}}])\\}.\\label{eq : chernnumberdiscretebz}\\end{aligned}\\ ] ]    we can now replace the derivatives in momentum space by their real - space counterparts through @xmath390 .",
    "we arrive at the final formula for the chern number @xmath391|\\mathbf{m}\\alpha\\rangle,\\nonumber \\\\ & & \\ ; \\label{eq : disorderedsystemdiscretizedchernnumber}\\end{aligned}\\ ] ] where the sum is now manifestly over a finite system .",
    "the bracket used above is derived from the original commutator @xmath392 $ ] @xmath393 and an analogous equation holds for @xmath394 .",
    "the result needs to be averaged over disorder configurations , @xmath395",
    "in this appendix we analyse a hamiltonian describing a fermionic nearest - neighbor interaction on the kagome lattice : @xmath396 the fourier transformed interaction hamiltonian reads @xmath397,\\end{aligned}\\ ] ] where @xmath136 is the number of unit cells on the lattice .",
    "we begin with the model containing a flat middle band at @xmath48 .",
    "mean - field theory is performed easily if we switch to the band basis @xmath398 , where the operators create particles of given momentum in each of the three bands , `` lower '' , `` middle '' , and `` upper '' . in the band basis , the tight binding hamiltonian @xmath399 of eq .",
    "( [ eq : k_hk ] ) describing free particles is diagonal , @xmath400 the columns of @xmath194 are the bloch eigenvectors of @xmath399",
    ". then the two bases are related by the following unitary transformation , @xmath401 at 1/3 filling , or when the lower band is completely occupied , the resulting mean - field hamiltonian amounts to simply @xmath402 while at 2/3 filling , when both the lowest and the flat band are filled , the mean - field hamiltonian takes the form @xmath403 then at mean - field level the nearest - neighbor interaction amounts to shifting the bands by an amount constant in @xmath154-space . for strong enough interactions @xmath404 , the bands will close gaps , but as long as @xmath405 , which is the size of the band gap at @xmath48 , the picture can not be changed qualitatively and the topological phase is robust to this interaction effect .",
    "the cancelation of any @xmath154-dependent shifts is a feature of the @xmath406 symmetry of the lattice .",
    "in this appendix we present a way to diagonalize the hamiltonian of eq .",
    "( [ eq : k_totalbh ] ) . the hamiltonian matrix can be written in the following basis @xmath407 with the @xmath408 operators as defined on each sublattice @xmath409 in eq .",
    "( [ eq : k_bops ] ) .",
    "@xmath410 where now the hamiltonian may be expressed as @xmath411 whose elements are @xmath412 matrices defined as @xmath413 where @xmath399 is the free particle hamiltonian in eq .",
    "( [ eq : k_hk ] ) . in the weak coupling limit @xmath414 ,",
    "the bogoliubov transformation can be performed as follows .",
    "the @xmath346 operators can be transformed to quasiparticle operators @xmath415 via a canonical transformation @xmath416 with @xmath417 defined as in eq .",
    "( [ eq : k_phib ] ) with @xmath415 replacing @xmath346 where the condition for @xmath418 to preserve the bosonic commutation relations between the @xmath415 operators , @xmath419 = \\delta_{\\alpha\\beta}\\delta_{\\mathbf{k}\\mathbf{k}'}$ ] and @xmath420 = 0 $ ] is the following pseudo - unitarity condition @xmath421 where @xmath422 is the identity acting on sublattice space and @xmath423 is the third pauli matrix .",
    "@xmath418 must diagonalize the bogoliubov hamiltonian of eq .",
    "( [ eq : k_bogoh ] ) ; let @xmath424 from the condition in eq .",
    "( [ eq : k_pseudounitary ] ) one can reexpress this as @xmath425 whence the matrices @xmath426 and @xmath427 are similar and it suffices to diagonalize the matrix @xmath428 to determine the spectrum of bogoliubov quasiparticles .",
    "in this appendix we derive an effective low - energy hamiltonian @xmath313 for the photons in the jaynes - cummings lattice model deep in the superfluid ( delocalized ) phase .",
    "the low energy state is the condensate state of @xmath177 photons and all of the @xmath293 two - level systems are in their ground state .",
    "@xmath429 creates a photon in the lowest band at wavevector @xmath154 and @xmath430 and @xmath431 is the photon vacuum .",
    "consider the regime of weak coupling between photons and two - level systems described in the main text @xmath432 under realistic experimental conditions , @xmath320 , which causes the two - level systems to be ordered in the ground state , and motivates our approach and to determine an effective photon - photon interaction starting with the ket in eq .",
    "( [ eq : k_gndstjc ] ) . defining the projector on the ground state and the projector onto all excited states of the system as @xmath433 these operators project into the subspace with @xmath177 polaritons , where @xmath434 is the polariton number .",
    "the indices @xmath145 here represent the lattice coordinates .",
    "then @xmath435 above , @xmath436 is the dispersion of the lowest band .",
    "similarly we will denote by @xmath437 the dispersion relations for the middle and upper bands , respectively , of the original tight - binding hamiltonian .",
    "the following operators are now completely specified using the equations above @xmath438 finally the projections onto excited states can be expressed simply in terms of the projector onto the ground state @xmath439 the effective low energy hamiltonian is written as @xmath440 a perturbation series in the small parameter @xmath314 can be obtained by expanding the denominator : @xmath441 \\nonumber \\\\ \\;\\end{aligned}\\ ] ] the main step is to invert @xmath442 where @xmath443 there is a basis in which the operator @xmath444 is diagonal : @xmath445 where we have introduced the operators creating a particle in the lower , middle and upper band as @xmath446 and @xmath447 , respectively .",
    "these band basis operators are related to the original operators @xmath448 etc . by a linear transformation which is written explicitly in appendix [ ap : k_fermions ] .",
    "the corresponding band dispersion relations are @xmath449 , and this form of the tight - binding hamiltonian is simply the diagonal form of eq .",
    "( [ eq : k_hk ] ) .",
    "we have now obtained a sum of decoupled hamiltonians ; the tight - binding part is already diagonal in the band basis introduced here ; the two - level system piece is already diagonal in coordinate space .",
    "let us compute the effective hamiltonian up to lowest order contribution in @xmath314 , from eq .",
    "( [ eq : expansion ] ) : @xmath450 only the terms containing @xmath451 contribute due to the projectors @xmath220 at the two ends of the second term .",
    "then we only need to take the following terms for the evaluation of eq .",
    "( [ eq : lowest ] ) : @xmath452 we have cast the denominator into a form which is diagonal with respect to both photon quantum numbers and two - level system quantum numbers .",
    "the @xmath453 of @xmath454 and the @xmath455 of @xmath456 acting on the diagonal matrix in between them will yield the projector onto the down state @xmath457 , i.e. the second term in eq .",
    "( [ eq : lowest ] ) will be a c - number times @xmath220 .",
    "more explicitly , @xmath458 then to lowest order @xmath459 , @xmath460 to retrieve the effective hamiltonian for the theory , we need to take the limit @xmath461 , i.e. this is only a valid expression close to the state ground state onto which @xmath220 projects .",
    "taking the limit above gives us an effective shift of the @xmath325 energy .",
    "peeling off the projector @xmath220 , we obtain the following effective low - energy hamiltonian : @xmath462 which shows that at lowest order the interaction shifts band minimum by an amount @xmath463 .",
    "higher order contributions yield effective interactions for the photons .",
    "the next nonvanishing contribution is in @xmath464 , and comes from the term @xmath465 after a similar calculation to the one above , we obtain the following form for this term , @xmath466 in the main text , we have denoted the ground state energy of the single particle tight - binding model as @xmath467 . peeling off the projector onto the ground state , @xmath220 , we may rewrite the effective hamiltonian @xmath313 as @xmath468 where @xmath322 and @xmath323 are dimensionless quantities defined as @xmath469 and @xmath470 , where the @xmath194 s are the elements of the unitary transformation from sublattice basis to band basis , introduced in appendix [ ap : k_fermions ] : @xmath471 for each @xmath288 .    under realistic experimental conditions , where both @xmath291 and @xmath319 are in the microwave range",
    ", one can obtain a repulsive interaction with @xmath472 .",
    "since we have only considered the ground state in which all photons are at wavevector @xmath325 , this approach does not provide precise information about the range of the interaction , but it is telling that a hubbard - type repulsive photon - photon interaction can emerge .",
    "d. j. thouless , m. kohmoto , m. p. nightingale and m. den nijs , phys .",
    "lett . * 49 * , 405 ( 1982 ) ; d.j .",
    "thouless , _ topological quantum numbers in nonrelativistic physics _",
    "( world scientific , singapore , 1998 ) ."
  ],
  "abstract_text": [
    "<S> we theoretically investigate a photonic kagome lattice which can be realized in microwave cavity arrays using current technology . </S>",
    "<S> the kagome lattice exhibits an exotic band structure with three bands one of which can be made completely flat . </S>",
    "<S> the presence of artificial gauge fields allows to emulate topological phases and induce chiral edge modes which can coexist inside the energy gap with the flat band that is topologically trivial . by tuning the artificial fluxes or in the presence of disorder , </S>",
    "<S> the flat band can also acquire a bandwidth in energy allowing the coexistence between chiral edge modes and bulk extended states ; in this case the chiral modes become fragile towards scattering into the bulk . </S>",
    "<S> the photonic system then exhibits equivalents of both a quantum hall effect without landau levels , and an anomalous hall effect characterized by a non - quantized chern number . </S>",
    "<S> we discuss experimental observables such as local density of states and edge currents . </S>",
    "<S> we show how synthetic uniform magnetic fields can be engineered , which allows an experimental probe of landau levels in the photonic kagome lattice . </S>",
    "<S> we then draw on semiclassical boltzmann equations for transport to devise a method to measure berry s phases around loops in the brillouin zone . </S>",
    "<S> the method is based solely on wavepacket interference and can be used to determine band chern numbers or the photonic equivalent of the anomalous hall response . </S>",
    "<S> we demonstrate the robustness of these measurements towards on - site and gauge - field disorder . </S>",
    "<S> we also show the stability of the anomalous quantum hall phase for nonlinear cavities and for ( artificial ) atom - photon interactions . </S>"
  ]
}