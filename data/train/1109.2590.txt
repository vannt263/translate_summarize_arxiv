{
  "article_text": [
    "in recent years the study of disk - planet interaction in protoplanetary disks , which aims at explaining the enormous diversity of the observed exoplanetary systems @xcite , has received much attention .",
    "specifically , the discoveries of jovian planets and brown dwarfs residing at both extremely tight @xcite and wide @xcite orbits challenge the current models of planet formation , and inspire studies of planetary migration driven by disk - planet interaction .    a planet embedded in a protoplanetary disk launches spiral density waves in the disk , which propagate away from the planet . gravitational interaction between these nonaxisymmetric density waves and the planet exchanges angular momentum between them ,",
    "driving type i planetary migration for a low mass planet , which can not open a gap in the disk .",
    "the timescale for type i migration is usually very short ( @xmath1 yr for planets more massive than a few @xmath2 , @xcite ) compared to the typical life time of circumstellar disks ( a few @xmath3 yr , @xcite ) , which makes planetary survival a major puzzle .",
    "several solutions to this problem have been proposed , involving magnetic fields @xcite , turbulent density fluctuations caused by magnetorotational instability ( mri ) @xcite , density traps @xcite , and co - orbital torques @xcite , to name a few .",
    "however , the majority of the theoretical calculations of type i migration do not take into account the change of the disk density profile caused by the planetary density waves @xcite .",
    "in reality , density waves carry angular momentum as they travel away from the planet .",
    "eventually , this angular momentum is deposited elsewhere in the disk , leading to the redistribution of the disk mass . for a migrating low - mass planet",
    "this density redistribution slightly enhances the disk surface density in front of the planet and reduces the density behind it , slowing down or even halting the migration @xcite .",
    "this effect is called _",
    "migration feedback_. at higher planetary masses density redistribution by planetary torques is so severe that a gap may form near the planetary orbit .",
    "this shifts the planetary migration from type i to type ii , and effectively slows the migration down , which may save planets from falling onto the central star @xcite .",
    "it is important to emphasize that the change of the state of the disk by planetary density waves can only be accomplished by virtue of some damping processes @xcite , which can be either linear or nonlinear .",
    "several possible linear wave damping mechanisms have been proposed , such as radiative damping @xcite and viscous damping @xcite .",
    "however , all of these mechanisms have drawbacks and may not be very efficient at dissipating angular momentum carried by the planet - generated density waves ( * ? ? ?",
    "* hereafter gr01 ) .",
    "gr01 proposed another wave damping process , which results from the nonlinear wave evolution into a shock .",
    "this process could serve as a universal nonlinear wave damping mechanism working at regimes where alternatives fail ( specifically , it does not require a background disk viscosity ) ( @xcite , gr01 ) .",
    "gr01 analytically investigated the nonlinear propagation of the density wave in the local shearing - sheet approximation , and predicted the dependence of the shocking length @xmath4 , the radial separation between the orbit of the planet and the point where the shock first appears , on the equation of state and the planet mass .",
    "subsequently , @xcite extended the local treatment of gr01 into the global case to include the effects of surface density and temperature variations in the disk as well as the disk cylindrical geometry and nonuniform shear .",
    "previously , @xcite have suggested the following condition for the gap opening : @xmath5 where @xmath6 is the sound speed in the disk and @xmath7 is the angular velocity of the planet .",
    "the thermal mass @xmath8 is the mass of a planet at which the hill radius and the bondi radius @xmath9 of the planet are comparable to the scale height of the gaseous disk @xmath0 @xcite . for a mmsn model ( * ? ? ?",
    "* minimum mass solar nebulae ) and @xmath10 @xmath11 where @xmath12 is the semi - major axis of the planetary orbit .",
    "gr01 found that planets with @xmath13 generate density waves which are nonlinear from the very start , and shock as soon as they are produced .",
    "their angular momentum is deposited in the immediate vicinity of the planet , within @xmath14 , leading to the surface density evolution and gap opening close to the planet . on the other hand",
    ", @xcite demonstrated that density waves produced by lower mass planets are still able to dissipate efficiently further out through the nonlinear damping , even if they are only weakly nonlinear to begin with .",
    "in fact one should expect that given enough time , even a very low mass planet at a fixed semi - major axis should be able to open a gap in an inviscid disk . based on this argument , @xcite explored gap opening mediated by the nonlinear dissipation of density waves and indeed found that the low mass planets which do not satisfy the condition  ( [ eq : mth ] ) can be capable of stalling their migration via the migration feedback and opening a gap in a low viscosity disk .",
    "however , most previous numerical studies have failed to capture gap opening by small planets ( @xmath15 ) .",
    "this is most likely because these simulations have studied flows with significant viscosity ( artificial or numerical ) . in a viscous disk",
    "there is another condition @xcite @xmath16 that has to be fulfilled simultaneously with ( [ eq : mth ] ) for the gap to open , where the effective shakura - sunyaev @xmath17 ( @xmath18 is the kinematic viscosity ) .",
    "it is quite likely that the levels of viscosity in these simulations were too high ( in particular , the numerical viscosity due to the low spatial resolution ) for the torques induced by the low mass planets to overcome viscous filling of the gap , _",
    "i.e. _ the viscous criterion ( [ eq : mvis ] ) was not fulfilled .",
    "only recently has the gr01 theory been confirmed in numerical work .",
    "@xcite first found evidence for the distance over which density waves damp to _ increase _ with decreasing @xmath19 , exactly as predicted by gr01 .",
    "subsequently , using two - dimensional hydrodynamic simulations of migration of low - mass planets in nearly inviscid disks , @xcite found the migration rate to drop due to the migration feedback .",
    "they also showed that high disk viscosity ( @xmath20 ) could wash out this effect , making fast type i migration persist .",
    "in addition , they confirmed the existence of a critical planet mass which eventually halts the migration , and found reasonable agreement with the theoretical prediction of @xcite .",
    "@xcite also investigated nonlinear wave evolution by 2d hydrodynamical simulations and confirmed that low mass planets ( a few tenths of @xmath8 ) indeed are able to open gaps in an inviscid disk .",
    "they successfully detected shock formation and density redistribution in the disk , resulting from the nonlinear wave evolution .",
    "however , these simulations investigated only _ secondary _ consequences of the nonlinear wave evolution , such as the slowdown of the migration due to migration feedback and the limit on gap opening planet mass .",
    "it is obvious from this discussion that elucidating the mechanisms of nonlinear wave dissipation in protoplanetary disks is not only interesting in and of itself , but is also crucial for understanding the migration feedback and the gap opening issue , both of which could significantly increase the planetary migration timescale . here , following ( * ? ?",
    "* here - after paper i ) , who explored the linear excitation and propagation of planet - generated density waves , we continue to investigate the evolution of density waves via numerical simulations .",
    "we now focus on the nonlinear wave evolution , and provide detailed quantitative comparisons with analytical results of gr01 .",
    "the structure of this paper is as follows . in   [",
    "sec : theory ] , we briefly summarize the main results of the nonlinear theory , and analytically study the potential vorticity generation at the shock , which we use to pinpoint the shock location .",
    "the code and numerical setup of the simulations are introduced in   [",
    "sec : code ] .",
    "we then present the main numerical results and compare them with theory in ",
    "[ sec : result ] .",
    "the effects of variation of numerical algorithms are investigated in   [ sec : variety ] , and the effect of linear damping due to viscosity is studied in ",
    "[ sec : viscosity ] .",
    "we discuss the implications for realistic protoplanetary disks in ",
    "[ sec : implications ] , and summarize main results in ",
    "[ sec : summary ] .",
    "here we briefly summarize the results of gr01 for the nonlinear density wave evolution . for a planet of sufficiently low mass ( _ i.e. _ @xmath21 ) , the excitation and initial propagation of the wave are linear processes , which are not affected by the nonlinearity . far from the planet , the wave excitation is no longer important , while the nonlinear effects start to accumulate . in the shearing sheet geometry ( as usual ,",
    "@xmath22 and @xmath23 denote pseudo - cartesian radial and azimuthal coordinates in a corotating system centered on the planet , and * @xmath24 * represents the perturbed velocity in @xmath25 plane ) gr01 have shown that under the assumption of weak nonlinearity the fully nonlinear system of fluid equation can be reduced to a single first - order nonlinear equation : @xmath26 which is the inviscid burger s equation @xcite .",
    "the dimensionless variables appearing here are related to radius , azimuth , and density contrast as follows : @xmath27 ,   \\label{eq : eta } \\\\",
    "\\chi & \\equiv &   \\frac{2^{3/4}(\\gamma+1)}{3^{3/2}}\\left|\\frac{h}{x}\\right|^{1/2 } \\frac{\\sigma-\\sigma_0}{\\sigma_0}\\frac{{m_{\\rm th}}}{{m_{\\rm p}}}~. \\label{eq : chi } \\end{aligned}\\ ] ] where @xmath0 is the scale height and @xmath6 is the sound speed of the disk , and @xmath28 is the adiabatic index in the equation of state .",
    "@xcite has demonstrated that in the case of an isothermal disk in definition ( [ eq : chi ] ) @xmath29 should be replaced with @xmath30 .",
    "however , since we are interested only in the _ weakly _ nonlinear wave evolution the assumption of @xmath31 is always made and eq .",
    "( [ eq : chi ] ) holds even in the isothermal case .    in the absence of linear damping mechanisms such as viscosity , for almost any choice of smooth initial conditions in burger s eq .",
    "( [ eq : chieqn ] ) , the solution will eventually become double - valued , which means that a shock must appear .",
    "this phenomenon is analogous to the nonlinear evolution of sound waves , except that for planetary density waves ( in the linear regime ) the conservation of the wave angular momentum flux ( amf ) and differential rotation lead to the wave amplitude _ increasing _ , and the radial wavelength _ decreasing _ with distance from the excitation point in the linear regime .",
    "both effects conspire to accelerate wave steepening , and the formation of shocks close to the planet .",
    "gr01 provided an analytical formula for the nonlinear shocking length @xmath4 : @xmath32 which indicates that if @xmath13 , the shock appears very close to planet ( @xmath33 ) , _ i.e. _ in the region where the wave excitation is taking place .",
    "gr01 also predicted that deep into the post shock regime ( @xmath34 ) the density wave profile should attain the n - wave shape @xcite .",
    "the amplitude of the n - wave scaled by @xmath35 @xmath36 and its azimuthal width @xmath37 should scale with distance from the planet as : @xmath38 where the time - like coordinate @xmath39 is defined by eq .",
    "( [ eq : t ] ) .",
    "note that @xmath40 ( stays roughly constant ) in the linear regime of wave evolution due to the angular momentum conservation .",
    "after the shock formation , the wave gradually damps out , transferring its angular momentum to the mean flow , and forcing the disk to evolve .",
    "the angular momentum flux @xmath41 carried by the wave decays in the post - shock region as ( gr01 ) : @xmath42 where the shearing - sheet geometry is assumed . in the global setting",
    "the post - shock wave evolution was investigated in @xcite .      a very useful diagnostic of the density wave evolution is provided by the so - called _ potential vorticity _",
    ", sometimes also called _ vortensity_. this quantity is defined in the shearing box coordinates as , [ eq : pv ] where @xmath43 is the fluid velocity in the frame of the shearing sheet , and @xmath44 is the unit vector perpendicular to the disk plane .",
    "the background value of this quantity for @xmath45 is @xmath46 . in an inviscid , barotropic fluid",
    ", potential vorticity is conserved everywhere , except across shocks . at",
    "the shock @xmath47 experiences a jump @xmath48 the magnitude of which depends on the strength of the shock and the orientation of the shock front with respect to the incoming flow .",
    "thus , the potential vorticity perturbation @xmath49 can be interpreted as the evidence for the appearance of shock waves and provides a useful diagnostic of the flow .    here",
    "we theoretically calculate the behavior of @xmath48 as a function of distance from the planet and planetary mass @xmath50 based on the weakly - nonlinear theory of gr01 .",
    "we start with the following expression for the jump in @xmath47 at the isothermal shock @xcite : = = ( ) ^2 ( ) , [ eq : gen_expr ] where @xmath51 is the mach number of the flow perpendicular to the shock , @xmath52 is the surface density jump at the shock front and @xmath53 is the distance along the shock .",
    "to arrive at the last expression we used the relation @xmath54 valid in the isothermal case .    we can write @xmath55^{-1/2 } \\partial/\\partial x$ ] , where @xmath56 is the theoretical shock position in the @xmath57 plane . for @xmath58",
    "we find then .",
    "[ eq : ds ] we now use eq .",
    "( [ eq : chi ] ) to relate @xmath59 to the jump across the shock @xmath60 of the function @xmath61 , satisfying the eq .",
    "( [ eq : chieqn ] ) : = ||^1/2 _ sh(t(x ) ) , [ eq : rel ] where @xmath62 is given by eq .",
    "( [ eq : t ] ) .    combining eqs .",
    "( [ eq : t ] ) , ( [ eq : gen_expr])-([eq : rel ] ) , and setting @xmath63 ( shock is weak ) in eq .",
    "( [ eq : gen_expr ] ) , we find ( x)= ^3 ||^1/2 ( ) ^3 .",
    "[ eq : dksi ] note @xmath64 only for @xmath65 , where the shock exists .",
    "( [ eq : dksi ] ) shows that potential vorticity generation is a steep function of @xmath50 : at a fixed distance @xmath66 away from the planetary orbit @xmath67 .",
    "thus , low mass planets are very inefficient at generating potential vorticity and detecting its production in numerical experiments with small planets is a non - trivial task .    using eq .",
    "( [ eq : ls - mp ] ) and setting @xmath68 we can rewrite eq .",
    "( [ eq : dksi ] ) as : ( x / l_sh)1.3 ||^1/2 ( ) ^16/5 ^3 .",
    "[ eq : dksi1 ] this particular form is natural since @xmath60 is a function of @xmath69 ( for isothermal gas ) only , as follows from eq .",
    "( [ eq : chieqn ] ) , which does not contain any free parameters .",
    "thus , a fixed @xmath70 corresponds to a unique value of @xmath39 and @xmath60 .",
    "for instance , if we choose @xmath70 ( and @xmath39 ) to correspond to the point where @xmath60 ( and @xmath48 ) attains its maximum value , the corresponding @xmath71 would scale with @xmath50 as @xmath72 .",
    "more generally , one expects @xmath73 to depend on @xmath70 _",
    "only_.    we compare these theoretical predictions with numerical results in  [ sec : pvnumerical ] .",
    "to provide quantitative comparison with analytical theory in gr01 and in  [ sec : pvtheory ] , we carry out 2d shearing box hydrodynamics simulations using athena , a grid - based code for astrophysical gas dynamics using higher - order godunov methods @xcite .",
    "the basic numerical setup is the same as in paper i , and we briefly summarize it below .    the implementation of the shearing box approximation in athena is described in @xcite .",
    "this approximation adopts a frame of reference located at radius @xmath74 corotating with the disk at orbital frequency @xmath75 , and the cartesian coordinate system @xmath25 is the same as in   [ sec : theory ] .",
    "the rate of shear corresponds to a keplerian rotation profile .",
    "the equation of state ( eos ) we use in the simulations is the ideal gas law with @xmath76 where @xmath77 is the internal energy , @xmath78 is the gas pressure , and @xmath79 .",
    "we also use an isothermal eos ( effectively @xmath68 ) , in which case @xmath80 , where @xmath6 is the isothermal sound speed .",
    "we do not include explicit viscosity except in ",
    "[ sec : viscosity ] ( _ i.e. _ no linear dissipation is present in the system ) , and we do not account for the self - gravity of the disk .    to study the accuracy and convergence of our results",
    "we have varied the numerical algorithms used to compute our simulations (  [ sec : variety ] ) . unless noted otherwise",
    ", our standard simulations use the following choices ( the same as in paper i ) : an isothermal equation of state , the roe solver with third order reconstruction in characteristic variables , and the corner transport upwind ( ctu ) unsplit integrator @xcite , a resolution of 256 grid points per scale height @xmath0 ( subsequently denoted @xmath81 for brevity ) , and fourth order accurate potential @xmath82 @xmath83 with softening length @xmath84 , where @xmath85 is the cylindrical radius counted from the position of the planet . this potential converges to keplerian at @xmath86 as @xmath87 ( which means the fractional error is o@xmath88 as @xmath89 ) .",
    "we use the following boundary conditions ( bcs , the same as paper i ) . on @xmath66 ( radial )",
    "boundaries , we keep values of all physical variables in ghost zones fixed at their respective unperturbed keplerian values ( _ i.e. _ keep the ghost zones as their initial states ) , and the waves leave through the @xmath66 boundaries when they reach the edge . on the @xmath90 ( azimuthal ) boundary , we experimented with two bcs : the conventional outflow bc , and an inflow / outflow bc . in the former case",
    "the variables in the ghost zones are copied from the last actively - updated row of cells . in the latter case ,",
    "the variables in the ghost zones are fixed at their initial values if they are the physical `` inflow '' boundaries ( the regimes @xmath91 and @xmath92 ) , or copied from the last actively - updated row of cells if they are the physical `` outflow '' boundaries ( the regimes @xmath93 and @xmath94 ) .",
    "we found that the conventional outflow @xmath90 bc accumulates some non - zero velocity perturbation on top of the pure linear shear velocity profile , while our inflow / outflow @xmath90 bc does not .",
    "this affects calculation of variables derived from the simulated velocity field , such as potential vorticity .",
    "we use the inflow / outflow @xmath90 bc for our simulations .    as in paper",
    "i , we check the level of numerical viscosity in our runs .",
    "we run a series of test simulations with otherwise identical conditions but different explicit navier - stokes viscosity , and measure the wave properties .",
    "as the explicit viscosity decreases the simulation results gradually converge to the one with zero explicit viscosity , which indicates the numerical viscosity dominates the explicit viscosity . for a typical simulation with low @xmath95 and an isothermal equation of state , the effective shakura - sunyaev @xmath96-parameter ( @xmath17 ) characterizing our numerical viscosity is found to be below @xmath97 .",
    "such small levels of viscosity are expected in dead zones of protoplanetary disks @xcite , where magnetorotational instability ( mri ) may not operate effectively @xcite . also note even then the mri operates , mhd turbulence may not act like a navier - stokes viscosity .    for the standard simulations in this work we use box size @xmath98 ,",
    "thus the overall grid resolution in our runs is @xmath99 ( for the standard resolution of @xmath81 ) .",
    "we note that these domains are larger than in paper i since we want to follow the nonlinear evolution of fluid variables deep into the post - shock regime . in a few cases with very small @xmath19 , we extend the simulation box size to @xmath100 to fit the large @xmath4 inside the box ( see eq .",
    "[ eq : ls - mp ] ) .",
    "our simulations are run for at least 10 and in some cases up to 100 orbital periods .",
    "in this section , we present our numerical results on the density wave properties in the nonlinear regime , and make detailed quantitative comparison with the theory .      the nonlinear evolution of the wave is depicted in figure  [ fig : density - decay]a , where we show the azimuthal density profile at two pre - shock locations , the theoretically predicted shocking distance @xmath4 , and four post - shock positions . in accord with linear theory , before the shock the numerical peak amplitude of the wave stays roughly constant ( we see only a slight increase with @xmath66 expected as a result of the continuing accumulation of the torque from low azimuthal wavenumber harmonics by the wave ) . at the same time",
    "the leading edge of the density profile gradually steepens as the wave propagates away from the planet . at @xmath101",
    "the leading edge becomes vertical and the wave shocks .",
    "after that the leading edge stays vertical while the height of the profile @xmath102 ( see fig .",
    "[ fig : density - decay]a for an illustration of its definition ) decreases due to the dissipation of energy and angular momentum .",
    "we note that the n - wave shape does not quite appear in our wave profile , because the second ( trailing ) shock does not emerge until very large distance ( @xmath103 ) , which our simulation boxes do not cover . nevertheless ,",
    "the leading segment of the n - wave does appear and we use its behavior to quantitatively explore the n - wave evolution . in figure",
    "[ fig : density - decay]b , we plot the dependence of @xmath102 and the azimuthal width of the wave @xmath37 ( the @xmath104 value at the mid point of the leading edge , as indicated in fig . [",
    "fig : density - decay]a ) on the coordinate @xmath62 defined by eq .",
    "( [ eq : t ] ) in the post shock regime , as well as the theoretical scaling relations ( eq . [ eq : nonlinearwave ] ) with arbitrary normalization .",
    "far in the post shock regime ( @xmath105 ) our numerical results on the n - wave behavior agree well with theory .",
    "evolution of the wave profile in the nonlinear regime was first studied by @xcite , who demonstrated the steepening of the wave profile and the decay of @xmath106 after the shock formation ( their figure 6 ) .",
    "however , they did not make quantitative comparison between the numerical results and theoretical scaling relations , as we do here .      in figure",
    "[ fig : pvimage ] we show a typical spatial patten of potential vorticity deviation @xmath107 ) from its background value in our simulations ( only one half of the simulation box is shown ) .",
    "because of the velocity shear , the fluid enters the box from the two inflow @xmath90 boundaries ( @xmath108 and @xmath109 ) with initial background @xmath110 , and maintains this value until it reaches the spiral wave . if the fluid element meets a spiral wave at @xmath111 , the shock is not crossed and the original @xmath48 value is conserved .",
    "the fluid element carries it until it leaves the simulation domain through the outflow @xmath90 boundary ( @xmath112 and @xmath112 ) .    on the other hand ,",
    "if @xmath113 , the fluid element crosses the shock , potential vorticity conservation is broken and @xmath47 gets a kick .",
    "the amplitude of the @xmath47 jump depends on @xmath114 . a larger @xmath114 results in a weaker @xmath47 jump because further from the planet the shock becomes weaker and the incidence angle of the fluid on the shock is more oblique . after the shock",
    ", the fluid element conserves the new value of @xmath47 until it leaves the box .",
    "note that @xmath47 is ill defined right at the shock front , which produces the feature along the spiral ( also visible in ( * ? ? ?",
    "* fig.1 ) ) , and the noisy structure at small @xmath115 is due to the vortex generation in the co - orbital region @xcite . measured as a function of @xmath115 at large @xmath116 , @xmath48 maintains the background value as small @xmath115 until @xmath117 , where it first grows with @xmath66 , and then gradually decreases , as the wave decays and the shock becomes weaker and weaker .    in figure",
    "[ fig : pvjump - mp]a we plot the maximum value of the vorticity jump @xmath71 ( scaled by @xmath118 to make it dimensionless ) as a function of the planetary mass @xmath19 .",
    "the value of @xmath71 was derived by varying @xmath66 at fixed @xmath119 behind the shock and finding the maximum of @xmath120 at the shock in a simulation with a given @xmath19 .",
    "analytical calculation of @xmath48 generation in  [ sec : pvtheory ] based on weakly nonlinear theory of gr01 predicts that @xmath121 .",
    "however we find that our results are fit marginally better by the dependence @xmath122 over more than 2 orders of magnitude in planetary mass .",
    "this result confirms the low efficiency of the potential vorticity excitation by low - mass planets .    in figure",
    "[ fig : pvjump - mp]b we plot the full radial profiles of @xmath48 produced after a single shock crossing for three different @xmath19 . for better graphic representation ,",
    "we smooth the @xmath47 curve by averaging value over @xmath123 in @xmath66 to reduce the noise .",
    "we display the data scaled by @xmath124 as a function of @xmath125 .",
    "the exponent @xmath126 of the mass scaling is the same as in figure [ fig : pvjump - mp]a so that the resultant curve has a universal shape , independent of @xmath19 .",
    "one can see that , as expected , @xmath48 stays close to zero for @xmath127 , i.e. prior to the appearance of the shock . at the shock @xmath48 very rapidly ( within radial distance @xmath128 ) attains its maximum value , as the shock front develops .",
    "subsequently @xmath48 decreases because the shock rapidly weakens with increasing @xmath66 : its amplitude is reduced by the dissipation and also the shock becomes more oblique to an incoming flow . as stated in ",
    "[ sec : theory ] far from the planet shock evolves into an n - wave with @xmath61 decaying from eq .",
    "( [ eq : rel ] ) with @xmath102 defined by eq .",
    "( [ eq : delta ] ) . ] as @xmath129 , see eqs .",
    "( [ eq : t ] ) and ( [ eq : nonlinearwave ] ) . as a result , according to eq .",
    "( [ eq : dksi1 ] ) , at @xmath34 the amplitude of @xmath48 should generally decrease @xmath130 .    at smaller @xmath131 @xmath60",
    "does not obey the n - wave scaling and decays with @xmath66 rather slowly , as can be directly seen from figure [ fig : density - decay]b , where @xmath102 acts as a proxy for @xmath60 .",
    "also , at these separations the factor in square brackets in eq .",
    "( [ eq : dksi ] ) varies in a non - trivial fashion .",
    "initially @xmath132 is small , see figure [ fig : density - decay]b , and the factor in square brackets ( as well as the @xmath48 ) is positive .",
    "however , at large separations n - wave evolution results in @xmath133 and the factor in square brackets approaches @xmath134 , making @xmath48 negative . from our numerical calculations we find that @xmath48 changes sign at @xmath135 .",
    "this result agrees well with numerical calculations of other authors @xcite .",
    "previously , potential vorticity generation at the shock was studied by @xcite , who focused on the co - orbital region of the protoplanet , and by @xcite , who numerically investigated the dependence of potential vorticity on spatial resolution in 2d inviscid disks .",
    "both studies addressed the flow instability caused by the potential vorticity generation .",
    "recently , @xcite explored the time evolution of the potential vorticity and its dependence on @xmath136 .",
    "@xcite also studied the possibility of using potential vorticity to identify the shock formation in an attempt to verify the theoretical @xmath137 scaling relation in gr01 .",
    "however , their potential vorticity profiles were rather noisy preventing meaningful quantitative comparison .",
    "@xcite investigated the potential vorticity generation by a massive planet ( @xmath13 , so the wave shocks immediately after being excited ) .",
    "they followed fluid elements on horseshoe orbits , and confirmed that the potential vorticity is generated as material passes through the two spiral shocks . in a global cylindrical geometry employed in their work",
    ", a fluid element gets a kick in the potential vorticity every time it passes a spiral shock , so the potential vorticity in the simulation box increases with time .",
    "this is also the case in our 2d local shearing sheet geometry when we switch the @xmath90 boundary condition to periodic .",
    "however , while in @xcite the potential vorticity stops increasing and reaches a plateau after @xmath138 orbits , in our low mass planet ( @xmath21 ) and high resolution cases we do not see this saturation . in one experiment with 100 orbits ,",
    "our @xmath48 linearly increases with time throughout the entire simulation time .",
    "it is not clear what causes this difference , but we suspect that the low resolution ( which introduces larger numerical viscosity ) might be responsible for it in the @xcite case .      in linear regime ,",
    "the density wave evolution does not depends on the equation of state , as long as the sound speed of the gas is fixed .",
    "however , the eos has a prominent effect in the nonlinear regime , which results in a dependence of the shock location on @xmath28 ( eq . [ eq : ls - mp ] ) .",
    "we show in figure  [ fig : eos ] the radial @xmath48 profiles for two simulations with otherwise identical parameters ( including the sound speed ) but with different eos ( @xmath68 and @xmath79 ) .",
    "there are two major differences between them .",
    "first of all , @xmath4 for the two cases are different , with larger @xmath28 resulting in earlier shock .",
    "the difference between @xmath4 in two cases is consistent with the theoretical prediction for these @xmath28 ( @xmath139 ) .",
    "second , the peak @xmath48 value in the @xmath79 case is about @xmath140 higher than in the @xmath68 case . on the other hand , the decay of the @xmath48 profiles is qualitatively similar for different eos .",
    "one of the most important results of the analytical theory by gr01 is the relation ( [ eq : ls - mp ] ) between the shocking length @xmath4 and the mass of the planet @xmath19 .",
    "this relation plays a central role in the calculation of every process driven by the nonlinear evolution , such as the migration feedback and gap opening @xcite .",
    "here we provide the numerical confirmation of this relation , as shown in figure  [ fig : ls - mp ] .",
    "we define the shock location as the value of @xmath66 at which @xmath47 reaches half of its maximum value at the jump .",
    "the numerical data points nicely agree with the theoretical expectation @xmath141 for about _ 2.5 orders of magnitude _ in @xmath19 , with deviation @xmath142 for most of the @xmath19 range .",
    "the smallest @xmath19 presented here ( @xmath143 ) corresponds to @xmath144 lunar mass and the largest @xmath19 ( @xmath145 ) corresponds to @xmath146 at 1 au for a mmsn model .",
    "the numerical result deviates from theory at the largest @xmath19 as expected , because the wave excitation and the shock formation regions are no longer separated there .",
    "at the small @xmath19 end we also see a trend of deviation from theory .",
    "this is because the nonlinearity for such low - mass planets is so small that the linear dissipation due to numerical viscosity becomes non - negligible and starts to damp the wave prior to the theoretically expected location ( see discussion in   [ sec : viscosity ] ) .",
    "we expect that modeling the disk at even higher resolution than we have ( @xmath81 ) or more accurate algorithms will resolve this problem (   [ sec : variety ] ) .",
    "previous attempts to verify @xmath137 relation ( [ eq : ls - mp ] ) were pioneered by @xcite , who inferred @xmath4 from the width of the gap opened by the planet .",
    "they found @xmath4 to _ increase _ with decreasing @xmath19 , in agreement with gr01 theory .",
    "however , the resolution of his simulations was insufficient for quantitative verification of eq .",
    "( [ eq : ls - mp ] ) .",
    "subsequently , @xcite confirmed @xmath137 relation using potential vorticity as means of shock detection .",
    "their calculations spanned only about an order of magnitude in @xmath19 and were not fully converged ( _ e.g. _ in terms of softening length @xmath136 ) .",
    "since their simulations were run in cylindrical geometry , @xcite found @xmath4 in the inner disk to be smaller than in the outer disk .",
    "this is to be expected , since global shear rate is higher in the inner disk , which causes faster nonlinear evolution there in agreement with @xcite . nevertheless , the results of @xcite for @xmath137 relation are in reasonable quantitative agreement with eq .",
    "( [ eq : ls - mp ] ) of this paper .",
    "the spatial patten of the decay of the angular momentum flux carried by the density wave determines how the disk will respond to the presence of the protoplanets , which subsequently determines the efficiency of the density feedback and the gap opening .",
    "gr01 studied the post - shock amf decay , and predicted the asymptotic behavior of amf at large distance ( eq . ( [ eq : amf - decay ] ) , also see figure 3 in gr01 . ) .",
    "numerically , we calculate the amf as : @xmath147 where @xmath148 and @xmath149 are the azimuthal and radial velocity perturbation of the fluid with respect to the background shear profile . in theoretical calculation",
    ", gr01 showed that @xmath41 is given by @xmath150 \\label{eq : action}\\ ] ] where the dimensionless amf @xmath151 is defined as @xmath152 and @xmath61 , @xmath153 , and @xmath39 are defined in eqs .",
    "( [ eq : t]-[eq : chi ] ) . here",
    "we follow their notation and measure @xmath151 from our simulations by calculating @xmath41 and using eq .",
    "( [ eq : action ] ) .",
    "we plot the numerically measured @xmath154 in figure  [ fig : amf - decay ] for three different values of @xmath19 .",
    "our numerical results agree well with the theoretical prediction at large distance after the shock , which is the working range of the theory , showing that the amf decay is indeed close to @xmath155 . to the left of the theoretical shocking distance",
    "is the linear evolution regime , where amf increases as the wave accumulates angular momentum .",
    "note that in the linear region , a pattern of amf increase with @xmath66 should not depend on @xmath19 .",
    "the apparent dependence is because @xmath39 in figure  [ fig : amf - decay ] has been scaled by @xmath156 . at @xmath4",
    "the wave amf stops increasing and starts to dissipate . to the right of @xmath4 , in the nonlinear regime",
    "the patten of amf decay with @xmath66 does depend on @xmath19 .",
    "however , we remove this dependence and make the amf decay pattern independent of @xmath19 by using @xmath39 instead of @xmath66 in figure [ fig : amf - decay ] .",
    "in this section , we investigate the impact of various numerical algorithms on the nonlinear wave evolution and the subsequent shock formation by looking at their effect on the generation of potential vorticity .",
    "the algorithms we explore are the same as in paper i , as shown in table  [ tab : parameter ] , and values corresponding to our standard case are indicated in boldface .",
    "figure  [ fig : pv - variety ] shows the radial @xmath48 profile for different values of various numerical algorithms , and we discuss the effect of each of them in detail below .",
    "lc riemann solver ( flux function ) used & * roe * , hllc + order of accuracy & 2 , , 3p + boundary conditions in @xmath90 & outflow , * inflow / outflow * + resolution of the simulation ( cells per @xmath0 ) & 64 , 128 , * 256 * + planetary potential ( see  [ sec : code ] ) & @xmath157 , @xmath158 , @xmath159 + softening length & 1/8 , 1/16 , * 1/32 * + equation of states of the fluid & @xmath160 , @xmath79 + mass of the planet ( 0.01@xmath8 ) & 66.7 , 24.2 , 11.8 , 4.28 , 2.09 , 1.20 , 0.757 , 0.369 + [ tab : parameter ]      in our simulations we compare two different riemann solvers  roe s linearized solver ( @xcite ) and hllc @xcite  with three different algorithms for the spatial reconstruction step @xcite : second order with limiting in the characteristic variables ( denoted 2 in this work ) , which is the predominant choice in literature in this field , and third order with limiting in either the characteristic variables ( 3c ) , or in the primitive variables ( 3p ) .",
    "similar to their effect in the linear regime ( paper i ) , the two kinds of solvers yield almost identical results on the @xmath48 profile .",
    "on the other hand , different orders of accuracy do make significant differences .",
    "3p accuracy ( not shown in this figure ) introduces large high frequency fluctuations on @xmath48 profile compared to 2 and 3c accuracy .",
    "for the two spatial reconstruction steps with limiting in the characteristic variables , as shown in figure  [ fig : pv - variety]a 2 accuracy generates a much smoother rise of the @xmath48 profile around @xmath4 , compared with the sharp jump in the 3c accuracy case .",
    "in addition , 2 case advances shock formation , causing the numerical @xmath4 to disagree with theoretical prediction ( [ eq : ls - mp ] ) .",
    "analogous to paper i , we find that the effect of reducing the accuracy from third order to second order is very similar to reducing the resolution by a factor of 2 .    a critical ingredient to any total variation diminishing ( tvd ) reconstruction scheme , as are used in athena , are the slope limiters used to ensure monotonicity .",
    "we have not explored the use of different limiter in this work , but this may affect the accuracy of the 3p and 3c methods .      resolution has a strong influence on the shock formation , as shown in figure  [ fig : pv - variety]b .",
    "lower resolution considerably accelerates shock formation , causing @xmath4 to deviate from the theoretical prediction .",
    "furthermore , the shape of the rising edge of the @xmath48 profile depends on resolution .",
    "increasing resolution steepens the edge of the @xmath48 curve , and eventually makes it almost vertical in the case of @xmath81 ( which is a sign that the convergence on resolution has been achieved ) .",
    "we also find that at low resolution ( @xmath161 in our case ) , the @xmath48 profile always demonstrates a double peaked structure , which is a purely numerical artifact .",
    "following paper i , we test the sensitivity of our results to the specific method of potential softening , and try three different forms of the softened planetary potential .",
    "one of them is the second order potential defined as @xmath162 which converges to @xmath163 at @xmath86 as @xmath164 ( which means the fractional error is o@xmath165 as @xmath89 ) .",
    "this is the potential most commonly used in numerical hydrodynamic studies .",
    "we also studied the fourth order potential ( eq . [ eq : phi4 ] ) , converging to the point mass potential as @xmath87 for @xmath86 , and the sixth order potential : @xmath166 converging to @xmath167 as @xmath168 at @xmath86 .",
    "we also varied softening length @xmath136 at fixed form of the potential .",
    "the effect of various @xmath169 is shown in panel ( c ) , and that of different @xmath136 in panel ( d ) .",
    "we find that switching to @xmath169 one level higher in accuracy increases @xmath170 by @xmath171 , steepens the edge of the @xmath48 profile , and slightly advances the shock formation .",
    "reducing @xmath136 by a factor of 2 has quantitatively similar effects .",
    "but in general the variation of @xmath169 and @xmath136 has far less prominent effect on the @xmath48 evolution than the accuracy of solver and resolution .",
    "based on this discussion we can state that in order to accurately follow the nonlinear wave evolution and capture the shock formation , it is crucial to use high order of accuracy of the numerical solver , and high spatial resolution .",
    "simulations which do not satisfy these criteria may be affected by numerical artifacts and may not be able to resolve properly either the nonlinear wave evolution or its consequences  the migration feedback and the gap opening .",
    "nonlinear evolution of density waves launched by the low - mass planets can be significantly affected by linear damping even if the latter is due to numerical viscosity .",
    "this is because the time it takes for nonlinearity to have an effect is longer for smaller @xmath19 , which enhances the relative contribution of the linear wave damping .    to explore the effect of linear damping on nonlinear wave evolution ,",
    "we carry out an experiment with explicit navier - stokes viscosity .",
    "we choose kinematic viscosity @xmath18 to correspond to reynolds number @xmath172 .",
    "this is equivalent to having effective shakura - sunyaev @xmath173 .",
    "we compare the results with another simulation under otherwise identical conditions but without explicit viscosity ( our numerical viscosity is at least 10 times smaller in this case , which corresponds to shakura - sunyaev @xmath174 ) .",
    "the results of the comparison are shown in figure  [ fig : viscosity ] .",
    "as discussed in paper i , before the shock the numerical amf and accumulated torque calculations should agree with each other , because of the angular momentum conservation .",
    "after the shock formation , dissipation damps the wave and transfers the angular momentum from the wave to the local disk material causing the amf to drop below the accumulated torque curve .",
    "accumulated numerical torque in our simulations is calculated as : @xmath175 and its asymptotic value in the linear case is ( gt80 ) : @xmath176    as shown in the panel ( a ) , while in the inviscid case this deviation happens right at the theoretically predicted shocking length ( @xmath177 ) , in the viscous case amf starts to deviate from the @xmath178 much earlier ( at @xmath179 ) .",
    "this indicates that dissipation happens earlier in the viscous case due to the linear damping , which then must be reflected in the disk density redistribution , eventually affecting migration feedback and gap opening .",
    "in addition , panel ( b ) shows that in viscous case @xmath48 starts to rise from zero much earlier than in the inviscid case , also indicating premature dissipation .",
    "furthermore , the rise of @xmath48 in the viscous case is very gradual , in contrast to the sharp jump in the inviscid case , and the peak @xmath170 is also significantly reduced ( by a factor of @xmath144 ) .",
    "the combination of the two effects makes the shock detection very ambiguous in the viscous case .",
    "we note that normally disks with @xmath180 are considered to have very low viscosity , if not inviscid .",
    "however , as we show here , the physics of the nonlinear density wave evolution is very subtle so that even an @xmath180 viscosity can dramatically affect wave damping . in simulations which aim at investigating the nonlinear wave evolution , the low spatial resolution ( @xmath181 , typically employed in the literature )",
    "will likely introduce high numerical viscosity .",
    "this is likely to give rise to inaccurate numerical results in a way similar to our viscous simulation shown here , and via the improperly captured back reaction on the disk density distribution , affect the description of the migration feedback and gap opening .",
    "the analytical and numerical calculations presented in this work directly apply only to the case of a 2d , laminar disk , containing a single low mass planet .",
    "we now discuss the applicability of our results to more realistic protoplanetary disks .",
    "first , we note that for typical @xmath182 values of protostellar disks ( on the order of 0.1 , @xcite ) , the size of the radial domain in this work ( up to @xmath183 on one side ) would imply global disk dimensions , which might be seen as contradictive to the essence of the shearing box simulation .",
    "however , our numerical calculation is an idealization needed for checking the gr01 theory .",
    "extensions of the gr01 theory to the global case are available in @xcite , with which global simulations should be compared .",
    "here we just point out that qualitatively things are the same in the global case .",
    "excitation of density waves by planets in fully three - dimensional ( 3d ) disks has been previously investigated by a number of authors @xcite .",
    "these studies have generally shown that disks with vertical thermal stratification do not support the modes similar to the modes existing in a purely 2d disk @xcite .",
    "thus , the results of our study can not be directly applied to such thermally stratified disks .",
    "however , protoplanetary disks at advanced stages of planet formation are expected to be passive @xcite , heated predominantly by the radiation of their central stars with only negligible contribution from accretional energy release . because of the external illumination",
    "such disks are expected to be vertically isothermal .",
    "it was previously found @xcite that in vertically isothermal disks planetary gravity always very effectively excites the two - dimensional mode with no vertical motion , which is similar to the density wave in a 2d disk studied here . even though other modes with non - zero vertical velocity perturbation are also excited by the planet in 3d isothermal disks ,",
    "these modes are found to carry only a small fraction of the total angular momentum flux @xcite .",
    "thus , density wave excitation and nonlinear dissipation in realistic passive protoplanetary disks should be very similar to the picture outlined in gr01 and this work .",
    "the assumption of the laminar inviscid background flow in the disk used in this work may be violated in realistic protoplanetary disk if it is strongly turbulent , e.g. due to the operation of the magnetorotational instability ( mri ) . however",
    ", this instability and associated deviations from the purely laminar flow are expected to be greatly suppressed in the so - called `` dead zones '' of protoplanetary disks @xcite , which are so weakly ionized that the operation of mri is not supported there because of non - ideal mhd effects @xcite .",
    "these zones are expected to extend over the several - au wide region where planet formation is expected to occur @xcite and in this part of the disk our results obtained under the assumption of laminar flow should be applicable .",
    "one should also mention that because of the suppressed viscous dissipation inside the dead zone the assumption of a vertically isothermal thermal structure of these regions is well justified .",
    "protoplanetary disks may easily host a number of protoplanets simultaneously and one may wonder whether the overlap of the density waves excited by different objects can have some effect on their evolution .",
    "this effect is not important in the limit of low mass planets @xmath184 explored in this work since the density waves excited by such objects are only _ weakly _ nonlinear . as a result ,",
    "the possible overlap of such density waves is , to a good approximation , just a linear combination of the independent density waves excited by individual planets . to summarize",
    ", the results of our work should directly apply at the very least to the density wave evolution in low viscosity regions ( `` dead zones '' ) of passive protoplanetary disks heated predominantly by their central stars .",
    "we present a numerical study of the nonlinear density wave evolution , based on 2d local shearing box hydrodynamical simulations using the grid - based code athena .",
    "the nonlinear wave evolution plays an important role in the disk - planet interaction and planetary migration .",
    "it provides an efficient and robust wave damping mechanism , working in regimes where linear dissipation mechanisms fail , and leading to gap opening by very low mass planets ( @xmath185 ) .",
    "nonlinear wave evolution leads to shock formation , wave damping , and transfer of the angular momentum carried by the wave to the local disk material .",
    "the latter drives global disk evolution by redistributing the mass in the disk , and leads to the migration feedback and gap opening .",
    "we analytically study the potential vorticity generation at the shock location , and verify our calculation numerically .",
    "the scaling relation between @xmath170 and @xmath19 derived from the simulations is very close to the analytical result .",
    "we use the jump in potential vorticity as a way of pinpointing the shock location , based on which we numerically confirm with high accuracy ( better than @xmath186 in most of the @xmath19 range ) the theoretically predicted @xmath137 relation for @xmath19 varying by 2.5 orders of magnitude , from few lunar masses to several earth masses at 1 au .",
    "in addition , the theoretical dependence of the shocking length @xmath137 relation on the equation of state of the gas is also verified .",
    "we investigate the evolution of the density wave profile in the post - shock regime , and observe its evolution towards the n - wave shape .",
    "we verify the theoretical prediction for the evolution of the peak amplitude and the azimuthal width of the n - wave .",
    "the post - shock decay of the angular momentum flux carried by the wave also agrees with theory .",
    "furthermore , the effect of various numerical algorithms on the simulation results is explored , including numerical solver and its accuracy , resolution , planetary potential and the softening length .",
    "we find that in order to accurately follow the nonlinear wave evolution and capture the shock formation , high order of accuracy for the solver and high resolution are crucial .",
    "simulations which do not satisfy these criteria will have trouble resolving shock formation and post - shock wave evolution driven by nonlinearity .",
    "the latter may further affect the consequences of the nonlinear wave evolution , such as the migration feedback and gap opening by low mass planets .",
    "in addition , we find that the linear viscous damping strongly affects shock formation and the nonlinear wave evolution . using an experiment with explicit viscosity , we find that the viscosity at the level of @xmath187 can strongly modify the generation of potential vorticity at the shock , and accelerate the dissipation of the angular momentum carried by the wave . in low resolution simulations ,",
    "the resulting high numerical viscosity may lead to similar effects on the nonlinear wave evolution and negatively impact the results on disk - planet interaction and planetary migration .",
    "we are grateful to jeremy goodman , takayuki muto , mikhail belyaev , cristobal petrovich , and an anonymous referee for useful discussions and comments .",
    "the financial support of this work is provided by nsf grant ast-0908269 , and a sloan fellowship awarded to rrr ."
  ],
  "abstract_text": [
    "<S> we investigate numerically the propagation of density waves excited by a low - mass planet in a protoplanetary disk in the nonlinear regime , using 2d local shearing box simulations with the grid - based code athena at high spatial resolution ( 256 grid points per scale height @xmath0 ) . </S>",
    "<S> the nonlinear evolution results in the wave steepening into a shock , causing damping and angular momentum transfer to the disk . on long timescales </S>",
    "<S> this leads to spatial redistribution of the disk density , causing migration feedback and potentially resulting in gap opening . </S>",
    "<S> previous numerical studies concentrated on exploring these secondary phenomena as probes of the nonlinear wave evolution . here </S>",
    "<S> we focus on exploring the evolution of the basic wave properties , such as its density profile evolution , shock formation , post - shock wave behavior , and provide comparison with analytical theory . </S>",
    "<S> the generation of potential vorticity at the shock is computed analytically and is subsequently verified by simulations and used to pinpoint the shock location . </S>",
    "<S> we confirm the theoretical relation between the shocking length and the planet mass ( including the effect of the equation of state ) , and the post - shock decay of the angular momentum flux carried by the wave . </S>",
    "<S> the post - shock evolution of the wave profile is explored , and we quantitatively confirm its convergence to the theoretically expected n - wave shape . </S>",
    "<S> the accuracy of various numerical algorithms used to compute the nonlinear wave evolution is also investigated : we find that higher order spatial reconstruction and high resolution are crucial for capturing the shock formation correctly . </S>"
  ]
}