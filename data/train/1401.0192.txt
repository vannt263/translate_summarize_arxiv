{
  "article_text": [
    "a centroidal voronoi tessellation ( cvt ) with respect to a probability ( or mass ) distribution is a voronoi tessellation of a set of ( generating ) points in @xmath4 ( centers of mass ) such that each generating point is the centroid of its corresponding voronoi region with respect to this density function .",
    "this definition can be extended to more general probability measures , typically those assigning no mass to hyperplanes to avoid ambiguity on the boundaries of the voronoi regions .",
    "cvts enjoy very natural optimization properties , especially in connection with vector quantization ( see further on ) which makes them very popular in various scientific and engineering applications including art design , astronomy , clustering , geometric modeling , image and data analysis , resource optimization , quadrature design , sensor networks , and numerical solution of partial differential equations .    for modern applications of the cvt concept in large - scale scientific and engineering problems ,",
    "it is important to develop robust and efficient algorithms for constructing cvts in various settings .",
    "historically , a number of algorithms have been studied and widely used . however , the pioneering contribution is undoubtedly the procedure first developed in the 1960s at bell laboratories by s. lloyd .",
    "it remains so far , in its randomized form , one of the most popular methods due to its effectiveness and simplicity .",
    "let us begin with a more detailed description of the cvt .",
    "first assume that the probability distribution , say @xmath5 , on @xmath6 , has a support included in a closed convex set with non empty interior denoted @xmath7 of @xmath4 .",
    "also , note that , up to a reduction of the dimension @xmath8 , one may always assume that @xmath7 has a nonempty interior .",
    "a voronoi diagram ( or partition ) of @xmath7 refers to a borel partition @xmath9 of @xmath10 induced by a set @xmath11 of @xmath3 given _ generating points _ or _ generators _ ( the notation @xmath12 also refers to the application to numerics where the set of generators is also called a _ grid _ ) . for every @xmath13 , the _ voronoi region _ ( or _ cell _ ) @xmath14 satisfies @xmath15 where @xmath16 denotes the canonical euclidean norm on @xmath4 .",
    "then @xmath17 so that the @xmath14 have convex interiors and closures . the family of closures is also known as _",
    "voronoi tessellation _ of @xmath7 induced by @xmath12 and the @xmath18 , @xmath19 are called _ tessels _ ) .",
    "furthermore they have a polyhedral structure , in particular their boundaries are contained in @xmath20 where @xmath21 is the median hyperplane of @xmath22 and @xmath23 .",
    "of course , a notion of voronoi regions can be defined with respect to any norm @xmath3 on @xmath4 but the above ( polyhedral ) convexity properties fail ( see @xmath24  @xcite , chapter  1 ) for non euclidean norms .",
    "we will often assume that @xmath5 is _ strongly continuous _ in the sense that it assigns no mass to hyperplanes ( so is the case if @xmath5 is absolutely continuous @xmath25 @xmath26 where @xmath27 is a probability density function defined on @xmath4 whose support is contained in @xmath7 ) .",
    "then the boundaries of the voronoi regions are @xmath5-negligible so that we can define in a unique way the _ centroids _ @xmath28 , @xmath19 of the voronoi regions by setting @xmath29 note that , owing to the convexity of the voronoi cells @xmath30 and the finiteness of the measure @xmath5 , one has @xmath31 ( closure in @xmath7 ) for every @xmath13 . from a more probabilistic point of view , if @xmath32 denotes an @xmath4-valued random vector with distribution @xmath33 , then ( with an obvious convention when @xmath34 ) @xmath35 this naturally leads to the definition of a cvt which is but a voronoi tessellation whose generators @xmath22 are the centroids of their respective voronoi regions . with the notation given above , the lloyd algorithm for constructing cvts",
    "can be described more precisely by the following procedure .",
    "the paradigm of lloyd s algorithm is to consider the definition of cvt as a fixed point equality for the so - called _",
    "lloyd map _ @xmath36 defined on the set of @xmath7-valued grids @xmath12 with at most @xmath3 values by  , @xmath25 @xmath37 as mentioned above , @xmath38 since the voronoi tessels are convex and @xmath5 is probability distribution .",
    "note that , furthermore , if @xmath39 or if @xmath5 is contain , ious ( assigns no mass to hyperplanes ) then , a supporting hyperplane argument shows that @xmath40 ( interior in @xmath7 ) for every @xmath19 ( see further on  lemma  [ lem : nomerge ] , see also  @xcite , p.22 ) .",
    "in particular , @xmath41 and @xmath12 have the same size @xmath3 .",
    "the lloyd algorithm is simply the formal fixed point search procedure for the lloyd map @xmath42 starting from a given grid @xmath43 of full size @xmath3 @xmath25 @xmath44    * algorithm 1 ( lloyd s algorithm for computing cvts ) * :    @xmath45 _ inputs _ :",
    "* @xmath7 , the domain of interest ; * @xmath5 a probability distribution supported by @xmath7 ; * @xmath46 , the initial set of @xmath3 generators .",
    "@xmath45 _ pseudo - script _ :    formally , at the @xmath0^th^ iteration , one has to proceed as follows :",
    "1 .   construct the voronoi tessellation @xmath47 of @xmath7 with the grid of generators @xmath48 .",
    "2 .   compute the @xmath5-centroids of @xmath47 as the new grid of generators @xmath49 .",
    "@xmath45 repeat the iteration above until some stopping criterion is met to provide a grid of generators as close as possible of a @xmath5-centroid .",
    "@xmath45 end .    in @xmath50-dimension",
    ", kieffer has proved in  @xcite that @xmath42 is contracting if @xmath5 has a @xmath51-concave density over a compact interval so that only one @xmath5-centroid with @xmath3 points exists for such distribution and the above procedure converges exponentially fast toward it .",
    "see also , more recently a convergence result in  @xcite .    in practice ,",
    "these two steps become intractable in higher dimension by analytic or even deterministic approximation methods , say when @xmath52 or @xmath53 ( see however the website _ qhull _ : www.qhull.org ) .",
    "so this theoretical procedure has to be replaced for numerical purpose by a randomized version in which :     step 1 is replaced by a systematic nearest neighbour search of simulated random @xmath5-distributed vectors .",
    " step 2 is replaced by a _",
    "monte carlo estimation _ of both terms of the ratio which define the lloyd map .    in the community of data analysis , note that when @xmath54 is the empirical measure of a @xmath7-valued data set @xmath55 , it is still possible to define and compute the lloyd map ( using appropriate conventions like @xmath24 random allocation of points lying on the boundary of ( closed ) voronoi tessels ) .",
    "in such a case the lloyd procedure is known as the forgy algorithm or the batch-@xmath0-means procedure . when the data set is so huge that a uniform sampling ( of size @xmath56 ) of the dataset is necessary at each iteration , the procedure is known as the @xmath0-means procedure .    in this paper",
    "we will focus on the converging properties of the theoretical ( or _ batch _ in the data - mining community ) lloyd procedure , prior to any randomization or approximation , although we are aware that in higher dimension for continuous distributions @xmath5 , it is a _ pseudo - algorithm_. so far we have presented the lloyd procedure in an intrinsic manner .",
    "in fact lloyd s algorithm is deeply connected with the theory of optimal vector quantization of probability distribution .",
    "this connection turns out to provide very powerful tools to investigate its convergence properties .",
    "it is also a major field of application when trying to compute with a sharp accuracy optimal quantizers of simulatable distribution arising in the design of numerical schemes for solving nonlinear problems ( optimal stopping problems , ( possibly reflected ) backward stochastic differential equations , stochastic control , etc , see  @xcite ) .",
    "quantization is a way to discretize the path space of a random phenomenon : a random vector in finite dimension ( but also stochastic process in infinite dimension viewed as a random variable taking values in its path space which we will not investigate in this paper ) .",
    "we consider here a random vector @xmath32 defined on a probability space @xmath57 taking its values in @xmath4 equipped with its borel @xmath58-field @xmath59 .",
    "it is convenient for what follows to introduce a few notions and results about vector quantization and its ( mean quadratic ) optimization .",
    "it makes a connection between cvts and stochastic optimization , gives a rigorous meaning to the notion of  goodness \" of a cvt .",
    "optimal vector quantization goes back to the early 1950 s in the bell laboratories and have been developed for the optimization of signal transmission .",
    "let @xmath60 be a square integrable random vector ( @xmath25 @xmath61 ) or equivalently @xmath62 .",
    "assume that its distribution @xmath63 is included in  @xmath7 ( defined as above ) . the terminology",
    "_ @xmath3-quantizer _ ( or a _ quantizer at level _",
    "@xmath3 ) is assigned to any @xmath7-valued subset with cardinality @xmath3 .",
    "when used in a numerical framework , it is also known as _",
    "quantization grid_. @xmath64 the cardinality of @xmath12 is @xmath3 . in numerical applications , @xmath12 is also called a ( quantization ) _ grid_.",
    "it is the set of genrators of its ( borel ) voroni regions @xmath9 .",
    "then can discretize @xmath32 in pointwise way by @xmath65 where @xmath66 : @xmath67 is a borel function .",
    "then we get @xmath68 so that the best pointwise approximation of @xmath32 is provided by considering any ( borel ) _ nearest neighbour projection _ @xmath69",
    "associated with the voronoi tessellation @xmath9 by setting @xmath70 it is clear that such a projection is in one - to - one correspondence with the voronoi partitions ( or diagrams ) of @xmath4 induced by @xmath12 .",
    "these projections only differ on the boundaries of the voronoi cells @xmath14 so that , as soon as @xmath63 is strongly contoinuous , these neratest neighbour projections are all @xmath71 -@xmath72 equal .",
    "we define a _ voronoi @xmath3-quantization _ of @xmath32 ( or at level @xmath3 ) by setting for every @xmath73 , @xmath74 thus for all @xmath75 , @xmath76 a voronoi @xmath12-quantization of @xmath32 or , in short , a quantization of @xmath32 . the mean quadratic quantization error",
    "is then defined by @xmath77 where @xmath78 is the norm in @xmath79 .",
    "the distribution of @xmath80 as a random vector is given by the @xmath3-tuple @xmath81 .",
    "this distribution clearly depends on the choice of the voronoi partition .",
    "we naturally wonder whether it is possible to design some optimally fitted grids to a given distribution @xmath82 _ i.e. _ which induces the lowest possible mean quadratic quantization error among all grids of size at most @xmath3 .",
    "this optimization problem , known as _ the optimal quantization problem at level @xmath3 _ , reads as follows : @xmath83 by introducing the energy function or _ distortion value function _ @xmath84 @xmath85 the optimization problem also reads @xmath86 since the value of @xmath87 at an @xmath3-tuple @xmath88 only depends on its value grid @xmath89 of size at most @xmath3 of the @xmath3-tuple",
    "( in particular @xmath87 is a symmetric function ) .",
    "we will make occasionally the abuse of notation consisting in denoting @xmath90 instead of @xmath91 .",
    "one proves ( see @xmath24  @xcite ) that there always exists at least one optimal @xmath3-point grid @xmath92 with cardinal @xmath3 such that @xmath93 .",
    "if the support of @xmath71 has at least @xmath94 elements ( @xmath24 because it is infinite ) , then @xmath95 has full size @xmath3 .",
    "furthermore , @xmath96 ; this last claim strongly relies on the euclidean feature of the norm on @xmath4 : if @xmath97 , then the projection of the elements of @xmath98 on the closed ( nonempty ) convex @xmath7 strictly reduces the mean quadratic quantization error ( see @xmath24  @xcite ) . note that this existence result does not require @xmath99 to be strongly continuous .",
    "in fact , even if @xmath5 has an atomic component , it is shown in  @xcite ( see theorem  4.2 , p.38 ) that @xmath100 .",
    "furthermore , the function @xmath87 is differentiable on @xmath101 at every @xmath3-tuple @xmath102 such that @xmath103 , @xmath104 and @xmath105 and its gradient is given by @xmath106 where @xmath107 denotes any voronoi diagram of @xmath108 ( or @xmath109 with , once again , an obvious abuse of notation ) . in particular ,",
    "if @xmath110 is an optimal quadratic quantizer , one shows ( see  @xcite , theorem  4.2 p.38 ) that @xmath111 even if @xmath71 assigns mass to ( at most countably many ) hyperplanes . as a consequence , @xmath112 where @xmath113 stands for the lloyd map related to the distribution @xmath63 of the random vector @xmath32 .",
    "the equivalence is a straightforward consequence of  ) .",
    "hence any optimal quantizer induces a cvt for the distribution of @xmath32 . in reference to the fact that such an @xmath3-quantizer is a zero of a gradient",
    ", this property is also known as _",
    "stationarity _ for the @xmath3-tuple @xmath114 itself .",
    "unfortunately , the converse is not true since @xmath87 may have many local minima , various types of saddle points ( and a  pin \" behaviour on affine manifolds induced by clusters of stuck components ) .",
    "this phenomenon becomes more and more intense as @xmath8 grows .",
    "however , it makes a strong connection between search for optimal quantizers and lloyd s algorithm as described above .",
    "and there is no doubt that what practitioners are interested in are the optimal quantizers rather than any  saddle \" stationary quantizers .",
    "one can also derive a stochastic gradient algorithm from the representation of @xmath115 as an expectation of a computable function of the quantizer @xmath109 and the random vector @xmath32 .",
    "this second approach leads to a stochastic optimization procedure , a stochastic gradient descent to be more precise , known as the _ competitive learning vector quantization _ algorithm ( @xmath116 ) which has also been extensively investigated ( see among others  @xcite ) .",
    "the paper is organized as follows : in section  [ sec:2 ] we establish the convergence of the lloyd procedure at level @xmath3 under some natural assumptions on the probability distribution ( at least for numerical probability purpose ) but assuming that the starting quantizer ( or generators ) induces a lower quantization error than the lowest quantization error at level @xmath2 . in section  [ sec:3 ] , we propose a modified lloyd s procedure , inspired by recent results on the asymptotics of the  radius \" of optimal quantizers at level @xmath3 as @xmath117 , to overcome partially this constraint on the starting grid .",
    "notations : @xmath118 @xmath119 denotes the support of the borel probability measure @xmath5 on @xmath4 .",
    "@xmath120 denotes the lebesgue measure on @xmath4 .",
    "@xmath118 @xmath121 denotes the canonical inner product on @xmath4 .",
    "@xmath122 , @xmath123 , denotes the canonical euclidean ball centered at @xmath124 with radius @xmath125 .",
    "@xmath118 @xmath126 denotes the cardinality of set @xmath127 .",
    "owing to both simplicity and efficiency of of practical implementations of lloyd s algorithm in various fields of applications , it is important to study its convergence as it has been carried out , at least partially , in  @xcite for its  counterpart \" in the world of stochastic approximation , the recursive stochastic gradient descent attached to the above gradient of the distortion function @xmath87 .",
    "this procedure is also known as @xmath116 ( for competitive learning vector quantization algorithm ) .",
    "in fact , as concerns the convergence properties of lloyd s algorithm , many investigations have already been carried out .",
    "thus , as mentioned in the introduction , true convergence for @xmath51-concave densities has been established in  @xcite whereas global  weak \" convergence has been proved in a one dimensional setting ( see @xcite ) .",
    "however , there are not many general mathematical results on the convergence analysis for distributions on multi - dimensional spaces , especially when _ the support of the distribution @xmath5 of interest is not bounded_. it is convenient to rewrite the iterations of the lloyd algorithm in a more probabilistic form , using quantization formalism ( with a generic notation for the grids : @xmath128 , @xmath129 ) .",
    "let @xmath130 .",
    "for every @xmath129 , @xmath131 with the following _ degeneracy convention _ :    if @xmath132 then @xmath133 .",
    "we need now to formalize in a more precise way what can be a _",
    "consistent connection _ between the sequence of iterated grids @xmath134 in the lloyd procedure and the @xmath3-tuples that can be associated to their values .",
    "let @xmath135 be a sequence of iterates of the lloyd procedure where @xmath136 .",
    "a sequence of @xmath3-tuples @xmath137 is a _ consistent representation _ of the sequence @xmath138 if    * @xmath139 , * for every integer @xmath129 and every @xmath13 , @xmath140 is the centroid of the cell of @xmath141 @xmath25 @xmath142    ( still with the above degeneracy convention ) .",
    "there are clearly @xmath143 consistent representations of a sequence of lloyd iterates , corresponding to the possible numbering of @xmath144 .",
    "but then this numbering is frozen as @xmath0 increases .",
    "it is also clear that roundedness , convergence ( in @xmath101 ) of such consistent representations does not depend on the selected representation .",
    "so is true for a possible limit @xmath145 of such sequences since @xmath146 will not depend on the selected representation .",
    "however on may have @xmath147 in case of an asymptotic merging of some of the components of the representation .",
    "one checks that under the assumptions we make ( @xmath5 continuous , or convex support or splitting assumption on @xmath144 ) no merging occurs at finite range .    throughout the paper @xmath148",
    "will always denote a consistent representation of the sequence of iterates @xmath149 . these remark lead naturally to the following definition    [ convgrid]we will say that @xmath150 ( converges ) as @xmath151 if there exists a constant representation @xmath148 converging in @xmath101 toward @xmath145 such that @xmath152 .",
    "several specific results established in what follows are known in the literature , but we chose to provide all proofs for self - completeness of the paper and reader s convenience .",
    "let us first recall a basic fact which is at the origin of the efficiency of the lloyd algorithm .",
    "[ lem : seminal]the iteration of lloyd s algorithm makes the quantization error decrease .",
    "@xmath153 furthermore , @xmath154 as long as @xmath155 with positive @xmath156-probability .",
    "conversely , if @xmath157 @xmath156-@xmath72 for an integer @xmath158 , then @xmath159 @xmath156-@xmath72 for every @xmath160 .    * proof * : by its very definition , @xmath161 is the best approximation of @xmath32 among the @xmath162-measurable functions , including @xmath163 itself .",
    "thus @xmath164 with equality if and only if @xmath165 . note that , if so is the case , @xmath166 since @xmath167 . on the other hand , by  , @xmath168 is the best approximation of @xmath32 among all @xmath169-valued random vectors since @xmath170 and if @xmath166 , this inequality holds as an equality .",
    "@xmath171    this seminal property of lloyd s algorithm is striking not only by its simplicity .",
    "it is also at the origin of its success . morally speaking",
    ", it suggests a convergence toward a stationary   and hopefully optimal or at least locally optimal   quantizer of the distribution @xmath5 of @xmath32 .",
    "in fact , things are less straightforward , at least from a theoretical point of view since this property provides absolutely no information on the boundedness of the sequence of grids @xmath134 generated by the procedure , although it is a crucial property the way toward convergence .",
    "the main result of this paper is the following theorem .",
    "[ thm : main ] let @xmath172 be a square integrable random vector with a distribution @xmath5 having a convex support @xmath7 assigning no mass to hyperplanes .",
    "let @xmath173 with size @xmath174 .",
    "then , all the iterates @xmath175 have full size @xmath3 and are @xmath7-valued .",
    "@xmath176 if the sequence @xmath177 is bounded ( or equivalently kits consistent representations @xmath148 ) , then @xmath178 and there exists @xmath179 and a connected component @xmath180 of @xmath181 such that @xmath182 in particular , if @xmath183 is locally finite ( @xmath184 is reduced to finitely many points on each compact set ) , then @xmath185 .",
    "@xmath186 _ splitting method : _ if furthermore @xmath187 $ ] , then the sequence @xmath177 is always @xmath156-@xmath72 bounded and @xmath188 .",
    "* remarks .",
    "* @xmath118 the result in claim @xmath176 does not depend on the original numbering of @xmath144 @xmath25 on the selected order ( among @xmath143 ) selected to define @xmath189 and the then the sequence @xmath190 .",
    "in particular in case of true convergence of the sequence @xmath191 , all its permutations do converge as well toward the corresponding permutations of @xmath145 so that one can , by an abuse of notion write that @xmath150 .",
    "a direct approach based on a formal notion of set convergence is also possible but would be of no help in practice .",
    "@xmath118 nothing ensures that the limiting grid @xmath146 is optimal or even a local minimum .",
    "we refer to the appendix for a brief discussion and an closed formula for the hessian of @xmath87 .",
    "the first claim of this theorem relies on a boundedness assumption for the sequence @xmath192 .",
    "this condition is of course satisfied if the support of the distribution @xmath5 of @xmath32 is compactly supported and @xmath193 ( closed convex hull of the support of @xmath5 ) since we assume that @xmath173 : then , for every @xmath194 , so will be the case for @xmath138 as emphasized in the description of the procedure .",
    "claim  @xmath186 emphasizes that , by an appropriate choice of ( the quadratic quantization error ) @xmath144 may imply the boundedness of the whole sequence of iterates @xmath134 .",
    "this approach known by practitioners as the _ splitting method _ is investigated in the next subsection .",
    "we will prove this theorem step by step , establishing intermediary results , often under less stringent assumptions than the above theorem , which may have their own interest .",
    "in practical computations , if one aims at computing ( hopefully ) optimal quantization grids ( or @xmath195 ) of @xmath32 on a wide range of levels @xmath3 ( see @xmath24 the website www.quantize.maths-fi.com ) , the so - called _ splitting method _ appears as an extremely efficient  level - by - level \" procedure .",
    "the principle is to compute the grids in a telescopic manner based on their size @xmath3 : assume we have access to an optimal grid of size @xmath3 .",
    "imagine we add to this grid an @xmath196 @xmath7-valued component @xmath24 sampled randomly from the distribution of @xmath32 ( or any @xmath7-supported distribution ) . doing so , we make up a grid which has for sure a lower quadratic mean quantization error than any grid with @xmath3 points .",
    "this grid of size @xmath94 is likely to lie in the attracting basin of the optimal quadratic quantizer ( or @xmath195 ) at level @xmath94 .",
    "this is often observed in practice and , even if not optimal , it provides at least very good quantizers .",
    "its main the trade - off is that it requires a systematic , hence heavily time consuming , simulation .",
    "many variants or potential improvements can be implemented ( like adding an optimal quantizer of size @xmath197 at each new initialization to directly obtain ( hopefully ) optimal quantizers of size @xmath198 ( see @xmath24  @xcite ) .    *",
    "splitting assumption ( on the starting grid ) : * _ let @xmath199 be such that card@xmath200 ( where @xmath201 ) .",
    "let @xmath202 be an optimal grid of size @xmath2 for @xmath71 and let @xmath203 .",
    "the lloyd algorithm is initialized as follows : _",
    "@xmath204    one natural way to generate the additional element @xmath205 is in practice to simulate randomly a copy of @xmath32 ( in fact one can also simulate a copy of a random vector whose distribution is equivalent to that of @xmath32 , see the remark below )",
    ".    * remark . *",
    "if @xmath5 has a density @xmath27 , it is more efficient to simulate according to the distribution whose probability density is proportional to @xmath206 ( one checks that this function is integrable if @xmath207 for an @xmath208 , see @xmath24  @xcite ) .",
    "the reason is that the resulting distribution @xmath209 provides the best random @xmath3-quantizers of @xmath210 for every @xmath199 in the following sense : the asymptotic minimization problem @xmath211 has @xmath212 as a solution ( @xmath213 denotes here independence ) .    if the splitting assumption on the initialization of the procedure is satisfied , the grids of the iterations in the lloyd algorithm share an interesting property ( which implies their global boundedness ) .",
    "the arguments developed in the proof below are close to those used in the proof of the existence of an optimal quantizer at level @xmath3 ( see @xmath24  @xcite ) .",
    "[ pro : npts ] assume the splitting assumption  .",
    "@xmath176 the quantization error induced by the grid @xmath144 defined by   is strictly smaller than @xmath214 ( @xmath25 that of the optimal @xmath215-quantizer @xmath216 ) so that @xmath217 and @xmath218    @xmath186 the sequence of iterated grids @xmath134 is bounded in @xmath4 @xmath25 there exists a compact set @xmath219 such that @xmath220 @xmath221 all the limiting values of the sequence of consistent representations @xmath148 have @xmath3 pairwise distinct components ( @xmath25 the the sequence of grids @xmath134 has asymptotically full size full size @xmath3 ) .",
    "* proof * : @xmath176 the ( squared ) quadratic means quantization error ( or  distortion value \" ) induced by @xmath144 satisfies : @xmath222 where @xmath223 , @xmath224 .",
    "let @xmath225 .",
    "for every @xmath226 , @xmath227 consequently , on the event @xmath228 , we have @xmath229 whereas we always have that @xmath230 .",
    "on the other hand we know that @xmath231 so that @xmath232 which implies in turn that @xmath233 one concludes by noting that lloyd s algorithm makes the sequence of ( squared ) quadratic quantization error induced by the iterated grids non - increasing .",
    "@xmath186 suppose that there exists a subsequence @xmath234 and a component @xmath235 such that @xmath236 as @xmath237 .",
    "then , by re - extracting finitely many subsequences , we can split the set @xmath238 into two disjoint non empty subsets @xmath239 and @xmath240 and find a subsequence ( still denoted @xmath241 for convenience ) such that @xmath242 and @xmath243 it is clear that @xmath244 therefore , it follows from fatou s lemma that @xmath245 finally @xmath246 since @xmath239 contains at least @xmath235 . on the other hand , we know from @xmath176 that @xmath247 , so that we get the following contradictory inequality @xmath248 consequently @xmath239 is empty which completes the proof .",
    "@xmath221 the proof is similar to that of the above item @xmath186 .",
    "assume @xmath249 . if there exists two components @xmath250 and @xmath251 converging to @xmath252 .",
    "then , owing to fatou s lemma @xmath253 which yields a contradiction . @xmath171      from now on , our aim is to investigate the structure of the set @xmath254 of limiting grids of the sequence @xmath134 @xmath25 the set of grids @xmath146 such that there exists a subsequence @xmath241 for which @xmath255 .",
    "the two lemmas and the proposition below establish several properties of the iterated grids @xmath134 which are the basic  bricks \" of the proof of claim  @xmath176 of theorem  [ thm : main ] .",
    "[ lem : nomerge ] let @xmath256 be a closed convex set of @xmath4 with non - empty interior and let @xmath257 be a borel probability distribution such that @xmath258 and @xmath259 .",
    "furthermore assume that , either @xmath257 satisfies @xmath260 , or @xmath257 assigns no mass to hyperplanes .",
    "then the function defined on @xmath256 by @xmath261 is continuous , strictly convex and atteins its unique minimum at @xmath262 .",
    "* elementary computations show that @xmath263 so that @xmath264 .",
    "now assume @xmath265 .",
    "there exists a supporting hyperplane @xmath266 to @xmath256 at @xmath267 defined by @xmath268 , @xmath269 . for every @xmath270 ,",
    "@xmath271 so that @xmath272 so that @xmath273 @xmath274-@xmath72 @xmath25 @xmath275 @xmath274-@xmath72 .",
    "this leads to a contradiction with the assumptions made on @xmath257.@xmath276    [ lem : cvgce ] assume that a subsequence @xmath277 as @xmath237 and that the boundary of the voronoi tessellation of @xmath146 are @xmath156-negligible .",
    "let @xmath278 .",
    "then @xmath279    * proof of lemma  [ lem : cvgce ] * : by definition , @xmath280    we know from what precedes that , since @xmath281 , if @xmath282 , the functions @xmath283 our assumption on @xmath146 implies that these convergences hold @xmath156-@xmath72 .",
    "we conclude by lebesgue s dominated convergence theorem that for every @xmath13 @xmath284 therefore , with our convention for the index @xmath285 such that @xmath286 ( if any ) , we get by applying the above convergence to @xmath287 and @xmath288 @xmath289 \\ , \\sum_{i=1}^n \\frac{\\e \\big(y \\mathbf{1}_{x \\in c_i(\\gamma^{(\\infty)})}\\big)}{\\mathbb{p}(x \\in c_i(\\gamma^{(\\infty)})}\\mbox{\\bf 1}_{\\{x \\in c_i(\\gamma^{(\\infty)})\\ } } =   \\mathbb{e } ( y | \\widehat{x}^{\\gamma^{(\\infty ) } } ) \\qquad \\p\\mbox{-}a .",
    "s. \\qquad\\qquad\\hfill \\box \\notag\\end{aligned}\\ ] ]    [ prop : cvgcei ] assume that @xmath144 is a @xmath7-valued grid and that the iterates @xmath134 of the lloyd algorithm are bounded .",
    "@xmath176 assume that @xmath5 assigns no mass to hyperplanes and @xmath290 ( @xmath25 is convex ) .",
    "if the sequence @xmath134 of iterations of the lloyd procedure is bounded ( @xmath24 because @xmath7 is itself bounded ) then @xmath291 @xmath25 no components of the grids get asymptotically stuck as @xmath0 goes to infinity .",
    "@xmath186 assume @xmath292 .",
    "let @xmath146 be a limiting grid of @xmath134 .",
    "if the boundary of the voronoi cells of @xmath146 are @xmath71-negligible @xmath25 @xmath293 , then the grid @xmath146 is stationary @xmath25 it is a fixed point of the lloyd map @xmath42 or equivalently that ( any of ) its induced voronoi tessellation(s ) is a cvt .",
    "if @xmath277 , then @xmath294    @xmath221 if the distribution of @xmath32 assigns no mass to hyperplanes , then @xmath295 as @xmath296 .",
    "@xmath297 if the distribution of @xmath32 has a convex support @xmath298 , then the consistent representations of @xmath134 satisfy @xmath299 in particular , @xmath300 as @xmath237 .",
    "hence , the set @xmath301 of ( consistent representations of ) limiting grids of @xmath134 is a ( compact ) connected subset of @xmath302 .",
    "* remarks . *",
    "@xmath118 in the literature the convergence of the gradient of the iterated grids as established in @xmath221 is sometimes known as  weak convergence \" of the lloyd procedure .",
    "@xmath118 lemma  [ lem : nomerge ] improves a result obtained in  @xcite which show that component do not asymptotically merge in lloyd s procedure even when the splitting assumption is not satisfied . in  @xcite , the distribution @xmath5 is supposed to be absolutely continuous with a density a continuous @xmath27 , everywhere strictly positive on its support .",
    "our method of proof allows for relaxing this absolute continuity assumption .",
    "* proof of proposition  [ prop : cvgcei ] * : @xmath176 for every @xmath303 , @xmath104 , we define the median hyperplane of @xmath304 and @xmath305 by @xmath306 we define together the affine form @xmath307 which satisfies @xmath308 on @xmath309 and @xmath310 . moreover , note that @xmath311 and that @xmath312 the sequence of iterated grids @xmath134 being bounded by assumption , we may assume without loss of generality , up to an extraction @xmath241 , @xmath313 and @xmath314 set for every @xmath303 @xmath315 hence , for every @xmath13 , @xmath316 is a closed polyhedral convex set containing @xmath22 .",
    "it also contains @xmath317 since @xmath318 owing to the stationarity property .",
    "then , for every @xmath319 , @xmath320 since @xmath321 uniformly on compact sets toward @xmath322 ( simple convergence of affine forms in finite dimension implies locally uniform convergence ) .",
    "assume there exists @xmath323 such that @xmath324 is not reduces to @xmath325 @xmath25 contains at least two indices .",
    "it is clear that @xmath326 the above nonempty open set has non zero @xmath5-mass since @xmath327 .",
    "hence , there exists two indices @xmath328 such that @xmath329 and @xmath330 .",
    "first note that @xmath331 and @xmath332 but both quantities being opposite since @xmath333 they are equal to @xmath334 which means that @xmath335    since these sets are polyhedral and @xmath5 assigns no mass to hyperplanes , @xmath336 and @xmath337 .",
    "then one checks that @xmath338 so that , still using that @xmath5 assigns no mass to the boundaries of these polyhedral convex sets , we get @xmath339 set @xmath340 . it follows form  ( [ eq : ldeltagrid ] ) that @xmath341 letting @xmath342 go to infinity implies that @xmath343 since @xmath344 is a converging sequence .",
    "hence @xmath345 , @xmath346 , which in turn implies that @xmath347 .",
    "one shows likewise , still taking advantage of the @xmath5-negligibility of the boundaries of the polyhedral sets @xmath316 , that @xmath348 passing to the limit in the stationary equation satisfies by @xmath349 , @xmath346 , finally implies that @xmath350 but , owing to lemma  [ lem : nomerge ] ( see also  @xcite , p.22 ) , this implies that @xmath351 , @xmath346 .",
    "this yields a contradiction to the fact that both @xmath352 are equal @xmath353 .",
    "@xmath186 let @xmath354 .",
    "then @xmath355 belong to the interior of one of the tessels @xmath356 , say @xmath357 . hence , @xmath358 is strictly smaller than @xmath359 .",
    "consequently , there exists an @xmath360 such that for all @xmath361 , @xmath362 or equivalently @xmath363 .",
    "thus , for every @xmath364 , @xmath365 \\ ,   \\sum_{i=1}^n x_i^{\\infty }",
    "\\mathbf{1}_{c_i(\\gamma^{(\\infty)})}(\\xi ) = \\operatorname{proj}_{\\gamma^{(\\infty ) } } ( \\xi ) .\\ ] ] this clearly implies that @xmath366-@xmath72 , @xmath367 as @xmath368 since @xmath369 . to carry on the proof , we need the following lemma . if we set @xmath370 in lemma  [ lem : cvgce ]",
    ", then @xmath371 moreover , the sequence @xmath372 being @xmath373-uniformly integrable since @xmath292 , the above convergence also holds in @xmath374 .",
    "now , since @xmath375 and @xmath376 is @xmath377-valued , we derive from lemma  [ lem : seminal ] that @xmath378 since we know that @xmath379 @xmath156-@xmath72 , it follows from from fatou s lemma that @xmath380 on the other hand , we derive from the convergence @xmath381 in @xmath374 that @xmath382 so that @xmath383 which in turn implies by the very definition of conditional expectation as an orthogonal projection on @xmath384 that @xmath385    @xmath221 first we note that , for any grid @xmath386 , schwarz s inequality implies @xmath387 so that the sequence @xmath388 is bounded .",
    "now , as @xmath389 assigns no mass to the boundary of any voronoi tessellations , we derive from what precedes that any limiting grid of @xmath134 is stationary @xmath25 @xmath390 .",
    "it is clear by an extraction procedure that @xmath334 is the only limiting value for the bounded sequence @xmath388 which consequently converges toward @xmath334 .",
    "@xmath297 the set of limiting grids of the sequence @xmath134 is compact by construction .",
    "its connectedness will classically follow from @xmath391{k\\to \\infty } 0\\ ] ] ( see  @xmath24  @xcite ) .",
    "it is clear from item  @xmath176 that @xmath392 is a compact whose intersection with the closed set @xmath393 .",
    "hence , @xmath394 stands at a positive distance of this set or , equivalently , there exists @xmath395 , such that @xmath396 as a consequence , every voronoi cell satisfies @xmath397 where @xmath398 denotes the open ball with center @xmath355 and radius @xmath399 . since @xmath298 is a ( closed )",
    "convex set and @xmath400 , then @xmath401 for every @xmath194 . as a consequence , @xmath402 which in turn implies that the function @xmath403 is ( strictly ) positive on the compact set @xmath394 , so that we can define @xmath404 which implies in particular that @xmath405    now we introduce the _ energy gap _",
    "@xmath406 known to be non - negative by   in lemma  [ lem : seminal ] .",
    "then @xmath407    on the other hand @xmath408 so that , finally , @xmath409 comments .",
    "@xmath118 the restrictions on the possible limiting grids in theorem  [ thm : main ] do not imply uniqueness in general in higher dimensions : the symmetry properties shared by the distribution itself already induces multiple limiting grids as emphasized by the case of the multivariate normal distribution @xmath410 .",
    "in fact , for an orthogonal matrix @xmath411 that is @xmath412 ( @xmath413 stands for the transpose of @xmath414 ) and any optimal grid @xmath386 , @xmath415 @xmath118 for distribution with less symmetries like @xmath416 with @xmath417 , one can reasonably hope that at least local uniqueness of stationary grids ( cvt ) holds true .",
    "one way to check that is to establish that the hessian @xmath418 is invertible at each stationary grid @xmath12 .",
    "a closed form is available for this hessian ( see  @xmath24  @xcite ) .",
    "* proof of theorem  [ thm : main ] * : the preliminary claim follows by induction from the structural stationary properties of the iterates and lemma  [ lem : nomerge ] .",
    "@xmath176 combining the results obtained in the above proposition and the convergence @xmath419 toward a non - negative real number @xmath420 completes the proof .",
    "@xmath186 follows from proposition  [ pro : npts ] in section  [ sec : split ] which implies that the sequence @xmath134 is bounded .",
    "then one concludes by @xmath176 .",
    "so far our results are based on the hypothesis that we initialize the lloyd algorithm using a grid of size @xmath3 whose induced quadratic quantization error is lower than the minimal quantization error achievable with a grid of size at most @xmath2 .",
    "this is clearly the key point to ensure that the iterates of the procedure remain bounded . from a practical point of view",
    ", this choice for the initial grid is not very realistic , in particular if we are processing a  splitting method \" : nothing ensures , even if the lloyd procedure converges at a level @xmath2 , that the limiting grid will be optimal with the consequence that the initialization at level @xmath3  below \" @xmath214 becomes impossible .    however , we know from theoretical results on optimal vector quantization where the optimal quantizers are located _ a priori_.      the following proposition can be found in  @xcite .",
    "let @xmath422 .",
    "let @xmath423 $ ] .",
    "there exists @xmath424 such that @xmath425    an upper bound @xmath426 satisfies the following conditions :    * @xmath427 such that @xmath428 and @xmath429 , * @xmath430 .",
    "if we specify @xmath431 , then the set @xmath432 will be the set of grids corresponding to optimal @xmath3-quantizers , and @xmath433 will be an upper bound of the optimal @xmath3-quantizers .",
    "consequently , in order to given a numerical estimation of @xmath433 , we have to estimate the asymptotic behaviour of @xmath434 .",
    "we know from  ( @xcite , see also  @xcite ) that @xmath435 if @xmath32 has a standard gaussian distribution @xmath436 , then @xmath437 thus @xmath438    more precise results can be found in  @xcite and  @xcite for various families of distributions with exponential or polynomial tails at infinity . under certain condition on @xmath32 ,",
    "the asymptotic behaviour of @xmath439 can be analyzed sharply as @xmath3 goes to infinity . typically if @xmath440 , @xmath441      since we know that all optimal @xmath3-quantizers are constrained in a bounded domain ( depending on @xmath3 in a more or less controlled way ) , a natural idea is to constrain the exploration of the lloyd iterates inside it to take advantage of this information .",
    "we can fix an area that we are sure that the optimal quantizer have its grids in it .",
    "once an iteration of the algorithm includes some points that go beyond the area , we will be sure that it is not the optimal grid .",
    "so we can do something to pull the points back into the area while keeping the error non - increasing .    to this end",
    ", we now compute the difference made on the second phase of the lloyd iteration in condition that we pick a point other than the mass center point . if we take @xmath442 instead of @xmath443 for a certain @xmath444 , the resulting difference in the @xmath444^th^ voronoi region created by the second phase will be :    @xmath445    this shows that _ if we pick a point which lies at the same distance to @xmath446 as @xmath305 _ , then the above difference becomes zero .",
    "the idea is then to choose the point inside the prescribed domain if @xmath446 is outside .",
    "it is always possible , @xmath24 by keeping @xmath305 still ( although this is probably not the optimal way to proceed ) .",
    "with this idea we present a modified version of lloyd s algorithm , which does not need the splitting assumption , to be run successfully .",
    "we set a @xmath447 that all optimal quantizers are in the ball @xmath448 .",
    "the algorithm is as follows ( assuming that @xmath32 is centered for convenience ) :    * algorithm 2 ( modified lloyd s algorithm ) * :    _ inputs _ :",
    "* @xmath448 , the domain of interest ( with @xmath433 close to @xmath449 ) hopefully . * @xmath450 a simulatable probability distribution ( with a convex support @xmath7 ) and assigning no mass to hyperplanes . *",
    "@xmath451 , the initial set of @xmath3 generators ( starting grid ) .",
    "_ pseudo - script _ :    @xmath45 at the @xmath0^th^ iteration :    1 .",
    "compute the position of @xmath452 , the mass centroid of @xmath453 . if there is an index @xmath444 such that @xmath454 lies outside @xmath448 ( and for every such point ) , replace the current value @xmath454 by a point @xmath455 defined @xmath24 by @xmath456 $ ] ( other choices are possible like choosing it randomly on @xmath457 .",
    "2 .   if every point lies in the ball @xmath448 , then take these mass centroids of @xmath453 as the new set of generators @xmath458 , 3 .",
    "construct the voronoi tessellation @xmath459 of @xmath7 with the grid of generators @xmath460 .",
    "@xmath45 repeat the above iteration until a stopping criterion is met . and",
    "the output is the cvt @xmath461 with generators @xmath462 in @xmath7 .",
    "@xmath45 end .",
    "is replaced by @xmath463\\cap\\partial b(0,r)$],scaledwidth=108.0% ]    in this new version we modify phase  i  ( [ eq : step1 ] ) of the lloyd procedure in such a way that the quadratic approximation error @xmath464 still decreases . the second phase being unchanged , so this modified lloyd algorithm is still energy descending and furthermore it lives in the ball @xmath448 .",
    "the trade - off is that with the @xmath433 fixed at the beginning of the algorithm , we loose the ( theoretical ) possibility that the iterated sequence cruises very far during the iterations to finally come back with a lower energy .",
    "therefore the energy level of the new limit points will be higher than setting @xmath465 .",
    "we also see that the larger the radius @xmath433 we take , the lower limit energy level we can get .    another trade - off of the modified procedure is that it does not guarantee lemma 3 because we do not use the splitting assumption . in this case",
    "we can not prove the non - degeneracy of the limit grid by this global energy reasoning .",
    "however , we can now rely on proposition  [ lem : nomerge ] to ensure that no merging occurs .",
    "* provisional remarks .",
    "* one verifies on numerical implementation of lloyd algorithm , that the main default that slows down the procedure is more the freezing of one component of the grid which is  too far from the core \" of the support of the distribution @xmath5 than the explosion of the grid with components going to infinity .",
    "but in some sense these seeming radically different behavior are the two sides of the same coin and the above procedure is an efficient way to prevent these parasitic effects .",
    "though , in practice we proceed in a less formal way : using the theoretical estimates on the radius of the distribution allows for an adequate choice of the initial grid @xmath144 as confirmed by various numerical experiments carried @xmath24 in  @xcite .",
    "0 v. bally and g. pags ( 2003 ) : a quantization algorithm for solving multi - dimensional discrete - time optimal stopping problems .",
    "_ bernoulli _ , * 9*(6):1003 - 1049",
    ".    j. a. cuesta , c. matr ' an ( 1988 ) : the strong law of large numbers for k - means and best possible nets of banach valued random variables .",
    "_ probab . theory related fields _ , * 78*(4):523 - 534 .",
    "q. du , v. faber and m. gunzburger ( 1999 ) : centroidal voronoi tessellations : applications and algorithms , _ siam review _",
    ", * 41*:637 - 676 .",
    "q. du , m. emelianenko and l. ju ( 2006 ) : convergence of the lloyd algorithm for computing centroidal voronoi tessellations , _ siam journal on numerical analysis _ , * 44*:102 - 119 .",
    "m. emelianenko , l. ju and a. rand ( 2008 ) : _ nondegeneracy and weak global convergence of the lloyd algorithm in @xmath466 _ , _ siam journal on numerical analysis _ , * 46*(*3*):1423 - 1441 .",
    "j.c . fort and g. pags ( 1995 ) : on the a.s .",
    "convergence of the kohonen algorithm with a general neighborhood function .",
    "probab . _ * 5*(4):1177 - 1216 .",
    "s. graf and h. luschgy ( 2000 ) : _ foundations of quantization for probability distributions . lecture notes in mathematics 1730 _ , berlin : springer .",
    "s. junglen ( 2011 ) : quantization balls and asymptotics of quantization radii for probability distributions with radial exponential tails , _ ejp _ , * 16*:283 - 295 .",
    "kieffer ( 1982 ) : exponential rate of convergence for lloyd s method  i , _ ieee trans . on inform .",
    ", special issue on quantization , * 28*(2):205 - 210 .",
    "s. graf , h. luschgy and g. pags ( 2012 ) : the local quantization behaviour of absolutely continuous probabilities .",
    "_ annals of probability _ , * 40*(4):1795 - 1828 , 2012 d. g. luenberger and y. ye ( 2008 ) : _ linear and nonlinear programming _ , 3rd ed .",
    "springer .",
    "g. pags ( 1998 ) : a space vector quantization method for numerical integration , _ j. computational and applied mathematics _ , * 89 * , 1 - 38 ( extended version of  voronoi tessellation , space quantization algorithms and numerical integration \" ( 1993 ) , in : m. verleysen ( ed . ) , proceedings of the esann 93 , bruxelles , quorum editions , 221 - 228 ) .    g. pags and j .. printems ( 2003 ) : optimal quadratic quantization for numerics : the gaussian case , _ monte carlo methods & applications journal _ , * 9*(2):135 - 166 .",
    "g. pags and a. sagna ( 2008 ) : asymptotics of the maximal radius of an @xmath467-optimal sequence of quantizers , _ bernoulli _ * 18*(*1*):360 - 389 .",
    "ai and d.d .",
    "adamovi ( 1970 ) : _ limit points of sequences in metric spaces _ , the american mathematical monthly , 77(*6 * ) : 613 - 616 .",
    "g. pags , h. pham and j. printems ( 2004 ) : optimal quantization methods and applications to numerical problems in finance , in _ handbook on numerical methods in finance _ ( s. rachev , ed . ) , birkhauser , boston , 253 - 298 .",
    "d. pollard ( 1982 ) : a central limit theorem for @xmath0-means clustering , _ ann .",
    "_ , * 10 * , 919 - 926 .",
    "a. sagna ( 2008 ) : mthodes de quantification optimale avec applications  la finance , phd thesis , upmc .",
    "we provide here a formula for the hessian of the distortion value function @xmath87 when the distribution @xmath5 of @xmath32 is absolutely continuous with density function @xmath27 . from such a formula it is possible , at least numerically in low dimensions , to detect the status of a stationary grid / quantizer in terms of stability : local minimum , saddle point , etc .",
    "let @xmath469 .",
    "set for every @xmath124 with pairwise distinct components , @xmath470 where @xmath120 denotes the lebesque measure on @xmath6 .",
    "then @xmath471 is continuously differentiable on the open set of @xmath3-tuples with pairwise distinct components and @xmath472 where @xmath473 denotes the lebesque measure on the median hyperplane @xmath474 of @xmath22 and @xmath23 and @xmath475 .",
    "furthermore , @xmath476    we refer to  @xcite or  @xcite for a proof .",
    "this leads to the announced general result concerning the hessian of the distortion function @xmath87 .",
    "we set for every @xmath477 , @xmath478_{1\\le i , j\\le d}$ ] and @xmath479_{1\\le i , j\\le d}$ ] ( @xmath480 denotes the kronecker symbol ) .",
    "this formula is used @xmath24 in  @xcite to show the instability of  square `` , ' ' hyper \"- rectangular stationary grids for the uniform distribution over the unit hypercube for kohonen s self - organizing maps ( @xmath484 ) .",
    "when the neighborhood function of the @xmath484 is degenerated ( no true neighbor ) the @xmath484 amounts to the @xmath116 and its equilibrium points are those of the lloyd procedure , with the same ( un-)stability properties .",
    "these quantities also appear in the asymptotic variance of the @xmath485 established in  @xcite ."
  ],
  "abstract_text": [
    "<S> we establish the pointwise convergence of the iterative lloyd algorithm , also known as @xmath0-means algorithm , when the quadratic quantization error of the starting grid ( with size @xmath1 ) is lower than the minimal quantization error with respect to the input distribution is lower at level @xmath2 . </S>",
    "<S> such a protocol is known as the splitting method and allows for convergence even when the input distribution has an unbounded support . </S>",
    "<S> we also show under very light assumption that the resulting limiting grid still has full size @xmath3 . </S>",
    "<S> these results are obtained without continuity assumption on the input distribution . </S>",
    "<S> a variant of the procedure taking advantage of the asymptotic of the optimal quantizer radius is proposed which always guarantees the boundedness of the iterated grids .    </S>",
    "<S> _ keywords _ : lloyd algorithm ; @xmath0-means algorithm ; centroidal voronoi tessellation ; optimal vector quantization ; stationary quantizers ; splitting method ; radius of a quantizer . </S>"
  ]
}