{
  "article_text": [
    "after the development of molecular biology , the concepts and methods in statistical physics have been widely used to study molecular models of biological evolution @xcite , especially in recent years @xcite .",
    "analytic solutions for models with the infinite genome length may be obtained via several methods , including the maximum principle @xcite , trotter - suzuki method in quantum statistical physics @xcite , quantum field theory @xcite and the hamiltonian - jacobi equation method @xcite .",
    "the infinite genome length limit has been solved fora more complicated ( more nonlinear ) evolution model : the horizontal gene transfer model @xcite .",
    "this model has been solved both for the haploid @xcite , and the hyper - geometric diploid case @xcite .",
    "the study of finite - size corrections is important not only for lattice phase transition models , but also for population genetics @xcite .",
    "here there are situations with few relevant genes for the evolution problem .",
    "although the genome length may be large , e.g. about 10000 in the case of hiv , it is possible to consider only the variable part of the genome which has only @xmath2 bases @xcite ; in such a case , the finite - size effects can not be overlooked .",
    "the study of finite - size corrections allows us to understand as to what extent the results for the infinite genome length can be used to represent those for the finite genome length .    in recent works",
    "@xcite the finite genome length corrections have been calculated for the haploid molecular evolution model @xcite .",
    "in @xcite we calculated the finite size correction for the recombination model with single - peak fitness . in the present paper",
    "we calculate the finite genome length corrections for a diploid model with symmetric landscape @xcite as well as for a haploid model with a simple horizontal gene transfer ( hgt ) @xcite for a general symmetric fitness landscape .",
    "the method may be applied to rather general cases of nonlinear probabilistic models @xcite .",
    "actually , we are constructing a perturbation expansion for the eigen - value like variable for the nonlinear operators . in case of linear operators ( like the quantum mechanics ) , to calculate the first order perturbation to the energy we need only the 0-th order expressions of eigen - vectors to calculate the leading corrections to eigen - values due to perturbations . in case of nonlinear system of equations",
    "it is impossible to use the methods of linear algebra .",
    "nevertheless , we can succeed using a trick . to calculate the perturbation expansion of eigen - value like variables ( mean fitness or the asymptotic expression ) , we use equations such as eq.(13 ) , where the contribution of correction terms of the distribution function disappear .",
    "thus the perturbation of mean - fitness ( `` eigen - value '' for a nonlinear problem ) can be calculated using only the zeroth - order expression of eigen - functions ( bulk solutions for probability distribution ) .",
    "the present paper is organized as follows . in section",
    "ii we derive the finite size corrections for a haploid model ( crow - kimura model ) with a new method . in sections",
    "iii and iv the new method is applied to the diploid evolution model and hgt model , respectively . in the appendix",
    "we give finite size corrections for the diploid evolution model with single - peak fitness function .",
    "let us first introduce a new method to calculate finite - size corrections for the crow - kimura model with haploid genotypes @xcite , which is easier to study .",
    "the crow - kimura model is slightly easier to solve than the eigen model @xcite .    in the crow - kimura model @xcite ,",
    "any genotype configuration @xmath3 is specified by a sequence of _ l _ two - valued spins @xmath4 for @xmath5 and @xmath6 such that the value @xmath7 represents purines ( a , g ) , and the value @xmath8 represents pyrimidines ( t , c ) , where @xmath9 is the total number of different sequences .",
    "the difference between two configuration @xmath10 and @xmath11 is described by the hamming distance @xmath12 . in other words ,",
    "the hamming distance is the number of different spins between configurations @xmath13 and @xmath11 .",
    "the relative frequency @xmath14 of a given configuration @xmath13 satisfies following equation : @xmath15 here @xmath16 is the replication rate , i.e. the _ fitness _ of an organism with a given genotype and in crow - kimura s model it is specified like a function of the genotype : @xmath17 . in other words",
    "_ fitness _ is the average number of offspring of individual with genotype sequence @xmath13 per unit period of time and it is very meaningful quantity in evolution theory .",
    "@xmath18 is the mutation rate to move from sequence @xmath13 to sequence @xmath11 per unit period of time .",
    "it is important that in crow - kimura s model @xcite only single base mutations are allowed , i. e. @xmath19 for @xmath20 , @xmath21 for @xmath22 and @xmath23 , and @xmath24 for @xmath25 ; the last condition ensures that the time evolution of @xmath14 does not change the normalization condition @xmath26 . in the following , we take @xmath27 .    the nonlinear system of eq .",
    "( [ e1 ] ) can be mapped into following linear system of equations , @xmath28 where @xmath29 are related to @xmath14 of eq.([e1 ] ) via @xcite , @xmath30    for the symmetric fitness landscape , where @xmath16 are the same for all the sequences with the same hamming distance from the same reference sequence @xmath31 , it is more convenient to work with _ classes _ , i.e. we classify configurations @xmath13 into the classes according to the value @xmath32 , where @xmath33 is so - called `` magnetization '' of the configuration @xmath13 and is defined as @xmath34 .    defining the magnetization @xmath35 for the configurations at the @xmath36-th class as @xmath37 and fitness @xmath38 , we rewrite eq.([e2 ] ) for the probability @xmath39 for a typical configuration in the @xmath36-class as @xmath40 we define the @xmath36-th hamming class as the group of all sequences at the hamming distance @xmath36 from the reference sequences . having the number of configurations at the @xmath36-th class @xmath41 for @xmath42 we have @xmath43    we are interested in calculating the mean fitness @xmath44 and surplus @xmath45 in the steady state . in @xcite , one of us proposed that in the steady state @xmath46 and the mean fitness @xmath47 can be written as @xmath48 where @xmath49 .",
    "then , high order corrections for @xmath47 , and for @xmath50 have been derived using the linear algebra methods and the equations for @xmath51 . in this section",
    "we derive these corrections with an alternative method that can be applied to the strong nonlinear situations .    using the ansatz",
    "@xmath52 $ ] and a formula @xmath53 where @xmath54 , one can transform eq .",
    "( [ e5 ] ) into the hamilton - jacobi equation , @xmath55 where @xmath56 is a dummy variable .",
    "we assume an asymptotic @xmath57 and get an ordinary differential equation @xmath58 which corresponds to eq .",
    "( 23 ) in ref .",
    "we take the `` + '' solution for @xmath59 and @xmath60 solution for @xmath61 .    in eq .",
    "( [ e8 ] ) , @xmath62 is a function @xmath63 .",
    "the value of @xmath63 , which gives the maximum value of @xmath62 is defined by equation @xmath64 thus the maximum value of @xmath62 can be obtained from @xmath65_{-1\\le m\\le 1 } , \\nonumber\\\\ v(m)&\\equiv & h(m , u_0(m))=f(m)-1+\\sqrt{1-m^2},\\end{aligned}\\ ] ] where the maximum of the first equation is at the point @xmath66 .    to calculate higher order corrections ,",
    "we write @xmath50 as @xmath67 equations ( [ e5 ] ) and ( [ e9 ] ) imply that @xcite : @xmath68.\\end{aligned}\\ ] ] in eq.([e10 ] ) , @xmath62 is the bulk expression of the mean fitness and @xmath69 is the first order correction to it .",
    "having the value of @xmath70 , we can calculate @xmath71 .",
    "@xmath70 can be defined from eq.([e10 ] ) at the point @xmath72 , where the coefficient of @xmath71 becomes zero .",
    "we have an equation @xmath73    equation ( [ e10 ] ) then implies that at @xmath66 @xmath74 let us define @xmath75 .",
    "equation ( [ e8 ] ) can be written as @xmath76 .",
    "expanding eq .",
    "( [ e8 ] ) near @xmath72 with respect to the first and the second arguments of @xmath77 up to the second order , we derive    @xmath78    note that there is no @xmath79 term in the last equation .",
    "we can verify this directly : @xmath80 .    from eqs .",
    "( [ e7 ] ) , ( [ e8a ] ) and ( [ e8b ] ) , we derive @xmath81 @xmath82 @xmath83 with these expressions in eq.([e13a ] ) , we derive @xmath84 therefore @xmath85    equations ( [ e8b ] ) and ( [ e11 ] ) imply that @xmath86 .",
    "thus eventually , we can use eq .",
    "( [ e13 ] ) to obtain @xcite,@xcite @xmath87.\\end{aligned}\\ ] ] using the expression for @xmath70 , we can calculate the @xmath71 from eq .",
    "( [ e10 ] ) : @xmath88",
    "\\nonumber\\\\ & = & k_1-(e^{2u'}+e^{-2u ' } ) \\nonumber \\\\ & -&2u''(\\frac{1+m}{2}e^{2u'}+\\frac{1-m}{2}e^{-2u'}).\\end{aligned}\\ ] ] therefore , having @xmath89 , eq.([e16 ] ) , we can calculate the @xmath1 accuracy expression for the haploid class probabilities @xmath90 ( we define them as @xmath91 ) , also we can calculate the probabilities @xmath92 , eq.([e9 ] ) .",
    "the comparison of this computations with numerical results are shown in the fig . 1 for the case @xmath93 .",
    "= 0.1 in    ( 42,12 ) ( -1.7,0 )    ( 16.5,0 )    ( 7.7,0 ) ( 26,0 )    on the other hand , we can calculate @xmath70 directly as @xmath94 , @xmath95 the bulk surplus term is calculated using the equation @xcite @xmath96 from the definition of @xmath97 , the correction to the surplus can be written as @xmath98 . comparing with eq .",
    "( [ e18 ] ) , we get @xmath99 . using the formula",
    "@xmath100 we derive , assuming @xmath101 : @xmath102    one can define @xmath103 integrating the expression of @xmath104 from eq .",
    "( [ e16 ] ) .",
    "thus we have derived the results of @xcite by an alternative method .",
    "the diploid model has been defined by eq . ( 1 ) in @xcite . there",
    "we derived the analytic solution for the diploid many allele biological evolution models @xcite with general fitness landscapes to the first order using the hamilton - jacobi equation approach . in the present paper",
    "we will find @xmath1 accuracy for mean fitness and genome probabilities of that diploid model .    in wbs parallel diploid model @xcite ,",
    "gene probabilities @xmath29 evolve as @xmath105+\\sum_{j=1}^m m_{ij}p_j.\\ ] ] here @xmath106 is a mutation matrix , defined in section ii .",
    "we have a balance condition @xmath107 .",
    "@xmath108 is the fitness of the genotype @xmath109 , and @xmath110 is the marginal fitness for the sequence @xmath13 .",
    "we assume that the fitness of the configuration @xmath13 is a smooth function of the hamming distance between @xmath13 and the reference configuration @xmath111 .",
    "in such case , it is convenient to work with the overlap @xmath112 instead of the hamming distance @xmath113 . consider the following choice of the matrix @xmath114 : @xmath115 where @xmath116 . in the hypergeometric model @xmath117 and @xmath118",
    "are , respectively , the number of @xmath119 maternal and paternal alleles .",
    "@xmath120 is a smooth analytical function .",
    "we are interested in finding the exact phase structure and the steady state , therefore we can consider only symmetric solutions of @xmath29 .    using the expression @xmath121 $ ] in eq .",
    "( 13 ) of @xcite , we obtain coupled equations for @xmath90 that describe the diploid , one locus many allele parallel mutation - selection model @xcite : @xmath122 here we define the marginal fitness for the hamming class @xmath123 . in diploid",
    "case the fitness landscape is defined via a function @xmath120 of two arguments , describing the dominance relations among alleles @xcite .",
    "eq.(21 ) coincides with the crow - kimura model where @xmath124 is the fitness function for the hamming class l.    assuming ansatz ( [ e6 ] ) and ( [ e7a ] ) , we derive the bulk expression for steady state solution as @xmath125 where @xmath126 is defined via eqs.(6),(8 ) . the mean fitness per spin @xmath62 and surplus @xmath127",
    "are defined via a system @xcite @xmath128    to find an expression for @xmath124 with @xmath1 accuracy , we calculate the following integral : @xmath129 where @xmath49 .",
    "therefore we derive @xmath130}{l|u''(s)| } + \\frac{f''_{bb}[m , s]}{2l|u''(s)| } \\nonumber\\\\ & \\equiv & f'_b(m , s)\\frac{a}{l}+\\frac{f''_{bb}[m , s]}{2l|u''(s)|},\\end{aligned}\\ ] ] where @xmath131}/{|u''(s)|}$ ] , @xmath97 is the surplus , @xmath132 is the first derivative of the fitness function via the second argument , and @xmath133 is the second derivative of the fitness function via the second argument .    for the mean fitness @xmath134 , from eq .",
    "( [ e25 ] ) we have @xmath135}{2|u''(s)|}.\\end{aligned}\\ ] ] expanding @xmath136 via the first argument in the equation above , we obtain @xmath137\\frac{a}{l}+\\frac{[f''_{bb}[s , s]+f''_{aa}[s , s]}{2l|u''(s)|}\\end{aligned}\\ ] ] with @xmath138 being the first derivative of the fitness function via the first argument and @xmath139 being the second derivative of the fitness function via the first argument . on the other hand , we can get an expression for @xmath70 by adding the term @xmath140}{2|u''(s)|}$ ] to the right - hand side of eq.([e16 ] ) .",
    "thus we obtain the following equation for the corrections : @xmath141a+\\frac{[f''_{bb}[s , s]+f''_{aa}[s , s]}{2|u''(s)|}\\nonumber\\\\ % % & = & 2u'_1[\\sinh(2u')+m\\cosh(2u ' ) ] & = & 2u'_1[\\frac{1+m}{2}e^{2u'}-\\frac{1-m}{2}e^{-2u ' } ] \\nonumber\\\\ & + & f'_b(m , s)a+\\frac{f''_{bb}[m , s]}{2|u''(s)|}\\nonumber\\\\ & + & 2u''[\\frac{1+m}{2}e^{2u'}+\\frac{1-m}{2}e^{-2u'}]+2\\cosh(2u').\\end{aligned}\\ ] ] the first line is derived via direct integration of the fitness function via the steady state distribution , the @xmath71 term in the second line is just the small @xmath71 correction of the right hand side of eq.([e22 ] ) .",
    "the third line corresponds to eq.([e25 ] ) .",
    "the last line corresponds to the correction terms of the haploid model .    to calculate @xmath70 we",
    "again consider the point where the coefficient of @xmath71 disappears in the last equation .",
    "we calculate @xmath75 as in the previous section .",
    "we have an equation for @xmath142 @xmath143a\\nonumber\\\\ & = & \\frac{f''_{bb}(m_0,s)-f''_{aa}(s , s)-f''_{bb}(s , s)]}{2|u''(s)|}\\nonumber\\\\ & + & \\frac{1}{\\sqrt{1-m_0 ^ 2}}[1-\\sqrt{1-f''_{aa}(m_0,s)(1-m_0 ^ 2)^{3/2}}]\\nonumber\\\\ & + & \\frac{f''_{bb}(m_0,s)-f''_{aa}(s , s)-f''_{bb}(s , s)]}{2|u''(s)|},\\end{aligned}\\ ] ] where @xmath66 is the bulk magnetization . then putting the value of @xmath142 in eq.([e29 ] )",
    ", we get an expression for @xmath70 :    @xmath144,\\end{aligned}\\ ] ]    @xmath145,\\ ] ] where @xmath146    from eq.([e23 ] ) we calculate first order accuracy expression for the diploid mean fitness @xmath147 and then from eq.([e30 ] ) we compute the @xmath1 accuracy expression for mean fitness @xmath148 . having all these expressions , we compare our analytical results with the direct numerics for different values of @xmath0 and different values of @xmath149 in table i. having @xmath89 by eq.([e28 ] ) , we calculate the @xmath1 accuracy expression for the diploid class probabilities @xmath150 . in fig .",
    "2 we give the comparison of our analytical results with the direct numerics .",
    ".comparison of 0-th order accuracy expression @xmath151 and the 1/l accuracy expression @xmath152 results for the mean fitness of diploid model , for the fitness function @xmath153,for @xmath154 .",
    "@xmath155 is given by direct numerics of eq.(4 ) . [",
    "cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     = 0.1 in    ( 42,12 ) ( -1.7,0 )    ( 16.5,0 )",
    "the finite genome length effects are very important for the case of horizontal gene transfer(hgt ) . while the genome length could be large ( about 10000 in case of hiv ) , it is possible to consider only the variable part of genome , @xmath156 @xcite ) .",
    "we consider the model @xcite describing a simple horizontal gene transfer .",
    "the model has been solved @xcite in the large genome limit in @xcite ( mean fitness ) and @xcite ( steady state distribution ) .    in this model , besides the mutation process , one spin in the genome is replaced with the spin at the same position from the sequence pool .",
    "we consider the following system of equations @xcite : @xmath157- \\nonumber\\\\   & & p_l(1+\\frac{1}{l}\\sum_{k}r_kp_k)- \\nonumber \\\\   & &   cp_{l}+c(\\frac{\\bar l}{l } \\frac{l}{l } + \\frac{{l- l}}{l}\\frac{l-\\bar l}{l})p_{l}+ \\nonumber\\\\ & & c(1-\\frac{{l}-1}{l})\\frac{\\bar l-1}{l}p_{l-1}+ c\\frac{{l}+1}{l}(1-\\frac{\\bar l+1}{l})p_{l+1}],\\end{aligned}\\ ] ] where @xmath158 .",
    "the first and second lines correspond to the crow - kimura model @xcite,@xcite .",
    "the third line describes the hgt process with the change of the hamming class .",
    "we cut plus spin with the probability @xmath159 and add plus spin from the sequence pool with the probability @xmath160 , then cut minus spin with probability @xmath161 and add minus spin from the sequence pool with the probability @xmath162 .",
    "the last line corresponds to the process with the change of hamming class .",
    "we cut the plus spin with the probability @xmath163 and add minus spin from sequence pool with the probability @xmath164 , then cut the minus spin with the probability @xmath165 and add plus spin from sequence pool with the plus spin with the probability @xmath166 .    considering the ansatz @xmath167,\\ ] ] we get the following equation for the bulk terms @xmath168\\nonumber\\\\ & + & \\frac{1-m}{2}e^{-2p}[1+c\\frac{1+s}{2 } ] + \\frac{cms}{2}-\\frac{c}{2}-1,\\end{aligned}\\ ] ] where @xmath169 and @xmath170 is a dummy variable .",
    "the minimum of @xmath171 is at @xmath172 , where @xmath173 gives a potential @xmath174_{u'}$ ] : @xmath175.\\end{aligned}\\ ] ] we define @xmath176 from the conditions @xmath177 where the derivative is with respect to the first argument .",
    "let us calculate the @xmath75 .",
    "near @xmath66 we have an expansion @xmath178 where @xmath179 is the second derivative of @xmath180 with respect to the first argument , @xmath181 is the second partial derivative of @xmath182 with respect to the second argument of the function @xmath183 . dividing eq.([e38 ] ) by @xmath184",
    ", we derive the equation @xmath185 or @xmath186^{1/4}}.\\end{aligned}\\ ] ] from eq.(36 ) we have : @xmath187\\nonumber\\\\ & + & [ e^{2u'}(1+c\\frac{1-s}{2})+(1+c\\frac{1+s}{2})e^{-2u ' } ] \\nonumber\\\\ & + & 2u''[e^{2u'}\\frac{1+m}{2}(1+c\\frac{1-s}{2 } ) \\nonumber \\\\ & & + \\frac{1-m}{2}(1+c\\frac{1+s}{2})e^{-2u'}]\\nonumber\\\\ & + & cu_1'(s)\\frac{m - e^{2u'}\\frac{1+m}{2}+e^{-2u'}\\frac{1-m}{2}}{2|u''|}.\\end{aligned}\\ ] ] the first line is a direct integration of the fitness via steady state distribution , the second line corresponds to the correction of @xmath188 via @xmath189 , the third line corresponds to the corrections in the first line of eq.([e33 ] ) .",
    "the last line corresponds to the @xmath190 corrections from the @xmath191 terms in eq.([e33 ] ) .    to calculate @xmath70",
    ", we put the optimal value of @xmath63 and look at the point @xmath72 . then eq.(44 )",
    "is simplified : @xmath192.\\end{aligned}\\ ] ] deriving @xmath193 from the last equation , we obtain @xmath194 thus @xmath195 @xmath196-\\frac{f''(s)}{f'(s)}]\\ ] ]    for the fitness function @xmath197 with parameters @xmath198 , we derive from the numerics for the mean fitness and order parameters @xmath199 . the analytical formula eq.([e37 ] ) for the infinite genome limit gives @xmath200 , while the numerics for @xmath201 gives @xmath202 and for @xmath203 @xmath204 .",
    "thus we get for @xmath201 , @xmath205 and for @xmath206 , @xmath207 .",
    "we see that our analytical result by eq .",
    "( [ e44 ] ) for the mean fitness expression is well confirmed .",
    "one can define @xmath103 by integrating the expression of @xmath104 from eq .",
    "( [ e42 ] ) .",
    "we calculated the finite genome size corrections to the mean fitness and steady state distribution for strongly nonlinear evolution models : horizontal gene transfer model and diploid parallel evolution model for general fitness function .",
    "the application of the hamilton - jacobi equation for the investigation of the master equation , especially the finite size corrections , is a rather popular method in case of linear master equation for chemistry or ecology @xcite,@xcite . for the models , considered in our article",
    ", the standard methods of linear algebra and the methods of @xcite,@xcite fail .",
    "the key point of our method is that we investigate the point where the coefficient of the correction to the steady state distribution disappears .",
    "then the correction to the fitness is calculated from the smoothness condition .",
    "our method could be applied to other nonlinear probabilistic models as well .",
    "our formulas could be applied for relatively small genome lengths , for the single peak fitness landscape even for @xmath208 , see appendix a. in population genetics usually few allele models are investigated with @xmath209 .",
    "fortunately , for the larger allele numbers we can apply our methods .",
    "our formulas , while a bit involved , are less cumbersome than the formulas for several allele cases in population genetics .",
    "dbs thanks darpa prophecy program and academia sinica for financial support .",
    "consider the following diploid model studied in @xcite : @xmath210 \\nonumber \\\\ & + & \\sum_jm_{ij}p_j\\end{aligned}\\ ] ] with the fitness coefficients @xmath211 here @xmath106 is the mutation matrix , @xmath212 for @xmath20 , and for other cases @xmath213 .    for the steady state",
    "we have @xcite @xmath214.\\end{aligned}\\ ] ] here @xmath215 takes one of the solution @xmath216 defined below @xmath217 where @xmath218 , @xmath219 , and @xmath220 .",
    "we have for the marginal fitness @xmath221 and the fitness @xmath47 @xmath222.\\end{aligned}\\ ] ] in terms of the marginal fitness , the original equation ( a1 ) can be written in the form @xmath223 where @xmath90 are the class probabilities of the configurations at the hamming distance @xmath36 from the reference sequence , @xmath224 , and @xmath225 .",
    "for the @xmath228 , we have the equation @xmath229 replacing on the right hand side and before the parenthesis on the left hand side @xmath230 and @xmath231 @xmath232 we find a perturbation expression for @xmath233 @xmath234 and for @xmath235 @xmath236}]}.\\end{aligned}\\ ] ] for @xmath237 we get @xmath238 , while @xmath239 , thus we have @xmath240 accuracy .",
    "d. b. saakian , z. kirakosyan , c .- k .",
    "hu , phys . rev .",
    "e , * 77 * , 061907 ( 2008 ) .",
    "e. munoz , j .-",
    "park , and m. w. deem , _",
    "phys.rev.e _ * 78 * , 061921 ( 2008 ) .",
    "avetisyan , d.b .",
    "saakian , phys.rev.e . *",
    "81 * , 051916 ( 2010 ) .",
    "n. n. v. vijay , vasantika , r. ajmani , a. s. perelson , and n. m. dixit , j. gen .",
    "virology * 89 * , 1467,(2008 ) . c. escudero and a. kamenev , phys.rev .",
    "e * 79 * , 041149 ( 2009 ) .",
    "m. assaf and b. meerson , phys.rev .",
    "e * 81 * , 021116 ( 2010 ) ."
  ],
  "abstract_text": [
    "<S> using the hamilton - jacobi equation approach to study genomes of length @xmath0 , we obtain @xmath1 corrections for the steady state population distributions and mean fitness functions for horizontal gene transfer model , as well as for the diploid evolution model with general fitness landscapes . </S>",
    "<S> our numerical solutions confirm the obtained analytic equations . </S>",
    "<S> our method could be applied to the general case of nonlinear markov models . </S>"
  ]
}