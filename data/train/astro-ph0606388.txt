{
  "article_text": [
    "an experienced optician can detect low - order aberrations by looking at the defocused image of a point source , and it is trivial to obtain defocused images with modern telescopes equipped with ccd detectors .",
    "yet , measurements of low - order aberrations including focus are still made by indirect techniques , or using special equipment such as shack - hartmann ( s - h ) sensors .",
    "astronomers spend significant time in acquiring `` focus sequences '' of stellar images , then fitting the image half - width vs. focus curve with a parabola to find the best - focus position .",
    "the appeal of estimating aberrations directly from defocused images is evident .",
    "no special equipment is needed apart from a regular imager .",
    "the aberrations in the true science beam are measured , including all optics of the instrument but excluding additional optics of a wave - front sensor .",
    "the amount of defocus is easily adjustable , providing flexibility .",
    "it was recognized since long time that optical aberrations can not be retrieved from a focused image of a point source without ambiguity . however , combining _ two _ images with a known difference of aberration provides a solution to this problem , even for non - point sources .",
    "the method of _ phase diversity _ which exploits this idea has been used since the beginning of the 80-s @xcite .",
    "phase diversity works well when the image is sampled to the diffraction limit , e.g. in adaptive optics @xcite .",
    "this is not the case for conventional astronomical imagery with a pixel size matched to the seeing .",
    "yet another method for extracting aberrations from well - sampled focused images by means of a trained neural network was suggested by sandler and later tried by @xcite .",
    "the authors note that their method is extremely computationally intensive and has some subtleties . to our knowledge",
    ", this method is not in use nowadays .",
    "the relation of the intensity distribution in a defocused image to the local wavefront curvature is described by the so - called irradiance transport equation @xcite .",
    "this relation is basic to _ curvature sensing _ as used in adaptive optics @xcite .",
    "a commercial software package for telescope aberration analysis based on the same principle has been developed by northcott and is used at some observatories .",
    "this method , however , is not very practical because it requires two images with relatively large and equal defocus of opposite sign .",
    "the need of two images for curvature sensing has been questioned by @xcite who shows that even in the context of adaptive optics a single extra - focal image is sufficient and provides a better signal - to - noise ratio with a ccd detector and faint guide stars , despite scintillation noise .",
    "one image is sufficient for non - ambiguous aberration retrieval as long as the rays originating from different parts of the aperture do not cross each other , i.e. for a sufficiently large defocus that avoids caustics .",
    "the minimum defocus is proportional to the amplitude of higher - order aberrations . @xcite",
    "have used this technique in their experiment .",
    "the intensity transport equation is not valid for a small defocus , where physical optics must be used instead . however",
    ", this is not an obstacle for sensing low - order aberrations , as long as they are small enough , so that a relation between aberration and image intensity remains linear .",
    "@xcite develop such near - focus sensing technique for low - order adaptive optics , providing in their paper several valuable insights into this problem .",
    "however , their method still requires two images , intra- and extra - focal .    here",
    "we present a quantitative method of measuring optical aberrations from a single defocused image .",
    "such images often resemble donuts ( because of the shadow at the center caused by the central obscuration in a cassegrain telescope ) , so we call this technique `` donut '' .",
    "this work is primarily motivated by the need for a simple wave - front sensing method for the soar telescope in chile @xcite .",
    "all numerical examples in the article were computed for a telescope diameter @xmath0  m with a central obscuration 0.24 , appropriate for soar .",
    "the proposed technique is primarily intended for active optics , it is too slow for real - time correction of turbulence .",
    "the donut method is different from standard curvature sensing .",
    "we use physical optics and directly fit a model of the aberrated image to the measured `` donut '' .",
    "the initial approximation is obtained from the second moments of the intensity distribution as described in sect .",
    "[ sec : mom ] .",
    "then an iterative fitting algorithm presented in sect .",
    "[ sec : fit ] , with further details in the appendix , is used to refine the model including higher order aberrations . in sect .",
    "[ sec : perf ] we evaluate the errors of aberrations measured by this method and compare it to a low - order shack - hartmann sensor while examples of actual performance are given in sect .",
    "[ sec : exa ] .",
    "finally we present our conclusions in sect .",
    "[ sec : concl ] .",
    "to begin the presentation of our algorithm we recall the textbook theory of image formation , e.g. @xcite .",
    "let @xmath1 be the 2-dimensional angular coordinate in the image plane ( in radians ) and @xmath2  the coordinate in the plane of telescope pupil .",
    "the shape of the wave - front is @xmath3 and the phase of the light wave is @xmath4 for the wavelength @xmath5 .",
    "then the intensity distribution in the image plane @xmath6 is computed as    @xmath7    where @xmath8 is the pupil transmission function and the normalization constant @xmath9 is of no importance here .    in our implementation of the algorithm ,",
    "the computation of ( [ eq : i ] ) is carried out using the fast fourier transform ( fft ) on a square numerical grid of @xmath10 points ( fig .",
    "[ fig : grids ] ) .",
    "the linear size @xmath11 of the pupil - plane grid should be large enough for a telescope diameter @xmath12 , @xmath13 ; critical sampling of diffraction - limited images requires @xmath14 .",
    "then the sampling in the image space is @xmath15 ( smaller than the diffraction limit @xmath16 ) and the size of the field of view is @xmath17 .",
    "we select a part of the image centered on the star that fits into this field . in the case of large telescopes",
    "the sampling is fine , hence we are forced to select a large grid size @xmath18 to have enough field , at the cost of slower calculation . for computational efficiency",
    "@xmath18 has to be an integer power of 2 .",
    "the choice @xmath19 is good for a 4-m telescope .",
    "the ccd pixels are normally much larger than @xmath16 , hence the resulting image has to be binned by some factor @xmath20 .",
    "the number of `` coarse '' ccd pixels is then @xmath21 . considering that @xmath18 is a power of two",
    ", both @xmath20 and @xmath22 also have to be integer powers of two .",
    "typically , @xmath23 and @xmath24 .",
    "the ccd pixel size is then @xmath25 .",
    "the wavefront is represented as a sum of zernike aberrations up to some number @xmath26 ,    @xmath27    zernike polynomials in the form of @xcite are used .",
    "their amplitudes ( coefficients @xmath28 ) are equal to the rms wavefront variance over the pupil .",
    "the piston term @xmath29 is omitted .",
    "defocused images ( donuts ) are obtained by setting the focus coefficient @xmath30 to some large positive or negative value .",
    "a monochromatic image computed from ( [ eq : i ] ) contains sharp details of the size @xmath16 caused by diffraction .",
    "these details are usually not seen , being smoothed by coarse detector pixels and seeing . in this case",
    "the monochromatic image model also represents broad - band images , and we can even use a value of @xmath5 in the simulation which is larger than the actual wavelength of observation to , in effect , increase the size of the modeled field .",
    "the blur caused by the time - averaged seeing is modeled as a convolution with a gaussian kernel .",
    "the fwhm of the seeing disk @xmath31 is proportional to the gaussian parameter @xmath32 , @xmath33 .",
    "the convolution is computed in frequency space by multiplying the fft of the image , @xmath34 , by a filter    @xmath35    and doing the inverse fft .",
    "this double fft is costly in computing time if done on the full @xmath36 grid . when detector pixels are smaller than @xmath31 , as is the case of astronomical imagers , a much faster calculation on a grid of ( binned ) detector pixels is justified .",
    "seeing , together with a set of zernike coefficients , forms a vector of parameters that define the donut model .",
    "we put the seeing in the first element of this vector @xmath37 , replacing the useless piston term .",
    "an example of donut images corresponding to first few zernike aberrations is shown in fig .",
    "[ fig : mosaic ] .",
    "first - order moments ( centroids ) of telescopic images are widely used for guiding . here",
    "we show that the second moments are equally useful for estimating the second - order aberrations , defocus and astigmatism .",
    "let @xmath38 be the image of a point source presented as an array of detector pixels @xmath39 .",
    "the coordinates @xmath40 and @xmath41 are measured in pixels .",
    "the zero - order moment @xmath9 , first moments @xmath42 and @xmath43 ( in pixels ) and the second moments @xmath44 , @xmath45 , and @xmath46 ( in square pixels ) are :    @xmath47    evident combinations of the second moments relate them to defocus and astigmatism .",
    "indeed , the defocus should be proportional to the size of the donut which , in turn , is the average of its size in @xmath40 and @xmath41 .",
    "the @xmath48 astigmatism @xmath49 causes image elongation in the diagonal direction and should be proportional to @xmath46 , whereas @xmath50 should be proportional to the difference of the image size in @xmath40 and @xmath41 .",
    "thus , we introduce the coefficients @xmath51 , @xmath52 , and @xmath53 and express them in angular units ( e.g. arcseconds ) with the help of the angular size of detector pixel @xmath54 :    @xmath55    next we must find the relationship between those coefficients and the zernike amplitudes . in the case of defocus , this is relatively straightforward .",
    "the second moment of a uniform disk of radius @xmath56 is readily calculated to be @xmath57 . on the other hand , the angular radius of the defocused image @xmath56 is found as the first derivative of the wavefront at the edge of the pupil ( in the geometrical - optics approximation ) ,    @xmath58    where @xmath30 is the zernike coefficient of the wavefront .",
    "this leads to @xmath59 .",
    "there is similar linear relation between @xmath52 and @xmath49 with a different coefficient .",
    "we did not derive this analytically , but rather found the coefficient by means of numerical simulation , @xmath60 and @xmath61 .",
    "our simulations show that @xmath52 and @xmath53 are indeed very good measures of the astigmatism ( fig .",
    "[ fig : focus ] ) . to the first order ,",
    "they do not depend on defocus ( provided it is larger than the astigmatism itself ) and on other higher - order aberrations . on the other hand , the linear relation between @xmath51 and @xmath30 holds only when the defocus dominates the seeing blur and pixel size , and there is always some bias .",
    "second moments provide an easy and fast way to evaluate the defocus and astigmatism . to recover the sign of these aberrations , however , we need to know if the donut is intra- or extra - focal .",
    "the moments are used as a first step in fitting models to a donut image .",
    "second moments are finite in geometrical - optics approximation but they diverge in physical optics because the intensity of a diffraction spot does not decrease rapidly enough .",
    "practically , only a finite number of image pixels is considered , hence the divergence of second moments is not an issue .",
    "the computation of @xmath51 may be used as a more efficient means of focusing the telescope than the traditional focus sequence .",
    "figure  [ fig : focus ] shows that a dependence of the image size on the true focus has zero slope near @xmath62 , hence the method of focus sequences ( series of images near best focus ) has the lowest sensitivity to focus and the highest sensitivity to seeing variations . by taking one image sufficiently far from focus and extrapolating back ,",
    "we obtain a better sensitivity and less vulnerability to seeing",
    ". however , a small bias due to seeing still remains .",
    "this can be eliminated by taking two images with large defocus bracketing the expected true focus .",
    "let @xmath63 and @xmath64 be the focus parameters ( without sign ) derived from these two images that correspond to the focus encoder settings @xmath65 and @xmath66 , respectively .",
    "evidently , @xmath67 where @xmath68 is the encoder setting for perfect focus , @xmath69 is the proportionality coefficient specific for each telescope , and @xmath70 is the small bias due to seeing , which we assume to be the same for both exposures .",
    "it is possible to determine two unknowns @xmath68 and @xmath70 from this system , so the true focus encoder setting is @xmath71    the reason this method is not in common use at observatories is likely related to the need to determine the value of @xmath69 for each telescope / detector combination and the need to have a reliable focus encoder .",
    "however , the method should be faster and more accurate than traditional focus sequences .",
    "hopefully , it will become a standard tool in astronomical imaging .",
    "the relation between the phase aberrations and resulting image is doubly non - linear .",
    "the first non - linear transformation occurs in the conversion from the phase distribution @xmath72 to the complex light amplitude @xmath73 .",
    "the second non - linear transformation is the calculation of the intensity distribution as a square modulus of the fft .",
    "thus , it is not possible to fit a model in a straightforward way , but rather iterative methods have to be employed . at each iteration ,",
    "small differences between the model and the image are translated into small corrections to the model .",
    "an insight into the fitting process is provided by the theory of curvature sensing @xcite .",
    "a defocused image can be considered as being an approximate image of the pupil where each aberration produces a signal proportional to the local curvature ( laplacian ) .",
    "thus , in the limit of small aberrations , the intensity distribution in the donut can be represented as the sum of laplacians of the zernike modes with suitable coefficients and scaling .",
    "this provides the required linearization for deriving the correction at each iteration step . in other words",
    ", a combination of a large known aberration ( defocus ) with small high - order aberrations leads to an approximate linearization of the image - formation process with respect to high - order terms .",
    "the method of modeling the donut is as follows ( fig .",
    "[ fig : fit ] ) .",
    "the first estimate of the zernike coefficients up to @xmath50 is derived by the method of moments ( we initially set @xmath74 ) . at the second step , the gradients of the model with respect to each of the parameters are computed as differences between the model image and images obtained by varying each zernike coefficient by a small amount .",
    "these differences are computed for each pixel of the image and combined in the _ interaction matrix _",
    "@xmath75 of the size @xmath76 , where @xmath77 is the total number of pixels in the image and @xmath26 is the number of fitted zernike terms .",
    "this matrix relates small variations of the parameters ( seeing and zernike coefficients ) to the variations of the signal  intensities in each pixel .",
    "the seeing is considered as an additional unknown parameter and fitted jointly with the aberration coefficients .",
    "the matrix @xmath75 is inverted , so the differences between the model and the actual image can be converted into the corrections to the zernike coefficients .",
    "the new set of coefficients is the new model which , hopefully , is a better approximation of the donut .",
    "the process of image formation being non - linear , we have to repeat this linearized fitting again and again iteratively until the model converges .",
    "the algorithm is similar to the closed - loop wavefront control algorithm used in adaptive optics : at each iteration we obtain a better approximation to the donut .",
    "further details are given in the appendix .",
    "the number of `` resolution elements '' across the pupil is of the order @xmath78 .",
    "thus , if aberrations of high - order are to be measured , a larger donut radius @xmath56 is needed . on the other hand ,",
    "curvature sensors are known to suffer from severe aliasing , where un - modeled high - order aberrations distort the low - order coefficients .",
    "hence , a defocus of @xmath79 is recommended for sensing aberrations up to the radial order @xmath80 .",
    "these considerations are further developed in the next section .",
    "suppose we want to measure zernike coefficients up to 11 ( spherical aberration ) by fitting a model to the donut . to what extent",
    "is the result distorted by the presence of high - order aberrations ?",
    "let @xmath81 be the amplitude of un - modeled high - order aberration ( @xmath82 ) which produces an error @xmath83 of the @xmath84-th coefficient .",
    "the ratio @xmath85 is called the _ aliasing coefficient_. figure  [ fig : alias ] plots these coefficients for astigmatism ( @xmath86 ) .",
    "the @xmath49 term is aliased mostly with @xmath87 and @xmath88 assuming seeing of @xmath89 .",
    "the condition @xmath90 is approximately satisfied in this example .",
    "however , if the seeing improves to @xmath91 , the aliasing coefficient with @xmath87 increases from @xmath92 to @xmath93 .    clearly , aliasing can be a problem for a donut sensor , as it is for any curvature sensor .",
    "the evident solution , though , is to increase the order of the fitted model until all aliased terms are explicitly taken care of . another way to reduce",
    "the aliasing is to decrease the defocus to the minimum value required to measure a selected set of low - order aberrations .    for comparison",
    ", we studied the aliasing of astigmatism measured by a 2x2 s - h sensor .",
    "we find that , if the full telescope aperture is used , the aliasing coefficient of @xmath49 with @xmath87 is @xmath94 , and that the aliasing coefficient is even larger for some higher terms .",
    "the aliasing of an s - h sensor can be reduced by reducing the portion of the aperture used for a 2x2 sensor or by increasing the order of the sensor .",
    "it is clear , however , that aliasing in a low - order s - h sensor is of the same order as for the donut method , with less options available for decreasing it .      in some instances",
    "it is important to measure optical aberrations with relatively faint stars .",
    "the readout and photon noise may then become an issue because the light in a donut is spread over many ccd pixels .",
    "the problem can be studied by simulating a series of noisy images and evaluating the scatter of the measured zernike coefficients .",
    "however , a much faster analytical evaluation of the errors is available through the covariance matrix , eq .",
    "[ eq : cz ] .",
    "we have verified that this method gives an answer which is consistent with the results of direct monte - carlo simulation .    for a given total number of detected photons @xmath95 and a given readout noise @xmath96",
    ", the errors of measured zernike coefficients depend on the size of the donut , the size of detector pixel , seeing and aberrations . in the following",
    "we assume that all aberrations except defocus are corrected , as would be appropriate in an active - optics application ; if this is not true , the results would be different .",
    "an example of optimization for measuring @xmath49 under @xmath89 seeing is shown in fig .",
    "[ fig : ast2 ] for a faint star , when the noise is mostly dominated by the detector readout noise .",
    "the optimum pixel scale in these conditions is about @xmath89 and the optimum donut diameter is about @xmath97 .",
    "however , large deviations from these optimum values cause only a minor increase of the noise .",
    "the optimum parameters depend on the zernike number , on seeing and on the flux @xmath95 .",
    "a reasonable choice of parameters can be made to ensure a near - optimum measurement of several zernike coefficients for a range of seeing conditions .    in the case of faint stars when the detector noise @xmath96 dominates",
    ", the errors of the zernike coefficients must be proportional to @xmath98 .",
    "the calculations show this to be approximately true up to @xmath99 ( for our choice of @xmath100 ) . at larger flux",
    ", the errors improve only as @xmath101 . however , the photon - noise errors in the bright - star regime are so small that they become irrelevant compared to other errors .    the intensity modulation in the donut increases with increasing number @xmath84 ( at constant amplitude @xmath28 ) , because it is roughly proportional to the curvature .",
    "equating the modulation with noise , we expect that noise propagation decreases with @xmath84 .",
    "this is indeed the case .",
    "one notable exception , however , is the spherical aberration which can have an error much larger than other terms of the same order .",
    "we trace this anomalous behavior to the cross - talk between @xmath102 and seeing .",
    "indeed , processing of real data shows that the estimates of @xmath102 and @xmath31 are often less repeatable , compared to other terms .",
    "we compared the sensitivity of the donut method for measuring astigmatism with that of a 2x2 s - h sensor and found that their performance in the low - flux regime can be very similar ( fig .",
    "[ fig : noisecomp ] ) .",
    "the noise was computed by the same method for both measurement techniques i.e. by relating errors of pixel intensities directly to the errors of zernike coefficients .",
    "this should give the lowest possible error .",
    "in practice , aberrations are normally derived in a s - h sensor from centroids of the spots , hence with somewhat larger errors .",
    "naturally , the noise depends on the parameters such as defocus , seeing , and pixel size , hence in some situations s - h sensors can perform better than donut .",
    "s - h is to be preferred for measurement of atmospheric tip - tilt errors . the formal sensitivity of donut to tip and tilt",
    "is only slightly inferior to that of s - h , but at short exposures the centroids of the donut images will be severely displaced by higher - order aberrations and will not provide good measurements of tilts .",
    "the iterative fitting has been tested on different simulated donut images and always produced the expected result .",
    "however , processing real data is sometimes more tricky .",
    "the interaction matrix @xmath75 depends on the aberrations , it changes between different images and even during the fitting of one image .",
    "when a large number of zernike terms is considered , it is common to encounter low singular values in @xmath75 .",
    "this means that some combinations of parameters are not well constrained by the data , hence the noise will be amplified .",
    "leaving such combinations un - fitted by rejecting small singular values does not solve the problem because we may obtain a good model of the donut image with a parameter set which is very different from the true parameters .",
    "this happens when significant high - order aberrations are present , but the defocus is not large enough , i.e. in the caustic regime .",
    "one way to get around this problem is to determine high - order aberrations separately ( e.g. by fitting a bright - star image with a large defocus ) and then to include them in the model for low - order fits . including such pre - defined parameters ( we call them static aberrations )",
    "improves the convergence and the fit quality .",
    "low - order fits are more stable and give reproducible results",
    ". however , the coefficients of low - order aberrations derived in this way depend on the adopted static aberrations : a different result is obtained from the same data when a different vector of static aberrations is supplied initially .      in real life , optical aberrations in the beam change with time because of the instability of telescope optics , the changing refractive index of the air in the dome , and seeing . averaging donut images over a sufficiently long time @xmath103 ( typically 10 - 30s ) reduces the contribution of variable aberrations only by a factor of @xmath104 , where @xmath105 is the time constant of the variation .",
    "consider , for example , a 4-m telescope with 5  m / s wind and @xmath89 seeing .",
    "the rms amplitude of the random astigmatism caused by the seeing is 270  nm , according to the formulae of @xcite , and its time constant is 0.25  s. thus , in a 10-s exposure we expect a random error of astigmatism of the order of 40  nm , or larger if the wind is slow and/or some aberrations are produced by air inside the dome .",
    "the statistical noise can be reduced by taking longer exposures but may still remain a dominating error source .",
    "if the donut image is blurred in one direction by imperfect guiding or telescope shake during the exposure , this departure from the ideal model will result in spurious aberrations , mostly astigmatisms of 2-nd and 4-th order .",
    "simulations for the case of soar show that a blur of @xmath89 causes errors of @xmath50 and @xmath106 of only 20  nm , a smaller blur has negligible effect .",
    "hence the blur is never a problem at modern telescopes with good tracking .",
    "[ cols=\"<,^,^,^,^,^,^\",options=\"header \" , ]     several series of defocused images were taken at the soar telescope in march 2005 and processed with the donut algorithm .",
    "one example shown in fig .",
    "[ fig:113 ] was acquired with a pixel scale of @xmath107 and 25-s exposure time using a conveniently bright star .",
    "an astigmatism was introduced intentionally by de - tuning the actively controlled primary mirror .",
    "extra- and intra - focal images were fitted independently of each other with @xmath108 terms . at each focus setting , two images were acquired .",
    "the defocus of 3  @xmath109 m produces donut images of 42 diameter .",
    "the results ( table  [ tab : result ] ) show a good coherence of the measurements , irrespective of which side of the focus they were taken .",
    "the residuals between model and image are from 5% to 9% .",
    "the presence of uncorrected ( but well - modeled ) high - order aberrations is evident in fig .",
    "[ fig:113 ] .",
    "yet another test was done by fitting defocused images of different stars in the same exposure .",
    "the flux in the image 137a is 30 times more than in the image 137d , yet the zernike coefficients derived from these images agree well ( table  [ tab : result ] ) . here",
    ", the fit has been limited to 11 terms ( with static aberrations up to @xmath110 ) , because full fitting of 28 terms did not give reproducible results .",
    "this instability is apparently caused by significant high - order aberrations , as seen in fig .",
    "[ fig:113 ] .",
    "an estimate of the internal accuracy of the donut method was obtained by processing several consecutive images .",
    "the rms scatter of the coefficients for 2-nd and 3-rd order aberrations ranges typically from 0.05 to 0.15  @xmath109 m for 60-s exposures .",
    "the donut method has been compared with the soar high - order shack - hartmann control wfs ( cwfs ) that is part of the active - optics system used for tuning the primary mirror .",
    "the response of the primary mirror actuators was calibrated independently by the manufacturer and is @xmath111 times larger than the aberrations measured by the cwfs .",
    "the donut data were taken with the soar imager and binned to the pixel scale of @xmath107 .",
    "three 60-s exposures for each setting were processed independently , providing an estimate of the measurement errors .",
    "the cwfs data are single measurements with 10  s exposure , more vulnerable to the insufficiently averaged atmospheric and dome turbulence than donuts .",
    "the measurements with donut and cfws are sequential as these devices occupy different focii of soar .",
    "the zernike coefficients obtained with donut were rotated to the cfws system by the known angle between these instruments .",
    "both instruments give zernike coefficients on the same scale  rms microns of wavefront aberration .",
    "figure  [ fig : cwfs]a shows a comparison between the two sensors as the telescope was tipped in elevation and brought back .",
    "the systematic trend of the @xmath112 astigmatism with elevation is evidenced by both methods , with some offset and scale factor apparent from the linear regression .",
    "the scatter of points around this regression is typical for such tests and compatible with the internal consistency of each method .    for another test ,",
    "the shape of the soar primary was distorted by `` dialing in '' astigmatism coefficients in @xmath112 and @xmath48 with a full amplitude @xmath113  @xmath109 m and a step 0.25  @xmath109 m ( these numbers refer to the primary mirror aberrations as determined by the manufacturer ) .",
    "the mirror was initially flattened with the cfws . the result ( fig .",
    "[ fig : cwfs]b ) shows that the donut method measures these aberrations with a coefficient of @xmath114 ( same as the cwfs ) and an offset presumably arising from the fixed difference of optical aberrations between the focii of cwfs and imager .",
    "the classical 4-m blanco telescope at cerro tololo is equipped with the wide - field ccd mosaic at its prime focus .",
    "the pixel scale is @xmath115 .",
    "we processed donut images extracted from the standard focusing sequences ( exposure time 10  s per focus setting , maximum defocus 1.5 to 2  @xmath109 m ) .",
    "although these data were not intended for the aberration analysis , fitting them with donut models was quite successful , with a typical rms intensity residuals of 6% for 28 zernike terms .",
    "the fitting takes 2030  s on a 1  ghz pc with @xmath19 grid .    comparing the coefficients of low - order aberrations determined from the first and the last images in each sequence , we find a typical difference of 0.1  @xmath109 m or less , i.e. similar to the soar data presented in table  [ tab : result ] .",
    "the most likely reason of these differences is a real slow variation of the aberrations between exposures in the focusing sequence .",
    "we processed the first image of the focusing sequence extracted from 11 different stars in one of the detector segments .",
    "these images are simultaneous and the scatter of the measured coefficients in this test was much smaller , from 0.025 to 0.073  @xmath109 m .",
    "part of this scatter is caused by real variations of the aberrations across the field .",
    "figure  [ fig : coma ] shows a clear trend in the coma coefficient @xmath116 as a function of the @xmath41-coordinate of the star .",
    "this example shows how a quantitative analysis of optical aberrations can be done with simplicity , as a by - product of standard observations .",
    "it is possible to measure aberrations across the field of a prime - focus camera with a hartmann mask , but the donut technique makes this task much easier . the rms accuracy can reach 25  nm , or @xmath117 .",
    "we have shown that focus and astigmatism can be evaluated quantitatively from the second moments of defocused images .",
    "one useful application of this analysis will be a fast and accurate focusing procedure for classical imaging , suggested here as a replacement of traditional focusing sequences .",
    "furthermore , donut images can be fitted directly to a set of zernike coefficients ( complemented with an additional parameter , seeing ) , offering a practical way to measure aberrations and to tune the optics of ground - based telescopes .",
    "the donut method proposed here is different from the standard curvature sensing in several aspects .",
    "first , only one defocused image is needed .",
    "second , no simplifying assumption of linearity is made , hence the defocus may be quite small while measuring aberrations of significant amplitude  comparable to the defocus itself .",
    "third , we do not use the intensity transport equation @xcite but rather compute the image model by a full fraunhofer diffraction integral using an fft .",
    "finite detector pixel size and additional blur caused by the seeing are explicitly taken into account .",
    "these two effects usually wash out any traces of diffraction , so the calculated monochromatic image is a good model of a wide - band image as well .    the down - side of the full diffraction image modeling is a slow calculation time ( a few seconds for a 4-m telescope ) and a restriction of the modeled field of view .",
    "the donut method will work best for small defocus values and for measuring low - order aberrations . on the other hand , classical curvature sensing",
    "would be probably a better choice for high - resolution sensing , where a wave - front map ( rather than zernike coefficients ) is sought .",
    "we plan to apply the donut technique to the closed - loop control of the soar active optics and to optical characterization of other telescopes at ctio .",
    "the method seems to be simple and mature enough to be offered to other interested users .",
    "so far , it is implemented in the idl language .",
    "we thank d.  maturana , s.  pizarro and h.e.m .",
    "schwarz for taking defocused images at soar , b.  gregory for processing the images and his valuable comments , a.  rest for the help in extracting the mosaic data .",
    "the comments of p.  hickson on the draft version of this paper are gratefully acknowledged .",
    "bharmal , n.a . ,",
    "buscher , d.f . , & haniff , c.a .",
    "2005 , mnras , 360 , 1325    born , m.a . & wolf , e. , principles of optics .",
    "oxford : pergamon press , 1968 .",
    "hartung , m. , blanc , a. , fusco , t. et al .",
    "2003 , proc .",
    "spie , 4841 , 295    hickson , p. 1994 , josa(a ) , 11 , 1667    krabbendam , v.l .",
    ", heathcote , s. , schumacher , g. , schwarz , h.e .",
    ", sebring , t.a . , & warner , m. 2004 , proc .",
    "spie , 5489 , 615    lloyd - hart , m. , wizinovich , p. , mcleod , b. et al .",
    "1992 , apj , 390 , l41    noll , r.j .",
    "1976 , josa , 66 , 207    press w.h .",
    ", teukolsky s.a . , vetterling w.t . ,",
    "flannery b.p .",
    ", numerical recipes in c , cambridge univ . press , cambridge , uk , 1992    ragazzoni , r. , marchetti , e. , & valente , g. , 2000 , nature , 403 , 54    roddier , f. , ed .",
    "adaptive optics in astronomy , cambridge university press , cambridge , 1999    roddier , f. 1990 , appl . opt . , 29 , 1402    sebring , t.a . , cecil , g. , & moretto , g. 1998 , proc .",
    "spie , 3352 , 62    thelen , b.j . , paxman , r.g .",
    ", carrara , d.a . , & seldin , j.h .",
    "1999 , josa(a ) , 16 , 1016",
    "the interaction matrix @xmath75 relates intensity changes in the detector pixels to the variation of the zernike coefficients .",
    "the size of @xmath75 is @xmath118 elements , where @xmath77 is the total number of pixels in the modeled donut image and @xmath26 is the number of modeled zernike terms ( including seeing which replaces the piston term ) .",
    "the pixels are re - indexed sequentially , @xmath119 .",
    "the initial vector of parameters @xmath120 is supplied at the beginning , with the first element @xmath121 representing seeing .",
    "our task is to find the estimate of @xmath1 that ensures the best correspondence between the model @xmath122 and the image @xmath123 .",
    "both model and image are normalized to keep the sum of pixel intensities equal to one .",
    "we compute @xmath75 by varying each zernike coefficient by a small amount @xmath124 radians , @xmath80 being the radial order .",
    "this choice of decreasing amplitudes ensures that the image variations remain in the linear regime .",
    "the seeing is changed by @xmath125 .",
    "so , a @xmath84-th column of @xmath75 is equal to the normalized difference between pixel values of the image model @xmath126 that result from changing the @xmath84-th term , @xmath127 /   \\delta a_j   .",
    "\\label{eq : hcalc}\\ ] ] a large economy of calculation is achieved by saving the complex amplitude at the telescope pupil for a given model @xmath1 . when re - calculating the image with just one modified zernike term @xmath28 , we only need to multiply the saved amplitude by the factor @xmath128 $ ] , instead of re - computing all zernike terms .",
    "the interaction matrix @xmath75 is inverted in the sense of least - squares ( ls ) , @xmath129 the inversion of @xmath130 is done by singular value decomposition @xcite , rejecting weak singular values below some threshold .",
    "this guarantees that poorly measurable combinations of model parameters do not lead to increased noise .",
    "in fact , we progressively decrease the threshold during iterations when they converge ( i.e. when the residuals decrease ) , but reset it to the original high value ( 0.05 of the maximum singular value ) in the case of divergence .",
    "the inverse matrix @xmath131 is multiplied by the vector of intensity differences between the input image @xmath123 and the model image @xmath132 to get the correction of the zernike coefficients @xmath133 :      this equation , however , treats all pixels with equal weight .",
    "a somewhat more rigorous approach takes into account the detector and photon noise , which differs from pixel to pixel .",
    "let the rms detector noise ( ron ) be @xmath96 and the total number of photons in the image ( flux ) be @xmath95 .",
    "the pixel intensities @xmath135 are normalized so that @xmath136 . in this case",
    "the noise variance @xmath137 of the measured intensity in a pixel @xmath138 is      a flavor of ls fitting to data with variable and un - correlated noise is known as _ weighted least - squares_. if the columns of the interaction matrix @xmath75 and the residuals @xmath140 are both divided by @xmath141 , the problem is reduced to the ls fitting with constant noise .",
    "the weighted interaction matrix @xmath142 replaces @xmath75 in ( [ eq : h * ] ) to calculate @xmath131 .",
    "the data vector @xmath143 normalized by @xmath141 has uncorrelated elements with unit variance .",
    "hence the covariance matrix of the restored zernike coefficients @xmath144 is simply related to the restoration operator @xmath131 ,      the variances of the measured zernike coefficients caused by noise are equal to the diagonal elements of @xmath144 .",
    "this provides an evaluation of the noise component of measured aberrations related to the detector and the brightness of the star . in practice , however , we do not use the normalization by @xmath146 because it gives high weight to pixels outside donut and often prevents the convergence .",
    "the quality of the fit is characterized by the relative residuals @xmath147 , @xmath148 the iterations continue until a condition @xmath149 is reached , i.e. when the residuals do not decrease significantly any more .",
    "reasonably good fits have @xmath150 . to ensure robust convergence , we add at each step only a fraction of the computed correction , @xmath151 .",
    "if at the next iteration @xmath147 increases , the parameters are not changed at all , but the svd threshold is re - set to a high value .",
    "the interaction matrix is re - computed only at even iteration steps , to save time ."
  ],
  "abstract_text": [
    "<S> we propose a practical method to calculate zernike aberrations from analysis of a single long - exposure defocused stellar image . </S>",
    "<S> it consists in fitting the aberration coefficients and seeing blur directly to a realistic image binned into detector pixels . </S>",
    "<S> this `` donut '' method is different from curvature sensing in that it does not make the usual approximation of linearity . </S>",
    "<S> we calculate the sensitivity of this technique to detector and photon noise and determine optimal parameters for some representative cases . </S>",
    "<S> aliasing of high - order un - modeled aberrations is evaluated and shown to be similar to a low - order shack - hartmann sensor . </S>",
    "<S> the method has been tested with real data from the soar and blanco 4 m telescopes . </S>"
  ]
}