{
  "article_text": [
    "* context and motivations .",
    "* this paper deals with the computation of the closure of a given rational language within a relatively free algebra , with respect to a suitable implicit signature and a profinite topology .",
    "a motivation for this line of research is the _ separation problem _ , which , given two rational languages  @xmath0 and  @xmath1 , asks whether there is a rational language from a fixed class @xmath2 containing  @xmath0 and disjoint from  @xmath1 .",
    "the separation problem has several motivations .",
    "first , the membership problem for @xmath2 reduces to the separation problem for @xmath2 , since a language belongs to the class @xmath2 if and only if it is separable from its complement by a language from  @xmath2 .",
    "furthermore , solving this problem gives more information about the class under investigation , and is more robust when applying transformations to the class .",
    "for instance , is was proved by @xcite and @xcite that the classical operator @xmath3 on pseudovarieties preserves decidability of the separation problem , while it has been shown by @xcite that it does not preserve decidability of the membership problem ( on the other hand , the status with respect to separation is unknown for other operators that do not preserve the decidability of membership , such as the power , as shown by ) .",
    "finally , deciding separation for some class can be used to decide membership for more involved classes : this is for instance a generic result in the quantifier alternation hierarchy , established by @xcite , that deciding separation at level @xmath4 in this hierarchy entails a decision procedure for membership at level @xmath5 .",
    "@xcite has related the separation problem with a purely topological question , which is the main topic of this paper : the separation problem has a negative answer on an instance @xmath6 of rational languages if and only if the closures of  @xmath0 and  @xmath1 in a suitable relatively free profinite semigroup , which depends on the class of separator languages we started from , have a nonempty intersection .",
    "determining whether such closures intersect can be in turn reformulated in terms of computation of pointlike two - element sets in a given semigroup .",
    "deciding whether closures of rational languages intersect is often nontrivial , in particular because the profinite semigroup in question is uncountable in general . yet , several classes of languages enjoy a property called _ _ reducibility _ _ that states that the closures of two rational languages intersect in the suitable relatively free profinite semigroup if and only if their traces in a more manageable universe also intersect .",
    "this more manageable universe may in particular be countable , and is therefore amenable to algorithmic treatment .",
    "in summary , reducibility is a property of the class of separators under investigation ( or of the class of semigroups recognizing these separators ) , which reduces the search of a witness in the intersection into a simpler  universe .",
    "the most important example from the historical point of view is the class of languages recognized by finite groups . in this case",
    ", the relatively free algebra is the free group over some set @xmath7 of generators , which is indisputably much better understood than the free profinite group over  @xmath7 . in particular",
    ", it is countable . since it is known that the closures in the free profinite group of two rational languages intersect if and only if their traces in the free group also intersect ( that is , the class of finite groups enjoys the reducibility property ) , this justifies the quest for an algorithm computing the closure in the free group of a rational language .",
    "such an algorithm is known as the pin - reutenauer procedure , which we describe below , and has been developed along a successful line of research , see the work of  . as a consequence",
    ", the separation problem by group languages is decidable .",
    "this framework can be generalized to classes consiting of other types of semigroups than just groups .",
    "denote by @xmath8 the signature consisting of the binary multiplication and the unary @xmath9-power , with their usual interpretation in profinite semigroups .",
    "note that the set of all @xmath8-terms over @xmath7 is isomorphic to the free group over @xmath7 : the mapping sending each generator to itself and @xmath10 to @xmath11 , the inverse of @xmath12 in the free group , can be extended to a group isomorphism .",
    "more generally , given a pseudovariety v of finite semigroups , consider the semigroup @xmath13 , which can be seen as the set of all interpretations over v of @xmath8-terms over  @xmath7 .",
    "this subalgebra of the pro - v semigroup over @xmath7 is countable and thus , as said above , amenable to algorithmic treatment .",
    "one central problem in this context is the @xmath8-word problem : given two @xmath8-terms over  @xmath7 , decide whether they represent the same element in the relatively free profinite semigroup in the pseudovariety under consideration .",
    "this problem has already been investigated for several classical pseudovarieties besides that of finite groups , for instance by @xcite for the pseudovariety j of all finite @xmath14-trivial semigroups , by   for the pseudovariety r of all finite @xmath15-trivial semigroups , by  @xcite for the pseudovariety of all finite semigroups whose local monoids are semilattices and by @xcite for the pseudovariety of all finite semigroups whose regular @xmath14-classes are aperiodic semigroups .",
    "moreover , reducibility has been shown to hold for several pseudovarieties , in particular by @xcite for j , by for r , by   for and , as already mentioned , by for the pseudovariety g of all finite groups .",
    "a further example is the pseudovariety a of aperiodic languages which , in a forthcoming paper , will be derived from the work of @xcite , recently revisited by @xcite , from which one can derive reducibility of this class .",
    "in other words , for these classes of languages , the separation problem reduces to testing that the intersection of the closures of two given rational languages in the suitable countable relatively free algebra is empty .",
    "this motivates designing algorithms to compute closures of rational languages in these relatively free algebras .",
    "this is one of the main contributions of this  paper .",
    "* the pin - reutenauer procedure .",
    "* in the core of the paper , we investigate how the profinite closure of rational languages in free unary algebras interacts with concatenation and iteration . the natural guide for this work",
    "is provided by a procedure proposed by for the case of the free group .",
    "this procedure gives a way to compute a representation of the closure of a rational language inductively on the structure of the rational expression .",
    "of course , the closure of a union is the union of the closures . the other two rules of the pin - reutenauer procedure deal with concatenation and iteration .",
    "for instance , when computing in xv , the smallest subalgebra of the pro - v semigroup closed under multiplication and @xmath9-power , establishing the pin - reutenauer procedure amounts to showing the following equalities : @xmath16 where @xmath17 is the topological closure of @xmath1 in xv , and @xmath18 is the subalgebra of xv generated by @xmath1 . notice that these equalities yield a recursive procedure to compute a finite algebraic representation of @xmath19 when @xmath1 is rational .",
    "such a finite representation may not immediately yield algorithms to decide membership in @xmath17 for a given rational language @xmath1 , but it reduces the problem of computing topological closures @xmath17 to the problem of computing algebraic closures @xmath18 . since the signature @xmath8 is finite , this representation also provides a recursive enumeration of elements of @xmath20 .",
    "additionally , assume that the following two properties hold :    1 .",
    "the word problem for @xmath8-terms over v is decidable , 2 .",
    "the pseudovariety v is @xmath8-reducible",
    ".    then one can decide the separation problem of two rational languages @xmath6 by a v - recognizable language .",
    "indeed , @xcite has shown that this problem is equivalent to checking whether the closures of @xmath0 and @xmath1 in xv intersect , which by reducibility is equivalent to checking whether @xmath21 . in turn , this may be tested by running two semi - algorithms in parallel :    1 .",
    "one that enumerates elements of @xmath22 and @xmath17 and checks , using the solution over v of the word problem for @xmath8-terms , whether there is some common element ; 2 .   another one that enumerates all potential v - recognizable separators .",
    "thus , the pin - reutenauer procedure is one of the ingredients to understand why a given class has decidable separation problem .",
    "* contributions .",
    "* it has been established recently by @xcite that the pin - reutenauer procedure holds for a number of pseudovarieties .",
    "however , the results of this paper rely on independent , technically nontrivial results for the pseudovariety a of aperiodic semigroups : first , it was proved that the pin - reutenauer procedure is valid for a using the solution of the word problem for the free aperiodic @xmath8-algebra given by .",
    "then , a transfer result was established to show that it is also valid for subpseudovarieties of  a.    in this paper , we revisit the pin - reutenauer procedure , obtaining general results with simpler arguments .",
    "we consider unary signatures , made of multiplication and operations of arity 1 .",
    "our main result , theorem  [ t : main ] , establishes that the pin - reutenauer procedure holds for the pseudovariety s of all finite semigroups , for unary signatures satisfying an additional technical condition , which is met for  @xmath8 .",
    "the fact that rational languages are involved is crucial , since , as observed by  @xcite , the equality @xmath23 fails for some languages @xmath24 , where closures are taken with respect to  s and the signature @xmath8 .",
    "this result is obtained by first investigating a property named _",
    "factoriality_. factoriality of v with respect to , say , the signature @xmath8 means that xv is closed under taking factors in xv .",
    "it was shown by @xcite that if v is factorial , then the pin - reutenauer procedure holds with respect to  concatenation , that is , @xmath25 for arbitrary @xmath6 ( not just for rational ones ) .",
    "however , it was also noted that the pseudovariety s can not be factorial for nontrivial countable signatures , such as @xmath8 .",
    "in contrast , we show that any nontrivial pseudovariety of semigroups  v closed under concatenation is factorial for the signature @xmath26 consisting of multiplication and _ all _ unary operations . as an application",
    ", we obtain a new proof that the minimum ideal of the free pro - v semigroup on at least two generators contains no @xmath26-word .",
    "this property is a weaker version of a result obtained by . besides the independent interest of such results , the technical tool used to prove them , named _ factorization history _",
    ", is also the key to establish that the pin - reutenauer is valid for s. we further characterize pseudovarieties in which the pin - reutenauer procedure holds in terms of an abstract property named fullness , introduced by .",
    "the main idea is that the validity of the pin - reutenauer procedure for a pseudovariety v is inherited by a subpseudovariety w , as established by @xcite , provided both v and w are full .",
    "conversely , we prove that if the pin - reutenauer procedure works for v , then v is full .",
    "since the pseudovariety of all finite semigroups is full , this yields that a pseudovariety enjoys the pin - reutenauer property if and only if it is full .",
    "finally , we show that a variation of the pin - reutenauer procedure , known to hold in the case of all groups , also holds for pseudovarieties of groups in which every finitely generated subgroup of the free @xmath8-algebra is  closed",
    ".    * organization . *",
    "the paper is organized as follows . in section  [ sec : um - factoriality ] , we introduce the notion of history of a factorization and we show that any nontrivial pseudovariety closed under concatenation product is @xmath26-factorial . in section  [ sec : closures ] , we establish that the pin - reutenauer property holds for s and unary signatures satisfying an additional condition . in section",
    "[ sec : pr ] , we relate the pin - reutenauer property with fullness , in the general case and in the case of pseudovarieties of groups .",
    "we assume that the reader has some familiarity with profinite semigroups .",
    "for details , we refer the reader to the books of and to the article of @xcite . here",
    ", we briefly introduce the required notation and key  notions .",
    "[ [ preliminaries . ] ] * preliminaries .",
    "* + + + + + + + + + + + + + + + +    throughout the paper , we work with a finite alphabet @xmath7 . for a pseudovariety v of semigroups ,",
    "we denote by @xmath27 the free pro - v semigroup generated by @xmath7 .",
    "elements of @xmath27 are called _ @xmath7-ary implicit operations _ over  v. see the paper of @xcite for details .",
    "an _ implicit signature _ , as defined by , is a set of implicit operations of finite arity including the formal binary multiplication .",
    "@xmath28-semigroup _ is an algebra in the signature @xmath28 whose multiplication is associative .",
    "thus , @xmath28-semigroups form a birkhoff variety .",
    "we call an element of the free @xmath28-semigroup generated by @xmath7 a _ @xmath28-term_. for convenience , we allow the empty  @xmath28-term .",
    "every pro - v semigroup has a natural structure of @xmath28-semigroup .",
    "we denote by @xmath29 the sub-@xmath28-semigroup of xv generated by @xmath7 .",
    "@xmath28-word over v _ is an element of @xmath29 .",
    "we denote by @xmath30 the surjective homomorphism of @xmath28-semigroups that associates to a @xmath28-term @xmath31 its interpretation @xmath32 in @xmath29 .",
    "when @xmath31 is a word and @xmath33 is clear from the context , we write @xmath31 instead of  @xmath34 .    [ [ unary - implicit - signatures . ] ] * unary implicit signatures . *",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath35 be the profinite completion of  @xmath36 , _",
    "i.e. _ , the free profinite monoid on one generator .",
    "we denote by @xmath26  the implicit signature consisting of multiplication together with all implicit operations @xmath37 with @xmath38 .",
    "an implicit signature is called _ unary _ if it is contained in  @xmath26  and it contains at least one unary implicit operation . for a unary implicit signature  @xmath28 ,",
    "an element @xmath39 such that the @xmath40-power operation @xmath37 belongs to  @xmath28 is said to be a _",
    "@xmath28-exponent_. note that by definition of @xmath26 , every @xmath28-exponent is infinite .",
    "an important example of a unary implicit signature is the signature @xmath8 , for which @xmath41 is the only @xmath8-exponent .",
    "the _ @xmath28-rank _",
    "@xmath42 of a @xmath28-term @xmath31 is the maximal nesting depth of elements of @xmath28 , disregarding multiplication , that occur in @xmath31 .",
    "it is defined inductively by @xmath43 and @xmath44 in case @xmath45 is an operation from @xmath28 which is not multiplication . for a @xmath28-term @xmath46 where the @xmath47 s and the @xmath48 s are @xmath28-terms such that @xmath49 and",
    "each @xmath50 is a @xmath28-exponent , we denote by @xmath51 the number @xmath52 of subterms @xmath53 of @xmath31 . when @xmath28 is clear from the context , we may write @xmath54 , @xmath55 instead of @xmath42 , @xmath51 , respectively .    [ [ complete - unary - implicit - signatures . ] ] * complete unary implicit signatures . * + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a unary implicit signature @xmath28 is said to be _ complete _ if the set of @xmath28-exponents is stable under the mappings @xmath56 and @xmath57 .",
    "note that @xmath26  is complete , while @xmath8 is not . the intersection of a nonempty set of complete unary signatures either consists of multiplication solely , or is again a complete unary signature .",
    "therefore , the smallest complete unary signature containing a given unary signature @xmath28 exists .",
    "it is called the _ completion _ of  @xmath28 and it is denoted by  @xmath58 . by definition , we have @xmath59 , and a signature @xmath28 is complete if and only if @xmath60 .",
    "note that for every @xmath26-exponent  @xmath40 and every @xmath61 , the equalities @xmath62 and @xmath63 hold .",
    "this proves the following useful fact .",
    "[ rem : inclusive ] let @xmath28 be a unary signature containing @xmath8",
    ". then @xmath64 .      for @xmath65",
    ", we choose a sequence @xmath66 of natural integers converging to @xmath40 .",
    "one can assume that @xmath66 is constant if @xmath40 is finite , or strictly increasing otherwise .",
    "let  @xmath31 be a @xmath26-term .",
    "we denote by @xmath67 the word obtained by replacing each subterm @xmath68 with @xmath40 infinite by @xmath69 , recursively .",
    "for instance , @xmath70 .",
    "the factorizations @xmath71 with @xmath72 and @xmath73 may be obtained recursively as follows :    * if @xmath74 , then @xmath75 for all @xmath76 and there are @xmath77 such factorizations of  @xmath67 ; * if @xmath78 and @xmath79 , where the @xmath47 s and the @xmath48 s are @xmath28-terms such that @xmath80 ( where the @xmath47 s may be empty ) , then the factorizations of @xmath67 are those of the following forms : @xmath81 where @xmath82 , @xmath83 , and @xmath84",
    ".    the condition @xmath85 , forbidding @xmath86 to be empty , is used recursively to ensure that each factorization of @xmath67 is either of type or , but not of both types : one can verify that each factorization of @xmath67 is obtained by exactly one of the equations and , where @xmath87 ( in case ) , or @xmath88 ( in case ) are uniquely determined .",
    "in particular , the factorization @xmath89 can not be of type  , since this would force @xmath90 to be empty , which is forbidden .",
    "this factorization is in fact of type   with @xmath91 and @xmath92 .    as an example , for @xmath93 , the expression is obtained for @xmath94 , where @xmath95 and @xmath96 are empty , while @xmath97 , @xmath98 , and @xmath99 .",
    "assuming @xmath100 , we obtain    * the factorization @xmath101 by  , with @xmath102 , @xmath103 empty and @xmath104 ; * the factorization @xmath105 by  , @xmath106 , @xmath92 , @xmath107 , @xmath108 empty and @xmath109 .    the _ history _",
    "@xmath110 of a factorization @xmath111 is defined recursively as follows :    * if @xmath112 , then @xmath113 ; * if @xmath114 and the factorization is of the form  , then @xmath110 is obtained by concatenating the pair @xmath115 with @xmath116 ; * if @xmath114 and the factorization is of the form  , then @xmath110 is obtained by concatenating the 4-tuple @xmath117 with @xmath118 .",
    "the history @xmath110 is thus a word on an alphabet that depends on the integer  @xmath76 , which gives information on how the word @xmath67 is split by the factorization @xmath119 .",
    "note that the length of the history @xmath110 is at most @xmath120 .",
    "the _ simplified history _",
    "@xmath121 of the factorization @xmath111 is obtained from the history @xmath110 by replacing each 4-tuple @xmath117 by @xmath122 .",
    "on the other hand , dropping the first two components of each letter of the history @xmath110 , we obtain a word whose letters are pairs of nonnegative integers , which we identify with an integer vector in even dimension , called the _ exponent vector_. a factorization of  @xmath67 can be recovered from its history but may not be recoverable from its simplified history without the extra information contained in the exponent vector .",
    "observe that @xmath123 converges to @xmath124 in @xmath125 .",
    "we will be interested in sequences @xmath126 such that @xmath127 .",
    "we call such a sequence a _ factorization sequence for  @xmath31_.    it will be convenient in the proofs to work with factorization sequences having additional properties . note that the set of simplified histories of factorizations of  @xmath67 is finite and depends only on  @xmath31",
    ". moreover , the dimension of all exponent vectors is bounded by @xmath128 .",
    "therefore , any factorization sequence for @xmath31 has a subsequence whose    1 .",
    "induced sequence of simplified histories is constant , 2 .   induced sequence of exponent vectors belongs to @xmath129 for some constant @xmath130 and converges in  @xmath131 .",
    "we call _ filtered _ a sequence with these properties .",
    "an application of this notion is the following simple statement .",
    "[ lem : converging - factorization - sequences ] let @xmath126 be a factorization sequence for a @xmath26-term . then both @xmath132 and @xmath133 have subsequences converging in xs to @xmath134-words .",
    "let @xmath31 be the @xmath26-term of the statement . by the above",
    ", one may assume that the sequence @xmath126 is filtered .",
    "we proceed by induction on @xmath135 . the case @xmath112 is straightforward",
    ". otherwise , let @xmath79 as in .",
    "there are two cases , according to the first letter of @xmath121 , which can be of the form @xmath115 or @xmath122 .",
    "both cases are similar , so assume that it is of the form @xmath115 .",
    "therefore , the factorization @xmath136 of @xmath137 is given by , hence @xmath138 and @xmath139 where @xmath140 . by definition",
    ", @xmath141 is a @xmath26-term and @xmath142 , whence by induction @xmath143 and @xmath144 have subsequences converging to @xmath26-terms , respectively @xmath145 and @xmath146 .",
    "therefore , @xmath132 ( resp .",
    "@xmath133 ) has a subsequence converging to the @xmath26-term @xmath147 ( resp .",
    "@xmath148 ) .",
    "a pseudovariety of semigroups is said to be _ closed under concatenation _ if the corresponding variety of rational languages has that property .",
    "a nontrivial pseudovariety v is closed under concatenation if and only if it contains a , the pseudovariety of aperiodic ( or group - free ) semigroups , and the multiplication of the profinite semigroup xv is an open mapping for every finite alphabet  @xmath7 as proved by   based on results of  @xcite ( in the monoid case ) and   ( in the semigroup case ) characterizing such pseudovarieties in terms of certain algebraic closure properties .    a pseudovariety v is said _",
    "@xmath28-factorial _ if , for every finite alphabet @xmath7 , every factor in @xmath27 of a @xmath28-word over v is also a @xmath28-word over v. note that the pseudovariety  s is not @xmath8-factorial , since @xmath149 is a prefix of @xmath150 for every @xmath39 .",
    "[ t : s-1-factorial ] let v be a pseudovariety closed under concatenation .",
    "then  v is @xmath26-factorial .",
    "the statement is obvious if v is trivial .",
    "otherwise , let @xmath151 be a factorization in  xv of an arbitrary element of  xv .",
    "let @xmath31 be a @xmath26-term such that @xmath152 .",
    "since the sequence @xmath123 converges to @xmath151 in xv and the multiplication is open in  xv , for all sufficiently large @xmath76 , each @xmath67 may be factorized as @xmath153 in such a way that @xmath154 and @xmath155 .    by lemma  [ lem : converging - factorization - sequences ] ,",
    "both @xmath156 and @xmath157 have subsequences converging , in @xmath125 , to @xmath26-words over s. therefore , in @xmath27 , these subsequences converge to @xmath26-words over v , so that @xmath158 and @xmath159 are actually @xmath134-words over @xmath33 .    for a pseudovariety h of groups , @xmath160 denotes the pseudovariety of all finite semigroups whose subgroups lie in  h. in particular , when h is the trivial pseudovariety , then @xmath161 .",
    "it is a well - known and elementary fact that @xmath160 is always closed under concatenation .",
    "denote by @xmath162 the burnside pseudovariety of all finite groups of exponent dividing @xmath76 .",
    "the pseudovariety is thus defined by the pseudoidentity @xmath163 .    in the following result ,",
    "the special case @xmath164 , corresponding to the pseudovariety a , was first shown by   with a much more involved proof .",
    "[ c : bn - k - factorial ] for every positive integer @xmath76 the pseudovariety is @xmath8-factorial . in particular , the pseudovariety a is @xmath8-factorial .",
    "we claim that the equality @xmath165 holds for @xmath166 and so also for every finite alphabet @xmath7 .",
    "therefore , the result follows from theorem  [ t : s-1-factorial ] .",
    "to prove the claim , we show that @xmath167 .",
    "for this , let @xmath40 be a @xmath26-exponent and let @xmath168 be a sequence of integers converging to @xmath40 .",
    "one can assume that @xmath169 modulo @xmath76 is a constant @xmath170 , hence @xmath171 with @xmath172 for all @xmath173 .",
    "in @xmath174 , we then have @xmath175 .",
    "another application of theorem  [ t : s-1-factorial ] is the following result , which is a weaker version of one that was established in .",
    "although the original result was formulated for the pseudovariety of all finite semigroups , the proof applies unchanged to pseudovarieties containing all finite local semilattices .",
    "related results , under the same hypothesis as the following corollary , have been obtained by  @xcite .",
    "[ c : ja - volkov ] if @xmath176 and v is a nontrivial pseudovariety closed under concatenation , then there is no @xmath26-word in the minimum ideal of  xv .    since v is @xmath26-factorial by theorem  [ t : s-1-factorial ] and",
    "since every element of xv is a factor of every element of the minimum ideal , if there were a @xmath26-word in the minimum ideal then every element of  xv would be a @xmath26-word .",
    "we claim that this is impossible under the hypothesis that @xmath176 .",
    "to prove the claim , observe that by definition , every @xmath26-word of  xv which is not a word has at least one infinite power of a finite word as an infix . in particular , it admits as factors powers of finite words of arbitrarily large exponent .",
    "thus , it suffices to exhibit an element of  xv that fails this condition . for this purpose let @xmath177 be distinct letters and consider the prouhet - thue - morse substitution , defined by @xmath178 , @xmath179 , and @xmath180 for all @xmath181",
    "this extends to a unique continuous endomorphism of  xv , which we also denote @xmath182 .",
    "since , as proved by  @xcite , the monoid of continuous endomorphisms of  xv is profinite under the pointwise convergence topology , we may consider the element @xmath183 .",
    "now , it is well known that each word @xmath184 is cube free ( see , for instance , @xcite ) .",
    "since v is nontrivial and closed under concatenation product , it contains a. therefore , the sets of the form @xmath185 , where @xmath186  is a word , are open ( * ? ? ?",
    "* theorem  3.6.1 ) .",
    "hence , @xmath187 is also free of cubes of finite words and so @xmath187  is not a @xmath26-word .",
    "given a pseudovariety v of semigroups , an implicit signature @xmath28 and a subset @xmath188 , we denote by vl the closure of @xmath1 in  xv .",
    "both the implicit signature @xmath28 and the pseudovariety v are understood in this notation .",
    "we are interested in computing a representation of such closures in two cases :    1 .",
    "[ i : prw ] when @xmath1 is of the form @xmath189 for some rational subset @xmath0 of @xmath190 , where v is the natural continuous homomorphism from @xmath125 to @xmath27 ; 2 .",
    "[ i : prs ] when @xmath1 is a rational subset of @xmath29 .",
    "recall that the class of rational subsets of a semigroup @xmath191 is the smallest family of subsets of @xmath191 containing the empty set and the singletons @xmath192 for @xmath193 , and closed under union @xmath194 , product @xmath195 and iteration @xmath196 .",
    "since the homomorphic image of a rational set is rational , any set of the form  [ i : prw ] is also of the form  [ i : prs ] .",
    "conversely , there are of course rational sets of xv that are not obtained as image of a rational set of @xmath190 under v , such as the singletons @xmath197 where @xmath39 is a @xmath28-exponent .",
    "we say that the _ pin - reutenauer procedure _ holds for a class c of subsets of  xv if , for every @xmath198 , the following conditions are satisfied : @xmath199 where @xmath200 denotes the @xmath28-subalgebra generated by the subset @xmath201 of @xmath29 . again , in this notation , the fact that closures are taken in @xmath29 is understood .",
    "we say that v is _",
    "( weakly ) @xmath28-pr _ if , for every finite alphabet @xmath7 , the pin - reutenauer procedure holds for the class of all subsets of  xv of the form @xmath202 with @xmath203 a rational language .",
    "we say that v is _",
    "strongly @xmath28-pr _ if , for every finite alphabet @xmath7 , the pin - reutenauer procedure holds for the class of all rational subsets of  xv .",
    "in this section , we only deal with the pseudovariety s. in section  [ sec : pr ] , we shall transfer our results from s to other pseudovarieties .",
    "the main result of this section is the following theorem .",
    "it applies only to pure signatures , which we describe below .",
    "[ t : main ] the pseudovariety s is @xmath28-pr for every pure unary signature @xmath28 containing @xmath8 .",
    "the additional _ purity _ property that @xmath28 is required to possess is the following .    a unary signature @xmath28 is said to be _ pure _",
    "if , for every positive integer @xmath130 and for all @xmath39 , if @xmath204 is a @xmath58-exponent , then @xmath40 is also a @xmath58-exponent .",
    "note that the quotient of @xmath204 by @xmath130 is actually uniquely determined : if @xmath205 and @xmath206 are such that @xmath207 , then @xmath208 .",
    "this follows immediately from the fact that the free profinite group on one generator , which is isomorphic to @xmath209 , is torsion - free .",
    "let us show this fact directly : @xmath207 means that all finite semigroups satisfy @xmath210 . to show that all finite semigroups also satisfy @xmath211 , it is sufficient to consider 1-generated semigroups .",
    "such semigroups have presentations of the form @xmath212 , for integers @xmath213 .",
    "note that the semigroup homomorphism @xmath214 mapping @xmath170 to @xmath215 is injective . since @xmath216 satisfies @xmath210",
    ", we have in @xmath216 the equalities @xmath217 , whence @xmath218 satisfies @xmath219 .",
    "this proves that  @xmath208 .    in view of the following lemma ,",
    "theorem  [ t : main ] can be applied to the signature  @xmath8 .",
    "[ l : kappa - pure ] the unary signature @xmath8 is pure .",
    "every @xmath220-exponent is of the form @xmath221 , where @xmath222 .",
    "therefore , it suffices to show that , if @xmath76 is an integer , @xmath130 is a positive integer , and @xmath39 is such that @xmath223 , then @xmath130 divides @xmath76 , whence @xmath224 is again a @xmath220-exponent . for that purpose , consider the unique continuous homomorphism of additive monoids @xmath225 which maps @xmath226 to  @xmath226 .",
    "we have @xmath227 and @xmath228 , and we deduce from the equality @xmath223 that @xmath229 .    to establish theorem  [ t : main ]",
    ", we first prove a technical key lemma in section  [ sec : key - lemma ] .",
    "we shall then consider separately the cases of concatenation and iteration respectively in sections  [ sec : concatenation ] and  [ sec : iteration ] .",
    "we first prove a technical result which will be the key lemma in the sequel .",
    "it shows that , under suitable hypotheses , one can balance the factors of a factorization of a given @xmath58-term to make them @xmath58-terms themselves , without affecting membership in given clopen sets . for @xmath203 ,",
    "we denote by l the topological closure of @xmath1 in  xs .    given @xmath26-terms @xmath230 and languages  @xmath231",
    ", we say that @xmath232 is a _ @xmath233-splitting _ of a @xmath26-term @xmath31",
    "if the following conditions hold :    1 .   [",
    "item : local - adjustment-1 ] @xmath234 ; 2 .",
    "[ item : local - adjustment-2 ] @xmath235 for every @xmath236 .    given a @xmath28-term @xmath31 , let @xmath237 .",
    "we may write @xmath238 instead of  @xmath239 when @xmath28 is clear from the context .",
    "[ l : local - adjustment ] let @xmath28 be a unary signature containing  @xmath8 , let @xmath31 be a @xmath240-term , and let @xmath231 be rational languages . if @xmath31 admits an @xmath233-splitting @xmath232 , then there exists a @xmath240-term @xmath241 admitting an @xmath233-splitting @xmath242 such that :    1 .",
    "[ i1 ] @xmath243 , 2 .",
    "[ i2 ] @xmath244 is a @xmath58-term for @xmath236 , 3 .",
    "[ i3 ] @xmath245 for @xmath236 .",
    "we only prove the statement for @xmath94 , since it is representative of the general case , and it allows a simplified notation .",
    "let @xmath246 be an @xmath247-splitting of @xmath31 .",
    "set @xmath248 and @xmath249 . by  [ item : local - adjustment-2 ] , @xmath250 belongs to , which is open by rationality of  @xmath251 ( * ? ? ?",
    "therefore , the word @xmath252  belongs to  @xmath251 for all sufficiently large  @xmath76 .",
    "similarly , the word @xmath253 belongs to @xmath254 for all sufficiently large @xmath76 .",
    "let @xmath255 be a homomorphism into a finite semigroup recognizing both languages @xmath251 and  @xmath254 .",
    "in view of  [ item : local - adjustment-1 ] , @xmath126 is a factorization sequence for  @xmath31 .",
    "let @xmath256 be a filtered subsequence of @xmath126 , and let @xmath257 be the sequence of exponent vectors for the factorization @xmath258 .",
    "when @xmath259 ( resp .",
    "@xmath260 ) is constant , let @xmath261 ( resp .",
    "@xmath262 ) be this constant value . otherwise , by taking a subsequence",
    ", we may assume that for each @xmath263 , each of the sequences @xmath264 and @xmath265 is constant , say with value respectively @xmath266 and @xmath267 ( @xmath268 ) , the integers @xmath261 and @xmath262 being independent of the element @xmath263 .    in view of case   of the definition of factorization sequence and",
    "since @xmath31 is a @xmath58-term , each sequence @xmath269 converges to some @xmath58-exponent  @xmath270 .",
    "in particular , @xmath270 is infinite .",
    "define @xmath271 by @xmath272 note that in all cases , we have @xmath273 let @xmath274 ( resp .",
    "@xmath275 ) be the @xmath26-term obtained from @xmath276 ( resp .  from @xmath277 ) by replacing for every @xmath278 the exponent @xmath279 by @xmath280 and the exponent @xmath281 by @xmath282 .",
    "set @xmath283 and let us verify that @xmath284 and @xmath241 fulfill the desired properties .",
    "we have to show properties  [ i1][i3 ] , and that @xmath285 is an @xmath247-splitting of @xmath241 .",
    "first note that , by  , we have @xmath286 for all @xmath26-term @xmath86 .",
    "since @xmath269 converges to @xmath270 , using   we deduce that @xmath243 , which proves  [ i1 ] .",
    "next , by definition @xmath280 and @xmath282 either belong to @xmath287 , or are of one of the forms @xmath288 or @xmath221 where @xmath289 .",
    "since @xmath270 is a @xmath58-exponent and since @xmath28 contains @xmath8 , both @xmath280 and @xmath282 are @xmath58-exponents , whence both @xmath274 , @xmath275 are @xmath58-terms , which proves  [ i2 ] .",
    "finally , we have @xmath245 by construction , which is  [ i3 ] .",
    "it remains to verify that @xmath285 is an @xmath247-splitting of @xmath241 .",
    "condition  [ item : local - adjustment-1 ] is satisfied by definition of @xmath241 .",
    "let us verify that @xmath290 ( showing that @xmath291 is similar ) .",
    "let @xmath292 be the continuous extension of @xmath182 to @xmath125",
    ". by  [ item : local - adjustment-2 ] applied to the @xmath247-splitting @xmath246 of @xmath31 , we have @xmath293 .",
    "since @xmath294 is the limit of @xmath295 , it suffices to show that @xmath296 .",
    "this follows from the claim that for @xmath297 large enough , @xmath298 , which is clear if @xmath299 is constant , while it is obtained by reasoning in the group @xmath300 if @xmath299 is unbounded .",
    "we are now ready to treat the case of concatenation , that is , to establish property  .",
    "[ t : half - pr - for - s-1 ] equality   holds over the pseudovariety s for every unary signature @xmath28 containing @xmath8 and for all rational languages @xmath301 .    the inclusion from right to left in   amounts to continuity of multiplication in  xs and thus it is always valid . for the direct inclusion ,",
    "let @xmath158 be an arbitrary element of  @xmath302 .",
    "we need to show that @xmath158 belongs to  @xmath303 .",
    "choose a @xmath28-term @xmath31 such that @xmath304 .",
    "since @xmath305 and since the closure @xmath306 of the rational language  @xmath307 is clopen  ( * ? ? ?",
    "3.6.1 ) , the word @xmath67  belongs to  @xmath307 for all sufficiently large @xmath76 . for such  @xmath76 ,",
    "let @xmath308 and @xmath309 be words such that @xmath310 , and let @xmath311 be a filtered subsequence of @xmath312 . for @xmath313 , let @xmath47 be the term obtained by substituting each exponent vector with the limit of the sequence of exponent vectors , in @xmath314 , so that @xmath315 , and @xmath246 is a @xmath316-splitting of @xmath31 . by lemma  [ l : local - adjustment ]",
    ", it follows that there exists a @xmath58-term @xmath241 such that @xmath317 and @xmath241 admits a @xmath316-splitting @xmath318 into @xmath58-terms . since the unary signature @xmath28 contains @xmath8 , we have @xmath319 by remark  [ rem : inclusive ] .",
    "hence , @xmath320 , and similarly @xmath321 . finally , @xmath322 .",
    "we now show that   holds over the pseudovariety @xmath323 , for every pure implicit signature @xmath28 containing @xmath8 and every rational language @xmath203 .",
    "it is easy to see that the inclusion from right to left in   always holds , see  @xcite.[easy - inclusion - thm-3.5 ] the rest of this subsection is devoted to the proof of the other inclusion .",
    "[ t : half - pr - for - s-2 ]    equality   holds over the pseudovariety s for every pure unary signature @xmath28 containing @xmath8 and for every rational language @xmath203 .",
    "the proof of theorem  [ t : half - pr - for - s-2 ] follows the lines of its analog for the pseudovariety a which is presented in  ( * ? ? ?",
    "* section  6 ) , even though the argument requires significant changes in several points .",
    "consider an element @xmath158 of  .",
    "we must show that there is a @xmath28-term which coincides with  @xmath158 when evaluated on ( finitely many ) suitable elements of  l. it turns out to be convenient to assume more generally that @xmath324 , so that there exists a @xmath58-term @xmath31 such that @xmath325 .",
    "therefore , we want to show that , for every @xmath58-term  @xmath31 , @xmath326 let @xmath327 . the sequence of words @xmath328 converges to  @xmath329 in  xs .",
    "as @xmath158 belongs to the open set , the word @xmath330 belongs to  @xmath331 for all sufficiently large  @xmath173 , and we may therefore assume that there are factorizations @xmath332 with each @xmath333 . if there is a bounded subsequence of the sequence @xmath334 , which counts the number of factors from @xmath1 , then theorem  [ t : half - pr - for - s-1 ] yields that  @xmath158 belongs to the subsemigroup of  xs generated by l and we are done .",
    "we may therefore assume that @xmath335 , which implies that @xmath336 .",
    "we first reduce the problem to the case  @xmath337 .",
    "[ prop : reduction - nu=1 ] assume that   holds for every @xmath58-term @xmath31 with @xmath337 .",
    "then , it holds for every @xmath58-term @xmath31 .",
    "let @xmath31 be a @xmath58-term such that @xmath338 .",
    "let @xmath329 , and assume that @xmath339 . to show that @xmath340 , we proceed by induction on @xmath341 , for the lexicographical order on @xmath342 .",
    "consider the factorization of  @xmath31 in @xmath58-terms as in   and the factorization   of @xmath327 .",
    "we distinguish three cases .",
    "[ [ case-1 ] ] * case 1 * + + + + + + + +    suppose first that there are infinitely many indices  @xmath173 for which there exists @xmath343 such that the first letter of the simplified history @xmath344 is of one of the forms @xmath115 with @xmath345 , or @xmath122 with @xmath346 .",
    "that is , the corresponding factorizations @xmath347 , where @xmath348 and @xmath349 , do not split @xmath350 in its prefix @xmath351 , nor in its suffix @xmath352 .",
    "by lemma  [ lem : converging - factorization - sequences ] , both @xmath353 and @xmath354 admit subsequences converging to @xmath26-words , say @xmath355 and @xmath356 respectively , with @xmath357 .",
    "since both @xmath358 and @xmath359 belong to @xmath331 , we deduce that @xmath360 .",
    "therefore , one can apply lemma  [ l : local - adjustment ] : there exist @xmath58-terms @xmath274 and @xmath275 such that @xmath361 , and for @xmath313 , @xmath362 and @xmath363 . by remark  [ rem : inclusive ] , we obtain @xmath364 . by the assumption on the first letter of the simplified histories",
    ", we have @xmath365 and @xmath366 , hence @xmath367 ( @xmath313 ) .",
    "arguing inductively , we deduce that @xmath368 and @xmath369 belong to @xmath370 , whence so does @xmath371 .",
    "this concludes the proof for case  1 .",
    "[ [ case-2 ] ] * case 2 * + + + + + + + +    assume now that for all sufficiently large @xmath173 , there is an index @xmath372 such that the first letters of the simplified histories @xmath373 are of the forms ( 1,0 ) or ( 2,1 ) for the first one , and @xmath374 or @xmath375 for the second one .",
    "in other words , the factor @xmath376 of @xmath350 jumps from the prefix @xmath351 to the suffix @xmath352 .    as in the first case",
    ", we may apply twice lemma  [ lem : converging - factorization - sequences ] to obtain from the following sequence of factorizations @xmath377 an @xmath378-splitting of  @xmath31 into @xmath26-terms , say @xmath379 . applying lemma",
    "[ l : local - adjustment ] , we deduce that there exists an @xmath378-splitting @xmath380 into @xmath58-terms of a @xmath58-term @xmath241 such that @xmath381 and @xmath362 , @xmath382 . by remark  [ rem : inclusive ] , we obtain @xmath383 and @xmath384 . by the hypothesis of case 2 , we know that for @xmath385 , we have either @xmath365 and @xmath386 , or @xmath387 .",
    "hence , @xmath388 .",
    "thus , we may apply the induction hypothesis to deduce that @xmath368 and @xmath389 belong to @xmath390 .",
    "hence , we finally have @xmath391 .    [ [ case-3 ] ]",
    "* case 3 * + + + + + + + +    assume finally that for all sufficiently large @xmath173 and for all indices @xmath372 , the first letter of the simplified history @xmath392  is    1 .",
    "[ item:1 ] either of the form ( 1,0 ) or ( 2,1 ) , which means that @xmath393 spans from the prefix @xmath351 to the end of @xmath350 , 2 .",
    "[ item:2 ] or of the form @xmath394 or @xmath395 , which means that @xmath396 jumps from the beginning of @xmath350 to the suffix @xmath352 .",
    "this case is treated as case 2 , setting @xmath397 ( resp .",
    "@xmath398 ) to be the empty term , in case [ item:1 ] or [ item:2 ] occurs .    to conclude the proof of theorem  [ t :",
    "half - pr - for - s-2 ] , it remains to treat the case where @xmath337 . for dealing with this case , we use directed weighted multigraphs .",
    "a _ ( multi)graph _ is a tuple @xmath399 where @xmath400 is a set of vertices , and @xmath401 is a set of edges having source @xmath402 and target @xmath403 , for each pair of vertices @xmath404 . in the sequel",
    ", the graphs shall always be finite .",
    "a _ weighted multigraph _ is given by a multigraph together with a weight function , which associates to each edge @xmath405 a nonnegative integer @xmath406 .",
    "if @xmath405 is an edge with source @xmath402 and target @xmath403 , we represent this edge by @xmath407    for a path @xmath408 of a graph @xmath409 , let @xmath410 denote the edge - induced subgraph of @xmath409 whose edges are those traversed by  @xmath408 .",
    "we call @xmath410 the _ support _ of  @xmath408 . furthermore",
    ", if  @xmath411 is an edge of  @xmath409 , then @xmath412 denotes the number of times @xmath408 goes through the edge  @xmath411 . for a subgraph @xmath413 of  @xmath409 ,",
    "we denote by @xmath414 the _ minimum _ of @xmath412 with @xmath411 an arbitrary edge of @xmath413 .",
    "[ l : infinite - capacity - cycle ] let @xmath415 be a sequence of paths of a finite multigraph @xmath409 .",
    "if there is some edge @xmath411 for which the sequence @xmath416 is unbounded , then there is some cycle @xmath408 such that @xmath417 is unbounded .",
    "consider on each path @xmath418 the subpaths which start with the edge  @xmath411 and whose length is the total number of vertices of the graph  @xmath409 .",
    "since there are only finitely many such subpaths , at least one of them , say @xmath419 , must be used an unbounded number of times . because @xmath419 must go at least twice through the same vertex",
    ", @xmath419 contains some cycle which satisfies the required condition .",
    "we conclude the proof of theorem  [ t : half - pr - for - s-2 ] by establishing the following result , which , combined with proposition  [ prop : reduction - nu=1 ] , implies that property   holds for every @xmath58-term  @xmath31 .",
    "[ prop : nu=1 ] property   holds for every @xmath58-term @xmath31 with @xmath337 .",
    "let @xmath31 be a @xmath58-term with @xmath337 .",
    "let @xmath420 .",
    "assuming that @xmath421 , we want to show that @xmath422 .",
    "we have @xmath423 , with @xmath424 .",
    "let @xmath327 .",
    "since for @xmath173 large enough , we have @xmath425 , one may consider a factorization   of  @xmath330 .",
    "using a similar argument as in the proof of case  2 of proposition  [ prop : reduction - nu=1 ] , we may assume , replacing @xmath328 by a subsequence if necessary , that @xmath426 is a prefix of  @xmath396 and @xmath427 is a suffix of  @xmath428 .",
    "since @xmath1 is a rational language of  @xmath190 , there is a homomorphism @xmath429 onto a finite monoid @xmath191 such that @xmath430 and @xmath431 .",
    "let @xmath52 and @xmath402 be positive integers such that @xmath432 we construct for each @xmath173 a finite directed multigraph @xmath433 .",
    "the set of vertices  is @xmath434 where the two symbols @xmath435 and @xmath436 do not belong to  @xmath191 .",
    "the following are the edges of the graph  @xmath433 , where @xmath405 denotes a natural number that does not exceed @xmath437 :    * there is an edge @xmath438 if @xmath439 ; * there is an edge @xmath440 if @xmath441 ; * there is an edge @xmath442 if @xmath443 .",
    "observe that , in view of  , there is an edge in the graph of the form @xmath444 with @xmath445 if and only if there is also an edge @xmath446 and @xmath447 .",
    "the purpose of this graph is to capture factorizations of the product @xmath448 belonging to @xmath331 .",
    "more precisely , for each @xmath173 , the factorizations @xmath449 determine a path @xmath418 from vertex @xmath435 to vertex  @xmath436 : the factors @xmath450 which are not completely contained in some factor @xmath451 determine the edges .",
    "each intermediate vertex in the path corresponds to a factor @xmath451 together with a factorization into a word , followed by a possibly empty product of elements from  @xmath1 , followed by a word , where only the values under @xmath182 of the prefix and suffix words are relevant .",
    "conversely , every path @xmath408 from @xmath435 to @xmath436 determines a factorization of a word of the form @xmath452 into a product of elements of  @xmath1 .",
    "indeed , we may choose for each intermediate vertex @xmath403 words @xmath453 and @xmath454 such that @xmath455 then , for each edge @xmath456 , the word @xmath457 belongs to  @xmath1 .",
    "if the path @xmath408  is the sequence of edges @xmath458 , with @xmath459 and @xmath460 , then we also have words @xmath461 in @xmath1 .",
    "then the following is the factorization associated with the path : @xmath462 the total number @xmath463 of factors @xmath451 that are covered by following the path  @xmath408 is the sum of the weights of the edges , taking into account multiplicities ; we call it the _ total weight _ of the path . combining with euler s theorem  ( * ? ? ? * theorem  5.7.1 ) , it is now easy to deduce that each of the following transformations does not change the total weight of a path and therefore the value of the left side of the equality  :    1 .",
    "[ item : key-1 ] to traverse the edges in a path in a different order , without changing the number of times we go through each edge ; 2 .",
    "[ item : key-2 ] suppose that in the support of the path there are two cycles @xmath464 and @xmath465 , with respective total weights @xmath466 and @xmath467 , and that the positive integers @xmath468 and @xmath469 are such that @xmath470 ; suppose further that the path goes through each edge in @xmath471 more than @xmath472 times ; to replace the path by another one which goes through each edge in @xmath464 less @xmath468 times than before and through each edge in @xmath465 more @xmath469 than before ; 3 .",
    "[ item : key-3 ] if there are two edges @xmath473 and @xmath474 in the path with both @xmath475 , to replace in the path one occurrence of the edge @xmath473 by that of the edge @xmath476 , provided we compensate by replacing one occurrence of the edge @xmath474 by @xmath477 ; 4 .",
    "[ item : key-4 ] suppose that in the support of the path there is a cycle @xmath419 with total weight @xmath76 and that the path goes through each edge in  @xmath419 at least @xmath478 times ; suppose further that there is an edge @xmath479 with weight at least @xmath52 ; replace the path by another one which goes through each edge in @xmath419 less @xmath402 times than before and change the edge @xmath479 by @xmath480 .",
    "using transformations of type  [ item : key-3 ] , we may assume that the path @xmath418 goes through at most one edge whose weight exceeds @xmath481 .",
    "therefore , the remaining edges in @xmath418 are taken from a fixed finite set .",
    "thus , by taking a subsequence , we may further assume that all paths @xmath418 use exactly the same edges of weight at most @xmath481 and , either none of the @xmath418 use any other edges or , otherwise they all use only one additional edge @xmath482 connecting two fixed vertices .",
    "hence all the graphs @xmath483 are the same finite graph , up to an isomorphism that only changes one edge .    on the other hand , using transformations of type  [ item : key-4 ]",
    ", we may assume that if all the paths @xmath418 go through some edge of weight at least @xmath52 , then the graph @xmath483 contains no cycle in which every edge is used at least @xmath478 times .",
    "we now split the argument into two cases .",
    "suppose first that every @xmath483 contains an edge of weight at least @xmath52 . in this case , one can apply lemma  [ l : infinite - capacity - cycle ] to deduce that there is a bound on the length of the paths @xmath418 and , therefore",
    ", we may assume that they all have the same length .",
    "moreover , we may further assume that , except for the edge @xmath484 , at the same position  @xmath278 , all paths @xmath485 are identical .",
    "consider the factorizations @xmath486 of the form   associated with each of the paths @xmath418 .",
    "let @xmath487 be the weight of each edge @xmath488 ( @xmath489 ) and let @xmath490 be the weight of the edge @xmath484 .",
    "computing the total weight , we obtain the formula @xmath491 letting @xmath492 in  , we deduce that @xmath493 and , therefore , @xmath494 is a @xmath58-exponent , since so is @xmath495 and since by definition , @xmath58 is complete .    according to  ,",
    "the factors @xmath496 with @xmath497 are given by @xmath498 by compactness of xs , we may assume that each of the sequences @xmath499 , @xmath500 , and @xmath501 converges to the respective limit @xmath502 , @xmath503 , and @xmath504 ( @xmath505 ) .",
    "let @xmath506 then we obtain a factorization @xmath507 in which each @xmath508 belongs to @xmath509 , while the @xmath504 belong to @xmath510 . by lemma  [ l : local - adjustment ]",
    ", we may assume that each @xmath502 , @xmath503 , and @xmath504 is a @xmath58-word . by definition   of the words @xmath511",
    ", the latter has rank less than @xmath512 .",
    "it follows that so is each @xmath508 .",
    "hence the @xmath508 s belong to @xmath513 and the @xmath504 belong to  @xmath514 . by the induction hypothesis",
    ", each @xmath504 belongs to  @xmath515 .",
    "hence , @xmath159 belongs to  @xmath515 , which completes the proof of the first case .",
    "it remains to consider the case where all edges have weight less than  @xmath52 . by previous reductions , we know that the graph @xmath483 is constant . because the total weight tends to @xmath516 , so does the length of the path @xmath418 . by lemma",
    "[ l : infinite - capacity - cycle ] , there is some simple cycle @xmath408 for which the sequence @xmath417 is unbounded . applying transformations of type  [ item : key-2 ]",
    ", we may assume that there is only one such cycle .",
    "by lemma  [ l : infinite - capacity - cycle ] , we deduce that the paths @xmath419 with @xmath517 which go at most once through each edge in  @xmath410 have bounded length .",
    "hence , using transformations of type  [ item : key-1 ] , we may assume that there is a path @xmath419 from @xmath435 to @xmath436 such that the path @xmath418 is obtained by inserting the power cycle @xmath518 at a fixed vertex in the path  @xmath419 , say @xmath418 is the concatenated path @xmath519 .",
    "let the total weights of the paths @xmath471 and @xmath408 be respectively @xmath520 and @xmath76 .",
    "then the total weight of the path @xmath418 is given by the formula @xmath521 by taking a subsequence , we may assume that the sequence @xmath522 converges to some @xmath523 . from",
    ", it follows that @xmath524 .",
    "since the signature @xmath28 is assumed to be pure , we deduce that @xmath525 is a @xmath58-exponent .    by the argument in the preceding case ,",
    "using the induction hypothesis , each of the paths @xmath471 and @xmath408 determines a corresponding element of  @xmath515 , say respectively @xmath526 and @xmath86 , such that @xmath527 .",
    "since @xmath525 is a @xmath58-exponent , we may now end the proof by observing that it follows that @xmath528 .",
    "in this section , we apply the main results of section  [ sec : closures ] to show that the pin - reutenauer procedure is valid for many pseudovarieties . for this purpose , we establish relationships between that property and fullness , a notion introduced by  .",
    "see also   for related properties and other applications of fullness .",
    "recall that v denotes the natural continuous homomorphism from @xmath125 to @xmath27 .",
    "the pseudovariety v is said to be _ full _ with respect to a class c of subsets of  xs if the following equality holds for every @xmath529 : @xmath530 the closure of the left hand side of   is taken in xs , while the closure of the right hand side is taken in xv .",
    "we say that v is _",
    "( weakly ) @xmath28-full _ if , for every finite alphabet @xmath7 , v is full with respect to the set of all rational languages of  @xmath190 .",
    "we also say that v is _ strongly @xmath28-full _ if , for every finite alphabet @xmath7 , v is full with respect to the class of all rational subsets of  xs .",
    "[ p : pr->full ] let @xmath28 be an arbitrary implicit signature , v be a pseudovariety , and c be the closure under the rational operations of some set of finite subsets of  xs .",
    "if the pin - reutenauer procedure holds for  c , then v is full with respect to  c.    let @xmath1 be an arbitrary member of  c. we need to show that the equality   holds .",
    "the inclusion from left to right is an immediate consequence of the continuity of the mapping  v. for the reverse inclusion , we proceed by induction on the construction of a rational expression of  @xmath1 in terms of finite sets in  c. if @xmath1 is a finite set , then @xmath531 and @xmath532 , and so the equality   is trivially verified .",
    "suppose next that @xmath251 and @xmath254 are elements of  c for which the equality   holds .",
    "since topological closure and the application of mappings commutes with union , the equality   also holds for @xmath533 . on the other hand",
    ", we have the following equalities and inclusions : @xmath534{.4\\textwidth }       { since the pin - reutenauer procedure holds for~\\cl        c}}\\\\      & = \\pj v(\\tcls{l_1})\\cdot\\pj v(\\tcls{l_2 } )      & & \\text{by the induction hypothesis}\\\\      & = \\pj v(\\tcls{l_1}\\cdot\\tcls{l_2 } )      & & \\text{since \\pj v is a homomorphism}\\\\      & \\subseteq\\pj v(\\tcls{l_1l_2 } )      & & \\text{by continuity of multiplication . }",
    "\\end{aligned}\\ ] ] taking into account that v is a homomorphism of @xmath28-semigroups and that the inclusion from right to left in   always holds ( see the paragraph preceding theorem 3.5 , p.  ) , one can similarly show that holds for @xmath535 .",
    "recall that a group is _ lerf ( locally extendible residually finite ) _ if every finitely generated subgroup is closed in the profinite topology .",
    "we say that a pseudovariety of groups h is _ lerf _ if , for every finite alphabet  @xmath7 , the relatively free group xh  is lerf . by a classical result of  @xcite ,",
    "the pseudovariety g of all finite groups is lerf .    by",
    ", g  is in fact the only nontrivial extension - closed pseudovariety of groups that is lerf . on the other hand ,",
    "it is easy to check that , for the pseudovariety of all finite abelian groups , every subgroup of @xmath537 is closed  ( * ? ? ?",
    "* proposition  3.8 ) .    a slightly different notion of strongly @xmath8-pr pseudovariety",
    "was considered by   and  @xcite ( where it is simply called pr ) . instead of property ,",
    "the following property is considered : @xmath538 compared to  , the topological closure in the right hand side of   has been dropped . as observed in  (",
    "* end of section 4 ) , equation   fails for the pseudovariety s and the implicit signature  @xmath8 , for @xmath539 , since @xmath540 .",
    "however , the two notions coincide for the pseudovariety  g . with same argument",
    ", we generalize this result to lerf pseudovarieties .",
    "[ l : strongly - k - pr - vs - pr ] let v be a pseudovariety .",
    "if v satisfies for a subset @xmath1 of xv , then also holds .",
    "if v is a lerf pseudovariety of groups and @xmath541 , then  holds for rational subsets @xmath1 of  xv .      for the second part",
    ", we argue as in  @xcite .",
    "let @xmath1 be a rational subset of  xv .",
    "then , @xmath543 is rational in xv . by a well - known theorem of  , the subgroup @xmath544 is therefore finitely generated .",
    "hence , @xmath544 is closed in   xv , by the assumption that v is a lerf pseudovariety .",
    "finally , we have @xmath545 , hence @xmath546 , which , combined with the reverse inclusion , which always holds , yields the result .",
    "it can be shown easily that a @xmath8-pr pseudovariety of groups is lerf ( see  @xcite ) .",
    "thus , a pseudovariety of groups is strongly @xmath8-pr if and only if it is pr in the sense of  @xcite . in (",
    "* corollary  3.9 ) , it is also established that every `` weakly pr '' pseudovariety of groups is @xmath8-full , a result which is considerably improved in the present paper , in the form of corollaries  [ c : pr->full ] and  [ c : main ] .",
    "it was conjectured by   that g is strongly @xmath8-pr .",
    "their conjecture was reduced to another conjecture , namely that the product of finitely many finitely generated subgroups of a free group is closed .",
    "the latter conjecture was established by  . combining with proposition  [ p : hereditarity ] and corollary",
    "[ c : pr->full ] , we obtain the following result .      the diagram in  [ fig : groups ] summarizes the results of this subsection .",
    "we say that a pseudovariety of groups h is _ strong rz _ if in every finitely generated free h - group , any finite product of finitely generated subgroups is closed .",
    "we say that h is _ weak rz _ if , in every finitely generated free h - group , any finite product of finitely generated _ closed _ subgroups is also closed .",
    "( spr ) to node[above ] thm .",
    "[ t : strongly - pr - vs - full - groups ] ( sf ) ; ( spr ) to node[above ] ( * ? ? ? * thm .",
    "4.2.1 ) ( srz ) ; ( wpr ) to node[above ] cor .",
    "[ c : main ] ( wf ) ; ( spr ) to ( wpr ) ; ( sf ) to ( wf ) ; ( srz ) to ( wrz ) ; ( @xmath547 ) to ( hall ) ;                j.  almeida .",
    "finite semigroups : an introduction to a unified theory of pseudovarieties . in g.",
    "m.  s. gomes , j .-  .",
    "pin , and p.  v. silva , editors , _ semigroups , algorithms , automata and languages _ , pages 364 , singapore , 2002 .",
    "world scientific .",
    "j.  almeida .",
    "profinite semigroups and applications . in v.",
    "b. kudryavtsev and i.  g. rosenberg , editors , _ structural theory of automata , semigroups , and universal algebra _",
    ", volume 207 of _ nato science series ii : mathematics , physics chemistry _ , new york , 2005 .",
    "proceedings of the nato advanced study institute on structural theory of automata , semigroups and universal algebra , montral , qubec , canada , 7 - 18 july 2003 .",
    "j.  almeida and b.  steinberg .",
    "syntactic and global semigroup theory , a synthesis approach . in j.  c. birget , s.  w. margolis , j.  meakin , and m.  v. sapir , editors , _ algorithmic problems in groups and semigroups _",
    ", pages 123 .",
    "birkhuser , 2000 .      j.  almeida and m.  zeitoun . the equational theory of @xmath554-terms for finite @xmath555-trivial semigroups . in m.  branco and g.  gomes , editors , _ semigroups and languages _ , pages 123 .",
    "world scientific , 2004 .",
    "m.  huschenbett and m.  kufleitner . .",
    "in e.  w. mayr and n.  portier , editors , _",
    "stacs14 ) _ , volume  25 of _ leibniz international proceedings in informatics ( lipics ) _ , pages 374385 .",
    "schloss dagstuhl  leibniz - zentrum fuer informatik , 2014 .",
    "t.  place and m.  zeitoun .",
    "going higher in the first - order quantifier alternation hierarchy on words . in j.",
    "esparza , p.  fraigniaud , t.  husfeldt , and e.  koutsoupias , editors , _ icalp14 _ ,",
    "volume 8573 of _ lect .",
    "notes comp .",
    "_ , pages 342353 , 2014 .      t.  place and m.  zeitoun . .",
    "in e.  w. mayr and n.  ollinger , editors , _",
    "stacs15 ) _ , volume  30 of _ leibniz international proceedings in informatics ( lipics ) _ , pages 662675 .",
    "schloss dagstuhl  leibniz - zentrum fuer informatik , 2015 ."
  ],
  "abstract_text": [
    "<S> we consider implicit signatures over finite semigroups determined by sets of pseudonatural numbers . we prove that , under relatively simple hypotheses on a pseudovariety v of semigroups , the finitely generated free algebra for the largest such signature is closed under taking factors within the free pro - v semigroup on the same set of generators . </S>",
    "<S> furthermore , we show that the natural analogue of the pin - reutenauer descriptive procedure for the closure of a rational language in the free group with respect to the profinite topology holds for the pseudovariety of all finite semigroups . as an application </S>",
    "<S> , we establish that a pseudovariety enjoys this property if and only if it is full . </S>"
  ]
}