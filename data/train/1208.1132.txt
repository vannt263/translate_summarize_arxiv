{
  "article_text": [
    "the study of near - integrable hamiltonian dynamics on a discrete phase space presents a unique set of problems . on the continuum ,",
    "the orbits of an integrable symplectic nonlinear map are rotations on invariant tori , which , generically , are quasi - periodic . according to kolmogorov - arnold - moser ( kam ) theory , a positive fraction of these tori , identified by their frequency , will survive a sufficiently small smooth perturbation .",
    "the complement of kam tori consists of a hierarchical arrangement of island chains and thin stochastic layers . in low - dimensions ,",
    "the tori disconnect the space and hence ensure stability .",
    "reproducing these structures in a discrete space is problematic , due to the lack of a framework for perturbation theory .",
    "typically , quasi - periodic orbits do not exist .",
    "invariant sets acting as surrogate kam surfaces must thus be identified , and their evolution must be tracked as a perturbation parameter is varied . even in low dimensions ,",
    "these invariant sets need not disconnect the space , so their relevance to stability must be re - assessed .",
    "there are various approaches to space discretisation . for an algebraic system",
    "it is natural to replace the real or complex coordinate fields by a finite field . because this procedure erases all topological information , in the discrete phase space there is no near - integrable regime at all , and one witnesses a discontinuous transition from integrable to non - integrable behaviour .",
    "this transition manifests itself probabilistically via a ( conjectured ) abrupt change in the asymptotic ( large field ) distribution of the periods of the orbits @xcite .",
    "round - off in computer arithmetic brings about an equally blunt discretisation of space . here",
    "a small perturbation causes the dynamics to collapse onto a discrete set . in rare cases ,",
    "round - off fluctuations act like small amplitude noise , and give rise to gaussian transport ; the latter , however , wipes out all small - scale dynamical features .",
    "more commonly , the noise model is inappropriate , but there is no general theory to rely on .",
    "( shadowing theory is unhelpful here because it requires hyperbolicity ( * ? ? ? * section 18.1 ) . ) in all , the literature devoted to the study of deterministic ( as opposed to probabilistic ) manifestation of near - integrability in computer arithmetic is minimal @xcite ( see also @xcite ) .",
    "a different kind of space discretisation occurs in piecewise isometric systems , as the combined effect of discontinuity and rationality . in isometries involving rational rotations",
    ", the space gets tessellated by polygons with algebraic number coordinates .",
    "as these polygons move rigidly , the phase space is discrete .",
    "outer billiards of polygons are symplectic maps of this type , which feature a skeletal version of divided phase space ( see @xcite , and references therein ) . under appropriate rationality conditions ,",
    "these systems support a countable family of bounding invariant sets , which prevent orbits from escaping to infinity @xcite .",
    "these sets , which resemble more a chain of integrable resonant zones than kam invariants , are uniformly distributed on the plane this theme will also appear in the present work .",
    "the existence of unbounded orbits for some irrational parameters has been a significant recent advance @xcite ( see also @xcite ) .    in this paper",
    "we explore discrete near - integrability in the family of invertible lattice maps @xmath1 where @xmath2 is the floor function the largest integer not exceeding its argument .",
    "if we remove the floor function in equation ( [ eq : map ] ) , we obtain a one - parameter family of linear maps of the plane , @xmath3 , which are linearly conjugate to a rotation by the angle @xmath4 , where @xmath5 is the rotation number .",
    "the floor function provides the discretisation , rounding the image point @xmath6 to the nearest lattice point on the left .",
    "an essential property of this model is its invertibility , which a typical round - off scheme applied to a rotation does not have .",
    "furthermore , rounding by the floor function as opposed to the nearest integer is arithmetically nicer and has fewer symmetries . in the lattice map",
    "@xmath7 , the discretisation length is fixed , and the limit of vanishing discretisation corresponds to motions at infinity .",
    "this asymptotic regime is our main interest .",
    "the deceptively simple model ( [ eq : map ] ) displays a rich landscape of mathematical phenomena , connecting discrete dynamics and arithmetic .",
    "this model originated in dynamical system theory @xcite , and was subsequently studied in number theory , within the context of shift radix systems @xcite .",
    "the following unsolved question @xcite distills the difficulties encountered in the analysis of this model .",
    "[ conj : periodicity ] for all real @xmath8 with @xmath9 , all orbits of @xmath7 are periodic .    due to invertibility ,",
    "periodicity is equivalent to boundedness .",
    "this conjecture holds trivially for @xmath10 , where the map @xmath7 is of finite order . beyond this",
    ", the boundedness of all round - off orbits has been proved for only _ eight _ values of @xmath8 , which correspond to the rational values of the rotation number @xmath5 for which @xmath8 is a quadratic irrational : @xmath11 ( the denominator of @xmath5 is @xmath12 , and 12 , respectively . ) in these cases the map @xmath7 admits a dense and uniform embedding in a two - dimensional torus , where the round - off map extends continuously to a piecewise isometry , which has _",
    "zero entropy _",
    "( and is not ergodic ) .",
    "the natural density on the lattice @xmath13 is carried into the lebesgue measure , namely the haar measure on the torus .",
    "the case @xmath14 was established in @xcite , with computer assistance .",
    "similar techniques were used to extend the result to the other parameter values , but only for a set of initial conditions having full density @xcite . the conjecture for the eight parameters",
    "was settled in @xcite with an analytical proof . for any other rational value of @xmath5",
    ", there is a similar embedding in a piecewise isometry of a higher - dimensional torus ; these systems are still unexplored , even in the cubic case .",
    "irrational values of @xmath5 bring about a different dynamics , and a different theory .",
    "the simplest cases correspond to rational values of @xmath8 , and , in particular , to rational numbers whose denominator is the power of a prime @xmath15 . in this case",
    "the map @xmath7 admits a dense and uniform embedding in the ring @xmath16 of @xmath15-adic integers @xcite .",
    "the embedded system extends continuously to the composition of a full shift and an isometry ( which has _ positive entropy _ ) , and the natural density in @xmath13 is now carried into the haar measure on @xmath16 .",
    "this construct was later used to prove a central limit theorem for the departure of the round - off orbits from the unperturbed ones @xcite .",
    "this phenomenon injects a probabilistic element in the determination of the period of the lattice orbits , highlighting the nature of the difficulties that surround conjecture [ conj : periodicity ] .",
    "very recently , akiyama and peth @xcite proved that ( [ eq : map ] ) has infinitely many periodic orbits for any parameter value .    in this work",
    "we consider a new regime , namely the limit @xmath17 of equation ( [ eq : map ] ) , corresponding to the rotation number @xmath18 .",
    "this is one of five limits ( the other limits being @xmath19 ) where the dynamics at the limit is trivial because there is no round - off . after scaling ,",
    "we embed the lattice @xmath13 in @xmath20 , and show that there is a non - smooth integrable hamiltonian _ flow _ ( not a rotation ) , which represents the limiting unperturbed dynamics .",
    "this integrable system is non - linear , namely its time - advance map satisfies a twist condition .",
    "thus the limit @xmath17 is singular .",
    "the parameter @xmath8 acts as a perturbation parameter , and a discrete version of near - integrable symplectic dynamics emerges on the lattice when the perturbation is switched on .",
    "more precisely , if @xmath8 is small , then the orbits lie approximately on convex polygons ; the smaller @xmath8 , the closer the approximation ( figure [ fig : polygonalorbits ] ) .",
    "the number of sides of these polygons increases with the distance from the origin ; near the origin they are squares , while at infinity they approach circles .    in the spirit of takens theorem @xcite",
    ", we introduce a piecewise smooth integrable hamiltonian function ( equation ( [ eq : hamiltonian ] ) ) , whose invariant curves are polygons , representing the limit foliation of the plane for the system ( [ eq : map ] ) . to match hamiltonian flow and lattice map , we exploit the fact that , for small @xmath8 , the composite map @xmath21 is close to the identity . after scaling , it is possible to identify the action of @xmath21 with the unit time - advance map of the flow .",
    "the two actions agree along the sides of the polygons , but they differ in vanishingly small regions near the vertices .",
    "this discrepancy provides the perturbation mechanism .",
    "all integrable orbits must close after one revolution around the origin .",
    "by contrast , the lattice orbits need not do so , leading to a non - trivial clustering of the periods around integer multiples of a basic rotational period see figure [ fig : periodfunction ] .",
    "the lowest branch of the period function comprises the _ minimal orbits , _ which shadow the unperturbed orbits , and close after one revolution . for these orbits ,",
    "the effects of the perturbation cancel out .",
    "( the role of cancellation of singularities in the existence of invariant tori of non - smooth systems was noted long ago @xcite . )",
    "these are the orbits of the integrable system that survive the perturbation .",
    "the other orbits mimic the divided phase space structure of a near - integrable area - preserving map , in embryonic form near the origin , and increasing in complexity for larger amplitudes .",
    "the set of invariant polygons is partitioned by _ critical polygons _ , which contain @xmath13 points , into infinitely many _",
    "polygon classes _ , which can be characterised arithmetically in terms of sums of squares .",
    "the main result of this work is that for infinitely many classes , a positive fraction of the minimal orbits having time - reversal symmetry survive .",
    "the restriction to infinitely many classes as opposed to all classes stems from a coprimality condition we impose in order to achieve convergence of the density .",
    "this density turns out to be a rational number smaller than unity , which depends only on the family of polygons being considered .",
    "as the number of sides of the polygons increases to infinity , the density tends to zero . as a corollary",
    ", we obtain a positive rational lower bound for the density of all minimal orbits symmetric or not .",
    "these results appear as theorems a and b , stated in section [ sec : maintheorems ] after a somewhat lengthy preparation .",
    "our analysis is based on the study of the first - return map to a thin strip placed along the symmetry axis of the map ( [ eq : map ] ) .",
    "the minimal orbits are fixed points of this map , and we study those having time reversal symmetry .",
    "the analysis of the return map requires tracking the return orbits , and this is done through repeated applications of a _ strip map _ , an acceleration device which exploits local integrability .",
    "this is a variant of a construct introduced for outer billiards of polygons ( see @xcite , and references therein ) , although in our case the strip map has an increasing number of components , providing a dynamics of increasing complexity .",
    "there is a symbolic dynamics associated with the strip map ; its cylinder sets in the return domain are congruence classes modulo a nested sequence of two - dimensional lattices .",
    "the key result is that , within a polygon class , this lattice structure becomes independent of @xmath8 , provided that @xmath8 is small enough .",
    "this fact gives a ` non archimedean ' character to the dynamics ; the rationality of the density of minimal orbits , and their locally uniform distribution then follow .",
    "the plan of this paper is the following .",
    "in section [ sec : integrablelimit ] we introduce the integrable hamiltonian , characterise its invariant curves via a symbolic dynamics , and connect them to the arithmetical problem of sums of two squares ( theorem [ thm : polygons ] ) . in section [ sec : recurrence ] we switch on the round - off perturbation , and show that all orbits recur to a small neighbourhood of the symmetry axis . accordingly , we construct a return map of this neighbourhood , and show that the return orbits shadow the integrable orbits ( theorem [ thm : hausdorff ] ) . most proofs for this section are postponed to section [ sec : proofs ] . matching the symbolic dynamics of integrable and perturbed orbits",
    "is more delicate , requiring the exclusion of certain anomalous domains , and establishing that the size of these domains is negligible in the limit .",
    "this is done in section [ sec : maintheorems ] , where we also state the main results of this work , theorems a and b. the first theorem states that , for all sufficiently small @xmath8 , the return map commutes with translations by the elements of a two - dimensional lattice , which depends only on the polygonal class being considered .",
    "the second theorem states that , if the symbolic dynamics of a polygonal class satisfies certain coprimality conditions , then , as @xmath17 the density of symmetric minimal orbits among all symmetric orbits converges to a positive rational number , which is computed explicitly .",
    "an immediate corollary of theorem b is the existence of a positive rational lower bound for the density of minimal orbits symmetric or otherwise among all orbits ( corollary [ cor : density ] ) . at the end of section [ sec : maintheorems ]",
    "we also briefly discuss some experiments on the conditions of the statement of theorem b. in section [ sec : stripmap ] we introduce the strip map , and establish some of its properties ( propositions [ thm : regularity ] and [ thm : epsilon_j ] ) . in the final section",
    "we demonstrate the link between the symbolic dynamics of the perturbed orbits and the aforementioned group of lattice translations .",
    "this result leads to the conclusion of the proof of the main theorems .",
    "there are many issues we havent considered .",
    "the nature of the phase portrait at infinity , stability , the role played by non - symmetric orbits , the distribution of periods among the branches of the period function .",
    "more generally , one may consider the construct of strip maps for the purpose of developing a hamiltonian perturbation theory over discrete spaces .",
    "these questions deserve further investigation .",
    "we are grateful to j a g roberts for engaging discussions , and to the referees , whose comments helped us improve the clarity and correctness of the paper .",
    "figure [ fig : polygonalorbits ] suggests that the analysis of the limit @xmath17 requires some scaling ; equation ( [ eq : map ] ) suggests that the quantity to be held constant should be @xmath22 .",
    "accordingly , we normalise the metric by introducing the * scaled lattice map * @xmath23 , which is conjugate to @xmath7 , and acts on points @xmath24 of the scaled lattice @xmath25 : @xmath26 the discretisation length of @xmath27 is @xmath8",
    ". then we define the * discrete vector field * , which measures the deviation of @xmath28 from the identity : @xmath29    to capture the main features of @xmath30 on the scaled lattice , we introduce an * auxiliary vector field * @xmath31 on the plane , given by @xmath32 the field @xmath31 is constant on every translated unit square ( called a _ box _ ) @xmath33 and we denote the value of @xmath31 on @xmath34 as @xmath35    the following proposition , whose proof we defer until section [ sec : proofs ] , states that if we ignore a set of points of zero density , then the functions @xmath36 and @xmath37 agree on the lattice @xmath25 .",
    "[ prop : mu_1 ] let @xmath38 be a positive real number .",
    "we define the set @xmath39 ( with @xmath40 ) , and the ratio @xmath41 then we have @xmath42    the asymptotic regime that results from replacing @xmath36 by @xmath37 will be referred to as the * integrable limit * of the system , as @xmath17 .",
    "the points where the two vector fields differ have the property that @xmath22 or @xmath43 is close to an integer .",
    "the perturbation of the integrable orbits will take place in these small domains .",
    "we define the real function @xmath44 where @xmath45 denotes the fractional part of @xmath46 .",
    "the function @xmath47 is piecewise affine , and coincides with the function @xmath48 on the integers .",
    "thus : @xmath49 using this fact , we can invert @xmath47 up to sign by defining @xmath50 so that @xmath51 .",
    "we define the following hamiltonian @xmath52 the function @xmath53 is continuous and piecewise affine .",
    "it is differentiable in @xmath54 , where @xmath55 is a set of orthogonal lines given by @xmath56 the set @xmath55 is the boundary of the boxes @xmath34 , defined in ( [ eq : b_mn ] ) .",
    "the associated ( scaled ) hamiltonian vector field , defined for all points @xmath57 , is parallel to the vector field @xmath31 given in ( [ eq : w ] ) : @xmath58 the parameter @xmath8 merely rescales the time .    for a point @xmath59",
    ", we write @xmath60 for the level set of @xmath53 passing through @xmath61 : @xmath62 below ( theorem [ thm : polygons ] ) we shall see that these sets are polygons .",
    "the * value * of a polygon @xmath60 is the real number @xmath63 , and if @xmath60 contains a lattice point , then we speak of a * critical polygon*. the critical polygons form a distinguished subset of the plane : @xmath64 all topological information concerning the hamiltonian @xmath53 is encoded in the partition of the plane generated by @xmath65 .",
    "the elements of @xmath66 act as separatrices , whose vertices belong to @xmath55 .",
    "to characterise @xmath53 arithmetically , we consider the hamiltonian @xmath67 which represents the unperturbed rotations ( no round - off ) in the limit @xmath17 .",
    "its level sets are circles , and the circles containing lattice points will be called * critical circles*. by construction , the functions @xmath53 and @xmath68 coincide over @xmath13 , and hence the value of every critical polygon belongs to @xmath69 , the set of non - negative integers which are representable as the sum of two squares .",
    "we denote this set by @xmath70 .    a classical result , due to fermat and euler , states that a natural number @xmath71 is a sum of two squares if and only if any prime congruent to 3 modulo 4 which divides @xmath71 occurs with an even exponent in the prime factorisation of @xmath71 ( * ? ?",
    "* theorem 366 ) ) .",
    "we refer to @xmath70 as the set of * critical numbers * , and use the notation @xmath72 there is an associated family of * critical intervals * , defined as @xmath73 let us define @xmath74 the following result , due to landau and ramanujan , gives the asymptotic behaviour of @xmath75 ( see , e.g. , @xcite ) @xmath76 where @xmath77 is the landau - ramanujan constant @xmath78    furthermore , let @xmath79 be the number of representations of the integer @xmath71 as a sum of two squares . to compute @xmath79 , we first factor @xmath71 as follows @xmath80 where @xmath15 and @xmath81 are primes congruent to 1 and 3 modulo 4 , respectively .",
    "( each product is equal to 1 if there are no prime divisors of the corresponding type .",
    ") then we have ( * ? ? ?",
    "* theorem 278 ) @xmath82 note that this product is zero whenever @xmath71 is not a critical number , i.e. , @xmath83 if @xmath84 .",
    "we now have the following characterisation of the invariant curves of the hamiltonian @xmath53 .",
    "[ thm : polygons ] the level sets @xmath60 of @xmath53 are convex polygons , invariant under the dihedral group @xmath85 , generated by the two orientation - reversing involutions @xmath86 the polygon @xmath60 is critical if and only if @xmath87 the number of sides of @xmath60 is equal to @xmath88 where the function @xmath38 is given in ( [ eq : r ] ) .",
    "for every @xmath89 , the critical polygon with value @xmath90 intersects one and only one critical circle , namely that with the same value .",
    "the intersection consists of @xmath91 lattice points , and the polygon lies inside the circle .",
    "the symmetry properties follow from the fact that the hamiltonian @xmath53 is invariant under the interchange of its arguments , and the function @xmath47 is even : @xmath92    the vector field ( [ eq : hamiltonianvectorfield ] ) is piecewise - constant , and equal to @xmath93 in the box @xmath34 ( cf",
    ".  equations ( [ eq : b_mn ] ) and ( [ eq : w_mn ] ) ) .",
    "hence a level set @xmath60 is the union of segments .",
    "it is easy to verify that no three segments can have an end - point in common ( considering end - points in the first octant will suffice ) .",
    "thus @xmath60 is a polygonal curve .",
    "equally , segments can not intersect inside boxes , because they are parallel there .",
    "but a non self - intersecting symmetric polygonal must be a polygon .",
    "next we prove convexity .",
    "due to dihedral symmetry , if @xmath60 is convex within the open first octant @xmath94 , then it is piecewise convex .",
    "thus we suppose that @xmath60 has an edge in the box @xmath34 , where @xmath95 .",
    "the adjacent edge in the direction of the flow must be in one of the boxes @xmath96 using ( [ eq : w_mn ] ) one verifies that the three determinants @xmath97 are negative .",
    "this means that , in each case , at the boundary between adjacent boxes , the integral curve turns clockwise .",
    "so @xmath60 is piecewise convex .",
    "it remains to prove that convexity is preserved across the boundaries of the first octant , which belong to the fixed sets @xmath98 ( the line @xmath99 ) and @xmath100 ( the line @xmath101 ) of the involutions ( [ eq : dihedral ] ) .",
    "indeed , @xmath60 is either orthogonal to @xmath102 ( in which case convexity is clearly preserved ) , or has a vertex @xmath103 on it ; in the latter case , the relevant determinant is @xmath104 .",
    "the preservation of convexity across @xmath100 is proved similarly , and thus @xmath60 is convex .",
    "the statement on the criticality of @xmath63 follows from the fact that , on @xmath13 , we have @xmath105 .",
    "consider now the edges of @xmath60 .",
    "the intersections of @xmath60 with the @xmath46-axis have abscissas @xmath106 . using ( [ eq : sqrtp ] ) we have that there are @xmath107 integer points between them , hence as many lines orthogonal to the @xmath46-axis with integer abscissa .",
    "the same holds for the @xmath108-axis .",
    "if @xmath60 is non - critical , it follows that @xmath60 intersects @xmath55 in exactly @xmath109 points , each line being intersected twice . because the vector field changes across each line , the polygon has @xmath109 vertices .",
    "if the polygon is critical , then we have @xmath110 . at each of the @xmath91 vertices that belong to @xmath13 , two lines in @xmath55 intersect , resulting in one fewer vertex .",
    "so @xmath91 vertices must be removed from the count .",
    "next we deal with intersections of critical curves .",
    "let us consider two arbitrary critical curves @xmath111 this system of equations yields @xmath112 which is a circle with centre at @xmath113 , and radius @xmath114 , where @xmath115 since we must have @xmath116 , we find @xmath117 , and since @xmath118 is an integer , we obtain @xmath119 .",
    "so critical polygons and circles intersect only if they have the same value , and their intersection consists of lattice points",
    ". then the number of these lattice points is necessarily equal to @xmath91 .",
    "finally , let the lattice point @xmath120 belong to the intersection of two critical curves , and let @xmath121 be the vector field of the hamiltonian @xmath68 at that point . without loss of generality , we assume that @xmath120 lies within the first octant . if @xmath122 , then the vector field of @xmath53 before and after the vertex in the direction of the flow is equal to @xmath123 and @xmath124 , respectively .",
    "one verifies that the determinants @xmath125 are negative .",
    "this means that , near this vertex , the polygon lies inside the circle . if @xmath126 , the field after the vertex is @xmath127 , and the same result holds .",
    "the proof is complete .    from this theorem",
    "it follows that the set @xmath66 of critical polygons partitions the plane into concentric domains , which we call * polygon classes*. each domain contains a single critical circle , and has no lattice points in its interior .",
    "the values of all the polygons in a class is a critical interval ( [ eq : eulerinterval ] ) .",
    "there is a dual arrangement for critical circles . because counting critical polygons is the same as counting critical circles , the number of critical polygons ( or , equivalently , of polygon classes ) contained in a circle of radius @xmath128 is equal to @xmath75 , with asymptotic formula ( [ eq : landauramanujan ] ) . from equation ( [ eq : rho ] )",
    ", one can show that the total variation @xmath129 of @xmath68 along the polygon @xmath130 satisfies the bound @xmath131 which is strict ( e.g. , for @xmath132 ) .",
    "in theorem [ thm : polygons ] we classified the invariant curves of the hamiltonian @xmath53 in terms of critical numbers .",
    "we found that the set @xmath66 of critical polygons partitions the plane into concentric annular domains the polygon classes . in this section",
    "we define a symbolic dynamics on the set of classes , which specifies the common itinerary of all orbits in a class , taken with respect to the lattice @xmath13 .",
    "suppose that the polygon @xmath60 is non - critical .",
    "then all vertices of @xmath60 belong to @xmath133 , where @xmath55 was defined in ( [ eq : delta ] ) .",
    "let @xmath134 be a vertex .",
    "then @xmath134 has one integer and one non - integer coordinate , and we let @xmath135 be the value of the non - integer coordinate .",
    "we say that the vertex @xmath134 is of * type * @xmath136 if @xmath137",
    ". then we write @xmath138 for the type of the @xmath139th vertex , where the vertices of @xmath60 are enumerated according to their position in the plane , starting from the positive half of symmetry line @xmath98 and proceeding clockwise .    as the type of a vertex",
    "is defined using the modulus of the non - integer coordinate , the sequence of vertex types @xmath138 reflects the eight - fold symmetry of @xmath60 . hence if the @xmath140th vertex lies on the @xmath46-axis , then there are @xmath141 vertices belonging to each quarter - turn , and the vertex types satisfy @xmath142 thus it suffices to consider the vertices in the first octant , and the * vertex list * of @xmath60 is the sequence of vertex types @xmath143 we note that the vertex list can be decomposed into two disjoint subsequences ; those entries belonging to a vertex with integer @xmath46-coordinate and those belonging to a vertex with integer @xmath108-coordinate .",
    "these subsequences are non - decreasing and non - increasing , respectively .    from theorem [ thm : polygons ]",
    ", it follows that for every @xmath89 , the set of polygons @xmath60 with @xmath144 have the same vertex list .",
    "let @xmath140 be the number of entries in the vertex list .",
    "since the polygon @xmath60 is non - critical , equation ( [ eq : numberofsides ] ) gives us that @xmath145 , and hence @xmath146 any two polygons with the same vertex list have not only the same number of edges , but intersect the same collection of boxes , and have the same collection of tangent vectors .",
    "the critical polygons which intersect the lattice @xmath13 , where the vertex list is multiply defined , form the boundaries between classes .",
    "the symbolic dynamics of these polygons is ambiguous , but this item will not be required in our analysis .",
    "thus the vertex list is a function on classes , hence on @xmath70 .",
    "for example , the polygon class identified with the interval @xmath147 ( see figure [ fig : v(9 ) ] ) has vertex list @xmath148 see figure [ fig : v_table ] for further examples of v(e ) . for each class",
    ", there are two vertex types which we can calculate explicitly ; the first and the last .",
    "if @xmath149 , and the polygon @xmath60 intersects the symmetry line @xmath98 at some point @xmath150 , then by the definition ( [ eq : hamiltonian ] ) of the hamiltonian @xmath53 @xmath151 thus inverting @xmath47 and using ( [ eq : sqrtp ] ) , it is straightforward to show that the first vertex type is given by @xmath152 similarly the last vertex type , corresponding to the vertex on the @xmath46-axis is given by @xmath153    [ cols=\"<,<\",options=\"header \" , ]",
    "( the proofs of all statements in this section are deferred until section [ sec : proofs ] . )",
    "the lattice map @xmath7 has fewer symmetries than the hamiltonian @xmath53 , but it is easy to verify that @xmath7 is still reversible , being conjugate to its inverse via the involution @xmath154 given in equation ( [ eq : dihedral ] ) : @xmath155 the scaled map @xmath27 has the same property , and all orbits of @xmath27 return repeatedly to a neighbourhood of the symmetry line @xmath98 . in this section",
    "we consider the return map associated to this recurrence , and identify some asymptotic properties of the first - return orbits .    from equation ( [ eq : map ] )",
    ", the rotation number @xmath5 has the asymptotic form @xmath156 the integer @xmath157 is the * zeroth - order recurrence time * of orbits under @xmath23 , that is , the number of iterations needed for a point to return to an @xmath158-neighbourhood of its starting point .",
    "it turns out ( see proof of proposition [ prop : mu_1 ] ) that the field @xmath159 ( equation ( [ eq : v ] ) ) is non - zero for all non - zero points @xmath61 , so no orbit has period four .",
    "accordingly , for small @xmath160 , we define the * first - order recurrence time * @xmath161 of the rotation to be the next time of closest approach : @xmath162 where @xmath163 is the hausdorff distance , and the expression @xmath164 , with @xmath165 , is to be understood as the hausdorff distance between the sets @xmath45 and @xmath166 .",
    "( throughout this paper we use @xmath167 to denote the set of positive integers . )    the integer @xmath161 provides a natural recurrence timescale for @xmath23 .",
    "let @xmath168 be the minimal period of the orbit under @xmath7 of the point @xmath169 , so that @xmath170 is the corresponding function for points @xmath171 under @xmath23 .",
    "( in accordance with the periodicity conjecture , we assume that this function is well - defined . )",
    "since , as @xmath17 , the recurrence time @xmath161 diverges , the periods of the orbits will cluster around integer multiples of @xmath161 , giving rise to branches of the period function .",
    "the lowest branch corresponds to orbits that perform a single revolution around the origin , and their period is approximately equal to @xmath161 .",
    "the period function @xmath172 has a normalised counterpart , given by ( cf .",
    "( [ eq : tstar ] ) ) @xmath173 the values of @xmath174 oscillate about the integers ( figure [ fig : periodfunction ] ) .",
    "we construct a poincar return map @xmath175 on a neighbourhood of the positive half of the symmetry line @xmath98 .",
    "let @xmath176 be the perpendicular distance between a point @xmath61 and @xmath98 : @xmath177    we define the domain @xmath178 of the return map @xmath175 to be the set of points @xmath179 which are closer to @xmath98 than their pre - images under @xmath180 , and at least as close as their images : @xmath181 asymptotically , for every non - negative integer @xmath182 , the set @xmath178 has non - empty intersection with the boxes @xmath183 .",
    "the main component is in @xmath184 , a thin strip of width @xmath185 lying parallel to the symmetry line @xmath98 ( figure [ fig : x ] ) . to ensure that this component is non - empty , we require @xmath186 , where the critical parameter @xmath187 is given by @xmath188    the transit time @xmath189 to the set @xmath178 is well - defined for all @xmath171 : @xmath190 thus the first return map @xmath175 is the function @xmath191 we refer to the orbit of @xmath192 up to the return time @xmath193 as the * return orbit * of @xmath61 : @xmath194 we let @xmath195 be the transit time to @xmath178 under @xmath196 : @xmath197 so that the return orbit for a general @xmath171 is given by : @xmath198    to associate a unique return orbit to an integrable orbit , we define the rescaled round - off function @xmath199 , which rounds points on the plane down to the next lattice point : @xmath200 where @xmath201 is the integer round - off function @xmath202 for every point @xmath203 and every @xmath204 , the set of points @xmath205 that represent @xmath206 on the lattice as @xmath207 is countably infinite .",
    "the corresponding set of points on @xmath13 , before rescaling , is unbounded .    in the rest of this section , we state some metric properties of the return orbits , and",
    "then show that the return orbits shadow the integrable orbits . the proofs will be found in section [ sec : proofs ] .    according to proposition [ prop : mu_1 ] on page , the points of the scaled lattice @xmath25 at which integrable and discrete vector fields have different values are rare , as a proportion of lattice points .",
    "the following result shows that these points are also rare within each return orbit .",
    "[ prop : mu_2 ] for any @xmath203 , if we define the ratio @xmath208 then we have @xmath209    to establish propositions [ prop : mu_1 ] and [ prop : mu_2 ] , we seek to isolate the lattice points @xmath171 where the discrete vector field @xmath210 deviates from the integrable vector field @xmath211 .",
    "we say that a point @xmath171 is a * transition point * if @xmath61 and its image under @xmath212 do not belong to the same box , namely if @xmath213 let @xmath214 be the set of transition points .",
    "then @xmath215 where @xmath216    for small @xmath8 , the set of transition points @xmath214 consists of thin strips of lattice points arranged along the lines @xmath55 ( see figure [ fig : lambdasigma_plot ] ) .",
    "the following key lemma states that , for sufficiently small @xmath8 , all points @xmath217 where @xmath218 are transition points .",
    "[ thm : lambda ] let @xmath219 be as in equation ( [ eq : a ] ) .",
    "then for all @xmath220 there exists @xmath221 such that , for all @xmath222 and @xmath223 , we have @xmath224    we conclude this section by formulating a shadowing theorem , which states that for time scales corresponding to a first return to the domain @xmath178 , every integrable orbit has a scaled return orbit that shadows it .",
    "furthermore , this scaled orbit of the round - off map converges to the integrable orbit in the hausdorff metric as @xmath17 .",
    "[ thm : hausdorff ] for any @xmath203 , let @xmath225 be the orbit of @xmath53 , and let @xmath226 be the return orbit at the rounded lattice point",
    ". then @xmath227 where @xmath163 is the hausdorff distance on @xmath20 .",
    "this result justifies the term ` integrable limit ' assigned to the flow @xmath53 .",
    "proof of lemma [ thm : lambda ] .",
    "let @xmath220 be given , and let @xmath219 be as in equation ( [ eq : a ] ) . we show that if @xmath8 and @xmath228 are sufficiently small ( and @xmath229 ) , then @xmath230 since @xmath223 , we have @xmath231 for some @xmath232 , where @xmath233 is the ceiling function , defined by the identity @xmath234 . through repeated applications of @xmath23 , we have @xmath235 where the integers @xmath236 are given by @xmath237 the integers @xmath238 , @xmath239 , @xmath240 and @xmath241 label the boxes in which each iterate occurs ( figure [ fig : f_iterates ] ) , and also give an explicit expression for the round - off term @xmath242 at each step . thus reading from the last of these equations , the discrete vector field @xmath30 is given by @xmath243 and @xmath61 is a transition point whenever at least one of the equalities @xmath244 and @xmath245 on the box labels fails .",
    "if the integers @xmath182 , @xmath238 , @xmath239 , @xmath240 are sufficiently small relative to the number of lattice points per unit length , i.e. , if @xmath246 then the map @xmath247 moves the point @xmath61 at most one box in each of the @xmath46 and @xmath108 directions , so that the labels @xmath238 , @xmath239 , @xmath240 and @xmath241 satisfy @xmath248 similarly , ( [ eq : abc_ineq ] ) dictates that the discrepancy between each of the pairs @xmath249 , @xmath250 can not be too large : @xmath251    letting @xmath252 , we obtain @xmath253 so that ( [ eq : bd_ac_sets ] ) and ( [ eq : bd_ac_ineq ] ) hold for all @xmath222",
    ". then the expression ( [ eq : v_abcd ] ) for @xmath30 , combined with the inequality ( [ eq : bd_ac_ineq ] ) , gives that @xmath254 if and only if @xmath255    suppose now that @xmath61 is not a transition point , so that @xmath245 and @xmath244 , but that @xmath256 , so that at least one of the equalities ( [ eq : v = w ] ) fails .",
    "if @xmath257 , straightforward manipulation of inequalities shows that the only combination of values which satisfies ( [ eq : bd_ac_sets ] ) is @xmath258 in turn , using also the inequality ( [ eq : bd_ac_ineq ] ) , @xmath259 implies that @xmath260 combining these , we have @xmath261 , which corresponds to the unique point @xmath262 .",
    "we now use this result to prove propositions [ prop : mu_1 ] and [ prop : mu_2 ] , given in sections [ sec : integrablelimit ] and [ sec : recurrence ] , respectively .",
    "proof of proposition [ prop : mu_1 ] . from equation ( [ eq : a ] )",
    ", we have that the number of lattice points in the set @xmath219 is given by @xmath263 by lemma [ thm : lambda ] , for sufficiently small @xmath8 , every non - zero point @xmath223 satisfying @xmath256 is a transition point , so has @xmath264 for some @xmath265 with @xmath266 .",
    "furthermore , every set @xmath267 is composed of two strips , each of unit length , and width approximately equal to @xmath268 and @xmath269 , respectively .",
    "we can bound the number of lattice points in the set @xmath267 explicitly by @xmath270 for some positive constant @xmath240 , independent of @xmath182 and @xmath71 .",
    "( indeed @xmath271 is sufficient  cf .  the methods used in the proof of proposition [ prop : xe_tilde ] . )",
    "it follows that for fixed @xmath220 , as @xmath17 we have the estimate @xmath272 since @xmath273 , the proof is complete .    by construction ,",
    "the piecewise - constant vector field @xmath31 is parallel to the hamiltonian vector field associated with @xmath53 ( cf",
    ".  equation ( [ eq : hamiltonianvectorfield ] ) ) .",
    "it follows that @xmath53 is invariant under translation by @xmath31 everywhere except across the discontinuities of @xmath31 , i.e. , except at transition points , which occur near the vertices of integrable orbits .    in the above proof of proposition [ prop : mu_1 ]",
    ", we show that transition points @xmath274 have zero density in the limit @xmath275 in the following sense : @xmath276 so that in any bounded region , and for sufficiently small @xmath8 , @xmath53 is invariant under translation by @xmath31 almost everywhere . in turn , lemma [ thm : lambda ] implies that @xmath53 is invariant under translation by @xmath30 , and hence under iterates of @xmath28 , almost everywhere .",
    "again the exceptions to this rule occur near the vertices of integrable orbits .    to prove proposition [ prop : mu_2 ] and theorem [ thm : hausdorff ] , we bound the variation in the hamiltonian function @xmath53 along perturbed orbits @xmath277 . since we know @xmath53 is invariant under @xmath28 at all points @xmath278 , it remains to consider the change in @xmath53 under @xmath23 , and under @xmath28 at points @xmath274 .",
    "proof of proposition [ prop : mu_2 ] .",
    "let @xmath220 .",
    "using lemma [ thm : lambda ] , we observe that for sufficiently small @xmath8 , @xmath53 is invariant under @xmath28 on @xmath279 .",
    "we begin by bounding the change in @xmath53 under @xmath28 on the set @xmath280 .    for any @xmath281",
    "we have : @xmath282 } \\nabla{\\mathscr{p}}(\\xi)\\cdot d\\mathbf{\\xi } \\ ; \\right| \\\\ & \\leq \\max_{\\xi\\in[z , z+v ] } \\left ( \\|\\nabla{\\mathscr{p}}(\\xi)\\| \\right ) \\ , \\|v\\|,\\end{aligned}\\ ] ] where @xmath283 $ ] denotes the line segment joining the points @xmath61 and @xmath284 , @xmath285 is the line element tangent to this segment , and @xmath286 is the gradient of @xmath53 , given by : @xmath287 if @xmath24 and @xmath288 is the discrete vector field , then for sufficiently small @xmath8 , equations ( [ eq : abcd ] ) and ( [ eq : bd_ac_sets ] ) can be combined to give : @xmath289 this inequality ensures that the length of the line segment @xmath283 $ ] goes to zero with @xmath8 , so that for sufficiently small @xmath8 , the piecewise - constant form of the gradient @xmath286 gives : @xmath290 } ( \\|\\nabla{\\mathscr{p}}(\\xi)\\| )    & \\leq \\sqrt{(|2\\lfloor \\lambda x \\rfloor + 1| + 2)^2 + ( |2\\lfloor \\lambda y \\rfloor + 1| + 2)^2 } \\\\    & \\leq \\sqrt{(2 |\\lambda x| + 3)^2 + ( 2 |\\lambda y| + 3)^2 } \\\\   &",
    "\\leq 2\\|z \\| + 3\\sqrt{2}.\\end{aligned}\\ ] ] substituting these into the first inequality , we have that for sufficiently small @xmath8 : @xmath291 for the change in @xmath53 under @xmath23 , if @xmath24 , then by the same sort of analysis we have : @xmath292 where @xmath47 is the piecewise - affine function defined in equation ( [ eq : p ] ) .",
    "( see page for the proof that @xmath47 is even . )",
    "it follows that for any orbit contained in @xmath219 , if @xmath293 and @xmath294 : @xmath295 where @xmath182 is the number of transition points in the orbit of @xmath61 under @xmath28 : @xmath296 similar expressions hold in backwards time , for iterates of @xmath297 and @xmath196 . for fixed @xmath8 ,",
    "this estimate bounds the perturbed orbit of a point @xmath171 to a polygonal annulus around the polygon @xmath60 , which grows in thickness as the number of transition points in the orbit increases .",
    "conversely , by taking a sufficiently small value of @xmath8 , we can ensure that the perturbed orbit of @xmath61 stays arbitrarily close to the polygon @xmath60 for any finite number of transition points .",
    "specifically , given any @xmath298 and @xmath299 , there is a critical value of @xmath8 below which any point @xmath300 along the perturbed orbit satisfies @xmath301 as long as the number of transition points encountered is not more than @xmath182 : @xmath302    now let @xmath303 be given , and let @xmath304 , so that @xmath277 is the return orbit which shadows the integrable orbit @xmath225 . furthermore let @xmath305 , where @xmath306 is the abscissa of the intersection of @xmath225 with the positive @xmath46-axis . since @xmath307 ,",
    "using the same bounds as above , we have : @xmath308 } ( \\|\\nabla{\\mathscr{p}}(\\xi)\\| ) \\ , \\|z - w\\| \\\\",
    "& \\leq \\sqrt{2}\\lambda(2\\|w \\| + 3\\sqrt{2}),\\end{aligned}\\ ] ] so that for small @xmath8 , the polygons @xmath60 and @xmath225 are close .",
    "pick @xmath309 and consider the polygons @xmath310 given by @xmath311 without loss of generality , we may assume that neither of these polygons is critical .",
    "thus each of these integrable orbits intersects as many boxes as it has sides .",
    "for the larger polygon @xmath312 , the number of sides ( see theorem [ thm : polygons ] ) is given by @xmath313 and we let this number be @xmath182 .",
    "furthermore , we note that all lattice points in the interior of @xmath312 are elements of the set @xmath314 , since : @xmath315    then , as we showed above , for sufficiently small @xmath8 , the perturbed orbit @xmath277 is bounded between @xmath310 as long as the number of transition points encountered does not exceed @xmath182 . by construction ( cf .",
    "equation ( [ eq : lambda ] ) ) , the return orbit @xmath277 contains at most one transition point for every box it intersects . however , as long as the perturbed orbit is bounded above by the integrable orbit @xmath316 , it can not intersect more boxes than this integrable orbit in any one revolution around the origin .",
    "hence the perturbed orbit can not intersect more than @xmath182 boxes in any one revolution , and its number of transition points is bounded above as follows : @xmath317    now we consider the total number of points in the return orbit @xmath277 . since the perturbed orbit is bounded below by the integrable orbit @xmath318 , it must contain a point @xmath134 , close to the positive @xmath46-axis , with @xmath46-coordinate not less than : @xmath319 similarly it must contain a point @xmath134 , close to the negative @xmath46-axis , with @xmath46-coordinate not greater than @xmath320 .",
    "the return orbit moves between these points via the action of @xmath28 , i.e. , by translations of the vector field @xmath30 .",
    "hence , for sufficiently small @xmath8 , the number of steps required for the orbit to move from one point to the other in , say , the upper half - plane , is bounded below by the distance @xmath321 divided by the maximal length of @xmath30 along the orbit : @xmath322    thus , as @xmath275 , we have the estimate @xmath323 since @xmath324 , the proof is complete .",
    "proof of theorem [ thm : hausdorff ] .",
    "let @xmath303 be given , and let @xmath304 , so that @xmath277 is the return orbit which shadows the integrable orbit @xmath225 .",
    "we have already seen , in the proof of proposition [ prop : mu_2 ] , that by taking a sufficiently small value of @xmath8 , we can ensure that the perturbed orbit of @xmath61 stays arbitrarily close to the polygon @xmath60 .",
    "it follows that : @xmath325 as @xmath275 .",
    "neighbouring points @xmath326 in the return orbit @xmath277 are also @xmath158-close as @xmath275 , so the result follows .",
    "in this section we state theorems a and b , after the necessary preparation . then we briefly discuss the conditions of theorem b.    in section [ sec : integrablelimit ] , the positive real line was partitioned into critical intervals @xmath327 , each corresponding to a distinct polygon class of the integrable system ; accordingly , the set @xmath66 of critical polygons partitioned the plane . in section",
    "[ sec : recurrence ] we reduced the near - integrable round - off map @xmath27 to a return map @xmath175 of a thin domain @xmath178 , placed along the symmetry axis . in this section we partition the set @xmath178 into sub - domains which play the same role for the perturbed orbits as the intervals @xmath328 for the integrable orbits .    by theorem [ thm :",
    "hausdorff ] , the return orbit @xmath277 of a point @xmath192 shadows the orbit @xmath60 of the integrable hamiltonian @xmath53 . however , the quantity @xmath53 is not constant along perturbed orbits . to deal with this problem ,",
    "we introduce the following sequence of sets @xmath329 it remains to match the vertex list associated with @xmath328 . to this end , it is necessary to replace the sets @xmath330 by smaller * regular domains * , and then prove that , in the limit , these domains have full density in @xmath178 .",
    "we start by defining the * edges * of @xmath277 , as the non - empty sets of the form @xmath331 for sufficiently small @xmath8 , consecutive edges of @xmath277 must lie in adjacent boxes , and transitions between edges occur when the orbit meets the set @xmath214 given in equation ( [ eq : lambda ] ) .",
    "thus we call the set @xmath332 the set of * vertices * of @xmath277 . by analogy with the vertices of the polygons",
    ", we say that the return orbit @xmath277 has a vertex on @xmath333 of * type * @xmath136 if there exists a point @xmath334 such that @xmath335 similarly for a vertex on @xmath336 of type @xmath136 .",
    "a perturbed orbit is * critical * if it has a vertex whose type is undefined , i.e. , if there exists @xmath334 such that @xmath337 for some @xmath265 ( see figure [ fig : critical_vertex ] ) .    by excluding points",
    "whose perturbed orbit is critical , we ll construct a subset @xmath338 of @xmath330 with the following properties : @xmath339 for all @xmath340 the orbit @xmath277 has the same sequence of vertex types as @xmath60 ; @xmath341 the union of all sets @xmath338 still has full density in @xmath178 , as @xmath17 .",
    "we now give the construction of @xmath338 .",
    "let the set @xmath342 be given by @xmath343 where @xmath344 and @xmath345 .",
    "the set @xmath346 is a small domain , adjacent to the integer point @xmath120 ( see figure [ fig : lambdasigma_plot ] ) .",
    "if @xmath347 for some @xmath89 , we say that @xmath61 is * regular * if two properties hold : firstly , @xmath61 itself is not a vertex of @xmath277 , i.e. , @xmath348 and secondly the orbit @xmath277 does not intersect the set @xmath349 .",
    "points which are not regular are called * irregular*. then the set @xmath338 is defined as @xmath350 where @xmath351 is the largest interval such that all points in @xmath338 are regular .    in principle , the interval @xmath352 need not be uniquely defined , and may be empty .",
    "however , the following proposition ensures that @xmath352 is well - defined for all sufficiently small @xmath8 , and indeed that the irregular points have zero density in @xmath178 as @xmath275 .",
    "[ thm : i^e_tilde ] let @xmath338 and @xmath353 be as above . then , for all @xmath89 , we have @xmath354    consider @xmath192 such that @xmath149 for some @xmath89 .",
    "if the orbit of @xmath61 strays between polygon classes , i.e. , if @xmath355 , then we have @xmath356 however , in the proof of theorem [ thm : hausdorff ] in section [ sec : proofs ] , we showed that the maximum variation in @xmath53 along an orbit @xmath277 is of order @xmath8 , as @xmath275 : @xmath357 hence we have @xmath358 where @xmath359 is the successor of @xmath90 in the sequence @xmath70 . in both cases",
    ", @xmath63 is near the boundary of @xmath328 .    if @xmath347 but @xmath61 is irregular , then either @xmath274 or the orbit of @xmath61 intersects the set @xmath349 .",
    "if @xmath274 , then one of its coordinates must be nearly integer : @xmath360 where the set @xmath55 was defined in ( [ eq : delta ] ) .",
    "however , as the domain @xmath330 lies in an @xmath158-neighbourhood of the symmetry line @xmath98 , it follows that both coordinates must be nearly integer , giving @xmath361 again , @xmath63 lies in a @xmath158-neighbourhood of the boundary of @xmath328 .",
    "similarly , if there is a point @xmath362 , then , by construction , @xmath363",
    "hence we have again the estimate ( [ eq : pvariation ] ) .    combining these observations , we have @xmath364 and the result follows .",
    "we now give an explicit representation of @xmath338 .",
    "let @xmath365 be the first entry in the vertex list of the critical number @xmath90 . by the construction ( [ eq : tildex^e ] ) of @xmath338 , we have @xmath366 .",
    "hence , by lemma [ thm : lambda ] , the discrete vector field in @xmath338 satisfies @xmath367 consequently by the definition ( [ eq : x ] ) of the poincare section @xmath178 , if @xmath368 then @xmath369 hence the set @xmath338 is given by : @xmath370    now we show that the sequence of sets @xmath338 fulfil their objective , which was to exclude all points @xmath192 whose perturbed orbit is critical in the sense defined above .",
    "[ prop : xe_tilde ] if @xmath340 for some @xmath89 , then the perturbed orbit of @xmath61 is not critical .",
    "suppose that @xmath192 with @xmath149 is critical , i.e. , there exists @xmath334 such that @xmath371 for some @xmath265 .",
    "we will show that @xmath372 . for simplicity",
    ", we assume that @xmath182 and @xmath71 are both non - negative , so that by the orientation of the vector field in the first quadrant : @xmath373    recalling the proof of lemma [ thm : lambda ] , the expression ( [ eq : v_abcd ] ) for the perturbed vector field @xmath30 at the point @xmath374 implies that @xmath375 where the integers @xmath376 are given by ( [ eq : abcd ] ) . by assumption , @xmath377 , which implies that @xmath378 it follows that the difference between the values @xmath22 , @xmath43 and the integers @xmath379 , @xmath71 , respectively , is bounded according to @xmath380 combining this observation with the bounds ( [ eq : bd_ac_sets ] ) on @xmath238 and @xmath239 gives @xmath381 hence @xmath382 and @xmath61 is irregular , so @xmath383 .",
    "the cases where @xmath182 or @xmath71 are negative proceed similarly .",
    "below , in equation ( [ eq : le ] ) of section [ sec : lattice ] , we shall define a sequence of lattices @xmath384 , @xmath89 , independent of @xmath8 up to scaling , such that within the domain @xmath338 , the return map @xmath175 is equivariant under the group of translations generated by @xmath385 .",
    "formally ,    [ thm : phi_equivariance ] for every @xmath89 , and all sufficiently small @xmath8 , the map @xmath175 commutes with translations by the elements of @xmath385 on the domain @xmath338",
    "@xmath386    there is a critical value of @xmath8 , depending on @xmath90 , above which the statement of the theorem is empty , as @xmath338 is insufficiently populated for a pair of points @xmath387 to exist .",
    "we write ( mod @xmath388 ) for some vector @xmath388 to denote congruence modulo the one - dimensional module @xmath389 generated by @xmath388 .",
    "the congruence under the local integrable vector field @xmath390 in equation ( [ eq : phi_equivariance ] ) is necessary for the case that @xmath391 .",
    "furthermore , we define the fraction of symmetric , minimal orbits in @xmath338 @xmath392 and prove the following result on the persistence of such orbits in the limit @xmath275 .",
    "[ thm : minimal_densities ] let @xmath89 , and let @xmath393 be the vertex list of the corresponding polygon class . if @xmath394 or @xmath395 is coprime to @xmath396 for all other vertex types @xmath138 , i.e. , if @xmath397 then , for sufficiently small @xmath8 , the number of symmetric fixed points of @xmath175 in @xmath338 modulo @xmath385 is independent of @xmath8 .",
    "thus the asymptotic density of symmetric fixed points in @xmath338 converges , and its value is given by @xmath398    as in theorem a , the smallness of @xmath8 serves only to ensure that @xmath338 is sufficiently populated for all congruence classes modulo @xmath385 to be represented .",
    "the condition ( [ eq : v1_k_coprimality ] ) on the orbit code is clearly satisfied for infinitely many critical numbers @xmath90 , e.g. , those for which either @xmath399 or @xmath400 is a prime number .",
    "the first violation occurs at @xmath401 ( see figure [ fig : v_table ] ) , where @xmath402 and @xmath403 have a common factor .",
    "we contrast this to the case of @xmath404 , where @xmath403 and @xmath405 have a common factor , but @xmath406 is prime , so the condition ( [ eq : v1_k_coprimality ] ) holds .",
    "numerical experiments show that the density of values of @xmath90 for which ( [ eq : v1_k_coprimality ] ) holds decays very slowly , reaching 1/2 for @xmath407 .",
    "the stated condition on the orbit code is actually stronger than that we require in the proof .",
    "this was done to simplify the formulation of the theorem .",
    "we remark that the weaker condition is still not necessary for the validity of the density expression ( [ eq : density ] ) . at the same time , there are values of @xmath90 for which the density of symmetric minimal orbits deviates from the given formula , and convergence is not guaranteed .",
    "our numerical experiments show that these deviations are small , and do nt seem connected to new dynamical phenomena .",
    "more significant are the fluctuations in the density of non - symmetric orbits .",
    "its dependence on @xmath90 is considerably less predictable than for symmetric orbits , see figure [ fig : density ] .",
    "the asymptotic density of symmetric fixed points in @xmath338 provides an obvious lower bound for the overall density of fixed points , which we denote @xmath408 : @xmath409    [ cor : density ] let @xmath89 satisfy the condition ( [ eq : v1_k_coprimality ] ) of theorem [ thm : minimal_densities ] . then the asymptotic density of fixed points in @xmath338 is bounded below as follows : @xmath410    note that we do not suggest that the density @xmath408 converges as @xmath411 , regardless of whether the condition ( [ eq : v1_k_coprimality ] ) is satisfied or not .",
    "in section [ sec : recurrence ] , we saw that all non - zero points @xmath171 where the discrete vector field @xmath210 deviates from the hamiltonian vector field @xmath211 lie in the set of transition points @xmath214 , defined in ( [ eq : lambda ] ) . in order to study the dynamics at these points ,",
    "where the perturbations from the integrable limit occur , we define a transit map @xmath412 to @xmath214 which we call the * strip map * : @xmath413 where the transit time @xmath414 to @xmath214 is well - defined for all points excluding the origin : @xmath415 ( since the origin plays no role in the present construction , to simplify notation we shall write @xmath25 for @xmath416 in the rest of the paper , where appropriate . ) by abuse of notation , we define @xmath417 to be the transit map to @xmath214 under @xmath418 .",
    "note that @xmath417 is the inverse of @xmath412 only on @xmath214 .",
    "if @xmath419 for some @xmath265 , then lemma [ thm : lambda ] ( page ) implies that @xmath420 satisfies @xmath421 where @xmath93 is the value of the hamiltonian vector field @xmath31 in the box @xmath34 .",
    "if @xmath422 , then we may have @xmath256 , so the expression becomes @xmath423    in the previous section , we identified the set @xmath332 as the set of vertices of the perturbed orbit @xmath277 .",
    "thus , within each quarter - turn , the strip map @xmath412 represents transit to the next vertex . for @xmath424 , where @xmath140 is the length of the vertex list at @xmath61",
    ", we say that the orbit @xmath277 * meets the @xmath139th vertex * at the point @xmath425 . for @xmath192 regular , the polygon @xmath60 and the return orbit @xmath277 are non - critical , by construction , and the number of sides of each is given by equation ( [ eq : numberofsides ] ) .",
    "thus the full set of vertices of @xmath277 is given by @xmath426 recall that the vertices of a polygon ( or orbit ) are numbered in the clockwise direction the orientation of the integrable vector field @xmath31 .",
    "hence the first @xmath141 vertices ( those lying in the first quarter - turn ) are given by @xmath427 .",
    "the action of @xmath23 moves points from one quadrant to the next in the opposing ( anti - clockwise ) direction , so that the vertices @xmath428 are the last @xmath141 vertices .",
    "thus the following proposition is a simple consequence of the number of vertices of a given polygon class .",
    "[ thm : regularity ] let @xmath90 be a critical number , and let @xmath140 be the length of the vertex list of the corresponding polygon class .",
    "then the return map @xmath175 on @xmath338 is related to @xmath412 via @xmath429 where @xmath365 is the type of the first vertex and @xmath390 is the value of the integrable vector field @xmath31 at @xmath61 .",
    "let @xmath430 .",
    "by the preceding discussion , the last vertex in the orbit @xmath277 is given by @xmath431 the point @xmath432 satisfies @xmath433 .",
    "using the expression ( [ eq : psi_congruence2 ] ) for @xmath412 applied to @xmath432 , we have @xmath434 as required .    for @xmath192 regular ,",
    "we use the vertices @xmath435 in the first quarter - turn to define a sequence of natural numbers @xmath436 called the * orbit code * of @xmath61 , which encapsulates how the asymptotic orbit @xmath277 deviates from @xmath60 .",
    "suppose the @xmath139th vertex of @xmath60 is a vertex of type @xmath138 lying on @xmath336 , and the orbit @xmath277 meets its corresponding vertex at @xmath437 .",
    "we define the pair @xmath438 via @xmath439 where @xmath440 , and @xmath441 , which is ( essentially ) the number of lattice points between @xmath437 and the line @xmath336 , is small relative to @xmath442 . using similar arguments to those in the proof of proposition [ prop : xe_tilde ] one can show that @xmath443 satisfies @xmath444 depending whether the integrable vector field is oriented in the positive or negative @xmath108-direction . in both cases , the possible values of @xmath443 form a complete set of residues modulo @xmath396 .",
    "hence the @xmath139th element @xmath445 of the orbit code @xmath436 is defined to be the unique residue @xmath446 which is congruent to @xmath443 : @xmath447 we call @xmath108 the * integer coordinate * of the vertex and @xmath46 the * non - integer coordinate*. similarly , if the @xmath139th vertex lies on @xmath333 , then the @xmath139th element @xmath445 of the orbit code is defined to be the residue congruent to @xmath448 modulo @xmath396 . in this case @xmath46 is the integer coordinate and @xmath108 is the non - integer coordinate .    for all vertices in the first quadrant , the fact that orbits progress clockwise under the action of @xmath247 means that @xmath443 will be non - negative wherever @xmath108 is the integer coordinate , and @xmath448 will be negative wherever @xmath46 is the integer coordinate : @xmath449 thus the value of @xmath445 is given explicitly by @xmath450 respectively .",
    "in addition to the values @xmath451 for @xmath452 we consider @xmath453 , which corresponds to the last vertex _ before _ the symmetry line , i.e. , to the point @xmath454 .",
    "thus the orbit code of @xmath61 is a sequence @xmath455 , such that @xmath456 where the @xmath138 are the vertex types .    in the next proposition",
    "we consider how a perturbed orbit behaves at its vertices .",
    "we find that the regularity of @xmath61 ensures that the discrete vector field @xmath30 matches the hamiltonian vector field @xmath31 in the integer coordinate at @xmath437 .",
    "the possible discrepancy in the non - integer coordinate is determined by the value of @xmath445 .",
    "[ thm : epsilon_j ] let @xmath90 be a critical number and let @xmath140 be the length of the vertex list of the corresponding polygon class . for any @xmath430 and any @xmath457 , let @xmath458 be such that @xmath459 .",
    "then the discrete vector field at the @xmath139th vertex of @xmath277 is given by @xmath460 where @xmath461 is a function of the @xmath139th entry @xmath445 of the orbit code @xmath436 and @xmath462 is the unit vector in the direction of the non - integer coordinate of the vertex .    if @xmath192 is regular , then by proposition [ prop : xe_tilde ] the perturbed orbit @xmath463 is not critical .",
    "thus for any vertex @xmath206 , which , by construction , satisfies @xmath464 for some @xmath265 , we must have either @xmath465 or @xmath466 . for definiteness",
    "we suppose that @xmath467 , so that the vertex @xmath206 lies on @xmath468 .",
    "the cases where @xmath469 or @xmath470 are similar .",
    "now the proof proceeds very much as that of proposition [ prop : xe_tilde ] .",
    "the perturbed vector field @xmath471 , with @xmath472 , is given by equation ( [ eq : vw ] ) , with @xmath236 as in ( [ eq : abcd ] ) .",
    "in this case , @xmath473 implies that @xmath474 and according to ( [ eq : bd_ac_sets ] ) , the remaining integers @xmath238 and @xmath239 satisfy @xmath475 thus we have @xmath476 where @xmath477 is the unit vector in the @xmath46-direction , the non - integer coordinate direction of the vertex .    if @xmath478 , then the coefficient of the difference between @xmath471 and @xmath93 in the @xmath46-direction is given by @xmath479 as in equation ( [ eq:(xj , yj ) ] ) , we write @xmath480 where @xmath443 satisfies the second inequality in ( [ eq : xj<0,yj>0 ] ) .",
    "hence , by ( [ eq : sigma_j_2 ] ) , we have @xmath481 , and the function @xmath482 is given by @xmath483 which completes the proof .",
    "note that the function @xmath461 depends on @xmath139 via @xmath182 . in",
    "what follows we shall write @xmath461 , omitting the argument .",
    "applying proposition [ thm : epsilon_j ] to equation ( [ eq : psi_congruence1 ] ) , we have that if @xmath459 , then the transit between vertices satisfies @xmath484 where @xmath485 is the transit time .",
    "hence we think of an orbit as moving according to the integrable vector field at all points except the vertices , where there is a mismatch between integrable and non - integrable dynamics , and points are given a small ` kick ' in the non - integer coordinate direction .",
    "in this section we prove theorems a and b , stated in section [ sec : maintheorems ] .    for @xmath89 ,",
    "suppose the vertex list @xmath486 contains @xmath487 distinct entries .",
    "we define the sequence @xmath488 such that the @xmath489th entry in the vertex list is the @xmath139th distinct entry .",
    "since all repeated entries are consecutive , it follows that the vertex list has the form @xmath490 with @xmath491 and @xmath492 .",
    "we define the vector @xmath493 as : @xmath494 where the natural number @xmath495 is defined as follows @xmath496 here the least common multiple runs over @xmath497 and all products of the form @xmath498 , where @xmath138 and @xmath499 are consecutive , distinct vertex types .",
    "finally , the lattice @xmath500 of theorem a is given by @xmath501 where @xmath502 denotes the @xmath503-module generated by a set of vectors , and the vector @xmath390 given by ( [ eq : w_mn ] ) is the hamiltonian vector field @xmath31 in the domain @xmath338 ( figure [ fig : lattice_le ] ) .",
    "any @xmath504 which are congruent modulo @xmath385 are related by : @xmath505 where @xmath506 are the coordinates of @xmath507 relative to the module basis .",
    "we note that the vector @xmath508 is parallel to the symmetry line @xmath98 , and hence parallel to the strip @xmath338 , whereas the vector @xmath390 is perpendicular to it .",
    "it follows that both @xmath238 and @xmath239 are determined uniquely by the value of the coefficient @xmath509 , because if @xmath24 , then @xmath510 the point @xmath61 itself corresponds to @xmath511 .",
    "we prove theorems a & b via several lemmata .",
    "the first and most significant step is to show that the orbit codes @xmath436 of points @xmath430 are in one - to - one correspondence with the equivalence classes of @xmath338 modulo @xmath385 .",
    "we do this by constructing a sequence of nested lattices whose congruence classes are the cylinder sets of the orbit code .    we define recursively a finite integer sequence @xmath512 , @xmath513 , as follows : @xmath514 then we let @xmath515 by construction , @xmath516 is also an integer . after defining the associated sequence of vectors @xmath517",
    "we let the lattices @xmath518 be the @xmath503-modules with basis @xmath519 by construction @xmath520    we claim that for all @xmath452 , the closed form expression for @xmath521 is given by @xmath522 where @xmath523 is the number of distinct entries in the list @xmath524 . that the lowest common multiple ( [ eq : q_j_closed_form ] ) runs over all products @xmath498 of consecutive",
    ", distinct vertex types follows from the form ( [ eq : v_iota ] ) of the vertex list and the symmetry ( [ eq : v_symmetry ] ) of the vertex types .",
    "furthermore , since all distinct vertex types occur within the first @xmath140 vertex types , the expression ( [ eq : q_j_closed_form ] ) implies that the sequence @xmath512 is eventually stationary : @xmath525 where @xmath81 and @xmath385 are given by equations ( [ eq : q ] ) and ( [ eq : le ] ) .    for given @xmath90 , the following result details the role of the @xmath518 as cylinder sets of the orbit code . applying the result for @xmath526 , along with the observation ( [ eq : q_j = q ] ) , implies that two points share the same orbit code if and only if they are congruent modulo @xmath385 .",
    "[ thm : sigma_lattices ] let @xmath90 be a critical number , let @xmath140 be the length of the vertex list of the corresponding polygon class , and let @xmath516 and @xmath518 be as above . for any @xmath452 and all @xmath504 , the following three statements are equivalent :    a.   the orbit codes of @xmath61 and @xmath527 match up to the @xmath139th entry , b.   @xmath61 and @xmath527 are congruent modulo @xmath518 , c.   the points @xmath437 and @xmath528 are congruent modulo @xmath529 , where @xmath462 is the unit vector in the direction of the non - integer coordinate of the @xmath139th vertex .",
    "let @xmath530 , let @xmath518 be as above , and let @xmath531 with orbit codes @xmath532 , and @xmath533 , respectively .",
    "we proceed by induction on @xmath139 , with two induction hypotheses .",
    "firstly we suppose that @xmath534 is equivalent to @xmath535 , so that for any @xmath536 : @xmath537 thus any such @xmath527 is related to @xmath61 via @xmath538 for @xmath539 and @xmath540 or @xmath541 , as appropriate .",
    "secondly , we suppose that @xmath535 is equivalent to @xmath542 .",
    "in particular , @xmath543 where @xmath462 is the unit vector in the direction of the non - integer coordinate of that vertex .",
    "we begin with the base case @xmath544 .",
    "suppose that the first vertex of a polygon in class @xmath90 lies on @xmath545 , so that @xmath108 is its integer coordinate ( if @xmath46 is the integer coordinate , then the analysis is identical ) . by symmetry ,",
    "the previous vertex lies on @xmath546 and its integer coordinate is @xmath46 . using the properties of @xmath412 given in equations ( [ eq : psi_congruence2 ] ) and ( [ eq : psi_congruence1 ] ) ,",
    "applied to @xmath547 and @xmath548 respectively , we have @xmath549 furthermore by proposition [ thm : epsilon_j ] : @xmath550 where @xmath551 is the non - integer coordinate vector for the @xmath552th vertex .",
    "thus if @xmath553 , by the definition ( [ eq : sigma_j ] ) of the orbit code , the @xmath46- and @xmath108-components of equations ( [ eq : psi_congruence3 ] ) and ( [ eq : psi_congruence4 ] ) , respectively , give us that the first two entries in the orbit code @xmath436 satisfy @xmath554 it follows that @xmath504 share the partial code @xmath555 if and only if @xmath556 the lattice @xmath557 is given by ( cf .",
    "( [ eq : lattice_j ] ) ) @xmath558 where @xmath559 , @xmath560 and @xmath561 thus @xmath562 and the first hypothesis holds .",
    "now let @xmath504 satisfy ( [ eq : z_tilde ] ) with @xmath544 .",
    "if @xmath563 , where @xmath564 is the transit time to @xmath214 , then the identities @xmath565 with @xmath477 show that @xmath527 has transit time @xmath566 , and therefore @xmath567 , as required ( see figure [ fig : psi_diagram ] ) .",
    "this completes the basis for induction .",
    "now we proceed with the inductive step .",
    "let ( [ eq : h1 ] ) and ( [ eq : h2 ] ) hold for some @xmath569 .",
    "then @xmath61 and @xmath527 are related as in equation ( [ eq : z_tilde ] ) , for some @xmath570 .",
    "we think of @xmath571 , the @xmath572th entry of the orbit code of @xmath527 , as a function of @xmath573 . we suppose that the @xmath139th vertex lies on @xmath336 for some @xmath574 ( again the case in which the vertex lies on @xmath333 is identical ) .",
    "let the pair @xmath438 be defined from @xmath437 via equation ( [ eq:(xj , yj ) ] ) .",
    "similarly , @xmath528 defines the pair @xmath575 .    by ( [ eq : h2 ] ) ,",
    "@xmath528 satisfies @xmath576 where @xmath577 . combining this expression with equation ( [ eq : psi^jp1 ] ) ,",
    "applied to @xmath578 , we obtain @xmath579 where @xmath580 is the transit time of @xmath581 to @xmath214 .      in this case the @xmath139th and @xmath572th vertices lie on parallel lines , which we take to be @xmath336 and @xmath583 , so @xmath584 is given by @xmath585 and similarly for @xmath586 .",
    "according to the definitions ( [ eq : p_j ] ) and ( [ eq : lattice_j ] ) , we have @xmath587 and @xmath588 .",
    "thus , to show that ( [ eq : h1 ] ) continues to hold , we need to show that @xmath589 for all @xmath573 .",
    "similarly we need to show that the vector @xmath590 is equal to the vector @xmath591 of hypothesis ( [ eq : h2 ] ) .",
    "because @xmath108 is the integer coordinate of both @xmath139th and @xmath572th vertices , the transit time is the same for the orbits of @xmath61 and @xmath581",
    ". therefore equations ( [ eq : psi^jp1 ] ) and ( [ eq : psi^jp1tilde ] ) with @xmath592 give us that @xmath593 and the second hypothesis ( [ eq : h2 ] ) remains satisfied . furthermore ,",
    "@xmath586 and @xmath584 have the same integer ( @xmath108 ) coordinate .",
    "it follows that , by the definition ( [ eq : sigma_j ] ) of the orbit code , @xmath594 and ( [ eq : h1 ] ) is also satisfied .    by the @xmath108-component of ( [ eq : psi^jp1tilde ] )",
    ", the value of @xmath595 is determined explicitly by the congruences @xmath596 equation ( [ eq : sigma_j+1_case1 ] ) shows that , if @xmath582 , then there is a map @xmath597 , which is a bijection of a set of congruence classes .",
    "in this case the @xmath139th and @xmath572th vertices lie on perpendicular lines .",
    "we take these to be the lines @xmath336 and @xmath599 , respectively , so that @xmath600 and @xmath584 is given by @xmath601 ( if @xmath46 is the integer co - ordinate , then the analysis is identical . )",
    "we shall demonstrate the form of @xmath602 by identifying those pairs @xmath573 for which @xmath589 .",
    "taking the @xmath46-coordinate of equation ( [ eq : psi^jp1tilde ] ) , and recalling the explicit form ( [ eq : sigma_j_2 ] ) of the orbit code , we see that @xmath571 is determined by @xmath603 we think of this as an integer equation of the form @xmath604 , which has solutions @xmath605 and @xmath606 for some given value of @xmath571 if and only if @xmath607 is sufficiently large and @xmath608 , i.e. , if @xmath8 is sufficiently small and @xmath571 satisfies the congruence @xmath609 to find the lattice @xmath602 , we need to solve this equation in the case @xmath589 .    by assumption ,",
    "the point @xmath61 , given by the module coordinates @xmath511 , corresponds to the solution @xmath610 , @xmath611 , for some transit time @xmath564 .",
    "hence the general solution of ( [ eq : t,2a+b_eqn ] ) is given by @xmath612 for @xmath613 .",
    "the second of these equations implies that @xmath614 must have the same parity as @xmath509 , so we can write @xmath615 , where @xmath616 and @xmath617 for an appropriate choice of sign . substituting this expression into equation ( [ eq : z_tilde ] ) , the points @xmath527 for which",
    "@xmath589 are given by @xmath618 the last equality is justified by the identities @xmath619 where we have used the relationship @xmath620 .",
    "therefore the first hypothesis ( [ eq : h1 ] ) remains satisfied .",
    "substituting the general solution ( [ eq : generalsolution_t ] ) and ( [ eq : generalsolution_2a+b ] ) into equation ( [ eq : psi^jp1tilde ] ) with @xmath577 , and using equation ( [ eq : psi^jp1 ] ) , we find @xmath621 where @xmath622 .",
    "thus the points where these @xmath527 meet the @xmath572th vertex share the same integer coordinate .",
    "so hypothesis ( [ eq : h2 ] ) also remains satisfied , completing the induction .",
    "[ thm : sigma_lattice ] let @xmath90 be a critical number , let @xmath140 be the length of the vertex list of the corresponding polygon class , and let @xmath139 be in the range @xmath452 .",
    "then two points @xmath61 and @xmath527 in @xmath338 have the same orbit code if and only if the points @xmath437 and @xmath528 are congruent modulo @xmath623 , where @xmath462 is the unit vector in the direction of the non - integer coordinate of the @xmath139th vertex .",
    "recall that for all @xmath536 : @xmath624 thus any two points which are congruent modulo @xmath385 are also congruent modulo @xmath518 .",
    "in particular , if @xmath625 then by the hypothesis ( [ eq : h2 ] ) of lemma [ thm : sigma_lattices ] we have : @xmath626 as required .",
    "lemma [ thm : sigma_lattices ] shows the equivalence between orbit codes and congruence classes of @xmath385 . to complete the proof of theorem a",
    ", we show that the orbit code @xmath436 determines uniquely the behaviour of @xmath61 under the return map @xmath175 .",
    "consider two points @xmath627 for some @xmath628 given by @xmath629 these two points have the same orbit code and reach the @xmath630th vertex at the points @xmath631 , which , by corollary [ thm : sigma_lattice ] , are congruent modulo @xmath632 , where @xmath462 is the unit vector in the non - integer direction .",
    "in particular , @xmath633 and @xmath634 are related via @xmath635 where we have replaced @xmath636 by @xmath365 using the symmetry ( [ eq : v_symmetry ] ) of the vertex types .",
    "we will show that the points where they reach the last vertex are related by a similar equation : @xmath637 where the unit vector @xmath638 , the non - integer direction of the last vertex , is perpendicular to @xmath462 .",
    "the last vertex of the return orbit @xmath277 lies in the set @xmath639 , so must be close to the image under @xmath23 of the @xmath630th vertex ( see figure [ fig : phi_psi ] ) .",
    "if the @xmath630th vertex lies on the line @xmath640 , it is a simple exercise to show that these two points are in fact equal , i.e. , that @xmath641 for any @xmath340 . we consider the less obvious case in which the @xmath630th vertex lies on the line @xmath642 and the non - integer direction is @xmath477 . by the orientation of the vector field in the fourth quadrant",
    ", the orbit of the point @xmath61 reaches this vertex at the point @xmath633 given by : @xmath643 where @xmath644 and @xmath645 .      applying @xmath23 to ( [ eq : vertex_2k-1 ] ) and substituting the expression ( [ eq : psi_2k-1 ] ) ,",
    "we get : @xmath646 where the non - integer direction of the last vertex is @xmath647 . by equation ( [ eq : xj<0,yj>0 ] ) ,",
    "if the first component of this point satisfies @xmath648 then the point is the last vertex on @xmath546 that we seek for all @xmath573 : @xmath649 if the above inequality is not satisfied , then it must be the upper bound that fails ; since @xmath365 is non - negative , @xmath650 satisfies @xmath645 , and the absolute value of the two ceiling functions differ by at most one , the lower bound must hold . in this case",
    "@xmath651 , and we apply @xmath297 to find : @xmath652 where the error term @xmath653 is independent of @xmath573 by proposition [ thm : epsilon_j ] . in both cases ( [ eq : phi_equivariance_case1 ] ) and ( [ eq : phi_equivariance_case2 ] ) the relationship ( [ eq : vertex_8k-5 ] ) follows .    using ( [ eq : vertex_8k-5 ] ) , the property ( [ eq : psi_congruence1 ] ) of @xmath412 , and the expression ( [ eq : phi_psi ] ) for @xmath175 , we obtain @xmath654 where we have also used the fact that @xmath655 , @xmath656 , and that @xmath657 is odd .",
    "this completes the proof of theorem a.    the set @xmath658 of possible orbit codes is a subset of the product space @xmath659 denoting by @xmath660 the scaled co - volume of @xmath385 , namely @xmath661 the total number of possible orbit codes is given by @xmath662 we note that although the lattice @xmath385 is independent of @xmath8 ( up to scaling ) , @xmath658 is not .    in the next lemma",
    ", we identify the orbit codes which correspond to symmetric fixed points of @xmath175 .",
    "subsequently , in lemmas [ thm : sigma_j_i ] and [ thm : sigma_j_ii ] , we identify values of @xmath90 for which the number of codes which satisfy the conditions of lemma [ thm : minimal_codes ] is independent of @xmath8 .",
    "the proof of theorem b will then follow .",
    "[ thm : minimal_codes ] for any @xmath89 with vertex list @xmath393 , @xmath430 and sufficiently small @xmath8 , the point @xmath61 is a symmetric fixed point of @xmath175 if and only if its orbit code @xmath455 satisfies :      it is a standard property of any reversible map @xmath7 , with @xmath665 , that it can be written as the composition of two involutions : @xmath666 it follows that every symmetric periodic orbit of @xmath7 intersects the union of the fixed spaces of these involutions , @xmath667 , at exactly two points ( which coincide for period 1 ) @xcite .",
    "furthermore these two points are maximally separated in time , in the sense that if the minimal period of the orbit is @xmath614 , then the transit time from one to the other is approximately @xmath668 .",
    "more precisely , if @xmath614 is even , the orbit must intersect one of the following sets : @xmath669 whereas if @xmath614 is odd , the orbit must intersect the set @xmath670    for our map @xmath23 , we have already introduced the involution @xmath154 and its fixed space , considered now as a subset of the rescaled lattice @xmath25 : @xmath671 a simple calculation shows that the involution @xmath672 and its fixed space are given by : @xmath673    take @xmath89 and a point @xmath340 .",
    "suppose that @xmath61 is a symmetric fixed point of @xmath175 .",
    "if @xmath61 is non - zero , the orbit of @xmath61 intersects the set @xmath667 at exactly two points , and as @xmath61 is a fixed point of @xmath175 , these two points must occur within a single revolution .",
    "hence we have : @xmath674    we begin by considering which points in the return orbit @xmath277 can lie in @xmath98 .",
    "since the domain @xmath338 lies in an @xmath158-neighbourhood of the positive half of the symmetry line @xmath98 , we may have : @xmath675 equally , the orbit may intersect the negative half of the symmetry line , which occurs if : @xmath676    points in @xmath677 lie on disjoint vertical line segments of length one , in an @xmath158-neighbourhood of the @xmath108-axis . recall that the polygon @xmath60 intersects the axes at vertices of type @xmath678 , and hence intersects the @xmath108-axis in the boxes : @xmath679 if @xmath680 is even , it follows that the relevant segment @xmath681 of @xmath677 is given by : @xmath682 which lies in the positive half - plane .",
    "similarly if @xmath680 is odd , the relevant segment @xmath683 of @xmath677 is given by : @xmath684 which lies in the negative half - plane .",
    "hence we see that the return orbit of @xmath61 can not intersect @xmath677 twice in a single revolution , and intersects @xmath98 twice if and only if : @xmath685 by ( [ eq : s_even ] ) , the latter implies that @xmath61 is periodic with period 4 , and we have already observed that there are no points with minimal period 4 .",
    "thus the only non - trivial possibility for a symmetric fixed point occurs when the return orbit of @xmath61 intersects both @xmath98 and @xmath677 .",
    "conversely , equation ( [ eq : s_odd ] ) ensures that this is also a sufficient condition .      if @xmath24 , then the property @xmath663 is satisfied if and only if : @xmath686 if @xmath687 then clearly @xmath688 .",
    "the width of the strip @xmath338 , given by ( [ eq : tildex^eii ] ) , ensures that the only other possibility is @xmath689 , in which case : @xmath690 this corresponds to @xmath691 . + _ ( ii ) @xmath277 intersects @xmath677 if and only if @xmath664 .",
    "_    instead of considering the sets @xmath681 and @xmath683 directly , we consider their images under @xmath154 and @xmath23 , respectively , which lie in a neighbourhood of the @xmath46-axis : @xmath692 in ( [ eq : f(fixh ) ] ) , we assume that @xmath693 , so that @xmath694 for all @xmath695 .",
    "the orbit @xmath277 intersects @xmath677 if and only if it intersects the relevant one of these sets , according to the parity of @xmath680 .",
    "the polygon @xmath60 intersects the @xmath46-axis at the @xmath140th vertex , where @xmath140 is the length of the vertex list @xmath696 . the return orbit @xmath277 reaches the @xmath140th vertex at the point @xmath697 , given in the notation of ( [ eq:(xj , yj ) ] ) by @xmath698 where , by ( [ eq : sigma_j_2 ] )",
    ", @xmath699 is non - negative .",
    "hence if @xmath680 is even , @xmath277 intersects @xmath677 if and only if : @xmath700 if @xmath680 is odd , then @xmath277 intersects @xmath677 if and only if : @xmath701 the congruence @xmath702 covers both of these cases , which completes the proof .    for all @xmath89 and sufficiently small @xmath8 , the set @xmath338 see equation ( [ eq :",
    "tildex^eii]) is non - empty and contains at least one element from every congruence class modulo @xmath385 .",
    "we now seek to identify the number of congruence classes whose orbit code satisfies the conditions of lemma [ thm : minimal_codes ] .    as discussed in the proof of lemma [ thm : minimal_codes ] , the points @xmath368 whose orbit code @xmath703 satisfies @xmath704 are precisely those satisfying @xmath705 all such points lie on one of two lines , parallel to the first generator @xmath508 of the lattice @xmath385 .",
    "furthermore all points on one line are congruent to those on the other , as they are connected by the second generator @xmath706 .",
    "hence the number of points satisfying this condition modulo @xmath385 is @xmath707 where we have used the expression ( [ eq : theta_e ] ) for @xmath660 .",
    "it remains to determine what fraction of the orbit codes with @xmath704 satisfy the second condition of lemma [ thm : minimal_codes ] .",
    "we do this by identifying values of @xmath90 for which all possible values of @xmath708 occur with equal frequency , independently of @xmath8 .",
    "clearly if @xmath709 , i.e. , if a polygon class has just one vertex in the first octant ( @xmath710  a square ) , then the points @xmath368 with @xmath711 satisfy @xmath712 for any given @xmath713 .",
    "such points form a fraction @xmath714 of all points modulo @xmath385 .",
    "hence all possible values of @xmath708 occur with equal frequency modulo @xmath385",
    ". more generally if @xmath715 , i.e. , if all vertices of the polygon class have the same type ( @xmath716 ) , then the same applies .",
    "this follows from the fact that , for any congruence class of @xmath385 , the map @xmath717 is a permutation of the set @xmath718 whenever @xmath582 , as we saw in case 1 of the proof of lemma [ thm : sigma_lattices ] .",
    "[ thm : sigma_j_i ] let @xmath89 .",
    "suppose that the vertex list @xmath719 of the associated polygon class has at least two distinct entries and satisfies @xmath720 where @xmath721 is the sequence of distinct vertex types defined in ( [ eq : v_iota ] ) .",
    "then for every @xmath340 , all @xmath722 , all @xmath723 , and all sufficiently small @xmath8 , the number of points in the set @xmath724 whose orbit code has @xmath140th entry @xmath725 is @xmath726    pick @xmath89 such that the coprimality condition ( [ eq : coprimality_i ] ) holds .",
    "let @xmath340 have orbit code @xmath703 and let the pair @xmath438 be defined as in equation ( [ eq:(xj , yj ) ] ) , where @xmath722 .",
    "we have to show that all possible values of @xmath708 occur with equal frequency among points in @xmath727 modulo @xmath385 .",
    "it suffices to prove that the expression ( [ eq : lj_sigma_star ] ) holds for @xmath728 , since all cylinder sets of @xmath518 with index @xmath729 can be written as a union of cylinder sets of @xmath730 .",
    "we let @xmath731 , so that @xmath732 and consider the congruence class of @xmath61 modulo @xmath518 . since @xmath733 is a cylinder set in the sense of lemma [ thm : sigma_lattices ] , the orbit codes of all points @xmath734 match up to the @xmath139th entry @xmath445 . let the @xmath572th entry of the orbit code of such a @xmath527 be @xmath571 .",
    "we wish to show that all possible values of @xmath571 occur with equal frequency .    by construction @xmath598 , so the possible values of @xmath571 are determined by case 2 of the proof of lemma [ thm : sigma_lattices ] .",
    "in the course of the proof , we saw that the occurrence of points @xmath527 with some fixed value of @xmath571 correspond to solutions of an integer equation , given in the case where @xmath108 is the non - integer coordinate of the @xmath139th vertex by equation ( [ eq : t,2a+b_eqn ] ) .",
    "( a similar equation holds when @xmath46 is the non - integer coordinate . )",
    "each solution @xmath735 determines the module coordinates @xmath573 of @xmath507 in @xmath518 and the transit time @xmath736 of @xmath527 from the @xmath139th vertex to the @xmath572th .",
    "solutions of ( [ eq : t,2a+b_eqn ] ) occur for all values of @xmath571 satisfying the congruence ( [ eq : sigma_j+1_case2 ] ) , and the condition that @xmath8 be sufficiently small ensures that at least one such solution is realised by a point @xmath737 . by construction , each distinct value of @xmath571 which has a solution defines a unique point in @xmath727 modulo @xmath602 , which is isomorphic to the module @xmath738 .",
    "however due to the coprimality condition ( [ eq : coprimality_i ] ) , the modulus of the congruence ( [ eq : sigma_j+1_case2 ] ) is unity .",
    "hence solutions occur for all possible values of @xmath739 , and each corresponds to a unique congruence class of @xmath727 modulo @xmath602 .",
    "furthermore , by ( [ eq : q_j = q ] ) , the lattices @xmath602 and @xmath385 are equal , hence all possible values of @xmath571 occur with equal frequency in @xmath727 modulo @xmath385 .    if @xmath740 then this completes the proof .",
    "if @xmath741 , take @xmath523 in the range @xmath742 . by the definition of @xmath743 as the index of the last distinct vertex type , we have @xmath744 . as discussed above , the map @xmath745 is a permutation of the set @xmath746 whenever @xmath747 .",
    "hence the equal frequency of the possible values of @xmath748 implies that of @xmath749 and the result follows .    in the previous section ( equation ( [ eq : sigma_j ] ) )",
    ", we defined the @xmath139th entry @xmath445 of the orbit code via the congruence @xmath750 , where @xmath108 is the integer coordinate of the relevant vertex , and the pair @xmath438 is defined by equation ( [ eq:(xj , yj ) ] ) .",
    "similarly , we define the sequence @xmath751 such that its @xmath139th entry @xmath752 satisfies : @xmath753 where @xmath46 is the non - integer coordinate of the vertex .",
    "it follows from corollary [ thm : sigma_lattice ] that , for any @xmath452 , and any two points @xmath754 : @xmath755    in the following lemma , we use @xmath751 to identify polygon classes where , among points with @xmath663 and for each @xmath139 in @xmath452 , all possible values of @xmath756 occur with equal frequency modulo @xmath385 , independently of @xmath8 .",
    "[ thm : sigma_j_ii ] let @xmath89 and suppose that the vertex list @xmath719 of the associated polygon class is such that @xmath394 is coprime to @xmath396 for all other vertex types @xmath138 : @xmath757 then for sufficiently small @xmath8 , for all @xmath139 in @xmath452 , and all @xmath758 , the number @xmath759 of points @xmath430 modulo @xmath385 whose orbit code @xmath532 has @xmath704 and @xmath760 is given by : @xmath761    we use induction on @xmath139 . consider points @xmath61 whose orbit code satisfies @xmath663 and has @xmath139th value @xmath445 , for some arbitrary @xmath756 and @xmath762 .",
    "let the sequence @xmath751 be denoted @xmath763 .",
    "our induction hypotheses are that : + ( i ) equation ( [ eq : n_j ] ) holds , where the coprimality condition ( [ eq : v1_coprimality ] ) ensures that @xmath759 is a natural number ; + ( ii ) for each residue",
    "@xmath764 modulo @xmath759 , there is a unique @xmath61 modulo @xmath385 satisfying @xmath765    the base case is @xmath544 .",
    "the points @xmath368 with @xmath663 for some fixed value of @xmath766 satisfy : @xmath767 such points are congruent modulo @xmath768 , hence the number of such points modulo @xmath385 is @xmath769 by lemma [ thm : sigma_lattices ] , if @xmath61 is one such point , then any other point @xmath527 reaches the first vertex at @xmath770 for some @xmath613 , where @xmath560 and @xmath462 is the unit vector in the non - integer coordinate direction . then by the construction of @xmath751 ,",
    "if @xmath771 , the value of @xmath772 is related to @xmath773 by @xmath774 by corollary [ thm : sigma_lattice ] , @xmath61 and @xmath527 are congruent modulo @xmath385 if and only if @xmath775 .",
    "thus the @xmath776 distinct points modulo @xmath385 correspond to distinct values of @xmath614 modulo @xmath776 . furthermore ,",
    "if we consider the value of @xmath772 modulo @xmath776 , we have : @xmath777 now @xmath394 is coprime to the modulus , as by the coprimality condition ( [ eq : v1_coprimality ] ) and the construction ( [ eq : q ] ) of @xmath81 , two is the highest power of @xmath778 that divides @xmath81 .",
    "it follows that each distinct value of @xmath772 is distinct modulo @xmath776 .",
    "this completes the base case .    to proceed with the inductive step ,",
    "we suppose that the above hypotheses hold for some @xmath779 . in the proof of lemma [ thm : sigma_lattices ] we used equation ( [ eq : psi^jp1 ] ) to describe the behaviour of points as they move from one vertex to the next in two cases",
    "the first case occurs when @xmath780 , so that the @xmath139th and @xmath572th vertices lie on parallel lines , and @xmath781 . in this case",
    ", the value of @xmath782 is determined uniquely by the value of @xmath445 .",
    "in particular , we saw that if the @xmath139th vertex lies on @xmath336 and the @xmath572th vertex lies on @xmath583 , then @xmath782 and @xmath445 are related by equation ( [ eq : sigma_j+1_case1 ] ) .",
    "we can use the same methods , considering this time the non - integer component of equation ( [ eq : psi^jp1 ] ) , to show that @xmath783 is determined by the pair @xmath784 via : @xmath785 where @xmath482 , and @xmath786 is the transit time between vertices .",
    "the one - to - one relationship between @xmath445 and @xmath782 , ensures that there are @xmath787 points with @xmath663 that achieve any given value of @xmath782 at the @xmath572th vertex .",
    "then for any given value of @xmath445 , which uniquely determines @xmath782 , the above congruence establishes a one - to - one relationship between @xmath752 and @xmath783 modulo @xmath788 .",
    "because this bijection is a translation , it also holds modulo @xmath759 . in other words",
    ", there is a skew - product map of residue classes modulo @xmath759 : @xmath789 .",
    "this completes the inductive step for the first case .    in the second case , where @xmath790 , the @xmath139th and @xmath572th vertices lie on perpendicular lines . again referring to the proof of lemma [ thm : sigma_lattices ]",
    ", taking equation ( [ eq : t,2a+b_eqn ] ) modulo @xmath791 gives the following expression for @xmath782 in terms of the pair @xmath784 : @xmath792 here we were able to replace @xmath448 with @xmath752 as , by the construction ( [ eq : q ] ) of @xmath81 , @xmath791 is a divisor of the modulus @xmath793 which defines @xmath752 .",
    "if the coprimality condition ( [ eq : v1_coprimality ] ) holds , then @xmath791 also divides @xmath759 .",
    "hence for any given pair @xmath794 , there are @xmath795 values of @xmath752 modulo @xmath759 for which the following congruence is satisfied : @xmath796 where @xmath613 .",
    "the total number of points with any given value of @xmath782 is thus : @xmath797 which completes the inductive step for hypothesis ( i ) .    taking the second component of equation ( [ eq : psi^jp1 ] )",
    "modulo @xmath798 gives an expression for @xmath783 in terms of the pair @xmath784 : @xmath799 where @xmath800 .",
    "for a given pair @xmath794 , @xmath414 is given by equation ( [ eq : t,2a+b_eqn ] ) .",
    "hence taking equation ( [ eq : t,2a+b_eqn ] ) modulo @xmath759 , a multiple of @xmath791 , and using the expression ( [ eq : gamma_j_ii ] ) for @xmath752 , it follows that the values of @xmath414 satisfy @xmath801 where @xmath613 .",
    "thus @xmath414 takes all values modulo @xmath802 . in turn , equation ( [ eq : gamma_jp1 ] ) implies that @xmath783 takes all values satisfying : @xmath803 applying this argument for all values @xmath756 , we get a complete residue class modulo @xmath798 as required .",
    "this completes the inductive step for hypothesis ( ii ) .        for @xmath716",
    "all elements of the vertex list are the same .",
    "this case is dealt with by the discussion preceding lemma [ thm : sigma_j_i ] .",
    "thus we assume that the vertex list contains at least two distinct elements .",
    "suppose first that @xmath394 is coprime to @xmath396 for all @xmath807 .",
    "then for sufficiently small @xmath8 , lemma [ thm : sigma_j_ii ] states that the number @xmath808 of points in @xmath809 modulo @xmath385 whose orbit code has @xmath140th entry @xmath725 is given by equation ( [ eq : n_j ] ) , with @xmath810 .",
    "furthermore , since all points @xmath340 whose orbit code @xmath532 satisfies @xmath663 are congruent to some point in @xmath809 , it follows that @xmath808 is the number of points in @xmath338 modulo @xmath385 satisfying the conditions @xmath534 and @xmath535 of lemma [ thm : minimal_codes ] .",
    "therefore the number of symmetric fixed points of @xmath175 in @xmath338 modulo @xmath385 is independent of @xmath8 and given by @xmath808 .",
    "similarly if @xmath395 is coprime to @xmath396 for all @xmath811 , then @xmath395 is coprime to @xmath812 , given in closed form by ( [ eq : q_j_closed_form ] ) .",
    "if follows that the condition ( [ eq : coprimality_i ] ) of lemma [ thm : sigma_j_i ] holds , since the recursive expression ( [ eq : q_j ] ) for @xmath813 gives us that : @xmath814 applying lemma [ thm : sigma_j_i ] for @xmath544 , we have that for every cylinder set of @xmath557 , the number of points modulo @xmath385 in the cylinder set whose orbit code has @xmath140th entry @xmath725 is given by @xmath815 there are @xmath394 cylinder sets of @xmath557 whose associated orbit code satisfies @xmath663 . hence , as before , the number of points in @xmath338 modulo @xmath385 satisfying the conditions @xmath534 and @xmath535 of lemma [ thm : minimal_codes ] is @xmath816 and the number of symmetric fixed points of @xmath175 in @xmath338 modulo @xmath385 follows .",
    "this completes the proof of the first statement .",
    "we have shown that for sufficiently small @xmath8 , and if ( [ eq : v1_k_coprimality ] ) holds , then the fraction of symmetric fixed points of @xmath175 in each fundamental domain of @xmath385 is @xmath817 where we have used equations ( [ eq : v1 ] ) and ( [ eq : vk ] ) , respectively .",
    "it remains to show that the density @xmath818 of symmetric fixed points in @xmath338 converges to this fraction as @xmath275 .    by equation ( [ eq : tildex^eii ] ) ,",
    "the domain @xmath338 is a subset of the lattice @xmath25 , bounded by a rectangle lying parallel to the symmetry line @xmath98 .",
    "similarly , a fundamental domain of the lattice @xmath385 is constructed by taking the points bounded by the parallelogram @xmath819 , given by @xmath820 where the generator @xmath508 is also parallel to the symmetry line .",
    "these parallelograms tile the plane by translation : @xmath821 .",
    "the width of @xmath338 ( taken in the direction perpendicular to @xmath98 ) is exactly twice that of @xmath819 , independently of @xmath8 , as shown in figure [ fig : lattice_le ] .",
    "the number of parallelograms which fit lengthwise into @xmath338 , however , goes to infinity as @xmath8 goes to zero .",
    "in particular , the number of parallelograms which can be contained in the interior of the rectangle bounding @xmath338 is given by @xmath822 where @xmath823 is the number of times that the vector @xmath508 fits lengthways into the rectangle , and we subtract @xmath824 for the parallelograms which intersect the boundary .",
    "each of these parallelograms contains a complete fundamental domain of @xmath385 , and their contribution to @xmath818 dominates in the limit @xmath275 .",
    "r. devogelaere , on the structure of periodic solutions of conservative systems , with applications , in _ contribution to the theory of nonlinear oscillations _ , vol iv , s. lefschets , ed . , princeton univ . press , princeton , nj ( 1958 ) , p.53 ."
  ],
  "abstract_text": [
    "<S> we consider a one - parameter family of invertible maps of a two - dimensional lattice , obtained by discretising the space of planar rotations . </S>",
    "<S> we let the angle of rotation approach @xmath0 , and show that the limit of vanishing discretisation is described by an integrable piecewise - smooth hamiltonian flow , whereby the plane foliates into families of invariant polygons with an increasing number of sides . </S>",
    "<S> considered as perturbations of the flow , the lattice maps assume a different character , described in terms of strip maps , a variant of those found in outer billiards of polygons . </S>",
    "<S> the perturbation introduces phenomena reminiscent of the kolmogorov - arnold - moser scenario : a positive fraction of the unperturbed curves survives . we prove this for symmetric orbits , under a condition that allows us to obtain explicit values for their density , the latter being a rational number typically less than 1 . </S>",
    "<S> this result allows us to conclude that the infimum of the density of all surviving curves symmetric or not is bounded away from zero . </S>"
  ]
}