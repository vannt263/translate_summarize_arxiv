{
  "article_text": [
    "one of the intriguing problems in the paradigm of adaptive nonparametric function estimation as developed in the last two decades is what one could call the `` _ _ hiatus _ _ '' between estimation and inference , or , to be more precise , between the existence of adaptive risk bounds and the nonexistence of adaptive confidence statements . in a nutshell",
    "the typical situation in nonparametric statistics could be described as follows : one is interested in a functional parameter @xmath0 that could belong either to @xmath5 or to @xmath6 , two sets that can be distinguished by a certain `` structural property , '' such as smoothness , with the possibility that @xmath7 .",
    "based on a sample whose distribution depends on @xmath0 , one aims to find a statistical procedure that adapts to the unknown structural property , that is , that performs optimally without having to know whether @xmath8 or @xmath9 .",
    "now while such procedures can often be proved to exist , the statistician can not take advantage of this optimality for inference : to cite robins and van der vaart @xcite , `` an adaptive estimator can adapt to an underlying model , but does not reveal which model it adapts to , with the consequence that nonparametric confidence sets are necessarily much larger than the actual discrepancy between an adaptive estimator and the true parameter . ''",
    "we argue in this article that adaptive inference is possible if the structural property that defines @xmath5 and @xmath6 is statistically identifiable , by which we shall mean here that the nonparametric hypotheses @xmath10 and @xmath11 are asymptotically consistently distinguishable ( in the sense of ingster @xcite ) . in common adaptation problems this will necessitate that certain unidentified parts of the parameter space be removed , in other words , that the alternative hypothesis @xmath12 be restricted to a subset @xmath13 of @xmath14 .",
    "one is in turn interested in choosing @xmath15 as large as possible , which amounts to imposing minimal identifiability conditions on the parameter space .",
    "we shall make these ideas rigorous in one key example of adaptive inference : confidence bands for nonparametric density functions @xmath0 that adapt to the unknown smoothness of @xmath0 . the general approach , however , is not specific to this example as we shall argue at the end of this introduction , and the heuristic mentioned above is valid more generally .",
    "the interest in the example of confidence bands comes partly from the fact that the discrepancy between estimation and inference in this case is particularly pronounced .",
    "let us highlight the basic problem in a simple `` toy adaptation '' problem .",
    "consider @xmath16 independent and identically distributed random variables taking values in @xmath2 $ ] with common probability density function @xmath0 and joint law @xmath17 .",
    "we are interested in the existence of confidence bands for @xmath0 that are adaptive over two nested balls in the classical hlder spaces @xmath18 ) \\subset\\mathcal c^r([0,1])$ ] , @xmath19 , of smooth functions with norm given by ; see definition [ besov ] below .",
    "define the class of densities @xmath20 \\to[0,\\infty ) , \\int_0 ^ 1 f(x)\\,dx=1 , \\|f\\|_{s,\\infty } \\le b \\biggr\\}\\hspace*{-22pt}\\ ] ] and note that @xmath21 for @xmath22 .",
    "we shall assume throughout that @xmath23 to ensure that @xmath4 is nonempty .",
    "a confidence band @xmath24 is a family of random intervals @xmath25\\}_{y \\in[0,1]}\\ ] ] that contains graphs of densities @xmath26 \\to[0 , \\infty)$ ] .",
    "we denote by @xmath27}}|c'_n(y)-c_n(y)|$ ] the maximal diameter of @xmath28 .",
    "following li @xcite the band @xmath28 is called asymptotically _",
    "honest _ with level @xmath29 for a family of probability densities @xmath30 if it satisfies the asymptotic coverage inequality @xmath31 \\bigr ) \\ge1- \\alpha.\\ ] ] we shall usually only write @xmath32 for the coverage probability if no confusion may arise .",
    "note that @xmath30 may ( and later typically will have to ) depend on the sample size @xmath33 .",
    "suppose the goal is to find a confidence band that is honest for the class @xmath34 and that is simultaneously _ adaptive _ in the sense that the expected diameter @xmath35 of @xmath28 satisfies , for every @xmath33 ( large enough ) , @xmath36 where @xmath37 is a finite constant independent of @xmath33 and where @xmath38 indeed even if @xmath39 were known no band could have expected diameter of smaller order than @xmath40 uniformly over @xmath4 ( e.g. , proposition [ nob ] below ) , so that we are looking for a band that is asymptotically honest for @xmath41 and that shrinks at the fastest possible rate over @xmath4 and @xmath42 simultaneously .",
    "it follows from theorem  2 in low @xcite ( see also @xcite ) that such bands do not exist .",
    "[ low ] any confidence band @xmath28 that is honest over @xmath41 with level @xmath43 necessarily satisfies @xmath44    the puzzling fact is that this is in stark contrast to the situation in estimation : adaptive estimators @xmath45 such as those based on lepski s method @xcite or wavelet thresholding @xcite can be shown to satisfy simultaneously @xmath46 see @xcite and theorem [ supad ] below . so while @xmath45 adapts to the unknown smoothness @xmath39 , theorem [ low ]",
    "reflects the fact that knowledge of the smoothness is still not accessible for the statistician .",
    "should we therefore abstain from using adaptive estimators such as @xmath45 for inference ?",
    "gin and nickl @xcite recently suggested a new approach to this problem , partly inspired by picard and tribouley @xcite .",
    "in @xcite it was shown that one can construct confidence bands @xmath28 and subsets @xmath47 , defined by a concrete analytical condition that involves the constant @xmath48 , such that @xmath28 is asymptotically honest for @xmath49 for every fixed @xmath48 , and such that @xmath28 is adaptive in the sense of ( [ adapt0 ] ) . moreover ,",
    "these subsets were shown to be topologically generic in the sense that the set @xmath50 that was removed is _ nowhere dense _ in the hlder norm topology of @xmath51 ( in fact in the relevant trace topology on densities ) .",
    "this says that the functions @xmath52 that prevent adaptation in theorem [ low ] are in a certain sense negligible .    in this article we shall give a more statistical interpretation of when , and if , why , adaptive inference is possible over certain subsets of hlder classes",
    "our approach will also shed new light on why adaptation is possible over the sets @xmath53 .",
    "define , for @xmath19 , the following class : @xmath54 where @xmath55 is a sequence of nonnegative real numbers . clearly @xmath56 , but if @xmath57 , then we are removing those elements from @xmath42 that are not separated away from @xmath58 in sup - norm distance by at least @xmath55 .",
    "inspection of the proof of theorem [ 2class ] shows that the set removed from @xmath59 is nonempty as soon as @xmath57 .",
    "similar to above we are interested in finding a confidence band that is honest over the class @xmath60 and that is _ adaptive _ in the sense of ( [ adapt0 ] ) , in fact only in the sense that @xmath61 for every @xmath33 ( large enough ) .",
    "we know from low s results that this is impossible if @xmath62 , but the question arises as to whether this changes if @xmath57 , and if so , what the smallest admissible choice for @xmath55 is .    it was already noted or implicitly used in @xcite that there is a generic connection between adaptive confidence sets and minimax distinguishability of certain nonparametric hypotheses . in our setting consider , for instance ,",
    "testing the hypothesis @xmath63 as we shall see in the proof of theorem [ 2class ] below , an adaptive confidence band over @xmath64 can be used to test any such hypothesis consistently , and intuitively speaking an adaptive confidence band should thus only exist if @xmath55 is of larger order than the minimax rate of testing between @xmath65 and @xmath12 in the sense of ingster @xcite ; see also the monograph @xcite . for confidence bands",
    "a natural separation metric is the supremum - norm ( see , however , also the discussion in the last paragraph of the ) , and an exploration of the corresponding testing problems gives our main result , which confirms this intuition and shows moreover that this lower bound is sharp up to constants at least in the case where @xmath66 is known .",
    "[ 2class ] let @xmath67 .",
    "an adaptive and honest confidence band over @xmath68 exists if and only if @xmath55 is greater than or equal to the minimax rate of testing between @xmath69 and @xmath70 , and this rate equals @xmath71 .",
    "more precisely :    suppose that @xmath28 is a confidence band that is asymptotically honest with level @xmath72 , over @xmath73 and that is adaptive in the sense of ( [ adapt ] ) .",
    "then necessarily @xmath74    suppose @xmath75 and @xmath76 are given .",
    "then there exists a sequence @xmath55 satisfying @xmath77 and a confidence band @xmath78 that is asymptotically honest with level @xmath29 and adaptive over @xmath79 in the sense of ( [ adapt ] ) .    claims and still hold true if @xmath4 is replaced by the set @xmath80 for any @xmath81 .",
    "the last claim shows that the situation does not change if one removes similar subsets from the smaller hlder ball @xmath4 , in particular removing the standard null - hypothesis @xmath82 used in the nonparametric testing literature , or other very smooth densities , can not improve the lower bound for @xmath55 .",
    "part ( b ) of theorem [ 2class ] implies the following somewhat curious corollary : since any @xmath83 satisfies @xmath84 ( note that @xmath4 is -compact ) , we conclude that @xmath85 for every @xmath86 , @xmath87 large enough .",
    "we thus have :    [ dishon ] there exists a `` dishonest '' adaptive confidence band @xmath88 that has asymptotic coverage for every fixed @xmath52 ; that is , @xmath28 satisfies @xmath89 and @xmath90    a comparison to theorem [ low ] highlights the subtle difference between the minimax paradigm and asymptotic results that hold pointwise in @xmath0 : if one relaxes `` honesty , '' that is , if one removes the infimum in ( [ hon ] ) , then low s impossibility result completely disappears .",
    "note , however , that the index @xmath33 from which onwards coverage holds in corollary [ dishon ] depends on @xmath0 , so that the asymptotic result can not be confidently used for inference at a fixed sample size .",
    "this is a reflection of the often neglected fact that asymptotic results that are pointwise in @xmath0 have to be used with care for statistical inference ; see @xcite for related situations of this kind .",
    "in contrast to the possibly misleading conclusion of corollary [ dishon ] , theorem [ 2class ] characterizes the boundaries of `` honest '' adaptive inference , and several questions arise .    what is the relationship between the sets @xmath91 from theorem [ 2class ] and the classes",
    "@xmath92 considered in @xcite ?",
    "moreover , is there a `` bayesian '' interpretation of the exceptional sets that complements the topological one ?",
    "the typical adaptation problem is not one over two classes , but over a scale of classes indexed by a possibly continuous smoothness parameter .",
    "can one extend theorem [ 2class ] to such a setting and formulate natural , necessary and sufficient conditions for the existence of confidence bands that adapt over a continuous scale of hlder classes ?",
    "can one construct `` practical '' adaptive nonparametric confidence bands ?",
    "for instance , can one use bands that are centered at wavelet or kernel estimators with data - driven bandwidths ?",
    "in particular can one circumvent having to know the radius @xmath66 of the hlder balls in the construction of the bands ?",
    "we shall give some answers to these questions in the remainder of the article , and summarize our main findings here .",
    "about question ( i ) : we show in proposition [ gnkill ] that the `` statistical '' separation of @xmath42 and @xmath4 using the sup - norm distance as in ( [ supsep ] ) enforces a weaker condition on @xmath93 than the analytic approach in @xcite , so that the present results are strictly more general for fixed smoothness parameters @xmath39 .",
    "we then move on to give a bayesian interpretation of the classes @xmath94 and @xmath95 : we show in proposition [ unif ] that a natural bayesian prior arising from `` uniformly '' distributing suitably scaled wavelets on @xmath42 concentrates on the classes @xmath94 and @xmath96 with overwhelming probability .    about question ( ii ) : if the radius @xmath66 of the hlder balls involved is known , then one can combine a natural testing approach with recent results in @xcite to prove the existence of adaptive nonparametric confidence bands over a scale of hlder classes indexed by a grid of smoothness parameters that grows dense in any fixed interval @xmath97 \\subset(0 , \\infty)$ ] as @xmath98 ; see theorems  [ 2classex ] ,  [ discad ] .",
    "a full answer to question ( iii ) lies beyond the scope of this paper .",
    "some partial findings that seem of interest are the following : note first that our results imply that the logarithmic penalties that occurred in the diameters of the adaptive confidence bands in @xcite are not necessary if one knows the radius @xmath66 . on the other hand we show in proposition [ nob ]",
    "that if the radius @xmath66 is unknown , then a certain price in the rate of convergence of the confidence band can not be circumvented , as @xmath66 can not reliably be estimated without additional assumptions on the model .",
    "this partly justifies the practice of undersmoothing in the construction of confidence bands , dating back to bickel and rosenblatt @xcite .",
    "it leads us to argue that near - adaptive confidence bands that can be used in practice , and that do not require the knowledge of @xmath66 , are more likely to follow from the classical adaptive techniques , like lepski s method applied to classical kernel or wavelet estimators , rather than from the `` testing approach '' that we employ here to prove existence of optimal procedures .    to conclude : the question as to whether adaptive methods should be used for inference clearly remains a `` philosophical '' one , but we believe that our results shed new light on the problem . that full adaptive inference is not possible is a consequence of the fact that the typical smoothness classes over which one wants to adapt , such as hlder balls , contain elements that are indistinguishable from a testing point of view . on the other hand hlder spaces",
    "are used by statisticians to model regularity properties of unknown functions @xmath0 , and it may seem sensible to exclude functions whose regularity is not statistically identifiable .",
    "our main results give minimal identifiability conditions of a certain kind that apply in this particular case .",
    "our findings apply also more generally to the adaptation problem discussed at the beginning of this introduction with two abstract classes @xmath99 .",
    "we are primarily interested in confidence statements that cai and low @xcite coin _ strongly adaptive _",
    "( see section 2.2 in their paper ) and in our case this corresponds precisely to requiring ( [ hon ] ) and ( [ adapt0 ] ) . if @xmath100 are convex , and if one is interested in a confidence interval for a linear functional of the unknown parameter , cai and low show that whether strong adaptation is possible or not is related to the so - called `` inter - class modulus '' between @xmath99 , and their results imply that in several relevant adaptation problems strongly adaptive confidence statements are impossible .",
    "the `` separation - approach '' put forward in the present article ( following @xcite ) shows how strong adaptation can be rendered possible at the expense of imposing statistical identifiability conditions on @xmath99 , as follows : one first proves existence of a risk - adaptive estimator @xmath45 over @xmath99 in some relevant loss function .",
    "subsequently one chooses a functional @xmath101 , defines the nonparametric model @xmath102 and derives the minimax rate @xmath55 of testing @xmath103 against the generally nonconvex alternative @xmath104 .",
    "combining consistent tests for these hypotheses with @xmath45 allows for the construction of confidence statements under sharp conditions on @xmath105 .",
    "a merit of this approach is that the resulting confidence statements are naturally compatible with the statistical accuracy of the adaptive estimator used in the first place .",
    "an important question in this context , which is beyond the scope of the present paper , is the optimal choice of the functional @xmath106 : for confidence bands it seems natural to take @xmath107 , but formalizing this heuristic appears not to be straightforward . in more general settings it may be less obvious to choose @xmath106 .",
    "these remain interesting directions for future research .",
    "let @xmath16 be i.i.d . with probability density @xmath0 on @xmath108 which we shall take to equal either",
    "@xmath109 $ ] or .",
    "we shall use basic wavelet theory @xcite freely throughout this article , and we shall say that the wavelet basis is @xmath110-_regular _ if the corresponding scaling functions @xmath111 and wavelets @xmath112 are compactly supported and @xmath110-times continuously differentiable on @xmath108 . for instance , we can take daubechies wavelets of sufficiently large order @xmath113 on @xmath114 ( see @xcite ) or on @xmath109 $ ] ( section 4 in @xcite ) .",
    "we define hlder spaces in terms of the moduli of the wavelet coefficients of continuous functions .",
    "the wavelet basis consists of the translated scaling functions @xmath111 and wavelets @xmath115 , where we add the boundary corrected scaling functions and wavelets in case @xmath109 $ ] . if @xmath114 the indices @xmath116 satisfy @xmath117 , @xmath118 , but if @xmath109 $ ] we require @xmath119 for some fixed integer @xmath120 and then @xmath121 for the @xmath122 s , @xmath123 for the @xmath111 s .",
    "note that @xmath124 for a fixed wavelet @xmath125 if either @xmath114 or if @xmath122 is supported in the interior of @xmath2 $ ] .",
    "write shorthand @xmath126 , @xmath127 .",
    "[ besov ] denote by @xmath128 the space of bounded continuous real - valued functions on @xmath108 , and let @xmath111 and @xmath112 be @xmath110-regular daubechies scaling and wavelet functions , respectively . for @xmath129 ,",
    "the hlder space @xmath130 ( @xmath131 when no confusion may arise ) is defined as the set of functions @xmath132    define , moreover , for @xmath133 , the class of densities @xmath134 it is a standard result in wavelet theory ( chapter 6.4 in @xcite for @xmath114 and theorem  4.4 in @xcite for @xmath109 $ ] ) that @xmath131 is equal , with equivalent norms , to the classical hlder  zygmund spaces @xmath135 . for @xmath114 , @xmath136 , these spaces consist of all functions @xmath137 for which @xmath138 is finite . for noninteger",
    "@xmath139 the space @xmath135 is defined by requiring @xmath140}f$ ] of @xmath137 to exist and to be contained in @xmath141}$ ] .",
    "the zygmund class @xmath142 is defined by requiring @xmath143 for all @xmath144 , some @xmath145 and @xmath137 , and the case @xmath146 follows by requiring the same condition on the @xmath147th derivative of @xmath0 .",
    "the definitions for @xmath109 $ ] are similar ; we refer to @xcite .",
    "define the projection kernel @xmath148 and write @xmath149 for the partial sum of the wavelet series of a function @xmath0 at resolution level @xmath150 , with the convention that @xmath151 if @xmath114 .    if @xmath16 are i.i.d .",
    "@xmath152 then an unbiased estimate of @xmath153 is , for @xmath154 the empirical wavelet coefficients , @xmath155      we shall first prove theorem [ 2class ] to lay out the main ideas .",
    "we shall prove claims ( a ) and ( b ) , that this also solves the testing problem @xmath69 against @xmath156 follows from the proofs .",
    "the proof of claim ( c ) is postponed to section [ rem ] .",
    "let us assume @xmath157 to simplify some notation .",
    "take @xmath158 such that @xmath159 is satisfied , where @xmath160 denotes two - sided inequalities up to universal constants .",
    "( @xmath161 ) : let us show that @xmath162 leads to a contradiction .",
    "in this case @xmath163 along a subsequence of @xmath33 , and we shall still index this subsequence by @xmath33 .",
    "let @xmath82 on @xmath2 $ ] and define , for @xmath48 , the functions @xmath164 where @xmath165 , @xmath166 , and where @xmath125 is a daubechies wavelet of regularity greater than @xmath39 , chosen in such a way that @xmath167 is supported in the interior of @xmath2 $ ] for every @xmath147 and @xmath168 large enough .",
    "( this is possible using the construction in theorem 4.4 in @xcite . ) since @xmath169 we have @xmath170 for every @xmath147 and also @xmath171 @xmath172 if @xmath48 is chosen small enough depending only on  @xmath173 .",
    "moreover , for any @xmath174 , using the definition of and since @xmath175 , @xmath176 so @xmath177 for @xmath178 ( recall @xmath157 ) and every @xmath168 but @xmath179 for @xmath168 large enough depending only on @xmath180 .    note next that @xmath181 for every @xmath182 , and any bounded function @xmath183 implies @xmath184 so that , for @xmath185 arbitrary , @xmath186 for every @xmath147 and for @xmath187 . summarizing we see that @xmath188 for every @xmath189 . since @xmath190 , @xmath191 , we can find @xmath192 such that @xmath193 in particular @xmath194 for every @xmath195 and every @xmath196 .",
    "suppose now @xmath28 is a confidence band that is adaptive and honest over @xmath197 , and consider testing @xmath198 define a test @xmath199 as follows : if no @xmath200 , then @xmath201 , but as soon as one of the @xmath202 s is contained in @xmath28 , then @xmath203 . we control the error probabilities of this test .",
    "using ( [ suplbd- ] ) , markov s inequality , adaptivity of the band , ( [ rho- ] ) and noting @xmath204 , we deduce @xmath205 under any alternative @xmath206 , invoking honesty of the band we have @xmath207 so that summarizing we have @xmath208 on the other hand , if @xmath209 is _ any _ test ( any measurable function of the sample taking values @xmath210 or @xmath211 ) , we shall now prove @xmath212 which contradicts ( [ bul ] ) and completes this direction of the proof .",
    "the proof follows ideas in @xcite .",
    "we have , for every @xmath213 , @xmath214 where @xmath215 with @xmath216 the product probability measures induced by a sample of size @xmath33 from the density @xmath202 . by markov",
    "s inequality , @xmath217 for every @xmath213 , and we show that the last term converges to zero .",
    "writing ( in abuse of notation ) @xmath218 , using independence , orthonormality of @xmath167 and @xmath219 repeatedly as well as @xmath220 , we see @xmath221^n } \\biggl(\\sum_{m=1}^m \\biggl(\\prod _ { i=1}^n f_m(x_i ) -1\\biggr ) \\biggr)^2 \\,dx \\\\ & = & \\frac{1}{m^2 } \\int_{[0,1]^n } \\biggl(\\sum_{m=1}^m \\biggl ( \\prod_{i=1}^n \\bigl(1+\\gamma_j \\psi_{jm}(x_i)\\bigr ) -1\\biggr ) \\biggr)^2 \\,dx \\\\ & = & \\frac{1}{m^2 } \\sum_{m=1}^m \\int_{[0,1]^n } \\biggl ( \\prod_{i=1}^n \\bigl(1+\\gamma_j \\psi_{jm}(x_i)\\bigr ) -1 \\biggr)^2 \\,dx \\\\ & = & \\frac{1}{m^2 } \\sum_{m=1}^m \\biggl ( \\int_{[0,1]^n } \\prod_{i=1}^n \\bigl(1+\\gamma_j \\psi_{jm}(x_i)\\bigr)^2 \\,dx -1 \\biggr ) \\\\ & = & \\frac{1}{m^2 } \\sum_{m=1}^m \\biggl ( \\biggl ( \\int_{[0,1 ] } \\bigl(1+\\gamma_j \\psi_{jm}(x)\\bigr)^2 \\,dx \\biggr)^n -1 \\biggr ) \\\\ & = & \\frac{1}{m } \\bigl((1+\\gamma_j^2)^n -1 \\bigr ) \\le\\frac{e^{n \\gamma _ j^2}-1}{m}.\\end{aligned}\\ ] ] now using ( [ rho- ] ) we see @xmath222 so that @xmath223 for every @xmath224 , whereas @xmath225 still diverges at a fixed polynomial rate in @xmath33 , so that the last quantity converges to zero , which proves ( [ contr ] ) since @xmath226 was arbitrary .",
    "( @xmath227 ) : let us now show that an adaptive band @xmath28 can be constructed if @xmath55 equals @xmath71 times a large enough constant , and if the radius @xmath66 is known .",
    "the remarks after definition [ besov ] imply that @xmath228 for some @xmath229 .",
    "set @xmath230 for @xmath231 a constant to be chosen later . using definition [ besov ] and @xmath232",
    ", we have for @xmath233 from ( [ est ] ) based on wavelets of regularity @xmath234 @xmath235 for some constants @xmath236 that depend only on @xmath237 .",
    "define the test statistic @xmath238 .",
    "let now @xmath239 be any estimator for @xmath0 that is exact rate adaptive over @xmath240 in sup - norm risk ; that is , @xmath45 satisfies simultaneously , for some fixed constant @xmath241 depending only on @xmath242 @xmath243 such estimators exist ; see theorem [ supad ] below .",
    "define the confidence band @xmath244\\}$ ] to equal @xmath245,\\ ] ] where @xmath246 , and where @xmath247 and @xmath37 are constants to be chosen below .",
    "we first prove that @xmath28 is an honest confidence band for @xmath248 when @xmath55 is as above with @xmath231 large enough depending only on @xmath249 .",
    "if @xmath250 we have coverage since adaptivity of @xmath45 implies , by markov s inequality , @xmath251 which can be made greater than @xmath252 for any @xmath253 by choosing @xmath37 large enough depending only on @xmath254 . when @xmath255 there is the danger of @xmath256 in which case the size of the band is too small",
    ". in this case , however , we have , using again markov s inequality , @xmath257 and the first term subtracted can be made smaller than @xmath29 for @xmath37 large enough in view of ( [ adap ] ) .",
    "for the second note that @xmath258 equals , for every @xmath255 , @xmath259 for some @xmath260 , by choosing @xmath261 large enough independent of @xmath255 , in view of proposition [ ineq ] below .",
    "this completes the proof of coverage of the band .",
    "we now turn to adaptivity of the band and verify ( [ adapt ] ) . by definition of @xmath28",
    "we have almost surely @xmath262 so the case @xmath255 is proved . if @xmath263 then , using ( [ bias ] ) and proposition  [ ineq ] , @xmath264 since @xmath265 can be taken sufficiently large by choosing @xmath266 large enough .",
    "this completes the proof of the second claim of theorem [ 2class ] .",
    "the existence results in the previous section are not entirely satisfactory in that the bands constructed to prove existence of adaptive procedures can not be easily implemented .",
    "particularly the requirement that the radius @xmath66 of the hlder ball be known is restrictive .",
    "a first question is whether exact rate - adaptive bands exist if @xmath66 is unknown , and the answer turns out to be no .",
    "this in fact is not specific to the adaptive situation , and occurs already for a fixed hlder ball , as the optimal size of a confidence band depends on the radius  @xmath66 .",
    "the following proposition is a simple consequence of the formula for the exact asymptotic minimax constant for density estimation in sup - norm loss as derived in  @xcite .",
    "[ nob ] let @xmath16 be i.i.d .",
    "random variables taking values in @xmath2 $ ] with density @xmath267)$ ] where @xmath268 .",
    "let @xmath28 be a confidence band that is asymptotically honest with level @xmath29 for @xmath269)$ ]",
    ". then @xmath270 ) } \\frac{e_f|c_n|}{r_n(r ) } \\ge cb^p ( 1-\\alpha)\\ ] ] for some fixed constants @xmath271 that depend only on @xmath272 .    in particular",
    "if @xmath28 does not depend on @xmath66 , then @xmath273 can not be of order @xmath71 uniformly over @xmath274)$ ] for every @xmath275 , unless @xmath66 can be reliably estimated , which for the full hlder ball is impossible without additional assumptions .",
    "it can be viewed as one explanation for why undersmoothing is necessary to construct `` practical '' asymptotic confidence bands .",
    "the usual risk - adaptive estimators such as those based on lepski s @xcite method or wavelet thresholding @xcite do not require the knowledge of the hlder radius @xmath66 .",
    "as shown in @xcite ( see also  @xcite ) such estimators can be used in the construction of ( near-)adaptive confidence bands under certain analytic conditions on the elements of @xmath4 .",
    "let us briefly describe the results in @xcite .",
    "let @xmath276 be a sequence of positive integers ( typically @xmath277 as @xmath98 ) and define , for @xmath278 the wavelet projection kernel associated to some @xmath110-regular wavelet basis , @xmath234 @xmath279 the conditions in @xcite are slightly weaker in that they have to hold only for @xmath280 $ ] where @xmath281 .",
    "this turns out to be immaterial in what follows , however , so we work with these sets to simplify the exposition .    whereas the upper bound in ( [ barsig ] )",
    "is automatic for functions in @xmath4 , the lower bound is not .",
    "however one can show that a lower bound on @xmath282 of order @xmath283 is `` topologically '' generic in the hlder space @xmath284 . the following is proposition 4 in @xcite .    [",
    "5 ] let @xmath278 be @xmath110-regular with @xmath234 .",
    "the set @xmath285 is nowhere dense in the norm topology of @xmath286 .    using this condition",
    ", @xcite constructed an estimator @xmath45 based on lepski s method applied to a kernel or wavelet density estimator such that @xmath287}\\biggl|\\frac{\\hat f_n(y)-f(y)}{\\hat \\sigma_n\\sqrt{\\hat",
    "f_n(y)}}\\biggr|-\\hat b_n \\biggr ) \\to^d z\\ ] ] as @xmath98 , where @xmath288 is a standard gumbel random variable and where @xmath289 are some random constants .",
    "if @xmath290 is chosen such that @xmath291 then the limit theorem ( [ lim0 ] ) is uniform in relevant unions over @xmath292 , r>0 $ ] , of hlder classes @xmath293 .",
    "since the constants @xmath289 in ( [ lim0 ] ) are known , confidence bands can be retrieved directly from the limit distribution , and @xcite further showed that so - constructed bands are near - adaptive : they shrink at rate @xmath294 whenever @xmath295 , where @xmath296 can be taken of the size @xmath297 .",
    "see theorem 1 in @xcite for detailed statements .",
    "as shown in theorem 4 in @xcite , the restriction @xmath298 can be relaxed to @xmath299 as @xmath98 , at least if one is not after exact limiting distributions but only after asymptotic coverage inequalities , and this matches proposition [ nob ] , so that these bands shrink at the optimal rate in the case where @xmath66 is unknown .",
    "obviously it is interesting to ask how the sets in ( [ barsig ] ) constructed from analytic conditions compare to the classes considered in theorems [ 2class ] , [ 2classex ] and [ discad ] constructed from statistical separation conditions .",
    "the following result shows that the conditions in the present paper are strictly weaker than those in @xcite for the case of two fixed hlder classes , and also gives a more statistical explanation of why adaptation is possible over the classes from ( [ barsig ] ) .",
    "[ gnkill ] let @xmath81 .",
    "suppose @xmath300 for some fixed @xmath48 .",
    "then @xmath301 for some constant @xmath302 . moreover , if @xmath303 as @xmath98 , so in particular in the adaptive case as in ( [ r ] ) , then , for every @xmath304 , @xmath305 for @xmath306 large enough .",
    "if @xmath290 is s.t .",
    "@xmath303 as @xmath307 , so in particular in the adaptive case ( [ r ] ) , then @xmath308 the set @xmath309 is nonempty for @xmath310 large enough .      instead of analyzing the topological capacity of the set removed , one can try to quantify its size by some measure on the hlder space @xmath131 . as there is no translation - invariant measure available we consider certain probability measures on @xmath131 that have a natural interpretation as nonparametric bayes priors .",
    "take any @xmath110-regular wavelet basis @xmath311 of @xmath312 ) , s > s$ ] .",
    "the wavelet characterization of @xmath18)$ ] motivates to distribute the basis functions @xmath122 s randomly on @xmath313 as follows : take @xmath314 i.i.d .",
    "uniform random variables on @xmath315 $ ] and define the random wavelet series @xmath316 which converges uniformly almost surely .",
    "it would be possible to set @xmath317 and replace @xmath211 by @xmath318 below , but to stay within the density framework we work with this minor simplification , for which @xmath319 as well as @xmath320 almost surely if @xmath321 is chosen large enough .",
    "conclude that @xmath322 is a random density that satisfies @xmath323 so its law is a natural prior on @xmath313 that uniformly distributes suitably scaled wavelets on @xmath4 around its expectation @xmath324 .",
    "[ unif ] let @xmath278 be the wavelet projection kernel associated to a @xmath110-regular wavelet basis @xmath325 of @xmath312)$ ] , @xmath234 , and let @xmath326 .",
    "then @xmath327    by virtue of part ( a ) of proposition [ gnkill ] the same bound can be established , up to constants , for the probability of the sets @xmath328 under the law of @xmath322 .    similar results ( with minor modifications ) could be proved if one replaces the @xmath314 s by i.i.d .",
    "gaussians , which leads to measures that have a structure similar to gaussian priors used in bayesian nonparametrics ; see , for example , @xcite .",
    "if we choose @xmath168 at the natural frequentist rate @xmath329 , then the bound in proposition [ unif ] becomes @xmath330 , where @xmath331 can be made as large as desired by choosing @xmath332 small enough . in view of ( 2.3 ) in theorem 2.1 in @xcite one could therefore heuristically conclude that the exceptional sets are `` effective null - sets '' from the point of view of bayesian nonparametrics .",
    "the question arises of how theorem [ 2class ] can be extended to adaptation problems over collections of hlder classes whose smoothness degree varies in a fixed interval @xmath97 \\subset(0,\\infty ) $ ] .",
    "a fixed finite number of hlder classes can be handled by a straightforward extension of the proof of theorem [ 2class ] .",
    "of more interest is to consider a continuum of smoothness parameters  adaptive estimators that attain the minimax sup - norm risk over each element of the collection @xmath333 exist ; see theorem [ supad ] below .",
    "following theorem [ 2class ] a first approach might seem to introduce analogues of the sets @xmath334 as @xmath335 however this does not make sense as the sets @xmath336 are -dense in @xmath4 , so that so - defined @xmath337 would be empty [ unless @xmath338 . rather one should note that any adaptation problem with a continuous smoothness parameter @xmath39 and convergence rates that are polynomial in @xmath33 can be recast as an adaptation problem with a discrete parameter set whose cardinality grows logarithmically in  @xmath33 . indeed let us dissect @xmath97 $ ] into @xmath339 points @xmath340 , @xmath341 @xmath342 , and each of which has at most @xmath343 and at least @xmath344 distance to the next point , where @xmath345 is a fixed constant .",
    "a  simple calculation shows @xmath346 for some constant @xmath347 and every @xmath348 , so that any estimator that is adaptive over @xmath349 , is also adaptive over @xmath350 $ ] .",
    "after this discretization we can define @xmath351 where @xmath352 is a sequence of nonnegative integers .",
    "we are interested in the existence of adaptive confidence bands over @xmath353 under sharp conditions on @xmath352 .",
    "let us first address lower bounds , where we consider @xmath109 $ ] for simplicity .",
    "theorem [ 2class ] can not be applied directly since the smoothness index @xmath39 depends on @xmath33 in the present setting , and any two @xmath354 could be as close as @xmath344 possibly . if the constant @xmath355 is taken large enough ( but finite ) one can prove the following result .",
    "[ 2classex ] let @xmath109 , l \\ge1 $ ] and @xmath356 be given , and let @xmath357 be a grid as above .",
    "let @xmath358 be any two points in @xmath357 and suppose that @xmath28 is a confidence band that is asymptotically honest with level @xmath29 over @xmath359 and that is adaptive in the sense that @xmath360 for every @xmath33 large enough .",
    "then if @xmath361 is a large enough but finite constant , we necessarily have @xmath362    a version of theorem [ 2classex ] for @xmath114 can be proved as well , by natural modifications of its proof .    to show that adaptive procedures exist if @xmath66 is known define @xmath363 where @xmath39 varies in @xmath364 , and where @xmath304 .",
    "setting @xmath365 for notational convenience , we now prove that an adaptive and honest confidence band exists , for @xmath366 large enough , over the class @xmath367 analyzing the limit set ( as @xmath98 ) of @xmath368 , or a direct comparison to the continuous scale of classes in ( [ barsig ] ) , seems difficult , as @xmath369 depends on @xmath33 now .",
    "note , however , that one can always choose @xmath370 in a nested way , and @xmath355 large enough , such that @xmath368 contains , for every @xmath33 , any fixed finite union ( over @xmath39 ) of sets of the form @xmath371 ( using proposition [ gnkill ] ) .",
    "[ discad ] let @xmath16 be i.i.d .",
    "random variables on @xmath109 $ ] or @xmath372 with density @xmath373 and suppose @xmath374 are given .",
    "then , if @xmath366 is large enough depending only on @xmath66 , a confidence band @xmath375 can be constructed such that @xmath376 and , for every @xmath377 and some constant @xmath231 independent of @xmath33 , @xmath378",
    "proof of proposition [ nob ] on the events @xmath379 we can find a random density @xmath380 depending only on @xmath28 such that @xmath381 for any @xmath382 , and negating this inclusion we have @xmath383 so that @xmath384 .",
    "thus , using coverage of the band @xmath385 the limit inferior in the last line equals @xmath211 as soon as @xmath260 is chosen small enough depending only on @xmath386 in view of theorem 1 in @xcite ; see also page 1114 as well as lemma a.2 in that paper .",
    "taking @xmath387 s in the inequality @xmath388 gives the result .",
    "proof of proposition [ gnkill ] ( a ) observe first that for every @xmath389 , @xmath390 let @xmath391 be a fixed integer , and let @xmath392 be a sequence of integers to be chosen later .",
    "then for some @xmath393 $ ] @xmath394 for some @xmath395 if @xmath391 is chosen large enough but finite depending only on @xmath396 . from ( [ lbdu ] ) we thus have , for any @xmath81 , @xmath397 where we have chosen @xmath398 large enough depending only on @xmath399 but still of order @xmath400 .",
    "this completes the proof of the first claim .",
    "the second claim is immediate in view of the definitions .",
    "\\(b ) take @xmath401 for some @xmath147 .",
    "then @xmath402 so @xmath403 and the estimate in the last display of the proof of part ( a ) implies @xmath404 for @xmath33 large enough depending only on @xmath405 . on the other hand@xmath406 so @xmath407 for any @xmath48",
    ".    proof of proposition [ unif ] using ( [ lbdu ] ) we have @xmath408 the variables @xmath409 are i.i.d . @xmath410 and so the @xmath411 s , @xmath412 , are i.i.d .",
    "@xmath413 with maximum equal to the largest order statistic @xmath414 . deduce @xmath415 to complete the proof .",
    "proof of theorem [ 2classex ] the proof is a modification of the `` necessity part '' of theorem [ 2class ] . let us assume w.l.o.g .",
    "@xmath416 , let us write , in slight abuse of notation , @xmath417 for @xmath418 throughout this proof to highlight the dependence on @xmath33 and choose @xmath419 such that @xmath420 holds for some @xmath421 and every @xmath33 large enough .",
    "we shall assume that @xmath355 is any fixed number satisfying @xmath422 in the rest of the proof , and we shall establish @xmath423 , where @xmath424 is the larger `` neighbor '' of @xmath425 in @xmath369 .",
    "this completes the proof since @xmath426 by definition of the grid .",
    "assume thus by way of contradiction that @xmath427 so that , by passing to a subsequence of @xmath33 if necessary , @xmath428 for every @xmath429 and every @xmath430 large enough . let @xmath431 and define @xmath432 as in the proof of theorem [ 2class ] , @xmath433 , @xmath434 .",
    "then @xmath435 for every @xmath189 where @xmath436 can be taken to depend only on @xmath437 .",
    "moreover for @xmath438 we have , using ( [ lbdu ] ) and the assumption on @xmath355 , for any @xmath439 , and every @xmath147 @xmath440 we thus see that @xmath441 for every @xmath442 .",
    "take now @xmath443 which exceeds @xmath444 for @xmath33 large enough , and conclude @xmath445\\\\[-8pt ] & \\ge & \\frac{l}{\\alpha } r_n(s_n^+ ) \\ge\\rho_n(s_n)\\nonumber\\end{aligned}\\ ] ] for @xmath33 large enough , where we have used the definition of the grid @xmath369 , of @xmath332 , the assumption on @xmath355 and the hypothesis on @xmath55 .",
    "summarizing @xmath446 for every @xmath447 and every @xmath448 .",
    "suppose now @xmath28 is a confidence band that is adaptive and asymptotically honest over @xmath449 , and consider testing @xmath450 against @xmath451 .",
    "define a test @xmath452 as follows : if no @xmath453 then @xmath201 , but as soon as one of the @xmath202 s is contained in @xmath28 then @xmath203 .",
    "now since @xmath454 and using ( [ agl ] ) , ( [ estlow ] ) we have @xmath455 under any alternative @xmath456 , invoking honesty of the band we have @xmath207 so that summarizing we have @xmath457 but this has led to a contradiction by the same arguments as in the proofof theorem [ 2class ] , noting in the last step that @xmath458 and thus @xmath459 since @xmath460 .",
    "proof of theorem [ discad ] we shall only prove the more difficult case .",
    "let @xmath461 be such that @xmath462 , let @xmath463 be as in ( [ est ] ) based on wavelets of regularity @xmath464 and define test statistics @xmath465 recall further @xmath466 from ( [ sigma ] ) and , for a constant @xmath37 to be chosen below , define tests @xmath467 to accept @xmath468 against the alternative @xmath469 .",
    "starting from the largest model we first test @xmath470 against @xmath471 .",
    "if @xmath65 is rejected we set @xmath472 , otherwise we proceed to test @xmath473 against @xmath474 and iterating this procedure downwards we define @xmath475 to be the first element @xmath476 in @xmath477 for which @xmath478 rejects . if no rejection occurs set @xmath479 .    for @xmath373 define @xmath480 .",
    "we can choose the constants @xmath37 and then @xmath366 depending only on @xmath481 such that @xmath482 for some constant @xmath483 and every @xmath33 large enough .    if @xmath484 , then the test @xmath485 has rejected for some @xmath486 .",
    "in this case @xmath487 for every @xmath488 , and thus , proceeding as in ( [ bias ] ) and using proposition [ ineq ] below , we have for @xmath37 and then @xmath489 large enough depending only on @xmath490 @xmath491    on the other hand if @xmath492 ( ignoring the trivial case @xmath493 ) , then @xmath494 has accepted despite @xmath495 . thus , using @xmath496 for some @xmath497 and proceeding as in ( [ bias ] ) we can bound @xmath498 by @xmath499 for @xmath366 and then also @xmath500 large enough , using proposition [ ineq ] below .",
    "take now @xmath45 to be an estimator of @xmath0 that is adaptive in sup - norm loss over @xmath501 } \\sigma(s)$ ] as in theorem [ supad ] below and define the confidence band @xmath502 where @xmath503 is chosen below .",
    "for @xmath504 the lemma implies @xmath505 so this band is adaptive .    for coverage , we have , again from the lemma and markov s inequality @xmath506 which is greater than or equal to @xmath252 for @xmath503 and @xmath33 large enough depending only on @xmath507 .",
    "proof of part of theorem [ 2class ] the analog of case ( b ) is immediate .",
    "the analog of part ( a ) requires the following modifications : set again @xmath82 on @xmath2 $ ] , @xmath508 to be chosen below , and define @xmath509 where @xmath510 , all @xmath122 s are daubechies wavelets supported in the interior of @xmath2 $ ] and where @xmath511 is chosen such that @xmath512 and @xmath513 have disjoint support for every @xmath147 ( which is possible for @xmath514 large enough since daubechies wavelets have localized support ) . recalling @xmath515 from the proof of part ( a ) , we can choose @xmath516 in such a way that @xmath517 , @xmath518 for every @xmath519 .",
    "now if @xmath28 is a confidence band that is adaptive and honest over @xmath520 consider testing @xmath521 against @xmath451 .",
    "the same arguments as before ( [ bul ] ) show that there exists a test @xmath199 such that @xmath522 along a subsequence of @xmath33 , a claim that leads to a contradiction since we can lower bound the error probabilities of any test as in the original proof above , the only modification arising in the bound for the likelihood ratio .",
    "let @xmath523 be the @xmath33-fold product probability measure induced by the density @xmath524 and set @xmath525 .",
    "we suppress now the dependence of @xmath526 on @xmath33 for notational simplicity , and define shorthand @xmath527 , @xmath528 . to bound @xmath529",
    "we note that , using orthonormality of the @xmath530 s , that @xmath531 and that @xmath532 has disjoint support with @xmath533 , we have ( @xmath534 ) @xmath535 the identities in the last display can be used to bound @xmath529 by @xmath536^n } \\biggl(\\sum_{m=1}^m \\biggl(\\prod_{i=1}^n \\frac { f_m(x_i)}{f_0'(x_i ) } -1\\biggr ) \\biggr)^2 \\prod_{i=1}^n f_0'(x_i ) \\,dx \\\\ & & \\qquad= \\frac{1}{m^2 } \\sum_{m=1}^m \\int_{[0,1]^n } \\biggl ( \\prod_{i=1}^n \\biggl(1+\\frac{\\gamma_j \\psi_{jm}(x_i)}{1+\\kappa_j \\psi_{j'm_0}(x_i)}\\biggr ) -1 \\biggr)^2 \\prod_{i=1}^nf'_0(x_i)\\,dx \\\\ & & \\qquad= \\frac{1}{m^2 } \\sum_{m=1}^m \\biggl ( \\biggl ( \\int_{[0,1 ] } \\biggl(1+\\frac { \\gamma_j \\psi_{jm}(x_i)}{1+\\kappa_j \\psi_{j'm_0}(x_i)}\\biggr)^2 f_0'(x)\\,dx \\biggr)^n -1 \\biggr ) \\\\ & & \\qquad= \\frac{1}{m } \\bigl((1+\\gamma_j^2)^n -1 \\bigr ) \\le\\frac{e^{n \\gamma _",
    "j^2}-1}{m}.\\end{aligned}\\ ] ] the rest of the proof is as in part ( a ) of theorem [ 2class ] .",
    "the following theorem is due to @xcite .",
    "we state a version that follows from theorem 4 in @xcite for @xmath114 . in case @xmath109",
    "$ ] it follows from the same proofs .",
    "the restriction that @xmath66 be known is not necessary but suffices for our present purposes .",
    "[ supad ] let @xmath16 be i.i.d . with uniformly continuous density @xmath0 on",
    "@xmath109 $ ] or @xmath114 .",
    "then for every @xmath537 there exists an estimator @xmath538 such that , for every @xmath39 , @xmath539 , some constant @xmath540 and every @xmath541 we have @xmath542 .",
    "the following inequality was proved in @xcite ( see also page 1167 in @xcite ) for @xmath114 ( the case @xmath109 $ ] is similar , in fact simpler ) .",
    "[ ineq ] let @xmath325 be a compactly supported scaling and wavelet function , respectively , both @xmath110-hlder for some @xmath543 .",
    "suppose @xmath544 has a bounded density @xmath0 and let @xmath545 be the estimator from ( [ est ] ) .",
    "given @xmath546 , there exist finite positive constants @xmath547 and @xmath548 such that , if @xmath549 and @xmath550 , then , for every @xmath551 , @xmath552",
    "we would like to thank tony cai , the associate editor , as well as two anonymous referees for valuable remarks and criticism .",
    "we are further grateful to adam bull and jakob shl for pointing out mistakes in the first version of this article .",
    "we are also indebted to yannick baraud , lutz dmbgen , vladimir koltchinskii , oleg lepski , axel munk , dominique picard , benedikt ptscher , markus reiss , vladimir spokoiny and aad van der vaart for stimulating discussions on the subject over the past years .",
    "the second author would like to thank the hospitality of the cafs brunerhof and florianihof in vienna for their hospitality ."
  ],
  "abstract_text": [
    "<S> the problem of existence of adaptive confidence bands for an unknown density @xmath0 that belongs to a nested scale of hlder classes over @xmath1 or @xmath2 $ ] is considered . </S>",
    "<S> whereas honest adaptive inference in this problem is impossible already for a pair of hlder balls @xmath3 , of fixed radius , a nonparametric distinguishability condition is introduced under which adaptive confidence bands can be shown to exist . </S>",
    "<S> it is further shown that this condition is necessary and sufficient for the existence of honest asymptotic confidence bands , and that it is strictly weaker than similar analytic conditions recently employed in gin and nickl [ _ ann . </S>",
    "<S> statist . _ </S>",
    "<S> * 38 * ( 2010 ) 11221170 ] . </S>",
    "<S> the exceptional sets for which honest inference is not possible have vanishingly small probability under natural priors on hlder balls @xmath4 . </S>",
    "<S> if no upper bound for the radius of the hlder balls is known , a price for adaptation has to be paid , and near - optimal adaptation is possible for standard procedures . </S>",
    "<S> the implications of these findings for a general theory of adaptive inference are discussed .    .    . </S>"
  ]
}