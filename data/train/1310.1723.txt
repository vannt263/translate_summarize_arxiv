{
  "article_text": [
    "let us consider the following problem .",
    "we have a square chessboard with sides of length @xmath0 and a simple random walk on it .",
    "more precisely , think the chessboard as the square lattice box @xmath1 with the simple random walk @xmath2 on @xmath3 .",
    "denote by @xmath4 the hitting time of a set @xmath5 for the walk @xmath2 and by @xmath6 the law of @xmath2 starting from @xmath7 .",
    "can you find a probability law @xmath8 on the subsets @xmath9 of @xmath3 with cardinality @xmath10 such that @xmath11\\right ] \\text { does not depend on } x\\text { ? } \\ ] ] in other words , can you sample @xmath12 `` well distributed points '' among the @xmath13 points of @xmath14 ? in this example , a possible simple answer is the following .",
    "take @xmath9 to be the set of either white or black squares of the chessboard with probability @xmath15 .",
    "one could then raise the following questions :    * what if the random subsets @xmath9 are required to have any other cardinality @xmath16 ? *",
    "what if , instead of the chessboard @xmath3 , we consider any other finite weighted ( possibly oriented ) graph ?",
    "we notice that the case @xmath17 is trivial , and that in the case @xmath18 , it is known that it suffices to choose the point in @xmath3 according to the stationary measure of the walk ( see e.g.  @xcite ) .",
    "one of the main goals of this paper is to answer these questions for @xmath19 .    in the sequel , we work on a finite oriented weighted graph with the natural irreducible markov chain associated with it .",
    "we study a certain probability measure on the set of spanning rooted oriented forests on this graph .",
    "it will turn out that the set of roots of the forest sampled from this measure , with conditioning on the number of roots , provides a solution to this problem in full generality . as far as practical sampling issues are concerned , by using an algorithm due to wilson and propp  @xcite we can sample this measure without conditioning .",
    "furthermore , under the assumption that the generator of the random walk associated with the starting weighted graph has only real eigenvalues , we explain how to get a sample with an approximate prescribed number @xmath20 of roots within an error of order @xmath21 . in section",
    "[ setting ] below , we introduce the main framework and notation , and in section [ paper ] we describe the structure of the paper and the results we derive .",
    "let @xmath2 be a markov process on a finite state space @xmath3 , with @xmath22 .",
    "assume @xmath2 is irreducible with generator given by @xmath23,\\quad x\\in \\mathcal{x},\\ ] ] with @xmath24 arbitrary and @xmath25 a given collection of non - negative transition rates .",
    "note that such a markov process has variable speed depending on the current state , namely , if the chain is at position @xmath26 , the next jump will be performed after an exponential time of rate @xmath27 the collections of rates induces a structure of oriented weighted graph on @xmath3 .",
    "in fact , consider the set of oriented edges @xmath28 then @xmath29 is a weighted oriented graph .",
    "the main object of our investigation is a measure on the spanning rooted oriented forests in @xmath30 .",
    "let @xmath31 denote the set of spanning forests constituted by oriented rooted trees ( oriented towards their roots ) . for @xmath32 , define the weight of a such a forest by @xmath33    * ( standard forest measure)*[theforest ] denote by @xmath34 the set of roots of a forest @xmath35 , i.e. , the set of points which are the roots of the trees constituting @xmath36 .",
    "fix @xmath37 and define on @xmath31 the measure @xmath38 given by @xmath39 by normalizing it via the partition function : @xmath40 we denote the resulting probability measure by @xmath41 we call _ standard measure _ , _ standard partition function _ and _ standard probability measure _ , the objects defined by equations , , and , respectively .    * remarks : * there are obvious similarities between the weights appearing in equation ( [ standardforestmeasure ] ) and those of fortuyn - kasteleyn model .",
    "we stress here the main differences .",
    "fk - percolation is defined on spanning graphs that are not required to be forests .",
    "however , in the zero limit of its main parameters , properly rescaled , the model does converge to a measure on spanning forests ( see e.g.  @xcite ) .",
    "nevertheless , our forests are rooted and this extra structure introduces an entropic factor in comparison ( by projection on unrooted forests ) with this zero limit of fk - percolation .",
    "we note that the weights in ( [ forestweight ] ) are those associated by freidlin and wentzell with the so called `` @xmath42-graphs ''  @xcite and we will recover some of their results in this paper .",
    "our standard forest measure has also been studied in various works .",
    "for example to sample points from the stationary measure of the random walk  @xcite , or to study in  @xcite recurrent configurations of abelian dissipative sandpile introduced in  @xcite .",
    "this spanning forest measure and other associated objects we will discuss later are actually a variation on the theme of uniform spanning trees and loop - erased random walks .",
    "we refer to  @xcite and references therein for the vast literature on the subject .",
    "as it will become clear , the measure in definition [ theforest ] and the associated partition function encode several information related to the chain @xmath2 . at the occurrence , we will derive several results related with slightly more general measures and partition functions . to this aim ,",
    "we introduce here some further notation .",
    "let us first introduce a natural generalization of the measure in definition [ theforest ] .",
    "let @xmath43 be the space of square matrices of size @xmath44 .",
    "given a collection of extra weights @xmath45 : \\ : x\\in\\mathcal{x}\\}$ ] , let @xmath46 be the diagonal matrix in @xmath43 defined by @xmath47 with @xmath48 for @xmath49 .",
    "we anticipate that these extra weights will be interpreted as killing rates for the chain @xmath2 . set @xmath50 and define the measure @xmath51 by @xmath52    by assuming that there is at least one @xmath53 with @xmath54 we can turn @xmath51 into a probability measure on @xmath31 by normalizing it via the partition function : @xmath55 and we denote the resulting probability measure by @xmath56 this is the general form of the probability measure at the core of our investigation .",
    "when answering the questions raised in section [ chessboard ] , we need the following special case of the generalized measure in . for a given subset",
    "@xmath5 , suppose that the collection of extra weights @xmath45 , x\\in\\mathcal{x}\\}$ ] is such that @xmath57 in this case , @xmath58 , and we write @xmath59 for the measure and the partition function , @xmath60 and @xmath61 , respectively . in particular , for @xmath62 , @xmath63 and @xmath64 .",
    "note further that , when @xmath65 , we recover the _ standard _ measure and partition function , @xmath66 and @xmath67 .",
    "in the sequel we will denote by @xmath68 a random variable on a probability space @xmath69 with values in @xmath70 and law @xmath71 . to avoid ambiguities , when needed ,",
    "we write @xmath72 , @xmath73 or @xmath74 in place of @xmath75 .        our analysis of the forest measures introduced above will lead us to several results . before describing them and the organization of the paper ,",
    "we emphasize herein what we consider as our three main results .",
    "first , in theorem [ determinantalroots ] we prove that the set of roots @xmath76 sampled from the standard measure in is a determinantal process .",
    "more precisely , denoting by @xmath77 , the transition probabilities of the markov chain @xmath2 in observed at independent exponentially distributed times of parameter @xmath78 , we have that @xmath79 with @xmath80 being the determinant of @xmath81 restricted to @xmath82 ( see section [ notation ] below for the notation ) .",
    "this echoes burton and pemantle transfer current theorem (  @xcite , thm 1.1 ) .",
    "our kernel @xmath81 is however not required to be reversible ( and with possibly complex eigenvalues ) , and we present a direct proof not relying on transfer currents .    the second result is an answer to the questions in the introductory section [ chessboard ] .",
    "in fact , in theorem [ hittingrootsthm ] we give a formula for the hitting times of random sets constituted by the roots of our standard random forests , with or without conditioning on having a fixed number of roots . in particular , such a formula is independent of the starting point @xmath26 .",
    "while wilson and propp algorithm gives a way to sample the unconditioned measure , in section [ hittingtimes ] we explain how to obtain , in absence of complex eigenvalues , a sample with approximately @xmath20 roots , with an error of order @xmath21 , for any @xmath83 .",
    "our third result concerns a non - trivial algebraic statement on symmetric matrices derived in  @xcite , thm 3.2 therein .",
    "this theorem has been used in some recent probabilistic works  @xcite to study absorption times of reversible markov chains on general finite graphs , as a key tool to define , in such a general setting , the local equilibria introduced in  @xcite . in  @xcite , the author motivates the importance of having a probabilistic interpretation of micchelli and willoughby algebraic result . in section [ mw ]",
    "we restate their result and give , by means of our standard forest measure , probabilistic insights into their proof .",
    "the rest of the paper is organized as follows .",
    "* background material : * section [ background ] is a warm - up section where we provide some known background material . in section [ loops ]",
    "we prove in a slightly different way a result originally due to marchal  @xcite on loop - erased trajectories , proposition [ marchal ] . in section [ wilson ]",
    "we recall wilson s algorithm , definition [ wilson ] , and as a corollary of proposition [ marchal ] , following  @xcite , we show how to sample our unconditioned measures , corollary [ wilsonprob ] .",
    "* results : * section [ main ] is the bulk of this work where we derive our results .",
    "each subsection presents some new results related with our forest measures .",
    "section [ forroots ] presents the first analysis on the forest measures , in theorem [ partitionthm ] and corollary [ bernoullicity ]",
    "therein we show some connection of these measures with the spectrum of the chain @xmath2 . in theorem [ determinantalroots ]",
    "we prove that the set of roots is a determinantal process .",
    "in section [ hittingtimes ] we prove theorem [ hittingrootsthm ] on the hitting times of the roots set , answering the questions raised in section [ chessboard ] .",
    "section [ mw ] concerns a partial probabilistic interpretation of the proof and result by micchelli and willoughby  @xcite . in section [ marmelata ]",
    "we mention a couple of coalescence and fragmentation processes associated with our measures .",
    "one of them is obtained by coupling together all the standard forest measures for different values of @xmath78 .",
    "the focus of section [ pietruccia ] is on the ` rooted partitions ' induced by our spanning forests , proposition [ localequilibria ] , and on the cumulants , or truncated correlation functions , of the roots process , section [ cumulants ] .    *",
    "appendix : * appendix  [ appendix ] is devoted to technical known results used along the paper , which we derive in our context in order to have a self - contained work . in appendix",
    "[ schur ] , we recall what is the schur complement for block matrices and its probabilistic interpretation , proposition  [ schurprob ] . in appendix",
    "[ wentzell ] , we give different proofs of two lemmas from freidlin and wentzell ( lemmas 3.2 , 3.3 in  @xcite ) on hitting distribution and times of subsets of the graph , again by means of our forest measure .",
    "these lemmas are used in section [ hittingtimes ] .",
    "appendix [ divideddiff ] concerns the notion of divided differences which are used in section [ mw ] .",
    "we state three equivalent definitions and prove a related lemma . to conclude this introductory section and to simplify the reading ,",
    "we fix here some notation .",
    "further notation will be introduced at the occurrence .",
    "* _ set theory _ * * * spaces : * @xmath84 will be our reference state space for the markov process @xmath2 . in the sequel",
    ", we work with extensions of @xmath84 which will be denoted by @xmath85 or with more general spaces denoted by @xmath86 . * * * subsets : * the symbols @xmath87 and @xmath88 will be used as inclusion and strict inclusion , respectively .",
    "subsets will be generally denoted by capital letters : @xmath89 . * * * complement : * unless specified , we always deal with subsets of the space @xmath84 . for a given subset @xmath90 ,",
    "we denote by @xmath91 the complement of @xmath82 in @xmath84 . *",
    "_ graphs _ * * * edges * : @xmath30 introduced in stands for the set of oriented edges on @xmath84 . * * * extreme points of oriented edges : * for an oriented edge @xmath92 , we denote the starting and the ending points of @xmath93 by @xmath94 and @xmath95 , and by @xmath96 the weight associated to it . * * * forest space : * @xmath31 denotes the set of spanning rooted oriented forests on @xmath3 . * * * a given forest : * elements of @xmath31 are denoted by @xmath32 , which can also be seen as subsets of @xmath30 . *",
    "* * roots : * given @xmath32 , @xmath76 denotes the set of the roots of the trees constituting @xmath36 . * * * tree associated with a given vertex : * given @xmath26 in @xmath14 and @xmath97 we denote by @xmath98 the unique tree in @xmath36 that covers @xmath26 .",
    "we write @xmath99 when @xmath98 is rooted at @xmath26 .",
    "* _ matrix _ * * * square matrices space : * the space of square matrices with @xmath44 columns and @xmath44 rows is denoted by @xmath43 . * * * restriction of a matrix : * given a matrix @xmath100 with elements @xmath101 s in @xmath3 , for any subset @xmath82 of @xmath3 , @xmath102_a$ ] stands for the matrix @xmath103 restricted to its elements doubly indexed in @xmath82 . * * * determinants : * @xmath104 will denote the determinant of the matrix obtained from @xmath103 by removing all the lines and columns with indexes outside @xmath105 , i.e. , @xmath106_a)$ ] . *",
    "_ random walks _ * * * markov processes and discrete skeletons : * @xmath2 and @xmath107 will denote markov processes on the spaces @xmath3 and @xmath108 , respectively . @xmath109 and @xmath110 will denote some associated discrete - time markov chains . * * * generators : * @xmath111 and @xmath112 denote the generators of the markov processes @xmath2 and @xmath107 respectively . for a given subset @xmath82 of @xmath113",
    ", @xmath114 stands for the generator of the markov process @xmath2 _ restricted _ to the component @xmath82 . while @xmath115 denotes the _ trace _ of the process @xmath107 on some fixed subset @xmath82 of @xmath116 .",
    "we introduce here a slightly more general setting than in section [ setting ] .",
    "let @xmath107 be a markov process on a finite state space @xmath108 .",
    "assume @xmath107 is irreducible with generator given by @xmath117,\\quad y\\in \\mathcal{y},\\ ] ] with @xmath118 arbitrary and @xmath119 : \\ : ( y , z)\\in \\mathcal{y}\\times \\mathcal{y}\\}$ ] a given collection of non - negative transition rates .",
    "let @xmath120.\\ ] ] let @xmath121 be a subset of @xmath108 such that @xmath122 so that , @xmath123 for any @xmath124 , the complement of @xmath121 in @xmath108 .    denote by @xmath125 a self - avoiding path of @xmath126 points and length @xmath127 such that @xmath128 for @xmath129 and @xmath130 . for @xmath131 ,",
    "let @xmath132 the law of the random walk @xmath107 when starting from @xmath133 .",
    "denote by @xmath134 a random trajectory obtained from @xmath107 under @xmath132 as follows .",
    "stop the walk @xmath107 when it enters the set @xmath121 for the first time and erase all its loops .",
    "after this procedure , we are left with a self - avoiding trajectory of variable length . in the next proposition",
    "we compute the probability that @xmath134 equals a given trajectory @xmath135 of length @xmath127 . to simplify the proof",
    ", we use the discrete skeleton of the markov process @xmath107 on @xmath136 .",
    "this justify the following definitions .",
    "set @xmath137 and let @xmath138 , with @xmath139 , be the transition matrix identified by the entries @xmath140    such a matrix @xmath141 is a markovian transition matrix for a discrete - time random walk @xmath110 on @xmath86 . in particular , for an arbitrary function @xmath142 , by construction we have that @xmath143 we are in shape to prove the claimed proposition , by using a nice independence argument we learned from laurent tournier  @xcite .",
    "[ marchal ] * ( marchal  @xcite ) * consider the random walk @xmath107 on @xmath108 with generator @xmath112 as in .",
    "fix @xmath131 . then , under @xmath132 , @xmath144 with the matrix notation according to section [ notation ] and @xmath145 a self - avoiding path of length @xmath127 such that @xmath128 for @xmath129 and @xmath130 .    for the discrete chain @xmath146 , let @xmath147 and @xmath148 be the first return time to @xmath133 and the hitting time of @xmath121 , respectively .",
    "more precisely , @xmath149 and @xmath150 .",
    "note that by definition of @xmath134 , we have that @xmath151 as a consequence , we can write : @xmath152 it follows from that @xmath153    denote by @xmath154 the local time @xmath146 spends at @xmath133 before entering @xmath121 , and by @xmath155_{b^c}$ ] the matrix @xmath156 restricted to @xmath136 , then @xmath157=\\sum_{k\\geq 0}[\\hat{p}]^k_{b^c}(y_0,y_0)\\\\ & = ( [ \\mathbbm{1}-\\hat{p}]_{b^c})^{-1}(y_0,y_0)= \\frac{{\\rm det}_{b^c\\setminus \\{y_{0}\\}}(\\mathbbm{1}-\\hat{p})}{{\\rm det}_{b^c}(\\mathbbm{1}-\\hat{p } ) } , \\end{aligned}\\ ] ] where the last equality follows by cramer s formula for an inverse matrix .    on the other hand , for the numerator in the r.h.s . of equation ,",
    "we can write @xmath158    by plugging and into , and iterating , we have that @xmath159      we introduce here the algorithm due to wilson and propp  @xcite which allow us to sample the measure .",
    "first , we extend the markov process @xmath2 defined through on @xmath84 to a markov process @xmath160 on the space @xmath161 by interpreting @xmath162 as an absorbing state and by adding some killing rates . consider the space @xmath3 , with @xmath22 .",
    "assume a collection of killing rates @xmath45 : \\ :",
    "x\\in\\mathcal{x}\\}$ ] is given , and let @xmath46 be the diagonal matrix in @xmath43 defined by @xmath47 with @xmath48 for @xmath49",
    ". consider the markov process @xmath160 on the finite state space @xmath85 with generator given by @xmath163,&\\mbox { if } x\\in \\mathcal{x},\\\\   0,&\\mbox { if } x=\\delta .",
    "\\end{array } \\right.\\ ] ] with @xmath164 arbitrary , and @xmath111 defined in . in particular , the matrix @xmath165 associated with the generator in satisfies @xmath166    next , we describe the algorithm . for any @xmath167 , note that , due to irreducibility , @xmath168 is a.s .",
    "finite .    *",
    "( wilson s algorithm ) *    1 .",
    "start the process @xmath169 from any point @xmath170 until it reaches the absorbing state @xmath162 .",
    "2 .   erase all the loops of the trajectory described by @xmath169 up to time @xmath171 .",
    "call @xmath172 this self - avoiding trajectory .",
    "( @xmath172 is such that @xmath173 . )",
    "if @xmath172 covers the whole @xmath174 stop , else pick any point @xmath175 , with @xmath176 denoting the set of points covered by @xmath172 .",
    "start the process @xmath169 from @xmath177 until it hits the set @xmath176 .",
    "4 .   erase all the loops of the trajectory described by @xmath169 starting from @xmath177 up to time @xmath178 .",
    "call @xmath179 this self - avoiding trajectory .",
    "5 .   if @xmath180 stop , else pick any point @xmath181 .",
    "start the process @xmath169 from @xmath177 until it hits the set @xmath182 .",
    "iterate until @xmath174 is covered .",
    "denote by @xmath183 the set of spanning oriented trees on @xmath85 rooted at @xmath162 .",
    "this algorithm produces in finite time an element @xmath184 of @xmath183 . as a corollary of proposition [ marchal ]",
    ", we can easily compute the probability that the algorithm produces a given @xmath185 .",
    "[ wilsonprob ] fix a tree @xmath185 .",
    "let @xmath186 be the set of edges in @xmath184 connected to the root @xmath162 ( possibly via the edges with infinite rate from @xmath187 to @xmath162 ) . denote by @xmath188 the probability that wilson s algorithm produces the tree @xmath184",
    ". then @xmath189      \\left[\\displaystyle\\prod_{e\\in\\tau\\setminus\\partial{\\rho(\\tau)}}w(e)\\right ] } { { \\rm det}_{{\\cal x } \\setminus s}(-\\mathcal{l})}.\\ ] ]    recall the notation in proposition [ marchal ] .",
    "set @xmath190 and @xmath191 .",
    "start with @xmath192 . by the definition of the algorithm",
    ", the proof follows by iterating the formula in equation where at each iteration we set the right @xmath121 according to the given tree @xmath184 .",
    "whatever the choice of starting points in wilson algorithm we get the same result .",
    "we conclude this section by observing that there exists a natural bijection between @xmath193 and @xmath183 .",
    "indeed , given @xmath194 , let @xmath195 be the unique element in @xmath183 obtained from @xmath36 by adding all the edges connecting the roots in @xmath36 to @xmath162 , i.e. add all edges @xmath93 such that @xmath196 and @xmath197 .",
    "vice versa , given @xmath185 , by removing all edges @xmath198 we can identify a unique element @xmath194 . this simple observation together with corollary [ wilsonprob ] allow us to sample the measure in using wilson s algorithm .",
    "samples from @xmath199 for @xmath200 on the two - dimensional @xmath201 torus with uniform rates equal to 1 between nearest neighbours for the first picture and , for the second picture , with an additional northward drift , such that @xmath202 if @xmath203 is the northern nearest neighbour of @xmath26 and @xmath204 otherwise .",
    "the third picture is a sample from @xmath199 for the same @xmath200 on the @xmath205 rectangular grid and for metropolis random walk in a browian sheet potential @xmath206 , i.e. , nearest neighbour rates are given by @xmath207_+\\}$ ] with @xmath208 and @xmath206 is the restriction to the grid of a brownian sheet with 0 value on the west and north sides of the box .",
    "in each picture different blue levels are assigned to points in different trees , cyan lines separate neighbouring trees , and the forest roots are at the centers of red diamonds .",
    ", title=\"fig : \" ] samples from @xmath199 for @xmath200 on the two - dimensional @xmath201 torus with uniform rates equal to 1 between nearest neighbours for the first picture and , for the second picture , with an additional northward drift , such that @xmath202 if @xmath203 is the northern nearest neighbour of @xmath26 and @xmath204 otherwise .",
    "the third picture is a sample from @xmath199 for the same @xmath200 on the @xmath205 rectangular grid and for metropolis random walk in a browian sheet potential @xmath206 , i.e. , nearest neighbour rates are given by @xmath207_+\\}$ ] with @xmath208 and @xmath206 is the restriction to the grid of a brownian sheet with 0 value on the west and north sides of the box .",
    "in each picture different blue levels are assigned to points in different trees , cyan lines separate neighbouring trees , and the forest roots are at the centers of red diamonds .",
    ", title=\"fig : \" ]     samples from @xmath199 for @xmath200 on the two - dimensional @xmath201 torus with uniform rates equal to 1 between nearest neighbours for the first picture and , for the second picture , with an additional northward drift , such that @xmath202 if @xmath203 is the northern nearest neighbour of @xmath26 and @xmath204 otherwise .",
    "the third picture is a sample from @xmath199 for the same @xmath200 on the @xmath205 rectangular grid and for metropolis random walk in a browian sheet potential @xmath206 , i.e. , nearest neighbour rates are given by @xmath207_+\\}$ ] with @xmath208 and @xmath206 is the restriction to the grid of a brownian sheet with 0 value on the west and north sides of the box .",
    "in each picture different blue levels are assigned to points in different trees , cyan lines separate neighbouring trees , and the forest roots are at the centers of red diamonds . ]",
    "this section is the bulk of the paper containing our main theorems .",
    "each subsection is devoted to some new results relating the markov chain @xmath2 to the law of the forest at the core of our investigation .",
    "we start here to analyze the measure introduced in on the space @xmath31 of spanning rooted oriented forests on @xmath84 .",
    "we compute the partition function , we identify the distribution of the number of roots in the standard case and we prove that the roots process is a determinantal one .",
    "[ partitionthm ] * ( partition function and spectrum ) * assume a collection of killing rates @xmath45 : \\ : x\\in\\mathcal{x}\\}$ ] is given , and let @xmath46 be the diagonal matrix in @xmath43 defined by @xmath47 with @xmath48 for @xmath49 .",
    "let @xmath71 the probability measure on @xmath193 in .",
    "then @xmath209 and , recalling the notation from section [ wilson ] , @xmath210 in the case @xmath211 , we recover the standard probability measure in , and the standard partition function in satisfies @xmath212 where @xmath213 is the characteristic polynomial of @xmath111 , i.e. @xmath214 where the @xmath215 s are the eigenvalues of @xmath216 ordered by non - decreasing real part . when @xmath217 and @xmath218 , we have that @xmath219_{r^c}}(q)\\ ] ] with @xmath220_{r^c}}$ ] being the characteristic polynomial of the sub - markovian generator of the process killed in @xmath9 .    *",
    "remark : * this kind of results goes back to kirchhoff  @xcite . here we include the non - reversible case and stress the dependence in @xmath78 .",
    "as observed in the previous section , for each forest @xmath32 there is a unique @xmath221 . by corollary [ wilsonprob ]",
    "we then have that @xmath222 \\left[\\displaystyle\\prod_{e\\in\\tau\\setminus\\partial{\\rho(\\tau)}}w(e)\\right ] } { { \\rm det}_{{\\mathcal x}\\setminus s}(-\\mathcal{l } ) } = \\frac{w_q(\\phi)}{{\\rm det}_{{\\cal x } \\setminus s}(q - l)}.\\ ] ] by summing over all @xmath194 we immediately get .",
    "in fact , @xmath223 moreover , if @xmath211 , then @xmath224 and @xmath225=\\chi_l(q)$ ] .    in the standard case , an immediate consequence of theorem [ partitionthm ] is a characterization of the law of the cardinality of the set of roots .",
    "[ bernoullicity ] * ( root number distribution ) * assume the standard case @xmath211 and that @xmath111 has real spectrum .",
    "let @xmath226 be a sum of @xmath44 independent bernoulli random variables with parameters @xmath227 . under the probability measure @xmath74",
    ", the random variable @xmath228 counting the number of roots ( or equivalently , of trees ) in @xmath68 has the same law as @xmath226 .",
    "observe that the coefficient of degree @xmath229 in @xmath230 is the total weight of the set of forest with exactly @xmath229 roots . since @xmath231 we get , @xmath232}\\prod_{i\\in i}\\lambda_i\\\\ & = \\sum_{i\\in \\mathcal{p}[n - k]}\\left[\\prod_{i\\in i}\\left(\\frac{\\lambda_i}{q+\\lambda_i}\\right)\\right ] \\left[\\prod_{j\\notin i}\\left(\\frac{q}{q+\\lambda_j}\\right)\\right]\\\\ & = \\sum_{j\\in \\mathcal{p}[k ] } \\left[\\prod_{j\\in j}\\left(\\frac{q}{q+\\lambda_j}\\right)\\right ] \\left[\\prod_{i\\notin j}\\left(1-\\frac{q}{q+\\lambda_i}\\right)\\right ] , \\end{aligned}\\ ] ] where @xmath233 $ ] stands for the set of all possible @xmath229 elements of the set @xmath234 .",
    "* remark : * when the spectrum of @xmath111 does contain a non - real part , one can still compute the law of @xmath228 and get the same algebraic expressions in terms of the eigenvalues .",
    "one can also compute momenta by differentiating with respect to @xmath78 the logarithm of the partition function .",
    "in particular , the mean value and the variance are given by @xmath235 = \\sum_{i = 0}^{n - 1 } \\frac{q}{q + \\lambda_i } ,     \\label{swizzera}\\\\ & { \\mathbb v}\\!{\\rm ar}_q(|\\rho(\\phi)| ) = \\sum_{i = 0}^{n - 1 } \\frac{q}{q + \\lambda_i } - \\left(\\frac{q}{q + \\lambda_i}\\right)^2.\\end{aligned}\\ ] ] we note however that the contribution of the imaginary part of the eigenvalues can make uneasy the comparison between variance and mean value , at least for small values of @xmath78 .",
    "this is the reason why , when dealing with the question of getting samples with a number of roots that approximates a given @xmath83 , we will restrict ourselves to the real spectrum case .",
    "next , we prove that under @xmath72 the set of roots @xmath236 is a determinantal process as suggested after @xcite by the previous result .",
    "this is the content of theorem [ determinantalroots ] for which we will present an algebraic and a probabilistic proof .",
    "let us first show a simple lemma . consider the markov process @xmath160 on @xmath237 defined via its generator in .",
    "let @xmath238 be the hitting time of @xmath239 .",
    "denote by @xmath240 the last point visited by the process @xmath169 before time @xmath238 .",
    "let @xmath81 be the transition matrix defined by @xmath241 this transition kernel can also be expressed in terms of green s functions :    [ greenkernel ] for @xmath242 , let @xmath243=(q - l)^{-1}(x , y)\\ ] ] be the green s function of the process @xmath169 on the subspace @xmath244 .",
    "then @xmath245    we use the notation of section [ marchal ] to work in time .",
    "set @xmath246 , @xmath247 , @xmath248 and write @xmath249\\frac{q(y)}{\\bar{\\alpha } } = g_{\\delta}(x , y)q(y ) .",
    "\\end{aligned}\\ ] ]    note that , in the standard case @xmath211 , we can write @xmath250 with @xmath251 being an independent exponential random variable of parameter @xmath78 . in particular ,",
    "if @xmath252 $ ] is the green s function up to time @xmath251 , then @xmath253    [ determinantalroots]*(determinantal roots ) * under @xmath71 with finite killing rates ( i.e. @xmath254 ) , the set of roots in @xmath36 is a determinantal process with kernel @xmath81 defined in .",
    "equivalently , for any @xmath255 : @xmath256 more generally , if @xmath257 , @xmath236 is still a determinantal process on @xmath258 with kernel @xmath81 , that is : @xmath259    * ( algebraic proof of thm [ determinantalroots ] ) * assume first @xmath254 .",
    "consider a set @xmath255 with @xmath260 of the form @xmath261 . by choosing the different points in @xmath82 as starting point at each iteration in wilson s algorithm , by , we get @xmath262\\frac{{\\rm det}_{a^c}(q - l)}{{\\rm det}_{\\mathcal{x}}(q - l)}\\\\ & = \\frac{{\\rm det}_{a^c}(q - l)}{{\\rm det}_{\\mathcal{x}}(q - l)}\\displaystyle{\\rm det}_{a}(q ) . \\end{aligned}\\ ] ] in case @xmath263 , the claim is straightforward since equation reads @xmath264 and the r.h.s .",
    "equals @xmath265 due to lemma [ greenkernel ] .    in case @xmath266",
    ", we can use the schur complement ( see in appendix [ schur ] ) to show that @xmath267 therefore , from equation , we have that @xmath268 where the second to the last equality is justified because @xmath46 is a diagonal matrix and the last equality follows from .",
    "when @xmath269 , the proof is the same .",
    "we just have to subtract from the various considered sets .    *",
    "( probabilistic proof of thm [ determinantalroots ] ) * to avoid a heavy notation , we consider only the case @xmath254 .",
    "starting from the markov process @xmath2 and the killing rates @xmath270 , we construct two different absorbing states @xmath271 and @xmath272 accessible from the set @xmath82 and @xmath273 , respectively .",
    "set @xmath274 .",
    "let @xmath107 be the markov process with generator @xmath275\\\\ & + q(x)\\mathbbm{1}_{\\{x\\in a^c\\}}[f(\\delta_{a^c})-f(x ) ] , \\quad \\text { if } x\\in \\mathcal{x } ,   \\end{aligned}\\ ] ] and @xmath276 if @xmath277 with @xmath118 and @xmath111 as in .",
    "next , consider the subspace @xmath278 .",
    "let @xmath279 be the markov process with state space @xmath280 obtained as the trace of the process @xmath107 on @xmath280 .",
    "let us remark two features of wilson s algorithm .",
    "first , wilson s algorithm can be extended to the case of a state space with more than one absorbing state . in this case",
    "it produces a rooted spanning forest instead of a tree .",
    "second , wilson s algorithm is uniquely determined once we fix a state space with some absorbing set and a markov generator .",
    "these observations justify the following definitions .",
    "let @xmath281 be the set of ending points of the edges starting from @xmath82 after running wilson algorithm on @xmath282 with absorbing state @xmath162 and generator @xmath283 .",
    "similarly let @xmath284 associated in the same way with @xmath82 , when wilson s algorithm is run on @xmath285 with absorbing set @xmath286 and generator @xmath287 .",
    "observe at this point that @xmath288 and , by using proposition [ marchal ] , compute @xmath289_a\\right)^{-1}\\right){\\rm det}_{a}(q)\\\\ & = { \\rm det}_a\\left(g^{\\bar{\\bar{a}}}_{\\{\\delta_a,\\delta_{a^c}\\}}\\right){\\rm det}_{a}(q ) , \\end{aligned}\\ ] ] where @xmath290 denotes the green s function of the process @xmath279 stopped when entering the absorbing states @xmath291 .",
    "note now that for @xmath292 , @xmath293 with @xmath294 and @xmath295 being the green s function of the process @xmath169 in . finally , since @xmath296 for @xmath297 , the claim follows by combining equations and .     on the one - dimensional torus",
    "our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]   on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]     on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure .",
    "here are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]   on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure .",
    "here are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]     on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]   on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]     on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]   on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]     on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]   on the one - dimensional torus our determinantal process is distributed like a simple gas of particles with a repulsive `` nearest - neighbour two - body interaction '' that is quite easily detected by comparison with a bernoulli product measure . here",
    "are samples of our roots set ( first line of each picture ) and of the product measure ( second line ) with exactly 6 , 12 , 18 , 24 , 30 , 36 , 42 , 48 , 54 and 60 roots or points , respectively .",
    ", title=\"fig : \" ]     on the two dimensional torus , the difference between the law of our roots set and that of a bernoulli product measure is far too subtle to be detected on a single sample . walking away from translation invariant models , we can find much more correlations . here",
    "are pictures of a sample on the two - dimensional torus with uniform rates equal to 1 and @xmath298 ( on the left ) , and of a sample associated with the metropolis random walk on the square grid in a brownian sheet potential with inverse temperature @xmath299 and extinction rate @xmath300 ( on the right ) .",
    ", title=\"fig : \" ]   on the two dimensional torus , the difference between the law of our roots set and that of a bernoulli product measure is far too subtle to be detected on a single sample . walking away from translation invariant models , we can find much more correlations .",
    "here are pictures of a sample on the two - dimensional torus with uniform rates equal to 1 and @xmath298 ( on the left ) , and of a sample associated with the metropolis random walk on the square grid in a brownian sheet potential with inverse temperature @xmath299 and extinction rate @xmath300 ( on the right ) .",
    ", title=\"fig : \" ]      in this section we answer the question raised in the introductory section [ chessboard ] . to this end",
    ", we focus on hitting times of a given subset @xmath301 , i.e. , @xmath302 . in appendix",
    "[ wentzell ] , lemma [ wentzellthm ] , we derive , in terms of our measures , a result originally due to freidlin and wentzell , see lemma 3.3 in  @xcite , which allows to give a formula for @xmath303 $ ] . in this section , with the help of lemma [ wentzellthm ] ,",
    "we compute the expectation @xmath303 $ ] when @xmath9 is the set of roots sampled from @xmath199 , or @xmath304 for any given @xmath20 .",
    "[ hittingrootsthm]*(hitting - time formulas ) * let @xmath71 be the forest probability measure defined in . then",
    ", for any @xmath305 , @xmath306\\right ] = \\displaystyle\\sum_{y\\in\\mathcal{x}}\\frac{1}{q(y)}\\left[{\\mathbb p}_q\\left(\\rho\\left(\\tau_\\phi(x)\\right)=\\{y\\}\\right)-{\\mathbb p}_q(\\rho(\\phi)=\\{y\\})\\right],\\ ] ] with @xmath307 being the unique tree in @xmath68 containing @xmath26 . in the standard case",
    ", @xmath211 , equation reduces to @xmath308\\right ] = \\frac{1}{q}\\left[1-{\\mathbb p}_q\\left(|\\rho(\\phi)|=1\\right)\\right]=\\frac{1}{q}\\left(1-\\prod_{i = 1}^{n - 1 } \\frac{\\lambda_i}{q + \\lambda_i}\\right).\\ ] ] moreover , for @xmath309 and any @xmath305 , @xmath310\\mid \\ , |\\rho(\\phi)|=m\\right]=\\frac{{\\mathbb p}_q(|\\rho(\\phi)|=m+1)}{q{\\mathbb p}_q(|\\rho(\\phi)|=m)}.\\ ] ]    * remark : * notice , that the r.h.s . in ( [ conditionedhittingroots ] ) can simply be expressed as the ratio between two successive coefficients of the characteristic polynomial of the generator @xmath111 .",
    "observe first that under @xmath71 , the probability of sampling a given set @xmath301 as set of roots can be written as @xmath311 with @xmath312 as in . by using equation together with",
    ", we have that @xmath313&= \\displaystyle\\sum_{r \\neq \\emptyset}{\\mathbb p}_q(\\rho(\\phi)=r)e_x[t_r]\\\\ & = \\displaystyle\\sum_{r \\neq \\emptyset : \\ :",
    "r \\supset s}\\frac{{\\rm det}_{r\\setminus s}(q)}{z_q } \\displaystyle\\sum_{y\\notin r}\\sum _ {      \\stackrel{\\scriptstyle\\phi:\\rho(\\tau_\\phi(x))=\\{y\\ } , }          { \\scriptstyle\\rho(\\phi)=r\\cup\\{y\\ } } } w(\\phi)\\\\ & = \\frac{1}{z_q } \\displaystyle\\sum_{y\\notin s } \\displaystyle\\sum _ {      \\stackrel{\\scriptstyle r \\neq \\emptyset : \\ : r \\supset s }          { r\\not\\ni y } } \\displaystyle\\sum _ {      \\stackrel{\\scriptstyle\\phi:\\rho(\\tau_\\phi(x))=\\{y\\ } , }          { \\scriptstyle\\rho(\\phi)=r\\cup\\{y\\ } } } \\frac{w_q(\\phi)}{q(y)}\\\\ & = \\frac{1}{z_q}\\displaystyle\\sum_{y\\notin s}\\left[\\displaystyle\\sum_{\\phi:\\rho(\\tau_\\phi(x))=\\{y\\}}\\frac{w_q(\\phi)}{q(y ) } -\\sum_{\\phi:\\rho(\\phi)=\\{y\\}}\\frac{w_q(\\phi)}{q(y)}\\right]\\\\ & = \\displaystyle\\sum_{y\\notin s}\\frac{1}{q(y)}\\left[{\\mathbb p}_q(\\rho(\\tau_\\phi(x))=\\{y\\})-{\\mathbb p}_q(\\rho(\\phi)=\\{y\\})\\right ] .",
    "\\end{aligned}\\ ] ] the restriction of summing over @xmath314 can be removed , since @xmath315 for @xmath316 . hence holds and readily follows when @xmath211 .",
    "the proof of follows by an analogous computation .",
    "note that the r.h.s . of and is uniform in the starting point @xmath26 .",
    "this latter observation allows to answer the questions in the introduction .",
    "in fact , no matter of the geometry of the graph and the weights we are considering , we can take random subsets @xmath317 with law @xmath318 and the formula in equation says that the hitting times do not dependent on the starting point @xmath26 .    to practically obtain a sample from @xmath199 with approximately @xmath83 roots",
    "when @xmath111 has only real eigenvalues , one can use wilson s algorithm and play with the parameter @xmath78 as follows ( see figure [ yo ] ) . if @xmath78 is such that @xmath319 one has an expected number of @xmath20 roots with fluctuations of order @xmath21 or smaller ( see corollary  [ bernoullicity ] ) . in principle one should compute the eigenvalues of @xmath111 , which is in general difficult for large @xmath44 , and then solve equation ( [ albicocca ] ) in @xmath78 . to overcome this obstacle ,",
    "a possible alternative procedure is the following :    1 .",
    "start with any positive @xmath78 and run wilson s algorithm with this parameter to get a sample from @xmath199 with a certain number @xmath320 of roots .",
    "2 .   replace @xmath78 by @xmath321 and run again wilson s algorithm with this new parameter to get a new sample with another number of roots , say @xmath320 again .",
    "3 .   iterate the previous step until a sample with @xmath320 roots satisfying @xmath322 is obtained .    as a matter of fact",
    ", @xmath323 rapidly converges to the solution of ( [ albicocca ] ) , hence the algorithm rapidly reaches an end . since we believe this procedure to be quite far from an optimal one , we are only sketchy on this point .",
    "we sampled approximatively 100000 , 10000 , 1000 and 100 roots on the @xmath201 grid for the random walk in a brownian sheet potential with inverse temperature @xmath208 by following the procedure described in section  [ hittingtimes ] .",
    "we obtained 100443 , 10032 , 1042 and 111 roots in 8 , 6 , 6 and 8 iterations , respectively .",
    ", title=\"fig : \" ] we sampled approximatively 100000 , 10000 , 1000 and 100 roots on the @xmath201 grid for the random walk in a brownian sheet potential with inverse temperature @xmath208 by following the procedure described in section  [ hittingtimes ] .",
    "we obtained 100443 , 10032 , 1042 and 111 roots in 8 , 6 , 6 and 8 iterations , respectively .",
    ", title=\"fig : \" ]     we sampled approximatively 100000 , 10000 , 1000 and 100 roots on the @xmath201 grid for the random walk in a brownian sheet potential with inverse temperature @xmath208 by following the procedure described in section  [ hittingtimes ] .",
    "we obtained 100443 , 10032 , 1042 and 111 roots in 8 , 6 , 6 and 8 iterations , respectively .",
    ", title=\"fig : \" ] we sampled approximatively 100000 , 10000 , 1000 and 100 roots on the @xmath201 grid for the random walk in a brownian sheet potential with inverse temperature @xmath208 by following the procedure described in section  [ hittingtimes ] .",
    "we obtained 100443 , 10032 , 1042 and 111 roots in 8 , 6 , 6 and 8 iterations , respectively .",
    ", title=\"fig : \" ]    we conclude this section with an estimate on the mean hitting times above when taking the maximum over the starting points @xmath26 .",
    "[ maxhittingrootsthm]*(max hitting - time estimates ) * under the standard measure @xmath199 , the following bound holds @xmath324\\right]\\leq   \\frac{1}{q}\\left[{\\mathbb e_q}\\left[|\\rho(\\phi)|\\right]-{\\mathbb p_q}(|\\rho(\\phi)|=1)\\right]=\\frac{1}{q}\\left(\\sum_{i = 0}^{n - 1 } \\frac{q}{q + \\lambda_i } - \\prod_{i = 1}^{n - 1 } \\frac{\\lambda_i}{q + \\lambda_i}\\right).\\ ] ] furthermore , for any @xmath325 , we have the estimate @xmath326\\mid \\ , |\\rho(\\phi)|=m\\right]\\leq   \\frac {      ( m+1){\\mathbb p}_q \\left (          |\\rho(\\phi)| = m + 1      \\right ) } {      q { \\mathbb p}_q \\left (          |\\rho(\\phi)| = m       \\right ) }     .\\ ] ]    as we remarked before , wilson s algorithm works also when considering more than one absorbing state .",
    "denote by @xmath327 the running time of wilson s algorithm ( i.e. the total running time of the loop erased random walks needed to cover the whole graph ) when the absorbing states form a non - empty subset @xmath9 of @xmath3 ( this amounts to sample @xmath328 ) . it can be shown ( see e.g.  @xcite , proposition 1 ) that the mean running time can be expressed in spectral terms as @xmath329 , with @xmath330 being the eigenvalues of the operator @xmath331_{r^c}$ ] , the sub - markovian generator associated with the process absorbed in @xmath9 when these eigenvalues are real .",
    "the same holds in the case of complex eigenvalues by defining `` the sum of exponential variables '' through its laplace transform and the same algebraic formula as in the real case . ] .",
    "note at this point that we can overestimate the l.h.s . of by the expectation of @xmath332 .",
    "hence , using ( [ lucien ] ) and looking at the coefficient of degree 1 in @xmath333 , @xmath334\\right ] & \\leq { \\mathbb e_q}\\left[t^{wil}_{\\rho(\\phi)}\\right]= { \\mathbb e_q}\\left[\\sum_{i=0}^{|\\rho(\\phi)|-1}\\frac{1}{\\lambda_{i,\\rho(\\phi)}}\\right ] = \\displaystyle\\sum_{r \\neq \\emptyset}\\frac{z_{r}(0)}{z(q)}q^{|r|}\\sum_{i=0}^{|r|-1}\\frac{1}{\\lambda_{i , r } } \\\\&=\\frac{1}{z(q)}\\displaystyle\\sum_{r\\neq \\emptyset}q^{|r|}\\sum_{\\phi:\\rho(\\phi)\\supset r , |\\rho(\\phi)|=|r|+1}\\frac{w_{q , r}(\\phi)}{q } \\\\&=\\frac{1}{qz(q)}\\sum_{k=1}^n\\sum_{r : |r|=k}\\sum_{\\phi:\\rho(\\phi)\\supset r , |\\rho(\\phi)|=k+1}q^{|r|}w_{q , r}(\\phi ) \\\\&=\\frac{1}{qz(q)}\\sum_{k=1}^n\\sum_{\\phi:|\\rho(\\phi)|=k + 1}w_q(\\phi)(k+1 ) \\\\&=\\frac{1}{q}\\sum_{\\phi:|\\rho(\\phi)|\\geq 2}\\frac{w_q(\\phi)|\\rho(\\phi)|}{z(q ) } , \\end{aligned}\\ ] ] and the latter equals the r.h.s . of . the bounds in follows by a similar argument .",
    "* remark : * we expect these estimates to be good either when @xmath78 is very small or very large , or when @xmath20 is close to @xmath335 or @xmath44 . improving them in the intermediate regime seems a challenging problem we were not able to solve .      throughout this section we work with the markov process @xmath2 on @xmath3 in , _ under the assumption that @xmath2 is reversible with respect to some probability measure @xmath336 on @xmath3 _ , i.e. , @xmath111 is a self - adjoint operator in @xmath337 endowed with the inner product @xmath338 for @xmath339 , possibly @xmath340 , we turn the points of @xmath9 into `` absorbing points '' by adding infinite weight edges towards a cemetery @xmath162 and we assume the resulting markov process with sub - markovian generator @xmath331_{r^c}$ ] to be irreducible .",
    "we denote by @xmath341 , with @xmath342 , the eigenvalues of @xmath343_{r^c}$ ] , and following  @xcite , we define , for each @xmath26 in @xmath344 , a sequence of _ local equilibria _ by setting @xmath345_{r^c } + \\lambda_{k , r}}{\\lambda_{k , r } } , \\quad 1 \\leq k \\leq l - 1 .",
    "\\label{acqua_di_rosa}\\end{aligned}\\ ] ] theorem  3.2 in  @xcite is a statement on symmetric matrices that in our setting can be stated as follows .    *",
    "( micchelli and willoughby  @xcite)*[macine ] fix an arbitrary @xmath7 , for all @xmath346 , @xmath347 in equation is a non - negative measure .    in this section",
    "we give a proof of this theorem following the key steps of micchelli and willoughby s algebraic proof , however , unlike the original proof , we develop probabilistic or combinatorial arguments .    before starting the proof",
    "we note , following  @xcite , that equation ( [ acqua_di_rosa ] ) can be rewritten as @xmath348_{r^c } = \\lambda_{k , r } ( \\nu_{k - 1 } - \\nu_k),\\ ] ] which gives the following interpretation .",
    "the process leaves the measure , or `` state '' , @xmath347 at rate @xmath349 to be absorbed in @xmath9 or to decay into @xmath350 .",
    "provided that @xmath347 and @xmath350 are indeed non - negative measures , this can be turned into a rigorous mathematical statement  @xcite .",
    "then , by looking at the different decay times up to an exponential time @xmath251 that is independent from the process , and by observing that , by hamilton - cayley theorem , the process leaves the state @xmath351 at rate @xmath352 only to be absorbed in @xmath9 , we get , for all @xmath26 and @xmath203 in @xmath344 , @xmath353 the left hand side in ( [ lampo ] ) is the probability to have @xmath354 when @xmath36 is sampled from @xmath355 .",
    "then , multiplying by @xmath356 ( recall ( [ lucien ] ) ) , dividing by @xmath78 , and denoting the result by @xmath357 , we can rewrite as @xmath358_{r^c}^{-1}(x , y ) \\label{nodo } \\\\ & = & \\frac{1}{q } \\sum _ {      \\stackrel{\\scriptstyle \\phi : \\ : \\rho(\\tau_\\phi(x ) ) = \\{y\\ } }       { \\scriptstyle \\rho(\\phi ) \\supseteq r } } q^{|\\rho(\\phi)| - |r| } w(\\phi ) \\label{capello } \\\\ & =   & ( q + \\lambda_{0 , r } ) \\cdots ( q + \\lambda_{l - 2 , r } ) \\nu^x_{l - 1}(y ) \\nonumber\\\\ & & + ( q + \\lambda_{0 , r } ) \\cdots ( q + \\lambda_{l - 3 , r } ) \\lambda_{l - 1 , r}\\nu^x_{l - 2}(y ) \\nonumber\\\\ & & + \\cdots + ( q + \\lambda_{0 , r } ) \\lambda_{l - 1 , r } \\lambda_{l - 2 , r}\\cdots \\lambda_{2 , r } \\nu^x_{1}(y ) \\nonumber\\\\ & & + \\lambda_{n - 1 , r } \\cdots \\lambda_{1 , r } \\nu^x_0(y ) .",
    "\\label{capra}\\end{aligned}\\ ] ] next , by density and continuity , we can restrict ourselves to the case of distinct eigenvalues , and equation suggests , for @xmath346 , the following relation for the divided differences ( see definition [ divdiff3 ] in appendix [ divideddiff ] ) of @xmath359 : @xmath360(x , \\cdot ) = \\lambda_{l-1 , r } \\cdots \\lambda_{k + 1 , r } \\nu^x_k = \\delta_x \\prod_{i = k + 1}^{l - 1 } ( [ l]_{r^c } + \\lambda_{i , r}),\\ ] ] that is @xmath361 = \\prod_{i = k + 1}^{l - 1 } ( [ l]_{r^c } + \\lambda_{i , r}).\\ ] ] we can now start to follow the main steps of micchelli and willoughby s proof",
    ".    * step 1 : checking equation ( [ cavolo ] ) .",
    "* we simply use definition [ divdiff2 ] and spectral decomposition . with @xmath362 being the right eigenvector associated with @xmath363 , and , for any measure",
    "@xmath364 , @xmath365 , we have , recalling ( [ nodo ] ) , for any @xmath78 , @xmath366this gives @xmath367 & =   \\sum_{r=0}^k\\frac{\\nu w_r(-\\lambda_{r , r})}{\\prod_{m\\neq r}(\\lambda_{m , r}-\\lambda_{r , r})}=   \\sum_{r=0}^k \\sum_{j=1}^{l-1 } \\langle \\mu_j,\\nu\\rangle \\frac{\\prod_{i\\neq j}(\\lambda_{i , r}-\\lambda_{r , r})\\mu_j}{\\prod_{m\\neq r}(\\lambda_{m , r}-\\lambda_{r , r})}\\\\ & = \\sum_{r=0}^k \\langle \\mu_r,\\nu\\rangle \\frac{\\prod_{i\\neq j}(\\lambda_{i , r}-\\lambda_{r , r})\\mu_r}{\\prod_{m\\neq r}(\\lambda_{m , r}-\\lambda_{r , r})}= \\sum_{r=0}^k \\langle \\mu_r,\\nu\\rangle \\prod_{i = k+1}^{l-1}(\\lambda_{i , r}-\\lambda_{r , r})\\mu_r\\\\ & = \\sum_{r=0}^{l-1 } \\langle \\mu_r,\\nu\\rangle \\prod_{i = k+1}^{l-1}(\\lambda_{i , r}-\\lambda_{r , r})\\mu_r=\\nu \\prod_{i = k+1}^{l-1}([l]_{r^c}+\\lambda_{i , r } ) \\end{aligned}\\ ] ] and equation readily follows .    * step 2 : a combinatorial identity . * the key point of the proof lies in the following lemma .",
    "[ mw2 ] for any @xmath368 in @xmath369 , @xmath370 in addition one has @xmath371    let us first consider the case @xmath368 .",
    "due to , we have that @xmath372 we also have @xmath373 and @xmath374 next , define for each @xmath36 in ( [ w1 ] ) , @xmath375 if @xmath376 belongs to @xmath36 , and @xmath377 if @xmath26 is connected in @xmath36 to @xmath203 through @xmath378 and @xmath379 ( possibly with @xmath380 ) in such a way that @xmath381 and @xmath382 belong to @xmath36 . finally , by observing that @xmath383 and @xmath384 , is obtained from , and",
    ". then , equation ( [ mirtillo ] ) follows from ( [ w1 ] ) for @xmath385 .    * step 3 : conclusion by induction with cauchy interlacement theorem . * for @xmath386 ,",
    "let @xmath387 $ ] be the following statement :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ for all @xmath388 such that @xmath389 , for all @xmath390 , for all @xmath391 such that @xmath392 for all @xmath393 , for all @xmath394 , and for all @xmath395 : @xmath396(x , y ) \\geq 0.\\ ] ] _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we can proceed inductively to show that @xmath387 $ ] holds .    for @xmath397 ,",
    "the claim is obvious .",
    "fix @xmath398 . in the case",
    "@xmath399 , the inductive hypothesis is unnecessary .",
    "indeed , from ( [ mirtillo ] ) , one has @xmath396(x , x )   = z_{r \\cup \\{x\\}}[\\xi_0 , \\dots , \\xi_k].\\ ] ] then note that , by cauchy interlacement theorem , @xmath392 implies that @xmath400 for @xmath401 , and hence , by lemma [ divdif ] , we get @xmath396(x , x ) \\geq 0.\\ ] ] when @xmath402 , @xmath387 $ ] follows in the same way by using ( [ wxy ] ) and the inductive hypothesis .",
    "we can finally conclude the proof of theorem  [ macine ] .",
    "it suffices to apply the claim with @xmath403 for all @xmath393 and recall ( [ cavolo ] ) or ( [ bruxelles ] ) .      in this section",
    "we present two coalescence and fragmentation processes closely related with our forest measures .      to build the first process",
    ", we couple all the @xmath199 s together for different @xmath78 s .",
    "this coupling can be seen as a coalescence and fragmentation process when @xmath78 decreases to @xmath404 and @xmath405 is thought as time .",
    "we make use of wilson s original representation of his algorithm with `` site - indexed random paths '' .",
    "assume that , to each site of the graph , is attached an infinite list / collection of arrows pointing towards one neighbour , and that these arrows are independently distributed according to the discrete skeleton transition probabilities . in other words ,",
    "an arrow , pointing towards the neighbour @xmath203 of a site @xmath26 , appears at each level in the list associated with @xmath26 with probability @xmath406 ( in this context , we set @xmath407 , and consider @xmath26 itself as one of its possible neighbours ) .",
    "imagine that each list of arrows attached to a site is piled down in such a way that it make sense to talk of an infinite stack with an arrow on the top of this stack . by using this representation",
    ", one can generate the random walk on the graph as follows . at each jump time , the random walk steps to the neighbour pointed by the arrow on the top of the stack where the walker is sitting , and the top arrow is erased from the stack .    to describe wilson s",
    "algorithm one has to introduce a further ingredient : pointers to the absorbing state @xmath162 in each stack .",
    "such a pointer should appear with probability @xmath408 at each level in the list .",
    "one way to introduce it is by generating independent uniform random variables @xmath409 together with each original arrow in the stack , and by replacing the latter by a pointer to the absorbing state whenever @xmath410 .",
    "a possible description of wilson s algorithm is then the following .",
    "* start with a particle on each site , particles and sites will be divided into active and frozen particles or sites and , at the beginning , all sites and particles are declared to be active . *",
    "choose a particle among all the active ones and look at the arrow at the top of the stack it is seated on .",
    "call @xmath26 the site where the particle is seated . * * if the arrow is the pointer towards @xmath162 , declare the particle to be frozen and site @xmath26 as well . * * if the arrow points towards another site @xmath411 , remove the particle and keep the arrow . * * if the arrow points to @xmath26 itself , remove the arrow .",
    "* once again , choose a particle among all the active ones , look at the arrow on the top of the stack it is seated on , and call @xmath26 the site where the particle is seated . * * if the arrow points to @xmath162 , the particle is declared to be frozen , and so are declared @xmath26 and all the sites eventually leading to @xmath26 by following discovered top pile arrows paths . * * if the arrow points to a frozen particle or site , remove the particle , keep the arrow , and freeze site @xmath26 as well as any site eventually leading to @xmath26 by following discovered top pile arrows paths . * * if the arrow points to an active , then there are two possibilities . by following the arrows at the top of the stacks , we either reach a different active particle , or runs in a loop back to @xmath26 . in the former case ,",
    "remove the chosen particle from site @xmath26 and keep the discovered arrow . in the latter ,",
    "erase all the arrows along the loop and set an active particle on each site of the loop .",
    "note that this last case includes the possibility for the discovered arrow of pointing to @xmath26 itself , in which case , we just have to remove the discovered arrow .",
    "* iterate the previous steps up to exhaustion of the active particles .",
    "the crucial observation is that , no matter of the choice of the particles at the beginning of the steps , when this algorithm stops , the same arrows are erased and the same spanning forest with a frozen particle at each root is obtained .",
    "in particular , by choosing at each step the last encountered active particle , or the same as in the previous step when we just erased a loop , we perform a simple loop - erased random walk up to freezing .",
    "since @xmath199 is sampled in this way , and the same uniform variables @xmath409 can be used for each  @xmath78 , this provides a coupling among all the @xmath199 s . by means of this coupling , one can actually sample @xmath412 starting from a sample of @xmath199 for @xmath413 .",
    "let us now explain this fact .",
    "note first that , running this algorithm for sampling @xmath412 , one can reach at some point the final configuration obtained for @xmath199 with the only difference that some frozen particles of the final configuration obtained with parameter @xmath78 can still be active at this intermediate step of the algorithm run with @xmath414 .",
    "it suffices , indeed , to choose the sequence of active particles in the same way with both parameters .",
    "this is possible since each pointer to @xmath162 in the stacks with parameter @xmath414 is associated with a pointer to @xmath162 at the same level in the stacks with parameter @xmath78 .",
    "thus we just have to replace some frozen particle of the configuration sampled with @xmath199 and continue the algorithm with parameter @xmath414 to sample @xmath412 . to do so , it suffices to declare active each frozen particle at site @xmath26 with probability @xmath415 then , at the top of the stack set an arrow that points toward @xmath203 with probability @xmath406 , and to keep @xmath26 frozen with probability @xmath416 .",
    "when @xmath78 continuously decreases , we obtain a coalescence - fragmentation process @xmath417 such that @xmath418 is distributed according to @xmath419 at all time @xmath420 , and in which each tree can fragment and partially coalesce with the other trees of the forest .",
    "when a root of a tree turns active , the tree is eventually fragmented into a forest , some trees of which being possibly  grafted \" on the previous frozen trees .",
    "it is worth noting that , by , the mean number of trees is decreasing along this coalescence process @xmath417 .",
    "the previous observations show that we can sample the `` finite dimensional distributions '' of the process , i.e. the law of @xmath421 for any choice of @xmath422 .",
    "we can actually sample whole trajectories @xmath423 for any finite @xmath424 .",
    "in fact , note first that at each time @xmath425 , the next frozen particle ( or root ) becoming active is uniformly distributed among all the roots , and the time @xmath426 when it  wakes up \" is such that the variable @xmath427 has the law of the maximum of @xmath20 independent uniform variables on @xmath428 , with @xmath20 being the number of roots at time @xmath420 . since , for all @xmath429 , @xmath430 @xmath206 has the same law as @xmath431 , with @xmath409 uniform on @xmath432 .",
    "using ( [ savona ] ) we can then sample @xmath426 by setting @xmath433    summing up , in order to sample the whole trajectory it suffices to proceed as follows once @xmath417 is sampled at a given jump time @xmath420 :    * choose uniformly a root @xmath26 . *",
    "sample the next jump time @xmath426 from a uniform random variable @xmath409 on @xmath432 , by using ( [ cornice ] ) .",
    "* restart the algorithm with parameter @xmath434 by declaring active the particle in @xmath26 and putting an arrow to @xmath203 with probability @xmath435 .",
    "snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]     snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]     snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]     snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]   snapshots of the coalescence and fragmentation process in section [ q_coupling ] associated with a simple random walk on the two - dimensional torus of size @xmath201 at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 .",
    "roots are red , non - root vertices at the border of trees are cyan , other vertices are in blue .",
    ", title=\"fig : \" ]     snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]     snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 .",
    ", title=\"fig : \" ]     snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 .",
    ", title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]     snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]   snapshots at times @xmath405 equal to 0 , .5 , 2 , 8 , 32 , 128 , 512 ,  , 524288 of the coalescence and fragmentation process on the square grid of size @xmath201 for the random walk in a brownian sheet potential with inverse temperature @xmath299 . , title=\"fig : \" ]     numbers of trees as a function of time for the coalescence and fragmentation processes in figures  [ farfalla ] and  [ lampada ] in loglog scale . ]",
    "we conclude by observing that @xmath417  crosses \" almost surely all the manifolds @xmath436 .",
    "indeed , by ( [ swizzera ] ) , it starts from @xmath437 and reaches @xmath438 almost surely , and , each time the number of roots decreases , it does so by only 1 unit : when the  activated \" tree fragments into trees that coalesce only with the previously frozen ones . with @xmath439 , it is also simple to sample @xmath440 .",
    "we note however that @xmath440 is not distributed according to @xmath441 .",
    "the other dynamics we want to mention is a simple variant of the tree random walk introduced in  @xcite to prove the so called markov chain tree theorem . for fixed @xmath78 ,",
    "the dynamics we now present is another coalescence and fragmentation process for which the standard measure @xmath199 is the stationary probability measure .",
    "remind that for a given forest @xmath32 and @xmath305 , we denote by @xmath442 the unique tree in @xmath36 containing @xmath26 , and note that if @xmath196 then @xmath443 .",
    "our dynamics can then be defined as follows . 1    * ( forest dynamics ) * [ rootdynamics ] fix @xmath444 .",
    "let @xmath445 be the markov process with state space @xmath31 characterized by the following generator acting on functions @xmath446 : @xmath447,\\ ] ] where the transition rate @xmath448 and the new state @xmath449 are defined as follows :    1 .",
    "[ add]if @xmath196 and @xmath450 , then @xmath451 and @xmath452 .",
    "[ swap]if @xmath196 and @xmath453 , then @xmath451 and @xmath454 , with @xmath455 being the unique edge in @xmath36 such that @xmath456 .",
    "3 .   [ remove]if @xmath457 , then @xmath458 and @xmath459 .",
    "4 .   @xmath460 else .",
    "the rules corresponding to 1 , 2 and 3 can be rephrased by saying that we _",
    "add , swap _ and _ remove _ a bond from the forest @xmath36 , respectively .",
    "notice that such a dynamics induces a non - conservative dynamics on the set of roots .",
    "in particular , when transition 1 occurs , @xmath461 and two trees merge into one . on the other hand ,",
    "when transition 3 occurs , @xmath462 and the tree containing @xmath93 is fragmented into two trees where the new appearing root is at @xmath463 .",
    "transitions of type 2 produce a rearranging in one of the tree .",
    "they leave invariant the cardinality of the set of roots but the location of the root in the modified tree is relocated at the vertex @xmath456 .",
    "[ invmeasrootdyn]*(invariance ) * for all @xmath464 the measure @xmath38 in is invariant for @xmath465 in .",
    "we need to show that for any @xmath466 @xmath467 indeed , amounts to say that for any @xmath468 @xmath469 \\\\ & = \\sum_{\\phi'\\in \\mathcal{f}}\\sum_{\\phi\\in \\mathcal{f}}w_q(\\phi ) \\sum_{e\\in\\mathcal{e } : \\phi^e= \\phi ' } \\gamma(\\phi , e)f(\\phi^e)- \\sum_{\\phi'\\in \\mathcal{f}}w_q(\\phi')\\sum_{e\\in\\mathcal{e}}\\gamma(\\phi',e)f(\\phi ' ) \\\\ & = \\sum_{\\phi'\\in \\mathcal{f}}\\big[\\sum_{\\phi\\in \\mathcal{f}}\\sum_{e\\in\\mathcal{e } : \\phi^e= \\phi ' } w_q(\\phi)\\gamma(\\phi , e)- \\sum_{e\\in\\mathcal{e } } w_q(\\phi')\\gamma(\\phi',e)\\big]f(\\phi')= 0 .",
    "\\end{aligned}\\ ] ]    for a given @xmath466 , we start by splitting the l.h.s . of in the three terms corresponding to the different transitions allowed by the dynamics in definition [ rootdynamics ] whenever @xmath470 .",
    "@xmath471 we can rewrite @xmath472 @xmath473 and , denoting , for each @xmath455 such that @xmath474 and @xmath475 , by @xmath93 the unique bond in the only one cycle of @xmath476 such that @xmath477 , with @xmath478 , @xmath479 summing @xmath480 , @xmath481 and @xmath482 together we then get ( [ invcond ] ) .",
    "* remark : * when @xmath483 we recover the anantharam and tsoukas dynamics and the proof of the markov chain tree theorem .",
    "indeed , the standard forest measure restricted to spanning trees is the invariant measure of the dynamics . starting with a single tree ,",
    "its roots follows a markovian evolution with generator @xmath111 , so that , at equilibrium , in the long time limit we have @xmath484 with @xmath336 being the stationary distribution associated to @xmath111 .",
    "we conclude with two last results concerning static properties of the standard measure @xmath199 .",
    "the first one concerns the `` rooted partition '' inherited from a forest sampled from @xmath199 .",
    "we show , as a consequence of the markov chain tree theorem , that the roots are distributed according to the restricted measures associated with the sampled partition , these restricted measures being the equilibrium measures of the restricted dynamics inside each component of the partition .",
    "our last result concerns the determinantal process @xmath485 : its cumulants are given by a nice formula it is worth to notice .      for @xmath36 in @xmath70 with roots @xmath486 ,  , @xmath487 ,",
    "let us denote by @xmath488 the partition of @xmath14 where each component @xmath489 is the set of sites spanned by @xmath490 .",
    "since each component of the partition comes with a special point corresponding to a root , we call _ rooted partition _ the pair @xmath491 we note that for each @xmath82 in @xmath492 , the _ restricted dynamics _ with generator @xmath493 ,       \\quad f : a \\rightarrow { \\mathbb r } ,      \\quad x \\in a,\\ ] ] has only one irreducible component since each @xmath26 in @xmath82 is connected with the root . as a consequence",
    "the restricted dynamics has a unique equilibrium measure which we call _ restricted measure _  @xmath494 .",
    "note that when @xmath111 has a _ reversible _",
    "equilibrium @xmath495 , then @xmath494 is nothing but the equilibrium measure @xmath336 conditioned on @xmath82 , i.e. @xmath496 .    [ localequilibria]*(roots at restricted equilibrium ) * fix @xmath497 , then @xmath498 for any partition @xmath499 of @xmath3 and any @xmath500 , for @xmath501    for each @xmath502 in @xmath503 , let us call @xmath504 the set of spanning trees of @xmath489 . for each @xmath505 in @xmath504 , define @xmath506 and for @xmath507 in @xmath489 , write @xmath508 , if @xmath507 is the root of the tree @xmath509",
    ". compute @xmath510 where the last equality follows by applied to the restricted dynamics .     a rooted partition with 50 roots ( at the center of red diamonds ) sampled for the metropolis random walk in a brownian sheet potential on the @xmath205 grid and with inverse temperature @xmath511 .",
    "blue levels depend on the potential : the lower the potential , the darker the blue .",
    "we see that each root is distributed according to the restricted equilibrium of its own piece of the partition .",
    "see also the first two pictures in figure  [ mimosa ] . ]    * remark : * when @xmath2 is reversible with respect to a measure @xmath336 , this gives a way to build the associated gaussian free field with mass @xmath512 , that is the gaussian process @xmath513 with covariance matrix @xmath514 by successive sampling of the standard measure @xmath199 .",
    "start from independent centered random variables @xmath515 with variance @xmath516 , @xmath517 , sample @xmath36 according to @xmath199 , call @xmath518 the set of vertices of @xmath98 and set @xmath519 then the random field @xmath520 has zero mean and covariance matrix @xmath521 and the rescaled partial sum @xmath522 , with @xmath523 , @xmath524 , ",
    "independent copies of @xmath520 , converges in law to @xmath417 as @xmath44 goes to infinity .",
    "indeed , for each @xmath26 and @xmath203 in @xmath3 , @xmath525 and @xmath526 are centered and one computes @xmath527      = \\sum_{a\\subset\\mathcal{x } } \\mathbb{p}\\left (          a(x ) = a(y ) = a      \\right ) \\frac{1}{\\mu(a)^2 } \\sum_{z \\in a } \\frac{\\mu(z)}{q }      = \\sum_{a\\ni x , y } \\mathbb{p}\\left (          a(x ) = a(y ) = a      \\right ) \\frac{1}{q\\mu(a ) }      .\\ ] ] on the other hand , following wilson algorithm , @xmath528 by combining it with , we conclude that @xmath529      = \\frac{k(x , y)}{q\\mu(y ) }      .\\ ] ]      let us associate with our random forests @xmath68 with law @xmath199 , the random variables @xmath530 note that they completely describe the roots process . for @xmath531 with distinct @xmath101 s , the cumulants of these random variables are defined by @xmath532 \\bigg|_{\\lambda = 0 }      .\\ ] ] these quantities are the so - called truncated correlation functions , that can also be recursively defined by @xmath533      = \\sum_{\\pi \\in { \\cal p}_a } \\prod_{b \\in \\pi } \\kappa_b(\\eta),\\ ] ] where @xmath534 stands for the set of partitions of @xmath82 .",
    "the determinantal nature of the roots process makes its cumulants easy to compute . with @xmath535 and @xmath536 being the permutation group on @xmath82 ,",
    "one has @xmath537",
    "= { \\mathbb p}\\left (          a \\subset \\rho(\\phi )      \\right ) = { \\rm det}_a(k )       = \\sum_{\\sigma \\in { \\cal s}_a } ( -1)^{{\\rm sgn}(\\sigma ) } \\prod_{x \\in a } k(x , \\sigma(x)).\\ ] ] making a cycle decomposition of each permutation in this sum and denoting by @xmath538 the set of long cycles on @xmath539 , i.e. the set of cycles of length @xmath540 in @xmath121 , after some simple algebra , we get @xmath537      = \\sum_{\\pi \\in { \\cal p}_a } \\prod_{b \\in \\pi } \\sum_{\\sigma \\in { \\cal c}_b } ( -1)^{|b| - 1 } \\prod_{x \\in b } k(x , \\sigma(x)).\\ ] ] this identifies our cumulants through ( [ luce ] ) and gives the following lemma .    for all @xmath535 @xmath541 where @xmath542 stands for the set of cycles of length @xmath543 in @xmath82 .",
    "* remark : * we can not help making the following observation . in the case of uniformly equal weights between nearest neighbours , for large @xmath78 , @xmath544 behaves like the natural low temperature partition function associated with an embedded travelling salesman problem . in this regime , on the one hand , wilson s algorithm quickly provides perfect samples of the roots process and , on the other hand , the cumulant is the expected value of some observable for the system made of @xmath44 independent copies of @xmath485  @xcite .",
    "this suggests that one could find a practical way to estimate this low temperature partition function and then solve the travelling salesman problem .",
    "unfortunately , the corresponding observable has an exponentially small probability to be different from @xmath404 and consequently , it is in reality impossible to estimate its mean in this way .",
    "assume we have a markov process @xmath107 on a finite state space @xmath108 , with generator @xmath112 given by @xmath545,\\quad y\\in \\mathcal{y},\\ ] ] with @xmath118 arbitrary and @xmath546 a given collection of non - negative and finite transition rates .",
    "as in section [ loops ] , let us denote by @xmath110 the discrete skeleton of the random walk @xmath107 with markovian transition matrix @xmath156 .",
    "fix a subset @xmath547 with @xmath548 and consider a new markov chain @xmath549 with state space @xmath82 obtained as the trace of the process @xmath110 on @xmath82 .",
    "in other words , @xmath549 is the random walk with transition matrix @xmath550 , with entries @xmath551 where @xmath552 denotes the first return time in @xmath82 of the chain @xmath110 .    back to the continuous - time setting ,",
    "denote by @xmath553 be the continuous - time version of @xmath549 with jump times given by exponential random variables of parameter @xmath554 i.e. the process with generator @xmath555 equivalently , @xmath553 is the trace of the markov process @xmath107 on @xmath82 , namely , the process obtained by following the trajectory of @xmath107 at infinite velocity outside @xmath82 and without speeding up inside @xmath82 .",
    "[ schurprob]*(schur complement and trace process ) * given the markov process @xmath107 on @xmath108 with generator @xmath112 , fix a subset @xmath547 with @xmath548 .",
    "let @xmath115 be the generator of the markov process @xmath553 obtained as the trace of the process @xmath107 on @xmath82 .",
    "then , @xmath115 is the schur complement of @xmath556_{a^c}$ ] in @xmath112 , i.e. @xmath557_a-[\\mathcal{l}]_{a , a^c}[\\mathcal{l}]^{-1}_{a^c}[\\mathcal{l}]_{a^c , a},\\ ] ] with @xmath556_a$ ] and @xmath556_{a^c}$ ] being the sub - markovian generator of the process killed outside @xmath82 and @xmath273 , respectively . in other words ,",
    "@xmath556_a$ ] and @xmath556_{a^c}$ ] represent the operators obtained from the matrix representation of @xmath283 , by deleting the row and the columns indexed by sites outside @xmath82 and @xmath273 , respectively . whereas @xmath556_{a , a^c}$ ] and @xmath556_{a^c , a}$ ] are the operators obtained from the matrix representation of @xmath283 , by keeping only those rates from @xmath82 to @xmath273 and @xmath273 to @xmath82 , respectively .",
    "denote by @xmath155_a\\in \\mathcal{m}_{k\\times k}$ ] , the sub - markovian matrix @xmath156 restricted to @xmath82 .",
    "note that @xmath155_a$ ] is different from @xmath558 .",
    "due to , for any @xmath292 , we can write      subtracting @xmath560 on both side of , we obtain that @xmath561_a -   [ \\hat{p}-\\mathbbm{1}]_{a , a^c}\\left([\\hat{p}]_{a^c}-\\mathbbm{1}_{a^c}\\right)^{-1}[\\hat{p}-\\mathbbm{1}]_{a^c , a}. \\end{aligned}\\ ] ] we then get our result by multiplying both sides by @xmath562 .    when @xmath563 contains an absorbing set @xmath121 and @xmath564 we can do the same computation with the sub - markovian generator @xmath556_{b^c}$ ] in place of @xmath283 . for any @xmath26 and @xmath203 in @xmath82 the mean local time in @xmath203 starting from @xmath26 and before hitting @xmath121 is the same for @xmath107 and the trace process @xmath553 , i.e. @xmath565 that is @xmath566_{b^c}^{-1 }      \\right]_a      = \\left (          [ { \\cal l}]_{b^c}^a      \\right)^{-1 }      .\\ ] ] more generally , one has the following definition and properties .",
    "[ schur]*(schur complement ) * let @xmath103 be a @xmath567 block matrix in @xmath43 of the form @xmath568,\\ ] ] where @xmath569 and @xmath570 , for some @xmath325 .",
    "the schur complement of @xmath281 in @xmath103 is defined as the matrix @xmath571    one can then check : @xmath572       = \\left [          \\begin{array}{cc }              i_k & bd^{-1 } \\\\              0 & i_{n - k }          \\end{array }      \\right ] \\left [          \\begin{array}{cc }              s_m(d ) & 0 \\\\              0 & d          \\end{array }      \\right ] \\left [          \\begin{array}{cc }              i_k & 0 \\\\              d^{-1}c & i_{n - k }          \\end{array }      \\right].\\ ] ] it follows that @xmath573 and , as a generalization of ( [ cubo ] ) , @xmath574.\\ ] ] in particular , from ( [ inverse ] ) and ( [ detm ] ) , @xmath575 with @xmath576 and @xmath577 .",
    "this relation is used in the algebraic proof of theorem [ determinantalroots ] .      in this section",
    "we use our forest measure analysis to prove two formulas on the hitting distribution and the expectation of hitting times of a given subset of the given graph .",
    "this result is originally due to freidlin and wentzell , see lemmas 3.2 and 3.3 in  @xcite .",
    "[ wentzellthm]*(freidlin and wentzell  @xcite ) * fix a non - empty subset @xmath9 of @xmath3 .",
    "recall the notation in . consider the markov process @xmath2 on @xmath3 identified by , and let @xmath4 be the hitting time of the set @xmath9 . then , for any @xmath578 and @xmath579 @xmath580 and , for any @xmath578 , @xmath581   = \\frac{1}{z_r(0 ) } \\sum_{y \\not\\in r } \\sum _ {      \\stackrel {          \\scriptstyle \\phi:\\rho(\\phi)=r\\cup\\{y\\ }      } {          \\scriptstyle \\rho(\\tau_x)=\\{y\\ }      } } w_(\\phi).\\ ] ]    consider the extended space @xmath174 and the extended markov process @xmath169 as in , with the killing rates as in for @xmath483",
    ". equation ( [ wilsonabsorbingset ] ) is simply obtained by considering wilson s algorithm started from @xmath26 .    to prove ( [ wentzellformula ] ) we will use the discrete skeleton of section with @xmath582 and @xmath583 . let @xmath584 \\quad\\text{and}\\quad \\hat{g}_r(x , y)= e_x[l_y(\\hat{t}_r ) ] , \\quad x , y \\in r^c,\\ ] ] be the continuous and the discrete - time green s functions before hitting the set @xmath9 , respectively .",
    "since @xmath585=\\sum_{y\\notin r}g_r(x , y),\\ ] ] it suffices to show that @xmath586 since @xmath587 with @xmath588 being the return time to @xmath203 , @xmath589}. \\end{aligned}\\ ] ] observe that @xmath590 for any @xmath591 , thus using : @xmath592}\\\\ & = \\frac {      \\frac{1 } { z_{r\\cup\\{y\\}}(0 ) }      \\sum _ {          \\stackrel {              \\scriptstyle \\phi:\\rho(\\phi)=r\\cup\\{y\\ }          } {              \\scriptstyle \\rho(\\tau_x)=\\{y\\ }          }      }      w(\\phi ) } {      \\frac{1}{z_{r\\cup\\{y\\}}(0 ) }      \\sum_{z\\neq y } \\alpha(y , z )      \\sum _ {          \\stackrel {              \\scriptstyle \\phi:\\rho(\\phi)=r\\cup\\{y\\ }          } {              \\scriptstyle \\rho(\\tau_x ) \\neq \\{y\\ }          }      }      w(\\phi ) } \\\\ & = \\frac{1}{z_r(0 ) } \\sum _ {      \\displaystyle      \\stackrel {          \\scriptstyle \\phi:\\rho(\\phi)=r\\cup\\{y\\ }      } {          \\scriptstyle \\rho(\\tau_x)=\\{y\\ }      } } w(\\phi ) .",
    "\\end{aligned}\\ ] ]      in this appendix , we recall three equivalent definitions of the notion of divided differences of a real function . we further give a lemma due to micchelli and willoughby for which we provide an alternative elementary proof which plays with these different definitions .",
    "this result is used in section [ mw ] .    *",
    "( divided differences 1 ) * we call divided difference of a function @xmath142 at the distinct points @xmath593 , @xmath486 ,  , @xmath594 , the quantity @xmath595 $ ] recursively defined via @xmath596= \\frac{f[x_1,\\cdots , x_k]-f[x_0,\\cdots , x_{k-1}]}{x_k - x_0},\\ ] ] with @xmath597=f(x_i).\\ ] ]          * ( divided differences 3 ) * for any function @xmath142 and distinct points @xmath593 , @xmath486 ,   , @xmath598 , @xmath594 , @xmath600+f[x_0,x_1](x - x_0)+f[x_0,x_1,x_2](x - x_0)(x - x_1)\\\\&+\\ldots+f[x_0,\\cdots , x_k](x - x_0)\\ldots(x - x_{k-1 } ) \\end{aligned}\\ ] ] is the unique polynomial of degree @xmath229 with @xmath601 , for @xmath602    [ divdif ] * ( micchelli and willoughby @xcite ) * consider a polynomial of degree @xmath44 of the form @xmath603 with @xmath44 distinct real zeros @xmath604 in decreasing order : @xmath605 .",
    "let @xmath606 with @xmath607 and such that @xmath608 then , for any @xmath609 , @xmath610\\geq 0.\\ ] ]    we prove the following statement by induction on @xmath611 : @xmath612 \\geq 0$. ''      } \\ ] ] since @xmath142 is a polynomial of degree @xmath44 , ( [ chiocciola ] ) follows from definition [ divdiff3 ] as soon as @xmath613 .",
    "also , since the dominant coefficient of @xmath142 is  @xmath335 , the same argument shows @xmath614 = 1 $ ] and the claim holds for @xmath615 .",
    "fix now @xmath616 , i.e. @xmath617 , and @xmath618 satisfying ( [ beta ] ) .",
    "if @xmath619 then @xmath620 - f[\\alpha_0 , \\alpha_1 , \\dots , \\alpha_k ]      } {          \\beta_0 - \\alpha_0      }      & = \\frac {          f[\\beta_0 , \\alpha_1 , \\dots , \\alpha_k ] - f[\\alpha_1 , \\dots , \\alpha_k , \\alpha_0 ]      } {          \\beta_0 - \\alpha_0      } \\label{crema } \\\\      & = f[\\beta_0 , \\alpha_1 , \\dots , \\alpha_k , \\alpha_0]\\\\      & = f[\\beta_0 , \\alpha_0 , \\alpha_1 , \\dots , \\alpha_k ]       .",
    "\\label{nuvola}\\end{aligned}\\ ] ] by definition [ divdiff2 ] we have @xmath621 = 0 $ ] and the numerator in the l.h.s . of ( [ crema ] )",
    "is merely equal to @xmath622 $ ] .",
    "the denominator is positive from ( [ beta ] ) and so is the r.h.s . of ( [ nuvola ] ) by induction hypothesis .",
    "it follows that @xmath623 \\geq 0\\ ] ] and the same is true when @xmath624 .",
    "if @xmath625 , we compute @xmath626 - f[\\beta_0 , \\alpha_1 , \\dots , \\alpha_k ]      } {          \\beta_1 - \\alpha_1      } = f[\\beta_0 , \\beta_1 , \\alpha_1 , \\dots , \\alpha_k ]      , \\ ] ] get then in the same way @xmath627 \\geq 0\\ ] ] and the same is true when @xmath628 . proceeding similarly we eventually obtain that @xmath629 \\geq 0.\\ ] ]    * acknowledgements : * a.g .",
    "thanks laurent tournier for the many fruitful discussions on the matter , and , in particular , the nice independence argument we presented in section  [ background ] .",
    "he also thanks pablo ferrari , ins armendariz , pablo groisman , leonardo rolla and matthieu jonckheere for their hospitality in buenos aires where all this work started .                      y.  le jan , _ markov paths , loops and fields _ , vol .",
    "2026 of lecture notes in mathematics .",
    "springer , heidelberg , 2011 .",
    "lectures from the 38th probability summer school held in saint - flour , 2008 , ecole dt de probabilits de saint - flour ."
  ],
  "abstract_text": [
    "<S> consider a finite weighted oriented graph . </S>",
    "<S> we study a probability measure on the set of spanning rooted oriented forests on the graph . </S>",
    "<S> we prove that the set of roots sampled from this measure is a determinantal process , characterized by a possibly non - symmetric kernel with complex eigenvalues . </S>",
    "<S> we then derive several results relating this measure to the markov process associated with the starting graph , to the spectrum of its generator and to hitting times of subsets of the graph . in particular , the mean hitting time of the set of roots turns out to be independent of the starting point , conditioning or not to a given number of roots . </S>",
    "<S> wilson s algorithm provides a way to sample this measure and , in absence of complex eigenvalues of the generator , we explain how to get samples with a number of roots approximating a prescribed integer . </S>",
    "<S> we also exploit the properties of this measure to give some probabilistic insight into the proof of an algebraic result due to micchelli and willoughby  @xcite . </S>",
    "<S> further , we present two different related coalescence and fragmentation processes .    </S>",
    "<S> _ msc 2010 : _ primary : 05c81,60j20,15a15 ; secondary : 15a18,05c85 . </S>",
    "<S> + _ keywords : _ finite networks , spanning forests , determinantal processes , random sets , hitting times , local equilibria , wilson s algorithm , random partitions , coalescence and fragmentation . </S>"
  ]
}