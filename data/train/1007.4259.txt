{
  "article_text": [
    "sign covariances such as kendall s tau ( @xmath1 ) are especially useful for testing independence when ( i ) the data are ordinal ( whether continuous or discontinuous ) and the ordinary covariance is inappropriate , ( ii ) the data are heavy tailed and the ordinary covariance may not be defined , or ( iii ) the data are contaminated and robustness is needed .",
    "kendall s tau ( @xmath1 ) , however , has the possible drawback that it may be zero when there is association present . to achieve power against broader alternatives",
    ", the chi - square test can be used ; it is directly applicable to categorical data and can be used for continuous data after a suitable categorization .",
    "however , the chi - square test for data with ordered outcomes does not take the ordinal nature of the data into account , leading to potential power loss for ` ordinal ' alternatives ; effectively the chi - square test treats the data as nominal rather than ordinal ( see also ) . as a possible substitute for these two tests , we consider a modification of @xmath2 , which we call @xmath0 .",
    "tests based on the sample value of @xmath0 yield power against a broad range of ordinal alternatives .",
    "below , we first derive @xmath0 , then summarize its properties and provide a probabilistic interpretation in terms of concordance and discordance probabilities .",
    "regarding notation , we denote iid sample values by @xmath3 , but will also use @xmath4 to denote iid replications of @xmath5 in order to define population coefficients . for the most part of this paper",
    "we assume all variables are real , but briefly touch upon more general metric sample spaces .",
    "the empirical value @xmath6 of kendall s tau is @xmath7 and its population version is @xmath8 @xcite . with @xmath9",
    "we obtain @xmath10 and @xmath11 replacing squared differences in @xmath12 by absolute values of differences , we define @xmath13 this leads to a modified version of @xmath14 , @xmath15 and the corresponding population coefficient @xmath16 the quantities @xmath17 and @xmath0 are new , and the main result of the paper is the following :    [ th1 ] let @xmath18 and @xmath19 be real continuous random variables . then @xmath20 with equality if and only if @xmath18 and @xmath19 are independent .    the proof is given in section  [ app - cvm ] .",
    "we conjecture that the continuity condition is not needed , and have the following partial proofs of this : ( i ) lemma  [ lem2 ] in section  [ cvmsec ] shows that if @xmath18 is binary and @xmath19 continuous or discrete , the theorem holds ; ( ii ) the code for a computational ` proof ' of nonnegativity of @xmath0 using _ mathematica _ for @xmath21 contingency tables with given marginals is given in appendix  [ app - math ] .",
    "if the sign functions are omitted from @xmath0 , we obtain the covariance @xmath22 introduced by .",
    "he showed that for arbitrary real random variables @xmath18 and @xmath19 , @xmath23 with equality if and only if @xmath18 and @xmath19 are independent .",
    "we now give a probabilistic interpretation of @xmath0 .",
    "a pair of points @xmath24 is called concordant if @xmath25 and discordant if @xmath26 , as illustrated in figure  [ concdisc2 ] . denoting the probabilities that two randomly chosen points are concordant by @xmath27 and that they are discordant by @xmath28 , kendall s tau has the well - known probabilistic interpretation @xmath29 an analogous interpretation of @xmath0 can be given",
    ". a set of four points is concordant if there exist vertical and horizontal axes such that two opposing open quadrants contain two points each ( figure  [ concdisc](a ) ) .",
    "the set is discordant if there exist vertical and horizontal axes such that every open quadrant contains a single point ( figure  [ concdisc](b ) ) .",
    "note that the axes must strictly separate the points , i.e. , no points can fall on the axes .",
    "in mathematical notation , a set of four points @xmath30 is concordant if there is a permutation @xmath31 of @xmath32 such that @xmath33\\end{aligned}\\ ] ] and discordant if there is a permutation @xmath31 of @xmath32 such that @xmath34 \\wedge \\left[(y_i , y_k < y_j , y_l)\\vee ( y_i , y_k > y_j , y_l)\\right]\\end{aligned}\\ ] ] it is straightforward to verify that @xmath35 where @xmath36 is the indicator function and @xmath37 is shorthand for @xmath38 .",
    "hence , @xmath39 denoting the probability that four randomly chosen points are concordant as @xmath40 and the probability that they are discordant as @xmath41 , we obtain that the sum of the first two probabilities on the right hand side of  ( [ tauprob1 ] ) equal @xmath42 , while the last probability equals @xmath43 .",
    "hence , @xmath44 the reason that @xmath40 is given twice as much weight as @xmath41 is related to there being twice as many discordant as concordant patterns in figure  [ concdisc ] .",
    "it can be seen that @xmath17 and @xmath0 do not depend on the scale at which the variables are measured , but only on the ranks or grades of the observations .",
    "four points are said to be _ tied _ if they are neither concordant nor discordant .",
    "clearly , for continuous distributions the probability of tied observations is zero .",
    "hence , under independence , when all configurations are equally likely , @xmath45 and @xmath46 , and if one variable is a strictly monotone function of the other , then @xmath47 and @xmath48 .    the definition of @xmath0 can easily be extended to @xmath18 and @xmath19 in arbitrary metric spaces , but unfortunately theorem  [ th1 ] does not extend then , as it is possible that @xmath49 .",
    "this is shown by the following example .",
    "consider a set of points @xmath50 , where @xmath51 such that @xmath52 , @xmath53 if @xmath54 and @xmath55 or @xmath56 , and @xmath57 otherwise .",
    "suppose @xmath19 is uniformly distributed on @xmath58 , and given @xmath59 , @xmath18 is uniformly distributed on @xmath60 , and given @xmath61 , @xmath18 is uniformly distributed on @xmath62",
    ". then @xmath63 .",
    "still , for @xmath18 and @xmath19 in arbitrary metric spaces , the following result suggests that a test that @xmath64 against the alternative @xmath65 can have power for certain interesting alternatives : if @xmath5 is the mixture of a non - degenerate independence model and a point mass , then @xmath66 ( theorem  [ mix - th ] in appendix  [ mix - app ] ) .    by the cauchy - schwarz inequality",
    ", the normalized value @xmath67 does not exceed one .",
    "( note that this notation is in line with kendall s @xmath68 , defined analogously . )",
    "note that @xmath69 is a function of the copula , which is the joint distribution of @xmath70 and @xmath71 , where @xmath72 and @xmath73 are the cumulative distribution functions of @xmath18 and @xmath19 .",
    "explores the way in which copulas can be used in the study of dependence between random variables , paying particular attention to kendall s tau and spearman s rho .",
    "the remainder of the paper is organized as follows . in section  [ sec - alt ] ,",
    "a comparison is given with some other approaches in the literature .",
    "in particular , the  test is essentially a special case and there are interesting similarities with a test devised by hoeffding .",
    "in section  [ sec - applic ] we give a description of independence testing with an artificial and a real data example , briefly comparing the tests described in section  [ sec - hoeff ] with a test based on kendall s tau and the chi - square test .",
    "for the proof of theorem  [ th1 ] , we need lemma  [ lem2 ] , which covers the case that one of the variables is binary .",
    "note that lemma  [ lem2 ] provides an extension of theorem  [ th1 ] , which does not cover the discrete case .",
    "[ lem2 ] if @xmath18 is binary and @xmath19 given @xmath18 is continuous or discrete , then @xmath74 with equality if and only if @xmath18 and @xmath19 are independent .    before giving the proof ,",
    "let us first look at the form of @xmath0 when one of the variables is binary .",
    "suppose @xmath75 and @xmath76 and denote @xmath77 , @xmath78 , and @xmath79 . then using  ( [ tauprob1 ] ) it is straightforward to verify that @xmath80     \\label{cvm1}\\end{aligned}\\ ] ] note that in this case , independence of @xmath18 and @xmath19 is equivalent to @xmath81 and @xmath82 having identical distributions ( see section  [ cvmsec ] for comments on the resulting two - sample test ) .",
    "below , we first prove lemma  [ lem2 ] separately for the continuous and the discrete case , then we prove theorem  [ th1 ] .",
    "+ continuity implies @xmath83 so by  ( [ cvm1 ] ) , @xmath74 reduces to @xmath84 now , with @xmath85 and @xmath86 the distribution functions of @xmath81 and @xmath82 , respectively , @xmath87 @xmath88 @xmath89 @xmath90 with equality if and only if @xmath91 .",
    "the lemma is true for random variables that take two values each ( by inspection ) .",
    "assume now it is true for random variables with @xmath92 values .",
    "let @xmath93 be @xmath94 and @xmath95 be @xmath96 for some random variables with @xmath92 values .",
    "suppose now that @xmath97 has a mixed distribution : it has the same distribution as @xmath98with probability @xmath99 and takes a different value larger than all previous possible values of @xmath100 with probability @xmath101 .",
    "similarly @xmath102 has a mixed distribution : it takes the same distribution as @xmath103 with probability @xmath104 and takes the different value mentioned before with probability @xmath105 .",
    "we now have @xmath106 and @xmath107 hence @xmath108 @xmath109 @xmath110 but @xmath111 with equality if and only if the distributions are identical , so now for random variables taking @xmath112 values the statement is true with equality if and only if @xmath113 and @xmath114 , that is , when the distributions are identical .",
    "we assume the distribution of @xmath115 is continuous .",
    "we can see that we need to prove that @xmath116 @xmath117 this is because @xmath118 @xmath119 we now have that @xmath120 @xmath121 @xmath122 @xmath123 @xmath124 @xmath125 @xmath126 @xmath124 we now rewrite the quantity in brackets as @xmath127 @xmath122 @xmath128 @xmath129 now @xmath130 so the first of the two integrals in ( [ pthm1 ] ) is equal to    @xmath131 it remains to show that the second integral is non - negative ( with 0 for independence ) .",
    "we have @xmath132 @xmath133 @xmath134 @xmath135 the integrand of the expression above has the same sign as @xmath136 @xmath137 to simplify notation , we now define @xmath138 , @xmath139 , @xmath140 , @xmath141 , @xmath142 , @xmath143 @xmath144 , @xmath145 and @xmath146 .",
    "we rewrite ( [ pthm2 ] ) as @xmath147 @xmath148 @xmath149 @xmath150 @xmath151 @xmath152 @xmath153 @xmath154 @xmath155 @xmath156 @xmath157 @xmath156 @xmath158 @xmath159 which is non - negative and can only be @xmath160 if @xmath161 for all @xmath162 , that is if @xmath163 comparison to other approaches ------------------------------    if one of the variables is binary , our approach leads to the  test , as described in section  [ cvmsec ] .",
    "in sections  [ sec - hoeff ] and  [ sec - dewh ] the two direct competitors to tests based on @xmath0 known to the authors , one originally by and another originally by and , are discussed .",
    "both these competitors share the property of our approach that they are rank - based and consistent for all alternatives .",
    "useful and extensive discussions of other ordinal data and nonparametric methods for independence testing are given and .",
    "the two - sample  test is used to test whether or not two samples are drawn from the same distribution , and is consistent for any alternative .",
    "we show that if one of the variables is binary and the conditional distribution of the other variable is continuous , a test based on @xmath0 coincides with the  test .",
    "we argue that the test based on @xmath0 has a possible advantage for discrete distributions .",
    "we now give the relationship with the  test .",
    "let @xmath85 be the distribution function of @xmath81 and let @xmath86 be the distribution function of @xmath82 .",
    "with @xmath164 let @xmath165 then @xmath166 is zero if and only if @xmath167 , i.e. , if and only if @xmath18 and @xmath19 are independent .",
    "the  test statistic is based on an estimate of @xmath168 .",
    "first , note :    [ lem5 ] for @xmath169 , @xmath166 does not depend on @xmath101 .",
    "the lemma is implied because @xmath170^\\infty_{-\\infty } = 0\\ ] ] the relationship between the  test , which is based on @xmath168 , and @xmath0 is given by the following :    [ lem1a ] if @xmath18 is binary and @xmath19 given @xmath18 is continuous , then @xmath171 .",
    "first note that @xmath172 now continuity implies @xmath83 hence by  ( [ cvm1 ] ) and  ( [ sqint ] ) , @xmath173\\\\     & = & 2p^2(1-p)^2     \\left [     3\\int g^2hdh + 3\\int ( 1-g)^2hdh - \\frac12     \\right]\\\\     & = & 2p^2(1-p)^2     \\left [     3\\int ( g^2 - 2gh+h)dh - \\frac12     \\right]\\\\     & = & 2p^2(1-p)^2     \\left [     3\\int ( g^2 - 2gh+h^2)dh     \\right]\\\\     & = & 2p^2(1-p)^2     \\left [     3\\int ( g - h)^2dh     \\right]\\end{aligned}\\ ] ] the lemma now follows from lemma  [ lem5 ]    note that , for discrete distributions , the definition of @xmath168 unsatisfactorily depends on the way @xmath85 and @xmath86 are defined , e.g. , whether we define @xmath174 or @xmath175 . since @xmath0 deals naturally with discreteness of random variables , tests based on @xmath0 might serve as an alternative for the  test if discreteness is present .",
    "hoeffding s @xcite coefficient for measuring deviation from independence for a bivariate distribution function @xmath176 with marginal distribution functions @xmath177 and @xmath178 is defined as @xmath179 ( see also and . )",
    "an alternative formulation given by hoeffding is @xmath180 where @xmath181 .",
    "interestingly , hoeffding s @xmath86 has an interpretation in terms of concordance and discordance probabilities closely related to the interpretation of @xmath0 .",
    "with @xmath182 we have the equality @xmath183 let five points be @xmath86-concordant if four are configured as in figure  [ concdisc](a ) and the fifth is on the point where the axes cross and , analogously , five points are @xmath86-discordant if four are configured as in figure  [ concdisc](b ) and the fifth is on the point where the axes cross .",
    "denote the probabilities of @xmath86-concordance and discordance by @xmath184 and @xmath185 .",
    "then @xmath186 and @xmath187 hence , using  ( [ f12 ] ) , @xmath188      a coefficient related to hoeffding s @xmath86 is @xmath190 tests based on estimators of this coefficient were studied by and . showed that in the continuous case , with @xmath191 @xmath192 the latter definition is suitable for discontinuous @xmath18 and @xmath19 as well and has the advantage that it does not depend on the way @xmath176 is defined .",
    "hoeffding s @xmath86 is more complex than @xmath0 in that it is based on concordance and discordance of five points rather than four .",
    "see also , who compares kendall s tau and spearman s rho which are based on concordance and discordance probabilities of two and three points respectively and for this reason expresses some tentative preference for the simpler kendall s tau .",
    "a possible drawback of @xmath189 is that there seems to be some arbitrariness in the use of rank scores ; for example , one might also use normal scores .",
    "of the three coefficients , @xmath0 may thus have some advantage .",
    "tests based on @xmath0 are discussed in the next section , which includes a remark on power .",
    "a suitable test for independence is a permutation test which rejects the independence hypothesis for large values of @xmath17 . for every permutation @xmath193 of the observed @xmath194-values ,",
    "the sample @xmath0-value @xmath195 is computed , and the @xmath196-value is the proportion of the @xmath197 which exceed @xmath17 . as is well - known , the permutation test conditions on the empirical marginal distributions , which are sufficient statistics for the independence model . in categorical data analysis ,",
    "it is usually referred to as an exact conditional test . in practice , the number of permutations may be too large to compute and a random sample of permutations is taken , which is also called a resampling test .",
    "note that there does nt seem to be a need for an asymptotic approximation to the sampling distribution of @xmath17 .",
    "direct evaluation of @xmath17 requires computational time @xmath198 , which may be practically infeasible for moderately large samples , but @xmath17 can be well - approximated by taken a random sample of subsets of four observations .",
    "the proof of theorem  [ th1 ] suggests that the complexity can be reduced to @xmath199 .",
    "an open problem is what the minimum computational complexity of computing @xmath17 is .",
    "below , we compare various tests of independence using an artificial and a real data set .    an artificial multinomial table of counts is given in table  [ ct1 ] , where @xmath18 and @xmath19 are ordinal variables with  5 and  7 categories .",
    "visually , we can detect an association pattern , but as it is non - monotonic a test based on kendall s tau does not yield a significant @xmath196-value .",
    "the chi - square test also yields a non - significant @xmath200 ( based on @xmath201 resamples ) , while a permutation test based on @xmath17 yields @xmath202 ( @xmath203 resamples ) , giving evidence of an association .",
    "we also did tests based on @xmath189 , which yields @xmath204 ( @xmath203 resamples ) , and the test based on hoeffding s @xmath86 yields @xmath205 ( @xmath206 resamples ) . in this example , using a test designed for ordinal data with power against broad alternatives , evidence for an association can be found , which is not possible with a nominal data test like the chi - square test or with a test based on kendall s tau .",
    ".artificial contingency table containing multinomial counts .",
    "kendall s tau and the chi - square test do not yield a significant association , but a permutation test based @xmath14 yields @xmath202 [ cols=\"<,<,^,^,^,^,^,^,^ \" , ]     table  [ ct2 ] shows data from a randomized study to compare two treatments for a gastric ulcer crater , and was previously analyzed in . using @xmath207 resamples , the chi - square test yields @xmath208 , kendall s tau yields @xmath209 , @xmath17 yields @xmath205 , @xmath189 yields @xmath210 , and using @xmath203 resamples hoeffding s @xmath86 yields @xmath211 .    for future research",
    ", more understanding is needed concerning the power of the tests based on @xmath17 , @xmath86 , @xmath189 , and the chi - square test .",
    "we have done some limited simulations and , unsurprisingly , found that for all four there are alternatives for which they are most powerful .",
    "however , so far we were unable to detect any patterns which can lead to useful advice on when to use which test ; it appears we need a better understanding than we currently appear to have of the types of alternatives that might be of most interest .",
    "let @xmath212 and @xmath213 be metric spaces and suppose @xmath214 and @xmath215 are independent non - degenerate random variables . consider the mixture of @xmath5 with the degenerate random variable on the point @xmath216 , that is , for some @xmath217 the mixture @xmath218 is defined as @xmath219 then    [ mix - th ] @xmath220 .",
    "the proof is done by conditioning on the number of occurrences of @xmath221 among the iid @xmath222 . clearly , @xmath221 can occur 0 to 4 times , each with positive probability , and @xmath0 is the sum of these probabilities times the conditional expectations of the product of @xmath223 and @xmath224 conditionally on the number of occurrences of @xmath221 , the expectation of the product of  ( [ s1 ] ) and  ( [ s2 ] ) equals the product of their expectations . if @xmath221 occurs 3 or 4 times , both  ( [ s1 ] ) and  ( [ s2 ] ) are zero , hence zero is contributed to @xmath0 . conditionally on @xmath221 occurring 0 or 1 times , the expectations of both  ( [ s1 ] ) and  ( [ s2 ] ) can easily be seen to equal zero by symmetry reasons .    to prove the theorem",
    ", it remains to be shown that conditionally on @xmath221 occurring twice , both  ( [ s1 ] ) and  ( [ s2 ] ) have positive expectation .",
    "if either @xmath225 and @xmath226 or @xmath227 and @xmath228 equal @xmath221 , both  ( [ s1 ] ) and  ( [ s2 ] ) are zero and this will not contribute to @xmath0 .",
    "without loss of generality we now only need to consider @xmath228 and @xmath226 equalling @xmath221 .",
    "then  ( [ s1 ] ) reduces to @xmath229 and  ( [ s2 ] ) reduces to @xmath230 by the triangle inequality , both are nonnegative .",
    "since the @xmath231 and @xmath232 are non - degenerate , both have positive probability of being positive and so have positive expectations",
    ". hence @xmath65 .",
    "the code below verifies nonnegativity of @xmath0 for @xmath21 contingency tables with uniform marginals . in the code",
    ", we replaced the uniform marginals by a variety of other marginals and always obtained the same result .    ....",
    "( * module to compute tau - star , where p is an r x c table of probabilities , x and y are r x 1 and c x 1 vectors of scores * ) taustarcd[p _ , x _ , y _ ] : = module[{sgn , r , c , sxy } ,    sgn = compile[{{a,_integer},{b,_integer},{c,_integer},{d,_integer } } ,       sign[abs[a - b ] + abs[c - d ] - abs[a - c ] - abs[b - d ] ] ] ;    { r , c } = { length[x ] , length[y ] } ;    sxy = sum[p[[i1,j1]]p[[i2,j2]]p[[i3,j3]]p[[i4 , j4 ] ]        sgn[x[[i1]],x[[i2]],x[[i3]],x[[i4 ] ] ]        sgn[y[[j1]],y[[j2]],y[[j3]],y[[j4 ] ] ] ,        { i1,r},{i2,r},{i3,r},{i4,r},{j1,c},{j2,c},{j3,c},{j4,c } ]    ]            ( * define t2 which is t but a function of only ( r-1)(c-1 ) probabilities with given marginals * ) fixmarg1 = table[p[i , c]->xmarg[[i]]-sum[p[i , j],{j,1,c-1}],{i,1,r } ] ; fixmarg2 = table[p[r , j]->ymarg[[j]]-sum[p[i , j],{i,1,r-1}],{j,1,c } ] ; t2 = t //.",
    "join[fixmarg1 , fixmarg2 ] // simplify"
  ],
  "abstract_text": [
    "<S> the standard two - variable chi - square test is typically consistent for all alternatives to independence , but effectively treats the data as nominal which may lead to loss of power for ordinal data . </S>",
    "<S> alternatively , a test based on kendall s tau does take ordinality into account , but only has power against a narrow set of alternatives . </S>",
    "<S> this paper introduces a new test aimed at filling this gap , i.e. , it is designed for ordinal data and to have asymptotic power for all alternatives . </S>",
    "<S> our test is a permutation test based on a modification of kendall s tau , denoted @xmath0 , which is nonnegative and equal to zero if and only if and only if independence holds . </S>",
    "<S> an interpretation of @xmath0 in terms of concordance and discordance for sets of four observations is given . </S>",
    "<S> the new coefficient is a sign version of a covariance introduced by .    </S>",
    "<S> * keywords * : measure of association , test of independence , concordance , discordance , sign test , ordinal data , permutation test , copula . </S>"
  ]
}