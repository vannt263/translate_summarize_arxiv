{
  "article_text": [
    "matching problems under transferable utility have attracted considerable attention in recent years within economic theory .",
    "the general goal is to understand the stable equilibria of matches between distributions of agents on two sides of a ` market ' ( for example , husbands and wives in the marriage market , ceos and firms in the labor market , producers and consumers in a market for differentiated commodities , etc . ) , as well as the resulting division of surplus between partners . until recently ,",
    "most work has focused on the setting in which a single characteristic is used to distinguish between the agents on each side ; for example , in the marriage market , several models assume that individuals differ only by their income ( or their human capital ) .",
    "these models have the advantage of being analytically tractable , and often allow explicit closed form solutions . under the classical spence - mirrlees condition , the only stable matching is the positive assortative one , the nature of which ( ` who marries whom ' ) is directly determined by the underlying distributions of the male and female characteristic .",
    "however , these one dimensional models are unsatisfactory in many situations , as both casual empiricism and factual evidence indicate that agents often match on several traits . in the marriage market , for instance , the suitability of a potential marriage between a woman and man typically depends on several characteristics of both , including income and education , but also age , tastes , ethnic background , physical attractiveness , etc .",
    "it is therefore important to study and understand _ multidimensional _ matching problems , in which agents on both side of the market are differentiated using several characteristics .",
    "these models have garnered increasing visibility in recent years , due to their wider applicability and flexibility , but their introduction brings forth serious theoretical challenges .",
    "the nature of the equilibrium matching is more interesting but also more complex ; in contrast to the one dimensional case , it is no longer determined by the sole knowledge of the distributions of individual characteristics , even under ( a generalization of ) the spence - mirrlees condition . from a more technical perspective",
    ", it is generally not possible to derive closed form solutions ; and discretising matching problems leads to a linear program , which often become numerically unwieldy when type spaces are multidimensional .",
    "the purpose of this paper is to provide a general characterization of multidimensional matching models , in terms of existence , uniqueness and qualitative properties of stable matches .",
    "since the work of @xcite in the discrete setting , and @xcite in the continuum , it has been understood that transferable utility matching is equivalent to a variational problem ; this problem is known in the mathematics literature as the _ monge - kantorovich optimal transport _ problem . our first goal is to show that the considerable existing literature on multidimensional optimal transport can be exploited to derive conditions under which stable matches are unique and pure , and to understand their properties .",
    "we put a particular emphasis on the case in which the dimensions of heterogeneity on the two sides of the market are unequal ( say , @xmath0 ) .",
    "these sorts of problems have received relatively little attention from the mathematics community , but are quite natural economically ; the dimension essentially reflects the number of attributes used to distinguish between agents and there is no compelling reason in general to expect this number to coincide for agents on the two different sides of the market ( say , for consumers and producers ) .",
    "a typical pattern emerges in these situations , since for one side of the market ( the one with a lower dimension ) , identical agents are typically matched with a continuum of different partners .",
    "we explore the properties of the ` indifference sets ' thus defined , and argue that since such indifference sets can often be empirically recovered , these properties can provide testable consequences of multidimensional matching theory .    of specific interest",
    "are the so - called ` multi - to - one dimensional matching problems ' , in which agents on one side of the market are assumed to be multidimensional , while those on the other side are unidimensional .",
    "they include an economically important class of examples ( see , for instance , coq and @xcite ) , for which one can obtain explicitly the stable matchings . in this context , we describe a general approach aimed at characterizing the equilibrium matching . we provide a robust methodology that allows , under suitable conditions , to explicitly characterize its solutions .",
    "we discuss some interesting features that the indifference sets exhibit , and which are typically absent in purely unidimensional problems .",
    "for instance , the optimal mapping may be discontinuous , and so women of similar types may marry men of very different types .",
    "lastly , we consider three specific examples that illustrate different potential applications of matching models .",
    "one is a standard , hedonic model of the type used , in particular , in the empirical io literature .",
    "while these models typically assume imperfect competition , we show how a competitive version can be analyzed . under standard conditions , existence , but also uniqueness and purity , obtain naturally .",
    "in particular , we show that the mathematical notion of purity has in this context a natural interpretation in terms of ` bunching ' .",
    "in addition , it is in general possible , using matching or optimal transportations techniques , to derive closed form solutions for the pricing schedule ; we illustrate how this can be done using specific distributions .",
    "our second example considers a context where women are characterized by two traits ( socio - economic status , from now on ses , and fertility ) whereas men only differ by their ses - a case recently studied by @xcite",
    ". then it may be the case that small changes in a middle class woman s ses ( while her fertility remains constant ) result in a large change in her husband s income .",
    "again , we provide a general characterization of the solution and describe some of its qualitative features .",
    "lastly , the multi - to - one dimensional framework naturally leads to investigating the relationship between matching models and principal - agents problems under multidimensional asymmetric information . while this general question remains widely open ( and quite challenging ) , we illustrate our contribution by considering a competitive variant of the seminal model of @xcite , in which goods can be produced by a competitive and @xmath1-dimensionally heterogeneous set of producers , rather than a single monopolist .",
    "unlike the original rochet - chon framework , this model is equivalent to a matching problem of our form , and can be solved explicitly by the methods described above . we provide a full characterization of the resulting equilibrium price schedule .",
    "in particular , we show that in our competitive framework , and in contrast to the original monopolist setting , there is never bunching : consumers of different types _ always _ buy goods with different characteristics . in other words",
    ", the strange bunching patterns emphasized by rochet and chon do not appear to be intrinsically linked to the multidimensional nature of the adverse selection problem ; rather , they are due to the distorsions created by the presence of a monopolist producer .",
    "we consider sets @xmath2 and @xmath3 , parametrizing populations of agents on two sides of a market . in",
    "what follows , we shall stick to the marriage market interpretation ( so that @xmath4 and @xmath5 will denote the set of potential wives and husbands respectively ) , although alternative interpretations are obviously possible .",
    "they are distributed according to probability measures @xmath6 on @xmath4 and @xmath7 on @xmath5 , respectively . in the transferable utility framework , a potential matching of agents @xmath8 and @xmath9 generates a combined surplus @xmath10 , where @xmath11 .",
    "this surplus can be divided in any way between the agents @xmath12 and @xmath13 . for simplicity , we assume that @xmath14 and its derivatives are smooth and bounded unless otherwise remarked ; many of the results we describe can also be extended to surpluses with less smoothness , as in @xcite and @xcite for example .",
    "a _ matching _ is characterized by a probability measure @xmath15 on the product @xmath16 , whose marginals are @xmath6 and @xmath7 , that is @xmath17for all borel @xmath18 .",
    "intuitively , a matching is an assignment of the agents in the sets @xmath4 and @xmath5 into pairs , and @xmath19 is related to the probability that @xmath12 will be matched to @xmath13 ; in particular , @xmath20 refers to the support of @xmath15 , i.e. the smallest closed set containing the full mass of @xmath15 . ]",
    "implies that agents @xmath12 and @xmath13 are not matched together . the marginal condition is often called the _ market clearing _ criterion .",
    "we denote the set of all matchings by @xmath21 .",
    "integrable functions @xmath22 and @xmath23 are called payoff functions corresponding to @xmath24 if they satisfy the _ budget constraint _ :    @xmath25    @xmath15 almost everywhere  i.e. , for any pair of agents who match with positive probability . for such a pair @xmath26 , the functions @xmath27 and @xmath28 are interpreted respectively as the indirect utilities derived from the match by agents @xmath12 and @xmath13 ; the constraint ensures that the total indirect utility @xmath29 collected by the two agents does not exceed the total surplus @xmath10 available to them .    a matching @xmath15 is called _ stable _ if there exist payoff functions @xmath27 and @xmath28 satisfying both ( [ budgetconstraint ] ) and the reverse inequality @xmath30for all @xmath31 .",
    "condition expresses the stability of the matching in the following sense ; if we had @xmath32 for any ( currently unmatched ) pair of agents , it would be desirable for each of them to leave their current partners and match together , dividing the excess surplus @xmath33 in such a way as to increase the payoffs to both @xmath12 and @xmath13 . note that and together ensure @xmath34 , @xmath15 almost everywhere : if two agents match with positive probability , then they split the surplus generated between them .    for simplicity",
    ", we shall assume complete participation is incentivized throughout and that supply balances demand ( reflected by the fact that @xmath6 and @xmath7 have equal mass ) ; when these assumptions are violated it is well - known that they can be restored by augmenting both sides of the market with a fictitious type representing the outside option of remaining unmatched ( see for instance @xcite ) .",
    "given a stable match @xmath15 and associated matching functions @xmath35 , the set @xmath36is of particular interest ; as @xmath37 , it tells us which agents can match together .",
    "if @xmath38 is concentrated on a graph @xmath39 of some function @xmath40 , the stable matching is called _ pure _ , the interpretation being that almost all agents of type @xmath12 must match with agents of the same type @xmath41 ; in particular , purity excludes the presence of _ randomization _ , whereby an agent may be randomly assigned to different partners . in this case",
    ", the distribution @xmath7 agrees with the image @xmath42 of @xmath6 under @xmath43 , which assigns mass @xmath44   \\label{push - forward}\\]]to each @xmath45 . of @xmath6 through @xmath43 ; see e.g.  @xcite . ]",
    "more generally , it is interesting and useful to understand the geometry of  @xmath38 .    although @xmath46 and @xmath47 will not generally be everywhere differentiable , some mild regularity condition guarantees differentiability almost everywhere , as stated by the following result :    [ t : semiconvexity ] if the surplus function @xmath14 is lipschitz , so are the payoffs @xmath46 and @xmath47  and with the same lipschitz constant ; if @xmath48 , then @xmath46 and @xmath47 have second - order taylor expansions , lebesgue almost - everywhere .",
    "see @xcite or @xcite .",
    "when the probability measures @xmath6 and @xmath7 come from lebesgue densities , this almost - everywhere differentiability proves sufficient for many analytic purposes .",
    "we use @xmath49 ( respectively @xmath50 ) to denote those @xmath8 at which @xmath46 has a first- ( respectively second-)order taylor expansion , and @xmath51 where @xmath52 and @xmath53 denote the closure and interior of @xmath4 , respectively .    the fact that @xmath38 is the zero - set of the non - negative function enters crucially .",
    "it implies in particular the first - order and second order conditions @xmath54and @xmath55are satisfied at each @xmath56 for which the derivatives in question exist ; here @xmath57 denotes the interior of @xmath4 , and inequality should be understood to mean the difference of these @xmath58 symmetric matrices is non - negative definite .",
    "the first - order condition @xmath59(for example ) has an interesting , economic interpretation . in a transferability utility model ,",
    "the wife s share @xmath27 of the surplus comes at the expense of her husband @xmath13 s share .",
    "thus expresses the equality of his marginal willingness @xmath60 to pay for variations in her qualities @xmath61 with the couple s marginal surplus @xmath62 for the same variations .",
    "similarly @xmath63equates her marginal willingness to pay for variations in his qualities @xmath64 with their marginal surplus for such variations .",
    "this has important consequences for situations where characteristics are not exogenously given but result from some investment made by individuals before the beginning of the game ( human capital being an obvious example ) .",
    "then implies that  the marginal return , for the individual , of an investment in characteristics is exactly equal to the social return ( defined as the contribution of the investment to aggregate surplus ) .",
    "in other words , one expect that for some equilibria such investments will be efficient , despite being made non - cooperatively before the matching game ; their impact on global welfare is internalized by matching mechanisms , a point made by @xcite and @xcite and generalized by @xcite .",
    "the problem of identifying stable matches turns out to have a variational formulation , known as the optimal transport , or monge - kantorovich , problem in the mathematics literature ( see for instance @xcite , santambrogio15p and @xcite ) .",
    "this is the problem of matching the measures @xmath6 and @xmath7 so as the maximize the total surplus ; that is , to find @xmath15 among the set @xmath21 which maximizes    @xmath65:=\\int_{x \\times y}s(x , y)d\\gamma(x , y ) .",
    "\\tag{mk}\\ ] ]    the following theorem can be traced back to @xcite for finite type spaces @xmath4 and @xmath5 , and to @xcite more generally .",
    "it asserts an equivalence between and stable matchings .",
    "[ equivalence ] a matching measure @xmath66 is stable if and only if it maximizes .    as the maximization of a linear functional over a convex set , problem has a dual problem , which is useful both in studying it maximizers , and in clarifying its relation with stable matching .",
    "the dual problem to is to minimize @xmath67 + \\nu[v]:=\\int_{x } u(x)d\\mu(x ) + \\int_{y } v(y)d\\nu(y ) .",
    "\\tag{mk$_*$}\\ ] ] among functions @xmath68 and @xmath69 satisfying the stability condition .",
    "it is well known that under mild conditions , duality holds ( see , for instance , @xcite ) , that is :    @xmath70= \\min_{(u , v)\\ \\mathrm{satisfying}\\ \\eqref{utilities}}\\big(\\mu[u ] + \\nu[v]\\big).\\ ] ]    note that for any @xmath46 and @xmath47 satisfying the stability constraint and any matching @xmath66 , the marginal condition implies    @xmath71+\\nu \\lbrack v]=\\int_{x\\times y}\\left ( u(x)+v(y)\\right ) d\\gamma ( x , y)\\geq \\int_{x\\times y}s(x , y)d\\gamma ( x , y)\\ ] ]    and we can have equality if and only if @xmath34 holds @xmath15-almost everywhere .",
    "it then follows from the duality theorem that @xmath15 is a maximizer in ( and hence a stable match ) and @xmath35 are minimizers in the dual problem , precisely when @xmath34 holds @xmath15 almost everywhere ; in other words , the solutions to coincide with the payoff functions .",
    "an immediate corollary is the following :    let @xmath14 and @xmath72 be two surplus functions . assume there exists two functions @xmath73 and @xmath74 , mapping @xmath75 to @xmath76 and @xmath77 to @xmath76 respectively , such that @xmath78for any measures @xmath6 and @xmath7 , any stable matching for @xmath14 is a stable matching for @xmath72 and conversely .",
    "any stable measure @xmath15 for @xmath14 solves the surplus maximization problem:@xmath79which is equivalent to:@xmath80the last two integrals are given ( by the marginal conditions on @xmath15 ) , and so any @xmath15 that solves ( [ prs ] ) also solves ( [ prsbar ] ) : @xmath81    an important consequence of this result is that _ _  the observation of matching patterns can only ( at best ) identify the surplus up to two additive functions of _ _ @xmath12 _ _  and _ _ @xmath13 _ _",
    "respectively__. we shall see later on that , in general , @xmath14 can not be identified even up to two such additive functions .    problem has been studied extensively over the past 25 years , and theorem [ equivalence ] allows the application of a large resulting body of theory to the stable matching problem . in particular ,",
    "conditions on @xmath14 leading to existence , uniqueness and purity of the solution to are well known and surveyed in @xcite .",
    "these properties can be compactly and elegantly expressed in terms of the _ cross difference _ , introduced by @xcite and defined on @xmath82 by :    @xmath83    the relevance of the cross difference to problem will become more apparent in what follows . for",
    "now , we hint at its role by noting that in one dimension , @xmath84 , positivity of the cross difference whenever @xmath85 is equivalent to supermodularity of @xmath14 ( the spence - mirrlees condition ) . for more general @xmath4 and @xmath5 ,",
    "the cross difference is zero along the diagonal @xmath86 and nonnegative along @xmath87 for any stable match @xmath15 .",
    "this non - negativity of @xmath14 on @xmath88 is typically referred to as _ @xmath14-monotonicity _ of @xmath89 , and is a special case of a more general condition called _",
    "@xmath14-cyclical monotonicity _ , which characterizes the support of optimal matchings .",
    "the variational formulation is quite helpful in establishing the basic properties of stable matchings .",
    "existence , for instance , can now be asserted using basic continuity and compactness arguments , as stated by the following result :    [ xist]assume @xmath90 and @xmath91 are bounded and @xmath92 .",
    "then there exists an optimizer @xmath15 to , and therefore a stable match .",
    "see @xcite or @xcite    we now consider uniqueness and purity .",
    "aside from its theoretical interest , uniqueness of the optimal matching @xmath15 plays an important computational role , as in its absence more sophisticated techniques must be employed . in practice , solutions are often assumed to be pure in empirical studies .",
    "since this conclusion is not generically satisfied mccannrifford15p , it is desirable to know conditions on @xmath14 , @xmath6 and @xmath7 which guarantee it . furthermore , in hedonic contexts",
    ", purity implies the absence of bunching ( whereby different agents consume the same product ) ; this property will be particularly important when we investigate the interactions between matching and contract theory .",
    "note , first , that uniqueness is not guaranteed in general .",
    "for instance , when the surplus function takes the additive form @xmath93 , the functional    @xmath94=\\int_{x \\times y}s(x , y)d\\gamma(x , y ) = \\int_xf(x)d\\mu(x ) + \\int_yg(y)d\\nu(y)\\ ] ]    is _ constant _ throughout the set @xmath95 of feasible matching measures , and so any matching @xmath24 is optimal and hence stable .",
    "it is therefore clear that certain structural conditions on @xmath14 are indeed needed to ensure purity and uniqueness .",
    "the key condition for purity of the optimal matching is a nonlocal generalization of the spence - mirrlees condition , known as the _ twist _ condition :    the function @xmath96 satisfies the _ twist condition _ if , for each fixed @xmath97 and @xmath98 , the mapping @xmath99has no critical points .    by differentiating @xmath100 with respect to @xmath12 and rearranging , we see that this is equivalent to    @xmath101    for all @xmath12 and distinct @xmath102 .",
    "the twist condition is therefore equivalent to the _ injectivity _ of @xmath103 , for each fixed @xmath12 .",
    "this injectivity in turn implies that the husband type @xmath13 of woman type @xmath104 is uniquely determined by his marginal willingness @xmath60 to pay for her qualities through the first - order condition  .",
    "for instance , in a one - dimensional context ( @xmath105 ) , the classical spence - mirrlees condition imposes that either @xmath106 or @xmath107 over @xmath16 , which implies that @xmath108 is strictly monotone ( and hence injective ) for each fixed @xmath12 .",
    "it is in this sense that the twist condition can be viewed as a non - local generalization of the spence - mirrlees condition .",
    "the twist condition is sufficient to guarantee purity , as stated by the following result :    [ purity ] assume that @xmath6 is absolutely continuous with respect to lebesgue measure and the surplus @xmath14 satisfies the twist condition .",
    "then any solution @xmath15 to is pure .",
    "let @xmath24 solve for a twisted surplus @xmath96 . according to theorems [ t : semiconvexity ] and [ equivalence ] , there exist lipschitz potentials @xmath46 on @xmath4 and @xmath47 on @xmath5 satisfying @xmath109 for all @xmath110 , with equality holding @xmath24-a.e .",
    "being lipschitz , @xmath46 is differentiable lebesgue almost everywhere , hence @xmath6-a.e .",
    ", where @xmath111 denotes the left marginal of @xmath24 .",
    "thus for @xmath111-a.e .",
    "@xmath12 we find @xmath112 as in .",
    "the twist condition implies we can invert this relation to write @xmath113 , where @xmath114^{-1}(du(x))$ ] .",
    "this shows @xmath24 is pure .",
    "the absolute continuity of @xmath6 is a technical condition required to ensure the utilities can be differentiated on a set of full @xmath6 measure ; the payoff functions are guaranteed to be lipschitz if the surplus is , and are hence differentiable lebesgue almost everywhere by rademacher s theorem ( but not everywhere in general ) .",
    "the condition on the measure can be weakened somewhat , but some regularity is needed : as a simple counterexample , if @xmath115 is a dirac mass but @xmath7 is not , then the optimal matching ( indeed , the only measure in @xmath21 ) is product measure @xmath116 , which pairs every point @xmath13 with @xmath117 and is certainly not pure .    three remarks can be made at this point .",
    "first , if @xmath14 is twice continuously differentiable and @xmath5 has nonempty interior , the twist condition immediately implies that @xmath118 , as it asserts the existence of a smooth injection from an open subset of @xmath77 into @xmath75 .",
    "second , it is worth noting that in many relevant situations , the twist condition does indeed fail ; for example , if we replace @xmath4 and @xmath5 with compact smooth manifolds , it fails for _ any _ smooth surplus function @xmath14 .",
    "third , the twist condition is _ not _ necessary for purity .",
    "for instance , @xcite provide a setting in which purity holds in the absence of twist .",
    "one can readily see that purity implies uniqueness :    under the conclusions of the preceding theorem , the optimal matching @xmath119 is unique .",
    "suppose two solutions @xmath120 and @xmath121 to exist .",
    "convexity of the problem makes it clear that @xmath122 is again a solution .",
    "the conclusion asserts that @xmath123 concentrates on the graph of a map @xmath40 , and vanishes outside this graph .",
    "non - negativity ensures the same must be true for @xmath120 and @xmath121 .",
    "but then @xmath124 by lemma 3.1 of @xcite    the converse to this corollary is not true ; i.e. , one can easily find situations where the optimal matching is unique but not pure .",
    "additional conditions which ensure uniqueness , but not purity , of the optimal matching can be found in @xcite and @xcite .      as an illustration of theorem [ purity ]",
    ", we consider a particular case that has been widely used in empirical applications ( @xcite , @xcite , @xcite to name just a few ) .",
    "assume that @xmath125 , and that the surplus takes the form:@xmath126    two remarks can be made about this form .",
    "first , we may , without loss of generality , disregard the first two terms by assuming that @xmath127 ; the stable measure will not be affected .",
    "second , this form is necessary and sufficient for the matrix of cross derivatives:@xmath128to be diagonal ( a case investigated by @xcite ) .    in that case , for any @xmath129 , we have that:@xmath130    in particular ( and assuming that none of the @xmath131 s have anywhere vanishing derivatives ) , the twist condition is satisfied whenever the @xmath132 s are strictly monotonic . we conclude that , in that case , the stable match is unique and pure ; that is , there exists a function @xmath133 mapping @xmath75 to itself , such that @xmath12 is matched a.s . with @xmath134 .",
    "in addition , lindenlaub15 show that if the @xmath73 and @xmath74 are strictly increasing , then @xmath135 is strictly increasing in @xmath136 for all @xmath137 ( a property she calls multidimensional positive assortative matching ) .      in the absence of the twist condition , or in the case where both marginals are singular , one may not expect purity of the optimal match .",
    "however , under a generic nondegeneracy criterion , which is a local generalization of the spence - mirrlees condition , something can be still be asserted about the local geometric structure of its support . for a fixed @xmath138 , let @xmath139 be the hessian of the function @xmath140 , evaluated at the point @xmath141 .",
    "a simple calculation yields that @xmath142 takes the block form : @xmath143where    @xmath144    is the @xmath145 matrix of mixed second order partials , and the @xmath146 s in the upper left and lower right hand corners represent @xmath147 and @xmath148 vanishing blocks , respectively .",
    "denoting by @xmath149 the rank of @xmath150 , we have the following theorem ( see @xcite and @xcite ) .",
    "[ spacelike ] there exists a neighborhood @xmath151 of @xmath138 such that the intersection @xmath152 is contained in a lipschitz submanifold of @xmath16 of dimension @xmath153 . at points where @xmath38 is differentiable it is _ spacelike _ in the sense that @xmath154 for any @xmath47 which is tangent to the set @xmath38 .    in particular ,",
    "in the special case where @xmath125 and @xmath142 has full rank , @xmath155 , the support is at most @xmath125 dimensional ( locally ) . when these dimensions differ , and the @xmath156 matrix has full rank @xmath157 , the dimension is @xmath158 and its codimension is @xmath159 @xcite . if @xmath157 we say @xmath14 is _ non - degenerate _ at @xmath160",
    ".    the spacelike assertion of theorem [ spacelike ] can be useful to identify the orientation of the optimal matching , as we will see below .",
    "when @xmath84 , assuming the spence - mirrlees condition @xmath106 , the theorem tells us that the solution concentrates on a @xmath1-dimensional lipschitz curve @xmath161 . wherever that curve is differentiable , the spacelike condition boils down to @xmath162 , or @xmath163 , yielding positive assortative matching .",
    "there is only one matching @xmath15 with this structure , and it can be computed explicitly from the measures @xmath6 and @xmath7 ( provided @xmath6 has no atoms ) ; it is given by @xmath42 where @xmath164 satisfies @xmath165}d\\nu\\]]in words : @xmath12 is matched with @xmath166 such that the number of women whose characteristic is larger than @xmath12 equals the number of men above @xmath13 .",
    "when @xmath14 satisfies the twist condition , and the optimal matching is therefore pure and unique , it is interesting to ask whether the mapping @xmath164 generating the matching is continuous ; qualitatively , this is the question of whether women @xmath12 and @xmath167 whose types are ` close ' must marry men of similar characteristics .",
    "this turns out to generally not be the case , as a wide range of examples throughout the literature on optimal transport show .",
    "in particular , as was shown by @xcite , it is necessary ( but not sufficient ) that for each @xmath8 , the set @xmath168 be convex ; if this condition fails , it is possible to construct measures @xmath6 and @xmath7 with smooth positive densities for which @xmath43 is discontinuous .",
    "when @xmath0 , this convexity is particularly restrictive ; it can be shown to fail , _ unless _ the function @xmath14 takes a reducible , or _ index _ form , @xmath169 , for some @xmath170 p2 .",
    "we will illustrate this phenomenon with an example later on .",
    "even when this convexity holds , the optimal map may not be continuous in general ; in this case , their regularity is governed by a restrictive fourth order differential condition on @xmath14 , known as the ma - trudinger - wang condition ( see @xcite and @xcite ) .",
    "@xcite show this condition to be equivalent to a sign condition on the curvature of the space @xmath16 geometrized using the hessian @xmath142 as a ( pseudo)-riemannian metric .",
    "the stability condition allows information on individual utilities at the stable match to be recovered . to see why , note",
    "first that stability implies that , for @xmath6 almost every @xmath12,@xmath171    assume , now , that the matching is pure ( say , because the twist condition is satisfied ) .",
    "the envelope theorem then yields , wherever @xmath46 is differentiable and @xmath41 is matched with @xmath12 ,    @xmath172    which gives the partials of @xmath46 , and therefore defines @xmath46 up to an additive constant .",
    "note , incidentally , that these partial differential equations must be compatible , which generates restrictions on the matching function @xmath43 ; namely , assuming double differentiability:@xmath173where @xmath174 and the partials of @xmath14 are taken at @xmath175 and the inequality is from .",
    "in particular , in the case of multi to one dimensional matching , then @xmath176 , and ( [ ccond ] ) becomes a system of partial differential equations that @xmath43 must satisfy ( which reduces to a single equation in case @xmath177 ) ; together with the measure restrictions and the matrix inequality , this typically identifies the matching function @xmath43 .",
    "we shall come back to this point in section 4 .      a very special case , which has been largely used in practical applications , is obtained when the surplus function @xmath14 is weakly separable in one vector of characteristics .",
    "assume , indeed , that there exist two functions @xmath178 and @xmath179 , mapping @xmath77 to @xmath76 and @xmath180 to @xmath76 respectively , such that:@xmath181 in words , the various male characteristics @xmath13 affect the matching function only through some one dimensional index @xmath182 .",
    "this assumption is quite restrictive ; in practice , it requires that men with different characteristics @xmath13 and @xmath183 but the same index ( i.e. , @xmath184 ) be perfect substitutes on the matching market _ for any potential spouse _ @xmath12 .    formally , if @xmath14 is smooth , then the index form requires that @xmath14 satisfies the following conditions:@xmath185these conditions express the fact that the marginal rate of substitution between @xmath186 and @xmath187 ( which defines the slope of tangent to the corresponding iso - surplus curve ) does not depend on @xmath12 ; indeed , ( [ ind ] ) implies that:@xmath188    the main practical interest of index models is that , whenever ( [ ind ] ) is satisfied , the matching problems is de facto one - dimensional in @xmath13 ; technically , one can replace the space @xmath5 and the measure @xmath7 with @xmath189 and the _ push - forward _ @xmath190 of @xmath7 through @xmath178 defined as in . in particular , when the index property ( [ ind ] ) is satisfied , then the matching problem boils down to a multi - to - one dimensional problem , of the type discussed in section 4 .",
    "is not known ex ante and has to be empirically estimated .",
    "see @xcite for a precise discussion . ]",
    "another notable property of index models , that was observed in @xcite , is that when @xmath191 , the convexity of the sets @xmath192 , necessary to ensure that the matching function is continuous , _ requires _ that the function @xmath14 takes the form @xmath193 , where here @xmath194 . in particular , when @xmath195 , @xmath14 must have an index form .",
    "therefore , when @xmath196 , if a surplus function @xmath14 is not of index form , there are absolutely continuous measures @xmath6 and @xmath7 ( with smooth densities ) for which the matching function @xmath43 is discontinuous ; we will see an example of this below .",
    "lastly , the notion of index model can for some purposes be slightly relaxed .",
    "specifically , we define a _ pseudo - index _ model by assuming that there exist three functions @xmath197 , @xmath178 and @xmath179 , mapping @xmath198 to @xmath76 , @xmath77 to @xmath76 and @xmath180 to @xmath76 respectively , such that:@xmath199here , male characteristics @xmath13 affect the matching function through _ two _ one - dimensional indices @xmath200 and @xmath182 . the crucial remark , however , is the following .",
    "assume that @xmath201 is injective in @xmath137 ; this simply requires that @xmath202 is strictly monotonic in @xmath137 for at least one @xmath203 .",
    "then :    @xmath204    for any @xmath205 such that @xmath206 .",
    "it follows from the proof of the twist theorem that the support of the stable measure is born by the graph of a function .",
    "although the stable matching on @xmath207 is not pure ( since all males with the same index are perfect substitutes ) , for the ` reduced ' matching problem defined on @xmath208 by the surplus function @xmath209 and the measures @xmath6 and @xmath210 , the stable matching is pure - i.e. , there exists a function @xmath211 such that any women @xmath12 is matched with probability one with a man whose index is @xmath212 . in particular",
    ", most results derived in the multi to one dimensional case ( see section 4 below ) still apply in that case .",
    "next , we briefly recall the canonical link between matching and hedonic models , which will be crucial for some of our applications ( particularly the competitive io model and the competitive version of rochet - chon ) .",
    "an hedonic model involves three sets : a set @xmath4 of buyers ( endowed with a measure @xmath6 ) , a set @xmath5 of sellers ( endowed with a measure @xmath7 ) and a set @xmath213 of products ; intuitively , a product is defined by a finite vector of characteristics , and buyers purchase one product ( at most ) in any period  think of a car or a house , for instance .",
    "both buyers and sellers are price - takers , and consider the price @xmath214 of any product @xmath215 as given . a buyer with a vector of characteristics @xmath12 maximizes a quasi - linear utility of the form@xmath216while producer @xmath13 maximizes profit@xmath217where @xmath218 is the cost , for producer @xmath13 to produce product @xmath219 .",
    "it is important to note that the producer s profit depends on his characteristics , on the product s characteristics and on the price , but _ not _ on the characteristics of the buyer .",
    "this ` private value ' aspect will be crucial for the relationship with bidimensional adverse selection that we discuss below .",
    "an hedonic equilibrium is defined as a measure @xmath197 on the product set @xmath220 , whose first and second marginals are @xmath6 and @xmath7 , and a function @xmath221 such that , for any @xmath222 , then @xmath223 in words , @xmath197 represents an assignment of buyers and sellers to each other and to products , and an equilibrium is reached if the product assigned to @xmath12 ( resp .",
    "@xmath13 ) maximizes @xmath12 s utility ( @xmath13 s profit ) .    to see the link with matching models ,",
    "define the pairwise surplus function @xmath224and consider the matching model defined by @xmath225 .",
    "then cmn prove the following results :    * for any equilibrium of the hedonic model , the projection of the measure @xmath197 on the set @xmath16 , together with the functions@xmath226form a stable matching .",
    "* conversely , for any @xmath15 that solves the matching problem , there exist a price function @xmath221 that satisfies @xmath227with @xmath228 , where @xmath229 , any such @xmath221 forms an equilibrium pair @xmath230 .",
    "lastly , let s briefly consider the important issue of testability : what testable restrictions ( if any ) are generated by the general matching structure described above ?",
    "obviously , the answer depends on what we can observe .",
    "consider the simplest case , in which we only observe matching patterns ( ` who marries whom ' ) .",
    "technically , we are now facing an inverse problem : knowing the spaces @xmath4 and @xmath5 and the measure @xmath15 , can we find a surplus @xmath14 for which @xmath15 is stable ?",
    "this question should however be slightly rephrased to rule out degerate solutions ; for instance , any measure is stable for the degenerate surplus @xmath231 .",
    "we therefore consider the following problem : given two spaces @xmath4 , @xmath5 and some measure @xmath15 on @xmath16 , is is always possible to find a surplus @xmath14 such that @xmath15 is the _",
    "unique _ stable matching of the matching problem @xmath232 ?",
    "a first remark is that if we impose enough ` regularity ' in the model , the answer is positive .",
    "specifically , let us consider the case in which the support of the measure is born by the graph of some function @xmath133 , and that @xmath233 is non - degenerate ( in the sense that the derivative of @xmath133 has full rank over the entire space ) .",
    "then one can always find a surplus for which @xmath119 is the unique stable matching : we just need to take @xmath234 .",
    "indeed , @xmath15 obviously maximizes the primal , optimal transportation problem , which guarantees stability ; moreover , the surplus satisfies the twist condition , which guarantees uniqueness .",
    "the corresponding payoffs are @xmath235 .    however , non - degeneracy is crucial for this result to hold .",
    "for one thing , if @xmath133 is degenerate , the twist condition does not hold , and while @xmath15 is always stable for @xmath236 , it may not be the unique stable matching . moreover , and while theorem [ spacelike ] implies that any stable matching for a non - degenerate surplus concentrates on a set of dimension at most @xmath237 , it is possible to find measures supported on sets of this dimension which are _ not _",
    "stable for any @xmath238 , _ non - degenerate _ surplus . to see this , consider the @xmath84 case ; let @xmath239 .",
    "nondegeneracy here simply means @xmath240 , which implies either @xmath106 everywhere ( so @xmath14 is super - modular ) or @xmath107 everywhere ( so @xmath14 is submodular ) . in these two cases ,",
    "it is well known that stable matches concentrate on monotone increasing or decreasing sets , respectively . therefore , any @xmath15 concentrating on a set of dimension @xmath241 ( for instance , a smooth curve ) , which is neither globally increasing nor decreasing ( for example , the curve ( @xmath242 ) , can not be stable for any non - degenerate surplus .",
    "we now turn special attention to the case in which the dimensions @xmath243 of heterogeneity on the two sides of the market are unequal . in this case",
    ", one expects many - to - one rather than one - to - one matching . in a companion publication",
    ", we develop a detailed mathematical theory for this situation , focusing especially on the case @xmath244 . here",
    "we announce only the main conclusions of that theory and a few of the underlying ideas , suppressing technical details wherever possible to be able to move quickly on to interpretation and applications .    when @xmath245 , it is natural to expect that at equilibrium the subset @xmath246 of partners which a man of type @xmath247 is indifferent to will generically have dimension @xmath248 , or equivalently , codimension @xmath249 .",
    "we are interested in specifying conditions under which this indifference set will in fact be a smooth submanifold .",
    "it would then consist of one ( or more ) isolated points  a single one if @xmath14 happens to be twisted .",
    "] let us explore this situation , paying particular attention to the separate roles played by the surplus function @xmath10 as opposed to the populations @xmath6 and @xmath7 in determining these indifference sets .      for any equilibrium matching @xmath24 and",
    "payoffs @xmath250 , we have already seen that @xmath251 implies .",
    "that is , all partner types @xmath252 for husband @xmath253 lie in the same level set of the map @xmath254 .",
    "if we know @xmath255 , we can determine this level set precisely ; it depends on @xmath111 and @xmath256 as well as @xmath14 .",
    "however , in the absence of this knowledge it is useful to define the _ potential indifference sets _ , which for given @xmath257 are merely the level sets of the map @xmath258 .",
    "we can parameterize these level sets by ( cotangent ) vectors @xmath259 : @xmath260 or we can think of @xmath257 as inducing an equivalence relation between points of @xmath4 , under which @xmath12 and @xmath261 are equivalent if and only if @xmath262under this equivalence relation , the equivalent classes take the form .",
    "we call these equivalence classes _ potential indifference sets _ , since they represent a set of partner types which @xmath263 has the potential to be indifferent between . the equivalence class containing a given partner type @xmath261",
    "will also be denoted by @xmath264    a key observation concerning potential indifference sets is the following proposition .    given @xmath265 and @xmath266 , we say @xmath267 _ degenerates _ at @xmath110 if @xmath268 .",
    "otherwise we say @xmath14 is _ non - degenerate _ at @xmath269 .",
    "[ p : indifference structure ] let @xmath270 for some @xmath271 , where @xmath265 and @xmath266 with @xmath272 .",
    "if @xmath14 does not degenerate at @xmath273 , then @xmath274 admits a neighbourhood @xmath275 such that @xmath276 coincides with the intersection of @xmath4 with a @xmath277-smooth , codimension @xmath249 submanifold of @xmath278 .    since @xmath279 , the surplus extends to a neighbourhood @xmath280 of @xmath269 on which @xmath14 continues to be non - degenerate ( by lower semicontinuity of the rank ) .",
    "the set @xmath281 forms a codimension @xmath249 submanifold of @xmath278 , by the preimage theorem guilleminpollack74 .",
    "more specifically , the rank condition implies that choosing a suitable orthonormal basis for @xmath282 yields @xmath283_{1\\le i , j\\le n } \\ne 0 $ ] . in these coordinates , the potential indifference set is locally parameterized as the inverse image under the @xmath277 map @xmath284 of the affine subspace @xmath285 .",
    "taking @xmath278 and @xmath286 smaller if necessary , the inverse function theorem then shows @xmath287 to be @xmath277 .",
    "although we have stated the proposition in local form , it implies that if @xmath288 is a _ regular value _ of @xmath289  meaning @xmath290 has rank @xmath249 throughout @xmath291  then @xmath292 is the intersection of @xmath4 with an @xmath248 dimensional submanifold of @xmath75 .",
    "note however that this proposition says nothing about points @xmath293 where @xmath14 degenerates , which can happen throughout @xmath89 .",
    "as argued above , the potential indifference sets and are determined by the surplus function @xmath10 without reference to the populations @xmath6 and @xmath7 to be matched . on the other hand ,",
    "the indifference set actually realized by each @xmath9 depends on the relationship between @xmath6 , @xmath7 and @xmath14 .",
    "this dependency is generally complicated , as illustrated by the following example .",
    "consider the surplus function:@xmath294where @xmath295 .",
    "the potential indifference sets are given , for any @xmath296 , by : @xmath297these are straight lines in @xmath298 , parallel to the vector @xmath299 .",
    "therefore , for any given @xmath300 , we know that the set of spouses matched with @xmath13 ( the indifference set corresponding to husband @xmath13 ) will be contained in such a straight line . however , it is certainly not true that any such line ( obtained for an arbitrary choice of @xmath203 ) will be an indifference set curve . for a given @xmath13 , the exact equation of the indifference set corresponding to @xmath13",
    "is defined by the value of the specific vector @xmath203 which is relevant for that particular @xmath13  and this depends on the measures @xmath6 and @xmath7 .",
    "however , there is one case in the problem may simplify substantially : the case of multi - to - one dimensional matching , namely @xmath301 . in this case , suppose @xmath302 is non - vanishing ( i.e.  @xmath303 takes only regular values ) .",
    "then the potential indifference sets @xmath304 are codimension @xmath1 in @xmath75 ; that is , they are curves in @xmath305 , surfaces in @xmath298 , and hypersurfaces in higher dimensions @xmath306 . moreover , as @xmath203 moves through @xmath76 , these potential indifference sets sweep out more and more of the mass of @xmath6 . for each @xmath9 there will be some choice of @xmath307 for which the @xmath6 measure of @xmath308 exactly coincides with the @xmath7 measure of @xmath309 $ ] ( assuming both measures are absolutely continuous with respect to lebesgue , or at least that @xmath6 concentrates no mass on hypersurfaces and @xmath7 has no atoms ) . in this case the potential indifference set @xmath310 is said to split the population proportionately at @xmath13 , making it a natural candidate for being the true indifference set @xmath311 to be matched with @xmath13 . can be recovered from any @xmath312 and @xmath13 , we may equivalently say @xmath12 splits the population proportionately at @xmath13 , and vice versa . ] in the next section , we go on to describe and contrast situations in which this expectation is born out and leads to a complete solution from those in which it does not .",
    "we now explain a new approach to a specific class of models , largely unexplored in either the mathematics or economics literature , but which can often be solved explicitly with the techniques outlined below and developed more fully in @xcite .",
    "these are _ multi - to - one dimensional _",
    "models , in which agents on one side of the market ( say wives ) are bi - dimensional ( or , potentially , higher dimensional ) while agents on the other side ( husbands ) are one - dimensional .",
    "thus , we are matching a distribution on @xmath313 with another on @xmath314 .",
    "the surplus @xmath14 is then a function @xmath315 of @xmath316 real variables , and will typically be increasing in each argument .",
    "the crucial notion , is this setting , is that of a _ iso - husband curve _ , defined as the indifference set of a given husband @xmath13 , i.e. as the submanifold of wives among which husband @xmath13 turns out to be indifferent facing the given market conditions .",
    "iso - husband curves , as we shall see , play a key role in the construction of an explicit solution to the matching / optimal transportation problem . in addition",
    ", a crucial property of these curves is that they can in principle be empirically identified ; see @xcite for a detailed discussion .",
    "in fact , it has been argued that the theoretical properties of iso - husband curves could provide the most powerful empirical tests of matching theory ( see for instance @xcite ) .    the goal is to construct from data @xmath317 a matching function @xmath318 , whose level sets @xmath311 constitute iso - husband curves . at the end of the preceding section we identified a natural candidate for this indifference set : namely the potential indifference set which divides the mass of @xmath6 in the same ratio as @xmath13 divides @xmath7 ; whether or not these natural candidates actually fit together to form the level sets of a function or not depends on a subtle interaction between @xmath6 , @xmath7 and @xmath14 .",
    "when they do , we say the model is _ nested _ , and in that case we show that the resulting function @xmath40 produces a stable equilibrium match .",
    "mathematically , the simplest multi - to - one dimensional models arise from index surpluses , which have economic motivation arising from @xcite .",
    "these models are nested for _ every _ choice of the distributions @xmath7 and @xmath6 , as we demonstrate below . moreover , in the following section , we will discuss three applications of multidimensional matching theory ; the first two of these deal explicitly with multi - to - one dimensional problems .",
    "the first model arises in the marriage market , where recent research indicates that it is appropriate to model women using both education and fertility and men using income only @xcite@xcite .",
    "a second example comes from a hedonic variant of the rochet - chon screening problem .",
    "we now give a heuristic description of a general algorithm for constructing the solution to the matching problem when one of the dimensions is @xmath301 ; the aim is to find a solution to above ( or , equivalently , ) , which satisfies the mass balance condition @xmath319 and the spacelike condition in theorem [ spacelike ] . in order to work ,",
    "our approach requires the nestedness property mentioned above and detailed below .",
    "these conditions are satisfied in a wide class of multi - to - one dimensional matching problems ; they are illustrated in the theorem and examples presented below . however , except in the spence - mirrlees ( with @xmath84 ) and in the index and pseudo - index cases , this nestedness depends not only on @xmath14 , but also on @xmath6 and @xmath7 .    for each fixed @xmath320 , our goal is to identify the iso - husband ( or indifference ) set @xmath321 of husband type @xmath13 facing the given market conditions .",
    "when differentiability of @xmath47 holds at @xmath13 , the argument in the preceding section implies that this is contained in one of the potential indifference sets @xmath304 from . proposition [ p : indifference structure ]",
    "indicates when this set will have codimension @xmath1 ; it generally divides @xmath4 into two pieces : the sublevel set @xmath322and its complement @xmath323 .",
    "we denote its strict variant by @xmath324 .",
    "to select the appropriate level set , assuming @xmath43 is differentiable , the spacelike condition implies @xmath325 for each @xmath326 . summing on @xmath137 suggests points @xmath274 in the region @xmath327 get paired with points @xmath328 .",
    "we therefore choose the unique level set _ splitting the population proportionately _ with @xmath13 ; that is , the @xmath329 for which the @xmath111 measure of female types @xmath327 coincides with the @xmath256 measure of male types @xmath330 $ ] .",
    "we then set @xmath331 for each @xmath12 in the set @xmath304 .",
    "our first theorem specifies conditions under which the resulting match @xmath332 optimizes the kantorovich problem ; we view it as the natural generalization of the positive assortative matching results of @xcite @xcite and @xcite from the one - dimensional to the multi - to - one dimensional setting .",
    "unlike their criterion , which depends only on @xmath14 , ours relates @xmath14 to @xmath111 and @xmath256 , by requiring the sublevel sets @xmath333 identified by the procedure above to depend monotonically on @xmath314 , with the strict inclusion @xmath334 holding whenever @xmath335>0 $ ] .",
    "we say the model @xmath336 is _ nested _ in this case .",
    "our situation is naturally more complicated than theirs , since there is no obvious ordering of the women s types , but generally a variety of possible orderings depending on population frequencies @xmath111 and @xmath256 ; nestedness rather asserts that the women s preferences enjoy some degree of compatibility , in the sense that for @xmath337 \\subset y$ ] any wife @xmath338 assigned to the higher type of husband has a greater willingness to pay for variations in the qualities of husband type @xmath339 ( and similarly of husband type @xmath340 ) than does any wife @xmath341 assigned to the lower type of husband .",
    "[ t : nested ] let @xmath265 and @xmath342 be connected open sets equipped with borel probability measures @xmath111 and @xmath256 .",
    "assume @xmath256 has no atoms and @xmath111 vanishes on each @xmath343 hypersurface .",
    "use @xmath344 and @xmath345 to define @xmath346 , @xmath347 etc .",
    ", as in    assume @xmath14 is non - degenerate , @xmath348 , throughout @xmath349 . then for each @xmath350 there is a maximal interval @xmath351 \\ne \\emptyset$ ] such that @xmath352 = \\nu[(-\\infty , y)]$ ] for all @xmath353 .",
    "both @xmath354 and @xmath355 are upper semicontinuous .",
    "assume both maps @xmath356 are non - decreasing , and moreover that @xmath357 implies @xmath358 .",
    "then @xmath359 holds @xmath256-a.e .",
    "setting @xmath360 for each @xmath361 defines a stable match @xmath362 [ @xmath111-a.e . ] .",
    "moreover , @xmath363 maximizes uniquely on @xmath95 .",
    "finally , if @xmath364 is connected then @xmath43 extends continuously to @xmath4 .",
    "non - degeneracy implies @xmath365 is an @xmath366 dimensional @xmath343 submanifold of @xmath4 orthogonal to @xmath367 .",
    "since both @xmath111 and @xmath256 vanish on hypersurfaces , the function @xmath368-\\nu[(-\\infty , y)]\\ ] ] is continuous , and for each @xmath257 climbs monotonically from @xmath369 $ ] to @xmath370 $ ] with @xmath371 .",
    "this proves the existence of @xmath372 and confirms the zero set of @xmath373 is closed .",
    "thus @xmath374 is lower semicontinuous , @xmath354 is upper semicontinuous , and by the intermediate value theorem @xmath375 $ ] is non - empty .    the main strategy for the rest of the proof is to use @xmath376 to construct a lipschitz equilibrium payoff function @xmath47 by solving @xmath377 a.e .",
    "together with @xmath46 from , it can be shown that @xmath250 minimizes the dual problem and @xmath378 maximizes the planners problem . for details and the case @xmath379 ,",
    "see @xcite .",
    "note that nestedness is a property of the three - tuple @xmath380 ; that is , for most surplus functions , the model may or may not be nested depending on the measures under consideration . in some cases , however , the surplus function is such that the model is nested for all measures @xmath381 .",
    "this is the case for the _ pseudo - index models _ defined above .",
    "indeed , assume that the surplus has the form :    @xmath382    then @xmath383only depends on @xmath384 through the one - dimensional index @xmath385 .",
    "it follows that the iso - husband sets are defined by equations of the type @xmath386 , which do not depend on @xmath13 .",
    "such curves can not intersect as soon as @xmath387 is strictly monotonic in @xmath13 .",
    "must couple certain subsets of @xmath4 with certain subsets of @xmath5 . then , the method above may be applied succesfully to these subsets , even if it fails when applied to the whole of @xmath4 and @xmath5 .",
    "we demonstrate this with an example ( see remark [ uniform ] below).]@xmath388 and @xmath7 and the surplus @xmath14 , it was proven that this yields the optimal solution . ]    in @xcite we show the converse is also true : a non - degenerate surplus is pseudo - index if and only if @xmath336 is nested for all choices of absolutely continuous population densities @xmath111 and @xmath256 .",
    "the preceding theorem illustrates the powerful implications of nestedness , when it is present . for suitable data , the next theorem and corollaries",
    "give characterizations of nestedness which are often simpler to check in practice .",
    "these are based on a description of the motion of the iso - husband set in response to changes in the husband type , which is obtained using the theory of level set dynamics .",
    "once again , sharper statements and detailed proofs may be found in @xcite .",
    "there the conclusion of following theorem is also shown to be sharp , in the sense that @xmath389 diverges at the endpoints of @xmath5 whenever the area of the iso - husband sets @xmath390 shrinks to zero . since we intend to apply the theorem on lipschitz domains , we first recall the definition of transversality in that context .",
    "recall @xmath391 intersects @xmath392 non - transversally if their normals coincide ( or equivalently , are multiples of each other ) at some point of intersection .",
    "if @xmath393 is merely lipschitz , they intersect non - transversally if the inward or outward normal to @xmath391 is a generalized normal to @xmath393 , meaning it can be expressed as limit of convex combinations of outward normals at arbitrarily close points where @xmath393 is differentiable .",
    "[ t : non - nested ] let @xmath265 and @xmath342 be connected lipschitz domains , equipped with borel probability measures @xmath394 and @xmath395 whose lebesgue densities satisfy @xmath396 and @xmath397 .",
    "assume @xmath398 and non - degenerate throughout @xmath399 .",
    "then the functions @xmath400 of theorem  [ t : nested ] coincide .",
    "moreover @xmath401 outside the relatively closed set @xmath402 as @xmath403 increases the outward normal velocity of @xmath404 at @xmath405 is given by @xmath406 .    under the additional regularity assumed in the theorem , we differentiate at @xmath407 to obtain @xmath408 where @xmath409 is hausdorff @xmath366 dimensional ( surface ) measure .",
    "the formula for @xmath410 is a straightforward application of the co - area formula from @xcite ; it can also be seen as a consequence of the fundamental theorem of calculus , after applying the implicit function theorem to @xmath411 to get @xmath412 as the outward normal velocity at @xmath12 of @xmath327 when @xmath203 is increased as @xmath13 is held fixed . the corresponding formula for @xmath413 results from the fact that the analogous lipschitz velocity is given by @xmath414",
    "when @xmath13 is increased as @xmath203 is held fixed . note that because @xmath407 the limits from the left and the right which define the derivatives agree ; we need not include any additional contributions to these integrals coming from @xmath415 satisfying @xmath411 . the continous dependence of @xmath410 and @xmath413 on @xmath416 are shown in @xcite , after which @xmath417 can be inferred by applying the implicit function theorem to @xmath418 .    as consequences of this description , we obtain two alternate characterizations of nestedness in @xcite :    [ c : dynamic nestedness ] under the hypotheses of theorem t : non - nested : if the model is nested then @xmath419 for all @xmath420 and @xmath405 , with strict inequality holding at some @xmath12 for each @xmath13 .",
    "conversely , if @xmath421 and strict inequality holds for all @xmath9 and @xmath405 , then the model is nested .",
    "[ c : unique splitting ] a model @xmath336 satisfying the hypotheses of theorem [ t : non - nested ] with @xmath421 is nested if and only each @xmath252 corresponds to a unique @xmath257 splitting the population proportionately , i.e. which satisfies @xmath422 in this case , the stable matching is given by @xmath423 .",
    "the first corollary states that the model is nested if and only if all iso - husband sets move outward as @xmath13 is increased . besides proving useful in the examples below , the second corollary shows nestedness is methodologically essential : without it , @xmath43 fails to be well - defined ( unless proporitionate population splitting were to be augmented with some further criteria ) .      finally , we are able to address the questions of smoothness of the matching function @xmath362 in the nested case . in general dimension , this is a notoriously subtle and challenging question @xcite . for @xmath424",
    "a fairly satisfactory regularity theory has been developed following work of @xcite .",
    "but for @xmath425 little is known , outside of the pseudo - index case @xcite .    assuming transversality ( @xmath426 ) , theorems [ t : nested ] and t : non - nested give conditions under which @xmath133 is continuous and @xmath427 on the interiors of their respective domains . recalling @xmath428 from , differentiation yields @xmath429 thus we immediately see we can bootstrap continuous differentiability of the matching function @xmath430 from continuity @xmath431 , wherever the normal velocity @xmath432 of the iso - husband set of @xmath12 is _ strictly _ positive . even assuming @xmath433 , to get more smoothness for @xmath43 from this identity , we need more smoothness for @xmath203 , or equivalently @xmath47 .",
    "conditions guaranteeing @xmath434 ( i.e.  @xmath149 times continuously differentiable , with lipschitz derivatives ) for any integer @xmath271 are provided in @xcite .",
    "the overall strategy there is to use an induction on @xmath149 to extract additional smoothness of the function @xmath435 from , starting with that provided by theorems t : nested and [ t : non - nested ] . since @xmath418",
    ", this smoothness is transferred to @xmath436 using the implicit function theorem . to differentiate expressions like",
    ", we first use a suitably general form of the divergence theorem to rewrite them as @xmath437 where @xmath438 .",
    "their derivatives are then given as integrals along the moving interfaces , weighted by normal velocities as in theorem [ t : non - nested ] and its proof .",
    "these in turn must be controlled by appropriate assumptions and a delicately structured inductive hypothesis .",
    "finally we note that smoothness often holds for the one - dimensional husbands payoff function @xmath28 but not for the multi - dimensional wives payoff @xmath27 or matching function @xmath439 @xcite .",
    "assume that we can observe iso - husband sets in a multiple market setting ; what does it tell us about the surplus ?",
    "we now give a precise answer to that question .",
    "as already noted , if we only observe matching patterns , then the surplus @xmath14 can be identified at best up to an additive function of @xmath12 and an additive function of @xmath13 .",
    "this , however , is not the only flexibility we have in defining @xmath14 . to see why",
    ", remember that an arbitrary iso - husband set , with an equation of the form @xmath166 , lies in a level set @xmath440for some constant @xmath441 .",
    "knowing the map @xmath133 for a single pair @xmath442 tells the direction ( but not the magnitude ) of @xmath443 along the graph of @xmath133 : assuming enough smoothness it is given by . to get the magnitude we need to know the husband s marginal share @xmath444 of the payoff also .",
    "although maps @xmath133 will not generally exist for all choices of pairs @xmath442 ( counterexamples are given in @xcite ) , if we know the map @xmath133 corresponding to enough choices of @xmath442 , then by a suitable choice we can make the graph of @xmath133 pass through any point @xmath445 that we choose .",
    "lemma [ l : local match ] below shows that this can be done with sufficient smoothness for to hold , and that it costs no generality to take @xmath111 uniform on a small ball around @xmath12 . in this way , we learn the direction and sign ( but not the magnitude , unless we also know the marginal payoffs @xmath446 ) of @xmath443 globally . if we also know the payoffs we can integrate @xmath443 to find @xmath10 , up to an arbitrary additive function @xmath447 ( the constants of integration ) . on the other hand , without knowing the payoffs , the direction of @xmath443 globally is enough to determine the level sets of @xmath448 for each @xmath13 .    now , the set of continuous functions with the same level sets as a given function is exactly the set of monotonic transforms of that function . in other words , a function @xmath449 has the same level sets as @xmath303 if and only if:@xmath450for some monotonic @xmath142 , possibly depending on @xmath13 .",
    "fixing @xmath451 , we conclude that if @xmath72 is the surplus generating the given iso - husband sets , then another non - degenerate surplus @xmath14 generates the same iso - husband sets if and only if there exists a function @xmath452 with @xmath453 such that:@xmath454    this conclusion is implied by the following lemma .",
    "[ l : local match ] fix open sets @xmath265 , @xmath455 and @xmath270 non - degenerate , with @xmath456 . given @xmath457 , and arbitrary small neighbourhoods @xmath278 of @xmath167 and @xmath286 of @xmath183",
    ", we can find an atomless probability measure @xmath256 on @xmath286 such the stable match @xmath458 between @xmath256 and the uniform measure @xmath111 on @xmath278 satisfies @xmath459 , and moreoever : holds for all @xmath460 , and the husband s payoff @xmath47 is a quadratic function on @xmath5 .",
    "since the lemma concerns only the behaviour of @xmath14 near @xmath461 , it costs no generality to assume @xmath4 and @xmath5 bounded and @xmath462 .",
    "take @xmath28 to be a quadratic function of @xmath13 satisfying @xmath463 and @xmath464 .",
    "then strict concavity shows for each @xmath465 , @xmath466 is uniquely attained by some @xmath350 , denoted @xmath41 .",
    "strict concavity also shows that if @xmath467 for some @xmath468 then @xmath469 . in particular , @xmath470",
    ", so noting , the implicit function theorem shows @xmath471 is a @xmath277 solution to on some neighbourhood @xmath472 of @xmath167 .",
    "differentiating shows holds on @xmath472 , so non - degeneracy of @xmath14 implies @xmath473 is non - vanishing .",
    "now we can take @xmath278 and @xmath474 to be as small as we please around @xmath167 and @xmath183 .",
    "we claim @xmath43 is the stable match between the uniform measure @xmath111 on @xmath278 , and its image @xmath475 , while @xmath46 and @xmath47 above are the corresponding payoffs .",
    "the definition shows @xmath250 to be stable , hence integrating @xmath476 against @xmath111 shows @xmath477 attains the maximum and @xmath250 attain the minimum in .",
    "finally , @xmath256 is atomless since @xmath478 shows @xmath390 to be a @xmath277 hypersurface in @xmath479 , hence @xmath111 negligible , by the implicit function theorem once more .",
    "if @xmath480 in the lemma above , then taking @xmath278 smaller if necessary , so @xmath481 intersects each level set of @xmath133 transversally ( or at least @xmath409 negligibly ) , the co - area formula can be used as in chiapporimccannpass15 m to show @xmath482 has a density satisfying @xmath483 . replacing @xmath484 by @xmath485 , corollary c :",
    "dynamic nestedness then shows the model is nested , since @xmath486 .",
    "we now consider three applications of our framework .",
    "our first application considers a model introduced in @xcite and @xcite .",
    "the main question relates to the impact of marriage market considerations on women s decision to acquire higher education ( and more precisely a post graduate degree ) .",
    "the trade - off low considers is between human capital and fertility ( what she calls ` reproductive capital ' ) . by engaging in post graduate studies ,",
    "a woman increases her human capital , which boosts her future income ( among other things ) .",
    "most of the time , however , a post graduate degree will require postponing the birth of children to a later stage of her life , when her fertility may have declined .",
    "husbands , in low s model , are interested in both the income of potential spouses and their fertility ; the interaction between these two attributes , and their consequences on marital patterns are precisely what low investigates .    in what follows ,",
    "we generalize low s model in two directions .",
    "first , while low assumes that fertility can take only two values ( ` high ' for younger women and ` low ' for older , more educated ones ) , we allow for general distributions of the two characteristics ; in particular , we consider various correlation patterns between them ( from independence to negative correlation ) .",
    "second , the preferences we consider are slightly more general than low s , in the sense that we allow the presence of children to _ decrease _ utility when the family is poor ; in other words , this is a model in which birth control technologies are either absent or largely imperfect ( several examples can obviously be found in the developing world or in the history of western societies ) .",
    "the second feature drastically changes the qualitative properties of the stable matching ; specifically , the model is nested for some measures but not for others . moreover , for specific measures ( uniform in our case ) , both the nested and the unnested cases can be explicitly solved , which enable us to compare them in a systematic way .      men and women are parameterized by subsets @xmath342 and @xmath487 , respectively , where    * @xmath257 represents the husband s income , * @xmath488 represents the wife s fertility ( probability of having a child ) * @xmath489 is the wife s income .",
    "all couples with children receive some lump sum benefit @xmath490 .",
    "let @xmath491 denote private expenditures of individual @xmath137 and @xmath492 denote expenditures on children . if the couple has children , their preferences take the form@xmath493whereas without children they are@xmath494    suppose man @xmath13 marries woman @xmath495 .",
    "then , with probability @xmath496 , they have a child and maximize their combined utility @xmath497 under the budget constraint : @xmath498if we assume @xmath499 , the solution to this maximization problem is @xmath500generating a total utility equal to @xmath501 . with probability @xmath502 , they do not have a child , and @xmath503    the total utility is therefore equal to the expected value of these two possible outcomes:@xmath504    in what follows , for the sake of simplicity we set the parameter @xmath490 to @xmath505 ; the solution is therefore defined for all non negative @xmath12 and @xmath13 , and the surplus is@xmath506    a particular feature of this model is that if parents are poor enough ( when @xmath507 , so that @xmath508 their utility with children is less than without - implying that no efficient birth control device is available .",
    "such a situation can simply be ruled out by assuming that @xmath509 for all couples ; alternatively , we may consider cases in which some couples are ` poor ' ( @xmath507 ) whereas others are ` wealthy ' ( @xmath509 ) .",
    "we consider both cases in our examples 1 and 2 respectively ; interestingly enough , the mathematical properties are quite different in the two settings , since one is nested whereas the other is not .      for this surplus , equation becomes:@xmath510where @xmath511 $ ] .",
    "note , in particular , that if @xmath512 for some @xmath513 then all women with @xmath514 marry @xmath513 irrespective of their @xmath496 . in the explicit examples that follow , we will use the proportionate splitting condition to pin down @xmath515 . for now",
    ", we note two general properties :    * the iso - husband set of females @xmath516 for husband @xmath13 is given by the potential indifference curve @xmath517 in the @xmath516 plane , this curve is decreasing if and only if @xmath518 .",
    "it intersects lines of constant @xmath496 and @xmath12 transversally , as well as the northwest and southeast corners , since the other two corners match with the endpoints of @xmath5 , this will imply @xmath213 is empty for the rectangular domains considered in examples 1 and 2 . * in addition , while@xmath519[low spy]we have that@xmath520if @xmath509 , by we expect the level sets of @xmath43 to be decreasing curves in the @xmath495 plane ( that is , we expect @xmath521 ) , meaning husbands face a trade - off of the income versus the fertility of their spouse . in the opposite case @xmath507 , these iso - husband curves may be increasing ; we shall see an illustration in our second example",
    ".    depending on the measures @xmath6 and @xmath7 , the problem may or may not admit a closed form solution .",
    "in what follows , we consider three examples .",
    "first , we provide a complete resolution when the distributions are uniform on @xmath522\\times \\lbrack 1/2,1]$ ] and @xmath523 $ ] , respectively . as a second example",
    ", we consider uniform distributions on @xmath522\\times \\lbrack 0,1]$ ] and @xmath522 $ ] .",
    "lastly , we again take husbands to be uniformly distributed on @xmath523 $ ] , but take the distribution of wives to be uniform on @xmath523\\times \\lbrack 1/2,3/4]\\cup \\lbrack 0,1/2]\\times \\lbrack 3/4,1]$ ] .",
    "this distribution is chosen to reflect an anticorrelation due to age between fertility and income .",
    "fertility is certainly negatively correlated with age ; on the other hand , women who pursue higher education tend to enter the marriage market later in life , and so we expect age and education to exhibit a positive correlation .",
    "we start with a benchmark case in which the distributions @xmath6 and @xmath7 are uniform on @xmath522\\times \\lbrack 1/2,1]$ ] and @xmath523 $ ] respectively .",
    "although the surplus degenerates at one corner @xmath524 of @xmath525 , proposition [ p : optimal match ] shows this example is nested , in view of corollary [ c : unique splitting ] .",
    "moreover , the optimal matching function @xmath526 can be solved for almost explicitly ; we have the following result , proved in appendix [ a : verification of example 1 ] ; recall that @xmath13 splits the population proportionately at @xmath527 if @xmath528).\\end{aligned}\\ ] ]    [ p : optimal match ] let @xmath111 and @xmath256 be uniform probability measures on @xmath522 \\times [ 1/2 , 1]$ ] and @xmath523 $ ] , respectively . for each @xmath529",
    "\\times [ \\frac{1}{2},1]$ ] there is a unique @xmath530 $ ] that splits the population proportionately at @xmath527 , and the optimal map takes the form @xmath531 .    note",
    "that , by the proof of this proposition , we can actually derive an explicit formula for the optimal map :    @xmath532    we can go one step further , and identify the iso - husband curve consisting of the set of points @xmath527 which match with a fixed @xmath13 ; this is exactly the potential indifference curve , for the correct @xmath533 . as is clear from the proof of proposition [ p : optimal match ] , for @xmath534 $ ] , we have ,    @xmath535    for @xmath536 $ ] , we have @xmath537 , where @xmath538 is the unique solution in the interval @xmath523 $ ] of the equation @xmath539 . a plot of @xmath515 is provided in figure 1a , while figure 1b gives the iso husband curves for various values of @xmath13 .",
    "notice @xmath540 diverges like @xmath541 at the endpoint @xmath542 where the length of the iso - husband curve shrinks to zero ; the payoff @xmath28 therefore displays a comparable singularity in its second derivative .     * insert figures 1a and 1b about here *         we now consider the same surplus with different measures ; namely , the marginals are uniform on @xmath522\\times \\lbrack 0,1]$ ] and @xmath522 $ ] respectively . from a mathematical perspective",
    "this case provides an interesting illustration of an un - nested setting .",
    "formally , our method to derive the optimal match fails in that case ; it turns out that there are more than one @xmath13 that split the population proportionately for certain choices @xmath495 . however , we are able to use a refinement of the argument to obtain the explicit optimal match .",
    "specifically , we use the symmetry embedded in the model to show that the optimal map is given by:@xmath543where @xmath43 is as in the preceding proposition .",
    "this solution displays a discontinuity along the line @xmath544 ; each wife @xmath545 with income @xmath544 is indifferent between two distinct husbands , one richer ( @xmath546 ) and the other poorer ( @xmath547 ) .",
    "although the total surplus generated by the latter marriage is smaller , her share of it remains the same .",
    "the corresponding isohusband curves are plotted on figure 2a .",
    "we have also numerically solved this case ; the resulting solution agrees with our theoretical solution and is graphed below ( figure 2b ) .",
    "* insert figures 2a and 2b about here *         in this case , the analytic solution is very complicated , and we provide only a numerical simulation . for @xmath548 the numerical solution is plotted below ; one interesting feature is that lower income men ( whose iso - husband curves lie in the green , yellow or orange regions ) are indifferent between a selection of wives in both the low fertility , high income regime , @xmath549 \\times [ \\frac34,1 ] $ ] , and the high fertility , low income region @xmath550 \\times [ \\frac12,\\frac34+\\epsilon]$ ] , whereas the highest income men , whose iso - husband curves lie in the dark red region , match exclusively with wives in the high fertility , low income regime",
    ". this model does not fit the hypotheses of theorem [ t : non - nested ] when @xmath548 , since @xmath4 is neither connected nor lipschitz , but this shortcoming can be rectified by taking @xmath551 arbitarily small .       * insert figure 3 about here *         in our second example , we revisit a seminal model of the literature on bidimensional adverse selection , due to @xcite .",
    "we therefore consider a hedonic model with :    * an @xmath249-dimensional space of products : @xmath552 ; * an @xmath249-dimensional space of buyers : @xmath553 .",
    "consumers are distributed on this space according to a probability measure @xmath6 .",
    "each consumer will buy exactly one good .",
    "their utility for purchasing product @xmath219 for price @xmath554 is given by @xmath555 where @xmath556 * a one dimensional space of producers : @xmath557 .",
    "producers are distributed according to a probability measure @xmath7 .",
    "each producer will produce and sell exactly one good .",
    "their profit in selling a good @xmath219 for price @xmath554 is @xmath558 , where @xmath559 is the production cost for producer @xmath13 to produce a good of type @xmath219 .",
    "we note that this is exactly the model of @xcite , with the additional twist that the monopoly producer is replaced with a competitive set of heterogeneous producers ( whose productivity increases in @xmath13 ) . could be a dirac .",
    "the crucial distinction with rochet - chon is the competitive assumption . ] as we will see , however , introducing competition has striking consequences .",
    "in particular , and somewhat surprisingly , there is no bunching in this new variant of their model : consumers of different types always buy goods of different types .",
    "we illustrate these facts with an example , finding explicitly the optimal matching for certain choices of @xmath560 and @xmath7 , and then provide a general proof .",
    "as argued above , this hedonic pricing problem is equivalent to the matching problem on @xmath16 associated with the surplus:@xmath561    the maximum in the preceding equation is obtained ( assuming @xmath562 ) when @xmath563and so@xmath564    now , note that the twist condition is satisfied here ; in fact , this surplus function is of index form , @xmath565 , where @xmath566 , and @xmath38 satisfies the classical spence - mirrlees condition @xmath567 .",
    "the isoproducer curves take the form @xmath568 , and the matching is monotone increasing between @xmath569 and @xmath13 .",
    "we explicitly solve this problem for a particular choice of measures .",
    "let @xmath570 and @xmath111 be uniform measure ( normalized to have total mass 1 ) on the quarter disk @xmath571 and @xmath256 uniform on @xmath572 $ ] .",
    "the stable matching balances the mass of the quarter disc    @xmath573    with the @xmath256 mass of @xmath574 $ ] .",
    "this implies    @xmath575    of @xmath576 . in other words ,",
    "the optimal matching takes the form @xmath577 agent @xmath12 then buys the product @xmath219 such that : @xmath578 the envelope condition implies that agent @xmath12 s utility satisfies @xmath579or , @xmath580similarly , @xmath581integrating these equations yields @xmath582now , for @xmath41 , we must have @xmath34 . inserting @xmath583 into our equation for @xmath47 yields @xmath584on the other hand , @xmath585equating these implies @xmath586 . in what follows we assume @xmath587 ; the interpretation is that the firm with the highest production costs ( @xmath542 ) makes zero profit .",
    "we now turn our attention to the equilibrium pricing schedule , @xmath554 .",
    "following @xcite , the stability conditions @xmath588imply @xmath589or @xmath590the solution takes the form @xmath591where @xmath592 .",
    "note that when agent @xmath13 sells good @xmath219 , we must have @xmath593the first order conditions then imply @xmath594so that @xmath595 .",
    "we can then solve for @xmath596 in terms of @xmath13 ; @xmath597noting that @xmath598 then yields a parametric representation for the curve @xmath599 :    @xmath600    this is plotted on figure 4 .",
    "* insert figure 4 about here *        some comments can be made on this solution .",
    "first , and unlike the rochet - chon monopoly case , there is no _ exclusion _ ; all agents buy products .",
    "this property is easily understood from the matching formulation ; as every potential match generates a positive surplus , surplus maximization implies that no agents will be excluded .",
    "note , however , that the introduction of outside options might reverse this conclusion .",
    "more interesting ( and more surprising ) is the second finding , namely that _",
    "there is no bunching of any type _ : the efficient allocation is fully separating so that different agents _ always _ buy different goods .",
    "this no bunching conclusion is less intuitive ; it is not clear , a priori , whether it holds for general choices of the measures",
    "@xmath6 and @xmath7 , or it is an artifact of the particular measures we use in this example .",
    "we now present a theorem which states that the former interpretation is correct .",
    "the method for deriving the optimal matching will always work here ; as the surplus has an index form , issues with level sets crossing do not arise .",
    "of particular interest , the no bunching result is completely general , as the following result , proved in an appendix , confirms :    [ nobunching ] different consumer types always buy different goods .",
    "that is , if @xmath601 , and @xmath219 and @xmath602 represent the respective goods they choose , then @xmath603 .",
    "see appendix    it can be stressed that there are no restrictions on the measures in this theorem . in particular , it applies when @xmath6 is uniform measure on the unit square in @xmath305 , and @xmath7 is a dirac mass at @xmath542 ; these conditions provide the closest analogue to the rochet - chon problem .",
    "the difference is that here we have a continuum of homogeneous producers ( each with identical production cost @xmath604 for good @xmath605 ) competing with each other , rather than a monopoly . in other words ,",
    "the bunching phenomena present in the rochet - chon solution are not intrinsically linked to the multidimensionality of the consumer type space ; rather , they are due to market inefficiencies created by the monopoly .",
    "finally , it is interesting to note that the framework under consideration can always be seen as a model of competition under adverse selection ; in that sense , the matching approach provides a natural definition of an equilibrium in such a framework . a crucial remark , however , is that the model is characterized by its _ private value _ nature , since the producer s profit is not directly related to the identity of the consumer buying its product ( it only depends on the characteristics of the product and its price ) .",
    "this is in sharp contrast with a common value setting , in which the buyer s characteristics directly impact the producer s profit .",
    "think , for instance , of an insurance model a la @xcite , in which the same insurance contract generates different profit depending on the buyer s unobserved characteristics ( in that case her risk ) .",
    "technically , the producer s cost function @xmath606 now depends on @xmath13 and @xmath219 as before , but also on _ _",
    "_ _ @xmath12 .",
    "the key point is that , in such a common value context , the equivalence between matching and hedonic models is lost . in particular , it is not true in general that there always exists a price function @xmath607 such that a stable matching can be implemented as an hedonic equilibrium .",
    "our approach , therefore , does construct a first bridge between the literatures on matching and optimal transportation on the one hand , and _ competition _ under asymmetric information on the other hand ; however , the relationship is specific to private value models . in the non - competitve setting of the principal - agent framework ,",
    "the analogous connection found in @xcite and @xcite has proven exteremely fruitful .      as a last illustration",
    ", we consider a simple hedonic model , in which consumers have heterogeneous tastes for differentiated products , which are produced by firms with heterogeneous cost functions . the basic framework is similar to the previous , rochet - chon one , where @xmath608 denotres an agent s idiosyncratic valuations of product characteristics . for empirical applications ,",
    "@xmath12 will typically be considered as a random vector . ] , except for one feature : the cost function is now:@xmath609where the vector @xmath610 is producer - specific .",
    "the multidimensionality of @xmath13 reflects the fact that different producers made have different comparative advantages in producing _ some _ of the characteristics but not others ; for instance , a producer may be good at producing fast cars but less efficient for smaller ones . ) . ]",
    "note that , unlike most of the empirical io literature ( starting with the seminal contributions by @xcite and berrylevinsohnpakes04 ) , which assume imperfect competition , our hedonic framework posits that producers are price takers . in that sense ,",
    "our matching framework can be seen as an alternative approach to modeling competition in differentiated products .",
    "the characterization of the equilibrium follows the same path as before",
    ". the surplus function is:@xmath611here , the maximum is obtained when @xmath612 , leading to:@xmath613    since @xmath14 is continuous , existence follows from theorem [ xist ] .",
    "moreover , this form is a particular case of the general structure studied in subsection 2.4 .",
    "it follows that the twist condition is satisfied whenever @xmath614 , an assumption we maintain throughout the current subsection .",
    "this guarantees uniqueness and purity : to the positive orthant is not essential , since the twist condition holds for all @xmath12 in the complement of the coordinate hyperplanes @xmath615 .",
    "the latter form a set of measure zero which it is always possible to omit , as in @xcite .",
    "] there exists a function @xmath43 such that @xmath12 is matched with @xmath616 .",
    "the simplicity of these existence and uniqueness arguments is indeed an important advantage of the matching approach .",
    "as mentioned above , purity implies that different agents are matched with different producers .",
    "moreover , since @xmath612 , a result by lindenlaub implies that different agents always buy different products ; in other words , there is no bunching in this model .",
    "clearly , these conclusions follows from the assumption that the dimension of heterogeneity is the same for individuals and firms . if this assumption is relaxed ( for instance by assuming that @xmath617 ) , then a continuum of different buyers purchase from the same producer , and the market shares can be analyzed using the results in section 3 .",
    "the specific form of function @xmath618 depends on the distributions of individual and firm characteristics .",
    "as previously , we illustrate our approach by explicitly solving this problem for a particular choice of measures .",
    "let @xmath6 be the uniform measure ( normalized to have total mass 1 ) on the disk @xmath619 and let @xmath7 be the uniform measure ( again normalized to have total mass 1 ) on the disk @xmath620 with @xmath621 .",
    "then the support of the stable measure is born by the function @xmath622:@xmath623agent @xmath12 then buys the product @xmath219 such that : @xmath624and firm @xmath13 produces the product @xmath219 such that : @xmath625    utilities are derived as before :    @xmath626    therefore @xmath627and similarly@xmath628with @xmath629    the hedonic price satisfies : @xmath589which gives : @xmath630.\\ ] ]    as usual in a quasi - linear framework ( i.e. in the absence of income effects ) , the price schedule is defined up to an additive constant @xmath631 ; the latter can be pinned down , for instance , by imposing conditions on the profit of the least productive firm .",
    "this paper provides a general characterization of multidimensional matching models , in terms of existence , uniqueness and qualitative properties of stable matches .",
    "we show that recent developments in the literature on multidimensional optimal transport can be exploited to derive conditions under which stable matches are unique and pure , and to understand their local geometry .",
    "we consider a first application of such models to a competitive version of a standard , hedonic model in which heterogeneous consumers purchase differentiated commodities from heterogeneous producers .    of specific interest",
    "are situations in which the dimensions of heterogeneity on the two sides of the market are unequal .",
    "we explore the topology of the ` indifference sets ' that arise in this setting , and provide conditions under which they can be expected to be smooth manifolds of dimension @xmath248 .",
    "in particular , we investigate the set of ` multi - to - one dimensional matching problems ' , and we introduce a nestedness criterion under which the equilibrium match can be found more or less explicitly .",
    "lastly , we stress the deep relationships that exist between the multi - to - one dimensional framework and models of competition under multidimensional asymmetric information , at least in the case of private values . considering a competitive variant of the seminal , rochet - chon ( 1998 ) problem , in which goods can be produced by a @xmath1-dimensional , heterogeneous distribution of producers , rather than a single monopolist",
    ", we provide a full characterization of the resulting equilibrium price schedule .",
    "in particular , we show that in our competitive framework , and in contrast to the original monopolist setting , there is never bunching ; that is , consumers of different types _ always _ buy goods of different types .",
    "we begin with proposition [ p : optimal match ] .",
    "we verify that for each @xmath632 , there is a unique @xmath633 splitting the population proportionally at @xmath527 ; the result then follows from corollary [ c : unique splitting ] .",
    "the proportionally splitting level curves @xmath634 take the form @xmath635 , where @xmath533 is chosen to satisfy the population splitting condition .",
    "consider now the way that the curves @xmath634 intersect the boundary ; as each @xmath636 is continuous on @xmath637 and monotone decreasing ( note that @xmath638 ) , it intersects either @xmath522 \\times \\{1/2\\}$ ] in a unique point @xmath639 or @xmath640 $ ] in a unique point @xmath641 .",
    "we will prove the following two properties :    1 .",
    "@xmath533 is monotone increasing in @xmath13 .",
    "2 .   the boundary intersection points have a certain monotonicity property .",
    "precisely , for each @xmath642 , one of the following occurs : 1 .",
    "@xmath643 intersects @xmath522 \\times \\{1/2\\}$ ] and @xmath644 intersects @xmath640 $ ] .",
    "2 .   @xmath643 and @xmath644 both intersect @xmath522 \\times \\{1/2\\}$ ] , and @xmath645 .",
    "3 .   @xmath643 and @xmath644 both intersect @xmath640 $ ] , and @xmath646 .",
    "these two facts will imply the desired result as follows : 1 ) will imply that @xmath647 is decreasing in @xmath496 , for fixed @xmath648 , as the derivative of this function is @xmath649 .",
    "this means that if two of the population splitting curves intersect , ( that is @xmath650 ) within the given domain , then @xmath651 for all @xmath652 .",
    "this in turn implies that the boundary intersection points satisfy one of the following :    a.   @xmath644 intersects @xmath522 \\times \\{1/2\\}$ ] and @xmath643 intersects @xmath640 $ ] .",
    "b.   @xmath643 and @xmath644 both intersect @xmath522 \\times \\{1/2\\}$ ] , and @xmath653 . c.   @xmath643 and @xmath644 both intersect @xmath640 $ ] , and @xmath654 .",
    "this clearly contradicts point 2 ) above and so establishes the desired result .    to complete the proof , then , it remains only to verify points 1 ) and 2 ) .",
    "we first consider population splitting curves which pass through @xmath522 \\times \\{1/2\\}$ ] . in this case , the proportional splitting condition is given by    @xmath655 ] \\\\ & = & ( y -0.5 ) p(y ) \\ln(\\frac{y}{y-0.5 } ) .",
    "\\end{aligned}\\ ] ]    this means that @xmath656 .",
    "a simple calculation shows that this function is increasing in @xmath13 .",
    "the function can also be inverted to obtain @xmath657 ; this tells us that the population splitting level curves pass through @xmath522 \\times \\{1/2\\}$ ] precisely for @xmath658 .",
    "for @xmath13 in this region , the monotonicity of @xmath659 implies that 2 ) b ) holds , and we note that @xmath660 , which is also montone increasing , verifying 1 ) in this region .",
    "therefore , for @xmath661 , the curve @xmath634 intersects @xmath640 $ ] .",
    "this confirms part 2 ) a ) ; to complete the proof , it remains only to show that @xmath662 and @xmath533 are monotone increasing on @xmath663 $ ] . in this region",
    ", the proportional splitting condition gives us :    @xmath664    or , equivalently , @xmath662 is the unique solution in @xmath665 $ ] of @xmath666 differentiating implicitly , we have @xmath667    we have , for @xmath668 @xmath669 ( as , for @xmath668 , @xmath670 ) .    we now show @xmath671 .",
    "we have    @xmath672    now , as @xmath673 , the last term satisfies @xmath674 ( with equality only when @xmath675 ) , and the second to last term is decreasing in @xmath13 , so it is less than its value at @xmath676 : @xmath677 where the second inequality follows , as @xmath678 .",
    "note that we have equality above only if @xmath679 and @xmath680 .",
    "now note that one of the equalities or is always strict ( as either @xmath681 or @xmath682 ) .",
    "therefore , the derivative is negative on the relevant range .",
    "as @xmath671 and @xmath683 , tells us @xmath684 .",
    "finally , we have @xmath685 , and so the monotonicity of @xmath662 tells us @xmath533 is also strictly increasing on this region .    finally , we turn our attention to uniform measures on @xmath522 $ ] and @xmath522 ^ 2 $ ] , and the proof of formula in section [ uniform ] .",
    "the proof requires the following lemma .",
    "[ splitting ] assume @xmath111 is uniform on @xmath522 ^ 2 $ ] and @xmath256 is uniform on @xmath522 $ ] . if @xmath686 is in the support of the optimal matching @xmath24 , and @xmath687 then either @xmath688 and @xmath689 or @xmath690 and @xmath691 .",
    "note that @xmath692 exhibits no interaction terms .",
    "as the measures are symmetric under the transfomation @xmath693 and @xmath694 , the ( unique ) stable matching will be symmetric under the transformation @xmath695 .    now , let @xmath686 belong to the support of @xmath24 ; then , by invariance , we must also have @xmath696 in the support of @xmath24 .",
    "applying @xmath697 @xmath14 monotonicity to these points yields    @xmath698    now note that for fixed @xmath496 , the function @xmath699 satisfies the spence - mirrlees condition , @xmath700 .",
    "this implies    @xmath701    which is equivalent to the stated result .",
    "we now prove formula in section [ uniform ] .    by the preceding lemma , the optimal map maps the region @xmath522 \\times [ \\frac{1}{2},1]$ ] to @xmath702 $ ] and @xmath522 \\times [ 0,\\frac{1}{2}]$ ] to @xmath703 $ ] .",
    "the map in the first region then must be given by @xmath704 , and the mapping in the second region is @xmath705 by symmetry .",
    "here we prove the no bunching result , theorem [ nobunching ] , for our competitive variant of rochet and chon s screening model .",
    "we prove that @xmath706 always buy different goods .",
    "let @xmath13 and @xmath339 be the buyers they match with , respectively , and assume that @xmath12 and @xmath274 both buy the good @xmath219 ( from @xmath13 and @xmath339 respectively ) .",
    "we will show this implies @xmath707 .",
    "we have that @xmath708 .",
    "as @xmath709 and @xmath269 belong to the support of the optimal measure @xmath24 , they satisfy the @xmath697-monotonicity condition :    @xmath710    now , we have that @xmath711 , @xmath712 and @xmath713 , @xmath714 . substituting into the above equation yields :    @xmath715    the right and left hand side are identical , so we must have equality throughout . in particular ,",
    "we have that @xmath716 this implies @xmath717 ( as @xmath219 maximizes the joint surplus for @xmath13 and @xmath274 ) .",
    "but we also have @xmath718 from above .",
    "therefore    @xmath719    canceling the @xmath13 gives the desired result .",
    "10 n.  ahmad , h.k .",
    "kim , and r.j . mccann .",
    "optimal transportation , topology and uniqueness . _ bull . math .",
    "sci . _ , 1:1332 , 2011 ."
  ],
  "abstract_text": [
    "<S> we present a general analysis of multidimensional matching problems with transferable utility , paying particular attention to the case in which the dimensions of heterogeneity on the two sides of the market are unequal . a particular emphasis is put on problems where agents on one side of the market are multidimensional and agents on the other side are uni - dimensional ; we describe a general approach to solve such problems . </S>",
    "<S> lastly , we analyze several examples , including an hedonic model with differentiated products , a marriage market model where wives are differentiated in income and fertility , and a competitive variation of the rochet - chon problem . in the latter example , we show that the bunching phenomena , observed by rochet and chon in the monopoly context , do not occur in the competitive context . </S>"
  ]
}