{
  "article_text": [
    "statisticians have long been interested in combining marginal and conditional distributions in order to completely specify a joint distribution .",
    "such models appear in spatial statistics @xcite , analysis of contingency tables @xcite , bayesian prior elicitation contexts @xcite , expert systems @xcite , statistical disclosure limitation @xcite , and generally in any area of applied statistics where one wishes to build global statistical models from local information about subcollections of random variables .",
    "two fundamental theoretical questions which have been addressed in the literature are the compatibility of conditionals and marginals , and the uniqueness of the joint distribution when it exists .",
    "a collection of conditionals and marginals are compatible if there exists a joint distribution with these conditionals and marginals .",
    "the first major result along these lines is the hammersley - clifford theorem @xcite which establishes a connection between the positive joint probability distribution and the full conditionals : it provides sufficient conditions for compatibility of distributions in the setting of markov - random fields . in the discrete case",
    ", the hammersley - clifford theorem applies when there are no cells with zero probability .",
    "questions about the uniqueness of the joint distribution given a compatible collection of marginals and conditionals were addressed in @xcite and the results presented there were subsequently generalized in @xcite .",
    "@xcite also address the question of whether the given set of densities are compatible ; they describe a variety of compatibility conditions for the case of finitely many discrete random variables and give algorithms for checking the compatibility of a set of conditional probability densities .",
    "let @xmath1 be discrete random variables where the set of possible states for each @xmath2 is in the set of integers @xmath3 : = \\{1 , 2 , \\ldots , d_i\\}$ ]",
    ". the joint probability distribution @xmath4 can be represented by a @xmath5 array of nonnegative real numbers that sum to one .",
    "we define a _ full conditional _ as a conditional multi - dimensional array @xmath6 where @xmath7 $ ] and @xmath8 so that the conditional array depends on all the random variables .",
    "the precise statement of the compatibility problem for full conditionals is the following :    given partitions @xmath9",
    "@xmath10 of @xmath11 $ ] and arrays @xmath12 each of format @xmath13 , when is there a joint probability distribution @xmath14 such that @xmath15 for all @xmath16",
    "?    the compatibility problem makes sense for any set of conditionals and marginals , but we shall see a particularly simple combinatorial solution when we restrict attention to compatibility among full conditionals .    given fixed values of the conditional and marginal arrays , the problem of determining the existence of a joint probability distribution can be phrased as a feasibility question for linear programs . since",
    "marginal and conditional arrays are defined by linear and linear - fractional constraints in terms of the joint probabilities , the existence of a joint given the conditionals can be decided by determining whether or not a certain polytope is nonempty @xcite .",
    "while this solution has many attractive features ( the most important of which is the ability to include extra parameters to account for data that are  almost compatible \" @xcite ) , it does not give an intrinsic characterization of those sets of arrays which correspond to compatible conditional distributions .",
    "in particular , using linear programming to determine whether or not a set of conditionals are compatible requires the introduction of extra parameters .    in this paper , we develop intrinsic methods for determining compatibility of conditional matrices , in the presence of zero cell entries .",
    "we describe explicit algebraic restrictions on the arrays @xmath17 which guarantee that the prescribed full conditional distributions are compatible .",
    "the results can be interpreted statistically in terms of conditions that replace generalized odds ratios to allow for arbitrary patterns of zeros . in this sense ,",
    "our results provide a key link between the statistical notions of odds ratios and tools from algebraic geometry .",
    "our main result is the following theorem .",
    "[ thm : main ] an @xmath0-tuple of @xmath5 arrays @xmath18 are compatible full conditionals for the partitions @xmath19 if and only if they satisfy the following four conditions :    1 .",
    "@xmath20 for all @xmath16 and @xmath21 .",
    "2 .   if @xmath22 for some @xmath23 , then @xmath24 for all @xmath16 .",
    "3 .   for each @xmath16",
    "the @xmath25 margin of @xmath26 is an array of all ones .",
    "the entries of the arrays @xmath26 satisfy polynomial conditions which are in bijection with the induced circuits of a bipartite graph that depends on the @xmath27 and @xmath28 .",
    "the outline for the rest of the paper is as follows . in the next section ,",
    "we provide a detailed description of our results in the case of two random variables .",
    "we give precise defining relations for the space of compatible conditionals which generalize the condition that odds ratios of consistent conditionals should be the same . in particular , we give necessary and sufficient polynomial conditions for two conditionals to be compatible . in the third section , we describe the theoretical tools from combinatorial commutative algebra @xcite and discrete optimization @xcite which we will need to prove theorem [ thm : main ] . in the fourth section we provide a general proof that the space of compatible full conditionals is a unimodular toric variety .",
    "the fifth section is devoted to a few trivariate examples to illustrate the main theorem .",
    "in this section , we give a detailed explanation of our algebraic results in the case of the bivariate compatible conditional problem .",
    "we refer the reader to @xcite for the basics of algebraic geometry .",
    "we relegate technical definitions and proofs of the main theorems to the third and fourth sections .",
    "we denote the two potential conditional arrays by @xmath29 @xmath30 this yields the following parametrization of the space of compatible conditionals .",
    "[ thm : lawr ] two nonnegative arrays @xmath31 and @xmath32 represent compatible conditionals for two discrete random variables if and only if there are nonnegative parameter arrays @xmath33 , @xmath34 , @xmath35 such that @xmath36 @xmath37 for all @xmath38 and @xmath39 for all @xmath16 .    statistically , the array @xmath33 represent a joint distribution which has @xmath31 and @xmath32 as its corresponding conditionals .",
    "arrays @xmath34 and @xmath35 are marginals which when combined with appropriate conditionals give @xmath33 .",
    "this representation says that the set of all arrays @xmath31 and @xmath32 which are compatible conditions is determined by allowing the arrays @xmath40 , @xmath41 and @xmath42 to range over all nonnegative values which make @xmath31 and @xmath32 into conditional arrays .",
    "the given parametrization is by polynomial functions in the parameters , and hence there exist polynomials in the @xmath43 and @xmath44 which vanish if and only if the pair @xmath31 and @xmath32 belong to the ( closure of the ) space of compatible conditionals . in the literature of discrete optimization and toric ideals ,",
    "the parametrization defined in proposition [ thm : lawr ] is known as the lawrence lifting of the segre variety .",
    "the equations which vanish on this parametrization are well understood .",
    "( e.g. * ? ? ?",
    "14 ) the defining equations for the lawrence lifting of the segre variety are in bijection with circuits in the complete bipartite graph @xmath45 .",
    "each circuit of length @xmath46 defines a binomial of degree @xmath46 in the @xmath43 and @xmath44 .",
    "this bijection is described as follows .",
    "let @xmath47 be a circuit in @xmath45 of length @xmath46 .",
    "this circuit produces a binomial of degree @xmath46 : @xmath48 note that the degree four relations which are produced by this construction are precisely the relations which say that all the odds ratios of the matrices @xmath31 and @xmath32 must be the same . for example",
    ", the circuit of length 4 in @xmath49 produces the binomial : @xmath50 for positive @xmath31 and @xmath32 , this binomial is zero if and only if the following odds ratios are equivalent : @xmath51    it is well known that for positive matrices @xmath31 and @xmath32 , compatibility of conditional matrices is equivalent to equality of the odds ratios @xcite . in algebro - geometric terms , this says that the degree four polynomials produced by the circuit construction define the toric variety of interest set theoretically in the strictly positive orthant .",
    "however , this statement becomes false when some of the entries in @xmath31 and @xmath32 are allowed to be zero .",
    "these polynomials , in addition to addressing the compatiblity of arrays @xmath31 and @xmath32 in the presence of zero entries , also should be useful for determing the similarity of linear contrasts in the @xmath31 and @xmath32 matrices when there are zero cells @xcite . thus , these polynomials could prove useful for the analysis of incomplete contingency tables .",
    "consider the matrices @xmath52 all of the odds ratios of these matrices are the same : they are either simultaneously zero or undefined . in other words , they saitisfy all 9 polynomials which are described by circuits in @xmath53 of length 4 .",
    "however , the matrices do not represent compatible conditionals since the binomial given by the length 6 circuit @xmath54 : @xmath55 is equal to @xmath56 and not zero .",
    "these incompatible conditionals appear in @xcite .",
    "these polynomials give a parameter free method for determining if two arbitrary conditional arrays are compatible .",
    "to make the connection to the next section more lucid , we will introduce an alternate graph theoretic representation of the circuit binomials described above .",
    "this more complicated description is the one that generalizes for arbitrary sets of full conditionals in the next section .",
    "we define the bipartite graph @xmath57 to be the graph with @xmath58 vertices as follows .    1 .   there are @xmath59 vertices labeled @xmath60 where @xmath61 $ ] and @xmath62 $ ] .",
    "2 .   there are @xmath63 vertices labeled @xmath64 where @xmath65 $ ] .",
    "3 .   there are @xmath66 vertices labeled @xmath67 where @xmath68 $ ] .",
    "4 .   there is an edge between @xmath60 and @xmath64 if and only if @xmath69 .",
    "there is an edge between @xmath60 and @xmath67 if and only if @xmath70 .",
    "there are no other edges in @xmath71 .",
    "[ g23 ]    ]    the graph @xmath72 is pictured in figure 1 .",
    "associated to any circuit in @xmath57 of length @xmath46 we get a binomial of degree @xmath73 as follows .",
    "after permuting indices , circuits in @xmath57 have the form @xmath74 where @xmath75 and @xmath76 . from this circuit",
    "we recover the binomial @xmath77    which was the same binomial from our previous description .",
    "putting all these ideas together we have the following special case of theorem [ thm : main ] .    a pair of matrices @xmath31 and @xmath32 are compatible conditionals if and only if they satisfy the following properties :    1 .",
    "@xmath78 and @xmath79 , 2 .   for all @xmath16 and @xmath38 , @xmath80 if only if @xmath81 , 3 .",
    "@xmath37 for all @xmath38 and @xmath39 for all @xmath16 , and 4 .",
    "@xmath31 and @xmath32 satisfy the circuit polynomials associated to the circuits in the graph @xmath57 .",
    "in this section , we will describe the mathematical objects that we will need to describe the space of compatible conditionals .",
    "first , we show that the space of compatible conditionals is a parametrized algebraic set .",
    "the parametrization is given by monomials and this leads naturally to the definition of _ toric varieties _ and _ toric ideals_. then we introduce the notions of graphical unimodular matrices and unimodular toric varieties , which are the natural algebraic objects for representing the space of compatible conditionals .",
    "a key preliminary observation is the following :    a set of full conditional matrices @xmath17 are compatible conditionals corresponding to the partitions @xmath82 if and only if there are matrices of probabilities @xmath83 of the appropriate sizes and a @xmath5 matrix of probabilities @xmath40 such that @xmath84 for all @xmath16 where @xmath85    this is the definition of compatibility together with bayes rule .",
    "the matrices @xmath86 are then the `` missing''@xmath25-marginal distributions",
    ".    since we are interested in intrinsic characterizations of the compatible conditionals , it makes sense to rearrange this expression to deduce an equation for the @xmath26 in terms of the missing joint and conditional distributions @xmath40 and @xmath86 .",
    "thus we deduce the following corollary .",
    "[ cor : tor ] the set of all @xmath0-tuples of consistent full conditional arrays @xmath87 , @xmath88 , @xmath89 is described parameterically as @xmath90 where the multiplication is componentwise .    at first glance",
    ", the space of conditionals we have described in corollary [ cor : tor ] looks highly over - parameterized : should nt the @xmath91 parameters be related to the @xmath40 parameters by marginalization ?    we claim that we can first allow the parameters @xmath40 and @xmath86 to be arbitrary real arrays , consider the variety which is defined by this parameterization , and then intersect this variety with the appropriate product of probability simplices .",
    "the result of this procedure will be the same set of conditional arrays which is obtained by first restricting the parameters so that @xmath92 and then considering the resulting parametrically described variety . to see this , observe that the only way that @xmath26 could be a conditional array is if @xmath86 is the corresponding marginal @xmath93 , which again follows by bayes rule .",
    "let @xmath94 and @xmath95 be two full conditional matrices .",
    "note that if @xmath96 , then they are compatible if and only if @xmath94 is obtained from @xmath95 by conditioning on the variables @xmath97 .",
    "hence when determining the space of consistent conditionals for @xmath94 , @xmath95 , @xmath88 , @xmath98 , we may assume that there are no containment relations among the @xmath99 or @xmath25 .",
    "that is , the collection @xmath100 can be taken to be the facets of a simplicial complex .",
    "we will work in the polynomial ring @xmath101\\ ] ] which is a polynomial ring in @xmath102 indeterminates .",
    "each indeterminate in the ring @xmath103 corresponds to an entry in one of the @xmath0 conditional matrices . by corollary [ cor : tor ] ,",
    "the algebraic variety in @xmath104 , which , when intersected with a product of probability simplices , yields the space of consistent conditional , is given by the monomial parameterization @xmath105 where @xmath106 and the @xmath40 s and @xmath91 s are allowed to range over all of the real numbers .",
    "an algebraic variety which is given by a monomial parameterization is called a _",
    "toric variety_.    to describe the polynomials that define any toric variety amounts to understanding which products of the parameterizing monomials are equal to which other products of the parameterizing monomials .",
    "that is , the _ toric ideal _ which defines the toric variety is generated by binomials ( differences of monomials ) .",
    "the toric ideal which is the vanishing ideal of the space of compatible conditionals is denoted @xmath107 which we call the _",
    "compatibility ideal_.    furthermore , understanding which monomials are equal to each other can be studied by understanding the integer kernel of an associated matrix .",
    "a standard reference for the theory of toric ideals is @xcite .",
    "[ def : tor ] let @xmath108 be an integer matrix .",
    "the toric variety associated to @xmath109 is defined by the parameterization @xmath110 the toric ideal @xmath111 which defines this parameterized variety is generated by the ( infinitely many ) binomials @xmath112    the presentation of a toric ideal @xmath111 in definition [ def : tor ] is given with infinitely many ideal generators . however , the hilbert basis theorem implies that only finitely many of these polynomials are actually needed in a generating set of the ideal . in many situations ,",
    "the difficulty of studying toric ideals amounts to finding good combinatorial descriptions of this finite set of generators . in the case of the compatibility ideals @xmath113",
    "there is a simple combinatorial structure called _ unimodularity _ which can be used to describe the generators .",
    "a toric ideal @xmath111 is called _ unimodular _ if every reduced grbner basis of @xmath111 consists of squarefree binomials ( i.e. there are no squared variables in the leading terms of each binomial in the reduced grbner basis ) .",
    "equivalently , @xmath111 is unimodular if all the non - zero minors of @xmath109 have the same absolute value .",
    "such a matrix @xmath109 is also called unimodular .",
    "the following is an important special family of unimodular matrices ( see , for example @xcite ) .",
    "let @xmath109 be a matrix with the following properties :    1 .",
    "all the entries of @xmath109 are either zero or one , 2 .",
    "there are precisely two 1 s in each column of @xmath109 , and 3 .",
    "there is a partition of the rows of @xmath109 into two sets @xmath91 and @xmath114 such that each column of @xmath109 has exactly one nonzero entry with row index @xmath115 and one nonzero entry with row index @xmath116 .",
    "then @xmath109 is a unimodular matrix and is called a _",
    "graphical unimodular matrix_.    the reason for the name `` graphical '' is due to the fact that any graphical unimodular matrix @xmath109 is the vertex - edge incidence matrix of a bipartite graph @xmath117 .",
    "the parition of the vertices of @xmath117 corresponds to the partition of the rows of @xmath109 .",
    "notice that vectors @xmath118 correspond to the union of cycles in the graph @xmath117 .",
    "let @xmath119 be any graph .",
    "induced circuit _ of @xmath119 is a circuit of @xmath119 which does not have a chord ( i.e. a `` short cut '' ) in @xmath119 .    in the complete bipartite graph @xmath53",
    "all of the cycles of length 4 are induced , whereas none of the six cycles are induced because there is a chord cutting across them .",
    "toric ideals which are presented by a graphical unimodular matrix have a simple combinatorial description for their minimal generators in terms of the induced circuits of the associated bipartite graph .",
    "a version of the following result can be found in @xcite .",
    "let @xmath109 be a graphical unimodular matrix , and @xmath117 the associated bipartite graph .",
    "let the @xmath91 and @xmath114 be the partition of the vertices of @xmath117 where @xmath120 and @xmath121 . for each circuit",
    "@xmath122 we associate the circuit binomial @xmath123 then @xmath111 is minimally generated by the circuit binomials corresponding to the induced circuits of @xmath117 .",
    "that is , @xmath124",
    "now that we have reviewed all the mathematical facts we need about unimodular toric ideals , we are in a position to prove that the compatibility ideal is a unimodular toric ideal . to do this , we construct the matrix that represents this toric ideal .",
    "let @xmath125 be the integer vector corresponding to the dimensions of the tables let @xmath100 be the simplicial complex which represents the compatible conditionals .",
    "for each facet @xmath25 of @xmath126 , denote by @xmath127 the vector @xmath128 where @xmath129 and denote by @xmath130 the product @xmath131    we denote by @xmath132 the matrix that represents the compatibility ideal corresponding to this data .",
    "this matrix is a @xmath133 matrix .",
    "the rows are naturally grouped into @xmath134 blocks and the columns are natrually grouped into @xmath0 blocks .",
    "each column is labelled by an integer @xmath135 $ ] and an @xmath136-tuple @xmath137 \\times [ d_2 ] \\times \\cdots \\times [ d_n]$ ] .",
    "the first block of rows is labelled by the integer @xmath138 and @xmath136-tuple @xmath137 \\times [ d_2 ] \\times \\cdots \\times [ d_n]$ ] .",
    "each of the remaining blocks of rows is labelled by and integer @xmath16 and an @xmath139-tuple @xmath140 \\times \\cdots \\times [ d_{k_s}]$ ] where @xmath141 .",
    "the entries of this matrix are all ones and zeros .",
    "there is a one in a particular entry with row indexed by the data @xmath142 , @xmath143 and column indexed by the data @xmath144 , @xmath145 if and only if it satisfies the following rules :    1 .   if the row label is @xmath138 and @xmath146 or 2 .",
    "if the row label is @xmath147 , @xmath148 , and @xmath149 where @xmath150    [ thm : circuit ] the matrix @xmath132 is a graphical unimodular matrix and it represents the toric variety of the space of compatible conditionals .",
    "hence , the compatibility ideal is generated by the induced circuit binomials in the associated bipartite graph .",
    "to see that @xmath132 represents the toric variety of compatible conditionals amounts to identifying the rows of the matrix with a parameter , and the columns of the matrix with an entry in the conditional matrix .",
    "the labelling for the columns @xmath151 naturally corresponds to the indeterminate @xmath152 .",
    "a row in the first block , with @xmath153 , corresponds to the @xmath154 parameters .",
    "a row in any of the blocks with @xmath155 corresponds to the parameter @xmath156 note that be the description of the matrix @xmath157 , in the column corresponding to @xmath158 there are precisely two nonzero entries : one in the first block which corresponds to @xmath154 and one in block @xmath16 , which corresponds to @xmath159 .",
    "thus , this represents the parameterization @xmath160 as desired .",
    "now we wish to show the unimodularity of @xmath157 , however , this is an immediate consequence of the preceding argument .",
    "each column has precisely two ones : one with index @xmath153 and one with index @xmath161 .",
    "hence , the value of @xmath16 determines the partition of the rows to deduce the structure of the underlying bipartite graph .",
    "now we will explicitly describe the graph encoded by the matrix @xmath132 .",
    "the graph @xmath162 associated to the compatibility ideal has @xmath163 vertices and @xmath164 edges : these are the number of rows and columns of @xmath132 respectively .",
    "the vertices are partitioned into two class : those labelled with @xmath153 and some @xmath165 , and those labelled with @xmath166 and some @xmath167 .",
    "vertices with @xmath168 are incident only to vertices with @xmath169 and conversely .",
    "in particular , the vertex @xmath170 , @xmath171 is incident to @xmath166 , @xmath172 if and only if @xmath173 .    to close this section",
    ", we now provide the proof of theorem [ thm : main ] .",
    "* proof of theorem [ thm : main ] : * conditions ( 1)-(3 ) of theorem [ thm : main ] are clearly necessary .",
    "condition ( 4 ) is simply the expression of theorem [ thm : circuit ] above .",
    "what remains to show is that this conditions are , in fact , sufficient .",
    "suppose that a particular realization of conditional arrays @xmath17 satisfy conditions ( 1 ) - ( 4 ) .",
    "we wish to show that there exists parameter matrices @xmath40 and @xmath83 , which have @xmath17 as their image . by conditions ( 1 ) , ( 3 ) , and ( 4 ) together with a result of @xcite , this can happen if and only if the columns of @xmath132 which are indexed by the support of @xmath17 form a _ nice facial subset _ of the columns of @xmath132 .",
    "the nice facial subsets of the columns of @xmath157 are precisely those sets of columns which are obtained by taking a collection of rows @xmath103 of @xmath132 , and taking exactly those columns of @xmath132 which have zeros in the rows @xmath103",
    ". however , the support of @xmath17 is a nice facial subset of the columns of @xmath132 because of condition ( 2 ) : the rows of @xmath132 to choose are precisely those rows labelled by @xmath174 for all the indices @xmath175 where the @xmath176 are collectively zero .",
    "we will conclude our paper with some examples on three binary random variables to illustrate the construction and the types of polynomials that appear .    consider the compatibility ideal associated with three binary random variables and",
    "suppose that @xmath177 .",
    "in other words , we are considering the compatibility of @xmath178 and @xmath179 . the matrix",
    ", @xmath180 has 14 rows and 24 columns .",
    "it is the zero / one matrix    @xmath181 the graph corresponding to this compatibility problem has 14 vertices : 8 of one type and 6 of the other , and 24 edges between them .",
    "it is pictured in figure 2 .",
    "[ fig : gr ]    ]    there are three types of induced circuits in this graph , yielding three types of binomial generators of the compatibility ideal @xmath107 .",
    "we use the indeterminates @xmath182 , @xmath183 and @xmath184 to denote the corresponding entries in the conditional arrays .",
    "for instance , the circuit @xmath185 in the graph is induced and from it we deduce that the quadratic binomial @xmath186 is a minimal generator of the compatibility ideal @xmath113 .",
    "the induced circuit + @xmath187 produces the binomial @xmath188 which is also a minimal generator of @xmath107 . in total , there are 12 induced circuits of length 4 , 8 induced circuits of length 6 , and 60 induced circuits of length 8 .",
    "hence @xmath107 is minimally generated by 12 quadric , 8 cubics , and 60 quartics .",
    "consider the compatibility associated to 3 binary random variables with the simplicial complex @xmath189 .",
    "that is , we are considering the compatibility of @xmath190 , @xmath191 , and @xmath192 .",
    "use the indeterminates @xmath182 , @xmath183 , and @xmath184 to represent entries in the corresponding conditional arrays .",
    "the ideal @xmath113 is generated by 28 binomials which fall into 4 equivalence classes modulo the symmetry of the cube . in this case , the binomial minimal generators of @xmath113 are in bijection with the circuit in the edge graph of the cube .",
    "the four different types of circuit on the cube are indicated in figure 3 .",
    "[ fig : cube ]        these four types of circuits yield four different symmetry classes of binomials in the ideal @xmath107 which are represented by the following binomials :    @xmath193 @xmath194 @xmath195 @xmath196    note that the first polynomial in this list has a natural statistical interpretation : it corresponds to the equality of the odds ratios for @xmath190 and @xmath191 .",
    "while there are statistical interpretations for some of the circuit polynomials which arise , understanding these polynomial expressions in relation to known statistical quantities remains an open problem .",
    "in particular , determining how tools from the analysis of contingency tables such as generalized odds ratios and linear contrast relate to the polynomial constraints we have derived could prove useful for inference on incomplete contingency tables .",
    "aleksandra slavkovic was supported in part by national science foundation grant no .",
    "eia-0131884 to the national institute of statistical sciences ."
  ],
  "abstract_text": [
    "<S> the set of all @xmath0-tuples of compatible full conditional distributions on discrete random variables is an algebraic set whose defining ideal is a unimodular toric ideal . </S>",
    "<S> we identify the defining polynomials of these ideals with closed walks on a bipartite graph . </S>",
    "<S> our algebraic characterization provides a natural generalization of the requirement that compatible conditionals have identical odds ratios and holds regardless of the patterns of zeros in the conditional arrays .    </S>",
    "<S> odds ratios , toric ideal , unimodular </S>"
  ]
}