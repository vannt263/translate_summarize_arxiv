{
  "article_text": [
    "a very successful theoretical and computational framework was developed by king - smith and vanderbilt@xcite for dealing within periodic boundary conditions with the macroscopic dielectric polarization of an insulator .",
    "the central result of the theory of bulk polarization ( tbp ) is an expression for the electronic contribution @xmath5 which takes the form of a berry s phase@xcite of the valence - band bloch wave functions transported across the brillouin zone ( bz ) .",
    "alternatively , it can be recast in real space as the vector sum of the centers of charge of the valence - band wannier functions .",
    "practical prescriptions were devised for computing both the berry s phase@xcite and the wannier functions,@xcite which have become standard features of first - principles electronic structure codes .",
    "the measurable quantity accessed by the tbp is the change @xmath6 in macroscopic polarization induced by changing some parameter @xmath7 in the electronic hamiltonian @xmath8 $ ] .",
    "the following assumptions were explicitly made in the original derivation@xcite .",
    "( i ) adiabaticity : the change in @xmath9 is slow enough that the electrons remain in the instantaneous ground state of @xmath10 , apart from small deviations proportional to @xmath11 described by first - order adiabatic perturbation theory ; ( ii ) the ground state of @xmath10 remains insulating at all times , separated from excited states by finite energy gaps ; ( iii ) @xmath10 is lattice - periodic .",
    "the first two assumptions are related in that the size of the energy gap sets the scale for deviations from adiabaticity .",
    "a spatially homogeneous electric field necessarily violates either ( i ) or ( iii ) : if the field is introduced via a vector - potential @xmath12 , @xmath13 remains lattice - periodic but changes nonadiabatically , even for a static field ; if instead a scalar potential term @xmath14 is used , @xmath13 is no longer lattice - periodic .",
    "nevertheless , the tbp has been successfully applied to situations where electric fields are present,@xcite but a rigorous justification for doing so is still lacking .    in this paper",
    "we reexamine the tbp and find that it can be generalized as follows .",
    "assumption ( i ) can be dropped altogether . assumption ( ii )",
    "is only invoked at @xmath15 ; the ensuing nonadiabatic dynamics may admix considerable amounts of excited states into the occupied subspace . finally assumption ( iii )",
    "can be relaxed to allow for a linear scalar potential to be present in addition to the periodic crystal potential .",
    "these generalizations extend the scope of the tbp to _",
    "nonadiabatic _ polarization currents induced by time - dependent electric fields , or by other rapid changes in @xmath13 ( e.g. , the initial nonthermal ionic motion that accompanies photoexcitation of the electrons by an intense laser pulse.@xcite ) the dynamical equations for the electrons that come out of this generalized tbp are derived and applied in the context of a tight - binding model .",
    "these equations are semiclassical ( the electrons are treated quantum - mechanically , whereas the electric field is treated classically ) and nonperturbative ( electric fields of finite magnitude are allowed ) .",
    "we begin by considering in section  [ sec : dynamics_dm ] some general properties of the coherent dynamics of bloch electrons that are initially in an insulating state .",
    "they are used in section  [ sec : nonadiabatic_pol ] to discuss the macroscopic current @xmath16 , which is expressed as the rate of change of a dynamic polarization @xmath2 given by nonadiabatic versions of the king - smith  vanderbilt expressions . in section  [ sec :",
    "dynamical ] we derive from this generalized tbp a numerically convenient form for the time - dependent schrdinger equation ( tdse ) in the scalar - potential gauge , discretized on a mesh of @xmath3 points .",
    "stable stationary solutions in static fields are discussed in section  [ sec : stationary ] .",
    "they exist only below a critical field @xmath17 which decreases with increasing @xmath3-point density , and are local minima of the energy functional of nunes and gonze.@xcite a prescription is given for computing them using an iterative diagonalization scheme . in section  [ sec : results ] we show numerically on a tight - binding model how the regime above the critical field can be accessed dynamically , by gradually increasing the electric field beyond the critical value .",
    "we also compute the dielectric function of the same model in the presence of a static bias field , displaying the franz - keldysh effect .",
    "here we expound in more detail an argument , sketched in ref .  , that makes use of the one - particle density matrix to handle the presence of electric fields in a well - controlled fashion.@xcite",
    "we say that the one - particle density matrix @xmath18 is lattice - periodic if @xmath19 where @xmath20 is a lattice vector .",
    "in particular , this implies periodicity of the charge density .",
    "suppose that ( [ eq : dm_lattice_per ] ) is true at @xmath15 ( e.g. , the electrons are in the ground state of the crystal hamiltonian @xmath21 ) . at that time a homogeneous electric field",
    "is turned on , which may subsequently have an arbitrarily strong and rapid variation ; @xmath22 may also undergo arbitrarily rapid variations ( but must remain periodic ) .",
    "the full hamiltonian in the scalar potential gauge is @xmath23 where @xmath24 describes the electric field in the dipole approximation , and @xmath25 is the electron charge .",
    "let us show that in the absence of scattering the lattice - periodicity of @xmath26 is preserved at all later times .",
    "it suffices to establish that @xmath27 .",
    "the density matrix evolves according to @xmath28 $ ] , or , in the position representation , @xmath29d\\xx.\\ ] ] ( when left unspecified , the domain of integration over spatial coordinates is understood to be the entire space . ) for clarity we consider the effect of @xmath30 and @xmath31 separately .",
    "the @xmath30 term yields @xmath32d\\xx.\\end{aligned}\\ ] ] making the change of variables @xmath33 and invoking the lattice - periodicity of @xmath30 and @xmath34 , we find @xmath35 . using @xmath36 the contribution from @xmath31 is seen to have the same property : @xmath37 hence @xmath26 remains lattice - periodic under the action of the full hamiltonian ( [ eq : hamiltonian ] ) .",
    "this was to be expected , since in the vector potential gauge the hamiltonian is periodic.@xcite the purpose of this exercise was to show explicitly how this result comes about in the scalar - potential gauge , where the nonperiodicity of @xmath38 has been a source of some confusion regarding this issue .",
    "the previous result on the conservation of lattice - periodicity is valid for both metals and insulators . in what follows",
    "we shall specialize to the case where the system is initially in an insulating state , in which case a stronger statement can be made regarding the nature of the states at @xmath39 .",
    "we will assume the absence of spin degeneracy throughout , so that states are singly - occupied . in terms of the valence bloch eigenstates of @xmath40 ,",
    "the initial density matrix is @xmath41 where the integral is over the bz of volume @xmath42 , and @xmath43 is the number of filled bands .",
    "( clearly , such a density matrix is lattice - periodic .",
    "its idempotency can be checked using eq .",
    "( [ eq : normalization ] ) . )",
    "we shall prove that , as the density matrix evolves in time according to @xmath44 \\ket{\\rr'},\\ ] ] it can still be expressed in the same form , @xmath45 although at @xmath39 the occupied states @xmath46 may depart significantly from the valence states of @xmath47 , they remain orthonormal and _ bloch - like _ : @xmath48 , with @xmath49 .    the cell - periodic states @xmath50 are the central objects in our formalism . for discussion purposes only , let us expand them in the set of eigenstates @xmath51 of the cell - periodic hamiltonian @xmath52 : @xmath53 individual eigenstates will in general have fractional occupations @xmath54 at @xmath39 , but the total population @xmath55 is the same for every @xmath56 and equals the number of filled bands at @xmath15 .",
    "this is intuitively clear , since a spatially homogeneous electric field causes vertical transitions in @xmath3-space which amount to a redistribution of the electron population among states with equal @xmath56 ; the same is true for the transitions induced by varying the lattice - periodic @xmath47 .",
    "we will justify eq .",
    "( [ eq : dm_bloch ] ) by deriving a dynamics for the @xmath57 that insures that eq .",
    "( [ eq : dm_bloch ] ) provides a solution to ( [ eq : dyn_dm ] ) .",
    "since there is a gauge freedom @xmath58 is a @xmath59-dependent unitary @xmath60 matrix ) in the definition of the @xmath57,@xcite the evolution equation for them is not unique .",
    "we require only that the @xmath57 should yield the correct dynamics for the gauge - invariant density matrix , eq .",
    "( [ eq : dyn_dm ] ) , and we will look for the simplest solution that achieves this goal .    by hypothesis ,",
    "at time @xmath61 @xmath62 takes the form @xmath63.\\end{aligned}\\ ] ] as in the previous subsection , we consider the contributions from @xmath30 and @xmath31 in eq .",
    "( [ eq : dyn_dm ] ) separately .",
    "the former is captured by @xmath64 . to deal with @xmath31",
    "we resort to manipulations familiar from the crystal - momentum representation ( cmr)@xcite ( but with the crucial difference that in the cmr those manipulations are applied to the @xmath65 , not to the @xmath66 ) .",
    "we first observe that @xmath67|\\rr'\\rangle=(\\rr-\\rr')\\,n(\\rr,\\rr ' )   \\nonumber \\\\ & = & \\omega_b^{-1}\\sum_{n=1}^m\\int d\\kk\\,v_{\\kk n}(\\rr)v_{\\kk n}^*(\\rr ' ) ( -i\\partial_\\kk)e^{i\\kk\\cdot(\\rr-\\rr')}.\\end{aligned}\\ ] ] integrating by parts and noting that in a _ periodic gauge _ ( @xmath68 ) the boundary term vanishes , we obtain @xmath69|\\rr'\\rangle= \\omega_b^{-1}\\sum_{n=1}^m\\int d\\kk\\ , e^{i\\kk\\cdot(\\rr-\\rr')}ie{\\ee}\\cdot \\nonumber \\\\ & & \\qquad\\quad\\big [ \\big(\\partial_\\kk v_{\\kk n}(\\rr)\\big)v_{\\kk n}^*(\\rr ' )    + v_{\\kk n}(\\rr)\\big(\\partial_\\kk v_{\\kk n}^*(\\rr')\\big )   \\big].\\end{aligned}\\ ] ] comparing with eqs .",
    "( [ eq : dyn_dm ] ) and ( [ eq : dm_dot ] ) we arrive at @xmath70 .",
    "the effect of @xmath31 thus takes the form of a @xmath3-derivative , and the combined effect of @xmath30 and @xmath31 is @xmath71 this is our version of the tdse for bloch electrons in the scalar potential gauge , constructed in order that eq .",
    "( [ eq : dm_bloch ] ) will satisfy eq .",
    "( [ eq : dyn_dm ] ) .",
    "the time - independent version was introduced as an _ ansatz _ in ref .",
    ".@xcite the equivalence of eq .",
    "( [ eq : tdse_continuum ] ) to other forms in the literature is established in appendix  [ app : pol ] .",
    "if at time @xmath61 the @xmath43 states @xmath57 at every @xmath56 are lattice - periodic and orthonormal , the dynamics dictated by eq .",
    "( [ eq : tdse_continuum ] ) preserves those properties , i.e. , @xmath72 and @xmath73 .",
    "this can be seen as follows .",
    "starting from @xmath74 making the change of variables @xmath33 , and invoking the assumed lattice - periodicity of both @xmath30 and @xmath75 , the right - hand - side becomes @xmath76 .",
    "as for orthonormality , eq .  ( [ eq : tdse_continuum ] ) yields@xcite @xmath77 since by hypothesis @xmath78 where the integral is over a unit cell , the right - hand - side of eq .",
    "( [ eq : orthonormality ] ) vanishes .",
    "this completes the proof of eq .",
    "( [ eq : dm_bloch ] ) .",
    "two assumptions were made in the above derivation .",
    "the first is that the states @xmath66 vary smoothly with @xmath56 , so that @xmath3-derivatives exist ; we will come back to this point in sec .  [ sec : dyn_pol_disc ] .",
    "the second is that the dynamics is scattering - free .",
    "note that eq .",
    "( [ eq : orthonormality ] ) is closely related to the collisionless boltzmann equation ; incoherent scattering would destroy the constancy of the total population @xmath79 by inducing transitions between different @xmath3 points .",
    "having established that the occupied manifold is spanned by @xmath43 bloch - like states at each @xmath56 , we now transform them into wannier - like states @xmath80 in the usual way , @xmath81 where a periodic gauge is assumed and we have inserted a unitary rotation ( [ eq : gauge_transf ] ) among the occupied states . the assumption that by a judicious choice of the matrices @xmath82 the bloch - like states can be made to vary smoothly with @xmath56 is equivalent to the assumption that the wannier - like states can be chosen to be well localized.@xcite    the density matrix ( [ eq : dm_bloch ] ) can now be recast as @xmath83 we will term _ wannier - representable _ ( wr ) a state whose density matrix is of this form .",
    "an insulating ground state is wr , while a metallic state is not .",
    "we have established that under the hamiltonian ( [ eq : hamiltonian ] ) and in the absence of scattering , an initially insulating system remains wr , or `` insulating - like '' , even if at some later time the ground state of @xmath47 becomes metallic.@xcite unlike a true insulating ground state , or a stationary field - polarized state,@xcite a dynamic wr state will in general break time - reversal symmetry and carry a macroscopic current . this is the subject of the next section .",
    "our aim in this section is to show that a wr state carries a current that can be expressed as the rate of change of a polarization per unit volume , @xmath84 where @xmath2 is given in a periodic gauge by @xmath85 ( @xmath86 is a cartesian direction ) or , equivalently , by @xmath87 eqs .",
    "( [ eq : dyn_pol])-([eq : pol_wannier ] ) are identical to the king - smith  vanderbilt expressions appropriate for the adiabatic regime and @xmath88,@xcite except that in ( [ eq : dyn_pol ] ) the valence - band eigenstates @xmath65 have been replaced by the instantaneous solutions of the tdse ( [ eq : tdse_continuum ] ) , and the @xmath89 in eq .",
    "( [ eq : pol_wannier ] ) are the wannier states corresponding to the @xmath50 .",
    "( [ eq : dyn_pol ] ) can be interpreted as a _ nonadiabatic _ geometric phase.@xcite    as in the adiabatic case , @xmath2 is invariant under the transformation ( [ eq : gauge_transf ] ) only up to a `` quantum of polarization '' @xmath90 .",
    "naturally , this gauge indeterminacy does not affect the measurable @xmath16 . the total change in bulk polarization in a time interval",
    "@xmath91 $ ] is also well - defined as the integrated current : @xmath92 .",
    "it can be determined , apart from an integer multiple of the quantum , by evaluating @xmath2 at the endpoints : @xmath93 . in practice",
    "the remaining indeterminacy can be removed in the manner described in ref .  , by evaluating @xmath2 with sufficient frequency during that interval .    to establish eqs .",
    "( [ eq : curr_pol])-([eq : dyn_pol ] ) , we first evaluate @xmath94 by taking the time derivative of eq .",
    "( [ eq : dyn_pol ] ) and obtain , after an integration by parts , @xmath95.\\ ] ] inserting the tdse , eq .",
    "( [ eq : tdse_continuum ] ) , we note that the contribution arising from the second term therein , which explicitly involves @xmath4 , may be written as @xmath96 where @xmath97.\\ ] ] this takes the form of a ( nonadiabatic ) berry curvature.@xcite using stokes theorem , its volume integral can be turned into a surface integral around the edges of the bz of the berry connection @xmath98 , where @xmath99 such an integral vanishes in a periodic gauge , so that @xmath100 .",
    "the remaining contribution , arising from the insertion of the first term of eq .",
    "( [ eq : tdse_continuum ] ) into eq .",
    "( [ eq : dpdt ] ) , then gives @xmath101.\\ ] ] on the other hand , the current is @xmath102 here @xmath103 denotes the trace per unit cell , @xmath104 where @xmath105 is the ( formally infinite ) number of real - space cells in the system .",
    "the velocity operator is defined as @xmath106.\\ ] ] inserting the hamiltonian ( [ eq : hamiltonian ] ) and using @xmath107=0 $ ] , @xmath108.\\ ] ] in the position representation we find , combining ( [ eq : dm_bloch ] ) , ( [ eq : current ] ) and ( [ eq : velocity_b ] ) , invoking the lattice - periodicity of the integrand to replace @xmath109 by @xmath110 , and inserting the identity @xmath111 , @xmath112 integrating by parts in @xmath113 ( the boundary term vanishes in a periodic gauge ) , and using @xmath114 @xmath115 reduces to exactly the same expression appearing on the right - hand side of eq .",
    "( [ eq : curr ] ) .",
    "this completes the proof of eqs .",
    "( [ eq : curr_pol])-([eq : dyn_pol ] ) for wr states evolving under the hamiltonian ( [ eq : hamiltonian ] ) .",
    "we note in passing that the integral on the right - hand side of eq .",
    "( [ eq : curr ] ) can be recast as @xmath116.\\ ] ] the first term vanishes in a periodic gauge , leading to the more familiar - looking form @xmath117 where @xmath118.@xcite    the above derivations ( and indeed all the results in this paper ) remain valid for nonlocal pseudopotentials such as those used in _ ab initio _ calculations , since the definition of the velocity as the commutator ( [ eq : velocity ] ) remains valid for such pseudopotentials .",
    "it is remarkable that a knowledge of the wave functions at @xmath15 and @xmath119 is sufficient to infer , to within a factor of @xmath90 , the net amount of current that flowed through the bulk in the intervening time .",
    "this is a direct consequence of representability by localized wannier functions , that is , of the insulating - like character of the many - electron system .",
    "for such systems the integral in eq .",
    "( [ eq : pol_wannier ] ) can be evaluated , and it becomes possible to track the time evolution of the electronic center of mass , i.e. , of @xmath5 .",
    "indeed , the center of mass can be meaningfully defined within periodic boundary conditions only for many - electron states that are localized in the manner of insulating states.@xcite under these conditions , the history of the coherent current flow is contained ( modulo the quantum of polarization ) in the initial and final wave functions , related by the time evolution operator @xmath120 $ ] .",
    "this result was previously established for adiabatic charge",
    "flow,@xcite under the assumption that the ground state is separated from excited states by finite energy gaps everywhere in the bz . in nonadiabatic situations",
    "the occupied manifold acquires a significant excited - state admixture , so that it becomes impossible to identify an energy gap . instead , underlying the derivation in sec .",
    "[ sec : dyn_pol_der ] is a weaker assumption , namely , that the many - electron state has a localized nature , as reflected by the ability to construct , via eq .",
    "( [ eq : wannier_like ] ) , wannier functions having a finite localization length.@xcite ( numerical calculations of the localization length will be presented in sec .",
    "[ sec : results ] . ) for instance , when taking @xmath3-derivatives , we assumed a `` differentiable gauge '' for the @xmath66 .",
    "this is only possible if the character of the electronic manifold changes slowly with @xmath56 , which is precisely what is measured by the localization length.@xcite these observations are in line with kohn s viewpoint that the defining feature of the insulating state is wave function localization , not the existence of an energy gap.@xcite",
    "having found the berry - phase formula ( [ eq : dyn_pol ] ) for the dynamic polarization in the presence of a field @xmath1 , let us now use it to obtain computationally tractable dynamical equations under the hamiltonian ( [ eq : hamiltonian ] ) .",
    "the starting point is the observation that the dipole term @xmath31 contributes @xmath121 to the energy per unit cell .",
    "an energy functional valid for periodic boundary conditions is then obtained by expressing @xmath2 via the tbp formulas .",
    "this program was previously carried out for insulators in static fields,@xcite where stationary states were computed by minimizing that energy functional after applying a regularization procedure ( truncation of the wannier functions in real space or discretization of @xmath3-space ) .",
    "our strategy for the time - dependent problem is to impose stationarity on the corresponding action functional . following refs .",
    ", we adopt here a @xmath3-space formulation , which is particularly well - suited for numerical work .",
    "special emphasis will be put on the discrete-@xmath3 case since this is the relevant one for numerical implementations .      in the continuum-@xmath3 limit the tdse may be formally obtained from a lagrangian density @xmath122 such that the lagrangian per unit cell is @xmath123 . for wr states under the hamiltonian ( [ eq : hamiltonian ] ) we have @xmath124 where @xmath125 using eq .",
    "( [ eq : dyn_pol ] ) and defining the zero - field energy functional @xmath126 one finds the total energy functional @xmath127 the euler - lagrange equation@xcite @xmath128 then leads to the dynamical equation ( [ eq : tdse_continuum ] ) .",
    "as already mentioned , the choice of dynamical equation for the @xmath66 is not unique .",
    "an alternative to eq .",
    "( [ eq : tdse_continuum ] ) is @xmath129 the bare derivative @xmath130 has been replaced by @xmath131 where @xmath132 is given by eq .",
    "( [ eq : connection ] ) .",
    "the operator @xmath133 is a multiband version of the covariant derivative@xcite and is discussed further in appendix  [ app : cov ] .",
    "although the field - coupling term in eq .",
    "( [ eq : tdse_continuum_cov ] ) is no longer a scalar potential term in the strict sense , we will continue to view it as such in a generalized sense .",
    "( [ eq : tdse_continuum_cov ] ) preserves the orthonormality of the @xmath66 and generates the correct dynamics for the density matrix .",
    "( these properties rely on @xmath134 , which follows from @xmath135.@xcite ) the latter is most easily seen from the dynamics of the projector @xmath136 which completely specifies the occupied subspace at @xmath56 while being insensitive to unitary rotations inside that subspace .",
    "after some algebra , it can be shown that while the individual @xmath66 behave differently under eqs .",
    "( [ eq : tdse_continuum ] ) and ( [ eq : tdse_continuum_cov ] ) , @xmath137 stays the same .",
    "an advantage of introducing eq .",
    "( [ eq : tdse_continuum_cov ] ) in place of eq .",
    "( [ eq : tdse_continuum ] ) is that , upon the discretization of @xmath3-space , the former leads to an evolution equation at point @xmath56 that is gauge - covariant ( in the sense of transforming in the obvious way under unitary rotations among occupied states at @xmath56 and being invariant under such rotations at neighboring points @xmath138 ) , as will become clear in the next section .",
    "this is the relevant case for numerical work .",
    "the lagrangian for a uniform mesh of @xmath105 points in the bz is @xmath139 where @xmath140 is the energy in an electric field , @xmath141 with @xmath142 and a discretized expression for @xmath5 to be given shortly . applying the lagrangian equations of motion @xcite @xmath143 yields @xmath144 writing @xmath145 where @xmath146 and @xmath147 are the direct and reciprocal lattice vectors respectively , and defining @xmath148 the last term in eq .",
    "( [ eq : td_dva ] ) becomes @xmath149 according to the berry - phase theory of polarization,@xcite @xmath150 is the string - averaged discretized geometric phase along the @xmath147 direction , @xmath151 here @xmath152 is the @xmath60 overlap matrix , @xmath153 is the number of strings along @xmath154 , each containing @xmath155 points @xmath156 , @xmath157 is a point on the @xmath158 plane labeled by @xmath159 , and @xmath160 .",
    "( [ eq : pdotb ] ) and ( [ eq : discrete_phase ] ) provide the discretized version of the nonadiabatic berry - phase polarization , eq .",
    "( [ eq : dyn_pol ] ) .",
    "( a discrete-@xmath3 formula for the macroscopic current @xmath16 is given in appendix  [ app : discr ] . ) as in the continuum case , a periodic gauge is assumed .",
    "a compact expression for @xmath161 is derived in appendix [ app : grad - b ] using the following notation .",
    "let @xmath162 , where @xmath163 . the overlap matrix becomes @xmath164 .",
    "next we define latexmath:[\\[\\label{eq : def - vtkis }    { \\big(s_{\\kk i\\sigma}^{-1}\\big)}_{mn }    @xmath57 in the space of the @xmath166 s at the neighboring point @xmath167 , since @xmath168 the @xmath169 are gauge - covariant in the sense that ( i ) they are invariant under unitary rotations among the @xmath170 at any neighboring point @xmath167 , and ( ii ) they transform under unitary rotations among the @xmath66 in the same manner as the @xmath66 themselves , i.e. , @xmath171 then it is shown in appendix [ app : grad - b ] that @xmath172 combining eqs .",
    "( [ eq : td_dva ] ) , ( [ eq : td_dvb ] ) , and ( [ eq : grad_gamma ] ) , and defining @xmath173 the dynamical equation becomes @xmath174    eq .",
    "( [ eq : td_discrete_a ] ) is a discretized version of eq .",
    "( [ eq : tdse_continuum_cov ] ) , i.e. , @xmath175 this is connected with the fact that the duals provide a natural framework for writing a finite - difference representation of @xmath176.@xcite in our notation , @xmath177    both dynamical equations ( [ eq : tdse_continuum ] ) and ( [ eq : tdse_continuum_cov ] ) lead to @xmath178 for wr manifolds , so that the time evolution of the individual states @xmath57 is unitary .",
    "this property is preserved in the discretized form ( [ eq : td_discrete_a ] ) , since @xmath179 . in order to take advantage of certain unitary integration algorithms ,",
    "it is useful to recast the term @xmath180 on the right - hand - side as an hermitian operator acting on @xmath57 .",
    "for that purpose let us define @xmath181 which converts an occupied state at @xmath56 into its dual at @xmath167 and is invariant under gauge transformations ( i.e. , under independent unitary rotations among occupied states at both @xmath56 and @xmath167 ) .",
    "it follows that the operator @xmath182 turns @xmath57 into @xmath180 , which is the property we seek .",
    "lastly , for the purpose of acting on @xmath57 the nonhermitian @xmath183 can be replaced by @xmath184 since @xmath185 , so that @xmath186 ( where @xmath187 ) and therefore @xmath188 .",
    "we have thus achieved our goal : eq .",
    "( [ eq : td_discrete_a ] ) now takes the canonical form of a tdse , @xmath189 with an hermitian operator on the right - hand side : @xmath190 we remarked previously that in the continuum-@xmath3 limit eq .",
    "( [ eq : td_discrete_a ] ) reduces to eq .",
    "( [ eq : tdse_continuum_cov ] ) . the corresponding analysis for eqs .",
    "( [ eq : td_discrete_b])-([eq : t_k ] ) is left to appendix  [ app : cov ] .",
    "the operator @xmath183 appearing in eq .",
    "( [ eq : t_k ] ) is defined via eqs .",
    "( [ eq : def - vtkis ] ) , ( [ eq : pkis ] ) , and ( [ eq : wkhat ] ) .",
    "it should be emphasized that it depends explicitly on the occupied states at @xmath56 and @xmath167 .",
    "in particular , even when @xmath191 and @xmath4 are time - independent , if the occupied manifolds at @xmath56 and @xmath167 are changing over time , so is @xmath192 .",
    "however , @xmath192 remains invariant under unitary rotations at @xmath3-points @xmath56 and @xmath167 .",
    "hence the resulting dynamics of the occupied manifold ( eq .  ( [ eq : td_projector ] ) below ) has the essential property of being insensitive to the gauge arbitrariness that is always present in numerical simulations .",
    "note that when the lagrangian procedure was applied in sec .",
    "[ sec : td_continuum ] to the continuum-@xmath3 problem , we arrived at eq .",
    "( [ eq : tdse_continuum ] ) , which contains @xmath193 . when the same was done after discretization , the resulting dynamical equation contained instead @xmath176 .",
    "the reason is that the gradient of the discretized berry s phase , eq .",
    "( [ eq : grad_gamma ] ) , is by construction orthogonal to the occupied subspace at @xmath56 , whereas the corresponding continuum-@xmath3 term used in sec .",
    "[ sec : td_continuum ] was not .",
    "had we orthogonalized that term , we would have obtained @xmath194 instead of @xmath193 , which is equivalent to @xmath176 ( see appendix  [ app : cov ] ) .      in the applications of sec .",
    "[ sec : results ] we use the algorithm@xcite    @xmath195    to perform the time integration .",
    "note that in order to use this algorithm it was necessary to invoke the form ( [ eq : td_discrete_b ] ) of the tdse .",
    "the hermiticity of @xmath196 guarantees that the time evolution is strictly unitary for any value of @xmath197 . since the system under study in sec .",
    "[ sec : results ] is a tight - binding model with only three basis orbitals , the matrix inversion is very inexpensive . the same algorithm has been successfully used to perform self - consistent time - dependent density - functional calculations of the optical properties of atomic clusters using localized orbitals as a basis set.@xcite for calculations with large basis sets ( e.g. , plane - waves ) more efficient algorithms are available.@xcite    owing to the hermiticity of @xmath192 , the projector ( [ eq : projector ] ) obeys @xmath198.\\ ] ] hence , a variation of the above approach would be to replace @xmath192 by @xmath199 which is also hermitian . because @xmath200=[\\tk,\\hat{p}_\\kk]$ ] , this choice does not change the dynamics of the occupied subspace @xmath137 , but it does change the dynamics of the individual states @xmath57 .",
    "in fact , @xmath201 generates a _",
    "parallel transport _ evolution characterized by @xmath202 , thus discarding the `` irrelevant '' part of the dynamics associated with phase factors and unitary rotations inside the occupied subspace .",
    "we have found empirically , however , that the use of @xmath201 in eq .",
    "( [ eq : time_evolution ] ) appears to result in a less stable numerical time evolution , and we have therefore chosen to retain the original @xmath192 dynamics in our practical implementation .",
    "it may seem surprising that a linear potential can be accommodated in a theoretical description of a periodic bulk system .",
    "a commonly - held viewpoint is that a linear potential can be implemented within periodic boundary conditions only for the case of a finite system ( molecule or cluster ) in a supercell , in which case it becomes possible to introduce a sawtooth potential as long as its discontinuity is located in a region of negligible electron density . to the contrary , eqs .",
    "( [ eq : tdse_continuum ] ) , ( [ eq : tdse_continuum_cov ] ) , and ( [ eq : td_discrete_b ] ) demonstrate that it is perfectly permissible to insist on the usual periodic boundary conditions on the wave functions while allowing for nonperiodicity of the potential .",
    "this can be done because the potential takes the special form of a sum of spatially periodic and linear contributions , relevant to a crystal in a homogeneous electric field .",
    "as shown in sec .",
    "[ sec : periodicity ] , the action of the nonperiodic hamiltonian , eq .",
    "( [ eq : hamiltonian ] ) , then preserves the lattice periodicity of the density matrix , which can therefore be represented by periodic wave functions .",
    "incidentally , we note that a sawtooth operator of sorts is `` hiding '' behind the tbp formulas .",
    "the berry - phase polarization has been recast as the expectation value of a properly - defined center - of - mass position operator of the many - electron periodic system.@xcite that operator , introduced by kohn,@xcite is a sawtooth , not in real space but in the configuration space of the many - body wave function .",
    "it can only be constructed for wave functions having a certain disconnectedness ( localization ) property in configuration space characteristic of the insulating state .",
    "this observation is closely related to the discussion in sec .",
    "[ sec : dyn_pol_disc ] .    finally , we mention that an alternative approach for introducing a linear potential into a periodic solid is via the crystal momentum representation ( cmr ) formalism.@xcite this approach is summarized in appendix  a , where the connection with our formalism is established .",
    "the cmr dynamical equations appear to be less convenient for computational work .",
    "however , the advantages of the present formulation came at the expense of generality , since our equations are restricted to the scattering - free dynamics of initially insulating systems .",
    "let us try to find , for a constant @xmath203 , solutions to eq .",
    "( [ eq : td_discrete_b ] ) for which the occupied manifold remains unchanged over time .",
    "a natural guess is the manifold spanned by @xmath43 eigenstates of @xmath192 at each @xmath56 , @xmath204 since @xmath192 depends on the occupied states at the neighboring @xmath3-points , eq .",
    "( [ eq : eigenequation_tk ] ) must be solved self - consistently among all @xmath56 . if a solution exists , the corresponding @xmath196 and @xmath205 commute and , according to eq .",
    "( [ eq : td_projector ] ) , @xmath206 , i.e. , the solution is stationary .",
    "we are now ready to make contact with refs .  , where the energy functional @xmath140 of nunes and gonze,@xcite eq .",
    "( [ eq : energy ] ) , was minimized at fixed @xmath4 .",
    "a stationary point of @xmath140 has zero gradient : @xmath207 , where the functional derivative is taken in such a way that the gradient is orthogonal to the occupied space . in appendix",
    "[ app : grad - b ] it is shown that @xmath208 so that solutions of eq .",
    "( [ eq : eigenequation_tk ] ) obey @xmath209 .",
    "thus , stationary solutions of the dynamical equation are stationary points of @xmath140 .",
    "a hessian stability analysis@xcite shows that a necessary condition for a stationary point of @xmath140 to be a minimum is that the @xmath43 lowest - lying eigenstates of @xmath192 are chosen . since doing so at @xmath88 yields the ground state , at finite @xmath4 that procedure yields a state that is is adiabatically connected to it by slowly ramping up the field , keeping the system in a minimum of @xmath140",
    "such `` polarized manifolds '' have been discussed previously in a perturbative framework,@xcite treating @xmath56 as a continuous variable . in that limit",
    "the electric field perturbation becomes singular .",
    "that is , even an arbitrary small field induces a current via zener tunneling to higher bands , and the polarized manifolds are not stationary , but rather , are long - lived resonances . in other words , an infinite crystal in the presence of a static electric field",
    "does not have a ground state .",
    "this is reflected in @xmath140 loosing its minima as soon as @xmath4 departs from zero .    instead , for a discrete mesh of @xmath3-points",
    ", arguments can be given@xcite suggesting that @xmath140 loses its minima only when @xmath4 exceeds a critical value @xmath210 that decreases as the number @xmath105 of @xmath3 points increases ; this is supported by numerical calculations.@xcite it follows from the preceding discussion that the minima of @xmath140 below @xmath210 are stable stationary solutions of the dynamical equation .",
    "conversely , above @xmath210 there are no such solutions .    these two regimes   below and above the critical field   will be explored numerically in sec .",
    "[ sec : efield_turn_on ] via time - dependent calculations .",
    "if one stays below @xmath210 , the stationary solutions can be computed using time - independent methods , such as the diagonalization algorithm described next or the minimization methods of refs .  .",
    "we have in eq .",
    "( [ eq : eigenequation_tk ] ) the basis for an algebraic method of computing stationary states at finite @xmath4 on a uniform @xmath3-point mesh , for @xmath211 : loop over the @xmath3 points ; for each one select the @xmath43 eigenstates of @xmath192 with the lowest eigenvalues ; iterate until the procedure converges at all @xmath56 and the occupied subspace stabilizes ( this will only happen below @xmath17 ) . even in a tight - binding model without charge self - consistency ,",
    "the set of equations ( [ eq : eigenequation_tk ] ) has to be solved self - consistently throughout the bz , since the operators @xmath192 couple neighboring @xmath3 points via their dependence on the @xmath66 .",
    "one may choose to update @xmath192 either inside or outside the loop over @xmath56 ; the latter option renders the algorithm parallelizable over @xmath3 points .",
    "we have tested this scheme on the tight - binding model of sec .",
    "[ sec : results ] , and confirm that it produces the same state as a direct steepest - descent or conjugate - gradients minimization of the functional @xmath140.@xcite this algorithm may be especially suited for implementation in certain total - energy codes that are based on iteratively diagonalizing the kohn - sham hamiltonian expanded in a small basis set of local orbitals.@xcite      eq .",
    "( [ eq : eigenequation_tk ] ) is a discretization of the time - independent version of eq .",
    "( [ eq : tdse_continuum_cov ] ) : @xmath212 an analysis of the eigenvalues of this equation will serve as a guide for discussing those of eq .",
    "( [ eq : eigenequation_tk ] ) .",
    "( for the present purposes we will assume that the continuum form ( [ eq : stationary_continuum_cov ] ) has solutions for @xmath203 . ) as a result of the properties of the covariant derivative ( appendix  [ app : cov ] ) the @xmath213 are invariant under diagonal gauge transformations @xmath214 . upon multiplying on the left by @xmath215 the second term on the left - hand - side of eq .",
    "( [ eq : stationary_continuum_cov ] ) vanishes . integrating over @xmath56 and summing over @xmath216",
    ", we then find @xmath217 where @xmath218 is the zero - field energy functional ( [ eq : energy0 ] ) evaluated at the field - polarized stationary state , and the inequality follows from the variational principle .",
    "the same properties hold for the eigenvalues of the discretized form  ( [ eq : eigenequation_tk ] ) , which can be obtained by diagonalizing @xmath219 inside the occupied manifold .",
    "we have here the interesting situation that a minimum of the _ total _ energy @xmath140 can be obtained by solving the eigenvalue equations ( [ eq : eigenequation_tk ] ) whose eigenvalues , summed over @xmath216 and @xmath56 give instead the _ zero - field _ contribution @xmath220 .",
    "this can be traced back to eq .",
    "( [ eq : orthogonal ] ) , which expresses the `` parallel - transport - like '' nature of the covariant derivative .",
    "the above is to be compared with the time - independent version of eq .",
    "( [ eq : tdse_continuum ] ) , @xmath221 under a diagonal transformation @xmath222 its eigenvalues change as @xmath223 .",
    "the analog of eq .",
    "( [ eq : inequality ] ) is @xmath224 the quantity on the right - hand side is now the total energy @xmath140 , which is invariant only modulo @xmath225 .    although the individual eigenstates of eq .",
    "( [ eq : stationary_continuum_cov ] ) are in general different from those of eq .",
    "( [ eq : stationary_continuum ] ) , the self - consistent solutions for all @xmath56 and @xmath216 span the same space in both cases , i.e. , they differ only by a gauge transformation .",
    "it is then a matter of convenience to choose which of the two equations to solve in practice .",
    "our particular approach is to discretize eq .",
    "( [ eq : stationary_continuum_cov ] ) in a gauge - covariant manner , and then solve the resulting eq .",
    "( [ eq : eigenequation_tk ] ) .",
    "we have applied our scheme to the one - dimensional tight - binding model of ref .  , a three - band hamiltonian with three atoms per unit cell of length @xmath226 and one orbital per atom , @xmath227 \\big\\},\\ ] ] with the site energy given by @xmath228 . here",
    "@xmath229 is the cell index , @xmath230 is the site index , and @xmath231 .",
    "before the berry - phase polarization can be computed@xcite ( or an electric field applied to the system@xcite ) , the position operator must be specified .",
    "although this may be done without introducing additional parameters,@xcite we adopt the simple prescription of ref .  :",
    "@xmath232 , with @xmath233 . in the results reported below we have set @xmath234 , @xmath235 , and @xmath236 , and only the lowest band",
    "is filled ( with single occupancy ) .",
    "[ fig1 ] shows the band structure at zero field for @xmath237 .",
    "the hamiltonian of eq .",
    "( [ eq : tb_ham ] ) is a simple model of a commensurate charge - density wave which slides by one period as the parameter @xmath86 evolves adiabatically through @xmath238 .",
    "it is easiest to see this by noting that in the space of parameters @xmath239 and @xmath240 , cycling @xmath86 by @xmath238 corresponds to tracing a circle about the origin in the @xmath241@xmath242 plane .",
    "the system is insulating ( i.e. , a gap remains open ) at all points in this plane except for a singular point at the origin where the system is metallic .",
    "thus , this cyclic adiabatic change in @xmath30 takes the system along an insulating path that encircles this singular point , so that a quantized particle transport @xmath243 of a unit charge is obtained.@xcite    away from the adiabatic regime , deviations from exact quantization are expected .",
    "this can be understood from the fact that under nonadiabatic conditions the state at time @xmath61 depends on the history at times @xmath244 .",
    "in particular , the final state may be be different from the initial one even though @xmath245 , in which case @xmath246 .",
    "by contrast , an adiabatically - evolving system has no memory , being completely determined by the instantaneous @xmath47 and @xmath247 .    to illustrate this point",
    ", we increased @xmath86 from @xmath248 to @xmath238 during a time interval @xmath249 $ ] according to @xmath250 , and held it constant afterwards .",
    "the system was prepared at @xmath15 in its ground state , and the wave functions evolved in time according to eq .",
    "( [ eq : time_evolution ] ) , using @xmath251 ( the same time step was used in all other simulations in this work ) . at each time step",
    "we computed the dynamic polarization using eq .",
    "( [ eq : discrete_phase ] ) .    the resulting @xmath252 for @xmath253 and 200 @xmath3 points is shown in fig .  [ fig2 ] , where we also display the exact adiabatic ( @xmath254 ) limit @xmath255 $ ] obtained by diagonalizing @xmath256 on the same mesh of @xmath3 points.@xcite ( to check that our calculations are converged with respect to the number of @xmath3 points , the inset of fig .",
    "[ fig2 ] compares the results for 100 and 200 @xmath3 points . )",
    "the dynamic polarization @xmath252 obtained by solving the tdse follows closely , but not exactly , the adiabatic curve . in particular , at the time @xmath257 when the hamiltonian stops changing , the polarization differs slightly from unity ( see inset in fig .  [ fig2 ] ) , indicating that the system is not in the ground state .",
    "the oscillations that follow arise from quantum interference ( beats ) between valence and conduction states , as a result of having excited electrons across the gap during @xmath91 $ ] .",
    "their period , of 5.5 time units , corresponds to the fundamental gap in fig .",
    "[ fig1 ] , @xmath258 .",
    "this is consistent with the @xmath3-space distribution of the ( small ) electron - hole pair amplitude present in the system after time @xmath259 : for a sliding period of @xmath253 , the distribution is mostly concentrated around @xmath260 , and it is essentially the lowest conduction band that gets populated . as the adiabatic limit is approached by increasing @xmath259 , the amplitude of the remnant oscillations of the polarization decreases .",
    "this is illustrated in the upper panel of fig .",
    "[ fig3 ] , where we compare @xmath253 with @xmath261 .    besides the macroscopic polarization @xmath252 , another quantity of interest is the electronic localization length @xmath262 that characterizes the root - mean - square quantum fluctuations of the macroscopic polarization.@xcite it is given by @xmath263 , where @xmath264 is a gauge - invariant quantity which in one dimension is equal to the spread of the maximally - localized wannier functions ( [ eq : wannier_like]).@xcite we have computed @xmath264 using eq .",
    "( 34 ) from ref .  , and in the lower panel of fig .",
    "[ fig3 ] we plot @xmath262 against @xmath265 . in the adiabatic limit the resulting curve consists of three identical oscillations ,",
    "reflecting the existence of three equivalent atoms in the unit cell .",
    "as nonadiabaticity increases , @xmath266 tends to increase as well .",
    "nevertheless , the electrons remain localized , i.e. , `` insulating - like '' , in the sense discussed in sec .  [ sec : dyn_pol_disc].@xcite    the above results are representative of the regime where deviations from adiabaticity are small .",
    "if we increase the degree of nonadiabaticity by choosing a smaller @xmath259 ( e.g. , @xmath267 ) , we begin to notice a linear increase of the polarization at later times .",
    "this new behavior can be traced to the excitation of electron and hole wavepackets centered at some @xmath268 and propagating at different group velocities .",
    "let @xmath269 be the interband separation , and @xmath270 be the difference of group velocities of the two lowest bands , at @xmath268 .",
    "then , in addition to the quantum beats of period @xmath271 caused by the interband dynamics , we observe a linear - in-@xmath61 term in @xmath252 with slope proportional to @xmath270 , reflecting the change in dipole moment as the electron - hole pair separates .",
    "( more precisely , the preceeding statements apply only in the limit of a dense @xmath3-point mesh ; for any finite mesh spacing @xmath272 , the linear behavior is replaced by an oscillatory one with an amplitude scaling as @xmath273 and period @xmath274 .",
    "thus , an especially fine @xmath3-point mesh should be used if these effects are to be investigated . )      in the previous example the electric field was held at zero , and the dynamics was produced by varying the parameter @xmath86 in @xmath30 .",
    "let us now study the polarization response of the system when an electric field @xmath275 is switched on linearly over a time interval @xmath91 $ ] and is held fixed afterwards .",
    "we have set @xmath237 , so that the ground state is centrosymmetric , with zero spontaneous polarization .",
    "we begin by considering a situation where the final value of the field , @xmath276 , is smaller than the @xmath3-mesh - dependent critical field @xmath210 above which the energy functional ( [ eq : energy ] ) has no minima .",
    "this allows us to compare the dynamic polarization @xmath252 with the static polarization @xmath277 $ ] of the stationary state in the presence of the same field , which we find by minimizing the energy.@xcite in fig .",
    "[ fig4 ] we display the results for @xmath278 and two different switching times , @xmath267 and @xmath253 .",
    "the simulation was done using 200 @xmath3 points , to which corresponds a critical field @xmath279 .",
    "( the inset shows the agreement between the results obtained using 100 and 200 @xmath3 points . ) clearly , @xmath252 tracks quite closely the adiabatic curve @xmath277 $ ] , the more so as @xmath259 increases .",
    "this illustrates the point , emphasized in ref .",
    ", that the state obtained by minimizing a field - dependent energy functional should be thought of as the one which is generated from the zero - field state by adiabatically turning on @xmath280 .",
    "let us now explore the regime above @xmath210 , where energy - minimization schemes fail . for @xmath281 the exact adiabatic limit of the process of ramping up",
    "the field is unattainable . nevertheless , if @xmath276 is small compared to the field scale at which _ intrinsic _ breakdown occurs ( i.e. , at which the zener tunneling rate becomes on the of order interband frequencies , which is a bulk property @xcite ) , a _ quasistationary _",
    "state should be reachable by turning on the field at a rate that is slow compared to the usual electronic processes , but fast compared to the characteristic tunneling rate at the maximum field encountered . after the ramp - up is completed , but at times still short compared to the tunneling rate",
    ", this state should provide the appropriate extrapolation to fields above @xmath210 of the truly stationary state that exists below @xmath210 .",
    "to illustrate this situation , we repeated the calculation with 200 @xmath3 points depicted in fig .",
    "[ fig4 ] , but increasing the maximum field from 0.025 to 0.05 , somewhat larger than @xmath282 .",
    "the resulting curve for @xmath252 is very similar to that in fig .",
    "[ fig4 ] , without any sign of runaway behavior . as a more striking example",
    ", we show in fig .",
    "[ fig5 ] the outcome of calculations with the same final field of @xmath283 , but with even denser sets of 400 and 800 @xmath3 points . for the latter @xmath284 ,",
    "considerably smaller than @xmath276 , and still there is no sign of instability .",
    "( note also that the @xmath252 curve in fig .",
    "[ fig5 ] ",
    "whose vertical scale differs from that in fig .",
    "[ fig4 ] by the same factor of two that exists between the respective values of @xmath276",
    "  looks almost identical to that in fig .",
    "[ fig4 ] . )",
    "these results confirm that , as long as we are solving a _ time - dependent _ schrdinger equation for a given history of switching on the field , there is no such thing as a @xmath272-dependent critical field ; the thermodynamic limit of an infinitely dense @xmath3-point mesh is perfectly well defined .",
    "the only breakdown behavior that may be observed in short time scales is the physical one that occurs when the applied field is large enough that the zener tunneling rate becomes significant.@xcite the concept of a @xmath272-dependent critical field applies only to the attemp to obtain solutions in the presence of a static electric field from an energy variational principle . by going back to the original dynamical problem of slowly ramping up the field",
    ", we circumvent the difficulties that ultimately resulted from trying to treat as a ( stable ) stationary state what is really a long - lived resonance .",
    "there is great interest in modulating the optical properties of crystals and superlattices by applying static electric fields .",
    "an example of such an electro - optical effect is the modification of the dielectric function .",
    "this is known as the franz - keldysh effect , or electroabsorption .",
    "although it has been extensively studied in bulk semiconductors,@xcite quantum wells,@xcite and superlattices,@xcite we are not aware of any first - principles investigations .",
    "the present method may provide a route to such calculations .",
    "we compute the dielectric function in the presence of a static field @xmath285 as follows .",
    "the system is prepared at @xmath15 in the stationary state polarized by a field @xmath286 , with @xmath287 . by using a field of magnitude below the critical field",
    ", we are able to find that state by minimizing the energy . for @xmath39 we let the system evolve in time in the presence of the target field @xmath285 .",
    "let @xmath288 $ ] be static polarization of the system under the field @xmath285 .",
    "the polarization response to the step - function discontinuity in @xmath289 is @xmath290 $ ] . to obtain the frequency - dependent response",
    "we need the fourier transform of @xmath291 for @xmath39 only : @xmath292 where a damping factor @xmath293 has been introduced as an approximate way to account for level broadening.@xcite to linear order in @xmath294 the susceptibility is @xmath295}(\\omega)= \\left .",
    "\\frac{dp_{\\rm static}[{\\cal e}]}{d{\\cal e}}\\right|_{{\\cal e}={\\cal e}_0 } - \\frac{\\omega}{\\delta \\cal e}\\,{\\rm im}\\,\\delta p(\\omega),\\ ] ] @xmath296}(\\omega)=\\frac{\\omega}{\\delta \\cal e}\\ , { \\rm re}\\,\\delta p(\\omega).\\ ] ]    with this real - time approach the need to perform a summation over conduction - band states is circumvented .",
    "previous real - time , scalar potential approaches@xcite were restricted to finite systems , since it was unclear how to evaluate the dynamic macroscopic polarization of an extended system . a real - time",
    ", vector - potential scheme valid for bulk systems was proposed in ref .  .",
    "we validate our method by comparing in fig .",
    "[ fig6 ] the ground - state susceptibility with the analytic kubo - formula ( sum - over - states ) result , using in both cases the same broadening @xmath293 and @xmath3-point mesh .",
    "also shown in fig .",
    "[ fig6 ] is the susceptibility in the presence of a @xmath297 bias field , displaying the franz - keldysh effect : an absorption tail below the gap caused by photon - assisted tunneling , and oscillations above the gap.@xcite the franz - keldysh oscillations become more widely spaced with increasing @xmath285 .",
    "this is illustrated in the inset of fig .",
    "[ fig6 ] , where we compare them for @xmath297 and @xmath298 .",
    "the work of king - smith and vanderbilt demonstrated that the bulk electronic polarization , defined in terms of the current flowing during the _ adiabatic _ evolution of an insulating system in a _ vanishing macroscopic electric field _ , could be related to a berry s phase defined over the manifold of occupied bloch states.@xcite we have generalized this result by considering the time evolution of an initially insulating electron system under the very general hamiltonian ( [ eq : hamiltonian ] ) , where the lattice - periodic part @xmath47 and the homogeneous electric field @xmath1 may have an arbitrarily strong and rapid variation in time . in the absence of scattering",
    ", we have proved that the integrated current @xmath299 is still given by the king - smith  vanderbilt formula , but written in terms of the instantaneous bloch - like solutions of the time - dependent schrdinger equation .",
    "the coherent dynamic polarization @xmath300 was interpreted as a nonadiabatic geometric phase.@xcite these generalizations of the theory allowed us to justify recent developments in which the energy functional @xmath140 of nunes and gonze@xcite has been used as the basis for direct dft calculations of insulators in a static homogeneous electric field.@xcite the limitation of those methods to fields of magnitude smaller than a @xmath301-dependent critical field that vanishes in the thermodynamic limit has been removed : we have shown numerically that quasistationary states in finite fields exist for arbitrarily dense @xmath3-point meshes , and can be obtained by solving the time - dependent shrdinger equation for a slowly - increasing field .",
    "the present method also provides a convenient framework for the computation of coherent time - dependent excitations in insulators . as an example",
    ", the dielectric function was calculated for a tight - binding model by considering the response to a step - function discontinuity in @xmath1 , illustrating effects such as photon - assisted tunneling and franz - keldysh oscillations .",
    "a full _ ab initio _ implementation within the framework of time - dependent density - functional theory should be possible .",
    "this work was supported by nsf grant dmr-0233925 and by darpa / onr grant n00014 - 01 - 1 - 1061 .",
    "we wish to thank m.  h.  cohen for many useful discussions .",
    "the introduction of linear scalar potentials in crystals is usually discussed in the language of the crystal - momentum representation ( cmr).@xcite instead , we have used the berry - phase theory of polarization , and the purpose of this appendix is to show how to switch from one to the other .",
    "the cmr uses as a basis the eigenstates @xmath302 of @xmath30 with eigenvalues @xmath303 . in accordance with eq .",
    "( [ eq : norm_conv ] ) we assume that @xmath304 integrates to one over the unit cell volume @xmath305 . that implies@xcite @xmath306 the cmr expansion of the identity operator is @xmath307 so that a general one - electron state @xmath308 is expanded as @xmath309 where @xmath310 . for the occupied bloch - like states",
    "@xmath311 in a wr manifold , the cmr wave function @xmath312 takes the form @xmath313 with @xmath314 , which leads to eq .",
    "( [ eq : linear_comb ] ) .",
    "the velocity operator ( [ eq : velocity_b ] ) is diagonal in @xmath56 and is conveniently split into a sum of two operators , one diagonal and the other off - diagonal in the band index:@xcite @xmath315 the matrix elements of @xmath316 are @xmath317 where @xmath318",
    "the matrix elements of @xmath319 are @xmath320 where @xmath321\\ ] ] and we have defined the hermitian matrix @xmath322 which is analogous to eq .",
    "( [ eq : connection ] ) for the @xmath66 .",
    "the current , eq .  ( [ eq : current ] ) , is split into intraband and interband parts , @xmath323 writing the density matrix as @xmath324 where @xmath325}^{*},\\ ] ] we find @xmath326 and @xmath327 in the above we used the cmr form of eq .",
    "( [ eq : trace ] ) , @xmath328 where @xmath105 should be taken to signify @xmath329.@xcite    plugging ( [ eq : linear_comb ] ) into ( [ eq : curr ] ) yields , after some manipulations , eqs .",
    "( [ eq : total_current ] ) , ( [ eq : intra_current ] ) , and ( [ eq : inter_current ] ) , confirming that the berry - phase polarization correctly accounts for both intraband and interband contributions .",
    "it is instructive to consider some particular cases .",
    "the adiabatic current @xmath330 discussed in refs .   is purely interband .",
    "if the perturbation is a sinusoidal electric field , the linear response is again a purely interband current , while the nonlinear response has also an intraband component.@xcite      along the same lines , one can show that the berry - phase expression for @xmath5 is consistent with the cmr position operator , which takes the form@xcite @xmath331 combined with eqs .",
    "( [ eq : cmr_dm ] ) and ( [ eq : trace_cmr ] ) this yields @xmath332 which is the same results one gets from inserting the cmr expansion ( [ eq : linear_comb ] ) into the nonadiabatic berry - phase formula ( [ eq : dyn_pol ] ) . the linear character of @xmath333 is reflected in the above equation being defined only up to a quantum of polarization .      in the case where @xmath30 ( and hence the cmr basis ) is constant in time , plugging ( [ eq : linear_comb ] ) into the tdse ( [ eq : tdse_continuum ] ) yields the cmr form of the schrdinger equation,@xcite @xmath334 where we have simplified @xmath335 to @xmath336 and defined @xmath337 which is reminiscent of the covariant derivative , eq .",
    "( [ eq : cov_der ] ) ( but note the difference in the sign of the last term ) .",
    "it is customary to write eq .",
    "( [ eq : tdse_cmr ] ) as @xmath338 where @xmath339 is a shifted energy eigenvalue .",
    "@xmath340 is identical to eq .",
    "( [ eq : energy_k_density ] ) except that @xmath341 has been replaced by the zero - field eigenstate @xmath342 . upon averaging over @xmath56 the last term on the right - hand - side becomes the first - order shift in total energy , @xmath343 , where @xmath344 is the spontaneous berry - phase polarization .",
    "in general the above tdse has no stationary solutions .",
    "approximate solutions   the wannier - stark states   result from restricting the wavepacket dynamics to a single band ( the semiclassical approximation ) . that is achieved by dropping the sum on the right - hand - side of eq .",
    "( [ eq : tdse_cmr_b ] ) , which is responsible for interband tunneling.@xcite    finally , combining ( [ eq : dm_cmr ] ) and ( [ eq : tdse_cmr ] ) produces the dynamical equation for the cmr density matrix : @xmath345 a closely related form has been used to study the nonlinear optical susceptibilities of semiconductors.@xcite",
    "in sec .  [ sec : td_continuum ] we introduced a modified tdse that contains the multiband covariant derivative @xmath133 , eq .",
    "( [ eq : cov_der ] ) , that was instrumental for making contact with the discrete-@xmath3 dynamical equations of sec .",
    "[ sec : td_discrete ] .",
    "here we summarize the properties of the covariant derivative and other closely related operators .",
    "the covariant derivative @xmath176 of an occupied state transforms in the same way as that state under a gauge transformation , eq .",
    "( [ eq : gauge_transf ] ) : @xmath346 moreover , it is orthogonal to the occupied subspace at @xmath56 , @xmath347 recalling that parallel transport is characterized by @xmath348 , for @xmath349 this relation shows that @xmath133 acting in an arbitrary gauge gives the same result as @xmath130 acting in the parallel - transport gauge that shares the same states at @xmath56 . in the discretized form ( [ eq : cov_discrete ] ) the property ( [ eq : gauge_cov_der ] ) is a consequence of eq .",
    "( [ eq : gauge_cov ] ) , and the property ( [ eq : orthogonal ] ) is a consequence of eq .",
    "( [ eq : duality ] ) . like @xmath350 , @xmath351 is hermitian . by this",
    "we mean that its matrix representation in an orthonormal basis ( e.g. , the @xmath66 , @xmath352 complemented by a set of unoccupied states @xmath353 ) is hermitian .",
    "this is closely related to the hermiticity of the matrix @xmath354 defined in eq .",
    "( [ eq : connection ] ) . finally , note that @xmath355 i.e. , the action of @xmath351 on an occupied state is identical to that of @xmath356 and @xmath357 .",
    "they differ in how they act on the unoccupied states .",
    "unlike @xmath351 , the other two are not hermitian : for instance , @xmath358 .",
    "it follows from these considerations that eq .",
    "( [ eq : tdse_continuum_cov ] ) can be recast as @xmath359\\ket{{v}_{\\kk n}}.\\ ] ] this is the form of the tdse to which eqs .",
    "( [ eq : td_discrete_b])-([eq : t_k ] ) reduce in the continuum-@xmath3 limit , since @xmath360 ( compare with eq .",
    "( [ eq : cov_dis ] ) ) .",
    "the purpose of this appendix is to obtain expressions for the derivatives of the two terms in the energy functional of eq .",
    "( [ eq : energy ] ) with respect to the occupied bloch - like states in the discrete-@xmath3 case .",
    "the results have been used in secs .",
    "[ sec : td_discrete ] and [ sec : stat_formulation ] for the discussion of the time - dependent evolution equations and the stationary solutions , respectively .      to find the gradient @xmath361 of the energy functional ( [ eq : energy ] ) ,",
    "let us isolate the terms that depend on @xmath215 . using ( [ eq : projector ] ) the zero - field part ( [ eq : energy0_discrete ] )",
    "can be expressed as @xmath362 $ ] , so that @xmath363}{\\bra{\\delta v_{\\kk n}}}.\\ ] ] in order to allow for arbitrary variations of @xmath215 , even those for which the @xmath215 do not remain orthonormal , we write @xmath364 where @xmath365 . dropping the subscript @xmath56 , @xmath366}&= { { \\rm tr}[(\\delta\\hat{p})\\hat{h}^0 ] } \\nonumber \\\\ & & = \\sum_{m , n}\\,({\\cal s}^{-1})_{mn } \\big[\\langle v_n|\\hat{h}^0|\\delta v_m\\rangle+      \\langle \\delta v_n|\\hat{h}^0|v_m\\rangle \\big ] \\nonumber \\\\ & & \\qquad+\\sum_{m , n}\\,\\langle v_n|\\hat{h}^0|v_m\\rangle\\ , \\delta({\\cal s}^{-1})_{mn}.\\end{aligned}\\ ] ] using @xmath367 and @xmath368 and evaluating at @xmath369 , we arrive at @xmath370}{\\bra{\\delta v_{\\kk n}}}= \\hat{q}_\\kk\\,\\hat{h}_\\kk^0\\,\\ket{v_{\\kk n}}.\\ ] ] thus the consequence of expressing @xmath137 as ( [ eq : proj_nonorthonormal ] ) instead of ( [ eq : projector ] ) is to render the gradient orthogonal to the occupied manifold at @xmath56 .",
    "( when we derived the dynamical equation ( [ eq : td_discrete_a ] ) using ( [ eq : euler - lagrange_b ] ) , the gradient of @xmath220 was not orthogonalized , which is why the dynamics did not follow parallel transport ( see sec .",
    "[ sec : integration ] ) ) .      to find the gradient of the field - coupling term",
    "@xmath371 we need @xmath372 .",
    "let us start by recasting eq .",
    "( [ eq : discrete_phase ] ) as @xmath373 where we have defined the phase @xmath374 using @xmath375 , this becomes @xmath376 where only the terms depending on @xmath215 were written explicitly .",
    "hence @xmath377 the phase @xmath378 can be expressed as @xmath379 for an arbitrary non - singular matrix @xmath380 we have @xmath381= { \\rm tr}\\,{\\rm ln}[{\\bf 1}+(\\delta a)a^{-1}]\\nonumber\\\\ & = & { \\rm tr}[a^{-1}\\,\\delta a]+{\\cal o}(\\delta a^{2}),\\end{aligned}\\ ] ] so that @xmath382\\nonumber \\\\ & = & \\sum_{m=1}^m\\,s^{-1}_{mn}(\\kk,\\kk')\\,\\ket{v_{\\kk ' m}}\\nonumber\\\\ & = & \\ket{\\widetilde{v}_{\\kk'n}}.\\end{aligned}\\ ] ] the corresponding derivative of the last term of ( [ eq : phase_b ] ) vanishes since @xmath383 does not contain @xmath215 as a bra .",
    "we thus arrive at @xmath384 which combined with ( [ eq : gamma_avg ] ) gives @xmath385 this is automatically orthogonal to the occupied manifold at @xmath56 .",
    "( see refs .   for alternative derivations . )",
    "collecting terms and using eq .",
    "( [ eq : ket_w_k ] ) , we obtain eq .",
    "( [ eq : gradient_energy ] ) for the gradient of the full energy functional @xmath140 .",
    "just as the macroscopic polarization @xmath5 is evaluated in practice via a finite - difference formula on a mesh of @xmath3 points , the same can be done for the macroscopic current @xmath0 .",
    "the invariance of eq .",
    "( [ eq : curr ] ) under the replacement @xmath386 allows us to then use the discretization rule ( [ eq : cov_discrete ] ) , leading to @xmath387 which is significantly easier and cheaper to compute than the spatial average of the microscopic current .",
    "we have checked numerically on our one - dimensional tight - binding model that eq .",
    "( [ eq : curr_discrete ] ) yields , for small @xmath197 , the same result as @xmath388/\\delta t$ ] computed with the discretized berry - phase formula .",
    "the same strategy as outlined above can be used to derive a discretized formula for the berry curvature ( [ eq : curvature ] ) summed over bands , which is also invariant under @xmath386 .",
    "this may be useful in other contexts , such as semiclassical wavepacket dynamics in crystals.@xcite                                  an incorrect interpretation was given in ref .   to the term @xmath389 .",
    "it does not come from the `` periodic part '' of the position operator , but rather from the full position operator , as can be seen from the present derivation .    after removing the `` band '' indices eq .",
    "( [ eq : orthonormality ] ) becomes the well - known equation for the @xmath3-space dynamics of an electronic wavepacket @xmath390 : @xmath391 , where @xmath392 .",
    "( [ eq : tdse_continuum ] ) is also valid for such wavepackets , even if the derivation given in the text was for wr manifolds .",
    "such a coherent `` frustrated metal '' state can exist in the early moments following a strong femtosecond laser - pulse excitation of a semiconductor , but it will eventually be destroyed by thermal scattering.@xcite      the resemblance of eqs .",
    "( [ eq : vanishing_part])-([eq : curvature ] ) to the so - called anomalous current@xcite in semiclassical wavepacket dynamics is misleading , since the berry curvature entering the anomalous current pertains to the band states @xmath65 , not to the @xmath66 .",
    "in fact , it can be shown that the anomalous current is contained in the other term , eq .",
    "( [ eq : curr ] ) , once it is properly modified for wavepackets .              note that for a purely electronic wavepacket @xmath393 the property @xmath394 does not hold , and hence @xmath395 . as a consequence , unlike eq .",
    "( [ eq : tdse_continuum ] ) , which correctly describes the dynamics of wavepackets,@xcite eq .",
    "( [ eq : tdse_continuum_cov ] ) is only valid for wr manifolds .",
    "of course , when wavepackets of _ electron - hole pairs _ are created by vertical electronic transitions in @xmath3 space , the electronic manifold remains wannier - representable , and can be described within the present formalism ( see , e.g. , sec .",
    "[ sec : cdw ] ) .",
    "it may seem surprising that even though we use a discrete mesh of @xmath3-points    which effectively turns the system into a finite torus   our calculations display exact quantization of adiabatic particle transport . according to thouless,@xcite that should only occur in the thermodynamic ( continuum-@xmath3 ) limit .",
    "this has to do with our using the discretized berry - phase formula ( [ eq : discrete_phase ] ) , which is not fully consistent with the velocity operator ( [ eq : velocity ] ) on the finite torus ( we recall that the derivation in sec .  [",
    "sec : dyn_pol_der ] was done in the continuum-@xmath3 limit ) . from this viewpoint",
    "it seems preferable to regard the discretization procedure as a numerical approximation to the continuum-@xmath3 limit , rather than as an exact calculation on the finite torus .    in the limit where the number @xmath105 of @xmath3 points is large ,",
    "@xmath266 is finite for the ground state of insulators and diverges for that of metals.@xcite for finite @xmath105 it can not really diverge . in particular , when @xmath396 is evaluated using eq .",
    "( 34 ) of marzari and vanderbilt@xcite it can not exceed , in one dimension , @xmath397 , well above the values that we observe in all our simulations .                      since @xmath398 has units of real - space volume , the right - hand side of eq .",
    "( [ eq : normalization ] ) is dimensionless . in the discrete-@xmath3 case",
    "the integral on the left - hand side is over the supercell volume @xmath399 , and @xmath400 is replaced by @xmath401 ."
  ],
  "abstract_text": [
    "<S> we consider the flow of polarization current @xmath0 produced by a homogeneous electric field @xmath1 or by rapidly varying some other parameter in the hamiltonian of a solid . for an initially insulating system and a collisionless time evolution , </S>",
    "<S> the dynamic polarization @xmath2 is given by a nonadiabatic version of the king - smith  vanderbilt geometric - phase formula . </S>",
    "<S> this leads to a computationally convenient form for the schrdinger equation where the electric field is described by a linear scalar potential handled on a discrete mesh in reciprocal space . </S>",
    "<S> stationary solutions in sufficiently weak static fields are local minima of the energy functional of nunes and gonze . </S>",
    "<S> such solutions only exist below a critical field that depends inversely on the density of @xmath3 points . for higher fields they become long - lived resonances , which can be accessed dynamically by gradually increasing @xmath4 . as an illustration the dielectric function in the presence of a dc bias field </S>",
    "<S> is computed for a tight - binding model from the polarization response to a step - function discontinuity in @xmath1 , displaying the franz - keldysh effect . </S>"
  ]
}