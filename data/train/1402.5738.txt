{
  "article_text": [
    "for an order @xmath0 in a number field @xmath7 , let @xmath8 and @xmath9 denote the class group and the narrow class group of an order @xmath0 in a number field @xmath7 is defined as @xmath10 where @xmath11 is the group of invertible fractional ideals of @xmath0 and @xmath12 is the group of principal fractional ideals of @xmath0 , that is , ideals of the form @xmath13 where @xmath14 .",
    "narrow class group _",
    "@xmath9 is defined as the quotient @xmath15 , where now @xmath16 is the group of _ totally positive _ principal fractional ideals of @xmath0 , that is , ideals of the form @xmath13 where @xmath17 is an element of @xmath18 such that @xmath19 is positive for every embedding @xmath20 .",
    "] of @xmath0 respectively . if @xmath0 is the maximal order of @xmath7 , then one defines the class group and narrow class group of @xmath7 by @xmath21 and @xmath22 . finally , for any prime @xmath23 let @xmath24 , @xmath25 , @xmath26 , and @xmath27 denote the @xmath23-torsion subgroups of @xmath8 , @xmath9 , @xmath28 , and @xmath29 , respectively .",
    "in this article , we begin by proving :    [ cgvsncg ] when the set of isomorphism classes of cubic fields satisfying any specified set of local conditions at any finite set of primes are ordered by their absolute discriminants :    * the average number of @xmath30-torsion elements in the class groups of such totally real cubic fields is @xmath31 . *",
    "the average number of @xmath30-torsion elements in the @xmath32narrow@xmath33 class groups of such complex cubic fields is @xmath34 . *",
    "the average number of @xmath30-torsion elements in the narrow class groups of such totally real cubic fields is @xmath30 .",
    "thus , the average number of 2-torsion elements in the class groups or narrow class groups of cubic fields of given real signature remains the same , regardless of which family of cubic fields we are averaging over .    in the case where no local specifications are made in theorem  [ cgvsncg ] ( i.e. , where we average over all cubic fields )",
    ", parts ( a ) and ( b ) of theorem  [ cgvsncg ] were first proven in @xcite by rather indirect methods , and confirmed a special case of the cohen  martinet ",
    "malle heuristics ( see @xcite ) . in the current paper",
    ", we generalize these results using a more direct correspondence ( see theorem  [ potqfideal ] ) , which additionally allows us to obtain theorem  [ cgvsncg](c ) , and indeed theorems  [ cgvsncg](a)(c ) for general families of cubic fields defined by local conditions at finitely many primes.(c )",
    ". it would be interesting to have similar cohen ",
    "malle style heuristics that apply more generally to narrow class groups as well as to orders . ]",
    "our current method is more direct in the sense that , not only does it yield a count of all the 2-torsion elements in class groups and narrow class groups in various families of cubic fields , but it in fact gives an explicit construction of these elements .",
    "this direct correspondence also allows us to study on average how many ideal classes of order  2 in the class groups of cubic orders arise simply because there exists an ideal of order  2 representing  it . recall that the _ ideal group _ @xmath35 of an order @xmath36 is the group of invertible fractional ideals of @xmath36 ,",
    "of which the class group @xmath37 is a quotient .",
    "if an order @xmath36 is not maximal , then it is possible for an _ ideal _ @xmath38 of @xmath36 to have order 2 , i.e. , @xmath38 can be a fractional ideal of @xmath36 satisfying @xmath39 but @xmath40 .    for an order @xmath36 in a number field ,",
    "let @xmath41 denote the @xmath23-torsion subgroup of the ideal group  @xmath35 of  @xmath36 . in ( * ?",
    "8) , we showed that the mean value of the difference @xmath42 is always equal to 1 , regardless of whether one averages over the maximal orders in complex quadratic fields , over all orders in such fields , or even over very general families of complex quadratic orders defined by local conditions .",
    "similarly , for very general families of real quadratic orders defined by local conditions , we showed that the mean value of the difference @xmath43 is always equal to 1 , independent of the family .    in this article , we prove the analogues of these results for the @xmath30-torsion elements in the class groups and ideal groups of _ cubic _ orders . to state the result , we require just a bit of notation . for each prime @xmath23 ,",
    "let @xmath44 be any set of isomorphism classes of orders in tale cubic algebras over @xmath45 .",
    "we say that the collection @xmath46 of local specifications is _ acceptable _ if , for all sufficiently large @xmath23 , the set @xmath44 contains all maximal cubic rings over @xmath47 , or at least all those maximal cubic rings over @xmath47 that are not totally ramified at @xmath23 .",
    "then we prove :    [ diff ] let @xmath46 be any acceptable collection of local specifications as above , and let @xmath48 denote the set of all isomorphism classes of cubic orders @xmath36 such that @xmath49 for all @xmath23 .",
    "then , when orders in @xmath48 are ordered by their absolute discriminants :    * the average size of @xmath4 for totally real cubic orders @xmath0 in @xmath48 is @xmath50 . *",
    "the average size of @xmath51 for complex cubic orders @xmath0 in  @xmath48 is  @xmath50 . *",
    "the average size of @xmath5 for totally real cubic orders @xmath0 in @xmath48 is @xmath50 .",
    "it is rather intriguing that the mean values in theorem  [ diff ] remain the same regardless of the choice @xmath46 of acceptable local specifications for the cubic orders being averaged over .",
    "if @xmath46 is acceptable and each @xmath44 consists only of _ maximal _ cubic rings over @xmath52 , then we recover ( a more general version of ) theorem  [ cgvsncg ] , since the only 2-torsion element of the ideal group of a maximal order is the trivial  ideal .",
    "theorem  [ cgvsncg ] immediately implies that most cubic fields have odd class number .",
    "more precisely :    [ odd ]    * a positive proportion @xmath32at least @xmath53 of totally real cubic fields have odd class number . * a positive proportion",
    "@xmath32at least @xmath54 of complex cubic fields have odd class number .",
    "we now compare the class group with the narrow class group . for orders @xmath0 in number fields with predominantly real places , such as totally real number fields ,",
    "it is natural to expect the narrow class group to be strictly larger than the class group , since one is forming a quotient of @xmath55 by principal ideals satisfying much more stringent conditions . in the quadratic case",
    ", this expectation is supported by :    when ordered by their discriminants , a density of @xmath56 of real quadratic fields  @xmath57 satisfy @xmath58 . ; indeed , there are are also infinitely many quadratic fields for which @xmath59 , but asymptotically such fields have density zero in the set of all quadratic fields .",
    "the 0% of quadratic fields satisfying @xmath59 are actually very interesting ; see , for example , the compelling heuristics of stevenhagen  @xcite on such fields and the beautiful recent work of fouvry and klners  @xcite in this regard . ]    in fact , since in the real quadratic case the size of the narrow class group is either the same as or twice the size of the class group , it is natural to try and distinguish these two groups just based on the sizes of their 2-torsion subgroups .",
    "we have :    [ quad2 ] when ordered by their discriminants , a density of @xmath56 of real quadratic fields  @xmath57 satisfy @xmath60 .",
    "now recall that for any number field @xmath61 with @xmath62 distinct real embeddings , there is a _ signature _ homomorphism @xmath63 that takes a _ unit _ of @xmath61i.e .",
    ", an invertible element of the ring of integers @xmath64 of @xmath61to its sign ( one sign for each of the real embeddings @xmath65 ) ; a unit @xmath66 has _ mixed signature _ if @xmath67 , i.e. , if there exist two real embeddings @xmath68 such that @xmath69",
    ". then , in terms of units of quadratic fields , we have :    [ quadmixed ] when ordered by their discriminants , a density of @xmath70 of real quadratic fields have a unit of mixed signature .",
    "thus , at least asymptotically , we completely understand the question of how often the class group and narrow class group differ for real quadratic fields .",
    "namely , 100% of the time , the narrow class group looks like the class group with one extra 2-torsion factor .",
    "theorems 4 and 5 are well - known and easily proven ; they are true primarily because for most  @xmath71 there are local obstructions to having a solution to the negative norm unit equation @xmath72 . also , the 2-torsion elements in class groups and narrow class groups in the quadratic case are mostly governed by genus theory .",
    "one of the reasons cohen and lenstra did not formulate heuristics for narrow class groups in the quadratic case is that these groups differ from class groups of quadratic fields only in their 2-parts , which are related to genus theory . from this point of view ,",
    "when computing narrow class groups vs.  class groups , it is natural to try and investigate a case where 2 is unrelated to genus theory  for example , the case of _ cubic _ fields , to which we now turn .    a classical theorem of armitage and frohlich  @xcite states that @xmath73 for cubic fields @xmath7 .",
    "thus theorems  [ cgvsncg](a ) and  [ cgvsncg](c ) , when taken together , immediately imply :    [ nocontrast ] a positive proportion @xmath32at least @xmath54 of totally real cubic fields @xmath7 satisfy @xmath74 .",
    "[ contrast ] a positive proportion @xmath32at least @xmath75 of totally real cubic fields",
    "@xmath7 satisfy @xmath76 .",
    "note that corollary  [ contrast ] for cubic fields is in stark contrast to theorem  [ quad2 ] for quadratic fields .",
    "as far as the existence of units of mixed type in cubic fields , we have :    [ mixed1 ] a positive proportion @xmath32at least @xmath54 of totally real cubic fields @xmath7 do not possess units of every possible signature .",
    "[ mixed2 ] a positive proportion @xmath32at least @xmath53 of totally real cubic fields @xmath7 possess units of mixed signature .",
    "note again the stark contrast between corollary  [ mixed2 ] and the corresponding situation in corollary  [ quadmixed ] for quadratic fields .",
    "corollaries  [ odd ] and [ nocontrast][mixed2 ] continue to hold , with the same percentages , even when one averages over just those cubic fields satisfying any desired set of local conditions at a finite set of primes , or more generally over _ any _ acceptable family of maximal cubic orders ( allowing us to consider families of cubic fields satisfying suitable infinite sets of local conditions ) .",
    "we prove theorems  [ cgvsncg ] and [ diff ] and their corollaries as an  application of a composition law on a prehomogeneous vector space that was investigated in  @xcite .",
    "we lay down the relevant preliminaries about this law of composition , defined on pairs of ternary quadratic forms , in section  2 ; more precisely , we give a correspondence between pairs of ternary quadratic forms and 2-torsion elements in class groups of cubic rings over a principal ideal domain .",
    "this allows us to describe a composition law on certain integer - matrix pairs of ternary quadratic forms in section  3 , leading to groups that are closely related to both the class groups and ( with some additional effort ) the narrow class groups of orders in cubic fields . in section  4 ,",
    "we focus on the composition law on _ reducible _ pairs of ternary quadratic forms , which leads to groups that are closely related to the ideal groups of orders in cubic fields . in section  5 , we describe how one can count the appropriate integer points in this prehomogeneous vector space using the results of  @xcite . by counting these configurations of points , we then complete the proofs of theorems  [ cgvsncg ] and  [ diff ] in section  6 . finally , we deduce corollaries  [ odd ] and [ nocontrast][mixed2 ] in section  7 .",
    "the key ingredient in the proof of theorem  [ cgvsncg ] is a parametrization of ideal classes of order  2 in cubic rings by means of equivalence classes of pairs of integer - matrix ternary quadratic forms , which was obtained in  @xcite .",
    "we begin by describing this orbit space briefly .    if @xmath77 is a principal ideal domain , then let @xmath78 denote the space of pairs @xmath79 of ternary quadratic forms over @xmath77 .",
    "we write an element @xmath80 as a pair of @xmath81 symmetric matrices with coefficients in @xmath77 as follows : @xmath82 , \\left[\\begin{array}{ccc}{b_{11}}&b_{12}&b_{13}\\\\b_{12}&b_{22}&{b_{23}}\\\\b_{13 } & { b_{23}}&{b_{33}}\\end{array}\\right ] \\right).\\ ] ] in particular , the elements of @xmath83 are called pairs @xmath79 of _ integer - matrix _ ternary quadratic forms .",
    "the group @xmath84 acts naturally on the space @xmath85 .",
    "namely , an element @xmath86 acts by changing the basis of the rank  2 @xmath77-module of forms spanned by @xmath79 ; more precisely , if @xmath87 , then we set @xmath88 . similarly , an element @xmath89 changes the basis of the rank 3 @xmath77-module on which the forms @xmath90 and @xmath91 take values ; we have @xmath92 .",
    "it is easy to see that these actions of @xmath93 and @xmath94 commute , leading to an action of @xmath84 .",
    "however , this action is not faithful in general . if we let @xmath95,\\left[\\begin{smallmatrix}\\lambda & 0 & 0 \\\\ 0 & \\lambda & 0\\\\ 0 & 0 & \\lambda\\end{smallmatrix}\\right]\\right ) : \\lambda \\in t^\\times\\right\\},\\ ] ] then for all principal ideal domains @xmath77 , the group @xmath96 acts faithfully on @xmath85 .",
    "the action of @xmath97 on @xmath98 turns out to have a unique polynomial invariant ( see , e.g. , sato ",
    "kimura  @xcite ) ; i.e. , the ring of all polynomial functions on @xmath98 that are invariant under the action of @xmath97 is generated by one element .",
    "this generating element can be defined naturally over @xmath99 , or indeed , over any principal ideal domain @xmath77 .    to construct this fundamental invariant , we notice first that the action of @xmath100 on @xmath98 has four independent polynomial invariants , namely the coefficients @xmath101 of the binary cubic form @xmath102 where @xmath103 . for an element @xmath80 ,",
    "we call @xmath104 as defined by ( [ fdef ] ) the _ binary cubic form invariant _ of @xmath79 .",
    "an element @xmath105 then acts on the binary cubic form invariant @xmath104 by @xmath106 .",
    "now it is well - known that the action of @xmath107 on the space of complex binary cubic forms has a unique polynomial invariant ( up to scaling ) , namely its discriminant @xmath108 .",
    "the unique polynomial invariant for the action of @xmath109 on @xmath98 is then given by @xmath110 , which is an integer polynomial of degree 12 in the entries of @xmath90 and @xmath91 .",
    "for @xmath80 , we call this fundamental invariant @xmath111 the _ discriminant _ of @xmath79 .",
    "note that for any @xmath112 and @xmath80 , we have @xmath113 and thus @xmath111 is also a _ relative invariant _ for the action of @xmath96 on  @xmath85 .",
    "we say that @xmath80 is _ nondegenerate _ if it has nonzero discriminant .",
    "the orbits of @xmath96 on @xmath85 have an important arithmetic significance , namely they essentially parametrize order 2 ideal classes in cubic rings over @xmath77 .",
    "recall that a _ cubic ring _ over @xmath77 is any ring with unit that is free of rank 3 as a @xmath77-module ; for example , an order in a cubic number field is a cubic ring over @xmath114 . in 1964 ,",
    "delone and faddeev  @xcite showed that orders in cubic fields are parametrized by irreducible integral binary cubic forms ; this was recently extended to general cubic rings and general binary cubic forms by gan , gross , and savin  @xcite ( see also the work of gross and lucianovic  @xcite ) .",
    "we have observed above that a pair @xmath80 of ternary quadratic forms yields a binary cubic form invariant @xmath115 over @xmath77 , and thus we naturally obtain a cubic ring @xmath116 over @xmath77 from an element @xmath80 via the gan ",
    "savin parametrization described above .",
    "we say that a cubic ring over @xmath77 is _ nondegenerate _ if it has nonzero discriminant .",
    "we now describe a precise correspondence between nondegenerate pairs of ternary quadratic forms in @xmath85 and ideal classes `` of order 2 '' in the corresponding cubic rings over a principal ideal domain @xmath77 . to simplify the statement",
    ", we assume that we have a set @xmath117 of representatives in  @xmath118 for the left action of @xmath119 on @xmath118 .",
    "for example , if @xmath120 , then we will always take @xmath117 to be the set of positive elements of @xmath99 ; similarly , if @xmath121 , then @xmath117 will always be chosen to consist of the powers of @xmath23 in  @xmath52 ; and if @xmath77 is a field , then we will always take @xmath122 .",
    "for an ideal @xmath38 of a cubic ring @xmath123 over  @xmath77 , we use @xmath124 to denote the unique generator in  @xmath117 of the usual ideal norm of @xmath38 viewed as a @xmath77-ideal .",
    "( when the choice of @xmath117 is clear , as in the case of @xmath99 , @xmath52 , or a field , then we usually drop it from the notation . )",
    "then we have the following generalization of  ( * ? ? ?",
    "4 ) :    [ potqfideal ] let @xmath77 and @xmath117 be as above . then there is a bijection between the set of nondegenerate @xmath96-orbits on the space @xmath78 and the set of equivalence classes of triples @xmath125 , where @xmath123 is a nondegenerate cubic ring over  @xmath77 , @xmath38 is an ideal of @xmath123 having rank @xmath126 as a @xmath77-module , and @xmath127 is an invertible element of @xmath128 such that @xmath129 and @xmath130 . @xmath32here two triples @xmath125 and @xmath131 are equivalent if there exists an isomorphism @xmath132 and an element @xmath133 such that @xmath134 and @xmath135    the proof of theorem  [ potqfideal ] is identical to that given in @xcite ( with a suitable change to the definition of orientation , described below ) .",
    "we briefly sketch the bijective map for general @xmath77 .",
    "given a triple @xmath125 over @xmath77 , we construct the corresponding pair of ternary quadratic forms over @xmath77 as follows .",
    "first , we may write @xmath136 where @xmath137 is a _ normal _ basis , i.e. , @xmath138 . furthermore , we can write @xmath139 , where @xmath140 has the _ same orientation _ as @xmath141 , i.e. , the change - of - basis matrix from @xmath137 to @xmath140 has determinant lying in our fixed choice @xmath117 of representatives in @xmath118 for the left action of  @xmath119 on  @xmath118 . since  @xmath142 , we have for all @xmath143 that @xmath144 where @xmath145",
    ". then @xmath146 yields the desired pair of symmetric @xmath147 matrices over @xmath77 . in basis - free terms , @xmath79 corresponds to the symmetric bilinear map of @xmath77-modules @xmath148    on the other hand , if @xmath149 is a pair of ternary quadratic forms over @xmath77 , and @xmath150 is the associated binary cubic form with coefficients @xmath151 , then @xmath152 is the cubic ring with basis @xmath137 satisfying @xmath153 in order to describe @xmath38 in terms of a basis @xmath154 , it suffices to show that all @xmath155 and @xmath127 in ( [ above ] ) are uniquely determined by @xmath79 .",
    "first , one shows using equation ( [ above ] ) , together with the associative law on triple products @xmath156 , that the @xmath155 can be written explicitly as @xmath157 where @xmath158 denotes the sign of the permutation of @xmath159 described by the top row .",
    "the system of equations given in ( [ above ] ) shows that for each @xmath160 , we have @xmath161 the ratios are independent of the choice of @xmath162 , and so this determines @xmath163 uniquely up to a scalar factor in @xmath164 .",
    "once we fix a choice of @xmath154 , equation ( [ above ] ) then uniquely determines @xmath165 .",
    "the @xmath123-ideal structure of the @xmath77-module @xmath38 is given by ( * ? ? ?",
    "this completely and explicitly determines the triple @xmath125 from the pair @xmath79 of ternary quadratic forms .",
    "finally , we describe the action of @xmath166 on the bases of @xmath167 and @xmath38 corresponding to the action of the same group on pairs @xmath79 of ternary quadratic forms over @xmath77 described previously . if @xmath168 is the matrix @xmath169 , then it acts on the normal basis of @xmath170 and the @xmath77-basis @xmath171 of the ideal @xmath38 by @xmath172 on the other hand , @xmath173 acts on the bases @xmath174 and @xmath171 by @xmath175 one now easily checks that the equivalence defined on triples @xmath125 in the statement of the theorem exactly corresponds to @xmath96-equivalence on pairs @xmath80 of ternary quadratic forms over  @xmath77 .",
    "_ note that @xmath176 , and so we recover ( * ? ? ?",
    "* thm .  4 ) .",
    "_    the following corollary of theorem  [ potqfideal ] describes the stabilizer in @xmath96 of an element @xmath149 :    [ stabcor ] the stabilizer in @xmath96 of a nondegenerate element @xmath80 is given by the semidirect product @xmath177 where : @xmath125 is the triple corresponding to @xmath79 as in theorem  @xmath178 ; @xmath179 is the group @xmath180 ; @xmath181 is the endomorphism ring of @xmath38 ; and @xmath182 denotes the group of units of @xmath183 having order dividing  @xmath30 and norm  @xmath50 .",
    "first , note that the elements of @xmath166 that preserve the bases of @xmath167 and @xmath38 under the action described by ( [ g2action ] ) and ( [ g3action ] ) are exactly the elements of @xmath184,\\left[\\begin{smallmatrix}\\lambda & 0 & 0 \\\\ 0 & \\lambda & 0\\\\ 0 & 0 & \\lambda\\end{smallmatrix}\\right]\\right ) : \\lambda \\in t^\\times\\right\\}.\\ ] ] that is , @xmath185 acts pointwise trivially on @xmath85 .",
    "this implies that if @xmath186 , then any element of the coset @xmath187 acts on the bases of @xmath167 and @xmath38 in the same way that @xmath188 acts .",
    "furthermore , if the actions of @xmath189 are distinct on the bases of @xmath167 and @xmath38 , then @xmath190 .",
    "thus , it suffices to compute the number of distinct actions on the bases of @xmath167 and @xmath38 by elements @xmath191 that preserve @xmath192 and @xmath193 in ( [ above ] ) , in order to compute the number of cosets @xmath194 in the stabilizer in @xmath166 of an element  @xmath80 .",
    "now suppose @xmath195 preserves a pair @xmath79 . in terms of the corresponding triple @xmath125 , @xmath188 acts on the basis of @xmath167 as described in equations ( [ g2action ] ) and ( [ g3action ] ) , which induces an automorphism @xmath196 of @xmath123 . as @xmath188 must preserve the triple @xmath125 up to equivalence , we see that @xmath197 , i.e. , there exists @xmath198 such that @xmath199 and @xmath200 .",
    "to preserve the structure coefficients @xmath201 and @xmath202 in ( [ above ] ) , the change of basis of @xmath167 corresponding to the element @xmath203 then uniquely determines the change of basis for @xmath38 ( namely , @xmath204 for @xmath205 , assuming we keep @xmath127 the same in ( [ above ] ) ) , up to transformations on the basis of @xmath38 that act via multiplication by an element of @xmath206 ) .",
    "this is the desired conclusion .",
    "let us now restrict ourselves to those cubic rings @xmath123 over the base ring @xmath114 that are orders in @xmath207-cubic fields .",
    "it is known that , when ordered by absolute discriminant , such @xmath207-cubic orders constitute a proportion of @xmath56 of all orders in cubic fields ( since orders in abelian cubic fields are negligible  in number , in comparison ) .",
    "note that the automorphism group @xmath208 of an @xmath207-cubic order @xmath123 is  trivial .",
    "let us say that a triple @xmath125 is _ projective _ if @xmath38 is projective as an @xmath123-module ( i.e. , if @xmath38 is invertible as a fractional ideal of @xmath123 ) ; in such a case we have @xmath209 .",
    "for a fixed @xmath207-cubic order  @xmath123 , we therefore obtain a natural law of composition on equivalence classes of projective triples @xmath125 , defined by @xmath210 the equivalence classes of projective triples @xmath125 then form a group under this composition law , which we denote by @xmath211 .",
    "let us say that a pair @xmath212 is _ projective _ if the corresponding @xmath125 , under the bijection of theorem  [ potqfideal ] , is projective .",
    "we then also obtain a composition law on projective equivalence classes of pairs @xmath79 of ternary quadratic forms having binary cubic form invariant equal to a given @xmath115 , where @xmath213 ( a higher degree analogue of gauss composition ) .",
    "we denote the corresponding group on such equivalence classes of @xmath79 also by @xmath211 .",
    "fix an @xmath207-cubic order @xmath123 .",
    "let @xmath214 denote the unit group of @xmath123 , and let @xmath215 denote the subgroup of those units having positive norm .",
    "then we have an exact sequence @xmath216 where @xmath217 denotes the subgroup of @xmath214 consisting of square units .    if @xmath123 is an order in a totally real cubic field , then the group @xmath218 has order @xmath219 .",
    "meanwhile , if @xmath123 is an order in a complex cubic field , then the latter group has order 2 .",
    "we thus obtain :    [ hr2 ] we have @xmath220 when @xmath123 is an order in a totally real @xmath207-cubic field , and @xmath221 when @xmath123 is an order in a complex cubic field .    equation ( [ hr ] ) and lemma  [ hr2 ] thus make precise the relationship between @xmath211 and @xmath222 .",
    "if we further assume that @xmath123 is an order in a totally real @xmath207-cubic field , we can restrict to the group @xmath223 consisting of those triples @xmath125 in which @xmath127 is totally positive is _ totally positive _",
    "if for every embedding @xmath224 , @xmath225 is positive . ] .",
    "the group @xmath226 turns out to be closely related to the group @xmath227 ; in particular , we find :    [ hrp ] let @xmath123 be an order in a totally real @xmath207-cubic field , and let @xmath226 be the subgroup of @xmath228 where @xmath127 is totally positive",
    ". then @xmath229 .",
    "let @xmath214 again denote the unit group of @xmath123 , and let @xmath230 denote the subgroup of totally positive units .",
    "let @xmath231 denote the signature homomorphism that takes a unit to its sign ( one sign for each of the three real embeddings @xmath232 ) .",
    "then we have the following commutative triangle of exact sequences :        here @xmath233 denotes the group of all equivalence classes of ideals @xmath38 of @xmath123 for which there exists a totally positive @xmath234 with @xmath209 . since @xmath235 , we then also have @xmath236 , and therefore @xmath237 , as desired .",
    "the bijection given in theorem  [ potqfideal ] includes all pairs @xmath238 of integer - matrix ternary quadratic forms  even _ reducible _ pairs , i.e. , those that share a common rational zero in @xmath239 .",
    "the question then arises : which elements in @xmath211 correspond to reducible pairs @xmath79 of ternary quadratic forms ?",
    "[ lemma2 ] let @xmath79 be a _ projective _ element of @xmath240 whose binary cubic form invariant @xmath241 is irreducible over @xmath242 , and let @xmath125 denote the corresponding triple as given by theorem  @xmath178 .",
    "then @xmath79 has a rational zero in @xmath239 if and only if @xmath127 is a square in @xmath243 .",
    "suppose @xmath244 for some invertible @xmath245 . then by replacing @xmath38 by @xmath246 and @xmath127 by @xmath247 if necessary",
    ", we may assume that @xmath248 .",
    "let @xmath249 be the smallest positive element of @xmath250 , and extend to a basis @xmath154 of @xmath38 . by ( [ above ] ) , we have that @xmath251 and @xmath252 , which implies that the associated pair of ternary quadratic forms has a rational zero , namely @xmath253 , in @xmath254 .",
    "conversely , suppose that @xmath90 and @xmath91 have a common rational zero in @xmath254 .",
    "if @xmath125 is the corresponding triple , then this means that there exists @xmath255 such that @xmath256 , where @xmath196 is defined as in ( [ cf ] ) . setting @xmath257 for some @xmath258 , and taking norms to @xmath99 on both sides ,",
    "reveals that @xmath259 . thus @xmath260 is a square",
    "this implies that @xmath127 must be a square in @xmath243 , namely , @xmath261 .    for a cubic order @xmath123 , let @xmath262 be the subgroup of ( equivalence classes of ) projective triples @xmath263 where @xmath127 is a square in @xmath264 . by the previous lemma , @xmath262 is the subgroup of equivalence classes of projective pairs @xmath212 for which @xmath265 in their corresponding triple , and such that @xmath79 has a rational zero in @xmath254 . as in the introduction ,",
    "let @xmath266 denote the 2-torsion subgroup of the ideal group of @xmath123 , i.e. , the subgroup of invertible fractional ideals @xmath38 of @xmath123 such that @xmath267 .",
    "we can then define a map @xmath268 it is evident that @xmath269 .",
    "we show that @xmath270 in fact defines an isomorphism between  @xmath266 and @xmath271 :    [ redthm ] the map @xmath270 yields an isomorphism of @xmath266 with @xmath271 .",
    "the preimage of the identity @xmath272 can only contain 2-torsion ideals of the form @xmath273 where @xmath274 . to be a 2-torsion ideal , we must have @xmath275 ; thus @xmath276 and so @xmath277 .",
    "therefore , the preimage of the identity is simply the ideal @xmath123 and the map is injective . to show surjectivity ,",
    "let @xmath278 .",
    "since @xmath127 is a square by definition , let @xmath279 and recall that @xmath280 ; thus @xmath281 .",
    "[ maxcase ] assume that @xmath123 is maximal .",
    "then @xmath271 contains only the identity element of @xmath211 , which can be represented by @xmath282 .",
    "since maximal orders are dedekind domains , the only ideal that is 2-torsion in the ideal group of @xmath123 is @xmath123 .",
    "to prove theorem  [ cgvsncg ] , we would like to restrict the elements of @xmath83 under consideration to those that are `` irreducible '' in an appropriate sense .",
    "more precisely , we call a pair @xmath79 of integral ternary quadratic forms in @xmath83 _ absolutely irreducible _",
    "if    @xmath90 and @xmath91 do not possess a common @xmath242-rational zero as conics in @xmath239 ; and    the binary cubic form @xmath283 is irreducible over @xmath242 .",
    "next , we note that a pair @xmath284 of real ternary quadratic forms gives a pair of conics in @xmath285 which , at least in nondegenerate cases , intersect in four points in @xmath285 .",
    "we call these four points the _ zeroes _ of @xmath79 .",
    "the action of @xmath286 on @xmath287 is seen to have three distinct orbits of nondegenerate elements , namely the orbits @xmath288 for @xmath289 , where @xmath290 consists of the elements in @xmath287 having @xmath291 real zeroes and @xmath292 pairs of complex zeroes in @xmath285 .",
    "now let @xmath293 be any @xmath294-invariant subset defined by finitely many congruence conditions . for each prime @xmath23 ,",
    "let @xmath295 denote the @xmath23-adic closure of @xmath117 in @xmath296 , and let @xmath297 denote the `` @xmath23-adic mass '' of @xmath295 in @xmath298 , defined by @xmath299 where @xmath300 denotes the discriminant of @xmath301 as a power of @xmath23 , and @xmath302 denotes the stabilizer of @xmath303 in @xmath304 .",
    "setting @xmath305 for @xmath289 respectively , we may now state the following result counting the number of absolutely irreducible elements @xmath306 , up to @xmath294-equivalence , having absolute discriminant at most @xmath307 .",
    "[ cna ] for any @xmath294-invariant subset @xmath293 defined by finitely many congruence conditions , let @xmath308 denote the number of @xmath294-equivalence classes of _ absolutely irreducible _",
    "elements @xmath309 satisfying @xmath310 .",
    "then @xmath311    let @xmath312 denote the @xmath23-adic density of the @xmath23-adic closure @xmath295 of @xmath117 in @xmath298 , where we normalize the additive measure @xmath313 on @xmath298 so that @xmath314 .",
    "then ( * ? ? ?",
    "( 32 ) ) implies is defined as the set of all _ integer - coefficient _ pairs of ternary quadratic forms ( see ( * ? ? ?",
    "( 3 ) ) ) .",
    "the lattice of all _ integer - coefficient _ pairs of ternary quadratic forms contains the lattice of all integer - matrix pairs of ternary quadratic forms as an index 64 sublattice .",
    "however , the notion of discriminant in @xcite also differs from the one used in this paper ; namely , an integer - matrix pair @xmath315 has discriminant equal to @xmath316 in the current paper , but has discriminant equal to @xmath317 according to @xcite .",
    "this implies that the constant in equation ( [ oramanujan ] ) changes from @xmath318 as in @xcite to @xmath319 here . ]",
    "@xmath320 theorem  [ cna ] is thus reduced to re - expressing the @xmath23-adic density @xmath312 in terms of the @xmath23-adic mass @xmath297 .",
    "this is accomplished by the following lemma :    [ ramanujan11 ] we have @xmath321    we normalize the haar measure @xmath322 on the @xmath23-adic group @xmath304 so that @xmath323 since @xmath324 is a @xmath325-invariant measure on @xmath326 , we must have for any @xmath327 of nonzero discriminant that @xmath328 for some constant @xmath329 .",
    "the constant @xmath330 can be determined by calculating the jacobian of the change of variable @xmath331 from @xmath304 to @xmath298 .",
    "now this is an algebraic calculation , involving polynomials in the coordinates on @xmath304 and @xmath298 .",
    "since any two choices of @xmath332 are @xmath333-equivalent for some finite extension @xmath7 of @xmath334 ( since @xmath298 is a prehomogeneous vector space  @xcite , there is one open orbit over the algebraic closure @xmath335 of @xmath334 ) , and since the haar measure @xmath322 naturally extends to a haar measure on @xmath333 , we conclude that our constant @xmath329 can not depend on @xmath332 .",
    "it thus suffices to compute the constant @xmath329 for @xmath336 , \\left[\\begin{smallmatrix}0 & 1 & 0 \\\\ 1 & 1 & 0\\\\ 0 & 0 & 0 \\end{smallmatrix}\\right ] \\right),$ ] which corresponds to the triple @xmath337 .",
    "when @xmath338 , it can be shown that @xmath339 is defined simply by conditions modulo  @xmath23 . indeed ,",
    "the only cubic ring over @xmath52 whose reduction modulo  @xmath23 is isomorphic to @xmath340 is  @xmath341 , and the only ideal class of @xmath341 having rank 3 over @xmath52 is  @xmath341 . if @xmath342 reduces to @xmath343 modulo  @xmath23 , then @xmath127 is in the same squareclass as @xmath344 , and thus the triple @xmath345 is equivalent to @xmath337 for odd primes @xmath346 when @xmath347 , if @xmath348 reduces to @xmath349 modulo @xmath23 , then there are 16 choices for the squareclass of @xmath348 .",
    "the group @xmath350 acts on these 16 squareclasses , and the squareclass of @xmath351 lies in a single orbit .",
    "furthermore , @xmath352 , for @xmath127 in any one of these 16 squareclasses , is simply the stabilizer of that squareclass under this action of @xmath207 .",
    "it follows by corollary  [ stabcor ] and the orbit - stabilizer theorem that the @xmath30-adic mass of @xmath353i.e .",
    ", the @xmath30-adic mass of the @xmath354-orbit of all @xmath355 corresponding to the triple @xmath356is exactly @xmath357 of the @xmath30-adic mass of the set of all @xmath355 whose reduction modulo  2 corresponds to the triple @xmath358 .",
    "now the cardinality of @xmath359 is @xmath360 .",
    "therefore , if @xmath361 , then we see that the measure of @xmath362 in @xmath298 is equal to @xmath363 times the cardinality of @xmath364 in @xmath359 , where @xmath365 denotes the reduction of @xmath332 modulo @xmath23 ; if @xmath347 , then the measure of @xmath362 is equal to @xmath363 times the cardinality of @xmath366 in @xmath367 times @xmath357 . since for our choice of @xmath332",
    ", we have @xmath368 for odd primes @xmath23 , and @xmath369 , we conclude using corollary [ stabcor ] that @xmath370 when @xmath338 , and @xmath371 .",
    "thus , by the orbit - stabilizer theorem , we obtain @xmath372 since @xmath373 for our choice of @xmath332 .",
    "thus we must have @xmath374 for any choice of @xmath332 satisfying @xmath375 , and the lemma follows .    returning to the proof of theorem  [ cna ]",
    ", we observe that @xmath376 , and so by lemma  [ ramanujan11 ] , we have @xmath377 yielding theorem  [ cna ] .",
    "to prove theorems  [ cgvsncg ] and [ diff ] , we choose appropriate sets @xmath117 on which to apply theorem  [ cna ] .",
    "this is carried out in the next section .",
    "our goal is to count the @xmath378-orbits of pairs of forms in @xmath379 of bounded absolute discriminant that correspond , under the bijection described in theorem  [ potqfideal ] , to equivalence classes of triples @xmath125 where @xmath123 lies in some acceptable family @xmath48 of cubic orders and @xmath38 is projective .",
    "more precisely , for each prime @xmath23 , let @xmath44 be a set of isomorphism classes of nondegenerate cubic rings over @xmath52 .",
    "we denote the collection @xmath46 of these local specifications over all @xmath23 by @xmath48 . as in the introduction",
    ", we say that the collection @xmath380 is _ acceptable _ if , for all sufficiently large @xmath23 , the set  @xmath44 contains all maximal cubic rings over @xmath52 that are not totally ramified . finally , for a cubic order  @xmath123 over @xmath99 , we write `` @xmath381 '' ( or say that `` @xmath123 is a @xmath48-order '' ) if @xmath382 for all @xmath23 .",
    "now fix any acceptable collection @xmath380 of local specifications .",
    "let @xmath383 denote the set of all absolutely irreducible elements @xmath384 such that , in the corresponding triple @xmath125 , we have that @xmath381 and @xmath38 is invertible as an ideal class of @xmath123 ( implying that @xmath385 is the trivial ideal class of @xmath386 ) .",
    "then we wish to count @xmath387 , the number of @xmath378-equivalence classes of absolutely irreducible elements @xmath388 satisfying @xmath310 .",
    "although @xmath117 might be defined by infinitely many congruence conditions , the estimate provided in  ( * ? ? ?",
    "23 ) and ( * ? ? ?",
    "3.7 ) ( and the fact that @xmath48 is acceptable ) implies that equation  ( [ ramanujan ] ) continues to hold for the set @xmath117 ( this follows from an identical argument as in @xcite or @xcite ) .",
    "more precisely , @xmath389    we also have the following algebraic lemma which describes when a pair @xmath79 lies in @xmath379 ( @xmath390 ) in terms of the associated triple @xmath125 :    [ lemma1 ] let @xmath79 be an element of @xmath240 whose binary cubic form invariant @xmath115 is irreducible over @xmath242 , and let @xmath125 be the corresponding triple as given by theorem  @xmath178 .",
    "* if @xmath391 , then @xmath123 is an order in a totally real cubic field , and @xmath127 is a totally positive element of @xmath392 . * if @xmath393 , then @xmath123 is an order in a complex cubic field . *",
    "if @xmath394 , then @xmath123 is an order in a totally real cubic field , and @xmath395 is not a totally positive element .",
    "if the binary cubic form invariant @xmath115 of @xmath79 is irreducible over @xmath242 , then the cubic ring @xmath396 is a domain  @xcite ( see also  ( * ? ? ?",
    "11 ) ) , and thus an order in a cubic field . to check the assertions about @xmath127",
    ", it suffices to base change to the real numbers @xmath397 , where one can simply check the assertion at one point of each of the three orbits @xmath290 for @xmath391 , 1 , and 2 .     + combining theorem  [ redthm ] with lemmas  [ hr2 ] ,  [ hrp ] , and  [ lemma1 ] , we obtain @xmath398 n^{(1)}(s(\\sigma ) , x ) & = &    \\displaystyle\\sum_{\\scriptstyle{r \\in \\sigma,}\\atop{\\scriptstyle",
    "-x < \\disc(r ) < 0 } } \\!\\!\\!2 \\cdot |\\cl_2(r)| - |\\ci_2(r)| , \\\\[.425 in ] n^{(0)}(s(\\sigma),x ) & = &   \\displaystyle\\sum_{\\scriptstyle{r \\in \\sigma,}\\atop{\\scriptstyle 0<\\disc(r)<x } } \\;\\;\\;\\;|\\cl^+_2(r)| - |\\ci_2(r)| . \\end{array}\\ ] ]    by theorem  [ potqfideal ] and corollary  [ stabcor ] , the @xmath23-adic masses of @xmath399 defined in ( [ massdef ] ) can be expressed as @xmath400 where the sum is over all equivalence classes of triples @xmath125 over @xmath52 represented in @xmath295 . if @xmath401 is a nondegenerate cubic ring over @xmath52 , then in a corresponding triple @xmath125 we can always choose  @xmath402 , since @xmath38 is a principal ideal ( recall that invertible means locally principal ) .",
    "the number of elements @xmath127 yielding distinct valid triples @xmath403 over @xmath47 ( in the sense of theorem  [ potqfideal ] ) , up to equivalence , is equal to the number of @xmath208-orbits on the set @xmath404 , where @xmath405 denotes the group of units of @xmath123 having norm 1 .",
    "if @xmath406 has image @xmath407 , then the stabilizer of @xmath408 under this action of @xmath208 is given by @xmath409 for any lift @xmath127 of @xmath408 . by the orbit - stabilizer theorem",
    ", we then obtain that    @xmath410    where the sum is over all isomorphism classes of cubic rings @xmath123 over @xmath52 lying in @xmath44 .",
    "[ weird ] let @xmath123 be a nondegenerate cubic ring over @xmath52 .",
    "then @xmath411 is @xmath50 if @xmath361 , and @xmath219 if @xmath412 .",
    "the unit group of @xmath123 , as a multiplicative group , is isomorphic to @xmath413 , where @xmath414 is a finite abelian group and @xmath415 is torsion - free and may naturally be viewed as a free rank 3 @xmath52-module .",
    "hence the submodule @xmath405 , consisting of those units having norm 1 , is isomorphic to @xmath416 , where @xmath57 is a finite abelian group and @xmath417 is free of rank 2 as a @xmath52-module .",
    "let @xmath418 denote the 2-torsion subgroup of @xmath57 .",
    "since @xmath418 is the kernel of the multiplication - by-2 map on @xmath57 , it is clear that @xmath419 .",
    "therefore , it suffices to check the lemma on the `` free '' part @xmath417 of @xmath405 , namely , on the @xmath52-module @xmath420 , where the result is clear .",
    "( the case @xmath412 differs because , while @xmath421 for @xmath361 , the @xmath422-module @xmath423 has index 4 in @xmath424 . )    combining ( [ ramanujangen ] ) , ( [ massdef3 ] ) , and lemma  [ weird ] , we obtain @xmath425 let @xmath426 denote the euler product occurring in ( [ ramanujan2 ] ) , i.e. , @xmath427 we now recall the following result from ( * ? ? ? * thm .",
    "8) :    [ dht ]    * the number of totally real @xmath48-orders @xmath0 with @xmath428 is @xmath429 .",
    "* the number of complex @xmath48-orders @xmath0 with @xmath428 is @xmath430 .",
    "thus , we may conclude from ( [ irredcountgen ] ) , ( [ ramanujan2 ] ) , and lemma  [ dht ] that @xmath431 this proves theorem  [ diff ] .",
    "furthermore , when @xmath48 is an acceptable collection of maximal cubic orders , then theorem  [ diff ] and corollary  [ maxcase ] imply theorem  [ cgvsncg ] , since @xmath432 when @xmath123 is maximal .",
    "we conclude by proving corollaries  [ odd ] , [ nocontrast ] , [ contrast ] , [ mixed1 ] , and [ mixed2 ] . as remarked in the introduction ,",
    "we in fact prove a generalization of each of these corollaries .",
    "namely , let @xmath48 be any acceptable collection of local specifications of maximal cubic orders ( thus possibly defined by infinitely many local conditions ) .",
    "then we prove that corollaries  [ odd ] and [ nocontrast][mixed2 ] continue to hold , with the same percentages , for the family of maximal orders defined by any such @xmath48 .",
    "* proof of corollary  [ odd ] : * indeed , suppose a lower density of less than 75% ( resp .",
    "50% ) of totally real ( resp.complex ) @xmath48-orders have odd class number . then an upper density of more than 1/4 ( resp .",
    "1/2 ) of these @xmath48-orders @xmath123 would satisfy @xmath433 .",
    "thus the limsup of the average size of @xmath434 would be strictly larger than @xmath435 ( resp .",
    "@xmath436 , contradicting theorem  1(a ) ( resp .",
    "theorem  1(b ) ) .",
    "@xmath437      * proof of corollary  [ nocontrast ] : * by the theorem of armitage and frohlich , for a cubic field  @xmath7 we have either @xmath438 or @xmath439 .",
    "suppose that a lower density of strictly less than  50% of the totally real cubic fields",
    "@xmath7 defined by @xmath48 satisfy @xmath440 .",
    "then , since @xmath441 for all  @xmath7 , the liminf of the average size of @xmath442 would be strictly less than the average size of @xmath443 .",
    "however , the average size of @xmath443 is 2 by theorem  1(a ) , contradicting theorem 1(c ) . @xmath437    * proof of corollary  [ contrast ] : * suppose that an upper density of strictly more than 75% of totally real cubic fields",
    "@xmath7 defined by @xmath48 satisfy @xmath444 .",
    "then the limsup of the average size of @xmath442 would be strictly larger than the average size of @xmath445 , which is  2 .",
    "this again contradicts theorem  1(c ) .",
    "@xmath437    finally , we prove that at least 50% of real cubic fields @xmath7 in the family of cubic fields defined by @xmath48 do not possess units of every possible signature ; in addition , at least 75% of such cubic fields  @xmath7 possess units of mixed signature .",
    "* proof of corollary  [ mixed1 ] : * we note that if the class group and narrow class group of a number field  @xmath7 are not isomorphic , then @xmath7 can not possess a unit of every possible real signature .",
    "corollary  [ nocontrast ] now implies the result . @xmath437    * proof of corollary  [ mixed2 ] : * by corollary  [ odd ] , a lower density of at least @xmath446 of cubic fields @xmath7 have odd class number . for any such cubic field",
    "@xmath7 , the 2-sylow subgroup of @xmath447 will be either trivial or a cyclic group of order 2 , by armitage and frohlich s theorem .",
    "thus any such cubic field  @xmath7 will contain a unit of mixed signature .",
    "we are very grateful to benedict gross , kiran kedlaya , jrgen klners , hendrik lenstra , peter sarnak , arul shankar , christopher skinner , and melanie wood for helpful discussions .",
    "the first author was supported by the packard and simons foundations and nsf grant dms-1001828 .",
    "the second author was supported by a national defense science & engineering fellowship and an nsf graduate research fellowship ."
  ],
  "abstract_text": [
    "<S> given any family of cubic fields defined by local conditions at finitely many primes , we determine the mean number of 2-torsion elements in the class groups and narrow class groups of these cubic fields , when they are ordered by their absolute discriminants .    </S>",
    "<S> for an order @xmath0 in a cubic field , we study the three groups : @xmath1 , the group of ideal classes of @xmath0 of order 2 ; @xmath2 , the group of narrow ideal classes of @xmath0 of order 2 ; and  @xmath3 , the group of ideals of @xmath0 of order 2 . </S>",
    "<S> we prove that the mean value of the difference @xmath4 is always equal to 1 , regardless of whether one averages over the maximal orders in real cubic fields , over all orders in real cubic fields , or indeed over _ any _ family of real cubic orders defined by local conditions . </S>",
    "<S> for the narrow class group , we prove that the average value of the difference @xmath5 is equal to 1 for any such family . also , for any family of complex cubic orders defined by local conditions , we prove similarly that the mean value of the difference @xmath6 is always equal to 1 , independent of the family .    </S>",
    "<S> the determination of these mean numbers allows us to prove a number of further results as by - products . </S>",
    "<S> most notably , we prove  in stark contrast to the case of quadratic fields  that : 1 ) a positive proportion of cubic fields have _ odd _ class number ; 2 ) a positive proportion of real cubic fields have isomorphic 2-torsion in the class group and the narrow class group ; and 3 ) a positive proportion of real cubic fields contain units of mixed real signature . </S>",
    "<S> we also show that a positive proportion of real cubic fields have narrow class group strictly larger than the class group , and thus a positive proportion of real cubic fields do not possess units of every possible real signature . </S>"
  ]
}