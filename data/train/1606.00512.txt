{
  "article_text": [
    "ultracold atoms in optical lattices have become one of the most interesting platforms to examine many - body physics properties of quantum particles .",
    "experiments are under great control , and one can modify both lattice parameters and interactions by adjusting laser intensity or external magnetic field strength .",
    "one of the challenges , however , is that these systems also require a ( harmonic ) trap to keep them stable , which breaks the periodicity of the system .",
    "the system size is also finite  usually about @xmath0 lattice sites per spatial dimension  implying a three - dimensional system has one to thirty million lattice sites .",
    "many different numerical techniques have been applied to these systems , but the larger systems in two - dimensions and nearly all systems in three - dimensions are too large for most exact calculations ( the one exception is bosonic systems , where the quantum - monte - carlo approaches based on the worm algorithm work extremely well in equilibrium for @xmath1  300,000 particles  @xcite ) .",
    "inhomogeneous dynamical mean - field theory ( idmft ) has been applied to many of these systems , and it works well at high temperatures , but it often can not handle the full system size , especially in three - dimensions  @xcite . the dynamical mean - field theory ( dmft )",
    "has two computationally limiting steps ",
    "one is calculating the diagonal of the inverse of a general complex matrix whose dimension is the number of lattice sites @xmath2 and the other is solving the impurity problem on each lattice site .",
    "the former problem grows like @xmath3 for conventional linear - algebra algorithms , while the latter grows linearly with @xmath2 .",
    "hence , significant progress can be made with the idmft approach if other methods could be employed to approximately solve the calculation of the local green s function from the local self - energy .",
    "other , more direct , quantum monte carlo approaches , also suffer from similar issues regarding the computational effort required ( which usually grows as a power law of @xmath2 ) and so are also limited by the system size they can work with  @xcite .",
    "this problem has been tackled by employing the so - called local density approximation ( lda ) , which assumes the local properties of a site within a trap at a given local chemical potential are well approximated by the local properties of a site inside a periodic system at the same chemical potential  @xcite .",
    "since the trap varies both smoothly and slowly with position , this approximation ends up being quite good , with the chemical potential adjusted for each temperature to conserve the total number of particles .",
    "one expects it to start to fail in two regimes : ( i ) the first is at low temperature for ordered phases , especially ordered phases which partially break translational symmetry , because the lda does not invoke any global constraints involved with ensuring that the ordered phase can `` fit '' into the given lattice structure with the trap present and ( ii ) the second is in nonequilibrium systems with mass transport , because the lda assumes the density at a given site is unchanged regardless of the external field applied .",
    "these two issues motivate us to try and develop a technique that will share the success of the lda for high temperatures but will be able to correct it as the temperature is lowered to take into account some of these nonlocal effects or can handle mass transport in the presence of external perturbations ( see ref .   for an application of lda in nonequilibrium",
    "when there is no mass transport ) .    a similar problem has existed within band structure calculations for quite some time .",
    "the generalized gradient approximation ( gga ) was introduced there to try to take into account some of this nonlocal behavior  @xcite .",
    "one can think of it , in some sense , as a taylor series expansion in `` inhomogeneity '' with the lda as the lowest - order term , and gradient corrections as the next term in the hierarchy . in this work",
    ", we extend this gga concept to solving for the green s functions of inhomogeneous systems that _ takes into account the local inhomogeneity about a given lattice site_. while the initial formulas we derive will hold for all computations , we quickly adopt them to the dmft approach , where we assume the self - energy is local .",
    "another way of describing this calculation is that both the lda and the gga approximate the step where we calculate the diagonal of the inverse of a @xmath4 matrix ; the first by replacing the diagonal in the inverse matrix by one matrix element for the whole diagonal and using fourier transformation to compute the inverse ( lda ) and the second by setting up a self - consistent equation for the diagonal of the inverse that involves employing the lda local and nearest - neighbor green s functions and the local self - energy and gga green s function ( gga ) .",
    "other forms of extending the lda to a gga have also been proposed .",
    "for example , see ref .  .",
    "one can view this work as providing a rigorous expansion about the lda and demonstrating why it works so well in the normal state .",
    "it also provides , in principle , a path toward systematically improving the lda , but , as we show below , it is unlikely one will achieve high accuracy at low temperatures with any variant of this approach .",
    "hence , other approaches , which take into account the sparsity of the system , are likely to be required for even more accurate solutions of these problems .",
    "but , when the lda and gga agree , this is a strong indication that the lda is accurate for this set of parameters , and this can be a quite useful application of the gga approach .",
    "the formalism is developed in sec .",
    "ii for the two models we consider in this work : the spinless fermionic falicov - kimball model and the fermionic hubbard model . in sec .",
    "iii , we present the numerical results for ordered phases in mixtures and for the entropy in the hubbard model .",
    "conclusions and outlooks are given in sec .",
    "in order to determine the properties of a many - body quantum system , we often employ a green s function - based method .",
    "the imaginary - time green s function is defined by @xmath5 here , @xmath6 is the hamiltonian , @xmath7 $ ] is the partition function , @xmath8 is the inverse temperature , @xmath9 is the imaginary time and @xmath10 is the time - ordering operator , indicating that the operators are ordered from right to left in increasing time .",
    "the fermionic creation ( annihilation ) operators are @xmath11 ( @xmath12 ) and @xmath13 denotes an operator in the heisenberg representation @xmath14\\mathcal{o}\\exp[-\\mathcal{h}\\tau]$ ] .",
    "the index @xmath15 ( @xmath16 ) is the lattice site and @xmath17 is the @xmath18-component of the spin of the fermion ( which is dropped for the spinless falicov - kimball model ) . we will show the explicit hamiltonians below .",
    "we also can define the green s function for real times , and here , we will define the retarded green s function , which satisfies @xmath19 where @xmath20 is the heaviside unit - step function , @xmath21 denotes the anticommutator , and the heisenberg representation for an operator in real time is @xmath22\\mathcal{o}\\exp[-i\\mathcal{h}t]$ ] .",
    "we typically work with the fourier transform of the retarded green s function , which is @xmath23    the derivation of the gga formalism starts with the dyson equation for the retarded green s function with the inhomogeneous hamiltonian on a lattice @xmath24 ( with @xmath2 lattice sites ) , which includes a ( global ) chemical potential ( @xmath25 ) , a local potential for lattice site @xmath15 ( @xmath26 with @xmath27 the local chemical potential ) , a hopping between lattice sites @xmath15 and @xmath16 for spin @xmath17 ( @xmath28 ) , and a self - energy corresponding to sites @xmath15 and @xmath16 [ @xmath29 : @xmath30 g_{k , j;\\sigma}^r(\\omega)=\\delta_{i , j } , \\label{eq : dyson1}\\ ] ] which has an obvious modification on the imaginary axis when matsubara frequencies are used instead of real frequencies .",
    "we also want to investigate the corresponding equation in the bulk , which would be used for the lda approach . to do this",
    ", we need to introduce some notation . for simplicity",
    ", we will assume the hopping matrix is homogeneous ( this is not required , but makes the notation much less complex ) , so that @xmath28 is the same for the inhomogeneous system and for the homogeneous ones used to develop the lda ( for simplicity , we also assume the hopping is between nearest neighbors only , hence @xmath31 for @xmath32 a nearest - neighbor translation and @xmath33 a schematic notation indicating the neighbor of site @xmath15 in the @xmath32 direction ) .",
    "we then denote the ( local ) chemical potential for the homogeneous system by @xmath34 for all @xmath35 . to be clear , here",
    "the index @xmath16 is the lattice site , but @xmath36 does nt actually depend on the lattice site @xmath16 ; we have set it globally equal to the value the inhomogeneous problem has at site @xmath37 .",
    "if we write out the dyson equation for the lda green s function corresponding to site @xmath37 , it satisfies @xmath38 g_{k , j;\\sigma}^{lda(i)}(\\omega)\\nonumber\\\\ & ~&=\\delta_{i , j } , \\label{eq : dyson_lda}\\end{aligned}\\ ] ] where we suppress the @xmath39 superscript for retarded .",
    "this system is actually translationally invariant and can be solved exactly in momentum space ( and then fourier transformed back to real space ) .    since the right hand sides of eqs .",
    "( [ eq : dyson1 ] ) and ( [ eq : dyson_lda ] ) are equal , so are the corresponding left hand sides .",
    "first , we pick @xmath40 and solve for the local green s function ( by equating the corresponding left hand sides ) to find @xmath41\\nonumber\\\\ & + & \\sum_{k\\ne i}\\left [ \\sigma_{i , k;\\sigma}(\\omega)g_{k , i;\\sigma}(\\omega ) -\\sigma_{i , k;\\sigma}^{lda(i)}(\\omega)g_{k , i;\\sigma}^{lda(i)}(\\omega)\\right ] \\biggr \\}.\\nonumber\\end{aligned}\\ ] ] here , we used the notation @xmath32 to denote a nearest - neighbor translation vector and @xmath42 to denote the lattice site corresponding to the translation by the nearest - neighbor translation vector @xmath32 from site @xmath37 . for the next equation , we choose @xmath43 , @xmath44 and the lda is evaluated with respect to site @xmath42 .",
    "we then solve for @xmath45 , which yields    @xmath46 + \\sum_{k\\ne i+\\delta}\\left [ \\sigma_{i+\\delta , k;\\sigma}(\\omega)g_{k , i;\\sigma}(\\omega)- \\sigma_{i+\\delta , k;\\sigma}^{lda(i+\\delta)}(\\omega)g_{k , i;\\sigma}^{lda(i+\\delta)}(\\omega)\\right ] \\bigr \\}.\\nonumber\\end{aligned}\\ ] ]    for the gga derivation , we want to restrict the terms in our self - consistent equations to involve only on - site terms and nearest - neighbor terms , so we drop terms from eq .",
    "( [ eq:_dyson_offdiag ] ) that involve second neighbors or further .",
    "this implies @xmath47 and @xmath48 only , which gives @xmath49 + \\sigma_{i+\\delta , i;\\sigma}(\\omega)g_{i , i;\\sigma}(\\omega)- \\sigma_{i+\\delta , i;\\sigma}^{lda(i+\\delta)}(\\omega)g_{i , i;\\sigma}^{lda(i+\\delta)}(\\omega)\\bigr \\}.\\nonumber\\end{aligned}\\ ] ] restricting @xmath50 in eq .",
    "( [ eq : gga_dyson ] ) , and substituting in eq .",
    "( [ eq : dyson_offdiag2 ] ) , produces ( after some significant algebra and suppressing retarded superscripts and the @xmath17 subscript ) @xmath51[t_{i+\\delta , i}-\\sigma_{i+\\delta , i}(\\omega)]}{\\omega+\\mu_{i+\\delta}-\\sigma_{i+\\delta , i+\\delta}(\\omega)}}\\nonumber\\\\ & \\times&\\biggr \\",
    "{ \\sum_\\delta t_{i , i+\\delta}\\left [ g_{i+\\delta , i}^{lda(i)}(\\omega)-\\frac{\\omega+\\mu_{i+\\delta}-\\sigma_{i+\\delta , i+\\delta}^{lda(i+\\delta)}(\\omega ) } { \\omega+\\mu_{i+\\delta}-\\sigma_{i+\\delta , i+\\delta}(\\omega)}g_{i+\\delta , i}^{lda(i)}(\\omega)\\right ] \\nonumber\\\\ & ~&-\\sum_\\delta\\frac{\\left [ t_{i , i+\\delta}+\\sigma_{i , i+\\delta}(\\omega)\\right ] \\left [ t_{i+\\delta , i}-\\sigma_{i+\\delta , i}^{lda(i+\\delta)}(\\omega)\\right ] } { \\omega+\\mu_{i+\\delta}-\\sigma_{i+\\delta , i+\\delta}(\\omega ) } \\left [ g_{i , i}^{lda(i+\\delta)}(\\omega)-\\frac{\\omega+\\mu_i-\\sigma_{i , i}^{lda(i)}(\\omega)}{\\omega+\\mu_i-\\sigma_{i , i}(\\omega)}g_{i , i}^{lda(i)}(\\omega)\\right ] \\nonumber\\\\ & ~&+\\sum_\\delta \\left [ \\sigma_{i+\\delta , i}^{lda(i+\\delta)}(\\omega)g_{i+\\delta , i}^{lda(i+\\delta)}(\\omega)-\\frac{\\omega+\\mu_i-\\sigma_{i , i}^{lda(i)}(\\omega)}{\\omega+\\mu_i-\\sigma_{i , i}(\\omega)}\\sigma_{i+\\delta , i}(\\omega)g_{i+\\delta , i}^{lda(i)}(\\omega)\\right ] \\nonumber\\\\ & ~&+\\sum_\\delta \\frac{\\left [ t_{i , i+\\delta}+\\sigma_{i , i+\\delta}(\\omega)\\right ] \\left [ \\sigma_{i+\\delta , i}^{lda(i+\\delta)}(\\omega)-\\sigma_{i+\\delta , i}(\\omega)\\right ] } { \\omega+\\mu_{i+\\delta}-\\sigma_{i+\\delta , i+\\delta}(\\omega)}\\frac{\\omega+\\mu_i-\\sigma_{i , i}^{lda(i)}(\\omega)}{\\omega+\\mu_i-\\sigma_{i , i}(\\omega)}g_{i , i}^{lda(i)}(\\omega)\\biggr \\}.\\end{aligned}\\ ] ]    in particular , if we examine this equation for a spatially uniform system , we have that the lda self - energy equals the full self - energy , and the equation reduces to @xmath52=@xmath53 , as it must .    note that this result depends both on the local and the nearest - neighbor self - energy .",
    "if there is nt a method to be used to determine the nearest - neighbor self - energy of the inhomogeneous system , then one could use the ansatz @xmath54,\\ ] ] to determine an approximation for that self - energy in terms of the lda result . for this work ,",
    "we focus on the idmft approach , so we have only local self - energies , and hence we have @xmath55 .",
    "this result produces a great simplification , and we find    @xmath56\\nonumber\\\\ & ~&-\\sum_\\delta\\frac{t_{i , i+\\delta}t_{i+\\delta , i}}{\\omega+\\mu_{i+\\delta}-\\sigma_{i+\\delta , i+\\delta}(\\omega ) } \\left [ g_{i+\\delta , i+\\delta}^{lda(i+\\delta)}(\\omega)-\\frac{\\omega+\\mu_i-\\sigma_{i , i}^{lda(i)}(\\omega)}{\\omega+\\mu_i-\\sigma_{i , i}(\\omega)}g_{i , i}^{lda(i)}(\\omega)\\right ] \\biggr \\ } \\label{eq : gga_dmft}\\end{aligned}\\ ] ]    within the gga - dmft approach . for a spatially uniform system",
    ", we find @xmath52=@xmath53 , same as before .",
    "the lda - dmft algorithm is as follows : ( 1 ) determine all of the local chemical potentials @xmath57 for the different lattice sites ; ( 2 ) start with a guess for the lda self - energy on each lattice site ( usually zero ) ; ( 3 ) solve @xmath2 copies of the bulk problem for the lda self - energy and lda green s function for each different value of @xmath58 via the standard homogeneous dmft algorithm [ ( i ) compute the local green s function @xmath52 from the self - energy @xmath59 by summing over all momenta ; ( ii ) extract the effective medium ( or host green s function ) @xmath60 ; ( iii ) solve the impurity problem for the given effective medium to construct the new @xmath52 ; ( iv ) extract the new self - energy from the impurity dyson s equation and the old effective medium and new green s functions ; ( v ) repeat ( i - iv ) until the equations reach a fixed point ] ; ( 4 ) use the new lda self - energy on each lattice site to initialize part ( 3 ) again and iterate until one reaches a fixed point ; ( 5 ) compute the total density of particles and compare to the target density  if correct , then stop , if incorrect , update @xmath25 and repeat the process . solving",
    "the lda problem will produce the self - energies and the green s functions for all of the different lattice sites in the lda approximation .",
    "these are then input into the gga calculation , which involves the following steps ; ( 1 ) start with a guess for the self - energy given by the corresponding lda solution@xmath61 ; ( 2 ) compute the new local green s function @xmath52 at each site from eq .",
    "( [ eq : gga_dmft ] ) and the fixed lda results ; ( 3 ) compute the effective medium for the impurity problem via @xmath60 ; ( 4 ) solve the impurity problem in the given effective medium ; ( 5 ) determine the new self - energy from the impurity dyson s equation , the old effective medium and the new green s function ; ( 6 ) extract the self - energy via dyson s equation ; ( 7 ) iterate ( 2 - 6 ) until converged .",
    "these solutions are the gga - dmft solutions to the problem .",
    "note that this algorithm works for either real or imaginary frequencies .",
    "note further that the chemical potential should be adjusted to give the correct filling for the gga .",
    "this implies that the lda results employed within the gga solution may be at the wrong chemical potential .",
    "this causes no problems with the formalism , but one should not compare the lda solutions at this wrong chemical potential to the gga solutions , rather one should compare the lda and gga solutions at the same total particle number .",
    "the spinless falicov - kimball model is given by the following hamiltonian  @xcite @xmath62 where @xmath27 is the local chemical potential ( and @xmath26 is the harmonic trap ) , @xmath63 is the local site energy for the static particles with @xmath64 the harmonic trap potential for the heavy particles , @xmath65 is the on - site interaction between heavy and light particles , @xmath66 ( @xmath67 ) are the fermionic creation and annihilation operators for the mobile electrons and @xmath68 or 1 is the heavy particle number operator .",
    "this hamiltonian can be thought of as the hubbard model hamiltonian with a spin - dependent hopping and the hopping for the down particles set to zero .",
    "the dynamical mean - field theory for the falicov - kimball model is exactly solvable  @xcite .",
    "we usually solve the problem on the imaginary axis to determine the chemical potentials , and the fillings of the different particles on the different sites .",
    "many other quantities can be determined from these solutions , like the total energy , kinetic energy , and so on ; but some observables , like the entropy , require results on the real frequency axis , and so one would then repeat the above procedure , this time for the real frequency axis , to calculate those observables . in that case , the chemical potentials would be set from the imaginary axis calculations , and the real - axis calculations would be done primarily to find the spectral functions , and quantities that can be derived from them .",
    "one technical element for the falicov - kimball model on the imaginary axis , is that it is useful to sum the tails of series using exact sum rules for summations of green s functions .",
    "these sum rules can be found from the moments of the green s functions .",
    "we use this technique to improve the accuracy of our calculations when we determine the filling on each lattice site . for all of the properties reported here with the falicov - kimball model",
    ", we focused entirely on the imaginary - axis results  no real - axis calculations were needed .",
    "because we will be comparing these lda - dmft and gga - dmft results for the falicov - kimball model to a complete inhomogeneous dmft calculation , we can not make the system size too large .",
    "we work primarily with about 10,000 lattice sites and total particle number equal to 1350 ( 625 for each species ) .",
    "this system is slightly smaller than a typical experimental system , but only by a factor of four or so .",
    "note also that earlier work already showed that the idmft solution agrees well with the monte carlo solution  @xcite .",
    "the hubbard model hamiltonian is  @xcite @xmath69 where we have mobile up and down spin particles now .",
    "we employ two different techniques to solve this problem .",
    "one is a strong - coupling perturbation theory approach ( through second - order in the hopping divided by the interaction ) , which has been used earlier to determine the inhomogeneous distribution of the density of the particles and the entropy per particle of the system  @xcite .",
    "we do not repeat the derivation of those formulas here .",
    "we also use a continuous - time quantum monte carlo approach with a weak - coupling implementation .",
    "this approach uses stochastic sampling to sum a series of feynman diagrams in imaginary - time which then solves the problem  @xcite .",
    "the algorithm sums over a random collection of diagrams at different orders , and adjusts the order of the diagram based on importance sampling via a metropolis strategy .",
    "in the implementation that we employ , the approach is most accurate at high - temperature and small interaction strengths . as both the temperature is reduced and the interaction is increased , the average order of the calculation increases , and the integration range in imaginary - time also increases ( which requires more sampling ) . this technique is currently believed to be the most accurate state - of - the - art approach for determining properties that can be calculated at finite - temperatures using green s functions evaluated along the imaginary - time axis .",
    "these include the particle - density at each lattice site , the double occupancy , the entropy - per - particle , and the order parameter if the system goes into an ordered antiferromagnetic phase .",
    "details for how this algorithm is implemented can be found elsewhere .",
    "@xcite                   here , we focus on the density distribution and the calculation of the total energy of the system .",
    "starting from high temperature , we can then integrate to find the entropy via the relation  @xcite @xmath70(\\beta+\\beta^\\prime),\\end{aligned}\\ ] ] for @xmath71 small , with @xmath72 the infinite - temperature entropy .",
    "this result follows from the thermodynamic relation @xmath73 .",
    "we start at a high temperature with hard - wall boundary conditions , which has a limiting form for the high - temperature entropy and then lower the temperature in steps to accumulate the entropy for lower temperatures .",
    "one must be careful to properly renormalize the entropy per lattice site for a lattice calculation into an entropy per particle for the trapped system .",
    "since the strong - coupling approximation is excellent at high temperatures , it provides a useful benchmark for the lda - dmft and gga - dmft approaches iin the following , we sometimes drop the dmft when we describe the lda - dmft and gga - dmft approximations , for simplicity ) .",
    "because these solution methods are highly optimized , they allow us to directly solve the problem on lattices with 8 million lattice sites and up to 300,000 particles just like in the experimental systems .",
    "the scaling of the code with problem size is discussed elsewhere .",
    "we perform a series of test calculations on the falicov - kimball model to examine the robustness of the lda - dmft and gga - dmft approaches .",
    "the system we chose to examine is a two - dimensional lattice with @xmath74 .",
    "this system is large enough that the density of particles approaches zero at the boundary at high temperature where @xmath75 , and stays within the boundary for all lower @xmath76 .",
    "we have 625 light and 625 heavy particles and choose @xmath77 , so we can compare to work done previously  @xcite .",
    "the trap potential is written as @xmath78 where the @xmath79 superscript is used for the heavy particles and @xmath80 denotes the trap frequency . here",
    ", we define @xmath81 as the trap parameter , which is set equal to 12.9 for the light particles and 30 for the heavy particles . at low temperatures ,",
    "this system shows phase separation , where the light particles concentrate at the center and the heavy particles concentrate in a ring on the periphery of the system .",
    "because this system has a homogeneous order parameter in the phase - separated state , it should be describable by both the lda and the gga more accurately than any other phase transition that partially breaks translational symmetry .",
    "hence , it is a useful test case to examine .",
    "note that energies are in units of @xmath82 and entropy per particle in units of @xmath83 when not explicitly included .",
    "we begin by showing radial profiles for the lda , the gga , and the idmft results at the same temperature . in fig .",
    "[ fig : hight ] , we plot the radial profiles for the light particles ( red ) and the heavy particles ( blue ) for @xmath84 ( upper ) and @xmath85 ( lower ) . across each row",
    ", we show the ( a and d ) lda , the ( b and e ) gga , and the ( c and f ) full idmft results . in all the cases ,",
    "the difference between these curves is difficult to see with the naked eye .",
    "indeed , in the normal state , before phase separation sets in , all results agree perfectly , indicating the accuracy of the lda , and the fact that corrections are very small .    on the other hand ,",
    "as the temperature is lowered further , the system starts to enter the phase - separated state , and the bulk systems also see density - wave ordered phases , the most prominent being the checkerboard phase . in our results , we can see these effects clearly .",
    "we start to see disagreements between the three methods and even the prediction of the wrong ordered phases",
    "!    start with @xmath86 , shown in fig .",
    "[ fig : t=0.1 ] , where we first see the effects of the phase separation . in the top row",
    ", we plot the radial density profiles for the three different approximations . unlike at higher temperature , where the curves were all essentially identical , we see disagreement between all three methods here .",
    "the fast oscillations in the radial profile for the gga case , occur due to an ordering in the checkerboard phase at the edge of the region where the light particles give way to the heavy particles ( see middle and lower row ) .",
    "note that the gga also shows the beginnings of a faceted stable region instead of a circular region .",
    "of course , the idmft solution does nt show these features , so they are an artifact of the gga solution .",
    "it is easy to understand what is happening here .",
    "both the lda and the gga are predicting too tight a compression of the heavy particles around the light ones .",
    "the result is that the transition between the two occurs too soon , and ends up lying very close to the regions where the checkerboard phase is stable near half - filling . for the lda ,",
    "it does nt quite look like the checkerboard is stabilized ( although there might be a small modulation of the charge ) , while the gga has significant regions with obvious checkerboard order . because the idmft solution is somewhat less dense",
    ", it stays away from simultaneous half - filling for both particles , and hence does not display the density - wave order .    to understand this behavior further , we lower the temperature even more . the results at @xmath87 are shown in fig .",
    "[ fig : t=0.05 ] .",
    "surprisingly , here we see the checkerboard density - wave ordering is far reduced , and appears only on the boundary regions of the heavy particle rings .",
    "looking closely at the lda solution , we can see the beginnings of some organization of facets , with the flat regions in the inner and outer circles for the heavy particle distributions . in the gga",
    ", the behavior is somewhat reduced .",
    "it is absent in the idmft solution .",
    "one might ask , how can such facets form at all in the lda or gga , since the potential profiles have circular symmetry , but a little thought shows that if there is any kind of density - wave order , then one might not be able to fit the pattern of the density wave into a circular shape , and hence it can slightly alter the shape of the density distributions , yielding behavior that resembles facets . of course , the idmft can naturally pick up facets if they are energetically favorable , which they clearly are not at this temperature .    finally , we go to the lowest temperature studied here @xmath88 in fig .  [",
    "fig : t=0.02 ] . here",
    "the lda shows an innermost phase separated region containing light particles , surrounded by a phase - separated ring containing heavy ones , followed by a checkerboard region , where both species interpenetrate before the density gets small at large distances .",
    "the gga appears to have a small amount of disorder in the checkerboard phase , which perhaps could be inferred as an indication that it is trying to destabilize the checkerboard phase . but otherwise , it resembles the lda results quite closely , with the exception that it shows more faceting , as one might expect because it has some sensitivity to nonlocal ordering effects .",
    "the idmft results , on the other hand , continue to show only phase separation , and they now start to build up facets as one might expect at low temperatures .    hence , the results we see for the falicov - kimball model , which represents mixtures of atoms with different hoppings on an optical lattice ( one much bigger than the other ) , show that at high temperature , the lda is an excellent approximation , but it rapidly breaks down as one lowers the temperature and enters the ordered phases .",
    "this occurs , primarily , because neither the lda nor the gga can enforce global constraints and hence favor density - wave ordering much more strongly than it occurs in the real system .",
    "the idmft results , on the other hand , evolve smoothly and , because they invoke global constraints , they show less density - wave ordering patterns .",
    "one can also see the stability of the half - filled checkerboard phase in the bulk is so strong that it falsely introduces that phase into the lda and gga results , even though they are not present in the idmft results .",
    "there is a delicate balance between local , or nearly local stability and global stability effects that determines the correct phases in the trap , and these effects require more complex algorithms that properly impose the global constraints , rather than techniques that only sense small variations on the scale of the nearest neighbors .",
    "we next turn to the hubbard model , where we apply our results to the experimental results of refs .   and .",
    "in that work , a strong - coupling perturbation theory was employed to determine the entropy per particle of fermion systems with different interaction strengths and different particle densities ( the assumption was that under an adiabatic turning on of the optical lattice , the entropy per particle should be the same for all particle densities ) .",
    "furthermore , it was shown that the entropy per particle appeared to be nearly constant and fell into a reasonable range in between that of the initial fermionic gas ( prior to turning on of the lattice ) and the final fermionic gas ( after dropping the lattice ) , where it heated during the experiment due to diabatic and other effects .",
    "in addition , all but the lowest @xmath65 cases worked very well for determining a single entropy per particle for the range of different particle densities .",
    "but for the smallest interactions , a case where the strong - coupling perturbation theory is expected to be least accurate , and particularly for low densities , one could see significant deviations of the plots of the double occupancy versus particle number .",
    "we investigate this problem further here by comparing the strong - coupling approach to a more accurate but approximate idmft calculation based on the lda and gga approximations [ since the system is too large to be studied with the idmft because it requires about ten million lattice sites for the highest number of fermions ( about 300,000 ) ] .",
    "but because the bulk dmft solution is rather fast with the continuous time quantum monte carlo algorithm , it is feasible to do the lda - dmft and gga - dmft calculations on a high - performance computer .",
    "we took the parameters for the system from experiment .",
    "the mass of the k@xmath89 atom is 39.964  a.u .",
    "and the lattice spacing is 532  nm .",
    "energies are measured in terms of the recoil energy @xmath90 for a potassium atom in a 1064  nm laser .",
    "using a lattice depth of @xmath91 , the hopping is 174  hz , and the trap frequencies for the @xmath92 , @xmath93 , and @xmath18 , axes are 54.1  hz , 50.1  hz , and 129.1  hz , respectively .",
    "we use these precise trap frequencies , which create a slightly anisotropic trap .",
    "the trap potential energy is written as @xmath94 where we introduced the trap lengths @xmath95 given by @xmath96 , @xmath97 and @xmath98 .",
    "we choose the lattice to initially be a cube of 250 lattice sites on each edge .",
    "next , we compute the maximal potential at the point @xmath99 which is at the center of the cube face where the potential grows the slowest , and then discard all points in the lattice with a potential energy due to the trap that is larger than this cutoff . the net number of lattice sites used was then 1,964,881 .",
    "but we reduced these lattice sites into equivalence classes due to the three reflection planes , which involved 253,230 equivalence classes for different lattice sites ( in an irreducible wedge ) .",
    "this is the number of lattice sites for which we needed to solve the impurity problem with the qmc algorithm during each step of the iteration .",
    "this process is easy to parallelize despite the fact that at low temperatures the times to obtain solutions for different fillings could vary by more than an order of magnitude .",
    "this is done simply by employing a master - slave algorithm and dividing the work according to `` first finished gets a new job '' .",
    "the code scaled linearly on up to 43,500 cores .",
    "about 15 million cpu hours were required to run these codes on a cray xe6 .",
    "@xcite    in the experiment , systems of up to 300,000 particles were cooled down to an entropy per particle of about @xmath100 .",
    "two different hyperfine states of k were employed for the spin - up and spin - down states of the hubbard model .",
    "the optical lattice was then turned on , experiments performed , and then the lattice was dropped .",
    "the ending entropy per particle was around @xmath101 .",
    "if we assume the entropy is held constant during the experiment in the trap , then we would immediately guess that the entropy per particle is halfway between these two limits or @xmath102 , but there might be some variations depending on the interactions and on whether both the turning on and turning off of the lattice heat the system in the same fashion .",
    "hence , we would like to be able to independently assess the value of the entropy per particle in the optical lattice .",
    "this was done by plotting the double occupancy versus the total number of particles and fitting to isoentropic curves for the double occupancy versus the number of particles .",
    "the latter were found via a strong coupling approach .",
    "excellent results were found for @xmath103 , @xmath104 , and @xmath105 , but when the case with @xmath106 was examined , there were clear deviations between the experimental data and the isoentropic curves at low particle numbers .",
    "hence , we choose to examine this case with the lda and gga approaches employing a weak - coupling continuous - time qmc solver instead of the strong - coupling solver .    numerically , we achieve this by picking a fixed number of particles and setting @xmath106",
    ". then we start at high temperature and use the lda or gga algorithms to compute the total number of particles for a given chemical potential .",
    "this is then adjusted until the total number of particles agrees with the target value ; because the lda and gga results are so close here , we use the same global chemical potential for both , which results in a slightly different total number of particles for each .",
    "then we extract the double occupancy and the total energy . by using the integral formula for the entropy",
    ", we also determine that for each temperature .",
    "we then reduce the temperature and repeat . in our calculations",
    ", we typically used about 12 different temperatures to establish a fine grid of entropy versus @xmath76 , fraction of doubly occupied particles @xmath107 versus @xmath76 , and @xmath108 .",
    "this is then repeated for the different experimental densities ( 15 different total number of particles chosen to match experiment ) , and the data is then interpolated to determine the isoentropic curves .",
    "these curves are then compared to the experimental data . as an example",
    ", we show a series of calculations for the target particle number @xmath109 in tables  [ table : lda ] and [ table : gga ] .",
    "one can see that the two calculations are quite close to each other , but they deviate rather significantly from the strong - coupling approach at low temperatures .",
    ".data employed in the lda calculation for @xmath109 .",
    "@xmath110 is the characteristic particle number , @xmath107 is the fraction of doubly occupied particles , @xmath111 is the total energy per particle in units of @xmath82 , and @xmath112 is the entropy per particle in units of @xmath83 for the lda and strong - coupling approximations .",
    "we have @xmath113 .",
    "note how the strong - coupling approximation agrees well with the lda - dmft - qmc calculation until the temperature becomes low enough that they start to deviate .",
    "[ cols=\">,>,^,^,^,^,^\",options=\"header \" , ]     since the strong - coupling calculation is much more efficient , we compare our results to the strong - coupling results .",
    "we found that the entropy versus @xmath76 for the gga solution starts to deviate from strong - coupling results ( with the dmft results showing a higher entropy per particle than the strong - coupling results ) at temperatures in the range of @xmath114 for both high and low densities of particles ( see fig .  5 of ref .",
    "for a plot and look at the two tables ) .",
    "this is a little higher than the rule of thumb that the strong - coupling approach fails once the temperature reaches around @xmath82 .",
    "unfortunately , because the dmft solutions are known to overestimate the entropy at low temperatures , it is not clear which result is more accurate in the temperature range from about @xmath115 to @xmath116 .",
    "we operate under the assumption that the dmft results are better here because the interaction strength is not particularly strong .     and the extreme values at 1.3 and 2.5  @xmath83 for ( a ) lda and ( b ) gga . in both cases , we have @xmath113 . [",
    "fig : hubbard ] , width=288 ]     and the extreme values at 1.3 and 2.5  @xmath83 for ( a ) lda and ( b ) gga . in both cases , we have @xmath113 . [",
    "fig : hubbard ] , width=288 ]    the fitting of the data is then rather straightforward .",
    "we plot a series of isoentropic curves for the double occupancy versus the total number of particles and compare to the data and to the data shifted upward and downward by the standard deviation of the double occupancy at each point ( see fig .",
    "[ fig : hubbard ] ) .",
    "then we can estimate both by eye and by evaluating a weighted least - squares fit what the optimal entropy per particle is .",
    "note that the low particle number data still do not fit so well .",
    "hence the use of lda or gga does not significantly improve the analysis .    to be more quantitative , we use a bayesian inference approach to determine the posterior probability density function ( pdf ) as determined by the experimental measurements .",
    "we start from a prior pdf that is flat between the initial experimental value for the entropy per particle 1.3  @xmath83 and the final value 2.5  @xmath83 ( since we only know the possible range for the entropy and all possibilities are _ a priori _ equally likely ) . for each experimental measurement",
    ", we compare to a theoretical estimate which results from the qmc calculations within the lda or gga approach , which are extended from their computed values by a quadratic lagrange interpolation formula .",
    "then we form the chi - square @xmath117 ^ 2.\\ ] ] here , @xmath118 is the measured experimental probability for an atom to be paired when there are on average @xmath119 atoms in the system , @xmath120 is the theoretical prediction for the probability to be paired at a fixed value for the entropy per particle ; this is calculated by interpolating the qmc data .",
    "the symbol @xmath121 is the experimental standard deviation for each experimental measurement at @xmath119 of the pairing probability .",
    "the posterior probability for the system then follows from bayes rule : @xmath122 $ ] .",
    "the posterior pdf is the product of the prior pdf ( which is chosen to be uniform ) and the exponential of minus one half the chi - square .",
    "the posterior pdf is plotted in fig .",
    "[ fig : pdf ] for the lda ( black solid ) and for the gga ( orange dashed ) .",
    "one can see that they nearly lie on top of each other .",
    "the simplest estimate for the entropy is the maximum _ a posteriori _ ( map ) estimate , which is the entropy per particle at the maximum of the pdf , which is 2.243  @xmath83 for the lda and 2.242  @xmath83 for the gga .",
    "we also can calculate the average value of the entropy per particle , by integrating over the pdf along with the variance , which is called the least mean squares ( lms ) estimate .",
    "it yields @xmath123 for the lda and @xmath124 for the gga ; the strong - coupling fit was @xmath125 .",
    "the reason why the lda and gga approaches do not improve things very much is that the fit temperature is rather high and hence is in the regime where the lda , gga , and strong - coupling approaches all agree quite closely . in particular , we find that the gga and lda results are so close for this case that they essentially lie on top of each other .",
    "this is not too surprising since we are rather far from the temperature where the system will start to order .",
    "unfortunately , we are not able to quantitatively answer the question as to whether this lda or gga analysis is more accurate than the strong - coupling analysis , because we had no unbiased way to choose between them .    .",
    "[ fig : pdf ] , width=288 ]    one additional point to note , however , is that the lowest point in each figure for @xmath126  @xmath83 in fig .",
    "[ fig : hubbard ] appears to be a bit higher than we would have expected .",
    "this arises because of the problems the dmft has in overestimating the entropy at low temperature .",
    "in particular , at half - filling , in a bulk system , the entropy per lattice site can not get below @xmath127  @xmath83 until the systems orders into an antiferromagnetic phase , which can quench the entropy .",
    "we believe that the entropy we calculated at the lowest temperature @xmath84 for @xmath128 , is high and when we extrapolate to find the double occupancy for the @xmath126  @xmath83 curve , we find it produces results that are too high . the situation is a little better for the gga than for the lda , primarily because the entropy in the gga is a bit smaller than the entropy for the lda at @xmath84 ( 1.305 versus 1.338  @xmath83 , respectively ) . for both points",
    ", we employed a linear extrapolation using @xmath129 and @xmath84 data .",
    "in this work , we showed how to develop the first correction to the lda by taking into account gradient terms in the dyson equation for the green s function .",
    "we found that the algorithm for the gga within a dmft approach involved only a small change from the lda . in the normal state , at temperatures above any of the ordering temperatures , the lda , gga , and idmft results all agree very well with one another .",
    "this result strongly supports the accuracy for using the lda for such normal state calculations of the properties of ultracold atoms on an optical lattice .",
    "however , when we enter the ordered phase , the lda and gga become inaccurate , often predicting the wrong transition temperature and also predicting the wrong ordered phase .",
    "we have so far not found there to be any simple way to fix this , as the problem appears to require properly applying global constraints as opposed to local and nearly local constraints .",
    "hence , we conclude that the lda is poor for these kinds of problems when the temperature is low enough that it falls into a regime where the system orders .",
    "this does not rule out the approach as being good to describe systems in nonequilibrium with mass transport .",
    "such a problem is beyond the scope of this article , but there has been some preliminary work on this question.@xcite    finally , we conclude that in most cases where the lda works well , the gga does not provide a significant improvement , and when the lda fails , the gga does not fix the failures , so there does not seem to be a huge need for the gga _ per se _ , unless it works well at repairing the problem with nonequilibrium mass transport , which should be looked at critically from this perspective",
    ". however , calculating results for the gga is only slightly more complicated than the lda , and doing so can serve as a useful test on the accuracy of the lda  in cases where the lda and gga agree , it is likely that their results are accurate , in cases where they disagree , it is likely that neither is accurate .",
    "j. k. f. acknowledge support from the national science foundation under grant number phy-1314295 .",
    "j. k. f. also acknowledges support from the mcdevitt bequest at georgetown university .",
    "h. r. k. was supported by the department of science and technology ( india ) .",
    "dod hpc computer time was provided on cray xe6 machines located at the arctic region supercomputer center ( arsc ) , the us air force engineering and research and development center ( afrl ) and the us army engineering research and development center ( erdc ) .",
    "the numerical work was performed in 20102011 , where this project was supported primarily by a challenge project ( darpa - c4j ) and a capabilities application project . during this early phase ,",
    "the project was supported by the darpa optical lattice emulator program , with funds from the army research office .",
    "we thank the esslinger group for providing us with their experimental data and for conversations with niels strohmaier and leticia tarruell that helped clarify the data .",
    "99 b. capogrosso - sansone , n. v. prokofev , and b. v. svistunov , phys .",
    "b * 75 * , 134302 ( 2007 ) .",
    "doi : 10.1103/physrevb.75.134302 .",
    "f. gerbier , s. trotzky , s. foelling , u. schnorrberger , j. d. thompson , a. widera , i. bloch , l. pollet , m. troyer , b. capogrosso - sansone , n. v. prokofev , and b. v. svistunov , phys . rev",
    "* 101 * , 155303 ( 2008 ) .",
    "doi : 10.1103/physrevlett.101.155303 .",
    "r. w. helmes , t. a. costi , and a. rosch , phys .",
    "100 * , 056403 ( 2008 ) .",
    "doi : 10.1103/physrevlett.100.056403 .",
    "e. v. gorelik , i. titvinidze , w. hofstetter , m. snoek , and n. blmer , phys .",
    "lett . * 105 * , 065301 ( 2010 ) .",
    "doi : 10.1103/physrevlett.105.065301 .",
    "thereza paiva , yen lee loh , mohit randeria , richard t. scalettar , and nandini trivedi phys .",
    ". lett . * 107 * , 086401 ( 2011 ) .",
    "doi : 10.1103/physrevlett.107.086401 .",
    "w. kohn and l. j. sham , phys .",
    "140 * , a1133a1138 ( 1965 ) .",
    "doi : 10.1103/physrev.140.a1133 .",
    "m. houbiers , r. ferwerda , h. t. c. stoof , w. i. mcalexander , c. a. sackett , and r. g. hulet , phys .",
    "a * 56 * , 48644878 ( 1997 ) .",
    "doi : 10.1103/physreva.56.4864 .",
    "a. dirks , k. mikelsons , h. r. krishnamurthy , and j. k. freericks , phys .",
    "e * 89 * , 023306 ( 2014 ) .",
    "doi : 10.1103/physreve.89.023306 .",
    "john p. perdew , kieron burke , and matthias ernzerhof , phys . rev",
    ". lett . * 77 * , 38653868 ( 1996 ) .",
    "doi : 10.1103/physrevlett.77.3865 .",
    "erratum : phys .",
    "* 78 * , 1396 ( 1997 ) .",
    "doi : 10.1103/physrevlett.78.1396 .",
    "andrs csords , orsolya almsy , and pter szpfalusy , phys .",
    "a * 82 * , 063609 ( 2010 ) .",
    "doi : 10.1103/physreva.82.063609 .",
    "l. m. falicov and j. c. kimball , phys",
    "22 , 997 - 1000 ( 1969 ) .",
    "doi : 10.1103/physrevlett.22.997 .",
    "u. brandt and c. mielsch , z. phys .",
    "b : condens . matter * 75 * , 365370 ( 1989 ) .",
    "doi : 10.1007/bf01321824 .",
    "j. k. freericks and v. zlati , rev .",
    "* 75 * , 13331382 ( 2003 ) .",
    "doi : 10.1103/revmodphys.75.1333 .",
    "m. m. maka , r. lemanski , j. k. freericks , and c. j. williams , phys .",
    "* 101 * , 060404 ( 2008 ) .",
    "doi : 10.1103/physrevlett.101.060404 .",
    "j. hubbard , proc .",
    "( london ) , ser . a , math .",
    ", * 276 * , 238257 ( 1963 ) .",
    "doi : 10.1098/rspa.1963.0204 . v. w. scarola , l. pollet , j. oitmaa , and m. troyer , phys .",
    "102 , 135302 ( 2009 ) .",
    "doi : 10.1103/physrevlett.102.135302 .",
    "erratum , phys .",
    "* 103 * , 189901(e ) ( 2009 ) .",
    "doi : 10.1103/physrevlett.103.189901 .",
    "s. m. a. rombouts , k. heyde , and n. jachowicz , phys .",
    "lett . , * 82 * , 41554159 ( 1999 ) .",
    "doi : 10.1103/physrevlett.82.4155 .",
    "a. n. rubtsov , v. v. savkin , and a. i. lichtenstein , phys .",
    "b , * 72 * , 035122 ( 2005 ) .",
    "doi : 10.1103/physrevb.72.035122 .",
    "e. gull , a. j. millis , a. i. lichtenstein , a. n. rubtsov , m. troyer , and p. werner , rev .",
    "phys . * 83 * , 349404 ( 2011 ) .",
    "doi : 10.1103/revmodphys.83.349 .",
    "f. werner , o. parcollet , a. georges , and s. hassan , phys .",
    "lett . * 95 * , 056401 ( 2005 ) .",
    "doi : 10.1103/physrevlett.95.056401 .",
    "j. k. freericks , k. mikelsons , and h. r. krishnamurthy , _ proceedings of the hpcmp users group conference 2011 , portland or , june 2023 , 2011 _ , edited by d. e. post , ( high performance computer modernization program office , lorton , va , 2011 ) , pp .",
    "r. jrdens , r , .",
    "n. strohmaier , k. gnter , h. moritz , and t. esslinger , nature * 455 * , 204207 ( 2008 ) .",
    "doi : 10.1038/nature07244 .",
    "r. jrdens , r. , l. taruell , d. greif , t. uehlinger , n. strohmaier , h. moritz , t. esslinger , l. de leo , c. kollath , a. georges , v. scarola , l. pollet , e. burovski , e. kozik , and m. troyer , phys .",
    "lett . * 104 * , 180401 ( 2010 ) .",
    "doi : 10.1103/physrevlett.104.180401 ."
  ],
  "abstract_text": [
    "<S> we develop a generalized gradient expansion of the inhomogeneous dynamical mean - field theory method for determining properties of ultracold atoms in a trap . </S>",
    "<S> this approach goes beyond the well - known local density approximation and at higher temperatures , in the normal phase , it shows why the local density approximation works so well , since the local density and generalized gradient approximations are essentially indistinguishable from each other ( and from the exact solution within full inhomogeneous dynamical mean - field theory ) . </S>",
    "<S> but because the generalized gradient expansion only involves nearest - neighbor corrections , it does not work as well at low temperatures , when the systems enter into ordered phases . </S>",
    "<S> this is primarily due to the problem that ordered phases often satisfy some global constraints which determine the spatial ordering pattern , and the local density and generalized gradient approximations are not able to impose those kinds of constraints ; they also overestimate the tendency to order . </S>",
    "<S> the theory is applied to phase separation of different mass fermionic mixtures represented by the falicov - kimball model and to determining the entropy per particle of a fermionic system represented by the hubbard model . </S>",
    "<S> the generalized gradient approximation is a useful diagnostic for the accuracy of the local density approximation  when both methods agree , they are likely accurate , when they disagree , neither is likely to be correct . </S>"
  ]
}