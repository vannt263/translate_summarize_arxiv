{
  "article_text": [
    "the goal of this paper is to develop , from a geometric point of view , numerical methods for optimal control of lagrangian mechanical systems .",
    "our approach employs the theory of discrete mechanics and variational integrators  @xcite to derive both an integrator for the dynamics and an optimal control algorithm in a unified manner .",
    "this is accomplished through the discretization of the lagrange - dalembert variational principle on manifolds .",
    "an integrator for the mechanics is derived using a standard lagrangian function and virtual work done by control forces , while control optimality conditions are derived using a special lagrangian defined on a higher - dimensional space which encodes the dynamics and a desired cost function .",
    "the resulting integration and optimization schemes are symplectic , respect the state space structure , and momentum preserving .",
    "these qualities are associated with numerical stability which motivate the development of practical algorithms that can be applied to robotic or aerospace vehicles .",
    "the proposed framework is general and applies to unconstrained systems , as well systems with symmetries , underactuation , and nonholonomic constraints . in particular , our construction is appropriate for controlled lagrangian systems that evolve on a general tangent bundle @xmath0 with associated discrete state space @xmath1 , where @xmath2 is a differentiable manifold ( @xcite ) .",
    "in addition we focus on underactuated systems evolving on a lie group @xmath3 ( @xcite ) that are applicable for systems consisting of rigid bodies .",
    "finally , the theory extends to the more general principle bundle setting with discrete analog @xmath4 ( or more generally @xmath5 ) assuming that the action of a lie group @xmath3 of symmetry leaves the control system invariant ( @xcite ) .",
    "the main idea is the following : we take an approximation of the lagrange - dalembert principle for forced lagrangian systems , which models control inputs and external forces such as gravity or drag . in principle , we admit the possibility of piecewise continuous control forces , as happens in real applications .",
    "we observe that the discrete equations of motion for this type of systems are interpreted as the discrete euler - lagrange equations of a new lagrangian defined in an augmented discrete phase space .",
    "next , we apply discrete variational calculus techniques to derive the discrete optimality conditions . after this",
    ", we recover two sequences of discrete controls modeling a piecewise control trajectory .",
    "additionally we show how to derive the equations for different reduced systems .",
    "we specifically develop numerical methods for systems on lie groups that lead to practical algorithm implementation .",
    "one such example system  an underactuated underwater vehicle  is used to illustrate the developed methodology .",
    "the resulting algorithm is simple to implement and has the ability to quickly converge to a solution which is close to the optimal solution and to the true system dynamics .",
    "we also extend our techniques to more general reduced systems like optimal control problems in trivial principal bundles and we show how to introduce nonholonomic constraints in our framework .    moreover , since we are reducing the optimality conditions to discrete euler - lagrange equations , the geometric preservation properties like symplectic - momentum preservation in the standard case or poisson bracket and momentum preservation for reduced systems are automatically guaranteed using the results in  @xcite .",
    "the paper is structured as follows :  [ section2 ] introduces variational integrators . ",
    "[ tq ] formulates optimal control problems for lagrangian systems defined on tangent bundles , in the continuous and discrete setting , and for both fully and underactuated systems . a simple control problem for a mechanical lagrangian on @xmath6 illustrates these developments . in ",
    "[ red ] , discrete mechanics on lie groups is introduced .",
    "specifically , discrete euler - poincar equations and their hamiltonian version , the discrete lie - poisson equations , are obtained . sections  [ disc ] and  [ vehiculo ] develop the discretization procedure and the numerical aspects of the proposed approach .",
    "the developed algorithm is illustrated with an application to an unmanned underwater vehicle evolving on @xmath7 .",
    "finally ,  [ ati ] deals with reduced systems on a trivial principal bundle and with nonholonomic mechanics .",
    "let @xmath2 be a @xmath8-dimensional differentiable manifold with local coordinates @xmath9 , @xmath10 .",
    "denote by @xmath0 its tangent bundle with induced coordinates @xmath11 . given a lagrangian function @xmath12 the euler ",
    "lagrange equations are @xmath13 these equations are a system of implicit second order differential equations . in the sequel , we will assume that the lagrangian is * regular * , that is , the matrix @xmath14 is non - singular .",
    "it is well known that the origin of these equations is variational ( see @xcite ) .",
    "variational integrators retain this variational character and also some of main geometric properties of the continuous system , such as symplecticity and momentum conservation ( see @xcite and references therein ) .    in the following",
    "we will summarize the main features of this type of numerical integrators @xcite .",
    "a * discrete lagrangian * is a map @xmath15 , which may be considered as an approximation of the integral action defined by a continuous lagrangian @xmath16 : @xmath17 where @xmath18 is a solution of the euler - lagrange equations for @xmath19 , where @xmath20 and @xmath21 and @xmath22 is enough small .",
    "the cartesian product @xmath1 is equipped with an interesting differential structure , the lie groupoid structure which allows us to extend the construction of variational calculus to another interesting situations ( lie groupoids ) .",
    "see @xcite for more details .",
    "define the * action sum * @xmath23 , corresponding to the lagrangian @xmath24 by @xmath25 where @xmath26 for @xmath27 , and @xmath28 is the number of steps .",
    "the discrete variational principle states that the solutions of the discrete system determined by @xmath24 must extremize the action sum given fixed endpoints @xmath29 and @xmath30 . by extremizing @xmath31 over @xmath32 , @xmath33",
    ", we obtain the system of difference equations @xmath34 or , in coordinates , @xmath35 where @xmath36 and @xmath37 denote the @xmath8-first and @xmath8-second variables of the function @xmath19 respectively .",
    "these equations are usually called the * discrete euler ",
    "lagrange equations*. under some regularity hypotheses ( the matrix @xmath38 is regular ) , it is possible to define a ( local ) discrete flow @xmath39 , by @xmath40 from ( [ discreteeq ] ) .",
    "define the discrete legendre transformations associated to @xmath24 as @xmath41 and the discrete poincar ",
    "cartan 2-form @xmath42 , where @xmath43 is the canonical symplectic form on @xmath44 .",
    "the discrete algorithm determined by @xmath45 preserves the symplectic form @xmath46 , i.e. , @xmath47 . moreover , if the discrete lagrangian is invariant under the diagonal action of a lie group @xmath3 , then the discrete momentum map @xmath48",
    "defined by @xmath49 is preserved by the discrete flow . therefore , these integrators are symplectic - momentum preserving . here",
    ", @xmath50 denotes the fundamental vector field determined by @xmath51 , where @xmath52 is the lie algebra of @xmath3 .",
    "( see @xcite for more details . )",
    "consider a mechanical system which configuration space is a @xmath8-dimensional differentiable manifold @xmath2 and which dynamics is determined by a lagrangian @xmath53 .",
    "the control forces are modeled as a mapping @xmath54 , where @xmath55 , @xmath56 and @xmath57 , being @xmath58 the control space .",
    "observe that this last definition also covers configuration and velocity dependent forces such as dissipation or friction ( see @xcite ) . for greater generality",
    "we consider control variables that are only piecewise continuous to account for impulsive controls .",
    "the motion of the mechanical system is described by applying the principle of * lagrange - dalembert * , which requires that the solutions @xmath59 must satisfy @xmath60 where @xmath61 are the local coordinates of @xmath0 and where we consider arbitrary variations @xmath62 with @xmath63 and @xmath64 ( since we are prescribing fixed initial and final conditions @xmath65 and @xmath66 ) .",
    "given that we are considering an optimal control problem , the forces @xmath67 must be chosen , if they exist , as the ones that extremize the * cost functional * : @xmath68 where @xmath69 .",
    "the optimal equations of motion can now be derived using pontryagin maximum principle . generally , it is not possible to explicitly integrate these equations and , consequently",
    ", it is necessary to apply a numerical method . in this work , using discrete variational techniques , we will first discretize the lagrange - dalembert principle and then the cost functional .",
    "we obtain a numerical method that preserves some geometric features of the original continuous system as we will see in the sequel .",
    "to discretize this problem we replace the tangent space @xmath0 by the cartesian product @xmath1 and the continuous curves by sequences @xmath70 ( we are using @xmath28 steps , with time step @xmath71 fixed , in such a way @xmath72 and @xmath73 ) . the discrete lagrangian @xmath74 is constructed as an approximation of the action integral in a single time step ( see @xcite ) , that is @xmath75 we choose the following discretization for the external forces : @xmath76 , where @xmath77 , such that    @xmath78    observe that , as mentioned above , we have introduced the discrete controls as two different sequences @xmath79 and @xmath80 . in the notation followed through this paper ,",
    "the time interval between @xmath81 $ ] is denoted as the @xmath82-th interval , while the controls in @xmath83 and @xmath84 are denoted by @xmath85 and @xmath86 respectively .",
    "this choice allows us to model piecewise continuous controls , admitting discrete jumps at the time steps @xmath87 .",
    "our notation is completely depicted in the following figure :    ( 60,50 ) ( 0 , 15)(1,0)59 ( 60,14)@xmath88 ( 6,9)(15,0)4(0,1)35 ( 5,5)@xmath89 ( 19,5)@xmath90 ( 34,5)@xmath91 ( 49,5)@xmath92    ( 31,17)@xmath93 ( 36,17 ) ( 36,32 ) ( 36,32)(1,0)15 ( 37,35)@xmath94    ( 17,41)@xmath95 ( 21,40 )    ( 22,32)@xmath96 ( 21,32 ) ( 21,32)(1,-1)15 ( 6,13)@xmath97 ( 11,10)@xmath98    ( 21,13)@xmath97 ( 25,10)@xmath99    ( 36,13)@xmath97 ( 40,10)@xmath100    ( 7,24)@xmath101 ( 6,25 ) ( 6,25)(1,1)15    ( 51,32 ) ( 46,35)@xmath102    moreover , we have that @xmath103 where @xmath104 ( see @xcite ) .",
    "therefore , we derive a * discrete version of the lagrange - dalembert principle * given in ( [ ldp1 ] ) : @xmath105 for all variations @xmath106 with @xmath107 such that @xmath108 . from this principle",
    "is easy to derive the system of difference equations : @xmath109 where @xmath110 .",
    "equations ( [ eqw ] ) are called the * forced discrete euler - lagrange equations * ( see @xcite ) .",
    "we can also approximate the cost functional ( [ cost-1 ] ) in a single time step @xmath71 by @xmath111 yielding the * discrete cost functional * : @xmath112 observe that @xmath113 .      in this section",
    "we assume the following condition    * ( fully actuated discrete system ) * we say that the discrete mechanical control system is fully actuated if the mappings @xmath114 are both diffeomorphisms .",
    "define the momenta ( see @xcite ) @xmath115 since both @xmath116 are diffeomorphisms we can express @xmath117 in terms of @xmath118 using ( [ fmomenta1 ] ) and ( [ fmomenta2 ] ) .",
    "next , we define a new lagrangian @xmath119 by    @xmath120    the system is fully - actuated , consequently the lagrangian @xmath121 is well defined on the entire discrete space @xmath122 .",
    "now the discrete phase space is the cartesian product @xmath122 of two copies of the cotangent bundle .",
    "the definition ( [ fmomenta1 ] ) , ( [ fmomenta2 ] ) gives us a matching of momenta ( see @xcite ) which automatically implies @xmath123 @xmath110 , which are the forced discrete euler - lagrange equations ( [ eqw ] ) .",
    "in other words , the matching condition enforces that the momentum at time @xmath82 should be the same when evaluated from the lower interval @xmath124 $ ] or the upper interval @xmath125 $ ] .",
    "consequently , along a solution curve there is a unique momentum at each time @xmath126 , which can be called @xmath127 .",
    "the discrete euler - lagrange equations of motion for the lagrangian @xmath128 are    @xmath129    in summary , we have obtained the discrete equations of motion for a fully - actuated mechanical optimal control problem as the discrete euler - lagrange equations for a lagrangian defined on the product of two copies of the cotangent bundle . therefore , all the preservation properties of the discrete equations ( [ elca ] ) and ( [ elcb ] ) are now a direct consequence of the theory of variational integrators @xcite .",
    "consider the case @xmath131 and assume that @xmath132 is an @xmath133 constant and symmetric matrix .",
    "the mechanical lagrangian @xmath134 is defined by @xmath135 , where @xmath136 is the potential function and @xmath137 .",
    "the system is fully actuated and there exist no velocity constraints .",
    "the optimal control problem is typically in terms of boundary conditions @xmath138 and @xmath139 for a given final time @xmath140 .",
    "note that in the continuous setting we can define the momentum by the continuous legendre transformation @xmath141 , @xmath142 : @xmath143 , i.e. @xmath144 . in consequence ,",
    "we can define boundary constraints also in the phase space : @xmath145 and @xmath146 .",
    "we set the trapezoidal discretization for the lagrangian ( see @xcite ) , that is , @xmath147 where , as above , @xmath71 is the fixed time step and @xmath148 is a sequence of elements on @xmath130 .",
    "our concrete discrete lagrangian is @xmath149 the control forces are @xmath150 and @xmath151 . for sake of clarity , we are going to fix the control forces in the following manner @xmath152 . looking at equations ( [ fmomenta1 ] ) and ( [ fmomenta2 ] )",
    "is easy to obtain the associated momenta @xmath127 and @xmath153 , namely @xmath154 let @xmath155 $ ] be a discrete approximation of the cost function .",
    "consequently , the lagrangian over @xmath156 is @xmath157 where @xmath158 represents the derivative of @xmath159 with respect to the variable @xmath160 . applying equations ( [ elca ] ) and ( [ elcb ] )",
    "to @xmath161 we obtain the following equations :    @xmath162    where both set of equations are defined for @xmath163 .",
    "it is quite clear that we could remove the @xmath164 dependence in equation ( [ tb2 ] ) .",
    "however , we prefer to keep it in order to stress that the discrete variational euler - lagrange equations ( [ elca ] ) and ( [ elcb ] ) are defined in @xmath122 ( @xmath165 in the particular case we are considering in this example ) .",
    "expressions ( [ tb1 ] ) and ( [ tb2 ] ) give @xmath166 equations for the @xmath167 unknowns @xmath168 , @xmath169 .",
    "nevertheless , the boundary conditions @xmath170 contribute @xmath171 extra equations that convert eqs .",
    "( [ tb1 ] ) and ( [ tb2 ] ) in a nonlinear root finding problem of @xmath166 and the same amount of unknowns .      in this section ,",
    "we examine the case of underactuated systems defined as follows :    * ( underactuated discrete system)*[ud1 ] we say that the discrete mechanical control system is underactuated if the mappings @xmath172 are both embeddings , that is , they are one - to - one immersions that are homeomorphisms of @xmath58 to its image .    under this hypothesis",
    "we deduce that @xmath173 , + @xmath174 are submanifolds of @xmath175 and @xmath176 , respectively",
    ". therefore , @xmath177 are diffeomorphisms onto its image .",
    "moreover , @xmath178 .",
    "the set of admissible forces is restricted to the space @xmath179 . as a consequence ,",
    "the set of admissible momenta defined in   and   satisfy @xmath180 thus , the lagrangian function defined in   is restricted to these points only .",
    "thus , it is necessary to apply constrained variational calculus to derive the corresponding equations ( see @xcite ) .",
    "this is typically performed by means of constraint functions @xmath181 , @xmath182 .",
    "therefore the solutions of the optimal control problem are now viewed as the solutions of the discrete constrained problem determined by an extended lagrangian @xmath183 and the constraints @xmath184 . since @xmath185",
    "are embeddings , as established in definition , the number of constraints is determined by @xmath8 minus the dimension of @xmath58 .",
    "note that the total number of constraints , @xmath184 , is therefore @xmath186 .    to solve this problem",
    "we introduce lagrange multipliers @xmath187,@xmath188 and consider discrete variational calculus using the augmented lagrangian @xmath189 observe that , in spite the constraints are functions of the cartesian product of two copies of the cotangent bundle i.e. @xmath190 , neither @xmath191 depends on @xmath153 nor @xmath192 on @xmath164 .",
    "the discrete euler - lagrange equations gives us the solutions of the underactuated problem .",
    "typically , the underactuated systems appear in an affine way that is @xmath193 where @xmath194 , @xmath195 . moreover @xmath196 and @xmath197 are linear maps ( we assume that @xmath58 is a vector space and @xmath198 is the set of all linear maps between @xmath199 and @xmath200 ) . in consequence @xmath201 and @xmath202",
    ".    then the constraints are deduced using the compatibility conditions : @xmath203 which imply constraints in @xmath204 and @xmath205 , respectively .",
    "the fact that @xmath206 are both embeddings implies furthermore that @xmath207 .",
    "an indispensable tool in the study of mechanical systems is reduction theory .",
    "therefore , in this work we consider its discrete analogue .",
    "this is precisely the motivating idea of the work by moser and veselov @xcite , i.e. to give a discrete analogue of euler - poincar reduction .",
    "the approach is to reduces the standard second order euler - lagrange equations when the configuration space is a lie group @xmath3 to first order equations on the lie algebra @xmath52 .    following the developments in @xmath208 [ section2 ]",
    "assume that the lagrangian defined by @xmath209 is invariant so that @xmath210 for any element @xmath211 and @xmath212 . according to this",
    ", we can define a reduced lagrangian @xmath213 by @xmath214 where @xmath215 and @xmath216 is the identity of the lie group @xmath3 .",
    "the reduced action sum is given by @xmath217 taking variations of @xmath218 and noting that @xmath219 where @xmath220 , we arrive to the discrete euler - poincar equations : @xmath221 where @xmath222 and @xmath223 are respectively the left and the right translations of the group ( see also  @xcite ) .",
    "if we denote by @xmath224 then the discrete euler - poincar equations are rewritten as @xmath225 where @xmath226 is the adjoint action of @xmath3 on @xmath227 .",
    "typically this equations are known as the _ discrete lie - poisson equations _ ( see @xcite ) .",
    "consider a mechanical system determined by a lagrangian @xmath228 , where @xmath52 is the lie algebra of a lie group @xmath3 , which also is a @xmath8-dimensional vector space .",
    "the continuous external forces are defined as follows @xmath229 .",
    "the motion of the mechanical system is described applying the following principle @xmath230 for all variations @xmath231 of the form @xmath232 $ ] , where @xmath233 is an arbitrary curve on the lie algebra with @xmath234 and @xmath235 ( see @xcite ) .",
    "in addition @xmath236 is the natural pairing between @xmath227 and @xmath237 .",
    "these equations give us the controlled euler - poincar equations : @xmath238 where @xmath239 $ ] .",
    "the optimal control problem consists of minimizing a given * cost functional * : @xmath240 where @xmath241 .",
    "now , we consider the associated discrete problem .",
    "first we replace the lie algebra @xmath52 by the lie group @xmath3 and the continuous curves by sequences @xmath242 ( since the lie algebra is the infinitesimal version of a lie group , its proper discretization is consequently that lie group @xcite ) .",
    "the discrete lagrangian @xmath243 is constructed as an approximation of the action integral , that is @xmath244 let define the discrete external forces in the following way : @xmath245 , where @xmath246 for @xmath247 . in consequence @xmath248 where @xmath249 and @xmath250 , for all @xmath82 .",
    "in addition @xmath251 and @xmath236 is the natural pairing between @xmath252 and @xmath253 .    for sake of simplicity",
    "we are sometimes going to omit the dependence on @xmath254 of both @xmath255 and @xmath256 .    taking all the previous into account",
    ", we derive a * discrete version of the lagrange - dalembert principle for lie groups * : @xmath257 for all variations @xmath258 verifying the relation @xmath259 with @xmath260 an arbitrary sequence of elements of @xmath261 which satisfies @xmath262 ( see @xcite ) .    from this principle",
    "is easy to derive the system of difference equations : @xmath263 for @xmath110 , which are called the * controlled discrete euler - poincar equations*.    the cost functional ( [ cost ] ) is approximated by @xmath264 yielding the * discrete cost functional * : @xmath265 observe that now @xmath266 .      in the fully actuated case",
    "the mappings @xmath267 defined by @xmath268 are diffeomorphisms for all @xmath269 , therefore , we can construct the lagrangian @xmath270 by @xmath271 where the variables @xmath272 are defined by @xmath273 the discrete phase space @xmath274 is now a mixture of two copies of the lie algebra @xmath253 and a lie group @xmath3 .",
    "this is also an example of a lie groupoid ( @xcite ) .",
    "the discrete optimal control problem defined in ( [ lddiscreto ] ) and ( [ cd ] ) has been reduced to a lagrangian one , with lagrangian function @xmath275 . in consequence , we are able to apply discrete variational calculus to obtain the discrete equations of motion in the phase space @xmath276 .",
    "let us show how to derive these equations from a variational point of view ( see @xcite for further details ) .",
    "define first the discrete action sum @xmath277 consider sequences of the type @xmath278 with boundary conditions : @xmath279 and the composition @xmath280 fixed .",
    "therefore an arbitrary variation of this sequence has the form @xmath281 with @xmath282 ( both @xmath283 and @xmath284 are real parameters ) and @xmath285 , @xmath286 , @xmath287 , @xmath288 and @xmath289 , for all @xmath283 .",
    "additionally @xmath290 for all @xmath82 .",
    "the critical points of the discrete action sum subjected to the previous boundary conditions are characterized by @xmath291 taking derivatives we obtain @xmath292 \\delta h_k\\\\ & & + \\sum_{k=1}^{n-1}\\left[d_2{\\mathcal l}_{d}\\big|_{(w_{k-1})}(\\nu_{k-1 } , \\nu_{k})+d_1{\\mathcal l}_{d}\\big|_{(w_{k})}(\\nu_k , \\nu_{k+1})\\right ] \\delta \\nu_k,\\end{aligned}\\ ] ] where @xmath293 and @xmath294 are defined by @xmath295 , where @xmath269 and @xmath296 .",
    "since @xmath297 ( which is defined as @xmath298 ) and @xmath299 ( which is defined as @xmath300 ) , @xmath110 are arbitrary , we deduce the following discrete equations of motion : @xmath301 for @xmath110 . similarly to   [ sec : fas ] we obtain the control inputs @xmath302 and @xmath303 using  .",
    "the underactuated case can now be considered by adding of constraints . similarly to   [ sec : uas ] underactuation restricts the control forces to lie in a subspace spanned by vectors @xmath304 of the basis @xmath305 of @xmath306 , where @xmath307 .",
    "then @xmath308 where @xmath309 and @xmath310 , for all @xmath311 .",
    "additionally , the embedding condition implies that @xmath312 .",
    "then , taking the dual basis @xmath313 , we induce the following constraints :    [ expli ] @xmath314    observe in that , even though the constraints are functions @xmath315 , neither @xmath316 depends on @xmath317 nor @xmath318 on @xmath319 . once we have defined the constraints we can implement the lagrangian multiplier rule in order to solve the underactuated problem .",
    "namely , we define de extended lagrangian as : @xmath320 defining the discrete action sum @xmath321 we obtain the underactuated discrete equations of motion @xmath322e_{\\sigma } = 0,\\\\      & \\phi^{-}_{\\sigma}(\\nu_k , w_k , \\nu_{k+1})=0,\\\\      & \\phi^{+}_{\\sigma}(\\nu_k , w_k , \\nu_{k+1})=0 ,           \\end{split}\\end{aligned}\\ ] ] where the subscripts @xmath323 , @xmath324 , @xmath325 , @xmath326 denoted variables that are fixed .",
    "we now put the discrete optimal control equations   and   into a form suitable for algorithmic implementation .",
    "the numerical methods are constructed using the following guidelines :    1 .",
    "good approximation of the dynamics and optimality , [ reqs : dyn ] 2 .   avoid issues with local coordinates [ reqs : par ] 3 .",
    "guarantee for numerical robustness and convergence , [ reqs : conv ] 4 .   numerical efficiency .",
    "[ reqs : eff ]    the discrete mechanics approach provides an accurate approximation of the dynamics ( requirement  [ reqs : dyn ] ) through momentum and symplectic form preservation and good energy behavior .",
    "in addition , we will satisfy requirement  [ reqs : par ] for systems on lie groups by lifting the optimization to the lie algebra through a retraction map that will be defined in this section .",
    "the resulting algorithms are numerically robust in the sense that there are no issues with coordinate singularities and the dynamics and optimality conditions remain close to their continuous counterparts even at big time steps . yet , as with any other nonlinear optimization scheme it is difficult to formally claim that the algorithm will always converge ( requirement  [ reqs : conv ] ) .",
    "nevertheless , in practice there are only isolated cases for underactuated systems that fail to converge .",
    "a remedy for such cases has been suggested in  @xcite . in general , the resulting algorithms require a small number of iterations , e.g. between 10 and 20 to converge ( requirement  [ reqs : eff ] ) .",
    "the optimization variables @xmath327 are regarded as small displacements on the lie group .",
    "thus , it is possible to express each term through a lie algebra element that can be regarded as the averaged velocity of this displacement .",
    "this is accomplished using a * retraction map * @xmath328 which is an analytic local diffeomorphism around the identity such that @xmath329 , where @xmath330 .",
    "two standard choices for @xmath331 are employed in this work : the exponential map , and the cayley map .",
    "regarding @xmath332 as a velocity we set the discrete lagrangian @xmath333 to @xmath334 where @xmath335 .",
    "the difference @xmath336 , which is an element of a nonlinear space , can now be represented by the vector @xmath337 in order to enable unconstrained optimization in the linear space @xmath227 for optimal control purposes .",
    "the variational principle will now be expressed in terms of the chosen map @xmath331 .",
    "the resulting discrete mechanics will thus involve the derivatives of the map which we define next ( see also  @xcite ) :    [ retr ] given a map @xmath338 , its * right trivialized tangent * @xmath339 and is * inverse * @xmath340 , are such that for @xmath341 and @xmath342 , the following holds @xmath343    using these definitions , variations @xmath344 and @xmath345 are constrained by @xmath346 where @xmath347 , which is obtained by straightforward differentiation of @xmath348 .    the retraction map @xmath349 choices are :    \\a ) the exponential map @xmath350 , defined by @xmath351 , with @xmath352 in the integral curve through the identity of the vector field associated with @xmath353 ( hence , with @xmath354 ) . the right trivialized derivative and its inverse",
    "are defined by @xmath355 where @xmath356 are the bernoulli numbers ( see @xcite ) .",
    "typically , these expressions are truncated in order to achieve a desired order of accuracy .",
    "\\b ) the cayley map @xmath357 is defined by @xmath358 and is valid for a general class of quadratic groups ( see @xcite ) that include the groups of interest in this paper ( e.g. @xmath359 , @xmath360 and @xmath7 ) .",
    "its right trivialized derivative and inverse are defined by @xmath361    next , the discrete forces and cost function are defined through a trapezoidal approximation , i.e. @xmath362 and @xmath363 respectively . with the choice of a retraction map and the trapezoidal",
    "rule the equations of motion   become @xmath364 while the momenta defined in   take the form @xmath365 finally , define the lagrangian @xmath366 such that @xmath367 note that the lagrangian is well - defined only on @xmath368 , where @xmath369 is an open neighborhood around the identity for which @xmath331 is a diffeomorphism . to make the notation as simple as possible we retain the lagrangian definition to the full space @xmath370 .",
    "the optimality conditions corresponding to   become @xmath371 for @xmath372 . here , @xmath373 equations ( [ equaciones2pr ] ) and ( [ equaciones2 ] ) can be also obtained from ( [ equaciones ] ) employing lemma  [ lemapr ] and lemma  [ lemapr2 ] in appendix a.    in the underactuated case we define @xmath374 and from   obtain the equations @xmath375 where we employed the notation @xmath376 .    _",
    "boundary conditions .",
    "_ : establishing the exact relationship between the discrete and continuous momenta , @xmath377 and @xmath378 , respectively , is particularly important for properly enforcing boundary conditions that are given in terms of continuous quantities .",
    "the following equations relate the momenta at the initial and final times @xmath379 and @xmath380 and are used to transform between the continuous and discrete representations : @xmath381 which also corresponds to the relations @xmath382 and @xmath383 .",
    "these equations can also be regarded as structure - preserving * velocity boundary conditions * , i.e. , for given fixed velocities @xmath384 and @xmath385 .",
    "the exact form of the previous equations depends on the choice of @xmath331 .",
    "this choice will also influence the computational efficiency of the optimization framework when the above equalities are enforced as constraints .",
    "the numerical procedure to compute the trajectory is summarized as follows :    * optimal control*[algo : oc ]    1 .",
    "data : group @xmath3 ; mechanical lagrangian @xmath386 ; control functions @xmath387 , @xmath388 ; cost function @xmath389 ; final time @xmath140 ; number of segments @xmath28 .",
    "input : boundary conditions @xmath390 and @xmath391 .",
    "3 .   set momenta @xmath392 and @xmath393 4 .",
    "solve for @xmath394 the relations : + @xmath395 5 .",
    "output : optimal sequence of velocities @xmath396 .",
    "reconstruct path @xmath397 by @xmath398 for @xmath372 .",
    "the solution is computed using root - finding procedure such as newton s method . if the initial guess does not satisfy the dynamics we recommend to use a levenberg - marquardt algorithm which has slower but more robust convergence .",
    "consider a lagrangian consisting of the kinetic energy only @xmath399 full unconstrained actuation , no potential or external forces and no velocity constraint .",
    "the map @xmath400 is called the inertia tensor and is assumed full rank .    in the fully actuated case",
    "we have @xmath401 .",
    "we consider a minimum effort control problem , i.e. @xmath402 the optimal control problem for fixed initial and final states @xmath403 and @xmath404 can now be summarized as :    * compute : * @xmath405 , @xmath406 ,    * minimizing : * @xmath407    * subject to : *    @xmath408 ,    @xmath409    @xmath410 ,    @xmath411 ,    @xmath412    @xmath413    the optimality conditions for this problem are derived as follows .",
    "the lagrangian becomes    @xmath414    where the momentum has been computed according to @xmath415 thus the optimality conditions become @xmath416 it is important to note that these last two equations define @xmath417 equations in the @xmath418 unknowns @xmath405 .",
    "a solution can be found using nonlinear root finding .",
    "once @xmath419 have been computed , is possible to obtain the final configuration @xmath420 by reconstructing the curve by these velocities . beside",
    ", the boundary condition @xmath421 is enforced through the relation @xmath422 without the need to optimize over any of the configurations @xmath423 .",
    "the developed framework can be extended to a configuration - dependent lagrangian @xmath424 , for instance defined in terms of a kinetic energy @xmath425 and potential energy @xmath426 according to @xmath427 where @xmath428 and @xmath353 .",
    "the controlled euler - poincar equations are in this case @xmath429 where the external forces are defined as @xmath430 .",
    "our discretization choice @xmath431 will be ( recall that @xmath432 ) @xmath433 while the @xmath3-dependent discrete forces now become @xmath434 this leads to the discrete equations @xmath435    the momenta become @xmath436 in consequence , we can define a discrete lagrangian @xmath437 depending on the variables @xmath438 which discrete equations of motion will be a mixture between ( [ equaciones ] ) and ( [ equaciones2pr ] ) , ( [ equaciones2 ] ) , namely    @xmath439",
    "we illustrate the developed algorithm with an application to a simulated unmanned underwater vehicle .",
    "figure shows the model equipped with five thrusters which produce forces and torques in all directions but the body - fixed `` y''-axis .",
    "since the input directions span only a five - dimensional subspace the problem is solved through the underactuated framework .",
    "[ fig : uuv_plots ]    [ cols=\"^,^,^ \" , ]     one of the advantages of employing the discrete variational framework is the treatment of discontinuous control inputs as illustrated in   [ tq ] .",
    "the nature of the control curve depends on the cost function . in the standard",
    "squared control effort case ( i.e. @xmath440 control curve norm employed in   [ sec : uv ] ) the resulting control is smooth .",
    "another cost function of interest is @xmath441 ( i.e. the @xmath442 control curve norm ) which is typically imposed along with the constraints @xmath443 .",
    "this case results in a discontinuous optimal control curve .",
    "our formulation can handle such problems easily since the terms @xmath302 and @xmath303 are regarded as the forces before and after time @xmath88 , respectively . a computed scenario of a rigid body actuated with two control torques around its principles axes of inertia ( fig .",
    "[ fig : rb ] ) illustrates the discontinuous case .",
    "[ ati ] the methods developed in the previous sections are easily adapted to other cases which are of great interest in real applications .",
    "in particular , this section will be devoted to the discussion of two important extensions : the case of optimal control problems for lagrangians of the type @xmath444 ( that is , reduction by symmetries on a trivial principal fiber bundle ) and the case of nonholonomic systems . here , @xmath132 denotes a smooth manifold .",
    "observe that the phase space @xmath445 unifies the previously studied cases of a tangent bundle and a lie algebra .",
    "the notion of principal fiber bundle is present in many locomotion and robotic systems  @xcite .",
    "when the configuration manifold is @xmath446 , there exists a canonical splitting between variables describing the position and variables describing the orientation of the mechanical system .",
    "then , we distinguish the pose coordinates @xmath428 ( the elements in the lie algebra will be denoted by @xmath353 ) , and the variables describing the internal shape of the system , that is @xmath447 ( in consequence @xmath448 ) .",
    "observe that the lagrangians of the type @xmath449 mainly appears as reduction of lagrangians of the type @xmath450 , which are invariant under the action of the lie group @xmath3 . under the identification",
    "@xmath451 we obtain the reduced lagrangian @xmath386 .",
    "we first develop the discrete optimal control problem for systems in an unconstrained principle bundle setting in   [ sec : docpb ] .",
    "nonholonomic constraints are then added to treat the more general case of locomotion systems in   [ sec : docns ] .",
    "the discrete case is modeled by a lagrangian @xmath452 which is an approximation of the action integral in one time step @xmath453 where @xmath454 and @xmath455 .",
    "again , we make an election for the discrete control forces @xmath456 , where @xmath246 : @xmath457 here @xmath458 and @xmath459 ( more concretely @xmath460 , @xmath461 , @xmath462 , @xmath463 ) .    similarly to the developments in @xmath208 [ tq ] and @xmath208 [ al ]",
    "we can formulate the * discrete lagrange - dalembert principle * : @xmath464 which can be rewritten as @xmath465 for all variations @xmath466 with @xmath467 and @xmath468 ; also @xmath469 with @xmath470 , such that @xmath471 , being @xmath472 a sequence of independent elements of @xmath227 such that @xmath473 .",
    "applying variations in the last expression and rearranging the sum , we finally obtain the complete set of * forced discrete euler - lagrange equations * : @xmath474 with @xmath110 .",
    "since we are dealing with an optimal control problem , we introduce a discrete cost function @xmath475 . as in previous cases ,",
    "our objective is to extremize the following sum @xmath476 subjected to equations ( [ at1 ] ) and ( [ at2 ] ) .",
    "let us initially restrict our attention to the case of fully actuated systems .    *",
    "( fully actuated discrete system)*[defab ] we say that the discrete mechanical control system is fully actuated if the mappings @xmath477 are both diffeomorphisms .",
    "according to equations ( [ at1 ] ) and ( [ at2 ] ) , we can introduce the momenta by means of the following discrete legendre transforms : @xmath478 in the fully actuated case , is possible to find the value of all control forces in terms of @xmath479 , that is : @xmath480 replacing ( [ uk- ] ) and ( [ uk+ ] ) into @xmath481 , we finally obtain the discrete lagrangian that completely describes our system : @xmath482 the associated * discrete cost functional * is @xmath483 as usual , we take now variations in ( [ atcf ] ) in order to obtain the discrete euler - lagrange equations for our optimal control problem ( with some abuse of notation we denote @xmath484 the whole set of coordinates in the new phase space ) : @xmath485 together with the forced discrete euler - lagrange equations ( [ at1 ] ) and ( [ at2 ] ) .    typically , actuation is achieved by controlling only a subset of the shape variables . in our setting this is can be regarded as * underactuation *  the mappings in definition [ defab ] become embeddings . if this is the case , it is necessary to introduce constraints and apply constrained variational calculus as in @xmath208 [ ud1 ] and @xmath208 [ al ] .",
    "this subsection is devoted to add nonholonomic constraints to the picture .",
    "holonomic constraints might be considered as a pacticular case of the nonholonomic ones ( see @xcite for further details ) . with this extension",
    "it would be possible consider examples of optimal control of robotic vehicles . in the following",
    "we will expose the theoretical framework , leaving for future research the application to concrete examples .",
    "a controlled discrete nonholonomic system on @xmath486 is given by the following quadruple ( see @xcite ) :    * a * regular discrete lagrangian * @xmath487 .",
    "* a * discrete constraint embedded submanifold * @xmath488 of @xmath486 .",
    "* a * constraint distribution * , @xmath489 , which is a vector subbundle of the vector bundle @xmath490 , such that @xmath491 . typically , there is a relation between the constraint distribution and the discrete constraint , since from @xmath488 we induce for every @xmath447 , the subspace @xmath492 of @xmath493 given by @xmath494 where we are identifying @xmath495 , with @xmath216 being the identity element of the lie group @xmath3 .",
    "* the discrete control forces @xmath496 where @xmath246 ( again , forces @xmath497 split into @xmath498 and @xmath499 as in the previous section ) .",
    "we have the following * discrete version of the lagrange - dalembert principle for controlled nonholonomic systems * : @xmath464 for all variations @xmath466 , with @xmath468 ; and @xmath469 , such that @xmath471 , being @xmath472 , verifying @xmath500 such that @xmath473 .",
    "moreover , @xmath501 , @xmath502 ( see @xcite ) .    take a basis of sections @xmath503 of the vector bundle @xmath504 , where @xmath505 and @xmath506 for @xmath507 .",
    "hence , the equations of motion derived from the discrete lagrange - dalembert principle for controlled nonholonomic systems are :    @xmath508    where @xmath509 are the constraints which locally determine @xmath510 .    in a more geometric way",
    ", we can write equations ( [ eq - noh ] ) and ( [ eq - cons ] ) as follows @xmath511 where@xmath501 and @xmath512 is the canonical inclusion .    given a discrete cost function @xmath513 and the optimal control problem is to minimize the action sum @xmath514 subject to equations ( [ eq - noh ] ) and ( [ eq - cons ] ) and to some given boundary conditions .",
    "we next distinguish between the fully and under  actuated case using the following definition :    * ( fully actuated nonholonomic discrete system * ) we say that the discrete nonholonomic mechanical control system is fully actuated if the mappings @xmath515 are both diffeomorphisms for all @xmath516 .    regarding equation ( [ eq - noh ] ) and its geometric redefinition just below , let introduce the following momenta : @xmath517 where both @xmath518 and @xmath519 belong to @xmath520 . in the fully actuated case , the value of all control forces can be completely determined in terms of @xmath521 , where the coordinates @xmath522 always belong to @xmath488 .",
    "therefore we can re - express the cost function in terms of these variables and , in consequence , derive the discrete lagrangian @xmath523 where @xmath524 are the projections onto the first and second arguments and @xmath525 the vector bundle projection .",
    "observe that we can consider this case as a constrained discrete variational problem taking an extension @xmath526 of @xmath183 subjected to the constraints @xmath509 .",
    "therefore , denoting @xmath527 as the whole set of coordinates of the new phase space @xmath528 , we deduce that the equations of motion are @xmath529 where @xmath530 are the lagrange multipliers of the new constrained problem .",
    "the underactuated case can be handled by adding new constraints and applying discrete constrained variational calculus similarly to   [ red ] .",
    "a natural framework that simplifies the previous construction is based on discrete mechanics on lie groupoids @xcite .",
    "the lie groupoid structure generalizes the case of @xmath1 , the lie group @xmath3 and also many intermediate situations . in particular , many of the examples studied in this paper can be modeled using lie groupoid techniques adapted to our formalism ( see @xcite ) .",
    "this paper develops numerical methods for optimal control of lagrangian mechanical systems defined on tangent bundles , lie groups , trivial principal bundles , and nonholonomic systems .",
    "the proposed approach preserves the geometry and variational structure of mechanics through the discretization of the variational principles on manifolds .",
    "the key point is to solve the optimal control through discrete mechanics , i.e. by formulating the optimization as the solution of an action principle of a higher - dimensional system in a new lagrangian phase space , i.e. @xmath122 in the general case and @xmath531 in the lie group case .",
    "the optimal control algorithm is then derived as a variational integrator subject to boundary conditions .",
    "we thus expect that both the dynamics and optimal control solutions will have accurate and stable numerical behavior ( due to symplectic - momentum preservation ) even at large time - steps ( which allows for improved run - time efficiency ) .",
    "simulations of an underactuated underwater vehicle illustrate an application of the method . yet",
    ", further numerical studies and comparisons would be necessary to exactly quantify the advantages and the limitations of the proposed algorithm .",
    "an important future direction is thus to study the convergence properties of the optimal control system .",
    "convergence for general nonlinear systems is a complex issue . in this respect , it is interesting to note that the discrete mechanics and optimal control on lie groups such as the example in  [ vehiculo ] using the cayley map results in polynomial form without further approximation or taylor series truncation .",
    "a useful future direction is then to study the regions of attraction of the numerical continuation using tools from algebraic geometry .",
    "more generally , the theoretical framework introduced in   [ sec : ext ] can serve as a basis for deriving algorithms for control systems such as multi - body locomotion systems or robotic vehicles with nonholonomic constraints .",
    "furthermore , the developed classes of systems can be unified through the recently developed groupoid framework  @xcite .",
    "each of the considered product spaces ( e.g. @xmath1 ) can be regarded as a single groupoid space with equations of motion resulting from a single generalized discrete variational principle .",
    "this will enable the automatic solution of optimal control problems for various complex systems and a convenient unified framework for implementing practical optimization schemes such as  @xcite .",
    "more importantly , this viewpoint can be used to apply standard discrete lagrangian regularity conditions ( e.g.  @xcite ) to optimal control problems evolving on the groupoid space .",
    "this would provide a deeper insight into the solvability of the resulting optimization schemes .",
    "[ ant ] ( see @xcite ) let @xmath428 , @xmath532 and @xmath533 denote the variation of a function @xmath67 with respect to its parameters . assuming @xmath534 is constant , the following identity holds @xmath535,\\ ] ] where @xmath536:{\\mathfrak{g}}\\times{\\mathfrak{g}}{\\rightarrow}{\\mathds{r}}$ ] denotes the lie bracket operating or equivalently @xmath537\\equiv{\\mbox{ad}}_{\\xi}\\eta$ ] , for given @xmath538 ."
  ],
  "abstract_text": [
    "<S> this paper develops numerical methods for optimal control of mechanical systems in the lagrangian setting . </S>",
    "<S> it extends the theory of discrete mechanics to enable the solutions of optimal control problems through the discretization of variational principles . </S>",
    "<S> the key point is to solve the optimal control problem as a variational integrator of a specially constructed higher - dimensional system . </S>",
    "<S> the developed framework applies to systems on tangent bundles , lie groups , underactuated and nonholonomic systems with symmetries , and can approximate either smooth or discontinuous control inputs . </S>",
    "<S> the resulting methods inherit the preservation properties of variational integrators and result in numerically robust and easily implementable algorithms . </S>",
    "<S> several theoretical and a practical examples , e.g. the control of an underwater vehicle , will illustrate the application of the proposed approach . </S>"
  ]
}