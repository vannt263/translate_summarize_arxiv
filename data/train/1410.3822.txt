{
  "article_text": [
    "stellar feedback is thought to be an important driver in shaping galaxy properties , but it is one of the most difficult effects to model in numerical simulations of galaxy formation .",
    "the channels for feedback from individual stars are generally well understood , but the spatial and mass resolutions typical of galaxy simulations require ` sub - grid ' modeling of these effects based on assumptions of how feedback energy couples to the interstellar medium ( ism ) . assumptions also have to be made about the number and type of feedback events generated by star particles in the calculation , which are usually massive , collisionless particles representing a well - sampled stellar population . models of this type are often tuned to reproduce certain galaxy properties , while treating other galaxy properties as simulation predictions ( e.g. * ? ? ?",
    "this difficulty has fundamental implications for the ability of numerical simulations to inform problems in galaxy formation in which stellar feedback is thought to play a crucial role .",
    "stellar feedback has been indicated as a potential solution to many outstanding problems in galaxy formation in the @xmath6cdm paradigm such as the inner density profiles of galaxies @xcite ; the low baryon fractions of galaxies @xcite ; and missing metals in galaxies @xcite .",
    "it is challenging to interpret simulation results on these questions and others when different sub - grid feedback prescriptions can produce different galaxy properties @xcite .",
    "one of the main challenges encountered in simulating stellar feedback in galaxy simulations is the efficient cooling of thermal feedback energy @xcite .",
    "this high efficiency results from the large masses contained in the individual gas resolution elements ( either particle or grid cell ) to which feedback energy is added .",
    "these large masses result in a lower specific heating rate and therefore a lower temperature . for thermal feedback energy to have a significant impact on gas dynamics , it needs to reach temperatures of @xmath7 k where radiative cooling is less effective and large pressure gradients will cause gas to move @xcite .",
    "one solution to this problem is to find some way to keep the temperature of feedback - heated gas elevated by restricting radiative cooling in star - forming regions ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "a different approach that also prevents large radiative losses is to delay the addition of feedback to the gas until enough energy has accumulated so that the resulting gas temperature is high enough that the radiative cooling time is long ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "another approach that can decrease radiative losses is to explicitly model a sub - grid multi - phase model @xcite .",
    "as an alternate to thermal feedback , a number of works have explored kinetic feedback by imparting momentum to particles , both in sph codes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and in amr codes ( with debris particles , * ? ? ?",
    "while most models have focused on supernovae feedback in either kinetic or thermal form , stars produce energy in other forms .",
    "for example @xcite and later @xcite directly modeled the momentum input of stellar radiation using approximate methods for radiative transfer .",
    "while radiative transfer schemes are typically computationally expensive , @xcite included this effect in a full ray - tracing code for low mass systems at high redshift .",
    "@xcite assumed that 10% of this ( uv ) radiation was thermalized and added it directly to the gas thermal energy .",
    "recent models have also explored the impact of adding feedback from cosmic rays ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) and local photoionizing sources @xcite .",
    "the physical motivations for these approaches vary depending on the resolution of the simulation and on the assumptions about the ism processes being simulated .    in the real ism ,",
    "the process of supernova feedback is mediated by the evolution of individual supernova remnants .",
    "the kinetic energy fraction in real supernova remnants never dips below 28% .",
    "initially , 100% of the energy is in kinetic form , during the free expansion phase of its evolution , when the material ejected from the progenitor moves ballistically outward .",
    "once the mass of swept - up ism becomes equal to the ejected mass and the reverse shock has re - heated the remnant interior , the remnant enters the sedov - taylor phase which is energy conserving due to the very long cooling time of the post - shock material . in this phase ,",
    "the kinetic energy fraction equilibrates to 28% .",
    "as the remnant expands further , cooling begins to have an effect and the remnant loses thermal energy , but the expansion continues to be driven by the interior pressure , in the pressure - driven snowplow phase .",
    "eventually , this pressure becomes negligible to the dynamics of the remnant and the expanding shell is carried outward by its own momentum in the momentum - conserving snowplow phase . during the two snowplow phases the overall energy of the remnant drops due to cooling , however ,",
    "since this energy is lost from the thermal component , the overall fraction of kinetic energy does not decrease .",
    "kinetic energy clearly plays an important role in this feedback channel .",
    "cosmological simulations of low mass galactic systems have recently begun to reach resolutions of order a few parsecs where this process may begin to be resolved @xcite .",
    "while increased resolution does appear to alleviate the overcooling problem to some degree , purely thermal feedback schemes still have problems reproducing some galaxy properties @xcite .",
    "high - resolution simulations of supernova remnants predict that , depending on ism conditions , remnants should still be in an energy conserving sedov - taylor phase on these scales @xcite in which approximately 28% of the supernova energy is in kinetic form .",
    "careful , one - dimensional studies of supernovae explosions have established that supernova remnants enter a phase of rapid cooling once the remnant reaches a radius of @xmath820 pc , depending on the energy of the explosion , the density of the media and the cooling model employed @xcite .",
    "recent three - dimensional simulations ( contemporaneous with the writing of this paper ) have explored the effect of resolved supernova explosions that include momentum injection in inhomogeneous media with the aim to better understand the properties of the turbulent ism @xcite .",
    "the goal of this paper is to present a new method for the direct addition of kinetic energy to gas simulated on a cartesian mesh and to explore the effect of direct kinetic energy injection with this method in a galactic context .",
    "an important consideration in applying this method is its resolution dependence .",
    "we explore this issue in detail in simulations of isolated explosions where we can control the background density and the fraction of injected kinetic energy .",
    "these idealized simulations are employed to motivate a resolution - dependent scaling for the injection of kinetic energy .",
    "this resolution - dependent scaling is applied to supernova feedback in simulations of a dwarf galaxy where we can explore the impact of our kinetic energy injection method in a more realistic galactic context .",
    "we apply the method to a feedback channel most like type - ii supernovae ; however , contributions from type ia supernovae and ` runaway ' ob stars likely play an important role , therefore the goal of these simulations is to isolate the impact of this method for energy injection in a simplified set - up .",
    "the outline of this paper is as follows . in section [ sec : kin_algorithm ]",
    "we describe the method for momentum injection as implemented in the adaptive mesh refinement ( amr ) code enzo .",
    "then , in section [ sec : idealized_tests ] , we describe a set of idealized tests of our model focusing first on its behavior at high resolution ( section [ sec : high_res_ref ] ) and second on the resolution dependence of its behavior ( section [ sec : res_study ] ) .",
    "we also describe a resolution - dependent scaling for the initial fraction of kinetic energy injected ( section [ sec : kinf_var ] ) . in section",
    "[ sec : galaxy_simulation ] we present a set of cosmological dwarf galaxy simulations utilizing the new model and explore how the injection of kinetic supernova feedback energy affects the star formation rate and metal enrichment in the simulations .",
    "finally , we place our model in context with other feedback models and discuss how to apply our results to future simulations ( section  [ sec : discussion ] ) .",
    "in this section , we describe a method for the injection of kinetic supernova energy on a cartesian mesh as implemented in the amr code enzo @xcite .",
    "the method we describe is quite general and could be expanded to non - cartesian grids .",
    "the idea is to isotropically add momentum in a distributed region based on the cloud - in - cell ( cic ) approach @xcite , such that the resulting kinetic and thermal energies are increased by a specified amount .",
    "it differs from previous supernova feedback methods implemented in enzo that inject purely thermal energy ( e.g. * ? ? ?",
    "* ) and from methods implemented in other amr codes that add an effective pressure term to euler s equations ( e.g. , * ? ? ?",
    "the method described here is scale independent in the sense that it describes an algorithm for momentum injection that relies on a feedback zone that is fixed in the number of resolution elements it contains , but not in the physical size of those elements .",
    "for example , this scheme could be adapted to a subgrid treatment for agn winds in simulations with coarse spatial resolutions of order a kiloparsec . in this paper , we focus on its use in simulating supernova feedback in galaxy simulations where the spatial resolution is typically no more than 10pc and where at the highest resolutions we consider ( @xmath9 1pc ) , the sedov - taylor blast region is resolved .",
    "therefore , rather than conceiving of the strength of the mechanical momentum as a wind speed as done in other treatments of supernova momentum @xcite , we consider the fraction of the supernova energy budget that goes into momentum as an input and the resulting wind speeds as a simulation output .",
    "the total supernova energy is defined to be a fraction ( @xmath10 ) of the rest mass energy of the star particle producing the feedback ( @xmath11 , where @xmath12 is the mass of the star particle and @xmath13 is the speed of light ) . in this model ,",
    "the fraction of the supernova energy that is initially injected as kinetic energy is a free parameter , @xmath14 , between zero and one .",
    "the kinetic and thermal energies after the supernovae are therefore    @xmath15    @xmath16    where @xmath17 and @xmath18 are the total thermal and kinetic energies of the feedback injection zone before the energy deposition .",
    "energy , momentum and mass are added to the grid on a cell by cell basis ; however , the momentum needs to be added in such a way that the correct amount of total kinetic energy is added , but the net ( vector ) momentum added is zero .",
    "we begin by computing the momentum field @xmath19 in the frame of the moving particle , where the particle velocity is @xmath20 and the velocity of grid cell @xmath21 is @xmath22 , so that @xmath23 , where @xmath24 is the mass of the cell .",
    "once the momentum - updating procedure described below has been completed , the momentum can be converted back to velocity in the original frame of the simulation grid .",
    "to add mass , momentum and thermal energy to the comoving grid , we adapt the well - known cic method @xcite . to remind readers , the cic method is a way of smoothly adding particle mass to a grid .",
    "conceptually , this is done by virtually converting the particle into a uniform ` cloud ' with a size equal to one cell width .",
    "since the particle position is generally not coincident with a cell center , this region will overlap 8 cells on the grid in three dimensions .",
    "the amount of mass added to each cell is proportional to the volume overlap of the virtual cloud with that cell .",
    "we adopt this same idea , but instead of using a region of size 1@xmath251@xmath251 cell widths , we use a 3@xmath253@xmath253 cell cloud centered on the star particle s position .",
    "the reason for this larger cloud is that momentum is a vector quantity and therefore momenta with opposite signs should not contribute to the same cell .",
    "the momentum vector direction for each virtual cloud cell is found by taking the vector from the center of the region to the center of that virtual cell . since",
    "the virtual cloud is of size @xmath26 , it will , in general , overlap @xmath27 cells in the underlying grid .",
    "figure  [ fig : cic ] demonstrates graphically how the cloud overlaps with the grid mesh for a two - dimensional example .",
    "the contribution of mass , thermal energy and metals is assumed to be uniformly distributed throughout the @xmath26 cloud , and the addition of these components is very similar to an expanded cic method .",
    "this method assumes that the underlying mesh overlapped by the cloud has a uniform resolution , i.e. the feedback stencil is never applied over refinement level boundaries , and it assumes that the resolution of the cloud is the same as the underlying mesh .",
    "the magnitude of each cell s momentum vector is found by enforcing the requirement that the total amount of kinetic energy added to the grid follows equation  ( [ eq : kinetic_energy ] ) . since this depends on the amount of momentum pre - existing on the grid , this step is non - trivial and we describe it in detail below .",
    "we note that the central cell contributes no momentum .",
    "the momentum ( @xmath28 ) , mass ( @xmath29 ) and thermal energy ( @xmath30 ) of each affected grid cell @xmath21 is updated in this way :    @xmath31    @xmath32    @xmath33    the amount of each gas quantity added to grid cell @xmath21 involves a sum over all of the virtual ` cloud ' cells of the feedback zone ( denoted with a subscript @xmath34 ) that overlap with grid cell @xmath21 .",
    "the quantity @xmath35 is the fractional volume of that overlap ( normalized such that @xmath36 ) .",
    "the quantity @xmath37 is the mass added in each virtual cloud cell @xmath34 , where @xmath38 is the total mass added and @xmath26 is the number of virtual cloud cells .",
    "the quantity @xmath39 is the thermal energy added to each virtual cloud cell , which is equal to the total amount of thermal energy injected in the feedback event divided by the number of virtual cloud cells such that @xmath40 .",
    "finally , the unit directional momentum vector of each cloud cell is given by @xmath41 .",
    "we now describe how to determine the magnitude of the additional momentum @xmath42 for each of the @xmath43 virtual cells ( the central cell has zero momentum )",
    ". the magnitude of each of the vectors must be the same to keep the total net momentum zero .",
    "the total kinetic energy of the gas surrounding the star particle is a sum over all the affected cells ( cells in the grid are denoted with a subscript @xmath21 ) : @xmath44    because @xmath42 is a constant and can be pulled out of the above sum , equation ( [ eq : thermal_energy_after ] ) combined with equation  ( [ eq : kinetic_energy ] ) is a quadratic for @xmath42 , which we can therefore solve : @xmath45 where @xmath46 @xmath47 @xmath48 and the total kinetic energy of the gas in the supernova affected region before the blast is given by : @xmath49    equations ( [ eq : deltap ] ) through ( [ eq : thermal_energy_before ] ) provide a complete solution for @xmath42 .",
    "the quadratic , of course , has a second solution , however , the physical context of the problem requires @xmath42 to be a positive value and that in turn requires the solution we have chosen since in general @xmath50 .",
    "note that , given the amount of energy and mass to be injected , the scheme has a single free parameter : @xmath51 .",
    "to better understand the effect of the kinetic feedback model in galaxy simulations such as the ones that will be discussed in section [ sec : galaxy_simulation ] and also to test the implementation , we have conducted a set of idealized test simulations in gas with uniform density .",
    "as we have discussed , the new method introduces a tunable parameter @xmath14 , the fraction of injected kinetic energy .",
    "our goal is to understand the behavior of the model given a choice of @xmath14 over a wide range conditions typically found in the galaxy simulations for which it is intended .",
    "idealized tests of the new model were done by placing a single star particle within a box with uniform gas density and thermal energy , and no initial bulk motion .",
    "the star particle injects thermal energy , kinetic energy , mass and metals within a single time step into a volume equivalent in size to a @xmath26 cell cloud centered around the star particle as described in section [ sec : kin_algorithm ] .",
    "the star particle is chosen to have a mass of 100 m@xmath2  and to inject @xmath52 ergs of total energy into the surrounding gas . the amount of mass released is fixed to be 25 m@xmath2  and the metal yield is chosen to be 2% of the star particle s mass .",
    "the values are consistent with the cosmological simulations described in the next section .",
    "the initial gas temperature is set to 100 k. the particle is placed offset from the box center by half a cell width .",
    "these test simulations were conducted on a uniform , static mesh with a constant cell width in the range of 0.5 pc to 8 pc .",
    "we test background densities between 0.5 and 500 @xmath4 .",
    "the test simulations include non - equilibrium cooling from six atomic species of hydrogen and helium @xcite in addition to equilibrium metal line cooling dependent on gas density , temperature , electron density and metallicity as interpolated from tables generated by cloudy @xcite .",
    "the background medium is initially neutral and composed of 75% hydrogen and 25% helium by mass .",
    "the background gas metallicity is set to be 0.1 z@xmath2  in most test simulations , but we will explore the effect of a different background gas metallicity in some tests .",
    "runs are conducted with both the ppm and the zeus hydrodynamical solvers .",
    "ppm is a piecewise - parabolic method for solving euler s equations @xcite and zeus is a simple second - order finite difference method @xcite .",
    "zeus has the advantage of being more computationally robust than ppm , but it is less accurate and not energy conserving . to improve stability in simulations conducted with ppm , we employ the dual energy formalism to maintain consistency between kinetic energy advected by the energy conservation equation and the momentum conservation equation @xcite .",
    "the width of the simulation box is fixed to be three times the analytic sedov - taylor blast radius , @xmath53 , at the final time of the simulation ( typically 1 myr ) with a minimum box width of 50 cells @xcite . for a background density of 1 @xmath4 , a supernova energy of @xmath52 ergs and final time of 1 myr , this gives a box size of 237 pc .    for these tests , we choose to inject all the energy in a single time step . enzo computes time steps from the courant condition based on the state of the gas at the start of the time step .",
    "this estimation for our idealized tests , where there are no initial gas velocities , will give an initial time step much too long to account for the large velocities that are induced in the first time step by the injection of feedback energy .",
    "an estimate of a shorter time step is necessary to ensure that the bulk flow of gas across the grid in the first time step can not cross more than one cell width .",
    "the initial timestep , in which all energy is injected , is fixed to be @xmath54 where @xmath55 is the diameter of a single grid cell , @xmath56 is the estimated sound speed of gas in the post feedback injection region and @xmath57 is the estimated initial speed of the shock : @xmath58    @xmath59    and    @xmath60    where @xmath61 ; @xmath62 is initial background density ; and @xmath63 is the fraction of star particle mass that is removed from the particle and deposited in the mesh ( i.e. @xmath64 ) .",
    "we first explore how the model behaves at high resolution , when all length scales are resolved .",
    "the high resolution tests presented here are done with a fixed cell width of @xmath55 = 0.5 pc , which is sufficient to resolve the sedov - taylor and ( in tests with cooling ) the snow - plow phases of supernova remnant evolution with the chosen density .",
    "these high resolution tests are conducted with ppm , which is the more accurate of the two hydrodynamic solvers we consider in this study .",
    "these models will provide context for understanding test models at coarser resolution .",
    "figures [ fig : slices ] and [ fig : profiles ] show the behavior of a typical high - resolution test in the presence of cooling .",
    "the model produces a shock that propagates outward from the star particle .",
    "this shock sweeps up material into a dense shell .",
    "the spherically averaged profile shows the shell over density with respect to the background to be approximately 2 after 1 myr . this is less than the overdensity of 4 predicted for a strong shock , in part because of the spherical averaging , but also because the resolution is only marginal to resolve the very narrow shock feature @xcite . as we will see , the total mass in the swept - up shell matches analytic theory .    in high - resolution tests with no cooling , a well - behaved",
    ", spherical shock is produced . in tests with cooling , the shock produced has some degree of asymmetry , the character of which is dependent on the kinetic injection fraction .",
    "in tests with low kinetic injection fractions the asymmetry is dominated by ( physical ) shell instabilities . in tests with high kinetic injection fractions ( @xmath65 ) , it is dominated by the discretization of the kinetic energy injection . as we will discuss , kinetic fractions of interest for our applications are those less than 30% , but this limitation should be kept in mind for other applications .",
    "we track the evolution of several quantities in each test simulation .",
    "the shell position is defined as being the radius at which the radial density profile peaks ( note that the true shock radius should be slightly greater than this quantity , but this is a good proxy ) .",
    "the shell temperature is defined as the spherical density - weighted average temperature of the gas at the shell radius , also shown in figure [ fig : profiles ] .",
    "the total energy excess in each test simulation is defined as the total energy of the box , both thermal and kinetic , less the energy of the unperturbed background medium , which is entirely thermal .",
    "we define the thermal and kinetic energy excesses in the same way .",
    "the shell mass is defined to be the total mass of gas within the supernova remnant that has an over density relative to the background density greater that 1.1 .",
    "these quantities are calculated at each time step utilizing the simulation analysis code yt @xcite , which was run inline with each enzo test simulation .",
    "figure [ fig : idealized_nocool ] shows the evolution of these quantities for an adiabatic case .",
    "we note that a small amount of excess energy is artificially introduced into these runs by the dual energy formalism used with ppm .",
    "this numerical error is small , on the order of a few percent , and more pronounced in simulations with larger initial kinetic energy fractions .",
    "the origin of this energy is a small over - correction for the negative thermal energies created by numerical errors in the advection of momentum in the first time step .    in the absence of cooling ,",
    "our test simulations reproduce the analytic sedov - taylor solution for supernova remnants almost exactly , where the radius of the shell expands as @xmath66 , regardless of the initial fraction of kinetic energy .",
    "the main deviations from the sedov - taylor solution can be seen early in the simulations and appear to roughly approximate the evolution during the free expansion phase that precedes the sedov - taylor phase .",
    "this transition is predicted to occur when the mass of the ism swept - up by the expanding shock becomes equal to the mass ejected by the star . in our simulations ,",
    "once the shell mass reaches roughly 50 m@xmath2 , which is twice the ejection mass , there is an abrupt jump in the shell mass above 100 m@xmath2 , and all quantities appear to begin to asymptote to the analytic sedov - taylor solution .",
    "the final fraction of kinetic energy found is 25% , close to the value of 28% found by integrating the sedov - taylor prediction for the radial profile of energy and close to the values of roughly 30% found in other numerical models of supernova remnants @xcite .",
    "figure [ fig : idealized_wcool ] presents the evolution of the kinetic feedback model in the presence of cooling .",
    "simulated at high resolution , we see that it takes less than @xmath67 years before cooling causes deviations from the analytic sedov - taylor solution and the remnant enters the snow - plow phase .",
    "the shell radius is approximately 6 pc when this happens .",
    "as cooling becomes more and more effective , the temperature of the shell declines sharply and reaches a plateau of @xmath67 k at 0.01 myr that lasts until 0.2 myr . throughout this phase ,",
    "the energy drops precipitously due to the rapid cooling of thermal energy .",
    "therefore , after 0.01 myr most of the energy remaining in the volume is in kinetic form . at this point , the decline of the kinetic energy has a power - law slope consistent with the analytically derived value of -3/4 for the momentum - conserving snowplow phase .",
    "note that , prior to the momentum - conserving snowplow phase , the remnant should go through an adiabatic pressure - driven snowplow phase that has a very similar power - law slope of -4/7 ; however , in practice that is difficult to distinguish from the slope of the momentum - conserving snowplow .",
    "we run these test for 1 myr at which time the shell has a radius of almost 20 pc .        the physical relevance of the late time evolution of these tests shell should be considered in the context of a more realistic external medium .",
    "the thin shell is moving at velocities less than the turbulent velocities found in more realistic , inhomogeneous media that are typically of the order of @xmath0 km s@xmath68 .",
    "the goal of these high - resolution tests , however , is simply to provide context for the resolution study that will be presented in section [ sec : res_study ] .    in these high resolution tests ,",
    "the evolution of gross properties of the supernova remnant is entirely insensitive to the initial fraction of kinetic energy . in cases both with cooling and without cooling ,",
    "it takes less than a thousand years for simulations with different initial kinetic fractions to equilibrate to the sedov - taylor solution . after this equilibration period , all simulations",
    "behave very similarly , with the exception of some very small differences seen at late time in models with cooling , but these differences are seen well after the simulations have ceased to be physically relevant due to our assumption of a uniform background medium . the next section will explore how this behavior changes at coarser resolutions , with different background densities and with different numerical solvers .      we have explored the behavior of our model at a relatively high resolution and in high density gas , similar to the density threshold for star formation in our galaxy models .",
    "now we will examine the effect of changing background density and resolution .",
    "figure [ fig : multires_multiden ] presents the evolution of our idealized feedback simulations with two different background densities ( 0.49 and 49 @xmath4 ) at a range of spatial resolutions . for each background density and resolution ,",
    "we have tested eleven different kinetic injection fractions , varying uniformly from 0.0 to 1.0 .",
    "first , it is apparent that at the lowest background density , these test simulations behave very similarly , regardless of the kinetic injection fraction or resolution .",
    "all of the low density tests , even the most coarsely resolved , with a cell width of 8 pc , reach a rough approximation to the sedov - taylor phase , as indicated by the evolution of the shell temperature .",
    "this brings their later evolution and final state in line with the highest resolution simulations at this density .    at higher densities ,",
    "this uniform behavior between simulations of different kinetic injection fraction and resolution breaks down .",
    "as we have discussed , at very high resolution ( @xmath69 pc ) for our adopted range of densities , the kinetic injection fraction makes little difference to late time evolution .",
    "this largely holds for simulations with the next two finer resolutions ( @xmath70 pc and 2.0 pc ) .",
    "however , in the two most coarsely resolved sets of simulations where @xmath71 pc and 8 pc , simulations with different kinetic injection fractions end with very different total energies .",
    "how can we understand these transitions in behavior ? simulations that converge to similar behavior regardless of kinetic injection fraction all pass through a well - defined sedov - taylor phase , which , in turn , is primarily determined by the temperature to which cells are heated , as high temperature gas ( @xmath72 k ) has a long cooling time .",
    "this temperature is determined by the specific heating rate of the gas in the injection time step , which depends on two factors : ( i ) the mass of the cell being heated and ( ii ) , the amount of thermal energy injected . at a fixed density , the cell mass depends on resolution and the amount of thermal energy injected depends on @xmath14 .",
    "therefore , in low - density media , cells can easily reach high temperatures because they have small masses and the specific heating rate is high ; at high - densities , however , only tests with resolutions @xmath73 2 pc per cell have sufficiently small cell masses to reach this state . in the high - density case",
    ", an increased temperature jump can be achieved by injecting a larger fraction of thermal energy , but this effect appears to be small ( except when considering the purely kinetic case ) and can not compensate for the lower resolution .",
    "a somewhat distinct second effect also contributes to attaining the sedov - taylor phase .",
    "the amount of energy that is injected in kinetic form places an upper limit on the total amount of energy that can be lost in the first time step since only thermal energy can be radiated away ( directly ) . in our model , where the total energy budget is fixed , this goes hand in hand with the long cooling time of high - temperature gas , since the larger the amount of energy locked up in kinetic form , the smaller the increase in the gas temperature .                  to better understand these effects , figure  [ fig : time_scales_ppm ] presents characteristic timescales in our test simulations that demonstrate how resolution and radiative cooling interplay with attaining the sedov - taylor phase .",
    "three timescales are considered , related to three evolutionary stages .",
    "the first is a purely numerical stage , during which the blast wave is still localized in the initial feedback injection site , and its evolution is dominated by the discretization of the underlying grid . before the heated region can reach a regime dominated by physical processes rather than numerical ones , the remnant must clear this resolution - dominated region .",
    "we estimate the timescale of this phase to be the time it takes the blast radius to reach three times the radius of the energy injection region , or equivalently , the time at which the shell radius reaches @xmath74 .",
    "this resolution timescale @xmath75 can be determined from the evolution of the shell radius , which we track in each test simulation .",
    "the second timescale to consider is the time at which the behavior of the remnant begins to approximate the evolution of the analytic sedov - taylor solution .",
    "physically , the transition from the free - expansion phase to the sedov - taylor phase occurs when the mass swept - up by the expanding shock is approximately equal to the mass ejected by the star . at this point",
    ", it is not the initial momentum of the ejecta that is driving expansion , but rather it is the force from the internal thermal pressure of the remnant .",
    "we have chosen to let star particles eject 25 m@xmath2  into the ism , however as we have discussed , the initial evolution is dominated by numerical effects of the local grid .",
    "this local grid contains mass and it would be more appropriate in our context to consider a numerical ejection mass equal to the ejection mass plus the mass of ism in the initial feedback zone of @xmath26 cells .",
    "we therefore define the sedov - taylor equilibrium timescale to be the time @xmath76 when the swept - up mass is equal to twice this numerical ejection mass .",
    "we can estimate the mass of swept - up ism from the shock radius and the background density .",
    "the third relevant timescale is the time at which the remnant starts to cool radiatively , and enters the snow - plow phase .",
    "following @xcite we define this timescale ( @xmath77 ) to be the time at which the energy of the remnant has dropped by one third of its original value .",
    "note that this typically happens well before the shock temperature reaches the cooling floor , and therefore it is not dependent on our choice of cooling floor .        from figure",
    "[ fig : time_scales_ppm ] , we see that @xmath75 rises with increasing cell width @xmath55 , and the steepness of this rise increases with increasing background density .",
    "simulations with low kinetic injection fractions also have slightly longer resolution timescales .",
    "these trends can be explained by the expectation that simulations with larger cells and simulations where the supernova ejecta have lower initial velocities will take longer to expand beyond the resolution dominated region .    at the lowest density ( @xmath78 @xmath4 ) , @xmath76 and @xmath77",
    "are constant over @xmath55 and @xmath77 remains greater than @xmath75 for all except the very largest @xmath55 .",
    "in this regime , the supernova remnant equilibrates to the sedov - taylor solution before energy losses due to cooling become significant .",
    "at the two next higher densities ( @xmath79 @xmath4 and 49.0 @xmath4 ) , @xmath75 becomes significantly greater than @xmath77 at coarser resolutions .",
    "this means that the supernova remnant has not yet cleared the resolution dominated region before energy losses due to cooling become significant .",
    "the result is that the snow - plow time becomes much more dependent on the kinetic injection fraction .",
    "simulations with higher kinetic injection fractions have significantly larger @xmath77 when @xmath75 is much greater than @xmath77 .",
    "this is because the conversion of kinetic to thermal energy in the expanding shock is impeded when @xmath75 is long , and so with more energy locked up in kinetic form , less thermal energy is available to be dissipated and the time it takes for total energy to drop significantly is much longer .    at the very highest density probed ( @xmath80 @xmath4 ) , @xmath75 is longer than @xmath77 at all resolutions tested . in this regime , the sedov - taylor phase and the snow - plow phase can not be well separated .",
    "the snow - plow timescale and the sedov - taylor equilibrium timescale happen at the same time because the conversion between thermal and kinetic energies is so inefficient when @xmath75 is long that the remnant can not equilibrate before cooling begins to take over .",
    "the increase of @xmath77 with increasing @xmath55 is apparent at the two highest background densities . from figure",
    "[ fig : multires_multiden ] , this trend is likely due to the low initial temperatures reached by heated gas . in these test simulations the specific heating rate is low at low resolution , resulting in lower cooling rates and a longer @xmath77 .",
    "the result of this blending of numerically dependent and physically dependent evolutionary timescales is that the total amount of energy and momentum retained in the gas becomes dependent on the kinetic injection fraction in a resolution dependent way .",
    "figure [ fig : final_efrac ] shows this effect . in a low density medium , the amount of energy retained in the gas after 0.1 myr changes little with resolution and kinetic injection fraction . moving to higher density media ,",
    "the amount of energy retained at coarser resolution begins to vary with the kinetic injection fraction , where models with higher kinetic injection fractions lose less energy . in models with background densities of 49 and 490 @xmath4 ,",
    "purely thermal models lose an order of magnitude more energy than models with some injection of kinetic energy .",
    "models that have very high kinetic injection fractions retain too much total energy .",
    "secondary effects can change these trends by modifying the rate of dissipation of thermal energy . in tests with purely thermal energy injection",
    ", these effects can potentially be quite significant and cause a greater under or overestimate of the retained energy at late times .",
    "as an example , consider the effect of increasing the background metallicity . at high resolution ,",
    "test runs with a higher background metallicity and different kinetic injection fractions converge in much the same way as they do for tests at lower background metallicity , although at an overall lower energy and temperature . in figure",
    "[ fig : final_efrac ] , we see that the purely thermal case underestimates the amount of energy remaining in the gas at 0.1 myr by nearly 84% with 4 pc resolution ( where the background density is 50 @xmath4  and metallicity is 0.1 z@xmath2 ) .",
    "we found that in similar test simulations with a higher background metallicity of 1 z@xmath2 , the purely thermal case undershoots the total energy at 0.1 myr by nearly 95% .    in the case of higher metallicity ,",
    "the cause of enhanced energy loss has its origin in the physical model employed for the cooling that is then magnified by numerical effects .",
    "it can also be the case that purely numerical effects can produce differences .",
    "figure [ fig : zeus_comp ] compares tests run with the ppm hydrodynamical solver , which has been used for all the test simulations up to this point , to tests run with the zeus hydrodynamical solver .",
    "the physical model in these two sets of test cases are identical ; the differences seen between simulations with the same kinetic injection fraction are due to numerical effects .",
    "we can see that at high resolution the differences between the ppm and zeus solvers are small . at coarse resolution , there is a divergence in behavior with the kinetic injection fraction @xmath14 .",
    "tests with some injection of kinetic energy , even as little as 10% , end up with the nearly the same amount of thermal energy at late times ; however , it should be noted that at earlier times there are differences .",
    "the greatest difference , again , can be seen in the purely thermal case , where tests run with both solvers underestimate the higher resolution result , but the ppm model does so by a greater degree .",
    "the differences between these two solvers likely have their origin in the competing effects of imperfect energy conservation and increased diffusivity .      .",
    "all tests are compared to a high resolution test ( @xmath81 pc ) conducted with the ppm solver and @xmath82 ( black ) .",
    "lower resolution tests were conducted with ppm ( dash - dot lines ) and zeus ( dashed lines ) .",
    "the top panel shows the energy excess in the simulation volume and the bottom panel shows the shell radius .",
    "the background density for this test is 49 @xmath4 .",
    "the resolutions tested are indicated in parsecs along with corresponding kinetic injection fractions . ]    [ cols=\"<,^,^,^,^,^,^,^,^ \" , ]     note : the quantities presented in each column are ( 1 ) the constant kinetic injection fraction ( if applicable ) , ( 2 ) the total mass within @xmath83 , ( 3 ) the total stellar mass within @xmath83 , ( 4 ) @xmath83 , the radius within which the mean halo density is 200 times the critical density of the universe , ( 5 ) the radius enclosing half the stellar mass , ( 6 ) the total mass within @xmath84 , ( 7 ) the mass - weighted mean of the star particle metallicities and ( 8) the standard deviation of log(z / z@xmath2 ) .",
    "simulation r10-kinf-0 was only run to a redshift of 0.92 and r10-var was run to redshift 1.14 ; therefore , the quantities presented here are for the target halo at this redshift .    1",
    "simulation r10-kinf - var is in the process of a luminous merger at its final redshift that makes a meaningful half - light radius difficult to compute .",
    "we have shown how energetic losses depend on resolution with our implementation of kinetic feedback . in this section , we present an analytically - motivated , but simulation - verified , scaling for @xmath85 as a function of resolution and local density . rather than doing this directly from the numerical tests present in section  [ sec : res_study ] ( because their precision is limited by secondary effects ) , we develop an analytical model and then demonstrate that it matches our test simulations .    the scaling we adopt is based on a comparison between the shock radius at the transition point to the pressure - driven snowplow phase ( @xmath86 ) , and the resolution of the grid ( @xmath55 ) . in section  [ sec : evo_timescale ] , we defined the timescale @xmath75 as the point when the shell radius was @xmath87 and argued that this represented a purely numerical resolution timescale for the system .",
    "the @xmath14-dependent furcation of energetic losses occurs when the timescale for significant energetic losses exceeded @xmath75 .",
    "we therefore propose the following procedure . in gas where @xmath88 , we consider the sedov - taylor regime to be well resolved and choose @xmath82 .",
    "conversely , in gas where @xmath89 , we estimate @xmath90 to be the ratio of the kinetic energy in the system at the point in the snowplow phase when the shock radius equals @xmath91 to the total amount of energy produced by the system .",
    "we note that in cases where @xmath92 radiative cooling will have resulted in the significant loss of thermal energy .",
    "we choose not to account for this loss and instead demonstrate that in the low - resolution regime where this is important , early rapid cooling quickly compensates for this .",
    "the kinetic injection fraction we therefore adopt is    @xmath93    where @xmath94 is the mean molecular weight of the surrounding gas ; @xmath95 is the density of the surrounding medium in units of @xmath4 ; @xmath96 is the time of the transition of between the sedov - taylor phase and the pressure - driven snowplow phase normalized by @xmath97 years ; @xmath86 is the radius of the shock at @xmath96 in pc ; @xmath55 is the cell width in pc ; and @xmath98 supernova energy normalized by @xmath52 ergs .    with an assumption for the cooling rate ,",
    "it is possible to estimate the time and radius at the transition between the energy - conserving sedov - taylor phase and the pressure - driven snowplow phase . here ,",
    "we follow @xcite who assumed a power law cooling function when dominated by metal cooling , and bremsstrahlung cooling for very low metallicity free gas . @xcite estimate the transition time between the sedov - taylor phase and the pressure - drive snowplow phase as the time of the temperature ` sag ' as defined by @xcite .",
    "we adopt a transition time when radiative cooling begins to dominate the dynamics of the system , which happens some time after the temperature ` sag ' and is also described by @xcite .",
    "@xcite find a break in the evolution of of supernova remnants with metallicities below 0.01 z@xmath2 .",
    "therefore we adopt the result for a metal dominated cooling curve for metallicities above 0.01 z@xmath2  and the result for the bremsstrahlung dominated cooling curve for metallicities below 0.01 z@xmath2 :    @xmath99    @xmath100    in this form , @xmath96 is normalized by @xmath97 years , @xmath86 is in units of parsecs , z is the gas metallicity in solar units and @xmath95 and @xmath98 are defined as before .",
    "figure [ fig : kinf_var ] shows an example of this approach applied to the same test problem at a variety of resolutions and demonstrates how it compares to the high - resolution case .",
    "all of the tests presented show cases where we do not consider the sedov - taylor phase to be resolved , however , the criterion we adopt for this determination is generous enough that in some cases , significant energetic losses have yet to occur . in these cases , the high - resolution behavior is , unsurprisingly , reproduced well . at the other extreme , there are cases where very significant energetic losses have taken place in the high - resolution model by the time the coarse resolution model has begun . in these cases ,",
    "the total energy is overestimated in the first time step , however , significant cooling by the second time step quickly corrects this and the overestimate of the shell radius is of order the cell width .",
    "an intermediate case , where the resolution is such that energetic losses are just on the verge of becoming significant provides perhaps the most problematic case , where cooling causes the energy to drop much more quickly than in the high - resolution case , and therefore convergence to the high - resolution case is delayed .",
    "still , we conclude that our analytic model for @xmath51 provides a reasonable approximation to the high - resolution results .",
    "idealized tests are useful for understanding the essential scaling ; however , more realistic tests are necessary to see how the method works in practice . in this section ,",
    "we apply our method to a cosmological zoom - in simulation of a low - mass galaxy .",
    "we carry out runs with several different kinetic injection fractions in the range of those that yield reasonable final energy fractions in our idealized tests with similar background densities and cell resolutions .",
    "in addition , we carry out runs with the analytic resolution - dependent scheme for kinetic energy injection that we developed in the previous section .",
    "we model a low - mass dwarf system in a cosmological zoom - in simulation as described in @xcite .",
    "the simulated halo has a mass within @xmath83 of @xmath101 m@xmath2  at @xmath102 and is situated in an isolated environment within a cosmological box 4 h@xmath68mpc across ( * ? ? ?",
    "* @xmath103 , @xmath104 , @xmath105 and @xmath106 ) .",
    "high - resolution dark matter particles have a mass of @xmath107 m@xmath2 .",
    "adaptive mesh refinement ( amr ) of the cartesian mesh ( on which the hydrodynamical calculation is done ) is allowed down a total of 12 levels from the root grid , giving a minimum allowed cell width of 10.8 comoving pc . in a subset of simulations",
    ", we restrict the maximum number of amr levels to 10 and 8 , correspond to minimum cell widths of 43.2 and 173 pc respectively .",
    "the purpose of these simulations is to explore the effect of limiting the resolution in the hydrodynamic calculation while utilizing the resolution dependent scaling for the kinetic injection fraction described in section [ sec : kinf_var ] .",
    "amr is restricted to cells containing high - resolution dark matter particles that are pre - selected from a dark - matter only simulation of the refined initial conditions and were found to end the simulation within @xmath108 of the final halo .",
    "a range of baryonic physics is included in these simulations : equilibrium metal line cooling @xcite ; non - equilibrium formation and cooling from nine atomic and molecular species @xcite ; a metagalactic photoionizing and photodissociating background @xcite ; a simple , single - cell self - shielding prescription @xcite , and a star formation algorithm that creates star particles with a maximum mass of 100 m@xmath2  based on local cell properties such as gas density , cooling time , dynamical time and divergence @xcite .",
    "complete details of these implementations can be found in @xcite ; the models presented here are identical to the model r10 from that study , except that the single - cell thermal feedback prescription has been replaced with the new prescription described here .",
    "we test both constant kinetic injection fractions ( between 0.3 and 0.01 , listed in table [ tab ] ) and a resolution - varying kinetic injection fraction , described in section [ sec : kinf_var ] .",
    "the new feedback model allows for the injection of energy on short timescales , which was challenging with the feedback model used by @xcite because of the large energy gradient created by the single - cell energy injection . in the example simulations described here , we choose to inject all the energy , mass and metals produced by supernova feedback in a single time step .",
    "we also choose to inject the supernova energy promptly , immediately after the creation of the star particle , mimicking type ii supernovae ( and stellar winds ) , but neglecting the significant contributions from type ia supernovae , which can be delayed from the epoch of their progenitor s creation by as much as a gyr .    as in r10 ,",
    "star particles return 25% of their mass to the ism during feedback .",
    "they also return metals to the ism during feedback ; the supernova metal yield is assumed to be 2% .",
    "all metals produced by star particles contribute to a single mean metallicity field .",
    "the total amount of specific supernova energy produced by each star particle is fixed to be the same as in simulation r10 .",
    "this value is chosen such that 150 m@xmath2  of star particles inject @xmath52 ergs of energy into the ism .",
    "for a well - sampled imf , the energy ( and mass return ) from star particles depends on the choice of imf and assumptions about stellar evolution , however , our star particle mass is too low to be considered a well sampled stellar population ; therefore , our choice of energy return is chosen to simply to be consistent with a range of values determined by other works ( e.g. * ? ? ? * ; * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "the aspect of the energetic supernova feedback that differs in these new simulations from those presented in @xcite is the fraction of energy that takes an initially kinetic rather than thermal form .",
    "this value is a free parameter , @xmath14 , that we will modify and test .",
    "a few adjustments not detailed in section [ sec : kin_algorithm ] were required for the galaxy application of the kinetic feedback model .",
    "enzo partitions the simulation domain into simply connected regions with uniform resolution that are called ` grids . '",
    "enzo solves euler s equations on these grids separately as a strategy for distributing the required calculations across many processors working in parallel . during the evolution of a single time step on the coarsest level of refinement , called the root grid ,",
    "spatially contiguous grids do not communicate with one another .",
    "therefore , star particles whose feedback zones straddle grid boundaries can not properly deposit their energy , mass and metals into the gas .",
    "a solution to this issue is in progress within the enzo development community , but for the current runs , we have simply shifted the feedback zones away from grid boundaries as needed in order to fit entire feedback zones onto their host grids .",
    "the shift is typically only one cell in a given direction , which is one third the width of the feedback zone .",
    "another adjustment is to do with the time step . in the idealized tests described in section  [ sec : idealized_tests ] ,",
    "the time step of the grid is adjusted in anticipation of the energetic feedback . in the galaxy simulations",
    ", gas will have a non - zero bulk velocity due to the gravitational forces present in the calculation .",
    "however , due to the small gravitational potential of the forming dwarf galaxy , a courant limited time step that accounts for the sound speed and bulk velocity of gas often exceeds @xmath96 , the timescale for the transition between the sedov - taylor and pressure - driven snowplow phases of supernova evolution ( see equation [ eq : tpds ] ) . therefore , in our simulation with a resolution dependent kinetic energy injection scheme , we have conducted a test ( r10-kinf - var - dtlim ) where the time step of grids containing newly - formed star particles are limited to be one - tenth of @xmath96 at the threshold density for star formation in solar metallicity gas . since the density threshold for star formation used varies with redshift , this limiting timestep is redshift dependent :    @xmath109}.\\ ] ]    we will explore the effect of this time step constraint in section [ sec : dtlim ] .      .",
    "simulations r10-kin-0 ( top ) and r10-kinf - var ( bottom ) were stopped close to @xmath110 ( see table [ tab ] ) .",
    "their final redshift is indicated by vertical dashed lines .",
    "for these two simulations , the global star formation rate is shown ( dotted lines ) in addition to the star formation rate of the final , main halo . ]",
    "star formation in galaxy simulations with the new feedback model exhibits many similarities and some key differences relative to each other and to r10 from @xcite .",
    "table [ tab ] summarizes some of the properties of the final halos produced in these simulations .",
    "figure [ fig : sfr_comp ] shows the star formation rate in all the galaxy simulations presented here .",
    "all begin by forming stars around @xmath111 , when molecular hydrogen cooling in these primordial gas halos becomes effective ( see @xcite for more details ) .",
    "the star formation rates in the runs without momentum input ( r10 and r10-kinf-0 ) steadily rise until reionization , when they begin to decline .",
    "star formation in r10-kinf-0 continues to late times at a reduced rate from its pre - reionization peak .",
    "however , runs with momentum input , both constant and time varying , behave very differently : once the star formation rate rises to a value of approximately @xmath112 m@xmath2yr@xmath68 it plateaus and remains constant until reionization .",
    "post - reionization , the star formation rate quickly drops to zero in almost all cases with ( the exception being r10-kinf - var , which we will discuss in section [ sec : dtlim ] ) .",
    "this stark difference in the star formation rate can be explained by the evolution of dense gas within halos as shown in figure  [ fig : rhomax_comp ] . in the runs which lack momentum input ( e.g. r10 ) ,",
    "the maximum gas density in the main halo continues to rise significantly above the star - formation density threshold after the onset of star formation and feedback . in simulations with some amount of kinetic energy injection",
    ", however , the maximum gas density in these halos appears to hew closely to the density threshold for star formation chosen in our models or to fall far below it .",
    "this trend indicates that supernova feedback closely regulates star formation in this model , i.e. once gas becomes dense enough to form stars , the momentum feedback produced is able to prevent further collapse and thereby maintains the density of gas at the star - forming threshold .",
    "we also see that there is some difference between the fast ( r10-kinf-0 ) and slow ( r10 ) injection of thermal energy : the slow injection of thermal energy in r10 appears to be effective in destroying self - shielded clumps of dense gas after reionization , unlike the quick injection of thermal energy in r10-kinf-0 , where dense clumps survive to late times and continue to form stars .    if we look at the total amount of gas at or above the star formation density threshold , also shown in figure [ fig : rhomax_comp ] , we find that r10 and r10-kinf-0.1 have comparable amounts , and in fact r10-kinf-0.1 maintains somewhat more mass at the density threshold for a longer time ( but , as shown in the top panel of figure [ fig : rhomax_comp ] , not much above this threshold ) . despite this , the overall efficiency of star formation is significantly lower in r10-kinf-0.1 . the self - regulating behavior of the kinetic feedback results in a larger reservoir of dense gas during the halo s star - forming epoch in r10-kinf-0.1 , while in r10 with its purely thermal feedback",
    ", this excess of dense gas will cool to densities above the star forming threshold and be converted to star particles .",
    "we note that the self - regulating behavior in r10-kinf-0.3 ( and the other momentum - based feedback runs ) has the result that the calculation does not reach the very highest levels of resolution allowed in the simulation because the refinement of the cartesian mesh on the highest levels is primarily triggered by gas density , which is suppressed . in all three simulations ,",
    "the first star particles form at @xmath113 on amr level 9 , where the resolution is less than 8 physical pc . in r10 and r10-kinf-0",
    ", the amr hierarchy quickly reaches the maximum allowed level of amr ( level 12 , which has eight times better spatial resolution ) .",
    "however , in r10-kinf-0.3 , the amr hierarchy does not descend below level 10 , which has a physical resolution of 8.6 pc at redshift 4 .",
    "simulations r10-kinf - var and r10-kinf - var - dtlim use the variable kinetic injection fraction scaling described in section [ sec : kinf_var ] .",
    "these runs attempt to adjust the amount of kinetic energy injected based on the physical resolution of the grid .",
    "the result of this approach is a slightly elevated star formation history , however , the self - regulation of gas density appears to be similar to the constant @xmath14 runs . despite this elevated star formation rate ,",
    "the amount of dense gas in simulation r10-kinf - var - dtlim during the star - forming epoch is smaller than in for example r10-kinf-0.1 , a simulation with a constant fraction of kinetic energy .",
    "it appears that the effect of piling up gas just below the star formation density threshold , as happens in r10-kinf-0.1 , in which the momentum in supernova affected gas is likely overestimated , does not occur , or does not occur to the same degree .",
    "we found that adjusting the timestep resolution with this scheme also impacted the star formation history , which we discuss in section [ sec : dtlim ] .",
    "the effect of different supernova feedback models manifests itself on larger scales as well .",
    "figures [ fig : kinf0_image ] and [ fig : kinf0.3_image ] show the environment around the population of star forming progenitor halos of the target halo just prior to the onset of reionization at @xmath114 .",
    "the global star formation rate in r10-kinf-0.3 is over an order of magnitude lower than it is in r10-kinf-0 , but despite this , the supernova driven winds in r10-kinf-0.3 create large - scale , rarified bubbles of metal - enriched , @xmath115 k gas , unlike the much weaker winds driven in r10-kinf-0 .    we have demonstrated that choosing a non - zero kinetic injection fraction for the feedback model can have a dramatic impact on the star formation rate of our simulated halo . given the results of section [ sec : idealized_tests ] , this is not surprising .",
    "at the resolution of these simulations , and for the densities in which supernova feedback occurs in our model , we would expect the resolution timescale of supernova affected regions to be comparable to or to exceed the snow - plow timescale .",
    "this means that radiative cooling dominates the energetic evolution before the kinetic and thermal energies have a chance to equilibrate .",
    "this likely leads to a difference in the level of energy retained in supernova - heated gas between the purely thermal feedback models and the models with kinetic energy injection .",
    "the result , as we have seen , is a more diffuse ism in models with kinetic energy injection , and therefore a lower star formation rate .",
    "this cell has the greatest likelihood of forming a star particle .",
    "the density threshold for star formation ( which is fixed in comoving units ) is shown as a dashed black line . _",
    "bottom panel : _ total mass of gas at densities above half the threshold density for star formation in the simulation volume . ]",
    "what is perhaps more surprising is that only a very small amount of kinetic energy injection is needed to produce this effect .",
    "all the simulations with some injection of kinetic energy behave very similarly .",
    "even the model with just 1% or less of the supernova energy injected in kinetic form is much more similar to the model with 30% injected kinetic energy than the model with 0% . as we saw in the idealized test simulations in section [ sec : testing_setup ] , the effect of kinetic energy injection on the ism followed a smooth continuous trend with @xmath14 down to even the smallest values of @xmath14 tested .",
    "the purely thermal tests were typically outliers of varying degree , depending on a multitude of physical and numerical factors . in this example application that includes many star particles , on grids of varying density , resolution , metallicity and ionization state , this difference appears to be amplified , such that the purely thermal tests produce very different behavior .",
    "as we have discussed , the density of the supernova affected region is crucial to the energetic evolution of the surrounding ism . in these simulations",
    ", we may be injecting energy into an unphysically dense medium , since we add supernova energy into the surrounding gas immediately after a star particle s creation where the gas density is high ( @xmath116 10 - 100 @xmath4 ) , as set by the star formation algorithm .",
    "observations of supernova remnants in the milky way indicate that supernovae may occur in ism with much lower densities ( @xmath8 1 @xmath4 ) @xcite .",
    "type ii supernovae are products of massive stars which produce large amounts of uv radiation and stellar winds prior to the supernova event .",
    "the amount of energy produced in this phase is comparable to the amount of energy produced during the supernova @xcite and may generate a rarified hii region surrounding the star .",
    "we have not attempted to simulate this phase of stellar feedback although it may well be important in regulating the density of the ism around supernova events . on the other hand",
    ", the mass of material shed by a massive star during a red supergiant phase may raise the density of the surrounding ism resulting in a higher background density @xcite .",
    "it is also interesting to note that the densities surrounding supernova remnants in the massive star forming region of the lmc 30 doradus exceed the commonly found value in the milky way of 1 @xmath4  @xcite .    a lower background density for supernova events would reduce the importance of @xmath14 in our model because the snow - plow timescale would exceed the resolution timescale at the resolution of our galaxy model .",
    "in addition , our resolution in feedback zones is not constrained to occur at the maximum allowed resolution in the simulation .",
    "rather , it is determined by the local gas and dark matter density . in r10-kinf-0.3",
    ", the cell width does not drop below 43 comoving pc , which at @xmath117 corresponds to a cell width of more than 4 pc .",
    "based on figure [ fig : multires_multiden ] , if feedback at this redshift was constrained to occur on the finest level of allowed refinement , which has a factor of 4 better resolution , we may expect different behavior of supernova heated gas that is also less sensitive to the choice of @xmath14 .",
    "most of the star formation and feedback in r10-kinf-0 does occur on grids at the maximum allowed resolution .",
    "the reason for this difference , however , is that gas reaches much higher densities in r10-kinf-0 and therefore the resolution needed to reach a state where @xmath14 does not matter is higher .                  as seen in figures [ fig : kinf0_image ] and [ fig : kinf0.3_image ] , the galactic winds produced in r10-kinf-0.3 ( and all runs with momentum injection ) are qualitatively more effective in enriching the igm .",
    "this effect can also be seen in the metals left behind in the halo s stellar component .",
    "table  [ tab ] shows that the mean metallicity of the stellar population produced in models with kinetic feedback are much lower than in r10-kinf-0 .",
    "figure [ fig : obs_dist ] compares the metallicity distributions of the stellar populations in all our galaxy simulations run with the new supernova feedback model to metallicity distributions observed for dsphs in the milky way @xcite .",
    "it is clear that the distribution found in r10-kinf-0 is inconsistent with observed systems due to its high mean , which is close to solar , while the distributions found in the models with momentum input are much closer to those found in observed systems . for this comparison",
    ", we assume that [ fe / h ] = log(z / z@xmath2 ) , where z is the simulated mean metallicity field .    all simulations with kinetic energy input above 1% appear to converge to a similar overall metallicity profile in their stellar populations . increasing the kinetic injection fraction from as little as 0.05 to as much as 0.3 does not result in a substantially increased loss of metals . the model with 1%",
    "kinetic energy begins to deviate from this common profile and shifts to higher metallicities , but still results in no star particles above solar metallicity , unlike r10-kinf-0 .    as we have discussed , the variable kinetic energy injection scheme typically results in @xmath118 .",
    "the metallicity distributions found in these runs are somewhat more enriched than the 1% case , but not substantially so .",
    "these runs also have a somewhat broader distributions .",
    "we will further discuss these differences in section [ sec : dtlim ] .",
    "the simulations conducted with the feedback model presented here still result in metallicities too high for their stellar masses .",
    "all models except r10-kinf - var have stellar masses approximately less that @xmath119 m@xmath2 . assuming that for an old population 2 m@xmath2  of stellar mass produces 1 l@xmath2  in the v band @xcite and given the luminosity - metallicity relation found for local group dwarfs @xcite , the mean stellar metallicity for these systems should be less than 2 dex in [ fe / h ] .",
    "the conversion of our simulated metal fractions to the observed quantity [ fe / h ] is not a straightforward one .",
    "the metallicities in our simulations represent a mean over several chemical species , not just an iron abundance , which is the quantity the observational data measure .",
    "iron is produced primarily in type ia supernovae , so it is possible that stars formed in post - type ii supernova ejecta will be poorer in iron and richer in other elements and therefore , our calculation of [ fe / h ] from our simulations is too high .",
    "however , we are more interested the differences between metal fractions between models and the distribution of metal fractions within modes , so we choose not to address this issue in detail .    as we have discussed , the kinetic feedback energy appears to closely regulate the density of gas in progenitor halos , keeping it fixed at the density threshold for star formation .",
    "in addition , the metallicity of dense gas remains constant once it has enriched to an equilibrium level ( not shown ) . in our simulations , this results in a roughly constant star formation rate at a roughly constant stellar metallically and as a consequence , a large population of star particles is created at the equilibrium gas metallicity .",
    "the spread in stellar metallicities in the variable kinetic fraction simulations is greater , however , they are still characterized by a low - metallicity tail and a sharper high - metallicity drop - off .",
    "there are dwarfs that do exhibit distributions of this type , however , many do not .",
    "in fact , observed systems of comparable stellar mass to our observed halos exhibit a diversity in stellar metallicity distributions @xcite .",
    "a very likely reason for this difference is that the supernova feedback model we use produces a single , prompt injection of energy and metals , mimicking type ii supernovae , rather than a more comprehensive model that includes multiple sources of feedback occurring on different timescales and with different energies and chemistry @xcite .",
    "it is possible that this single source of stellar feedback naturally results in a sharp cutoff at high metallicity , especially in our case where feedback closely regulates gas density and metallicity .",
    "the simulation with the largest dispersion in stellar metallicities is r10 , in which there is a gradual injection of metals and energy by star particles @xcite .",
    "this model creates a large population of low metallicity star particles .",
    "it was originally intended for more massive star particles that release feedback energy from multiple sources from a well sampled stellar population .",
    "while the application of this model to star particles of 100 m@xmath2  is unphysical in many ways , it demonstrates that some ejection of metals through stellar winds in the pre - supernova stage may play a role in producing the broad distribution of stellar metallicities , especially at the low metallicity end .        in sections [ sec : sfr ] and [ sec : metals ]",
    ", we have shown the effects of both a constant kinetic injection fraction and the resolution - dependent kinetic injection scheme on star formation in this halo .",
    "this scheme depends also on gas density and metallicity , such that in gas with shorter cooling times ( i.e. higher density gas and/or higher metallicity gas ) has higher kinetic injection fractions .",
    "however , as resolution increases , this scaling assumes more of the supernova remnant s energy has been thermalized and therefore , a smaller @xmath51 is used .",
    "we found in r10-kinf - var and r10-kinf - var - dtlim that typically @xmath89 and therefore a small amount of kinetic energy was injected .",
    "usually , this value was less than 1% . in denser gas , the adaptive refinement increases resolution , but not sufficiently to ensure @xmath89 .",
    "the two galaxy tests using the variable @xmath51 method differ in how they limit time steps .",
    "all the simulations presented here use the default courant - limited time stepping implemented in enzo @xcite .",
    "in addition , r10-kinf - var - dtlim uses @xmath96 of typical star - forming gas to limit the time step just before the feedback event as described in section [ sec : galaxy_methods ] .",
    "we found that this improvement in the time - step resolution , independent of an increase in mass or spatial resolution , increased the effectiveness of feedback .",
    "this is likely an effect of better capturing the initial , pressure - driven flows from feedback - shocked gas .",
    "the differences between r10-kinf - var and r10-kinf - var - dtlim are twofold : one , the stellar populations in r10-kinf - var enrich to a slightly higher level ; and two , star formation in small progenitor halos is not as effectively quenched in r10-kinf - var .",
    "figure [ fig : sfr_comp ] shows that the star formation history of the main halo , which has assembled most of its dark matter by @xmath120 , is similar between the two runs with only a small delay in quenching time in r10-kinf - var .",
    "the main differences arise from a smaller , satellite halo in r10-kinf - var that continues to form stars efficiently after the main halo quenches and keeps the total star formation rate of the simulation box elevated until the end of the simulation .",
    "the survival of low - level star formation likely results from low levels of energy injection whose ineffectiveness is promoted by the lower time resolution used to capture pressure - driven flows .    in many respects ,",
    "r10-kinf - var - dtlim is very similar in behavior to r10-kinf-0.01 , which is a simulation that injects a constant fraction of kinetic energy of 1% in all feedback events .",
    "the kinetic fractions in the two simulations that use the variable scheme are typically no more than 1% and in fact , are very often less than 0.1% , depending on the resolution and gas properties .",
    "winds in this suite of simulations are generated by two effects : one , the direct injection of kinetic energy that adds bulk velocity to cells ; and two , flows driven by pressure gradients in the gas . in simulations with low levels of kinetic energy injection like r10-kinf-0.01 and r10-kinf - var - dtlim , the second effect has a greater importance and we see some convergence in properties between these runs .       and table [ tab ] . as in figure [ fig : sfr_comp ] ,",
    "solid lines show the cumulative star formation history of all star particles that end the simulation within @xmath83 . ]    in all our cosmological zoom - in simulations , the amr algorithm , which allows the simulation to reach higher resolutions than otherwise allowed in static grid simulations , means that in a single simulation hydrodynamics is solved with varying resolutions at a range of densities interesting for star formation .",
    "therefore , the resolution - dependent scaling for @xmath14 results in different kinetic injection fraction not just between simulations of overall different resolutions , but also within a single simulation . as is typically the case in amr simulations , we allow refinement in such a way to maintain a cells with a constant mass in a way that is analogous to lagrangian methods .",
    "therefore , at each amr level , the maximum density that can be reached ( before refinement is triggered ) , is proportional to @xmath121 , where @xmath122 is the amr level ( allowed up to 12 ) and @xmath123 is the mean density of the universe at @xmath124 .",
    "therefore , the variable scaling of @xmath14 used in some of our cosmological simulations in principle also depends on redshift and amr level through its density dependence .    to better understand how spatial resolution allowed in the hydrodynamics calculation impacts our model when run with amr in a realistic galactic setting ,",
    "we have also undertaken two simulations r43-kinf - var - dtlim and r173-kinf - var - dtlim where the minimum cell width is limited to 43 pc and 173 pc respectively .",
    "table [ tab ] summarizes some of the properties of the target halo in these simulations and figure [ fig : sfr_res ] presents the star formation histories within the main halos in these simulations .    we have altered nothing else in these simulations apart from the maximum allowed level of amr .",
    "the maximum allowed mesh resolution in simulation r173-kinf - var - dtlim is the lowest resolution where densities above the star - formation threshold can be reached .",
    "star - forming gas is resolved in this simulation , but not well , and the result is that star formation proceeds at a relatively low - level ( compared to the higher resolution simulations ) , is rather bursty and is dominated by fewer star - forming progenitor halos .",
    "these differences should be understood as due primarily to the inefficiency of star formation rather than to an effect of the feedback model .",
    "the simulation r43-kinf - var - dtlim , however , does have sufficient resolution to resolve gas at densities more than an order of magnitude above the star - forming threshold ; the behavior in this simulation is likely due more to the feedback model as implemented under different amr conditions .",
    "however , we see that overall , the properties and evolution of this simulation are remarkably similar to r10-kinf - var - dtlim . this similarity could have been predicted from the fact that r10-kinf - var - dtlim has difficulty reaching the maximum allowed amr level and in fact , the deepest level in the hierarchy that r10-kinf - var - dtlim reliably reaches is only one level more than the maximum of 10 levels allowed in r43-kinf - var - dtlim .",
    "this contrasts with simulations of this same halo run at this resolution with purely thermal feedback as discussed in @xcite . in that simulation , r43 , limiting the spatial resolution resolution to this level did have a significant effect on the overall evolution of star formation .",
    "thermal feedback in that simulation was much less effective at quenching star formation post - reionization due to the fact that the motions of supernova affected gas were controlled primarily by the specific heating rate from the supernova feedback and that rate is lower at lower grid resolutions , the classic ` over - cooling problem . '",
    "the model we have described and tested introduces a new tuneable parameter , @xmath14 , the fraction of injected kinetic energy .",
    "the model also has ( like most star - formation algorithms ) parameters that control the total amount of mass , metals , and energy to return to the gas , as well as the timescale over which to inject it . in principle",
    "these other parameters can be determined in reference to the imf and how it is sampled .",
    "these choices are not trivial and have the potential to affect results , however in this study , we have deliberately chosen to fix those parameters in order to focus on @xmath14 .",
    "the parameter @xmath14 is a fundamentally different type of parameter as it depends on the ability of the hydrodynamical solver to capture the state of shocked gas and depends primarily on resolution .",
    "the resolution dependent behavior is a function of the background density and in section  [ sec : kinf_var ] , we presented a density - dependent scaling for @xmath14 , which also accounts for metallicity .",
    "this model is a promising start , but it is not the final word  a more complete model might build on the work presented here to prescribe both @xmath14 and the energy available based on the appropriate sn phase ( free - expansion , sedov , or snow - plow ) and the resolution .",
    "nevertheless , even a constant value of @xmath51 may capture much of the key phenomenology , as we saw in section  [ sec : galaxy_simulation ] that simulations with any momentum input had very similar behavior , while simulations with zero kinetic energy were quite different .",
    "the idealized test simulations we have presented can also be used to provide a guide for choosing simulation resolution .",
    "for example , figure  [ fig : final_efrac ] shows that at all background densities tested , resolutions of 1 - 2 pc result in evolution that is largely independent of @xmath14  a similar resolution requirement is also found by turbulent , high - resolution ( @xmath8 1 pc ) ism simulations ( e.g. , * ? ? ? * ) .",
    "the galaxy simulations we present here already achieve resolutions of this order at high redshift .",
    "simulations with an overall higher resolution or a more creative adaptive refinement scheme that triggers refinement around feedback producing particles would ensure high resolution is reached around feedback events at all times .",
    "the dependence on @xmath14 may be less in such simulations .",
    "in addition , an important point that should be emphasized is that the resolution dependent behavior of the model is much weaker in lower density media .",
    "this has important consequences when considering the numerous physical effects we neglect in our galaxy model .",
    "for example , coupling this model with a model for radiation feedback from young stars may serve to lower the resolution requirements of the supernova feedback scheme by lowering the density of gas surrounding supernovae events ( e.g. * ? ? ?",
    "moreover , even without a radiation feedback scheme , simply allowing star particles to drift from their birth sites , which are necessarily in the highest density gas cells , may by itself produce a similar effect @xcite . in this study , we are in a sense injecting feedback events in the least hospitable conditions for thermal energy injection .",
    "this in effect maximizes the impact of kinetic energy injection .",
    "ideally , future work would include a more complete model , simulated at higher resolution , where this effect would instead be minimized .",
    "in this paper , we have described a novel scheme for adding energetic feedback to a grid - based hydrodynamics code for use in galaxy simulations .",
    "the new aspects of this method include : ( i ) a compact feedback stencil which naturally builds on particle - grid interaction methods ( such as the cloud - in - cell method ) in a relatively isotropic fashion ; ( ii ) the use of the existing solution on the grid to set a specific amount of kinetic and thermal energy to be added to the grid ; and ( iii ) a net vector momentum input of zero .",
    "the free parameter in the model is @xmath51 , the fraction of the energy injected in kinetic form .",
    "we have extensively tested the method in homogeneous media , first confirming that , in the absence of radiative cooling , we reproduce the expected sedov - taylor solution . then , we add cooling and carry out a large number of ( homogeneous ) test calculations in which we vary : ( i ) the kinetic to thermal injection fraction ; ( ii ) the density of the background medium ; and ( iii ) the resolution .",
    "we explore the results , characterizing them primarily by the amount of energy remaining after a fixed amount of time ( typically 0.1 myr ) and show how they can be understood simply through a set of three timescales that describe how the solution is affected by ( in turn ) purely numerical artifacts , the approach to the self - similar sedov - taylor solution , and radiative cooling .",
    "based on this analysis , we present an analytic scheme for choosing an appropriate @xmath125 given the resolution , density and metallicity of simulated gas , so that the resulting energy ( after 0.1 myr ) closely matches the results from high - resolution ( @xmath55 = 1 pc ) simulations of blast - wave evolution in a homogeneous , radiative medium .    finally , we used our feedback scheme to model the formation of a low - mass dwarf system in a cosmological setting .",
    "we found that constant kinetic injection fractions between 1% and 30% result in qualitatively similar results that differ greatly from models that include only thermal energy injection .",
    "kinetic feedback results in an order of magnitude suppression of the total stellar mass and approximately a 1 dex drop in the average stellar metallicity .",
    "the variable scheme for kinetic energy injection that we tested is somewhat less effective in dispersing metals and suppressing star formation , however , the results still differ drastically from the zero kinetic energy runs .",
    "the method we have presented is , in principle , scale independent and applications of the numerical scheme can be adapted for subgrid feedback recipes for use in lower - resolution calculations in future work . in the high - resolution",
    "( @xmath126 10 pc ) application that we explored in this study , we have used a simplistic model for the sources of stellar feedback , restricting the model to type ii supernovae .",
    "future work that includes a more sophisticated sampling of supernovae events from the stellar particles ( e.g. type ia supernovae and high - velocity ob stars ) as well as models for uv heating from young stars and winds from evolved stars will likely produce models with higher fidelity to observations .",
    "the basic prescription for adding kinetic energy could also be extended to include feedback from agn .",
    "the authors would like to thank the anonymous reviewer for thoughtful comments and suggestions that helped improve the paper .",
    "this work was supported by nasa grant nnx12ah41 g .",
    "glb also acknowledges support from grants nsf-1008134 , nsf-1210890 , and nsf-1312888 .",
    "cms acknowledges support by the european research council under erc - stg grant exagal-308037 .",
    "computational resources from nsf xsede , sdsc , tacc and columbia university s shared research compute cluster were used to perform this work .",
    "this work was supported in part by the national science foundation under grant no .",
    "phys-1066293 and the hospitality of the aspen center for physics .",
    "the authors would also like to thank mordecai mac low , volker springel and federico marinacci for their valuable comments on our draft and marla geha , mary putman and john wise for valuable comments in the development of this work ."
  ],
  "abstract_text": [
    "<S> we describe a new method for adding a prescribed amount of kinetic energy to simulated gas modeled on a cartesian grid by directly altering grid cells mass and velocity in a distributed fashion . </S>",
    "<S> the method is explored in the context of supernova feedback in high - resolution ( @xmath0 pc ) hydrodynamic simulations of galaxy formation . </S>",
    "<S> resolution - dependence is a primary consideration in our application of the method and simulations of isolated explosions ( performed at different resolutions ) motivate a resolution - dependent scaling for the injected fraction of kinetic energy that we apply in cosmological simulations of a @xmath1 m@xmath2dwarf halo . </S>",
    "<S> we find that in high density media ( @xmath3 50 @xmath4 ) with coarse resolution ( @xmath5 pc per cell ) , results are sensitive to the initial kinetic energy fraction due to early and rapid cooling . in our galaxy simulations , </S>",
    "<S> the deposition of small amounts of supernova energy in kinetic form ( as little as 1% ) has a dramatic impact on the evolution of the system , resulting in an order of magnitude suppression of stellar mass . </S>",
    "<S> the overall behavior of the galaxy in the two highest resolution simulations we perform appears to converge . </S>",
    "<S> we discuss the resulting distribution of stellar metallicities , an observable sensitive to galactic wind properties , and find that while the new method demonstrates increased agreement with observed systems , significant discrepancies remain , likely due to simplistic assumptions that neglect contributions from type ia supernovae and stellar winds . </S>"
  ]
}