{
  "article_text": [
    "in order to derive eq . from eq .",
    ", let us first compute the time derivative of eq . using the definition of the atomic energies , eq .",
    ", to obtain : @xmath56 ,    \\label{eq : e - dot}\\ ] ] where @xmath57 is the gradient of the @xmath58 function .",
    "we now insert eq . into eq . , to obtain : @xmath59 where @xmath60 is the force acting on the @xmath12-th atom and @xmath61 .",
    ". is not well defined in periodic boundary conditions because the position of the @xmath12-th atom , @xmath62 , is defined modulo a vector in the bravais lattice and depends on the choice of the origin of the unit cell . in order to write a well defined expression for the current",
    ", we first note that @xmath63 . inserting this relation into eq .",
    ", one obtains : @xmath64 now in the second term of the second sum in eq .",
    "we can interchange the @xmath65 dummy indeces , to obtain : @xmath66 eq .",
    "is well defined in periodic boundary conditions , because it depends on atomic positions only through differences between pairs of them .",
    "note that this derivation does not depend on the assumption that atoms interact through pair potentials , and it holds in fact for general many - body inter - atomic potentials .",
    "when atoms interact through pair potentials , as it is the case considered in the present paper , and adopting the standard definition for the atomic energies , eq .",
    ", one has : @xmath67 , where @xmath68 indicates the gradient with respect to the position of the @xmath12-th atom . throwing this expression into eq .",
    ", one one finally obtains eq . used in the text .",
    "similarly , one would obtain the modified energy flux of eq . from the definition for the atomic energies given in eq . ."
  ],
  "abstract_text": [
    "<S> thermal transport coefficients are independent of the specific microscopic expression for the energy density and current from which they can be derived through the green - kubo formula . </S>",
    "<S> we discuss this independence in terms of a kind of _ gauge invariance _ resulting from energy conservation and extensivity , and demonstrate it numerically for a lennard - jones fluid , where different forms of the microscopic energy density lead to different time correlation functions for the heat flux , all of them , however , resulting in the same value for the thermal conductivity .    it has long been thought that the inherent indeterminacy of any quantum mechanical expression for the energy density would hinder the evaluation of thermal transport coefficients from equilibrium _ ab - initio _ molecular dynamics ( aimd ) , using the green - kubo ( gk ) formalism @xcite . in classical molecular dynamics ( cmd ) </S>",
    "<S> this goal is achieved by decomposing the total energy of an extended system into localized atomic contributions and by deriving from this decomposition an explicit ( and allegedly unique ) expression for the energy flux . </S>",
    "<S> while the calculation of thermal transport coefficients from equilibrium aimd has been successfully addressed by some of us in a recent work @xcite , the question still remains as to whether the expression for the energy flux currently used in cmd is uniquely defined and , in the negative , how is it that different definitions of the energy flux would lead to the same value for the thermal conductivity . in this paper </S>",
    "<S> we show that different equivalent definitions for the atomic energies in a classical system lead to different expressions for the macroscopic energy flux , and demonstrate numerically in the case of a lennard - jones fluid that these expressions result in the same value for the thermal conductivity , as evaluated from equilibrium cmd through the gk formula . </S>",
    "<S> this finding is then rationalized in terms of a kind of _ gauge invariance _ of heat transport coefficients , resulting from energy conservation and extensivity .    according to the gk formalism @xcite , the heat conductivity @xmath0 of an isotropic material </S>",
    "<S> can be expressed in terms of the auto - correlation function of the macroscopic heat flux , @xmath1 , as : @xmath2 where brackets @xmath3 indicate canonical averages , @xmath4 is the boltzmann constant , and @xmath5 and @xmath6 are the system volume and temperature , respectively . </S>",
    "<S> the heat flux is the macroscopic average of the heat current density , which is in turn defined as the non - convective component of the energy current density . </S>",
    "<S> atoms in solids can be assumed to not diffuse , while in one - component and molecular fluids convective energy transport can be disregarded because of momentum conservation . </S>",
    "<S> because of this , in the following we assume that energy and heat currents coincide .    in cmd </S>",
    "<S> the macroscopic energy flux is expressed in terms of suitably defined atomic energies whose sum yields the total energy of the system . </S>",
    "<S> for the sake of simplicity , we restrict our attention to one - component systems held together by pair potentials , in which case the atomic energies can be defined as @xcite : @xmath7 where @xmath8 is the atomic mass , @xmath9 and @xmath10 are atomic coordinates and velocities , respectively , @xmath11 is the inter - atomic pair potential , and the indices @xmath12 and @xmath13 run over all the atoms in the system . using standard manipulations @xcite </S>",
    "<S> , the macroscopic energy flux can be obtained from eq . </S>",
    "<S> as : @xmath14 where ( for a derivation of eq . </S>",
    "<S> , valid for general many - body inter - atomic potentials @xcite and its specialization to the present pair - potentials case , see the appendix ) . </S>",
    "<S> it is often implicitly assumed that the well - definedness of thermal transport coefficients would stem from the uniqueness of the decomposition of the system s total energy into localized , atomic , contributions . </S>",
    "<S> this assumption is manifestly incorrect , as any decomposition leading to the same value for the total energy as eq . </S>",
    "<S> should be considered as legitimate . </S>",
    "<S> the difficulty of partitioning a system s energy into subsystems contributions is illustrated in figure [ fig : energy - partition ] , which depicts a system made of two interacting subsystems . </S>",
    "<S> when defining the energy of each of the two susbsystems , an arbitrary decision has to be made as to how the interaction energy is partitioned . in the case depicted in figure [ </S>",
    "<S> fig : energy - partition ] , for instance , the energy of each of the two subsystems can be defined as @xmath15 , where @xmath16 are the energies of the two isolated subsystems , @xmath17 their interaction energy , and @xmath18 an arbitrary constant . in the thermodynamic limit , when the energy of any relevant subsystem is much larger than the interaction between any pairs of them , the value of the @xmath18 constant is irrelevant . when it comes to definining energy densities ( _ i.e. _ energies of infinitesimal portions of a system ) or atomic energies , instead , the magnitude of the interaction between different susbsystems is comparable to the their energies , which become therefore intrinsically ill - defined .    </S>",
    "<S> , whose magnitude scales as the area of the interface , depicted in red . when defining the energies of individual subsystems , @xmath19 </S>",
    "<S> , @xmath20 has to be arbitrarily partitioned among them . </S>",
    "<S> [ fig : energy - partition ] ]    @xmath21    as a specific example , we consider the following definition for the atomic energies @xcite : @xmath22 where @xmath23 is _ any _ antisymmetric matrix . as the inter - atomic potential appearing in eq . </S>",
    "<S> is symmetric with respect to the atomic indices , it is clear that the sum of all the atomic energies does not depend on @xmath24 , thus making any choice of @xmath24 equally permissible . </S>",
    "<S> this trivial observation has deep consequences on the theory of thermal fluctuations and transport , because the value of the macroscopic energy flux , instead , depends explicitly on @xmath24 , thus making one fear that the resulting transport coefficients would depend on @xmath24 as well . using the same manipulations that lead from eq . </S>",
    "<S> to eq . </S>",
    "<S> , for any choice of the @xmath24 matrix in eq . </S>",
    "<S> , a corresponding expression for the macroscopic energy flux can be found , reading @xcite : @xmath25     matrix ( see text ) . </S>",
    "<S> the `` 0 '' line refers to the original definition ( _ i.e. _ @xmath26 ) , whereas the label `` 1 '' and `` 2 '' correspond to the two definitions of the @xmath24 matrix given in eq . . </S>",
    "<S> the parameters used are @xmath27 and @xmath28 . </S>",
    "<S> error bars , as estimated by standard block analysis , are smaller than the thickness of the lines . </S>",
    "<S> units are lennard - jones units ( @xmath29 ) . </S>",
    "<S> [ fig : j0jt ] ]    in order to illustrate this state of affairs , we have performed cmd simulations for a fluid of identical atoms , interacting through a lennard - jones potential : @xmath30 $ ] at density - temperature conditions @xmath31 and @xmath32 , using cubic simulation cells containing 256 atoms in the iso - choric microcanonical ensemble , @xmath33 @xcite . in figure </S>",
    "<S> [ fig : j0jt ] we display the macroscopic energy - flux autocorrelation function corresponding to different choices of the @xmath24 matrix in eqs . and . </S>",
    "<S> the @xmath24 matrices have been constructed in two different ways , according to the prescriptions : @xmath34 $ interval . } </S>",
    "<S> \\setbox1 \\vbox{\\hsize=50 mm \\small\\noindent according to whether $ i = j$ ,    $ i > j$ , or $ i < j$. } \\gamma_{ij}= \\left \\ {    \\begin{alignedat}{2 }      \\frac{1}{2 } \\left(a_{ij}-a_{ji}\\right ) & \\quad\\raise -.5\\ht0      \\box0 & & \\qquad ( 1 ) \\\\ </S>",
    "<S> \\\\      0 , + \\gamma , -\\gamma & \\quad\\raise -0.5\\ht1 \\box1 & & \\qquad ( 2 ) \\\\    </S>",
    "<S> \\end{alignedat } \\right . </S>",
    "<S> \\label{eq : gamma}\\ ] ] figure [ fig : j0jt ] clearly shows that the @xmath35 correlation functions dramatically depend on the @xmath24 matrices in eqs . and . </S>",
    "<S> notwithstanding , the integrals of all these time correlation functions tend to the same limit at large integration times , as displayed in figure [ fig : lambda ] .    in order to get insight into this remarkable invariance property , let us inspect the difference between the generalized flux in eq . and the standard expression of eq . </S>",
    "<S> : @xmath36 we see that the two different expressions for the macroscopic energy flux differ by a total time derivative . in the following </S>",
    "<S> , we will show that this is a consequence of energy conservation and extensivity and a sufficient condition for the corresponding thermal conductivity to coincide .    , multiplied by the prefactor appearing in the gk relation , eq . , as a function of the upper limit of integration . </S>",
    "<S> units are lennard - jones units ( see caption to figure [ fig : j0jt ] ) . </S>",
    "<S> the barely visible shaded area surrounding each line is an indication of the error bars , as estimated by standard block analysis . </S>",
    "<S> [ fig : lambda ] ]    the very possibility of defining an energy current density stems from energy extensivity and conservation . </S>",
    "<S> energy is extensive : because of this , the energy of a macroscopic sample of matter of volume @xmath37 can be written as the integral of an energy density , @xmath38 : @xmath39=\\int_{\\omega}e(\\mathbf{r})d\\mathbf{r}. \\label{eq : extensivity}\\ ] ] of course , the energy density appearing in eq . </S>",
    "<S> is not uniquely defined , the only requirement being that its integral over a domain @xmath37 is well defined in the thermodynamic limit , _ </S>",
    "<S> i.e. _ two different densities whose integral over a domain @xmath37 differ by a quantity that scales as the area of the domain boundary should be considered as equivalent . </S>",
    "<S> this equivalence can be expressed by the condition that two equivalent densities , say @xmath40 and @xmath41 , differ by the divergence of a ( bounded ) vector field : @xmath42 in a sense , two equivalent energy densities can be thought of as different _ gauges _ of the same scalar field .    </S>",
    "<S> energy is also conserved : because of this , for any given gauge of the energy density , @xmath38 , an energy current density can be defined , @xmath43 , so as to satisfy the continuity equation : @xmath44 where the dot indicates a time derivative . by combining eqs . and </S>",
    "<S> we see that energy current densities and macroscopic fluxes transform under a gauge transformation as : @xmath45 where @xmath46 . </S>",
    "<S> we conclude that the macroscopic energy fluxes in two different energy gauges differ by the total time derivative of a vector .    our previous findings on the energy flux of a system of classical atoms interacting through pair potentials as embodied in eq . </S>",
    "<S> can be recovered by defining the corresponding energy density as : @xmath47 by taking the first moment of the continuity equation , eq . </S>",
    "<S> , with respect to @xmath48 and integrating by parts its right - hand side , one sees that the macroscopic average of the energy current density is the first moment of the time derivative of the energy density : @xmath49 eq . </S>",
    "<S> is ill - defined in periodic boundary conditions because the position variable appearing therein is defined modulo an integer translation , and the first moment of a periodic function depends therefore on the definition and choice of origin of the unit cell . </S>",
    "<S> this same difficulty affects the definition of the macroscopic polarization in insulators and has given birth to the so called _ modern theory of polarization _ </S>",
    "<S> @xcite . nevertheless , by throwing eq . into eq . and using newton s equations of motion , eq . can be cast into a boundary - insensitive form , as explained in detail in the appendix , eventually resulting in the expressions for the macroscopic energy flux given by eqs . and .    </S>",
    "<S> we now show that the energy fluxes of the same system in two different energy gauges , @xmath50 and @xmath51 , thus differing by a total time derivative , as in eq . </S>",
    "<S> , result in the same heat conductivity , as given by the green - kubo formula , eq . . </S>",
    "<S> let us indicate by @xmath52 and @xmath53 the thermal conductivities in the two gauges . </S>",
    "<S> using eq . and </S>",
    "<S> the property that classical time auto - correlation functions are even in time , one obtains : @xmath54 the integral on the right - hand side of eq . vanishes because the correlation function of two observables at large time lags factorizes into the product of two time - independent average values and because the average value of the current @xmath55 , as well as of any total time derivative , vanishes at equilibrium . </S>",
    "<S> we conclude that the heat conductivities computed in different energy gauges coincide , as they must on physical grounds .    </S>",
    "<S> in this paper we have demonstrated that , while the heat flux is inherently undetermined at the atomic level , the heat conductivity resulting from it through the green - kubo formula is indeed well defined , as any measurable property must be . </S>",
    "<S> this indeterminacy stems from the liberty one has to formally unpack the total energy of an extended system into localized contributions in an infinite number of equivalent ways . </S>",
    "<S> we believe that this freedom can be exploited to design the definition of the local energy ( be it in terms of atomic energies or energy densities ) , so as to optimise the convergence of computer simulations , regarding simulation length , system size , or both . </S>"
  ]
}