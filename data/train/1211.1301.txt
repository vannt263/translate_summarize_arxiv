{
  "article_text": [
    "in this paper , we are concerned with certain factors of @xmath0-automatic sequences . roughly speaking",
    ", a sequence @xmath6 over a finite alphabet @xmath7 is said to be @xmath0-automatic if there exists a finite automaton that , on input @xmath8 expressed in base @xmath0 , reaches a state with output @xmath9 .",
    "automatic sequences were popularized by a celebrated paper of cobham @xcite and have been widely studied ; see .",
    "more precisely , let @xmath0 be an integer @xmath10 , and set @xmath11 .",
    "let @xmath12 be a deterministic finite automaton with output ( dfao ) with transition function @xmath13 and output function @xmath14 .",
    "let @xmath15 denote the canonical base-@xmath0 representation of @xmath8 , without leading zeros , and starting with the most significant digit .",
    "then we say that @xmath16 generates the sequence @xmath17 if @xmath18 for all @xmath19 .",
    "the prototypical example of a @xmath0-automatic sequence is the thue - morse sequence @xmath20 , defined by the relations @xmath21 and @xmath22 , @xmath23 for @xmath19 .",
    "it is generated by the dfao below in figure  [ fig1 ] .",
    "# 1#21.0#1    [ fig1 ]    a _ factor _ of the sequence @xmath24 is a finite word of the form @xmath25 .",
    "a finite word @xmath26 is said to be _ bordered _ if there is some finite nonempty word @xmath27 that is both a prefix and a suffix of @xmath26 .",
    "for example , the english word ionization is bordered , as it begins and ends with ion .",
    "otherwise @xmath26 is said to be _",
    "unbordered_.    recently , there has been significant interest in the properties of unbordered factors ; see , for example , . in particular , currie and saari studied the unbordered factors of the thue - morse word .    currie and",
    "saari proved that if @xmath28 , then the thue - morse word has an unbordered factor of length @xmath8 , but left it open to decide for which lengths congruent to @xmath29 ( mod @xmath30 ) this property holds .",
    "this was solved in , where the following characterization is given :    the thue - morse sequence @xmath31 has an unbordered factor of length @xmath8 if and only if @xmath32 .",
    "a harder problem is to come up with an expression for the number of unbordered factors of @xmath31 . in ,",
    "the second author and co - authors made the following conjecture :    let @xmath1 denote the number of unbordered factors of length @xmath8 in @xmath31 , the thue - morse sequence .",
    "then @xmath33 is given by @xmath34 , @xmath35 , @xmath36 , and the system of recurrences @xmath37 for @xmath19 .",
    "[ unbtm ]    this conjecture was obtained by computing a large number of values of @xmath33 and then looking for possible linear relations among subsequences of the form @xmath38 .",
    "this system suffices to calculate @xmath33 efficiently , in @xmath39 arithmetic steps .",
    "we now summarize the rest of the paper . in section  [ proof ] , we prove conjecture  [ unbtm ] . in section  [ kreg ] ,",
    "we discuss how to obtain relations like those above for a given @xmath0-regular sequence . in section  [ growth ]",
    "we discuss the growth rate of @xmath33 in detail .",
    "finally , in section  [ other ] , we give examples of other sequences with interesting numbers of unbordered factors .",
    "we now outline our computational proof of conjecture  [ unbtm ] .",
    "first , we need a little notation .",
    "we extend the notion of canonical base-@xmath0 representation of a single non - negative integer to tuples of such integers .",
    "for example , by @xmath40 we mean the unique word over the alphabet @xmath41 such that the projection @xmath42 onto the first coordinate gives the base-@xmath0 representation of @xmath43 , and the projection @xmath44 onto the second co - ordinate gives the base-@xmath0 representation of @xmath8 , where the shorter representation is padded with leading @xmath45 s , if necessary , so that the representations have the same length .",
    "for example , @xmath46 [ 0,1 ] [ 1,0 ] [ 0,1 ] [ 1,0 ] [ 1,1]$ ] .",
    "step 1 : using the ideas in , we created an automaton @xmath47 of 23 states that accepts the language @xmath48 of all words @xmath49 such that there is a `` novel '' unbordered factor of length @xmath8 in @xmath31 beginning at position @xmath50 . here",
    "`` novel '' means that this factor does not previously appear in any position to the left .",
    "thus , the number of such words with first component equal to @xmath51 equals @xmath1 , the number of unbordered factors of @xmath31 of length @xmath8 .",
    "this automaton is illustrated below in figure  [ aut ] ( rotated to fit the figure more clearly ) .",
    "step 2 : using the ideas in , we now know that @xmath33 is a @xmath5-regular sequence , with a `` linear representation '' that can be deduced from the structure of @xmath47 .",
    "this gives matrices @xmath52 of dimension @xmath53 and vectors @xmath54 such that @xmath55 where @xmath56 is the base-@xmath5 representation of @xmath8 , written with the most significant digit first .",
    "they are given below .",
    "@xmath57 } \\ ] ]     such that there is a novel unbordered factor of length @xmath8 at position @xmath50 of @xmath31,width=768 ]    @xmath58 .   } \\ ] ]    @xmath59 \\\\ w & = & [ 0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]^t\\end{aligned}\\ ] ]    step 3 : now each of the identities in ( [ idl ] ) corresponds to a certain identity in matrices .",
    "for example , the identity @xmath60 can be written as @xmath61 where @xmath16 is the matrix product corresponding to the base-@xmath5 expansion of @xmath8 .",
    "more generally , we can think of @xmath16 as some arbitrary product of the matrices @xmath62 and @xmath63 , starting with at least one @xmath63 ; this corresponds to an arbitrary @xmath64 .",
    "we can think of @xmath16 as a matrix of indeterminates .",
    "then ( [ id16 ] ) represents an assertion about the entries of @xmath16 which can be verified .",
    "of course , the entries of @xmath16 are not completely arbitrary , since they come about as @xmath63 times some product of @xmath62 and @xmath63 .",
    "we can compute the ( positive ) transitive closure of @xmath65 and then multiply on the left by @xmath63 ; the entries that have @xmath45 s will be @xmath45 in any product of @xmath63 times a product of the matrices @xmath62 and @xmath63 .",
    "thus we can replace the corresponding indeterminates by @xmath45 , which makes verifying ( [ id16 ] ) easier .",
    "another approach , which is even simpler , is to consider @xmath66 in place of @xmath16 .",
    "this reduces the number of entries it is required to check from @xmath67 to @xmath68 , where @xmath68 is the dimension of the matrices .",
    "step 4 : finally , we have to verify the identies for @xmath69 and @xmath70 , which is easy .",
    "we carried out this computation in maple for the matrices @xmath62 and @xmath63 corresponding to @xmath47 , which completes the proof .",
    "the maple program can be downloaded from    http://www.cs.uwaterloo.ca/~shallit/papers.html .",
    "the verification method of the previous section can be extended to a method to mechanically _ find _ the relations for _ any _ given @xmath0-regular sequence @xmath71 ( instead of guessing them and verifying them ) , given the linear representation of @xmath71 .",
    "suppose we are given the linear representation of a @xmath0-regular sequence @xmath71 , that is , vectors @xmath54 and matrices @xmath72 such that @xmath73 , where @xmath74 .",
    "now let @xmath16 be arbitrary and consider @xmath66 as a vector with variable entries , say @xmath75 $ ] .",
    "successively compute @xmath76 for words @xmath77 of length @xmath78 over @xmath11 ; this will give an expression in terms of the variables @xmath79 .",
    "after at most @xmath80 such relations , we find an expression for @xmath81 for some @xmath77 as a linear combination of previously computed expressions .",
    "when this happens , you no longer need to consider any expression having @xmath77 as a suffix .",
    "eventually the procedure halts , and this corresponds to a system of equations like that in ( [ unbtm ] ) .",
    "consider the following example .",
    "let @xmath82 , @xmath83 $ ] , @xmath84^t$ ] , and @xmath85 \\\\ m_1 & = & \\left [ \\begin{array}{cc }      0 & 2 \\\\      -3 & 1       \\end{array } \\right]\\end{aligned}\\ ] ]    suppose @xmath16 is some product of @xmath62 and @xmath63 , and suppose @xmath86 $ ] .",
    "we find @xmath87    and , solving the linear systems , we get @xmath88    this gives us @xmath89 for @xmath64 .",
    "we now return to @xmath1 , the number of unbordered factors of @xmath31 of length @xmath8 .",
    "here is a brief table of @xmath1 :    [ cols=\"^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     kalle saari ( personal communication ) asked about the growth rate of @xmath1 .",
    "the following results characterizes it .",
    "we have @xmath2 for @xmath3 . furthermore , @xmath4 infinitely often .",
    "thus , @xmath90 .",
    "we start by verifying the following relations :    @xmath91    these can be verified in exactly the same way that we verified the system ( [ unbtm ] ) earlier .",
    "we now verify , by induction on @xmath8 , that @xmath2 for @xmath3 .",
    "the base case is @xmath92 , and @xmath93 .",
    "now assume @xmath94 . otherwise ,    * if @xmath95 , say @xmath96 and @xmath97",
    ". then @xmath98 by ( [ eq2 ] ) and induction .",
    "* if @xmath99 , say @xmath100 for @xmath101 , then @xmath102 by ( [ eq3 ] ) .",
    "but @xmath103 by induction for @xmath97 .",
    "the case @xmath104 corresponds to @xmath105 . *",
    "if @xmath106 , say @xmath107 , then for @xmath97 we have @xmath108 by induction , which is less than @xmath109 . if @xmath104 , then @xmath110 .",
    "* if @xmath111 , say @xmath112 for @xmath101 , then @xmath113 by induction . *",
    "if @xmath114 , say @xmath115 , then @xmath116 by induction , provided @xmath97 .",
    "for @xmath117 we have @xmath118 and for @xmath104 we have @xmath119 . * if @xmath120 , say @xmath121 , then @xmath122 for @xmath123 , by induction .",
    "the cases @xmath124 can be verified by inspection .",
    "this completes the proof that @xmath2 .",
    "it remains to see that @xmath4 infinitely often .",
    "we do this by showing that @xmath4 for @xmath8 of the form @xmath125 , @xmath126 .",
    "let us prove this by induction on @xmath50 .",
    "it is true for @xmath127 since @xmath118 .",
    "otherwise @xmath128 , and using ( [ eq2 ] ) we have @xmath129 by induction .",
    "this also implies the claim @xmath90 .",
    "we can carry out similar computations for other famous sequences . in some cases the automata and the corresponding matrices are very large , which renders the computations time - consuming and the asymptotic behavior less transparent .",
    "we report on some of these computations , omitting the details .",
    "let @xmath130 denote the rudin - shapiro sequence , defined by @xmath131 the number of occurrences , taken modulo @xmath5 , of ` 11 ' in the binary expansion of @xmath8 .",
    "let @xmath132 denote the number of unbordered factors of length @xmath8 in @xmath133 .",
    "then @xmath134 for all @xmath64 . furthermore if @xmath135 , then @xmath136 for @xmath137 .",
    "let @xmath138 be the so - called `` period - doubling '' sequence , defined by @xmath139 where @xmath140 is the thue - morse word @xmath31 .",
    "note that @xmath141 is the fixed point of the morphism @xmath142 and @xmath143 .",
    "then @xmath144 , the number of unbordered factors of @xmath141 of length @xmath8 , is equal to @xmath5 for all @xmath64 .",
    "the period - doubling sequence can be generalized to base @xmath145 , as follows : @xmath146 where @xmath147 is the exponent of the largest power of @xmath0 dividing @xmath148 . for each @xmath0 ,",
    "the corresponding sequence @xmath149 is a binary sequence that is @xmath0-automatic :        if @xmath156 , then @xmath157 . if @xmath158 we have @xmath159 . hence if @xmath160 , then @xmath161 = 0^{k-1 } \\ , 1 $ ] , while if @xmath162 , then @xmath161 = 0^k$ ] .",
    "it follows that @xmath149 is the fixed point of @xmath150 .",
    "if @xmath26 is a factor of @xmath149 , then it is a factor of some prefix @xmath176 $ ] for some @xmath126 .",
    "so it suffices to show that @xmath176^r$ ] appears as a factor of @xmath149 .",
    "in fact , we claim that @xmath177^r = { \\bf p}_k [ k^i - 1 .. 2k^i - 2].\\ ] ]        * if @xmath26 is an unbordered factor of @xmath149 and @xmath182 , then @xmath183 or @xmath184 , for some unbordered factor @xmath148 of @xmath149 with @xmath185 . * if @xmath26 is an unbordered factor of @xmath149 and @xmath186 for @xmath187 , then @xmath188 or @xmath189 , for some unbordered factor @xmath148 of @xmath149 with @xmath190 .",
    "suppose @xmath192 = 0 $ ] .",
    "since @xmath193 is unbordered , we have @xmath194 = 1 $ ] . then @xmath195 , so @xmath196 for some @xmath197",
    ". then @xmath198 is a multiple of @xmath0 , so @xmath199 , where @xmath200 $ ] .",
    "note that @xmath185 .",
    "finally , lemma  [ unbl ] shows that @xmath148 is unbordered .",
    "suppose @xmath192 = 1 $ ] .",
    "since @xmath26 is unbordered , we have @xmath201 = 0 $ ] . from lemma  [ rev ] we know that @xmath175 is also a factor of @xmath149 ( and",
    "also is unbordered ) . then from the previous paragraph",
    ", we see that @xmath202 for some unbordered factor @xmath148 of @xmath149 , with @xmath203 .",
    "then @xmath184 , as desired .",
    "suppose that @xmath192 = 0 $ ] .",
    "since @xmath26 is unbordered , we know that @xmath205 = 1 $ ] . then @xmath206 , so @xmath207 for some @xmath197",
    ". then @xmath208 is a multiple of @xmath0 . hence",
    "@xmath209 =       \\varphi_k ( { \\bf p}_k [ ( i+a)/k - 1 .. ( i+a)/k + n-1 ] ) .\\ ] ] let @xmath210 $ ] .",
    "then @xmath188 , and @xmath211 .",
    "if @xmath148 is bordered , then using lemma  [ unbl ] we have that @xmath212 has a border of length @xmath213 , so @xmath26 has a border of length at least @xmath214 , a contradiction .",
    "suppose that @xmath192 = 1 $ ] .",
    "since @xmath26 is unbordered , we know that @xmath205 = 0 $ ] . then by lemma  [ rev ] we know that @xmath175 is also an unbordered factor of @xmath149 . then from the previous paragraph",
    ", we get that @xmath215 for some unbordered factor @xmath148 of @xmath149 where @xmath216 .",
    "so @xmath217 , as desired .      if @xmath221 then @xmath222 .",
    "suppose @xmath171 is bordered ; then there exist @xmath223 and @xmath224 such that @xmath225 . since @xmath226 , we know @xmath227 ends in @xmath29 .",
    "but since @xmath227 is a prefix of @xmath171 that ends in @xmath29 , it follows that @xmath228 , and so @xmath227 is the image of some word @xmath229 under @xmath150 .",
    "hence @xmath26 begins and ends with @xmath229 , a contradiction",
    ".    now assume @xmath230 and @xmath219 is bordered .",
    "then there exist @xmath223 and @xmath224 such that @xmath231 ; note that @xmath227 must end in @xmath29 .",
    "it follows that @xmath232 since @xmath233 and @xmath234 both end in @xmath29 and @xmath235 , we have @xmath236 .",
    "hence @xmath237 .",
    "it follows that @xmath238 ends in @xmath239 , so @xmath235 begins and ends in @xmath233 , a contradiction .",
    "first , we show that there is at least one unbordered factor of every length , by induction on @xmath8 .",
    "the base cases are @xmath240 , and are left to the reader .",
    "otherwise @xmath241 .",
    "write @xmath242 where @xmath220 . by induction",
    "there is an unbordered word @xmath26 of length @xmath243 . using lemma  [ rev ]",
    ", we can assume that @xmath26 begins with @xmath29 and ends with @xmath45 , say @xmath218 .",
    "by lemma  [ ham5 ] we have that @xmath219 is unbordered , and it is of length @xmath244 .          if @xmath251 , then by lemma  [ ham ] ( a ) , we know that either @xmath252 or @xmath253 , where @xmath148 is an unbordered factor of length @xmath254 . by induction there are exactly @xmath5 unbordered factors of length @xmath254 ; by lemma  [ rev ] they are reverses of each other .",
    "let @xmath148 be such an unbordered factor ; since @xmath255 , either @xmath148 begins with @xmath45 and ends with @xmath29 , or begins with @xmath29 and ends with @xmath45 . in the former case ,",
    "the image @xmath199 begins and ends with @xmath45 , a contradiction .",
    "so @xmath148 begins with @xmath29 and ends with @xmath45 .",
    "but there is only one such factor , so there are only two possibilities for @xmath26 .",
    "otherwise let @xmath256 ; then @xmath187 . by lemma  [ ham ] ( b ) , we know that @xmath188 or @xmath189 , where @xmath148 is an unbordered factor of length @xmath257 . by induction there are exactly @xmath5 such unbordered words ; by lemma  [ rev ] they are reverses of each other .",
    "let @xmath148 be such an unbordered factor ; then either @xmath148 begins with @xmath45 and ends with @xmath29 , or begins with @xmath29 and ends with @xmath45 .",
    "let us call them @xmath258 and @xmath259 , respectively , with @xmath260 .",
    "now @xmath261 begins with @xmath262 , and ends with @xmath239 .",
    "hence , provided @xmath263 , we see that @xmath264 begins with @xmath45 and ends with @xmath45 , a contradiction . if @xmath265 , lemma  [ ham ] ( b ) gives the two factors @xmath266 and",
    "the former begins with @xmath29 and ends with @xmath45 ; the latter begins with @xmath45 and ends with @xmath29 .    in the latter case",
    ", @xmath259 begins with @xmath29 and ends with @xmath45 .",
    "there is only one such @xmath259 ( by induction ) , and then either @xmath268 or @xmath269 , giving at most two possibilities for @xmath26 . in the case",
    "@xmath265 , these two factors would seem to give a total of four factors of length @xmath8 . however , there are only two , since @xmath270 this completes the proof .",
    "e.  charlier , n.  rampersad , and j.  shallit .",
    "enumeration and decidable properties of automatic sequences . in _",
    "dlt 2011 _ , vol .",
    "6795 of _ lecture notes in computer science _ , pp . 165179 .",
    "springer - verlag , 2011 ."
  ],
  "abstract_text": [
    "<S> we illustrate a general technique for enumerating factors of @xmath0-automatic sequences by proving a conjecture on the number @xmath1 of unbordered factors of the thue - morse sequence . </S>",
    "<S> we show that @xmath2 for @xmath3 and that @xmath4 infinitely often . </S>",
    "<S> we also give examples of automatic sequences having exactly @xmath5 unbordered factors of every length . </S>"
  ]
}