{
  "article_text": [
    "in the past decade tremendous progress has been made toward understanding the genetic basis of disease .",
    "this challenging endeavor has given rise to numerous study designs with a vast arsenal of statistical machinery . a  common theme , however , is the pivotal role played by familial relationships . traditionally relationships are encoded in pedigrees of known relatives [ thompson ( @xcite ) , @xcite , @xcite , @xcite ] , but for more distantly related individuals , pedigree information can sometimes be erroneous or difficult to obtain .",
    "relatedness can also be calculated from large panels of genetic markers [ @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite ] . while this approach has greatly expanded the scope of inference for relationships , empirical estimates are noisy , especially regarding distant relatives .",
    "the search for a disease gene begins with finding unusual sharing of genetic material among individuals who share a trait ( phenotype ) .",
    "linkage analysis involves the study of joint inheritance of genetic material and phenotypes within relatives [ @xcite , @xcite ] .",
    "typically , these studies are restricted to relatives within a pedigree , but more recently the approach has been extended to samples of people who are more distantly related and without known pedigree structure [ @xcite ] .",
    "alternatively , genetic associations can be discovered from population samples , which are usually based on case  control studies . in these studies the sample",
    "is assumed to be unrelated , but the presence of distant relatives ( i.e. , cryptic relatedness ) can reduce power or generate spurious associations [ @xcite , @xcite ] .",
    "numerous methods have been proposed to deal with familial structure in genetic association studies [ @xcite , @xcite , @xcite , @xcite ] , all of which require an estimate of family relationships among individuals within the study .",
    "relationships are also critical for quantitative genetics .",
    "a common problem for quantitative genetics is to estimate the fraction of variance of a continuous trait , such as height , due to genetic variation amongst individuals in a population .",
    "this feature , known as heritability , delineates the relative contributions of genetic and nongenetic factors to the total phenotypic variance in a population .",
    "heritability is a fundamental concept in genetic epidemiology and disease mapping . using a variety of close relatives",
    ", the heritability of quantitative and qualitative traits can be estimated directly [ @xcite , @xcite ] . with complex pedigrees , applying the same principles , heritability can be estimated using random effects models [ @xcite ] .",
    "heritability of height , weight , iq and many other quantitative traits have been investigated for nearly a century and continue to generate interest [ @xcite ] .",
    "interest in the genetic basis of disease is high because greater understanding of disease etiology will in principle lead to better treatments .",
    "large population - based samples are enhancing our ability to identify dna variants affecting risk for disease and it has become the standard to search for genetic variants associated with common disease using genome - wide association studies ( gwas ) .",
    "thousands of associations for common diseases / phenotypes have already been validated [ @xcite ] . nevertheless , even in the most successful cases , such as inflammatory bowel disease studied in @xcite and @xcite ,",
    "discoveries account for only a fraction of the heritability .",
    "given the relatively limited discoveries thus far , a reasonable question is whether the heritability of a trait estimated from relatives truly does trace to genetic variation .",
    "@xcite offer a novel approach to genetic analysis that shows that indeed much of it does .",
    "they propose to analyze population samples , rather than pedigrees , for the heritability of the trait .",
    "to do so they first estimate the correlation between all pairs of individuals in the population sample using a dense set of common genetic variants , such as those typically used for a gwas .",
    "they then take this matrix and relate it to the covariance matrix of phenotypes for these subjects to derive an estimate of heritability .",
    "thus , in their application , where essentially all relatives are removed from the sample , heritability refers to the proportion of variance in the trait explained by the measured genetic markers .",
    "they provide a fascinating example of how this approach works in the case of human height and they and others applied these techniques to many other traits [ reviewed by @xcite ] .    the work of yang et al .",
    "( @xcite ) inspired us to consider applying a related approach to answer a different question .",
    "could estimates of relatedness obtained from a population sample be improved by using smoothing techniques on the variance  covariance matrix ?",
    "if so , population samples could be used to estimate heritability  in the traditional sense  without requiring close relatives .",
    "this approach has application to phenotypes for which extended pedigrees are difficult to obtain . for instance , there is controversy in the literature concerning the heritability of autism , which is typically estimated from twin studies [ @xcite ] .",
    "smoothing techniques could also be used to estimate relatedness in samples of distantly related individuals for many other genetic analyses .",
    "for example , a version of linkage analysis could be applied to distant relatives .",
    "we propose treelet covariance smoothing  a novel method for smoothing and multiscale decomposition of covariance matrices  as a means to improving estimates of relationships .",
    "treelets were first introduced in @xcite and @xcite as a multi - scale basis that extends wavelets to unordered data .",
    "the method is fully adaptive .",
    "it returns orthonormal basis functions supported on nested clusters in a hierarchical tree . unlike other hierarchical methods , the basis and the tree structure are computed simultaneously , and both reflect the internal structure of the data .    in this work",
    ", we extend the original treelet framework for smoothing of one - dimensional signals to smoothing and denoising of variance  covariance matrices with hierarchical block structure and unstructured noise .",
    "smoothing is achieved by a nonlinear approximation scheme in which one discards small elements in a multi - scale matrix decomposition .",
    "the basic idea is that if the data have underlying structure in the form of groupings of correlated variables , then we can enforce sparsity by first transforming the data into a treelet representation by a series of rotations of pairs of correlated variables , and then thresholding covariances .",
    "we refer to this new regularization approach for covariance matrices with groupings on multiple scales as _ treelet covariance smoothing _",
    "( tcs ) .",
    "we apply tcs to genetically inferred relationship matrices , with the goal of improving estimates of pairwise relationships from large pedigrees and population - based samples . on both simulated and real data ,",
    "we show that tcs leads to better estimates of the relatedness between individuals .",
    "using these estimates allows us to estimate the heritability from population - based samples provided they include some distantly related individuals , a property that is almost inevitable in practice .",
    "finally , we discuss how estimating heritability is simply a case of variance component estimation for an error - in - variables random effects model .",
    "therefore , our method can be applied to a whole family of more general models of similar structure .",
    "the human genome contains many millions of single nucleotide polymorphisms ( snps ) and other genetic variation distributed across the genome . in a gwas",
    "it is now typical to measure a panel of at least 500,000 snps from each subject .",
    "snps typically have only two forms or alleles within a population .",
    "whichever allele is less frequent is called the minor allele .",
    "the genotype of an individual at a snp can then be coded as 0 , 1 or 2 depending on the number of minor alleles the individual has at that snp .",
    "alleles at snps in close physical proximity are often highly correlated ( i.e. , in linkage disequilibrium ) . when multiple snps are in linkage disequilibrium , we say one of these snps `` tags , '' or represents , the others .",
    "although estimates vary , well - designed panels of 500,000 snps do not tag all of the common snps in the genome and they tag very few of the snps with rare minor alleles [ @xcite ] . nevertheless , gwas provide considerable information about familial relationships .",
    "the relatedness between a pair of individuals is defined by the frequency by which they share alleles _",
    "identical by descent _",
    "formally , two alleles are considered ibd if they descended from a common ancestor without an intermediate mutation . within a pedigree relatives",
    "share very recent common ancestors , hence , many alleles are ibd . for a more detailed exposition of genetic relationships , see @xcite .",
    "the quantity of interest in this investigation is the _ additive genetic relationship _ which is defined as the expected proportion of alleles ibd for a pair of individuals . for individuals @xmath0 and @xmath1 we use @xmath2 to denote this quantity , which is more familiar when viewed as the _ degree of relationship _ , where @xmath3 .",
    "for example , for siblings , first cousins and second cousins , who are 1st , 3rd and 5th degree relatives , @xmath4 is @xmath5 , @xmath6 and @xmath7 , respectively . within a noninbred pedigree @xmath4 can be computed using a recursive algorithm [ @xcite ] .",
    "for example , if individual @xmath0 has parents @xmath8 and @xmath9 , then @xmath10 .    for distantly related individuals ,",
    "detailed pedigree information is not often available ; however , with gwas data one can calculate genome - average relatedness directly [ @xcite ] . even with complete information regarding ibd status of the chromosomes ,",
    "the fraction of genetic material shared by relatives will differ slightly from the expectation calculated from the pedigree due to the stochastic nature of the meiotic process [ @xcite ] .",
    "for the purpose of genetic investigations , one could argue that genome - average relatedness is a truer measure of relatedness .",
    "for example , while two distantly related individuals are expected to share a small fraction of their genetic material , if they do not inherit anything from their common ancestor , it seems appropriate to consider them unrelated .    under many population genetic models @xmath2",
    "can also be interpreted as a correlation coefficient .",
    "let @xmath11 denote the scaled minor allele count for individual @xmath0 at snp @xmath8 : @xmath12 , where @xmath13 is the minor allele count and @xmath14 is the minor allele frequency . for individuals",
    "@xmath0 and @xmath1 at genetic variant @xmath8 , it follows from our model that @xmath15 = a_{ij}. \\label{eqsnpcov}\\ ] ]    exploiting this feature leads to a method of moments estimate of @xmath4 from a panel of @xmath16 genetic markers . to see this ,",
    "let @xmath17 denote a column vector of observed scaled allele counts for all individuals at the @xmath8th snp , then let @xmath18 where @xmath19 .",
    "the genome - wide complex trait analysis ( gcta ) software from @xcite computes this estimator .",
    "the method of moments estimator is unbiased if the population allele frequencies are known [ @xcite ] . in practice ,",
    "the @xmath14 s are estimated from the sample data .",
    "a criticism of this estimator is that some off - diagonal elements are negative , which does not conform to the interpretation of @xmath2 as a probability .",
    "viewed as a correlation coefficient , however , negative quantities suggest the pair of individuals share fewer alleles than expected given the allele frequencies .",
    "alternatively , maximum likelihood estimators of @xmath4 have been developed [ @xcite , @xcite ] , but these estimators are quite computationally intensive for gwas panels . hence , while method of moments estimators are typically less precise than maximum likelihood estimators , they are more commonly used when a large snp panel is available .      by definition ,",
    "the heritability of a quantitative trait ( @xmath20 ) such as height is determined by the additive effect of many genes and genetic variants ( @xmath21 ) , each of small effect ( i.e. , the polygenic model ) . for individuals",
    "@xmath22 , suppose that the genetic effects are explained by @xmath23 causal snps , and we can express the genetic effect as @xmath24 where @xmath25 is the additive random effect of the @xmath1th causal variant , weighted by the scaled number @xmath26 of minor alleles at this variant .",
    "let @xmath27 be the vector of random effects corresponding to the additive genetic effects for individuals @xmath22 .",
    "for @xmath28 and @xmath29 $ ] , we write @xmath30 . define @xmath31 as the variance  covariance matrix of @xmath32 .",
    "assuming @xmath33= i\\sigma^2_u$ ] , it follows that @xmath34 where @xmath35 .    in the traditional model for quantitative traits a continuous phenotype @xmath20 is modeled as @xmath36 where @xmath37 is the vector of residual effects , and @xmath38 is the vector of phenotypes . in matrix notation , @xmath39 .",
    "the residuals are assumed to be independent with variance  covariance equal to @xmath40 and the random effects and residual error are assumed to be normally distributed .",
    "consequently , @xmath41 = \\frac{z_cz_c^t}{j}\\sigma^2_g + i \\sigma_e^2 . \\label{eqknownzc}\\",
    "] ] the heritability of the phenotype @xmath20 is defined as @xmath42 this quantity is more accurately known as the additive or narrow - sense heritability , in contrast to the broad - sense heritability , which includes nonadditive genetic effects such as gene  gene interactions .",
    "our inferences will be confined to narrow - sense heritability .",
    "if the causal snps ( or good tag snps ) and the phenotype were directly measured , then one could estimate @xmath43 based on equation ( [ eqqtmodel ] ) and the implied random effects model using maximum likelihood ( reml ) [ @xcite ] .",
    "notationally , @xmath44 is an @xmath45 matrix that picks out @xmath23 columns of the full snp panel @xmath46 . in practice",
    ", @xmath44 is not known .",
    "few of the causal snps are known for any phenotype , and many causal snps will be missing from @xmath46 ( i.e. , not tagged by any measured snps ) .",
    "how then is @xmath43 estimated in practice ?",
    "assuming various subsets of individuals in the sample are related with relationship matrix @xmath4 ( defined previously ) , heritability can be estimated without any knowledge of causal genetic variants that constitute @xmath32 . from equation  ( [ eqsnpcov ] ) and the polygenic model it follows that @xmath47 as @xmath23 gets large .",
    "this inspires an alternative random effects model which has long been utilized in population genetics : @xmath41 = a\\sigma^2_g + i \\sigma_e^2 . \\label{equnknownzc}\\ ] ] historically , @xmath4 has been derived from known pedigree structure .",
    "however , provided some subsets of the individuals in the sample are related ( even distantly ) , one can estimate @xmath4 from genetic markers using either method of moments or maximum likelihood estimation techniques .",
    "this approach has been applied frequently in quantitative genetics , especially in breeding studies [ @xcite , @xcite , @xcite , @xcite ] .",
    "we conjecture that by using tcs , we can improve estimates of @xmath4 and obtain better estimates of heritability without knowledge of causal variants .    alternatively ,",
    "if the sample is completely unrelated , then substituting the result of equation  ( [ eqzzprime ] ) for ( [ eqknownzc ] ) does not lead to an estimate of @xmath43 unless all of the causal snps have been recorded . instead this approach estimates @xmath48 , the proportion of the variance in phenotype explained by the snp panel [ @xcite ] . in this",
    "setting , tcs will not improve estimates of @xmath49 .",
    "the genetic relationship matrix @xmath4 is a measure of the additive covariance structure that exists between individuals due to a common genetic background .",
    "we estimate the relationship matrix using genotyped snps , but this estimate is usually noisy .",
    "hence , we propose a method for improving upon this estimate using treelets .",
    "treelets simultaneously return a hierarchical tree and orthonormal basis functions supported on _ nested clusters _ in the tree  both reflect the underlying structure of the data . here",
    "we extend the original treelet framework [ @xcite , @xcite ] for smoothing one - dimensional signals and functions , to a new means of smoothing and denoising variance  covariance matrices with hierarchical block structure and unstructured noise .",
    "the main idea is to first move to a different basis representation through a series of local transformations , and then impose sparsity by thresholding the transformed covariance matrix .",
    "we refer to the approach as treelet covariance smoothing ( tcs ) .",
    "the general setup is as follows .",
    "[ see appendix in @xcite for details on how to compute the treelet transformation .",
    "the treelet algorithm , as well as its implementation , is available in r on cran as the ` treelet ` library . ]",
    "let @xmath50 be a random vector in @xmath51 with variance  covariance matrix @xmath52 . in our context",
    ", @xmath50 represents the scaled minor allele counts for a set of @xmath53 individuals at any snp , and the covariance @xmath54 , the additive genetic relationship matrix of the @xmath53 individuals [ equation  ( [ eqsnpcov ] ) ] .",
    "now at each level of the treelet algorithm , we have an orthonormal multiscale basis .",
    "let @xmath55 denote the basis at the top of the tree [ corresponding to level @xmath56 if using the notation in @xcite ] .",
    "we write @xmath57 where @xmath58 represent the orthogonal projections onto local basis vectors on different scales .",
    "it follows that the covariance of @xmath50 can be written in terms of a _ multi - scale matrix decomposition _",
    "@xmath59 where @xmath60 and @xmath61 . the first term in equation  ( [ eqcov ] )",
    "describes the diagonally symmetric block structure of the variance  covariance matrix .",
    "these blocks are organized in a hierarchical tree .",
    "the second term describes a more complex structure , including off - diagonal rectangular blocks , which are also hierarchically related to each other in a multi - scale matrix decomposition .    in practice ,",
    "the covariance @xmath52 is unknown , and both the covariance matrix and the treelet basis need to be estimated from data . for relationship matrices , one can , for example , derive an estimate @xmath62 from marker data using method of moments or maximum likelihood methods .",
    "denote the treelet basis derived from @xmath63 by @xmath64 , and write @xmath65 where @xmath66 and @xmath67 .",
    "let @xmath68 be the covariance estimate after a treelet transformation , that is , after applying a full set of @xmath69 jacobi rotations of pairs of correlated variables .",
    "a  calculation shows that @xmath70_{ii }   \\qquad   \\mbox{and}\\qquad     \\widehat { \\gamma}_{i , j } = \\widehat { \\operatorname{cov}}(c_i , c_j ) = \\bigl[t(\\widehat{\\sigma})\\bigr]_{ij } , \\label{eqtreeletcoeffs}\\vspace*{-1pt}\\ ] ] where @xmath71 and @xmath72 .",
    "this suggests and @xmath73 , where @xmath74 denotes the kronecker delta function , corresponds to simple thresholding of the original covariance estimate .",
    "here we consider more general groupings of correlated variables on different scales . ]",
    "a smoothed estimate of the covariance by thresholding : @xmath75\\widehat{\\mathbf{v}}_i(\\widehat { \\mathbf{v}}_i)^t + \\sum_{i\\ne j}^nf_\\lambda [ \\widehat{\\gamma}_{i , j}]\\widehat{\\mathbf{v}}_i(\\widehat { \\mathbf{v}}_j)^t , \\label{eqcovsmooth}\\ ] ] with the thresholding function @xmath76 = \\cases { a , & \\quad $ \\mbox{when $ |a| \\ge\\lambda$},$ \\vspace*{2pt}\\cr 0 , & \\quad $ \\mbox{when $ |a| < \\lambda$,}$ } \\label{eqcovthresholding}\\ ] ] where @xmath77 is a smoothing parameter .    to summarize and in matrix short - hand notation ,",
    "the smoothed genetic relationship matrix is given by @xmath78 b^t , \\label{eqasmoothmat}\\ ] ] where @xmath79 and @xmath80 , respectively , denote the treelet basis and the covariance matrix at the top of the tree , and @xmath81 corresponds to element - wise thresholding [ equation  ( [ eqcovthresholding ] ) ] .",
    "note that to compute @xmath82 we only need to know the jacobi rotations at each level of the tree , more precisely , the treelet basis , @xmath83 , where the jacobi rotation matrix @xmath84 is the rotation matrix at level @xmath85 .",
    "the covariance estimate after a treelet transformation and before smoothing is @xmath86 .",
    "the goal is to choose a threshold ( @xmath77 ) that reduces noise in the estimated relationships .",
    "traditional cross - validation is not an option because we can not predict @xmath2 without including persons @xmath0 and @xmath1 .",
    "alternatively , we have an abundance of genetic information from which to estimate @xmath87 .",
    "we propose a snp subsampling procedure to estimate the tuning parameter .",
    "we begin by breaking the genome into independent _ training _ and _ test _ sets by randomly placing half the chromosomes into each set . to improve the efficiency of our estimate of @xmath4 , we utilize a `` blackout window '' of length @xmath88 to avoid sampling snps that are highly correlated",
    ". this @xmath88 can be considered either in terms of physical location along the chromosome or the number of snps between any two snps in question . from the set of training chromosomes ,",
    "select a relatively large sample of @xmath89 independent snps to get a reliable estimate of @xmath87 .",
    "we train our algorithm by smoothing @xmath87 using tcs to get @xmath90 , for all @xmath91 , where @xmath92 is a grid of reasonable threshold values .",
    "once we have @xmath90 , for a given @xmath77 , we subsample @xmath93 snp sets of size @xmath8 from the test set of chromosomes . here ,",
    "@xmath94 and the snps within each of the @xmath93 subsampled sets follow our defined blackout window , @xmath88",
    ". then , for all @xmath95 , estimate the relationship matrix , @xmath96 , based on the subset of snps .",
    "we then compare our smoothed relationship matrix , @xmath97 , from the training chromosomes to each of the @xmath93 nonsmoothed relationship matrices , @xmath96 , via a weighted risk function : @xmath98 where @xmath99 is a weight associated with each element in @xmath4 .",
    "clearly , the optimal tuning parameter is @xmath100 .",
    "the reason for introducing the weighting scheme is because many subjects are nearly unrelated .",
    "thus , we aim to upweight the loss function so that the preponderance of near - zero elements in the off - diagonal do not overwhelm the loss function .",
    "we suggest using the learned hierarchical tree to get the weights .",
    "more specifically , @xmath101_{ij}|$ ] , corresponding to the absolute value of the correlations between the final groupings of individuals after @xmath69 rotations [ equation  ( [ eqtreeletcoeffs ] ) ] . also , we set @xmath102 because we are not interested in estimating inbreeding coefficients .",
    "it should be noted that this is a rather general weighting method .",
    "other schemes may be more appropriate if there is a priori information suggesting the importance of particular relationships .",
    "to produce realistic simulations , we started with the phased genomes ( haplotypes ) of individuals from the hapmap 3 database , selecting two populations with european ancestry ( ceu and tsi ) . utilizing the small sample of available haplotypes ,",
    "our first objective was to generate a large sample of haplotypes , representative of those that might be sampled from unrelated founders of a population .",
    "the challenge was to keep intact the realistic haplotype structure for a human population , including linkage disequilibrium ( ld ) , without generating unusual sharing between the founders . to accomplish this goal",
    ", we took the hapmap data on ceu and tuscan samples , which were phased quite accurately into haplotypes , as the initial sample of chromosomes from which to generate founders . now",
    "each founder haplotype was created by sampling pieces of chromosomes ( or haplotypes ) from the initial sample .",
    "to do so , the number of recombination spots per chromosome was determined using an overall recombination of @xmath103 per mb , which is 100 times the normal rate of recombination for humans .",
    "the actual location of the recombination spots were then determined using the recombination map provided by hapmap , a procedure that successfully keeps intact the ld structure of the chromosome . from this pool of generated haplotype pairs ,",
    "chromosomes were randomly assigned to each of the 39 founders in each of 100 families .",
    "these founder chromosomes were then dropped through a seven generation pedigree ; see figure [ figpedigree ] for the pedigree of a single family used for simulations . at each generation",
    "the chromosomes underwent recombination with an overall rate of @xmath104 at locations determined by hapmap s recombination map . within each pedigree ,",
    "the genotype information of twenty individuals was collected ( colored yellow ) .",
    "we then sampled ten individuals of varying relatedness from this group with a random sampling strategy that favored individuals of distant relatedness within the pedigree .",
    "the highest pairwise relatedness within a family is 0.125 , corresponding to @xmath105 , and the lowest is @xmath106 .",
    "individuals from different families are unrelated .",
    "each simulation produced a total of 1000 individuals made up of 100 ten - member families of varying levels of relatedness .",
    "finally , the entire process was repeated fifty times .        because we know the pedigree structure , we can compare the unsmoothed estimate @xmath87 to @xmath107 found via tcs . here",
    ", we use the gcta software [ @xcite ] to estimate @xmath87 using 100,000 randomly chosen snps with maf @xmath108 .",
    "the optimal level of smoothing ( @xmath109 ) is chosen via the subsampling scheme described previously using @xmath110 , @xmath111 , @xmath112 , @xmath113 and repeating everything ten times . here",
    ", @xmath88 is in terms of number of snps .",
    "we choose @xmath109 by examining a plot of @xmath114 across a grid of @xmath77 values .",
    "the optimal smoothing parameter is the one that minimizes the risk function , @xmath115 .",
    "for one such simulation sample we can see from figure  [ figcv ] that @xmath116 .    .",
    "the optimal @xmath77 is the point where the @xmath114 ( cv score ) is minimized . ]    ) along with smoothed using tcs ( @xmath117 ) and simple thresholding ( @xmath118 ) at increasing degrees of relatedness ( @xmath119 ; see header ) . here , tcs is better than simple thresholding as the latter method thresholds too aggressively . ]    ) along with smoothed using tcs ( @xmath117 ) and simple thresholding ( @xmath118 ) at increasing degrees of relatedness ( @xmath120 )",
    ". also included is the comparison of rmse values for unrelated pairs ( @xmath121 ) and average rmse for the entire relationship matrix ( @xmath122 ) .",
    "we see that both thresholding methods remove noise , but tcs works better than simple thresholding overall . ]",
    "the question then becomes , does tcs improve estimates of relatedness ? figures  [ figrmse46 ] and [ figrmse7 t ] display boxplots comparing the root mean square error ( rmse ) of @xmath123 to @xmath107 at varying levels of known pairwise relationship values . for a full comparison",
    ", we have included two smoothing methods : tcs , as previously described , as well as `` simple thresholding , '' wherein the elements of @xmath124 are directly thresholded .",
    "[ the latter approach is a degenerate case of tcs models , at level @xmath125 , for which the basis is the dirac basis , i.e. , @xmath126 for @xmath127 in equations  ( [ eqtreeletdecomp])([eqasmoothmat ] ) . ]",
    "moving from left to right in the figures , the true degree of relatedness increases from @xmath128 , to no relatedness . over the entire matrix of estimates , the rmse is 0.0055 , 0.0015 and 0.0019 for the unsmoothed ( @xmath87 ) , tcs ( @xmath129 ) and simple thresholding ( @xmath118 ) methods respectively , demonstrating an overall advantage of tcs .",
    "as with many shrinkage methods , tcs introduces a slight bias that is reflected in a higher rmse for closely related individuals .",
    "consequently , tcs has a larger rmse than the unsmoothed estimate for smaller values of @xmath130 . where tcs gains a notable advantage over the unsmoothed estimate is in differentiating between more distantly related individuals and noise .",
    "from figures  [ figrmse46 ] and  [ figprop0 ] we can see that simple thresholding incurs a substantially larger rmse for closer relationships because it thresholds too aggressively . for @xmath131 ,",
    "70% of the pairs are zeroed out , and for @xmath132 virtually all pairs are zeroed out .",
    "naturally , this method has the smallest rmse for the sample of unrelated pairs because thresholding zeros out all of these entries .",
    "notably , tcs does almost as well in this setting",
    ". a  direct comparison of rmse does not fully reflect the true loss incurred in practice . in most genetic studies",
    "close relatives are often recorded in pedigrees and , hence , estimates are not required .",
    "alternatively , considering distant relatives to be unrelated leads to a substantial loss for estimating heritability and most other genetic applications .    ) , smoothing using tcs ( @xmath133 ) and simple thresholding ( @xmath134 ) .",
    "the three cases are compared at increasing degrees of relatedness ( @xmath135 ) .",
    "any value below @xmath136 is considered to be 0 . ]",
    "body mass index ( bmi ) is one of several traits measured as part of the study entitled `` whole genome association study of visceral adiposity '' as part of the health aging and body composition ( health abc ) study .",
    "these data are archived in the database for genotypes and phenotypes ( dbgap ) .",
    "we restrict our attention to those 1644 individuals with self - reported european ancestry . to control for confounding , prior to analysis",
    ", we adjust bmi scores by regressing out age , gender and collection site .",
    "our objective is to estimate heritability of bmi from this population sample .",
    "published heritability estimates range from as low as 0.05 to as high as 0.90 [ @xcite ] ; however , based on estimates derived from known pedigrees , the heritability of bmi is estimated to be approximately 5075% [ @xcite , @xcite ] .    from the full sample of snps ( illumina 1 m platform )",
    "we remove those with missingness greater than 0.1% and maf @xmath137 . from these",
    "we select a subpanel of @xmath138 snps , chosen to be nearly evenly spaced .",
    "based on these snps , we calculated the relationship matrix @xmath123 , and find that the individuals are predominately unrelated .",
    "the most highly related pair appear to be third degree relatives , such as first cousins .",
    "and more than half of the pairs appear to be more distantly related than 10th degree relatives .    to estimate the heritability in this setting , we input the smoothed relationship matrix in equation  ( [ eqcovsmooth ] ) into the reml algorithm .",
    "the required smoothing parameter @xmath77 is selected in two ways : ( i ) minimizing the loss function in equation  ( [ eqpicklambda ] ) via the subsampling approach ; and ( ii ) using a profile likelihood approach . with both techniques , we get estimates of the heritability that are very close to what is found in the literature .    for a range of smoothing parameters , @xmath139 ,",
    "we calculate the smoothed relationship matrix , @xmath140 , and plug this value into the reml model to obtain a profile likelihood ( figure  [ figbmiavfd ] ) .",
    "also plotted in this figure is @xmath141 , the heritability that maximizes reml as a function of @xmath77 ( or minimizes2 times the log - likelihood ) . without smoothing @xmath142 , which is not shown in the plot , @xmath143 .",
    "smoothing the relationship matrix results in an increasing estimate of the heritability which stabilizes at about 70% .",
    "further smoothing beyond the range displayed leads to a numerically unstable optimization problem and diminished likelihood . using the profile likelihood approach ,",
    "@xmath77 is chosen to be the point at which reml is maximized .",
    "this method results in an estimate of @xmath144 corresponding to @xmath145 .",
    "smoothing using our snp subsampling scheme results in @xmath146 and @xmath147 .    .",
    "the dashed curve is @xmath148 , where , @xmath149 is the maximum profile likelihood obtained from the reml algorithm .",
    "the solid vertical line is the optimally chosen threshold value using our subsampling scheme .",
    "the dashed vertical line represents the optimally chosen threshold value when minimizing the likelihood profile . : for bmi , @xmath150 when using subsampling to choose an optimal smoothing parameter @xmath151 .",
    "similarly , @xmath152 when using the profile likelihood plot @xmath153 . with no smoothing @xmath142 , @xmath154 .",
    "this is not shown on the plot . : for avfd , @xmath155 when using our subsampling approach to choose an optimal smoothing parameter .",
    "however , @xmath156 when using the profile likelihood plot @xmath157 . these are compared to @xmath158 , the heritability when there is no smoothing ( not shown ) . ]    for comparison , we have repeated the above experiments with an orthogonal basis computed by principal component analysis ( pca ) in lieu of a treelet basis .",
    "such an approach does not improve the estimates of family relationships or heritability . when noise is present , pca is unable to uncover the underlying sparse structure of the relationship matrix .",
    "in fact , the results with pca are identical to those without smoothing ( with the profile likelihood peaking when the tuning parameter is set to 0 ) .",
    "another trait that was measured in this study is the abdomen visceral fat density ( avfd ) .",
    "as was the case with bmi , we restricted our attention to individuals of european descent and regressed out age , sex and collection site . according to the literature",
    ", the heritability of avfd should be between 4570% [ @xcite ] . according to figure  [ figbmiavfd ]",
    ", one can see that using the smoothing parameter based on our subsampling scheme ( @xmath159 ) we get @xmath160 . on the other hand , exploiting the profile likelihood plot results in @xmath161 and @xmath162 . when no smoothing was used ( not shown in figure ) , @xmath163 .",
    "thus , both methods for choosing the smoothing parameter used in tcs resulted in estimates of the heritability that are closer to what is established in the literature than without smoothing .",
    "it is notable that @xmath164 for both traits increased toward the established estimate of heritability regardless of how we estimate the optimal smoothing parameter , because only a small fraction of the genome was sampled by the snp panel .",
    "thus , our results underscore the fact that the quantitative trait model given in equation  ( [ eqqtmodel ] ) does not require measurement of the causal snps that constitute equation  ( [ eqsnps ] ) .",
    "what is required is a good estimate of @xmath4 based on relatives .",
    "our analysis of bmi and avfd illustrates the difference between estimates of heritability in the traditional sense and estimates of @xmath49 , the heritability attributable to the snps in the panel . from equations  ( [ eqknownzc ] ) and ( [ equnknownzc ] )",
    "it is clear that heritability derived from the classic quantitative traits model can distinguish between variance explained by relatives and variance explained by causal snps only if either ( i ) all causal snps are excluded , or ( ii ) all relatives are excluded . because a large number of undiscovered snps scattered across the genome are likely to be causal , and large samples invariably contain distantly related individuals , some ambiguity will always be present .",
    "clearly , the @xmath138 snps in our panel do not explain a substantial fraction of the variation in bmi and yet we obtain an accurate estimate of heritability using tcs .",
    "the increase in estimated heritability of bmi from 23% to 72% suggests that smoothing improves the estimate of @xmath4 and that a substantial fraction of the correlation in bmi in our sample is due to genetic relatedness . in a similar study with a larger population sample @xcite estimated @xmath165 of bmi at 17% when using the full snp panel , but excluding all detectable relatives .",
    "assuming relatives were successfully removed , they conclude that approximately 17% of the variability in bmi is explained by common variants included or tagged by the snp panel .",
    "recently , there has been an upsurge of papers on sparse covariance matrix estimation ; see @xcite , @xcite and the references within . most of this research concerns the problem of estimating population covariance matrices from samples of multivariate data in the `` large @xmath166small  @xmath167 '' regime using banding or thresholding techniques in the original coordinate system .",
    "our setting is slightly different with a more complex data structure : we want to improve estimates of a large covariance matrix ( @xmath4 ) in which we expect a hierarchical block structure due to clustering of distantly related individuals .",
    "a noisy estimate of covariance is obtained from a large sample of snps , each of which contains very little information .",
    "this matrix is interpreted as the additive genetic relationship matrix and it can be used to infer degree of relationship between pairs of individuals .    we propose a new method , which we call treelet covariance smoothing ( tcs ) , for regularizing real symmetric matrices with hierarchical block structure and unstructured noise .",
    "we show how a subsampling strategy applied to snps can be used to choose the tuning parameter for the smoothing procedure . for simulated data ,",
    "we show that tcs does indeed improve estimates of family relationships . as an application",
    "we show how tcs can be used to estimate heritability of quantitative traits from a genome - wide sample of snps by smoothing relationships estimated from those snps .",
    "we then apply tcs to the problem of estimating the heritability of body mass index ( bmi ) and abdomen visceral fat density ( avfd ) in the health abc data set . in particular",
    ", bmi heritability is usually quoted to be at least 0.50 , but an estimate based on a noisy estimate of @xmath4 yields a much lower value of @xmath168 . by denoising the estimated relationship matrix with treelets , we increase the estimated heritability of bmi from @xmath168 to @xmath169 .",
    "avfd heritability analysis produces similar results .",
    "thus , a careful examination of heritability estimates using more distant relatives demonstrates that one may substantially improve relationship estimates using tcs .",
    "other covariance regularization schemes exist in the literature , but systematic comparison is beyond the scope of this work .",
    "direct application of regularization methods for a sample covariance matrix ( @xmath170 ) is sometimes further complicated if we do not have direct access to the multivariate data matrix @xmath44 .",
    "@xcite , for example , describe a state - of - the - art adaptive thresholding method for heteroscedastic problems that requires an estimate of the variability of the entries of a sample covariance matrix . to our knowledge , tcs is the only principled approach to regularization of general similarity matrices with block structure on multiple scales .",
    "in addition , the computed basis vectors themselves contain information of the internal structure of the data  a topic that we will explore in a separate paper with applications to complex extended pedigrees .",
    "one can also easily modify the tcs algorithm so that positive semi - definiteness is always guaranteed .",
    "our results are relevant to a recent area of burgeoning interest in genetics , namely , the estimation of heritability from population samples [ @xcite ] .",
    "however , our purpose is to estimate heritability , as traditionally defined , rather than to determine the fraction of variation explained by measured snps .",
    "we expect that the tcs - refined genetic relationships will find wide application to other problems in genetics , such as population - based linkage analysis [ @xcite ] , along with linear mixed models for testing association [ @xcite ] .",
    "furthermore , tcs can be applied to a whole family of mixed effects `` error - in - variables '' models of the form @xmath171 where @xmath172 is a vector of response variables ; @xmath173 is a vector of fixed effects ; @xmath174 represents random effects ; and @xmath175 is a vector of residual errors . in the general case , we assume that there are @xmath176 random effects , where each random effect originates from a specific distribution with zero mean and unknown variance . in vector - matrix notation",
    ", @xmath177 where @xmath178 is a @xmath179 vector whose elements are the levels of the @xmath0th random factor , @xmath180 , and @xmath181 is an @xmath182 matrix of regressors for the @xmath0th random factor .",
    "assuming @xmath183 and @xmath184 = \\left [ \\matrix { d & 0 \\vspace*{2pt}\\cr 0 & e } \\right],\\ ] ] where @xmath185 , yields @xmath186=w \\beta$ ] and @xmath41= zdz^t + e = \\sum _ { i=1}^c \\sigma_i^2 z_i z_i^t + e,\\ ] ] where the variance components @xmath187 and @xmath188 are unknown and to be estimated .",
    "now consider an _ error - in - variables _ scenario in which the matrix @xmath189 of regressors of fixed effects is known , but we only have _ noisy _ estimates of some or all of the positive semi - definite ( p.s.d . )",
    "matrices @xmath190 associated with the random effects .",
    "if these matrices have block structure and the noise is unstructured , then one could potentially improve estimates of variance components by first applying tcs . in our application , for example",
    ", we looked at a special case where we first estimate the p.s.d .",
    "matrix @xmath170 in an additive polygenic model using marker - based data , and then use a denoised estimate of @xmath170 to estimate the variance components , @xmath191 and @xmath192 in a random effects model where @xmath193 and @xmath194 .    in summary , we have introduced a new method , called treelet covariance smoothing ( tcs ) , that regularizes a relationship matrix estimated from a large panel of genetic markers . in the context of a gwas study a huge number of snps are measured , each of which provides information about the relationship between individuals in the sample .",
    "we proposed a snp subsampling procedure that exploits this rich source of information to choose a tuning parameter for the algorithm .",
    "we illustrated one instance of the utility of such estimates by substituting the resulting smoothed relationship matrix into a random effects model to estimate the heritability of body mass index .",
    "while others have used genetically inferred estimates of relatedness from samples of close relatives to estimate heritability , we believe this is the first time such estimates have been applied to population - based samples when the goal is to estimate heritability in the traditional sense .",
    "we would like to thank daniel weeks , nadine melhem and cosma shalizi for comments on the manuscript , elizabeth thompson for guidance in designing the simulations , and evan klei for assistance with the simulations ."
  ],
  "abstract_text": [
    "<S> recent technological advances coupled with large sample sets have uncovered many factors underlying the genetic basis of traits and the predisposition to complex disease , but much is left to discover . </S>",
    "<S> a common thread to most genetic investigations is familial relationships . </S>",
    "<S> close relatives can be identified from family records , and more distant relatives can be inferred from large panels of genetic markers . </S>",
    "<S> unfortunately these empirical estimates can be noisy , especially regarding distant relatives . </S>",
    "<S> we propose a new method for denoising genetically  inferred relationship matrices by exploiting the underlying structure due to hierarchical groupings of correlated individuals . </S>",
    "<S> the approach , which we call treelet covariance smoothing , employs a multiscale decomposition of covariance matrices to improve estimates of pairwise relationships . on both simulated and real data , </S>",
    "<S> we show that smoothing leads to better estimates of the relatedness amongst distantly related individuals . </S>",
    "<S> we illustrate our method with a large genome - wide association study and estimate the `` heritability '' of body mass index quite accurately . </S>",
    "<S> traditionally heritability , defined as the fraction of the total trait variance attributable to additive genetic effects , is estimated from samples of closely related individuals using random effects models . </S>",
    "<S> we show that by using smoothed relationship matrices we can estimate heritability using population - based samples . finally , </S>",
    "<S> while our methods have been developed for refining genetic relationship matrices and improving estimates of heritability , they have much broader potential application in statistics . </S>",
    "<S> most notably , for error - in - variables random effects models and settings that require regularization of matrices with block or hierarchical structure .    ,    ,    , </S>"
  ]
}