{
  "article_text": [
    "the hopfield model @xcite is one of the simplest mathematical models which explains associative memory .",
    "this model is characterized by binary state neurons and each neuron is represented by ising spin . in this model system",
    ", arbitrary two neurons are interacted each other _ via _ so called hebb rule .",
    "the hebb rule is one of the standard learning rules of the patterns @xmath0 and determines the strength of the interaction @xmath1 between the @xmath2 and @xmath3-th neurons , say , @xmath4 and @xmath5 , as @xmath6 where @xmath7 means the number of embedded patterns and @xmath8 denotes the number of neurons .",
    "these features have been investigated by statistical mechanics deeply @xcite . actually , up to now , various extensions and generalizations of the hopfield model were proposed and these properties were investigated from statistical mechanical point of view ( see , for example @xcite ) .",
    "however , little is known about the properties of the hopfield model in which the length of interactions @xmath1 is restricted to the nearest neighboring neurons . by the analogy to the spin system in statistical mechanics",
    ", we call this type of the hopfield model _ finite - dimensional hopfield model_. inspired by the study of nishimori , whyte and sherrington @xcite , in this paper , we consider the finite - dimensional hopfield model storing structured patterns . in general , it is hard to analyze such finite - dimensional systems explicitly .",
    "however , one can derive several rigorous results of thermodynamic properties of the system by assistant of the pierls arguments and the gauge transformations @xcite .",
    "although the qualitative features of the phase diagrams of the system became clear by these analyses , nobody yet succeeded in deriving their quantitative behavior at all . in this paper , we analyze the storage capacity of the system quantitatively .",
    "we restrict ourselves to the case of two - dimensional system on the square lattice .",
    "this paper is organized as follows . in sec .",
    "[ sec : definition ] , we explain our model system . in sec .  [",
    "sec : phase_diag ] , we briefly review the qualitative features of the phase diagram obtained by nishimori _",
    "et al _ @xcite . in sec .",
    "[ sec : analysis ] , we analyze the storage capacity of our model system . section [ sec : conclusion ] is devoted to discussion of all results we obtain .",
    "in this section , we define our model systems .",
    "the hamiltonian of the system is given as @xmath9 where @xmath10 are the states of the neuron taking binary value @xmath11 , and @xmath1 is the strength of the interaction between @xmath4 and @xmath5",
    ". the summation @xmath12 appearing in eq .",
    "( [ eq : hamiltonian ] ) runs over nearest neighboring neurons on a square lattice .",
    "we chose the _ short range _ hebb rule as a interaction which is given by @xmath13 for the nearest neighboring sites @xmath14 and @xmath15 otherwise . here , @xmath16 is the number of embedded patterns and @xmath17 .",
    "let us consider about the probability distribution of a set of patterns @xmath18 .",
    "we suppose that the probability that arbitrary nearest neighboring sites of @xmath7-th pattern are @xmath19 and @xmath20 respectively is proportional to @xmath21 where the parameter @xmath22 controls the degree of the correlation between arbitrary nearest neighboring sites .",
    "let us write @xmath23 and @xmath24 as the probability of @xmath25 and @xmath26 , respectively .",
    "then , the ratio of the former to the later is given by @xmath27 for the case of @xmath28 , eq .",
    "@xmath29 becomes @xmath30 .",
    "hence there is no correlation between @xmath2 and @xmath3 sites of @xmath7-th patterns and embedded patterns correspond to `` random patterns '' . on the other hand , for the case of @xmath31",
    ", we obtain @xmath32 .",
    "namely , the value of @xmath19 is same as that of @xmath20 with probability one .",
    "applying eq .",
    "@xmath33 to all nearest neighboring pairs @xmath14 , we obtain the probability distribution for @xmath7-th pattern as @xmath34 where @xmath35 is the normalization factor given by @xmath36 supposing that each pattern is generated by eq .",
    "@xmath37 independently , a set of embedded patterns @xmath38 is generated by the following probability distribution @xmath39 here , the normalization factor @xmath40 is given by @xmath41 .",
    "note that eq  @xmath37 corresponds to the boltzmann weight of the two - dimensional ferromagnetic ising model on the square lattice whose interaction is given by @xmath42 at temperature @xmath43 .",
    "hence embedded patterns are same as snapshots of equilibrium monte carlo simulations for it .",
    "this ising model was explicitly solved in @xcite and it is known that there is a critical point at @xmath44 , where @xmath45 denotes the ratio of the temperature to the strength of the interaction .",
    "this model has a ferromagnetic solution for @xmath46 and a paramagnetic solution for @xmath47 . from this fact , in our model system , embedded patterns have a long - range order for @xmath48 ,",
    "on the other hand , there is no long - range correlation for @xmath49 .",
    "[ img : snap_shot ] shows typical three examples of embedded patterns .    in the next section ,",
    "we briefly review the features of the phase diagrams of our model systems obtained by nishimori _",
    "et al _ @xcite .",
    "before we explain our analysis of maximum number of embedded patterns , in this section , we briefly review the results by nishimori _",
    "et al _ @xcite .",
    "note that their treatments , namely , the gauge transformations and the peierls arguments are applied to not only the two - dimensional systems but also the systems in arbitrary dimension . fig .",
    "[ img : phase ] shows the qualitative phase diagram with axes of temperature @xmath50 and a parameter @xmath22 controlling the structure of patterns for a fixed value of @xmath16 . in general , this system has three phases : paramagnetic(p ) , ferromagnetic(f ) , and retrieval(r)(or spin glass(sg ) ) phases .",
    "each phase is characterized by the following three order parameters @xmath51 where @xmath52 means thermodynamic average .",
    "the above three order parameters @xmath53 , @xmath54 and @xmath55 represent the edwards - anderson spin glass order parameter , the ferromagnetic order parameter , and the overlap between the @xmath7-th pattern and the network state @xmath56 , respectively . the paramagnetic , ferromagnetic , retrieval and spin grass phase are characterized by the above three order parameters as @xmath57 @xmath58 @xmath59 and @xmath60 , respectively .    applying the gauge transformations to this system",
    ", we obtain the internal energy @xmath61 $ ] and the overlap @xmath62 $ ] on the lines @xmath63 in the phase diagram as follows .",
    "@xmath64 = pe_0\\left(\\frac{\\beta}{\\sqrt{p}}\\right ) ,    \\label{eq : internal_energy}\\ ] ] @xmath65= m_0\\left(\\frac{\\beta}{\\sqrt{p}}\\right ) ,    \\label{eq : overlap_mag}\\ ] ] where @xmath66 is the internal energy of the ferromagnetic ising model corresponding to the partition function @xmath67 , and @xmath68 is the spontaneous magnetization of the same model . here",
    ", the expression of @xmath69 $ ] means the average over the distribution  ( [ eq : distribution ] ) .",
    "both @xmath66 and @xmath68 generally have singularities at some critical point when spatial dimensionality exceeds one .",
    "let us suppose that @xmath70 is the critical point .",
    "then eqs  @xmath71 and @xmath72 mean that the internal energy and the overlap of our system have the same singularity at @xmath70 .",
    "this implies a phase transition and the boundary between @xmath62 \\neq 0 $ ] and @xmath62 = 0 $ ] crosses this point on the line @xmath63 ( it is denoted by m in fig .  [ img : phase ] ) . we should notice that this point is also the critical point of the embedded patterns",
    "when the value of @xmath16 is small , a typical phase diagram is given by fig .  [ img : phase](a ) . for this case , there is a possibility to exist the retrieval phase in the region denoted by r. in the same figure , the region f is the ferromagnetic phase with finite overlap .",
    "it is important to notice that this system is not meaningful as an associative memory for @xmath48 since embedded patterns have a long - range ferromagnetic order like the right of fig .",
    "[ img : snap_shot ] , and patterns become correlated each other . with this fact in mind",
    ", we do not regard this region as a retrieval phase .",
    "when the value of @xmath16 increases , the critical point @xmath73 moves to right . on the other hand , by using the peierls argument",
    ", the ferromagnetic phase still exists in the almost same region . taking those facts into account",
    ", there exists a critical number of patterns @xmath74 above which @xmath75 the ferromagnetic phase is split into two regions , that is , the ferromagnetic phase with finite overlap ( f ) and the ferromagnetic phase without retrieval order ( f ) . at the same time , the retrieval phase in the small-@xmath16 case is replaced by the spin glass phase because the region with finite overlap is limited to f ( fig .",
    "[ img : phase](b ) ) . in summary",
    ", there exists a critical number of patterns @xmath74 blow which @xmath76 the retrieval phase exists there if any , while for @xmath77 the retrieval phase vanishes and this network can not retrieve embedded patterns .",
    "however , the value of @xmath74 is not yet evaluated quantitatively at all in @xcite . following section",
    ", we investigate it especially in the case of two - dimensional system on the square lattice .",
    "we begin with the case of @xmath78 . in this case , the system is identical to the ferromagnetic ising model and the retrieval solution of the system corresponds to the ferromagnetic solution of the ferromagnetic ising model . in the case of square lattice ,",
    "the critical temperature of the ferromagnetic ising model is @xmath79 , therefore the system has a retrieval solution at @xmath80 .",
    "we next analyze the case of @xmath82 .",
    "there is a good evidence to show that the retrieval phase does not exist for this case .",
    "let us start with investigating if there is a state which has a smaller energy than retrieval one .",
    "substituting @xmath83 into eq .",
    "( [ eq : hamiltonian ] ) and averaging it over the distribution  ( [ eq : distribution ] ) , we obtain the energy per neuron of the pure retrieval state @xmath84 & = & \\frac{1}{n }     \\left [ -\\frac{1}{\\sqrt{p}}\\sum_{\\langle ij \\rangle}\\sum_{\\mu=1}^p     \\xi_i^{\\mu}\\xi_j^{\\mu}\\xi_i^1\\xi_j^1   \\right ] \\nonumber\\\\   & = &    -\\frac{2}{\\sqrt{p } }    \\left\\ { 1+(p-1)c_1\\left ( \\frac{j_0}{\\sqrt{p}}\\right)^2 \\right\\ } ,    \\label{eq : energy_r}\\end{aligned}\\ ] ] where @xmath85 is the nearest - neighbor correlation function of the ferromagnetic ising model on the square lattice .",
    "the explicit form of @xmath86 is @xmath87 we also rewrite the energy per neuron of the pure ferromagnetic state in terms of @xmath85 . substituting @xmath88 into eq .",
    "( [ eq : hamiltonian ] ) and averaging it over the distribution  ( [ eq : distribution ] ) , we obtain @xmath89 & = & \\frac{1}{n }    \\left [     -\\frac{1}{\\sqrt{p}}\\sum_{\\langle ij \\rangle}\\sum_{\\mu=1}^p     \\xi_i^{\\mu}\\xi_j^{\\mu }   \\right ] \\nonumber \\\\   & = &   -2\\sqrt{p}c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right ) .",
    "\\label{eq : energy_f}\\end{aligned}\\ ] ]    we next investigate the properties of the function @xmath85 .",
    "it is written in terms of the partition function  ( [ eq : partition ] ) as follows .",
    "@xmath90 it is important to bear in mind that @xmath91 is explicitly solved in @xcite as follows .",
    "@xmath92 where @xmath93 substituting @xmath94 into eq .",
    "@xmath95 and using @xmath96 @xmath97 we obtain @xmath98 substituting eq .",
    "@xmath99 into the right hand side of eq .",
    "( [ eq : corr ] ) , explicit solution of @xmath85 is written by @xmath100 where @xmath101 is the complete elliptic integral , namely , @xmath102 with @xmath103 and @xmath104 fig .",
    "[ img : correlation ] shows the shape of eq .",
    "( [ eq : explicit_corr ] ) . from eqs .",
    "( [ eq : energy_r ] ) , ( [ eq : energy_f ] ) and ( [ eq : explicit_corr ] ) , we obtain rigorous values of grand state energies of the pure retrieval and the pure ferromagnetic states .",
    "now we calculate the condition that the pure ferromagnetic state has a smaller energy than the retrieval one , that is to say , the condition for @xmath105 > [ e_f]$ ] .",
    "we rewrite this inequality by using eqs .",
    "( [ eq : energy_r ] ) and ( [ eq : energy_f ] ) , then we obtain @xmath106 as @xmath107 is a monotonically increasing function and @xmath108 ( see fig .[img : correlation ] ) , eq .",
    "( [ eq : condition_1 ] ) leads to @xmath109 where @xmath107 denotes the inverse of the function @xmath86 .",
    "we find that the pure ferromagnetic state has a smaller energy than the pure retrieval one as long as this condition is satisfied .",
    "as @xmath22 is finite , @xmath81 must be satisfied because @xmath107 is a monotonically increasing function and @xmath108 .",
    "further , it is easy to confirm the following inequality .",
    "@xmath110-[e_r])}{\\partial p } < 0\\ ] ] taking into account @xmath111-[e_r ] < 0 $ ] under the condition @xmath112 and @xmath81 , @xmath111 $ ] gets smaller relatively as @xmath16 gets larger . as the result",
    ", the pure ferromagnetic state has a smaller energy than the pure retrieval one for @xmath113 , @xmath114 and @xmath81 .",
    "the value of @xmath115 is @xmath116 for @xmath117 , and @xmath118 for @xmath119 because of the monotonically increasing property of @xmath107 .",
    "note that @xmath115 is always less than @xmath120 .",
    "we investigate the energy landscape around pure retrieval state further .",
    "let us calculate the energy increase per interaction when the state changes from pure retrieval one . the energy stored in an interaction",
    "is given by @xmath121 substituting @xmath122 into eq .",
    "( [ eq : engy_interaction ] ) , we obtain the energy stored between @xmath2-th and @xmath3-th neurons of the network retrieving 1-th pattern completely . as the same way , substituting @xmath123 into eq .",
    "( [ eq : engy_interaction ] ) gives the energy of the interaction for the case where @xmath3-th neuron changes from retrieval state .",
    "subtracting the former from the latter , and averaging it over the distribution @xmath124 , we obtain the energy increase per interaction when the state changes from retrieval one .",
    "@xmath125 & = &     \\left [ \\frac{2}{\\sqrt{p}}\\sum_{\\mu=1}^p     \\xi_i^{\\mu}\\xi_j^{\\mu}\\xi_i^1\\xi_j^1   \\right ] \\nonumber\\\\   & = &     \\frac{2}{\\sqrt{p } }     \\left\\ {       1+(p-1)c_1\\left ( \\frac{j_0}{\\sqrt{p } } \\right ) \\right\\ }   .",
    "\\label{eq : engy_increase_r}\\end{aligned}\\ ] ] the value of @xmath126 $ ] is always positive , and it is expected that the energy increases on the average when the state changes from pure retrieval one .",
    "we estimate the energies of the finite overlap states as follows .",
    "let @xmath127 be the number of neurons whose states are opposite to the retrieval states .",
    "the relation between @xmath127 and @xmath55 is given by @xmath128 if @xmath127 is not large , the number of interactions between the retrieval state and opposite state is expected to be about @xmath129 because the number of nearest neighboring neurons is @xmath130 and neurons whose states are opposite to retrieval states lie sparsely almost all case . therefore , the energy of the system per neuron whose overlap is @xmath55 is expected to be @xmath131 & = & [ e_r ] + \\frac{4n}{n}[de_r ] \\nonumber\\\\   & = & [ e_r ] + 2(1-m_r)[de_r ] .",
    "\\label{eq : energy_mr}\\end{aligned}\\ ] ] fig .",
    "[ img : ovlp - engy ] shows the result of numerical simulation and compare it with eq .",
    "we set parameter values as @xmath117 and @xmath133 at the simulation .",
    "we generate @xmath134 sample states for each value of @xmath55 and evaluate @xmath135 $ ] .",
    "@xmath132 agrees with the result of the simulation near @xmath136 , although it does not agree with the simulations for the case of small @xmath55 .",
    "this is clearly because the number of interaction between the retrieval state and opposite state is smaller than @xmath129 for large @xmath127 .",
    "regardless of it , the energy tends to increase as @xmath55 gets smaller , and the state near @xmath136 is likely the smallest energy among the finite overlap states .",
    "almost same argument can be applied to the ferromagnetic state , and the state near @xmath137 is the smallest energy among the ferromagnetic order . taking into account @xmath105 > [ e_f]$ ] , the energy of ferromagnetic order is expected to be smaller than that of retrieval order as long as @xmath81 and @xmath138 are satisfied .",
    "we also investigate the stability of pure retrieval state .",
    "the variance of @xmath139 is given by @xmath140 & = & [ de_r^2]-[de_r]^2 \\nonumber\\\\   & = & \\frac{4(p-1)}{p }    \\left\\ { 1+(p-2)c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right)^2      -(p-1)c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right)^4 \\right\\ }   .",
    "\\label{eq : variance}\\end{aligned}\\ ] ] using eqs .",
    "@xmath141 and @xmath142 , the ratio of @xmath126 ^ 2 $ ] to this variance is obtained by @xmath143}{[de_r]^2 } =    \\frac    { ( p-1)\\left\\ { 1+(p-2)c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right)^2        -(p-1)c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right)^4 \\right\\ } }    { 1 + 2(p-1)c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right)^2+(p-1)^2    c_1\\left(\\frac{j_0}{\\sqrt{p}}\\right)^4 } \\ .\\ ] ] partially differentiating above equation by @xmath16 ( the value of @xmath86 is fixed ) , we obtain the following inequality .",
    "@xmath144}{[de_r]^2 }    \\right ) > 0\\ ] ] this means that the more the value of @xmath16 gets large , the more the energy is likely to decrease when the state changes from pure retrieval one , although it increases on the average .",
    "therefore , the pure retrieval state becomes unstable for large @xmath16 .",
    "we can roughly estimate the value of @xmath16 for which the pure retrieval state gets unstable by @xmath143}{[de_r]^2 } > 1 .",
    "\\label{eq : unstable}\\ ] ] in fig .",
    "[ img : unstable_p ] , we plot the minimum value of @xmath16 that is satisfied with eq .  @xmath145 . for example , eq .",
    "@xmath145 is satisfied with @xmath146 for @xmath147 .",
    "note that this is probably overestimating and the value of @xmath16 is likely smaller .",
    "we confirm this argument in numerical simulations of the dynamics at @xmath113 .",
    "[ img : unstable ] shows a typical example of how the overlap @xmath55 depends on monte carlo step in computer simulations , in which @xmath148 and @xmath147 .",
    "the state of network starts with the embedded pattern itself . in this simulations ,",
    "the pure retrieval state is already unstable for @xmath117 , and the network falls into a certain local minimum near @xmath136 .",
    "this implies that the pure retrieval state is no longer stable for @xmath81 .    taking the above all results into account",
    ", we show that there is no retrieval phase if @xmath81 .",
    "as we have seen , @xmath115 is always smaller than @xmath120 for @xmath81 , and the region of @xmath149 at @xmath113 is not retrieval phase but must be ferromagnetic one .",
    "this is because the ferromagnetic states have smaller energy than the retrieval one , and the state with minimum energy appears with probability one for @xmath150 in terms of the boltzmann distribution .",
    "therefore , the boundary of @xmath62=0 $ ] is prohibited from landing at @xmath49 on the @xmath22 axis like @xmath151 in fig .",
    "[ img : proof ] , and it should land at @xmath152 from point m vertically like @xmath153 .",
    "hence , there is no retrieval phase in the region @xmath154 ( for all @xmath50 ) because the region with finite overlap is limited at @xmath48 . as a result ,",
    "the phase diagram should be like fig .",
    "[ img : phase](b ) and we conclude that the retrieval phase does not exist for the case of @xmath81 .",
    "for the case of @xmath155 , we can not immediately conclude that there exists the retrieval phase although the energy of a perfect retrieval state is smaller than that of ferromagnetic one .",
    "we have to compare the energy of the retrieval state with that of the spin glass state .",
    "however , it is very hard to calculate the grand state energy of the spin glass state because the hamiltonian of this system has a very complicated energy landscape . for this case , in order to evaluate the grand state of the hamiltonian , we should carry out simulated annealing , for example .",
    "however , up to now , we do not yet obtain reliable results .",
    "this will be our future problem .",
    "in this paper , we investigated the maximum number of embedded patterns in the two - dimensional hopfield model storing structured patterns . as a result",
    ", we found that this system can retrieve a pattern at @xmath156 in the case of @xmath78 , however the retrieval phase does not exist for the case of @xmath81 .",
    "in other words , this system can not retrieve more than three patterns whose value is independent of the size of the system .",
    "this result agrees with a consideration of networks with randomly diluted synapses , in which @xmath74 is proportional to the average connectivity per neuron @xcite .",
    "namely , we can see from this argument that the value of @xmath74 for our network is finite because the average connectivity per neuron is four ( finite number ) . however , our result is more strict than that from this argument .",
    "moreover , @xmath157 is satisfied with any value of @xmath22 ( even the conventional `` random patterns '' ) .",
    "this implies that the smallness of the value of @xmath74 is due to the dimensionality two of the network rather than spatially correlated patterns .",
    "this argument also implies that although there are several modifications in order to improve storage capacity with spatially correlated patterns ( see @xcite , for example ) , these modifications are not expected to be remarkable improvements for our model system .",
    "6 j.  j.  hopfield , proc .",
    "79 * , 2554 ( 1982 ) .",
    "d.  amit , h.  gutfreund , and h.  sompolinsky , phys .",
    "a * 32 * , 1007 ( 1985 ) ; phys",
    "lett . * 55 * , 1530 ( 1985 ) .",
    "j.  hertz , a.  krogh , and r.  g.  palmer , _ introduction to the theory of neural computation _",
    "( addison - wesley , 1991 ) .",
    "h.  nishimori , w.  whyte and d.  sherrington , phys .",
    "e * 51 * , 3628 ( 1995 ) .",
    "l.  onsager , phys .",
    "rev . * 65 * , 117 ( 1944 ) .",
    "b.  derrida , e.  gardner , and a.  zippelius , europhys .",
    "lett . * 4 * , 167 ( 1987 ) .",
    "m.  schlter , f.  wagner , phys .",
    "e * 49 * , 1690 ( 1994 ) ."
  ],
  "abstract_text": [
    "<S> we investigate the maximum number of embedded patterns in the two - dimensional hopfield model . </S>",
    "<S> the grand state energies of two specific network states , namely , the energies of the pure - ferromagnetic state and the state of specific one stored pattern are calculated exactly in terms of the correlation function of the ferromagnetic ising model . </S>",
    "<S> we also investigate the energy landscape around them by computer simulations . </S>",
    "<S> taking into account the qualitative features of the phase diagrams obtained by nishimori , whyte and sherrington [ phys . </S>",
    "<S> rev . </S>",
    "<S> e * 51 * , 3628 ( 1995 ) ] , we conclude that the network can not retrieve more than three patterns . </S>"
  ]
}