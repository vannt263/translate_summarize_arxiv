{
  "article_text": [
    "the study of transport properties of solids has always been a challenge for experimental and theoretical condensed matter physics .",
    "the difficulty lies among other things in the fact that the transport properties are by definition related to non - equilibrium situations , so that their modeling is not easily based on standard techniques .",
    "fortunately , in the regime of linear response to weak external fields , the study can be based on ground state properties , by treating the field as a perturbation . that this approach is founded solidly is guaranteed by the fluctuation - dissipation theorem ; in particular for the case of electrical conductivity this is expressed by the famous result of kubo.@xcite    in the past decades",
    ", the development of first - principles methods for the calculation of the electronic structure of solids has been accompanied by corresponding advances in the formalism and methods for the calculation of transport properties .",
    "technological interest has given a push to the field , and novel effects such as the giant and the tunneling magnetoresistance ( gmr and tmr ) have been investigated theoretically and applied in technology .",
    "furthermore , the size of today s electronic devices is so small that the understanding of ballistic ( _ i.e. _  phase - coherent ) transport has become important not only for basic physics but also for applications . as a result of these developments , ideas and methods which initially were conceived for the understanding of electronic transport in simple cases ,",
    "have been combined with techniques based on a realistic description of the electronic structure in order to give reliable and material - specific results.@xcite without claiming to give a complete list , we mention that for diffusive transport through disordered systems there exist methods and results based on the combination of the korringa , kohn and rostoker ( kkr ) green function method with the boltzmann formalism,@xcite on the coherent potential approximation ( cpa ) combined with kubo - greenwood@xcite theory,@xcite or on the tight - binding method.@xcite for ballistic transport there exist methods based , for example , on leed,@xcite layer - kkr@xcite or similar layer - type@xcite techniques , on the tight - binding approach,@xcite and on the transfer matrix concept;@xcite these mostly combine the landauer - bttiker approach@xcite with electronic structure methods , as will be done in the present paper . moreover , due to potential applications in gmr and tmr devices ,",
    "spin - dependent transport has come to the center of interest with emphasis to conduction in magnetic multilayers@xcite and ferromagnet - semiconductor hybrides.@xcite in these systems the electronic spin degrees of freedom are accounted for in order to achieve spin - dependent resistance .",
    "in addition , novel systems such as nanowires or atomic - size contacts are created experimentally , and demand interpretation of their transport properties .    in this paper",
    "we present a method for the calculation of ballistic transport from first principles , which combines the kkr _ ab initio _ green function technique with the baranger and stone@xcite formulation of the ballistic transport .",
    "the method is suitable for layered systems and interfaces with two - dimensional periodicity , as well as for atomic size constrictions connecting two leads or nanowires,@xcite and supports spin dependent effects .",
    "since the kkr technique in the screened formalism offers linear scaling of the computational effort with the number of layers,@xcite our method can handle large systems .",
    "additionally we present the proof of some theorems concerning the transmission probability of wavepackets in crystalline , rather than free - electron , environment .",
    "the paper is organized as follows . in section [ secsetup ]",
    "we give a description of the setup of the physical systems that our method can be used for . in section [ seckubo ]",
    "we briefly address the approximations and assumptions made , also in connection to the kubo - greenwood and the baranger - stone formalism .",
    "sections [ seclandauer ] and [ seckl ] are devoted to making the connection to the landauer - bttiker formalism , and some elements of scattering theory are given there .",
    "the conductance formalism for kkr is developed in section [ seckkr ] .",
    "some examples illustrating the convergence properties of the method are given in section [ secexamples ] .",
    "finally , we conclude in section [ secsummary ] .",
    "the appendices contain parts where lengthy mathematical manipulations were needed .",
    "the systems that we study consist of two half infinite perfect crystalline leads , left ( l ) and right ( r ) , attached to a slab which is considered as the `` interaction '' region ( i ) ; schematically this is represented in fig .  [ figsetup ] . the surfaces @xmath0 and",
    "@xmath1 should be chosen far enough within the leads so that any localized interface states have decayed and only bloch states are present there .",
    "the direction of growth is taken to be the @xmath2 direction .",
    "we consider systems with a 2d periodicity in the xy plane where the scattering region is embedded between two semi - infinite crystalline leads .",
    "moreover , summing up current contributions in real space we can calculate the conductance in the presence of defects in nanowires@xcite and we can even treat atomic sized constrictions between infinite leads if the current flow is localized in the constriction region which is usually the case.@xcite thus we can simulate transport through small molecules or a break junction geometry .     and @xmath1 , where only bulk bloch states should exist.,width=188 ]    figsetup",
    "the connection between the ballistic dc conductance or conductivity and the one - electron green function in the linear - response regime has been given in the past.@xcite in short , one uses first - order perturbation theory to calculate the effect of a weak , time - oscillating electric field on the density matrix of the system ; then , the frequency of the oscillating field is taken to zero , and the dissipative term of the expectation value of the current gives the dc linear response of the system .",
    "the result is just an expression for the kubo conductivity of the system at the limit of zero temperature .",
    "integration by parts of the conductivity expression gives the relation between current , conductance and voltage .",
    "baranger and stone@xcite have proven that the conductance is a fermi - level property , although the two - point conductivity within the sample can also have contributions from other energy levels when magnetic fields are present . here",
    "we briefly describe the relevant formalism , in connection to the rest of the paper .    the general relation between the current density at some point , @xmath3 , and the electric field at all other points of a material , @xmath4 , in first order perturbation theory for a stationary state , is given by @xmath5 the nonlocal conductivity tensor @xmath6 is connected to the retarded one - electron green function @xmath7 of the system via the famous kubo - greenwood result .",
    "its frequently used form is@xcite @xmath8 here , @xmath9 is the fermi function derivative and @xmath10 denotes the imaginary part . in terms of the difference between the retarded and advanced green function @xmath11 @xmath12 the conductivity can be written @xmath13 where the symbol @xmath14 is defined as @xmath15 . here",
    "only the delta - function part of the green function has been kept ; the principal - value part gives rise to the reactive term , which is zero for dc conductance.@xcite upon taking the limit of zero temperature , the derivative of the fermi - dirac function becomes a delta function according to @xmath16 and contributions to the conductivity only arise from the fermi level .    in the absence of a magnetic field ,",
    "as assumed in our work , the nonlocal conductivity tensor is symmetric under the interchange of @xmath17 and @xmath18 , and divergenceless : @xmath19 where @xmath20 means that the operator acts to the function on its left .",
    "the former relation is a consequence of the symmetry @xmath21 of the green function for local potentials .",
    "the latter is a result of current conservation in the absence of magnetic field ; if a magnetic field is present , one has merely @xmath22 instead.@xcite    in eq .",
    "( [ eqohm ] ) , of course , @xmath4 is the _ total _ field , _ i.e. _  the external one plus the one being induced by charge relaxations ; the electronic gas and nuclei must be also fully taken into account .",
    "this is not easy to handle ; however , this expression can be integrated over the whole sample leaving only the current in relation to the applied voltage by exploiting the fact that @xmath23 , where @xmath24 is the electrostatic potential . inserting this into eq .",
    "( [ eqohm ] ) one gets for the total current @xmath25 through @xmath1 @xmath26 after an integration by parts and use of eq .",
    "( [ eqdivergenceless ] ) . here",
    "@xmath27 is the external bias voltage .",
    "the `` zero - current theorem '' stating that the ground - state electrostatic potential gives always zero current density@xcite has been used , so only the externally applied voltage @xmath27 remains .",
    "thus one can recognize the conductance as the flux of the conductivity tensor through the surfaces @xmath0 and @xmath1 : @xmath28 substituting eq .",
    "( [ eqkubo ] ) one obtains for the conductivity : @xmath29 where the terms involving @xmath30 and @xmath31 vanish.@xcite",
    "in the landauer approach , the conductance problem is viewed from the aspect of scattering theory . in this way ,",
    "the causal relation between voltage and current is conceptually reversed.@xcite instead of applying a voltage and examining the current as the response , a current is forced to flow through the sample and the voltage is viewed as the result of the pileup of carriers at the various obstacles , forming residual resistivity dipoles .",
    "the result is , of course , again the usual current - voltage relation . in a multi - lead experiment ,",
    "if each lead @xmath32 is held in potential @xmath33 , then the current @xmath34 going out through this lead is @xmath35 the coefficients @xmath36 describe the conductance of the system , and in the case of only two leads there is only one conductance coefficient @xmath37 .",
    "the concept of incoming and outgoing _ scattering channels _ is introduced , which play the same role as in- and out - states in scattering theory ; in the cases of our interest they are bloch states in the leads .",
    "we need to describe the scattering process of one - electron bloch states incident from l as incoming waves and scattered into l or r as outgoing waves ; thus an @xmath38-matrix formulation is appropriate .",
    "one has waveguide or crystalline geometry in the leads , rather than the free - space geometry of usual scattering theory , and in addition the leads can consist of different materials . in this respect ,",
    "usual scattering theory needs a few modifications to be applicable .",
    "once the @xmath38-matrix elements are available , one can readily calculate the transmission probability @xmath39 from each incoming channel @xmath40 in lead @xmath41 to each outgoing @xmath42 in lead @xmath32 , and use the landauer - bttiker formula to calculate the conductance @xmath36 from lead @xmath41 to lead @xmath32:@xcite @xmath43 stone and szafer@xcite and baranger and stone@xcite showed the connection between the landauer - bttiker formula with the kubo result starting from perturbation theory , considering free - electron leads . in sec .",
    "[ seckl ] we shall follow their analysis closely , but prove some of the theorems needed for crystalline leads taking into account the bloch character of the incoming and outgoing channels .    the @xmath38-matrix formulation in such problems and the question of unitarity will be shortly addressed now .",
    "first of all , the in - states and out - states , which are in a usual formulation plane or spherical waves , are here propagating bloch states in the leads .",
    "whether such a state @xmath44 is incoming or outgoing is determined not by the bloch wavevector @xmath45 , but by the group velocity @xmath46 .",
    "suppose that a particular lead is grown in the @xmath2-direction , with the unit vector @xmath47 pointing away from the sample .",
    "then , the bloch state is outgoing if @xmath48 , and incoming if @xmath49",
    ". evidently the set of in - states can be different than the set of out - states .",
    "consider , for example , the case of only two leads of different materials , say l in the left with wavefunctions @xmath50 and r in the right with wavefunctions @xmath51 , sandwiching the interaction region i. the set of in - states for this problem will consist of right - traveling waves @xmath52 and left - traveling @xmath53 , while the set of out - states will consist of left - traveling waves @xmath54 and right - traveling waves @xmath55 .",
    "the total wavefunction in the system will be asymptotically a linear combination of in- and out - states ; in particular , if we choose incidence from l as a boundary condition , we have the form @xmath56 for finite @xmath2 values also evanescent states have to be included in the summations , however they die out for @xmath57 . here ,",
    "band indices @xmath58 and @xmath59 and bloch wavevectors @xmath45 and @xmath60 , have been introduced ; elastic scattering is implied .",
    "the total wavefunction @xmath61 is characterized by @xmath62 in the sense of the boundary condition , _",
    "i.e. _ , it originates from an in - state which has this wavevector . the transmission amplitude @xmath63 and the reflection amplitude @xmath64 are related the elements of the @xmath38-matrix of the system .",
    "the normalization of the in- and out - states determines whether these amplitudes @xmath65 and @xmath66 are identical with the @xmath38-matrix elements or not , since the @xmath38-matrix must always be unitary .",
    "if one normalizes the in- and out - states to unit flux ( as @xmath67 ) , then the transmission probability from state @xmath68 to state @xmath69 is just @xmath70 this point will be addressed in detail in the following section .",
    "the connection of the landauer approach involving the @xmath38-matrix to the kubo - greenwood conductivity formula involving the green functions has been given by fisher and lee@xcite , stone and szafer@xcite , and baranger and stone@xcite in the case of free electrons in the leads .",
    "however , for crystalline leads one must account for the relevant band structure . here",
    "we present some proofs needed to extend the above results to crystalline leads .",
    "in particular we shall pursue the @xmath38-matrix elements between in - states from l and out - states in r and see how these connect to the green function of the system and to the conductance . in this way the connection of the kubo to the landauer formalism will be made .",
    "we proceed in three steps : _",
    "( i ) _ we find an expression for the transmission amplitude @xmath71 ; _ ( ii ) _ we express the asymptotic green function in terms of the @xmath38-matrix ; and _ ( iii ) _ we express the @xmath38-matrix in terms of @xmath71 .    _",
    "( i ) _ we start with the calculation of current matrix elements between bloch states . in particular , let @xmath72 and @xmath73 be incoming and outgoing bloch states ( in the sense described before , _",
    "right- and left - traveling ) of the same energy ( @xmath74 ) in the same lead ; the states are normalized to unit probability rather than unit flux .",
    "also , let @xmath38 be the lead cross section , normal to the @xmath2-direction .",
    "then the following orthogonality relations hold for the current matrix elements : @xmath75 ( @xmath76 and @xmath77 here are supposed to be left- and right - traveling states in the same lead ) .",
    "these have been proven before@xcite for free electrons ; we present the proof for bloch states in appendix  [ appa ] .",
    "( [ eqortha],[eqorthb ] ) can be used to project a scattering wavefunction onto a particular channel ; using them in connection with eq .",
    "( [ eqscattering ] ) we can extract the transmission amplitude out of @xmath78 : @xmath79    _ ( ii ) _ next we consider the asymptotic expression for the retarded green function @xmath80 , with @xmath81 and @xmath82 in different leads and going to infinity .",
    "this can be found@xcite by using the boundary condition that @xmath80 should represent an outgoing wave at @xmath81 , @xmath83 should represent an incoming wave at @xmath81 , and @xmath84 the green function then , expanded in in- and out - states , has the asymptotic form @xmath85 we are now seeking a relation between the coefficients @xmath86 and the transmission amplitudes @xmath87 .",
    "( [ eqtampl ] ) was used together with the lippmann - schwinger equation and eq .",
    "( [ eqbaranger ] ) in ref .",
    "to prove this for free - electron leads .",
    "however , the lippmann - schwinger equation is difficult to handle when we have different materials in the leads , because it connects the bloch wavefunctions of different materials in the infinite leads , thus there is no localized perturbation .",
    "alternatively , one can start directly from the definition@xcite of the @xmath38-matrix in terms of the time - dependent retarded green function ( propagator ) , looking at the transmission amplitude from an initial wavepacket @xmath88 , incident from the left , to a final one @xmath89 , outgoing to the right . here",
    "@xmath90 and @xmath91 denote itinerant bloch states and we have propagated the initial and final states to @xmath65 and @xmath92 by their corresponding bulk hamiltonians giving the exponential factors . at the end @xmath93 and @xmath94 will be taken as extremely peaked distributions around the same energy @xmath95 ; @xmath40 and @xmath42 represent then definite @xmath96 and @xmath62 .",
    "one gets    @xmath97    the velocities appearing represent the @xmath2 component of the group velocity , since in waveguide geometry the @xmath98 s form in reality a very dense discreet set so that the wavepacket is constructed for a definite @xmath98 from the continuous @xmath99 spectrum . having this in mind , we have used in the derivation of ( [ eqsfi_a ] ) the orthonormality condition for bloch waves @xmath100 in addition",
    "we have used the normalization of wavepackets to unit probability @xmath101 which for a very peaked distribution @xmath102 around some energy @xmath95 gives @xmath103 implying that in the limiting case @xmath104 .",
    "finally , in the last step we have assumed that @xmath105 and @xmath106 are both peaked around the same energy @xmath95 so that the wavepacket goes to a single bloch function , whence @xmath107 .",
    "thus , the final result ( [ eqsfi ] ) is valid for on - energy - shell scattering of bloch waves ; else , for general wavepackets , eq .  ( [ eqsfi_a ] ) must be applied . working with wavepackets",
    "has guaranteed the correct normalization .    from eq .",
    "( [ eqsfi ] ) we see that the coefficients in the green function asymptotic expansion are just @xmath38-matrix elements ( normalized to the group velocities ) . in this form , the @xmath38-matrix is unitary , _",
    "i.e. _  the scattering probability is @xmath108    _ ( iii ) _ finally we show that the relation of the @xmath38-matrix to the previously defined transmission amplitude of eq .",
    "( [ eqscattering ] ) is @xmath109 _ i.e. _ , a normalization involving the group velocities is needed .",
    "this can be seen by noting that an incoming wavepacket @xmath110 , normalized to unit probability as in eq .",
    "( [ eqnorm2 ] ) , evolves partly into the wavepacket @xmath111 according to eq .",
    "( [ eqscattering ] ) .",
    "assuming that @xmath102 is so much peaked around @xmath112 that @xmath65 and @xmath113 are constant in this energy range , the scattering probability is given by the normalization factor of the outgoing wavepacket : @xmath114 , where the normalizations ( [ eqnorm1 ] ) and ( [ eqnorm3 ] ) have been utilized . comparing this to eq .",
    "( [ eqtfi.sfi ] ) proves eq .",
    "( [ eqsfi.tfi ] ) up to a phase factor , which can be seen to be just unity by creating a wavepacket out of @xmath115 in eq .",
    "( [ eqscattering ] ) and constructing the @xmath38-matrix element .",
    "furthermore the expression ( [ eqtfitfi ] ) results from ( [ eqtfi.sfi ] ) and ( [ eqsfi.tfi ] ) .    combining all the above",
    ", we may rewrite eq .",
    "( [ eqasymptgreen1 ] ) as : @xmath116 which gives us for the advanced green function @xmath117 we can extract the @xmath38-matrix elements from the green function : @xmath118 where @xmath119 and @xmath120 have to be sufficiently far apart so that the asymptotic formula ( [ eqasymptgreen1 ] ) without evanescent states can be used ( the evanescent states are always included in the self - consistent green function ) .    as a final result , we combine the above steps _ ( i)-(iii ) _ to arrive at the landauer formula",
    ". we start from the baranger - stone expression  ( [ eqbaranger ] ) , expand the green functions according to ( [ eqasymptgreen2 ] ) and ( [ eqasymptgreen3 ] ) , and use the orthogonality relations ( [ eqortha ] ) to get rid of some terms : @xmath121",
    "in the kkr method the one - electron retarded green function is expanded in terms of local orbitals centered at the atomic sites @xmath122 as : @xmath123 here , @xmath124 and @xmath125 are , respectively , the regular and irregular solutions of the schrdinger equation for the single potential @xmath126 of the @xmath32th cell in free space .",
    "atomic units are used ( @xmath127 , @xmath128 , @xmath129 ) .",
    "the index @xmath130 represents the angular momentum quantum number .",
    "the position vector @xmath81 is confined in the atomic cell @xmath32 ; @xmath131 and @xmath132 are the longer and shorter , respectively , of @xmath81 and @xmath82 . in eq .",
    "( [ eqkkr1 ] ) the first term gives the on - site contribution to the green function , while the second is the so - called backscattering term , where the information on the intersite electron propagation is contained in the structure constants @xmath133 .",
    "these are related to the known structure constants of a reference system , _",
    "e.g. _  vacuum , via an algebraic dyson equation which includes the local @xmath65-matrix of each single - sited potential . for further details",
    "we refer to refs .  .",
    "the layered systems that shall be considered with the kkr formalism consist of two half - infinite crystalline leads , assumed to have perfect periodicity otherwise . sandwiched between these leads is an `` interaction '' region where a different material can be placed and where the scattering of the bloch waves takes place .",
    "three cases can be handled in this respect : _",
    "( i ) _ systems with in - plane periodicity;@xcite _ ( ii ) _ wire - like structures embedded in vacuum ( or in some other non - conducting medium);@xcite and _ ( iii ) _ atomic constrictions between semi - infinite leads .",
    "concerning case _",
    "( i ) _ , when we consider systems with two - dimensional in - plane ( @xmath134-@xmath135 ) periodicity ( perpendicular to the direction of growth @xmath2 ) , the interaction region and the two leads have common in - plane bravais vectors .",
    "if needed , larger ( non - primitive ) two - dimensional unit cells are taken to match the lattice constants of both materials ; this is the case , for example , in an fe / gaas contact.@xcite the two - dimensional periodicity of the layered systems allows to fourier - transform the green function in the @xmath134 and @xmath135 directions , obtaining a two - dimensional bloch vector @xmath136 as a good quantum number , and retaining an index @xmath40 to characterize the layer in the direction of growth @xmath2 .",
    "the green function connecting the layers @xmath40 in the left lead and @xmath137 in the right lead is then written @xmath138 where @xmath139 and @xmath140 are in - plane lattice vectors , @xmath141 is the interlayer lattice vector , sbz is the surface brillouin zone of the system and @xmath142 its area . in this equation",
    "each layer @xmath40 is assumed to have a unique atom type , hence only the index @xmath40 suffices to characterize the local wavefunction . in the case of more inequevalent atoms per layer",
    ", an extra index @xmath143 can be introduced to account for the propagation between different kinds of atoms . in the case of spin magnetism",
    ", the green function is different for each spin direction @xmath144 or @xmath145 .",
    "the formalism can be generalized for fully relativistic calculations , where the spin - orbit coupling results in a mixing of the two spin channels .    once eq .",
    "( [ eqkkr1 ] ) or eq .",
    "( [ eqkkr2 ] ) is substituted into the expression ( [ eqbaranger ] ) , with @xmath81 and @xmath82 in different leads , the on - site term of the green function does not contribute , and only the intersite term survives ; moreover , the spacial derivative affects only the local orbital functions @xmath146 and @xmath147 , leaving the structure constants untouched . finally , if eq .",
    "( [ eqkkr2 ] ) is used , the conductance appears at first @xmath98-resolved , @xmath148 , which is most convenient in structures with two - dimensional periodicity .",
    "a @xmath98-integration then gives the result @xmath149    in eq .",
    "( [ eqbaranger ] ) , both the retarded and the advanced green functions are needed ; however , they are related through the identity ( [ eqgretgadv ] ) for real @xmath150 .",
    "this is used in our formulation ; the energy @xmath150 is identified in the calculations with the fermi level @xmath151 plus an ( in principle infinitesimal ) imaginary part @xmath152 which we take very small .    the case _",
    "( ii ) _ of wire - like structures is completely analogous , but the fourier transform of eq .",
    "( [ eqkkr2 ] ) is not performed .",
    "more specifically , consider a wire embedded in vacuum ( see also fig .",
    "[ figwire ] ) ; the vacuum region will be also divided artificially in volume - filling cells .",
    "one can also consider defects within the wire , or even two wires attached to some cluster of atoms ( as indicated in fig .",
    "[ figwire ] ) , and solve self - consistently for the electronic structure . due to electronic states at the surface of the wire , the first one or two vacuum layers above the wire surface can contribute to the conductance , but after that the cross section can be truncated .",
    "the cross sections left and right , where the conductivity tensor must be evaluated , consist always of more than one atomic cells , since one must include the vacuum region . in this way the green function must be considered for all combinations between cells on the left and the right , and the expression  ( [ eqbaranger ] ) for the conductance splits up in partial contributions corresponding to these combinations : @xmath153 with @xmath154 given by eq .",
    "( [ eqbaranger ] ) but integrated over single atomic cells .",
    "analogoulsy , in case _ ( iii ) _ a similar setup can be used if we consider semi - infinite 2d leads but current flow localized in space , as in the case of transport through a constriction . in this case",
    "we consider two planes as shown in figure  [ figwire ] ( right ) , while convergence must be checked with respect to the size of the regions considered in the summations of eq .",
    "[ eq:37 ]     and @xmath155 represent the directions of growth of the two leads .",
    "right : similar setup for the calculation in the case of nano - size constrictions between infinite leads .",
    "again a truncation at the dashed lines is taken , assuming that outside this region there is insignificant tunneling between the leads.,width=302 ]    figwire    in the next subsections we will consider the calculation of the spacial derivative of the local radial functions and the green function .",
    "firstly we consider a direct evaluation of the conductance by use of eq .",
    "( [ eqbaranger ] ) and calculation of the spacial derivative of the green function at exactly the plane surfaces left ( @xmath0 ) and right ( @xmath1 ) . both @xmath0 and @xmath1",
    "are assumed to be in the asymptotic region where the potential is stabilized to the bulk one and the evanescent states have decayed ; in practice one has to perform the calculations for several positions of @xmath0 and @xmath1 at finite distances to verify that the results remain unchanged .",
    "the set of atomic cells is volume - filling , and the plane surface cutting through them inherits the cellular structure used in the kkr method ; thus it is split in two - dimensional tesselating cells .",
    "each one of them is a convex polygon corresponding to the section of the plane that belongs to a convex voronoi polyhedron@xcite ( or just wigner - seitz cell in the monoatomic case ) . in this way",
    ", a two - dimensional cellular voronoi construction is defined in the plane , each cell of which is completely within some three - dimensional cell .",
    "therefore the representation of the green function in terms of local radial functions can be readily used .",
    "in fact , in systems with two - dimensional periodicity , a two - dimensional unit cell consisting of some convex voronoi polygons @xmath156 is constructed and the calculations can be confined in those .",
    "an example of the construction for bcc ( 001 ) surface cells is given in fig .",
    "( [ figvoronoi ] ) .",
    "figvoronoi    using such a construction , the @xmath98-resolved conductance is written as : @xmath157 where we have introduced the kkr current matrix elements @xmath158(in a similar fashion as has been done in the past@xcite ) in a cell as : @xmath159 the summation @xmath160 is over the voronoi polygons of the inequevalent atomic sites of the 2-d unit cells in the leads .",
    "the calculation of @xmath158 is described in appendix [ appb ] . in the case of a finite system , where a two - dimensional fourier transform is not necessary ,",
    "the summation is over all atoms in the planes @xmath0 and @xmath1 , and the @xmath98 dependence drops .",
    "the green function matrix elements @xmath161 , containing the information for the propagation from site @xmath162 at a layer within the left lead to a site @xmath162 at a layer in the right lead , are off - diagonal , while for the charge density one needs only the diagonal ( on - site ) elements . nevertheless , an efficient o(@xmath163 ) algorithm exists@xcite for their calculation within the screened kkr formalism , _",
    "i.e. _ , the time needed for the calculation scales linearly with the distance between the two layers .",
    "thus it is possible to calculate the conductance in junctions of more than 100 monolayers with present - day computers.@xcite      in this subsection we provide an alternative to the calculation of the surface - integrated current matrix elements of eqs .",
    "( [ eqcurrentplane1 ] ) and ( [ eqcurrentplane2 ] ) .",
    "we prove that the calculation can involve a volume integration over the unit cell , instead of a surface one ; in principle the results must be equivalent , but this method has advantages when one wishes to use the atomic sphere approximation .",
    "most important is , however , that the @xmath164-convergence is much better ( see sec .",
    "[ secexamples ] ) .",
    "first we observe that the value of the conductance is indeed independent of the position of the planes @xmath0 and @xmath1 .",
    "this can be proven using the fact that the conductivity tensor is divergenceless ( eq .  [ eqdivergenceless ] ) .",
    "say that @xmath81 is on @xmath1 ; if we consider a second plane surface @xmath165 close to @xmath1 , we can utilize gauss s theorem in the volume @xmath166 enclosed by the two planes , to convert a volume integral of eq .",
    "( [ eqdivergenceless ] ) in @xmath166 into a surface integral over @xmath1 , @xmath165 , plus side - areas .",
    "the construction is analogous to the one described in appendix  [ appa ] , as shown in fig .",
    "[ figvol2surf ] .",
    "the contribution from the side - areas vanishes because there we have either totally confining boundary conditions or born - von karman boundary conditions leading to cancelation from opposite side - areas due to the opposite surface unit vector orientation ; then we are left with @xmath167 .",
    "the same applies for @xmath0 , where @xmath155 varies ; thus the flux of @xmath168 , _",
    "i.e. _  the conductance , is independent of the exact position of @xmath0 and @xmath1 , _",
    "q.e.d._. in fact , following these arguments , we see that @xmath0 and @xmath1 do not even have to be planes ; for instance , they can follow the pattern of the wigner - seitz or voronoi cells , as long as they meet the requirement that they satisfy the born - von karman periodic boundary condition in @xmath134 and @xmath135 . in the case",
    "that they are not planar surfaces , one must of course take the flux of the conductivity tensor really along the normal @xmath169 pointing outward at each point of the surfaces , _",
    "@xmath170    figvol2surf    since the exact choice of @xmath1 or @xmath0 does not affect the result , one can average over the volume @xmath166 included between , say , @xmath1 and @xmath165 instead of integrating over @xmath1 .",
    "in particular , @xmath166 can be chosen to have a thickness @xmath171 equivalent to a unit cell in @xmath2-direction , so that one has to average over layer - adapted unit cells . in this respect , the conductance formula has the same form as eq .",
    "( [ eqbaranger3 ] ) , but with an extra prefactor of @xmath172 to account for the volume averaging in the two leads ( @xmath171 here is the distance between two consecutive lattice monolayers ) ; the current matrix elements @xmath173 , volume - averaged here in the atomic cells , have the form of eq .",
    "( [ eqcurrentplane1 ] ) but with the integral being three - dimensional over the atomic cell .",
    "this can be done both in the atomic sphere approximation ( asa ) and in the full - potential ( and full cell ) formalism .",
    "details about their calculation are given again in appendix  [ appb ] .",
    "a word of caution is due here : it is essential that the volume averaging leaves no `` holes '' in the structure . to be specific ,",
    "assume a bcc - like structure .",
    "then , as is evident from fig .",
    "[ figvoronoi ] , the voronoi cells of the first layer ( open circles ) can touch via the `` holes '' ( corresponding to the squares ) to the cells of the third layer . in this way ,",
    "the current can partly by - pass one monolayer traveling directly to the next one .",
    "if one just takes the current averaged over the voronoi cells or the asa spheres of the middle monolayer , one forgets to calculate this part of the current ; this is why the full many - atom unit cell must be taken , so that no such holes are left .    if one uses the usual wigner - seitz cells ( or atomic spheres ) , eq .",
    "( [ eqcurrentvol1 ] ) can induce a small inaccuracy .",
    "the reason is that the volume constructed by such cells is in general not included between planar surfaces , as in fig .",
    "( [ figvol2surf ] ) , but rather between corrugated surfaces , in accordance to the form of the wigner - seitz cells .",
    "in such a case , the full conductivity tensor @xmath174 ( not just the @xmath175 component ) and eq .",
    "( [ eqconductance2 ] ) should be used in principle . to avoid such a more complicated calculation ,",
    "two ways can be followed , as demonstrated in fig .",
    "[ figcellaverage ] .",
    "firstly , one can persist in using layer - adapted unit cells ( parellelepipeds ) , which give no corrugation .",
    "this has the disadvantage that such cells can be too flat so that the @xmath164 expansion of the cell - centered kkr green function and wavefunction converges poorly .",
    "secondly , one can average over more than one monolayers ; in this example they would be a - a , a - b , b - a , and b - b . then the corrugated region is a smaller fraction of the total averaging volume , so that the error becomes smaller .",
    "test calculations on this will be given in the section  [ secexamples ] for bulk al .",
    "which method , volume or plane integration , is most convenient and accurate depends on each specific problem ; however one can have `` rules of thumb '' on the difficulty and convergence of each one . in many systems",
    "the atomic sphere approximation is used , where the potential around each site is assumed to be spherically symmetric , but still a full multipole expansion of the charge density is taken .",
    "this has the advantage of greater simplicity and less computational effort than a full potential and full cell description . in such cases ,",
    "the plane integration is not applicable , since a plane cut through volume - conserving spheres can not give an accurate surface area ; the volume integration is then the only way . in the case of a full cell treatment ,",
    "when one has the correct wigner - seitz or voronoi volume tesselation , one must consider that the plane method has a drawback , namely that the plane might go through regions only at the edge of certain cells , where the @xmath176 cutoff seriously affects the accuracy of the results ; on the other hand the volume integration averages out such inaccuracies .",
    "one has also `` selection rules '' that make certain @xmath177 elements vanish .",
    "this is most easily seen if one uses spherical potentials . to be specific ,",
    "say that the plane goes through the atomic site at @xmath178 ; then , in the plane integration one can easily see that the elements @xmath177 are non - vanishing for @xmath179 when @xmath164 is even and for @xmath180 when @xmath164 is odd . on the other hand , in the case of volume integration",
    "the @xmath177 are non - vanishing only for @xmath181 , _",
    "@xmath177 is band - diagonal in @xmath164 and @xmath182 .",
    "this can be viewed as an advantage of the volume - averaging method , since it means that , if one describes the electronic structure with orbitals truncated at @xmath176 , for the accuracy of @xmath177 one has to consider wavefunctions only up to @xmath183 .",
    "a full cell treatment adds more nonzero elements , but the main contribution still comes from the ones mentioned .",
    "when the landauer formula is applied to a perfectly periodic material , _",
    "e.g. _ the bulk of a crystal , it gives a finite conductance which physically represents the conductance of a long wire placed between two phase - randomizing electrodes.@xcite resolved in @xmath98 , the value of the conductance equals the number of right - propagating ( or equivalently left - propagating ) states at @xmath151 for this @xmath98 . in other words , one has to count the fermi surface bands for that @xmath98 , which propagate in the direction @xmath184 with @xmath185 .",
    "this is demonstrated in fig .",
    "[ figalcond1 ] , where part of the fermi surface of al is presented , in the @xmath186-@xmath99 plane , together with the conductance in the @xmath2 direction as a function of @xmath186 ( with @xmath187 ) .",
    "actually , some of the bands shown have @xmath188 , but their equivalents with @xmath185 exist symmetrically for @xmath189 . clearly the conductance ( in units of @xmath190 )",
    "equals the number of bands at @xmath151 for each @xmath186 , giving a stepwise picture .    also in fig .",
    "[ figalcond1 ] we can compare the results for angular momentum truncation at @xmath191 , @xmath192 , and @xmath193 .",
    "increasing @xmath176 results in a more accurate description of the wavefunction derivative .",
    "basically the slower convergence here arises from the relatively high fermi energy of al , and is also present in a free - electron approach for high @xmath151 .",
    "as noted in the previous section , if the wavefunction is accurate for some @xmath176 , for the derivative one has to take @xmath194 . for most practical purposes ,",
    "@xmath195 is enough , considering also that the calculation time for @xmath196 is more than three times the one of @xmath195 ( due to matrix inversion , the calculation time scales roughly as @xmath197 ) .    in fig .",
    "[ figalcond2 ] the conductance for the same system is shown , but also analyzed in the various interlayer contributions .",
    "we see that these can exhibit fluctuations in @xmath98 , reflecting fluctuations as a function of the interlayer distance .",
    "however , when averaged over two monolayers on the left and two on the right , the fluctuations practically cancel each other .",
    "the origin of these fluctuations is the wigner - seitz construction for the unit cell , resulting in corrugation of the surfaces where the current is calculated . due to the fact that we account only for the @xmath198-component of the conductivity tensor , when we have corrugation the matrix elements in eq .",
    "( [ eqortha ] ) are not integrated correctly and the nondiagonal current matrix element do not vanish ; thus , beating effects of the conductance appear . as the conductance",
    "is averaged over more than one monolayers , the corrugation - free region in the middle increases , the relative error due to the corrugation decreases and the steps in the conductance become flat . if one would use tetragonal or prismatic unit cells , suited for layered geometry , then the fluctuations would be absent ; however such cells are not well - suited for an accurate calculation of the wavefunctions in kkr .",
    "-@xmath99 plane ( bottom ) and conductance ( in units of @xmath190 ) as a function of @xmath186 ( top ) for bulk al and for ( @xmath191 , @xmath192 , and @xmath193).,width=264 ]    figalcond1    , for @xmath196 .",
    "the fluctuations in the partial contributions come from artificial beating effects due to corrugation , and vanish in the averaging procedure .",
    "the inset shows some of the fluctuations in more detail.,width=264 ]    figalcond2    finally , in fig .",
    "[ figalcond3 ] we see a calculation for the same system , but employing the in - plane integration , rather than the volume averaging . here",
    "the convergence with @xmath176 is poor for the reasons explained in the previous section ; even for @xmath199 the deviations from integer conductance values are large .",
    "( top ) for bulk al ( @xmath191 , 3 , and 4 ) in the case of plane - integration .",
    "it is not necessary to average over more monolayers , but the @xmath164 convergence is rather poor and the integer valuer are not reached even for @xmath196.,width=264 ]    figalcond3      although the conductance should be calculated at a real energy @xmath150 , the green function in the kkr method is always calculated at a complex energy @xmath200 , and the real @xmath150 is approximated by taking very small , but nonzero , @xmath152 .",
    "this can have an artificial damping effect to the conductance , since waves within a small energy range around @xmath150 are effectively superimposed and finally the phase is randomized , especially if the leads are seperated by a large distance . in fig .",
    "[ figtemperature ] we show an example of how small @xmath152 should be in a realistic calculation .",
    "the system here consists of two fe leads with parallel magnetic moment seperated by a znse spacer .",
    "electrons are injected from the first lead into the znse conduction band , and are detected by the second fe lead .",
    "the spacer thickness is varied from 9 to 97 monolayers , and due to the multiple reflections at the two interfaces transmission resonances appear at certain thicknesses . for more information",
    "we refer to ref .  .",
    "the conductance of the majority electrons for @xmath201 , _",
    "i.e. _ , at the @xmath202-point , is presented in fig .",
    "[ figtemperature ] for a choice of @xmath203  mry , 0.2  mry , and 1  mry . for @xmath204  mry",
    "there is strong artificial damping , while @xmath203  mry is adequate even for the large thickness of 97 monolayers .",
    "note that this damping can not model an effect of temperature , because , when we depart from the real axis , the spectral density of a state transforms from a delta function to a lorenzian distribution and not to the derivative of the fermi function .",
    "due to the long tails of the lorenzian the damping is much stronger than for a fermi distribution of the same halfwidth .     of the energy .",
    "conductance ( in units of @xmath190 ) as a function of spacer thickness for spin injection through the conduction band in a fe / znse / fe ( 001 ) junction .",
    "the oscillations are due to multiple reflections . for @xmath204  mry",
    "there is strong artificial damping , while @xmath203  mry is adequate even for the thickness of 97 monolayers.,width=264 ]    figtemperature",
    "we have presented a formalism for the calculation of ballistic conductance in solids , based on the kkr green function method for the ground - state electronic structure combined with the landauer - bttiker approach .",
    "it makes use of the result of baranger and stone@xcite connecting the derivative of the one - electron green function to the conductance . for the foundation of the formalism",
    ", we have discussed the relation of the @xmath38-matrix between bloch in- and out - states to the conductance .",
    "we have given an expression connecting the @xmath38-matrix to the green function of the system , generalizing the theory of baranger and stone to include the realistic band structure of the leads .",
    "the convergence of the method with angular momentum cutoff ( @xmath176 ) was studied and found to be comparable to that of kkr .",
    "it can be applied to systems with two - dimensional periodicity as well as nanowires .",
    "our results show that the volume integration and averaging of the current matrix elements , applicable both in asa and full - cell or full - potential approaches , gives well - converged results for the calculation of ballistic transport . owing to the linear scaling of the calculational effort with the number of layers of the screened kkr formalism ( o(@xmath163 ) scaling ) ,",
    "our method is suitable for large systems .",
    "the authors are grateful to professor n.  stefanou for helpful and motivating discussions . moreover ,",
    "financial support from the rt network of _ computational magnetoelectronics _ ( contract rtn1 - 1999 - 00145 ) of the european commission is gratefully acknowledged .",
    "let @xmath205 and @xmath206 be two bloch wavefunctions of the same hamiltonian at the same energy .",
    "then we shall prove that the following relation holds : @xmath207 where @xmath38 is an ( infinite ) cross - sectional area in @xmath134 and @xmath135 directions .",
    "the proof has as follows : first we note that , as a consequence of the single - particle schrdinger equation for a real potential , @xmath208 where the band indices @xmath58 and @xmath209 are used explicitly .",
    "this is just an expression for current conservation of hamiltonian eigenstates .",
    "then , for each volume @xmath166 enclosed by a geometrical surface @xmath38 , gauss s theorem gives @xmath210 where @xmath169 is a unit vector at the surface @xmath38 pointing outward .",
    "in particular , @xmath166 can be chosen as a prismatic normal cross section of the lead , extending from @xmath2 to @xmath211 .",
    "then its surface @xmath38 can be decomposed in two plane cross sections @xmath212 at @xmath2 and @xmath213 at @xmath211 , as the bases of the prism , plus side - areas @xmath214 at the lead surface , as shown in fig .",
    "[ figvol2surf ] . at these side areas we either have confining boundary conditions , _",
    "@xmath215 , whence @xmath216 or born - von karman periodic boundary conditions , whence for each prism side there is the opposite one with the _ same _ value of @xmath217 and @xmath218 but with _ opposite _ orientation unit vector @xmath169 ; then the sum of their contributions to the surface integral will be again zero . in this way ,",
    "we are left with the two bases of the prism ; they have opposite unit vector orientations , thus : @xmath219 or @xmath220 _",
    "i.e. _  @xmath221 is independent of the position @xmath2 of the cross - section @xmath38 .",
    "this means that one can average it over the whole born - von karman supercell ( in @xmath2 ) of length @xmath222 and volume @xmath223 : @xmath224 we now convert the volume integral in a sum over unit - cell integrals @xmath225 and employ the bloch property @xmath226 to get : @xmath227 where @xmath163 is the total number of lattice sites in @xmath228 , and @xmath229 has been used ; @xmath230 is the unit - cell volume .",
    "note that @xmath231 , thus @xmath232 , and we get : @xmath233 for @xmath234 this gives zero , while for @xmath235 and @xmath236 we have @xmath237 eqs .",
    "( [ eqa10 ] ) and ( [ eqa9 ] ) verify ( [ eqa0 ] ) except in the case of band crossing , when @xmath235 but @xmath238 . in this case we may use the identity connecting the momentum operator @xmath239 to the hamiltonian @xmath240 and the position operator @xmath241 : @xmath242 { \\label}{eqa11}\\ ] ] for the evaluation of ( [ eqa5 ] ) we need the matrix element of @xmath243 . using ( [ eqa11 ] )",
    "we get @xmath244 in case of band crossing , @xmath245 , but this does not mean that the whole expression vanishes , since the integral might diverge . it can be calculated in a standard way by utilizing bloch s theorem and reducing it to the unit cell .",
    "we have : @xmath246 using the bloch properties of @xmath205 and @xmath247 and the relations : @xmath248 we obtain after some manipulations @xmath249 in all terms , @xmath250 can be directly substituted due to the @xmath251-function , except in the last one , where the one must first perform the integration and the derivation . in the second term , the orthogonality relation @xmath252 after the substitution",
    "@xmath250 has been used . from this expression",
    "we immediately see that in the case of band crossing , _",
    "@xmath250 , @xmath253 , but @xmath238 , the expression vanishes , so the proof is complete . in passing we",
    "note that , if @xmath254 , the expression gives the group velocity as expected .",
    "in the plane - integration formalism the kkr current matrix elements read @xmath255 where @xmath256 is the surface cut of the atomic cell @xmath40 with the plane passing through it . in the full - potential kkr formalism",
    ", the wavefunctions are expanded in terms of real spherical harmonics as @xmath257 the real spherical harmonics are of the form @xmath258 where @xmath259 @xmath260 are the legendre functions , and @xmath261 , if @xmath262 or @xmath263 , if @xmath264 .",
    "thus one has to decompose @xmath265 into @xmath266 , @xmath267 and @xmath268 .",
    "the first affects only the radial part @xmath269 and is calculated numerically ; the other two affect only @xmath270 and are calculated analytically .",
    "after some algebra one arrives at the result @xmath271 \\nonumber\\\\ & \\times&\\sum_{l_1 } \\alpha_{l_1 } p_{l_1}^{|m_1|}(\\cos\\theta ) r_{l_1 l}(r ) \\sum_j \\int_{\\phi_{\\mathrm{entry}}^j}^{\\phi_{\\mathrm{exit}}^j } \\mathrm{trg}(m_1\\phi)\\mathrm{trg}(m_2\\phi)\\,d\\phi   \\ , .",
    "{ \\label}{eqcurrentplane2}\\end{aligned}\\ ] ] here , @xmath272 and @xmath273 are the radii of the inscribed and circumscribed circles , respectively , of the convex polygon , on which the @xmath274-integration is performed , with center the @xmath2-projection of the atomic site on the plane ; @xmath275 and @xmath276 are respectively angles of entry into and exit from the convex polygon as the @xmath274-integration is performed .      in the full cell approach , the potential is truncated at the boundary of the voronoi atomic cell .",
    "this is achieved by introducing the characteristic , or `` shape '' , functions @xmath278 , being equal to unity in the cell and vanishing outside.@xcite their expansion in spherical harmonics , @xmath279 is used in the calculation of the current matrix elements . after some manipulations we obtain @xmath280\\end{aligned}\\ ] ] where @xmath281 are the gaunt coefficients and the identity @xmath282 has been used .",
    "the asa result is simpler since it does not involve the shape functions .",
    "the local orbitals have only a spherical part , @xmath283 whence the current matrix elements become @xmath284 it is implied that the integrals are within the atomic sphere .",
    "this can be best understood in a simple one - dimensional model of a free electron of wavenumber @xmath285 encountering an infinitely long step barrier of height @xmath230 where the wavenumber is @xmath286 .",
    "the transmission amplitude is @xmath287 , while the transmission probability is @xmath288 .",
    "l.  i.  schiff , _ quantum mechanics _ , 3rd ed .",
    ", mcgraw - hill ( 1968 ) ; r.  g.  newton , _ scattering theory of waves and particles _ , 2nd ed . , springer , 1982 ; a.  bohm , _ quantum mechanics : foundations and applications _",
    ", springer,1986 .",
    "we remind the reader that voronoi polyhedra are volume - filling convex polyhedra around the atomic sites that correspond to a wigner - seitz construction , but for arbitrary ( not necessarily periodic ) positions of the atomic sites ; moreover , one can choose a certain `` weight '' for each atom type in order to give it more or less volume fraction ."
  ],
  "abstract_text": [
    "<S> we develop a method for the calculation of ballistic transport from first principles . </S>",
    "<S> the multiple scattering screened korringa - kohn - rostoker ( kkr ) method is combined with a green s function formulation of the landauer approach for the ballistic transport . </S>",
    "<S> we obtain an efficient o(n ) algorithm for the calculation of ballistic conductance through a scattering region connected to semi - infinite crystalline leads . </S>",
    "<S> in particular we generalize the results of baranger and stone in the case of bloch wave boundary conditions and we discuss relevant properties of the s - matrix . </S>",
    "<S> we consider the implications on the application of the formalism in conjunction with a cellular multiple scattering description of the electronic structure , and demonstrate the convergence properties concerning the angular momentum expansions . </S>"
  ]
}