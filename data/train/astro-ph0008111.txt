{
  "article_text": [
    "during the next few years ground based observations and balloon missions @xcite as well as satellite observation @xcite promise exquisite determinations of the angular distribution of cosmic microwave background ( cmb ) anisotropies .",
    "inflationary cosmogonies , the most popular theories of structure formation , predict a statistically isotropic cmb with gaussian fluctuations . to linear order in perturbation theory",
    "this means that within this class of models all cosmologically relevant information contained in the map of anisotropies is distilled in the angular power spectrum @xmath0 .",
    "an accurate estimate of these quantities therefore promises to have tremendous impact on our knowledge of the global properties of the universe and the physical processes which lead to the formation of structure@xcite .",
    "this knowledge is quantified in terms of cosmological parameters such as @xmath1 , @xmath2 , @xmath3 , _",
    "etc_.    the @xmath0 are uniquely defined as rotationally invariant quadratic combinations of the coefficients of an expansion of the anisotropy @xmath4 in spherical harmonics .",
    "their useful statistical properties rest on the the fact that the spherical harmonics are a complete and orthogonal basis set on the sphere",
    ". however , in realistic experiments , only part of the celestial sphere is covered , if only because our cmb sky is obscured by the milky way .",
    "also , due the particulars of the observational strategy , non  uniform and possibly correlated noise contaminates the observed signal . in order to interpret past observations and forecast the impact of future observations we need a framework for studying the sampling statistics of the @xmath0 for incomplete sky coverage in the presence of non  uniform noise .",
    "it is worth noting that there are several different kinds of @xmath0 which we will be referring to in this paper .",
    "the stochastic nature of the observed @xmath0 is illustrated in figure [ fig : mc ] , where the straightforward computation of @xmath0 from a subset of our monte carlo simulations of incomplete and noisy skies are overlaid on the theoretical predictions .",
    "one or more of the following simplifying assumptions can be invoked in cases where one would like to avoid the full complexity of the problem ( _ e.g .  _",
    "@xcite ) :    * ( independence ) the observed @xmath0 are approximately independent due to nearly full and uniform sky coverage , * ( scaled @xmath5 ) their sampling distributions do not change appreciably from the @xmath5 distributions which apply for the full sky , apart from a rescaling of the number of degrees of freedom by the sky fraction @xmath6 , and * ( gaussianity ) their sampling distributions are well  approximated by gaussian distributions which have the same first and second moments as these rescaled @xmath5 distributions .",
    "there are several reasons to carefully assess these approximations and , if necessary , go beyond them .",
    "one reason is that in the short term balloon and ground based experiments will provide the leading edge science results to the field . due to practical limitations",
    "we can not hope to even come close to full sky coverage with these types of experiments .",
    "the observation regions are often ring  shaped or cover a circular region of the sky which subtends a small solid angle .",
    "it is an urgent matter to assess statistically how these imminent experiments can constrain the power spectrum and cosmological parameters .",
    "further , the planned satellite missions are aiming to determine the @xmath0 to sub  percentage accuracy . in the case of the planck surveyor mission ,",
    "this has given us the hope of detecting small effects such as secondary anisotropies which are due to nonlinear gravitational effects on the cmb photons during the free  streaming epoch .",
    "an example of such an effect is anisotropies due to gravitational lensing .",
    "this is an important issue because a detection would break otherwise present parameter degeneracies and allow a consistent parameter estimation from cmb data alone @xcite .    more generally , the impact cmb observations will have on cosmology makes it important to use approximations in a controlled way .",
    "for example , in the analysis of cobe  dmr data it was realized that using gaussian approximations for quadratic quantities introduced systematic biases @xcite . at the same time , we need approximations to make feasible the analysis of the huge cmb data sets we expect in the coming years .    the maximum likelihood inversion ( mli ) method ( cf .",
    "@xcite for applications in a cosmological context ) is the standard framework for solving this type of problem . to illustrate",
    ", we write down the likelihood functional for a gaussian sky . in order to do",
    "so we need to define the vector of observed pixel temperatures on the sky @xmath7 with @xmath8 components . a given theory and observational strategy on the sky",
    "imply the covariance structure of the elements @xmath9 in terms of signal and noise covariance matrices @xmath10 and @xmath11 such that @xmath12 the signal covariance matrix @xmath13 is simply a discretised version of the theoretical angular correlation function @xmath14 evaluated at the pixel locations .",
    "the noise covariance @xmath11 reflects those imperfections of the experiment and observational strategy which lead to spatial correlations in the projected noise .",
    "this leads to an expression for the likelihood @xmath15 the matrix @xmath10 is a function of predicted @xmath0 , which are in turn determined by the parameters of some theory .",
    "the matrix @xmath11 includes a model of the expected noise covariance given the experimental setup .",
    "the structures of both @xmath10 and @xmath11 also depend on the observed region on the sky .",
    "for a given set of data the likelihood is then considered as a function of the parameters of a given theory .",
    "the maximum likelihood parameter estimates are determined as those which maximise eq .  ( [ likelihood ] ) . while these manipulations are conceptually simple , the practical difficulties are apparent .",
    "the number of operations needed to evaluate eq .",
    "( [ likelihood ] ) ( or equivalently an estimator derived from it ) scales as the most costly operations contained in it .",
    "these are the determinant evaluation in the denominator and the matrix inverse in the exponent . for a general situation",
    "both of these require @xmath16 operations .",
    "in the near future @xmath8 will be @xmath17 from balloon experiments ( such as maxima ) , then @xmath18 for map and in less than a decade @xmath19@xmath20 for planck .",
    "these numbers imply @xmath21@xmath22 computations . even when considering future growth in computing performance , estimates of the computational time required to evaluate eq .",
    "( [ likelihood ] ) a single time reach up to many years @xcite . to compute the maximum likelihood estimator",
    "requires many likelihood evaluations and would thus require an unfeasibly long period of time . for practical purposes , straightforward applications of the mli method therefore fail to give answers in finite computational time .",
    "previous studies of this subject have usually directly addressed the problem of `` solving for the @xmath0 '' .",
    "tegmark @xcite rejects the maximum likelihood estimator on the grounds that it is too time  consuming to compute and suggests a minimum variance ( and hence `` optimal '' ) method based on a quadratic estimator which makes a form of the gaussianity assumption above .",
    "while this method is powerful in the regime where it is applicable , it does not provide a means of assessing the validity of this assumption . within our analysis",
    "we can make the connection between the minimum variance and the maximum likelihood methods ( cf .",
    "subsection [ leastsquaresest ] ) .",
    "the approach of bond , jaffe and knox @xcite is again very different from ours .",
    "it consists in finding an approximate form for the likelihood and parametrising the shape of the power spectrum in terms of a set of top hat functions , whose height gives the average value of the @xmath0 over its width .",
    "the width of these top hats is chosen wide enough that correlations between them become small .",
    "their method is of practical significance because their approximate ansatz for the likelihood is easy to evaluate .",
    "our perspective is the following : we endeavour to provide an _ ab initio _ formalism which lays bare the statistical properties of the power spectrum coefficients .",
    "it then turns out that the insight gained from this study can be used to formulate unbiased and well  controlled methods for parameter estimation .    to provide a quantitative basis for this discussion we present in this paper an efficient semi  analytic calculational framework within which the statistical properties of the @xmath0 power spectrum coefficients can be studied for theories which generate a gaussian cmb sky .",
    "this framework is exact for the important class of survey geometries and noise patterns which obey rotational symmetry about one arbitrary axis and is not limited to large sky coverage .",
    "this class contains both skies with symmetric and asymmetric cuts north and south of the galactic equator , rings , annuli , and polar cap shaped regions of any size as indicated in figure [ fig : cutsky ] . for this class",
    "we obtain exact analytical solutions for the mean @xmath23 , the variance @xmath24 , the skewness , kurtosis and all higher moments of the sampling distribution for all @xmath25 . we derive exact and conveniently computable analytic expressions for the marginalised probability distributions of the cut sky @xmath0 for all @xmath25 as well as integral representations for the joint distribution of all @xmath0 . as an added bonus we find that our methods also allow dealing with arbitrary noise patterns to very good accuracy and",
    "conclude by illustrating their use in some applications .    to test our results",
    "we perform state  of  the  art monte carlo simulations for a high resolution cmb satellite with a galactic cut of size @xmath26 ( resulting in a sky coverage comparable to cobe ) .",
    "we use a sine modulated noise template as a simple model of the noise pattern which would result from scanning along great circles through the ecliptic poles .",
    "the numerical results we obtain provide a solid check on our analytic calculations .",
    "the plan of this paper is as follows : in section [ quad : general ] we lay out the general framework .",
    "section [ quad : pclstats ] develops the statistical theory of power spectrum coefficients for observation regions which are azimuthally symmetric about some axis .",
    "we arrive at expressions for the cut ",
    "sky moments of any order and solve the moment problem to obtain the exact sampling distributions .",
    "we compare our analytical results to monte ",
    "carlo simulations in section [ quad : results ] .",
    "several applications of our methods are presented in section [ quad : applications ] .",
    "section [ quad : conclusions ] contains further discussion and our conclusions .",
    "appendix [ quad : loworder ] discusses the effects of non - cosmological foregrounds on the results presented in this paper .",
    "details of our analytical and numerical techniques are given in three further appendices .",
    "the full sky of cmb temperature fluctuations can be expanded in spherical harmonics , @xmath27 , as @xmath28 where @xmath29 denotes a unit vector pointing at polar angle @xmath30 and azimuth @xmath31 .",
    "here we have assumed that there is insignificant signal power in modes with @xmath32 and introduce the convenient notation that all sums over @xmath33 run from @xmath34 to @xmath35 but all quantities with index @xmath36 vanish for @xmath37 .    in a universe",
    "which is globally isotropic and contains gaussian fluctuations , the @xmath38 are independent , gaussian distributed with zero mean and specified variance @xmath39 .",
    "hence , for noiseless , full sky measurements , each measured @xmath0 independently follows a @xmath5distribution with @xmath40 degrees of freedom and mean @xmath41 . owing to galactic foregrounds , limited surveying time or other constraints inherent in the experimental setup , the temperature map that comes out of an actual measurement will be incomplete .",
    "in addition , a given scanning strategy will produce a noise template : high noise per pixel results in regions where the scanning lines are less densely packed compared to regions where they are denser .",
    "we model the noise as a gaussian field with zero mean which is independent from pixel to pixel and modulated by a spatially varying root mean squared amplitude @xmath42 ( the factor of @xmath43 appearing because the noise too is zero in unobserved regions ) .",
    "therefore the observed temperature anisotropy map is in fact @xmath44 \\label{realtemp}\\ ] ] where @xmath43 is unity in the observed region and zero elsewhere .",
    "the coefficients in the spherical harmonic expansion recovered from such an incomplete observing region are @xmath45 the notation `` @xmath46 '' denotes integration over the observed region .",
    "note that the usual orthogonality property of the @xmath47 does not hold any longer because we do not integrate over all solid angle .",
    "this becomes clearer if we define the _ geometric coupling matrix _",
    "@xmath48    and write @xmath49 by definition , the @xmath50 are just the matrix elements of the @xmath51 window in a spherical harmonic basis .",
    "these matrices have been previously discussed in a similar context in the pioneering papers by peebles and hauser @xcite .",
    "this means that expanding @xmath52 as in eq .",
    "( [ eq : palms ] ) produces a set of _ correlated _ gaussian variates @xmath53 for the signal and @xmath54 for the noise .",
    "these combine into power spectrum coefficients @xmath55 whose statistical properties differ from the ones of the @xmath0 .",
    "we therefore refer to these quantities as _ pseudo_-@xmath0 . in what follows",
    "we will discuss the statistical properties of these quantities .",
    "let us focus on the terms of the sum eq .",
    "( [ pcldef ] ) .",
    "they are squares of gaussian distributed variates with zero mean .",
    "it follows that the @xmath57 are sums of @xmath40 @xmath5 variates with one degree of freedom .",
    "however , each term in the sum has a different expectation value and may in general be correlated , so the @xmath57 are _ not _",
    "@xmath5 distributed with 2l+1 degrees of freedom .    if we assume white noise , @xmath58 , then each term in the sum has expectation value @xmath59 a few remarks are in order :    1 .",
    "azimuthal symmetry has not been invoked to derive this relation .",
    "2 .   the cross  term which comes from expanding the square in eq .",
    "( [ pcldef ] ) has vanishing expectation value because signal and noise are assumed to be uncorrelated .",
    "the sum over @xmath0 includes the non ",
    "cosmological @xmath60 and @xmath61 terms .",
    "the appearance of these terms merits some further discussion , which we relegate to appendix [ quad : loworder ] .      summing eq .",
    "( [ slm ] ) over @xmath33 gives a set of linear equations which also results in a different context , namely after minimising the variance of the @xmath0 estimator in tegmark @xcite .",
    "there it appears as a set of linear equations for the estimator , which the author assumes to be gaussian distributed .",
    "we see from our treatment that this equation is only valid after the expectation values are taken .",
    "the quantities involved are _",
    "quadratic _ in gaussian variates which leads to the presence of a cross term which only disappears after taking the expectation value .",
    "this is the reason why some @xmath0 estimates in @xcite turn out negative for values of @xmath25 where the signal to noise ratio becomes of order unity .",
    "this is of course unphysical because the @xmath0 are properly quadratic and hence positive semi",
    " definite quantities .",
    "we observe that it is precisely neglecting this fact which leads to unphysical results .",
    "on the other hand , our treatment provides alternative proof of the fact that the least  squares estimator is unbiased .",
    "it also explains the significance of the fisher matrix which appears in this context : is simply a measure of the geometric couplings between eigenmodes of total angular momentum .      to elucidate the correlation structure between the @xmath53 , eq .",
    "( [ eq : palms1 ] ) , we write eq .",
    "( [ pcldef ] ) as a quadratic form @xmath62 in independent normal variates @xmath63 with zero mean and unit variance .",
    "the object @xmath64 describes the combined effect of statistical correlation and the geometrical couplings between the various expansion coefficients .    for an isotropic gaussian field on the full sky @xmath65",
    "we show in appendix [ quad : factorise ] that for a gaussian field with an anisotropic but azimuthally symmetric weight function @xmath66 , @xmath64 is of the form @xmath67 where @xmath68 and we assume identical windows for signal and noise for notational simplicity in eq .",
    "( [ mstruct ] ) .",
    "the generalisation for arbitrary azimuthally symmetric noise windows is straightforward .    the structure exhibited in eqs .",
    "( [ mstruct ] ) and ( [ eq : mazim ] ) is the key fact which allows the derivation and cheap evaluation of the exact results we obtain .",
    "an efficient algorithm for the evaluation of the matrix elements of @xmath43 is given in appendix [ quad : couple ] .",
    "for a maximum @xmath25 of 1024 this takes just over one minute on a single r10000 cpu .",
    "it follows that while the @xmath69 terms in eq .",
    "( [ pcldef ] ) are correlated for different @xmath25 , they will be _ independent _ for different @xmath33 . as a consequence , under the assumption of azimuthal symmetry the @xmath57",
    "are sums of independent chi  squared ( @xmath5 ) variates , each with one degree of freedom but different expectations .",
    "below we succeed in finding analytical expressions for the probability density functions of such generalised @xmath5 variates and we hence solve for the statistical properties of the pseudo@xmath0 exactly .      the problem is to compute the statistical properties of a sum of independent variates , each of which has a known distribution . a useful tool for attacking this kind of problem is the method of characteristic functions @xcite .",
    "appendix [ quad : cfs ] provides a heuristic introduction to this method .",
    "the characteristic function of a @xmath5 variate with one degree of freedom is given by @xmath71 we can multiply them together for each term in the sum eq .",
    "( [ pcldef ] ) and inverse fourier transform to obtain @xmath72 as @xmath73 the log of the integrand in this expression ( not including the complex exponential ) is the cumulant generating function , which we can differentiate to obtain _ all _ cumulants of the pseudo@xmath0 as @xmath74    we give the following expressions for the mean , variance , skewness @xmath75 and kurtosis @xmath76 as examples : @xmath77      it turns out that we do not have to contend with just the cumulants .",
    "we will now derive the analytical form for the pseudo@xmath0 distributions .",
    "we define @xmath78 and note that @xmath79",
    ". then all terms with equal @xmath80 pair up and we obtain @xmath81 where @xmath82 .",
    "we expand in partial fractions and integrate each term analytically ( using a standard integral from @xcite ) to produce a closed form solution in terms of incomplete gamma functions @xmath83 : @xmath84 where the primed product symbol @xmath85 only multiplies factors which have @xmath86 and the normalization constant is @xmath87    we have , therefore , reduced the problem of determining the sample probability density of the pseudo@xmath0 to computing the @xmath88 .",
    "the computation of these coefficients has to be done only once for a given survey geometry and model theory .",
    "in fact it is clear from their definition and eq .",
    "( [ slm ] ) that once the @xmath89 are computed for a given survey geometry , the @xmath88 can be generated very easily given a model @xmath0 spectrum .",
    "the distributions we have just derived are 1-point or marginal distributions .",
    "they contain complete statistical information about each @xmath57 taken for itself , but they only account for the correlations between @xmath0 implicitly , giving an effective distribution for each @xmath57 which contains these correlations . to obtain explicit information about the full _ joint _ distribution of all @xmath57",
    "we must go a step further .",
    "while we wish to relegate further study of the properties of the joint distribution to future work we will now mention some preliminary results .",
    "the characteristic function of the joint distribution of quadratic forms such as eq .  ( [ quadform ] ) has been studied in the literature @xcite .",
    "fourier transforming we can obtain an integral representation of the joint distribution ( analogously to eq .",
    "( [ charfunc ] ) for the 1-point distributions ) @xmath91    even though we can not proceed further in the fourier inversion or must take recourse to approximate methods , we can still gain useful information about the joint statistics of the set of @xmath0 . similarly to subsection [ quad : moments ] we can derive the cumulants of the variates from the logarithm of the integrand ( disregarding the complex exponential ) . it is easy to show that for the covariance between the pseudo@xmath0 we can write @xmath92 it turns out that higher order joint moments are computed similarly in terms of traces of products of @xmath93 of various @xmath25 . note that these expressions are valid in general , but the special form of @xmath93 in the case of azimuthal symmetry will reduce the scaling of the computational cost for their evaluation .",
    "returning to the case which we have fully solved , let us perform a reality check on the assumptions we have made . there are some important situations where the noise pattern does _ not _ follow the azimuthal symmetry of the survey geometry . in the case of the planck satellite the scanning strategy is approximately centered on the ecliptic poles , while the galactic cut is tilted through @xmath94 with respect to this . in this case",
    "( [ probdist ] ) becomes an approximation .",
    "we found it to be very accurate indeed to continue using these distributions with the @xmath95 computed for an asymmetric @xmath96 , even for a strongly asymmetric noise pattern .",
    "this approximation will be worst in the least interesting , noise dominated regime at very high @xmath25 .",
    "note that the @xmath95 and hence the @xmath97 remain exact ( because the @xmath98 are independent of the azimuth ) but the remarks leading to eq .",
    "( [ probdist ] ) are no longer exactly true . for applications",
    "the final justification comes from the excellent agreement we find when we check against our monte carlo simulations which is illustrated in figure [ pcldists ] .",
    "in fact all the applications we present in the following were computed using strongly asymmetric noise patterns .",
    "to test our formalism we performed 3328 monte carlo ( mc ) simulations for a high resolution cmb satellite , such as map or planck ( resulting in a sky coverage comparable to cobe ) .",
    "we simulated realizations of the cmb sky in the standard cold dark matter model(@xmath99 , @xmath100 , @xmath101km / s / mpc ) . from these maps we carved out a @xmath26 galactic cut and contaminated the remaining area with spatially modulated gaussian white noise of maximum root mean squared temperature @xmath102 per pixel of characteristic size 3.4 arcminutes .",
    "we use a tilted noise template @xmath103 , where @xmath104 is the ecliptic latitude , as a simple model of the noise pattern which would result from scanning along meridians through the ecliptic poles .",
    "we then fourier analysed these maps and stored the resulting @xmath57 .    to give a visual impression of the resulting probability densities",
    "we show four cases in figure [ pcldists ] .",
    "these cases were chosen to represent different regimes .",
    "the first case , @xmath105 is especially sensitive to effects due to the cut sky and an important region for the overall normalisation of the power spectrum .",
    "two cases for intermediate @xmath25 ( @xmath106 , @xmath107 ) probe cosmologically interesting scales ( on top of the first acoustic peak and in the first trough of the standard cold dark matter spectrum we use ) . at high @xmath25 , @xmath108",
    ", there is a significant noise contribution .",
    "next to our analytical results we show the histogrammed results from our mc simulations .",
    "a kolmogorov ",
    "smirnov test failed to detect deviations between the distributions of this mc population and eq .",
    "( [ probdist ] ) at 99% confidence , which validates our semi  analytic expressions .    also shown in figure [ pcldists ] are the @xmath5 distributions which the @xmath0 would follow in the full sky case as well as the commonly used gaussian approximation @xcite .",
    "these are mean adjusted to account for the lost solid angle due to the galactic cut . at @xmath109",
    "the difference is striking . for higher @xmath25",
    "the gaussian approximation becomes better as higher moments die away by dint of the central limit theorem , but there remain visible systematic differences to the true distributions .",
    "in particular , there is a residual shift in the mean and the approximations tend to be slightly narrower than the histograms for very high @xmath110 .",
    "this becomes a more quantitative observation when looking at the percentage discrepancies between the mean and variances as a function of @xmath25 in figure [ moments ] .",
    "the discrepancy is of the order of 1 % in the mean and 5% in the standard deviation on most scales , except for @xmath111 where the effect is larger .",
    "these discrepancies are important at the level of precision of future almost full sky missions . for medium and small sky coverage",
    "the mode couplings are stronger and we expect this to have an even larger effect on the probability distributions .",
    "we also compare the skewness @xmath112 and kurtosis @xmath113 of the @xmath5 distributions to our distributions . the percentage difference is larger than for the first two moments but arguably less important at large @xmath25 , since @xmath112 and @xmath113 decay as @xmath114 and @xmath115 , respectively .",
    "as a first application we study the effect of approximating the likelihood for parameter estimation . since our distributions have the correct means , we simply multiply them together for a simple , unbiased approximation to the likelihood @xmath116 this is a conservative approximation in the sense that we will not overestimate the estimation accuracy since the marginal distributions have all correlations _ integrated _ out and we will therefore overestimate the error bars on the @xmath0 . using this likelihood , as well as the gaussian and @xmath5 approximations , we attempt to estimate the baryon parameter @xmath2 ( holding all other parameters constant ) from several randomly selected realizations in our mc pool .",
    "the results are shown in figure [ obbias ] .",
    "as expected , gauss and @xmath5 consistently find estimates which are biased about 1.6% high , 3 standard errors of the mean away from the true value , while our likelihood gives a perfect fit .    since the moment discrepancies depend on the underlying cosmological theory , this level of bias will also depend on the true theory .",
    "therefore , this number should only be taken as indicative of the general level of the error introduced by using the naive gaussian or @xmath5 approximations .",
    "we demonstrated in the previous subsection that we can use our formalism to construct approximate forms for the likelihood which lead to an unbiased parameter estimate .",
    "the idea proposed in this subsection is motivated by the fact that higher moments of the @xmath57 distributions die away quickly with @xmath25 ( cf .",
    "( [ meanetc ] ) ) especially for observation geometries with large sky coverage .",
    "in particular we found in the case we studied that the distributions were visually indistinguishable from gaussians for @xmath117 . for parameters which are sensitive to high @xmath25 modes , we therefore further approximate eq .",
    "( [ likelihood_approx ] ) by replacing the pseudo@xmath0 pdfs with gaussians with the same mean and the same variance , @xmath118 \\label{likelihood_approx_approx}\\ ] ] in this approximation , maximum likelihood estimation has reduced to simple @xmath5 fitting , however with the correct means and variances which implicitly account for inter-@xmath0 correlations .    the operation",
    "count for each likelihood evaluation has now dropped to @xmath119 .",
    "if the computation of the first and second pseudo-@xmath0 moments is organised in a memory ",
    "efficient manner the elements of the coupling matrix need to be computed only once .",
    "we find that we can evaluate eq .",
    "( [ likelihood_approx_approx ] ) at a rate of several hundred times per hour .",
    "this surprisingly slow scaling of the computational cost with number of theories is presumably due to more efficient use of on  processor caching .",
    "to illustrate , we solve the problem of estimating 3 parameters ( @xmath120 @xmath2 and @xmath3 ) simultaneously from a sky with @xmath121 pixels . to compare with the naive gaussian approach and to show that our method is unbiased , we compute maximum ( approximate ) likelihood estimates from 100 realisations of the sky and plot a representation of the the empirical distribution of parameter estimates in three dimensions in figures [ stupid3d ] ( naive @xmath5 ) and [ pcl3d ] ( our approach ) .",
    "we find again that our approach is unbiased .",
    "the distributions of the estimates are clearly centered on the true values .",
    "we stress that our approach avoids the usual difficulties of the gaussian approximation as discussed in section [ leastsquaresest ] . for example , even though we use the gaussian approximation , which of course does not exclude negative @xmath0 , they are assigned an exceedingly small probability .",
    "this is because no attempt is made to subtract out the noise contribution from the pseudo@xmath0  instead it is modeled consistently and the ( signal@xmath122noise ) cross term which is present in each realisation is not allowed to dominate .",
    "we now mention an application which reverses our way of thinking about the results in this paper and takes advantage of the exact analytical expressions we compute for the pseudo@xmath0 distributions .",
    "imagine that we have gained knowledge that a certain theory is correct , for example through measurements of the large scale structure of the galaxy distribution and other probes of cosmology such as supernovae _",
    "etc_. then we can use the formalism shown here as a test of gaussianity , simply by computing the pseudo@xmath0 and then substituting them into eq .",
    "( [ probdist ] ) .",
    "an interesting feature is that this probes gaussianity scale by scale which might make it feasible to disentangle confusion effects if the non  gaussian signal was only apparent on a small range of scales and masked by a gaussian component on other scales .      in the introduction",
    "we mentioned the use of iterative methods to attack the difficult problem of power spectrum estimation .",
    "a good starting guess can drastically speed up the convergence of such methods . in the case of large sky coverage , where the biases which occur in the @xmath57 are small , we suggest the following recipe as a `` poor man s power spectrum estimator '' for de  biasing the power spectrum in only @xmath123 computational time :    1 .",
    "compute the @xmath57 from the data , 2 .   fit a smooth curve @xmath124 through them , 3 .   compute @xmath125 and set all negative @xmath126 to zero , 4 .   use the @xmath126 instead of @xmath127 in eq .",
    "( [ meanetc ] ) to compute @xmath128 .",
    "then @xmath129 is an estimator of the underlying theory @xmath0 .",
    "there is a tiny residual bias which is second order in the discrepancy shown in figure [ moments ] .",
    "this is utterly negligible for upcoming satellite missions .",
    "we have computed the sampling properties of a set of quantities which we call pseudo@xmath0 .",
    "we have shown the usefulness of these quantities for the easy compression of large cosmic microwave background data sets as well as for the forecasting of the discriminatory power of planned experiments .",
    "for example , in situation where percentage accuracy is required , the pseudo@xmath0 sample variances shown in figure [ moments ] could immediately replace the usual approximation which simply rescales the cosmic variances for the full sky by the sky fraction .    on the other hand",
    "this exact framework can be used to justify or derive more approximate methods .",
    "we have given an example for the construction of an approximate but unbiased likelihood for cosmological parameters on the basis of a gaussian approximation to the marginalised pseudo@xmath0 probability distributions .",
    "using this approximation we can evaluate the likelihood for hundreds of theories per hour on a single cpu and find unbiased estimates .",
    "if only a rough treatment of the @xmath0 statistics is sufficient , for example in the case of large sky coverage , the results derived here can be used as a justification for other simplifying assumptions which are already in use in the literature .    apart from the obvious applications to experiments with small and medium sky coverage such as balloons or ground  based missions , many further uses of this framework are conceivable .",
    "for example , one could use the statistical framework to design optimal scanning strategies , encoded in @xmath96 , and assess more realistically if secondary anisotropies will be detectable with future cmb missions . finally , all ingredients are there to refine the approximation to the joint likelihood we used in this paper by taking into account the covariances eq .",
    "( [ covmat ] ) , for example by using a multivariate edgeworth expansion around the peak of the likelihood .",
    "we note that numerical techniques have recently been developed @xcite which allow the computational solution of the power spectrum estimation for high @xmath25 applications under similar assumptions to the ones which lead to the analytical results derived in this paper .",
    "their methods are efficient for the case of almost full sky observations .",
    "a purely numerical approach still requires significant computational resources , especially if there is signal in modes with @xmath130 .",
    "the results presented in this paper should be seen as complementary to such calculations .",
    "an analytical framework admits a more fundamental approach to understanding and is a useful yardstick against which numerical work can be tested or from which approximate methods can be derived as we have demonstrated in the applications presented in section [ quad : applications ] .",
    "our methods do not allow for significantly correlated noise .",
    "due to the current state of detector technology , all cmb missions suffer from correlated noise , with the possible exception of the map satellite @xcite .",
    "apart from brute force numerical calculation with @xmath131 operations , which is no longer feasible even with current experiments , there are currently no techniques for computing sampling statistics in the presence of correlated noise .",
    "this clearly needs to be addressed as an extremely urgent and important issue .    to summarize ,",
    "we have presented a theoretical framework for the study of power spectrum statistics which is applicable regardless of the size of the sky area covered .",
    "we go beyond current approximations and present a semi ",
    "analytic formalism for the computation of sampling distributions of the @xmath0 for any gaussian cosmological model and a large and important class of surveying strategies .",
    "we show that these results can be usefully applied to the estimation of cosmological parameters from simulated data .",
    "a range of further applications is suggested which demonstrate the power of our formalism .",
    "we wish to thank a.  j.  banday for stimulating discussions .",
    "this research was supported by dansk grundforskningsfonden through its funding for tac .",
    "we assume in this paper that we have access to a partial sky map of cmb anisotropies free from non  cosmological signal . even in the event that foreground contributions can be filtered out using the frequency information provided by multi  channel experiments , this assumption merits further discussion  particularly for large amplitude low order modes such as the monopole and the dipole which are thought to consist exclusively of non - cosmological signal .",
    "an ideal full sky map of the cosmic microwave background anisotropies has zero mean , by definition . also , in friedmann ",
    "walker models , there is no cosmological dipole .",
    "but we expect realistic maps resulting from observations of the microwave sky to contain both monopole and dipole components ; galactic emission is positive definite and will therefore give a monopole contribution .",
    "the motion of our solar system with respect to the frame in which the cmb is at rest produces a dipole .",
    "the question arises how to deal with the presence of such non  cosmological low order modes . and",
    "@xmath132 containing this effect are quoted in eq .",
    "( [ probdist ] ) . ]",
    "if the experiment measures total power , we may hope to remove a sizeable part of the monopole using the frequency information of a multi  channel experiment . in the case of a differential experiment such as map which is blind to the monopole component",
    ", the problem depends on the particulars of the map  making algorithm employed .",
    "frequency information alone can not distinguish between a non - cosmological and a spurious dipole since both are due to the microwave background .",
    "studies of the peculiar velocity field may provide some information .",
    "we see the three following different approaches which can be used to deal with the problem of mode to mode coupling when non  cosmological components are removed from the sky .",
    "one is orthogonalisation @xcite .",
    "this solves the problem , but is not feasible computationally when dealing with millions of degrees of freedom .",
    "the other is projecting out the undesired modes either by fitting and subtracting or more formally by operating with projection operators .",
    "those approaches lead to a correlation structure for the remaining modes which is not analytically tractable in the manner presented in this paper .",
    "the third is allowing for the presence of a monopole and a dipole in a bayesian fashion , by including a rough estimate of their size in the theory @xmath0 .",
    "in particular , a rough _ a priori _ measure of the monopole and dipole present in the data can be input into @xmath133 and @xmath134 .",
    "our statistical framework allows this and yields the correct predicted sampling statistics for all @xmath0 taking into account all the @xmath25@xmath135 couplings due to the cut . in effect ,",
    "@xmath133 and @xmath134 are treated as nuisance parameters which are marginalised over in our formalism .",
    "this will change the sampling statistics of low order modes predicted by our theory in a self - consistent way .",
    "cosmological parameters can then be estimated in an unbiased fashion without monopole or dipole removal .",
    "whether this is feasible in practice would be an interesting avenue for further study .",
    "we are not aware of any existing fast method which offers a similarly consistent treatment .    in practice",
    "we observe that for large sky coverage the entries of the coupling matrices diminish rapidly with increasing @xmath25 . to a good approximation , modes with @xmath117 are therefore unaffected by the presence or absence of low order modes , @xmath136 .",
    "one of the main applications of our formalism has been to the estimation of parameters which depend mostly on the shape of the @xmath0 spectrum around and beyond the first acoustic peak .",
    "these analyses are unaffected by the details of how low order modes of non  cosmological origin are dealt with .",
    "for a general azimuthally symmetric window @xmath66",
    "we can write the @xmath57 as @xmath137 we define normalised associated legendre polynomials @xmath138 in appendix [ quad : couple ] and use the notation @xmath139 . then @xmath140 and we notice that the kronecker@xmath141 from the azimuthal integration select only one term out of the sums over @xmath142 and @xmath143 , namely @xmath144 where the @xmath145 are real matrices . because the @xmath43 matrices are real , the terms in the brackets are complex conjugates of each other and we obtain eq .",
    "( [ pcldef ] ) as desired .",
    "subsection [ sphericalstuff ] reviews some useful properties of spherical harmonics . in subsection [ scalprod ]",
    "we derive an efficient algorithm for computing the coupling matrix eq .",
    "( [ eq : wldef ] ) due to an azimuthally symmetric mask , eq .",
    "( [ eq : filter ] ) .",
    "more general windows can be piecewise defined in terms of masks of varying height .",
    "the corresponding coupling matrices are then suitably weighted sums over the coupling matrices due to the individual masks .",
    "the spherical harmonics are @xmath146 where the @xmath147 in the following we will only consider positive @xmath33 .",
    "the associated legendre polynomials @xmath148 are defined as @xmath149 where @xmath150 is the legendre function of the first kind defined as @xmath151 they are solution of the differential equation @xmath152 definition eq .",
    "( [ eq : def_leg ] ) leads to a large number of relations between polynomials of different order @xmath25 and @xmath33 and their derivatives . among them",
    "the following two will be useful ( see , _ e.g.  _ @xcite  8.700 ) @xmath153 and @xmath154    it is possible to obtain the @xmath148 or alternatively the @xmath98 through relations that raise from the fact that they are orthogonal polynomials .",
    "the following recurrence is stable and very convenient for numerical uses :    starting with @xmath155 @xmath156      a(l , m ) \\quad{\\rm with}\\quad a(l , m)= \\sqrt { \\frac{4l^2 - 1}{l^2 - m^2 } } \\nonumber\\end{aligned}\\ ] ]      the spherical harmonics have the property that they are an orthonormal basis spanning the hilbert space of square integrable functions on the sphere @xmath157 , _ i.e.  _ their scalar product is the identity matrix : @xmath158    let us now define the _ cut sphere _",
    "scalar product of spherical harmonics under a mask or window @xmath43 @xmath159\\equiv\\int_0^{2\\pi } d\\phi \\int_{-1}^1 d\\cos\\theta\\ , w(\\theta,\\phi )      y_{l'm'}(\\theta,\\phi)y_{l m}(\\theta,\\phi )   \\label{eq : scal_prod_cut}\\ ] ] in the following we will consider only a sharp strip filter whose boundaries are parallel to the equator ( but not necessarily symmetric about the equator ) .",
    "@xmath160 this is simply related to physically relevant windows .",
    "for example a straight cut removing foregrounds concentrated around the galactic disk is modeled by @xmath161 with @xmath162 setting the width of the cut . because @xmath163 = { \\bf 1 } - a_{l'l}^{mm'}[w]$ ] , where @xmath164 , everything that follows can be translated to this window with the replacements @xmath165 = 1.\\ ] ]    because the window eq .",
    "( [ eq : filter ] ) is independent of @xmath31 it preserves the azimuthal symmetry and only spherical harmonics with the same @xmath33 are coupled .",
    "the non  trivial terms of the coupling matrix @xmath166 are then @xmath167 where @xmath168    this expression is symmetric under interchange of @xmath135 and @xmath25 and under @xmath169 . if @xmath170 this implies that , asymptotically for large @xmath35 there are @xmath171 independent components of @xmath172 . if the window @xmath43 is symmetric around the equator and therefore preserves reflection symmetry , only multipoles with the same parity of @xmath25 couple to one another , and the number of non ",
    "trivial elements reduces to @xmath173 .    the problem of evaluating all independent components of eq .",
    "( [ eq : def_coup ] ) is to find a way of computing the integrals eq .",
    "( [ eq : def_coup ] ) without having to take recourse to time  consuming numerical quadratures .    if one substitutes eq .",
    "( [ eq : rel_1 ] ) for @xmath148 and @xmath174 in eq .",
    "( [ eq : def_coup ] ) , integrates by parts to exhibit the second derivative of @xmath175 , and makes use of the differential equation eq .",
    "( [ eq : diff_eq ] ) one obtains @xmath176_{a}^{b } \\nonumber \\\\      & + & ( m+l-1)\\left [ { p_{l'(m-1)}p_{(l-1)(m-1)}}\\right]_{a}^{b } \\label{eq : rec_int}\\end{aligned}\\ ] ] where we used eq .",
    "( [ eq : rel_2 ] ) to simplify the last two terms .",
    "this can be simplified further in the case @xmath177 , by noting that the left hand side of eq .",
    "( [ eq : rec_int ] ) is by definition symmetric in @xmath178 whereas the right hand side is not explicitly symmetric .",
    "so , by subtracting eq .",
    "( [ eq : rec_int ] ) from itself after swapping @xmath25 and @xmath135 one obtains @xmath179_{a}^{b }      + ( l + m)\\left[{p_{l '   m}p_{(l-1)m}}\\right]_{a}^{b }      - ( l'+m)\\left[{p_{(l'-1)m}p_{l   m}}\\right]_{a}^{b}\\right ) \\nonumber \\\\      & /&\\left({l'}^2+l'-l^2-l \\right ) \\quad{\\rm for}\\,\\ ,      l'\\not = l . \\label{eq : int_off_diag}\\end{aligned}\\ ] ] the diagonal terms ( @xmath180 ) can be obtained thanks to the recurrence relation @xmath181 one obtains a recurrence on the diagonal terms involving also the off ",
    "diagonal terms computed by eq .",
    "( [ eq : int_off_diag ] ) .",
    "@xmath182    to conclude , the elements of the coupling matrix @xmath166 are given in terms of recurrence relations as follows .",
    "for @xmath183 we have @xmath184 while for @xmath185 @xmath186_{a}^{b }            + \\sqrt { \\frac{2l + 1}{2l -1 } ( l ^2-m^2 ) }           \\left[{\\lambda_{l'm}\\lambda_{(l-1)m}}\\right]_{a}^{b } - \\\\ & \\quad\\quad\\quad\\quad\\quad\\sqrt { \\frac{2l'+1}{2l'-1 } ( { l'}^2-m^2 ) }           \\left[{\\lambda_{(l'-1)m}\\lambda_{lm}}\\right]_{a}^{b }          \\biggr )   \\times \\frac{2\\pi}{(l'-l)(l'+l+1 ) } , \\end{split}\\ ] ] and all other cases are given by @xmath187_{a}^{b } \\end{split}\\ ] ] with @xmath188 \\equiv 0 $ ] . as only a few operations are needed to evaluate each of these terms , calculating the whole coupling matrix costs @xmath189 operations and only requires about 10 minutes for @xmath190 on a fast work  station .",
    "how do we approach computing the probability density function ( pdf ) of a ( set of ) continuous random variate(s ) which can itself be written as a function of one or more random variates whose pdfs are known ?",
    "the usual expression for changing the measure is @xmath191 where @xmath192 is the jacobian of the transformation .",
    "however this expression is inconvenient if the transform is not monotonic or the number of transformed variates is not the same as the number of original variates .    in order to attack this more general situation we replace eq .",
    "( [ eq : jacobian ] ) by a more powerful integral expression .",
    "the idea here is to define an `` atomic '' pdf which allows for only one event . for a continuous variate",
    "this is the delta function .",
    "the sum of these `` atoms '' over all possible outcomes , weighted with the probability that the underlying variates produce this outcome gives the resulting pdf . in symbols , if the @xmath193 underlying variates @xmath194 have the joint pdf @xmath195 , then the pdf of @xmath196 is @xmath197 where @xmath198 denotes @xmath199 .",
    "in particular we are often interested in the distribution of a linear combination of @xmath193 independent quantities whose distributions are known .",
    "computing these distributions is now straightforward  we can apply eq .",
    "( [ fpdf ] ) with the simplification that @xmath200 is linear and p(x ) factorises owing to the independence of the variates .",
    "the trick is to perform the resulting convolution in fourier space by application of the fourier convolution theorem .",
    "this is far easier to do than computing @xmath193 convolutions , at least if @xmath201 .",
    "the fourier transform of a pdf of a variate is called its _ characteristic function _  hence the name of the method .",
    "all major pdfs have tabulated fourier transforms .",
    "this makes this method very simple to apply , up to the final step of inverse transforming to obtain the required pdf .",
    "this may be tabulated too .",
    "if not , extending the integrand to the complex plane and using contour integration perhaps after expanding into partial fractions may lead to success . in any case , at least only one integral needs to be evaluated compared to @xmath193 for the direct convolution .",
    "even if the inverse transform does not succeed , all is not lost . a key fact about characteristic functions",
    "allows us to gain as much information as we like about the statistical properties of @xmath202 . by formally computing the maclaurin series of the fourier",
    "transform which defines the characteristic function @xmath203 of a variate @xmath202 , we find that it is the generating function for its statistical moments , @xmath204 therefore , the moments can be obtained by straightforward differentiation of @xmath203 .",
    "equivalently , and sometimes more conveniently , the natural logarithm of the characteristic function generates the cumulants of the distribution .",
    "moments and cumulants are algebraically simply related .",
    "once these moments or cumulants are known there is a host of methods for using them to approximate @xmath205 @xcite . in particular ,",
    "when @xmath193 is large , the _ large number theorem _ states that @xmath205 approaches a gaussian with mean @xmath206 and variance @xmath207 ( under weak conditions on the @xmath208 ) ."
  ],
  "abstract_text": [
    "<S> as the era of high precision cosmology approaches , the empirically determined power spectrum of the microwave background anisotropy @xmath0 will provide a crucial test for cosmological theories . </S>",
    "<S> we present an exact semi  analytic framework for the study of the ampling statistics of the @xmath0 resulting from observations with partial sky coverage and anisotropic noise distributions . </S>",
    "<S> this includes space  borne , air  borne and ground  based experiments . </S>",
    "<S> we apply this theory to demonstrate its power for constructing fast but unbiased approximate methods for the joint estimation of cosmological parameters . </S>",
    "<S> further applications , such as a test for possible non  gaussianity of the underlying theory and a `` poor man s power spectrum estimator '' are suggested . </S>",
    "<S> an appendix derives recursion relations for the efficient computation of the couplings between spherical harmonics on the cut sky . </S>"
  ]
}