{
  "article_text": [
    "with the advent of the space missions corot and kepler ( see * ? ? ?",
    "* ; * ? ? ?",
    "* ) and as the result of numerous successful ground - based surveys , nearly two - hundred transiting extrasolar planets are known up to date .",
    "furthermore , the number of candidates awaiting for confirming the planetary properties exceeds the magnitude of thousand @xcite .",
    "these systems gives us a unique perspective for various studies because most of the planetary and orbital parameters can be obtained without any ambiguity .",
    "transiting planetary companions are also known in multiple stellar systems @xcite .",
    "moreover , both systems of transiting planets and eclipsing binaries provide substantial information about the stars from which the absolute physical properties can be easily obtained , completely independently from other methods and therefore these studies are essential to confirm stellar evolution models .    in the case of multiple transiting planetary systems ( see e.g. * ? ? ? * ) , triple or hierarchical stellar systems or circumbinary planetary systems @xcite , planetary systems around one of a binary components or systems with planetary companions ( exomoons , see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , there is a chance to observe mutual eclipsing or transiting events when ( at least ) three of the bodies are aligned along the line of sight .",
    "moreover , if planet and/or stellar formation prefers co - planar orbits , the chance is even higher .",
    "conversely , observing mutual transit events yields additional information about the orbital characteristics of the whole system .",
    "recently , @xcite and @xcite analyzed these effects and their qualitative influence on extrasolar moons and multiple planetary systems . in this paper",
    "we discuss how the photometric measurements are affected due to such mutual transiting or eclipsing events by giving an algorithm that models light curves of such phenomena .",
    "our method described here is capable to compute light curve models for arbitrary number of eclipsing or transiting bodies and for all of the well - known limb darkening models without any restrictions for the projected diameters of the active components .",
    "the structure of this paper is as follows .",
    "section  [ sec : lightcurvemodel ] describes the algorithm and the formulae needed to evaluate the fluxes or light curve points for events with multiple transiting , eclipsing or occulting companions . in section",
    "[ sec : mutualtransits ] we briefly discuss the qualitative properties of systems where mutual transits may occur and demonstrate how information gathered from such mutual events can be exploited in order to constrain orbital alignments in such a transiting planetary system . and",
    "finally , section  [ sec : summary ] summarizes the key points and results of this paper .",
    "in this section we briefly describe the methods used to compute the light curve models for multiple transiting objects .",
    "recently , @xcite published an algorithm that is capable to estimate the observed flux when two bodies transit their host star simultaneously .",
    "however , that method works only when one of these bodies is very small ( i.e. assuming a homogeneous flux density beyond this very small disk ) .",
    "here we demonstrate an alternative algorithm that is significantly more concise and can be treated as an extension of the approach by @xcite in several ways .",
    "first , the presented method is capable to incorporate more than two transiting bodies .",
    "space - borne missions like kepler are expected to detect both extrasolar moons @xcite by different methods ( e.g. detecting timing variations or via photometry ) and systems with three or more transiting planetary companions that are also known ( kepler-11 , see * ? ? ?",
    "second , the model can be extended for various limb darkening models , that can be quantified by a series expansion on the apparent stellar surface ( and might lack circular symmetry ) .",
    "such models can also be exploited to quantify cases with asymmetric light curves like koi-13(b ) @xcite .",
    "third , in terms of computation time , the method presented here can also be an alternative for the well - known models available for the single - planet cases @xcite .",
    "also , this method does not require several dozens of distinct geometric cases ( see * ? ? ?",
    "* ; * ? ? ?",
    "finally , more sophisticated cases like non - uniform thermal radiations can also be considered , even in mutually transiting systems .",
    "this might be relevant in the analysis of near - infrared light curves of close - in eclipsing companions .",
    "the computation of the presented light model is based on three subsequent steps .",
    "first , a net of disjoint arcs is obtained from the mutual intersections of the apparent stellar and/or planetary disc edges .",
    "second , we generate a vector field whose exterior derivative ( i.e. the planar component of the curl operator ) is the surface brightness",
    ". the surface brightness must be in accordance with our assumptions for the limb darkening models .",
    "third , we apply green s or the kelvin - stokes theorem ( known from differential geometry or vector calculus ) to integrate the vector field on an appropriately oriented subset the arcs . in the following ,",
    "we discuss these three steps as well as their applications for various surface brightness functions .      in principle , the projected stellar",
    ", planetary or lunar discs are characterized by the center coordinates @xmath0 and the radius @xmath1 .",
    "an arc on one of these circles is quantified by the additional parameters @xmath2 and @xmath3 , where @xmath2 is the position angle between the reference axis ( @xmath4 ) and the beginning of the arc while @xmath3 is the length of the arc in radians .",
    "all of the arcs in this model are oriented in counter - clockwise ( i.e. prograde or positive ) direction . in the following ,",
    "the circles and arcs are indexed by @xmath5 and @xmath6 , respectively . obviously , for the @xmath5th circle , @xmath7 and @xmath8 completely disjoint circles or circles of which edge does not intersect other ones have only one arc that is used to represent the circle itself .",
    "namely , @xmath9 and @xmath10 while the value of @xmath11 can be arbitrary .",
    "the net of arcs is built iteratively .",
    "if the new circle is disjoint , only one arc is placed with @xmath12 , otherwise the two position angles for the two intersection points are computed using known trigonometric relations and the appropriate arcs are split into two or three smaller ones . after obtaining this set of arcs , the topology is also generated .",
    "namely , by checking for each arc what are the circles that contains this arc inside .",
    "let us denote this subset of circles regarding to the @xmath6th arc of the @xmath5th circle by @xmath13 .",
    "note that this set might be empty or might even contain all of the circle indices with the exception of @xmath5 .",
    "see e.g. fig .",
    "[ fig : circles ] for a particular example of @xmath14 intersecting circles",
    ".      the surface brightness of the host star can be modelled by various limb darkening laws .",
    "recalling green s theorem over @xmath15 , we can write @xmath16 here @xmath17 and @xmath18 is the boundary of @xmath19",
    ". these are two and one - dimensional manifolds on @xmath15 on which the standard measures are @xmath20 and @xmath21 , respectively .",
    "this equation can also be viewed as a somewhat special case to the stokes theorem known for the curl operator in a three - dimensional space .",
    "the term @xmath22 denotes the exterior derivative of @xmath23 , that can be written in terms of vector components as @xmath24 for our problem discussed in this paper we can apply the above equation  ( [ eq : stokes2d ] ) as follows .",
    "first , we have to find a function @xmath25 of which exterior derivative is the given stellar surface brightness density .",
    "we have to note that due to the young theorem , this function is ambiguous , since we can add an arbitrary scalar gradient to @xmath23 , of which addition does not change its exterior derivative .",
    "therefore , it is recommended to find such an @xmath23 which have `` nice properties '' making the computation of the integral on the right - hand side of equation  ( [ eq : stokes2d ] ) convenient . for instance , a homogeneous surface can be modelled with the function @xmath26 the exterior derivative of this function is unity and there is no preferred direction or position angle in the vector field described by @xmath27 .",
    "let us consider a set arcs of which union is the boundary : @xmath28 .",
    "the arc @xmath29 corresponding to the circle centered at @xmath30 with a radius of @xmath31 and parameterized via the position angle @xmath32 implies the measure @xmath33 thus , the total flux @xmath34 coming from the area @xmath19 is then computed as @xmath35r_a\\mathrm{d}\\varphi,\\label{eq : intsum}\\ ] ] where for more compact notations , we define @xmath36 and @xmath37 .",
    "note that the integration limits @xmath38 and @xmath39 are not necessarily @xmath40 and @xmath41 , because the direction of the @xmath42 integral must be positive in all cases .",
    "if we use @xmath43 and @xmath44 , we have to multiply the integrand by @xmath45 , depending whether the right - hand directed arc @xmath29 points inside or outside the area @xmath19 ( see e.g. fig .  [ fig : circles ] or fig .",
    "[ fig : movie ] for examples and further explanation ) .",
    "now , we compute the integrals behind the sum of equation  ( [ eq : intsum ] ) for various surface brightness functions .",
    "let us consider a star whose projected disk center is located at @xmath46 and has a radius of unity .",
    "the domain of the functions of out interest is this unit circle , i.e. @xmath47 .",
    "as we have seen earlier ( see e.g. equation  [ eq : unitcurl ] ) , the vector field @xmath48 has a curl of unity . for a given arc @xmath49 , the integrals behind the sum of equation  ( [ eq : intsum ] ) can be written as @xmath50 note that the value of @xmath51 _ does _ depend on the actual choice for @xmath23 , i.e. it would be different if we add a gradient to the vector field @xmath23",
    "however , @xmath52 in equation  ( [ eq : intsum ] ) would not be altered after such an addition of a gradient field . by summing the results yielded by equation  ( [ eq : inthomogeneous ] ) for the arcs @xmath53",
    ", we can easily reproduce the results of in sections  2 , 3 and fig .  5 of @xcite .",
    "various limb darkening models contain terms which can be quantified as polynomial functions of the @xmath54 centroid coordinates ( for instance , the quadratic limb darkening law ) . in additional",
    ", any analytical limb darkening profiles can be well approximated by polynomial functions , therefore it is worth to compute terms in equation  ( [ eq : intsum ] ) for such cases .    without any restrictions , let us consider the term @xmath55 .",
    "due to the linearity of the integral and summation , if the surface intensity can be described by polynomials , computing the integral in equation  ( [ eq : intsum ] ) for the above terms are sufficient .",
    "first , let us define @xmath56 and introduce @xmath57 and @xmath58 , just for simplicity .",
    "thus , in the expansion of equation  ( [ eq : intsum ] ) , we should compute expressions like @xmath59 or @xmath60 . here",
    "we give a set of recurrence relations with which these indefinite integrals can be evaluated .",
    "it is easy to show that @xmath61 for the terms @xmath59 and @xmath60 we can write @xmath62 in order to bootstrap these set of recurrence relations , we only have to use the following : @xmath63 however , for some cases we might compute these integrals a bit more easier .",
    "for instance , the surface density @xmath64 can be integrated as the exterior derivative of @xmath65 .",
    "hence , the primitive integral in equation  ( [ eq : intsum ] ) for this @xmath23 will be @xmath66 & = & \\frac{r}{48}\\left\\{24(x_0 ^ 2+y_0 ^ 2)r+12r^3)\\varphi\\right .",
    "-   \\\\      &    & -4y_0(6x_0 ^ 2 + 2y_0 ^ 2 + 9r^2)\\cos\\varphi + \\nonumber\\\\      &    & + 4x_0(2x_0 ^ 2 + 6y_0 ^ 2 + 9r^2)\\sin\\varphi - \\nonumber\\\\      &    & -4r^2[y_0\\cos(3\\varphi)+x_0\\sin(3\\varphi ) ] - \\nonumber\\\\      &    & \\left.-24x_0y_0r\\cos(2\\varphi)-r^3\\sin(4\\varphi)\\right\\}. \\nonumber\\end{aligned}\\ ] ]      the well known formula of linear limb darkening law gives us a surface flux density that can be written in the form of @xmath67,\\ ] ] where @xmath68 and @xmath69 denotes the linear limb darkening coefficient . performing integrals on this function will yield a linear combination of integrating a constant ( see section  [ subsubsec : homogeneoussurface ] ) and integrating the function @xmath70 .",
    "thus , here we derive a function of which exterior derivative is @xmath70 as well as we compute the indefinite integral that is going to appear in equation  ( [ eq : intsum ] ) .",
    "first of all , we have to note that this function is defined only in the domain bounded by the circle @xmath71 .",
    "let us search the function @xmath23 of which exterior derivative is @xmath72 in the form of @xmath73 $ ] . for simplicity , we introduce @xmath74 .",
    "it is easy to show that the expansion of equation  ( [ eq : exterior ] ) for this function yields an ordinary differential equation ( ode ) for @xmath75 that is @xmath76 where @xmath77 .",
    "one of the solutions of this ode is @xmath78 this solution behaves analytically at @xmath79 , i.e. at the center of the stellar disk .",
    "therefore , the function @xmath23 can be written as @xmath80 by substituting this @xmath81 into equation  ( [ eq : intsum ] ) , one finds that the primitive integral @xmath82=\\frac13\\int\\frac{1-(1-r^2 - 2r\\rho\\cos\\varphi')^{3/2}}{r^2 + 2r\\rho\\cos\\varphi'}(r+\\rho\\cos\\varphi')r\\,\\mathrm{d}\\varphi'\\label{eq : llint}\\ ] ] should be computed , if we parameterize the arc ( on which the @xmath23 is integrated ) similarly as earlier .",
    "the constants are the following : @xmath83 , @xmath84 , and @xmath85 is defined to be @xmath86 equals to @xmath87 .",
    "the primitive integral in equation  ( [ eq : llint ] ) can be computed analytically and this computation yields a function which contains elementary functions as well as elliptic integrals . as a first step ,",
    "let us introduce the constants @xmath88 here @xmath89 , @xmath90 and @xmath91 denotes the incomplete elliptic integrals of the first , second and third kind , respectively . then , @xmath92 $ ] in equation  ( [ eq : llint ] ) is computed as @xmath93 & = &       -\\frac{1}{3}\\arctan\\left[\\sqrt{\\frac{d_2}{s_2}}\\tan\\left(\\frac{\\varphi'}{2}\\right)\\right]\\frac{\\rho^2-r^2}{\\sqrt{d_2s_2}}+\\nonumber \\\\ & + & \\frac{\\varphi'}{6}+\\frac{2}{9}r\\rho\\sqrt{1-q_2}\\sin\\varphi'+ \\nonumber \\\\ & + & \\frac{1}{6}(1 - 4r^2 + 2r^4)q\\hat f+ \\nonumber \\\\",
    "& + & \\frac{1}{9}r\\rho(7r^2 + 5r\\rho+\\rho^2 - 4)q\\hat f+ \\nonumber \\\\ & + & \\frac{1}{9}r\\rho(8 - 14r^2 - 2\\rho^2)q\\hat e+ \\nonumber \\\\ & + & \\frac{1}{6}\\frac{r+\\rho}{r-\\rho}q\\hat p.\\label{eq : linprimitive}\\end{aligned}\\ ] ] one may note some similarities between these terms and the equations in @xcite or @xcite .",
    "although the formulae above include incomplete elliptic integrals , the actual evaluation of these does not require longer computation time than the complete ones .",
    "both types of elliptic integrals are computed via the carlson symmetric forms @xcite , for which computation very fast and robust algorithms are available in the literature @xcite .",
    "it should also be noted that the evaluation of equation  ( [ eq : linprimitive ] ) might be done with caution in some cases where the values of the variables or constants defined in equations  ( [ eq : lpdef : first ] )  -  ( [ eq : lpdef : last ] ) introduce singularities in some of the terms .",
    "these values correspond to cases where the arc endpoints are at the edge of the bounding circle at @xmath71 and/or when the arc intersect the origin ( i.e. if @xmath94 ) .",
    "however , these singularities yield more simple formulae in general . for instance , the case of @xmath95 ( i.e. when the bounding circle and the arc is concentric ) , equation  ( [ eq : linprimitive ] ) becomes simply @xmath82=\\frac13\\left[1-(1-r^2)^{3/2}\\right]\\varphi'.\\ ] ] especially , when the arc is a part of the bounding circle itself ( which is a practically frequent case : see e.g. the thick solid lines in the frames of fig .",
    "[ fig : movie ] ) , i.e. when @xmath96 and @xmath95 , then @xmath92 $ ] is merely @xmath97 . all in all",
    ", these cases should be treated carefully during a practical implementation .",
    "the quadratic limb darkening stellar profile is characterized by the surface flux density @xmath98 . since @xmath68 , by expanding this equation , we obtain a constant term , with a value of @xmath99 , a polynomial term @xmath64 with a coefficient @xmath100 and a term that is proportional to @xmath101 and has a coefficient @xmath102 .",
    "hence , the formulae in the previous three subsections ( [ subsubsec : homogeneoussurface ] , [ subsubsec : polynomialintensities ] and [ subsubsec : linearlimbdarkening ] ) can be applied accordingly to evaluate the final apparent fluxes in the case of a quadratic limb darkening law .",
    "mutual transits occur when at least two bodies ( that can be , for instance , two planets or a planet and its moon ) transits the host star simultaneously _ and _ their projections also overlap . due to this overlap ,",
    "the observed flux coming from the host star is _ larger _ than if we would consider naively the flux decreases from each body independently . in fig .",
    "[ fig : movie ] we display a series of images that clearly show this effect . in the previous section we deduced the algorithms and mathematical formulae that are needed for the computation of",
    "the total observed flux for arbitrary geometry and for various limb darkening models .",
    "as a demonstration , in fig .",
    "[ fig : mutuallightcurve ] we display two simulated light curves with nearly the same orbital geometry .",
    "the planet - to - size ratio for the two companions are @xmath103 and @xmath104 while the orbital parameters are the following : @xmath105 , @xmath106 , @xmath107 , @xmath108 , @xmath109 , @xmath110 , @xmath111 and both of the planets have a circular orbit . here @xmath112 denotes the orbital angular frequency : it is @xmath113 , where @xmath114 is the orbital period .",
    "@xmath115 is the impact parameter of the transit , @xmath116 is the normalized semimajor axis ( in the units of stellar radii ) and @xmath117 is difference in the orbital ascending nodes ( note that the reference plane here is the plane of the sky ) .",
    "the mid - transit time of the inner planet is @xmath118 while the outer planet has @xmath119 on the left panel , and @xmath120 on the right panel .",
    "this difference between the mid - transit times yields a mutual transit in the latter case ( see the flux excess in fig .  [",
    "fig : mutuallightcurve ] at @xmath121 ) while there is no overlap between the apparent planetary disks in the former case .",
    "it can easily be seen that the time evolution of the flux excess yielded by the mutual transit has similar qualitative properties as the normal transits have .",
    "namely , it has a mid - time , a peak and a duration .",
    "the larger the flux excess peak , the larger the overlapping area is . at a first glance , the only quantity for which an observation of a mutual transit yields additional constraints is the difference in the @xmath122 , the difference between the orbital ascending nodes .",
    "qualitatively , the longer the duration of this flux excess , the smaller the absolute value of @xmath122 is .",
    "however , the depth and the exact time of the mutual event defines the impact parameters more precisely .",
    "this is rather relevant when one or both of the impact parameters are relatively small : the uncertainty of @xmath123 does not strongly depend on the actual value of @xmath124 ( see e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , thus the uncertainty in @xmath124 will be rather large for small values of @xmath124 due to the relation @xmath125 .",
    "indeed , for instance , the analysis of the light curves shown in fig .",
    "[ fig : mutuallightcurve ] yields the following . if no mutual transit occurs ( left panel ) , the best - fit values for @xmath115 s will be @xmath126 and @xmath127 while if we can observe the mutual transit , we obtain @xmath128 and @xmath129 while for the node difference we got @xmath130 . for this demonstration of light curve analysis",
    ", we employed an improved markov chain monte - carlo algorithm as implemented in the ` lfit ` utility @xcite .",
    "of course , if the difference in the nodes , @xmath117 is known , we can compute the mutual inclination @xmath131 of the orbits as well using the well - known relation @xmath132 it should also be mentioned that the analysis of mutual transits resolve the ambiguity between the values of @xmath133 . and of course , the precise analysis of mutual transits should involve the gravitational interactions between the companions ( see e.g. * ? ? ?",
    "* ) , especially when data are available on a timescale on which the perturbations are not negligible ( contrary to the demonstration presented here ) .",
    "in this paper we investigated the possibilities for computing apparent stellar fluxes in multiple or hierarchical stellar and/or planetary systems during simultaneous transits or occultations .",
    "the presented algorithm is capable to derive these fluxes for arbitrary number of bodies that are actively parts of the transiting or eclipsing event .",
    "this method can then be applied for various analyses of complex astrophysical systems , including multiple transiting planetary systems , hierarchical stellar systems with planetary companions and extrasolar moons as well .",
    "currently , the algorithm is implemented in ansi c , in the form of a plug - in module for the program ` lfit ` and available from the address ` http://szofi.elte.hu/ apal",
    "/ utils / astro / mttr/ ` .",
    "this module features functions named ` mttrxy ( . ) ` , where ` x ` denotes the number of transiting bodies and ` y ` can be `` ` u ` '' , `` ` l ` '' or `` ` q ` '' for the uniform flux density , linear limb darkening and quadratic limb darkening .",
    "evidently , these functions have @xmath134 parameters where @xmath135 is @xmath136 , @xmath137 or @xmath138 for `` ` u ` '' , `` ` l ` '' or `` ` q ` '' , respectively .",
    "the current version of this module does not compute the parametric derivatives of the functions analytically but emulates them using numerical approximations for the ` lfit ` utility .",
    "since both the parametric derivatives of the arcs ( with respect to the circle center coordinates and radii ) and the parametric derivatives of equation  ( [ eq : intsum ] ) can be computed analytically , the composition of these two would give us the required derivatives .",
    "as a demonstration , we applied this method to obtain mutual inclinations of orbits in multiple transiting planetary systems .",
    "the analysis presented here clearly shows that observing a mutual transits yields not only an accurate value for the ascending node difference but also results a more precise value for the impact parameters , and therefore the orbital inclinations as well .",
    "the author would like to thank the anonymous referee for the valuable suggestions and comments .",
    "the work of the author has been supported by the esa grant pecs  98073 and by the jnos bolyai research scholarship of the hungarian academy of sciences ."
  ],
  "abstract_text": [
    "<S> in this paper we describe an algorithm and deduce the related mathematical formulae that allows the computation of observed fluxes in stellar and planetary systems with arbitrary number of bodies being part of a transit or occultation event . </S>",
    "<S> the presented method does not have any limits or constraints for the geometry and can be applied for almost all of the available limb darkening models as well . as a demonstration , we apply this scheme to gather information for the orbital inclinations from multiple transiting planetary systems in cases when mutual transits occur . </S>",
    "<S> we also show here that these mutual events constrain inclinations unambiguously , yielding a complete picture for the whole system .    </S>",
    "<S> [ firstpage ]    celestial mechanics  stars : binaries : eclipsing  stars : planetary systems  methods : analytical  techniques : photometric </S>"
  ]
}