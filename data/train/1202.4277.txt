{
  "article_text": [
    "smoothed particle hydrodynamics ( sph ) is a lagrange scheme to solve the evolution of fluid using particles .",
    "it was originally introduced by @xcite and @xcite and has been widely used in the field of the computational astrophysics @xcite .",
    "it is becoming popular in hydrodynamical simulations in engineering ( e.g. , * ? ? ? * ) .",
    "recently , @xcite reported the results of comparison of sph and euler schemes ( grid methods ) .",
    "their main result is that sph suppresses the kelvin - helmholtz instability .",
    "this has been pointed out by @xcite .",
    "the reason of this problem is that in the standard sph the smoothed density is used to obtain other physical quantities .",
    "the estimated density of particles near the contact discontinuity has @xmath0 error , irrespective of the numerical resolution .",
    "this large error causes similarly large error in the pressure ( see  [ sec : ssph ] ) .",
    "@xcite noted that there were _ fundamental differences _ between sph and grid methods .",
    "there have been several proposals to improve sph so that it can deal with the contact discontinuity .",
    "@xcite discussed the artificial thermal conductivity which was originally introduced by @xcite .",
    "the motivation of the use of the artificial conductivity is that every physical quantity should be _ smooth _ in the standard sph .",
    "the artificial conductivity eliminates the discontinuity in the thermal energy . as a result ,",
    "the density near the contact discontinuity becomes smooth and the pressure also becomes smooth with this artificial conductivity .",
    "thus , the kelvin - helmholtz instability takes place . at the first sight",
    ", this artificial conductivity looks similar to the artificial viscosity which is necessary to capture shocks in sph .",
    "however , there are two fundamental differences .",
    "first , the artificial viscosity is used to generate the physical dissipation associated with the shock , while the artificial conductivity adds physically non - existent dissipation .",
    "one needs to fine - tune the conductivity coefficient to prevent unnecessary smoothing .",
    "this means that the conductivity must be non - linear .",
    "second , if there is a jump in the chemical composition , thermal conductivity is not enough . however , whether the use of artificial chemical diffusion is justified or not is an open question .",
    "@xcite suggested that the kelvin - helmholtz instability took place when the number of neighbors was sufficiently large and the momentum equation of the @xcite was used .",
    "@xcite used the relative pressure instead of the absolute values of pressures in the equation of motion .",
    "this formulation improves the treatment of the kelvin - helmholtz instability , but breaks the newton s third law . @xcite",
    "considered the use of the integral form of the first derivative , which also improved the treatment of hydrodynamical instabilities .    in this paper",
    ", we describe a new formulation of sph which does not use the smoothed mass density .",
    "instead , we use the smoothed internal energy density to obtain other quantities and their spatial derivatives .",
    "the reason why we adopt the energy density instead of the mass density is that it is the fundamental quantity of the hydrodynamics . in our formulation",
    ", the pressure is calculated without using the mass density .",
    "thus , unphysical jumps of pressure at the contact discontinuity disappear .",
    "our equation of motion is similar to that of @xcite , although the basis of deviation is completely different .",
    "results of various tests indicate that our formulation is highly advantageous .",
    "the structure of this paper is as follows . in  [ sec : ssph ] , we analyze the problem of standard sph at discontinuities .",
    "our new formulation of sph is described in  [ sec : esph ] and the comparison of the results of test calculations with the new formulation and standard formulation are shown in  [ sec : results ] .",
    "summary and discussion are presented in  [ sec : summary ] .",
    "in sph , the fluid is expressed by discrete particles and physical quantities are approximated by kernel interpolation . in the standard formulation of sph ,",
    "the local density is first calculated , and then the rests of necessary physical quantities , such as the pressure gradient and the time derivative of the internal energy , are calculated .",
    "thus , the accuracy of the solution depends on the accuracy of the density estimate . in this section ,",
    "we reexamine the derivation of the equation of motion in sph to understand its problem .",
    "a physical quantity @xmath1 at position @xmath2 can be expressed as follows : @xmath3 a smoothed value of @xmath1 at position @xmath2 , @xmath4 , is given by the convolution of @xmath1 and a kernel function @xmath5 : @xmath6 where @xmath7 is the size of the kernel function and corresponds to the spatial resolution .",
    "this smoothing is the base of sph . here",
    ", the kernel function must satisfy the following three conditions : ( 1 ) it becomes the delta function in the limit of @xmath8 , ( 2 ) it is normalized as unity , and ( 3 ) it is a function with compact support .",
    "a cubic spline function is most widely used as the kernel function : @xmath9 where @xmath10 , @xmath11 is the dimension , and the normalized factors @xmath12 in one , two , and three dimensions are @xmath13 , @xmath14 , and @xmath15 , respectively .",
    "we first derive the equations of motion and energy with the constant kernel size , and then we generalized them to the individual kernel size .",
    "the first derivative of the smoothed @xmath1 is given by @xmath16 by making use of the partial integral and the fact that the kernel function has compact support , eq .",
    "[ eq : f : derivation ] becomes @xmath17    we need to discretize eq .",
    "[ eq : smoothed_f ] to evaluate the physical quantities at positions of particles . to convert integral into summation ,",
    "a volume element @xmath18 is replaced by @xmath19 , where @xmath20 and @xmath21 are the mass and density of the particle @xmath22 .",
    "in addition , positions of particles @xmath23 and @xmath22 are expressed by @xmath24 and @xmath25 and @xmath26 is replaced by @xmath27 .",
    "thus , the value of @xmath1 at the position of particle @xmath23 is @xmath28 where @xmath29 and @xmath30 .",
    "hereafter , we call the sph formulation with this type of discretization as the _ standard sph_. at this point , we do not know @xmath21 . by substituting @xmath31 into @xmath1",
    ", we obtain @xmath32 where @xmath33 is the smoothed density at the position of particle @xmath23 .",
    "note that the right - hand side of eq .",
    "[ eq : ssph : density ] includes no unknown quantities .",
    "thus , densities should be calculated first in the standard sph .",
    "the equation of motion is @xmath34 where @xmath35 is time and @xmath36 is pressure .",
    "the sph approximation of eq .",
    "[ eq : eular ] is given by @xmath37 this form satisfies the newton s third law .",
    "we used the following relation to obtain eq .",
    "[ eq : ssph : eular ] : @xmath38 in order for eq .",
    "[ eq : ssph : eular ] to be meaningful , @xmath31 must be differentiable , since its derivative is used in eq .",
    "[ eq : ssph : eular : symmetrized ] .",
    "finally , we derive the energy equation in the standard sph .",
    "the energy equation is @xmath39 where @xmath40 is the internal energy and @xmath41 is the velocity . to obtain the sph formulation of the energy equation",
    ", we need the sph expression of @xmath42 .",
    "we use @xmath43 the sph formulation of @xmath42 is given by @xmath44 where @xmath45 .",
    "therefore , the energy equation in the standard sph is @xmath46 equations [ eq : ssph : density ] , [ eq : ssph : eular ] , and [ eq : ssph : energy ] close with the equation of state ( eos ) , @xmath47 where @xmath48 is the specific heat ratio .",
    "there is no need to solve the continuity equation in sph since it is satisfied automatically .",
    "when we use the variable and individual kernel size , above equations should be modified slightly .",
    "first , the density evaluation equation is rewritten as @xmath49 this is the so - called gather interpretation of the summation @xcite . in equations of motion and energy , the gather - and - scatter interpretation is used @xcite . thus , eqs . [ eq : ssph : eular ] and [ eq : ssph : energy ] become @xmath50 and @xmath51 where @xmath52 is replaced by @xmath53 $ ] so that the equation of motion can satisfy the newton s third law .",
    "it is also possible to use @xmath54 $ ] .",
    "we adopt the first form throughout this paper .    in the derivation of the standard sph discretization",
    ", the differentiability of @xmath31 is used for both the equation of motion and the energy equation .",
    "however , @xmath31 is discontinuous at the contact discontinuity . in the following ,",
    "we illustrate the consequence of the discontinuity of the density .    in figure",
    "[ fig : pressure ] , we show the values of density and pressure around a contact discontinuity evaluated by the standard formulation of sph .",
    "equation [ eq : ssph : density : ind_h ] is used and @xmath55 .",
    "to set up this contact discontinuity , we place particles on a regular grid in three dimensions and set @xmath56 for @xmath57 and @xmath58 for @xmath59 .",
    "we used equal - mass particles in the first two configurations . in these two setups ,",
    "positions of particles in the less dense region is determined by taking the center of mass of the eight particles in the cube of the particle separation . in the last configuration",
    ", we adopted the equal separation for both regions , which means that the mass of particles in the less dense region is 1/8 of that of particles in the dense region .",
    "the internal energy was set to @xmath60 ( @xmath57 ) and @xmath61 ( @xmath59 ) , and the specific heat ratio was @xmath62 .",
    "velocities of particles were set to zero .",
    "the kernel size is determined to keep the neighbor number , @xmath63 , to the range @xmath64 , in the first and the last tests . in the second test",
    "a constant @xmath7 fixed to twice the particle separation in the less dense region is used .",
    "the top panels show the distribution of particles .",
    "the panels in the second row show the sph density .",
    "though the initial setup has the discontinuity at @xmath65 , it is smoothed by the kernel . as a result",
    ", sph density of particles next to the discontinuity has very large errors , as shown in the 3rd row .",
    "this large error in the density causes similarly large error in the pressure ( 4th row ) .",
    "the pressure of particles at the end of the low - density region is grossly overestimated , while that at the end of the high - density region is underestimated only modestly .",
    "this non - symmetric error in the pressure is the origin of the repulsive force at the contact discontinuity , as has been pointed out in previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "this large error in the pressure also exists in both of the constant kernel size case ( the middle column ) and the equal - separation case ( the right column ) .",
    "consider the following density and pressure distribution : @xmath66 and @xmath67 obviously , we have @xmath68 and therefore , @xmath69 @xmath70 thus , if @xmath71 , the error of the pressure can be arbitrarily large . note that the existence of this error does not imply the inconsistency of sph . in this limit of @xmath8 ,",
    "the volume of the regime affected by this error approaches to zero , which means the original differential equation is restored almost everywhere . in other words , sph satisfies the weak form of the original equation .",
    "however , it means the convergence is slow and first order",
    ".    one might think that this error is caused by an inadequate initial thermal energy distribution .",
    "however , it is not the case . even if we initialize the internal energy of particles near the contact discontinuity so that pressure is smooth , the particle distribution changes and discontinuity is regenerated .",
    "we , thus , need continuous adjustment to suppress the pressure error throughout the time integration .",
    "price s artificial conductivity @xcite provides such a continuous adjustment .",
    "though the artificial conductivity works beautifully in test calculations for the kelvin - helmholtz instability , whether its use in actual astrophysical simulation is justified or not is a bit questionable .",
    "first , in the case of the discontinuity of chemical composition , not only the jump in the internal energy but also that in the chemical composition should be smoothed but that is clearly not adequate .",
    "second , the artificial heat conduction can significantly enhance the thermal relaxation of the system , which is again unwanted .",
    "in  [ sec : ssph ] , we have seen that the standard sph breaks down at the contact discontinuity because the continuity and differentiability of the density is necessary to guarantee the convergence of sph approximation .",
    "the basic reason for this problem is the use of @xmath72 as the volume element .",
    "thus , if we use something else as the volume element , we might be able to avoid this difficulty altogether .      here",
    ", we propose an alternative formulation of sph in which we discretize eq .",
    "[ eq : smoothed_f ] using the eos of fluid , not the mass density .",
    "the new volume element is @xmath73 substituting eq .",
    "[ eq : esph : volume_element ] into eq .",
    "[ eq : smoothed_f ] and using the gather summation , we obtain a new sph approximation of smoothed @xmath1 : @xmath74 where @xmath75 is the internal energy of particle @xmath23 . by substituting @xmath1 with the energy density , @xmath76",
    ", we have @xmath77 where we used @xmath78 .",
    "the gradient of @xmath79 is given by @xmath80 we adopt eqs . [ eq : esph : smoothed_f : sum ] and [ eq : esph : q ] as the basis of our new formulation .",
    "we derive the equations of motion and energy from this basis .",
    "we note that our new sph is also galilei invariant .",
    "one might think that the use of @xmath81 for the calculation of the volume element would cause some inconsistency , since @xmath81 is not a conserved quantity .",
    "the mass of a particle is constant , and thus looks safer . in the following ,",
    "we show that we can construct a consistent set of equations using @xmath81 , and that it has many advantages over the standard sph and that it retains important characteristics such as force symmetry and energy conservation .",
    "we first derive the energy equation and then equation of motion .",
    "we then discuss the formulation for the estimate of the density and the implementation of the artificial viscosity .",
    "we need an expression of @xmath42 to derive the energy equation .",
    "we start with @xmath82 which is obtained by replacing @xmath31 in eq .",
    "[ eq : ssph : massflux ] by @xmath83 . by applying eq .",
    "[ eq : esph : smoothed_f : derivation : sum ] to eq [ eq : esph : qflux ] , we obtain an analogy of eq .",
    "[ eq : ssph : divv ] : @xmath84 the energy equation is then given by @xmath85 equation [ eq : esph : energy : u ] contains @xmath86 since @xmath40 is the energy per unit mass .",
    "the equation for @xmath87 is obtained by multiplying eq .",
    "[ eq : esph : energy : u ] by @xmath88 : @xmath89 here , @xmath90 is the volume associated with particle @xmath23 which can be replaced by @xmath91 .",
    "thus , we have @xmath92 where we used @xmath93 .      from the energy equation , eq .",
    "[ eq : esph : energy : u ] , we derive the equation of motion .",
    "the change in the internal energy of particles @xmath23 and @xmath22 due to their relative motion is @xmath94 this change is the same as the change of the kinetic energy of particles with an opposite sign .",
    "thus , we have @xmath95 substituting eq .",
    "[ eq : esph : energy : change : u ] into eq .",
    "[ eq : esph : energy : change : k ] , we obtain @xmath96 since the motion of the center of mass of two particles is unchanged by the interaction of two particle , we have @xmath97 thus , we have @xmath98 as the contribution of particle @xmath22 to the equation of motion of particle @xmath23 .",
    "the equation of motion for particle @xmath23 is obtained by taking summation over neighbor particles : @xmath99    the right - hand side of eq .",
    "[ eq : esph : eular ] contains only the energy @xmath81 and energy density @xmath83 .",
    "thus , as far as @xmath83 is smooth , eq .",
    "[ eq : esph : eular ] is likely to be well - behaved .",
    "the equation of motion of the standard sph ( eq . [ eq : ssph : eular ] ) requires both @xmath36 and @xmath31 are smooth .",
    "thus , in our formulation , there is nothing special about the contact discontinuity .",
    "we can therefore expect that the treatment of the contact discontinuity is improved .",
    "we will see this in  [ sec : esph : pressure ] .",
    "note that eq .",
    "[ eq : esph : eular ] is mathematically equivalent to the equation of motion obtained by @xcite , while the deviation is completely different .",
    "@xcite started from eq .",
    "[ eq : esph : q ] and density estimate @xmath100 , but still tried to use standard sph estimate of eq .",
    "[ eq : smoothed_f : sum ] . in order to eliminate @xmath31 from equation of motion , they used the following formal relationship @xmath101 and formal identity @xmath102 thus , their deviation was a heuristic modification of the standard sph and they did not employ the volume element @xmath103 explicitly . we have shown that by choosing @xmath103 as the volume element , we can derive a consistent set of sph equations naturally .      to deal with shocks ,",
    "the standard sph needs an artificial viscosity term .",
    "our new formulation also needs an artificial viscosity term .",
    "we utilize artificial viscosity terms which are widely used in simulations with the standard sph .",
    "the viscosity term for the equation of motion is @xmath104 and the corresponding form of it for the energy equation is @xmath105 where @xmath106 is the function of the strength of the artificial viscosity .",
    "there are two types of artificial viscosity term , @xmath106 , which are commonly used .",
    "the most commonly used one @xcite is @xmath107 where @xmath108 and @xmath109 are the control parameters for the strength of the artificial viscosity , @xmath110 is the arithmetic average of the sound speeds of particles @xmath23 and @xmath22 , @xmath111 , and @xmath112 the constant @xmath113 is introduced to avoid the divergence and its fiducial value is @xmath114 .",
    "the other one is proposed by @xcite from the analogy of the riemann solver : @xmath115 where @xmath116 and @xmath117 .",
    "since we have the density estimate @xmath118 , we have @xmath119 however , this modification of @xmath120 leads to unstable behavior under strong shocks .",
    "it seems to be safe to use the smoothed densities of particles @xmath23 and @xmath22 evaluated using eq .",
    "[ eq : ssph : density ]",
    ". a consistent derivation of the artificial viscosity term in our scheme will be investigated in a forthcoming paper .",
    "we use the standard balsara switch @xcite to suppress the shear viscosity .",
    "it is given by @xmath121 and @xmath122 . here",
    "@xmath123 is a small value ( typically @xmath124 ) .",
    "the rotation of velocity in the standard sph is found in literature ( e.g. , * ? ? ?",
    "the rotation of velocity in our sph is calculated as follows : @xmath125      the pressure around the contact discontinuity calculated with our sph equation is shown in the bottom panels of figure [ fig : pressure ] . in the case of the equal - mass particle and the fixed neighbor number ( the left panel ) , we can see that the jump of the pressure at the contact discontinuity in our sph is much smaller than that in the standard sph . in the case of the constant kernel size ( the middle panel ) , the result of our sph is almost flat , while that of the standard sph has a large error .    in these two equal - mass cases ,",
    "pressure still has small jumps at the contact discontinuity .",
    "the reason is that in both cases the distribution of particles is asymmetric . in the high - density region , the particle separation is smaller , resulting in small integration error . as a result ,",
    "small error appears when the kernel contains the contribution from both low- and high - density regions . in the case of the equal separation of particles",
    ", there is no jump in the pressure distribution at the contact discontinuity , as shown in the rightmost panel .",
    "in this section , we show the results of several standard tests for fluid schemes , for both the standard sph and our new sph . in  [ sec : method ] , we describe our numerical code briefly . in  [ sec : shocktube ] , we show the results of the shock tube tests .",
    "then we show the evolution of system which is initially in hydrostatic equilibrium in  [ sec : surface ] . in  [ sec : kh ] and  [ sec : rt ] , tests for two important fluid instabilities are carried out .",
    "finally , we show the results of the blob tests which was first proposed by @xcite . in all tests ,",
    "our new sph shows much better result compared to that of the standard sph .",
    "we used asura , a parallel @xmath126-body / sph code , as a framework of current numerical experiments .",
    "asura adopts the leap - frog method for the time - integration . for simplicity",
    ", we used the shared steps with variable time - steps .",
    "the time - step is given by @xmath127 where @xmath128 and @xmath129 .",
    "for the standard sph , we first evaluated the densities of particles using eq .",
    "[ eq : ssph : density : ind_h ] .",
    "then , we calculated the pressure gradient and the time - derivative of the internal energy using eqs .",
    "[ eq : ssph : eular : ind_h ] and [ eq : ssph : energy : ind_h ] . in our new sph",
    ", we evaluated @xmath83 using eq .",
    "[ eq : esph : q ] first , and then we calculated the pressure gradient and the time derivative of the internal energy using eqs .",
    "[ eq : esph : eular ] and [ eq : esph : energy : u ] .",
    "we used eq .",
    "[ eq : visc : pi2 ] as the artificial viscosity term in both cases and we adopted @xmath130 .",
    "the balsara switch was also applied . to avoid the tensile instability",
    ", we used a first derivative of the kernel which has a cuspy core @xcite .",
    "the kernel size of each particle is determine to keep the number of neighbor particles within the range of @xmath64 .",
    "as an exception , in the one dimensional tests shown in  [ sec : shocktube ] , the kernel size is evaluated by @xmath131 or @xmath132 where @xmath133 for the sod s shock tube tests and @xmath134 for the strong shock tube tests .    for brevity , we sometimes express the standard sph as ssph .",
    "the sod shock tube @xcite is the most basic test for numerical schemes for compressible fluid .",
    "this test shows the shock capturing ability of schemes . in sph , not only the profile of the shock front but also the behavior of the contact discontinuity is important .",
    "here , we show the results of one- and three - dimensional shock tube tests .    the setup is as follows .",
    "we prepared the periodic domain of @xmath135 for the one - dimensional tests and @xmath135 , @xmath136 , and @xmath137 for the three dimensional tests .",
    "the initial condition is given by @xmath138 to express this initial condition , we use equal - mass particles and place 800 and 200 particles in the left and right domains , respectively , regularly in the one - dimensional tests . in three dimensional tests , we place 40000 and 10000 particles in the left and right domains , respectively , and a glass - like particle distribution was used .",
    "we set @xmath139 and gave the internal energy to each particle to ensure the given @xmath36 .",
    "in addition to the sod shock tube , we performed a one - dimensional strong shock test .",
    "the initial condition for this test is given by @xmath140 we use 1000 equal - mass particles in the computational domain of @xmath135 with the equal separation .",
    "figure [ fig:1dst ] shows the results of the one - dimensional shock tube tests with the standard sph and our new sph .",
    "the density ( upper row ) and pressure ( bottom row ) of each particle are plotted by circles .",
    "the red curves represent the analytic solutions .",
    "the standard sph reproduce the analytic solution of the density distribution well .",
    "the shock front is resolved by @xmath141 particles .",
    "the jump of the density at the contact discontinuity is resolved by a similar number of particles .",
    "the pressure shows large variations near the contact discontinuity , though it should be constant . since eq .",
    "[ eq : ssph : eular ] of the standard sph contains a large error near the contact discontinuity , in order to achieve zero acceleration , pressures of particles must have large variations .",
    "this result is the same as the results of previous works with the standard sph ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    in our new sph , unlike the case of the standard sph",
    ", the pressure around the contact discontinuity does not show a large jump .",
    "the reason is simply that the energy density is used instead of the mass density .",
    "the energy density is constant at the contact discontinuity .",
    "the reason why there is a small change in the pressure is that the particle separation changes at the contact discontinuity . as we showed in figure",
    "[ fig : pressure ] , our new sph still has small error in the pressure , due to the finite number of particles in the kernel .",
    "this error caused the change in the pressure in figure [ fig:1dst ] .",
    "the results of the three dimensional shock tube tests for the standard sph and our sph are shown in figure [ fig:3dst ] . in this figure ,",
    "the circles represent average values of particles in bins with the width of the mean particle separation at the high density part .",
    "again , we can see a variation in the pressure around the contact discontinuity in the case of the standard sph . in the case of our sph , there is no such variation .",
    "figure [ fig:1dst : strong ] shows the results of the strong shock tube tests for the standard sph and our new sph .",
    "the shock front and the contact discontinuity in the density distribution is well reproduced in the both cases . in this extreme test , both runs show jumps in the pressure distribution around the contact discontinuity .",
    "the absolute value of the pressure jump in our sph is much smaller than that in the standard sph .",
    "the jump found in the pressure in our sph is caused by the asymmetry in the particle distribution ( see  [ sec : esph : pressure ] ) .",
    "overall , our sph can handle such a strong shock problem , even when a very large pressure jump exists initially .",
    "this result is quite reassuring . in our new sph",
    ", it is assumed that pressure is continuous , which is not a valid assumption at the shock front .",
    "thus , it could fail to capture very strong shocks . the result shown in figure",
    "[ fig:1dst : strong ] shows that is not the case and our new sph can handle very strong shocks .      as is shown in ",
    "[ sec : ssph ] , in the standard sph , particles feel _ unphysical repulsive force _ at the interface of the contact discontinuity .",
    "therefore , in order to establish the hydrostatic equilibrium , the distance between particles at the different sides of the contact discontinuity must become larger than the `` true '' value .",
    "what is the consequence of this repulsive force ? here",
    ", we show the result of a simple test which helps us to understand the problem of the unphysical repulsive force .",
    "similar test has been used in @xcite .",
    "we follow the evolution of two fluids with different values of density , but with the same pressure .",
    "we performed two - dimensional tests .",
    "the computational domain is a square of the unit size , @xmath142 and @xmath143 , with a periodic boundary condition .",
    "initial conditions are @xmath144 we tried two different realizations . in the first one ,",
    "the particle mass is the same for the entire computational region .",
    "thus , the inter - particle distance is smaller in the high density region . in the second one , particles in the high density region is four times more massive than particles in the low - density region . in both cases ,",
    "particles are initially in a regular grid . for the equal - mass case ,",
    "the number of particles in the dense region is 4096 and that in the ambient is 3072 . for the equal - separation cases , those are 1024 and 3072 , respectively .",
    "initial velocities of particles were set to zero .",
    "since the system is initially in the hydrostatic equilibrium , particles should not move , except for small local adjustments .",
    "figure [ fig : surface ] shows the time evolution up to @xmath145 .",
    "there is a clear difference between the result of the standard sph and that of our sph . with the standard sph ,",
    "the high - density region , which initially has a square shape , quickly becomes rounder and almost completely circular by @xmath145 .",
    "we can understand this unphysical rounding as follows . as we stated in ",
    "[ sec : ssph ] and  [ sec : esph : pressure ] , unphysical repulsive force between particles operates at the contact discontinuity .",
    "we can see the effect of this force in the development of the gap of the distribution of particles near the boundary of two fluids .",
    "because of this gap , the bulk of the system is slightly compressed .",
    "the system seeks to achieve the energy minimum , by minimizing the surface area of the contact discontinuity .",
    "thus , the high - density region evolves to a circular shape , which minimizes the length of the boundary . in other words",
    ", the repulsive force effectively adds the `` surface tension '' .",
    "our new sph gives a far better solution , as we can see in the lower two rows of figure [ fig : surface ] .",
    "the overall square shape remains there till the end of the simulation in the equal - mass case .",
    "the result of the unequal - mass case is even better .",
    "the equation of motion of our sph eliminates the unphysical surface tension completely .",
    "figure [ fig : surface:1:64 ] shows the final state of the two - fluid system with the density contrast of 64 .",
    "our sph handles the system without any problem ( right panel ) . on the other hand , in the calculation with the standard sph",
    ", a wide and empty ring structure is formed between two fluids .      after the work by @xcite which demonstrated clearly that the standard sph can not deal with the kelvin - helmholtz instability correctly , many researchers proposed modifications of sph to solve the problem ( see  [ sec : intro ] ) . in this section ,",
    "we investigate how our new sph handles the kelvin - helmholtz instability .",
    "we prepared a two - dimensional computational domain , @xmath142 and @xmath143 .",
    "the periodic boundary condition was used .",
    "the density is @xmath146 we used equal - mass particles .",
    "the numbers of particles in the high and low dense regions are 131072 and 65522 , respectively .",
    "we set @xmath147 and @xmath148 .",
    "the high and low density regions had the initial velocities of @xmath149 and @xmath150 in the @xmath151 direction , respectively .",
    "we have used @xmath152 as the neighbor number .",
    "this value might seem a bit large , but we found it guarantees the good sampling of the particles in the low - density region at the interface .",
    "when we used @xmath153 , the variation of the pressure at the interface becomes too large .",
    "for the artificial viscosity , we used @xmath154 with the balsara switch .",
    "we added a small velocity perturbation to the particles near the interfaces , following @xcite .",
    "the velocity perturbation in the @xmath155 direction is as follows : @xmath156 , & |y-0.25| < 0.025 \\\\ a \\sin [ 2 \\pi ( x+0.5)/\\lambda ] , & |y-0.75| < 0.025 , \\end{cases}\\ ] ] where @xmath157 and @xmath158 .",
    "the time - scale of the growth of the kelvin - helmholtz instability is @xmath159 .",
    "we followed the evolution up to @xmath160 .",
    "the results are shown in figure [ fig:2dkh : snap ] .",
    "the difference between two results is clear . in the run with the standard sph , perturbations grow till @xmath161 , but the unphysical surface tension inhibited the growth of roll - like structures .",
    "the stretched high - density fluids break apart ( @xmath162 ) and form blobs ( @xmath163 ) .",
    "this evolution is completely different from those obtained by euler codes ( e.g. , * ? ? ?",
    "on the other hand , our new sph shows a very good result which is comparable to those with euler codes and with sph with the @xcite equation of motion or the artificial conductivity ( see * ? ? ? * ) .",
    "figure [ fig:2dkh : pressure ] shows the cross section of the pressure distribution along the @xmath155-axis .",
    "we can see that a very large pressure jump exists around the contact interfaces , in the case of the standard sph .",
    "the surface tension at the interface of the two fluids prevents the normal growth of the kelvin - helmholtz instability . on the other hand",
    ", there is no such jump in the case of our sph .",
    "since the pressure and particle distribution is well - behaved at the interface , the growth of the kelvin - helmholtz instability is not suppressed .",
    "@xcite demonstrated that the standard sph can not follow the development of the rayleigh - taylor instability correctly .",
    "we show the result with our sph as well as that with the standard sph .",
    "the initial setup is as follows .",
    "we prepared the two dimensional computational domain of @xmath142 and @xmath143 .",
    "we placed two fluids separated at @xmath164 .",
    "the density just above ( below ) the interface was set to @xmath165 ( @xmath166 ) .",
    "these two fluids were initially in the hydrostatic equilibrium .",
    "further , we assumed that each fluid was initially isoentropic .",
    "the density distributions of these fluids in the vertical direction are given by @xmath167^{\\frac{1}{\\gamma-1 } } & y < 0.5 , \\\\",
    "\\rho_h \\left [ 1+\\frac{\\gamma-1}{\\gamma } \\frac{\\rho_h g ( y-0.5)}{p_0 } \\right ] ^{\\frac{1}{\\gamma-1 } } & y \\ge 0.5 ,   \\label{eq : rt : init } \\end{cases}\\ ] ] where @xmath168 is the gravitational constant , @xmath169 is the value of pressure at the interface , and @xmath139 .",
    "the initial density and entropy profiles are shown in figure [ fig:2drt : init ] . to ensure the initial density distribution given by eq .",
    "[ eq : rt : init ] , we first placed equal - mass particles on the regular grid with the separation of 1/512 .",
    "then , we adjusted the vertical separation of each particle set having the same @xmath155 to reproduce the density distribution .",
    "the particle mass was set to @xmath170 and the total number of particles was 247296 .",
    "the periodic boundary condition was imposed on the @xmath151 direction .",
    "particles with @xmath171 and @xmath172 were fixed at the initial positions and they were not allow to change their internal energy .",
    "the velocity perturbation in the vertical direction was added as the seed of the instabilities .",
    "we carried out runs with two kinds of the seed .",
    "for the first test , we added the velocity perturbation to particles in the range of @xmath173 , and the form of the perturbation is @xmath174\\{1 + \\cos[5 \\pi ( y- 0.5)]\\}.\\ ] ] we set @xmath175 .",
    "for the second test , we added the velocity perturbation of the form : @xmath176 and @xmath177 where @xmath178 is the linear growth rate of the rayleigh - taylor instability , and @xmath179 is the wave number of the perturbation .",
    "the amplitude of each mode , @xmath180 , was drawn from a gaussian distribution with the variance of unity at random .",
    "this initial velocity perturbation is based on @xcite with slight modifications .",
    "velocities of the particles outside the perturbed region was set to zero .",
    "we call these two tests single - mode and multi - mode tests , respectively .    in figure [ fig:2drt :",
    "snap ] , the growth of the rayleigh - taylor instability in the case of the single - mode test is shown .",
    "the rayleigh - taylor instability develops in calculations with both of the standard sph and our sph , but the structures of them are quite different .",
    "the unphysical surface tension of the standard sph again prevents the development of the fine structures on the surface of the rayleigh - taylor fingers .",
    "thus , the result looks quite different from those obtained with euler schemes . on the other hand , in the calculation with our sph",
    ", the overall evolution of the rayleigh - taylor instability in our sph shows excellent agreement with those with euler schemes and the moving mesh scheme ( see * ? ? ?",
    "figure [ fig:2drt : snap : random ] shows the growth of the rayleigh - taylor instability with the multi - mode perturbations with the standard sph and our new sph .",
    "the global phase mixing of fluids can be seen in the result with our sph . on the other hand , due to the unphysical surface tension",
    ", the mixing is significantly suppressed in that of the standard sph .",
    "the distribution of two fluids looks like a mixture of oil and water .      as the final test",
    ", we performed the blob test proposed by @xcite .",
    "this test incorporates both the kelvin - helmholtz and rayleigh - taylor instabilities .",
    "we used read s initial condition of the blob test @xcite .",
    "the computational domain was @xmath181 , @xmath182 , and @xmath183 , and the periodic boundary condition was imposed .",
    "a cold cloud of the density @xmath184 in the mass unit of @xmath185and the length unit of @xmath186 and temperature @xmath187 was centered at @xmath188 .",
    "the radius of this cloud was @xmath189 .",
    "this cloud was embedded in the diffuse ambient gas of which density and temperature were @xmath190 and @xmath191 , respectively .",
    "the ambient gas had the velocity of @xmath192 .",
    "thus , the mach number of the flow to the cloud was @xmath193 .",
    "the total number of particle for the system is 4643283 .",
    "we integrated the system up to @xmath194 , where @xmath195 is the typical growth time - scale of the kelvin - helmholtz instability in this test @xcite .",
    "figure [ fig : blob : snap ] shows the snapshots of the cloud core .",
    "the upper and lower panels are the results with the standard sph and our sph , respectively .",
    "their evolutions were quite different .",
    "the blob simulated with the standard sph retained the single cloud structure until the late stage of the simulation .",
    "this behavior is consistent with those with the standard sph shown in @xcite .",
    "in contrast , the blob surface was disrupted in the run with our sph , due to the growth of the instabilities on the surface .",
    "the blob fragmented into several peaces and mixed eventually with the ambient gas .",
    "this behavior is similar to those obtained by euler codes .",
    "the evolution of the blob mass is shown in figure [ fig : blob : core ] . here",
    "we show the mass of gas with @xmath196 and @xmath197 , following @xcite . at @xmath198 ,",
    "the blob mass in the run of our sph became @xmath199 of the initial mass .",
    "this result is consistent with the results of the euler codes ( see figure 6 in * ? ? ?",
    "the evolution of the blob mass in the standard sph was much slower compared to that in our sph .",
    "in this paper , we described an alternative formulation of sph in which the energy density is used as the basis of the smoothing instead of the mass density . in our formulation ,",
    "the mass of particles is not used in the evaluation of the right - hand sides of the energy equation and the equation of motion . as a result ,",
    "the large error of force estimate at the contact discontinuity , which is unavoidable with the standard sph , disappears completely in our sph .",
    "not surprisingly , our sph can handle contact discontinuities and the kelvin - helmholtz and rayleigh - taylor instabilities without difficulty .",
    "the behavior of the shock in our new sph is essentially the same as that in the standard sph .",
    "since the equations used in our sph are almost identical to those of in the standard sph except that energy density is used in place of mass density @xmath31 .",
    "modification of existing sph code to use our scheme is simple and straightforward . in particular , there is no increase in the calculation cost .",
    "equations which are not derived in this paper , such as the diffusion equation @xcite , can be derived easily .",
    "@xcite improved the treatment of the kelvin - helmholtz instability of the standard sph , by applying artificial conductivity at the contact discontinuity .",
    "unlike the artificial viscosity , artificial conductivity introduces the dissipation not in the original set of equation .",
    "our sph does not need such additional dissipation , and thus the contact discontinuity is kept sharp .",
    "one might think our result contradicts with the requirement that all quantities in sph must be smooth @xcite .",
    "however , it is obvious that in our sph , all quantities in the right - hand side of the equations are smooth , since the only discontinuous quantity is the density and it does not appear in the right - hand sides .",
    "thus , our results does not contradict with monaghan s requirement .",
    "some of the numerical tests were carried out on the cray xt4 system in the center for computational astrophysics at the national astronomical observatory of japan .",
    "this work is supported by hpci strategic program field 5 ` the origin of matter and the universe ' and grant - in - aid for scientific research ( 21244020 ) of japan society for the promotion of science , ministry of education , culture , sports , science and technology , japan ."
  ],
  "abstract_text": [
    "<S> in the standard formulation of the smoothed particle hydrodynamics ( sph ) , it is assumed that the local density distribution is differentiable . </S>",
    "<S> this assumption is used to derive the spatial derivatives of other quantities . however </S>",
    "<S> , this assumption breaks down at the contact discontinuity , which appears often in simulations of astronomical objects . at the contact discontinuity </S>",
    "<S> , the density of the low - density side is overestimated while that of the high - density side is underestimated . as a result </S>",
    "<S> , the pressure of the low ( high ) density side is over ( under ) estimated . </S>",
    "<S> thus , unphysical repulsive force appears at the contact discontinuity , resulting in the effective surface tension . </S>",
    "<S> this effective surface tension suppresses instabilities such as the kelvin - helmholtz and rayleigh - taylor instabilities . in this paper , we present a new formulation of sph , which does not require the differentiability of density and thus can handle contact discontinuity without numerical problems . </S>",
    "<S> the results of standard tests such as the shock tube , kelvin - helmholtz and rayleigh - taylor instabilities , and the blob tests are all very favorable to our new formulation . </S>",
    "<S> we conclude that our new formulation solved practically all known difficulties of the standard sph , without introducing additional numerical diffusion or breaking the exact force symmetry or energy conservation . </S>"
  ]
}