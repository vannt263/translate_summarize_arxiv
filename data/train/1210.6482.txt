{
  "article_text": [
    "circadian rhythms are the fundamental daily oscillations in metabolism , physiology and behaviour that occur in almost all organisms , ranging from cyanobacteria to humans @xcite .",
    "the gene regulatory networks ( grns ) , or _ clocks _ , that generate these rhythms regulate the expression of associated genes in roughly 24-hour cycles .",
    "circadian networks have been studied in a variety of experimentally tractable model systems , revealing that different organisms share structurally similar circuits based around interlocking sets of positive and negative gene - protein feedback loops @xcite . in mammals ,",
    "circadian rhythms are being increasingly recognised as important to healthy phenotypes , playing a role in ageing @xcite , cancer @xcite , vascular disease @xcite and psychiatric disorders @xcite , as well as modulating innate immunity @xcite .",
    "clocks synchronise to their environment by using light and temperature to regulate the levels of one or more components of the feedback loops .",
    "this ensures that key biological processes are optimised relative to dawn and dusk , benefiting growth and survival @xcite .",
    "for the clock to provide such an adaptive advantage , the phase must change appropriately when the clock is subject to regular perturbations - particularly seasonal changes in daylength ( the _ photoperiod _ ) . however , as well as exhibiting flexible responses to variations in the input light signal , the clock must also exhibit robustness to irregular perturbations , such as genetic mutations and the intrinsically stochastic environment of the cell .",
    "temperature also plays a critical role as an environmental time cue . across different species ,",
    "the clock is relatively insensitive to temperature in that the period of free - running oscillations typically has a @xmath0 value close to 1 @xcite .",
    "this latter phenomenon , known as temperature compensation , is generally considered to be one of the defining properties of the circadian clock and has been suggested to be a key requirement for stability of the clock s phase relationship under seasonal temperature variations @xcite .",
    "the ability of ordinary and delay differential equations ( _ _ de__s ) to reproduce the underlying continuous dynamics of biochemical networks , and to parametrise individual reactions , has led to the construction of de models in a number of circadian organisms .",
    "these include the fungus _ neurospora crassa _",
    "@xcite , the fly _ drosophila melanogaster _",
    "@xcite , the mammal _ mus musculus _ @xcite and the higher plant _ arabidopsis thaliana _ @xcite .",
    "such models have proven useful in uncovering the general design principles of circadian oscillators , as well as providing a quantitative framework within which to interpret experimental results @xcite .",
    "in particular , novel insights have been gained into the mechanisms promoting robustness with respect to photoperiod changes @xcite , temperature fluctuations @xcite and molecular noise @xcite .",
    "the de models have also yielded experimentally - testable predictions that have lead to the discovery of novel circadian regulators @xcite .    however , a significant drawback of the de approach is that the values of the kinetic parameters controlling each individual reaction have to be specified , and for clocks these are typically unknown .",
    "when constructing a de  model , it is therefore necessary to calculate the particular combination of parameter values giving an optimal fit to experimental data @xcite . for realistic systems involving large numbers of reactions",
    ", this optimisation procedure is computationally very expensive making exhaustive parameter searches intractable . with increasing parameter numbers also comes a need for data with which to constrain the optimisation , placing a greater demand on experiment in terms of finance , time and ethics .",
    "these concerns mean that there is a pressing need for modelling approaches that minimise the number of parameters required , whilst adequately capturing the essential dynamical behaviour of the system of interest .",
    "here we develop just such an approach , based on boolean logic .",
    "in boolean models , the activity of each gene is described with a two - state variable taking the value on ( 1 ) or off ( 0 ) , meaning that its products are present or absent respectively .",
    "biochemical interactions are represented by simple , binary functions which calculate the state of a gene from the activation state of its upstream components @xcite .",
    "this approximation dramatically reduces the state - space of the system , mapping the infinite number of different continuous system states in a de model to a finite number of discrete states in the boolean equivalent .",
    "an additional important advantage of using a logic approach is that the total number of parameters is substantially reduced . for a given gene , the full set of reactions determining its state through a particular interaction",
    "is parametrised by a single _ signalling delay _ , representing the net time taken for these reactions to cause a change in state .",
    "fitting to experimental data introduces an associated _ discretisation threshold _",
    ", with expression levels above the threshold taken to correspond to the on state of the gene and levels below it to the off state @xcite . in fitting a particular experimental data set ,",
    "each delay becomes a multiple of the sampling interval , while only a bounded subset of thresholds will yield distinct boolean expression patterns .",
    "this means that the total number of parameter combinations is finite and can be enumerated .",
    "thus , by building a logic version of a de model , an infinite model can be converted into a finite one with fewer parameters to be optimised .",
    "this extends the scale and complexity of grns that can be studied by boolean models far beyond the practical scope of des .    in this work",
    ", we introduce the first boolean models of circadian networks . by constructing logic analogs of a number of established de  clock models ,",
    "we demonstrate that in each case the boolean models are capable of accurately reproducing the higher - order properties - particularly photoperiod responses - of their de counterparts .",
    "this suggests that the complex , biological signal transduction simulated by the de models can be captured in boolean equivalents possessing significantly smaller parameter sets .",
    "we introduce a general method for optimising boolean models that avoids the qualitative and often subjective terms characteristic of the cost functions used to fit the parameters of large de clock models .",
    "furthermore , we show that our fitting algorithm is capable of determining the optimal boolean model configuration associated with a given circuit topology and experimental data set .",
    "in particular , our algorithm successfully predicts the recently discovered repressive action of the circadian gene toc1 on lhy in the central feedback loop of the _ arabidopsis _ clock @xcite .",
    "taken together , our results show that boolean models can quantitatively distinguish between a range of putative regulatory structures on the basis of the system dynamics .",
    "this identifies boolean logic as a viable technique for reverse engineering circadian networks , complementing approaches based on des .",
    "moreover , our work also suggests novel hybrid modelling approaches based on employing boolean models as a first step towards the construction of more detailed de formulations .",
    "more generally , we propose that our methodology provides an efficient way of systematically modelling complex signalling pathways , including other oscillatory circuits and systems characterised by steady - state dynamics .",
    "we selected 4 recent circadian oscillator models of increasing complexity with which to assess the suitability of a boolean formulation .",
    "the simplest of these was a _",
    "neurospora _ model based on a single negative feedback loop with a single light input @xcite ( figure [ fig : decircuitdiags]a ) .",
    "this is represented by 3 differential equations ( _ _ de__s ) parametrised by 13 kinetic constants .",
    "the second model was a modified version of the 1-loop _ neurospora _ circuit in which there are a pair of negative feedback loops associated with different isoforms of the active protein @xcite ( fig .",
    "[ fig : decircuitdiags]b ) . the extra feedback loop results in 5 des parametrised by 18 kinetic constants .",
    "the third model was an _",
    "arabidopsis _ circuit based on a pair of interlocking feedback loops with 3 light inputs @xcite ( fig .",
    "[ fig : decircuitdiags]c ) .",
    "it is described by 13 des together with 64 kinetic constants .",
    "the final model considered was a 3-loop _ arabidopsis _ circuit obtained by adding an extra feedback loop and light input to the 2-loop system @xcite ( fig .",
    "[ fig : decircuitdiags]d ) .",
    "this yields 16 des parametrised by 80 kinetic constants .    in a boolean model , an interaction @xmath1 between two components @xmath2 and @xmath3",
    "is quantified by the corresponding signalling delay @xmath4 .",
    "this is the time taken for the biochemical processes represented by @xmath1 to convert a change in the state of @xmath2 into a change in the state of @xmath5 ( see fig .",
    "s1 of the electronic supplementary material ) .",
    "the signalling delays are thus parameters that determine the dynamics of the model , with different combinations of delays yielding different attractor states ( e.g. steady - states or limit cycles ) @xcite . in order to relate the discrete dynamics to the continuous variations in expression level",
    "observed experimentally , it is necessary to introduce a discretisation process .",
    "supplementary fig .",
    "s2a shows a hypothetical time course and supp .",
    "s2b the result of applying a particular discretisation threshold . in the general case ,",
    "the choice of threshold is dependent on the effective range of activity and expression that is critical for signal propagation . as a result",
    ", each threshold also becomes a parameter of the logic model @xcite .    for logic descriptions of the circadian networks shown in fig .",
    "[ fig : lcdiags ] , each edge is parametrised by a signalling delay @xmath4 and each vertex by a threshold @xmath6 .",
    "thus , a network is characterised by the vectors @xmath7 and @xmath8 . in fig .",
    "[ fig : hist_param ] , we compare the total number of parameters in the logic and de versions of each network ( see also supplementary table s1 ) .",
    "we can see that dramatically fewer parameters are required in a logic description compared to the corresponding de formulation .",
    "indeed for the largest network considered , 3-loop _ arabidopsis _ , the boolean description reduces the number of parameters by a factor of 4 .      in identifying the logic models that best reproduce the corresponding de dynamics , we considered variations to the structures of the networks shown in fig .",
    "[ fig : decircuitdiags ] . starting from the abstract topologies of fig .",
    "[ fig : lcdiags ] , each edge is activating or inhibiting , and where two or more edges lead into a vertex , the corresponding inhibition / activation signals are combined to determine the state of the gene .    in the boolean formalism , the manner in which regulatory signals affect a gene s expression level",
    "is represented by the corresponding _",
    "logic gate_. this is a binary function that specifies the current state of the gene , on ( 1 ) or off ( 0 ) , for each possible combination of input states shmulevich02b , watterson08a . for genes with a single input ,",
    "there are two possible functions for which the output varies with the input : the identity gate , in which the output follows the input ( @xmath9 and @xmath10 ) , and the not gate , in which the input is inverted ( @xmath11 and @xmath12 ) .",
    "these represent activation and repression of the gene by its regulator respectively .",
    "genes with two inputs are commonly modelled using either an and  or an or gate @xcite . for simplicity",
    ", we considered each multi - input gate to be a composition of ands and ors ( see methods for further details ) .",
    "the particular combination of logic gates used to model a network is referred to here as its _ logic configuration _ ( _ lc _ ) : this encodes the regulatory structure of the network in a compact fashion .",
    "it follows that each abstract topology of fig .",
    "[ fig : lcdiags ] gives rise to @xmath13 possible lcs , where @xmath14 is the number of edges and @xmath15 is the number of vertices with more than one input .",
    "the total number of possible lcs is 4 for 1-loop _ neurospora _ , 32 for 2-loop _ neurospora _ , 256 for 2-loop _ arabidopsis _ and 2048 for 3-loop _ arabidopsis_. in each case , a subset of these lcs are consistent with the pattern of activation and inhibition in the corresponding de model . that there can be more than one such lc in each case is due to the choice of and or or where a vertex has multiple edges leading into it . for _ neurospora",
    "_ , the 1-loop circuit has a unique lc consistent with the de model while for the 2-loop circuit there are two de lcs .",
    "the 2- and 3-loop _ arabidopsis _ networks yield 4 and 8 de lcs respectively .    for a given logic model",
    ", we would expect the de  lcs to most closely reproduce the de dynamics . to test this hypothesis",
    ", we optimised lcs to synthetic experimental data obtained from the de system , and then compared their predictive performance . for each lc ,",
    "the match to the continuous dynamics was quantified by finding the combinations of parameters ( signalling delays and discretisation thresholds ) that minimised a quantitativecost function . in order to be able to objectively compare the ability of the boolean models to reproduce experimental time courses against that of their de counterparts , we employed a cost function that closely mirrored those commonly used to optimise continuous models locke05a , locke05b , locke06,akman08,akman10,pokhilko10 .",
    "the cost function we used measured the goodness - of - fit of each logic model to synthetic data generated in both 24h light - dark ( ld ) cycles and the appropriate free - running light regime ( continuous dark , dd , for _ neurospora _ ; _ _  _ _ continuous light , ll , for _ arabidopsis _ ) . at each vertex",
    ", the cost score was calculated as the correlation between the discretised time series for the downstream species and the time - delayed predicted output calculated from the discretised data for the upstream species .",
    "scores were summed across all vertices and light regimes to give the final cost value ( see methods for details ) .",
    "after ranking the optimised lcs by score , we then assessed whether the top ranking lcs comprised viable clock circuits by checking that they were capable of : ( i ) generating self - sustained oscillations with a circadian period in constant conditions ; and ( ii ) entraining to ld cycles over a realistic range of photoperiods @xcite .    for the _ neurospora _ and 2-loop _ arabidopsis _ logic models ,",
    "the full set of lcs were fitted to synthetic data .",
    "the best - performing lcs for these networks are shown in figs .",
    "[ fig : neuroscores ] and [ fig : arabscores]a",
    ". it can be seen that the optimisation method produces a clear separation of the lcs by score .",
    "moreover , for each network , one of the de lcs is uniquely identified as the optimal circuit yielding a viable clock . in the case of 3-loop",
    "_ arabidopsis _ , we considered the subset of configurations obtained by setting the gates common with the 2-loop _ arabidopsis _ circuit to their optimised values .",
    "this mirrored the construction of the 3-loop de  model which was derived from the 2-loop system by adding an additional feedback loop while fixing all other interactions , and then optimising the parameters of the new loop @xcite .",
    "constraining the structure of the circuit in this fashion yielded 8 possible lcs ( the 2 edges in the lhy - prr loop described as activation or inhibition and the and/or interaction at lhy ; see fig .",
    "[ fig : lcdiags]d ) .",
    "figure [ fig : arabscores]b shows that in this system , as for the other models , a de lc emerges as the optimal circuit .      the time series generated by the optimal configurations in ld cycles are shown in fig .",
    "[ fig : ldts ] .",
    "the corresponding de simulations are also plotted for comparison .    in each case",
    "it is clear that the boolean models capture the same qualitative dynamics as their de counterparts .",
    "different species are switched on and off relative to one another with phases that match the patterns of rising and falling expression in the corresponding continuous time series .",
    "moreover , the delays between the switching times are similar to the phase differences between the peaks and troughs of the de solutions .    it should be noted that both boolean _ arabidopsis _ models reproduce the acute light response in the y gene , as well as the circadian response in y around dusk ( cf . figs .",
    "[ fig : ldts]e - h ) .",
    "this demonstrates the ability of the boolean circuits to simulate biochemical processes that occur on different time scales within the same system .",
    "the optimal lcs give equally good matches to the de dynamics in simulated free - running conditions , as can be seen in supp . fig . s3 .",
    "in order to assess the extent to which the boolean models reproduce the de dynamics in a more global and quantitative fashion we compared phase changes over a range of biologically realistic photoperiods . in the boolean framework , the times at which solutions switch between 0 and 1 emerge as natural phase measures . for continuous time courses - such as those generated by de models - the point in the circadian cycle at which the expression level of a molecular species decreases below a set threshold",
    "can be employed as a phase marker @xcite .",
    "this suggested using the time at which each species decreases below its discretisation threshold as a phase measure for the de simulations , and the time of the @xmath12 transition as the equivalent marker in the boolean models .",
    "the phase - photoperiod relationships computed in this fashion are shown for the _ neurospora _ models in figs .",
    "[ fig : pps]a and b. for both networks , the photoperiodic behaviour of the boolean and de models is very close : indeed for the 1-loop network , they are exactly equivalent . figs .",
    "[ fig : pps]c and d plot the photoperiod simulations obtained with the _ arabidopsis _ circuits . here too ,",
    "the phase - photoperiod profiles are very similar , with the addition of the lhy - prr  loop to the 2-loop model causing a transition from a predominately dusk - locked system to a dawn - locked one @xcite . in particular , the boolean 2-loop _ arabidopsis _ circuit exactly reproduces the dual light response in the y gene , in which the acute peak tracks dawn and the circadian peak tracks dusk .",
    "this suggests that the logic circuits possess sufficient dynamic flexibility to perform the complex integration of environmental signals that is a central property of circadian systems .",
    "the success of the logic models in recovering the correct de configurations from synthetic data suggested that for a fixed abstract topology , our optimisation procedure has the capacity to determine the logic network most consistent with a given data set .",
    "we tested this finding further by optimising the 3-loop _ arabidopsis _ logic circuit to highly - sampled experimental time series recorded using luciferase ( luc )  imaging in constant light from a wild - type strain @xcite .",
    "all possible lcs were considered , corresponding to a network inference carried out assuming no prior biological knowledge .",
    "the cost function optimised was the same as that used for fitting to synthetic ll data .",
    "as previously , viable clock circuits were taken to be those yielding autonomous limit cycles with circadian periods .",
    "the results of fitting to experimental data are presented in fig .",
    "[ fig : arabexpscores]a .",
    "it can be seen that the second highest ranking lc giving a viable circuit is a de configuration .",
    "this configuration , @xmath16 , is in fact the same as that previously determined to be optimal from the synthetic _ arabidopsis _ data sets .",
    "moreover , fig .",
    "[ fig : arabexpscores]b shows that @xmath16 emerges as the top ranking clock configuration if the regulatory structure is constrained to incorporate the central lhy - toc1 negative feedback loop of the corresponding continuous model .",
    "interestingly , the optimal configuration , @xmath17 , differs from @xmath16 in the sign of the toc1-lhy interaction , with toc1 repressing lhy in @xmath17 as opposed to activating it ( compare supp .",
    "s4a and b ) .",
    "this result is consistent with the recent experimental characterisation of the lhy - toc1 circuit as a double negative feedback loop , rather than the single negative loop assumed in the 2- and 3-loop de models @xcite .",
    "figures [ fig : expfreerunts]b and c show the simulations of the free - running clock obtained from the optimal and de configurations respectively . for both lcs ,",
    "the simulated oscillation period and timing of gene expression is close to that of the natural system ( cf .",
    "[ fig : expfreerunts]a ) .",
    "this can be seen clearly by comparing the durations for which each gene is on in the two boolean models with the corresponding peaks in the continuous data .",
    "circadian clocks have become popular systems for studying the relationship between gene - protein dynamics and phenotype .",
    "the molecular machinery underlying these networks has been relatively well characterised , and this has led to great interest in developing predictive computational models of the clock .",
    "such models are usually formulated as sets of differential equations .",
    "the high level of biochemical detail afforded by this approach has allowed de models to successfully address a range of issues regarding the functional relationship between the architecture of the clock and circadian homeostasis .",
    "one homeostatic mechanism that has been comprehensively investigated from a theoretical perspective is temperature compensation . by assuming that certain subsets of a circuit s kinetic parameters are temperature - dependent ,",
    "temperature has been incorporated into a number of circadian de models , ranging from minimal circuits built on the goodwin oscillator @xcite to more detailed formulations that explicitly model the underlying biochemical reactions @xcite .",
    "these models have provided new insights into the possible mechanisms that lead to circadian mutants with altered compensation properties , as well as suggesting generic motifs that may facilitate the tuning of the phase - temperature relationship .",
    "however , clock models based on des are characterised by large numbers of kinetic parameters , the values of which are typically unknown .",
    "optimising these to experimental data is a major computational bottleneck which imposes a hard bound on the maximum system size that can be studied .",
    "in addition , as the fitting problem is typically highly underdetermined and involves noisy , undersampled experimental data , robust optimisation can require the construction of cost functions targeting specific qualitative features of the data , introducing a degree of arbitrariness to the fitting procedure @xcite .",
    "the need for minimal clock parametrisations to address these issues has been recognised elsewhere in the literature .",
    "for example , recent _ neurospora _ work has shown that it is possible to use a simple two - parameter function to represent all the intermediate processes between the expression of a clock gene and its action on a downstream target , whilst still maintaining sufficient flexibility to accurately simulate biological temperature and photoperiod responses @xcite .    an alternative technique for modelling gene regulatory networks",
    "is provided by boolean logic . by assuming discrete expression levels , boolean models provide an even greater reduction in complexity , albeit at the cost of reduced biochemical precision .",
    "previous studies have exploited this reduction to study grn state - space structures @xcite , and to introduce probabilistic models that parametrise statistical transitions between states @xcite .",
    "the different limit cycles enumerable by a single boolean grn have been interpreted in some models as examples of cell differentiation @xcite , making limit cycle properties of special interest .",
    "elsewhere , boolean studies have focused on the regulatory logic underlying transcription @xcite , the immune response @xcite and apoptosis @xcite .    here",
    ", we have presented the first models of biological clocks based on the boolean formalism .",
    "we constructed logic versions of 4 de  models simulating circadian rhythms in the organisms _ neurospora crassa _ and _ arabidopsis thaliana_. to derive the best logic representations , both regulatory structure ( logic configuration ) and parameters ( signalling delays and discretisation thresholds ) were optimised to synthetic experimental data generated from the des . in each case",
    ", we found that the logic configuration yielding the best fit to data was consistent with that of the corresponding de system .",
    "this suggested that the boolean models were capable of identifying the particular combination of activating and inhibiting elements best able to account for a set of experimental expression patterns ( figs .",
    "[ fig : neuroscores ] and [ fig : arabscores ] ) .",
    "we confirmed this hypothesis by successfully applying our optimisation algorithm to real _ arabidopsis _",
    "luc  data ( fig .",
    "[ fig : arabexpscores ] ) .",
    "these results demonstrate that the logic models possess sufficient predictive power to perform biological network inference , despite their relative simplicity .",
    "moreover , the optimisation to luc data highlights the importance of network structure in determining dynamic behaviour @xcite .",
    "this optimisation gave rise to a pair of putative 3-loop network architectures with distinct parameter values that generated very similar expression time series ( supp .",
    "fig . s4 and fig .",
    "[ fig : expfreerunts ] ) .",
    "one of these architectures matched the 3-loop _ arabidopsis _ de model .",
    "it therefore contains the de model s core lhy - toc1 negative feedback loop , which was based on an experimental study that demonstrated the repression of toc1 by lhy whilst also inferring the activation of lhy by toc1 @xcite .",
    "significantly , the other architecture - which gave the best fit to data - agreed with more recent biochemical work showing that toc1 is in fact a repressor of lhy @xcite .",
    "this result is also consistent with a complementary computational study showing that an expanded version of the 3-loop de model incorporating a negative toc1-lhy interaction yields more accurate simulations of toc1 knockout and overexpression mutants @xcite .",
    "we also found that although the cost function used to fit synthetic data only assessed goodness - of - fit in simulated 12:12 ld cycles , the logic models gave very good fits to the des in long and short days also , closely reproducing the relationships between photoperiod and expression phase ( fig .",
    "[ fig : pps ] ) .",
    "the coordination of biochemical activity with the timing of dawn and dusk is a key system - level property that can be used to assess the relationship between the structure of a circadian network and its evolutionary flexibility @xcite .",
    "our photoperiod simulations indicate , somewhat surprisingly , that this property can be accounted for by significantly reduced dynamic models possessing much smaller parameter sets .",
    "in particular , the combined dawn- and dusk - tracking observed in the 2-loop _ arabidopsis _ de model ( fig .",
    "[ fig : pps]c ) is accurately replicated by its logic formulation which has less than 1/4 the number of parameters .",
    "a similar reduction was observed for 3-loop _ arabidopsis _ , with the 80 parameters describing the de models decreasing to 20 in its boolean equivalent ( supp .",
    "table s1 ) .",
    "the ability of simple , discrete models to simulate biologically realistic photoentraiment may also have important implications for the nature of circadian signal processing , in addition to being interesting from a modelling perspective .",
    "specifically , it is consistent with hypotheses based on experimental data suggesting that the mechanism by which daylength and light intensity information is transmitted to output pathways may be partly digital in nature @xcite .",
    "it should be noted that despite the success of the logic models in reproducing light responses , the coarser representation of network dynamics they provide means that the reproduction of certain circadian properties pose problems for the boolean approach .",
    "a particular restriction of note relates to the modelling of temperature compensation .",
    "temperature can be readily introduced into any de model by following the methodology originally introduced by ruoff @xcite . in this scheme",
    ", the temperature dependence of a kinetic parameter is assumed to be governed by the arrhenius relation .",
    "this leads to a simple balance equation for the corresponding activation energies and control coefficients which , when satisfied , guarantees a near - zero period - temperature derivative at the balance point . in a boolean model , the parameters that determine the free - running period @xmath18 are the discrete delays @xmath19 , and",
    "so simple balance equations can be derived from the form of the function determining the dependence of @xmath18 on the @xmath20s .",
    "for example , in the 2-loop _ neurospora _ model , it can be shown that @xmath21 .",
    "thus , compensation can be achieved simply by choosing the temperature dependence of each delay @xmath20 so that their sum is constant at each point over the range of interest . however , as the @xmath19s are generic parameters which in each instance summarise several biochemical processes , any balance equation derived in this manner will not in general be grounded in physical chemistry , reducing its biological relevance .",
    "in addition to providing a more compact parametrisation , a significant strength of the logic modelling approach is that it greatly reduces the complexity of the optimisation procedure itself .",
    "this enables optimal configurations and delay - threshold combinations to be distinguished with a greater objectivity .",
    "the critical simplification afforded by the boolean formulation is that the cost score is computed from bitstrings , which take the value 0 or 1 , rather than data that varies over a much broader range of values .",
    "this removes the need for _ ad hoc _ cost function terms for normalising the data and robustly computing period and phase .",
    "indeed , the cost function we employed in this work was extremely simple , computing the correlation between the predictions of the model and the corresponding discretised experimental data at each vertex .",
    "a second important simplification relates to the structure of the parameter space . in de models ,",
    "each interaction delay is dependent on processes that occur over a range of time scales ( e.g. transcription , translation , degradation etc ) .",
    "this means that as well as being uncountably infinite , the parameter space can cover several different orders of magnitude , making it difficult to establish _ a priori _ bounds .",
    "by contrast , each signalling delay in a logic model is constrained to be a multiple of the data sampling interval @xmath22 , and is bounded above by the maximum possible time @xmath23 over which the corresponding interaction can occur .",
    "@xmath23 is itself bounded by the duration of the experimental measurements and can be further restricted on the basis of biological knowledge ( here , the free - running period was used to bound all delays - see the methods section for details ) .",
    "the set of possible signalling delays is thus finite .",
    "the set of possible discretisation thresholds is also finite as varying the threshold for a given species will generate a set number of different binary time series , meaning it is only necessary to consider thresholds for which distinct bitstrings are obtained .",
    "for logic models , the parameter space as a whole is therefore finite , and can be objectively bounded .",
    "furthermore , for a fixed abstract topology , the set of all possible logic configurations is also finite ; it is simply equal to the set of possible boolean functions .",
    "this means that it is , in principle , possible to comprehensively search across _ all _ possible regulatory structures and parameter combinations to determine the best fit to data .",
    "such a search is impossible with de systems .",
    "furthermore , searching across different patterns of activation and inhibition for a de model is often problematic as it requires some _ a priori _ assumptions to be made regarding the underlying biochemical mechanisms ; e.g. specification of which reactions may be cooperative and the ranges of the corresponding hill coefficients @xcite . in practice , however , the number of possible network and parameter combinations in a boolean formulation can become too large for a complete search with the computational resources available , making it necessary to constrain the optimisation .      here , in order to ensure computational tractability , we subsampled the delay - threshold space , while also fixing the parameters controlling the impulse light inputs .",
    "in addition , we restricted ourselves to a subset of logic circuits by assuming that : ( i ) multiple light inputs to a gene are combined with an or gate ; and ( ii ) the net light signal directly modulates the state of the gene through either an and or an or  gate , depending on the free - running light regime ( see fig .",
    "[ fig : lcdiags ] ) . of course",
    "not all possible circuits will be biologically reasonable ones ( e.g. any circuit for which gates with light inputs uniformly output 0 or 1 would be unviable ) .",
    "nonetheless , it is reasonable to expect that some interactions may be more accurately modelled by gates that are not of the simple and/or type @xcite , meaning that better performing logic configurations may have been overlooked .    in view of these restrictions",
    ", the fact that our optimal boolean circuits match the dynamics of their target data sets , both synthetic and experimental , is very encouraging .",
    "indeed , we anticipate that it should be possible to find circuit configurations and parameter sets giving good fits to data over a broader range of genetic and environmental perturbations . for example , our boolean 3-loop _ arabidopsis _ model shows consistency with much of the photoperiodic behaviour of its de counterpart ( fig .",
    "[ fig : pps]d ) .",
    "however , it does not reproduce the phase response observed in the de model as photoperiod is decreased , for which some components switch between dawn- and dusk - dominance in a complex manner @xcite .",
    "a likely contributing factor is that our current optimisation method involves computing the score at every parameter combination over a fixed lattice .",
    "this can be inefficient , particularly where the stoichiometry of an interaction and/or its molecular dynamics require the density of interacting species to accrue beyond a certain value before the interaction is statistically likely to occur .",
    "in such cases , the optimal threshold choice for the discretisation is likely be found within a narrow band of possibilities .",
    "furthermore , high threshold resolutions can be required to resolve topological degeneracies in the cost function which make optimal networks difficult to distinguish ( see section s1.2 of the electronic supplementary material ) .",
    "the accuracy of the optimisation could thus be increased by employing logic variants of global search methods capable of providing a more computationally efficient exploration of the parameter space , such as evolutionary algorithms @xcite .",
    "this would increase the predictive power of the models , better positioning us to address features such as the dawn and dusk switching in shorter photoperiods observed in the 3-loop model .",
    "finally , we note that there are many promising avenues for further developing the approaches introduced in this study . from a theoretical perspective",
    ", there is scope for extending established methods for analysing boolean models .",
    "of particular interest are techniques for determining the simplest inequalities involving linear combinations of the time delays that are required to traverse a given path through the state space @xcite . in the context of circadian models , this would involve developing general methods for deriving linear inequalities that result in free - running cycles with the target period . as the computational demands of optimisation",
    "grow exponentially with the number of parameters to be fitted , restricting the search to the corresponding solution set would be expected to dramatically reduce the computational load .",
    "more generally , hybrid logic / de algorithms would see boolean methods used firstly to determine the optimal model configuration from data , and then to identify the regions of parameter space within which an equivalent de model is likely to give a good fit .",
    "this would exploit the ability of logic models , demonstrated in this work , to generate a coarse , but quantitative representation of the system dynamics in a systematic and efficient manner .",
    "we anticipate that regulatory networks of much greater complexity than those considered here could be quantitively modelled using such an approach .",
    "in order to incorporate some of the variability in expression levels characteristic of real experimental data , synthetic data was generated using the variant of gillespie s stochastic simulation algorithm ( ssa ) introduced by gonze _",
    ". fits to deterministic data obtained from direct integration of the des gave very similar results ( data not shown ) .",
    "however , the stochastic data sets yielded a clearer separation between lcs , most probably due to the lifting of topological degeneracies .",
    "for all circuits , final analyses were therefore restricted to the results obtained with stochastic time courses .    in generating the synthetic time courses , the scaling ( or extensitivity ) parameter @xmath24 was set close to the minimum value yielding self - sustained , unforced oscillations in each case .",
    "the final values used for simulations were : 1-loop _ neurospora _",
    ", @xmath25 2-loop _ neurospora _ , @xmath26 2- and 3-loop _ arabidopsis _ , @xmath27 .",
    "time series were generated for 5 cycles in both entrained ( ld 12:12 ) and free - running conditions ( dd for the _ neurospora _ models ; ll for _ arabidopsis _ ) .",
    "this choice mirrors the combination of experimental data sets typically chosen for parameter optimisation in computational circadian studies @xcite .",
    "time series were then subsampled every 0.5h to give the data used for model - fitting .",
    "plots of the synthetic ld data sets are shown in supp .",
    "experimental gene expression levels were measured using luciferase ( luc ) imaging , carried out as previously described @xcite .",
    "images were recorded using hamamatsu c4742 - 98 digital cameras operating at -75@xmath28c under the control of wasabi software ( hamamatsu photonics , hamamatsu city , japan ) with a sampling interval of 1.5h .",
    "bioluminescence levels were quantified using metamorph software ( mds , toronto , canada ) .",
    "the resulting expression profiles were detrended for amplitude and baseline damping using the mfourfit function of brassv3 @xcite .",
    "the detrended time series can be seen in fig .",
    "[ fig : expfreerunts]a .      for @xmath30 biochemical species ,",
    "let @xmath31 denote the activity of species @xmath32 at time @xmath33 , where @xmath33 is a multiple , @xmath34 , of the sampling interval @xmath22 .",
    "the update rule is then expressed as:@xmath35here the @xmath36s represent external light inputs to the circuit and @xmath37 are the signalling delays , with @xmath38 for all @xmath39 . assuming a 24h day and writing @xmath40 and @xmath41 for the times of dawn and dusk respectively ,",
    "the @xmath36s are described by the following function:@xmath42setting @xmath43 creates a constant darkness signal ( dd ) ; setting @xmath44  corresponds to constant light ( ll ) ; setting @xmath45 yields a continuous light - dark ( ld ) cycle .",
    "parameter sets with @xmath46 yield ld  cycles with a pulse of length @xmath47 at dawn .    the functions @xmath48 are boolean functions @xmath49 representing the interactions between genes and light inputs that determine the state of species @xmath2 .",
    "we introduce a _ logical dependency _ function ( or _ logic gate _ ) @xmath50 to describe these interactions .",
    "this function takes a single parameter @xmath51 , the value of which determines the type of reaction modelled .",
    "formally , we consider two types of operator .",
    "the first operator acts on a single boolean input @xmath52 , implementing either the identity or not gate , modelling activation and repression respectively : @xmath53the second type of operator acts on two boolean inputs @xmath54 , implementing either the and  or the ( inclusive ) ordependency .",
    "if either species can fulfil the interaction , an or dependency is used . if both species are required in the interaction , an and dependency is used .",
    "thus , for species @xmath55 and @xmath56 : @xmath57    the functions @xmath48 in ( [ eq : updaterule ] ) are formed as compositions of these dependencies .",
    "for example , the update rule for gene @xmath58 in the optimal 2-loop _ arabidopsis _ model has the form @xmath59using ( [ eq : gatetype1 ] ) and ( [ eq : gatetype2 ] ) , this can be written as a composition of logic functions@xmath60with @xmath61 and @xmath62 .",
    "the resulting boolean function models a reaction in which @xmath63 must be downregulated in order for @xmath64 to activate @xmath58 production .    a given set of interaction functions @xmath48 has an associated adjacency matrix @xmath65 defined by@xmath66where @xmath67 .",
    "thus , @xmath68 if species @xmath69 can change the state of @xmath2 , and so matrix @xmath70 describes the abstract topology of a model ( these topologies can be seen in fig .",
    "[ fig : lcdiags ] ) .",
    "it follows that a circadian clock model is parametrised by its adjacency matrix @xmath70 , a set of delays @xmath71 and a set of gates @xmath72 .",
    "writing @xmath73 , this yields the following compact , vectorised form of the update rule:@xmath74we refer to the set of gates @xmath75 as the model s _ logic configuration _ ( lc ) . as each configuration @xmath76 ,  is a bitstring , it can be represented uniquely by the corresponding decimal expansion @xmath77 defined below:@xmath78for the models considered , the lcs are enumerated in terms of their decimal expansions for simplicity in figs .",
    "[ fig : neuroscores ] , [ fig : arabscores ] and [ fig : arabexpscores ] .    of the lcs",
    "consistent with @xmath70 , a subset matches the pattern of activation and inhibition in the corresponding de  model .",
    "there are referred to as the _",
    "de  lcs_. for example , for the 2-loop _ neurospora _ model , _ frq _ activates both isoforms of frq , giving @xmath79 , and both isoforms repress transcription , giving @xmath80 ( see fig . [ fig : decircuitdiags]b and fig .",
    "[ fig : lcdiags]b ) .",
    "there are thus a pair of de  lcs in this case , @xmath81 and @xmath82 , depending on whether both isoforms are required for repression ( @xmath83 , corresponding to or ) or a single isoform is sufficient ( @xmath84 , corresponding to and ) .",
    "these delcs are encoded by the integers 6 and 7 respectively .",
    "finally , in order to construct the simplest logic models consistent with the general form of circadian de systems , each boolean function @xmath48 is assumed to have the form @xmath85such that : ( i ) @xmath86 implements either the and  or or gate ; ( ii ) @xmath87 encodes the structure of the free - running system ; and ( iii ) @xmath88 determines how multiple light inputs are integrated , with @xmath89 and @xmath90 . for consistency ,",
    "it is therefore necessary that setting each light input @xmath36 to the relevant constant value @xmath91 recovers the free - running system ( @xmath92 for dd ; @xmath93 for ll ) .",
    "this condition is equivalent to @xmath94 .",
    "for the _ neurospora _ models , where the free - running condition is dd , the consistency condition is achieved using an or  gate since @xmath95 or @xmath96 . in the case of the _ arabidopsis _ circuits , where the free - running condition is ll ,",
    "the and gate is appropriate as @xmath95 and @xmath97 .    for both _",
    "arabidopsis _ models , the multiple light inputs to y are combined using an or gate : this is because in the corresponding de models , both inputs can independently upregulate transcription @xcite .",
    "in addition , the 3-loop model only incorporates the pulsed light input to the prr gene since removing the continuous light input from the de  system had a negligible effect on its photoperiodic behaviour .",
    "full details of the logic formulation of each clock network are given in section s2 of the electronic supplementary material .      in order to identify the optimal combination of signalling delays @xmath98 ,",
    "thresholds @xmath99 and logic gates @xmath100 for a given model and data set , we must introduce a cost function to be minimised .",
    "we used a simple function based on a correlation between the predicted time courses generated by the model and the corresponding data .",
    "further details can be found in section s1.1 of the electronic supplementary material .",
    "optimal lc - parameter combinations are given in tables 1 and 2 .",
    "the most comprehensive strategy in seeking to minimise the cost function is to systematically calculate the cost for all possible configurations and parametrisations of the model ; that is all delays @xmath101 , where @xmath23 is the longest timescale considered in the system , and all thresholds @xmath102 .",
    "however , when the model becomes too complex to permit a global analysis , it becomes necessary to introduce further constraints to restrict the parametrisation to be considered .",
    "such constraints should be as objective as possible .",
    "one viable , objective constraint is to limit all the signalling delays around a closed loop so that they sum to no more than the period @xmath103 of free - running oscillations in the target data set .    for 1-loop _",
    "neurospora , _ this gives the single delay bound@xmath104where @xmath105h .    for 2-loop",
    "_ neurospora _ , the constraint results in 2 delay bounds@xmath106where again @xmath105h .    for 2-loop _ arabidopsis _ , there are 3 delay bounds:@xmath107 in this case @xmath108h .    for 3-loop _",
    "arabidopsis _ , there are 4 delay bounds : those for the 2-loop model above together with an extra bound introduced by the addition of the lhy - prr  loop:@xmath109for this circuit , @xmath110h .",
    "two further constraints were introduced for reasons of computational tractability .",
    "firstly , each delay @xmath4 was restricted to integer multiples of a minimum delay resolution @xmath111 , itself a multiple @xmath112 of the data sampling interval @xmath22 .",
    "secondly , each threshold @xmath6 was bounded within a subinterval @xmath113 $ ] of @xmath114 $ ] , and also restricted to integer multiples of a minimum threshold resolution @xmath115 .      for all models , @xmath116 and @xmath117",
    "were set to the values @xmath118 and @xmath119 respectively .",
    "for the _ neurospora _ models , @xmath120 was set to @xmath121 and @xmath115 to @xmath122 ; for the _ arabidopsis _ models , @xmath120 was initially set to @xmath123 and @xmath115 to @xmath124 .",
    "scores were then recalculated with @xmath125 and @xmath126 , within intervals @xmath127 $ ] and @xmath128 $ ]  centred around the parameter combinations giving the best scores . for _ arabidopsis _ optimisations , light parameters controlling the impulse inputs ( @xmath129 and @xmath130 in the 2-loop circuit ; @xmath131 and @xmath132 in the 3-loop circuit ) were fixed at the values shown in table [ tab : optimparams ] .",
    "these were determined from discrete approximations to the corresponding continuous curves in the de models .",
    "each parameter set was then checked for a functioning circadian clock .",
    "firstly , the solution to the free - running model was generated under the appropriate continuous light conditions , using the discretised data as initial conditions .",
    "if a limit cycle was obtained with period within @xmath133 of the de  model , this was fed into the model under simulated 12:12 ld cycles .",
    "periodic , entrained oscillations were taken to indicate a viable clock circuit .",
    "for the _ neurospora _ and 2-loop _ arabidopsis _ models , optimisations included all possible lcs .",
    "the 3-loop _ arabidopsis _ optimisations were restricted to the subset of lcs defined by @xmath134 , @xmath135 ; these are the configurations that result from fixing gates @xmath136 to their optimised values in the 2-loop circuit .    the photoperiod simulations shown in fig .",
    "[ fig : pps ] were obtained by locally reoptimising the logic circuits yielding viable clocks to simulations of the de models under 12:12 ld cycles , and then calculating the maximum symmetric photoperiod interval @xmath137 over which both model formulations generated stable , entrained solutions .",
    "the cost was minimised with a simulated annealing algorithm @xcite , using a cost function for which the data and predicted time courses were taken to be single cycles of the entrained solution in the de  and logic models respectively .      in fitting the 3-loop _ arabidopsis _ model to the luc data shown in fig .",
    "[ fig : expfreerunts]a , genes were matched to model variables in the following manner : ( i ) cca1 was equated to lhy on the basis that the lhy variable in the equivalent de model groups together the effect of the two genes @xcite ; ( ii ) toc1 was matched to toc1 ; ( iii ) giwas matched to y owing to experimental results showing that this gene can account for some of the action of y in the de model @xcite ; ( iv ) prr9 was matched to prr , as this variable combines the prr7 and 9 genes in the de formulation @xcite .",
    "since the exact biological correlate of variable x is currently unknown , it was not used for costing the fit .",
    "consequently , @xmath138 and @xmath139 were both fixed at 0 ( note that fixing @xmath138 reduces the number of possible lcs from 2048 to 1024 ) .",
    "this preserves the dynamics of all components in the model excluding x , together with the delay bounds used for constraining the parameter space .",
    "it also means that toc1 and the dummy variable x have identical time series .",
    "thus , in practice , the discretised toc1 expression time series was used as a proxy for x data when calculating the cost at the lhy  vertex . also , as the luc data was measured in ll , the parameters @xmath140 controlling the light inputs were all set to 24 ( cf .",
    "( [ eq : lightfunc ] ) ) . in ll conditions",
    ", the absence of dawn and dusk means that the choice of the delay parameters @xmath141 is arbitrary .",
    "we therefore set the values of these delays to 0 .",
    "@xmath116 and @xmath117 were fixed at @xmath118 and @xmath142 respectively .",
    "@xmath120 was initially set to @xmath123 and @xmath115 to @xmath118 .",
    "scores were then recalculated with @xmath125 and @xmath143 , within intervals @xmath144 $ ] and @xmath145 $ ]  centred around the best scoring parameter sets .",
    "the optimal parameter set for each lc was assessed to determine whether it yielded a viable clock by first generating the solution to the model using the discretised luc time series as initial conditions , and then checking that this gave a limit cycle with free - running period within @xmath133 of 24h .",
    "the numerical routines for parameter optimisation and model simulation were initially developed in matlab ( mathworks , cambridge ) and c. the scoring algorithms used for global parameter sweeps were subsequently converted into java and run on a task farm computer consisting of 118 intel harpertown quad - core processors .",
    "all software used is available on request from the corresponding author .",
    "the authors would like to thank kieron edwards for making available the luciferase data used for model fitting and declan bates and jonathan fieldsend for helpful comments on the manuscript .",
    "csbe is a centre for integrative systems biology funded by bbsrc and epsrc award d019621 .",
    "this work was supported by wellcome trust program grant wt066784 ( to pg ) , and has made use of resources provided by the edinburgh compute and data facility ( http://www.ecdf.ed.ac.uk/ ) through the edikt initiative ( http://www.edikt.org.uk ) .",
    "ap  was funded by a bbsrcsummer studentship and a moray endowment small grant awarded by the university of edinburgh .",
    "the authors would also like to acknowledge the help of konrad paszkiewicz and robin batten in accessing hpc facilities provided by the university of exeter under its systems biology initiative .",
    "10    dunlap , j.  c. , loros , j.  j. & decoursey , p.  j. 2003 _ chronobiology : biological timekeeping_. ( sinauer ) .",
    "young , m.  w. & kay , s.  a. 2001 time zones : a comparative genetics of circadian clocks . , 70215 .",
    "bell - pedersen , d. , cassone , v.  m. , earnest , d.  j. , golden , s.  s. , hardin , p.  e. , thomas , t.  l. & zoran , m. 2005 circadian rhythms from multiple oscillators : lessons from diverse organisms . , 544556 .",
    "zhang , e.  e. & kay , s.  a. 2010 clocks not winding down : unravelling circadian networks .",
    ", 764776 .",
    "khapre , r.  v. , samsa , w.  e. & kondatov , r.  v. 2010 circadian regulation of cell cycle : molecular connections between aging and the circadian clock .",
    ", 16951700 .",
    "gery , s. & koeffler , h.  p. 2010",
    "circadian rhythms and cancer .",
    ", 10971103 .",
    "takeda , n. & maemura . ,",
    "k. 2010 circadian clock and vascular disease .",
    ", 645651 .",
    "westrich , l. & sprouse . ,",
    "j. 2010 circadian rhythm dysregulation in bipolar disorder .",
    ", 779787 .",
    "lange , t. , dimitrov , s. , fehm , h.  l. , westermann , j. & born , j. 2006 shift of monocyte function toward cellular immunity during sleep .",
    ", 16951700 .",
    "liu , j. , malkani , g. , mankani , g. , shi , x. , meyer , m. , cunningham - runddles , s. & sun , z.  s. 2006 the circadian clock period 2 gene regulates gamma interferon production of nk cells in host response to lipopolysaccharide - induced endotoxic shock . , 47504756 .",
    "keller , m. , mazuch , j. , abraham , u. , eom , g.  d. , herzog , e.  d. , volk , h.  d. , kramer , a. & maier , b. 2009 a circadian clock in macrophages controls inflammatory immune responses . , 2140712 .",
    "ouyang , y. , andersson , c.  r. , kondo , t. , golden , s.  s. & johnson , c.  h. 1998 resonating circadian clocks enhance fitness in cyanobacteria . , 86604 .",
    "dodd , a.  n. , salathia , n. , hall , a. , kvei , e. , tth , r. , nagy , f. , hibberd , j.  m. , millar , a.  j. & webb , a.  a. 2005 plant circadian clocks increase photosynthesis , growth , survival , and competitive advantage .",
    ", 6303 .",
    "gardner , g.  f. & feldman , j.  f. 1981 temperature compensation of circadian period length in clock mutants of _ neurospora crassa_. , 12441248 .",
    "ruoff , p. , rensing , l. , kommedal , r. & mohsenzadeh , s. 1997 modeling temperature compensation in chemical and biological oscillators .",
    ", 499510 .",
    "gould , p.  d. , locke , j.  c. , larue , c. , southern , m.  m. , davis , s.  j. , hanano , s. , moyle , r. , milich , r. , putterill , j. , millar , a.  j. & hall , a. 2006 the molecular basis of temperature compensation in the _ arabidopsis _ circadian clock . , 11771187 .",
    "brunner , m. & diernfellner , a. 2006 how temperature affects the circadian clock of _ neurospora crassa_. , 8190 .",
    "akman , o.  e. , locke , j. c.  w. , tang , s. , carr , i. , millar , a.  j. & rand , d.  a. 2008 isoform switching facilitates period control in the _ neurospora crassa _",
    "circadian clock .",
    "leloup , j .- c . ,",
    "gonze , d. & goldbeter , a. 1999 limit cycle models for circadian rhythms based on transcriptional regulation in _ drosophila _ and _ neurospora_. , 433448 .",
    "smolen , p. , baxter , d.  a. & byrne , j.  h. 2001 modeling circadian oscillations with interlocking positive and negative feedback loops . , 664456 .",
    "sriram , k. & gopinathan , m.  s. 2004 a two variable delay model for the circadian rhythm of _ neurospora crassa_. , 2338 .",
    "francois , p. 2005",
    "a model for the _ neurospora _ circadian clock .",
    ", 23692383 .",
    "ruoff , p. , loros , j.  j. & dunlap , j.  c. 2005 the relationship between frq - protein stability and temperature compensation in the _ neurospora _ circadian clock .",
    ", 176816 .",
    "hong , c.  i. , jolma , i.  w. , loros , j.  j. , dunlap , j.  c. & ruoff , p. 2008",
    "simulating dark expressions and interactions of frq and wc-1 in the _ neurospora _ circadian clock .",
    ", 122132 .",
    "akman , o.  e. , rand , d.  a. , brown , p.  e. & millar , a.  j. 2010 robustness from flexibility in the fungal circadian clock .",
    "goldbeter , a. 1995 a model for circadian oscillations in the _ drosophila _ period protein per . , 31924 .",
    "leloup , j.  c. & goldbeter , a. 1998 a model for circadian rhythms in _ drosophila _ incorporating the formation of a complex between the per and tim proteins . , 7087 .",
    "ueda , h.  r. , hagiwara , m. & kitano , h. 2001 robust oscillations within the interlocked feedback model of _ drosophila _ circadian rhythm .",
    ", 4016 .",
    "smolen , p. , hardin , p.  e. , lo , b.  s. , baxter , d.  a. & byrne , j.  h. 2004 simulation of _ drosophila _ circadian oscillations , mutations , and light responses by a model with vri , pdp-1 , and clk .",
    ", 2786802 .    forger , d.  b. & peskin , c.  s. 2003 a detailed predictive model of the mammalian circadian clock .",
    ", 1480611 .",
    "leloup , j.  c. & goldbeter , a. 2003 toward a detailed computational model for the mammalian circadian clock . , 70516 .",
    "becker - weimann , s. , wolf , j. , herzel , h. & kramer , a. 2004 modeling feedback loops of the mammalian circadian oscillator .",
    ", 30233034 .",
    "mirsky , h.  p. , liu , a.  c. , welsh , d.  k. , kay , s.  a. & doyle iii , f.  j. 2009 a model of the cell - autonomous mammalian circadian clock .",
    ", 1110712 .",
    "locke , j. c.  w. , millar , a.  j. & turner , m.  s. 2005 modelling genetic networks with noisy and varied experimental data : the circadian clock in _",
    "arabidopsis thaliana_. , 38393 .",
    "locke , j. c.  w. , southern , m.  m. , kozma - bognar , l. , hibberd , v. , brown , p.  e. , turner , m.  s. & millar , a.  j. 2005 extension of a genetic network model by iterative experimentation and mathematical analysis .",
    ", 2005.0013 .",
    "locke , j. c.  w. , kozma - bognar , l. , gould , p.  d. , fehr , b. , kevei , e. , nagy , f. , turner , m.  s. , hall a. & millar , a.  j. 2006 experimental validation of a predicted feedback loop in the multi - oscillator clock of _ arabidopsis thaliana_. , 59 .",
    "zeilinger , m.  n. , farr , e.  m. , taylor , s.  r. , kay , s.  a. & doyle iii , f.  j. 2005 a novel computational model of the circadian clock in _ arabidopsis _ that incorporates prr7 and prr9 . , 58 .",
    "pokhilko , a. , hodge , s.  k. , stratford , k. , knox , k. , edwards , k. , thomson , a.  w. , mizuno , t. & millar , a.  j. 2010 data assimilation constrains new connections and components in a complex , eukaryotic circadian clock model .",
    "gonze , d. , halloy , j. & goldbeter , a. 2002 biochemical clocks and molecular noise : theoretical study of robustness factors . , 1099711010 .",
    "gonze , d. , halloy , j. & goldbeter , a. 2002 robustness of circadian rhythms with respect to molecular noise . , 6738 .",
    "vilar , j.  m. , kueh , h.  y. , barkai , n. & leibler , s. 2002 mechanisms of noise - resistance in genetic oscillators .",
    ", 59885992 .",
    "kauffman , s.  a. 1969 metabolic stability and epigenesis in randomly constructed genetic nets .",
    ", 437467 .",
    "thomas , r. 1991 regulatory networks seen as asynchronous automata : a logical description . , 123 .",
    "kaufman , m. , andris , f. , leo , o. 1999 a logical analysis of t cell activation and anergy .",
    ", 38943899 .",
    "shmulevich , i. , dougherty , e.  r. , kim , s. & zhang , w. 2002 probabilistic boolean networks : a rule - based uncertainty model for gene regulatory networks .",
    ", 261274 .",
    "watterson , s. , marshall , s. & ghazal , p. 2008 logic models of pathway biology .",
    ", 447456 .",
    "yu , l. , watterson , s. , marshall , s. & ghazal , p. 2008",
    "inferring boolean networks with perturbation from sparse gene expression data : a general model applied to the interferon regulatory network .",
    ", 10241030 .",
    "saez - rodriguez , j. , alexopoulos , l.  g. , epperlein , j. , samaga , r. , lauffenburger , d.  a. , klamt , s. & sorger , p.  k. 2009 discrete logic modelling as a means to link protein signalling networks with functional analysis of mammalian signal transduction .",
    "schlatter , r. , schmich , k. , avalos vizcarra , i. , scheurich , p. , sauter , t. , borner , c. , ederer , m. , merfort , i. & sawodny , o. 2009 on / off and beyond - a boolean model of apoptosis .",
    ", e1000595 .",
    "watterson , s. & ghazal , p. 2010 use of logic theory in understanding regulatory pathway signaling in response to infection . , 163176 .",
    "gendron , j.  m. , pruneda - paz , j.  l. , doherty , c.  j. , gross , a.  m. , kang , s.  e. & kay , s.  a. 2012 _ arabidopsis _ circadian clock protein , toc1 , is a dna - binding transcription factor .",
    ", 316772 .",
    "thomas , r. 1983 logical description , analysis and synthesis of biological and other networks comprising feedback loops .",
    ", 247282 .",
    "kaufman , m. , urbain , j. & thomas , r. 1985 towards a logical analysis of the immune response .",
    ", 527561 .",
    "shmulevich , i. , dougherty , e.  r. & zhang , w. 2002 from boolean to probabilistic boolean networks as models of genetic regulatory networks .",
    ", 17781792 .",
    "troein , c. , locke , j.  c. , turner , m.  s. & millar , a.  j. 2009 weather and seasons together demand complex biological clocks . , 19614 .",
    "tan , y. , dragovic , z. , roenneberg , t. & merrow , m. 2004 entrainment dissociates transcription and translation of a circadian clock gene in _ neurospora_. , 4338 .",
    "edwards , k.  d. , akman , o.  e. , knox , k. , lumsden , p.  j. , thomson , a.  w. , brown , p.  e. , pokhilko , a. , kozma - bognar , l. , nagy , f. , rand , d.  a. & millar , a.  j. 2010 quantitative analysis of regulatory flexibility under changing environmental conditions .",
    "ruoff , p. & rensing , l. 1996 the temperature - compensated goodwin model simulates many circadian clock properties .",
    ", 275285 .    ay , f. , xu , f. & kahveci , t. 2009 scalable steady state analysis of boolean biological regulatory networks . ,",
    "hau , l.  d. & kwon , y.  k. 2011 the effects of feedback loops on disease comorbidity in human signaling networks .",
    ", 111320 .",
    "krawitz , p. & shmulevich , i. 2007 basin entropy in boolean network ensembles . , 158701 .",
    "ribeiro , a.  s. & kauffman , s.  a. 2007 noisy attractors and ergodic sets in models of gene regulatory networks .",
    ", 74355 .",
    "garg , a. , cara , a.  d. , xenarios , i. , mendoza , l. & micheli , g.  d. 2008 synchronous versus asynchronous modeling of gene regulatory networks . , 191725 .",
    "buchler , n. , gerland , u. & hwa , t. 2003 on schemes of combinatorial transcription logic .",
    ", 51365141 .",
    "gerstung , m. , timmer , j. & fleck , c. 2009 noisy signaling through promoter logic gates .",
    ", 011923 .",
    "hunziker , a. , tuboly , c. , horvth , p. , krishna , s. & semsey , s. 2010 genetic flexibility of regulatory networks . , 129983003 .",
    "milo , r. , shen - orr , s. , itzkovitz , s. , kashtan , n. , chklovskii , d. & alon , u. 2002 network motifs : simple building blocks of complex networks .",
    ", 824827 .",
    "prill , r. , iglesias , p. & levchenko , a. 2005 dynamic properties of network motifs contribute to biological network organization .",
    ", e343 .",
    "alabad , d. , oyama , t. , yanovsky , m.  j. , harmon , f.  g. , ms , p. & kay , s.  a. 2001 reciprocal regulation between toc1 and lhy / cca1 within the _ arabidopsis _ circadian clock . , 880883 .",
    "pokhilko , a. , fernandez , a.  p. , edwards , k.  d. , southern , m.  m. , halliday , k.  j. & millar , a.  j. 2012 the clock gene circuit in _ arabidopsis _ includes a repressilator with additional feedback loops .",
    "dodd , a.  n. , love , j. & webb , a.  a. 2005 the plant clock shows its metal : circadian regulation of cytosolic free ca@xmath146 .",
    ", 1521 .",
    "ruoff , p. 1992 introducing temperature - compensation in any reaction kinetic oscillator model .",
    ", 9299 .",
    "ruoff , p. 1994 general homeostasis in period and temperature - compensated chemical clock mutants by random selection conditions .",
    ", 456459 .",
    "mendes , p. & kell , d. 1998 non - linear optimization of biochemical pathways : applications to metabolic engineering and parameter estimation . , 86983 .",
    "kirkpatrick , s. , gelatt , c.  d. & vecchi , m.  p. 1983",
    "optimization by simulated annealing .",
    ", 671680 .",
    "* figure 1 . circuit diagrams for the clock models . *",
    "genes are boxed and arrows denote regulatory interactions .",
    "diamonds represent light inputs . *",
    "a*. the single - loop _ neurospora _ model @xcite .",
    "frq protein represses production of _ frq _ transcript .",
    "light acts on the network by upregulating _",
    "frq _ transcription . *",
    "b*. the two - loop _ neurospora _ model @xcite .",
    "two isoforms of frq are produced which both repress _ frq _ transcription .",
    "light upregulates _ frq _ as in a. * c*. the two - loop _ arabidopsis _ model @xcite .",
    "toc1 activates its repressor lhy ( combining lhy and cca1 ) indirectly through a hypothetical gene x , forming the central negative feedback loop of the circuit .",
    "lhy is directly upregulated by light while light indirectly activates toc1 via a second hypothetical gene y , posited to have two distinct light inputs .",
    "y activates toc1 transcription and toc1 represses y , forming a second , interlocked feedback loop . *",
    "d*. the three - loop _ arabidopsis _ model @xcite .",
    "the additional prr gene ( combining prr7 and prr9 ) is light - activated and represses lhy transcription .",
    "lhy upregulates prr , creating a third feedback loop .",
    "* figure 2 .",
    "the abstract topologies for the logic representations of the clock circuits shown in fig .",
    "[ fig : decircuitdiags ] .",
    "* genes are boxed and arrows denote regulatory interactions . *",
    "a*. the single - loop _ neurospora _ model .",
    "* b*. the two - loop _ neurospora _ model . * c*. the two - loop _ arabidopsis _ model .",
    "* d*. the three - loop _ arabidopsis _ model .",
    "numerals @xmath147 index logic gates @xmath148 that can be varied to generate different regulatory structures .",
    "numerals at the end of an arrow index the single - input gate defining that interaction . numerals within boxes index logic gates governing double - input interactions .",
    "diamonds represent light inputs , with the corresponding fixed gates in ovals indicating how these affect the target species ( e.g. in c , @xmath149 and @xmath130 are combined with an or gate after which the resulting bitstring is combined with the output of y through an and gate - see the methods sections for full details ) . @xmath150s",
    "represent the circuit delays and @xmath151s the discretisation thresholds used to fit continuous data .",
    "* figure 3 . the number of parameters required for each clock configuration as de and logic models .",
    "*    * figure 4 .",
    "the results of exploring the logic configurations belonging to the abstract topologies of the 1-loop ( * a * ) and 2-loop ( * b * ) _ neurospora _ models .",
    "* cost scores are shown for the optimal fit of each lc to synthetic data .",
    "the lcs are indexed by their decimal representations for brevity ( see methods for details ) . here",
    ", a score of 0 indicates the best fit and a score of 1 the worst fit .",
    "triangles indicate lcs for which the boolean model yields a viable clock .",
    "lcs mirroring the activation and inhibition pattern of the corresponding de models in figs .",
    "[ fig : decircuitdiags]a and b are plotted in red . in a",
    ", one such lc mirrors the corresponding de model , @xmath152 , and this emerges as the optimal configuration yielding a viable clock . in b , only lcs yielding scores less than 0.75 are shown .",
    "there are two that mirror the equivalent de model .",
    "one of these , @xmath153 , is identified as the optimal configuration giving a viable clock ( leftmost red triangle ) . in this lc , either of the frq isoforms can independently inhibit transcription ( the corresponding two - input gate is of the and type ) .",
    "* figure 5 .",
    "the results of exploring the logic configurations belonging to the abstract topologies of the 2-loop ( * a * ) and 3-loop ( * b * ) _ arabidopsis _ models .",
    "* cost scores are shown for the optimal fit of each lc to synthetic data .",
    "as in fig .",
    "[ fig : neuroscores ] , each lc is indexed by its decimal expansion .",
    "scores of 0 and 1 indicate the best and worst fits respectively .",
    "triangles denote lcs for which the boolean model yields a viable clock .",
    "lcs mirroring the activation and inhibition pattern of the corresponding de models in figs .",
    "[ fig : decircuitdiags]c and d are plotted in red . in a , only lcs yielding scores less than 0.75 are shown .",
    "of these , there are 3 lcs consistent with the activation and inhibition pattern of the equivalent de model from a possible total of 4 . from this subset",
    ", @xmath154 emerges as the optimal configuration yielding a viable clock . for this circuit ,",
    "both lhy and toc1 can independently inhibit y while toc1 is repressed unless lhy is repressed while y is activated ( the corresponding gates are both of the and type ) . in b ,",
    "only the 8 lcs obtained by varying the gates of the prr - lhy loop were considered : all other gates were fixed to those of the optimal 2-loop configuration .",
    "of these 8 possible circuits , two lcs were consistent with the equivalent de model , from which @xmath155 is identified as the optimal configuration giving a viable clock .",
    "this lc corresponds to a clock network in which lhy is repressed unless prr is inactive and x is active ( the corresponding gate is of the and type ) .",
    "* figure 6 .",
    "time series for the differential equation and boolean versions of the clock models in 12:12 ld cycles .",
    "* two 24h cycles are plotted for each model . * a * , * b * : 1-loop _ neurospora _ ; * c * , * d * : 2-loop _ neurospora _ ; * e * , * f * : 2-loop _ arabidopsis _ ; * g * , * h * : 3-loop _ arabidopsis_. differential equation time series ( left panels ) have been normalised to lie between 0 and 1 in order to facilitate comparison with the boolean simulations ( right panels ) .",
    "different components within a model are slightly offset from one another so they can be distinguished more easily . the time step used for solving the boolean models was 0.5h , equal to the data sampling interval .",
    "* figure 7 . comparing the photoperiodic behaviour of the boolean and de versions of each model . * for boolean models ,",
    "the phase of each species is taken as the time within the ld cycle of the on to off transition ( downward triangles ) .",
    "analogously , the de model phases are defined as the times at which species decrease below the thresholds yielding the optimal fit of the corresponding boolean circuit to data ( upward triangles ) . shaded areas of plots , darkness ; open areas , light . *",
    "a*. 1-loop _ neurospora_. the phase - photoperiod profiles are coincident , indicating that the boolean model exactly reproduces the photoperiodic behaviour of its de counterpart : frq transcript and protein are both locked to dusk across the photoperiod range . *",
    "b*. 2-loop _ neurospora_. the phase plots are almost exactly equal , except for shorter photoperiods where they differ by the data sampling interval . as for a",
    ", all components are locked to dusk . *",
    "c*. 2-loop _ arabidopsis_. the boolean and de models exhibit very similar patterns of dawn- and dusk - locking across genes .",
    "the two y phase - photoperiod profiles reflect the double peak observed in this component ( fig .",
    "[ fig : ldts]e ) which gives rise to a ( dawn - locked ) light - induced peak and a ( dusk - locked ) circadian peak @xcite . * d*. 3-loop _ arabidopsis_. the phase plots are similar , with all components predominately dawn - locked . as for 2-loop _ arabidopsis _ , the two y profiles reflect the double peak observed for this gene ( fig .",
    "[ fig : ldts]g ) .",
    "* figure 8 . identifying the logic configurations of the 3-loop _ arabidopsis _ model giving the best fits to experimental data . *",
    "plotting conventions are as described in figs .",
    "[ fig : neuroscores ] and [ fig : arabscores ] . *",
    "a * shows the top ranking lcs .",
    "the black arrow indicates the optimal configuration yielding a viable clock , @xmath156 . for this circuit , lhy and toc1 repress each other , in agreement with recent biochemical evidence @xcite .",
    "the red arrow denotes the second highest ranking viable lc , @xmath157 .",
    "this lc matches the regulatory structure of the de model , and was previously identified as the configuration yielding the best fit to synthetic data ( see fig .",
    "[ fig : arabscores]b ) . * b * plots the top ranking lcs obtained under the constraint that lhy represses toc1 and toc1 activates lhy ( i.e. @xmath158 and @xmath159 ; see fig .",
    "[ fig : lcdiags]d ) . under this assumption",
    ", @xmath16 emerges as the optimal clock circuit .",
    "the circuit diagrams for @xmath17 and @xmath16 can be seen in supp .",
    "simulations generated by the optimal fits of the 3-loop _ arabidopsis _ model to experimental data . *",
    "* a*. experimental expression profiles for the genes cca1 , toc1 , gi and prr9 in free - running conditions ( ll ) .",
    "expression levels were determined using luc reporter gene imaging constructs and have been normalised to lie between 0 and 1 . * b*. the equivalent boolean time series generated by the logic configuration @xmath17 yielding the best fit to data . * c*. boolean expression profiles for the highest ranked configuration @xmath16 incorporating the central lhy - cca1 negative feedback loop of the de model . in all plots ,",
    "different components are slightly offset from one another so they can be distinguished more easily . the time step used for solving the logic model was 1.5h , equal to the data sampling interval .",
    "* optimal parameter sets - synthetic data . * [ cols=\"^,^,^,^,^ \" , ]     the logic configurations , @xmath75 , delays , @xmath160 , and discretisation thresholds , @xmath6 ( @xmath161 ) , yielding the top two fits of the 3-loop _ arabidopsis _ logic model to experimental luc time series recorded in ll .",
    "@xmath17 is the highest - scoring lc .",
    "@xmath16 is the second highest scoring lc , and is also the top ranked configuration under the constraint that lhy represses toc1 and",
    "toc1 promotes lhy production .",
    "note that @xmath16 was previously identified as the lc giving the optimal fit to synthetic data generated by the equivalent de model ( see table [ tab : optimparams ] ) ."
  ],
  "abstract_text": [
    "<S> the gene networks that comprise the circadian clock modulate biological function across a range of scales , from gene expression to performance and adaptive behaviour . </S>",
    "<S> the clock functions by generating endogenous rhythms that can be entrained to the external 24-hour day / night cycle , enabling organisms to optimally time biochemical processes relative to dawn and dusk . in recent years </S>",
    "<S> , computational models based on differential equations have become useful tools for dissecting and quantifying the complex regulatory relationships underlying the clock s oscillatory dynamics . </S>",
    "<S> however , optimising the large parameter sets characteristic of these models places intense demands on both computational and experimental resources , limiting the scope of _ in silico _ studies .    here , we develop an approach based on boolean logic that dramatically reduces the parametrisation , making the state and parameter spaces finite and tractable . </S>",
    "<S> we introduce efficient methods for fitting boolean models to molecular data , successfully demonstrating their application to synthetic time courses generated by a number of established clock models , as well as experimental expression levels measured using luciferase imaging . </S>",
    "<S> our results indicate that despite their relative simplicity , logic models can : ( i ) simulate circadian oscillations with the correct , experimentally - observed phase relationships amongst genes ; and ( ii ) flexibly entrain to light stimuli , reproducing the complex responses to variations in daylength generated by more detailed differential equation formulations . </S>",
    "<S> our work also demonstrates that logic models have sufficient predictive power to identify optimal regulatory structures from experimental data .    by presenting the first boolean models of circadian circuits together with general techniques for their optimisation , </S>",
    "<S> we hope to establish a new framework for the systematic modelling of more complex clocks , as well as other circuits with different qualitative dynamics . </S>",
    "<S> in particular , we anticipate that the ability of logic models to provide a computationally efficient representation of system behaviour could greatly facilitate the reverse - engineering of large - scale biochemical networks . </S>"
  ]
}