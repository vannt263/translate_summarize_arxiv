{
  "article_text": [
    "most problems in graph theory arise from considering some graph property  planarity , connectedness , being eulerian , or hamiltonicity  and attempting to classify which graphs have that property .",
    "almost all of these properties are motivated by real - world applications . to give a few examples , planar graphs are of interest in designing electrical circuits , and a hamiltonian cycle",
    " a closed path through the graph which visits every vertex exactly once  in computational biology represents the reconstruction of a dna strand from its constituent @xmath7-mers .",
    "we will be focusing on that last graph property , hamiltonicity . though it has widespread scientific uses , its theory is not well understood .",
    "there is no simple classification of hamiltonian graphs , and in fact the problem of finding a hamiltonian cycle is np - complete .    in certain cases , hamiltonicity is equivalent to a simpler property .",
    "for instance , a directed graph where every vertex has exactly 1 in - edge and exactly 1 out - edge ( i.e. a permutation graph ) is hamiltonian if and only if it is connected ( i.e. the graph is composed of one cycle rather than multiple ) . in this paper",
    "we study a class of graphs where checking hamiltonicity is equivalent to checking the connectedness of several permutation graphs ( following trotter and erds logic in @xcite ) , and discover that the number of these permutation graphs is polynomial .",
    "we consider rectangular grids of varying sizes which are folded into the shape of a two - holed torus , and draw directed edges up as well as right from each grid cell .",
    "the case of a one - holed torus has been studied earlier , and solved by trotter and erds , who found a simple condition to classify all grid sizes yielding hamiltonian graphs @xcite .",
    "non - orientable surfaces have been studied as well . in particular , for grids folded into the shape of a projective plane , it is known which sizes produce a hamiltonian graph after adding directed edges up and right from each cell ( see @xcite and @xcite ) .",
    "however , grids folded into tori with multiple holes have not been classified , motivating our research problem .",
    "we now outline the remainder of this paper .    in section  [ sec : prelim ] , we define the graphs with which we are working more precisely .",
    "every two - holed torus graph is described by two positive integers @xmath8 and @xmath9 .    in section  [ sec : diagonals ] , we define the _ diagonals _ of a two - holed torus graph  sets of vertices which can be reached from each other by moving diagonally through the graph  and use their properties to prove several general results about the existence of hamiltonian cycles .",
    "specifically , in section  [ subsec : diagonalbasics ] , we define diagonals , construct an @xmath10 algorithm for determining hamiltonicity , and show that the number - of - diagonals function commutes with scalar multiplication of the grid size vector . in section  [ subsec : links ] , we show that the problem of determining hamiltonicity is related to the problem of determining whether a link on a two - holed torus is connected , and construct an @xmath11 algorithm for determining hamiltonicity .",
    "finally , in section  [ subsec : periodicity ] , we show that under certain conditions the property of hamiltonicity is periodic .",
    "in section  [ sec : counting ] , we develop an @xmath2 algorithm to count the number of diagonals in a two - holed torus graph .",
    "specifically , in section  [ subsec : reductions ] we find a set of @xmath12 equivalences which allow us to reduce a large size graph to a smaller size graph with the same number of diagonals , and in section  [ subsec : ternary ] we find that these reductions have a simpler form on a ternary tree enumerating all coprime pairs @xmath13 .    in section  [ sec : speccases ] , we completely classify which two - holed torus graphs are hamiltonian in several special cases  when @xmath4 , when @xmath3 , and when the graph has one diagonal or the graph with parameters @xmath14 and @xmath15 has one diagonal .",
    "let @xmath16 be a directed graph , where @xmath17 is the set of vertices and @xmath18 is the set of directed edges in the graph .",
    "then @xmath19 is called _ hamiltonian _ if there is an ordering of the vertices , @xmath20 , such that @xmath21 for @xmath22 and @xmath23that is , there is an edge between consecutive vertices .",
    "see figure  [ fig : hamiltonian ] for examples .",
    "0.35 @xmath24          1 \\arrow{r } & 2 \\arrow{d } \\arrow[color = gray]{dl}\\\\          3 \\arrow{u } & 4 \\arrow{l }          \\end{tikzcd}\\ ] ]    0.35 @xmath24          1 \\arrow{r } & 2 \\arrow{dl}\\\\          3 \\arrow{u } & 4 \\arrow{l }          \\end{tikzcd}\\ ] ]    a useful operation for building more complex graphs from simpler graphs is the cartesian product , as defined by trotter and erds @xcite .",
    "one of the simplest classes of ( directed ) graphs is the set of directed cycles @xmath25 .",
    "trotter and erds considered the class of cartesian products of two directed cycles @xmath26 , and classified when these graphs are hamiltonian .",
    "there are two concise ways to visualize a product of directed cycles .",
    "one of them is in three dimensional space : the graph is a  ring of rings \" , the skeleton of a torus .",
    "the other is in the plane : the graph is an augmented , directed grid graph , with edges up and right and additional edges wrapping around the boundaries .    in subsequent research ,",
    "forbush et al .",
    "@xcite and mccarthy and witte @xcite have generalized the problem from the three - dimensional , topological perspective .",
    "note that the manner in which the edges of trotter and erds grid graph wrap around corresponds to the identification mapping from a rectangle to a torus  that is , an assignment of direction to each boundary of the rectangle and a pairing of the boundaries so that when pairs are glued ( identified ) together so that their directions align , the resulting closed surface can be deformed into a torus .",
    "there is a similar identification map from the rectangle to the projective plane , and reassigning the boundary edges to correspond to this identification map produces an augmented grid graph with the  shape \" of a projective plane .",
    "tori with higher genus , however , have not been studied .",
    "there is no natural identification map from the rectangle to a @xmath7-holed torus where @xmath27 .",
    "rather , there is a map from the polygon with @xmath28 sides to a @xmath7-holed torus ( see figure  [ fig : octagon ] ) @xcite . yet we wish to stick to rectangles . for surfaces more complex than the torus ,",
    "an augmented grid graph in the shape of the surface may not be as simple as a cartesian product of graphs , but in constructing the @xmath7-holed torus graph , we wish to preserve some of the simplicity of the  ring of rings \" rectangular grid graph : there are two unambiguous directions , up and right .",
    "0.35     0.35     to fold a rectangle into the shape of a @xmath7-holed torus , we divide each boundary of the rectangle into @xmath7 segments , so the rectangle is effectively a polygon with @xmath28 sides .",
    "the @xmath29 segment from the left of the upper boundary is identified with the @xmath29 segment from the right of the lower boundary ( the diametrically opposite segment ) ; and the @xmath29 segment from the top of the left boundary is identified with the @xmath29 segment from the bottom of the right boundary .",
    "see figure  [ fig : idmap ] for an example .",
    "we can now place an augmented grid graph on this rectangle .",
    "let us consider the following construction of a graph @xmath30 in our class , where @xmath31 and @xmath32 : fold a @xmath33 rectangular grid into the shape of a @xmath7-holed torus , so that the @xmath7 segments on each boundary have equal length . let the vertices of @xmath30 be the cells in the grid .",
    "there is a bijection @xmath34 from each cell to the cell above , and a bijection @xmath35 from each cell to the cell on the right .",
    "let the directed edges of @xmath30 be @xmath36 and @xmath37 for each cell @xmath38 .",
    "see figure  [ fig : graph ] for examples .     in different colors , scaledwidth=30.0% ]    with this notation , trotter and erds result",
    "can be rephrased as follows :    let @xmath39 .",
    ". then @xmath41 is hamiltonian if and only if there are positive integers @xmath42 and @xmath43 such that @xmath44 and @xmath45 .    for the remainder of this paper",
    ", we will focus our attention on the simplest unsolved case , where @xmath46 .",
    "we first show that a hamiltonian cycle in any of our graphs must be in some sense regular ; the grid can be partitioned into certain sets , which we call _ diagonals _ , and in the hamiltonian cycle the edges out of cells ( i.e. vertices ) in the same diagonal are in the same direction .    for any positive integers @xmath8 and @xmath9 ,",
    "diagonal _ in @xmath47 to be a set @xmath48 for any cell @xmath38 ( see figure  [ fig : diagonal ] ) .",
    "the same notion of a diagonal can be found in work on the projective checkerboard ( see @xcite and @xcite ) .",
    "note that different cells @xmath49 and @xmath50 may generate the same diagonal , if @xmath51 for some @xmath52 .",
    "lemmarightdown[lemma : rightdown ] let @xmath8 and @xmath9 be positive integers .",
    "suppose @xmath47 is hamiltonian , and pick any hamiltonian cycle . in any one diagonal , the out - edges of the cells in this diagonal which are used in the hamiltonian cycle point in the same direction .",
    "suppose the edges out of two cells @xmath38 and @xmath53 are in different directions .",
    "if the edge from @xmath38 points up and the edge from @xmath53 points right , then neither in - edge of @xmath54 is in the cycle  this is a contradiction . if the edge from @xmath38 points right and @xmath53 points up , then both in - edges of @xmath54 are in the cycle  again , contradiction",
    "hence , the edges out of @xmath38 and @xmath53 have the same direction . by induction , the edges out of all cells in same diagonal as @xmath38 point in the same direction .",
    "this lemma will serve as the foundation for a large portion of this paper .",
    "an immediate consequence is a nontrivial algorithm to determine if a graph @xmath47 is hamiltonian .",
    "the simplest algorithm merely iterates over all possible directions for all cells , and simulates to check if the result is a cycle .",
    "this yields a time complexity of @xmath55 .",
    "we may improve this algorithm by using lemma  [ lemma : rightdown ] and only iterating over all possible directions for all diagonals .",
    ", scaledwidth=25.0% ]    propmaxdiagnum in the graph @xmath47 , there are at most @xmath56 diagonals .",
    "for any cell @xmath38 , let @xmath57 and @xmath58 be the @xmath59-indexed coordinates of @xmath38 .",
    "then @xmath60 , and @xmath61 . but",
    "any diagonal in a torus has length @xmath62 .",
    "hence the length of the diagonal in the grid is at least @xmath62 as well .",
    "there are @xmath63 elements in the grid , so there are at most @xmath64 diagonals .",
    "therefore our second algorithm has complexity @xmath65 : since diagonals may be found in @xmath66 , iterating over directions for the diagonals dominates the time complexity .",
    "we describe a significantly more efficient algorithm after proving several more results and introducing a new perspective of hamiltonian cycles .",
    "our algorithm is slow only when @xmath8 and @xmath9 are not coprime  that is , @xmath67 . in this case",
    ", we see that many diagonals are congruent , which intuitively may cause redundancy in our algorithm .",
    "we call two diagonals @xmath68 and @xmath69 _ parallel _ if for some @xmath70 , @xmath38 is a cell in diagonal @xmath68 if and only if @xmath71 is in diagonal @xmath69 .",
    "propdiagmult let @xmath8 and @xmath9 be coprime positive integers , and let @xmath72 be the number of diagonals in @xmath47 .",
    "then for each @xmath73 , there are @xmath74 diagonals in @xmath75 .",
    "if two cells in @xmath75 have different column - row differences modulo @xmath76 , they must belong to different diagonals : cells on the same diagonal segment have the same difference , and since all dimensions of the grid are multiples of @xmath76 , two consecutive segments in one diagonal have the same differences modulo @xmath76 .",
    "for this reason , we can fix a remainder @xmath77 and find the number of diagonals in @xmath75 with column - row differences equivalent to @xmath78 modulo @xmath76 .",
    "consider the smaller graph where the @xmath79 vertices are all cells in @xmath75 with column - row difference equivalent to @xmath78 modulo @xmath76 , and the edges are from each cell @xmath38 to @xmath53 .",
    "since every cycle in this graph must contain at least one cell with row index equivalent to @xmath59 modulo @xmath76 , we may delete all other cells from the graph , merging the in - edge of a deleted cell with the out - edge , without changing the number of cycles .",
    "but now the remaining @xmath80 cells may be placed in bijection with the @xmath80 cells in @xmath47 , with the mapping @xmath81    essentially , each @xmath82 block of the graph @xmath75 is shrunk to a single cell in @xmath47 .",
    "so after applying the mapping to the edges in our constructed graph , we obtain exactly the edges from each cell @xmath83 to @xmath84 .",
    "thus the number of diagonals in @xmath75 with difference @xmath78 modulo @xmath76 is exactly @xmath72 , the number of diagonals in @xmath47 .",
    "summing over all possible values of @xmath78 , we see that in total there are @xmath74 diagonals in @xmath75 .    as a corollary of the proof of the above proposition",
    ", we obtain the following result :    cordiagmultcor let @xmath8 and @xmath9 be coprime positive integers , and let @xmath73 . then for each @xmath85 block of cells at the top left corner of any quadrant of @xmath75 , the @xmath76 cells belong , from left to right , to @xmath76 pairwise - parallel diagonals .",
    "consider any two diagonals @xmath68 and @xmath69 containing adjacent cells in the block .",
    "both diagonals correspond to the same diagonal @xmath86 in @xmath47 .",
    "consider any cell @xmath38 in @xmath68 .",
    "as @xmath38 and @xmath54 belong to the same @xmath82 block of @xmath75 , they correspond to the same cell in @xmath47 .",
    "but since @xmath38 is in @xmath68 , this cell is in @xmath86 , so @xmath54 is in @xmath69 .",
    "the reverse direction is similar .",
    "we call these @xmath76 parallel diagonals a _ group_. each block corresponds to one group , and if the diagonals in one group each have length @xmath87 for some positive integer @xmath7 , then the group corresponds to @xmath7 blocks .      at this point , we understand how the diagonals in a graph @xmath88 with non - coprime sizes relate to the diagonals in the graph @xmath47 with coprime sizes . to leverage this relation into a result about the hamiltonicity of the graph",
    ", we must convert the problem of determining the hamiltonicity of our graphs into multiple simpler problems about the connectedness of a two - holed torus link . in some sense the continuous analog of a permutation graph",
    ", a _ link _ is a set of smooth and non - self - intersecting loops , and we are concerned with determining whether certain links embedded on a two - holed torus are _",
    "knots_single , connected loops .",
    "some two - holed torus links can be described by a four - tuple @xmath89 . imagining the link to reside on a rectangular surface folded into the shape of the two - holed torus , the parameters count the number of times the link passes the left upper boundary , right upper boundary , upper right boundary , and lower right boundary , respectively ( in the future",
    ", we refer to these boundaries as @xmath90 , @xmath91 , @xmath92 , and @xmath93see figure  [ fig : idmap ] ) .",
    "thus there are @xmath94 points on the left upper boundary which can also be viewed as @xmath94 points on the right lower boundary , and so forth : due to the identification map of the two - holed torus , there is really only one set of @xmath94 points , not two , but we can think of them as distinct sets of @xmath94 points which are connected pairwise  under the grid . \"",
    "the points on the upper or right boundaries , in clockwise order , are also connected bijectively  over the grid \" to the points on the left or lower boundaries , in counterclockwise order .",
    "see figure  [ fig : link ] for an example .",
    "link , scaledwidth=25.0% ]    returning to our graphs @xmath47 , every way of orienting the diagonals produces a permutation graph ( which may or may not be hamiltonian ) and thus a link ( which may or may not be a knot ) .",
    "let @xmath8 and @xmath9 be coprime , and let @xmath47 be a graph with @xmath72 diagonals .",
    "pick any _ orientation string _ , which we call @xmath95 , consisting of @xmath72 characters , either @xmath96 or @xmath97 , each corresponding to the orientation of every cell in a different diagonal .",
    "then define the @xmath95-_link _ to be the link with parameters @xmath89 where @xmath94 and @xmath98 count the number of cells on boundaries @xmath90 and @xmath91 which are oriented up , and @xmath72 and @xmath99 count the number of cells on boundaries @xmath92 and @xmath93 which are oriented right ( see figure  [ fig : orientation ] ) .",
    "0.25 -link from @xmath100 , with @xmath101,title=\"fig:\",scaledwidth=100.0% ]    0.25 -link from @xmath100 , with @xmath101,title=\"fig:\",scaledwidth=100.0% ]    0.4 -link from @xmath100 , with @xmath101,title=\"fig:\",scaledwidth=100.0% ]    theoremhamlink let @xmath8 and @xmath9 be positive integers .",
    "pick any orientation string @xmath95 for @xmath47 .",
    "then @xmath95 constructs a hamiltonian cycle if and only if the @xmath95-link is a knot .",
    "suppose we construct a new graph @xmath102 with the same vertices as @xmath47 and only the edges which agree with the orientations of their cells ",
    "the up edges out of cells oriented up , and the right edges out of cells oriented right .",
    "then , as a consequence of the proof of lemma  [ lemma : rightdown ] , @xmath102 is a permutation graph .",
    "thus @xmath95 constructs a hamiltonian cycle if and only if @xmath102 is a single cycle rather than multiple .",
    "if @xmath89 is the @xmath95-link , then there are by definition @xmath94 edges in @xmath102 which cross boundary @xmath90 , and so forth .",
    "hence there are essentially @xmath103 points on the upper or right boundaries of the grid which are glued (  underneath \" the grid ) to @xmath103 points on the lower or left boundaries ; therefore to show that @xmath102 is homeomorphic to the @xmath95-link , we only need to show that the  over - grid \" connections in @xmath102 between pairs of points are the same as the  over - grid \" connections in the @xmath95-link between pairs of points .",
    "but for there to be an over - grid connection between two points in @xmath102 , the point on the upper or right boundary must be above and to the right of the point on the lower or left boundary .",
    "this completely determines the connections .",
    "the farthest counterclockwise point on the upper or right boundary must connect to the farthest clockwise point on the lower or left boundary , since otherwise any path from the latter point to a point on the upper or right boundary would intersect the path out of the former point .    by induction",
    ", all points in @xmath102 must connect exactly as the corresponding points connect in the @xmath95-link .",
    "hence @xmath95 constructs a hamiltonian cycle exactly when the @xmath95-link is a knot .",
    "we can now describe a pseudo - polynomial time algorithm for determining when a graph @xmath47 is hamiltonian .",
    "propswapparallel let @xmath8 and @xmath9 be positive integers .",
    "let @xmath95 be any orientation string for @xmath47 .",
    "let @xmath104 be the orientation string constructed from @xmath95 but with the orientations of two parallel diagonals swapped .",
    "then @xmath95 constructs a hamiltonian cycle if and only if @xmath104 constructs a hamiltonian cycle .",
    "let @xmath40 .",
    "since diagonals @xmath105 and @xmath106 are both similar ( under a scaling factor of @xmath76 ) to the same diagonal in @xmath107 , they contain the same number of cells on boundary @xmath90 , the same number of cells on boundary @xmath91 , and so forth . hence swapping their orientations",
    "does not change any of the parameters @xmath89 of the link constructed , so it does not affect the hamiltonicity of the constructed permutation graph .",
    "thus for each graph @xmath47 with @xmath108 , our algorithm does not need to check all @xmath109 ways of orienting a group of @xmath76 parallel diagonals .",
    "two ways are equivalent if the number of diagonals in the group which are oriented up is the same .",
    "hence , for each group only @xmath110 ways need to be checked  when @xmath78 of them are oriented up for @xmath111 .",
    "as there are at most @xmath112 groups , one per quadrant , only @xmath113 orientation strings must be checked .",
    "this leads to an overall running time for our third algorithm of @xmath114 .",
    "using several later results , it is possible to improve this further to @xmath115 : it turns out that there are at most @xmath116 groups , and that we can check if a link is a knot in linear time in the sum of parameters .      with the torus link equivalence",
    ", we can now show that for a fixed @xmath8 , as @xmath9 varies , the property of hamiltonicity of the graphs @xmath47 with @xmath8 and @xmath9 coprime is periodic .",
    "prophamlinkperiod let @xmath8 and @xmath9 be coprime positive integers . for the graph @xmath47 , pick any orientation string @xmath95 , and let the @xmath95-link be @xmath89 . then if there are @xmath117 cells oriented up for some integer @xmath7 , the graph @xmath118 has @xmath95-link @xmath119 .",
    "we can view @xmath118 as the result of adding @xmath120 columns to the right side of each quadrant in @xmath47 .",
    "consider any diagonal which enters the new columns at row @xmath78 .",
    "then the column - minus - row index of that diagonal segment is @xmath121 or @xmath122 .",
    "let us assume the index is @xmath121 , as the other case is almost identical .",
    "the subsequent diagonal segments are @xmath123 , @xmath124 , @xmath125 , @xmath126 , @xmath127 , and @xmath128 , so the last element still in the new columns is at row @xmath129 , and thus the first element in the original graph is at row @xmath78 , where it would have been without the extra @xmath130 columns .",
    "see figure  [ fig : periodicity ] for a diagram .",
    "columns to @xmath47 ( indexed by column - row difference within grey box),scaledwidth=100.0% ]    it follows that the subset of the diagonal contained in the original grid is equal to the complete diagonal in the graph @xmath47 .",
    "each passage of each up - oriented diagonal through the extra columns contributes @xmath116 to @xmath94 and @xmath98 , but does not affect @xmath72 or @xmath99 .",
    "but if there are @xmath117 cells oriented up in @xmath47 , if we reduce to the standard torus grid there are @xmath7 hamiltonian cycles , so we hit the left boundary @xmath131 times .",
    "lifting to @xmath47 , we enter the new columns @xmath131 times , so in total we add @xmath132 to @xmath94 and to @xmath98 .",
    "it remains to show that links are periodic with a certain periodicity .",
    "proplinkperiod let @xmath89 be a link .",
    "let @xmath133 , and assume that @xmath134 .",
    "then @xmath135 has the same number of loops as @xmath89 .",
    "the segments of the link @xmath89 which connect boundary points pairwise can be numbered from @xmath59 to @xmath136 .",
    "if we draw an edge from each segment to the subsequent segment in the link , we can describe the edges in intervals as follows :    * @xmath137 * @xmath138 * @xmath139 *",
    "@xmath140    this notation means that @xmath141 , and @xmath142 ( if @xmath143 ) , and so forth .",
    "we wish to show that this graph can be transformed into the corresponding graph for @xmath135 without changing the number of cycles .",
    "first , we delete the interval of vertices @xmath144 and the interval @xmath145 ; the edge into any deleted vertex points to the vertex after the deleted vertex .",
    "then we renumber ( shift ) the interval @xmath146 to @xmath147 .",
    "now we must show that starting with any vertex in the new graph , if we transform back to the old graph , apply the function , and transform to the new graph , we obtain the desired edge .",
    "suppose we start in the interval @xmath148 in the new graph .",
    "this is equal to @xmath148 in the old graph . applying the edges",
    ", it leads to @xmath149 in the old graph .",
    "this must be shifted , since @xmath150 , so in the new graph we have @xmath151 or equivalently @xmath152 as desired .",
    "suppose we start in the interval @xmath153 in the new graph .",
    "this must be unshifted to @xmath154 in the old graph . applying the edges",
    ", it leads to @xmath155 in the old graph .",
    "as @xmath156 , this interval is equivalent to @xmath155 in the new graph .",
    "suppose we start in the interval @xmath157 in the new graph .",
    "this must be unshifted to @xmath158 in the old graph .",
    "since @xmath159 , the interval is contained in @xmath160 . thus applying the edges we obtain @xmath161 in the old graph . as this interval has been removed , we apply the edges again to obtain @xmath162 .",
    "this interval has been removed as well , so we apply the edges once more to obtain @xmath163 in the old graph .",
    "we do not need to shift , so the interval is equivalent to @xmath163 in the new graph , as desired .",
    "finally , suppose we start in the interval @xmath164 in the new graph .",
    "this must be unshifted to @xmath165 , which is contained in @xmath160 . applying the edges , we obtain @xmath166 .",
    "these vertices have been removed , so we apply the edges to obtain @xmath167 .",
    "these vertices have also been removed , so we apply the edges again , to get the interval @xmath168 as required .    for links constructed by some graph and some orientation string",
    ", the periodicity @xmath169 does relate to the size of the graph .",
    "propcoolproof let @xmath8 and @xmath9 be coprime positive integers . for the graph @xmath47 , pick any orientation string @xmath95 , and let the @xmath95-link be @xmath89 . then if there are @xmath117 cells oriented up for some integer @xmath7 , we have @xmath170 .",
    "let @xmath171 and @xmath172 denote the number of cells on boundary @xmath90 oriented right and up respectively .",
    "define @xmath173 , @xmath174 , @xmath175 , @xmath176 , @xmath177 , and @xmath178 correspondingly for boundaries @xmath91 , @xmath92 , and @xmath93 .",
    "consider the cyclic sequences of cells ",
    "one sequence for each diagonal oriented up  ordered so that cell @xmath53 follows cell @xmath38 .",
    "the sum over all sequences of the signed differences of column indices of pairs of cells adjacent in a sequence is @xmath59 .",
    "each of the @xmath117 cells contributes @xmath179 .",
    "additionally , every time a boundary is crossed between adjacent cells , there is an additional displacement of some multiple of @xmath9 . adding all contributions",
    ", we obtain the equation @xmath180 thus @xmath181 or equivalently @xmath182    we now simply combine the above propositions .",
    "theoremhamperiod let @xmath8 and @xmath9 be coprime positive integers",
    ". then @xmath47 is hamiltonian if and only if @xmath118 is hamiltonian .",
    "pick any orientation string @xmath95 .",
    "let @xmath7 be the integer such that @xmath117 cells are oriented up , and let the induced @xmath95-link be @xmath89 . as @xmath183 is at most the number of cells on the right boundary of their quadrants which are oriented right , we have @xmath184 .",
    "thus we know that @xmath89 has the same structure as @xmath185 for any positive integer @xmath186 .",
    "but for @xmath187 we have @xmath188 , so in fact @xmath89 has the same structure as @xmath119 .",
    "the latter link is the @xmath95-link of @xmath118 , so @xmath95 produces a hamiltonian cycle in @xmath47 if and only if it produces a hamiltonian cycle in @xmath118 .    through a proof almost identical to that described in this section",
    ", it is also possible to show that for any fixed @xmath76 and fixed @xmath8 , the graphs @xmath47 with @xmath189 are periodic in hamiltonicity .",
    "theoremgenhamperiod let @xmath8 and @xmath9 be positive integers , and let @xmath40 .",
    "then @xmath47 is hamiltonian if and only if @xmath190 is hamiltonian .",
    "this proof is similar to the proof for @xmath191 .",
    "in this section we attempt to classify our graphs by the number of diagonals .",
    "we find two sets of reductions from larger to smaller graphs that preserve the number of diagonals , and use these to develop a polynomial time algorithm to find the number of diagonals .      in our first set of reductions , we find for each graph a _ boundary - crossing string _ which corresponds to a permutation , and",
    "use properties of permutations to reduce longer strings ( associated with larger graphs ) to smaller strings .",
    "let @xmath39 .",
    "define @xmath192 to be the number of diagonals in @xmath47 .    to find patterns in the number of diagonals in @xmath47 , we first consider how the diagonal crosses boundaries on the standard torus grid of size @xmath193 , and lift results there back to @xmath47 .",
    "since @xmath194 for any @xmath8 , @xmath9 , and @xmath72 , we solely consider the case when @xmath8 and @xmath9 are coprime .",
    "let @xmath31 with @xmath195 .",
    "consider the diagonal on the @xmath193 ( standard ) torus grid , starting at the top - left corner .",
    "let @xmath196 be the string of characters indicating each time when the diagonal passes through a boundary of the grid@xmath197 for the lower boundary and @xmath198 for the right boundary .",
    "furthermore , define the _ boundary - crossing string _ for @xmath47 to be @xmath199 .",
    "this adjustment will simplify later proofs .    when @xmath8 and @xmath9 are coprime , every diagonal in @xmath47 contains the top - left corner of at least one quadrant of the base grid .",
    "hence , if we consider each diagonal to start at one such corner , @xmath196 describes how the diagonal crosses quadrants .",
    "viewing @xmath197 and @xmath198 as permutations of the four quadrants , we have that @xmath192 , where @xmath31 and @xmath195 , is equal to the number of cycles in the permutation @xmath196 ( or equivalently , in the permutation @xmath200)for instance , if the permutation has one cycle , then the diagonal starting at the top - left corner of one quadrant will visit all four corners before returning to the starting point , so there will be only one diagonal , of length @xmath63 .",
    "we use the notation @xmath201 to denote the number of cycles in permutation @xmath202 , and say that @xmath203 if permutations @xmath202 and @xmath204 are equal up to renaming of elements .",
    "now we describe two procedures for generating @xmath196 or @xmath200 .",
    "lemmaintervals[lemma : intervals ] let @xmath31 with @xmath195 .",
    "the string @xmath196 can be constructed by the following procedure : traverse the sequence @xmath205 . for each element @xmath206 , add @xmath207 , where @xmath208 , to the end of the string .",
    "suppose the @xmath193 torus grid cells are numbered from @xmath59 to @xmath209 by the order of traversal on the diagonal .",
    "then at cell @xmath78 , the bottom boundary has been crossed @xmath210 times , and the right boundary has been crossed @xmath211 times .",
    "the bottom boundary is crossed immediately before the locations @xmath206 for @xmath212 .",
    "thus we add @xmath197 to the string at these locations . between @xmath213 and @xmath206 , the right boundary",
    "is crossed @xmath214 times , so we add this many powers of @xmath198 .",
    "lemmapowers[lemma : powers ] let @xmath31 with @xmath195 .",
    "suppose @xmath215 where @xmath216 .",
    "the string @xmath200 can be constructed by the following procedure : traverse the generating sequence @xmath217 .",
    "for each element @xmath218 , if @xmath219 , add @xmath220 to the end of the string . otherwise add @xmath221 to the end of the string .",
    "let @xmath78 be an integer with @xmath222 .",
    "then the right boundary is crossed immediately before cell @xmath223 . in the range @xmath224 ,",
    "the bottom boundary is crossed @xmath225 times if @xmath226 for some integer @xmath227 and @xmath7 times otherwise .",
    "this condition is equivalent to @xmath228 note that cell @xmath59 is treated correctly ; we wish to account for the down - crossing at cell @xmath59 at the beginning of @xmath200 but not the end , and since for @xmath229 we include @xmath59 in the range , and for @xmath230 we do not include @xmath231 , this is satisfied .",
    "now we prove a useful lemma for manipulating permutation sequences .",
    "lemmaswap  [ lemma : swap ] let @xmath202 and @xmath204 be permutations of an arbitrary set , and let @xmath232 .",
    "then @xmath233    there are two cases .",
    "first suppose @xmath234 .",
    "then for any integer @xmath78 we have @xmath235 , so @xmath236 .",
    "suppose @xmath237 where @xmath238 .",
    "then for some @xmath227 with @xmath239 , we have @xmath240 . for each @xmath227 with @xmath239 , there is exactly one index @xmath241 satisfying that inequality .",
    "hence , @xmath202 occurs only at terms @xmath242 , so we have @xmath243    for the second case , suppose @xmath244 , and suppose @xmath245 where @xmath238 .",
    "then for some @xmath227 with @xmath246 , we have @xmath247 . but for each @xmath227 with @xmath246 , there is exactly one index @xmath248 satisfying that inequality .",
    "hence , @xmath204 occurs only at terms @xmath249 , so we have @xmath250    using lemma  [ lemma : swap ] , we can convert our expression for @xmath200 into a product of terms with the ceiling function in the exponent .",
    "corpceil  [ cor : ceil ] let @xmath31 with @xmath195 .",
    "then @xmath251    applying lemma  [ lemma : swap ] to the formula in lemma  [ lemma : intervals ] , we have @xmath252    with the aid of the above lemmas , we describe and prove several symmetries in the number of diagonals on different graphs , using the properties of the permutations @xmath197 and @xmath198 .",
    "propmodfour[prop : modfour ] let @xmath31 with @xmath195 .",
    "then the number of diagonals in @xmath47 is equal to the number of diagonals in @xmath253 .",
    "applying corollary  [ cor : ceil ] and using the equation @xmath254 , we have @xmath255    propreversemod[prop : reversemod ] let @xmath31 with @xmath195 and @xmath256 .",
    "then the number of diagonals in @xmath47 is equal to the number of diagonals in @xmath257 .",
    "first we show that to obtain @xmath258 from @xmath200 we reverse the string , replace each substring @xmath259 with @xmath260 , and move one power of @xmath198 from the beginning of the string to the end .",
    "after that , we show that this procedure preserves the number of cycles .",
    "once again , we use the construction of lemma  [ lemma : powers ] .",
    "let @xmath215 where @xmath216 , which means that @xmath261 .",
    "let @xmath78 be an index into the @xmath262 generating sequence with @xmath222 .",
    "suppose the substring of @xmath200 contributed by term @xmath78 is @xmath220 .",
    "then @xmath263 hence , we have @xmath264 or equivalently @xmath265 thus the term @xmath266 in the @xmath267 generating sequence contributes @xmath268 to @xmath258 .",
    "conversely , suppose term @xmath78 in the @xmath262 generating sequence contributes @xmath269 to @xmath200 .",
    "then @xmath270 so @xmath271 or equivalently , @xmath272 thus the term @xmath266 in the @xmath267 generating sequence contributes @xmath273 to @xmath258 .",
    "it follows that after the reversal of @xmath200 and replacement of each @xmath259 by @xmath260 , the powers of @xmath197 are the same as in @xmath258 , but we must change every occurrence of @xmath274 to @xmath275 .",
    "this is accomplished by moving the first @xmath198 to the end of the string .",
    "this proves the first piece of the argument . for the second piece , note that a permutation @xmath202 has the same number of cycles as @xmath276 and @xmath277 for any permutation @xmath204 .",
    "furthermore , note that @xmath278 whereas @xmath279 .",
    "then @xmath280 since the inversion reverses the string and inverts every @xmath197 and every @xmath198 , and the inner two conjugations invert every @xmath198 again , and the outer conjugation moves an @xmath198 from the beginning of the string to the end .",
    "so with this equality , we can produce @xmath258 from @xmath200 by applying conjugates and taking inverses , so the number of cycles in @xmath200 is equal to the number of cycles in @xmath200 .",
    "now we show that all graphs @xmath47 can be reduced to a few base case graphs while preserving the number of diagonals .",
    "we fix @xmath8 and @xmath9 as coprime positive integers , and let @xmath281 , @xmath282 , @xmath283 , @xmath284 , @xmath285 , and @xmath286 be defined so that @xmath287 and @xmath288 and @xmath289 with @xmath290 , and @xmath291 if @xmath292 .    as several of the proofs start with the same algebraic manipulations , we collect those steps into the following lemma .",
    "lemmatwoswap[lemma : twoswap ] let @xmath39 .",
    "then @xmath293    applying lemma  [ lemma : swap ] to the formula in corollary  [ cor : ceil ] , we obtain @xmath294 as desired .",
    "the following proposition is a compilation of all the reductions .",
    "propreductions we have :    * if @xmath295 , then @xmath296 . * if @xmath297 , then @xmath298 . * if @xmath299 , then @xmath300 . *",
    "if @xmath301 and @xmath302 , then @xmath303 . * if @xmath304 , @xmath305 and @xmath306 , then @xmath307 .",
    "* if @xmath304 , @xmath308 and @xmath306 , then @xmath309 .",
    "* if @xmath304 , @xmath310 , @xmath283 is even , and @xmath311 , then @xmath312 . * if @xmath304 , @xmath310",
    ", @xmath283 is even , and @xmath313 , then @xmath314 . * if @xmath304 , @xmath310",
    ", @xmath283 is odd , and @xmath311 , then @xmath315 .",
    "* if @xmath304 , @xmath310 , @xmath283 is odd , and @xmath313 , then @xmath316 .",
    "the first three reductions follow immediately from proposition  [ prop : modfour ] and proposition  [ prop : reversemod ] .",
    "suppose @xmath301 and @xmath302 .",
    "starting with the formula from lemma  [ lemma : twoswap ] , we have @xmath317    suppose @xmath304 and @xmath305 and @xmath306 .",
    "we have @xmath318    suppose @xmath304 , @xmath308 , and @xmath306",
    ". then we have @xmath319    suppose @xmath304 and @xmath310 , and @xmath283 is even , and @xmath311 .",
    "we have @xmath320    suppose @xmath304 and @xmath310 , and @xmath283 is even , and @xmath313 .",
    "note that if @xmath321 we must have @xmath322 .",
    "then we have @xmath323    suppose @xmath304 and @xmath310 , and @xmath283 is odd , and @xmath311 .",
    "we have @xmath324    suppose @xmath304 and @xmath310 , and @xmath283 is odd , and @xmath313 . note that if @xmath321 we must have @xmath322",
    ". then we have @xmath325    these reductions allow us to determine exactly when a graph has 2 diagonals .",
    "theoremtwodiag let @xmath31 with @xmath195 .",
    "then @xmath326 if and only if @xmath231 is odd .",
    "as the reductions can be applied to any graph @xmath47 with @xmath327 and @xmath328 or @xmath306 or @xmath329 , the base case ordered pairs are a subset of @xmath330 .",
    "but if @xmath331 then @xmath332 can be reduced to @xmath333 .",
    "hence the base cases are @xmath334 , @xmath335 , @xmath336 , @xmath337 , @xmath338 , and @xmath339 .    every reduction @xmath340 preserves @xmath341 , so some pair @xmath262 has both sizes odd if and only if the base case to which the pair can be reduced also has both sizes odd .",
    "the only two base cases with both sizes odd are @xmath334 and @xmath336 , and it can be checked that these are exactly the base cases with @xmath342 diagonals .",
    "our second set of reductions are movements in a tree of coprime pairs ; we prove these reductions using the first set .    for any coprime pair @xmath13 with @xmath343 ,",
    "let :    * @xmath344 , * @xmath345 , and * @xmath346 .",
    "these three functions generate a ternary tree rooted at the pair @xmath347 : each pair @xmath13 in the tree has children @xmath348 , @xmath349 , and @xmath350 .",
    "it is a well - known fact that every coprime pair @xmath13 with @xmath343 and @xmath351 odd appears exactly once in this tree .",
    "we refer to such pairs as _ even - odd _ pairs .",
    "let the _ tree string _ @xmath352 of an even - odd pair @xmath13 be the unique string consisting of characters @xmath353 , @xmath354 , and @xmath355 , such that @xmath356 .",
    "we can compute the tree string of any even - odd pair recursively .",
    "proptreestring[prop : treestring ] let @xmath13 be an even - odd pair .",
    "if @xmath357 then @xmath358 , or the empty string .",
    "otherwise there are three cases :    if @xmath359 , then @xmath360 .    if @xmath361 , then @xmath362 .    if @xmath363 , then @xmath364 .",
    "this follows trivially from the fact that every even - odd pair occurs exactly once in the tree , by considering the domains of the inverse operations @xmath365 , @xmath366 , and @xmath367 .",
    "now we wish to classify tree strings by the number of diagonals in associated graphs .",
    "we say that @xmath368 if @xmath369 .",
    "every tree string @xmath186 can be simplified , using the following reductions , to some canonical tree string @xmath370 such that @xmath371 .",
    "propcanon[prop : canon ] let @xmath13 be an even - odd pair",
    ". then we have :    1 .",
    "2 .   @xmath373 for any @xmath374 .",
    "3 .   @xmath375 .",
    "4 .   @xmath376 .",
    "5 .   @xmath377 for any @xmath374 .",
    "we use the previously proved reductions to prove these ones .",
    "suppose @xmath287 where @xmath378 .    1 .",
    "@xmath379 2 .",
    "@xmath380 + @xmath381 + @xmath382 3 .",
    "@xmath383 4 .",
    "if @xmath281 is even , @xmath384 and @xmath385 . if @xmath304 , @xmath386 . and if @xmath328 is odd , @xmath387",
    "5 .   if @xmath301 , then @xmath388",
    "otherwise , @xmath389 .",
    "+ applying reduction 1 , @xmath390 .",
    "+ and finally , @xmath391 .",
    "it can be seen that the canonical tree strings  the strings which can not be reduced further ",
    "are @xmath353 , @xmath392 , @xmath355 , and the empty string @xmath393 .",
    "the canonical tree string of a graph can be determined by feeding the tree string into an automaton ( figure  [ fig : automaton ] ) .",
    "combining several earlier results with these observations yields the following simple and efficient algorithm to find the number of diagonals in an arbitrary graph @xmath47 :    1 .",
    "let @xmath108 .",
    "2 .   divide @xmath76 out of @xmath9 and @xmath8 .",
    "3 .   if @xmath9 and @xmath8 are both odd , return @xmath394 .",
    "4 .   apply proposition  [ prop : treestring ] to find the tree - string @xmath352 .",
    "5 .   apply proposition  [ prop : canon ] to reduce @xmath352 to a canonical tree string @xmath370 .",
    "return @xmath395 .",
    "note that this algorithm has time complexity @xmath2 .",
    "proponediagnotham let @xmath396 .",
    "if @xmath47 has one diagonal then it is not hamiltonian .    by lemma  [ lemma : rightdown ]",
    ", the hamiltonian cycle edges out of all cells in @xmath47 must point in the same direction .",
    "if the edges point up , then the cycle visits exactly two columns , so @xmath397 .",
    "similarly , if the edges point right , then @xmath398 . in both cases we achieve a contradiction , so @xmath47 is not hamiltonian .    the converse , however , is not true .",
    "see [ app : compute ] for examples",
    ".    having one diagonal not only correlates negatively with the existence of a hamiltonian cycle , as in the above proposition , but also correlates positively , as in the proposition below .",
    "proponediagham let @xmath8 and @xmath9 be positive integers . if @xmath47 has one diagonal , then @xmath399 is hamiltonian .",
    "there are two diagonals in @xmath399 .",
    "let the one be oriented up and the other be oriented right . as they are both similar to the single diagonal in @xmath47 , they must both touch the right and left upper boundaries @xmath9 times each , and the upper and lower right boundaries @xmath8 times each . hence the parameters of the associated link are @xmath400 .",
    "but the permutation graph of the diagonal edges of any graph can also be associated with a link ; diagonals are right and down , but this is inconsequential . for @xmath47 ,",
    "the parameters are @xmath400 since the diagonal touches the right lower edge @xmath9 times , and so forth .",
    "but since the permutation graph of the diagonals of @xmath47 consists of one cycle , the @xmath400 graph is a knot .    for graphs @xmath401 ,",
    "there is a relatively simple construction of a hamiltonian cycle .",
    "propsquareham let @xmath402 .",
    "then the @xmath403 grid contains a hamiltonian cycle .",
    "we construct a hamiltonian cycle as follows .",
    "let the starting cell be at row @xmath8 and column @xmath59 . then apply @xmath35 for @xmath404 steps , and @xmath34 once .",
    "repeat @xmath8 times .",
    "it can be shown that every vertex is visited exactly once before returning to the starting cell .    for values of @xmath8 where every graph @xmath47 with multiple diagonals has a hamiltonian cycle",
    ", there is a method of classifying which graphs are hamiltonian by producing constructions for the hamiltonian graphs and showing that the remaining graphs each have one diagonal .",
    "we describe the case when @xmath4 .",
    "propntwoham let @xmath405 with @xmath406 .",
    "then the @xmath407 grid contains a hamiltonian cycle .",
    "we use the coordinate system in this proof where the right quadrants are placed below the left quadrants , producing a @xmath408 grid .    if @xmath409 , we set the direction of a cell @xmath410 to be @xmath35 iff @xmath411 .",
    "if @xmath412 , we set the direction of a cell @xmath410 to be @xmath35 iff @xmath413 .",
    "if @xmath414 , we set the direction of a cell to be @xmath35 iff @xmath415 .",
    "if @xmath416 , we set the direction of a cell to be @xmath35 iff @xmath417 .",
    "if @xmath418 , we set the direction of a cell to be @xmath35 iff @xmath419 .",
    "if @xmath420 , we set the direction of a cell to be @xmath35 iff @xmath421 .",
    "for the second piece of the argument , it would suffice , by proposition  [ prop : modfour ] , to check base cases only , but we describe a different , self - contained argument , as the method used is interesting .",
    "propntwonotham let @xmath405 with @xmath422 .",
    "then the @xmath407 grid contains only one diagonal , and thus has no hamiltonian cycle .",
    "we use the standard coordinate system in this proof .    for each @xmath99 with @xmath423 ,",
    "define the _ diagonal segment _",
    "@xmath424 by @xmath425    note that each diagonal is composed of several diagonal segments .",
    "let @xmath426 be the bijection on diagonal segment indices such that @xmath427 is the segment immediately following @xmath424 within the same diagonal .",
    "then    @xmath428    we wish to show that for any index @xmath99 , there is some @xmath52 such that @xmath429 .",
    "if every application of @xmath426 added @xmath430 , this would be simple .",
    "thus , we must consider the abnormal values of @xmath99 : viz .",
    "@xmath431 , @xmath432 , @xmath433 , or @xmath434 .",
    "we note that @xmath435 , and @xmath436 , and @xmath437 , and @xmath438 .",
    "* case 1 : * @xmath439",
    ".    then :    * @xmath440 leads to @xmath441 . *",
    "@xmath442 leads to @xmath439 . *",
    "@xmath443 leads to @xmath444 .",
    "* @xmath445 leads to @xmath446 .     &",
    "16k+2 & 16k+3 & 16k+4 & 16k+5 & 0 + 8k+3 & 16k+5 & 2k & 4k+1 & 6k+2 & 8k+3 + 8k+4 & 14k+4 & 16k+5 & 2k & 4k+1 & 6k+2 + 8k+5 & 12k+3 & 14k+4 & 16k+5 & 2k & 4k+1 + 8k+6 & 10k+2 & 12k+3 & 14k+4 & 16k+5 & 2k +    for each of these values which follow from abnormal values , we can determine how many additions of @xmath430 would yield either @xmath59 or another abnormal value ( see table [ tab:3mod8 ] ) .",
    "the value with the smallest distance will be reached first .",
    "hence , it can be seen that each abnormal value will reach @xmath59 after several applications of @xmath426 , possibly passing through other abnormal values along the way .",
    "now we may consider an arbitrary @xmath99 .",
    "suppose it never reaches an abnormal value .",
    "then every application of @xmath426 adds @xmath430 . but",
    "@xmath447    thus every value between @xmath59 and @xmath431 is reached .",
    "this is a contradiction , so an abnormal value is eventually reached , and therefore @xmath59 is eventually reached .",
    "thus every diagonal segment is in the same diagonal as @xmath448 .",
    "* case 2 : * @xmath449 .",
    "this case can be proved in an almost identical format .",
    "the main direction for future research we see is trying to completely classify which graphs @xmath47 are hamiltonian , or at least find a polynomial - time algorithm , as an improvement upon our pseudo - polynomial time algorithm .",
    "there are several other generalizations which we think may be worth trying : trying to extend our results to tori with more than @xmath342 holes , or relaxing the restriction that the boundaries are cut into equal segments .",
    "more specific problems with which we have been grappling are proving a smaller periodicity even when @xmath8 and @xmath9 are not coprime , and trying to classify the relatively sparse subset of ordered pairs @xmath262 where @xmath47 has multiple diagonals but is not hamiltonian .",
    "i would like to thank chiheon kim for his invaluable advice .",
    "i would also like to thank tanya khovanova for her suggestions and review , as well as ankur moitra , david jerison and slava gerovitch for their guidance on this project .",
    "additionally , i would like to thank jenny sendova for her comments on this paper , and suggestions for visualizing a two - holed torus .",
    "finally i would like to thank the center for excellence in education , the research science institute , and mit for their support .    1    w.  t.  trotter and p.  erds . when the cartesian product of directed cycles is hamiltonian .",
    ", 2:137142 , 1978 .",
    "m.  h.  forbush et  al .",
    "hamiltonian paths in projective checkerboards . , 56:147160 , 2000 .",
    "d.  mccarthy and d.  w. morris .",
    "hamiltonian paths in @xmath0 projective checkerboards . , 2016 .",
    "j.  gallier and d.  xu . .",
    "philadelphia pa , 2012 .",
    "@xmath450 & @xmath451 & @xmath452 & @xmath453 + @xmath454 & & & + @xmath455 & @xmath456 & @xmath457 & @xmath458 + @xmath459 & @xmath460 & @xmath461 & @xmath462 + @xmath463 & @xmath464 & & + @xmath465 & & & + @xmath466 & & & + @xmath467 & @xmath468 & @xmath469 & + @xmath470 & & & + @xmath471 & & & + @xmath472 & @xmath473 & & + @xmath474 & & & + @xmath475 & @xmath476 & & + @xmath477 & & & + @xmath478 & & & +    as a side note , based on significant computational evidence ( we tested values of @xmath479 from @xmath480 to @xmath481 and the error approaches zero as @xmath479 increases ) , we hazard a conjecture about the frequency of graphs with 1 , 2 , or 3 diagonals ."
  ],
  "abstract_text": [
    "<S> trotter and erds found conditions for when a directed @xmath0 grid graph on a torus is hamiltonian . </S>",
    "<S> we consider the analogous graphs on a two - holed torus , and study their hamiltonicity . </S>",
    "<S> we find an @xmath1 algorithm to determine the hamiltonicity of one of these graphs and an @xmath2 algorithm to find the number of diagonals , which are sets of vertices that force the directions of edges in any hamiltonian cycle . </S>",
    "<S> we also show that there is a periodicity pattern in the graphs hamiltonicities if one of the sides of the grid is fixed ; and we completely classify which graphs are hamiltonian in the cases where @xmath3 , @xmath4 , the @xmath0 graph has @xmath5 diagonal , or the @xmath6 graph has @xmath5 diagonal . </S>"
  ]
}