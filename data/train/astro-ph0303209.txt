{
  "article_text": [
    "this is the second in a series of papers using a new code ( cosmos ) that we have developed for a broad range of astrophysical problems , including scalar- and radiation - field dominated processes in the early universe , cosmological structure formation , black - hole accretion , neutron - star binaries , astrophysical jets , and multiphase galactic dynamics .",
    "such an ambitious range of topics requires that the code be able to accurately model a wide variety of physical processes , in both the relativistic and newtonian regimes .",
    "our first contributions therefore present the results of tests designed to examine the abilities of cosmos to compute physical processes relevant for astrophysical problems .",
    "cosmos is a collection of massively parallel , multi - dimensional , multi - physics solvers utilizing the mpi paradigm for parallel computing of both newtonian and general relativistic astrophysical problems .",
    "it currently includes several different options for computational fluid dynamics ( cfd ) methods , equilibrium and non - equilibrium primordial chemistry with 27 atomic and molecular reactions , various radiative cooling processes , nonequilibrium radiation flux - limited diffusion , radiation pressure , relativistic scalar fields , newtonian external and self - gravity , arbitrary spacetime curvature in the form of a generic background metric , and viscous stress in a fully covariant formulation . in general",
    ", cosmos assumes no particular symmetry in the equations , and is therefore designed to run on structured cartesian meshes .",
    "however , due to the covariant formulation adopted for the hydrodynamics equations , cosmos can also be run on various grid geometries ( e.g. , cartesian , cylindrical , spherical ) for problems using the relativistic fluid dynamics solvers .",
    "numerical methods used to solve the hydrodynamics equations include a total variation diminishing ( tvd ) godunov solver for newtonian flows using roe s @xcite approximate riemann solver and a third order runge - kutta time - marching scheme @xcite .",
    "for either newtonian or general relativistic systems , two artificial viscosity @xcite algorithms are available : a non - staggered grid method in which all variables are located at the zone - center , and a staggered grid and field centering method similar to the zeus code @xcite in which scalar ( vector ) quantities are located at the zone ( face ) centers .",
    "two additional options for cfd methods are included for both newtonian and relativistic problems that are based on non - oscillatory central difference schemes @xcite , also differentiated by grid centering : staggered versus centered in time as well as space .",
    "the relativistic hydrodynamics algorithms have been presented in @xcite along with several tests of the code , including relativistic shock tube , wall shock , and dust accretion problems . here",
    "we emphasize the newtonian and multi - physics descriptions and code tests of primordial chemistry , radiative cooling , and radiation diffusion coupled together with hydrodynamics .",
    "we proceed in  [ sec : equations ] by describing the basic equations used by cosmos , and in  [ sec : tests ] by presenting tests of the code .",
    "the tests are designed to examine the ability of the code to follow shocks , blast waves and dynamical instabilities , to advect materials , to resolve heating and cooling flows , to transfer radiation , to simulate chemical networks , and to calculate self - gravitating gas distributions .",
    "the newtonian multi - species mass , momentum and energy ( hydrodynamic and radiation diffusion ) continuity equations are written in an eulerian frame as @xmath0}}{\\partial t } + \\nabla_i(\\rho^{[m ] } v^i )          & = & { \\sum_{i=1}^{n_{s}}}{\\sum_{j=1}^{n_{s } } }                               { { k_{ij}(t)}{\\rho^{[i]}}{\\rho^{[j ] } } }              + \\sum_{i=1}^{n_{s } } { { i_i(\\nu)}{\\rho^{[i ] } } } ,          \\label{eqn : dens_m } \\\\   \\frac{\\partial ( \\rho v^k)}{\\partial t } + \\nabla_i(\\rho v^k v^i )          & = & -\\nabla_k ( p + p_r ) - \\rho \\nabla_k \\phi ,           \\label{eqn : mom } \\\\   \\frac{\\partial e}{\\partial t } + \\nabla_i(e v^i )          & = & -p \\nabla_i v^i              + c\\rho ( \\sigma_a e - \\sigma_p a_r t^{4 } )               + \\lambda(t,\\rho^{[m ] } ) ,          \\label{eqn : en } \\\\   \\frac{\\partial e}{\\partial t } + \\nabla_i(e v^i )          & = & \\nabla_i\\left(\\frac{c}{3\\rho\\sigma_r}\\nabla^i e\\right )              - \\frac{e}{3 } \\nabla_i v^i              - c \\rho\\sigma_a e + c \\rho\\sigma_p a_r t^4 ,         \\label{eqn : enrad}\\end{aligned}\\ ] ] where @xmath1 is the fluid velocity assumed to be the same for each of the chemical species , @xmath2 is the fluid energy density , @xmath3}$ ] are the species densities satisfying @xmath4}$ ] for the total density , @xmath5 is the gravitational potential obtained from poisson s equation @xmath6 , @xmath7 is the fluid pressure , @xmath8 is the radiation pressure , @xmath9 is the radiation constant , @xmath10 is stephan - boltzmann s constant , @xmath11 is the speed of light , @xmath12 is the radiation energy , @xmath13 , @xmath14 , and @xmath15 are the rosseland , absorption and planck mean opacities , @xmath16 are the rate coefficients for the 2-body reactions which are functions of fluid temperature @xmath17 , and @xmath18 are frequency - integrated photoionization and dissociation rates .",
    "the summations in ( [ eqn : dens_m ] ) are over the @xmath19 atomic and molecular species included in the chemistry model , up to nine : , , , , , @xmath20 , h@xmath21 , h@xmath22 , h@xmath23 .",
    "a total of 27 chemical reactions are included in the full network , which we summarize in table [ tab : chemistry ] for convenience , but refer the reader to @xcite and @xcite for more complete descriptions of the reactions , rate coefficients , and numerical methods .",
    "assuming that reasonable models are provided for the mean opacities of the fluid , radiation energy is coupled to the net fluid momentum and internal energy , accounting for non - equilibrium heating and cooling effects in the single temperature and gray ( spectral average ) approximations .",
    "however , we have not currently coupled radiation in a self - consistent fashion to the chemistry solver and ionization states of the fluid composition .",
    "this is a much more difficult task due to grid resolution requirements , computational time constraints , multi - species interactions , multi - group transport , and non - lte effects expected to be important in some of our applications .",
    "we will address these problems in future developments of cosmos .",
    "three radiative cooling and heating models are implemented in the optically thin limit for @xmath24})$ ] in ( [ eqn : en ] ) , depending upon whether the chemistry is known .",
    "first , if chemistry is not solved , the cooling function is set proportional to the square of the total number density with an empirical model for the ionization fraction that approximates linearly the equilibrium result ( [ eqn : fioneq ] ) described below .",
    "in particular , @xmath25       \\times \\left\\ { \\begin{array}{ll }                     e^{(t - t_{min})/\\delta t } & \\mbox{if } ~ t \\le t_{min } , \\\\                     1 & \\mbox{otherwise } ,                     \\end{array }             \\right .",
    "\\label{eqn : coolingnochem}\\ ] ] where @xmath26 is the temperature - dependent cooling rate from metals ( including carbon , oxygen , neon , and iron lines taken from bohringer and hensler ( 1989 ) , with a metallicity dial to scale relative to solar abundance ) , @xmath27 is the cooling rate from hydrogen and helium lines , @xmath28 is the mass fraction of metals , @xmath29 is an estimate of the ionization fraction defined as @xmath30 with @xmath31 to match roughly the upper and lower bounds in the equilibrium model described below .",
    "also , @xmath32 is the gas temperature in kelvin , @xmath33 is the mean molecular weight , @xmath34 is the proton mass , @xmath35 is boltzmann s constant , and the exponential is introduced to suppress cooling at low temperature ( @xmath36 is typically set to @xmath37 , with width @xmath38 ) .",
    "@xmath39 represents compton cooling ( or heating ) due to the interaction of free electrons with the cosmic microwave background .",
    "the second model applies when the chemistry is solved in equilibrium and the ionization fraction is determined from equating the dominant hydrogen recombination and collisional rates @xcite @xmath40 where @xmath41 is the temperature in electron - volts , @xmath42 is the ionization energy of hydrogen . assuming the electrons and ions have the same temperature , the gas pressure and energy can be written @xmath43 with equation of state @xmath44 where @xmath45 is a numerical constant converting between electron - volts and kelvin .",
    "the cooling function takes the same form as ( [ eqn : coolingnochem ] ) , but in this case the ionization fraction @xmath29 is computed iteratively from the equilibrium model @xmath46 of equation ( [ eqn : fioneq ] ) , and the exponential cutoff is not applied since this behavior is contained implicitly in @xmath47 .",
    "equilibrium chemistry is solved by setting the time derivatives in equations ( [ eqn : dens_m ] ) to zero ( but only for the local chemistry update , transport is still accounted for with operator splitting ) and solving the following algebraic equations , after first making a guess for the electron number density @xmath48 where @xmath49 is the mass fraction of hydrogen , @xmath50 , and @xmath51 parameterizes the relative helium concentration . equations ( [ eqn : eqhi ] ) - ( [ eqn : eqne ] ) are solved iteratively in the order they are written until the electron density converges to a specified tolerance , typically less than @xmath52 .",
    "the subscripts used for the rate coefficients @xmath53 refer to a particular chemical reaction ordered as in table [ tab : chemistry ] .",
    "the third cooling model is used when chemistry is solved dynamically with the full nonequilibrium equations ( [ eqn : dens_m ] ) . in this case , the various ionization states and concentration densities @xmath54}$ ] of each element are calculated from the chemistry equations with a stable ordered backwards differencing scheme @xcite and used explicitly in the cooling function as @xmath55 } ) =      \\sum_{i=1}^{n_{s } } \\sum_{j=1}^{n_{s } }   \\dot{e}_{ij}(t ) \\rho^{[i ] } \\rho^{[j ] }      + \\sum_{i=1}^{n_{s } } j_i(\\nu ) \\rho^{[i ] }      + \\dot{e}_m(t ) ( f_m \\rho)^2      + \\lambda_{c } ,   \\label{eqn : coolingchem}\\ ] ] where @xmath56 are the cooling rates from 2-body interactions between species @xmath57 and @xmath58 , and @xmath59 represents frequency - integrated photoionization and dissociation heating .",
    "the equation of state in this case is given by @xmath60 we account for a total of eight different cooling and heating mechanisms : collisional - excitation , collisional - ionization , recombination , bremsstrahlung , metal - line cooling ( dominantly carbon , oxygen , neon , and iron ) , molecular - hydrogen cooling , compton cooling or heating , and photoionization heating .    finally we note that the following conservation equations for the chemical concentrations of hydrogen , helium , and charge @xmath61 are enforced after each computational cycle update .",
    "cosmos uses structured , block - ordered meshes for both spatial finite differencing and finite volume discretization methods . depending on the hydrodynamic algorithm ,",
    "state variables are either defined all at the zone centers ( for one of the artificial viscosity schemes and for the total energy conserving methods - tvd godunov and non - oscillatory central difference schemes ) , or on a staggered mesh for a second artificial viscosity method in which scalar and tensor quantities are zone - centered and vector variables are face - centered .",
    "periodic , reflection , constant - in - time , user - specified , outgoing , and flat ( vanishing first derivative ) boundary conditions are implemented .",
    "both the relativistic and newtonian hydrodynamic equations are solved using single or multiple step time - explicit , operator - split methods with second - order spatial finite differencing .",
    "the gravitational potential and nonequilibrium radiation diffusion equations ( discretized implicitly without the transport and compressive terms ) are solved using a collection of linear matrix solvers from the hypre software package developed at lawrence livermore national laboratory @xcite .",
    "hypre includes options for different conjugate gradient and multigrid methods with various preconditioners to optimize performance .",
    "we use a multigrid solver for the gravity and diffusion tests in sections  [ sec : marsh ] ,  [ sec : polytrope ] , and  [ sec : polytroperad ] .",
    "since the main emphasis in this paper is on newtonian hydrodynamics , the code tests presented in the following sections are designed to verify our code only in that regime , along with multi - physics ( e.g. radiation and chemistry ) coupling .",
    "we refer the interested reader to @xcite for discussions of the relativistic tests and for more explicit details of the numerical algorithms .",
    "it is anticipated that problems run in the newtonian regime using cosmos shall include microphysics ( chemistry , heating , and cooling ) .",
    "such problems are most appropriately solved with one of the artificial viscosity methods , which are written in an internal energy formulation .",
    "all of the hydrodynamics tests shown here are therefore computed using the staggered - mesh artificial viscosity method .",
    "we have , however , confirmed that results from the other algorithms yield comparable accuracy for most of the tests .",
    "the exceptions being the non - oscillatory central difference schemes which are more diffusive , in general , but particularly so for the rayleigh - taylor and spherical polytrope tests .",
    "accuracy comparable to the artificial viscosity approach can be achieved for those tests if the grid resolution is roughly doubled .",
    "we begin testing with one of the standard problems in fluid dynamics , the shock tube or sod problem .",
    "this test is characterized initially by two different fluid states separated by a membrane . at @xmath62 the membrane",
    "is removed and the fluid evolves in such a way that five distinct regions appear in the flow : an undisturbed region at each end , separated by a rarefaction wave , a contact discontinuity , and a shock wave .",
    "this problem provides a good test of the shock - capturing properties of the code since it has an exact solution @xcite against which numerical results can be compared .",
    "the initial state is specified by @xmath63 , @xmath64 , and @xmath65 to the left of the membrane , and @xmath66 , @xmath67 , and @xmath68 to the right .",
    "the fluid is assumed to be an ideal gas with @xmath69 , and the integration domain extends over a unit grid from @xmath70 to @xmath71 , with the membrane located at @xmath72 .",
    "the results presented here were run using scalar artificial viscosity with a quadratic viscosity coefficient @xmath73 , linear viscosity coefficient @xmath74 , and courant factor @xmath75 , in the notation of @xcite .",
    "figure [ fig : sod ] shows spatial profiles of the results at time @xmath76 for the 64-zone 1d case and the @xmath77-zone 3d case ( along the main diagonal ) . table [ tab : sod ] summarizes the errors in @xmath78 , @xmath7 , and @xmath79 for different grid resolutions using the @xmath80 - 1 norm ( i.e. , @xmath81 , where @xmath82 and @xmath83 are the numerical and exact solutions , respectively , and @xmath84 for 1d problems ) .",
    "the convergence rates for these tests are just under first order , as expected for shock - capturing methods .",
    "the slightly higher @xmath80 - 1 norm errors in the 3d case are due to the fact that the error calculation is computed globally across the whole mesh , and so suffers from reflection effects at the grid boundaries .",
    "the next problem we consider is the sedov blast wave in which energy is released at @xmath62 in the form of an explosion into an initially undisturbed , uniform gas . in 3d , this results in a spherical shock wave ( or blast wave ) expanding from the explosion , such that @xmath85 , where @xmath86 is the radius of the shock and @xmath87 is the elapsed time @xcite .",
    "this problem encompasses a number of useful tests for our code , as it determines how well the code can follow a spherical shock wave as well as testing energy conservation .",
    "the initial state is specified by @xmath88 , @xmath89 , and @xmath90 .",
    "the fluid is assumed to be an ideal gas with @xmath91 , and the integration domain extends over a unit cube .",
    "the blast wave is initiated by significantly increasing the energy density ( relative to the background ) in an approximately spherical region with a half - width at half - maximum of two zones and maximum cutoff radius of five zones using a gaussian profile .",
    "the initial energy density contrast between the peak of the gaussian and the background is @xmath92 .",
    "the results presented here were run using a tensor artificial viscosity with a quadratic viscosity coefficient @xmath93 , linear viscosity coefficient @xmath74 , and courant factor @xmath94 .",
    "figure [ fig : sedov1 ] shows the shock radius as a function of time fit with a curve of the form @xmath95 .",
    "figure [ fig : sedov2 ] shows spatial profiles of the density along the @xmath96 , @xmath97 , and @xmath98 axes , as well as the diagonal at time @xmath99 for a @xmath77-zone octant , demonstrating that the blast wave maintains its self - similar solution along all three major axes and the diagonal .",
    "the energy loss in this problem was about 19% , although much of this was at the beginning of the simulation , and the total energy approaches a constant value after a time @xmath100 .",
    "the growth of a classical rayleigh - taylor instability has been modeled in two - dimensions .",
    "these models serve as tests of the ability of the code to follow the growth of a classical instability in both the linear and non - linear phases , and of its ability to cleanly advect material across the grid during the non - linear growth .",
    "the system which we model has physical dimensions that run from 0 to 0.1 in @xmath96 , and from -0.35 to 0.15 in @xmath98 .",
    "the resolution is 128 zones in @xmath96 and 1280 in @xmath98 .",
    "the constant gravitational field , @xmath101 , points toward negative @xmath98 . at @xmath102 ,",
    "the density and isothermal sound speed of the dense ( upper ) fluid are @xmath103 and @xmath104 , while those of the light ( lower ) fluid are @xmath105 and @xmath106 , such that pressure is continuous across the fluid interface .",
    "away from the interface , the individual fluids are isothermal , and their densities vary so as to maintain hydrostatic equilibrium in the gravitational field , i.e. @xmath107},\\ ] ] where @xmath108 is the gravitational potential , and we take @xmath109 . to approximate incompressibility ,",
    "the fluids are taken to be ideal gases , with large adiabatic index , @xmath110 .",
    "the initial distribution of the fluids , in which quantities depend only upon @xmath98 , are perturbed by introducing a vertical shift of the form @xmath111 where @xmath112 is the wavelength of the perturbation , and @xmath113 is its amplitude . we have examined models having two different values of @xmath114 . in the first , we choose @xmath115 , and @xmath116 , such that the perturbation is linear , though not strongly so . resolution requirements and computational time constraints prevent us from modeling a system having a substantially smaller value of @xmath113 . in the second model , @xmath117 , such that this model examines the growth of initially non - linear perturbations . in introducing the perturbations , density and pressure",
    "are not altered , and so the fluids remain in pressure equilibrium with each other ( thus preventing the initial growth of sound waves ) , but are slightly out of equilibrium with the gravitational field .",
    "reflective boundary conditions are applied at the top and bottom of the grid , while periodic boundaries are used at the left and right .",
    "artificial viscosity is not used in these calculations .",
    "figure [ fig : rt1 ] shows snapshots of the evolution of the model having @xmath118 at the times @xmath119 and @xmath120 .",
    "shown , in grayscale , is the tracer material initially placed in the dense upper fluid .",
    "the initial perturbation can be seen in the first panel . as can be seen in the subsequent panels , the discretization of the grid creates short - wavelength structure superimposed upon the long - wavelength perturbation .",
    "the shortest wavelengths saturate quickly , but longer wavelengths persist , and can be seen superimposed upon the classical single - mode rollup at @xmath121 .",
    "although the small scale vorticity spreads the tracer material widely across the grid , little diffusiveness is apparent .",
    "the early growth of the longest wavelength modes of both non - linear and linear initial perturbations are shown in figure  [ fig : rt2 ] .",
    "also shown is the prediction of linear theory for incompressible , constant density fluids , for which the instability is predicted to grow as @xmath122 , with @xmath123 @xcite .",
    "the overall agreement between theory and the model with the linear initial perturbation is good .",
    "the computed growth rate is found to be 14% slower than the analytic value .",
    "the slow growth rate may be due to the relatively large initial amplitude of the imposed perturbation , a surmise supported by the curvature seen in the growth rate of the numerical results .",
    "both curves stand in contrast to that of the initially non - linear perturbation , which has a much smaller growth rate , as predicted by theory ( see below ) .    in the non - linear regime ,",
    "the amplitude of the rayleigh - taylor instability is known to behave asymptotically as @xmath124 ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the late - time behavior of the models is shown in figure  [ fig : rt3 ] . in the figure",
    "are shown the penetration amplitude of the dense fluid as a function of @xmath125 for both the initially linear and initially non - linear simulations . as can be seen in the figure",
    ", both simulations display the expected late - time behavior , with @xmath126 for the initially linear model , and @xmath127 for the initially non - linear model , where @xmath128 is computed for the initial atwood number of the fluids .",
    "the differences between the two models are most likely due to compressibility effects , which become more apparent at late times .",
    "the initial data for this test is characteristic of pre - shock flows expected from large - scale ( galactic - type ) structures @xmath129 corresponding to a uniform flow of gas along the @xmath130 direction .",
    "reflection boundary conditions are imposed at @xmath70 and we use 100 zones to resolve a spatial extent of @xmath131 mpc .",
    "a shock wave forms at the wall at @xmath70 and propagates to the right at velocity @xmath132 .",
    "as the heated gas cools radiatively , the shock begins to lose pressure support and slows down .",
    "eventually the shock collapses and re - establishes a new pressure equilibrium closer to the wall .",
    "as gas continues to accrete , the shock front moves outwards again to repeat the cycle of oscillations as shown in figure [ fig : radshock ] , where the shock position , @xmath133 , is plotted as a function of time in units where the grid length is set to unity and the unit of time is @xmath134 seconds .",
    "figure [ fig : radshock ] shows results from two calculations : one with no chemistry in which @xmath135 , and a second 6-species equilibrium chemistry model that approximates the number densities of the dominant coolants @xmath136 from equilibrium assumptions .",
    "we have also run a third calculation to test the 6-species nonequilibrium chemistry model which explicitly solves the non - linear differential kinetics equations .",
    "the results in this case are nearly identical to the equilibrium calculations so we do not include them in figure [ fig : radshock ] .",
    "we do , however , show the mass fraction distribution of each of the chemical species at the final time of the simulation for the nonequilibrium case in figure [ fig : species ] .",
    "mass fractions in the hot phase , where collisional ionization and recombination effects are expected to be in equilibrium , agree with those computed from the equilibrium model .",
    "for all these calculations we assume a perfect fluid model for the gas with adiabatic index @xmath137 and a cooling function dominated by bremsstrahlung effects .",
    "the accuracy of these calculations is evaluated by comparing the fundamental frequency of oscillations to the perturbation results of @xcite who defined the normalized frequency as @xmath138 , where @xmath7 is the period of the oscillations , @xmath139 is the average shock position , and @xmath140 is the inflow velocity . we find @xmath141 0.319 and 0.315 for the no - chemistry and 6-species chemistry cases respectively .",
    "these results compare nicely with the perturbation estimate of 0.31 .      in the following test",
    ", we consider the penetration of radiation from a hot source into cold material @xcite . because radiative transport is very efficient in the problems considered here , significant penetration can occur on a timescale much shorter than the timescale for motion of the gas .",
    "we therefore ignore hydrodynamic transport and consider only supersonic radiation diffusion through an ambient gas in thermal equilibrium with the radiation and held initially at temperature @xmath142 , but subject to the boundary condition @xmath143 at one end .",
    "the energy diffusion equation @xmath144 where @xmath145 is the diffusion coefficient , and @xmath146 is the rosseland mean opacity , can be solved approximately for this simple case to give @xcite @xmath147 \\right\\ } ^{1/\\bar{n } } ~,\\ ] ] where @xmath148 @xmath149 , and @xmath150 is a numerical fitting factor of order unity . from ( [ eqn : marsh_front ] )",
    "we clearly see that the radiation front location , @xmath151 , should propagate as @xmath152 .    in this work we consider two cases : a constant opacity with @xmath153 , and a temperature - dependent opacity with @xmath154 and @xmath155 .",
    "the computational grid is set to approximately 50 times the mean - free path ( @xmath156 ) , and an appropriate stopping time @xmath157 is defined using equation ( [ eqn : marsh_front ] ) .",
    "the problem is initialized with @xmath158 @xmath159 g@xmath160 , @xmath161 g @xmath162 , @xmath163 k , @xmath164 k , and the grid is discretized with 400 zones .",
    "figure [ fig : marsh_pro ] shows the profile of the radiation front for the constant opacity case normalized to the analytic radiation front position with @xmath165 .",
    "the numerical results , plotted at ( 0.25 , 0.5 , 0.75 , 1)@xmath166 , nicely display the self - similar nature of this solution . figure [ fig : marsh_time ] plots the numerical radiation front location as a function of time . here",
    "we define the numerical front to be located at the half - maximum , although our results do not depend strongly upon this choice .",
    "the data is well fit with a @xmath152 curve .",
    "figures [ fig : marsh_pro_t ] and [ fig : marsh_time_t ] present similar results for the temperature - dependent opacity .",
    "the analytic curve in figure [ fig : marsh_pro_t ] is computed with @xmath167 .",
    "here we test the linear matrix methods used in solving poisson s equation for the gravitational potential of a compact self - gravitating source , and the ability of the code to maintain a balance between gravitational and pressure support forces in three dimensions . for this test",
    "we adopt an adiabatic polytrope star with @xmath168 in spherical symmetry and hydrostatic equilibrium with solutions for the gas pressure , density and gravitational potential @xmath169 where @xmath170 for radii @xmath171 , and @xmath172 is the outer surface radius .",
    "also , @xmath173 with negligible density and pressure ( @xmath174 of the maximum central values ) outside the star at radii @xmath175 .",
    "these tests are carried out for characteristic neutron star parameters with total mass @xmath176 , central density @xmath177 g @xmath162 , and radius 5.6 km .",
    "we ran a sequence of three simulations at different grid resolutions over two sound crossing times , @xmath178 , with monopole boundary conditions to find mean relative errors of 0.0687 , 0.0209 , and 0.0101 for resolutions",
    "@xmath179 , @xmath180 , and @xmath181 cells respectively .",
    "monopole boundary conditions are implemented by computing the total mass @xmath182 and mass centroid coordinates @xmath183 in the computational domain . the potential field",
    "is then set to @xmath184 at the outer boundary @xmath185 .",
    "figure [ fig : nstar ] shows spatial profiles in density for the @xmath181 case along the @xmath96-axis at the initial time ( the analytic solution ) , and along four separate directions at @xmath186 : the @xmath96 , @xmath97 , @xmath98 and diagonal lines running through the origin .",
    "the data is displayed in dimensionless code units with length scale @xmath187 where @xmath188 is the number of interior cells along an axis , and density scale @xmath189 .",
    "we observe no significant break in symmetry in the solutions , and the central peak density is maintained to good accuracy .      the hydrostatic polytrope solution in  [ sec : polytrope ] can be generalized to include a radiation field and radiation pressure , thus providing a useful test of the coupling between gravity , fluid pressure , and radiation pressure .",
    "it also exercises the multiphysics operator splitting scheme in testing the ability of the code to maintain a balance between the three different self - consistently generated forces in three dimensions .    the solution ( [ eqn : nstarp ] ) - ( [ eqn : nstarphi ] ) is easily extended to include the effect of radiation pressure by assuming @xmath190 , where @xmath191 is a constant .",
    "this simplifies the solution considerably and allows for an effective ( hydrodynamic plus radiation ) pressure to counteract gravity with the same radial dependence as in the pure hydrodynamics case . the radiation energy equation ( [ eqn : enrad ] )",
    "reduces , in the spherical , static , and thermal equilibrium limits , to @xmath192 , which can be solved trivially if the diffusion coefficient is set to @xmath193 , where @xmath194 is a constant . the complete solution including radiation pressure and radially dependent opacity is @xmath195 where @xmath196 is the rosseland mean opacity , and the density and gravitational potential are unchanged .",
    "we ran a sequence of three simulations at different grid resolutions over half a sound crossing time and in an octant to properly specify the constant radiation boundary conditions across the star profile .",
    "the parameters are the same as the tests in  [ sec : polytrope ] , but with the addition of @xmath197 and @xmath198 to give equal significance to the radiation and hydrodynamic pressures .",
    "we find mean relative errors of 0.148 , 0.0405 , and 0.0138 for resolutions @xmath199 , @xmath179 , and @xmath180 cells respectively , demonstrating roughly second order convergence .",
    "figure [ fig : nstarrad ] shows spatial profiles in density for the @xmath180 case at the initial time ( the analytic solution ) , and along the @xmath96 , @xmath97 , @xmath98 and diagonal directions running through the origin at @xmath200 .      in this last section",
    "we perform simulations of astrophysical jets as a final test of our code .",
    "a beam of low density material ( @xmath201 ) with radius @xmath202 is injected into a homogeneous higher density ( @xmath203 ) ambient medium along the @xmath204 axis . within a cylindrical radius @xmath205 parsecs in the @xmath102 plane , a constant inflow velocity of @xmath206 cm s@xmath160",
    "is maintained as a boundary condition .",
    "simple outflow conditions are imposed at all other external boundaries .",
    "the jet material and ambient medium are initialized in pressure equilibrium , with an ambient temperature of @xmath207 .",
    "an ideal gas equation of state with adiabatic index @xmath137 is used for both materials .",
    "the mach number for these parameters is @xmath208 , where @xmath209 is the sound speed of the background material into which the beam flows .",
    "figure [ fig : jets ] shows results at time @xmath210 from two calculations : one using a low resolution grid ( @xmath211 cells ) with 6 zones to cover the jet radius , and a high resolution grid ( @xmath212 cells ) with 12 zones/@xmath202 .",
    "the physical box dimensions in both cases are set to @xmath213 .",
    "the results , particularly the high resolution case , clearly show all the morphological elements of astrophysical jets @xcite : a supersonic beam that ends in a bow shock , a cocoon composed of shock heated jet material , a working surface separating jet and shocked ambient gas , internal shock interactions , and the growth of kelvin - helmholtz instabilities .    equating the ram pressure from the jet front and the equivalent pressure from the ambient medium yields @xmath214 for an estimate of the velocity of the bow shock through the ambient medium , neglecting multi - dimensional effects .",
    "the sensitivity of the leading shock velocity @xmath215 to grid resolution is clear from figure [ fig : jets ] . in particular ,",
    "we find , by tracking the bow shock position , velocities of @xmath216 and @xmath217 for the low and high resolution runs respectively . in comparison ,",
    "equation ( [ eqn : jetvel ] ) predicts @xmath218 .",
    "higher resolution allows more accurate modeling of the bow shock and working surface which effectively broadens the jet , and resolves to a greater extent 3d instabilities and internal shock interactions , all of which contribute to slowing the shock .",
    "these results are generally consistent with those of @xcite , who find jets with similar hypersonic mach numbers and density ratios propagate at near ( and greater than ) unit efficiencies , defined by @xmath219 .",
    "we have developed a new multidimensional , multiphysics code ( cosmos ) that can be applied to a broad range of astrophysical problems , from highly relativistic scalar - field dominated applications in early universe cosmology , to black - hole accretion and multiphase newtonian galactic dynamics . in this contribution , we presented the radiation - chemo - hydrodynamics equations solved in the newtonian limit , along with numerous tests to gauge the accuracy and stability of the code in various multiphysics modes . in a companion paper @xcite ,",
    "cosmos is applied to the problem of supernova - enrichment in dwarf - spheroidal galaxies , which utilizes many of the capabilities ( robust shock capturing , radiative cooling flows , multiphase fluids , hydrodynamic instabilities , and gravitational potentials ) presented and tested here .",
    "this work also complements an earlier paper @xcite in which we presented the general relativistic equations solved in cosmos .",
    "there we provided more detailed descriptions of our numerical methods for the different energy and algorithmic formulations , together with numerical tests for highly relativistic hydrodynamical systems and black hole accretion .                                                    .",
    "chemical gas phase reactions modeled in cosmos , grouped by primordial versus molecular chains , and collisional versus photoreactive processes .",
    "the corresponding rate coefficients are referred to as @xmath53 in the main text , where @xmath57 is the reaction number defined in this table . for a more detailed description of the chemistry and for explicit formulas used in defining the kinetic and cooling coefficients , see and . [ cols=\"<,<\",options=\"header \" , ]"
  ],
  "abstract_text": [
    "<S> we have developed a new massively - parallel radiation - hydrodynamics code ( cosmos ) for newtonian and relativistic astrophysical problems that also includes radiative cooling , self - gravity , and non - equilibrium , multi - species chemistry . </S>",
    "<S> several numerical methods are implemented for the hydrodynamics , including options for both internal and total energy conserving schemes . </S>",
    "<S> radiation is treated using flux - limited diffusion . </S>",
    "<S> the chemistry incorporates 27 reactions , including both collisional and radiative processes for atomic hydrogen and helium gases , and molecular hydrogen chains . in this paper </S>",
    "<S> we discuss the equations and present results from test problems carried out to verify the robustness and accuracy of our code in the newtonian regime . </S>",
    "<S> an earlier paper presented tests of the relativistic capabilities of cosmos . </S>"
  ]
}