{
  "article_text": [
    "ground - state density functional theory@xcite ( dft ) is a popular choice for finding the ground - state energy of electronic systems,@xcite and excitations can now easily be extracted using time - dependent dft@xcite ( tddft ) . despite its popularity ,",
    "tddft calculations have many well - known failings,@xcite such as double excitations@xcite and charge - transfer excitations.@xcite alternative dft treatments of excitations@xcite are always of interest .",
    "ensemble dft ( edft)@xcite is one such alternative approach . unlike tddft , it is based on an energy variational principle .",
    "an ensemble of monotonically decreasing weights is constructed from the @xmath0 lowest levels of the system , and the expectation value of the hamiltonian over orthogonal trial wavefunctions is minimized by the @xmath0 exact lowest eigenfunctions.@xcite a one - to - one correspondence can be established between ensemble densities and potentials for a given set of weights , providing a hohenberg - kohn theorem , and application to non - interacting electrons of the same ensemble density yields a kohn - sham scheme with corresponding equations.@xcite in principle , this yields the exact ensemble energy , from which individual excitations may be extracted .    but to make a practical scheme , approximations must be used.@xcite these have been less successful for edft than those of ground - state@xcite and tddft,@xcite and their accuracy is not yet competitive with tddft transition frequencies from standard approximations .",
    "some progress has been made in identifying some major sources of error.@xcite    to help speed up that progress , we have developed a numerical algorithm to calculate ensemble kohn - sham ( ks ) quantities ( orbital energies , energy components , potentials , etc . )",
    "essentially exactly,@xcite from highly accurate excited - state densities . in the present paper",
    ", we provide reference ks calculations and results for two - electron systems under a variety of conditions .",
    "the potentials we find differ in significant ways from the approximations suggested so far , hopefully leading to new and better approximations .    to illustrate the essential idea",
    ", we perform calculations on simple model systems . for example",
    "[ sect:1dbox ] presents two ` electrons ' in a one - dimensional box , repelling one another via a ( slightly softened ) coulomb repulsion . in fig .",
    "[ fig:1dbox : general ] , we show their ground- and excited - state densities , with @xmath1 indicating the specific ground or excited state .",
    "we also plot the ensemble exchange - correlation potentials for equally weighted mixtures of the ground and excited states , which result from our inversion scheme . in this lower plot",
    ", @xmath2 denotes the ground - state exchange - correlation potential , and @xmath3 indicates the potential corresponding to an equal mixture of the ground state and all multiplets up to and including the @xmath1-th state .",
    "excitation energies for all these states are extracted using the edft methods described below .",
    "the paper is laid out as follows . in the next section ,",
    "we briefly review the state - of - the - art for edft , introducing our notation .",
    "then we give some formal considerations about how to define the hartree energy .",
    "the naive definition , taken directly from ground - state dft , introduces spurious unphysical contributions ( which then must be corrected - for ) called ` ghost ' corrections.@xcite we also consider how to make choices among ks eigenstates when they are degenerate , and show that such choices matter to the accuracy of the approximations .",
    "we close that section by showing how to construct symmetry - projected ensembles .    in the following section ,",
    "we prove a variety of exact conditions within edft .",
    "such conditions have been vital in constructing useful approximations in ground - state dft.@xcite following that , we describe our numerical methods in some detail .",
    "the results section consists of calculations for quite distinct systems , but all with just two electrons .",
    "the one - dimensional flat box was used for the illustration here , which also gives rise to double excitations .",
    "a box with a high , asymmetric barrier produces charge - transfer excitations .",
    "hooke s atom is a three - dimensional system , containing two coulomb - repelling electrons in a harmonic oscillator external potential.@xcite it has proven useful in the past to test ideas and approximations in both ground - state and tddft calculations.@xcite we close the section reporting several new results for the he atom , using ensembles that include low - lying triplet states .",
    "atomic units [ @xmath4 are used throughout unless otherwise specified .",
    "the ensemble variational principle@xcite states that , for an ensemble of the lowest @xmath0 eigenstates @xmath5 of the hamiltonian @xmath6 and a set of orthonormal trial functions @xmath7 , _ m=0^m _",
    "m_m | | _ m _ m=0^m _ me_m , when the set of weights @xmath8 satisfies _ 0_1  _m  0 , and @xmath9 is the eigenvalue of the @xmath10th eigenstate of @xmath6 .",
    "equality holds only for @xmath11 .",
    "the density matrix of such an ensemble is defined by _ = _ m=0^m _ m| _",
    "m > < _ m | , where @xmath12 denotes the entire set of weight parameters",
    ". properties of the ensemble are then defined as traces of the corresponding operators with the density matrix .",
    "the ensemble density @xmath13 is n_()=\\{_()}=_m=0^m _",
    "m n_m ( ) , [ eqn : theory : den ] and the ensemble energy @xmath14 is e_=\\{_}=_m=0^m _",
    "[ eqn : theory : eensdef ] @xmath13 is normalized to the number of electrons , implying @xmath15 .",
    "a hohenberg - kohn ( hk)@xcite type theorem for the one - to - one correspondence between @xmath13 and the potential in @xmath6 has been proven,@xcite so all ensemble properties are functionals of @xmath13 , including @xmath16 .",
    "the ensemble hk theorem allows the definition of a non - interacting ks system , which reproduces the exact @xmath13 .",
    "the existence of an ensemble ks system assumes ensemble @xmath17-representability . edft itself",
    ", however , only requires ensemble non - interacting @xmath18-representability , since a constrained - search formalism is available.@xcite ensemble @xmath18- and @xmath17-representability are not yet proven , only assumed .    as in the ground - state case , only the ensemble energy functional",
    "is formally known , which is e_[n]=f_[n]+^3rn()v ( ) , where @xmath19 is the external potential .",
    "the ensemble universal functional @xmath20 is defined as f_[n]=\\{_[n](+ ) } , where @xmath21 and @xmath22 are the kinetic and electron - electron interaction potential operators , respectively .",
    "the ensemble variational principle ensures that the ensemble energy functional evaluated at the exact ensemble density associated with @xmath19 is the minimum of this functional , eq . ( [ eqn : theory : eensdef ] ) .",
    "the ensemble ks system is defined as the non - interacting system that reproduces @xmath13 and satisfies the following non - interacting schrdinger equation : \\{-^2+v_,[n_]()}_j,()=_j,_j , ( ) .",
    "[ eqn : theory : ks ] the ensemble ks system has the same set of @xmath8 as the interacting system . there is no formal proof for this consistency , and it has non - trivial implications even for simple systems .",
    "this will be explored more in sec .",
    "[ sect : theory : connection ] .",
    "the ks density matrix @xmath23 is _ , = _ m=0^m _ m| _",
    "< _ m | , where @xmath24 are non - interacting @xmath18-particle wavefunctions , usually assumed to be single slater determinants formed by ks orbitals @xmath25 .",
    "we find that this choice can be problematic , and it will be discussed in sec .",
    "[ sect : theory : hartree ] .",
    "the ensemble density @xmath26 is reproduced by the ks system , meaning n_()=_m=0^m _",
    "m n_m()=_m=0^m _ m n_,m ( ) , [ eqn : theory : nens ] where @xmath27 , and @xmath28 .",
    "the ks densities of the individual states are generally not related to those of the interacting system ; only their weighted sums are equal , as in eq .",
    "( [ eqn : theory : nens ] ) .",
    "@xmath29 $ ] is decomposed as in ground - state dft ,    e_[n]&=t+v[n]+e+e + & = \\{}+^3rn()v ( ) + & + e+e ,    [ eqn : theory : edecomp ] where only the ensemble exchange - correlation ( xc ) energy @xmath30 is unknown .",
    "the form of @xmath31 is then determined according to the variational principle by requiring @xmath32/\\delta n_{\\wtset}(\\br)=0 $ ] , resulting in v()=v()+v()+v ( ) , where @xmath33(\\br)=\\delta e\\h[n]/\\delta n(\\br)$ ] , and @xmath34(\\br)=\\delta e\\xcwset[n]/\\delta n(\\br)$ ] .",
    "@xmath35 is generally defined to have the same form as the ground - state hartree energy functional .",
    "although this choice is reasonable , we find that it is more consistent to consider @xmath36 , the combined hartree and exchange energy .",
    "this point will be discussed in sec .",
    "[ sect : theory : hartree ] .",
    "the ensemble universal functional @xmath37 $ ] depends on the set of weights @xmath8 . ref .",
    "introduced the following set of weights , so that only one parameter @xmath38 is needed : _",
    "m=\\ {    ll & m m_i - g_i , + & m > m_i - g_i ,    .",
    "[ eqn : theory : ogkens ] where @xmath39 $ ] . in this ensemble ,",
    "here called gok , @xmath1 denotes the set of degenerate states ( or ` multiplet ' ) with the highest energy in the ensemble , @xmath40 is the multiplicity of the @xmath1-th multiplet , and @xmath41 is the total number of states up to the @xmath1-th multiplet .",
    "gok ensembles must contain full sets of degenerate states to be well - defined .",
    "the weight parameter @xmath38 interpolates between two ensembles : the equiensemble up to the @xmath1-th multiplet ( @xmath42 ) and the equiensemble up to the @xmath43-th multiplet ( @xmath44 ) .",
    "all previous studies of edft have been based on this type of ensemble .",
    "the purpose of edft is to calculate excited - state properties , not ensemble properties . with the gok ensemble",
    ", the excitation energy of multiplet @xmath1 from the ground state , @xmath45 , is obtained using ensembles up to the @xmath1-th multiplet as _",
    "i=.|_=_i+_i=0^i-1.|_=_i , [ eqn : theory : exciteng ] which simplifies to _",
    "1=_,1,+.|_n = n _ for the first excitation energy . eq . ( [ eqn : theory : exciteng ] ) holds for any valid @xmath46 s if the ensemble ks systems are exact , despite every term in eq .",
    "( [ eqn : theory : exciteng ] ) being @xmath38-dependent .",
    "no existing @xmath47 approximations satisfy this condition.@xcite    levy@xcite pointed out that there is a special case for @xmath48 of bi - ensembles",
    "( @xmath49 , with all degenerate states within a multiplet having the same density ) ,    v&=_0.|_n = n _ + & = -v_,=0[n_=0 ] ( )    [ eqn : theory : dervdisc ] for finite @xmath50 , where @xmath51 is the change in the ks highest - occupied - molecular - orbital ( homo ) energy between @xmath44 ( ground state ) and @xmath52.@xcite @xmath51 is a property of electron - number - neutral excitations , and should not be confused with the ground - state derivative discontinuity @xmath53 , which is related to ionization energies and electron affinities.@xcite      taking the he atom as our example , the interacting system has a non - degenerate ground state , triply degenerate first excited state , and a non - degenerate second excited state .",
    "however , the ks system has a four - fold degenerate first excited state ( corresponding to four slater determinants ) , due to the ks singlet and triplet being degenerate ( fig .",
    "[ fig : cartoon ] ) .",
    "consider an ensemble of these states with arbitrary weights .",
    "represent the ensemble energy functional eq .",
    "( [ eqn : theory : eensdef ] ) as the ks ensemble energy , @xmath54 , plus a correction , @xmath55 .",
    "the correction then must encode the switch from depending only on the sum of the weights of the excited states as a whole in the ks case to depending on the sum of triplet weights and the singlet weight separately .",
    "-th multiplet is @xmath56 ; tildes denote ks values .",
    "for instance , @xmath57 refers to the ks multiplet used to construct the second ( singlet ) multiplet of the real system ( @xmath49 ) , as is described in sec .",
    "[ sect : theory : correctvhx ] . ]    for the interacting system , the ensemble energy and density take the forms    e_&=(1-_t-_s)e_0+_t_1+_s _ 2 , + n_()&=(1-_t-_s)n_0()+_tn_1()+_s n_2 ( ) ,    where @xmath58 , and so on , @xmath59 is the sum of the triplet weights , and @xmath60 is the singlet weight .",
    "on the other hand , for the ks system we have    e&=(1-_t-_s)e_,0+(_t+_s)_1 , , + n_()&=2(1-_t-_s)|_1s|^2+(_t+_s)(|_2s|^2-|_1s|^2 ) .",
    "the functional @xmath61 in this case is @xmath62=\\left(1-\\wt_{\\sss t}-\\wt_{\\sss s}\\right)\\left(e_0-e_{s,0}\\right)\\\\ + \\wt_{\\sss t}\\left(\\omega_1-\\delta \\epsilon_1\\right)+\\wt_{\\sss s } \\left(\\omega_2-\\delta \\epsilon_1\\right),\\end{gathered}\\ ] ] showing that the exact ensemble energy functional ( which can also be decomposed as in eq .",
    "( [ eqn : theory : edecomp ] ) ) has to encode the change in the multiplet structure between non - interacting and interacting systems , even for a simple system like the he atom .",
    "such information is unknown _ a priori _ for general systems , and can be very difficult to incorporate into approximations .",
    "this problem can be alleviated if the degeneracies are the result of symmetry .",
    "this will be discussed in sec . [",
    "sect : theory : ext : sym ] .",
    "available approximations to the ensemble @xmath63 include the quasi - local - density approximation ( qlda ) functional@xcite and the ` ghost'-corrected exact exchange ( exx ) functional.@xcite the qlda functional is based on the equiensemble qlda,@xcite and it interpolates between two consecutive equiensembles:@xcite @xmath64(\\br)=(1-m_i \\wt)e_{\\sss{xc},i-1}^\\text{eqlda}[n](\\br)\\\\ + m_i \\wt e_{\\sss{xc},i}^\\text{eqlda}[n],\\end{gathered}\\ ] ] where @xmath65 is the equiensemble qlda functional defined in terms of finite - temperature lda in ref . .",
    "the ensemble hartree energy is defined analogously to the ground - state hartree energy as shown in eq .",
    "( [ eqn : theory : edecomp ] ) .",
    "similarly , nagy provides a definition of the exchange energy for bi - ensembles:@xcite e^[n_,n_]=-_^3r^3r , [ eqn : theory : exnagy ] where @xmath66 is the reduced density matrix defined analogously to its ground - state counterpart , assuming a spin - up electron is excited in the first excited state : n_,(,)=_j=1^n_n_j,(,)+_,(n_(,)-n_(, ) ) , [ eqn : theory:1dmnagy ] with @xmath67 , @xmath68 and @xmath69 , the spin - up lowest - unoccupied - molecular - orbital ( lumo ) and homo , respectively . both @xmath35 in eq .",
    "( [ eqn : theory : edecomp ] ) and ( [ eqn : theory : exnagy ] ) contain ` ghost ' terms,@xcite which are cross - terms between different states in the ensemble due to the summation form of @xmath26 in eq .",
    "( [ eqn : theory : den ] ) and @xmath70 in eq .",
    "( [ eqn : theory:1dmnagy ] ) .",
    "an exx functional is obtained after such spurious terms are corrected . for two - state ensembles ,",
    "the gpg xc energy functional is then @xmath71=\\int\\frac{{\\mathrm{d}}^3r{\\mathrm{d}}^3r'}{{\\left|\\br-\\br'\\right|}}\\left\\{-\\frac{1}{2}\\left(n_\\sigma(\\br,\\br')\\right)^2\\right.\\notag\\\\ & \\left.+\\wt\\wtb\\left[n_{\\text{h}\\uparrow}(\\br,\\br')n_{\\text{l}\\uparrow}(\\br,\\br')-n_{\\text{h}\\uparrow}(\\br')n_{\\text{h}\\uparrow}(\\br')\\right]\\right\\},\\end{aligned}\\ ] ] where @xmath72 .",
    "these ` ghost ' corrections are small compared to the hartree and exchange energies .",
    "however , they are large corrections to the excitation energies , as eq .",
    "( [ eqn : theory : exciteng ] ) contains energy derivatives instead of energies .",
    "table [ table : atomexx ] shows a few examples .    with the help of the exact ensemble ks systems to be presented in this paper ,",
    "we notice inconsistencies with the gpg functional .",
    "these problems and our proposed solutions will be explained in secs .",
    "[ sect : theory : hartree ] and [ sect : theory : correctvhx ] .",
    "in this section , we extend edft to improve the consistency and generality of the theory .      the energy decomposition in eq .",
    "( [ eqn : theory : edecomp ] ) is analogous to its ground - state counterpart .",
    "however , unlike @xmath73 and @xmath74 , the choices for @xmath35 and @xmath75 and @xmath76 are ambiguous ; only their sum is uniquely determined . as shown in eq .",
    "( [ eqn : theory : edecomp ] ) and ( [ eqn : theory : exnagy ] ) , definitions for @xmath35 and @xmath75 can introduce ` ghost ' terms .",
    "corrections can be considered either a part of @xmath35 and @xmath75 or a part of @xmath76 .",
    "such correction terms also take a complicated form when generalized to multi - state ensembles .",
    "a more natural way of defining @xmath35 and @xmath63 for ensembles can be achieved by considering the purpose of this otherwise arbitrary energy decomposition . in the ground - state case , the electron - electron repulsion reduces@xcite to the hartree energy for large @xmath77 , which is a simple functional of the density .",
    "the remaining unknown , @xmath63 ( and its components @xmath75 and @xmath76 ) , is a small portion of the total energy , so errors introduced by approximations to it are small .    for ensembles ,",
    "we propose a slightly different energy decomposition . instead of defining @xmath35 and @xmath75 in analogy to their ground - state counterparts , we first define the combined hartree - exchange energy @xmath36 , which is the more fundamental object in edft",
    ". @xmath36 can be explicitly represented as the trace of the ks density matrix : e=\\{}=_m=0^m _",
    "_ m . [ eqn : ehxdef ] for the ground state , both hartree and exchange contributions are first - order in the adiabatic coupling constant , while correlation consists of all higher - order terms . according to the definition above , we retain this property in the ensemble .",
    "( [ eqn : ehxdef ] ) contains no ` ghost ' terms by definition , eliminating the need to correct them . as a consequence , the correlation energy , @xmath76 ,",
    "is defined and decomposed as e = e - e = t+u , where @xmath78 , @xmath79 and @xmath80 .",
    "this form of @xmath36 reveals a deeper problem in edft . as demonstrated in sec .",
    "[ sect : theory : connection ] , the multiplet structure of real and ks he atoms is different .",
    "real he has a triplet state and a singlet state as the first and second excited states , but ks he has four degenerate single slater determinants as the first excited states .",
    "worse , the ks single slater determinants are not eigenstates of the total spin operator @xmath81 , so their ordering is completely arbitrary .",
    "the ks system is constructed to yield only the real spin densities , not other quantities .",
    "ks wavefunctions that are not eigenstates of @xmath81 do not generally affect commonly calculated ground - state dft properties,@xcite but things are clearly different in edft . consider the bi - ensemble of the ground state and the triplet excited state of he .",
    "then @xmath82 $ ] depends on which three of the four ks excited - state slater determinants are chosen , though it must be uniquely defined .",
    "therefore , we choose the ks wavefunctions in edft to be linear combinations of the degenerate ks slater determinants , preserving spatial and spin symmetries and eliminating ambiguity in @xmath36 .",
    "such multi - determinant , spin eigenstates are also required for construction of symmetry - projected ensembles , as described in sec .",
    "[ sect : theory : ext : sym ] .",
    "the multi - determinant ks eigenstates and ensemble @xmath36 proposed here avoid the errors in ` ghost'-corrected exx,@xcite which introduces spurious spin - polarization in closed - shell systems and inherent ambiguity in the treatment of triplet states .",
    "we observe considerable improvement in the first excitation energies of some atoms , as reported in the fourth line of table [ table : atomexx ] .    with @xmath36 fixed , the definitions of @xmath35 and @xmath75 depend on one another , but",
    "@xmath76 does not . defining a hartree functional in the same form as the ground - state u[n]=^3r^3r",
    ", we can examine different definitions for the gok ensemble .",
    "we can define a ` ghost'-free ensemble hartree , @xmath83 , as e^=_m=0^m _",
    "m u[n_m ] , [ eqn : ehnew ] i.e. , the ensemble sum of the hartree energies of the interacting densities , or the slightly different e^=_m=0^m _ m u[n_,m ] , [ eqn : ehnew2 ] i.e. , the ensemble sum of the hartree energies of the ks densities . the traditional hartree definition , e^trad = u[n _ ] , [ eqn : ehtrad ] introduces ` ghost ' terms through the fictitious interaction of ground- and excited - state densities .",
    "traditional and ensemble definitions differ in their production of ` ghosts , ' as well as in their @xmath38-dependence .",
    "the ` ghost'-corrected @xmath35 in ref .",
    "m^2 u[n_,m ] has a different form from eq .",
    "( [ eqn : ehnew2 ] ) , which is also ` ghost'-free .",
    "each of these definitions of @xmath35 reduces to the ground - state @xmath35 when @xmath84 and satisfies simple inequalities such as @xmath85 and @xmath86 .",
    "however , this ambiguity in the definition of @xmath35 requires that an approximated ensemble @xmath63 be explicit about its compatible @xmath35 definition .",
    "the different flavors of @xmath87 are compared for the he singlet ensemble@xcite in fig .",
    "[ fig : he : singlet : eh ] .",
    "even though @xmath88 and @xmath89 do not contain ` ghost ' terms by definition , their magnitude is slightly bigger than that of @xmath90 , which is not ` ghost'-free .",
    "this apparent contradiction stems from @xmath88 and @xmath89 depending linearly on @xmath38 , while @xmath91 depends on @xmath38 quadratically . the quadratic dependence on @xmath38 is made explicit with the ` ghost'-corrected @xmath92 of ref . .",
    "comparing with the ` ghost'-free @xmath88 and @xmath89 , it is clear that @xmath93 overcorrects in a sense , and is compensated by an over - correction of the opposite direction in @xmath94 ( see supplemental material ) .    the traditional definition of eq .",
    "( [ eqn : ehtrad ] ) has the advantage that @xmath95 is a simple functional derivative with respect to the ensemble density .",
    "any other definition requires solving an optimized effective potential ( oep)@xcite - type equation to obtain @xmath96 . on the other hand ,",
    "an approximated @xmath63 compatible with @xmath97 requires users to approximate the corresponding ` ghost ' correction as part of @xmath63 .",
    "since the ghost correction is usually non - negligible , this is a major source of error for the qlda functional .      as mentioned previously , the ` ghost'-corrected exx of ref .",
    "introduces spurious spin - polarization even for closed - shell systems .",
    "the root of this problem is the use of single - slater - determinant wavefunctions , which are not symmetry eigenstates .",
    "we have now identified @xmath36 as being more consistent with the edft formalism than @xmath35 and @xmath75 .",
    "having also justified multi - determinant ensemble ks wavefunctions , we now derive a spin - consistent exx potential , the symmetry - eigenstate hartree - exchange ( sehx ) .",
    "define the two - electron repulsion integral ( ) = ^*_()^*_()_()_( ) and l_=()__,___,_. @xmath98 denotes the @xmath99-th ks orbital and @xmath100 its spin state . if the occupation of the @xmath101-th slater determinant of the @xmath99-th ks orbital of the @xmath102-th multiplet of the exact system is @xmath103 , define _ , ^(i , k)=_p=1^()c_p^(i , k)f_p,^()f_p,^ ( ) , where @xmath104 is the ks multiplicity of the @xmath105-th multiplet , and @xmath106 s are the coefficients of the multi - determinant wavefunctions defined by _",
    "^(i , k)(_1,  ,_n)=_p=1^()c^(i , k)_p_,p^(_1, ",
    "@xmath107 is a ks single slater determinant .",
    "note the numbering of the ks multiplets , @xmath102 , depends on @xmath105 , the numbering of the exact multiplet structure .",
    "the @xmath106 coefficients are chosen according to the spatial and spin symmetries of the exact state .",
    "now , with @xmath101 and @xmath108 ks single slater determinants of the ks multiplet , define @xmath109 in order to write h^(i , k)=_(l_-l_)h^(i , k)_. then , if g^(i , k)=_,>(l_-)_p=1^()|c_p^(i , k)|^2f^_p , f^_p , , the hartree - exchange energy for up to the @xmath1-th multiplet is e^=_i=1^i_k=1^g(i)^(i , k)\\{g^(i , k)+h^(i , k ) } , where @xmath110 is the exact multiplicity of the @xmath105-th multiplet .",
    "the @xmath111 potential is then    v_,,^()&= + & = ^3r_j+ ,    [ eqn : theory : vhxgeneral ] which yields an oep - type equation for @xmath112 .",
    "the @xmath112 of eq .",
    "( [ eqn : theory : vhxgeneral ] ) produces neither ` ghost ' terms nor spurious spin - polarizations . for closed - shell systems ,",
    "( [ eqn : theory : vhxgeneral ] ) yields @xmath113 , unlike ref . .",
    "an explicit @xmath112 can be obtained by applying the usual krieger - li - iafrate(kli)@xcite approximation .",
    "here we provide the example of the singlet bi - ensemble studied in our previous paper.@xcite @xmath36 for a closed - shell , singlet ensemble is @xmath114\\right\\},\\end{gathered}\\ ] ] where @xmath115 is the ks orbital density .",
    "spin is not explicitly written out because the system is closed - shell .",
    "after applying the kli approximation , we obtain @xmath116\\right.\\\\ \\left.+\\wt~n^\\text{orb}_2(\\br)\\left[v_2(\\br)+\\bar{v}_{\\sss{hx}2}-\\bar{v}_2\\right]\\right\\ } , \\label{eqn : theory : correctvhx}\\end{gathered}\\ ] ] with @xmath117,\\end{gathered}\\ ] ] v_2()= , and |v_j=^3rv_j()n^_j ( ) .",
    "( [ eqn : theory : correctvhx ] ) is an integral equation for @xmath118 that can be easily solved .    to fully understand the performance of @xmath118 ,",
    "self - consistent edft calculations would be needed at different values of @xmath38 , which is beyond the scope of this paper .",
    "we demonstrate the performance at @xmath44 later in sec .",
    "[ sect : gsatoms ] .",
    "the ensemble variational principle holds for any hamiltonian .",
    "if the hamiltonian @xmath6 commutes with another operator @xmath119 , one can apply to @xmath6 a projection operator formed by the eigenvectors of @xmath119 .",
    "one obtains a new hamiltonian , and the ensemble variational principle holds for this subspace of @xmath6 , allowing an edft to be formulated .",
    "an example would be the total spin operator @xmath81 , where s^2=_s=0^(2s+1)| s > < s | and @xmath120 are its eigenvectors .",
    "define a new hamiltonian @xmath121 as _",
    ". @xmath121 has the same set of eigenvectors as @xmath6 , but the eigenvalues are 0 for the eigenvectors not having spin @xmath122 .",
    "since one can change the additive constant in @xmath6 arbitrarily , it is always possible to make the eigenvalues of any set of spin-@xmath122 eigenvectors negative and thus ensure that they are the lowest energy states of @xmath121 .",
    "the ensemble variational principle holds for ensembles of spin-@xmath122 states .",
    "we have employed this symmetry argument in our previous paper@xcite for a purely singlet two - state ensemble of the he atom .",
    "a similar statement is available in ground - state dft , allowing direct calculation of the lowest state of a certain symmetry.@xcite the differences between the subspace and full treatments are encoded in the differences in their corresponding @xmath63 .",
    "thus the lowest two states within each spatial and spin symmetry category can be treated in edft in a two - state - ensemble fashion , which is vastly simpler than the multi - state formalism .",
    "since the multiplet structures of the interacting system and the ks system must be compatible , a symmetry - projected ensemble also requires a symmetry - projected ks system , which is impossible if ks wavefunctions are single slater determinants , as discussed in sec .",
    "[ sect : theory : hartree ] .",
    "here we prove some basic relations for the signs of various components of the ks scheme and a virial for the potentials .",
    "we describe a feature of the ensemble derivative discontinuity and extraction of excited properties from the ground state .",
    "simple exact inequalities of the energy components ( such as @xmath123 ) have been proven in ground - state dft.@xcite if these are true in edft , experiences designing approximated @xmath63 in ground - state dft may be transferrable to edft .",
    "here we show that inequalities related to the correlation energy are still valid in edft .    due to the variational principle,@xcite the wavefunctions that minimize the ensemble energy eq .",
    "( [ eqn : theory : eensdef ] ) are the interacting wavefunctions @xmath124 .",
    "thus e=\\{_}-\\{}0 .",
    "[ eqn : theory : ecineq ] the existence of a non - interacting ks system@xcite means @xmath125 is the smallest possible kinetic energy for a given density @xmath13 , resulting in t = t_-t0 . [",
    "eqn : theory : tcineq ] from eq .",
    "( [ eqn : theory : ecineq ] ) and ( [ eqn : theory : tcineq ] ) we immediately obtain u = e - t0 , and |u||t| . these inequalities are later verified with exact ensemble ks calculations .",
    "since edft is a variational method , one expects that the virial theorem holds . a brief argument",
    "was given in ref . , but we provide a straightforward proof here .",
    "we apply the usual coordinate scaling on the wavefunctions:@xcite _ m,(_1,  ,_n)=^3n/2_m(_1, ",
    ",_n ) . according to the variational principle , the exact interacting wavefunctions @xmath124 minimize the ensemble energy @xmath126 for a given set @xmath12 .",
    "first - order variations of the ensemble energy therefore vanish .",
    "thus .\\{_,}|_=1=0 , where @xmath127 . since @xmath128 , we have .\\{_}(^2+_tot)}|_=1=0 , yielding 2t_[n_]+v_,[n_]=^3rn_()v ( ) .",
    "[ eqn : theory : virial : general ]    we can write the energy of an ensemble for a given set of weights @xmath12 and a given coupling constant @xmath129 as @xmath130=f_{\\wtset}^\\lambda[n]+\\int{\\mathrm{d}}^3r\\;n(\\br)v_{\\wtset}^\\lambda(\\br ) , \\label{eqn : theory : virial : e}\\ ] ] where @xmath131 is the @xmath12-dependent , one - body potential maintaining a constant density for all degrees of interaction.@xcite @xmath132 , and @xmath133 . the functional derivative of eq .",
    "( [ eqn : theory : virial : e ] ) with respect to @xmath134 is @xmath135 thus @xmath136=\\int{\\mathrm{d}}^3r\\;n(\\br ) \\br\\cdot\\nabla v_{\\wtset}^\\lambda(\\br ) .",
    "\\label{eqn : theory : virial : int}\\ ] ] applying the ensemble virial theorem of eq .",
    "( [ eqn : theory : virial : general ] ) to eq .",
    "( [ eqn : theory : virial : int ] ) yields @xmath137=f_\\wtset^\\lambda[n]+t_\\wtset^\\lambda[n].\\ ] ]    considering the ks quantities , we can insert the energy in terms of hartree - exchange - correlation and the @xmath129-dependent one - body potential into the general virial : @xmath138=-\\lambda e\\hxcwset^\\lambda[n]+\\lambda t\\cwset^\\lambda[n]+\\int d^3r\\;n(\\br)\\br\\cdot\\nabla v_{\\wtset}^\\lambda(\\br).\\ ] ] after this , set @xmath139 for the physical system , @xmath140=-e\\hxcwset[n]+t\\cwset[n]+\\int d^3r\\;n(\\br)\\br\\cdot\\nabla v_{\\wtset}(\\br),\\ ] ] and @xmath141 for ks , @xmath142=\\int d^3r\\;n(\\br)\\br\\cdot\\nabla v\\swset(\\br),\\ ] ] and subtract .",
    "this yields @xmath143=-e\\hxcwset[n]-\\int d^3r\\;n(\\br)\\br\\cdot\\nabla v\\hxcwset(\\br ) \\label{eq : theory : viral : hxc}\\ ] ] and @xmath144=-\\int d^3r\\;n(\\br)\\br\\cdot\\nabla v\\hxwset(\\br).\\ ] ] finally , the virial theorem for the correlation energy takes a similar form as in ground - state dft : t =- e - d^3rn()v ( ) .",
    "[ eqn : theory : virial : xc ]    energy densities have been important interpretation tools in ground - state dft , and here we provide similar tools for edft .",
    "the integrand of eq .",
    "( [ eq : theory : viral : hxc ] ) can be interpreted as an energy density , since integrating over all space gives    e+t&=d^3r(e+t ) + & = -d^3r  n()v ( ) ,    [ eqn : theory : virialengden ] which can easily be converted to an  unambiguous \" energy density.@xcite      ref .",
    "derived the ensemble derivative discontinuity of eq .",
    "( [ eqn : theory : dervdisc ] ) for bi - ensembles , in the limit of @xmath48 . for finite @xmath38 of an atomic system , as shown in our previous paper,@xcite @xmath51 is close to a finite constant for small @xmath50 , and jumps to 0 at some position denoted by @xmath145 .",
    "we provide the derivation of the location of @xmath145 as a function of @xmath38 here .    for atoms ,",
    "the homo wavefunction and lumo wavefunctions have the following behavior :    _ ( ) & ~a r^e^-r + _ ( ) & ~a r^e^- r ,    with @xmath146 . for the bi - ensemble of the ground state and the first excited state",
    ", the ensemble density is @xmath147 assuming that the homo is doubly - occupied .",
    "the behavior of the density at large @xmath50 is dominated by the density of the doubly - occupied homo and the second term . in order to see where the density decay switches from that of the homo to the lumo",
    ", we find the @xmath50-value at which the two differently decaying contributions are equal : ( 2-)a^2 r^2e^-2r = a^2 r^2e^-2r .",
    "as @xmath48 , @xmath145 is then rc- , with @xmath148 .",
    "the ionization energies are available for the he ground state and singlet excited state .",
    "since n()~e^-2re^-2r , we obtain rc-0.621 , 0 . for the he singlet bi - ensemble with @xmath38 close to 0 .      with weights as in eq .",
    "( [ eqn : theory : ogkens ] ) , calculation of the excitation energies is done recursively : for the @xmath149th excited state , one needs to perform an edft calculation with the @xmath149th state highest in the ensemble , and another edft calculation with the @xmath150th as the highest state , and so on .",
    "thus for the @xmath149th state , one needs to perform @xmath149 separate edft calculations for its excitation energy .    for bi - ensembles",
    ", however , the calculation of the excitation energy can be greatly simplified .",
    "( [ eqn : theory : exciteng ] ) holds for @xmath44 , so one can work with ground - state data only and obtain the first - excited state energy , without the need for an explicit edft calculation of the two - state ensemble .",
    "we calculate the first excitation energies of various atoms and ions with eq .",
    "( [ eqn : theory : exciteng ] ) at @xmath44 with both qlda@xcite ( based on lda ground states ) , exx,@xcite gpg,@xcite and sehx , with the last three based on oep - exx ( kli ) ground states.@xcite in order to ensure the correct symmetry in the end result , sehx must be performed on spin - restricted ground states . however ,",
    "for closed - shell systems , these results coincide with those of spin - unrestricted calculations .",
    "we use these readily available results when possible in this paper .",
    "the @xmath38-derivatives of the @xmath63 s for qlda and exx required in eq .",
    "( [ eqn : theory : exciteng ] ) are ( considering eq .",
    "( [ eqn : theory : fine : dexcdw ] ) ) _ 0.|_n = n _ = m_i ( e^[i=2,n]-e^[n ] ) , where @xmath151 is the ground - state lda functional , and @xmath152}{\\partial \\wt}\\right|_{n = n_\\wt } = \\int\\!\\!\\int\\frac{{\\mathrm{d}}^3r{\\mathrm{d}}^3r'}{{\\left|\\br-\\br'\\right| } } } \\nonumber\\\\ & & \\times\\bigg\\{\\left[\\sum_{j=1}^{n^\\uparrow}n_{j}(\\br,\\br')\\right ] \\left[n_\\text{h}(\\br,\\br')-n_\\text{l}(\\br,\\br')\\right ] \\nonumber\\\\ & &   -n_\\text{h}(\\br)n_\\text{l}(\\br')+n_\\text{h}(\\br,\\br')n_\\text{l}(\\br,\\br')\\bigg\\ } \\nonumber\\\\ & & + \\int{\\mathrm{d}}^3r\\;v\\xc(\\br)[n_\\text{h}(\\br)-n_\\text{l}(\\br ) ] , \\label{eqn : atomexx : dexcdw}\\end{aligned}\\ ] ] where @xmath153 sums over the spin - up densities .",
    "only ground state properties are needed to evaluate eq .",
    "( [ eqn : atomexx : dexcdw ] ) .",
    "the results are listed in table [ table : atomexx ] .",
    "sehx improves calculated excitation energies for systems where gpg has large errors , such as be and mg atoms .    .first",
    "non - triplet excitation energies ( in ev ) of various atoms and ions calculated with qlda , exx , gpg , and sehx functionals .",
    "qlda calculations were performed upon lda ( pw92)@xcite ground states ; exx@xcite ground states were used for the rest .",
    "asterisks indicate use of spin - restricted ground states .",
    "qlda relies on ground - state lda orbital energy differences ; it can not be used with the single bound orbital of lda he . [ cols=\"^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]      hooke s atom is a popular model system@xcite with the following external potential : v()=||^2 . for our calculation , @xmath154 .",
    "though the first excited state has cylindrical symmetry , we use a spherical grid , as it has been shown that the error due to spherical averaging is small.@xcite as a closed - shell system , the spatial parts , and therefore the densities , of the spin - up and spin - down ensemble ks orbitals have to be the same , so we treat this system as a bi - ensemble .",
    "the magnitude of the external potential of the hooke s atom is smallest at @xmath155 , and becomes larger as @xmath50 increases .",
    "this is completely different from the coulomb potential of real atoms .",
    "since the electron - electron interaction is still coulombic , @xmath156 can be expected to have a @xmath157 behavior as @xmath158 , which is negligibly small compared to @xmath19 .",
    "combined with a density that decays faster than real atomic densities , @xmath159 versus @xmath160 , convergence of the hooke s atom @xmath156 is difficult in the asymptotic region . additionally , @xmath161 for small @xmath50 , so larger discretization errors in this region also contribute to poorer inversion performance . despite these challenges ,",
    "we still obtain highly accurate excitation energies .",
    "a logarithmic grid with 550 points ranging from @xmath162 to @xmath163 is used for all the hooke s atom calculations . on this grid ,",
    "the exact ground- and first excited - state energies are e_1=54.42,e_2=64.19 .",
    "calculated @xmath164 was 9.786 ev for all values of @xmath38 tested ( see supplemental material ) .",
    "unlike the he atom and the 1d flat box , the @xmath26 and @xmath165 show little variation with @xmath38 ( see supplemental material ) .",
    "the second ks orbital of the hooke s atom is a @xmath101-type orbital , which has no radial node and a radial shape similar to that of the first ks orbital .",
    "consequently , the changes in the ks and xc potentials are also smaller .",
    "[ [ sect : results : he ] ] he ~~    using the methods in ref . , we employ a hylleraas expansion of the many - body wavefunction@xcite to calculate highly accurate densities of the first few states of the he atom .",
    "we report the exact ensemble xc potentials for he singlet ensemble in that paper .",
    "table [ table : he:3state ] shows accurate excitation energies calculated from mixed symmetry , three - multiplet , and strictly triplet ensembles , demonstrating the versatility of edft .    fig .",
    "[ fig : he : potxc : compare ] compares @xmath165 for four types of he equiensembles , highlighting their different features .",
    "the characteristic bump up in these potentials is shifted left in the 2-multiplet case , relative to the others shown .",
    "this shift has little impact on the first  shell \" of the ensemble density s shell - like structure , but the second is shifted left and has sharper decay , noticeably different from that of the singlet ensemble.@xcite    cccc + @xmath166 & 0.25 & 0.125 & 0.03125 + @xmath167 & 25.1035 & 22.4676 & 21.6502 + @xmath168/\\partial \\wt_2|_{n = n_{\\wt_2}}$ ] & -15.8099 & -7.9358 & -5.4351 + @xmath169 & 19.8336 & 19.8224 & 19.8385 +   + @xmath170 & 0.2 & 0.1 & 0.025 + @xmath171 & 26.8457 & 25.8895 & 25.2853 + @xmath172/\\partial \\wt_3|_{n = n_{\\wt_3}}$ ] & -0.9596 & -0.7207 & -0.5696 + @xmath173 & 20.6270 & 20.6184 & 20.6306 +   + @xmath38 & 0.16667 & 0.08333 & 0.02083 + @xmath174 & 2.8928 & 2.8956 & 2.8967 + @xmath175/\\partial \\wt|_{n = n_{\\wt}}$ ] & 0.0187 & 0.0104 & 0.0074 + @xmath176 & 2.8990 & 2.8990 & 2.8992 +    the inequalities shown in sec .",
    "[ sect : theory : inequ ] and the virial theorem eq .",
    "( [ eqn : theory : virial : xc ] ) are verified by the exact results .",
    "behaviors of the energy components for the singlet ensemble versus @xmath38 are plotted in fig .",
    "[ fig : he : singlet : ecomponents ] .",
    "correlation energies show strong non - linear behavior in @xmath38 . according to eq .",
    "( [ eqn : theory : exciteng ] ) , the excitation energies are related to the derivative of @xmath63 versus @xmath38 .",
    "therefore , @xmath76 is crucial for accurate excitation energies , even though its absolute magnitude is small .",
    "this paper is an in - depth exploration of ensemble dft , an alternative to tddft for extracting excitations from dft methodology . unlike tddft",
    ", edft is based on a variational principle , and so one can expect that the failures and successes of approximate functionals should occur in different systems than those of tddft .    apart from exploring the formalism and showing several new results , the main result of this work is to apply a new algorithm to highly - accurate densities of eigenstates to explore the exact edft xc potential .",
    "we find intriguing characteristic features of the exact potentials that can be compared against the performance of old and new approximations .",
    "we also extract the weight - dependence of the ks eigenvalues , which are needed to extract accurate transition frequencies , and find that a large cancellation of weight - dependence occurs in the exact ensemble .",
    "many details of these calculations are reported in the supplemental information .    from the original works of gross , oliviera , and kohn , ensemble dft",
    "has been slowly developed over three decades by a few brave pioneering groups , most prominently that of nagy .",
    "we hope that the insight these exact results bring will lead to a plethora of new ensemble approximations and calculations and , just possibly , a competitive method to treating excitations within dft .",
    "z .- h.y . and c.u .",
    "are funded by national science foundation grant no .",
    "a.p.j . is supported by doe grant de - fg02 - 97er25308 .",
    "j.r.t . and r.j.n .",
    "acknowledge financial support from the engineering and physical sciences research council ( epsrc ) of the uk .",
    "is supported by doe grant de - fg02 - 08er46496 .",
    "m.  e. casida .",
    "time - dependent density functional response theory of molecular systems : theory , computational methods , and functionals . in j.",
    "m. seminario , editor , _ recent developments and applications in density functional theory_. elsevier , amsterdam , 1996 .",
    "miquel huix - rotllant , andrei ipatov , angel rubio , and mark  e. casida .",
    "assessment of dressed time - dependent density - functional theory for the low - lying valence states of 28 organic chromophores .",
    ", 391(1):120  129 , 2011 .",
    "yang , , j.  r. trail , a.  pribram - jones , k.  burke , r.  j. needs , and c.  ullrich .",
    "exact ensemble density - functional theory for excited states .",
    "arxiv : 1402.3209 , submitted to _ phys .",
    "_ , 2014 .    m.  levy and j.p .",
    "hellmann - feynman , virial , and scaling requisites for the exact universal density functionals .",
    "shape of the correlation potential and diamagnetic susceptibility for atoms .",
    ", 32:2010 , 1985 .",
    "john  p. perdew , adrienn ruzsinszky , lucian  a. constantin , jianwei sun , and gabor  i. csonka . some fundamental issues in ground - state density",
    "functional theory : a guide for the perplexed .",
    ", 5(4):902908 , apr 2009 ."
  ],
  "abstract_text": [
    "<S> a new method for extracting ensemble kohn - sham potentials from accurate excited state densities is applied to a variety of two electron systems , exploring the behavior of exact ensemble density functional theory . </S>",
    "<S> the issue of separating the hartree energy and the choice of degenerate eigenstates is explored . </S>",
    "<S> a new approximation , spin eigenstate hartree - exchange ( sehx ) , is derived . </S>",
    "<S> exact conditions that are proven include the signs of the correlation energy components , the virial theorem for both exchange and correlation , and the asymptotic behavior of the potential for small weights of the excited states . </S>",
    "<S> many energy components are given as a function of the weights for two electrons in a one - dimensional flat box , in a box with a large barrier to create charge transfer excitations , in a three - dimensional harmonic well ( hooke s atom ) , and for the he atom singlet - triplet ensemble , singlet - triplet - singlet ensemble , and triplet bi - ensemble . </S>"
  ]
}