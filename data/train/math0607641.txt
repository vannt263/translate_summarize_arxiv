{
  "article_text": [
    "we consider a system of hamiltonian differential equations on @xmath0 @xmath1 defined by the hamiltonian function @xmath2 .",
    "we denote the time @xmath3 flow map of these equations by @xmath4 .",
    "the flow of these differential equations has two important features .",
    "the first is that @xmath5 is conserved along trajectories .",
    "that is , @xmath6 for all @xmath7 and all @xmath8 .",
    "the second is that phase space volume is conserved by the flow : if @xmath9 is a bounded open set , then @xmath10 for all @xmath3 .",
    "the latter property is a consequence of the symplecticity of the flow .",
    "( see , for example , @xcite ) .    for certain molecular dynamics applications , the ideal numerical integrator would retain these two properties of the flow @xcite .",
    "that is , if the integrator with time step @xmath11 defines a map @xmath12 on @xmath0 , we would like both @xmath13 for all @xmath14 ( energy conservation ) and @xmath15 for all bounded open subsets @xmath16 of @xmath0(volume conservation ) .",
    "symplectic integrators such as the implicit midpoint rule conserve volume exactly for all hamiltonian systems , with any number of degrees of freedom , but do not conserve energy @xcite .",
    "it has already been shown that in certain circumstances it is unreasonable to expect that symplectic integrators which also conserve energy exist @xcite . however , volume - conservation is a weaker property than symplecticity for hamiltonian systems of more than one degree of freedom ( @xmath17 ) .",
    "thus it seems plausible that there is a consistent integration scheme which for any hamiltonian function @xmath5 and time step @xmath11 yields a map @xmath12 which conserves both volume and energy .    in this article",
    "we will argue that there is no such integration scheme .",
    "we do this by showing that no numerical integrator is able to integrate _ all _ hamiltonian systems in @xmath18 while simultaneously conserving energy and phase space volume . for special hamiltonian systems in @xmath18",
    "such an integrator is possible .",
    "( see @xcite for examples of such systems of any number of degrees of freedom . ) however , our theorem states that for any energy - conserving numerical integrator from a very broad class , there will be at least one hamiltonian system on @xmath18 ( and in fact very many ) for which it does not conserve phase space volume .    before stating and proving our main theorem , in section  [ sec : integrator ] we will define what we mean by an integrator . from the class of integrators",
    "we then define the _ computationally reasonable _ integrators .",
    "this will include any explicit or implicit formula for defining a new state @xmath19 as a function of a state @xmath20 and a timestep @xmath11 such that the only information used about @xmath5 is its value and the value of its derivatives at a finite number of points @xmath21 , @xmath22 . in section  [ sec : main ] we will state and prove our main result in terms of this definition . we imagine that a numerical analyst has devised a computationally reasonable numerical integrator that is energy - conserving for all hamiltonian systems in @xmath18 .",
    "we apply this integrator to the system with hamiltonian function @xmath23 in @xmath18 . for two different inputs we observe",
    "at which points @xmath24 the integrator depends on the function @xmath5 and its derivatives . using this information",
    ", we construct another hamiltonian function @xmath25 which is arbitrarily close to @xmath5 and has the following property : the numerical integrator can not be volume - conserving for both @xmath5 and @xmath26 .",
    "the main result demonstrates that there is no integration scheme that conserves volume and energy for arbitrary hamiltonian systems of any number of degrees of freedom .",
    "however , we can not conclude that there is no scheme that is energy- and volume - conserving for hamiltonian systems in a particular number of dimensions @xmath27 , @xmath17 .",
    "this question is open . to partially address this issue , in section  [ sec : multi ]",
    "we will show that under some reasonable but not essential conditions on an integrator , the problem reduces to that of the @xmath28 case .",
    "thus , there is no energy- and volume - conserving integrator for fixed @xmath29 that satisfies these additional assumptions .",
    "we now explain the relation between the results here and those of the well - known paper of zhong and marsden @xcite . in that paper",
    "the authors consider a hamiltonian system for which there are no invariants except energy .",
    "they show that any integrator that is both symplectic and energy - conserving actually computes exact trajectories of the system up to a time reparametrization . from this result",
    "they conclude that energy - conserving symplectic integration is not possible in general , since presumably the set of hamiltonians for which one could compute trajectories exactly up to a time reparametrization are very small .",
    "though this argument is very plausible , it leaves open two questions :    1 .",
    "how do we make precise the idea of something not being possible for any numerical integrator ? 2 .",
    "is it possible to perform energy - conserving and symplectic integration for general hamiltonians when we restrict ourselves to the @xmath18 case ?",
    "the importance of the latter question is that if it were possible , then volume- and energy - conserving integration would be possible for general hamiltonian systems via @xmath30-splitting @xcite .",
    "we provide an answer to the first question in section  [ sec : integrator ] with the definition of a computationally reasonable integrator . as for the second question , since volume - conservation and symplecticity",
    "are identical in @xmath18 , zhong and marsden s result shows that in @xmath18 volume- and energy - conserving integration is equivalent to solving the original system exactly up to a time - reparametrization .",
    "( this result is stated and proved for this case as lemma  [ lem : reparam ] in section  [ sec : main ] . )",
    "the main result of our paper answers the second question in the negative by showing that it is not possible for general hamiltonian systems in @xmath18 using computationally reasonable integrators .",
    "before we begin we discuss some interesting related work . even though energy and volume conserving integrators may not exist",
    ", the paper @xcite does the next best thing .",
    "there the authors show how to approximate any hamiltonian function arbitrarily well by a special piece - wise smooth function of a form described by @xcite whose trajectories can be integrated while conserving volume and energy .",
    "the original hamiltonian function is not conserved .",
    "however , unlike for standard symplectic methods , a modified hamiltonian function close to the original is conserved exactly @xcite for all time .",
    "an integrator for a hamiltonian system of ordinary differential equations takes a hamiltonian @xmath5 , a step length @xmath11 , and an initial value @xmath31 , and produces a value @xmath32 .",
    "typically , @xmath19 depends on @xmath5 through components of @xmath33 and perhaps @xmath5 itself . if @xmath20 is an approximation to @xmath34 , we take @xmath19 to be an approximation to @xmath35 .    [",
    "defn : integrator ] an integrator @xmath36 is a function that takes arguments @xmath37 , @xmath38 , @xmath39 and either returns @xmath32 or is not defined .",
    "we write @xmath40    we have allowed the integrator to not be defined for certain input values .",
    "this is often the case for implicit integrators when the vector field is insufficiently smooth or the time step is too large .    in order to get meaningful constraints on what is computationally reasonable",
    ", we can not let arbitrary maps be included in the class of algorithms we study .",
    "after all , the exact flow map has all the qualitative features one could want , but it is not feasible to compute it ( even to machine precision ) for most applications .",
    "we would like our definition to be broad enough to include most existing numerical integrators .",
    "informally , we say an integrator @xmath36 is _ computationally reasonable _ if for each @xmath20 and @xmath11 , @xmath41 depends on @xmath5 only through its value and the value of its derivatives at a finite number of points @xmath21 , @xmath42 . in the following formal definition we use multi - index notation to define higher - order derivatives : for @xmath43 and @xmath44 we let @xmath45    [ defn : reasonable ] an integrator @xmath36 is _ computationally reasonable _ if for each @xmath46 , @xmath39 and @xmath47 there exists    1 .",
    "@xmath48 , 2 .",
    "@xmath49 , 3 .",
    "@xmath50 ,    such that for any function @xmath51 that satisfies @xmath52 either @xmath53 or both are not defined .    in the remainder of this section we discuss examples of the class of computationally reasonable integrators .",
    "first note that all explicit methods fit into this class .",
    "we informally define an integrator to be explicit if it can be implemented by an algorithm that terminates in a finite number of steps using function evaluations of @xmath5 or its derivatives , arithmetic operations , and logical operations .",
    "this includes all of the explicit runge - kutta and partitioned runge - kutta methods , for example .",
    "it also includes integrators that collect information adaptively to perform a step , such as the bulirsch - stoer method @xcite .",
    "taylor series methods are also included .",
    "the class of computationally reasonable integrators also includes implicit methods , such as the implicit runge - kutta methods .",
    "here we define an implicit method to be one where @xmath19 is specified by requiring it to be the solution to a nonlinear system of equations in @xmath5 and its derivatives .",
    "implicit algorithms can not in general be implemented exactly in a finite number of steps , but they still fit into the framework of definition  [ defn : reasonable ] . to see this , note that even though solving a system of nonlinear equations exactly typically requires looking at @xmath5 and its derivatives at an infinite number of points ( while performing the newton iteration , for example ) , determining if we have a solution to a nonlinear system of equations only requires examining a finite number of points .",
    "so if @xmath19 solves the equations for @xmath5 , it will still solve the equation for any @xmath26 which is identical to @xmath5 at the points .",
    "similarly , step - and - project methods are included in this class .",
    "these are methods that consist of one step of a simpler method followed by a projection onto a manifold ( * ? ? ?",
    "what integrators do not satisfy definition  [ defn : reasonable ] ?",
    "integrators that require the exact computation of integrals of @xmath5 or its derivatives do not . computing the integral of a general function",
    "requires knowing its value at an infinite set of points on the domain of integration . unlike in the case of solving nonlinear equations ,",
    "if we are given a value for the integral , there is no finite set of points at which we can examine the function to verify that the value is correct .",
    "of course , it is possible to define an numerical integrator that uses integrals of functions , but the actual computation of these integrals for general hamiltonian systems would require numerical quadrature .",
    "this in turn would require sampling the function at a finite number of points , and introducing truncation error .",
    "the new method with this additional truncation error does form a computationally reasonable integrator , while the original method with the exact integral does not .",
    "finally , we note that multistep methods are not even integrators according to definition  [ defn : integrator ] .",
    "we believe our framework could be extended to multistep method but we do not do so here .",
    "to prove our main result theorem  [ thm : main ] we use the following lemma .",
    "it shows that for a hamiltonian system in @xmath54 , the map defined by an energy and area preserving integrator is just a time - reparametrization of the flow map .",
    "as discussed in the introduction , this is essentially zhong and marsden s result @xcite in the two dimensional case .",
    "the only addition is that we show that the time - reparametrization is just a constant rescaling of time where locally the constant does not depend on energy .",
    "[ lem : reparam ] let @xmath55 be a smooth function and @xmath4 its induced hamiltonian flow map .",
    "let @xmath56 be a particular energy .",
    "let @xmath57 be an open set whose intersection with @xmath58 is a simple curve @xmath59 .",
    "suppose that @xmath60 on @xmath59 .",
    "let @xmath12 , @xmath61 be a continuous area - conserving map defined on @xmath57 that conserves @xmath5 . then there is a constant @xmath62 such that @xmath63 for all @xmath64 .",
    "* proof : * on @xmath57 we can define canonical action - angle coordinates @xmath65 in which the hamiltonian function is @xmath66 .",
    "the flow map is then @xmath67 where @xmath68 , since we still have @xmath69^t = \\nabla h \\neq 0 $ ] in the new coordinates . to study the jacobian of @xmath12 in the coordinates @xmath70",
    "we let @xmath71 for @xmath72 .",
    "then the jacobian of @xmath12 is @xmath73.\\ ] ] area conservation implies that the determinant is @xmath74 and so @xmath75 for all @xmath76 .",
    "this yields @xmath77 for all @xmath78 for some @xmath79 which may depend on @xmath80 .",
    "hence , if we choose @xmath62 so that @xmath81 we have @xmath82 for all @xmath83 , as required .",
    "@xmath84    for the main result we will use the following very weak definition of consistency .    [ defn : consistent ] let @xmath4 be the flow map for the hamiltonian @xmath46 .",
    "an integrator @xmath36 is consistent at @xmath8",
    "if @xmath85    [ thm : main ] let @xmath36 be an integrator for a hamiltonian system in @xmath18 . let @xmath86 .",
    "let @xmath57 be an open neighbourhood of @xmath87 .",
    "suppose :    1 .",
    "@xmath36 is consistent at @xmath88 ( definition [ defn : consistent ] ) .",
    "@xmath36 is computationally reasonable ( definition [ defn : reasonable ] ) .",
    "3 .   @xmath36 conserves energy for any @xmath5 , @xmath14 , and @xmath11 for which it is defined . 4 .   for @xmath89",
    ", @xmath90 is defined , depends continuously on @xmath14 , and conserves volume on @xmath57 .",
    "then for all sufficiently small @xmath11 there is a @xmath91 function @xmath92 such that if @xmath93 then @xmath94 is not simultaneously defined , continuous , and volume - conserving on @xmath57 . for each such @xmath11 ,",
    "the @xmath95 constructed can be replaced by @xmath96 for @xmath97 and the same result holds .",
    "* proof : * for any @xmath98 $ ] , since @xmath99 conserves energy and is continuous on @xmath57 , the set @xmath100 is mapped onto itself .",
    "as @xmath99 conserves volume , lemma  [ lem : reparam ] shows that it is identical to the flow of the original hamiltonian system on @xmath101 with a rescaling of time : @xmath102 for all @xmath103 , where @xmath62 does not depend @xmath104 .",
    "the consistency condition at @xmath88 implies that for small enough @xmath11 we have that @xmath105 . from now on , we assume @xmath11 is small enough so that @xmath105 .",
    "consider the integrator applied to @xmath5 at the point @xmath106 . since @xmath36 is computationally reasonable ( definition  [ defn : reasonable ] )",
    ", there are a finite number of points @xmath107 , @xmath22 , such that @xmath36 only depends on @xmath5 at these points .",
    "choose a @xmath108 big enough so that the interval @xmath109 $ ] contains none of the points @xmath110 and is disjoint from the interval @xmath111 $ ] .",
    "consider the integrator applied to @xmath5 at the point @xmath112 .",
    "there are points @xmath113 such that @xmath114 only depends on @xmath5 at these points .",
    "let @xmath95 be a @xmath115 function such that    1 .",
    "@xmath116 for @xmath104 not in @xmath117 $ ] , and @xmath118 , 2 .",
    "@xmath119 for all @xmath104 , 3 .   for some @xmath120 , @xmath121 for @xmath122 .",
    "note that multiplying @xmath95 by any factor in @xmath88 gives a function satisfying the same conditions .",
    "let @xmath123 and let @xmath124 denote the flow map of the system with this hamiltonian .",
    "now if @xmath94 were defined , continuous and volume - conserving on @xmath57 , then by lemma  [ lem : reparam ] @xmath125 for all @xmath126 for some constant @xmath127 . we will show that this is impossible .",
    "first note that the integrator gives the same result for both hamiltonians at @xmath88 .",
    "this is because here the result of the integrator only depends on @xmath5 only at the points @xmath128 , at which @xmath5 and @xmath26 agree .",
    "since @xmath129 we must have @xmath130 .    on the other hand , the integrators also give the same results for both hamiltonians at @xmath112 .",
    "this implies @xmath131 in the following way .",
    "we have that @xmath132 the inequality follows from lemma  [ lem : differ ] , since the hamiltonians differ on the interval @xmath133 $ ] .",
    "so @xmath131 .",
    "this is a contradiction .",
    "therefore , @xmath94 can not be simultaneously defined , continuous , and volume - conserving on @xmath57 .",
    "@xmath84    the following lemma asserts the intuitively clear fact that if @xmath134 is positive for @xmath135 $ ] then the flows starting from @xmath112 corresponding to @xmath5 and @xmath26 are different for positive times .    [",
    "lem : differ ] let @xmath136 be @xmath115 with @xmath137 , @xmath138 for all @xmath139 and @xmath121 for all @xmath135 $ ] .",
    "let @xmath140 and @xmath123 .",
    "let @xmath4 and @xmath124 be the respective hamiltonian flow maps of @xmath5 and @xmath26 .",
    "then @xmath141 for @xmath142 .    *",
    "the trajectory for the hamiltonian @xmath5 as a function of time is @xmath143 for all @xmath3 .",
    "letting @xmath144 describe the position for the hamiltonian @xmath26 , the usual solution technique gives @xmath145 the function @xmath146 is strictly increasing and so has a well defined inverse .",
    "we can write @xmath147 now @xmath148 for @xmath149 , so @xmath150 for @xmath151 .",
    "hence @xmath152 for @xmath151 and the two flow maps can not be equal for @xmath151 . @xmath84",
    "in the previous section we showed that there can be no general energy- and volume - conserving integration schemes because there are no integrators that conserve energy and volume for all hamiltonians in @xmath18 . however ,",
    "suppose we ask if such integrators exists for hamiltonian systems of dimension @xmath27 , @xmath17 .",
    "we conjecture that a result like theorem  [ thm : main ] still holds in this case . however , the method of proof for the @xmath28 case does not extend to this case .",
    "instead we will state two conditions on an integrator , either one of which prevents it from being volume- and energy - conserving for general hamiltonian systems in @xmath0 .",
    "both of these conditions are desirable for an integrator to have , but unlike computational reasonibility , it is not difficult to imagine a practical integrator that did not satisfy them .",
    "the proof of the theorems in this section will work by showing that , if a computational reasonable energy - conserving integrator with either condition exists , a special hamiltonian in @xmath0 can be constructed for which it does not conserve volume .            1 .",
    "@xmath36 is consistent ( definition 3 ) .",
    "@xmath36 is computationally reasonable ( definition 2 ) .",
    "3 .   @xmath36 conserves energy for any @xmath5 , @xmath14 and @xmath11 for which it is defined . 4 .",
    "@xmath36 satisfies condition  [ cond : untouch ] 5 .   for sufficiently small @xmath11 ,",
    "@xmath90 is defined , continuous , and conserves volume for @xmath164 .",
    "then for sufficiently small @xmath11 , there is a @xmath91 function @xmath92 such that if @xmath165 , then @xmath166 is not simultaneously defined , continuous , and volume - conserving on @xmath57 . for each such @xmath11 ,",
    "the @xmath95 constructed can be replaced by @xmath96 for @xmath97 and the same result holds .",
    "* proof : * we will use the hypothesized integrator on @xmath0 to construct an integrator @xmath167 on @xmath18 satisfying the conditions of theorem  [ thm : main ] .",
    "let @xmath55 be a given hamiltonian function .",
    "define @xmath168 by @xmath169 .",
    "we define the integrator @xmath167 by @xmath170 let @xmath171 be given by @xmath172 it is straightforward to check that @xmath167 satisfies the conditions of theorem  [ thm : main ] on @xmath173 .",
    "thus , by the theorem , we have an arbitrarily small @xmath115 function @xmath95 such that @xmath167 is not simultaneously defined , continuous , and volume - conserving on @xmath173 for @xmath174 .",
    "let @xmath175 for @xmath176 .",
    "now suppose that @xmath177 is defined , continuous , and volume preserving on @xmath57 .",
    "we will derive a contradiction by showing this implies that @xmath178 is , in fact , defined , continuous , and volume - conserving on @xmath173 .",
    "first note that @xmath177 being defined and continuous on @xmath57 implies that @xmath178 is defined and continuous on @xmath173 . to check volume conservation , note that the jacobian of the map @xmath177 has structure @xmath179\\ ] ] where we have put the variables in order @xmath180 and @xmath181 is a 2-by-2 matrix .",
    "since the determinant of this matrix is 1 by volume - conservation , the determinant of @xmath181 must be 1 .",
    "but @xmath181 is the jacobian of @xmath178 , so this latter map must be area preserving .",
    "this contradicts our earlier assumption . @xmath182",
    "the second condition states that if the hamiltonian system consists of @xmath29 identical uncoupled one - degree - of - freedom systems , then the integrator itself should consist of @xmath29 identical uncoupled maps on the state - space of each subsystem .      though this is certainly a nice property for the integrator to have ( since the flow map has the same property ) there are many integrators for which it does not hold .",
    "for example , step - and - project methods may not satisfy this condition , even if the underlying one - step method does .      1 .",
    "@xmath36 is consistent ( definition 3 ) .",
    "@xmath36 is computationally reasonable ( definition 2 ) .",
    "3 .   @xmath36 conserves energy for any @xmath5 , @xmath14 and @xmath11 for which it is defined .",
    "@xmath36 satisfies condition  [ cond : prod ] 5 .   for sufficiently small @xmath11 ,",
    "@xmath90 is defined , continuous , and conserves volume for @xmath164 .",
    "then for sufficiently small @xmath11 , there is a @xmath91 function @xmath92 such that if @xmath188 then @xmath166 is not simultaneously defined , continuous , and volume - conserving on @xmath57 . for each such @xmath11 ,",
    "the @xmath95 constructed can be replaced by @xmath96 for @xmath97 and the same result holds .",
    "* proof : * this theorem is proven analogously to the previous theorem . for any @xmath189 we define @xmath190 by @xmath191 .",
    "we define the integrator @xmath167 by @xmath192 we define @xmath193 by @xmath194 as in the proof of the previous theorem , @xmath167 and @xmath173 satisfy the conditions of theorem  [ thm : main ] .",
    "thus , by the theorem , we have an arbitrarily small @xmath115 function @xmath95 such that @xmath167 is not defined continuous and volume - conserving on @xmath173 for @xmath195 .",
    "now @xmath197 is defined and continuous on @xmath173 . to check volume conservation , note that the jacobian of the map @xmath177 in this case has structure @xmath198\\ ] ] where we have put the variables in order @xmath180 and",
    "each @xmath199 is 2-by-2 .",
    "since the determinant of this matrix must be 1 by volume - conservation and the determinants of the @xmath199 are identical , the determinant of @xmath181 must be @xmath200 . as in the proof of the previous theorem",
    "this implies @xmath178 is area conserving on @xmath173 which is a contradiction . @xmath182"
  ],
  "abstract_text": [
    "<S> we consider the numerical simulation of hamiltonian systems of ordinary differential equations . </S>",
    "<S> two features of hamiltonian systems are that energy is conserved along trajectories and phase space volume is preserved by the flow . </S>",
    "<S> we want to determine if there are integration schemes that preserve these two properties for all hamiltonian systems , or at least for all systems in a wide class . </S>",
    "<S> this paper provides provides a negative result in the case of two dimensional ( one degree of freedom ) hamiltonian systems , for which phase space volume is identical to area . </S>",
    "<S> our main theorem shows that there are no computationally reasonable numerical integrators for which all hamiltonian systems of one degree of freedom can be integrated while conserving both area and energy . before proving this result </S>",
    "<S> we define what we mean by a computationally reasonable integrator . </S>",
    "<S> we then consider what obstructions this result places on the existence of volume- and energy - conserving integrators for hamiltonian systems with an arbitrary number of degrees of freedom .    </S>",
    "<S> ordinary differential equations , numerical integration , hamiltonian systems , geometric integration , no - go theorems , volume - conservation , energy - conservation 65p10 </S>"
  ]
}