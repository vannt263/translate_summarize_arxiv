{
  "article_text": [
    "electric vehicles ( evs ) are emerging as a sustainable and environmentally friendly alternative to conventional vehicles , provided that the energy used for their charging is obtained from renewable energy sources .",
    "the energy generated from renewable sources such as sunlight , wind and waves is , however , dependent on weather conditions . as a consequence ,",
    "the electricity production from these sources is inherently uncertain in time and quantity .",
    "furthermore , electricity has to be produced and consumed at the same time , as the large - scale storage of the energy generated is , still today , very limited . as a result",
    ", the energy obtained from renewables may be wasted in times when the demand for electricity is not high enough to absorb it , with a consequent detrimental effect on the profitability of renewables . since the battery in an ev is basically a storage device for energy , the large - scale integration of evs in the transportation sector may contribute to substantially increasing the socioeconomic value of an energy system with a large renewable component , while reducing the dependence of the transportation sector on liquid fossil fuel .",
    "for this reason , evs have received increased interest from the scientific community in recent years ( detailed literature reviews of the state of the art can be found in @xcite and @xcite ) .",
    "special attention has been given to the analysis of the effect of evs integration on the electricity demand profile  @xcite , emissions  @xcite and social welfare @xcite , and to the design of charging schemes that avoid increasing the peak consumption @xcite , help mitigate voltage fluctuations and overload of network components in distribution grids  @xcite , and/or get the maximum economic benefit from the storage capability of evs within a market environment , either from the perspective of a single vehicle  @xcite or the viewpoint of an aggregator of evs  @xcite . in all these publications , though , and more generally in the technical literature on the topic , the charging problem of an ev is addressed either by considering deterministic driving patterns , when the focus is placed on the management of a single vehicle , or by aggregating the driving needs of different ev users , when the emphasis is on modeling a whole fleet of evs .",
    "this aggregation , however , obscures the dynamics of each specific vehicle .",
    "likewise , the deterministic driving patterns of a single ev are often based on expected values or stylized behaviors , which fail to capture important features of the charging problem such as the daily variation in the use of the vehicle or potential user conflicts in terms of not having the vehicle charged and ready for use .",
    "a stochastic model for driving patterns provides more insight into these aspects and becomes fundamental for applying a charging scheme in the real world . despite this , the stochastic modeling of driving patterns has received little attention from the scientific community , as pointed out in @xcite .",
    "we mention here the research work by @xcite , in which they aim to capture the uncertainty intrinsic to the vehicle use by means of a monte carlo simulation approach .",
    "they assume , however , an uncontrolled charging scheme .",
    "the work developed in this paper departs from the following two premises :    1 .",
    "the primary purpose of the battery of an ev is to provide power to drive the vehicle and not to store energy from the electricity grid .",
    "consequently , it is essential that enough energy is kept in the battery to cover any desired trip .",
    "this calls for a decision tool that takes into account the driving needs of the ev user to determine when charging can be postponed and when the battery should be charged right away .",
    "2 .   the complexity of human behavior points to a stochastic model for describing the use of the vehicle . in turn , this stochastic model should be integrated into the aforementioned decision tool and exploited by it .",
    "that being so , this paper introduces an algorithm to optimally decide when to charge an ev that exhibits a stochastic driving pattern .",
    "the algorithm builds on the inhomogeneous markov model proposed in @xcite for describing the stochastic use of a single vehicle .",
    "the model parameters are then estimated on the basis of data from the use of the specific vehicle .",
    "the approach captures the diurnal variation of the driving pattern and does not rely on any assumptions on the use of the vehicle , which makes it general and particularly versatile .",
    "our algorithm thus embodies a _ markov decision process _ which is solved recursively using a stochastic dynamic programming approach .",
    "the resulting decision - support tool allows for addressing issues related to charging , vehicle - to - grid ( v2 g ) schemes @xcite , availability and costs of using the vehicle .",
    "the algorithm runs swiftly on a personal computer , which makes it feasible to implement on an actual ev .",
    "the remainder of this paper is organized as follows : in section 2 the stochastic model for driving patterns developed in @xcite is briefly described , tailored to be used in the present work , and extended to address the problem of driving data limitations through hidden markov models .",
    "section 3 introduces the algorithm for the optimal charging of an ev as a markov decision process that is solved using stochastic dynamic programming .",
    "section 4 provides results from a realistic case study and explores the potential benefit of implementing v2 g schemes .",
    "section 5 concludes and provides directions for future research within this topic .",
    "in this section we summarize and extend the stochastic model for driving patterns developed in @xcite .",
    "we refer the interested reader to this work for a detailed description of the modeling approach .",
    "a state - space model is considered to describe the use of the ev . in its simplest form ,",
    "it contains two states , according to which the vehicle is either _ driving _ or _ not driving_. a more extensive version of the model would include a larger number of states which could capture information about where the vehicle is parked , how fast it is driving or what type of trip it is on .",
    "the basics of the general multi - state stochastic model are described in this section , including how to fit a specific model on an observed data set .",
    "let @xmath0 , where @xmath1 , be a sequence of random variables that takes on values in the countable set @xmath2 , called the state space . denote this sequence as @xmath3 .",
    "we assume a finite number , @xmath4 , of states in the state space .",
    "a markov chain is a random process where future states , conditioned on the present state , do not depend on the past states @xcite . in discrete time @xmath3",
    "is a markov chain if @xmath5 for all @xmath6 and all @xmath7 .",
    "a markov chain is uniquely characterized by the transition probabilities , @xmath8 , i.e. @xmath9 if the transition probabilities do not depend on @xmath10 , the process is called a homogeneous markov chain .",
    "if the transition probabilities depend on @xmath10 , the process is known as an inhomogeneous markov chain .",
    "when it comes to the use of a vehicle , it is appropriate to assume that the probability of a transition from state @xmath11 to state @xmath12 is similar on specific days of the week .",
    "thus , for instance , thursdays in different weeks will have the same transition probabilities .",
    "for convenience we further assume that all weekdays ( monday through friday ) have the same transition probabilities .",
    "these assumptions can be easily relaxed or interchanged with other assumptions and as such , are not essential to the model . with a sampling time in minutes , and taking into account that there are 1440 minutes in a day , this leads to the assumption : @xmath13 this assumption implies that the transition probabilities , defined by ( [ transprob ] ) , are constrained to be a function of the time , @xmath14 , in the diurnal cycle .",
    "let the matrix containing the transition probabilities be denoted by @xmath15 .",
    "for the model containing @xmath4 states the transition probability matrix is given by : @xmath16 where @xmath17 .",
    "now let @xmath18 define the number of observed transitions from state @xmath11 to state @xmath12 at time @xmath14 . from the conditional likelihood function , the maximum - likelihood estimate of @xmath19 can then be found as : @xmath20    a discrete time markov model can be formulated based on the estimates of @xmath21 .",
    "one apparent disadvantage of such a discrete time model is its huge number of parameters , namely @xmath22 , where @xmath23 parameters have to be estimated for each time step .",
    "needless to say , the number of parameters to be estimated increases as the number of states grows .",
    "we refer to @xcite for further details on techniques to reduce the number of parameters to be estimated for each time step for models with more than two states .",
    "another problem is linked to the number of observations available to properly carry out the estimation , i.e. if @xmath24 for some @xmath25 , then @xmath26 is undefined .    to deal with the large number of parameters as well as undefined transition probability estimates , b - splines are applied to capture the diurnal variation in the driving pattern through a _",
    "generalized linear model_. the procedure of applying a _ generalized linear model _ is implemented in the statistical software package r as the function ` glm(\\cdot ) ` . for a thorough introduction to b - splines see @xcite and for a general treatment of generalized linear models see @xcite . next we elaborate on how the fitting of the markov chain model works in our particular case .    each day , at a specific minute , a transition from state @xmath11 to state @xmath12 either occurs or does not occur .",
    "thus for every @xmath14 on the diurnal cycle we can consider the number of transitions to be binomially distributed , i.e. @xmath27 , where the number of bernoulli trials at @xmath14 , given by @xmath28 , is known and the probability of success , @xmath19 , is unknown .",
    "the data can now be analyzed using a _ logistic regression _ , which is a generalized linear model @xcite .",
    "the explanatory variables in this model are taken to be the basis functions for the b - spline .",
    "the logit transformation of the odds of the unknown binomial probabilities are modeled as linear combinations of the basis functions .",
    "we model @xmath29 and in particular , we are interested in @xmath30 = p_{jk}(s)$ ] .",
    "as the basis functions for the b - spline are uniquely determined by the knot vector @xmath31 , deciding the knot position and the amount of knots is important to obtain a good fit for the model .",
    "here we proceed as follows : first a number of knots are placed on the interval @xmath32 $ ] , with one at each endpoint and equal spacing between them .",
    "denote this initial vector of knots by @xmath33 .",
    "the model is then fitted using the basis functions as explanatory variables .",
    "next , the fit of the model between the knots is evaluated via the likelihood function and an additional knot is placed in the center of the interval with the lowest likelihood value . the new knot vector is then given by @xmath34 .",
    "we repeat this procedure until the desired number of knots is reached . to determine the appropriate number of knots and avoid over - parametrization , on the basis of a likelihood ratio principle , we test that adding a new knot does significantly improve the fit .",
    "standard markov models are limited in the sense that only those states that are actually observed can be modeled .",
    "thus , if the data at our disposal only provide information on when the vehicle is either _ driving _ or _ not driving _ , the standard markov model is restricted to two states . furthermore the time spent in each state",
    "is exponentially distributed , albeit with time - varying intensity , and accordingly , the time until the next transition does not depend on the time spent in the current state .",
    "this may be particularly unrealistic for a model with few states for describing driving patterns .    to overcome these limitations",
    ", we can use a hidden markov model , which allows estimation of additional states that are not directly observed in the data . in fact , we can estimate these states so that the waiting time in each state matches that which is actually observed in the data . adding a hidden state is done by introducing a new state in the underlying markov chain .",
    "the new state , however , is indistinguishable from any of the previously observed states .",
    "this allows for the waiting time in each observable state to be the sum of exponential variables , which is a more versatile class of distributions .",
    "it is worth insisting that the use of hidden markov models is justified here to address insufficient state information in our data , which only include whether the vehicle is _ driving _ or _ not driving_. indeed , the same results could be obtained using the underlying markov chain without hidden states , provided that the hidden states could be observed . in practice , though , more detailed driving data ( e.g. including driving speed and/or location of the vehicle ) could be available once the actual implementation is made on a vehicle , which in turn would avert the need for a hidden markov model . for a detailed introduction to hidden markov models ,",
    "see @xcite , where techniques and scripts for estimating parameters are also provided .",
    "the hidden markov model consists of two parts .",
    "firstly , an underlying unobserved markov process , @xmath35 , which describes the actual state of the vehicle . this part corresponds to the markov model with no hidden states as described previously .",
    "the second part of the model is a state - dependent process , @xmath36 , such that when @xmath0 is known , the distribution of @xmath37 depends only on the current state @xmath0 . a hidden markov model is thus defined by the state - dependent transition probabilities , @xmath8 , as defined for the standard markov chain and the state - dependent distributions given by ( in the discrete case ) : @xmath38 collecting the @xmath39 s in the matrix @xmath40 , the likelihood of the hidden markov model is given by : @xmath41 where @xmath42 is the initial distribution of @xmath43 .",
    "we can now maximize the likelihood of observations to find the estimates of the transition probabilities .",
    "the data at our disposal is from the utilization of a single vehicle in denmark in the period spanning the six months from 23 - 10 - 2002 to 24 - 04 - 2003 , with a total of 183 days .",
    "the data is gps - based and follows specific cars .",
    "one car has been chosen and the model is intended to describe the use of this vehicle accordingly .",
    "the data set only contains information on whether the vehicle was _ driving _ or _ not driving _ at any given time .",
    "no other information was provided in order to protect the privacy of the vehicle owner .",
    "the data is divided into two periods , a training period for fitting the model from 23 - 10 - 2002 to 23 - 01 - 2003 , and a test period from 24 - 01 - 2003 to 24 - 04 - 2003 for evaluating the performance of the model .",
    "the data set consists of a total of 749 trips .",
    "the time resolution is in minutes .",
    "we shall consider a model with one _ not driving _ state and several ( hidden ) _ driving _ states .",
    "that is , it is observable if the vehicle is driving , but not the specific driving state . to fit the model to the data , we assume that only the transition probability from the _ not driving _ state depends on the time of day .",
    "this is done to reduce the complexity of the estimation procedure , as it is cumbersome to estimate the time - varying parameters of a hidden markov model .",
    "it is worth noting that a hidden markov model allows for the probability of ending the current trip to depend on the time since departure , as the vehicle may pass through different driving states before ending the trip .",
    "we now elaborate on the fitting of the hidden markov model , which is split into estimation of its time - varying and time - invariant parameters .",
    "we need to estimate the probability of a transition from the vehicle being parked to a driving state .",
    "we denote this transition estimate by @xmath44 .",
    "it holds that @xmath45 .",
    "since both the parked state and the transitions from it are directly observable in the data , we can use the procedure described in section 2.1 to estimate @xmath44 .",
    "+    the data have been divided into two main periods : weekdays and weekends . the observed number of trips starting every minute for the weekdays is displayed in fig .",
    "[ startingweekdays ] .",
    "a high degree of diurnal variation is found , with a lot of trips starting around 06:00 and again around 16:00 . also , there are no observations of trips starting between 00:00 and 05:00 .",
    "other patterns are found for weekends , but as these do not involve any methodological difference , we limit ourselves to trips starting on weekdays .",
    "annual variations may also be present , however the limited data sample does not allow for capturing such seasonality .",
    "based on the b - splines and the logistic regression , plotted as the black line over the estimates @xmath44 from ( [ p_hat ] ) , in gray .",
    "the red bars indicate the knot positioning.__,scaledwidth=80.0% ]    the plot in fig .",
    "[ transitionprobability ] illustrates the estimate of @xmath44 using b - splines with eight initial knots placed uniformly on the interval and 22 knots in total .",
    "the time - invariant parameters are to be estimated so that an appropriate probability distribution is fitted to the duration of the trips .",
    "the time - invariant parameters are estimated by maximizing the likelihood given in ( [ eq : hmm likelihood ] ) . for a given number of _ driving _ states",
    ", the transition probabilities can be estimated using the approach in @xcite .",
    "once a model with @xmath4 states is fitted , we can test if adding an additional state significantly improves the fit . as a model with @xmath4 states is a sub - model of one with @xmath46 or more states , we increase the number of states until no significant improvement test is observed according to the likelihood ratio .",
    "[ triplength ] represents the histogram of the empirically observed trip lengths along with the theoretical density function of the trip lengths obtained from the fitted model .",
    "we use a model with two driving states , as no significant improvement is found beyond this number .",
    "notice that the distribution of the empirically observed trip lengths is adequately captured by the hidden markov model , although the number of observed trips in the range from 10 to 20 minutes has a higher prevalence than the fitted distribution . in practical applications ,",
    "more information could be available to model the behavior of the vehicle ( e.g. its location and speed ) , which should facilitate the modeling of the driving patterns .    in the following section ,",
    "the algorithm for optimally charging the ev is presented .",
    "the optimization algorithm makes use of the transition probabilities characterizing the stochastic model for the driving patterns .",
    "thus , the optimization algorithm is designed to handle the stochastic nature of the driving needs .",
    "the problem of charging an ev can be posed as a conflict between two opposing objectives .",
    "the end - user desires to have the vehicle charged and ready for use at his / her discretion , while also minimizing the costs of running the vehicle .",
    "demand for electricity varies over the day and so does the electricity generated from renewable sources .",
    "this introduces a varying energy price which can make it beneficial for the end - user to postpone charging his / her vehicle .",
    "this means the user is faced with the problem of postponing charging to minimize costs or to charge right away so as to maximize the availability of the vehicle .",
    "the algorithm for optimal charging of the ev is formulated as a stochastic dynamic programming problem .",
    "we first define the relevant parameters and variables , and then the state - transition and objective function .      [ cols= \"",
    "< \" , ]     let us consider first the strategies in tab .",
    "[ tab : outofsample ] under which only charging is allowed , we see that there are no observed events of not having enough charge on the battery to complete a trip . also , we notice , as expected , that the optimal charging strategies have lower costs than the `` rule of thumb '' policies .",
    "the low - price charging strategy is indeed the `` rule of thumb '' policy that approximates closest to the optimal policy in terms of costs and availability .",
    "it yields , however , an average daily cost which is around 12 - 24% higher than that obtained from implementing the proposed decision - support tool .    as for the charging policies that include v2 g operation mode , it becomes apparent that caution should be exercised to prevent the vehicle from being fully discharged when the end - user desires to drive . in this",
    "line , notice that increasing the penalty reduces the number of observed events of not having enough charge on the battery to cover a desired trip . introducing a v2 g charging scheme allows for substantially reducing the cost associated with driving as opposed to charging - only schemes , and may even result in negative average costs .",
    "observe that the optimal charging policy developed in this paper clearly outperforms the `` rule of thumb '' v2 g schemes . in the unbounded case , charging costs are substantially reduced , but multiple out - of - battery events are recorded .",
    "imposing a lower bound on the discharging solves this problem , but at the expense of considerably increasing the running cost of the vehicle , to such an extent that it nearly doubles .    the difference in performance between the optimal charging strategy and the `` rule of thumb '' policies",
    "can be expected to become larger for electric vehicles covering higher distances or with lower battery capacity .",
    "lastly , we would like conclude this section by pointing out that , in general , the spot price is not the price observed by the end - user .",
    "indeed , the end - user faces a price that includes taxes and other costs on top of the spot electricity price . as an example , consider a country like denmark , where the average price of electricity paid by the end - user , including taxes and fees , is around  300 /mwh , which is 5 - 10 times the average spot price @xcite . in the current danish power system ,",
    "fees and taxes are imposed on the amount of electricity consumed by the end - user , not on its total cost .",
    "this does not encourage the end - user to switch to a smart consumption of energy based on variable prices .",
    "in fact , if the taxes and fees were implemented as a function of the total energy cost , the savings from switching to a smart charging policy in denmark could be multiplied by a factor of between five and ten .",
    "this paper proposes an algorithm to optimally charge an electric vehicle based on stochastic dynamic programming .",
    "the algorithm is built on an inhomogeneous ( hidden ) markov chain model that characterizes the stochastic use of the vehicle .",
    "the algorithm determines the optimal charging policy depending on the use of the vehicle , the risk aversion of the end - user , and the electricity price .",
    "the costs associated with running the vehicle are decreased significantly when the charging strategy is determined by the proposed optimization model , with little or no inconvenience to the end - user .",
    "these costs can be reduced even further if the vehicle is permitted to supply power into the grid .",
    "indeed , findings show the possibility of making a net profit from running the vehicle . the proposed stochastic dynamic programming model is versatile and can easily be adapted to any specific vehicle , thus providing a customized charging policy .",
    "a possible extension would be to apply the proposed model to data with more markov states , which could be used to investigate the benefits of installing more public charging stations as opposed to home charging , or to capture different driving states such as `` urban '' , `` rural '' , or `` highway '' .",
    "in addition , the model could be enhanced to consider transition probabilities that are estimated adaptively in time .",
    "an adaptive approach would capture structural changes in the driving behavior , such as variations over the year or a change in use that could follow , for example , from the householder buying an additional vehicle .",
    "moreover , adaptivity is relevant for applying the model in practice",
    ".    further research could be also directed at modeling a fleet of vehicles by using a mixed - effects model . the optimization scheme could be applied individually to each vehicle and the total population load could be evaluated .",
    "this would highlight if and how evs could be used to mitigate an increase in peak electricity demand when switching from combustion - based vehicles to evs .",
    "other investigations could focus on the relationship between evs and renewable energy sources and how evs could be used to move the excess production to time periods of high demand , possibly making renewables more economically competitive .",
    "dsf ( det strategiske forskningsrd ) is to be acknowledged for partly funding the work of emil b. iversen , juan m. morales and henrik madsen through the ensymora project ( no .",
    "10 - 093904/dsf ) .",
    "furthermore , juan m. morales and henrik madsen are partly funded by the ipower platform project , supported by dsf ( det strategiske forskningsrd ) and rti ( rdet for teknologi og innovation ) , which are hereby acknowledged .",
    "finally , we thank dtu transport for providing the data used in this research .",
    "23 natexlab#1#1[1]`#1 ` [ 2]#2 [ 1]#1 [ 1]http://dx.doi.org/#1 [ ] [ 1]pmid:#1 [ ] [ 2]#2 , , , , in : , , pp . . , , , ( )",
    ", , , , ( ) . , , ( ) .",
    ", , , in : , , pp . . , , , in : , , , pp . .",
    ", , , ( ) . , , , , , california institute of technology , . .",
    ", , , , in : , , pp . . , , , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , , ( ) .",
    ", , , , in : , , pp . . , , , , , in : , , pp . . , , , , , , technical university of denmark , . .",
    ", , , ( ) . , , , texts from oxford university press , , . , , , , springer series in statistics , , .",
    ", , , chapman & hall / crc texts in statistical science , , . , , , monographs on statistics and applied probability , , ."
  ],
  "abstract_text": [
    "<S> the combination of electric vehicles ( evs ) and renewable energy is taking shape as a potential driver for a future free of fossil fuels . </S>",
    "<S> however , the efficient management of the ev fleet is not exempt from challenges . </S>",
    "<S> it calls for the involvement of all actors directly or indirectly related to the energy and transportation sectors , ranging from governments , automakers and transmission system operators , to the ultimate beneficiary of the change : the end - user . </S>",
    "<S> an ev is primarily to be used to satisfy driving needs , and accordingly charging policies must be designed primarily for this purpose . </S>",
    "<S> the charging models presented in the technical literature , however , overlook the stochastic nature of driving patterns . here </S>",
    "<S> we introduce an efficient stochastic dynamic programming model to optimally charge an ev while accounting for the uncertainty inherent to its use . with this aim in mind , </S>",
    "<S> driving patterns are described by an inhomogeneous markov model that is fitted using data collected from the utilization of an ev . </S>",
    "<S> we show that the randomness intrinsic to driving needs has a substantial impact on the charging strategy to be implemented .    electric vehicles , driving patterns , optimal charging , markov processes , stochastic dynamic programming , </S>"
  ]
}