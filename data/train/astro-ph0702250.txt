{
  "article_text": [
    "the complex aperiodic variability of high - energy emission shown in different time scales is a common character for x - ray binaries and super massive black holes .",
    "temporal analysis is an important approach to study undergoing physics in objects from observed light curves .",
    "the spectral lag between variation signals in different energy bands provides useful information on their producing and propagating processes in celestial objects . besides the time lag ,",
    "the spectral coherence , a measure of the degree of linear correlation between two light curves in different energy bands , is another useful quantity to provide constraints on models of physical processes in observed objects . for studying variability coherence in the frequency domain , the coherency function ",
    "the normalized average amplitude of the cross power density as a function of fourier frequency  can be used .",
    "vaughan and nowak ( 1997 ) have presented a procedure for estimating the coherence function in the presence of counting noise , which has been applied to studying black hole candidates ( e.g. nowak & vaughan 1996 ; vaughan & nowak 1997 ; cui , zhang & chen 2000 ; nowak et al .",
    "2001 ; nowak , wilms & dove 2002 ; ji et al .",
    "2003 ) .",
    "the time domain quantity corresponding to the coherence in the frequency domain is the coefficient of linear correlation between two light curves in different energy bands .",
    "the correlation coefficient has not been extensively applied in temporal analysis as the coherence function in the frequency domain .",
    "one of the reasons is that the variability is caused by various physical processes at different timescales , a single value of correlation coefficient from two observed light curves is not enough to provide measures of association between complex variables .",
    "what needed is a distribution of correlation coefficient over timescales . here",
    "we present a procedure for deriving the coherence spectrum in the time domain , or a timescale spectrum of the correlation coefficient for a complex process in the presence of background noise and compare the coherence spectrum in the time domain with the fourier frequency - dependent function of coherence by simulation in  2 . in our simulation ,",
    "the result from the time domain technique is consistent with the coherence function obtained from the fourier analysis when the signal to noise ratio is high . in general , the time domain technique can provide a more accurate and stable result than the fourier analysis .",
    "we apply the time domain technique to the black hole x - ray binaries cygnus x-1 and gx 339 - 1 and present the results in  3 and give discussion on timelag effect in  4 .",
    "a proper statistic for measuring the degree of linear correlation between variations in two @xmath0-point signal counting series @xmath1 and @xmath2 is their correlation coefficient @xmath3 for two observed lightcurves @xmath4 and @xmath5 with independent noise @xmath6 and @xmath7 respectively , we have @xmath8 and @xmath9 then the signal s correlation coefficient can be calculated as @xmath10 it should be pointed out that one can not take two so called `` background - subtracted lightcurves '' as signal s lightcurves @xmath11 and @xmath12 to calculate the correlation coefficient simply by eq .",
    "( 1 ) , because background lightcurves given by a database are usually smoothed curves not including the fluctuation of real noise at shorter timescales .",
    "we apply a timescale analysis technique ( li , feng & chen 1999 ; li 2001 ; li et al .",
    "2004 ) to calculate correlation coefficients for different timescales from two observed lightcurves . from an original lightcurve @xmath13 with a time resolution @xmath14",
    ", we can construct @xmath15 different lightcurves with the same larger time step @xmath16 by combining @xmath15 successive bins @xmath17 where the combination starts from the @xmath18th bin of the original lightcurve . from two",
    "simultaneously observed counting series @xmath19 and @xmath20 , the correlation coefficient @xmath21 for a certain timescale @xmath22 can be calculated by @xmath23 the total observation period is divided into @xmath24 segments .",
    "the correlation coefficient @xmath25 is calculated by eq .",
    "( 4 ) for a pair of lightcurves on each time segment @xmath26 separately . the average @xmath27 and its standard deviation @xmath28 are defined as the coherence coefficient for the timescale @xmath29 and its error .    to check the procedure described above and compare it with the fourier coherence function we produce two 1000 s signal time series , @xmath11 and @xmath12 , with time bin @xmath30  ms sampled from a two - dimensional normal distribution @xmath31\\right\\}~,\\end{aligned}\\ ] ] where @xmath32 are means and standard deviations of @xmath11 and @xmath12 respectively , and @xmath33 is the correlation coefficient between @xmath11 and @xmath12 . by giving these parameters in eq .  ( 5 ) , we are able to produce two signal time series with a certain correlation coefficient .",
    "to simplify , we specify @xmath34 , @xmath35 .",
    "the correlation coefficient @xmath33 in eq .",
    "( 5 ) is the theoretical value of coherence , and it is used to compare with results of time domain coherence and fourier coherence function .",
    "we add independent poisson noise @xmath6 and @xmath7 on the signal series @xmath11 and @xmath12 respectively to get simulated lightcurves @xmath36 and @xmath37 .",
    "different signal to noise ratio ( snr ) could be set by adjusting the mean of independent poisson noise .",
    "the simulated lightcurve is divided into ten segments , each has a length of 100 s. for each segment , coherences at different timescales are calculated by eq .",
    "( 4 ) and fourier coherence coefficients at different frequencies are also computed with the procedure described by vaughan and nowak ( 1997 ) .",
    "finally , the average and its standard deviation are computed from the ten time domain coherences and fourier coherence coefficients separately .",
    "figure  1 shows coherence spectra from simulated light curves with @xmath38 and snr = 5 , 2 and 1 separately , where fourier coherence function in the frequency domain are transformed into the time domain by @xmath39 . from fig .",
    "1 we can see that , in comparing with fourier coherence functions , time domain coherence distributions are more consistent and accurate . for the case of low snr",
    ", fourier coherence functions fluctuate seriously and have a large error bar , while the time domain procedure has a better capability to reveal a given coherence , especially at short timescales .",
    "figure 2 show the results for a certain snr = 1 and different @xmath40 , 0.8 and 0.6 respectively , indicating that the time domain procedure is more powerful to reveal lower measured coherence .    the test and comparison are extended to different signal distributions other than the binormal one .",
    "the joint probability density function of binormal distribution can be factorized into two factors @xmath41 where @xmath42~,\\ ] ] and @xmath43~.\\ ] ] the first factor @xmath44 of eq .",
    "( 6 ) is a one - dimensional gaussian density function of the variable @xmath45 which is independent of @xmath46 .",
    "the second factor @xmath47 is also a gaussian density but with average @xmath48 , standard error @xmath49 and the correlation coefficient @xmath33 between x and y , which can be seen as a conditional density of @xmath46 given @xmath45 . with eq .",
    "( 6 ) we can produce a pair of time series with a given correlation coefficient @xmath33 with a density function @xmath44 different to gaussian by sampling @xmath45 from the density @xmath44 and @xmath46 from the density of eq .",
    "the exponential distribution , uniform distribution and poisson distribution are adopted as @xmath44 to produce correlated pairs of time series separately , and then compute their coherence distributions in the time domain and their fourier correlation functions .",
    "all results are similar with fig .  1 and fig .  2 , showing that the time domain procedure is an effective approach to coherence analysis .",
    "here we apply the time domain technique of coherence analysis to two black hole candidates , cyg x-1 in the low state and gx 339 - 4 in the low and high states .",
    "we use observational data from pca/@xmath50 .",
    "pca/@xmath50 observation has dead time @xmath51 much smaller than time resolution 1ms of original lightcurves we use in this paper . and for cyg x-1 , dead - time affection is about @xmath52 ( maccarone and coppi 2000 ) , so it could be ignored .",
    "variabilities in lightcurves observed for an astronomical object are usually caused by various processes at different timescales with different coherences .",
    "the coherence coefficient @xmath21 calculated by eq .",
    "( 4 ) reflects not only the variation property on the timescale @xmath29 , but is also affected by that on larger ones up to the total time period used in the calculation . to limit the effect of larger timescales we divide the total observation period into segments , each has a duration just 10@xmath29 .",
    "the resultant correlation coefficient should be then related to the limited time scale region of @xmath53 .    in our calculation for cyg x-1 and gx 339 - 4 data , for a given time bin @xmath29 the studied observation period is divided into segments with a duration of 10@xmath29 each and the coherence coefficient is calculated for each segment by using eq .",
    "the all segments are divided into ten groups with the segment numbers in each group being nearly equal to each other .",
    "we calculate 10 avarage coherence coefficients @xmath25 for each group @xmath54 respectively and take their average @xmath55 and the standard deviation @xmath56 $ ] as the final result of the observation .",
    "the fourier coherence coefficients and their average and the standard deviation of the average are also calculated from the 10 time groups .",
    "the results are shown in figure 3 .",
    "for both cyg x-1 and gx 339 - 4 in the low state shown in the left and middle panels of fig .  3 , both fourier coherence and time domain coherence show similar trend of change from near - perfect coherence at large time scale to low coherence at small time scale .",
    "two other black hole candidates , xte j1550 - 564 ( cui , zhang and chen 2000 ) and grs 1915 + 105 ( ji et al . 2003 ) , have fourier coherence function with near - unity coherence at large time scale and low coherence at small time scale .",
    "we also apply the time domain technique to these sources and get similar results . as the coherence is much more easily to be lost than maintained , only when one linear physical process is involved could coherence be preserved ( vaughan & nowak 1997 ) . any nonlinear process or",
    "more than one independent linear processes involved could degrade coherence .",
    "the near - perfect coherence at large time scale may provide a strong evidence that there is a powerful physical process in these sources with a large characteristic timescale dominates the emission of photons in the studied energy bands .",
    "it is a remarkable feature that all the values of time domain coherence are very low in the whole studied timescale range for gx 339 - 4 in the high state , shown in the right panel of fig .  3 , indicating that there is only little relationship between variabilities of 2 - 5 kev and 5 - 7 kev emissions of gx339 - 4 in its high state .    to see whether the relationship between variabilities of two light curves coincides with the time domain coherence computed from them , we simultaneously plot two observed light curves of cyg x-1 in two energy bands for different time scales at the same time period , shown in figure  4 . from fig .  4",
    "one can see that the time domain coherence calculated by eq .",
    "( 4 ) can reflect the real strength of the linear relationship between two light curves .",
    "the fourier coherence function @xmath57 of two lightcurves @xmath45 and @xmath46 is defined in the space of fourier frequency @xmath58 where , @xmath59 and @xmath60 are the fourier transforms of @xmath45 and @xmath46 respectively , the cross spectrum @xmath61 , and angle brackets denote an average over the used segments of light curve .",
    "if the ratio of two fourier transforms at a frequency @xmath62 , @xmath63 , is the same for all segments of the two processes , or , equivalently @xmath64 then @xmath65 , the processes are said to be coherent at frequency @xmath62 .",
    "but the unit coherence in the time domain , @xmath66 , indicates a linear correlation between the variabilities of intensity in the two energy bands on the timescale @xmath29 @xmath67 where @xmath68 is a constant during the observation period @xmath69 , which is a stronger constraint than eq .",
    "( 10 ) from an unit coherence , @xmath65 , in the frequency domain .",
    "it is an advantage for fourier coherence function that it can obtain coherence at all frequencies simultaneously and exactly , because amplitude at all frequencies could be obtained independently from fourier transformation of original lightcurve .",
    "improved fourier coherence function ( vaughan & nowak 1997 ) can calculate coherence of noisy lightcurves and uncertainty as well . while the coherence coefficient calculated in the time domain by eq .",
    "( 4 ) can be confined in only a timescale region , @xmath70 with @xmath0 being the number of time bins in a calculated time segment , and the error of the average coherence coefficient is estimated by the statistical deviation in coherence coefficients of different time segments .",
    "spectral time lags are usually existed in observed processes . to calculate the time domain coherence @xmath21",
    ", one should firstly derive their timescale spectrum of time lag , then make time lag correction for light curves at the timescale @xmath29 .",
    "but , in practice , the coherence derived by the time domain technique is not sensitive to the spectral time lag in analyzing real observational data . from lightcurves of cyg x-1 in its low state in energy band 2 - 5 kev and 5 - 13 kev observed by pca/@xmath50 ,",
    "we use the modified cross - correlate function ( mccf ) ( li , feng & chen 1999 ; li et al . 2004 ) to calculate the spectral time lag , the result is similar to what obtained from fourier analysis ( nowak et al 1999 ) .",
    "then we calculate time domain coherences between the two lightcurves with and without time lag correlation separately . the result shown in fig .",
    "5 does not indicate any essential effects of the spectral lag on the time domain coherence . to see how seriously time lag could affect results of time domain coherence",
    ", we make a modification to the original observed lightcurves to produce an artificial deviation : the band 5 - 13 kev lags behind the band 2 - 5 kev by 10 times of time lag measured from the observed lightcurves by mccf , then calculate time domain coherences between the modified lightcurves . as we can see in fig .  5 , only a litter deviation can be found between the result from the original lightcurves and the modified ones .",
    "we also test other data used in this paper to see whether fig .",
    "5 is only an exception , the results turns out to be that although the spectral time lag exists in most data , it has just little influence to the coherence obtained by the time domain technique .    to understand reasons of insensitivity of time domain coherence to spectral timelag in observed x - ray data",
    ", we make simulation studies .",
    "two 1000 s lightcurves with 1 ms time bin and a given correlation coefficient @xmath38 ( or expected coherence @xmath71 ) are produced by sampling from the two - dimensional normal distribution eq .",
    "( 5 ) described in  2 .",
    "one of the lightcurves is then artificially shifted by 10 ms .",
    "we use mccf to derive timescale distribution of time lags and calculate time domain coherences between the two lightcurves with and without timelag correction .",
    "the results are shown in the left panel of figure  6 .",
    "we can see that , though the effect of spectral timelag can not be neglected in general , the difference of coherences obtained with and without timelag correction is small at large timescale . for deriving time domain coherences at large timescales , we need to reconstruct original lightcurves with a larger time bin ( see the details in  2 ) , which impairs the effect of a timelag which is much smaller than the time bin .",
    "spectral timelags measured at a timescale are usually much shorter than the timescale itself .",
    "for example , the x - ray time lag of cyg x-1 between 2 - 5 kev and 5 - 13 kev at the timescale of 1 s ( or frequency of 1 hz ) is only about 10 ms . from the left panel of fig .",
    "6 we can see that the effect of timelag on time domain coherence is small when timelag is much smaller than time bin .",
    "the correlation existed in successive time bins in observed lightcurves may be another reason of the insensitivity of time domain coherence to spectral timelag in observed x - ray data .",
    "the right panel of fig .  6 shows results from two simulated lightcurves based on shot model with 10 ms timelag .",
    "we produce a 1000 s lightcurve with 1 ms time bin consisted of random shots similar to what observed from cyg x-1 ( feng , li & chen 1999 ) . the front of the shot",
    "is represented by a single exponential and the time constant of both ascending and descending front is 70 ms .",
    "the interval between two successive shots follows an exponential distribution with an average of 450 ms .",
    "the above produced lightcurve is shifted by 10 ms to create the second one .",
    "the right panel of fig .",
    "6 shows coherence spectra derived by the two lightcurves with and without timelag correction . from fig .",
    "6 we see that the timelag effect on time domain coherence for lightcurves produced by shots ( right panel ) is much smaller than that for lightcurves sampled from two - dimensional normal distribution ( left panel ) .",
    "this is because successive bins in a lightcurve consisted of shots have a strong connection .    in summary ,",
    "we propose a time domain technique in this paper to calculate variability coherence for different timescales . in general ,",
    "the time domain coherence distribution is consistent with the fourier coherence function , but more reliable for the case of low signal to noise ratio and more powerful to reveal lower coherence . in practical data analysis ,",
    "the effect of spectral time lags on the time domain coherence can be neglected .",
    "this technique provides an useful tool for temporal analysis .",
    "the referee is thanked for helpful comments and suggestions .",
    "this research was supported by the national natural science foundation of china and made use of data obtained through the high energy astrophysics science archive research center online service , provided by the nasa / goddard space flight center .",
    "bendat , j. , & piersol , a. 1986 , random data : analysis and measurement procedures cui w. , zhang s.n .",
    "& chen w. 2000 , , 531 , l45 feng y.x . ,",
    "& chen l. 1999 , apj , 514 , 373 ji j.f . , zhang s.n .",
    ", qu j.l . &",
    "2003 , , 584 , l23 li t.p .",
    "2001 , , 1 , 313 ; astro - ph/0109468 li , t.p . , feng y.x .",
    "& chen l. 1999 , , 521 , 789 li t.p . , qu j.l .",
    ", feng h. , song l.m .",
    ", ding g.q .",
    "& chen l. 2004 , , 4 , 583 ; astro - ph/0407458 maccarone , t.j & coppi , p.s .",
    "2000 , , 537 , l107 nowark , m.a . &",
    "vaughan , b.a .",
    "1996 , , 280 , 227 nowark , m.a . ,",
    "vaughan , b.a . ,",
    "wilms , j. , dove , j.b .",
    "& begelman , m.c .",
    "1999 , , 510 , 874 nowark , m.a . ,",
    "wilms , j. , heindl w.a .",
    ", pottschmidt k. , dove , j.b . & begelman , m.c .",
    "2001 , , 320 , 316 nowark , m.a . ,",
    "wilms , j . & dove , j.b .",
    "2002 , , 332 , 856 vaughan , b.a . & nowark , m.a .",
    "1997 , , 474 , l43"
  ],
  "abstract_text": [
    "<S> a technique for calculation of variability coherence at different timescales performed directly in the time domain is introduced . </S>",
    "<S> simulations are made to compare the coherence spectrum derived by the time domain technique with the coherence function by fourier analysis . </S>",
    "<S> the results indicate that in comparison with the fourier analysis the time domain technique is more powerful for revealing signal coherence in noisy data . </S>",
    "<S> we apply the time domain technique to the real data of the black hole binaries cygnus x-1 and gx 339 - 4 and compare the results with their fourier coherence spectra . </S>"
  ]
}