{
  "article_text": [
    "there has been considerable interest in the last decade in applying measurement - based feedback to quantum systems , especially after recognition of the laboratoire kastler brossel ( lkb ) photon box experiments resulting in the 2012 joint nobel prize for physics to serge haroche @xcite .",
    "it is reasonable to believe that classical feedback concepts will find their way into quantum systems if quantum technologies are ever to be realized . in this paper",
    "we will focus on pid controller implementations .",
    "there are a number of motivations for this .",
    "first , pid controllers are widely used in practice and so a large body of knowledge exists about the underlying theory and about their applications .",
    "secondly , they would be simple devices to include in design problems as they have only three gain parameters to adjust .",
    "a third reason , and to a large extent the one pursued in this paper , is that we like to be able to export standard control techniques to the quantum domain and , to this end , need to know that the underlying modelling framework is both mathematically and physically correct .    in the quantum domain",
    ", we have to worry that our dynamical model does not violate physical requirements such as the heisenberg uncertainty relations , complete positivity , etc .",
    "if we wish to take the measured output of a quantum system and perform classical manipulations such a information processing and feedback , we need to be concerned that we have a hybrid classical - quantum description . in the quantum world , information can not be copy and so the jump off points in classical block diagrams can not be applied to quantum information . in this paper , we will give a description of a quantum pid controller which feeds back ( classical ) information arising from measurement - and to this end we need a quantum kalman filer .",
    "just as valuable as the specific structure of the model , is the fact that it qualifies as a consistent controlled quantum dynamical system . in principle , this shows the way to more detailed model building and opens up the programme of realizing standard feedback techniques in the quantum domain .",
    "the approach adopted here relies on the notion of a controlled quantum stochastic evolution described by luc bouten and ramon van handel @xcite , see also @xcite , and brings to the fore the distinction between the input and the output pictures which is already implicit in their work .",
    "the layout of the paper is as follows : in section [ sec : filter ] we recall the basic concepts of classical and quantum filtering . in section [ sec : io_pictures ] , we develop the concept of input and output pictures , and emphasize the importance of working between these pictures in order to build up a consistent model .",
    "finally , in section [ sec : pid_controller ] we show how to construct the pi controllers as instances of feedback to the hamiltonian .",
    "here we have mechanisms to reduce two distinct notions of error : the kalman filter seeks to reduce the error between our estimate and the unknown state while the controller aims to minimize the error between the estimated state and a given reference signal .",
    "the d component of the controller is more problematic as typically it will amplify noise , which is an issue here as the filtered state is stochastic .",
    "normally one smooths out the signal using a low - pass filter and this effectively restores a pi controller model , however , we treat the general pid problem here for completeness .",
    "the situation was addressed in the pioneering work of howard wiseman @xcite and in our classification this equates with a d filter component : the photo - current @xmath0 fed back in in @xcite being the singular process obtained as derivative of the measured process @xmath1 .",
    "the treatment of this involves a modification of the coupling operator coefficients of the system to the input noise fields in addition to a hamiltonian correction .",
    "we build on the description in @xcite of a pid filter to construct the appropriate model for a pid controller .      in practical applications",
    "one may take the control to be some function of the state , or , in the case where that is not accessible , an estimate for the state .",
    "the latter will involve a filter , and we will describe this in the next section , so let us look at the former problem first . for simplicity , we will assume that our system of interest - _ the plant _ in engineering parlance - and that the relationship between the control input @xmath2 and the ( partial ) observations @xmath0 of the state is linear with transfer function @xmath3 . in figure [",
    "fig : feedback_block ] we have a reference signal @xmath4 input at the start . from this",
    "we subtract the observation @xmath0 and the error @xmath5 is passed through a _ controller _ which we assume to be another linear system with transfer function @xmath6 .",
    "we have used double lines to emphasis that all the signals are classical and so can in principle be copied , combined , and manipulated without restriction .",
    "* we use double - lined arrows to denote classical signals in feedback block diagrams .",
    "later we will use single line arrows for quantum ( i.e. , operator - valued ) signals .",
    "_     in a feedback loop with a controller @xmath6.,scaledwidth=75.0% ]    we have @xmath7 from which we obtain @xmath8    the closed loop transfer function is @xmath9 and we can consider design problems centering around our choice of the controller @xmath6 .      by",
    "far the most widely used control algorithm in classical feedback applications are the pid controllers - with pi action being the most common form . for this class",
    ", we have the input - output relations @xmath10 where the constants @xmath11 are the proportional , integral and derivative gains , respectively .",
    "the associated transfer function is @xmath12 , see figure [ fig : pid_filter ] .",
    "is transformed into an output @xmath13 .",
    "the proportional term is the present error , the integral term is the accumulated past error , while the differential term makes account of what may happen in the future .",
    ", scaledwidth=60.0% ]",
    "the goal of filtering theory is to make an optimal estimate of the state of a system under conditions where the system may have a noisy dynamics , and where we may have only partial information which itself is subject to observation noise .",
    "consider a system whose state belongs to some configuration space @xmath14 - say equal to @xmath15 for some @xmath16 .",
    "the state at time @xmath17 is @xmath18 and this is supposed to taken to evolve according to a linear but noisy dynamics of the form @xmath19 here , the @xmath20 are controls and the @xmath21 are errors . furthermore , our knowledge is based on measurements that reveal only partial information about the state and the measurement process may also be corrupted by noise : specifically , we measure @xmath22 at time @xmath17 where @xmath23",
    "the random variables @xmath24 are the dynamical noise and measurement noise , and are modelled as independent with variables with @xmath25 and @xmath26 .",
    "if the matrix @xmath27 may be invertible , then we can fully determine the state from the measurements , at least up to measurement disturbance error , but in general this need not be the case .     (",
    "unknown ) in the configuration space @xmath14 at time @xmath17 .",
    "our knowledge of the system is based on observations @xmath22 made at time @xmath17 containing partial information of the state .",
    "based on our observations we estimate what the trajectory might have be.,scaledwidth=100.0% ]    our aim is to determine the optimal estimate @xmath28 for any function @xmath29 of the state variable @xmath30 conditional on the observations @xmath31 up to time @xmath17 , that is @xmath32 } ] \\end{aligned}\\ ] ] where @xmath33}$ ] is the sigma -algebra generated by @xmath31 .",
    "let us introduce the optimal estimate of @xmath34 given @xmath35 , @xmath36 } ] , \\qquad ( \\text{optimal estimate})\\end{aligned}\\ ] ] and also the optimal prediction of @xmath34 one time step earlier @xmath37 } ] $ ] .",
    "the estimation error is @xmath38 , and the prediction error is @xmath39 .",
    "the kalman filter is a _ recursive _ estimation scheme valid for linear gaussian models . immediately after time @xmath40 ,",
    "we will have recorded the observations @xmath41 .",
    "suppose that we have the best estimate @xmath42 at that point , then we would predict @xmath43 . from this",
    ", we find the predicted state to be @xmath43 .",
    "therefore , we predict what the next observation should be @xmath44 . at this stage we wait for the next measured value , @xmath45 , to be made at time @xmath46 .",
    "what will be of interest is the _ residual error _ which is the difference between the _ observed value _ of @xmath22 and the _ expected value _ , @xmath47 , we would have predicted _ a priori_. this is quantified as the _ innovations process _",
    "@xmath48 if this error is zero , then our prediction is spot on , and we just take our predicted @xmath49 to be our estimate for state at time @xmath17 .",
    "otherwise , we apply an adjustment based on the discrepancy , and the kalman filter sets @xmath50 with the associated estimation error @xmath51 .",
    "the kalman filter is therefore a recursive procedure requiring minimal storage of information - effectively only the previous estimate @xmath42 - and updated on the next available measurement @xmath45 .",
    "it is optimal in the sense that the conditional expectation ( uniquely ! ) provides the least squares estimator for @xmath52 for any bounded measurable @xmath29 .",
    "there is a straightforward generalization of the kalman filter to continuous time , known as the kalman - bucy filter",
    ". we will derive it shortly .",
    "it is again recursive , but attempts to move away from gaussian noise or linear dynamics result in filters that are difficult to implement .",
    "a popular saying in the field was ( and arguably still is ) _ if we can put a man on the moon , why ca nt we find a nonlinear filter ? _    let us begin by considering a continuous - time nonlinear - dynamical extension of the estimation problem where the state undergoes a diffusion .",
    "for simplicity we take @xmath53 , and the continuous time equations are taken as @xmath54 with independent wiener processes @xmath55 ( dynamical noise ) and @xmath56 ( observational noise ) . if we set @xmath57 , then from the it calculus @xmath58 , where the generator of the diffusion process is @xmath59 .",
    "the optimal estimate of @xmath60 , given the observations up to time @xmath61 , will be the conditional ; expectation @xmath62 $ ] , and this will satisfy the _ kushner - stratonovich equation _ @xmath63 where the _ innovations process _ is @xmath64 the filter enjoys the least squares property that @xmath65 \\leq \\mathbb{e } \\big [ | m - f_t |^2 \\big ] , \\qquad ( \\forall m \\ ; \\mathscr{y}_{t ] } - \\mathrm{measurable } ) .",
    "\\label{eq : ls}\\end{aligned}\\ ] ]    statistically , the innovations process will be a wiener process .",
    "this fact underscores the property that the filter is so efficient at extracting information from the measurement process , that afterwards we are just left with white noise ! we now give a quick derivation of the kushner - stratonovich equation .",
    "we use the characteristic function method .",
    "let @xmath66 be an arbitrary function of time , and define a stochastic process @xmath67 by the stochastic differential equation @xmath68 with @xmath69 .",
    "we now make an ansatz that @xmath70 satisfies a stochastic differential equation of the form @xmath71 where @xmath72 and @xmath73 are stochastic processes adapted to the measurement process @xmath1 .",
    "the least squares property ( [ eq : ls ] ) now implies the identity @xmath74 = 0\\end{aligned}\\ ] ] and differentiating wrt .",
    "time gives @xmath75 where @xmath76   = \\mathbb{e}\\left [ \\left ( \\mathscr{l}f_{t}-\\beta _ { t}-\\gamma _ { t}h_{t}\\right ) c_{t}\\right ] dt , \\nonumber\\\\ ii & = & \\mathbb{e}\\left [ \\left ( f_{t}-\\hat{f}_{t}\\right ) dc_{t}\\right ] = \\mathbb{e}\\left [ \\left ( f_{t}-\\hat{f}_{t}\\right ) \\alpha \\left ( t\\right ) h_{t}c_{t}\\right ] dt , \\nonumber \\\\ iii & = & \\mathbb{e}\\left [ \\left ( df_{t}-d\\hat{f}_{t}\\right ) dc_{t}\\right ]   = \\mathbb{e}\\left [ -\\gamma _ { t}\\alpha \\left ( t\\right ) c_{t}\\right ] dt.\\end{aligned}\\ ] ]    as @xmath77 was arbitrary , we deduce that @xmath78 and @xmath79 .",
    "the first of these implies that @xmath80 = 0 $ ] , and by taking conditional expectation under the expectation , and noting that @xmath81 and @xmath67 are adapted , we get @xmath82 .    similarly we have @xmath83 -\\mathbb{e}\\left [ \\gamma _ { t}\\alpha \\left ( t\\right ) c_{t}\\right ] = 0 $ ] , and by the same procedure we deduce that @xmath84 .",
    "the filtering problem admits a _ conditional density _ @xmath85 if we have @xmath86 in which case the kushner - stratonovich equation becomes @xmath87    we remark that @xmath88 is a probability density function valued stochastic process , and that ( [ eq : ks ] ) is in _ nonlinear _ in @xmath89 ! if we average over all outputs we get an average density @xmath90 which satisfies the fokker - planck ( kolmogorov forward ) equation @xmath91 where the dual of the diffusion generator is @xmath92 .",
    "an equivalent formulation is the _ zakai equation _ for an _",
    "stochastic density function @xmath93 , and is the _ linear _ equation @xmath94 we then have @xmath95 .      as a special case ,",
    "take @xmath96 so that @xmath97 .",
    "we have @xmath98    from gaussianity , we have @xmath99 , and this allows us to reduce the order of the problem so that we only have to contend with moments and variances of the conditional distribution .",
    "let @xmath100 , then we are lead to the kalman - bucy filter @xmath101      the theory of quantum filtering was developed by v.p .",
    "belavkin @xcite , and represents the continuation of the work of kalman , stratonovich , kushner , zakai , etc .",
    "partial information about the state of high @xmath102 cavity modes is obtained by measuring rydberg atoms that are passed one - by - one through the cavity , see figure [ fig : lkb_photon_box ] .",
    "is sent into a filter which estimates the state of the cavity mode , and then an instruction is sent to the actuator so as to control the mode.,scaledwidth=50.0% ]    the measurement results can be used to apply a feedback action on the cavity mode .",
    "we consider a quantum mechanical system which is probed by a two - level atom ( qubit ) .",
    "the qubit is in input state @xmath103 initially .",
    "the unitary interaction between the cavity mode and the probe qubit leads to a change of state in the schrdinger picture : @xmath104 we take the interaction time @xmath105 to be very small and assume that the unitary has the form @xmath106    we now measure the spin @xmath107 of the qubit and record the eigenvalues @xmath108 corresponding to eigenvectors latexmath:[\\ ] ] where @xmath452 and @xmath453 are real numbers called _ set point weightings_. if we take @xmath454 , and drop the d action , then we arrive at the closed - loop transfer function @xmath455 and the denominator may be made equal to some desired 2nd order system , say @xmath456 , by selecting @xmath457 , and @xmath458 .",
    "this is a basic example of tuning the pid controller .",
    "more sophisticated applications , such as loop shaping , exist and there are a variety of techniques ( ziegler - nichols , cohen - coon , etc . , as well as several pid tuning software products ) available .",
    "the illustrative model consider in this paper has been a single cavity mode , and this has a simple 1st order transfer function @xmath459 .",
    "however , it is clear that our analysis extends to multi - mode systems since the main requirement for the theory to work is linear gaussian one , and so we expect that the standard techniques of classical pid control may be readily adapted to linear quantum optical systems , for example .",
    "this opens up the possibility of extensions to non - linear models , as well as realistic      an alternative strategy is adaptive quantum feedback @xcite where , instead of a controlled flow , we consider the situation where the feedback is to the detector .",
    "this is depicted in figure [ fig : qfa_loop_detector ] . here",
    "we would make the measured quadrature - the @xmath460 } ( t)$ ] parameter - now dependent on the output .",
    "this has been treated in @xcite .",
    "we note that despite the different architecture here and the fact that we are controlling the homodyne measurement scheme rather than the system dynamics , the same principle of being able to transfer between the input picture and the output picture applies .    ] } ( t)$ ] in the input picture , is taken to depend on the filter output.,scaledwidth=75.0% ]",
    "we have shown that pid controllers can be constructed for quantum systems . at the outset , we had the nagging doubt that the various manipulations of the measured data that can be performed classical by an observer may somehow be incompatible with a consistent quantum model .",
    "however , we have shown that this is not the case . at the heart of our discussions",
    "is the distinction between the input picture ( where we may describe the system as a controlled dynamics and look at the output downline ) and the output picture ( where we may describe the system in terms of the measured output and filter back upstream ) . in reality both are necessary , and indeed both are equivalent . to justify the pid controller as a consistent model",
    ", we had to set up the feedback law in the output picture , then work back to find the corresponding controlled process description in the input picture .",
    "the general pid case is quoted in theorem [ theorem : pid ] , and we may obtain the special cases of p , pi , etc .",
    ", as simple corollaries .",
    "the key point is that the theorem shows that a controlled @xmath182-dynamical model exists which underpins the feedback model , including the classical \" actions done by the controller .",
    "as we have mention , classical pid filters are versatile , well - studied feedback controllers and in principle may be applied to quantum feedback systems .",
    "the effect of nonlinearities is an interesting further topic - for instance one might be interested in an anti - wind up scheme - but the @xmath182 theory can be readily extended to nonlinear dynamical models and this will be the subject of further work .",
    "p. rouchon , models and feedback stabilization of open quantum systems extended version of the paper attached to an invited conference for the international congress of mathematicians in seoul , august 13 - 21 , 2014 arxiv:1407.7810    l. bouten , r. van handel , on the separation principle of quantum control \" , in quantum stochastics and information : statistics , filtering and control ( v. p. belavkin and m. i. guta , eds . ) , world scientific , ( 2008 )            v.p .",
    "belavkin , non - demolition measurements , nonlinear filtering and dynamic programming of quantum stochastic processes \" , lecture notes in control and inform sciences * 121 * 245265 , springer ",
    "verlag , berlin ( 1989 )    h. maassen , theoretical concepts in quantum probability : quantum markov processes .",
    "fractals , quasicrystals , chaos , knots and algebraic quantum mechanics ( maratea , 1987 ) , 287302 , nato adv .",
    ", 235 , kluwer acad .",
    "dordrecht , ( 1988 )"
  ],
  "abstract_text": [
    "<S> we give a concrete description of a controlled quantum stochastic dynamical model corresponding to a quantum system ( a cavity mode ) under going continual quadrature measurements , with a pid controller acting on the filtered estimate for the mode operator . </S>",
    "<S> central use is made of the input and output pictures when constructing the model : these unitarily equivalent pictures are presented in the paper , and used to transfer concepts relating to the controlled internal dynamics to those relating to measurement output , and . </S>",
    "<S> the approach shows the general principle for investigating mathematically and physically consistent models in which standard control theoretic methods are to be extended to the quantum setting . </S>"
  ]
}