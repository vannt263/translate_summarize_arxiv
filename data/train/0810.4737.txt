{
  "article_text": [
    "numerical simulations of high energy ion tracks and range distributions in solids are limited by several factors , including the total range of the ion and the small time step necessary for resolving high energy atomic collisions .",
    "these problems have been successfully addressed for disordered or dense materials through event - based binary collision ( bc ) algorithms that simulate straight atomic trajectories between instantaneous pairwise collisions with the target material @xcite . as an integral part of this approach ,",
    "the bc model relies on simulating only a very small sample of the target material at any given time , since the interaction between a moving ion and the material must be short range in binary collisions .",
    "the combination of these two features allows for studies of very high energy ionic paths over long range , provided that the interactions are well represented as binary collisions and that simple relationships between the trajectory can be established easily and accurately , before and after a collision .",
    "a molecular dynamics ( md ) revision to the binary collision technique has been introduced in order to capture the propagation of an ion through crystalline materials in which the crystal structure may provide for the channeling of ions or other structural effects that make the binary collision approximation inappropriate @xcite .",
    "this approach requires more computational resource than bc @xcite in advancing the traveling ion while all the relevant atomic interactions are included every time step .",
    "however , this md approach provides more correct representation of channel symmetry which a strict binary collision may not describe , and also the computational efficiency can be spared by the help of parallel computing .",
    "the strategy is therefore to model all the relevant interactions between a moving ion and the surrounding material temporally continuous , while simultaneously making the essential assumption that an ion propagates through the target material only guided by its immediate spatial vicinity ; i.e. , a domain following approach that we retain from bc .",
    "thus , this methodology is a hybrid between bc and md approaches .",
    "consequently , the enhanced accuracy of the hybrid is at the price of computational speed , requiring a larger number of calculations for the simulations of collisions or interactions . further combining the domain following md scheme with a rare - event enhancing algorithm , which can efficiently evaluate ion probabilities ( e.g. , as a function of range ) over several orders of magnitude , produced the rare event enhanced domain following molecular dynamics ( reed - md ) scheme @xcite .",
    "this method has successfully produced accurate dopant density profiles of ion - implanted semi - conductor wafers @xcite at ion energies in the range of 10kev-100kev initial energy with minimal empirical fitting of model parameters .",
    "the approach has subsequently been reproduced by other groups @xcite who also studied semiconductor doping by ion irradiation .",
    "the recent resurgence of interest in nuclear materials provides a new class of applications of the reed - md approach to ion track simulations .",
    "for example , a typical fuel is actinide - oxide ( e.g. , uo@xmath0 or u@xmath1pu@xmath2o@xmath3 or u@xmath1pu@xmath4am@xmath5o@xmath3 ) @xcite in which either spontaneous decay produces high energy ion recoils of @xmath685kev or neutron induced fission produces ion energies of order 85mev . understanding the evolution of both the ion paths and the long time properties of the target material demands practical simulation tools that can simulate a broad spectrum of very high energy ions in crystalline structures with a variety of damage , imperfections , and structures @xcite .",
    "the very high energies demand both fine time step resolution and , for light elements , simulations of relatively long trajectories ( up to several @xmath7 ) . in order to mitigate this computational load",
    "we propose to take advantage of parallel computing of individual ion tracks .",
    "since both computational and physical behavior of the different ion tracks are connected through possible damage cumulation as well as the rare event statistical enhancement , the parallel strategy is non - trivial .",
    "the aim of this paper is therefore to demonstrate a parallel simulation method for efficiently evaluating the statistics of ion ranges , and we exemplify the method through simulations of uranium recoil and fission fragment propagation in crystalline uranium di - oxide .",
    "in order to describe the parallelization of the reed - md method , we first briefly outline the core of the approach .    based on a purely classical md formalism , reed takes advantage of several particularities of high - energy ion collisional transport in order to improve efficiency @xcite . *",
    "first * , at kinetic or collisional energies significantly larger than chemical or ionic bond strength , we do not consider electronic structure details of the atomic interactions .",
    "instead , only the short range universal ziegler - biersack - littmark ( zbl ) @xcite screening of nuclear charges is included . *",
    "second * , since the zbl screening function provides for only short range interactions , a moving ion only experiences interactions with its immediate surroundings , which then allows for simulating only a small shell of atoms near the moving ion . as the ion propagates through the target material",
    "the simulated atoms are discarded in its wake and new material is created in front of the ion such that the added material correctly represents the desired statistical structure of target material configurations .",
    "the amount of simulated sample material depends on the interaction ranges between the moving ion and the target material . for uo@xmath8 target material ,",
    "we have settled on 27 unit cells of the 12-atom fluoride structure with the ion occupying the center unit cell .",
    "this domain following scheme is illustrated in fig .",
    "[ fig : moving_cell ] .",
    "* third * , deformations of the electronic structure during collisions , as well as in interstitial regions , are modeled through the local inelastic interaction given by firsov and kichenevskii @xcite and the brandt - kitagawa like electronic stopping mechanism @xcite from the interstitial electron density , which is calculated by the residual unbound electrons in a muffin - tin model of the target material .",
    "following the outline above , we are able to accurately simulate the path of a fast - moving ion in a material for which we statistically know the structure . these components are incorporated into a newtonian equation of motion , which is simulated by a standard verlet - type numerical integrator @xcite with adaptive time - step control .",
    "we note that the dynamics is non - relativistic for the relevant energies and ions , and both the electronic stopping and the zbl screening function are within the assumed validity ranges @xcite . yet , because of the high initial kinetic energy , a very small time step is required to describe the initial behavior .",
    "but as the ion is decelerated , the appropriate time step increases by several orders of magnitude , as shown in figure [ fig : dt_e ] .",
    "the adaptive time step control is determined based on both kinetic energy and collisional potential energy .",
    "detailed expression can be found in ref .",
    "@xcite .",
    "in order to obtain , e.g. , a statistical range density ( probability ) profile of a given type of ion in a material under given circumstances , we must simulate a significant number of ion tracks , which differ in the statistical realization of temperature and material defects .",
    "a typical profile of this kind is characterized by a relatively short range density peak ( nuclear collisions ) with less likely tails of deeper penetration ( channeling ) .",
    "thus , if one wishes to generate statistics with a given small variance in the deep range of ion tracks , a very large number of simulations must be produced , since most of these will contribute only to the primary range peak .    alleviating this statistical problem ,",
    "a rare event statistical enhancement algorithm @xcite is applied to provide uniform simulation effort at all relevant ranges in order to equalize the variance of the density distribution .",
    "this is accomplished by cloning the simulation system if an ion reaches certain ranges .",
    "these ranges are determined such that the acquired statistical count in each range interval between cloning distances is equal ( or similar ) .",
    "the correct statistical measure is then recovered by consistently assigning a statistical weight to each simulated ion ; i.e. , the statistical weight of a simulated ion is cut in half every time it has been cloned .",
    "a simulation is initiated with a certain standard guess of the distribution of cloning depths , or it can be obtained from some other source , and these depths are subsequently dynamically adjusted throughout the acquisition of statistics in order to reach the desired goal of uniform statistical count in all intervals .",
    "we note that the trajectories of two clones of the same ion will rapidly deviate due to the statistical representation of , e.g. , temperature and crystal defect content in the target material that is created as each ion is independently progressing after cloning . following this procedure ,",
    "reed - md can accurately and efficiently produce range profiles of energetic ions in crystalline materials with uniform statistical uncertainty over many orders of magnitude",
    ".    even with the abovementioned strategy there can be significant computational shortcomings when simulating nuclear fuel materials or nuclear radiation . for our test example ( uo@xmath8 ) in this paper ,",
    "the ion energies are very large , requiring very small numerical time steps and yielding relatively large ranges ( @xmath9 for 85mev fission fragments , such as kr and ba ) .",
    "we may therefore benefit from a parallel strategy of a reed - md implementation .",
    "the strategy we propose does not involve any additional assumptions or limitations of the simulated physics , and the acquired statistics is the same as if one uses the serial reed - md algorithm .",
    "because reed - md relies on statistical sampling of possible ion trajectories we initiate a large number of ions with the same statistical representation .",
    "this provides good opportunities for parallel computing , which will now be discussed .",
    "straightforward distribution of the initiated ions across available processors seems an obvious strategy , but this simple approach comes with a couple of complications unless special care is taken .",
    "the root of the problem is the necessary accumulation of the statistics as the simulation progresses in order to appropriately account for , e.g. , cumulative damage and in order to specify the proper locations of the cloning distances that result in optimal statistical accuracy .",
    "however , since each initiated ion results in an unpredictable path , which may represent a very broad distribution of range and behavior , the cpu time needed to complete a simulation of a single ion path can vary greatly .",
    "this is further amplified by the possibility of @xmath10 clones from the @xmath11 cloning ranges in reed .",
    "thus , collective ( synchronous ) message passing is not efficient , since this would lead to a broad range of idle times in all but the processor with most time consuming task .",
    "one solution to the problem of the synchronization described is to let all processors share a common file in lieu of direct communication .",
    "this would serve as an asynchronous communication tool . in order to prevent the possibility of simultaneous writing to the file by two different processors",
    ", one would need to specifically address this issue together with the inherent inefficiency of disk access .",
    "another solution is polling @xcite .",
    "we let each processor run its own simulations without collective communication . using * probe *",
    ", any incoming data can be detected , and each processor can respond accordingly .",
    "an example of polling is shown in table [ table : polling_basic ] .",
    "even though implementation may not be straightforward , it is possible to minimize the idling time of each processor during the extremely asynchronous reed - md simulations .",
    "we here employ a polling method extensively and describe how it is designed and implemented through a host - client algorithm .    as discussed above ,",
    "the success of a parallelization strategy lies in how well we minimize the idling time of processors .",
    "the flow of the algorithm should therefore be such that the processors are kept occupied by continuously producing results from individual reed - md tracks .",
    "each ion is initiated with the current - time global statistics that determines the cloning criteria , which are updated gradually throughout the simulation based on all completed ( i.e. , stopped ) ions .",
    "this adaptive refinement is continued until the end of the entire calculation . to accomplish this gradual update of the statistics ,",
    "three types of communication are required : first , the results of individual ion simulations , such as ion ranges and their corresponding statistical clone - weights .",
    "second , updated cloning criteria .",
    "finally , the termination signal indicating that no new ions need to be initiated by a processor .    through several tests , we found that a host - client algorithm is very effective for our purpose .",
    "we assign a single processor as a host processor , and this processor handles most of the coordinating work , such as i / o , update of cloning criteria , and management of simulation results .",
    "the rest of the processors are devoted to ion simulations with minimized load for communication .",
    "polling is employed when the host and client processors communicate , and the conventional message passing interface @xcite has been implemented , providing extensive portability across system architectures .    when we implement a non - blocking * probe * , we consider the required frequency and priority , such that any completed ion results from a processor can be received at any time .",
    "the non - blocking * probe * is therefore continuously active in the host processor while the other processors send the data at the end of every single ion simulation including cloned ions .",
    "after the host processor receives enough simulation results , it updates the cloning criteria .",
    "the host must then send the updated criteria to all clients , and here polling is employed again . to reduce the idling time of the host processor , the clients employ non - blocking * probe * at every time step .",
    "it is important to note that cloning criteria in the client nodes are only updated at the completion of every ion track ( including the cloned ions ) in order to avoid corrupted or inconsistent cloning by conflicting criteria during a track simulation .",
    "finally , the host processor will count the number of collected ions ( or other simulation statistics ) to decide if the simulation should continue .",
    "when a stop criterion is met at the host processor it sends a kill - signal , and the client processors detect it by another non - blocking * probe * , which is implemented to run every time step .",
    "this process is illustrated in figure [ fig : polling ] .",
    "even though this method is straightforward and applies host - client polling effectively , there is a serious problem .",
    "if both a host and a client processor send a signal simultaneously , waiting for the opposing processor to respond , then the program may hang .",
    "therefore , we need to modify the scheme using non - blocking * send*. as shown in figure [ fig : polling2 ] , when the host processor sends any data to the client processors , it employs non - blocking * send*. below the sending routine , we add one more non - blocking probe and a receive routine in order to prevent any immobilization of client processors . after receiving incoming data , non - blocking *",
    "send * is completed .",
    "an example of the pseudo - code is shown in table [ table : polling_adv ] .",
    "we have built a parallel reed - md code based on the developed algorithm , and tested it on several configurations of multiple processors .",
    "we calculated the time consumption between routines , specifying computation and communication , and found the efficiency of the developed code .",
    "the tested machines are exemplified by a multiple of 2.5ghz quad - core g5 powerpc macintosh nodes connected by a non - dedicated gigabit network .",
    "the code was developed with the g++ 4.0.1 compiler and the open mpi 1.1.5 library .",
    "usually , parallel efficiency and scalability are measured relative to the result of serial computing . however , due to the randomness of the simulation , computing costs may not be representative for a given simulation , yielding the direct comparison to a serial simulation somewhat ambiguous .",
    "therefore , we focus on how much wall - clock time is devoted into the actual calculation of reed - md , relative to the communication load and idling .",
    "this will serve as a measure of the efficiency of the developed parallel implementation .",
    "our example target material is the fluoride structure of uranium dioxide @xcite .",
    "we first show results of on - lattice uranium ions with initial energy of 85kev and random direction , corresponding to the recoil energy from a plutonium @xmath12-decay . the target material has temperature 300k , simulated by a gaussian distribution of the lattice atoms with rms values derived from full md simulations of the equilibrium properties of uo@xmath8 @xcite .",
    "we complete simulations of approximately 5,000 initial ions , and we use eight dynamically optimized cloning distances .",
    "range results and the evolution of cloning points are shown in figure [ fig : test1 ] .",
    "we tested 1 , 2 , and 4 nodes corresponding to 4 , 8 , and 16 cpus , respectively .",
    "for all the parallel cases , range results of the left figure show good consistency , although slight discrepancies are found at the tail of the distribution .",
    "such discrepancies must vanish for increasing number of initiated ions .",
    "the evolution of the cloning points are shown in the right figure and they are the results of 4 cpus ( single node ) calculation .",
    "we here see that the short range cloning distances stabilize sooner than the longer range ones , and we see that the longest ranges have not yet converged by the end of the simulation , indicating that the range distribution has not yet acquired enough statistics at all scales .",
    "this is consistent with the above observation of differences between the tails of the different simulations using 5,000 initial ions . while the number of necessary initial ions for reaching reliable statistics depends on both the physics of the system and the algorithmic number of cloning points ( as well as the number of orders of magnitude on which statistical data is desired ) , we generally find that 10,000 initial reed - md ions yield reliable statistics .",
    "the settling of all cloning points is a good indicator of adequate global statistics , and we therefore use the cloning points as a criterion for determining the quality of the simulation results .    the parallel performance of the procedure is summarized in table [ table : parallel ] . here , computation load means the cost devoted to the actual reed - md calculations while communication load is the cost of the communication with other processors .",
    "the results are averaged over all the employed processors .",
    "efficiency is the ratio of computation load to the total wall - clock time .",
    "the single node 4-cpu test , shows better than 99% of wall - clock time devoted to actual reed - md ion track simulations .",
    "basically , communication is very efficient within a single node , so optimal parallel performance may not be surprising in this case .",
    "however , the test demonstrates that potential parallel inefficiency of idling processors is not an issue in our implementation . in order to study the effects of the networking",
    ", we repeated the 4-cpu processor simulation with multiple nodes such as two and four .",
    "the results are that the parallel efficiency drops from 99% to 97% , indicating the effect of the gigabit connections and the latency of the networking switch .",
    "we then conducted similar simulations with eight and sixteen cpus ( two and four nodes ) , and the parallel efficiency remained 96% . since the amount of communicated information is limited , we suspect that the drop in efficiency when the simulations exceed one node is due more to the latency of the switch than it is due to the speed of transmission . however , even 96% parallel efficiency is very useful for optimized computing .",
    "the actual communication load of the host processor was found to be @xmath13 ,",
    "@xmath14 , @xmath15 , @xmath16 , and @xmath17 seconds for 4(1 ) , 4(2 ) , 4(4 ) , 8(2 ) , and 16(4 ) cpus ( nodes ) , and the computing efficiency of the host processor ( measured as ion - track simulation time relative to total time ) corresponds to 99.6% , 96.9% , 97.1% , 92.3% , and 81.8% . as the number of participating processors increases , the simulation results sent to the host processor increase proportionally , and its local efficiency drops accordingly . however , with the efficiency of the client processors being nearly unchanged this strategy provides very high overall parallel efficiency at more than 96% .      as an example of relevant fission energy simulations , we tested the code performance for 85mev kr ions with up to 32 cpus ( 8 nodes ) .",
    "the lattices and other boundary conditions are the same as in the above section . compared to intermediate energy ions ,",
    "the computational cost is very high , in part due to the small time step by the extremely high initial kinetic energy , and we tested only around a thousand initial ions .",
    "range results and the evolution of the cloning points are shown in figure [ fig : test2 ] .",
    "because of the high energy , the ion track range was found to reach up to several @xmath7 .",
    "each parallel run shows similar range density but the tail of the distribution is quite different compared to above results . because so few initial ions were simulated this discrepancy is expected . as discussed above",
    ", more simulated ions will naturally result in better statistics .",
    "evolution curves of cloning points are from 4 ( 1 ) cpu ( node ) run and they are still evolving , showing insufficient statistical sampling .",
    "parallel performance results are shown in table [ table : parallel2 ] and we find similar results to the abovementioned study of 85kev u , providing better than 96% efficiency .",
    "the communication load at the host processor was found as @xmath18 , @xmath19 , and @xmath20 seconds for 4(1 ) , 16(4 ) , and 32(8 ) cpus(nodes ) , yielding 99.6% , 82.2% , and 62.6% host node computing efficiency , respectively .",
    "as discussed above , more computing processors result in an avalanche of communication to and from the host processor , and the host processor consequently suffers in its contributions to the data production ; but overall performance still holds at better than 96% . from these results , we can conclude that our host - client polling algorithm works well for parallel reed - md simulations .",
    "further , on dedicated servers with high speed networks , higher efficiency should be expected in line with our single node simulation results .",
    "reed - md is a robust method for simulating ionic radiation in dense and crystalline materials . to refine the improbable statistics ,",
    "rare event enhancement is employed and individual ion track simulations form different cascades and trajectories by cloning , resulting in asynchronous behavior among processors . therefore , parallelization of the reed - md algorithm demands a strategy other than collective communication .    based on the required priority and frequency of each communication ,",
    "we have designed and optimized appropriate algorithm locations for polling and message passing .",
    "even with extremely asynchronous behavior among ion tracks of different processors , data could be delivered efficiently between processors , leading to a nearly optimal parallel efficiency .",
    "we note that the success of providing this good parallel efficiency even for severely asynchronous processor behavior implies that the algorithm is robust in its load balancing , which , in turn , implies that the algorithm will perform equally well on a heterogeneous cluster of computing nodes .",
    "we therefore envision that several other applications in molecular dynamics and monte carlo applications could take advantage of similar strategies .",
    "the authors are grateful for continuing useful discussions with mark asta and anurag chaudhry .",
    "this work was supported by the us department of energy nuclear energy research initiative for consortia ( neri - c ) contract number dr - fg07 - 071d14893 and in part by los alamos national laboratory contracts 25110 - 001 - 05 , through the materials design institute , and 62410 - 001 - 08 .",
    "o.  b.  firsov , zh .  eksp .",
    "fiz .  * 36 * , 1517 ( 1959 ) [ sov .  phys .",
    "jetp  * 9 * , 1076 ( 1959 ) ] ; l.  m.kishinevskii , izv .",
    "sssr , ser .",
    "* 26 * , 1410 ( 1962 ) [ bull .",
    "ussr , phys .",
    "* 26 * , 1433 ( 1962 ) ] ; v.  a. elteckov , d.  s. karpuzov , y.  v. martynenko , v.  e. yurasova , computer studies of b+ ion penetration into si single crystal , in : atomic collision phenomena in solids , north - holland , amsterdam , 1969 , pp .",
    ".                     lattices . as kinetic energy decreases ,",
    "an appropriate time step increases by several orders of magnitude when using the adaptive time step control @xcite .",
    "the exact unit of the time step is 10.18 fs . ]"
  ],
  "abstract_text": [
    "<S> we present an efficient parallel algorithm for statistical molecular dynamics simulations of ion tracks in solids . the method is based on the rare event enhanced domain following molecular dynamics ( reed - md ) algorithm , which has been successfully applied to studies of , e.g. , ion implantation into crystalline semiconductor wafers . </S>",
    "<S> we discuss the strategies for parallelizing the method , and we settle on a host - client type polling scheme in which a multiple of asynchronous processors are continuously fed to the host , which , in turn , distributes the resulting feed - back information to the clients . </S>",
    "<S> this real - time feed - back consists of , e.g. , cumulative damage information or statistics updates necessary for the cloning in the rare event algorithm . </S>",
    "<S> we finally demonstrate the algorithm for radiation effects in a nuclear oxide fuel , and we show the balanced parallel approach with high parallel efficiency in multiple processor configurations .    host - client algorithm , polling , reed - md , parallel computing , radiation range , molecular dynamics , asynchronous communication 61.80.-x , 29.25.-t </S>"
  ]
}