{
  "article_text": [
    "in population genetics models for finite populations including selection , many properties are still unknown , in particular when it comes to ancestral processes and genealogies .",
    "this is why a classic model , namely the moran model in continuous time with population size @xmath0 , two allelic types , and ( fertility ) selection is still the subject of state - of - the - art research , see e.g. bah et al .",
    "( 2012 ) , mano ( 2009 ) , houchmandzadeh and vallade ( 2010 ) , or pokalyuk and pfaffelhuber ( 2013 ) .",
    "in particular , new insights are currently being obtained by drawing a more fine - grained picture : rather than looking only at the type frequencies as a function of time , one considers ancestral lines and genealogies of samples as in the ancestral selection graph ( asg ) ( krone and neuhauser ( 1997 ) , neuhauser and krone ( 1997 ) ) , or even particle representations that make all individual lines and their interactions explicit ( here the main tool is the lookdown construction of donnelly and kurtz ( 1996 , 1999 ) ) .",
    "see etheridge ( 2011 , ch .",
    "5 ) for an excellent overview of the area .    the way that fixation probabilities (",
    "that is , the probabilities that the individuals of a given type eventually take over in the population ) are dealt with is typical of this development .",
    "the classical result is that of kimura ( 1962 ) , which is based on type frequencies in the diffusion limit .",
    "short and elegant standard arguments today start from the discrete setting , use a first - step or martingale approach , and arrive at the fixation probability in the form of a ( normalised ) series expansion in the reproduction rate of the favourable type ( cf .",
    "durrett ( 2008 , thm .",
    "an alternative formulation is given by kluth et al .",
    "both are easily seen to converge to kimura s result in the diffusion limit .",
    "recently , mano ( 2009 ) obtained the fixation probabilities with the help of the asg , based on methods of duality ( again in the diffusion limit ) ; his argument is nicely recapitulated by pokalyuk and pfaffelhuber ( 2013 ) .",
    "what is still missing is a derivation within the framework of a full particle representation .",
    "this is done in the present article . to this end",
    ", we introduce an alternative particle system , which we call the _ labelled moran model _ , and which is particularly well - suited for finite populations under selection .",
    "it is reminiscent of the _",
    "@xmath0-particle look - down process _ ,",
    "but the main new idea is that each of the @xmath0 individuals is characterised by a different reproductive behaviour , which we indicate by a label . with the help of elementary methods only",
    ", we not only recover fixation probabilities , but also obtain detailed insight into the number and nature of the selective events that play a role in the fixation process forward in time .",
    "the paper is organised as follows .",
    "we start with a brief survey of the moran model with selection ( sec .",
    "[ the moran model with selection ] ) . sec .",
    "[ reflection principle ] is a warm - up exercise that characterises fixation probabilities by way of a reflection principle .",
    "[ labelled moran model ] introduces the labelled moran model . with the help of a coupling argument that involves permutations of the reproductive events ,",
    "we obtain the probability that a particular label becomes fixed . within this setting",
    ", we identify reproduction events that affect the fixation probability of a given label ; they are termed _ defining events_. the number of defining events that are _ selective _ turns out as the pivotal quantity characterising the fixation probabilities of the individual labels , and hence the label of the line that will become ancestral to the entire population . in sec .",
    "[ diffusion limit of the labelled moran model ] we pass to the diffusion limit .",
    "we continue with a simulation algorithm that generates the label that becomes fixed together with the targets of the selective defining events ( sec .",
    "[ a simulation algorithm ] ) .",
    "[ discussion ] summarises and discusses the results .",
    "we consider a haploid population of fixed size @xmath2 in which each individual is characterised by a type @xmath3 .",
    "if an individual reproduces , its single offspring inherits the parent s type and replaces a randomly chosen individual , maybe its own parent . this way the replaced individual dies and the population size remains constant .",
    "individuals of type @xmath4 reproduce at rate @xmath5 , whereas individuals of type @xmath6 reproduce at rate @xmath7 , @xmath8 . accordingly , type-@xmath6 individuals are termed ` more fit ' , type-@xmath4 individuals are ` less fit ' . in line with a central idea of the asg , we will decompose reproduction events into _ neutral _ and _ selective _ ones .",
    "neutral ones occur at rate @xmath5 and happen to all individuals , whereas selective events occur at rate @xmath9 and are reserved for type-@xmath6 individuals .",
    "( at this stage , these rates are understood as rates per individual . )",
    "the moran model has a well - known graphical representation as an interacting particle system ( cf .",
    "[ moran model ] ) .",
    "the @xmath0 vertical lines represent the @xmath0 individuals and time runs from top to bottom in the figure .",
    "reproduction events are represented by arrows with the reproducing individual at the tail and the offspring at the head .",
    "more fit , @xmath10 less fit ) are indicated for the initial population ( top ) and the final one ( bottom ) .",
    ", width=264,height=188 ]    we now consider the process @xmath11 ( or simply @xmath12 ) , where @xmath13 is the number of individuals of type @xmath6 at time @xmath14 .",
    "( note that this is the type frequency representation , which contains less information than the particle ( or graphical ) representation in fig .",
    "[ moran model ] . )",
    "@xmath12 is a birth - death process with birth rates @xmath15 and death rates @xmath16 when in state @xmath17 , where @xmath18 the absorbing states are @xmath19 and @xmath0 , thus , one of the two types , @xmath6 or @xmath4 , will almost surely become fixed in the population in finite time .",
    "let @xmath20 , @xmath21 , be the first hitting time of state @xmath22 by @xmath12 .",
    "the _ fixation probability _ of type @xmath6 given that there are initially @xmath22 type-@xmath6 individuals is well known to be ( cf . durrett ( 2008 , thm .",
    "6.1 ) ) @xmath23    an alternative formulation is obtained by kluth et al .",
    "( 2013 ) , where fixation probabilities under selection _ and _ mutation are considered .",
    "it is easily verified that , taking together their eq .",
    "( 40 ) , theorem 2 , and eq .",
    "( 30 ) and setting the mutation rate to zero gives the representation @xmath24 where the coefficients @xmath25 follow the recursion @xmath26 for @xmath27 , with initial conditions @xmath28 eq .",
    "is suggestive : it decomposes the fixation probability into the neutral part ( @xmath29 ) plus additional terms due to offspring created by selective events .",
    "it is the purpose of this paper to make this interpretation more precise , and to arrive at a thorough understanding of eq . .",
    "in particular , we aim at a probabilistic understanding of the coefficients @xmath25 .    before doing this",
    "it is useful to consider the model in the diffusion limit . to this end",
    ", we use the usual rescaling @xmath30 and assume that @xmath31 , @xmath32 . as @xmath33 , @xmath34 converges in distribution to the well known diffusion process @xmath35 , which is characterised by the drift coefficient @xmath36 and the diffusion coefficient @xmath37 hence , the infinitesimal generator @xmath38 of the diffusion is defined by @xmath39).\\ ] ] define the first passage time @xmath40 , @xmath41 $ ] , as the first time that @xmath42 equals @xmath43 . for @xmath44 the fixation probability of type @xmath6 follows a classical result of kimura ( 1962 ) ( see also ewens ( 2004 , ch .",
    "5.3 ) ) : @xmath45    see also ewens ( 2004 , ch . 4 , 5 ) or karlin and taylor ( 1981 , ch .",
    "15 ) for reviews of the diffusion process describing the moran model with selection and its probability of fixation .",
    "according to kluth et al .",
    "( 2013 ) and previous results of fearnhead ( 2002 ) and taylor ( 2007 ) ( obtained in the context of the common ancestor process in the moran model with selection and mutation ) , the equivalent of reads @xmath46 with coefficients @xmath47 , @xmath48 . following and",
    ", the @xmath49 are characterised by the recursion @xmath50 with initial conditions @xmath51",
    "durrett ( 2008 , ch .",
    "6.1.1 ) proves equation in two ways , namely , using a first - step approach and a martingale argument , respectively .",
    "both approaches rely on the process @xmath52 , without reference to an underlying particle representation . as a warm - up exercise ,",
    "we complement this by an approach based on the particle picture , which we call the _ reflection principle_.    let a graphical realisation of the moran model be given , with @xmath53 , @xmath54 , and fixation of type @xmath6 .",
    "now interchange the types ( i.e. , replace all @xmath6 individuals by @xmath4 individuals and vice versa ) , without otherwise changing the graphical realisation .",
    "this results in a graphical realisation of the moran model with @xmath55 in which type @xmath4 becomes fixed , and is called the reflected realisation .",
    "put differently , in the case @xmath53 , @xmath54 , reflection transforms a realisation in which the ( offspring of the ) @xmath22 type-@xmath6 individuals become fixed ( altogether , this happens with probability @xmath56 ) into a realisation in which the ( offspring of the ) type-@xmath4 individuals become fixed ( which happens with probability @xmath57 ) , and vice versa . this operation does not change the graphical structure , but the weights of the realisations are different since a different weight is attached to some of the arrows .",
    "this is best explained in the example given in fig .",
    "[ mirroring ] : bold lines represent type-@xmath6 individuals , thin ones type-@xmath4 individuals ; likewise , arrows emanating from type-@xmath6 ( type-@xmath4 ) individuals are bold ( thin ) .",
    "interchange of types transforms the realisation on the left into the realisation on the right and vice versa , such that the respective other type becomes fixed .",
    "arrows that are marked by @xmath5 respectively @xmath58 appear at rate @xmath59 respectively @xmath60 ( per _ pair _ of individuals ) .    , @xmath61 , realisations @xmath62 ( left ) and @xmath63 ( right ) .",
    "altogether @xmath64 . , width=226,height=170 ]    , @xmath61 , realisations @xmath62 ( left ) and @xmath63 ( right ) .",
    "altogether @xmath64 . , width=226,height=170 ]    to make the situation tractable , we will work with what we will call the _ reduced moran model _ :",
    "starting from the original moran model , we remove those selective arrows that appear between individuals that are both of type @xmath6",
    ". obviously , this does not affect the process @xmath12 ( in particular , it does not change the fixation probabilities ) , but it changes the graphical representation .",
    "that is , in fig .",
    "[ mirroring ] unmarked arrows appear at rate @xmath59 .",
    "let now @xmath65 be the set of graphical realisations of the reduced moran model for @xmath66 $ ] , where @xmath67 .",
    "let @xmath68 be the probability measure on @xmath65 , given @xmath53 , @xmath54 .",
    "for a realisation @xmath69 with @xmath53 , @xmath54 , in which @xmath6 becomes fixed ( cf .",
    "[ mirroring ] , left ) , we define @xmath70 as the corresponding reflected realisation ( cf .",
    "[ mirroring ] , right ) .",
    "our strategy will now be to derive the fixation probabilities by comparing the weights of @xmath62 and @xmath63 . to assess the relative weights of @xmath71 and @xmath72 , note first that , since @xmath6 becomes fixed in @xmath62 , all @xmath73 type-@xmath4 individuals have to be replaced by type-@xmath6 individuals , i.e. by arrows that appear at rate @xmath74 . in @xmath63 , the corresponding arrows point from type-@xmath4",
    "to type-@xmath6 individuals and thus occur only at rate @xmath59 .",
    "second , we have to take into account so - called _ external descendants _ defined as follows :    a descendant of a type-@xmath17 individual , @xmath75 , that originates by replacing an individual of a different type ( @xmath76 ) is termed external descendant of type @xmath17 .",
    "[ new descendant ]    the total number of external descendants of type @xmath17 is almost surely finite .",
    "every external descendant of a type-@xmath4 individual goes back to an arrow that occurs at rate @xmath59 .",
    "if the type-@xmath6 individuals go to fixation ( as in @xmath62 ) , all external descendants of type @xmath4 must eventually be replaced by arrows that emanate from type-@xmath6 individuals and therefore occur at rate @xmath77 . in @xmath63",
    "this situation corresponds to external descendants of type @xmath6 that originate from arrows at rate @xmath78 and are eventually eliminated by arrows that emanate from type-@xmath4 individuals . in fig . [ mirroring ] ,",
    "the births of external descendants and their replacements are represented by dotted arrows , which always appear in pairs .",
    "dashed arrows represent the elimination of individuals ( except external descendants ) of the type that eventually gets lost in the population .",
    "let now @xmath79 be the number of external descendants of type @xmath4 in @xmath62 . then @xmath80 almost surely and we obtain for the measure of @xmath63 @xmath81 \\\\   & = ( 1+s_n^{})^{-(n - k ) } p^n_{k}(\\omega ) d\\omega.\\end{aligned}\\ ] ] note that the effects of creating external descendants and their replacement cancel each other , so that the relative weights of @xmath82 and @xmath83 do not depend on @xmath62 . since reflection provides a one - to - one correspondence between realisations with fixation of type @xmath6 and of type @xmath4 , respectively , we obtain the system of equations @xmath84 which is supplemented by @xmath85 and @xmath86 , and which is solved by .",
    "in this section we introduce a new particle model , which we call the _ labelled moran model _ , and which has the same distribution of type frequencies as the original moran model with selection of sec . [ the moran model with selection ] , provided the initial conditions are chosen appropriately . as before , we consider a population of fixed size @xmath0 in continuous time , but now every individual is assigned a label @xmath87 with different reproductive behaviour to be specified below .",
    "the initial population contains all @xmath0 labels so that initially position @xmath17 in the graphical representation is occupied by label @xmath17 , @xmath88 . as in the original moran model ,",
    "birth events are represented by arrows ; they lead to a single offspring , which inherits the parent s label , and replaces an individual as explained below .",
    "again we distinguish between neutral ( at rate @xmath59 ) and selective ( at rate @xmath89 ) events .",
    "neutral arrows appear as before , at rate @xmath59 per ordered pair of lines , irrespective of their labels .",
    "but we only allow for selective arrows emanating from a label @xmath17 and pointing to a label @xmath90 ( at rate @xmath89 per ordered pair of lines with such labels ) .",
    "equivalently , we may take together both types of arrows , such that an arrow points from a label @xmath17 to a label @xmath91 at rate @xmath59 and to label @xmath92 at rate @xmath74 .",
    "we will make use of both points of view .",
    "the idea is to have each label behave as ` less fit ' towards lower labels and as ` more fit ' towards higher labels .",
    "an example is given in fig .",
    "[ labelmoran ] , where neutral arrows are marked by @xmath5 and selective arrows by @xmath9 .",
    "since there is no mutation in the labelled moran model , one of the @xmath93 labels will eventually take over in the population , i.e. one label will become fixed .",
    "we denote this label by @xmath94 and term it the ancestor .",
    "its distribution is given in thm .",
    "[ thm fixation ] .",
    "@xmath94 is distributed according to @xmath95 [ thm fixation ]    we will give two proofs of thm .",
    "[ thm fixation ] .",
    "the first provides an intuitive explanation and is based on the type frequencies . in the second proof , we will use an alternative approach in the spirit of the reflection principle of sec .",
    "[ reflection principle ] , which provides more insight into the particle representation .",
    "this proof is somewhat more complicated , but it permits us to classify reproduction events into those that have an effect on the fixation probability of a given label and those that do not ; this will become important later on . in analogy with def .",
    "[ new descendant ] we define _ external descendants of labels in @xmath96 _ , @xmath97 , as descendants of individuals with labels in @xmath96 that originate by replacing an individual of a label in the complement of @xmath96 .    for a given @xmath17 ,",
    "let @xmath98 be the number of individuals with labels in @xmath99 at time @xmath14 .",
    "like @xmath12 , the process @xmath100 is a birth - death process with rates @xmath101 and @xmath102 of .",
    "this is because every individual with label in @xmath99 sends arrows into the set with labels in @xmath103 at rate @xmath74 ; in the opposite direction , the rate is @xmath59 per pair of individuals ; and arrows within the label classes do not matter . since @xmath104 , the processes @xmath105 and @xmath12 thus have the same law provided @xmath106 . as a consequence , @xmath107 , @xmath88 , which , together with , immediately yields the assertions of thm .",
    "[ thm fixation ] .",
    "this proof aims at a direct calculation of @xmath108 , @xmath109 , as a function of @xmath110 .",
    "let a realisation of the labelled moran model be given in which label @xmath0 becomes fixed ( this happens with probability @xmath110 , still to be calculated ) .",
    "the basic idea now is to move every arrow by way of a cyclic permutation of the arrows positions , while keeping the initial ordering of the labels .",
    "more precisely , in the graphical representation we move every arrow @xmath17 positions to the right ( or , equivalently , @xmath111 positions to the left ) .",
    "that is , we shift an arrow that appears at time @xmath14 with tail at position @xmath22 and head at position @xmath112 , such that it becomes an arrow that emanates from position @xmath113 and points to position @xmath114 , again at time @xmath14 .",
    "we thus obtain what we will call the _ permuted realisation of order @xmath17_. in this realisation , label @xmath17 is fixed , as illustrated in fig .",
    "[ cyclic ] for a labelled moran model of size @xmath115 . here",
    ", the descendants of the label that becomes fixed are marked bold .",
    "arrows that are marked by @xmath5 respectively @xmath58 appear at rate @xmath59 respectively @xmath60 .",
    "a shift of every arrow of @xmath116 positions to the right transforms the left realisation , in which label @xmath115 becomes fixed , into the right one ( with fixation of label @xmath117 ) . throughout",
    ", we keep the original meaning of the labels : between every ordered pair of lines with labels @xmath118 , arrows appear at rate @xmath74 if @xmath119 , and at rate @xmath59 otherwise . since , in the permuted realisation , we change the _ position _ of each arrow , it now may affect a different pair of _ labels _ , which may change the arrow s rate . as a result",
    ", the permuted realisation has a different weight than the original one ; this will now be used to calculate @xmath108 .",
    "( mathematically , the following may be seen as a _ coupling argument_. )    so , let @xmath65 be the set of realisations of the labelled moran model for @xmath66 $ ] , where @xmath120 now is the time at which one of the labels is fixed .",
    "let @xmath121 be the probability measure on @xmath65 .",
    "for a realisation @xmath122 in which label @xmath0 becomes fixed ( cf .",
    "[ cyclic ] , left ) , we define @xmath123 as the corresponding permuted realisation of order @xmath17 ( cf .",
    "[ cyclic ] , right ) .",
    "we will now calculate @xmath108 by assessing the weight of the measure of @xmath124 relative to that of @xmath125 .",
    "below we run briefly through the cases to analyse the change of weight on the various types of arrows . to this end",
    ", the label sets @xmath126 and @xmath127 ( left ) , and @xmath128 and @xmath129 ( right ) , respectively , are encircled at the top of fig .",
    "[ cyclic ] .    , @xmath117 , realisations @xmath130 ( left ) and @xmath131 ( right ) .",
    "altogether @xmath132.,width=226,height=170 ]    , @xmath117 , realisations @xmath130 ( left ) and @xmath131 ( right ) .",
    "altogether @xmath132.,width=226,height=170 ]    1 .",
    "arrows in @xmath133 that point from and to labels within the sets @xmath126 or @xmath127 , respectively , turn into arrows within the sets @xmath134 or @xmath128 , respectively , under the permutation .",
    "such arrows retain their ` direction ' ( with respect to the labels ) and thus appear at identical rates in @xmath133 and @xmath135 ( cf .",
    "solid arrows in fig .",
    "[ cyclic ] ) .",
    "2 .   arrows in @xmath133 that emanate from the set of labels @xmath136 and point to the set of labels @xmath137 occur at rate @xmath77 and create external descendants of labels in @xmath136 . since label @xmath0 becomes fixed , every such external descendant is eventually eliminated by an arrow at rate @xmath59 .",
    "the corresponding situation in @xmath135 concerns external descendants of labels in @xmath134 , which result from neutral arrows and finally are replaced at rate @xmath78 each . in fig .",
    "[ cyclic ] there is exactly one external descendant of the labels in @xmath126 ( left ) and @xmath138 ( right ) , respectively .",
    "it originates from the respective first dotted arrow , and is replaced via the second dotted arrow .",
    "3 .   it remains to deal with the replacement of the labels @xmath139 ( except for their external descendants ) in @xmath133 .",
    "exactly @xmath111 neutral arrows are responsible for this , they transform into arrows at rate @xmath78 through the permutation .",
    "these are the dashed arrows in fig .",
    "[ cyclic ] .",
    "let now @xmath140 be the number of external descendants of labels in @xmath141 in @xmath133 ( @xmath142 almost surely ) . then",
    ", ( a ) - ( c ) yield for the measure of @xmath135 @xmath143 \\\\    & = ( 1+s_n^{})^{n - i } p^n _ { } ( \\omega_n^ { } ) d \\omega_n^ { } .   \\end{aligned}\\ ] ] as in the reflection principle , the effects of the external descendants cancel each other and so the relative weights of @xmath144 and @xmath145 are independent of the particular choice of @xmath133 . since the cyclic permutation yields a one - to - one correspondence between realisations that lead to fixation of label @xmath0 and label @xmath17 , respectively , we obtain @xmath146 finally , the normalisation @xmath147 yields the assertion of thm .",
    "[ thm fixation ] .",
    "we are now ready to investigate the effect of selection in more depth . the second proof of thm .",
    "[ thm fixation ] allows us to identify the reproduction events that affect the distribution of @xmath94 ( i.e. that are responsible for the factor @xmath148 in ) with the dashed arrows in fig .",
    "[ cyclic ] ( cf .",
    "case ( c ) ) , whereas dotted arrows appear pairwise and their effects cancel each other ( cf . case ( b ) ) .",
    "it is natural to term these reproductions _ defining events _ :    a defining event is an arrow that emanates from the set of labels @xmath149 and targets individuals with labels in the set @xmath150 that are not external descendants of labels in @xmath150 .",
    "loosely speaking , a defining event occurs every time the descendants of @xmath151 ` advance to the right ' .",
    "in particular , for every @xmath152 , the first arrow that emanates from a label in @xmath153 and hits the individual at position @xmath154 is a defining event .",
    "altogether , there will be @xmath155 defining events until fixation .",
    "it is important to note that they need not be reproduction events of the ancestral label @xmath94 itself .",
    "see fig . [ defining ] for an illustration , in which the ancestor @xmath94 is indicated at the top ,",
    "its descendants are marked bold , and the defining events are represented by dashed arrows . on the left ,",
    "both defining events are reproduction events of @xmath94 .",
    "the arrows that are indicated by and   are not defining events , since the first one ( ) concerns only labels within @xmath150 and the second one ( ) targets an external descendant of @xmath150 . on the right ,",
    "only the second defining event is a reproduction event of @xmath94 , whereas the first one in a reproduction event of a label less than @xmath94 .",
    "it is clear that all defining events appear at rate @xmath74 .",
    "decomposing these arrows into neutral and selective ones reveals that each defining event is either a selective ( probability @xmath156 ) or a neutral ( probability @xmath157 ) reproduction event , independently of the other defining events and of @xmath94 .",
    "let @xmath158 , @xmath159 , be the corresponding family of bernoulli random variables that indicate whether the respective defining event is selective .",
    "let @xmath160 denote the _ number of selective defining events _ , that is , @xmath161 with the independent and identically distributed ( i.i.d . )",
    "bernoulli variables @xmath158 just defined .",
    "@xmath160 will turn out as a pivotal quantity for everything to follow .",
    "we now characterise its distribution , and the dependence between @xmath94 and @xmath160",
    ". this will also provide us with an interpretation of the coefficients @xmath25 in , as well as another representation of the fixation probabilities .",
    "it is clear from that @xmath160 is distributed according to bin@xmath162 , the binomial distribution with parameters @xmath155 and @xmath156 in the sense of a two - stage random experiment .",
    "that is , given @xmath163 , @xmath164 follows bin@xmath165 .",
    "thus , for @xmath166 , we obtain ( via ) @xmath167 where the last equality is due to the well - known identity @xmath168 in particular , @xmath169 .",
    "obviously , @xmath170 , @xmath48 , may also be expressed recursively as @xmath171 furthermore , equations and immediately yield the conditional probability @xmath172 compare now with and , for the initial condition , compare with ( with the help of ) .",
    "obviously , the @xmath173 and the @xmath174 , @xmath175 , have the same initial value ( at @xmath176 ) and follow the same recursion , so they agree . via normalisation , we further have @xmath177 we have therefore found a probabilistic meaning for the @xmath25 , @xmath178 , namely , @xmath179 this will be crucial in what follows .",
    "another interesting characterisation is the following :    let @xmath180 . then @xmath181 has the distribution of a random variable that follows bin@xmath182 , _ conditioned to be positive . _",
    "[ proposition y+1 ]    let @xmath6 be a random variable distributed according to bin@xmath182",
    ". then @xmath183 by the geometric series . for @xmath48 , therefore , @xmath184 where the last step is due to .",
    "this proves the claim .",
    "note that label @xmath0 is obviously not capable of selective reproduction events and its fixation implies the absence of ( selective ) defining events .",
    "its fixation probability @xmath110 coincides with the fixation probability of any label @xmath17 , @xmath88 , in the absence of any selective defining events : @xmath185 , cf . .",
    "for this reason , we term @xmath110 the _ basic fixation probability _ of every label @xmath17 , @xmath88 , and express all relevant quantities in terms of @xmath110 .",
    "note that , for @xmath186 , @xmath110 is different from the _ neutral fixation probability _",
    ", @xmath187 , that applies to every label @xmath17 , @xmath88 , in the case @xmath188 .",
    "+ decomposition according to the number of selective defining events yields a further alternative representation of the fixation probability @xmath189 ( cf . ) of the moran model .",
    "consider @xmath190 where we have used and .",
    "this leads us to the following series expansion in @xmath9 : @xmath191   s^n_n \\eta_n^n .",
    "\\end{split }   \\label{h_i alternativ}\\ ] ] we will come back to this in the next section .",
    "in this section we analyse the number of selective defining events in the diffusion limit ( cf .",
    "sec . [ the moran model with selection ] ) .",
    "first of all we recapitulate from and that @xmath192 for a sequence @xmath193 with @xmath194 , @xmath195 , and @xmath41 $ ] , this yields @xmath196 where we have used the convergence of the binomial to the poisson distribution .",
    "thus , the sequence of random variables @xmath197 converges in distribution to a pair @xmath198 of random variables with values in @xmath199 $ ] and distribution function .",
    "marginalisation with respect to the second variable implies that @xmath200 has distribution function @xmath201 . as a consequence ,",
    "@xmath202 follows poi@xmath203 , the poisson distribution with parameter @xmath204 . since @xmath205 with coefficients @xmath49 as in and , we may conclude that @xmath206 for @xmath207 .",
    "we thus have found an interpretation of the coefficients @xmath49 in .",
    "in particular , @xmath208^{-1 } \\\\   & = \\left [ \\int_{0}^{1 } \\exp(\\sigma p ) dp \\right]^{-1 }   = \\frac{\\sigma}{\\exp(\\sigma)-1 } ,   \\label{a1 label }   \\end{split}\\ ] ] where we have used and . according to we have the recursion @xmath209 for @xmath48 and iteratively via and @xmath210 for @xmath207 . with an argument analogous to that in prop .",
    "[ proposition y+1 ] , one also obtains that @xmath211 has the distribution of a random variable following poi@xmath212 , conditioned to be positive .",
    "we now aim at expressing @xmath201 in terms of a decomposition according to the values of @xmath202 ( in analogy with ) .",
    "we recapitulate equation to obtain @xmath213 then , the equivalent to is a series expansion in @xmath214 : @xmath215 note that this can also be derived directly from by a taylor expansion around the point @xmath216",
    ".    finally note that may also be expressed as @xmath217 interestingly , but not unsurprisingly , this coincides with a representation given by pokalyuk and pfaffelhuber ( 2013 , lemma 2.2 ) in their proof of kimura s fixation probability .",
    "they follow an argument of mano ( 2009 ) that establishes a connection between the asg at stationarity and the fixation probability .",
    "a key here is the insight that the number of lines in the asg at stationarity has the distribution of a random variable that follows poi@xmath212 , conditioned to be positive  which coincides with the distribution of @xmath218 .",
    "we have , so far , been concerned with the ancestral label and with the number of selective defining events , but have not investigated the _ targets _ of these events yet .",
    "this will now be done .",
    "we begin with another definition .",
    "let @xmath160 take the value @xmath219 .",
    "we then denote by @xmath220 , with @xmath221 , the ( random ) positions that are hit by the @xmath219 selective defining events .",
    "[ targets ] for an example , in which @xmath222 , @xmath223 , @xmath224 , @xmath225 and @xmath226 . note that the first selective defining event hits position @xmath227 , which is occupied by an individual of label @xmath228 at that time .        in terms of the family @xmath229 , @xmath159 , of i.i.d .",
    "bernoulli random variables ( cf .",
    "[ defining events ] ) , the @xmath230 are characterised as @xmath231 ( for @xmath232 we have the empty set . )",
    "given that @xmath233 , the @xmath219-tuple @xmath234 is uniformly distributed ( without replacement ) on the set of positions @xmath235 : @xmath236 which implies ( via ) @xmath237 hence , the @xmath238-tuples @xmath239 are sampled from @xmath240 uniformly without replacement .",
    "note that @xmath241 of prop .  1 is the size of this tuple .",
    "note also that the tuples do not contain any further information about the appearance of arrows in the particle picture .",
    "in particular , we do not learn which label ` sends ' the arrows , nor do we include selective arrows that do not belong to defining events .",
    "it is instructive to formulate a simulation algorithm ( or a construction rule ) for these tuples .",
    "first draw the number of selective defining events , that is , a realisation @xmath219 of @xmath160 ( according to ) .",
    "then simulate @xmath239 in the following way :    step 0 : : :    generate a random number @xmath242 that is uniformly    distributed on @xmath243 .",
    "define    @xmath244 .",
    "if @xmath245    continue with step @xmath5 , otherwise stop .",
    "step 1 : : :    generate ( independently of @xmath242 ) a second random    number @xmath246 that is uniformly distributed on    @xmath247 .    +    ( a ) ; ;      if @xmath248 , define      @xmath249 ,      @xmath250 .",
    "( b ) ; ;      if @xmath251 , define      @xmath252 ,      @xmath253 .    +    if @xmath254 continue with step @xmath255 , otherwise    stop .",
    "step k : : :    generate ( independently of    @xmath256 ) a random number    @xmath257 that is uniformly distributed on    @xmath258 .    +    ( a ) ; ;      if @xmath259 , define      @xmath260 and      assign the variables      @xmath261      to @xmath262 ,      such that      @xmath263 .",
    "( b ) ; ;      if @xmath264 , define      @xmath265 ,      @xmath266 and      @xmath267      for @xmath268 .",
    "+    if @xmath269 continue with step @xmath270 , otherwise    stop .",
    "[ algorithm ]    the simulation algorithm first produces a vector @xmath271 uniformly distributed on the set of _ unordered _ @xmath238-tuples and then turns it into the vector @xmath272 , which is uniformly distributed on the set of _ ordered _ @xmath238-tuples .",
    "the latter therefore has the same distribution as the vector of random variables @xmath273 , given @xmath233 ( cf . ) .",
    "the interesting point now is that we may interpret the algorithm as a procedure for the construction of the ancestral line .",
    "it successively adds selective arrows to realisations of the labelled moran model , such that they coincide with additional selective defining events ; obviously , @xmath274 is the number of steps .",
    "this genealogical interpretation is best explained with the help of the illustrations in figs .",
    "[ step1 ] and [ stepk ] . for each graphical representation the corresponding ancestors ( @xmath275 , @xmath276 , @xmath277 , and @xmath278 , respectively ) and , if present , the targets of the selective defining events ( @xmath279 , @xmath280 , and @xmath281 , respectively ) are indicated at the top .",
    "bold lines represent the genealogy of the entire population at the bottom . in step",
    "@xmath19 we randomly choose one of the @xmath0 labels .",
    "this represents the label that becomes fixed , i.e. the ancestor , in a particle representation with no selective defining events ( cf .",
    "[ step1 ] , left ) .",
    "( actually , this coincides with the neutral situation , @xmath188 . ) in the following steps selective arrows are added one by one , where the point to note is that each of them may or may not move the ancestor ` to the left ' , depending on whether ( a ) or ( b ) applies .",
    "lines that have been ancestors in previous steps of the algorithm are represented by dotted lines .",
    "for instance , let us consider step @xmath22 , that is , a realisation with @xmath282 selective defining events is augmented by a further one . in case",
    "( a ) ( cf . figs .",
    "[ step1 ] and [ stepk ] , middle ) we add a selective defining event that does not change the label that becomes fixed ( i.e. the ancestor remains the same ) , and that targets the newly chosen position @xmath257 .",
    "in contrast , in case ( b ) ( cf",
    "[ step1 ] and [ stepk ] , right ) the additional selective defining event emanates from position @xmath257 and hits the ancestor of the previous step ( which ceases to be ancestor ) .",
    "the result is a shifting of the ancestor ` to the left ' , i.e. to position @xmath257 .",
    "that is , each selective defining event that goes back to case ( b ) gives rise to a new dotted line in figs .",
    "[ step1 ] and [ stepk ] . to avoid misunderstandings",
    ", we would like to emphasise that the details of the genealogies in the pictures are for the purpose of illustration only ; the only thing we really construct is the sequence of tuples @xmath283 .     and",
    "@xmath5 of algorithm [ algorithm ] and corresponding genealogical interpretations . left : step @xmath19 ( no selective defining events ) , middle : step @xmath5 ( a ) , right : step @xmath5 ( b ) ( each with one selective defining event).,width=132,height=158 ]     and @xmath5 of algorithm [ algorithm ] and corresponding genealogical interpretations . left : step @xmath19 ( no selective defining events ) , middle : step @xmath5 ( a ) ,",
    "right : step @xmath5 ( b ) ( each with one selective defining event).,width=132,height=158 ]     and @xmath5 of algorithm [ algorithm ] and corresponding genealogical interpretations .",
    "left : step @xmath19 ( no selective defining events ) , middle : step @xmath5 ( a ) , right : step @xmath5 ( b ) ( each with one selective defining event).,width=132,height=158 ]     of algorithm [ algorithm ] and corresponding genealogical interpretations .",
    "situation after step @xmath282 ( left ) and its modification according to step @xmath22 ( a ) ( middle ) and step @xmath22 ( b ) ( right).,width=162,height=170 ]     of algorithm [ algorithm ] and corresponding genealogical interpretations .",
    "situation after step @xmath282 ( left ) and its modification according to step @xmath22 ( a ) ( middle ) and step @xmath22 ( b ) ( right).,width=162,height=170 ]     of algorithm [ algorithm ] and corresponding genealogical interpretations .",
    "situation after step @xmath282 ( left ) and its modification according to step @xmath22 ( a ) ( middle ) and step @xmath22 ( b ) ( right).,width=162,height=170 ]    we now have everything at hand to provide a genealogical interpretation for the fixation probabilities @xmath189 respectively @xmath284 ( cf . respectively ) .",
    "we have seen that the tuples @xmath285 are constructed such that @xmath286 for all @xmath207 and @xmath287 , and , via marginalisation , @xmath288 we reformulate the decomposition of to obtain @xmath289   \\mathbb{p } ( y^n _ { } \\geq n ) \\nonumber \\displaybreak[0 ] \\\\   & = \\mathbb{p } ( \\mathcal{i}^{(0 ) } _ { } \\leq i ) \\mathbb{p } ( y^n _ { } \\geq 0 )   + \\sum_{n = 1}^{n-1 } \\left [ \\mathbb{p } ( \\mathcal{i}^{(n ) } _ { } \\leq i ) -\\mathbb{p } ( \\mathcal{i}^{(n-1 ) } _ { } \\leq i ) \\right ]   \\mathbb{p } ( y^n _ { } \\geq n ) \\nonumber \\displaybreak[0 ] \\\\ & = \\mathbb{p } ( \\mathcal{i}^{(0 ) } _ { } \\leq i)\\mathbb{p } ( y^n _ { } \\geq 0 ) + \\sum_{n = 1}^{n-1 } \\mathbb{p}(\\mathcal{i}^{(n ) } _ { } \\leq i , \\mathcal{i}^{(n-1 ) } _ { } > i ) \\mathbb{p } ( y^n _ { } \\geq n ) , \\label{h_i simulation } \\ ] ] where the last equality is due to the fact that the ancestor s label is non - increasing in @xmath219 .",
    "in , the fixation probability @xmath189 is thus decomposed according to the first step in the algorithm in which the ancestor has a label in @xmath290 .",
    "the probability that this event takes place in step @xmath219 may , in view of the simulation algorithm , be expressed explicitly as @xmath291 \\nonumber \\\\   & = \\mathbb{p}(u^{(n ) } _ { } \\leq i , u^{(0 ) } _ { } , u^{(1 ) } _ { } , \\dots ,    u^{(n-1 ) } _ { } >",
    "i ) \\displaybreak[0 ] \\nonumber \\\\   & = \\frac{i}{n } \\prod_{j=0}^{n-1 } \\frac{n - i - j}{n-1-j}.   \\label{diskrete sampling distribution}\\end{aligned}\\ ] ] together with and this provides us with a term - by - term interpretation of .    in particular",
    ", implies that @xmath292 for a sequence @xmath193 with @xmath194 and @xmath195 , @xmath41 $ ] .",
    "thus , in the diffusion limit , and with @xmath293 of , turns into @xmath294 which is the representation , and which is easily checked to coincide with ( as obtained by the direct approach of sec .",
    "[ diffusion limit of the labelled moran model ] ) .",
    "we have reanalysed the process of fixation in a moran model with two types and ( fertility ) selection by means of the labelled moran model .",
    "it is interesting to compare the labelled moran model with the corresponding lookdown construction : in the lookdown with fertility selection , _ neutral _ arrows only point in one direction ( from lower to higher levels ) , whereas _ selective _ arrows may appear between arbitrary levels .",
    "in contrast , the labelled moran model contains _",
    "neutral arrows in all directions _ , but _ selective arrows _ only occur from lower to higher labels . also , the labelled moran model deliberately dispenses with exchangeability , which is an essential ingredient of the lookdown .",
    "it may be possible to transform the labelled moran model into a lookdown ( by way of random permutations ) , but this remains to be verified .",
    "we certainly do not advertise the labelled moran model as a general - purpose tool ; in particular , due to its arbitrary neutral arrows , it does not allow the construction of a sequence of models with increasing @xmath0 on the same probability space .",
    "however , it turned out to be particularly useful for the purpose considered in this paper ; the reason seems to be that the fixation probabilities of its individuals , @xmath108 , coincide with the individual terms in .",
    "likewise , we obtained a term - by - term interpretation of the fixation probability as a decomposition according to the number of selective defining events , which may successively shift the ancestral line to the left , thus placing more weight on the ` more fit ' individuals .",
    "indeed , the incentive for this paper was the intriguing representation of the fixation probabilities , which was first observed by fearnhead ( 2002 ) in the context of ( a pruned version of ) the asg , for the diffusion limit of the moran model with mutation and selection at stationarity , and further investigated by taylor ( 2007 ) .",
    "quite remarkably , carries over to the case without mutation ( which turns the stationary markov chain into an absorbing one ) , with fearnhead s @xmath49 reducing to ours ( see kluth et al .",
    "( 2013 ) and sec .",
    "[ the moran model with selection ] ) .",
    "the observation that our @xmath218 , that is , @xmath5 plus the number of selective defining events in the diffusion limit , has the same distribution as the number of branches in the asg ( see sec .",
    "[ diffusion limit of the labelled moran model ] ) fits nicely into this context , but still requires some further investigation .",
    "needless to say , the next challenge will be to extend the results to the case with mutation  this does not seem to be straightforward but is quite possible , given the tools and insights that have become available lately .",
    "it is our pleasure to thank anton wakolbinger , ute lenz , and alison etheridge for enlightening discussions .",
    "this project received financial support from deutsche forschungsgemeinschaft ( priority programme spp 1590 ` probabilistic structures in evolution ' , grant no .",
    "ba 2469/5 - 1 ) .",
    "bah , b. , pardoux , e. , sow , a. b. , 2012 . a look - down model with selection .",
    "in : stochastic analysis and related topics : in honour of ali sleyman stnel , paris , june 2010 , ( l. decreusefond , j. najim eds . ) , pp . 1 - 28 .",
    "springer , berlin , heidelberg ."
  ],
  "abstract_text": [
    "<S> * abstract . * </S>",
    "<S> we reconsider the moran model in continuous time with population size @xmath0 , two allelic types , and selection . </S>",
    "<S> we introduce a new particle representation , which we call the labelled moran model , and which has the same distribution of type frequencies as the original moran model , provided the initial values are chosen appropriately . in the new model , </S>",
    "<S> individuals are labelled @xmath1 ; neutral resampling events may take place between arbitrary labels , whereas selective events only occur in the direction of increasing labels . with the help of elementary methods only </S>",
    "<S> , we not only recover fixation probabilities , but also obtain detailed insight into the number and nature of the selective events that play a role in the fixation process forward in time . </S>",
    "<S> * key words : * moran model with selection , fixation probability , labelled moran model , defining event , ancestral line . </S>"
  ]
}