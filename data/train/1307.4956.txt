{
  "article_text": [
    "in this paper we demonstrate methods for exact computation in statistical analysis of dna mixtures , where the need for summation over the space of possible dna profiles for unknown contributors traditionally has involved some degree of approximation @xcite and has only been made for two or three unknown contributors @xcite .",
    "in contrast , using the methodology presented here and the corresponding implementation by @xcite in the ` r`-package @xmath0 , @xcite were able to perform exact evaluation and subsequent numerical maximisation of the likelihood function for up to six unknown contributors .",
    "the present paper develops a suite of tools for inference in the statistical model described in @xcite enabling evaluation of the likelihood function , computation of posterior probability of genotypes given a set of observed peak heights , and assessment of model adequacy .",
    "we exploit introduction of auxiliary variables combined with an efficient representation of the genotypes as a bayesian network .",
    "the implementation in ` dnamixtures ` interfaces the hugin api @xcite via ` rhugin ` @xcite .",
    "the plan of the paper is as follows : section  [ sec : model ] briefly describes the relevant model for dna mixture analysis and the computational methods are detailed in  section  [ sec : bayesnet ] . in section  [ sec : mixtureanal ] we show how the methodology can be extended to calculate various quantities of interest ; in particular we develop methods for assessing the adequacy of the model .",
    "in statistical analysis of dna mixtures it is of interest to draw inference about individual dna profiles in a mixed trace of dna .",
    "the observations consists of a set of peak heights in an electropherogram ( epg ) produced after a chemical duplication process known as a polymerase chain reaction ( pcr ) .",
    "figure  [ fig : epg ] represents a schematic illustration of part of an epg .",
    "the dna sequences at short tandem repeat ( str ) _ markers _ are characterised by a motif of base pairs repeated a number of times , so that a specific repeat number corresponding to an _ allele _ and a peak in the epg typically indicates presence of the corresponding allele .",
    "a pair of alleles is called a _ genotype _ , and the genotypes across a set of markers constitute the _ dna profile_. the markers used for forensic identification are typically located at different chromosome - pairs or , if not , on well separated locations , rendering it reasonable to assume independence of genotypes across markers .    the observed epg is prone to artefacts known as _ stutter",
    "_ and _ dropout _ : stutter refers to the phenomenon that some of the dna alleles may lose a repeat motif during the pcr process and thus contribute to a peak at a lower repeat number . if there are allelic types @xmath1 we thus assume that any allele @xmath2 receives stutter from the amplification of allele @xmath3 .",
    "dropout refers to the fact that peak heights occasionally are too small for the peak to be registered .",
    "we distinguish between known and unknown contributors to the sample , depending on whether their dna profile is considered known or not .",
    "the computational complexity of the problem is directly associated with the huge number of possible allocations of genotypes to the unknown contributors .",
    "the genotypes of a dna profile are assumed independent across markers so we briefly describe the model for one marker only , following @xcite .",
    "we assume that the alleles of an unknown person are sampled from a reference population in hardy  weinberg equilibrium so that the two alleles can be considered sampled independently .",
    "denote by @xmath4 the number of alleles of type @xmath2 for contributor @xmath5 .",
    "a genotype @xmath6 for an unknown contributor follows a multinomial distribution with allele frequencies @xmath7 and @xmath8 .",
    "unknown contributors are assumed unrelated so their genotypes are independent .      analysing dna that contains alleles of type @xmath2 results in a peak at position @xmath2 , and possibly also a smaller peak at position @xmath9 due to stutter during the pcr process",
    "; thus the height of the peak @xmath10 for allele @xmath2 depends on the presence of alleles of both type @xmath2 and type @xmath3 .",
    "peaks of height @xmath11 below a chosen threshold @xmath12 are not registered and so the observed peak heights are @xmath13 .    for given genotypes of the contributors we assume that the peak height @xmath11 at allelic type @xmath2 is gamma distributed with shape and scale parameters depending on the numbers @xmath4 , @xmath14 of alleles of type @xmath2 and @xmath3 that each unknown contributor @xmath5 possesses , as well as a set of model parameters , @xmath15 ; more precisely we assume that @xmath16 , where @xmath17 here , and in the following , we have let @xmath18 ; the parameter @xmath19 is the _",
    "mean stutter percentage _ , @xmath20 is related to the general peak variability , @xmath21 denotes the fraction of dna from individual @xmath5 , and @xmath22 is the scale .",
    "if @xmath23 the gamma distribution @xmath24 is considered degenerate at 0 .",
    "the likelihood function is determined by the distribution of the observed peak heights .",
    "the observed peak heights are independent across markers @xmath25 , and thus the likelihood function factorises accordingly .",
    "using this fact in combination with we find @xmath26 where the expectation is taken with respect to the distribution of genotypes of the unknown contributors .",
    "here and in the following @xmath27 denotes the full set of genotypes for all individuals and @xmath28 the vector @xmath29 of allele - counts of type @xmath2 . the expectation in involves summation over all combinations of possible genotypes of potential contributors .",
    "there are @xmath30 possible combinations of genotypes at a marker , and thus there are this many terms in the sum , each being a product of @xmath31 factors .",
    "direct computation is typically infeasible when there are many alleles and many unknown contributors .",
    "we attack this computational problem by appropriate use of bayesian network techniques , as detailed in section  [ sec : bayesnet ] below .",
    "note that our methodology can be used directly with other choices of distribution for the peak heights , provided that the distribution of the peak height for allele @xmath2 depends only on the genotypes through the number of alleles of types @xmath2 and @xmath3 .",
    "as a consequence of , and for other purposes , the computational task in dna mixture analysis involves repeated computation of the expectation @xmath32 of non - negative functions @xmath33 of a set of discrete variables @xmath34 .",
    "we describe our computational approach in thid general setting before returning to the dna mixture model in section  [ sec : gtnet ] , where we give a network representation of a genotype for an unknown contributor to the trace .",
    "let @xmath35 be a collection of discrete variables with a distribution represented by a bayesian network . for @xmath36 ,",
    "we denote by @xmath37 the collection of variables @xmath38 .",
    "let @xmath33 be a non - negative function which can be written on the form @xmath39 for some set @xmath40 of subsets of @xmath41 and real - valued , non - negative functions @xmath42 .    for each @xmath43",
    "we introduce binary random variables @xmath44 which are conditionally independent given the network and have conditional distributions @xmath45 here , the constant @xmath46 is chosen such that @xmath47 $ ] over all states @xmath48 and so defines a valid probability distribution . a simple choice would be @xmath49 , i.e.  the largest value that @xmath42 attains over the state space of @xmath37 .",
    "we use the state space @xmath50 for auxiliary variables , but note that this choice is unimportant for the method itself .",
    "the desired expectation @xmath51 can now be expressed as the probability of a specific configuration of the binary variables introduced . as proposition  [ the : exptoprob ] reveals , this is also the case for the expectation of a product of any subset of the variables @xmath52 .",
    "[ the : exptoprob ] for all @xmath53 it holds that @xmath54    using ( [ eq : dummydef ] ) and the fact that @xmath55 are conditionally independent given @xmath56 we get @xmath57{\\bigcap_{b\\in{\\mathcal{b}}'}\\{y^b=1\\}}{x}\\bigg\\}\\prod_{b\\in{\\mathcal{b}}'}k_b&\\\\      & = \\operatorname{\\mathbb{p}}\\bigg(\\bigcap_{b\\in{\\mathcal{b}}'}\\{y^b=1\\}\\bigg)\\prod_{b\\in{\\mathcal{b}}'}k_b    \\end{aligned}\\ ] ] as desired .",
    "if the distribution of the variables @xmath58 is modelled by a bayesian network , this network can be extended to include the variables @xmath59 by for each @xmath60 adding @xmath55 as a child of @xmath61 with conditional distributions of @xmath55 in . as the auxiliary variables are added as children of existing network nodes ,",
    "no directed cycles are created and the extended network is a correct representation of the joint distribution of @xmath62 since , given @xmath37 , @xmath55 is conditionally independent of all other variables in the extended network .",
    "figure  [ fig : bnexample ] illustrates how the network is extended in case of a function @xmath33 factorising over two sets of variables @xmath63 and @xmath64 .    at ( 0,0 ) ( x1)@xmath65 ; ( x3)@xmath66 ; ( x2)@xmath67 ; ( x4)@xmath68 ; ( x5)@xmath69 ; ( x1 )  ( x2 ) ; ( x3 )  ( x4 ) ; ( x1 )  ( x4 ) ; ( x4 )  ( x5 ) ; ( x1 )  ( x3 ) ;    background [ create hullnodes/.code= in at ( hullnode ) [ name = hullnode0,draw = none ] ; at ( hullnode1 ) [ name = hullnode , draw = none ] ; , create hullnodes ] ( @xmath70 ) in 1 , ... ,  ( @xmath71 )",
    "let 1 = ( @xmath72 ) , 1 = atan2(1,1 ) , 2 = ( @xmath73 ) , 2 = atan2(2,2 ) , = -mod(1 - 2,360 ) in arc [ start angle=1 , delta angle= , radius=1.5em ]  cycle ; [ create hullnodes/.code= in at ( hullnode ) [ name = hullnode0,draw = none ] ; at ( hullnode1 ) [ name = hullnode , draw = none ] ; , create hullnodes ] ( @xmath70 ) in 1 , ... ,  ( @xmath71 )",
    "let 1 = ( @xmath72 ) , 1 = atan2(1,1 ) , 2 = ( @xmath73 ) , 2 = atan2(2,2 ) , = -mod(1 - 2,360 ) in arc [ start angle=1 , delta angle= , radius=1.5em ]  cycle ; [ create hullnodes/.code= in at ( hullnode ) [ name = hullnode0,draw = none ] ; at ( hullnode1 ) [ name = hullnode , draw = none ] ; , create hullnodes ] ( @xmath70 ) in 1 , ... ,  ( @xmath71 ) let 1 = ( @xmath72 ) , 1 = atan2(1,1 ) , 2 = ( @xmath73 ) , 2 = atan2(2,2 ) , = -mod(1 - 2,360 ) in arc [ start angle=1 , delta angle= , radius=1.5em ]  cycle ; [ create hullnodes/.code= in at ( hullnode ) [ name = hullnode0,draw = none ] ; at ( hullnode1 ) [ name = hullnode , draw = none ] ; , create hullnodes ] ( @xmath70 ) in 1 , ... ,  ( @xmath71 )",
    "let 1 = ( @xmath72 ) , 1 = atan2(1,1 ) , 2 = ( @xmath73 ) , 2 = atan2(2,2 ) , = -mod(1 - 2,360 ) in arc [ start angle=1 , delta angle= , radius=1.5em ]  cycle ;    ( y1)@xmath74 ; ( y2)@xmath75 ; ( x4 )  ( y2 ) ; ( x5 )  ( y2 ) ; ( x3 )  ( y2 ) ; ( x2 )  ( y1 ) ; ( x3 )  ( y1 ) ;      we now briefly describe probability propagation and explain how to exploit the normalising constants arising as a by - product of the propagation algorithm .",
    "we refer for example to @xcite for further details .",
    "a computational structure is set up in the form of a so - called _ junction tree _ of subsets of the variables involved : first an undirected graph , the _ moralised graph _ , is constructed by adding undirected links between nodes that have a common child and removing directions for existing edges . subsequently links are added to ensure that the resulting graph is chordal .",
    "this process is known as _",
    "triangulation _ and can generally be done in many ways .",
    "finally the cliques in the triangulated graph are arranged in a junction tree .    in the situation described above @xmath37",
    "is the parent set of @xmath55 in the extended network and the node set @xmath37 will thus be a complete set in the triangulated graph , hence contained in some clique .",
    "the efficiency of the method depends crucially on the size of cliques for the chosen triangulation , see further discussion in section  [ sec : complexity ] below .",
    "a distribution @xmath76 is represented by an unnormalised probability function @xmath77 where @xmath78 denotes the set of _ separators _ , i.e.  intersections of pairs of neighbouring cliques in the junction tree .",
    "the corresponding normalising constant is @xmath79 .",
    "the function @xmath80 is known as the _ charge _ and the functions @xmath81 as _",
    "potentials_.    a message passing operation referred to as _ propagation _ brings the charge on a canonical form , where all potentials of the charge are equal to the function @xmath82 marginalised onto the corresponding clique or separator , i.e.@xmath83 the normalising constant can then be computed efficiently after propagation as @xmath84 , for instance choosing @xmath85 as a separator @xmath86 with minimal state space .",
    "the charge @xmath82 can be modified by entering so - called _ likelihood evidence _",
    "@xmath87 on single nodes leading to the charge @xmath88 with normalising constant @xmath89    taking the ratio of the normalising constants before and after propagating the likelihood evidence yields the expectation of the product of the likelihood evidence with respect to the distribution @xmath76 : @xmath90    as shown in proposition  [ the : nc ] below , this fact now ensures that the expectation of interest can be calculated by propagating likelihood evidence on the auxiliary variables .",
    "[ the : nc ] let likelihood evidence for each node @xmath55 , @xmath91 be given as : @xmath92 and let @xmath93 and @xmath94 be the normalising constants before and after propagation of the likelihood evidence .",
    "then we have @xmath95    @xmath96    which by proposition  [ the : exptoprob ] equals the desired expectation .",
    "the multinomial distribution of allele - counts @xmath97 representing the genotype of individual @xmath5 does not in itself have markovian properties .",
    "however , if we define the partial sums @xmath98 counting the number of alleles of type up to and including @xmath2 that person @xmath5 possesses , we can represent the genotype in a bayesian network as displayed in figure  [ fig : onegt ] .",
    "= [ shape = ellipse , fill = white , draw , font = , text height=1.5ex , text depth=.25ex ] = [ matrix of math nodes , execute at empty cell= ; , ampersand replacement= & , nodes = bnnode , row sep = 1.51em , column sep = 1.71em ] = [ ]    ( gt ) [ gtmat ] s_i1 & s_i2 & s_i3 & s_i4 & s_i5 & s_i6 + n_i1 & n_i2 & n_i3 & n_i4 & n_i5 & n_i6 + ;    in 1 , ... , 6 ( gt-2- )  ( gt-1- ) ; ;    if we imagine the two alleles in the genotype being allocated sequentially , then the number of alleles that a person has of type @xmath3 only depends on how many alleles of the total two are left to allocate , and the allocation happens according to a binomial distribution . in proposition",
    "[ prop : multinomial ] we establish the formal correctness of the network specification .    [",
    "prop : multinomial ] the distributions of genotypes and partial sums satisfy the following relations @xmath99 finally , we have the conditional independence relations @xmath100    the unnumbered relations follow directly from the definition of the quantities involved .",
    "we further have @xmath101 the conditional independence follows from the fact that the conditional distribution of @xmath4 given @xmath102 only depends on the condition through @xmath103 ; inspection of the expression for the conditional distribution yields .      in order to compute the inner expectation in , we note that this is an expectation of a product over alleles , where each factor is a function of the variables @xmath28 and @xmath104 , and so we can compute this expectation using auxiliary variables as described in section  [ sec : dummy ] : for each allele @xmath2 , we add an auxiliary variable @xmath105 with parents @xmath4 and @xmath14 for all unknown contributors @xmath5 , except for @xmath106 that is given only one parent @xmath107 per contributor . figure  [ fig : gtnet ] shows the network for modelling one marker of a mixture with two contributors and six alleles .",
    "= [ shape = ellipse , fill = white , draw , font = , text height=1.5ex , text depth=.25ex ] = [ matrix of math nodes , execute at empty cell= ; , ampersand replacement= & , nodes = bnnode , row sep = 1.51em , column sep = 1.71em ] = [ ]    ( gt ) [ gtmat ] s_i1 & s_i2 & s_i3 & s_i4 & s_i5 & s_i6 + n_i1 & n_i2 & n_i3 & n_i4 & n_i5 & n_i6 + [ + 1.51em ] o_1 & o_2 & o_3 & o_4 & o_5 & o_6 + [ + 1.51em ] n_j1 & n_j2 & n_j3 & n_j4 & n_j5 & n_j6 + s_j1 & s_j2 & s_j3 & s_j4 & s_j5 & s_j6 + ;    in 1 , ... , 6 ( gt-2- )  ( gt-1- ) ; ( gt-4- )  ( gt-5- ) ; ( gt-2- )  ( gt-3- ) ; ( gt-4- )  ( gt-3- ) ; ;    background ( bg1 ) ; ( bg2 ) ;    note that @xmath105 and its parents @xmath108 , @xmath109 are necessarily contained in the same clique , implying that any valid junction tree will contain cliques with an associated state space that is exponential in the number @xmath110 of unknown contributors .",
    "unfortunately , as the moralised graph is not chordal  for instance @xmath111 is a cycle  further edges need to be added , resulting in an additional increase in the size of the cliques .",
    "we shall return to this issue in section  [ sec : complexity ] .",
    "the distribution of a peak height @xmath112 conditionally on the allele - counts is for @xmath113 @xmath114 where @xmath82 and @xmath115 denotes the density respectively the cumulative distribution function for the gamma distribution with parameters as in .",
    "define the distribution of @xmath105 for an observed allele , where @xmath116 , as @xmath117 noting the dependence of the scaling factor @xmath118 on @xmath119 .",
    "for an unobserved allele , where @xmath120 , let the distribution of @xmath105 be defined as @xmath121 for convenience we have defined the auxiliary variables so that for all alleles the event @xmath122 corresponds to the event that the peak at allele @xmath2 is above the threshold @xmath12 .",
    "now proposition  [ the : nc ] can readily be used to evaluate the contribution to the likelihood from marker @xmath123 for a given value of @xmath119 by propagating likelihood evidence @xmath124      when entering and propagating likelihood evidence as in for @xmath2 in a set of alleles @xmath60 , we obtain a representation of the conditional distribution of the full network given the relevant state of the auxiliary variables @xmath125 . furthermore , this distribution is identical to the conditional distribution of the nodes in the network given the peak height information @xmath126 : @xmath127{x}{\\bigcap_{\\stackrel{a\\in b,}{z_a > c } } \\{o_a = 1\\}\\bigcap_{\\stackrel{a\\in b,}{z_a = 0 } } \\{o_a = 0\\ } } \\label{eq : evidence}\\ ] ] this follows from the following argument : @xmath128{x}{\\bigcap_{\\stackrel{a\\in b,}{z_a >",
    "c } } \\{o_a = 1\\}\\bigcap_{\\stackrel{a\\in b,}{z_a = 0 } } \\{o_a = 0\\ } } \\nonumber \\\\    & \\propto & p(x)\\operatorname{\\mathbb{p}}\\cdp[\\big]{\\bigcap_{\\stackrel{a\\in b,}{z_a > c } } \\{o_a = 1\\}\\bigcap_{\\stackrel{a\\in b,}{z_a = 0 } } \\{o_a = 0\\}}{x}\\nonumber \\\\    & = &   p(x)\\prod_{\\stackrel{a\\in b}{z_a >",
    "c}}\\operatorname{\\mathbb{p}}\\cdp*{o_a = 1}{x}\\prod_{\\stackrel{a\\in b}{z_a = 0}}\\operatorname{\\mathbb{p}}\\cdp*{o_a = 0}{x}\\nonumber \\\\    & = &   p(x)\\prod_{\\stackrel{a\\in b}{z_a > c}}\\operatorname{\\mathbb{p}}\\cdp*{o_a = 1}{\\bn_{a } , \\bn_{a+1}}\\prod_{\\stackrel{a\\in b}{z_a = 0}}\\operatorname{\\mathbb{p}}\\cdp*{o_a = 0}{\\bn_{a } , \\bn_{a+1}}\\nonumber \\\\    & = &   p(x)\\prod_{\\stackrel{a\\in b}{z_a > c}}\\{g_\\psi\\cdp{z_a}{\\bn_a , \\bn_{a+1}}/k^\\psi_a\\}\\prod_{\\stackrel{a\\in b}{z_a = 0}}g_\\psi\\cdp{c}{\\bn_a , \\bn_{a+1}}\\nonumber \\\\    & \\propto &   p(x)\\prod_{a\\in b } f_\\psi\\cdp*{\\{z_a\\}_{a\\in b}}{x } \\nonumber\\\\    & \\propto & p\\cdp*{x}{\\{z_a\\}_{a\\in b}}. \\end{aligned}\\ ] ]    as a consequence , we can easily sample from the conditional distribution of genotypes given peak height information , which we shall exploit in sections [ sec : simulation ] and [ sec : map ] below .",
    "the main concerns when applying computation by auxiliary variables to a specific problem are that the junction tree representation of the network may not fit in the physical memory , and propagation and other network operations may take prohibitively long . both of these issues",
    "are directly related to the _ total size _ of the network junction tree .",
    "an additional concern lies in finding a good triangulation , as this can be both time- and memory - consuming ; we eliminate this additional cost by specifying triangulations directly .",
    "the total size of the junction tree is the sum of the sizes of state spaces for all cliques and separators and determines how many numbers are needed to store the clique and separator tables .",
    "once a junction tree has been created for a network , computation by auxiliary variables involves setting the conditional probability tables for each auxiliary variable and propagating evidence .",
    "the number of elementary arithmetic operations for propagation is linear in the total size .",
    "also , the number of cells that need updating when the conditional probability tables for the auxiliary variables change is , in the worst case , determined by the total size .    in the following we study the relation of the total sizes of junction tree representations used for dna mixture analysis to the number @xmath129 of possible alleles at a marker and the number @xmath110 of unknown contributors .",
    "we shall consider three different triangulations of networks of the type discussed in section  [ sec : likelihood ] and investigate the behaviour of the total sizes of the corresponding junction trees .",
    "we restrict attention to mixture networks where any allele @xmath2  apart from the last allele @xmath129  can receive stutter from @xmath3 .",
    "any triangulation must necessarily have cliques that contain auxiliary variables with their parent sets as these are complete sets in the moralised graph .",
    "for all our junction trees we avoid adding additional variables to all such sets and simply combine any auxiliary variable with its parent set to form a clique .",
    "we can thus focus the discussion on triangulating the part of the moralised graph that does not involve auxiliary variables .",
    "if we have @xmath130 binary auxiliary variables per allele , their cliques and corresponding separators contribute to the total size of the junction tree by @xmath131 since there are @xmath132 cliques containing an auxiliary variable along with its @xmath133 parents , and each is separated from the remaining junction tree by a separator containing the @xmath133 parents .",
    "the @xmath130 auxiliary variables for the last allele have only @xmath110 parents .",
    "bearing figure  [ fig : onegt ] in mind , the structure of the genotype networks requires _ upper triangle _ sets @xmath134 to be in a clique as they are complete sets . if allele @xmath9 receives stutter from @xmath2 , then the _ lower triangle _",
    "set @xmath135 is also complete in the moralised graph and must be contained in some clique .",
    "the first triangulation method we shall consider , uses the simple idea of slicing the network into cliques @xmath136 for @xmath137 .",
    "the corresponding junction tree , which we shall refer to as the _ slice tree _ , is displayed in figure  [ fig : slicetree ] .",
    "in addition to the cliques and separators arising from the auxiliary variables , the slice tree has @xmath138 cliques each consisting of @xmath139 nodes , and @xmath140 separators between them , each consisting of @xmath133 nodes .",
    "thus the total size of the slice tree becomes @xmath141    in 1 , ... , 3    in n_1,n_1,n_2,n_2,n_3,n_3 in    ( b- ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , below = of c- ] ;    ( b- ) ",
    "( c- ) ;    however , we can improve on this triangulation by splitting each slice into two cliques as figure  [ fig : initsplit ] illustrates .    in s_1,a , s_1,a+1,n_1,a",
    ", n_1,a+1 , s_2,a , s_2 , a+1,n_2,a , n_2,a+1 , s_3,a , s_3,a+1,n_3,a , n_3,a+1    in c    ( c-1 ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle ] ;    in s_1,a,,n_1,a , n_1,a+1 , s_2,a,,n_2,a , n_2,a+1 , s_3,a,,n_3,a , n_3,a+1    in c    ( c-2a ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , right = 3em of c-1 ] ;    in s_1,a , s_1,a+1,,n_1,a+1,s_2,a , s_2,a+1,,n_2,a+1,s_3,a , s_3,a+1,,n_3,a+1    in c    ( c-2b ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , right = 1em of c-2a ] ;    ( @xmath142 )  ( @xmath143 ) ; ( c-2a )  ( c-2b ) ;    the resulting _ triangle tree _ has @xmath144 cliques of each @xmath145 nodes and @xmath144 separators of each @xmath133 nodes , and thus the total size @xmath146 grows significantly slower with the number of unknown contributors than the slice tree ; see figure  [ fig : totalsize ] .    in 1 , ... , 3    in s_1,s_1,,n_1,s_2,s_2,,n_2,s_3,s_3,,n_3    in c    ( d-2- ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , right = of d-1- ] ;    ( d-1- )  ( d-2- ) ;    in n_1,n_1,n_2,n_2,n_3,n_3 in    ( b1- ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , below = of d-1- ] ;    ( b1- )  ( d-1- ) ;    in the case of only one unknown contributor , the total size of the triangle tree can not be reduced .",
    "however , with more than one unknown contributor , each clique containing @xmath110 upper triangles can be further split into @xmath110 cliques as in figure  [ fig : split ] .    in s_1,a ,",
    "s_1,a+1,,n_1,a+1,s_2,a , s_2,a+1,,n_2,a+1,s_3,a , s_3,a+1,,n_3,a+1    in c    ( c-1 ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle ] ;    in s_1,a , s_1,a+1,,n_1,a+1,s_2,a,,,n_2,a+1,s_3,a,,,n_3,a+1    in c    ( c-2a ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , right = 3em of c-1 ] ;    in , s_1,a+1,,n_1,a+1,s_2,a , s_2,a+1,,n_2,a+1,s_3,a,,,n_3,a+1    in c    ( c-2b ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , right = 1em of c-2a ] ;    in , s_1,a+1,,n_1,a+1,,s_2,a+1,,n_2,a+1,s_3,a , s_3,a+1,,n_3,a+1    in c    ( c-2c ) [ matrix of math nodes , nodes in empty cells , ampersand replacement= & , cstyle , right = 1em of c-2b ] ;    ( @xmath142 )  ( @xmath143 ) ; ( c-2a )  ( c-2b ) ; ( c-2b )  ( c-2c ) ;    note that the cliques containing @xmath110 lower triangle sets can not be split in a similar fashion .",
    "the resulting junction tree then has @xmath138 cliques of each @xmath145 nodes , a further @xmath147 of each @xmath148 nodes , and @xmath149 separators of @xmath133 nodes between them .",
    "the total size of the tree is thus @xmath150    a further slight reduction of the total size can be obtained by a small alteration in the cliques that cover nodes from the first two and last three alleles ; the resulting tree is seen in figure  [ fig : optjts ] .",
    "we shall refer to this tree as the _ optimal _ tree , as this is the best junction tree we have been able to construct .",
    "we have also investigated junction trees found by using triangulation algorithms implemented in ` hugin ` but none have smaller total size than our optimal tree .",
    "the optimal junction tree can be generated by an elimination sequence which first eliminates all the auxiliary variables and then proceeds through the network nodes as @xmath151 where @xmath152 denotes @xmath153 etc .",
    "the exponential growth of the total size of the three types of junction tree is illustrated in figure  [ fig : totalsize ] .",
    "our numerical examples all include @xmath154 auxiliary variables for each allele to reflect the size of the networks used in the r - package ` dnamixtures ` .",
    "the choice of @xmath130 makes little difference to the total size as this in all cases grows linearly with @xmath130 .",
    "the network representations constructed for the genotypes have a large number of state combinations that are impossible , for example due to the constraint that @xmath8 for all @xmath5 . in ` hugin ` there is a facility to _ compress _ the domain , such that only configurations of clique and separator states with non - zero probability are stored , thus reducing the effective size of the junction tree .",
    "there is a slight cost in terms of book - keeping , but for our purposes this cost is negligible .",
    "total sizes of junction trees as a function of the number @xmath110 of unknown contributors , in the case of @xmath155 allelic types and @xmath154 auxiliary variables per allele .",
    "solid lines are uncompressed sizes and dashed lines compressed sizes .",
    "the horisontal band indicates total sizes ranging from 2 gb to 512 gb assuming numbers are represented in single precision . ]    as is apparent from figure  [ fig : totalsize ] , the exponential growth pattern prevails for the compressed domains .",
    "note that after compression all three junction trees are approximately of the same size .",
    "also , the reduction of total size obtained by compression is itself growing exponentially ; ignoring any slight reduction in total size from compressing states with probability zero in the cliques with auxiliary variables , the total size for the compressed slice tree is @xmath156    in general , to make a compression , one single propagation has to be performed and therefore the uncompressed networks set the limit for computational feasibility .",
    "when numbers are represented in single precision of each four bytes , the horisontal band in figure  [ fig : totalsize ] represents a range of capacities from 2 gb to 512 gb of memory .",
    "figure  [ fig : totalsize ] indicates that using the optimal junction tree should enable computation for up to @xmath157 unknown contributors , whereas using the slice tree restricts computation to around @xmath158 .",
    "there is a simple way of compressing the slice tree in that there are at most 10 possible configurations of the states in each of @xmath159 .",
    "so if the state space is defined by these from the outset , it would in principle be possible to handle up to @xmath160 unknown contributors , as it the compressed network would determine the maximal capacity ; however , the general flexibility of the representation would be reduced .",
    "clearly , the network that represents the genotype of an unknown contributor could be replaced by a different representation than the one suggested here and connected to the auxiliary variables in an appropriate way .",
    "we shall briefly consider two alternative representations of a genotype .",
    "[ [ allele - pair - representation ] ] allele - pair representation + + + + + + + + + + + + + + + + + + + + + + + + + +    more commonly , a genotype has been represented directly as an unordered pair of alleles ; this representation has for example been used in @xcite . including @xmath129 alleles in the model there are @xmath161 possible unordered pairs .",
    "if an allele - pair is represented by a single node for each contributor , the parent set for each auxiliary variable in this network is the collection of the @xmath110 unknown genotype - nodes , resulting in a junction tree where each clique and each separator contains all of the @xmath110 genotype - nodes .",
    "adding @xmath130 auxiliary variables for each of @xmath129 alleles yields the total size @xmath162    we note that this junction tree exhibits polynomial rather than linear growth in @xmath129 , rendering the representation less efficient for markers with a large number of possible allelic types . for a fixed number of alleles ,",
    "the growth in the number @xmath110 of unknown contributors is still exponential ; see figure  [ fig : totalsize ] . for junction trees based on the markov representation of genotypes",
    ", the number of alleles makes a neglible impact on the total size .",
    "however , for the allele - pair representation the rate of growth depends heavily on the number of allelic types : for 25 alleles as in figure  [ fig : totalsize ] it is feasible to handle up to about 3 unknown contributors , whereas if only 10 allelic types are needed , then 4 - 5 unknown contributors can be handled . for 7 or more allelic types ,",
    "the markov representation in combination with optimal triangulation is superior to the allele - pair representation regardless of the number of unknown contributors .",
    "as the allele - pair representation is compressed by construction , there is no possibility of further compression of the junction tree .",
    "[ [ single - gene - representation ] ] single gene representation + + + + + + + + + + + + + + + + + + + + + + + + + +    another possibility , used for example in @xcite and @xcite , is to model the genotype at the single gene level .",
    "a single gene can be represented by the same markovian network structure as that in figure  [ fig : onegt ] used for a genotype , just that each node @xmath4 or @xmath163 has state space @xmath50 rather than @xmath164 . however , there is a cost in that two such networks are needed per unknown contributor , resulting in a total size with growth - rate @xmath165 compared to @xmath166 when using the genotype representation .",
    "thus , the single gene network will always be inferior to the genotype network .",
    "the total size of the optimal single gene tree renders computations feasible for up to about 5 unknown contributors .",
    "compression of the single gene slice tree yields a growth rate of @xmath167 , which still is considerably higher than @xmath168 for the corresponding compressed genotype slice tree",
    ". it would stay feasible if @xmath169 .    for @xmath170 allelic types ,",
    "the single gene representation compares favourably to the allele - pair representation .",
    "although inefficient , the single gene network representation may be preferable for other reasons ; for example in cases where the two genes might be selected from different populations , if sensitivity to uncertainty or population structure should be investigated as in @xcite , or if there is additional complexity involving family relations etc .  as in @xcite .",
    "the analysis of a mixed trace can have different objectives depending on the context .",
    "the objective can be a quantification of the strength of _ evidence _ for a given hypothesis over another , or the objective may be a _ deconvolution _ of the trace , i.e.   that one wishes to predict genotypes of unknown contributors .    as a generic example we consider a trace _ mc15 _ from @xcite , also analysed in @xcite .",
    "the trace is believed to contain dna from at least three contributors , and the victim , who we shall denote @xmath171 , is assumed present along with another contributor @xmath172 .",
    "we shall here deal with the question of the identity of the third contributor .",
    "the peak heights from one marker are given in table  [ tab : mc15dat ] along with the allele - counts for each of three genotyped individuals .",
    "the available _ evidence _ @xmath173 consists of the peak heights as observed in the epg as well as the genotypes of individuals associated with the case .",
    "it is customary to assume relevant population gene frequencies to be known .",
    ".peak heights for marker d2s1338 above threshold in trace mc15 , and genotypes of associated individuals .",
    "[ cols= \" < , > , > , > , > , > \" , ]     as the table shows , the probability that the unknown contributor has at least one allele 17 is .9983 , close to certainty .",
    "there is some uncertainty concerning the second allele which can be virtually anything although it is by far most probable that the genotype is ( 16 , 17 ) ; this genotype is that of the defendant @xmath174 .",
    "the second most probable explanation of the trace is that the other allele has dropped out .",
    "another potential application of the auxiliary variables is to calculate a likelihood ratio which only uses information about peak presence or absence .",
    "this can be done by specifying evidence for the nodes @xmath175 introduced in section  [ sec : diagnostics ] rather than for nodes @xmath105 .",
    "it is still necessary to specify a set of model parameters , which for example could be estimated using peak heights . using the estimates in table  [ tab : mle15 ]",
    "we obtain a likelihood ratio of @xmath176 which is weaker than the evidence obtained with full peak height information but it is still incriminating for the defendant . such an analysis is analogous to the one used in ` likeltd ` as suggested by @xcite , where peak heights are used only to classify peaks as present , absent , or uncertain .",
    "we have used peak heights to estimate the parameters of the model . in principle parameters",
    "could also be estimated solely on the peak presence information , possibly in combination with prior information on some of these , although such estimates would be ill - determined and therefore not useful .      by adding more auxiliary variables to the model",
    ", we can easily extend the model to handle multiple traces , either with independent unknown contributors or where some or all unknown contributors coincide .",
    "we assume that the peak heights across mixed traces are conditionally independent given the genotypes of common contributors .",
    "peak height distributions are allowed to vary across traces through the model parameters .",
    "the network now models the set of all unknown contributors to the mixed traces .",
    "denote by @xmath177 the proportion of dna that contributor @xmath5 has made to trace @xmath178",
    ". then @xmath179 corresponds to contributor @xmath5 not being present in trace @xmath178 .",
    "therefore , the case where some or all contributors are distinct to a particular mixed trace is a sub - model corresponding to @xmath179 for some @xmath180 .",
    "an advantage of this specification of the joint model is that we do not need to make assumptions about possible common unknown contributors to the traces , but we can let the maximisation of the likelihood point to the relevant scenario .",
    "this has been used in @xcite for a combined analysis of mc15 with another trace pertaining to the same case .    in the case where the traces have completely independent unknown contributors ,",
    "it is recommendable to represent each trace as a separate network to limit the number of unknown contributors in each network .",
    "we note that our computational methods are exact throughout under the model adopted , and that the only approximations relate to the model representing an inevitable approximation to reality , and possible imprecision of numerical methods . nevertheless , using the efficient junction tree representations and exact compression methods as described in section  [ sec : complexity ] , we are able to handle more contributors than what has previously been possible .",
    "we have far from exhausted the flexibility and the potential of the bayesian network model and point out that simple modifications or elaborations of the basic network can readily be used to , say , incorporate the presence of silent alleles simply by including an extra allele in the genotype representation , or to enable the direct computation of the probability that a specific peak is due to stutter or an absent peak is due to random dropout or allele absence ; see @xcite for this and further examples .",
    "gill , p. , curran , j. , neumann , c. , kirkham , a. , clayton , t. , whitaker , j. , and lambert , j. ( 2008 ) .",
    "interpretation of complex dna profiles using empirical models and a method to measure their robustness .",
    ", 2:91103 .",
    "puch - solis , r. , rodgers , l. , mazumder , a. , pope , s. , evett , i. , curran , j. , and balding , d. ( 2012 ) .",
    "evaluating forensic dna profiles using peak heights , allowing for multiple donors , allelic dropout and stutters .",
    "technical report , lgc research report lgc / p/2012/138 ."
  ],
  "abstract_text": [
    "<S> statistical analysis of dna mixtures is known to pose computational challenges due to the enormous state space of possible dna profiles . </S>",
    "<S> we propose a bayesian network representation for genotypes , allowing computations to be performed locally involving only a few alleles at each step . </S>",
    "<S> in addition , we describe a general method for computing the expectation of a product of discrete random variables using auxiliary variables and probability propagation in a bayesian network , which in combination with the genotype network allows efficient computation of the likelihood function and various other quantities relevant to the inference . </S>",
    "<S> lastly , we introduce a set of diagnostic tools for assessing the adequacy of the model for describing a particular dataset . + </S>",
    "<S> * keywords : * bayesian network ; genotype representation ; junction tree ; model diagnostics ; prequential monitor ; triangulation . </S>"
  ]
}