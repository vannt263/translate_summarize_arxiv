{
  "article_text": [
    "in this section the distance between the subsystem of the dephased rectangular decoupled state and the gibbs state @xmath82 is computed .",
    "the discussion is similar to that in ref .  @xcite . as all eigenvectors of @xmath23",
    "are given by tensor products of the eigenstates of @xmath21 and @xmath22 , @xmath140 , it is possible to trace the degrees of freedom of the bath of the decoupled rectangular state to get @xmath141 with @xmath142 here , @xmath143 denotes the number of states of the bath with an energy contained in the interval @xmath144}$ ] . for simplicity",
    "we assume that @xmath145 .",
    "notice that the probabilities @xmath146 only depend on the shape of the spectrum of the bath .",
    "we aim at bounding the trace distance @xmath147 where @xmath148 are the eigenvalues of the gibbs state and @xmath149 .",
    "let us define a function @xmath0 as the logarithm of the number of states of the bath @xmath150 the hilbert space of the bath is finite dimensional and thus the spectrum of the bath is discrete , from now on it is however assumed that the bath is large enough such that @xmath151 can be well approximated by a twice differentiable function @xmath152 . for natural systems and reasonable",
    "energy ranges the additional error from this approximation is exponentially small in the size of the bath . for the sake of conciseness we ignore such exponentially small errors .",
    "we discuss this continuous approximation more closely in appendix b.    from now on we will hence focus on @xmath153 , where @xmath154 it a twice differentiable approximation of @xmath155 .",
    "taylor s theorem ensures that for every @xmath156 there exists some @xmath157 $ ] , such that @xmath158 where @xmath159 is the inverse temperature and @xmath160 a linear expansion of @xmath161 is equivalent to an exponential fit of the smoothed number of states of the bath @xmath162 , @xmath163 thus , the probabilities @xmath146 can be written as @xmath164 where @xmath165 .",
    "therefore , the distance between @xmath37 and the gibbs state depends on how well the density of states of the bath can be approximated by an exponential curve .",
    "the difference between the probabilities reads @xmath166 where the fraction @xmath167 can be rewritten as @xmath168 introducing the notation @xmath169 } \\gamma_k(\\xi_k ) , \\\\",
    "\\gamma_{\\mathrm{max } } & \\coloneqq \\max_k \\max_{\\xi_k\\in[e - e_k^s , e ] } \\gamma_k(\\xi_k ) , \\end{aligned}\\ ] ]",
    "we can write @xmath170 the trace distance between the reduced dephased decoupled rectangular state @xmath37 and the gibbs state is thus bounded from above by @xmath171 where @xmath88 is exponentially small in the bath size . we explicitly bound @xmath172 for a specific bath of uncoupled spins in appendix  b.",
    "in order to have a more explicit expression for the right hand side of eq .",
    "let us consider a particular model for the bath .",
    "we will also use this bath for the algorithm presented in the last part of the article .",
    "we start with the natural choice of @xmath83 non - interacting uncoupled spin-@xmath84 particles with energies @xmath85 and @xmath86 .",
    "the spectrum of this model is discrete and the eigenvalues are integer multiples of @xmath86 between @xmath85 and @xmath173 .",
    "the system is highly degenerate and the number of states with energy @xmath174 follows a binomial distribution @xmath175 .",
    "this degeneracy makes it impossible to find a sufficiently good smoothed approximation @xmath176 for the number of states @xmath177 such that even for intervals whose width @xmath81 scales like @xmath178 with @xmath179 the error in the approximation of the local density @xmath180 goes to zero for large @xmath6 .",
    "that is , the smoothed approximation would cause additional errors that would not go down exponentially fast with the bath size .    therefore , we need to assume that the degeneracy of the levels are lifted by a suitable perturbation",
    ". as we are only concerned about the spectrum and not the eigenstates of the bath , essentially any perturbation of adequate strength , such as basically any arbitrary weak interaction , will be sufficient .",
    "a convenient way to perturb the model for a theoretical study is to replace the fixed local field strength by a normal distributed random field strength such that on average the energy of the local excited state is still @xmath86 above the local ground state .",
    "if the width of the normal distribution is chosen in a suitable way , we get , with overwhelmingly high probability , a number of states @xmath177 in the interval @xmath26 $ ] that can be well approximated by @xmath181 in the aforementioned sense , where @xmath182    our aim is to bound @xmath172 in eq .   for this model . to do this",
    ", we first consider the case @xmath183 in which we can approximate @xmath176 as follows @xmath184 we can easily compute the second derivative of the logarithm of the above expression and find @xmath185 if @xmath81 is not much smaller than @xmath186 , @xmath187 deviates from the parabolic form .",
    "but , larger @xmath81 only make the curvature of @xmath187 smaller . in the general case we thus have @xmath188 and since @xmath189",
    "we arrive at @xmath190 where @xmath88 is exponentially small in the bath size . in natural situations",
    "the right hand side of the above equation will be very small as @xmath191 .",
    "the rectangular states are a quite artificial class of states .",
    "so what happens if instead of @xmath37 we take states with a different energy distribution ?",
    "will we still get something close to a gibbs state as long as the width of the energy distribution is not too small and the density of states is exponentially increasing ?",
    "the exponential increase in the density of states ensures that most of the contribution to @xmath36 comes from the upper edge of the interval @xmath192 in the case of a rectangular distribution .",
    "thus , it can be expected that one will get a state that is close to a gibbs state for any energy distribution that has a region with a bounded variation followed by a sufficiently sharp cutoff to higher energies . where by sufficiently sharp we mean that it must drop from a value much larger than @xmath193 to a value much smaller than @xmath193 in an energy interval that is small compared to @xmath194 .",
    "the bounded variation is required as for certain systems that violate the so called _ eigenstate thermalization hypothesis _ ( eth )",
    "@xcite details of the energy distribution can have a huge impact on certain properties of the state .",
    "that bounded variation of the energy distribution is required to guarantee thermalization in such systems can be seen for example in the model studied in ref .",
    "in this section we discuss the average number of times the algorithm must be run before the energy window corresponding to the desired temperature is hit .",
    "as we are only interested in the number of repetitions we can assume that the algorithm runs `` perfectly '' in that it generates exactly a rectangular state with fixed width @xmath81 at some position @xmath80 of the spectrum .",
    "furthermore , we are only interested in cases where the reduced state of the rectangular state can be guaranteed to be close to a gibbs state .",
    "thus , we may assume that the spectrum of the bath is dense enough such that the number of states of the bath in the interval @xmath26 $ ] can be well approximated by a continuous and twice differentiable function @xmath176 that increases exponentially to higher energies .",
    "the probability of getting a rectangular state at energy @xmath80 is given by @xmath195 where @xmath196 is the dimension of the hilbert space of the total system .",
    "using that the density of states of the bath can be locally approximated by an exponential , we obtain @xmath197 then , the probability of getting energy @xmath80 can be bounded from above by @xmath198 with @xmath199 the gap of the system .",
    "the number of times that the program must be run on average in order to get the rectangular state at the position @xmath80 is thus lower bounded by @xmath200 this last equation shows that it is exponentially hard to go to low temperatures .",
    "this is to be expected , as no structure of the hamiltonian is being used and generic local hamiltonian systems can presumably not be efficiently cooled arbitrarily close to their ground state , because this would efficiently solve qma - hard problems on a quantum computer @xcite . needless to say , for specific hamiltonians , with some additional structure , an algorithm can well be more efficient .",
    "the coefficient of the exponential is related to the features of the spectrum at low energies . in the case",
    "in which there is a gap , the ground state could encode the solution of a satisfiability problem that is expected to be hard to solve .",
    "in this section we calculate how the inverse temperature @xmath17 and its error @xmath201 depend on the energy value obtained while running the algorithm and the number of qubits @xmath106 of register @xmath95 that are measured .    after running the algorithm a value @xmath107",
    "is obtained and a state close to the rectangular state at energy @xmath202 is prepared .",
    "the system is then thermalized at an inverse temperature @xmath203 inserting the formula for @xmath176 for the bath described in appendix  b we find @xmath204    the algorithm will be run repeatedly until the value @xmath107 corresponding to the desired @xmath17 is obtained . for the bath considered here",
    "this value is @xmath205 it follows from eq .",
    "that @xmath206 to reach a given precision @xmath201 in the temperature it is thus sufficient to choose @xmath207",
    "in this section the error of the quantum algorithm is derived and a bound on the average number of repetitions that are necessary to reach the desired energy is given .",
    "the total error is bounded by the sum of two errors @xmath208 the deviation of the reduced rectangular state from the gibbs state @xmath209 has been calculated already in appendix  a and b @xmath210 here we bound the deviation @xmath211 of the final state of the algorithm from the rectangular state . our final result for",
    "the bath discussed in appendix  b will be @xmath212 ( again @xmath88 is exponentially small in the bath size ) .",
    "it is convenient to write @xmath86 in terms of a dimensionless parameter @xmath213 @xmath214 because then the two errors can be written in the form : @xmath215    to reduce the trace distance @xmath82 it is favorable to choose a large @xmath136 .",
    "intuitively this captures the fact that the energy content in the bath must be much larger than that of the system in order to get a gibbs state .",
    "however , at the same time this increases the error in the approximation of the rectangular state , because performing the phase estimation on a system with a more dense spectrum is harder .",
    "this increase of the error can however be compensated by increasing the accuracy of the phase estimation by linearly increasing the number of qubits @xmath96 in the ancilla register .",
    "similarly , lower temperatures can be reached by a quadratic increase of the number of ancilla qubits of order @xmath137 .",
    "as the phase estimation requires a total number of @xmath131 controlled unitary operations , this comes at an exponential cost in terms of runtime .",
    "this is expected to be a problem common to all algorithms using phase estimation on many particle systems .",
    "before we go into the derivation of @xmath216 , let us quickly give the average number of runs that are required to get a certain temperature for the bath discussed in appendix  b in terms of @xmath136 . from eqs .   and and the explicit formula for the smoothed number of states given in eq",
    "it is easy to see that @xmath217      here we bound the trace distance @xmath216 between the state @xmath218 generated by the circuit with @xmath96 ancilla qubits when , after measuring @xmath106 of them , the outcome @xmath107 is obtained , and the rectangular state @xmath219 in the interval @xmath26 $ ] with @xmath220 and @xmath221 is prepared .",
    "this trace distance can be written in terms of the one norm distance of the distributions of the diagonal elements @xmath222 where the @xmath223 and @xmath146 are the eigenvalues of @xmath218 and @xmath219 respectively , which can be written as @xmath224 where @xmath225 and @xmath226 are the phases corresponding to the eigenvalues of the hamiltonian and the energy of the rectangular state , @xmath227 and @xmath228 are normalization constants , and the functions @xmath229 and @xmath230 are defined as @xmath231 with @xmath232 and @xmath233 the step function ( see main text and fig .",
    "[ fig : qpe - circuit ] ) .",
    "plot of the @xmath230 and @xmath229 functions . as @xmath96 increases",
    ", @xmath229 tends to the rectangular function @xmath230 . ]",
    "is bounded by @xmath234 where we have used that - + f_r , q(x ) -and z_f - z_g_k=1^d | f_r , q(_k- ) - g_q(_k- ) | .",
    "notice that @xmath235 , where @xmath236 is the number of states of the total system in the interval @xmath237 $ ] .    using that the spectrum of the whole system is sufficiently dense it is possible to approximate the upper bound in eq .   by an integral . to make this rigorous",
    "we decompose the sum into bins of width @xmath238 , @xmath239 where @xmath240 is a function introduced to simplify the notation and @xmath241 is the number of bins in which the spectrum has been divided .",
    "the idea is to take an @xmath241 as large as possible such that the number of energy values in a bin @xmath242 can still be well approximated by its smoothed version @xmath243 ( compare the discussion of the twice differentiable approximation in appendix  a and b ) . for baths for which such a smooth approximation is possible",
    ", one can always take an @xmath241 proportional to the dimension of the hilbert space @xmath244 or , at least , to some power @xmath245 with @xmath246 such that @xmath241 scales exponentially with the size of the bath .",
    "as @xmath247 is continuos differentiable except at @xmath80 and @xmath192 , taylor s theorem ensures that for all bins @xmath248 ( except for the two bins that contain @xmath80 and @xmath192 , which we can simply ignore because they only contribute an error of order @xmath249 ) there exists some value @xmath250 for which @xmath251 where @xmath252 .",
    "then , the contribution of the @xmath248-th bin in eq .   can be bounded from above by @xmath253 the last term in the parenthesis in eq",
    ".   decreases with @xmath241 and is thus exponentially small in the bath size .",
    "this can be verified with a lengthy , but straightforward calculation .",
    "notice that the number of states can be written as @xmath254 where @xmath255    putting eqs .  , and together",
    ", the error of the circuit can be bounded from above by @xmath256 notice that the upper bound of the previous equation converges to an integral for @xmath257 with deviations that scale as @xmath258 .",
    "thus , the trace distance between @xmath218 and @xmath29 is bounded from above by @xmath259 where @xmath260 we will bound @xmath261 for the model described in appendix b in the next section .      next , the error of the circuit for a bath described in appendix b is bounded .",
    "the one norm @xmath262 from eq .   can be bounded by @xmath263 where the definition of @xmath247 given in eq .   has been used .",
    "we now find an upper bound on the supremum and a lower bound on the smoothed number of states .",
    "the density of states of the total system can be written in terms of the density of states of the bath as @xmath264 inserting the density of states of our bath in the previous expression and writing it as a function of the inverse temperature given in eq .",
    "we get @xmath265 as we only consider positive temperatures @xmath266 it is easy to see that the density of states attains its maximum value at @xmath267 , thus @xmath268 where @xmath269 is the dimension of the hilbert space of the total system .",
    "the smoothed number of states @xmath270 can be lower bounded as follows @xmath271 where again we have assumed that @xmath80 is in a position of the spectrum with positive temperature .",
    "finally we obtain @xmath272 in order for this error to become small the one norm @xmath273 must be made small enough such that it compensates the exponential prefactors .",
    "as we will see in the next section this can be achieved by using a polynomially large ancilla register @xmath95 .      in this section",
    "we bound the one norm between @xmath229 and @xmath230 introduced in eqs .   and .",
    "the one norm between @xmath274 and @xmath55 is defined as @xmath275 by a simple change of variables it is easy to show that @xmath276 remember that both @xmath229 and @xmath230 are normalized on the interval @xmath277 $ ] and that @xmath278 is a step function that is non - zero only in the interval @xmath279 , and that in this interval @xmath280 .",
    "using this , the previous integral can be rewritten as @xmath281 due to the symmetry and periodicity of @xmath282 , the contribution to the previous integral of the right tail of @xmath283 is the same as the contribution of the left tail of @xmath284 for @xmath285 , thus @xmath286 this implies that @xmath287 the integral of the previous equation can be bounded by @xmath288 where the bound @xmath289 has been used .",
    "therefore , the distance between the functions @xmath229 and @xmath230 can be bounded by @xmath290 where the sum has been split up in the @xmath291 case , which is exactly @xmath84 , and the rest .",
    "the sum of the previous equation can be bounded in two steps by @xmath292 thus , the one norm between @xmath274 and @xmath55 is bounded by @xmath293 inserting this into eq .  , we finally get @xmath294 where @xmath88 is exponentially small in the bath size .",
    "this completes the discussion of an upper bound of the error made in the quantum algorithm .",
    "@xcite presents a novel approach towards thermalizing quantum systems using an iterative approach , in which pre - thermalized parts are put together in a suitable fashion in order to arrive at a gibbs state of a quantum system with a local hamiltonian .",
    "this argument provides a new intuition on how one can think of thermalizing local quantum systems , different from a quantum monte carlo approach ( and the one presented here ) . in this appendix , however , we point out a subtle mistake of the published version of the paper ; however , this challenge can be overcome and a new proof can be formulated that retains key elements of the previous structure of the argument @xcite . the intuition behind the argument and in fact the algorithm itself hence turn out to be correct .",
    "each merging step consists of two steps .",
    "the first is a probabilistic step that updates the probability weights of the gibbs state by means of postselection .",
    "the second one aims at rotating the eigenbasis of the old hamiltonian to the one of the new hamiltonian by means of an instance of dephasing .",
    "each step has as input a chosen @xmath295 .",
    "for the entire algorithm to work , this procedure has to be correct up to errors of @xmath296 .",
    "in what follows we refer to the equation numbering of the preprint v2 .    in eq .",
    "( 5 ) , perfect dephasing is being achieved when @xmath297 .",
    "this is approximated by imperfect dephasing with a finite @xmath298 . from the dyson series of second order ( 6)-(8 )",
    ", it follows that ( in the asymptotic notation ) @xmath299 this is not made explicit in the paper , but appears to be crucial . intuitively speaking ,",
    "if @xmath298 becomes larger , the dephasing is more exact , but then ( 6)-(8 ) can no longer be used .",
    "this step is then used in the procedure following eq .",
    "a @xmath300 is introduced and dephasing between eigenstates with relative gap larger than @xmath300 is considered",
    ". then a new hamiltonian @xmath301 is constructed , which has the following feature : it has the same eigenbasis as @xmath302 , but with eigenvalues grouped in bins , such that the smallest gap between bins is @xmath300 . for the following procedure to work ,",
    "one has to take ( again in the asymptotic notation ) @xmath303 so both @xmath304 and @xmath305 ( although only @xmath304 is made explicit , both bounds are actually needed ) .    this",
    ", however , seems to already fix @xmath306 .",
    "so there is no longer the freedom to have @xmath307 which would mean that @xmath308 .",
    "this appears to contradict the above statement .",
    "again , intuitively , _ @xmath298 is forced to be small for the dyson approach to work _ , but at the same time this gives a constraint to @xmath300 which _ requires @xmath298 to be large_.",
    "as we have seen in the main text in theorem  1 the distinguishability of the microcanonical states @xmath36 and @xmath29 corresponding to an interval @xmath26 $ ] of the hamiltonians @xmath23 and @xmath7 is bounded by @xmath309 where @xmath41 and @xmath42 are the maximum , and the difference , of the dimensions of the support of @xmath36 and @xmath29 , and @xmath43 is the total number of eigenstates of @xmath20 and @xmath23 in the intervals @xmath44 $ ] and @xmath45 $ ] .    in the main text , in order to give a more comprehensible interpretation to eq .",
    ", an approximately constant density of states was assumed and it was shown that @xmath310 however , we have seen that thermal states emerge in situations where the density of states is locally well approximable by an exponential . thus , new conditions that ensure the indistinguishability of the microcanonical states @xmath311 and @xmath37 must be derived for the exponential density of states @xmath312 in order to do this , let us notice that both terms in the upper bound of eq .",
    "are positive and must be simultaneously and independently small . for the first term , this is only possible if @xmath313 . to find the condition for the second term ,",
    "let us assume that the interaction does not shift excessively the energy levels such that @xmath314 can be neglected . then , @xmath315 and the condition @xmath316 is required .",
    "these two necessary conditions can be summarized as @xmath317 it is easy to see that they are also essentially sufficient conditions by using @xmath318 to bound eq .",
    "as follows @xmath319      equation   ensures the indistinguishability of the interacting and non - interacting microcanonical states as long as @xmath322 is not too small and the condition v _",
    "t , where @xmath323 is the boltzmann constant and @xmath324 the absolute temperature , is fulfilled .",
    "that is , eq .",
    "gives us a physical intuition about when an interaction is _ weak _ in the sense of theorem  1 : an interaction is weak if it is small compared to the thermal energy @xmath325 , which is a measure of the intensive energy content of the system . in conclusion",
    "we see that how strong an interaction feels for a system depends on how much energy it contains ."
  ],
  "abstract_text": [
    "<S> in this work , we show how gibbs or thermal states appear dynamically in closed quantum many - body systems , building on the program of dynamical typicality . </S>",
    "<S> we introduce a novel perturbation theorem for physically relevant weak system - bath couplings that is applicable even in the thermodynamic limit . we identify conditions under which thermalization happens and discuss the underlying physics . </S>",
    "<S> based on these results , we also present a fully general quantum algorithm for preparing gibbs states on a quantum computer with a certified runtime and error bound . </S>",
    "<S> this complements quantum metropolis algorithms , which are expected to be efficient but have no known runtime estimates and only work for local hamiltonians .    </S>",
    "<S> how do thermal quantum states  </S>",
    "<S> cornerstones of a description in canonical ensembles in quantum statistical physics  arise from the underlying theory of quantum physics ? </S>",
    "<S> this question , a long tradition as it obviously has , is in many ways still surprisingly wide open . </S>",
    "<S> indeed , much progress was made only recently @xcite ; this is motivated and triggered both by new mathematical @xcite and numerical @xcite techniques becoming available , as well as by new experiments with quantum many - body systems in nonequilibrium @xcite .    in this work we present a set of precise sufficient conditions for the emergence of gibbs states from the underlying microscopic theory of quantum mechanics . </S>",
    "<S> our results go beyond previous approaches in that they apply in a physically relevant weak coupling limit and constitute the key insight leading to the invention of a quantum algorithm that prepares gibbs states with certified precision and runtime .    </S>",
    "<S> the three ingredients that enter the standard textbook proof of the canonical ensemble in classical statistical physics are : ( i ) the _ equal a priori probability postulate _ </S>",
    "<S> ( also known as microcanonical ensemble ) and an equilibration postulate ( such as the second law ) , ( ii ) the assumption of _ weak coupling _ , and ( iii ) an assumption about the _ density of states _ of the bath , namely , that it grows faster than exponentially with the energy and that it can be locally well approximated by an exponential @xcite . here </S>",
    "<S> each of these steps is translated to the _ pure state quantum statistical mechanics _ </S>",
    "<S> approach @xcite . </S>",
    "<S> in particular ( i ) can be replaced by either a typicality argument , or a statement about dynamical relaxation that follows directly from quantum mechanics and ( ii ) is made precise by proving a novel perturbation theorem that has applications far beyond the scope of the present article .    </S>",
    "<S> our new technical results allow us to design a _ quantum algorithm preparing gibbs states _ with explicit error and runtime bounds , invoking a new variant of phase estimation . </S>",
    "<S> our algorithm complements another algorithm with certified runtime that was proposed in ref .  </S>",
    "<S> @xcite and recent developments on quantum metropolis algorithms @xcite .    </S>",
    "<S> [ [ setting - and - notation . ] ] setting and notation . </S>",
    "<S> + + + + + + + + + + + + + + + + + + + + +    we consider a system @xmath0 weakly coupled to an environment @xmath1 . </S>",
    "<S> the hilbert space reads @xmath2 , where @xmath3 and @xmath4 are the hilbert spaces of the subsystem and the `` bath '' ( with finite dimensions @xmath5 and @xmath6 ) . </S>",
    "<S> the evolution of the total system is governed by the hamiltonian @xmath7 , with eigenvalues and eigenvectors @xmath8 and @xmath9 consisting of an uncoupled hamiltonian @xmath10 , with eigenvalues and eigenvectors @xmath11 and @xmath12 , and a coupling hamiltonian @xmath13 . </S>",
    "<S> we give conditions under which the reduced state @xmath14 , with @xmath15 , of the subsystem @xmath0 relaxes for most times to a gibbs state @xmath16 with inverse temperature @xmath17 under unitary time evolution @xmath18 . by this </S>",
    "<S> we mean that for most times their trace distance @xmath19 , which measures the physical distinguishability @xcite , is small . </S>",
    "<S> note that the decomposition of a given @xmath20 into @xmath21 , @xmath22 , and @xmath13 is not unique . </S>",
    "<S> this freedom can be used to optimize the bounds in our results , and the correct @xmath21 naturally results from this optimization . </S>",
    "<S> we assume that the hamiltonians @xmath20 and @xmath23 are non degenerate such that _ time averaging _ and _ dephasing _ in the eigenbasis give the same result @xmath24 whenever an expectation value equilibrates , it does so to the expectation value in @xmath25 @xcite .    </S>",
    "<S> [ [ natural - thermalization - conditions - for - gibbs - states - to - appear . ] ] `` natural thermalization '' : conditions for gibbs states to appear . </S>",
    "<S> + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this section we go through points ( i)(iii ) . </S>",
    "<S> the final conclusion is summarized in corollary  [ theorem : summaryofnaturalthermalization ] . </S>",
    "<S> the central point of the argument is a novel perturbation theorem that relates spectral projectors of weakly interacting and noninteracting hamiltonians in a physically relevant weak coupling limit . </S>",
    "<S> it allows us to connect results on dynamical equilibration and measure concentration with classical counting arguments and thereby prove a set of natural sufficient conditions for thermalization in quantum mechanics </S>",
    "<S> .    a stepping stone in the argument will be states that have an energy distribution that is flat in an interval @xmath26 $ ] and vanishes otherwise . </S>",
    "<S> we indicate such states , and their dephased states , by a subscript @xmath27 like in @xmath28 or @xmath29 and call them _ rectangular states_. this class of states includes both _ mixed states _ ( in particular the microcanonical state @xmath29 ) and _ pure states _ and thus , because of the freedom to choose the phases , usually also initial states that can be locally out of equilibrium .    </S>",
    "<S> the _ equal a priori probability postulate _ </S>",
    "<S> ( i ) can be replaced by a typicality argument using results from refs .  </S>",
    "<S> @xcite . in ref .  </S>",
    "<S> @xcite powerful concentration of measure techniques are used to show that almost all states from a microcanonical subspace corresponding to a microcanonical energy window @xmath26 $ ] locally look like the reduction of the corresponding microcanonical state ; i.e. , @xmath30 is small for all but exponentially few of the states @xmath31 from the subspace , where @xmath29 is the microcanonical state on the subspace . </S>",
    "<S> alternatively one can use the results concerning the dynamics of states with a high effective dimension of refs .  @xcite . under one assumption on the spectrum of the hamiltonian ( nondegenerate energy gaps ) </S>",
    "<S> , it is shown that all reduced states on small subsystems of such states tend to the time - averaged equilibrium state @xmath32 and stay close to it for most times . </S>",
    "<S> in many - body systems , natural initial states have a high effective dimension , and this is provably true for all but exponentially few states from a microcanonical subspace @xcite .    </S>",
    "<S> the delicate issue , which has up to now not been addressed in the literature in a general and rigorous way , is the _ weak coupling _ approximation ( ii ) @xcite . </S>",
    "<S> the problem is that due to the exponential growth of the hilbert space dimension and the at most polynomial growth of the energy content , the spectrum of the noninteracting hamiltonian @xmath23 becomes exponentially dense with increasing bath size . </S>",
    "<S> therefore , the _ perturbative _ limit , in which the coupling @xmath13 is weak compared to the _ gaps _ of the noninteracting hamiltonian @xmath23 , and in which it can be guaranteed that the energy eigenvectors @xmath33 of the full hamiltonian @xmath7 are close to product states , is arguably _ not the physically relevant weak coupling limit_. even worse , in this limit memory effects provably prevent thermalization @xcite . </S>",
    "<S> as in the classical setting , a coupling should be considered to be _ weak _ as long as it does not change the total energy in a _ </S>",
    "<S> noticeable way_. that is to say , the energy stored in the interaction is much less than our ( microcanonical ) uncertainty about the energy of the system , i.e. , @xmath34 , or for thermalizing systems much less than the thermal energy @xmath35 . </S>",
    "<S> this is the _ relevant weak coupling limit _ in which we prove equilibration towards a gibbs state . </S>",
    "<S> we do this by relating the dephased / microcanonical state @xmath29 to the state @xmath36 dephased with respect to the non interacting hamiltonian , for which we can easily perform the partial trace to obtain @xmath37 and thereby an approximation to @xmath38 .    </S>",
    "<S> [ theorem : interactingvsnoninteractingcase ] let @xmath36 and @xmath29 be the dephased / microcanonical states belonging to the interval @xmath26 $ ] with respect to @xmath23 and @xmath7 ; then for every @xmath39 @xmath40 where @xmath41 and @xmath42 are the maximum , and the difference , of the dimensions of the supports of @xmath36 and @xmath29 , and @xmath43 is the total number of eigenstates of @xmath20 and @xmath23 in the intervals @xmath44 $ ] and @xmath45 $ ] .    </S>",
    "<S> the theorem shows that , for any two initial ( possibly pure ) states that have a flat energy distribution in the interval @xmath26 $ ] with respect to the hamiltonians @xmath23 and @xmath20 with @xmath34 , the distance of their reduced dephased states @xmath37 and @xmath38 is small . in particular , assuming an approximately constant density of states such that @xmath46 and @xmath47 , the best choice for @xmath48 is @xmath49 which gives @xmath50 in cases with an exponential density of states , for which we will get equilibration towards @xmath51 , we can guarantee that @xmath52 is small whenever @xmath53 ( compare appendix  h ) .    first note that by monotonicity of the trace distance and the triangle inequality @xmath54 where @xmath55 and @xmath56 are the projectors onto the support of @xmath29 and @xmath36 respectively and @xmath57 , and @xmath58 . </S>",
    "<S> it remains to bound @xmath59 . </S>",
    "<S> let @xmath60 and @xmath61 ; then @xmath62 , and thus @xmath63 . to bound @xmath64 we decompose @xmath65 into an interior part @xmath66 which is the projector onto the eigenstates from the interval @xmath67 $ ] and the exterior part @xmath68 and find @xmath69 ( see fig .  </S>",
    "<S> [ fig : projectors ] ) . using the inequality @xmath70 , submultiplicativity of the rank , and that @xmath71 this can be recast into @xmath72 . </S>",
    "<S> finally , from theorem  v.ii.3.1 in ref .  </S>",
    "<S> @xcite it follows that @xmath73 . repeating the argument for @xmath74 , introducing the notation @xmath75 , and putting everything together gives the desired result .    </S>",
    "<S> definition of the projectors used in the proof of theorem  [ theorem : interactingvsnoninteractingcase ] . ]    the level counting argument ( iii )  with is ultimately the reason for the exponential form of @xmath51  carries over to the quantum case in a straightforward way in the _ absence _ of coupling between system and bath @xcite , and with a bit more work one can also obtain a rigorous trace norm error bound . </S>",
    "<S> if the number of states of the bath @xmath76 in the interval @xmath77 $ ] is such that the proportion @xmath78 is close to @xmath79 for the given @xmath80 and @xmath81 and some @xmath17 , then the distance of @xmath82 is small . </S>",
    "<S> this can be guaranteed under a set of natural assumptions that are satisfied by a wide range of natural quantum many - body systems and that resemble the ones commonly used in classical statistical physics , such as an exponential increase of the density of states ( appendix a ) . in particular , for a bath consisting of @xmath83 noninteracting spin-@xmath84 particles with a slightly varying on site field strength and average local energies of @xmath85 and @xmath86 one finds ( appendix b ) @xmath87 with @xmath88 exponentially small in the bath size . </S>",
    "<S> we will later use this bath in our algorithm . in summary , eq .  , </S>",
    "<S> theorem  [ theorem : interactingvsnoninteractingcase ] , and the results on dynamical equilibration and random states from the unitary invariant measure derived in refs .  </S>",
    "<S> @xcite lead to the following conclusions :    [ theorem : summaryofnaturalthermalization ] ( kinematic ) almost all pure states @xmath31 from a microcanonical subspace corresponding to an energy interval @xmath26 $ ] of a weakly interacting , sufficiently large quantum system are locally close to a gibbs state in the sense that for every @xmath89 the probability that @xmath90 drops of exponentially with @xmath91 . </S>",
    "<S> ( dynamic ) moreover , if the hamiltonian in addition has nondegenerate energy gaps @xcite , all initial states @xmath92 , even those locally out of equilibrium , with a flat energy distribution in the interval , locally equilibrate towards @xmath93 in the sense that @xmath94 both inequalities are robust against deviations from the rectangular distribution . </S>",
    "<S> if the bath has an exponentially increasing density of states only a region of bounded variation followed by a sharp cutoff towards higher energies should be sufficient ( for details see appendix  c ) .    </S>",
    "<S> [ [ artificial - thermalization - a - quantum - algorithm - for - gibbs - state - preparation . ] ] `` artificial thermalization '' : a quantum algorithm for gibbs state preparation . </S>",
    "<S> + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    it follows from eq .   and theorem [ theorem : interactingvsnoninteractingcase ] that all one has to do to prepare a gibbs state is to prepare a state close to @xmath29 or @xmath36 on a suitable combination of system plus bath . </S>",
    "<S> this is the central idea behind the quantum circuit shown in fig .  </S>",
    "<S> [ fig : qcircuit ] , which prepares thermal states without using any knowledge about the eigenstates of the hamiltonian .    quantum algorithms that prepare thermal states have several advantages over classical simulation methods : quantum monte - carlo methods offer a way to , for example , estimate correlation functions of thermal states on a classical computer . however , such methods are restricted to certain types of hamiltonians as they suffer from the sign problem . a procedure that certifiably prepares gibbs states in a quantum computer does not only overcome the sign problem , but moreover makes it possible to use thermal state in experiments addressing questions of nonequilibrium dynamics in quantum simulators , for example to study quenches .    </S>",
    "<S> our algorithm requires two registers ( see fig .  </S>",
    "<S> [ fig : qcircuit ] ) . </S>",
    "<S> the first register @xmath95 consists of @xmath96 qubits initially in @xmath97 and is used to perform quantum phase estimation . </S>",
    "<S> the second register @xmath98 holds the quantum system plus bath and is put into a rectangular state by performing the following steps :    \\1 . _ initialization_. the register @xmath98 is initialized into the completely mixed state @xmath99 .    </S>",
    "<S> \\2 . </S>",
    "<S> _ partial quantum phase estimation_. a new form of quantum phase estimation is performed , which comprises three steps : the application of @xmath96 hadamard gates on the qubits of @xmath95 , the application of @xmath96 controlled-@xmath100 operations ( with @xmath100 raised to successive powers of two ) , and an inverse fourier transform on @xmath95 . after this operation , </S>",
    "<S> the state of the registers is @xmath101 where @xmath102 and @xmath103 . </S>",
    "<S> note that @xmath104 is a probability distribution that becomes more and more peaked around @xmath105 as @xmath96 increases .    </S>",
    "<S> \\3 . </S>",
    "<S> _ measurement_. measuring the first @xmath106 qubits of @xmath95 , some binary string @xmath107 of length @xmath106 is obtained and the system is left in the state @xmath108 where @xmath109 is the number of states of the ancilla register @xmath95 compatible with the measurement . by choosing @xmath96 one can determine the width @xmath110 of the rectangular state that is prepared . </S>",
    "<S> the measured value of @xmath107 determines the energy @xmath111 of the rectangular state , and thereby the inverse temperature @xmath17 of the gibbs state . to thermalize the subsystem at some particular temperature </S>",
    "<S> , the previous steps must be repeated until the desired energy is measured . </S>",
    "<S> the number of runs increases exponentially with the inverse temperature @xmath17 . </S>",
    "<S> this prevents us from preparing thermal states at very low temperatures ( see appendix d ) . </S>",
    "<S> this is not a deficit of the algorithm , for otherwise qma - hard problems ( the quantum analog of np @xcite ) could be efficiently solved . </S>",
    "<S> any general algorithm will presumably have this feature @xcite . </S>",
    "<S> the final state of @xmath98 is @xmath112 for large enough @xmath96 , this state is close to the desired state @xmath29 with @xmath111 and @xmath110 . the precise deviation of @xmath113 from @xmath93 </S>",
    "<S> , @xmath114 depends on the density of states of system plus bath . a good candidate for the bath </S>",
    "<S> is the system of @xmath83 non interacting spin-@xmath84 particles discussed before ( appendix  b ) and we give explicit results for the errors and the complexity for this bath :    quantum circuit that generates a dephased rectangular state @xmath115 . </S>",
    "<S> @xmath116 is the initialization gate , @xmath117 are hadamard gates , @xmath118 , @xmath119 with @xmath10 , and @xmath120 is the inverse fourier transform . ]    for any chosen @xmath121 , any given inverse temperature @xmath17 and system hamiltonian @xmath21 , the algorithm presented in fig .  </S>",
    "<S> [ fig : qcircuit ] , using the bath with @xmath83 spin-@xmath84 particles and energy scale @xmath122 discussed before ( appendix b ) , prepares the system @xmath0 of @xmath123 qubits in a state within trace norm distance bounded by    @xmath124    with @xmath88 exponentially small in @xmath83 , to a gibbs state @xmath93 with a temperature in the interval @xmath125 $ ] , where @xmath126 this is achieved using @xmath96 ancilla qubits and running the algorithm an average number of @xmath127 times , where each run requires the application of @xmath128 hadamard gates , @xmath96 controlled single qubit gates , @xmath129 ( with @xmath130 ) single qubit measurements , and @xmath131 controlled unitary time evolutions under @xmath10 for a time @xmath132 .    </S>",
    "<S> notice that the time evolution under @xmath22 can be implemented with @xmath83 gates as the bath is a model of uncoupled spins . in practice , in absence of an oracle for the hamiltonian of the system , the error produced to perform the @xmath100 gate carries a second source of error that comes from the trotter - suzuki approximation . </S>",
    "<S> nevertheless , this error can be suppressed at a polynomial cost for local hamiltonians @xcite .    </S>",
    "<S> the two contributions to the trace distance error are computed in appendices  b and f , the average number of runs is computed in appendix  f and the error in the temperature comes from the discrete nature of the energy measurement via quantum phase estimation and is calculated in appendix  e. as is clear form fig .  [ fig : qcircuit ] , we need @xmath133 of the @xmath100 gates , and the part of the circuit that does not correspond to the controlled time evolution , i.e. , the initialization and the inverse fourier transform , only requires the implementation of @xmath134 hadamard gates , @xmath96 controlled single qubit gates , and @xmath135 single qubit measurements .    for a fixed large @xmath136 , the error of the algorithm can be made small by choosing an ancilla register of size @xmath137 . </S>",
    "<S> the exponential scaling of the runtime with @xmath138 caused by this is not a deficit of the algorithm , as any general efficient algorithm would contradict hardness results such as the local hamiltonian problem @xcite . unlike our approach </S>",
    "<S> , metropolis algorithms @xcite are expected to be efficient in some cases , but no rigorous runtime estimates are known and they are only applicable to local hamiltonians . an interesting step towards constructing an efficient ( in system size ) and certified algorithm for local systems </S>",
    "<S> was recently made in ref .  </S>",
    "<S> @xcite ( compare appendix  g ) .    </S>",
    "<S> [ [ conclusions . ] ] conclusions . </S>",
    "<S> + + + + + + + + + + + +    a set of sufficient conditions for thermalization in quantum mechanics has been presented . </S>",
    "<S> the conditions are a natural translation of the standard assumptions from classical statistical physics . along the way , </S>",
    "<S> a perturbation argument for realistic weak coupling has been proven that we expect to have significant applications beyond the scope of this letter . by using our technical results we are able to design a quantum algorithm preparing thermal states of arbitrary hamiltonians with rigorous runtime and error bounds .    </S>",
    "<S> [ [ acknowledgments . ] ] acknowledgments . </S>",
    "<S> + + + + + + + + + + + + + + + +    we would like to thank m.  p.  mller for discussions , p.  reimann for comments , the anonymous referee a for the well justified criticism , and the eu ( qessence , compas , minos ) , and the euryi for support .    </S>",
    "<S> 34    s.  popescu , a.  j.  short , and a.  winter , nature phys .  </S>",
    "<S> * 2 * , 754 ( 2006 ) . </S>",
    "<S> s.  goldstein , j.  l.  lebowitz , r.  tumulka , and n.  zangh , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 96 * , 050403 ( 2006 ) . </S>",
    "<S> h. tasaki , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 80 * , 7 ( 1998 ) .    </S>",
    "<S> h.  dong , s.  yang , x.  f.  liu , and c.  p.  sun , phys .  </S>",
    "<S> rev .  </S>",
    "<S> a * 76 * , 044104 ( 2007 ) .    </S>",
    "<S> p.  reimann , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  </S>",
    "<S> * 101 * , 190403 ( 2008 ) ; n.  linden , s.  popescu , a.  j.  short , and a.  winter , phys .  </S>",
    "<S> rev .  </S>",
    "<S> e * 79 * , 061103 ( 2009 ) ; a.  j.  short , arxiv:1012.4622 .    </S>",
    "<S> p.  reimann , new j.  phys .  </S>",
    "<S> * 12 * , 055027 ( 2010 ) .    </S>",
    "<S> n.  linden , s.  popescu , a.  j.  short , and a.  winter , new j.  phys .  </S>",
    "<S> * 12 * , 055021 ( 2010 ) ; c.  gogolin , phys .  rev .  </S>",
    "<S> e * 81 * , 051127 ( 2010 ) .    c.  gogolin , m.  p.  mller , and j.  eisert , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 106 * , 040401 ( 2011 ) ; o.  lychkovskiy , phys .  </S>",
    "<S> rev .  </S>",
    "<S> e * 82 * , 011123 ( 2010 ) .    </S>",
    "<S> m.  cramer , c.  m.  dawson , j.  eisert , and t.  j.  osborne , phys . </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 100 * , 030602 ( 2008 ) ; t.  barthel and u.  schollwck , ibid .  </S>",
    "<S> * 100 * , 100601 ( 2008 ) . </S>",
    "<S> m .- h .  yung , d.  nagaj , j.  d.  whitfield , and a.  aspuru - guzik , phys .  </S>",
    "<S> rev .  a * 82 * , 060302(r ) ( 2010 ) .    </S>",
    "<S> k.  temme _ et al . </S>",
    "<S> _ , arxiv:0911.3635 </S>",
    "<S> . m.  p.  mller , d.  gross , and j.  eisert , commun .  </S>",
    "<S> math .  </S>",
    "<S> phys . * 303 * , 785 ( 2011 ) .    c.  kollath , a.  luchli , and e.  altman , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 98 * , 180601 ( 2007 ) ; s.  manmana _ et al . </S>",
    "<S> _ , ibid .  </S>",
    "<S> * 98 * , 210405 ( 2007 ) ; a.  flesch _ et al . _ , </S>",
    "<S> phys .  </S>",
    "<S> rev .  </S>",
    "<S> a * 78 * , 033608 ( 2008 ) ; m.  rigol , phys .  rev .  </S>",
    "<S> lett .  * 103 * , 100403 ( 2009 ) ; m.  c.  banuls , j.  i.  cirac , and m.  b.  hastings , ibid .  * </S>",
    "<S> 106 * , 050405 ( 2011 ) . </S>",
    "<S> m.  greiner _ et al . </S>",
    "<S> _ , nature * 415 * , 39 ( 2002 ) ; l.  e.  sadler _ et al . </S>",
    "<S> _ , ibid .  </S>",
    "<S> * 443 * , 312 ( 2006 ) ; s.  hofferberth _ et al . _ , </S>",
    "<S> ibid .  * 449 * , 324 ( 2007 ) ; s.  trotzky _ et al . </S>",
    "<S> _ , arxiv:1101.2659 . </S>",
    "<S> l. d. landau and e. m. lifschitz , _ course of theoretical physics _ , 3rd edition , pergamon , oxford ( 1980 ) .    </S>",
    "<S> d.  poulin and p.  wocjan , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 103 * , 220502 ( 2009 ) .    </S>",
    "<S> e.  bilgin and s.  boixo , phys .  </S>",
    "<S> rev .  </S>",
    "<S> lett .  * 105 * , 170405 ( 2010 ) .    </S>",
    "<S> r.  bhatia , _ matrix analysis _ ( springer verlag , new york , 1997 ) .    </S>",
    "<S> j.  kempe , a.  kitaev , and o.  regev , siam journal of computing , * 35 * , 1070 ( 2006 ) .    </S>",
    "<S> d.  w.  berry _ et al . </S>",
    "<S> _ , comm .  math </S>",
    "<S> .  phys .  * </S>",
    "<S> 270 * , 359 ( 2007 ) .    </S>",
    "<S> see the introduction of ref .  </S>",
    "<S> @xcite .    </S>",
    "<S> reference @xcite only deals with the non interacting case . in ref .  </S>",
    "<S> @xcite weak means that @xmath139 is much smaller than the level spacing of @xmath21 , which is well defined in the limit of large baths , but still breaks down quickly even for relatively small subsystems and moreover the rigorous results are limited to cases where @xmath13 only couples neighboring eigenstates . ref .  </S>",
    "<S> @xcite contains a non rigorous discussion of the general case and numerical results suggesting that couplings much larger than the level spacing can be sufficiently weak for gibbs states to emerge ; a fact made rigorous in this work .    private communication with the authors of ref .  @xcite . </S>"
  ]
}