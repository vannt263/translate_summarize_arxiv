{
  "article_text": [
    "this paper concerns with the numerical solution of the finite horizon optimal investment problem with transaction costs under potential utility .",
    "let us consider an investor whose wealth can be inverted in a risky stock and in a riskless bank account .",
    "we suppose that the investor is risk averse with constant relative risk aversion ( crra ) . in @xcite",
    ", merton showed that , in absence of transaction costs , the problem can be explicitly solved .",
    "the optimal strategy consists in keeping a fixed proportion between the money invested in the risky asset and the bank account . when transaction cost are considered , the merton strategy is unfeasible because it requires a continuous portfolio rebalancing with unbounded costs .",
    "proportional transaction costs were first introduced in @xcite .",
    "more recently , in @xcite , the problem was reformulated as a non - linear parabolic double obstacle problem posed in one spatial variable , defined in an unbounded domain .",
    "several explicit properties and formulae were obtained in @xcite , although explicit formulae for the solution are not available .",
    "the problem was numerically solved in @xcite , where the authors employ a characteristics method with a projected relaxation scheme .",
    "the scheme proportionates satisfactory results with good agrement with the results in @xcite .",
    "when we want to solve financial problems , like finding investment strategies or pricing derivative contracts , in general , there is no known closed form solution of the different problems and several numerical methods have been employed . without the aim to be exhaustive , monte - carlo based methods ( @xcite , @xcite ) , piecewise linear interpolations ( @xcite ) , lattice methods ( @xcite , @xcite ) , finite elements ( @xcite ) or spectral methods ( @xcite ) are some of them .",
    "a general review of financial problems or models , numerical techniques and software tools can be found in @xcite .",
    "the objective of this paper is to construct a spectral method specifically adapted to the optimal investment problem with potential utility when proportional transaction costs are present .",
    "as it is well known , spectral methods @xcite are a class of spatial discretizations for partial differential equations which offer fast convergence in the case of smooth solutions .",
    "they are not widely used yet in numerical finances because it is usually believed that the lack of smoothness present in most interesting problems makes spectral methods uncompetitive . however",
    ", several papers have used spectral methods for problems in finance with good results .",
    "for instance , in @xcite a fourier - hermite procedure to the valuation of american options has been presented . in @xcite",
    "a spectral method based on laguerre polynomials has been employed to numerical valuation of bonds with embedded options . a fourier spectral method to compute fast and accurate prices of american options written on asset following",
    "garch models has been presented in @xcite . in @xcite",
    "the authors use an adaptive method with chebyshev polynomials coupled with a dynamic programming procedure for contracts with early exercise features . in @xcite",
    "a very efficient procedure for asian options defined on arithmetic averages has been proposed . in all cases ,",
    "the spectral - based methods have been proved to be competitive with other alternatives in terms of precision versus computing time needed to compute the numerical solution .    in the present paper , we restate the problem using polar coordinates .",
    "this allows to consider a double parabolic obstacle problem in one spatial - like variable defined in a bounded domain .",
    "furthermore , this formulation avoids the emergence of nonlinear terms simplifying the numerical treatment .",
    "we present a chebyshev spectral approach based on adaptive meshes to locate the optimal frontiers .",
    "although some of the numerical difficulties that appear with the parabolic double obstacle problem are avoided with our approach , we still have to deal with the so - called gibbs effect , which comes from the fact that the objective function is continuous but not differentiable at maturity .",
    "we show that this issue can be circumvented by using a time - adapted spatial mesh .",
    "we show that our approach is efficient by comparing it with a standard finite difference scheme .",
    "the outline of the paper is as follows . in section [ ch3toiprecon ] ,",
    "a description of the optimal investment problem as it can be found in @xcite or @xcite is presented . in section [ ch3dpr ] ,",
    "the problem is reformulated as a parabolic double obstacle problem as it was done in @xcite .",
    "afterwards , we propose an equivalent formulation of the problem employing polar coordinates .",
    "ch3 nm ] is devoted to a mesh - adapted chebyshev - collocation method which solves the problem of section [ ch3dpr ] . in section [ ch3numresults ]",
    "we perform the numerical analysis of the method .",
    "section [ ch3conclus ] presents some conclusions and future research .",
    "we consider an optimal investment problem with transaction costs , @xcite , @xcite .",
    "let @xmath0 be a filtered probability space .",
    "let us consider an investor who holds amounts @xmath1 and @xmath2 in a bank and a stock account respectively .",
    "the dynamics of the processes is @xmath3 where @xmath4 denotes the constant risk - free rate , @xmath5 is the constant expected rate of return of the stock , @xmath6 is the constant volatility of the stock and @xmath7 is a standard brownian motion such that @xmath8 where @xmath9 is the natural filtration induced by @xmath7 .",
    "we suppose that @xmath10 and @xmath11 are adapted , right - continuous , nonnegative and nondecreasing processes representing the cumulative monetary values of the stock purchased or sold respectively and @xmath12 and @xmath13 , represent the constant proportional transaction costs incurred on the purchase or sale of the stock . in this paper",
    "we assume that @xmath14 .",
    "the finance meaning of equation ( [ ch3ecudinacc ] ) is natural . along time , the rate of change of the amount of money invested in the risky asset , represented by the stochastic process @xmath2 , evolves according to a standard geometric brownian motion modified by the difference between the amount of money invested in buying stock , @xmath15 , and the amount of money obtained selling stock , @xmath16 . at the same time",
    ", the value of the bank account , @xmath1 , is instantaneously increased by the difference @xmath17 , that represents the net flow of money resulting from stock negotiations , including the transaction costs .",
    "processes @xmath10 and @xmath11 can be financially understood as an historical record of the total purchases and sales of stock of the investor .",
    "the net wealth is the money the investor would have if he closes his positions .",
    "it can be written as @xmath18 if the investor is long in the stock or @xmath19 in case the investor is short in the stock .",
    "let @xmath20 be a utility function , that is , a continuous , strictly increasing , concave function .",
    "the optimal value function is given by : @xmath21,\\ ] ] for all @xmath22 $ ] , where @xmath23 is the set of admissible strategies , defined as the set of processes @xmath24 such that if @xmath25 then @xmath26 for @xmath27 and where @xmath28 is the solvency region , @xmath29    in this paper , we assume that @xmath20 is a potential function ( constant relative risk aversion utility function ) of the form @xmath30 for some constant @xmath31 , @xmath32 .",
    "the optimal value function ( [ ch3defvarpphi ] ) , see @xcite , is the viscosity solution in @xmath33 $ ] of @xmath34 subject to : @xmath35 where @xmath36    the existence and uniqueness of a viscosity solution of ( [ chp3hjbecu1])-([chp3hjbecu2 ] ) has been proved in @xcite .",
    "there , it is proved that at any time @xmath37 , the spatial domain is divided in three regions , namely , in financial terms , the buying region @xmath38 , the selling region @xmath39 and the no transactions region @xmath40 .",
    "the selling and buying regions do not intersect .",
    "for simplicity in the exposition , we suppose that @xmath41 . with this hypothesis ,",
    "short - selling is always a suboptimal strategy @xcite , @xcite , @xcite .",
    "this means that the optimal trading strategy is always to have a nonnegative amount of money invested in the stock .",
    "as remarked in @xcite , the choice of the potential utility function is interesting since it leads to the homothetic property in the optimal value function , @xmath42 this property is used in @xcite to reduce the dimensionality of the problem . setting @xmath43 , a new function @xmath44 is introduced in @xcite , so that : @xmath45    in @xcite , the authors prove that @xmath46 is the solution of an one dimensional parabolic double obstacle problem with two free boundaries equivalent to ( [ chp3hjbecu1 ] ) .",
    "furthermore , it is also proved in @xcite , that there exist two continuous monotonically increasing functions @xmath47\\rightarrow(-(1-\\mu),+\\infty],\\ ] ] such that @xmath48 .",
    "the buying and selling regions are characterized by @xmath49 \\",
    "\\mid z\\leq\\text{sr}^c_f(t ) , t\\in[0 , \\ t ] \\right\\ } , \\\\",
    "\\text{\\textbf{br } } & = \\left\\{(z , t)\\in\\omega\\times[0,t ] \\",
    "\\mid z\\geq\\text{br}^c_f(t ) , t\\in[0 , \\ t ] \\right\\}. \\\\ \\end{aligned}\\ ] ]    although other properties and explicit formulas are obtained in @xcite , a complete analytical solution is still missing and numerical procedures have to be used , see , for example , @xcite .",
    "here , inspired by @xcite , we take advantage of ( [ homothetic ] ) by working in polar coordinates @xmath50 , @xmath51 .",
    "it is not difficult to show that ( [ chp3hjbecu1])-([chp3hjbecu3 ] ) are equivalent to @xmath52 subject to : @xmath53 where @xmath54 and @xmath55    based on ( [ homothetic ] ) , we conjecture a solution to ( [ ch3ecuinicpol ] ) of the form : @xmath56 taking into account that @xmath57 and substituting in ( [ ch3ecuinicpol ] ) , ( [ finalcondition1 ] ) , we see that @xmath58 satisfies , @xmath59 subject to : @xmath60 the functions @xmath61 , @xmath62 , are given by @xmath63    the solvency region in the new coordinates is given by : @xmath64 where @xmath65    this formulation has several advantages over the formulation of @xcite .",
    "as in @xcite , the problem is one dimensional ( ( [ ch3enunprobpolar])-([ch3enunprobpolar2 ] ) do not depend of @xmath66 ) , but in our case the domain is bounded ( @xmath67 ) .",
    "furthermore , the operators involved in ( [ ch3enunprobpolar ] ) are linear in @xmath68 , whereas in @xcite , the equations contains a nonlinear term .",
    "next , we characterize the buying and selling regions in terms of the polar coordinates .",
    "first , let us observe that @xmath69 where @xmath46 is the function defined in ( [ checamborig ] ) .",
    "let us define the functions @xmath70 and @xmath71 by @xmath72,\\ ] ] where @xmath73 and @xmath74 are the boundaries of the buying and selling regions in cartesian coordinates defined in ( [ ch3funfronc ] ) .",
    "the following proposition is an immediate consequence of the results in @xcite .",
    "[ ch3tradpropertapolar ] functions @xmath71 , @xmath70 are monotonically decreasing functions .",
    "it holds that @xmath75 and that @xmath76,\\quad \\hat{t}_0=t-\\frac{1}{\\alpha - r}\\log\\frac{1+\\lambda}{1-\\mu}.\\ ] ]    if @xmath77 , then @xmath78 , with @xmath79    it holds that @xmath80 , where @xmath81 is the merton line .",
    "if @xmath82 , there exist two values @xmath83 , such that @xmath84 the limit values @xmath85 and @xmath86 are defined by @xmath87 where @xmath88 and @xmath89 are the constants defined in ( * ? ?",
    "* theorem 6.1 ) .",
    "the functions @xmath71 , @xmath70 satisfy ( see also ( * ? ? ?",
    "* proposition 3.4.2 ) ) , @xmath90.\\ ] ]    it is now easy to see that , for @xmath91 $ ] , the buying , selling and no transaction region can be described by as follows :    * 1 . * the buying region",
    "is defined by @xmath92 $ ] . in @xmath93",
    "the value function satisfies @xmath94 * 2 . * the selling region",
    "is defined by @xmath95 . in @xmath96",
    "the value function satisfies @xmath97 * 3 . * the no transaction region",
    "is defined by @xmath98 . in @xmath99 ,",
    "@xmath68 satisfies of the following partial differential equations @xmath100    we remark that if the buying ( @xmath101 ) and selling ( @xmath102 ) frontiers are known , we can compute the value function @xmath58 in @xmath93 and @xmath96 explicitly by a simple integration of equations ( [ chp3brexpformula ] ) and ( [ chp3srexpformula ] ) respectively . for @xmath103 , we have @xmath104 and for @xmath105 , @xmath106     value function ( numerical solution ) for @xmath107\\times[0,30]$ ] .",
    "the colour code is blue if @xmath108 is in the buying region , green in the no transactions region and red in the selling region.,width=453,height=188 ]    figure [ ch3stationarycn2 ] represents the value function in perspective ( left ) and from above ( right ) in @xmath109 $ ] , for a maturity of @xmath110 years .",
    "the figure shows the numerical values obtained for the function @xmath58 with the method described in section [ ch3 nm ] .",
    "we have coloured the function depending in whether @xmath108 is in the buying , selling or no transactions region .",
    "we can visually check the expected monotonicity of the buying and selling frontiers studying from above ( right ) the two curves which divide the different colours ( red - green and green - blue ) .",
    "the buying frontier remains constant ( @xmath111 ) for a certain period near maturity and the stationarity value of both frontiers as we move away from maturity is also observable .",
    "the numerical method described in this section is constructed upon the following strategy .",
    "let @xmath112 denote an admissible trading strategy where @xmath113 and @xmath114 are the amount of money in the bank and stock accounts at @xmath115 .",
    "let @xmath116 and @xmath117 and define @xmath118 where @xmath119 , @xmath120 are the amounts in the bank and stock accounts if strategy @xmath121 is followed .",
    "proposition  [ ch3tradpropertapolar ] implies that @xmath122 where @xmath123 denotes the optimal trading strategy solving ( [ ch3defvarpphi ] ) .",
    "therefore , the optimal value function can be computed as the solution of ( [ ch3enunprobpolar])-([ch3enunprobpolar2 ] ) in @xmath124 $ ] subject to the boundary conditions : @xmath125 these conditions are equivalent to a mandatory buying or selling the stock if @xmath126 reaches @xmath127 or @xmath128 respectively ( see formulas ( [ chp3brexpformula])-([chp3srexpformula ] ) ) .",
    "the solution can be extended to @xmath129 $ ] taking into account that for @xmath130 $ ] : @xmath131 and @xmath132 , so that we can compute @xmath58 with ( [ ch3exfsrbr1 ] ) in @xmath93 and ( [ ch3exfsrbr2 ] ) in @xmath96 .",
    "let @xmath133 be a nonnegative integer and let us define the time mesh @xmath134 by @xmath135 the spatial mesh will depend on the time step .",
    "the main idea is to adapt the mesh in such a way that it evolves through time following the approximate location of the buying and selling frontiers ( i.e. evolving as the green zone in figure [ ch3stationarycn2 ] ) . to this end , let @xmath136 be a control parameter .",
    "we define @xmath137 where @xmath138 $ ] is the stationary state of the selling frontier ( see proposition  [ ch3tradpropertapolar ] ) .    for @xmath139 ,",
    "let us consider the @xmath140 chebyshev nodes in @xmath141 $ ] , @xmath142    we define the integer @xmath143 as the unique integer such that @xmath144 note that @xmath145 is well defined because @xmath146 . from the definition of the chebyshev nodes",
    ", it is easy to check that it exists @xmath147 such that for all @xmath148 , @xmath149 .",
    "let us suppose that at time @xmath150 , we know the locations of the buying and selling frontiers , @xmath151 and @xmath152 . given @xmath153 , @xmath154",
    "we define an interval @xmath155 by : @xmath156,\\ ] ] if @xmath157 , or , in case @xmath158 , @xmath159.\\ ] ] here @xmath160 .",
    "we remark that , with this definition , the interval @xmath155 always contains the no transaction region @xmath161 $ ] and it is contained in the solvency region @xmath162 $ ] .",
    "furthermore , @xmath163 and @xmath164 are always one of the @xmath165 chebyshev nodes in the interval @xmath155 , while restriction @xmath154 implies that @xmath164 is an interior point of @xmath155 .",
    "the control parameter @xmath166 guaranties that a maximum of @xmath167% of interval @xmath155 is contained in the selling region , another maximum of @xmath167% of @xmath155 in the buying region , whereas a minimum @xmath168% of @xmath155 is contained in the no transactions region .    note also that for @xmath169 , the values @xmath170 and @xmath171 are , of course , known data ( see proposition [ ch3tradpropertapolar ] ) , whereas for @xmath172 , we have to substitute @xmath151 and @xmath152 by some approximation that we will denote @xmath173 and @xmath174 where @xmath175 .",
    "we will describe in subsection [ ch3maccmcc ] how to compute them prior to the construction of the interval @xmath155 .",
    "next proposition proves that , for @xmath133 big enough , @xmath176 , so that we can compute recursively the intervals @xmath177 for @xmath178 .",
    "[ ch3propoinclusnteninter ]    let @xmath179 $ ] where @xmath180 and @xmath181 are the exact location of the buying and selling frontiers .",
    "for any @xmath154 , where @xmath147 is the restriction which guarantees that @xmath102 will be in the interior of @xmath182 , compute @xmath182 with ( [ ch3forint1 ] ) or ( [ ch3forint2 ] ) .",
    "it exists @xmath183 such that for any time mesh @xmath184 given by ( [ ch3timediscret ] ) , it holds @xmath185 for any @xmath186 .    from @xcite , we know that @xmath187",
    ". therefore , @xmath188 is @xmath189 .",
    "let @xmath89 from ( [ ch3paramk ] ) be fixed . since @xmath102 is in the interior of @xmath182 , it will exist @xmath190 such that for all @xmath191 : @xmath192    this guarantees that for any equally spaced time mesh @xmath193 , with @xmath194 , @xmath195 .    to finish the proof , note that from proposition [ ch3tradpropertapolar ] , @xmath196 and that @xmath197 , so the result follows directly from the definition of @xmath155 .",
    "let us suppose that we know an approximation of the function value @xmath198 , @xmath199 and approximate values of @xmath200 and @xmath201 at time @xmath150 .",
    "for @xmath202 big enough ( proposition  [ ch3propoinclusnteninter ] ) , we can compute @xmath203 $ ] defined as in ( [ ch3forint1 ] ) if @xmath204 , or with ( [ ch3forint2 ] ) otherwise .    for @xmath205 $ ]",
    ", we define the function @xmath206 as the function value which gives the expected terminal value when the trading strategy is to perform no transactions if @xmath207 , to buy the stock if @xmath208 and to sell the stock if @xmath209 , subject to @xmath210 .",
    "therefore , @xmath206 is the solution of the equation @xmath211 subject to @xmath212    let us consider the @xmath165 chebyshev nodes in @xmath155 @xmath213 where @xmath214 are the chebyshev points ( [ ch3chebynodes ] ) .",
    "the numerical approximation @xmath215 , @xmath216 to the function @xmath206 is the collocation polynomial @xcite of degree @xmath202 defined for @xmath217 by : @xmath218 subject to @xmath219 with ( neumann ) boundary conditions @xmath220 where @xmath221    the equations ( [ ch3collocationmethod])-([ch3collocationmethodcons ] ) define a dense system of linear equations to find the values of @xmath222 , @xmath223 .",
    "however , the fact that , with relative few nodes for the spatial mesh we can achieve a very good precision , makes this method competitive with respect to a finite differences method , see section  [ ch3numresults ] .",
    "let us define @xmath224 which are explicit functions because @xmath225 is a known polynomial in @xmath126 . in ( [ ch3auxencheby ] ) ,",
    "we compare ( see ( * ? ? ?",
    "* subsection 3.5.3 ) ) whether it is better to not perform transactions or to buy the stock ( resp .",
    "sell the stock ) .",
    "if polynomial @xmath226 ( resp .",
    "@xmath227 ) it is better to not perform transactions rather than buy ( resp .",
    "sell ) the stock .",
    "the numerical approximation to the buying and selling frontiers is given by : @xmath228 \\right\\ } , \\\\",
    "\\end{aligned}\\ ] ]    once we know the location of the frontiers and the function value in that points , we can compute the approximate function value through the following explicit formulas where we have used the notation @xmath229 , @xmath230 @xmath231^{\\gamma},\\ ] ] if @xmath232 , @xmath233 @xmath234^{\\gamma},\\ ] ] if @xmath235 .",
    "then the complete algorithm reads as follows :    * fix a number @xmath133 and a number @xmath202 big enough such that proposition  [ ch3propoinclusnteninter ] holds .",
    "+ compute @xmath236 and @xmath193 as in ( [ ch3timediscret ] ) . define @xmath175 . + set @xmath237 and compute @xmath238 with formula ( [ ch3forint1 ] ) + compute @xmath239 , @xmath240 , as the chebyshev interpolation polynomial in @xmath241 of function @xmath242 , given by ( [ ch3enunprobpolar2 ] ) , where @xmath241 denote the chebyshev nodes in @xmath238 .",
    "* compute the polynomial @xmath215 solving the collocation equations ( [ ch3collocationmethod ] ) with final condition ( [ ch3valorcondvencheby ] ) and boundary conditions ( [ ch3collocationmethodcons ] ) . *",
    "locate the buying and selling frontiers @xmath243 and @xmath244 using ( [ frontiers ] ) . *",
    "compute the interval @xmath245 with ( [ ch3forint1 ] ) if @xmath246 or with ( [ ch3forint2 ] ) otherwise .",
    "+ compute the numerical approximation @xmath247 at time @xmath248 with formulae ( [ vn1 ] ) , ( [ vn2 ] ) and ( [ vn3 ] ) . *",
    "set @xmath249 and stop if @xmath250 or , otherwise , proceed to * step 1*.",
    "we consider the parameter values as in the first experiment in @xcite . for",
    "@xmath251 $ ] let : @xmath252    the following figure shows the numerical solution @xmath253 .",
    "[ ch3v1valfun4anos ]   for @xmath254}$ ] .",
    "the colour code is blue if @xmath108 is in the buying , green in the no transactions and red in the selling region.,title=\"fig:\",width=453,height=188 ]    we have colored the function depending in whether @xmath108 is in the buying , selling or no transactions region . as in figure",
    "[ ch3stationarycn2 ] , we can visually check the properties from proposition [ ch3tradpropertapolar ] .",
    "first , we establish the criteria employed in the experiments to build the spatial mesh .",
    "we have fixed the control parameter @xmath255 , so that , at least @xmath256% of the interval corresponds to the no transactions region .",
    "the particular choice of @xmath166 does not affect the rate of convergence of the error .    in order to compare the performance of the spectral method with other numerical methods ,",
    "we have also implemented a central differences ( cd ) based method in order to solve the pde in step 2 ( see subsection [ ch3maccmcc ] ) .",
    "the formal study of the error will be conducted for the cases where explicit formulas are available , comparing the results of the central differences and chebyshev methods .",
    "the rest of the properties given in @xcite , although not included , were also checked .",
    "we consider @xmath46 defined in ( [ checamborig ] ) . for @xmath258 , we can explicitly compute @xmath257 with ( * ? ? ?",
    "* ( 3.9 ) ) . in figure [ ch3analiticalsolv0 t ]",
    "we plot the value of @xmath257 for @xmath259 $ ] .     analytical solution of @xmath260$].,width=245,height=188 ]    the value @xmath258 corresponds in polar coordinates to @xmath261 .",
    "a numerical solution @xmath262 can be computed explicitly using @xmath263 and formula ( [ ch3formularelacionpolarorig ] ) , which relates the function in polar coordinates and in the original variables . @xmath264",
    "the following figure compares the difference between the analytical solution @xmath260 $ ] and the numerical solution obtained with the chebyshev method for @xmath265 ( left ) and @xmath266 ( right ) .",
    "both pictures are in the same scale and we can observe that the error reduces for increasing value of @xmath202 .",
    "value @xmath267 $ ] where @xmath268 was computed with the chebyshev method with @xmath265 ( left ) and @xmath266 ( right).,width=529,height=207 ]    in both pictures of figure [ ch3valpimedcomcheb ] we can observe an error discontinuity at time @xmath269 . from ( * ? ? ?",
    "* ( 3.9 ) ) , we know that the function @xmath257 is not derivable ( respect time ) at instant @xmath269 .",
    "the same phenomena can be observed in the numerical experiments in @xcite .",
    "we can also see that some oscillations appear at time @xmath270 where we change the kind of adaptive mesh @xmath271 ( see subsection [ ch3maccmam ] ) .",
    "we proceed to check the rate of error convergence .",
    "we define the root of the mean square error as @xmath272    figure [ ch3converrtesptempvalpimed ] shows the convergence of spatial error ( left ) for @xmath273 and different number of spatial nodes @xmath202 .",
    "the right side shows the convergence of temporal error for @xmath202 fixed and different values of @xmath133 .     spatial ( left ) and temporal ( right ) error convergence of @xmath268 in logarithmic scale of the central differences ( blue ) and chebyshev ( red ) methods.,width=472,height=200 ]    in the left side of figure [ ch3converrtesptempvalpimed ]",
    "we have plotted , in logarithmic scale , the number @xmath202 of spatial nodes versus the value @xmath274 .",
    "the slope of the regression line of the cd method ( plotted in blue ) is @xmath275 and of the chebyshev method ( plotted in red ) is @xmath276 .",
    "the spectral convergence that we could expect in the chebyshev method does not occur due to the regularity of the problem .    in the right hand side of figure [ ch3converrtesptempvalpimed ] , we have plotted , in logarithmic scale , the number @xmath277 of time steps versus the value @xmath274 .",
    "the slope of the regression line of the cd method ( solid - blue ) is @xmath278 as it could be expected from an order 2 method .",
    "the slope of the chebyshev method ( solid - red ) is @xmath279 .",
    "we note that for large values of @xmath133 we reach very soon the error limit marked by the size of @xmath202 .",
    "we carry out a second experiment doubling the value of @xmath202 ( right - dashed - blue / red ) to check that the lowest value reached by the temporal error was given by the size of the spatial mesh .    depending on the error tolerance",
    ", we might need a big value for @xmath202 in the cd method but much smaller in the chebyshev method .",
    "this makes that , depending on the required precision , chebyshev performs better in computational cost than cd .",
    "this will be studied below .      from proposition [ ch3tradpropertapolar ] , we know that in polar coordinates @xmath78 .    given",
    "a number of time steps @xmath133 , we look for @xmath280 which is nearest to @xmath269 and define the absolute error ( just for this experiment ) as : @xmath281    the next figure shows the convergence of spatial error ( left ) for @xmath273 and different number of spatial nodes @xmath202 . the right side shows the convergence of temporal error for @xmath266 ( chebyshev ) and @xmath282 ( cd ) and different values of @xmath133 .",
    "spatial ( left ) and temporal ( right ) error ( semilogarithmic scale ) of instant when @xmath283 with the cd ( blue ) and chebyshev ( red ) methods.,width=472,height=200 ]    the spatial error ( left ) reduces as we increase the value of @xmath202 . at equal number of nodes ,",
    "the chebyshev method gives much smaller errors than the cd method .    concerning the temporal error , the results are step shaped because of the definition of absolute error and the time partition when",
    "@xmath284 is halved .",
    "each time partition is included in the following one and @xmath285 sometimes changes and sometimes not .",
    "the temporal error reduces as we increase the value of @xmath277 . as in the spatial error ,",
    "the chebyshev method outperforms the cd method .      from proposition [ ch3tradpropertapolar ] , we know that @xmath286 where @xmath270 is explicitly computable .    given a number of time steps @xmath133 ,",
    "we look for @xmath186 such that @xmath287    for the chebyshev method , the @xmath288 may be bigger than 0 a few time steps prior to @xmath289 .",
    "we note that in the chebyshev method , the lower limit of @xmath290 $ ] is the buying frontier .    in left picture of figure [ ch3v1buyingfrontiercheby ]",
    ", we have plotted the numerical estimation of the buying frontier with the chebyshev method for , @xmath265 ( blue ) , @xmath291 ( red ) , @xmath292 ( green ) @xmath266 ( black ) . in the right picture",
    "we zoom around @xmath270 .",
    "numerically computed buying frontier with the chebyshev method for @xmath259 $ ] ( left ) and zoom around @xmath270 ( right).,width=491,height=207 ]    let @xmath293 be the biggest value such that @xmath294    if @xmath295 , the location of the buying frontier oscillates around 0 for @xmath296 and for @xmath297 when it behaves as we could expect from proposition [ ch3tradpropertapolar ] .",
    "numerical experiments show that it is better to let @xmath200 oscillate around 0 rather than imposing @xmath298 .",
    "the oscillations observed in figure [ ch3v1buyingfrontiercheby ] are generated by the imposition of the neumann conditions .",
    "the boundary error is controlled by @xmath133 and @xmath202 , but the spatial error is dominant in this experiment .",
    "the instant when the numerical solution begins to oscillate is always very close to @xmath270 @xmath299 and the size of the oscillations reduces as @xmath202 increases .",
    "these oscillations are the error that we are going to study .",
    "they include all the negative values ( since the buying frontier must be always positive ) and any positive value for discrete times larger than @xmath270 .",
    "thus , we define , for this method and experiment , the absolute error ( ae ) as @xmath300    we fix @xmath273 and compute the absolute error for several values for @xmath202 ) . in figure [ ch3v1convespfronnocerocheby ]",
    "we plot , in logarithmic scale , the value of @xmath202 versus the absolute error . as we can see the error",
    "is rapidly reduced by increasing @xmath301 .",
    "spatial error convergence of the first instant when it is optimal to have a positive amount of stock ( chebyshev method).,width=226,height=188 ]      @xmath302 and @xmath303 tend to a stationary state as @xmath304 that can also be computed explicitly ( see proposition [ ch3tradpropertapolar ] ) . computed with the same model parameters as before but for @xmath110 years ( see figure [ ch3stationarycn2 ] ) ,",
    "frontiers have stabilized a few years before reaching @xmath115 at : @xmath305 computed with the chebyshev method ( @xmath306 , @xmath291 ) .",
    "we define the absolute error ( for this experiment ) as @xmath307    we study the spatial ( @xmath308 and several values for @xmath202 ) and temporal ( @xmath309 for the cd , @xmath291 for the chebyshev method , and several values for @xmath133 ) error convergence .",
    "in figure [ ch3v1estacconv ] we plot , in logarithmic scale , the value of @xmath301 ( left ) versus the absolute value of the error and the value of @xmath133 ( right ) versus the absolute value of the error for both methods .",
    "spatial ( left ) and temporal ( right ) error convergence , in logarithmic scale , of the stationary state of the buying frontier for the cd(blue ) and chebyshev ( red ) methods.,width=510,height=226 ]    in this experiment , temporal error is dominant compared with respect to the spatial error in the chebyshev method . in the case of the cd method , the error depends more in both the spatial and temporal discretizations . on the left side picture",
    ", we can see that the chebyshev method reaches the error marked by the time discretization with the smallest number of nodes therefore , if a high precision is required , chebyshev will perform better than the central differences method .",
    "the error behaviour of the selling frontier is similar to the one of the buying frontier .      in this section",
    "we compare the relative performance of the pseudospectral and finite difference methods .",
    "first of all , we fix several time and spatial discretization parameters :    a.   @xmath310 $ ] b.   @xmath311 $ ] ( chebyshev ) c.   @xmath312 $ ] ( central differences )    and solve the problem with all the combinations of the different discretizations for both methods .",
    "the lower and upper bounds of @xmath202 in the central differences method can be taken smaller or bigger .",
    "the criteria that we have employed is such that the numerical error varies between @xmath313 and @xmath314 .",
    "the same reads for the upper bound of @xmath202 in the chebyshev method .",
    "we point that during the implementation of the method , we observed that if @xmath202 was not big enough , the location of the frontiers may oscillate ( due to the gibbs effect or to the fact that the polynomials are not accurate enough ) , complicating the location of @xmath315 and @xmath316 in ( [ frontiers ] ) .",
    "the chebyshev spectral method is effective once enough resolution has been reached .",
    "this behaviour is typical of high order methods , see @xcite .",
    "the employment of the adaptive interval @xmath155 and an enough amount of interpolation nodes avoids the oscillations and allows to obtain just one numerical approximation of @xmath315 and @xmath316 in ( [ frontiers ] ) .",
    "the oscillations may appear if the following ( empirical ) bounds are violated @xmath317 where @xmath318 and numerical experiments suggest that @xmath319 might be a growing function of @xmath202 .",
    "the lowest value of @xmath202 in the chebyshev method was chosen so that no oscillations appear . if a smaller number of interpolation nodes is chosen , the solution oscillates and the error worsens .",
    "we plot the value of @xmath320 ( [ ch3errrorcuadmed ] ) versus the computational time employed in computing @xmath268 for each different spatial and temporal meshes in logarithmic scale .",
    "performance comparison of the error at @xmath321 . in logarithmic scale , we plot ( left ) , the value of rmse versus the total computational costs of cd ( blue ) and chebyshev ( red ) methods and their respective lower enveloping curves ( right).,width=510,height=226 ]    the left - side picture of figure [ ch3v1performanceerror ] represents the cloud of results for the different discretizations of each method . the right - side , which is more visual , represents the lower convex enveloping curve .    with the right - side picture",
    ", we can obtain an approximate behaviour of the evolution of the error versus the required computational time to reach that precision .",
    "we fix the error tolerance that we require for our problem and find which method and spatial and time discretization reaches it first .    as we can see , the cd method ( blue in figure [ ch3v1performanceerror ] ) performs better if we do not require a high precision .",
    "if a higher precision is required , chebyshev ( red in figure [ ch3v1performanceerror ] ) performs better than cd .    a similar behaviour can be observed if we compare the errors of the rest of cases where we have explicit formulas .",
    "the homothetic property of the potential utility function has been used to restate the investment problem in polar coordinates .",
    "this has allowed us to give an equivalent formulation of the problem in a bounded spatial domain .",
    "although some of the numerical difficulties that appear with the parabolic double obstacle problem are avoided , other problems may appear if we employ spectral methods .",
    "the gibbs effect , which comes from the fact that the objective function is continuous but not differentiable at maturity , can complicate the location of the frontiers , but this issue can be circumvented by the employment of a time - adapted spatial mesh ( subsection [ ch3maccmam ] ) .      further work may include the extension of the model including a consumption term or the design of spectral methods to optimal investment problems with other utility functions , like the exponential utility . furthermore , through the indifference pricing technique ( see @xcite and @xcite ) , these kind of models can be applied to option valuation .",
    "chiarella , c. , el - hassan , n. and a. kucera , a _ evaluation of american option prices in a path integral framework using fourier - hermite series expansion _",
    ", journal of economic dynamics and control 23 ( 1999 ) , 1387 - 1424 ."
  ],
  "abstract_text": [
    "<S> this paper concerns the numerical solution of the finite - horizon optimal investment problem with transaction costs under potential utility . </S>",
    "<S> the problem is initially posed in terms of an evolutive hjb equation with gradient constraints . in @xcite , the problem is reformulated as a non - linear parabolic double obstacle problem posed in one spatial variable and defined in an unbounded domain where several explicit properties and formulas are obtained . </S>",
    "<S> the restatement of the problem in polar coordinates allows to pose the problem in one spatial variable in a finite domain , avoiding some of the technical difficulties of the numerical solution of the previous statement of the problem . </S>",
    "<S> if high precision is required , the spectral numerical method proposed becomes more efficient than simpler methods as finite differences for example .    </S>",
    "<S> * keywords : * optimal investment , potential utility , transaction costs , spectral method . </S>"
  ]
}