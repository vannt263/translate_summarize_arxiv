{
  "article_text": [
    "the non - local means ( nlm ) algorithm was introduced by baudes et al .",
    "@xcite for denoising natural images corrupted with additive gaussian noise .",
    "two key innovations of nlm are the effective use of non - local correlations in images , and the use patches ( blocks of neighbouring pixels ) instead of single pixels to robustly compare photometric similarities .",
    "the conceptual simplicity of nlm , coupled with its excellent denoising performance , triggered a huge amount of research on the use of non - local patch - based models for image restoration @xcite .",
    "some of these methods provide state - of - the - art results in image denoising for a wide class of natural images .",
    "we refer the interested readers to @xcite for an exhaustive account of patch - based methods .",
    "the non - local means of a discrete image @xmath1 is given by the weighted average @xmath2 where the weights are set to be @xmath3 here patch @xmath4 is the restriction of @xmath5 to a square grid of length @xmath6 centred at @xmath7 , @xmath8 is the euclidean distance between @xmath4 and @xmath9 as points in @xmath10 , @xmath11 denotes the domain over which the averaging is performed , and @xmath12 is a smoothing parameter . to exploit non - local correlations in images , the original proposal in @xcite was to set @xmath11 to be the the whole image domain . in practice",
    ", however , one restricts @xmath11 to a sufficiently large square window of length @xmath13 centred at @xmath7 .",
    "along with the non - local averaging , it is the use of patches that makes nlm more robust than pixel - based neighborhood filters @xcite",
    ".    a drawback of nlm is its high computational complexity . in particular , if each patch is of length @xmath6 and the search window is of length @xmath13 , then the direct computation of requires @xmath14 operations for an image of size @xmath15 .",
    "several computational tricks and trade - offs have been proposed to accelerate nlm .",
    "these can broadly be classified into the following categories :    * neighborhood selection : the neighbourhoods are pre - selected based on intensity gradient @xcite , mean and variance @xcite , higher moments @xcite , tree structures @xcite , and probabilistic termination @xcite .",
    "* dimensionality reduction : the patches are projected into a lower dimensional subspace using pca @xcite or svd @xcite . * fast distance computation : the patch distances are computed using convolutions and ffts @xcite , possibly at the cost of added storage .",
    "* efficient data structures : here nlm is posed as a multi - dimensional filtering and efficient data - structures are used @xcite .",
    "the nlm formula can be extended to signals of any arbitrary dimension simply by adapting the definition of a patch . in one - dimension ,",
    "a patch is simply an interval . in this paper",
    ", we present a conceptually simple idea for reducing the complexity of one - dimensional nlm from @xmath16 to @xmath17 , where @xmath18 is the length of the signal .",
    "the idea is based on the novel observation that the patch distances involved in the non - local means of a one - dimensional signal can be computed using simple moving sums of an image , which is derived from the tensor product of the signal with itself .",
    "the complexity of the moving sum is @xmath19 with respect to the the patch length , and as a result the proposed algorithm requires just @xmath17 operations to compute the patch distances required in nlm ( cf",
    ". section [ section2 ] ) .",
    "the present idea of using moving sums is similar in spirit to the idea of using moving sums and integral images proposed in @xcite for fast patch distance computation .",
    "however , to the best of our knowledge , the idea of lifting is new .",
    "we next apply the proposed algorithm to develop a fast separable extension of nlm for images in section [ section3 ] .",
    "this was partly motivated by the work on separable bilateral filtering and nlm @xcite .",
    "the complexity of the fast separable nlm proposed in this paper is @xmath20 for an image with @xmath21 pixels , which is substantially smaller than the @xmath14 complexity of the original nlm . in practice",
    ", the proposed extension turns out to be at least @xmath0 faster and yields peak - signal - to - noise ratios ( psnrs ) that are typically within @xmath22 db of the psnrs obtained using the original nlm .",
    "in fact , what we find quite intriguing is that the psnr obtained using separable nlm is at times significantly larger than the psnr obtained using the original nlm ( optimized with respect to the parameters in either case ) ; see figure [ comparison ] and table [ table2 ] .",
    "we now explain the main idea for a one - dimensional signal , which will be relevant in the context of separable nlm in section [ section3 ] .",
    "later , in section [ section4 ] , we will briefly discuss how the idea can be extended to higher - dimensions .",
    "suppose we have a one - dimensional signal @xmath23 .",
    "a patch of length @xmath6 centred at @xmath7 is simply the collection of samples @xmath24 .",
    "consider two such patches centered at @xmath7 and @xmath25 .",
    "the squared euclidean distance between these patches is @xmath26 we require @xmath27 operations to compute each @xmath28 . in one - dimensional nlm ,",
    "the weights are given by @xmath29 , and @xmath30 note that , for any given @xmath7 , we only required @xmath13 distances , namely @xmath31 .",
    "therefore , the total complexity is @xmath16 for a signal of length @xmath18 .",
    "the question is whether it is possible to reduce this complexity somehow by exploiting the overlap between adjacent patches ?",
    "we now show that this is indeed the case .     +      the terms on the right in involve products of the signal samples .",
    "our key observation that this non - linear dependence can be transformed into a linear one by massaging the samples . in particular , we first construct a tensor @xmath32 on @xmath33 defined as @xmath34 we refer to @xmath32 as the _ tensor - lift _ ( or simply _ lift _ ) of @xmath5 . we then define @xmath35 note that this is very a special form of convolution , namely the moving sums of @xmath32 along its sub - diagonals . using and",
    ", we can write as @xmath36 following , we will refer to @xmath37 as the _ kernel _ of the patch distances .",
    "each distance computation requires just three samples of this kernel , one multiplication , and two additions .",
    "moreover , since @xmath32 is symmetric , it follows from that @xmath37 is also symmetric : @xmath38 .",
    "therefore , it suffices to compute those @xmath39 for which , say , @xmath40 .",
    "this reduces the computation by half .    at first sight",
    "it seems that we have not achieved anything , and that is simply another way of writing .",
    "however , note that we have effectively transferred the non - linearity in onto the lift , and kernel can now be computed efficiently using moving sums of the lift .",
    "indeed , it is a well - known fact that moving sums in one dimension can be implemented using just two operations per sample using recursion @xcite . in particular , we see from that @xmath41 thus given @xmath42 , we can compute @xmath43 using just two additions , and so on .",
    "we will see shortly how this nicely fits with the structure of the distances required in nlm .",
    "the above lifting trick was motivated by the idea of matrix - lifting used in semidefinite relaxation in which a quadratic form on a vector variable is transformed into a linear form on a matrix variable that has been `` lifted '' from the vector ; see , e.g. , @xcite",
    ". we will refer to the present idea of computing patch distances using lifting as patchlift .",
    "arising from a one - dimensional signal .",
    "the red arrow shows the direction of the recursive moving sums ( from the top left to the bottom right ) for performing nlm with a window size @xmath44 .",
    "each recursive update requires just one addition and one subtraction along the direction of the arrow .",
    "note that we do not need to store the entire lift .",
    "only those @xmath45 for which @xmath46 are required ( marked as a diagonal band ) .",
    "similarly , we only need to store only those @xmath39 for which @xmath46 .",
    "thus both storage and time complexity is @xmath17 . ]",
    "as noted earlier , nlm requires only the knowledge of the distances between patches that are spatially close . for a search window of length @xmath13",
    ", the relevant elements of the lift matrix and the kernel are shown in figure [ bandedmatrix ] .",
    "in particular , for a signal of length @xmath18 , we are required to compute the kernel at the following positions @xmath47 ( with boundaries handled appropriately ) . using relation",
    ", one can compute these @xmath17 elements using @xmath17 operations . for completeness , the matlab script for computing the kernel from the signal is provided below ( note that @xmath48 is passed as an argument just for padding the boundary ) .",
    "now , given the kernel and hence the patch distances , we can compute using another @xmath17 operations .",
    "thus , the total complexity of computing the nlm of a one - dimensional signal using patchlift is @xmath17 , while the complexity of the original nlm is @xmath16 . for patches of moderate - to - large length @xmath48 , this reduction can be significant .",
    "we will refer to the proposed implementation of nlm as patchlift - nlm .",
    "we will briefly discuss in section [ section4 ] how patchlift could be extended to higher dimensions .",
    "in particular , we can use patchlift for efficiently computing the patch distances in for images .",
    "we will , however , take a different route which appears to provide an optimal trade - off between the denoising result and the run time .",
    "in particular , we consider a separable extension of the one - dimensional nlm to images in which we first apply patchlift - nlm on the rows of the image , and then on the columns of the the intermediate image .",
    "we note that result obtained using this method is generally not the same as the nlm in ; e.g. , see figures 1 - 3 in @xcite for a comparison of the two approaches .",
    "moreover , different results are obtained by interchanging the order of row and column operations . while we do not report it here",
    ", the denoising performances turn out to be similar for the different orderings ( within @xmath49 db ) , and its is often hard to visually distinguish the results .",
    "the only subtle difference that we observe is the appearance of line artefacts along horizontal and vertical directions due to the separable filtering . in this regard",
    ", we noticed that by averaging the images obtained from the row - column and the column - row operations , the final image tends to have a better visual appearance ( less line artefacts ) and a slightly higher psnr .",
    "henceforth , we will refer to the method of separately performing row - column and column - row patchlift - nlm and then averaging the results as separable nlm ( in short , s - nlm ) .",
    "l*6cr method & @xmath50 & @xmath51 & @xmath52 & @xmath53 & @xmath54 & @xmath55 + nlm & 1.2s & 6.5s & 25s & 104s & 431s & 28min + s - nlm & 20ms & 50ms & 150ms & 54ms & 3s & 19s +    [ table1 ]    note that the total complexity of s - nlm for an @xmath15 image is @xmath56 .",
    "this is a substantial reduction over the @xmath14 complexity of nlm . in table",
    "[ table1 ] , we compare the run times of s - nlm and nlm for the typical parameter setting @xmath57 and @xmath58 @xcite .",
    "we see an acceleration of at least @xmath59 for the different image sizes .",
    "l c rrrrrr    * image & * method & + * *    & nlm & 36.49 & 32.34 & 24.99 & 21.97 & 19.94 & 19.43 + & s - nlm & * 36.70 & * 32.62 & * 26.57 & * 23.47 & * 20.92 & * 20.26 + * * * * * *    & nlm & 36.98 & * 34.23 & 26.29 & 24.11 & 22.36 & 21.75 + & s - nlm & * 37.45 & 34.09 & * 28.53 & * 25.41 & * 23.12 & * 22.26 + * * * * * *    & nlm & * 36.62 & * 32.42 & 24.91 & 22.61 & 21.35 & 20.86 + & s - nlm & 36.20 & 31.88 & * 25.26 & * 22.77 & * 21.48 & * 20.95 + * * * * * *    & nlm & 36.86 & 33.22 & 27.39 & 25.21 & 23.62 & 23.08 + & s - nlm & * 37.15 & * 33.47 & * 28.12 & * 25.75 & * 23.88 & * 23.14 + * * * * * *",
    "l c rrrrrr    & & + & nlm & 93.64 & 88.96 & 75.57 & * 67.51 & * 58.50 & * 54.79 + & s - nlm & * 94.54 & * 90.25 & * 77.63 & 67.39 & 55.06 & 49.53 + * * * * * *    & nlm & 90.57 & 86.96 & 77.08 & * 69.59 & * 62.31 & * 58.31 + & s - nlm & * 92.62 & * 87.76 & * 78.30 & 68.71 & 57.39 & 50.45 + * * * * * *    & nlm & 94.75 & 90.01 & * 71.30 & * 60.69 & * 52.66 & * 49.18 + & s - nlm & * 95.01 & * 90.31 & 70.86 & 57.86 & 47.77 & 42.80 + * * * * * *    & nlm & 91.72 & 86.87 & * 76.42 & * 70.81 & * 64.60 & * 61.43 + & s - nlm & * 93.04 & * 88.01 & 76.29 & 67.83 & 57.17 & 51.58 + * * * * * *    [ table2 ]    we next compare the denoising performance of s - nlm and nlm for various test images with additive white gaussian noise .",
    "the psnrs and structural similarity indices ( ssim ) @xcite obtained using nlm and s - nlm at different noise levels are reported in table [ table2 ] .",
    "we see that the denoising performances are close in terms of these indices .",
    "interestingly , the psnrs obtained using s - nlm is higher most for most of the cases .",
    "however , due to the presence of line artefacts , the ssim of nlm is often slightly higher than that of s - nlm .",
    "we have evidence to believe that a small uniform blur at the end of the processing can diffuse the lines arising from the separable processing .",
    "a full - blown discussion of this point is , however , beyond the scope of the paper and will be followed up elsewhere .",
    "we note that the results in table [ table2 ] are consistent with the results in @xcite where it was shown that the denoising performance of the separable extensions of the bilateral and nlm filter are close to their original counterparts .",
    "however , we note that the separable nlm in @xcite is different from the one proposed here in that a spatial filter and bilateral weights ( corresponding to @xmath60 in ) are used in @xcite .",
    "of course , the key difference here is that we use patchlift to accelerate the one - dimensional nlms .",
    "we presented a separable extension of the original non - local means filter of buades et al .",
    "@xcite and showed that its denoising performance is close to that of @xcite while being @xmath59 faster .",
    "the proposed algorithm has a straightforward extension to video and volume data processing .",
    "we note that the bilateral filter is a special case of the non - local means corresponding to @xmath60 .",
    "while the complexity of our algorithm for @xmath60 continues to be @xmath20 , one can further reduce the complexity to @xmath61 using approximations @xcite .",
    "this leads to the question as to whether it is possible to design similar approximation - based algorithms for nlm of complexity @xmath62 or even @xmath61 ? one could then use large search windows , possibly the while image @xcite .    before concluding , we briefly discuss how patchlift can be extended to @xmath63-dimensional signals and , in particular , images and volumes .",
    "suppose the signal @xmath5 is defined on the grid @xmath64 , where the coordinates of a point @xmath65 is denoted by @xmath66 .",
    "we use @xmath67 to denote the hypercube centered at the origin whose edges are of length @xmath6 . in particular , @xmath67 consists of those grid points @xmath68 for which @xmath69 for @xmath70 .",
    "a patch of size @xmath48 centred at @xmath68 is defined to the collection of signal samples @xmath71 .",
    "based on this notation , the squared distance between two patches of size @xmath48 centered at @xmath68 and @xmath72 is @xmath73 the complexity of computing @xmath74 is @xmath75 , which is proportional to the number of points in @xmath67 . as in the one - dimensional case ,",
    "we construct a tensor @xmath32 on @xmath76 given by @xmath77 , and let @xmath78 this again just are moving sums over the sub - diagonals of the tensor .",
    "let @xmath79 denote the vector whose components are @xmath80 or @xmath81 .",
    "then it can be verified that @xmath82 this is essentially because the non - overlapping regions between the shifted hypercubes have @xmath83 points .",
    "thus , given @xmath84 , we can compute @xmath85 using @xmath86 additions .",
    "we skip the details , but it is not hard to see that patchlift allows us to reduce the complexity of nlm in @xmath63-dimensions from @xmath87 to @xmath88 .",
    "it is also clear that we only need to store @xmath89 elements of @xmath32 and @xmath37 out of the total of @xmath90 elements to compute the patch distances . to fully optimize the implementation",
    ", one needs to efficiently store and manipulate the sparse tensors @xmath32 and @xmath37 .",
    "the details of such a scheme would be presented in a future work .",
    "z. wang , a. c. bovik , h. r. sheikh , e. p. simoncelli , `` image quality assessment : from error visibility to structural similarity , '' ieee transactions on image processing , vol .",
    "600 - 612 , 2004 .                    p. coupe , s. prima , p. hellier , c. kervrann , and c. barillot , `` an optimized blockwise nonlocal means denoising filter for 3-d magnetic resonance images , '' eee transactions on medical imaging , vol .",
    "425 - 441 , 2008 .",
    "j. darbon , a. cunha , t. f. chan , s. osher , and g. j. jensen , `` fast nonlocal filtering applied to electron cryomicroscopy , '' proc .",
    "ieee international symposium on biomedical imaging ( isbi ) , pp .",
    "1331 - 1334 , 2008 .",
    "e. j. candes , t. strohmer , and v. voroninski , `` phaselift : exact and stable signal recovery from magnitude measurements via convex programming , '' communications on pure and applied mathematics , vol .",
    "66 , no . 8 , pp .",
    "1241 - 1274 , 2013 ."
  ],
  "abstract_text": [
    "<S> in this paper , we propose a fast algorithm called patchlift for computing distances between patches extracted from a one - dimensional signal . </S>",
    "<S> patchlift is based on the observation that the patch distances can be expressed in terms of simple moving sums of an image , which is derived from the one - dimensional signal via lifting . </S>",
    "<S> we apply patchlift to develop a separable extension of the classical non - local means ( nlm ) algorithm which is at least @xmath0 faster than nlm for standard parameter settings . </S>",
    "<S> the psnr obtained using the proposed extension is typically close to ( and often larger than ) the psnrs obtained using the original nlm . </S>",
    "<S> we provide some simulations results to demonstrate the acceleration achieved using separability and patchlift .    </S>",
    "<S> image denoising , patch - based algorithms , non - local means , patch distance , fast algorithm , separable transform , lifting , moving sum , recursion . </S>"
  ]
}