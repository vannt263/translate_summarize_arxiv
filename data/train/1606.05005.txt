{
  "article_text": [
    "given a dynamical system on a manifold with first integrals , it is important for a numerical integrator to preserve the manifold structure and the first integrals of the equations of motion .",
    "this has been the focus of much effort in the development of numerical integration schemes @xcite . in this paper",
    "we do not propose any specific numerical integration scheme , but rather propose a new paradigm of integration that can faithfully preserve conserved quantities with existing numerical integration schemes .",
    "the main idea in our paradigm is as follows .",
    "consider a dynamical system on a manifold @xmath0 with first integrals @xmath1 , @xmath2 .",
    "assume that we can embed the manifold @xmath0 into euclidean space @xmath3 and extend the first integrals to a neighborhood @xmath4 of @xmath0 in @xmath3 .",
    "for an arbitrary point @xmath5 , consider the set @xmath6 which is the intersection of @xmath0 with all the level sets of the first integrals containing the point @xmath7 , and is an invariant set of the dynamical system .",
    "we then extend the dynamical system from @xmath0 to @xmath4 and then modify the dynamics outside of @xmath8 such that the set @xmath8 becomes a unique local attractor of the extended , modified system .",
    "since the dynamics have not changed on @xmath8 by the extension and modification to @xmath4 , both the original system on @xmath0 and the extended , modified system on @xmath4 produce the same trajectory for the initial point @xmath9 .",
    "numerically , however , integrating the extended system has the following advantage : if the trajectory deviates from @xmath8 at some numerical integration step , then it will get pushed back toward the attractor @xmath8 in the extended , modified dynamics , thus remaining on the manifold @xmath0 and preserving all the first integrals .",
    "it can be rigorously shown that the discrete - time dynamical system derived from any one - step numerical integrator with uniform step size @xmath10 for the extended , modified continuous - time system indeed has an attractor @xmath11 that contains the set @xmath8 in its interior and converges to @xmath8 as @xmath12 . in this paper",
    "we shall use the word , _ preserve _ , in this sense .",
    "it is noteworthy that the numerical integration of the extended dynamics can be carried out with any ordinary integrator and is done in one global cartesian coordinate system on @xmath3 .",
    "we find conditions for applicability of this method and implement the result on the following three examples : the free rigid body dynamics , the kepler problem , and a perturbed kepler problem with rotational symmetry .",
    "we also carry out simulation studies to show the excellence of our new paradigm of integration for numerical preservation of conserved quantities in comparison with other well - known integration schemes , such as projection and splitting methods and symplectic strmer - verlet integrators .",
    "consider a dynamical system on an open subset @xmath4 of @xmath3 : @xmath13 where @xmath14 is a @xmath15 vector field on @xmath4 .",
    "let us make the following assumptions :    * there is a @xmath16 function @xmath17 such that @xmath18 for all @xmath19 , @xmath20 , and @xmath21 for all @xmath22 .",
    "* there is a positive number @xmath23 such that @xmath24)$ ] is a compact subset of @xmath4 . *",
    "the set of all critical points of @xmath25 in @xmath24)$ ] is equal to @xmath26 .    adding the negative gradient of @xmath25 to ( [ our : dyn : sys ] ) ,",
    "let us consider the following dynamical system on @xmath4 : @xmath27 since @xmath28 is the minimum value of @xmath25 , @xmath29 for all @xmath30 .",
    "hence , the two vector fields @xmath14 and @xmath31 coincide on @xmath26 .    [ theorem : general ] under assumptions a1  a3 , every trajectory of ( [ our : new : dyn : sys ] ) starting from a point in @xmath24)$ ] stays in @xmath24)$ ] for all @xmath32 and asymptotically converges to the set @xmath26 as @xmath33 .",
    "furthermore , @xmath26 is an invariant set of both ( [ our : dyn : sys ] ) and ( [ our : new : dyn : sys ] ) .",
    "let @xmath34 be a trajectory of ( [ our : new : dyn : sys ] ) starting from a point in @xmath24)$ ] .",
    "by a1 @xmath35 for all @xmath36 .",
    "hence , @xmath24)$ ] is a positively invariant set of ( [ our : new : dyn : sys ] ) .",
    "from ( [ v : dot ] ) and a3 , it follows that @xmath37 ) \\mid \\dot v ( x ) = 0\\ } = \\{x \\in v^{-1}([0,c ] ) \\mid \\nabla v(x ) = 0\\}=   v^{-1}(0)$ ] . hence , by lasalle s invariance principle @xcite , @xmath34 converges asymptotically to @xmath26 as @xmath33 , where a2 is used for compactness of @xmath24)$ ] .",
    "the invariance of @xmath26 follows from ( [ vdot : x ] ) and the coincidence of ( [ our : dyn : sys ] ) and ( [ our : new : dyn : sys ] ) on @xmath26 .",
    "let us find a higher - order condition than that in assumption a3 so that a3 can be relaxed .",
    "for the function @xmath25 and the vector field @xmath14 in the statement of assumption a1 , which are now both assumed to be of @xmath38 , let @xmath39 where @xmath40 , and @xmath41 denotes the @xmath42th order directional derivative of @xmath43 along @xmath14 , i.e. , @xmath44 consider the following assumption in place of a3 :    * @xmath45 ) \\subset v^{-1}(0)$ ] .",
    "the following theorem generalizes theorem [ theorem : general ] :    [ theorem : general : more ] under assumptions a1 , a2 and a3@xmath46 , every trajectory of ( [ our : new : dyn : sys ] ) starting in @xmath24)$ ] stays in @xmath24)$ ] for all @xmath32 and asymptotically converges to the set @xmath26 as @xmath33 .",
    "furthermore , @xmath26 is an invariant set of both ( [ our : dyn : sys ] ) and ( [ our : new : dyn : sys ] ) .",
    "consider the dynamics ( [ our : new : dyn : sys ] ) .",
    "it is easy to show that @xmath24)$ ] is a positively invariant set of the dynamics .",
    "let @xmath47 be the largest invariant set in @xmath48)$ ] .",
    "let @xmath34 be an arbitrary trajectory in @xmath47 .",
    "since @xmath49)$ ] as shown in the proof of theorem [ theorem : general ] , the trajectory @xmath34 satisfies @xmath50 , i.e. , @xmath51 for all @xmath52 and @xmath53 . since @xmath50 along @xmath34 , the trajectory @xmath34 satisfies @xmath54 for all @xmath52 . by differentiating ( [ dvdxi ] )",
    "repeatedly in @xmath55 and using ( [ reduced : x ] ) on each differentiation , we can show that the trajectory @xmath34 satisfies @xmath56 for all @xmath57 , @xmath58 and @xmath53 .",
    "thus , the entire trajectory @xmath34 is contained in the set @xmath59 defined in ( [ def : set : s ] ) , implying @xmath60 , from which and a3@xmath46 it follows @xmath61 .",
    "hence , by lasalle s invariance principle , every trajectory starting in @xmath24)$ ] asymptotically converges to @xmath47 and thus to @xmath26 as @xmath33 .",
    "the invariance of @xmath26 follows from ( [ vdot : x ] ) and the coincidence of ( [ our : dyn : sys ] ) and ( [ our : new : dyn : sys ] ) on @xmath26 .",
    "if condition ( [ vdot : x ] ) is replaced by @xmath62 in assumption a1 , then theorems [ theorem : general ] and [ theorem : general : more ] still hold provided that the invariance of @xmath26 is replaced by positive invariance in the statement of the theorems .",
    "2.theorems [ theorem : general ] and [ theorem : general : more ] still hold with the use of the following modified dynamics @xmath63 instead of ( [ our : new : dyn : sys ] ) , where @xmath64 is an @xmath65 matrix - valued function with its symmetric part @xmath66 positive definite at each @xmath67 .",
    "\\3 . from the control viewpoint , the added term @xmath68 in ( [ our : new : dyn : sys ] ) can be regarded as a negative feedback control @xmath69 to asymptotically stabilize the set @xmath26 for the control system @xmath70 with control @xmath71 .",
    "suppose that assumptions a1 , a2 and a3 ( or a3@xmath46 instead of a3 ) hold and that we want to integrate the dynamics ( [ our : dyn : sys ] ) for an initial point @xmath72 .",
    "since @xmath26 is positively invariant , the trajectory must remain in @xmath26 for all @xmath32 .",
    "recall that the two dynamics ( [ our : dyn : sys ] ) and ( [ our : new : dyn : sys ] ) coincide on @xmath26 , so we can integrate ( [ our : new : dyn : sys ] ) instead of ( [ our : dyn : sys ] ) for the initial condition . though there is no theoretical difference between the two integrations , integrating ( [ our : new : dyn : sys ] ) has a numerical advantage over integrating ( [ our : dyn : sys ] ) .",
    "suppose that the trajectory numerically deviates from the positively invariant set @xmath26 during integration .",
    "then the dynamics ( [ our : new : dyn : sys ] ) will push the trajectory back toward @xmath26 since @xmath26 is the attractor of ( [ our : new : dyn : sys ] ) in @xmath24)$ ] whereas the dynamics ( [ our : dyn : sys ] ) will leave the trajectory outside of @xmath26 which would not happen in the exact solution . it is noteworthy that this integration strategy is independent of the choice of integration schemes . in the appendix we show that any one - step numerical integrator , as a discrete - time dynamical system , with uniform step size @xmath10 for ( [ our : new : dyn : sys ] ) has an attractor @xmath11 that contains @xmath26 in its interior and converges to @xmath26 as @xmath73 .",
    "let us now apply this integration strategy to numerically integrate dynamics on a manifold while preserving its first integrals and the domain manifold .",
    "consider a manifold @xmath0 and dynamics @xmath74 on @xmath0 that have @xmath75 first integrals @xmath76 , @xmath2 .",
    "suppose that @xmath0 is an embedded manifold in @xmath3 as a level set of a function @xmath77 for some @xmath78 , and that both the dynamics ( [ dyn : on : m ] ) and the functions @xmath79 , @xmath80 extend to an open neighborhood @xmath4 of @xmath0 in @xmath3 .",
    "our goal is to numerically integrate ( [ dyn : on : m ] ) with an initial condition @xmath81 while preserving the manifold @xmath0 and the first integrals .",
    "let @xmath82 and define a function @xmath83 by @xmath84 where @xmath85 is an @xmath86 constant symmetric positive definite matrix .",
    "notice that @xmath87 and that @xmath26 is invariant under the flow of ( [ dyn : on : m ] ) . or , more generally we can define a function @xmath88 as @xmath89 where @xmath90 is a non - negative function that takes the value of @xmath28 only at @xmath91 . if the function @xmath25 satisfies assumptions a1 , a2 and a3 ( or a3@xmath46 instead of a3 ) , then by theorem [ theorem : general ] ( or theorem [ theorem : general : more ] ) , @xmath26 is the local attractor of the modified dynamics @xmath92 that coincide with the original dynamics ( [ dyn : on :",
    "m ] ) on @xmath26 .",
    "the following lemma provides a sufficient condition under which the function @xmath25 defined in ( [ def : v : intro ] ) satisfies assumptions a2 and a3 :    [ kuhl : lemma ] consider the functions @xmath93 and @xmath25 defined in ( [ def : f ] ) and ( [ def : v : intro ] ) .",
    "if @xmath26 is compact and the jacobian matrix @xmath94 of @xmath93 has rank @xmath95 for all @xmath96 , then there is a number @xmath97 such that assumptions a2 and a3 hold .    by compactness of @xmath26 and the regularity of @xmath98",
    ", there is a bounded open set @xmath14 such that @xmath99 , and @xmath98(x ) has rank @xmath100 for all @xmath101 , where @xmath102 denotes the closure of @xmath14 .",
    "consider now the gradient of @xmath25 .",
    "an easy calculation shows that , @xmath103 now , since for all @xmath104 , @xmath94 is onto as a linear map , @xmath105 is therefore one to one .",
    "it follows that , for @xmath104 , @xmath106 in other words , the set of all critical points of @xmath25 in @xmath14 is equal to @xmath26 . since the boundary @xmath107 of @xmath14 , being closed and bounded ,",
    "is compact and @xmath108 , the minimum value , denoted by @xmath109 , of @xmath25 on @xmath107 is positive .",
    "if necessary , restrict the function @xmath25 to @xmath14 , replacing its original domain @xmath4 with @xmath14 .",
    "then , there is a positive number @xmath23 less than @xmath109 such that @xmath110 ) \\subset x$ ] .",
    "therefore , assumption a3 holds for this number @xmath23 . since the closed set @xmath24)$ ] is contained in the bounded set @xmath14 , it is compact , which implies that assumption a2 holds .",
    "[ kuhl : theorem ] for the functions @xmath93 and @xmath25 defined in ( [ def : f ] ) and ( [ def : v : intro ] ) , if @xmath25 satisfies ( [ vdot : x ] ) for all @xmath19 , the set @xmath26 is compact and the jacobian matrix @xmath94 is onto for all @xmath96 , then there is a number @xmath97 such that every trajectory starting in @xmath24)$ ] remains in @xmath24)$ ] for all @xmath32 and asymptotically converges to @xmath26 as @xmath111 .    for the functions @xmath93 and",
    "@xmath25 defined in ( [ def : f ] ) and ( [ def : v : intro ] ) , if @xmath25 satisfies ( [ vdot : x ] ) for all @xmath19 , the set @xmath26 is compact and there is an open subset @xmath14 of @xmath4 containing @xmath26 such that the jacobian matrix @xmath94 is onto for all @xmath112 , then there is a number @xmath97 such that every trajectory starting in @xmath24)$ ] remains in @xmath24)$ ] for all @xmath32 and asymptotically converges to @xmath26 as @xmath111 .",
    "modify the proof of lemma  [ kuhl : lemma ] appropriately .    as discussed above",
    ", we can integrate ( [ dyn : on : m : ext ] ) instead of ( [ dyn : on : m ] ) for the initial condition @xmath113 , which will yield a trajectory that is expected to numerically well remain on the manifold @xmath0 and preserve the values of the first integrals @xmath79 , @xmath2 .",
    "it is noteworthy that the integration is carried out in one cartesian coordinate system on @xmath3 rather than over local charts on the manifold @xmath0 which would take additional computational costs for coordinate changes between local charts . in the following section",
    ", we will apply this strategy to the free rigid body dynamics , the kepler problem and a perturbed kepler problem with rotational symmetry to integrate the dynamics preserving their first integrals and domain manifolds .",
    "consider the free rigid body dynamics :    [ rigidbody ] @xmath114    where @xmath115 ; @xmath116 is the moment of inertia matrix ; and @xmath117 for @xmath118 since @xmath119 , from here on we assume that the rigid body dynamics are defined on the euclidean space @xmath120 and that the matrix @xmath121 denotes a @xmath122 matrix , not necessarily in @xmath123 .",
    "this is the _ extension _ of the dynamics step .",
    "define two functions @xmath124 and @xmath125 by @xmath126 where @xmath127 represents the kinetic energy of the free rigid body and @xmath128 the spatial angular momentum vector when @xmath129 .",
    "these quantities are first integrals of ( [ rigidbody ] )",
    ". choose any @xmath130 and let @xmath131 define an open set @xmath4 by @xmath132 and a function @xmath133 by @xmath134 for @xmath135 , where @xmath136 , @xmath137 are constants , and @xmath138 is the 2-norm defined by @xmath139 for a matrix @xmath140 .",
    "observe that we are endowing the space @xmath141 with the standard inner product , and that the trace norm is precisely the norm induced on @xmath142 by this inner product .",
    "we compute all gradients that follow with respect to this inner product .",
    "notice that @xmath143    [ lemma : gradient ] the gradient @xmath144 of the function @xmath25 ( [ def : v : rigid ] ) is given by    [ gradequations ] @xmath145    straightforward .",
    "the following lemma shows that the function @xmath25 satisfies assumption a1 stated in ",
    "[ section : theory ] .",
    "[ lemma:1:rigid ] the function @xmath25 satisfies @xmath146    one can compute @xmath147 where , in the third equality we use the fact that for @xmath140 symmetric and @xmath148 antisymmetric , @xmath149",
    ".    next , we compute , @xmath150 hence , @xmath151    the following lemma shows that the function @xmath25 satisfies assumptions a2 and a3 stated in ",
    "[ section : theory ] .",
    "[ lemma:2:rigid ] there is a number @xmath23 satisfying @xmath152 such that @xmath24)$ ] is a compact subset of @xmath4 and the set of all critical points of @xmath25 in @xmath24)$ ] is equal to @xmath26 .",
    "it is obvious that there is a number @xmath23 satisfying ( [ inequality : c ] ) such that @xmath24)$ ] becomes a compact set in @xmath4 .",
    "for such a number @xmath23 , the matrix @xmath121 is invertible for every @xmath153)$ ] .",
    "since @xmath28 is the minimum value of @xmath25 , every point in @xmath26 is a critical point of @xmath25 .",
    "let @xmath154 be a critical point of @xmath25 in @xmath24 ) \\backslash v^{-1}(0)$ ] . by lemma [ lemma : gradient ]",
    "it satisfies    [ critical ] @xmath155    where @xmath156 post - multiplying ( [ critical:1a ] ) by @xmath157 and pre - multiplying ( [ critical:1b ] ) by @xmath121 yield    [ critical2 ] @xmath158    since @xmath159 .",
    "notice that @xmath160 would imply @xmath161 , contradicting @xmath153)$ ] .",
    "hence , @xmath162 .",
    "it follows from ( [ critical ] ) that if any of the three equations @xmath163 holds , then the three of them all hold .",
    "thus @xmath164 since @xmath165 .",
    "since the matrix @xmath166 in ( [ critical:1a ] ) has rank 1 and the matrix @xmath167 is symmetric , there exist a unit vector @xmath168 and a number @xmath169 such that @xmath170 substitution of ( [ rtr_i ] ) into ( [ critical:1a ] ) and ( [ critical:2a ] ) yields @xmath171 which implies @xmath172 where the symbol @xmath173 means ` is parallel to . '",
    "hence , we can express @xmath121 and @xmath128 as @xmath174 for some numbers @xmath175 , @xmath176 and vectors @xmath177 , where @xmath178 and the vectors @xmath179 and @xmath180 can be any vectors such that @xmath181 becomes an orthonormal basis for @xmath182",
    ". substitution of ( [ r_split ] ) into ( [ rtr_i ] ) implies that @xmath183 is an orthonormal basis for @xmath182 .",
    "substitution of ( [ r_split ] ) and ( [ pi_b_pi0 ] ) into ( [ critical:1b ] ) implies @xmath184 , which together with @xmath185 in ( [ parallel_rels ] ) , implies @xmath186 , i.e. , @xmath71 is an eigenvector of @xmath116 .",
    "we can now choose or re - define the unit vectors @xmath179 and @xmath180 such that they become eigenvectors of the symmetric matrix @xmath116 , too .",
    "in the orthonormal basis @xmath181 , we can now write the moment of inertia matrix @xmath116 as @xmath187 where @xmath188 are the eigenvalues of @xmath116 , which are all positive , corresponding to the eigenvectors @xmath189 , respectively . it is then easy to see that equations ( [ critical2 ] ) imply    [ abequations ] @xmath190    where we have used @xmath191 .",
    "we consider the following two separate cases : @xmath192 and @xmath193 .",
    "suppose @xmath192 .",
    "if @xmath194 , then @xmath195 by ( [ inequality : c ] ) , which contradicts @xmath153)$ ] . hence , @xmath196 . if @xmath197 , then equation ( [ abequations : a ] ) implies @xmath198 , but equation ( [ abequations : b ] ) implies @xmath199 , implying @xmath200 .",
    "this can not be compatible with @xmath197 .",
    "hence , @xmath197 is ruled out .",
    "similarly , @xmath201 can be ruled out .",
    "hence , @xmath202 , which implies @xmath203 contradicting ( [ contra : eqn ] ) .",
    "thus , when @xmath192 , there are no critical points of @xmath25 in @xmath24)\\backslash v^{-1}(0)$ ] .",
    "suppose @xmath204 .",
    "we analyze equations ( [ abequations ] ) using a continuity argument . at @xmath205 , ( [ abequations :",
    "a ] ) implies @xmath206 or @xmath207 , neither of which satisfies ( [ abequations : b ] ) at @xmath205 .",
    "thus , by continuity there exists a number @xmath208 with @xmath209 such that for any @xmath210 with @xmath211 there is no number @xmath212 satisfying both ( [ abequations : a ] ) and ( [ abequations : b ] ) .",
    "hence , @xmath213 .",
    "we now shrink the number @xmath23 such that it not only satisfies ( [ inequality : c ] ) but also @xmath214 .",
    "for such a number @xmath23 , we have @xmath215 which contradicts @xmath153)$ ] .",
    "hence , when @xmath216 , there are no critical points of @xmath25 in @xmath24)\\backslash v^{-1}(0)$ ] for some @xmath97",
    ".    therefore , there exists a number @xmath97 such that @xmath26 is the set of all critical points of @xmath25 in @xmath24)$ ] .",
    "consider the dynamics    [ rigid : modified ] @xmath217    which correspond to ( [ our : new : dyn : sys ] ) . from theorem [ theorem : general ] and lemmas",
    "[ lemma:1:rigid ] and [ lemma:2:rigid ] comes the following theorem :    there is a number @xmath97 such that every trajectory of ( [ rigid : modified ] ) starting from a point in @xmath24)$ ] stays in @xmath24)$ ] for all @xmath32 and asymptotically converges to the set @xmath218 as @xmath33 , where the function @xmath25 is defined in ( [ def : v : rigid ] ) .",
    "furthermore , @xmath26 is an invariant set of both ( [ rigidbody ] ) and ( [ rigid : modified ] ) .",
    "the two - body dynamics in the kepler problem are given in the usual barycentric coordinates by    [ kepler ] @xmath219    where @xmath220 is the position vector , @xmath221 is the velocity vector and @xmath222 is the gravitational parameter .",
    "define two functions @xmath223 and @xmath224 by @xmath225 where @xmath226 is called the angular momentum vector and @xmath140 is called the laplace - runge - lenz vector .",
    "it is known that both @xmath226 and @xmath140 are first integrals of the two - body dynamics ( [ kepler ] ) and they are orthogonal to each other , i.e. , @xmath227 for all @xmath228 .",
    "the energy function @xmath229 satisfies latexmath:[\\[\\label{relation }    @xmath228 , implying that the energy @xmath127 is also a first integral of the two - body dynamics ( [ kepler ] ) .",
    "it is also known that a non - degenerate elliptic keplerian orbit is uniquely determined by a pair @xmath231 that satisfies @xmath232 , @xmath233 and @xmath234 @xcite .    fix a non - degenerate elliptic keplerian orbit , i.e. , a pair of vectors @xmath235 that satisfies @xmath236 define a function @xmath237 by @xmath238 for @xmath228 , where @xmath239 and @xmath240 .",
    "notice that @xmath241 which is the non - degenerate keplerian elliptic orbit whose angular momentum vector and laplace - runge - lenz vector are @xmath242 and @xmath243 , respectively .",
    "[ lemma : gradient : kepler ] the gradient @xmath244 of the function @xmath25 defined in ( [ def : v : kepler ] ) is given by @xmath245 where @xmath246 and @xmath247 .",
    "the following lemma shows that the function @xmath25 defined in ( [ def : v : kepler ] ) satisfies assumptions a1 and a2 stated in ",
    "[ section : theory ] .",
    "[ shortlemma : kepler ] 1 .",
    "the function @xmath25 satisfies @xmath248 2 . for any number",
    "@xmath23 satisfying @xmath249 the set @xmath250)$ ] is a compact set in @xmath251 .",
    "the first fact is a straightforward calculation using the previous lemma . for the second",
    ", the essential idea is that the fibers of @xmath25 are homeomorphic to circles , corresponding to the elliptic orbits , and are therefore compact .",
    "for a detailed proof of the second statement , refer to corollary 2.2 in @xcite .",
    "the following lemma shows that the function @xmath25 defined in ( [ def : v : kepler ] ) satisfies assumption a3 stated in ",
    "[ section : theory ] .",
    "[ longlemma : kepler ] for any number @xmath23 satisfying ( [ range : c : kepler ] ) the set of all critical points of @xmath25 in @xmath24)$ ] is equal to @xmath26 .",
    "choose an arbitrary number @xmath23 satisfying ( [ range : c : kepler ] ) .",
    "let @xmath252 be an arbitrary critical point of @xmath25 in @xmath24)$ ] .",
    "for notational convenience , let us write @xmath253 suppressing the dependence on @xmath252 .",
    "by lemma [ lemma : gradient : kepler ] , the critical point @xmath252 satisfies    [ dv : zero ] @xmath254    if @xmath255 , then @xmath256 , contradicting @xmath257)$ ] .",
    "hence , @xmath233 , which together with ( [ def : l ] ) implies that the three vectors @xmath258 form a basis for @xmath182 .",
    "the dot product of ( [ dvv : zero ] ) with @xmath259 yields @xmath260 so there are numbers @xmath210 and @xmath212 such that @xmath261 substitution of ( [ da : xl ] ) into ( [ dv : zero ] ) gives @xmath262",
    "it follows that there are numbers @xmath109 and @xmath93 such that    [ dl : vlx ] @xmath263    from ( [ dl : vlx ] ) , we obtain @xmath264 by linear independence of @xmath265 , @xmath266 substitution of these into ( [ da : xl ] ) and ( [ dl : vlx:2 ] ) gives @xmath267 where we have used the definition of @xmath140 given in ( [ def : a ] ) . hence , @xmath268",
    "from ( [ a0:l0:linear : combo ] ) and the orthogonality @xmath269 and @xmath270 , it follows that @xmath271 since @xmath233 , and recalling that @xmath272 and @xmath273 , we have @xmath274 .",
    "substitution of @xmath274 into ( [ a0:l0:linear : combo ] ) yields @xmath275 which implies @xmath276 .",
    "thus , every critical point of @xmath25 in @xmath24)$ ] is contained in @xmath26 .    since 0",
    "is the minimum value of @xmath25 , every point in @xmath26 is a critical point of @xmath25 .",
    "therefore , the set of all critical points of @xmath25 in @xmath24)$ ] is @xmath26 .",
    "choose a non - degenerate keplerian elliptic orbit and let @xmath277 be a point on the orbit .",
    "set @xmath278 to be the angular momentum vector and the laplace - runge - lenz vector of the orbit , respectively .",
    "consider the dynamics :    [ kepler : modified ] @xmath279    where @xmath246 and @xmath247 , which correspond to ( [ our : new : dyn : sys ] ) . from theorem [ theorem : general ] and lemmas [ shortlemma : kepler ] and [ longlemma : kepler ]",
    "comes the following theorem :    for any @xmath97 satisfying ( [ range : c : kepler ] ) , every trajectory of ( [ kepler : modified ] ) starting from a point in @xmath24)$ ] stays in @xmath24)$ ] for all @xmath32 and asymptotically converges to the set @xmath280 as @xmath33 , where the function @xmath25 is defined in ( [ def : v : kepler ] ) .",
    "furthermore , @xmath26 is an invariant set of both ( [ kepler ] ) and ( [ kepler : modified ] ) .",
    "consider a perturbed kepler problem with rotational symmetry whose equations of motion are given by    [ pert : kepler ] @xmath281    where @xmath220 is the position vector , @xmath221 is the velocity vector , and @xmath282 is the potential function that depends only on the radial distance from the origin .",
    "the total energy @xmath283 and the angular momentum vector @xmath284 are defined by @xmath285 and they are conserved quantities of the dynamics ( [ pert : kepler ] ) .",
    "take any point @xmath286 such that @xmath287 let @xmath288 define a function @xmath289 by @xmath290 with @xmath239 and @xmath240 .",
    "then , @xmath291 the gradient @xmath292 of @xmath25 is given by @xmath293 where @xmath294 and @xmath246 .",
    "trivially , @xmath25 satisfies ( [ vdot : x ] ) , i.e. @xmath295 for all @xmath296 .",
    "the modified dynamics , which correspond to ( [ our : new : dyn : sys ] ) , are computed as    [ pert : kepler : mod ] @xmath297    [ theorem : main : pert : kep ] suppose that @xmath26 is compact and there is no common solution @xmath298 to the following two equations : latexmath:[\\[\\begin{aligned } e_0 & = \\frac{1}{2}ru^\\prime(r ) + u(r ) , \\label{e0:cond : pert}\\\\    assumptions a2 and a3 hold and there is a number @xmath97 such that every trajectory of ( [ pert : kepler : mod ] ) starting in @xmath24)$ ] remains in @xmath24)$ ] for all @xmath32 and asymptotically converges to @xmath26 as @xmath111 .",
    "define a function @xmath300 by @xmath301 then , @xmath302 where the over - hat symbol @xmath303 denotes the hat map defined in ( [ def : hat : map ] ) .",
    "we want to show that the @xmath304 matrix @xmath305 is one - to - one for all @xmath276 .",
    "fix an arbitrary point @xmath276 .",
    "it follows @xmath306 take any point @xmath307 from the kernel of @xmath305 .",
    "then ,    [ dft : ker ] @xmath308    suppose @xmath309 .",
    "taking the inner product of ( [ dft : ker : a ] ) with @xmath259 and of ( [ dft : ker : b ] ) with @xmath310 , we obtain @xmath311 from which it follows that latexmath:[\\[\\label{uprime : v2 }    with @xmath259 , we get @xmath313 which implies @xmath314 that satisfies both ( [ e0:eqn : up ] ) and ( [ l0:norm : eqn ] ) .",
    "hence , we can not have @xmath309 .",
    "substitute @xmath315 into ( [ dft : ker ] ) .",
    "it follows that @xmath316 is parallel to @xmath317 .",
    "hence , there is a number @xmath212 such that @xmath318 . substituting this in ( [ dft : ker : b ] )",
    "yields @xmath319 .",
    "taking the cross product of this with @xmath259 yields @xmath320 since @xmath321 . since @xmath322 and @xmath323",
    ", we have @xmath274 , so @xmath324 .",
    "it follows that @xmath325 , which implies that @xmath305 is one - to - one for all @xmath276 . in other words",
    ", @xmath326 is onto for all @xmath276 .",
    "hence , the conclusion of the theorem follows from lemma [ kuhl : lemma ] , equation ( [ pert : vx0 ] ) , and theorem [ kuhl : theorem ] .",
    "consider a special case in which the potential function @xmath327 is of the form @xmath328 where @xmath329 and @xmath330 .",
    "then equations ( [ e0:cond : pert ] ) and ( [ l0:cond : pert ] ) become @xmath331 and @xmath242 , it is then easy to check if there is no common solution @xmath298 to ( [ e0:birk ] ) and ( [ l0:birk ] ) .",
    "consider the free rigid body dynamics in  [ subsection : rigid : body ] with the moment of inertia matrix @xmath332 and the initial condition @xmath333 the values of the energy @xmath127 and the spatial angular momentum vector @xmath334 corresponding to the initial condition are @xmath335 the period @xmath336 of the trajectory of the body angular velocity vector @xmath337 is computed approximately to be @xmath338 .",
    "we integrate the dynamics over the time interval @xmath339 = [ 0 , 155.7t_\\omega]$ ] with step size @xmath340 , using the following four integration methods : a feedback integrator with the euler scheme , a projection method with the euler scheme , a splitting method with three rotations splitting , and the ordinary euler method .",
    "the feedback integrator with the euler scheme denotes the euler method applied to the modified free rigid dynamics ( [ rigid : modified ] ) with the following values of the parameters @xmath341 , @xmath342 , and @xmath343 @xmath344 the projection method is the standard one explained on pp.110111 in @xcite . in order to solve constraint equations for projection at each step of integration in the projection method",
    ", we use the matlab command _ fsolve _ with the parameter _ tolfun _ , which is termination tolerance on the function value , set equal to @xmath345 , which is the same as the integration step size @xmath346 .",
    "the splitting method is the one explained on pp.284285 in @xcite .",
    "the three of the projection method , the splitting method and the ordinary euler method are applied to the original free rigid body dynamics ( [ rigidbody ] ) .",
    "the trajectories of the body angular velocity vector @xmath347 , the energy error @xmath348 , the error @xmath349 in spatial angular momentum , and the deviation @xmath350 of the rotation matrix @xmath351 from @xmath123 are plotted in figures [ figure : rigid : omega ] , [ figure : rigid : energy ] , [ figure : rigid : momentum ] and [ figure : rigid : so3 ] , respectively . in figure",
    "[ figure : rigid : omega ] , it is observed that the trajectories of @xmath347 generated by the feedback integrator and the projection method maintain a periodic shape well whereas those by the splitting method and the euler method drift away significantly from the periodic shape . in figure",
    "[ figure : rigid : energy ] , it is observed that the feedback integrator and the projection method keep the energy error sufficiently small whereas the energy errors by the other two methods increase in time . although the two trajectories of energy error by the splitting method and the euler method seem to coincide in figure [ figure : rigid : energy ] , an examination of the numerical data shows that the energy of the euler method gets larger than that of the splitting method in time .",
    "for example , at @xmath352 , the energy of the euler method is bigger than that of the splitting method by @xmath353 . in figures [ figure : rigid : momentum ] and [ figure : rigid : so3 ] , it is observed that the feedback method preserves the spatial angular momentum vector and the manifold @xmath123 sufficiently well . in terms of computation time ,",
    "the projection method takes much more time than the others , which is due to the steps of solving the constraint equations for projection .",
    "the splitting method is symplectic and of order 2 whereas the other methods are of order 1 .",
    "all of these observations lead us to the conclusion that the feedback integrator overall has produced the best outcome in the simulation of the free rigid body dynamics .",
    "consider the kepler problem in ",
    "[ subsection : two : body ] with @xmath354 and the initial condition @xmath355 the corresponding initial values of the angular momentum vector and the laplace - runge - lenz vector are @xmath356 the period @xmath357 and the eccentricity @xmath358 of the kepler orbit containing the initial point are @xmath359 we integrate the kepler dynamics over the time interval @xmath360 $ ] with step size @xmath361 , using the following four integration methods : a feedback integrator with the euler scheme , the standard projection method with the euler scheme , and two strmer - verlet schemes .",
    "the feedback integrator with the euler scheme denotes the euler method applied to ( [ kepler : modified ] ) with @xmath362 and @xmath363 .",
    "the standard projection method is explained on pp.110111 in @xcite . to solve the constraint equations for projection",
    ", we use the matlab command _ fsolve _ with the parameter _ tolfun",
    "_ set equal to @xmath364 , which is the same as the integration step size @xmath346 .",
    "the two strmer - verlet schemes are those in ( 3.4 ) and ( 3.5 ) on pp .",
    "189190 in @xcite , and we call them strmer - verlet - a and strmer - verlet - b , respectively , for convenience .",
    "the strmer - verlet schemes are symplectic methods of order 2 .",
    "the trajectories of the planar orbit @xmath365 , the error of the laplace - runge - lenz vector , @xmath366 , and the error of the angular momentum vector , @xmath367 , are plotted in figures [ figure : kepellipse ] , [ figure : kepa ] and [ figure : kepl ] . in figure",
    "[ figure : kepellipse ] it is observed that the planar trajectories @xmath365 generated by the feedback integrator and the projection method maintain the elliptic shape well whereas those by the strmer - verlet schemes precess .",
    "this can be also verified in figure [ figure : kepa ] , where the feedback integrator and the projection method preserve the laplace - runge - lenz vector well , but the strmer - verlet schemes cause the laplace - runge - lenz vector to noticeably precess . in figure",
    "[ figure : kepl ] , it is observed that the strmer - verlet schemes preserve the angular momentum vector exceptionally well in comparison with the other two methods . in figures",
    "[ figure : kepa ] and [ figure : kepl ] , we can see that the precision of the feedback integrator is comparable with that of the projection method .",
    "however , the feedback integrator takes much less computation time than the projection method .",
    "the feedback integrator and the projection method used here are of order 1 , whereas the strmer - verlet schemes are of order 2 .",
    "all of these observations lead us to conclude that the feedback integrator has produced the best result overall .",
    "consider the perturbed kepler problem in ",
    "[ subsection : pert : kepler ] with the potential function @xmath4 given in ( [ pert : kep : pot ] ) with @xmath354 and @xmath368 , which is the one used in example 4.3 on p. 111 in @xcite .",
    "we use the initial conditions @xmath369 with eccentricity @xmath370 as in @xcite .",
    "the corresponding values of the energy and the angular momentum vector are @xmath371 we integrate the perturbed kepler dynamics over the time interval @xmath372 $ ] with step size @xmath373 , just as on p. 111 in @xcite , using the following four integration methods : a feedback integrator with the euler scheme , the standard projection method with the euler scheme , the strmer - verlet scheme in ( 3.4 ) on p. 189 in @xcite , and the matlab command , _",
    "ode45_. the feedback integrator with the euler scheme denotes the euler method applied to ( [ pert : kepler : mod ] ) with @xmath374 and @xmath375 , and it is straightforward to verify that the hypotheses in theorem [ theorem : main : pert : kep ] hold true .",
    "the other three methods are applied to ( [ pert : kepler ] ) . the matlab command _ fsolve _",
    "is used in the projection method with the parameter _ tolfun _ set equal to @xmath376 .",
    "the options of _ reltol _ = _ abstol _",
    "= @xmath377 are used for the matlab integrator , _ ode45 _ , so the result generated by _",
    "ode45 _ can be used as a reference .",
    "the trajectories of the planar orbit @xmath365 , the energy error @xmath378 and the error @xmath379 in angular momentum are plotted in figures [ figure : pertkepellipse ] , [ figure : pertkepenergy ] and [ figure : pertkepl ] . in figure",
    "[ figure : pertkepellipse ] it is observed that the orbits generated by the feedback integrator and the strmer - verlet scheme are similar to that by _",
    "ode45 _ , but the orbit by the projection method precesses too much which is a very poor result .",
    "the projection method excels only at preserving the energy and the angular momentum as expected in view of the nature of the projection method and the small tolerance parameter value , _ tolfun _",
    "= @xmath376 , used for the matlab command , _",
    "fsolve_. in figure [ figure : pertkepenergy ] , it is observed that the feedback integrator is comparable with the strmer - verlet scheme in energy conservation .",
    "the feedback integrator also preserves the angular momentum well in view of the step size @xmath373 , as can be seen in figure [ figure : pertkepl ] .",
    "the feedback integrator and the projection method used here are of order 1 whereas the strmer - verlet scheme is of order 2 . from all of these observations",
    ", we conclude that the feedback integrator has produced the best result overall .",
    "we have developed a theory to produce numerical trajectories of a dynamical system on a manifold that stably remain on the manifold and preserve first integrals of the system .",
    "our theory is not a numerical integration scheme but rather a modification of the original dynamics by feedback .",
    "the actual numerical integration in our framework can be done with any usual integrator such as euler and runge - kutta .",
    "our method is successfully applied to the free rigid body , the kepler problem and a perturbed kepler problem with rotational symmetry , and its excellent performance is demonstrated by simulation studies in comparison with the standard projection method , two strmer - verlet schemes and a splitting method via three rotations splitting .    as future work",
    ", we plan to apply our theory to various mechanical systems with symmetry and non - holonomic systems .",
    "we also plan to carry out a quantitative study of the effect of the parameters in the lyapunov function on the performance of our method .",
    "we show , using results in @xcite , that any discrete - time dynamical system derived from a one - step numerical integration scheme with uniform step size @xmath10 for the modified dynamical system ( [ our : new : dyn : sys ] ) has an attractor @xmath11 that contains @xmath26 in its interior and converges to @xmath26 as @xmath73 .",
    "let us first review some definitions from @xcite .",
    "let @xmath140 and @xmath148 be nonempty , compact subsets of @xmath3 and @xmath259 a point in @xmath3 .",
    "the distance between @xmath259 and @xmath140 is defined by @xmath380 the hausdorff separation of @xmath140 from @xmath148 is defined by @xmath381 the hausdorff distance between @xmath140 and @xmath148 is defined by @xmath382 the hausdorff distance is a metric on the space of nonempty compact subsets of @xmath3 . for @xmath298 ,",
    "let @xmath383 denote an @xmath78-neighborhood of @xmath140 .",
    "we say that a nonempty , compact subset @xmath8 of @xmath3 is uniformly stable for an autonomous dynamical system if for each @xmath384 there exists a @xmath385 such that @xmath386 \\rightarrow x(t;x_0 ) \\in s(\\lambda , \\epsilon),\\ ] ] where @xmath387 is the solution of the given dynamical system with initial condition @xmath388 .",
    "a set @xmath8 is said to be positively invariant for an autonomous dynamical system if @xmath389 for all @xmath9 and @xmath390 .",
    "a nonempty , compact subset @xmath8 of @xmath3 is called uniformly asymptotically stable for an autonomous dynamical system if it is positively invariant and uniformly stable for the dynamical system , and additionally satisfies the following property : there is a @xmath391 and for each @xmath392 a time @xmath393 such that @xmath394 \\rightarrow x(t;x_0 ) \\in s(\\lambda , \\epsilon).\\ ] ]    [ lemma : uas : lambda ] suppose that assumptions a1 , a2 and a3 ( or a3@xmath46 instead of a3 ) stated in  [ section : theory ] hold true .",
    "then , the set @xmath26 is uniformly asymptotically stable for the modified dynamical system ( [ our : new : dyn : sys ] ) .    since the three assumptions are satisfied , the conclusions of theorem [ theorem : general ] ( or , [ theorem : general : more ] )",
    "hold true . for convenience ,",
    "let @xmath395 , which is invariant under ( [ our : new : dyn : sys ] ) by theorem [ theorem : general ] ( or , [ theorem : general : more ] ) .",
    "let @xmath97 be the number @xmath23 in assumption a2 . using compactness of @xmath24)$ ] and continuity of @xmath25 , it is easy to show that for any @xmath392 there is a @xmath396 such that @xmath397 ) \\subset s(\\lambda , \\epsilon)$ ] .",
    "it is also easy to show that for any @xmath196 there is an @xmath398 such that @xmath399)$ ] .",
    "hence , we can use the family of sets @xmath400 ) , b>0\\}$ ] instead of the family of open sets @xmath401 to show uniform stability and uniform asymptotic stability of @xmath8 for ( [ our : new : dyn : sys ] ) .",
    "let us first show uniform stability of @xmath8 for ( [ our : new : dyn : sys ] ) . given any @xmath392 , take any @xmath208 such that @xmath402 .",
    "then , for any @xmath403)$ ] , @xmath404 ) \\subset v^{-1}([0,\\epsilon])$ ] for all @xmath390 since @xmath25 is decreasing along the trajectory of @xmath387 of ( [ our : new : dyn : sys ] ) . hence , @xmath8 is uniformly stable for ( [ our : new : dyn : sys ] ) .",
    "let us now show uniform asymptotic stability of @xmath8 for ( [ our : new : dyn : sys ] ) .",
    "take any @xmath405 such that @xmath406 . by continuous dependence of @xmath387 on initial point @xmath7 , compactness of @xmath407)$ ] ,",
    "continuity of the function @xmath25 , and the property that @xmath408 decreases to 0 as @xmath111 for any @xmath409)$ ] , it is easy to show that for any @xmath392 there is a time @xmath393 such that for any @xmath410)$ ] we have @xmath411)$ ] for all @xmath412 .",
    "hence , @xmath8 is uniformly asymptotically stable for ( [ our : new : dyn : sys ] ) .",
    "suppose the vector field @xmath14 is @xmath413 and the function @xmath25 is @xmath414 in the modified dynamical system ( [ our : new : dyn : sys ] ) .",
    "consider a discrete analogue of ( [ our : new : dyn : sys ] ) described by any one - step numerical method of @xmath415th order @xmath416 with uniform step size @xmath417 , where @xmath418 for each @xmath10 .",
    "suppose that the vector field @xmath14 is @xmath413 and the function @xmath25 is @xmath414 , and that assumptions a1 , a2 and a3 ( or a3@xmath46 instead of a3 ) are satisfied .",
    "then there is a number @xmath419 such that for each @xmath420 the discrete - time dynamical system ( [ discrete : system ] ) has a compact , uniformly asymptotically stable set @xmath11 which contains @xmath26 in its interior and converges to @xmath26 with respect to the hausdorff metric as @xmath73 .",
    "moreover , there is a bounded , open set @xmath421 , which is independent of @xmath10 and contains @xmath11 , and a time @xmath422 where @xmath140 and @xmath148 are constants depending on the stability characteristic of @xmath26 , such that the iterates of ( [ discrete : system ] ) satisfy @xmath423 for all @xmath424 , @xmath425 and @xmath426 .",
    "we have only to show that the hypotheses in theorem 1.1 of @xcite hold . since @xmath14 is @xmath413 and @xmath25 is @xmath414 , the vector field @xmath427 of ( [ our : new : dyn : sys ] ) and its derivatives of order up to @xmath415 are all continuous and bounded on the compact set @xmath24)$ ] .",
    "the set @xmath26 is uniformly asymptotically stable for ( [ our : new : dyn : sys ] ) by lemma [ lemma : uas : lambda ] in the above .",
    "therefore , the conclusions of this theorem follow from theorem 1.1 and lemma 3.3 of @xcite .",
    "refer to @xcite to see how to obtain the set @xmath421 and values of the parameters @xmath428 , @xmath140 and @xmath148 that appear in the statement of the above theorem .",
    "the above theorem extends to multi - step numerical integrators ; refer to @xcite for detail .",
    "this research was supported in part by dgist research and development program ( cps global center ) funded by the ministry of science , ict & future planning , global research laboratory program ( 2013k1a1a2a02078326 ) through nrf , and institute for information & communications technology promotion ( iitp ) grant funded by the korean government ( msip ) ( no .",
    "b0101 - 15 - 0557 , resilient cyber - physical systems research ) ."
  ],
  "abstract_text": [
    "<S> a new method is proposed to numerically integrate a dynamical system on a manifold such that the trajectory stably remains on the manifold and preserves first integrals of the system . </S>",
    "<S> the idea is that given an initial point in the manifold we extend the dynamics from the manifold to its ambient euclidean space and then modify the dynamics outside the intersection of the manifold and the level sets of the first integrals containing the initial point such that the intersection becomes a unique local attractor of the resultant dynamics . </S>",
    "<S> while the modified dynamics theoretically produces the same trajectory as the original dynamics , it yields a numerical trajectory that stably remains on the manifold and preserves the first integrals . </S>",
    "<S> the big merit of our method is that the modified dynamics can be integrated with any ordinary numerical integrator such as euler or runge - kutta . </S>",
    "<S> we illustrate this method by applying it to three famous problems : the free rigid body , the kepler problem and a perturbed kepler problem with rotational symmetry . </S>",
    "<S> we also carry out simulation studies to demonstrate the excellence of our method and make comparisons with the standard projection method , a splitting method and strmer - verlet schemes . </S>"
  ]
}