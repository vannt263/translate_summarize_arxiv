{
  "article_text": [
    "a square in the two - dimensional grid indexed by integers @xmath1 has color @xmath2 if @xmath3 .",
    "two squares in the @xmath7 lattice are _ adjacent _ if they share an edge . a _ ribbon tile _ of order @xmath0 is a connected set of squares containing exactly one square of each color .",
    "( see figure [ bigtiling ] . ) a ribbon tile can also be defined as a connected sequence of @xmath0 squares , each of which comes directly above or to the right of its predecessor .",
    "a _ region _",
    "@xmath4 is any connected , finite subset of the squares of @xmath7 .",
    "two order-@xmath0 ribbon tilings of @xmath4 are connected by a _ local replacement move _ ( or simply a _ local move _ ) if one can be obtained from the other by removing a single pair of ribbon tiles and adding another pair in its place .",
    "labeled ribbon tilings of young tableaux ( also called _ rim hook tableaux _ ) have connections with symmetric function theory , symmetric group representations , and monochromatic increasing subsequences in colored permutations .",
    "( see @xcite , @xcite , @xcite , @xcite , and @xcite . )",
    "pak was the first to consider ribbon tilings of more general regions @xcite .",
    "a ribbon tile of order @xmath0 has one of @xmath8 possible shapes .",
    "( see figure [ tetrominos ] . )",
    "if @xmath9 represents one of the @xmath8 shapes of a ribbon tile of size @xmath0 and @xmath10 is an order-@xmath0 ribbon tiling of a simply connected region , we denote by @xmath11 the number of tiles in @xmath10 of shape @xmath9 .    in @xcite",
    ", pak coined the term _ tile invariant _ to describe linear combinations of the @xmath11 whose values were the same for all tilings @xmath10 of a region @xmath4 .",
    "pak showed that if it were proved that any two order-@xmath0 ribbon tilings of a region @xmath4 could be connected by a sequence of local replacement moves , then certain tile invariants of @xmath4 could be deduced as a trivial consequence @xcite .",
    "pak used a version of the _ schensted algorithm for rim hook tableaux_a correspondence between rim hook tableau and @xmath0-tuples of smaller tableaux ( known by nakayama and robinson @xcite @xcite , rediscovered by stanton and white @xcite)to prove that any two order-@xmath0 ribbon tilings of a young diagram could be connected by a sequence of local moves , and that his tile invariants must therefore hold for young - tableau - shaped regions .",
    "pak used other techniques to extend the tile invariants to row - convex regions and conjectured that both local move connectedness and ( consequently ) the tile invariants could be extended to arbitrary simply connected regions .    without proving local move connectedness , muchnik and pak @xcite and moore and pak @xcite extended pak s tile invariant results to ( respectively ) order-@xmath12 and order-@xmath0 ribbon tilings of general simply connected regions .",
    "moore and pak @xcite reiterated pak s conjecture about local move connectedness for general simply connected regions and cited private communication from thurston suggesting that the conjecture might be proved if one could find a correspondence between ribbon tilings and so - called _ height functions _ mapping the vertices of @xmath4 to @xmath13 . using thurston s suggestion and a connection with acyclic orientations , we prove the conjecture .    [ connectedness ] any two order-@xmath0 ribbon tilings of a simply connected region @xmath4 can be connected by a sequence of local replacement moves .    here , we say @xmath4 is _ simply connected _",
    "if @xmath14 implies that there is no connected cycle of squares in @xmath4 that encircles @xmath15 with a non - zero winding number ; unless otherwise specified , we will always assume @xmath4 is simply connected .",
    "our main ribbon tiling result relates the order-@xmath0 ribbon tilings of a given region @xmath4 to the acyclic orientations extending a certain partial orientation of a graph @xmath16 .",
    "pak s original paper @xcite on ribbon tilings used a related construction ( based on earlier results in @xcite , @xcite , and @xcite ) to prove local replacement move connectedness for ribbon tilings of young - tableaux .",
    "we will not use the results of these papers in our presentation .    before we can state the main theorem , we need to define several terms .",
    "the first is a  left of \" relation , denoted @xmath17 , defined for both tiles and squares . in our pictures , we generally rotate the set of tiles forty - five degrees so that @xmath18 increases as we move upwards .",
    "( see figure [ bigtiling ] . )",
    "let @xmath19 be the square at position @xmath1 .",
    "we say @xmath19 is _ directly left _ of @xmath20 if @xmath21 and @xmath22 .",
    "we say @xmath19 is _ indirectly left _ of @xmath20 if @xmath23 and @xmath24 and @xmath25 .",
    "( equivalently , @xmath19 is indirectly left of @xmath20 if it is directly left of one of the four neighbors of @xmath20 . )",
    "if @xmath19 is directly or indirectly left of @xmath20 , we write @xmath26 .",
    "if @xmath27 is a tile and @xmath15 is a square , we write @xmath28 if @xmath29 for some @xmath30 , and @xmath31 if @xmath32 for some @xmath30 . if @xmath33 and @xmath34 are two tiles in @xmath10 , we write @xmath35 if there exist @xmath36 and @xmath37 with @xmath38 .",
    "it is easy to verify that if @xmath33 and @xmath34 are disjoint ribbon tiles , we can not have both @xmath39 and @xmath40 .",
    "we will also say a square @xmath19 is _ higher _ ( _ lower _ ) than @xmath20 if @xmath41 ( @xmath42 ) .",
    "we say @xmath18 is a square of _ level _",
    "@xmath2 if @xmath43 and a tile @xmath27 has _ level _",
    "@xmath2 if @xmath2 is the level of its lowest square .",
    "( a square s color is equal to its level modulo @xmath0 . )",
    "an edge has _",
    "@xmath44 if it separates squares of color @xmath45 and @xmath46 , and a tile has _",
    "@xmath44 if its lowest and highest squares have color @xmath46 and @xmath45 respectively ( when defining types , we always add modulo @xmath0 )",
    ". also , @xmath47 and @xmath48 are _ comparable _ by @xmath17 if either @xmath49 or @xmath50 .",
    "given a tiling @xmath10 , we define @xmath51 to be the @xmath45th tile in @xmath10 , from left to right , of level @xmath2 ( when such a tile exists ) .",
    "clearly @xmath52 whenever these two tiles are defined .",
    "let @xmath53 be the _ boundary _ of @xmath4 , that is , the set of squares that are not contained in @xmath4 but are adjacent to at least one square in @xmath4 .",
    "we define the oriented graph @xmath54 to be the graph whose vertices are the tiles in @xmath10 and the boundary squares of @xmath4 .",
    "two such vertices @xmath47 and @xmath48 are adjacent if they are comparable under @xmath17 , and we say this edge is _ oriented _ from @xmath47 to @xmath48 if @xmath49 .",
    "some aspects of @xmath54 are independent of @xmath10 ; using height functions , we will prove the following result :    [ samegstructure ] any two tilings @xmath10 and @xmath55 of @xmath4 necessarily contain the same number of tiles of each level .",
    "thus , @xmath51 is defined if and only if @xmath56 is defined . furthermore , if @xmath57 , then @xmath58 if and only if @xmath59 . also , if @xmath60 , then @xmath61 if and only if @xmath62 .",
    "similarly , @xmath63 if and only if @xmath64 .    in other words , the map sending @xmath51 into @xmath56 is a canonical bijection between the tiles of @xmath10 and those of @xmath55 , and this bijection preserves the relation @xmath17 between tiles of the same type and between tiles and boundary squares .",
    "we define a tiling - independent partially oriented graph @xmath16 as follows : all boundary squares in @xmath53 are vertices of @xmath16 and we include a vertex called @xmath65 in @xmath16 if the tile @xmath51 is defined for some tiling @xmath10 ( and hence all such tilings ) of @xmath4 . an edge is contained in @xmath16 if and only if the corresponding edge is included in @xmath54 for some tiling @xmath10 ( and hence all such tilings ) .",
    "( thus , @xmath65 and @xmath66 are adjacent in @xmath16 if and only if @xmath67 ; @xmath65 and @xmath19 are adjacent in @xmath16 if and only if @xmath68 ; and @xmath19 and @xmath20 are adjacent in @xmath16 if and only @xmath69 . )    given a tiling @xmath10 , we can now think of @xmath54 as an _ orientation _ on the graph @xmath16 ( i.e. , a way of assigning a direction to each edge of @xmath16 ) in the obvious way : that is , an edge @xmath70 is oriented from @xmath65 to @xmath66 in @xmath54 if and only if @xmath71 .",
    "we define the orientation similarly for edges involving two boundary squares or one tile and one boundary square .",
    "an edge involving two tiles of different types ( i.e. , some @xmath65 and @xmath66 with @xmath72 ) is called a _ free edge _ of @xmath16 .",
    "all other edges are called _ forced _ edges of @xmath16 .",
    "by lemma [ samegstructure ] , a forced edge @xmath73 will be oriented in the same direction as @xmath54 for every tiling @xmath10 .",
    "thus , we can think of @xmath16 as being endowed with a partial orientation : its forced edges are all oriented .",
    "we say @xmath54 _ extends _ this partial orientation by assigning an orientation to each free edge of @xmath16 .",
    "two orientations differ by an _ edge reversal _ if they agree on all but exactly one edge .",
    "the following is our main structure theorem about the set of order-@xmath0 ribbon tilings of @xmath4 .",
    "[ thecorrespondence ] if @xmath4 admits at least one order-@xmath0 ribbon tiling , then there is a one - to - one correspondence between the order-@xmath0 ribbon tilings of @xmath4 and the acyclic orientations extending the partial orientation of @xmath16 .",
    "furthermore , local replacement moves in the space of tilings correspond to edge reversals in the space of orientations .",
    "to be precise , we make four assertions :    1 .   for every order-@xmath0 ribbon tiling @xmath10 of @xmath4",
    ", @xmath54 is an acyclic orientation extending the partial orientation of @xmath16 .",
    "if @xmath10 and @xmath55 are order-@xmath0 ribbon tilings then @xmath74 if and only if @xmath75 .",
    "every acyclic orientation @xmath76 of @xmath16 that extends the partial orientation of @xmath16 is equal to @xmath54 for some tiling @xmath10 .",
    "two order-@xmath0 ribbon tilings @xmath10 and @xmath55 differ by a local replacement move if and only if @xmath54 and @xmath77 differ by an edge reversal .    given theorem [ thecorrespondence ]",
    ", we will now deduce the connectedness of ribbon tilings under local replacement moves by citing a corresponding result about acyclic orientations .",
    "define the distance @xmath78 between orientations @xmath76 and @xmath79 of a graph @xmath80 to be the number of edges on which they differ .",
    "then it is well known that @xmath76 can be transformed into @xmath79 with @xmath78 edge reversals in such a way that each intermediate step is also an acyclic orientation .",
    "( see @xcite for a more general result . ) clearly , each intermediate step agrees with @xmath76 and @xmath79 on all edges on which @xmath76 and @xmath79 agree .",
    "it follows that if @xmath10 and @xmath55 are tilings , then the intermediate steps of a length @xmath81 path of acyclic orientations connecting @xmath54 and @xmath77 must all be extensions of the partial orientation of @xmath16 .",
    "thus , each of these corresponds to an order-@xmath0 ribbon tiling of @xmath4 . assuming theorem [ thecorrespondence ] , we have proved theorem [ connectedness ] .",
    "see @xcite , @xcite , @xcite and the references therein for more about the structure of the space of acyclic orientations .",
    "we will also derive , as another consequence of theorem [ thecorrespondence ] , an existence algorithm .",
    "[ thealgorithm ] there is a linear - time ( i.e. , linear in the number of squares of @xmath4 ) algorithm for determining whether there exists an order-@xmath0 ribbon tiling of @xmath4 and producing such a tiling when one exists .",
    "we begin in section [ conwaysection ] by reviewing the height function theory of conway - lagarias and thurston and showing that it leads naturally to a construction of abelian height functions for a variety of tiling problems . in section [ ribbonsection ] , we apply this theory specifically to the ribbon tiling problem and prove our three main results : lemma [ samegstructure ] , theorem [ thecorrespondence ] , and theorem [ thealgorithm ] . in section [ generalsection ]",
    "we discuss generalizations of our abelian height function constructions to tilings that do not appear to have the same acyclic orientation characterization that ribbon tilings have .",
    "finally , in section [ opensection ] we present a number of open problems in the theory of ribbon tilings and general abelian height functions .",
    "our height function construction for ribbon tilings makes use of a general technique developed by conway and lagarias @xcite and thurston @xcite for analyzing tiling problems .",
    "polyomino _ is a finite , connected subset of the squares of @xmath7 whose complement is also connected . for simplicity",
    ", we will review the theory only for _ polyomino tilings _ , although similar techniques apply if one replaces the squares of the grid with the faces of any planar graph ( e.g. , the hexagonal lattice ) .",
    "( more general expositions  which invoke the language of cayley complex homology  can be found in @xcite , @xcite , and @xcite . )",
    "a _ tile set _",
    "@xmath82 is a ( usually infinite ) set of finite , simply - connected subsets of the squares of @xmath7 .",
    "usually , we assume @xmath82 is translation invariant ( i.e. , @xmath83 implies that @xmath84 for all @xmath85 ) but this need not be the case . the first step in the conway - lagarias construction is to choose a map @xmath86 from the oriented edges of the plane into a group @xmath80 in such a way that @xmath87 for all oriented edges @xmath47 ; here @xmath88 is the same edge as @xmath47 with opposite orientation , and ( since we will eventually restrict our attention to abelian groups ) we write the group operation additively .",
    "we also require that the sum of @xmath89 over the clockwise - oriented edges @xmath90 on the boundary of any tile in @xmath82 ( added in clockwise order ) be equal to the identity in @xmath80 .",
    "these requirements are called _",
    "tile relations_. once the group is chosen , given any tiling @xmath10 , we can construct a _ height function _",
    "@xmath91 mapping at least some of the vertices of @xmath4 into @xmath80 as follows .",
    "first , choose a reference vertex @xmath92 on the boundary of @xmath4 and require that @xmath93 be the identity",
    ". then if @xmath94 is any other vertex of @xmath4 that is on the boundary of a tile , @xmath95 is the ordered product of the oriented edges along a path from @xmath92 to @xmath94 that does not cross any tiles .",
    "( if the tiles are simply connected , such a path will always exist . ) using the tile relations , it is not hard to prove that the value @xmath95 is independent of the path chosen .",
    "we can also always assume that the group @xmath80 is generated by the values of @xmath89 where @xmath90 is an edge in the @xmath7 lattice .",
    "( otherwise , replace @xmath80 by the subgroup generated by these values . )",
    "one can obtain the largest possible group @xmath80 that is generated by @xmath89 as follows : let @xmath80 be the group generated by the oriented edges of @xmath7 modulo the relations @xmath96 for clockwise sums of clockwise - oriented boundary edges of a tile and @xmath97 for all @xmath90 .",
    "then let @xmath89 be the image of the edge @xmath90 in the group @xmath80 .",
    "the height function constructed in this way is in a sense `` maximally informative '' since any other height function is a quotient of this one .",
    "unfortunately , this group is unwieldy in practice and can be difficult to analyze . on the other hand , if one merely seeks the maximally informative _",
    "abelian _ group , the analysis becomes much simpler .",
    "suppose @xmath80 is an additive abelian group and @xmath86 is a map from the oriented edges of @xmath7 to @xmath80 .",
    "if @xmath27 is any polyomino tile in @xmath7 , we denote by @xmath98 the sum of the clockwise - oriented edges of @xmath27 .",
    "observe that @xmath99 where the sum is over squares @xmath15 that are contained in the tile @xmath27 .    now",
    ", suppose that @xmath100 is a non - self - intersecting path of vertices in @xmath4 connecting the reference vertex @xmath92 to a vertex @xmath101 on the boundary of some tile in @xmath10 .",
    "we say that @xmath102 _ crosses _ a tile @xmath27 in @xmath10 if for some @xmath103 , the edge @xmath104 lies between two squares in @xmath27 .",
    "if @xmath15 is a square in @xmath4 and @xmath105 , we say @xmath102 _ passes @xmath15 on the left between vertices @xmath45 and @xmath106 _ if :    1 .   the vertices @xmath107 and @xmath108 are on the boundary of a tile @xmath27 and all edges between @xmath107 and @xmath108 on @xmath102 are interior edges of the tile @xmath27 .",
    "the square @xmath15 is contained in the polygon formed by the edges in @xmath102 between @xmath107 and @xmath108 together with the counter - clockwise half of the boundary of @xmath27 connecting @xmath107 to @xmath108 .",
    "note that a long path could pass a square @xmath15 on the left several times if @xmath15 belongs to a tile that the path crosses several times .",
    "we define @xmath109 and observe the following :    the height function value at @xmath101 can be written as @xmath110 where the latter sum is over all squares ( counted with multiplicity ) that @xmath102 passes on the left .",
    "to see this , let @xmath111 be a path from @xmath92 to @xmath101 that is the same as @xmath102 except that each interval that crosses a tile @xmath27 is replaced by the path around the boundary of @xmath27 on the left side of @xmath102 .",
    "the reader may easily check that @xmath112 is equal to the sum of @xmath113 over all squares ( counted with multiplicity ) that @xmath102 passes on the left . by definition , @xmath114 , so the proposition follows .    since @xmath115 is independent of the particular tiling @xmath10 ,",
    "we have a simple interpretation of the height function @xmath95 : it tells us the sum of @xmath113 over the squares @xmath15 passed on the left by a path from @xmath92 to @xmath94 . for our height function to be maximally informative , @xmath80 must be ( or at least contain ) the abelian group generated by @xmath113 subject to only the tiling relations .",
    "we refer to this group as the _ canonical abelian height space _ ( also known as the _ color group _ ) of a set of tiles @xmath82 .",
    "we say two squares @xmath116 and @xmath117 have the same _ color _ if it can be deduced from the tiling relations that @xmath118 .",
    "( in other words , @xmath119 is zero in the group generated by the squares of @xmath7 modulo the relations @xmath120 for all @xmath83 . )",
    "this notion is best illustrated using our primary example : ribbon tiling .",
    "let @xmath19 denote the square at position @xmath1 in the lattice , and consider two overlapping horizontal ribbon tiles of length @xmath0 , one of which has leftmost square @xmath19 and the other @xmath121 .",
    "the corresponding tile relations tell us that @xmath122 and @xmath123 . and",
    "this implies that @xmath124 .",
    "thus , @xmath19 and @xmath125 have the same color .    repeating similar arguments with other pairs of ribbon tiles that overlap on all but one square",
    ", one can deduce that squares at @xmath126 and @xmath127 necessarily have the same color whenever @xmath128 and @xmath129 are equivalent modulo @xmath0 .",
    "denote by @xmath130 the value of @xmath131 when @xmath132 .",
    "then the relation @xmath133 is enough to guarantee that @xmath134 for any ribbon tile @xmath27 of length @xmath0 .",
    "thus , if @xmath80 is the abelian group generated by @xmath135 subject to this one relation , @xmath80 is maximally informative .    at this point , we know the value of @xmath136 for every square @xmath15 .",
    "however , we still have to choose a function @xmath86 on the edges of the @xmath7 lattice in such a way that @xmath113 has the desired values .",
    "this is essentially a linear algebra problem , and it is not hard to see that it always has at least one solution .",
    "( we return to this issue in the next section . )",
    "this `` maximally informative '' abelian height function construction is unique up to two obvious transformations .",
    "first , change of basis : one can replace @xmath80 with any group @xmath137 and the @xmath130 with any elements of @xmath137 satisfying the necessary relations .",
    "second , translation by a tiling - independent function : one can add to @xmath89 any function @xmath138 satisfying @xmath139 for all @xmath15 .",
    "this amounts to adding a function ( independently of @xmath10 ) to each height function @xmath91 .    in particular applications ,",
    "we try to choose the basis for @xmath80 and the values of @xmath86 on the edges in @xmath7 in a way that makes the tiling space easy to understand",
    ". in particular , if @xmath82 is translation invariant , it is usually convenient for @xmath86 to have some translational symmetries as well .",
    "although we determined in the last section that @xmath140 when @xmath15 is a square of color @xmath45 , we have considerable freedom in choosing the values of @xmath86 on the edges in @xmath7 .",
    "we will use this freedom to force @xmath86 to have certain symmetries .",
    "first , we would like @xmath86 to be invariant under color - preserving translations of @xmath7 ; this amounts to the requirement that @xmath89 be the same whenever @xmath90 is a vertical ( or similarly , horizontal ) edge of type @xmath44 oriented with color @xmath46 on the left .",
    "we would also like @xmath86 at such an edge to have the same value  call it @xmath141independently of whether the edge is horizontal or vertical .",
    "let @xmath142 be basis elements of a height space @xmath143 .",
    "summing around a square of color @xmath45 tells us that @xmath130 must be equal to @xmath144 .",
    "since this clearly implies @xmath145 , we need not add any additional relations to @xmath80 .",
    "( although the canonical abelian height function space is the subgroup of @xmath80 generated by the values @xmath146 , it will be notationally convenient to define @xmath86 and our height functions in this larger group . )",
    "we can now describe our height function @xmath91 for a tiling @xmath10 with the following rules :    1 .",
    "let @xmath147 for all tilings @xmath10 of @xmath4 , where @xmath92 is a reference vertex on the boundary of @xmath4 .",
    "2 .   when moving from one vertex to a neighbor along an edge separating @xmath45 and @xmath46 color squares with color @xmath46 on the left , the height changes by @xmath141 if no tile of @xmath10 is crossed .",
    "3 .   when moving from one vertex to a neighbor along an edge separating @xmath45 and @xmath46 color squares with color @xmath46 on the left , the height changes by @xmath148 if the edge crosses a tile in @xmath10 of type @xmath149 .",
    "we write @xmath150 to mean the @xmath141 component of the height function @xmath91 .",
    "of course , there is some redundancy in using an @xmath0 dimensional height space instead of the canonical @xmath151 dimensional height space ; as currently defined , @xmath152 is a function that does not depend on the tiling @xmath10 . in particular ,",
    "if @xmath153 , the projection sending @xmath154 to the integer @xmath155 transforms our two - dimensional @xmath91 into the standard one - dimensional domino - tiling height function without any loss of information .",
    "we can understand what the height function means by looking at its behavior along diagonals .",
    "we say @xmath102 is an _",
    "@xmath44 diagonal _ if :    1 .",
    "the path @xmath156 is a connected left - to - right path made solely of edges of type @xmath44 that are incident to squares in @xmath4 .",
    "both @xmath92 and @xmath101 are on the boundary of @xmath4 and the extending edges @xmath157 and @xmath158 of type @xmath44 are _ not _ incident to squares in @xmath4 .",
    "note that as one moves from left to right along an @xmath44 diagonal , @xmath159 increases by two if we cross a a tile of type @xmath149 and zero otherwise .",
    "thus , in the diagonal described above , @xmath160 is equal to @xmath161 plus twice the total number of times the path @xmath162 crosses a tile of type @xmath149 . in particular , since the value of @xmath91 on the boundary of @xmath4 is independent of @xmath10 , we have the following .    [ diagonalnumberindependence ] if @xmath163 , then the total number of tiles of type @xmath149 crossed by the portion of an @xmath44 diagonal between two consecutive boundary vertices @xmath164 and @xmath165 is equal to @xmath166 . in particular , since @xmath164 and @xmath165 are boundary vertices , this number is independent of @xmath10 .    how does @xmath150 change along an @xmath44 diagonal ? we know that moving from left to right along the diagonal , it decreases by one when we cross a tile , increases by one otherwise .",
    "also , inspection shows that there can never be tiles crossing both of two adjacent edges on a diagonal .",
    "thus , as one moves along the diagonal from left to right , the value of @xmath150 alternates between sequences of decreasing steps ( of length at most one ) and sequences of increasing steps ( of length one or more ) .",
    "we say @xmath167 is a _ record vertex _",
    "if @xmath168 , and @xmath169 whenever @xmath170 . for notational convenience , we will also consider @xmath171 ( the vertex just right of the vertex @xmath101 along an edge of type @xmath44 ) to be a record vertex .",
    "( see figure [ diagonalexample ] . )",
    "since each decreasing sequence in @xmath150 along @xmath102 has length at most one , it is not hard to check that if @xmath172 , then @xmath167 is a record vertex if and only if @xmath173 .",
    "note that the first edge @xmath174 and last edge @xmath175 of a diagonal are always boundary edges of @xmath4 , and hence represent increasing steps .",
    "in particular , @xmath164 is always a record vertex .",
    "what does it mean for @xmath167 to be a record vertex ?",
    "first of all , it means that the two adjacent edges @xmath176 and @xmath177 are both _ not _ crossed by tiles ; this in turn implies that the square @xmath15 incident to both of them ( which we will call a _ record square _ ) is either a square outside of @xmath4 or a square in @xmath4 belonging to a tile of type @xmath44 .",
    "since each of the integers @xmath178 must occur as a record value exactly once , the number of record vertices on the diagonal ( not counting @xmath171 ) is equal to @xmath179 , and is hence independent of @xmath10 .",
    "now , if @xmath15 is a record square outside of @xmath4 and @xmath167 is the corresponding record vertex , the two diagonal edges preceding @xmath167 must both be boundary edges of @xmath4 ( unless one is an edge outside of @xmath4 ) ; hence , @xmath15 will be a record square for every tiling of @xmath4 . if @xmath180 , then the value @xmath181 is also independent of the tiling .",
    "whenever @xmath15 is a record square outside of @xmath4 , the corresponding record vertex is called a _",
    "boundary record vertex _ ; in particular , @xmath164 and @xmath171 are boundary record vertices .    between any two consecutive boundary record vertices @xmath167 and @xmath182 , there are exactly @xmath183 record vertices whose record squares are squares of tiles of type @xmath44 .",
    "whether the tile lies above or below the diagonal clearly depends on the parity of @xmath47 ; since @xmath184 alternates parity along the diagonal , this in turn depends on the parity of the @xmath150 at the record vertex @xmath167 .",
    "we call @xmath94 a _ lower record vertex _ if the corresponding record square lies below the diagonal and an",
    "_ upper record vertex _ if it lies above the diagonal . since for each @xmath10 , the record values @xmath178 must be attained in the same order , we have the following lemma :    [ diagonalordering ] suppose @xmath185 is the portion of a diagonal @xmath102 of type @xmath44 between two consecutive boundary record vertices @xmath167 and @xmath182 .",
    "then the number tiles of type @xmath44 with squares adjacent to @xmath185 that lie above or below the diagonal is equal to @xmath186 . in particular , this value is the same for every tiling of @xmath4 .",
    "furthermore , the order in which the entire diagonal @xmath102 encounters boundary record vertices , lower record vertices , and upper record vertices is also the same for every tiling of @xmath4 and can be determined from the value of the height function on the boundary vertices in @xmath102 .",
    "denote by @xmath187 the set of squares adjacent to @xmath102 that are either members of tiles of type @xmath44 or squares in @xmath53 .",
    "( see figure [ diagonalexample ] . )",
    "note that if @xmath116 and @xmath117 are two record squares then @xmath38 if and only if the record vertex for @xmath116 occurs before that of @xmath117 in the diagonal .",
    "thus , we can restate the previous lemma :    [ squarediagonalordering ] given any two tilings @xmath10 and @xmath188 , @xmath187 and @xmath189 contain the same number of boundary squares , squares of color @xmath45 in type @xmath44 tiles , and squares of color @xmath46 in type @xmath44 tiles .",
    "the relation @xmath17 induces a total ordering on the squares in @xmath187 as well as those in @xmath189 ; if the @xmath190th square in the ordering of @xmath187 is a boundary square ( or a square of color @xmath45 in a type @xmath44 tile , or a square of color @xmath46 in a type @xmath44 tile ) , the same is true of @xmath189 .",
    "now we are ready to prove lemma [ samegstructure ] , which we restate here for convenience .",
    "any two tilings @xmath10 and @xmath55 of @xmath4 necessarily contain the same number of tiles of each level .",
    "thus , @xmath51 is defined if and only if @xmath56 is defined . furthermore ,",
    "if @xmath57 , then @xmath191 if and only if @xmath192 . also ,",
    "if @xmath60 , then @xmath193 if and only if @xmath194 .",
    "similarly , @xmath195 if and only if @xmath196 .",
    "let @xmath197 be the tiles of type @xmath44 in @xmath10 whose lowest squares lie just above a given diagonal @xmath102 .",
    "it is obvious from the definition of @xmath51 that the ordering of these tiles with respect to each other is independent of @xmath10 .",
    "similarly , let @xmath198 be the tiles of type @xmath44 that lie just below the diagonal @xmath102 .",
    "now , let @xmath199 be the totally ordered set of _ all _ the boundary squares and all of the @xmath200 tiles that are incident to @xmath102 . since we know that the ordering restricted to the set of tiles of form @xmath51 ( or the set of tiles of form @xmath201 , or the set of boundary squares ) is independent of @xmath10 , it follows from lemma [ squarediagonalordering ] that the total ordering @xmath202 is independent of @xmath10 .    since any two tiles of the same type or any tile and any square that are comparable by @xmath17 must be incident to _ some",
    "_ common diagonal @xmath102 , lemma [ squarediagonalordering ] covers all possible cases in which the @xmath17 relation occurs between tiles of the same type or between tiles and boundary squares .",
    "the reader may recall from the introduction that we used this lemma used to define the partially oriented graph @xmath16 and to justify our interpretation of @xmath203 as an extension of the partial orientation of @xmath16 .",
    "this will be the topic of the next section .",
    "the purpose of this section is to prove theorem [ thecorrespondence ] ; we will state and prove each of its four parts as a separate lemma .    for every order-@xmath0 ribbon tiling @xmath10 of @xmath4",
    ", @xmath54 is an acyclic orientation extending the partial orientation of @xmath16 .",
    "we must show that , given a tiling @xmath10 , there exists no sequence @xmath204 where each @xmath205 is either a tile or a square in @xmath53 .    since there can clearly be no cycle containing one or two elements",
    ", we may assume @xmath206 .",
    "now , suppose a diagonal incident to both @xmath207 and @xmath208 is also incident to some @xmath205 with @xmath209 .",
    "if @xmath210 , then @xmath211 is a shorter cycle .",
    "if @xmath212 , then @xmath213 ( by transitivity , since @xmath205 , @xmath208 , and @xmath207 are on the same diagonal and hence totally ordered ) , and @xmath214 is a shorter cycle .",
    "thus , if @xmath215 is a cycle of minimal length in @xmath54 , then any infinite diagonal that is incident to both @xmath207 and @xmath208 can be incident to no other tile or square .",
    "denote by @xmath216 the infinite diagonal between square levels @xmath217 and @xmath218 and let @xmath219 and @xmath220 be the lowest and highest values of @xmath217 for which @xmath216 is incident to both @xmath207 and @xmath208 .",
    "all tiles and squares other than @xmath207 and @xmath208 must lie entirely below @xmath221 or entirely above @xmath222 . since no tile or square below @xmath221 can be comparable with any tile or square above @xmath222 , the sequence @xmath223 must lie entirely above @xmath222 or entirely below @xmath221 .",
    "suppose without loss of generality that the former is the case and that the lowest square in @xmath207 is at least as low as the lowest square in @xmath208 .",
    "then none of the elements @xmath205 below @xmath221 is comparable with @xmath208 , and this is a contradiction .",
    "if @xmath10 and @xmath55 are order-@xmath0 ribbon tilings then @xmath74 if and only if @xmath75 .",
    "obviously , the first statement implies the second . now , suppose @xmath75 .",
    "since these orientations are acyclic , there must exist at least one leftmost tile , i.e. , there exists a @xmath65 for which there exists no @xmath66 with @xmath224 or @xmath225 .",
    "it follows that @xmath51 and @xmath56 must each contain the leftmost squares in @xmath4 in the rows of level @xmath226 ; thus , their positions are determined and they are equal .",
    "similarly , we can now choose a @xmath66 that is leftmost among the remaining set of tiles , and its position is also completely determined .",
    "repeating this argument , we conclude that @xmath227 for all @xmath2 and @xmath45 for which these values are defined .",
    "[ tilingfromorientation ] every acyclic orientation @xmath76 of @xmath16 that extends the partial orientation of @xmath16 can be written as @xmath54 for some tiling @xmath10 .    in the introduction",
    ", we defined @xmath16 by assuming that @xmath4 admitted at least one tiling @xmath10 and restricting the orientation on @xmath54 to the forced edges .",
    "however , in our later existence proofs , it will be necessary to have a definition of @xmath16 and a version of lemma [ tilingfromorientation ] that do not invoke _ a priori _ knowledge of the existence of @xmath10 . to do this",
    ", we will need some definitions .",
    "we say a tile vertex @xmath65 _ crosses level @xmath228 _ if @xmath229 .",
    "( note that if @xmath10 is a tiling , then @xmath65 crosses level @xmath228 if and only if @xmath51 contains a square of level @xmath228 . )",
    "we define a partially oriented graph @xmath80 to be a _ ribbon tile graph consistent with @xmath4 _ if the following hold :    1 .",
    "the vertices of @xmath80 come from the set of tile vertices @xmath65 ( with @xmath230 and @xmath231 ) and square vertices @xmath19 ( with @xmath232 ) .",
    "2 .   two tile vertices @xmath65 and @xmath66 are adjacent if and only if @xmath67 . a tile @xmath65 and square @xmath19 are adjacent if and only if @xmath68 . two squares @xmath19 and @xmath20 are adjacent if and only if @xmath69 .",
    "the graph @xmath80 is endowed with an orientation on its _ forced _ edges ( i.e. all edges involving a square or involving two tile vertices @xmath65 and @xmath66 with @xmath233 ) .",
    "no other edges of @xmath80 are oriented .",
    "if @xmath116 and @xmath117 are square vertices , then the edge @xmath234 is oriented toward @xmath117 if and only if @xmath38 . also ,",
    "whenever @xmath235 and @xmath236 is a tile vertex , @xmath65 is also a tile vertex .",
    "an edge of the form @xmath237 is oriented toward @xmath238 whenever @xmath239 .",
    "the set of square vertices of @xmath80 is precisely the set of boundary squares of @xmath4 .",
    "the total number of tiles crossing a given level @xmath2 is precisely the number of squares in @xmath4 of level @xmath2 . 7 .   for every integer @xmath2 and every pair of boundary squares @xmath240 and @xmath241 of levels @xmath242 , @xmath2 , or @xmath243",
    "satisfying @xmath244 , the number of tile vertices @xmath66 in @xmath16 that cross level @xmath2 and satisfy @xmath245 is precisely the number of squares @xmath15 in @xmath4 of level @xmath2 satisfying @xmath246 .",
    "only the last three conditions depend on @xmath4 ; we will refer to these as the _ consistency _ conditions .",
    "although it involves overloading the symbol @xmath17 , we will write @xmath49 whenever the edge @xmath73 is a forced edge of @xmath80 oriented toward @xmath48 . if @xmath76 is an orientation extending the partial orientation on the forced edges of @xmath80",
    ", we write @xmath247 if the edge @xmath73 in @xmath80 is oriented from @xmath47 to @xmath48 in @xmath76 .",
    "note that up to this point , we have defined @xmath17 only on actual tiles , not on the tile vertices @xmath65 , which are abstract place holders for tiles .",
    "however , our expanded use of @xmath17 is consistent in the following sense : if @xmath54 is the ribbon tiling graph of a tiling @xmath10 and the edge @xmath248 is forced , then @xmath249 if and only if @xmath250 in @xmath16 .",
    "similarly , if @xmath251 and the edge is @xmath70 is not necessarily forced , then @xmath252 if and only if @xmath253 .",
    "similar results apply to edges involving squares .",
    "if @xmath4 admits a tiling @xmath10 then the graph @xmath16 as defined in the introduction clearly satisfies the above list of requirements and is consistent with @xmath4 .",
    "( in fact , @xmath16 is the only ribbon tile graph consistent with @xmath4 in this case . ) thus , the following is a slightly more general version of lemma [ tilingfromorientation ] :    [ tilingfromconsistentgraph ] suppose @xmath16 is any ribbon tile graph that is consistent with @xmath4 .",
    "then every acyclic orientation @xmath76 of @xmath16 that extends the partial orientation on the forced edges of @xmath16 is equal to @xmath54 for some tiling @xmath10 .",
    "( in particular , if @xmath4 does not admit an order-@xmath0 ribbon tiling , then no such @xmath16 and @xmath76 exist . )",
    "suppose @xmath254 is a leftmost tile vertex in @xmath16 .",
    "as in the previous proof , we will choose the leftmost squares of each of the levels @xmath226 and declare them to be our first tile @xmath255 . that there exists at least one square in @xmath4 on each of these levels follows from the consistency conditions of @xmath16 .",
    "however , we must verify that this set of squares is actually a ribbon tile .",
    "since it contains one square on each of levels @xmath226 , it is sufficient to show that it is connected .",
    "suppose otherwise ; then we can assume without loss of generality that there exists some @xmath45 such that the leftmost square @xmath256 in the row of level @xmath257 is left of the square @xmath258 in the row of level @xmath259 but that these two squares are not adjacent .",
    "now , let @xmath260 ( @xmath261 ) be the square of level @xmath259 that is right of ( left of ) and adjacent to @xmath256 .",
    "both @xmath260 and @xmath261 must be squares in @xmath53 , since they are adjacent to @xmath256 and they are left of @xmath258 , the leftmost square of their level in @xmath4 .",
    "now , by the consistency conditions , there is exactly one tile @xmath262 containing a square on level @xmath257 such that @xmath263 ; every other tile with a square on level @xmath257 must be right of @xmath260 . if @xmath264 , then @xmath265 , violating acyclicity .",
    "hence @xmath266 .",
    "however , since @xmath260 is left of every square of level @xmath259 , one may deduce from the consistency conditions that every tile vertex @xmath27 of @xmath16 that crosses level @xmath259 must satisfy @xmath267 .",
    "thus @xmath268 , a contradiction , and it follows that the squares chosen do in fact form a tile .",
    "now we form a new region @xmath269 by removing the squares in this tile from @xmath4 .",
    "we form a new graph @xmath270 by removing @xmath271 from the vertex set of @xmath16along with all boundary squares of @xmath4 that are not boundary squares of @xmath269and adding all the boundary squares of @xmath269 that were not boundary squares of @xmath4 .",
    "( these are necessarily members of our removed tile . )",
    "we define the edges of @xmath270 and their orientations in a new orientation @xmath272 in the most natural possible way .",
    "two vertices of @xmath270 are adjacent whenever the corresponding edges in @xmath16 were adjacent , and @xmath272 is the orientation induced by @xmath76 on such edges .",
    "furthermore , if @xmath15 is one of the new boundary squares and is in a row @xmath2 , we declare it to be adjacent in @xmath270 to every tile @xmath27 that crosses rows @xmath242 , @xmath2 , or @xmath243 ( with @xmath273 ) and every boundary square @xmath274 of those levels ( with @xmath275 if and only if @xmath15 is directly or indirectly left of @xmath274 and @xmath276 when the opposite is true ) .",
    "finally , if @xmath238 was a vertex of @xmath277 with @xmath278 , we relabel it @xmath279 in @xmath270 .",
    "it follows easily from the definition that the @xmath270 thus defined  together with the partial orientation on forced edges induced by @xmath272is a ribbon tile graph consistent with @xmath269 .",
    "if we can further prove that @xmath272 is necessarily acyclic , then lemma [ tilingfromconsistentgraph ] will follow by induction .",
    "suppose @xmath272 has a cycle ; then this cycle must include a square @xmath15 of @xmath280 that was a member of the tile @xmath27otherwise the cycle would also be a cycle in @xmath76 . also , although the cycle may contain multiple squares from the removed tile , it must contain at least one element that is not a square of @xmath27 , since the squares do not themselves contain any cycles .",
    "suppose the cycle contains a sequence @xmath281 of former squares of @xmath27 but that the elements @xmath47 immediately preceding this sequence and @xmath48 immediately following it are not squares of @xmath27 . then we must have had @xmath282 in @xmath76 , and @xmath76 too must have had a cycle .",
    "[ localreplacementmove ] two order-@xmath0 ribbon tilings @xmath10 and @xmath55 differ by a local replacement move if and only if @xmath54 and @xmath77 differ by an edge reversal .",
    "first of all , we can determine whether a local replacement move involving tiles @xmath51 and @xmath283 can occur by applying the theory we have already developed to @xmath269 , the region tiled by just these two tiles .",
    "now , if @xmath269 admits two distinct tilings , then @xmath270 must admit two distinct orientations that extend the orientation on the forced edges .",
    "in particular , @xmath270 must contain at least one free edge , and that can only be the edge @xmath248 . for this edge to be free , we must have @xmath284 .    without loss of generality ,",
    "suppose @xmath285 .",
    "notice that if @xmath286 , then @xmath269 contains two squares of level @xmath90 .",
    "inspection shows that if tile @xmath51 contains the leftmost square of one of these same - level pairs , it must contain the leftmost square of every such pair .",
    "( see figure [ localmoves ] . )",
    "moreover , if a tile contains one square on a row higher than @xmath287 ( lower than @xmath228 ) , it must contain every square with this property .",
    "thus , a local replacement move must consist of swapping the squares in each same - level pair .",
    "such a swap produces a new pair of ribbon tiles if and only if the single square on row @xmath288 ( resp . , @xmath289 )",
    "is adjacent to both of the squares in row @xmath228 ( resp . , @xmath287 ) .",
    "inspection shows that whenever there is no square @xmath15 with either @xmath290 or @xmath291 , then a local move can in fact occur .",
    "now , if @xmath55 is the tiling obtained by applying such a move to @xmath10 , and @xmath58 then inspection shows that we must have @xmath225 ; it is also easy check that if @xmath47 is any tile or square outside of @xmath269 , then @xmath292 if and only if @xmath293 .",
    "similarly , @xmath294 if and only if @xmath295 .",
    "it follows that if @xmath10 and @xmath55 differ by a local replacement move , @xmath54 and @xmath77 do in fact differ by the reversal of exactly one edge : the edge @xmath70 .    for the converse",
    ", note that if the orientation of an edge @xmath248 of the orientation @xmath54 can be reversed without creating a cycle , we know there must be no vertex @xmath47 of @xmath54 with either @xmath296 or @xmath297 ; we have already shown that this is a sufficient condition for there to exist a local move involving the tiles @xmath51 and @xmath283 , and so @xmath77 must be the orientation obtained by reversing the edge .      the main result of this section will be a linear - time algorithm for determining whether a simply connected region @xmath4 has an order-@xmath0 ribbon tiling and constructing such a tiling when one exists . to determine existence , we will make use of the well - known fact ( which we later prove ) that there exists an acyclic orientation @xmath76 of a graph @xmath80 that extends a given partial orientation of @xmath80 if and only if the partial orientation is itself acyclic .",
    "this implies the following corollary of lemma [ tilingfromconsistentgraph ] :    given @xmath4 , there exists an acyclic partially oriented ribbon tiling graph @xmath16 that is consistent with @xmath4 if and only if @xmath4 admits an order-@xmath0 ribbon tiling .    using this fact",
    ", we divide our algorithm into three steps .    1",
    ".   we either produce an acyclic ribbon tile graph @xmath16 that is consistent with @xmath4 or prove that no such graph exists ( and hence @xmath4 admits no order-@xmath0 ribbon tiling ) .",
    "if we succeed in producing @xmath16 in the previous step , we describe a total ordering on the vertices of @xmath16 that induces the partial orientation of @xmath16 on the forced edges of @xmath16 .",
    "3 .   given this totally ordering on the vertices of @xmath16 ,",
    "we describe a tiling of @xmath4 .",
    "now , we know that if there is an acyclic ribbon tile graph @xmath16 that is consistent with @xmath4 , we can use it to generate @xmath54 using the construction of lemma [ tilingfromconsistentgraph ] , and the partial orientation on @xmath16 will thus be the restriction of @xmath54 to the forced edges in @xmath16 .",
    "thus , in the construction that follows , we can make use of lemmas proved earlier in the paper under the assumption that @xmath4 had a tiling .",
    "if @xmath4 does have a tiling , our assumption will have been correct .",
    "if @xmath4 does not have a tiling , these assumptions will lead to contradictions , and these will enable us to conclude that no tiling exists .    now we begin to construct @xmath16 .",
    "let @xmath298 be the number of squares of level @xmath2 and let @xmath299 be the number of tiles whose lowest square is @xmath2 .",
    "clearly @xmath300 , and is thus easily computed for each @xmath2 in linear time .",
    "( if it is not the case that @xmath301 whenever @xmath302 and @xmath303 whenever @xmath304 , we can conclude that no tiling exists . ) for each @xmath2 for which @xmath305 , we include @xmath65 for @xmath306 as tile vertices of @xmath16 .",
    "we also include all the boundary squares of @xmath4 as square vertices of @xmath16 .",
    "this @xmath16 has an edge whenever the corresponding tiles / squares are on levels that would make them comparable by @xmath17 , and we require that @xmath307 whenever both of these vertices are in @xmath16 .",
    "we would now like to determine an orientation on the forced edges of @xmath16 that will make @xmath16 a consistent ribbon tiling graph .",
    "we will not store in memory all of the edges of @xmath16 ( as the number of such edges could be quadratic in the size of @xmath4 ) ; instead , we will observe that the partial orientation on @xmath16 induces a total ordering @xmath308 on the set of squares and tiles of a given type that are all incident to a common diagonal .",
    "since every forced edge can be derived from such an ordering on some diagonal , it will thus be sufficient for us to store in memory the actual orderings corresponding to each such type / diagonal pair , and this requires only a linear amount of memory .",
    "given an infinite diagonal @xmath102 between square rows of levels @xmath242 and @xmath2 and some @xmath309 , let @xmath310 be the set of tiles in @xmath16 of the form @xmath311 together with squares in @xmath16 on levels @xmath242 and @xmath2 . since the elements in @xmath312 share a common diagonal and all tiles in this set are of the same type , each pair of elements in @xmath312 is connected by a forced edge and hence @xmath16 induces a total ordering on this set .",
    "now , we can compute the height function @xmath313 on the boundary of @xmath4 , and using @xmath313 , we can deduce this ordering explicitly from lemma [ diagonalnumberindependence ] as follows .",
    "let @xmath314 . given consecutive boundary vertices @xmath164 and @xmath165 along the diagonal , we know that the number of tiles of the form @xmath311 ( and hence of type @xmath315 ) that cross @xmath102 between consecutive boundary vertices @xmath164 and @xmath165 must be @xmath316 . clearly , if @xmath240 is a square incident to the diagonal @xmath102 immediately before @xmath164 and @xmath241 is a square incident to @xmath102 immediately after @xmath165 , the number of tiles @xmath27 of the form @xmath311 satisfying @xmath317 must be exactly @xmath318 .",
    "thus , we can compute the number of tiles of @xmath312 in between each pair of boundary squares , and this completely determines the ordering .",
    "similarly , given an infinite diagonal @xmath102 between square rows @xmath242 and @xmath2 , let @xmath319 be the set of tiles in @xmath16 of the form @xmath65 or @xmath320 together with the squares in @xmath16 on levels @xmath242 and @xmath2 .",
    "each pair of elements in @xmath319 is connected by a forced edge , and thus the partial orientation on @xmath16 must induce a total ordering on this set . by lemma [ diagonalordering ] and lemma [ squarediagonalordering ]",
    ", we can deduce this total ordering from the value of the height function on the boundary vertices of @xmath4 in @xmath102 .",
    "since every forced edge involves two elements along the same diagonal , we can compute the orientation of each forced edge by repeating this process for each diagonal .",
    "now we check that if @xmath16 is acyclic , it is necessarily a consistent ribbon tiling graph .",
    "it is enough to check the consistency conditions . by construction",
    ", @xmath16 contains all boundary squares , and by the definition of @xmath299 , the total number of tiles crossing each level @xmath2 is the number of squares in @xmath4 of level @xmath2 . for the final consistency condition , suppose @xmath2 is given and @xmath240 and @xmath241 are boundary squares of types @xmath242 , @xmath2 , or @xmath243 with @xmath321 .",
    "then let @xmath322 be the diagonal above the row of squares of level @xmath2 and let @xmath323 the diagonal below these squares .",
    "one easily checks that both @xmath322 and @xmath323 contain edges in each of @xmath240 and @xmath241 .",
    "it suffices to check the condition under the assumption that there exists no boundary square @xmath324 incident to @xmath102 with @xmath325 , since otherwise we can check the condition separately for the pair @xmath326 and the pair @xmath327 .",
    "say a vertex has level @xmath2 if it is a corner of squares of type @xmath242 , @xmath2 , and @xmath243 , and let @xmath185 be the portion of the diagonal connecting the last level @xmath2 vertex of @xmath240 to the first level @xmath2 vertex of @xmath241 .",
    "then it follows by applying lemma [ diagonalnumberindependence ] to the diagonal @xmath322 ( or to @xmath323 if @xmath322 has type @xmath149 ) that the number of tile vertices @xmath27 of type @xmath149 crossing @xmath2 and satisfying @xmath317 must be equal to @xmath328 . write @xmath329 , and note that the total number of such tile vertices must then be @xmath330 . however , this function is tiling - independent and in fact _ always _ increases by one as we move between squares of color @xmath106 and @xmath331 with @xmath331 on the left .",
    "it follows that if the vertices of the grid are labeled with coordinates @xmath332 , then @xmath333 will be equal to @xmath334 plus a constant .",
    "in particular , this implies that @xmath335 is equal to the number of squares on level @xmath2 directly between vertices @xmath164 and @xmath165 , and this is easily seen to be the number of level @xmath2 squares @xmath15 in @xmath4 satisfying @xmath336 .",
    "the only remaining step is to determine whether our partial orientation of @xmath16 is indeed acyclic .",
    "there are many of ways to do this in time linear in the number of edges of @xmath16 .",
    "we say a forced edge @xmath73 of @xmath16 is _ essential _",
    "if @xmath49 and there exist no forced edges @xmath337 and @xmath338 with @xmath339 and @xmath340one easily checks that the number of essential forced edges of @xmath16 is linear in the size of @xmath4 and that any acyclic orientation of @xmath16 that extends the partial orientation on the essential forced edges must extend the partial orientation on all forced edges .",
    "( see figure [ interlockinggrids ] . )",
    "the following algorithm for determining acyclicity ( know as the _ topological sort _ ) is well - known , and we will apply it to the graph formed by the vertices of @xmath16 and the essential forced edges of @xmath16 .    choose a starting vertex @xmath207 from the set of vertices of @xmath16 and attempt to construct an increasing path @xmath341 until we either reach a point we have already visited ( and we declare that there exists a cycle ) or we reach a vertex @xmath208 that is not left of any of its neighbors .",
    "clearly , @xmath208 can not be part of a cycle , so we remove it and begin searching again with @xmath342 ( if @xmath343 , we choose a new @xmath207 arbitrarily from among the remaining vertices of @xmath344 ) .",
    "we continue this process until we have removed all the vertices of @xmath344 or we have found a cycle .",
    "in the former case , if we list the elements of @xmath344 in the order in which they were removed from @xmath344 , we have some ordering @xmath345 in which @xmath346 implies @xmath347 ( since @xmath205 could otherwise not have been removed before @xmath348 ) .",
    "thus , we can define an acyclic orientation @xmath76 on @xmath16 by simply saying that whenever @xmath349 is an edge in @xmath16 , @xmath350 .",
    "let @xmath10 be the tiling for which @xmath351 . then if @xmath65 is the last tile that occurs in our ordering , we know that @xmath51 contains the leftmost squares of rows @xmath226 .",
    "we know that the next to last tile @xmath283 contains the leftmost remaining squares of rows @xmath352 , and so forth .",
    "thus , given our ordering , it is easy to explicitly determine all the tiles of @xmath10 in linear time .",
    "note also that this algorithm yields an explicit proof of the fact ( mentioned earlier ) that every acyclic partial ordering of a graph has an acyclic extension .",
    "the constructions in this paper allow us in principle to work out the maximally informative abelian height function for any polyomino tiling problem .",
    "the following facts , for example , are simple to verify :    1 .   given any coloring of the squares of @xmath4 , a _",
    "generalized ribbon tiling _ is a tiling in which each tile contains exactly one square of each color .",
    "suppose , for example , we color the square at position @xmath1 one of @xmath353 colors according to the values of @xmath354 and @xmath355 . in this case , the canonical abelian height space is @xmath356 .",
    "( when @xmath357 , this is the square / skew - tetromino tiling problem mentioned in @xcite . ) 2 .",
    "let @xmath82 be the set of all polyominos with two black and two white squares in the usual chess board coloring .",
    "( these are squares , skew - tetrominos , and length - four vertical and horizontal bars . )",
    "the canonical abelian height function space is @xmath358 .",
    "if @xmath82 contains all trominos , then the canonical abelian height space is trivial .",
    "let @xmath82 be the set of all rectangular @xmath359 tiles and @xmath360 tiles .",
    "then the canonical abelian height space is @xmath361 .",
    "( this problem was studied in @xcite , where connectedness under local moves was proved using a non - abelian height function . )",
    "if @xmath82 contains only horizontal dominos , then the canonical abelian height space is infinite dimensional .",
    "in general , the height function @xmath91 is only defined at the vertices of @xmath4 that are on the boundary of tiles of @xmath10 .",
    "one ( admittedly awkward ) way around this is to replace each tile with a spanning tree of the squares in that tile , and consider an edge in @xmath27 to be on the boundary if the squares it divides are not adjacent as members of the tree .",
    "( see figure [ spanningtrees ] . )",
    "that is , if @xmath164 and @xmath165 are adjacent vertices in @xmath4 , we say @xmath362 is equal to @xmath363 when the squares incident to @xmath364 are either contained in different tiles or are contained in the same tile @xmath27 but are not adjacent as members of the spanning tree of @xmath27 ; this is enough to determine the value of @xmath91 at every vertex @xmath94 in @xmath4and this is now true even if we allow @xmath82 to contain non - simply - connected tiles .",
    "of course , the height values now depend on the particular choice of spanning tree for each tile ; one might even consider each way of choosing a spanning tree of a tile @xmath27 to be a different tile in its own right . in this perspective",
    ", @xmath82 becomes a set of tile  spanning - tree pairs .",
    "changing the spanning tree corresponding to a given tile is a sort of local replacement move .",
    "we saw in the examples that the abelian height function space for tromino - tilings is trivial ; in this case , of course , all tilings of @xmath4 by trominos have the same ( trivial ) height function mapping all vertices to zero .",
    "we will now describe a condition on tile sets @xmath82 that will ensure that two distinct tilings do not have the same height function . given a map @xmath86 from the squares of @xmath4 to the abelian height group @xmath80",
    ", we say a tile @xmath27 is _ admissible _ by @xmath86 if @xmath365 .",
    "we say @xmath27 is _ irreducible _ with respect to @xmath86 if there is no way to partition @xmath27 into two or more smaller polyominos each of which is admissible . a tile set",
    "@xmath82 is irreducible if each tile is irreducible with respect to the map @xmath86 from the squares of @xmath4 to the canonical abelian height space determined by those tiles .",
    "note that these definitions depend only on the ( canonically determined ) values of @xmath86 on squares @xmath15 ; they do not depend on any arbitrary choices we made when choosing the value of @xmath86 on individual edges .",
    "now , consider two tilings @xmath10 and @xmath55 of @xmath4 with the same height function @xmath313 .",
    "we claim that each connected component @xmath366 of the intersection of any tile in @xmath10 with a tile in @xmath55 satisfies @xmath367 . to see this ,",
    "let @xmath368 be the vertices of a cycle surrounding @xmath366 .",
    "since each edge in this cycle is a boundary edge of either @xmath10 or @xmath55 , it follows that @xmath369 where the second sum is over clockwise edges on the boundary of @xmath366 .",
    "unless @xmath366 is a tile in both @xmath55 and @xmath10 , it must be contained in a larger tile @xmath27 in one of the two tilings , say @xmath55 .",
    "all the connected components of intersections of @xmath27 with tiles of @xmath10 are admissible , and it follows that @xmath27 is reducible with respect to @xmath86 . we can now deduce the following :    if @xmath82 is irreducible , then no two tilings of @xmath4 by tiles in @xmath82 have the same height function .",
    "this does not mean that height functions for reducible tile sets can not provide useful information , but if a tile set is reducible , there may be aspects of the tiling that are not captured by the height function .",
    "a good example is the tile set @xmath82 containing all domino tiles and all skew tetromino tiles .",
    "the abelian height function for tilings by these tiles is simply the usual domino - tiling height function , where a skew tetromino is treated as a pair of dominos .",
    "assume our height functions are defined at every vertex .",
    "then for each oriented edge @xmath370 we define @xmath371 to be the set of all differences @xmath362 that can possibly arise for a tiling @xmath10 of any region @xmath4 .",
    "recall that : @xmath372 where the latter sum ranges over all squares passed on the left by the edge @xmath364 .",
    "thus the set @xmath371 is equal to @xmath373 where @xmath374 is the set containing @xmath375 and all possible square sums @xmath376 over sets of squares that can occur in the left side of a tile divided by @xmath90 .",
    "clearly , @xmath377 .",
    "we say a function @xmath313 from the vertices of @xmath4 to @xmath80 has _ proper differences _ with respect to the tile set if    1 .",
    "@xmath378 whenever @xmath364 is a boundary edge of @xmath4 .",
    "@xmath379 whenever @xmath364 is an interior edge of @xmath4 .",
    "3 .   @xmath380 for some reference vertex @xmath92 on the boundary of @xmath4 .",
    "we say a tile set @xmath82 is _ complete _ if it is irreducible and for every simply connected region @xmath4 , every function on @xmath4 with proper differences is the height function of a tiling of @xmath4 by tiles in @xmath82 . for this definition",
    ", @xmath86 is assumed to be the usual map from edges into a group @xmath80 containing the canonical abelian height space as a subgroup . like the definition of irreducibility of @xmath82 ,",
    "this definition is independent of any arbitrary choices we made in choosing @xmath86 . to see this , note that if we add to @xmath86 a function @xmath381 on the edges of @xmath7 such that @xmath382 for any square , this simply amounts to adding a tiling - independent function to each @xmath91 and adjusting the @xmath371 values accordingly .",
    "when a tile set is complete , there is a precise one - to - one correspondence between tilings of @xmath4 by that tile set and height functions on the vertices of @xmath4 with proper differences .",
    "the fact that dominos are a complete set of tiles has been very important to the study of domino tilings ; it is often easier to work with the space of height functions satisfying difference restrictions than to work directly with domino tilings .",
    "completeness of domino tilings implies that existence algorithms and random sampling algorithms for domino tilings can all be derived from corresponding algorithms for spaces of height functions with proper differences .",
    "we show here that any set of generalized ribbon tilings is complete . given a coloring of the squares of @xmath7 with @xmath0 colors ,",
    "recall that a generalized ribbon tile set @xmath82 consists of all polyominos ( together with corresponding spanning trees ) that contain exactly one square of each color .",
    "let @xmath80 be the canonical abelian height space for the generalized ribbon tile set @xmath82 .",
    "although we do not in general know the structure of @xmath80 , we can determine the structure of @xmath383 , the quotient of @xmath80 with the relations @xmath384 whenever @xmath116 and @xmath117 have the same color .",
    "let @xmath385 be the composition of @xmath86 with the quotient map sending @xmath80 to @xmath383 and observe that the value of @xmath386 depends only on the color of @xmath15 ( the same is not necessarily true of @xmath113 ) .",
    "let @xmath130 be the value of @xmath386 when @xmath15 has color @xmath45 .",
    "now @xmath383 is precisely the group generated by the @xmath130 subject to the one relation @xmath133 .",
    "( because this relation is enough to force @xmath387 to be zero for each @xmath388 , no additional relations are required . )",
    "it is easy to see that these tiles are irreducible : no nonempty proper subset of the @xmath130 sums to zero in @xmath383 , so each sum of @xmath113 over a nonempty proper subset of the squares of a tile has nonzero image in @xmath383 and is hence a nonzero element of @xmath80 .",
    "now , to show that @xmath82 is complete , we must show that every @xmath313 mapping the vertices of @xmath4 to @xmath80 with proper differences is the height function of a tiling @xmath10 .",
    "suppose @xmath313 has proper differences .",
    "given an edge @xmath389 in @xmath4 , we define @xmath390 . by the definition of proper differences , @xmath391 is the sum of @xmath113 over some set @xmath392 of squares @xmath15and there exists at least one tile @xmath83 such that @xmath90 crosses @xmath27 and passes those squares on the left . in particular",
    ", this implies that @xmath392 contains at most one square of each color and can not contain a square of every color .",
    "put differently , the set @xmath393 of colors that occur in squares of @xmath392 is a proper subset of @xmath394 , and the image @xmath395 of @xmath391 in @xmath383 is simply @xmath396 .",
    "we say @xmath90 has _",
    "color @xmath106 on its left _ if @xmath397 .",
    "note that if @xmath90 has a square of color @xmath106 immediately to its right and @xmath313 has proper differences , then @xmath393 can never contain @xmath106 .",
    "now we will construct the tiling @xmath10 for which @xmath313 is the height function .",
    "let @xmath398 , @xmath399 , @xmath400 , and @xmath401 be the clockwise oriented edges of a square @xmath15 with color @xmath45 . if @xmath313 is a function with proper differences and @xmath402 are a path of vertices surrounding @xmath15 clockwise , we have : @xmath403    taking the image of the latter sum in @xmath383 gives @xmath404    since none of the @xmath405 can contain @xmath45 ; it is easy to see that the only way @xmath406 can be @xmath407 in @xmath383 is if the sum includes exactly one term of type @xmath408 for each @xmath409 .",
    "thus , for @xmath410 , the @xmath405 are disjoint , and their union contains all colors except @xmath45 .",
    "now , we say @xmath116 and @xmath117 are _ tile adjacent _ if they are adjacent and the edge @xmath90 between them has a nonempty @xmath392 .",
    "we define our tiles to be the connected components of the tile - adjacency relation .",
    "if we can show that every tile contains exactly one square of each color , we will have proved the completeness of @xmath82 .",
    "suppose @xmath274 has color @xmath45 , and choose some @xmath163 .",
    "we aim to show that @xmath274 is in the same tile as a square of color @xmath106 .",
    "observe that at least one edge of the four clockwise edges of @xmath411 has color @xmath106 on its left .",
    "let @xmath116 be the square adjacent to @xmath274 that is incident to the edge @xmath90 for which this is the case .",
    "clearly , @xmath116 does not have color @xmath45 .",
    "if it has color @xmath106 , we are done .",
    "otherwise , suppose @xmath398 , @xmath399 , and @xmath400 are the three other clockwise oriented edges of @xmath116 .",
    "we know that the union of the @xmath412 and @xmath413 contains all colors except the color of @xmath116 .",
    "since @xmath414 , it follows that each of the @xmath412 is a proper subset of @xmath393 and that one of them contains @xmath106 .",
    "now , we let @xmath117 be the square adjacent to @xmath116 and incident to the edge for which this is the case and repeat this process . since the proper subsets can not decrease in size indefinitely",
    ", we must eventually reach a square of color @xmath106 .",
    "a similar argument shows that such a path starting at @xmath274 never reaches another square of color @xmath45 .",
    "it follows that each tile contains exactly one square of each color and that the adjacency relation describes a spanning tree of that tile .    using similar arguments",
    ", one can show that the tile set containing all @xmath415 and @xmath359 rectangles is complete .",
    "a good example of a tile set that is irreducible but not complete is , when @xmath416 , the set of ribbon tiles of order @xmath0 with all but one of the possible ribbon tile shapes .",
    "when is it possible to add tiles to an incomplete tile set @xmath82 to make it complete ?",
    "first , it is clear that we will have to add as a tile every finite region @xmath4 on which there exists a height function @xmath313 with proper differences such that the set @xmath411 of edges @xmath364 in @xmath4 for which @xmath417 _ does not _ divide the squares of @xmath4 into more than one component .",
    "( there may be an infinite number of such regions , and they may be arbitrarily large . )",
    "note that since all of these new tiles are already admissible by @xmath86 , adding these tiles will not change the canonical abelian height space , and we can use the same @xmath86 to define height functions for the new tiling .",
    "if each of these new tiles is irreducible , the result is a complete set of tiles , called the _ completion _ of @xmath82 .",
    "conway - lagarias @xcite and thurston @xcite observed that a simple necessary condition for the existence of a tiling on @xmath4 is that the height function be well - defined on the boundary of @xmath4 .",
    "that is , the group - wise sum of @xmath89 around the all the edges @xmath90 of @xmath4 must be the identity .",
    "it is not difficult to describe much stronger necessary conditions .",
    "if a tile set @xmath82 is complete and @xmath4 is a simply - connected region , then ( assuming the previous condition is satisfied ) the question of whether @xmath4 can be tiled by @xmath82 reduces to the question of whether there is a height function on the vertices of @xmath4 with proper differences .",
    "even if @xmath82 is not complete , the existence such a function is a necessary condition for the existence of a tiling of @xmath4 .",
    "thus , the following interpolation problem is of interest :    given a simply connected region @xmath4 , a function @xmath313 defined on all boundary vertices of @xmath4 , and a set @xmath371 for each oriented edge ( with @xmath418 for all @xmath90 ) , is it possible to interpolate @xmath313 to all vertices of @xmath4 in such a way that @xmath379 whenever @xmath364 is an edge in @xmath4 ?    when the height function space is a rank @xmath0 free - abelian group , this is a special case of integer programming , which is in general np - complete . but",
    "suppose we embed the height space in @xmath419 and let @xmath420 be the convex hull of the set of points in @xmath371 .",
    "then a relaxed version of the problem asks for an interpolation of @xmath313 to the interior squares of @xmath4 where @xmath313 is allowed to assume any values in @xmath419 and the differences are merely required to lie in @xmath421 .",
    "since each @xmath421 is a convex polyhedron , this is now a linear programming problem that can be solved in polynomial time . if we prove that there is no solution to the relaxed interpolation problem , we know @xmath4 can not be tiled by @xmath82 .",
    "suppose that @xmath4 is simply connected except for @xmath422 `` islands , '' labeled @xmath423 ; we assume that the boundary edge / vertex sets of the boundary of each @xmath424 and the outer boundary of @xmath4 are disjoint , but that each @xmath425 is connected .",
    "the problem with defining height functions on @xmath4 is that as we traverse the boundary of a given @xmath424 clockwise and come back to the same place , the height function changes by @xmath426 ; thus , if @xmath427 , then the height function @xmath91 is not well - defined as a single - valued function .",
    "there are two ways around this problem .",
    "one is simply to accept that @xmath91 is a multiple - valued function ; only the differential @xmath428 , is well defined , and this can be integrated to produce a single - valued @xmath91 on the vertices of any simply connected subset of @xmath4but not all of @xmath4 .",
    "second , we could choose some replacement @xmath138 for @xmath86 satisfying :    1 .",
    "@xmath429 for each island @xmath425 .",
    "2 .   @xmath430 for each @xmath15 in @xmath4 .",
    "it is not hard to see that such a @xmath138 always exists .",
    "if we define @xmath91 using @xmath138 instead of @xmath86 , then it is everywhere defined .",
    "we require @xmath147 for some outer boundary vertex @xmath92 , and we also choose one vertex @xmath107 on each island @xmath45 .",
    "clearly , the value of @xmath91 on all boundary vertices is determined by its value on the @xmath107 .    in the special case of ribbon tilings , we define a _ simple local replacement move _ on @xmath4 to be a move that involves removing two tiles @xmath33 and @xmath34 that together comprise a _ simply connected _ two - tile region @xmath269 and replacing them with another pair of tiles .",
    "when @xmath4 is simply connected , no tiling of @xmath4 ever contains a pair @xmath33 and @xmath34 of tiles whose union is connected but not simply connected  otherwise , there would be a hole between them that could not be filled by order-@xmath0 ribbon tiles .",
    "thus , when @xmath4 is simply connected , every possible local replacement move is simple .",
    "it is not hard to show in general that two order-@xmath0 ribbon tilings @xmath10 and @xmath55 on @xmath4 can be connected by a sequence of simple local replacement moves if and only if @xmath431 for each @xmath45 .",
    "the reader may also check that when @xmath432 , every local replacement move is simple .",
    "the domino tiling problem is perhaps the most well understood of all tiling problems .",
    "height functions and local replacement moves have played a fundamental role in the proofs of many domino tiling theorems , including the following .    1",
    ".   proofs of local - move connectedness .",
    "2 .   algorithms for computation of minimal - length local move sequences connecting two tilings .",
    "3 .   linear algorithms for determining when a region @xmath4 has a tiling .",
    "4 .   mixing time bounds on random processes based on local moves .",
    "@xcite , @xcite 5 .   perfect sampling algorithms based on `` coupling from the past . ''",
    "@xcite 6 .",
    "asymptotic entropy computations for random tilings and descriptions of finite and asymptotic gibbs measures .",
    "@xcite , @xcite 7 .",
    "law of large numbers and large deviations principles for asymptotic height function shapes of random tilings .",
    "@xcite 8 .",
    "conformal invariance of certain tiling properties in the asymptotic scaling limit .",
    "@xcite    these results and references are ridiculously far from exhaustive ; there have been numerous papers relating to each of the above topics and many others .",
    "we include the references not to assign credit , necessarily , but to provide pointers to papers with more complete bibliographies .",
    "because ribbon tilings are in many ways the simplest polyomino tilings that generalize domino tilings , the following question is very natural :    which of the above results can be generalized to ribbon tilings ?",
    "an additional task is to generalize to other tiling spaces with abelian height functions .",
    "can connectedness under local replacement moves be generalized to the other tiling problems in this paper ?",
    "in particular , is there a local move result for every complete , translation - invariant tile set ?    finally , the author hopes this paper will be a step towards a more thorough understanding of at least the abelian case of the conway - lagarias height function theory .",
    "the following is a more theoretical question :    is there a simple classification of the complete , translation invariant tile sets with finitely many tile shapes ?",
    "given such a tile set @xmath82 , is there always a polynomial algorithm for determining whether a simply connected region can be tiled by @xmath82 ?",
    "many thanks to henry cohn for bringing the problem to my attention , for numerous helpful conversations , and for reviewing early drafts of the paper . thanks",
    "also to lszl lovsz for helpful conversations and to igor pak for suggesting additional references ."
  ],
  "abstract_text": [
    "<S> we fix @xmath0 and say a square in the two - dimensional grid indexed by @xmath1 has color @xmath2 if @xmath3 . </S>",
    "<S> a _ ribbon tile _ of order @xmath0 is a connected polyomino containing exactly one square of each color . </S>",
    "<S> we show that the set of order-@xmath0 ribbon tilings of a simply connected region @xmath4 is in one - to - one correspondence with a set of _ height functions _ from the vertices of @xmath4 to @xmath5 satisfying certain difference restrictions . </S>",
    "<S> it is also in one - to - one correspondence with the set of acyclic orientations of a certain partially oriented graph .    using these facts , we describe a linear ( in the area of @xmath4 ) algorithm for determining whether @xmath4 can be tiled with ribbon tiles of order @xmath0 and producing such a tiling when one exists . </S>",
    "<S> we also resolve a conjecture of pak by showing that any pair of order-@xmath0 ribbon tilings of @xmath4 can be connected by a sequence of local replacement moves . </S>",
    "<S> some of our results are generalizations of known results for order-@xmath6 ribbon tilings ( a.k.a . </S>",
    "<S> domino tilings ) . </S>",
    "<S> we also discuss applications of multidimensional height functions to a broader class of polyomino tiling problems .     </S>",
    "<S> american mathematical society </S>"
  ]
}