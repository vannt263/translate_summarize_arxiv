{
  "article_text": [
    "advancements in the field of classical molecular dynamics simulation can be classified into three general categories ; i ) those that increase the length scales of accessible problems , ii ) extensions of the timescales accessible by modern software packages and lastly , iii ) improvements to the accuracy , quality , or realism of predictions made by md . in other words these three areas , in one way or another , correspond to the computing hardware , software and fidelity of the approximations that are used to run the simulation . but",
    "while these categories are distinct , it would be wrong to assume that there is no interdependence between them .",
    "in fact , any one of these areas may be pushed forward by an advancement in any of the other .",
    "the work presented here will fall into the third general category of improved fidelity , where we are developing interatomic potentials ( iap ) that , as we will show here , approach the accuracy of density functional theory ( dft ) while preserving the scalability of classical md simulations .",
    "of course the distillation of a truly many - body energy functional from dft into energies and forces that are written on a per - atom basis comes with certain approximations .",
    "classical md necessarily uses purely local information to calculate the force on each atom and the total energy of the system . without this near - sightedness , it would not be possible to use the scalable parallel algorithms that enable simulations of millions of atoms on large distributed computer systems .",
    "even with this short - ranged approximation , many iap have been successful in including multi - body effects through the addition of higher - order terms in the total energy that take into account many - body aspects of the local environment such as bond angles , dihedrals , coordination dependence , or even more generally bond - order dependent terms .",
    "while the properties of materials are best determined from an _ ab initio _ level of theory , the study of defects and failure mechanisms necessitates a length scale that is pushed beyond what is tractable at this level of theory . in this work , we are concerned with the defect interactions and failure modes of plasma - facing components , namely tungsten , in fusion reactors where surface defect features range in size from sub - nanometers to millimeters . at the smallest length scales , an accurate description of a wide range of these defects is challenging because the local environment of defect cores is unlike the crystalline matrix .",
    "therefore , the iap in md must be able to simultaneously capture the potential energy surface of atoms in either of these bonding configurations .",
    "therefore , successful models must in some way represent multi - body interactions .",
    "a recent trend in molecular dynamics is to integrate the advancements from the fields of machine - learning and neural networks in order to produce more accurate potential energy surfaces .",
    "in essence , this class of iap dispense with a fixed functional form in favor of more general statistical relationships that are adjusted under supervised training to reproduce a large set of training data .",
    "this supervised training data is supplied by the user and consists of a collection of high - accuracy results from _ ab initio _ calculations .",
    "the statistical relationships uses a set of descriptors to map atomic configurations to specific values of energy and force .",
    "the main differences between potentials lie in the set of descriptors that are used@xcite .",
    "the set of descriptors used in the machine - learning process must be physically motivated , because the potential must be able to distinguish unique atomic environments , while at the same time satisfy basic physical principles , such as permutation , translational and rotation invariance.@xcite    the snap interatomic potential falls under this umbrella of machine - learned potentials in that it uses a set of descriptors of the local environment around an atom in order to calculate the per - atom energy function .",
    "this is in direct contrast to most iap that use a fixed functional form with a single or few dependent variables ( such as distance , bond order or angle ) to calculate the interactions of atoms .",
    "a key advantage of a flexible iap such as snap is that its accuracy is directly dependent on the number of bispectrum components@xcite used in the atomic energy expansion .",
    "hence it is possible to systematically improve the accuracy of the potential , at the price of increased computational cost . following the gap formalism of bartok et al.@xcite , snap uses the bispectrum components of the 4d hyperspherical harmonics on the 3-sphere to characterize atomic neighborhoods .",
    "a key difference between the gap and snap formalism is that snap assumes a linear relationship between the atomic energy and the bispectrum components .",
    "the details of the derivation of the snap energy function are described elsewhere @xcite . here",
    "we provide a brief summary .",
    "the potential energy of a configuration of atoms with is written as the sum of a reference potential and the snap contribution @xmath0    where @xmath1 , @xmath2 , and @xmath3 are the total , reference , and snap potential energies , respectively .",
    "the term @xmath4 is a vector giving the positions of the @xmath5 atoms in the configuration . in the present case for tungsten ,",
    "the zbl pair potential is used to capture the short - range repulsive interactions between atomic cores . within the snap formalism",
    ", @xmath3 is expressed as a sum over individual atom energies , each of which is in turn expressed as a weighted sum over its bispectrum components .",
    "@xmath6 similarly , the force on each atom @xmath7 due to the snap potential can be expressed as a weighted sum over the derivatives w.r.t .",
    "@xmath7 of the bispectrum components of each atom @xmath8 .",
    "@xmath9    in this way , the total energy , forces , and also the stress tensor , can be written as linear function of quantities related to the bispectrum components of the atoms .",
    "given a large set of training data , it is straightforward to construct a weighted least squares linear regression problem whose solution provides optimal choices for the coefficients @xmath10 less straightforward is the determination of optimal values for the so - called hyper - parameters that define the regression problem .",
    "these include parameters that define the neighborhood of each atom , as well as parameters that control the extent to which different components of the training data are prioritized .",
    "the optimization of the hyperparameters is discussed further in the following section .",
    "one of the key approximations for interatomic potentials is the ability to accurately predict the properties of materials / molecules that were not in the training data .",
    "this is generally referred to as the transferability of an iap .",
    "normally , the end users select an iap based on its interpreted performance for the experiments they plan to run , we as the developers of said md potential are not completely absolved from these constraints either .",
    "therefore we must be aware of each step in the fitting procedure that has the ability to bias or affect the accuracy of the iap for its intended use .",
    "we have identified three main areas where this could occur ; i ) in the selection of the training set used in supervised learning , ii ) the choice of the objective functions used during fit optimization and iii ) interpretation of the optimized hyper - parameters as it translates to the quality of the iap . the present work is focused on the accuracy of tungsten potentials for use in simulation of plasma - facing materials in a fusion reactor .",
    "therefore , we have chosen training data and fitting objectives that reflect properties relevant to this application .",
    "it is true that , in its present state , the reported snap potential has not been rigorously tested for properties outside the training set .",
    "however , as will be shown in the following section , the addition of specialized training data during the fitting process can correct for these unforeseen inaccuracies .",
    "in addition , the outputs of the fitting process provide a transparent means to compare the importance of each training configuration for reproducing the reference data .",
    "we believe this is a particular strength of the snap formalism because it has the capability for end users to be better informed to the strength and weakness of the iap .",
    "the more aware we are of the human bias ( which may never be completely removed ) that is involved in generating an iap , the better the field of md users can be at objectively selecting and interpreting this key approximation of md simulation results .",
    "schematic of the snap fitting procedure . ]",
    "much like the parameterization of other iap , the goal of the fitting process is to minimize the discrepancies that occur between reference data and the predictions made by the new candidate potential .",
    "most of the fitting protocol to generate snap potentials is automated and requires little user input after the training structures are generated .",
    "however , the selection of reference structures is still an area where expert judgement is required , as it has a strong influence on the accuracy and transferability of the resulting potential .",
    "we chose to begin with the existing set of training data used to construct the gap tungsten potential @xcite , which is publicly available online@xcite .",
    "the gap training data consists of positions , total energies@xmath11 , forces on each atom@xmath12 and virial stresses@xmath13 for several thousand small configurations of tungsten atoms .",
    "we selected a subset of this training data , omitting those structures that we deemed less relevant to our application .",
    "this addition or subtraction of training data for the needs of the potential is a unique trait of machine - learned potentials , but to date there are only empirical guidelines for how this should be managed .",
    "it is a future direction of this work to quantify the impact of certain training data on the quality of the generated potential .",
    "a sound understanding of the translation of the dft potential energy surface to an iap used in md will help researchers more efficiently deploy the extensive computing resources needed to large training data sets .",
    "again , this is an avenue for future work and will not be addressed in detail here .    during the fitting",
    "routine it is advantageous to limit the number of hyperparameters in order to limit the dimensionality of the search space . in the case of snap , this means grouping training structures together in order to reduce the degeneracy of the information provided by any one training geometry .",
    "the process by which these groups are defined is necessarily subjective .",
    "our goal was to define these groups based on the differences in bonding environments or defect types . from the gap training potential we selected four groups pertaining to primitive cell deformations ( x2000 configurations ) , a super - cell of bcc tungsten with a single vacancy ( x420 ) , free surfaces with various orientations ( x180 ) and a sampling of a dft - md run of the bcc crystal at 300k ( x60 ) .",
    "in contrast , omitted training data pertaining to dislocations and vacancy - dislocation binding , which was used to fit the gap potential .",
    "we expect that in order to accurately capture defect properties relevant to helium implantation in tungsten , a wider variety of bonding environments such as over- and under - coordinated atoms must be included in the fit . therefore , three new training data groups consisting of a few hundred new geometries were added .",
    "the isotopic compression and dilation of a bcc , fcc , a15 and simple cubic tungsten crystals form the equation of state category shown in table [ table1 ] .",
    "in addition , a 54 atom supercell of tungsten was melted and a set of 27 of these liquid structures were used to for training .",
    "lastly , @xmath14 bcc crystals with a pair of vacancies ranging from the nearest- to fourth nearest - neighbor positions were included in the fit .",
    "each of these training geometries was calculated using the vasp@xcite plane wave dft code with a @xmath15 monkhorst pack k - point mesh , 600ev plane wave cutoff energy , 0.1ev gaussian smearing , pbe exchange - correlation functional and a gw pseudopotential .",
    "once the components of the training data were assembled , the single objective genetic algorithm ( soga ) capability within the optimization software dakota@xcite is used in order to search for optimal choices of the hyperparameters .",
    "these hyperparameters are the radial cutoff used to define the snap neighborhood of each atom , and the weights used in formulating the least squares linear regression problem for the energy , force , and virial stress data of each training group . each of these regression weights is allowed to vary from @xmath16 to @xmath17 in order to properly explore its importance to the overall fit quality .",
    "it is worth mentioning that the absolute values of the regression weights are arbitrary and only carry meaning when compared to other regression weights .",
    "the last fitting parameter is the radial cutoff which is allowed to vary between 4 and 5 , excluding or including the third nearest neighbor interactions at either limit . for a given choice of hyperparameters ,",
    "the weighted least squares linear regression problem is formulated and then solved using qr decomposition , yielding optimal values for the vector @xmath18 , representing a particular candidate potential .    of equal importance to the input training data",
    "is the set objective functions that soga uses to evaluate the candidate potentials for evolutionary fitness .",
    "these objectives will determine where the resultant iap is certain to provide accurate results and should be chosen such that they also span a range of distinct material properties in order to provide some sense of transferability . the soga objective function",
    "is composed as the sum of eleven distinct error metrics .",
    "these include the relative error in the following properties : lattice parameter , three elastic constants of the bcc phase , five basic defect formation energies .",
    "also included is the absolute error in energies and forces summed over all training data .",
    "the error metrics are either obtained directly from fitsnap.py ( see figure [ fig1 ] ) or though a lammps simulation of elastic constants or defect energies run using the current candidate potential .",
    "after three - hundred candidates have been evaluated , the genetic algorithm will take the highest ranking fits and perform breeding and mutation steps to initialize the next generation of candidates . in this gradient free genetic algorithm",
    "the search could in principle continue indefinitely . however , we saw steady improvement in the overall accuracy metric ( sum of all errors ) for the first ten generations , after which no significant improvement was observed .",
    "lccccc & & @xmath19&@xmath20&@xmath21 + category&@xmath22&(ev / atom)&(ev / )&(bar ) +   + elastic deform&2000&@xmath23&-&@xmath24 + single vacancy&420&@xmath25&@xmath26&- + free surface&180&@xmath27&@xmath28&- + dft - md , 300k&60&@xmath29&@xmath30&- + equation of state&168&@xmath31&@xmath32&- + liquids&27&@xmath33&@xmath34&- + multiple vacancies&20&@xmath35&@xmath36&- +    [ table1 ]      after an optimized potential is generated from the previous steps , a natural question to ask is how much did each group of training data influence the overall objective function ?",
    "table [ table1 ] displays the resultant fitting parameters for the best performing snap result using the soga algorithm . in this table",
    "it is useful to compare the effective weights of each category for a given property ( @xmath1 , @xmath37 or @xmath38 ) and see which training geometries dominate the resultant fit(@xmath39 ) .",
    "these effective weights show the relative importance of different types of training data in the final fit and are given by the following formulas    @xmath40    in equations [ eq5]-[eq7 ] , @xmath41 is the weight assigned to group @xmath7 for property @xmath42 .",
    "these are the weights adjusted during the dakota optimization . for each training configuration",
    ", there is just one energy term and six components of the stress tensor .",
    "meanwhile , there are three forces per atom for each configuration which is shown in equation [ eq6 ] as an explicit sum over the number of configurations in group @xmath7 .",
    "the effective weights , not group weights , should be used to judge the relative importance of each of type of training data .",
    "the largest effective weight for energies belongs to the set of elastic deformation training data while the free surface and liquid configurations were roughly equivalent in terms of their importance in producing accurate forces .",
    "including the liquid structures was precisely for this reason , though the result was not guaranteed .",
    "a liquid samples a number of unique under and over coordinated bonding environments that we believe translates to better predictions of defect properties in tungsten where atoms are forced into energetically unfavorable configurations .",
    "it is not surprising then to see the two most abnormal bonding environments , free surface and liquid configurations , to dominate the fit for producing accurate forces .",
    "here we draw comparisons to a handful of well known w - potentials that span a variety of functional forms and computational costs , this includes the gap potential that shares training data with the current snap potential .",
    "it is common for any iap to test the accuracy of the available structural and mechanical properties for the material of interest , these are most commonly the lattice parameter and elastic constants of the stable phases . for tungsten , this is not a complicated task since the @xmath42 phase ( bcc ) is the only stable structure of the pure phase so there are far fewer target structural properties to meet . the a15 phase is predicted to be metastable below the melting temperature , but is not included as a fitting objective of the optimization process , we have however confirmed that the a15 phase is less stable than bcc tungsten at zero kelvin .",
    "the collection of predicted elastics constants as they compare to the dft data used as the training reference as well as an eam , meam and gap potential are shown in table [ table2 ] . excluding the dft data , all values in table [ table2 ] and [ table3 ] were calculated by the current authors using the lammps md package which contains all of these potentials .",
    "where available our predictions are compared to reported results in the original published work for each potential all of which agree within the numerical precision that is reported in our tables .",
    "the fact that each of these potentials have been run by the current authors using a single md engine will become very important when timing data is presented later in this section .",
    "most of the potentials show good accuracy for the lattice constant and elastic constants of the @xmath42 phase , with the maximum discrepancy with respect to the dft data being a few gpa or single digit percent error .",
    "the one exception is the meam potential , which is significantly less accurate for the elastic constants .",
    "this result is encouraging for the snap potential presented here , the extremely low discrepancy to dft indicates that the snap formalism can easily capture atomic interactions in a crystalline system .",
    ".[tab : table4]structural and mechanical properties of tungsten predicted from common interatomic potentials [ cols=\"<,^,^,^,^,^\",options=\"header \" , ]     [ table3 ]    the defect types calculated are the insertion of a single he into the tetrahedral or octahedral sites of bcc w , a substitution of he for a single w atom and the binding energy of two he atoms in adjacent tetrahedral sites of bcc tungsten . comparing the relative error of each potential , the snap potential predicts formation energies within a few percent ( @xmath43 ) of the dft reference for all defects , except the he substitution , which is @xmath44 lower than the expected value of 4.70  ev .",
    "the relative errors across all potentials tested here are visually displayed in figure [ fig2 ] .",
    "it is interesting to note the differences in the gap and snap potentials .",
    "these two iap share much of the same training data .",
    "however , the gap training data did not include any point defect structures , other than the single vacancy structure .",
    "similarly , the snap training data also did not include any point defect structures , other than the divacancy structures .",
    "however , by including defect formation energies as objectives , the dakota optimization guided the snap potential towards high accuracy for the tungsten defect structures .",
    "interestingly , these two machine - learned potentials show great flexibility in which material properties can be accurately captured .",
    "this is a feature of the atomic descriptors that underline the potential energy surface of both .",
    "again we should emphasize that the snap potential here was trained against material properties that are relevant to the simulation of tungsten as a diverter material in fusion reactors .",
    "the high temperature helium environment guided the choice of these defects as objective functions .",
    "it is a difficult to directly assess the loss of transferability of this snap iap because the number of configurations and material properties outside the training set vastly exceeds those that are included . as a new research direction",
    ", we are currently exploring the strategy of sampling md trajectories generated using the snap potential and testing their accuracy against dft .",
    "for now , this new snap potential has been shown to accurately reproduce elastic constants and defect formation energies to high accuracy .",
    "these properties are essential for the prediction of he bubble formation in plasma - facing materials .",
    "there is room for improvement in the accuracy of the he defects .",
    "these are the largest errors predicted by the snap potential .",
    "we see the inclusion of w - he and he - he interactions into the snap formalism as the next stages of this work , and progress is currently being made in this avenue .",
    "collection of w - defect formation energies for commonly used interatomic potentials .",
    "the raw data shown here is also contained in table [ table3 ] , dft reference data taken from derlet _ et .",
    "( 2007 ) and becquart _ et .",
    "( 2007 ) for w and he defects , respectively . ]    before closing this section it is worth addressing the problem of computational cost of each of the tungsten potentials that are highlighted here .",
    "it is true that the added accuracy of gap or snap comes with a significant computational cost with respect to eam or meam .",
    "it is important to provide realistic timing data so that users are well informed of the strengths and weaknesses of each potential .",
    "each of these potentials is implemented into the lammps md software package@xcite , which is freely available online @xcite .",
    "the eam , meam , and snap potentials can be invoked within any standard build of lammps , provided it has been compiled with the corresponding optional package , manybody , meam , snap , respectively .",
    "the gap potential requires compiling lammps with the user - quip optional package , which provides a library interface to the quip software package.@xcite further documentation , input files and simple test problems for this snap potential are now included in the lammps distrbution .",
    "more technical details about this potential can be found online @xcite .",
    "we measure computational cost by running a short tungsten md simulation with each potential on one node of a high end computer .",
    "we repeat this over a wide range of atom counts , because the optimal number of atoms per node is different for different potentials . for each potential , we experimented with the different available build options and show results for the best choice for each potential .",
    "we used a single intel broadwell node of sandia s serrano computing cluster .",
    "the node consists of two , 2.1 ghz intel broadwell e5 - 2695 v4 processors with 18 physical cores each . at runtime ,",
    "the performance of each potential was optimized by varying the number of mpi tasks while adjusting the number of openmp threads per mpi task to keep the total number of threads on the node equal to 36 , the total number of cores .",
    "we did not enable hyperthreading , non - standard numa settings , or leaving some core idle .",
    "the timings for each potential are shown in figure [ fig3 ] .",
    "several general trends are manifested and are worth discussing here .",
    "each potential undergoes a transition from a roughly constant maximum speed to strongly decreasing speed as the problem size is reduced .",
    "the maximum speed decreases by six orders of magnitude in going from eam to meam to snap to gap .",
    "the critical atom count is smaller for the more expensive potentials .",
    "log - log plot of computational speed versus atom count for the different tungsten potentials using a single intel broadwell node . for each potential",
    ", the speed in atom - timesteps / sec becomes roughly constant for sufficiently large atom count , reflecting the linear scaling of the underlying lammps neighborlist algorithm .",
    "]    we conclude that the more expensive potentials , specifically snap and gap , scale much better down to small atom counts per node .",
    "this can be seen by the magnitude of the fall off at low atom counts as compared to the performance at high atom counts each potential . for eam",
    ", there there is approximately a @xmath45 difference in performance in going from the largest to the smallest atom counts , while for snap there is only a factor of ten difference . in a practical sense",
    ", this means that a fixed - size snap md simulation can be distributed across a much larger compute platform than would be possible with the same fixed - size eam or meam simulation .",
    "consequently , the difference in the time to solution between snap and eam will be much less than the raw computational cost would indicate .",
    "this is an important aspect of high performance computing to consider as the push toward exascale machines comes to fruition in the next few years . efficiently utilizing",
    "all of the resources on extreme - scale platforms is a challenging problem , which can be mitigated by deployment of high - accuracy compute - intensive md potentials such as snap .",
    "in this report we have reported on the development of a quantum accurate snap potential for tungsten as well as reported data showing accurate helium defect properties within the tungsten matrix by merging the snap iap with the repulsive pairwise w - he interactions from juslin @xcite .",
    "we believe that the improved accuracy for both w and w - he defects will play an important role in the prediction of he bubble formation and subsequent failure mechanisms of plasma - facing components .",
    "we would like to thank brian wirth , art voter and steve plimpton for fruitful discussions throughout the work presented here .",
    "sandia national laboratories is a multi - program laboratory managed and operated by sandia corporation , a wholly owned subsidiary of lockheed martin corporation , for the us department of energy national nuclear security administration under contract no .",
    "de- ac04 - 94al85000 .",
    "juslin , n. and wirth , b. d. journal of nuclear materials , 423 , ( 2013 ) p61 - 63 thompson , a.p . , swiler , l.p . ,",
    "trott , c.r .",
    ", foiles , s.m . and g.j",
    ". tucker journal of computational physics , 285 , ( 2015 ) p316 - 330 ferre , g. , maillet , j - b . and",
    "stoltz , g. the journal of chemical physics 143 , 104114 ( 2015 ) p1 - 12 plimpton , s. , journal of computational physics 117 ( 1995 ) 1 - 19 .",
    "scheiber , d . ,",
    "pippan , r. , pushnig , p. , romaner , l. , modelling simulation materials science engineering 24 ( 2016 ) 035013 ( 19pp ) szlachta , w.l . ,",
    "bartok , a. , csayni , g. physical review b 90 , ( 2014 ) 104108 bartok , a. , payne , m. , kondor , r. , csayni , g. physical review letters , 104 , 136403 ( 2010 ) pp4 bartok , a. `` gaussian approximation potential : an interatomic potential derived from first principles quantum mechanics '' arxiv:1003.2817 derlet , p. , nguyen - manh , d. , dudarev , s. , physical review b , 76 ( 5 ) ( 2007 ) 054107 c. becquart , c. domain , nucl .",
    "methods phys .",
    "b 255 ( 1 ) ( 2007 ) p23 - 26 . eldred , m. , giunta , a. , brown , s. , adams , b. , dunlavy , d. , eddy , j. , gay , d. , griffin , j. , hart , w. , hough , p. , kolda , t. , martinez - canales , m. , swiler , l. , watson , j .-",
    "p . , and williams , p. , ( 2006 ) version 4.0 users manual , sandia national laboratories , technical report sand 2006 - 6337 .",
    "access to the gap training data used here can be found at http://www.libatoms.org/home/datarepository lammps molecular dynamics software http://lammps.sandia.gov documentation of the snap interatomic potential as it is deployed in lammps can be found at http://lammps.sandia.gov/doc/pair_snap.html .",
    "a tungsten / helium test problem is located in the lammps download under examples / snap .",
    "the quip atomistic simulation software package is available from https://github.com/libatoms/quip kresse , g. and furthmuller , j. phys .",
    "b 54 ( 1996 ) 11169"
  ],
  "abstract_text": [
    "<S> the purpose of this short contribution is to report on the development of a spectral neighbor analysis potential ( snap ) for tungsten . </S>",
    "<S> we have focused on the characterization of elastic and defect properties of the pure material in order to support molecular dynamics simulations of plasma - facing materials in fusion reactors . </S>",
    "<S> a parallel genetic algorithm approach was used to efficiently search for fitting parameters optimized against a large number of objective functions . </S>",
    "<S> in addition , we have shown that this many - body tungsten potential can be used in conjunction with a simple helium pair potential@xcite to produce accurate defect formation energies for the w - he binary system .    </S>",
    "<S> = 1 </S>"
  ]
}