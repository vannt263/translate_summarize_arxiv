{
  "article_text": [
    "one of the central challenges in financial forecasting is determining where to look . a financial instrument s time series history , comparables and derivatives , news articles and opinion pieces all",
    "have the potential to influence price evolution . developing a robust framework for knowledge extraction from disparate , jointly informative datasets remains an open challenge for the finance and machine learning communities .",
    "in this paper we forecast daily returns on the s&p500 index , a broad market benchmark for us equities commonly viewed as a gauge of financial stability .",
    "the s&p500 is a market capitalisation - weighted index of the 500 largest corporations in the us , covering the full range of technology , consumer goods , utilities and financial services companies .",
    "it is one of the most visible benchmarks in the world , actively traded by buy - and - hold mutual funds and high - frequency hedge funds alike .",
    "we begin by postulating four broad categories in which to search for salient explanatory variables . _",
    "market technicals _ include lagged returns to measure autocorrelation , as well as chartist signals used in industry like the moving average convergence divergence ( macd ) .",
    "_ sentiment analysis _ covers the impact of newsflow , measured by optimism or pessimism in social media . _",
    "options market metrics _",
    "provide a glimpse into the positioning of market experts and give us a principled , data - driven method for modelling price space as an inhomogeneous dimension with regions of directional bias and return compression .",
    "_ broker recommendations _ collate the wisdom of equity analysts and allow us to measure the predictive value , if any , of their upgrades and downgrades .",
    "we show that predictive performance improves when combining signals from each domain , and provide a principled framework for the triage of inputs by implementing automatic relevance determination ( ard ) in the covariance parametrisation of an adaptive gaussian process model .",
    "the ranking that emerges from this analysis defies expectations , and encourages further investigation of options markets and the price space representation .",
    "we first establish context for our study by reviewing relevant prior research in the domain of financial prediction using each of our various data streams .",
    "we then turn our attention to common practice multivariate analysis techniques .",
    "technical analysis was one of the earliest forms of financial forecasting , first appearing in merchant accounts of the dutch markets in the 17th century .",
    "formalised as a discipline in the 1940s ( edwards and magee , 1946 ) , it involves the use of price and volume time series to make directional forecasts .",
    "it has been extensively studied in prior regression analyses ( lo et al . , 2000 ) demonstrating the incremental gains in predictive performance provided by identifying specific patterns in price history .",
    "technicals - driven gaussian process regression has been applied to forecasting time - series in a wide range of asset classes , including stock market prices ( farrell and correa , 2007 ) , stock market volatility ( ou and wang , 2009 ) and commodity spreads ( chapados and bengio , 2007 ) .",
    "these studies show that model performance is highly reliant on the size of the training set .",
    "literature on financial prediction using text data has proliferated in recent decades , closely tracking advances in the field of natural language processing .",
    "the methodology in this domain has typically involved converting words or phrases into numerical gauges of sentiment with which to predict stock market direction ( nikfarjam et al . ,",
    "modelling techniques have ranged from simple naive - bayes or support vector machine classifiers to more advanced algorithms built on deep learning .",
    "more recent work in sentiment composition has sought to predict economic indicators like the u.s .",
    "non - farm payrolls using newsflow data .",
    "these studies show evidence that accurate parsing of news articles can produce state - of - the - art forecasts for market - moving announcements ( levenberg et al . , 2013 , 2014 ) .",
    "research on the interactions between stock and options market prices has been scarce , though early attempts were made to assess correlation in the volume data .",
    "studies indicated that call options flow lead underlying shares flow with a one - day lag , lending credence to the hypothesis of a sequential flow of information between the options and stock markets ( anthony , 1998 ) .",
    "multiple studies have been conducted to ascertain the influence of buy and sell recommendations on stock prices .",
    "research on equity analyst reports show significant , systematic but asymmetric drift in the aftermath of broker actions , with short - lived , modest gains following upgrades but durable , material sell - offs following downgrades ( womack , 1996 ) .",
    "the magnitude of these changes depended not only on the action ( upgrade vs. downgrade ) , but also on the reputation of the analyst , the size of their brokerage firm and the size of the recommended firm ( stickel , 1995 ) .",
    "various techniques have been applied to multivariate analysis in finance , relying on independent component analysis to reduce dimensionality ( lu et al , 2009 ) and elliptical copula models to capture input dependencies ( biller and corlu , 2012 ) .",
    "these studies find incremental information gain in using multiple time series from the same domain .",
    "by contrast , our work focuses on heterogeneous data fusion and modelling inter - domain dependencies .",
    "in this section we detail the features considered for each of the four domains under consideration , all of which will be used to predict _",
    "return(t+1 ) _ , the next - day log - returns on the s&p500 .",
    "market technicals are metrics derived directly from the price history p(t ) of a financial instrument .",
    "we consider four features commonly watched in industry ( taylor and allen , 1992 ) : the _ previous daily log - return _ on the s&p500 , its _ 50-day simple moving average _ , as well as the _ moving average convergence divergence ( macd ) _ and _ signal line _ , constructed from exponential moving averages ( ema ) of the time series as follows :    @xmath0}-26\\mbox{-day\\,ema\\big[p(t)\\big]}\\ ] ]    @xmath1}\\ ] ]    @xmath2 } = \\bigg(\\mbox{p(t ) } - \\mbox{\\textit{k}-day ema\\big[p(t-1)\\big ] } \\bigg)\\times \\frac{2}{k+1 } + \\mbox{\\textit{k}-day ema\\big[p(t-1)\\big]}\\ ] ]    we do not believe that the formulation of these metrics is inherently meaningful , but rather that standardised definitions provide precise , measurable thresholds at which chartist market participants will react . including these features will allow our model to identify those thresholds and thereby anticipate technically - led order flow .",
    "while factual newsflow is significant , it is specifically the polarity of its interpretation by markets - as beats or disappointments - that drives market movement .",
    "market sentiment was captured using indicators derived from both twitter and stocktwits , a social media site dedicated to real - time discussions of financial markets and actively frequented by s&p500 retail investors .",
    "two further metrics were derived by tracking the daily changes in the sentiment indices .      as a province reserved for more sophisticated traders , options market",
    "open interest volumes offer a window into the expectations of the most experienced , well - capitalised participants . as strike - sensitive instruments ,",
    "options data also allow us to gauge how these expectations vary at different price levels , motivating the representation of price as an inhomogeneous space with identifiable regions of high directional bias or variance .",
    "illustratively , high open interest ( oi ) in call options coupled with low open interest in put options indicates experts pre - positioning for a rally .",
    "by contrast , high open interest in straddles at a given strike implies low consensus among experts about _ directionality _ at that price , and hints at evenly matched , competing forces that will compress returns locally .",
    "we term this phenomenon _ viscosity _ , appealing to the visual analogy of price space as an inhomogeneous fluid that enables price gaps in regions of low viscosity and prevents it in regions of high viscosity .    to capture the directionality and viscosity implied by open interest data , we constructed two metrics .",
    "directionality measures the daily change in call minus put open interest at strike _ s _ with time - to - expiry @xmath3 , summed across all strikes _ s _ and expiries _ t_. it proxies for expert optimism as evidenced by bullish option positioning , and by construction correlates positively with s&p500 next - day returns .",
    "the scaling factors @xmath4 account for the time sensitivity of options traders , and serve to scale up the weight of nearby expiries by mimmicking the exponential decay of gamma risk as time - to - expiry lengthens .",
    "@xmath5 \\\\      - \\mathlarger{\\sum}_{s\\in s , \\tau \\in t } \\big[(\\mbox{oi(s ,",
    "t-1,$\\tau$)}_{call } -\\mbox{oi(s , t-1,$\\tau$)}_{put } ) \\times\\exp{(-\\gamma_{d}\\tau)\\big]}\\end{gathered}\\ ] ]    the parameter @xmath6 measures the rate at which directionality decays as a function of time - to - expiry , and is optimised over the training data by solving :    @xmath7    where corr is the linear correlation between its two arguments .    in parametrising viscosity , we make three modelling assumptions .",
    "firstly , the pinning effect of high straddle open interest is at its greatest for options very near their expiry date .",
    "secondly , this effect decays as live prices move away from the straddle s strike _",
    "s_. thirdly , we claim that open interest volumes follow a lognormal distribution , evolving over time through the compounding of normally - distributed exponential factors and restricted to non - negative values .",
    "these claims jointly motivate the following representation :    @xmath8\\big]\\ ] ]    we expect a significant negative correlation between viscosity and the magnitude of s&p500 next - day returns ; as such tuning @xmath9 and @xmath10 equates to solving the following optimisation problem :    @xmath11      market analysts issue recommendations on individual stocks rather than on the broad market - partly a reflection of the incentive structure for brokerage firms : commissions are substantially larger for actively managed portfolios than for passive index - trackers .",
    "to overcome this , we construct an index of broker opinions , based on a weighted sum of broker recommendations across the top 100 stocks in the s&p500 . these account for 63% of the index s market capitalisation , and broker actions on these household names",
    "have a disproportionate effect on the index as a whole .",
    "two indices were built from these weighted sums , to track both changes in analyst opinion ( upgrades and downgrades ) and the consensus state ( buy , hold or sell ) .",
    "we briefly recall the fundamentals of gaussian process modelling before describing ard kernels and the associated notion of relevance score . for a comprehensive treatment of gaussian processes",
    ", please refer to rasmussen and williams ( 2006 ) .",
    "a gaussian process is a collection of random variables , any finite subset of which has a joint gaussian distribution .",
    "gaussian processes are fully parametrised by a mean function and covariance function , or kernel .",
    "given a real process _ f_(*x * ) , we write the gaussian process as :    @xmath12    where functions _ m_(*x * ) and _ k_(*x*,*x * ) are respectively the mean and covariance functions :    @xmath13\\\\\\ ] ]    @xmath14\\ ] ]    inputs are commonly centered during pre - processing . for a given training set @xmath15 with corresponding output variables @xmath16 and gaussian process @xmath17 , the distribution of @xmath18^\\top$ ] will be multivariate gaussian :    @xmath19    where @xmath20 .",
    "conditional on * f * , we have a gaussian observation model given by :    @xmath21    where @xmath22 parametrises noise .",
    "gaussian distribution conjugacy allows us to marginalise out @xmath23 to find the distribution :    @xmath24    and conditioning on the training data yields the following predictive distribution @xmath25 for an unseen test datapoint * x * * :    @xmath26    where @xmath20 , @xmath27 $ ] and @xmath28 .",
    "this methodology combines prior knowledge over @xmath29 , encoded in the covariance function @xmath30 , with observation data to produce a posterior distribution for forecasting .    to counter overfitting",
    ", we introduce _",
    "k_-fold cross - validation , a model validation methodology that involves partitioning the original training set into _",
    "k _ complementary subsets .",
    "we then train the model on _",
    "k-1 _ subsets and test it on the one remaining subset . after rotating through the _ k",
    "_ choices for this validation set , the results are averaged across all tests and provide insight into the model s ability to generalise well . we apply 10-fold cross - validation to determine the optimal covariance function for our dataset from a range of options ( squared exponential , rational quadratic , matrn 1/2 , matrn 3/2 and matrn 5/2 ; rasmussen and williams , 2006 ) , and settle on the matrn 3/2 kernel , a once - differentiable function exhibiting the low smoothness typical of financial time series .",
    "@xmath31    the covariance function above employs an isotropic manhattan norm as the similarity measure between two vectors in input space .",
    "this assumes that a single , global characteristic length scale _",
    "l _ can appropriately evaluate proximity in all input dimensions .",
    "even with all inputs normalised to the same scale during pre - processing , it is likely that they will contain varying levels of information on the output variable , motivating the use of input - specific characteristic length scales .    in ard kernels , the scalar input length scale _",
    "l _ of equation ( 14 ) is replaced with a vector input length scale with a different _ @xmath32 _ for each input dimension _",
    "i _ , allowing for different distance measures . these hyperparameters will adapt to any given dataset : inputs with large length scales cause only marginal variations in the covariance function , whereas inputs with small length scales effectively magnify those variations .",
    "we can therefore define the relevance score of each feature to be the reciprocal of its input length scale , and rank the salience of inputs by descending relevance .",
    "@xmath33    ard algorithms have been successfully used in research ranging from bioinformatics ( campbell and tipping , 2002 ) to seismography ( oh et al . , 2008 ) , providing an effective tool for pruning large numbers of irrelevant features .",
    "a limitation of the methodology as presented is that the relevance scores only provide a relative ranking between the features of a model .",
    "two equally meaningless inputs will have relevance scores of similar magnitude , as would two equally meaningful features . on their own ,",
    "these scores provide little basis for performing dimensionality reduction . to overcome this",
    ", we include in each regression a baseline feature composed of standard gaussian noise .",
    "we assert that a meaningful input should have a relevance score that is at least two orders of magnitude greater than noise , so by computing the relevance ratio we can determine which features are objectively informative .",
    "in this section we outline the findings of our analysis .",
    "we begin by discovering relevance hierarchies in the data using ard , before proceeding with model testing and benchmarking .",
    "model performance metrics were derived using market data from jan-13 to dec-14 for training and jan-15 to apr-15 for testing .",
    "the price history of the s&p500 index for this period is provided in figure 1 .",
    "we begin by running a correlation analysis on each feature of the training set , grouped by domain and collect the findings in table 1 . in most cases ,",
    "rank correlations are stronger than linear correlations , though the variations are too marginal to alter the analysis . for brevity , in all ensuing sections",
    "we have adopted the linear definition of correlation .",
    "we next outline a methodology for determining whether an observed sample correlation is significant . given two independent random variables @xmath35 and _ y _ of length _",
    "n _ with sample correlation _ r _ , the statistic    @xmath36    is t - distributed with _",
    "n-2 _ degrees of freedom .",
    "values for the _ ( r , n ) _ pair that land outside the 95% confidence interval of the t - distribution violate the null hypothesis of independence , providing a methodology via the student s t - test for identifying significant correlations in a dataset .",
    "p - values are derived from t - distribution tables and measure the probability that uncorrelated sample data will yield a t - statistic as or more extreme than the value of _ t _ obtained from equation ( 17 ) .",
    "common significance thresholds are p - values of 0.05 or 0.01 . applying t - tests to our dataset , every domain apart from broker recommendations held at least one feature bearing significant correlation with next - day returns , signalled by p - values under 0.05 in table 1 .",
    "the use of 4 distinct domains stemmed from the belief that , by virtue of tracking different market agents , these datasets will exhibit low correlation with each other and therefore enhance the predictive power of a combined model . in table 2",
    "we measure the correlation between input pairs in the training set , and find indeed that _ intra - domain _ correlations are generally stronger than _ inter - domain _ correlations , inspiring the pursuit of information gain across diverse , heterogeneous datasets .      using training data from jan-13 to dec-14",
    ", we implement separate gaussian process regressions for each data domain using the matrn 3/2 ard kernel .",
    "this allows both a ranking of feature relevance within each domain , and bivariate visualisations of the mean surfaces learned from the two top - ranked features in each model .",
    "relevance is ranked on the basis of relevance score and relevance ratio defined in equations ( 15 ) and ( 16 ) respectively , with results for market technicals provided in table 3 .    whilst the macd - derived signal line and previous day s return explained little of the variation in output , the 50-day simple moving average was salient , as was the macd .",
    "figure 2 provides a heatmap of return variation based on the two top features of the technical domain , macd and 50dma(t ) , indexed by percentile score . as a first approximation , macd and next - day returns move inversely : cheapness with respect to recent history correlates with next - day gains .",
    "table 4 provides an analysis of sentiment feature relevance .",
    "stocktwits sentiment data is significantly more informative than twitter data , to the point where the twitter feature is irrelevant and can be discarded . as a social media site focused on finance , it is likely that stocktwits s polarity reflects solely market sentiment , whereas twitter s captures public opinion on a wide range of market - irrelevant issues ( celebrity gossip , local politics ) .",
    "the 1-day change variables were also meaningless and can be discarded from subsequent analysis .",
    "notably , the mean function learned through gp regression calls into question the wisdom of crowds : as figure 3 indicates , optimism on stocktwits foreshadows broad market declines , and conversely .",
    "sentiment analysis lends credence to the warren buffett adage : `` be greedy when others are fearful , fearful when others are greedy . ''",
    "relevance for options - derived metrics is provided in table 5 .",
    "directionality and viscosity were almost equally relevant , with positive directionality - that is , experts pre - positioning for rallies via call options - anticipating positive next - day returns .",
    "viscosity instead tracked areas of return compression , and acted as a form of friction .",
    "this manifests in figure 4 as areas of peak return coinciding with high directionality and low viscosity .",
    "the relevance of broker actions is assessed in table 6 .",
    "broker upgrades and downgrades are infrequent occurrences , resulting in a sparse broker change input .",
    "the matrn 3/2 kernel is capable of learning the non - smooth behaviour exhibited in figure 5 , but with relevance metrics indistinguishable from gaussian noise , it is unlikely this domain will provide meaningful improvements to a combined model .",
    "this suggests that analyst opinions have little predictive power , and merely reflect market changes after they ve occurred .    retaining only the salient features",
    ", we run a high - dimensional gaussian process regression on relevant inputs from all domains simultaneously .",
    "the results , compiled in table 7 , broadly mirror our expectations from the correlation analysis , highlighting the ard framework s ability to discover structure in the data .",
    "having established a method for identifying salient features , we now turn our attention to the predictive performance of ard gaussian processes using each data domain .",
    "we separately test the predictive value of each domain before fusing them into a combined model , and measure performance according to the pearson correlation between forecasts and observations , median absolute deviation and normalised root mean square error , where the normalisation constant is the standard deviation of the observations . the results are provided in table 8 .",
    "the model registers monotonic improvements in performance when additional features are included , with the options market data providing the greatest gain .",
    "moreover , it strictly outperforms traditional financial models such as look - ahead ar processes on measures of ground - truth correlation and nrmse .",
    "benchmark performance levels are included in table 9",
    ".    over timeframes much larger than our study s 28-month window , supervised batch algorithms in finance run the risk of failing to recognise significant changes in the landscape fast enough .",
    "for example , stocktwits sentiment s relevance would have been very low when the site was launched in 2009 , and grew in tandem with the size of its user base . a solution to",
    "this challenge involves adaptively learning the kernel hyperparameters from recent history only , removing the impact of old , potentially irrelevant data .",
    "the evolution from offline to online , adaptive learning follows straightforwardly : we define a window _ w _ over which to train an adaptive ard gaussian process for next - day predictions .",
    "rolling the window forward , we generate forecasts for each day in our test set using the optimally combined feature set , and measure model performance as before .",
    "performance metrics for the adaptive ard gaussian process model are included in table 10 .",
    "predictive performance dips to impractical levels below the @xmath37 threshold corresponding to one full year s data , highlighting the need for a critical mass of data for gaussian process regression and hinting at seasonal variance in stock market returns , in line with a long history of empirical studies on the topic of annual cyclicality ( lakonishok and smidt , 1989 ; agrawal and tandon , 1994 ) .",
    "factoring in correlation and mean absolute deviation measures , the best adaptive performance was obtained using exactly one full year of the most recent data .    in table 10",
    "we provide performance metrics on benchmark adaptive models such as one - step - ahead ar and autoregressive kalman filters with varying lags , and find the adaptive ard gp yields both superior results and the benefit of automatic , interpretable feature selection .",
    "extracting information from multiple domains presents the dual challenge of identifying both what to pick and how to mix .",
    "our results provide a principled framework for reducing input dimensionality through iterative ard gp regression .",
    "we show measurable gains in predictive performance from fusing multiple data streams together in an online setting , and draw particular attention to the relevance of options market data and the implicitly inhomogeneous representation of price space . as an untapped , feature - rich , strike - dependent dataset shaped by the interactions of informed players",
    ", options market salience provides a strong mandate for further research into data - driven modelling of price space and its implications for financial forecasting ."
  ],
  "abstract_text": [
    "<S> financial markets are notoriously complex environments , presenting vast amounts of noisy , yet potentially informative data . </S>",
    "<S> we consider the problem of forecasting financial time series from a wide range of information sources using online gaussian processes with automatic relevance determination ( ard ) kernels . </S>",
    "<S> we measure the performance gain , quantified in terms of normalised root mean square error ( nrmse ) , median absolute deviation ( mad ) and pearson correlation , from fusing each of four separate data domains : time series technicals , sentiment analysis , options market data and broker recommendations . </S>",
    "<S> we show evidence that ard kernels produce meaningful feature rankings that help retain salient inputs and reduce input dimensionality , providing a framework for sifting through financial complexity . </S>",
    "<S> we measure the performance gain from fusing each domain s heterogeneous data streams into a single probabilistic model . </S>",
    "<S> in particular our findings highlight the critical value of options data in mapping out the curvature of price space and inspire an intuitive , novel direction for research in financial prediction . </S>"
  ]
}