{
  "article_text": [
    "a main focus in computational anatomy is to study the shape of anatomical objects . performing statistical analysis of anatomical objects is however challenging due to the non - linear nature of shape spaces .",
    "the established statistical theory for euclidean data does not directly allow us to answer questions like : how does a treatment affect the deformation of an organ ? or : is it possible to categorize sick and healthy patients based on the shape of the subject s organs ?",
    "shape spaces are typically non - linear and often equipped with manifold structure .",
    "examples of manifold - valued shape data include landmarks , curves , surfaces , and images with warp variation .",
    "the lack of vector space structure for manifold - valued data implies that addition and scalar multiplication are not defined .",
    "several concepts in statistics rely on addition and scalar multiplication , these including mean value , variance , and regression models .",
    "hence , in order to make inference on manifold - valued data , generalization of euclidean statistical theory is necessary .",
    "this paper focuses on generalization of regression models to manifolds .",
    "the aim is to model the relation between euclidean explanatory variables and a manifold - valued response .",
    "the regression model has , as an example , applications in computational anatomy  @xcite .",
    "the proposed model can for example be used to analyze how age affects the shape of corpus callosum  @xcite .",
    "several approaches have previously been proposed for defining normal distributions on manifolds  @xcite . in @xcite ,",
    "the distribution is defined based on brownian motions in @xmath0 and the fact that normal distributions on @xmath0 can be defined as transition distributions of brownian motions .",
    "the normal distribution on the manifold is then defined as the transition distribution of the stochastic development of the euclidean brownian motion  @xcite .",
    "the proposed regression model will be defined in a similar manner .",
    "the construction can be considered intrinsic as it only depends on the connection of the manifold , e.g. the levi - civita connection of a riemannian manifold .",
    "it does not rely on linearization of the manifold , and it naturally includes the effect of curvature in the mapping of the stochastic processes .    in euclidean linear regression , the relation between explanatory variables , @xmath1 , and a response variable , @xmath2 ,",
    "is modeled by an affine function of @xmath1 , @xmath3 due to the lack of vector space structure , alternatives for modeling relations between the given variables , @xmath1 and @xmath2 , are needed in the non - linear situation .",
    "several ideas have previously been introduced and a selection of these will be described in section [ sec : background ] .    in this paper ,",
    "the regression model is considered as a transported linear regression defined in @xmath0 .",
    "this approach is inspired by the transport of normal distributions defined in  @xcite .",
    "notice that the linear regression model @xmath4 can be generalized to situations in which several observations are observed over time , @xmath5 .",
    "\\label{treg}\\end{aligned}\\ ] ] our approach suggests to define the regression model by transportation of stochastic processes , @xmath6 , in @xmath0 on to the manifold in order to obtain the relation to the response variable , @xmath2 ( see figure [ fig : model ] ) .",
    "the paper will be structured as follows . in section [ sec :",
    "background ] , we give a discussion on previous methods developed for regression on manifolds . section [ sec : dev ] presents a short description of development of stochastic paths from a euclidean space to the manifold .",
    "section [ sec::mod ] introduces the proposed model , followed by a description of the estimation procedure in section [ sec : est ] . in section",
    "[ sec : sim ] and [ sec : datex ] , illustrative examples are considered for the application and performance of the model . the paper is ended by a discussion of the defined model in section [ sec : dis ] .",
    "multiple approaches have been proposed for generalizing regression models to non - linear manifolds .",
    "the methods consider the regression problem in different situations . in this paper",
    "we will consider the case of euclidean exaplanatory variables and a manifold - valued response .",
    "there have been several works describing regression models for manifold - valued data in other situations  @xcite .",
    "regression models for describing the relation between a manifold - valued response and euclidean explanatory variables have also previously been introduced .",
    "examples include @xcite in which an extrinsic regression model is introduced , and @xcite , which defines an intrinsic regression model where the parameter vector is estimated by minimizing the total sum of squares based on the riemannian manifold distance .",
    "another example is the geodesic regression model introduced in @xcite , which is a generalization of the linear regression model in euclidean spaces .",
    "the relation is here modeled by a geodesic described by an initial velocity dependent on an explanatory variable and a starting point on the manifold . in this paper",
    ", we will take a different view on how to relate the response and explanatory variables . instead of considering the relation as being modeled by geodesics on the manifold as in @xcite",
    ", we will describe the relation by stochastic paths transported from the space of explanatory variables to the manifold . by defining the regression model using stochastic paths , we are able to model non - geodesic relations , incorporate several explanatory variables , and consider random effects in the model .",
    "non - geodesic relations have been considered by others before .",
    "an example is  @xcite in which the geodesic regression model from  @xcite is generalized in order to model more complex shape changes .",
    "the regression function is in this case fitted by piecewise cubic splines that describes the variation of one explanatory variable . in  @xcite ,",
    "a regression model is introduced , in which the non - geodesic relation is obtained by time - warping .",
    "others have proposed to model the non - geodesic relation by either a generalized polynomial regression model or by non - linear kernel - based regression  @xcite . on the contrary",
    ",  @xcite introduces the hierarchical geodesic model which are able to consider several explanatory variables including random variables , but assumes nested observations and does only consider geodesic relations . a regression model , which incorporates both a non - geodesic relation and several explanatory variables , is proposed in  @xcite .",
    "this work defines an intrinsic regression model on riemannian symmetric spaces , in which the regression function is obtained by minimizing the conditional mean of residuals defined by the log - map .",
    "in addition to describing the proposed model , we perform estimation of model parameters by maximum likelihood using the transition density on the manifold .",
    "the model does not linearize the manifold as in many of the local regression models , but instead take into account the curvature of the manifold at each point as encoded in the connection through the mapping of the stochastic process .",
    "in this section we give a brief description of stochastic development of curves in @xmath0 to the manifold .",
    "the reader is referred to  @xcite for a deeper description of this concept .",
    "let @xmath7 be a @xmath8-dimensional manifold provided with a connection @xmath9 and metric @xmath10 .",
    "the connection is necessary for transportation of tangent vectors along curves on the manifold .",
    "a frequently used connection is the levi - civita connection coming from a riemannian structure on @xmath11 .",
    "let @xmath12 for @xmath13 denote a coordinate frame on @xmath11 and let @xmath14 be the corresponding dual frame .",
    "a connection @xmath9 is given in terms of its christoffel symbols defined by @xmath15 .",
    "for the levi - civita connection , the christoffel symbols are given by @xmath16 in which @xmath17 is the components of @xmath10 in the coordinate basis ,",
    "i.e. @xmath18 , and @xmath19 is the inverse components . consider the frame bundle @xmath20 being the set of tuples @xmath21 in which @xmath22 and @xmath23 is a frame for the tangent space @xmath24 .",
    "let @xmath25 be the projection map given by @xmath26 for @xmath27 .",
    "a smooth curve @xmath28 on @xmath29 is a smooth selection of frames , i.e. for every @xmath30 , @xmath31 in which @xmath32 is a frame .",
    "given a connection @xmath9 , the tangent space of the frame bundle , @xmath33 , splits into a horizontal and a vertical part , @xmath34 .",
    "the horizontal subspace explains infinitesimal changes of the base point on the manifold . on the other hand ,",
    "tangent vectors in @xmath35 describe changes of the frame @xmath23 keeping the base point fixed . given a tangent vector @xmath36 and a frame @xmath23 , a vector in @xmath37 can be defined by horizontal lift .",
    "the horizontal lift of a tangent vector @xmath38 is the unique horizontal vector @xmath39 , satisfying @xmath40 , where @xmath41 is induced by the projection @xmath42 .",
    "the horizontal lift of @xmath38 will be denoted @xmath43 .",
    "consider a probability space @xmath44 and a stochastic process @xmath45 , where @xmath46 denotes the path space of @xmath0 .",
    "the stochastic development of @xmath47 to @xmath29 can be defined as a solution , @xmath28 , of the stratonovich stochastic differential equation , @xmath48 where @xmath49 symbolizes a stratonovich stochastic differential equation .",
    "the vector fields @xmath50 denotes a basis for the horizontal subspace of @xmath33 .",
    "given a point @xmath51 , @xmath52 are defined as @xmath53 , where @xmath54 is the canonical basis for @xmath55 .",
    "a path @xmath56 on the manifold @xmath11 can then be obtained by the projection of @xmath28 onto @xmath11 by the projection map @xmath42 , i.e. @xmath57 .    consider two processes @xmath58 in @xmath0 , @xmath59 $ ] for @xmath60 , for which @xmath61 and @xmath62 . if @xmath63 , @xmath64 denotes the stochastic development of @xmath65 and @xmath66 respectively on @xmath7 , then it does not in general hold that @xmath67 on @xmath11 due to the curvature of the manifold .",
    "let @xmath11 be a @xmath8-dimensional manifold embedded in the ambient space @xmath68 for some @xmath69 and consider a response variable @xmath70 in @xmath11 .",
    "let @xmath71 be a frame for the tangent space at a reference point @xmath72 .",
    "assume that @xmath73 are @xmath74 realizations of @xmath22 and let @xmath75 denote the vector of explanatory variables for the @xmath76th observation .",
    "notice that the realizations of @xmath70 are assumed to lie in the ambient space @xmath68 and not required to be in @xmath11 .",
    "this construction allows for observations measured with noise which are not necessarily observed as elements of @xmath11 .",
    "the strategy of the proposed model is to define stochastic processes according to the generalized linear regression in @xmath77 and transport these to the manifold by stochastic development .",
    "all stochastic processes are defined for @xmath59 $ ] for a @xmath60 .",
    "consider for each observation @xmath76 the stochastic process @xmath78 , solution to the stochastic differential equation , @xmath79 the first term , @xmath80 , is a fixed drift for @xmath81 .",
    "@xmath82 is the dependence of the explanatory variables with @xmath83 being a stochastic process satisfying @xmath84 and @xmath85 for @xmath86 .",
    "the matrix @xmath87 is a @xmath88-dimensional matrix with columns relating to the basis vectors of the frame @xmath89 on @xmath11 .",
    "consider the matrix @xmath90 with columns consisting of basis vectors of @xmath89 . if @xmath11 has a riemannian metric , then @xmath91 , in which @xmath92 denotes a @xmath93 orthonormal matrix with respect to the metric .",
    "notice that this model can incorporate both fixed and random explanatory variables .",
    "if the @xmath94th explanatory variable , @xmath95 , is a random effect , @xmath96 is modeled as a brownian bridge , while it for fixed effects are modeled as a constant drift .",
    "the random error , @xmath97 , is modeled as a multidimensional brownian motion on @xmath0 .",
    "the @xmath76th observation @xmath98 is modeled as a noisy endpoint of the stochastic development of @xmath99 . if @xmath100 only a reduced frame @xmath101 is used for the stochastic development of @xmath99 .",
    "the reduced frame is considered as we are only interested in the effect of frame vectors associated to the explanatory variables .",
    "the basis vectors of @xmath101 corresponds to the columns of @xmath90 .",
    "given the reference point @xmath72 , define stochastic processes @xmath102 as the stochastic development of @xmath103 .",
    "let @xmath104 be a random variable following the distribution of endpoints of the stochastic development @xmath102 .",
    "then @xmath105 where @xmath106 represents the random measurement error that pulls the realization , @xmath98 , from the manifold . in figure",
    "[ fig : linfig ] , the two steps of the model are illustrated .",
    "first , the stochastic development of @xmath99 are defined on the frame bundle and finally , this stochastic development is projected to the manifold .",
    "notice that in the case @xmath107 with the standard connection on @xmath68 , the proposed model reduces to the regular regression model for data in @xmath68 .",
    "assume @xmath108 and that @xmath109 is a vector from @xmath110 to @xmath111 .",
    "then @xmath112 and @xmath113 relates to the intercept , @xmath90 is the matrix of regression coefficients and @xmath97 and @xmath114 the iid . random noise .",
    "the reference point @xmath113 , the matrix @xmath90 , the drift @xmath112 , and the variance parameter @xmath115 are the parameters of the model .",
    "these parameters can be estimated in several ways .",
    "this section describes a laplace approximation of the marginal likelihood function which are used for finding optimal parameter estimates .",
    "we could alternatively use a monte carlo em based procedure using simulations of the missing data , @xmath116 for @xmath59 $ ] , to optimize the complete data likelihood .",
    "this will be considered in future works .",
    "laplace approximation can be used to determine a linear approximation of a non - linear likelihood function  @xcite .",
    "let @xmath117 denote the vector of parameters , and @xmath118 a discretization of the process @xmath47 at @xmath119 time - points .",
    "hence @xmath118 is a vector of length @xmath120 , in which @xmath121 denotes the number of time steps , @xmath74 the number of observations , and @xmath122 the number of explanatory variables .",
    "let @xmath123 be the conditional density of the response @xmath22 given @xmath117 and @xmath124 the density of the discretization of @xmath47 given @xmath117 .",
    "to find the optimal parameter vector , @xmath117 , the following likelihood has to be optimized , @xmath125 where @xmath126 . the laplace approximation of @xmath127 is then given by @xmath128 in which @xmath129 and @xmath130 , the inverse of the hessian of @xmath131 .",
    "the approximated likelihood is then optimized wrt .",
    "@xmath117 to obtain the estimated parameters . in the following simulation study ,",
    "the laplace approximation is used for parameter estimation .",
    "the code for the estimation algorithm as well as the simulation study below was implemented in theano  @xcite .",
    "the code is available at https://bitbucket.org/stefansommer/theanodiffgeom .",
    "this section investigates properties of the model on simulated synthetic data .",
    "two setups will be introduced , both considering landmark representations of shapes .",
    "the data are assumed to lie in a manifold defined in the lddmm ( large deformation diffeomorphic metric mapping ) framework  @xcite .    in the lddmm framework ,",
    "deformations of shapes are modeled as smooth flows which are solutions to ordinary differential equations defined by vector fields .",
    "a point @xmath132 is a finite number of landmarks , @xmath133 .",
    "the metric on @xmath11 is given by @xmath134 , where @xmath135 denotes the inverse of a kernel @xmath136 .",
    "in this simulation study @xmath136 is the gaussian kernel with standard deviation , @xmath137 .",
    "based on this metric the levi - civita connection can be obtained by calculating the christoffel symbols defined in @xmath138 .    to begin with , we consider estimation of @xmath87 and @xmath113 and investigate the performance of the estimation procedure . the shapes that will be considered consists of @xmath139 landmarks generated from the unit circle with landmarks located at @xmath140 radians .",
    "the center plot of figure [ fig : simcirc ] shows the unit circle with the chosen frame for each landmark .",
    "the number of explanatory variables are set to @xmath141 and the variables are drawn from a normal distribution with mean @xmath110 and standard deviation @xmath142 .",
    "the other parameters are set to @xmath143    in figure [ fig : simcirc ] is shown an example of simulated observations as well as the sample paths @xmath109 .",
    "a total of 50 datasets were sampled , in which each consisted of 20 observations . for each simulated dataset",
    ", the @xmath87 matrix was estimated .",
    "each of the estimated distrubtions for the entries of @xmath87 are shown in figure [ fig : densfig ] . by the results ,",
    "we conclude that the estimated parameters are fairly stable between the different simulations and that the true values are well centered in each distribution . for this simulation ,",
    "the estimation procedure is thus able to estimate the true @xmath87 parameters that were specified in the model .",
    "three similar datasets , as explained above , were sampled with different number of observations , 20 , 60 and 100 respectively .",
    "the matrix @xmath87 as well as the reference point @xmath113 were estimated for each of the three datasets . in this case , the estimated @xmath87 matrix was found to be @xmath144 while the estimated reference points are shown in figure [ fig : refcirc ] . by increasing the number of observations , we conclude that the estimated parameters @xmath87 and @xmath113 converge towards the true parameters .    in the second study",
    ", we consider the problem of estimating the frame matrix @xmath92 . in this case , each observation consists of 3 landmarks that were generated from a setup shown in figure [ fig : vec ] .",
    "we only consider one explanatory variable , meaning that only one frame vector has to be estimated for each landmark .",
    "the true frame vectors for each landmark was set to a vertical unit vector . in the estimation procedure",
    ", the frame vectors were initialized with the euclidean linear regression estimate . in figure",
    "[ fig : vec ] is shown the true ( red ) , the initial ( green ) and the estimated frame ( blue ) for each landmark .",
    "the estimation procedure converges to a good estimate of the true frame .",
    "estimation of the initial frame was considered for different number of observations , but the estimated frame did not seem to converge for increasing number of observations . the difference in the parameter estimates might therefore be a result of either the linear approximation of the likelihood or that the optimal solution of the initial frame is not unique .",
    "we now apply the model to a real dataset consisting of landmark representations of corpus callosum ( cc ) shapes . the model is used to describe the effect of age on cc shapes .",
    "the manifold considered is the same as that introduced in section [ sec : sim ] , but in this case @xmath145 .",
    "again the levi - civita connection is used .",
    "a subset of the cc dataset is plotted in figure [ fig : ccframe ] . for model",
    "fitting , a dataset of @xmath146 cc shapes was considered with age values ranging from @xmath147 to @xmath148 .",
    "the model was fitted to cc shapes represented by a subset of @xmath146 landmarks .",
    "we did not incorporate a drift term in the model , and only the frame and @xmath87 has been estimated .",
    "the refrence point was set to the mean shape ( figure [ fig : ccframe ] ) and @xmath149 .",
    "the estimated frame for the @xmath146 landmarks are shown in figure [ fig : ccframe ] on top of the mean shape .",
    "the weight matrix was estimated as @xmath150 . given the low estimate of @xmath87 and hence a small frame matrix @xmath90",
    ", the result of this experiment suggests a low age effect on cc for these data .",
    "a method was proposed for modeling the relation between a manifold - valued response and euclidean explanatory variables .",
    "the relation was modeled by transport of stochastic paths from @xmath0 to the manifold .",
    "the stochastic paths defined on @xmath0 was given as solutions to a stochastic differential equation with a contribution from a fixed drift , a stochastic process related to the explanatory variables , and a random noise assumed to follow a multidimensional brownian motion .",
    "the response variable was then modeled as a noisy observation of a stochastic variable following the distribution of the endpoints of the transported process .",
    "the proposed model is intrinsic and based on a connection on the manifold without making linearization of the non - linear space .",
    "moreover , a likelihood based estimation procedure were described using laplace approximation of the marginal likelihood .",
    "we experimentally illustrated the model and the parameter estimation using a simulation study and a real data example .",
    "other procedures could be used for estimation of parameters . as an example",
    ", the monte carlo em procedure could be used to optimize the complete data likelihood based on simulations of the missing data .",
    "another example is to approximate the distribution of the response by moment matching .",
    "an interesting problem to investigate is how to make variable selection in the model . as the contribution from the explanatory variables",
    "is defined in comparison with the frame basis vectors , one idea is to exclude those explanatory variables which corresponds to frame vectors parallel to the curve .",
    "these frame vectors will not contribute to the stochastic development and hence will not be important for explaining the relation to the response variable .",
    "an important assumption of the manifold considered , is that the manifold is equipped with a connection . in this paper ,",
    "the levi - civita connection was used , but several other connections could have been chosen .",
    "it would be interesting to explore how the choice of connection affects the model .",
    "as it is possible to transport stochastic paths from a manifold to a euclidean space , the model could be generalized to handle situations in which a euclidean response variable is compared to manifold - valued explanatory variables .",
    "based on such a model , one might be able to make categorization of individuals based on manifold - valued shapes ."
  ],
  "abstract_text": [
    "<S> we introduce a regression model for data on non - linear manifolds . </S>",
    "<S> the model describes the relation between a set of manifold valued observations , such as shapes of anatomical objects , and euclidean explanatory variables . </S>",
    "<S> the approach is based on stochastic development of euclidean diffusion processes to the manifold . defining the data distribution as the transition distribution of the mapped stochastic process , parameters of the model , the non - linear analogue of design matrix and intercept , </S>",
    "<S> are found via maximum likelihood . </S>",
    "<S> the model is intrinsically related to the geometry encoded in the connection of the manifold . </S>",
    "<S> we propose an estimation procedure which applies the laplace approximation of the likelihood function . </S>",
    "<S> a simulation study of the performance of the model is performed and the model is applied to a real dataset of corpus callosum shapes .    , statistics on manifolds , non - linear statistics , frame bundle , stochastic development </S>"
  ]
}