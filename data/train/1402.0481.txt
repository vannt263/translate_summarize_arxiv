{
  "article_text": [
    "since the invention of the laser , a lot of effort has been put into manipulating optical pulses for applications in science and engineering .",
    "one important application is photon - based quantum information processing , which promises unbreakable secret key distribution and unprecedented computational power @xcite .",
    "the realization of these applications requires coherently storing as well as manipulating quantum optical pulses in order to process and distribute quantum information @xcite . combining storage and manipulation in a light - matter interface that can be integrated on - chip with other photonic components reduces the complexity and thus facilitates the development of future quantum technologies @xcite . to date",
    "there have only been a few investigations that employ a quantum storage device for coherent optical pulse manipulation @xcite . however , these demonstrations feature various intrinsic limitations that impact future use in practical settings .",
    "first , all previous demonstrations rely on atomic vapor , making integration difficult .",
    "second , most show limited processing capabilities , which restricts their use to a small number of specific applications @xcite .",
    "third , the bandwidths in @xcite were at most a few mhz , which , accordingly , constraints the minimum duration of the processed pulses to a few microsecond .",
    "finally , the number of simultaneously storable ( and hence processable ) qubits in the quantum storage devices considered before is severely limited @xcite .    in this paper , we propose and demonstrate a universal , large - bandwidth and multimode approach to temporal and spectral manipulation of individual quantum optical pulses  it relies on introducing a broadband quantum memory based on a tm : linbo@xmath0 waveguide and the atomic frequency comb ( afc ) protocol @xcite between two linbo@xmath0 waveguide phase modulators that serve as variable frequency shifters using the serrodyne frequency - translation technique @xcite ( see appendix a7 for more details ) .",
    "reversibly mapping nano - second long pulses of light onto different spectral sections of a multi - section afc ( where each spectral section is programmed to perform a different task ) , we demonstrate sequencing , time - to - frequency multiplexing and demultiplexing , splitting , interfering , temporal and spectral filtering , compressing and stretching as well as on - demand selective delaying .",
    "while the input pulses currently contain on average around 540 photons , our approach straightforwardly applies to the manipulation of individual photons or members of entangled photon pairs , as well as to pulses of light used in classical communications .",
    "for details . ]    our experimental setup , sketched in fig .",
    "[ pulsemanipsetup ] , consists of three main blocks : pulse generation , pulse manipulation , and detection .",
    "the pulse generation block features a continuous wave ( cw ) laser centered at 795.5 nm wavelength and an acousto - optic modulator ( aom ) that is used to carve 12 ns duration pulses ( measured at full width half maximum , fwhm ) from the cw laser light .",
    "these pulses are heavily attenuated down to a mean photon number of @xmath1 photons .",
    "the pulse manipulation block is composed of a tm : linbo@xmath0 waveguide memory ( processor ) maintained at 3.5 k , and two commercial linbo@xmath0 waveguide phase modulators ( controllers ) located at the input and output of the memory and kept at room temperature .",
    "we note that it may be possible to combine these three elements on a single , integrated , cryogenically cooled photonic circuit , allowing a more compact setup .",
    "the detection block contains a silicon avalanche photo diode ( si - apd ) single photon detector ( spd ) , an optical switch that is used to protect the detector from optical pump light while preparing the afc , and a monolithic fabry - perot ( fp ) filter ( not shown in the figure ) used to demonstrate the ability to control the spectra of the retrieved pulses from the memory unit ( this is further explained in appendix a5 ) .",
    "each experimental cycle comprises three stages : afc programming through frequency selective optical pumping ( persistent spectral hole burning ) for which the frequency of the cw laser light is controlled using the phase modulator placed before the memory , waiting to avoid noise from decaying atoms that were excited during the programming of the afc , and sending , manipulating and detecting few - photon pulses .",
    "the durations of these stages are 3 ms , 2.2 ms and 5 ms , respectively .",
    "the efficiency of our afc processor is currently limited to around 1@xmath2 . as is further discussed in section  [ discussion ] , this is mainly due to inefficient optical pumping during the programming stage of the afc . for more details about the implementation , material , afc preparation and measurements see appendix a1-a5 .    in a standard afc memory @xcite",
    ", an inhomogeneously broadened absorption profile is tailored into a series of equally spaced absorption peaks .",
    "photons mapped onto this spectral feature are re - emitted as so - called echoes after a time @xmath3 , and with a phase shift of @xmath4 , where @xmath5 is the spacing between the peaks , and @xmath6 is the detuning between the carrier frequency of the input photons and the frequency of one of the peaks .",
    "with respect to the input . however , this is not the case for the forwards propagating echo as implemented in our experiments . ]",
    "the retrieval process can approach unit efficiency provided that certain phase matching conditions are satisfied and variables such as afc finesse ( i.e. the ratio of the peak spacing to the peak width ) and optical depth are optimum .",
    "the implementation of the afc protocol in cryogenically cooled rare - earth ion doped crystals has already shown great promise as a quantum memory for quantum information processing applications .",
    "examples include high retrieval fidelity @xcite , high efficiency @xcite , large bandwidth @xcite , large temporal and spectral multimode storage capacity @xcite , the possibility to store time - bin and polarization qubits  @xcite plus members of entangled photon pairs @xcite and , recently , the teleportation of photonic quantum states into a crystal @xcite .",
    "when the afc is used for processing tasks , as proposed in this study , the peak spacing in different frequency intervals is typically set to different values , resulting in storage ( re - emission ) times that vary as a function of frequency .",
    "an example of an afc memory programmed as a processor is shown in fig .  [ processor ] .",
    "in this example , the entire bandwidth is divided into six afc segments , each having 200 mhz bandwidth . in each afc segment , the peak spacings are set differently , yielding storage times between 25 ns and 125 ns with 25 ns increments . the right - most segment , prepared by superimposing two afcs , is used to divide a single input pulse into two temporal modes , stored for 40 ns and 65 ns , respectively . using this single re - configurable afc processor ,",
    "multiple processing tasks can be performed , as shown in the following  .          ) and each frequency mode is mapped onto the corresponding afc segment .",
    "this results in each frequency mode being retrieved at a different time , as determined by the programming of the respective afc segment .",
    "this is illustrated in the front trace ( demultiplexing ) with different colours representing the different frequency components .",
    "next , three 25 ns - separated input pulses are prepared with center frequencies that map onto the afc segments with + 200 mhz , -200 mhz and -400 mhz detuning , respectively .",
    "this mapping allows the three recalled pulses to be merged in the same temporal mode , as shown in the back trace ( multiplexing ) . ]",
    "the first example is the re - ordering of pulses in a pulse sequence , which plays an important role in synchronizing and randomly accessing quantum information in quantum repeaters and linear optics quantum computers @xcite . in the standard afc storage scheme , one",
    "is restricted to storing pulses without changing their order , as shown in fig .",
    "[ pulsereordering]a .",
    "to re - order the pulses in this sequence , the controller at the afc memory input applies appropriate frequency shift to each pulse such that the pulses are mapped onto different afc segments , resulting in the retrieved pulse sequence being reversed or arbitrarily re - ordered , as demonstrated in fig .",
    "[ pulsereordering]b and c , respectively .",
    "moreover , the center frequency of each pulse retrieved from the memory unit can be set back to its original value by the output controller , resulting in a pure time - domain manipulation ( see appendix a5 ) .",
    "the next demonstration is time - to - frequency multiplexing and demultiplexing of pulses , which is of potential interest for multiplexed quantum networks .",
    "when input pulses occupying several frequency modes and the same temporal mode are mapped onto the programmed afc processor in fig .  [ processor ] , they are retrieved at different times ( demultiplexing ) as shown in the front trace of fig .",
    "[ multiplexing ] . in the same way",
    ", input pulses occupying different temporal modes can be merged into the same temporal mode ( multiplexing ) by applying the appropriate frequency shift to each input mode as demonstrated in the back trace of fig .",
    "[ multiplexing ] .          splitting a pulse into separate pulses in various spectral and temporal modes is another manipulation that is possible using our processor ; it allows generating high - dimensional quantum states . to demonstrate this feature , three temporal portions of an input pulse",
    "are mapped onto different afc processor segments using the input controller .",
    "consequently , each portion of the original pulse is retrieved in a different spectro - temporal mode , as shown in fig .",
    "[ pulsesplit ] .",
    "we note that it is also possible to recover the input pulse by re - processing each generated component in a subsequent system .",
    "it is straightforward to generate and manipulate time - bin qubits using our integrated processing unit , as previously demonstrated in  @xcite . in the programmed afc processor shown in fig .",
    "[ processor ] , the last segment at + 800 mhz detuning is prepared by superimposing two afcs ( double afc ) with different comb tooth spacings ( see fig .  [",
    "doublegrating]a ) . when an input pulse in a well defined temporal mode is mapped onto this afc segment ,",
    "it is re - emitted in a superposition of two temporal modes with a relative phase of @xmath7 , where @xmath8 and @xmath9 are the phase shifts introduced by each comb of the double afc .",
    "thus , this afc processor segment can be used to generate any time - bin qubit state , as exemplified in fig .",
    "[ doublegrating]b .    )",
    "is prepared by superimposing two afcs ( double afc ) with two different comb spacings , leading to 40 ns and 65 ns storage times . *",
    "( b ) * an input photon , occupying a well - defined temporal mode , is mapped to the double afc .",
    "it is re - emitted in a superposition of two temporal modes ( time bins ) , referred to as `` early '' and `` late '' .",
    "* ( c ) * storing a superposition time - bin qubit state with temporal modes separated by 25 ns ( equal to the difference between the re - emission times of the superimposed afcs ) leads to the early and late input modes being overlapped in a central temporal mode after recall ( see text for details ) .",
    "this allows performing any projection measurement onto time - bin qubit states .",
    "in the measurements represented in ( c ) , input states @xmath10 ( front trace ) and @xmath11 ( back trace ) , where @xmath12 and @xmath13 denote the quantum state of a photon occupying the early and late temporal mode , respectively , are stored in a double afc that projects onto @xmath14 .",
    "this results in destructive and ( partially ) constructive interference in the central temporal mode , respectively . ]",
    "if a single photon pulse in a superposition of two temporal modes is mapped onto the afc segment , the photon will be re - emitted , in general , in a superposition of four temporal modes , each defined by the re - emission times of the combs and the separation of the input temporal modes . in this case",
    ", adjusting the difference between the emission times to the temporal separation of the two input modes leads to overlap between the two central temporal modes into a single mode , as shown in fig .",
    "[ doublegrating]c . in this way , it is possible to project a time - bin qubit onto an arbitrary state @xcite , which resembles the use of an imbalanced mach - zender interferometer .",
    "furthermore , applying the same idea used for time - to - frequency multiplexing ( demonstrated in sec .",
    "[ ftmd ] ) , our system can easily convert a time - bin qubit to a frequency - bin qubit , which can be further manipulated using the output controller .",
    "these schemes could be useful for quantum communication protocols relying on frequency and time - bin encoding .",
    "represents the duration of the input and transmitted pulse at fwhm . * ( c ) * an input pulse with nearly 70 mhz bandwidth is mapped onto an afc segment prepared with 600 mhz bandwidth and retrieved after 50 ns ( dashed line ) .",
    "an input pulse with the same bandwidth is mapped to an afc with a bandwidth decreased to about 40 mhz . in this case",
    "the afc acts as bandpass filter , yielding an output pulse with nearly twice the duration . ]",
    "our processor can also be used as a reconfigurable temporal and spectral filter .",
    "for example , this would allow tailoring single photons or matching the spectral and temporal properties of photons produced from independent sources for applications relying on two - photon interference . as opposed to the task described in the next section",
    ", filtering obviously leads to loss of photons . to demonstrate the temporal shaping capability ,",
    "an afc having a bandwidth of 600 mhz and centered at + 700 mhz detuning is programmed .",
    "a 12 ns long input pulse is sent to the processing unit .",
    "if the input controller is not engaged , it remains at 0 mhz detuning and the pulse is directly transmitted as it has no spectral overlap with the afc .",
    "however , if the input controller is engaged , the selected temporal portion ( or portions ) of the incoming pulse is ( are ) mapped onto the afc , resulting in a temporally shaped recalled pulse as shown in fig .",
    "[ pulseshaping]a .",
    "using this idea , it is also possible to carve a narrow temporal portion from an input pulse , i.e. to generate a short pulse from a long one , as demonstrated in fig .",
    "[ pulseshaping]b .",
    "furthermore , the capability of continuously adjusting the serrodyne modulation efficiency ( see appendix a7 ) allows for arbitrary modulation of the temporal shape and intensity of an input pulse , which turns our implementation into an arbitrary optical waveform generator @xcite .    to demonstrate the spectral filtering capability , the bandwidth of the afc",
    "is decreased to about 40 mhz .",
    "an input pulse with 70 mhz bandwidth is mapped onto this afc using the input controller .",
    "the portion of the pulse spectrum that lies outside the afc is filtered out ( by being partially directly transmitted and absorbed ) and the recalled pulse is emitted with smaller bandwidth and thus longer duration , see fig .",
    "[ pulseshaping]c .     ns / mhz . *",
    "( b ) * using the input phase modulator , the frequency of an incoming pulse is linearly chirped from high to low at a rate of 8.3  mhz / ns , yielding @xmath15 ( close to the optimum condition @xmath16 ) .",
    "when this pulse is mapped onto the programmed afc , a compressed pulse is retrieved with a compression factor of nearly 2.4 , as shown in the front trace .",
    "the middle trace depicts the simulated result after scaling its intensity with respect to the experimentally obtained echo ( see appendix 6) the temporal shapes are in good agreement .",
    "the back trace shows the retrieved pulse after storage using a standard afc with equal tooth spacing .",
    "note that the areas under the experimentally obtained curves for the standard and compressed echoes are nearly equal . *",
    "( c ) * pulse stretching is performed by applying a chirp with the same rate but different sign ( i.e. from low to high frequency ) and different start frequency .",
    "the resulting stretched pulse , the corresponding simulation and the re - emitted pulse from a standard afc are shown in the front , middle and back traces , respectively . ]      compressing and stretching quantum optical pulses is potentially useful for increasing quantum data rates and matching bandwidths of photons to those of quantum memories @xcite .",
    "an afc memory is well suited for this task since it can be tailored to feature almost arbitrary chromatic dispersion , i.e. tailored in such a way that different frequency components of an input pulse are retrieved at different times . to this end",
    ", we program an afc whose peak separation is linearly decreasing across its entire bandwidth ( fig .",
    "[ compression1]a ) . to compress an input pulse",
    ", the input controller chirps the frequency of the pulse linearly from high to low , which disperses the spectrum of the pulse .",
    "when this pulse is mapped onto the afc processor , the pulse front is stored longer than the end of the pulse , leading , under certain conditions , to the retrieval of a temporally compressed pulse as demonstrated in figs .",
    "[ compression1]b and  [ highcompression ] .",
    "note that the output controller can be used to remove the frequency chirp in the retrieved pulse by applying a reversed linear chirp with appropriately chosen slope .    for an input pulse having a duration of @xmath17 and an afc prepared with linearly varying peak spacing ,",
    "the compression factor @xmath18 ( defined to be the ratio of the duration of the input pulse to the duration of the compressed output pulse ) is determined by two parameters : the spectral width of the chirped pulse , @xmath19 , which is controlled by the applied chirp rate , @xmath20 , as well as the gradient of the programmed storage times @xmath21 . here , @xmath22 is the difference between the storage times introduced by the afc for the upper frequency end and the lower frequency end of the chirped pulse ( see appendix  a6 for the analysis ) .",
    "note that we assume that the afc width is at least as large as @xmath23 so that the entire chirped pulse is absorbed . for maximum compression of the input pulse , @xmath17 and @xmath22 have to be equal , which is equivalent to satisfying the condition @xmath16 ( this can be achieved using an appropriate chirp - rate setting ) . in this case",
    ", the duration of the output pulse is @xmath24 @xcite , and the compression factor is given by    @xmath25    this equation follows straightforwardly from the definition for the storage time gradient @xmath26 .",
    "hence , we find that , for a given storage material , the compression factor is limited by the maximally achievable storage time ( which determines @xmath22 ) and the storage bandwidth @xmath23 ( i.e. the time - bandwidth product ) .",
    "for instance , in our case , we have @xmath27 100 ns and @xmath28 10 ghz , which allows in principle a compression factor of @xmath291000 .",
    "we note that compression not only occurs if @xmath16 , but , more generally , for @xmath30 ( for more information see appendix 6 ) .    )",
    "is programmed .",
    "the frequency of an input pulse with approximately 30 ns duration is chirped from high to low at a rate of 32.9 mhz / ns , yielding @xmath31 , and mapped onto the programmed afc .",
    "this results in a 2.6 ns long ( fwhm ) echo pulse and a compression factor close to 10 , as shown in the front trace .",
    "the back trace shows the simulated result assuming an input pulse having a gaussian envelope and a similar duration to that of the actual input . ]",
    "pulse stretching can be performed in a similar way by applying the input frequency chirp from low to high . when the chirped pulse is mapped onto an afc with decreasing peak spacing ,",
    "the end of the pulse is stored longer than the front , leading to a temporally stretched pulse of duration @xmath32 ( an example is shown in fig .  [ compression1]c ) .",
    "hence , achieving large stretching requires programming an afc with large @xmath26 , which , as before , is limited by the longest achievable storage time ( i.e. the smallest achievable peak spacing of the afc ) . in addition , the output pulse width increases with the bandwidth @xmath23 of the chirped input pulse .    to finish this section ,",
    "let us emphasize that the described pulse compression and decompression is different from the filtering process discussed in section 2.5 as , in principle , this approach can be carried out without introducing loss .       to obtain a desired delay . to achieve delay times of 25 ns , 50 ns and 75 ns ,",
    "the pulses are mapped onto the segments at -400 mhz , -200 mhz and + 200 mhz detuning , respectively , and are retrieved after the corresponding storage time . *",
    "( b ) *  a 2 ghz - wide afc with linearly decreasing peak spacing from 30 mhz to 10 mhz is programmed .",
    "the frequency of an incoming pulse is linearly chirped from high to low as described in the previous section .",
    "this pulse is mapped onto the programmed afc , resulting in the emission of a compressed pulse with a compression factor of nearly 4 . varying the start frequency of the chirp maps the incoming pulse to different intervals of the afc , which allows selecting the storage time . ]    having afc segments with different peak spacing also allows one to select the storage time on demand without the ( time demanding ) need for re - programming an afc . in our new approach , the input controller maps a pulse to a particular afc segment shown in fig .",
    "[ processor ] to achieve a desired delay , as demonstrated in fig .",
    "[ ondemanddelay]a .",
    "in addition , it is possible to compress the pulses during storage ( as shown in the previous section ) using an afc with continuously varying peak spacing . in this case , changing the start frequency of the chirp additionally allows one to choose non - discretized storage times using appropriate frequency shifts at the input controller , as shown in fig .",
    "[ ondemanddelay]b and further described in appendix 6 . if necessary , the emitted pulse s carrier frequency can be set back to the original frequency using the output controller .",
    "the described feature will be useful for synchronization purposes in quantum communication .",
    "an integrated optical quantum memory is an important element for future quantum communication networks and linear optics quantum computers , and employing it for the manipulation of optical pulses at the quantum level adds another direction to its potential use in quantum information processing applications . in this study",
    ", we have shown that our broadband waveguide quantum memory can be turned into a processing unit for arbitrary temporal and spectral manipulation of nanosecond - long quantum optical light pulses .",
    "although we utilized weak laser pulses at the few photon level , our approach works equally well for laser pulses containing less than one photon on average , true single photons , or members of entangled pairs of photons .",
    "in addition , it can be used for the manipulation of strong pulses of light , as used in classical communications .",
    "the light - matter interface presented in this paper brings several advantages over previous implementations of quantum optical pulse manipulations .",
    "first of all , its waveguide nature allows for integration with other waveguide photonic devices , e.g. currently developed lithium niobate based quantum circuits @xcite , which is important for practical applications .",
    "second , as our processor relies on a large - bandwidth afc memory and large - bandwidth electro - optic frequency shifters , it allows processing of nanosecond , and soon sub - nanosecond pulses .",
    "third , as opposed to other quantum memory approaches  @xcite , the number of simultaneously storable modes in the afc approach does not depend on the optical depth of the used medium @xcite .",
    "hence , our light - matter interface possesses a large multi - mode processing capacity . and finally , it offers a wide range of quantum optical pulse manipulations in a single spatial mode , which makes it attractive for several quantum information processing applications  @xcite .",
    "however , for practical use , the total efficiency of our system ( including processor and controllers ) needs to be increased beyond the current sub - percent level ( for some applications it needs to be close to one ) .",
    "the principal limitation in our current implementation stems from imperfect preparation of the afc , which is mainly due to unfavorable relaxation dynamics in our material at 3.5 k ( see appendix  a3 ) .",
    "more specifically , the residual absorption background of the prepared afcs , which can be seen in fig .  [ processor ] , results in most of the incoming photons to be irreversibly absorbed . however , our recent observations , supplemented by those reported in @xcite , suggest that the relaxation dynamics change considerably when operating at lower temperature ( @xmath33 k ) , and that this background can be eliminated almost entirely .",
    "hence a substantial increase of the efficiency is readily achievable .",
    "in addition , to increase the system efficiency , the coupling efficiencies in and out of the phase modulators and our waveguide quantum memory need to be maximized , for instance through integration of all components on a single chip",
    ". however , to approach unit efficiency , certain not yet fully mastered techniques need to be applied .",
    "one of them requires embedding the afc medium into an impedance matched cavity @xcite that features a resonance width compatible with broadband afcs .",
    "another one is to implement the afc with additional spatial periodicity @xcite .",
    "finally , a third option is to reversibly ( and with appropriate phase - matching ) map the optical coherence that was excited by absorbing a quantum state onto spin states @xcite",
    ".    to conclude , let us note that , while the operation wavelength can not be chosen freely ( it needs to coincide with an atomic transition in a material that allows for persistent hole burning ) , there is nevertheless some flexibility , in particular as no long coherence time is needed . of particular interest are erbium - doped materials @xcite , due to an absorption line at telecommunication ( around 1550 nm ) wavelength .",
    "the authors thank w. sohler , m. george and r. ricken for providing the ti : tm : linbo@xmath0 waveguide , and m. p. hedges , c. simon , j. jin , c. w. thiel and w. r. babbitt for useful discussions and help during the preparation of the manuscript .",
    "this work is supported by alberta innovates technology futures ( aitf ) , the national sciences and engineering research council of canada ( nserc ) , the killam trusts , and the carlsberg foundation .",
    "we use a cryogenically cooled ti : tm : linbo@xmath0 channel waveguide quantum memory as a processor in conjunction with two commercial linbo@xmath0 electro - optic modulators placed before and after the memory .",
    "although in our experiments the linbo@xmath0 phase modulators are outside the cryogenic system and connected to the input and output of the memory by single mode fibers , all components can , in principle , be implemented on a single chip .",
    "this can be achieved by fabricating a long linbo@xmath0 channel waveguide with thulium atoms doped only into the central part , and electrodes deposited at the beginning and end of the waveguide .",
    "note that phase modulators similar to ours can be operated at cryogenic temperature @xcite .",
    "the fabrication of the tm : linbo@xmath0 waveguide and basic spectroscopic properties of tm atoms in this material have already been reported @xcite .",
    "the waveguide used in the experiments is 10.4 mm long and 3.5 @xmath26 m in diameter .",
    "the light is butt - coupled into and out of the waveguide using single mode fibers .",
    "end - to - end transmission is about 20@xmath2 .",
    "the crystal temperature is kept around 3.5 k during the experiments , which results in nearly 1.5 @xmath26s coherence time on the optical @xmath34h@xmath35h@xmath36 transition at 795.5 nm .",
    "a magnetic field of 50130 g , depending on the measurement , is applied along the c@xmath0 axis of the crystal in order to activate long - lived nuclear zeeman spin level , as illustrated in fig .",
    "a.[leveldiagram ] .",
    "these levels are used as shelving levels to generate persistent afcs .",
    "h@xmath37 ) and excited ( @xmath34h@xmath37 ) electronic level is used for reversible mapping of photonic states through the afc protocol .",
    "the lifetime of the excited level is about @xmath38 . upon application of a magnetic field ,",
    "the ground and excited levels split into two sub - levels ( nuclear zeeman level ) with lifetimes of the two @xmath34h@xmath37 sub - levels approaching 1  s. these levels are used as shelving states to generate persistent afc structures through optical pumping described in appendix  3 . ]",
    "each afc is prepared by means of frequency selective optical pumping of the inhomogenously broadened transition of tm at 795.54 nm wavelength .",
    "as detailed previously in @xcite , this is achieved by simultaneously chirping the frequency and modulating the intensity of single frequency laser light .",
    "the interaction between the laser light and resonant atoms leads to excitation of the latter .",
    "the atoms may subsequently decay to the shelving level .",
    "repeating this processes for a sufficiently long time leads to persistent spectral holes , which form the troughs of the afc .",
    "the atoms that are not excited by the laser are left in the ground level and form the regions of high absorption ( the peaks ) of the afc .",
    "adjusting the frequency spacing @xmath5 between the peaks ( or troughs ) allows setting the storage time @xmath39 to @xmath40 .",
    "an important point is that in the optical pumping process , reduced absorption at certain frequencies always comes with increased absorption at other frequencies , as determined by the level structure . in our case , pumping atoms from one magnetic sub - level to the other magnetic sub - level results in decreased and increased absorption at frequencies whose separation is given by the difference between the excited and ground level splittings .",
    "hence we have to adjust the magnetic field in such a way that the increased absorption and reduced absorption regions match the afc peaks and troughs .",
    "however , this approach severely limits experiments that require different peak spacings in the prepared afcs .",
    "therefore , in some experimental configurations , the magnetic field is optimized so that we obtain nearly equal efficiencies from each afc segment , at the expense of reducing the overall memory efficiency .",
    "typically , the efficiency was reduced by a factor 25 from the optimum efficiency of about 0.52  @xmath2 for a particular experiment depending on the storage time programmed .",
    "as explained in @xcite and discussed in section  [ discussion ] of the main text , the low efficiencies and relatively short storage time of our memory implementation are in general due to unfavorable relaxation dynamics ( arising from low branching ratio and insufficient persistent hole lifetime ) and a high decoherence rate in our specific sample kept at 3.5 k. on the other hand , the results of our recent spectroscopic characterizations carried out at temperatures below 1.5 k indicate that substantial improvement in the efficiency and storage time is possible ; this is supported by the observations reported in @xcite .",
    "in addition , improving the fabrication of the tm doped waveguide will also lead to better spectroscopic properties , as discussed in @xcite .      in each experimental cycle",
    ", optical pumping lasts for 3 ms .",
    "after the preparation of an afc , a 2.2 ms wait time is set to eliminate any fluorescence from excited atoms , which may swamp the re - emitted pulses . during the next 5 ms , 12 ns long probe pulses are generated at a 2.7 mhz rate .",
    "the pulses are attenuated down to a mean photon number of 5 - 40 and then sent into the afc memory .",
    "as depicted in fig .",
    "[ pulsemanipsetup ] , the directly transmitted , and the stored and retrieved pulses are detected by a si - apd single photon detector with @xmath41 detection efficiency and dark count rate of approximately 100 hz . given the small recall efficiency , the estimated mean photon numbers behind the memory are between 0.007 and 0.04 photons per pulse , depending on the experiment .",
    "to ensure sufficient detection statistics , each measurement is performed over @xmath42 minutes . in order to time - resolve and process the detection events , a time - to - digital convertor is used .",
    "the optical pumping light with 5 to 15 @xmath26w peak power is sent in backward direction to the memory ( i.e. counter - propagating with respect to the probe pulses ) to protect the single photon detector .",
    "finally , an optical switch allows toggling the memory output between optical pumping and transmission towards the detector .          in most of the demonstrations reported in the main text , the center frequency or spectral distribution of the pulses",
    "are changed by the input phase modulator .",
    "the main role of the phase modulator that follows the memory unit is to undo these changes , if necessary .",
    "for example , when pulses with the same carrier frequency are re - ordered in time , their center frequencies are automatically shifted by certain amounts as explained in section [ pulsereorder ] of the main text . in this case , using the output phase modulator , the frequency of the re - ordered pulses can be shifted back to their original values .    to demonstrate this capability , we add a fp filter with 80 mhz linewidth and 23 ghz free - spectral range behind the output phase modulator ( see @xcite for more details about the fp filter used ) .",
    "we generate an afc with 600 mhz bandwidth and 33 mhz peak spacing , leading to 30 ns storage time , and tune the transmission window of the filter to the center of the afc .",
    "first we store pulses with 12 ns duration in the prepared afc , and detect the recalled photons after having set the frequency shift introduced by the output phase modulator to zero , as shown at the top of fig .  a.[fpcavity]a .",
    "next we shift the frequency of the transmitted pulse by -200 mhz but leave the recalled pulse s frequency unchanged . in this case , while the transmitted pulse is blocked by the filter , the recalled pulse passes , as seen in the middle of fig .",
    "finally we shift the frequency for transmitted and recalled pulses by 200 mhz , causing both to be rejected by the filter as shown at the bottom of fig .",
    "a.[fpcavity]a .    in another demonstration , we prepare an afc with two frequency segments , each having 200 mhz bandwidth centered at -100 mhz and + 100 mhz detuning .",
    "we set the storage times to 50 ns and 70 ns , respectively .",
    "next , we generate two 25 ns separated pulses with -100 mhz and + 100 mhz detuning and store them simultaneously in the prepared afc .",
    "they are retrieved after their respective storage times , as shown on the left of fig .",
    "we direct them to the phase modulator and the filter tuned to -100 mhz . shifting the frequency by 0 mhz and + 200 mhz , we can limit the output from the cavity to a single frequency mode , as illustrated on the right hand side of fig .",
    "a.[fpcavity]b .",
    "these experiments demonstrate that using the output phase modulator , we have full control over the processed pulses in the frequency domain . in particular , any temporal manipulation that requires the spectra of the pulses to remain unchanged , or any spectral re - distribution that protects the encoded coherent information ,",
    "can be achieved with the use of this component . moreover , as shown in @xcite , integrating a fp cavity into our system allows for on - demand recall with respect to the frequency domain .      in this section",
    "we present a theoretical analysis for compressing and stretching optical pulses using an afc processor . as described in section",
    "[ compress ] in the main text , the frequency of an input pulse is linearly chirped and then the resulting pulse is mapped onto an afc with a linearly varying peak spacing ( fig .",
    "[ compression1]a ) , giving rise to a storage time gradient @xmath26 . after a predetermined storage time , either a compressed or a stretched pulse emerges , depending on the applied chirp .",
    "we describe the frequency - chirped pulse , propagating along the @xmath43-direction , before mapping onto the afc as    @xmath44    here , @xmath45 is the waveform of the input pulse before chirping and @xmath46 is the applied chirp function , where @xmath20 is the chirp rate and @xmath47 is the start ( offset ) frequency of the chirp @xcite .    following the treatment carried out in @xcite , the first echo that is emitted from the medium of length @xmath48",
    "is expressed by @xmath49 where @xmath50 is the fourier transform of the chirped input pulse .",
    "furthermore , @xmath51 is the start frequency of the programmed afc , and @xmath52 describes the efficiency of the retrieval .",
    "@xmath52 is determined by the characteristic parameters of the programmed afc such as optical depth , the finesse and the shape of the afc peaks but independent of the compression factor .",
    "optimizing these parameters allows in principle approaching unit efficiency in the compression ( stretching ) process @xcite . as seen in eq .",
    "[ eout_freq ] , the afc introduces a quadratic phase modulation at rate @xmath26 , i.e. the storage time gradient of the programmed afc : @xmath53 here @xmath54 describes the difference between the maximum and minimum storage time ( recall that the storage time in an afc memory is given by the inverse tooth spacing ) over the bandwidth of the chirped pulse , @xmath23 .",
    "the output waveform in the time domain can be found using the fourier transform , @xmath55 .",
    "we assume that the input waveform ( before chirping ) is described by a gaussian function of the form @xmath56 , where the full width at half maximum ( fwhm ) of the intensity is @xmath57 . setting @xmath58 , a lengthy but straightforward calculation yields @xmath59    where @xmath60 is the average storage time .",
    "note that we dropped the factor that describes the efficiency as we are only interested in the temporal shape of the recalled pulses .",
    "[ output ] allows simulating the experimental results as shown in figs  [ compression1 ] and [ highcompression ] in the main article .",
    "hence we can calculate the expected duration of the recalled pulse @xmath61 , and , after comparison with the duration of the input pulse @xmath17 , we can predict the compression factor @xmath62 . note that adjusting the start frequency of the chirp ( @xmath47 ) with respect to the start frequency of the afc ( @xmath51 ) allows setting the storage time , as demonstrated in section  [ ondemand ] .    as discussed in the main text ,",
    "the optimal compression factor is obtained for @xmath16 ( i.e. @xmath63 ) . under this condition ,",
    "the input pulse @xmath64 is converted into the output pulse @xmath65 , where @xmath66 ( from eq .",
    "[ output ] ) , allowing us to calculate the compression factor @xmath67 .",
    "this expression shows that higher compression factors can be achieved by extending the duration of the input pulse , as demonstrated in fig .",
    "[ highcompression ] .",
    "note that it is equivalent to @xmath68 , as described in section  [ compress ] .",
    "let us finally point out that the possibility for active control of the parameter @xmath69 by adjusting the chirp rate allows one to implement compressing and stretching in a very flexible fashion . as detailed in @xcite , having a value of @xmath69 between 0 and 1 leads to compression ( with variable compression factor ) of the input pulse without changing the order of the raising and falling edge , while setting @xmath69 between 1 and 2 causes a compressed , but time - reversed output . if @xmath69 is equal to 2 , time reversal of the input pulse without compression is obtained . on the other hand , setting @xmath69 larger than 2 leads to a time - reversed stretched pulse .",
    "in addition , flipping the sign of the chirp , as described in the main text , allows one to implement stretching without time - reversal . in this case a larger @xmath69 results in increased stretching .",
    "combining these features with the large time - bandwidth product of the afc and the large bandwidth of existing phase modulators makes it possible to change the duration of pulses in a fully controlled manner by several orders of magnitude .",
    "the serrodyne frequency shift technique @xcite is an essential tool used in our experiments ; it was employed in most of the described pulse manipulations and afc preparations .",
    "the principle of this technique is to introduce a linearly varying time - dependent phase change to the light by applying a sawtooth shaped voltage to an electro - optic phase modulator . as a result of the linear phase change , the frequency of the light is shifted by the amount of the modulation frequency .",
    "the great advantage of this technique is that , in principle , all energy can be transferred to the desired frequency mode without producing side - bands .",
    "this feature allows high - bandwidth spectral manipulations of short optical pulses , which we exploited for our experiments . to generate a sawtooth modulated voltage",
    ", we use an arbitrary waveform generator ( awg ) with 20 gs / s sampling rate .",
    "the output voltage of the awg is amplified using a high - speed amplifier to achieve the @xmath70-voltage value of the electro - optic modulators which is necessary for providing maximum energy transfer to the desired frequency mode .",
    "adjusting the modulation voltage between zero and the @xmath70-voltage allows us to vary the amount of energy transferred from the carrier frequency to the desired side - band modulation .",
    "our commercial electro - optic phase modulators have 20 ghz bandwidth and feature approximately 2 db loss .",
    "we are able to shift the light frequency by up to @xmath71 ghz .",
    "having imperfections in the applied sawtooth waveform causes imperfect energy transfer efficiency to the desired frequency mode .",
    "for instance , for a frequency shift of about 1 ghz , we maximally transfer 80@xmath2 of the unmodulated light s power .",
    "10 gisin n , ribordy g , tittel w and zbinden h 2002 quantum cryptography . _ rev .",
    "phys . _ * 74*. obrien j l , furusawa a and vukovi j 2009 photonic quantum technologies .",
    "_ nature photon . _ * 3 , * 12 : 687 - 695 lvovsky a i , sanders b c and tittel w 2009 optical quantum memory .",
    "_ nature photon . _ * 3 , * 12 : 706 - 714 . .",
    "sangouard n , simon c , de riedmatten h and gisin n 2011 quantum repeaters based on atomic ensembles and linear optics .",
    "phys . _ * 83 , * 1:3380 .",
    "sohler w , hu h , ricken r , quiring v , vannahme c , herrmann h , bchter d , reza s , grundktter w , orlov s , suche h , nouroozi r and min y 2008 integrated optical devices in lithium niobate .",
    "photonics news _ * 19 * 1:24 - 31 . martin a , alibart o , de micheli m p , ostrowsky d b and tanzilli s a 2012 quantum relay chip based on telecom integrated optics technology . _ new j. phys . _ * 14 , * 2 .",
    "bonneau d , lobino m , jiang p , natarajan c m , tanner m g , hadfield r h , dorenbos s n , zwiller v , thompson m g and obrien j l 2012 fast path and polarization manipulation of telecom wavelength single photons in lithium niobate waveguide devices . _ phys .",
    "* 108 , * 053601 .",
    "hosseini m , sparkes b m , htet g , longdell j j , lam p k and buchler b c 2009 coherent optical pulse sequencer for quantum applications _ nature _ * 461 , * 241245 .",
    "hockel d and benson o 2010 electromagnetically induced transparency in cesium vapor with probe pulses on the single photon level . _",
    "lett . _ * 105 , * 153605 .",
    "novikova i , walsworth r l and xiao y 2011 eit - based slow and stored light in warm atoms .",
    "_ laser photon .",
    "_ * 6*,3 , 333353 sparkes b m , hosseini m , cairns c , higginbottom d , campbell g t , lam p k and buchler b c 2012 precision spectral manipulation : a demonstration using a coherent optical memory . _ phys . rev .",
    "x _ * 2 , * 021011 reim k f , nunn j , jin x m , michelberger p s , champion t f , england d g , lee k c , kolthammer w s , langford n k and walmsley i a 2012 multipulse addressing of a raman quantum memory : configurable beam splitting and efficient readout . _",
    "lett . _ * 108 * 263602 .",
    "nunn j , reim k f , lee k c , lorenz v o , sussman b. j. , walmsley i a and jaksch d 2008 multimode memories in atomic ensembles . _",
    "lett . _ * 101 * 260502 .",
    "saglamyurek e , sinclair n , jin j , slater j a , oblak d , bussires f , george m , ricken r , sohler w and tittel w 2011 broadband waveguide quantum memory for entangled photons . _",
    "nature _ , * 469 * , 512 - 515 .",
    "saglamyurek e , sinclair n , jin j , slater j a , oblak d , bussires f , george m , ricken r , sohler w and tittel w 2012 conditional detection of pure quantum states of light after storage in a tm - doped waveguide .",
    "_ , * 108 , * 083602 .",
    "johnson l m and cox c h 1988 serrodyne optical frequency translation with high sideband suppression .",
    "_ j. lightwave technol . _ * 6 , * 1 . de riedmatten h , afzelius m , staudt m u , simon c and gisin n. 2008 a solid - state light matter interface at the single - photon level .",
    "_ nature _ * 456 , * 773 .",
    "afzelius m , simon c , de riedmatten h and gisin n 2009 multimode quantum memory based on atomic frequency combs _ phys .",
    "rev . a _ * 79",
    "* 052329 .    zhou z q , lin w b , yang m , li c f and guo g c 2012 realization of reliable solid - state quantum memory for photonic polarization qubit .",
    "_ * 108 , * 19:190505 .",
    "sabooni m , li q , krll s and rippe l 2013 efficient quantum memory using a weakly absorbing sample _ phys .",
    "lett . _ * 110 * , 133604 .",
    "usmani i , afzelius m , de riedmatten h , and gisin n 2010 mapping multiple photonic qubits into and out of a solid - state atomic ensemble .",
    "_ nature commun .",
    "_ , * 1 , * 12 .",
    "bonarota m , le gout j l and chanelire t 2010 highly multimode storage in a crystal _ new j. phys .",
    "_ * 13 * 013013 .",
    "sinclair n , saglamyurek e , mallahzadeh h , slater j a , george m , ricken r , hedges m p , oblak d , simon c , sohler w and tittel w 2013 a solid - state memory for multiplexed quantum states of light with read - out on demand _ arxiv : _ , * 1309.3202 * quant - ph .",
    "gndoan m , ledingham p m , almasi a , cristiani m and de riedmatten h 2012 quantum storage of a photonic polarization qubit in a solid _ phys.rev",
    ". lett _ * 108 * 190504 .",
    "clausen c , usmani i , bussires f , sangouard n , afzelius m de riedmatten h and gisin n 2011 quantum storage of photonic entanglement in a crystal .",
    "_ nature , _ * 469 , * 508 .",
    "clausen c , bussires f , afzelius m and gisin n 2012 quantum storage of heralded polarization qubits in birefringent and anisotropically absorbing materials .",
    "* 108 , * 190503 ( 2011 ) .",
    "bussires f , clausen c , tiranov a , korzh b , verma v b , nam s w , marsili f , ferrier a , goldner p , herrmann h , silberhorn c , sohler w , afzelius m and gisin n 2014 quantum teleportation from a telecom - wavelength photon to a solid - state quantum memory . _ arxiv_:*1401.6958 * quant - ph .",
    "barber z w , tian m , reibel r r and babbitt w r 2002 optical pulse shaping using optical coherent transients . _",
    "express , _ * 10 , * 20:1145 .",
    "moiseev s a and tittel w 2010 temporal compression of quantum - information - carrying photons using a photon - echo quantum memory approach .",
    "a _ * 82 , * 012309 .",
    "linget h , chanelire t , le gout , j l , and louchet - chauvet a 2013 .",
    "time reversal of light by linear dispersive filtering near atomic resonance .",
    "_ new j. phys .",
    "_ , * 15*(6 ) , 063037 . humphreys p c , metcalf b j , spring j b , moore m , jin x m , barbieri m , kolthammer w s walmsley i a 2013 linear optical quantum computing in a single spatial mode _ phys .",
    "lett _ * 111 * , 150501 .",
    "thiel c w , sun y , bttger t , babbitt w r and cone r l 2010 optical decoherence and persistent spectral hole burning in tm : linbo@xmath0 _ j. lumin . _",
    "* 130 , * 9 , 15981602 .",
    "afzelius m and simon c 2010 impedance matched cavity quantum memory _",
    "a _ * 82 * , 022310 moiseev s a , andrianov s n and gubaidullin f f 2010 efficient multimode quantum memory based on photon echo in an optimal qed cavity _ phys . rev .",
    "a _ * 82 * , 022311 .",
    "jobez p , usmani i , timoney n , laplane c , gisin n and afzelius m 2014 cavity - enhanced storage in an optical spin - wave memory .",
    "_ arxiv_:*1404.3489 * quant - ph tian m , vega d and dilles j 2013 quantum memory based on a spatiospectral atomic comb _ phys .",
    "a _ * 87 , * 042338 .",
    "afzelius m , usmani i , amari a , lauritzen b , walther a , simon c , sangouard n , minr j , de riedmatten h , gisin n and krll s 2010 demonstration of atomic frequency comb memory for light with spin - wave storage _ phys .",
    "* 104 * 040503 timoney n , lauritzen b , usmani i , afzelius m and gisin n 2012 atomic frequency comb memory with spin - wave storage in @xmath72eu@xmath73:y@xmath74sio@xmath75 , _ j. phys .",
    "b : at . mol . opt .",
    "* 45 * 124001 gndoan m , mazzera m , ledingham p m , cristiani m and de riedmatten h 2013 coherent storage of temporally multimode light using a spin - wave atomic frequency comb memory _ new j. phys . _ * 15 * 045012 lauritzen b , minr j , de riedmatten h , afzelius m , sangouard n , simon c and gisin n 2010 telecommunication - wavelength solid - state memory at the single photon level .",
    "_ * 104 , * 080502 saglamyurek e et al 2014 a fiber - based atomic quantum memory for entangled photons at telecommunication wavelength .",
    "_ in preparation _",
    "morse j d , mccammon k g , mcconaghy c f , masquelier d a , garrett h e , lowry m e 1994 characterization of lithium niobate electro - optic modulators at cryogenic temperatures _ proc .",
    "spie _ * 2150*. sinclair n , saglamyurek e , george m , ricken r , la mela c , sohler w and tittel w 2010 spectroscopic investigations of a ti : tm : linbo@xmath0 waveguide for photon - echo quantum memory .",
    "_ j. lumin .",
    "_ , * 130 , * 9:1586 - 1593 .",
    "thiel c w , sun y , macfarlane r m , bttger t and cone r c 2012 rare - earth - doped linbo@xmath0 and ktp for waveguide quantum memories .",
    "_ j. phys .",
    "b : at . mol",
    "phys , _ * 45 , * 124013 .",
    "palittapongarnpim p , macrae a and lvovsky a i 2012 a monolithic filter cavity for experiments in quantum optics _ rev .",
    "instrum . _ * 83 * 6:066101"
  ],
  "abstract_text": [
    "<S> faithful storage and coherent manipulation of quantum optical pulses are key for long distance quantum communications and quantum computing . </S>",
    "<S> combining these functions in a light - matter interface that can be integrated on - chip with other photonic quantum technologies , e.g. sources of entangled photons , is an important step towards these applications . to date </S>",
    "<S> there have only been a few demonstrations of coherent pulse manipulation utilizing optical storage devices compatible with quantum states , and that only in atomic gas media ( making integration difficult ) and with limited capabilities . </S>",
    "<S> here we describe how a broadband waveguide quantum memory based on the atomic frequency comb ( afc ) protocol can be used as a programmable processor for essentially arbitrary spectral and temporal manipulations of individual quantum optical pulses .  using weak coherent optical pulses at the few photon level , we experimentally demonstrate sequencing , time - to - frequency multiplexing and demultiplexing , splitting , interfering , temporal and spectral filtering , compressing and stretching as well as selective delaying . </S>",
    "<S> our integrated light - matter interface offers high - rate , robust and easily configurable manipulation of quantum optical pulses and brings fully practical optical quantum devices one step closer to reality . </S>",
    "<S> furthermore , as the afc protocol is suitable for storage of intense light pulses , our processor may also find applications in classical communications . </S>"
  ]
}