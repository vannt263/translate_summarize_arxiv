{
  "article_text": [
    "the calculation of non - linear optical susceptibilities of crystalline materials from first principles is an important but difficult task .",
    "the increasing activity and realization of the enormous potential for technological applications in the area of non - linear optics ( nlo ) , ranging from optical communications and computing to improved all solid state laser systems , has recently heightened interest in this problem .",
    "the materials requirements for certain nlo devices are stringent and require a search for new materials and/or optimization of their nlo properties , for example by artifical structuring of materials such as superlattices and heterostructures .",
    "although the general principles of nlo response are understood , a little study of the literature reveals that the uncertainties and the level of agreement between theory and experiment are still far worse than for linear optical response .",
    "hence , there is a great need to develop reliable quantitatively predictive methods to determine nlo susceptibitilies .",
    "this paper presents a step in that direction .",
    "nlo also has a great potential as a characterization technique for materials , because of its sensitivity to symmetry , which stems from the fact that it is described by higher than rank 2 tensors .",
    "as is well known for example , @xmath1 is zero for systems with inversion symmetry and thus any @xmath1 measured on such systems must come from regions where the symmetry is broken such as surfaces or interfaces . in order to extend the use of nlo spectroscopic characterization of interfaces of materials possessing an intrinsic @xmath1 in bulk , or to extract the maximal amount of information from such measurements , a more quantitative theoretical analysis will be required .",
    "requirements for such analysis are that the calculation of @xmath0 must be feasible for models with large numbers of atoms used to represent bulk and surface or interface regions and must be physically transparent so that information on electronic states can be extracted from it .",
    "the method presented here has been developed with these requirements in mind .    before going on to the more challenging studies of interface systems , it is necessary to establish the reliability of the methods for simple bulk crystalline systems and establish what level of theory is required by an iterative process between theory and experiment until a sufficient level of agreement is reached to extract useful information . on the experimental side ,",
    "some of the uncertainties stem from self - focusing , imperfect phase matching , finite wave mixing , effects due to sample size and surface quality .",
    "in addition , special equipment is required for the higher frequency uv response , the study of which is probably most readily done using frequency doubling or tripling .",
    "this explains perhaps to some extent why there are relatively few experimental measurements of the frequency dependent @xmath0 extending into the absorbing region . on the theoretical side , as in linear optics , one should in general be concerned with many - body effects , excitonic enhancements , local field corrections , etc .",
    "excitonic effects have been emphasized in the literature on nlo response in superlattices @xcite but are neglected in the remainder of this paper because we find it necessary to first establish the basic one electron picture firmly before going to these more advanced topics .",
    "local field corrections are briefly addressed below . however , until recently , even at the most basic level of the independent particle approximation , the formalism was by no means standard or universally accepted .",
    "the present paper will hence be mainly concerned with the theory at the independent particle level .",
    "when comparing with linear response calculations , the novice in this area may at first be somewhat bewildered by the many different formulations of the problem and the lack of a well - established set of equations . a second barrier results from the complexity of the equations and the difficulty of transforming from one formulation to another or",
    "establish their equivalence or conditions of applicability .",
    "although we do not intend at all to give a complete overview here of previous activity in this field , we give a brief discussion in the following few paragraphs to allow us to describe the context and limitations of our present approach .    from , the outset",
    ", we divide the methods in two large groups : the first being restricted to the static limit of @xmath1 , or , at best , with the non - absorbing frequency region @xcite ; and the second with the full frequency dependent method .",
    "the link between the two was for some time plagued by formal difficulties with apparently diverging terms as discussed below .",
    "therefore , early on , separate semi - empirical methods were developed for the static limit .",
    "most notably the bond orbital method used by b. f. levine @xcite was rather successful at predicting static @xmath1 values for a wide class of materials .",
    "nevertheless it is limited in its scope and is outside the realm of first - principles methods envisioned here . in recent years",
    ", the theory of the static limit of the response functions was developed to a rather sophisticated level in the framework of density functional theory .",
    "in particular , levine and allan developed the method including self - consistently the local field effects.@xcite their formulation is explicitly divergence free by application of various sum rules and makes extensive use of rearranging terms for maximal computational efficiency .",
    "these rearrangements , however rely on remaining outside the absorbing frequency range in some instances and hence limit the applicability range of the method .",
    "another disadvantage is that the final formulas are quite lengthy and thereby not easily related back to the underlying electronic states .",
    "in fact , they are so lengthy that their derivation and computational implementation made use of symbolic mathematical software . very recently , dal corso et al .",
    "@xcite formulated the problem of calculating @xmath1 in terms of third order derivatives of the total energy . by using the `` 2n+1 '' theorem",
    "@xcite they were able to simplify the calculation of the static @xmath1 considerably because only first order corrected wave functions are required .",
    "the latter are obtainable through a sternheimer approach.@xcite their formulation was extended to frequency dependent @xmath1 in the context of time dependent density functional theory , but , in practice , was again restricted to the non - absorbing regime .",
    "it by - passes some problems with the definition of the position operator for a periodic system by going to a wannier function representation , in a manner closely related to the berry - phase theories of the macroscopic polarization.@xcite the final formulas could of course be re - expressed in terms of bloch functions .",
    "both levine and allan s and dal corso et al.s methods were implemented using norm - conserving plane wave methods and successfully applied to a variety of semiconductors .",
    "although these techniques are perhaps the most advanced because of their inclusion of local field corrections , their extension to full frequency dependence is not straightforward . since local field effects were found to be generally only of the order of 10 % for conventional semiconductors we will neglect them in what follows .",
    "although computationally convenient , the use of the sternheimer approach instead of the usual perturbation theory blurs the link between optical response and interband transitions .",
    "therefore , the interpretation of optical response functions in terms of the underlying electronic band structure , which is one of our goals , is encumbered .",
    "we next turn to the methods dealing with the full frequency dependence .",
    "after a few of the early attempts to apply perturbation theoretical techniques applicable to atoms and molecules to periodic solids , the earliest of which to our knowledge is the work of butcher and mclean @xcite , several problems became apparent .",
    "the equations appeared to be plagued by divergences in the static limit .",
    "aspnes @xcite was the first to show that these were only apparent but his proof was limited to cubic crystals .",
    "for quite some time , this problem represented a serious setback to the full development of these methods in the context of band structure methods .",
    "the next important step was made by the work of ghahramani , moss and sipe @xcite who gave a more general proof of the disappearance of the divergence by using a new sum rule .",
    "soon afterwards , sipe and ghahramani @xcite presented a more general approach for avoiding the divergences from the start by a careful treatment and systematic separation of interband and intraband motion .",
    "finally , aversa and sipe @xcite showed that this could most easily be accomplished using a so - called length - gauge formulation .    in this connection ,",
    "perturbation theoretic approaches are most frequently set up taking the interaction between the long - wavelength electromagnetic field and the solid to be either ( @xmath2 ) , in which @xmath3 is the momentum operator and @xmath4 the vector potential of the field , or @xmath5 , in which @xmath6 is the position operator and @xmath7 the electric field .",
    "the former is often referred to as the velocity or momentum gauge and the latter as the length - gauge formulation .",
    "of course , in the end @xmath8 links the two approaches , which are equivalent through a unitary transformation as discussed explicitly by aspnes @xcite and aversa and sipe.@xcite as explained in the papers by sipe et al .",
    "@xcite each formulation has its own advantages and disadvantages .",
    "the use of the position operator has the problem that its matrix elements between bloch functions in a periodic solid are not defined uniquely.@xcite on the other hand , the use of the velocity - gauge formulation leads to additional frequency factors in the denominators and hence to the apparent divergences in the static limit , which must then be eliminated in the end by the use of suitable sum rules .",
    "a similar discussion appears in ref .",
    "although some of the conclusions there are limited to cubic materials . in the present paper , we adopt what seems at present to be the most transparent formulation , namely the one given by aversa and sipe.@xcite we were able to further re - arrange the terms so as to explicitly display the so - called kleinman symmetry @xcite in the limit @xmath9 @xcite .",
    "equations in the suitably modified form are given in sec .",
    "[ sec : form ] .",
    "the derivations by the toronto group @xcite are given in the framework of density matrix equations of motion .",
    "we verified that at least the pure interband terms for @xmath0 can also be obtained using the matsubara green s function approach.@xcite nevertheless , we recognize the advantages of the density matrix approach in obtaining a straightforward hierarchical approach for higher response functions such as @xmath10 which we intend to address in future work and for systematically including all intraband motion related terms .",
    "as far as practical band structure implementations are concerned , we note that until recently , most of the calculations were performed using semi - empirical band structure methods .",
    "the first attempts to calculate the static limit of the second order nonlinear susceptibility @xmath11 , or @xmath1 for short , for semiconductors with zincblende structure were made under the assumption that the momentum matrix elements are constants in the brillouin zone @xcite and did not employ full band structures but only @xmath12 expansions in the neighborhood of certain high symmetry points .",
    "after this paper there were several attempts to obtain the second and third order response functions from band structure calculations involving a variety of band structure approaches @xcite , ranging from semi - empirical pseudopotentials to tight - binding and self - consistent linear combination of atomic orbitals methods .",
    "however , it was typically assumed that only the so - called virtual electron terms , @xmath13 , involving one valence band ( @xmath14 ) and two conduction bands ( @xmath15 and @xmath16 ) contribute appreciably .",
    "also , the early work included only strictly three band terms , i.e. @xmath17 , whereas the new formulations include some two - band terms involving the quantity @xmath18 .",
    "( here and in the following , the superscripts @xmath19 , @xmath20 and @xmath15 denote the cartesian coordinates . )",
    "it can be shown that these terms vanish for cubic materials , or , for example , for the @xmath21 component in hexagonal materials by time - reversal symmetry , but they do not vanish in the general case .",
    "an important limitation of the semi - empirical band structure implementations is that it is not clear how well these approaches describe the wave functions and hence the matrix elements .",
    "it is rather difficult , in retrospect to disentangle the effects of the different expressions employed from the use of the necessarily imperfect matrix elements or other numerical limitations of the calculations .",
    "uncertainties about the magnitude of local - field effects , treatments of the gap underestimates typical of lda , and the uncertainties of the measurements themselves add to the confusion . only recently were the well founded and generally applicable formulations implemented in terms of an ab - initio local density functional theory based band structure method . hughes and",
    "sipe @xcite implemented the aversa and sipe approach using the full - potential linearized augmented plane - wave ( flapw ) method.@xcite using this formalism , the first accurate calculations of the full frequency dependent second order optical responses - the second harmonic generation ( shg ) coefficient and the linear electro optic ( leo ) susceptibility - were carried out for the zincblende crystals gaas and gap.@xcite subsequently , similar calculations of gan and aln which have the wurtzite structure were performed.@xcite    in the work reported here , we chose to use the linearized muffin - tin orbital method ( lmto ) @xcite in the atomic sphere approximation ( asa ) .",
    "we have found this method to be quite adequate for analyzing linear optical response functions.@xcite it has the advantage of being computationally more efficient than the flapw method .",
    "this will allow us in future work to apply the method to more challenging systems with many atoms per unit cell without compromising other convergence criteria such as summations over intermediate states , brillouin zone integrations and so on .",
    "furthermore , it offers potentially more physical transparency in the sense that atomic orbital or angular momentum type decompositions could be developed .",
    "although the present implementation uses the asa , this restriction could be removed at a later stage without drastically changing the codes . finally , although this is outside the scope of the present paper , we note that local field effects in linear response functions and approaches going beyond lda have recently been implemented in a particularly efficient manner within an lmto framework.@xcite    since this paper is the first in which we present results obtained with this approach , its primary aim is to demonstrate the accuracy and overall correctness of our computational method",
    ". we discuss some of the associated technical problems , such as the computation of the matrix elements and the inevitable convergence issues related to various cut - offs associated with any numerical method , such as the brillouin zone integrations , the sums over intermediate states , the angular momentum cut - offs in sec .",
    "[ sec : comp ] .",
    "most of the convergence tests are presented for cubic sic , because we have ample experience with this material from other studies and because it is an interesting case to illustrate some aspects of the method such as the relative importance of the various terms in the equations because of the relatively simple two peaked shape of the linear response function .",
    "also its interpretation in terms of interband transitions is well - understood.@xcite our results for @xmath0 for 3c - sic are to our knowledge the first for this material .",
    "however , we can compare our results to chen et al.s work @xcite in the static limit .",
    "our choice of the other materials for which results are presented is motivated by the availability of results obtained by other research groups . in particular , we will present results for wurtzite and zincblende gan because , we can compare both to the results obtained by chen et al.s @xcite approach in the static limit and with hughes et al.s results @xcite for the frequency dependent case .",
    "accurate experimental results are also available for the static values @xcite and the use of a hexagonal material demonstrates the applicability of our method to arbitrary crystal structures .",
    "gaas and gap were chosen because the availability of some frequency dependent experimental results@xcite and the prior treatments by various groups , including the work by hughes and sipe , to which our approach is most closely related .",
    "these results and discussions of them are presented in sec .",
    "[ sec : res ]",
    ".    a separate issue to be discussed in connection with the methodology is the use of the local density approximation for the calculation of the one electron band structure from which the response functions are calculated .",
    "this will be dealt with in sec .",
    "[ sec : complda ] .",
    "we will investigate the use of the commonly used `` scissors operator '' correction @xcite and a slightly different approach in terms of a corrected hamiltonian which we will show in sec.[sec : res ] to have some advantages .",
    "in this section , we provide a concise description of equations used in this work to calculate the second order response functions . these equations were originally obtained by sipe and ghahramani,@xcite and",
    "later derived in a simpler manner by aversa and sipe,@xcite using the above discussed length - gauge formalism . as mentioned in the introduction , we rearrange the equations slightly so as to make their symmetries under permutation of the indices more apparent . for the shg in a system with filled bands ( an insulator or clean semiconductor at zero temperature ) , one thus obtains ,    @xmath22    where    @xmath23",
    "\\label{eq : shg_e}\\ ] ]    is the contribution of the purely interband processes ( all the three band indices @xmath24 being different since @xmath25 are defined to be zero unless @xmath26 ) with @xmath27 , and    @xmath28 , \\label{eq : shg_i}\\end{aligned}\\ ] ]    is the contribution of the mixed interband and intraband processes .",
    "the latter include the modulation of the linear response by the intraband motion ( in the first 3 terms , which correspond to @xmath29 in ref . or @xmath30 in ref . ) as well as the modification of the intraband motion by the interband polarization processes ( last term corresponding to @xmath31 in ref . or @xmath32 in ref . ) .",
    "here @xmath6 is the position operator , @xmath33 , is the energy difference for the bands @xmath34 and @xmath35 , @xmath36 is the difference of the fermi distribution functions , sub or superscripts @xmath19 , @xmath20 and @xmath15 are cartesian indices , @xmath37 is the unit cell volume and the frequency @xmath38 is to be understood as @xmath39 for which the limit @xmath40 is to be taken in the end .",
    "all the quantities in the summation except @xmath38 depend on @xmath41 , but this index is suppressed . finally , @xmath42 is the so - called generalized derivative of the coordinate operator in @xmath41- space ,    @xmath43    where @xmath44 is the difference between the electronic velocities at the bands @xmath35 and @xmath34 .",
    "these equations have already been reduced to a form displaying single @xmath38 or @xmath45 resonances , rather than products of two such energy denominators .",
    "this facilitates the separate calculation of the imaginary part , and , subsequently , the real part by a kramers - kronig transformation .",
    "the equations can be further reduced by the substitution of eq.([eq : gen_der ] ) , which then leads to purely two - band terms involving the @xmath46 and additional three - band terms , as explicitly written out in the appendix b of ref . .",
    "we left the equations in this intermediately transformed state ( i.e. , still involving some @xmath47 ) and combined the two types of intraband terms because that made it easier to obtain a fully symmetric form in the static limit . after some algebra , the eqs .",
    "( [ eq : shg_e ] ) and ( [ eq : shg_i ] ) can be simplified for the zero - frequency limit to give ,    @xmath48 , \\label{eq : shg_e0}\\ ] ]    and    @xmath49 .",
    "\\label{eq : shg_i0}\\ ] ]    from these forms , it is obvious that both the @xmath50 and @xmath51 separately automatically satisfy the full permutation , or kleinman symmetry.@xcite this symmetry does not follow automatically from the point group symmetry requirements for a tensor of a given rank in the crystal and is only valid in the static limit .",
    "general arguments for its validity have been given elsewhere,@xcite although their validity as proof is not as clear as the present straightforward derivation .",
    "the relative importance of the various terms will be discussed below in sec .",
    "[ sec : res ] .",
    "we anticipate that they are in fact of comparable order of magnitude and often of opposite sign .",
    "thus , extreme care is required in their computation and leaving out some of these terms may easily destroy results such as the kleinman symmetry which follows only from a delicate balance between these terms .",
    "we note that the terms which involve only two bands , i.e. involve the quantities @xmath52 , are often relatively small . in any case for cubic materials ,",
    "their sum over the brillouin zone vanishes identically .",
    "the terms labeled here as interband and intraband are generally speaking of similar magnitude but of opposite sign as already discussed by aspnes.@xcite    for nondegenerate bands @xmath35 and @xmath34 the matrix element of the coordinate operator , @xmath53 , is related to the momentum matrix element by @xmath54 , as follows from the equation of motion .",
    "when the bands are degenerate , one can always choose the wave functions @xmath55 and @xmath56 in such a way that a given component of @xmath53 or @xmath57 vanishes as noted in ref ..",
    "thus , the degenerate bands do not contribute to the response function .",
    "however , if the energy difference between the two bands becomes small in some region of * k*-space , numerical problems can arise .",
    "we will return to this issue in sec .",
    "[ sec : res ] .",
    "in this section , we provide some further details on the computational approach and discuss some questions of numerical accuracy . the general scheme and set of approximations , or working assumptions ,",
    "have already been explained in sec .",
    "[ sec : int ] and [ sec : form ] .",
    "to recapitulate , we work at the independent particle level with the single particle spectrum obtained within density functional theory in the local density approximation .",
    "specifically , we use the hedin - lundqvuist parametrization of exhange and correlation here.@xcite some ad - hoc corrections to the band structure are eventually applied to correct for the well - known failure of the local density approximation in the lda .",
    "their justification and implementation will be discussed at the end of this section in subsection [ sec : complda ] .",
    "the task at hand is then to evaluate the expressions given in sec .",
    "[ sec : form ] with as input the band structure eigenvalues and eigenfunctions of the one electron schroedinger equation with the kohn - sham effective potential .",
    "more specifically , we need to discuss the accuracy of the eigenvalues and the matrix elements and the convergence issues associated with the various summations , that is summations over band indices and brillouin zone integrations .",
    "first of all , as already mentioned , the calculations of the frequency dependent responses proceed ( as is usual also for linear optics ) by first calculating the imaginary parts of eqs.([eq : shg_e ] ) and ( [ eq : shg_i ] ) . the real part is subsequently obtained by a kramers - kronig transformation .",
    "each term in the imaginary part takes the form familiar from linear optics of a valence to conduction band transition but is now multiplied by a factor which in the three band terms contains a sum over intermediate states and consist of some combination of matrix elements divided by an additional energy difference denominator .    for reasons mentioned in the introduction , we chose the lmto method for calculating the bands and the matrix elements .",
    "as most other modern band structure methods , this method is based on a variational approach using energy independent basis sets . as in all variational principle methods , the error in the wave functions ( and therefore , for the transition matrix elements ) are larger than the errors in the eigenvalues . consequently , the accuracy of the band structure alone can not be considered to be an adequate criterium of the accuracy of the matrix elements and the optical properties derived from them .",
    "a rather general discussion of this problem was given by uspenski et al .",
    "they showed that the basic origin for the problem is that the usual definition of the current density operator matrix elements which enter the response functions as @xmath58 needs correction terms when the basis set is not complete .",
    "however , no practical method is available for computing these terms .",
    "the practical recommendation of that paper is to estimate the magnitude of the required corrections by checking the fulfillment of sum rules .",
    "this will be discussed further below in sec .",
    "[ sec : methsum ] .      in the so - called linear methods ,",
    "including in fact both the lmto and flapw methods , @xcite the energy independent basis sets are constructed by expanding the partial waves centered about atomic sites about a chosen energy @xmath59 to first order in @xmath60 .",
    "the errors in the eigenvalues and eigenvectors increase respectively as @xmath61 for the energies and as @xmath62 for the wave functions .",
    "typically , for self - consistent calculations @xmath59 is chosen in the center of the occupied bands so as to give the best overall charge density .",
    "this linearization procedure is typically acceptable within a range of about 1 ry below and above the fermi level .",
    "because the matrix elements between the occupied states and the conduction band states rapidly decrease with increasing energy , this limitation to low lying states is of no great concern in linear optics . in the expressions of nlo , however , matrix elements between two conduction bands appear and therefore the higher states could possibly play a more important role in the intermediate state summation",
    ". therefore we must be concerned about their accuracy .",
    "recently , aryasetiawan and gunnarsson @xcite showed that this problem can be overcome by defining a multiple lmto basis set which uses several linearization energies .",
    "they found this to be important for ni when dealing with the energy loss spectrum in the region of 50 - 100 ev . in the present applications to semiconductors , however , we found intermediate summations to converge rather rapidly , typically including bands only about 1 - 2 ry up in the conduction band",
    ". therefore , we did not find it necessary to implement this extension of the lmto method at the present time .",
    "it could be done at a future time when found to be necessary for more demanding applications .",
    "another possible concern in connection with the lmto method is our use of the asa .",
    "for the semiconductors we typically find that eigenvalues are in agreement with full - potential lmto calculations to a precision of 0.1 ev .",
    "the occasional exceptions occur only at particular * k*-points and therefore do not seriously affect the overall response functions which are obtained from full brillouin zone integrations .",
    "we now turn to the accuracy of the matrix elements .",
    "a first remark is that while in linear optics only the absolute values of the matrix elements appear and thus all contributions add with the same sign , this is not the case in nlo .",
    "products of three matrix elements appear and can have either sign .",
    "large cancellations occur and thus more care is required .",
    "as already mentioned , the dipole ( or position ) matrix elements are avoided by rewriting all equations in the end in terms of momentum matrix elements whose treatment is better established .",
    "a problem occurs in evaluating the matrix elements @xmath63 as @xmath64 when the bands @xmath35 and @xmath34 are nearly degenerate .",
    "consistent with the fact that the matrix elements can be made to vanish when the bands are exactly degenerate , we set @xmath25=0 when @xmath65 with the small arbitrary cut - off @xmath66 chosen , e.g. , to be 10@xmath67 ry .",
    "we checked numerically that our results are insensitive to the actual choice providing it is small .",
    "when we make it too small the corresponding contributions can become too large and lead to unphysical spikes in the spectra . the above choice is generally found to avoid such occurences .",
    "the momentum matrix elements are calculated from the so - called one - center partial wave expansions of the lmto method . as is well known , within the lmto method",
    ", one can either expand the total wave functions in multi - centered muffin - tin orbitals @xmath68 in which @xmath69 are the structure constants and @xmath70 and @xmath71 are atom - centered partial waves ( i.e. radial functions times spherical harmonics ) at energy @xmath59 and their energy derivatives respectively , or in a one - center expansion in terms of the @xmath72 .",
    "here , @xmath73 labels the atoms in the unit cell and a bloch summation has already been carried out , and @xmath74 labels the spherical harmonic components . within the so - called nearly orthogonal representation @xcite the same expansion coefficients @xmath75 occur in both expansions of the bloch eigenstates @xmath76 the matrix elements between bloch states thus reduce straightforwardly to internal products of the eigenvectors of the lmto secular equation and matrix elements between the atom centered partial waves . by expanding the momentum operator @xmath77 in its spherical tensor components @xmath78 with @xmath79 , given by @xmath80 , and @xmath81 , the latter matrix elements in turn reduce to radial matrix elements and clebsch - gordan coefficients .",
    "the concerns about the numerical accuracy arise from the need to truncate the above expansions in angular momentum and from the asa in reducing all integrals over full space to a sum of integrals over space - filling spheres .",
    "one center expansions are known to require higher angular momentum cut - offs than the multi - centered expansion .",
    "typically , high accuracy linear optical applications require a @xmath82 for systems ( including most semiconductors ) in which normal self - consistent calculations of the energies require only an @xmath83 .",
    "while in linear optics this mainly affects absolute values and the correct spectral shapes can be obtained with even smaller cut - off , the inclusion of @xmath84-waves is imperative for nlo because of the varying sign of different contributions .",
    "we note that this does not necessarily require one to increase the basis set to @xmath84-waves .",
    "in other words , the matrices required to be diagonalized do not have to increase in dimension .",
    "it is only the one - center expansion via structure constants , in other words , the @xmath85 summation in eq.([eq : lmto ] ) that needs to be taken to a higher cut - off .",
    "the procedure for obtaining the higher partial wave components of the partial wave expansion is known as `` blowing - up''.@xcite an alternative way of including these higher components approximately and thereby insuring the continuity of the wave functions across the boundaries of the atomic spheres while at the same time correcting for the geometric errors of the asa ( due to the overlap region of the spheres and the neglect of regions of space outside all spheres ) is provided by the so - called combined correction technique.@xcite uspenski et al .",
    "@xcite have investigated how this affects the matrix elements in lmto linear optics calculations .",
    "they found the corrections to be important only when a small @xmath83 is used and to be fairly small for the important low lying bands .",
    "alouani et al .",
    "@xcite also showed that the combined correction effects overall are small for the linear optical response functions .",
    "we have not implemented these corrections for the matrix elements because we want to avoid the use of the plane wave expansion used in these earlier implementations of the combined correction and because the use of a higher @xmath86 , which is a simpler procedure , seems to be equally effective .",
    "we note that the combined correction to the overlap matrix is included , in a somewhat different form in setting up the secular matrix , and thereby improves the accuracy of the eigenvalues .",
    "the corrections to the matrix elements can be implemented in a similar manner and this is planned for future work .",
    "the good agreement of our results with those of the flapw based calculations @xcite , which handle the interstitial region more accurately , suggests that the above mentioned procedure does not represent an important limitation .",
    "as discussed by uspenski et al.,@xcite one way to estimate the overall accuracy of the matrix elements , is to check the fullfillment of certain sum rules .",
    "namely , the first partial derivatives of the band energies in the * k * space must give the electron velocity ,    @xmath87    while the second derivative provides the inverse effective mass ,    @xmath88 .",
    "\\label{eq : sum2}\\ ] ]    inspection of the terms in eqs.([eq : shg_e ] ) and ( [ eq : shg_i ] ) reveals that very similar summations appear as those in eq.([eq : sum2 ] ) , involving symmetrized products of two momentum matrix elements divided by some energy denominator and multiplied by another matrix element .",
    "therefore , we feel that the second of these sum rules provides a good test of the overall accuracy of the matrix elements .",
    "we already know from previous work @xcite that including higher angular momenta ( in practice up to @xmath82 ) and/or combined corrections improve the satisfaction of the first sum rule .",
    "we carried out some of these tests for various semiconductors in connection with independent work on effective masses.@xcite as an illustrarive example , table [ tab : mass ] shows the calculated values of the effective masses for sic at the @xmath89-point of the bz along the @xmath90 direction for several valence and conduction bands .",
    "the masses were calculated directly from the band curvatures and by using the right hand side of eq.([eq : sum2 ] ) up to various angular momentum cut - offs .",
    "the number of bands included was 10 but we found that generally only 3 to 4 terms contribute significantly .",
    "the overall agreement between the masses calculated from the momentum matrix elements and from the direct differentiation of the band energies in the @xmath41 space is satisfactory , the maximal deviation being about 0.04 electron mass units and typically deviation being smaller than 10 % .",
    "we hasten to add that here we only check internal consistency .",
    "slightly different masses are obtained when fp corrections are included and furthermore , there are errors to be expected from the lda .",
    "our most important concern here was to ascertain the @xmath86 we expect to need for the calculation of nlo coefficients .",
    "clearly , the convergence in terms of @xmath86 is better than we had anticipated .",
    "there remain the more general limitations on the fullfilment of these sum rules , which are unavoidable in any variational finite basis set method , as discussed above .",
    "the present tests indicate that these lead to an overall error of the order of 10 % .",
    "we next study the convergence for the static values of @xmath1 for cubic sic .",
    "table [ tab : conv ] shows the lda values of the shg in the zero frequency limit for different maximal value of the angular momentum ( @xmath86 ) included in the lmto one - center partial expansion of the bloch eigenfunctions and for different numbers of bands ( @xmath91 ) included in the sums .",
    "we choose to carry out all sums over the same number of bands and @xmath91 refers to all bands , including both valence and conduction .",
    "the conduction band width is about 0.8 ry for 10 bands , 1.7 ry for 15 bands and increases to about 4.5 ry for 30 bands . in spite of the fact that the lmto method simply can not give the correct results for the electronic bands at such high energies , one can see that the values of @xmath1 are well - converged for @xmath92 ( remaining changes being smaller than 2.5 % ) and are even reasonable for @xmath93",
    "this indicates that the accuracy of the higher bands is not crucial because the important contributions are from the lower bands .",
    "this results from the additional energy denominator prefactors which cut - off the higher bands more rapidly than in linear optics or in the effective mass sum rule .",
    "we found that the individual terms converge somewhat more slowly : the cancellations between intra- and interband contributions help the convergence .",
    "as for @xmath86 convergence , @xmath84-orbitals are clearly needed while @xmath94-orbitals can be neglected .",
    "it is not surprising that the calculations with @xmath86=2 gives an underestimate for the static limit of @xmath1 . in our earlier papers@xcite on the linear response functions of sic polytypes",
    ", we used @xmath83 .",
    "however , this work was mainly aimed at identifying the prominent interband transitions and comparison to reflectivity measurements rather than at the absolute values .",
    "we recently found that with this @xmath86 the dielectric function is underestimated by 2030% @xcite .",
    "the @xmath84-bands for sic have very high energies , and the partial contribution of the @xmath84-states in the density of states for the bands around the semiconducting gap is relatively small . however , the radial matrix elements between the @xmath95- and @xmath84-states are large enough to create a noticeable @xmath96 contribution to the matrix elements even in the gap region . in the case of the shg ,",
    "ignoring the @xmath84-states in the basis orbital creates even larger differences .",
    "finally , we discuss the brillouin zone integration .",
    "for this purpose we use the linear tetrahedron method .",
    "the integrations are converted into a weighted sum using the appropriate fermi cut - offs inside each microtetrahedron .",
    "the sums are reduced to an irreducible set of @xmath41-points , rather than defining a compact ( but sometimes complicatedly shaped ) irreducible portion of the brillouin zone as discussed by blchl et al.@xcite the irreducible sets are obtained by applying all symmetry operations of each @xmath41-point s applicable point group , thus generating its entire star before integration .",
    "these leave the eigenvalues invariant and transform the ( complex ) matrix elements in a well - known fashion . while time reversal symmetry still allows us to relate quantities at @xmath41 and @xmath97 , their application is a little more subtle than in linear optics where only absolute values of the matrix elements appear . here , we have @xmath98 . the symmetry aspects of our code were checked in various ways , for example , by performing the calculation with and without certain symmetry operations ( integrating in the latter case explicitly over the full bz ) , and checking their consistency .",
    "we also calculated results for zincblende treating it as a system with rhombohedral symmetry and found the required relations between the tensor components in rhombohedral axes and in cubic axes ( to be discussed below ) to be fulfilled exactly .    because of the additional rapidly varying energy difference denominators and the varying signs of the matrix element products , a finer * k*-point mesh is required than in linear optics .",
    "we find that the difference between 735 and 1456 irreducible * k * points is about 5% on average for the frequency dependent shg in crystal with zincblende structure . while the static limit can be obtained from the kramers - kronig transformation , it is more efficient to implement directly the simplified expressions of eqs .",
    "( [ eq : shg_e0 ] ) and ( [ eq : shg_i0 ] ) . the consistency between both approaches",
    "is found to be fulfilled numerically to better than 5 % . in the direct calculation of the static limit ,",
    "we calculate analytically the contributions of each microtetrahedron by linearizing the energy bands in the denominators as well as the product of three momentum matrix elements in the numerator .",
    "this generally leads to integrands of the form @xmath99 with both @xmath84 and @xmath94 linear functions , which can easily be evaluated analytically and expressed in terms of the corresponding quantities at the four corners of the tetrahedron .",
    "such a scheme is superior to the usual averaging of the integrand values in the corners of tetrahedron which becomes exactly equivalent to straigthforward sampling in the case of completely filled bands .",
    "the need for an accurate integration scheme involving a linear interpolation of both the matrix elements and the eigenvalues was also mentioned by hughes and sipe @xcite who used a random sampling inside each microtetrahedron .",
    "our semianalytic technique is believed to be more efficient .",
    "a similar technique was described by moss , sipe and van driel.@xcite the formulas for the zero frequency limit are less singular , and 300500 * k*-points were found to be sufficient for obtaining convergence to within 5% .",
    "the use of the lda is well - known to underestimate band gaps in semiconductors .",
    "since these energy band differences enter the calculations of response functions in the denominators of the expressions , it is not surprising that the latter tend to be overestimated .",
    "this is well - known to lead to errors of the order of 10 - 20 % in linear response .",
    "the proplem is aggravated in higher order responses by the fact that denominators occur in higher powers .",
    "it easily leads to factors of 2 or more in @xmath1 .",
    "one might at first think that only an upwards shift of the conduction bands is needed .",
    "however , it has been argued that , at least , in the static limit , the response functions are ground state properties and therefore should be based on the kohn - sham eigenvalues of density functional theory and not on the quasiparticle band structures .",
    "it is commonly accepted that the two differ not so much as a result of the local density approximation but rather by the gap discontinuity@xcite between the @xmath100 , and @xmath101 particle systems .",
    "an alternative point of view , however , was presented by gunnarsson and schnhammer @xcite .",
    "they emphasize that the exact density functional may be extremely non - local . as a more practical matter ,",
    "lambrecht and segall @xcite , and levine and allan @xcite both found that corrected band structures provide improvements for static dielectric functions .",
    "recently , it was shown by aulbur et al .",
    "@xcite that an alternative justification for the use of a corrected band structure can be obtained from a recent extension of the density functional theory in which exchange correlation is considered to be an explicit functional of the polarization vector as well as the density @xcite and thereby requires an extremely non - local term in insulators in the presence of an electric field .",
    "thus , even for the static response a correction beyond lda seems to be called for .",
    "when we consider the frequency dependent response functions , it is clear that some correction to the band structure is necessary in order to have the resonances occur at the correct energies .",
    "the simplest form of the correction is known as the `` scissors '' approximation and consists of a shift of all the conduction bands by the gap correction @xmath102 which in all practical applications has been taken to be independent of * k*. as was shown by levine and allan @xcite and also , in perhaps a more transparent manner , by hughes and sipe @xcite , this shift of the conduction bands - which represents a change in the hamiltonian - requires an associated renormalization of the momentum matrix elements    @xmath103    where the ( @xmath104 ) factors restrict the correction to pairs of bands involving one valence and one conduction band state .",
    "implicit in this approach is the assumption that because lda wave functions are close to the true quasiparticle wave functions ( a result established , for example , by godby et al .",
    "@xcite using quasiparticle calculations in the gw @xcite approximation ) , the @xmath105 matrix elements do not change .",
    "we note that this assumption can not be strictly correct .",
    "in fact , a consequence of the scissor approximation with a * k*- independent @xmath102 is that the effective masses remain unchanged .",
    "however , applying the above prescription for the momentum matrix elements to the well - known @xmath12 expression for the inverse masses ( see eq.([eq : sum2 ] ) ) increases the inverse mass tensor , or , decreases the effective mass .",
    "it is also relevant to note that for most semiconductors , e.g. gaas , the lda already underestimates the mass .",
    "( for a more complete discussion of the changes in the effective mass tensor due to quasiparticle corrections beyond lda in the framework of the gw approximation , see zhu et al.@xcite ) .",
    "nevertheless , for optical response functions , the above prescription appears to be better than the alternative assumption that the @xmath106 matrix elements remain unchanged .",
    "this would strongly overcorrect the lda error because for example in linear response three energy denominators would change instead of only one .",
    "we consider a slightly different , although also an admittedly ad - hoc correction which , however has the advantage of maintaining the consistency between eigenstates and hamiltonian .",
    "this alternative approach is closely related to the one suggested by christensen.@xcite it is essentially an empirical adjustment to the lmto hamiltonian chosen so as to reproduce the correct band structure .",
    "it makes use of the fact that the lowest conduction bands at @xmath107 and @xmath89 have a strong s - partial wave character centered at the cation and ( tetrahedral interstitital ) empty sphere sites .",
    "therefore , we can simply introduce a shift of the corresponding diagonal hamiltonian matrix element .",
    "( christensen achieves this by adding sharply peaked repulsive external potentials to the kohn - sham effective one - electron potential in the corresponding spheres .",
    "such potentials primarily act on s - like states because s - like states are the only ones with a non - vanishing probability at the origin .",
    "we find it slightly easier to make the corrections directly at the level of the hamiltonian matrix , but the results of both approaches are the same . )",
    "this scheme has the advantage that the gap can be adjusted differently at different * k*-points . on the other hand ,",
    "it leaves the higher bands largely unchanged . in gaas and gap ,",
    "the important peaks in the linear response functions are dominated by the transitions solely to the lowest conduction band .",
    "therefore , this approach works very well , at least in the relevant energy range of these transitions .",
    "it is here also shown to improve the agreement with experiment for the absolute magnitude of @xmath1 .",
    "it is not clear , however , how to generalize it so as to also shift up higher conduction states in cases where we think that is important .",
    "in fact , for sic @xcite and gan,@xcite we found in earlier work on linear response functions , that a rigid upward shift of all the conduction bands within a range of about 10 ev above the minimum is required to obtain good agreement in peak positions with experimental reflectivity spectra .",
    "hence , for sic and gan , we here use the scissor s approximation as suggested by hughes and sipe.@xcite this also allows for a more straightforward comparison to their results .",
    "table [ tab : gaas ] shows the calculated values of the shg for zincblende materials gaas and gap compared with other theoretical calculations and available experimental data .",
    "we show our lda results as well as results of calculations with gaps adjusted to the experimental values .",
    "we used the `` scissors '' corrections to the lda in the same way as in ref . as well as the shifts of cation and empty sphere centered s - partial wave diagonal matrix elements of the lmto hamiltonian , which as discussed in sec .",
    "[ sec : complda ] is equivalent to the addition of the short - range potentials on the atomic sites.@xcite as one could expect , the pure lda values of shg are highly overestimated ( especially for gaas ) because of the gross underestimate of the gap .",
    "the results for the `` scissors '' corrections are very close to those of hughes and sipe @xcite obtained by the self- consistent flapw method . this verifies that the flapw and lmto give essentially the same results for nlo responses .",
    "the possible large errors in the band energies for high lying bands which appear in any linear method are not that important here because the main contributions to shg come from transitions to just a few low - lying conduction bands .    in the present calculations we ignored the local field corrections .",
    "however , they do not change the shg in the zero frequency limit by more than 10 % for these materials as follows from ref . and as can also be seen in table [ tab : gaas ] .",
    "the more important correction is the gap adjustment .",
    "table [ tab : gaas ] indicates that we get much better agreement with the experimental results by applying the shifts in the hamiltonian than by applying a scissors correction to the final bands .",
    "the difference between the approaches is that by explicitly diagonalizing the shifted hamiltonian we obtain the correct eigenvectors ( and , therefore , the transition matrix elements ) of the `` shifted '' hamiltonian , i.e. , the eigenvectors and eigenvalues are consistent with each other .",
    "this consistency is lost when one uses the `` scissors '' approach .",
    "the lda gap for gaas obtained in asa lmto is very small ( about 0.2 ev ) , i.e. , the `` scissors '' generates the gap rather than corrects it .",
    "therefore , we think that shifting the hamiltonian matrix elements is certainly a more suitable procedure than applying the `` scissors '' approach for this material . for gap",
    "the situation is much better from that point of view because the lda gap is much larger than for gaas .",
    "however , the `` scissors '' approach still gives an underestimation of the experimental value of the shg .",
    "it is worth noting that dal corso et al . got a good agreement with the experimental results from their density functional approach @xcite without any gap corrections",
    "however , their results depend strongly on whether or not they include the so - called non - linear core correction to exchange and correlation and their `` best results '' , in terms of agreement with experiment , are actually obtained without the correction",
    ". there may be a compensation of errors occuring here .",
    "in fact , the question of a gap correction does not enter in their approach because in their sternheimer method , the first - order corrected wavefunctions are obtained directly instead of in terms of the excited state wave functions of the zeroth order hamiltonian as in the standard perturbation theoretical approach .",
    "thus , the conduction band does not enter their calculation . in view of the recent discussions of polarization dependent",
    "functionals,@xcite one would think that a non - local correction to the exchange correlation is required .",
    "we will return to discussion about different approaches to the gap corrections in the next subsection .",
    "the results of our calculations for some wide band gap semiconductors with zincblende structure are shown in table [ tab : zb ] .",
    "here we used the `` scissors '' method of ref . for simplicity .",
    "we see that in general the scissors significantly change the absolute values of shg .",
    "our lda values agree fairly well with the lda results obtained by the pseudopotential method.@xcite the agreemement is particularly good for gan taking into account that local field corrections are expected to reduce the value by about 10 % .",
    "furthermore , this is in spite of the fact that the pseudopotential calculations of ref .",
    "did not take into account the 3d bands of ga while our lmto calculations did .",
    "it implies that these bands play a minor role in @xmath1 .",
    "for the other materials , applying an ad - hoc 10 % reduction to our results due to local field corrections would worsen the agreement . in any case ,",
    "chen et al.s @xcite and our calculations agree on the very small value for aln , the relatively small value for bn , and the very close values for sic and gan .",
    "the remaining discrepancies are hard to pin down because of the hugely different computational procedure , possible use of different lattice constants , etc .",
    "our calculations were performed at the experimental lattice constants . for 3c - sic",
    "we changed the sign of the shg coefficient given in ref .",
    "because in the coordinate system used there the si - c bond was oriented in the direction opposite to that in our system .",
    "@xcite    the calculated shg values for the wurtzite gan and aln are shown in table [ tab : wz ] .",
    "again we see that our lmto results agree quite well with those obtained in the flapw approach@xcite .",
    "an interesting characteristic of the wurtzite material is the value of the ratio @xmath108 which is expected to be equal to @xmath109 in a `` quasicubic '' model .",
    "in fact , this result is obtained if one applies a coordinate axis transformation of the cubic tensor from the usual cubic axes to a set of rhombohedral axes with the @xmath110-axis point along the cubic [ 111 ] direction . because , there is only one independent component @xmath111 in zincblende , this leads to a ( geometric ) relation between the two rhombohedral tensor components , which are the same as the hexagonal components .",
    "based on the similarity of the bonding in wurtzite and zincblende , this also predicts a relation between the values of @xmath1 in wurtzite and the value in zincblende : @xmath112 .",
    "these relations for example are automatically satisfied in the bond charge model @xcite independently of the model - parameters .",
    "the occurence of non - ideal tetrahedral bonding clearly produces a deviation from the geometric ratio.@xcite nevertheless , it is difficult to understand the large deviation encountered for aln .",
    "we find , in fact , that even for ideal aln , these relations are strongly violated .",
    "this was also concluded in a previous discussion of this issue by chen et al.@xcite    for gan all the calculations done by different methods find absolute values of the ratio @xmath113 that are definitely smaller than two , but an accurate experiment of miragliotta et al .",
    "@xcite nevertheless gives a value for the ratio very close to @xmath109 .",
    "the sign of the shg components in this experiment is opposite to all the calculations , probably because the overall sign was not determined experimentally relative to atomic coordinates . for aln",
    "both theory end experiment give very small values for @xmath114 and a @xmath111 .",
    "the direct comparison of the value of @xmath115 with experiment is difficult because the error in the only available experiment , that of fujii et al , @xcite was very high .",
    "the reasons for the very small components of @xmath116 and @xmath117 in the static limit can be traced back to an almost perfect cancellation of inter and intraband contributions but the reason for this is still not fully understood .",
    "the question about the ratio of different components in the hexagonal materials will be the subject of a further detailed study addressing this question for the sic polytypes.@xcite      figure [ fig : gaas_hughes ] shows the comparison of our calculated values for frequency dependent shg in gaas and gap with those computed by the flapw method @xcite .",
    "we used the `` scissors '' approach here ; then , since all aspects of the two calculations are the same except for the computational methods , the comparison provides a mutual check of the methods .",
    "the overall agreement in both the positions of all the features as well as in their amplitudes is very good over the full 6 ev range considered , especially for gap .",
    "we note that both ours and the flapw results differ substantially from earlier work.@xcite as we mentioned before , in gaas the lda gap obtained in lmto was very small , and the gap correction was almost the only source of the final gap",
    ". this could be the reason for differences of shg in different lda approaches because the lda value of the gap can be different in slightly different implementations of the lda calculations . for gap",
    "the lda gap was substantially larger , and the agreement between the results is noticeably better .",
    "this agreement provides an additional support for the accuracy of our approach and confirms that different properly implemented band structure methods must give rather similar results .    however , when one compares the frequency dependent shg obtained with the `` scissors '' corrections with those calculated within the `` shifted '' hamiltonian approach ( see fig.[fig : gaas_ham ] ) , important differences become apparent .",
    "the values of the minimal energy at which the resonant transitions start are obviously the same as the gap was corrected to its experimental value .",
    "but the energies of the main features in the two curves are obviously different .",
    "one can especially observe that in the energy region between 3 and 6 ev .",
    "the `` scissors '' method obviously rigidly shifts all the conduction bands to higher energies . on the other hand ,",
    "the shifts in the hamiltonian only affect the states with a large s- component so that the lowest conduction bands are shifted but the higher bands remain nearly unchanged from their lda positions .",
    "this means that the states near the gap are probably reproduced better in the second approach than in `` scissors '' ( because of the consistency of the eigenvectors and eigenvalues ) but that the higher bands may be incorrect .",
    "in fact , we found in several recent studies of linear optics that the next few higher bands are equally shifted up.@xcite however , as we showed in the last subsection the shifted hamiltonian approach gives much better results for the zero frequency limit of shg than the `` scissors '' corrections .",
    "this probably reflects the fact that the low - lying conduction bands are more important for obtaining the correct value of @xmath1 than the whole remaining energy band spectra . and",
    ", the method with `` shifted '' hamiltonian describes the matrix elements of transitions into the lowest conduction bands better than the `` scissors '' approach because of the use of the better wavefunctions , those which are the eigenfunctions of the corrected hamiltonian .",
    "figure [ fig : gaas_shg ] shows the calculated frequency dependent absolute values of @xmath0 for gaas obtained on the basis of the `` shifted '' hamiltonian gap corrections .",
    "the agreement between these calculations and available experimental results is satisfactory considering the nature of the data .",
    "it is much better than between the `` scissors '' calculation of ref . and the same collection of the experimental results .",
    "unfortunately , the experimental results exist only in the energy region between 1 and 3 ev ( probably due to the available laser light sources ) and there are nonnegligible quantitative differences between the different sets of data .",
    "only the electronic transitions into the lowest conduction bands contribute strongly in the energy range containing the data .",
    "therefore , our result confirms the fact that the correct values of the momentum matrix elements into the low lying conduction bands are important for both the zero frequency values of the shg as well as for its low energy ( visible light region ) values for gaas and gap .",
    "the question about the higher energy region remains open . to our knowledge",
    "there are no measurements of shg for gaas in the higher energy region .",
    "this further supports our focusing on the low energy region .",
    "consistent with our results for non - linear response , we find that the imaginary part of the linear dielectric function ( df ) , @xmath118 , calculated in the same approach , i.e. with the `` shifted '' hamiltonian diagonal matrix elements , agrees excellently with the experiment , as is shown in fig.[fig : gaas_df ] .",
    "it is also dominated by transitions to the lowest conduction bands .",
    "therefore , for gaas , the answer to the question of whether the rigid shift of the conduction band provided by the `` scissors '' corrections is correct in the higher energy region is not clear .",
    "an accurate calculation of the self - energy corrections to the lda bands can help us to resolve the question .",
    "further complications for these higher bands may in fact arise from local field and continuum excitonic effects both of which may shift oscillator strength .",
    "this is actually also true for the lower bands and thus our good agreement with experiment may to some extent be due to effective cancellations of effects neglected in the present treatment . in the remainder of this paper , we use the simpler scissor s approach either to facilitate comparison to other work or for other reasons previously mentioned .",
    "the imaginary part of the three independent shg components ( 333 , 311 , and 131 ) for wurtzite gan and aln are shown in figure [ fig : ganaln ] .",
    "the results are very similar to those obtained in ref . as is to be expected since the same `` scissors '' approach is used .",
    "we first note a strong similarity between the 311 and 131 components over the entire energy spectrum .",
    "this is consistent with their exact equality for the static value , an expression of the kleinman symmetry . except for the structure at the two - photon threshold ,",
    "the imaginary part of the shg function is rather flat and small for all the components in a region of approximately 1 ev above the threshold . in the higher energy region , features with much larger amplitude appear . also , the positions of the features are approximately the same for all the polarizations . but the signs of the 311 and 131 components are usually opposite to those for the 333 component .",
    "this fact is consistent with the opposite signs of the zero frequency shg components which can be obtained from the frequency dependent imaginary parts by use of the kramers - kronig transformation .    as mentioned in the previous subsection ,",
    "the static @xmath111 and @xmath114 components are very small for aln .",
    "[ fig : aln ] shows that this results from an almost exact cancellation between the interband and intraband contributions over the entire energy range .",
    "next , we turn to our results for the frequency dependent shg in zincblende ( or 3c ) sic , which we believe has not been calculated before . in sic ,",
    "the use of 1 ev rigid shift of all conduction bands allows one to reproduce the positions of all the main features of the linear dielectric function over a very wide energy region ( up to 10 ev ) @xcite for the most abundant polytypes ( 3c , 4h , 6h , and 15r ) .",
    "therefore , the `` scissors '' corrections seem more appropriate here than adjusting only the lowest band .",
    "furthermore , it is expected to work much better for this material than for gaas in view of the much smaller relative gap correction .",
    "[ fig : sic_ei ] shows the imaginary part of the shg for 3c - sic together with its interband and intraband components .",
    "as one can see , these contributions have comparable absolute values but different signs in the wide energy region .",
    "this means that the reasonable description of the total shg can not be achieved if one of these components is ignored .",
    "it is also of interest to separately show and analyze the @xmath45 and @xmath38 resonant contributions to the shg .",
    "the total shg curve is the sum of these components , both of which have features at different energies thus complicating the interpretation .",
    "the comparisons of the @xmath45 and @xmath38 contributions to the @xmath119 component of the shg to the imaginary part of the df are given in panels a ) and b ) of fig .",
    "[ fig : sic_w2w ] , respectively .",
    "we compare the @xmath45 term with @xmath120 and the @xmath38 term with @xmath118 with the df s suitably multiplied by scaling factors .",
    "first , we note that the energies of all the main structures and peaks in the shg and df curves coincide because the electronic transitions which produce the structures in both the curves are the same , only the matrix element factors in the two quantities are different",
    ". the origin of the peaks can be analyzed by decompositions of @xmath121 and @xmath1 into separate band - to - band contributions ( see , e.g. , ref . for details of such an analysis of the linear df ) .",
    "this exercise illustrates the utility of decomposing the total @xmath1 into its @xmath38 and @xmath45 resonance components each of which is closely related to the linear optical spectrum . because the linear response function is more readily understood in terms of specific band - to - band components , the decomposition is useful for extracting the band structure information from @xmath1 spectra .",
    "we will pursue this approach in more detail in a future publication.@xcite we merely point out here that the additional fine structure visible in @xmath122 and resulting from the sign variations in the matrix elements may be helpful in identifying specific band - to - band features . in a sense , the additonal power of the electric field in the second harmonic generation produces a modulation .",
    "the resulting interference effects lead to more structured spectra in a manner similar to electroreflectance or other modulation spectroscopies .",
    "in summary , we have shown in this paper that the lmto method in the asa allows us to perform calculations of non - linear response functions with the accuracy of that obtainable by other first - principles methods . at present , we have implemented the approach for second harmonic generation , including its full frequency dependence in the absorbing region within the one electron approximation in the long - wave length limit , i.e. without inclusion of local field effects .",
    "this limitation can be removed in future work .",
    "the present implementation was carried out using the equations derived by aversa and sipe@xcite in the length - gauge formalism , or , equivalently , using a separation of strictly interband and mixed inter- and intraband processes as derived by sipe and ghahramani@xcite .",
    "this has the advantage that these contributions can be studied separately .",
    "furthermore , with a relatively simple rearrangement of the terms in the static limit the equations explicitly exhibit the kleinman symmetry .",
    "these equations are applicable to crystals of any symmetry unlike some of the earlier formulations which were restricted to crystals of cubic symmetry .",
    "we found excellent agreement with other ab - initio results when care is taken to use the same approximations for the underlying electronic structure .",
    "this was shown most convincingly for gaas , gap , and wurtzite gan and aln where it was possible to compare with calculations @xcite which differed from ours solely in the band structure method employed .",
    "excellent agreement was obtained for these materials both for the static values and for the frequency dependence .",
    "our static values are also in good accord with those obtained by an approach introduced by levine and allan @xcite which differs significantly from ours in the details of its implementation .    on the other hand , we find the results to be quite sensitive to the particular manner in which band gap corrections are applied .",
    "we found that the commonly used `` scissors '' approach has some deficiencies even when using the associated renormalization of the momentum matrix elements .",
    "we identified the loss of consistency between eigenfunctions and eigenvalues in this approach as a reason for underestimating the momentum matrix elements .",
    "we showed that a somewhat different approach , in which corrections are made to the one electron hamiltonian matrix which is then explicitly rediagonalized , improves the agreement with experiment both in the static limit and in the low frequency absorbing region . at present , the latter approach is applied essentially only to the lowest conduction bands .",
    "as such , it is not expected to improve the lda for the features relating to higher energy bands . because these are found generally to be of less importance for the optical spectra in the low energy region accessible to current experimental techniques ( even more strongly so in shg than in linear optics ) , this is not considered to be an important practical limitation .",
    "it is worth noting that this illustrates another advantage of the lmto method .",
    "its use of a physically transparent atomic orbital like basis set is what allowed us to implement rather easily some ad - hoc corrections to the hamiltonian which improve the band structure and capture the essential aspects of the physics .",
    "similarly , other corrections to the lda such as those required for highly correlated d - band and f - band systems in what is known as the lda@xmath123u approach are relatively easily included in lmto based methods . while our present approach for including corrections to the lda for semiconductors is not perfect and rather ad - hoc , there is hope that more rigourous approaches such as those based on the gw approximation @xcite or on the screened exchange approximation @xcite can be implemented in a similar manner .    in the process of testing our approach",
    ", we also found that the effective mass sum rule is satisfied typically to within 10 % by our lmto - asa computed momentum matrix elements and eigenvalues .",
    "this generally required including a somewhat higher angular momentum cut - off than that used in usual electronic structure calculations .",
    "the results for @xmath1 were generally found to converge even better than these sum rules showing that the latter constitutes a rather strict test of the accuracy of the momentum matrix elements . for the calculation of static values of @xmath1",
    ", we derived a separate set of equations which contain less singular terms to be summed over the brillouin zone . by employing a semi - analytical method in combination with linear interpolation of the energies and the matrix elements inside each microtetrahedron ,",
    "an efficient integration scheme over the brillouin zone was obtained .",
    "this scheme requires fewer @xmath41 points than that used for the frequency dependent response functions .",
    "the convergence of the shg coefficients with respect to the number of bands included in the summation was also found to be very good , and shows that the results are dominated by the low - lying bands .",
    "this reduces concerns about the accuracy of the higher lying bands in linear methods .",
    "decomposing @xmath124 into @xmath38 and @xmath45 resonant components was shown to be helpful in relating the band structure to the shg spectra .",
    "in was found that the method reported here for calculating @xmath1 based on the lmto codes is fast , flexible , and accurate .",
    "this approach should allow us to study the non - linear optical properties of systems containing a large number of atoms per unit cell such as heterostructures and superlattices .",
    "we thank dr .",
    "james hughes and prof .",
    "john sipe for sending their manuscript on gan and aln to us prior to publication .",
    "part of the computations were performed at the ohio supercomputer center .",
    "this work was supported in part by nsf ( dmr-95 - 29376 ) and afosr ( f49620 - 95 - 1 - 0043 ) .",
    "z. h. levine , phys .",
    "b * 42 * , 3567 ( 1990 ) .",
    "z. h. levine and d. c. allan , phys .",
    "* 66 * , 41 ( 1991 ) ; phys .",
    "b * 44 * , 12781 ( 1991 ) . z. h. levine , phys . rev .",
    "b * 49 * , 4532 ( 1994 ) . a. dal corso and f. mauri , phys .",
    "b * 50 * , 5756 ( 1994 ) ; a. dal corso , f. mauri , and a. rubio , phys . rev .",
    "b * 53 * , 15638 ( 1996 ) .",
    "d. j. moss , j. e. sipe , and h. m. van driel , phys .",
    "b * 36 * , 9708 ( 1987 ) .",
    "e. ghahramani , d. j. moss , and j. e. sipe , phys .",
    "b * 43 * , 8990 ( 1991 ) .",
    "e. ghahramani , d. j. moss , and j. e. sipe , phys .",
    "lett . , * 64 * , 2815 ( 1990 ) ; phys .",
    "b * 43 * , 9700 ( 1991 ) ; phys . rev .",
    "b * 43 * , 9269 ( 1991 ) .",
    "d. j. moss , e. ghahramani , j. e. sipe , and h. m. van driel , phys .",
    "rev b * 41 * , 1542 ( 1990 ) .",
    "huang and w. y. ching , phys .",
    "b * 47 * , 9464 ( 1993 ) , _ ibid .",
    "_ * 45 * , 8738 ( 1992 ) . w. y. ching and m .- z .",
    "huang , phys .",
    "b * 47 * , 9479 ( 1993 ) .",
    "j. e. sipe and e. ghahramani , phys .",
    "b * 48 * , 11705 ( 1993 ) . c. aversa and j. e. sipe , phys . rev .",
    "b * 52 * , 14636 ( 1995 ) .",
    "j. l. p. hughes and j. e. sipe , phys . rev .",
    "b * 53 * , 10751 ( 1996 ) .",
    "j. l. p. hughes , y. wang , and j. e. sipe , phys .",
    "13630 ( 1997 ) . j. chen , z. h. levine , and j. w. wilkins , phys .",
    "b * 50 * , 11514 ( 1994 ) .",
    "j. chen , z. h. levine , and j. w. wilkins , appl .",
    "lett . * 66 * , 1129 ( 1995 ) .",
    "r. atanasov , p. bassani , and v. m. agranovich , phys .",
    "b * 50 * , 7809 ( 1994 ) .",
    "l. tsang and s. -l .",
    "chuang , phys .",
    "b * 42 * , 5229 ( 1990 ) ; appl . phys",
    ". lett . * 60 * , 2543 ( 1992 ) .",
    "l. c. lew yan voon and l. r. ram - mohan , phys .",
    "b * 50 * , 14421 ( 1994 )",
    ". b. f. levine , phys .",
    "b * 7 * , 2600 ( 1973 ) .",
    "x. gonze and j. p. vigneron , phys .",
    "b * 39 * , 13120 ( 1989 ) .",
    "r. m. sternheimer , phys . rev . * 96 * , 951 ( 1954 ) , _ ibid . _ * 107 * , 1565 ( 1957 ) , _ ibid . _",
    "* 115 * , 1198 ( 1959 ) .",
    "s. baroni , p. giannozzi , and a. testa , phys .",
    "lett . * 58 * , 1861 ( 1987 ) .",
    "r. d. king - smith and d. vanderbilt , phys .",
    "b * 47 * , 1651 ( 1993 ) .",
    "r. resta , rev .",
    "phys . * 66 * , 899 ( 1994 ) .",
    "p. n. butcher and t. p. mclean , proc .",
    "( london ) , * 81 * , 219 ( 1963 ) , _ ibid . _ * 83 * , 579 ( 1964 ) .",
    "d. e. aspnes , phys .",
    "b * 6 * , 4648 ( 1972 ) .",
    "e. i. blount , in _ solid state physics : advances in research and applications _ , edited by f. seitz and d. turnbull ( academic , new york , 1962 ) , vol .",
    "13 , p. 305 .",
    "d. a. kleinman , phys .",
    "rev . * 126 * , 1977 ( 1962 ) .",
    "we do not claim to be the first to prove explicitly the kleinman symmetry of these equations .",
    "j. e. sipe mentioned to us that the toronto group had obtained a proof independently ( private communication ) .",
    "s. n. rashkeev ( unpublished ) . c. y. fong and y. r. shen , phys .",
    "b * 12 * , 2325 ( 1975 ) .",
    "o. k. andersen , phys .",
    "b * 12 * , 3060 ( 1975 ) .",
    "h. krakauer , m. posternak , a. j. freeman , phys . rev .",
    "b * 19 * , 1706 ( 1979 ) ; e. wimmer , h. krakauer , m. weinert , and a. j. freeman , phys . rev .",
    "b * 24 * , 864 ( 1981 )",
    ". o. k. andersen , o. jepsen , and m ob , in _ electronic band structure and its applications , _ edited by m. yussouf ( springer , heidelberg , 1987 ) , p. 1",
    "a. uspenski , e. g. maksimov , s. n. rashkeev , and i. i. mazin , z. phys .",
    "b -condensed matter * 53 * , 263 ( 1983 ) .",
    "m. alouani , l. brey , and n. e. christensen , phys .",
    "1167 ( 1988 ) . w. r. l. lambrecht , b. segall , w. suttrop , m. yoganathan , r. p. devaty , w. j. choyke , j. a. edmond , j. a. powell and m. alouani , appl .",
    "* 63 * , 2747 ( 1993 ) ; phys .",
    "b * 50 * , 10722 ( 1994 ) .",
    "w. r. l. lambrecht , b. segall , j. rife , w. r. hunter , and d. k. wickenden , phys .",
    "b * 51 * , 13516 ( 1995 ) .",
    "f. aryasetiawan and o. gunnarsson , phys .",
    "b * 49 * , 16214 ( 1994 ) ; _ ibid . _",
    "* 54 * , 17564 ( 1995 ) .",
    "j. miragliotta , d. k. wickenden , t. j. kistenmacher , and w. a. bryden , j. opt .",
    "b * 10 * , 1447 ( 1993 ) .",
    "f. g. parsons and r. k. chang , opt",
    "* 3 * , 173 ( 1971 ) .",
    "d. bethune , a. j. schmidt , and y. r. shen , phys .",
    "b * 11 * , 3867 ( 1975 ) .",
    "r. k. chang , j. ducuing , and n. bloembergen , phys .",
    "lett . * 15 * , 415 ( 1965 ) .",
    "z. h. levine and d. c. allan , phys .",
    "b * 43 * , 4187 ( 1991 ) .",
    "p. a. franken and j. f. ward , rev .",
    "phys . * 35 * , 23 ( 1963 ) .",
    "l. hedin and b. i. lundqvist , _ j. phys .",
    "c _ * 4 * , 2064 ( 1971 ) .",
    "f. aryasetiawan , and o. gunnarsson , phys . rev .",
    "7219 ( 1994 ) . m. alouani , j. m. koch , and m. a. khan , j. phys .",
    "f * 16 * , 473 ( 1986 ) .",
    "k. kim , w. r. l. lambrecht , and b. segall , phys .",
    "b ( to be published ) .",
    "s. limpijumnong , w. r. l. lambrecht , s. n. rashkeev , and b. segall ( unpublished ) .",
    "w. r. l. lambrecht , s. limpijumnong , s. n. rashkeev , and b. segall , phys .",
    "( b ) * 202 * , 5 ( 1997 ) .",
    "p. e. blchl , o. jepsen , and o. k. andersen , phys .",
    "b * 49 * , 16223 ( 1994 ) .",
    "r. w. godby , m. schlter , and l. j. sham , phys .",
    "b * 37 * , 10159 ( 1988 ) .",
    "o. gunnarsson and k. schnhammer , phys .",
    "lett . * 56 * , 1968 ( 1986 ) . w. r. l. lambrecht and b. segall , phys .",
    "b * 40 * , 7793 ( 1989 ) .",
    "w. g. aulbur , l. jnsson , and j. w. wilkins , phys .",
    "b * 54 * , 8540 ( 1996 ) .",
    "x. gonze , ph .",
    "ghosez , and r. w. godby , phys .",
    "lett . * 74 * , 4035 ( 1995 ) . l. hedin and s. lundqvist , in _ solid state physics _",
    ", edited by f. seitz , d. turnbull , and h. ehrenreich ( academic press , new york , 1969 ) , vol .",
    "23 , p. 1 .",
    "x. zhu , m. s. hybertsen , and s. g. louie , in _ atomic scale calculations of structure in materials _ , edited by m. s. daw and m. a. schlter , mrs symposia proceedings no .",
    "193 ( materials research society , pittsburgh 1990 ) , p. 113 .",
    "n. e. christensen , phys .",
    "b * 30 * , 5753 ( 1984 ) .",
    "j. chen ( private communication ) .",
    "y. fujii , s. yoshida , s. misawa , s. maekawa , and t. sakudo , appl .",
    ". lett . * 31 * , 815 ( 1977 ) .",
    "s. n. rashkeev , w. r. l. lambrecht , and b. segall ( unpublished ) .          .",
    "calculated longitudinal effective masses , @xmath125 , for a few valence and conduction bands of 3c - sic at the x - point of the bz .",
    "mme - the masses given by eq.([eq : sum2 ] ) using calculated the asa momentum matrix elements and band energies , for different @xmath86 , the maximum angular momentum included in the lmto hamiltonian .",
    "the last column gives the values of @xmath125 calculated directly by differentiating of the band energies @xmath126 obtained in the asa scheme . [ cols=\"<,^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> the development of a method for calculating the frequency dependent second harmonic generation coefficient of insulators and semiconductors based on the self - consistent linearized muffin - tin orbitals ( lmto ) band structure method is reported . </S>",
    "<S> the calculations are at the independent particle level and are based on the formulation introduced by aversa and sipe ( 1995 ) . </S>",
    "<S> the terms are re - arranged in such a way as to exhibit explicitly all required symmetries including the kleinman symmetry in the static limit . </S>",
    "<S> computational details and convergence tests are presented . </S>",
    "<S> the calculated frequency dependent @xmath0 for the zinc - blende materials gaas , gap and wurtzite gan and aln are found to be in excellent agreement with that obtained by other first - principles calculations when corrections to the local density approximation ( lda ) are implemented in the same manner , namely , using the `` scissors '' approach . </S>",
    "<S> similar agreement is found for the static values of @xmath1 for zincblende gan , aln , bn and sic . </S>",
    "<S> the strict validity of the usual `` scissors '' operator implementation is , however , questioned . </S>",
    "<S> we show that better agreement with experiment is obtained when the corrections to the low lying conduction bands are applied at the level of the hamiltonian , which guarantees that eigenvectors are consistent with the eigenvalues . </S>",
    "<S> new results are presented for the frequency dependent @xmath0 for 3c - sic . </S>",
    "<S> the approach is found to be very efficient and flexible which indicates that it will be useful for a wide variety of material systems including those with many atoms in the unit cell . </S>"
  ]
}