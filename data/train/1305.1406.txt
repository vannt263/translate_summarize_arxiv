{
  "article_text": [
    "for any positive integer @xmath0 , a _ latin square _ of order @xmath0 is an @xmath1 array of numbers in @xmath2=\\{1,\\ldots , n\\}$ ] , so that each row and each column of @xmath3 is a permutation of @xmath2 $ ] .",
    "a latin square is called _ reduced _ if its first row and first column are equal to the identity permutation .",
    "a _ line _ in @xmath3 is either a row or a column .",
    "let @xmath4 be the symmetric group of permutations of @xmath2 $ ] .",
    "isotopism _ is a triple @xmath5 that acts on the set of latin squares of order @xmath0 by permuting the set of rows of a latin square by @xmath6 , permuting the set of columns by @xmath7 , and permuting the symbols by @xmath8 .",
    "an _ autotopism _ of a latin square @xmath3 is an isotopism @xmath9 such that @xmath10 .",
    "the _ autotopy group _ of @xmath3 , denoted @xmath11 , is the group of autotopisms of @xmath3 .",
    "two latin squares are called _ isotopic _ if there is an isotopism that transforms one to the other .",
    "if @xmath3 and @xmath12 are isotopic , say @xmath13 , then their autotopy groups are related : @xmath14 .",
    "since every latin square is isotopic to a reduced latin square , we can study the structure and size of autotopy groups of general latin squares by exploring autotopy groups of reduced latin squares .",
    "for further knowledge about isotopisms and autotopisms the reader is referred to @xcite , among many others .",
    "autotopy groups , as well as ways to compute them , have been the subject of many studies .",
    "mckay @xcite introduced `` nauty '' , an algorithm for computing the symmetry groups of a graph , and used it to compute the various symmetry group of a latin square , including the autotopy group , by mapping the latin square to a certain graph .",
    "for some otherwise tough classes of latin squares , `` nauty '' can be accelerated by using vertex invariants such as the `` train '' introduced by wanless @xcite .    although the proportion of latin squares of order @xmath0 which have non - trivial autotopy group tends quickly to zero as @xmath0 grows ( mckay and wanless @xcite ) , some special latin squares of any order may have a large autotopy group ( see wanless @xcite ) .",
    "for example , if @xmath3 is the cayley table of a group @xmath15 of order @xmath0 then @xmath16 ( as mentioned in @xcite and @xcite and shown in @xcite and @xcite ) .",
    "browning , stones and wanless @xcite set the following general bound for the size of the autotopy group of a latin square @xmath3 of order @xmath0 : @xmath17 given a specific latin square @xmath3 , other bounds can be computed using easily computable features of @xmath3 . for example , viewing the rows and columns of a latin square as permutations in @xmath4 , and assuming that @xmath3 has @xmath18 rows of one parity ( even or odd ) and @xmath19 rows of the opposite parity , it was shown in @xcite that @xmath20 any permutation in @xmath21 can be written as a product of disjoint cycles - the _ cycle representation _ of @xmath22 .",
    "the lengths of these cycles define a partition of @xmath0 called the _ cycle structure _ of @xmath22 .",
    "the cycle structures of permutations have been considered in the context of latin squares in different aspects .",
    "cavenagh , greenhill and wanless @xcite considered the cycle structure of the permutation that transforms one row of a latin square to another row .",
    "falcn @xcite and stones , vojtchovsk and wanless @xcite considered the cycle structure of the permutations @xmath6 , @xmath7 and @xmath8 in a given isotopism @xmath23 , in order to derive information on latin squares for which @xmath9 is an autotopism .",
    "gauszka @xcite used the cycle structure of rows of latin squares , viewed as cayley tables of groupoids , in order to study the quasigroup structure of the groupoids . in @xcite",
    "the author used the cycle structure of the rows of a reduced latin square to obtain a bound on the size of the autotopy group : let @xmath3 be a reduced latin square and suppose @xmath24 is a partition of @xmath0 by the different cycle structures of the rows , then @xmath25    in this paper we introduce an algorithm that uses the cycle structure of the rows of @xmath3 for finding @xmath11 .",
    "the algorithm yields a bound for @xmath26 that involves cycle structure data .",
    "it is shown that for the family of reduced latin squares that have two rows or two columns that map from one to the other by a permutation having a bounded number of disjoint cycles , the autotopy group can be computed in polynomial time in @xmath0 .",
    "[ not0:1 ] for a latin square @xmath3 of order @xmath0 let @xmath27 be the rows of @xmath3 , viewed as permutations , and let @xmath28 be the columns of @xmath3 .    * convention : * when viewing a row or a column of a latin square as a permutation @xmath21 , it is understood that the number @xmath29 appearing in the @xmath30th place of @xmath22 signifies that @xmath31 .",
    "in this section we mention useful known results and introduce some notation .    [ not1:1 ]",
    "let @xmath3 be a reduced latin square .",
    "for any permutation @xmath32 and any column @xmath33 of @xmath3 let @xmath34 denote the isotopism @xmath35 .",
    "proposition  [ prop1:1 ] appears in different formulations in @xcite and @xcite .",
    "it describes the @xmath36 isotopisms that map a given reduced latin square to a reduced latin square .",
    "[ prop1:1 ] let @xmath3 be a reduced latin square .    1 .   for any permutation @xmath32 and any column @xmath33 of @xmath3 ,",
    "the latin square @xmath37 is reduced .",
    "2 .   if @xmath9 is an isotopism such that @xmath38 is reduced then @xmath39 for some @xmath32 and some column @xmath33 of @xmath3 .",
    "the next proposition from @xcite describes the effect of applying @xmath34 on a single row of a latin square ( the slight difference from the original in @xcite is due to the different convention used there to interpret a line in a latin square as a permutation ) .",
    "[ prop1:2 ] let @xmath3 be a reduced latin square of order @xmath0 with row permutations @xmath27 and column permutations @xmath40 .",
    "let @xmath34 be an isotopism as defined in notation  [ not1:1 ] .",
    "let @xmath41 and let @xmath42 be the rows of @xmath12 .",
    "then , for all @xmath43 , @xmath44 in particular , if @xmath45 , then for all @xmath43 , @xmath46    [ not1:5 ] for a permutation @xmath21 let @xmath47 denote the number of cycles in the cycle representation of @xmath22 ( including cycles of length 1 ) . for a latin square @xmath3 of order @xmath0 let @xmath48",
    ".    [ not2 ] let @xmath3 be a reduced latin square of order @xmath0 . for any @xmath49 $ ] let @xmath50 denote the number of rows with the same cycle structure as the row @xmath51 .",
    "let @xmath52 .",
    "[ ex0:1 ] consider the following reduced latin square @xmath3 of order 8 : @xmath53 the cycle representations of the rows of @xmath3 , grouped by cycle structure , are : @xmath54 we have @xmath55 .",
    "also , @xmath56 and @xmath57 for @xmath58 .",
    "thus , @xmath59 .",
    "[ not3 ] let @xmath3 be a reduced latin square of order @xmath0 with row permutations @xmath27 .",
    "for any @xmath60 $ ] denote by @xmath61 the permutation @xmath62 .",
    "denote by @xmath63 the set of integers @xmath49 $ ] such that the multiset of cycle structures of @xmath64 is the same as the multiset of cycle structures of @xmath27 .",
    "let @xmath65 .    if @xmath3 is the cayley table of a finite group of order @xmath0 , then @xmath66 for all @xmath49 $ ] .",
    "thus , @xmath67 .    [ obs0 ]",
    "let @xmath3 be a reduced latin square of order @xmath0 and let @xmath68 . if @xmath18 is in the @xmath6-orbit of 1 , then @xmath69 .",
    "suppose @xmath70 for some @xmath71 .",
    "since @xmath11 is a group , @xmath72 . note that @xmath73 for some @xmath74 $ ] , by proposition  [ prop1:1 ] .",
    "let @xmath75 .",
    "we have @xmath76 .",
    "since @xmath77 we have @xmath78 for all @xmath43 , by ( [ eq6:02 ] ) .",
    "thus , @xmath69 .",
    "[ not4 ] let @xmath3 be a reduced latin square of order @xmath0 and suppose @xmath69 .",
    "for any @xmath79 $ ] let @xmath80 : \\sigma_t { \\text{\\textnormal { and } } } \\sigma_{i , k}{\\text{\\textnormal { have the same cycle structure}}}\\}.\\ ] ]    the following two observations follow directly from ( [ eq6:02 ] ) :    [ obs1 ] let @xmath3 be a reduced latin square of order @xmath0 . if @xmath69 , then @xmath81 and @xmath82 for all @xmath79 $ ] .",
    "[ obs2 ] let @xmath3 be a reduced latin square of order @xmath0 and let @xmath68 . if @xmath83 , then for any @xmath79 $ ] , @xmath84    since there are @xmath0 options for @xmath33 in proposition  [ prop1:1 ] and @xmath85 the bound in ( [ eq1:3 ] ) follows .",
    "[ ex1 ] the latin square @xmath3 in example  [ ex0:1 ] has @xmath86 .",
    "the cycle representations of @xmath87 are :    @xmath88    we have @xmath89 , @xmath90 , @xmath91 , and @xmath92 .",
    "let @xmath3 be a reduced latin square and let @xmath93 be a row permutation in @xmath3 with minimal number of cycles .",
    "we shall construct isotopisms @xmath34 that fix @xmath93 . by ( [ eq6:02 ] )",
    "we have , @xmath94 the construction of @xmath45 goes as follows : we first choose @xmath95 and @xmath96 .",
    "then choose @xmath30 and compute @xmath97 .",
    "then we use equation ( [ eq3:1 ] ) to determine @xmath6 , and thus we have a candidate @xmath34 . finally , we check whether @xmath34 fixes the other rows . due to the different constraints ,",
    "most @xmath34 s will be eliminated along the way and only a small fraction will reach the final stage .    here is a detailed description of the algorithm :    * step 1 : * as already mentioned , we choose a row @xmath93 in @xmath3 with a minimal number of cycles , i.e. @xmath98 .",
    "the index @xmath99 will remain constant throughout the algorithm .",
    "* step 2 : * we next wish to choose @xmath100 . by observation  [ obs0",
    "] , we must choose @xmath18 from @xmath63 .",
    "we have @xmath101    we define the binary matrix @xmath102 as the @xmath1 matrix whose @xmath103 entry is 1 if and only if @xmath61 has the same cycle structure as @xmath104 .",
    "this means that there might be an autotopism @xmath105 of @xmath3 such that @xmath106 , by observation  [ obs2 ] .",
    "any all-1 s generalized diagonal in @xmath102 corresponds to a possible such permutation @xmath6 .",
    "( the term _ generalized diagonal _ of an @xmath1 matrix refers to a set of @xmath0 entries belonging to distinct rows and distinct columns . )",
    "[ rem2 ] if we group the rows @xmath107 of @xmath102 by the cycle structures of @xmath64 and group the columns @xmath108 of @xmath102 by the cycle structures of @xmath109 ( as in ( [ eq : cs1 ] ) and ( [ eq : cs2 ] ) ) , keeping the original row and column indexes , the resulting matrix consists of all-1 s square blocks in the diagonal and 0 s elsewhere .",
    "for example , the matrices @xmath110 and @xmath111 for the latin square @xmath3 in example  [ ex0:1 ] , after such row and column rearrangements ( and omitting the 0 s for clarity ) are     + respectively , where the indexes on the top and on the left represent the original row numbers .    * step 3 : * we next choose @xmath112 . by observation  [ obs2 ] , we must choose @xmath29 from @xmath113 .",
    "we have @xmath114 we compute @xmath61 . by ( [ eq3:2 ] ) and ( [ eq3:3 ] ) , equation ( [ eq3:1 ] )",
    "can be rewritten as @xmath115    * step 4 : * we next choose a column @xmath33 and compute @xmath116 .",
    "we have , by ( [ eq3:4 ] ) , @xmath117    * step 5 : * we manipulate the matrix @xmath102 in the following way :    1 .",
    "we rearrange the rows by the cycle representation of @xmath118 while keeping the original indexes .",
    "that is , for each cycle of @xmath118 , the rows indexed by its elements will be adjacent and the order in which the rows will be arranged will be the same as the order of the corresponding indexes within the cycle .",
    "2 .   in a similar manner , we rearrange the columns by the cycle representation of @xmath119 while keeping the original indexes .",
    "we switch all the 1 s in the row indexed by @xmath29 , except for the 1 in the column indexed by @xmath99 and all the 1 s in the column indexed by @xmath99 , except for the 1 in the row indexed by @xmath29 ( by ( [ eq3:3 ] ) ) .",
    "in the row indexed by 1 we switch all the 1 s that are not in columns indexed by elements of @xmath63 ( by observation  [ obs0 ] ) .",
    "in the row indexed by @xmath18 we switch all the 1 s , except for the 1 in the column indexed by @xmath120 and all the 1 s in the column indexed by @xmath120 , except for the 1 in the row indexed by @xmath18 ( by ( [ eq3:2 ] ) ) .",
    "we subdivide the matrix into blocks according to the cycles of @xmath118 and @xmath119 ( that is , the rows of each block are indexed by the numbers in a cycle of @xmath118 and the columns of each block are indexed by the numbers in a cycle of @xmath119 ) .",
    "then , switch all the 1 s that appear in non - square blocks .",
    "the resulting matrix will be denoted @xmath121 .",
    "* step 6 : * this step constitutes most of the work .",
    "we shall use the following definition and proposition :    a _ shifted diagonal _ in a square matrix @xmath122 of order @xmath123 is a set of cells @xmath124 , for some @xmath125 , where the indexes @xmath126 are taken modulo @xmath123 plus 1 . here is an illustration of a shifted diagonal : @xmath127 we shall use the term _ block shifted diagonal _ for a shifted diagonal inside a square block of a given matrix .",
    "[ prop3:1 ] for any @xmath68 there exist @xmath69 and @xmath128 so that @xmath6 is defined by an all-1 s generalized diagonal @xmath129 of @xmath121 , which satisfies the following property :    1 .",
    "for any block @xmath130 in the subdivision of @xmath121 ( described in step 5(4 ) above ) , either @xmath131 or @xmath132 is a shifted diagonal of @xmath130 .",
    "since @xmath6 is defined by a generalized diagonal of @xmath133 , it still corresponds to a generalized diagonal after the rearrangements described in step 5(1 ) and step 5(2 ) . by ( [ eq3:5 ] ) and",
    "the identity @xmath134 for any number @xmath135 $ ] , @xmath136 and @xmath137 appear in cycles of the same size of @xmath118 and @xmath93 , respectively .",
    "thus , by the rearrangement described in step 5(1 ) and step 5(2 ) and the subdivision described in step 5(4 ) , the intersection of @xmath129 with any non - square block must be empty , and thus we can switch the 1 s in these blocks .",
    "let @xmath138 be a cycle in the cycle representation of @xmath118 . by ( [ eq3:6 ] ) , all the numbers appearing in @xmath138 are mapped by @xmath6 to a set of numbers that form a cycle @xmath139 in the cycle representation of @xmath93 .",
    "let @xmath140 be the block in the subdivision of @xmath121 whose rows are indexed by the elements of @xmath138 and whose columns are indexed the elements of @xmath139 .",
    "thus , @xmath141 is a generalized diagonal of @xmath130 .",
    "suppose @xmath71 succeeds @xmath136 in the cycle @xmath138 ( this means that either @xmath71 appears immediately to the right of @xmath136 , or @xmath136 is the rightmost element in @xmath138 and @xmath71 is the leftmost one ) , then by ( [ eq3:6 ] ) , @xmath142 succeeds @xmath137 in @xmath139 .",
    "thus , the 1 s in the entries @xmath143 and @xmath144 in @xmath121 are positioned in the block @xmath140 in one of the four ways described in figure  [ fig1 ] . in any case",
    ", they are part of a shifted diagonal of @xmath130 .    the problem of finding @xmath11 is now reduced to finding the all-1 s shifted diagonals in the square blocks of @xmath121 , for each @xmath145 and @xmath18 .",
    "in order to do this we do nt have to iterate over all @xmath146 blocks .",
    "instead , we can iterate over all @xmath147 cycles of @xmath93 . for each such cycle @xmath138",
    ", we look at the columns indexed by its members , and consider the column with the least number of 1 s . for each 1 in this column , we check whether it is part of an all-1 s shifted diagonal in its block .",
    "if in the columns indexed by some cycle of @xmath93 , there is not a single all-1 s block shifted diagonal , then , clearly , there will be no all-1 s generalized diagonal that satisfies the property ( * ) in @xmath121 .",
    "hence , there is no need to check the rest of the cycles , and consequently , we can skip the rest of the steps in the algorithm and move on to the next matrix @xmath121 .    *",
    "step 7 : * after finding the all-1 s block shifted diagonals in @xmath121 ( assuming that each cycle of @xmath93 defines at least one ) we combine them into generalized diagonals of @xmath121 .",
    "this will yield isotopisms @xmath34 that fix the row @xmath93 ( and , of course , the row @xmath148 , since all isotopisms of the form @xmath34 fix the first row ) .",
    "* step 8 : * we use ( [ eq6:01 ] ) to check whether these @xmath34 s fix the other @xmath149 rows .",
    "all the elements of @xmath11 constructed by this algorithm are distinct . to see this , first note that any two autotopisms @xmath34 and @xmath150 arising from the same matrix @xmath121 are distinct , since they correspond to different diagonals of @xmath121 , so @xmath151 . now ,",
    "suppose @xmath34 and @xmath152 arise from @xmath121 and @xmath153 , respectively .",
    "if @xmath154 , then the autotopisms are clearly distinct . if either @xmath155 or @xmath156 , then @xmath151 by ( [ eq3:2 ] ) and ( [ eq3:3 ] )",
    ".    [ rem4 ] the algorithm was tested on 20,000 randomly generated latin squares ( by jacobson matthews method @xcite ) of each of the orders 10 , 15 , 20 , 25 , and 30 .",
    "the running times on an intel core i7 processor were 1.2 , 2.1 , 3.1 , 4.3 , and 5.7 seconds , respectively .",
    "the algorithm was also tested on an assortment of latin squares with relatively small nontrivial autotopy group , produced by a program written for @xcite .",
    "for 5000 latin squares of each of the orders 10 , 15 , 20 , 25 , and 30 , the times in seconds were 2.7 , 3.7 , 8.0 , 15.4 , and 23.4 .",
    "it is worth noting the slow rate of growth as the order @xmath0 increases .",
    "[ ex5 ] consider the latin square in example  [ ex0:1 ] .",
    "we take @xmath157 .",
    "thus , the columns in any @xmath158 are arranged by the cycles of @xmath159 .",
    "we illustrate three different scenarios :    1 .   a candidate @xmath34 that is not an autotopism : let @xmath160 , @xmath161 and @xmath162 .",
    "so , @xmath163 and @xmath164 ( by ( [ eq3:2 ] ) and ( [ eq3:3 ] ) ) .",
    "we have @xmath165 ( see ( [ eq : cs1 ] ) ) and @xmath166 .",
    "after rearranging the rows and columns of @xmath110 ( in remark  [ rem2 ] ) by the cycles of @xmath167 and @xmath168 respectively , and deleting 1 s according to step 5(3 ) and step 5(4 ) , we obtain the following matrix @xmath169 : @xmath170 in which the only all 1 s generalized diagonal satisfying the property ( * ) is underlined .",
    "this yields @xmath171 where @xmath172 .",
    "as explained above , @xmath171 was constructed to fix the first and seventh rows of @xmath3 .",
    "however , @xmath173 since it does not fix all the other rows . 2 .",
    "an autotopism : let @xmath174 , @xmath161 and @xmath175 .",
    "so , @xmath176 and @xmath164 .",
    "we have @xmath177 ( see ( [ eq : cs2 ] ) ) and @xmath178 .",
    "if we rearrange the rows of the matrix @xmath111 ( in remark  [ rem2 ] ) by the cycles in @xmath179 , and rearrange its columns by the cycles in @xmath168 and delete 1 s according to(3 ) and step 5(4 ) , we obtain the following matrix @xmath180 : @xmath181 we see that there is only one shifted diagonal in each square block ( which happens to be the main diagonal ) .",
    "these yield an isotopism @xmath182 , where @xmath183 . after verifying that @xmath182 fixes all other rows",
    "we conclude that @xmath184 ( this is the only nontrivial autotopism of @xmath3 ) .",
    "3 .   no candidates : let @xmath174 , @xmath185 and @xmath186 .",
    "so , @xmath176 and @xmath187 .",
    "we have @xmath188 ( see ( [ eq : cs2 ] ) ) and @xmath189 .",
    "if we rearrange the rows of @xmath111 by the cycles in @xmath190 , and the columns by the cycles in @xmath168 , and delete 1 s according to step 5(3 ) and step 5(4 ) , we obtain the following matrix @xmath191 : @xmath192 since there are no 1 s in the row indexed by 1 , the matrix @xmath191 does nt yield any candidate to check in step 8 .    for most latin squares",
    "checked , the matrices @xmath158 are as sparse as the ones illustrated above . only for highly structures",
    "latin squares we have dense matrices that produce a large number of diagonals satisfying property ( * ) .",
    "such highly structured latin squares are best handled by accelerated versions of `` nauty '' .",
    "the algorithm described in the previous section yields a bound on the size of @xmath11 . for convenience we introduce a new notation :    [ not6 ] let @xmath3 be a latin square and let @xmath138 be a cycle in some row permutation of @xmath3 .",
    "denote @xmath193 .",
    "[ thm4:1 ] let @xmath3 be a reduced latin square of order @xmath0 and let @xmath93 be a row in @xmath3 whose cycle representation contains @xmath194 disjoint cycles .",
    "suppose @xmath195 is the cycle representation of @xmath93 and assume @xmath196 .",
    "then , @xmath197    there are @xmath198 possible values of @xmath69 , @xmath199 possible values of @xmath128 ( by observation  [ obs2 ] ) and @xmath0 possible columns @xmath33 .",
    "hence , there are @xmath200 distinct matrices @xmath121 .",
    "consider one such matrix @xmath121 . by the discussion in the previous section",
    ", it defines all autotopisms @xmath34 of @xmath3 satisfying @xmath83 and @xmath201 . by proposition  [ prop3:1 ] , the number of all-1 s generalized diagonals in @xmath121 satisfying the property ( * ) is an upper bound for the number of such autotopisms . by property ( * ) , any such diagonal is composed of all-1 s block shifted diagonals in the subdivision of @xmath121 defined in step 5(4 ) .",
    "the columns of each such block are indexed by a different cycle of @xmath93 .",
    "let @xmath138 be a cycle in the cycle representation of @xmath93 .",
    "the number of all-1 s shifted diagonals in the columns indexed by the members of @xmath138 is at most @xmath202 ( by observations  [ obs1 ] and [ obs2 ] ) .",
    "thus , the number of all-1 s generalized diagonals in @xmath121 satisfying the property ( * ) is at most @xmath203 . by the deletions performed in step(3 ) , the columns defined by the cycle @xmath204 containing @xmath99 can have at most one all-1 s shifted diagonal .",
    "hence , we omit @xmath205 from the product .",
    "[ ex3 ] consider the latin square @xmath3 in example  [ ex0:1 ] .",
    "the row @xmath159 has @xmath55 cycles .",
    "also , @xmath206 ( there are 3 rows with the same cycle structure ) .",
    "now , @xmath207 and for @xmath208 , @xmath209 .",
    "thus , by ( [ eq4:1 ] ) , @xmath210 .    the next proposition is closely related to the classical result that all principal loop isotopes of a loop agree if and only if the loop is a group ( see , e.g. , @xcite ) .",
    "[ prop4:1 ] if equality holds in ( [ eq4:1 ] ) for a reduced latin square @xmath3 , then @xmath3 is the cayley table of a group .",
    "let @xmath45 .",
    "since equality holds in ( [ eq4:1 ] ) , we must have @xmath211 for all other @xmath49 $ ] .",
    "thus , for any @xmath212 $ ] , we have , @xmath213 let @xmath214 and @xmath215 .",
    "we have , @xmath216 .",
    "it follows from the convention at the end of section  [ sec1 ] that after permuting the columns of @xmath3 by @xmath7 , the first row becomes @xmath217 , and we have to apply @xmath7 on the symbols in order to transform the first row back into the identity permutation .",
    "hence , we have @xmath218 . by proposition  [ prop1:1](ii ) ,",
    "@xmath219 for some column @xmath30 .",
    "we have @xmath220 .",
    "since this holds for any two columns @xmath221 and @xmath222 , it follows that the columns of @xmath3 form a subgroup of @xmath4 .",
    "this implies that @xmath3 is the cayley table of some group ( see @xcite ) .",
    "the converse of proposition  [ prop4:1 ] is not true .",
    "that is , if @xmath3 is the cayley table of a group , equality in ( [ eq4:1 ] ) does not necessarily hold .",
    "however , for a large family of groups this is the case , showing that the bound in ( [ eq4:1 ] ) is tight :    if @xmath3 is the cayley table of a cyclic group , then equality holds in ( [ eq4:1 ] ) .",
    "suppose @xmath3 is the cayley table of the cyclic group @xmath15 . by ( [ eq1:0 ] ) , @xmath223 ( euler function ) . on the other hand , since @xmath3 is the cayley table of a group , @xmath67 .",
    "the rows of @xmath3 , viewed as permutations , form a subgroup of @xmath4 that is isomorphic to @xmath15 , where the rows act by left composition .",
    "since @xmath15 is cyclic , each of its generators corresponds to a row that is a single cycle .",
    "so , there are @xmath224 single cycle rows in @xmath3 .",
    "let @xmath93 be a single cycle row . by ( [ eq4:1 ] ) , @xmath225 .",
    "thus , we have equality .",
    "the non - polynomial part of the algorithm is where the block shifted diagonals need to be combined to form generalized diagonals of @xmath121 ( step 6 ) .",
    "the complexity of this step is of order @xmath226 .",
    "since @xmath147 is not bounded , the algorithm , in the worst case , is of order @xmath227 .",
    "however , as we shall see , in the vast majority of the cases , @xmath147 is bounded and low , and for latin squares that are not highly structured , the number of block shifted diagonals that need to be combined is low , if they exist at all .",
    "if we bound @xmath147 , the complexity of the computation of @xmath11 is polynomial :    [ thm5:1 ] let @xmath18 be a fixed positive integer .",
    "for the set of all reduced latin squares @xmath3 that have a row or a column with at most @xmath18 cycles , @xmath11 satisfies @xmath228 and it can be computed in polynomial time in @xmath0 .    without loss of generality",
    "we may assume that @xmath3 contains a row @xmath93 that decomposes into at most @xmath18 cycles .",
    "thus , @xmath229 ( if it is a column we take @xmath230 .",
    "the relation between @xmath11 and @xmath231 is obvious ) .",
    "the computation of each one of the matrices @xmath121 is of polynomial complexity , since only elementary operations with permutations in @xmath4 are involved , and there are @xmath232 such matrices .",
    "as noted in step 6 , each cycle @xmath138 of @xmath93 , except for the cycle containing 1 and @xmath99 , requires at most @xmath233 iterations in order to find its corresponding all-1 s block shifted diagonals .",
    "thus , the process of finding all the all 1 s generalized diagonals satisfying the property ( * ) requires at most @xmath234 iterations .",
    "thus , ( [ eq5:1 ] ) follows . since @xmath235 and @xmath236 , the computation of @xmath11 is polynomial in @xmath0 .    since many latin squares have a line that is a single cycle , we single out this case :    [ cor4:1 ] let @xmath3 be a reduced latin square of order @xmath0 such that at least one of its lines is a single cycle , then @xmath237    in order to estimate the proportion of reduced latin squares having a line that decomposes into at most @xmath18 cycles , we assume that there is weak dependence between the cycle structures of the lines .",
    "this has not been proved but seems to be the case , as indicated by the experiment described in the next paragraph .",
    "let @xmath238 be the probability that a randomly chosen reduced latin square has a line with at most @xmath18 cycles .",
    "we shall try to approximate @xmath239 .",
    "there are approximately @xmath240 derangements ( permutations without fixed points ) of order @xmath0 , among which @xmath241 are single cycles .",
    "thus , the probability of each line , that is not the first row or the first column , of being a single cycle is approximately @xmath242 . assuming the weak dependence mentioned above , the probability that none of the rows @xmath243 and columns @xmath243 is a single cycle is approximately @xmath244 for large @xmath0 .",
    "thus , @xmath245 . indeed , 99,580 of 100,000 randomly generated reduced latin squares of order 20 had at least one single cycle line .",
    "the probability that a random derangement of order 20 has at most 2 cycles is @xmath246 .",
    "thus , assuming the weak dependence mentioned above , we have @xmath247 .",
    "( the number of @xmath0-derangements with exactly @xmath18 cycles , denoted @xmath248 , can be computed using the recurrence relations @xmath249 when @xmath250 , and @xmath251 when @xmath252 , with base case @xmath253 . )",
    "given two rows , indexed @xmath254 and @xmath136 , of a latin square , cavenagh , greenhill and wanless @xcite defined @xmath255 as the permutation that transforms @xmath256 to @xmath257 .",
    "that is , @xmath258 .",
    "it is said that the rows @xmath254 and @xmath136 _ have relative cycle structure _",
    "@xmath259 if the cycle structure of @xmath255 is @xmath259 ( this definition is symmetric in @xmath254 and @xmath136 since the cycle structure of a permutation and its inverse are the same ) .",
    "we have :    [ thm5:2 ] let @xmath18 be a fixed positive integer . for the set of",
    "all reduced latin squares @xmath3 that have two rows or two columns with relative cycle structure containing at most @xmath18 cycles , @xmath11 satisfies @xmath260 and it can be computed in polynomial time in @xmath0 .",
    "let @xmath3 be a reduced latin and assume @xmath255 has at most @xmath18 cycles . let @xmath6 be a permutation satisfying @xmath261 and let @xmath34 be an isotopism defined by some column @xmath33 of @xmath3 as in proposition  [ prop1:1 ] .",
    "let @xmath262 and let @xmath41 . by ( [ eq6:01 ] ) , @xmath12 has a row whose cycle structure has at most @xmath18 cycles .",
    "since @xmath263 can be computed in polynomial time , so can @xmath11 . by ( [ eq5:1 ] ) , @xmath264 .",
    "let @xmath265 be the probability that a randomly chosen reduced latin square has either two rows or two columns with a relative cycle structure containing at most @xmath18 cycles .",
    "we try to approximate @xmath266 .",
    "it was conjectured in @xcite that @xmath255 shares the asymptotic distribution of a random derangement .",
    "this means that the probability that @xmath255 is a single cycle would be approximately @xmath242 . assuming this and the weak dependence mentioned in the paragraph following corollary  [ cor4:1 ] we obtain that @xmath267 , which tends very quickly to 1 .",
    "this agrees with the result of mckay and wanless @xcite who proved that the proportion of order @xmath0 latin squares which have a non - trivial symmetry tends very quickly to zero .",
    "however , if the conjecture in @xcite holds , then we have a slightly different statement , namely , that the proportion of latin squares for which the computation of @xmath11 is polynomial tends very quickly to 1 .",
    "i thank ian wanless for providing the programs for generating latin squares for the experiments mentioned in remark  [ rem4 ] .",
    "i thank an anonymous referee for a thorough reading of the manuscripts , for introducing many improvements , and for bringing the bryant - schneider paper to my attention ."
  ],
  "abstract_text": [
    "<S> an algorithm that uses the cycle structure of the rows , or the columns , of a latin square to compute its autotopy group is introduced . as a result , </S>",
    "<S> a bound for the size of the autotopy group is obtained . </S>",
    "<S> this bound is used to show that the computation time for the autotopy group of latin squares that have two rows or two columns that map from one to the other by a permutation which decomposes into a bounded number of disjoint cycles , is polynomial in the order @xmath0 . </S>"
  ]
}