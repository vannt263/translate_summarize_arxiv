{
  "article_text": [
    "in the late 1980s , the milky way s spheroid population was described as slowly rotating , with density distribution given by @xmath5 @xcite . there was a controversy concerning the flattening of the spheroid , since kinematic studies of the spheroid stars suggested a flatter spheroid @xcite and star counts often suggested a more spherical spheroid @xcite . by early in the 21@xmath6 century , the spheroid was still thought of as a smooth power law distribution , but studies were starting to show that the shape of the spheroid depended on the type of star being observed , and it was noted that at least some of the spheroid , if not all , was composed of debris from hierarchical structure formation @xcite .",
    "the sagittarius ( sgr ) dwarf galaxy @xcite and its associated tidal stream @xcite was the one known example of merging in the present day . in the last ten years",
    ", the discovery of substructure has dominated the discussion of the galactic spheroid .",
    "the discovery of substructure has been driven primarily by the sloan digital sky survey ( sdss ) and the related sloan extension for galactic understanding and exploration ( segue ) , but other surveys such as the quasar equatorial survey team ( quest ) and the two micron all sky survey ( 2mass ) have also been influential .",
    "discoveries include new tidal debris streams , dwarf galaxies , and globular clusters .    the positions , velocities , and metallicities of sgr dwarf spheroidal tidal debris stars have been measured all across the sky @xcite .",
    "these measurements have then been compared with models of tidal disruption @xcite .",
    "given that the data spans three spatial dimensions plus radial velocities , but both the models and data are presented in papers primarily as two dimensional plots , it has been difficult to make detailed comparisons in multidimensional space .",
    "in this paper we develop a technique that would allow us to create a catalog of stars that has the same spatial distribution as the stars in the sgr tidal stream .",
    "that catalog could then be made available to the modeling community , who would be able to transform the coordinates into whatever system they find most natural to make comparisons .",
    "at least three newly discovered tidal debris streams are thought to be associated with dwarf galaxies , including : the monoceros stream in the galactic plane @xcite , the virgo stellar stream @xcite , and the orphan stream ( grillmair 2006 ) in the field of streams@xcite . an additional piece of tidal debris was found in triangulum - andromeda by @xcite which might be part of the monoceros stream @xcite .",
    "tidal tails spanning many tens of degrees across the sky have been found around pal 5 @xcite , and ngc 5466 @xcite .",
    "@xcite find a similar - looking tidal stream for which there is no known progenitor globular cluster .",
    "eight new low surface brightness dwarf galaxy satellites of the milky way have been discovered @xcite , nearly doubling the number of known milky way dwarfs .",
    "@xcite suggest that there is a new structural component of the spheroid called the hercules - aquila cloud .    with all of this substructure detected in the densities of spheroid stars",
    ", one wonders how much of the spheroid is smooth , and what the shape of the smooth spheroid might be .",
    "it is no wonder that standard galactic models , such as the the besanon model @xcite , which uses a power law density profile , do not match the sdss star counts .",
    "the spheroid shape is a current controversy as @xcite has found prolate models favorable while @xcite has found oblate models best .",
    "the large number of very significant over - densities of stars in the spheroid show that pencil beam studies and studies that extrapolate from the solar neighborhood could be contaminated by local structure and may not be indicative of the global shape of the milky way spheroid .",
    "recent results from f turnoff stars from the sdss suggest the smooth component of the spheroid might be asymmetric about the galactic center , so that no axially symmetric spheroid model can be fit @xcite .",
    "however , accurate measurements of the smooth component require that spatial substructure be identified and quantified  otherwise it is difficult to know which stars to fit to smooth spheroid models .",
    "we need to develop a model that is as complex as the data . in this paper",
    "we start this process by developing a maximum likelihood method that can be used to fit a smooth stellar spheroid containing one debris stream , using one 2.5@xmath7 stripe of sdss data , and show that our algorithm produces the correct results on a simulated dataset . in the future",
    ", we will extend the algorithm to include larger datasets with multiple pieces of debris .",
    "the long - term goal is to develop a model of the spheroid that fits the observed , lumpy density distribution of stars in the spheroid .",
    "the sdss is a large , international collaboration that was originally established to find the largest structures of galaxies in the universe from an imaging survey of 10,000 sq .",
    "deg . of sky and spectra of 1,000,000 galaxies selected from the photometry ( from images ) .",
    "the sdss can simultaneously obtain 640 spectra per pointing , using two 320-fiber double ( blue / red ) spectrographs .",
    "the angular position of a galaxy in the sky is easy to measure from the imaging survey , and for distant galaxies the distance is well estimated from a spectroscopic measurement of the hubble redshift . by combining the imaging with the spectroscopic survey ,",
    "the sdss has built up a three dimensional picture of the distribution of galaxies in the universe using a dedicated 2.5 meter telescope at apache point observatory in new mexico @xcite .",
    "images are obtained with an array of thirty @xmath8 pixel ccd cameras operated in a drift - scan ( time delay and integrate , tdi ) mode , which produces six  scan lines \" of imaging data that are each 13.6 wide and grow longer at a rate of 15 degrees per hour for the length of that  run . \" in each of the six  scan lines , \" the sky is imaged in five optical filters : @xmath9 and @xmath10 ; the time at which each astronomical object is imaged is a few minutes different for each passband . when a second set of six scan lines is observed that fill in the gaps between the first set of six scan lines , they produce a contiguous  stripe \" of data of width @xmath3 and length that depends on the length of time the sky was observed in the  runs . \"",
    "each @xmath3-wide stripe follows a defined great circle on the sky , and is built up of two or more  runs \" of data , as many runs as are needed to traverse the sdss survey area .",
    "the entire sky is divided up into 144 numbered stripes that start and end at the survey poles : @xmath11 and @xmath12 .",
    "stripes 10 and 82 are centered on the celestial equator , with stripe 10 in the north galactic cap and stripe 82 in the south galactic cap .",
    "the other stripes are sequentially numbered with inclinations 2.5 degrees apart .",
    "if the entire length ( @xmath13 ) of every stripe were imaged , we would have @xmath14 sq .",
    "degrees of imaging data for a sky that is @xmath15 sq .",
    "the overlaps between stripes increase towards the survey poles .",
    "since the sdss generally observes only parts of the sky that are more than @xmath16 from the survey poles , there is about 50% overlap at the ends of the stripes and very little overlap on the survey equator , which is at ra@xmath17 . with the release of sdss dr6 @xcite , a contiguous 8500 sq .",
    "area of the north galactic cap is now publicly available .",
    "it is pieced together with 31 adjacent sdss stripes .",
    "three stripes of data are available in the south galactic cap , including stripe 82 on the celestial equator .",
    "further information about the sdss , including survey geometry , can be found in : @xcite , @xcite , @xcite , @xcite , @xcite , @xcite , @xcite .    because the imaging survey is large and well calibrated , and because the spectroscopic survey included many galactic stars , in some cases by design and in some cases accidentally , the sdss has made a significant contribution to our knowledge about the milky way , and in particular the discovery of substructure in the spheroid component , as we discussed above .",
    "because of this , sdss has been expanded to include a new project , the sloan extension for galactic understanding and exploration ( segue ) .",
    "this extension will eventually include 3500 sq .",
    "deg . of new imaging data which is collected in @xmath3-wide great circles on the sky , but these great circles do not in general match those laid out on the sky for the sdss , and they are not adjacent to each other so they do not fill contiguous areas of the sky .",
    "the positions of these stripes were chosen to sparsely sample all directions in the sky that are visible from apache point observatory , and include scans at constant galactic longitude that pass through the galactic plane .",
    "segue will also obtain @xmath18 spectra of galactic stars to study stellar populations and kinematics .",
    "in this paper , we wish to use the photometry derived from imaging of galactic stars to trace the three dimensional shape of the galactic spheroid and the substructure , including tidal streams , contained within it . in this demonstration of the algorithm and the results from running it",
    ", we will focus on only one well - studied stripe of sdss data : stripe 82 on the celestial equator .",
    "we use only f turnoff stars in 300 square degrees of this stripe , roughly centered on the place where the sgr stream crosses it . unlike galaxies , the distances of stars can not be inferred from their radial velocities . by selecting only stars with colors consistent with spheroid f turnoff stars , we select a stellar population that is not a very good standard candle . but because we observe a large number of f turnoff stars we can find their underlying density distribution through statistical methods .",
    "we will assume the absolute magnitudes of the f turnoff stars in the population have a mean of @xmath19 and a dispersion of @xmath20 .",
    "these are reasonable estimates for the sgr dwarf tidal stream @xcite .      given a parameterized model and some data generated according to the model for some `` true '' values of the model parameters , the task of model estimation is to determine the set of parameters used in generating the data . within a bayesian",
    "setting , the model estimation problem can be reformulated as determining the _ a posteriori _ most likely parameters given the data and the model . in our case",
    "we have spatial positions for a set of stars in the spheroid , and a proposed model for the spheroid and a tidal stream which passes through it , and we would like to find the most likely values of the parameters in that model .",
    "the likelihood of a set of parameters is the probability of obtaining a particular data set for a given set of parameters . via bayes theorem",
    ", one can decompose the _ a posteriori _ probability of a particular set of parameters given the data and the model into the product of two terms , the first being the likelihood of the parameters and the second being the prior probability of the parameters .",
    "when the prior probability distribution over the parameters is uniform ( as is typically assumed ) , the _ a posteriori _ probability is proportional to the likelihood , and so the maximum likelihood technique may be used to find the most likely model parameters [ see @xcite for more details ] .",
    "there are two main tasks to implementing the maximum likelihood technique .",
    "the first is to develop the likelihood function , which measures the probability of observing a particular dataset given a parameterized model .",
    "the second is to maximize the likelihood with respect to the parameters .    in developing the likelihood function",
    ", one typically assumes that each data point is independently generated , hence the likelihood of the dataset is the product of the likelihoods of each individual data point . within our setting ,",
    "we develop a parameterized model for the background milky way and sagittarius stellar distributions from which we compute the likelihood .",
    "we prefer to maximize the logarithm of the likelihood , rather than the likelihood because the computation of the log - likelihood is numerically more stable .",
    "we then use the standard technique of optimization via conjugate gradients @xcite to maximize the likelihood and hence determine the most likely model parameters fitting the data .",
    "one advantage of the maximum likelihood framework is that the hessian of the log - likelihood ( at the maximum ) gives the shape of the probability distribution over the parameters , and hence allows us to determine the _ statistical _ error in the estimated model parameters .",
    "when the model parameters are physical quantities of interest , this statistical error translates to an error bar on the measured ( i.e. estimated ) physical quantity .    in the remainder of this paper we present a new automated technique that can detect tidal debris in a spatial input catalog of stars from one stripe of sdss data . since the first stripe in which the sgr dwarf tidal stream was detected in sdss data was stripe 82 @xcite , and it has therefore been the most well - studied",
    "; this is the section of data on which we test our maximum likelihood .",
    "building upon this , we describe a technique to extract a catalog of stars that fits the density profile of the debris ; this catalog can then be used to constrain the dynamical models .",
    "starting with a parameterized density model for the spheroid , a parameterized density model for the sgr dwarf tidal stream , the absolute magnitude distribution for f turnoff stars , and a dataset of observed @xmath21 angular coordinates and apparent magnitudes for color - selected f turnoff stars in a @xmath3 stripe through which a tidal stream passes , we find the parameters for a tidal stream and stellar spheroid concurrently that give us the highest likelihood of observing the data . this will allow us to tabulate summary statistics for the sgr dwarf tidal stream , including position , width , and density .",
    "it will also allow us to test models for the spheroid component of the milky way , and ultimately , it will allow us to construct a catalogue of stars that fit the density profile of the sgr tidal stream by probabilistically separating the stream from the spheroid .",
    "the parameters in our stellar density model describe the position , direction , and width of the tidal stream , as well as the shape of the smooth stellar spheroid .",
    "we start with an initial set of parameters and iterate using a conjugate gradient search technique until the optimum values for each parameter given the data set are determined . from the parameters which produce the maximum likelihood",
    ", we estimate the errors in each parameter .",
    "once we have found the best parameters , we are able to use a separation algorithm to divide the data into two sets of stars , one of which has the density profile of the stream and the other of which has the density profile of the spheroid . while we can not determine which of the individual stars in the data set belong to the stream and which belong to the spheroid , we can separate the input catalog into two catalogs that will have the density properties of the stream and the spheroid , respectively .",
    "these catalogs will allow for a close comparison of the stream density profile with that of simulations of tidal disruption and constrain the dynamical models used in simulations of tidal disruption .",
    " 2.2 gives a brief overview of the algorithm .",
    " 2.3 describes the construction of the probability density function . ",
    "2.4 discusses the optimizaiton method we use .",
    " 2.5 describes the method by which we estimate the errors in the parameters .",
    " 2.6 discusses the application of a separation algorithm to distinguish stream and spheroid stars .",
    " 2.7 describes the computational time required to run the algorithm and the application of parallel processing as a way to improve efficiency . ",
    "2.8 discusses some limitations and possible enhancements that could be made in the future . a thorough discussion of the conjugate gradient and line search optimization method can be found in the appendix .",
    "the algorithm starts with initial guesses for the model parameters and an input catalog of observed f turnoff star positions as @xmath22 , which represent the galactic longitude , in degrees ; galactic latitude , in degrees ; and reddening corrected @xmath23 magnitude for each star .",
    "the apparent magnitudes are corrected for reddening using the @xcite reddening maps , as implemented in sdss data release 6 ( dr6 ) .",
    "the essence of the maximum likelihood technique is to create a parameterized probability density function ( pdf ) , and then find parameters in this function which maximize the likelihood of observing the data .",
    "we first select a parameterized stellar density function for the spheroid and its substructure .",
    "since the parameterized models describe the density as a function of space @xmath24 , and the observations include only galactic coordinates @xmath21 and apparent magnitude , @xmath23 , we need to relate spatial position to @xmath22 .",
    "the angular position in the sky is very well known for each star , but it is difficult to determine the distance to each star . we can only estimate the distance from its apparent magnitude , @xmath23 . if all of the stars in the sample have the same absolute magnitude",
    ", then the conversion of apparent magnitude to distance is trivial .",
    "unfortunately , this is not a good approximation for f turnoff stars , whose luminosity can deviate from the mean by a factor of @xmath25 or more , even within the same age and metallicity population .",
    "instead , we approximate the distribution of absolute magnitudes of f turnoff stars as gaussian .    the likelihood of observing the data is the product of the likelihoods of observing each of the stars within the dataset , given the model : @xmath26 where the index @xmath27 runs over the @xmath28 stars , @xmath29 is a vector representing the parameters in the model , and the probability density function ( pdf ) is a normalized version of the stellar density function that will be derived in the next section . because the individual probabilities are small , we avoid numerical underflow by maximizing the average logarithm of the likelihood : @xmath30 which is maximized for the same parameters that the likelihood is maximized .",
    "we have chosen as input to this first version of the maximum likelihood algorithm a volume of the galaxy sampled in a section of stripe 82 .",
    "this volume is a piece of a wedge , @xmath3 wide , with point at the sun , limited in near and far end by the apparent magnitude range @xmath31 . for f turnoff stars with absolute magnitude @xmath32 ,",
    "the approximate distance range is @xmath33 kpc from the sun .",
    "the near and far edges of the volume are fuzzy due to the inexact relationship between apparent magnitude and distance , and the variable detection efficiency at the faint end .",
    "we chose this volume of a single stripe as the first application of the algorithm , for we do not have a global model for a general tidal stream ; however , if we choose to look at a small enough volume of the stream ( as is the intersection of the stream with stripe 82 ) , we are able to approximate its shape as a cylindrical density with cross - sectional gaussian fall - off from its axis .",
    "we model the entire tidal stream as a set of these cylindrical stream segments .",
    "this model will not work if the stream is in the plane of the wedge , but we show later that this cylindrical approximation works for this stream in this wedge .",
    "the algorithm begins by calculating the average log - likelihood for an initial set of parameters .",
    "a conjugate gradient with line search method is used to find the next set of parameters and the process iterates . using this method , each subsequent set of parameters",
    "is guaranteed to produce an equal or higher likelihood in each iteration of the algorithm .",
    "the algorithm continues to generate new sets of parameters until convergence , that is defined by one of a number of conditions : either the gradient becomes so small that it would not provide foreseeable improvement , the line search returns negligible movement , or a maximum number of iterations is reached .        in general",
    ", tidal streams follow a complex path through the sky .",
    "the stars in the structures may bunch up at apogalacticon and may have a complex cross - sectional density that varies with position along the stream .",
    "however , within a single sdss stripe through which the stream passes it is reasonable to approximate the path of the stream as linear ( see  3.3 ) .",
    "we model the stream in a piecewise linear fashion with a separate set of parameters for each stripe of data in the sdss , though in principle we could run this algorithm on any @xmath3-wide great circle , or set of @xmath3-wide great circles on the sky .",
    "the length of the cylinder is limited by the edges of the data in one stripe .",
    "the cross section is circularly symmetric with a density that falls off as a gaussian with distance from the stream axis .",
    "figure 1 depicts the data volume and the relationship between the stream parameters and the segment of a cylinder that describes the stream .",
    "the sdss great circle coordinate system @xmath34 is used to measure the angular position on the sky .",
    "@xmath35 is bounded by @xmath36 for all stripes , and measures the angular position across the narrow dimension of the stripe .",
    "@xmath35 is by definition zero along the center of each stripe of data .",
    "@xmath37 measures the angular distance along the great circle swept out by each stripe .",
    "the inclination of each stripe is the maximum angle between that stripe and the celestial equator .",
    "thus , @xmath38 and the stripe inclination uniquely specify the angular sky coordinates .",
    "the vector @xmath39 points from the galactic center to the axis of the cylinder .",
    "normally , a vector requires three parameters , one for each dimension .",
    "however , since we have the freedom to require that the position along the cylinder axis to which it points be in the plane that splits the volume in half along the narrow direction , we reduce that to two parameters . enforcing the condition that @xmath40 , we are thus able to parameterize the stream center with only a radial distance from the sun , @xmath41 ( in kpc ) , and the angular position along the stripe , @xmath37 ( in degrees )",
    ". therefore , @xmath42 fixes the center point of a piece of tidal debris within an sdss stripe and lies along the axis of our cylinder .",
    "the unit vector @xmath43 describes the orientation of the axis of the cylinder .",
    "again , we need only two parameters because this vector is constrained to be of unit length .",
    "we parameterize this vector using two angles @xmath44 and @xmath45 , both in radians .",
    "@xmath46 is the angle between @xmath43 and the galactic @xmath47-axis .",
    "@xmath47 is perpendicular to the galactic plane and points towards the north galactic cap .",
    "the azimuthal angle @xmath48 is measured counter - clockwise around the @xmath47 axis , as viewed looking down on the galaxy from the north galactic pole , starting from the @xmath49-axis , which points in the direction from the sun to the galactic center .",
    "the last stream parameter , @xmath50 ( in kpc ) , specifies the stream width and is the standard deviation of the gaussian distribution used to describe the density fall off with distance from the cylinder axis . for a star with spatial coordinates given by @xmath51 , the distance , @xmath52 , from the cylinder axis is given by @xmath53 in practice , this calculation is performed by first converting each vector to a galactocentric cartesian coordinate system .",
    "in summary , we use five parameters to define our cylindrical stream : @xmath54 , r , @xmath44 , @xmath45 , and @xmath50 .",
    "figure 1 depicts how these parameters are defined with respect to the stripe volume . using these parameters ,",
    "the stellar density of the stream at point @xmath51 is : @xmath55 normalization of the stellar density will be considered once we have assembled the entire probability density function .",
    "we model the stellar spheroid with a standard hernquist profile @xcite : @xmath56 and @xmath49 , @xmath57 , and @xmath47 are cartesian coordinates centered on the galactic center . @xmath49 and @xmath57 are in the galactic plane , with @xmath49 directed from the sun to the galactic center and @xmath57 in the direction of the solar motion .",
    "@xmath47 is perpendicular to the galactic plane and points in the direction of the north galactic cap .",
    "the spheroid is described by two parameters : @xmath58 which is a core radius , in kpc , and the dimensionless quantity , @xmath59 , which is scaling factor in the z coordinate direction . for @xmath60",
    "the spheroid is oblate , for @xmath61 the spheroid is spherically symmetric , and for @xmath62 the spheroid is prolate .",
    "there are many galactic components ( thick disk , bulge , etc ) other than the spheroid that we could in principle add to our full model .",
    "however , we do nt expect many disk stars in our sample because we are fitting data that is too far from the plane of the milky way , and the color - selected f turnoff stars are bluer than the turnoff of the thick disk stellar population .",
    "in this section we address the fact that stars within our selected color range , which are primarily f turnoff stars , do not all have the same absolute magnitude .",
    "if we assume that all of the color - selected stars have the same absolute magnitude ( equal to the mean absolute magnitude of the population ) when we estimate their distances from the sun , any substructure in the spheroid will appear to be elongated along our line of sight . to account for this ,",
    "we calculate an `` observed '' spheroid spatial density that is elongated along our line of sight by convolution of the density model with the absolute magnitude distribution function along our line of sight .",
    "we model the distribution of absolute magnitudes as a gaussian with a center of @xmath19 and dispersion @xmath63 , which is a simplification of the f turnoff star absolute magnitude distribution found for globular clusters by @xcite .",
    "thus , letting @xmath64 be the absolute magnitude , @xmath65 where @xmath19 and @xmath66 has a gaussian distribution with zero mean and standard deviation @xmath67 . to account for this distribution over the absolute magnitude",
    ", we first derive the probability of observing a star per unit apparent magnitude per unit solid angle , assuming all stars are of absolute magnitude @xmath19 , and then convolve in apparent magnitude with a gaussian of dispersion @xmath67 centered at zero .",
    "the result is the probability of observing a star per unit apparent magnitude per unit solid angle , with the absolute magnitude distribution taken into account .",
    "we will need to refer to several density functions in different spaces , and so we first lay down some definitions to make this discussion clear",
    ". we will refer to a density as @xmath68 where @xmath69 is the name of the density which will refer to the coordinate space in which it is defined and @xmath70 refers to a generic variable in this space .",
    "thus we define the 6 densities : @xmath71 where the first three densities are the model in cartesian , spherical , and apparent magnitude coordinate systems ; @xmath72 the densities which take into account the distribution on the absolute magnitude space are denoted by @xmath73 , where the subscript @xmath74 stands for convolved .",
    "all coordinate systems are centered at the sun , the solar position is assumed to be @xmath75 kpc from the galactic center , and the direction from the sun to the galactic center is in the positive @xmath49 direction .",
    "here we have made a distinction between @xmath41 and @xmath76 : @xmath41 denotes the actual distance each star is from the sun ; @xmath77 denotes the distance a star of apparent magnitude @xmath78 would be from the sun if it had an absolute magnitude of @xmath79 .",
    "we have also made the distinction between @xmath78 and @xmath80 : @xmath78 denotes the actual reddening corrected apparent magnitude of a star .",
    "@xmath80 denotes the apparent magnitude a star at distance @xmath41 would be calculated to have if it had an absolute magnitude of @xmath4 .",
    "we will adopt these definitions for the remainder of this paper .    the galactocentric cartesian density , @xmath81 , is the actual spatial density of stars as described in equations 4 and 5 for the stream and spheroid , respectively .",
    "we need @xmath82 , the observed galactocentric cartesian density that is elongated along our line of sight to account for gaussian distribution of absolute magnitudes with dispersion @xmath66 .",
    "we will obtain @xmath83 through the sequence of transformations @xmath84 the relationship between these densities is determined by the transformations which take one coordinate space to the other .",
    "the @xmath85 mapping is the well known spherical coordinate transform , @xmath86    if all of the stars had an absolute magnitude @xmath4 , then one would measure an apparent magnitude @xmath87 thus , the relationship between @xmath88 and @xmath89 is given by @xmath90    the measured @xmath78 is given by @xmath91 since @xmath78 is the sum of independent random variables , its density is the convolution of the two densities , i.e. , we have that @xmath92 , where the convolution is in the @xmath23-dimension .",
    "thus , @xmath93 where @xmath94 is the gaussian density function given by : @xmath95 with @xmath96 .",
    "switching back from apparent magnitude to spherical coordinates , @xmath97 since the coordinate spaces @xmath98 and @xmath76 are related by the spherical coordinate transformation , we may now collect our results and write the convolved density @xmath83 in terms of @xmath81 as follows : @xmath99 where @xmath100 are the angular coordinates of @xmath101    we have derived the convolved stellar density function @xmath83 , for a generic stellar density @xmath81 , which could represent either the stream or the spheroid densities in our present context .",
    "this convolution is performed separately on the stream and spheroid densities , to compute the functions @xmath102 and @xmath103 .",
    "we us the numerical integration technique of gaussian quadrature @xcite to do the convolution integral .",
    "we are now ready to compute the probability density function for the combination of the stream and spheroid densities .",
    "to do this we need the stellar densities of the stream and spheroid as derived in  2.3.3 , the detection efficiency for finding stars as a function of apparent magnitude , the volume over which the density is defined , and one more parameter , @xmath104 , which describes the fraction of stars in each of the two components ( spheroid and stream ) .",
    "the detection efficiency function , @xmath105 , was derived by fitting a sigmoid curve to the detection efficiency measurement in figure 2 of @xcite .",
    "the efficiency function accounts for the decrease in detection efficiency at faint magnitudes : @xmath106    the dimensionless parameter that defines the fraction of the input stars that are in the stream and the fraction that are in the spheroid is @xmath107 the parameter @xmath104 is modeled , as with the stream parameters themselves , separately for each stripe of data that is analyzed .",
    "thus , the value of @xmath104 for a given stripe of data gives only the relative number of stars that comprise the stream as compared to the spheroid for that stripe of data and does not measure the fraction of stars in the stream as a function of position within the galaxy .    by definition ,",
    "the fraction of stars in the stream is : @xmath108 = \\frac{e^{\\epsilon}}{1+e^{\\epsilon}}.\\ ] ] similarly for the spheroid @xmath109 = \\frac{1}{1+e^{\\epsilon}}.\\ ] ] we introduce here the concept of constrained and unconstrained variables . instead of @xmath104",
    ", we could have defined a variable @xmath110 which is the fraction in the stream , and then the fraction in the spheroid would be @xmath111 . however , we would then need to maximize the likelihood subject to the constraint that this parameter must be between zero and one .",
    "to avoid that constraint , we instead introduced @xmath112 which is not constrained . if @xmath104 is @xmath113 , then all of the stars are in the stream , if @xmath114 the stars are evenly split between the components , and if @xmath115 then all of the stars are in the spheroid component .",
    "the other parameters are naturally unconstrained and do not need a conversion .    in total ,",
    "then , we fit eight model parameters : five from the stream fragment in the current stripe @xmath116 , two from the spheroid @xmath117 , and one that specifies the fraction of stars in each component @xmath118 . together",
    ", we will refer to these parameters as the eight components of the parameter vector @xmath29 .",
    "the probability density function , then , is given by : @xmath119 where the integral is over the entire volume probed by the input data .",
    "calculation of the volume integrals dominates the runtime of the algorithm .",
    "since these integrals can not be solved analytically for our functions , we define an integration mesh which divides the total volume into many volume elements .",
    "the edges of the volume elements are along constant @xmath23 , @xmath37 , or @xmath35 .",
    "we then calculate the spheroid and stream probabilities at the center of each volume element and multiply this by the volume of that element .",
    "the values for the spheroid and stream probabilities in all volume elements are then summed and will be hereafter referred to as the stream and spheroid integrals , respectively .",
    "now that we have defined a probability distribution function and a likelihood measure , we need to find the parameters that maximize that likelihood . at the beginning of the first iteration of the program",
    ", the likelihood is calculated for the input parameters .",
    "thereafter , a new set of parameters and likelihood is calculated using a conjugate gradient search coupled with a line search technique . for a detailed description of the conjugate gradient and",
    "line search methods employed see the appendix  a.1 and  a.2 , respectively .",
    "the accuracy of the parameter estimates depends upon the the shape of the likelihood surface at its maximum , which is governed by the number of stars in our input catalog .",
    "the fewer stars , the wider the peak at the maximum and the larger the statistical error .",
    "it is also limited by the accuracy with which we are able to numerically determine the maximum .",
    "we will address this latter point when we discuss the test data in  3 . here , we explain how we calculate the accuracy with which we expect to be able to determine each parameter .",
    "we assume that the likelihood surface for the parameters can be reasonably estimated by a gaussian near the maximum .",
    "then , an estimate for the variance of each parameter can be found from the square matrix of second order partial derivatives of the log - likelihood function , evaluated at the maximum . this matrix is called a hessian matrix , @xmath120 .",
    "the variance matrix @xmath121 is the inverse of the hessian matrix , normalized by the number of stars in the data set : @xmath122 the square roots of the diagonal elements of the matrix provide us with the statistical error in the measurement of each parameter .",
    "we compute the hessian numerically using a finite difference method ( as we did the gradient ) as follows : @xmath123 here , @xmath124 is the @xmath125 component of parameter vector @xmath29 , similarly for @xmath126 ; and @xmath127 is the perturbation value for @xmath124 , similarly for @xmath128 . in practice",
    "we use the same @xmath129 to calculate the gradient as the hessian .",
    "these @xmath129 can be seen in table 1 .",
    "once we have found the values of the parameters in our model , we can use the model to separate the input catalog of stars into two catalogs , one having the density profile of the stream and the other having the density profile of the spheroid .",
    "it is possible to determine the probability that a star is in the stream or in the spheroid , however , it is not possible to determine which stars are in the stream and which are in the spheroid .",
    "for example , suppose a star selected from the data set is computed to be a stream star with probability 0.6 and that it is a spheroid star with probability 0.4 .",
    "we would put that star in the stream catalog with probability 0.6 and in the spheroid catalog with probability 0.4 , but there is a 48% chance that the star was put in the wrong file .",
    "the separation has proved very useful for evaluating the effectiveness of the model fits to the data , and hopefully will be useful for fitting tidal stripping models to the stream density profiles . however",
    ", it may not be the best method for selecting spectroscopic follow - up targets to measure the composition and velocities of stream stars , for example .",
    "spectroscopic follow - up targets might be better selected based on the probability that it is a stream star , rather than on the catalog to which it was randomly assigned .    to perform this separation , we calculate for each star the probability , @xmath130 , that it was drawn from the stream population given the parameters , where @xmath130 is defined by @xmath131 where @xmath132 is the stream portion of equation 21 , and @xmath133 is the spheroid portion of equation 21 .    a uniform random number between 0 and 1 is then generated and tested against this probability . if the probability of being drawn from the stream population",
    "is greater than that of the random number , then the star is placed into the stream star catalog ; otherwise , it is placed within the spheroid catalog .",
    "we repeat this process , generating a new random number for each star until all stars have been placed into their appropriate catalog .",
    "thus , we get two distinct populations : one that is a smooth spheroid and one that has all the density properties of the stream .",
    "we use this nondeterministic approach of testing the star probability against a random number for extracting the stream from the spheroid stars in order to get an accurate representation of the density profiles .",
    "since the stream probability definition is based solely upon the star s distance from the stream axis , assigning all stars with a probability greater than a set value to the stream would result in assignment of all stars within a certain distance to the stream .",
    "this would not be an accurate representation of the stream as we would be carving out a cylinder of stars from the data rather than a set of stars that fit a specific distribution with gaussian cross section in density .      in determining the likelihood",
    ", a trade - off needs to be made in the accuracy of the numerical integral calculation in equation 21 .",
    "the smaller the step size , @xmath134 , in each dimension the more accurate the integral calculation is , which can lead to faster convergence of the search method being used .",
    "however , increasing the precision of the integral calculation leads to polynomially longer calculation time ( scaling like @xmath135 ) .",
    "thus , the precision to which the integral is calculated is the dominant factor in the runtime and accuracy of our astronomical model .",
    "testing has shown that in order to generate a meaningful likelihood value in stripe 82 , a minimum of 1.4 million points within the stream and spheroid integrals is required . on a single processor , this takes approximately 15 minutes , assuming there is no magnitude distribution and the non - convolved probabilities are used . as performing a single conjugate gradient descent can take thousands ( or more ) integral calculations , these long execution times presented an obstacle to this research .    to generate a meaningful value for the magnitude convolution integral ,",
    "each integral point requires the calculation of at least 30 surrounding points .",
    "this increases the calculation time of a single integral to 7.5 hours .",
    "again , assuming a bare minimum of 1,000 likelihood evaluations for a single conjugate gradient descent ( typically the range is closer to 5,000 ) , evaluating one astronomical model would take almost a year on a single processor .    to alleviate these massive computational requirements , a generic maximum likelihood evaluator ( gmle )",
    "has been developed and used @xcite .",
    "gmle allows for a likelihood calculation to use various distributed computing environments , such as multiple processors in a cluster , a heterogeneous grid of clusters , or even a supercomputer .    using this distributed framework with 88 processors on",
    "the rensselaer grid resulted in a 65 times speedup over a single processor and using 512 nodes of an ibm bluegene / l system resulted in a 148 times speedup .",
    "it now takes only a few days to compute the maximum likelihood parameters for a particular model and stripe of data . in both the grid and supercomputing environments used ,",
    "overhead of communication was very small compared to the calculation time .",
    "communication time consists of approximately 1 - 10% of the time to calculate the likelihood and does not noticeably increase as more processors are used . with these observations , the calculation should scale to at least 1000 processors on a grid , and 10,000 processors on the ibm bluegene / l .",
    "more precise calculations of the integral and magnitude convolution will allow the distributed calculation to scale to even larger numbers of processors , due to the increased calculation time assuming relatively fixed communication times .",
    "gmle has also been extended to allow maximum likelihood evaluation over the berkeley open infrastructure for network computing ( boinc ) internet computing framework @xcite .",
    "this allows users to volunteer computing resources by downloading a boinc client and attaching to the milkyway@home project .",
    "currently , over 500 computers from around the world are being volunteered for the project and performance is comparable to 512 nodes of the ibm bluegene / l .",
    "generically , all enhancements to this algorithm either improve the galaxy model , increase the quantity of data to which the model is fit , or improve the accuracy of speed and accuracy of the convergence .",
    "we plan to improve the algorithm in all of these aspects .",
    "we plan to build up a model of the milky way stellar density , starting with the spheroid component . over time",
    ", we will be able to include additional streams and additional pieces of the sagittarius dwarf tidal stream , a more sophisticated model of the smooth component of the spheroid , and disk components .",
    "the spheroid substructure is best fit in a piecewise manner as we have done in this paper , but the smooth components require that more directions be fit simultaneously .",
    "to be able to fit multiple stripes during a single optimization it must be possible fit multiple debris pieces during a single run as well . to add additional tidal debris , we need only to add a term for each additional stream to the pdf : @xmath136 \\nonumber\\\\ & & + \\frac{1}{(1 + \\sum_{i=1}^k\\epsilon_i ) }   \\frac{\\rho^{con}_{spheroid}(l , b,\\mathcal{r}(g_0 ) | \\vec{q}_{spheroid})}{\\int{\\rho^{con}_{spheroid}(l , b,\\mathcal{r}(g_0 ) | \\vec{q}_{spheroid})}dv},\\end{aligned}\\ ] ] where i and j denote the @xmath137 and @xmath125 stream of @xmath138 total streams , respectively .",
    "we add five new parameters , @xmath139 , and a sixth parameter , @xmath140 , for each new stream segment .",
    "this change to the pdf would allow @xmath138 pieces of tidal debris to be fit within a single or multiple stripes .",
    "we are considering whether we should enforce continuity conditions between adjacent sections of the tidal stream . since it has been suggested that the smooth portion of the spheroid may not be symmetric , we would like also to increase the number of parameters in the smooth spheroid component , following @xcite .",
    "we are currently fitting only f turnoff stars , and assuming that the absolute magnitude distribution of these stars is a standard gaussian for all populations .",
    "ideally , we would use stars in a wider color range , and develop a probability distribution in magnitude and color for each population of stars .",
    "this would increase the number of stars available to the algorithm and would allow us to use additional information about real structures in the milky way - insisting that each population with a turnoff also has a main sequence and giant branch , for example . implementing this requires significant development not only in the computation of the likelihood , but also in characterizing galactic stellar distributions .",
    "small steps in improving this aspect of the algorithm are currently underway .",
    "all of the preceding improvements to the algorithm increase the number of fit parameters and the complexity of calculating the likelihood function . in parallel with scientific development of the algorithm",
    ", we will be improving the speed of convergence .",
    "we are experimenting with other methods of finding the maximum , and increasing the number of architectures on which our software can be run in parallel .",
    "future architectures that we will use include supercomputers and boinc , which among other products supports the seti@home application .",
    "to test our algorithm we generated a simulated version of sdss stripe 82 .",
    "the  true value \" column of table 2 shows the parameter values used for the data generation while figure 2 shows a plot of the simulated data .",
    "the data set contained a total of 205,708 simulated stars ; 28,498 ( 13.85%)of which are stream stars . the stream model parameters and",
    "star ratio were chosen to be the same as the real data for stripe 82 .",
    "the techniques of generation are described below .",
    "we create the simulated stream using an active generation technique , which means that all points that are generated are valid stream stars .",
    "first , we define a set of stream parameters to generate over . from these parameters",
    "we then calculate the @xmath39 and @xmath43 vectors defining our stream position and direction .",
    "we then generate three random numbers : a uniform random number that determines where along the stream axis the point is , and two gaussian random numbers ( with standard deviation @xmath141 as defined in the parameters ) to define the stream cross - sectional coordinates .",
    "the point is then converted to galactic longitude , latitude and apparent magnitude .",
    "thus far , we have assumed a constant absolute magnitude for each star in the stream . to account for the fact that there is an absolute magnitude distribution , we add or subtract a small amount from the apparent magnitudes of each of the stream stars in the dataset .",
    "a gaussian random variable with standard deviation 0.6 is generated ( one for each point ) ; this value is added to the apparent magnitude of the generated point . finally , we keep points with a probability given by the efficiency function to produce a data set for a simulated stream .",
    "stars near the magnitude limit of the data are tossed out of the sample with a probability equal to the efficiency of our object detection as a function of apparent magnitude in the real data .",
    "the simulated spheroid is generated using a rejection sampling technique .",
    "here we can not apply the same active generation technique we used for the stream because the density distribution in the smooth component of the spheroid is more complex than a gaussian .",
    "instead , we define a rejection technique that allows us to generate over a given stripe .",
    "we can not simply generate values for @xmath37 , @xmath35 , and @xmath41 , however , because the stars are not uniformly distributed in these variables .",
    "the distribution in @xmath35 varies according to the @xmath142 , and the distribution in @xmath41 must take into account the growing volume at increasing distance .",
    "@xmath37 may be generated uniformly over the stripe as it corresponds to a longitude , and the volume of space in each longitude bin is the same .",
    "the volume element in a stripe is given by : @xmath143 and the corresponding stripe volume is : @xmath144 where @xmath145 is the maximum radial distance , and the positive and negative superscripts refer to the maximum and minimum values of that coordinate for the stripe .",
    "these equations are used to define the functions which allow us to generate in the other two coordinates : @xmath146 where @xmath147 and @xmath148 are uniform random numbers between zero and one .",
    "@xmath37 is generated by a uniform random number between the stripe limits .",
    "once a point is generated , its probability is calculated using the likelihood function developed in  2.3 .",
    "the probability is then divided by the total probability possible for a star . the total probability possible for a star is simply the maximum value that can be returned by the likelihood function given the current volume and parameter set .",
    "the value of this ratio is then tested against a uniform random number between zero and one ; the point is put into the data set if the value is greater than the value of the random number .      using the method described in  2.5 we calculated the expected accuracy for each parameter . since we created the simulated data with a known set of parameters , we therefore know the true parameter values of the dataset .",
    "we can calculate the hessian matrix at the optimum values and subsequently get a set of error bars at the optimum values .",
    "these error bars therefore give us the accuracy with which we expect to find the values of the parameters .",
    "the values of these errors can be found in the column  expected deviation \" ( the statistical error bar ) in table 2 for the 205,708 star simulated data set .",
    "in addition to the statistical errors , there can be numerical errors driven primarily by the accuracy with which we determine the integrals .",
    "these numerical errors were estimated by determining the accuracy the likelihood can be calculated for a fixed number of points in the numerical integration and then calculating the ` error ' in each parameter by perturbing a single parameter , holding all others fixed , until a change in the total likelihood is observed that is greater than the minimum accuracy threshold of the numerical integration .",
    "it should be noted that the values quoted as  numerical error \" are heuristic errors , meaning they are estimated and not a true error bar .",
    "we tested our algorithm by letting it optimize to convergence for eight randomized sets of input parameters .",
    "randomized here means a random perturbation of the actual values by 75 percent of the parameter s value .",
    "although parameters outside of this range are in principle allowed , the likelihood surface for parameter values very far from the correct values is so flat , and the gradient so small , that numerical errors dominate our measurement of the gradient . in these eight optimizations : five optimized to the true values , two optimized to a local maxima which has a lower likelihood than that of the true values , and one did not converge because it was far enough from the correct parameter values that the gradient could not be accurately determined .",
    "the local maxima appears to be related to the fact that the stream crosses the stripe at low inclination , the algorithm sometimes fits the data with a much higher inclination angle and larger width to compensate .",
    "all other parameters are still optimized to their true values at this local maxima .",
    "the average values of the returned parameters from the five optimizations to the true values are presented in the ",
    "optimized value \" column of table 2 , and the  actual deviation \" is the deference between the  true value \" and the  optimized value . \"",
    "the returned parameters have very little deviation .",
    "the standard deviation of the five optimizations were calculated to be around an order of magnitude lower than the statistical error calculated from the hessian .",
    "these can be be seen in the  std . deviations of optimizations \" column of table 2 . note that if the theoretical deviation is large for a particular parameter then near the maximum , the likelihood changes little with the variation of that parameter .",
    "this leads to a larger  actual deviation , \" and can also make it more difficult for the algorithm to numerically find the maximum since the gradient will be very small .",
    "the errors calculated from the hessian assume that the maximum of the pdf is found exactly .",
    "as can be seen in table 2 , all of the parameters have  actual deviations \" which are smaller than their  theoretical deviations \" with the exception of @xmath58 .",
    "it has been discovered that the likelihood changes so little compared to perturbations in these parameters when close to the maximum that this parameter is not being calculated accurately enough to reach the  true value \" seen in table 2 .",
    "the true error bar should be taken as the sum , in quadrature , of the  expected deviation \" and  numerical error \" columns .",
    "once this is done the  optimized value \" of all parameters are comparable , within the errors , to the  true value . \"    finally , we ran our separation algorithm upon the average returned parameter values to create two catalogs of stars given those parameters , and we plotted these separately in figure 3 .",
    "clearly visible is the stream with a gaussian density fall off in the left plot , while the right plot depicts a smooth hernquist profile .",
    "we also tested our algorithm on this same simulated dataset of 205,708 stars without using an absolute magnitude correction , thereby simply assuming that all f turnoff stars have an absolute magnitude , @xmath4 .",
    "this was done to see how important this correction was and to see whether the algorithm could be effectively used without it .",
    "the results showed that the parameters of @xmath37 and @xmath58 were the only values not affected by this correction ; the rest of the parameters deviated wildly from their actual values with the stream parameters @xmath41 , @xmath46 , and @xmath48 being the worst of the eight parameters reaching upwards of 34@xmath141 in error .",
    "the previous section showed that the algorithm produces the correct answer given that the data is drawn from our model . in this section ,",
    "we test the algorithm on data that was not generated according to the assumed spatial model .",
    "we constructed a reproduction of the sgr dwarf galaxy tidal disruption produced by @xcite using a semi - analytic n - body approach . using their parameters for the galactic potential and kinematic values",
    ", we constructed an orbit for sagittarius using the nemo stellar dynamics toolbox @xcite .",
    "specifically , we used the case of a spherical dark matter halo , with a velocity dispersion of 114 km / s .",
    "we used a plummer sphere with one million particles as our model for sagittarius , the sphere was evolved along the orbit for 3.18 gyr until it reached the present position of the sgr dwarf spheroidal .",
    "the resulting plot of the disruption of sagittarius is shown in figure 4 .",
    "it is consistent with the results obtained by @xcite .",
    "we then selected the volume corresponding to sdss stripe 82 from the n - body simulation and fit it using our model hernquist profile spheroid and maximum likelihood technique .",
    "using the output model parameters found by our algorithm , we created a new simulated stream as described in  3.1.1 .",
    "finally , we compared the cross - sections of this simulated stream with that of a similar stream generated with our density model .",
    "a cross - section of these two streams @xmath149 kpc thick and centered at the returned stream center are plotted , along with a histogram of the stars within the cross - section , in figure 5 .",
    "figure 5 ( left panel ) depicts the n - body simulation stream while figure 5 ( right panel ) is that of our simulated stream .",
    "it can be seen that the n - body simulation is indeed not gaussian .",
    "the drawback to testing with an n - body model is that there are no correct model parameters with which to compare ; but the center , as shown in figure 5 ( left ) , and the direction , as shown in figure 4 , are reasonable . in order to assess the error in the determination of the stream center",
    ", one would have to define what is meant by the center of an asymmetric distribution , but the algorithm s choice seems reasonable .",
    "next , we estimate the curvature of the sgr tidal stream in stripe 82 . taking the distance to the center of the stream in stripe 82",
    "to be @xmath150 kpc @xcite we calculate that the @xmath151-wide sdss stripes would be @xmath152 kpc thick at this distance .",
    "the length of the stream in stripe 82 , taking an inclination of @xmath153 from the stripe @xcite , is then @xmath154 kpc .",
    "we estimate the radius of curvature of the sgr tidal tail in the orbital plane at this point to be @xmath155 kpc by fitting a circle to the two southern stripes with detections in @xcite . the deviation from linear",
    "can then be found to be @xmath156 kpc at the edge and is very small when compared to the @xmath157 kpc @xcite width of the stream or the 6.74 kpc width found in this paper .",
    "the linear approximation is quite reasonable for the sgr stream in stripe 82 .    finally , we tested our algorithm with differing spheroid models . because it was easier to change the spheroid model",
    "we fit than to regenerate many sets of spheroid stars , we modified the exponential component of the model hernquist profile the algorithm fits to the data .",
    "three tests were performed with the exponent of the hernquist profile set to 3.5 , 2.5 and 2.0 as compared to the value of 3.0 used to generate the data .",
    "the results from these tests can be found in table 3 . in all cases , the stream parameters and",
    "the epsilon parameter saw little to no change ( all optimizations were within the errors calculated above ) .",
    "as expected , the spheroid parameter values were incorrect , but represent the best parameters for the model profile fit to the simulated data within our generated volume .",
    "after validating the algorithm on the simulated data , we then applied the algorithm to the stripe 82 data as described in  2.2 .",
    "figure 6 shows a plot of this data where a piece of the sgr tidal stream is clearly visible as a dense structure on left of the image at @xmath158 .",
    "we selected from the sdss skyserver data release 6 all of the sources in stripe 82 that had magnitudes @xmath31 , colors of @xmath159 and @xmath160 , were identified as point sources , and were not edge or saturated . since the selected stars are far from the galactic plane , the reddening can reasonably be estimated from the total amount of dust in that direction in the sky .",
    "the subscript  0 \" indicates that we selected reddening corrected magnitudes from the sdss databases .",
    "the cut in ( u - g ) is made to remove low - redshift qsos .",
    "we limited the angular length along stripe 82 to 109@xmath7 , with right ascension in the range @xmath161 , @xmath162 . since stripe 82",
    "is centered on the celestial equator , the edges of the stripe are @xmath163 in declination and the angle along the stripe is given exactly by right ascension . a small section of data with right ascension @xmath164 and declination @xmath165 was removed in order to avoid a globular cluster .",
    "the final dataset includes 115,907 stars .",
    "as was done for the test data , a number of randomized sets of initial parameters were used ( having the same 75% perturbation ) and the average of the parameters of those optimizations that converged to a minima was taken . in this case ten",
    "total optimizations were performed , five optimized to a minima , four to a local minima with lower likelihood than the true minima , and one was again a poor starting point allowing for no optimization .",
    "the hessian method was then used to calculate the error bars for these parameters at the true minima .",
    "the errors , as well as the average parameter values , are tabulated in table 4 .",
    "there are additional , unknown systematic errors for real data that were not present for the model data .",
    "the quoted errors assume that the model is an accurate representation of the stellar density function , including our formula for the smooth spheroid , tidal stream , and absolute magnitude distribution .",
    "the average parameter values were used as input for our separation algorithm to create stream and spheroid catalogs for stripe 82 .",
    "these catalogs were then plotted in figure 7 .",
    "as can be seen , the sgr tidal stream has been clearly extracted from the spheroid in the left panel while the spheroid remains in the right panel .",
    "we compared the average stream center and direction with figure 4 from @xcite in figure 8 of this paper .",
    "as can be seen in the figure , the stream direction is roughly tangent to the stream of 2mass m giants ( though at a different distance @xmath166 there is a difference in scale between distances measured with the m giants and distances measured with f turnoff stars and rr lyraes ) .",
    "notice also that the stream direction does not lie exactly in the plane of the sgr dwarf , but is tilted slightly with respect to the @xmath167 plane ( @xmath168 ) .",
    "we also compare our direction to the directional results of @xcite , who estimated the angle between the observational plane and the sagittarius dwarf stream to be @xmath153 and the angle between the normal to the line of sight towards a point and the tangent of the stream at that point to be @xmath169 .",
    "we calculated the former angle from our parameters by taking the angle between the observational plane of stripe 82 and the directional vector .",
    "doing this we get a value of @xmath170 .",
    "our value agrees perfectly .",
    "the second angle was calculated by first finding the line of sight vector to the center of the stream , calculating a normal to that , and then finding the angle between the stream direction and that normal .",
    "we found a value of @xmath171 .",
    "this difference is explained by the drastically improved accuracy of the maximum likelihood algorithm over the estimate by eye for this more difficult angle . a tabulation of the stream center position and the stream direction in various coordinate systems can be found in table 5 .",
    "note that the @xmath172 @xmath173 and @xmath172 @xmath174 correspond to the vectors @xmath39 and @xmath43 , respectively , that are used in  2.3.1 .",
    "our results are in reasonable agreement with those of @xcite , but with much tighter error bars .",
    "the center of the stream is shifted from @xmath175 to @xmath176 .",
    "this shift is slightly larger than expected , but not overly so .",
    "note also that the @xcite estimate of the center in f turnoff stars is @xmath177 , which is closer to our value .",
    "our detection of radial distance , however , corresponds exactly to that seen in the @xcite .",
    "our stream width of @xmath178 is equivalent to a fwhm of 6.7 kpc , which is in good agreement with the value of 6 kpc estimated in @xcite .",
    "the stream ratio @xmath104 provides a very good separation as shown in figure 7 and corresponds to a detection of approximately 16,000 stream stars out of the total 115,907 f turnoff stars in the stripe . by performing a calculation parallelling equation 10 of @xcite",
    "we are able to get an estimate of the total stellar mass in stripe 82 as a fraction of the sgr dwarf itself .",
    "we first calculate the number of stars in figure 6 of @xcite with @xmath179 and @xmath180 .",
    "this was calculated to be 2,194 stars .",
    "we then use this in place of the value calculated for f / g type stars in equation 10 of @xcite to get the total number of f turnoff stars currently in the sgr dwarf itself .",
    "this results in a total of 1,798,700 f turnoff stars in the sgr dwarf .",
    "dividing this by the 16,050 stars found to be in the stream in stripe 82 yields that stripe 82 contains 0.9% of the sgr dwarf s current f turnoff stars .",
    "our spheroid parameters of @xmath181 and @xmath182 are slightly unexpected given the previous work in @xcite , which finds that the flattening parameter for the stellar halo closer to @xmath183 .",
    "however , this does not discount that the best likelihood for the stellar halo is obtained from these results , only that they were not the expected .",
    "further results from other data sets and other stripes will be needed to determine the consistency of these results amongst other stripes and confirm such a strong flattening of the stellar halo .",
    "we have measured the position , direction , distribution , width and number or f turnoff stars of the sgr tidal debris in sdss stripe 82 as well as the stellar spheroid parameters corresponding to flattening and core radius .",
    "our work has resulted in the improved measurement of the sgr stream width ( fwhm = @xmath2 kpc ) , position [ ( @xmath184 , @xmath185 , @xmath41 ) = @xmath186 , @xmath187 , @xmath188 kpc ] , and direction [ @xmath189 kpc , @xmath190 kpc , @xmath191 kpc ] .",
    "we measured the number of f turnoff stars in the stream in sdss stripe 82 ( @xmath192% of 115,907 ) .",
    "there are @xmath193 sgr f turnoff stars in stripe 82 compared to @xmath194 turnoff stars in the sgr dwarf itself ( @xmath195 ) .",
    "we also calculated values for the stellar spheroid parameters : the flattening parameter ( @xmath196 ) and the core radius ( @xmath197 ) . while these spheroid parameters are not the expected values , they are intriguing and deserve further study .",
    "finally , we were able to generate separate catalogs of stream stars and spheroid stars for the f turnoff stars in stripe 82 .",
    "these catalogs , while not a true representation of the actual stars in the stream or spheroid , provide the correct density characteristics of these structures and can be compared with the density profiles of n - body simulations .",
    "the results were calculated using a new method to study tidal debris that is more robust than previous methods .",
    "this method will prove valuable to the study of tidal disruption and galactic structure as it provides a means to accurately and efficiently study many variables used to model the spheroid and tidal debris . also , we are able to extract a catalog of stream stars which can be used to better constrain models of the sgr dwarf disruption by providing actual stream stellar positions to compare with the data .",
    "the algorithm itself is quite flexible .",
    "the stream and spheroid models can be easily changed should more accurate ones be discovered .",
    "the new model definitions would simply replace the existing probability code with no other changes .",
    "also , with minor changes to the volume definitions it would be possible to use data from surveys other than the sdss as an input catalog . with some revisions , the code could be adapted to search for multiple debris and use multiple volumes to provide more accurate results .",
    "this publication is based upon work supported by the national science foundation under grant no .",
    "additional support was provided by the nsf grants ast 0607618 and cns 0323324 , nasa new york space grant , and john a. huberty .",
    "we thank brian yanny for his help in the extraction of data and overall troubleshooting he did to aid us in this work .",
    "we use data from the sloan digital sky survey .",
    "funding for the sdss and sdss - ii has been provided by the alfred p. sloan foundation , the participating institutions , the national science foundation , the u.s .",
    "department of energy , the national aeronautics and space administration , the japanese monbukagakusho , the max planck society , and the higher education funding council for england .",
    "the sdss web site is http://www.sdss.org/.    the sdss is managed by the astrophysical research consortium for the participating institutions .",
    "the participating institutions are the american museum of natural history , astrophysical institute potsdam , university of basel , university of cambridge , case western reserve university , university of chicago , drexel university , fermilab , the institute for advanced study , the japan participation group , johns hopkins university , the joint institute for nuclear astrophysics , the kavli institute for particle astrophysics and cosmology , the korean scientist group , the chinese academy of sciences ( lamost ) , los alamos national laboratory , the max - planck - institute for astronomy ( mpia ) , the max - planck - institute for astrophysics ( mpa ) , new mexico state university , ohio state university , university of pittsburgh , university of portsmouth , princeton university , the united states naval observatory , and the university of washington .",
    "the conjugate gradient method is similar to the gradient method in that we perturb the current parameter value , @xmath126 , by a small amount , @xmath128 , and get a direction for the change in the parameter space .",
    "however , unlike the gradient method , the conjugate gradient method enforces the condition that each direction is conjugate to the previous direction .",
    "this means that as we move along the new search direction , the component of the gradient parallel to the previous search direction must remain zero .",
    "this condition speeds up the optimization by using search directions that are non - interfering .",
    "a further discussion may be found in @xcite .",
    "the @xmath137 component of the gradient vector , @xmath198 , is calculated numerically by perturbing @xmath126 , holding all other @xmath124 fixed : @xmath199 where @xmath200 is the @xmath137 component of the gradient vector , @xmath126 is the @xmath137 parameter , @xmath128 is the perturbation amount for that parameter , and @xmath201 is the likelihood function from  2.2 .    this gradient is used to calculate the direction , @xmath202 , for the first iteration : @xmath203 we take the positive value of the gradient , for we want to maximize the likelihood .",
    "should we want to perform a simple gradient ascent we would do this same calculation for every iteration and use solely the direction calculated above ; however , we wish to apply the conjugate gradient technique which always calculates a direction conjugate to the previous directions .",
    "this is done by calculating a multiplier , @xmath204 , based upon the current gradient and the previous gradient , as ; @xmath205 where @xmath206 denotes the gradient vector for the @xmath137 iteration .",
    "this value is then used to calculate the new conjugate gradient direction : @xmath207 where @xmath208 denotes the direction vector of the @xmath137 iteration ( the direction to move the current parameters ) and @xmath209 is the gradient of the current parameters , @xmath126 , at the the @xmath137 iteration .    due to the large variety of parameters that we utilize , all on different scales ,",
    "we do not use one value for our perturbation value , @xmath210 , for it could potentially produce poor estimates for the gradient if the perturbation is too large or small for a given parameter .",
    "if @xmath210 is too large , then the computed gradient is not an accurate approximation of the true gradient at the current point ; if @xmath210 is too small then we may encounter computational errors .",
    "we therefore choose an appropriate value for each parameter independently .",
    "table 1 shows the perturbation values for each parameter .",
    "these numbers were chosen in two ways .",
    "the values of the gradient were calculated at a number of differing perturbation values in order to determine how much the gradient changed . also , plots of all parameter spaces were generated in order to determine the distribution of each parameter .",
    "combining these two techniques we were able to determine a value for the perturbation for each parameter that would be small enough to provide a very accurate gradient calculation , but also large enough to overcome any anomalous behavior within the parameter s distribution .",
    "the line search technique seeks to determine the value , @xmath184 , that minimizes the function @xmath211 where @xmath212 is the direction and @xmath213 is the current set of parameters . after finding @xmath214 which minimizes @xmath215",
    ", we then update @xmath216    a bracketing method must be employed first to ensure that the minimum of the function is within the range we are searching .",
    "this is done by calculating the likelihood at three points along the current search direction : the current parameter values plus zero , one , and two times @xmath212 .",
    "this corresponds to the current position , the current position plus the full direction , and the current position plus twice the full direction .",
    "if the middle point does not have a likelihood greater than the two endpoints , the endpoint with the highest probability becomes the new center point , the center point the end , and a new third point is calculated by expanding to two times the current factor times direction and the new likelihood is calculated .",
    "iteration continues until the midpoint has a greater likelihood than both endpoints .",
    "these three points are then passed to the line search algorithm which will use them to find the peak of the parabolic function defined by moving along the current directional vector and calculating the likelihood at points along this path .",
    "the line search iterates as follows : first a guess is made for the value of @xmath184 by fitting a parabola via the calculation : @xmath217 where @xmath218 , @xmath219 , and @xmath220 are the factors multiplied by the current direction that produce the parameters with likelihood @xmath221 , @xmath222 , and @xmath223 , respectively . for the first iteration ,",
    "@xmath218 , @xmath219 , and @xmath220 are the values returned from the bracketing method .",
    "@xmath184 is then the current guess for the value to minimize equation a5 .",
    "the likelihood @xmath224 is then calculated using the parameters generated using @xmath184 . the new order of the three points is : @xmath225 in short , the distance along the search direction is reduced based upon the value of @xmath184 and its corresponding likelihood .",
    "these new points are then used to calculate a new guess for @xmath184 using equations a6 through a8 .",
    "iteration continues for a set number of iterations until returning the optimum value of @xmath184 ; we currently use three .",
    "once we have calculated the change in the parameters , utilizing the conjugate gradient and line search methods , we then update the value of the probability for the fit using the same method as discussed in  2.3 and continue to maximize our probability through the use of the conjugate gradient and line search methods .",
    "the algorithm stops iterating and returns the current values when the value of the largest component of the conjugate gradient drop below a set threshold , the line search returns a value that would cause negligible movement , or the algorithm has completed a maximum number of iterations .",
    "abazajian et al . , astron.j . 126 ( 2003 ) 2081 .",
    "adelman - mccarthy , j. k. , et al .",
    "2007 , , submitted , arxiv:0707.3413 anderson , david p. , korpela , eric , walton , rom .",
    "2005 ,  high - performance task distribution for volunteer computing \" , e - science , 196 - 203 bahcall , j. 1986 , , 24 , 577 bell , eric f. , zucker , daniel b. , belokurov , vasily , et al .",
    ", 2007 , , submitted , arxiv:0706.0004 bellazzini , m. , ibata , r. , ferraro , f. r. , testa , v. , 2003 , a&a , 405 , 577 belokurov , v. et al . 2006a , , 647 , l111 belokurov , v. , zucker , d. b. , evans , n.w . , et al .",
    "2006b , , 642 , l137 belokurov , v. , evans , n.w . , irwin , m. j. , hewett , p. c. , & wilkinson , m. i. 2006c , , 637 , l29 belokurov , v. et al .",
    "2007a , , 654 , 897 belokurov , v. et al . 2007b , , 657 , l89 chou , mei - yin , majewski , s. r. , et al .",
    "2007 , , 670 , 346 desell , t. , cole , n. , magdon - ismail , m. , newberg , h. , szymanski , b. , varela , c. to appear december 10 - 13 , 2007 ,  distributed and generic maximum likelihood evaluation \" , 3rd ieee international conference on e - science and grid computing ( escience2007 ) , bangalore , india duffau , s. , zinn , r. , vivas , a. k. , et al .",
    "2006 , , 636 , l97 fellhauer , m. , belokurov , v. , evans , w. et al .",
    "2006 , , 651 , 167 fletcher , r. 1987 , practical methods of optimization , 2nd edition ( new york : wiley - interscience ) freeman , k. c. 1987 , , 25 , 603 freeman , k. , and bland - hawthorn , j. 2002 , , 40 , 487 freese , k. , gondolo , p. , newberg , h. j. 2005 , physical review d , 71 , 4 fukugita , m. , ichikawa , t . , gunn , j. e. , doi , m. , shimasaku , k. , schneider , d. p. 1996",
    ", , 111 , 1758 gilmore , wyse , kuijken 1989 , , 27 , 555 gmez - flechoso , m. a. , fux , r. , martinet , l. , 1999 , a&a , 347 , 77 grillmair , c. j. 2006 , , 645 , l37 grillmair , c. j. & dionatos , o. 2006 , , 643 , l17 grillmair , c. j. & dionatos , o. 2006 , , 641 , l37 grillmair , c. j. & johnson , r. 2006 , , 639 , l17 gunn , j. e. et al .",
    "1998 , , 116 , 3040 heath , michael , t. 2002 , scientific computing , 2nd edition ( new york , mcgraw - hill ) helmi , a. , white , s. d. m. , 2001 , , 323 , 529 helmi , a. , 2004 , , 610 , l97 hernquist , l. 1990 , , 356 , 359 hogg , d. w. , finkbeiner , d. p. , schlegel , d. j. , and gunn , j. e. 2001 , , 1222 , 2129 ibata , r. a. , gilmore , g. , and irwin , m. j. 1994 , , 370 , 194 ibata , rodrigo a. , wyse , rosemary f. g. , et al . , 1997 , , 113 , 634 ibata , rodrigo a. , lewis , geraint f. , 1998 , , 500 , 575 ibata , r. , irwin , m. , lewis , g. f. , and stolte , a. 2001 , , 547 , l133 ibata , r. , lewis , g. f. , et al .",
    "2001 , , 551 , 294 irwin , m. j. et al .",
    "2007 , , 656 , l13 johnston , k. v. , spergel , d. n. , hernquist , l. , 1995 , , 451 , 598 johnston , k. v. , spergel , d. n. , hadyn , c. , 2002 , , 570 , 656 johnston , k. v. , law , d. r. , majewski , s. r. 2005 , , 619 , 800 law , david r. , johnston , kathryn v. , and majewkski , steven r. 2005 , , 619 , 807 law , david r. , et al .",
    "2004 , , 327 majewski , s. r. , skrutskie , m. f. , weinberg , m. d. , and ostheimer , j. c. 2003 , , 599 , 1082 majewski , s. r. , kunkel , w. e. , law , d. r. , patterson , r. j. , et al .",
    "2004 , , 128 , 245 martnez - delgado , d. , gmez - flechoso , m. a. , aparicio , a. , and carrera , r. 2004 , , 601 , 242 martnez - delgado , d. , penarrubia , j. , et al .",
    "2007 , , submitted , astro - ph/0609104 pearrubia , j. , martnez - delagdo , d. , rix , h. w. , gmez - flechoso , m. a. , munn , j. , newberg , h. , bell , e. f. , yanny , b. , zucker , d. , & grebel , e. k. 2005 , , 626 , 128 newberg , h. , yanny , b. , et al .",
    "2002 , , 569 , 245 newberg , h. , yanny , b. , et al .",
    "2003 , , 596 , l191 newberg , h. j. & yanny , b. 2005 , a. s. p. conf .",
    "ser . , 338 , 210 newberg , h. & yanny , b. 2006 , journal of physics : conference series 47 , 195 newberg , h. , yanny , b. , et al .",
    "2007 , , arxiv:0706.3391v1 odenkirchen , m. et al .",
    "2001 , , 548 , l165 pier , j. r. , munn , j. a. , hindsley , r. b. , hennessy , g. s. , kent , s. m. , lupton , r. h. , and ivezi , z. 2003 , , 125 , 1559 robin , a. c. , reyl , c. , derrire , s. , picaud , s. , 2003 , a&a , 409 , 523 rocha - pinto , h. j. , majewski , s. r. , skrutskie , m. f. , crane , j. d. , and patterson , r. j. 2004 , , 615 , 723 rockosi , c. m. , et al .",
    "2002 , , 124 , 349 savage , c. , newberg , h. j. , freese , k. & gondolo , p. 2006",
    ", journal of cosmology and astroparticle physics , 7 , 3 schlegel , d.j . ,",
    "finkbeiner , d.p . , &",
    "davis , m. 1998 , , 500 , 525 smith , j. a. et al .",
    "2002 , , 123 , 2121 stoughton , c. , et al .",
    "2001 , , 123 , 485 teuben , p.j .",
    "the stellar dynamics toolbox nemo , in : astronomical data analysis software and systems iv , ed .",
    "r. shaw , h.e .",
    "payne and j.j.e .",
    "( 1995 ) , pasp conf series 77 , p398 .",
    "vivas , a.  k.  et al .",
    "2001 , , 554 , l33 willman , b. et al .",
    "2005 , , 626 , l85 xu , y. , deng , l. c. , & hu , j. y. 2006 , , 368 , 1811 yanny , b. , newberg , h. j. , et al . 2003 , , 588 , 841 yanny , b. , newberg , h. j. , et al .",
    "2000 , , 540 , 825 york , d. g. , et al .",
    "2000 , , 120 , 1579 zucker , d. b. et al . 2006a , , 643 , l103 zucker , d. b. et al . 2006b , , 650 , l41",
    "@xmath37 ( deg ) & @xmath226 + @xmath41 ( kpc ) & @xmath227 + @xmath46 ( rad ) & @xmath228 + @xmath48 ( rad ) & @xmath227 + @xmath141 ( kpc ) & @xmath229 + @xmath104 & @xmath230 + @xmath59 & @xmath229 + @xmath58 ( kpc ) & @xmath231 +      @xmath37 ( deg ) & 31.361 & 0.233 & 0.05 & 31.443 & 0.082 & 0.064 + @xmath41 ( kpc ) & 29.228 & 0.167 & 0.04 & 29.217 & 0.011 & 0.010 + @xmath46 ( rad ) & 1.445 & 0.032 & 0.003 & 1.421 & 0.024 & 0.0005 + @xmath48 ( rad ) & 3.186 & 0.049 & 0.001 & 3.182 & 0.004 & 0.002 + @xmath141",
    "( kpc ) & 2.854 & 0.033 & 0.015 & 2.858 & 0.004 & 0.009 + @xmath104 & -1.828 & 0.005 & 0.002 & -1.833 & 0.005 & 0.005 + @xmath59 & 0.670 & 0.013 & 0.000 & 0.671 & 0.001 & 0.0004 + @xmath58 ( kpc ) & 13.500 & 0.276 & 0.15 & 13.917 & 0.417 & 0.016 +      @xmath37 ( deg ) & 31.361 & 0.233 & 31.449 & 31.526 & 31.457 + @xmath41 ( kpc ) & 29.228 & 0.167 & 29.094 & 29.326 & 29.108 + @xmath46 ( rad ) & 1.445 & 0.032 & 1.426 & 1.452 & 1.437 + @xmath48 ( rad ) & 3.186 & 0.049 & 3.172 & 3.168 & 3.160 + @xmath141 ( kpc ) & 2.854 & 0.033 & 2.869 & 2.848 & 2.865 +      @xmath37 ( deg ) & 31.373 & 0.244 & 0.08 & 0.008 + @xmath41 ( kpc ) & 29.218 & 0.184 & 0.07 & 0.012 + @xmath46 ( rad ) & 1.444 & 0.044 & 0.01 & 0.001 + @xmath48 ( rad ) & 3.184 & 0.034 & 0.008 & 0.002 + @xmath141",
    "( kpc ) & 2.862 & 0.025 & 0.008 & 0.009 + @xmath104 & -1.827 & 0.005 & 0.001 & 0.000 + @xmath59 & 0.458 & 0.023 & 0.005 & 0.001 + @xmath58 ( kpc ) & 19.404 & 0.581 & 0.09 & 0.051 +      @xmath173 & @xmath232 ( @xmath184 , @xmath185 , @xmath41 ) & 31.37 & 0.0 & 29.22 + @xmath173 & @xmath232 ( @xmath184 , @xmath185 , @xmath78 ) & 31.36 & 0.0 & 21.53 + @xmath173 & @xmath233 ( @xmath234 , @xmath235 , @xmath41 ) & 159.223 & -57.558 & 29.22 + @xmath173 & @xmath233 ( @xmath234 , @xmath235 , @xmath78 ) & 159.223 & -57.558 & 21.53 + @xmath173 & @xmath172 ( @xmath49 , @xmath57 , @xmath47 ) & -23.154 & 5.560 & -24.658 + @xmath174 & @xmath172 ( @xmath49 , @xmath57 , @xmath47 ) & -0.991 & -0.042 & 0.127 +"
  ],
  "abstract_text": [
    "<S> we present a maximum likelihood method for determining the spatial properties of tidal debris and of the galactic spheroid . with this method </S>",
    "<S> we characterize sagittarius debris using stars with the colors of blue f turnoff stars in sdss stripe 82 . </S>",
    "<S> the debris is located at ( @xmath0 kpc ) , with a ( spatial ) direction given by the unit vector @xmath1 in galactocentric cartesian coordinates , and with fwhm = @xmath2 kpc . </S>",
    "<S> this @xmath3-wide stripe contains 0.9% as many f turnoff stars as the current sagittarius dwarf galaxy . over small spatial extent , </S>",
    "<S> the debris is modeled as a cylinder with a density that falls off as a gaussian with distance from the axis , while the smooth component of the spheroid is modeled with a hernquist profile . </S>",
    "<S> we assume that the absolute magnitude of f turnoff stars is distributed as a gaussian , which is an improvement over previous methods which fixed the absolute magnitude at @xmath4 . </S>",
    "<S> the effectiveness and correctness of the algorithm is demonstrated on a simulated set of f turnoff stars created to mimic sdss stripe 82 data , which shows that we have a much greater accuracy than previous studies . </S>",
    "<S> our algorithm can be applied to divide the stellar data into two catalogs : one which fits the stream density profile and one with the characteristics of the spheroid . </S>",
    "<S> this allows us to effectively separate tidal debris from the spheroid population , both facilitating the study of the tidal stream dynamics and providing a test of whether a smooth spheroidal population exists . </S>"
  ]
}