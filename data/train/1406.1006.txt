{
  "article_text": [
    "when an object is imaged , variations of the refractive index in the medium , as well as optical alignment and manufacturing errors , distort the recorded image .",
    "this problem is typically solved using active or adaptive optics , where a deformable mirror , spatial light modulator ( slm ) or a comparable device corrects the propagating wavefront .",
    "typically , such systems are built with a separate optical arm to measure the distorted wavefront , because extracting the wavefront information from only focal - plane images is not trivial .",
    "however , focal - plane wavefront sensing is an active topic  not only to simplify the optical design but also to eliminate the non - common path aberrations limiting the performance of high - contrast adaptive optics systems .",
    "the most popular method for the focal - plane wavefront sensing is perhaps the gerchberg - saxton ( gs ) error reduction algorithm @xcite and their variations , for instance @xcite .",
    "these are numerically very efficient algorithms , and it is easy to modify them for different applications .",
    "however , they suffer from accuracy , in particular because their iterative improvement procedure often stagnates at a local minimum .",
    "various alternatives have been proposed , and a popular approach is to use general numerical optimization techniques to minimize an error function ; examples include @xcite .",
    "however , when the number of optimization parameters is increased , the computational requirements generally rise unacceptably fast .",
    "the high computational costs are problematic for instance in astronomy ; the largest future adaptive optics system is envisioned to have a wavefront corrector of a size of @xmath4 @xcite .",
    "the numerical issues can be significantly reduced , if the unknown wavefront is sufficiently small .",
    "this is the case , for example , when calibrating the non - common path aberrations .",
    "previous works have exploited the small - phase approximations @xcite , but the implementations are generally not easily extended to the wavefront correction at extremely large resolution , such as over @xmath5 elements .    in this paper , we present two algorithms capable of extremely fast control of a wavefront correcting device with 20  00030  000 degrees of freedom .",
    "the first algorithm , fast & furious ( ff ) , has been published before @xcite .",
    "it relies on small wf aberrations , pupil symmetries and phase - diversity to achieve very fast wf reconstruction .",
    "however , ff approximates the pupil amplitudes as an even function that not necessarily matches exactly the real situation .    to improve the wf correction beyond the accuracy of ff , a natural way is to use approaches similar to the gs algorithm .",
    "however , the standard modifications of the algorithm are sensitive to the used phase diversities , in particular when the pupil amplitudes are not known , and they do not work with iterative wavefront correction as in ff .",
    "therefore , our second algorithm combines ff and gs in a way that can be used not only to correct the wavefront , but also to estimate the pupil amplitudes  for which we make no assumptions .",
    "this comes at a cost in terms of noise sensitivity and instabilities as well as more demanding computational requirements .    at first",
    ", we illustrate the motivation and principles of the ff algorithm in section  [ sec : ff ] .",
    "then , section  [ sec : ffgs ] describes the fast & furious gerchberg - saxton ( ff - gs ) algorithm in detail .",
    "section  [ sec : hardware ] describes the used hardware , section  [ sec : results ] shows simulation and experimental results , and section  [ sec : conclusions ] draws the conclusions .",
    "the fast & furious algorithm is based on iteratively applying a weak - phase approximation of the wavefront .",
    "the main principle of the weak - phase solution is presented in @xcite , but we found slight modifications @xcite leading to significantly better performance .",
    "the algorithm uses focal - plane images and phase - diversity information to solve the wavefront , and the estimated wavefront is corrected with a wavefront correcting device .",
    "the correction step produces phase - diversity information and a new image that are again used to compute the following phase update .",
    "the schematic illustration of the algorithm is shown in fig .",
    "[ fg : algoscemaff ] .",
    "an important aspect of the algorithm is to maximize the use of the most recent psf  denoted as image 1 in fig .",
    "[ fg : algoscemaff ] . in the weak - phase regime ,",
    "a single image is sufficient to estimate both the full odd wavefront component and the modulus of the even component of the focal - plane electric field .",
    "the phase - diversity is needed only for the sign determination since we assume the wavefront aberrations are small .",
    "this makes the ff substantially less prone to noise and stability issues as compared to approaches relying more on the phase diversity information  such as the ff - gs .",
    "section  [ sec : ffdet ] explains the details of the weak - phase solution , and section  [ sec : ffpractical ] discusses the practical aspects when implementing the algorithm .",
    "a monochromatic psf can be described by fraunhofer diffraction and is given by the squared modulus of the fourier transform of the complex electric field in the pupil plane , @xmath6 where @xmath7 is the pupil amplitude describing transmission and @xmath8 is the wavefront in the pupil plane .",
    "the second order approximation of the psf , in terms of the wavefront expansion , can be written as @xmath9 the phase @xmath8 can be represented as a sum of even and odd functions , @xmath10 and eq .",
    "can then be written as @xmath11 we make the assumption that @xmath7 is even , and therefore all the terms here are either even or odd .",
    "therefore , the corresponding fourier transforms are then either purely real or imaginary with the same symmetries ; we list the corresponding terms in table  [ tb : sym ] .    .notations and symmetries [ cols=\"<,^,^,^,<,^,^ \" , ]      + @xmath12the residual wf rms errors ( rad ) at spatial frequencies falling within the used images .    in theory , both algorithms should reach zero wavefront error in the perfect case .",
    "however , in the case of ff , we still have to use numerical regularization to maintain stability , and this compromises the performance in the error - free case .",
    "this could be improved by optimizing the codes , but it is not done here ; the codes are optimized for the performance with all the error sources present .",
    "the most severe error source for the ff algorithm , as expected , is indeed the amplitude aberrations : instead of the ideal rms error of 0.03  rad , we are limited to an error of 0.11  rad .",
    "similar errors are also seen if the imaging model does not exactly match the actual hardware ; this was tested when simulating the wavefront and psf with double sampling ( case 2 in table  [ tb : errbud ] ) ; the double sampling was also used in the misalignment simulation .",
    "the different error sources are coupled , so they do not add up quadratically . in the presence of all the error sources",
    ", we end up having a residual wf error of @xmath10.12  rad .    with the ff - gs algorithm",
    ", we can radically reduce the problems of the unknown pupil aberrations .",
    "the transmission we used in simulations , however , had significant fluctuations creating speckles similar to what the wavefront aberrations do .",
    "therefore , the wavefront reconstruction problem is difficult to make unambiguous , and we saw a small residual rms error of 0.02  rad .",
    "the ff - gs is limited by the combined effect of read - out noise ( 0.05  rad ) , the fact that the slm couples the transmission and phase change ( 0.04  rad ) and the tt instability ( 0.04  rad ) .",
    "all the error sources add up quadratically , which indicates that they are largely independent .",
    "when comparing the ff and ff - gs , we see that a significant improvement can be obtained with the ff - gs algorithm ; the residual wavefront rms error is reduced from 0.12  rad to 0.08  rad",
    ". however , the method is more sensitive to uncertainties and noise : the tip - tilt jitter in our hardware has no influence on the ff while being a major error source with the ff - gs algorithm .",
    "we have demonstrated the performance of two numerically efficient focal - plane wavefront sensing algorithms : the fast & furious and its extension fast & furious gerchberg - saxton .",
    "both algorithms do an excellent job in calibrating static aberrations in an adaptive or active optics system : we demonstrated an increase in the strehl ratio from @xmath10.75 to 0.980.99 with our optical setup .",
    "although the ff - gs algorithm is more prone to noise , we observed a clear improvement . with our hardware  a high - resolution spatial light modulator as the wavefront corrector",
    " we estimate the remaining residual wavefront rms error to be @xmath10.15  rad with ff and @xmath10.10  rad with ff - gs .",
    "the difference occurs mostly at spatial frequencies corresponding to the 20th and further airy rings .",
    "simulations with error sources comparable to our hardware show very similar results .",
    "this increases our confidence that the estimated performance indicators are reliable , and the simulated error budget also confirms the unknown amplitude aberrations as the main limitation of the ff algorithm in the considered framework .    to our knowledge",
    ", this is the first time that such focal - plane sensing methods have been demonstrated with @xmath130  000 degrees of freedom  and in the case of ff - gs , with twice the number of free parameters to estimate the pupil amplitudes .",
    "the sampling at the detector was such that the controlled wavefront of @xmath0 pixels would have been enough to correct all spatial frequencies inside an image of @xmath13 pixels .",
    "however , as we recorded only an image of @xmath2 pixels , we had no direct observations of the higher controlled spatial frequencies .",
    "simulations indicate that this resulted in a small amount of light being scattered outside the recorded field , but this amount was too small to be easily detected in our optical setup .",
    "we put no particular effort into optimizing the codes ; all the software was implemented in matlab , and it was run on a standard windows pc .",
    "still , the required computation time was negligible compared to the time of @xmath115  s we needed to collect data for a single hdr image .",
    "we implemented the ff algorithm with two @xmath13 ffts per iteration step ( one fft transferring the phase - diversity information into the focal plane could likely be replaced by a convolution , as explained in @xcite ) .",
    "our ff - gs implementation used 8 ffts per iteration , and that could also potentially be optimized .",
    "as with all focal - plane wavefront sensing techniques , the algorithms work best if a monochromatic light source is available . with a chromatic light source",
    "having a sufficiently small bandwidth , perhaps @xmath110% , the algorithms would still work , but only with a limited corrected field .",
    "with special chromatic optics ( such as in @xcite ) or an integral field unit , it is potentially possible to use the algorithms with even wider bandwidth .",
    "currently , we have only demonstrated a case where an unobstructed psf is detected , and the wavefront is driven to be flat . to make the algorithms more interesting for astronomical applications in the extreme adaptive optics or ultra - high contrast imaging",
    ", a few extensions would be necessary .",
    "first , we should consider how coronagraphs and diffraction suppression optics will affect the techniques . in practice , this would mean that the core of the psf would not be detected , and we would need to consider also the moduli in a part of the focal - plane field as free parameters .",
    "second , instead of flattening the wavefront , we should optimize the contrast at a certain part of the field .",
    "this would mean calculating a wavefront shape that , in the same way as in @xcite , minimizes the light in certain regions of the field at the cost of increasing it in other parts ; the updated algorithm should then drive the wavefront to this desired shape .",
    "a similar problem is faced , if phase plates are used to create diffraction suppression , for instance as in @xcite .",
    "also in such a case , it is necessary to drive the wavefront to a particular shape that is far from flat .",
    "another , potentially interesting application is a real - time application , for instance as a high - order , second - stage sensor in an adaptive optics system .",
    "the computational load is manageable , and a successful system would greatly simplify the hardware design compared to a conventional ao approach .",
    "however , issues such as the requirement for small aberrations , chromaticity , temporal lag in the phase diversity and the limited dynamic range of the camera  and therefore photon noise  are major challenges .",
    "j.  j. green , d.  c. redding , s.  b. shaklan , and s.  a. basinger , `` extreme wave front sensing accuracy for the eclipse coronagraphic space telescope , '' in `` high - contrast imaging for exo - planet detection , '' , vol .",
    "4860 of _ proc .",
    "spie _ , a.  b. schultz , ed .",
    "( 2003 ) , vol .",
    "4860 of _ proc .",
    "spie _ , pp .",
    "266276 .",
    "r.  s. burruss , e.  serabyn , d.  p. mawet , j.  e. roberts , j.  p. hickey , k.  rykoski , s.  bikkannavar , and j.  r. crepp , `` demonstration of on sky contrast improvement using the modified gerchberg - saxton algorithm at the palomar observatory , '' ( 2010 ) , vol .",
    "7736 of _ proc .",
    "spie_.      p.  riaud , d.  mawet , and a.  magette , `` nijboer - zernike phase retrieval for high contrast imaging .",
    "principle , on - sky demonstration with naco , and perspectives in vector vortex coronagraphy , '' astron .",
    "astrophys.**545 * * , a150 ( 2012 ) .",
    "b.  paul , l.  m. mugnier , j .- f .",
    "sauvage , m.  ferrari , and k.  dohlen , `` high - order myopic coronagraphic phase diversity ( coffee ) for wave - front control in high - contrast imaging systems , '' optics express * 21 * , 31751 ( 2013 ) .    c.  vrinaud , m.  kasper , j .- l .",
    "beuzit , r.  g. gratton , d.  mesa , e.  aller - carpentier , e.  fedrigo , l.  abe , p.  baudoz , a.  boccaletti , m.  bonavita , k.  dohlen , n.  hubin , f.  kerber , v.  korkiakoski , j.  antichi , p.  martinez , p.  rabou , r.  roelfsema , h.  m. schmid , n.  thatte , g.  salter , m.  tecza , l.  venema , h.  hanenburg , r.  jager , n.  yaitskova , o.  preis , m.  orecchia , and e.  stadler , `` system study of epics : the exoplanets imager for the e - elt , '' in `` adaptive optics systems ii , '' , vol .",
    "7736 of _ proc .",
    "spie _ ( 2010 ) , vol .",
    "7736 of _ proc .",
    ", pp . 77361n77361n12 .      c.  s. smith , r.  marinic , a.  j. den dekker , m.  verhaegen , v.  korkiakoski , c.  u. keller , and n.  doelman , `` iterative linear focal - plane wavefront correction , '' journal of the optical society of america a * 30 * , 2002 ( 2013 ) .",
    "c.  u. keller , v.  korkiakoski , n.  doelman , r.  fraanje , r.  andrei , and m.  verhaegen , `` extremely fast focal - plane wavefront sensing for extreme adaptive optics , '' ( 2012 ) , vol .",
    "8447 of _ proc .",
    "spie _ , pp .",
    "844721844721 .",
    "v.  korkiakoski , c.  u. keller , n.  doelman , r.  fraanje , r.  andrei , and m.  verhaegen , `` experimental validation of optimization concepts for focal - plane image processing with adaptive optics , '' ( 2012 ) , vol .",
    "8447 of _ proc .",
    "spie _ , pp . 84475z84475z .",
    "l.  c. roberts , jr .",
    ", m.  d. perrin , f.  marchis , a.  sivaramakrishnan , r.  b. makidon , j.  c. christou , b.  a. macintosh , l.  a. poyneer , m.  a. van dam , and m.  troy , `` is that really your strehl ratio ? '' in `` advancements in adaptive optics , '' , vol .",
    "5490 of _ proc .",
    "spie _ ( 2004 ) , vol .",
    "5490 of _ proc .",
    ", pp . 504515 ."
  ],
  "abstract_text": [
    "<S> we present two complementary algorithms suitable for using focal - plane measurements to control a wavefront corrector with an extremely high spatial resolution . </S>",
    "<S> the algorithms use linear approximations to iteratively minimize the aberrations seen by the focal - plane camera . </S>",
    "<S> the first algorithm , fast & furious ( ff ) , uses a weak - aberration assumption and pupil symmetries to achieve fast wavefront reconstruction . </S>",
    "<S> the second algorithm , an extension to ff , can deal with an arbitrary pupil shape ; it uses a gerchberg - saxton style error reduction to determine the pupil amplitudes . </S>",
    "<S> simulations and experimental results are shown for a spatial light modulator controlling the wavefront with a resolution of @xmath0 pixels . </S>",
    "<S> the algorithms increase the strehl ratio from @xmath10.75 to 0.980.99 , and the intensity of the scattered light is reduced throughout the whole recorded image of @xmath2 pixels . </S>",
    "<S> the remaining wavefront rms error is estimated to be @xmath10.15 rad with ff and @xmath3 rad with ff - gs . </S>"
  ]
}