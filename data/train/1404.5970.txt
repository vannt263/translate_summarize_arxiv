{
  "article_text": [
    "increasingly , monte carlo methods are needed to provide answers to important scientific questions , particularly in the rapidly advancing field of genomics . for better or worse ,",
    "these questions are often framed within the formalism of statistical hypothesis testing . in many cases , monte carlo hypothesis testing techniques such as permutation testing are the only options .",
    "conceptually , these methods share an appealing clarity : as long as you can sample test statistics under the null hypothesis , the p - value is just the proportion of sampled test statistics that exceed the observed test statistic . one of our main aims is to show that the apparent simplicity of randomization hypothesis testing can be very deceptive . in the following , we use _ null model _ as a general term for the distribution of the resampled data ( e.g. ,  using random permutations ) , and we use _ null distribution _ to denote the distribution of the test statistic under the null model . even though there is a highly developed theory of classical hypothesis testing ( e.g. ,  @xcite ) , new practical and methodological problems appear when we need to resort to monte carlo testing :    * the question of interest may be unavoidably vague , so that it is not obvious how to translate it into a precise mathematical formulation .",
    "* there may be several possible choices of randomization null model , and no clear - cut criteria for choosing among them ( except possibly conservativeness arguments for choosing the null model giving the largest p - values ) . *",
    "a full specification of the null hypothesis consists of both the null model and the question of interest .",
    "this complicates the interpretation of a rejection of the null hypothesis ",
    "the question of interest may not really have been answered if the null model is inadequate .",
    "* there may be several possible choices of test statistic , and no clear - cut criteria for choosing one ( except possibly power considerations ) .",
    "if unresolved , these problems may degrade the reproducibility and transparency of investigations , as well as lead to false research findings .",
    "there has lately been an increasing focus on how to make science more reproducible , especially in the field of computational biology @xcite .",
    "also , due to the increased prevalence of data - driven science @xcite through increased availability of public data and more accessible and efficient analytical tools , there has also been a heated discussion on whether a large proportion of published research findings are false @xcite .",
    "we discuss this topic further in the remainder of this paper .",
    "our main application of interest is genomics and the genomic hyperbrowser  @xcite where choosing the correct null model is a major issue .",
    "we have discussed null models in ecology in a companion report , @xcite .",
    "several examples show that the choice of a null model can strongly affect the resulting p - values .",
    "we state that ordering the null models according to increasing preservation may imply an ordering of the statistical significance .",
    "further , if the null models are not able to capture the essential structural properties of data , this may lead to false findings .",
    "we proceed as follows : section  [ sec : randomization ] discusses general problems of randomization null models .",
    "section  [ sec : ordering ] presents null model preservation hierarchies and significance orderings .",
    "sections  [ sec : genomiclocation][sec : falserejections ] illustrate several different null models within genomics : section  [ sec : genomiclocation ] considers null models for the location of transcription factor binding sites , section [ sec : chromatinstates ] shows that genetic properties have a tendency to cluster along the genome , while section [ sec : falserejections ] illustrates that we may get false rejections with too simple null models using simulated data of points and segments in genomic tracks .",
    "finally , section  [ sec : discussion ] provides a general discussion and some concluding remarks and recommendations .    for the genomics case studies described in sections  [ sec : genomiclocation][sec : falserejections ] we have used q - values  @xcite to correct for multiple testing .",
    "assume that we test @xmath0 hypotheses where @xmath1 are the ordered , observed p - values , @xmath2 is the number of rejected null hypotheses , and @xmath3 is the ( unknown ) number of falsely rejected null hypotheses . the false discovery rate ( fdr )  @xcite",
    "is then defined as fdr @xmath4 . for each test , the corresponding q - value is defined as the minimum fdr at which the test is called significant .",
    "let @xmath5 be the proportion of tests that are truly null  @xcite and @xmath6 the q - value for the test with p - value @xmath7 .",
    "then , we may estimate @xmath6 by @xmath8 where @xmath9 is an estimate of @xmath5 .",
    "thus , the main inputs to this multiple testing method are the observed p - values together with an estimate of @xmath5 . to estimate @xmath5 ,",
    "we have used the robust estimator of  @xcite , since this is very computationally efficient and can be shown to be conservative in many realistic settings . for a general discussion of multiple - testing issues in monte carlo settings , see also @xcite .",
    "all calculations were performed using the r programming language  @xcite and the genomic hyperbrowser .",
    "a galaxy pages  @xcite document allowing for replication of the results is available at url : + https://hyperbrowser.uio.no/suppnullmodels .",
    "consider a hypothesis test based on data @xmath10 and a test statistic @xmath11 . without loss of generality , we may assume that large values of @xmath12 constitute evidence against @xmath13 .",
    "then , for an observed test statistic @xmath14 , the decision to accept or reject @xmath13 can be based on the p - value @xmath15 , where we reject @xmath13 if @xmath16 for some threshold @xmath17 , and where @xmath18 is the distribution of @xmath12 under the null model @xmath19 . if @xmath19 is false , @xmath12 has distribution @xmath20 .    in the classic textbook setting ,",
    "the null model is known and can be described explicitly , so we can directly compute the p - value .",
    "increasingly , both data and models are too complex for this to be done . in such cases we must resort to some type of monte carlo randomization test : we generate samples @xmath21 of the test statistic @xmath12 under the null model , and estimate the empirical p - value from the data set @xmath10 by @xmath22 where @xmath23 is the observed test statistic , and @xmath24 denotes the indicator function , equal to one if its argument is true , or zero if false .",
    "the idea of randomization testing has been around at least since the pioneering work of  @xcite , but has only become practical with the advent of electronic computers . for a recent overview of monte carlo methods ,",
    "see  @xcite .",
    "the randomization null model is arguably the most crucial component of the monte carlo testing setup .",
    "often , the research question and even the test statistics may be clear , but how should one specify the null model ? @xcite",
    "introduce the idea of null model preservation hierarchies , and note that `` a crucial aspect of an investigation is the precise formalization of the null model , which should reflect the combination of stochastic and selective events that constitutes the evolution behind the observed genomic feature .",
    "[ ... ] unrealistically simple null models may [ ... ] lead to false positives . '' here , we build further on these ideas , and provide a conceptual framework to aid the choice of null model .    in the statistics literature ,",
    "the most directly relevant previous papers on null models are  @xcite and @xcite .",
    "@xcite estimates the null model from data in multiple - testing problems , giving an `` empirical null '' .",
    "this is very useful for some multiple - testing settings , but not directly applicable to the problems we study here .",
    "@xcite propose subsampling methods based on a piecewise stationary model for genome sequences , a potentially useful approach for our case study in section  [ sec : genomiclocation ] , but which we feel would be beyond the scope of this paper .",
    "there is also relevant work from other disciplines .",
    "particularly , null models have been a very contested issue within ecology , as further discussed in  @xcite .",
    "for example ,  @xcite points out that `` the analysis of presence  absence matrices with null model randomization tests has been a major source of controversy in community ecology for over two decades '' .",
    "see also the book by  @xcite , and ( * ? ? ?",
    "* chapter 14 ) , who notes that `` one of the interesting aspects of this [ species competition problem ] is the difficulty in defining the appropriate model of randomness '' ( p.  348 ) .",
    "@xcite discuss randomization tests for spatially autocorrelated data . as discussed elsewhere in this paper ,",
    "genomics is another area where the problem of choosing the right null model is very urgent  @xcite .",
    "@xcite notes that `` a common question asked in many applications is the following : given the position vectors of two features in the genome [ ... ] and a measure of relatedness between features [ ... ] how significant is the observed value of the measure ?",
    "how does it compare with that which might be observed ` at random ? ' the essential challenge in the statistical formulation of this problem is the appropriate modelling of randomness of the genome , since we observe only one of the multitudes of possible genomes that evolution might have produced for our and other species . ''",
    "see @xcite for a general discussion of the importance of null models within bioinformatics .",
    "related work has also been done within the field of data mining , see  @xcite .",
    "@xcite consider the related problem of estimating the level of preservation needed to attain a pre - specified significance level @xmath17 ( for example @xmath25 ) .",
    "by assumption , the data set @xmath10 is taken as given , i.e.  it is not considered to be random sample from some population . in order to test our hypothesis we need to randomize @xmath10 from a null model @xmath19 . in many cases",
    "some specific features of @xmath10 will need to be preserved . in a specific problem",
    ", it may be very difficult to decide what features are fundamental and which are not .",
    "if we attempt to conserve all possible features of the observed @xmath10 , we are left with @xmath10 itself , and no basis for performing the hypothesis test .",
    "if we conserve too little , we generate realizations that violate basic properties of the phenomenon under study . different null models may preserve different properties of @xmath10 , e.g. null model @xmath19 preserves properties q and r and null model @xmath26 preserves properties r and s. but quite often we may order the null models according to increasing preservation of the properties of @xmath10 . we describe two different alternative description of ordering of preservation of the null models :    a. : :    let @xmath19 denote the state space obtained by a set of    resamplings ( for example , permutations ) that are allowed under a given    null model .",
    "that is , the state space is the set of all possible    combinations of values of variables in the stochastic model .",
    "we define    a preservation hierarchy if the following criteria are satisfied :    @xmath27 .",
    "we then state that    @xmath28 preserves more than @xmath29    for @xmath30 of the properties of the original    data set @xmath10 and hence is more restricted .",
    "as we will    discuss further below , a more restricted null model will in most cases    give less significant results , i.e.  p - values from    @xmath28 will tend to be larger than p - values from    @xmath31 if @xmath32 .",
    "note that we only consider * monte carlo * null models , i.e.  null models    that are generated by resampling from the observed data ( as in    permutation testing ) , and that the @xmath28 are sets of    allowed resamplings under @xmath13  they are * not * sets of    allowed parameter values .",
    "b. : :    let @xmath33 denote a state in the state    space and let the null model be defined by a set of allowed    permutations of the @xmath34 s .",
    "define @xmath35    for a certain property in base pair @xmath36 and otherwise    @xmath37 . assume further that the test statistic    @xmath12 is given by    @xmath38for    a fixed vector @xmath39 .",
    "we trivially have    @xmath40    and    @xmath41we    assume the stationary criteria @xmath42    and @xmath43 are independent of    @xmath36 .",
    "assume @xmath44 is    positive for @xmath45 small and decreases with increasing    distance @xmath45 , say    @xmath46 for some    decreasing , positive correlation function @xmath47 .",
    "the    covariance is smaller in null model @xmath48 than    @xmath49 if the corresponding correlation functions    satisfies @xmath50 for all    @xmath51 .",
    "this implies that the more the permutation    preserves of @xmath44 for    @xmath45 small , the larger is    @xmath52 . also here",
    "we may define a sequence of    null models with decreasing @xmath44 for    all distances @xmath45 implying larger values of    @xmath52 . in most cases",
    "it is reasonable to also    assume that @xmath53 is the same for all the null    models .",
    "case a and b may both be satisfied at the same time . in section [ sec : chromatinstates ]",
    "we argue that it is typical for genomic data of certain types to satisfy the criteria in case b , i.e.  @xmath44 is positive for @xmath45 small and decreases with increasing distance @xmath45 . in this case , we make assumptions directly on the test statistic @xmath12 which indicate larger empirical p - values ( see definition ( [ p - val2 ] ) ) the more we preserve of the original data @xmath10 . by assumption",
    "large values of @xmath12 indicate evidence against the hypothesis @xmath13 . a larger value of @xmath52 implies under quite general statistical assumptions that a larger fraction of the realizations have a test statistic @xmath54 ( provided the number of realizations are sufficiently large ) , leading to larger p - values .",
    "also in case a , an increasing state space will in most cases lead to an increase in @xmath52 .",
    "the relationship between preservation and significance is the same observation as in @xcite , `` obviously , the more restricted the null hypothesis [ ... ] the less significant the results of a data mining algorithm tend to be '' . we will call this observation the _ null complexity principle_.",
    "the null complexity principle may be an aid in choosing the correct level of preservation in the null model , as well as in interpretation of the results . since the null complexity principle",
    "does not always hold , it is necessary to demonstrate it for the problem under study .",
    "if this property is proved for the null models applied , then this is very useful information when choosing a null model .",
    "for example , a scientist wishing to be conservative may choose the null model known _ a priori _ to give the largest p - values .",
    "also , some monte carlo null models may be considerably more computationally demanding than others .",
    "then , we may first test a null model having low computational cost .",
    "if we reject the hypothesis using this model , we will also reject the hypothesis for less conservative ( and more computationally intensive ) null models .",
    "the ordering of the p - values imply that too simple null models may lead to false positives , as conjectured in  @xcite .",
    "our concepts of null models and preservation may be illustrated by the following simple example .",
    "assume we have tossed of a coin @xmath55 times and we question whether the observed proportion of heads in the beginning of the sequence is significantly larger than @xmath56 .",
    "we want to allow for the possibility of coins tosses being correlated .",
    "we use the number of heads in the first @xmath57 coins tosses as the test statistic .",
    "we use two different nullmodels . in null model 1",
    "we assume that the coins are independent of each other and have a 50% probability for head , so we can permute the observed coin tosses freely to sample from the null model .",
    "for null model 2 we permute each sequence of 2 observations from the observed @xmath58 coins in order to maintain a possible correlation between consecutive coins .",
    "the second model is more restrictive and according to the null complexity principle gives larger p - values .",
    "if there is positive correlation between consecutive coins , this increases the variability of the test statistics and hence increases the p - value .",
    "however , if there is negative correlation between consecutive coins , this decreases the variability of the test statistics and hence decreases the p - value .",
    "the example also illustrates that the null complexity principle often assumes positive correlations between terms in the test statistic . for test statistics defined on point processes ( such as the examples in section  [ sec : genomiclocation ] ) , this typically corresponds to attraction between points ( correlation between consecutive inter - point distances ) .",
    "intuitively , it is easier to envision mechanisms leading to attraction than repulsion ( although these for sure also exist ) .",
    "our experience is that positive correlations ( including attraction in points processes ) are much more common than negative correlations ( including repulsion ) in real data sets , which we also show for a number of genomic data sets , representing several classes of features , in section  [ sec : chromatinstates ] .",
    "as we have seen in case b above , in some cases it is important to preserve clustering of points , since this has important implications for the sizes of the resulting p - values .",
    "following the notation defined in the previous section , we may use the ripley s k - function  @xcite as a measure for clustering .",
    "this is defined relative to a distance @xmath23 as @xmath59 to simplify the notation , disregard edge effects by assuming that there exist @xmath60 and @xmath61 from the same process as @xmath62 . then @xmath63 for integer @xmath23 .",
    "we may write @xmath64 in terms of the correlation function @xmath47 , as follows : @xmath65 using our earlier definition of clustering ( @xmath50 for all @xmath51 ) this means that increased clustering implies increased @xmath64 for each @xmath23 .",
    "note that if @xmath34 and @xmath66 are independent for @xmath67 , then @xmath68 therefore we may define a scaled k - function , @xmath69 , as follows : @xmath70 then , @xmath71 corresponds to repulsion between points , @xmath72 to independent points , while @xmath73 corresponds to attraction between points .",
    "assume that we have observed @xmath74 and wish to estimate @xmath75 . to simplify notation ,",
    "let @xmath76 for @xmath77 and @xmath78 .",
    "then , we choose some value @xmath79 and estimate @xmath80 by @xmath81 where @xmath82 and @xmath83 are weights that correct for edge effects .",
    "finally , @xmath84 is estimated by @xmath85",
    "in this section , we will show how to choose a null model when we want to test whether the points in a point track are independent of segments in a segment track .",
    "several null models that have preservation orderings according to both case a and b in section [ sec : ordering ] are presented .",
    "the results are as expected , with more preservation giving larger p - values",
    ".    a fully extended human chromosome would be about one meter long , consisting of about 3 billion base pairs .",
    "the properties vary along the genome and we often divide the genome into bins and perform separate tests for each bin",
    ". there are about 30,000 genes , represented as intervals of base pairs or segments in the terminology of  @xcite .",
    "transcription factors ( tf ) regulate the expression of genes by binding to dna in the spatial proximity of the genes they regulate , interacting with the complex of proteins that transcribes dna to rna ( the transcriptional machinery ) . as the dna may form loops ,",
    "spatial proximity is not necessarily the same as proximity along the sequence .",
    "a tf that binds to dna may therefore regulate the expression of a gene that is millions of base pairs away from the binding site , and may even regulate genes on different chromosomes @xcite . in higher organisms , such as humans , transcription factor binding sites",
    "are organized into modular units , often referred to as cis - regulatory modules ( crm ) .",
    "these crm usually comprise a few hundred base pairs , and are characterized by a high local frequency of binding for one or several tfs @xcite .",
    "tfs that interact with the transcriptional machinery to increase the expression of genes at some distance from where the tfs bind to dna are often referred to as enhancers , and the regions of dna containing such tf binding sites are often referred to as enhancer regions .",
    "the tf are also segments of base pairs , but since these segments usually are shorter than the genes , these are often represented as unmarked points in the terminology of  @xcite .      in this section , we will discuss two null models that have a preservation ordering according to both case a and b of section [ sec : ordering ] .",
    "the results are as expected : more preservation gives larger p - values .",
    "we only get rejection of the null hypothesis when we have little preservation",
    ". this may be due to a too simple null model .",
    "a very basic question related to the positioning of transcription factor binding sites ( tfbs ) is whether the binding sites of a given tf fall preferentially inside or outside genes . as a concrete example",
    ", we consider binding sites for the transcription factor mitf @xcite in relation to ensembl gene regions  @xcite .",
    "we asked this question locally along the genome , dividing the genome into bins , and performing one separate test per bin .",
    "as bins we used chromosome bands , which represent a common partition of chromosomes into regions of a few megabases . to ensure a reasonable amount of data for the tests , we only considered chromosome bands containing at least one gene and five tfbs , resulting in 73 bins .",
    "separate tests were performed for each bin .    how can a hypothesis test be specified for this problem ? clearly , a natural test statistic is the number @xmath12 of tfbs falling inside genes .",
    "furthermore , let @xmath86 be the total number of tfbs in the bin , and @xmath87 the proportion of the bin covered by genes .",
    "a natural null model is that tfbs are uniformly and independently located within each bin .",
    "it is then easily seen that the distribution of the test statistic is @xmath88 .",
    "there are other alternatives .",
    "for instance , one might assume that the tfbs are poisson distributed within the bin .",
    "this would preserve the underlying probability of observing a tfbs instead of the exact count of observed tfbs , thus giving rise to a ( slightly ) different null distribution . in our opinion ,",
    "when realisations are based on monte carlo analysis , it is necessary to carefully study the properties of the null model .",
    "mistakes are easily made if one directly writes down the null distribution of the test statistic .    performing the binomial test as described above yields the conclusion that there is preferential location inside genes for 9 out of the 73 bins after multiple testing correction ( at a 10% false discovery rate ) .",
    "this could be taken as an indication of local variation of an underlying ( mechanistic ) tendency of f tfbs for the transcription factor mitf to be located inside gene regions .",
    "the tfbs may form clusters , denoted crm , with a typically length of a few hundred base pairs .",
    "this is a much smaller scale than the gene regions , which typically are several thousand base pairs .",
    "the clustering of tfbs appears to be an intrinsic property of the tfbs themselves , and not a part of the tfbs ",
    "gene relation that is being tested .",
    "this suggests that at least some aspects of clustering should be preserved in the null model . letting @xmath35 for a tfbs in base pair @xmath36",
    ", this is an example of case b of section  [ sec : ordering ] .",
    "most of the clusters are either completely inside or completely outside a segment , meaning that @xmath89 is larger for @xmath36 and @xmath90 close .",
    "if we maintain this positive correlation in the null model , this gives higher p - values .",
    "this is tested by using two different null models .",
    "the first model is the null model described above , where we only preserve the total number of tfbs . in the second model",
    "the empirical inter - tfbs distances are preserved in the null model by only permuting these distances .",
    "this second model preserves more of positive correlation in @xmath89 .",
    "these two null models are in fact also an example of case a in section  [ sec : ordering ] since both null models give a finite state space with equally likely states and the second null model is a subset of the first one .",
    "the p - values from the two null models are illustrated in figure [ fig : uniformvsinterpoint ] .",
    "we see clearly that preserving the empirical inter - tfbs distances in the null model gives larger p - values .",
    "some bins show very different results between null models , for example , at chromosome band q25.1 , where independent location gives a p - value less than 0.0005 , while preservation of inter - tfbs distance gives a p - value of 0.1 .",
    "this is probably due to strong correlation @xmath89 in this bin . when the empirical distribution of inter - tfbs distances is preserved , the null hypothesis is not rejected in any bin at 10% fdr , suggesting that the significant findings under the uniformity assumption may simply be due to inadequacy of the null model .",
    "in this section , two pairs of null models with preservation ordering according to case a in section [ sec : ordering ] .",
    "the p - values are ordered as expected : more preservation gives larger p - values .    in the above discussion",
    ", we have implicitly assumed that the tfbs distribution should be stochastic in the null model , while genes are preserved exactly at their genomic locations .",
    "this seems reasonable from a biological standpoint , as the location of binding sites can generally be assumed to follow the location of genes chronologically through evolution ( although there may be exceptions , such as coding regions copied into genomic regions that already have an established regulatory machinery ) .",
    "however , one should also consider which of the tracks have the more complex structure .",
    "this structure should be preserved in the null model , and one would prefer to randomize the track with the simplest structure . although the location of genes is clearly not uniform , it can be argued that the tfbs has an even more complex structure .",
    "the reason is that individual tfbs fall as clusters with specific intra - cluster structure inside regulatory regions , with regulatory regions again having a certain structure in relation to genes . indeed , as can be seen from figure [ fig : lowest50pvalues ] , the p - values are somewhat higher when randomizing genes as opposed to tfbs . in the figure",
    "we compare the two null models described above randomizing tfbs - positions and two null models where we randomize the gene locations with random positioning and preserving inter - gene distances .",
    "these two null models , randomizing the gene locations , are also examples of case a in section  [ sec : ordering ] .",
    "as expected , the second null model gives larger p - values .",
    "the two models with gene randomization also give larger p - values than the two models with tfbs randomization , indicating that the models with gene randomization preserve more of the complex interaction between genes and tfbs than the two other models . note also that the difference between the two models randomizing gene are smaller than between the two models randomizing tfbs .",
    "this indicates that preserving inter - distances is more important for tfbs than for genes .",
    "in this section , we will show that clustering is present in a large amount of genomic tracks . clustering leads to the preservation ordering shown in case b of section [ sec : ordering ] .",
    "again , the p - values are ordered , with more preservation giving larger p - values .",
    "the dna has to be highly compacted in order to fit into a cell . at the same time",
    ", it has to be accessible , for example , to the binding of transcription factors in order to allow efficient gene regulation . to achieve controlled compactness and accessibility ,",
    "dna is packed in a structured manner at multiple levels .",
    "the first such organizational layer consists of the dna double helix , at the order of 100 base pairs , wound around small protein complexes called nucleosomes @xcite .",
    "these nucleosomes can be modified through the attachment of other molecules to the proteins of the nucleosomes , which are called histones .",
    "this is referred to as histone modification , and serves a regulatory role in itself @xcite .",
    "recently , it has become possible to create genome - wide maps of histone modifications through the use of high - throughput sequencing protocols @xcite .",
    "it has been suggested that combinations of such histone modifications in a given region , referred to as chromatin states , can be used as a mark of the functional role of the region @xcite .",
    "one of the proposed chromatin states , the `` 5-enhancer '' ( shortened to `` se '' in part of the following text ) is suggested to correspond to regions that play a role in gene regulation by providing accessible binding sites to several transcription factors .",
    "it is thus interesting to see whether different tfs indeed shows a higher than expected density of experimentally determined binding events inside these regions . to investigate this",
    ", we considered a collection of 82 tracks of experimentally determined tf binding events in blood cells ( cell type gm12878 ) generated through the encode project .",
    "the tracks are originally of type segments , corresponding to called signal peaks of chip - seq experiments  @xcite .",
    "these peak segments are around 100 bps long , reflecting experimental inaccuracy in the determination of binding sites that are themselves around 5 - 25 bp long  @xcite .",
    "the real binding sites are often , but not always , located around the center of these peak regions . in our analyses , we used the midpoints of the peak regions as binding site locations . for each tf",
    ", we then tested whether the binding locations occurred inside regions in the `` 5-enhancer '' chromatin state , more than expected by chance .",
    "an analysis of the direct relation between tf binding locations and chromatin states might be strongly confounded by a common relation to gene locations . to reduce this potentially confounding factor , we focused the study of the relation between tf binding and enhancer states on only contiguous regions of size @xmath91 , that are more than 100 kbps away from the nearest gene .",
    "parts of these regions are located in centromeres , where neither tf binding events nor chromatin states can be mapped . to avoid any bias due to this",
    ", we constrained the analysis regions to only part of regions being located in chromosome arms .",
    "there is a total of 580 such regions in the human genome ( using the ensembl gene definition for computing distance from genes ) , ranging in size from 100 kbp to 2.6 mbp , and covering a total of 151 mbps .",
    "that are more than 100 kbps away from the nearest gene , followed by a box based on 147 tracks of dhs for different cell types and finally a box with elements of chromatin state `` 5 - strong enhancer '' in nine different cell types .",
    "the clustering is analysed for two different scales for the two first data types . ]    as can be seen from figure [ fig : kboxplot ] , encode tracks display a strong clustering tendency across different scales for a large number of tracks of different types .",
    "the scaled ripley k values are described in section [ sec : clustering ] .",
    "all the collections show a typical clustering tendency well beyond the neutral value of 1 . based on these results ,",
    "we claim that clustering is typical for genomic data of this type .",
    "we observe very few data sets where we find repulsion .",
    "case b in section [ sec : ordering ] shows that clustering may give increasing p - values for null models : if we reduce or remove the clustering in the stochastic model , i.e. reduce the preservation , then the p - values decrease .",
    "hence , the p - value from the null models are ordered according to increasing preservation of the clustering . when testing the clustering it is important to apply a scale that is adapted to the length of the observed property , e.g.  tfs .",
    "the ordering of the p - values depends on the scale of clustering relative to the length of the properties ( e.g.  genes ) in the other tracks used in the test .    furthermore , we tested whether chip - seq peaks for 47 different tfs transcription factors were located more than expected inside regions of chromatin state 5-strong enhancer .",
    "p - values for two different null models with random location of the chip - seq peaks or preserving the inter - distances from the original tracks are shown in figure [ fig : pvalsandkexclcentromers ] ) .",
    "a total of 81 tracks of tf chip - seq peak region for the cell type gm12878 were retrieved from the encode data collection and analysed against strong enhancer inside regions of size @xmath91 that were more than 100 kbps away from the nearest gene . for 34 of these tracks",
    ", there were less than a total of 20 peaks across all analyses regions , and they were removed from the analysis .",
    "the p - values were computed based on monte carlo , using 10 000 samples , thus giving a minimum achievable p - value of 1e-4 . for some tfs , this minimum p - value was achieved using either null model . for other tfs",
    ", either null model resulted in a p - value of 1 . in all cases where the two null models resulted in different p - values ,",
    "the null model that preserves inter - point distances gave the highest p - value .",
    "as we can see from figure [ fig : pvalsandkexclcentromers ] , very low p - values are reached for many of the tests , confirming that the 5-strong enhancer chromatin state captures histone modification patterns indicative of tf binding . indeed , when considering the union of binding locations across all tfs , the relation between tfs and se is highly significant ( @xmath92 ) for either null model .",
    "our interpretation of the results is that it clearly appears to be a relation of tf binding and the 5-strong enhancer chromatin state , but that the data limitation due to only considering regions that meets the strict criteria above does not allow a conclusion to be drawn regarding this relation for all tfs , when considering only the behaviour in these regions .",
    "the systematic difference between p - values achieved using the two null models then reflects that the null model preserving inter - point distances more accurately portrays the possibility of concluding on the tf - se relation , while the null model disregarding the clustering of tf points ( inter - point distances ) gives p - values that are lower than the degree of certainty that can really be assigned to the tf - se relation in the considered analysis regions .",
    "in this section , we perform hypothesis tests based on simulated data with clustering representative for genomic data .",
    "one test has synthetic tracks for points and segments and another test uses real tf tracks and simulated segment tracks .",
    "we generate the tracks independently from each other , so the null hypothesis of independence should not be rejected for any of the tests . in both cases",
    ", we get many false rejections if we assume uniform locations of points , but good results when we preserve interpoint distances .",
    "the previously presented genomic cases confirm that a null model with a higher level of preservation typically gives higher p - values on real data .",
    "however , they do not tell us which null model should be preferred . as",
    "the simple null models will typically be easier to implement , will often allow computationally fast analytical solutions , and will typically give more significance , they may be a tempting choice for a practitioner .",
    "however , when their assumptions are not met , there is a severe risk of false positive findings , due to the failure of the null model to account for intrinsic characteristics of the data , unrelated to the null and alternative hypotheses that are on trial .    in order to study the potential severity of false positive findings due to unrealistic null models , we performed a simulation study .",
    "two tracks were generated independently , but with various intrinsic clustering - related properties .",
    "they were then tested for a relation , under different null models .",
    "the results are shown in table  [ tab : generationvsassumption ] .",
    "the synthetic tracks were generated according to the approach described in @xcite .",
    "independent points were generated according to a poisson distribution with @xmath93 .",
    "clustered points were generated under an intra - cluster poisson distribution with @xmath94 , and inter - cluster poisson with @xmath93 , with each point having a probability @xmath95 of forming a new cluster .",
    "segments were generated similarly to points , with distance between consecutive segments following a poisson distribution with @xmath96 .",
    "lengths of segments were distributed uniformly between @xmath97 and @xmath57 base pairs . for each combination , 100 separate tests were performed , and the number of false rejections reported after multiple testing correction at 20% fdr .",
    "we notice that inappropriate assumptions could lead to up to 19% of null hypotheses being falsely rejected after correction for multiple testing .    preserving more of the individual properties ( inter - element distances )",
    "was the safe choice , essentially avoiding false rejections , while assuming uniform point locations resulted in a high degree of false rejections , whether the test was resolved analytically or by monte carlo simulation . for this particular test , using a too simple assumption on segment location ( assuming uniform location for segments that were in reality clustered ) presented less of a problem .",
    "the reason for this is that the auto - correlation between values of @xmath34 , as discussed in section [ sec : ordering ] , would be relatively low , and thus not lead to any strong under - estimation of p - values .",
    ".number of falsely rejected null hypotheses under different combinations of data generation procedures and testing assumptions .",
    "two tracks of points and segments , respectively , are generated independently , and then tested for significant relation .",
    "the different columns correspond to whether points or segments are generated uniformly ( poisson ) or with a tendency for clustering .",
    "the different rows correspond to whether points or segments are assumed to be random in the null model , as well as whether location is assumed to be uniformly distributed or according to a preserved empirical distribution of inter - element distances . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     [ tab : generationvsassumption ]    it was shown in the previous two sections that using simple null models led to lower p - values and more rejections when testing the relation of tf binding to genes to certain chromatin states .",
    "although it would be tempting to consider the higher significance as a sign of better power of the testing setup , the assumption of uniform tf binding location is problematic and could lead to p - values being underestimated .",
    "we have also shown on purely simulated data that too simple and unrealistic assumptions can lead to a high degree of false rejections . here , we combine the real data of tf binding with simulated segment data having the same characteristics as genes and chromatin states , but where the simulated data is generated independently from tf binding locations and chromatin states .",
    "the null hypothesis should then not be rejected in any test after multiple testing correction .",
    "for each chromosome band with at least 5 mitf binding sites , we tested whether these binding sites occur differently than expected inside simulated segments .",
    "this resulted in @xmath13 being rejected in 1 out of 73 bins at 10% fdr when assuming uniform mitf locations .",
    "however , when performing the tests only on 14 bins with a more satisfactory amount of data ( at least 10 mitf binding sites ) , the null hypothesis is rejected in 4 out of 14 bins ( still at 10% fdr ) .",
    "this high rate of false rejections suggest that part of the significance observed for mitf versus genes or chromatin states under the assumption of uniform location is likely due to under - estimation of p - values due to the inadequacy of this null model .",
    "conversely , preserving the empirical distribution of inter - mitf distances leads to no rejections of @xmath13 at 10% fdr , either when testing in all 73 bins or in the 14 bins with most mitf binding sites .",
    "this suggests that the preservation of inter - point distances is able to capture the intrinsic structure of the mitf track in an appropriate manner .    in summary , we find that the choice of null model strongly influences the results . mainly , the difference is that a null model preserving more of the observed data yields higher p - values .",
    "tests on simulated data show that an overly simple null model , preserving too little of the observed data , can lead to a large number of false rejections , even after correcting for multiple testing .",
    "in this paper , we have studied the choice of monte carlo null models .",
    "we have defined the monte carlo state space as the ( finite ) set of allowed resamplings of the observed data , and defined a monte carlo null model preservation hierarchy . we have discussed the null complexity principle , namely that an ordering of preservation may imply a corresponding ordering of statistical significance ( i.e. , of estimated p - values ) , and illustrated the use of our result on real data sets of general interest .",
    "the choice of null model is very application dependent , so it is difficult to give general guidelines .",
    "however , two general approaches are 1 ) to be conservative and choose the largest p - value and 2 ) use the most restricted null model ( which however should still have sufficient freedom of variability to provide an efficient test ) , so that we are `` close to the truth '' , i.e.  faithful to restriction given by the phenomenon under study . because of the null complexity principle , approaches 1 ) and 2 ) will usually coincide .    a fundamental feature of the monte carlo approach to statistical inference is that conclusions may only be drawn regarding the actual observed data . in other words",
    ", there is no prospect for generalizations to any ( hypothetical or real ) population .",
    "while some may see this as a serious drawback of monte carlo methods , we feel that this line of objection to randomization methodology is often quite misguided .",
    "obviously , the idea of random sampling from a population is both useful and extremely entrenched in classical statistics .",
    "however , often is it very hard to even conceive of the `` population '' in which random sampling is supposed to take place .",
    "genomics and dna sequences are good examples of this . in many cases ,",
    "the monte carlo method is simply a more natural approach : we do not wish to draw conclusions from a sample to a population , it is really the ( single , unique ) sample itself that we are genuinely interested in . in this paper",
    "we have focused on examples from genetics since this is our main interest and motivation for the paper .",
    "but similar problems are encountered in other areas such as ecology , as documented in a separate report , see  @xcite    an interesting topic for future work would be to study the implications for the multiple hypothesis testing setting . for a discussion of some computational and conceptual challenges of monte carlo multiple testing ,",
    "see  @xcite .",
    "the multiple testing problem is particularly important in genomics , but it also appears in ecology , see e.g. ,  @xcite .    our main focus has been avoiding false positives due to too simple null models . of course",
    ", false negatives also occur , and the effect of differing null models on the power of tests should be further studied . in order to avoid underpowered tests ,",
    "a very general advice is the following .",
    "most test statistics in the paper are based on counting , hence the variance of test statistics decreases as @xmath98 where @xmath58 is the number of samples . but observations may be correlated , reducing power .",
    "we may have very high correlation between a large number of observations .",
    "it is important to be aware of this and try to find test statistics where the correlation between observations is as small as possible .",
    "finally , we have also considered a third type of null model preservation , where the data is a sequence of categorical variables , e.g.  acgt   for a dna sequence .",
    "the distribution for each variable depends on the value of the previous @xmath86 variables . in this model , it is possible to have the same probability distribution for sequences of length @xmath86 as in the observed data .",
    "then , increasing @xmath86 implies preservering more of the probabilistic structure of the original data .",
    "we omitted this material to make the paper shorter and more focused .",
    "a separate paper on this topic is in preparation .",
    "we thank knut liestl , marit holden and arnoldo frigessi , as well as the editor , an associate editor and two anonymous referees , for very helpful comments and suggestions ."
  ],
  "abstract_text": [
    "<S> as increasingly complex hypothesis - testing scenarios are considered in many scientific fields , analytic derivation of null distributions is often out of reach . to </S>",
    "<S> the rescue comes monte carlo testing , which may appear deceptively simple : as long as you can sample test statistics under the null hypothesis , the p - value is just the proportion of sampled test statistics that exceed the observed test statistic . </S>",
    "<S> sampling test statistics is often simple once you have a monte carlo null model for your data , and defining some form of randomization procedure is also , in many cases , relatively straightforward . </S>",
    "<S> however , there may be several possible choices of randomization null model for the data , and no clear - cut criteria for choosing among them . </S>",
    "<S> obviously , different null models may lead to very different p - values , and a very low p - value may thus occur due to the inadequacy of the chosen null model . </S>",
    "<S> it is preferable to use assumptions about the underlying random data generation process to guide selection of a null model . in many cases </S>",
    "<S> , we may order the null models by increasing preservation of the data characteristics , and we argue in this paper that this ordering in most cases gives increasing p - values , i.e.  lower significance . </S>",
    "<S> we denote this as _ the null complexity principle_. the principle gives a better understanding of the different null models and may guide in the choice between the different models .    , </S>"
  ]
}