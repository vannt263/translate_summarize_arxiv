{
  "article_text": [
    "in the last decade , substantial developments have been made in the area of model - based feedback flow control of fluids : for instance , see the recent reviews by @xcite . in many applications ,",
    "the focus is on how to apply actuation to maintain the flow around an equilibrium state of interest , for instance to delay transition to turbulence , or control separation on a bluff body .",
    "linear control theory provides efficient tools for the analysis and design of feedback controllers .",
    "however , a significant challenge is that models for flow control problems are often very high dimensional , e.g. , on the order of @xmath0 , so large that it becomes computationally infeasible to apply linear control techniques . to address this issue , model reduction , by which a low - order approximate model is obtained ,",
    "is therefore widely employed .",
    "several techniques are available for model reduction , many of which involve projection onto a set of modes",
    ". these may be global eigenmodes of a linearized operator @xcite , modes determined by proper orthogonal decomposition ( pod ) of a set of data @xcite , and various variants of pod , such as including shift modes @xcite .",
    "an approach that is used widely for model reduction of linear systems is balanced truncation @xcite , and while this method is computationally intractable for systems with very large state spaces ( dimension @xmath1 ) , recently an algorithm for computing approximate balanced truncation from snapshots of linearized and adjoint simulations has been developed @xcite and successfully applied to a variety of high - dimensional flow control problems @xcite . in this method , sometimes called balanced pod , one obtains two sets of modes ( primal and adjoint ) that are bi - orthogonal , and uses those for projection of the governing equations , just as in standard pod . compared to most other methods , including pod , balanced truncation has key advantages , such as _ a priori _ error bounds , and guaranteed stability of the reduced - order model ( if the original high - order system is stable ) .",
    "balanced pod is an approximation of exact balanced truncation that is computationally tractable when the number of states is very large ( for instance , up to @xmath2 ) , and typically produces models that are far more accurate than standard pod models .",
    "for instance , for a linearized channel flow investigated in  @xcite , even though the first 5 pod modes capture over 99.7% of the energy in a dataset exhibiting large transient growth , a low - dimensional model obtained by projection onto these modes completely misses the transient growth .",
    "by contrast , a 3-mode balanced pod model captures the transient growth nearly perfectly ; to do as well with a standard pod model , 17 modes were required .",
    "the main steps of balanced pod include ( a ) taking snapshots from impulse responses of the linearized and adjoint systems , ( b ) computing a singular value decomposition ( svd ) of a matrix formed from inner products of these snapshots , ( c ) constructing primal modes and adjoint modes from the resulting singular vectors , and ( d ) projecting the high - dimensional dynamics onto these modes .    while effective in many examples , balanced pod also faces challenges , especially for use with experimental data .",
    "the main restriction is that balanced pod requires snapshots of impulse - response data from an adjoint system , and adjoint information is not available for experiments .    to address this issue , here",
    "we describe an algorithm widely used for system identification and model reduction , the eigensystem realization algorithm ( era ) @xcite .",
    "this algorithm has been used for problems in fluid mechanics , primarily as a system - identification technique for flow control  @xcite , but also for model reduction @xcite .",
    "our main result , presented in section  [ sec : era ] , is that , for linear systems , era theoretically produces _ exactly the same _ reduced - order models as balanced pod , with no need of an adjoint system , and at an order of magnitude lower computational cost .",
    "this result implies that one can realize approximate balanced truncation even in experiments , and can also improve computational efficiency in simulations .",
    "we note that era and snapshot - based approximate balanced truncation have been applied together in a model reduction procedure in  @xcite .",
    "however , the theoretical equivalence between these two algorithms was not explored in that work .",
    "we present a comparison between balanced pod and era , and show that if adjoint information is available , balanced pod also has its own advantages .",
    "in particular , balanced pod provides sets of bi - orthogonal primal / adjoint modes for the linear system , and can be directly generalized to unstable systems . in section  [ sec :",
    "erapseudomodes ] , we discuss a modified era algorithm that , in the absence of adjoint simulations , uses `` pseudo - adjoint modes '' to compute reduced order models ; however , this method does not produce balanced models , and performs worse than balanced pod in examples . in section  [ sec : numerical ]",
    ", we illustrate these methods using a numerical example of the two - dimensional flow past an inclined plate , at a low reynolds number .",
    "in this section , we summarize the steps involved in approximate balanced truncation ( balanced pod ) , and the eigensystem realization algorithm , and show that they are equivalent .",
    "balanced truncation involves first constructing a a coordinate transformation that `` balances '' a linear input - output system , in the sense that certain measures of controllability and observability ( the gramian matrices ) become diagonal and identical  @xcite . a reduced - order model",
    "is then obtained by truncating the least controllable and observable states , which correspond to the smallest diagonal entries in the transformed system .",
    "unfortunately , the exact balanced truncation algorithm is not tractable for the large state dimensions encountered in fluid mechanics .",
    "however , an approximate , snapshot - based balanced truncation algorithm , referred to as balanced proper orthogonal decomposition ( balanced pod ) was proposed in  @xcite , and has been used successfully in several examples  @xcite .    the second technique , the eigensystem realization algorithm ( era ) , has been used both for system identification and for model reduction , and it is well known that the models produced by era are approximately balanced @xcite .",
    "here we show further that , theoretically , era produces exactly the same reduced order models as balanced pod .",
    "this equivalence indicates that era can be regarded as an approximate balanced truncation method , in the sense that , before truncation , it implicitly realizes a coordinate transformation under which a pair of approximate controllability and observability gramians are exactly balanced .",
    "this feature distinguishes era from other model reduction methods that first realize truncations and then balance the reduced order models .",
    "note that in era the gramians , and the balancing transformation itself , are never explicitly calculated , as we will also show in the following discussions .    for both techniques , we will consider a high - dimensional , stable , discrete - time linear system , described by @xmath3 where @xmath4 is the time step index , @xmath5 denotes a vector of inputs ( for instance , actuators or disturbances ) , @xmath6 a vector of outputs ( for instance , sensor measurements , or simply quantities that one wishes to model ) , and @xmath7 denotes the state variable ( for instance , flow variables at all gridpoints of a simulation ) .",
    "these equations may arise , for instance , by discretizing the navier - stokes equations in time and space , and linearizing about a steady solution , as will be demonstrated in the example in section  [ sec : numerical ] .",
    "the goal is to obtain an approximate model that captures the same relationship between inputs  @xmath8 and outputs  @xmath9 , but with a much smaller state dimension : @xmath10 where the reduced state variable  @xmath11 , @xmath12 .",
    "we consider the discrete - time setting , because we are primarily interested in discrete - time data from simulations or experiments .      here , we give only a brief overview of the balanced pod algorithm , and for details of the method , we refer the reader to  @xcite .",
    "the algorithm involves three main steps :    * * step 1 : * _ collect snapshots .",
    "_ run impulse - response simulations of the primal system ( [ lti ] ) and collect @xmath13 snapshots of _ states _",
    "@xmath14 in @xmath15  steps : @xmath16 where @xmath17 is the sampling period .",
    "in addition , run impulse - response simulations for the adjoint system @xmath18 where the asterisk @xmath19 stands for adjoint of a matrix , and collect @xmath20 snapshots of states  @xmath21 in @xmath22  steps : @xmath23 calculate the generalized hankel matrix , @xmath24 * * step 2 : * _ compute modes .",
    "_ compute the singular value decomposition of @xmath25 : @xmath26 where the diagonal matrix @xmath27 is invertible and includes all non - zero singular values of @xmath25 , @xmath28 , and @xmath29 .",
    "choose @xmath30 .",
    "let @xmath31 and @xmath32 denote the sub - matrices of @xmath33 and @xmath34 that include their first @xmath35 columns , and @xmath36 the first @xmath37 diagonal block of @xmath38 .",
    "calculate @xmath39 where the columns of @xmath40 and @xmath41 are respectively the first @xmath35 primal and adjoint modes of system  ( [ lti ] ) .",
    "the two sets of modes are bi - orthogonal : @xmath42 . * * step 3 : * _ project dynamics . _",
    "the system matrices in the reduced order model  ( [ ltireduced ] ) are @xmath43    note that the @xmath44 controllability / observability gramians are approximated by the matrices @xmath45 and @xmath46 .",
    "the reduced - order model  ( [ ltireduced ] ) is obtained by considering a subspace @xmath47 , and projecting the dynamics  ( [ lti ] ) onto this subspace using the adjoint modes given by  @xmath41 .",
    "it was shown in @xcite that @xmath40 and @xmath41 respectively form the first @xmath35 columns of the balancing transformation / inverse transformation that _ exactly _ balance the approximate controllability / observability gramians @xmath45 and  @xmath46 ; see more discussion in section  [ sec : erapseudomodes ] .",
    "the eigensystem realization algorithm ( era ) was proposed in  @xcite as a system identification and model reduction technique for linear systems .",
    "the algorithm follows three main steps",
    "@xcite :    * * step 1 : * run impulse - response simulations / experiments of the system ( [ lti ] ) for @xmath48 steps , where @xmath49 and @xmath50 respectively reflect how much effect is taken for considering controllability and observability , and @xmath17 again is the sampling period .",
    "collect the snapshots of the _ outputs _",
    "@xmath9 in the following pattern : @xmath51 the terms @xmath52 are commonly called _",
    "markov parameters_. construct a generalized hankel matrix @xmath53 @xmath54 * * step 2 : * compute svd of @xmath25 , exactly as in  ( [ svdh ] ) , to obtain @xmath33 , @xmath34 , @xmath38 .",
    "let @xmath55 .",
    "let @xmath31 and @xmath32 denote the sub - matrices of @xmath33 and @xmath34 that include their first @xmath35 columns , and @xmath36 the first @xmath37 diagonal block of @xmath38 . * * step 3 : * the reduced @xmath56 , @xmath57 and @xmath58 in ( [ ltireduced ] ) are then defined as @xmath59 where @xmath60 which can again be constructed directly from the collected snapshots  ( [ snapshots ] ) .",
    "the first observation is that , with @xmath61 and @xmath62 given by  ( [ x ] ) and  ( [ y ] ) , the generalized hankel matrices obtained in balanced pod and era , respectively by  ( [ hankelxy ] ) and  ( [ hankel ] ) , are theoretically identical .",
    "the theoretical equivalence between the two algorithms then follows immediately : first , @xmath63 given in ( [ hankelprime ] ) satisfies @xmath64 , which implies the matrices @xmath56 obtained in the two algorithms are identical .",
    "to show the equivalence of @xmath65 , first note that the svd  ( [ svdh ] ) leads to @xmath66 , which , by definition of @xmath31 , @xmath32 , @xmath36 , implies @xmath67 .",
    "( note that it does _ not _ imply @xmath68 , since @xmath69 is not the identity . ) thus , in balanced pod , @xmath70 , which equals the first @xmath71 columns of @xmath72 , which is the @xmath57 given by era .",
    "similarly , the svd  ( [ svdh ] ) leads to @xmath73 and then @xmath74 .",
    "thus , in balanced pod , @xmath75 , which equals the first @xmath76 rows of @xmath77 , the @xmath58 given by era . in summary , we have :    [ [ main - result . ] ] * main result . *",
    "+ + + + + + + + + + + + + +    _ the reduced system matrices @xmath56 , @xmath57 and @xmath58 generated in balanced pod and era , respectively by  ( [ reducedabcbpod ] ) and  ( [ reducedabc ] ) , are theoretically identical_.    in practice , these two algorithms may generate slightly different reduced order models , because the hankel matrices calculated in the two algorithms are usually not exactly the same , due to small numerical inaccuracies in adjoint simulations , and/or in matrix multiplications needed to compute the sub - blocks in the hankel matrices . in the following discussions , we compare these two algorithms in more detail .      while era and balanced pod produce theoretically identical reduced - order models , the techniques differ in several important ways , both conceptually and computationally .",
    "neither era nor balanced pod calculate gramians explicitly , but balanced pod does construct approximate controllability and observability matrices  @xmath61 and  @xmath78 , from which one calculates the generalized hankel matrix  @xmath25 and balancing transformation .",
    "balanced pod thus incurs additional computational cost , because one needs to construct the adjoint system ( [ ltiadjoint ] ) , run adjoint simulations for  @xmath62 , and then calculate each block of  @xmath25 by matrix multiplication .",
    "thus we see that the advantages of era include :    1 .",
    "* adjoint - free : * era is a feasible balanced truncation method for experiments , since it needs only the output measurements from the response to an impulsive input . note that era has been successfully applied in several flow control experiments @xcite , as a system - identification technique rather than a balanced - truncation method . in practice ,",
    "input - output sensor responses are often collected by applying a broadband signal to the inputs , and the armarkov method @xcite can then be used to identify the markov parameters , or even directly the generalized hankel matrix , from the input - output data history .",
    "* computational efficiency : * for large problems , typically the most computationally expensive component of computing balanced pod is constructing the generalized hankel matrix  @xmath25 in  ( [ hankelxy ] ) , as this involves computing inner products of all of the ( large ) primal and adjoint snapshots with each other .",
    "era is significantly more efficient at constructing the matrix @xmath25 in  ( [ hankel ] ) , since only the first row and last column of block matrices , i.e. , the @xmath79 markov parameters , need be obtained by matrix multiplication .",
    "all the other @xmath80 block matrices in  @xmath25 are copies of other blocks , and need not be recomputed . for balanced pod , the matrix  @xmath25",
    "is obtained by computing all the @xmath81 matrix multiplications ( inner products ) between corresponding blocks in @xmath78 and @xmath61 in  ( [ hankelxy ] ) .",
    "thus , for example , if @xmath82 , the computing time needed for constructing @xmath25 in era will be about only @xmath83 of that in balanced pod .",
    "see table  [ tab : era_savings ] for a detailed comparison on computational efficiency between balanced pod and era in the example of the flow past an inclined flat plate .    at the same time",
    ", balanced pod also provides its own advantages :    1 .",
    "* sets of bi - orthogonal primal / adjoint modes : * balanced pod provides sets of bi - orthogonal primal / adjoint modes , the columns of @xmath40 and @xmath41 . in comparison , without the adjoint system , era can not provide the primal and adjoint modes . at best ,",
    "the primal modes may be computed , using the first equation in  ( [ modes ] ) , if the matrix @xmath61  ( [ x ] ) is stored ( in addition to the markov parameters ) .",
    "but the adjoint modes can not be computed without solutions of the adjoint system . in this sense , balanced pod incorporates more of the physics of the system ( the two sets of bi - orthogonal modes ) , while era is purely based on input - output data of the system .",
    "the primal / adjoint modes together can be useful for system analysis and controller / observer design purposes in several ways : for instance , in flow control applications , a large - amplitude region from the most observable mode ( the leading adjoint mode ) can be a good location for actuator placement .",
    "also , although balanced pod is a linear method , a nonlinear system can be projected onto these sets of modes to obtain a nonlinear low - dimensional model .",
    "for instance , the transformation @xmath84 , @xmath85 can be employed to reduce a full - dimensional nonlinear model @xmath86 to a low - dimensional system @xmath87 .",
    "finally , if parameters ( such as reynolds number or mach number ) are present in the original equations , balanced pod can retain these parameters in the reduced - order models .",
    "when the values of parameters change , the reduced order model by balanced pod may still be valid and perform well ; see  @xcite for an application to linearized channel flow .",
    "* unstable systems : * balanced pod has been extended to neutrally stable @xcite and unstable systems @xcite . in those cases ,",
    "one first calculates the right / left eigenvectors corresponding to the neutral / unstable eigenvalues of the state - transition matrix @xmath88 , using direct / adjoint simulations . using these eigenvectors ,",
    "the system is projected onto a stable subspace and then balanced truncation is realized for the stable subsystem .",
    "era for unstable systems is still an open problem , if adjoint operators are not available .",
    "however , we note that , once the stable subsystem is obtained , era can still be applied to it and efficiently realize its approximate balanced truncation .    [ [ era - for - systems - with - high - dimensional - outputs . ] ] era for systems with high - dimensional outputs .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the method of output projection proposed in @xcite makes it computationally feasible to realize approximate balanced truncation for systems with high - dimensional outputs  for instance , if one wishes to model the entire state  @xmath89 , say the flow field in the entire computational or experimental domain .",
    "this method involves projecting the outputs onto a small number of pod modes , determined from snapshots of  @xmath9 from the impulse - response dataset .",
    "this method can be directly incorporated into era as follows : first , run impulse response simulations of the original system and collect markov parameters as usual .",
    "then , compute the leading pod modes of the dataset of markov parameters and stack them as columns of a matrix  @xmath90 . left multiply those markov parameters by @xmath91 to project the outputs onto these pod modes . a generalized hankel matrix",
    "is then constructed using these modified markov parameters , and the usual steps of era follow .",
    "we have seen that one of the drawbacks of era is that it does not provide modes that could be used , for instance , for projection of nonlinear dynamics , or to retain parameters in the models .",
    "more precisely , using era , one may still obtain primal modes @xmath92 as in balanced pod ( see  ( [ svdh][modes ] ) ) , as long as the state snapshots are collected and stored in @xmath61 .",
    "but it is not possible to obtain the corresponding adjoint modes @xmath93 necessary for projection , without performing adjoint simulations to gather snapshots for the matrix  @xmath62 .",
    "this is a severe drawback , as adjoint solutions can be expensive to perform , and are not available for experimental data .",
    "one idea , proposed in  @xcite , is to define a set of approximate adjoint modes using the moore - penrose pseudo - inverse of @xmath94 : @xmath95 we will call the adjoint modes as defined above the _ pseudo - adjoint modes _ corresponding to the modes  @xmath94 .",
    "the system matrices of a @xmath35-dimensional reduced - order model ( @xmath96 ) generated by this approach then read @xmath97 where @xmath40 and @xmath98 are respectively the first @xmath99 sub - blocks of @xmath100 .",
    "while this idea does produce a set of modes that can be used for projection , we show in this section that , unfortunately , the resulting transformation is _ not _ a balancing transformation , and does not produce models that are an approximation to balanced truncation .",
    "in fact , the resulting models are closer to those produced by the the standard pod / galerkin method : as with standard pod / galerkin , the method performs well as long as the most controllable and most observable directions coincide .",
    "however , when these directions differ ( as is the case for many problems of interest , including the example in section  [ sec : numerical ] ) , the method performs poorly . these systems",
    "in which controllable and observable directions do not coincide are precisely the systems for which balanced pod and era give the most improvement over the more traditional pod / galerkin approach .",
    "first , let us recall in what sense the model - reduction procedures described in section  [ sec : era ] are approximations to balanced truncation .",
    "suppose that we have an approximation of the controllability and observability gramians , factored as @xmath101 where @xmath61 and @xmath62 are the matrices of snapshots from  ( [ x ] ) and  ( [ y ] ) .",
    "in balanced pod , we define the primal modes as columns of @xmath102 , and the adjoint modes as columns of @xmath103 , where @xmath104 , @xmath105 , and @xmath106 are defined in  ( [ svdh ] ) .",
    "we will assume in this section that the number of columns of @xmath61 and @xmath62 ( the number of snapshots , @xmath107 and  @xmath108 , respectively ) is smaller than the number of rows ( the state dimension , @xmath109 ) , which is always true for the large fluids systems of interest here .",
    "then balanced pod is an approximation to balanced truncation in the following sense : as shown in the appendix of  @xcite ( the proof of proposition 2 ) , we may construct a full ( invertible , @xmath44 ) transformation @xmath110 by choosing @xmath111 such that @xmath112 .",
    "that is , columns of @xmath111 are orthogonal to the adjoint modes , which are columns of  @xmath93 .",
    "the inverse transformation then has the form @xmath113 where @xmath93 is the matrix of adjoint modes , and @xmath114 is defined by  ( [ eq : tinv_def ] ) .",
    "then , proposition  2 of  @xcite states that the transformed approximate gramians ( [ eq : approximate_grams ] ) have the form @xmath115 and furthermore the product of the approximate gramians , in the transformed coordinates , is @xmath116 in this sense , the transformation  @xmath117 balances the approximate gramians as closely as possible : the gramians are block diagonal , and the upper - left blocks are equal and diagonal .",
    "furthermore , all of the states in the lower - right block ( i.e. , involving @xmath118 and  @xmath119 above ) are either unobservable or uncontrollable , as they do not appear in the product of the gramians .    however ,",
    "if the pseudo - adjoint modes @xmath120 are used in place of the true adjoint modes @xmath93 , then this result does not hold , as we now show .",
    "note that , in order for the first block of rows of @xmath121 to equal @xmath122 , we must now define @xmath123 where @xmath124 .",
    "since the range of @xmath120 equals the range of  @xmath94 , this is then equivalent to choosing @xmath125 such that its columns are orthogonal to the columns of @xmath94 ( the _ primal _ modes ) , while when the `` true '' adjoint modes are used , columns of @xmath111 are chosen to be orthogonal to the _ adjoint _ modes  @xmath93 .    defining @xmath126 by @xmath127 one",
    "can then show that , as long as @xmath128 , then the situation is worse , and the transformed controllability gramian is not block diagonal , nor does its upper - left block equal @xmath106 . ] , the transformed gramians have the form @xmath129 with @xmath130 where @xmath131 are the true adjoint modes . note that , when the true adjoint modes are used to define the inverse  ( [ eq : tinv_def ] ) , then @xmath132 , since @xmath112 .",
    "however , when pseudo - adjoint modes are used , then @xmath133 is no longer zero , and in fact , can be quite large .",
    "[eq : xform2 ] ) ) and ( b ) using pseudo - adjoint modes ( eq .  ( [ eq : xform_pseudo ] ) ) . here , @xmath61 and @xmath62 in  ( [ eq : approximate_grams ] ) are random matrices with @xmath134 states and @xmath135 snapshots . ]",
    "an example is shown in figure  [ fig : random_xform ] , which shows the magnitude of the elements of the transformed gramians , where @xmath61 and  @xmath62 in  ( [ eq : approximate_grams ] ) are chosen at random .",
    "note that when true adjoint modes are used , the transformed gramians are equal and diagonal , while when the pseudo - adjoint modes are used , the off - diagonal blocks of the transformed observability gramian , and the product of the gramians , have significant magnitude .",
    "thus , when pseudo - adjoint modes are used , the resulting transformation is not , in general , a balancing transformation : even though the upper - left blocks of the transformed gramians are still equal and diagonal , the transformed observability gramian is not block diagonal , and so its eigenvalues and eigenvectors do not correspond to those of the transformed controllability gramian .",
    "note that this is the whole point of balanced truncation : to transform to coordinates in which the most controllable directions ( dominant eigenvectors of  @xmath136 ) correspond to the most observable directions ( dominant eigenvectors of  @xmath137 ) .",
    "therefore , while the approximate balanced truncation procedure described in section  [ subsec : bpod ] exactly balances the approximate gramians , transforming by pseudo - adjoint modes does not represent balancing in any meaningful sense .",
    "note that the matrix @xmath133 describes the degree to which projection using pseudo - adjoint modes fails to balance the approximate gramians .",
    "this matrix equals zero if the adjoint modes ( columns of  @xmath93 ) are spanned by the primal modes ( columns of  @xmath94 ) .",
    "however , @xmath133 is the largest when the dominant adjoint modes ( columns of @xmath93 ) are nearly orthogonal to the dominant primal modes ( columns of @xmath94 ) .",
    "unfortunately , this is the case in many problems of interest , in particular those involving non - normality : the directions spanned by the primal modes often do not coincide with the directions spanned by the adjoint modes .    in the next section",
    ", we apply this approach to the flow past a flat plate , and compare it to the methods described in section  [ sec : era ] .",
    "in this section , we illustrate the application of era as an approximate balanced truncation method using a numerical example , by obtaining reduced - order models of a large - dimensional fluid system .",
    "we compare the resulting models with those obtained using the balanced pod method of  @xcite , era with pseudo - adjoint modes as described in section  [ sec : erapseudomodes ] , and the standard pod / galerkin method  @xcite .",
    "the model problem that we consider is a two - dimensional uniform flow over a flat plate inclined at an angle @xmath138 , at a low reynolds number  @xmath139 . at these conditions , the flow asymptotically reaches a stable steady state ,",
    "the streamlines of which are plotted in figure  [ figure : flowplate ] .",
    "the numerical method used for all computations is a fast formulation of the immersed boundary method developed by  @xcite , and solves for the vorticity field at each time step .",
    "we treat farfield boundary conditions using the multiple - grid scheme described in  @xcite ( section  4 ) with five nested grids , each with @xmath140 points .",
    "the finest grid covers the region  @xmath141\\times[-2.5,2.5]$ ] , and the largest grid covers the region  @xmath142\\times[-40,40]$ ] , where lengths are non - dimensionalized by the chord of the flat plate , whose center is located at the origin . the time step used for all simulations is  @xmath143 ( nondimensionalized by chord and freestream velocity ) .",
    "the numerical model is the same as that considered in  @xcite where balanced pod is applied for feedback controller design to stabilize an _ unstable _ steady state corresponding to a high angle of attack .",
    "however , here we consider the case of a _",
    "stable _ steady state ( with an angle of attack at @xmath144 ) , for comparison of reduced order models .",
    "( left ) , and the contour - lines of the vorticity field obtained from an impulsive input to the actuator  ( right ) . , title=\"fig:\",height=124 ]  ( left ) , and the contour - lines of the vorticity field obtained from an impulsive input to the actuator  ( right ) . ,",
    "title=\"fig:\",height=124 ]      the governing equations are first linearized about the stable steady state , resulting in a high - dimensional model in the form of equation  ( [ lti ] ) , where the state  @xmath89 consists of the discrete vorticity field at the grid points .",
    "see  @xcite for the details of the linearized ( and adjoint ) equations and their numerical formulations .",
    "the system input @xmath8 is a disturbance ( or actuator ) shown in figure  [ figure : flowplate ] , modeled as a localized body force in the vicinity of the leading edge .",
    "we consider the output to be the entire velocity field : this is important for capturing the flow physics , and is often needed to represent cost functions used in optimal control design . since the output is very high - dimensional , in era and balanced pod reduction procedures we use output projection described at the end of section  [ sec : era ] , projecting the velocity field onto the leading pod modes of the velocity snapshots obtained from the impulse response simulation .",
    "era is applied to the full - dimensional linearized system to construct a reduced - order model . with a sampling period of 50 time steps ,",
    "400 adjacent pairs of markov parameters , as in  ( [ snapshots ] ) , are collected from an impulse response simulation .",
    "since these parameters are a projection of the velocity fields onto the leading pod modes , for an output projection of order  @xmath145 , the number of inner products required is  @xmath146 for construction of each  @xmath25 and  @xmath63 ( see section  [ subsec : comparison ] ) .    for comparison , balanced pod",
    "is also used to compute the same reduced - order models .",
    "adjoint simulations are performed with the pod modes as initial conditions to compute the matrix  @xmath62 of  ( [ y ] ) .",
    "the matrices  @xmath61 and  @xmath62 are assembled by stacking 200 snapshots from the linearized and each of the adjoint simulations , and in turn , the generalized hankel matrix  @xmath147 is computed . for an output projection of order  @xmath145 ,",
    "the number of inner products required to compute @xmath25 is  @xmath148 , which is 50  times more than that to compute @xmath25 and @xmath63 in total for era .",
    "we also compare reduced - order models using standard pod modes , and era with pseudo - adjoint modes , as described in section  [ sec : erapseudomodes ] .",
    "the first 100 primal modes are used to compute the pseudo - adjoint modes ..    for the given case , a comparison between the computational cost using era and using balanced pod is shown in table  [ tab : era_savings ] .",
    "results verify that era substantially improves computational efficiency in forming reduced - order models .",
    ".comparison of the computational times required for various steps of the algorithms using balanced pod and era .",
    "the times are given for a 10-mode output projected system .",
    "the hankel matrix is constructed using ( a ) 200 state - snapshots from each linearized and adjoint simulations for balanced pod , and ( b ) 400 markov parameters  ( outputs ) for era . [",
    "cols=\"<,^,^ \" , ]     next , we compare the reduced - order models .",
    "figure  [ figure : modes ] shows the leading two primal modes and true adjoint modes from balanced pod , compared with the leading two pseudo - adjoint modes .",
    "the pseudo - adjoint modes look quite different from the true adjoint modes , and the flow structures actually more closely resemble the leading _ primal _ modes .",
    "this result is not surprising , since the pseudo - adjoint modes are always linear combinations of the snapshots from the primal simulations , while the true adjoint modes are linear combinations of snapshots from adjoint simulations .",
    "following the discussion in the last section , the poor approximation of the adjoint modes suggests that the pseudo - adjoint modes may produce poor reduced order models for this example , as we will verify below .    ) and the first 100 primal modes .",
    "modes are illustrated using contour plots of the vorticity field . ]    ) and the diagonal elements of the controllability ( @xmath149 , @xmath150 ) and observability ( @xmath151 , @xmath152 ) gramians with different order of modes ( e.g. , 4 , 10 , 20 ) in output projection . , title=\"fig:\",width=240 ] ) and the diagonal elements of the controllability ( @xmath149 , @xmath150 ) and observability ( @xmath151 , @xmath152 ) gramians with different order of modes ( e.g. , 4 , 10 , 20 ) in output projection .",
    ", title=\"fig:\",width=240 ] + ) and the diagonal elements of the controllability ( @xmath149 , @xmath150 ) and observability ( @xmath151 , @xmath152 ) gramians with different order of modes ( e.g. , 4 , 10 , 20 ) in output projection .",
    ", title=\"fig:\",width=240 ]    figure  [ figure : gramians ] shows the diagonal values of the controllability and observability gramians , as well as the empirical hankel singular values , for reduced - order models obtained from three different methods : era , balanced pod , and era with pseudo - adjoint modes .",
    "the models obtained using era are more accurate in the sense that the three sets of curves are almost indistinguishable , for all orders of output - projection . however ,",
    "for balanced pod , the diagonal values of the observability gramians are accurate only for certain leading modes , the number of which depends on and increases with the order of output projection .",
    "this inaccuracy can be attributed to a slight inaccuracy in the adjoint formulation , which in turn results from an approximation in the multi - domain approach used to treat farfield boundary conditions in the immersed boundary method of  @xcite ; see  @xcite for more details .",
    "thus , era is advantageous as it does not need any adjoint simulations and results in more balanced gramians .",
    "on the other hand , era with pseudo - adjoint modes generates poorly balanced controllability and observability gramians , as shown in figure  [ figure : gramians](c ) .",
    "this is because the leading primal modes and adjoint modes are supported very differently in the spatial domain , and thus the pseudo - adjoint modes , based on linear combination of leading primal modes , poorly approximate the true adjoint modes .",
    "we can quantify the performance of the various reduced - order models by computing error norms .",
    "one such measure is the @xmath153-norm of the error between the impulse response of the full linearized system , denoted  @xmath154 , and that of a reduced order model with @xmath35  modes , denoted by  @xmath155 .",
    "we first compute the @xmath153-norm of the error between the full system ( with the entire velocity field as output ) and the output - projected system of order  20 , shown as the horizontal dashed line in figure  [ figure : error2norm ] .",
    "this is the lower error bound for any reduced order model of the given output - projected system .",
    "results shown in figure  [ figure : error2norm ] indicate that the first several low - order models obtained by era and balanced pod generate slightly different @xmath153-norms of error , presumably because of the slight inaccuracy in the adjoint , mentioned previously . for most orders , however ,",
    "they agree , and both error norms converge to the lower bound as the order of the model increases . by running more simulation tests , we observe that with higher - order output projections , era and balanced pod error norms converge to each other faster when the order of model increases .",
    "figure  [ figure : error2norm ] also shows the 2-norm error plots for models by era with pseudo - adjoint modes , using 20-mode output projection , and for models computed using standard pod .",
    "errors of models by era with pseudo - adjoint modes converge to the lower bound much slower than era / balanced pod .",
    "errors of models by pod do not start converging until more than nearly 20 modes are used , and they converge to a larger error bound than era / balanced pod , again because pod models do not capture the input - output dynamics as well as balanced truncation based models .",
    "norm of the error with increasing order of the reduced - order models : exact output of the output - projected system  ( @xmath149 ) ; models obtained using balanced pod  ( @xmath149 ,  @xmath156 ) , era(@xmath157 ,  @xmath152 ) , era with pseudo - adjoint modes(@xmath157 ,  @xmath158 ) , and pod(@xmath157,@xmath159 ) .",
    "a 20-mode output projection is used in era , balanced pod , and era with pseudo - adjoint modes . ]    in the time domain , a comparison of the transient response to an impulsive disturbance is shown in figure  [ figure : output ] , in which the first output of the reduced - order model is plotted , for a 16-mode model determined by era , and for 30-mode models by pod and era with pseudo - adjoint modes .",
    "the 16-mode era model already accurately predicts the response for all times .",
    "the higher - dimensional , 30-mode models using pod and pseudo - adjoint modes are both stable , and perform reasonably well ; however , they over - predict the response , particularly after time @xmath160 .    , from the impulse - response simulation : results of full - simulation ( @xmath157 ,  @xmath150 ) , compared with those of @xmath161-mode reduced order model by era(@xmath149 ,  @xmath152 ) , @xmath162-mode model by era with pseudo - adjoint modes(@xmath151 ,  @xmath158 ) , and @xmath162-mode model by pod(@xmath149,@xmath159 ) .",
    "a @xmath163-mode output projection is used in era and era with pseudo - adjoint modes . ]",
    "we also compare the frequency response of reduced - order models to that of the full system , or more precisely , the full output - projected system .",
    "one way to represent the response of a single - input multiple - output system is by a singular - value plot , a plot of the maximum singular value of the transfer function matrix as a function of frequency . to generate this plot ,",
    "a very long simulation of  @xmath164  time steps for the full system is performed , with a random input sampled from a uniform distribution in the range  @xmath165 .",
    "the output snapshots are projected onto leading pod modes .",
    "the magnitude of the transfer function is then computed from the cross spectrum of the input and outputs ( using the matlab command ` tfestimate ` ) .",
    "finally , singular - value plots for the full output - projected systems are obtained , with a typical case shown as the red line in figure  [ figure : sigmaplot ] .    a typical set of singular - value plots of different reduced order models",
    "are presented in figure  [ figure : sigmaplot ] .",
    "results shown in the figure indicate that era and balanced pod @xmath162-mode models , are almost identical , and are close to the corresponding full output - projected system . in comparison ,",
    "figure  [ figure : sigmaplot ] also shows sigma plots for @xmath162-mode models by era with pseudo - adjoint modes and by pod .",
    "note that for computational feasibility , here the output of the pod model is the first twenty reduced states , i.e. , the full - dimensional output of the pod model are projected onto the leading twenty pod modes .",
    "the frequency responses of the models by pod and era with pseudo - adjoint modes capture the resonant peak , but do not match well for frequencies far away from the resonant peak .",
    "these two models both generate spurious peaks in the frequency range of @xmath166 $ ] .    ) and 30-mode models obtained using balanced pod  ( @xmath167 ) , era  ( @xmath157 ) , era with pseudo - adjoint modes(@xmath149 ) , and pod(@xmath151 ) , all with a 20-mode output projection . era and balanced pod models generate almost identical plots . ]",
    "we report that , theoretically , the eigensystem realization algorithm ( era ) and snapshot - based approximate balanced truncation ( balanced pod ) produce exactly the same reduced order models .",
    "this equivalence implies that era balances a pair of approximate gramians and thus can be regarded as an approximate balanced truncation method .",
    "compared to balanced pod , the main features of era are that it does not require data from adjoint systems and therefore can be used with experimental data ; furthermore , its construction of the generalized hankel matrix is computationally an order - of - magnitude cheaper than balanced pod .",
    "numerical results indicate that era can be more accurate than balanced pod in practice , since there can be slight inaccuracies in the adjoint operator used with balanced pod . balanced pod does have its own advantages , however : unlike era , it produces sets of bi - orthogonal modes that are useful for other purposes .",
    "nonlinear models may be obtained by projection onto these modes ; and parameters such as reynolds number can be retained in the reduced - order models generated using these modes .",
    "balanced pod has also been generalized for unstable systems .",
    "we also examine a modified era approach in which one constructs sets of bi - orthogonal modes without using adjoint information , using a matrix pseudo - inverse , as in  @xcite .",
    "although this approach provides sets of bi - orthogonal modes ( primal / pseudo - adjoint modes ) , in general it can not be regarded as an approximate balanced truncation method , since it does not balance the approximate gramians .",
    "we have demonstrated the methods on an model problem consisting of a disturbance interacting with the flow past an inclined flat plate . as expected , balanced pod models perform nearly identically to era models .",
    "the small differences result because the adjoint simulation required for balanced pod is not a perfect adjoint at the discrete level .",
    "both procedures work significantly better than standard pod models , or era models using pseudo - adjoint modes for projection .",
    "finally , we emphasize that throughout , we have considered only stable , linear models .",
    "possible future directions of this work include a generalization to unstable systems , and ultimately to nonlinear systems .",
    "the authors gratefully acknowledge the support by u. s. air force office of scientific research grants fa9550 - 05 - 1 - 0369 and fa9550 - 07 - 1 - 0127 .",
    "the authors thank kunihiko taira for help with the numerical solver .",
    "kervik , e. , hpffner , j. , ehrenstein , u. , henningson , d.s . : optimal growth , model reduction and control in a separated boundary - layer flow using global eigenmodes",
    ". j. fluid mech . * 579 * , 305314 ( 2007 )                    djouadi , s.m . ,",
    "camphouse , r.c . ,",
    "myatt , j.h . : empirical reduced - order modeling for boundary feedback flow control .",
    "journal of control science and engineering * 2008 * , article i d 154956 , 11 pages . doi:10.1155/2008/154956 ."
  ],
  "abstract_text": [
    "<S> as sensors and flow control actuators become smaller , cheaper , and more pervasive , the use of feedback control to manipulate the details of fluid flows becomes increasingly attractive . </S>",
    "<S> one of the challenges is to develop mathematical models that describe the fluid physics relevant to the task at hand , while neglecting irrelevant details of the flow in order to remain computationally tractable . </S>",
    "<S> a number of techniques are presently used to develop such reduced - order models , such as proper orthogonal decomposition ( pod ) , and approximate snapshot - based balanced truncation , also known as balanced pod . </S>",
    "<S> each method has its strengths and weaknesses : for instance , pod models can behave unpredictably and perform poorly , but they can be computed directly from experimental data ; approximate balanced truncation often produces vastly superior models to pod , but requires data from adjoint simulations , and thus can not be applied to experimental data .    in this paper </S>",
    "<S> , we show that using the eigensystem realization algorithm ( era ) @xcite , one can theoretically obtain exactly the same reduced order models as by balanced pod . </S>",
    "<S> moreover , the models can be obtained directly from experimental data , without the use of adjoint information . </S>",
    "<S> the algorithm can also substantially improve computational efficiency when forming reduced - order models from simulation data . </S>",
    "<S> if adjoint information is available , then balanced pod has some advantages over era : for instance , it produces modes that are useful for multiple purposes , and the method has been generalized to unstable systems . </S>",
    "<S> we also present a modified era procedure that produces modes without adjoint information , but for this procedure , the resulting models are not balanced , and do not perform as well in examples . </S>",
    "<S> we present a detailed comparison of the methods , and illustrate them on an example of the flow past an inclined flat plate at a low reynolds number . </S>"
  ]
}