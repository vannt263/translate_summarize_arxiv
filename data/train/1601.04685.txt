{
  "article_text": [
    "pain is a common health problem that causes over $ 60 billion a year in productivity losses in the united states @xcite .",
    "research on pain sensing ( also known as nociception ) with human subjects is difficult for a number of reasons including ethical constraints , difficulties in quantifying a psychophysical response , and subjectivity in self - reporting @xcite .",
    "since the molecular mechanisms of pain transduction are believed to be partially conserved among many different species @xcite , some of these problems are solved by using animal models in nociception research .",
    "however , animal subjects can not communicate their perceived pain levels to us in an obvious fashion .",
    "thus progress in using animal models depends crucially on our ability to quantitatively and objectively infer the perceived level of noxious stimuli from animal behavior .",
    "historically , studies of pain primarily used mammalian models @xcite . for rodents , the tail flick test @xcite , the hot - plate test @xcite and the hargreaves method @xcite correlate pain perception with the reaction latency of different body parts to noxious stimuli . for larger animals such as canines @xcite and primates @xcite , similar nociceptive assays have also been developed . in recent years",
    ", new approaches started incorporating facial expressions in nociception quantification @xcite .",
    "although these mammalian models are extensively studied , several drawbacks hinder their use .",
    "first , ethical issues and risks arise for certain experiments .",
    "second , compared to lower - level organisms , mammalian subjects require more time and resources to maintain .",
    "therefore , much effort has been devoted to investigations of the possibility of using invertebrate models in nociception research @xcite . in experiments involving @xmath0 larva ,",
    "measures such as the response percentage of the total population @xcite and the time to response @xcite have been used to investigate changes in the ability of the animals to sense noxious stimuli . in experiments on _ caenorhabditis elegans _ , behavioral features such as the turning rate @xcite and the percentage of escape response @xcite have been used to characterize nociception .",
    "all of these models share some common problems .",
    "first , the nociceptive assays focus on one particular coarse behavioral feature of the subject , such as avoidance behavior , orientation , or turning rate .",
    "such features are selected in an ad hoc fashion , subject to a particular design of an experiment .",
    "this makes it difficult to compare results across different labs and experiments .",
    "further , the behavior may be providing additional information about the perceived pain that is not being captured by the coarse measures .",
    "second , some assays report measurements as a percentage of a population , so that these measurements can not be made for individuals . to overcome these problems ,",
    "an ideal assay would infer a perceived pain level of an individual animal on a continuous scale , using comprehensive , objective measurements of its behavioral profile .",
    "an even more important problem is that one would like to use the assays to calibrate the perceived pain level , and maybe even reductions in such levels due to effects of analgesic drugs , or mutations in the nociceptive pathways . at the same time ,",
    "drugs or mutations can affect the motor response , rather than the nociception per se .",
    "thus traditional pain assays mentioned above may convolve the perceived pain reduction , if any , with behavioral changes .",
    "for example , a mutant defective for turning behavior will register a strong reduction in the turning rate , but it would be a mistake to interprete this as a reduction in the pain perception .",
    "such concerns are very real , as is illustrated by a known fact that opiods can cause large behavioral changes , and thus they have effects beyond analgesic ones @xcite . to attribute a behavioral response difference to reduced nociception and not to motor changes , the response must be stereotyped and reflexive , which is often the case @xcite .",
    "further , only the response amplitude or frequency , but not the detailed temporal structure , should change in response to a drug or a mutation . establishing the stability of the stereotypic response pattern",
    "requires analysis of the _ entire response behavior _ , rather than of its few selected features , as is done by most behavioral assays .    in this work ,",
    "we address these issues in the context of the nematode _ c.  elegans _ , developing it further as an animal model system for nociception research .",
    "the worm is a great model organism for such studies for a number of reasons .",
    "first , the behavioral dynamics of freely moving _ c.  elegans _ is intrinsically low dimensional @xcite .",
    "this makes quantification of its behavioral response relatively straightforward , providing an opportunity to use the entire motile behavior as a basis for assays .",
    "second , the worms show a noxious response to a wide range of sensations including certain types of chemical @xcite , mechanical @xcite , and thermal @xcite stimuli , and such nociceptive response is different from and is transduced independently of the related taxis behaviors @xcite .",
    "third , at the molecular level , many details of thermal nociception in the worm may be similar to vertebrate animals @xcite .",
    "fourth , there are powerful genetic and optical tools to reveal mechanisms of nociception in _ c.  elegans_. finally , the low cost , small size , and absence of ethical constraints make the animal amenable to large scale pharmacological screens for new analgesics @xcite .",
    "we present combined experimental and modeling studies that show that the entire temporal behavioral profile during the thermal nociceptive response in _ c.  elegans _ is highly stereotypical , with the frequency of the escape response and the amplitude of the escape velocity profile scaling with the stimulus level . by verifying the ability of the behavioral template to capture the response following a nociceptive stimulus",
    ", the model we develop distinguishes changes in nociception from changes to the motor program . when a change is attributed to nociception",
    ", the model can infer the reduction in the perceived thermal nociception level following pharmacological or genetic treatments from the behavior of an individual worm .",
    "this quantification requires only a handful of worms ( about 60 ) to show statistically significant nociception reduction for a common analgesic , and its statistical power quickly improves with an increasing number of subjects .",
    "the paper is organized as follows .",
    "first we discuss the structure of the dataset and the model .",
    "then we evaluate the performance of the model and discuss the stereotypical behavior we discovered .",
    "further , we use the model to infer the nociceptive stimulus level of worms in three different conditions : wild - type untreated , wild - type treated with ibuprofen , and a mutant with defects in thermal nociception .",
    "we argue that , while effects of the ibuprofen treatment can be attributed largely to a reduced nociception , the mutant s response shows changes to the behavior beyond nociceptive effects .",
    "finally , we use the statistical model to discuss how the nociception experiments should be designed to achieve the highest statistical power to quantify analgesic effects .",
    "we aim to infer the perceived worm nociception level from the temporal dynamics of the worm response .",
    "the noxious signal is administered by thermal stimulation using an infrared laser while the worm crawls on an agar plate . the worm motion is captured by video microscopy and analyzed using custom image analysis software .",
    "the worm postures are very stereotypical , adding up to simple sinusoidal motions forwards or backwards , and to turns @xcite .",
    "thus without much loss to the statistical power , we characterize the entire nociceptive behavior of the animal by a time series of its center of mass velocity ( see _ materials and methods _ ) . our task is then to verify if such responses are stereotypical , scaling in frequency and amplitude with the applied laser current .",
    "if they are stereotypical and thus can be used to characterize the perceived nociception , the next task is to infer the applied laser current from the velocity data .    for each noxious stimulus trial",
    "a random worm is selected on the plate and its motion is sampled at 60 hz for 15 s. an infrared laser pulse with a randomly chosen current between 0 to 200 ma and a duration of 0.1 s is then directed to the head of the worm 1 s after the start of the video recording .",
    "the worm s center of mass motion in a typical trial consists of a forward motion before the stimulus , a stop and/or backwards motion after the stimulus , then followed by an `` omega '' turn , after which the worm emerges with a forward motion in a different direction , cf .",
    "[ fig : cm_velocity ] .",
    "this is a typical response to many noxious stimuli in _ c.  elegans _ , and not just to thermal noxious stimulus @xcite",
    ". such nociceptive response , at least at large stimuli levels , is different from the more commonly studied thermotactic behavior , and is mediated by different neural and genetic pathways @xcite .",
    "s. the paused state is characterized by the near zero velocity after the laser stimulus .",
    "( b ) actual trajectories of these two worms .",
    "worm changes its direction of motion in two ways : in a `` reversal '' , it stops and backtracks along its previous path ; in an `` omega '' turn the worm s head curls back and crosses the tail , setting then a new direction of forward motion .",
    "[ fig : cm_velocity ] ]    to understand the effects of pharmacological and genetic interventions on nociception transduction , we collected three distinct datasets . in the first , the stimulus was applied to wild - type worms ( n2 ) . in the second ,",
    "the wild - type worms were pre - treated with an ibuprofen solution ( see _ materials and methods _ ) . in the third",
    ", we applied the stimulus to an untreated triple mutant ( ocr-2(ak47 ) osm-9(ky10 ) iv ; ocr-1(ak46 ) ) .",
    "hereafter we refer to these datasets as `` control '' , `` ibuprofen '' , and `` mutant '' , respectively .",
    "we collectively refer to ibuprofen and mutant worms as `` treated '' worms . forward",
    "motion in all three data sets was similar ( typical forward velocity of @xmath1 , @xmath2 , @xmath3 pixel / s respectively , where the error denoted the standard deviation of the velocity distribution ) , so that there are no drastic defects in motility .",
    "s.  e.  m. ) of the maximum reverse speed for the three worm types is plotted against the stimulus laser current , partitioned into five bins .",
    "negative values correspond to backward motion .",
    "( b ) maximum reverse speeds for individual control worms .",
    "we define an active worm ( dot ) as having the maximum reverse speed of over 10 pixels / s ( about 0.2 body length per second ) ; otherwise the worm is paused ( plus sign ) .",
    "( c ) probability of the paused state vs.  the laser current .",
    "dots represent the actual data ( @xmath4 s.  e.  m. ) , and lines are the fitted model .",
    "the datasets are divided into equally sampled bins for each worm type .",
    "[ fig : p and a state demo ] ]    we bin the laser current of the nociceptive stimulus into five distinct levels ( bins ) , defined to have an equal number of control worms in each bin ( 40 per bin ) .",
    "the maximum reverse escape velocity is indistinguishable among all three worm types for the largest stimulus level , indicating again no gross defects to motility or noxious response . at the same time , the velocity at smaller stimuli levels shows substantial differences ( @xmath5 scores of up to 3.8 ) between the control and the treated worms , especially in the vicinity of @xmath6 ma laser stimulation , see fig .",
    "[ fig : p and a state demo](a ) .",
    "mutant worms are especially different from the control over a wider stimulus range . however , as discussed above , it is unclear if such simple observed behavioral differences are indicative of the reduction of the perceived nociception level or of other changes to the motor response .    to address this , instead of subjectively segmenting the complex escape behavior or choosing _ ad hoc _ metrics of the worm s movement , we choose to infer the applied stimulus strength from a comprehensive model of the entire worm s response velocity profile",
    "due to the considerable randomness and individual variability of responses , we choose to model them probabilistically .",
    "thus we are interested in estimating @xmath7 , the probability distribution of the applied laser current @xmath8 conditional on the observed velocity of the escape response @xmath9 . using bayes theorem ,",
    "we write @xmath10 where @xmath5 is the normalization factor , and @xmath11 is the prior distribution of stimuli . when we characterize the velocity profiles of the noxious response of _ c.  elegans _ , we notice that the worm can react to the stimulus in two different ways .",
    "some worms pause after the thermal stimulus , even at large laser currents ( see fig .  [",
    "fig : p and a state demo ] ( b ) ) .",
    "these worms remains largely immobile for a few seconds , sometimes as long as the recording duration .",
    "other worms actively reverse and follow the classic escape behavior as shown in fig .",
    "[ fig : cm_velocity ] . we choose to separate the active vs.  the paused worms with a cutoff of 10 pixels / s , where 50 pixels is about one body length of the worm . to account for this heterogeneity in the behavior",
    ", we introduce the state variable @xmath12 , which can take one of two values , @xmath13 or @xmath14 , for each individual worm .",
    "then @xmath15    we model the probability of the paused state @xmath16 by a sigmoid function , cf .",
    "[ fig : p and a state demo](c ) , @xmath17 where @xmath18 is the _ pause current _ threshold .",
    "then the probability of the active state is @xmath19 we infer @xmath18 from data by maximizing @xmath20 , where @xmath21 is the number of trials with worms of the analyzed type , and @xmath22 is the actual laser current for a particular trial .",
    "note that each of the three data sets has its own pause current ( @xmath23 , @xmath24 , and @xmath25 ma for the control , ibuprofen , and mutant worms , respectively ) . changes in this threshold , like that for the mutant , will result in different numbers of worms responding to the same stimulus , which can be consistent with the changes in the nociception level , depending on whether the response profiles themselves stay stable .",
    "this is what we investigate next .",
    "parenthetically , we note that the fraction of active worms is essentially the same as the percentage of the escape response , which has been used previously to quantify worm nociception @xcite . here",
    "we go further and additionally analyze the behavioral profiles of the responding worms .    _",
    "c.  elegans _ locomotion consists of a series of stereotyped postures and behavioral states @xcite .",
    "further , in other animals , nociceptive responses are stereotyped as well @xcite .",
    "therefore , it is natural to explore if the nociceptive response of _ c.  elegans _ is also stereotyped , separately for the paused and the active states . for paused worms , the escape velocity is small and independent of the laser current , and we model it as a multivariate normal variable , @xmath26,\\ ] ] where @xmath27 is the mean velocity profile of the paused worms measured from data , which we call the _ paused template _ velocity .",
    "@xmath28 is the empirical covariance of the paused velocity , and @xmath29 is the total number of effectively independent time points in the velocity profile time series , determined using the autocorrelation structure of the profile ( see _ materials and methods _ ) .",
    "we expect that , in the active state , the worm escape is laser current dependent . specifically , we seek to represent it by a current - dependent rescaling of a stereotypical escape velocity , @xmath30 , where @xmath31 is the scaling function , and @xmath32 is the _ active template _ velocity . since various features of the worm escapes ( the maximum reverse speed , the maximum reverse acceleration , and the time to the omega turn ) , scale non - linearly and saturate with the laser current ( cf .",
    "[ fig : p and a state demo](a ) ) , the rescaling , @xmath33 , must be sigmoidal .",
    "further , some worms have nonzero velocities even at zero laser current , so that @xmath34 may be nonzero .",
    "finally , the overall scale of the template can be absorbed in the definition of @xmath32 .",
    "the simplest scaling function obeying these constraints has only two parameters @xmath35 where @xmath36 and @xmath37 are again constants , different for the three different worm types . with this , we write the probability of a velocity profile given the laser current @xmath8 for the worm in an active state as a multivariate normal distribution @xmath38 , \\label{pva}\\ ] ] where @xmath39 is the covariance of the average velocity profile .",
    "we find the constants @xmath36 and @xmath37 , @xmath32 and @xmath39 by maximizing the likelihood of the observed data ( see _ materials and methods _ ) .    in summary ,",
    "the probability of a velocity profile given the laser current in a certain trial is @xmath40\\right\\}\\\\    + \\left\\{\\frac{(i/{{\\mathcal i}}_0)^{2}}{1+(i/{{\\mathcal i}}_0)^{2}}\\times\\frac{1}{(2\\pi)^{\\frac{t}{2}}|\\sigma_{a}|^{\\frac{1}{2 } } }    \\exp\\left[-\\frac{1}{2}({{\\bf v}}-f_{{{\\mathcal i}}_1,{{\\mathcal i}}_{2}}(i){{\\bf u}}_{a})^{t}\\sigma_{a}^{-1}({{\\bf v}}-f_{{{\\mathcal i}}_1,{{\\mathcal i}}_{2}}(i){{\\bf u}}_{a})\\right]\\right\\}. \\label{eq : fullmodel}\\end{gathered}\\ ] ] the overall model of the experiment , eq .",
    "( [ eq : bayes ] ) , also includes @xmath11 . to a large extent , this is controlled by the experimentalist , and details are described in _ materials and methods_.      the model we built assumes a stereotypical nociceptive response .",
    "is this assumption justified ?",
    "velocities in the paused state are very small ( worms barely move ) .",
    "thus whether the stereotypy assumption provides a good model of the data is determined largely by the stereotypy of the active worms .",
    "if the active stereotypical response template exists , then it should be possible to collapse the average velocity profiles onto a single curve by the following transformation @xmath41 figure  [ fig : collapse ] confirms this : the means of different bins collapse relatively compactly , providing evidence for the existence of the stereotypy in active nociceptive responses .",
    "we illustrate the template velocities and the non - linear scaling function @xmath31 inferred from the control , ibuprofen , and mutant in fig .",
    "[ fig : the - normalized - active ] .     worms each , based on the stimulus current .",
    "( b ) the mean and standard deviation of velocities in the same time period rescaled by @xmath42 .",
    "rescaled mean velocities nearly collapse .",
    "note that the parameters @xmath36 and @xmath43 are optimized as in _ materials and methods _ to collapse individual profiles , and not the five mean profiles illustrated here .",
    "[ fig : collapse ] ]     s corresponds to the moment of the stimulus application .",
    "( b ) normalized active template velocity .",
    "each template velocity is normalized by the absolute value of its minimum @xmath44 .",
    "the error bars represent the model standard deviation , estimated by bootstrapping ( see _ materials and methods _ ) .",
    "the subfigure shows the template velocities adjusted by the time of maximum reverse velocity , illustrating that the three templates nearly match .",
    "( c ) the rescaling function @xmath45 for the three different worm types , normalized by multiplying by the absolute value of the minimum of the active template velocity @xmath46 .",
    "the optimized parameter values are @xmath47 and @xmath48 for the control , ibuprofen , and mutant worms , respectively .",
    "we deliberately do not report error bars on individual parameters , but rather show the one standard deviation confidence intervals for the entire rescaling curve as shaded regions on the figure .",
    "the confidence region was again estimated using bootstrapping.[fig : the - normalized - active],scaledwidth=100.0% ]    note that the three active template velocity profiles in fig .",
    "[ fig : the - normalized - active](a ) are very similar , but the mutant template velocity profile shows a response lag of @xmath49 ms ( one time frame at 12 hz ) compared to the control or ibuprofen data set . in other words , the pharmacological treatments and the mutations weakly affect the templated response , save for possibly delaying it .",
    "this bodes well for the assumption of the stereotypical response , definitely for ibuprofen and , to a somewhat lesser extent , for the mutant .",
    "while the existence of the stereotypical patterns and their similarity across treatments is encouraging , we still need to quantify how good the statistical models are . in the ideal case ,",
    "the variance @xmath50 of the collapsed velocities , eq .",
    "( [ eq : collapse ] ) , calculated over individual trials , would be zero .",
    "however , there are a number of expected sources of variance in the velocity , such as the individual variability and the model inaccuracies . to establish how good the stereotypical model fits are",
    ", we need to disambiguate these contributions . for this",
    ", we again partition all velocity profiles into five current bins .",
    "we then write the total variance of all responses as @xmath51 where @xmath52 is the variance due to individual responses within each bin , and @xmath53 is the current - driven variance of the mean responses across the bins .",
    "since the individuality of the worms is not accounted for in our model , @xmath53 represents the maximum potentially explainable variance in the data .",
    "the stereotypy - based model would be nearly perfect if @xmath54 were to drop to zero after the @xmath55 rescaling . to explore this , in fig .",
    "[ fig : var ] , we plot the total variance of the active response @xmath56 , panel ( a ) , and the fraction of the potentially explainable variance , @xmath57 , panel ( b ) .",
    "the latter varies from 20% to 40% of the total variance , depending on the time post - stimulus and on the treatment . in both panels , the mutant and the control dataset",
    "are nearly indistinguishable , while the ibuprofen worms show a smaller variance , and a smaller fraction of the explainable variance .",
    "this is consistent with a smaller stimulus - driven nociceptive response for this analgesic treatment . at the same time , these figures suggest that the decrease in the maximum reverse speed in the mutant worm , fig .  [ fig : p and a state demo ] ( a ) , should not be attributed entirely to the reduced nociception .",
    "indeed , the similarity of the variance and the explainable variance in the control and the mutant worms , which have very different mean maximum reverse velocities , suggests existence of an additional ( explainable , non - templated ) component in the nociceptive response of the mutant , which is not present in the control .    .",
    "note that these numbers depend strongly on the preprocessing of the data  in particular , smoothing of the velocity ( with the 500 ms filter , see _ materials and methods _ ) decreases the total variance . in ( b )",
    "we show the fraction of potentially explainable variance @xmath58 .",
    "finally , ( c ) shows the part of the explainable variance that was not explained by our statistical model @xmath59 .",
    "see the main text for the discussion of the differences between the three worm types on this plot .",
    "[ fig : var],scaledwidth=100.0% ]    the explainable variance @xmath53 is further split into the variance explained by the model , @xmath60 , and the residual variance , @xmath61 , which the model fails to explain : @xmath62 in fig .",
    "[ fig : var ] ( c ) , we plot @xmath63 , which is the fraction of the variance not captured by our model . of the explainable variance ,",
    "about 80% is captured by our model for the control and the ibuprofen worms in the window between 1 s and 3.3 s since the start of the trial , on average .",
    "this is a relatively large fraction for behavioral data , and provides an additional validation for our choice of a stereotypy - based model for representing nociceptive escape behavior in these worms .",
    "stability of the template itself between these two conditions , and the stability of the fraction of the explained variance suggest that much of the effect of ibuprofen can be attributed to scaling of the templated response ( and also the fraction of active worms ) . in other words",
    ", ibuprofen decreases the sensed nociception .",
    "in contrast , the unexplained variance for the mutant is about twice as large as that for the control , and approaches 100% at @xmath64 s. this again illustrates that the templated response model is not very good for this treatment .",
    "thus the mutations introduce changes in the behavior that are not consistent with a simple rescaling ",
    "mutations affect the fine motor behavior in addition to nociception per se .",
    "one of the goals of our study is to develop methods for quantitative assessment of the efficacy of pharmacological interventions to decreases sensed nociception , at least in those cases where their action can be specifically interpreted as a change in nociception transduction .",
    "we can use the developed statistical model for this . specifically , taking the model derived from the control worms , we can infer the laser current from behavior of all three different worm types . to the extent that the current inferred for the treated worms",
    "is smaller than that for the control worms at the same applied current , the nociception level perceived by the treated worms is smaller .",
    "figure [ fig : pvsa prob map = 000026 exp value ] shows the overall structure of the inference done with the model . in the first row , we plot the conditional distribution of the inferred laser current given the actual applied current @xmath8 for the three worm types , @xmath65 . for presentation purposes , we again bin the trials using @xmath22 into five bins @xmath66 , @xmath67 as before , and plot @xmath68 here @xmath69 is 1 if the stimulus on the @xmath70th trial for this worm type was in the @xmath66 bin , and zero otherwise .",
    "further , @xmath71 is given by the full model , eq .",
    "( [ eq : fullmodel ] ) , with the parameters inferred for the control worm , and with the empirically observed velocities @xmath72 in trial @xmath70 for each worm type .",
    "we see that there is more probability concentrated at small @xmath73 for the ibuprofen and the mutant worms , suggesting a reduction in the perceived stimulus level . similarly , in the second row in fig .",
    "[ fig : pvsa prob map = 000026 exp value ] , we plot the expected value , @xmath74 , of the distribution of the current inferred using the control model , @xmath71 , for each of the individual trials in each of the three worm types . to the extent that the dots for the ibuprofen and the mutant worms are again somewhat lower than for the control worms , there is some reduction in the perceived current by this measure as well .    however , these population averaged results wash out important differences in the structure of the nociception response . to quantify these small effects more accurately , we now look at the perceived stimulus changes for individual worms in the datasets .",
    "specifically , for each trial @xmath70 in the control dataset , a trial @xmath75 with the closest value of the applied laser current is found in the ibuprofen / mutant dataset ( the mean magnitude of the current mismatch is @xmath76 ma for both the ibuprofen and the mutant worms ) .",
    "we then use the control model to calculate the expected value of the inferred current for the @xmath77th trial in the ibuprofen / mutant datasets .",
    "this expectation is subtracted from the expectation value of the inferred current for the matched trial @xmath70 for the control dataset .",
    "the difference of the expectation values , averaged over all control worms , is our measure of the reduction in the perceived nociception level @xmath78 we evaluate @xmath79 for different worm types and for controls worms binned into the five usual current bins , and show the results in fig .",
    "[ fig : delta_ipred ] . to estimate the error of @xmath79",
    ", we bootstrap the whole analysis pipeline , see _ materials and methods_. there is a statistically significant difference in nociception perception between the ibuprofen and the control worms .",
    "the difference is most significant when the actual laser current is around 100 - 110 ma .",
    "this coincide with our observation from fig .",
    "[ fig : p and a state demo ] ( a ) that the most sensitive region of maximum reverse speed is around 100ma .",
    "indeed , at smaller currents , the nociception level is small , many worms pause , and the behavior can not be used to reliably estimate the stimulus level . at high current ,",
    "the noxious stimulus perception saturates , and all worms behave similarly , again reducing the ability to disambiguate the applied current level .",
    "this analysis of ibuprofen worms achieves one of our main goals .",
    "it proves our ability to reconstruct stimulus from the behavior , and shows that analgesic effects of pharmacological perturbations can be quantified from the behavior . at the same time",
    ", @xmath80 turns out to be insignificant in fig .",
    "[ fig : delta_ipred ] ( b ) , even though fig .",
    "[ fig : p and a state demo ] ( a ) suggest that a large statistically significant difference exists between the mutant and the control behaviors . this failure to detect a significant nociception reduction is because the templated response model is not very good for the mutant worm ; thus our analysis can not reliably assign a mutant trajectory on a given trial to a specific nociception level .",
    "in other words , the large error bars in fig .  [",
    "fig : delta_ipred ] ( b ) serve as yet another check for self consistency : effects of the mutations can not be attributed just to changes in nociception perception .    .",
    "inference is done with the model of the control worm behavior .",
    "panels ( a ) , ( b ) , ( c ) show the results for the control , ibuprofen , and mutant worms , respectively .",
    "the second row shows the expected inferred laser current for each trial , @xmath81 vs.  the applied current @xmath22 .",
    "the inference is again done using the control model , and panels ( d ) , ( e ) , ( f ) show the three worm types .",
    "[ fig : pvsa prob map = 000026 exp value],scaledwidth=100.0% ]    .",
    "errors represent standard deviations , estimated with bootstrapping .",
    "( b ) similar differences for the mutant worm , @xmath80 .",
    "error bars are estimated by bootstrapping .",
    "( c ) dependence of the statistical significance of the nociception level reduction ( measured by the @xmath5 score ) for ibuprofen at 110 ma on the number of ibuprofen trials .",
    "[ fig : delta_ipred],scaledwidth=100.0% ]",
    "we expect our analysis to be useable for screening large numbers of chemicals for analgesic action .",
    "since our approach targets one individual worm at a time , we need to estimate the number of worms needed to achieve statistical significance in such screening experiments . for this",
    ", we fix the number of control worms , arguing that these must be only analyzed once , and hence a relatively large number of them can be tested .",
    "we then focus on ibuprofen , whose action is analgesic in our experiments , and on the bin at 110 ma , where the worms experience the most significant nociception reduction .",
    "there are @xmath82 worms in this bin .",
    "we randomly sample with replacements @xmath83 worms from among these ibuprofen - treated worms and repeat our analysis pipeline , estimating the @xmath84 . resampling 1000 times ( both the ibuprofen and the control datasets )",
    ", we also estimate the variance of @xmath84 , and hence the @xmath5 score as a function of @xmath85 , which is plotted in fig .  [",
    "fig : delta_ipred ] ( c ) .",
    "the plot here is an _ underestimate _ of the true @xmath5 score since resampling with replacements removes some stimulus values from the dataset , hence increasing the mismatch between control worms and the paired treated worms .",
    "even with this , @xmath86 is achieved at @xmath87 ibuprofen worms . in other words , in a typical screening experiment , one would need to test @xmath88 or more worms to build the control model , and then at least @xmath89 worms additionally for each treatment condition .",
    "typically the goal of sensory - response experiments is to develop a model that can predict the behavior in response to the stimuli .",
    "here we wanted to do this in reverse .",
    "our goal was to build a statistical model of the thermal stimulus from careful measurements of the nociceptive behavior of _ c.  elegans _ , and to use this model to infer the changes in the perceived level of `` pain '' felt by the organism due to perturbation in the nociception transduction pathway . given this model , we could then measure changes in nociception perception due to effects of analgesics and mutations , and use this as a basis to study the mechanism of nociception transduction in a genetically tractable organism amenable to high - throughput screens . as a representative data set , we choose to study the standard laboratory _ c.  elegans _",
    "strain n2 , n2 treated with ibuprofen , and a mutant with defects in trpv function .",
    "for the model to be successful , we had to meet a number of challenges .",
    "since the worm could not communicate its nociception level to us directly we had to infer this level by reading the `` body language '' of the worm s `` pain '' response .",
    "the difficulty with quantifying a behavioral response as a measure of nociception level is that drugs or mutations can affect locomotory behavior in addition to perturbing sensory transduction .",
    "so in an attempt to deconvolve these effects , we used the entire behavioral profile instead of making ad hoc measurements and leveraged the fact that nociception responses are typically highly stereotyped .",
    "this resulted in the discovery that the response can be modeled with a velocity profile template that scales non - linearly in response to an applied laser current .",
    "the success of the template in modeling the stereotyped wild - type nociception response was confirmed by a functional collapse of the velocity profiles across different nociception levels .",
    "this discovery of invariance is important since it not only allowed us to effectively correlate nociceptive behavior to the stimulus level , but it also allowed us to determine if the locomotory changes in our thermal nociception assay was due to changes specifically in the sensory transduction pathway or due to other general locomotory factors . by carefully accounting for the variation in our data and quantifying",
    "how much of this variation is captured by the model , we showed that the stereotypical behavior is unaffected by ibuprofen , save for changing the amplitude of the response .",
    "thus this drug application likely reduced the perceived nociception level in the worm .",
    "in contrast , a trpv mutation changes locomotion in a way that is not as well captured by the template model .",
    "thus we can be objectively critical about any nociception inference made with this strain .",
    "the model was also useful in determining key experimental parameters for future measurements .",
    "after verification that the model works well with the native and ibuprofen treated stimulus - response data , we quantified the changes in thermal nociception perception due to ibuprofen treatment .",
    "our modeling and experimental assessment of thermal nociception identified the optimal stimulus range and required number of trials to determine statistically significant differences between the inferred current of n2 in the untreated and treated conditions .    in conclusion",
    ", we have built a general model that connects stereotyped behavior to stimulus . with a language to describe this relationship",
    ", it is now possible to study quantitatively the effects of genetics and chemicals on this sensorimotor behavior .",
    "we believe that the utility of the model is quite general and could be applied to different model system .",
    "however , we particularly hope that this work helps further establish _ c.  elegans _ as a model for nociceptive research .",
    "all worms were grown and maintained under standard conditions @xcite , incubated with food at 20 @xmath90c .",
    "well fed worms were washed twice then gently spun down for 1 minute and the supernatant discarded by aspiration .",
    "for the drug application , 100 @xmath91l of ibuprofen in m9 at 100 @xmath91 m was added to the eppendorf tube . for the wild - type and mutant data set ,",
    "m9 was used instead of the drug solution .",
    "worms were then placed in an incubator for 30 minutes at 20@xmath90c .",
    "after that worms were poured onto a seeded agar plate and transferred to agar assay plates by a platinum wire pick .",
    "these assay plates were incubated at 20@xmath90c for 30 minutes , and then the experimental trials were done within the next 30 minutes . in total @xmath92 worms for the control group , @xmath93 worms for the ibuprofen group , and @xmath94 worms for the mutant group ( ocr-2(ak47 ) osm-9(ky10 ) iv ; ocr-1(ak46 ) )",
    "group were tested .",
    "the mutant strain was obtained from the caenorhabditis genetics center .",
    "the thermal nociceptive stimulation instrument has been described previously @xcite . in summary ,",
    "an infrared laser is directed to heat the head of a freely crawling worm ( @xmath95 mm fwhm ) on an agar plate .",
    "the laser pulse is generated with a randomly chosen laser current between 0 to 200 ma , with a duration of 0.1 s. the heating of the worm is nearly instantaneous , and it is directly proportional to the current , between 0 and 2 @xmath90c for the the current range used in our experiments .",
    "worms were stimulated only once and not reused .",
    "the movements of the worms are imaged using a standard stereomicroscope with video capture and laser control software written in labview . for each nociception stimulus trial",
    ", a random worm is selected on the plate and its motion is sampled at 60 hz for 15 s , and the laser is engaged 1  s after the start of the video recording .",
    "the recorded nociceptive response videos were then processed with matlab to calculate the time series of the worm centroid motion as described previously @xcite .",
    "all the worms that were not stimulated near the head or were not moving forward in the beginning of the video were discarded .",
    "numerical derivatives of the centroid times series were then taken and filtered with a custom 500 ms gaussian filter , which was a one - sided gaussian at the edges of the recorded time period , becoming a symmetric gaussian away from the edges .",
    "this removed the noise due to numerical differentiation and also averaged out the spurious fluctuations in the forward velocity due to the imperfect sinusoidal shapes of the moving worm .",
    "we verified that different choices of the filter duration had little effect on the subsequent analysis pipeline .",
    "the direction of the velocity was determined by projecting the derivative of the centroid time series onto the head - to - tail vector for each worm , with the positive and negative velocity values denoting forward / backward motion , respectively .",
    "the filtered velocity profiles needed to be subsampled additionally .",
    "this was because the statistical model of the data , eq .  ( [ eq : fullmodel ] ) , involved covariance matrices of the active and paused velocity profiles , @xmath96 and @xmath97 ( note that velocity profiles are not temporally translationally invariant due to the presence of the stimulus , thus the full covariance matrix is needed , and not a simpler correlation function ) . to have a full rank covariance matrix",
    ", the number of trials must be larger than the number of time points .",
    "alternatively , regularization is needed for covariance calculation .",
    "the autocorrelation function for all three worm types showed a natural correlation time scale of @xmath98 s , whether the data was pre - filtered or not .",
    "thus subsampling at frequency @xmath99 hz would not result in data loss .",
    "therefore , instead of an arbitrary regularization , we chose to subsample the data at 12 hz , leaving us with 37 data points to characterize the first 3 s of the worm velocity trace after the stimulus application , @xmath100 s since the start of the trial .",
    "equation  ( [ eq : fullmodel ] ) additionally needs knowledge of @xmath29 , the number of effectively independent velocity measurements in the profile .",
    "this is obtained by dividing the duration of the profile by the velocity correlation time .",
    "an uncertainty of such procedure has a minimal effect on the model of the experiment since it simply changes log likelihoods of models by the same factor , not changing which model has the maximum likelihood .",
    "we then considered limiting the duration of the velocity profile used in model building : if velocities at certain time points do not contribute to identification of @xmath8 , they should be removed to decrease the number of unknowns in the model that must be determined from data ( values of the templates at different time points ) .",
    "the first candidate for removal was the period of about 10 frames ( 0.16 s ) after the laser stimulation since worms do not respond to the stimulus so quickly . however , removal of this time period had a negligible effect on the model performance , and we chose to leave it intact .",
    "in contrast , starting from 3.3 s ( 2.3 s after the stimulus ) the fraction of explainable variance drops to nearly zero ( cf .",
    "[ fig : var ] ) since many worms already had turned by this time and resumed forward motion .",
    "therefore , we eventually settled on the time in the @xmath101 s range for building the model .    whenever needed , we estimated variance of our predictions by bootstrapping the whole analysis pipeline @xcite .",
    "for this , we created 1000 different datasets by resampling with replacement from the original control dataset and the mutant / ibuprofen datasets .",
    "control statistical models ( the scaling function @xmath31 and the velocity templates ) were estimated for each resampled control dataset .",
    "standard deviations of these models were used as estimates of error bars in fig .",
    "[ fig : the - normalized - active ] . for fig .",
    "[ fig : delta_ipred ] , we additionally needed to form the closest control / treatment worm pairs .",
    "these were formed between the _ resampled _ data sets for all worm types as well .",
    "standard deviations of @xmath79 evaluated by such resampling were then plotted in fig .  [",
    "fig : delta_ipred ] and used to estimate @xmath5 scores .",
    "note that such resampling produces data were control / treatment paired worms have slightly larger current differences than in the actual data ; this leads to our error bars being _",
    "overestimates_.    model in eq .",
    "( [ eq : bayes ] ) requires knowing @xmath11 . in principle , this is controlled by the experimentalist , and thus should be known . in our experiments , @xmath11 was set to be uniform . however , as described above , some of the worms were discarded in preprocessing , and this resulted in non - uniformly distributed current samples . to account for this , we used the empirical @xmath102 in our analysis instead of @xmath103 . in turn",
    ", @xmath102 was inferred using a well - established algorithm for estimation of one - dimensional continuous probability distributions from data @xcite .",
    "[ [ calculating - the - template - velocities - the - covariances - and - the - scaling - function ] ] calculating the template velocities , the covariances , and the scaling function ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    the template for the paused state @xmath27 is calculated by taking the average of all paused velocity profiles for each of the three worm datasets . the covariance @xmath28 is then the covariance of the set of the paused velocity profiles .    for active worms ,",
    "we start with fixed putative parameter values @xmath36 and @xmath43 .",
    "we then calculate the active template @xmath104 and the covariance matrix @xmath105 by maximizing the likelihood in eq .",
    "( [ pva ] ) @xmath106=0 , \\\\",
    "\\frac{\\partial \\sum_{i}^{n_{{\\rm type},a } } \\log   p({{\\bf v}}_i|a , i_i ) } { \\partial",
    "\\sigma_a}&\\propto \\sum_{i}^{n_{{\\rm type},a}}\\left[{{\\bf v}}_i-{{\\bf u}}_{a}f_{{{\\mathcal i}}_1,{{\\mathcal i}}_2}(i_i)\\right]^2-(\\sigma_a)^{-1}=0,\\end{aligned}\\ ] ] where @xmath107 is the number of active worms of the analyzed type .",
    "this gives : @xmath108 ^ 2.\\end{aligned}\\ ] ] having thus estimated @xmath32 and @xmath97 at fixed parameter values @xmath36",
    ", @xmath43 , we maximize @xmath109 over the parameters using standard optimization algorithms provided by matlab . we perform optimization from ten different initial conditions to increase the possibility that we find a global , rather than the local maximum .",
    "we thank the granting agencies nsf , hfsp ( human frontier science program ) , and nserc ( natural sciences and engineering council of canada ) for funding , and the aspen center for physics for hosting the program on `` physics of behavior '' , where some of this work was done .",
    "tobin dm , madsen dm , kahn - kirby a , peckol el , moulder g , barstead r , et  al .",
    "combinatorial expression of trpv channel proteins defines their sensory functions and subcellular localization in _ c.  elegans _ neurons ."
  ],
  "abstract_text": [
    "<S> experiments of pain with human subjects are difficult , subjective , and ethically constrained . </S>",
    "<S> since the molecular mechanisms of pain transduction are reasonably conserved among different species , these problems are partially solved by the use of animal models . </S>",
    "<S> however , animals can not easily communicate to us their own pain levels . </S>",
    "<S> thus progress depends crucially on our ability to quantitatively and objectively infer the perceived level of noxious stimuli from the behavior of animals . </S>",
    "<S> here we develop a quantitative model to infer the perceived level of thermal nociception from the stereotyped nociceptive response of individual nematodes _ </S>",
    "<S> caenorhabditis elegans _ stimulated by an ir laser . </S>",
    "<S> the model provides a method for quantification of analgesic effects of chemical stimuli or genetic mutations in _ c.  elegans_. we test the nociception of ibuprofen - treated worms and a trpv ( transient receptor potential ) mutant , and we show that the perception of thermal nociception for the ibuprofen treated worms is lower than the wild - type . at the same time </S>",
    "<S> , our model shows that the mutant changes the worm s behavior beyond affecting nociception . finally , we determine the stimulus level that best distinguishes the analgesic effects and the minimum number of worms that allow for a statistically significant identification of these effects . </S>"
  ]
}