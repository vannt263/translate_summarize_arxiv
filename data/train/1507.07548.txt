{
  "article_text": [
    "molecular modeling and simulation is a technology central to many areas of research in academia and industry . with the advance of computing power ,",
    "the scope of application scenarios for molecular simulation is widening , both in terms of complexity of a given simulation and in terms of high throughput .",
    "nowadays , e.g. the predictive simulation of entire phase equilibrium diagrams has become feasible .",
    "however , in order to rely on simulation results , the methodology needs to be sound and the implementation must be thoroughly verified . in its first release  @xcite",
    ", we have introduced the molecular simulation tool @xmath02 .",
    "results from @xmath02 have been verified and the implementation was found to be robust and efficient .    as described in section [ hybrid ] , in version 2.0 of the simulation tool @xmath02 the existing molecular dynamics ( md )",
    "mpi parallelization was hybridized with openmp , leading to an improved performance on multi - core processors .",
    "furthermore , the new release offers a wider scope of accessible properties .",
    "in particular , @xmath02 was extended to calculate massieu potential derivatives in a systematic manner , cf .",
    "section [ massieu ] .",
    "this augments the range of sampled properties significantly and , as was demonstrated in  @xcite , it allows to straightforwardly develop competitive fundamental equations of state from a combination of experimental vle data and molecular simulation results .",
    "lastly , besides being now capable of simulating ionic substances , the time and memory demand for calculating transport properties was reduced significantly ( section [ algo ] ) .",
    "@xmath02 is freely available as an open source code for academic users at www.ms-2.de .",
    "the molecular simulation tool @xmath02 focuses on thermodynamic properties of homogeneous fluids .",
    "therefore , systems investigated with @xmath02 typically contain on the order of @xmath1 molecules . while for monte carlo simulations a perfect scaling behavior up to large numbers of cores can be trivially achieved , md domain decomposition ",
    "the de facto standard for highly scalable md  is not feasible for such system sizes , because the cut - off radius is in the same range as half the edge length of the simulation volume .",
    "this excludes domain decomposition and limits the scalability of the mpi parallelization .",
    "the present release of @xmath02 features an openmp parallelization , which was hybridized with mpi . at the point where mpi communication becomes a bottleneck",
    ", a single process still has enough load to distribute to multiple threads , improving scalability .",
    "three parts of @xmath02 were parallelized with openmp : the interaction partner search , the energy and the force calculations .",
    "all openmp parallel regions rely on loop parallelism , as the compute intensive parts of the algorithm all feature a loop over the molecules . in the force calculation ,",
    "race conditions need to be considered , because every calculated force is written to both interacting molecules . introducing atomic updates or critical sections",
    "leads to massive overheads .",
    "instead , it is more efficient to assign forces from individual interactions to the elements of a list ( or an array ) which is subsequently summed up .",
    "the same holds true for torques .    in figure  [ hybrid ] the speed - up of hybrid mpi / openmp vs. pure mpi is plotted for 2048 cores , varying the number of threads per mpi process and the number of molecules in the simulation volume . as can be seen , using 2 to 4 threads per mpi process delivers a speed - up of around 20% for 2048 cores .",
    "the evaluation of the hybrid parallelization algorithm was performed on a cray xe6 supercomputer at the high performance computing center in stuttgart , which has an overall peak performance of one pflops .",
    "it consists of 3552 nodes , each equipped with two amd opteron 6276 ( interlagos ) processors .",
    "each processor has 16 cores , sharing eight fpus ( floating point units ) .",
    "nodes are equipped with 32 gb ram and are interconnected by a high - speed cray gemini network .",
    "additional runtime performance comparisons with the simulation tool _ gromacs _  @xcite are listed in table [ tab1 ] .",
    "cccccc cores & threads & @xmath2 & gromacs / s & @xmath02(rf ) / s & @xmath02(ew ) / s + 8 & 8 mpi & 500 & 164 & 416 & 785 + 8 & 8 mpi & 1000 & 299 & 874 & 1607 + 8 & 8 mpi & 2000 & 1284 & 4461 & 6777 + 16 & 16",
    "mpi & 500 & 95 & 233 & 415 + 16 & 16 mpi & 1000 & 166 & 477 & 848 + 16 & 16 mpi & 2000 & 678 & 2298 & 3506 + 32 & 32 mpi & 500 & 62 & 152 & 245 + 32 & 32 mpi & 1000 & 106 & 296 & 487 + 32 & 32 mpi & 2000 & 361 & 1286 & 1898 + 64 & 64 mpi & 500 & 40 & 119 & 166 + 64 & 64 mpi & 1000 & 65 & 228 & 324 + 64 & 64 mpi & 2000 & 220 & 814 & 1261 + 128 & 128 mpi & 500 & 38 & 105 & 131 + 128 & 128 mpi & 1000 & 51 & 197 & 247 + 128 & 128 mpi & 2000 & 147 & 557 & 727 + 8 & 1 mpi , 8 omp / mpi & 500 & 167 & 483 & + 8 & 1 mpi , 8 omp / mpi & 1000 & 323 & 975 & + 8 & 1 mpi , 8 omp / mpi & 2000 & 1416 & 4831 & + 16 & 2 mpi , 8 omp / mpi & 500 & 105 & 253 & + 16 & 2 mpi , 8 omp / mpi & 1000 & 186 & 517 & + 16 & 2 mpi , 8 omp / mpi & 2000 & 763 & 2514 & + 32 & 4 mpi , 8 omp / mpi & 500 & 75 & 167 & + 32 & 4 mpi , 8 omp / mpi & 1000 & 121 & 316 & + 32 & 4 mpi , 8 omp / mpi & 2000 & 418 & 1362 & + 64 & 8 mpi , 8 omp / mpi & 500 & 60 & 119 & + 64 & 8 mpi , 8 omp / mpi & 1000 & 92 & 217 & + 64 & 8 mpi , 8 omp / mpi & 2000 & 261 & 785 & + 128 & 16 mpi , 8 omp / mpi & 500 & 49 & 101 & + 128 & 16 mpi , 8 omp / mpi & 1000 & 74 & 172 & + 128 & 16 mpi , 8 omp / mpi & 2000 & 170 & 496 & +   +   +   +    [ tab1 ]",
    "@xmath02 version 2.0 features evaluating free energy derivatives in a systematic manner , thus greatly extending the thermodynamic property types that can be sampled in single simulation runs .",
    "the approach is based on the fact that the fundamental equation of state contains the complete thermodynamic information about a system , which can be expressed in terms of various thermodynamic potentials  @xcite , e.g. internal energy @xmath3 , enthalpy @xmath4 , helmholtz free energy @xmath5 or gibbs free energy @xmath6 , with number of particles @xmath2 , volume @xmath7 , pressure @xmath8 , temperature @xmath9 and entropy @xmath10 .",
    "these representations are equivalent in the sense that any other thermodynamic property is essentially a combination of derivatives of the chosen form with respect to its independent variables .",
    "the form @xmath11 , known as the massieu potential , is preferred in molecular simulations due to practical reasons  @xcite .",
    "the statistical mechanical formalism of lustig allows for the simultaneous sampling of any @xmath12 in a single @xmath13 ensemble simulation for a given state point  @xcite @xmath14 where @xmath15 is the gas constant , @xmath16 and @xmath17 .",
    "@xmath18 can be separated into an ideal part @xmath19 and a residual part @xmath12  @xcite .",
    "the calculation of the residual part is the target of molecular simulation and the derivatives @xmath20 , @xmath21 , @xmath22 , @xmath23 , @xmath24 , @xmath25 , @xmath26 and @xmath27 were implemented in @xmath02 for @xmath13 ensemble simulations .",
    "the ideal part can be obtained by independent methods , e.g. from spectroscopic data or ab initio calculations .",
    "however , it can be shown that for any @xmath28 , where @xmath29 , the ideal part is either zero or depends exclusively on the density , thus it is known by default  @xcite .",
    "note that the calculation of @xmath30 still requires additional concepts such as thermodynamic integration or particle insertion methods . from the first five derivatives @xmath31 , @xmath32 , @xmath33 , @xmath34 , @xmath35 every measurable thermodynamic property can be expressed ( see the supplementary material for a list of properties ) with the exception of phase equilibria .",
    "a detailed description of the implementation is in the supplementary material , here , only an overview is provided .",
    "+ the calculation of the derivatives up to the order of @xmath36 requires the explicit mathematical expression of @xmath37 and @xmath38 with respect to the applied molecular interaction pair potential and has to be determined analytically beforehand  @xcite . the general formula for @xmath39 can be found in ref .",
    "@xcite . for common molecular interaction pair potentials , like the lennard - jones potential  @xcite , describing repulsive and dispersive interactions , or coulomb s law , describing electrostatic interactions between point charges ,",
    "the analytical formulas for @xmath37 and @xmath38 can be obtained straightforwardly .",
    "+ as molecular simulation is currently limited to operate with considerably fewer particles than real systems , the effect of the small system size thus has to be counter - balanced with a contribution to @xmath40 and @xmath39 called long range correction ( lrc )  @xcite .",
    "the mathematical form of the lrc depends on the molecular interaction potential and the cut - off method ( site - site or center - of - mass cut - off mode ) applied . for the lennard - jones potential ,",
    "the lrc scheme was well described in the literature for both the site - site  @xcite and the center of mass cut - off mode  @xcite .",
    "the reaction field method  @xcite was the default choice in the preceding version of @xmath02 for the lrc of electrostatic interactions modelled by considering charge distributions on molecules .",
    "the usual implementation of the reaction field method combines the explicit and the lrc part in a single pair potential  @xcite from which @xmath39 ( including the lrc contribution ) is directly obtainable .",
    "however , practical applications show that the electrostatic lrc of @xmath37 and @xmath38 can be neglected in case of systems for which the reaction field method is an appropriate choice .",
    "e.g. , the contribution of the electrostatic lrc for a liquid system ( @xmath41 k and @xmath42 mol / l ) consisting of only 200 water and 50 methanol molecules with a very short cut - off radius of @xmath43 of the edge length of the simulation volume is still @xmath44 for both @xmath37 and @xmath38 .",
    "the supplementary material contains detailed elaborations on the lrc for the lennard - jones potential .",
    "[ [ transport - property - calculations ] ] transport property calculations + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in @xmath02 , transport properties are determined via equilibrium md simulations by means of the green - kubo formalism  @xcite .",
    "this formalism offers a direct relationship between transport coefficients and the time integral of the autocorrelation function of the corresponding fluxes .",
    "an extended time step was defined for the calculation of the fluxes , the autocorrelation functions and their integrals .",
    "the extended time step is @xmath45 times longer than the specified md time step , where @xmath45 is a user defined variable .",
    "the autocorrelation functions are hence evaluated in every @xmath45-th md time step . as a consequence ,",
    "the memory demand for the autocorrelation functions was reduced and the restart files , which contain the current state of the autocorrelation functions and time integrals , become accordingly smaller . in addition , the overall computing time of the md simulation was reduced significantly .",
    "+    [ [ ewald - summation ] ] ewald summation + + + + + + + + + + + + + + +    ewald summation  @xcite was implemented for the calculation of electrostatic interactions between point charges .",
    "it extends the applicability of @xmath02 to thermodynamic properties of e.g. ions in solutions . in ewald summation ,",
    "the electrostatic interactions according to coulomb s law are divided into two contributions : short - range and long - range .",
    "the short - range term includes all charge - charge interactions at distances smaller than the cut - off radius .",
    "the remaining contribution is calculated in fourier space and only the final value is transformed back into real space .",
    "this allows for an efficient calculation of the long - range interactions between the charges .",
    "the algorithm is well described in literature . currently , some of the new features , the calculation of massieu potential derivatives and hybrid mpi & openmp parallelization for md , are not available together with ewald summation .",
    "[ [ radial - distribution - function ] ] radial distribution function + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the radial distribution function ( rdf ) @xmath46 is a measure for the microscopic structure of matter .",
    "it is defined by the local number density around a given position within a molecule @xmath47 in relation to the overall number density @xmath48    @xmath49    therein , @xmath50 is the differential number of molecules in a spherical shell volume element @xmath51 , which has the width @xmath52 and is located at the distance @xmath53 from the regarded position .",
    "@xmath46 can be evaluated for every molecule of a given species .    in the present release of @xmath02 , the rdf can be calculated during md simulation",
    "runs for pure components and mixtures on the fly .",
    "the rdf is sampled between all lj sites . in order to evaluate rdfs for arbitrary positions ,",
    "say point charge sites , superimposed dummy lj sites with the parameters @xmath54 have to be introduced in the potential model file by the user .",
    "[ [ electric - conductivity ] ] electric conductivity + + + + + + + + + + + + + + + + + + + + +    the evaluation of the electric conductivity @xmath55 was implemented in @xmath02 version 2.0 , being a measure for the flow of ions in solution .",
    "the green - kubo formalism  @xcite offers a direct relationship between @xmath55 and the time - autocorrelation function of the electric current flux @xmath56",
    "@xcite @xmath57 where @xmath58 is boltzmann s constant .",
    "the electric current flux is defined by the charge @xmath59 of ion @xmath60 and its velocity vector @xmath61 according to @xmath62 where @xmath63 is the number of molecules of component @xmath64 in solution .",
    "note that only the ions in the solution have to be considered , not the electro - neutral molecules . for better statistics ,",
    "@xmath55 is sampled over all independent spatial elements of @xmath56 .",
    "[ [ thermal - conductivity - of - mixtures ] ] thermal conductivity of mixtures + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the previous version of @xmath65 the determination of the thermal conductivity by means of the green - kubo formalism was implemented for pure substances only . in the present release",
    ", the calculation of the thermal conductivity was extended to multi - component mixtures .",
    "the thermal conductivity @xmath66 is given by the autocorrelation function of the elements of the microscopic heat flow @xmath67 @xmath68 in mixtures , energy transport and diffusion occur in a coupled manner , thus , the heat flow for a mixture of @xmath45 components is given by  @xcite @xmath69\\cdot \\mathbf{v}_i^k \\\\               & -&\\frac{1}{2}\\sum_{i=1}^{n } \\sum_{j=1}^{n } \\sum_{k=1}^{n_i } \\sum_{l \\neq k}^{n_j } \\bm{r}_{ij}^{kl}\\cdot \\big ( \\mathbf{v}_i^k \\cdot \\frac{\\partial u\\left(r_{ij}^{kl}\\right)}{\\partial \\bm{r}_{ij}^{kl}}+\\mathbf{w}_i^k \\mathbf{\\gamma}_{ij}^{kl}\\big)- \\sum_{i=1}^{n } h_{i}\\sum_{k=1}^{n_i } \\mathbf{v}_{i}^{k}\\mbox {    , } \\label{heatflow } \\end{aligned}\\ ] ] where @xmath70 is the angular velocity vector of molecule @xmath60 of component @xmath71 and @xmath72 its matrix of angular momentum of inertia .",
    "@xmath73 is the intermolecular potential energy and @xmath74 is the torque due to the interaction of molecules @xmath60 and @xmath75 .",
    "the indices @xmath71 and @xmath64 denote the components of the mixture .",
    "@xmath76 is the partial molar enthalpy .",
    "it has to be specified as an input in the @xmath65 parameter file and can be calculated from @xmath77 simulations .",
    "[ [ residence - time ] ] residence time + + + + + + + + + + + + + +    the residence time @xmath78 defines the average time span that a molecule of component @xmath64 remains within a given distance @xmath79 around a specific molecule @xmath71 .",
    "it is given by the autocorrelation function @xmath80 where @xmath81 is the time , @xmath82 the solvation number around molecule @xmath71 at @xmath83 and @xmath84 is the heaviside function , which yields unity , if the two molecules are within the given distance , and zero otherwise . following the proposal of impey et al .",
    "@xcite , the residence time explicitly allows for short time periods during which the distance between the two molecules exceeds @xmath79 .",
    "also , the solvation number @xmath85 can be evaluated on the fly    @xmath86    where @xmath87 is the number density of component @xmath64 and @xmath88 is the distance up to which the solvation number is calculated .",
    "the authors gratefully acknowledge financial support by the bmbf `` 01ih13005a skasim : skalierbare hpc - software fr molekulare simulationen in der chemischen industrie '' and computational support by the high performance computing center stuttgart ( hlrs ) under the grant mmhbf2 .",
    "the present research was conducted under the auspices of the boltzmann - zuse society for computational molecular engineering ( bzs ) .",
    "19 natexlab#1#1[1]`#1 ` [ 2]#2 [ 1]#1 [ 1]http://dx.doi.org/#1 [ ] [ 1]pmid:#1 [ ] [ 2]#2 , , , , , , , , , : ( ) .",
    ", , , , : ( ) .",
    "( ) . : ( ) . : ( ) . , : , , . , : , , . , : , , . , : ( ) . : ( ) . , : ( ) . : ( ) .",
    ": , , . , : , , . , : ( ) . , , : ( )"
  ],
  "abstract_text": [
    "<S> a new version release ( 2.0 ) of the molecular simulation tool _ ms_2 [ s. deublein et al . , comput . </S>",
    "<S> phys . </S>",
    "<S> commun . 182 </S>",
    "<S> ( 2011 ) 2350 ] is presented . </S>",
    "<S> version 2.0 of _ ms_2 features a hybrid parallelization based on mpi and openmp for molecular dynamics simulation to achieve higher scalability . </S>",
    "<S> furthermore , the formalism by lustig [ r. lustig , mol . </S>",
    "<S> phys . 110 </S>",
    "<S> ( 2012 ) 3041 ] is implemented , allowing for a systematic sampling of massieu potential derivatives in a single simulation run . </S>",
    "<S> moreover , the green - kubo formalism is extended for the sampling of the electric conductivity and the residence time . to remove the restriction of the preceding version to electro - neutral molecules </S>",
    "<S> , ewald summation is implemented to consider ionic long range interactions . finally , the sampling of the radial distribution function is added . </S>"
  ]
}