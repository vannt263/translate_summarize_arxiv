{
  "article_text": [
    "a major challenge of contemporary biology is to ascribe interpretation to high - throughput experimental or computational results , where each considered entity ( gene or protein ) is assigned a value .",
    "biological information is often summarized through controlled vocabularies such as gene ontology ( go ) @xcite , where each annotated term includes a list of entities .",
    "let @xmath0 denote a collection of values , each associated with an entity .",
    "given @xmath0 and a controlled vocabulary , enrichment analysis aims to retrieve the terms that by statistical inference best describe @xmath0 , that is , the terms associated with entities with atypical values .",
    "many enrichment analysis tools have been developed primarily to process microarray data @xcite . in terms of biological relevance ,",
    "the performance assessment of those tools is generally difficult .",
    "it requires a large , comprehensive ` gold standard ' vocabulary together with a collection of @xmath0 s processed from experimental data , and with true / false positive terms corresponding to each @xmath0 correctly specified .",
    "this invariably introduces some degree of circularity because the terms often come from curating experimental results . before declaring efficacy in biological information retrieval that is nontrivial to assess , an enrichment method should pass at least the statistical accuracy and internal consistency test .    in their recent survey , @xcite list 68 distinct bioinformatic enrichment tools introduced between 2002 and 2008 .",
    "most tools share a similar workflow : given @xmath0 obtained by suitably processing experimental data , they sequentially test each vocabulary term for enrichment to obtain its p - value ( the likelihood of a false positive given the null hypothesis ) . since many terms are tested , a multiple hypothesis correction , such as bonferroni @xcite or false discovery rate ( fdr ) @xcite , is applied to p - value of each to obtain the final statistical significance .",
    "the results are displayed for the user in a suitable form outlining the significant terms and possibly relations between them .",
    "note that the latter steps are largely independent from the first . to avoid confounding factors",
    ", we will focus exclusively on the original enrichment p - values .",
    "based on the statistical methods employed , the existing enrichment tools can generally be divided into two main classes . the singular enrichment analysis ( sea ) class contains numerous tools that form the majority of published ones @xcite . by ordering values in @xmath0 ,",
    "these tools require users to select a number of top - ranking entities as input and mostly use hypergeometric distribution ( or equivalently fisher s exact test ) to obtain the term p - values .",
    "after the selection is made , sea treats all entities equally , ignoring their value differences .",
    "the gene set analysis ( gsa ) class was pioneered by the gsea tool @xcite .",
    "tools from this class use all values ( entire @xmath0 ) to calculate p - values and do not require pre - selection of entities .",
    "some approaches @xcite in this group apply hypergeometric tests to all possible selections of top - ranking entities .",
    "the final p - value is computed by combining ( in a tool - specific manner ) the p - values from the individual tests .",
    "other approaches use non - parametric approaches : rank - based statistics such as wilcoxon rank - sum @xcite or kolmogorov - smirnov - like @xcite . when weights are taken into account , such as in gsea @xcite , statistical significance",
    "must be determined from a sampled ( shuffled ) distribution .",
    "unfortunately , limited by the number of shuffles that can be performed , the smallest obtainable p - value is bounded away from 0 .    the final group of gsa methods computes a score for each vocabulary term as a sum of the values ( henceforth used interchangeably with weights ) of the @xmath1 entities it annotates . in general , the score distribution @xmath2 for the experimental data is unknown . by central limit theorem ,",
    "when @xmath1 is large , gaussian @xcite or student s t - distribution @xcite can be used to approximate @xmath2 .",
    "unfortunately , when the weight distributions are skewed , the required @xmath1 may be too large for practical use .",
    "evidently , this undermines the p - value accuracy of small terms ( meaning terms with few entities ) , which are biologically most specific .",
    "it is generally found that , given the same vocabulary and @xmath0 , different enrichment analysis tools report diverse results .",
    "we believe this may be attributed to disagreement in p - values reported as well as that different methods have different degree of robustness ( internal consistency ) . instead of providing a coherent biological understanding , the array of diverse results questions the confidence of information found . furthermore , other than microarray datasets , there exist experimental or computational results such as those from chip - chip @xcite , deep sequencing @xcite , quantitative proteomics @xcite and _ in silico _ network simulations @xcite , that may benefit from enrichment analysis .",
    "it is thus imperative to have an enrichment method that report accurate p - values , preserves internal consistency , and allows investigations of a broader range of datasets .    to achieve these goals , we have developed a novel enrichment tool , called saddlesum , that founds on the well - known lugananni - rice formula @xcite and derives its statistics from approximating asymptotically the distribution function of the scores used in the parametric gsa class .",
    "this allows us to obtain accurate statistics even in the cases where the distribution function generating @xmath0 is very skewed and for terms containing few entities .",
    "the latter aspect is particularly important for obtaining biologically specific information .",
    "we distinguish two sets : the set of entities @xmath3 of size @xmath4 and the controlled vocabulary @xmath5 . each term from @xmath5 maps to a set @xmath6 of size @xmath7 . from experimental results ,",
    "we obtain a set @xmath8 and ask how likely it is to randomly pick @xmath1 entities whose sum of weights exceeds the sum @xmath9 .",
    "assume that the weights in @xmath0 come independently from a continuous probability space @xmath10 with the density function @xmath11 such that the moment generating function @xmath12 exists for @xmath13 in a neighborhood of 0 .",
    "the density of @xmath14 , sum of @xmath1 weights arbitrarily sampled from @xmath0 , can be expressed by the fourier inversion formula @xmath15 where @xmath16 denotes the cumulant generating function of @xmath11 .",
    "the tail probability or p - value for a score @xmath17 is given by @xmath18 we propose to use an asymptotic approximation to ( [ eqt : pval1 ] ) , which improves with increasing @xmath1 and @xmath17 .",
    "@xcite derived an asymptotic approximation for the density @xmath19 through saddlepoint expansion of the integral ( [ eqt : int3 ] ) while the corresponding approximation to the tail probability was obtained by @xcite .",
    "let @xmath20 and @xmath21 denote respectively the density and the tail probability of gaussian distribution .",
    "let @xmath22 be a solution of the equation @xmath23 then , the leading term of the lugananni - rice approximation to the tail probability takes the form @xmath24 where @xmath25 and @xmath26 .",
    "appropriate summary of derivation of ( [ eqt : tail ] ) is provided in supplementary materials .",
    "@xcite has shown that eq.([eqt : saddle1 ] ) has a unique simple root under most conditions and that @xmath27 increases with @xmath17 , with @xmath28 for @xmath29 where @xmath30 is the mean of @xmath10 .",
    "while the approximation ( [ eqt : tail ] ) is uniformly valid over the whole domain of @xmath11 , its components need to be rearranged for numerical computation near the mean . when @xmath31 , @xmath32 dominates and the overall error is @xmath33 @xcite .",
    "saddlesum , our implementation of lugananni - rice approximation for computing enrichment p - values , first solves eq.([eqt : saddle1 ] ) for @xmath22 using newton s method and then returns the p - value using ( [ eqt : tail ] ) .",
    "the derivatives of the cumulant generating function are estimated from @xmath0 : we approximate the moment generating function by @xmath34 , and then @xmath35 and @xmath36 . since the same @xmath0 is used to sequentially evaluate p - values of all terms in @xmath5 , we retain previously computed @xmath22 values in a sorted array .",
    "this allows us , using binary search , to reject many terms with p - values greater than a given threshold without running newton s method or to bracket the root of ( [ eqt : saddle1 ] ) for faster convergence .",
    "more details on the saddlesum implementation and evaluations of its accuracy against some well - characterized distributions are in section 2 of supplementary materials . when run as a term enrichment tool , saddlesum reports e - value for each significant term by applying bonferroni correction to the term s p - value .",
    "the assignment of human genes to go terms was taken from the ncbi gene2go file ( ftp://ftp.ncbi.nih.gov/gene/data/gene2go.gz ) downloaded on 07 - 02 - 2009 .",
    "after assigning all genes to terms , we removed all redundant terms  if several terms mapped to the same set of genes , we kept only one such term . for our statistical experiments we kept only the terms with no less than five mapped genes within the set of weights considered and hence the number of processed terms varied for each realization of sampling ( see below ) .",
    "@xcite is an implementation of the framework for exploring information flow in interaction networks @xcite .",
    "information flow is modeled through discrete time random walks with damping  at each step the walker has a certain probability of leaving the network .",
    "although  offers three modes : emitting , absorbing and channel , we only used the simplest , emitting mode , to provide examples illustrating issues of significance assignment .",
    "the emitting mode takes as input one or more network proteins , called sources , and a damping factor @xmath37 . for each protein node in the network",
    ", the model outputs the expected number of visits to that node by random walks originating from the sources , thus highlighting the network neighborhoods of the sources .",
    "the damping factor determines the average number of steps taken by a random walk before termination : @xmath38 corresponds to no termination while @xmath39 leads to no visits apart from the originating node . for our protein - protein interaction network examples",
    ", we used the set of all human physical interactions from the biogrid @xcite , version 2.0.54 ( july 2009 ) .",
    "the network consists of 7702 proteins and 56400 unique interactions .",
    "each interaction was represented by an undirected link .",
    "a link carries weight 2 if its two ends connect to the same protein and 1 otherwise .      from the ncbi gene expression omnibus ( geo )",
    "@xcite , we retrieved human microarray datasets with expression @xmath40 ratios ( weights ) provided , resulting in 34 datasets and 136 samples in total . for each sample , when multiple weights for the same gene were present , we took their mean instead .",
    "this resulted in a @xmath0 where each gene is assigned a unique raw weight . for evaluations",
    ", we also used another version of @xmath0 where negative weights were set to zero .",
    "this version facilitated investigation of up - regulation while keeping the down - regulated genes as part of statistical background .      by definition ,",
    "a p - value associated with a score is the probability of that score or better arising purely by chance .",
    "we tested the accuracy of reported p - values reported by enrichment methods via simulations on ` decoy ' databases , which contained only terms with random gene assignments . for each term from the decoy dataset and each set of weights based on network or microarray data , we recorded the reported p - value and thus built an empirical distribution of p - values . if a method reports accurate p - values , the proportion of runs , which we term empirical p - value , reporting p - values smaller than or equal to a p - value cutoff , should be very close to that cutoff .",
    "we show the results graphically by plotting on the log - log scale the empirical p - value as a function of the cutoff .    for each given list of entities @xmath3 , be it from the target gene set of a microarray dataset or the set of participating human proteins in the interaction network",
    ", we produced two types of decoy databases .",
    "the first type was based on go .",
    "we shuffled gene labels 1000 times .",
    "for each shuffle , we associated all terms from go with the shuffled labels to retain the term dependency .",
    "this resulted in a database with approximately @xmath41 terms ( 1000 shuffles times about 5000 go terms ) . in the second type , each term , having the same size @xmath1 , was obtained by sampling without replacement @xmath1 genes from @xmath3 .",
    "the databases from this type ( one for each term size considered ) contained exactly @xmath42 terms .",
    "the evaluation query set of 100 @xmath0 s from interaction networks was obtained by randomly sampling 100 proteins out of 7702 and running  with each protein as a single source .",
    "the weights for source proteins were not considered since they were prescribed , not resulting from simulation .",
    "each run used @xmath43 , without excluding any nodes from the network . for microarrays , the set of 136 samples was used . since both query sets are of size @xmath44 , the total number of @xmath0term matches was @xmath45 .",
    "similar to saddlesum , t - test approaches are based on sum - of - weights score but use the student s t - distribution to infer p - values .",
    "as before , let @xmath46 denote the weight associated with entity @xmath47 , let @xmath48 denote the set of @xmath1 entities associated with a term from vocabulary and let @xmath49 .",
    "for any set @xmath50 of size @xmath51 , let @xmath52 denote the mean weight of entities in @xmath53 and let @xmath54 be their sample variance .",
    "gage @xcite enrichment tool uses two sample t - test assuming unequal variances and equal sample sizes to compare the means over @xmath3 and @xmath48 .",
    "the test statistic is @xmath55 and the p - value is obtained from the upper tail of the student s t - distribution with degrees of freedom @xmath56 t - profiler @xcite compares the means over @xmath48 and @xmath57 using two sample t - test assuming equal variances but unequal sample sizes .",
    "the pooled variance estimate is given by @xmath58 and the test statistic is @xmath59 the t - profiler p - value is then obtained from the tail of the student s t - distribution with @xmath60 degrees of freedom .",
    "methods based on hypergeometric distribution or equivalently , fisher s exact test , use only rankings of weights and require selection of ` significant ' entities prior to calculation of p - value .",
    "we first rank all entities according to their weights and consider the set @xmath61 of @xmath62 entities with largest weights .",
    "the number @xmath62 can be fixed ( say 50 ) , correspond to a fixed percentage of the total number of weights , depend on the values of weights , or be calculated by other means .",
    "the score @xmath17 for the term @xmath48 is given by the size of the intersection , @xmath63 , between @xmath61 and @xmath48 .",
    "this is equivalent to setting @xmath9 with @xmath64 for @xmath65 and 0 otherwise .",
    "the p - value for score @xmath17 is @xmath66 hence , the p - value measures the likelihood of score @xmath17 or better over all possible ways of selecting @xmath62 entities out of @xmath3 , with @xmath1 entities associated with the term investigated .    in each of our p - value accuracy experiments we used two variants of the hypergeometric method , one taking a fixed percentage of nodes and the other taking into account the values of weights . for microarray datasets , the fist variant took 1% of available genes ( hgem - pn1 ) while the second select genes with four fold change or more ( hgem - f2 ) . in experiments based on protein networks",
    ", we took 3% of available proteins ( 231 entities ) for the first variant ( hgem - pn3 ) and used the participation ratio formula to determine @xmath62 in the second ( hgem - pr ) .",
    "participation ratio @xcite is given by the formula @xmath67 we chose a smaller percentage of weights for microarray - based data ( 1% vs 3% for data derived for networks ) because the microarray datasets generally contained measurement for more genes than the number of proteins in the network .",
    "instead of making a single , arbitrary choice of @xmath62 and applying hypergeometric score , mhg method implemented in the gorilla package @xcite considers all possible @xmath62 s .",
    "the mhg score is defined as @xmath68 where @xmath69 is the number of entities annotated by the term @xmath48 among the @xmath62 top - ranked entities . the exact p - value for mhg score is then calculated by using a dynamic programming algorithm developed by eden _",
    "_ @xcite . for our experiments we used an implementation in c programming language that was derived from the java implementation used by gorilla .",
    "the implementation uses a truncated algorithm that gives an approximate p - value with improved running speed .      to evaluate consistency of investigated methods",
    ", we compared the sets of significant terms retrieved from go using different numbers of nonzero weights as input . for each @xmath0 , we sort in descending order the weights associated with entities .",
    "with each @xmath62 selected , we kept @xmath62 largest weights unchanged and set the remaining to 0 to arrive at a modified set of weights @xmath71 .",
    "we did not totally exclude the lower weights but kept them under consideration to provide statistical background .",
    "we submitted @xmath71 for analysis and obtained from each statistical method a set of enriched terms ordered by their p - value . in fig.[fig : mainexamples1]a and supplementary fig.s3 , we displayed the actual five most significant terms retrieved with their p - values for selected examples of weight sets . to investigate on a larger scale the retrieval stability to @xmath62 changes",
    ", we computed for each method the overlap between sets of top ten terms from two different @xmath62 s for the @xmath0 sets mentioned in ` evaluating accuracy of p - values ' and then took the average ( fig.[fig : mainexamples1]b ) .",
    "we compared our saddlesum approach against the following existing methods : fisher s exact test ( hgem @xcite ) , two sample student s t - test with equal ( t - profiler @xcite ) and unequal ( gage @xcite ) variances , and mhg score @xcite . based on data from both microarrays and simulations of information flow in protein networks ,",
    "the comparison shown here encompassed ( in order of importance ) evaluation of p - value accuracy , ranking stability and running time .",
    "accurate p - value reflects the likelihood of a false identification and thus allows for comparison between terms retrieved even across experiments .",
    "incorrect p - values therefore render ranking stability and algorithmic speed pointless .",
    "accurate p - values without ranking stability question the robustness of biological interpretation . for pragmatic use of an enrichment method , even with accurate statistics and stability , it is still important to have reasonable speed",
    ".      the term p - value reported by an enrichment analysis method provides the likelihood for that term to be enriched within @xmath0 . to infer biological significance using statistical analysis ,",
    "it is essential to have accurate p - values .",
    "we analyzed the accuracy of p - values reported by the investigated approaches through simulating @xmath45 queries and comparing their reported and empirical p - values .",
    "results based on querying databases with fixed term sizes are shown in supplementary figs.s1 and s2 . shown in fig.[fig : stats1 ] are the results for querying go - based gene - shuffled term databases , which retain the structure of the original go as a mixture of terms of different sizes organized as a directed acyclic graph where small terms are included in larger ones .",
    "the curves for all methods in fig.[fig : stats1 ] therefore resemble a mixture of curves from supplementary figs.s1 and s2 albeit weighted towards smaller - sized terms .",
    "for weights from both network simulations and microarrays , saddlesum as well as the methods based on fisher s exact test ( hgem and mhg ) report p - values that are acceptable ( within one order of magnitude from the theoretical values ) . for hgem and mhg , this is not surprising because our experiments involved shuffling entity labels and hence followed the null model of the hypergeometric distribution . on the other hand , the null model of saddlesum and",
    "the t - test methods assumes weights drawn independently from some distribution ( sampling with replacement ) . for terms with few entities ( @xmath72 ) ,",
    "the difference between the two null models is minimal and the p - value accuracy assessment curves for saddlesum run as close to the theoretical line as those for hgem methods . for @xmath73",
    ", saddlesum gives more conservative p - values for terms with large sums of weights ( supplementary figs.s1 and s2 ) . in practice",
    ", this has no significant effect to biological inference .",
    "large terms would be still selected as significant given a reasonable p - value cutoff and accurate p - values are assigned to small terms that are biologically specific .",
    "two - sample t - test with unequal variances as used by gage package reports p - values so conservative that they are often larger than 0.01 and hence not always visible in our accuracy plots .",
    "this effect persists even for @xmath1 as large as 500",
    ". this might be because the number of degrees of freedom used is considerably small .",
    "in addition , its test statistic ( eq.([eq : ttst2 ] ) ) emphasizes the estimated within - term variance @xmath74 that is typically larger than the overall variance @xmath75 .    on the other hand ,",
    "t - profiler generally exaggerates @xcite significance because it uses the t - distribution with a large number of degrees of freedom ( @xmath76 ) .",
    "although some small terms may appear biologically relevant ( as in fig.[fig : mainexamples1 ] ) , one should not equate these exaggerated p - values with sensitivity . for microarray data , the @xmath40 ratios are almost symmetrically distributed about 0 ( supplementary fig.s4 ) .",
    "the distribution of their sum is close to gaussian .",
    "however , t - profiler still significantly exaggerates p - values for terms whose @xmath77 ( supplementary fig.s2 ) .",
    "the statistical accuracy of t - profiler worsens when negative @xmath40 ratios are set to 0 .",
    "the reason for doing so is that allowing weights within each term to cancel each other may not be biologically appropriate .",
    "go terms may cover a very general category where annotations may not always be available for more specific subterms .",
    "subsequently , terms may get refined and new terms may emerge .",
    "in such situation , it is desirable to discover terms that have genes that are significantly up - regulated even if many genes from the same term are down - regulated .",
    "p - value accuracy , although the most important criterion , measures only performance with respect to non - significant hits , that is , the likelihood of a false positive .",
    "it is also necessary to consider the quality of enrichment results in terms of the underlying biology .",
    "testing the quality directly , as described in the introduction , is not yet feasible .",
    "instead we evaluated internal consistency of each method with respect to the number of top - ranked entities used for analysis .",
    "fig.[fig : mainexamples1]a shows the change of p - values reported for the top five go terms with respect to the number of selected entities using two examples with weights respectively from network flow simulation and microarray .",
    "additional examples are shown in supplementary fig.s3 .",
    "results from evaluating the overall consistency of the best ten terms retrieved are shown in fig.[fig : mainexamples1]b .    both hgem and mhg methods are highly sensitive to the choice of @xmath62 , the number of entities deemed significant . with a small @xmath62 ,",
    "their sets of significant terms resemble the top terms obtained by saddlesum , while large values of @xmath62 render very small p - values for large - sized terms ( often biologically non - specific ) .",
    "this is mainly because hgem and mhg treat all selected significant entities as equally important without weighting down less significant entities , the collection of which may out vote the most significant ones .",
    "hence , although mhg considers all possible @xmath62 values , to obtain biologically specific interpretation , it might be necessary to either remove very large terms from the vocabulary or to impose an upper bound on @xmath62 . in that respect",
    ", mhg is very similar to the original gsea method @xcite , which also ignored weights .",
    "the authors of gsea noted that the genes ranked in middle of the list had disproportionate effect to their results and produced an improved version of gsea @xcite with weights considered .",
    "gage does not show strong consistency because many p - values it reports are too conservative and fall above the 0.01 threshold we used .",
    "consequently , the best overlap between various cutoffs is about 5 ( out of 10 ) for network flow examples and 4 for microarray examples",
    "( fig.[fig : mainexamples1]b ) .",
    "t - profiler shows great internal consistency .",
    "unfortunately , as shown in fig.[fig : stats1 ] , supplementary figs.s1 and s2 , it reports inaccurate p - values , especially for small terms .",
    "this is illustrated in the top panel of fig.[fig : mainexamples1]a , where t - profiler selects as highly significant the small terms ( with 5,6 and 9 entities ) , which are deemed insignificant by all other methods .",
    "the same pattern can be observed in supplementary fig.s3 , although the severity is tamed for microarrays . using weights for scoring terms , saddlesum is also stable with respect to the choice of @xmath62 but with accurate statistics .      in terms of algorithmic running time ( table  [ tbl : speed ] ) , parametric methods relying on normal or student s",
    "t - distribution require few computations .",
    "methods based on hypergeometric distribution , if properly implemented , are also fast . on the other hand ,",
    "non - parametric methods can take significant time if many shufflings are performed . based on dynamic programming",
    ", mhg method can also take excessive time for large terms .",
    "saddlesum has running time that is only slightly longer than that of parametric methods .    .running times of evaluated enrichment statistics algorithms ( in seconds ) .",
    "we queried go ten times with each of the five examined enrichment methods using weights from 100 network simulation results and 136 microarrays ( same datasets used for p - value accuracy experiments ) . running times for p - value calculations on dual - core 2.8 ghz amd opteron 254 processors ( using a single core for each run ) aggregated over all samples",
    "are shown on the left , while average times per query are shown on the right . the hgem method used 100-object cutoff .",
    "[ cols= \" < , > , > , > , > \" , ]",
    "approximating the distribution of sum of weights by saddlepoint method , our saddlesum is able to adapt itself equally well to distributions with widely different properties .",
    "the reported p - values have accuracy comparable to that of the methods based on the hypergeometric distribution while requiring no prior selection of the number of significant entities .",
    "while our results show that gage method suffers from reduced sensitivity , it should be noted that it forms only a part of gage algorithm .",
    "gage was designed to compare two groups of microarrays ( for example disease and control ) by obtaining an overall p - value . in that scheme ,",
    "the p - values we evaluated are used only for one - on - one comparisons between members of two groups . by combining one - on - one p - values ( which are assumed independent )",
    ", the overall p - value obtained by gage can become quite small .",
    "the assumed null distribution by t - profiler @xcite is close to gaussian .",
    "it has been commented @xcite that its statistics are similar to that of page @xcite , which uses z - test .",
    "naturally , the smallest , and likely exaggerated , p - values occur when evaluating small terms .",
    "for that reason , page does not consider terms with less than 10 entities , which we included in our evaluation solely for the purpose of comparison .",
    "our network simulation experiments produce very different weight profiles ( supplementary fig.s4 ) than that of microarrays .",
    "these weights are always positive and skewedly distributed . even after summing many such weights ,",
    "the distribution of the sum is still far from gaussian in the tail . therefore , t - profiler and gage are unable to give accurate statistics .",
    "overall , our evaluations clearly illustrate the inadequacy , even for large terms , of assuming nearly gaussian null distribution when the data is skewed .",
    "while central limit theorem does guarantee convergence to gaussian for large @xmath1 , the convergence may not be sufficiently fast in the tail regions , which influence the statistical accuracy the most .    as presented here",
    ", saddlesum uses given @xmath0 both for estimating the @xmath1-dependent score distribution and for scoring each term .",
    "if a certain distribution of weights are prescribed , it is possible to adapt our algorithm to take a histogram for that distribution as input and use experimentally obtained weights for scoring only .",
    "a possible way to improve biological relevance in retrieval is to allow for term - specific weight assignment .",
    "for example , a gene associated with a go term can be assigned a ` not ' qualifier to indicate explicitly that this gene product is not associated with the term considered .",
    "a way to use this information would be to change the sign of the weight for such a gene ( from positive to negative or vice versa ) , but only when scoring the terms where the qualifier applies .",
    "hence , potentially every term could be associated with a specific weight distribution .",
    "while all methods using weights can implement this scheme , saddlesum is particularly suitable for it because it handles well the small terms and skewed distributions , where changing the sign for a single weight can have a considerable effect .",
    "this procedure can be generalized so that each gene in a term carries a different weight .",
    "several authors @xcite have raised the issue of correlation between weights of entities : generally the weights of biologically related genes or proteins change together and therefore a null model assuming independence between weights may result in exaggerated p - values . in principle , a good null model is one that can bring out the difference between signal and noise .",
    "to what level of sophistication a null model should be usually is a trade - off between statistical accuracy and retrieval sensitivity . using protein sequence comparison for example ,",
    "ungapped alignment enjoys a theoretically characterizable statistics @xcite but is not as sensitive as the gapped alignment @xcite , where the score statistics is known only empirically because the null model allows for insertions and deletions of amino acids . incorporating insertion and deletion into the null model made all the difference in retrieval sensitivity .",
    "this is probably because insertions / deletions do occur abundantly in natural evolution of protein sequences .",
    "the ignorance of protein sequence correlations , assumed by both ungapped and gapped alignments , does not seem to cause much harm in retrieval efficacy .",
    "although saddlesum assumes weight independence and thus bears the possibility of exaggerating statistical significance of an identified term , it mitigates this issue by incorporating the entire @xmath0 in the null distribution .",
    "it includes the entities with extreme weights that clearly represent ` signal ' and not ` noise ' , bringing higher the tail of the score distribution and thus larger p - values .",
    "indeed , as shown by examples in fig.[fig : mainexamples1]a and supplementary fig.s3 , saddlesum does not show unreasonably small p - values .",
    "it should also be noted that saddlesum is designed for the simple case where a summary value is available for each entity considered  its use for analyzing complex microarray experiments with many subjects divided into several groups is beyond the scope of this paper and care must be exercised when using it in this context .",
    "saddlesum is a versatile enrichment analysis method .",
    "researchers are free to process appropriately their experimental data , produce a suitable @xmath0 as input , and receive accurate term statistics from saddlesum .",
    "since it does not make many assumptions about the distribution of data , we foresee a number of additional applications not limited to genomics or proteomics , for example to literature searches .",
    "this work was supported by the intramural research program of the national library of medicine at national institutes of health .",
    "this study utilized the high - performance computational capabilities of the biowulf linux cluster at the national institutes of health , bethesda , md .",
    "( http://biowulf.nih.gov ) .",
    "we thank john wootton and david landsman for useful comments , roy navon for providing us with the java source code for the statistical algorithms of gorilla , weijun luo for his help with using gage package and the anonymous referees for comments that helped improve the first version of this paper .",
    "al - shahrour , f. _ et  al . _",
    "( 2007 ) . from genes to functional classes in the study of biological systems . , * 8 * , 114 .",
    "altschul , s.  f. _ et  al . _",
    "gapped blast and psi - blast : a new generation of protein database search programs .",
    ", * 25 * , 33893402 .    ashburner , m. _ et  al . _ ( 2000 ) . gene ontology : tool for the unification of biology . the gene ontology consortium . , * 25 * , 2529 .",
    "backes , c. _ et  al . _",
    "( 2007 ) . advanced gene set enrichment analysis .",
    ", * 35*(web server issue ) , w186192 .",
    "barrett , t. _ et  al . _",
    "( 2009 ) . .",
    ", * 37*(database issue ) , d885890 .",
    "ben - shaul , y. _ et  al . _",
    "( 2005 ) . identifying subtle interrelated changes in functional gene categories using continuous measures of gene expression . , *",
    "21*(7 ) , 11291137 .",
    "benjamini , y. and hochberg , y. ( 1995 ) . controlling the false discovery rate : a practical and powerful approach to multiple testing .",
    ", * 57 * , 289300 .",
    "bleistein , n. ( 1966 ) .",
    "uniform asymptotic expansions of integrals with stationary points and algebraic singularity . , * 19 * , 353370 .",
    "blom , e .-",
    "_ et  al . _",
    "( 2007 ) . : functional information viewer and analyzer extracting biological knowledge from transcriptome data of prokaryotes . , * 23*(9 ) , 11611163 .",
    "boorsma , a. _ et  al . _",
    ": scoring the activity of predefined groups of genes using gene expression data .",
    ", * 33*(web server issue ) , w592595 .",
    "boyle , e.  i. _ et  al . _",
    "open source software for accessing gene ontology information and finding significantly enriched gene ontology terms associated with a list of genes . ,",
    "* 20 * , 37103715 .",
    "breitkreutz , b. _ et  al . _",
    "( 2008 ) . .",
    ", * 36*(database issue ) , d637640 .",
    "breitling , r. _ et  al . _",
    "iterative group analysis ( iga ) : a simple tool to enhance sensitivity and facilitate interpretation of microarray experiments .",
    ", * 5 * , 34 .",
    "breslin , t. _ et  al . _",
    "( 2004 ) . comparing functional annotation analyses with catmap . , * 5 * , 193 .",
    "daniels , h.  e. ( 1954 ) .",
    "saddlepoint approximations in statistics . , * 25 * , 631650 .",
    "daniels , h.  e. ( 1987 ) . tail probability approximations . , * 55*(1 ) , 3748 .",
    "eden , e. _ et  al . _",
    "discovering motifs in ranked lists of dna sequences .",
    ", * 3*(3 ) , e39 .",
    "eden , e. _ et  al . _",
    "( 2009 ) . : a tool for discovery and visualization of enriched go terms in ranked gene lists . ,",
    "* 10 * , 48 .",
    "goeman , j. and bhlmann , p. ( 2007 ) . . ,",
    "* 23*(8 ) , 980987 .    gold , d. _ et  al . _",
    "( 2007 ) . .",
    ", * 8*(2 ) , 7177 .",
    "hochberg , y. and tamhane , a.  c. ( 1987 ) . .",
    "huang , d.  w. _ et  al . _",
    "bioinformatics enrichment tools : paths toward the comprehensive functional analysis of large gene lists . , * 37*(1 ) , 113 .",
    "jensen , j.  l. ( 1995 ) . .",
    "clarendon press , oxford .",
    "karlin , s. and altschul , s.  f. ( 1990 ) .",
    "methods for assessing the statistical significance of molecular sequence features by using general scoring schemes . , * 87 * , 22642268 .",
    "kim , s .- y . and volsky , d.  j. ( 2005 ) .",
    ": parametric analysis of gene set enrichment . , * 6 * , 144 .",
    "lugannani , r. and rice , s. ( 1980 ) .",
    "saddle point approximation for the distribution of the sum of independent random variables .",
    ", * 12*(2 ) , 475490 .",
    "luo , w. _ et  al . _",
    ": generally applicable gene set enrichment for pathway analysis . , * 10 * , 161 .",
    "mootha , v.  k. _ et  al . _",
    "genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes . , *",
    "34*(3 ) , 267273 .    press , w.  h. _ et  al . _",
    "( 2007 ) . .",
    "cambridge university press , 3 edition .",
    "sharma , k. _ et  al . _",
    "proteomics strategy for quantitative protein interaction profiling in cell extracts .",
    "* 6*(10 ) , 741744 .    smid , m. and dorssers , l. c.  j. ( 2004 ) .",
    ": functional analysis of gene expression data using the expression level as a score to evaluate gene ontology terms .",
    ", * 20*(16 ) , 26182625 .",
    "stojmirovi , a. and yu , y .- k .",
    "information flow in interaction networks .",
    ", * 14*(8 ) , 11151143 .",
    "stojmirovi , a. and yu , y .- k .",
    ": analyzing information flow in protein networks .",
    ", * 25*(18 ) , 24472449 .",
    "subramanian , a. _ et  al . _",
    "gene set enrichment analysis : a knowledge - based approach for interpreting genome - wide expression profiles . , *",
    "102*(43 ) , 1554515550 .",
    "sultan , m. _ et  al . _",
    "( 2008 ) . a global view of gene activity and alternative splicing by deep sequencing of the human transcriptome . ,",
    "* 321*(5891 ) , 956960 .",
    "wood , a. t.  a. _ et  al . _",
    "saddlepoint approximations to the cdf of some statistics with nonnormal limit distributions . , *",
    "88*(422 ) , 680686 .",
    "references about saddlepoint approximations of the tail probabilities of random variables are abundant @xcite . for completeness of our exposition",
    "we here present the derivation of the lugannani - rice formula @xcite , relying extensively on expositions by daniels @xcite and woods , booth and butler @xcite .",
    "let @xmath78 be a continuous random variable supported on a subset of @xmath79 .",
    "we will assume that its probability density function ( pdf ) , denoted by @xmath80 exists and that its moment generating function ( mgf ) , defined by @xmath81 converges for real @xmath82 $ ] where @xmath83 .",
    "recall that @xmath84 gives the characteristic function of @xmath78 , that is , the fourier transform of @xmath80 and that @xmath80 can hence be recovered by the fourier inversion formula : @xmath85 where @xmath86 denotes the cumulant generating function ( cgf ) of @xmath78 .",
    "the tail probability or p - value for a value @xmath87 ( with respect to @xmath78 ) , which we will denote by @xmath88 can be expressed as @xmath89 where @xmath90 is a constant introduced to avoid the pole at @xmath91 .",
    "let @xmath14 denote the sum of @xmath1 independent , identically distributed random variables .",
    "we write @xmath92 , where @xmath93 for all @xmath94 .",
    "our goal is to derive an asymptotic approximation for the tail probability @xmath95 .",
    "it can be easily shown that @xmath96 and hence by ( [ eq : inv_formula2 ] ) @xmath97 to produce our approximation we note that the main contributions to the integral ( [ eq : inv_formula2 ] ) occur in the neighborhood of the pole at @xmath91 and in the neighborhood of the saddle point @xmath98 where the exponent @xmath99 has a maximum , that is , where @xmath100 . the saddlepoint condition is thus @xmath101 or alternatively @xmath102 let @xmath103 denote the expectation of @xmath78 .",
    "daniels @xcite has shown that eq.([eq : saddle1 ] ) has a unique simple root under most conditions . the value of @xmath27 increases with @xmath104 , with @xmath105 .    when @xmath106 , the contribution of the pole at @xmath91 to ( [ eq : inv_formula2 ] ) is very small and to obtain an asymptotic approximation to @xmath95 one can proceed by expanding @xmath107 as a taylor s series about @xmath108 and integrating the resulting integral term - by - term @xcite . however , as @xmath104 gets closer to the mean @xmath109 , such approximation performs poorly and in fact is unbounded at the mean .",
    "the essence of the method of @xcite as applied to @xmath95 by lugannani and rice @xcite is to produce a transformation of the integral ( [ eq : inv_formula2 ] ) that would take into account the pole and hence to produce an approximation uniformly valid over the whole range of @xmath14 .",
    "make a transformation from @xmath13 to a new variable @xmath110 by @xmath111 where @xmath112 denotes the gaussian random variable with pdf @xmath113 and @xmath114 and @xmath104 satisfies ( [ eq : saddle1 ] ) . the value @xmath115 is chosen so that the minimum of the left side is equal to the minimum of the right side , which occurs when @xmath98 . since @xmath116 , eq .",
    "( [ eq : transform1 ] ) becomes @xmath117 to find @xmath115 , we set @xmath118 and @xmath108 in ( [ eq : transform2 ] ) to get @xmath119 or , taking the sign for @xmath115 to be equal to the sign of @xmath27 , @xmath120    the transformation ( [ eq : transform2 ] ) maps the region @xmath121 $ ] in @xmath13-space into the region @xmath122 $ ] in @xmath110-space .",
    "the local behavior of @xmath123 , which vanishes at @xmath91 and has zero derivative at @xmath108 is reproduced by @xmath124 with similar behavior at @xmath125 and @xmath118 .",
    "let @xmath126 .",
    "then , @xmath127 expanding @xmath128 about @xmath108 we have @xmath129 where @xmath130 and @xmath131 .",
    "hence , @xmath132 it follows that @xmath133 and @xmath134 are nonzero for all @xmath135 $ ] and @xmath136 $ ] , respectively .",
    "since @xmath137 is analytic in the region of interest , @xmath138 and @xmath139 are analytic over the same intervals .",
    "obviously , the same conclusion follows for @xmath110 as a function of @xmath13 and @xmath13 as a function of @xmath110 . by the inverse function theorem ,",
    "the transformation @xmath140 can be extended to a bijection between complex neighborhoods of @xmath121 $ ] and @xmath122 $ ] .",
    "the integral ( [ eq : inv_formula2 ] ) now transforms ( using cauchy s theorem ) into @xmath141 where @xmath142 . for small @xmath13 , we can write @xmath143 when @xmath144 and hence @xmath145 , differentiating ( [ eq : transform2 ] ) we obtain @xmath146 while when @xmath147 , ( [ eq : expansion1 ] ) implies @xmath148 when @xmath13 is small . thus , @xmath149 and therefore , for small @xmath13 , @xmath150 where @xmath151 is a constant .",
    "let @xmath152 by expanding @xmath128 about @xmath91 , it can be shown that , @xmath153 and , since @xmath154 is analytic , @xmath155 is analytic in the neighborhood of @xmath125 that includes @xmath115 . therefore , we can rewrite the integral ( [ eq : inv_formula3 ] ) as @xmath156 the singularity has now been isolated into ( [ eq : inv_formula4 ] ) , which , by comparing with ( [ eq : inv_formula2 ] ) , we recognize to equal @xmath157 .",
    "on the other hand , @xmath155 can be expanded as a taylor s series around the saddlepoint @xmath118 and integrated to obtain an asymptotic series for ( [ eq : inv_formula5 ] ) .",
    "for the first - order approximation , that is , the leading behavior , we only take the constant term at @xmath115 .",
    "let @xmath158 then , @xmath159 and the integral ( [ eq : inv_formula5 ] ) becomes @xmath160 thus , we have obtained the lugananni - rice formula : @xmath161 with @xmath162 given by ( [ eq : saddle1 ] ) and ( [ eq : hatz2 ] ) .",
    "as mentioned in the main text , our saddlesum algorithm approximates term p - values by first solving eq.([eq : saddle1 ] ) for @xmath22 using newton s method and then using the lugananni - rice formula ( [ eq : tail ] ) .",
    "the key step is estimation of @xmath27 .",
    "since the moment - generating function @xmath163 of the underlying space @xmath10 is not known , we estimate it ( and its derivatives ) using @xmath0 . given sufficiently many weights ( @xmath164 )",
    ", the results can be quite accurate ( see below ) .",
    "one limitation of this approach is that our approximation can only accept scores not greater than @xmath1 times maximal weight ( @xmath27 becomes infinite at this bound ) .",
    "thus , the approximation can be inaccurate for very large scores , causing a larger than usual relative error in p - values ( fig .",
    "however , occurence of such extreme scores is rarely seen in practice .",
    "theoretically , lugananni - rice formula is valid over the whole range of the distribution , for small and large scores and both near the mean and in the tails @xcite .",
    "however , the form ( [ eq : tail ] ) becomes numerically unstable close to the mean of the distribution ( i.e. when @xmath27 is close to 0 ) .",
    "alternative asymptotic approximations exist that are numerically stable near the mean @xcite . for saddlesum , we were mainly interested in the tail probabilities and we therefore decided not to attempt to approximate the p - values of the scores smaller than one standard deviation from the mean ( saddlesum returns p - value of 1 for all such scores ) .",
    "terms with such scores are never significant in the context of enrichment analysis .",
    "when processing a terms database , we retain previously computed values of @xmath27 with associated scores and parameters for lugananni - rice formula in a sorted array . since @xmath27 and the p - value are monotonic with respect to the score , using binary search we can certify for many terms that their p - value is larger than a given cutoff and hence eliminate them without running newton s method .",
    "furthermore , binary search provides a bracket for @xmath27 and hence newton s method usually converges in very few iteration .",
    "we use the bracketed version of newton s method recommended in the numerical recipes book @xcite ( section 9.4 ) .",
    "this combines the classical newton s method with bisection and has guaranteed global convergence .",
    "we show evaluations of saddlesum performance against some theoretically well - characterized distributions in fig .",
    "s5 and s6 .",
    "it can be seen that the relative error between the saddlesum approximation and the theoretical p - value is generally very small except for extremely large scores , when p - values are very small . in the context of the enrichment analysis ,",
    "this discrepancy is not important because such terms will be evaluated as highly significant even if the p - value is off by few orders of magnitude . to further illustrate the quality of our approximation ,",
    "we have computed the kullback - leibler ( kl ) divergences ( relative entropies ) between the tail distribution implied by saddlesum and the theoretical distribution .",
    "prior to computation of kl divergence , both distributions were normalized over the region where saddlesum is valid ( i.e. the tail with scores larger than one standard deviation over the mean ) .",
    "all kl divergence values are extremely small and are comparable between distributions .",
    "s7 shows relative errors of saddlesum compared to the empirical distributions using the same weights and term sizes as for fig .",
    "s1 and s2 . in this case",
    "however , in agreement with the null model of saddlesum , we sampled weights with replacement .",
    "our results indicate that , except for small @xmath1 with weights coming from network flow simulations , the relative error of the saddlesum is similar to that obtained in comparison with well - characterized distributions ."
  ],
  "abstract_text": [
    "<S> term enrichment analysis facilitates biological interpretation by assigning to experimentally / computationally obtained data annotation associated with terms from controlled vocabularies . </S>",
    "<S> this process usually involves obtaining statistical significance for each vocabulary term and using the most significant terms to describe a given set of biological entities , often associated with weights . </S>",
    "<S> many existing enrichment methods require selections of ( arbitrary number of ) the most significant entities and/or do not account for weights of entities . </S>",
    "<S> others either mandate extensive simulations to obtain statistics or assume normal weight distribution . </S>",
    "<S> in addition , most methods have difficulty assigning correct statistical significance to terms with few entities .      implementing the well - known lugananni - rice formula , </S>",
    "<S> we have developed a novel approach , called saddlesum , that is free from all the aforementioned constraints and evaluated it against several existing methods . with entity weights properly taken into account , </S>",
    "<S> saddlesum is internally consistent and stable with respect to the choice of number of most significant entities selected . making few assumptions on the input data , the proposed method is universal and can thus be applied to areas beyond analysis of microarrays . employing asymptotic approximation , saddlesum provides a term - size dependent score distribution function that gives rise to accurate statistical significance even for terms with few entities . as a consequence </S>",
    "<S> , saddlesum enables researchers to place confidence in its significance assignments to small terms that are often biologically most specific .      </S>",
    "<S> our implementation , which uses bonferroni correction to account for multiple hypotheses testing , is available at http://www.ncbi.nlm.nih.gov / cbbresearch / qmbp / mn / enrich/. source code for the standalone version can be downloaded from ftp://ftp.ncbi.nlm.nih.gov / pub / qmbpmn / saddlesum/.      yyu@ncbi.nlm.nih.gov    * robust and accurate data enrichment statistics via distribution function of sum of weights *    aleksandar stojmirovi and yi - kuo yu    .2 in national center for biotechnology information + national library of medicine + national institutes of health + bethesda , md 20894 + united states </S>"
  ]
}