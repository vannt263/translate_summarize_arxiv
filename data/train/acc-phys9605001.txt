{
  "article_text": [
    "in order to maximize the number of collisions of stored particles in a storage ring system one tries to maximize the total number of particles in the bunches and tries to minimize the emittances so that the particle distribution across phase space is narrow and the phase space density is high . at equilibrium",
    "the phase space distribution does not change in time and is therefore periodic in the machine azimuth .",
    "if , in addition , the beam is spin polarized , one requires that the polarization is high .",
    "as first emphasized by d. barber @xcite , for energies of the order of 1tev , a fundamental limitation to the polarization of particle beams becomes important .",
    "to put our work in context we repeat the arguments here .    spins traveling with particles in electromagnetic fields precess according to the thomas  bargmann  michel  telegdi equation ( t  bmt ) to be discussed below .",
    "the guide fields in storage rings are produced by dipole and quadrupole magnets .",
    "the dipole fields constrain the particles to almost circular orbits and the quadrupole fields focus the beam , thus ensuring that the particles do not drift too far away from the central orbit .    in horizontal dipoles ,",
    "spins precess only around the vertical field direction .",
    "the quadrupoles have vertical and horizontal fields and additionally cause the spins to precess away from the vertical direction .",
    "the strength of the spin precession and the precession axis in machine magnets depends on the trajectory and the energy of the particle .",
    "thus in one turn around the ring the effective precession axis can deviate from the vertical and will depend on the initial position of the particle in six dimensional phase space . from this",
    "it is clear that if an equilibrium spin distribution exists , i.e. if the polarization vector at every phase space point is periodic in the machine azimuth , it will vary across the orbital phase space .",
    "this field of equilibrium spin directions in phase space does not change from turn to turn when particles propagate through the accelerator , although after each turn the particles find themselves at new positions in phase space .",
    "these directions , which we denote by the unit vector @xmath1 , where @xmath2 denotes the position in the six dimensional phase space of the beam and @xmath3 is the generalized azimuth , was first introduced by derbenev and kondratenko @xcite in the theory of radiative electron polarization . note that @xmath4 is usually not an eigenvector of the spin transfer matrix at some phase space point since the spin of a particle changes after one turn around the ring , but the eigenvector would not change .",
    "thus once we know this direction @xmath1 , the phase space dependent polarization @xmath5 in this direction , and the phase space density function @xmath6 we have a complete specification of the polarization state of a beam of spin @xmath7 particles .",
    "the maximizing of the polarization of the ensemble implies two conditions ; the polarization @xmath5 at each point in phase space should be high and the polarization vector @xmath8 at each point should be almost parallel to the average polarization vector of the beam .    according to the t  bmt equation ,",
    "the rate of spin precession is roughly proportional to @xmath9 where @xmath10 is the anomalous part of the spin @xmath11 factor and @xmath12 is the lorentz factor . at very high energy , as for example in the hera proton ring @xcite , it could happen that on average @xmath13 deviates by tens of degrees from the phase space average of @xmath14 .",
    "thus even if each point in phase space were @xmath15 polarized the average polarization could be much smaller than @xmath15 .",
    "clearly it is very important to have accurate and efficient methods for calculating @xmath1 and for ensuring that the spread of @xmath1 is as small as possible .",
    "however , although it has been straightforward to define @xmath16 , this vector is not easy to calculate in general and much effort has been expended on this topic , but mainly for electrons at energies up to 46gev .",
    "except for the fourier expansion formalism introduced in @xcite , all other methods developed so far are explicitly perturbative , and either do not go to high enough order @xcite or have problems with convergence at high order and high energy @xcite .",
    "in this paper we describe a new method for obtaining @xmath17 .",
    "it is based on multi ",
    "turn tracking and the averaging of the spin viewed stroboscopically from turn to turn . since this innovative approach only requires tracking data , it is fast and very easy to implement in existing tracking codes .",
    "we will show that the convergence speed promises rather quick execution when simulating realistic accelerators",
    ". however , probably the main advantage over other methods is the fact that stroboscopic averaging does not have an inherent problem with either orbit or spin orbit resonances due to its non - perturbative nature .",
    "this allows the behavior of the periodic spin solution close to resonances to be analyzed .",
    "the motion of the spin of particles traveling in electromagnetic fields is governed by the equations of motion    @xmath18    here @xmath3 is an independent variable parametrizing the @xmath19 dimensional particle phase space trajectory @xmath20 and the spin trajectory @xmath21 . in circular accelerators @xmath3 is the azimuth .",
    "the rest frame spin vector @xmath22 has @xmath23 components and we normally deal with orbital phase space vectors @xmath2 which have @xmath24 components . in accelerator physics",
    "these components are usually the positions and momenta of a particle combined with its energy and the time of flight .",
    "we are neglecting the stern  gerlach forces since they are very small in comparison with the lorentz force .",
    "equation ( [ eq : spindgl ] ) is the thomas  bmt equation along an orbit parametrized by @xmath20 @xcite . because we deal with a circular accelerator at fixed energy , @xmath25 and @xmath26 , which depend on the guide fields , are periodic in @xmath3 with period @xmath27 corresponding to the circumference of the ring . due to",
    "the precession equation ( [ eq : spindgl ] ) the length of the spin vector @xmath22 does not change along the azimuth .    the dynamical system ( [ eq : orbdgl],[eq : spindgl ] )",
    "allows to formulate the following partial differential equation for the evolution of a _ field _",
    "@xmath28 : @xmath29 where the three components of the solution @xmath30 depend on @xmath2 and @xmath3 . in our applications",
    "@xmath30 will describe the propagation of a spin distribution associated with a particle beam and this physical interpretation can be adopted because of the following",
    ". a solution @xmath28 to equation ( [ eq : fdgl ] ) can be found by specifying an arbitrary @xmath31 at initial azimuth @xmath32 and propagating it to @xmath3 by integrating equations ( [ eq : orbdgl ] ) and ( [ eq : spindgl ] ) .",
    "in fact @xmath33 solves equation ( [ eq : spindgl ] ) if @xmath30 solves equation ( [ eq : fdgl ] ) .",
    "we say that @xmath30 is normalized if @xmath34 we call every normalized solution of equation ( [ eq : fdgl ] ) a ` spin field ' .",
    "the ` @xmath14-axis ' introduced in the introduction is a special spin field which is periodic in @xmath3 with period @xmath27 @xcite : @xmath35 since equation ( [ eq : spindgl ] ) represents a pure rotation the propagation of the spin vector can be described by a @xmath36 orthogonal matrix .",
    "we denote this rotation matrix which propagates initial spins @xmath37 along a given orbit trajectory @xmath38 by @xmath39 so that @xmath40 because for a spin field @xmath30 the spin trajectory ( [ eq : sf ] ) solves equation ( [ eq : spindgl ] ) , we get @xmath41 if @xmath28 is a spin field , then @xmath42 is a spin field ( @xmath43= integer ) .",
    "this follows from equation ( [ eq : fdgl ] ) because @xmath44 and @xmath45 are periodic in @xmath3 .",
    "thus equation ( [ eq : ftrans1 ] ) generalizes to @xmath46 since an @xmath14-axis is a periodic spin field , we observe by ( [ eq : period ] ) and ( [ eq : ftransm ] ) that @xmath47 alternatively this equation can be used for defining the @xmath14-axis @xcite .",
    "the matrix + @xmath48 is called the one turn spin transfer matrix for the trajectory @xmath20 .    in the special case where the orbital motion is determined by a hamiltonian",
    "we have @xmath49 where @xmath50 denotes the orbital hamiltonian . furthermore in this case",
    "one can define for the whole spin ",
    "orbit system a hamiltonian given by @xcite @xmath51 where @xmath52 the poisson brackets of this hamiltonian lead to equations ( [ eq : orbdgl ] ) and ( [ eq : spindgl ] ) if the stern  gerlach forces are neglected @xcite .",
    "to find solutions of equation ( [ eq : fdgl ] ) which are periodic in @xmath3 by our new method , one first constructs an arbitrary spin field @xmath30 .",
    "one then constructs the following ` stroboscopic average ' of @xmath30 : @xmath53\\ .",
    "\\label{eq : faver}\\ ] ] since the convergence and differentiability of the sequence in ( [ eq : faver ] ) can in general not be guaranteed , the limit is only taken formally .",
    "the problem of the convergence will be analyzed in more detail in section [ ssec : conv ] . from ( [ eq : faver ] ) it follows that @xmath54 is formally periodic in @xmath3 . moreover , because ( [ eq : fdgl ] ) is a linear equation and because @xmath44 and @xmath45 are periodic in @xmath3 we observe for any spin field @xmath30 that @xmath54 is formally also a solution of equation ( [ eq : fdgl ] ) .",
    "hence we come to a first conclusion :    * if @xmath30 is a spin field , then @xmath54 is a solution of equation ( [ eq : fdgl ] ) which is periodic in @xmath3 .",
    "if for @xmath30 the stroboscopic average @xmath54 vanishes nowhere in the @xmath55 dimensional space , then we define @xmath56 in general @xmath54 is not normalized , but the modulus of @xmath54 is conserved and @xmath57 is a spin field which is periodic in @xmath3 .",
    "hence we come to the following second conclusion of this section :    * if @xmath30 is a spin field with the property that @xmath54 vanishes nowhere in the @xmath55 dimensional space , then @xmath58 has all the properties of an @xmath14-axis .",
    "this result shows that an @xmath14-axis can be obtained from a spin field @xmath30 for which @xmath54 vanishes nowhere . in the next section",
    "we will derive a tracking algorithm based on this .",
    "one practical choice of @xmath30 is characterized for all @xmath2 by @xmath59 where @xmath60 denotes the so called closed orbit spin axis defined by @xmath61 where @xmath62 is the closed orbit .",
    "in this section we develop a tracking algorithm which provides an efficient way to evaluate an @xmath14-axis at @xmath63 . choosing a spin field @xmath30 and replacing @xmath32 by @xmath64 in equation ( [ eq : ftransm ] )",
    "we get for every integer @xmath43",
    "@xmath65 if we choose an orbit with @xmath66 , then inserting this into equation ( [ eq : faver ] ) results in @xmath67\\ .",
    "\\label{eq : aver}\\ ] ] normalization of @xmath54 yields an @xmath14-axis at @xmath68 .    to apply the tracking algorithm , the infinite sum involved in the stroboscopic average ( [ eq : aver ] ) is replaced by a finite sum of @xmath69 terms so that we approximate @xmath70 which yields the following approximation of the @xmath14-axis @xmath71 the stroboscopic average @xmath72 in equation ( [ eq : favern ] ) has a very simple physical interpretation which illustrates its practical importance .",
    "if a particle beam is approximated by a phase space density , disregarding its discrete structure , then we can associate a spin field @xmath31 with the particle beam at the azimuth @xmath32 .",
    "if one installs a point like ` gedanken ' polarimeter at a phase space point @xmath73 and azimuth @xmath32 , then this polarimeter initially measures @xmath74 .",
    "when the particle beam passes the azimuth @xmath32 after one turn around the ring , the polarimeter measures @xmath75 after the beam has traveled around the storage ring @xmath76 times and the polarization has been measured whenever the beam passed the ` gedanken ' polarimeter , one only has to average over the different measurements in order to obtain @xmath72 . if the particles of a beam are polarized parallel to @xmath77 at every phase space point , then the spin field of the beam is invariant from turn to turn due to the periodicity property in equation ( [ eq : period ] ) .",
    "but in addition , even for beams which are not polarized parallel to @xmath14 , we see that the polarization observed at a phase space point @xmath2 and azimuth @xmath32 is still parallel to @xmath77 , if one averages over many measurements taken when the beam has passed the azimuth @xmath32 .    for the special choice @xmath78 we can simplify @xmath72 to @xmath79 equations ( [ eq : favern ] ) and ( [ eq : nfnaver ] ) define an algorithm for obtaining an @xmath14-axis .",
    "we see that the only information needed from tracking is the set of the @xmath69 phase space points @xmath80 and the @xmath76 matrices @xmath81 .",
    "each matrix is a product of one turn spin transfer matrices @xmath82 .",
    "this means that one tracks along the orbit @xmath20 to obtain the spin transfer matrix @xmath83 and stores it at the @xmath76 instants , where @xmath84 .",
    "the function @xmath85 is chosen independently of the tracking results ( for example one can take the choice @xmath86 of equation ( [ eq : fnzero ] ) and ( [ eq : avfnzero ] ) ) .    the following two kinds of pathologies can occur :    * the @xmath14-axis is not unique : if the proposed algorithm converges , then the result could depend on the choice of @xmath87 .",
    "* the stroboscopic average @xmath54 vanishes for @xmath88 or the sequence in equation ( [ eq : faver ] ) does not converge .",
    "both pathologies can be studied with the algorithm .",
    "the first situation occurs for systems on spin  orbit resonances @xcite . in all examples",
    "studied so far , the stroboscopic average seems to converge , implying the existence of an @xmath14-axis . in the second situation , the point like polarimeter at @xmath89 mentioned above monitors an averaged polarization which either vanishes or fluctuates indefinitely .",
    "in the previously outlined formalism for evaluating an @xmath14-axis by stroboscopic averaging it became apparent that only knowledge about one turn spin transfer matrices is required .",
    "one can therefore reformulate the algorithm of section [ sec : algo ] in terms of one turn maps which are to be taken at a fixed but arbitrary azimuth value @xmath32 and thereby obtain a more practical algorithm .",
    "thus we introduce the one turn orbit transfer map @xmath90 which maps initial coordinates @xmath91 into final coordinates @xmath92 .",
    "then in our notation we have @xmath93 . to describe the transport of particles with spins @xmath22 , we write for simplification the one turn spin transfer matrix @xmath82 as @xmath94 so that we have @xmath95 .",
    "all other quantities which depend on @xmath3 are taken at the specified azimuth @xmath32 . for simplification ,",
    "this azimuth is not indicated in the following .",
    "as already mentioned , equation ( [ eq : nperiod ] ) can be used to define @xmath14-axes at @xmath32 .",
    "this condition will be called the periodicity condition and now reads @xmath96      to illustrate the process of evaluating an @xmath14-axis at @xmath89 and @xmath32 in the case of linear orbit motion , we establish a recipe .    1 .",
    "compute the linearized one turn phase space transfer map @xmath97 .",
    "2 .   define the set of @xmath69 phase space points @xmath98 3 .",
    "compute the rotation matrix @xmath99 which describes the spin motion for particles on the closed orbit @xmath100 and extract the corresponding rotation vector @xmath101 .",
    "this is the periodic spin solution for particles on the closed orbit .",
    "4 .   starting with a spin parallel to @xmath101 at every phase space point in @xmath102 , track until the phase space point @xmath89 is reached . for a given @xmath103",
    "this requires tracking @xmath103 turns starting at @xmath104 .",
    "5 .   define the set of spin tracking results as @xmath105 6 .",
    "define the sum of the elements in @xmath106 as @xmath107 and for @xmath108 define @xmath109 .",
    "the vector @xmath110 is equivalent to @xmath111 in section [ sec : algo ] , if the initial distribution of spins is given by @xmath112 as in equation ( [ eq : avfnzero ] ) .",
    "it will now be shown that if the angle between @xmath101 and @xmath113 is smaller than some positive number @xmath114 for all @xmath115 , then @xmath116 satisfies the periodicity condition ( [ eq : per ] ) for the @xmath14-axis up to an error which is smaller or equal to @xmath117 . since evaluating @xmath106 by the recipe of section [ ssec : rec1 ]",
    "requires tracking @xmath118 turns , the accuracy is bounded by @xmath119 .",
    "this slow convergence with the square root of @xmath120 is a very serious limitation and in the next section we will demonstrate how the convergence can be considerably improved .",
    "the proof of this convergence property goes along the following lines .",
    "the average @xmath121 has been defined by @xmath122 here we adopt the convention @xmath123 and @xmath124 is taken to mean the following order of multiplication : @xmath125 . to check",
    "how well @xmath126 satisfies the periodicity conditions ( [ eq : per ] ) of the @xmath127-axis we calculate @xmath128    ( 0,0)(0,0 ) ( -4.5,-5.35 ) @xmath129 ( -4.5,-1.0 ) @xmath101 ( -7.7,-1.15 ) @xmath130    the length @xmath131 is smaller than @xmath130 as shown in figure [ fg : convergence ] .",
    "the length of @xmath121 is at least @xmath132 ; and here it becomes essential that there is limit of @xmath133 on the angle @xmath129 .",
    "this information is sufficient to establish the following inequality @xmath134 the error by which the vector @xmath135 violates the periodicity condition ( [ eq : per ] ) of the @xmath14-axis is therefore smaller than @xmath117 and converges to @xmath136 for large @xmath76 .",
    "if one can prove the existence of a suitable number @xmath114 for some spin transport system , one has proven the existence of functions @xmath116 for this system which satisfy the defining equation for the @xmath14-axis to arbitrary precision . since ,",
    "however , these functions @xmath116 do not necessarily converge , this does not prove the existence of an @xmath14-axis for such a system .    if the orbit motion can be described in terms of action ",
    "angle variables , as is always the case for linear motion , and the orbital angle advances for one turn ( @xmath27 times the orbit tunes ) are not in resonance , then two important conclusions about this tracking algorithm with @xmath114 can be drawn .    1 .",
    "if an @xmath14-axis @xmath137 exists , then the sequence @xmath116 converges to @xmath137 linearly in @xmath138 .",
    "if an @xmath14-axis exists and the spin rotation angle in one turn is not a linear combination of orbit phase advances modulo @xmath27 , then the @xmath14-axis is unique up to a sign .",
    "the proof is adapted from @xcite .",
    "the first step will be to show how to define a spin rotation angle which depends only on orbital action variables .",
    "we assume that an @xmath127-axis exists and introduce two unit vectors @xmath139 and @xmath140 to create a right handed coordinate system @xmath141 .",
    "the vectors @xmath142 and @xmath143 are therefore defined up to a rotation around the @xmath14-axis by an arbitrary phase space dependent angle @xmath144 .",
    "we express the spin vectors @xmath22 in terms of this coordinate system by @xmath145 .",
    "the coefficient @xmath146 does not change during the particle motion around the ring since the particle transfer matrix @xmath147 is orthogonal and ensures that @xmath148 is invariant .",
    "the spin motion described by the @xmath147 matrix is therefore simply a rotation around the @xmath14-axis by a phase space dependent angle @xmath149 .",
    "@xmath150    if we now introduce the complex quantity @xmath151 where @xmath144 is the arbitrary angle , then the spin transport is described by @xmath152 now we introduce orbital action ",
    "angle variables @xmath153 and @xmath154 as well as the angle advances @xmath155 for one turn around the accelerator .",
    "note that the symbol @xmath155 is @xmath27 times the orbital tunes . in these variables",
    "the one turn transport is characterized by @xmath156 and @xmath157 .",
    "since the actions remain invariant during the particle motion , we use the symbols @xmath158 and @xmath159 to indicate the spin rotation angle and the free phase of the coordinate system for fixed actions @xmath153 @xmath160 we now show how @xmath159 can be chosen so that the spin motion characterized by the exponent becomes simplified . as with any function of phase space ,",
    "the rotation @xmath161 is @xmath27 periodic in all components @xmath162 .",
    "therefore , the rotation angle @xmath159 has a periodic contribution @xmath163 and a linear contribution in the phases @xmath164 with some vector @xmath165 that has integer components .",
    "the phase space dependent spin rotation @xmath166 is also a periodic function of phase space .",
    "but since on the closed orbit ( @xmath167 ) the spin motion does not depend on @xmath154 , therefore @xmath158 only has a periodic component and no component linear in @xmath154 .",
    "if the orbital angle advances @xmath155 are not in resonance , then @xmath159 can be chosen to eliminate the phase dependence of the exponent in equation ( [ eq : expon ] ) completely .",
    "this can be seen by fourier transformation of the periodic functions @xmath158 and @xmath163 leading to the requirement @xmath168 for the fourier coefficients @xmath169 and @xmath170 .",
    "therefore , @xmath171 can be chosen to eliminate all fourier coefficients except for @xmath172 . with this choice",
    "the exponent reduces to @xmath173 .",
    "the vector @xmath165 can in general not be used to simplify this expression and we therefore usually choose @xmath174 . with @xmath175 ,",
    "the spin rotation of equation ( [ eq : expon ] ) then simplifies to @xmath176 we have now achieved the goal of constructing a spin rotation depending only on orbital actions .",
    "it is interesting to note that if for amplitudes @xmath153 the integer coefficients of @xmath165 can be chosen so that @xmath177 one can eliminate the spin rotation completely .",
    "here we only analyze the case when this resonance condition is not satisfied .    the stroboscopic average is now performed by the recipe of section [ ssec : rec1 ] but this time in the coordinate system @xmath178 just constructed .",
    "we first establish the tracking points @xmath104 and note that @xmath179 is the same for all tracking points .",
    "in the coordinate system @xmath180 , the vector components of the periodic spin @xmath101 on the closed orbit are not constant but depend on the phase space position @xmath181 .",
    "this vector is transported from the phase space points @xmath104 to @xmath182 by the rotation matrix @xmath183 leading to the stroboscopic average in this coordinate system @xmath184 the first component of @xmath121 is @xmath185 , the second and third components in complex notation are @xmath186 where @xmath187 . in terms of the fourier components @xmath188 of @xmath189",
    "one obtains the inequality @xmath190 similarly one obtains for the first component of @xmath121 @xmath191 since @xmath192 and @xmath114 , it is guaranteed that @xmath121 does not converge to @xmath136 . for large @xmath193 @xmath194",
    "is given by @xmath195 , which therefore does not vanish .",
    "since the resonance condition ( [ eq : res ] ) is not satisfied for any vector of integers @xmath165 , none of the denominators is zero and @xmath196 and @xmath197 converge linearly with @xmath138 . at this point",
    "we impose the condition on @xmath14 that the sum on the right hand side of equation ( [ eq : sncon ] ) converges . from the convergence of @xmath121 the convergence of @xmath116 to @xmath14 follows from @xmath198",
    "there is a number @xmath199 such that the absolute value of the @xmath76 dependent part of @xmath196 in equation ( [ eq : sonen ] ) is smaller than @xmath200 .",
    "if the number of turns @xmath76 is bigger than @xmath199 , we conclude @xmath201 which , together with equation ( [ eq : sncon ] ) , establishes that @xmath116 convergences linearly with @xmath138 .",
    "the second conclusion to be proven is the uniqueness of the @xmath127-axis . in the coordinate system",
    "@xmath202 , the periodicity condition ( [ eq : per ] ) reads @xmath203 with the obvious solution @xmath204 for all @xmath2 .",
    "if another @xmath14-axis @xmath205 exists , then @xmath206 is nonzero at least at one phase space point and on all iterates of this point which can be reached during particle motion .",
    "we normalize this difference vector at these phase space points and write it as @xmath207 . in orbital action  angle variables , the free function @xmath208 again has a periodic contribution and a linear contribution @xmath209 .    in complex notation ,",
    "the periodicity condition ( [ eq : perioco ] ) reads @xmath210 since @xmath211 does not depend on @xmath154 , the periodic part of @xmath212 has to vanish .",
    "the resulting @xmath213 can only solve the periodicity condition if there is a vector @xmath165 with integer coefficients fulfilling the resonance equation ( [ eq : res ] ) and then a second @xmath14-axis exists . for linear orbit motion with phase advances which are not on resonances of type ( [ eq : res ] ) , equation ( [ eq : alph ] ) does not have a solution and",
    "the @xmath14-axis is unique .",
    "there is so far no proof for nonlinear orbits , but nevertheless the method of stroboscopic averaging can also be used for exploring nonlinear orbit motion .      in section [ ssec : rec1 ]",
    "an algorithm was introduced which converged with the square root of the number , @xmath120 , of turns tracked .",
    "however , it is possible to obtain convergence linear in the @xmath120 , when one takes advantage of the orthogonality of the spin transfer matrix . to illustrate this ,",
    "we again establish a recipe .    1 .",
    "define as before @xmath214 2 .",
    "define three orthogonal unit vectors @xmath215 .",
    "3 .   obtain the sets @xmath216 of the three vectors @xmath217 , @xmath218 , and @xmath219 by tracking the @xmath220 for @xmath221 turns @xmath222 4 .   from the set of vectors @xmath216 and the set @xmath223",
    ", one can obtain the spin transfer matrix from the phase space point @xmath104 to @xmath89 denoted by @xmath224 .",
    "this becomes clear when one realizes that @xmath225 for all @xmath226 .",
    "obtaining these @xmath69 transport matrices requires the propagation of 3 spins around the circular accelerator for @xmath76 turns .",
    "5 .   now we can compute the set @xmath227 .",
    "this is obviously identical to the set denoted by @xmath106 in the previous section .",
    "the normalized average of @xmath106 , denoted by @xmath116 , can now again be computed as mentioned above and solves the defining equation for an @xmath14-axis up to the small error discussed previously .    in this approach",
    "one only has to track three initial spin directions over @xmath76 turns , leading to @xmath228 .",
    "the error is therefore bounded by @xmath229 .",
    "this implies convergence linear in the number @xmath120 of turns tracked .",
    "the following example illustrates the speed of this method : when the angle @xmath129 happens to be @xmath230 , and we require an accuracy at the @xmath231 level , this linear convergence approach only requires @xmath232 tracking turns ; when the angle @xmath129 is small , fewer iterations are needed .      in the two recipes of section [ ssec : rec1 ] and [ ssec :",
    "rec2 ] mentioned above , we need to find the set @xmath102 of @xmath69 backwards tracked phase space points , and then launch spins at these points and track forward so as to compute the set @xmath106 . in the case of linear motion ,",
    "it is trivial to obtain these backward tracked phase space points .",
    "one simply transforms @xmath89 into the action ",
    "angle variables of the linear motion and determines the phase advance per turn of the linear motion . counting back these phase advances and transforming the action ",
    "angle variables back into phase space leads to the points @xmath104 . in the nonlinear case",
    "this would actually require to track for @xmath76 more turns around the ring .    in the case of the linearly convergent method of section [ ssec : rec2 ]",
    ", this extra effort becomes unnecessary .",
    "one can start with the phase space point @xmath89 and launch three particles with spins along @xmath233 , @xmath234 , and @xmath235 .",
    "tracking backward in azimuth defines the @xmath69 sets @xmath236 of the spins @xmath237 , @xmath238 , and @xmath239 with @xmath240 from the sets @xmath236 and @xmath241 one can again compute the spin transfer matrix @xmath224 and with these matrices one obtains the set @xmath106 with the elements @xmath242 , which again leads to @xmath116 by averaging .",
    "there is an even more fundamental problem in the case of nonlinear motion than the computation time . when the lattice or the effect of separate nonlinear elements are computed by nonlinear transfer maps , the inverses of these maps might not be known . in this case",
    "the required phase space points @xmath104 can not be computed at all . nevertheless our method can be used to obtain the vector @xmath116 as follows .",
    "the arguments of the section on backward tracking can simply be repeated for tracking forward .",
    "one establishes the phase space points @xmath243 with @xmath244 for @xmath245 and simultaneously the sets @xmath216 by tracking the three unit vectors @xmath246 for one turn with @xmath247 . as in the fourth step of the recipe in section [ ssec : rec2",
    "] one can then obtain the spin transfer matrix @xmath224 from the phase space point @xmath89 to @xmath104 . the inverse of this transfer matrix is simply obtained by transposition leading to the vectors @xmath248 .",
    "the normalized average of the vectors @xmath249 is then the stroboscopic average @xmath250 of the inverse motion . for this average",
    "the error of the periodicity condition for the inverse motion converges linearly to zero .",
    "fortunately , an @xmath14-axis of the inverse motion @xmath251 is also an @xmath14-axis of the forward motion , since the periodicity condition of the inverse motion reads as @xmath252 and from this it follows that @xmath253 also obeys the periodicity condition ( [ eq : per ] ) of the forward motion .",
    "one can represent a rotation matrix by its rotation vector @xmath254 and its rotation angle @xmath255 $ ] .",
    "the simplest representation is in terms of the vector @xmath256 and @xmath257 .",
    "the rotation matrix is then given by @xmath258 this representation can be easily transported through an accelerator by means of the equations @xmath259    it is therefore even more appropriate and faster by about a factor of three to track rotation matrices represented by @xmath260 and @xmath261 directly , than to track three spin vectors .",
    "in this section we consider the special case of linear spin  orbit motion as a way to illustrate and confirm the chief features of our algorithm @xcite . for this purpose",
    "we define two periodic vectors @xmath262 and @xmath263 orthogonal to @xmath101 in order to obtain an orthonormal right  handed dreibein at the previously specified azimuth @xmath32 .",
    "we then write a spin vector @xmath22 in the form @xmath264 in the case where both @xmath212 and @xmath265 are much smaller than unity we may treat the spin in a first order approximation in @xmath212 and @xmath265 so that the spin vector ( [ eq : sab ] ) can be written as @xmath266 and is normalized in linear approximation .",
    "we combine the two - component vector @xmath267 and the orbit vector @xmath2 into a single vector @xmath268 of d+2 components . by linearizing the equations of motion with respect to @xmath268 , an initial spin  orbit coordinate @xmath269 at azimuth @xmath32 is mapped into a final coordinate @xmath270 after one turn around the ring @xcite by the @xmath271 spin  orbit transfer matrix @xmath272 @xmath273 where @xmath274 again denotes the @xmath275 dimensional orbit transfer matrix .",
    "the matrices @xmath276 and @xmath277 are @xmath278 and @xmath279 matrices respectively with @xmath280 in order to simplify the following formulas , we introduce the @xmath281 dimensional component @xmath282 of the transfer matrix @xmath283 for @xmath43 turns around the ring .",
    "we note that the two component vector corresponding to @xmath101 is @xmath284 so that propagating this initial spin vector at a phase space point @xmath91 once around the ring leads to the final spin @xmath285 .",
    "therefore , we define the two component vector @xmath286 analogous to equation ( [ eq : sn ] ) by @xmath287 from equation ( [ eq : matrix ] ) it follows that @xmath288 we expand the phase space coordinate @xmath89 in eigenvectors @xmath289 of the one turn transfer matrix @xmath274 @xmath290 with expansion constants @xmath291 and eigenvalues @xmath292 @xmath293 thus we get @xmath294    we do not consider the case of spin  orbit resonances , so that the matrices @xmath295 are nonsingular . thus equation ( [ eq : gmmm ] ) simplifies to    @xmath296    from this follows @xmath297\\cdot(\\underline 1-\\lambda_j\\underline    d)^{-1}\\cdot\\underline g\\cdot\\vec y_j\\ , \\ ] ] so that @xmath298 = \\lambda_j(\\underline    1-\\lambda_j\\underline d)^{-1 } \\cdot\\underline g\\cdot\\vec y_j\\ .\\ ] ] combining this with equations ( [ eq : sgm ] ) and ( [ eq : eigen ] ) we get @xmath299 where @xmath300 is the two component vector corresponding to @xmath14 . for @xmath301",
    "this yields the well known expression of the @xmath127-axis for the case of linear spin ",
    "orbit motion @xcite .",
    "this confirms the method of stroboscopic averaging for the linear case .",
    "also our predictions about convergence speed are confirmed as follows . in storage rings the particle motion can only be stable if the eigenvalues have @xmath302 . to analyze the convergence speed",
    ", one has to realize that @xmath277 is a rotation matrix and therefore that @xmath303 this inequality shows that also for linear spin ",
    "orbit motion one finds convergence linear in @xmath138 , and it can also be seen that the convergence speed decreases with the orbital amplitudes @xmath291 and becomes very slow close to first order spin  orbit resonances .",
    "in order to illustrate which quantities can be computed and how effective stroboscopic averaging can be in numerical computations , we apply it to a model accelerator with known @xmath14-axis . since this model is somewhat artificial , we also apply our method to the vertical motion of the hera proton ring . for simplicity , the vertical bends at the interaction regions have been ignored .      in this section",
    "we consider a special model @xcite with @xmath304 and @xmath305 .",
    "the equations of motion are given by @xmath306 with @xmath307 where @xmath308 is a real parameter .",
    "hence initial coordinates @xmath91 are taken into final coordinates @xmath309 by @xmath310 with @xmath311 and @xmath312 . in the following we assume @xmath313 and",
    "that @xmath314 is not integer .",
    "this model corresponds to the rotating field approximation often used to discuss spin resonance in solid state physics @xcite .",
    "we now introduce the orthogonal matrix @xmath315 describing a rotation around a unit vector @xmath316 by an angle @xmath317 . transforming the spin components of @xmath22 into a rotating frame by introducing @xmath318 ,",
    "one obtains the simplified equation of spin motion @xmath319 if in this frame a spin field is oriented parallel to @xmath320 , this field does not change from turn to turn .",
    "therefore @xmath321 is an @xmath14-axis . in the original frame",
    "this @xmath14-axis is @xmath322 where the ` sign factor ' @xmath323 has been chosen so that on the closed orbit ( @xmath324 ) the @xmath14-axis @xmath325 coincides with @xmath326 . as with any function of phase space",
    "this @xmath14-axis is a periodic function in @xmath327 .",
    "we now perform the stroboscopic average by the recipe of section [ ssec : rec1 ] to compute an @xmath14-axis at @xmath328 and @xmath32 @xmath329 if @xmath330 is not an integer one obtains after some tedious manipulations @xmath331 one sees that @xmath332 is an oscillating function of @xmath333 whose local maxima increase with @xmath333 , reflecting the fact that large orbital amplitudes reduce the convergence speed .",
    "this behavior is plotted in figure [ fg : modelconvary ] . in this and the other figures concerned with the solvable model we used the parameters @xmath334 , @xmath335 , @xmath336 , and @xmath337 . for large @xmath76 equations ( [ eq : errm ] ) and ( [ eq : taun ] ) predict that the convergence is indeed linear in @xmath138 , as illustrated by the slope of @xmath338 in figure [ fg : modelconv ] . also one sees that @xmath332 vanishes for @xmath339integer and if @xmath340integer .",
    "for @xmath341integer we have @xmath342 therefore in this case @xmath116 does not converge to @xmath14 .",
    "this is no surprise since the condition @xmath341integer amounts to the resonance condition ( [ eq : res ] ) which leads to this non - uniqueness of the @xmath14-axis .",
    "it is interesting that the local maxima of @xmath332 do not occur at these resonance points .",
    "figure [ fg : modelangle ] shows the variation of the opening angle of the polarization field as a function of orbital amplitude . since @xmath343 as well as @xmath344 do not depend on the angle variable @xmath327 , the depicted angles are equivalent to the phase averaged opening angle .",
    "the good agreement with the analytically computed opening angle of the @xmath14-axis shows that accurate values for the field can be obtained with a very limited number of turns .",
    "( 0,0)(0,0 ) ( -11.5,0.2 ) @xmath345 ( 0.0,-7.5 ) @xmath333    ( 0,0)(0,0 ) ( -11.5,0.2 ) @xmath346 ( 0.0,-7.5 ) @xmath347    ( 0,0)(0,0 ) ( -11.5,1.0 ) @xmath348 ( -11.5,0.2 ) @xmath349 ( 0.0,-7.5 ) @xmath333    this analytically solvable model can also be used to illustrate the construction of a phase independent spin rotation angle @xmath350 .",
    "having got an @xmath14-axis , one can transform the spin components of @xmath22 into a rotated coordinate system ( @xmath351 ) . with the simple choice @xmath352 both of which are clearly periodic in @xmath327",
    ", one can show that the spin rotation angle is independent of @xmath327 , namely @xmath353 however , @xmath350 is free up to multiples of the orbit tune as outlined in section [ ssec : conv ] .",
    "we can use this freedom to obtain a @xmath350 which reduces to @xmath354 on the closed orbit @xmath355 .",
    "the only choice which satisfies this condition is obtained by an additional rotation of @xmath142 and @xmath143 around @xmath14 by @xmath356 .",
    "@xmath357 both are again periodic in @xmath327 and again we obtain a spin rotation angle independent of @xmath327 , viz .",
    "@xmath358 correspondingly , on the closed orbit @xmath359 reduce to @xmath360      the hera proton ring stores protons with an energy of @xmath361gev . at this energy ,",
    "the proton spin rotates about 1566.85 times around the vertical direction in a flat ring during one turn .",
    "the hera ring is not completely flat , nevertheless this number illustrates the complexity of spin motion . if a change of the phase space position of a particle initiates a relative change of the one turn spin rotation by only one part in @xmath362 , the angle of precession has changed by @xmath363 degrees .",
    "this simple observation already hints at the strong dependence of the equilibrium spin direction on the phase space coordinates pointed out in the introduction .",
    "to illustrate this fact , we restricted ourselves to vertical motion with a tune of 0.29 , ignored the vertical bends to obtain a flat ring , and computed the third order expansion of the spin transfer matrix with respect to the vertical phase space coordinates using the differential algebra code cosy infinity @xcite .",
    "finally we stored the third order phase space expansion of the corresponding rotation vector @xmath260 .",
    "this power expansion was then used by the program sprint to obtain the @xmath14-axis . due to the strong phase space dependence of spin motion",
    ", this expansion does not represent the real spin motion in hera very well , but it is nevertheless useful to demonstrate the applicability of stroboscopic averaging .",
    "we transported spins by means of this rotation vector and approximated the orbit motion by the linear transport matrix .    in a realistic accelerator",
    ", the existence of the @xmath14-axis can not be guaranteed , but an approximately invariant spin field can be found , if the series @xmath116 converges . to indicate the convergence of this series , we plot @xmath364 for the phase space point with @xmath365 mm and @xmath366 in the east interaction region .",
    "this corresponds to an emittance of @xmath367 mm mrad and is therefore a particle at approximately @xmath368 of the beam distribution .",
    "the slope of @xmath338 in the double logarithmic scale of figure [ fg : heraconv ] illustrates clearly that the convergence is linear in @xmath138 as derived in section [ ssec : conv ] .",
    "( 0,0)(0,0 ) ( -11.5,0.2 ) @xmath369 ( 0.0,-7.5 ) @xmath347    in that section , convergence could only be guaranteed if the angle between the vectors @xmath370 and @xmath101 stayed smaller than @xmath133 during tracking . as an example we checked this requirement for @xmath365 mm and found that this condition is violated as illustrated in figure [ fg : heratrack ] , and convergence can not be guaranteed ad hoc .",
    "nevertheless , an approximately periodic spin field is obtained .",
    "( 0,0)(0,0 ) ( -11.5,0.2 ) @xmath371 ( 0.0,-7.5 ) @xmath76    one can easily check this by tracking a spin which is initially parallel to @xmath116 for many turns . in order for @xmath116 to approximate an @xmath14-axis",
    ", the tracked spins have to lie approximately on a closed curve on the unit sphere .",
    "four such closed curves were created by computing @xmath372 at the phase space points @xmath373 mm , @xmath374 mm , @xmath375 mm and @xmath365 mm with @xmath366 and tracking for a further @xmath376 turns . in figure [ fg : heraphi1 ]",
    "we display the projections of these curves on the horizontal plane .",
    "( 0,0)(0,0 ) ( -10.2,-0.65 ) 0.1 mm ( -11.5,0.2 ) @xmath377 ( 0.0,-7.5 ) @xmath378    ( 0,0)(0,0 ) ( -10.2,-0.65 ) 0.2 mm ( -11.5,0.2 ) @xmath377 ( 0.0,-7.5 ) @xmath378    ( 0,0)(0,0 ) ( -10.2,-0.65 ) 0.3 mm ( -11.5,0.2 ) @xmath377 ( 0.0,-7.5 ) @xmath378    ( 0,0)(0,0 ) ( -10.2,-0.65 ) 0.4 mm ( -11.5,0.2 ) @xmath377 ( 0.0,-7.5 ) @xmath378    optimization of the average polarization of a particle beam requires that the equilibrium polarization direction for every particle is almost parallel to the average polarization direction .",
    "we therefore averaged the angle between @xmath116 and @xmath101 over the orbital phases and displayed this divergence for different phase space amplitudes in figure [ fg : heraangle ] .",
    "( 0,0)(0,0 ) ( -11.5,0.2 ) @xmath379 ( 0.0,-7.5 ) @xmath380 meters    yet another way of illustrating the importance of the @xmath14-axis is illustrated in figure [ fg : heraparal ] .",
    "particles at 100 different phases at a normalized emittance of about @xmath381 mm mrad , corresponding to @xmath382 and @xmath366 , have been tracked through hera for 500 turns while the beam was initially polarized 100% parallel to @xmath112 .",
    "similar kinds of tracking results have been presented in @xcite . since this polarization distribution is not the equilibrium distribution , the averaged polarization exhibits a strong beat .",
    "this figure also shows that when spins at phase space coordinate @xmath2 are initially parallel to @xmath137 , the averaged polarization stays constant .",
    "therefore , by starting simulations with spins parallel to the @xmath14-axis one can perform a much cleaner analysis of beam polarization in accelerators .",
    "( 0,0)(0,0 ) ( -11.5,0.2 ) @xmath383 ( 0.0,-7.5 ) @xmath76",
    "we have introduced an algorithm for computing the derbenev  kondratenko spin axis ( @xmath14-axis ) from straight forward spin phase space tracking data with the following features :    * it can be implemented in any existing spin tracking program . * for an accuracy on the @xmath231 level typically less than 3000 turns have to be tracked . *",
    "no artificial damping is needed . *",
    "since our method is non - perturbative , no resonance factors appear in the algorithm and it is applicable even near spin  orbit resonances .    with the method of stroboscopic averaging important features of accelerators",
    "can now be analyzed .",
    "one very significant field of study will be the computation of spin tune spreads , which previously could hardly be analyzed and are now easily accessible .",
    "diffusion and damping terms could be added to the analysis and @xmath384 @xcite can be computed for the simulation of electron polarization in storage rings .",
    "in addition numerical checks of uniqueness , convergence near resonances , and the effect of nonlinear orbit motion should be made .",
    "it is the opinion of the authors that now , after the introduction of stroboscopic averaging , spin tracking in storage rings should always be initialized with spins parallel to the equilibrium distribution , since much clearer analysis becomes possible .",
    "we wish to thank desmond p.  barber for careful reading of and valuable remarks on the manuscript and gerhard ripken for useful discussions ."
  ],
  "abstract_text": [
    "<S> polarized protons have never been accelerated to more than about @xmath0gev . to achieve polarized proton beams in rhic ( 250gev ) , hera ( 820gev ) , and the tevatron ( 900gev ) , </S>",
    "<S> ideas and techniques new to accelerator physics are needed . in this publication </S>",
    "<S> we will stress an important aspect of very high energy polarized proton beams , namely the fact that the equilibrium polarization direction can vary substantially across the beam in the interaction region of a high energy experiment when no countermeasure is taken . </S>",
    "<S> such a divergence of the polarization direction would not only diminish the average polarization available to the particle physics experiment , but it would also make the polarization involved in each collision analyzed in a detector strongly dependent on the phase space position of the interacting particle . in order to analyze and compensate this effect , methods for computing the equilibrium polarization direction are needed . in this paper </S>",
    "<S> we introduce the method of stroboscopic averaging , which computes this direction in a very efficient way . </S>",
    "<S> since only tracking data is needed , our method can be implemented easily in existing spin tracking programs . </S>",
    "<S> several examples demonstrate the importance of the spin divergence and the applicability of stroboscopic averaging .    </S>",
    "<S> = -.5 in = .5 in = .5 in = .8 in = .2 in = .3 in = .3 in = .2 in = .3 in </S>"
  ]
}