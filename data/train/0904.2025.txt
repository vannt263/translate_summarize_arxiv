{
  "article_text": [
    "since the introduction of time - distance helioseismology ( duvall _ et al .",
    "_ , 1993 ) this method has been applied to investigate various subsurface physical properties of the quiet sun ( _ e.g. _ kosovichev and duvall , 1997 ) , especially supergranulation ( _ e.g. _ duvall and gizon , 2000 ; zhao and kosovichev , 2003 ; hirzberger _",
    "et al . _ , 2007 ) , and sunspots ( _ e.g. _ kosovichev , duvall , and scherrer , 2000 ; zhao , kosovichev , and duvall , 2001 ; couvidat , birch , and kosovichev , 2006 ) . in these studies ,",
    "the main emphasis has been on mapping both the subsurface material flows and deviations of the sound speed from a reference solar model .",
    "travel times of wavepackets ( whether from acoustic or surface gravity waves ) are the basic measured quantities that are then inverted to produce estimates of the flow velocity and sound - speed perturbations .",
    "travel times are measured from temporal cross - covariances . over the years",
    "different definitions of these travel times have been employed ( _ e.g. _ , kosovichev and duvall , 1997 ; gizon and birch , 2002 ; gizon and birch , 2004 ) .",
    "for a given cross - covariance , these definitions , in general , yield different travel times .",
    "it is therefore important to understand how these definitions perform in simple situations where the subsurface conditions are known . in this paper",
    "we study the sensitivity of these definitions to horizontal , steady , and uniform flows .",
    "we use vertical velocity data from a realistic numerical simulation of solar convection ( benson , stein , and nordlund , 2006 ) .",
    "we introduce steady and spatially uniform horizontal flows to this vertical velocity data cube and measure the perturbations in the travel times induced by these flows .",
    "we also compare the observed relationship between travel - time differences and flow velocities with the relationship predicted by ray approximation kernels ( kosovichev and duvall , 1997 ) commonly used for the inversions .",
    "we limit ourselves to the study of acoustic modes ( _ p _ modes ) , neglecting the surface - gravity modes ( _ f _ modes ) .",
    "f_-mode case was studied in detail by jackiewicz _",
    "( 2007 ) . in section  2 we briefly present the numerical simulation that we used for this work . in section",
    "3 we remind the reader of the fundamentals of the time - distance formalism . in section  4",
    "we present our results , and we conclude in section  5 .",
    "we work with simulated line - of - sight velocity data [ @xmath4 where @xmath5 is the horizontal position vector and @xmath6 is time ] obtained from a numerical three - dimensional simulation of convection in the upper solar convection zone .",
    "the numerical slab is 96 mm@xmath796 mm wide and 20 mm deep .",
    "the spatial resolution is 96 km horizontally and varies from 12 to 75 km vertically .",
    "the temporal resolution is 10 seconds and we use 8.5  hours of simulated data .",
    "this simulation was performed by robert stein , ake nordlund , dali georgobiani and david benson , and is publicly available on the website sha.stanford.edu .",
    "a very similar simulation ( 48 mm@xmath748 mm horizontally ) has already been extensively analyzed by georgobiani _",
    "( 2007 ) , braun _",
    "( 2007 ) , and zhao _ et al . _",
    "the latter applied the time - distance formalism to these data to study , among other things , the validity of the inversion procedures .",
    "a detailed presentation of the code that produced these data can be found in benson , stein , and nordlund ( 2006 ) and stein and nordlund ( 2000 ) .",
    "here we only work with the vertical velocity at the surface of the numerical simulation .",
    "the data cube we use is rebinned four times in the horizontal direction ( yielding a final spatial resolution @xmath8=384 km ) and six times in time ( final temporal resolution @xmath9=60 seconds ) .",
    "one advantage of using this numerical simulation in place of solar data is that horizontally the boundary conditions are periodic .",
    "therefore it is possible to simulate the impact of a steady horizontally uniform flow by simply shifting the vertical velocity maps in the horizontal direction at each time - step , using the shift theorem in the fourier domain . simulating an advection flow on actual solar data , _",
    "e.g. _ on data from the soi / mdi instrument ( scherrer _ et al .",
    "_ , 1995 ) , is possible ( jackiewicz _ et al .",
    "_ , 2007 ) but more complicated and under normal conditions the simulated flow is non - uniform in latitude .",
    "the power spectrum of the vertical velocity @xmath4 from the numerical simulation is very similar to the actual solar oscillations power spectrum as determined by soi / mdi ( georgiobani _ et al .",
    "_ , 2007 ) .",
    "therefore we expect that the results we obtain here should be fairly representative of the actual solar case .",
    "we use the time - distance measurement procedure described in couvidat , birch , and kosovichev ( 2006 ) , except that we work with a center - quadrant geometry instead of a center - annulus one .",
    "we only deal with acoustic waves ( _ p _ modes ) and filter out the surface gravity waves ( _ f _ modes ) ( see jackiewicz _",
    "et al . _ , 2007 , for a recent study of the travel times of _ f _ modes ) .",
    "the measurement of the travel times begins with the computation of cross - covariances between two observation points @xmath10 and @xmath11 . to reduce the noise level of the cross - covariances , the data cubes are phase - speed filtered ( duvall _ et _ , 1997 ) .",
    "the data cube @xmath4 is filtered in the fourier domain using a gaussian filter @xmath12 , where @xmath13 is the horizontal wavenumber and @xmath14 is the temporal angular frequency , for each travel distance @xmath15 .",
    "f_-mode filter is also applied to remove the _",
    "f_-mode ridge .",
    "the point - to - point cross - covariances are averaged over quadrants ( arc of 90@xmath16 ) of radius @xmath17 centered on the point @xmath10 .",
    "the quadrant geometry ( two separate pairs of quadrants : east  west and north  south ) is used to retrieve the subsurface horizontal flow velocity . such point - to - quadrant cross - covariances",
    "are computed for four central distances ( @xmath17 ) ranging from @xmath18 mm to @xmath19 mm .",
    "we do not select larger @xmath17 because there is a small amount of wave reflection at the bottom boundary of the numerical simulation ( zhao _ et al .",
    "_ , 2007 ) that seems to alter the shape of the cross - covariances .",
    "the larger the @xmath17 the deeper the wavepackets reach , and the more they are affected by these reflected waves .",
    "ray theory shows that for @xmath20 mm , the lower turning point of the wavepackets is located at a depth of about @xmath21 mm , far from the bottom boundary .",
    "to further increase the signal - to - noise ratio of the cross - covariances , we average them in groups of five distances ( @xmath17 ) for each central distance .",
    "for instance , the final cross - covariances at the central distance @xmath22 mm are averages of five cross - covariances computed at distances ranging from @xmath23 to @xmath24 mm ( see details in couvidat , birch , and kosovichev , 2006 ) .",
    "the values of @xmath17 and properties of the phase - speed filters used in this paper are summarized in table [ table.1 ] .",
    ".parameters for the time - distance analysis : distances @xmath25 , range of @xmath17 , properties of the gaussian phase - speed filters applied to the fourier transform of the vertical - velocity data cube ( @xmath26 is the central phase speed and fwhm is the full width at half maximum ) , centers of the time window used to measure the travel times , and selected phase travel times ( @xmath27 ) of the reference cross - covariances @xmath28 . [ cols=\"^,^,^,^,^,^ \" , ]      the point - to - quadrant cross - covariances are used to determine the travel times of the acoustic wavepackets .",
    "traditionally , cross - covariances have been fit with a gabor wavelet defined as ( kosovichev and duvall , 1997 ) : @xmath29 where @xmath30 is the amplitude of the wavelet , @xmath31 is the central temporal frequency of the wavepacket , @xmath32 is a measure of its frequency width , @xmath27 is the phase travel time , and @xmath33 is the group travel time .",
    "it is customary to use only phase travel times with the time - distance formalism , because group travel times are more difficult to retrieve accurately ( the center of the gaussian envelope is usually poorly estimated ) and therefore group travel - time maps are significantly noisier than phase travel - time maps .",
    "recently , two more definitions of the wavepacket travel times based on studies in geophysics were added .",
    "gizon and birch ( 2002 ) [ hereafter gb02 ] define the travel times @xmath34 as : @xmath35 where @xmath36 are the following functions : @xmath37 ^ 2\\ ] ] where @xmath38 is a one - sided window function that selects the first - bounce skip of the cross - covariance ( the skip corresponding to waves travelling directly from the center to the quadrant ) on the positive - time or negative - time branches of the cross - covariance .",
    "the same window function is also used when fitting the cross - covariance by a gabor wavelet even though it does not appear explicitly in equation ( [ eq.1 ] ) .",
    "the function @xmath28 is the reference cross - covariance .",
    "usually @xmath28 is either obtained from a model of the solar oscillation power spectrum , or is a spatial average of the measured cross - covariances over a region of the quiet sun .",
    "lastly , gizon and birch ( 2004 ) [ hereafter gb04 ] proposed another definition of the travel time that is linear with respect to the cross - covariance : @xmath39\\ ] ] where the @xmath40 are weight functions : @xmath41 ^ 2}\\ ] ] and @xmath42 denotes the time derivative of the reference cross - covariance .",
    "as emphasized by the use of the @xmath43 symbol , for each of the three definitions of travel times we can measure @xmath44 on the positive - time branch ( for wavepackets travelling in a specific direction , _",
    "e.g. _ from the south to the north ) and on the negative - time branch ( for wavepackets travelling in the opposite direction ) . therefore we measure four different kinds of travel time : @xmath45 is the travel time of wavepackets traveling westward over a horizontal distance @xmath17 centered on @xmath46 ; @xmath47 is for eastward traveling waves ; @xmath48 is for southward traveling waves ; and finally @xmath49 is for northward traveling waves .",
    "the corresponding travel - time perturbations are produced by subtracting the travel time obtained from the reference cross - covariance .",
    "for instance , @xmath50 where @xmath51 is the travel time of the reference cross - covariance . here",
    ", @xmath28 is obtained by averaging over @xmath46 the center - to - annulus cross - covariance . in this paper",
    "we focus on @xmath52 , the north  south difference travel - time perturbation , that is , in a first approximation , only sensitive to horizontal flows in the north  south direction . with this convention",
    "a northward flow will result in a negative @xmath53 .",
    "we added southward flows to the velocity data cube from the numerical simulation by applying the shift theorem in the fourier domain . at each time step ( @xmath6 )",
    "we shift the velocity maps @xmath4 in the @xmath54 direction ( from north to south ) by the amount @xmath55 where @xmath56 is the amplitude of the imposed flow .",
    "again , the advantage of using the simulation for this purpose is that its boundary conditions are periodic .",
    "we tested 12 flow amplitudes : @xmath57 , @xmath58 , @xmath59 , @xmath0 , @xmath60 , @xmath61 , @xmath62 , @xmath63 , @xmath64 , @xmath65 , @xmath66 , and @xmath3 m s@xmath1 . even in the absence of any additional flow ( case @xmath57 m s@xmath1 )",
    "the simulation already includes a weak northward flow .",
    "this flow is horizontally non - uniform and its velocity varies slightly with depth , with a maximum amplitude of the order of @xmath67 m s@xmath1 .",
    "the simulation also includes a horizontally non - uniform eastward flow that is somewhat stronger ( with an average velocity of about 150 m s@xmath1 in the first few mm underneath the surface ) and is strongly depth dependent .",
    "the presence of this stronger eastward flow explains why we favor the north  south direction in the results presented here .",
    "however we also tested the addition of eastward flows and their impact on the east ",
    "west travel - time difference , and obtained similar results . in the rest of this paper we use two kinds of gaussian phase - speed filters when computing the cross - covariances : those whose parameters are listed in table  [ table.1 ] ( hereafter standard phase - speed filters ) , and those whose fwhm was multiplied by four ( hereafter broad phase - speed filters ) .",
    "the impact of the additional uniform horizontal flows on the spatially averaged cross - covariances is shown in figure  [ fig.0 ] ( at @xmath68  mm ) . because the flows are southward , the spatially averaged cross - covariance for the northward - going wavepackets ( hereafter northward cross - covariance ) is shifted toward larger times compared to the reference cross - covariance ;",
    "the northward - going wavepackets are slowed down by the southward flows .",
    "the reverse is true for the southward - going wavepackets .",
    "however flows do not result only in a shift of the cross - covariances .",
    "indeed , when we fit the cross - covariances by gabor wavelets ( equation ( [ eq.1 ] ) ) , other differences unfold .",
    "_ i _ ) the central frequencies ( @xmath31 ) of the wavepackets are also different for the northward and southward cross - covariances ( figure  [ fig.4 ] ) .",
    "for instance , at @xmath68 mm , in the presence of a @xmath60 m s@xmath1 southward flow , @xmath69 @xmath70 rad s@xmath1 for the spatially - averaged northward cross - covariance , while @xmath71 @xmath70 rad s@xmath1 for the southward cross - covariance .",
    "the change in @xmath31 is generally consistent with a doppler shift @xmath72 described by @xmath73 and resulting from a flow @xmath74 .",
    "however at short distances ( @xmath22 and @xmath24 mm ) , and for flows faster than about @xmath75 m s@xmath1 , @xmath72 becomes non - linear in @xmath56 .",
    "this non - linearity is probably mainly the result of the application of gaussian phase - speed filters to the fourier transform of the data cube .",
    "the @xmath76 doppler shift changes the location of the acoustic - mode ridges in regard to the filters and affects the power distribution inside these filters depending on the ridge distance to the filter center .",
    "moreover , this change in the power distribution is different for the positive and negative ( in term of @xmath14 ) branches of the acoustic - mode ridges , explaining why the @xmath31 of northward and southward cross - covariances are not symmetrical around the @xmath31 value at rest ( @xmath57 ) . with the broad phase - speed filters at @xmath22 mm , the acoustic wavepackets have a lower central frequency ( @xmath31 ) and a lower central wavenumber ( @xmath13 ) where there is more acoustic power than with the standard filters .",
    "therefore , with the broader filters , @xmath72 is smaller for a given velocity @xmath56 , because the average @xmath13 of the wavepacket is smaller .",
    "finally , @xmath72 becomes non - linear in @xmath56 earlier with the broad filters than with the standard ones , at least at short @xmath17 : this might be because the average @xmath13 is more dependent on the flow amplitude than in the case of the standard filters .",
    "_ ii _ ) the frequency width of the wavepacket varies ( figure [ fig.5 ] ) : for @xmath77 m s@xmath1 , @xmath78 @xmath70 rad s@xmath1 for the northward cross - covariance and @xmath79 @xmath70 rad s@xmath1 for the southward one .",
    "a change in the wavepacket frequency width is expected because the doppler shift @xmath72 depends on @xmath13 , but as with the change in @xmath31 , the interplay between the @xmath14-shifted acoustic ridges of the power spectrum and the gaussian phase - speed filters probably explains the details of this frequency width change .",
    "_ iii _ ) the maximum amplitude of the cross - covariances is also affected by the presence of a flow , and again this can partly be explained by a change in the amount of acoustic power selected by the phase - speed filters due to the doppler shift .",
    "all of these changes affect the northward and southward cross - covariances differently .",
    "this can also been seen in figure  [ fig.0d ] which shows the cross - covariances as a function of both the time and the flow amplitude for standard and broad phase - speed filters .",
    "there is a clear impact of the fwhm of the filter on the shape of the cross - covariances ( and , consequently , on the values of the travel times returned by the definitions studied here ) .",
    "this impact has been mentioned regarding some gabor wavelet parameters ( figures  [ fig.4 ] and  [ fig.5 ] ) .",
    "another consequence of the phase - speed filters , not modeled by the gabor wavelet , is the presence of a filter artifact ( couvidat _ et al .",
    "_ , 2005 ) .",
    "indeed , the cross - covariances for the distances studied in this paper have three main components : a filter artifact ( at small times @xmath80 ) , a first - bounce skip ( waves travelling directly between the two observations points ) , and a second - bounce skip ( waves being reflected once at the surface in between @xmath10 and @xmath11 ) . at @xmath22 and @xmath24  mm , the filter artifact ,",
    "the first - bounce skip , and the second - bounce skips are entangled .",
    "it appears in figures  [ fig.0 ] and [ fig.0d ] that the filter artifact is the part of the cross - covariance that is the least affected by the presence of a flow : the location and amplitude of its peaks do not vary much .",
    "standard phase - speed filters engender filter artifacts whose amplitude is larger than those arising from broad filters .",
    "fast , southward flows push the first - bounce skip of the southward cross - covariances toward lower times @xmath80 .",
    "therefore , the peaks of this first - bounce skip become more and more altered by the presence of the filter artifact . on the other hand ,",
    "the use of broad phase - speed filters reduce the amplitude of the artifact and the peaks of the first - bounce skip are less distorted .",
    "an example of the time window [ @xmath38 ] used to select the first - bounce skip is shown in figure  [ fig.0 ] . for the travel - time measurements this time - window",
    "is always centered at the same time ( independent of the flow amplitude ) .",
    "mm , and for standard phase - speed filters .",
    "the flow amplitudes are , from upper to lower panels : 0 , 200 , 400 , 600 , 800 , 1000 , and 1200 m s@xmath1 . in black",
    "is the reference cross - covariance @xmath28 .",
    "the temporal window applied when measuring the wavepacket travel times is also shown .",
    "right column : the difference between the northward ( blue ) or southward ( red ) cross - covariance and @xmath28.,height=604 ]     ( wavepacket central frequency ) as a function of the southward flow velocity .",
    "black lines are for the northward cross - covariances , red lines are for the southward ones .",
    "solid lines are for the standard phase - speed filters , dashed lines are for the broad phase - speed filters .",
    "the measurement points are shown as diamonds . ]",
    "( wavepacket width ) as a function of the southward flow velocity .",
    "black lines are for the northward cross - covariances , red lines are for the southward ones .",
    "solid lines are for the standard phase - speed filters , dashed lines are for the broad phase - speed filters .",
    "the measurement points are shown as diamonds . ]",
    "figure [ fig.0b ] shows the power - spectral density , and the real and imaginary parts of the fourier transform of the northward and southward spatially averaged cross - covariances in the presence of a @xmath66 m s@xmath1 southward flow , for the standard and broad phase - speed filters at @xmath68 mm .",
    "the differences mentioned earlier in central frequency , frequency width , and total power of the wavepacket between northward and southward cross - covariances are clearly visible .",
    "it confirms that the asymmetry between southward and northward cross - covariances is mainly a result of the interaction between the phase - speed filters and the wavepackets .",
    "overall , broader phase - speed filters seem preferable when computing the cross - covariances , since narrow filters introduce more asymmetries between northward and southward cross - covariances and significantly alter the shape of the first - bounce ridge at short distances @xmath17 .",
    "this could lead to spurious interpretations regarding physical phenomena like subsurface flows or sound - speed velocity perturbations , when the resulting travel times are inverted with sensitivity kernels that do not take into account the details of the travel - time measurement technique .",
    "mm , and for standard phase - speed filters ( upper panel ) and broad phase - speed filters ( lower panel ) . superimposed in black lines",
    "are the phase travel times @xmath27 of the gabor wavelet fit selected for this paper ( solid lines ) and some other phase travel times @xmath82 where @xmath13 is an integer ( dashed lines ) . notice that the filter artifacts at roughly @xmath83  min are largely independent of flow amplitude.,height=566 ]      as mentioned in section @xmath84 , when fitting a temporal cross - covariance with a gabor wavelet we obtain two kinds of travel times : a group @xmath33 and a phase @xmath27 travel time .",
    "a well - known issue with @xmath27 is that it is not uniquely defined ( _ e.g. _ dsilva , 2001 ) .",
    "indeed any time congruent to @xmath27 modulo @xmath85 is an equally valid phase travel time because the gabor wavelet is the same for any of these numbers .    in return",
    ", the lack of uniqueness of @xmath27 means that the value of @xmath86 engendered by a southward flow is also not unique and depends on the value of the selected reference phase travel time .",
    "mm in the presence of a @xmath66 m s@xmath1 southward flow .",
    "upper panels : standard phase - speed filter ; lower panels : broad phase - speed filter . ]",
    "suppose that we select @xmath87  minutes as the phase travel time of @xmath28 for @xmath68  mm , and we add a @xmath59  m s@xmath1 southward flow to the numerical simulation data cube",
    ". then the gabor wavelet fitting code returns @xmath88  minutes and @xmath89  minutes , resulting in @xmath90  seconds .",
    "if we select as reference phase travel time @xmath91 minutes instead , the fitting code returns @xmath92  minutes and @xmath93  minutes , resulting in @xmath94  seconds . indeed , the @xmath31 parameter for the northward cross - covariance is @xmath95 @xmath70  rad  s@xmath1 while for the southward cross - covariance it is @xmath96 @xmath70  rad  s@xmath1 .",
    "this difference in @xmath31 is a direct consequence of the @xmath59  m s@xmath1 flow .",
    "this example shows that the same flow velocity can produce different values for @xmath86 ( here @xmath97 and @xmath98  seconds ) .",
    "this is a major difference between the three travel - time definitions studied here : gb02 and gb04 return a uniquely defined travel time , unlike the phase travel time of the gabor wavelet .",
    "figure [ fig.0c ] shows the impact of the reference phase travel time on @xmath53 as a function of the southward flow velocity , at @xmath20 mm .",
    "black lines are for the standard phase - speed filter and red lines are for the broad filter .",
    "solid lines are for a reference @xmath99 minutes ( standard filter ) or @xmath100  minutes ( broad filter ) , dashed line is for @xmath101  minutes , and dash - dotted lines are for @xmath102  minutes ( standard filter ) or @xmath103  minutes ( broad filter ) .",
    "the group travel time is @xmath104  minutes ( standard filter ) or @xmath105  minutes ( broad filter ) .",
    "]    therefore , when using the gabor wavelet definition it is necessary to define a criterion regarding which values of the phase travel time are to be selected .",
    "it is customary ( _ e.g. _ j. zhao , private communication ) to choose as phase travel times those whose value is the closest to  and if two phase travel times are equally distant , smaller than  the corresponding group travel times ( which is uniquely defined ) . it can be argued that selecting @xmath27 close to @xmath33 makes sense because that is where the cross - covariance peaks have the largest amplitude and are the furthest away from both the filter artifact and the second - bounce skip , therefore making the determination of their location more accurate . at @xmath68  mm",
    "the reference group travel time is about equally distant from @xmath87 and @xmath19  minutes .",
    "therefore the phase - travel time that we select is @xmath87  minutes .",
    "trying to fit first - bounce skip peaks located at shorter times is a difficult task as can be seen in figure  [ fig.0d ] . in this figure",
    ", the dashed lines representing the phase times do not follow the peaks of the cross - covariances for times @xmath83  minutes , confirming that these peaks are mainly filter artifacts .",
    "this criterion also has the advantage that the selected @xmath27 is close to the phase travel time @xmath106 ( @xmath107 is the ray path , @xmath108 is the total  not just horizontal  wavenumber , and d@xmath109 is the element of path length ) returned by the ray - path approximation at short @xmath17 distances ( @xmath110  minutes at @xmath68 mm , when applied to the solar model s of christensen - dalsgaard _ et al .",
    "_ , 1996 ) . at large @xmath17",
    "this is not the case anymore : for instance at @xmath20 mm , @xmath111  minutes and @xmath112  minutes according to the ray - path approximation based on model s , while the equal - to - or - smaller - than criterion implies a reference @xmath113  minutes .",
    "the reference phase travel times we select for the rest of this paper when fitting a gabor wavelet are listed in the last column of table [ table.1 ] .",
    "figure  [ fig.1 ] shows the values of the north ",
    "south difference travel - time perturbation @xmath53 as a function of the amplitude of the horizontal uniform flow .",
    "all three travel - time definitions are shown .",
    "as mentioned in the previous section , the @xmath53 for the gabor wavelet fit can be changed by selecting a different reference @xmath27 , and thus make them closer to the ones obtained with gb02 .",
    "the @xmath114 displayed are the expected values of gaussian functions fitted to the histograms of @xmath86 .",
    "fitting a gaussian seems more appropriate than reporting the spatial average of @xmath53 because of the presence of numerous misfits with the gabor wavelet and gb02 definitions ( the larger the flow , the more misfits the codes return ) , and the distribution of @xmath86 at a given @xmath17 is very close to a gaussian distribution .",
    "the presence of an intrinsic horizontal flow in the numerical simulation explains why none of the @xmath114 is equal to zero in the absence of any additional flow .",
    "both the values of @xmath53 measured from cross - covariances obtained with the standard and broad phase - speed filters are shown .",
    "there is a strong dependence of @xmath53 on the width of the phase - speed filter at small distances @xmath17 .",
    "this is hardly surprising considering the significant impact of the phase - speed filters on the shape of the cross - covariances .",
    "overall , the three travel - time definitions give significantly different answers to the question of what the travel time of a wavepacket is . at low flow velocities , gb02 and gb04",
    "agree , as expected since gb04 can be seen as a linearization of gb02 .",
    "however a non - linearity with respect to the flow velocity sets in early for gb04 ( at about @xmath59 m s@xmath1 at @xmath22 mm ) and the discrepancy with gb02 becomes increasingly larger for larger flows .",
    "indeed , gb04 appears to be inadequate for the detection of flows larger than about 700 m s@xmath1 ( at @xmath22  mm and with standard phase - speed filters ) .",
    "we note , however , that gb04 was designed to be applied to quiet - sun data only . even though at short @xmath17 all three travel - time definitions exhibit a non - linearity for the flows tested here , gb04 is the definition departing the earliest from linearity . for the three definitions the non - linearity is larger with narrower filters ( except at @xmath20  mm with gb04 ) .",
    "this emphasizes the role of the phase - speed filter in the creation of this non - linearity . at larger @xmath17 , gb02 and the gabor wavelet fit return similar values for the travel times .    with the standard phase - speed filters ,",
    "no travel - time definition returns a unique relation between @xmath53 and the flow velocity at @xmath22  mm within the range of flow amplitudes tested .",
    "indeed , a measured @xmath115  seconds might be interpreted as arising from a @xmath3  m s@xmath1 or a @xmath61  m s@xmath1 flow according to the gabor wavelet fit .",
    "this means that the inversion procedure will not be able to detect flows of the order of @xmath3 m s@xmath1 , and will instead assign a @xmath115  seconds value to a @xmath61 m s@xmath1 flow , thus underestimating the true flow velocity",
    ". therefore flows faster than @xmath116  m s@xmath1 in the shallow layers underneath the solar surface are impossible to retrieve if we are not careful with the details of the time - distance analysis ( width of the phase - speed filters ) .",
    "however such high flow velocities are essentially never present in solar data except in untracked data cubes ( cubes not corrected for the solar rotation ) .",
    "figure  [ fig.1b ] shows the derivatives of @xmath53 with respect to the flow amplitude . to display smooth derivatives ,",
    "the @xmath53 were first fitted with a polynomial of order three and the derivatives were computed from these polynomials . at @xmath22  mm the relation between @xmath53 and flow velocity becomes not linear for flows faster than roughly @xmath0  m s@xmath1 for the gabor wavelet and gb02 definitions and with standard phase - speed filters .",
    "broader filters delay the onset of non - linearity to about @xmath117 m s@xmath1 .",
    "however , at @xmath118 and @xmath19 mm , gb02 and the gabor wavelet are approximately linear for the range of flow velocity tested , except maybe at @xmath3  m s@xmath1 .",
    "gb04 is never linear in flow velocity over the entire range tested in our study .        at @xmath22  mm , and for standard phase - speed filters ,",
    "the derivatives of @xmath53 become negative for a ratio of the flow velocity ( @xmath119 ) to the phase - speed filter central phase speed ( @xmath26 ) larger than @xmath120 . at this point",
    "the definitions of travel times become inadequate because they can not discriminate between fast and slow flows , as previously mentioned .",
    "gb04 is the definition for which the derivatives turn negative at the slowest flows , followed by the gabor wavelet , and gb02 .",
    "the ratio @xmath121 at which the derivative of @xmath53 becomes negative becomes smaller and smaller with increasing @xmath17 for gb04 .",
    "the non - linearity and disagreement among travel - time definitions seem to decrease as @xmath17 increases , which is the opposite of what occurs in figures 3 and 5 of jackiewicz _ et al . _",
    "( 2007 ) , for a travel - time difference based on gb04 . however , jackiewicz _ et al . _ ( 2007 ) used ridge filtering ( f - mode filter ) and surface - gravity waves , while here we use phase - speed filtering and acoustic waves .",
    "moreover because of differences in the physical models , the oscillation power spectra are also different .",
    "therefore , it is difficult to draw any firm conclusion from this possible discrepancy between the two papers .",
    "lastly , we remind the reader that only gb04 is linear with respect to the cross - covariance . therefore , the travel time of the spatially - averaged cross - covariance is not equal to the spatial average of the travel times with gb02 and the gabor wavelet .",
    "we find that the difference between the average of the travel times and the travel time of the average cross - covariance increases with the flow velocity .",
    "this is in part due to the increasing number of misfits we encounter with these two travel - time definitions when the flow velocity increases .      following braun and birch ( 2006 ) and",
    "couvidat and rajaguru ( 2007 ) we applied gaussian frequency filters to the fourier transform of the data cube , on top of the phase - speed filters , to select three specific frequency bands .",
    "these three bands are centered on @xmath122 , @xmath123 , and @xmath21  mhz .",
    "the fwhm of these gaussian filters is 1  mhz .",
    "figure  [ fig.2 ] shows the frequency dependence of @xmath124 as a function of flow velocity for cross - covariances obtained with the standard phase - speed filters .",
    "figure  [ fig.3 ] shows the same but for broad phase - speed filters . again",
    "the impact of the phase - speed filter width is clearly visible in these plots .",
    "the travel - time difference perturbation exhibits a strong dependence on the frequency .",
    "for the gabor wavelet and gb02 the higher central frequency of the wavepacket leads to larger @xmath124 .",
    "we expect to observe a frequency dependence of the travel times : even though the argument that wavepackets with the same central phase - speed ( @xmath125 ) follow approximately the same ray path is used to justify the application of phase - speed filters prior to the computation of cross - covariances , the ray theory shows that in actuality there can be a bit of a difference in the trajectories .",
    "thus , both the upper and lower turning points of a wavepacket change with its central frequency .",
    "for instance at @xmath20 mm , with the solar model s , the upper turning point is located about @xmath126 km deeper for a wavepacket of central frequency @xmath122  mhz than for a wavepacket of central frequency @xmath127  mhz .",
    "the lower turning point changes by more .",
    "however the reversal in the sign of @xmath124 observed for fast flows at @xmath22  mm and a frequency of @xmath128  mhz can not be explained by a small change in the ray - path of the wavepacket .",
    "the complex interplay between the phase - speed filter and the wavepacket seems to be the main reason behind this strong non - linearity at low frequency .",
    "this result confirms again the interest in broad enough phase - speed filters in time - distance analysis , and that we can not ignore the details of the travel - time measurement technique when interpreting the travel times .",
    "mhz , the dashed lines are for 4  mhz , and the dot - dashed lines are for @xmath21  mhz .",
    "the black lines are the results of the gabor wavelet fit , the green lines are for gizon and birch ( 2002 ) , and the red lines are for gizon and birch ( 2004 ) . ]",
    "mhz , the dashed lines are for 4  mhz , and the dot - dashed lines are for @xmath21  mhz .",
    "the black lines are the results of the gabor wavelet fit , the green lines are for gizon and birch ( 2002 ) , and the red lines are for gizon and birch ( 2004 ) . ]      to invert the travel times and retrieve the physical perturbations to which these times are sensitive , sensitivity kernels ( _ i.e. _ a model for the linear dependence of travel - time shifts on perturbations to a solar model ) must be employed .",
    "two main approximations have been used to produce these kernels : the ray - path ( kosovichev and duvall , 1997 ) and born approximations ( birch _ et al . _ , 2001 ; gizon and birch , 2002 ; birch and gizon , 2007 , in the context of time - distance helioseismology ) . the ray - path approximation ( or geometric optics approximation ) is valid in the limit of small wavelength while the born approximation takes into account finite wavelength effects . in the ray approximation ,",
    "the travel - time difference @xmath129 caused by a flow @xmath130 is ( kosovichev and duvall , 1997 ) : @xmath131 where @xmath132 is the unit vector tangent to the ray path , and @xmath133 is the sound speed . in both the ray and born approximations ,",
    "the relationship between physical perturbation and travel - time perturbation is assumed to be linear . as can be seen in figure [ fig.1 ]",
    ", the assumption of linearity with the amplitude of the flow is a major issue when the non - linearity of the travel times sets in .",
    "this shows how far the inverted flow velocities could be from the actual flows , for flows with amplitudes above a few hundred m s@xmath1 .",
    "the thick black lines on all four panels show the variation of @xmath134  as a function of the flow velocity  predicted by equation ( [ rayp ] ) applied to model s ( which is close to the background model of the numerical simulation ) . at @xmath22 mm and for standard phase - speed filters ,",
    "the ray - path kernels seem to overestimate by a factor larger than three the sensitivity of travel times to flows . none of the travel - time definition returns results close to the ones predicted by this ray - path approximation .",
    "a way to improve the agreement between predicted and measured travel times with the gabor wavelet could be to select larger reference phase travel times .",
    "as mentioned in section @xmath135 , our cross - covariances are always averaged over a @xmath17-distance range to improve their signal - to - noise ratio . on the other hand ,",
    "the ray - path kernels we compute here are for the specific @xmath17 listed in table [ table.1 ] ( no average over a range of @xmath17 )",
    ". therefore we do not expect perfect agreement between the @xmath134 predicted by the ray - path kernels and the measured @xmath134 .",
    "however , we also computed cross - covariances that are not averaged over @xmath17 for comparison , and the travel times that we measured on these cross - covariances are very close to the travel times measured on the averaged cross - covariances ( the maximum difference between the two @xmath134 occurred at flows faster than @xmath62 m s@xmath1 and was only about five seconds ) .",
    "we added spatially - uniform steady southward flows of amplitudes ranging from 0 to @xmath3  m s@xmath1 to the vertical velocity data cube of a numerical simulation of solar convection .",
    "these southward flows produced a perturbation in the north ",
    "south difference travel times of acoustic wavepackets .",
    "we measured these travel times using three different definitions : the gabor wavelet ( duvall and kosovichev , 1997 ) , gizon and birch ( 2002 ) , and gizon and birch ( 2004 ) .",
    "the customary use of the phase travel time returned by the gabor wavelet fit instead of the group travel time creates an ambiguity regarding the value of the difference travel - time perturbation engendered by a given flow velocity .",
    "this is a direct consequence of the lack of uniqueness of the phase travel time together with the fact that horizontal flows shift the central temporal frequency of the wavepackets .",
    "this ambiguity in the travel - time difference is a major issue especially when we try to interpret this difference using sensitivity kernels .",
    "conversely , gb02 and gb04 return uniquely defined travel times . at short distances @xmath17 between observation points ,",
    "all three travel - time definitions exhibit a non - linearity with respect to the flow amplitude . at these short distances , the details in the calculation of the cross - covariances , and especially the width of the phase - speed filters ,",
    "prove crucial .",
    "broader phase - speed filters may be preferable because they push the onset of non - linearity to larger flow amplitudes .",
    "gb04 is the definition of travel times that departs the earliest from linearity : the onset seems to be at flow amplitudes as low as about @xmath59  m s@xmath1 .",
    "therefore the use of gb04 can be problematic when not applied strictly to the quiet sun .",
    "in addition , we note that supergranules have flow velocities that can exceed @xmath59  m s@xmath1 , and therefore the use of inversion procedures on travel - time differences obtained by the gb04 definition could return incorrect velocities ( in particular underestimated velocities ) . gb02 and the gabor wavelet also exhibit a sudden drop in the travel - time difference at flows faster than 1  km s@xmath1 at @xmath22 mm with standard phase - speed filters .",
    "this means that fast flows near the solar surface will produce the same travel - time difference as slower flows .",
    "flows of these amplitude are not common in tracked data cubes where the effect of solar rotation has been largely removed .",
    "the non - linearity of the travel - time shifts is reduced for the case of broad phase - speed filters . at distances ( @xmath17 ) larger than or equal to @xmath19",
    "mm both gb02 and the gabor wavelet definitions produce travel - time differences that vary essentially linearly with respect to flow amplitude , within the velocity range studied here .",
    "if a non - linearity sets in , it is for flows much faster than @xmath136  km s@xmath1 . at distances less than about 17  mm",
    ", the sensitivity kernels produced by the ray - path approximation fail to explain the sensitivity of travel - time differences to flows .",
    "the work of sc was supported by nasa grants nnx07ak36 g ( mdi ) and nng05gm85 g ( lws ) .",
    "the work of acb was supported by nasa grant nnh06cd84c .",
    "the numerical simulations were performed by robert f.  stein , ake nordlund , dali georgobiani and david benson , supported by nasa grants nng04gb92 g and nag 512450 , nsf grants ast-0205500 and ast-0605738 , and by grants from the danish center for scientific computing .",
    "the authors thank kosovichev for encouraging a work that led to this paper .",
    "the authors also thank georgobiani for her help in dealing with the details of the numerical simulation , and braun , crouch , and woodard for useful comments regarding a draft of this paper .",
    "3 benson , d. , stein , r. , nordlund , a. : 2006 , in : leibacher , j. , stein , r.f . , uitenbroek , h. ( eds)_solar mhd theory and observations : a high spatial resolution perspective _ , asp conference series * 354 * , astronomical society of the pacific , san francisco , 92 .",
    "birch , a.c .",
    ", gizon , l. : 2007 , _ astron .",
    "nachr . _ * 328 * , 228 .",
    "birch , a.c . , kosovichev , a.g . ,",
    "price , g.h .",
    ", schlottmann , r.b . : 2001 , _ astrophys .",
    "j. _ * 561 * , l229 .",
    "braun , d.c . , birch , a.c .",
    ": 2006 , _ astrophys .",
    "j. _ * 647 * , 187 .",
    "braun , d.c . ,",
    "birch , a.c . , benson , d. , stein , r.f . ,",
    "nordlund , a. : 2007 , _ astrophys .",
    "j. _ * 669 * , 1395 .",
    "christensen - dalsgaard , j. , dppen , w. , ajukov , s. , anderson , e.r . ,",
    "antia , h.m . ,",
    "basu , s. , _ et al .",
    "_ : 1996 , _ science _ * 272 * , 1286 .",
    "couvidat , s. , rajaguru , s.p . : 2007 , _ astrophys . j. _ * 661 * , 558 .",
    "couvidat , s. , birch , a.c . ,",
    "kosovichev , a.g .",
    ": 2006 , _ astrophys .",
    "j. _ * 640 * , 516 .",
    "couvidat , s. , gizon , l. , birch , a.c . , larsen , r.m .",
    ", kosovichev , a.g .",
    ": 2005 , _ astrophys .",
    "j. suppl . _",
    "* 158 * , 217 .",
    "dsilva , s. : 2001 , _ astrophys .",
    "j. _ * 549 * , l135 duvall , t.l . ,",
    "gizon , l. : 2000 , _ solar phys . _ * 192 * , 177 .",
    "duvall , t.l . ,",
    "jefferies , s.m . , harvey , j.w . , pomerantz , m.a .",
    ": 1993 , _ nature _ * 362 * , 430 . duvall , t.l .",
    ", kosovichev , a.g . , scherrer , p.h . ,",
    "bogart , r.s . , bush , r.i . ,",
    "de forest , c. , hoeksema , j.t .",
    ", schou , j. , saba , j.l.r .",
    ", tarbell , t.d . , title ,",
    "a.m. , wolfson , c.j .",
    ", milford , p.n . : 1997 , _ solar phys . _ * 170 * , 63 .",
    "georgobiani , d. , zhao , j. , kosovichev , a.g .",
    ", benson , d. , stein , r.f . , nordlund , a. : 2007 , _ astrophys .",
    "j. _ * 657 * , 1157 .",
    "gizon , l. , birch , a.c . : 2002 , _ astrophys . j. _ * 571 * , 966 . [ gb02 ] gizon , l. , birch , a.c . : 2004 , _ astrophys",
    ". j. _ * 614 * , 472 .",
    "[ gb04 ] hirzberger , j. , gizon , l. , solanki , s.k . ,",
    "duvall , t.l . : 2007 , _ solar phys . _ * 251 * , 417 .",
    "jackiewicz , j. , gizon , l. , birch , a.c . ,",
    "duvall , t.l . : 2007 , _ astrophys .",
    "j. _ * 671 * , 1051 .",
    "kosovichev , a.g .",
    ", duvall , t.l . : 1997 , in : pijpers , f.p .",
    ", christensen - dalsgaard , j. , rosenthal , c.s .",
    "_ proceedings of score96 : solar convection and oscillations and their relationship _ , kluwer , astrophysics and space science library * 225 * , dordrecht , 241 .",
    "kosovichev , a.g . ,",
    "duvall , t.l . ,",
    "scherrer , p.h . : 2000 , _ solar phys . _ * 192 * , 159 .",
    "scherrer , p.h .",
    ", bogart , r.s . , bush , r.i . ,",
    "hoeksema , j.t . ,",
    "kosovichev , a.g . , schou , j. , _ et al .",
    "_ : 1995 , _ solar phys .",
    "_ * 162 * , 129 .",
    "stein , r.f . ,",
    "nordlund , a. : 2000 , _ solar phys .",
    "_ * 192 * , 91 .",
    "zhao , j. , kosovichev , a.g . : 2003 , in : sawaya - lacoste , h. ( ed . ) _ proceedings of soho 12 / gong+ 2002 . local and global helioseismology : the present and future _ , * sp-517 * , esa , noordwijk , 417 .",
    "zhao , j. , kosovichev , a.g . ,",
    "duvall , t.l . : 2001 , _ astrophys . j. _ * 557 * , 384 .",
    "zhao , j. , georgobiani , d. , kosovichev , a.g . , benson , d. , stein , r.f . ,",
    "nordlund , a. : 2007 , _ astrophys .",
    "j. _ * 659 * , 848 ."
  ],
  "abstract_text": [
    "<S> we study the sensitivity of wave travel times to steady and spatially homogeneous horizontal flows added to a realistic simulation of the solar convection performed by robert f. stein , ake nordlund , dali georgobiani , and david benson . </S>",
    "<S> three commonly used definitions of travel times are compared . </S>",
    "<S> we show that the relationship between travel - time difference and flow amplitude exhibits a non - linearity depending on the travel distance , the travel - time definition considered , and the details of the time - distance analysis ( in particular , the impact of the phase - speed filter width ) . for times measured using a gabor wavelet fit , the travel - time differences become nonlinear in the flow strength for flows of about @xmath0 m s@xmath1 , and this non - linearity reaches almost @xmath2 at @xmath3 m s@xmath1 ( relative difference between actual travel time and expected time for a linear behaviour ) . </S>",
    "<S> we show that for travel distances greater than about 17  mm , the ray approximation predicts the sensitivity of travel - time shifts to uniform flows . for smaller distances </S>",
    "<S> , the ray approximation can be inaccurate by more than a factor of three . </S>"
  ]
}