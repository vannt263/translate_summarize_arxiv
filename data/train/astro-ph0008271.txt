{
  "article_text": [
    "the effects of radiation and cosmic rays can be a formidable source of data loss for a space - based observatory .",
    "the authors have been studying the question of cosmic ray identification and mitigation in the context of processing data for the next generation space telescope ( ngst ) .",
    "the deep space , high - radiation environment proposed for the ngst ( stockman , 1997 ) and the long observing times needed to complete some of the ngst design reference mission programs suggest that careful planning for cosmic ray mitigation is needed ( stockman et  al . , 1998 ) .",
    "although this study was motivated by the ngst requirements , the methods and results presented here are not specific to the ngst and may be applied to many instruments and observatories .    when a cosmic ray impacts a detector , an undetermined amount of charge is deposited in the photo - conducting layer .",
    "when that happens , any unrecorded information stored in the detector at that location is lost and can not be recovered . in a high - radiation environment",
    "( such as deep space ) , the data loss due to cosmic ray events in the detector may impose limits on observation parameters , such as maximum integration time , which in turn will limit  or prevent  some science programs .",
    "several solutions to the problem of identifying and removing cosmic rays exist .",
    "the most straightforward approach is to integrate multiple times , filter the outliers ( pixels in an array with signal different from an expectation value generated from the full image set ) , and co - add the resulting images .",
    "we have additional options if the detector can be sampled non - destructively ( i.e. the detector can be read without being reset ) , a feature that is available on some current and future detectors ( e.g. fowler & gatley , 1990 ; garnett & forrest , 1993 ; fanson , et  al . , 1998 ) ,",
    "including those being studied here .",
    "we evaluate and validate up - the - ramp sampling with on - the - fly cosmic ray identification and mitigation , which is described in detail by fixsen , et  al .",
    "( 2000 ) . in this method , the detector is sampled non - destructively at uniform intervals , resulting in a set of reads following the accumulating charge in the detector over time .",
    "the signal is measured as the slope of the accumulating charge `` ramp , '' and cosmic rays and similar glitches can be identified and discarded from the signal measurement .",
    "several concerns about this method exist , namely that the method is too compute - intensive , that it requires detailed calibration with the detector and the approach is too simplistic for the complicated processes involved .",
    "computation requirements are discussed by fixsen , et  al .",
    "this paper will validate the up - the - ramp method without detailed calibration or complicated models .",
    "the most commonly - discussed alternative to up - the - ramp sampling is fowler sampling ( fowler & gatley , 1990 ) , in which multiple samples are taken at the start and at the end of an observation to effectively measure the difference @xmath0 times , where @xmath0 is the number of sample - pairs .",
    "fowler sampling , however , does not provide an opportunity to identify and remove cosmic rays from an observation .",
    "in addition , in the read - noise limit , up - the - ramp sampling provides modestly ( @xmath1 ) higher signal - to - noise than fowler sampling ( garnett & forrest , 1993 ) . for a detailed comparison of signal - to - noise for fowler and up - the - ramp sampling , see appendix  [ app : snr ] .",
    "we utilize data sets from radiation tests which were performed during the design and construction of the sirtf space - based observatory .",
    "the data sets are from insb and si : as infrared detectors ; we discuss each set individually .",
    "we apply the up - the - ramp sampling algorithm presented by fixsen , et  al .  and examine the results .",
    "we validate the up - the - ramp approach as a low - cost solution to mitigating cosmic rays and demonstrate the quality of the resulting data .",
    "section  [ sec : algorithm ] is a summary description of the up - the - ramp processing algorithm .",
    "section  [ sec : interaction ] provides a description of the interactions between charged particles and detectors , with particular emphasis on the effects of cross - talk in the detectors .",
    "section  [ sec : insbdata ] describes the insb data set ; section  [ sec : siasdata ] describes the si : as data set .",
    "we discuss the results of the algorithm as applied to the insb data set in section  [ sec : insbdiscussion ] .",
    "section  [ sec : siasdiscussion ] discusses the results from the si : as data .",
    "the main text concludes in section  [ sec : conclusion ] .",
    "a detailed discourse on signal - to - noise when considering cosmic rays is in the appendix .",
    "the details of the up - the - ramp algorithm can be found in fixsen , et  al .",
    "a shorter version is presented in offenberg , et  al.(1999 ) , although the algorithm has been revised since that writing .",
    "we provide a summary description of the method here .",
    "the up - the - ramp algorithm assumes a non - destructive set of @xmath0 samples for an integration . the general approach does not require the samples be spaced uniformly in time , but it will be most efficient if they are and the implementation used in this study does assume uniform sampling .",
    "when processing these data , we process each pixel individually ; although there are indications that a radiation event on the detector will affect neighboring pixels via electronic cross - talk ( see section  [ sec : interaction ] ) , there is no attempt made to `` impugn neighbors '' of pixels suspected of being impacted by a cosmic ray .",
    "we first identify and remove saturated pixels . to estimate the signal per unit time , we need to discard the samples when the charge - well is full and no data can be collected ; in practice there is a region of non - linear response before the detector charge - well is full which should also be discarded .",
    "we identify saturated pixels by defining a cut - off value for the upper limit of the linear region of the detector s response curve .",
    "the samples in an observation sequence are compared to this cut - off from the last observation to the first , stopping when a non - saturated sample is found .",
    "the saturated samples are discarded from further computation .",
    "next , we search for cosmic rays and other glitches .",
    "we start with a signal estimate ; a simple estimate is the mean signal accumulated during one sample time , @xmath2 .",
    "we first seek the worst point , which is measured as the sample @xmath3 with the maximum value @xmath4 .",
    "we then examine the series by comparing the maximum value of @xmath5 found to @xmath6 , which is the expected noise based on the known read - noise and the photon shot - noise determined by the signal estimate @xmath7 . if @xmath8 , ( where @xmath9 is a tunable cosmic - ray threshold ) , @xmath10 represents a glitch .",
    "@xmath10 is then discarded from the data set , @xmath7 is updated , and the search for cosmic rays is repeated .",
    "we stop when the worst outlier is within the bounds of acceptable variation .",
    "there are several points that need to be made about the algorithm described in the previous paragraph .",
    "we seek cosmic ray glitches in both the positive and negative sense for several reasons .",
    "although cosmic rays will normally inject ( not subtract ) charge to the detector , negative - sense glitches can occur as the result of impacts on the electronics .",
    "also , the statistical test used to identify cosmic rays will be subject to false - positive identificiations  to avoid biasing the data , we must discard such outliers in both directions .",
    "we reject only one outlier on each pass as we have found that procedure to be the most robust in the case of multiple cosmic rays .",
    "we then fit the remaining data to a line using a weighted least - squares fit ",
    "the figure of interest is the signal per unit time , which is the slope of this line .",
    "the weights are determined by the signal - to - noise estimate , based on the signal estimate @xmath7 computed earlier and the read noise of the detector ; in low signal - to - noise cases , the data points are weighted evenly for the fit . in high signal - to - noise cases ,",
    "the end - points are weighted more heavily than the middle - points . to speed up the algorithm ,",
    "we precompute the coefficients to produce this weighted fit for a set of signal - to - noise values , and select the fit corresponding to the highest signal - to - noise which is less than the measured value .",
    "this approximation is less than optimal , but is very close to optimal with as few as 8 s / n values and does not bias the results . underestimating the noise in the data",
    "is a much worse case than overestimating the noise , so we consistently choose the weighting to overestimate the noise , corresponding to lower signal - to - noise ratio ( fixsen , et  al . , 2000 ) .    in the case where a sequence is broken up by one or more cosmic rays ,",
    "the slope is computed for each segment uninterrupted by a cosmic ray , saturated or other glitch sample .",
    "the slopes are then combined using a weighted average , where each slope is optimally weighted .",
    "we set the noise and detector saturation levels to appropriate values for the data sets being processed , but did not otherwise alter the algorithm or tune the cosmic ray detection algorithm parameters .",
    "in particular , the threshold for identifying a cosmic ray in the tests described here was @xmath11 , the optimum threshold found by fixsen , et  al .",
    "for their test case .",
    "when an energetic cosmic ray interacts with an ir detector , its main effect is to excite charge in the photo - conducting layer of the detector , contributing signal to the detector in the region impacted .",
    "the precise amount of charge injected is effectively random with some probability distribution , as it depends on several factors ( e.g. the energy of an individual cosmic ray ) which are either random or which can not be recovered _ a posteriori_. in short , an energetic cosmic ray injects an unknowable amount of energy into the detector  this , in effect , destroys the information recorded in the impacted pixel(s ) since the last measurement .",
    "a cosmic ray interacting with the detector can have effects which persist for a significant time after the initial impact .",
    "for example , if a cosmic ray liberates a very large amount of charge from the detector s photo - conducting layer in a short time , it may take a measurable time while electrons repopulate the detector material , during which time the gain in that pixel might be flat , or varying over time .",
    "note that this and similar effects might persist for seconds or minutes  given sufficient recovery time , the detector will function as before the cosmic ray hit in most cases .",
    "the net effect of these persistent effects is that data collected at a detector pixel element might be invalid for a time after a cosmic ray hit .",
    "this can be accommodated by modifying the data  fitting algorithm to ignore a set number of samples after a cosmic ray detection . for this study",
    ", we assume that persistent effects in the insb and the si : as arrays are small and can be ignored .",
    "a particle event can induce cross - talk between neighboring pixels .",
    "this effect increases the number of pixels affected by a particle impact beyond those directly hit  a potentially significant source of data loss . in a detector array , such as those being described here , cross - talk can occur either in the multiplexer or in the array itself . in the insb arrays studied here ,",
    "pixels are read out every 4 columns  so multiplexer - based cross - talk ( `` mux bleed '' ) will result in spurious signal 4 columns away from a pixel impacted by a cosmic ray . if , for example , one has just read out the pixel at coordinate @xmath12=144 , @xmath13=152 , the next pixel to be read ( in time ) will be @xmath12=148 , @xmath13=152 .",
    "figure  [ psf ] clearly shows this effect .",
    "the most important source of cross - talk in the detector array ( as opposed to the multiplexer ) is charge diffusion .",
    "once charges are created in the photo - conductive layer , their motion is governed by charge diffusion and the potential established by pixel electrodes .",
    "holloway ( 1986 ) has numerically solved the charge - diffusion equation for a 2-dimensional detector array .",
    "he found that cross - talk diminished approximately exponentially with radius .",
    "moreover , the amount of cross - talk depends on how far from the electrodes charge is created . for light ,",
    "long wavelengths tend to be absorbed deep in the photo - conductive layer , near the depletion region , and have less cross talk than shorter wavelengths which would be absorbed at shallower depths . because particle events liberate charge all along their path",
    ", we expect the amount of cross - talk would be intermediate between that generated by short and long wavelength light . , and because the voltage change produced by one charge , d@xmath14 , scales as @xmath15",
    ", the resulting array would have reduced output gain and consequently higher readout noise . ]",
    "the cross - talk effect was studied and quantified in the insb data set for a different study ( rauscher et  al .",
    ", 2000 ) . to measure this effect , rauscher et  al .  stacked a large number , @xmath16100 , of proton hits and the pixels surrounding them .",
    "we define the term `` edge - neighbors of a pixel '' to refer to the four pixels which share an edge with the pixel in question ; the `` corner - neighbors of a pixel '' are those which have a common corner but no common edge with the pixel in question . in the insb data set , the edge - neighbors of a pixel impacted by a particle hit exhibited a cross - talk - induced signal of about 1.7% of the signal in the central , impacted pixel .",
    "the corner - neighbors also showed a cross - talk - induced signal , about an order of magnitude less than the edge - neighbors .",
    "figure  [ psf ] shows that multiplexer - induced cross - talk is present in this data set as well , at about the same magnitude as the corner - neighbors .",
    "the corner - neighbors and the multiplexer - induced cross - talk are faint with respect to the read noise , typically at or below @xmath17 , and thus will be indistinguishable from random noise .",
    "this approach was duplicated for the si : as data set with a set of @xmath1636 proton hits . in the si : as data set , figure  [ psf_sias ] , the magnitude of the cross - talk in the edge - neighbors was about 3.0% of the signal in the impacted pixel , while the corner - neighbors were impacted by about an order of magnitude less than the edge - neighbors .",
    "there are also signs of multiplexer - induced cross - talk , also on par with the corner - neighbors .",
    "again , both the corner - neighbor and multiplexer - induced cross - talk are below @xmath17 and should be indistinguishable from random noise .",
    "the net effect of this cross - talk is that most particle events will affect a clump of pixels in a cross or an extended cross in the case of a particle which passes through multiple pixels . in the case of `` glancing '' cosmic rays , which inject relatively small signals",
    ", the signal induced by cross - talk in some or all of the edge - neighbors could fade into the noise , in which case a smaller clump or only one pixel might be affected measurably .",
    "one way to increase the ability of the cosmic ray detection algorithm is to add an `` impugn neighbors '' step , by which we mean either lowering the threshold for finding glitches , or rejecting outright , pixels which neighbor a glitch when one is found .",
    "such a step will add very little to the running time , as the up - the - ramp software is already dominated by input ( fixsen et  al .",
    ". however , we are concerned that adding such a step might cause the cosmic ray identification algorithm to discard excessive amounts of valid data , to the detriment of the overall data quality . rather than modify the fixsen et  al .",
    "algorithm , we apply the algorithm as originally presented to determine the level of its success without adding an `` impugn neighbors '' step .",
    "the result of a cosmic ray event is the loss of one interval during the up - the - ramp observation ( potentially plus a few extra intervals if the detector shows persistent effects ) for a group of pixels clumped in a ( sometimes incomplete ) cross - shaped pattern .",
    "this loss degrades the quality of the data - fitting routine ; on average , the signal - to - noise ratio for a cosmic - ray pixel is reduced by 1/@xmath18 for low - signal cases , up to @xmath19 for high - signal cases with @xmath0 samples .",
    "of course , this reduction in signal - to - noise will often be preferable to the alternative , which is total loss . furthermore , as fixsen , et  al .",
    "point out , on - the - fly cosmic ray rejection enables longer integration times , which provides a straightforward way to increase the signal - to - noise to compensate for such loss .",
    "the insb data are from a @xmath20-pixel insb ( indium antimonide ) detector array which researchers at the university of rochester subjected to proton flux at the harvard cyclotron .",
    "each 172-millisecond integration was recorded as one fowler pair ( fowler & gatley , 1990 ) , followed by a reset of the detector . as a result , each raw sample of the detector represents an independent 172 ms integration .",
    "we use a set of 99 such images .",
    "so we can apply the up - the - ramp algorithm to this data set , we co - add the independent samples to create an up - the - ramp sequence ( i.e. the up - the - ramp samples are generated from the raw samples via @xmath21 , @xmath22 ) .",
    "the set @xmath23 approximates a uniformly - sampled data set ; for example , the covariance of the samples does not match the form of the covariance assumed in the data processing algorithm ( fixsen , et  al . , 2000 ) .",
    "since this is an approximation to a up - the - ramp sequence , we are making use of less - than - ideal data to conduct this test .",
    "however , the differences should be slight and should not affect the overall validity of the results of this test .",
    "the array was irradiated using a 70 mev beam ; the dewar walls attenuated the energy to 20 mev .",
    "the rochester team conducted these tests with the proton beam emitting @xmath24  protons  @xmath25  s@xmath26 . from the array pixel size of @xmath27 pixels and the fact that there are @xmath28 pixels in the detector , we find that the array is impacted by approximately @xmath29  protons  sec@xmath26 .",
    "this is approximately equal to the ion flux which would be expected in deep space at the height of a major solar event , between 3 and 4 orders of magnitude greater than the `` typical '' cosmic ray flux in deep space , and so represents a severe test of the cosmic ray detection algorithm .",
    "( barth & isaacs , 1999 ; tribble 1995 ) .",
    "the path through the detector array of a cosmic ray from an isotropic distribution is effectively random .",
    "however , for the insb radiation test , the proton beam had a predetermined angle of incidence , 23 degrees from the plane of the detector . coupled with the insb pixel dimensions of @xmath30",
    ", we calculate that the projection of the typical proton s path onto the plane of the detector array is about 19@xmath31 long .",
    "if we project this path length onto random locations on the plane of the detector , we find that about half of the protons will pass through 1 pixel and about half will pass through 2 pixels . for this computation , we ignore the effects of scattering and secondary particles .",
    "when a proton physically passes through 1 pixel , cross - talk effects will cause a total of 5 pixels to be affected at the @xmath32 level or higher .",
    "when a proton passes through 2 pixels , 8 total pixels are affected at @xmath32 or higher . if we assume a 50 - 50 split between these two cases for the insb data set , an average of 6.5 pixels are affected per proton . since we expect the insb detector array will encounter @xmath29  protons  sec@xmath26 , we find that about 13.8% of the detector array is affected by radiation for each 172 ms second sample .",
    "this type of analysis presents difficulties in performing formal uncertainty analysis , but we estimate that these numbers are good to @xmath33% .    a sample image from the raw insb data set appears in figure  [ insbraw ] .",
    "this is a raw image , randomly chosen from the original sequence ( @xmath34 in the notation used earlier ) , and the number of cosmic rays on this image is that of a single 172 millisecond interval .",
    "the images are mostly dark frames . to create a `` pseudo - real sky '' image for comparison purposes ,",
    "we create a median image , figure  [ insbmedian ] , in which each pixel is the median value of the raw samples for that pixel .",
    "we then scale to the full integration time by multiplying the median values by 99 , the number of samples in the observation sequence .",
    "the result compares favorably with an illuminated flat field frame .",
    "the observed `` tree ring '' structure , representing doping density variations in the insb , appears in illuminated frames but not in dark current frames .",
    "thus , either there is a small light leak , or the filter wheel has been warmed by proton irradiation , illuminating the array , albeit to a very low level .",
    "similarly , there is a readout `` glow '' ; this effect is present over the entire image but is most pronounced in the first few rows sampled ( corresponding to the bottom of the frame ) .",
    "the si : as data are from a @xmath35-pixel region of a @xmath20-pixel si : as ( silicon doped with arsenic ) ibc detector which was subjected to proton flux at the university of california  davis cyclotron .",
    "the si : as data set is a series of 52-millisecond integrations , each recorded as a 1 fowler - pair observation ( fowler & gatley , 1990 ) , followed by a reset of the detector .",
    "a @xmath35-pixel subregion of the detector was used ; the photo - conducting region of each pixel was approximately @xmath36 .",
    "as in the insb case , the data are dark frames .",
    "we generate an approximate up - the - ramp sequence by co - adding 36 independent samples using the same procedure described in section  [ sec : insbdata ] .",
    "the caveats regarding the use of this approximation which were discussed in section  [ sec : insbdata ] apply to the si : as data as well .",
    "these differences still should not affect the overall validity of the results of this test .",
    "the array was irradiated with a 67 mev proton beam operating in an uncalibrated mode ( i.e. the proton flux is not independently known ) .",
    "the proton beam passed through only a thin plastic window on its way to the detector ",
    "there was no dewar wall in the proton beam path , as there was in the insb data set .",
    "as a result , the protons should not be scattered or attenuated appreciably .",
    "as the proton flux was not directly measured , the only source of information with regard to the number of events expected on the detector is the data set itself .",
    "we estimate the number of events by examining a sequence of 36 raw ( difference ) samples and counting the number of outliers from the background dark value as a function of the outlier threshold ; we expect the read noise to be a gaussian distribution and thus the number of outliers due to read noise should fall off in a gaussian pattern as we increase the threshold .",
    "outliers caused by protons , which should be large with respect to the dark value , will not fall off at low multiples of @xmath6 . in the sample we tested ,",
    "the number of outliers flattened out in the interval 4@xmath6-to-5@xmath6 .",
    "if we use these values as the lower and upper limits for the threshold , we find that between 3.0% ( @xmath37 ) and 2.4% ( @xmath38 ) of the pixels should be identified as particle hits or neighbors impacted by cross - talk for each interval . for a 36-frame sequence of @xmath35-pixel images , we expect to find around @xmath39 pixels impacted by cosmic rays during the observation .",
    "this figure includes pixels impacted both by cosmic rays and by cross - talk ( see section  [ sec : interaction ] ) .",
    "since the proton beam was oriented normal to the plane of the detector , most of the protons would physically pass through one pixel ; based on the cross - talk model , we expect that @xmath1620% of the glitches are cosmic - ray hits , the rest being caused by cross - talk .",
    "we find that the cosmic ray flux is approximately @xmath40  protons  s@xmath26  @xmath25 .",
    "this flux is about a factor of 6 lower than that used in the insb test .",
    "the signal in the si : as images is heavily quantized ( i.e. the histogram of the data values is fairly sparse ) .",
    "the statistical tests used to identify the cosmic ray glitches and the line - fitting algorithm from fixsen , et  al .  will perform best when the data are continuous or the level of quantization is small relative to the size of the data .",
    "although we do not expect this to be a major problem , the uncertainty in the results from the line - fitting routine may be larger than it would otherwise be .    a sample image from the raw si : as data set appears in figure  [ siasraw ] .",
    "this is a raw image , randomly chosen from the original sequence ( @xmath41 in the notation used in section  [ sec : insbdata ] ) , and the number of cosmic rays on this image is that of a single interval , 52 milliseconds . to create a `` pseudo - real sky '' image for comparison purposes ,",
    "we create a median image , figure  [ siasmedian ] , in which each pixel is the median value of the raw samples for that pixel .",
    "we then scale to the full integration time by multiplying the median values by 36 , the number of samples in the observation .",
    "the output data image from the processing the 99 insb samples appears in figure  [ insbresult ] .",
    "a difference image between this image and the median image appears in figure  [ insbdifference ] .",
    "figure  [ insbmask ] shows the pattern of cosmic rays identified in a randomly - chosen sample ( the same sample that is shown in figure  [ insbraw ] ) .",
    "we perform one simple tuning operation with this data set to verify that the cosmic ray threshhold of @xmath11 used by fixsen , et  al .   was appropriate for this data set .",
    "we divide the 99-image sequence of insb samples into two 49-image sequences ( discarding one ) , and generate two up - the - ramp sequences .",
    "the two sequences are then processed using a series of cosmic ray rejection threshholds , generating one pair of output images for each threshhold value .",
    "we measure the uncertainty of the threshhold value as the rms difference between the two images of each pair for that value .",
    "we examine the threshholds to be in the range of @xmath42 equally spaced at intervals of @xmath43 ( i.e. @xmath44\\sigma$ ] ) .",
    "the initial pass shows a minimum between @xmath37 and @xmath38 , so we repeat the test between these two values at intervals of @xmath45 .",
    "the results are shown in figure  [ insbrms ] ; the minimum appears at @xmath11 . because there are insufficient samples to repeat this test reliably with the si : as data set , we adopt @xmath11 as the threshhold value for that data set as well .",
    "we also find median image for the two subimage sequences , and compute the rms difference for the two median images .",
    "the rms difference at @xmath11 is 3.24 , compared with the value of 2.33 for the median case ; however , if we discard the pixels for which contain a surviving cosmic ray in either image of each set ( 27 pixels in the up - the - ramp case , 49 pixels in the median case ) , the up - the - ramp rms difference drops to 1.34 , whereas the rms for the median images is 1.37 .    as discussed in section  [ sec : insbdata ] , we find that 13.8% of the detector should be affected by a proton or by cross - talk for each sample ; the total number of pixels affected by protons plus those affected by cross - talk comes to 895,000 for the entire sequence ( @xmath46 , using our ballpark estimate of 25% for the uncertainty in this number ) .",
    "the cosmic ray rejection algorithm , with the minimal tuning , identifies and rejects 1,063,000 bad samples from this observation sequence .",
    "this number lies within the uncertainty range for the number of expected bad samples",
    ". we must be cautious against reading too much into this result , but it is safe to say that the number of cosmic rays identified is in the right ballpark .",
    "the overall performance can be improved by tuning the parameters of the algorithm , which will require repeated and detailed radiation tests with the detector .",
    "an examination of figure  [ insbmask ] shows that most of the cosmic ray detections are clumped in cross - hatch patterns , matching the current - leak pattern described in section  [ sec : interaction ] .",
    "thus , the cosmic - ray identification algorithm catches many of the neighboring pixels affected by cross - talk without having to add an `` impugn neighbors '' step , as described in section  [ sec : interaction ] . when the full energy spectrum of cosmic rays in deep space is considered , the amount of charge injected , and the resulting signal , will often be smaller than that induced by a cyclotron proton . the fact that the cosmic ray identification algorithm catches the neighbor - leak events shows that it is capable of identifying the full spectrum ( i.e. bright , faint and in - between ) of cosmic rays that we expect to encounter in a deep space environment ( contrasted with the limited particle energy spectrum generated by the cyclotron ) .",
    "as this is a dark frame , faint bad pixels stand out from their neighbors ; the current cosmic ray identification software might not work as well in brighter regions of the image , where increased poisson noise will affect the statistical test used to identify cosmic rays .",
    "brighter images and fainter cosmic rays will combine to mask the `` neighbor - leak '' events  tuning the algorithm to the specific detector would minimize the impact of these effects , but a step to `` impugn neighbors '' might still be required during astronomical observations .",
    "the frames in this study are dark frames . as was discussed in section  [ sec : insbdata ] , there appears to be a small light leak or thermal glow which is faintly illuminating the array as a whole .",
    "there is also an apparent `` glow '' effect , which is most prominent in the first few rows sampled ( the bottom of the image in the orientation shown in figure  [ insbmedian ] and figure  [ insbresult ] ) .",
    "the only other non - random contributions to the flux should be the dark current , `` hot '' pixels and other detector artifacts . by taking the image generated from performing the median operation on the raw data set , figure  [ insbmedian ] , and scaling up from 1 sample to 99 by multiplication , the dark value is computed to be @xmath47 data units ( 1.8 electrons per data unit ) .",
    "the dark value on the processed image is computed to be @xmath48 data units  the median and processed median dark values agree very strongly , well within the margin for error .",
    "in addition , note that the readout `` glow '' at the bottom of the image as well as the faint `` tree ring '' structure over much of the detector , both of which appear in figure  [ insbmedian ] , are preserved in figure  [ insbresult ] ( both of those effects can be mistaken for errors in printing or reproduction , but they are genuine ) .",
    "overall , the processed image and the median image agree very well at most individual pixels to within the uncertainty of the dark level established in the previous paragraph .",
    "99.5% of all pixels agree within this tolerance ; most of the remainder are surviving cosmic rays .",
    "this result , combined with the estimated number of cosmic ray events derived earlier , suggests that the cosmic ray algorithm successfully identified and removed over 99.96% of the proton events on the detector .",
    "we examine in detail the pixels in which the processed image and the median / comparison image disagree by at least @xmath32 .",
    "a total of 88 pixels fit into this category ; 44 of them occur in places where both of the images are high - signal ( detector hotspots ) , and thus where we expect that higher poisson noise , non - linear response and other effects increase the normally - expected noise . of the remaining 44 instances ,",
    "35 are cases where the processed image is brighter than the median image ; these are cosmic rays which were missed by the cosmic ray detection algorithm .",
    "the remaining 9 instances , where the processed image is darker , are all cases where more than half of the samples were affected by cosmic rays , so the median of the sample is a cosmic ray sample  these 9 pixels contain cosmic rays which were caught by the algorithm in fixsen , et  al . , but which the median operation missed .",
    "the output data image from the processing the 36 si : as samples appears in figure  [ siasresult ] .",
    "a difference image between this image and the median image appears in figure  [ siasdifference ] .",
    "figure  [ siasmask ] shows the pattern of cosmic rays identified in a randomly - chosen sample ( the same sample that is shown in figure  [ siasraw ] ) .    as discussed in section  [ sec : siasdata ] , we expect to find @xmath39 pixels affected by a proton or cross - talk during the full 36-sample observation .",
    "the cosmic ray rejection algorithm , with only the minimal tuning described in section  [ sec : intro ] , identifies and rejects 1230 bad samples during the observation sequence .",
    "this number lies outside of the uncertainty range for the number of expected bad samples , but by a small margin .",
    "again , the result is promising .",
    "an examination of figure  [ siasmask ] shows that most of the cosmic ray detections are clumped in cross - hatch patterns , again matching the current - leak pattern described in section  [ sec : interaction ] . as was the case with the insb case",
    ", this shows that the cosmic - ray identification algorithm catches the neighbors affected by cross - talk without requiring any extra steps .",
    "the si : as images are dark frames ; the only non - random signals are from dark current and detector artifacts . by taking the median image ( figure  [ siasmedian ] ) and scaling from 1 sample to 36 by multiplication , the dark value is found to be @xmath49 data units , compared to the processed image s dark value of @xmath50 data units ",
    "the dark values for these images agree to within 3@xmath6 .",
    "if we compare figure  [ siasmedian ] and figure  [ siasresult ] , we see that the signal along the bottom and right - hand side of the detector are preserved in the output image , although heavy quantization limits the amount of observable structure in the median image .    overall , the processed and median images disagree by more than 3 times the uncertainty of the processed image at 5 pixels . in all 5 cases ,",
    "the processed image has a lower signal than the median image by just over @xmath32 ( 3.013.12@xmath6 ) .",
    "these deviations appear to be caused by error in the data fitting routine due to the heavy quantization of the input data .",
    "as the proton hits will bias the median image towards higher signals , we recomputed the median image , discarding reads which differ from the mean by more than @xmath32 .",
    "removal of this bias reduces the number of different pixels to 3 .",
    "as the large quantization adds noise to the median which will be less pronounced in the processed data , the median may be a less accurate measure of the `` real sky '' than the output image .",
    "there do not appear to be any missed cosmic rays in the output image .",
    "the up - the - ramp sampling and on - the - fly cosmic ray rejection algorithm performs excellently on the radiation test data from the insb and si : as detectors , particularly when we consider that the data were not originally up - the - ramp samples ( but co - added intervals ) , the algorithm parameters were only minimally tuned to the detector , the data were not linearized before processing and we ignored any possibility of persistent radiation effects , which is particularly important since the particle rates were extremely high .",
    "detailed tuning of the algorithm with the experiment detector will improve these results .",
    "the cosmic ray algorithm did not introduce any 2-d structure into the image , and preserved the structure which was there . finally , the small number of pixels for which the median and processed images which differed significantly shows that the up - the - ramp sampling can and does preserve the photometric quality of the data .    we have attempted to answer some common concerns about the use of up - the - ramp sampling strategies .",
    "we have shown that the algorithm performs well without precise tuning to the detector characteristics , as we have obtained good performance without such tuning .",
    "another concern is that the cosmic - ray / detector interaction model assumed in the design of the algorithm is too simplistic ; however , the results here show good performance without requiring additional complicating features . in short ,",
    "we havent found any `` show - stoppers '' that would lead to the conclusion that the algorithm requires excessive computing or human interaction to provide useful scientific data .",
    "these results are limited to the detector technologies being studied here .",
    "a key future direction for this study is to apply the techniques discussed here to additional detector technologies ( such as hgcdte technology , used in the nicmos instrument on hst ) .",
    "this is particularly true in the context of detector characterization studies for observatories and instruments being designed currently or in the near future , which is how this study started .",
    "however , the fact that we obtain very similar results with the two technologies suggests that the cosmic ray mitigation approach studied here could be applied to many instruments and detectors .",
    "these studies are supported by the nasa remote exploration and experimentation project ( ree ) , which is administered at the jet propulsion laboratory under dr .",
    "robert ferraro , project manager .",
    "we acknowledge our colleague craig mccreight at nasa s ames research center for his contributions in bringing all of the authors together .",
    "we thank the reviewer of this paper for their useful suggestions during the referee process .",
    "we selected up - the - ramp sampling for study because it provides better signal - to - noise in what is probably the most difficult - to - measure regime , the read - noise limit . in the absence of cosmic rays ,",
    "up - the - ramp sampling provides modestly ( @xmath1 ) higher signal - to - noise than does fowler sampling ( garnett & forrest , 1993 ) .",
    "the fact that an up - the - ramp sequence can be screened for cosmic rays and other glitches improves this result .",
    "furthermore , on - the - fly cosmic ray rejection allows longer integration times which also improves the signal - to - noise in the faint limit .",
    "fowler sampling reduces the effect of read noise to @xmath51 ( for an observation sequence consisting of @xmath0 samples , @xmath52 fowler - pairs ) .",
    "however , when a pixel is impacted by a cosmic ray during an observation , the cosmic ray essentially injects infinite variance and reduces the signal to noise to zero at that location . if we start with the fowler sampling signal - to - noise function in the read - noise limit , from garnett & forrest ( 1993 , eqn .",
    "6 ) , @xmath53 where @xmath54 is the flux of the target , @xmath55 is the observation time , @xmath56 is the read noise , @xmath57 is the fowler duty cycle and @xmath58 is the time between sample intervals ( determined by engineering or scientific constraints on the system ) .",
    "we note this formula breaks down for relatively small numbers of samples ( i.e. @xmath59 large with respect to @xmath55 ) .",
    "@xmath60 is the signal , so the remaining terms are the noise , which is the square - root of the variance , @xmath61 .",
    "if we consider two cases , `` no - cosmic - ray '' and `` hit - by - cosmic - ray '' and combine the variances according to @xmath62 we can rewrite equation  [ eq : snf ] as @xmath63 as the weight is the inverse of the variance ( @xmath64 ) , equation  [ eq : snfc ] can be rewritten as @xmath65 @xmath61 is the variance in the no - cosmic - ray case , taken from equation  [ eq : snf ] and @xmath66 is the probability of a pixel surviving without a cosmic ray hit . for simplicity , we define @xmath67 to be the probability of a pixel being hit by a cosmic ray per time unit @xmath59 , so @xmath68 is the probability of `` survival '' and @xmath69 . as a cosmic ray hits",
    "injects infinite uncertainty , the variance in the cosmic ray case @xmath70 .",
    "plugging in to equation  [ eq : snfc2 ] , we get the signal - to - noise for fowler sampling in the read - noise limited with cosmic rays , equation  [ eq : snff ] : @xmath71    for a given integration time @xmath55 and minimum read time @xmath59 , the maximum @xmath72 occurs with duty cycle @xmath73 .",
    "if we plug this back into equation  [ eq : snff ] , we get @xmath74 from here , it is possible to find the value of @xmath55 which gives the best signal - to - noise for a single observation ; it occurs at @xmath75 .",
    "if , however , we consider the observation as a series of @xmath76 equal observations with a specific total observation time , @xmath77 , the signal - to - noise for the series is @xmath78 if we hold @xmath77 constant and find the optimum @xmath55 , we find that it is @xmath79 . in either case , it is important to note that , in there is an optimal value for @xmath55 , and extending the observation beyond that time will ruin the data .",
    "it is worth noting that the result assumes that all cosmic ray events can be identified _",
    "a posteriori_. this is not necessarily the case , particularly when it is considered that , in the one - image case , the fraction of pixels surviving without a cosmic ray impact is @xmath80 ; for the multi - image case , the fraction of survivors is @xmath81 . in both cases , the number of `` good '' pixels is so low that separating them from the impacted pixels will not be a trivial task .",
    "for example , the median operation would not be able to identify a good samples , as more than half of the samples would be impacted by cosmic rays . in practice",
    ", the detector will often saturate before this limit is reached , but this shorter integration time means that less - than - optimal signal - to - noise will be obtained .",
    "up - the - ramp sampling reduces the effect of read noise to @xmath82 , for n uniformly - spaced samples with equal weighting ( which is the optimal weighting for the read - noise limited case ) .",
    "when a pixel is impacted by a cosmic ray , the up - the - ramp algorithm preserves the `` good '' data for that pixel .",
    "the exact quality of the preserved data depends on the number of cosmic ray hits and their timing within the observation .",
    "for example , a cosmic ray hit which just trims off the last sample in the sequence has minimal impact compared to a cosmic ray hit that occurs in the middle of the observation sequence .",
    "the variance of a uniformly - sampled sequence with @xmath83 samples is proportional to @xmath84 .",
    "if an up - the - ramp sequence is broken into @xmath3 chunks by a cosmic ray , the variance becomes @xmath85 when there are zero cosmic ray events , of course , @xmath86 . if there is one cosmic ray event during the sequence , the variance becomes @xmath87 if we assume ( as is reasonable ) that the cosmic ray events are randomly distributed over time and find the expectation value for all values of @xmath88 , we find that the typical @xmath89 ( plus a small term in @xmath90 , which we will ignore for simplicity ) .",
    "if we perform a similar computation for two cosmic ray events , we find that @xmath91 ( again , plus lower - order terms which we ignore ) . in general",
    ", we find that it is possible to find a valid result with a finite (",
    "although not necessarily pretty ) variance for any sequence broken up by cosmic ray events provided we have at least 2 consecutive `` good '' samples ( for all practical purposes , we can ignore the situation where this is not the case ) . to simplify the following , we will simplify by considering only 3 cases : the no - cosmic - ray case @xmath92 , the one - cosmic - ray case @xmath93 and all multiple - cosmic - ray cases combined as one , @xmath94 , where @xmath95 is a small but non - zero number , roughly 0.3 .    the up - the - ramp signal - to - noise function for the read - noise limited case ( garnett & forrest , 1993 , eqn .",
    "20 ) is @xmath96 we combine the variances in the 3 possible cases with the three - case equivalent to equation  [ eq : varc ] , and thus arrive at @xmath97 where @xmath98 is the probability of a pixel being impacted by @xmath3 cosmic rays during the integration .",
    "we note , as did garnett & forrest , that there would be no reason to limit the number of samples to anything less than the maximum possible number , so we can set @xmath99 . using the definition of @xmath68 described earlier , @xmath100 , @xmath101 and @xmath102 . putting these values back into equation  [ eq : snuc ]",
    ", we get : @xmath103^{1/2}\\ ] ] if we seek the maximum value of @xmath104 with respect to @xmath55 , we find that @xmath105 , provided @xmath106 ( otherwise we d have an integration shorter than 1 sample time , which would be useless ) , @xmath107 and @xmath108 ( both of which are true by construction ) .",
    "this result applies equally whether we are considering one independent integration or a series of observations to be combined further downstream .",
    "as the derivative is strictly positive , the signal - to - noise continues to increase with as sample time increases , although as @xmath109 , the gain in signal - to - noise asymptotically approaches zero .",
    "so , extending the observing time while using up - the - ramp sampling with cosmic ray rejection does not damage the data ( although we might be spending time with little or no gain ) . as noted earlier for the fowler - sampling case",
    ", there is an optimal observing time , beyond which further observation reduces the overall signal - to - noise .",
    "offenberg , j.d . ,",
    "sengupta , r. , fixsen , d.j . ,",
    "stockman , h.s . , nieto - santisteban , m.a . ,",
    "stallcup , s. , hanisch , r.j . , &",
    "mather , j.c .",
    "1999 , in  _ astronomical data analysis software and systems viii _ d.m .",
    "mehringer , r.l .",
    "plante , & d.a .",
    "roberts , eds .",
    "pacific conference series , * 172 * , 141 .",
    "rauscher , bernard j. , isaacs , john , & long , knox , 2000 , `` cosmic ray management on ngst 1 : the effect of cosmic rays on near infrared imaging exposure times . ''",
    "http://www.ngst.nasa.gov/cgi-bin/doc?id=649    stockman , h.s . ,",
    ", 1997 , * the next generation space telescope : visiting a time when galaxies were young * , association of universities for research in astronomy , inc .",
    "http://sso.stsci.edu/second_decade/pdf/bg_docs/ngst.pdf    stockman , h. s. , fixsen , d. , hanisch , r. j. , mather , j. c. , nieto - santisteban , m. , offenberg , j. d. , sengupta , r. & stallcup , s. , 1998 , the next generation space telescope : science drivers and technological challenges , 34th liege astrophysics colloquium , june 1998 , p. 121"
  ],
  "abstract_text": [
    "<S> we examine cosmic ray rejection methodology on data collected from insb and si : as detectors . </S>",
    "<S> the application of an up - the - ramp sampling technique with cosmic ray identification and mitigation is the focus of this study . </S>",
    "<S> this technique is valuable for space - based observatories which are exposed to high - radiation environments . </S>",
    "<S> we validate the up - the - ramp approach on radiation - test data sets with insb and si : as detectors which were generated for sirtf . </S>",
    "<S> the up - the - ramp sampling method studied in this paper is over 99.9% effective at removing cosmic rays and preserves the structure and photometric quality of the image to well within the measurement error .    </S>",
    "<S> = 10000 = 8000 </S>"
  ]
}