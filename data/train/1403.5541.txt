{
  "article_text": [
    "the behavior of elementary charged particles , like electrons and positrons is governed by quantum electrodynamics ( qed ) . in this theory",
    "the quantum particles interact via the exchange of the quanta of light , i.e. the photons @xcite .",
    "thus in principle we have to consider the quantum nature of the charged particles as well as of the light field .",
    "however , in several important cases we can focus almost exclusively on either the charged particles or the photons , while employing crude approximations for the other degrees of freedom .    in condensed matter physics and quantum chemistry the quantum nature of light can usually be ignored and the interaction between the charged quantum particles is approximated by the instantaneous coulomb interaction . however , even then the resulting quantum mechanical equations ( usually the many - body schrdinger equation ) , where the electromagnetic fields are treated classically through the solution of the maxwell equations , are solvable only for very simple systems .",
    "this lies ultimately in our incapability of handling the huge number of degrees of freedom of many - particle systems and consequently in our inability to determine the many - body states .",
    "this so - called many - body problem spawned a lot of interest into the question whether one can devise a closed set of equations for reduced quantities which do not involve the explicit solution of the full quantum mechanical equations and in which the many - body correlations can be approximated efficiently .",
    "pursuits in this direction have led to various approaches such as , among others , many - body green s function theories @xcite , ( reduced ) density - matrix theories @xcite and density - functional theories @xcite .",
    "these approaches differ in the complexity of the reduced quantity , which is used to calculate the various observables of interest",
    ". especially density - functional theories , which are based on the simplest of those ( functional ) variables , the one - particle density ( current ) , have proven to be exceptionally successful @xcite .",
    "their success can be attributed to the unprecedented balance between accuracy and numerical feasibility @xcite , which allows at present to treat several thousands of atoms @xcite .",
    "although the different flavors of density - functional theories cover most of the traditional problems of physics and chemistry ( including approaches that combine classical maxwell dynamics with the quantum particles @xcite ) , by construction these theories can not treat problems involving the quantum nature of light .    in quantum optics ,",
    "on the other hand , the focus is on the photons , while usually simple approximations for the charged particles are employed , e.g. a few - level approximation .",
    "however , even in this situation the solution of the resulting equations @xcite is only possible in simple cases ( again due to the large number of degrees of freedom ) and usually simplified model hamiltonians , e.g. the dicke model realized in a cavity @xcite , are employed to describe these physical situations .",
    "already the validity of these effective hamiltonians and their properties can be a matter of debate @xcite and often further simplifications are adopted such as the jaynes - cummings model in the rotating - wave approximation .",
    "the rapid progress in quantum - optical experiments on the other hand , especially in the field of cavity qed @xcite and circuit qed @xcite , allows to study and control multi - particle systems ultra - strongly coupled to photons @xcite , where such a simple approximative treatment is no longer valid @xcite .",
    "this new regime of light - matter interaction is widely unexplored for , e.g. , molecular physics and material sciences @xcite .",
    "possibilities like altering and strongly influencing the chemical reactions of a molecule in the presence of a cavity mode or setting the matter into new non - equilibrium states with novel properties , e.g. light - induced superconductivity @xcite , arise . specifically in such situations an oversimplified treatment of the charged particles may no longer be allowed and an approach that considers both , the quantum nature of the light field as well as of the charged particles is needed .    in this work we give a comprehensive derivation of an exact and numerically feasible method that generalizes ideas of time - dependent density - functional theory ( tddft ) .",
    "this method bridges the gap between the above two extreme cases and provides a scheme to perform ab - initio calculations of quantum particles coupled to photons .",
    "the electron - photon generalization of tddft in describing non - relativistic many - electron systems coupled to photon modes of mesoscopic cavities was introduced in ref .",
    "here we provide a general framework describing fully coupled electron - photon systems in most possible regimes / systems ranging from effective model hamiltonians to strongly relativistic cases , which has been introduced in refs .  @xcite . for clarity",
    "we divide the following presentation in two parts : we first demonstrate the basic ideas in a simple model system and then show how these concepts can be used in the case of general coupled matter - photon problems .",
    "a summary of all findings of the present work for the time - dependent density - functional description of qed at different levels of approximations , namely the basic variables , initial conditions and fundamental kohn - sham multicomponent equations is given in appendix  [ app : overview ] .",
    "we start considering a simple model system for charged matter coupled to photons : the two - site hubbard model interacting with one photonic mode . by employing density - functional ideas",
    "we show how one can solve this quantum - mechanical problem without the need to explicitly calculate the complex many - body wave function . instead",
    ", we derive equations of motion for a pair of reduced quantities from which all physical observables can by determined .",
    "we demonstrate that these equations have unique solutions and can be used to calculate the basic reduced quantities ( here the basic pair of reduced quantities is the charge density of the particle and the potential induced by the photons ) of the coupled problem . therefore we here reformulate the coupled matter - photon problem in terms of an effective theory , that we call in the following a model of quantum electrodynamical density - functional theory ( qedft ) .",
    "since an explicit calculation of the coupled wave function is not needed , this approach allows to determine properties of the matter - photon system in a numerically feasible way .",
    "we introduce an new kohn - sham scheme to approximate the unknown functionals in the basic equations of motion and present results for a simple approximation .",
    "we compare these results to the exact kohn - sham functionals and identify shortcomings and indicate improvements .    based on the ideas developed in the first part of this work we repeat the steps illustrated in our example but",
    "now we construct a density - functional reformulation for the full theory of qed @xcite .",
    "we show that a straightforward approach based on the current and the potential leads to problems and that a consistent density - functional reformulation of qed has to be based on the polarization and the potential which is generated by the photons .",
    "this approach to the fully coupled qed problem we denote as relativistic qedft , and we present the corresponding kohn - sham construction and give the simplest approximation to the unknown functionals . in the following we",
    "then demonstrate how relativistic qedft reduces in the non - relativistic limit to its non - relativistic version of the corresponding non - relativistic hamiltonian . by employing further approximations on the matter system or on the photon field",
    "a family of different approximate qedfts is introduced , which are consistent with their respective approximate hamiltonians . at this level",
    "we recover the theory of ref .  @xcite . in lowest order",
    "we rederive the model qedft of the first part of this work .",
    "therefore , we demonstrate how all different flavours of qedft are just approximations to relativistic qedft in the same manner as different physical hamiltonians are merely approximations to the qed hamiltonian .",
    "furthermore , by ignoring all photonic degrees of freedom , we find the standard formulations of tddft which are extensively used in the electronic - structure community @xcite .",
    "* outline * in sec .",
    "[ sec : model ] we investigate the qedft reformulation of a simple model of one particle coupled to one mode in great detail .",
    "the developed ideas are then employed in sec .",
    "[ sec : relqedft ] to derive a qedft reformulation of qed . in sec .",
    "[ sec : nonrelqedft ] we show how all different qedft reformulations are approximations to relativistic qedft .",
    "we conclude and give an outlook in sec .  [",
    "sec : conclusion ] .",
    "in this section , we introduce the basic formulation and underlying ideas of qedft . by employing a model hamiltonian",
    ", we can almost exclusively focus on the density - functional ideas that allow a reformulation of the wave - function problem in terms of simple effective quantities .",
    "we first identify the pair of external and internal variables and then show that both are connected via a bijective mapping . as a consequence ,",
    "all expectation values become functionals of the initial state and the internal pair .",
    "this allows for a reformulation of the problem in terms of two coupled equations for the internal pair .",
    "then we introduce the kohn - sham construction as a way to find approximations to the unknown functionals , and show first numerical results .    to describe the dynamics of particles coupled to photons we solve an evolution equation of the form @xmath0 for a given initial state @xmath1 . here",
    "@xmath2 with @xmath3 and the standard relativistic ( covariant ) notation @xmath4 ( see also appendix [ app : con ] for notational conventions ) .",
    "the corresponding hermitean hamiltonian has the general form @xmath5 where the depedence of the total hamiltonian on @xmath6 indicates an explicit time - dependence . here",
    "the ( time - independent ) hamiltonian @xmath7 describes the kinetic energy of the particles , i.e. how they would evolve without any perturbation , and @xmath8 is the energy of the photon - field .",
    "the third term describes the coupling between the ( charged ) particles and the photons by the charge current @xmath9 and the maxwell - field operators @xmath10 ( where the einstein sum convention with the minkowski metric @xmath11 is implied and greek letters refer to four vectors , e.g. @xmath12 , while roman letters are restricted to spatial vectors only , e.g. @xmath13 ) .",
    "this term is frequently called the minimal - coupling term and arises due to the requirement of a gauge - invariant coupling between the particles and the photon field .",
    "the specific form of the operators @xmath9 and @xmath10 depends on the details of the physical situation . finally , the last term describes how the particles interact with a ( in general time - dependent ) classical external vector potential @xmath14 and how the photons couple to a ( in general time - dependent ) classical external current @xmath15 .",
    "while we usually have no control over how the particles and photons evolve freely or interact , i.e. the first three terms of the hamiltonian ( [ basicham ] ) , we have control over the preparation of the initial state @xmath1 and the external fields @xmath16 .",
    "therefore , all physical wave functions , i.e. found by solving eq .",
    "( [ schrdinger ] ) , can be labeled by their initial state and _ external pair _",
    "@xmath16 , @xmath17;t ) \\ , \\right\\rangle}.\\end{aligned}\\ ] ] however , for any but the simplest systems the ( numerically exact ) solution of eq .",
    "( [ schrdinger ] ) is not feasible .",
    "even if we decouple the matter part from the photons by employing the coulomb - approximation ( i.e. describing the exchange of photons by the respective lowest - order propagator ) the resulting problem is far from trivial .      in this subsection , we introduce a simple model of charged particles coupled to photons .",
    "we discuss the basic concepts of a density - functional - type reformulation , identify the pair of conjugate variables and then deduce the fundamental equations of motion on which we base our qedft reformulation .    in order to demonstrate the basic ideas of a qedft we employ the simplest yet non - trivial realization of one charged particle coupled to photons : a two - site hubbard model coupled to one photonic mode .",
    "the resulting hamiltonian ( see appendix [ app : hubbard ] for a detailed derivation ) reads as @xmath18,\\end{aligned}\\ ] ] where the kinetic energy of the charged particle is given by @xmath19 and the energy of the photon mode reads @xmath20 here @xmath21 is the hopping parameter between the two sites , @xmath22 is the frequency of the photonic mode and @xmath23 are the pauli matrices that obey the usual fermionic anti - commutation relations . the photon creation and annihilation operators ( @xmath24 and @xmath25 , respectively ) obey the usual bosonic commutation relations .",
    "the current operator is proportional to the dipole - moment operator , i.e. it is connected to the zero component @xmath26 of the general four - current operator @xmath9 . to highlight the analogy in structure to the general case discussed in the later sections , we give it the units of a current and denote it by @xmath27",
    "is defined by @xmath28 where @xmath29 is a characteristic length - scale of the matter - part and @xmath30 is a dimensionless coupling constant .",
    "+ the operator for the conjugate potential is actually proportional to the electric field as can be seen from the derivations in appendix [ app : hubbard ] .",
    "this is , because in the course of approximations one employs the length - gauge and thus transforms from the potential to the electric field .",
    "however , to highlight the analogy in structure to the general case discussed in the later sections , we give it the units of the potential and denote it by @xmath31 is given by @xmath32 where @xmath33 is the length of the cubic cavity .",
    "further , the current operator couples to the external potential @xmath34 and the potential operator to the external current @xmath35 .",
    "these are the two ( classical ) external fields that we can use to control the dynamics .",
    "if we then fix an initial state @xmath1 and choose an external pair @xmath36 , we usually want to solve eq .",
    "( [ schrdinger ] ) with the hamiltonian given by eq .",
    "( [ hubbard ] ) .",
    "the resulting wave function , given in a site basis @xmath37 for the charged particle and a fock number - state basis @xmath38 for the photons @xmath39;t ) \\ , \\right\\rangle } = \\sum_{x=1}^{2 } \\sum_{n=0}^{\\infty } c_{xn}(t ) { \\left| \\ , x \\ , \\right\\rangle}\\otimes { \\left| \\ , n \\ , \\right\\rangle},\\end{aligned}\\ ] ] depends on the initial state and the external pair @xmath36 .",
    "thus , by varying over all possible combinations of pairs @xmath36 , we scan through all physically allowed wave functions starting from a given initial state .",
    "hence , we parametrize the relevant , i.e. physical , time - dependent wave functions by @xmath1 and @xmath36 .",
    "since the wave functions have these dependencies , also all derived expressions , e.g. the expectation values for general operators @xmath40 @xmath41,t ) = { \\left\\langle \\ , \\psi(t)|\\hat{o } \\,|\\ , \\psi(t ) \\ , \\right\\rangle},\\end{aligned}\\",
    "] ] are determined by the initial state and the external pair @xmath36 .    the idea of an _ exact _ effective theory like qedft is now , that we identify a different set of fundamental variables , which also allow us to label the physical wave functions ( and their respective observables ) , and that we have a closed set of equations for these new ( functional ) variables , which do not involve the full wave functions explicitly .",
    "such a functional - variable change is similar to a coordinate transformation , say from cartesian coordinates to spherical coordinates .",
    "this can only be done if every point in one coordinate system is mapped uniquely to a point in the other coordinate system . for a functional - variable change",
    "we thus need to have a one - to - one correspondence , i.e. bijective mapping , between the set of ( allowed ) pairs @xmath36 and some other set of functions ( while we keep the initial state fixed ) . to identify the simplest new functional variables one usually employs arguments based on the legendre transformation @xcite .",
    "that is why these new functional variables are often called conjugate variables .",
    "we will consider this approach in the next sections where we investigate general qedft , and also show how one can determine the conjugate variables of this model system from more general formulations of qedft .",
    "for this simple model we simply state that a possible pair of conjugate variables is @xmath42 . in the next subsection",
    "we show that this functional variable - transformation is indeed allowed , i.e. @xmath43;t ) \\ , \\right\\rangle}.\\end{aligned}\\ ] ] the main consequence of this result is , that from only knowing these three basic quantities we can ( in principle ) uniquely determine the full wave function .",
    "accordingly , every expectation value becomes a unique functional of @xmath1 and @xmath42 .",
    "thus , instead of trying to calculate the ( numerically expensive ) wave function , it is enough to determine the _ internal pair _",
    "@xmath42 for a given initial state . an obvious route to then also find a closed set of equations for these new variables is via their respective equations of motion .",
    "these equations will at the same time be used to prove the existence of the above change of variables , i.e. that the wave function is a unique functional of the initial state and the internal pair @xmath42 .",
    "to find appropriate equations we first apply the heisenberg equation of motion once and find @xmath44 where @xmath45 .",
    "yet these two equations are not sufficient for our purposes : we need equations that explicitly connect @xmath46 and @xmath42",
    ". therefore we have to go to the second order in time , @xmath47 where @xmath48 @xmath49 and @xmath50 . here , eq .",
    "( [ discerteforce ] ) is the discretized version of @xmath51 of standard tddft @xcite , and eq .",
    "( [ discertemaxwell ] ) is the inhomogeneous maxwell equation for one photon mode @xcite .      in the previous subsection",
    "we have stated that @xmath42 and @xmath36 are the possible conjugate pair of the model hamiltonian ( [ hubbard ] ) . in this subsection",
    "we want to demonstrate that indeed this holds true and that we can perform a variable transformation from the external pair @xmath36 to the internal pair @xmath42 .",
    "what we need to show is , that for a fixed initial state @xmath1 the mapping @xmath52 is bijective , i.e. if @xmath53 then necessarily for the according expectation values @xmath54 .",
    "to do so we first note , that in the above equations of motion every expectation value is by construction a functional of @xmath36 for a fixed initial state , @xmath55;t ) =   - \\frac{4 t^2_{\\mathrm{kin } } } { \\hbar^2 c^2 } j([a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t )   \\\\ & + \\lambda \\langle \\hat{n } \\a \\rangle ( [ a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t ) + n ( [ a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t ) a_{{{\\rm ext}}}(t ) , \\nonumber \\\\ \\label{discertemaxwellexp } \\partial_0 ^ 2 a&([a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t ) =   - k^2 a([a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t ) \\nonumber \\\\ & + \\frac{\\mu_0 c}{l^3}\\left ( \\lambda j([a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t ) + j_{{{\\rm ext}}}(t)\\right),\\end{aligned}\\ ] ] i.e. they are generated by a time - propagation of @xmath1 with a given external pair @xmath36 . suppose now , that we fix the expectation values of the internal variables @xmath56 , i.e. we do not regard them as functionals but rather as functional variables .",
    "then the above eqs .",
    "( [ discerteforceexp ] ) and ( [ discertemaxwellexp ] ) become equations for the pair @xmath36 that produce the given internal pair @xmath42 via propagation of the initial state @xmath1 , i.e. @xmath57;t ) \\nonumber \\\\   & + n ( [ a_{{{\\rm ext}}},j_{{{\\rm ext}}}];t ) a_{{{\\rm ext}}}(t ) , \\\\",
    "\\label{discertemaxwellfun } \\partial_0 ^ 2   a(t ) = &   -k^2 a(t )   + \\frac{\\mu_0 c}{l^3}\\left ( \\lambda j(t ) + j_{{{\\rm ext}}}(t)\\right).\\end{aligned}\\ ] ] obviously these equations can only have a solution , if the given internal variables are consistent with the initial state , i.e. @xmath58 here we have used the definition @xmath59 and every internal pair @xmath42 that we consider is subject to these boundary conditions .",
    "thus , the mapping ( [ pairmapping ] ) is bijective , if the corresponding eqs .",
    "( [ discerteforcefun ] ) and ( [ discertemaxwellfun ] ) , which connect the internal pair @xmath42 with the external pair @xmath36 , allow for one and only one solution pair .",
    "let us first note that for a given pair @xmath42 , eq .",
    "( [ discertemaxwellfun ] ) uniquely determines the external current @xmath60 by @xmath61 thus , the original problem reduces to the question whether eq .",
    "( [ discerteforcefun ] ) determines @xmath34 uniquely .",
    "the most general approach to answer this question is via a fixed - point procedure similar to ref .",
    "@xcite . in the case of a discretized schrdinger equation like eq .",
    "( [ hubbard ] ) it should also be possible to apply a rigorous approach based on the well established theory of nonlinear ordinary differential equations @xcite . however , for simplicity we follow ref",
    ".  @xcite and employ the standard strategy of @xcite which restricts the allowed external potentials @xmath62 to being taylor - expandable in time , i.e. @xmath63 from eq .",
    "( [ discerteforce ] ) we can find the taylor - coefficients of @xmath64 ( if they exist ) by @xmath65 where the terms @xmath66 and @xmath67 are given by their respective heisenberg equations at @xmath68 and only contain taylor coefficients of @xmath69 for @xmath70 .",
    "now , assume that we have two different external potentials @xmath71 .",
    "this implies , since we assumed taylor - expandability of @xmath72 and @xmath73 , that there is a lowest order @xmath74 for which @xmath75 for all orders @xmath70 ( even though the individual @xmath76 and @xmath77 might not exist ) it necessarily holds that @xmath78 but for @xmath74 we accordingly find that @xmath79 provided we choose the initial state such that ( @xmath80 )",
    ". consequently , @xmath81 infinitesimally later for two different external potentials @xmath71 .",
    "therefore , eq .  ( [ discerteforcefun ] ) allows only one solution and the mapping @xmath82 is bijective .    as a consequence , since every expectation value of the quantum system becomes a functional of the internal pair @xmath42 , in the above eqs .",
    "( [ discerteforcefun ] ) and ( [ discertemaxwellfun ] ) we can perform a change of variables and find @xmath83;t ) + n ( [ j , a];t ) a_{{{\\rm ext}}}(t ) , \\\\ \\label{discertemaxwellintfun } \\partial_0 ^2   a(t ) & =   -k^2 a(t )   + \\frac{\\mu_0 c}{l^3}\\left ( \\lambda j(t ) + j_{{{\\rm ext}}}(t)\\right).\\end{aligned}\\ ] ] these coupled evolution equations have unique solutions @xmath56 for the above initial conditions ( [ initialcurrent ] ) and ( [ initialpotential ] ) .",
    "therefore we can , instead of solving for the many - body wave function , solve these non - linear coupled evolution equations for a given initial state and external pair @xmath36 , and determine the current and the potential of the combined matter - photon system from which all observables could be computed .",
    "this is an exact reformulation of the model in terms of the current and the potential of the combined system only .      in the previous subsection",
    "we have derived a qedft reformulation in terms of the current and the potential . while the equation that determines the potential @xmath84 is merely the classical maxwell equation , and every term",
    "is known explicitly , the equation for the current contains implict terms .",
    "therefore , to solve these coupled equations in practice , we need to give appropriate explicit approximations for the implict terms .",
    "approximations based on @xmath42 directly would correspond to a thomas - fermi - type approach to the model . as known from standard density - functional theory ,",
    "such approximations are in general very crude and hard to improve upon .",
    "a more practical scheme is based on the kohn - sham construction , where an auxiliary quantum system is used to prescribe explicit approximations .",
    "however , the numerical costs of a kohn - sham approach compared to a thomas - fermi - type approach are increased .",
    "the details of the kohn - sham construction depend on the actual auxiliary quantum system one wants to employ .",
    "the only restriction of the auxiliary system is that one can control the current and the potential by some external variables .",
    "thus , one could even add further ( unphysical ) external fields to make approximations of the coupled quantum system easier .",
    "however , here we only present the simplest and most natural kohn - sham scheme , which is to describe the coupled quantum system by an uncoupled quantum system . to this end",
    ", we assume that we can find a factorized initial state @xmath85 that obeys the same initial conditions as the coupled problem ( [ initialcurrent ] ) and ( [ initialpotential ] ) . especially , if the initial state of the coupled system is the same as in the uncoupled problem , then this condition is trivially fulfilled . in a next step",
    "we note , that for the uncoupled system subject to the external pair @xmath86 the equations of motion become ( since @xmath87 ) @xmath88;t ) & =   - \\frac{4 t^2_{\\mathrm{kin } } } { \\hbar^2 c^2 } j([a_{\\mathrm{eff}},j_{\\mathrm{eff}}];t )   \\\\ & + n ( [ a_{\\mathrm{eff}},j_{\\mathrm{eff } } ] ; t ) a_{\\mathrm{eff}}(t ) , \\nonumber \\\\ \\label{discertemaxwellun } \\partial_0 ^ 2 a([a_{\\mathrm{eff}},j_{\\mathrm{eff}}];t ) & =   - k^2 a([a_{\\mathrm{eff}},j_{\\mathrm{eff}}];t ) + \\frac{\\mu_0 c}{l^3 } j_{\\mathrm{eff}}(t),\\end{aligned}\\ ] ] now , obviously if one would choose @xmath89 , i.e. the external pair of the coupled problem , the uncoupled quantum system will in general lead to a different internal pair",
    ". however , can we find an effective pair that _ reproduces _ the internal pair @xmath42 of the coupled system ?",
    "the existence of such an effective pair can be based on equations for the uncoupled system similar to eqs .",
    "( [ discerteforcefun ] ) and ( [ discertemaxwellfun ] ) .",
    "note that before we were considering the question of uniqueness , i.e. can one have two external pairs leading to the same @xmath42 .",
    "thus any internal pair @xmath42 was apriori associated with an external pair @xmath36 .",
    "if on the other hand we are given some internal pair @xmath42 , say from a different ( coupled ) quantum system , we do not apriori know that this internal pair can be represented by propagation of an initial state with some @xmath86 .",
    "thus this problem is equivalent to the existence of a solution to @xmath90;t ) a_{\\mathrm{eff}}(t ) , \\\\",
    "\\label{discertemaxwellfunun } \\partial_0 ^ 2   a(t ) & =   -k^2 a(t )   + \\frac{\\mu_0 c}{l^3 } j_{\\mathrm{eff}}(t).\\end{aligned}\\ ] ] for a given pair @xmath42 and @xmath91 . as before ,",
    "@xmath92 is uniquely determined by simply rearranging eq .",
    "( [ discertemaxwellfunun ] ) as @xmath93 while the existence of an @xmath94 that reproduces @xmath42 is less clear .",
    "again , the most general approach to answer this question can rely on a fixed - point scheme similar to @xcite , or on mapping the problem to a special nonlinear schrdinger equation @xcite .",
    "importantly , in the discretized case certain subtleties arise @xcite that have to be treated with care @xcite . disregarding these more subtle points",
    ", we follow a simpler approach based on the assumption of taylor - expandability in time of @xmath64",
    ". then one can successively construct the taylor coefficients of the effective potential from @xmath95 assuming that for the initial state @xmath91 the expectation value @xmath96 . further assuming that this taylor - series converges @xcite , we have constructed a pair @xmath97,j_{\\mathrm{eff}}[a]),\\end{aligned}\\ ] ] that reproduces @xmath42 via propagation of @xmath91 .",
    "the above defined pair @xmath98,j_{\\mathrm{eff}}[a])$ ] actually describes the mapping @xmath99 now , in order to actually _ predict _ the physical pair @xmath42 via the kohn - sham system ( and thus solve eqs .",
    "( [ discerteforceintfun ] ) and ( [ discertemaxwellintfun ] ) ) we have to connect the coupled and the auxiliary system . to do",
    "so we make the composite mapping",
    "@xmath100 i.e. we employ the fact that @xmath42 are unique functionals of the initial state @xmath1 and @xmath101 . the definition of the resulting kohn - sham potentials and currents",
    "are then found by equalizing the functional eqs .",
    "( [ discerteforceintfun ] ) and ( [ discertemaxwellintfun ] ) with the according equations of the uncoupled auxiliary system .",
    "this leads to ( now also indicating the appropriate dependence on the initial states ) @xcite @xmath102;t ) a_{\\mathrm{ks}}(t ) = &",
    "\\lambda \\langle \\hat{n } \\a \\rangle ( [ \\psi_0,j , a];t ) \\\\   & + n ( [ \\psi_0,j , a];t ) a_{{{\\rm ext}}}(t ) \\nonumber \\\\ \\label{kscurrent }   j_{\\mathrm{ks}}(t ) = &   j_{{{\\rm ext}}}(t ) + j(t).\\end{aligned}\\ ] ] therefore , they are functionals of the two initial states , @xmath42 and @xmath101 , i.e. @xmath103 , j_{\\mathrm{ks}}[j , j_{{{\\rm ext } } } ] \\right).\\end{aligned}\\ ] ] with these definitions the coupled problem , starting from @xmath1 and subject to the external pair @xmath101 , can be formally solved by the solution of an uncoupled , yet non - linear problem with initial state @xmath91 and the kohn - sham pair @xmath104 .",
    "the resulting equations are @xmath105{\\left| \\ , \\mathrm{m}(t ) \\ , \\right\\rangle } , \\label{modelkscurrent } \\\\ & \\left ( \\partial_0 ^ 2 + k^2\\right ) a(t ) =    \\frac{\\mu_0 c}{l^3}\\left ( \\lambda j(t ) + j(t)\\right ) .",
    "\\label{modelksfield}\\end{aligned}\\ ] ] the self - consistent solutions of the kohn - sham eqs .",
    "( [ modelkscurrent ] ) and ( [ modelksfield ] ) by construction obey eqs .",
    "( [ kspotential ] ) and ( [ kscurrent ] ) , as well as equations of motion similar to eqs .",
    "( [ discerteforcefunun ] ) and ( [ discertemaxwellfunun ] ) . by combining these equations",
    "we see that the solutions to the kohn - sham equations generate the solutions to the coupled eqs .",
    "( [ discerteforceintfun ] ) and ( [ discertemaxwellintfun ] ) .",
    "we point out , that in the equation for the photonic mode we do not need any approximate functional . we merely need to solve a classical maxwell equation .",
    "however , in practice it might be useful , especially when calculating non - trivial photonic expectation values , that one solves an actual ( uncoupled ) photon problem to have a first approximation to the photonic wave function .    ) in the weak - coupling limit : ( a ) inversion @xmath106 , ( b ) density @xmath107 and ( c ) exact kohn - sham potential @xmath108 in the case of regular rabi oscillations.,scaledwidth=50.0% ]              in this section , we show numerical examples for our model system .",
    "we use the density - functional framework introduced in the previous sections and we explicitly construct the corresponding exact kohn - sham potentials . to illustrate our qedft approach , we focus mainly on two different examples : the first example treats a setup in resonance , where regular rabi oscillations occur .",
    "we show results in a weak - coupling limit and in a strong - coupling limit .",
    "the second example includes the photon field initially in a coherent state . for this case , we study collapses and revivals of the rabi oscillations .    the hamiltonian in eq .",
    "( [ hubbard ] ) is directly connected to the famous jaynes - cummings - hamiltonian and the rabi hamiltonian @xcite , which is heavily investigated in quantum optics .",
    "it has been studied in the context of rabi oscillations , field fluctuations , oscillation collapses , revivals , coherences and entanglement ( see ref.@xcite and references therein ) .    to directly see",
    "the connection between the two - site hubbard model coupled to one photon mode and the rabi hamiltonian , we transform the hamiltonian in eq .",
    "( [ hubbard ] ) by dividing with @xmath109 , where @xmath110 is an arbitary ( dimensionless ) scaling factor .",
    "thus we make the hamiltonian and the according schrdinger equation dimensionless .",
    "the hamiltonian of eq .",
    "( [ hubbard ] ) can then be rewritten in a similar form as usually found in the literature @xmath111 where we transformed to the dimensionless external potential @xmath112 and the dimensionless external current @xmath113 .",
    "further , we also transform to a dimensionless time variable @xmath114 . to actually perform numerical calculations",
    ", we have to choose values for the free parameters . here , we choose typically used values from the literature : @xmath115 , @xmath116 , @xmath117 and external fields which are set to zero @xmath118 .",
    "this set of parameters allow for a resonance situation , with no detuning between the transition energy of the atomic levels and the frequency of the field mode .    as discussed above the basic variables ( densities )",
    "are the current operator @xmath119 and the operator for the field potential @xmath120 . in this two - level example @xmath119",
    "reduces to @xmath121 and @xmath120 reduces to @xmath122 .    if the rotating - wave approximation is applied to the rabi hamiltonian in eq .",
    "( [ rabi - hamiltonian ] ) , one recovers the jaynes - cummings hamiltonian .",
    "this hamiltonian is then analytically solvable .",
    "the rotating - wave approximation is only valid in the weak - coupling limit ( @xmath123 ) . in the strong - coupling limit ( @xmath124 )",
    ", however , the rotating - wave approximation breaks down . only recently ,",
    "analytic results without the rotating - wave approxmation have been published @xcite . here",
    "we emphasize that the qedft approach presented in this paper is exact and does not rely on the rotating - wave approximation and hence also allows to treat strong - coupling situations .    in our first example",
    "we choose as initial state for both , the coupled many - body system and the uncoupled kohn - sham problem @xmath125 meaning the electron initially populates site one and the field is in the vacuum state .",
    "therefore , no photon is present in the field initially . in fig .",
    "[ fig : rabi_exact ] , we show the inversion @xmath106 , the density @xmath126 and the corresponding exact kohn - sham potential @xmath108 for the weak - coupling case .",
    "the atomic inversion @xmath106 shows regular rabi oscillations .",
    "rabi oscillations are also visible in @xmath127 , where we observe the typical neck - like features @xcite at @xmath128 and at later points in time .    to determine the exact kohn - sham potential for this case , we follow a fixed - point construction similar to @xcite . as input for the fixed - point construction , we use the exact many - body densities .",
    "in addition , we also compare to an analytic formula for the kohn - sham potential for a one - electron two - site hubbard model given in @xcite .",
    "this expression gives an explicit formula for the dependence of the kohn - sham potential on the density .",
    "such an explicit formula is only known in a few cases , while the fixed - point construction is generally valid . however , both methods yield in the present case the same results . a detailed discussion of the fixed - point construction for multicomponent systems of electrons and photons will be presented in a forthcoming work @xcite .    we emphasize that a propagation of the uncoupled kohn - sham system with the exact kohn - sham potential @xmath108 obtained in fig .  [",
    "fig : rabi_exact ] reproduces by construction the exact many - body density ( @xmath126 in the present case ) .",
    "however , as illustrated in sec .",
    "iic , if a kohn - sham propagation is used , the numerical expenses can be drastically reduced , since the kohn - sham construction effectively decouples the quantum system .    in practical calculations the exact kohn - sham potentials are normally not available and one has to rely on approximations . in the present case ,",
    "the simplest approximation for @xmath129 $ ] is straightforward if we assume @xmath130 \\approx n[\\psi_0,j , a]$ ] and @xmath131 .",
    "then , from eq .",
    "( [ kspotential ] ) we find the mean - field approximation to the kohn - sham potential @xmath132;t ) = \\lambda a(t ) + a_{{{\\rm ext}}}(t ) .",
    "\\label{eq : meanfieldpotential}\\end{aligned}\\ ] ] the mean - field approximation is actually identical to the maxwell - schdinger approach , i.e. we treat the electromagnetic field as being essentially classical .",
    "further , for @xmath133 and for @xmath134 the mean - field approximation becomes asymptotically exact . in fig .",
    "[ fig : rabi_weak ] and fig .",
    "[ fig : rabi_strong ] , we compare exact densities and exact kohn - sham potentials to densities and potentials , which were obtained by a self - consistend mean - field propagation . already in the weak - coupling limit ,",
    "[ fig : rabi_weak ] , quite sizable differences between exact results and mean - field results become visible : already at @xmath68 the exact kohn - sham potential deviates from the mean - field potential . in the case of the densities , this leads to a frequency shift , where the mean - field density oscillates slower than the exact density . in the strong - coupling limit shown in fig .",
    "[ fig : rabi_strong ] , effects beyond the rotating - wave approximation are visible . in the exact kohn - sham potential , we see a non - regular feature at @xmath135 , which is also not coverd by the mean - field approximation",
    ". however , the mean - field approximation already covers at least some dynamical features of the propagation .",
    ", ( b ) density @xmath107 and ( c ) exact kohn - sham potential @xmath108 in the case of coherent states ( in spirit of panel 3 in fig . 4 in ref .",
    "@xcite),scaledwidth=50.0% ]        for the second example in this section , we start with the field initially in a coherent state . for a single field mode , coherent states  @xcite can be written as follows : @xmath136 in this example , we use as initial state for the many - body propagation and the kohn - sham propagation @xmath137 here , the atomic state @xmath138 is the ground state of the electronic hamiltonian ( @xmath139 . for the field state we choose @xmath140 .",
    "this example is in the spirit of the calculation in panel 3 in ref .",
    "@xcite . hence , as shown in fig .",
    "[ fig : cs_exact ] , we obtain a similar time - evolution of the inversion @xmath106 as in ref .",
    "we see the cummings collapse of rabi oscillations at @xmath141 followed by a quiescence up to @xmath142 occuring .",
    "after @xmath142 , we see a revival of the rabi oscillations .",
    "we also observe , as shown in @xcite , that the atomic dipole operator ( here the density @xmath107 ) continues to change during the interval of quiescence after the inversion collapse .",
    "as before , we show in the lowest panel the corresponding exact kohn - sham potential obtained via fixed - point iterations .    in fig .",
    "[ fig : cs_weak ] , we show a comparison of the exact kohn - sham potentials and densities to the mean - field propagation . here",
    ", we see that the mean - field approximation performs rather poorly . for this case the simple ansatz in eq .",
    "( [ eq : meanfieldpotential ] ) is not sufficient and more sophisticated approximations to the exact kohn - sham potential are necessary to reach a better agreement @xcite .    in summary",
    ", we have shown in this section the exact kohn - sham potentials which reproduce the dynamics of the exact many - body densities .",
    "in particular the coherent state example shows that there is a clear need for better approximations to the exact kohn - sham potential @xcite that go beyond the mean - field level and that include correlation contributions .",
    "one possibility along these lines is provided by an approach based on the optimized effective potential ( oep ) method @xcite .",
    "we have already implemented such an oep approach for the present model system and the corresponding results improve quite considerably over the mean - field approximation .",
    "the details of this general oep approach to qedft are beyond the scope of the present paper and will be presented in a separate publication @xcite .",
    "after having presented the basic concepts of a qedft reformulation of a coupled matter - photon problem in a model system , we apply the very same ideas to the full theory of qed .",
    "while no new density - functional - type ideas have to be introduced , the intricacies of qed make the actual details more involved .",
    "a first subtlety is the gauge freedom of the photon field . in this work",
    "we choose coulomb gauge to fix the superfluous degrees of freedom .",
    "this gauge has two distinct advantages over the other gauges : it reduces the independent components of the photon field to the two transversal ( physical ) polarizations , and it singles out the classical coulomb interaction between the charged particles . since we want to connect qedft to derived theories like cavity qed , where usually coulomb - gauged photons are employed , and condensed - matter theory , where coulomb interactions play a dominant role , the coulomb gauge is for the present purpose the natural gauge to work in .",
    "however , we emphasize that also other gauges can be used as well @xcite .",
    "we first present the standard approach to identify possible conjugate variables and introduce the basic equations of motions .",
    "while in the usual non - relativistic setting this route works just fine , in the fully relativistic situation the internal structure of the `` dirac particles '' , i.e. the electronic and positronic degrees of freedom , give rise to certain subtleties when performing a density - functionalization .",
    "therefore , instead of using the current , we employ the polarization as a basic fundamental variable in relativistic qedft .      in the following we define the basic quantities of qed in coulomb gauge and",
    "derive the equations of motion for the fundamental ( functional ) variables of the theory .",
    "we employ si units throughout , since in the next section we perform the non - relativistic limit which is most easily done if we keep the physical constants explicit . a detailed discussion of quantizing qed in coulomb gauge is given in appendix [ app : coulomb ] .    the full qed hamiltonian in coulomb gauge ( indicating explicit time - dependence of the hamiltonians by @xmath6 ) is given by @xmath143 here @xmath144 is the normal ordered ( : : ) free dirac hamiltonian in the schrdinger picture , where @xmath145 and @xmath146 denote the dirac - field operators and @xmath147 the dirac matrices ( see appendix  [ app : coulomb ] for definitions ) . the energy of the free photon field is given by @xmath148 where @xmath149 and @xmath150 are the ( vector - valued ) electric and magnetic field operators defined as in appendix [ app : coulomb ] in terms of the maxwell - field operators @xmath151",
    "we note that due to the coulomb - gauge condition @xmath152 only the spatial components of the maxwell field are quantized .",
    "the time component @xmath153 is given by the classical coulomb field of the total charge density , which is the sum of the charge density of the dirac field and the classical external current , and gives rise to the coulomb term @xmath154 here @xmath155 is the zero component of the dirac current @xmath156 and @xmath157 is the zero component of a given external current @xmath158 . in the coulomb term the energy due to",
    "the coulomb interaction of the external current with itself is elided .",
    "since this term is purely multiplicative , i.e. it is equivalent to the identity operator times some real number , it does not influence the dynamics of the system and can be discarded . the rest of the coupling to the external fields",
    "is given by @xmath159 finally , the coupling between the quantized fields in coulomb gauge reads as @xmath160 comparing to the lorentz - gauge qed hamiltonian @xcite the main difference lies in the coulomb term , that treats the zero component of the photon field explicitly .    without further refinements the above qed hamiltonain is not well - defined , since it gives rise to infinities @xcite .",
    "these infinities can be attributed , with the help of perturbation theory , to three divergent types of feynman diagrams : the self - energy of the fermions , the self - energy of the photons ( also called vacuum polarization ) and the vertex corrections .",
    "these divergences vanish if we regularize the theory , e.g. , by introducing frequency cut - offs in the plane - wave expansions of the fermionic as well as the bosonic field operators or by dimensional regularization @xcite .",
    "such procedures make the above hamiltonian self - adjoint @xcite , but we have introduced a dependence on parameters that change the theory at smallest and largest length scales .",
    "perturbatively one can remove these dependencies by renormalizing the theory , i.e. we first identify and then subtract the part of each of these three terms that diverges due to these parameters .",
    "the resulting three divergent counter - terms can be recast as a renormalization of the mass and the field - operators of the fermions ( due to the self - energy ) , as a renormalization of the photonic field - operators ( due to vacuum polarization ) and a renormalization of the charge ( due to the vertex corrections ) .",
    "we can do this to any order in perturbation theory due to the ward - takahashi identities @xcite .",
    "thus , the above qed hamiltonian is at least perturbatively renormalizable . for simplicity , we assume in the following that one can fully renormalize the qed hamiltonian ( as has been shown for certain limits @xcite ) and interpret it as a bare hamiltonian , i.e. we use the renormalized quantities . that a full renormalization is possible has been shown , e.g. , for the nelson model of qed @xcite , where the divergent self - energy term shifts the spectrum of the hamiltonian to infinity .",
    "thus , subtracting this infinite shift , i.e. introducing a counter - term , makes the hamiltonian well - defined ( when removing the cut - offs ) , provided the energy of the system is below the pair - creation limit .",
    "the same condition , i.e. a stable vacuum , we need to impose also on our qed considerations as discussed in @xcite .    in a next step",
    "we identify the _ possible _ conjugate ( functional ) variables of the above qed hamiltonian . here",
    "the physical , time - dependent wave function @xmath161 depends on the initial state and the external pair @xmath162 , which is indicated by @xmath163;t ) \\ , \\right\\rangle}.\\end{aligned}\\ ] ]    thus , with @xmath164 , the ( negative ) qed action @xcite @xmath165 \\!=\\ ! -\\!\\ ! \\int\\!\\ ! \\mathcal{l}_{\\mathrm{qed } }   = \\!-",
    "\\mathcal{b }   \\!+\\ !",
    "\\frac{1}{c } \\ ! \\int \\ !",
    "\\left ( j^{\\mu}_{\\mathrm{ext } } a_{\\mu } + j_{\\mu } a^{\\mu}_{\\mathrm{ext } } \\right ) \\end{aligned}\\ ] ] becomes a functional of these variables ( @xmath166 corresponds to an arbitrary time ) .",
    "here we employed the definition of the qed lagrangian of eq .",
    "( [ qedlagrangian ] ) and defined the internal qed action with help of eq .",
    "( [ qedham ] ) by @xmath167 eq .",
    "( [ qedaction ] ) looks like a legendre transformation between @xmath168 and @xmath169 . since a legendre",
    "transformation amounts to a change of variables , this indicates ( for a fixed initial state ) the possibility of transforming from @xmath16 to the conjugate variables @xmath170 . and",
    "@xmath171 @xcite ]",
    "if these variables would indeed be connected via a standard legendre transformation the functional derivative with respect to @xmath172 and @xmath173 should give the respective conjugate variables .",
    "however , following derivations similar to @xcite we find the appearence of extra terms , i.e. @xmath174 these non - trivial boundary terms are due to the fact , that variations of the external fields give rise to non - zero variations of the wave function at the ( arbitrary ) upper boundary @xmath166 ( in contrast to direct variations of the wave function that are supposed to obey @xmath175 ) @xcite .",
    "these boundary terms are necessary to guarantee the causality of @xmath176 and @xmath177 @xcite .",
    "thus , eqs .",
    "( [ conjugatea ] ) and ( [ conjugatej ] ) show that a straightforward approach to demonstrate a one - to - one correspondence between @xmath16 and @xmath170 based on a legendre transformation becomes difficult @xcite",
    ". nevertheless , usually this legendre - transformation arguments work well to identify the possible conjugate variables .",
    "however , in the relativistic situation a further problem arises : the current has an internal structure due to the electronic and positronic degrees of freedom .",
    "the current @xmath176 describes the net - charge flow of the negatively charged electrons and the positively charged positrons @xcite .",
    "therefore , the current expectation value can not differ between the situation of , e.g. , the movement of two electrons and one positron or three electrons and two positrons .",
    "this fact , which is absent in the non - relativistic situation , will lead to problems when employing the ideas developed in subsection [ subsec : foundmodel ] .",
    "for the moment , however , we follow the above identification scheme and derive the basic equations of motion for @xmath9 and @xmath10 . since @xmath178 f(\\vec{r } ' ) = 0 $ ] , where @xmath179 is any testfunction , the term @xmath180 commutes with @xmath9 and the equation of motion for the four current is the same as in lorentz gauge @xcite @xmath181\\spin(\\vec{r } ) \\\\ & + e c \\dspin(\\vec{r})\\left [ \\gamma^{k}\\gamma^{0}\\left(- \\imagi   \\vec{\\gamma } \\cdot",
    "\\vec{\\nabla}\\right ) + \\left(- \\imagi   \\vec{\\gamma } \\cdot \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\nabla } \\right ) \\gamma^0 \\gamma^{k}\\right ] \\spin(\\vec{r } ) \\nonumber \\\\ & + \\frac{e^2}{\\hbar}\\dspin(\\vec{r})\\left[\\gamma^{k } \\gamma^{0 } \\gamma^{l}- \\gamma^{l } \\gamma^{0 } \\gamma^{k }   \\right]\\spin(\\vec{r})\\ !",
    "\\left ( \\a_{l}(\\vec{r } ) + a_{l}^{\\mathrm{ext}}(x )   \\right ) \\nonumber,\\end{aligned}\\ ] ] where the zero component is given by @xmath182 , i.e. the current obeys the conservation of charge . a different equation that determines the charge current @xmath176",
    "is found by the gordon - decomposition @xcite , which is the evolution equation of the polarization @xmath183 @xmath184 where @xmath185 is the levi - cevita symbol and @xmath186 with the definition of bigger and smaller components of the dirac - field operators @xmath187 we find that the current and the polarization are the real and imaginary part of the same operator @xmath188 the change of gauge only affects the equation for the photon - field operator which becomes @xmath189 and accordingly @xmath190 this is indeed the quantized maxwell equation in coulomb gauge .      in this subsection",
    "we first reexamine the previous approach to relativistic qedft @xcite and identify its shortcomings .",
    "we then show why physically the polarization is better suited as fundamental variable of the matter part and reformulate qed in terms of @xmath191 .",
    "already here we point out that both , a relativistic qedft based on the current or on the polarization , lead to the same density - functional - type theory in the non - relativistic limit .",
    "a first restriction we impose is to fix a specific gauge for the external fields @xmath172 . since by construction external fields that only differ by a gauge transformation , i.e. @xmath192 , lead to the same current density ( and polarization),$ ] which determines the effect of a gauge on the equation of @xmath9 , i.e. eq .",
    "( [ heisenbergcurrent ] ) . by partial integration ,",
    "application of the continuity equation and the fact that @xmath193 \\equiv 0 $ ] this term becomes zero and therefore has no effect on the current .",
    "the same reasoning shows that also @xmath194 is gauge independent . ]",
    "the desired one - to - one correspondence can only hold modulo these transformations .",
    "thus in principle we consider a bijective mapping between equivalence classes , and by fixing a gauge we take a unique respresentative of each class . for simplicity we impose a gauge condition similar to @xcite @xmath195 in the following , any other gauge that keeps the initial state unchanged , i.e. the gauge function has to obey @xmath196 , is also allowed @xcite .",
    "this condition is necessary for our further investigations , since we will employ that the initial state is fixed ( and thus the expectation values at @xmath68 ) , in accordance to the derivations of subsection [ subsec : foundmodel ] .",
    "further , we assume that the external current obeys the continuity equation @xmath197 .",
    "this leaves the choice of the initial charge configuration @xmath198 . since the photons only couple to moving charges this choice will not influence the dynamics of the system",
    "therefore , also in the case of the external currents we have an equivalence class ( of possible zero components ) , and will therefore restrict to only prescribing @xmath199 .",
    "in @xcite the one - to - one correspondence was based on the corresponding ehrenfest equations @xmath200 where @xmath201 \\!\\!\\spin(\\vec{r } ) \\nonumber \\\\ & + \\imagi \\ ; \\frac{e}{\\hbar } m c^2 \\dspin(\\vec{r})\\left [ \\gamma^{0 } \\gamma^{k } - \\gamma^{k } \\gamma^{0 }    \\right]\\spin(\\vec{r}),\\end{aligned}\\ ] ] @xmath202\\spin(\\vec{r}),\\end{aligned}\\ ] ] @xmath203 and the dalembert operator reads as @xmath204 .",
    "we can then reexpress @xmath205 and therefore @xmath206 if we then want to show a possible one - to - one correspondence we can follow the reasoning of sec .",
    "[ subsec : foundmodel ] and",
    "consider the uniqueness of solutions of the functional equations @xmath207;x ) + q_{\\mathrm{int}}^{k}([a_{{{\\rm ext}}}^{m},j_{{{\\rm ext}}}^{m}];x ) \\nonumber \\\\ & + n^{k l}([a_{{{\\rm ext}}}^{m},j_{{{\\rm ext}}}^{m}];x ) a_{l}^{\\mathrm{ext}}(x ) , \\\\ \\label{intpotentialfun } \\box a^{k}(x ) & + \\partial^{k } \\left(\\frac{1}{c } \\int \\diff^3 r ' \\frac{\\vec{\\nabla}'\\cdot\\vec{j}_{\\mathrm{ext}}(x ' ) + \\vec{\\nabla}'\\cdot\\vec{j}(x')}{4 \\pi \\epsilon_0 |\\vec{r } - \\vec{r}'| }   \\right ) \\nonumber \\\\ & =   \\mu_0 c \\left(j^{k}_{{{\\rm ext}}}(x ) + j^{k}(x ) \\right),\\end{aligned}\\ ] ] for given @xmath208 and @xmath209 .",
    "the freedom of the internal variable @xmath208 is also restricted , since @xmath210 is fixed by the initial state and the continuity equation for all times .",
    "similarly the freedom of the external current @xmath211 is in correspondence to the freedom of the internal field @xmath209 . ] as before in sec .",
    "[ subsec : foundmodel ] we can construct the external current uniquely . by defining the vector field @xmath212",
    "we find from the helmholtz decomposition of @xmath213 and @xmath214 that @xmath215 thus , we need to show that for given @xmath216 there can only be a unique @xmath217 . and",
    "@xmath218 , respectively .",
    "since @xmath219 is given by eq .",
    "( [ coulombpotential ] ) its first order time - derivative is , due to the continuity equation , given in terms of @xmath199 and @xmath220 .",
    "thus , to determine @xmath219 we only have to choose an initial condition . however , due to eq .",
    "( [ coulombpotential ] ) this choice also fixes automatically the initial condition for @xmath221 for the continuity equation @xmath222 . ] to show this we first define @xmath223 formally construct the respective taylor coefficients @xmath224 \\\\ & + \\sum_{\\beta=0}^{\\alpha } { \\alpha \\choose \\beta } \\left ( a^{l \\ , ( \\beta)}_{\\mathrm{ext}}(\\vec{r } )   \\right ) \\left(n_{k l}^{(\\alpha-\\beta)}(\\vec{r } ) \\right),\\nonumber \\end{aligned}\\ ] ] and consider two external potentials @xmath225 that differ at lowest order @xmath74 .",
    "accordingly we find in this order @xmath226 where @xmath227 while before we could conclude that the difference between the currents is necessarily non - zero provided @xmath228 , here we find that this is not sufficient .",
    "actually , we need to restrict the allowed potentials @xmath229 to those that are perpendicular to @xmath230 . if we do this , then eq .  ( [ possiblecontradiction ] ) makes the currents necessarily different and we can conclude that we have a one - to - one correspondence .",
    "this aspect was not taken into account in previous work @xcite , which is restricting effectively the one - to - one mapping to a smaller set of potentials and currents in these proofs .",
    "still , it seems possible to find a different way to show the bijectivity of the complete mapping @xmath231 .",
    "however , the true drawback of a relativistic qedft based on the current is found if we try to reproduce a given pair @xmath216 .",
    "if we choose a current that obeys @xmath232 then the resulting equation that defines the taylor - coefficient of the external potential reads by employing eq .",
    "( [ currenttaylor ] ) and following the same strategy as in subsection [ subsec : ksmodel ] @xmath233 this equation does not have a solution and therefore any current that obeys the above form can not be reproduced by the respective quantum system .",
    "this does also call into doubt the possibility of exactly predicting the current of a coupled system by an uncoupled one , i.e. the kohn - sham construction of @xcite .",
    "of course we can remedy this problem by adding terms to the qed hamiltonian that break the minimal - coupling prescription of the lagrangian .",
    "such procedures could then be alternatively used to provide a kohn - sham scheme to describe the fully coupled qed problem .",
    "the advantage of such an approach is , that still the equation for the vector potential is known explicitly in terms of the internal pair @xmath216 .",
    "this is not the case , when we use a different basic variable for the matter part of the qed system , as we will do in the following .    to avoid the problems with the relativistic current",
    ", we will in the following base our considerations on the polarization @xmath234 .",
    "while the current describes the flow of the charge of the system ( which is conserved ) , the polarization depends on the actual number of particles and anti - particles ( which is not conserved ) .",
    "therefore , the polarization can actually differ between a local current produced by , e.g. , two electrons and one positron or three electrons and two positrons , in contrast to the current . to show",
    "now that for a fixed initial state @xmath1 we actually have @xmath235 we demonstrate that for a given internal pair @xmath236 the two coupled equations @xmath237;x ) +   \\vec{q}_{\\mathrm{int}}([a_{{{\\rm ext}}}^{k},j_{{{\\rm ext}}}^{k}];x )   \\\\ & + \\frac{2emc}{\\imagi \\hbar } \\vec{j}([a_{{{\\rm ext}}}^{k},j_{{{\\rm ext}}}^{k}];x ) + \\frac{2e}{\\imagi \\hbar c } p_{0}([a_{{{\\rm ext}}}^{k},j_{{{\\rm ext}}}^{k}];x ) \\vec{a}_{\\mathrm{ext}}(x ) \\nonumber   \\\\",
    "\\label{intpotfun } \\box & \\vec{a}(x ) - \\mu_0 c \\left(\\vec{j}_{{{\\rm ext}}}(x ) + \\vec{j}([a_{{{\\rm ext}}}^{k},j_{{{\\rm ext}}}^{k}];x ) \\right )   \\\\ & =   \\vec{\\nabla } \\left(\\frac{1}{c } \\int \\diff^3 r ' \\frac{\\vec{\\nabla}'\\cdot\\vec{j}_{{{\\rm ext}}}(x ' ) + \\vec{\\nabla}'\\cdot\\vec{j}([a_{{{\\rm ext}}}^{k},j_{{{\\rm ext}}}^{k}];x')}{4 \\pi \\epsilon_0 |\\vec{r } - \\vec{r}'| }   \\right ) , \\nonumber\\end{aligned}\\ ] ] allow only for a unique solution @xmath238 . here",
    "we used the definitions @xmath239 @xmath240 these coupled equations can only have a solution if the pair @xmath236 obeys the initial condition enforced by the fixed initial state @xmath1 , i.e. @xmath241 since the current @xmath208 is now a functional of @xmath238 the previous explicit construction of @xmath211 is no longer valid .",
    "however , if we assume @xmath238 _ both _ to be taylor - expandable we find for the lowest order @xmath74 on the one hand that @xmath242 provided @xmath243 , which corresponds to the ( local ) total number of particles and anti - particles . on the other hand we have @xmath244 otherwise there would exist a current @xmath245 that fulfills @xmath246 however , due to the definition of the coulomb potential as the green s function of the laplacian ( see eq .",
    "( [ coulombpotential ] ) and ( [ a0 ] ) ) we find from the divergence of eq .",
    "( [ currentuniqueness ] ) that @xmath247 and thus the only possible current that fulfills eq .",
    "( [ currentuniqueness ] ) is @xmath248 .",
    "thus , the mapping ( [ relpairmapping ] ) is bijective ( at least for taylor - expandable external pairs @xmath249 ) .",
    "therefore we can , instead of solving the fully coupled qed problem for the ( numerically infeasible ) wave function @xmath161 , determine the exact internal pair @xmath236 from the coupled non - linear equations @xmath250;x ) +   \\vec{q}_{\\mathrm{int}}([p_{k},a_{k}];x )   \\\\ & + \\frac{2emc}{\\imagi \\hbar } \\vec{j}([p_{k},a_{k}];x ) + \\frac{2e}{\\imagi \\hbar c } p_{0}([p_{k},a_{k}];x ) \\vec{a}_{{{\\rm ext}}}(x ) \\nonumber   \\\\ \\label{intpotfunbasic } \\box & \\vec{a}(x ) - \\vec{\\nabla } \\left(\\frac{1}{c } \\int \\diff^3 r ' \\frac{\\vec{\\nabla}'\\cdot\\vec{j}_{{{\\rm ext}}}(x ' ) + \\vec{\\nabla}'\\cdot\\vec{j}([p_{k},a_{k}];x')}{4 \\pi \\epsilon_0 |\\vec{r } - \\vec{r}'| }   \\right ) \\nonumber \\\\ & =   \\mu_0 c \\left(\\vec{j}_{{{\\rm ext}}}(x ) + \\vec{j}([p_{k},a_{k}];x ) \\right),\\end{aligned}\\ ] ] for the initial conditions ( [ initialpolarization ] ) and ( [ initialfourpotential ] ) . in order to solve these equations simultaneously",
    "we need to find approximations for the unknown functionals .",
    "the only drawback in this more general approach than the ones used in @xcite , is that now we also have an unknown functional in the classical maxwell equation , i.e. @xmath251 $ ] .      in this subsection",
    "we provide the adopted kohn - sham construction based on the internal pair @xmath252 and give the simplest approximation for the kohn - sham potential and current . as in sec .",
    "[ subsec : ksmodel ] , we choose our auxiliary kohn - sham system to be an uncoupled system . while different kohn - sham constructions are possible , this approach is the numerically least demanding .    in a first step , in accordance to sec .",
    "[ subsec : ksmodel ] , we first construct an uncoupled system that can _ reproduce _ a given internal pair @xmath236 of the fully coupled qed system .",
    "to do so , we first need an initial state @xmath91 that fulfills the initial condition ( [ initialpolarization ] ) and ( [ initialfourpotential ] ) of the full qed system .",
    "this allows that the coupled equations @xmath253;x ) + \\frac{2emc}{\\imagi \\hbar } \\vec{j}([a^{k}_{\\mathrm{eff}},j^{k}_{\\mathrm{eff}}];x ) \\nonumber   \\\\ & + \\frac{2e}{\\imagi \\hbar c } p_{0}([a^{k}_{\\mathrm{eff}},j^{k}_{\\mathrm{eff}}];x ) \\vec{a}_{\\mathrm{eff}}(x )   \\\\ \\label{intpotfuneff } \\box \\vec{a}(x ) & - \\vec{\\nabla } \\left(\\frac{1}{c } \\int \\diff^3 r ' \\frac{\\vec{\\nabla}'\\cdot\\vec{j}_{\\mathrm{eff}}(x')}{4 \\pi \\epsilon_0 |\\vec{r } - \\vec{r}'| }   \\right ) \\nonumber \\\\ & =   \\mu_0 c \\vec{j}_{\\mathrm{eff}}(x ) , \\end{aligned}\\ ] ] can only have a unique solution . obviously , for the case of the uncoupled problem we can use a construction similar to eqs .",
    "( [ currentconstruction ] ) to determine the unique @xmath254 . to show the existence of a solution to eq .",
    "( [ intpolfuneff ] ) we perform the standard taylor - expansion construction and assume that the series converges @xcite",
    ". a more general approach would be to follow a fixed - point procedure @xcite .",
    "the respective taylor - coefficients of the effective potential are given by @xmath255 this construction makes plausible that there exists an uncoupled system subject to the effective external fields @xmath256 that reproduces a given pair of a fully coupled qed problem .",
    "the above construction actually resembles the mapping @xmath257 for a given pair @xmath258 .",
    "now , to _ predict _ the internal pair @xmath258 of the full qed problem we again introduce a composite mapping @xmath259 the resulting kohn - sham potential and kohn - sham current are then given by the functional equations @xmath260;x )",
    "\\vec{a}_{\\mathrm{ks}}(x )   = \\frac{\\imagi \\hbar c } { 2e}\\left ( \\vec{q}_{\\mathrm{kin}}([\\psi_0 , p_k , a_{k}];x ) \\right .",
    "\\nonumber \\\\ & \\left .",
    "- \\vec{q}_{\\mathrm{kin}}([\\phi_0 , p_k , a_{k}];x ) +   \\vec{q}_{\\mathrm{int}}([\\psi_0 , p_k , a_{k}];x ) \\right )   \\nonumber   \\\\ & + mc^2 \\left ( \\vec{j}([\\psi_0 , p_k , a_{k}];x ) - \\vec{j}([\\phi_0 , p_k , a_{k}];x ) \\right ) \\nonumber \\\\ & + p_{0}([\\psi_0 , p_k , a_{k}];x ) \\vec{a}_{\\mathrm{ext}}(x )   \\\\ \\label{intpotfunks } \\vec{j}_{\\mathrm{ks}}&(x ) =   \\vec{j}_{{{\\rm ext}}}(x ) + \\vec{j}([\\psi_0 , p_k , a_{k}];x).\\end{aligned}\\ ] ] this allows to solve an uncoupled system instead of the fully coupled qed problem .",
    "however , as also pointed out in @xcite , we can only fully decouple the matter from the photon part if also the initial state is of product form , i.e. @xmath261 . and",
    "if we further assume that @xmath262 is given in terms of a slater - determinant we can actually map the whole problem to solving a dirac equation with the above kohn - sham potential @xmath263 and simultaneously a classical maxwell equation with @xmath264 .",
    "the mean - field approximation recovers the approximation introduced in @xcite and reads as @xmath265 since for simplicity we used a gauge where @xmath266 while for the photon field we employed coulomb gauge , we have to perform an according gauge transformation to have the mean field @xmath267 in either the one or the other gauge completely .",
    "this approximation is similar to the maxwell - schrdinger approach , that assumes the photon field to behave essentially classically .",
    "while for the sake of generality we have been considering the full qed problem in the previous section , we are actually mainly interested in the behaviour of condensed - matter systems or atoms and molecules that interact with photons . in such situations",
    "the external fields are usually small compared to the schwinger - limit , i.e. we do not have pair - production is such situations .",
    "further , we want to investigate systems , where the quantum nature of the photons becomes important .",
    "most prominently this happens for the case of a cavity , where different boundary conditions for the maxwell field have to be considered .",
    "these quantum - optical situations also naturally restrict the available photonic modes .",
    "such physical situations are then well described by models of non - relativistic particles interacting with a quantized electromagnetic field , such as the pauli - fierz hamiltonian ( see e.g. @xcite ) or the nelson model @xcite . in the lowest order of approximations",
    "we find the situation of a two - level system interacting with one photonic mode , similar to the one presented in sec .",
    "[ sec : model ] .",
    "this simplest of models is the prime example of a quantum - optical problem .",
    "we realize at this point , that all the conditions we had to impose in order to make our starting qed hamiltonian well - defined , are naturally met in the situations we aim at investigating .",
    "actually , we even do not need to adopt a field - theoretical treatment for the particles in the first place and usually only need to take into account a few photonic modes .",
    "such an approach would avoid a lot of unpleasent problems in connection with renormalization and regularization of these theories .",
    "however , one would then need to introduce a new qedft approach for every new type of model hamiltonian .",
    "therefore , in this section we want to demonstrate how naturally all lower lying qedft reformulations are just approximations to the fully relativistic qedft that we presented in the previous sections . in lowest order we then recover the two - site hubbard model coupled to one mode of sec .  [",
    "sec : model ] .      in this subsection",
    "we derive the non - relativistic limit of the basic equations of motion , on which the qedft reformulations are based .",
    "we show how approximations in the hamiltonian correspond to approximations in the basic equations of the corresponding qedft approaches .",
    "let us first start with the non - relativistic limit of the fully coupled qed hamiltonian in coulomb gauge . from the heisenberg equation of motion , defining @xmath268 and @xmath269 , we find the quantized dirac equation ( in the heisenberg picture ) @xmath270 \\spin(x ) \\nonumber \\\\ & \\qquad + e^2 \\int \\diff^3 r ' \\frac{:\\spin^{\\dagger}(x ' ) \\spin(x'):}{4 \\pi \\epsilon_0 |\\vec{r}-\\vec{r}'| } \\spin(x ) , \\end{aligned}\\ ] ] and accordingly for @xmath271 .",
    "we see that the electronic components @xmath272 of the four - spinor are mixed with the positronic components @xmath273 .",
    "of course , for small energies only the electronic component of the four - spinor is important , and therefore we would like to find an equation based solely on @xmath272 .",
    "so naturally we would like to decouple the upper component @xmath272 from the lower component @xmath273 .",
    "a possible way would be to find a unitary transformation of the dirac hamiltonian that does this , at least perturbatively . a possible expansion parameter for auch a perturbative transformation would be @xmath274 , since we know that the energies involved in non - relativistic processes are small compared to the rest - mass energy .",
    "this energy also represents the spectral gap between the electronic and positronic degrees of freedom , which effectively decouples the dynamics of the particles and anti - particles for small enough energies .",
    "the resulting unitary transformations are known as the foldy - wouthuysen transformations @xcite and are routinely used to generate the non - relativistic limits of the dirac equation to any order desired . here",
    ", we employ an equivalent but different procedure to decouple the electronic from the positronic degrees of freedom . to do so , we first rewrite eq .",
    "( [ quantizeddirac ] ) componentwise @xmath275 where we defined    @xmath276    and thus we ( formally ) find that @xmath277^{-1 } \\vec{\\sigma } \\cdot \\left(\\ !",
    "-\\imagi \\hbar c \\vec{\\nabla}\\ ! -\\ !",
    "e \\hat{\\vec{a}}_{\\mathrm{tot}}(x)\\!\\right ) \\p(x).\\end{aligned}\\ ] ] if we assume non - relativistic energies , the main contribution to the energy of the system stems from @xmath278 , i.e. @xmath279 .",
    "accordingly , from the neumann series of the resulting operator we find the inverse operator to lowest order as @xmath280^{-1 } \\approx 1/2mc^2 $ ] , and consequently @xmath281 at this level of approximation to the full qed problem we find the pauli - fierz hamiltonian ( already transformed back to the schrdinger picture ) , @xmath282 where the non - relativistic kinetic energy reads as @xmath283 the energy of the electromagnetic field is given as before , the coulomb energy is given by @xmath284 and the non - relativistic current is defined by @xmath285 here we used the definition of the paramagnetic current @xmath286,\\end{aligned}\\ ] ] the magnetization density @xmath287 and the zero component of the current @xmath288 by construction the current obeys the continuity equation @xmath289 .",
    "we note here , that due to the non - relativistic limit the physical current defined in eq .",
    "( [ nonrelcurrent ] ) becomes explicitly time - dependent @xcite .",
    "further , we point out that the result of the above ( formal ) derivations is the same as the result obtained by first performing the non - relativistic limit of the classical hamiltonian @xmath290 ( constructed from the classical lagranian density of eq .",
    "( [ qedlagrangian ] ) ) and then canonically quantizing the schrdinger field , as shown in fig .",
    "[ fig : qed_mapping ]  ( a ) .         in the non - relativistic limit the resulting hamiltonian commutes with the particle - number operator @xmath291 , as can be seen directly from the continuity equation .",
    "accordingly we do not need to employ a field - theoretical description for the electrons and all matter - operators can be expressed in first - quantized notation ( while still being a many - particle problem ) .",
    "nevertheless , we can still encounter infinities due to the interaction between the non - relativistic particles and the quantized maxwell field @xcite .",
    "while we do no longer have vacuum polarization ( no electron - positron pairs are possible ) and vertex corrections , we still have an infinite self - energy @xcite .",
    "to first order in the coupling the ground - state energy ( for @xmath292 ) diverges as @xmath293 where @xmath294 is the ultra - violet cut - off for the photon modes . by subtracting the infinite self - energy of the ground - state , which is equivalent to introducing a renormalized mass , we can renormalize the hamiltonian perturbatively . in the following we assume ,",
    "that the pauli - fierz hamiltonian can be fully renormalized . for instance , in the limit of only scalar photons ( the nelson model ) we know that we can perform a full renormalization of the hamiltonian by subtracting the self - energy ( provided that the kinetic energy of the problem is smaller than @xmath278 ) @xcite .",
    "therefore , we interpret the electron mass in the hamiltonian as a bare mass , i.e. we subtract the infinite self - energy .    now , the equation of motion for @xmath295 can be either found by the heisenberg equation with the pauli - fierz hamiltonian or by the non - relativistic limit of eq .",
    "( [ heisenbergcurrent ] ) ( see appendix ( [ app : nonreleom ] ) ) . we have explicitly checked both ways of performing the non - relativistic limit as schematically indicated in fig .",
    "[ fig : qed_mapping ]  ( b ) . after some calculation",
    "we find ( omitting the spatial and temporal dependences )    @xmath296   \\j_{0}\\right\\ } \\nonumber \\\\ & - \\epsilon_{klj } \\partial^{l } \\left\\ { -\\frac{e \\hbar^3}{4 m^2}\\p^{\\dagger } \\left ( \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\partial}^{n } \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\partial}_{n } \\sigma^{j } - \\sigma^{j}\\partial^{n } \\partial_n \\right)\\p +   \\frac{i e}{mc^2 } \\partial_n \\a^n_{\\mathrm{tot } } \\hat{m}^{j } - \\frac{i e}{2 mc^2 } \\left[\\left(\\partial^{j } \\a_n^{\\mathrm{tot } } \\right ) - \\left(\\partial_n{j } \\a^j_{\\mathrm{tot } } \\right )    \\right ] \\hat{m}^{n } \\right\\ } \\nonumber \\\\ & - \\frac{1}{mc^2 } \\left\\{\\left(\\imagi \\partial_0 \\a_{k}^{\\mathrm{tot } }    \\right)\\j_{0 } + \\a_k^{\\mathrm{tot}}\\left(\\frac{\\imagi e}{mc^2 } \\partial_l \\a^{l}_{\\mathrm{tot } } \\j_{0 } - \\imagi \\partial^{l } \\j^{\\mathrm{p}}_l    \\right )    \\right\\},\\end{aligned}\\ ] ]    where @xmath297\\end{aligned}\\ ] ] is the usual momentum - stress tensor and @xmath298 is the interaction - stress force ( the divergence of the interaction - stress tensor ) @xcite .",
    "if we would have started with an uncoupled problem , we would find a similar equation with the replacement @xmath299 and @xmath300 .",
    "further , the equation for the electromagnetic field does not change , except that we now have to employ the non - relativistic current ( see appendix  [ app : nonreleom ] ) .    in a next step",
    "we perform the non - relativistic limit for the equation of motion of the polarization , i.e. eq .  ( [ gordondecomposition ] ) .",
    "we find to order @xmath301 @xmath302 thus , at this level of approximation the polarization does not change in time .",
    "in this subsection we derive the basic formulation of non - relativistic qedft for the full pauli - fierz hamiltonian .",
    "we show how the gordon - decomposition , i.e. the equation of motion for the polarization @xmath303 , makes the current @xmath304 a unique functional of @xmath305 and thus becomes the basic variable for the matter part in this limit .",
    "further we demonstrate how the non - relativistic limit of the above kohn - sham construction produces the kohn - sham construction for the pauli - fierz hamiltonian .",
    "a comparison of this level of approximation with relativistic qedft and with other approximations is presented schematically in appendix  [ app : overview ] .",
    "we start by performing the non - relativistic limit of eq .",
    "( [ polrelqedft ] ) .",
    "irrespective of the difference between @xmath229 and @xmath306 ( note , that we again employ the @xmath307 gauge for the external potentials as explained in sec .",
    "[ subsec : foundrelqedft ] ) the equation in this limit is always zero . however , by employing eq .",
    "( [ nonrelgordon ] ) we can rearrange the non - relativistic limit to @xmath308 which is non - zero provided the density obeys @xmath309 .",
    "the form of eq .",
    "( [ potrelqedft ] ) does not change and thus we have in the non - relativistic limit that @xmath310 accordingly we can label all physical wave functions by the non - relativistic internal pair @xmath311 .",
    "since @xmath208 does no longer have an internal structure ( no positronic degrees of freedom ) , our approach of sec .",
    "[ subsec : eomqed ] to determine the conjugate pairs based on a legendre - transformation argument now works just fine .",
    "the pauli - fierz lagrangian ( determined from the pauli - fierz hamiltonian of eq .",
    "( [ nonrelham ] ) ) has a similar structure as the full qed lagrangian of eq .",
    "( [ qedaction ] ) and thus allows to identify the conjugate pairs .",
    "indeed , the legendre - transformation argument holds for all further non - relativistic approximations , especially for our model system of sec .",
    "[ sec : model ] .",
    "now we can , instead of solving for the wave function , solve the coupled equations @xmath312;x ) + \\vec{q}_{\\mathrm{m}}([j_k , a_k , a^{k}_{{{\\rm ext}}}];x )   \\nonumber \\\\ & + \\vec{q}_{0}([j_k , a_k , a^{k}_{{{\\rm ext}}}];x ) ,   \\\\",
    "\\label{nonrelpotfunbasic } \\box \\vec{a}(x ) & - \\vec{\\nabla } \\left(\\frac{1}{c } \\int \\diff^3 r ' \\frac{\\vec{\\nabla}'\\cdot\\vec{j}_{{{\\rm ext}}}(x ' ) + \\vec{\\nabla}'\\cdot\\vec{j}(x')}{4 \\pi \\epsilon_0 |\\vec{r } - \\vec{r}'| }   \\right ) \\nonumber \\\\ & =   \\mu_0 c \\left(\\vec{j}_{{{\\rm ext}}}(x ) + \\vec{j}(x ) \\right),\\end{aligned}\\ ] ] for a fixed initial state and external pair @xmath305 , where @xmath313 is the first term on the right hand side of eq .",
    "( [ nonreleom ] ) , @xmath314 corresponds to the second term and @xmath315 corresponds to the third . the initial state and the fixed external pair @xmath305 determine the initial conditions for the above coupled equations .",
    "the explicit appearance of the external potential in several terms in the equation of motion and in the initial condition is due to the non - relativistic limit .",
    "the main advantage of this limit is , that we do no longer need an explicit approximation for functionals in the maxwell equation , since we now consider the current directly .    in a next step",
    "we can then perform the non - relativistic limit of the kohn - sham scheme of eqs .",
    "( [ intpolfunks ] ) and ( [ intpotfunks ] ) which leads to @xmath316;x ) a_{\\mathrm{ks}}^{k}(x )   \\\\ & = j_{0}([\\psi_0,j_n , a_{n}];x ) a_{{{\\rm ext}}}^{k}(x ) + \\langle \\a^{k } \\j_0 \\rangle ( [ \\psi_0,j_n , a_{n}];x ) \\nonumber \\\\ & + \\frac{mc}{e}\\left ( j_{\\mathrm{p}}^{k}([\\phi_0,j_n , a_{n}];x ) -   j_{\\mathrm{p}}^{k}([\\psi_0,j_n , a_{n}];x ) \\right ) \\nonumber \\\\ & + \\frac{mc}{e}\\epsilon^{klj}\\partial_l\\left ( m_{j}([\\psi_0,j_n , a_{n}];x ) -m_{j}([\\phi_0,j_n , a_{n}];x ) \\right ) \\nonumber \\\\ & j_{\\mathrm{ks}}^{k}(x ) =   j^{k}_{{{\\rm ext}}}(x ) + j^{k}(x ) .",
    "\\nonumber\\end{aligned}\\ ] ] if we then further assume that the different initial states fulfill @xmath317 ( due to the continuity equations the zero components stay equivalent ) we can define the so - called hartree - exchange - correlation ( hxc ) potential by @xmath318 = \\vec{a}_{{{\\rm ext } } } + \\vec{a}_{\\mathrm{hxc}}[\\psi_0,\\phi_0 , j_k , a_{k } ] , \\end{aligned}\\ ] ] and we end up with @xmath319;x ) \\\\ & + \\frac{mc}{e}\\left ( j_{\\mathrm{p}}^{k}([\\phi_0,j_n , a_{n}];x ) -   j_{\\mathrm{p}}^{k}([\\psi_0,j_n , a_{n}];x ) \\right ) \\nonumber \\\\ & + \\frac{mc}{e}\\epsilon^{klj}\\partial_l\\left ( m_{j}([\\psi_0,j_n , a_{n}];x ) -m_{j}([\\phi_0,j_n , a_{n}];x ) \\right ) .",
    "\\nonumber\\end{aligned}\\ ] ] thus , assuming that we have given an appropriate initial state of the form @xmath320 that has the same initial current , initial potential and electric field ( corresponding to the first time - derivative of the potential ) we can solve simultaneously @xmath321{\\left| \\ , \\mathrm{m}(t ) \\ , \\right\\rangle } , \\nonumber \\\\",
    "\\label{nonrelksii } & \\box a^{k}(x ) + \\partial^{k } \\left(\\frac{1}{c } \\int \\diff^3 r ' \\frac{\\vec{\\nabla}'\\cdot\\vec{j}_{{{\\rm ext}}}(x ' ) + \\vec{\\nabla}'\\cdot\\vec{j}(x')}{4 \\pi \\epsilon_0 |\\vec{r } - \\vec{r}'| }   \\right ) \\nonumber \\\\ & \\qquad=   \\mu_0 c \\left(j^{k}_{{{\\rm ext}}}(x ) + j^{k}(x ) \\right).\\end{aligned}\\ ] ] if we further assume that the initial state @xmath262 is given as a slater determinant of orbitals @xmath322 , we can solve single - orbital kohn - sham equations .",
    "the simplest approximate hxc potential is just the non - relativistic limit of the mean - field approximation of eq .",
    "( [ relmfapprox ] ) , i.e. @xmath323 note again , that without a further gauge transformation we now also have a scalar potential in the kohn - sham hamiltonian due to @xmath218 .",
    "we point out , that we could alternatively use eq .",
    "( [ nonreleom ] ) directly to show the one - to - one correspondence between the external pair @xmath305 and the non - relativistic internal pair @xmath311 @xcite .",
    "however , besides being more involved , also the connection to relativistic qedft becomes less clear .",
    "nevertheless , for the construction of approximations to the kohn - sham potential , eq .",
    "( [ nonreleom ] ) seems better suited , since it is a more explicit equation .      in this subsection",
    "we show how , by introducing further approximations , we can find a family of non - relativistic qedfts , which in the lowest - order approximation leads to the model qedft of sec .",
    "[ sec : model ] .    as pointed out before , in the non - relativistic situation the initial guess for the conjugate pairs , i.e. by identifying a legendre - type transformation in the lagrangian of the problem , holds true .",
    "thus we can now derive all sorts of approximate qedfts by investigating different conserved currents and restrictions to the photonic degrees of freedom . in the currents this holds since approximating",
    "the conserved current @xmath304 implies approximating the hamiltonian in eq .",
    "( [ nonrelham ] ) accordingly .",
    "thus , e.g. , by assuming a negligible magnetic density @xmath324 , i.e. @xmath325 the according hamiltonian as well as the defining eqs .",
    "( [ nonreleom ] ) and ( [ nonrelgordon ] ) change .",
    "actually , all terms @xmath326 and @xmath327 vanish in these equations for this approximation .",
    "we again find due to the corresponding eq .",
    "( [ nonrelcontra ] ) that we have @xmath328 and we can consider the corresponding coupled eqs .",
    "( [ nonrelcurrentfunbasic ] ) and ( [ nonrelpotfunbasic ] ) .",
    "the kohn - sham current becomes accordingly @xmath329 and the hxc potential in this limit reduces to @xmath330;x ) \\\\ & + \\frac{mc}{e}\\left ( j_{\\mathrm{p}}^{k}([\\phi_0,j_k , a_{k}];x ) -   j_{\\mathrm{p}}^{k}([\\psi_0,j_k , a_{k}];x ) \\right ) .",
    "\\nonumber\\end{aligned}\\ ] ]    on the other hand we can also restrict the allowed photonic modes . for instance we can assume a perfect cubic cavity ( zero - boundary conditions ) of length @xmath33 . then , with the allowed wave vectors @xmath331 and the corresponding dimensionless creation and annihilation operators @xmath332 and @xmath333 ( see appendix ( [ app : hubbard ] ) for more details ) we find @xmath334 \\mathcal{s}(\\vec{n}\\cdot{\\vec{r } } ) , \\end{aligned}\\ ] ] where the mode function @xmath335 is given in eq .",
    "( [ modefunction ] ) . if we further restrict the modes by introducing a square - summable regularization function @xmath336 , e.g. @xmath337 for @xmath338 ( energy smaller than rest - mass energy ) and @xmath339 otherwise , the resulting regularized field @xmath340 \\mathcal{s}(\\vec{n}\\cdot{\\vec{r}})\\end{aligned}\\ ] ] makes the coupled pauli - fierz hamiltonian self - adjoint without any further renormalization procedure @xcite .",
    "such a restriction is assumed in the following .",
    "these approximations are then directly reflected in the hamiltonian and the derived equations of motion . while the basic eq .",
    "( [ nonrelgordon ] ) does not change , and thus @xmath304 is the basic matter - variable , the basic equation of motion for the potential @xmath341 has to reflect the restriction to specific modes . by multiplying eq .",
    "( [ nonrelpotfunbasic ] ) from the left by @xmath342 and integrating we find the mode expansions @xmath343 where @xmath344 and we use the definition @xmath345 the coulomb part vanishes since we employ a partial integration and the fact that @xmath346 .",
    "of course , one finds the same equations by a straightforward calculation of the heisenberg equation of motion for the maxwell - field ( [ cavitypotential ] ) with the according pauli - fierz hamiltonian ( [ nonrelham ] ) . from the restriction to specific modes the field @xmath341 is restricted in its spatial form and therefore the photonic variable changes from @xmath341 to the set of mode expectation values @xmath347 this change in basic variable is also reflected in the conjugate external variable which is given via eq .",
    "( [ modeexpansion ] ) as @xmath348 thus we accordingly find @xmath349 and the conjugate pairs become @xmath350 thus we have to solve the mode eqs .",
    "( [ modeexpansion ] ) together with the according equation of motion for the current .",
    "correspondingly also the kohn - sham scheme and the mean - field approximation for @xmath351 change to its mode - equivalents .",
    "if we then also employ the dipole - approximation , i.e. we assume that the extension of our matter system is small compared to the wavelengths of the allowed photonic modes , we find @xmath352.\\end{aligned}\\ ] ] this only changes the definition of effective currents that couple to the modes , i.e. @xmath353 but leaves the structure of the qedft reformulation otherwise unchanged .",
    "if we assume the magnetization density @xmath354 to be negligible , we have from first principles rederived the qedft formulation presented in @xcite . in this work",
    "the situation of only scalar external potentials , i.e. @xmath355 and @xmath356 , has been considered as a second case . in this situation ,",
    "the gauge freedom is only up to a spatial constant , which is usually fixed by choosing @xmath357 for @xmath358 .",
    "since @xmath359 couples to the zero component of the current , i.e. the density @xmath360 , the conjugate pair becomes @xmath361 to demonstrate this mapping , the first time derivative of @xmath360 is obviously not enough , since this amounts to the continuity equation and no direct connection between the two conjugate variables of the matter part of the quantum system is found .",
    "therefore , one has to go to the second time derivative of @xmath360 @xcite . if we then further simplify this physical situation ( see appendix ( [ app : hubbard ] ) for a detailed derivation ) we find the model hamiltonian of sec .",
    "[ sec : model ] . in a similar manner , by imposing the restrictions on the corresponding equations of motion , we can rederive the model qedft of sec .",
    "[ subsec : foundmodel ] . ) for the external potentials . by applying the dipole approximation also to the external vector potential",
    "the conjugate variable becomes the density ( dipole moment ) .",
    "for clarity of presentation , though , we have chosen to start from the scalar- potential case . ]    finally , for a simple overview , we have collected the different qedfts that we have explicitly considered in this work in appendix  [ app : overview ] .",
    "in this work we have shown how one can extend the ideas of tddft to quantized coupled matter - photon systems .",
    "we have first explained the basic ideas of qedft for a model system of a two - site hubbard model coupled to a single photonic mode . by rewriting the problem in terms of an effective theory for a pair of internal functional variables and proving the uniqueness of solutions for the resulting non - linear coupled equations ,",
    "we have demonstrated how an explicit solution for the coupled photon - matter wave function can be avoided .",
    "further we have discussed how an auxiliary quantum system , the so - called kohn - sham system , can be used to construct approximations for the implicit functionals appearing in the effective equations .",
    "the kohn - sham construction gives rise to effective fields and effective currents , which are termed kohn - sham potential and kohn - sham current , respectively . by numerically constructing the exact kohn - sham potential and kohn - sham currents ,",
    "we have illustrated the capability of this new approach to exactly describe the dynamics of coupled matter - photon systems and contrasted these exact fields with the mean - field approximation .    in the following , instead of reformulating every possible approximate treatment of coupled matter - photon systems",
    "seperately , we have shown how these qedfts for approximate hamiltonians are merely approximations to relativistic qedft , which itself is based on qed . to avoid problems with the kohn - sham construction ,",
    "we have based relativistic qedft on the expectation value of the polarization and the vector potential of the quantum system . by then performing the non - relativistic limit of qedft",
    "we have demonstrated that the resulting theory is the qedft reformulation of the pauli - fierz hamiltonian .",
    "the non - relativistic limit automatically makes the ( non - relativistic ) current the basic variable for the matter system .",
    "accordingly , the non - relativistic limit of the kohn - sham potentials and currents leads to the corresponding kohn - sham fields for the pauli - fierz hamiltonian . by performing further approximations for non - relativistic qedft , e.g. assuming the magnetic density negligible , we have shown how other qedfts ( that reformulate the corresponding approximate hamiltonians ) can be derived .",
    "depending on the level of approximation , the basic internal functional variables change , e.g. if we confine the electromagntic field with a cavity , the ( allowed ) mode expectation values become the new internal variable of the photons . in a final step we restricted to a two - site model coupled to only one mode , recovering the model qedft of the beginning .",
    "we point out , that at every level of qedft we recover the corresponding ( standard ) time - dependent density - functional reformulations @xcite if we assume the quantized nature of the photons negligible , i.e. the charged particles interact via the classical coulomb interaction only . this will be the case in most standard situation of condensed matter theory , e.g. when investigating dynamics of atoms or molecules in free space .",
    "however , we expect that interesting effects happen when the boundary conditions for the maxwell field are changed , e.g. for atoms in a cavity .",
    "thus we have a potential tool that can treat complex electronic systems in the setting of quantum optics .",
    "also , we can investigate the explicit interplay of photons with molecules or nanostructures , e.g. in nano - plasmonics .",
    "however , for this theory to be practical we are in need of reliable approximations to the basic functionals . in @xcite functionals based on an optimized effective potential approach @xcite",
    "are constructed , which provide good results even in the situation of strongly - coupled systems .",
    "although the currently available approximations have only been tested for simple model systems , the hierarchy of qedft approximations allows to simply scale up these functionals to more complex situations .",
    "thus we can develop approximations for simple systems , e.g. only one mode couples to the matter system , and then extend these approximations to more involved problems , e.g. considering more modes . in this way we can easily control the validity of our approximations . in this respect , we are also working on a fixed - point approach in the spirit of @xcite , which allows us to construct the exact kohn - sham potentials and compare the approximate potentials to the ( numerically ) exact expressions .",
    "details of this approach will be part of a forthcoming publication @xcite .",
    "on the other hand , the fixed - point approach is also a way to extend the validity of qedft beyond taylor - expandable fields .",
    "a different way , especially for discretized matter systems , is the non - linear schrdinger equation approach introduced in @xcite .",
    "certain theoretical and mathematical details of the model qedft of sec .",
    "[ sec : model ] , that are beyond the scope of the current manuscript , will be discussed in @xcite .",
    "finally , since we are aiming at investigating quantum optical settings , we also need to discuss the cavity and the problem of open quantum systems . in this work we focused on closed systems and on a perfect ( cubic ) cavity .",
    "it is straightforward ( but tedious ) to extend the current work to an arbitrary shape of the perfect cavity .",
    "we have to use an expansion of the photon field in the according eigenfunctions of the cavity , such that these modes obey the coulomb - gauge condition .",
    "however , in actual quantum optical experiments , the cavities are not perfect but rather an open quantum system , which allows for an exchange with the environment . to take care of this channel of decoherence there are several possible ways .",
    "one can employ the current formulation of qedft and derive a master equation , as has also been done for standard tddft @xcite . also extensions to stochastic equations @xcite are possible . on the other hand",
    ", one can couple further bosonic degrees of freedom to the system and prescribe a bath spectral density , making these degrees of freedom a bath for the system @xcite .",
    "since the present framework allows for a consistent treatment of interacting fermionic and bosonic particles , the inclusion of a bath and coupling to other fields , e.g. phonons , will be the subject of future work .",
    "mr acknowledges useful discussions with c.  genes and h.  ritsch and financial support by the austrian science fonds ( fwf projects j 3016-n16 and p 25739-n27 ) .",
    "we further acknowledge financial support from the european research council advanced grant dynamo ( erc-2010-adg-267374 ) , spanish grant ( fis2010 - 21282-c02 - 01 ) , grupos consolidados upv / ehu del gobierno vasco ( it578 - 13 ) , ikerbasque and the european commission projects cronos ( grant number 280879 - 2 cronos cp - fp7 ) .",
    "in this work we employ the standard covariant notation @xmath362 with greek letters indicating four vectors , e.g. @xmath12 , and roman letters indicating spatial vectors , i.e. @xmath363 . to lower ( or raise ) the indices , i.e. going from contravariant vectors to covariant vectors ( or vice versa ) , we adopt the convention @xmath364 for the minkwoski metric .",
    "we denote spatial ( contravariant ) vectors with the vector - symbol , i.e. @xmath365 , and the derivatives with respect to the space - time vectors @xmath366 by @xmath367 . with these definitions",
    "the divergence can be written as @xmath368 , where we also adopt the einstein summation convention .",
    "further we note that @xmath369 . with the help of the levi - civita symbol @xmath370 we can write the curl as @xmath371 and the multiplication of pauli matrices becomes @xmath372 ) = -g^{kl}-\\imagi \\epsilon^{klm } \\sigma_{m}$ ] .",
    "further , for notational simplicity we only point out in the text ( when necessary ) , whether we are in the schrdinger or heisenberg picture , and do not explicitly indicate the picture used in the operators . in the schrdinger picture , operators which are not explicitly time - dependent only carry a purely spatial dependence , e.g. @xmath373 .",
    "we indicate explicit time - dependence in the schrdinger picture by either carring the full space - time dependence , e.g. @xmath374 ( for the pauli - fierz current density ) of eq .",
    "( [ nonrelcurrent ] ) , or by a dependence on @xmath6 , e.g. @xmath375 in eq .",
    "( [ nonrelham ] ) . in the heisenberg picture",
    ", every operator also depends on time , e.g. @xmath376 in eq .",
    "( [ quantizeddirac ] ) .",
    "in this appendix we give a detailed derivation of qed in coulomb gauge .",
    "we start from the ( classical ) coupled qed lagrangian with external fields @xmath377 and @xmath378 given by @xcite @xmath379 here we use the standard definitions for the ( classical ) dirac fields , i.e. @xmath380 where @xmath381 is a dirac four - spinor with the two - component ( spin ) functions @xmath382 and @xmath383 , the gamma matrices are given by @xmath384 with @xmath385 the usual pauli matrices , @xmath386 and @xmath387 is the conserved ( noether ) current .",
    "further we use the minkowski metric @xmath388 to raise and lower the indices .",
    "for the ( classical ) maxwell field we have @xmath389 where @xmath390 is the electric field tensor and @xmath391 is the vector potential .",
    "now we employ the coulomb gauge condition for the maxwell field , i.e. @xmath392 . then it holds that @xmath393 where @xmath394 is the laplacian . if we impose square - integrability on all of @xmath395 the green s function of the laplacian becomes @xmath396 and therefore @xmath397 since the zero component of the four potential @xmath391 is given in terms of the full current , it is not subject to quantization .",
    "the conjugate momenta of the photon field ( that need to be quantized ) are the same as in the current - free theory and thus the usual canonical quantization - procedure applies @xcite , i.e. @xmath398 = -\\imagi \\hbar c \\delta_{kl}^{\\perp}(\\vec{r } -\\vec{r}'),\\end{aligned}\\ ] ] where @xmath399 is the electric field operator , @xmath400 is the transverse delta - function and @xmath401 are spatial coordinates only .",
    "equivalently we can define these operators by their respective plane - wave expansions @xmath402 , \\\\   & \\hat{\\vec{e}}(\\vec{r } ) \\!\\!=\\!\\ ! \\sqrt{\\frac{\\hbar}{\\epsilon_0}}\\!\\ ! \\int \\!\\ ! \\frac{\\diff^3",
    ", \\imagi \\omega_{k}}{\\sqrt{2 \\omega_k ( 2 \\pi)^3 } } \\!\\!\\sum_{\\lambda=1}^2 \\!\\ ! \\vec{\\epsilon}(\\vec{k } , \\lambda ) \\!\\ !",
    "} e^{\\imagi \\vec{k}\\cdot \\vec{r } } \\!-\\ !",
    "e^{- \\imagi \\vec{k}\\cdot \\vec{r } }   \\right],\\end{aligned}\\ ] ] where @xmath403 , @xmath404 is the transverse - polarization vector @xcite , and the annihilation and creation operators obey @xmath405 = \\delta^3 ( \\vec{k}-\\vec{k } ' ) \\delta_{\\lambda \\lambda'}.\\end{aligned}\\ ] ] if we further define the magnetic field operator by @xmath406 , the hamiltonian corresponding to @xmath407 is given in eq .",
    "( [ maxwellham ] ) .",
    "we used normal ordering to get rid of the infinite zero - point energy in this expression . also for the dirac field",
    ", the coupling does not change the conjugate momenta .",
    "therefore we can perform the usual canonical quantization procedure for fermions which leads to the ( equal - time ) anti - commutation relations @xcite @xmath408 the hamiltonian corresponding to @xmath409 thus becomes the one of eq .",
    "( [ diracham ] ) , where we used @xmath410 .",
    "it is straightforward to give the missing terms of the qed hamiltonian due to the coupling to the external fields as well as due to the coupling between the quantized fields .",
    "if we apply the definition of the quantized current @xmath411 of eq .",
    "( [ 4current ] ) to eq .",
    "( [ a0 ] ) we find ( using normal ordering , i.e. rearranging the annihilation parts of the operators to the right , to discard the corresponding zero - point energy ) @xmath412 here , if we disregard the purely multiplicative first term on the right - hand side , we arrive at eq .",
    "( [ coulombham ] ) .",
    "the rest is given in eqs .",
    "( [ externalham ] ) and ( [ interactionham ] ) . alternatively , with the definition of @xmath413 in eq .",
    "( [ a0 ] ) and @xmath414 the full qed hamiltonian can also be written as @xmath415",
    "to find the non - relativistic limit of eq .",
    "( [ heisenbergcurrent ] ) , we can not straightaway apply the decoupling to eq .",
    "( [ decoupling ] ) . since we have to apply the decoupling consistently to the hamiltonian as well as the current we need to rewrite the equation of motion .",
    "we start ( in the heisenberg picture ) by @xmath416 = \\frac{2 e mc ^2}{\\hbar } \\left [ \\c^{\\dagger } \\sigma^k \\p - \\p^{\\dagger } \\sigma^k \\c \\right ] \\\\ & - \\imagi e c \\left [ \\p^{\\dagger } \\left ( \\sigma^{k}\\sigma^{l}\\partial_l + \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\partial}_{l } \\sigma^{l } \\sigma^{k }   \\right)\\p + \\c^{\\dagger } \\left ( \\sigma^{k}\\sigma^{l}\\partial_l + \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\partial}_{l } \\sigma^{l } \\sigma^{k }   \\right)\\c   \\right ] \\nonumber \\\\ & - \\frac{2 \\imagi e^2}{\\hbar } \\epsilon^{klj } \\a_{l}^{\\mathrm{tot } } \\left[\\p^{\\dagger } \\sigma_j \\p + \\c^{\\dagger}\\sigma_{j } \\c   \\right ] .",
    "\\nonumber\\end{aligned}\\ ] ] this leads with @xmath417 and @xmath418 to @xmath419 \\right . \\\\ & \\left . - \\imagi e \\hbar c \\c^{\\dagger } \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\partial}_{l } \\sigma^{l } \\sigma^{k } \\c   - \\imagi e \\hbar c \\p^{\\dagger } \\sigma^{k } \\sigma^{l } \\partial_{l }   \\p \\right\\}. \\nonumber\\end{aligned}\\ ] ] adding and subtracting on the right hand side the term @xmath420 and employing eq .",
    "( [ chicomponent ] ) we find @xmath421 \\sigma^{k } \\c \\nonumber \\\\ & \\left .",
    "+ c \\p^{\\dagger } \\sigma^{k } \\imagi \\hbar c",
    "\\partial_0 \\c \\right\\}. \\end{aligned}\\ ] ] with the help of the definition @xmath422 = [ \\hat{d } + mc^2]^{-1}$ ] this can be rewritten as    @xmath423^{\\dagger } \\left(\\imagi \\hbar c \\overset{\\smash{\\raisebox{-1.5pt}{\\tiny$\\leftarrow$}}}{\\nabla } -e \\hat{\\vec{a}}^{\\mathrm{tot}}\\right)\\cdot \\vec{\\sigma } - \\p^{\\dagger } e a_0^{\\mathrm{tot } } - \\p^{\\dagger }   e^2 \\ ! \\!\\ ! \\int \\ ! \\ !",
    "\\diff^3 r ' \\frac{:\\!\\p^{\\dagger}(x')\\p(x ' ) \\ ! + \\ ! \\c^{\\dagger}(x')\\c(x')\\!:}{4 \\pi \\epsilon_0 |\\vec{r}-\\vec{r}'| } - mc^2 \\p^{\\dagger}\\right ] \\right .",
    "\\nonumber \\\\ & \\sigma^{k } [ ... ] \\vec{\\sigma } \\cdot \\left(- \\imagi \\hbar c \\vec{\\nabla } - e \\hat{\\vec{a}}^{\\mathrm{tot } }   \\right ) \\p + \\p^{\\dagger } \\sigma^{k}\\left[\\imagi \\hbar c \\partial_0 [ ... ] \\vec{\\sigma } \\cdot \\left(- \\imagi \\hbar c \\vec{\\nabla } - e \\hat{\\vec{a}}^{\\mathrm{tot } }   \\right ) \\right ] \\p + \\p^{\\dagger } \\sigma^{k } [ ... ] \\vec{\\sigma } \\cdot \\left(- \\imagi \\hbar c \\vec{\\nabla } - e \\hat{\\vec{a}}^{\\mathrm{tot } }   \\right ) \\nonumber \\\\ & \\left . \\left",
    "[   \\vec{\\sigma } \\cdot \\left(- \\imagi \\hbar c \\vec{\\nabla } - e \\hat{\\vec{a}}^{\\mathrm{tot } }   \\right ) [ ... ] \\vec{\\sigma } \\cdot \\left(- \\imagi \\hbar c \\vec{\\nabla } - e \\hat{\\vec{a}}^{\\mathrm{tot } }   \\right ) + e a_0^{\\mathrm{tot } } -   e^2 \\ ! \\!\\",
    "! \\int \\ ! \\ !",
    "\\diff^3 r ' \\frac{:\\!\\p^{\\dagger}(x')\\p(x ' ) \\ ! + \\ ! \\c^{\\dagger}(x')\\c(x')\\!:}{4",
    "\\pi \\epsilon_0 |\\vec{r}-\\vec{r}'| } - mc^2 \\right ] \\p \\right\\ } \\nonumber\\end{aligned}\\ ] ]    now , if we employ the approximation @xmath422\\approx 1/2 mc^2 $ ] ( also in the coulomb terms ) we end up with @xmath424 which is just the equation of motion for the non - relativistic current ( [ nonrelcurrent ] ) with the pauli - fierz hamiltonian .    for the maxwell field the non - relativistic limit of eq .",
    "( [ intpotential ] ) is with the help of eq .",
    "( [ nonrelcurrent ] ) straightforward .",
    "it is only important to see , that this does agree with the equation of motion for @xmath425 due to the pauli - fierz hamiltonian ( [ nonrelham ] ) .",
    "the main difference to the fully relativistic derivation is , that now we have a term of the form @xmath426 this term does not change anything in the first order equation , i.e. @xmath427 . in the second order we find due to eq .",
    "( [ perpdelta ] ) that @xmath428 \\j_{0}(x ' ) \\\\ & = 2 \\frac{\\imagi \\hbar c}{\\epsilon_0 } \\a^{l}(x ) \\j_{0}(x ) - 2 \\frac{\\imagi \\hbar c}{\\epsilon_0 } \\partial^k \\delta^{-1}\\partial^l \\a_l(x ) \\j_{0}(x ) \\nonumber\\end{aligned}\\ ] ] and @xmath429 a_{l}^{{{\\rm ext}}}(x')\\j_{0}(x ' ) \\\\ & = 2 \\frac{\\imagi \\hbar c}{\\epsilon_0 } a^{l}_{{{\\rm ext}}}(x ) \\j_{0}(x ) - 2 \\frac{\\imagi \\hbar c}{\\epsilon_0 }   \\partial^k   \\delta^{-1 } \\partial^l a_l^{{{\\rm ext}}}(x ) \\j_{0}(x ) \\nonumber\\end{aligned}\\ ] ] now , with the above definition for @xmath430 used in eq .",
    "( [ a0 ] ) we find that these commutators lead to the terms @xmath431 of the equation of motion for the maxwell field in the non - relativistic limit .",
    "the rest of the derivation is similar to the relativistic situation .",
    "if we restrict the allowed space for the photonic modes we also need to impose according boundary conditions .",
    "let us first start with a cubic cavity of length @xmath33 with periodic boundary condition .",
    "we then find with the allowed wave vectors @xmath432 and the corresponding dimensionless creation and annihilation operators @xmath332 and @xmath333 , which are connected to their continuous counterparts by @xmath433 that @xmath434.\\end{aligned}\\ ] ] here @xmath435 .",
    "if we change the conditions at the boundaries to zero - boundary conditions , then the allowed wave - vectors change to @xmath436 and the discrete operators obey @xmath437 with the normalized mode functions @xmath438 the field operator therefore reads as @xmath439 \\mathcal{s}(\\vec{n}\\cdot \\vec{r}).\\end{aligned}\\ ] ] here @xmath440 .",
    "we start with the non - relativistic hamiltonian of eq .",
    "( [ nonrelham ] ) where we assume that the magnetization density @xmath441 is negligible .",
    "we further assume a perfect cubic cavity of length @xmath33 and employ the dipole approximation , i.e. @xmath442 . thus we find a maxwell field defined by eq .",
    "( [ dipolepotential ] ) . at this level of approximation",
    "our starting point coincides with that adopted in @xcite .    in a next step",
    "we allow only scalar external potentials . in the following",
    "we present a detailed derivation of the length - gauge hamiltonian employed in @xcite for the formulation of the electron - photon tddft . for simplicity",
    "we restrict our derivations to the case of one mode and one particle .",
    "the case of several modes and particles works analogously and leads to the hamiltonian ( 13 ) of ref .",
    "@xcite .    with the definition of the dimensionless photon",
    "coordinate @xmath443 and the conjugate momentum @xmath444 , the single - mode vector potential is given by @xmath445 where we use the definition @xmath446 and assume @xmath447 .",
    "the resulting hamiltonian in first quantized notation reads @xmath448 since at this level of approximation @xmath449 due to the expansion in coulomb - gauged eigenmodes . in eq .",
    "( [ startingham ] ) we introduced the notation @xmath450 in a next step we transform the hamiltonian into its length - gauge form @xcite by the unitary transformation @xmath451.\\end{aligned}\\ ] ] if we then perform a canonical variable transformation of the photon - coordinate @xmath452 and @xmath453 ( leaving the commutation relations unchanged ) we find @xmath454    then we perform yet another time - dependent gauge transformation @xmath455\\end{aligned}\\ ] ] where @xmath456 is the projection of the external current on the direction of the photon polarization .",
    "the above transformation is aimed at eliminating the linear in @xmath457-derivative term in eq .",
    "( [ first_stepham ] ) . using the general transformation rule",
    "@xmath458 we obtain @xmath459 here we see , that the photonic variable @xmath457 is coupled to the dipole moment @xmath460 , which indicates that @xmath457 is actually proportional to the electric field .    in a last step",
    "we then discretize the matter - part of the problem and employ a two - site approximation such that @xmath461 where @xmath21 is the kinetic ( hopping ) energy , @xmath462 is the vector connecting two sites , and @xmath463 corresponds to the potential difference between the sites . to highlight the general structure of the photon - matter hamiltonian ( and bring it to the form used in sec .",
    "[ sec : model ] ) we also redefine the external current , the external potential , and the photon field as follows @xmath464 after implementing the above redefinitions in eq .",
    "( [ 2nd_stepham ] ) and neglecting irrelevant constant terms we arrive at the following hamiltonian @xmath465 with the choice of an appropriate dimensionless coupling constant @xmath30 eq .",
    "( [ final2site - ham ] ) reduces to the simple model hamiltonian of eq .",
    "( [ hubbard ] ) .",
    "we note , that the same model hamiltonian could have been derived by assuming an external vector potential in a gauge such that @xmath266 and @xmath466 . then by the dipole approximation",
    "the corresponding hamiltonian to eq .",
    "( [ startingham ] ) we would have terms of the form @xmath467 , @xmath468 and mixed terms of internal and external vector potential . by going into length gauge also for the external potential and performing the same steps as above , one ends up with the same two - site one - mode hamiltonian .",
    "here we give an overview of the different qedfts that we have discussed explicitly .",
    "we employ for the kohn - sham scheme an uncoupled auxiliary quantum system with an initial state @xmath261 . for the different levels of approximation the prerequisites for this initial state change ,",
    "i.e. we might have different initial conditions that have to be fulfilled .",
    "further we use the notational convention that the super - index s refers to the ( uncoupled ) kohn - sham quantity , e.g. @xmath469 = p_{0}^{\\mathrm{s}}$ ] .",
    "we point out , that due to the change of the physical current @xmath220 through out the hierachy of qedfts also the inhomogeneity in the according maxwell equations change .",
    "this inhomogeneity describes how the photons are coupled to the charged quantum particles , which effectively also leads to a coupling between the photons .",
    "this can be most easily seen in the non - relativistic limit , where the inhomogeneity contains terms like @xmath470 . since the current of the auxiliary kohn - sham system is by construction equal to the exact current ( at least for the non - relativistic limit ) , this coupling between the photons is also present in the kohn - sham maxwell equation .",
    "the term @xmath471 of the kohn - sham current contains these non - trivial couplings as functionals of the initial states and internal pair . when restricting the photons to a cavity ,",
    "the kohn - sham current is then responsible to couple the different photon modes .",
    "the coupling terms in the kohn - sham current are specifically relevant in the context of , e.g. nano - plasmonics , where the electromagnetic fields are enhanced due to the presence of the plasmons , or in the optical control of currents in solids @xcite ."
  ],
  "abstract_text": [
    "<S> in this work we give a comprehensive derivation of an exact and numerically feasible method to perform ab - initio calculations of quantum particles interacting with a quantized electromagnetic field . </S>",
    "<S> we present a hierachy of density - functional - type theories that describe the interaction of charged particles with photons and introduce the appropriate kohn - sham schemes . </S>",
    "<S> we show how the evolution of a system described by quantum electrodynamics in coulomb gauge is uniquely determined by its initial state and two reduced quantities . </S>",
    "<S> these two fundamental observables , the polarization of the dirac field and the vector potential of the photon field , can be calculated by solving two coupled , non - linear evolution equations without the need to explicitly determine the ( numerically infeasible ) many - body wave function of the coupled quantum system . to find reliable approximations to the implicit functionals we present the according kohn - sham construction . in the non - relativistic limit this density - functional - type theory of quantum electrodynamics </S>",
    "<S> reduces to the density - functional reformulation of the pauli - fierz hamiltonian , which is based on the current density of the electrons and the vector potential of the photon field . by making further approximations , e.g. restricting the allowed modes of the photon field , we derive further density - functional - type theories of coupled matter - photon systems for the corresponding approximate hamiltonians . in the limit of only two sites and one mode we deduce the according effective theory for the two - site hubbard model coupled to one photonic mode </S>",
    "<S> this model system is used to illustrate the basic ideas of a density - functional reformulation in great detail and we present the exact kohn - sham potentials for our coupled matter - photon model system . </S>"
  ]
}