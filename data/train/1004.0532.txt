{
  "article_text": [
    "we work in the smooth category .",
    "all manifolds and maps are assumed to be smooth unless stated otherwise , where smooth means @xmath6 .",
    "goldman @xcite and turaev @xcite constructed a lie bialgebra structure on the free @xmath7-module generated by nontrivial free homotopy classes of loops on a surface @xmath8 .",
    "turaev @xcite conjectured that his cobracket @xmath1 is zero if and only if the class @xmath2 is a power of a simple class , where we say a free homotopy class is simple if it contains a simple representative .",
    "chas @xcite constructed examples showing that , unfortunately , turaev s conjecture is false on every surface of positive genus with boundary . in this paper , we show that turaev s conjecture is almost true .",
    "we define an operation @xmath3 in the spirit of the andersen - mattes - reshetikhin algebra of chord diagrams , and show that turaev s conjecture holds on all surfaces when one replaces @xmath4 with @xmath3 .     with coefficients @xmath9 and @xmath10.,width=384 ]",
    "turaev s cobracket @xmath1 is a sum over the self - intersection points @xmath11 of a loop @xmath12 in a free homotopy class @xmath2 .",
    "each term of the sum is a simple tensor of free homotopy classes loops , which are obtained by smoothing @xmath12 at the self - intersection point @xmath11 along its orientation .",
    "each simple tensor is equipped with a sign coming from the intersection at @xmath11 ( see figure [ newintrocobracket.fig ] ) .",
    "turaev s conjecture is false because it is not uncommon for the same simple tensor of loops to appear twice in the sum @xmath1 , but with different signs .     with coefficients",
    "@xmath9 and @xmath10.,width=384 ]    we define the operation @xmath5 as a sum over the self - intersection points @xmath11 of a loop @xmath12 in @xmath2 , as in the definition of the turaev cobracket . rather than smoothing at each self - intersection point to obtain a simple tensor of two loops , we glue those loops together to create a wedge of two circles mapped to the surface .",
    "this can also be viewed as a chord diagram with one chord . as a result ,",
    "terms of @xmath3 are less likely to cancel than terms of @xmath4 , and hence @xmath5 is less likely to be zero . in fact , turaev s conjecture holds when formulated for @xmath3 rather than @xmath4 :    [ main2 ] let @xmath8 be an oriented surface with or without boundary , which may or may not be compact .",
    "let @xmath2 be a free homotopy class on @xmath8 .",
    "then @xmath13 if and only if @xmath2 is a power of a simple class .",
    "there is a simple relationship between @xmath4 and @xmath3 ; namely , if one smoothes each term of @xmath3 at the gluing point , and tensors the resulting loops , one obtains a term of @xmath4 ( see figure [ factors1.fig ] ) .",
    "[ factors1.fig ]    hence the turaev cobracket factors through @xmath3 , and we can view @xmath3 as a generalization of @xmath4 .",
    "the relationship between @xmath3 and @xmath4 is analogous to the relationship between the andersen - mattes - reshetikhin poisson bracket for chord diagrams and the goldman lie bracket .",
    "it is natural to wonder to what extent we can view @xmath3 as a cobracket for the andersen - mattes - reshetikhin algebra . while @xmath3 is not a cobracket , in the final section of the paper",
    ", we show that @xmath3 satisfies identities similar to coskew symmetry and the co - jacobi identity .",
    "+   + the operation @xmath3 also gives an explicit formula for the minimum number of self - intersection points of a generic loop in a given free homotopy class @xmath2 .",
    "we call this number the _ minimal self - intersection number of @xmath2 _ and denote it by @xmath14",
    ". both turaev s cobracket and the operation @xmath3 give lower bounds on the minimal self - intersection number of a given homotopy class @xmath2 .",
    "we call a free homotopy class _ primitive _ if it is not a power of another class in @xmath15 .",
    "any class @xmath2 can be written as @xmath16 for some primitive class @xmath17 and @xmath18 .",
    "it follows easily from the definitions of @xmath4 and @xmath3 that @xmath14 is greater than or equal to @xmath19 plus half the number of terms in the ( reduced ) linear combinations @xmath1 or @xmath5 .",
    "more formally , the number of terms @xmath20 of a reduced linear combination @xmath21 of simple tensors of classes of loops , or of classes chord diagrams , is the sum of the absolute values of the coefficients of the classes .",
    "chas counterexamples to turaev s conjecture show that the lower bound given by @xmath1 can not , in general , be used to compute the minimal self - intersection number of @xmath2 .",
    "however the lower bound given by @xmath5 is always equal to @xmath14 :    [ nonprimthm ] let @xmath8 be an oriented surface with or without boundary , which may or may not be compact .",
    "let @xmath2 be a nontrivial free homotopy class on @xmath8 such that @xmath22 , where @xmath17 is primitive and @xmath18 .",
    "then the minimal self - intersection number of @xmath2 is equal to @xmath23 plus the half number of terms of @xmath5 .    in order to prove the case of theorem [ nonprimthm ] where @xmath24 , we make use of the results of hass and scott @xcite who describe geometric properties of curves with minimal self - intersection ( see also @xcite ) .",
    "we briefly summarize some results related to turaev s conjecture and to computing the minimal self - intersection number .",
    "le donne @xcite proved that turaev s conjecture is true for genus zero surfaces . for surfaces of positive genus",
    ", one might wonder to what extent turaev s conjecture is false .",
    "chas and krongold @xcite approach this question by showing that , on surfaces with boundary , if @xmath25 and @xmath2 is at least a third power of a primitive class @xmath17 , then @xmath17 is simple . +   + a nice history of the problem of determining when a homotopy class is represented by a simple loop is given in rivin @xcite .",
    "birman and series @xcite give an explicit algorithm for detecting simple classes on surfaces with boundary .",
    "cohen and lustig @xcite extend the work of birman and series to obtain an algorithm for computing the minimal intersection and self - intersection numbers of curves on surfaces with boundary , and lustig @xcite extends this to closed surfaces .",
    "we give an example which shows how one can algorithmically compute @xmath14 using @xmath3 on surfaces with boundary , though generally we do not emphasize algorithmic implications in this paper .",
    "+   + a different algebraic solution to the problem of computing the minimal intersection and self - intersection numbers of curves on a surface is given by turaev and viro @xcite .",
    "the advantage of @xmath3 is that it has a simple relationship to @xmath4 and pairs well with the andersen - mattes - reshetikhin poisson bracket .",
    "in fact , chernov @xcite uses the andersen - mattes - reshetikhin bracket to compute the minimum number of intersection points of loops in given free homotopy classes .",
    "we will now define the goldman - turaev lie bialgebra on the free @xmath7-module generated by the set @xmath26 of free homotopy classes of loops on @xmath8 , which we denote by @xmath27 $ ] .",
    "let @xmath28 , and let @xmath12 and @xmath29 be smooth , transverse representatives of @xmath2 and @xmath17 , respectively .",
    "we will use square brackets to denote the free homotopy class of a loop .",
    "the set of intersection points @xmath30 , or just @xmath31 when the choice of @xmath12 and @xmath29 is clear , is defined to be @xmath32 let @xmath33 denote the product of @xmath12 and @xmath29 as based loops in @xmath34 , where @xmath35 and @xmath36 .",
    "if @xmath11 is the image of more than one ordered pair in @xmath31 , then there is more than one homotopy class in @xmath34 corresponding to @xmath12 ( or to @xmath29 ) , so we choose a class as follows : let @xmath37 be the induced map on the fundamental groups .",
    "let @xmath38 $ ] be the generator of @xmath39 whose orientation agrees with the chosen orientation of @xmath40 .",
    "then the class of @xmath12 in @xmath34 is given by @xmath41 $ ] .",
    "we choose the class of @xmath29 in @xmath34 in the same way .",
    "in particular , we must specify preimages of @xmath11 under @xmath12 and @xmath29 ( i.e. a point in @xmath31 ) for the notation @xmath33 to make sense .",
    "+   + the goldman bracket @xcite is a linear map @xmath42:\\z[\\fh]\\otimes_{\\z}\\z[\\fh]\\rightarrow \\z[\\fh]$ ] , defined by @xmath43=\\sum_{(t_1,t_2)\\in \\mathcal{i } } \\sgn(p;a , b)[a\\cdot_p b],\\ ] ] where @xmath44 if the orientation given by the pair of vectors @xmath45 agrees with the orientation of @xmath8 , and @xmath46 otherwise . to check that the definition of @xmath42 $ ] is independent of the choices of @xmath12 and @xmath29",
    ", one must show that @xmath47 $ ] does not change under elementary moves for a pair of smooth curves in general position . using linearity ,",
    "the definition of @xmath42 $ ] can be extended to all of @xmath27\\otimes_{\\z}\\z[\\fh]$ ] .",
    "+   + next we define the turaev cobracket @xcite .",
    "let @xmath2 be a free homotopy class on @xmath8 , and let @xmath12 be a smooth representative of @xmath2 with transverse self - intersection points .",
    "let @xmath48 , or just @xmath49 when the choice of @xmath12 is clear , denote the set of self - intersection points of the loop @xmath12 .",
    "let @xmath50 be the diagonal in @xmath51 .",
    "elements of @xmath49 will be points in @xmath52 modulo the action of @xmath53 which interchanges the two coordinates .",
    "now we define @xmath54 let @xmath55 be a self - intersection point of @xmath12 .",
    "let @xmath56 $ ] denote the arc of @xmath40 going form @xmath57 to @xmath58 in the direction of the orientation of @xmath40 , and let @xmath59 $ ] denote the arc of @xmath40 going from @xmath58 to @xmath57 in the direction of the orientation of @xmath40 .",
    "since @xmath55 , then @xmath60)$ ] and @xmath61)$ ] are loops .",
    "we assign these loops the names @xmath62 and @xmath63 in such a way that the ordered pair of tangent vectors @xmath64 gives the chosen orientation of @xmath65 .",
    "now we let @xmath66 be the subset of @xmath49 which contains only self - intersection points @xmath11 such that the loops @xmath67 are nontrivial : @xmath68 the turaev cobracket is a linear map @xmath69\\rightarrow \\z[\\fh]\\otimes_{\\z } \\z[\\fh]$ ] which is given on a single homotopy class by @xmath70\\otimes[a^2_p]-[a^2_p]\\otimes[a^1_p].\\ ] ] one can show that the definition of @xmath4 is independent of the choice of @xmath71 by showing @xmath1 does not change under elementary moves for a smooth loop in general position . using linearity , this definition of @xmath4 can be extended to all of @xmath27 $ ] .",
    "+   + together , @xmath42 $ ] and @xmath4 equip @xmath27 $ ] with an involutive lie bialgebra structure @xcite .",
    "that is , @xmath42 $ ] and @xmath4 satisfy ( co)skew - symmetry , the ( co ) jacobi identity , a compatibility condition , and @xmath42\\circ\\delta=0 $ ] . a complete definition of a lie bialgebra is given in @xcite .",
    "we now summarize the andersen - mattes - reshetikhin algebra of chord diagrams on @xmath8 @xcite .",
    "a _ chord diagram _ is a disjoint union of oriented circles @xmath72 , called _ core circles _ , along with a collection of disjoint arcs @xmath73 , called _ chords _ , such that + 1 ) @xmath74 for @xmath75 , and + 2 ) @xmath76 . +   + a _",
    "geometrical chord diagram on @xmath8 _ is a smooth map from a chord diagram @xmath77 to @xmath8 such that each chord @xmath78 in @xmath77 is mapped to a point .",
    "a _ chord diagram on @xmath8 _ is a homotopy class of a geometrical chord diagram @xmath77 , denoted @xmath79 $ ] .",
    "+   + let @xmath80 denote the free @xmath7-module generated by the set of chord diagrams on @xmath8 ( @xcite uses coefficients in @xmath81 , but we use @xmath7 here for consistency ) .",
    "let @xmath82 be the submodule generated by a set of @xmath83-relations , one of which is shown in figure [ 4term.fig ] .",
    "the other relations can be obtained from this one as follows : one can reverse the direction of any arrow , and any time a chord intersects an arc whose orientation is reversed , the diagram is multiplied by a factor of -1 .",
    "+     +   + given two chord diagrams @xmath84 and @xmath85 on @xmath8 , we can form their disjoint union by choosing representatives ( i.e. , geometrical chord diagrams ) @xmath86 of @xmath87 , taking a disjoint union of their underlying chord diagrams , mapping the result to @xmath8 as prescribed by the @xmath86 , and taking its free homotopy class .",
    "the disjoint union of chord diagrams @xmath88 defines a commutative multiplication on @xmath80 , giving @xmath80 an algebra structure with @xmath82 as an ideal .",
    "let @xmath89 , and call this the _ algebra of chord diagrams_. +   + andersen , mattes , and reshetikhin @xcite constructed a poisson bracket on @xmath90 , which can be viewed as a generalization of the goldman bracket for chord diagrams on @xmath8 rather than free homotopy classes of loops .",
    "let @xmath84 and @xmath85 be chord diagrams on @xmath8 , and choose representatives @xmath86 of @xmath87 .",
    "we define the set of intersection points @xmath91 , or just @xmath31 when the choice of @xmath92 and @xmath93 is clear , to be @xmath94 where @xmath95 is a point in the preimage of the geometrical chord diagrams @xmath86 . for each @xmath96 with @xmath97 , let @xmath98 denote the geometrical chord diagram obtained by adding a chord between @xmath57 and @xmath58 .",
    "it is necessary to specify preimages of @xmath11 for this notation to be well - defined .",
    "since each copy of @xmath40 in the chord diagram is oriented , we can define @xmath99 as before .",
    "the andersen - mattes - reshetikhin poisson bracket @xmath100 is defined by @xmath101,\\ ] ] where square brackets denote the free homotopy class of a geometrical chord diagram .",
    "this definition of @xmath102 can be extended to all of @xmath90 using bilinearity . for a proof",
    "that @xmath102 does not depend on the choices of @xmath103 , @xmath104 , see @xcite .",
    "in particular , it is necessary to check that @xmath102 is invariant under elementary moves , including the reidemeister moves and the moves in figures [ type2movewithdot.fig ] and [ type3movewithdot.fig ] , and the @xmath83-relations .",
    "the definition of @xmath3 given in this section is the simplest for the purposes of computing the minimal self - intersection number of a free homotopy class @xmath2 . in this section ,",
    "we define @xmath3 only on free homotopy classes . in the final section of this paper ,",
    "we modify the definition of @xmath3 in a way that allows us to more easily state an analogue of the co - jacobi identity , and which allows us to extend the definition of @xmath3 to certain chord diagrams in the andersen - mattes - reshetikhin algebra .",
    "the modified definition agrees with the definition below for free homotopy classes .",
    "+   + for this defintion of @xmath3 , we will need to use chord diagrams with oriented chords .",
    "suppose @xmath105 is an oriented chord with its tail at @xmath106 and its head at @xmath107 in a geometrical chord diagram @xmath77 .",
    "we say @xmath105 _ agrees with the orientation of @xmath8 _ if the ordered pair of vectors @xmath108 gives the chosen orientation of @xmath8 .",
    "when we draw the image of a geometrical chord diagram , we label the image of a chord @xmath105 with a @xmath109 if @xmath105 agrees with the orientation of @xmath8 , and we label it with a ` @xmath110 ' otherwise .",
    "+   + let @xmath111 denote the free @xmath7-module generated by chord diagrams on @xmath8 consisting of one copy of @xmath40 , and one oriented chord connecting distinct points of that copy of @xmath40 .",
    "in addition to the usual reidemeister moves , we have two additional elementary moves for diagrams with signed chords .",
    "these moves , with one possible choice of orientation on the branches , are shown in figures [ type2movewithdotandsign.fig ] and [ type3movewithdotandsign.fig ] , where @xmath112 denotes the sign on the chord .",
    "we define a linear map @xmath113\\rightarrow e$ ] .",
    "+   +    let @xmath114 be a geometrical chord diagram on @xmath8 with one core circle .",
    "for each self - intersection point @xmath115 of @xmath77 , we let @xmath116 ( respectively @xmath117 ) be the geometrical chord diagram obtained by adding an oriented chord between @xmath57 and @xmath58 that agrees ( respectively , does not agree ) with the orientation of @xmath8 .",
    "+   + now we define @xmath3 on the class of the geometrical chord diagram @xmath77 by @xmath118)=\\sum_{(t_1,t_2)\\in \\mathcal{si}_0}[d^+_p]-[d^-_p].\\ ] ] using linearity , we can extend this definition to all of @xmath27 $ ] .",
    "it remains to check that @xmath119)$ ] is independent of the choice of representative of @xmath79 $ ] .",
    "+      we check that @xmath3 is invariant under the usual reidemeister moves :    1 .",
    "_ regular isotopy : _ invariance is clear .",
    "first reidemeister move : _ this follows from the definition of @xmath66 .",
    "_ second reidemeister move : _ this follows from the move in figure [ type2movewithdotandsign.fig ] .",
    "third reidemeister move : _ this follows from the move in figure [ type3movewithdotandsign.fig ] .",
    "we note that when checking invariance under the second and third moves , one must consider the case where some of the self - intersection points are in @xmath49 but not in @xmath66 .",
    "we would like to show that @xmath4 factors through @xmath3 . to do this",
    ", we will rewrite the definition of @xmath3 for a free homotopy class in a way that makes its relationship to @xmath4 more transparent .",
    "let @xmath122 and @xmath123\\rightarrow f$ ] be loops in @xmath8 based at @xmath11 , such that @xmath124 and @xmath125 .",
    "we define a geometrical chord diagram @xmath126 which glues the loops @xmath122 and @xmath127 at the point @xmath11 .",
    "the underlying chord diagram of @xmath126 contains one core circle @xmath128 , and one oriented chord @xmath105 with its head at @xmath129 and its tail at @xmath130 .",
    "the geometrical chord diagram @xmath126 maps the chord @xmath105 to @xmath11",
    ". then we define @xmath131}=\\phi$ ] and @xmath132}=\\psi$ ] .",
    "+   + now we are ready to rewrite the definition of @xmath3 for @xmath133 .",
    "let @xmath12 be a representative of @xmath2 , and for each @xmath134 with @xmath55 , let @xmath62 and @xmath63 be the loops we defined for the turaev cobracket .",
    "now @xmath135-[a^2_p\\bullet_p a^1_p].\\ ] ]      andersen , mattes and reshetikhin @xcite show that there is a quotient algebra of @xmath90 which corresponds to goldman s algebra .",
    "let @xmath136 be the ideal generated by the relation in figure [ i.fig ] . in the quotient @xmath137 ,",
    "each chord diagram is identified with the disjoint union of free homotopy classes obtained by smoothing the diagram at the intersections which are images of chords .",
    "one can check that @xmath138 is a poisson algebra homomorphism and @xmath137 is a poisson algebra with an underlying lie algebra that corresponds to goldman s algebra @xcite .",
    "+   + there is a similar relationship between the turaev cobracket and @xmath3 .",
    "let @xmath139 be the map which smoothes the chord diagram according to its orientation at an intersection which is an image of a chord , and tensors the two resulting homotopy classes together ( see figure [ factors.fig ] )",
    ". then @xmath140 .",
    "+   + _ remark : _",
    "turaev @xcite notes that the turaev cobracket can be obtained algebraically from an operation defined in supplement 2 of @xcite .",
    "it is possible that @xmath3 may be obtained from this operation as well .",
    "we do not know a way of obtaining turaev s operation from @xmath3 .",
    "in this section , we prove theorems [ main2 ] and [ nonprimthm ] . recall that theorem [ main2 ] states that @xmath13 if and only if @xmath2 is a power of a simple class .",
    "theorem [ nonprimthm ] gives an explicit formula for @xmath14 .",
    "we begin by describing two types of self - intersection points of a loop which is freely homotopic to a power of another loop . then we prove theorem [ mainlemma ] , which describes when certain terms of @xmath3 cancel .",
    "theorems [ main2 ] and [ nonprimthm ] are corollaries of theorem [ mainlemma ] .",
    "our goal is to understand the conditions under which different terms of @xmath5 cancel , when @xmath141 is a power of another class @xmath17 in @xmath15 . to do this",
    ", we need to distinguish between two different types of self - intersection points of a curve .",
    "suppose we choose a geodesic representative @xmath142 of @xmath2 .",
    "either all self - intersection points of @xmath142 are transverse , or @xmath142 has infinitely many self - intersection points , and in particular , @xmath142 is a power of another geodesic .",
    "let @xmath11 be a point on the image of @xmath142 which is not a transverse self - intersection point of @xmath142 .",
    "let @xmath143 be a geodesic loop such that @xmath144 in @xmath34 , and such that there is no geodesic @xmath145 such that @xmath146 ( it is possible that @xmath147 ) .",
    "now we know that @xmath143 has finitely many self - intersection points , all of which are transverse .",
    "let @xmath148 be the number of self - intersection points of @xmath143 .",
    "since @xmath8 is orientable , we can perturb @xmath142 slightly to obtain a loop @xmath149 as follows : we begin to traverse @xmath142 beginning at @xmath11 , but whenever we are about to return to @xmath11 , we shift slightly to the left . after doing this @xmath150 times",
    ", we must return to @xmath11 and connect to the starting point .",
    "this requires crossing @xmath23 strands of the loop , creating @xmath23 self - intersection points .",
    "we call these _ type 2 self - intersection points_. for self - intersection point of @xmath143 , we get @xmath151 self - intersection points of @xmath142 ( see figure [ type1type2intpts.fig ] ) .",
    "we call these @xmath152 self - intersection points _ type 1 self - intersection points_. we note that we are counting self - intersections with multiplicity , as some of the self - intersection points of @xmath143 may be images of multiple points in @xmath49 .    given a transverse self - intersection point @xmath11 of @xmath143 , we will denote the corresponding set of @xmath151 type 1 self - intersection points of @xmath149 by @xmath153 , where @xmath154 is the label on the strand corresponding first branch of @xmath143 at @xmath11 ( i.e. , a strand going from top to bottom in figure [ powerslabelled.fig ] ) , and @xmath155 is the label on the strand corresponding to the second branch of @xmath143 at @xmath11 ( i.e. , a strand going from left to right in figure [ powerslabelled.fig ] ) . this relationship between the numbers of self - intersection points of @xmath142 and @xmath143",
    "can be found in @xcite for both orientable and non - orientable surfaces .",
    "[ type1lemma ] let @xmath142 be a geodesic representative of @xmath156 , with @xmath144 , and @xmath143 and @xmath150 are as defined in the paragraph above .",
    "then the contribution to @xmath5 of a type 1 self - intersection point @xmath157 is @xmath158-[(yx)^jy\\bullet_p ( xy)^ix],\\ ] ] where @xmath159 , @xmath160 , and @xmath161 such that @xmath162 .",
    "_ we will compute the contribution to @xmath3 for a type 1 self - intersection point @xmath157 of @xmath149 , where @xmath149 is the perturbed version of @xmath142 described in the above paragraph .",
    "these terms are @xmath163 $ ] and @xmath164 $ ] . however ,",
    "when we record the terms of @xmath3 , we perturb @xmath149 back to @xmath142 , so that the terms we record are geometrical chord diagrams whose images are contained in the image of @xmath142 and whose chords are mapped to @xmath11 . to compute @xmath165 , we begin at @xmath157 along the branch corresponding to @xmath159 , and wish to know how many times we traverse branches corresponding to @xmath159 and @xmath160 before returning to @xmath157 .",
    "the first time we return to @xmath157 , we must return along the @xmath166 branch of @xmath167 . therefore @xmath168=[(xy)^ix]$ ] for some integer @xmath169 .",
    "if we begin at @xmath157 along the branch corresponding to @xmath160 , we return to @xmath157 for the first time on the @xmath170 branch of @xmath171",
    ". therefore @xmath172=[(yx)^jy]$ ] for some integer @xmath173 .",
    "but if we traverse @xmath165 followed by @xmath174 , we must traverse @xmath149 exactly once , so @xmath162 .      throughout this section",
    ", we will use the following facts , which hold for a compact surface @xmath8 with negative sectional curvature ( though compactness is not needed for @xmath175 ) .",
    "the first fact holds by preissman s theorem .",
    "the second fact is true if @xmath176 because @xmath15 is free .",
    "if @xmath8 is closed , the second fact follows from the proof of preissman s theorem @xcite .",
    "the third and fourth facts can be found in @xcite , as theorems 1.5.3 and 1.6.6 respectively .",
    "+   + we now show that for any free homotopy class @xmath2 on a compact surface , it is possible to choose a representative of @xmath2 such that no two terms coming from type 1 intersection points cancel .",
    "this proof is based on ideas in @xcite and @xcite .",
    "later we will see that if @xmath177 or the annulus @xmath178 , geodesic loop on @xmath8 has no type 1 self - intersection points , so in theorem [ mainlemma ] , we only consider surfaces of negative curvature .",
    "[ mainlemma ] let @xmath8 be a compact surface equipped with a metric of negative curvature .",
    "let @xmath133 .",
    "if @xmath142 is a geodesic representative of @xmath2 , then no two terms of @xmath5 corresponding to type 1 intersection points of @xmath142 cancel .    _ proof .",
    "_ throughout this proof , @xmath179 $ ] denotes a free homotopy class ( either of a geometrical chord diagram or a loop ) , @xmath179_p$ ] denotes a homotopy class in @xmath34 , and @xmath179^p_q$ ] denotes the homotopy class of a path from @xmath11 to @xmath180 with fixed endpoints .",
    "when we concatenate two paths @xmath181 and @xmath182 , we write @xmath183 , where the path written on the left is the path we traverse first . +   + we write @xmath144 for some geodesic loop @xmath143 and some @xmath18 , where @xmath143 is not a power of another loop .",
    "suppose @xmath143 has @xmath148 self - intersection points , and let @xmath149 be a perturbation of @xmath142 with @xmath152 type 1 self - intersection points and @xmath23 type 2 self - intersection points .",
    "let @xmath184 and @xmath185 be the sets of @xmath151 self - intersection points corresponding to the ( transverse ) self - intersection points @xmath11 and @xmath180 of @xmath143 respectively , with the indexing as defined in the previous section .",
    "we assume @xmath186 $ ] is nontrivial , since the theorem clearly holds when @xmath186 $ ] is trivial ( @xmath66 is in fact empty ) .",
    "+   + we wish to show that the terms of @xmath3 corresponding to points @xmath157 and @xmath187 can not cancel . we suppose these terms cancel , and derive a contradiction .",
    "+   + first , we consider the case where @xmath188 for @xmath189 , but @xmath190 and @xmath191 may or may not be equal , and @xmath192 and @xmath193 may or may not be equal . in other words ,",
    "@xmath157 and @xmath194 come from the same set of @xmath151 type 1 self - intersection points .",
    "let @xmath159 and let @xmath160 .",
    "if either @xmath195 or @xmath196 , then by lemma [ type1lemma ] , the terms corresponding to @xmath157 and @xmath197 are @xmath158-[(yx)^jy\\bullet_p ( xy)^ix ] , \\text { and}\\ ] ] @xmath198-[(yx)^ly\\bullet_p ( xy)^kx],\\ ] ] for integers @xmath199 such that @xmath200 . if @xmath201 and @xmath202 , then @xmath203 corresponds to a single element of @xmath66 , so we have just the first two of the above terms . in either case",
    ", it suffices to assume that the terms @xmath204 $ ] and @xmath205 $ ] cancel , where @xmath136 and @xmath206 may or may not be equal , and @xmath207 and @xmath21 may or may not be equal .",
    "+   + suppose that @xmath208=[(yx)^l y \\bullet_p ( xy)^k x].\\ ] ] then there exists @xmath209 such that @xmath210_p \\gamma^{-1}=[(yx)^l y]_p\\ ] ] and @xmath211_p \\gamma^{-1}=[(xy)^k x]_p.\\ ] ] we multiply equations [ powerssamept1 ] and [ powerssamept2 ] in both possible orders to obtain the equations @xmath212_p[(yx)^j y]_p \\gamma^{-1}=[(yx)^l",
    "y]_p[(xy)^k x]_p\\ ] ] and @xmath213_p [ ( xy)^i x]_p \\gamma^{-1}=[(xy)^k x]_p[(yx)^l y]_p.\\ ] ] conjugating equation [ powerssamept12 ] by @xmath214_p\\in \\pi_1(f , p)$ ] tells us that @xmath214_p\\gamma$ ] and @xmath215_p$ ] commute , since @xmath216 .",
    "similarly , conjugating equation [ powerssamept21 ] by @xmath217_p$ ] tells us @xmath217_p\\gamma$ ] and @xmath218_p$ ] commute . therefore the subgroups @xmath219_p\\gamma , [ ( xy)^n]_p \\rangle$ ] and @xmath220_p\\gamma , [ ( yx)^n]_p\\rangle$ ] are infinite cyclic , and are generated by elements @xmath221 and @xmath222 of @xmath34 , respectively . note that these subgroups are nontrivial since @xmath143 is nontrivial .",
    "fact @xmath223 states that each nontrivial element of @xmath224 is contained in a unique , maximal infinite cyclic group .",
    "let @xmath225 and @xmath226 be the generators of the unique maximal infinite cyclic groups containing @xmath215_p$ ] and @xmath218_p$ ] respectively . since @xmath186=[xy]=[yx]$ ] is not freely homotopic to a power of another class , we have that @xmath227_p \\rangle$ ] and @xmath228_p \\rangle$ ] .",
    "but @xmath229 and @xmath230 are also infinite cyclic groups containing @xmath215_p$ ] and @xmath218_p$ ] , respectively . by the maximality of the @xmath231",
    ", we have that @xmath232 and @xmath233 .",
    "this tells us @xmath214_p\\gamma$ ] and @xmath217_p\\gamma$ ] are powers of @xmath234_p$ ] and @xmath235_p$ ] respectively , so @xmath236_p^{-1}([xy]_p)^u=[y]_p^{-1}([yx]_p)^v.\\ ] ] the powers @xmath237 and @xmath238 can be either zero , positive , or negative .",
    "once we make all possible cancellations in equation [ powerssamept2geos ] , we will have two geodesic lassos ( one on each side of the equation ) formed by products of @xmath167 , @xmath171 , or their inverses , representing the same homotopy class in @xmath34 .",
    "therefore these geodesic lassos must coincide .",
    "the geodesic on the left hand side of equation [ powerssamept2geos ] can begin by going along either @xmath239 or @xmath171 ( depending on the sign of @xmath237 ) , while the geodesic on the right hand side can begin along either @xmath240 or @xmath167 ( depending on the sign of @xmath238 ) .",
    "therefore @xmath214_p$ ] and @xmath217_p$ ] must either be powers of the same loop , which is impossible , because we assumed @xmath186 $ ] is not a power of another class , or @xmath214_p$ ] and @xmath217_p$ ] must be trivial , which is impossible because of the definition of @xmath66 .",
    "therefore the terms of @xmath3 corresponding to @xmath157 and @xmath187 can not cancel when @xmath188 .",
    "+   + now we will show that the terms of @xmath3 which correspond to @xmath157 and @xmath187 can not cancel when @xmath11 and @xmath180 correspond to different ordered pairs in @xmath66 .",
    "let @xmath159 , @xmath160 , @xmath241 , and @xmath242 .",
    "by lemma [ type1lemma ] the terms which @xmath157 and @xmath187 contribute to @xmath3 are : @xmath208-[(yx)^j y \\bullet_p ( xy)^i x]\\ ] ] and @xmath243-[(wz)^l w \\bullet_q ( zw)^k z],\\ ] ] where @xmath200 .",
    "we will suppose that @xmath244=[(wz)^l w \\bullet_q ( zw)^k z]$ ] , and derive a contradiction .",
    "switching the orders of the two loops on both sides of the equation gives us the equality @xmath245=[(zw)^k z \\bullet_q ( wz)^l w]$ ] , so if we assume that one of these equalities holds , all four terms above will cancel .",
    "+   + as in the case where @xmath246 , we will use the equality @xmath244=[(wz)^l w \\bullet_q ( zw)^k z]$ ] to find abelian subgroups of @xmath247 . to do this ,",
    "we examine the gauss diagram of @xmath143 with two oriented chords corresponding to the self - intersection points @xmath11 and @xmath180 .",
    "the four possible gauss diagrams with two oriented chords are pictured in figure [ gaussdiagrams.fig ] .",
    "we use the convention that each oriented chord points from the second branch of @xmath143 to the first branch of @xmath143 , where the branches of @xmath143 at a self - intersection point are ordered according to the orientation of @xmath8 .",
    "as shown in figure [ gaussdiagrams.fig ] , we let @xmath248 , @xmath249 , denote the arcs between the preimages of @xmath11 and @xmath180 . we let @xmath250 denote the image of the arc @xmath248 under @xmath143 . +   +",
    "we first change the basepoint of the first term from @xmath11 to @xmath180 , replacing @xmath244 $ ] by @xmath251 $ ] .",
    "assuming the terms cancel , we can find @xmath252 such that @xmath253_q\\gamma^{-1}= [ b_2^{-1}(xy)^i x b_2]_q\\ ] ] and @xmath254_q \\gamma^{-1 } = [ b_2^{-1 } ( yx)^j y b_2]_q.\\ ] ] multiplying equations [ differentpts1 ] and [ differentpts2 ] in both possible orders , and using the fact that @xmath255 , we have : @xmath256_q \\gamma^{-1}=[b_2^{-1 } ( xy)^n b_2]_q\\ ] ] and @xmath257_q \\gamma^{-1}=[b_2^{-1 } ( yx)^n b_2]_q.\\ ] ] table [ termsforgaussdiagrams ] lists the values of @xmath258 and @xmath259 in terms of the @xmath250 for each gauss diagram in figure [ gaussdiagrams.fig ] .",
    ".the values of @xmath258 and @xmath259 for each gauss diagram in figure [ gaussdiagrams.fig ] . [ cols=\"^,^,^,^,^\",options=\"header \" , ]     [ termsforgaussdiagrams ]    this allows us to rewrite equations [ differentpts12 ] and [ differentpts21 ] just in terms of @xmath260 and the @xmath250 .",
    "note that for diagrams @xmath261 and @xmath262 , we get the same two equations from [ differentpts12 ] and [ differentpts21 ] , because the values of @xmath167 and @xmath171 , and the values of @xmath263 and @xmath259 , are interchanged .",
    "therefore it suffices to consider diagrams @xmath264 , @xmath261 , and @xmath265 .",
    "the arguments for diagrams @xmath264 and @xmath261 are similar , so we will only examine @xmath264 and @xmath265 .",
    "+   + * diagram @xmath264 : * in this case , @xmath266 , @xmath267 , @xmath268 , and @xmath269 ( see table [ termsforgaussdiagrams ] ) .",
    "we express equations [ differentpts12 ] and [ differentpts21 ] in terms of the @xmath250 to obtain @xmath270_q \\gamma^{-1}=[b_2^{-1 } ( b_2b_3b_4b_1)^n b_2]_q\\ ] ] and @xmath271_q \\gamma^{-1}=[b_2^{-1 } ( b_1b_2b_3b_4)^n b_2]_q.\\ ] ] we conjugate equation [ differentpts12bi ] by @xmath272_q^{-1 } \\in \\pi_1(f , q)$ ] and equation [ differentpts21bi ] by @xmath273_q\\in \\pi_1(f , q)$ ] to obtain the equations @xmath274_q^{-1}\\gamma[(b_4b_1b_2b_3)^n]_q \\gamma^{-1 } [ b_3]_q = [ ( b_4b_1b_2b_3)^n]_q\\ ] ] and @xmath275_q \\gamma [ ( b_3b_4b_1b_2)^n]_q \\gamma^{-1 } [ b_3b_4b_2]_q^{-1}=[(b_3b_4b_1b_2)^n]_q.\\ ] ] therefore @xmath272_q^{-1}\\gamma$ ] and @xmath276_q$ ] commute , as do @xmath273_q \\gamma$ ] and @xmath277_q$ ] . since abelian subgroups of @xmath247 are infinite cyclic , the subgroups @xmath278_q^{-1}\\gamma ,   [ ( b_4b_1b_2b_3)^n]_q\\rangle$ ] and @xmath279_q \\gamma , [ ( b_3b_4b_1b_2)^n]_q\\rangle$ ] are generated by elements @xmath221 and @xmath222 in @xmath247 respectively .",
    "each nontrivial element of @xmath247 is contained in a unique , maximal infinite cyclic group by fact @xmath223 .",
    "let @xmath225 and @xmath226 be the generators of the unique maximal infinite cyclic groups containing @xmath276_q$ ] and @xmath277_q$ ] respectively . by assumption , @xmath186=[b_4b_1b_2b_3]=[b_3b_4b_1b_2]$ ]",
    "is not freely homotopic to a power of another class .",
    "therefore @xmath280_q \\rangle$ ] and @xmath281_q \\rangle$ ] . but",
    "@xmath229 and @xmath230 are also infinite cyclic groups containing @xmath276_q$ ] and @xmath277_q$ ] , respectively , so by the maximality of @xmath282 and @xmath283 , we have @xmath232 and @xmath233 . thus @xmath272_q^{-1}\\gamma=([b_4b_1b_2b_3]_q)^u$ ] and @xmath273_q\\gamma=([b_3b_4b_1b_2]_q)^v$ ] for some @xmath237 and @xmath284",
    ". now @xmath285_q=[b_2^{-1}b_4^{-1}b_3^{-1}(b_3b_4b_1b_2)^v]_q,\\ ] ] so the path homotopy classes @xmath286^p_q$ ] and @xmath287^p_q$ ] are equal .",
    "once we cancel @xmath250 with @xmath288 wherever possible , @xmath289 and @xmath290 will be two geodesic arcs from @xmath11 to @xmath180 representing the same path homotopy class .",
    "therefore @xmath181 and @xmath182 must coincide .",
    "note that some of the @xmath250 may be trivial . we know",
    "@xmath291 and @xmath292 can not be trivial because of the definition of @xmath66 . given that @xmath293 or @xmath294 may be trivial , and that @xmath237 and @xmath238 may be positive , negative , or zero , we see that @xmath181 can begin along @xmath293 , @xmath292 , or @xmath295 and @xmath182 can begin along @xmath296 , @xmath297 , or @xmath291 .",
    "thus @xmath181 and @xmath182 can only coincide if the beginnings of the arcs @xmath250 and @xmath298 , as well as the initial velocity vectors of these arcs , coincide for some @xmath75 .",
    "this is impossible since @xmath143 is a geodesic which is not homotopic to a power of another loop .",
    "+   + * diagram @xmath265 : * in this case , @xmath299 , @xmath300 , @xmath301 , and @xmath302 ; see table [ termsforgaussdiagrams ] .",
    "we rewrite equations [ differentpts12 ] and [ differentpts21 ] in terms of the @xmath250 to obtain @xmath303_q \\gamma^{-1}=[b_2^{-1 } ( b_2b_3b_4b_1)^n b_2]_q\\ ] ] and @xmath304_q \\gamma^{-1}=[b_2^{-1 } ( b_4b_1b_2b_3)^n b_2]_q.\\ ] ] we conjugate equation [ differentpts12bid ] by @xmath305_q \\in \\pi_1(f , q)$ ] and equation [ differentpts21bid ] by @xmath306_q\\in \\pi_1(f , q)$ ] to obtain the equations @xmath307_q\\gamma[(b_1b_2b_3b_4)^n]_q \\gamma^{-1 } [ b_1b_2]_q^{-1 } = [ ( b_1b_2b_3b_4)^n]_q\\ ] ] and @xmath308_q \\gamma [ ( b_3b_4b_1b_2)^n]_q \\gamma^{-1 } [ b_3b_2]_q^{-1}=[(b_3b_4b_1b_2)^n]_q.\\ ] ] therefore @xmath305_q\\gamma$ ] and @xmath309_q$ ] commute , as do @xmath306_q \\gamma$ ] and @xmath277_q$ ] .",
    "since abelian subgroups of @xmath247 are infinite cyclic , the subgroups @xmath310_q\\gamma ,   [ ( b_1b_2b_3b_4)^n]_q\\rangle$ ] and @xmath311_q \\gamma , [ ( b_3b_4b_1b_2)^n]_q\\rangle$ ] are generated by elements @xmath221 and @xmath222 in @xmath247 respectively .",
    "each nontrivial element of @xmath247 is contained in a unique , maximal infinite cyclic group by fact @xmath223 .",
    "let @xmath225 and @xmath226 be the generators of the unique , maximal infinite cyclic groups containing @xmath309_q$ ] and @xmath277_q$ ] , respectively . since @xmath186=[b_1b_2b_3b_4]=[b_3b_4b_1b_2]$ ] is not freely homotopic to a power of another class , we have @xmath312_q \\rangle$ ] and @xmath313_q \\rangle$ ] . but @xmath229 and @xmath230 are also infinite cyclic groups containing @xmath309_q$ ] and @xmath277_q$ ] , respectively . thus by the maximality of the @xmath231 , we have @xmath232 and @xmath233 . hence @xmath305_q\\gamma=([b_1b_2b_3b_4]_q)^u$ ] and @xmath306_q\\gamma=([b_3b_4b_1b_2]_q)^v$ ] for some @xmath237 and @xmath284",
    ". now @xmath314_q=[b_2^{-1}b_3^{-1}(b_3b_4b_1b_2)^v]_q,\\ ] ] so the path homotopy classes @xmath315^p_q$ ] and @xmath316^p_q$ ] are equal .",
    "once we cancel @xmath250 with @xmath288 wherever possible , @xmath317 and @xmath318 will be two geodesic arcs from @xmath11 to @xmath180 representing the same path homotopy class .",
    "therefore @xmath181 and @xmath182 must coincide .",
    "again , some of the @xmath250 may be trivial .",
    "because of the definition of @xmath66 , adjacent arcs ( e.g. @xmath293 and @xmath292 or @xmath294 and @xmath291 ) can not both be trivial . if arcs opposite each other ( e.g. @xmath293 and @xmath294 ) are both trivial , then @xmath246 ; that case was already examined .",
    "so we may assume at most one of the @xmath250 is trivial .",
    "depending on whether @xmath237 is positive , negative , or zero , and on which @xmath250 is trivial , @xmath181 can begin along either @xmath295 , @xmath293 , @xmath296 , @xmath292 , or @xmath181 can be trivial ( if @xmath319 and @xmath291 is trivial ) .",
    "similarly , @xmath182 can begin along @xmath294 , @xmath291 , @xmath297 , or @xmath320 , or @xmath182 can be trivial ( if @xmath321 and @xmath292 is trivial ) .",
    "therefore , in order for the @xmath322 to coincide , either the beginnings and initial velocity vectors of the arcs @xmath250 and @xmath298 must coincide for some @xmath75 , which is impossible since @xmath143 is a geodesic and is not a power of another loop , or both @xmath322 must be trivial .",
    "but if both @xmath322 are trivial , then @xmath291 and @xmath292 are both trivial , and we assumed at most one of the @xmath250 are trivial , so this is impossible as well .",
    "+   + the following lemma allows us to reduce the proofs of theorems [ main2 ] and [ nonprimthm ] to the case where @xmath8 is compact .",
    "[ compact ] suppose @xmath8 is noncompact , and let @xmath323 .",
    "suppose @xmath324))=t$ ] , where @xmath325\\in\\fh(f)$ ] .",
    "then there exists a compact subsurface @xmath326 of @xmath8 containing @xmath327 such that @xmath324_c))=t$ ] , where @xmath325_c$ ] is the class of @xmath142 in @xmath328 .    _ proof . _ first note that we may assume @xmath142 has finitely many transverse self - intersection points ( if it did not , we could perturb @xmath142 slightly to obtain a loop that does ) .",
    "suppose that the pair of terms @xmath329 $ ] and @xmath330 $ ] of @xmath331)$ ] cancel .",
    "let @xmath77 be a chord diagram with one oriented chord attached to one copy of @xmath40 at its endpoints .",
    "let @xmath332 and @xmath333 be the geometrical chord diagrams associated with @xmath334 $ ] and @xmath335 $ ] respectively . since @xmath334 $ ] and @xmath335 $ ] cancel , we have a homotopy @xmath336 \\rightarrow f$ ] between @xmath337 and @xmath338 . since @xmath339 is compact , and",
    "since @xmath142 has finitely many self - intersection points , we may choose a compact subsurface @xmath326 of @xmath8 containing @xmath339 for all pairs @xmath340 corresponding to terms that cancel .",
    "note that once @xmath326 contains @xmath339 , @xmath326 must also contain the image of @xmath142 .",
    "if we compute @xmath331_c)$ ] on @xmath326 , the terms @xmath334 $ ] and @xmath335 $ ] will cancel , since @xmath341 can be viewed as a homotopy in @xmath326 .",
    "thus @xmath324))\\geq t(\\mu([g]_c))$ ] .",
    "furthermore , any terms which cancel on @xmath326 must cancel on @xmath8 , so the inequality becomes an equality .",
    "+   + now we state our main results .",
    "theorems [ main2 ] and [ nonprimthm ] are stated as corollaries [ cor1 ] and [ cor2 ] of theorem [ mainlemma ] , respectively , though for now we restrict theorem [ nonprimthm ] to the case where @xmath2 is not a power of another class .",
    "recall that theorem [ main2 ] states that @xmath5 is zero if and only if @xmath2 is a power of a simple class , and theorem [ nonprimthm ] gives a formula for the minimal self - intersection number of @xmath2 .",
    "[ cor1 ] let @xmath156 .",
    "then @xmath13 if and only if @xmath22 for some @xmath342 , where @xmath343 .",
    "_ suppose @xmath22 for some @xmath342 , where @xmath343 .",
    "we may assume @xmath344 .",
    "we will compute @xmath5 , and see that @xmath13 .",
    "we begin by choosing a simple representative @xmath143 of @xmath17 and a point @xmath11 on @xmath143 .",
    "then @xmath345 is a representative of @xmath2 .",
    "we perturb @xmath142 slightly so that it has @xmath23 self - intersection points ( of type 2 ) , all with image @xmath11 .",
    "now @xmath346-[(h_p)^{n - i}\\bullet_p ( h_p)^i],\\ ] ] + which equals zero , since the positive term corresponding to @xmath201 cancels with the negative term corresponding to @xmath347 .",
    "note that this argument actually shows that the terms of @xmath3 corresponding to type 2 self - intersection points always cancel with each other , even if @xmath348 .",
    "+   + to prove the converse , we assume @xmath2 can not be written as a power of a simple class . by lemma [ compact ] , we may assume @xmath8 is compact .",
    "therefore , either @xmath349 or @xmath350 , or @xmath8 can be equipped with a metric of negative curvature . in this situation , @xmath8 clearly can not be @xmath351 or @xmath178 .",
    "+   + @xmath8 also can not be @xmath350 .",
    "let @xmath142 be a representative of @xmath2 , and consider @xmath325_p\\in\\pi_1(t^2,p)$ ] for some @xmath11 on the image of @xmath142 .",
    "let @xmath12 and @xmath29 be the generators of @xmath352 which lift to the paths from @xmath353 to @xmath354 and @xmath355 respectively under the usual covering map @xmath356",
    ". then we can write @xmath325_p=([a^{e_1}b^{e_2}]_p)^k$ ] where the @xmath357 are relatively prime . taking @xmath358_p$ ] , we have @xmath343 , since the lift of @xmath359 is homotopic to a path from @xmath353 to @xmath360 . +   + now we may assume @xmath361 or @xmath350 , so we can apply theorem [ mainlemma ] .",
    "we choose a geodesic representative @xmath142 of @xmath2 , and write @xmath144 where @xmath143 is not a power of another loop in @xmath15 .",
    "suppose @xmath143 has @xmath148 self - intersection points .",
    "then we can perturb @xmath142 to obtain a loop @xmath149 with @xmath362 self - intersection points , where @xmath152 of the self - intersections are of type 1 , and @xmath23 are of type 2 . by theorem [ mainlemma ]",
    ", no two terms of @xmath3 corresponding to type 1 self - intersection points can cancel . as we saw above",
    ", all of the type 2 terms cancel with each other .",
    "so , after all cancellations are made , @xmath363 terms of @xmath3 remain . since @xmath364 , we know @xmath365 .",
    "[ cor2 ] let @xmath366 be primitive",
    ". then @xmath367 .",
    "thus @xmath3 computes the minimal self intersection number of @xmath2 .",
    "_ by lemma [ compact ] , we may assume @xmath8 is compact .",
    "if @xmath368 for any @xmath369 and @xmath370 , we can choose a geodesic representative @xmath142 of @xmath2 such that the self - intersection points of its perturbation @xmath149 are all of type 1 .",
    "if @xmath361 or @xmath350 , then by theorem [ mainlemma ] , no two terms of @xmath5 can cancel . thus @xmath367 .",
    "+   + if @xmath371 or @xmath178 , we can choose a representative of @xmath2 with no self - intersection points , implying that the equality @xmath367 holds trivially .",
    "this is clear for @xmath351 and @xmath178 .",
    "if @xmath372 , we choose a representative @xmath142 of @xmath2 , and consider @xmath325_p\\in \\pi_1(t^2,p)$ ] for some point @xmath11 on the image of @xmath142 . if @xmath12 and @xmath29 are generators the of @xmath352 as in the proof of corollary [ cor1 ] , we can write @xmath325_p=([a^{e_1}b^{e_2}]_p)^k$ ] where the @xmath357 are relatively prime . since @xmath2 is not a power of another class , @xmath373 , so @xmath325_p= ( [ a^{e_1}b^{e_2}]_p)^{\\pm 1}$ ]",
    ". this class has a simple representative , as shown in the proof of corollary [ cor1 ] .",
    "if we combine our results above with those of hass and scott in @xcite , we can use @xmath3 to compute the minimal self - intersection number of any class @xmath2 , even if @xmath2 is not primitive .",
    "we will use the following result , which we state for orientable surfaces ( their result is more general ) :    let @xmath145 be a loop on @xmath374 in general position .",
    "suppose that @xmath145 is a representative of the class @xmath22 , where @xmath17 is a non - trivial and primitive element of @xmath15 .",
    "let @xmath375 be the universal cover of @xmath8 and let @xmath376 denote the quotient of @xmath375 by the cyclic subgroup of @xmath15 generated by @xmath17 .",
    "let @xmath377 be the lift of @xmath8 , and let @xmath193 denote one of the lines in @xmath375 above @xmath378 . then @xmath145 has least possible self - intersection if and only if @xmath379 has least possible self - intersection and , for all @xmath260 in @xmath15 such that @xmath260 is not a power of @xmath17 , the intersection @xmath380 consists of at most one point .",
    "[ hassscottlemma ]    we now use lemma [ hassscottlemma ] to get the following corollary , which gives a formula for @xmath14 in terms of @xmath381 , where @xmath2 is a power of @xmath17 and @xmath17 is primitive . for a similar statement for compact surfaces with boundary ,",
    "see the remark following theorem 2 in @xcite .",
    "( note that as it seems , the statement in @xcite contains a typo , namely @xmath382 should be @xmath383 ) .",
    "let @xmath156 be a nontrivial class such that @xmath22 and @xmath17 is a primitive class , where @xmath374 and @xmath18",
    ". then @xmath384 .",
    "[ corminintpower ]    _ proof .",
    "_ first we remark that one can deduce this fact from the proof of lemma [ hassscottlemma ] in @xcite , rather than from the statement of the lemma itself . we choose to do the latter to avoid repeating most of the proof of lemma [ hassscottlemma ] .",
    "+   + equip @xmath8 with a flat or hyperbolic metric",
    ". then @xmath375 is diffeomorphic to @xmath385 , so @xmath386 is a cylinder .",
    "we begin by choosing a geodesic representative @xmath142 of @xmath2 and perturb @xmath142 to obtain a new loop @xmath149 .",
    "if @xmath387 , we take @xmath388 .",
    "otherwise , we lift @xmath142 to obtain a geodesic loop @xmath389 in @xmath376 . we then take a @xmath390-small perturbation of @xmath389 to obtain a loop @xmath391 with @xmath23 self - intersection points , and we let @xmath149 be the projection of @xmath391 back to @xmath8 .",
    "we note that @xmath391 has minimal self - intersection ( see , for example , @xcite ) . as mentioned in the discussion leading up to theorem [ mainlemma ]",
    ", the number of self - intersection points of @xmath149 is @xmath392 .",
    "let @xmath393 denote one of the lines above @xmath149 in @xmath375 . to show that @xmath149 has minimal self - intersection , it remains to show that for all @xmath394 such that @xmath260 is not a power of @xmath17 , the intersection @xmath395 consists of at most one point .",
    "suppose that for some @xmath260 , the lines @xmath396 and @xmath393 intersect in two points @xmath11 and @xmath180 .",
    "these lines bound a 2-gon in @xmath375 .",
    "let @xmath397 and @xmath398 denote the two arcs of the 2-gon in @xmath375 .",
    "let @xmath399 denote the covering map from @xmath375 to @xmath8 .",
    "since @xmath397 and @xmath398 are homotopic with common ends , their projections @xmath400 and @xmath401 must be as well .",
    "furthermore the arcs @xmath400 and @xmath401 are contained in the image of @xmath149 .",
    "since @xmath149 is a perturbation of a geodesic , @xmath402 and @xmath403 must be type 2 self - intersection points of @xmath149 .",
    "thus each @xmath404 is an arc in the image of @xmath149 connecting two type 2 self - intersection points , and hence must be homotopic to @xmath405 for some @xmath406 .",
    "this implies @xmath260 is a power of @xmath17 .",
    "hence if @xmath260 is not a power of @xmath17 , the intersection of @xmath396 and @xmath393 contains at most one point . +   + recall that , if we make our usual choice of a perturbation of a geodesic @xmath407 , then two terms of @xmath5 cancel if and only if they correspond to type 2 self - intersection points . ( the observation that terms corresponding to type 2 self - intersection points must cancel with other such terms is contained in the proof of corollary [ cor1 ] . ) together with corollary [ corminintpower ] , this allows us to use @xmath3 to compute the minimal self - intersection number of a class which may not be primitive .",
    "let @xmath133 be a nontrivial class such that @xmath22 where @xmath17 is primitive and @xmath18",
    ". then @xmath408 .",
    "_ by theorem [ mainlemma ] , we know @xmath409 , i.e. , the number of type 1 self - intersection points .",
    "since @xmath410 , we have @xmath408 .",
    "the following example illustrates how one can compute the minimal self - intersection number of a free homotopy class algorithmically using @xmath5 .",
    "we will use @xmath3 to compute the minimal intersection number of a class @xmath411 on the punctured surface of genus two , with surface word @xmath412 this homotopy class has turaev cobracket zero , as shown in example 5.8 of @xcite .",
    "a representative of @xmath2 with two self - intersection points is pictured in figure [ genus2puncturedexample.fig ] .",
    "using @xmath3 , along with the methods in @xcite , we show that the minimal self - intersection number of @xmath2 is 2 .",
    "we compute @xmath3 , and find that @xmath413 @xmath414 it is easy to see that terms one and two can not cancel , since there is no @xmath415 such that @xmath416 . in general , one can check whether two reduced words in the generators of @xmath224 are in the same conjugacy class by comparing two cyclic lists , since the conjugacy class of a reduced word in a free group consists of all the cyclic permutations of that word . similarly terms",
    "three and four can not cancel .",
    "next , we show terms one and four can not cancel .",
    "first we conjugate term one by @xmath417 so that its first loop matches the first loop of term four .",
    "the first term becomes @xmath418 if terms one and four cancel , we can find @xmath419 such that @xmath221 and @xmath420 , and such that @xmath421 abelian subgroups of @xmath15 are infinite cyclic , so the subgroup @xmath422 is generated by some @xmath423 .",
    "we will see that @xmath424 .",
    "suppose @xmath425 , and consider this relation in the abelianization of @xmath15 , where the generator @xmath426 of @xmath15 is sent to the generator of @xmath427 with a 1 in position @xmath192 and zeroes elsewhere .",
    "hence this relation becomes @xmath428 , which only has solutions when @xmath429 .",
    "therefore @xmath430 for some @xmath431 .",
    "however , the relation @xmath432 can not hold for any value of @xmath191 .",
    "hence none of the terms of @xmath3 cancel , and @xmath433 . +   + in general , when deciding whether two terms cancel , we first verify that the first loops in each term are indeed in the same conjugacy class .",
    "if this is the case , we will have two elements @xmath221 and @xmath222 that commute ( @xmath434 in the example above ) , and we know @xmath435 .",
    "since every nontrivial element of @xmath224 is contained in a unique maximal infinite cyclic subgroup , we can write @xmath436 where @xmath148 is the generator of the maximal infinite cyclic subgroup containing @xmath237 . we need to find @xmath148 given @xmath222 , as our goal is to write @xmath221 as a power of @xmath148 .",
    "to find @xmath148 given @xmath222 , we first cyclically reduce @xmath222 and write the result as a word @xmath437 in the generators of @xmath224 .",
    "since @xmath437 is cyclically reduced , then in order to be a power of another element , it must look like a concatenation of @xmath190 copies of some cyclically reduced word @xmath438 in the generators of @xmath224 , so we can determine @xmath190 and @xmath438 where @xmath190 is as large ( in absolute value ) as possible .",
    "now @xmath439 , and there exists @xmath440 such that @xmath441 , so @xmath442 .",
    "we can now write @xmath221 as a power of @xmath148 and finish the algorithm as in the example above .",
    "we conclude by investigating properties of @xmath3 which allow one to view @xmath3 as a generalization of a lie cobracket . in particular , we exhibit analogues of the following properties of the turaev cobracket @xmath4 :      we begin by modifying the definition of @xmath3 given for free loops , and then extend this operation to certain chord diagrams in the andersen - mattes - reshetikhin algebra . for the purposes of computing the minimal self - intersection number ,",
    "this definition is equivalent to the previous one .",
    "however , it is easier to state the analogues of co - skew symmetry and the co - jacobi identity for this modified definition .",
    "+   + recall that @xmath80 denotes the free @xmath0-module generated by the set of chord diagrams on @xmath8 , and @xmath82 denotes the submodule generated by the @xmath83-relations in figure [ 4term.fig ] ( and relations obtained from them by reversing orientations on arrows ) .",
    "the andersen - mattes - reshetikhin bracket is defined on the quotient @xmath89 .",
    "given a chord @xmath11 of a geometrical chord diagram , we say @xmath11 is an _ external chord _ if the endpoints of @xmath11 lie on distinct core circles .",
    "otherwise , we call @xmath11 an _ internal chord_. now we let @xmath447 denote the free @xmath7-module generated by diagrams with only external chords , and let @xmath448 denote the submodule of @xmath447 generated by the relations in figures [ slidechord.fig ] and [ slidechord2.fig ] , their mirror images , and relations obtained from these by reversing the orientation on any branch in the picture . from these relations , one can obtain the @xmath83 relations of the andersen - mattes - reshetikhin algebra in which the orientations of the arcs in the four pictures are identical . we will define @xmath3 on @xmath449 . from now on",
    ", we also assume that the core circles of our chord diagrams are labeled with the digits @xmath450 , where @xmath150 is the number of core circles in the diagram .",
    "+   +    the operation @xmath3 will add a chord between the preimages of each self - intersection point of each core circle , in the same way as before .",
    "however , rather than adding an oriented chord whose orientation induces a labeling on the resulting two loops in the image of the geometrical chord diagram , we split the abstract diagram into two labeled loops connected by an unoriented chord .",
    "+   + we define two maps @xmath451 and @xmath452 which split a core circle labelled @xmath190 into two new core circles labeled @xmath190 and @xmath453 ( see figures [ split12.fig ] and [ split21.fig ] ) .",
    "suppose @xmath454 is the restriction of our original chord diagram to the @xmath170 core circle . the map @xmath451 ( respectively @xmath452 ) maps the new circle labeled @xmath190 ( respectively @xmath453 ) to @xmath62 and the new circle labeled @xmath453 ( respectively , @xmath190 ) to @xmath63 .",
    "the splitting map also increases by one the label on all core circles formerly labeled with numbers greater than or equal to @xmath453 .",
    "note that the image of smooth chord diagram under @xmath455 may not be smooth at @xmath11 , but we can always find a smooth diagram in its homotopy class .",
    "+   +      now let @xmath457 denote the set of self - intersection points of the @xmath170 core circle in our chord diagram such that neither of the maps formed by the splitting map at that point are homotopy trivial .",
    "let @xmath337 denote the diagram obtained by adding a chord between @xmath57 and @xmath58 in a chord diagram @xmath77 where @xmath458 and @xmath115 .",
    "we define @xmath459-[s^-_p(d_p)],\\ ] ] and we let @xmath460 using linearity , we extend this definition so that @xmath3 becomes a map from @xmath461 to @xmath461 .",
    "+   + _ remark : _ the identification in figure [ slidechord2.fig ] arises because @xmath3 splits the original core circle into two new circles .",
    "if we define @xmath3 without the splitting map , this identification is not needed .",
    "we need to verify that @xmath462 does not depend on the choice of diagram @xmath77 in @xmath121 .",
    "clearly @xmath456 does not change when @xmath77 undergoes regular isotopy .",
    "applying the first reidemeister move to @xmath77 does not affect @xmath463)$ ] because we only sum over self - intersection points such that the two new maps produced by @xmath464 are not homotopy trivial .",
    "the fact that @xmath456 does not change under other elementary moves follows from either other elementary moves or identifications we make :    * * second reidemeister move : * this follows from the move in figure [ type2movewithdot.fig ] . *",
    "* third reidemeister move : * this follows from the move in figure [ type3movewithdot.fig ] . * * the move in figure [ type2movewithdot.fig ] : * because the existing chord is an exterior chord , we do not sum over the intersection point in this diagram because it must be an intersection point of different core circles . *",
    "* the move in figure [ type3movewithdot.fig ] : * this follows from the following identifications in figures [ slidechord.fig ] and [ slidechord2.fig ] .",
    "note that the @xmath83 relations in the andersen - mattes - reshetikhin algebra imply that their bracket is invariant under this move . in our case ,",
    "the relations only contain two terms because the fact that the chord is an exterior chord implies we only sum over at most one of the intersection points before and after the move in figure [ type3movewithdot.fig ] .",
    "* * the identification in figure [ slidechord.fig ] : * this follows from the following identifications in figures [ slidechord.fig ] and [ slidechord2.fig ] : * * the identification in figure [ slidechord2.fig ] : * because the chords in the picture are exterior chords , the one intersection point can not be a self - intersection point , so we do not sum over it .          _ proof .",
    "+   + let @xmath467 be a map which cyclically permutes the labels @xmath468 .",
    "specifically , @xmath467 decreases the labels @xmath453 and @xmath469 by one , and sends @xmath190 to @xmath469 .",
    "we have the following analogue of the co - jacobi identity :      _ proof .",
    "_ it suffices to show that , for a diagram with one core circle @xmath472 , we have @xmath473 each diagram in the sum @xmath474 has three core circles and two chords corresponding to two self - intersection points of @xmath472 , which we call @xmath11 and @xmath180 .",
    "the idea of the proof is as follows : @xmath474 is a sum of four terms , two of which are positive and two of which are negative .",
    "relative to some fixed initial order on the three core circles , the labelings on each diagram form an even or odd permutation in @xmath475 , the symmetric group on three elements .",
    "the labelings on two of the four terms of @xmath474 form even permutations , and the other two form odd permutations . of the ",
    "even \" terms , one has coefficient @xmath10 and one has coefficient @xmath9 .",
    "the same holds for the  odd \" terms .",
    "therefore , when we apply @xmath476 to the terms with coefficient @xmath9 , we get six terms with coefficient @xmath9 , one for each element of @xmath475 . when we apply @xmath476 to the terms with coefficient @xmath10",
    ", we get the same six terms with negative coefficients , so all terms cancel . to verify the above claims",
    ", one can examine all possible gauss diagrams of @xmath472 with two non - crossing arrows , corresponding to the self - intersection points @xmath11 and @xmath180 ( there are three such diagrams ) .",
    "figure 16 lists the terms in the sum @xmath477 before cancellations are made for a sample free loop .",
    "+   +               we conclude by stating the relationship between @xmath456 and the turaev cobracket .",
    "let @xmath111 be a map which erases all chords from a diagram , and tensors the resulting loops , putting @xmath78 in the @xmath170 position of the tensor product .",
    "let @xmath478 , where @xmath4 is in the @xmath170 position .      _",
    "_ this follows from the fact that @xmath480)$ ] for any free loop @xmath2 on @xmath8 .",
    "+   + _ remark : _ one might hope to find analogues of the compatibility and involutivity conditions in the goldman - turaev lie bialgebra :    * @xmath4 and @xmath481 $ ] satisfy the compatibility condition @xmath482=[\\alpha,\\delta(\\beta)]+[\\delta(\\alpha),\\beta]$ ] , where @xmath483 $ ] is given by @xmath47\\otimes \\gamma+ \\beta\\otimes[\\alpha,\\gamma]$ ] . * the lie bialgebra formed by @xmath481 $ ] and @xmath4 is involutive , i.e. , @xmath481\\circ\\delta=0 $ ] .    however",
    ", we do not see a way of doing this unless we allow internal chords in our chord diagrams , and once we do this , it is unclear whether the maps involved in analogues of these identities ( and @xmath3 in particular ) are well - defined",
    ". +   + * acknowledgements .",
    "* i would like to thank my advisor vladimir chernov for his guidance and for reading and commenting on many drafts of this paper .",
    "i would also like to thank yong su for computing examples using a preliminary definition of the operation @xmath3 .",
    ", _ paths of geodesics and geometric intersection numbers i_. combinatorial group theory and topology , altah utah , 1984 , annals of mathematical studies , vol .",
    "111 , princeton university press , princeton , nj 1987 , pp .",
    "479 - 500 .",
    ", _ paths of geodesics and geometric intersection numbers ii_. combinatorial group theory and topology , altah utah , 1984 , annals of mathematical studies , vol .",
    "111 , princeton university press , princeton , nj 1987 , pp .",
    "501 - 543 ."
  ],
  "abstract_text": [
    "<S> goldman and turaev constructed a lie bialgebra structure on the free @xmath0-module generated by free homotopy classes of loops on a surface . </S>",
    "<S> turaev conjectured that his cobracket @xmath1 is zero if and only if @xmath2 is a power of a simple class . </S>",
    "<S> chas constructed examples that show turaev s conjecture is , unfortunately , false . </S>",
    "<S> we define an operation @xmath3 in the spirit of the andersen - mattes - reshetikhin algebra of chord diagrams . </S>",
    "<S> the turaev cobracket factors through @xmath3 , so we can view @xmath3 as a generalization of @xmath4 . we show that turaev s conjecture holds when @xmath4 is replaced with @xmath3 . </S>",
    "<S> we also show that @xmath5 gives an explicit formula for the minimum number of self - intersection points of a loop in @xmath2 . </S>",
    "<S> the operation @xmath3 also satisfies identities similar to the co - jacobi and coskew symmetry identities , so while @xmath3 is not a cobracket , @xmath3 behaves like a lie cobracket for the andersen - mattes - reshetikhin poisson algebra . </S>"
  ]
}