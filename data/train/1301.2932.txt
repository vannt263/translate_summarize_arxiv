{
  "article_text": [
    "in newtonian mechanics , the concept of `` relative velocity '' of a test particle with respect to an observer is unambiguous and fundamental .",
    "nevertheless , in general relativity it is only well defined when the observer and the test particle are in the same event . in order to generalize this concept for distant test particles ,",
    "a definition of relative velocity based on a particular coordinate system can be introduced , and it could be interesting in some cases , like the comoving coordinates in flrw spacetimes for static observers ( see @xcite ) .",
    "moreover , some notions of relative velocity of a distant test particle were introduced by the iau using adapted reference systems in the case of objects in the neighborhood of the solar system ( see @xcite ) . however",
    ", a universal concept of relative velocity independent from any coordinate system is basic and thereby , some authors have proposed geometric definitions without any coordinate - dependence ( see @xcite ) . in this way ,",
    "four different intrinsic geometric definitions of relative velocity of a distant test particle with respect to a single observer were introduced in @xcite .",
    "these definitions are strongly associated with the concept of simultaneity : _ kinematic _ and _ fermi _ in the framework of `` spacelike simultaneity '' , _ spectroscopic _ and _ astrometric _ in the framework of `` lightlike simultaneity '' .",
    "these four concepts of relative velocity each have full physical sense , and have proved to be useful in the study and interpretation of properties of particular spacetimes ( see @xcite ) .",
    "for example , we can measure the expansion of space from the kinematic and fermi relative velocities of comoving observers of flrw spacetimes ( see @xcite ) , or find the frequency shift and the light aberration effect ( see @xcite ) from the spectroscopic relative velocity .",
    "but , in most cases , the computations are analytically very complex and it makes the theoretical study much harder .",
    "these computations are strongly associated with the _ fermi _ and _ observational coordinates _ and so , we present in this paper a numerical algorithm for finding these coordinates , allowing the computation of the geometric relative velocities .",
    "this paper is organized as follows . in section [ sec2 ]",
    "we present the framework , establishing the notation and defining some necessary concepts , introducing in section [ sec2.1 ] the four geometric concepts of relative velocity and extending the original definitions to non - convex normal neighborhoods . in section [ sec3 ]",
    "we develop the algorithm focused on computing the _ fermi _ and _ observational coordinates _ of the test particle with respect to the observer by means of finding a geodesic ( with certain characteristics ) from the observer to the test particle , and we also make a discussion about the convergence of the method in remark [ rem : conv ] . in section",
    "[ sec : examples ] we give some fundamental examples in schwarzschild and kerr spacetimes , showing the rate of convergence and the effectiveness of the algorithm .",
    "finally , in appendix [ sec : alter ] we present an alternative method for computing the fermi and astrometric relative velocities .",
    "we work in a lorentzian spacetime manifold @xmath0 , with @xmath1 and @xmath2 the levi - civita connection , using the `` mostly plus '' signature convention @xmath3 . given two events @xmath4 , @xmath5 , and a segment curve @xmath6 that joins @xmath4 and @xmath5 , the parallel transport from @xmath4 to @xmath5 along @xmath6",
    "is denoted by @xmath7 . given a curve @xmath8 with @xmath9 , the image @xmath10 ( a subset in @xmath11 ) is identified with @xmath12 .",
    "vector fields are denoted by uppercase letters and vectors ( defined at a single point ) are denoted by lowercase letters . if @xmath13 is a vector , then @xmath14 denotes the orthogonal space of @xmath13 .",
    "the projection of a vector @xmath15 onto @xmath14 is the projection parallel to @xmath13 , i.e. @xmath16 . moreover , if @xmath17 is a spacelike vector , then @xmath18 is the modulus of @xmath17 . given a vector field @xmath19 , the unique vector of @xmath19 in @xmath20 is denoted by @xmath21 .",
    "in general , we say that a timelike world line @xmath12 is an _ observer _",
    "( or a _ test particle _ ) ; nevertheless , we say that a future - pointing timelike unit vector @xmath13 in @xmath22 is also an _ observer at @xmath4 _ , identifying the observer with its 4-velocity .",
    "a _ light ray _ is a lightlike ( null ) geodesic @xmath23 .",
    "a _ light ray from _",
    "@xmath4 is a light ray @xmath23 such that @xmath24 and @xmath4 is in the causal future of @xmath5 .",
    "we are going to consider two kinds of intrinsic simultaneity : _ spacelike _ and _ lightlike_. given an observer @xmath13 at @xmath4 , the events simultaneous with @xmath13 form the corresponding _ simultaneity submanifold _ :    * spacelike simultaneity : the _ fermi surface _ @xmath25 ( also known as _",
    "landau submanifold _ ) is given by all the geodesics starting from @xmath4 and orthogonal to @xmath13 . in terms of the exponential map , @xmath26",
    "where @xmath27 is the geodesic starting at @xmath4 with initial tangent vector @xmath15 . ] on @xmath20 , it is given by @xmath28 .",
    "* lightlike simultaneity : the _ past - pointing horismos submanifold _",
    "@xmath29 is given by all the light rays arriving at @xmath4 , i.e. it is given by @xmath30 where @xmath31 is the past - pointing light cone in @xmath20 composed by all the past - pointing lightlike vectors of @xmath20 .",
    "four different definitions of relative velocity of a test particle with respect to an observer were introduced in @xcite , working in a convex normal neighborhood , where given two different events there exists a unique geodesic joining them .",
    "now , we are going to work in a general spacetime @xmath11 , not necessarily a convex normal neighborhood , and we are going to extend the definitions of @xcite to this new setting , where two events could be joined by more than one ( or none ) geodesic and the simultaneity submanifolds could present self - intersections .    throughout the paper ,",
    "we consider an observer @xmath12 and a test particle @xmath32 ( parameterized by their proper times ) with 4-velocities @xmath33 and @xmath34 respectively .",
    "moreover , we consider an event @xmath4 of @xmath12 with 4-velocity @xmath35",
    ".    given a vector @xmath36 such that @xmath37 , the corresponding _ kinematic relative velocity of @xmath32 with respect to @xmath13 _ is defined by the vector @xmath38 where @xmath39 is the event of @xmath32 at which the relative velocity is measured , @xmath40 is the 4-velocity of @xmath32 at @xmath41 , and @xmath42 is the parallel transport from @xmath41 to @xmath4 along the geodesic segment given by @xmath43 for @xmath44 ( see figure [ diagram2 ] , left ) . in this case",
    ", @xmath45 is a _ relative position of @xmath32 with respect to @xmath13 _ , and there is a different @xmath46 for each different @xmath45 satisfying @xmath36 , @xmath37 .",
    "note that if we work in a convex normal neighborhood then @xmath45 is unique .",
    "with respect to @xmath13 in general ( not necessarily in a convex normal neighborhood ) . left : given @xmath36 such that @xmath37 , we define @xmath43 for @xmath44 , @xmath47 , and @xmath48 is the 4-velocity of @xmath32 at @xmath41 .",
    "right : given @xmath49 such that @xmath50 , we define @xmath51 , @xmath52 for @xmath44 , @xmath53 , and @xmath54 is the 4-velocity of @xmath32 at @xmath55.,scaledwidth=80.0% ]    analogously , we can define another concept of relative velocity also introduced in @xcite : given a vector @xmath49 such that @xmath50 , the corresponding _ spectroscopic relative velocity of @xmath32 with respect to @xmath13 _ is defined by the vector @xmath56 where @xmath57 is the event of @xmath32 at which the relative velocity is measured , @xmath58 is the 4-velocity of @xmath32 at @xmath55 , and @xmath59 is the parallel transport from @xmath55 to @xmath4 along the light ray segment given by @xmath52 for @xmath44 ( see figure [ diagram2 ] , right ) . in this case",
    ", the projection of @xmath60 onto @xmath14 given by @xmath51 is the corresponding _ observed relative position of @xmath32 with respect to @xmath13 _ , and there is a one - to - one correspondence between @xmath60 and @xmath61 ( note that @xmath62 ) .",
    "so , there is a different @xmath63 for each different @xmath60 satisfying @xmath49 , @xmath50 , and this means that if there is gravitational lensing then each image of the observed object has a different spectroscopic relative velocity .",
    "the spectroscopic relative velocity is specially useful because the frequency shift can be deduced from it ( see @xcite ) : let @xmath23 be a light ray from @xmath55 to @xmath4 and let @xmath13 , @xmath54 be two observers at @xmath4 , @xmath55 respectively ; then @xmath64 where @xmath65 , @xmath66 are the frequencies of @xmath23 observed by @xmath13 , @xmath54 respectively , @xmath63 is the corresponding spectroscopic relative velocity given by , and @xmath61 is the corresponding observed relative position of @xmath54 with respect to @xmath13 .    in general , the existence of @xmath45 or @xmath60 ( and consequently @xmath61 ) is not assured .",
    "nevertheless , if they exist for each event of the observer @xmath12 , we can construct ( differentiable ) vector fields @xmath67 and @xmath68 defined on @xmath12 , representing a _ relative position _ and an _ observed relative position of @xmath32 with respect to @xmath12 _ , respectively .",
    "but , of course , not all choices of @xmath45 and @xmath60 lead to differentiable @xmath67 and @xmath68 , only those that change differentiably when varying the event of the observer . from @xmath67 and @xmath68",
    ", we can construct the vector fields @xmath69 and @xmath70 defined on @xmath12 , representing a _ kinematic _ and a _ spectroscopic relative velocity of @xmath32 with respect to @xmath12 _ , respectively .",
    "given a vector field @xmath67 defined on @xmath12 and representing a relative position of @xmath32 with respect to @xmath12 ( i.e. such that @xmath71 and @xmath72 for all @xmath73 ) , the corresponding _ fermi relative velocity of @xmath32 with respect to @xmath12 _ is the vector field @xmath74 defined on @xmath12 .",
    "analogously , given a vector field @xmath68 defined on @xmath12 and representing an observed relative position of @xmath32 with respect to @xmath12 ( i.e. such that @xmath75 and @xmath76 for all @xmath73 ) , the corresponding _ astrometric relative velocity of @xmath32 with respect to @xmath12 _ is the vector field @xmath77 defined on @xmath12 .",
    "if we work in a convex normal neighborhood , then it is assured that there exists a unique @xmath67 and @xmath68 , and hence there exists a unique @xmath69 , @xmath70 , @xmath78 , and @xmath79 ( see @xcite ) .",
    "but this is not true in general and so different vector fields @xmath67 and @xmath68 define different vector fields @xmath69 , @xmath70 , @xmath78 , and @xmath79 .    in order to complete the notation that we are going to use , we define the vectors @xmath80 and @xmath81 ; moreover , throughout the paper we are going to denote @xmath82 , @xmath83 , @xmath84 , and @xmath85 as we have already done in this section .",
    "first , we are going to suppose that we work in a convex normal neighborhood , and later , in section [ nonconvex ] we will extend the discussion to non - convex normal neighborhoods .",
    "so , working in a convex normal neighborhood implies that given an event @xmath73 with 4-velocity @xmath13 , there exists a unique event @xmath86 such that the unique geodesic @xmath6 that joins @xmath4 and @xmath41 is in @xmath25 ( i.e. it is orthogonal to @xmath13 at @xmath4 ) ; on the other hand , there exists a unique event @xmath87 such that the unique geodesic @xmath23 that joins @xmath4 and @xmath55 is in @xmath88 ( i.e. it is a light ray arriving at @xmath4 ) . in this case , the main difficulty is to find the geodesics @xmath6 ( spacelike simultaneity ) and @xmath23 ( lightlike simultaneity ) , taking into account that the events @xmath89 and @xmath55 are also unknown ( see figure [ diagram2 ] ) .",
    "this is equivalent to finding the relative positions @xmath45 and @xmath61 , i.e. the _ fermi _ and _ observational _ ( or _ optical _ ) coordinates respectively ( see @xcite ) .",
    "once we have found them , the corresponding relative velocities are easy to compute by means of their definitions ( see section [ sec2.1 ] ) .",
    "if we can not find theoretically the fermi and observational coordinates , then we can not find the geodesics @xmath6 and @xmath23 of figure [ diagram2 ] .",
    "of course , there is a _ brute - force _ method for finding these geodesics that consists on launching a lot of geodesics from the observer at @xmath4 in different directions ( orthogonal to @xmath13 in the spacelike case , and past - pointing lightlike directions in the lightlike case ) , trying to reach the test particle @xmath32 .",
    "but obviously , this method spends a lot of computation time , and solving the geodesic equations with an acceptable accuracy is not as fast as we desire in some metrics .",
    "so , we are going to propose a more efficient method based on an iterative correction algorithm with a newton - raphson structure . but",
    "first , we need to make more precise the concept of `` nearness '' between curves .",
    "there is no global concept of distance in pseudo - riemannian manifolds because the metric @xmath90 is degenerate .",
    "nevertheless , given a 3-dimensional spacelike foliation in @xmath11 we have that the induced metric @xmath91 is riemannian .",
    "hence , we are going to suppose that we use a coordinate system @xmath92 such that @xmath93 are spacelike coordinates and @xmath94 ( also denoted as @xmath95 ) is a timelike coordinate , referred as _ coordinate time _ ; then , @xmath96 defines the leaves of the desired spacelike foliation , and the covariant coefficients of the induced riemannian metric @xmath91 are given by @xmath97 , where @xmath98 are the covariant coefficients of the general metric @xmath90 in the above coordinate system ( latin indices run over @xmath99 , and greek indices run over @xmath100 ) .",
    "namely , given two vectors @xmath101 in the same tangent space of a leaf , we have that @xmath102 , and @xmath103",
    ".    therefore , given any event @xmath4 in a leaf , there exists a local concept of spatial distance for events @xmath5 in the same leaf : @xmath104 , where @xmath15 is the vector which `` joins '' @xmath4 and @xmath5 , i.e. such that @xmath105 where @xmath106 is the induced exponential map at @xmath4 .",
    "if @xmath107 , the tangent spaces at @xmath4 and @xmath5 can be identified by means of the coordinate system , and we can consider an affine structure around @xmath4 , having @xmath108 , i.e. @xmath109 .",
    "so , we will say that two events @xmath110 with the same coordinate time are _ close _ if @xmath111 is considered to be small , where @xmath112 is the vector in the tangent space of @xmath4 with coordinates @xmath113 .",
    "note that the geodesics in the leaves @xmath96 are not the same as in the original manifold ( unless the leaves submanifolds were totally geodesic ) , and so it is not assured the existence and uniqueness of the previous vector @xmath15 in general .",
    "nevertheless , in this section we work in a convex normal neighborhood , i.e. the exponential map is a diffeomorphism ; hence , if the leaves @xmath96 are regular submanifolds ( i.e. the vector field @xmath114 is synchronizable ) then the induced exponential maps are also diffeomorphisms and so the leaves are convex normal neighborhoods . in conclusion , we have to add the assumption that @xmath114 is synchronizable .",
    "this concept of nearness can be also applied to curves : we will say that two curves @xmath115 , @xmath116 are _ close _ if there exist two events @xmath117 and @xmath118 with the same coordinate time such that @xmath4 and @xmath5 are close ( i.e. @xmath111 is small ) .",
    "let @xmath119 be a coordinate system such that @xmath93 are spacelike coordinates and @xmath95 is a timelike coordinate . in the framework of spacelike simultaneity and taking into account the previous concept of nearness",
    ", we choose an initial vector @xmath120 , such that the geodesic @xmath121 starting from @xmath4 with initial tangent vector @xmath122 is sufficiently close to the test particle @xmath32 ; i.e. there exist events @xmath123 ( in the geodesic ) and @xmath124 ( in the test particle ) , both with the same coordinate time , such that @xmath125 is considered to be small .    [ rem3.1 ] in practice , we need a sub - algorithm for estimating @xmath123 and @xmath124 : given the initial geodesic @xmath121 , we can compute the spatial distance between events of @xmath121 and the corresponding events of @xmath32 with the same coordinate time ; supposing that @xmath123 ( in @xmath121 ) and @xmath124 ( in @xmath32 ) are the events that minimize this distance , we can use a bisection method for estimating them with low computational cost .",
    "nevertheless , the accuracy at this stage is not too much important because we only need two events sufficiently close .",
    "( left ) and the estimations of @xmath41 ( right ) when @xmath123 and @xmath124 ( that are events with the same coordinate time ) are close . in this case",
    ", all the tangent spaces are identified by means of the coordinate system and provide an affine structure around @xmath123 .",
    "right : the fermi surface @xmath25 is approximated by the affine hyperplane @xmath126.,scaledwidth=75.0% ]    since we are going to work near the event @xmath123 , we can identify all the tangent spaces by means of the coordinate system and provide an affine structure in the vicinity of @xmath123 , where @xmath127 .",
    "hence , the fermi surface @xmath25 can be linearly approximated by the affine hyperplane @xmath126 and the intersection event @xmath128 between @xmath32 and @xmath126 is approximated by @xmath129 where @xmath130 is the projection of @xmath131 onto @xmath132 parallel to @xmath133 , with @xmath133 the @xmath134-velocity of @xmath32 at @xmath124 ( see figure [ vdr - sp ] with @xmath135 ) .    for finding @xmath130",
    "we need first to find @xmath132 , and for this purpose we can use the jacobian matrix @xmath136 where @xmath137 is the partial derivative with respect to the @xmath138-th coordinate ( note that the derivatives of @xmath139 are easy to estimate numerically ) .",
    "so , @xmath140 is a basis of @xmath132 , where @xmath141 and @xmath142 is a basis of @xmath143 , e.g. the projections onto @xmath143 of the spacelike vectors @xmath144 , @xmath145 and @xmath146 .",
    "then , supposing that the fermi surface @xmath25 is spacelike at @xmath123 , we have that @xmath147 is a basis of @xmath148 , and hence @xmath149 , where @xmath150 are the spatial coordinates of @xmath131 in the above basis .    given @xmath151 , in ( * ? ? ?",
    "* proposition 3 ) it is proved that , in some cases , @xmath152 and consequently , @xmath25 is spacelike at @xmath5 ; for example , in the case of _ stationary observers _ in the schwarzschild spacetime ( see examples [ example1 ] and [ example3 ] ) .",
    "nevertheless , @xmath153 is not @xmath154 in general , as it occurs in the analogous case of _ stationary observers _ in the kerr spacetime ( see examples [ example2 ] and [ example4 ] ) , although it can be checked that the fermi surface @xmath25 remains spacelike .",
    "the next step is finding @xmath128 by means of a newton - raphson method : we find @xmath155 by , and we redefine @xmath124 as the event of @xmath32 with the same coordinate time as @xmath155 ; then , by again , we find another @xmath155 , repeating this process until @xmath155 approximates @xmath128 with the desired accuracy .",
    "the convergence of this method is assured by the next proposition .",
    "[ prop : conv1 ] if the fermi surface @xmath25 is spacelike at @xmath123 and the acceleration of the test particle @xmath32 is bounded , then the newton - raphson method described above produces a sequence of events @xmath156 that converges to @xmath128 with quadratic order for a sufficiently close events @xmath124 and @xmath123 .",
    "we are going to denote @xmath157 as @xmath158 for the sake of simplicity .",
    "working in coordinates @xmath159 , let @xmath32 be parameterized by the coordinate time @xmath95 and let @xmath160 , @xmath161 for @xmath162 .",
    "given @xmath163 , the event @xmath158 is the intersection of the affine hyperplane @xmath126 and the affine line @xmath164 , where the overdot denotes derivation with respect to @xmath95 and `` @xmath165 '' denotes the span .",
    "if @xmath166 is the cartesian equation of @xmath126 ( we can suppose that the coefficient of @xmath95 is @xmath167 because @xmath25 is not timelike ) , then , by algebraic manipulations , we have that the coordinate time of @xmath158 is given by @xmath168 where @xmath169 and @xmath170 for @xmath171 .",
    "it can be proved that @xmath172 because @xmath32 is timelike and @xmath25 is spacelike at @xmath173 , and so the intersection event @xmath158 always exists .    on the other hand ,",
    "if @xmath174 , from the taylor expansion of order @xmath167 of @xmath175 at @xmath176 we have that @xmath177 where @xmath178 and @xmath179 with @xmath180 between @xmath181 and @xmath176 for @xmath171 .",
    "moreover , since @xmath182 , we have that @xmath183 substituting in and taking into account , we get @xmath184 assuming that the acceleration of @xmath32 is bounded and @xmath185 is sufficiently small ( this can be achieved if @xmath124 and @xmath123 are sufficiently close ) , the result holds .    once we obtain @xmath128 , we have to estimate the vector @xmath186 such that the geodesic starting from @xmath4 with initial tangent vector @xmath186 arrives at @xmath128 , i.e. @xmath187 .",
    "note that @xmath186 might not be exactly orthogonal to @xmath13 because @xmath126 does not coincide in general with @xmath25 ( i.e. @xmath128 is an estimation of @xmath41 and they do not coincide in general ) .",
    "re - scaling @xmath122 in order to verify @xmath188 ( for convenience ) and working in coordinates , we can make the linear estimation @xmath189 where @xmath190 was previously computed .",
    "hence , solving the linear system given by we have @xmath191 where @xmath192 are the coefficients of the inverse of the jacobian matrix @xmath193 .    finally , since @xmath194 might not be exactly orthogonal to @xmath13 ( as it happens with @xmath186 )",
    ", we have to redefine @xmath194 projecting it onto @xmath143 , obtaining in this way an estimation of the desired vector @xmath45 .",
    "[ rem : soa ] a higher order approximation based on the taylor expansion of @xmath139 can be applied instead of the linear estimation .",
    "for example , the following quadratic approximation @xmath195 in this case , the coordinates of @xmath186 can be solved from the system of quadratic equations , obtaining an expression equivalent to but involving a second order approximation .",
    "if there is more than one solution for @xmath186 , we have to take the solution such that @xmath196 is `` closest '' to @xmath128 , e.g. that minimizes @xmath197 .",
    "however , in practice , usually it would suffice to take the closest ( in a coordinate sense ) solution to @xmath122 .",
    "let @xmath198 be the geodesic with initial direction @xmath194 .",
    "probably , this new geodesic @xmath198 does not intersect the test particle @xmath32 because we have made estimations , but it should be closer to @xmath32 than the initial geodesic @xmath121 ( see remark [ rem : conv ] for a discussion about convergence ) .",
    "so , applying this method again to the new geodesic , we get other values for @xmath123 , @xmath124 , and @xmath128 , from which we obtain @xmath199 and a geodesic @xmath200 ( with initial direction @xmath199 ) that should be closer to @xmath32 than @xmath198 .",
    "we must repeat this process , obtaining a sequence of geodesics @xmath201 ( with initial directions @xmath202 , see figure [ vdr - sp ] ) , until we reach the desired accuracy or we exceed a certain number of iterations .    summing up , given an observer s event @xmath203 with @xmath134-velocity @xmath13 , the algorithm for finding the relative position @xmath45 of the test particle @xmath32 is as follows :    1 .",
    "choose an initial vector @xmath204 such that the geodesic @xmath121 starting from @xmath4 with initial direction @xmath122 is sufficiently close to the test particle @xmath32 ( in the sense of section [ sec : nearness ] ) .",
    "+ set @xmath135 .",
    "2 .   find @xmath205 and @xmath206 with the same coordinate time that minimizes the distance @xmath125 ( see remark [ rem3.1 ] ) .",
    "+ for @xmath162 we must check that this distance is lesser than the corresponding distance computed for @xmath207 ; if it does not hold , then we should stop the algorithm because it could be a divergence symptom .",
    "3 .   find @xmath128 by means of a newton - raphson method : we find @xmath155 by , and we redefine @xmath124 as the event of @xmath32 with the same coordinate time as @xmath155 ; then , by again , we find another @xmath155 , repeating this process until @xmath155 approximates @xmath128 with the desired accuracy .",
    "a quadratic convergence is assured by proposition [ prop : conv1 ] .",
    "4 .   define @xmath208 ( it is a linear approximation of @xmath209 , see ) , where @xmath202 is re - scaled in order to hold @xmath210 .",
    "alternatively , for a second order approximation , we can define @xmath211 by solving a system of quadratic equations ( see remark [ rem : soa ] ) .",
    "redefine @xmath211 as its projection onto @xmath143 : @xmath212 .",
    "set @xmath213 .",
    "repeat the process ( steps 2 , 3 , 4 , 5 ) with the geodesic @xmath201 starting from @xmath4 with initial direction @xmath202 , until we reach the desired accuracy .",
    "otherwise , we should stop the algorithm if we arrive at a predetermined maximum number of iterations .",
    "if the desired accuracy has been achieved , we can apply this algorithm again for another event @xmath214 of the observer .",
    "then , the new initial vector @xmath122 should be chosen as the vector with the same coordinates as the corresponding final vector @xmath202 computed for the previous event @xmath215 . in this case , choosing a sufficiently small time step @xmath216 assures convergence ( see remark [ rem : conv ] ) , and `` differentiability '' of @xmath67 ( although we obtain a discrete vector field ) in the case of non - convex normal neighborhoods ( see section [ nonconvex ] ) .",
    "[ rem : conv ] with respect to the convergence , in practice , this algorithm has been tested in many spacetimes with different test particles and observers , and it numerically converges in all of them with quadratic order .",
    "this accords with the fact that , if we compute @xmath128 exactly ( in the 3rd step ) and define @xmath217 ( in the 4th step ) , the algorithm has a newton - raphson structure .",
    "but , in general , it is not assured that @xmath218 is closer to @xmath32 than @xmath201 .",
    "if this property does not hold , then convergence is not guaranteed .",
    "determining theoretical conditions for assuring convergence in a general case is a hard open problem .",
    "for this purpose , proposition [ prop : conv1 ] is the first step .",
    "nevertheless , if the algorithm converges at the observer s event @xmath203 , then , applying differentiability arguments , it is assured that there exists a sufficiently small time step @xmath219 such that the algorithm also converges at @xmath220 taking the new initial vector @xmath122 as the vector with the same coordinates as the corresponding final vector @xmath202 computed for the previous event @xmath4 .",
    "( left ) and the estimations of @xmath55 ( right ) when @xmath123 and @xmath124 ( that are events with the same coordinate time ) are close . in this case",
    ", all the tangent spaces are identified by means of the coordinate system and provide an affine structure around @xmath123 .",
    "right : the past - pointing horismos submanifold @xmath29 is approximated by the affine hyperplane @xmath221 .",
    "note that @xmath222 , where @xmath223 is the tangent vector of @xmath224 at @xmath123.,scaledwidth=75.0% ]    analogously , in the framework of lightlike simultaneity , the initial vector @xmath225 must be lightlike and past - pointing , and the initial geodesic is named @xmath226 .",
    "then , we estimate the intersection of the test particle with the affine hyperplane @xmath221 using an expression analogous to : @xmath227 where @xmath130 is the projection of @xmath131 onto @xmath228 parallel to @xmath133 , with @xmath133 the @xmath134-velocity of @xmath32 at @xmath124 ( see figure [ vdr - lg ] with @xmath135 ) .",
    "since @xmath29 is lightlike at @xmath5 ( see remark [ rem : lghor ] below ) , we have that @xmath130 is always well - defined .",
    "[ rem : lghor ] given @xmath229 , in ( * ? ? ?",
    "* proposition 3 ) it is proved that @xmath230 and hence , the past - pointing horismos submanifold is always lightlike ; in fact , we can write @xmath231 where @xmath60 is the tangent vector of the light ray from @xmath5 to @xmath4 .",
    "so , @xmath232 where @xmath223 is the tangent vector of @xmath226 at @xmath123 . note that @xmath233 because @xmath223 is lightlike and @xmath133 is timelike .",
    "next , we have to find @xmath234 applying a newton - raphson method analogously to the spacelike case",
    ". it can be proved analogously to proposition [ prop : conv1 ] that this part of the algorithm has a quadratic order of convergence , but we only need the hypothesis on the bounded acceleration because @xmath29 is always lightlike ( see remark [ rem : lghor ] ) .    after this",
    ", we have to estimate the vector @xmath235 . for this purpose ,",
    "we re - scale @xmath236 in order to verify @xmath237 and , working in coordinates analogously to , we obtain @xmath238 where , in this case , @xmath239 are the coefficients of the inverse matrix of @xmath240 . a second order approximation can be deduced analogously to remark [ rem : soa ] replacing , in expression , @xmath128 , @xmath186 , and @xmath122 with @xmath234 , @xmath241 , and @xmath236 respectively .    finally , since @xmath242 might not be exactly lightlike ( as it happens with @xmath241 ) , we have to redefine @xmath242 projecting it onto @xmath243 , obtaining in this way an estimation of the desired vector @xmath60 .",
    "for example , we can redefine it as the past - pointing lightlike vector with the same spatial coordinates as the original @xmath242 ( i.e. a projection parallel to @xmath244 ) .",
    "the steps of the algorithm in the framework of lightlike simultaneity are analogous to those exposed at the end of section [ sec:3.2 ] in the framework of spacelike simultaneity , replacing @xmath202 , @xmath143 , @xmath201 , @xmath155 , and @xmath128 with @xmath245 , @xmath243 , @xmath224 , @xmath246 , and @xmath234 respectively . in the 3rd step",
    ", we can compute @xmath246 by means of expression .",
    "moreover , in the 5th step , we have to project @xmath247 onto @xmath243 as it is explained in the above paragraph .      working in a convex normal neighborhood",
    ", there is no problem in the determination of the events @xmath123 ( in the geodesic @xmath201 or @xmath224 ) and @xmath124 ( in the test particle @xmath32 ) introduced in the beginning of section [ sec:3.2 ] , because they globally minimizes the distance between events of the geodesic and the test particle in surfaces of constant coordinate time ( see remark [ rem3.1 ] ) .",
    "but if we work in a non - convex normal neighborhood , then there could be different ( or none ) possibilities of relative position of the test particle with respect to the same event @xmath4 of the observer and , in this case , each possibility of relative position drives to a different local minimum of this distance .",
    "hence , for determining a `` suitable '' pair @xmath248 we have to search the local minimum that corresponds to a `` suitable '' relative position , according to the previously computed relative positions .",
    "let us explain it in more detail : suppose that we have previously applied the algorithm in @xmath249 and we have obtained a relative position @xmath250 .",
    "then , applying the algorithm in @xmath251 , we say that a relative position @xmath252 is _ suitable _ ( according to @xmath250 ) if @xmath250 and @xmath252 are vectors of a ( differentiable ) vector field @xmath67 of relative positions . if the time step @xmath216 is sufficiently small , then it is assured that there exists at least one suitable @xmath252 .",
    "if there are several relative positions , a suitable one must be close ( in a coordinate sense ) to @xmath250 , and so it can be chosen as a relative position that , for example , minimizes the coordinate distance @xmath253 .",
    "if there are several suitable relative positions , then any of them are valid . in this case , the output can be controlled adding some desired restrictions .",
    "for example , in the case of an equatorial circular geodesic test particle and an equatorial stationary observer in schwarzschild spacetime ( where there is gravitational lensing , see example [ example3 ] ) , it could be desirable that all the involved geodesics ( @xmath201 and @xmath224 ) were also equatorial ; we can impose this condition and so the relative positions @xmath67 and @xmath68 have zero @xmath254-component . in practice , a _ suitable _ pair @xmath248 for @xmath255 satisfies that the sum of the coordinate distances between them and the corresponding pair for @xmath256 is small , given a sufficiently small time step @xmath216 .",
    "taking all this into account , the algorithm presented in section [ sec3 ] returns one possibility of a discretized version of a relative position vector field @xmath67 or @xmath68 , provided that there exists a relative position in the first event of the observer in which we apply the algorithm and we use a sufficiently small time step in the observer . from this output we obtain one discretized version of the ( differentiable ) vector fields @xmath69 , @xmath78 , @xmath70 , or @xmath79 .",
    "the algorithm has been tested in several spacetimes with different observers and test particles , obtaining very good results in computation time and accuracy .",
    "we present here the most representative examples in schwarzschild and kerr spacetimes , using a test particle with equatorial geodesic orbit and stationary observers .    to sum up , given an observer and a test particle , our objective is to find @xmath45 ( spacelike simultaneity ) or @xmath60 ( lightlike simultaneity ) at a given event @xmath4 of the observer ( see figure [ diagram2 ] ) . to do this , we need an initial vector @xmath122 or @xmath236 that is supposed to be close ( in a coordinate sense ) to @xmath45 or @xmath60 respectively ; but first , we are going to show by means of examples [ example1 ] and [ example2 ] the rate of convergence of this method using an initial vector not necessarily close to the objective vector .",
    "moreover , we are going to apply the second order approximation proposed in remark [ rem : soa ] and compare with the usual linear method .",
    "[ example1 ] the schwarzschild metric in spherical coordinates @xmath257 is given by the line element @xmath258 where the parameter @xmath259 is interpreted as the mass of the gravitating object , @xmath260 is the radial coordinate , and @xmath261 . from now on we are going to suppose that the coordinates hold these restrictions and @xmath262 . in the framework of this coordinate system , a",
    "_ stationary observer _ is an observer with constant spatial coordinates .",
    "note that stationary observers are not geodesic , but they are useful in the description and interpretation of the schwarzschild spacetime .",
    "given a stationary observer at @xmath263 , @xmath264 , @xmath265 , and a test particle with equatorial circular geodesic orbit with @xmath266 , @xmath267 , @xmath268 at @xmath269 , we are going to check the algorithm for computing @xmath45 and @xmath60 at @xmath270 using an initial spacelike direction @xmath271 ( orthogonal to the @xmath134-velocity of the observer at @xmath4 ) , and using an initial past - pointing lightlike direction @xmath272 , respectively .",
    "note that these initial directions are not too close of the objective vectors @xmath45 and @xmath60 , but despite this , the method works well .",
    "moreover , applying the second order approximation of remark [ rem : soa ] gives better results , but it doubles the computation time because we have to solve a system of quadratic equations ( anyway , the computation time is a few seconds ) . the results are shown in tables [ tab1 ] , [ tab1b ] , [ tab2 ] , [ tab2b ] ( until reaching a relative error of order @xmath273 or less ) and figure [ orb_schw_4 - 8 ] .",
    "-plane of the elements involved in example [ example1 ] .",
    "the stationary observer launches an initial geodesic from @xmath270 with initial direction @xmath271 ( left ) and @xmath274 ( right ) .",
    "it is shown how the successive iterations of the algorithm return geodesics that are getting closer to the desired intersection point with the test particle , @xmath41 or @xmath275 ( see figure [ diagram2]).,scaledwidth=80.0% ]    .example [ example1 ] .",
    "successive iterations of the algorithm for computing @xmath45 .",
    "the event @xmath276 approximates the intersection event @xmath41 .",
    "the relative error corresponds to the sum of the relative errors of each coordinate between @xmath276 and @xmath277 ( see figure [ orb_schw_4 - 8 ] left ) . [",
    "cols=\"<,<,<,<\",options=\"header \" , ]     next , we are going to give some examples in schwarzschild and kerr spacetimes about computing the relative velocities along an observer . in the figures ,",
    "we make `` retarded comparisons '' ( see @xcite ) of their moduli , i.e. we compare velocities that are measured at the same event of the test particle .",
    "this is important if we want to make a fair comparison of velocities in the framework of spacelike simultaneity with velocities in the framework of lightlike simultaneity , because the event of the test particle at which the velocity is measured depends on the chosen simultaneity : @xmath41 ( kinematic and fermi ) or @xmath55 ( spectroscopic and astrometric ) , see figure [ diagram2 ] .",
    "so , we plot the modulus of a relative velocity as function of @xmath278 ( kinematic and fermi ) or @xmath279 ( spectroscopic and astrometric ) , that are the time coordinates of @xmath41 and @xmath55 respectively .",
    "all the numerical data has been computed with a relative error less than @xmath273 .",
    "[ example3 ] in the schwarzschild metric , let us consider the stationary observer and the test particle of example [ example1 ] , but now we are going to suppose that it has @xmath280 at @xmath269 ( i.e. the observer , the test particle and the singularity @xmath281 are aligned at @xmath269 ) .",
    "this problem has not been previously studied analytically due to its complexity .",
    "note that in this case , we do not work in a convex normal neighborhood and so there is not a unique kinematic , fermi , spectroscopic and astrometric relative velocities , depending on different geodesics joining the observer and the test particle ( i.e. different choices of @xmath6 in the spacelike case , or @xmath23 in the lightlike case , see figure [ diagram2 ] ) .",
    "for example , if the test particle is at spatial coordinates @xmath266 , @xmath282 , @xmath280 , the observer and it can be joined by geodesics , @xmath6 or @xmath23 , giving whole turns around the black hole or not . in figure",
    "[ schw_4 - 8 ] there are represented the moduli of the corresponding relative velocities in the case of equatorial geodesics joining the observer and the test particle following the convention that @xmath283 also indicates the number of turns ( and their direction ) around the black hole : for example , for @xmath280 , the geodesic goes directly from the observer to the test particle ; on the other hand , for @xmath284 the geodesic gives an equatorial whole turn counter - clockwise around the black hole before arriving at the test particle ( see figure [ fig4b ] ) .",
    ", @xmath267 and @xmath280 at @xmath269 , with respect to a stationary observer at @xmath263 , @xmath264 and @xmath265 , in the schwarzschild metric with @xmath262 .",
    "since it is a retarded comparison , we take as abscissa @xmath278 ( for kinematic and fermi ) and @xmath279 ( for spectroscopic and astrometric ) , that are the time coordinates of the events @xmath41 and @xmath55 respectively ( i.e. the events of the test particle at which the corresponding velocities are measured , see figure [ diagram2 ] ) .",
    "the vertical lines correspond to different values of @xmath283 ( the @xmath285-coordinate of @xmath41 or @xmath55 ) , and the geodesics joining the observer and the test particle have been restricted to be equatorial.,scaledwidth=90.0% ]    -plane of different equatorial geodesics joining the test particle and the observer at @xmath4 in example [ example3 ] .",
    "the parameter @xmath283 represents the @xmath285-coordinate of @xmath41 or @xmath55 , and indicates the number of turns of the geodesic around the black hole.,scaledwidth=100.0% ]    at @xmath269 , we have taken initial vectors @xmath286 and @xmath287 ( for being a past - pointing lightlike vector at @xmath288 ) , but this is not important because in this case the algorithm converges quickly also for non - nearby initial vectors and so it is not necessary to apply the second order approximation of remark [ rem : soa ] .",
    "the computations have been done using a time step ( in the observer ) of @xmath289 , and the number of iterations needed at each time ( for reaching the desired relative error @xmath273 ) is at most @xmath290 .",
    "so , the linear algorithm works very well in this case .    considering stationary observers with different radial",
    "coordinate @xmath291 and @xmath292 ( see figures [ schw_4 - 4 ] and [ schw_4 - 3 ] respectively ) , we observe that @xmath293 remains constant and equal to @xmath294 .",
    "this numerical result has motivated a work @xcite where this property is theoretically proved in general : in the schwarzschild metric , the modulus of the kinematic relative velocity of a test particle with circular geodesic orbit at radius @xmath295 with respect to any stationary observer is constant and equal to @xmath296 .    , but taking @xmath291.,scaledwidth=90.0% ]    , but taking @xmath292.,scaledwidth=90.0% ]    moreover , it can be checked that @xmath297 tends to @xmath167 when @xmath298 , and using expression , we can compute the corresponding frequency shift , as it is seen in figure [ shift_schw_4 - 3 - 4 - 8 ] .",
    "( see figures [ schw_4 - 8 ] , [ schw_4 - 4 ] and [ schw_4 - 3]).,scaledwidth=65.0% ]    [ example4 ] in the kerr metric , let us consider the stationary observer and the test particle of example [ example2 ] , but supposing that it has @xmath280 at @xmath269 , as in example [ example3 ] .",
    "analogously to this example , in figure [ kerr_4 - 8 ] there are represented the moduli of the corresponding relative velocities . comparing with the analogous problem in the schwarzschild spacetime studied in example [ example3 ] and figure [ schw_4 - 8 ]",
    ", it can be observed that @xmath293 does not remain constant .",
    "moreover , it also draws attention to the fact that @xmath297 does not tend to @xmath167 when @xmath299 ; in fact , it can be checked that it is decreasing and tends to a value @xmath300 .    ,",
    "@xmath267 and @xmath280 at @xmath269 , with respect to a stationary observer at @xmath263 , @xmath264 , @xmath265 , in the kerr metric with @xmath262 , @xmath301 .",
    "the vertical lines correspond to different values of @xmath283 ( the @xmath285-coordinate of the test particle at @xmath41 or @xmath55 ) , and the geodesics joining the observer and the test particle have been restricted to be equatorial.,scaledwidth=90.0% ]    finally , in figure [ shift_schw - kerr ] it is shown the frequency shift of the test particle with respect to the observer , compared with the frequency shift of the analogous problem in the schwarzschild spacetime .",
    "of note is the fact that , in the kerr spacetime , the shift is greater than @xmath167 for a sufficiently negative @xmath283 ; in fact , it tends to @xmath302 approximately when @xmath303 .",
    "hence , in this case , an approaching ( see @xcite ) .",
    "] test particle has redshift instead of blueshift .",
    "( see figure [ kerr_4 - 8 ] ) and in the analogous problem in the schwarzschild spacetime ( see figure [ schw_4 - 8 ] and figure [ shift_schw_4 - 3 - 4 - 8 ] with @xmath263 ) .",
    "the frequency shifts are plotted as functions of @xmath283 ( the @xmath285-coordinate of the test particle at @xmath55 ) in order to make a fair comparison.,scaledwidth=80.0% ]",
    "first , we have generalized the concepts of the relative velocities introduced in @xcite to non - convex normal neighborhoods ( see section [ sec2.1 ] ) , focusing on what is minimally necessary to make sense of the corresponding definitions . as a result",
    ", we can now apply this theory of relative velocities to a wide range of scenarios , including those with gravitational lensing or caustics .",
    "then , we have developed an algorithm for computing relative velocities of a test particle with respect to an observer , based on finding the fermi and observational coordinates of the test particle ; hence , this method can be applied only for this purpose , allowing the fast computation of fermi and observational coordinates with high accuracy .    with respect to fermi coordinates ,",
    "the objective of the paper @xcite is also to find the fermi coordinates of an event in a general spacetime , calculating the general transformation formulas from arbitrary coordinates to fermi coordinates , and vice versa .",
    "but the methods are not the same :    * in @xcite , the fermi coordinates are given in the form of taylor expansions .",
    "hence , for increasing accuracy , we have to add terms of higher order , and it could be very complex to achieve a high accuracy for distant events . * in this work , we use an iterative algorithm .",
    "so , for increasing accuracy , we have to make more iterations ( provided there is convergence , see remark [ rem : conv ] ) , and this does not imply additional difficulty .",
    "moreover , the algorithm proposed in this work is also valid in non - convex normal neighborhoods where there is not uniqueness of fermi coordinates ( see section [ nonconvex ] ) : depending on the initial vector @xmath122 you can get different relative positions @xmath45 of the same test particle at a given observer s time .",
    "nevertheless , the method given in @xcite is a powerful tool in the theoretical study of fermi coordinates , while the algorithm introduced here is designed to be implemented on computers .",
    "so , they are complementary and , for example , we can use the taylor expansions given in @xcite for choosing the initial vector @xmath122 in the first execution .",
    "moreover , if the algorithm does not converge ( see remark [ rem : conv ] ) , then the taylor expansions are a valuable alternative .",
    "with respect to observational coordinates , they are used for the study of gravitational lensing or frequency shifts ( e.g. the pioneer anomaly ) , and they describe how we observe the universe . in this field , the numerical relativity is becoming more and more important due to the existence of complex models , such as dark matter models or multiple star systems .",
    "in ( * ? ? ?",
    "* proposition 3.3 ) it is proved that , working in a convex normal neighborhood , @xmath304 and @xmath305 can be computed in terms of @xmath4 , @xmath41 , @xmath275 , @xmath13 , @xmath306 , @xmath48 , @xmath54 , @xmath45 , @xmath61 , and hence we do not need to know @xmath67 or @xmath68 around @xmath4 , contrary to what is expected from and . this computation is done using a coordinate system @xmath307 , obtaining @xmath308 where the coordinates of vectors @xmath309 , @xmath310 , @xmath311 are given by @xmath312 with @xmath313 where @xmath314 denotes @xmath315 ( or equivalently @xmath316 ) , and @xmath317 on the other hand @xmath318 where the coordinates of vectors @xmath319 , @xmath320 , @xmath321 are given by @xmath322 with @xmath323 and @xmath324 note that @xmath325 is given in terms of @xmath4 , @xmath13 and @xmath306 : @xmath326 expressions and of @xmath304 and @xmath305 are not explicitly shown in @xcite , but they can be deduced from the proof of proposition 3.3 .    nevertheless , numerically it is difficult to compute the vectors @xmath309 and @xmath319 with high accuracy , concretely the derivatives of @xmath327 and @xmath328 .",
    "for example , if we want to compute @xmath329 , we are supposed to know @xmath41 and the vector @xmath330 , i.e. the relative position @xmath45 , that can be estimated by means of the algorithm exposed in section [ sec:3.2 ] .",
    "then , given a small @xmath331 , we launch a geodesic from the event @xmath332 with coordinates @xmath333 ( i.e. the same coordinates as @xmath4 but the @xmath334-th coordinate is @xmath335 ) and initial tangent vector @xmath45 ( actually , the vector in @xmath336 with the same coordinates as @xmath45 ) .",
    "since @xmath337 is small , this geodesic is `` close '' , because it is not assured that the new geodesic intersects the leaf of constant coordinate time of @xmath41 ; for example , a `` nearness '' based on the sum of the spatial coordinate distance with the temporal coordinate distance . ] to @xmath41 , and so there is an event @xmath123 of the geodesic `` close '' to @xmath41 .",
    "so , assuming an affine structure , we have to parallel transport the vector @xmath338 from @xmath123 to @xmath332 along the geodesic , and add this vector to the current initial vector @xmath45 , obtaining a new initial vector whose corresponding geodesic will be `` closer '' to @xmath41 . repeating this process , we can estimate the initial vector of the geodesic passing through @xmath41 with the desired accuracy and then , we can evaluate @xmath329 comparing this initial vector with @xmath45 .",
    "analogously , for computing the derivatives of @xmath328 , we are supposed to know @xmath55 and the vector @xmath339 , whose projection onto @xmath14 is the observed relative position @xmath61 , that can be estimated by means of the algorithm exposed in section [ sec:3.3 ] .    concluding , this method let us find @xmath304 and @xmath305 computing @xmath67 and @xmath68 only at @xmath4 , but the original method based on definitions and ( in which @xmath67 and @xmath68 are computed around @xmath4 ) is obviously faster and more accurate because it requires a far fewer number of operations . moreover , if we do not work in a convex normal neighborhood , expressions and are not strictly valid because the vectors @xmath309 , @xmath310 , @xmath319 , and @xmath320 are not well - defined in general .",
    "s. braeck , o. elgary . a physical interpretation of hubble s law and the cosmological redshift from the perspective of a static observer .",
    "* 44 * ( 2012 ) , 26032610 ( arxiv : http://arxiv.org / abs/1206.0927[1206.0927 ] ) .",
    "m. soffel , _",
    "et al_. the iau 2000 resolutions for astrometry , celestial mechanics and metrology in the relativistic framework : explanatory supplement .",
    "j. _ * 126 * ( 2003 ) , 26872706 ( arxiv : http://arxiv.org / abs / astro - ph/0303376[astro - ph/0303376 ] ) .",
    "d. klein , e. randles .",
    "fermi coordinates , simultaneity , and expanding space in robertson - walker cosmologies .",
    "henri poincar _ * 12 * ( 2011 ) , 303328 ( arxiv : http://arxiv.org / abs/1010.0588[1010.0588 ] ) .      v. j. bols , s. havens , d. klein .",
    "relative velocities , geometry and expansion of space . to appear in _ recent advances in cosmology _ , ( 2012 ) nova publishers ( arxiv : http://arxiv.org / abs/1210.3161[1210.3161 ] ) .",
    "v. j. bols .",
    "kinematic relative velocity with respect to stationary observers in schwarzschild spacetime .",
    "_ j. geom .",
    "( 2013 ) http://dx.doi.org/10.1016/j.geomphys.2012.12.005[10.1016/j.geomphys.2012.12.005 ] ( arxiv : http://arxiv.org / abs/1205.0884[1205.0884 ] ) ."
  ],
  "abstract_text": [
    "<S> we present a numerical method for computing the _ fermi _ and _ observational coordinates _ of a distant test particle with respect to an observer . </S>",
    "<S> we apply this method for computing some previously introduced concepts of relative velocity : _ kinematic _ , _ fermi _ , _ spectroscopic _ and _ astrometric _ relative velocities . </S>",
    "<S> we also extend these concepts to non - convex normal neighborhoods and we make some convergence tests , studying some fundamental examples in schwarzschild and kerr spacetimes . </S>",
    "<S> finally , we show an alternative method for computing the fermi and astrometric relative velocities . </S>"
  ]
}