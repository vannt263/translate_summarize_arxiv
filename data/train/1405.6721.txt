{
  "article_text": [
    "early large - scale , cosmological simulations of galaxy formation in the @xmath0cdm paradigm suggested that the spherically - averaged density profiles of dark matter halos follow a universal profile across a large dynamic range in mass @xcite .",
    "since then , higher resolution simulations  both with and without baryons  have produced dark matter halos that ( 1 ) are permeated with substructure on many scales , ( 2 ) are triaxial in shape , and ( 3 ) have shapes and orientations that vary with radius @xcite .",
    "dark - matter - only simulations produce triaxial halos @xcite with large density fluctuations @xcite .",
    "inclusion of baryons tends to soften the triaxiality and graininess in the inner galaxy through a combination of dissipative infall @xcite or cooling @xcite .",
    "these processes combined with the gravity from a baryonic disk or ellipsoid can act to make the inner halo more oblate or spherical , however they do not seem to erase the clumpy , triaxial nature of the outer halo ( e.g. , * ? ? ?",
    "this can lead to radially - dependent axis ratios , orientation , and smoothness , and suggests that the true mass distributions around milky way - like galaxies are not easily represented by simple , time - independent potentials .",
    "methods that seek to measure the gravitational potentials around such galaxies must be flexible enough to handle generic potential forms where finding simple analytic approximations or computing actions may not be possible .",
    "the bulk of the baryonic matter in galaxies spans roughly 5 - 10% of the spatial extent of the host dark matter halo .",
    "hence , the brightest and most easily observable components of a galaxy are sensitive to the inner portion of the host halos mass distribution .",
    "for example , the rotation curves of disk galaxies trace the inner mass with exquisite sensitivity since matter in disks can be assumed to move on nearly circular orbits .",
    "measurements of the dark matter distribution at large radii is complicated by the low density of visible tracers , observational difficulties of measuring kinematics of stars at large distances , and unknown orbits . around external galaxies ,",
    "the extended mass distribution has been studied using a variety of approaches ( see * ? ? ? * for a a complete and detailed review ) .",
    "for example , the kinematics of tracer populations such as globular clusters or planetary nebulae can be used to derive mass estimates under the assumptions that these satellite systems are on random orbits and are well - mixed in orbital phase ( early investigations include * ? ? ? * ; * ? ? ? * ) .",
    "simple , parameterized fits to both the mass and orbit distribution have been simultaneously constrained using such data ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "alternatively , the statistical properties of gravitationally lensed background sources around a galaxy can be used to constrain the _ projected _ shape , orientation , and radial profile of mass ( see , for example , the lens structure and dynamics survey described in * ? ? ?",
    "of course , lensing reconstructions can only be performed for galaxies which closely intersect our line of sight to background sources , but the advent of large photometric catalogues has allowed automatic searches for such chance alignments and significant increases in the number of objects studied in this way ( e.g. the sloan lens acs survey , see * ? ? ?",
    "* ) .    within the milky way our unique vantage point allows us a three - dimensional view of stars within our own dark matter halo .",
    "our proximity allows us to use individual stars as kinematic tracers and hence build much larger samples that probe deeper into the halo than the globular cluster and planetary nebula studies of external galaxies .",
    "for example , @xcite used halo bhb stars selected from the sloan digital sky survey ( sdss ; * ? ? ?",
    "* ) as a random tracer population to measure the mass and slope of a power - law fit to the potential .",
    "such studies assume that the tracer orbits are randomly sampled from a smooth distribution function and are fully phase mixed",
    ". however , large photometric surveys such as the sdss and 2mass @xcite have discovered copious amounts of substructure  in streams and kinematic associations of stars  in the milky way halo ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , thus demonstrating that the stellar distribution is neither on random orbits nor fully phase - mixed .",
    "substructure in the form of stellar streams and clouds is known to bias mass and velocity inferences from random tracer methods by several tens of percent @xcite .",
    "another approach to using halo stars as potential measures is to exploit the non - random nature of halo .",
    "tidal streams are dynamically cold systems  debris typically have small distributions of energy and angular momentum  and thus require orders of magnitude fewer tracers than a random sample to get constraints of comparable accuracy to jeans analysis .",
    "for example , in the simplest case we might assume that debris stars are actually still on the same orbit as their progenitor system ( a _ wrong _ assumption , see below ) .",
    "this information about the orbits combined with measurements of the full - space velocities @xmath1 at different points @xmath2 in the structure ( e.g. , along a stream ) would give us a direct measure of differences in a potential , @xmath3 .",
    "* lm10 ) used n - body simulations of the disruption of the sgr dwarf galaxy to simultaneously fit a model to the available data on the debris stars and a triaxial , analytic milky way potential . by varying parameters of the milky way potential , they found `` best - fit '' parameters by comparing the properties of observed sgr stars to their simulated debris .",
    "the computational costs of running n - body simulations limited their search to a grid of potential parameters and forced the authors to fix many other parameters ( e.g. , properties of the disk and bulge ) .",
    "nevertheless , they were able to constrain the 3d shape that their assumed potential model must take in order to best represent the milky way out to @xmath470 kpc and found that the best - fitting halo has a nearly oblate ( only mildly triaxial ) shape flattened in a direction close to the sun - galactic center line . though an unlikely orientation for the halo  @xcite find that the disk of the milky way would not remain stable in such a configuration",
    " lm10 showed that the data is at a state where such inference is possible .",
    "the computational costs associated with n - body simulations has motivated the development of many methods that approximately model tidal streams .",
    "the simplest alternative is to fit a single orbit to observed debris ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . though this is known to be incorrect and leads to biases in inferred properties of the underlying potential ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , @xcite and @xcite have used orbit fitting to demonstrate the power of combining multiple streams in dynamical inference . to account for the offset between the orbit of the progenitor and the orbits of the debris stars ,",
    "methods have been proposed that add some dispersion or offset around a single orbit either in phase space ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) or action - angle coordinates @xcite .",
    "other statistical methods have been proposed @xcite that may prove powerful when applied to , for example , data from the _ gaia _ mission , where full 6d coordinates will be known for large samples of stars in the halo  and therefore many debris structures  but stream membership is not known for all stars .    motivated by the strengths of previous work , we identify a minimum set of issues that any approximate stream model or potential recovery method should address ( see section  [ sec : discussion ] for a more detailed discussion of these points in the context of this work ) :    1 .",
    "* observational uncertainties : * the known debris structures are @xmath510 kpc from the sun where distance and proper motion measurement errors are significant . thus it is critical for any method that uses tidal debris to incorporate observational uncertainties and missing dimensions in a consistent and justified way .",
    "form of the potential : * there is large uncertainty in the radial profile , shape , orientation , and graininess of the outer halo and the constancy of these parameters over distance .",
    "properly describing the potential may require non - parametric techniques or complex analytic functions so the method should not rely on the existence of or ability to compute conserved orbital properties such as actions .",
    "* multiple debris structures : * near - future photometric surveys such as _ gaia _ and the _ lsst _ will likely discover many new streams and kinematic associations of stars .",
    "potential recovery methods should be able to simultaneously use multiple streams and incorporate other dynamical constraints .",
    "comparing models to data : * matching generated streams to observed stellar densities is difficult ; models that rely on this must account for observational biases , internal properties of the progenitor , and background halo stars .",
    "* computational expense : * full n - body simulations are expensive to run ; incorporating an n - body simulation into a likelihood function evaluation and then performing a parameter search would be computationally intensive and , presently , intractable .    in @xcite , we introduced a simple method based on the work of @xcite for using individual stars associated with tidal debris combined with knowledge about the mass and orbit of the progenitor to constrain properties of the host galaxy potential .",
    "the method exploits the relationship between the phase - space distribution of debris and ( measurable ) properties of the progenitor system ( e.g. , the tidal radius and escape velocity ) .",
    "specifically , a better potential is one in which orbits of test particle stars ( integrated backwards from their present position ) came close ( within the tidal radius in position , and escape velocity in velocity ) to the orbit of the progenitor at some time in the past .    in this paper",
    ", we present a fully probabilistic model ( ` rewinder ` ) for tidal streams that builds on these simple scalings , which depend only on the mass and orbit of the progenitor and parent potential . by `` probabilistic model '' we mean a justified , parametrized likelihood function with priors on the parameters . `",
    "rewinder `  relies on numerical orbit integration in ordinary phase - space and can thus incorporate arbitrarily complex forms for the parent potential ( such as time dependence and significant substructure ) .",
    "individual stars are constraints on the potential , thus ` rewinder `  can handle very small samples of well - measured stars ( e.g. , 4 - 16 ) .",
    "incorporating multiple streams , debris structures , and other kinematic information is trivial but will be explored in future work .    in section  [ sec : sims ] we describe a suite of n - body simulations that span a range of progenitor masses on a characteristic , mildly eccentric orbit and then use them in section  [ sec : method ] to motivate a new , flexible model for tidal streams that works entirely in phase - space . in section  [ sec : experiments ] we demonstrate how ` rewinder `  can be used to measure properties of a non - trivial galactic potential by performing several experiments with simulated observations of data from n - body simulations . in section  [ sec : discussion ] , we discuss the results of these experiments and the extent to which we address the above points 1 - 5 .",
    "we conclude in section  [ sec : conclusion ] .",
    "we performed a set of n - body simulations with the self - consistent field ( scf ) basis function expansion code @xcite to build realistic models of streams for studying the phase - space distribution of debris as it is stripped from its progenitor .",
    "we later use one of these simulations to test ` rewinder ` . in each simulation , a @xmath6 particle nfw - profile satellite was inserted at the apogalacticon of its orbit in a static , multi - component galaxy with a triaxial host halo , described below .",
    "the satellite was evolved first in isolation , then the host potential was turned on slowly over 10 satellite internal dynamical times to reduce artificial gravitational shocking .",
    "the initial position and velocity was obtained by integrating the orbit of the sagittarius dwarf galaxy from present - day coordinates @xmath7 @xcite backwards for @xmath46 gyr .",
    "the n - body satellite was then reintegrated from that initial position for the same interaction time and number of time - steps .",
    "this orbit has its apogalacticon at approximately 59 kpc and perigalacticon near 12 kpc with an average orbital period of 930 myr , although all of these quantities vary over the course of the simulation due to the halo s triaxiality .",
    "total energy is conserved to @xmath42% of the satellite internal potential energy .    to capture the character of streams across a range of merger mass ratios , four satellites with masses @xmath8 , where m is the mass enclosed within 35 nfw scale radii , were evolved in the setup described above .",
    "their scale radii , @xmath9 , were adjusted to maintain a constant density across all simulations which results in identical fractional mass loss rates : 74% of the initial mass is lost by the end of each simulation .",
    "the base value is @xmath10 kpc at @xmath11 .",
    "we take care to record the time at which each particle is unbound from the satellite in the simulations : we locate the position of the remnant iteratively by first calculating the satellite potential with all particles , removing particles with kinetic energies sufficient to escape , then recalculate the potential without those particles until the system converges .",
    "there is no spatial restriction on where a particle may become unbound and all particles ( both bound and unbound ) contribute their gravity during normal time - steps , presuming that they are resolved by the basis functions .    in all simulations ,",
    "the host potential is taken to be a three - component sum of a miyamoto - nagai disk @xcite , hernquist spheroid , and a triaxial , logarithmic halo ( e.g. , * ? ? ?",
    "* ) : @xmath12 where @xmath13 , @xmath14 , and @xmath15 are combinations of the @xmath16 and @xmath17 axis ratios ( @xmath18 , @xmath19 ) and orientation of the halo with respect to the baryonic disk ( @xmath20 ) : @xmath21 the total potential then is just @xmath22        we use this potential not because we think it is a realistic representation of the galactic potential , but because successful inference with this potential demonstrates that it is possible to recover information about non - trivial potential forms .",
    "figure  [ fig : potential ] shows equipotential slices in the galactic x - z plane ( y=0 ) and y - z plane ( x=0 ) for a few choices of @xmath18 , @xmath23 , and @xmath20 while holding all other parameters fixed , as described in the figure caption .",
    "the potential parameters used for the simulations are shown in the `` truth '' column of table  [ tbl : params ] .",
    "` rewinder `  integrates stars and the progenitor back from their present - day , observed positions to the time at which they become unbound from the satellite , where we evaluate the likelihood for each star .",
    "below we ( 1 ) motivate a simple model for the debris just as it disrupts and ( 2 ) present this idea within a probabilistic framework for incorporating observational uncertainties and missing data . for a satellite galaxy orbiting within a static host potential , mass loss is driven by a combination of tidal stripping by the steady tidal field of the parent system and tidal shocking by the rapidly changing tidal field as the progenitor system moves through pericenter ( e.g. , * ? ? ?",
    "on a mildly eccentric orbit , the tidal shocking is subdominant to the steady disruption .",
    "the interplay between these two processes as a function of orbital properties is outside the scope of this paper and will be explored in future work ; we focus here on the slow removal of stars by steady tidal forcing .",
    "consider a point - mass satellite with mass @xmath24 on a circular orbit with frequency @xmath25 around a more massive `` host '' mass @xmath26 ( the  restricted three - body problem  ; e.g. , ",
    "8.3 * ? ? ?",
    "in a frame rotating with the orbital frequency of the satellite , the satellite remains fixed and the static , effective potential around the satellite has ( amongst others ) two unstable optima located around galactocentric radii @xmath27 , where @xmath28 is the orbital radius of the satellite and @xmath29 is the jacobi or tidal radius @xmath30 particles that would be bound to the satellite in isolation may have enough ( jacobi ) energy to overcome the effective potential barrier at these lagrange points ( fig .  8.6 of bt ) and",
    "thus will be preferentially stripped from the satellite at these points . for a spherical , extended parent mass distribution",
    "the tidal radius instead scales with the enclosed mass at the instantaneous orbital radius , @xmath31 , with additional terms that account for the local slope of the density profile . in general",
    "the satellite mass also depends on time .",
    "the tidal radius of the debris then follows @xmath32 where @xmath33 is the instantaneous enclosed mass of the parent system within orbital radius @xmath28 . in general",
    ", the lagrange points may not be symmetric about the center of the satellite and may deviate from the tidal radius by factors of order unity",
    ".    the bulk velocity of the satellite will be of order @xmath34 .",
    "if the velocity dispersion of the satellite is @xmath35 , then it follows @xmath36 ( as pointed out in * ? ? ?",
    "* ) and hence we expect the debris - star velocities also to scale with @xmath37 .",
    "these scalings assume that the satellite is spherical with isotropic velocities ; non - random , internal satellite orbits ( e.g. , a disk ) will break these assumptions .    in a triaxial potential , the orbital plane of the satellite",
    "is not fixed but we still expect there to be _ effective _ lagrange points for a spherical satellite system along the line of centers connecting the origin of the parent potential to the satellite  that is , we expect the stars to be stripped at some characteristic distance from the satellite ( near the tidal radius ) along the instantaneous position vector of the satellite with some dispersion about these points .",
    "we proceed by defining a coordinate system relative to the position and velocity of the progenitor , ( @xmath38,@xmath39 ) , rotated into the instantaneous orbital plane defined by @xmath40 .",
    "the ( time - dependent ) basis vectors are given by @xmath41    -[eq : x3 ] ) , normalized by the tidal radius ( eq .",
    "[ eq : tidalradius ] ) , and only shown within half a satellite crossing time around @xmath42 for each of the four progenitor masses .",
    "the orbits were integrated backwards from their present - day positions ( final time step of the n - body simulations ) as test particles without the potential of the progenitor .",
    "horizontal black line shows @xmath43 ( top panels ) and @xmath44 ( bottom panels ) , and the unit circle ( black circle ) illustrates the classical disruption radius in these coordinates . ]",
    "figure  [ fig : lpts_r ] shows sections of particle orbits ( for particles that are stripped ) from the n - body simulations described above , projected into this coordinate system .",
    "the positions are normalized by the instantaneous tidal radius ( eq .  [ eq : tidalradius ] ) and velocities are normalized by the instantaneous velocity scale ( eq .  [ eq : velscale ] ) .",
    "sections of the orbits symmetric around their unbinding times , @xmath45 , are shown for each of the four progenitor masses . in these coordinates , the classical lagrange points would be located at @xmath46 ( illustrated by the intersection of the black unit circles and horizontal lines in figure  [ fig : lpts_r ] ) . though not exactly centered on the point - mass lagrange points derived for a circular orbit , the location of and dispersion about the effective lagrange points in these scaled coordinates remain remarkably consistent across the range of progenitor masses explored .",
    "figure  [ fig : lpts_v ] shows the velocity orbits of each star also projected into these coordinates and normalized .",
    "the dispersion in velocity is well - normalized by the velocity scale of eq .",
    "[ eq : velscale ] , though it is clear that the velocity dispersion along @xmath47 , the radial vector to the satellite position , is larger than that in other dimensions , possibly because of mild tidal shocking .",
    "but for particle velocities normalized by the velocity scale ( eq .  [ eq : velscale ] ) . ]",
    "we conclude that even on a non - circular orbit in a complex potential , the dispersion  in position and velocity  of tidally stripped debris as it comes unbound from the satellite scales with the mass ratio @xmath48 .",
    "this motivates a model for tidal debris in which each star was `` released '' at the instantaneous , effective lagrange point at its unbinding time , @xmath45 , with a dispersion in position and velocity , all of which depend only on the mass and orbit of the progenitor and the parent potential .",
    "we present this model in detail below .",
    "suppose we observe the 6d position of a star , @xmath49 , in heliocentric coordinates  e.g. , the measured position on the sky , ( @xmath50 , @xmath51 ) ; distance , @xmath52 ; proper motions , ( @xmath53 , @xmath54 ) ; and line - of - sight velocity , @xmath55  and have determined through some other means that this star was once part of a progenitor system ( e.g. , satellite galaxy ) with mass @xmath56 that is disrupting and forming a cold debris structure in the potential , @xmath3 , of the parent galaxy ( e.g. , the milky way ) .",
    "we assume that the mass of the parent system enclosed within the pericenter of the orbit of the satellite , @xmath57 , is much larger than the initial mass of the satellite , @xmath58 .",
    "the present position of the progenitor is observed to be at heliocentric position @xmath59 ( where any subscript @xmath60 refers to the progenitor ) . in general , the data for the star and progenitor will have significant uncertainties or missing dimensions at distances typical to the galactic halo , thus we define @xmath61 and @xmath62 as the true 6d , heliocentric positions of the star and progenitor and will include these in our model .",
    "since we include these positions as parameters , this method will work even when the star has missing dimensions or the progenitor location is unknown ( as in the orphan stream , * ? ? ?",
    "to model the true , 6d , present - day position of the star , @xmath61 , we first transform to cartesian , galactocentric coordinates where ( @xmath63 ) and ( @xmath64 ) are the position and velocity of the star and progenitor today .",
    "the star is taken as having been sampled at @xmath42 ( the unbinding time ) from an isotropic gaussian centered on one of the effective lagrange points in position , and an isotropic gaussian centered on the origin in velocity .",
    "the present - day phase - space position is the result of integrating this sample forward from @xmath45 in the parent potential , @xmath3 , whose form is parametrized by the vector @xmath65 .",
    "we assume that once the star becomes `` unbound '' from the satellite the potential of the satellite can be ignored , . ]",
    "and thus we treat the star as a test particle .",
    "the satellite mass enters this prescription through the tidal radius ; a changing satellite mass will skew the positions of the effective lagrange points and velocity scale .",
    "we allow for mass - loss by incorporating the initial satellite mass , @xmath66 , and a constant mass - loss term , @xmath67 into the model : @xmath68 .",
    "finally , we add two additional parameters : a constant , global factor , @xmath69 , that scales the position of the effective lagrange points relative to the classical tidal radius , and a binary parameter @xmath70 ( one for each star ) , that is either @xmath71 or @xmath72 depending on whether the star is in the leading or trailing tail .",
    "to compress notation , we pack all progenitor parameters into the vector @xmath73 .",
    "the likelihood for this model is : @xmath74_{{t_{\\rm ub}}}\\end{aligned}\\ ] ] where @xmath75 is given by eq .",
    "[ eq : tidalradius ] , and @xmath76 by eq .",
    "[ eq : velscale ] and the positions and velocities ( @xmath77 ) are evaluated at the unbinding time , @xmath45 , by integrating the orbits backwards from ( @xmath78 ) .",
    "@xmath79 is the absolute value of the determinant of the jacobian that defines the transformation from heliocentric , spherical to galactocentric , cartesian coordinates .",
    "we then marginalize the likelihood over all possible unbinding times , assuming a uniform prior of unbinding times over the entire interaction time : @xmath80 where the interaction time is taken to be @xmath81  gyr , the total duration of the simulations of section  [ sec : sims ] .",
    "the likelihood above is evaluated for each star at all time - steps of the simulation during the marginalization with a uniform prior over all possible unbinding times ( no assumptions are made about the orbital phase dependence of mass - loss ) .",
    "we chose this approach because the phase - space position ( and hence time ) at which a star becomes unbound from a satellite can only be strictly defined for the case of a spherical satellite orbiting on a circular orbit in a spherical potential .",
    "various authors have chosen to measure mass loss in simulations of satellite disruption on eccentric orbits in non - spherical potentials by either looking at the kinetic energy of the particles relative to the satellite s potential energy @xcite or looking at the point at which a star crosses the instantaneous tidal radius @xcite .",
    "neither choice is strictly valid and both have been found useful for representing the mass - loss process .",
    "hence we make the simplest choice of using gaussians to characterize the phase - space distribution of debris as it makes the transition between being bound and unbound .",
    "we find that changing this distribution to a log - normal distribution does not affect our conclusions .",
    "we assume that the observational uncertainties are gaussian in heliocentric , spherical coordinates , such that @xmath82 where @xmath83 represents the normal distribution , and the covariance matrices @xmath84 and @xmath85 specify the observational uncertainties on the observed 6d position of the star and progenitor , respectively .    for a single star ,",
    "the evaluation of the likelihood works as follows : given observed , present - day coordinates for the star and progenitor ( @xmath86 ) , potential parameter values ( @xmath65 ) , and nuisance parameter values ( @xmath87 ) ,    1 .",
    "transform star and progenitor positions in heliocentric coordinates to galactocentric , cartesian coordinates ; 2 .   integrate star and progenitor orbits backwards as test particles in the potential given by @xmath65 for the total interaction time , @xmath88 ( in this case , @xmath4@xmath89  gyr ) ; 3 .",
    "transform the particle position to the relative , normalized coordinates defined in section  [ sec : debris ] ; 4 .   compute the likelihood given by equation  [ eq : starlike ] at each time - step of the integration and marginalize over the unbinding time , @xmath45 .    assuming each star is an independent tracer , the full likelihood for many stars is then just the product of the individual likelihoods : @xmath90 where @xmath91 .",
    "all parameters are summarized in table  [ tbl : params ] .",
    "in what follows , we use ` rewinder `  to model `` observations '' of a small sample of stars from one of the n - body simulations described in section  [ sec : sims ] .",
    "we consider this a strong test of the method because the data are generated with n - body simulations and not with anything resembling the likelihood function presented above .",
    "for all tests in this article , we use the same functional form for the potential as used in the simulations ( equation  [ eq : lm10 ] ) . when recovering the potential , we hold fixed the disk and spheroid parameters ( see table  [ tbl : params ] ) , along with one of the halo parameters : the scale radius , @xmath92",
    ". the priors on the remaining halo parameters are taken to be uniform over a conservative domain of realistic values : for @xmath93 , 100 - 200  km / s corresponds to a range in solar circular velocities from @xmath4210 - 250 km / s ( holding other parameters fixed ) ; the range in axis ratios allow for prolate , oblate , and generic triaxiality ; and @xmath20 is restricted to @xmath94 around the true simulation value , @xmath95 .    for all experiments below , we use a markov chain monte carlo ( mcmc ) algorithm to sample from the posterior probability distribution given by our model .",
    "standard mcmc algorithms ( e.g. , metropolis - hastings ) update a single chain while exploring parameter space .",
    "we instead use an affine - invariant `` ensemble '' sampler @xcite that , each step in parameter space , updates the positions of many `` walkers '' ( the ensemble ) .",
    "this algorithm is implemented in the ` python ` programming language @xcite and runs naturally in a parallelized environment such as the message passing interface ( mpi ) . in each experiment",
    "we run the walkers for a large number of steps from starting positions described below , then throw away these samples and take the positions from the final step of this `` burn - in '' phase as a starting point for the samples used for inference .",
    "we compute the autocorrelation time for each sampled parameter ( using ` acor`@xmath96 ) and thin the chains by taking every @xmath97 sample to ensure the samples are close to independent .",
    "l c c l + component & parameter & truth & prior + disk & @xmath98 & @xmath99 & fixed + & @xmath100 & 6.5 kpc & fixed + & @xmath51 & 0.26 kpc & fixed + spheroid & @xmath101 & @xmath102 & fixed + & @xmath103 & 0.7 kpc & fixed + halo & @xmath93 & 121.858 & @xmath104 km / s + & @xmath18 & 1.38 & @xmath105 + & @xmath19 & 1.0 & fixed + & @xmath23 & 1.36 & @xmath105 + & @xmath20 & 97 & @xmath106 deg + & @xmath92 & 12 kpc & fixed +   + position & @xmath107 &  & @xmath108  kpc + velocity & @xmath109 &  & @xmath110  km / s + lagrange pt .",
    "offset & @xmath111 &  & @xmath112 + initial mass & @xmath66 & @xmath113 & fixed + mass loss & @xmath67 &  & @xmath114/myr ( fixed ) +   + position & @xmath115 &  & @xmath116  kpc + velocity & @xmath117 &  & @xmath118  km / s + tail assignment & @xmath119 &  & @xmath120  equally likely ( fixed at truth ) +      we test ` rewinder `  using only four stars ( particles )  two from the leading tail , and two from the trailing tail  randomly sampled from the @xmath113 simulation ( section  [ sec : sims ] ) , assuming the observed 6d positions for both the stars and the progenitor have negligible uncertainties .",
    "the stars were required to have been stripped after the first pericentric passage and have a present - day distance within @xmath121 kpc of the sun .",
    "figure  [ fig : sims ] ( second column from right ) shows the randomly chosen stars ( black crosses ) in galactic coordinates , over - plotted on all other simulated particles ( grey points ) .",
    "we leave the potential parameters ( @xmath122 ) free to vary , along with the lagrange point offset , @xmath69 , and initialize an ensemble of 64 mcmc walkers by sampling from the priors summarized in table  [ tbl : params ] .",
    "we run the walkers for 5000 steps to burn - in , then restart the sampler starting from the final position of the burn - in phase and run for another 5000 inference steps . figure  [ fig : trace ] shows the walker positions over the 5000 inference steps for each of the five parameters .",
    "the autocorrelation time for each parameter is displayed on its corresponding panel .",
    "figure  [ fig : exp1_posterior ] shows projections of the posterior probability distribution for the parameters ; with perfect data , the uncertainties on the potential parameters are all @xmath123 .    ) for each parameter at each step of the inference ( black lines ) .",
    "the mcmc chains do not display any bulk movement or stray walkers , implying , by eye , that the chains have converged .",
    "we also compute the autocorrelation functions for each parameter and find that , for this experiment , the autocorrelation times are short ( as shown on each panel in this figure ) .",
    "projections of the binned samples ( posterior densities ) are shown in figure  [ fig : exp1_posterior ] .",
    ", scaledwidth=50.0% ]          we next take the same four stars used in the previous experiment and `` observe '' them with optimistic observational uncertainties .",
    "we require these stars to be rr lyrae variables which are known to be excellent distance indicators via the mid - infrared period - luminosity relation ( as shown in , e.g. , * ? ? ?",
    "nearly 100 rr lyrae associated with the sgr stream and @xmath430 associated with the orphan stream will be observed with _",
    "spitzer _  as part of the smash survey @xcite with expected fractional distance uncertainties around @xmath42% .",
    "these stars will also be included in the _ gaia _ proper motion catalog : at a distance of @xmath450  kpc , a typical rr lyrae will have a tangential velocity error around @xmath420  km / s , though our sample of test stars are all within 40  kpc .    for this experiment",
    ", we ( 1 ) assume the stars are rr lyrae stars ( e.g. , bright distance indicators ) such that the fractional distance uncertainty is @xmath124 ; ( 2 ) neglect the uncertainty in angular position , @xmath125 ( for a typical rr lyrae at 50  kpc this is @xmath4@xmath126  deg for _ gaia _ ) ; ( 3 ) assume we can measure radial velocities to these stars with 5  km / s uncertainty ; and ( 4 ) compute the sky - averaged _ gaia _ proper - motion uncertainty for each star assuming an f0v spectral type using the ` pygaia ` code and use this uncertainty for both components of proper motion .",
    "we further assume that we know the tail assignment for each star , @xmath119 .",
    "we observe the position of the progenitor with the same observational uncertainties though in reality some coordinates will have even better measurements .",
    "this experiment samples over the four potential parameters , the lagrange point offset , four phase - space coordinate parameters for each star ( 16 total ) , and four phase - space coordinate parameters for the progenitor  25 parameters in total .",
    "we use an ensemble of 256 walkers and draw initial conditions for the coordinate parameters by sampling from gaussian s centered on the `` observed '' value with variances specified by the observational uncertainties . other parameters  potential parameters and @xmath69  are initialized by drawing from the priors summarized in table  [ tbl : params ] .",
    "we burn in the walkers for 50000 steps and run for 100000 inference steps , but thin the chains by taking every @xmath127 sample , where @xmath128  steps .",
    "figures  [ fig : exp2_potential ] , [ fig : exp2_satellite ] , [ fig : exp2_particle ] show the marginalized posteriors for the potential parameters , satellite parameters , and parameters for a single particle .",
    "the uncertainties on the potential parameters are only 5 - 7%                  the smash survey @xcite will be completed within a year ( early 2015 ) , long before the final _ gaia _ data release .",
    "thus , we will soon have precise distance measurements for stars in the sgr and orphan streams , but poor or no proper motion constraints .",
    "smash also targets several rr lyrae in the sgr core , which will enable a high - precision distance measurement of the progenitor .",
    "though proper motions have been measured for the sgr progenitor , we now consider a case in which we have high - precision ( 2% ) distances to stream stars and the progenitor , 10  km / s radial velocity uncertainty , but missing proper motions for all stars and progenitor .    as with the previous experiment ,",
    "this experiment includes 25 model parameters in total .",
    "we again use an ensemble of 256 walkers . other parameters  potential parameters and @xmath69  are initialized by drawing from the priors summarized in table  [ tbl : params ] .",
    "we burn in the walkers for 50000 steps and run for 500000 inference steps .",
    "we again thin the chains by taking every @xmath127 sample , but here the autocorrelation time is found to be very long , @xmath129  steps .",
    "figures  [ fig : exp3_potential ] , [ fig : exp3_satellite ] , [ fig : exp3_particle ] show the marginalized posteriors for the potential parameters , satellite parameters , and parameters for a single particle .",
    "even a small sample of stars with precise distance measurements provide an enormous amount of information about the triaxiality of the potential .",
    "fractional uncertainties on the potential parameters are @xmath415% and the initially missing proper - motions are recovered with @xmath425% uncertainties .",
    "* 1 . observational uncertainties : * any method that uses tidal debris as a potential measure must also model the ( significant ) uncertainties on the kinematic measurements ; ` rewinder `  handles observational uncertainties and missing data dimensions by including the true 6d positions of stars and the progenitor as model parameters . in this article",
    "we have tested ` rewinder `  using data of varied quality for a small sample of stars .    *",
    "form of the potential : * no assumptions were made about the the form of the galactic potential in deriving the likelihood for ` rewinder ` . the simple experiments in this article infer potential parameters from the same static , analytic potential used in the n - body simulations that generated the fake data . however , in principle the potential could be time - dependent , clumpy , or have properties that vary with radius .",
    "the orbits of the stars and progenitor are directly integrated and only require a function that evaluates the acceleration due to the potential at a given position ( and time ) .",
    "we have shown that with the correct form for the galactic potential , _ precise _ measurements of the potential parameters are attainable with near - future data , but we have not discussed the _ accuracy _ of such measurements due to incorrect assumptions . for example , bonaca et al .",
    "( in prep . )",
    "show that using a static potential model to fit the live potential of the _ via lactea _ halo with tidal streams can introduce significant biases to measurements of the halo mass , even with perfect knowledge of the 6d coordinates of stars in the streams . in future work",
    ", we will ( 1 ) try fitting incorrect potential models to see if we can still recover global properties ( e.g. , flattening ) ; ( 2 ) run simulations with smoothly changing potentials ( e.g. , * ? ? ? * ) and attempt to model the time dependence ; and ( 3 ) explore using a generic , non - parametric potential form ( e.g. , a basis function expansion ) as the recovery potential model .    * 3 .",
    "multiple debris structures : * each stream will provide constraints on different properties of the potential . for example , more eccentric streams may better constrain the radial profile ( see * ? ? ? * who illustrate the power of using multiple streams to simultaneously constrain the potential using orbit fitting ) . in this article , we only consider a stream on a sgr - like orbit , which lies nearly in the galactic @xmath16-@xmath130 plane .",
    "we find that the stream puts better constraints on the @xmath130-axis flattening , @xmath23 , than on the flattening in the @xmath16-@xmath17 plane , @xmath18 , as one might expect .",
    "the best measurements of the detailed shape of the galactic potential will come from combining constraints from multiple streams .",
    "we have defined above a proper likelihood function for observed stars in a given stream , thus incorporating multiple streams into the inference only requires multiplying the likelihoods computed for each stream and progenitor pair .    *",
    "4 . comparing models to data : * with ` rewinder ` , each star adds constraints on the potential parameters and does not require matching a simulated density to the observed density of stars , thus this method works well even for small samples of well - measured stream stars .",
    "it might be that the most relevant stellar samples for inferring the milky way potential are small .",
    "for instance , stars that produce good distance estimates might be much more valuable than typical stars in the sample so that we may limit to only variable stars , e.g. , rr lyraes .",
    "these valuable stars are rare ( and their abundances are age and metallicity dependent ) ; there could be many cold structures in the milky way halo that are highly constraining on the potential in principle , but which contain only a few good distance - indicating members .",
    "it is not yet known what the trade - offs are between having many stars at low precision and a few at high precision , nor is it known how valuable distance information really is , when a structure contains many precisely observed members .    *",
    "computational expense : * one point of concern for ` rewinder `  is that the number of parameters scales with eight times the number of stars : each star has six coordinate parameters ( the true position ) , the unbinding time , and the tail assignment .",
    "computational constraints limit the sample size , but even so , the inference is much faster than full n - body modeling because the stars and progenitor are treated as test particles .",
    "each step in parameter space with ` rewinder `  requires integrating the orbits of stars and the progenitor : we presently integrate with a fixed time - step using leapfrog integration .",
    "computing the acceleration due to the given potential at each step is implemented in ` cython ` ( and approaches ` c`-like speed ) , but the rest of the code is written in pure-`python ` . though already significantly less computationally intensive than running a full n - body simulation for every parameter step , running each mcmc walker for @xmath5100000 steps",
    "requires parallelization and many hours of cpu time on a compute cluster .",
    "further optimization of the integration method ( e.g. , using an adaptive method or implementing in ` cython ` ) could speed up the inference significantly .",
    "we have presented a probabilistic model ( ` rewinder ` )  a likelihood function and with priors on the parameters  for using stars observed in tidal streams to constrain properties of any underlying gravitational potential . `",
    "rewinder `  relies on direct orbit integration and not on computing conserved quantities ( e.g. , actions ) and can thus be used with arbitrarily complex ( e.g. , time - dependent or clumpy ) forms of the potential .",
    "we have performed several experiments to show that ` rewinder `  simultaneously constrains the potential and models a tidal stream given simulated data with a range of realistic uncertainties .",
    "we find that with future high - quality data  that is , high precision distance measurements from rr lyrae and proper motions from _",
    "gaia_ a small sample of just four stars in a tidal stream modeled with ` rewinder ` provide measurements of potential parameters that rival present - day constraints from comparing full n - body simulations to large numbers of stellar tracers with poorly measured kinematics . for this high - quality data",
    ", we recover the input potential parameter values with uncertainties of order 5 - 7 percent . without proper motion data the uncertainties are around 15 percent .",
    "we consider this work to be an encouraging first step towards the goal of recovering the ( presumably ) much more complex  time - dependent , clumpy , with axis ratios and orientations that vary with radius  milky way potential with larger data sets .",
    "we thank anthony brown ( leiden ) for insight on the _ gaia _ data quality and for providing the open source ` pygaia ` code for computing predicted uncertainties .",
    "we thank the organizers of the gaia challenge ( 2013 ) and the university of surrey for hospitality during the workshop .",
    "we thank ana bonaca ( yale ) , jo bovy ( ias ) , dan foreman - mackey ( nyu ) , marla geha ( yale ) , andreas kpper ( columbia ) , and hans - walter rix ( mpia ) for useful discussions .",
    "kvj thanks the institute of astronomy at the university of cambridge for hospitality and vasily belokurov ( ioa ) and his group for discussion of his work while there .",
    "apw is supported by a national science foundation graduate research fellowship under grant no .",
    "11 - 44155 .",
    "this work was supported in part by the national science foundation under grant no .",
    "phys-1066293 and ast-1312196 .",
    "dwh was partially supported by the nsf ( grant iis-1124794 ) and the moore - sloan data science environment at nyu .",
    "this research made use of astropy , a community - developed core ` python ` package for astronomy @xcite .",
    "this research has made use of nasa s astrophysics data system .",
    "this work additionally relied on columbia university s _ hotfoot _ and _ yeti _ compute clusters , and we acknowledge the columbia hpc support staff for assistance . +"
  ],
  "abstract_text": [
    "<S> the dark matter halo of the milky way is expected to be triaxial and filled with substructure . </S>",
    "<S> it is hoped that streams or shells of stars produced by tidal disruption of stellar systems will provide precise measures of the gravitational potential to test these predictions . </S>",
    "<S> we develop a method for inferring the galactic potential with tidal streams based on the idea that the stream stars were once close in phase space . </S>",
    "<S> our method can flexibly adapt to any form for the galactic potential : it works in phase - space rather than action - space and hence relies neither on our ability to derive actions nor on the integrability of the potential . </S>",
    "<S> our model is probabilistic , with a likelihood function and priors on the parameters . </S>",
    "<S> the method can properly account for finite observational uncertainties and missing data dimensions . </S>",
    "<S> we test our method on synthetic datasets generated from n - body simulations of satellite disruption in a static , multi - component milky way including a triaxial dark matter halo with observational uncertainties chosen to mimic current and near - future surveys of various stars . </S>",
    "<S> we find that with just four well - measured stream stars , we can infer properties of a triaxial potential with precisions of order 5 - 7 percent . without proper motions we obtain 15 percent constraints on potential parameters and precisions around 25 percent for recovering missing phase - space coordinates . </S>",
    "<S> these results are encouraging for the eventual goal of using flexible , time - dependent potential models combined with larger data sets to unravel the detailed shape of the dark matter distribution around the milky way . </S>"
  ]
}