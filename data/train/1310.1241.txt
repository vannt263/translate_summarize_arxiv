{
  "article_text": [
    "in certain situations , such as exoplanet imaging , it is necessary to have an extremely good wavefront ( wf ) quality . to achieve this ,",
    "the wavefront must be corrected with a very high resolution ; the next - generation extremely large telescopes having apertures larger than 20  m require deformable mirrors with up to @xmath1 actuators .",
    "furthermore , additional wf sensing must be done at the focal plane to avoid the slowly evolving , non - common path aberration errors .",
    "a possible wf reconstruction algorithm for this purpose is the fast & furious ( f&f ) algorithm @xcite .",
    "it is numerically extremely efficient , relying on small wf aberrations , pupil symmetries and phase - diversity to achieve very fast wf reconstruction .    to validate the f&f algorithm for high - order wavefront correction",
    ", we use an inexpensive spatial light modulator ( slm ) , based on twisted - nematic liquid crystals .",
    "it has about @xmath2 wavefront - modifying pixels surrounding the aperture .",
    "the device is able to make a stroke of @xmath01  rad while maintaining a sufficiently uniform transmittance .",
    "a successful operation of the system requires precise knowledge of how the slm reacts to the control signal .",
    "in addition , it is necessary to know , with sub - pixel accuracy , where the slm elements are located with respect to the physical pupil .",
    "information about the pupil amplitudes is important for high - contrast applications , particularly when an slm causes amplitude aberrations .",
    "therefore , it is highly desirable to have a method that detects both the phase and amplitude changes in the pupil plane without the need to physically move the imaging camera or wavefront correcting elements .",
    "we found that a single method , simple and easy to implement , is sufficient for all our calibration purposes : the differential optical transfer function method ( dotf ) @xcite .    in this paper , we show results from optical experiments demonstrating how the dotf method can be used for high - contrast imaging calibrations . in section",
    "[ sec : theory ] we describe the theoretical background for the calibration method .",
    "section  [ sec : methods ] discusses practical issues in the experiments , and section  [ sec : results ] shows the results of the dotf algorithm and the high - resolution f&f performance .",
    "finally , section  [ sec : conclusions ] draws the conclusions .",
    "the dotf method is a phase - diversity technique that reconstructs the electric field at the pupil - plane using intensity measurements at the focal plane .",
    "however , the method is unique in not requiring any models or a priori information : nothing has to be known about the pupil function , wavefront corrector or the psf sampling . on the contrary",
    ", the dotf method can be used to calculate , with good accuracy , the parameters required by more conventional phase - diversity algorithms , discussed , for instance , by @xcite .    the key is a very localized diversity at the edge of the pupil . once the diversity is close to a delta function , it becomes possible to directly extract the pupil - plane complex amplitudes from the intensity measurements .",
    "however , this approach has a major challenge : the image with a delta - function diversity is almost identical to the original image .    the comparison of two very similar images results in issues with the signal - to - noise ratio ( snr ) . to counteract the snr problem",
    ", we found , as discussed in section  [ sec : noisecomp ] , that it is extremely helpful to apply a large defocus when applying the dotf method .",
    "therefore , the following discussion is geared towards applying the dotf method for calibration purposes , where only the change of the pupil - plane complex amplitudes is of interest and not the image itself .",
    "we begin by describing the basic principles of the dotf method in section  [ sec : basics ] .",
    "section [ sec : esterr ] discusses the dotf accuracy in our setup , and section  [ sec : sampling ] explains how to determine the psf sampling with the dotf method .      when imaging a monochromatic point source , the image can be modeled using fraunhofer diffraction .",
    "the image in the focal plane is the squared modulus of the complex amplitudes in the pupil plane , @xmath3^*,\\ ] ] where @xmath4 is the wavefront in the pupil , @xmath5 is the absolute value of the electric field in the aperture ( also describing the pupil shape ) , and @xmath6 denotes the complex conjugate .",
    "an example of such an image is shown in fig .",
    "[ fg : calisample1 ] .    2  rad .",
    "the wavefront is obtained from laboratory measurements ( see section  [ sec : dotf0 ] ) , scaled to a size of @xmath7  pixels .",
    "middle : perfect circular pupil having the same size .",
    "right : the resulting image ( shown area is @xmath8  pixels , the total simulated size is @xmath9  pixels).,title=\"fig:\",width=103 ] 2  rad .",
    "the wavefront is obtained from laboratory measurements ( see section  [ sec : dotf0 ] ) , scaled to a size of @xmath7  pixels .",
    "middle : perfect circular pupil having the same size .",
    "right : the resulting image ( shown area is @xmath8  pixels , the total simulated size is @xmath9  pixels).,title=\"fig:\",width=103 ] 2  rad .",
    "the wavefront is obtained from laboratory measurements ( see section  [ sec : dotf0 ] ) , scaled to a size of @xmath7  pixels . middle :",
    "perfect circular pupil having the same size .",
    "right : the resulting image ( shown area is @xmath8  pixels , the total simulated size is @xmath9  pixels).,title=\"fig:\",width=103 ]    the optical transfer function is the fourier transform of eq .   and can be written as @xmath10 where @xmath11 and @xmath12 denote the mirrored versions of @xmath5 and @xmath4 : @xmath13 , @xmath14 .",
    "it is convenient to consider the otf as a convolution of complex functions , @xmath15 where @xmath16 denotes the complex amplitudes at the pupil plane , and @xmath17 is its mirrored and conjugated variant .    to solve the complex amplitudes using only intensity measurements , it is necessary to introduce a diversity  a modification in the wavefront and/or pupil transmittance  and to record another image .",
    "the otf of the diversity image can be written as @xmath18 where @xmath19 is the change in complex amplitudes in the pupil .",
    "the difference of the the optical transfer functions is @xmath20    if the diversity is highly localized , then @xmath19 is approximately a delta function ( multiplied by a complex constant ) . a simulated example of such a difference is shown in fig .",
    "[ fg : calisample3 ] .",
    "the wavefront and pupil are the same as in fig .",
    "[ fg : calisample1 ] .",
    "the pupil width is 334 pixels , and the diversity is a disk , 15 pixels wide , at the edge of the pupil .",
    "[ 2.8cm][0 cm ]    foreground ( -2.9,-0.5 ) node ( c ) @xmath21 ( -0.6,0 ) node ( b ) @xmath22 ; ( -0.3,-1.85 )  ( -0.3,1.85 ) ; ( -2.5,0 )  ( -2.5,-1.13 ) ;    background ( 0,0 ) node ( o ) ) .",
    "the array size is @xmath9  pixels .",
    "left : modulus ",
    "@xmath21 indicates the pupil diameter in pixels , and @xmath22 is the size of the whole dotf array .",
    "right : phase.,title=\"fig:\",width=139 ] ;    highly localized means that the range of the diversity is less than @xmath015% of the pupil width ; in such cases it has nonzero values only close to itself . if the diversity is at the edge of the pupil , the two first terms in eq .",
    "have nonzero values at different locations  except for close to the diversity .",
    "this can be further illustrated by inspecting the different terms in eq .   separately , as is done in fig .",
    "[ fg : calisample2 ] .",
    "the two pupil functions are shifted because the peaks of the convolving diversity functions , @xmath19 and @xmath23 , are separated by about one pupil diameter .",
    "the pupil amplitudes are somewhat distorted , since @xmath19 is not a perfect delta function .",
    "the impact of the third term , @xmath24 , is negligible in most cases .",
    "thus , it is possible to consider eq .",
    "piecewise , @xmath25 where @xmath26 and @xmath27 denote the regions on opposite sides of the diversity location , and @xmath28 and @xmath29 are delta functions multiplied by a complex constant .",
    "the measurement error of the dotf method is almost entirely caused by the smoothing convolution with @xmath19 and noise propagation . for our purposes , it is also necessary to have a more detailed look at the error made when characterizing the performance of the slm .",
    "we used the slm itself to generate the localized diversity , but a similar effect could also be achieved by using an additional device @xcite .    a numerical example of the convolution bias in a typical measurement situation was set up with a small , constant , wf difference of 0.5  rad and a transmittance reduction of 10% introduced in one half of the pupil ; the undistorted case is the same as shown in fig .",
    "[ fg : calisample1 ] . two dotf measurements ( in total four images ) are recorded : both the undistorted and the modified complex amplitudes are determined .",
    "these two dotf arrays are then used to determine the change in the pupil plane .",
    "we measure the phase change ( denoted as @xmath30 ) as a subtraction of reconstructed wavefronts .",
    "the change in transmittance ( @xmath31 ) is measured as a ratio of dotf moduli .",
    "it holds that @xmath32 where @xmath33 denotes a function unwrapping the phase of a complex number , @xmath34 is the true complex amplitude after diversity modification , and @xmath35 describes the localized diversity of the dotf measurement made for the modified case . in our tests , we always had high snr , and therefore we did not observe issues with @xmath36 being zero .",
    "the arrays @xmath30 and @xmath31 are shown in fig .",
    "[ fg : errsimu ] .    .",
    "top right : @xmath31 .",
    "bottom : vertical cuts of @xmath30 and @xmath31.,title=\"fig:\",width=149 ] .",
    "top right : @xmath31 .",
    "bottom : vertical cuts of @xmath30 and @xmath31.,title=\"fig:\",width=149 ]    .",
    "top right : @xmath31 .",
    "bottom : vertical cuts of @xmath30 and @xmath31 . ]    both the phase and transmittance changes are observed without any bias .",
    "only the convolution smoothing distorts the determined complex amplitudes  it is especially visible along the edge of the modification .",
    "the edge appears as a linear transition in the phase , but in the transmittance , the edge also has an undershoot of @xmath05% .",
    "it is particularly interesting that the transmittance change , @xmath31 , shows no signs of the dotf modulus distortions , visible for instance in figs .",
    "[ fg : calisample3 ] and [ fg : calisample2 ] .",
    "this obviously holds only when the introduced phase and transmittance changes are small enough , but this was the case with all the measurements presented in this paper  the introduced phase change never exceeded 1.6  rad .",
    "the numerical example shown is not an extensive analysis of the dotf method ; a more thorough approach would be needed to characterize its limits , which is outside the scope of this paper .",
    "another important issue is the sampling at the detector array .",
    "typically , the sampling is expressed in terms of the width of the diffraction - limited psf , in pixels , and its value is determined both by the optical design and the detector properties .    determining",
    "the sampling accurately is important for all model - dependent focal plane wavefront sensing techniques .",
    "when the psf is modeled numerically with an fft , its diffraction - limited width is usually defined as @xmath37 where @xmath38 is the width of the zero - padded fft array in pixels , and @xmath39 is the diameter of the modeled pupil in pixels .",
    "it can be difficult to determine values for @xmath40 that accurately match the modeled system , if only distorted psf images are available .",
    "however , the dotf method offers a straightforward way to determine @xmath40 with an accuracy close to the dotf array discretization limit ; a greater precision would require dealing with the fixed sampling of the fft @xcite .",
    "first , the dotf array is obtained by fourier transforming pre - processed and subtracted detector intensities .",
    "then , the value of @xmath40 is obtained directly : it is the ratio between the total width of the dotf array and the observed pupil diameter in pixels  indicated by @xmath22 and @xmath21 in fig .",
    "[ fg : calisample3 ] .",
    "obviously , a successful use of the dotf method requires that the detector array is at least nyquist sampled ( two pixels per diffraction - limited psf core )  a limitation when compared to general phase - retrieval methods based on error metric minimization @xcite .",
    "if the sampling was smaller ( @xmath41 ) , aliasing would occur .",
    "its concrete manifestation would be that the joined pupils ( as shown in fig .",
    "[ fg : calisample3 ] ) would not fit into the fft array , and this would render the dotf method useless . to avoid this with a safe margin , we used a moderate oversampling , @xmath42 .",
    "a larger over - sampling would work as well , but it would require more detector pixels and bigger arrays to handle the data .",
    "we explain the experimental arrangements we used to test the dotf method by describing our high - dynamic range ( hdr ) imaging approach ( section  [ sec : noisecomp ] ) followed by a description of the optical setup ( section  [ sec : hardware ] ) .      in principle , the dotf method could be implemented by taking two consecutive images that have a very localized diversity near the pupil border . in practice , we found that obtaining a high snr is the biggest challenge .",
    "this is not surprising when considering eq .   where two almost identical images are subtracted .",
    "furthermore , those images are the focal plane images of a point - source , which means that  in the absense of large wavefront aberrations  most of the light is localized in the core of a small psf .",
    "a large defocus during the dotf measurements spreads the light more evenly over the detector pixels .",
    "this improves the snr and dramatically increases the accuracy of the higher spatial frequencies of the complex amplitudes .",
    "in addition , we paid attention to other aspects that improve the performance .",
    "our image acquisition recipe for a single dotf measurement is :    * create a defocus of @xmath01730  rad peak - to - valley .",
    "make sure the system is as stable as possible during the recording process .",
    "for instance , avoid using deformable mirrors with high voltages to reduce the effects of amplifier noise . *",
    "adjust the laser power ( or change neutral density filters ) such that the camera can work with short exposure times ( on the order of milliseconds ) .",
    "this reduces the effect of turbulence inside the optical setup and slowly drifting slm characteristics .",
    "* select optimal diversity .",
    "we used a disk having a width of 2.54% of the pupil diameter ( corresponding to 58 slm pixels ) .",
    "place the center of the diversity at the detected pupil border ( half of the disk inside the aperture , as illustrated in fig .",
    "[ fg : divspot ] ) .",
    "a small disk makes the snr low , a wide disk blurs and biases the recorded complex amplitudes .",
    "we used the slm to introduce the maximum possible complex amplitude change within the diversity disk : 1.6  rad phase difference and 25% drop in transmittance ",
    "a value also found in @xcite . *",
    "record a set of images with varying exposure times such that long - exposure images saturate .",
    "create compiled images ( as discussed later ) to further increase the camera s dynamic range and reduce its read - out noise .",
    "this is also called high dynamic range imaging ( hdr ) @xcite .",
    "we used 56 different exposure times ( 0.2429  ms ) for one compiled image . *",
    "create a set of image compilations and average to further reduce the noise .",
    "we did this pair - wise : first one reference image compilation , then one diversity image compilation , then again one reference and so on .",
    "this avoids issues with internal turbulence ( caused by air convection ) and slow drifts of the slm .",
    "we typically used 40 such pairs for a single dotf determination .",
    "our total recording time for one dotf reconstruction was 24  min .",
    "to create the compilation with increased dynamic range , we take a set of @xmath43 images ( @xmath44 , @xmath45 , @xmath46 , @xmath47 ) , ordered according to increasing exposure time .",
    "we start by setting @xmath48 . for the remaining images ( @xmath49 )",
    ", we iteratively update the compilation according to :    1 .",
    "calculate a scaling factor @xmath50 where @xmath51 are the unsaturated pixels with adequate signal in both the current compilation ( @xmath52 ) and @xmath53 .",
    "2 .   update the compilation : @xmath54 = @xmath55 , where @xmath56 is the set of pixels that are not saturated in @xmath53 .",
    "the linear range and the saturation of the camera are determined by inspecting the response when gradually increasing the exposure time . to be on the safe side , we assume the linear range to be 153500 analog - to - digital units ( adus ) while the maximum intensity of the camera is 4096 adus .      a schematic view of the optical setup is shown in fig .",
    "[ fg : schema ] .",
    "the beam is directed through a linear polarizer , the spatial light modulator and another linear polarizer .",
    "then , it is reflected by a deformable mirror ( dm ) and focused onto the camera .",
    "the rotation of the polarizers with respect to the slm is chosen such that the slm produces maximum phase shifts and minimum transmittance changes ( as explained for instance in @xcite ) .",
    "the light source is a laser diode having a wavelength of 656  nm .",
    "the laser is coupled to a fiber , and the light is roughly 50% polarized when arriving at the first collimating lens .",
    "we found that the quality of the laser was not a limiting factor , and we made no attempts to study its stability or install a spatial filter in front of the laser window .",
    "using standard 1  inch doublet lenses , the beam is collimated , passes a diaphragm @xmath05  mm wide and is re - collimated to pass the slm and dm with a diameter of @xmath01  cm .",
    "the slm is a transmissive device having @xmath57 pixels .",
    "the birefringence of each slm pixel can be controlled by a vga signal having a range of 8 bits per pixel ( grayscale values between 0255 ) . for the experiments reported in this paper , we adjusted the size of the diaphragm such that the beam passes an area of 334  pixels wide .",
    "the slm causes a strong diffraction effect since the pixels and wiring between them act as a grating .",
    "several sub - beams emerge , but only the brightest hits the camera .",
    "we observe no adverse effects from the other beams .",
    "in addition to the slm , we use the dm to control the low - order modes of the wavefront . during the dotf measurements ,",
    "the dm is not needed , and we turn it off .",
    "however , when testing algorithms to achieve a flat wavefront ( see section  [ sec : ff ] ) , we use the dm to overcome the stroke limitations of the slm .",
    "the whole setup was built , for convenience , on a @xmath58  cm breadboard with two folding mirrors ( before the 1st polarizer and before the imaging camera ) .",
    "the detailed parameters are listed in table  [ tb : hardware ] .",
    "ll + model & basler pia640 - 210gm + resolution & @xmath59  pixels + dynamic range & 12 bits + pixel size & @xmath60  @xmath61 m + readout noise & 14 electrons + sensor type & ccd +   + model & holoeye lc2002 + resolution & @xmath57 pixels + fill - factor & 55% + dynamic range & 8 bits + pixel pitch & 32  @xmath61 m +   + manufacturer & flexible optical b.v . + type & micromachined membrane dm + diameter & 15 mm + number of channels & 37 + controlled modes & 36 +   + model & qphotonics qfld-660 - 2s + type & laser diode , fiber coupled + central wavelength & 656  nm + spectral bandwidth & 0.7  nm +",
    "this section describes the results of our laboratory experiments .",
    "section  [ sec : dotf0 ] illustrates the properties of the basic dotf method",
    ". sections  [ sec : phresp ] and [ sec : rotreg ] show the details of how we determined the slm response and registration with respect to the pupil .",
    "finally , section  [ sec : ff ] describes the experimental verification of a focal - plane wavefront sensing algorithm .",
    "first , we show a basic example of the dotf method when the dm is turned off and all the slm pixels are set to zero .",
    "we also optimized the camera focus and neutral density filters such that short exposure times ( 0.24  ms ) were possible with a large defocus ( @xmath030  rad peak - to - valley ) without saturating the camera .",
    "we followed the procedure described in section  [ sec : noisecomp ] with 5 different exposure times ( 0.244  ms ) . in this way , the dynamic range of the images was @xmath62  to  @xmath63 ( ratio of smallest and largest non - zero values ) . for convenience , we cropped the central region of @xmath64 pixels from these hdr images ; that region contains enough information for the dotf reconstruction .",
    "then , we zero - pad the cropped parts to obtain arrays of @xmath65 pixels to avoid fft wrap - around effects .",
    "the dotf arrays were then computed as discussed in section  [ sec : basics ] .",
    "we applied no windowing function to avoid blurring the fine features , in particular the pupil borders .",
    "an example of the resulting arrays is shown in fig .",
    "[ fg : dotf0 ] .",
    "pixels wide .",
    "upper : modulus .",
    "lower : phase.,title=\"fig : \" ]   pixels wide .",
    "upper : modulus .",
    "lower : phase.,title=\"fig : \" ]    the dotf modulus very clearly shows the same pattern as seen in the simulated example in section  [ sec : basics ] . due to measurement errors , additional noise is seen .",
    "particularly outside of the circular pupil , the noise can easily be characterized : it consists of small clots , 47 pixels wide .",
    "the noise rms is @xmath03.5% of the maximum intensity , and its peaks are always lower than @xmath010% of the maximum .",
    "ideally , the noise should be almost white since the psf measurements are limited by the read - out noise .",
    "however , the zero - padding , the slm drift and the internal turbulence cause more complicated errors .",
    "the separation of the two pupils is very clear , which indicates that the applied diversity was close to a delta function .",
    "the very localized diversity makes it possible to see fine - scale structures : the shape of the used diaphragm , location and impacts of several dust particles and larger , ring - like structures , whose origin is not clear at this time .    in comparison to the simulated dotf with a perfect pupil , as discussed in section [ sec : esterr ] , the border effect ( a bright ring with lower intensity inside the pupil ) is an expected diffraction effect .",
    "the measurement bias is also very similar to what is seen in the simulation : the pupil intensity is highest close to the diversity location , decreasing radially from that point .",
    "the width of the pupil , compared to the dotf array , is easy to determine from the data in fig .",
    "[ fg : dotf0 ] .",
    "the intensity increases from the noise level to the mean pupil intensity ( @xmath00.5 of the maximum ) in @xmath04  pixels .",
    "the pupils shown in fig .  [ fg : dotf0 ] have a width of 186@xmath661  pixel , and therefore the sampling , as defined by eq .",
    ", can be determined with a resolution of @xmath01% to be 3.43 .",
    "[ fg : dotf0 ] also shows the phase in the pupil plane .",
    "since we applied a large defocus , the most dominant feature is the concentric rings , caused by phase wrapping .",
    "we found that the noise levels were sufficiently small such that the original wavefronts were extremely easy to reconstruct by unwrapping the phase . to unwrap , we used the standard quality - guided algorithm , discussed for instance in @xcite .      to measure the slm response to a voltage change , we kept half of the slm pixels at zero , and the control signal of the other pixels was set to a constant value .",
    "the dotf method was used to determine the change of the pupil plane complex amplitudes in the region where the slm was nonzero .",
    "we noticed that the drift of the slm created a significant change at lower spatial frequencies , especially tip / tilt , at time scales of @xmath0510 minutes .",
    "therefore , we had to record a new reference measurement ( with all slm pixels set to zero ) separately for all the slm modifications we wanted to determine .    figure  [ fg : slmrespo1 ] shows the measured data and dotf reconstructions for two cases : the reference and a case where the slm control voltage is maximum in the lower part of the pupil .",
    "the area where the slm pixels have been modified is clearly visible in the dotf arrays .",
    "the dotf modulus has a clear edge with a reduced intensity along the modification , exactly as in the simulations in section  [ sec : esterr ] .",
    "[ fg : slmrespo2 ] shows the arrays we used to determine the slm change . as in section",
    "[ sec : esterr ] , we subtracted the unwrapped dotf phases to calculate the slm phase change , and we took the ratio of the dotf moduli to calculate the slm transmittance change . to reduce the impact of noise , we applied median filtering ( window size 5 ) to the unwrapped phase and the dotf moduli .",
    "we also masked out 2% of the pupil at the edges to avoid dealing with the border effects .",
    "the masking was done only to compare the average values of the different half - pupils  it has no impact on the other aspects of the dotf method .    .",
    "right : difference of dotf phase in fig .",
    "[ fg : slmrespo1].,title=\"fig : \" ] .",
    "right : difference of dotf phase in fig .",
    "[ fg : slmrespo1].,title=\"fig : \" ]    figure  [ fg : slmrespo2 ] shows an obvious change in the lower half of the pupil .",
    "compared to the simulated case in fig .",
    "[ fg : errsimu ] , additional noise - like structure is present : the rms error of the upper and lower semi - pupils are 0.09  rad and 0.16  rad , respectively , while the average difference between the semi - pupils is 1.6  rad . for the transmittance change ,",
    "the values are 0.09 and 0.16 , and the difference between the semi - pupils is 0.25 .",
    "it is a reasonable approximation that all the slm pixels have an identical response and that the pixels are evenly distributed across the screen .",
    "thus , the additional structure is caused by measurement errors .",
    "the drift of the slm , together with a large defocus , can create the ring - like structures , and internal turbulence along the optical path is probably the reason for the speckle - like structure of the errors . also fresnel propagation effects from the slm to the last pupil plane could have an impact , which would appear as additional border effects around the edge of the slm modification .",
    "nevertheless , a good estimate of the average change can be obtained by taking an average over the whole area where a pupil modification is observed .",
    "we repeated the measurements shown in figs .",
    "[ fg : slmrespo1 ] and [ fg : slmrespo2 ] for several slm control levels .",
    "two independent series were recorded with different dotf diversity locations .",
    "the resulting transmittance and phase difference are shown in fig .",
    "[ fg : slmrespopl ] .",
    "the independent measurement series are in excellent agreement : the difference of the two measurements is typically @xmath01% of the average measurement .",
    "the transmittance is more difficult to measure with higher accuracy , when a large slm control signal difference is applied ; the difference grows to @xmath035% at signals larger than 200 . for the phase ,",
    "the difference between two independent measurements is always less than 0.005  rad ( excluding the control signal 233 , where it is 0.01  rad ) .",
    "this measured slm response is in excellent agreement with the results reported in @xcite .",
    "foreground ( -1.8,2.1 ) node ( c ) transmittance ( -1.7,-0.8 ) node ( b ) phase difference ;    background ( 0,0 ) node ( o ) ;    the maximum observed stroke was 1.6  rad , but it comes at the cost of @xmath025% loss in transmittance . if the maximum transmittance loss is restricted to 15% , the available stroke is @xmath01.2  rad .      to determine the slm registration with respect to the physical pupil , we first re - optimized the camera focus and the neutral density filters such that the same setting could be used later with our focal - plane wavefront - sensing algorithm",
    ". with these changes , the shortest possible exposure time ( 80  @xmath61s ) results in images at the optimal focus having a peak intensity @xmath050% of the saturation level .",
    "we applied the dotf method with 6 different exposure times ( 229  ms ) with a defocus of @xmath017  rad peak - to - valley , which was created by the dm .",
    "the resulting dynamic range of the recorded images was similar to what we reported in the previous section , although with larger errors caused by the longer integration times and smaller defocus giving less light on the peripheral camera pixels .",
    "however , we found the impact of these additional errors to be negligible for our purposes . yet , a significant change , caused by the refocusing , was that the psf sampling changed by @xmath05% to a value of @xmath67 due to the lack of telecentricity of the beam reaching the camera .    in the same way as in the previous section , we introduced a change in phase with selected slm pixels .",
    "we used the maximum control signal on stripe 66 pixels wide .",
    "we made 16 dotf recordings using both vertical and horizontal stripes , which covered the pupil at equal intervals .",
    "then , we determined the location of the modified stripe in the pupil plane .",
    "we found it easiest to do this by using a gradient detection .",
    "the x- and y - gradients of the dotf phase were computed by subtracting two arrays , both shifted one pixel in opposite directions .",
    "then , we took a squared sum of the x- and y - gradients and filtered out 98% of the lowest values , thus keeping only the pixels describing the borders of the stripe .",
    "the pixels were used to compute two linear fits of the two edges of the stripe .",
    "finally , a mean of these two lines was calculated , and it accurately represents the middle of the stripe .",
    "an example of this is shown in fig .",
    "[ fg : slmregi ] .",
    "the fitting produces two sets of intersections  two grids of 16 points .",
    "one of the sets is in the slm pixel coordinates , the other in the physical pupil coordinates ( whose sampling is determined by the size of the dotf array ) .",
    "then , we calculate the optimal affine transform ( @xmath68 ) minimizing the error @xmath69     -    \\left [ \\begin{array}{c }        x_\\text{slm}(i )",
    "\\\\        y_\\text{slm}(i ) \\\\      \\end{array } \\right ]    \\right\\|^2,\\ ] ] where @xmath70 are the coordinates determined from the dotf reconstructions , @xmath71 are the slm pixels corresponding to the intersections determined in the pupil coordinates , @xmath72 refers to the intersections of the fitted lines , and @xmath68 is the transform expressed by a @xmath73 matrix .",
    "we used dotf arrays having a size of @xmath65 pixels , and therefore the pupil coordinates @xmath70 are within an array of @xmath74  pixels .",
    "that area maps to the slm pixels having a size of @xmath7 pixels and located within the device with @xmath57 pixels .",
    "thus , the mapping performs the interpolation that defines how many degrees of freedom we actually use to control the slm .",
    "we found that the intersections we determined in pupil coordinates can be mapped to slm pixel coordinates with sub - pixel accuracy : the maximum error was 0.6  pixels , and the rms error was 0.4  pixels .",
    "the optimal transform was @xmath75,\\ ] ] which shows that a pure rotation , translation and scaling would be sub - optimal to describe the slm position with respect to the pupil plane : the difference to the optimal translation would be about 12  slm pixels at the peripheral pupil points .",
    "this is probably caused by a small tilt of the slm or camera , compared to the optical axis .",
    "the values show that the pixel grids of the slm and camera are rotated approximately 11.5@xmath76 with respect to each other , and this is also visible in figs .",
    "[ fg : slmrespo1 ] , [ fg : slmrespo2 ] and [ fg : slmregi ] .    after having determined @xmath68 and the slm response ( as in fig .",
    "[ fg : slmrespopl ] ) , it is possible to employ standard image processing techniques to calculate the slm control signal to create a desired phase change in the physical pupil .      finally , we tested how a phase - diversity based focal - plane wavefront sensing algorithm worked with a wavefront corrector calibrated as described before ; psf sampling determined as discussed in section  [ sec : sampling ] , slm phase response and alignment determined as shown in sections  [ sec : phresp ] and [ sec : rotreg ] , respectively .",
    "we use the fast & furious algorithm due to its easy implementation .",
    "our earlier work @xcite has illustrated how it works with low - order modes correction , and here we show the results with a wavefront corrector having a spatial resolution of @xmath74 control elements .",
    "[ fg : ff ] illustrates the performance of f&f .",
    "the left image was obtained when the camera was well focused , and low - order modes were corrected by the deformable mirror , but all the slm pixels were set to zero .",
    "the right image shows the situation after the f&f algorithm has converged .",
    "these two images  and all the images used by the algorithm  are hdr compilations of 15 images with different exposure times ( 0.0864  ms ) .",
    "the improvement in the image quality is obvious : the strehl ratio ( measured from the maximums of normalized images ) increased from 0.80 to 0.93",
    ".    pixels . left : before slm correction ( strehl ratio 0.80 ) .",
    "right : after f&f has converged ( strehl ratio 0.93).,width=325 ]    the remaining errors are likely caused by a ghost ( internal reflection from slm ) , saturation of the slm ( we limited the stroke to 1.2  rad causing 1620% of the pixels to be saturated ) , and amplitude errors ( caused by both the slm , imperfectly modeled pupil and fresnel propagation effects ) .",
    "however , a more detailed analysis is outside the scope of this paper , and we will address the issues in more detail in an upcoming publication .",
    "we have shown that an extremely straightforward method  the differential otf  can be used to calibrate a phase - diversity based focal - plane wavefront sensing algorithm that corrects the wavefront at a resolution of @xmath0@xmath1 .",
    "the dotf method relies on localized diversities at the pupil border , which is a unique feature compared to other focal - plane wavefront sensing techniques .",
    "it requires no complicated hardware , physical movement of optical components or demanding numerical computations , and it therefore is an excellent option when an easily implementable way to accurately determine the pupil - plane electric field with a focal - plane camera is needed .",
    "we have outlined how to theoretically predict the performance of the method , and our simulations are able to explain the experimental results  apart from the instability issues related to our hardware .    based on theorical reasoning , we know that the ultimate resolution of the dotf method is limited by the size and shape of the used diversity ; it determines the convolution kernel that blurs the original complex amplitudes . in our experiments ,",
    "the used diversity gives a maximum resolution between @xmath0@xmath77 and @xmath0@xmath78  pixels  but the resolving power can be different in vertical and horizontal directions .",
    "a visual inspection is in agreement with these values , although read - out noise and instabilities reduce the practical resolution of the instantaneous dotf arrays .    to increase the calibration accuracy , we have used the fact that our wavefront corrector , an slm , forms a fixed , rectangular array of evenly distributed pixels .",
    "we used the dotf method to detect the sharp borders caused by modified wavefront blocks , and using those borders , we calculated the optimal affine transform projecting the slm pixel locations onto the physical pupil plane . based on the match of that mapping ,",
    "we conclude that the locations of the slm pixels are determined with an accuracy of 0.3% with respect to the pupil diameter .",
    "this paper concentrates on concepts necessary for future extreme adaptive optics systems like the one necessary for the direct exoplanet imager elt - pcs @xcite .",
    "however , the methods discussed here are very versatile , and they can be put into use in many systems  in principle everywhere where measurements of optical aberrations are needed .    we have used the slm to generate the localized diversities .",
    "however , they could as well be created by high - resolution deformable mirrors such as in @xcite .",
    "also , additional simple mechanics at the pupil edge could be used to introduce a small , localized obstruction as a diversity .",
    "the technique is best suited for applications where a monochromatic light source is available .",
    "if the spectral bandwidth is increased , the diffraction features further off - axis are blurred , which implies that higher spatial frequency information in the dotf reconstruction is lost .",
    "however , lower spatial frequencies can still be recovered to some extent @xcite .",
    "high - contrast speckle - nulling experiments have demonstrated good success using 10% bandwidth @xcite , and probably a similar bandwidth is feasible also with the dotf method . cases that will benefit from the dotf calibration are test benches demonstrating techniques for ultra - high contrast imaging needed in space - based exo - planet detection ( e.g. , hcit @xcite ) , experiments for ground - based extreme adaptive optics ( exao testbed @xcite , hot @xcite , ffree @xcite ) and the path - finder xao instruments ( gpi @xcite , sphere @xcite ) .",
    "the main issue with the dotf method is the measurement noise .",
    "we need a recording time of 24  min for each dotf measurement to reduce the read - out noise and achieve the required high dynamic range . during this recording process ,",
    "the system behavior should be stationary .",
    "however , we observed the drift of the slm when trying to increase the measurement time to more than 5  min ; a real dm would likely be better .",
    "internal turbulence in the optical setup can also be a serious problem .",
    "another point of concern is the resolution of the pupil plane measurement .",
    "it is ultimately limited by the size of the localized diversity , and we proposed to create it with the wavefront corrector elements .",
    "thus , it is necessary that the elements are evenly spaced across the pupil and that they have identical response .",
    "what we can measure is limited to the response of larger blocks of the correction elements  when a typical deformable mirror is used to introduce the diversity , the coupling of the actuators is an additional challenge .",
    "our future work will concentrate on demonstrating how the dotf method can be used in a wider range of optical experiments .",
    "these include additional optics such as apodizers and coronagraphs .",
    "in addition , we will include a more detailed analysis of the light propagation effects from the wavefront corrector to the last pupil plane .",
    "we thank gerard van harten and tim van werkhoven for assistance with the spatial light modulator and optical experiments .",
    "c.  u. keller , v.  korkiakoski , n.  doelman , r.  fraanje , r.  andrei , and m.  verhaegen , `` extremely fast focal - plane wavefront sensing for extreme adaptive optics , '' ( 2012 ) , vol .",
    "8447 of _ proc .",
    "spie _ , pp .",
    "844721844721 .",
    "v.  korkiakoski , c.  u. keller , n.  doelman , r.  fraanje , r.  andrei , and m.  verhaegen , `` experimental validation of optimization concepts for focal - plane image processing with adaptive optics , '' ( 2012 ) , vol .",
    "8447 of _ proc .",
    "spie _ , pp .",
    "84475z84475z .",
    "s.  mann and r.  picard , `` being ` undigital ' with digital cameras : extending dynamic range by combining differently exposed pictures , '' tech .",
    "323 , m.i.t . media lab perceptual computing section , boston , massachusetts ( 1994 ) .",
    "j.  remnyi , p.  vrhegyi , l.  domjn , p.  koppa , and e.  lorincz , `` amplitude , phase , and hybrid ternary modulation modes of a twisted - nematic liquid - crystal display at @xmath0400 nm , '' * 42 * , 34283434 ( 2003 ) .",
    "l.  a. poyneer , b.  bauman , s.  cornelissen , j.  isaacs , s.  jones , b.  a. macintosh , and d.  w. palmer , `` the use of a high - order mems deformable mirror in the gemini planet imager , '' in `` spie moems - mems , '' ( 2011 ) , proc .",
    "spie , pp .",
    "793104793104 .",
    "a.  e. lowman , j.  t. trauger , b.  gordon , j.  j. green , d.  moody , a.  f. niessner , and f.  shi , `` high - contrast imaging testbed for the terrestrial planet finder coronagraph , '' ( 2004 ) , vol .",
    "5487 of _ proc .",
    "spie _ , pp .",
    "12461254 .",
    "s.  a. severson , b.  bauman , d.  dillon , j.  evans , d.  gavel , b.  macintosh , k.  morzinski , d.  palmer , and l.  poyneer , `` the extreme adaptive optics testbed at ucsc : current results and coronagraphic upgrade , '' ( 2006 ) , vol .",
    "6272 of _ proc .",
    "spie _ , pp .",
    "62722j62722j .",
    "e.  vernet , m.  kasper , c.  vrinaud , e.  fedrigo , s.  tordo , n.  hubin , s.  esposito , e.  pinna , a.  puglisi , a.  tozzi , a.  g. basden , s.  j. goodsell , g.  d. love , and r.  m. myers , `` extreme adaptive optics system optimization with the high order test bench , '' ( 2006 ) , vol .",
    "6272 of _ proc .",
    "spie _ , p. 62722k .",
    "j.  antichi , c.  vrinaud , o.  preis , a.  delboulb , g.  zins , p.  rabou , j .- l .",
    "beuzit , s.  dandy , j .- f .",
    "sauvage , t.  fusco , e.  aller - carpentier , m.  kasper , and n.  hubin , `` ffree : a fresnel - free demonstrator for the common - path optics within epics , '' in `` in the spirit of lyot 2010 , '' ( 2010 ) .",
    "b.  macintosh , j.  graham , d.  palmer , r.  doyon , d.  gavel , j.  larkin , b.  oppenheimer , l.  saddlemyer , j.  k. wallace , b.  bauman , j.  evans , d.  erikson , k.  morzinski , d.  phillion , l.  poyneer , a.  sivaramakrishnan , r.  soummer , s.  thibault , and j .-",
    "veran , `` the gemini planet imager , '' ( 2006 ) , vol .",
    "6272 of _ proc .",
    "spie _ , p. 62720l .",
    "t.  fusco , g.  rousset , j .- f .",
    "sauvage , c.  petit , j .-",
    "beuzit , k.  dohlen , d.  mouillet , j.  charton , m.  nicolle , m.  kasper , p.  baudoz , and p.  puget , `` high - order adaptive optics requirements for direct detection of extrasolar planets : application to the sphere instrument , '' opt .",
    "express * 14 * , 75157534 ( 2006 ) ."
  ],
  "abstract_text": [
    "<S> we present a method to calibrate a high - resolution wavefront - correcting device with a single , static camera , located in the focal - plane ; no moving of any component is needed . </S>",
    "<S> the method is based on a localized diversity and differential optical transfer functions ( dotf ) to compute both the phase and amplitude in the pupil plane located upstream of the last imaging optics . </S>",
    "<S> an experiment with a spatial light modulator shows that the calibration is sufficient to robustly operate a focal - plane wavefront sensing algorithm controlling a wavefront corrector with @xmath040  000 degrees of freedom . </S>",
    "<S> we estimate that the locations of identical wavefront corrector elements are determined with a spatial resolution of 0.3% compared to the pupil diameter . </S>"
  ]
}