{
  "article_text": [
    "at present , imaging of hard x - rays ( hxr ) and gamma rays ( gr ) is only feasible by selective absorption using different kinds of masks .",
    "an elegant and economic variant uses rotation collimators ( schnopper 1968 , willmore 1970 , skinner and ponman 1995 ) where a pair of absorbing grids rotates between the true scene and a spatially non - resolving detector ( fig .",
    "[ rmc_fig ] top ) . depending on whether a source is behind or between the grid bars , the observed flux is low or large . as rotation progresses , the true scene becomes thus encoded in a temporal _ modulation _ of the observed hxr / gr flux ( fig .",
    "[ rmc_fig ] bottom ) . in this process",
    ", the modulation frequency is not constant but varies with time : glancing passages of the grid bars produce slow modulation , and rippling passages yield fast modulation .",
    "the absolute value of the modulation frequency also depends on the offset of the source from the rotation axis , and the modulation amplitude depends on the source size compared to the grid period , in such a way that the amplitude is largest for a point source , and tends to zero if the source size exceeds the grid period .",
    "altogether , this results in a characteristic time series , from which the true scene can be reconstructed by suitable inverse methods ( skinner 1979 , prince et al 1988 , skinner and ponman 1995 , hurford et al 2002a ) . while such methods usually assume that the true scene does not depend on time , the present article deals with the complementary problem of estimating the true _ time _",
    "dependence of the ( spatially integrated ) scene , and distinguishing it from rotation modulation .",
    "this is called here the ` _ demodulation _ ' problem .",
    "the data which we envisage are obtained by the reuven ramaty high - energy solar spectroscopic imager ( rhessi , lin et al 2002 ; zehnder et al 2003 ) .",
    "this solar - dedicated space mission uses rotation modulation for hxr / gr imaging of solar eruptions .",
    "the rhessi instrument has 9 pairs of aligned hxr / gr - absorbing grids ( 9 ` subcollimators ' ) which are fixed on the rotating spacecraft .",
    "different subcollimators have different grid spacings , which produce sinusoidal spatial transmission patterns ( see section [ rhessi_sect ] for details ) . behind each subcollimator",
    "there is a germanium detector which records the arrival time and energy ( 3 kev - 17 mev ) of the incoming hxr / gr photons . from a statistical point of view",
    ", the photon arrival times form a poisson process with non - constant intensity .",
    "the change in intensity is due to rotation modulation , but may also have contributions from the time dependence of the true scene .",
    "the latter is highly interesting from a solar physics point of view , because it is related to particle acceleration in impulsive solar eruptions .",
    "the existence of temporal fluctuations of the true hxr scene down to time scales of hundred milliseconds has been confirmed by earlier observations ( dennis 1985 , machado et al 1993 , aschwanden et al 1993 ) . however , these time scales interfere with the rhessi rotation modulation which occurs on time scales of milliseconds to seconds . in order to disentangle time dependence of the true scene from rotation modulation the rhessi data must be demodulated .",
    "the most general outcome of this process would be the true scene as a function of both space and time .",
    "but the information contained in the photon counts is rather limited , and must be shared between spatial and temporal degrees of freedom of the true scene .",
    "we therefore restrict ourselves here to the simpler problem of estimating the spatially integrated true scene as a function of time .",
    "the motivation for this stems also from the wish to compare rhessi hxr data with spatially integrated broadband radio observations .",
    "both types of radiation are emitted by electrons of comparable energy , and there is some controversy in the field whether or not the two populations actually agree .",
    "the actual radio observations have a time resolution of 100 milliseconds , and collect radiation from the whole sun .",
    "the demodulation of rhessi data is , in general , an inverse problem .",
    "temporal and spatial variations of the true scene are entangled by the observation method .",
    "an exception only arises if the time scale of interest exceeds the rhessi rotation period @xmath0 @xmath1 4s , so that demodulation can be replaced by a running average over @xmath0 .",
    "otherwise , a good estimator for the spatially integrated scene requires some a priori information on its spatial structure in order to outweigh or damp the rotational modulation .",
    "such information may either come from independent observations , or from rhessi itself . in the latter case , one may use standard rhessi imaging techniques ( hurford et al 2002a ) to obtain an estimate of the time - averaged true scene .",
    "these techniques assume that the true scene is independent of time . under this assumption",
    ", the true scene can be estimated after half a spacecraft rotation , when all possible grid orientations are cycled , and higher - quality results arise from multiples of @xmath2 .",
    "the aim of the present paper is to resolve time scales @xmath3 @xmath2 .",
    "we do not attempt here a fully general solution where the spatially true integrated scene is found at each point of time .",
    "instead , we will assume that the true scene can be considered as piecewise constant during time intervals @xmath4 of order of 100 ms .",
    "such intervals are shorter than most previously reported time scales , and they also agree with the time resolution of the comparative radio observations mentioned above .",
    "the present article describes an efficient linear estimator for the spatially- and @xmath4-integrated scene .",
    "the construction of the estimator follows the lines of classical wiener filtering ( rybicki and press 1992 ) , but operates in time ( not frequency ) space .",
    "the paper is organized as follows .",
    "section [ rhessi_sect ] summarizes some relevant technicalities of the rhessi instrument .",
    "section [ method_sect ] presents our inverse theory approach including counting statistics ( sect .",
    "[ principle_sect ] ) and a priori information ( sect . [ prior_sect ] ) .",
    "the resulting estimator is then discussed in sections [ uniform_sect ] - [ mechanism_sect ] , and its performance ( sect .",
    "[ performance_sect ] ) and robustness against violation of the prior assumptions ( sect .",
    "[ robustness_sect ] ) are explored by monte carlo simulations .",
    "section [ flare_sect ] shows the algorithm at work on real data from a solar eruption .",
    "[ notation ] for an overview of notation .",
    "angular position @xmath5 = ( @xmath6 ) is measured in locally cartesian heliocentric coordinates , and the dependence on @xmath5 is therefore also termed ` spatial ' .",
    "one arc second ( 1  ) corresponds to 700 km on the solar disc .",
    "[ notation ] [ cols= \" < , < \" , ]",
    "we start with a brief description of the rhessi response to hxrs and grs , which defines the ` forward ' problem of converting the true scene into the observed counts .",
    "we shall only consider photons out of a fixed energy band , average all energy - dependent quantities over that energy band , and omit the energy dependence in the notation .",
    "the instantaneous transmission probabilities of rhessi s subcollimators , as a function of photon incidence direction , are called the modulation patterns .",
    "they may be visualized as the grids shadow on the sky plane if the detectors were operated in a transmitting mode . when expressed in terms of heliocentric cartesian",
    "coordinates @xmath7 ( over the limited rhessi field of view , cartesian and angular coordinates are equivalent ) , the modulation patterns can be approximated by    @xmath8    above , the @xmath9 , @xmath10 = 1 .. 9 , are the grid vectors which rotate clockwise with the spacecraft rotation period @xmath0 .",
    "all grid periods ( @xmath11 asec ) are small compared to the solar diameter ( 1920  ) and to the fields of view of the individual subcollimators ( 3600  ... 27.000  ) . the coefficients ( @xmath12 )",
    "describe the internal shadowing of the grids ; they depend on photon energy and only weakly on time as long as the source is in the central part of the field of view , which is the case for solar sources .",
    "the vector @xmath13 is the imaging ( optical ) axis .",
    "it generally varies with time , since it is not aligned with the rotation axis , which , in turn , may differ from the inertial axis . as a consequence ,",
    "@xmath13 traces out a relatively complicated orbit on the solar disc , which is continuously monitored by the onboard aspect systems ( fivian et al 2002 , hurford et al 2002b ) , and the details of which need not concern us here . all vectors @xmath5 , @xmath14 and @xmath13 ly in the solar plane .      in order to avoid detector and telemetry saturation ,",
    "mechanical attenuators can be inserted into the optical path , and photon counts can be decimated by a clocked veto : during one binary microsecond ( 1b@xmath15s = 2@xmath16s ) , all events are accepted , during the next ( @xmath17)b@xmath15s , they are all rejected . both reduction methods",
    "preserve the statistical independence of the photon arriving times , and can be absorbed in the definition of the modulation patterns .",
    "while equation ( [ modpat ] ) represents the ideal instrumental response , the real observations suffer from several non - idealities such as detector saturation at high count rates , and sporadic breakdown of the whole detection chain .",
    "the latter is presumably caused by cosmic rays ( smith et al 2002 ) ; the resulting data gaps occur at random about once per second , and have durations of milliseconds to seconds ( see fig .",
    "[ rmc_fig ] bottom for an example ) .",
    "all non - idealities are combined on - ground in livetime measures 0 @xmath18 @xmath19 @xmath18 1 , which estimate the operational fraction of each detector in a given time bin .",
    "the effect of livetime is taken into account by multiplying the modulation patterns @xmath20 by @xmath19 .",
    "times with @xmath21 are discarded , which prevents detector saturation and redundant or undefined ( @xmath22 ) numerical operations .",
    "let @xmath23 denote the solar brightness distribution at position @xmath5 and time @xmath24 , and let the rhessi counts be grouped in time bins @xmath25 where @xmath15 = ( @xmath10 , @xmath26 ) labels subcollimator and time .",
    "the set @xmath27 may comprise all or only some of the 9 subcollimators , and different subcollimators may have different time bins .",
    "the observed counts @xmath28 in different bins @xmath29 are supposed to be statistically independent poisson variates with expectation values    @xmath30    where we have written @xmath31 to extract the subcollimator index out of @xmath15 . non - solar background is neglected .",
    "the goal is to estimate spatially integrated true scene    @xmath32    in the time interval @xmath4 , as would be observed in the absence of the subcollimators ( @xmath33 ) .",
    "the estimator @xmath34 for @xmath35 is searched in the linear form    @xmath36    in the sequel we shall choose @xmath37 to make @xmath34 efficient , i.e. , unbiased and minimum - variance among all unbiased estimators . to this end , and for the sake of a concise notation , we first introduce the expectation operator @xmath38 of a general function @xmath39 of the true @xmath35 and of the observed counts @xmath40 .",
    "this is done within a bayesian framework where each true scene @xmath41 has assigned a prior probability @xmath42 , so that @xmath43 .",
    "one thus has    @xmath44    where @xmath45 and @xmath35 depend on @xmath41 according to equations ( [ lambda ] ) and ( [ b ] ) .",
    "the expectation operator ( [ e ] ) involves an average over the counting statistics , followed by an average over the prior scenes , and we write @xmath46 to stress this sequence .",
    "if a quantity @xmath47 is independent of the observed counts @xmath48 then @xmath49 reduces to @xmath50 .",
    "so far , @xmath50 is still a formal object .",
    "let us accept this for the moment , and proceed with the design of the weights @xmath51 .",
    "a first natural request is that the estimator ( [ hat(b ) ] ) is unbiased , @xmath52 , requiring that    @xmath53    this condition locates @xmath54 along the direction of @xmath55 . in order to find a unique solution @xmath54 we additionally require the variance @xmath56 to be minimal , and",
    "verify a posteriori that this condition is sufficient to ensure uniqueness of the solution .",
    "unbiasedness and minimum - variance constraints are combined by minimizing @xmath57 with respect to @xmath54 , where the lagrange multiplier @xmath58 must be adjusted to fulfill equation ( [ unbiased ] ) .",
    "the resulting minimum condition is    @xmath59    or , after performing the average @xmath60 over counting statistics ,    @xmath61    here it was used that @xmath62 for independent counts @xmath28 .",
    "one may now see that equation ( [ min_cond2 ] ) has indeed a unique solution @xmath54 if only @xmath63 . under this condition ,",
    "the matrix @xmath64 is strictly positive definite : @xmath65 for all @xmath66 .",
    "since the prior average @xmath50 represents a sum of positively weighted @xmath67 s , the matrix @xmath68 is also positive definite and therefore invertible  indeed , the condition number of @xmath69 can not exceed the condition number of @xmath67 .",
    "let us add at this point an interpretation of the matrix @xmath67 .",
    "for any fixed realization of the true scene @xmath41 , the fluctuations of the observed counts @xmath28 have two causes : instrumental modulation and counting noise .",
    "these two causes give rise to the two contributions @xmath70 and @xmath71 in the matrix @xmath72 . at large count rates ( @xmath73 , @xmath72 is dominated by @xmath70 , and at small count rates ( @xmath74 ) it is dominated by @xmath71 .",
    "the condition number of @xmath72 increases with increasing count rates and is bounded from above by @xmath75 .",
    "thus , higher count rates allow weaker - conditioned @xmath72",
    ". we may interpret this by saying that the counting noise regularizes the problem of inverting modulation , and that the amount of regularization is given by the level of poisson fluctuations compared to the modulation amplitude .",
    "we turn now to the definition of @xmath50 ( eq . [ e ] ) .",
    "formally , the true brightness distribution @xmath23 is an element of a function space , and its a priori probability measure @xmath76 is a functional . in order to avoid technical complications",
    "while retaining the basic probabilistic features , we make the following simplifying assumptions : the true brightness distribution @xmath23 is concentrated in a ( known ) spatial prior , where it may have ( unknown ) substructures which do not vary significantly during the time interval @xmath4 for which the unmodulated counts are to be estimated .",
    "thus @xmath77 for @xmath78 .",
    "now we recall that @xmath79 enters the problem only upon weighting with the modulation paterns ( eq . [ lambda ] )",
    ". therefore the detailed structure of @xmath79 on scales which are small compared to the period of the modulation patterns do not matter , and we may represent @xmath79 by a ( finite ) collection of point sources    @xmath80    with the agreement that @xmath81 and that the spacing between the @xmath82 is not less than the finest resolvable scale @xmath83 .",
    "since we do not wish to introduce any bias into the brightness distribution , except for its localization in the prior region , we set @xmath76 = @xmath84 where @xmath85 is a pdf concentrated in the prior region .",
    "this definition of @xmath76 is insensitive to the amplitude of @xmath41 but sensitive to its support .",
    "applying @xmath50 reduces now to an elementary calculation , and equation ( [ min_cond2 ] ) becomes    @xmath86 w_\\nu = ( \\tau - \\zeta \\beta^{-1 } ) \\langle m_\\mu \\rangle \\label{result}\\ ] ]    with    @xmath87    equation ( [ result ] ) is our main result .",
    "the parameter 0 @xmath18 @xmath88 @xmath89 1 is a ` filling factor ' : @xmath88 = 0 corresponds to a single unresolved source , whereas @xmath88 @xmath90 1 stands for a prior region densely covered with sources . if the diameter of the prior region exceeds the angular pitch , then @xmath88 @xmath90 1 indicates the loss of modulation , while @xmath88 = 0 retains full modulation , yet at an unknown phase .",
    "note that @xmath91 is the quantity which actually is to be estimated .",
    "its occurrence in equation ( [ result ] ) is , however , unproblematic . on the right hand side , @xmath91 is absorbed in the lagrange multiplier @xmath58 . on the left hand side",
    ", @xmath91 occurs in the regularization only , where it may be replaced by a simpler estimate @xmath92 ( sect .",
    "[ uniform_sect ] ) without qualitatively changing the solution .",
    "since @xmath58 only affects the scaling of the right hand side vector in equation ( [ result ] ) , its adjustment for unbiasedness ( eq . [ unbiased ] ) is equivalent to re - scaling @xmath93 , which is easily implemented numerically .",
    "it remains to select the pdf @xmath85 .",
    "our choice is largely ad hoc , and must be justified by demonstrating that the resulting estimator @xmath34 remains efficient and well - behaved even if the prior assumptions are violated . this will be done in sections [ performance_sect ] and [ robustness_sect ] . here",
    "we qualitatively motivate our choice .",
    "first of all , @xmath85 should be simple and depend on not more than a few parameters in order to facilitate operational data processing .",
    "one set of parameters which is provided by the rhessi data products is the centroid @xmath94 of the hxr emission derived from time - integrated ( @xmath95 ) rhessi imaging .",
    "it is natural to center @xmath85 on @xmath94 . in addition to the centroid we would like to specify the rough size @xmath96 of the prior region , but not any of its details , since these are not known on time scales as small as @xmath4 .",
    "the choice of @xmath96 reflects the uncertainty of the true scene , and may be based on rhessi imaging or on independent observations . in particular , we may chose @xmath96 such as to cover a solar ` active region ' ( howard 1996 ) derived from magnetic field observations . in any case , @xmath96 should not be unrealistically small ; simulations ( sect .",
    "[ robustness_sect ] ) suggest that @xmath97 is a reasonable , conservative , choice .",
    "owing to the inherent rotation symmetry of the rotation modulation observing principle , it is suggestive to choose an isotropic form for @xmath85 , although this is by no means a rigorous request . from a practical point of view",
    "it is also important that the integrals in equation ( [ m2 ] ) and ( [ mm2 ] ) can be performed analytically as far as possible to save numerical operations .",
    "a choice which fulfills the above criteria is    @xmath98    since the coefficients @xmath99 and @xmath100 in equation ( [ modpat ] ) are slowly varying with time , they may be replaced by discrete - time versions @xmath101 and @xmath102 .",
    "equations ( [ m2 ] , [ mm2 ] ) then become    @xmath103 \\langle m_\\mu m_\\nu \\rangle & = & \\sum_{s=\\pm1 } \\sum_{m , n=0}^{1 } \\frac{a_{m\\mu } a_{n\\nu}}{2 }               e^{-\\frac{l^2}{2}(|m{\\bf k}_{i(\\mu)}|^2+|n{\\bf k}_{i(\\nu)}|^2)}\\int_{\\delta_\\mu }               \\hspace{-2 mm } dt \\int_{\\delta_\\nu } \\hspace{-2 mm } dt ' \\times \\label{mmc } \\\\          &   & \\times   e^{-l^2 smn { \\bf k}_{i(\\mu)}\\hspace{-.5mm}(t ) \\cdot { \\bf k}_{i(\\nu)}\\hspace{-.5mm}(t ' ) }           \\cos \\big ( m\\phi_\\mu \\hspace{-.5mm}(t ) + sn\\phi_\\nu \\hspace{-.5mm}(t ' )",
    "\\big ) \\nonumber\\end{aligned}\\ ] ]    with @xmath104@xmath105 @xmath106 @xmath107 . on time scales",
    "@xmath108 , mostly terms with @xmath109=@xmath110 contribute to equation ( [ mmc ] ) .",
    "the time integrals in equations ( [ mc ] ) and ( [ mmc ] ) , which depend on the actual spacecraft motion , are evaluated numerically .",
    "rhessi detects individual photons , and their assignment to time bins is an important first step of the demodulation procedure .",
    "there are two , potentially conflicting , requests on the time bins @xmath29 . on the one hand",
    ", @xmath29 should resolve ( say , by a factor 10 ) the instantaneous modulation period @xmath111 \\label{tau_mod}\\ ] ] of a source at position @xmath94 .",
    "on the other hand , demodulation is only beneficial if there are sufficient counts to observe modulation against poisson noise .",
    "this requires , empirically , some 5 counts per time bin .",
    "in addition , the time bins should be integer fractions of @xmath4 in order to minimize roundoff error .",
    "we therefore adopt the following rule :    @xmath112    where @xmath113 is the average count rate [ ct / s ] in subcollimator @xmath10 .",
    "the factors 5 and 10 in equation ( [ choice_of_delta_t ] ) are empirical .      equations ( [ mc ] ) and ( [ mmc ] ) are evaluated by an extended trapezoidal rule with intermediate step size adapted to the modulation frequency and amplitude .",
    "the inversion of the matrix on the left hand side of equation ( [ result ] ) is performed by singular value decomposition ( golub and van loan 1989 ) with explicit control of condition number .",
    "let us start our discussion by verifying that the estimator ( [ hat(b ) ] ) remains well - behaved and meaningful in extreme cases where the prior is pointlike or flat , and where the observed flux tends to zero .",
    "the limit of infinite flux is discussed in sect .",
    "[ geom_sect ] .    at very low count rates ( @xmath3 1 ct/@xmath114 ) , modulation is no longer observable , and one may thus expect that @xmath34 should reduce to a simple average , which is an efficient estimator for the pure counting noise problem . indeed , in the limit @xmath91 @xmath90 0 ,",
    "equation ( [ result ] ) yields ( after adjusting @xmath58 to satisfy eq .",
    "[ unbiased ] )    @xmath115    equation ( [ uniform ] ) will be referred to as ` uniform average ' since it involves uniform weights ( @xmath37=const ) .",
    "the last approximation in equation ( [ uniform ] ) holds if the modulation is fast ( @xmath116 ) or weak ( @xmath117 ) , so that the term with @xmath118=1 in equation ( [ mc ] ) can be neglected .",
    "the uniform average @xmath92 provides a simple guess of @xmath35 , which is - hopefully  improved by the more sophisticated estimator ( [ hat(b ) ] ) .",
    "we shall see in sect .",
    "[ performance_sect ] - [ robustness_sect ] that this is in fact the case .",
    "the uniform average ( [ uniform ] ) is also attained if @xmath96 = 0 or @xmath88 = 1 , both representing deterministic limits with completely localized or densely filled prior regions . in either case",
    ", the term @xmath119 reduces to @xmath120 , so that equation ( [ result ] ) has the solution @xmath37 = const , and @xmath34 reduces to @xmath92 .",
    "another situation of interest is @xmath121 where the prior becomes globally flat . for @xmath121",
    "one can derive from equations ( [ mc]-[mmc ] ) that @xmath122 and @xmath123 .",
    "thus equation ( [ result ] ) can be inverted by the sherman - morrison formula ( press et al 1998 ) , and one finds ( after adjusting @xmath58 )    @xmath124    from equation ( [ flat ] ) the uniform average ( [ uniform ] ) is recovered if @xmath125 .",
    "otherwise a correction arises which weakly varies with time ( sect .",
    "[ rhessi_sect ] ) .",
    "bins with large modulation amplitude @xmath126 are given less weight in equation ( [ flat ] ) , which is reasonable since their uncertainty is larger .",
    "in summary , we have found that the estimator ( [ hat(b ) ] ) has well - defined and meaningful analytic limits when the flux tends to zero ( @xmath127 ) , and when the prior is completely restrictive ( @xmath128 ) or completely nonrestrictive ( @xmath121 ) .      in the limit of infinite count rates ,",
    "the counting noise becomes unimportant and equation ( [ result ] ) admits a purely geometrical interpretation .",
    "recalling the assumption @xmath77 for @xmath78 , one has that @xmath129 with @xmath130 and @xmath131 .",
    "therefore @xmath132 is a good estimator for @xmath35 for _ arbitrary _",
    "@xmath79 if @xmath133 is independent of @xmath5 .",
    "the modulation patterns would then be canceled . however , the functions @xmath134 are neither orthogonal nor complete , so that @xmath133 can not be made constant by whatever choice of weights @xmath37 .",
    "instead , we may try to minimize the fluctuations of @xmath133 within the spatial prior @xmath85 , and therefore minimize @xmath135 .",
    "this yields @xmath136 . comparing this expression to equation ( [ result ] )",
    "we see that equation ( [ result ] ) minimizes the fluctuations of @xmath133 within the spatial prior under the maximum - modulating assumption that there is a single point source ( @xmath137 ) observed at infinite count rate ( @xmath138 ) .",
    "the matrix @xmath139 is generally ill - conditioned , and the weights @xmath140 therefore oscillate . at finite count rate , the excursions to large @xmath141 amplify the poisson noise , and thereby impair the estimator @xmath34 ( eq . [ hat(b ) ] ) .",
    "an optimum estimator must thus limit the oscillations of @xmath54 to a level which commensurates with the poisson noise .",
    "equation ( [ result ] ) provides a possible trade - off .",
    "[ phi_fig ] illustrates the resulting function @xmath133 for @xmath88 = 0 and different @xmath91 , using aspect data of february 26 2004 , subcollimators ( 3,4,5,6 ) , and @xmath4 = 0.2s .",
    "the time bins @xmath29 are ( 2.8 , 4.8 , 8.5 , 15)ms , and the spatial prior ( size @xmath96 = 40  ) is centered at the source position ( 245  , 340  ) estimated from time - integrated rhessi imaging . the black mask in fig . [ phi_fig ] indicates the 10% level of the spatial prior ( eq . [ prior ] ) . in order to assess the constancy of @xmath133 we consider the standard deviation @xmath142 and mean @xmath143 inside the black mask . in a noiseless world",
    "( @xmath138 ) , the modulation patterns would admit @xmath144 0.0058 ( fig .",
    "[ phi_fig]a ) . taking the actual counting noise ( @xmath145 6200 ct / s ) into account ,",
    "@xmath144 0.024 is still achievable ( fig .",
    "[ phi_fig]b ) . for comparison , the uniformly weighted ( @xmath37=const ) case is also shown ( fig .",
    "[ phi_fig]b , @xmath144 0.14 ) , which corresponds to the limit @xmath127 .",
    "as can be seen , the function @xmath133 becomes less efficient in canceling the modulation patterns when the count rate @xmath91 decreases .",
    "but , at the same time , the sensitivity of @xmath34 to poisson noise increases . the trade - off chosen by the present method is shown in fig .",
    "[ phi_fig]b .      in a generic situation ( @xmath88@xmath1461 , @xmath96@xmath147=0 , @xmath92@xmath1481 )",
    "one may identify three mechanisms by which the weights operate .",
    "these are most easily discussed in terms of fourier modes of the modulation .",
    "first , if the modulation phase is resolved ( @xmath149 ) then modulation can ` actively ' be countersteered .",
    "secondly , if the modulation phase is not resolved but the instantaneous modulation frequency @xmath150 ( eq . [ tau_mod ] ) is known , then counts with @xmath151 can be suppressed because they do not allow a ` passive ' averaging .",
    "this suppression works for each subcollimator individually .",
    "( although @xmath114 does not explicitly show up in equation ( [ result ] ) , it is implicitly contained in the diagonal blocks of correlation function @xmath152 , see fig .",
    "[ mm_fig ] below ) .",
    "thirdly , the matrix @xmath152 couples different subcollimators , which regulates the relative weighting of different subcollimators .",
    "the different mechanisms are illustrated in figures [ cw_fig ] and [ mm_fig ] , showing simulated data of subcollimators ( 4,5,6,7 ) with @xmath94 = ( 885,161  ) , @xmath96 = 20  , @xmath88 = 0.2 , and a single intense ( @xmath153 3@xmath154@xmath155",
    "ct / s / subcollimator ) point source located at @xmath94 .",
    "the chosen geometry represents a solar limb source .",
    "the simulated counts are divided into disjoint intervals of duration @xmath4 = 0.25s ( fig .",
    "[ cw_fig ] ) , and time bins are equal ( @xmath29 = 0.0025s ) for better comparability .",
    "the outweighing of modulation is most clearly seen in the coarsest subcollimator ( fig .",
    "[ cw_fig ] , # 7 ) with @xmath156 = 0.16 , where @xmath157 = 122  is the period of subcollimator # 7 .",
    "the modulation is also  though less efficiently  outweighed in subcollimator # 6 ( @xmath158 = 0.28 ) , while the finest subcollimators # 5 ( @xmath159 = 0.49 ) and # 4 ( @xmath160 = 0.85 ) mostly operate in an averaging mode , with priods of low @xmath161 being suppressed .",
    "the different regimes manifest in different forms of the correlation @xmath152 ( fig .",
    "[ mm_fig ] ) . for @xmath162 @xmath3 1",
    "the matrix @xmath152 approximately factorizes into @xmath163 ( fig .",
    "[ mm_fig ] , # 7 ) . with increasing @xmath162 ,",
    "the autocorrelation of a single subcollimator takes the form @xmath164 with decay time @xmath165 @xmath153 @xmath166 ( eq . [ mmc ] ) . here ,",
    "both @xmath165 and @xmath114 depend to first order on @xmath167 , which results in the ` chirping ' behaviour of fig .",
    "[ mm_fig ] , subcollimator # 4 .",
    "the chirp towards low modulation frequencies is associated with a drop of the corresponding weights ( fig .",
    "[ cw_fig ] top , time interval in dashed lines ) .",
    "the quality of the demodulation and its robustness against violation of prior assumptions have been explored by monte carlo simulations .",
    "figure [ performance_fig ] shows , as an example , the relative errors @xmath168 of @xmath169 simulated time intervals @xmath4 , together with uniform values @xmath170 and the relative poisson error @xmath171 with @xmath172 the total number of counts in @xmath4 . dots illustrate a subsample of the simulation ; graphs represent the full ensemble averages .",
    "the spatial prior is centered at @xmath94 = ( 420  , -630  ) and has size @xmath96 = 40  . the simulated brightness distribution is a superposition of 10 random sources @xmath173 with uniform relative amplitudes @xmath174 , gaussian positions @xmath175 ( mean @xmath94 , variance @xmath176 ) , uniform sizes @xmath177 @xmath178 ( 1@xmath1795  ) , and uniform intrinsic time scales @xmath180 @xmath178 ( 0.2s@xmath1791s ) . the assumed filling factor is @xmath88 = 0.2 , whereas the true value scatters from 0.8 to 0.9 .",
    "data gaps are neglected . at low count rates ,",
    "the error is dominated by the poisson noise , and all three types of error coincide . at higher count rates ,",
    "the error becomes dominated by modulation , and the uniform average no longer improves with improving counting statistics .",
    "the estimator @xmath34 performs better , and reaches the poisson limit for integration times @xmath4 @xmath181 8ms and count rates up to @xmath169 ct / s / subcollimator .",
    "the latter is , in fact , the practically relevant range  higher count rates do not occur because the rhessi detectors need @xmath182 8@xmath154@xmath183s to recover after each photon impact .",
    "one may thus be confident that  at least with regard to the ( tolerant ) error measure @xmath184  the estimator @xmath34 works optimally for practical purposes .",
    "the degradation of @xmath168 at highest count rates and largest @xmath4 is attributed to the increased susceptibility to prior assumptions , and possibly also to numerical errors as the involved matrices become large and weak - conditioned .",
    "( condition numbers up to @xmath169 occur at @xmath185 ct / s / subcollimator . )",
    "extended simulations including different brightness distributions , data gaps , and @xmath88 values yielded similar results .      an important practical feature of bayesian inverse methods is their robustness against violation of the prior assumptions .",
    "if a wrong prior is used , then the result will be degraded but it should not become ( much ) worse than if no prior was used at all ( i.e. , if the weights were uniform or the prior was flat , @xmath121 ) . we shall now demonstrate that this goal is met by our demodulation method .",
    "figure [ robustness_fig ] shows simulations performed at fixed count rate of @xmath186 ct / s / subcollimator and fixed integration time @xmath4 = 0.12s , but with varying size @xmath96 of the prior region , and with different offsets between the true and prior centroids . in each simulation , a prior centroid @xmath94 is chosen at random across the solar disc , and the true centroid is placed @xmath187 arc seconds away in random direction .",
    "the true source has several gaussian components , which are all concentrated in a narrow ( 3  ) region around the true centroid .",
    "the simulated imaging axis @xmath13 moves within the central ( @xmath89200  ) region of the solar disc .",
    "while the cases @xmath188 reflect realistic uncertainties of rhessi observations , 50  being a conservative value , the case @xmath189 is overly pessimistic and is included here for demonstration purposes .",
    "the relative errors ( vertical axis ) are defined as in figure [ performance_fig ] ; the ` flat prior ' estimator is given by equation ( [ flat ] ) .",
    "dots again represent a subsample of the simulation , while curves represent averages over the full sample ( @xmath190 ) .",
    "if the prior centroid coincides with the true one ( @xmath187=0  , black solid line ) , then the demodulation reaches the poisson limit for @xmath191 5  ,",
    "i.e. , as long as the prior width does not exceed the true width by more than a factor @xmath1822 .",
    "if the true and assumed centroids differ ( @xmath192 ) , then the demodulation does no longer reach the poisson limit , and degradation depends on the ratio @xmath193 . as can be seen ,",
    "all error curves collapse to the optimum ( @xmath194 ) one when @xmath195 , indicating that discrepancies between true and prior centroids are tolerated up to the size of the prior region . except for very large and unrecognized prior errors ( @xmath187=500  , @xmath96 @xmath89 20  ) , the demodulation performs better than the uniform average , and approaches the flat prior estimate as @xmath121 .",
    "the flat prior , in turn , performs better than the uniform average .",
    "the solar diameter is 1920  , so that @xmath196  effectively represents a trivial prior , which only indicates that the photons came from the sun .    as a practical implication , we learn from figure [ robustness_fig ] ( and from similar simulations ) that , for realistic uncertainties ( say , @xmath197 ) , demodulation is beneficial compared to the uniform average if @xmath198 , and it is beneficial compared to the flat prior if @xmath199 .",
    "a recent solar eruption , to which also figures [ rmc_fig][phi_fig ] refer , occurred on february 26 , 2004 .",
    "rhessi has observed the whole eruption , and figure [ flare_fig ] shows a part of the impulsive rise phase , where most temporal fine structures are expected .",
    "the observed counts of subcollimators ( 1,3,4,5,6,7,8,9 ) are divided into disjoint intervals of duration @xmath4 = 0.12s , while subcollimator 2 is rejected due to increased background ( smith et al .",
    "the centroid @xmath94 = @xmath200 and size @xmath96 = 30  of the spatial prior are taken from a long - exposure ( 10s ) rhessi imaging and in agreement with the simulations of sect . [ robustness_sect ] .",
    "the filling factor is assumed to be @xmath88 = 0.4 .",
    "the average count rate is about 4000 ct / s / subcollimator , and energies from 5 to 15 kev are used .    in order to remove some arbitrariness of the time binning and to assess the quality of the demodulation @xmath34 we proceed as follows . by assumption ,",
    "the true scene is approximated as piecewise constant in time .",
    "if this assumption was true then a second demodulation @xmath201 with intervals of equal duration @xmath4 but shifted by @xmath202 should yield a similar result . by comparing @xmath34 with @xmath201 we may thus gain an estimate on the accuracy of the demodulation , and by considering @xmath203",
    "we may remove some arbitrariness of the time binning .",
    "figure [ flare_fig ] ( top panel ) shows the estimator @xmath204 , together with the uniform average @xmath92 as the simplest possible guess .",
    "panel b ) shows the discrepancy between @xmath34 and its time - shifted version @xmath201 . as can be seen",
    ", the relative discrepancy @xmath205 is throughout small ( 6% ) .",
    "the pure poisson error @xmath206 is also shown for comparison ( gray line ) .",
    "the residuals @xmath207 exceed the pure poisson error , and this excess is due to uncertainties of the weights @xmath54 .",
    "the latter are caused by the principal reasons discussed in sect .",
    "[ geom_sect ] , but also have contributions from the uncertainty of the prior centroid @xmath94 and -size @xmath96 , as well as from the approximate form of equation ( [ modpat ] ) and its energy - averaged coefficients @xmath208 , possible errors of the aspect data @xmath209 , and from violation of the piecewise constant - in - time approximation of the true scene . a complete disentangling of different sources of errors is difficult and somewhat speculative .",
    "however , we may empirically compare the residuals @xmath210 to the residuals @xmath211 ( fig .",
    "[ flare_fig]c ) and @xmath212 ( fig .",
    "[ flare_fig]d ) .",
    "this shows a clear order of residual amplitudes b ) @xmath89 c ) @xmath89 d ) , in agreement with the simulations",
    ". we may thus be confident that the flat prior estimate improves the uniform average , and that the demodulation improves the flat prior estimate .",
    "all residuals are centered about zero , in agreement with unbiasedness . by comparing simulation results with the residuals of fig .",
    "[ flare_fig ] b - d ) , and with families of similar real - data demodulations with varying @xmath4 ( not shown ) , we conclude that the demodulation error is in the order of the residuals @xmath207 ( fig . [ flare_fig]b ) . as may be seen from figure [ flare_fig]a ) ,",
    "many of the excursions of @xmath92  especially towards low count rates ( data gaps )  are absent in @xmath204 .",
    "they are therefore most likely to be instrumental .",
    "not all of the data gaps can , however , be removed by the demodulation : see , e.g. , before 01:53:50 . here",
    ", the collective dropout of several detectors during @xmath213 inhibits successful compensation .",
    "we have developed a unbiased linear bayes estimator for the photons arriving in front of the rhessi optics , which applies in situations where imaging information is less in demand than ( spatially integrated ) temporal evolution .",
    "the prior assumptions involve time - independence of the true brightness distribution during @xmath4 @xmath3 @xmath0 , and an a gaussian a priori pdf for the source density on the solar disc .",
    "the estimator minimizes the expected quadratic deviation of true and retrieved unmodulated counts , while enforcing agreement of their expectation values .",
    "non - overlapping time intervals @xmath4 are independent . geometrically , the algorithm tries to cancel the spatial transmission patterns ( modulation patterns ) of the rhessi optics by a suitable linear combination of patterns belonging to the time interval @xmath4 .",
    "the degree to which canceling is beneficial depends on the counting noise , and the algorithm constructs a trade - off between poisson- and modulational uncertainties of the estimator .",
    "monte carlo simulations show that the mean relative error of the demodulation reaches the poisson limit , and demonstrate robustness against violation of the prior assumptions .",
    "an application to a solar eruption is also discussed .",
    "the present method is limited in several ways .",
    "first , any non - solar background is neglected .",
    "secondly , the use of sharp time intervals @xmath4 brings along the computational advantage that the data can be split and the results merged in the end , but at the cost of possible artifacts at interval boundaries .",
    "the use of larger and smoothly tapered time intervals would help , but is computationally demanding .",
    "the condition number of a positive definite matrix is defined as the ratio of its largest eigenvalue to its smallest eigenvalue .",
    "we first ask for simple bounds on the condition number of the matrix @xmath214 with positive @xmath45 .",
    "since @xmath67 is symmetric all its eigenvalues ly between the minimum and maximum of the rayleigh quotient @xmath215 with @xmath216 ( euclidian norm ) .",
    "the minumum of @xmath217 is bounded by @xmath218 , while the maximum is bounded by @xmath219 .",
    "therefore , @xmath220 .            holds .",
    "equation ( [ cond_eb ] ) then follows by induction over @xmath10 with @xmath225 .",
    "( assuming that the true scenes may be labeled by discrete labels @xmath10 .",
    "we shall not prove this assertion , but call it plausible in view of the finite resolution of the modulation patterns . )",
    "equation ( [ ineq ] ) is then easily verified by direct calculation :"
  ],
  "abstract_text": [
    "<S> the rhessi experiment uses rotational modulation for x- and gamma ray imaging of solar eruptions . in order to disentangle rotational modulation from intrinsic time variation , an unbiased linear estimator for the spatially integrated photon flux </S>",
    "<S> is proposed . </S>",
    "<S> the estimator mimics a flat instrumental response under a gaussian prior , with achievable flatness depending on the counting noise . </S>",
    "<S> the amount of regularization is primarily given by the modulation - to - poisson levels of fluctuations , and is only weakly affected by the bayesian prior . </S>",
    "<S> monte carlo simulations demonstrate that the mean relative error of the estimator reaches the poisson limit , and real - data applications are shown . </S>"
  ]
}